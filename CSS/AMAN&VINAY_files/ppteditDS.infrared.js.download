'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1200:function(J,V,d){d.r(V);J=d(0);var h=d(69),e=d(26),m=d(176),r=d(53),v=d(52),A=d(28);class x{constructor(Da,va){this.ia=Da;this.ia.ra(A.a.Frj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.Grj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.Hrj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.Irj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.Jrj,r.a.application,m.ActionManager.Ju,4);
this.ia.ra(A.a.Krj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.Lrj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.qrj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.rrj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.srj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.trj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.urj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.vrj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.wrj,r.a.application,m.ActionManager.Ju,
4);this.ia.ra(A.a.prj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.xrj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.yrj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.Arj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.Brj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.Crj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.Drj,r.a.application,m.ActionManager.Ju,4);this.ia.ra(A.a.Erj,r.a.application,m.ActionManager.Ju,4);this.vDg=JSON.parse(va.Ia(v.a.pa(674)));for(const Fa of this.vDg)Fa.regex=
new RegExp(Fa.pattern)}trackAction(Da){for(const va of this.vDg)va.regex.test(Da)&&this.ia.processAction(va.actionId,2)}}Object(J.a)(x,"IdeasActionTracker",null,[1022]);class y{constructor(){this.z$a=this.Ype=this.jpe=null;this.fFj=this.tBl}addSlideSuggestionsListener(Da){this.jpe=Da}addTextToSmartArtSuggestionListener(Da){this.Ype=Da}GFd(Da){this.z$a=Da}notifySlideSuggestion(Da,va){this.jpe&&(this.jpe(Da,va),e.a.J(37065174,829,50,"data: count: {0}, correlation: {1}",va?va.suggestions.length:0,va?
va.correlationId:"0"))}notifyTextToSmartArtSuggestion(Da,va){this.Ype&&(this.Ype(Da,va),e.a.J(37065176,829,50,"data: count: {0}, correlation: {1}",va?va.suggestions.length:0,va?va.correlationId:"0"))}S5c(Da){this.z$a&&this.z$a(Da)}}Object(J.a)(y,"InfraredDesignerServiceProvider",null,[1021]);class u{constructor(){this.z$a=null}GFd(Da){this.z$a=Da}S5c(Da){this.z$a&&this.z$a(Da)}}Object(J.a)(u,"InfraredTelemetryListener",null,[1020]);var H=d(197),G=d(981),E=d(45),I=d(13),Q=d(33);class D{}Object(J.a)(D,
"EntityGroup",null,[]);class Y extends D{}Object(J.a)(Y,"Idea",D,[]);var M=d(531);class N{}Object(J.a)(N,"ProviderResult",null,[]);var W=d(325),K=d(428),ca=d(427),P=d(324),ea=d(530),da=d(25),ia=d(267);class C{}C.Iuk="PowerPoint";C.uxl="WAC";Object(J.a)(C,"ApplicationPropertiesConstants",null,[]);class oa{}Object(J.a)(oa,"EnterpriseUserInfo",null,[]);class Z{}Object(J.a)(Z,"Message",null,[]);class pa extends Z{}pa.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";Object(J.a)(pa,"PowerPointTextTileChangedMessage",
Z,[]);class ya{}Object(J.a)(ya,"RankerConfiguration",null,[]);class Ja{constructor(Da){this.oQg=Da}dVi(Da,va){return new Promise((Fa,ka)=>{this.oQg&&Da&&va||ka("wopiIdentityManager or tokenParameter or clientWoipId is null");this.oQg.getAccessToken(Da,va).then(qa=>{qa?Fa(qa.accessToken):ka("auth token is null")},qa=>{ka(qa)})})}}Object(J.a)(Ja,"AuthenticationProvider",null,[1044]);class Ka{constructor(Da,va,Fa,ka,qa=""){this.resource=this.gAl;this.resource=this.vBl;this.scope=this.hAl;this.scope=
this.wBl;this.silentLogin=this.iAl;this.silentLogin=this.xBl;this.options=this.fAl;this.options=this.uBl;this.correlationId=this.eAl;this.correlationId=this.sBl;this.Qw=Da;this.yKg=ka;this.Kee=qa}}Object(J.a)(Ka,"InfraredTokenParameters",null,[848]);class ma{constructor(Da,va,Fa,ka,qa,Ua,Ya,Va,ua){this.VGg=this.ude=this.v4e=null;this.KGg=!1;this.sle=null;this.Roe=!1;e.a.J(37065178,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.Mzb=Da;this.w_j=Ya;this.cje=ua;this.r2j=Da.ka(v.a.pa(659));
this.M2c=Da.Ia(v.a.pa(750));Ya=window.location.hostname;ua=Da.Ia(v.a.pa(816));Ya&&0<Ya.length&&ua&&0<ua.length&&0<=ua.toLowerCase().indexOf(Ya.toLowerCase())&&(this.M2c="");this.xTa=va;this.o7b=Ua;if(this.m8j=Da.ka(v.a.pa(688)))this.VGg=Da.Ia(v.a.pa(689)),this.ude=new Ja(Va);this.xTa.addSlideSuggestionsListener(Object(I.a)(this,this.amk,"onSlideSuggestion"));this.xTa.addTextToSmartArtSuggestionListener(Object(I.a)(this,this.Bmk,"onTextToSmartArtSuggestion"));this.xTa.GFd(Object(I.a)(this,this.PXg,
"onIdeasSessionTelemetry"));Fa.GFd(Object(I.a)(this,this.PXg,"onIdeasSessionTelemetry"));this.o7b&&this.o7b.execute(Ca=>{Ca.dCf(Object(I.a)(this,this.Eue,"onEditorCritiques"))});this.ia=ka;(this.GS=qa)&&this.GS.execute(Ca=>{Ca.registerSimpleLocalWorkflow("InfraredSlideTextTileWorkflow",Object.assign(new ca.a,{name:"InfraredSlideTextTileLambda",inputSchema:K.a.Hkc,outputSchema:K.a.Hkc,func:(Ea,wb,Oa)=>{this.bmk(Ea);Oa(null)}}))});this.Q4k()}get jtb(){return this.v4e}Q4k(){var Da=JSON.parse(this.Mzb.Ia(v.a.pa(612)));
Da=Object.assign(new ya,{rankingOrder:Da});var va=IdeasInfraredConnector,Fa=va.setup,ka=e.a.J,qa=Object(I.a)(this,this.Mrj,"ideasPaneVisibilityStatusCallback"),Ua=this.Mzb;const Ya={};Ya.appName=2===da.AFrameworkApplication.Ba.jb.vm?C.Iuk:"unknown";Ya.appVersion=da.AFrameworkApplication.buildVersion;Ya.appPlatform=C.uxl;Ya.lcid=da.AFrameworkApplication.lcid;var Va=ia.a.re(da.AFrameworkApplication.lcid);Va=Va?Va.name:null;const ua=Va.split("-");Ya.market=ua[ua.length-1];Ya.uiLanguage=Va;Ya.sessionId=
da.AFrameworkApplication.userSessionId;Ya.tenantRoot=Ua.Ia(v.a.pa(748));Ya.shredderServiceEndpoint=Ua.Ia(v.a.pa(749));this.v4e=Fa.call(va,Da,ka,qa,Ya,this.w_j,Object(I.a)(this,this.Jcg,"getShredderServiceAuthTokenPromise"))}Mrj(Da){this.KGg=Da;(this.xTa.fFj=Da)?(this.ia.processAction(A.a.HIc,2),this.V5g()):this.ia.Ma(A.a.qma,2,new ea.a(!0,P.a.v4d))}amk(Da,va){const Fa=[];Fa.push(Object.assign(new Y,{providerId:M.a.hqh,groupTypeId:M.a.gqh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,
data:va}));try{this.jtb.pushProviderResult(Object.assign(new N,{providerId:M.a.hqh,resultStatus:Da,entityGroups:Fa}))}catch(ka){e.a.J(38413662,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",ka)}"Success"===Da&&(H.a.Xa(va.suggestions)||this.cje.lkd(0))}Bmk(Da,va){const Fa=[];Fa.push(Object.assign(new Y,{providerId:M.a.qqh,groupTypeId:M.a.pqh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:va}));try{this.jtb.pushProviderResult(Object.assign(new N,
{providerId:M.a.qqh,resultStatus:Da,entityGroups:Fa}))}catch(ka){e.a.J(38560531,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",ka)}}PXg(Da){try{this.jtb.trackIdeasProviderAction(Da.cardId,Da.actionType,Da.actionEngagement)}catch(va){e.a.J(38413664,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",va)}}bmk(Da){if(this.r2j)if(Da)if(Da){try{const va=Q.a(Da.Content);this.g$h(this.sle,
va)&&(this.sle=va,this.Roe=!0)}catch(va){e.a.J(37598660,811,10,"Deserializing tile response failed");return}this.KGg&&this.V5g()}else e.a.J(37598658,811,50,"ProcessSlideTextTileChange,TileNull");else e.a.J(37598656,811,50,"ProcessSlideTextTileChange,InputNull")}g$h(Da,va){if(!Da&&va||Da&&!va)return!0;if(!Da&&!va)return!1;if(!Da.drawingElems&&va.drawingElems||Da.drawingElems&&!va.drawingElems)return!0;const Fa=new G.a;for(const ka of Da.drawingElems)if(Da=ka.text)for(const qa of Da.paragraphs)qa&&
(E.a.Xa(qa.id)||E.a.Xa(qa.chars)||Fa.$(qa.id,qa.chars));for(const ka of va.drawingElems)if(va=ka.text)for(const qa of va.paragraphs)if(qa&&!(E.a.Xa(qa.id)||E.a.Xa(qa.chars)||Fa.Kb(qa.id)&&Fa.ga(qa.id)===qa.chars))return!0;return!1}V5g(){if(this.Roe){try{this.jtb.postMessage(Object.assign(new pa,{messageType:pa.PowerPointTextTileChangedMessageType,data:this.sle}))}catch(Da){e.a.J(38413697,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",Da)}this.cje.lkd(1);
this.Roe=!1}}Eue(Da,va){try{Da=[],Da.push(Object.assign(new Y,{groupTypeId:M.a.YXf,providerId:M.a.dYf,notificationConfidence:va.uia?va.uia.notificationConfidence:0,shouldRaiseNotification:va.uia?va.uia.shouldRaiseNotification:!1,confidence:va.uia?va.uia.confidence:0,data:va.PXb})),this.jtb.pushProviderResult(Object.assign(new N,{providerId:M.a.dYf,resultStatus:va.uia?va.uia.resultStatus:W.a.invalid,entityGroups:Da}))}catch(Fa){e.a.J(38413699,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",
Fa)}va.uia&&"Success"===va.uia.resultStatus&&va.PXb&&!H.a.Xa(va.PXb.critiques)&&this.cje.lkd(2)}Jcg(){if(!this.ude)return e.a.J(38413701,811,50,"authenticationProvider is null"),null;try{if(this.M2c&&0<this.M2c.length)return this.ude.dVi(new Ka(this.M2c,"user_impersonation",!0,{}),this.VGg);e.a.J(39323299,811,50,"ShredderServiceResourceId is null or empty");return null}catch(Da){return e.a.J(38413703,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",Da),
null}}F0i(){return new Promise(Da=>{const va=this.Mzb.Ia(v.a.pa(749)),Fa=this.Jcg();va&&va.length&&Fa?Fa.then(ka=>{ka&&ka.length?(ka=new oa,ka.CountryCode="US",ka.IsEnabled=!1,ka.IsEnterpriseEnabled=!0,ka.IsGoLocal=!1,ka.ServiceEndpoint=va,ka.TenantRoot="",Da(ka)):Da(null)},()=>{Da(null)}):Da(null)})}}Object(J.a)(ma,"PPTWebEditorInfraredRuntimeManager",null,[1014]);class ra{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Infrared"}Yb(Da){this.K=Da;this.K.register(y,"PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider").as("PowerPointWebEditor.IDesignerServiceProvider").ma().na(()=>
new y);this.K.register(u,"PowerPointWebEditor.Infrared.InfraredTelemetryListener").as("PowerPointWebEditor.IInfraredTelemetryListener").ma().na(()=>new u);this.K.register(x,"PowerPointWebEditor.Infrared.IdeasActionTracker").as("PowerPointWebEditor.Infrared.IIdeasActionTracker").ma().na(()=>new x(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IAppSettingsManager")));e.a.J(559751877,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");this.K.register(ma,
"PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager").as("PowerPointWebEditor.Infrared.IInfraredRuntimeManager").ma().na(()=>new ma(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IDesignerServiceProvider"),this.K.resolve("PowerPointWebEditor.IInfraredTelemetryListener"),this.K.resolve("Common.IActionManager"),this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.Oa("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),
this.K.resolve("PowerPointWebEditor.Infrared.IIdeasActionTracker"),this.K.resolve("Common.App.WopiIdentity.WopiIdentityManager"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext")))}init(){const Da=this.K.resolve("Common.IAppSettingsManager");Da.gf(()=>{Da.ka(v.a.pa(610))&&(e.a.J(559751878,809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),this.K.resolve("PowerPointWebEditor.Infrared.IInfraredRuntimeManager"))})}dispose(){}static main(){h.a.instance.Ec(new ra)}}
Object(J.a)(ra,"PPTWebEditorInfraredRuntimePackage",null,[2,3]);Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PowerPointWebEditor.Infrared");ra.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.infrared.js.map