'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1090:function(J,V,d){d.r(V);d.d(V,"RealtimeChannelMetrics",function(){return v});J=d(0);var h=d(374),e=d(180),m=d(105),r=d(185);class v{constructor(){this.Gef=this.Hef=this.Ief=this.Eef=this.Def=this.Fef=this.QOb=this.Wxd=0;this.grc=this.kwd=this.bOb=this.awd=this.bwd=this.Tvd=this.aLa=this.WNb=this.jkb=this.Svd=this.erc=this.wjb=null;this.Twd=this.yOb=this.utf=this.vXe=0;this.sdf=!1;this.Lbd=this.YBe;this.aCe=
this.bCe;this.Mbd=this.$Be;this.Ygc=this.dCe;this.b$g=this.cCe;this.kCe=this.lCe;this.hCe=this.iCe;this.Rdb=this.fCe;this.$gc=this.gCe;this.X9g=this.ZBe;this.kBb=this.Ase;this.ccc=this.Bse}YBe(){this.Wxd++;this.Svd=new Date;this.wjb||(this.wjb=new Date)}bCe(){this.QOb++;this.aLa=new Date;this.erc||(this.erc=this.aLa);this.bOb=this.aLa;this.Koi()}$Be(){this.Fef++;this.Tvd=new Date}dCe(){this.Def++;this.jkb=new Date}cCe(){this.Eef++;this.WNb=new Date}iCe(){this.bwd=new Date;this.Ief++}gCe(){this.grc||
(this.grc=new Date);this.Hef++}fCe(){this.awd=new Date;this.Gef++}lCe(){if(!this.sdf&&this.Wxd){var A=this.sDc();h.ULS.sendTraceTag(39321871,500,15,m.a.toJSON(A));this.sdf=!0}}ZBe(A){let x,y;({q4d:A,r4d:x,Ti:y}=r.RtcUtils.o0f(A));A&&A!==e.a.Xy&&(h.ULS.sendTraceTag(40157596,500,15,m.a.toJSON({["HttpErrorCode"]:A,["HttpErrorStatus"]:x,["Exception"]:y})),e.a.Oqg(A)&&this.vXe++,e.a.Svg(A)&&this.utf++)}Ase(){this.kwd=new Date}Bse(){this.jkb=this.bOb=new Date}sDc(){return{["numberOfConnectionAttempts"]:this.Wxd,
["numberOfSuccessfulConnections"]:this.QOb,["numberOfFailedConnections"]:this.Fef,["numberOfDisconnectedConnections"]:this.Def,["numberOfExplicitDisconnectedConnections"]:this.Eef,["numberOfSentMessages"]:this.Ief,["numberOfReceivedMessages"]:this.Hef,["numberOfLostMessages"]:this.Gef,["firstConnectionAttempt"]:this.wjb?this.wjb:null,["firstMessageReceived"]:this.grc?this.grc:null,["firstConnectionSuccess"]:this.erc?this.erc:null,["lastConnectionAttempt"]:this.Svd?this.Svd:null,["lastConnectionSuccess"]:this.aLa?
this.aLa:null,["lastConnectionFailure"]:this.Tvd?this.Tvd:null,["lastMessageSent"]:this.bwd?this.bwd:null,["lastMessageLost"]:this.awd?this.awd:null,["lastDisconnect"]:this.jkb?this.jkb:null,["lastExplicitDisconnect"]:this.WNb?this.WNb:null,["lastTimeOnline"]:this.bOb?this.bOb:null,["lastTimeOffline"]:this.kwd?this.kwd:null,["maxDisconnectedTimeMs"]:this.yOb,["maxExplicitDisconnectedTimeMs"]:this.Twd,["clientConnectionErrors"]:this.vXe,["serverConnectionErrors"]:this.utf}}Koi(){this.wjb&&1===this.QOb&&
(this.yOb=Math.max(this.yOb,this.aLa.getTime()-this.wjb.getTime()));this.jkb&&1<this.QOb&&(this.yOb=Math.max(this.yOb,this.aLa.getTime()-this.jkb.getTime()));this.WNb&&1<this.QOb&&(this.Twd=Math.max(this.Twd,this.aLa.getTime()-this.WNb.getTime()))}static createInstance(A){v.Ka||(v.Ka=new v,h.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",A));return v.Ka}}v.Ka=null;Object(J.a)(v,"RealtimeChannelMetrics",null,[1144,304])},1091:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h extends Sys.EventArgs{constructor(e,m){super();this.hJb=e;this.mWf=m}}Object(J.a)(h,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1092:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.unspecified=0]="unspecified";e[e.word=1]="word";e[e.excel=2]="excel";e[e.powerPoint=3]="powerPoint";e[e.test=4]="test";e[e.wacFrontEnd=5]="wacFrontEnd";e[e.oneNote=6]="oneNote";e[e.visio=7]="visio";e[e.officeMobile=8]="officeMobile";e[e.cosmosDBChangefeed=9]="cosmosDBChangefeed";
e[e.last=10]="last"})(h||(h={}));Object(J.b)("RtcClientAppName",h)},1096:function(J,V,d){J=d(0);var h=d(374),e=d(13),m=d(228),r=d(229);class v{static bYd(Z,pa,ya){return v.cYd(Z,pa,ya,!0)}static cYd(Z,pa,ya,Ja){const Ka=document.createElementNS(v.Hhb,"svg");Ka.setAttribute("viewBox",String.format(v.aQd,v.Jnc,v.Inc));Ka.appendChild(v.Z0d(Z,pa,ya,Ja));return Ka}static Z0d(Z,pa,ya,Ja){const Ka=v.Jnc/Z,ma=pa/2*Ka,ra=v.Inc/2;let Da=0;Ja&&(Da=(Z-3*pa-4*ya)*Ka/2);Z=document.createElementNS(v.Hhb,"g");Sys.UI.DomElement.addCssClass(Z,
v.$Pd);for(Ja=1;3>=Ja;Ja++)Z.appendChild(v.zXd(Ja,ma,Da+(Ja*(pa+ya)-pa/2)*Ka,ra));return Z}static zXd(Z,pa,ya,Ja){const Ka=document.createElementNS(v.Hhb,"circle");Sys.UI.DomElement.addCssClass(Ka,String.format("{0}-{1}",v.PLd,Z));Ka.setAttribute("cx",String.format("{0}",ya));Ka.setAttribute("cy",String.format("{0}",Ja));Ka.setAttribute("r",String.format("{0}",pa));return Ka}}v.Hhb="http://www.w3.org/2000/svg";v.$Pd="prDancingDots";v.PLd="prAnimateCircle";v.aQd="0 0 {0} {1}";v.Inc=40;v.Jnc=120;Object(J.a)(v,
"ModernPresenceTooltipDancingDots",null,[]);var A=d(25),x=d(169),y=d(72),u=d(66),H=d(132),G=d(194),E=d(96),I=d(45),Q=d(2);class D extends m.a{constructor(Z,pa){super(Z);this.DRb=this.hR=this.VZa=this.mM=this.hM=this.Fo=this.mn=null;this.xH=pa.get(8,!1);this.fR=pa.get(6,0);this.kEd=pa.get(15,!1);this.Ic=pa;this.$Lb=0;this.element=Z;this.element.className=D.q5a;this.ks=document.createElement("span");this.element.appendChild(this.ks);this.qrd=v.bYd(pa.get(6,0),4,2);this.VI(pa);this._state=5}NU(Z){this.addHandler(r.a.No,
Z)}P_(Z){this.removeHandler(r.a.No,Z)}get user(){return this.DRb}get state(){return this._state}dispose(){this.element&&(this.mn.zb(u.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.mn.zb(u.a.doubleClick,this.element,Object(e.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),this.Fo.zb(u.a.pointerDown,this.element,Object(e.a)(this,this.ava,"onPointerDown")),this.Fo.zb(u.a.pointerOut,this.element,Object(e.a)(this,this.Oy,"onPointerOut")),this.Fo.zb(u.a.pointerOver,this.element,
Object(e.a)(this,this.iC,"onPointerOver")),this.hM.zb(this.element,Object(e.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}VI(Z){this.mn=Z.get(10);this.mn.pb(u.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.mn.pb(u.a.doubleClick,this.element,Object(e.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior"));this.Fo=Z.get(9);this.Fo.pb(u.a.pointerOver,this.element,Object(e.a)(this,this.iC,"onPointerOver"));this.Fo.pb(u.a.pointerOut,this.element,
Object(e.a)(this,this.Oy,"onPointerOut"));this.Fo.pb(u.a.pointerDown,this.element,Object(e.a)(this,this.ava,"onPointerDown"));this.hM=Z.get(13);this.hM.pb(this.element,Object(e.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior"))}hide(Z=null,pa=0,ya=0){this.kEd&&Z?this.gLe(Z,pa,ya):(3===this.state&&this.yhc(),this.visible=!1,this._state=5)}gLe(Z,pa,ya=0){this.show(Z,pa,15,4,void 0,ya)}qkc(Z,pa,ya,Ja=!1,Ka=!1,ma=!1,ra=0){this.show(Z,pa,ya+20,Ja?2:Ka?1:0,ma,ra)}PKe(Z,pa,ya,Ja=!1,Ka=0){this.show(Z,
pa,ya+20,3,Ja,Ka)}show(Z,pa,ya,Ja=3,Ka=!1,ma=0){!Z||Ja===this.state&&this.y3d(pa,ya)||(this.nFd(Ja,Ka,ma),this.kz(Z,Ja,ma),this._state=Ja,4===ma||0===ma&&!this.xH?this.element.style.left=pa+"px":this.element.style.right=pa+"px",this.element.style.top=ya+"px",this.visible=!0)}kz(Z,pa,ya){this.DRb=Z;E.a.Vt(this.ks);G.a.XMf(this.ks);this.ks.id="fly_"+Z.clientId;this.ks.style.backgroundColor=Z.color;4!==pa?(this.ks.style.height=this.fR+"px",this.ks.style.lineHeight=this.fR+"px",G.a.vX(this.ks,"border-radius",
this.fR+"px")):4===ya||0===ya&&!this.xH?this.ks.style.left="0px":this.ks.style.right="0px";2!==pa&&(4===pa?E.a.Zw(this.ks,""):1===pa?this.ks.appendChild(this.qrd):(this.ks.setAttribute("dir","auto"),ya=I.a.lZd(Z.userName,!1),(!Z.isAnonymous||A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&ya||0!==pa?(Z=Z.userName,0===pa&&(Z=ya,G.a.vX(this.ks,"text-align","center")),E.a.Zw(this.ks,Z)):(this.mM||(this.mM=this.hOd()),this.ks.appendChild(this.mM),
G.a.vX(this.ks,"text-align","start"))))}onClick(Z){if(0===this.state)return this.raiseEvent(r.a.No,new r.a(1,Z)),!0;3===this.state&&h.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}Oy(Z){3===this.state&&this.raiseEvent(r.a.No,new r.a(3,Z));return!1}iC(Z){3!==Z.Qf&&this.raiseEvent(r.a.No,new r.a(2,Z));return!1}ava(Z){if(3!==Z.Qf)return!0;this.raiseEvent(r.a.No,new r.a(4,Z));return!1}hOd(){const Z=document.createElement("img");Z.src=x.a.bK("doughperson_white_glyph.svg");
Z.setAttribute("Unselectable","on");H.a.mO(Z,H.a.ff,H.a.eP);return y.createClusteredImageFromClusterWithImageClass(this.fR,this.fR,null,null,D.KVd,"",!1,"",this.element.ownerDocument,Z)}nFd(Z,pa=!1,ya=0){if(!this.Hia(this.state)||!this.Hia(Z))switch(Sys.UI.DomElement.removeCssClass(this.element,this.VZa),this.state){case 4:3===Z?this.vM(D.r5a,D.mZb):this.Hia(Z)&&this.vM(D.p5a,D.mZb);break;case 3:4===Z?this.vM(D.t5a,D.lZb):this.Hia(Z)&&(pa&&this.yhc(),this.vM(D.p5a,D.lZb,pa?D.JVd:""));break;case 0:case 1:case 2:4===
Z?this.vM(D.t5a,D.s5a):3===Z&&(pa&&this.zFd(),this.vM(D.r5a,D.s5a,pa?D.nZb:"",3===ya?D.MVd:D.LVd));break;default:4===Z?this.vM(D.t5a):3===Z?this.vM(D.r5a):this.Hia(Z)&&this.vM(D.p5a)}}vM(...Z){this.VZa=Z.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.VZa)}zFd(){this.$Lb=window.setTimeout(()=>{this.element&&(this.hR=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.hR),this.element.style.zIndex="2",this.hR.style.zIndex="1")},300)}yhc(){window.clearTimeout(this.$Lb);this.hR&&
(Sys.UI.DomElement.removeCssClass(this.hR,D.s5a+" "+D.nZb),Sys.UI.DomElement.addCssClass(this.hR,D.IVd),Q.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.hR.parentNode&&this.element.parentNode.removeChild(this.hR)}),G.a.lEb(this.element,"z-index"))}Hia(Z){return 0===Z||1===Z||2===Z}y3d(Z,pa){const ya=G.a.WG(this.element.style.top);return G.a.WG(this.element.style.left)===Z&&ya===pa}qeb(Z){3===Z&&G.a.iP(this.element,"left")?(Z=G.a.WG(this.element.style.left),G.a.lEb(this.element,
"left"),this.element.style.right=-1*Z+"px"):4===Z&&G.a.iP(this.element,"right")&&(Z=G.a.WG(this.element.style.right),G.a.lEb(this.element,"right"),this.element.style.left=-1*Z+"px")}}D.q5a="prModernFlyout UIFont";D.t5a="flyoutIdle";D.r5a="flyoutExpanded";D.p5a="flyoutCollapsed";D.mZb="flyoutFromIdle";D.lZb="flyoutFromExpanded";D.s5a="flyoutFromCollapsed";D.nZb="flyoutStacked";D.JVd="flyoutFromStacked";D.IVd="flyoutFadeOut";D.KVd="cui-img-cont-float cui-img-20by20";D.LVd="flyoutLtrDir";D.MVd="flyoutRtlDir";
Object(J.a)(D,"ModernPresenceTooltipFlyoutControl",m.a,[]);class Y{constructor(Z,pa,ya=2,Ja=4){this.offsetTop=Z;this.offsetLeft=pa;this.Fnc=ya;this.I1b=Ja}}Object(J.a)(Y,"FlyoutsPositioningInfo",null,[]);var M=d(63);class N{constructor(Z=!1,pa=!1){this.Oi=Z;this.B_a=pa}tZd(Z,pa,ya,Ja,Ka,ma,ra){const Da=ra.y,va=ra.height;var Fa=this.rXd(ma);const ka=Fa+pa;Ka=Z*ya+(Z-1)*Ka;ya=null;1===Z||this.MKd(Fa,Ka,Da,va)?Z=new Y(0,0,2):(Z=this.wVd(ka,Ka,Da,va),Z.offsetTop-=Fa);this.B_a?ya=new Y(0,0,void 0,this.Oi?
4:3):(ma=this.qXd(ma,ra),Fa=Math.max(0,ra.x),ra=ra.width,pa=ma+pa,this.NKd(ma,Ja,Fa,ra)?ya=new Y(0,0,void 0,this.Oi?3:4):this.OKd(pa,Ja,Fa)&&(ya=new Y(0,0,void 0,this.Oi?4:3)),ya||(ya=this.vVd(ma,pa,Fa,ra)));return new Y(Z.offsetTop,ya.offsetLeft,Z.Fnc,ya.I1b)}rXd(Z){return M.a.uKc(Z)}qXd(Z,pa){return this.Oi?pa.width-M.a.d6f(Z):M.a.tKc(Z)}MKd(Z,pa,ya,Ja){return Z+pa<=ya+Ja}wVd(Z,pa,ya,Ja){let Ka=1,ma=Math.max(ya,Z-pa);pa>Z-ya&&(Ka=2,ma=pa<Ja?Ja-pa:ya);return new Y(ma,0,Ka)}NKd(Z,pa,ya,Ja){return Z+
pa<=ya+Ja}OKd(Z,pa,ya){return pa<=Z-ya}vVd(Z,pa,ya,Ja){Ja-pa>=Z-ya?Z=4:(pa=Z,Z=3);return new Y(0,pa,void 0,Z)}}Object(J.a)(N,"ModernPresenceTooltipPositioner",null,[]);class W{constructor(Z,pa,ya,Ja,Ka,ma,ra){this.yv=Z;this._parent=pa;this.LKb=ya;this.Opd=Ja;this.vtd=Ka;this.e6=ma;this.xH=ra;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(Z,pa){if(3!==Z)if(5!==Z&&this.yv&&this.yv.length){if(4===Z){var ya=this.vtd;var Ja=
(this.e6-ya)/2;this.element.style.height=this.e6+"px";this.element.style.width=this.e6+"px";Z=G.a.WG(this.yv[0].element.style.top);pa=G.a.WG(this.xH?this.yv[0].element.style.right:this.yv[0].element.style.left)}else ya=this.LKb,Ja=(this.e6-ya)/2,this.element.style.height=this.e6+"px",this.element.style.width=this.GXd()+2*Ja+"px",Z=G.a.WG(this.yv[this.yv.length-1].element.style.top),pa=this.CKd(this.yv[this.yv.length-1].element,ya,pa);G.a.vX(this.element,"border-radius",this.e6+"px");this.element.style.top=
Z-Ja-ya+"px";this.xH?this.element.style.right=pa-Ja+"px":this.element.style.left=pa-Ja+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}CKd(Z,pa,ya){return this.xH&&!ya?G.a.WG(Z.style.right):this.xH||ya?this.xH&&ya?-G.a.WG(Z.style.left)-pa:-G.a.WG(Z.style.right)-pa:G.a.WG(Z.style.left)}GXd(){return this.yv&&this.yv.length?this.LKb+Math.min(this.yv.length-1,2)*this.Opd:0}}Object(J.a)(W,
"ModernPresenceTooltipTarget",null,[]);var K=d(76),ca=d(115),P=d(197);class ea extends m.a{constructor(Z,pa,ya){super(Z);this.Y5=this.qH=this.cNb=this.gY=!1;this.Af=[];this.lya={};this.Ic=ya;this.Oi=ya.get(8,!1);this.OMb=ya.get(15,!1);this.yqd=ya.get(12,0);this.LR=ya.get(6,0);this.E1a=pa;this.FRb=ya.get(16);this.B_a=ya.get(17,!1);this.xtd=ya.get(19,!1);this.szd=ya.get(20,!1);this.rya=0;this.lzd=new N(this.Oi,this.B_a);this.Yea=this.e_b();this.W0a=!1;this.eM=[];this.Afa=[];this.element.id=ea.E5a();
this.element.className=m.a.rpb("prControl",this.Oi);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Oi;this.dfb(pa);this.lE=this.createElement("div");this.lE.className="prFlyoutContainer";this.element.appendChild(this.lE);this.yv=[];this.nR=new W(this.us,this.element,this.LR,4,6,32,this.Oi);this.Fo=ya.get(9);this.Fo.pb(u.a.pointerDown,this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"));this.Fo.pb(u.a.pointerOver,this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"));this.Fo.pb(u.a.pointerOut,
this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"))}get xdb(){return P.a.clone(this.Af)}get us(){return this.yv}get defaultZIndex(){return this.yqd}get UM(){return this.us?this.us.length:0}get dU(){return 0<this.UM?this.us[0].state:5}get a8a(){return 3===this.dU&&!this.gY}NU(Z){this.addHandler(r.a.No,Z)}P_(Z){this.removeHandler(r.a.No,Z)}dispose(){if(this.a8a)this.W0a=!0;else{if(this.us)for(const Z of this.us)Z.P_(Object(e.a)(this,this.pF,"onInteractivityChanged")),ca.a.Xw(Z);this.yv=null;this.Fo.zb(u.a.pointerDown,
this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"));this.Fo.zb(u.a.pointerOver,this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"));this.Fo.zb(u.a.pointerOut,this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"));super.dispose()}}tea(){this.KY();this.visible=!0}Vfb(){this.visible=!0;this.xYb();this.gY=!0}vwa(){this.Vfb()}hide(){this.zhc();this.aN();this.nR.update(this.dU,this.Y5)}kz(Z){const pa=this.dU,ya=this.gY;Z.clientId||(Z.clientId=(ea.Ffa++).toString());if(Z.clientId in this.lya){var Ja=
this.cS(Z.clientId);if(0<=Ja){Ja=this.Af[Ja];if(Ja.color===Z.color&&Ja.userName===Z.userName)return;this.BL(Z.clientId)}}this.hide();Ja=new D(this.createElement("div"),this.Ic);Ja.NU(Object(e.a)(this,this.pF,"onInteractivityChanged"));this.lE.insertBefore(Ja.element,this.lE.firstChild);this.lya[Z.clientId]=Ja;Array.add(this.Af,Z);Array.add(this.us,Ja);this.knc(pa,ya);this.visible=!0}BL(Z){if(this.a8a)Array.add(this.Afa,Z);else{var pa=this.dU,ya=this.gY;this.hide();this.kma(Z);this.knc(pa,ya)}}ocb(Z){const pa=
this.cS(Z);if(!(0>=pa)){var ya=this.Af[pa];Z=this.lya[Z];Array.removeAt(this.Af,pa);Array.insert(this.Af,0,ya);Array.removeAt(this.us,pa);Array.insert(this.us,0,Z);this.lE.removeChild(Z.element);this.lE.appendChild(Z.element);this.KY()}}knc(Z,pa){0>=this.Af.length?this.hide():3===Z&&pa?this.Vfb():this.tea()}Afb(Z,pa){pa?this.gFd(Z):this.shc(Z)}qYb(Z){if(this.a8a&&this.xtd)return!1;Z=ea.r6a(Z);if(this.lE!==Z&&E.a.asa(this.lE,Z))return!0;for(const pa of this.us)if(E.a.asa(pa.element,Z))return!0;return!1}position(Z,
pa){this.element.style.top=pa+"px";this.element.style.left=Z+"px"}KY(Z=!1){if(!Z||this.qH){this.cNb&&this.vjc(!0);var pa=Math.min(3,this.UM)-1;Z=0;var ya=1,Ja=0;this.Y5&&(Z=this.Yea,ya=-1,Ja=-this.LR);for(let Ka=this.UM-1;Ka>pa;Ka--)this.us[Ka].qkc(this.Af[Ka],-4*pa*ya+Ja,0,!0,!1,!0,Z);for(;0<=pa;pa--)this.us[pa].qkc(this.Af[pa],-4*pa*ya+Ja,0,0<pa,Array.contains(this.eM,this.Af[pa].clientId),pa!==this.rya,Z);this.rya=0;this.nR.update(0,this.Y5);this.zIndex=this.defaultZIndex;this.gY=!1;this.zhc(0);
this.W0a&&this.dispose()}}xYb(){this.cNb&&this.vjc(!1);this.zIndex=this.defaultZIndex+1;let Z,pa,ya;({offsetX:pa,offsetY:Z,H1b:ya}=this.YHe());for(let Ja=0;Ja<this.UM;Ja++)this.us[Ja].PKe(this.Af[Ja],pa,Z+(this.LR+2)*Ja,Ja!==this.rya,ya)}aN(){let Z=0,pa=0;this.Y5&&(Z=this.Yea,pa=-6);for(let ya=0;ya<this.UM;ya++)this.us[ya].hide(this.Af[ya],pa,Z);this.zIndex=this.defaultZIndex;this.visible=this.gY=!1;this.W0a&&this.dispose()}I3a(Z=0){Z?(this.qH=!0,Q.Task.delay(Z).continueWith(()=>{this.OMb?this.Z3d():
this.KY(!0);this.qH=!1})):this.OMb?this.hide():this.KY()}Z3d(){this.qH&&this.hide()}pJd(){if(A.AFrameworkApplication.Ba&&A.AFrameworkApplication.Ba.jb.J7&&K.c()){const Z=appChrome.selectors.getShyState();return Z.isActive&&0!==Z.state}return!1}pF(Z,pa){Z=this.dU;this.pJd()||2!==pa.type&&(4!==pa.type||3===Z)?4===pa.type&&3===Z?(this.qH&&(this.qH=!1),this.I3a()):3!==pa.type||3!==Z||this.gY||(1<this.UM?(this.qH=!0,Q.Task.delay(250).continueWith(()=>{this.KY(!0);this.qH=!1})):this.I3a()):(this.qH&&(this.qH=
!1),3!==Z&&(this.xYb(),3===pa.Ri.Qf&&this.I3a(2E3)));this.raiseEvent(r.a.No,pa)}y9(Z){3===Z.Qf?this.pF(this,new r.a(4,Z)):Z.eventName===u.a.pointerOver?this.pF(this,new r.a(2,Z)):Z.eventName===u.a.pointerOut&&this.pF(this,new r.a(3,Z));return!1}dfb(Z){this.element.style.width=Z+"px";this.element.style.height=this.LR+"px"}kma(Z){this.shc(Z);Z=this.cS(Z);if(!(0>Z)){var pa=this.Af[Z];Array.removeAt(this.Af,Z);delete this.lya[pa.clientId];pa=this.us[Z];this.lE.removeChild(pa.element);this.Ic.get(18,!1)&&
pa.P_(Object(e.a)(this,this.pF,"onInteractivityChanged"));Array.removeAt(this.us,Z);pa.dispose()}}zhc(Z=5){if(this.Afa.length){this.visible&&this.aN();for(let pa=0;pa<this.Afa.length;pa++)this.kma(this.Afa[pa]);Array.clear(this.Afa);0>=this.Af.length||5===Z?this.hide():0===Z&&this.tea()}}cS(Z){for(let pa=0;pa<this.Af.length;pa++)if(this.Af[pa].clientId===Z)return pa;return-1}gFd(Z){if(-1===this.cS(Z))h.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.eM,
Z)){if(this.Af[0].clientId===Z)return;Array.remove(this.eM,Z)}Array.add(this.eM,Z);this.ocb(Z);1!==this.dU&&this.KY()}}shc(Z){-1===this.cS(Z)?h.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.eM,Z)&&(Array.remove(this.eM,Z),this.Af[0].clientId===Z&&0<this.eM.length&&this.ocb(this.eM[this.eM.length-1]),this.Af[0].clientId===Z&&1===this.dU&&this.KY())}vjc(Z){Z?Sys.UI.DomElement.addCssClass(this.lE,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.lE,
"prBackgroundSelection")}YHe(){let Z,pa;pa=Z=0;var ya=this.Yea;if(this.FRb){const Ja=this.FRb(this);if(!Ja)return{offsetX:Z,offsetY:pa,H1b:ya};const Ka=4===this.dU;ya=this.lzd.tZd(this.UM,Ka?6:this.LR,this.LR,150,2,this.element,Ja);pa=ya.offsetTop;this.rya=this.kZd(ya.Fnc,ya.offsetTop);ya=ya.I1b;ya!==this.Yea&&(this.qeb(ya),this.element.dir=3===ya?"rtl":"ltr",this.Yea=ya);ya!==this.e_b()?(Z=this.szd?-2:Ka?-6:-this.LR,this.Y5=!0):this.Y5=!1}return{offsetX:Z,offsetY:pa,H1b:ya}}kZd(Z,pa){if(1===Z)return this.UM-
1;Z=Math.abs(pa);return 0<Z?Z/(this.LR+2):0}qeb(Z){for(let pa=0;pa<this.UM;pa++)this.us[pa].qeb(Z)}e_b(){return this.Oi?3:4}static E5a(){return String.format("{0}-{1}","presencetooltip",ea.Ffa++)}static r6a(Z){return Z.nc.rawEvent.relatedTarget}}ea.Ffa=0;Object(J.a)(ea,"ModernPresenceTooltipControl",m.a,[396,109]);var da=d(217),ia=d(284),C=d(264);d.d(V,"a",function(){return oa});class oa{constructor(Z){this.Ic=Z;this.Ic.UC(10,da.a.instance);this.Ic.UC(9,C.a.instance);this.Ic.UC(6,20);this.Ic.UC(13,
ia.a.instance);this.Ic.UC(17,!1)}KEc(Z,pa){this.Ic.UC(15,!1);return new ea(Z,pa,this.Ic)}lpb(Z){this.Ic.UC(15,!1);return new ea(Z,20,this.Ic)}}Object(J.a)(oa,"ModernPresenceTooltipFactory",null,[395])},1099:function(J,V,d){J=d(0);var h=d(13),e=d(1154),m=d(228),r=d(229),v=d(66),A=d(96);class x extends m.a{constructor(M,N){super(M);this.Af=null;this.xH=N.get(8,!1);this.fR=N.get(6,0);this.element=M;this.element.className=x.q5a;this.a2a=this.createElement("ul");this.element.appendChild(this.a2a);this.mn=
N.get(10);this.mn.pb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.Fo=N.get(9);this.Fo.pb(v.a.pointerOut,this.element,Object(h.a)(this,this.Oy,"onPointerOut"));this.Fo.pb(v.a.pointerDown,this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior"));this.hM=N.get(13);this.hM.pb(this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior"))}NU(M){this.addHandler(r.a.No,M)}P_(M){this.removeHandler(r.a.No,M)}get p$(){return this.Af}dispose(){this.element&&
(this.mn.zb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.Fo.zb(v.a.pointerDown,this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),this.Fo.zb(v.a.pointerOut,this.element,Object(h.a)(this,this.Oy,"onPointerOut")),this.hM.zb(this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(M,N,W){this.hide();!M||0>=M.length||(this.xH?this.element.style.right=N+"px":this.element.style.left=
N+"px",this.element.style.top=W+"px",this.aGd(M),this.visible=!0)}aGd(M){this.Af=M;A.a.Vt(this.a2a);for(let N=M.length-1;0<=N;N--)this.kz(M[N])}kz(M){const N=document.createElement("li");N.style.backgroundColor=M.color;N.style.height=this.fR+"px";N.id="fly_"+M.clientId;N.style.lineHeight=this.fR+"px";A.a.Zw(N,M.userName);N.setAttribute("dir","auto");this.a2a.appendChild(N)}onClick(){this.hide();return!1}Oy(M){this.raiseEvent(r.a.No,new r.a(3,M));return!1}}x.q5a="prFlyout UIFont";Object(J.a)(x,"PresenceTooltipFlyoutControl",
m.a,[]);var y=d(72);class u extends m.a{constructor(M,N,W){super(M);this.mM=null;this.Af=[];this.element.className="prGlyph";this.Ic=N;this.W5=this.Ic.get(9);this.Rm=this.Ic.get(10);this.hM=this.Ic.get(13);this.d4d();this.kz(W);this.e0a=!1}get cO(){return this.Af.length}get p$(){return this.Af}NU(M){this.addHandler(r.a.No,M)}P_(M){this.removeHandler(r.a.No,M)}dispose(){this.CRe();super.dispose()}kz(M){Array.add(this.Af,M);2===this.cO?this.m$(!0):1===this.cO?this.m$(!1):this.m$(this.e0a)}BL(M){this.SUd(M)&&
(1<this.cO&&this.m$(!0),1===this.cO?this.m$(!1):1>this.cO&&this.hide())}show(){this.m$(2<=this.cO);this.visible=!0}hide(){this.visible=!1}gZd(M){return M?this.XZb(0,5):this.XZb(1,4)}SUd(M){for(let N=0;N<this.cO;N++)if(this.Af[N].clientId===M)return M=this.Af[N],Array.removeAt(this.Af,N),M;return null}m$(M){this.e0a!==M&&(this.mM&&this.element.removeChild(this.mM),this.mM=this.gZd(M),this.element.appendChild(this.mM),this.e0a=M);this.mM.childNodes[0].style.backgroundColor=this.Af[this.Af.length-1].color}XZb(M,
N){const W=this.Ic.get(6,0),K=this.Ic.get(14);return y.createClusteredImageFromClusterWithImageClass(W,W,this.Ic.get(M),this.Ic.get(N),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,K?K.cloneNode(!0):null)}iC(M){3!==M.Qf&&this.raiseEvent(r.a.No,new r.a(2,M));return!1}onClick(M){this.raiseEvent(r.a.No,new r.a(1,M));return!0}Oy(M){3!==M.Qf&&this.raiseEvent(r.a.No,new r.a(3,M));return!1}CRe(){this.element&&(this.W5.zb(v.a.pointerDown,this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),
this.W5.zb(v.a.pointerOver,this.element,Object(h.a)(this,this.iC,"onPointerOver")),this.W5.zb(v.a.pointerOut,this.element,Object(h.a)(this,this.Oy,"onPointerOut")),this.Rm.zb(v.a.doubleClick,this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),this.Rm.zb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.hM.zb(this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")))}d4d(){this.element&&(this.W5.pb(v.a.pointerDown,this.element,
Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),this.W5.pb(v.a.pointerOver,this.element,Object(h.a)(this,this.iC,"onPointerOver")),this.W5.pb(v.a.pointerOut,this.element,Object(h.a)(this,this.Oy,"onPointerOut")),this.Rm.pb(v.a.doubleClick,this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),this.Rm.pb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.hM.pb(this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")))}}
Object(J.a)(u,"PresenceTooltipGlyph",m.a,[]);var H=d(115);d(63);var G=d(197);class E extends m.a{constructor(M,N,W){super(M);this.Af=[];this.Jl=[];this.uH=0;this.gga=this.D5=!1;this.VJb=null;this.zfa={};this.Ic=W;this.Oi=W.get(8,!1);this.QF=W.get(11,!1);M=W.get(12,0);this.imageDimension=W.get(6,0);this.E1a=N;this.element.id=E.E5a();this.element.className=m.a.rpb("prControl",this.Oi);M&&(this.zIndex=M);this.rtl=this.Oi;this.dfb(N);this.$y=this.createElement("div");this.$y.className=this.QF?"prContainerV":
"prContainerHr";this.element.appendChild(this.$y);this.mMb=Array(this.uH);for(N=0;N<this.uH;N++)this.Fv[N]=new x(this.createElement("div"),this.Ic),this.Fv[N].NU(Object(h.a)(this,this.pF,"onInteractivityChanged")),this.element.appendChild(this.Fv[N].element)}get xdb(){return G.a.clone(this.Af)}getGlyph(M){return this.zfa[M]}get Fv(){return this.mMb}get $Rb(){return this.VJb}get wIa(){return this.imageDimension+2}get width(){return this.QF?this.wIa:this.E1a}get height(){return this.QF?this.E1a:this.wIa}NU(M){this.addHandler(r.a.No,
M)}P_(M){this.removeHandler(r.a.No,M)}dispose(){if(this.Fv)for(const M of this.Fv)M.P_(Object(h.a)(this,this.pF,"onInteractivityChanged")),H.a.Xw(M);H.a.jed(this.Jl);this.Jl=this.mMb=null;super.dispose()}tea(){this.aN();this.Ufb();this.visible=!0;this.D5=!1}Vfb(){!this.Jl||1>this.Jl.length||(this.aN(),this.visible=!0,this.Ufb(),this.ZGa(this.Jl[this.Jl.length-1]),this.D5=!0)}vwa(){if(this.Jl&&!(1>this.Jl.length)){this.visible=!0;this.Ufb();var M=0;for(const N of this.Jl)this.ZGa(N,M++);this.D5=!1;
this.gga=!0}}hide(){this.visible=!1;this.aN();for(let M=0;M<this.Jl.length;M++)this.Jl[M].hide();this.D5=!1}BUb(){if(!this.gga)return!1;let M=0;for(const N of this.Fv)N.visible&&M++;return this.gga=0<M&&(this.Af.length<=this.uH?M===this.Af.length:M===this.uH)}kz(M){if(!(0>=this.uH)){M.clientId||(M.clientId=(E.Ffa++).toString());if(M.clientId in this.zfa){var N=this.cS(M.clientId);if(0<=N){N=this.Af[N];if(N.color===M.color&&N.userName===M.userName)return;this.BL(M.clientId)}}N=this.BUb();var W=0;if(this.Af.length<
this.uH){var K=new u(this.createElement("div"),this.Ic,M);K.NU(Object(h.a)(this,this.pF,"onInteractivityChanged"));this.Oi&&!this.QF&&0<this.Af.length?this.$y.insertBefore(K.element,this.$y.firstChild):(this.$y.appendChild(K.element),W=this.Jl.length);Array.add(this.Jl,K)}else this.Oi&&!this.QF?K=this.Jl[0]:(W=this.Jl.length-1,K=this.Jl[W]),K.kz(M);K.show();this.zfa[M.clientId]=K;Array.add(this.Af,M);this.bnc(K,W);N&&this.vwa()}}BL(M){const N=this.BUb();N&&this.aN();this.kma(M);this.Af.length>=this.uH&&
this.Jl.length<this.uH&&this.WBe();0>=this.Af.length?this.hide():N&&this.vwa()}ocb(){}kma(M){var N=this.cS(M);0>N||(M=this.Af[N],Array.removeAt(this.Af,N),N=this.zfa[M.clientId],delete this.zfa[M.clientId],N.BL(M.clientId),this.bnc(N),0>=N.cO&&(this.$y.removeChild(N.element),Array.remove(this.Jl,N),N.dispose()))}Afb(){}WBe(){var M=this.n_d();!M||1>=M.p$.length||(M=Array.clone(this.Af),M.forEach(N=>{this.kma(N.clientId)}),M.forEach(N=>{this.kz(N)}))}cS(M){for(let N=0;N<this.Af.length;N++)if(this.Af[N].clientId===
M)return N;return-1}n_d(){return this.Oi&&!this.QF?this.Jl[0]:this.Jl[this.Jl.length-1]}position(M,N){this.element.style.top=N+"px";this.element.style.left=M+"px"}Ufb(){for(let M=0;M<this.Jl.length;M++)this.Jl[M].show()}aN(){for(let M=0;M<this.uH;M++)this.Fv[M].hide();this.gga=!1}ZGa(M,N=0){if(M)if(this.VJb=M,this.QF){const W=this.imageDimension;if(1<M.p$.length)this.Fv[N].show(M.p$,W,this.height-this.imageDimension);else{const K=this.$y.children.length;for(let ca=0;ca<this.$y.children.length;ca++)M.element===
this.$y.children[ca]&&this.Fv[N].show(M.p$,W,this.height-(K-ca)*this.wIa+2)}}else this.Fv[N].show(M.p$,this.width,0)}pF(M,N){var W=Object(e.a)(u,M);W=W?this.NYb(W):-1;if(2===N.type||1===N.type&&-1!==W&&!this.Fv[W].visible)this.ZGa(M);else if(1===N.type)this.aN(),this.D5=!1;else if(3===N.type){if(this.qYb(N.Ri))return;this.D5||this.aN()}this.raiseEvent(r.a.No,N)}qYb(M){M=E.r6a(M);let N=!1;for(const W of this.Fv)if(A.a.asa(W.element,M)){N=!0;break}return this.$y!==M&&A.a.asa(this.$y,M)||N}bnc(M,N=0){const W=
this.b7d(M);W&&0>=M.cO?this.Fv[N].hide():W?this.ZGa(M):this.Fv[N].hide()}NYb(M){let N=0;for(const W of this.Jl){if(M===W)return N;N++}return-1}b7d(M){const N=this.NYb(M);return!!this.$Rb&&M===this.$Rb&&-1!==N&&this.Fv[N].visible}dfb(M){this.uH=M===this.imageDimension?1:Math.floor(M/this.wIa);this.QF?(this.element.style.height=M+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=M+"px",this.element.style.height=this.imageDimension+"px")}static E5a(){return String.format("{0}-{1}",
"presencetooltip",E.Ffa++)}static r6a(M){M=M.nc.rawEvent;return M.relatedTarget||M.toElement}}E.Ffa=0;Object(J.a)(E,"PresenceTooltipControl",m.a,[396,109]);var I=d(217),Q=d(284),D=d(264);d.d(V,"a",function(){return Y});class Y{constructor(M){this.Ic=M;this.Ic.UC(10,I.a.instance);this.Ic.UC(9,D.a.instance);this.Ic.UC(6,16);this.Ic.UC(13,Q.a.instance)}KEc(M,N){return new E(M,N,this.Ic)}lpb(M){return new E(M,16,this.Ic)}}Object(J.a)(Y,"PresenceTooltipFactory",null,[395])},1198:function(J,V,d){d.r(V);
var h=d(0),e=d(374),m=d(13),r=d(17),v=d(78),A=d(79),x=d(35),y=d(2);class u{constructor(Ta,Hb,oc,Oc,Yc,Qd,ce,id,gb=!1){this.MJa=null;this.csd=!0;this.tzd=this.uR=this.Eod=null;this.Ta=new v.a;this.kPh=Ta;this.psf=Hb;this.ypf=oc;this.wpf=Oc;this.$Ve=Qd;u.Md=Yc;this.dRh=ce;this.vLa=id;this.VRh=gb;y.Task.WAA(Hb,oc).continueWith(Object(m.a)(this,this.$tj,"initOnTaskReady"))}t9g(){this.Ta.raiseEvent("u",null,this)}$tj(){this.psf.result&&this.ypf.result&&(this.uR=this.psf.result,this.tzd=this.ypf.result,
this.uR.Kzc(Object(m.a)(this,this.cdc,"onPresenceUpdated")),this.Eod=new A.a(2,2,this.$Ve,Object(m.a)(this,this.zql,"updateAwayClientsTask"),88),u.Md.Hb(this.Eod))}cdc(Ta,Hb){(this.csd||this.zFk(Hb.hJb))&&u.Md.v4(this.Eod,0)}zFk(Ta){for(let oc in Ta){var Hb=this.wpf.sbg({key:oc,value:Ta[oc]});if(Hb&&Hb.clientId&&(Hb=Hb.clientId.toLowerCase(),(Hb=this.MJa[Hb]||this.MJa[Hb.toUpperCase()])&&2===Hb.status))return!0}return!1}zql(Ta){var Hb=this.uR.TVi();if(Hb){var oc=new Date,Oc=!1;if(this.csd){this.MJa=
Hb;this.csd=!1;var Yc=this.MJa;for(var Qd in Yc){Hb=Qd;var ce=Yc[Qd];ce.Gvb<oc&&(oc=ce.Gvb);2===ce.status&&(Oc=!0,this.tzd.rcd(Hb))}Oc&&this.t9g();u.Md.v4(Ta,this.kag(oc))}else{ce=new r.a;Qd=!1;var id=this.MJa;for(Yc in id){id=Yc;if(!(id in this.MJa)||this.kPh.clientId===id)continue;var gb=this.MJa[id];const pc=Hb[id];if(gb&&pc){gb=gb.status;const zc=pc.status;2===gb&&1===zc?(ce.add(id),e.ULS.sendTraceTag(38052609,392,50,id+" returned from away")):1===gb&&2===zc&&(Qd=Oc=!0,this.tzd.rcd(id),e.ULS.sendTraceTag(38052610,
392,50,id+" went away"));1===zc&&pc.Gvb<oc&&(oc=pc.Gvb)}}this.MJa=Hb;u.Md.v4(Ta,this.kag(oc));(0<ce.count||Oc)&&this.t9g();0<ce.count&&!this.VRh?(Ta=this.bYi(ce),this.Yjl(Ta)):Ta=new r.a;(Qd||0<Ta.count)&&this.dRh(x.a.H3a,2)}}}Yjl(Ta){if(Ta.count)for(let Hb of Ta)Ta=this.vLa.NNa(String.format(CommonUIStrings.l_EditorsToastArriving,Hb),!1),Ta.image=5,Ta.Kba="CoAuth_AuthorStatus_16x16x32",this.vLa.ai(Ta)}bYi(Ta){const Hb=this.uR.iKc(),oc=new r.a;for(let Oc in Hb){const Yc={key:Oc,value:Hb[Oc]};if(Ta.contains(Yc.key)){const Qd=
this.wpf.sbg(Yc);Qd&&(oc.add(Qd.userName),Ta.remove(Yc.key))}}oc.count||e.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return oc}kag(Ta){return Math.max(Ta.getTime()+this.$Ve-(new Date).getTime(),0)}}u.Md=null;Object(h.a)(u,"AwayManager",null,[]);var H=d(565),G=d(25),E=d(286),I=d(57),Q=d(326),D=d(69),Y=d(1092),M=d(1019),N=d(956),W=d(687),K=d(685),ca=d(185),P=d(955),ea=d(27),da=d(690),ia=d(207),C=d(26),oa=d(758),Z=d(45),pa=d(1154),ya=d(22),Ja=d(925),Ka=d(366),ma=d(36),ra=
d(64);class Da{constructor(Ta,Hb){this.shapeNode=Ta;this.jrh=Hb}}Object(h.a)(Da,"ShapeNodeStartEditingNotificationTracking",null,[]);class va{constructor(Ta,Hb,oc,Oc,Yc="",Qd=""){if(!Ta||!Hb||0>oc)throw Error.argumentNull("LockEntry");this.Qv=Ta;this.TA=Hb;this.dda=oc;this.i2j=Oc;this.QOg=Yc;this.KOg=Qd;this.sJg=new Date}get clientId(){return this.Qv}get Chd(){return this.TA}get shapeId(){return this.dda}get lockType(){return this.i2j}get Rth(){return this.QOg}get Dth(){return this.KOg}get Awg(){return!Z.a.Xa(this.KOg)&&
!Z.a.Xa(this.QOg)}get cbe(){return this.sJg}set cbe(Ta){this.sJg=Ta}}Object(h.a)(va,"LockEntry",null,[]);class Fa{constructor(Ta,Hb,oc,Oc,Yc="",Qd=""){this.clientId=Ta;this.slideId=Hb;this.shapeId=oc;this.lockType=Oc;this.rowId=Yc;this.cellId=Qd}}Object(h.a)(Fa,"SerializableLockData",null,[]);var ka=d(183),qa=d(52),Ua=d(211);class Ya{constructor(Ta,Hb,oc,Oc,Yc,Qd,ce,id,gb,pc,zc,Ic,Fc,rd,Yd,me,Db,af,bg,Qe,Af,tf){this.mgj=new H.a("",ResourceStrings.L_GhostUserName,Ja.a.ZTf,new oa.a(1));this.vyb={};
this.wyb={};this.uyb={};this.aJg=ea.App.Bm;this.kle=null;this.Boe={};this.bWc={};this.eWc={};this.bJg=ea.App.Bm;this.GOg=!0;this.TKg=this.hKg=0;this.v0c=(new Date(0)).getTime();this.w0c=(new Date(0)).getTime();this.K9b=(new Date(0)).getTime();this.Jme=(new Date(0)).getTime();this.EOg=!1;this.SSa=Ta;this.zD=Hb;this.Cyb=oc;this.v$b=Oc;this.Wb=Yc;this.Bb=Qd;this.sa=ce;this.VXj=id;this.Lq=gb;this.Fa=pc;this.wc=zc;this.T9b=Ic;this.Zee=Fc.trg;this.Rr=rd;this.NW=Yd;this.ua=me;this.JNg=Db;this.zd=af;this.zd.c4h(Object(m.a)(this,
this.Klk,"onShapeViewElementRequestUpdateAuthorInfo"));(this.Gx=G.AFrameworkApplication.fa.ka(qa.a.bHa))&&this.sa.VJ(Object(m.a)(this,this.VG,"onSelectionChanged"));this.v$b.Eza(Object(m.a)(this,this.xdc,"onUpdateNotificationReceived"));this.A7j=bg;this.Le=Qe;this.L6j=Af;this.Ha=Fc;this.AUa=tf;this.fuj()}fuj(){C.a.J(20821920,828,50,"CoauthStateChangesHandler:InitRttRelatedTasks - IsDedicatedSession: {0}, RttLockSettings: {1}",this.Zee,this.Rr.FVj());this.Rr.mRd||(0<this.Rr.eeb?this.Bb.Hb(new A.a(2,
2,this.Rr.eeb,Object(m.a)(this,this.removeExpiredLock,"removeExpiredLock"),90,"71")):C.a.J(20821922,804,10,"RemoveExipredLockIntervalMs is not set correctly while RTT lock is enabled"),0<this.Rr.FHb?(this.Bb.Hb(new A.a(2,2,this.Rr.FHb/2,Object(m.a)(this,this.switchPendingSveToFidelity,"switchPendingSveToFidelity"),90,"72")),this.GOg=!1):C.a.J(21565471,804,50,"Switch to fidelity delay after unlock is disabled"),0<this.Rr.e2b?this.Bb.Hb(new A.a(2,2,this.Rr.e2b,Object(m.a)(this,this.updateLockIfImeActive,
"updateLockIfImeActive"),90,"73")):C.a.J(20030493,804,50,"IME typing lock notification disabled"),0<this.Rr.bcb?this.Bb.Hb(new A.a(2,2,this.Rr.bcb,Object(m.a)(this,this.detectLockLeak,"detectLockLeak"),90,"74")):C.a.J(21565474,804,50,"Lock leack detection is disabled"),this.VXj.addHandler(Ka.a.POf,(Ta,Hb)=>{this.Coi(Hb)}),this.Rr.uGc||this.olc||(this.T9b.Dza(Object(m.a)(this,this.RVg,"onBeforeParagraphNodePropertyChanged")),0<this.Rr.nhb?this.Bb.Hb(new A.a(2,2,this.Rr.nhb,Object(m.a)(this,this.updateLockForActiveShapeNodes,
"updateLockForActiveShapeNodes"),90,"75")):C.a.J(20821953,804,15,"DedicatedWorkerTypingUpdateIntervalMs is not set correctly")),this.olc&&(this.L6j.Dza(Object(m.a)(this,this.r8c,"onTableCellNodePropertyChanged")),this.T9b.Dza(Object(m.a)(this,this.RVg,"onBeforeParagraphNodePropertyChanged")),this.A7j.initialize(),0<this.Rr.nhb&&this.Bb.Hb(new A.a(2,2,this.Rr.nhb,Object(m.a)(this,this.updateLockForActiveTableCellNodes,"updateLockForActiveTableCellNodes"),90,"76")),0<this.Rr.eeb&&this.Bb.Hb(new A.a(2,
2,this.Rr.eeb,Object(m.a)(this,this.removeExpiredTableCellLock,"removeExpiredTableCellLock"),90,"77"))))}get olc(){return this.Rr.JSd&&this.Rr.DYf}removeExpiredLock(){var Ta=Ua.a(this.vyb);for(const Hb of Ta){Ta=Object(pa.a)(133,this.vyb[Hb]);if(!Ta){delete this.vyb[Hb];continue}const oc=Ta.shapeNode;oc&&oc.isConnected?this.NW.p8f(oc)||this.oad(Hb)||(delete this.vyb[Hb],this.NW.f_b(oc)||Ta.kl?C.a.J(18956362,814,50,"Previous non wet changes lock is expired but the shape contains wet changes now"):
this.Gyh(Ta)):delete this.vyb[Hb]}}removeExpiredTableCellLock(){var Ta=Ua.a(this.wyb);for(const Hb of Ta){Ta=Object(pa.a)(442,this.wyb[Hb]);if(!Ta){delete this.wyb[Hb];continue}const oc=Ta.tableCellNode;oc&&oc.isConnected?Z.a.Xa(this.NW.UZb(oc))&&!this.oad(Hb)&&(delete this.wyb[Hb],this.Hyh(Ta)):delete this.wyb[Hb]}}detectLockLeak(){const Ta=[],Hb=new Date,oc=this.Ieg();for(const Oc of oc)Oc.jp&&+Hb-+Oc.pVc>this.Rr.bcb&&Ta.push(Oc.shapeNode.er);0<Ta.length&&C.a.J(21565510,828,15,"Following objects are locked longer than {0} : {1}",
this.Rr.bcb,Ta.join(";"))}switchPendingSveToFidelity(){const Ta=new Date,Hb=this.Ieg();for(const oc of Hb)oc.jp||oc.shapeNode.rd&&this.olc||!oc.Bn||oc.wx||!(+Ta-+oc.DSj>this.Rr.FHb)||oc.EA||oc.EHb()}updateLockIfImeActive(){if(this.aJg>=this.bJg&&this.kle){const Ta=this.hQi(this.kle);this.smd(Ta)&&this.Yic(Ta.slideId,Ta.get_shapeId(),2)}this.bJg=new Date}updateLockForActiveShapeNodes(){var Ta=Ua.a(this.bWc);for(const Hb of Ta)Ta=Object(pa.a)(4,this.bWc[Hb]),this.smd(Ta)&&this.Yic(Ta.slideId,Ta.get_shapeId(),
3);this.bWc={}}updateLockForActiveTableCellNodes(){var Ta=Ua.a(this.eWc);for(const Hb of Ta)if(Ta=Object(pa.a)(123,this.eWc[Hb]),this.smd(Ta)){const oc=this.Fa.$m(Ta);this.Yic(oc.slideId,oc.get_shapeId(),3,Ta.rowId.toString(),Ta.cellId.toString())}this.eWc={}}hQi(Ta){return(Ta=this.Lq.SH(Ta))?this.Fa.$m(Ta.gb):null}RVg(Ta,Hb){Hb&&Hb.node?(Ta=Object(pa.a)(5,Hb.node),Ta)?Ta.loading||Ta.Efc||Hb.property.id!==ma.a.Vp.id||(Hb=this.Fa.f7(Ta),Ta=this.wc.fCa(Ta),Hb&&(Ta?(Hb=this.zKc(Hb.slideId,Hb.get_shapeId(),
Ta.rowId.toString(),Ta.cellId.toString()),this.eWc[Hb]=Ta):(Ta=this.zsb(Hb.slideId,Hb.get_shapeId()),this.bWc[Ta]=Hb))):C.a.J(20821964,828,10,"Invalid argument."):C.a.J(20821962,828,10,"Invalid argument.")}AVk(Ta){const Hb=new A.a(2,1,this.Rr.Shd,Object(m.a)(this,this.rtcNotifyStartEditing,"rtcNotifyStartEditing"),90,"78");Hb.customData=new Da(Ta,!1);this.Bb.Hb(Hb);this.Boe[this.zsb(Ta.slideId,Ta.get_shapeId())]=Hb}rtcNotifyStartEditing(Ta){Ta=Object(pa.a)(Da,Ta.customData);const Hb=Ta.shapeNode;
this.smd(Hb)&&this.HLj(Hb)&&this.Yic(Hb.slideId,Hb.get_shapeId(),1);Ta.jrh=!0}smd(Ta){return Ta?Ta.isConnected:!1}HLj(Ta){return(Ta=this.Nk(Ta))?Ta.mN:!1}Nk(Ta){return Object(pa.a)(133,Ta.yg(this.Wb.Xm.Na))}Ieg(){const Ta=[];if(!this.ua.Ca)return Ta;var Hb=this.ua.Ca.km();if(!Hb)return Ta;for(const oc of Hb)(Hb=this.Nk(oc))&&!Hb.kl?Ta.push(Hb):C.a.J(21836046,828,50,"Shape {0} on active slide doesn't have valid view element",oc.er);return Ta}Alk(Ta){this.Inh(Ta)&&(this.SSa.amIAlone||this.AVk(Ta))}VG(Ta,
Hb){for(Ta=0;Ta<Hb.KD.length;Ta++){const Oc=Hb.KD[Ta];var oc=Object(pa.a)(4,Oc.context.node);oc&&oc.isConnected&&(oc=Object(pa.a)(133,oc.pc(this.Le)))&&(oc=this.JNg.QE(oc.shapeNode))&&(1===Oc.aba?oc.Mbc():0===Oc.aba&&oc.fse())}}zlk(Ta){if(this.Inh(Ta)&&!this.Rr.sGc){var Hb=this.zsb(Ta.slideId,Ta.get_shapeId()),oc=Object(pa.a)(A.a,this.Boe[Hb]);if(oc){const Oc=Object(pa.a)(Da,oc.customData);this.Bb.ah(oc);Oc&&Oc.jrh&&this.Yic(Ta.slideId,Ta.get_shapeId(),4);this.Boe[Hb]=null}}}Klk(Ta,Hb){this.g0g(Hb.$w)}g0g(Ta){Ta.sK()||
Ta.shapeNode.S7a?this.MZh(Ta):this.h0g(Ta)}r8c(Ta,Hb){if((Hb=Object(pa.a)(ka.TableCellNode,Hb.node))&&(Ta=Object(pa.a)(442,Hb.yg(this.Le)))&&Hb.isConnected){Hb=this.NW.UZb(Hb);const oc=this.FAe(Ta.tableCellNode);Z.a.Xa(Hb)?oc?(this.Sbe(Ta,this.Zha(oc.clientId,Ya.vSd)),this.uSe(Ta)):Z.a.Xa(Hb)&&(this.FAe(Ta.tableCellNode)||this.Hyh(Ta)):(this.Sbe(Ta,this.Zha(Hb,Ya.vSd)),this.uSe(Ta))}}Sbe(Ta,Hb){Ta.lock(Hb)}Hyh(Ta){Ta.unlock()}Yic(Ta,Hb,oc,Oc="",Yc=""){try{const Qd=new Fa(this.Cyb,Ta.Qnc,Hb,oc,Oc,
Yc);this.v$b.kea(7,Qd)}catch(Qd){C.a.J(17602625,814,10,"LockManager.SendLockNotification : MyClientId: {0}; Exception: {1}. ",this.Cyb,Qd.stack)}}xdc(Ta,Hb){this.Ha.pptCoauthSurveyFloodgateEnabled&&!this.EOg&&8===Hb.type&&this.AUa&&this.A8k(Hb)&&(C.a.J(41185738,814,50,"Log coauth activity"),this.EOg=!0,this.AUa.continueWith(()=>{this.AUa.result.logActivity("CoauthContentMerge","PptCoauthSurveyFloodgateEnabled")}));7===Hb.type&&((Ta=Hb.rxa)?Ta.clientId===this.Cyb?C.a.J(19145675,828,15,"Lock notification : lock notification from myself recieved"):
(C.a.J(17602627,828,50,"Lock notification : LockClientId {0}, MyClientId: {1}.",Ta.clientId,this.Cyb),Ta=new va(Ta.clientId,Ta.slideId,Ta.shapeId,Ta.lockType,Ta.rowId,Ta.cellId),this.b_h(Ta),this.Qyk(Ta)):C.a.J(19145673,828,10,"Lock notification: invalid lock data recieved"))}h0g(Ta){if(!Ta||Ta.kl)C.a.J(18994447,828,15,"UpdateAuthorInfoTaskHandler: shapeViewElement is null: {0}.",!Ta);else{var Hb=Ta.shapeNode;if(!(Hb.fg||this.Zee&&Hb.rd&&(this.Rr.Ppb||this.olc))){var oc=this.NW.f_b(Hb);oc?this.oVc(Ta,
this.Zha(oc,Ya.vSd)):(Hb=this.NW.p8f(Hb))?(this.oVc(Ta,this.Zha(Hb,Ya.PHi)),this.tSe(Ta)):(Hb=this.FAe(Ta.shapeNode))?(this.oVc(Ta,this.Zha(Hb.clientId,this.LZd(Hb.lockType))),this.tSe(Ta)):Ta.jp&&this.Gyh(Ta)}}}Gyh(Ta){const Hb=this.JNg.QE(Ta.shapeNode);Hb&&(Hb.Old(null),Ta.unlock(this.GOg||!Hb.v3d))}oVc(Ta,Hb){Ta.lock(Hb);Ta.sK()&&this.sa.Rh()}A8k(Ta){if(!Ta||null===Ta.rxa)return!1;Ta=this.Yqk(Ta.rxa);for(const Hb of Ta)Hb&&Hb.clientId&&(Hb.clientId.toLowerCase()===this.Cyb.toLowerCase()?(this.hKg++,
this.v0c=this.v0c===(new Date(0)).getTime()?(new Date).getTime():this.v0c,this.w0c=(new Date).getTime()):this.RGj(Hb.clientId)||(this.TKg++,this.K9b=this.K9b===(new Date(0)).getTime()?(new Date).getTime():this.K9b,this.Jme=(new Date).getTime()));return 5<=this.hKg&&5<=this.TKg&&(this.Jme>=this.v0c&&this.K9b<=this.w0c||this.w0c>=this.K9b&&this.w0c<=this.Jme)&&1<=this.zD.nsb()?!0:!1}Yqk(Ta){let Hb=null;try{Hb=Ta}catch(oc){}if(null===Hb||!Hb.length){let oc=null;try{oc=Ta}catch(Oc){C.a.J(41185744,828,
10,"UpdateHint can't convert to RTC message.")}if(null!==oc)return[oc]}return Hb}RGj(Ta){Ta=this.Zha(Ta);const Hb=this.Zha(this.Cyb);return Ta&&Hb&&Ta.userName===Hb.userName&&Ta.email===Hb.email?!0:!1}LZd(Ta){switch(Ta){case 1:return Ya.Vdl;case 2:return Ya.Hsj;case 3:return Ya.Hol;case 4:return Ya.YIi}C.a.J(20821976,828,10,"Unknown lock type");return"Unknown lock type"}b_h(Ta){if(Ta&&Ta.Chd){var Hb=Ta.Awg?this.zKc(new ra.a(Ta.Chd),Ta.shapeId,Ta.Rth,Ta.Dth):this.zsb(new ra.a(Ta.Chd),Ta.shapeId);if(4===
Ta.lockType)this.uyb[Hb]=Ta;else{var oc=Object(pa.a)(va,this.uyb[Hb]);oc?(oc=this.KZd(oc),this.KZd(Ta)>oc&&(this.uyb[Hb]=Ta)):this.uyb[Hb]=Ta}}}KZd(Ta){return this.B4i(Ta.lockType)-(+new Date-+Ta.cbe)}B4i(Ta){switch(Ta){case 1:return this.Rr.Rhd;case 2:return this.Rr.IPc;case 3:return this.Rr.$kd;case 4:return this.Rr.nqb}C.a.J(20821980,828,10,"Unknown lock type");return 0}FAe(Ta){if(Object(ya.a)(4,Ta)){Ta=Object(pa.a)(4,Ta);if(!Ta.slideId)return null;Ta=this.zsb(Ta.slideId,Ta.get_shapeId());return this.oad(Ta)}if(Object(ya.a)(123,
Ta)){Ta=Object(pa.a)(123,Ta);let Hb=this.Fa.f7(Ta);if(!Hb.slideId)return null;Ta=this.zKc(Hb.slideId,Hb.get_shapeId(),Ta.rowId.toString(),Ta.cellId.toString());return this.oad(Ta)}return null}oad(Ta){if(!Ta)return null;const Hb=Object(pa.a)(va,this.uyb[Ta]);return Hb?0>=this.KZd(Hb)?this.uyb[Ta]=null:Hb:null}tSe(Ta){const Hb=this.iaj(Ta);Hb&&(this.vyb[Hb]=Ta)}uSe(Ta){const Hb=this.Icj(Ta);Hb&&(this.wyb[Hb]=Ta)}iaj(Ta){return Ta?this.zsb(Ta.shapeNode.slideId,Ta.shapeNode.get_shapeId()):null}Icj(Ta){if(!Ta)return null;
Ta=Ta.tableCellNode;const Hb=this.Fa.f7(Ta);return this.zKc(Hb.slideId,Hb.get_shapeId(),Ta.rowId.toString(),Ta.cellId.toString())}zsb(Ta,Hb){return String.format("{0}#{1}#{2}",Ta.sid,Ta.cid,Hb)}zKc(Ta,Hb,oc,Oc){return String.format("{0}#{1}#{2}#{3}#{4}",Ta.sid,Ta.cid,Hb,oc,Oc)}vGj(Ta){const Hb=Object(pa.a)(132,this.ua.Ca);return Hb&&ra.a.Wph(Ta.Chd,Hb.Cb.Qnc)?!0:!1}Qyk(Ta){if(this.vGj(Ta)){var Hb=Ta.shapeId,oc=Ta.clientId;this.ua.Ca&&(Hb=this.ua.Ca.jS(Hb))&&(Ta.Awg&&this.Rr.JSd?this.bzk(Ta,oc,Hb):
this.Wyk(Ta,oc,Hb))}}Wyk(Ta,Hb,oc){oc.fg||this.Zee&&oc.rd&&(this.Rr.Ppb||this.olc)||!(oc=this.Nk(oc))||(this.oVc(oc,this.Zha(Hb,this.LZd(Ta.lockType))),this.tSe(oc))}bzk(Ta,Hb,oc){if((oc=this.Kcj(oc,Ta.Rth,Ta.Dth))&&oc.isConnected){var Oc=Object(pa.a)(442,oc.yg(this.Le));Oc&&Z.a.Xa(this.NW.UZb(oc))&&(this.Sbe(Oc,this.Zha(Hb,this.LZd(Ta.lockType))),this.uSe(Oc))}}Kcj(Ta,Hb,oc){Ta=this.wc.ZM(Object(pa.a)(4,Ta));if(!Ta)return null;var Oc=this.wc.fia(Ta);Ta=null;for(const Yc of Oc){Oc=this.wc.A6a(Yc);
for(const Qd of Oc)if(Qd.rowId.toString()===Hb&&Qd.cellId.toString()===oc){Ta=Qd;break}}return Ta}MZh(Ta){const Hb=new A.a(0,1,0,()=>{this.h0g(Ta)},90,"79");this.Bb.Hb(Hb)}Coi(Ta){this.aJg=new Date;this.kle=this.qPi(Ta.Hc)}qPi(Ta){return Ta?Ta.querySelector(".Paragraph"):null}Zha(Ta,Hb=""){const oc=this.zD.Zha(Ta);if(oc)return oc;C.a.J(19140752,828,50,"Failed to find presence user for client id: {0}; DataSource: {1}.",Ta,Hb);return this.mgj}Inh(Ta){return!this.Rr.mRd&&!(this.Rr.Ppb&&Ta.rd)&&!Ta.fg}}
Ya.vSd="EditingBy";Ya.PHi="EditingByInSameWorker";Ya.Vdl="StartEditing";Ya.YIi="EndEditing";Ya.Hsj="ImeTyping";Ya.Hol="Typing";Object(h.a)(Ya,"CoauthStateChangesHandler",null,[1081]);class Va{constructor(Ta){this.Esa={};this.Qv=Ta.gC;this.init(Ta)}init(Ta){if(Ta=Ta.UY)for(const Hb of Ta)Hb.ID!==this.Qv&&(this.Esa[Hb.ID]=new Date)}QYh(Ta){for(let Hb=0;Hb<Ta.length;Hb++)Ta[Hb]in this.Esa||Ta[Hb]===this.Qv||(this.Esa[Ta[Hb]]=new Date)}Yel(Ta){const Hb=this.Esa[Ta];Hb&&(C.a.J(37590341,814,50,"EditorPresenceTracker : Presence of coauthoring user never appeared, but leaving coauth; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",
this.Qv,Ta,(new Date).getTime()-Hb.getTime()),delete this.Esa[Ta])}Xel(Ta){const Hb=this.Esa[Ta];Hb&&(C.a.J(37590343,814,50,"EditorPresenceTracker : Presence of coauthoring user appeared; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.Qv,Ta,(new Date).getTime()-Hb.getTime()),delete this.Esa[Ta])}Wel(){for(const Ta of Object.keys(this.Esa))C.a.J(37590345,814,15,"EditorPresenceTracker : Presence of coauthoring user never appear; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",
this.Qv,Ta,(new Date).getTime()-this.Esa[Ta].getTime());this.Esa={}}}Object(h.a)(Va,"EditorPresenceTracker",null,[1080]);class ua{constructor(Ta){this.F4j=Ta;this.nL=new M.a;this.nL.Ig(this.F4j)}}Object(h.a)(ua,"PPTRtcProvider",null,[1078]);var Ca=d(114),Ea=d(1153),wb=d(680);class Oa{constructor(Ta,Hb,oc,Oc,Yc){this.Dca=null;this.VS=!1;this.Cee=this.Qle=null;this.aYj=Ca.a.create();this.nYc=!1;this.UYb=0;this.bT=Yc;oc.zg&&(this.findSessionResponse=Ta,Oc.zCf(Object(m.a)(this,this.xYk,"sessionPropertiesChanged")));
this.wEa=new Ea.a(()=>Hb())}get findSessionResponse(){return this.Dca}set findSessionResponse(Ta){if(this.VS)C.a.J(50943949,814,15,"PptAssignRtcMachineStrategy : FindSessionResponse Not updating cached find session response as it is already set");else if(this.Dca=Ta)this.VS=!0,this.Qle=this.Dca.IOf,this.Cee=this.Dca.pA}get ela(){return this.VS?this.Qle:this.wEa.value.ela}set ela(Ta){this.VS?this.Qle=Ta:this.wEa.value.ela=Ta}wIe(Ta){this.wEa.value.wIe(Ta)}get pA(){return this.VS?this.Cee:this.wEa.value.pA}set pA(Ta){this.VS?
this.Cee=Ta:this.wEa.value.pA=Ta}sLc(){let Ta;C.a.J(51140180,814,50,"PptAssignRtcMachineStrategy : OnConnectionStateChanged isFindSessionResponseValid:{0}, havePerformedFindSessionWithLazyStrategy:{1}",this.VS,this.nYc);return this.VS?(Ta=this.Dca.correlationId||this.aYj.toString(),C.a.J(40130654,500,50,"CorrelationId after FindSession: {0}",Ta),{returnValue:String.format("{0}&{1}={2}",this.Dca.q4,G.AFrameworkApplication.WNd,Z.a.Me(Ta)),correlationId:Ta}):this.nYc?this.wEa.value.sLc():(C.a.J(51140183,
814,50,"PptAssignRtcMachineStrategy : GetFindSessionRequestQs returning null QS to avoid crashing"),{returnValue:null,correlationId:null})}e0d(Ta,Hb,oc,Oc,Yc){C.a.J(51140185,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.VS);this.VS?(Ta(this.Dca.tVb),oc(new wb.a(this.Dca.H4c,this.Dca.E4c,this.Dca.D4c,this.Dca.QNc))):(this.wEa.value.e0d(Ta,Hb,oc,Oc,Yc),this.nYc=!0);this.bT&&this.bT.ai(26,!this.nYc)}FRd(){C.a.J(51140187,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",
this.VS);this.VS?this.VS=!1:this.wEa.value.FRd()}vla(Ta,Hb){C.a.J(51140189,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.VS);this.VS||this.wEa.value.vla(Ta,Hb)}xYk(){C.a.J(40464838,814,50,"PptAssignRtcMachineStrategy : SessionPropertiesChanged; FindSessionQs refreshed isFindSessionResponseValid:{0}",this.VS);this.VS=!1}}Object(h.a)(Oa,"PptAssignRtcMachineStrategy",null,[1079]);var ab=d(1111);class fb{constructor(){this.Pn=null}JSb(Ta,Hb){this.Pn||(this.Pn=
{});this.Pn[Hb]||(this.Pn[Hb]=0);this.Pn[Hb]+=Ta}getData(){return this.Pn}reset(){this.Pn=null}}Object(h.a)(fb,"MultiSumDataAggregator",null,[1496]);class db{constructor(Ta,Hb){this.dod=ab.a.kV(Ta,Hb,new fb,!0)}Cf(Ta){this.dod.track(1,Ta)}}Object(h.a)(db,"MultiCounter",null,[1526]);class gc{constructor(Ta,Hb,oc,Oc){this.Iy=Ta;this.D3=Hb;this.l7j=oc;this.G_j=Oc;this.Iy.Eza(Object(m.a)(this,this.DTk,"rtcOnUpdateNotificationReceived"))}DTk(Ta,Hb){0===Hb.type&&(this.G_j.Cf("CU"),this.l7j||this.JE())}JE(){!G.AFrameworkApplication.Xg&&
this.D3.RV&&this.D3.JE(null,null,null)}}Object(h.a)(gc,"ContentNotificationManager",null,[]);class ob extends gc{constructor(Ta,Hb,oc,Oc){super(Ta,Hb,oc,Oc)}static init(){if(ea.App.Fb){var Ta=ea.App.Fb.Fd;if(Ta&&(Ta.JBf(ob.AVg),Ta=Ta.Gi)&&(Ta=Ta.contentReplicator)){var Hb=ea.App.Hh;if(Hb&&Hb.Nv&&(Hb=I.a.instance.resolve("AppRealtimeChannel.IRealtimeChannel"))){var oc=G.AFrameworkApplication.fa.ka("Box4ThrottleInboundRequests"),Oc=new db(11,1);ob.RWc=ob.RWc||new ob(Hb,Ta,oc,Oc);ob.RWc.JE()}}}}static AVg(Ta){ob.RWc||
(Ta.zbh(ob.AVg),ob.init())}}ob.RWc=null;Object(h.a)(ob,"PptContentNotificationManager",gc,[]);var Sb=d(105),Jb=d(332),Ab;(function(Ta){Ta[Ta.signalRConnectFailed=0]="signalRConnectFailed";Ta[Ta.findSessionFailed=1]="findSessionFailed"})(Ab||(Ab={}));Object(h.b)("RtcConnectFailureType",Ab);var lc=d(258);class Mc{constructor(Ta,Hb,oc,Oc,Yc,Qd){this.E0c=this.oKg=this.mab=this.lab=0;this.X$a=this.VEa=this.kka=this.Y8b=this.DYc=this.PZ=null;this.$Yc=this.bZc=this.cZc=this.YYc=this.ZYc=!1;this.dNg=Ta;this.sj=
Hb;this.cL=oc;this.cL.wzc(Object(m.a)(this,this.TBb,"onNetworkHealthStateChanged"));this.Hj=Oc;this.uoe=Qd;$addHandler(window,"visibilitychange",Object(m.a)(this,this.onVisibilityChange,"onVisibilityChange"));this.l5j=Yc;this.l5j.T3h(Object(m.a)(this,this.Vkk,"onRtcConnectFailed"))}TBb(Ta,Hb){Hb.xSc||(this.bZc=this.cZc=!0)}onVisibilityChange(){window.document.hidden&&(this.YYc=this.ZYc=!0)}Vkk(Ta,Hb){Ta=Hb.UNi;if(Hb=Hb.errorMessage){if(0===Ta){let Oc,Yc;({q4d:oc,r4d:Oc,Ti:Yc}=ca.RtcUtils.o0f(Hb.ErrorDetails));
Hb.HttpErrorCode=oc;Hb.HttpErrorStatus=Oc;Hb.Exception=Yc;delete Hb.ErrorDetails;if(!oc&&this.uoe&&0<this.uoe.length)try{var oc=!0;const Qd=window.location.hostname.toLowerCase();for(const ce of this.uoe.split(";"))if(Qd.endsWith(ce)){oc=!1;break}Hb.IsCORS=oc.toString()}catch(Qd){Hb.Unexpected=Qd.message}}C.a.J(41445510,500,15,"PptRealtimeChannelMetrics:OnRtcConnectFailed; AmIAlone:{0}; IsPageHidden:{1}; IsNetworkHealthy:{2}; rtc connect failed type:{3}; errorMessage:{4}",this.sj.amIAlone,window.document.hidden,
this.Hj.RP,Ab[Ta],Sb.a.toJSON(Hb));this.$Yc||(this.$Yc=this.OKj(Ta,Hb))}}OKj(Ta,Hb){const oc=lc.c(Hb,"HttpErrorCode",-1);return 500<=oc&&599>=oc||1===Ta&&"FindSessionRequestFailed"!==Hb.FindSessionFailureReason?!0:!1}rig(){return this.PZ&&1===this.mab?this.ZYc||this.cZc:this.kka&&1<this.mab?this.YYc||this.bZc:!1}Xoj(){return this.kka&&0<this.E0c?this.YYc||this.bZc:this.PZ&&0<this.lab?this.ZYc||this.cZc:!1}Lbd(){this.lab++;this.Y8b=new Date;this.PZ||(this.PZ=new Date,this.ZYc=window.document.hidden,
this.cZc=!this.Hj.RP)}aCe(){this.Y9g(0)}Y9g(Ta){this.mab++;this.VEa=new Date;this.DYc?this.RDc>this.dNg.ufh&&(Ta={["hasExceededReconnectionThrehold"]:!0,["numberOfSuccessfullConnections"]:this.mab,["numberOfConnectionAttempts"]:this.lab,["firstConnectionAttempt"]:this.PZ?this.PZ.toISOString():"",["lastConnectionSuccess"]:this.VEa?this.VEa.toISOString():"",["lastUnexpectedDisconnect"]:this.kka?this.kka.toISOString():"",["lastExplicitDisconnect"]:this.X$a?this.X$a.toISOString():"",["reconnectDurationInMs"]:this.RDc,
["hasPageHiddenOrNetworkIssue"]:this.rig()},C.a.J(36804373,500,15,Sb.a.toJSON(Ta))):(this.DYc=this.VEa,Jb.a.instance.jc("FirstPresenceUpdated",(new Date).getTime().toString()),this.RDc>this.dNg.ufh&&(Ta={["hasExceededConnectionThrehold"]:!0,["numberOfConnectionAttempts"]:this.lab,["firstConnectionAttempt"]:this.PZ?this.PZ.toISOString():"",["firstConnectionSuccess"]:this.DYc?this.DYc.toISOString():"",["lastExplicitDisconnect"]:this.X$a?this.X$a.toISOString():"",["connectDurationInMs"]:this.RDc,["connectionDurationFromStopWatchInMs"]:Ta,
["hasPageHiddenOrNetworkIssue"]:this.rig()},C.a.J(36804373,500,15,Sb.a.toJSON(Ta))))}Mbd(){this.oKg++;const Ta={["numberOfFailedConnections"]:this.oKg,["numberOfConnectionAttempts"]:this.lab,["firstConnectionAttempt"]:this.PZ?this.PZ.toISOString():"",["lastConnectionAttempt"]:this.Y8b?this.Y8b.toISOString():"",["lastExplicitDisconnect"]:this.X$a?this.X$a.toISOString():"",["lastConnectionFail"]:(new Date).toISOString(),["disconnectedDurationMs"]:this.cFi,["hasPageHiddenOrNetworkIssue"]:this.Xoj()};
this.$Yc?e.ULS.sendTraceTag(41702299,500,15,Sb.a.toJSON(Ta)):e.ULS.sendTraceTag(36804375,500,15,Sb.a.toJSON(Ta))}Ygc(){this.E0c++;this.kka=new Date;this.YYc=window.document.hidden;this.bZc=!this.Hj.RP}fGk(){this.u7k()&&this.Mbd();this.X$a=new Date;this.xli()}xli(){this.E0c=this.mab=this.lab=0;this.VEa=this.kka=this.Y8b=this.PZ=null;this.$Yc=!1}u7k(){return!!this.Y8b&&!this.VEa&&!this.kka}get RDc(){if(this.VEa){if(this.PZ&&1===this.mab)return this.sj.IKc(this.PZ,this.VEa);if(this.kka&&1<this.mab)return this.sj.IKc(this.kka,
this.VEa)}return 0}get cFi(){return this.kka&&0<this.E0c?this.sj.IKc(this.kka,new Date):this.PZ&&0<this.lab?this.sj.IKc(this.PZ,new Date):0}}Object(h.a)(Mc,"PptRealtimeChannelMetrics",null,[1077]);var Jc=d(75),rb=d(31),cc=d(37);class jb{constructor(Ta,Hb,oc,Oc,Yc){this.S2j=Ta.toLowerCase();this.bFa=Hb;this.um=oc;this.Ow=Oc;this.Hn=Yc;this.Ow.zga(Object(m.a)(this,this.jdc,"onShapeNodeLoaded"));this.Hn.ECf(Object(m.a)(this,this.ldc,"onShapeViewElementUnlocked"))}dispose(){this.Ow.HWa(Object(m.a)(this,
this.jdc,"onShapeNodeLoaded"));this.Hn.mch(Object(m.a)(this,this.ldc,"onShapeViewElementUnlocked"))}BB(Ta){return this.Ari(Ta)||this.sPf(Ta)}sPf(Ta){if(!Ta||Ta.fg)return!1;const Hb=Ta.ta(cc.a.uSd,"");return+new Date-+Ta.pVc<this.bFa&&!!Hb&&Hb.toLowerCase()!==this.S2j}Ari(Ta){return!!this.f_b(Ta)}p8f(Ta){let Hb="";Ta&&this.sPf(Ta)&&(Hb=Ta.getValue(cc.a.uSd));return Hb}f_b(Ta){return Ta?Ta.ta(cc.a.SXf,""):""}UZb(Ta){return Ta?Ta.ta(cc.a.cii,""):""}ytl(Ta){if(Ta&&(Ta.BB=this.BB(Ta),Ta.anchor)){const oc=
this.um.aqa(Ta);for(;oc.moveNext();){var Hb=oc.currentNode;rb.ParagraphReader.Pd(Hb)&&(Hb=Object(pa.a)(Jc.AParagraphNode,Hb))&&(Hb.BB=Ta.BB)}}}ldc(Ta,Hb){this.ytl(Hb.$w.shapeNode)}jdc(Ta,Hb){Ta=Hb.node;Ta.tsl();Ta.BB=this.BB(Ta)}}Object(h.a)(jb,"PptWetChangeHandler",null,[1076,109]);class Xb{constructor(Ta){this.m4j=Ta}f2(){return this.m4j.f2()}}Object(h.a)(Xb,"PresenceCache",null,[]);var yb=d(896),mb=d(1091),Ub=d(1178),ec=d(981),nc=d(1166);class Lb extends v.a{constructor(){super();this.n1c=[]}yza(Ta){Ta&&
(C.a.J(8958528,814,50,"PresenceDataManager : AddPresence; clientId: {0}; presence: {1}",Ta.clientId,Ta.presence.toString()),Array.add(this.n1c,Ta))}rcd(Ta){(Ta=this.I6a(Ta))&&this.jEb(Ta);return Ta}jEb(Ta){Ta&&(C.a.J(8958530,814,50,"PresenceDataManager : RemovePresence; clientId: {0}; presence: {1}",Ta.clientId,Ta.presence.toString()),Array.remove(this.n1c,Ta))}I6a(Ta){for(const Hb of this.n1c)if(Hb.clientId===Ta)return Hb;return null}f2(){return this.n1c}}Object(h.a)(Lb,"PresenceDataManager",v.a,
[]);var Zc=d(38),Pb=d(715);class eb{constructor(Ta,Hb,oc,Oc,Yc,Qd,ce,id,gb,pc,zc){this.clientId=Ta;this.data=ce;this.chatThreadId=Hb;this.chatThreadDiscoveryUri=oc;this.inChat=Oc;this.email=Yc;this.capabilities=Qd;this.userName=id;this.clientType=gb;this.fHasClientEverExperiencedNetworkLoss=pc;this.isAnonymous=zc}}Object(h.a)(eb,"SerializablePresenceInfo",null,[]);class $a{constructor(Ta,Hb,oc,Oc,Yc,Qd,ce,id,gb,pc,zc){this.m$b=null;this.Qv=Ta.toLowerCase();this.TA=Hb;this.Bne=oc;this.RCg=Oc;this.QCg=
Yc;this.RGg=Qd;this.p7b=ce;this.HCg=id;this.bla=gb;this.bNg=pc;this.JEg=zc}m0d(){return new eb(this.Qv,this.RCg,this.QCg,this.RGg,this.p7b,this.HCg.capabilities,this.Bne?this.Bne.m0d():null,this.bla,this.bNg,this.JEg,G.AFrameworkApplication.yhb||G.AFrameworkApplication.XP)}hpj(Ta){if(!(Ta&&this.Lj.equals(Ta.slideId)&&this.presence&&this.presence.GT))return!1;for(const Hb of this.presence.GT)if(Hb===Ta.get_shapeId())return!0;return!1}get presence(){return this.Bne}get clientId(){return this.Qv}get chatThreadId(){return this.RCg}get chatThreadDiscoveryUri(){return this.QCg}get inChat(){return this.RGg}get email(){return this.p7b}get capabilities(){return this.HCg}get Lj(){return this.TA}get userName(){return this.bla}get clientType(){return this.bNg}get fHasClientEverExperiencedNetworkLoss(){return this.JEg}get presenceUser(){return this.m$b}set presenceUser(Ta){this.m$b&&
(Ta?!this.m$b.client||0===this.m$b.client||Ta.client&&0!==Ta.client||C.a.J(50942305,814,50,"PresenceEntry::SetPresenceUser; Specific to non-specific ClientType {0}.",this.Qv):C.a.J(50942303,814,50,"PresenceEntry::SetPresenceUser; Non-null to null PresenceUser {0}.",this.Qv));this.m$b=Ta}static LEc(Ta){if(!Ta||!Ta.clientId)return C.a.J(50942301,814,50,"PresenceEntry : CreateFromData; Invalid presence info"),null;const Hb=Pb.a.LEc(Ta.data);let oc=0;Ta.clientType&&8>=Ta.clientType&&(oc=Ta.clientType);
return new $a(Ta.clientId,Hb.Lj,Hb,Ta.chatThreadId,Ta.chatThreadDiscoveryUri,Ta.inChat,Ta.email,new oa.a(Ta.capabilities),Ta.userName,oc,Ta.fHasClientEverExperiencedNetworkLoss)}}Object(h.a)($a,"PresenceEntry",null,[]);class vb extends Sys.EventArgs{constructor(Ta,Hb,oc,Oc,Yc,Qd){super();this.TA=Ta;this.P7j=oc;this.H2c=Hb;this.cMh=Oc;this.l6j=Yc;this.o4j=Qd}get slideId(){return this.TA}get user(){return this.P7j}get shapes(){return this.H2c}get u7(){return this.cMh}get iqh(){return this.l6j}get l5g(){return this.o4j}}
Object(h.a)(vb,"SlidePresenceChangedEventArgs",Sys.EventArgs,[]);var bc=d(28);class Cc extends v.a{constructor(Ta,Hb,oc,Oc,Yc,Qd,ce,id,gb,pc,zc,Ic,Fc,rd,Yd,me,Db,af,bg,Qe,Af,tf,uf,kg,Lg,$g,yf){super();this.nQ=new Lb;this.so=null;this.rDg=[];this.sDg=null;this.Swb=!0;this.F$a=!1;this.lJg=new Date;this.LUa=null;this.TEg=this.KEg=this.mGg=!1;this.m1c=null;this.A8=Ta;Ta.userName||(Ta.userName=kg);this.kc=Hb;this.Iy=oc;this.Qv=Oc.clientId;this.X8=Oc.hw;this.ee=Yc;this.hc=Af;this.j$b=Qe;this.bT=tf;this.cL=
Lg;this.H8=$g;this.$ja=yf;uf.execute(Kf=>{this.so=Kf});this.sqj();this.sj=Fc;this.jq=rd;this.zke=Yd.gvg;this.vIg=Yd.XKj;this.w8b=Yd.podsDefaultToRtcForPresenceEnabled;this.O0j=Yd.podsNoClientRtcConnectWhenAccessTokenExpiredEnabled;this.MIg=G.AFrameworkApplication.wz;this.jke=Yd.zg&&Yd.pptNoRtcConnectWhenReadOnlyEnabled;this.sa=Qd;this.sa.VJ(Object(m.a)(this,this.VG,"onSelectionChanged"));this.Pr=ce;this.Pr.Q4h(Object(m.a)(this,this.cnk,"onValidShapeIdLoaded"));this.zd=id;this.zd.DR(Object(m.a)(this,
this.rek,"onActiveSlideDOMReady"));this.zG=gb;this.zG.gGd(Object(m.a)(this,this.L6c,"onEditorTableUpdate"));this.Vh=me;this.Vh.wB(Object(m.a)(this,this.ZA,"onSessionEnd"));this.Vh.xB(Object(m.a)(this,this.eo,"onSessionRehydrated"));this.Vh.JMa(Object(m.a)(this,this.$cc,"onOutboundReplication"));this.nXj=Yd.pptAwayStatusTimeGapForPresenceUpdateInMs;this.YEg=Yd.qbl;this.ia=zc;this.ua=pc;this.o1c=Ic;this.WXc=Db;this.Pab=af;this.Ywb=bg;Yd.zg&&(this.Vh.yCf(Object(m.a)(this,this.gdc,"onSessionAccessTokenExpiring")),
this.Vh.Nzc(Object(m.a)(this,this.Ila,"onSessionAccessTokenExpired")),this.Vh.zGd(Object(m.a)(this,this.b8c,"onSessionExpired")),this.kc.gf(()=>{this.A8.userName=this.kc.appSettings.UserName;this.A8.email||(this.A8.email=G.AFrameworkApplication.fa.Ia("UserPrincipalName"));this.hc.AK||(C.a.J(512360717,814,50,"PresenceManager : Disconnect from RTC"),this.disconnect());this.jke&&this.Vh.Bga(Object(m.a)(this,this.Wz,"onUnifiedAppStateChanged"))}),this.MIg&&this.Vh.Qzc(Object(m.a)(this,this.Hda,"onWopiTokenRefreshed")));
C.a.J(512360716,814,50,"PresenceManager - m_isWopiTokenRefreshEnabled:{0}",this.MIg)}wb(){this.ia.ra(bc.a.uWa,Zc.a.application,Object(m.a)(this,this.uWa,"querySlidePresenceUsers"),96)}uWa(Ta,Hb,oc,Oc,Yc){Yc.Gkc=this.g0b(Yc.slideId);Yc.k5g=this.nsb();return 32}g0b(Ta){return(Ta=this.Vcg(Ta))?Ta.length:0}sqj(){this.Iy.B2a(Object(m.a)(this,this.Sqi,"connectionStateChanged"));this.Iy.Kzc(Object(m.a)(this,this.presenceUpdated,"presenceUpdated"));G.AFrameworkApplication.fa.ka("PPTForceUpdateEditorTableEnabled")&&
this.Iy.Eza(Object(m.a)(this,this.Csl,"updateNotificationReceived"));K.a.getInstance().D1h(Object(m.a)(this,this.JXg,"onGotCompletePersistentStateWithMetadata"));this.YEg&&this.cL.wzc(Object(m.a)(this,this.rjk,"onNetworkHealthChanged"));this.LUa=this.X8.wi("WebServiceCall","RtcConnection");this.bT.hKi();this.Iy.connect()}B$g(){const Ta=this.Iy.iKc();this.BAh(new mb.a(Ta,null));this.Uic()}rjk(Ta,Hb){Hb.xSc||(this.bT.iKi(),this.KEg=!0)}JXg(Ta,Hb){this.bT.lKi(Hb.jxk);K.a.getInstance().CMk(Object(m.a)(this,
this.JXg,"onGotCompletePersistentStateWithMetadata"))}Sqi(Ta,Hb){C.a.J(512360715,814,50,"PresenceManager : Connection State changed; oldState: {0}; newState: {1}; MyClientId: {2}",Cc.PXd(Hb.oldState),Cc.PXd(Hb.newState),this.Qv);switch(Hb.newState){case 2:this.LUa.stop();Ta=this.LUa.vq;this.bT.gKi();this.B$g();this.j$b.Y9g(Ta);break;case 1:2===Hb.oldState&&this.j$b.Ygc();this.j$b.Lbd();break;case 0:this.Swb?this.Cli():2===Hb.oldState&&(window.setTimeout(()=>{this.Iy.connect()},0),C.a.J(512360714,
814,50,"PresenceManager : Reconnect rtc; Session time: {0}",this.ee.X_b().getTime()),this.j$b.Ygc())}}getSelectedShapes(){if(!this.vIg)return null;const Ta=[],Hb=this.sa.he();for(let oc=0;oc<Hb.length;++oc)Array.add(Ta,Hb[oc].get_shapeId());0<Ta.length&&Ta.sort();return Ta}Cli(){var Ta=this.nQ.f2();if(Ta&&Ta.length){Ta=Array.clone(Ta);for(const Hb of Ta)this.jEb(Hb);this.raiseEvent("PresenceChanged")}}$Ge(Ta,Hb){try{this.A8.email||(this.A8.email=G.AFrameworkApplication.fa.Ia("UserPrincipalName"));
const oc=new Pb.a(Ta,Hb),Oc=new $a(this.A8.clientId,Ta,oc,this.A8.chatThreadId,this.A8.chatThreadDiscoveryUri,this.A8.inChat,this.A8.email,this.A8.capabilities,this.A8.userName,1,this.KEg);this.A8.email||C.a.J(512360713,814,15,"PresenceManager : SendPresence; empty email for user");this.Iy.$Ge(Oc.m0d()).continueWith(()=>{C.a.J(8958538,814,50,"PresenceManager : SendPresence; Send presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.Qv,oc.toString(),this.ee.X_b().getTime())});this.lJg=
new Date;this.bT.QTj();this.cGk(Ta,Hb);C.a.J(8958540,814,50,"PresenceManager : SendPresence; Sending presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.Qv,oc.toString(),this.ee.X_b().getTime());this.DGk(oc)}catch(oc){C.a.J(512360712,814,10,"PresenceManager : SendPresence; Exception creating presence data {0}; MyClientId: {1};",oc.toString(),this.Qv)}}presenceUpdated(Ta,Hb){Ta=!!this.so&&this.so.XY;C.a.J(8958544,814,50,"PresenceManager : PresenceUpdated; Received presence update; MyClientId: {0}, Rehydrating: {1} ",
this.Qv,Ta);if(!Ta){this.bT.STj(Hb.hJb);Ta=null;this.X8&&(Ta=this.X8.wi("ServerNotification","Presence Updated"));try{this.BAh(Hb)}finally{Ta&&Ta.stop()}}}Csl(Ta,Hb){C.a.J(512360711,814,50,"PresenceManager : Update notification received; Type: {0}; MyClientId: {1}",Hb.type,this.Qv)}BAh(Ta){this.c_h(Ta.hJb);this.geb(Ta.mWf);C.a.J(8958546,814,50,"PresenceManager::UpdatePresenceCache; Refresh Peoples Well on presence update");this.raiseEvent("PresenceChanged")}Uic(){this.ua.Lj?this.$Ge(this.ua.Lj,this.getSelectedShapes()):
C.a.J(512360708,814,50,"PresenceManager::SendCurrentSelection: m_graphTopologyManager.CurrentSlideId is null")}VG(){if(this.ua.Lj){var Ta=this.getSelectedShapes();(Cc.lpj(this.sDg,this.ua.Lj)||Cc.z3d(Ta,this.rDg))&&this.Uic()}else C.a.J(512360707,814,50,"PresenceManager::OnSelectionChanged: m_graphTopologyManager.CurrentSlideId is null")}rek(Ta,Hb){Hb.Ca?this.ua.Lj?this.Uic():C.a.J(512360705,814,50,"PresenceManager::OnActiveSlideDOMReady: m_graphTopologyManager.CurrentSlideId is null"):C.a.J(512360706,
814,50,"PresenceManager::OnActiveSlideDOMReady: ActiveSlide is null")}cnk(Ta,Hb){this.ua.Lj?Array.contains(this.getSelectedShapes(),Hb.shapeNode.get_shapeId())&&this.Uic():C.a.J(512360704,814,50,"PresenceManager::OnValidShapeIdLoaded: m_graphTopologyManager.CurrentSlideId is null")}Jal(Ta,Hb,oc){Hb=this.V6f(Hb);Ta=this.V6f(Ta);this.ee.cYi().Ulc.raiseEvent(Cc.ySd,new Ub.a(this.sj.gC,null,Hb,Ta,null,0,0,oc))}V6f(Ta){const Hb=new ec.a;for(let oc=0;oc<Ta.length;oc++){const Oc=Ta[oc];if(!Oc)continue;if(Oc.ID===
this.sj.gC)continue;if(!Oc.EmailAddress){Hb.$(Oc.ID,this.U6f(Oc));continue}const Yc=this.nQ.I6a(this.sj.gC);Yc&&Yc.email&&Oc.EmailAddress&&Yc.email.toUpperCase()===Oc.EmailAddress.toUpperCase()||Hb.$(Oc.EmailAddress.toUpperCase(),this.U6f(Oc))}return Hb.values}U6f(Ta){const Hb=new nc.a;Hb.EmailAddress=Ta.EmailAddress;Hb.Id=Ta.ID;Hb.Name=Ta.Name;return Hb}L6c(Ta,Hb){this.Jal(Hb.Lyg,Hb.XFf,Hb.SDj);if(Ta=this.sj.UY){var oc=Hb.Lyg;for(var Oc=0;Oc<oc.length;Oc++)this.WXc.Yel(oc[Oc].ID);oc=[];Hb=Hb.XFf;
for(Oc=0;Oc<Hb.length;Oc++){let Qd=Hb[Oc];const ce=Qd.ID;if(ce!==this.sj.gC){const id=this.nQ.I6a(ce);id?this.Ywb.iIf(id.email,Qd.EmailAddress):Array.add(oc,ce)}}this.WXc.QYh(oc);2<=Ta.length&&C.a.J(512360674,814,50,"PresenceManager : EditorTable has atleast 2 coauthors; MyClientID: {0}; EditorTableCount: {1}",this.Qv,Ta.length);oc=[];Hb=[];for(var Yc of Ta)Array.add(oc,Yc.ID),Yc.ID===this.sj.gC||this.nQ.I6a(Yc.ID)||Array.add(Hb,Yc.ID);C.a.J(512360673,814,50,"PresenceManager : OnEditorTableUpdate; Received Editor Table update; MyClientID: {0}; editorTableCount: {1}; ClientIDs : {2}; ClientIDs with missing presence: {3}",
this.Qv,Ta.length,oc.join(","),Hb.join(","));for(const Qd of this.nQ.f2())({editor:Yc}=this.sj.lhb(Qd.clientId)).returnValue?this.upj(Yc.ColorIndex)?(this.zGk(Qd),Ta=this.Pab.iCa(new yb.a(Yc.EmailAddress,void 0,Yc.Name),Yc.ColorIndex,Yc.ID,0),Qd.presenceUser=new H.a(Qd.clientId,Yc.Name,Ta,new oa.a(1),null,null,Qd.clientType),this.o1c.Bbd(new vb(Qd.Lj,Qd.presence.GT,Qd.presenceUser,!0,this.g0b(Qd.Lj),this.nsb())),C.a.J(512360671,814,50,"PresenceManager : OnEditorTableUpdate; Adding/Updating presence UI; ClientId: {0};  Presence: {1}; Color: {2}; MyClientId: {3};",
Qd.clientId,Qd.presence.toString(),Qd.presenceUser.color,this.Qv)):C.a.J(512360672,814,50,"PresenceManager : OnEditorTableUpdate; EditorInfo has no color assigned; ClientId: {0};  Presence: {1}; MyClientId: {2};",Qd.clientId,Qd.presence.toString(),this.Qv):C.a.J(512360670,814,50,"PresenceManager : OnEditorTableUpdate; Client not in Editor table; ClientId: {0};  Presence: {1}: Color: {2}; MyClientId: {3};",Qd.clientId,Qd.presence.toString(),Qd.presenceUser?Qd.presenceUser.color:"",this.Qv);this.raiseEvent("PresenceChanged")}else C.a.J(512360675,
814,50,"PresenceManager : OnEditorTableUpdate; Received null on Editor Table update; MyClientID: {0};",this.Qv)}ZA(Ta,Hb){this.WXc.Wel();5!==Hb.aJ&&(C.a.J(512360669,814,50,"PresenceManager : OnSessionEnd - Disconnect from RTC"),this.disconnect())}gdc(){C.a.J(512360668,814,50,"PresenceManager : OnSessionAccessTokenExpiring");this.F$a||(C.a.J(512360667,814,50,"PresenceManager : OnSessionAccessTokenExpiring; Access token expired"),this.F$a=!0)}Ila(){C.a.J(512360666,814,50,"PresenceManager : OnSessionAccessTokenExpired; Disconnecting from RTC");
this.F$a||(C.a.J(512360665,814,50,"PresenceManager : OnSessionAccessTokenExpired; Access token expired"),this.F$a=!0)}b8c(){C.a.J(512360664,814,50,"PresenceManager : OnSessionExpired - Disconnect from RTC");this.disconnect()}Hda(Ta,Hb){C.a.J(512360663,814,50,"PresenceManager : OnWopiTokenRefreshed");try{Hb.RTc?(C.a.J(512360662,814,50,"PresenceManager::OnWopiTokenRefreshed Token refresh succeeded. - RTC Connection State: {0}",Cc.PXd(this.Iy.connectionState)),this.F$a=!1,this.jke&&!this.hc.AK?C.a.J(512360661,
814,15,"PresenceManager : OnWopiTokenRefreshed; Do not connect to RTC in readonly mode"):this.Swb||2!==this.Iy.connectionState?this.connect():(Ta={},Ta.qs=this.$ja.presentationId.string,C.a.J(512360660,814,50,"PresenceManager : OnWopiTokenRefreshed; Calling UpdateClientInfo"),this.Iy.phb(Ta))):C.a.J(512360659,814,15,"PresenceManager::OnWopiTokenRefreshed Token refresh failed.")}catch(oc){C.a.J(512360658,814,10,"PresenceManager::OnWopiTokenRefreshed Exception: {0}",oc)}}eo(Ta,Hb){this.O0j&&this.F$a||
this.jke&&!this.hc.AK?C.a.J(512360657,814,50,"PresenceManager : OnSessionRehydrated; Do not connect to RTC; IsAccessTokenExpired={0}; IsInEditingModeOrCanEditAnyway={1};",this.F$a,this.hc.AK):4!==Hb.Kva||this.Swb?this.connect():(C.a.J(512360656,814,50,"PresenceManager : OnSessionRehydrated - catch up presence"),this.B$g())}Wz(Ta,Hb){Hb.S8d&&!this.hc.AK&&(C.a.J(512360655,814,50,"PresenceManager : OnUnifiedAppStateChanged; Change to readonly, disconnect from RTC"),this.disconnect())}connect(){C.a.J(512360654,
814,50,"PresenceManager : Connect");this.Swb=!1;this.Iy.connect()}$cc(){this.J7k()&&(C.a.J(512360653,814,50,"PresenceManager : OnOutboundReplication; Send presence update for editing actions"),this.Uic())}J7k(){const Ta=this.Iy.M5i();return Ta?2===Ta.status||+new Date-+this.lJg>this.nXj?!0:!1:!1}iJj(){const Ta=this.nQ.f2();if(0<Ta.length)for(const Hb of Ta)if(Hb.presence&&Hb.presence.Lj)return!0;return!1}i7k(){return!this.mGg&&this.w8b&&2!==this.sj.Waa}c_h(Ta){for(let oc in Ta){var Hb=Ta[oc];try{const Oc=
$a.LEc(Hb);if(!Oc||Oc.clientId===this.Qv)continue;const Yc=Oc.clientId;this.i7k()&&(this.mGg=!0,this.jq.Zmc(2),C.a.J(512360652,814,50,"PresenceManager : Update coauth status to Coauthoring from RTC"));C.a.J(39326610,814,50,"PresenceManager : AddOrUpdatePresence; ClientId: {0}; NewPresence: {1};",Yc,Oc.presence.toString());const Qd=Oc.email;if(!this.Ywb.lYd(Qd)){let ce;({editor:ce}=this.sj.lhb(Yc)).returnValue&&this.Ywb.iIf(Qd,ce.EmailAddress)}this.e_h(Oc);this.bT.fKi()}catch(Oc){C.a.J(512360651,814,
10,"PresenceManager : AddOrUpdatePresence; Invalid Presence Data Received {0}; MyClientId: {1};",Oc.toString(),this.Qv)}}this.bT.RTj(Ta)}e_h(Ta){this.cJi(Ta);const Hb=this.Iy.t2(Ta.clientId);Hb&&2===Hb.status?C.a.J(39326613,814,50,"PresenceManager : AddOrUpdatePresenceWithAwayStatus; Do not add presence for inactive user; ClientId: {0};",Ta.clientId):this.d_h(Ta)}d_h(Ta){const Hb=this.nQ.I6a(Ta.clientId);if(Hb){if(!this.bpj(Hb,Ta))return;C.a.J(8958560,814,50,"PresenceManager : AddOrUpdatePresence; Updating existing presence; ClientId: {0};  ExistingPresence: {1}; NewPresence: {2}; MyClientId: {3};",
Ta.clientId,Hb.presence.toString(),Ta.presence.toString(),this.Qv);this.jEb(Hb)}this.u_h(Ta)}jEb(Ta){Ta&&(this.nQ.jEb(Ta),Ta.presenceUser&&this.o1c.Bbd(new vb(Ta.Lj,Ta.presence.GT,Ta.presenceUser,!1,this.g0b(Ta.Lj),this.nsb())))}LZf(Ta){if(Ta)if(Ta.presenceUser)C.a.J(512360649,814,100,"PresenceManager:AddOrUpdatePresence; PresenceUser already created for ClientId{0};",Ta.clientId);else{const Hb=this.rbg(Ta.clientId);Hb?Ta.presenceUser=Hb:C.a.J(512360650,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",
Ta.clientId)}}u_h(Ta){Ta&&(this.nQ.yza(Ta),this.WXc.Xel(Ta.clientId),this.LZf(Ta),Ta.presenceUser?this.o1c.Bbd(new vb(Ta.Lj,Ta.presence.GT,Ta.presenceUser,!0,this.g0b(Ta.Lj),this.nsb())):C.a.J(512360648,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",Ta.clientId))}upj(Ta){return!this.zke||Ta?!0:!1}bpj(Ta,Hb){let oc;(oc=!Ta.Lj.equals(Hb.Lj))&&C.a.J(512360647,814,50,"Slide Presence Changed - CurrentSlide: {0} ; NewSlide: {1}",Ta.Lj,Hb.Lj);(Ta=this.vIg&&Cc.f5k(Ta,Hb))&&
C.a.J(512360646,814,50,"Shape Presence Changed");return oc||Ta}geb(Ta){if(Ta){for(let Hb=0;Hb<Ta.length;Hb++)Ta[Hb]=Ta[Hb].toLowerCase();for(const Hb of Ta)C.a.J(512360645,814,50,"PresenceManager : RemovePresence; Removing presence for disconnected clients; ClientId: {0}",Hb),(Ta=this.nQ.rcd(Hb))?Ta.presenceUser?this.o1c.Bbd(new vb(Ta.Lj,Ta.presence.GT,Ta.presenceUser,!1,this.g0b(Ta.Lj),this.nsb())):C.a.J(512360643,814,15,"PresenceManager : RemovePresence; entry.PresenceUser is null"):C.a.J(512360644,
814,15,"PresenceManager : RemovePresence; entry did not exist")}}Vcg(Ta){const Hb=[];for(const oc of this.nQ.f2())oc.Lj.equals(Ta)&&oc.presenceUser&&Array.add(Hb,oc.presenceUser);return Hb}Fcg(Ta){const Hb=[];for(const oc of this.nQ.f2())oc.presence&&oc.hpj(Ta)&&oc.presenceUser&&Array.add(Hb,oc.presenceUser);return Hb}HZb(){const Ta=[];for(const Hb of this.nQ.f2())Hb.presenceUser&&Array.add(Ta,Hb.presenceUser);return Ta}nsb(){const Ta=this.HZb();return Ta?Ta.length:0}Zha(Ta){if(!Ta)return null;Ta=
Ta.toLocaleLowerCase();for(const Hb of this.nQ.f2())if(Hb.presenceUser&&Hb.presenceUser.clientId===Ta)return Hb.presenceUser;return this.rbg(Ta)}rcd(Ta){const Hb=this.nQ.I6a(Ta);this.jEb(Hb);C.a.J(512360641,814,50,"PresenceManager : RemoveUserPresence; Removing presence; ClientId: {0};  MyClientId: {1};",Hb?Hb.clientId:Ta+" not found",this.Qv)}E3h(Ta){this.addHandler("PresenceChanged",Ta)}f2(){return this.nQ.f2()}connectionState(){return this.Iy.connectionState}disconnect(){try{C.a.J(512360640,814,
50,"PresenceManager : Disconnect"),this.Swb||this.j$b.fGk(),this.Swb=!0,this.Iy.disconnect()}catch(Ta){C.a.J(512360611,814,10,"PresenceManager : Disconnect; Exception disconnecting rtc; Message: {0}; Callstack: {1}",Ta.message,Ta.stack)}}cGk(Ta,Hb){this.sDg=Ta;this.rDg=Hb}rbg(Ta){let Hb;const oc=({editor:Hb}=this.sj.lhb(Ta)).returnValue;var Oc=this.Iy.Ara(Ta),Yc=!!Oc;if(!oc&&!Yc)return C.a.J(512360610,814,50,"PresenceUser:GetPresenceUser; ClientId {0} neither in presence nor rtc.",Ta),null;Oc=Yc?
Oc:null;oc||C.a.J(512360609,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in EditorTable",Ta);Yc||C.a.J(512360608,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in Presence",Ta);Yc&&oc&&C.a.J(512360607,814,50,"PresenceUser:GetPresenceUser; ClientId {0} in both. IsSameID={1}, IsSameEmail={2}.",Ta,Oc.clientId!==Hb.ID,Oc.email!==Hb.EmailAddress);var Qd=oc?new yb.a(Hb.EmailAddress,void 0,Hb.Name):new yb.a(this.Ywb.lYd(Oc.email)||Oc.email,void 0,Oc.userName);Qd=this.Pab.iCa(Qd,oc?Hb.ColorIndex:
null,oc?Hb.ID:Oc.clientId,0);Yc=Yc?Oc.clientType:0;return new H.a(Ta,oc?Hb.Name:Oc.userName,Qd,new oa.a(1),null,null,Yc)}zGk(Ta){this.ua.Lj.equals(Ta.Lj)&&Ta.presence.GT&&Ta.presence.GT.length&&C.a.J(512360606,814,50,"PresenceManager : {0}; Begin to add shape presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",Ta.clientId,Ta.presence.toString(),this.Qv,this.ee.X_b().getTime());C.a.J(512360605,814,50,"PresenceManager : {0}; Begin to add slide presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}",
"OnEditorTableUpdate",Ta.clientId,Ta.presence.toString(),this.Qv,this.ee.X_b().getTime())}DGk(Ta){const Hb=[this.sj.userName];let oc=0;for(var Oc of this.nQ.f2())Oc.presence.Lj.equals(Ta.Lj)&&!Cc.z3d(Oc.presence.GT,Ta.GT)&&(oc++,Oc.presenceUser&&Array.add(Hb,Oc.presenceUser.userName));if(0<oc){Oc={};let Yc=0,Qd=0;for(let ce=0;ce<Hb.length;++ce){let id=Hb[ce];id&&id.length||(id="anonymous",Qd++);id in Oc||(Oc[id]=!0,Yc++)}C.a.J(512360604,814,50,"PresenceManager : {0} users, {2} unique users are selecting same {1}. {3} users have no identity",
oc+1,Ta.GT&&0<Ta.GT.length?"shape":"slide",Yc,Qd)}}cJi(Ta){try{!this.bT.FNi()||this.nQ.I6a(Ta.clientId)||this.YEg&&Ta.fHasClientEverExperiencedNetworkLoss||(this.LZf(Ta),this.dJi(Ta.presenceUser))}catch(Hb){C.a.J(512360603,814,15,"PresenceManager:EndPresenceBootTelemetry; Exception {0};",Hb.toString())}}dJi(Ta){Ta&&Ta.clientId&&(this.TEg||this.m1c||(this.TEg=!0,this.m1c=I.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),this.m1c&&this.m1c.hJi(Ta.clientId,Cc.U9i(Ta)))}static PXd(Ta){let Hb=
"";switch(Ta){case 2:Hb="Connected";break;case 1:Hb="Connecting";break;case 0:Hb="Disconnected"}return Hb}static z3d(Ta,Hb){if(!Ta&&!Hb)return!1;if(!Ta&&Hb||Ta&&!Hb||Ta.length!==Hb.length)return!0;for(let oc=0;oc<Ta.length;oc++)if(Ta[oc]!==Hb[oc])return!0;return!1}static lpj(Ta,Hb){return!ra.a.Sma(Ta,Hb)}static f5k(Ta,Hb){return Ta.Lj.equals(Hb.Lj)&&Cc.z3d(Ta.presence.GT,Hb.presence.GT)}static U9i(Ta){return Ta&&1===Ta.client?1:0}}Cc.ySd="ETU";Object(h.a)(Cc,"PresenceManager",v.a,[1072,1073,1074,
1075]);var Gc=d(1096),sd=d(1099),Sd=d(996),ie=d(72),De=d(47),yd=d(363);class ib{constructor(Ta,Hb,oc,Oc,Yc){this.Ft=null;this.Gx=G.AFrameworkApplication.fa.ka(qa.a.bHa);Hb=this.c8i(Hb,Oc,Yc);this.Ft=this.Gx?(new Gc.a(Hb)).lpb(Ta):(new sd.a(Hb)).KEc(Ta,oc)}dispose(){this.Ft.dispose()}Zye(){return De.a.ei(document.getElementById(yd.a.yBc))}c8i(Ta,Hb,oc){const Oc=new Sd.a;Oc.add(0,ie.getImageClassWithCluster(G.AFrameworkApplication.bN,"MoreUsersGlyph_16x16x32"));Oc.add(5,G.AFrameworkApplication.Rl);
Oc.add(1,ie.getImageClassWithCluster(G.AFrameworkApplication.bN,this.Gx?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph_16x16x32"));Oc.add(4,G.AFrameworkApplication.Rl);Oc.add(6,oc);Oc.add(8,G.AFrameworkApplication.isRtl);Oc.add(12,Ta);Oc.add(11,Hb);this.Gx&&(Oc.add(16,Object(m.a)(this,this.Zye,"presenceViewportBoundsCallback")),Oc.add(17,!0));return Oc}kz(Ta){this.Ft?(C.a.J(8958619,814,50,"PresencePawn:AddUser at PresencePawn for ClientId {0}",Ta.clientId),this.Ft.kz(Ta)):C.a.J(8958617,814,
10,"PresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {0}",Ta.clientId)}BL(Ta){this.Ft?(C.a.J(8958623,814,50,"PresencePawn:RemoveUser at PresencePawn for ClientId {0}",Ta.clientId),this.Ft.BL(Ta.clientId)):C.a.J(8958621,814,15,"PresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser for ClientId {0}",Ta.clientId)}clear(){if(this.Ft)if(C.a.J(8958627,814,50,"PresencePawn:Clear at PresencePawn "),this.$ha())for(const Ta of this.$ha())this.BL(Ta);else C.a.J(8958657,
814,50,"PresencePawn:Clear - Pawn has no users");else C.a.J(8958625,814,15,"PresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}$ha(){return this.Ft?this.Ft.xdb:null}vLe(){this.Ft&&(this.Gx&&this.Ft.tea(),this.Ft.vwa())}R3d(){this.Ft&&this.Ft.tea()}}Object(h.a)(ib,"PresencePawn",null,[303,109]);class dc{Szi(Ta,Hb,oc){return new ib(Ta,2,Hb,!0,oc)}}Object(h.a)(dc,"PresencePawnFactory",null,[1039]);var Bc=d(30);class Ob{constructor(Ta,Hb,oc,Oc,Yc,Qd,ce,id,gb,pc,zc){this.$me=[];
this.AUa=null;this.AFg=this.zFg=this.hie=0;this.WYc=this.XYc=null;this.X0c=[];if(!Hb)throw Error.argumentNull("graphTopologyManager");if(!oc)throw Error.argumentNull("presenceManager");if(!Oc)throw Error.argumentNull("dragInputManager");if(!Yc)throw Error.argumentNull("coauthStateChangesHandler");this.zd=Ta;this.ua=Hb;this.zD=oc;this.yt=Oc;this.oee=Yc;this.Cka=Qd;this.Ub=ce;this.Le=id;this.Gbb=gb;this.Aka=pc;this.a_=zc;this.Aka.H2a(Object(m.a)(this,this.Hhd,"slidePresenceChanged"));this.zd.DR(Object(m.a)(this,
this.RVa,"onSlideNavigation"));this.zd.DGd(Object(m.a)(this,this.gCb,"onThumbnailRefresh"));this.zd.Kmb(Object(m.a)(this,this.Zve,"onThumbnailVisibleRangeChanged"));this.nHg=G.AFrameworkApplication.fa.ka(qa.a.z4g);(this.Gx=G.AFrameworkApplication.fa.ka(qa.a.bHa))&&this.nHg&&(this.zFg=G.AFrameworkApplication.fa.Gc(qa.a.vvk,30),this.AFg=G.AFrameworkApplication.fa.Gc(qa.a.wvk,3),this.hie=0,this.AUa=E.a.su(I.a.instance.Oa("Common.ISystemInitiatedFeedbackWithTimeLapse")));this.zd.CSb(Object(m.a)(this,
this.o5k,"shapeViewElementAdded"));this.zd.CCf(Object(m.a)(this,this.p5k,"shapeViewElementLocked"));this.zd.h3h(Object(m.a)(this,this.Llk,"onShapeViewElementShowLockHint"));this.zd.i3h(Object(m.a)(this,this.Mlk,"onShapeViewElementShowPresenceHint"));this.zd.f3h(Object(m.a)(this,this.Flk,"onShapeViewElementHidePresenceHint"))}RVa(){this.ua.Lj&&(C.a.J(8958659,814,50,"PresencePresenter::OnSlideNavigation; refreshing shape presence for slideId: {0}",this.ua.Lj),this.yHk(this.ua.Lj))}yHk(Ta){if(this.ua.Lj&&
this.ua.Lj.equals(Ta)&&(C.a.J(8958665,814,50,"PresencePresenter::RefreshShapePresenceOnSlide refreshing presence for slideId: {0}",Ta),Ta=new Bc.GraphIterator,Ta.set(this.ua.Ca),Ta.yb(1))){do if(0<Ta.currentNode.getValue(cc.a.shapeId)){const Hb=Object(pa.a)(4,Ta.currentNode);Hb&&this.M$g(Hb)}while(Ta.xf(1))}}Hhd(Ta,Hb){this.yt.aDa?(C.a.J(50442244,814,50,"PresencePresenter:SlidePresenceChanged - DragInputManager active."),this.WYc||(this.WYc=new A.a(2,1,0,()=>{this.handlePendingPresenceChangedEvent(Hb)},
90,"68"),G.AFrameworkApplication.ve.Hb(this.WYc)),Hb&&this.X0c.push(Hb)):(this.Zyk(Hb),this.Xyk(Hb))}handlePendingPresenceChangedEvent(){this.WYc=null;this.wHk();if(this.ua.Lj&&0<this.X0c.length){const oc={},Oc={};var Ta=this.ua.Lj;for(var Hb of this.X0c){if(!Ta.equals(Hb.slideId))continue;if(!Hb.shapes||!Hb.user)continue;Hb.user.clientId in Oc||(oc[Hb.user.clientId]=Hb.user,Oc[Hb.user.clientId]=new ec.a(0));const Yc=Oc[Hb.user.clientId];for(const Qd of Hb.shapes){const ce=Hb.u7?1:0;Yc.Kb(Qd)?0<(Yc.ga(Qd)^
ce)&&Yc.$(Qd,ce):Yc.add(Qd,ce)}}for(let Yc in oc){Ta=oc[Yc];Hb=Yc;if(!(Hb in Oc))continue;const Qd=[],ce=[];Oc[Hb].forEach((id,gb)=>{0<gb?ce.push(id):Qd.push(id);return!0});0<Qd.length&&this.rbh(Qd,Ta);0<ce.length&&this.oBf(ce,Ta)}this.X0c=[]}}Zyk(Ta){Ta.u7?this.yza(Ta.slideId,Ta.user):this.geb(Ta.slideId,Ta.user)}gCb(Ta,Hb){this.K$g([Hb.avh])}Zve(Ta,Hb){this.K$g(Hb.GYa)}K$g(Ta){const Hb=[];for(const oc of Ta)Ta=this.a_?this.Ub.J0d(oc):this.Ub.bia(oc),this.a_&&0>=Ta.g$||Ta&&Array.add(Hb,Ta);this.J$g(Hb)}yza(Ta,
Hb){const oc=this.beg(Ta);oc?(oc.yza(Hb),this.Ube(),C.a.J(21770508,814,50,"ThumbnailNavigationPaneView : Add slide presence succeeded. slideId  = {0}",Ta.toString())):C.a.J(21770506,814,50,"ThumbnailNavigationPaneView : AddPresence - slideId is invalid {0}",Ta.toString())}geb(Ta,Hb){const oc=this.beg(Ta);oc?oc.geb(Hb):C.a.J(21770510,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Ta.toString())}beg(Ta){const Hb=this.Ub.bia(Ta);return Hb?Object(pa.a)(796,Hb.yg(this.Gbb)):
(C.a.J(21770512,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Ta.toString()),null)}wHk(){const Ta=this.ua.presentation;if(!Ta)throw Error.argumentNull("Presentation is null");this.J$g(Ta.slides||[])}J$g(Ta){for(const oc of Ta){var Hb=Object(pa.a)(132,oc);Hb?(Ta=Hb.Cb,(Hb=Object(pa.a)(796,Hb.yg(this.Gbb)))?(C.a.J(21770516,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - updating presence for {0}",Ta.toString()),Hb.rhb(this.zD.Vcg(Ta))):C.a.J(21770514,
814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - thumbnailViewElement is null for slide {0}",Ta.toString())):C.a.J(593242145,814,10,"ThumbnailNavigationPaneView : RefreshPresenceForThumbnails - could not cast slide to ISlideNode while updating presence for {0}",oc.Cb.toString())}}Ube(){this.Gx&&this.nHg&&(this.iml()||this.AUa&&this.AUa.continueWith(()=>{this.AUa.result.logActivity("PresenceBubbleRendered",qa.a.z4g,this.zFg)&&this.hie++}))}iml(){return this.hie>=this.AFg}Xyk(Ta){this.ua.Lj&&
this.ua.Lj.equals(Ta.slideId)&&Ta.shapes&&(Ta.u7?this.oBf(Ta.shapes,Ta.user):this.rbh(Ta.shapes,Ta.user))}o5k(Ta,Hb){Ta=Hb.$w;this.Xvg(Ta.shapeNode)&&(this.$me.push(Ta),this.XYc||(this.XYc=new A.a(2,1,0,Object(m.a)(this,this.handlePendingShapePresenceUpdate,"handlePendingShapePresenceUpdate"),90,"69"),G.AFrameworkApplication.ve.Hb(this.XYc)))}handlePendingShapePresenceUpdate(){this.XYc=null;for(const Ta of this.$me){if(!this.Xvg(Ta.shapeNode))return;this.M$g(Ta.shapeNode)}Array.clear(this.$me)}M$g(Ta){const Hb=
Object(pa.a)(133,Ta.pc(this.Le));if(Hb&&!Ta.get_smartArtModelId()){var oc=this.zD.Fcg(Ta);if(oc)if(oc.length){Ta=this.Cka.yP(Ta);Ta.QMf();for(const Oc of oc)Ta.yza(Oc),this.Ube()}else(oc=this.Cka.QE(Ta))&&oc.QMf();this.oee.g0g(Hb)}}oBf(Ta,Hb){var oc=this.Icg();let Oc=!1;for(const Yc of oc){if(!Array.contains(Ta,Yc.get_shapeId())||Yc.get_smartArtModelId())continue;oc=Object(pa.a)(133,Yc.pc(this.Le));if(!oc||Yc.get_smartArtModelId())continue;const Qd=this.Cka.yP(Yc);Qd?(oc.isSelected&&(Qd.Jnb=!1),Qd.yza(Hb),
this.Ube(),oc.isSelected&&Qd.Mbc()):Oc=!0}Oc||C.a.J(8958685,814,50,"PresencePresenter::AddShapePresence succeeded")}rbh(Ta,Hb){var oc=this.Icg();for(const Oc of oc)Array.contains(Ta,Oc.get_shapeId())&&(oc=this.Cka.yP(Oc))&&oc.geb(Hb)}Icg(){let Ta=null;this.ua.Ca&&(Ta=this.ua.Ca.km());return Ta||[]}Xvg(Ta){return!!this.ua.Ca&&this.ua.Ca.Cb.equals(Ta.slideId)}p5k(Ta,Hb){this.Cka.yP(Hb.$w.shapeNode).Old(Hb.presenceUser)}Llk(Ta,Hb){(Hb.$w.jp||Hb.$w.Wgd)&&(Ta=this.Cka.QE(Hb.$w.shapeNode))&&Ta.OKe()}Mlk(Ta,
Hb){(Ta=this.Cka.QE(Hb.$w.shapeNode))&&Ta.$8k()}Flk(Ta,Hb){(Ta=this.Cka.QE(Hb.$w.shapeNode))&&Ta.gZ()}}Object(h.a)(Ob,"PresencePresenter",null,[]);class yc{constructor(Ta){this.v$b=Ta}Ara(Ta){return this.v$b.Ara(Ta)}t2(Ta){return this.v$b.t2(Ta)}}Object(h.a)(yc,"PresenceUserInfoGetter",null,[1041,967]);class fc{constructor(Ta=null){this.sj=Ta}sbg(Ta){if(!Ta||!Ta.value)return null;Ta=Ta.value;let Hb=Ta.userName;if(!Hb&&this.sj){let oc;({editor:oc}=this.sj.lhb(Ta.clientId)).returnValue&&(Hb=oc.Name)}return Object.assign(new H.a,
{clientId:Ta.clientId,chatThreadId:Ta.chatThreadId,chatThreadDiscoveryUri:Ta.chatThreadDiscoveryUri,inChat:Ta.inChat,email:Ta.email,capabilities:new oa.a(Ta.capabilities),userName:Hb})}}Object(h.a)(fc,"PresenceUtils",null,[1071]);var Nb;(function(Ta){Ta[Ta.coauthHandlerResponse=0]="coauthHandlerResponse";Ta[Ta.popSessionResponse=1]="popSessionResponse";Ta[Ta.defaultFallback=2]="defaultFallback"})(Nb||(Nb={}));Object(h.b)("RtcDiscoverType",Nb);class lb{constructor(Ta,Hb,oc,Oc,Yc,Qd,ce,id,gb,pc,zc,
Ic,Fc,rd,Yd,me){this.mRd=Ta;this.Shd=Hb;this.Rhd=oc;this.nqb=Oc;this.e2b=Yc;this.IPc=Qd;this.nhb=ce;this.$kd=id;this.eeb=gb;this.uGc=pc;this.sGc=zc;this.FHb=Ic;this.bcb=Fc;this.Ppb=rd;this.DYf=Yd;this.JSd=me}FVj(){return String.format("[DRL-{0},SEND-{1},SELE-{2},EELE-{3},IUI-{4},IULE-{5},TUI-{6},TULE-{7},RELI-{8},DTL-{9},DEL-{10}, STF-{11}, MLD-{12}, DTL-{13}, ETR-{14}, ETCL-{15}]",this.mRd,this.Shd,this.Rhd,this.nqb,this.e2b,this.IPc,this.nhb,this.$kd,this.eeb,this.uGc,this.sGc,this.FHb,this.bcb,
this.Ppb,this.DYf,this.JSd)}}Object(h.a)(lb,"RttLockSettings",null,[]);var Qc=d(328);class Rc{constructor(Ta,Hb,oc,Oc){this.f9b=this.e9b=null;this.Daf=!1;this.t6j=Ta;this.Fa=Hb;this.Zh=oc;this.NW=Oc;this.Zzb=new Date;this.bFa=-1}get gb(){return this.t6j}get YTc(){return this.Daf}set YTc(Ta){this.Daf=Ta}aNi(){return 0<this.bFa&&Date.now()>=this.bFa}Xjh(Ta){this.bFa=Ta}x0b(){return""}y0b(){return""}TDb(Ta){this.e9b=Ta?this.x0b():this.y0b();this.f9b=new Date}JLd(){}LLd(){return!1}pgh(Ta,Hb){Ta=Ta||"";
Hb=Hb||"";if(Ta.length!==Hb.length)return null;const oc=[];for(let Oc=0;Oc<Ta.length;Oc+=1)Ta.charAt(Oc)!==Hb.charAt(Oc)&&oc.push(Oc);return 0<oc.length?Sb.a.cH("Length",Ta.length,"FirstDiffPos",oc[0],"DiffCount",oc.length):null}SPa(Ta){return Z.a.replaceAll(Ta,"\u00a0"," ").trim()}}Object(h.a)(Rc,"ATextContentRecord",null,[]);var ld=d(33),Dd=d(40);class gd extends Rc{constructor(Ta,Hb,oc,Oc){super(Ta,Hb,oc,Oc);this.hQg=Ta.FA}get shapeNode(){return Object(pa.a)(4,this.gb)}h4k(){this.hQg=this.shapeNode.FA}x0b(){const Ta=
new r.a;var Hb=this.shapeNode.hD();for(const oc of Hb)(Hb=this.Zh.text(oc))&&0<Hb.length&&Ta.add(Hb);return Ta.toArray().join(" ")}y0b(){return this.Fa.zra(this.shapeNode)}JLd(){try{const Ta=this.x0b()||"",Hb=this.e9b||"";if(Ta!==Hb){const oc=this.SPa(Ta)===this.SPa(Hb),Oc=this.hQg||this.shapeNode.FA;if(!oc&&!Oc&&!this.shapeNode.rd){const Yc=Sb.a.cH("Shape",this.shapeNode.er,"Start",Dd.a.Ve(this.Zzb),"LastSnapshotTime",Dd.a.Ve(this.f9b),"EverEdit",this.YTc,"Type",this.getShapeType());Yc.Expiration=
-1<this.bFa?(+new Date(this.bFa)-+this.Zzb).toString():null;const Qd=Ta.length-Hb.length;Qd?Yc.TextLengthDelta=Qd:Yc.SameLengthDiffDetails=this.pgh(Ta,Hb);C.a.J(25539747,814,15,ld.c(Yc))}}}catch(Ta){C.a.J(25981901,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Ta)}}LLd(){try{const Ta=this.NW.f_b(this.shapeNode);if(Ta&&0<Ta.length)return!1;const Hb=this.y0b()||"",oc=this.e9b||"";if(Hb!==oc&&0>Hb.indexOf(oc)&&!(0<=this.SPa(Hb).indexOf(this.SPa(oc))||this.shapeNode.rd)){const Oc=Sb.a.cH("Shape",
this.shapeNode.er,"Start",Dd.a.Ve(this.Zzb),"LastSnapshotTime",Dd.a.Ve(this.f9b),"TextLengthDelta",Hb.length-oc.length,"Type",this.getShapeType());C.a.J(25981903,814,15,ld.c(Oc))}}catch(Ta){C.a.J(25981905,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Ta)}return!0}getShapeType(){return this.shapeNode.rd?"Table":this.shapeNode.fg?"SmartArt":this.shapeNode.xx?"TextBox":this.shapeNode.ll?"PlaceHolder":this.shapeNode.osa?"Shape":"Unknown"}}Object(h.a)(gd,"ShapeContentRecord",Rc,[]);class be{constructor(Ta,
Hb,oc,Oc,Yc,Qd,ce,id,gb,pc,zc,Ic,Fc){this.Bbb=this.bAb=null;this.XN={};this.fGa={};this.sa=id;this.zG=gb;this.Oc=Ta;this.hv=Hb;this.g_j=oc;this.Ow=Oc;this.ua=Yc;this.yh=Qd;this.NW=ce;this.Fa=pc;this.wc=zc;this.Vpe=Ic;this.Rr=Fc;this.sa.sCf(Object(m.a)(this,this.hkk,"onPreSelectionChanged"));this.sa.VJ(Object(m.a)(this,this.dCb,"onSetSelectionFinished"));this.zG.z4h(Object(m.a)(this,this.vmk,"onTableCellViewElementLocked"));this.Oc.F1h(Object(m.a)(this,this.T$h,"beforeProcessInboundResponse"));this.hv.DSb(Object(m.a)(this,
this.Ilk,"onShapeViewElementOpenTextEditView"));this.hv.Ozc(Object(m.a)(this,this.Clk,"onShapeViewElementCloseTextEditView"));this.hv.CCf(Object(m.a)(this,this.Hlk,"onShapeViewElementLocked"));this.g_j.o3h(Object(m.a)(this,this.rmk,"onSuccessfulInbound"));this.Ow.yk(Object(m.a)(this,this.Ah,"onPropertyChanged"));this.yh.xM(Object(m.a)(this,this.hC,"onActiveSlideChanged"))}Ilk(Ta,Hb){Ta=Object(pa.a)(4,Object(pa.a)(Qc.a,Hb.$w).gb);Hb=this.Vpe.nPd(Ta);this.XN[Ta.id.toString()]=Hb;Hb.TDb(!0)}Clk(Ta,Hb){Ta=
Object(pa.a)(4,Object(pa.a)(Qc.a,Hb.$w).gb).id.toString();Ta in this.XN&&this.XN[Ta].Xjh(Date.now()+this.Rr.nqb)}Hlk(Ta,Hb){Ta=Object(pa.a)(4,Object(pa.a)(Qc.a,Hb.$w).gb).id.toString();Ta in this.XN&&delete this.XN[Ta]}hkk(){this.bAb=this.dTf}dCb(){this.Bbb=this.dTf;if(!(!this.bAb&&!this.Bbb||this.bAb&&this.Bbb&&this.Bbb.id.equals(this.bAb.id))){if(this.bAb){var Ta=this.bAb.id.toString();Ta in this.XN&&this.XN[Ta].Xjh(Date.now()+this.Rr.nqb)}this.Bbb&&(Ta=this.Vpe.nPd(this.Bbb),this.XN[this.Bbb.id.toString()]=
Ta,Ta.TDb(!0))}}get dTf(){var Ta=this.sa.Pa;if(!Ta||!Ta.kb||Ta.kb.nl)return null;Ta=Ta.kb;return Ta.Wa.node&&Ta.Wa.node.isConnected?this.wc.fCa(Ta.Wa.node):null}vmk(Ta,Hb){Ta=Hb.tableCellNode.id.toString();Ta in this.XN&&delete this.XN[Ta]}T$h(){this.Kah();for(const Ta of Object.keys(this.XN))this.XN[Ta].TDb(!0)}rmk(){this.Kah();for(const Ta of Object.keys(this.XN))this.XN[Ta].JLd();for(const Ta of Object.keys(this.fGa))this.fGa[Ta].LLd()&&delete this.fGa[Ta]}Ah(Ta,Hb){if(Hb&&Hb.node&&Hb.property.id===
ma.a.Vp.id){Ta=Object(pa.a)(5,Hb.node);Hb=!Hb.node.loading;const oc=this.wc.fCa(Ta);if(oc)this.rSg(oc,Hb),this.sSg(oc,Hb);else if(Ta=this.Fa.f7(Ta))this.rSg(Ta,Hb),this.sSg(Ta,Hb)}}hC(){this.fGa={}}Kah(){for(const Ta of Object.keys(this.XN))this.XN[Ta].aNi()&&delete this.XN[Ta]}rSg(Ta,Hb){Ta=Ta.id.toString();if(Ta in this.XN){Ta=this.XN[Ta];const oc=Object(pa.a)(gd,Ta);oc&&oc.h4k();Ta.TDb(!0);Hb&&(Ta.YTc=!0)}}sSg(Ta,Hb){var oc=this.Fa.$m(Ta);oc&&this.ua.Ca&&this.ua.Ca.sid===oc.get_sid()&&this.ua.Ca.cid===
oc.get_cid()&&(oc=Ta.id.toString(),Hb?oc in this.fGa&&delete this.fGa[oc]:(Hb=Object(ya.a)(123,Ta)?this.NW.UZb(Object(pa.a)(123,Ta)):this.NW.f_b(Object(pa.a)(4,Ta)))&&0<Hb.length&&(oc in this.fGa?this.fGa[oc].TDb(!1):(Ta=this.Vpe.nPd(Ta),this.fGa[oc]=Ta,Ta.TDb(!1))))}}Object(h.a)(be,"TextContentMonitor",null,[]);class od extends Rc{constructor(Ta,Hb,oc,Oc,Yc){super(Ta,Hb,Oc,Yc);this.wc=oc}get tableCellNode(){return Object(pa.a)(123,this.gb)}x0b(){const Ta=new r.a;this.wc.pfc(this.tableCellNode,Hb=>
{(Hb=this.Zh.text(Hb))&&0<Hb.length&&Ta.add(Hb)});return Ta.toArray().join(" ")}y0b(){const Ta=new r.a;this.wc.pfc(this.tableCellNode,Hb=>{Hb.Sa(ma.a.Vp)&&(Hb=Hb.getValue(ma.a.Vp))&&0<Hb.length&&Ta.add(Hb)});return Ta.toArray().join(" ")}JLd(){try{const Ta=this.x0b()||"",Hb=this.e9b||"";if(Ta!==Hb&&this.SPa(Ta)!==this.SPa(Hb)){const oc=Sb.a.cH("TableCellNode",this.amh+"/"+this.tableCellNode.er,"Start",Dd.a.Ve(this.Zzb),"LastSnapshotTime",Dd.a.Ve(this.f9b),"EverEdit",this.YTc);oc.Expiration=-1<this.bFa?
(+new Date(this.bFa)-+this.Zzb).toString():null;const Oc=Ta.length-Hb.length;Oc?oc.TextLengthDelta=Oc:oc.SameLengthDiffDetails=this.pgh(Ta,Hb);C.a.J(37748808,814,15,ld.c(oc))}}catch(Ta){C.a.J(37748810,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Ta)}}LLd(){try{const Ta=this.NW.UZb(this.tableCellNode);if(Ta&&0<Ta.length)return!1;const Hb=this.y0b()||"",oc=this.e9b||"";if(Hb!==oc&&0>Hb.indexOf(oc)&&!(0<=this.SPa(Hb).indexOf(this.SPa(oc)))){const Oc=Sb.a.cH("TableCellNode",this.amh+"/"+this.tableCellNode.er,
"Start",Dd.a.Ve(this.Zzb),"LastSnapshotTime",Dd.a.Ve(this.f9b),"TextLengthDelta",Hb.length-oc.length);C.a.J(37748812,814,15,ld.c(Oc))}}catch(Ta){C.a.J(37748814,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Ta)}return!0}get amh(){const Ta=this.Fa.$m(this.tableCellNode);return Ta?Ta.er:"UnknownShape"}}Object(h.a)(od,"TableCellContentRecord",Rc,[]);class $d{constructor(Ta,Hb,oc,Oc){this.Fa=Ta;this.wc=Hb;this.Zh=oc;this.NW=Oc}nPd(Ta){return Object(ya.a)(4,Ta)?new gd(Object(pa.a)(4,Ta),
this.Fa,this.Zh,this.NW):Object(ya.a)(123,Ta)?new od(Object(pa.a)(123,Ta),this.Fa,this.wc,this.Zh,this.NW):null}}Object(h.a)($d,"TextContentRecordFactory",null,[1040]);var xf=d(616);class Na{constructor(Ta,Hb,oc,Oc,Yc){this.Pb=Ta;this.Cka=Hb;this.sa=oc;this.zG=Oc;this.Kx=Yc;this.UXc=!1}initialize(){this.sa.VJ(Object(m.a)(this,this.dCb,"onSetSelectionFinished"));this.zG.G4h(Object(m.a)(this,this.d0g,"onTypingLockStatusChanged"))}dispose(){this.sa.cch(Object(m.a)(this,this.dCb,"onSetSelectionFinished"));
this.zG.zOk(Object(m.a)(this,this.d0g,"onTypingLockStatusChanged"))}dCb(){var Ta=this.sa.jy();let Hb=null;for(const oc of Ta)if(Ta=Object(pa.a)(ka.TableCellNode,oc))if(Ta=Object(pa.a)(442,Ta.yg(this.Pb.Na)))if(Hb=Ta.nVc)break;this.fBh(Hb)}d0g(Ta,Hb){this.fBh(Hb.bBi)}fBh(Ta=null){this.sa.E7()?this.cgl(Ta):this.ASk()}cgl(Ta=null){if(this.Pb.editingView&&this.Pb.editingView.Al){const Hb=this.G7f();Hb&&(this.Cka.yP(Hb.shapeNode).Old(Ta),Ta&&(Hb.Wgd=!0,this.Kx.d9g(new xf.a(Hb)),Hb.Wgd=!1));this.UXc||C.a.J(37573824,
828,50,"TypingLockHandler:SuspectEditingView - ContentEditableView is switching to cell-lock mode");this.Pb.editingView.disable(!1,14);this.UXc=!0}}ASk(){if(this.Pb.editingView&&this.Pb.editingView.Al){const Ta=this.G7f();Ta&&Ta.shapeNode.rd&&(this.Cka.yP(Ta.shapeNode).Old(null),Ta.S3d());this.UXc&&C.a.J(37573826,828,50,"TypingLockHandler:ResumeEditingView - ContentEditableView is switching back to edit mode");this.Pb.editingView.wYa();this.UXc=!1}}G7f(){let Ta=null;const Hb=this.sa.he();1===Hb.length&&
(Ta=Object(pa.a)(133,Hb[0].pc(this.Pb.Na)));return Ta}}Object(h.a)(Na,"TypingLockHandler",null,[1065,109]);var xb=d(42),sc=d(881);class cd{constructor(){this.qZc=this.hh=this.C3=this.CYc=this.zD=this.K=this.sI=null;this.I6b=0;this.i2c=null;this.Vfe=!1;this.OVc=null;this.Vhe=!1}get name(){return"Presence"}kqi(){this.K.register(H.a,"Common.PresenceUser").as("Common.IPresenceUser").ma();this.K.register(fc,"PowerpointPresence.PresenceUtils").as("Common.IPresenceConverter").ma().na(()=>new fc(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));
this.Vfe=!0}Yb(Ta){this.I6b=(new Date).getTime();this.K!==Ta&&(this.K=Ta,this.C3=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.hh=this.C3.YBa(1,this.name),this.Vfe=!1,this.Vhe=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseEarlyPresenceRefactoring);this.sI=this.K.resolve("Common.AFrameworkApplication");Ta=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.Vfe||this.kqi();const Hb=Ta.hji&&Ta.oJb?!1:Ta.zg,oc=this.Cyi(this.K.resolve("PowerpointPresence.RtcParams"),
this.K.resolve("Common.IPresenceUser"),Hb);if(xb.a("PresenceInit.EarlyReturnOnNullRTC")){if(!oc)return;this.K.register(1037,"Common.IRealtimeChannelBasic").ma().na(()=>oc);this.K.register(1038,"AppRealtimeChannel.IRealtimeChannel").ma().na(()=>oc)}else if(this.K.register(1037,"Common.IRealtimeChannelBasic").ma().na(()=>oc),this.K.register(1038,"AppRealtimeChannel.IRealtimeChannel").ma().na(()=>oc),!this.K.qb("AppRealtimeChannel.IRealtimeChannel"))return;this.hqi(Ta)}hqi(Ta){this.K.register(ua,"PowerpointPresence.PPTRtcProvider").as("Common.Interface.IRtcBasicProvider").ma().na(()=>
new ua(this.K.resolve("Common.IRealtimeChannelBasic")));this.K.register(Va,"PowerpointPresence.EditorPresenceTracker").as("PowerpointPresence.IEditorPresenceTracker").ma().na(()=>new Va(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(Mc,"PowerpointPresence.PptRealtimeChannelMetrics").as("PowerpointPresence.IPptRealtimeChannelMetrics").ma().na(()=>new Mc(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),
this.K.resolve("PowerPointWebEditor.Core.INetworkState"),K.a.getInstance(),Ta.rtcAllowCrossDomainAccessOrigins));this.K.register(Cc,"PowerpointPresence.PresenceManager").as("PowerpointPresence.IPresenceManager").as("Common.IPresenceSender").as("PowerpointPresence.IPresenceUserManager").as("Common.IPresenceRemover").ma().na(()=>new Cc(this.K.resolve("Common.IPresenceUser"),G.AFrameworkApplication.fa,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerpointPresence.RtcParams"),
this.sI.GR,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerpointPresence.IPresenceEventNotifier"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),
this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),Ta,this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerpointPresence.IEditorPresenceTracker"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPptRealtimeChannelMetrics"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.Oa("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").ENc(),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(Xb,"PowerpointPresence.PresenceCache").ma().na(()=>new Xb(this.K.resolve("PowerpointPresence.IPresenceManager")));this.K.register(Ob,"PowerpointPresence.PresencePresenter").ma().na(()=>new Ob(this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.DragInputManager"),this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Na,
this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),Ta.podsNewThumbnailVisibleRangeFetchExperience));this.K.register(jb,"PowerPointWebEditor.PptWetChangeHandler").as("PowerPointWebEditor.IWetChangeHandler").ma().na(()=>new jb(this.K.resolve("Common.IPresenceUser").clientId,Ta.G5k,this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));const Hb=new lb(Ta.WEi,
Ta.Shd,Ta.Rhd,Ta.nqb,Ta.e2b,Ta.IPc,Ta.nhb,Ta.$kd,Ta.eeb,Ta.uGc,Ta.sGc,Ta.FHb,Ta.bcb,Ta.Ppb,Ta.podsTableRTTEnabled,Ta.podsTableCellLockEnabled);this.K.register(Na,"PowerpointPresence.TypingLockHandler").as("PowerpointPresence.ITypingLockHandler").ma().na(()=>new Na(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource")));this.K.register(Ya,"PowerpointPresence.CoauthStateChangesHandler").as("PowerpointPresence.ICoauthStateChangesHandler").ma().na(()=>new Ya(ea.App.Hh,this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.IPresenceUser").clientId,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.ContentEditableViewEventSource"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(12),Ta,Hb,this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerpointPresence.ITypingLockHandler"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Na,this.K.resolve("Box4.Graph.IGraphInstance").Cd(16),E.a.su(I.a.instance.Oa("Common.ISystemInitiatedFeedback"))));this.K.register(1039,"PowerpointPresence.IPresencePawnFactory").ma().na(()=>new dc);this.K.register(1040,"PowerpointPresence.ITextContentRecordFactory").ma().na(()=>new $d(this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler")));this.K.register(be,"PowerpointPresence.TextContentMonitor").ma().na(()=>new be(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),da.a.instance,this.K.resolve("Box4.Graph.IGraphInstance").Cd(12),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerpointPresence.ITextContentRecordFactory"),Hb));this.K.register(u,"Common.App.Presence.AwayManager").ma().na(()=>this.mui(this.K.resolve("Common.IPresenceUser"),
this.K.resolve("Common.IRealtimeChannelBasic"),this.K.resolve("Common.IPresenceRemover"),this.K.resolve("Common.IPresenceConverter")));this.K.register(1041,"PowerPointWebEditor.IDelayedPresenceUserInfoGetter").ma().na(()=>new yc(this.K.resolve("AppRealtimeChannel.IRealtimeChannel")));this.LHc().cfb("RTCConfigured")}G8i(Ta){let Hb;var oc=Ta;Hb=0;if(Ta=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").V9i())return oc=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Lgd(),{sFe:Ta,
qFe:Hb,YTd:oc};Hb=1;return(Ta=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").vfh)?(oc=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Lgd,{sFe:Ta,qFe:Hb,YTd:oc}):{sFe:oc,qFe:2,YTd:!0}}Byi(){const Ta=1E3*this.K.resolve("PowerPointWebEditor.IApplicationSettings").rtcDiscoveryTimeoutSeconds;0<Ta&&(this.i2c=new A.a(2,1,Ta,()=>{this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").X0f=!0;this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").$bh(Object(m.a)(this,this.yve,
"onPopsRtcEndpointUrlReady"));this.K.qb("AppRealtimeChannel.IRealtimeChannel")||(this.Yb(I.a.instance),this.init())},90,"111"),this.K.resolve("Common.ITaskManager").Hb(this.i2c))}Cyi(Ta,Hb,oc){C.a.J(512360602,828,50,"PresencePackage::CreateRtcInstance; isPodsEnabled:{0}",oc);Hb.clientId=Ta.clientId;var Oc=null;Hb=null;const Yc=K.a.getInstance();if(oc){Hb=G.AFrameworkApplication.fa.appSettings[qa.a.pa(368)]+"rtc2";({sFe:Hb,qFe:oc,YTd:Oc}=this.G8i(Hb));const Qd=!this.K.resolve("PowerPointWebEditor.ICoauthStateGetter").amIAlone,
ce=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").X0f,id=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Sug;C.a.J(512360601,828,15,"PresencePackage::CreateRtcInstance; Discovering RTC enabled; RtcDiscoverType:{0} fCoauthoring:{1} fDefaultConnectToRtc:{2} fUseFallback:{3} fPopsRtcConfigured:{4}",Nb[oc],Qd,Oc,ce,id);if(2===oc&&!ce)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").A3h(Object(m.a)(this,this.yve,"onPopsRtcEndpointUrlReady")),this.Byi(),null;if(!Oc&&
!Qd)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").fGd(Object(m.a)(this,this.KBb,"onCoauthStatusChanged")),null;Oc=this.gui(Ta,Hb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Yc)}return Q.RealtimeChannel.createInstance(Ta.clientId,Ta.userSessionId,Ta.Xdd,Ta.Laa,Ta.uih,3,Ta.hw,Hb,Oc,Yc)}mui(Ta,Hb,oc,Oc){const Yc=new M.a;Yc.Ig(oc);oc=new M.a;oc.Ig(Hb);return new u(Ta,oc.task,Yc.task,Oc,this.K.resolve("Common.ITaskManager"),this.sI.GR.kd.bJd?6E4:this.sI.GR.kd.awayCoauthorThresholdMs,
Object(m.a)(this.sI.GR.lK(),this.sI.GR.lK().processAction,"processAction"),ia.App.p2a.notificationBar,G.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled"))}init(){const Ta=this.K.resolve("PowerpointPresence.IPresencePerfLogger");Ta.ai(21,cd.x$b);Ta.ai(22,this.I6b);Ta.ai(24,(new Date).getTime());this.K.resolve("PowerPointWebEditor.PresentationContext").isValid?this.LHc().cfb("PresentationId"):this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").qCf(Object(m.a)(this,this.ddc,
"onPresentationIdReady"));this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Mtb(()=>{this.LHc().cfb("B2IFinished")})}ddc(){this.LHc().cfb("PresentationId");this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").ach(Object(m.a)(this,this.ddc,"onPresentationIdReady"))}yve(){this.i2c&&this.K.resolve("Common.ITaskManager").ah(this.i2c);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").$bh(Object(m.a)(this,this.yve,"onPopsRtcEndpointUrlReady"));this.K.qb("AppRealtimeChannel.IRealtimeChannel")||
(this.Yb(I.a.instance),this.init())}KBb(Ta,Hb){2!==Hb.BTg||this.K.qb("AppRealtimeChannel.IRealtimeChannel")||(this.Yb(I.a.instance),this.init());this.K.qb("AppRealtimeChannel.IRealtimeChannel")&&this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").nDe(Object(m.a)(this,this.KBb,"onCoauthStatusChanged"))}LHc(){this.qZc||(this.qZc=new sc.a(Object(m.a)(this,this.wtb,"initInternal"),["PresentationId","B2IFinished","RTCConfigured"]));return this.qZc}wtb(){this.K.resolve("PowerpointPresence.IPresencePerfLogger").ai(4,
this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource").DBe);this.K.resolve("PowerpointPresence.IPresencePerfLogger").ai(23,(new Date).getTime());this.bvj();this.Uvj();this.qZc=null}Uvj(){try{let Ta="";this.K.resolve("PowerPointWebEditor.IDelayedPresenceUserInfoGetter");Ta=this.hh.Ut("presencemanager");this.Vvj();this.hh.au(Ta);this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").aTc=!0;C.a.J(8958608,814,50,"PresencePackage::Init; Presence downloaded");ea.App.zNd&&(Ta=this.hh.Ut("contentnotification"),
ob.init(),this.hh.au(Ta));Ta=this.hh.Ut("resolve");this.K.resolve("PowerpointPresence.IPresencePerfLogger").zKi();this.zD=this.K.resolve("PowerpointPresence.IPresenceManager");this.K.resolve("Common.IPresenceConverter");this.K.resolve("Common.IRealtimeChannelBasic");this.sI.GR.kd.dMi&&(C.a.J(512360600,814,50,"PresencePackage::Init; Refresh Peoples well after Rtc ready"),this.sI.GR.lK().processAction(x.a.H3a,2));this.K.resolve("PowerPointWebEditor.IWetChangeHandler");this.K.resolve("Common.Interface.IRtcBasicProvider");
this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler");this.K.resolve("PowerpointPresence.PresencePresenter");this.K.resolve("PowerpointPresence.IPresencePawnFactory");this.K.resolve("Common.App.Presence.AwayManager");this.sI.GR.kd.hermesMonitorShapeContentChangeEnabled&&this.K.resolve("PowerpointPresence.TextContentMonitor");this.hh.au(Ta);this.K.resolve("PowerpointPresence.IPresencePerfLogger").kKi();this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").VUj()}catch(Ta){C.a.J(512360599,
814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",Ta)}}dispose(){this.zD?this.zD.disconnect():C.a.J(512360598,814,10,"PresencePackage::Dispose; m_presenceManager is null.");this.K.resolve("PowerpointPresence.IPresencePerfLogger").dispose()}Vvj(){this.K.resolve("PowerpointPresence.PresenceManager").wb();C.a.J(512360597,814,50,"PresencePackage::InitializePresenceManager; Presence Manager loaded and initialized")}gui(Ta,Hb,oc,Oc){let Yc=Hb;Yc=Yc.endsWith("/")?Yc+"findsession":
Yc+"/findsession";C.a.J(512360596,814,50,"PresencePackage::CreateAssignRtcMachineStrategy; Using rtc path: {0}; WacClusterId: {1} ",Yc,Ta.Laa.Vea);Hb=()=>W.FindSessionStrategy.rwi(Ta.userSessionId,Ta.Laa,Yc,Ta.hw,G.AFrameworkApplication.buildVersion,Ta.clientId,cd.bUi(G.AFrameworkApplication.buildVersion),Oc,Ta.uih,()=>{if(G.AFrameworkApplication.$g)return G.AFrameworkApplication.$g;const ce=this.K.resolve("PowerPointWebEditor.PresentationContext").presentationId.string;ce||C.a.J(512360595,814,15,
"CreateAssignRtcMachineStrategy - returning a null query string");return ce},this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").T9i());const Qd=!!this.CYc;return this.Vhe||Qd?this.OVc=new Oa(this.CYc,Hb,oc,Oc,this.K.resolve("PowerpointPresence.IPresencePerfLogger")):Hb()}bvj(){var Ta;if(Ta=this.K.resolve("PowerPointWebEditor.IApplicationSettings").presenceEarlyFindSessionEnabled?this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").getFindSessionResponse():this.K.resolve("PowerPointWebEditor.Core.IFindRtcSessionSimpleStrategy").gVd)Ta=
ca.RtcUtils.deserialize(Ta,"PresencePackage","Deserialize existing FindSession response",!0),this.f9c(Ta)}f9c(Ta){if(Ta)try{this.CYc=Object.assign(new N.a,{l4b:Ta[P.a.Lub],errorMessage:Ta[P.a.errorMessage],tVb:Ta[P.a.SLe],q4:Ta[P.a.q4],pA:Ta[P.a.pA],QNc:Ta[P.a.$1d],D4c:Ta[P.a.ccb],E4c:Ta[P.a.bJa],H4c:Ta[P.a.ecb]}),this.Vhe&&this.OVc&&(this.OVc.findSessionResponse=this.CYc)}catch(Hb){C.a.J(512360594,828,10,"Exception caught while creating FindSessionResponse: {0}",Hb)}}static main(){cd.x$b=(new Date).getTime();
const Ta=new cd;G.AFrameworkApplication.fa&&G.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")?(Ta.Yb(I.a.instance),Ta.K.qb("AppRealtimeChannel.IRealtimeChannel")&&Ta.init()):D.a.instance.Ec(Ta)}static bUi(Ta){return String.format("{0}, {1}, {2}",cd.bLf(Y.a[3]),cd.bLf("browser"),Ta)}static bLf(Ta){return Ta?Ta.charAt(0).toLocaleUpperCase()+Ta.substring(1,Ta.length):Ta}}cd.x$b=0;Object(h.a)(cd,"PresencePackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerpointPresence");
window.g_hermesPresence1JS=new Date;Type.registerNamespace("Common.App.Presence");Type.registerNamespace("AppRealtimeChannel");cd.main()},185:function(J,V,d){d.r(V);d.d(V,"RtcUtils",function(){return r});J=d(0);var h=d(374),e=d(326),m=d(33);class r{static ALd(v,A=e.RealtimeChannel.lre){let x;try{x=m.c(v)}catch(y){throw v=String.format("Failed to JSON-serialize payload : {0}",y),h.ULS.sendTraceTag(18637072,500,10,v),Error.argument("payload",v);}if(x.length>A)throw v=String.format("Payload exceeds maximum length: {0} > {1}.",
x.length,A),h.ULS.sendTraceTag(18637074,500,10,v),Error.argument("payload",v);return x}static deserialize(v,A,x){if(!v)return null;if(Object.getType(v)!==String){var y=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",A,Object.getType(v).getName(),x);h.ULS.sendTraceTag(18637075,500,10,y);return null}y=null;try{y=m.a(v)}catch(u){v=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",
A,u,x),h.ULS.sendTraceTag(18637077,500,10,v)}return y}static CBb(v){if(!v)return"";if("string"===typeof v)return v.toString();try{return m.c(v)}catch(A){return v.toString()}}static o0f(v){let A,x,y;A=0;y=x=null;if(!v)return{q4d:A,r4d:x,Ti:y};try{const u=v.source;u&&Object.getType(u)===String&&(y=u);const H=v.context;H&&(v=H,A=v.status?v.status:0,x=v.statusText?v.statusText:null)}catch(u){}return{q4d:A,r4d:x,Ti:y}}}Object(J.a)(r,"RtcUtils",null,[])},228:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);d=d(78);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&
this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}ax(){return!0}static rpb(e,m){return e+(m?"Rtl":"")}}Object(J.a)(h,"BasePresenceControl",d.a,[109,394])},229:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m){super();this.type=e;this.Ri=m}}h.No="InteractivityChanged";Object(J.a)(h,"InteractivityChangedEventArgs",Sys.EventArgs,
[])},302:function(J,V,d){d.r(V);J=d(0);var h=d(374),e=d(13),m=d(105),r;(function(y){y[y.SendNotification=0]="SendNotification";y[y.SendPersistentState=1]="SendPersistentState";y[y.FindSession=2]="FindSession";y[y.Last=3]="Last"})(r||(r={}));Object(J.b)("ApiType",r);var v;(function(y){y[y.AttemptCount=0]="AttemptCount";y[y.SuccessCount=1]="SuccessCount";y[y.DropCount=2]="DropCount";y[y.FailedCount=3]="FailedCount";y[y.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";y[y.LatencyUnderThresholdCount=
5]="LatencyUnderThresholdCount";y[y.ThrottledCount=6]="ThrottledCount";y[y.Last=7]="Last"})(v||(v={}));Object(J.b)("EventCountType",v);var A=d(679);d.d(V,"FrequentLoggingMetrics",function(){return x});class x{constructor(y){this.ZOf=this.r2f=null;this.oRg=this.H4f=0;this.Ws=null;this.Ccf=this.Nwd=0;this.Di=y;this.Hvj();this.Ord=this.O1e=this.exd=!1;this.Hwd=0}get fMi(){return this.Ord}cel(y){this.Ccf=y;window.setInterval(Object(e.a)(this,this.hce,"logMetricsBatchAndReset"),y);this.Nwd=(new Date).getTime()}qG(y,
u){this.S5k(y)&&!this.O1e||this.fMi||!window.navigator.onLine||this.Di.hDa||(this.Ws[y][u]++,this.exd=!0)}Hvj(){this.Ws=Array(3);for(let y=0;3>y;y++){this.Ws[y]=Array(7);for(let u=0;7>u;u++)this.Ws[y][u]=0}}Tci(){const y={};for(let u=0;3>u;u++)for(let H=0;7>H;H++)this.JNj(u,H)&&(y[r[u]+v[H]]=this.Ws[u][H]);y.FSDomain=this.r2f;y.ConnectionDomain=this.ZOf;y.FSRetryInterval=this.H4f;y.MaxPayloadSize=this.oRg;y.LogNumber=this.Hwd;1===this.Hwd&&(y.FSLatencies=A.a.instance.g1i(),y.ConLatencies=A.a.instance.FYi());
return y}JNj(y,u){return 2===y&&3!==u&&0!==u?!1:!0}S5k(y){return 2===y?!1:!0}hce(){if(this.exd){this.Hwd++;if((new Date).getTime()-this.Nwd<5E3+this.Ccf){var y=m.a.toJSON(this.Tci());h.ULS.sendTraceTag(50644352,500,15,y)}this.Nwd=(new Date).getTime();for(y=0;3>y;y++)for(let u=0;7>u;u++)this.Ws[y][u]=0;this.exd=!1}}m9j(){this.O1e=!0}static get instance(){return x.Ka}static create(y){x.instance||(x.Ka=new x(y));return x.instance}}x.Ka=null;Object(J.a)(x,"FrequentLoggingMetrics",null,[1131])},326:function(J,
V,d){d.r(V);J=d(0);var h=d(374),e=d(13),m=d(1019),r=d(949),v=d(67),A=d(25);class x{constructor(Ca,Ea){this.status=Ca;this.Gvb=Ea}}Object(J.a)(x,"UserStatusInfo",null,[]);var y=d(82),u=d(679);class H{constructor(Ca,Ea){this.data=Ca;this.timeStamp=Ea}}Object(J.a)(H,"PresenceData",null,[]);class G{constructor(Ca){this.Woa=!1;this.Ylb=0;this.Wpd=!1;this.setTimeout=G.tQd;this.clearTimeout=G.jQd;this.dWj=Object(e.a)(this,this.pVj,"logRtcConnectingUsageStatement");this.Ar=Ca}dgk(){this.Woa||(this.Ylb=this.setTimeout(()=>
{this.Woa=!1;this.xAg()},8E3),this.Woa=!0,this.Wpd=!1)}Ngk(){this.DM()}qmk(){this.xAg()}xAg(){this.DM();this.Wpd||(this.Wpd=!0,this.dWj())}pVj(){h.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Ar)}DM(){this.Woa&&this.clearTimeout(this.Ylb);this.Ylb=0;this.Woa=!1}static tQd(Ca,Ea){return window.setTimeout(Ca,Ea)}static jQd(Ca){window.clearTimeout(Ca)}}Object(J.a)(G,"ConnectedUsageKpiLogger",null,[1151]);class E{constructor(){this.Lbd=this.YBe;this.aCe=
this.bCe;this.Mbd=this.$Be;this.Ygc=this.dCe;this.b$g=this.cCe;this.kCe=this.lCe;this.hCe=this.iCe;this.Rdb=this.fCe;this.$gc=this.gCe;this.X9g=this.ZBe;this.kBb=this.Ase;this.ccc=this.Bse}YBe(){}bCe(){}$Be(){}dCe(){}cCe(){}iCe(){}gCe(){}fCe(){}lCe(){}ZBe(){}Ase(){}Bse(){}}Object(J.a)(E,"NoopRealtimeChannelMetrics",null,[1144,304]);class I{}I.rhb="presenceUpdated";I.updateNotification="updateNotification";I.m3g="persistentStateCleared";I.updatePersistentState="persistentStateUpdated";Object(J.a)(I,
"RtcClientMethodNames",null,[]);class Q{}Q.Zqj="realtimeChannelHub";Q.rhb="UpdatePresence";Q.kea="SendUpdateNotification";Q.OXd="GetCompletePersistentStateWithMetadata";Q.updatePersistentState="UpdatePersistentState";Q.phb="UpdateClientInfo";Object(J.a)(Q,"RtcHubMethodNames",null,[]);class D{constructor(Ca){this.iz=Ca}BJk(Ca){this.iz.on(I.rhb,Ca)}ZJk(Ca){this.iz.on(I.updateNotification,Ca)}yJk(Ca){this.iz.on(I.updatePersistentState,Ca)}xJk(Ca){this.iz.on(I.m3g,Ca)}Npl(Ca){this.iz.off(I.rhb,Ca)}Rpl(Ca){this.iz.off(I.updateNotification,
Ca)}Mpl(Ca){this.iz.off(I.updatePersistentState,Ca)}Lpl(Ca){this.iz.off(I.m3g,Ca)}rhb(Ca){return this.iz.invoke(Q.rhb,Ca)}phb(Ca){return this.iz.invoke(Q.phb,Ca)}kea(Ca,Ea){return this.iz.invoke(Q.kea,Ca,Ea)}OXd(Ca){return this.iz.invoke(Q.OXd,Ca)}updatePersistentState(Ca,Ea){return this.iz.invoke(Q.updatePersistentState,Ca,Ea)}}Object(J.a)(D,"RealtimeChannelProxy",null,[1148,1149,1150]);class Y{constructor(){this.pib=this.ZVe=!1;this.oib=0;this.Fpd=this.LBd=this.KBd=this.fod=!1;this.asd=0;this.nsf=
!1;this.msf=this.lsf=0;this.LAd=!1;this.PAd=this.NAd=this.QAd=this.MAd=0;this.OAd=!1}get bJd(){return this.pib}get awayCoauthorThresholdMs(){return this.oib}get v6h(){return this.fod}get $6k(){return this.KBd}get a7k(){return this.LBd}get Zli(){return this.Fpd}get UYb(){return this.asd}get CTk(){return this.nsf}get wfh(){return this.lsf}get BTk(){return this.msf}get wTk(){return this.LAd}get xTk(){return this.MAd}get Afh(){return this.QAd}get xfh(){return this.NAd}get zfh(){return this.PAd}get yfh(){return this.OAd}static createInstance(Ca){const {RealtimeChannel:Ea}=
d(326);return Ca?Object.assign(new Y,{ZVe:Ca.ka("AwayStatusManagerIsEnabled"),pib:Ca.ka("AwayStatusOneMinuteTimeoutIsEnabled"),oib:Ca.Gc("AwayCoauthorThresholdMs",9E5),fod:Ca.ka("RtcAllowCrossDomainAccessEnabled"),KBd:Ca.ka("ShouldLogOnContentNotification"),LBd:Ca.ka("ShouldLogOnHostSubscriptionNotification"),Fpd:Ca.ka("RtcClientMetricsEnabled"),asd:Ca.Gc("RtcFindSessionRequestTimeoutInMS",6E4),nsf:Ca.ka("RtcJsClientFrequentlyLogsMetrics"),lsf:Ca.Gc("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),msf:Ca.Gc("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),LAd:Ca.ka("RtcClientMessageTelemetryEnabled"),MAd:Ca.Gc("RtcClientMessageTelemetrySampleSize",5),QAd:Ca.Gc("RtcSendTelemetryMessageIntervalInMS",3E5),NAd:Ca.Gc("RtcLogClientMessageMetricsTimeOutInMs",2E4),PAd:Ca.Gc("RtcMaxPayloadSizeInCharactersOverride",Ea.lre),OAd:Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new Y,{ZVe:!1,pib:!1,oib:9E5,fod:!1,KBd:!1,LBd:!0,Fpd:!1,asd:9E4,
LAd:!1,MAd:5,QAd:3E5,NAd:2E4,PAd:Ea.lre,OAd:!1})}}Object(J.a)(Y,"RealtimeChannelSettings",null,[1147]);var M=d(685),N=d(1154),W=d(161);class K{constructor(Ca){this.kRb=null;this.Wva=0;this.T4a=!1;this.Yk=Ca;this.Yk.B2a(Object(e.a)(this,this.vla,"onConnectionStateChanged"))}vla(Ca,Ea){this.Wva=Ea.newState}Hmk(){h.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.Yk.zbd()}xuj(Ca){this.kRb.init(Ca)}}Object(J.a)(K,"ARtcMessageHandler",null,[]);var ca=d(977);
class P{constructor(){this.Presence=null;this.TimeStamp=0}}Object(J.a)(P,"PresenceDataEntryForClients",null,[]);var ea=d(105);class da{constructor(Ca,Ea=""){this.WSh=Ca;this.wya=Ea}send(){return this.WSh()}get messageId(){return this.wya}}Object(J.a)(da,"MessageHandler",null,[1177]);var ia=d(711);class C extends Sys.EventArgs{constructor(Ca,Ea,wb,Oa){super();this.cEe=Ca;this.reconnectDelay=Ea;this.reason=wb;this.OGe=Oa}}Object(J.a)(C,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var oa=d(953);
class Z{constructor(){this.tCd=this.Bj=null}get vq(){return this.Bj?this.tCd?this.tCd.getTime()-this.Bj.getTime():(new Date).getTime()-this.Bj.getTime():0}start(){this.Bj=new Date}stop(){this.tCd=new Date}}Object(J.a)(Z,"SimpleStopwatch",null,[]);var pa=d(954),ya;(function(Ca){Ca[Ca.contentUpdate=0]="contentUpdate";Ca[Ca.editorsTableUpdate=1]="editorsTableUpdate";Ca[Ca.fileNameUpdate=2]="fileNameUpdate";Ca[Ca.wetContentUpdate=3]="wetContentUpdate";Ca[Ca.persistedContentUpdate=4]="persistedContentUpdate";
Ca[Ca.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";Ca[Ca.replicationTelemetry=6]="replicationTelemetry";Ca[Ca.lockUpdate=7]="lockUpdate";Ca[Ca.collabServiceContentUpdate=8]="collabServiceContentUpdate";Ca[Ca.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";Ca[Ca.saveTargetUpdate=10]="saveTargetUpdate";Ca[Ca.uploadToOcsUpdate=11]="uploadToOcsUpdate";Ca[Ca.labelUpdate=12]="labelUpdate";Ca[Ca.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";Ca[Ca.subscribeOrExtend=
14]="subscribeOrExtend";Ca[Ca.elapsedBootTelemetry=15]="elapsedBootTelemetry";Ca[Ca.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";Ca[Ca.clientToClientResponseMessage=17]="clientToClientResponseMessage";Ca[Ca.verifyNotificationPipeline=18]="verifyNotificationPipeline";Ca[Ca.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";Ca[Ca.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";Ca[Ca.last=21]="last"})(ya||(ya={}));Object(J.b)("UpdateNotificationType",ya);var Ja=d(903),
Ka=d(901),ma=d(902);class ra extends K{constructor(Ca,Ea,wb,Oa,ab,fb,db,gc,ob,Sb){super(db);this.iz=null;this.vcf=!1;this.wya=0;this.bzd=new W.a;this.NNh=ra.PYi();this.Hyd=A.AFrameworkApplication.fa.Ia("OwningFeatureCrewForRtcNotificationKpis");this.Ic=Ca;this.zef=this.yef=0;this.kRb=Ea;this.kRb.Pzc(Object(e.a)(this,this.Hmk,"onTooManyUndeliveredMessages"));this._clientId=wb;this.yRh=ab;this.Yk.K3h(Object(e.a)(this,this.Dkk,"onRefreshProxyRequired"));this.Yk.I3h(Object(e.a)(this,this.Bkk,"onRefreshAllPersistentStateRequest"));
this.Yk.W3h(Object(e.a)(this,this.kea,"sendUpdateNotification"));this.Yk.K1h(Object(e.a)(this,this.yik,"onInternalPresenceUpdated"));this.Yk.L1h(Object(e.a)(this,this.zik,"onInternalUpdateNotificationReceived"));this.Yk.J1h(Object(e.a)(this,this.xik,"onInternalPersistentStateUpdated"));this.Yk.I1h(Object(e.a)(this,this.wik,"onInternalPersistentStateCleared"));this.Yk.V3h(Object(e.a)(this,this.ZGe,"sendPersistentState"));this.Yk.N4h(Object(e.a)(this,this.phb,"updateClientInfo"));this.Sh=fb;this.Ar=
Oa;this.Ws=gc;this.lM=ob;this.zOb=Sb;this.gib=Object(N.a)(String,A.AFrameworkApplication.Zc.Application)||""}Dkk(Ca,Ea){this.iz=this.yRh(Ea.hubConnection);this.kRb.reset();this.iz.BJk(Object(e.a)(this,this.cdc,"onPresenceUpdated"));this.iz.yJk(Object(e.a)(this,this.L7c,"onPersistentStateUpdated"));this.iz.xJk(Object(e.a)(this,this.uve,"onPersistentStateCleared"));this.iz.ZJk(Object(e.a)(this,this.xdc,"onUpdateNotificationReceived"))}vla(Ca,Ea){this.Wva=Ea.newState;2===Ea.newState&&this.AXk()}AXk(){for(let Ca of this.bzd)this.kea(null,
new oa.a(Ca.key,Ca.value,!1,new m.a));this.bzd=new W.a}Bkk(Ca,Ea){Ea.ULd();for(Ca=0;3>Ca;++Ca)this.mXk(Ca,Ea)}mXk(Ca,Ea){try{this.iz.OXd(Ca).done(wb=>{Ea.vJb(Ea.jNd,"GetCompletePresenceSuccess")&&(Ea.Qqi.qmk(),h.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",this.Ar),this.Yk.jDk(),this.Zjk(Ca,wb),this.Yk.mCk(wb),Ea.V_f.Kb(Ca)&&this.Yk.X8g(Ca,Ea.V_f.ga(Ca),new m.a))}).fail(wb=>{const {RtcUtils:Oa}=d(185);Ea.vJb(Ea.jNd,"GetCompletePresenceFail")&&(h.ULS.sendTraceTag(3249541,
500,15,"Failed to retrieve complete session state : {0} for [{1}]",Oa.CBb(wb),this.Ar),this.Yk.zbd())}).always(()=>{Ea.Tx&&Ea.Tx.stop()})}catch(wb){h.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",Ea.jNd,wb.message)}}ZGe(Ca,Ea){var {RtcUtils:wb}=d(185);Ca=Ea.presence;let Oa;const ab=Ea.QIa;this.lM.qG(1,0);try{Oa=wb.ALd(Ca,this.zOb)}catch(db){this.lM.qG(1,
3);h.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",db.message);ab.setException(db);return}wb=new v.a;wb.$(this._clientId,Object.assign(new P,{Presence:Ca,TimeStamp:(new Date).getTime()}));this.Yk.s9g(Ea.type,wb);if(2!==this.Wva)this.Ws.Rdb(),this.lM.qG(1,2),ab.Ig(null);else{var fb=this.wya.toString();++this.wya;Ca=new da(()=>this.CXk(Ea.type,Oa,fb),fb);Ca=this.Uuh(0,Ea.type).add(Ca);Ca.t7c(db=>{2===db&&this.lM.qG(1,6);ab.Ig(null)});
Ca.s7c(()=>{})}}CXk(Ca,Ea,wb){let Oa=null;const ab=new Z,fb=new ia.a;h.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.Ar);if(2!==this.Wva)return this.Ws.Rdb(),this.lM.qG(1,2),h.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",this.Ar),fb.cre(),fb;this.Sh&&20>this.yef&&(Oa=this.Sh.wi("WebServiceCall","Send Presence Message"),this.yef++);ab.start();fb.lbc(1);try{this.iz.updatePersistentState(Ca,Ea).done(()=>{this.Ws.hCe();this.lM.qG(1,
1);h.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",wb,this.Ar);fb.iVa(1);ab&&(ab.stop(),ab.vq>this.Ic.wfh?this.lM.qG(1,4):this.lM.qG(1,5))}).fail(db=>{const {RtcUtils:gc}=d(185);this.T4a||(this.Ws.Rdb(),this.lM.qG(1,3),h.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",wb,gc.CBb(db),this.Ar));fb.iVa(2)}).always(()=>{Oa&&Oa.stop()})}catch(db){h.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",
db.message),this.lM.qG(1,3),fb.iVa(2)}return fb}phb(Ca,Ea){({RtcUtils:Ca}=d(185));const wb=Ea.Yli,Oa=Ea.QIa;let ab;try{ab=Ca.ALd(wb,this.zOb)}catch(fb){h.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",fb.message);Oa.setException(fb);return}try{this.iz.phb(ab).done(()=>{h.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(fb=>{const {RtcUtils:db}=d(185);this.T4a||h.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",
db.CBb(fb));Oa.Ig(null)})}catch(fb){h.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",fb.message),Oa.Ig(null)}}kea(Ca,Ea){({RtcUtils:Ca}=d(185));const wb=Ea.type,Oa=Ea.rxa,ab=Ea.ZCi,fb=Ea.QIa;let db;this.lM.qG(0,0);try{db=Ca.ALd(Oa,this.zOb)}catch(ob){this.lM.qG(0,3);h.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",ob.message);fb.setException(ob);return}if(2!==this.Wva)ab?this.bzd.$(wb,
Oa):(this.Ws.Rdb(),this.lM.qG(0,2)),fb.Ig(null);else{var gc=this.wya.toString();++this.wya;Ea=new da(()=>this.ZXk(wb,db,gc),gc);Ea=this.Uuh(1,wb).add(Ea);Ea.t7c(ob=>{2===ob&&this.lM.qG(0,6);fb.Ig(null)});Ea.s7c(()=>{})}}ZXk(Ca,Ea,wb){let Oa=null;const ab=new Z,fb=new ia.a;h.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.Ar);if(2!==this.Wva)return this.Ws.Rdb(),this.lM.qG(0,2),h.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",
this.Ar),fb.cre(),fb;this.Sh&&3===Ca&&20>this.zef&&(Oa=this.Sh.wi("WebServiceCall","Send WetContent Update"),this.zef++);ab.start();fb.lbc(1);this.iz.kea(Ca,Ea).done(()=>{this.Ws.hCe();this.lM.qG(0,1);h.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",wb,this.Ar);fb.iVa(1);ab&&(ab.stop(),ab.vq>this.Ic.wfh?this.lM.qG(0,4):this.lM.qG(0,5))}).fail(db=>{const {RtcUtils:gc}=d(185);this.T4a||(this.Ws.Rdb(),this.lM.qG(0,3),h.ULS.sendTraceTag(3249507,500,
15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",wb,gc.CBb(db),this.Ar));fb.iVa(2)}).always(()=>{Oa&&Oa.stop()});return fb}qxa(){this.iz.Npl(Object(e.a)(this,this.cdc,"onPresenceUpdated"));this.iz.Mpl(Object(e.a)(this,this.L7c,"onPersistentStateUpdated"));this.iz.Lpl(Object(e.a)(this,this.uve,"onPersistentStateCleared"));this.iz.Rpl(Object(e.a)(this,this.xdc,"onUpdateNotificationReceived"))}yik(Ca,Ea){this.cdc(Ea.hJb,Ea.mWf)}cdc(Ca){this.Ws.$gc();this.L7c(0,Ca)}xik(Ca,
Ea){this.L7c(Ea.type,Ea.hJb)}Zjk(Ca,Ea){const wb={};for(let Oa in Ea)wb[Oa]=Ea[Oa].Presence;this.$Yg(Ca,wb,Ea)}L7c(Ca,Ea){this.Ws.$gc();this.$Yg(Ca,Ea)}$Yg(Ca,Ea,wb=null){var {RtcUtils:Oa}=d(185);if(h.ULS.uwa(500,100))for(var ab in Ea);delete Ea[this._clientId];if(!ea.a.isEmpty(Ea)){for(var fb in Ea)ab=fb,Ea[ab]=Oa.deserialize(Ea[fb],"Presence",ab,!1,this.zOb);Oa=new v.a;fb=(new Date).getTime();for(let db in Ea){ab=Ea[db];let gc=db,ob;wb?(ob=wb[gc],ob.Presence=ab):ob=Object.assign(new P,{Presence:ab,
TimeStamp:fb});Oa.$(gc,ob)}this.Yk.s9g(Ca,Oa);switch(Ca){case 0:this.vcf||(h.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Ar),this.vcf=!0,A.AFrameworkApplication.Qg&&A.AFrameworkApplication.Qg.i9j());this.Yk.N8g(Ea,[]);break;default:this.Yk.YCk(Ca,Ea)}}}wik(Ca,Ea){this.uve(Ea.iMd)}uve(Ca){this.Ws.$gc();if(h.ULS.uwa(500,100))for(let Ea=0;Ea<Ca.length;++Ea);Ca.length&&(this.Yk.oEk(Ca),this.Yk.XCk(Ca),this.Yk.N8g({},Ca))}zik(Ca,Ea){this.xdc(Ea.type,Ea.rxa)}xdc(Ca,
Ea=null){this.Ic.$6k&&0===Ca&&h.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===Ca&&this.Hyd&&0<this.Hyd.length){var wb=Object.assign(new Ja.a,{topLevelKpiName:"ContentUpdateNotificationReceived",featureName:"RtcNotification",crewAlias:this.Hyd,vetoPillar:"RealTimeCoauth"});(wb=ca.a.getInstance(wb))&&wb.logKpiUsage(this.NNh)}this.Ic.a7k&&13===Ca&&h.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",
Ea||"<none>"));this.Ws.$gc();5===Ca?(Ea=(Ca=this.Rqk(Ea))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",Ca.reason,Ca.reconnectDelay):"Received client reconnection request from the server without params.",h.ULS.sendTraceTag(18637071,500,50,Ea),this.Yk.zbd(Ca)):(Ea=d(185).RtcUtils.deserialize(Ea,String.format("UpdateNotification-{0}",ya[Ca]),null,!1,this.zOb),this.Yk.nEk(Ca,Ea))}Rqk(Ca){try{if(!Ca||""===Ca)return null;const Ea=JSON.parse(Ca);return new C(Ea[pa.a.tFe],
Ea[pa.a.vTk],Ea[pa.a.zTk],Ea[pa.a.OGe])}catch(Ea){return h.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",Ea.message),null}}Uuh(Ca,Ea){return this.kRb.Cdj(this.Ddj(Ca,Ea))}Ddj(Ca,Ea){return Ca+","+Ea}static PYi(){var Ca=new Map;Ca.set("SkipAria","True");Ca=Object.assign(new Ka.a,{extendedProperties:Ca});return Object.assign(new ma.a,{kpiName:"ContentUpdateNotificationReceived",kpiType:0,optionalProperties:Ca,blockFutureEmissionDurationInMs:3E5})}}Object(J.a)(ra,"RtcMessageHandler",
K,[]);class Da{JRf(Ca,Ea=""){const {MaxOutstandingThrottler:wb}=d(950);return wb.createInstance(Ca,Ea)}Rwi(Ca,Ea=""){const {MaxRateThrottler:wb}=d(952);return wb.createInstance(Ca,Ea)}}Object(J.a)(Da,"ThrottlerFactory",null,[1146]);var va=d(78),Fa=d(680);class ka{constructor(Ca){this.Ic=null;this.LO=!1;this.Ta=new va.a;this.$wd=new v.a;this.Ywd=new v.a;this.uDd=Ca;this.Ejb=this.uDd.JRf(Ea=>Ea.send(),"GlobalMaxOustandingThrottler");this.Ejb.Pzc(()=>{this.Ta.raiseEvent("TMUDM")})}init(Ca){this.LO||
(this.Ic=Ca,this.Ejb.init(this.Ic.bJa,this.Ic.sgj),this.LO=!0)}Cdj(Ca){var {MaxRateThrottler:Ea}=d(952),{MaxOutstandingThrottler:wb}=d(950);this.LO||this.init(new Fa.a(Ea.MTf,wb.cUf,wb.STf,ka.n$j));({value:Ea}=this.$wd.Nf(Ca)).returnValue||(({value:Ea}=this.Ywd.Nf(Ca)).returnValue||(Ea="MaxOutstandingThrottler-"+Ca,Ea=this.uDd.JRf(Object(e.a)(this.Ejb,this.Ejb.add,"add"),Ea),Ea.init(this.Ic.bJa,this.Ic.m$j),Ea.Pzc(()=>{this.Ta.raiseEvent("TMUDM")}),this.Ywd.add(Ca,Ea)),wb="MaxRateThrottler-"+Ca,Ea=
this.uDd.Rwi(Object(e.a)(Ea,Ea.add,"add"),wb),Ea.init(this.Ic.jak),this.$wd.add(Ca,Ea));return Ea}reset(){for(let Ca of this.$wd)Ca.value.jCe();for(let Ca of this.Ywd)Ca.value.jCe(),Ca.value.reset();this.Ejb.jCe();this.Ejb.reset()}Pzc(Ca){this.Ta.addHandler("TMUDM",Ca)}}ka.n$j=1E3;Object(J.a)(ka,"ThrottlerManager",null,[1145]);var qa=d(1092);const Ua=(Ca,Ea,wb,Oa,ab,fb,db,gc,ob=null,Sb=null,Jb=null,Ab=null)=>{const lc=Y.createInstance(A.AFrameworkApplication.fa),Mc=A.AFrameworkApplication.buildVersion?
A.AFrameworkApplication.buildVersion:"1.0",Jc=Ya(Ca,Ea,db,Mc),rb=lc.Zli?d(1090).RealtimeChannelMetrics.createInstance(Jc):new E;var cc=d(302).FrequentLoggingMetrics.create(ab);lc.CTk&&cc.cel(lc.BTk);var jb="";jb=ob&&""!==ob?ob:"/rtc2/";cc.r2f=y.a.NE(jb);const Xb=jb+"signalr";ob=jb+"findsession";const yb=Q.Zqj;jb=new Da;Jb=Jb||M.a.getInstance();h.ULS.shipAssertTag(556867617,500,lc.zfh<=d(326).RealtimeChannel.pRg,"Client attempting to override max payload size beyond absolute limit");const mb=Math.min(lc.zfh,
d(326).RealtimeChannel.pRg);cc.oRg=mb;cc=new ra(lc,new ka(jb),Ca,Jc,Ub=>new D(Ub.createHubProxy(yb)),gc,Jb,rb,cc,mb);Sb||(Sb=d(687).FindSessionStrategy.createInstance(Ea,ab,ob,gc,Mc,db,Ca,Jc,Jb,fb,Oa,Ab));Sb.UYb=lc.UYb;Ea=new G(Jc);wb=wb?wb.split(","):null;Ca=new (d(326).RealtimeChannel)(Ca,wb,Jc,gc,()=>$.hubConnection(Xb),Sb,cc,Ea,Jb,rb,lc,ab);Ca.init();return Ca},Ya=(Ca,Ea,wb)=>String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",Ca,Va(qa.a[wb]),Va("browser"),Ea),Va=Ca=>Ca?Ca.charAt(0).toLocaleUpperCase()+
Ca.substring(1,Ca.length):Ca;d.d(V,"RealtimeChannel",function(){return ua});class ua{constructor(Ca,Ea,wb,Oa,ab,fb,db,gc,ob,Sb,Jb,Ab){this.rCd=!1;this.ZX=null;this.sR=new v.a;this.VKb=1;this.T0=null;this.AJ=!1;this.Uvd=(new Date(0)).getTime();this.vuf=0;this._clientId=Ca;this.Oxc=Ea;this.$X=0;this.Sh=Oa;this.Vpd=gc;this.GSh=db;this.eFh=ob;this.OHh=ab;this.QJa=fb;this.Ar=wb;this.Ws=Sb;this.Ic=Jb;this.Di=Ab;this.ZTh=1>100*Math.random()}get ela(){return this.QJa.ela}set ela(Ca){this.QJa.ela=Ca}get cXa(){return this.GSh}get Yk(){return this.eFh}init(){this.Yk.J3h(Object(e.a)(this,
this.vGc,"disconnectAndCreateNewConnection"));this.Yk.P4h(Object(e.a)(this,this.Wmk,"onUpdatePersistentStateRequestReceivedInternal"));this.Yk.O4h(Object(e.a)(this,this.Vmk,"onUpdatePersistentStateClearedRequestReceived"));this.Di.czc(this.Ws);A.AFrameworkApplication.Aea(()=>{const {FrequentLoggingMetrics:Ca}=d(302);this.Ws.kCe();Ca.instance&&Ca.instance.hce()});this.QRf();this.VEi();this.Yk.zCf(Object(e.a)(this,this.Wql,"updateConnectionQueryString"))}VEi(){try{const wb=$.signalR;if(!wb)throw Error.invalidOperation("Failed to retrieve Signalr object");
const Oa=wb.version;if(!Oa)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===Oa){var Ca=wb.transports;if(!Ca)throw Error.invalidOperation("Failed to retrieve transports object");var Ea=Ca.longPolling;if(!Ea)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!Ea.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");Ea.supportsKeepAlive=this.Wyi()}}catch(wb){h.ULS.sendTraceTag(6432339,
500,15,"Failed to disable longPolling KeepAlives: {0}",wb.message)}}Wyi(){return()=>!1}QRf(){const Ca=++this.VKb;this.Uvd=(new Date(0)).getTime();this.T0=this.OHh();this.Yk.fDk(this.T0);this.T0.stateChanged(Ea=>{this.hgk(Ea,Ca)});this.T0.connectionSlow(Object(e.a)(this,this.hmk,"onSlowConnection"));this.T0.error(Object(e.a)(this,this.Slk,"onSignalRError"));this.T0.log=Object(e.a)(this,this.Tlk,"onSignalRLog")}vJb(Ca,Ea){return Ca!==this.VKb?(h.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",
Ea),!1):!0}connect(){2!==this.$X&&1!==this.$X&&(h.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Ar),this.Vpd.dgk(),u.a.instance.eel(),this.vla(1,this.$X),this.grh())}grh(){const Ca=this.VKb;this.rCd=!1;this.Ws.Lbd();this.QJa.e0d(Object(e.a)(this,this.Pqi,"connectSignalrConnection"),Object(e.a)(this,this.iXg,"onFailureToConnect"),Object(e.a)(this.cXa,this.cXa.xuj,"initThrottlerManager"),Object(e.a)(this,this.vJb,"verifyConnectionToken"),Ca)}iXg(Ca=null){this.Ws.Mbd();
let Ea=null;!Ca||"documentsessiondeleted"!==(Ea=Ca.toLowerCase())&&"documentsessionexpired"!==Ea?this.vGc():(h.ULS.sendTraceTag(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Ar,Ca),this.disconnect())}vGc(Ca,Ea=null){h.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.ZX);Ca=(Ca=2===this.$X||1===this.$X)&&!this.cXa.T4a;let wb=!0,Oa=0;Ea&&Object.getType(Ea)!==Object.getType(Sys.EventArgs.Empty)&&
Ea.cEe&&""!==Ea.cEe&&(Ca=!0,this.QJa.wIe(Ea.cEe),wb=Ea.OGe,Oa=Ea.reconnectDelay);Ca&&this.vla(1,this.$X);++this.VKb;this.cXa.qxa();this.Uel(wb);this.QJa.FRd();this.QRf();Ca&&window.setTimeout(Object(e.a)(this,this.grh,"startConnecting"),Math.min(Oa,3E4))}Wql(){let Ca=null;const Ea=({correlationId:Ca}=this.QJa.sLc()).returnValue;this.T0.qs=Ea;h.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Ar,Ca)}Pqi(Ca){const {FrequentLoggingMetrics:Ea}=
d(302);this.Uvd=(new Date).getTime();let wb=null;this.T0.qs=({correlationId:wb}=this.QJa.sLc()).returnValue;this.Ic.v6h&&(this.T0.url=Ca,Ea.instance&&(Ea.instance.ZOf=y.a.NE(Ca)));let Oa=null;this.Sh&&(Oa=this.Sh.wi("WebServiceCall","ConnectToServer"));h.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Ar);Ca={};this.Oxc&&(Ca.transport=1===this.Oxc.length?this.Oxc[0]:this.Oxc);Ca.pingInterval=null;u.a.instance.Zgc(1,0);Ca.waitForPageLoad=!1;this.T0.start(Ca,null).done(ab=>
{this.Ws.aCe();u.a.instance.Zgc(1,1,!0);h.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",ab.id,wb)}).fail(ab=>{h.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",this.QJa.pA,wb,this.Ar);this.iXg();this.Ws.X9g(ab);u.a.instance.Zgc(1,1,!1);this.Yk.U8g(0,{["CorrelationId"]:wb,["ErrorDetails"]:ab,["ConnectionState"]:r.a[this.$X]})}).always(()=>{const {FrequentLoggingMetrics:ab}=
d(302);Oa&&Oa.stop();ab.instance&&(ab.instance.Ord=!1)})}disconnect(){const {FrequentLoggingMetrics:Ca}=d(302);0===this.$X?h.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Ar):(this.Ws.b$g(),Ca.instance&&(Ca.instance.Ord=!0),h.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Ar),this.cXa.T4a=!0,this.Vpd.Ngk(),this.vla(0,this.$X),this.vGc(),this.cXa.T4a=!1)}Uel(Ca){const Ea=this.Fgi(),wb=this.T0,Oa=this.ZX,
ab=()=>{if(this.rCd)h.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.rCd=!0,wb.stop(!0,Ca)}catch(fb){h.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",fb.message)}};0<Ea?(h.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",Oa,Ea),window.setTimeout(ab,Ea)):(h.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",Oa),ab())}Fgi(){let Ca=0;0===this.T0.state&&(Ca=this.Uvd+ua.zxl-
(new Date).getTime(),0>Ca&&(Ca=0));return Ca}get connectionState(){return this.$X}B2a(Ca){this.Yk.B2a(Ca)}$Ge(Ca){return this.ZGe(0,Ca)}ZGe(Ca,Ea){const wb=new m.a;this.Yk.X8g(Ca,Ea,wb);return wb.task}Kzc(Ca){this.Yk.Kzc(Ca)}Ara(Ca){return this.Iej(Ca)}iKc(){return this.LVi()}LVi(){const Ca={};for(let Ea of this.sR)Ea.value.Kb(0)&&(Ca[Ea.key]=Ea.value.ga(0).data);return Ca}Iej(Ca){return this.sR.Kb(Ca)&&this.sR.ga(Ca).Kb(0)?this.sR.ga(Ca).ga(0).data:null}Wmk(Ca,Ea){for(let wb of Ea.Cul)this.sR.Kb(wb.key)||
this.sR.$(wb.key,new W.a),Ca=wb.value,this.sR.ga(wb.key).$(Ea.type,new H(Ca.Presence,new Date(Ca.TimeStamp))),wb.key===this._clientId&&0===Ea.type&&this.Yk.GCk(Ca.Presence)}Vmk(Ca,Ea){for(const wb of Ea.iMd)this.sR.remove(wb)}KVi(){const Ca=new W.a;if(!this.sR.Kb(this._clientId))return Ca;for(let Ea of this.sR.ga(this._clientId))Ca.$(Ea.key,Ea.value.data);return Ca}kea(Ca,Ea=null,wb=!1){const Oa=new m.a;this.Yk.GBe(Ca,Ea,wb,Oa);return Oa.task}Eza(Ca){this.Yk.Eza(Ca)}M5i(){return this.t2(this._clientId)}t2(Ca){let Ea,
wb;return({value:Ea}=this.sR.Nf(Ca)).returnValue&&({value:wb}=Ea.Nf(0)).returnValue?new x(this.Mej(wb),wb.timeStamp):null}TVi(){const Ca={};for(let Ea of this.sR)Ea.value.Nf(0).returnValue&&(Ca[Ea.key]=this.t2(Ea.key));return Ca}phb(Ca){const Ea=new m.a;this.Yk.mEk(Ca,Ea);return Ea.task}get clientId(){return this._clientId}get Yal(){return this.ZTh}dispose(){const {FrequentLoggingMetrics:Ca}=d(302);this.AJ||(this.cXa.qxa(),this.Di.pcd(this.Ws),this.Ws.kCe(),Ca.instance&&Ca.instance.hce(),this.AJ=
!0)}hgk(Ca,Ea){this.vJb(Ea,"StateChangedSignalR")&&this.vla(this.WPf(Ca.newState),this.WPf(Ca.oldState))}vla(Ca,Ea){var {FrequentLoggingMetrics:wb}=d(302),{ClientToClientMessageTelemetry:Oa}=d(997);if((1!==this.$X||0!==Ea||1!==Ca)&&this.$X!==Ea){const ab=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.$X,Ea,Ca]));h.ULS.sendTraceTag(3290053,500,10,ab)}if(this.$X!==Ca){switch(Ca){case 2:wb.instance&&
wb.instance.m9j();this.ZX=this.T0.id;h.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.ZX,this.Ar);this.UVj(this.T0);h.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");wb=null;this.Sh&&(wb=this.Sh.wi("WebServiceCall","Receive First Presence"));Oa=this.VKb;this.Yk.eDk(Object(e.a)(this,this.vJb,"verifyConnectionToken"),Oa,this.Vpd,Object(e.a)(this,this.ULd,"clearExistingPersistentState"),this.KVi(),wb);this.Ic.wTk&&(wb=100*Math.random()<=this.Ic.xTk,
d(997).ClientToClientMessageTelemetry.K6i(this.Yk,this.Ic,wb).start());break;case 1:2===Ea&&h.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.ZX);break;case 0:if(Oa.instance&&Oa.instance.stop(),this.cXa.T4a)h.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.ZX);else{1===Ea&&(h.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",
this.ZX),this.Ws.Ygc());2===Ea&&h.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.ZX);this.vGc();return}}this.$X=Ca;this.Yk.RBk(Ca,Ea)}}UVj(Ca){if(Ca&&Ca.transport&&Ca.transport.name){Ca=Ca.transport.name;var Ea=Ca.toLowerCase();"websockets"===Ea?h.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",Ca,this.Ar):"serversentevents"===Ea?h.ULS.sendTraceTag(4290752,
500,50,"Transport name - {0} for [{1}]",Ca,this.Ar):"foreverframe"===Ea?h.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",Ca,this.Ar):"longpolling"===Ea?h.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",Ca,this.Ar):"mocktransport"!==Ea&&h.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",Ca)}else h.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")}hmk(){if(this.Ic.yfh){const Ca=y.a.rV(this.ela,"mid");h.ULS.sendTraceTag(3249544,
500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.ZX,Ca)}else h.ULS.sendTraceTag(522716053,500,50,"Detected that the connection [{0}] is slow",this.ZX)}Slk(){h.ULS.sendTraceTag(3249545,600,15,"SignalR ERROR for connection [{0}];",this.ZX)}Tlk(Ca){Ca=d(185).RtcUtils.CBb(Ca);if(this.Ic.yfh&&Ca.startsWith("Keep alive timed out.")){const Ea=y.a.rV(this.ela,"mid");h.ULS.sendTraceTag(522716054,500,15,"SignalR lib: {0}. Target Machine: {1}",Ca,Ea)}else this.Yal&&2E3>this.vuf&&
!Ca.startsWith("Invok")&&!Ca.startsWith("Trigger")&&(h.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",Ca),this.vuf++)}ULd(){let Ca;const Ea=[];({value:Ca}=this.sR.Nf(this._clientId)).returnValue&&this.sR.remove(this._clientId);for(let wb of this.sR.keys)Array.add(Ea,wb);for(const wb of Ea)this.sR.remove(wb);Ca&&this.sR.$(this._clientId,Ca);this.Yk.vCk(Ea)}WPf(Ca){switch(Ca){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",Ca,"Unknown SignalR state");
}}Mej(Ca){return Ca&&Ca.timeStamp?(new Date).getTime()-Ca.timeStamp.getTime()>(this.Ic.bJd?6E4:this.Ic.awayCoauthorThresholdMs)?2:1:1}static createInstance(Ca,Ea,wb,Oa,ab,fb,db,gc=null,ob=null,Sb=null,Jb=null,Ab=null,lc=null){return Ua(Ca,Ea,wb,lc,Oa,ab,fb,db,gc,ob,Sb,Ab,Jb)}}ua.pRg=31E3;ua.lre=8E3;ua.zxl=15E3;Object(J.a)(ua,"RealtimeChannel",null,[1038,1037])},679:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Avf=!1;this.zzd=null;this.vYe=0;this.$rd=this.JSf();
this.Apc=this.JSf();this.YZa=this.Bjb=0;this.LE=()=>new Date}get Ffl(){return this.Avf}JSf(){const e=Array(6);for(let m=0;m<e.length;m++)e[m]=0;return e}g1i(){return this.$rd.toString()}FYi(){return this.Apc.toString()}eel(){this.zzd=this.LE()}Zgc(e,m,r=!1){this.Ffl||(r&&(this.Avf=!0),r=this.LE(),0===e&&5<this.Bjb||1===e&&5<this.YZa||(this.vYe<e?(1===this.Bjb%2&&(this.$rd[this.Bjb]=-1,this.Bjb++),this.vYe=e,1===m&&(this.Apc[this.YZa]=-1,this.YZa++),this.Apc[this.YZa]=this.XMe(r),this.YZa++):0===e?
(this.$rd[this.Bjb]=this.XMe(r),this.Bjb++):(this.Apc[this.YZa]=this.XMe(r),this.YZa++)))}XMe(e){const m=e.getTime()-this.zzd.getTime();this.zzd=e;return m}static get instance(){h.Ka||(h.Ka=new h);return h.Ka}static set instance(e){h.Ka=e}}h.Ka=null;Object(J.a)(h,"LatencyMetrics",null,[])},680:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m,r,v){this.jak=e;this.bJa=m;this.m$j=r;this.sgj=v}}Object(J.a)(h,"ThrottlerManagerSettings",null,[])},685:function(J,V,d){J=d(0);
class h extends Sys.EventArgs{constructor(W,K){super();this.newState=W;this.oldState=K}}Object(J.a)(h,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(W,K){super();this.Yli=W;this.QIa=K}}Object(J.a)(e,"ClientInfoEventArgs",Sys.EventArgs,[]);class m extends Sys.EventArgs{constructor(W){super();this.presence=W}}Object(J.a)(m,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);class r extends Sys.EventArgs{constructor(W){super();this.iMd=W}}Object(J.a)(r,"PersistentStateClearedEventArgs",
Sys.EventArgs,[]);class v extends Sys.EventArgs{constructor(W,K){super();this.type=W;this.hJb=K}}Object(J.a)(v,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var A=d(1091);class x extends Sys.EventArgs{constructor(W,K=null){super();this.XF=W;this.mWh=K}get type(){return this.XF}get rxa(){return this.mWh}}Object(J.a)(x,"UpdateNotificationEventArgs",Sys.EventArgs,[]);class y extends Sys.EventArgs{constructor(W){super();this.jxk=W}}Object(J.a)(y,"GotCompletePersistentStateWithMetadataEventArgs",
Sys.EventArgs,[]);class u extends Sys.EventArgs{constructor(W,K,ca,P,ea,da){super();this.vJb=W;this.jNd=K;this.Qqi=ca;this.V_f=ea;this.ULd=P;this.Tx=da}}Object(J.a)(u,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class H extends Sys.EventArgs{constructor(W){super();this.hubConnection=W}}Object(J.a)(H,"RefreshProxyEventArgs",Sys.EventArgs,[]);class G extends Sys.EventArgs{constructor(W,K){super();this.UNi=W;this.errorMessage=K}}Object(J.a)(G,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(W,
K,ca){super();this.type=W;this.presence=K;this.QIa=ca}}Object(J.a)(E,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var I=d(953);class Q extends Sys.EventArgs{constructor(){super()}}Object(J.a)(Q,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);class D extends Sys.EventArgs{constructor(W){super();this.iMd=W}}Object(J.a)(D,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class Y extends Sys.EventArgs{constructor(W,K){super();this.type=W;this.Cul=K}}Object(J.a)(Y,"UpdatePersistentStateRequestEventArgs",
Sys.EventArgs,[]);var M=d(78);d.d(V,"a",function(){return N});class N{constructor(){this.Ta=new M.a}RBk(W,K){this.Ta.raiseEvent("CSC",new h(W,K))}fDk(W){this.Ta.raiseEvent("RP",new H(W))}zbd(W){this.Ta.raiseEvent("RC",W)}jDk(){this.Ta.raiseEvent("RMID")}eDk(W,K,ca,P,ea,da){this.Ta.raiseEvent("RPS",new u(W,K,ca,P,ea,da))}s9g(W,K){this.Ta.raiseEvent("UPSR",new Y(W,K))}N8g(W,K){this.Ta.raiseEvent("PU",new A.a(W,K))}GCk(W){this.Ta.raiseEvent("MPU",new m(W))}GBe(W,K,ca,P){this.Ta.raiseEvent("SUN",new I.a(W,
K,ca,P))}nEk(W,K){this.Ta.raiseEvent("UNR",new x(W,K))}X8g(W,K,ca){this.Ta.raiseEvent("SP",new E(W,K,ca))}YCk(W,K){this.Ta.raiseEvent("PSU",new v(W,K))}XCk(W){this.Ta.raiseEvent("PSC",new r(W))}vCk(W){this.Ta.raiseEvent("IPSC",new r(W))}oEk(W){this.Ta.raiseEvent("UPSC",new D(W))}sDk(W,K){this.Ta.raiseEvent("SPC",new Q(W,K))}U8g(W,K){this.Ta.raiseEvent("RCF",new G(W,K))}mCk(W){this.Ta.raiseEvent("CPSWM",new y(W))}mEk(W,K){this.Ta.raiseEvent("UCI",new e(W,K))}B2a(W){this.Ta.addHandler("CSC",W)}K3h(W){this.Ta.addHandler("RP",
W)}J3h(W){this.Ta.addHandler("RC",W)}P3h(W){this.Ta.addHandler("RMID",W)}I3h(W){this.Ta.addHandler("RPS",W)}P4h(W){this.Ta.addHandler("UPSR",W)}Kzc(W){this.Ta.addHandler("PU",W)}K1h(W){this.Ta.addHandler("IPU",W)}N4h(W){this.Ta.addHandler("UCI",W)}W3h(W){this.Ta.addHandler("SUN",W)}L1h(W){this.Ta.addHandler("IUNR",W)}Eza(W){this.Ta.addHandler("UNR",W)}J1h(W){this.Ta.addHandler("IPSU",W)}I1h(W){this.Ta.addHandler("IPSC",W)}O4h(W){this.Ta.addHandler("UPSC",W)}V3h(W){this.Ta.addHandler("SP",W)}zCf(W){this.Ta.addHandler("SPC",
W)}T3h(W){this.Ta.addHandler("RCF",W)}D1h(W){this.Ta.addHandler("CPSWM",W)}CMk(W){this.Ta.removeHandler("CPSWM",W)}static getInstance(){return N.Ka||(N.Ka=new N)}}N.Ka=null;Object(J.a)(N,"RtcEventHub",null,[1083])},687:function(J,V,d){d.r(V);J=d(0);var h=d(374),e=d(13),m=d(17),r=d(949),v=d(955),A=d(25),x=d(82),y=d(63),u=d(443),H=d(490),G=d(105),E=d(45),I=d(114),Q=d(956);class D{}D.clientId="ClientId";D.fvl="UserApp";D.userSessionId="usid";D.userType="UserType";D.wvl="UserVersion";D.wgc="qs";D.ami=
"clientProtocol";D.sck="NoAuth";Object(J.a)(D,"RtcFindSessionInputQueryParamConstants",null,[]);class Y{constructor(C,oa,Z,pa,ya,Ja){this.b1a=null;const {FindSessionStrategy:Ka}=d(687);this.CRh=C;C=String.format("{0}={1}",D.clientId,E.a.Me(pa));C=String.format("{0}&{1}={2}",C,D.userSessionId,E.a.Me(ya));C=String.format("{0}&{1}={2}",C,D.fvl,E.a.Me(Z.toString()));C=String.format("{0}&{1}={2}",C,D.userType,E.a.Me("1"));C=String.format("{0}&{1}={2}",C,D.wvl,E.a.Me(oa));C=String.format("{0}&{1}={2}",
C,D.ami,E.a.Me(Ka.$li));(oa=Y.rWi(Z,Ja))&&(C=String.format("{0}&{1}",C,oa));this.PHh=C}L$g(){this.b1a=this.CRh()}VTi(){this.b1a&&""!==this.b1a||(this.L$g(),h.ULS.sendTraceTag(575784194,500,this.b1a&&""!==this.b1a?50:15,"Query signature delegate called for refresh returned: {0} ",this.b1a));const C=String.format("{0}={1}",D.wgc,E.a.Me(this.b1a));return String.format("{0}&{1}",C,this.PHh)}static rWi(C,oa){return 4===C?String.format("{0}={1}",D.sck,"1"):oa?oa.Qej():null}}Object(J.a)(Y,"FindSessionQueryStringGenerator",
null,[]);var M=d(302),N=d(679),W=d(185),K=d(680);class ca{}ca.gQi="FSType";Object(J.a)(ca,"RtcFindSessionRequestHeaders",null,[]);class P{}P.kFk="polling";Object(J.a)(P,"RtcFindSessionTypes",null,[]);var ea=d(954);class da{}da.twl="RTC-TokenProofkey";da.aOj="RTC-IsWacJsBootFsRequest";Object(J.a)(da,"RtcRequestHeaders",null,[]);d.d(V,"FindSessionStrategy",function(){return ia});class ia{constructor(C,oa,Z,pa,ya,Ja,Ka,ma,ra,Da,va,Fa,ka=null){this.pbf=(new Date(0)).getTime();this.Icf=0;this.Etc=!1;this.xtf=
null;this.sCe=36E5;this.Tib=ia.flg;this.WLb=0;this.seb=null;this.Wva=0;this.REb=this.$Of=null;this.iSh=[v.a.Lub,v.a.errorMessage,v.a.SLe,v.a.pA,v.a.q4,v.a.$1d,v.a.ccb,v.a.bJa,v.a.ecb];this.hSh=[v.a.Lub,v.a.errorMessage];this.pA=this.ela=null;this.I1e=new Y(va?va:()=>A.AFrameworkApplication.$g,ya,Ja,Ka,C,oa);this.BKb=Fa;this.Sh=pa;this.Di=oa;this.kKh=Z;this.Ar=ma;this.Yk=ra;this.iMb=ka;this.J1e=!1;this.UYb=9E4;Da&&Da.execute(qa=>{qa.Gzc(()=>{h.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",
this.Ar);this.I1e.L$g()})});2>=100*Math.random()&&(this.sCe=3E5);M.FrequentLoggingMetrics.instance&&(M.FrequentLoggingMetrics.instance.H4f=this.sCe)}wIe(C){this.REb=C}init(){this.Yk.P3h(Object(e.a)(this,this.XQk,"resetGetMachineIdDelay"));this.Yk.B2a(Object(e.a)(this,this.vla,"onConnectionStateChanged"))}vla(C,oa){this.Wva=oa.newState;2===oa.newState&&(this.WLb=0)}sLc(){let C;C=this.seb.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.seb.q4,ia.WNd,E.a.Me(C)),correlationId:C}}e0d(C,
oa,Z,pa,ya){this.lXk(()=>{pa(ya,"GetMachineIdSuccess")&&(h.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.pA,this.Ar),C(this.xtf),Z(this.Edj()))},Ja=>{pa(ya,"GetMachineIdFailure")&&(h.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",this.Ar),oa(Ja))},pa,ya)}FRd(){this.JMf();this.atj()}lXk(C,oa,Z,pa){h.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",
this.pA);this.pA?C():window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(C,oa,Z,pa)},this.mgi())}sendFindSessionRequestToServerInternal(C,oa,Z,pa){Z(pa,"RequestMachineId")&&(this.pbf=(new Date).getTime(),Z=y.a.pj(),this.L8f(ya=>{const Ja=y.a.pj();this.f9c(ya);this.eIe();C();ya=y.a.pj()-Ja;h.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",ya)},ya=>{const Ja=y.a.pj();this.JMf();M.FrequentLoggingMetrics.instance&&M.FrequentLoggingMetrics.instance.qG(2,3);oa(ya);ya=
y.a.pj()-Ja;h.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ya)},!1),Z=y.a.pj()-Z,h.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",Z))}atj(){this.Tib+=ia.N4i;this.Tib=Math.min(this.Tib,ia.g$j)}mgi(){let C=this.pbf+this.Tib-(new Date).getTime();0>C&&(C=0);return C}f9c(C){try{this.seb=C,this.ela=C.IOf,this.pA=C.pA,this.$Of=C.q4,this.xtf=C.tVb}catch(oa){h.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",oa.toString())}}JMf(){this.pA=
null;this.KMf()}eIe(){this.KMf();this.Etc=!0;this.Icf=window.setTimeout(Object(e.a)(this,this.sHk,"refreshMachineId"),this.sCe)}KMf(){this.Etc&&(window.clearTimeout(this.Icf),this.Etc=!1)}sHk(){this.Etc=!1;this.L8f(C=>{const oa=this.$Of!==C.q4,Z=this.pA!==C.pA,pa=this.pA;this.f9c(C);0!==this.Wva&&(Z?(h.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",pa||"null",C.pA),this.Yk.zbd()):(this.Yk.sDk(oa,Z),this.eIe()))},()=>{M.FrequentLoggingMetrics.instance&&
M.FrequentLoggingMetrics.instance.qG(2,3);this.eIe()},!0)}XQk(){this.Tib=ia.flg}Edj(){return new K.a(this.seb.H4c,this.seb.E4c,this.seb.D4c,this.seb.QNc)}zll(C){if(Object.getType(C)!==Object)return null;for(let oa in C);return this.Avi(C)}Avi(C){if(!(v.a.Lub in C))return null;const oa=C[v.a.Lub];var Z=oa?this.iSh:this.hSh;for(const pa of Z)if(!(pa in C))return null;Z=Object.assign(new Q.a,{l4b:C[v.a.Lub],errorMessage:C[v.a.errorMessage],correlationId:I.a.create().toString()});oa&&(Z.tVb=C[v.a.SLe],
Z.q4=C[v.a.q4],Z.pA=C[v.a.pA],Z.QNc=C[v.a.$1d],Z.D4c=C[v.a.ccb],Z.E4c=C[v.a.bJa],Z.H4c=C[v.a.ecb]);return Z}h1i(C,oa){h.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.iMb.eQi.continueWith(()=>{this.iMb.eQi.result?(h.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),C(this.iMb.fQi)):(h.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),oa(this.iMb.fQi))})}Rdh(C,oa,Z,pa,ya=!1){return Ja=>{N.a.instance.Zgc(0,
1);C&&C.stop();this.BKb=this.REb=null;this.tAg(Ja.data,!0,oa);var Ka=W.RtcUtils.deserialize(Ja.data.je,"FindSession",null);if(Ka)if(Ka=this.zll(Ka)){if(Ka.l4b&&Ka.q4&&Ka.pA){h.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",this.Ar);this.wTj(Ja.data);Z(Ka);return}oa.FindSessionFailureReason="FindSessionInvalidResponse";oa.IsRtcEnabled=Ka.l4b;oa.IsQueryStringEmpty=!Ka.q4;oa.IsConnectionStringEmpty=!Ka.pA;h.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",
this.Ar,Ka.l4b,!Ka.q4,!Ka.pA)}else oa.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",h.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.Ar);else oa.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",h.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",this.Ar);this.V8g(oa,ya);pa(null)}}Jdh(C,oa,Z,pa=!1){return ya=>{N.a.instance.Zgc(0,1);C&&C.stop();this.BKb=this.REb=null;
this.tAg(ya.data,!1,oa);let Ja=null;var Ka="unknown";let ma="unknown";ya.data&&((Ka=ya.data.lj)&&ia.wic in Ka&&(Ja=Ka[ia.wic].toString()),Ka=H.a[ya.data.status],ma=ya.data.tf.toString());oa.FindSessionFailureReason="FindSessionRequestFailed";oa.HttpErrorCode=ma;oa.HttpErrorStatus=Ka;oa[ia.wic]=Ja;h.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",Ka,ma,this.Ar,Ja,pa);this.V8g(oa,pa);Z(ma)}}L8f(C,oa,Z=
!1){let pa=null;h.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Ar);const ya={};var Ja=this.I1e.VTi();ya[u.a.oAa]=I.a.create().toString();this.REb&&""!==this.REb?Ja=String.format("{0}&{1}={2}",Ja,ea.a.tFe,this.REb):this.BKb&&""!==this.BKb&&(Ja=String.format("{0}&{1}={2}",Ja,ea.a.tFe,this.BKb),ya[da.twl]="True",ya[da.aOj]="True");Ja=this.kKh+"?"+Ja;Z&&(ya[ca.gQi]=P.kFk);const Ka={};Ka.IsNetworkOfflineBeforeSendRequest=this.Di.hDa;Ka.HasAvailableConnectionsBeforeSendRequest=
this.Di.Jhg;Ka.MaxConnectionsAllowed=this.Di.kRg;Ka.IsRefreshMachineId=Z;this.iMb&&!this.J1e?(this.h1i(this.Rdh(null,Ka,C,oa,Z),this.Jdh(null,Ka,oa,Z)),this.J1e=!0):(this.Sh&&(pa=this.Sh.wi("WebServiceCall","GetMachineIdFromTheServer")),M.FrequentLoggingMetrics.instance&&M.FrequentLoggingMetrics.instance.qG(2,0),0>this.Di.wY(Ja,1,null,ya,[ia.sEc,ia.wic,ia.qcc,ia.rFe,ia.XSg,ia.QUg,ia.PUg],1,this.Rdh(pa,Ka,C,oa,Z),this.Jdh(pa,Ka,oa,Z),null,null,!1,null,this.UYb,"3",null,!0)&&(5<this.WLb&&200>this.WLb&&
h.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.WLb),window.setTimeout(()=>{this.WLb++;oa("-1")},1E3)))}tAg(C,oa,Z){Z||(Z={});Z.IsNetworkOfflineAfterRequestComplete=this.Di.hDa;Z.IsRequestSucceeded=oa;C&&(Z.EnqueueTime=C.JH,Z.InvokedTime=C.wt,Z.CompletedTime=C.Eu,C.lj&&(ia.sEc in C.lj&&(Z.CorrelationId=C.lj[ia.sEc]),ia.qcc in C.lj&&(Z[ia.qcc]=C.lj[ia.qcc])));h.ULS.sendTraceTag(38633565,500,oa?50:15,W.RtcUtils.CBb(Z))}V8g(C,
oa){C||(C={});C.ConnectionState=r.a[this.Wva];oa||this.Yk.U8g(1,C)}wTj(C){try{var oa=!1,Z=!1,pa=C.lj,ya=x.a.NE(C.request.get_url());if(pa&&ia.rFe in pa){const Da=pa[ia.rFe].toString().toLocaleLowerCase();Z="true"===Da;oa="false"===Da}pa=!1;const ra=0<=ya.toLocaleLowerCase().indexOf("collab");Z&&!ra?pa=!0:oa&&ra&&(pa=!0);if(pa){oa={};oa.HostName=ya;oa.Status=H.a[C.status];oa.HttpStatus=C.tf.toString();var Ja=C.request.get_headers();for(let Da in Ja){var Ka=Ja[Da];(ya=Da)&&0<ya.length&&(Z=0,Ka&&(Z=
Ka.toString().length),oa["r_"+ya]=Z)}if(C.lj){const Da=new m.a;Da.add(ia.sEc);Da.add(ia.qcc);Da.add(ia.wic);Da.add(ia.QUg);Da.add(ia.PUg);Da.add(ia.XSg);ia.E_h(oa,C.lj,Da)}ia.y_h(C.request.get_url(),oa);var ma=G.a.toJSON(oa);h.ULS.sendTraceTag(559437006,500,15,ma)}}catch(ra){h.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",ra.toString())}}static createInstance(C,oa,Z,pa,ya,Ja,Ka,ma,ra,Da,va,Fa=null){return ia.SEc(C,oa,Z,pa,ya,Ja,Ka,ma,ra,Da,null,va,Fa)}static rwi(C,oa,
Z,pa,ya,Ja,Ka,ma,ra,Da,va=null){return ia.SEc(C,oa,Z,pa,ya,3,Ja,Ka,ma,ra,Da,va,null)}static SEc(C,oa,Z,pa,ya,Ja,Ka,ma,ra,Da,va,Fa,ka=null){C=C||I.a.create().toString();C=new ia(C,oa,Z,pa,ya,Ja,Ka,ma,ra,Da,va,Fa,ka);C.init();return C}static E_h(C,oa,Z){for(let pa of Z)pa in oa&&(C[pa]=oa[pa])}static y_h(C,oa){if(C){var Z=C.indexOf("?");if(-1!==Z)for(C=C.substr(Z+1).split("&"),Z=0;Z<C.length;++Z){var pa=C[Z].split("=");if(2===pa.length){const ya=pa[0];if(ya&&0<ya.length){let Ja=0;if(pa=pa[1])Ja=pa.length;
oa["q_"+ya]=Ja}}}}}}ia.N4i=3E3;ia.g$j=3E5;ia.$li="1.0";ia.flg=1E3;ia.sEc="X-CorrelationId";ia.WNd="corrid";ia.wic="RtcErrorCode";ia.qcc="X-OfficeCluster";ia.rFe="X-NewEnv";ia.XSg="X-MSEdge-Ref";ia.PUg="X-OFFICEFD";ia.QUg="X-OfficeFE";Object(J.a)(ia,"FindSessionStrategy",null,[1079])},711:function(J,V,d){J=d(0);class h{constructor(){this.HWe=this.Spd=!1;this.callback=null}Ccc(m){this.callback=m;this.Zvh()}JQg(m){this.Spd||(this.Spd=!0,this.LHh=m,this.Zvh())}Zvh(){this.Spd&&this.callback&&!this.HWe&&
(this.HWe=!0,this.callback(this.LHh))}}Object(J.a)(h,"CompletionTask",null,[]);d.d(V,"a",function(){return e});class e{constructor(){this.odf=new h;this.mdf=new h}t7c(m){this.odf.Ccc(m)}s7c(m){this.mdf.Ccc(m)}lbc(m){this.odf.JQg(m)}iVa(m){this.mdf.JQg(m)}cre(){this.lbc(2);this.iVa(2)}}Object(J.a)(e,"MessageStatus",null,[1176])},949:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.disconnected=0]="disconnected";e[e.connecting=1]="connecting";e[e.connected=2]="connected"})(h||
(h={}));Object(J.b)("ChannelConnectionState",h)},950:function(J,V,d){d.r(V);d.d(V,"MaxOutstandingThrottler",function(){return r});J=d(0);var h=d(13),e=d(78);V=d(951);var m=d(711);class r extends V.a{constructor(v,A=""){super(v,A);this.ccb=this.bJa=0;this.Ta=new e.a;this.ckb=!1;this.nuc=this.Tpc=this.Bpc=this.tDd=0;this.Gxc=[];this.clearTimeout=r.jQd}add(v){this.dkb||this.init(r.cUf,r.STf);this.R1a++;const A=new m.a;this.yub?this.jgd(v,A):this.nuc<this.ccb?this.Xic(v,A):(this.jgd(v,A),this.ckb=!1);
return A}Xic(v,A){v=this.ktf(v);const x=this.setTimeout(Object(h.a)(this,this.djk,"onMessageWaitTimeExpired"),this.bJa);++this.nuc;Array.add(this.Gxc,x);const y=this.Bpc;v.t7c(u=>{A.lbc(u)});v.s7c(u=>{this.Bpc===y&&(this.cjk(y,x),A.iVa(u))})}cjk(v,A){this.Bpc===v&&(--this.nuc,this.clearTimeout(A),Array.remove(this.Gxc,A),this.yub&&this.SXk())}SXk(){this.yub&&!this.ckb&&(this.tDd=this.setTimeout(Object(h.a)(this,this.TXk,"sendThrottledMessageFromTimer"),0),this.ckb=!0)}TXk(){this.ckb=!1;if(this.yub){const v=
this.Cxc,A=this.Xlb;this.NUb(!1);this.Xic(v,A)}}djk(){++this.Tpc;this.Tpc>Math.floor(this.ccb/2)&&(this.Tpc=-1E9,this.Ta.raiseEvent("TMUDM"))}Pzc(v){this.Ta.addHandler("TMUDM",v)}reset(){this.R1a=this.jRb=this.GLb=this.Tpc=0;++this.Bpc;for(const v of this.Gxc)this.clearTimeout(v);this.nuc=0;this.Gxc=[];this.NUb(!0);this.ckb&&(this.clearTimeout(this.tDd),this.tDd=0,this.ckb=!1)}init(v,A){this.dkb||(this.bJa=v,this.ccb=A,this.dkb=!0)}static createInstance(v,A=""){return new r(v,A)}static jQd(v){window.clearTimeout(v)}}
r.cUf=15E3;r.STf=5;Object(J.a)(r,"MaxOutstandingThrottler",V.a,[1172,1173])},951:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(374);class e{constructor(m,r=""){this.GLb=this.jRb=0;this.Pud=!1;this.Xlb=this.Cxc=null;this.dkb=!1;this.ktf=m;this.Vuh=r;this.setTimeout=e.tQd;this.R1a=this.jRb=this.GLb=0}jCe(){0<this.R1a&&0<this.GLb&&h.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.Vuh,this.GLb,this.R1a);0<this.R1a&&0<this.jRb&&h.ULS.sendTraceTag(36545634,
500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.Vuh,this.jRb,this.R1a)}get yub(){return this.Pud}jgd(m,r){this.jRb++;this.NUb(!0);this.Pud=!0;this.Cxc=m;this.Xlb=r}NUb(m){this.Pud=!1;this.Xlb&&m&&(this.GLb++,this.Xlb.cre());this.Xlb=this.Cxc=null}static tQd(m,r){return window.setTimeout(m,r)}}Object(J.a)(e,"ThrottlerBase",null,[])},952:function(J,V,d){d.r(V);d.d(V,"MaxRateThrottler",function(){return m});J=d(0);var h=d(13);V=d(951);var e=d(711);class m extends V.a{constructor(r,
v=""){super(r,v);this.ecb=0;this.aOb=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(r){this.dkb||(this.ecb=r,this.dkb=!0)}add(r){this.dkb||this.init(m.MTf);this.R1a++;const v=this.currentTime(),A=new e.a;this.aOb>v&&(this.aOb=v);this.yub?(this.NUb(!0),this.jgd(r,A)):this.aOb+this.ecb<=v?this.Xic(r,A):(this.jgd(r,A),this.setTimeout(Object(h.a)(this,this.RXk,"sendThrottledMessage"),this.aOb+this.ecb-v));return A}RXk(){if(this.yub){const r=this.Cxc,v=this.Xlb;this.NUb(!1);this.Xic(r,
v)}}Xic(r,v){this.aOb=this.currentTime();r=this.ktf(r);r.t7c(A=>{v.lbc(A)});r.s7c(A=>{v.iVa(A)})}static createInstance(r,v=""){return new m(r,v)}}m.MTf=200;Object(J.a)(m,"MaxRateThrottler",V.a,[1174,1173])},953:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m,r,v){super();this.type=e;this.rxa=m;this.ZCi=r;this.QIa=v}}Object(J.a)(h,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},954:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}
h.tFe="rr";h.zTk="rd";h.vTk="rbp";h.OGe="sa";Object(J.a)(h,"RtcReconnectParams",null,[])},955:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.ecb="throttling_messageDelay";h.Lub="enabled";h.bJa="throttling_timeToWaitForResponse";h.ccb="throttling_maxNumberOfOutstandingMessages";h.$1d="throttling_globalMaxNumberOfOutstandingMessages";h.errorMessage="errorMessage";h.SLe="url";h.q4="queryString";h.pA="connectionString";Object(J.a)(h,"RtcFindSessionOutputFieldNameConstants",null,[])},
956:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.QNc=this.D4c=this.E4c=this.H4c=0;this.l4b=!1;this.correlationId=this.pA=this.q4=this.tVb=this.errorMessage=null}get IOf(){return this.tVb+"?"+this.q4}}Object(J.a)(h,"FindSessionResponse",null,[])},996:function(J,V,d){J=d(0);var h;(function(m){m[m.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";m[m.peopleImageClassName=1]="peopleImageClassName";m[m.peopleImageClusterPath=4]="peopleImageClusterPath";
m[m.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";m[m.imageDimension=6]="imageDimension";m[m.rtl=8]="rtl";m[m.pointerInputManager=9]="pointerInputManager";m[m.clickInputManager=10]="clickInputManager";m[m.vertical=11]="vertical";m[m.zIndex=12]="zIndex";m[m.contextMenuInputManager=13]="contextMenuInputManager";m[m.imageDomElement=14]="imageDomElement";m[m.useIdleTooltip=15]="useIdleTooltip";m[m.viewportBoundsCallback=16]="viewportBoundsCallback";m[m.flipHorizontalDirection=17]=
"flipHorizontalDirection";m[m.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";m[m.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";m[m.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||(h={}));Object(J.b)("PresenceTooltipSettingKeys",h);d.d(V,"a",function(){return e});class e{constructor(){this.Yx={}}get(m,r=null){m=h[m];return"number"===typeof r?(r=this.Yx[m])?Number.parseInvariant(r.toString()):0:this.Yx[m]}add(m,r){this.Yx[h[m]]=r}UC(m,r){h[m]in this.Yx||(this.Yx[h[m]]=
r)}remove(m){delete this.Yx[h[m]]}}Object(J.a)(e,"PresenceTooltipSettings",null,[])},997:function(J,V,d){d.r(V);J=d(0);var h=d(374),e=d(13),m=d(1019),r=d(336),v=d(17);class A{constructor(y){this.messageId=y;this.UXk=(new Date).getTime();this.dbe=new v.a}}Object(J.a)(A,"MessageLatencyDetails",null,[]);d.d(V,"ClientToClientMessageTelemetry",function(){return x});class x{constructor(y,u,H){this.joa=null;this.Owd=this.tBd=0;this.Ic=u;this.qdf=H;this.vQb=!1;this.Yk=y;this.Yk.Eza(Object(e.a)(this,this.wFk,
"receiveMessage"))}start(){if(this.qdf&&!this.vQb){const y=this.Ic.Afh;this.Owd=this.Ic.xfh;y<=this.Owd?(h.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.Ic.Afh,this.Ic.xfh),this.qdf=!1):(this.vQb=!0,this.tBd=window.setInterval(Object(e.a)(this,this.sendMessage,"sendMessage"),y))}}sendMessage(){if(this.vQb){const y=r.a.create().toString();
this.joa=new A(y);this.Yk.GBe(16,y,!1,new m.a);window.setTimeout(()=>{this.GUj(y)},this.Owd)}}GUj(y){this.joa&&this.joa.messageId===y&&(0<this.joa.dbe.count?(y=this.joa.dbe.toArray().join(","),h.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",y)):h.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.joa=null)}stop(){this.tBd&&(window.clearInterval(this.tBd),this.vQb=!1)}wFk(y,u){16===u.type?this.Yk.GBe(17,u.rxa,!1,new m.a):17===u.type&&this.vQb&&u.rxa&&
this.Fyk(u.rxa)}Fyk(y){y&&this.joa&&y.toString()===this.joa.messageId&&this.joa.dbe.add((new Date).getTime()-this.joa.UXk)}static get instance(){return x.Ka}static K6i(y,u,H){return x.instance||(x.Ka=new x(y,u,H))}}x.Ka=null;Object(J.a)(x,"ClientToClientMessageTelemetry",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.presence1.js.map