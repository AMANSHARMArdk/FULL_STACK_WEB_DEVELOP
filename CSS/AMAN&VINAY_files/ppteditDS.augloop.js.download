'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1194:function(J,V,d){d.r(V);var h=d(0),e=d(374),m=d(25),r=d(55),v=d(69),A=d(17),x=d(13);class y{constructor(){this.ContextId=this.SessionId=this.AppId=this.Payload=this.Topic=null}}Object(h.a)(y,"AugmentationServiceRequest",null,[]);var u=d(33),H=d(67);class G{constructor(na,Pa,cb){this.bmb=this.cpa=null;this.VFh=cb;this.mb=Pa;this.Di=na}initialize(){e.ULS.sendTraceTag(25747911,306,50,"Start initialing augmentation loop ...");
const na=this.mb.Ia("AugmentationLoopWebServiceBase"),Pa=this.mb.Ia("WebServiceBase");this.cpa=(void 0===na?Pa:na)+"proofing.ashx?"+m.AFrameworkApplication.$g+"&apitype=AL";this.bmb=new H.a;e.ULS.sendTraceTag(25747912,306,50,"Augmentation Loop initialized")}addEventHandler(na,Pa){if(na&&""!==na)if(Pa){if(!({value:cb}=this.bmb.Nf(na)).returnValue){var cb=new A.a;this.bmb.add(na,cb)}cb.contains(Pa)||cb.add(Pa)}else e.ULS.sendTraceTag(25747914,306,15,"eventHandler is null");else e.ULS.sendTraceTag(25747913,
306,15,"topic is empty or null")}removeEventHandler(na,Pa){na&&""!==na?Pa?this.bmb.Kb(na)?({value:na}=this.bmb.Nf(na),na&&na.contains(Pa)&&na.remove(Pa)):e.ULS.sendTraceTag(25747917,306,15,"Topic {0} doesn't exist in handler map.",na):e.ULS.sendTraceTag(25747916,306,15,"Try to remove null handler"):e.ULS.sendTraceTag(25747915,306,15,"topic is empty or null")}PGe(na,Pa,cb){this.Xhc(na,Pa,cb,Object(x.a)(this,this.EHa,"requestSucceeded"),Object(x.a)(this,this.CHa,"requestFailed"))}Xhc(na,Pa,cb,R,ta,
Ra=null){na=Object.assign(new y,{Topic:na,Payload:Pa,AppId:this.VFh,SessionId:this.Di.userSessionId,ContextId:cb});this.Di.Jj(this.cpa,2,u.c(na),{"Content-Type":"application/json; charset=utf-8"},!1,3,R,ta,Ra?Ra:na,void 0,void 0,void 0,void 0,"18")}EHa(na){!m.AFrameworkApplication.Xg&&na&&na.data&&this.efk(na.data.je)}CHa(na){!m.AFrameworkApplication.Xg&&na&&na.data&&e.ULS.sendTraceTag(25747918,306,15,"{0}",na.data.je)}efk(na){if(na){try{var Pa=u.a(na)}catch(cb){e.ULS.sendTraceTag(36284437,306,10,
"Try parse aug response failed:{0}",cb.message);return}if(({value:na}=this.bmb.Nf(Pa.Topic)).returnValue)for(let cb of na)cb(Pa.ContextId,Pa.Payload);else e.ULS.sendTraceTag(25747919,306,50,"Cannot find handlers for Topic:{0};",Pa.Topic)}}}Object(h.a)(G,"AugmentationManager",null,[1019]);var E=d(1154);class I{}Object(h.a)(I,"HostMetadata",null,[]);class Q{}Object(h.a)(Q,"Lambda",null,[]);class D extends Q{constructor(){super()}}Object(h.a)(D,"WrapperLambda",Q,[]);var Y=d(387),M=d(141);class N{constructor(){this.handler=
this.schemaName=null}}Object(h.a)(N,"AddEventHandlerParameters",null,[]);var W=d(645);class K{constructor(){this.lambda=this.name=null}}Object(h.a)(K,"RegisterSimpleLocalWorkflowParameters",null,[]);class ca{constructor(){this.lambdaAfter=this.lambdaRemote=this.lambdaBefore=this.name=null}}Object(h.a)(ca,"RegisterSimpleRemoteWorkflowParameters",null,[]);var P=d(937);class ea{constructor(){this.requestAuthTokenCallback=null}}Object(h.a)(ea,"SetRequestAuthTokenCallbackParameters",null,[]);class da{constructor(){this.sendOTelEvent=
null}}Object(h.a)(da,"SetSendOTelEventCallbackParameters",null,[]);class ia{constructor(){this.ulsLogger=null}}Object(h.a)(ia,"SetULSLoggerParameters",null,[]);var C=d(891);class oa{constructor(){this.correlationVector=this.input=this.inputSchema=null}}Object(h.a)(oa,"SubmitParameters",null,[]);var Z=d(521);class pa{constructor(na,Pa=null){this.TX=null;new H.a;new I;this.eTh=na;this.xLa=Pa}initialize(na){this.TX?e.ULS.sendTraceTag(51185349,306,15,"Initialize called multiple times."):(na||(na=new W.a),
this.TX=new Promise(Pa=>{e.ULS.sendTraceTag(51185350,306,50,"Start download and initialize augloop runtime ...");const cb=m.AFrameworkApplication.Rj("al",2);this.eTh.Tvb(cb).continueWith(()=>{e.ULS.sendTraceTag(51185351,306,50,"augloop: Successfully loaded script");const R=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();R.setRequestAuthTokenCallback(Object.assign(new ea,{requestAuthTokenCallback:Object(x.a)(this,this.rQk,"requestAuthToken")}));R.setULSLogger(Object.assign(new ia,{ulsLogger:new Y.a}));
R.setSendOTelEventCallback(Object.assign(new da,{sendOTelEvent:Object(x.a)(this,this.sendOTelEvent,"sendOTelEvent")}));let ta=m.AFrameworkApplication.fa.Ia("OfficeApplicationName")||"";ta=ta.replace("Web","");na.appName=na.appName||ta;na.serviceUrl=na.serviceUrl||m.AFrameworkApplication.fa.Ia("AugLoopCloudALServiceUrl");na.appVersion=na.appVersion||m.AFrameworkApplication.fa.Ia("BuildVersion")||"";na.releaseAudienceGroup=na.releaseAudienceGroup||(m.AFrameworkApplication.Zc?Object(E.a)(String,m.AFrameworkApplication.Zc.AudienceGroup)||
"":"");na.sessionId=na.sessionId||m.AFrameworkApplication.fa.Ia("SessionId")||"";na.uiLanguage=na.uiLanguage||m.AFrameworkApplication.uiCulture;na.flights=na.flights||this.bVi();na.initSession=na.initSession||!0;na.downloadBaseUrl=na.downloadBaseUrl||m.AFrameworkApplication.fa.Ia("AugLoopDownloadBaseUrl");R.initialize(na);Pa({})})}))}registerSchemas(){e.ULS.sendTraceTag(51185352,306,50,"RegisterSchemas is a No-Op");return this.TX}registerSimpleLocalWorkflow(na,Pa){return this.TX.then(()=>{e.ULS.sendTraceTag(51185353,
306,50,"Registering local workflow: {0} to AugLoop.",na);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleLocalWorkflow(Object.assign(new K,{name:na,lambda:this.tkd(Pa)}))})}registerSimpleRemoteWorkflow(na,Pa,cb,R){return this.TX.then(()=>{e.ULS.sendTraceTag(51185354,306,50,"Registering remote workflow: {0} to AugLoop.",na);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleRemoteWorkflow(Object.assign(new ca,{name:na,lambdaBefore:this.tkd(Pa),lambdaRemote:this.tkd(cb),
lambdaAfter:this.tkd(R)}))})}registerReduceWorkflow(){e.ULS.sendTraceTag(51185355,306,100,"RegisterReduceWorkflow is NYI");return this.TX}submit(na,Pa){this.TX.then(()=>{e.ULS.sendTraceTag(51185356,306,100,"Submitting event: {0} to AugLoop.",na);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submit(Object.assign(new oa,{inputSchema:na,input:Pa}))})}flushTelemetry(){e.ULS.sendTraceTag(51185357,306,100,"FlushTelemetry is NYI")}submitOperation(na){this.TX.then(()=>{e.ULS.sendTraceTag(51185358,306,
100,"Submitting Operation: {0} to AugLoop.",na);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new C.a,{operation:na}))})}setSessionDataCallback(na){this.TX.then(()=>{e.ULS.sendTraceTag(592318537,306,100,"Setting SessionData Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionDataCallback(na)})}setInitSessionCallback(na){this.TX.then(()=>{e.ULS.sendTraceTag(594384065,306,100,"Setting init session override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setInitSessionCallback(na)})}setSessionInitOverrideCallback(na){this.TX.then(()=>
{e.ULS.sendTraceTag(594384064,306,100,"Setting session init override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionInitOverrideCallback(na)})}setAnnotationResultCallback(na){this.TX.then(()=>{e.ULS.sendTraceTag(51185359,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setAnnotationResultCallback(Object.assign(new P.a,{handler:na}))})}activateAnnotation(na){return this.TX.then(()=>{e.ULS.sendTraceTag(51226247,306,100,"Activating Annotation: {0}",
na.annotationType);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation(na)})}releaseAnnotation(na){return this.TX.then(()=>{e.ULS.sendTraceTag(51226248,306,100,"Releasing Annotation: {0}",na.token);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().releaseAnnotation(na)})}addEventHandler(na,Pa){na&&""!==na?Pa?this.TX.then(()=>{e.ULS.sendTraceTag(51185362,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().addEventHandler(Object.assign(new N,
{schemaName:na,handler:cb=>{cb&&Pa(cb.inputSchema,cb.input,cb.outputSchema,cb.output)}}))}):e.ULS.sendTraceTag(51185361,306,15,"eventHandler is null"):e.ULS.sendTraceTag(51185360,306,15,"schemaName is empty or null")}removeEventHandler(){e.ULS.sendTraceTag(51185363,306,100,"RemoveEventHandler is NYI.")}rQk(){const na=m.AFrameworkApplication.fa.Ia("AugLoopOAuthResourceUriV2");if(this.xLa)return new Promise(Pa=>{this.xLa.execute(cb=>{cb.p0("AugLoop",na).then(R=>{R.IsSuccess?Pa(R.Token):(e.ULS.sendTraceTag(51499467,
306,15,R.ErrorMessage),Pa(m.AFrameworkApplication.fa.Ia("AugloopACLPUserDataSignature")||""));return{}})})});e.ULS.sendTraceTag(51499468,306,50,"Auth requested without a IOAuthManager");return Promise.resolve("")}sendOTelEvent(na){M.a.sendOtelEvent(Object.assign(new Z.a,{otelEvent:na}))}tkd(na){if(na){let Pa=null;na.func&&(Pa=(cb,R,ta,Ra)=>{na.func(cb,R,Ra)});return Object.assign(new D,{name:na.name,inputSchema:na.inputSchema,outputSchema:na.outputSchema,func:Pa})}return null}bVi(){var na=m.AFrameworkApplication.fa.Ia("FlightId");
const Pa=m.AFrameworkApplication.fa.JB("AugLoopFlightKeywordList"),cb=[];if(na&&""!==na&&Pa&&0<Pa.length){na=na.split(";");for(let R=0;R<na.length;R++)for(let ta=0;ta<Pa.length;ta++)-1<na[R].toLowerCase().indexOf(Pa[ta].toLowerCase())&&Array.add(cb,na[R])}return 0<cb.length?cb.join(";"):""}}Object(h.a)(pa,"NewAugLoopRuntimeManager",null,[1018]);var ya=d(57),Ja=d(1185),Ka=d(45);class ma{}Object(h.a)(ma,"Lambda",null,[1061]);var ra=d(889);class Da{constructor(){this.documentOpenType=this.getItemsEndPoint=
this.downloadUrl=null}}Object(h.a)(Da,"PowerPointParameters",null,[]);class va{constructor(){this.initSessionCallback=null}}Object(h.a)(va,"SetInitSessionCallbackParameters",null,[]);class Fa{constructor(){this.sessionDataCallback=this.handler=null}}Object(h.a)(Fa,"SetSessionDataCallbackParameters",null,[]);class ka{constructor(){this.handler=null}}Object(h.a)(ka,"SetSessionInitOverrideCallbackParameters",null,[]);var qa=d(456),Ua=d(511),Ya=d(128);class Va extends Ua.a{constructor(){super();this.H_=
Object.assign(new Ya.a,{T_:Va.getTypeName(),B_:Va.jl()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static jl(){return["AugLoop_Core_Operation"]}}Object(h.a)(Va,"DeleteOperation",Ua.a,[]);var ua=d(673),Ca=d(254);class Ea extends Ca.a{constructor(){super();this.bridgeId=this.cv=this.messageId=null;this.H_=Object.assign(new Ya.a,{T_:Ea.getTypeName(),B_:Ea.jl()})}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static jl(){return[]}}Object(h.a)(Ea,"Message",Ca.a,[]);class wb extends Ea{constructor(){super();
this.protocolVersion=0;this.enableSessionInspectorLogs=this.returnWorkflowInputTypes=this.extensionConfigs=this.authToken=this.origin=this.sessionKey=this.serviceUrl=this.clientMetadata=null;this.H_=Object.assign(new Ya.a,{T_:wb.getTypeName(),B_:wb.jl()})}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static jl(){return["AugLoop_Session_Protocol_Message"]}}Object(h.a)(wb,"SessionInitMessage",Ea,[]);class Oa extends wb{constructor(){super();this.documentOpenType=this.getItemsEndPoint=
this.downloadUrl=null;this.H_=Object.assign(new Ya.a,{T_:Oa.getTypeName(),B_:Oa.jl()})}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static jl(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}}Object(h.a)(Oa,"PowerPointSessionInitMessage",wb,[]);var ab=d(42);class fb{constructor(){this.authToken=this.origin=this.yih=null}}Object(h.a)(fb,"SessionData",null,[]);var db=d(431);class gc{constructor(na,Pa,cb){this.ade=
new H.a;this.jWc=new H.a;this.Ece=new H.a;this.Lzb=this.x2c=this.Zwb=this.kW=null;this.xG=na;this.Ha=Pa;this.Yh=cb;const R=new W.a;R.powerpoint=new Da;if(ab.a("AL.SendSlideTile"))if(ab.a("AL.EnableRehydration"))this.xG.initialize(new W.a),this.xG.setInitSessionCallback(Object.assign(new va,{initSessionCallback:Object(x.a)(this,this.ulk,"onSessionInit")})),this.xG.setSessionInitOverrideCallback(Object.assign(new ka,{handler:Object(x.a)(this,this.vlk,"onSessionInitOverride")})),this.Lzb=this.$Pc(),
this.xG.setAnnotationResultCallback(Object(x.a)(this,this.onAnnotationResult,"onAnnotationResult")),this.e8=Promise.resolve(null);else{na=ya.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;Pa=ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;na=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",Pa,na);Pa=ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").j6a?ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").ULc:
ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var ta=String.format("{0}getitems.ashx",Pa);Pa=new Ja.a(m.AFrameworkApplication.Be);this.e8=db.b(Pa.ajc(na));this.e8.then(Ra=>{try{const nb=JSON.parse(Ra),Cb=nb.downloadUrl;Ka.a.Xa(Cb)?e.ULS.sendTraceTag(51422528,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",nb):(R.powerpoint.downloadUrl=Cb,R.powerpoint.getItemsEndPoint=ta,this.Ha.ZXb&&(R.powerpoint.documentOpenType=this.Eag()))}catch(nb){e.ULS.sendTraceTag(51422529,
306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",nb)}this.xG.initialize(R);this.Lzb=this.$Pc();this.xG.setAnnotationResultCallback(Object(x.a)(this,this.onAnnotationResult,"onAnnotationResult"));return null}).catch(Ra=>{e.ULS.sendTraceTag(51422530,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Ra);this.xG.initialize(R);this.Lzb=this.$Pc();this.xG.setAnnotationResultCallback(Object(x.a)(this,this.onAnnotationResult,"onAnnotationResult"))})}else this.e8=
new Promise(Ra=>{this.xG.initialize(R);this.Lzb=this.$Pc();this.xG.setAnnotationResultCallback(Object(x.a)(this,this.onAnnotationResult,"onAnnotationResult"));Ra("")})}mmb(na){this.e8.then(Pa=>{this.xG.activateAnnotation(Object.assign(new ra.a,{annotationType:na}));return Pa})}jhc(na,Pa){if(na)if(Pa){if(!({value:cb}=this.ade.Nf(na)).returnValue){var cb=new A.a;this.ade.add(na,cb)}cb.contains(Pa)||cb.add(Pa)}else e.ULS.sendTraceTag(51388803,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(51388802,
306,15,"Annotation Type is null or empty")}KHk(na,Pa){if(na)if(Pa){if(!({value:cb}=this.jWc.Nf(na)).returnValue){var cb=new A.a;this.jWc.add(na,cb)}cb.contains(Pa)||cb.add(Pa)}else e.ULS.sendTraceTag(575931363,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(575931362,306,15,"Annotation Type is null or empty")}addEventHandler(na,Pa){this.e8.then(()=>{this.xG.addEventHandler(na,Pa);return null})}removeEventHandler(na,Pa){this.e8.then(()=>{this.xG.removeEventHandler(na,Pa);return null})}registerSimpleLocalWorkflow(na,
Pa){return this.e8.then(()=>this.xG.registerSimpleLocalWorkflow(na,this.ukd(Pa)))}registerSimpleRemoteWorkflow(na,Pa,cb,R){return this.e8.then(()=>this.xG.registerSimpleRemoteWorkflow(na,this.ukd(Pa),this.ukd(cb),this.ukd(R)))}submit(na,Pa){this.e8.then(()=>{this.xG.submit(na,Pa);return null})}submitOperation(na){this.e8.then(()=>{this.xG.submitOperation(na);return null})}Jul(na,Pa,cb,R,ta){this.Lzb&&this.Lzb.then(()=>{this.Yh.augmentImage(na,Pa,cb,!0,this.x2c.yih,this.x2c.origin,this.x2c.authToken,
R,ta);return null})}vlk(na){e.ULS.sendTraceTag(594609494,306,50,"PPTAugLoopRuntimeManager: OnSessionInitOverride");const Pa=Object.assign(new Oa,{protocolVersion:na.protocolVersion,clientMetadata:na.clientMetadata,sessionKey:na.sessionKey,origin:na.origin,authToken:na.authToken,messageId:na.messageId,cv:na.cv});try{this.Ha.ZXb&&(Pa.documentOpenType=this.Eag())}catch(cb){e.ULS.sendTraceTag(578155528,306,10,"PPTWebEditorAugLoopRunTimeManager::OnSessionInitOverride exception:{0}",cb)}this.A_k(na);if(Ka.a.Xa(this.kW)||
Ka.a.Xa(this.Zwb))return e.ULS.sendTraceTag(594609493,306,15,"PPTAugLoopRuntimeManager: Failed to override sessionInitMessage, null or empty downloadUrl obtained"),na;Pa.downloadUrl=this.kW;Pa.getItemsEndPoint=this.Zwb;this.Zwb=this.kW=null;return Pa}ulk(){e.ULS.sendTraceTag(594609492,306,50,"PPTAugLoopRuntimeManager: OnSessionInit");var na=ya.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const Pa=ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;
var cb=ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").j6a?ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").ULc:ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;na=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",Pa,na);const R=String.format("{0}getitems.ashx",cb);cb=new Ja.a(m.AFrameworkApplication.Be);return db.b(cb.ajc(na)).then(ta=>{try{const Ra=JSON.parse(ta),nb=Ra.downloadUrl;Ka.a.Xa(nb)?e.ULS.sendTraceTag(594609491,
306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",Ra):(this.kW=nb,this.Zwb=R)}catch(Ra){e.ULS.sendTraceTag(594609490,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Ra)}return null}).catch(ta=>{e.ULS.sendTraceTag(594609489,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",ta)})}$Pc(){return new Promise(na=>{this.xG.setSessionDataCallback(Object.assign(new Fa,{sessionDataCallback:(Pa,cb,R)=>{this.x2c=
Object.assign(new fb,{yih:Pa,origin:cb,authToken:R});na(null)}}))})}onAnnotationResult(na){if(na&&na.items)if(Ca.a.zNc(na)!==qa.a.getTypeName()&&Ca.a.zNc(na)!==ua.a.getTypeName())this.Ha.uYf&&Ca.a.zNc(na)===Va.getTypeName()&&this.vgk(na);else for(const cb of na.items){if(!cb||!cb.body)continue;const R=Ca.a.zNc(cb.body);if(!R)continue;var Pa=cb.body||{};na.parentPath&&(Pa.parentPath=na.parentPath);let ta=null;if(!({value:ta}=this.ade.Nf(R)).returnValue)e.ULS.sendTraceTag(51388804,306,50,"Cannot find handlers for annotation:{0};",
R);else if(ta)for(let Ra of ta)Ra(Pa);if(this.Ha.uYf){Pa=null;if(({value:Pa}=this.jWc.Nf(R)).returnValue)for(let Ra of Pa)Ra(cb,!1);Ka.a.Xa(cb.id)||this.Ece.$(cb.id,R)}}}vgk(na){for(const Pa of na.items){if(!Pa||!Pa.id)continue;if(!({value:na}=this.Ece.Nf(Pa.id)).returnValue)continue;let cb=null;if(({value:cb}=this.jWc.Nf(na)).returnValue)for(let R of cb)R(Pa,!0);this.Ece.remove(Pa.id)}}ukd(na){return na?Object.assign(new ma,{name:na.name,inputSchema:na.inputSchema,outputSchema:na.outputSchema,func:na.func}):
null}Eag(){try{return this.Ha.rS?0:this.Ha.cSa?2:1}catch(na){return e.ULS.sendTraceTag(578697036,306,50,"PPTWebEditorAugLoopRunTimeManager::GetOpenType :{0};",na),2}}A_k(na){try{Ka.a.Xa(na.clientMetadata.flights)?na.clientMetadata.flights=";":na.clientMetadata.flights+=";",this.Ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)?na.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Treatment;":na.clientMetadata.flights+=
"Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Control;"}catch(Pa){e.ULS.sendTraceTag(559445142,306,50,"PPTWebEditorAugLoopRunTimeManager::SetFlights :{0};",Pa)}}}Object(h.a)(gc,"PPTAugLoopRuntimeManager",null,[1017]);class ob{constructor(na){this.GS=na;this.GS.initialize()}addEventHandler(na,Pa){this.GS.addEventHandler(na,Pa)}removeEventHandler(na,Pa){this.GS.removeEventHandler(na,Pa)}PGe(na,Pa,cb){this.GS.PGe(na,Pa,cb)}Xhc(na,Pa,cb,R,ta,Ra=null){this.GS.Xhc(na,Pa,cb,
R,ta,Ra)}}Object(h.a)(ob,"PPTAugmentationManager",null,[1015]);class Sb{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AugmentationLoop"}Yb(na){this.K=na;this.K.register(ob,"PowerPointWebEditor.AugmentationLoop.PPTAugmentationManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager").ma().na(()=>new ob(new G(m.AFrameworkApplication.Be,na.resolve("Common.IAppSettingsManager"),"PowerPoint_Online")));this.K.register(gc,"PowerPointWebEditor.AugmentationLoop.PPTAugLoopRuntimeManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").ma().na(()=>
{const Pa=r.a.cOj();e.ULS.sendTraceTag(40235107,306,50,"IsWebSocketSupported: {0}",Pa);m.AFrameworkApplication.fa.appSettings.AugLoopUseWebSocket=Pa.toString();return new gc(new pa(na.resolve("Common.ISharedDependencyLoader"),na.Oa("Common.App.OAuth.IOAuthManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"))})}init(){this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager");this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled&&
this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")}dispose(){}static main(){v.a.instance.Ec(new Sb)}}Object(h.a)(Sb,"PPTWebEditorAugmentationLoopPackage",null,[2,3]);var Jb=d(1153),Ab=d(890),lc=d(888),Mc=d(538),Jc=d(62),rb=d(31),cc=d(26);class jb{constructor(na){if(!na)throw Error.argumentNull("Handler for Text Prediction is Null- unable to retrieve initial text prediction signal state");this.t_=na}g1b(na){this.bQe(na)}bQe(na){if(na){try{const ta=na.parentPath;if(!ta||
4>ta.length){cc.a.J(590181647,820,50,"ParentPath is Null or Empty.");return}const Ra=ta[3];var Pa=ta[2];if(!Ra){cc.a.J(590181645,820,50,"Unable to retreive original paragraph text");return}var cb=this.t_.a3i(Ra);this.t_.qLk(Ra);const nb=na.predictions;if(!nb||!nb.length){cc.a.J(590181643,820,50,"Augloop Annotations Null or Empty.");return}const Cb=nb[0];if(!Cb)return;var R=Cb.text;if(!R||!R.length){cc.a.J(590181641,820,50,"Text Predictions Null or Empty.");return}}catch(ta){cc.a.J(590710030,820,10,
"Unable to parse output because of modified output type from Augloop");return}R&&jb.xFi(R,cb,Pa)}else cc.a.J(590181649,820,50,"Annotations returned from service is null.")}static xFi(na,Pa,cb){na&&na.length&&(Pa=jb.Z7i(na,Pa),-1!==Pa&&(Pa=na.substring(Pa,na.length),cb=Object.assign(new lc.a,{text:na,i7:Pa,Uw:cb}),Mc.a.YC.o4=cb,Mc.a.JHd(na,Pa)))}static Z7i(na,Pa){var cb=Jc.a.instance.Pa.kb.We.node;if(!cb||!Pa)return-1;cb=rb.ParagraphReader.text(cb);if(!cb)return-1;if(cb!==Pa)if(cb.length>Pa.length&&
cb.substring(0,Pa.length)===Pa){if(!na.startsWith(cb.substring(Pa.length,cb.length-Pa.length)))return-1;cc.a.J(590181638,820,50,"Ghost Text matches part of the Prediction Text.")}else return-1;return" "===cb.substring(cb.length-1,1)?0:jb.m$f(cb)}static m$f(na){return na?na.length-1-na.lastIndexOf(" "):-1}}Object(h.a)(jb,"TextPredictionAugLoopResponseManager",null,[]);var Xb=d(114),yb=d(425);class mb extends Ua.a{constructor(){super();this.H_=Object.assign(new Ya.a,{T_:mb.getTypeName(),B_:mb.jl()})}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static jl(){return["AugLoop_Core_Operation"]}}
Object(h.a)(mb,"SignalOperation",Ua.a,[]);var Ub=d(1005);class ec{constructor(){}initialize(){return Promise.reject("Text Prediction not yet completed.")}dFf(){}}Object(h.a)(ec,"PredictionAugLoopHandler",null,[1255]);class nc{constructor(){this.Pye=!1}}Object(h.a)(nc,"PredictionSettings",null,[]);class Lb{constructor(na,Pa){this.C2c=null;this.aje={};this.xG=na;this.Rb=Pa;this.Rb.Ezc(Object(x.a)(this,this.fhg,"handleResize"))}a3i(na){return this.aje[na]}n0k(na,Pa){this.aje[na]=Pa}qLk(na){na&&delete this.aje[na]}get settings(){this.C2c||
(this.C2c=Object.assign(new nc,{Pye:!1}));return this.C2c}set settings(na){this.C2c=na}fnl(na){if(this.settings.Pye&&na){var Pa=na.id.toString(),cb=Mc.a.YC.o4,R=Jc.a.instance.Pa.kb;if(R&&1===R.length&&R.We){R=R.We;var ta=R.node;if(rb.ParagraphReader.textLength(ta)===R.Qa){if(cb&&ta&&Pa===cb.Uw&&Pa===ta.id.toString()&&(R=this.VYd(cb,ta))){cb.i7=R;Mc.a.JHd(cb.text,R);return}Mc.a.YC.o4=null;cb=Xb.a.create().toString();R=rb.ParagraphReader.text(na);this.n0k(cb,R);na=["Signal",Ub.a.getTypeName(),Pa,cb];
cb=Lb.V5i(R);Pa=[Object.assign(new yb.a,{id:Pa,body:cb})];var Ra=Object.assign(new mb,{parentPath:na,items:Pa});this.xG.execute(nb=>{nb.submitOperation(Ra);cc.a.J(590181651,820,50,"TextPrediction Signal sent to Augloop Service")})}}}}iEb(){Mc.a.YC.o4=null;Mc.a.QQa()}Omj(na){!na||1<na.length?this.iEb():1>na.length||((na=na[0])&&na.context?(na=na.context,na.Qa===na.Lb&&rb.ParagraphReader.textLength(na.node)===na.Qa||this.iEb()):this.iEb())}VYd(na,Pa){var cb=null;if(na&&Pa){Pa=rb.ParagraphReader.text(Pa);
na=na.text;if(!Pa||!na)return cb;Pa=Pa.replace(RegExp("\\u00a0","g")," ");na=na.replace(RegExp("\\u00a0","g")," ");if(Pa){if(Pa.endsWith(na))return this.iEb(),cb;cb=Lb.U6i(Pa,na);cb=na.substring(cb,na.length)}}return cb}fhg(){Mc.a.QQa()}dispose(){this.Rb.Ccd(Object(x.a)(this,this.fhg,"handleResize"))}static V5i(na){return Object.assign(new Ub.a,{languageId:"en-US",startOfSentence:!0,text:na})}static U6i(na,Pa){for(let cb=Pa.length;0<cb;cb--){const R=Pa.substring(0,cb);if(na.endsWith(R.trimStart()))return R.length}return 0}}
Lb.HRa=!1;Object(h.a)(Lb,"TextPredictionHandler",null,[1214]);var Zc=d(53),Pb=d(28);class eb{constructor(na,Pa){this.ia=na;this.qc=Pa}wb(){this.ia.ya(Pb.a.zwk,Zc.a.application,Object(x.a)(this,this.Cwk,"predictionHandler"))}Cwk(na,Pa,cb){return m.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?1===cb?this.qc.wj()?32:2:8:8}}Object(h.a)(eb,"TextPredictorActor",null,[]);class $a{constructor(){this.Xpe=this.K=null}get name(){return"PowerPointWebEditor.TextPrediction"}Yb(na){this.K=na;na.register(eb,
"PowerPointWebEditor.TextPrediction.TextPredictorActor").ma().na(()=>new eb(na.resolve("Common.IActionManagerExtended"),na.resolve("PowerPointWebEditor.IPresentationReader")));na.register(1214,"PowerPointWebEditor.TextPrediction.ITextPredictionHandler").ma().na(()=>new Lb(na.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),na.resolve("PowerPointWebEditor.Core.IPPTAppFrame")))}init(){this.K.resolve("PowerPointWebEditor.TextPrediction.TextPredictorActor").wb();this.Xpe=new Jb.a(()=>
new jb(this.K.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(na=>{na.mmb(Ab.a.getTypeName());na.jhc(Ab.a.getTypeName(),Object(x.a)(this.Xpe.value,this.Xpe.value.g1b,"handleResponse"))})}dispose(){}static main(){v.a.instance.Ec(new $a)}}Object(h.a)($a,"TextPredictionPackage",null,[2,3]);var vb=d(267),bc=d(27);class Cc{}Object(h.a)(Cc,"AugContextId",null,[]);class Gc{}Object(h.a)(Gc,"AugParagraph",
null,[]);class sd{}Object(h.a)(sd,"AugShape",null,[]);class Sd{}Object(h.a)(Sd,"ShapeTextTile",null,[]);class ie{constructor(na,Pa,cb,R){this.Fa=cb;this.Zh=R;this.Ib=na;this.um=Pa}nWb(na,Pa){return na&&na.isConnected&&this.Fa.rsa(na)?(na=Object(E.a)(4,na))?Object.assign(new Sd,{Topic:"ShapeText",ContextId:u.c(ie.Wqi(na,Pa)),Data:u.c(this.Xqi(na))}):null:null}OVb(na){return na&&na.get_shapeId()&&na.hasText&&!na.jp?na.M7d:!1}Xqi(na){const Pa=[];na=this.Ib.Jc(na);for(na=this.um.A6(na,na.currentNode);na.moveNext();){var cb=
na.currentNode;const R=cb;this.Zh.Pd(R)&&(cb=Object.assign(new Gc,{t:this.Zh.text(R),l:this.Zh.cdb(cb)}),Array.add(Pa,cb))}return Object.assign(new sd,{p:Pa,c:vb.a.re(m.AFrameworkApplication.lcid).crb})}static Wqi(na,Pa){return Object.assign(new Cc,{gid:na.id,sid:na.slideSid,cid:na.slideCid,shapeId:na.get_shapeId(),rid:(na.IUc||na.DDa||bc.App.Bm).toString(),t:Pa,c:(new Date).getTime()})}}Object(h.a)(ie,"ShapeTextTileManager",null,[1210,1240]);var De=d(105),yd=d(1175),ib=d(197),dc=d(79),Bc;(function(na){na[na.none=
0]="none";na[na.onParagraphPropertyChanged=1]="onParagraphPropertyChanged";na[na.onSelectionFinished=2]="onSelectionFinished";na[na.onActiveSlideDomReady=4]="onActiveSlideDomReady";na[na.onShapeChildTopologyChanged=8]="onShapeChildTopologyChanged";na[na.onParagraphDisconnect=16]="onParagraphDisconnect";na[na.onNumberListPropertyChanged=32]="onNumberListPropertyChanged";na[na.onNumberListDisconnect=64]="onNumberListDisconnect";na[na.onSlideConnected=128]="onSlideConnected";na[na.onSlideDisconnected=
256]="onSlideDisconnected"})(Bc||(Bc={}));Object(h.b)("EventNames",Bc);class Ob{constructor(){this.KYa=this.graphNode=null;this.gSa=0;this.mPe=null}}Object(h.a)(Ob,"TileGraphNode",null,[]);class yc{constructor(){this.Sgh=this.aGe=this.g2d=this.Gfg=0}}Object(h.a)(yc,"TileTelemetry",null,[]);var fc;(function(na){na[na.unknown=0]="unknown";na[na.activeSlideChanged=1]="activeSlideChanged";na[na.shapeSelected=2]="shapeSelected";na[na.listLevelChanged=3]="listLevelChanged";na[na.richEditTextUnicodeChanged=
4]="richEditTextUnicodeChanged";na[na.shapeChildTopologyChanged=5]="shapeChildTopologyChanged";na[na.paragraphDeleted=6]="paragraphDeleted";na[na.numberListDeleted=7]="numberListDeleted";na[na.numberListPropertyChanged=8]="numberListPropertyChanged";na[na.slideAdded=9]="slideAdded";na[na.slideDeleted=10]="slideDeleted"})(fc||(fc={}));Object(h.b)("TriggerName",fc);var Nb=d(420);class lb{constructor(na,Pa,cb,R){this.Bb=Pa;this.xZj=cb;this.n7j=na;this.Zpe={};this.c7b={};this.Rb=R}initialize(){this.Ox()}dispose(){this.ina()}onParagraphPropertyChanged(na,
Pa){this.Qqa(Pa,1)}$Bb(na,Pa){this.Qqa(Pa,2)}onActiveSlideDomReady(na,Pa){this.Qqa(Pa,4)}onShapeChildTopologyChanged(na,Pa){this.Qqa(Pa,8)}AGa(na,Pa){this.Qqa(Pa,16)}a0g(na,Pa){na=new Nb.a(!1,null,Pa.Ca);this.Qqa(na,4)}get Vx(){return this.n7j}get SY(){return this.Zpe}get tha(){return this.c7b}Qqa(na,Pa){try{if(2===this.Rb.mode&&Object(yd.a)(Bc,Pa)in this.Zpe){var cb=Date.now();Object(E.a)(1253,this.Zpe[Object(yd.a)(Bc,Pa)]).k2(na,(R,ta)=>{this.ygk(R,ta,cb)})}}catch(R){cc.a.J(36495880,306,10,"Exception thrown at DetectTiles: "+
R)}}ygk(na,Pa,cb){if(!ib.a.Xa(na))try{for(const R of na){if(!De.a.count(this.c7b)){const nb=new dc.a(3,1,this.xZj,Object(x.a)(this,this.fireTileEvents,"fireTileEvents"),90,"24");this.Bb.Hb(nb)}let ta;if(R.id.toString()in this.c7b)ta=Object(E.a)(Ob,this.c7b[R.id.toString()]),ta.gSa=Pa;else{const nb=new yc;ta=Object.assign(new Ob,{graphNode:R,gSa:Pa,KYa:{},mPe:nb});this.c7b[R.id.toString()]=ta;this.Bek(nb,cb)}const Ra=fc[Pa];ta.KYa[Ra]=(Ra in ta.KYa?ta.KYa[Ra]:0)+1}}catch(R){cc.a.J(36495882,306,10,
"Exception thrown at FireTiles: "+R)}}Bek(na,Pa){na&&(na.Gfg=Pa,na.g2d=Date.now())}sVg(na,Pa){na&&(na.aGe=Pa,na.Sgh=Date.now())}b5f(na){return na?String.format("GraphDetectDuration: {0}, QueueDuration: {1}, ScanGraphSpaceDuration: {2}",na.g2d-na.Gfg,na.aGe-na.g2d,na.Sgh-na.aGe):""}}Object(h.a)(lb,"TileTriggerControllerBase",null,[1254,109]);class Qc extends lb{constructor(na,Pa,cb,R,ta,Ra,nb,Cb,mc,Sc,jd,Ad,ve){super(nb&31,Cb,Sc,Ad);this.ZS=na.Cd(12);this.kL=na.Cd(10);this.sa=Pa;this.zd=cb;this.GS=
R;this.Tca=ta;this.gT=Ra;this.ua=mc;this.lT=jd;this.L7j=ve}Ox(){1===(this.Vx&1)&&(this.ZS.yk(Object(x.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.SY[Object(yd.a)(Bc,1)]=this.lT.Ryi());2===(this.Vx&2)&&(this.sa.VJ(Object(x.a)(this,this.$Bb,"onProcessSetSelectionFinished")),this.SY[Object(yd.a)(Bc,2)]=this.lT.Syi());4===(this.Vx&4)&&(this.zd.DR(Object(x.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.SY[Object(yd.a)(Bc,4)]=this.lT.Pyi());8===(this.Vx&
8)&&(this.kL.ZF(Object(x.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.SY[Object(yd.a)(Bc,8)]=this.lT.Tyi());16===(this.Vx&16)&&(this.ZS.Cza(Object(x.a)(this,this.AGa,"onBeforeParagraphDisconnect")),this.SY[Object(yd.a)(Bc,16)]=this.lT.Qyi())}ina(){this.ZS.Pm(Object(x.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.sa.yHa(Object(x.a)(this,this.$Bb,"onProcessSetSelectionFinished"));this.zd.lma(Object(x.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));
this.kL.kO(Object(x.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"));this.ZS.wHa(Object(x.a)(this,this.AGa,"onBeforeParagraphDisconnect"))}fireTileEvents(){try{if(this.ua&&this.ua.Ca){var na=this.ua.Ca.km();for(const Pa of na){const cb=Pa.id.toString();cb in this.tha&&(this.WYb(Object(E.a)(Ob,this.tha[cb])),delete this.tha[cb])}De.a.forEach(this.tha,Pa=>{delete this.tha[Pa]},null)}}catch(Pa){cc.a.J(36525510,306,10,"Exception thrown at FireTileEvents: "+Pa)}}WYb(na){if(na){var Pa=
Date.now(),cb=this.gT.nWb(na.graphNode,fc[na.gSa]);if(cb){this.L7j?this.Tca.execute(ta=>{ta.submit("ShapeTextTile",cb)}):this.GS.execute(ta=>{ta.PGe(cb.Topic,cb.Data,cb.ContextId)});const R=na.mPe;this.sVg(R,Pa);cc.a.J(26007383,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, {2}",fc[na.gSa],na.KYa,this.b5f(R))}}}}Object(h.a)(Qc,"ShapeTextTileTriggerController",lb,[]);var Rc=d(22),ld=d(75),Dd=d(36),gd=d(93),be=d(81),od=d(166),$d=d(37);class xf{constructor(){this.lcid=this.end=this.start=
0;this.noProof=!1}}Object(h.a)(xf,"TextSpan",null,[]);class Na{}Object(h.a)(Na,"AugCharFormat",null,[]);class xb{}Object(h.a)(xb,"AugCharFormatRun",null,[]);class sc{}Object(h.a)(sc,"AugDrawingElement",null,[]);class cd{}Object(h.a)(cd,"AugDrawingElementMoniker",null,[]);class Ta{}Object(h.a)(Ta,"AugPara",null,[]);class Hb{}Object(h.a)(Hb,"AugParaFormat",null,[]);class oc{}Object(h.a)(oc,"AugParaFormatRun",null,[]);class Oc{}Object(h.a)(Oc,"AugSlide",null,[]);class Yc{}Object(h.a)(Yc,"AugSlideMoniker",
null,[]);class Qd{}Object(h.a)(Qd,"AugText",null,[]);class ce{}Object(h.a)(ce,"AugTextTile",null,[]);class id{constructor(na,Pa,cb,R,ta,Ra,nb,Cb,mc,Sc,jd,Ad){this.Zh=na;this.fk=Pa;this.Lne=cb;this.Ib=R;this.VN=ta;this.wc=Ra;this.um=nb;this.h$b=jd;this.Z_c=Cb;this.i$b=mc;this.Jz=Sc;this.V3j=Ad}nWb(na){if(!na||!na.isConnected)return null;var Pa=Object(E.a)(132,na);if(!Pa)return null;let cb=na=0;Pa=({U8c:na,rGc:cb}=this.kzi(Pa)).returnValue;if(!Pa)return null;Pa=Object.assign(new ce,{Id:Xb.a.create().toString(),
Content:u.c(Pa)});cc.a.J(37091038,306,50,"TileId: {0}; ParaCount: {1}; DirtyParaCount: {2};",Pa.Id,na,cb);return Pa}kzi(na){let Pa=0,cb=0;const R=[];var ta=na?na.km():[];for(Ra of ta)if(!this.fk.Tia(Ra)||this.h$b)if(Ra.rd){if(ta=this.wc.ZM(Ra))ta=this.Ib.Jc(ta),this.VN.AJc(ta,nb=>{(nb=Object(E.a)(123,nb.currentNode))&&!nb.isGhostCell&&({U8c:Pa,rGc:cb}=this.U4f(nb,Pa,cb,R));return!0})}else({U8c:Pa,rGc:cb}=this.U4f(Ra,Pa,cb,R));var Ra=Pa;ta=cb;return{returnValue:Object.assign(new Oc,{id:na.id.toString(),
mk:Object.assign(new Yc,{sId:na.sid,cId:na.cid}),drawingElems:R,isSlideCritiqueReady:na.isSlideCritiqueReady}),U8c:Ra,rGc:ta}}U4f(na,Pa,cb,R){const ta=[];let Ra=0;var nb=this.Ib.Jc(na);for(nb=this.um.A6(nb,nb.currentNode);nb.moveNext();){var Cb=nb.currentNode;Cb&&this.Zh.Pd(Cb)&&Cb.Sa(Dd.a.Vp)&&(Cb=this.aUi(Cb))&&(Cb.pfRuns&&0<Cb.pfRuns.length&&Cb.pfRuns[0].pf.proofingDirty&&Ra++,Array.add(ta,Cb))}0<ta.length&&(Pa+=ta.length,cb+=Ra,na=Object.assign(new sc,{id:na.id.toString(),mk:this.ZTi(na),text:Object.assign(new Qd,
{paragraphs:ta})}),Array.add(R,na));return{U8c:Pa,rGc:cb}}ZTi(na){if(!na)return null;var Pa="";let cb=0,R=0;if(Object(Rc.a)(123,na))Pa=Object(E.a)(123,na),R=3,Pa=Pa.cellId.toString();else if(Object(Rc.a)(4,na))if(na=Object(E.a)(4,na),Pa=na.get_shapeId().toString(),cb=na.get_cid(),na.bja)R=1;else if(na.fg)R=2;else if(na.xx||na.ll)R=4;return Object.assign(new cd,{id:Pa,cId:cb,type:R})}aUi(na){if(!na)return null;na=Object(E.a)(ld.AParagraphNode,na);if(!na)return null;var Pa=na.ta($d.a.vS,!1);Pa=Object.assign(new Ta,
{id:na.id.toString(),chars:Pa?"":this.Zh.text(na)});const cb=this.$Ti(na);cb&&0<cb.length&&(Pa.pfRuns=cb);(na=this.YTi(na))&&0<na.length&&(Pa.cfRuns=na);return Pa}$Ti(na){const Pa=[],cb=Object(E.a)(be.a,this.i$b.aMc(na));let R=16,ta="",Ra=0,nb=0;if(cb&&this.V3j){const Cb=this.Jz.l6a(cb);if(Cb)if(R=Cb.listType,1===R)ta=this.Z_c.Pvb(cb);else if(0===R){Ra=cb.ta($d.a.autonumberBulletType,8);const mc=Object(E.a)(1241,this.Z_c);mc&&(nb=mc.e4i(Cb,cb))}}na=Object.assign(new oc,{pf:Object.assign(new Hb,{lvl:this.Zh.cdb(na),
proofingDirty:!na.ta(od.a.$ba,!1),revisionId:na.ta(od.a.OUc,0).toString(),listType:R,listTag:ta,listNumeration:Ra,listElementIndex:nb})});Array.add(Pa,na);return Pa}YTi(na){const Pa=[];let cb=this.I3i(na);if(0<cb.count){cb=this.nbi(this.Lne.gLc(na),cb);for(let R of cb)na=R.end-R.start,Array.add(Pa,Object.assign(new xb,{len:na,cf:Object.assign(new Na,{lang:R.lcid,noProof:R.noProof})}))}return Pa}I3i(na){const Pa=new A.a,cb=na.characterData;let R=-1,ta=-1,Ra=0;for(let nb=0;nb<na.Ra.length;nb++){const Cb=
na.Ra.ga(nb).formatting;Cb&&(ta=gd.a.language(Cb),-1!==R&&R!==ta&&(Pa.add(Object.assign(new xf,{start:Ra,end:na.Ra.ga(nb).cp,lcid:R,noProof:!1})),Ra=na.Ra.ga(nb).cp),R=ta)}Pa.add(Object.assign(new xf,{start:Ra,end:cb.length,lcid:ta,noProof:!1}));return Pa}nbi(na,Pa){if(!na)return Pa;for(const cb of na){na=!1;for(let R=0;R<Pa.count;R++){if(!na)if(Pa.ga(R).start===cb.begin)na=!0,Pa.ga(R).noProof=!0;else if(cb.begin>Pa.ga(R).start&&cb.begin<Pa.ga(R).end){Pa.insert(R+1,Object.assign(new xf,{start:cb.begin,
end:Pa.ga(R).end,lcid:Pa.ga(R).lcid,noProof:!0}));na=!0;Pa.ga(R).end=cb.begin;continue}if(na)if(cb.end>Pa.ga(R).end)Pa.ga(R).noProof=!0;else{if(cb.end===Pa.ga(R).end){Pa.ga(R).noProof=!0;break}if(cb.end<Pa.ga(R).end){Pa.insert(R+1,Object.assign(new xf,{start:cb.end,end:Pa.ga(R).end,lcid:Pa.ga(R).lcid,noProof:!1}));Pa.ga(R).end=cb.end;Pa.ga(R).noProof=!0;break}}}}return Pa}}Object(h.a)(id,"SlideTextTileManager",null,[1211,1240]);var gb=d(428);class pc extends lb{constructor(na,Pa,cb,R,ta,Ra,nb,Cb,
mc,Sc,jd){super(Pa&125,cb,R,jd);this.zd=na;this.lT=ta;this.j6j=Ra;this.ZS=nb.Cd(12);this.kL=nb.Cd(10);this.Tca=Cb;this.ua=mc;this.uPg=Sc;this.D0c=nb.Cd(22)}Ox(){4===(this.Vx&4)&&(this.zd.DR(Object(x.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.uPg.F4h(Object(x.a)(this,this.a0g,"onTilingModuleLoaded")),this.SY[Object(yd.a)(Bc,4)]=this.lT.ezi());16===(this.Vx&16)&&(this.ZS.Cza(Object(x.a)(this,this.AGa,"onBeforeParagraphDisconnect")),this.SY[Object(yd.a)(Bc,16)]=this.lT.hzi());
1===(this.Vx&1)&&(this.ZS.yk(Object(x.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.SY[Object(yd.a)(Bc,1)]=this.lT.izi());8===(this.Vx&8)&&(this.kL.ZF(Object(x.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.SY[Object(yd.a)(Bc,8)]=this.lT.jzi());64===(this.Vx&64)&&(this.D0c.Cza(Object(x.a)(this,this.PVg,"onBeforeNumberListDicsonnect")),this.SY[Object(yd.a)(Bc,64)]=this.lT.fzi());32===(this.Vx&32)&&(this.D0c.yk(Object(x.a)(this,this.onNumberListPropertyChanged,
"onNumberListPropertyChanged")),this.SY[Object(yd.a)(Bc,32)]=this.lT.gzi())}ina(){this.zd.lma(Object(x.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.ZS.Pm(Object(x.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.ZS.wHa(Object(x.a)(this,this.AGa,"onBeforeParagraphDisconnect"));this.uPg.yOk(Object(x.a)(this,this.a0g,"onTilingModuleLoaded"));this.D0c.wHa(Object(x.a)(this,this.PVg,"onBeforeNumberListDicsonnect"));this.D0c.Pm(Object(x.a)(this,this.onNumberListPropertyChanged,
"onNumberListPropertyChanged"))}PVg(na,Pa){this.Qqa(Pa,64)}onNumberListPropertyChanged(na,Pa){this.Qqa(Pa,32)}fireTileEvents(){try{De.a.forEach(this.tha,na=>{this.WYb(Object(E.a)(Ob,this.tha[na]));delete this.tha[na]},null)}catch(na){cc.a.J(36525513,306,10,"Exception thrown at FireTileEvents: "+na)}}WYb(na){if(na&&this.ua.Ca&&na.graphNode&&this.ua.Ca.id===na.graphNode.id){var Pa=Date.now(),cb=this.j6j.nWb(na.graphNode,fc[na.gSa]);if(cb){this.Tca.execute(ta=>{ta.submit(gb.a.Hkc,cb)});const R=na.mPe;
this.sVg(R,Pa);cc.a.J(36525515,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, TileSize: {2}, TileId: {3}, {4}",fc[na.gSa],na.KYa,u.c(cb).length,cb.Id,this.b5f(R))}}}}Object(h.a)(pc,"SlideTextTileTriggerController",lb,[]);class zc extends Ca.a{constructor(){super();this.shapeType=this.textTiles=null;this.H_=Object.assign(new Ya.a,{T_:zc.getTypeName(),B_:zc.jl()})}static getTypeName(){return"AugLoop_Powerpoint_PowerPointShape"}static jl(){return[]}}Object(h.a)(zc,"PowerPointShape",Ca.a,
[]);class Ic extends Ca.a{constructor(){super();this.cid=this.sid=this.themeId=this.isSlideHidden=this.shapes=null;this.H_=Object.assign(new Ya.a,{T_:Ic.getTypeName(),B_:Ic.jl()})}static getTypeName(){return"AugLoop_Powerpoint_PowerPointSlide"}static jl(){return[]}}Object(h.a)(Ic,"PowerPointSlide",Ca.a,[]);class Fc extends Ca.a{constructor(){super();this.content=null;this.H_=Object.assign(new Ya.a,{T_:Fc.getTypeName(),B_:Fc.jl()})}static getTypeName(){return"AugLoop_Text_TextTile"}static jl(){return[]}}
Object(h.a)(Fc,"TextTile",Ca.a,[]);class rd extends Fc{constructor(){super();this.isColdIp=this.ipPosition=this.queryRange=this.fontKerning=this.specialIndentBy=this.specialIndentType=this.bulletAndNumberFontFamily=this.bulletAndNumberFontSize=this.listId=this.rightIndentation=this.lineSpacing=this.spacingAfterParagraph=this.spacingBeforeParagraph=this.objectReferences=this.isInsideTOC=this.isInsideTable=this.formattedRanges=this.alignment=this.listType=this.outlineLevel=this.indentation=null;this.H_=
Object.assign(new Ya.a,{T_:rd.getTypeName(),B_:rd.jl()})}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static jl(){return["AugLoop_Text_TextTile"]}}Object(h.a)(rd,"FormattedTextTile",Fc,[]);class Yd{constructor(na,Pa,cb,R,ta,Ra){this.Ib=na;this.um=Pa;this.Zh=R;this.Ha=cb;this.g7j=ta;this.qc=Ra}nWb(na){if(!na||!na.isConnected)return null;na=Object(E.a)(132,na);if(!na)return null;let Pa=null;const cb=new A.a;var R=na.km();for(var ta of R)(R=this.c5f(ta,!1))&&cb.add(R);(ta=na.TPa())&&ta.isConnected&&
(ta=this.c5f(ta,!0))&&cb.add(ta);if(0<cb.count&&(Pa=Object.assign(new Ic,{shapes:cb.toArray()}),this.Ha.ZXb)){Pa.isSlideHidden=na.zn;Pa.themeId=this.z0b(na);try{Pa.cid=na.cid.toString(),Pa.sid=na.sid.toString()}catch(Ra){cc.a.J(575494306,822,50,"Exception message: "+Ra.message)}}return Pa}c5f(na,Pa){if(!na)return null;var cb=this.Ib.Jc(na);cb=this.um.A6(cb,cb.currentNode);let R=null;const ta=new A.a;for(;cb.moveNext();){var Ra=cb.currentNode;if(Ra&&this.Zh.Pd(Ra)){Ra=Object(E.a)(ld.AParagraphNode,
Ra);var nb=this.Zh.text(Ra);nb&&(nb=Object.assign(new rd,{content:nb}),this.Ha.ZXb&&this.g7j.Ktk(nb,Ra),ta.add(nb))}}0<ta.count&&(R=Object.assign(new zc,{textTiles:ta.toArray()}));this.Ha.ZXb&&R&&(R.shapeType=this.AOi(na,Pa));return R}AOi(na,Pa){if(Pa)return 3;if(!na)return 9;switch(na.zj){case 0:case 2:return 0;case 3:return 1;case 10:return 7;case 15:return 5;case 9:case 12:return 8;case 8:return this.Baj(na)}return 9}Baj(na){return na?0<na.L0d().length?4:na.Zba?9:na.xx?6:2:9}z0b(na){if(!na)return"";
na=na.vj;let Pa=null;const cb=this.qc.QH();if(cb&&0<cb.length&&na)for(const R of cb)if(R.Id===na){Pa=R;break}return Pa&&Pa.ThemeFamilyId?Pa.ThemeFamilyId:""}}Object(h.a)(Yd,"SlideTileManager",null,[1240]);class me extends lb{constructor(na,Pa,cb,R,ta,Ra,nb,Cb,mc){super(Pa&401,cb,R,Cb);this.S2c=na.Cd(8);this.ZS=na.Cd(12);this.lT=ta;this.k6j=Ra;this.Tca=nb;this.Ha=mc}Ox(){16===(this.Vx&16)&&(this.ZS.Cza(Object(x.a)(this,this.AGa,"onBeforeParagraphDisconnect")),this.SY[Object(yd.a)(Bc,16)]=this.lT.czi());
1===(this.Vx&1)&&(this.ZS.yk(Object(x.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.SY[Object(yd.a)(Bc,1)]=this.lT.dzi());128===(this.Vx&128)&&(this.S2c.yga(Object(x.a)(this,this.onSlideConnected,"onSlideConnected")),this.SY[Object(yd.a)(Bc,128)]=this.lT.azi());256===(this.Vx&256)&&(this.S2c.l6(Object(x.a)(this,this.onSlideDisconnected,"onSlideDisconnected")),this.SY[Object(yd.a)(Bc,256)]=this.lT.bzi())}ina(){this.ZS.Pm(Object(x.a)(this,this.onParagraphPropertyChanged,
"onParagraphPropertyChanged"));this.ZS.wHa(Object(x.a)(this,this.AGa,"onBeforeParagraphDisconnect"));this.S2c.mma(Object(x.a)(this,this.onSlideConnected,"onSlideConnected"));this.S2c.xHa(Object(x.a)(this,this.onSlideDisconnected,"onSlideDisconnected"))}onSlideConnected(na,Pa){this.Qqa(Pa,128)}onSlideDisconnected(na,Pa){this.Qqa(Pa,256)}fireTileEvents(){try{De.a.forEach(this.tha,na=>{this.WYb(Object(E.a)(Ob,this.tha[na]));delete this.tha[na]},null)}catch(na){cc.a.J(51380318,306,10,"Exception thrown at FireTileEvents: "+
na)}}WYb(na){if(na&&na.graphNode){var Pa=this.k6j.nWb(na.graphNode,fc[na.gSa]),cb=null,R=Object(E.a)(132,na.graphNode);if(R&&!R.zK&&!R.hvb){var ta=ab.a("AL.SlideTileIdOriginalFormat")?R.sid.toString()+R.cid.toString():R.sid.toString()+"#"+R.cid.toString();R=["session","doc"];Pa=[Object.assign(new yb.a,{id:ta,body:Pa})];10===na.gSa?"slideAdded"in na.KYa||(cb=Object.assign(new Va,{parentPath:R,items:Pa})):cb="slideAdded"in na.KYa?Object.assign(new qa.a,{parentPath:R,items:Pa}):Object.assign(new ua.a,
{parentPath:R,items:Pa});cb&&this.Tca.execute(Ra=>{Ra.submitOperation(cb)})}}}}Object(h.a)(me,"SlideTileTriggerController",lb,[]);var Db=d(1162),af=d(30);class bg{constructor(na,Pa){this.Jz=na;this.C8=Pa}Ktk(na,Pa){try{na.listType=this.bsb(Pa),na.outlineLevel=rb.ParagraphReader.vMc(Pa),na.indentation=bg.T3i(this.C8.d7(Pa))}catch(cb){cc.a.J(587313229,822,50,"Exception message: "+cb.message)}}bsb(na){const Pa=new af.GraphIterator;Pa.set(na);Pa.oc(11);Pa.Og(11);return(na=this.Jz.rx(Pa))?bg.Psi(na.listType):
6}static Psi(na){switch(na){case 15:return 5;case 1:return 1;case 42:return 7;case 13:return 3;case 14:return 4;case 16:return 6;case 0:return 2;default:return 7}}static T3i(na){return 2===na.Of?Math.floor(Db.a.zLf(na.value)/20):Math.floor(na.value/20)}}Object(h.a)(bg,"TextTileFormatter",null,[1212]);var Qe=d(78);class Af{constructor(){this.nPe="TML";this.va=new Qe.a}F4h(na){this.va.addHandler(this.nPe,na)}yOk(na){this.va.removeHandler(this.nPe,na)}gEk(na){this.va.raiseEvent(this.nPe,na)}}Object(h.a)(Af,
"TilingEventSource",null,[1237,1238,1239]);class tf{}tf.i5k="ShapeTextOnActiveSlideDomReady";tf.l5k="ShapeTextOnSelectionFinished";tf.k5k="ShapeTextOnParagraphPropertyChanged";tf.m5k="ShapeTextOnShapeChildTopologyChanged";tf.j5k="ShapeTextOnParagraphDisconnect";tf.Qbl="SlideTextOnActiveSlideDomReady";tf.Ubl="SlideTextOnParagraphPropertyChanged";tf.Tbl="SlideTextOnParagraphDisconnect";tf.Vbl="SlideTextOnShapeChildTopologyChanged";tf.Sbl="SlideTextOnNumberListPropertyChanged";tf.Rbl="SlideTextOnNumberListDisconnect";
tf.Nbl="SlideOnParagraphPropertyChanged";tf.Mbl="SlideOnParagraphDisconnect";tf.Kbl="SlideOnConnect";tf.Lbl="SlideOnDisconnect";Object(h.a)(tf,"DetectStrategyName",null,[]);class uf{constructor(na){this.gT=na}get Vx(){return 4}k2(na,Pa){const cb=[];if((na=Object(E.a)(Nb.a,na))&&na.Ca&&(na=Object(E.a)(132,na.Ca))){na=na.km();for(const R of na)this.gT.OVb(R)&&Array.add(cb,R);0<cb.length&&Pa(cb,1)}}}Object(h.a)(uf,"ShapeTextOnActiveSlideDomReadyDetectStrategy",null,[1253]);var kg=d(250);class Lg{constructor(na,
Pa,cb){this.Fa=na;this.gT=Pa;this.sa=cb}get Vx(){return 16}k2(na,Pa){if((na=Object(E.a)(kg.a,na))&&na.node&&12===na.node.type&&(na=this.Fa.$m(na.node))&&this.gT.OVb(na)){var cb=this.sa.dZ();cb&&cb.id===na.id&&(cb=[],Array.add(cb,na),Pa(cb,6))}}}Object(h.a)(Lg,"ShapeTextOnParagraphDisconnectDetectStrategy",null,[1253]);var $g=d(39),yf=d(343);class Kf{constructor(na,Pa,cb){this.Fa=na;this.gT=Pa;this.sa=cb}get Vx(){return 1}k2(na,Pa){if((na=Object(E.a)(yf.a,na))&&na.node&&12===na.node.type){const R=
this.Fa.$m(na.node);if(R&&this.gT.OVb(R)){var cb=this.sa.dZ();cb&&cb.id===R.id&&(na.property===$g.a.listLevel?this.Mpb(3,R,Pa):na.property===Dd.a.Vp&&this.Mpb(4,R,Pa))}}}Mpb(na,Pa,cb){if(Pa){var R=[];Array.add(R,Pa);cb(R,na)}}}Object(h.a)(Kf,"ShapeTextOnParagraphPropertyChangedDetectStrategy",null,[1253]);var dd=d(823);class lg{constructor(na,Pa,cb,R){this.sa=na;this.gT=Pa;this.t_=cb;this.Dac=R}get Vx(){return 2}k2(na,Pa){const cb=[];if(na=Object(E.a)(dd.a,na))if(this.Dac&&this.t_&&this.t_.Omj(na.vF),
!this.sa.D2())this.Dac&&this.t_&&this.t_.iEb();else if(na.KD&&na.KD.length){this.Dac&&this.t_&&this.t_.iEb();na=this.sa.he();for(const R of na)this.gT.OVb(R)&&Array.add(cb,R);0<cb.length&&Pa(cb,2)}}}Object(h.a)(lg,"ShapeTextOnSelectionFinishedDetectStrategy",null,[1253]);var Wh=d(574);class Gd{constructor(na,Pa){this.sa=na;this.gT=Pa}get Vx(){return 8}k2(na,Pa){const cb=[];if((na=Object(E.a)(Wh.a,na))&&na.node&&10===na.node.type&&1===na.GY&&(na=Object(E.a)(4,na.node))&&this.gT.OVb(na)){var R=this.sa.dZ();
R&&R.get_shapeId()===na.get_shapeId()&&(Array.add(cb,na),Pa(cb,5))}}}Object(h.a)(Gd,"ShapeTextOnShapeChildTopologyChangedDetectStrategy",null,[1253]);class Se{constructor(na){this.gBg=na}get Vx(){return 1===this.gBg?128:256}k2(na,Pa){if((na=Object(E.a)(kg.a,na))&&na.node&&8===na.node.type){const cb=[];Array.add(cb,na.node);1===this.gBg?Pa(cb,9):Pa(cb,10)}}}Object(h.a)(Se,"SlideOnConnectOrDisconnectDetectStrategy",null,[1253]);class hj{constructor(na){this.uc=na}get Vx(){return 16}k2(na,Pa){if((na=
Object(E.a)(kg.a,na))&&na.node&&12===na.node.type){const cb=this.uc.Sg(na.node);cb&&(na=[],Array.add(na,cb),Pa(na,6))}}}Object(h.a)(hj,"SlideOnParagraphDisconnectDetectStrategy",null,[1253]);class cg{constructor(na){this.uc=na}get Vx(){return 1}k2(na,Pa){var cb=Object(E.a)(yf.a,na);if(cb&&cb.node&&12===cb.node.type){const R=this.uc.Sg(cb.node);R&&Object(E.a)(ld.AParagraphNode,cb.node)&&(na=0,cb.property===$g.a.listLevel?na=3:cb.property===Dd.a.Vp&&(na=4),cb=[],Array.add(cb,R),Pa(cb,na))}}}Object(h.a)(cg,
"SlideOnParagraphPropertyChangedDetectStrategy",null,[1253]);class ed{get Vx(){return 4}k2(na,Pa){if((na=Object(E.a)(Nb.a,na))&&na.Ca&&(na=Object(E.a)(132,na.Ca))){var cb=na.km();for(var R of cb)if(R.hasText){R=[];Array.add(R,na);Pa(R,1);break}}}}Object(h.a)(ed,"SlideTextOnActiveSlideDomReadyDetectStrategy",null,[1253]);class Xg{constructor(na,Pa){this.uc=na;this.ua=Pa}get Vx(){return 64}k2(na,Pa){if((na=Object(E.a)(kg.a,na))&&this.ua.Ca&&na.node&&22===na.node.type&&(na=this.uc.Sg(na.node))&&na.id===
this.ua.Ca.id){const cb=[];Array.add(cb,na);Pa(cb,7)}}}Object(h.a)(Xg,"SlideTextOnNumberListDisconnectDetectStrategy",null,[1253]);class Dh{constructor(na,Pa){this.uc=na;this.ua=Pa}get Vx(){return 32}k2(na,Pa){var cb=Object(E.a)(yf.a,na);cb&&cb.node&&22===cb.node.type&&(na=this.uc.Sg(cb.node))&&this.ua.Ca&&na.id===this.ua.Ca.id&&cb.property===Dd.a.fm&&(cb=[],Array.add(cb,na),Pa(cb,8))}}Object(h.a)(Dh,"SlideTextOnNumberListPropertyChangedDetectStrategy",null,[1253]);class Qf{constructor(na,Pa,cb,R){this.ua=
na;this.fk=Pa;this.uc=cb;this.h$b=R}get Vx(){return 16}k2(na,Pa){if((na=Object(E.a)(kg.a,na))&&na.node&&this.ua.Ca&&12===na.node.type){const cb=this.uc.Sg(na.node);!cb||cb.id!==this.ua.Ca.id||this.fk.Fia(na.node)&&!this.h$b||(na=[],Array.add(na,this.ua.Ca),Pa(na,6))}}}Object(h.a)(Qf,"SlideTextOnParagraphDisconnectDetectStrategy",null,[1253]);class Yb{constructor(na,Pa,cb,R,ta,Ra,nb,Cb){this.ua=na;this.fk=Pa;this.uc=cb;this.Fa=R;this.h$b=ta;this.Tca=Ra;this.t_=nb;this.Dac=Cb}get Vx(){return 1}k2(na,
Pa){if((na=Object(E.a)(yf.a,na))&&na.node&&this.ua.Ca&&12===na.node.type){var cb=this.uc.Sg(na.node);if(cb&&cb.id===this.ua.Ca.id&&(cb=Object(E.a)(ld.AParagraphNode,na.node))&&(!this.fk.Fia(cb)||this.h$b)){var R=this.Fa.$m(cb);R.osa||R.xx||R.fg||R.rd||!R.ll||!this.Dac||(this.t_.settings.Pye=!0,this.t_.fnl(cb));na.property===$g.a.listLevel?this.Mpb(3,this.ua.Ca,Pa):na.property===Dd.a.Vp?this.Mpb(4,this.ua.Ca,Pa):na.property===od.a.$ba&&(cb.ta(od.a.$ba,!1)||this.Mpb(4,this.ua.Ca,Pa))}}}Mpb(na,Pa,cb){if(Pa){var R=
[];Array.add(R,Pa);cb(R,na)}}}Object(h.a)(Yb,"SlideTextOnParagraphPropertyChangedDetectStrategy",null,[1253]);class li{constructor(na,Pa){this.ua=na;this.uc=Pa}get Vx(){return 8}k2(na,Pa){na=Object(E.a)(Wh.a,na);this.ua.Ca&&na&&na.node&&10===na.node.type&&1===na.GY&&(na=Object(E.a)(4,na.node))&&(na=this.uc.Sg(na))&&na.id===this.ua.Ca.id&&(na=[],Array.add(na,this.ua.Ca),Pa(na,5))}}Object(h.a)(li,"SlideTextOnShapeChildTopologyChangedDetectStrategy",null,[1253]);class re{constructor(na,Pa,cb,R,ta,Ra,
nb,Cb,mc){this.uc=na;this.Fa=Pa;this.ob=cb;this.gT=R;this.ua=ta;this.fk=Ra;this.Ha=nb;this.xG=Cb;this.t_=mc}y0i(na){if(ib.a.Xa(na))return 0;let Pa=0;for(const cb of na)Pa|=this.ORk(cb);return Pa}A0i(na){if(ib.a.Xa(na))return 0;let Pa=0;for(const cb of na)Pa|=this.QRk(cb);return Pa}z0i(na){if(ib.a.Xa(na))return 0;let Pa=0;for(const cb of na)Pa|=this.PRk(cb);return Pa}Ryi(){return new Kf(this.Fa,this.gT,this.ob)}Syi(){return new lg(this.ob,this.gT,this.t_,this.Ha.ofc)}Pyi(){return new uf(this.gT)}Tyi(){return new Gd(this.ob,
this.gT)}Qyi(){return new Lg(this.Fa,this.gT,this.ob)}ezi(){return new ed}hzi(){return new Qf(this.ua,this.fk,this.uc,this.Ha.pptNotesInSlideTextTileIsEnabled)}izi(){return new Yb(this.ua,this.fk,this.uc,this.Fa,this.Ha.pptNotesInSlideTextTileIsEnabled,this.xG,this.t_,this.Ha.ofc)}jzi(){return new li(this.ua,this.uc)}gzi(){return new Dh(this.uc,this.ua)}fzi(){return new Xg(this.uc,this.ua)}czi(){return new hj(this.uc)}dzi(){return new cg(this.uc)}bzi(){return new Se(2)}azi(){return new Se(1)}ORk(na){return na===
tf.k5k?1:na===tf.l5k?2:na===tf.i5k?4:na===tf.m5k?8:na===tf.j5k?16:0}QRk(na){return na===tf.Qbl?4:na===tf.Tbl?16:na===tf.Ubl?1:na===tf.Vbl?8:na===tf.Sbl?32:na===tf.Rbl?64:0}PRk(na){return na===tf.Mbl?16:na===tf.Nbl?1:na===tf.Kbl?128:na===tf.Lbl?256:0}}Object(h.a)(re,"TilingFactory",null,[1213]);class lf extends Sys.EventArgs{constructor(na){super();this.Ca=na}}Object(h.a)(lf,"TilingModuleLoadEventArgs",Sys.EventArgs,[]);var Id=d(52);class We{constructor(){this.K=null;this.kpe=this.tde=!1}get name(){return"PowerPointWebEditor.ContentUpdateDetection"}Yb(na){this.K=
na;na.register(Af,"PowerPointWebEditor.ContentUpdateDetection.TilingEventSource").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventSource").ma().na(()=>new Af);na.register(1210,"PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager").ma().na(()=>new ie(na.resolve("Box4.Graph.IGraphIteratorFactory"),na.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
na.resolve("PowerPointWebEditor.IShapeReader"),na.resolve("Box4.IParagraphReader")));na.register(1211,"PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager").ma().na(()=>new id(na.resolve("Box4.IParagraphReader"),na.resolve("PowerPointWebEditor.Graph.INotesReader"),na.resolve("Box4.Proofing.IProofingTextUtility"),na.resolve("Box4.Graph.IGraphIteratorFactory"),na.resolve("Box4.ITableNavigator"),na.resolve("PowerPointWebEditor.Graph.ITableReader"),na.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
na.resolve("Box4.IListMarkerUtility"),na.resolve("PowerPointWebEditor.IPPTParagraphReader"),na.resolve("Box4.List.IListReader"),na.resolve("PowerPointWebEditor.IApplicationSettings").pptNotesInSlideTextTileIsEnabled,na.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTopologyAndListInfoInSlideTileIsEnabled));na.register(1212,"PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter").ma().na(()=>new bg(na.resolve("Box4.List.IListReader"),na.resolve("Box4.IParagraphIndentationReader")));
na.register(Yd,"PowerPointWebEditor.ContentUpdateDetection.SlideTileManager").ma().na(()=>new Yd(na.resolve("Box4.Graph.IGraphIteratorFactory"),na.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),na.resolve("PowerPointWebEditor.IApplicationSettings"),na.resolve("Box4.IParagraphReader"),na.resolve("PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter"),na.resolve("PowerPointWebEditor.IPresentationReader")));na.register(1213,"PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").ma().na(()=>
new re(na.resolve("PowerPointWebEditor.ISlideReader"),na.resolve("PowerPointWebEditor.IShapeReader"),na.resolve("PowerPointWebEditor.IPptSelectionManager"),na.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),na.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),na.resolve("PowerPointWebEditor.Graph.INotesReader"),na.resolve("PowerPointWebEditor.IApplicationSettings"),na.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),na.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));
na.register(Qc,"PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").ma().na(()=>new Qc(na.resolve("Box4.Graph.IGraphInstance"),na.resolve("PowerPointWebEditor.IPptSelectionManager"),na.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),na.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),na.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),na.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),na.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").y0i(na.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),
na.resolve("Common.ITaskManager"),na.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),na.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireTileEventsIntervalInMilliseconds,na.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),na.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),na.resolve("PowerPointWebEditor.IApplicationSettings").replaceObjectUseClientAL));na.register(pc,"PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").ma().na(()=>
new pc(na.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),na.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").A0i(na.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),na.resolve("Common.ITaskManager"),na.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,na.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),na.resolve("PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager"),
na.resolve("Box4.Graph.IGraphInstance"),na.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),na.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),na.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers"),na.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));na.register(me,"PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").ma().na(()=>new me(na.resolve("Box4.Graph.IGraphInstance"),na.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").z0i(na.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),
na.resolve("Common.ITaskManager"),na.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,na.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),na.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileManager"),na.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),na.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),na.resolve("PowerPointWebEditor.IApplicationSettings")))}M0f(){return ab.a("AL.SendSlideTile")}init(){const na=
this.K.resolve("Common.IAppSettingsManager");na.gf(()=>{this.tde=na.ka(Id.a.pa(497));this.kpe=na.ka(Id.a.pa(810))||na.ka(Id.a.pa(809));this.tde&&(na.ka(Id.a.pa(473))&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").initialize(),(this.kpe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").initialize(),this.M0f()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize());
this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").gEk(new lf(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ca))})}dispose(){this.tde&&(this.K.resolve("Common.IAppSettingsManager").ka(Id.a.pa(473))&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").dispose(),(this.kpe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").dispose(),
this.M0f()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize())}static main(){v.a.instance.Ec(new We)}}Object(h.a)(We,"PPTWebEditorContentUpdateDetectionPackage",null,[2,3]);var Wc=d(981);class Xc{constructor(){this.va=new Qe.a}wBe(na){this.va.raiseEvent("OnEditorConsistencyCritiqueOnActiveSlide",na)}dCf(na){this.va.addHandler("OnEditorConsistencyCritiqueOnActiveSlide",na)}}Object(h.a)(Xc,"EditorRuntimeEventSource",null,[1246,1247,1248]);var Ld=d(15),
Xf=d(49),Le=d(669),md=d(32);class oj{constructor(na,Pa){this.paragraph=na;this.critiqueId=Pa}}Object(h.a)(oj,"CritiqueToHighlight",null,[]);var Ie=d(46);class qh{constructor(na,Pa,cb,R,ta,Ra,nb,Cb,mc,Sc){this.Gca=na;this.cYj=Pa;this.ua=cb;this.VB=R;this.Jb=ta;this.cW=Ra;this.sa=nb;this.Gee=Cb;this.Ga=mc;this.EZj=Sc;this.Gca.ECe(this.cYj)}kPc(na){na.length?(na=this.$6i(na),na.length&&(na=Object.assign(new Le.a,{action:0,type:2,Iba:na,Cdb:this.Gca.a9a?this.Gca.a9a.Iba:null}),this.Gca.tfd(na))):this.wCi()}wCi(){var na=
this.Gca.a9a?this.Gca.a9a.Iba:null;na=Object.assign(new Le.a,{action:1,type:2,Iba:na,Cdb:na});this.Gca.tfd(na)}$6i(na){const Pa=[];if(!this.Gee.isEnabled(2))return Pa;var cb=this.ua.Ca;if(cb&&cb.isSlideCritiqueReady){var R=cb.tIa;if(!R.count)return this.kce(2),Pa;cb=0;for(let Ra of R)if(R=Object(E.a)(ld.AParagraphNode,Ra)){var ta=this.hZd(R);for(const nb of ta)ta=Object(E.a)(266,nb.Gh),ta.IM&&Array.contains(na,ta.IM.TraceId)&&(cb++,ta=new oj(R,ta.IM.TraceId),Array.add(Pa,ta))}cb!==na.length&&this.vce(2,
cb,na.length)}else this.sce(2,cb);return Pa}Yth(na){if(!this.Gee.isEnabled(3))return!1;var Pa=this.ua.Ca;if(Pa&&Pa.isSlideCritiqueReady){Pa=Pa.tIa;if(!Pa.count)return this.kce(3),!1;let cb=0;const R=this.Jb.xd(15,void 0,()=>{this.S4g()});try{let ta=!1;R.lc(Pa.ga(0));R.fd=md.a.jjd;for(let Ra of Pa){const nb=Object(E.a)(ld.AParagraphNode,Ra);if(nb){const Cb=new A.a,mc=this.hZd(nb);for(const Sc of mc){const jd=Object(E.a)(266,Sc.Gh);if(jd.IM&&na.Kb(jd.IM.TraceId)){const Ad=na.ga(jd.IM.TraceId);let ve;
try{ve=jd.IM.Suggestions[Ad].Text;const Ae=new Ld.a(Sc,ve);Cb.add(Ae);ta||(jd.eJa(this.a9j(Ad)),ta=!0);cb++}catch(Ae){cc.a.J(38843398,375,10,"Take suggestion: Parse failed with exception: {0}",Ae)}}}Cb.count&&(Cb.Sc((Sc,jd)=>jd.key.begin-Sc.key.begin),this.yPk(nb,Cb))}}cb!==na.count&&this.vce(3,cb,na.count)}finally{R&&R.dispose()}}else return this.sce(3,Pa),!1;return!0}a9j(na){switch(na){case 0:return md.a.Vwa;case 1:return md.a.Wwa;case 2:return md.a.Xwa;case 3:return md.a.MIa;case 4:return md.a.NIa;
default:return 0}}yPk(na,Pa){for(let cb of Pa)this.cW.replaceTextRange(Xf.a.createTextRange(na,0<cb.key.begin?cb.key.begin:0,cb.key.end),cb.value,!0,!1)}ignoreCritiques(na,Pa){if(!this.Gee.isEnabled(Pa))return!1;var cb=this.ua.Ca;if(cb&&cb.isSlideCritiqueReady){var R=cb.tIa;if(!R.count)return this.kce(Pa),!1;this.S4g();cb=!1;let ta=0;for(let Ra of R)if(R=Object(E.a)(ld.AParagraphNode,Ra)){R=this.hZd(R);for(const nb of R)R=Object(E.a)(266,nb.Gh),R.IM&&Array.contains(na,R.IM.TraceId)&&(R.vCa=!0,cb||
(R.eJa(md.a.x4d),cb=!0),ta++)}ta!==na.length&&this.vce(Pa,ta,na.length)}else return this.sce(Pa,cb),!1;return!0}hZd(na){return this.VB.ME(na,Pa=>{Pa=Object(E.a)(266,Pa.Gh);return!!Pa&&5===Pa.proofingType&&!Pa.vCa})}kce(na){cc.a.J(38843400,375,15,"{0}: No slide critique in active slide. Skipping",na)}vce(na,Pa,cb){cc.a.J(38843402,375,15,"{0}: ErrorRange number mismatch. Actual: {1}, expected: {2}",na,Pa,cb)}sce(na,Pa){cc.a.J(38843404,375,15,"{0}: Active slide is null or slide critiques are not ready. Active slide null: {1}",
na,!!Pa)}S4g(){this.sa.gy();this.sa.fj();this.EZj&&this.Ga.vf(Ie.a.sg,!0)}}Object(h.a)(qh,"ConsistencyCheckActor",null,[1199]);var Od=d(307),ef=d(96),dh=d(884),ad=d(666),Fg=d(48),Cd=d(667),zg=d(668);class Eh extends ad.a{constructor(na,Pa){super();this.YXc=[dh.a.Lse,dh.a.YUc,dh.a.Kdd,dh.a.hBc];this.ua=na;this.a1j=Pa;this.Uie=[new Cd.a("InconsistentCritiquesHighlight",null),new Cd.a("InconsistentCritiquesLeftSidebar",null),new Cd.a("InconsistentCritiquesRightSidebar",null)]}get etb(){return this.a1j}get b4d(){return this.Uie}G2b(na,
Pa){na=Object(Rc.a)(Array,na)?Array.isArray(na)?na:null:null;if(!na||0<na.length&&!Object(E.a)(oj,na[0]))return Pa;const cb=new Fg.GraphTransaction(3);try{cb.hd(this.ua.presentation);for(const R of na)zg.b(R.paragraph),Pa.add(R.paragraph)}finally{cb&&cb.dispose()}return Pa}adc(na,Pa){if(this.etb&&this.hZ&&this.hZ.jha&&this.hZ.jha.Iba&&2===this.hZ.jha.type){var cb=[],R=[];this.P3g(this.hZ.jha.Iba,cb,R);var ta=[];this.P3g(this.hZ.jha.Cdb,null,ta);Pa=Pa.querySelectorAll("*");for(let Ra=0;Ra<Pa.length;Ra++){let nb=
"",Cb="";const mc=Pa[Ra];for(let Sc=0;Sc<this.YXc.length;Sc++)Od.a.te(mc,this.YXc[Sc])&&(Cb=this.YXc[Sc],nb=Od.a.te(mc,this.YXc[Sc]));nb.length&&2===this.hZ.jha.type&&(0===this.hZ.jha.action?Array.contains(R,na)&&Array.contains(cb,nb)?this.oqj(mc,Cb):this.jcd(mc):1===this.hZ.jha.action&&Array.contains(ta,na)&&this.jcd(mc))}}}oqj(na,Pa){ef.a.KH(na,"InconsistentCritiquesHighlight");switch(Pa){case dh.a.YUc:ef.a.KH(na,"InconsistentCritiquesLeftSidebar");break;case dh.a.Kdd:ef.a.KH(na,"InconsistentCritiquesRightSidebar");
break;case dh.a.hBc:ef.a.KH(na,"InconsistentCritiquesLeftSidebar"),ef.a.KH(na,"InconsistentCritiquesRightSidebar")}}P3g(na,Pa,cb){if(na)for(const R of na)Array.add(cb,R.paragraph),Pa&&Array.add(Pa,R.critiqueId)}}Object(h.a)(Eh,"CritiquesHighlightActor",ad.a,[]);class eh{}Object(h.a)(eh,"Critique",null,[]);class Gg{}Object(h.a)(Gg,"Suggestion",null,[]);class vh{NPf(na,Pa){if(!na)return[];const cb=Array(na.length);for(let R=0;R<na.length;R++)cb[R]=Pa(na[R]);return cb}qsi(na){return Object.assign(new eh,
{critiqueId:na.TraceId,typeId:na.TypeId,tag:na.Tag,bucketId:na.BucketId,paragraphId:na.TileId,start:na.Start,length:na.Length,categoryTitle:na.CategoryTitle,explanationTitle:na.ExplanationTitle,explanationLabel:na.ExplanationLabel,explanation:na.Explanation,suggestions:this.NPf(na.Suggestions,Object(x.a)(this,this.rsi,"convertBox4Suggestion"))})}rsi(na){return Object.assign(new Gg,{text:na.Text,description:na.Description,bucketId:na.BucketId,numberOfInstances:na.NumberOfInstances})}}Object(h.a)(vh,
"DataContractMapper",null,[1202]);class ze extends Sys.EventArgs{constructor(na){super();this.instanceId=na}}Object(h.a)(ze,"PaneClosedEventArgs",Sys.EventArgs,[]);var sg=d(206);class zd{constructor(na,Pa,cb,R,ta,Ra,nb,Cb){this.ia=na;this.Zd=Pa;this.Xc=cb;this.Gfe=R;this.Pyb=ta;this.Axb=Ra;this.dje=nb;this.N7j=Cb;this.Ae=0;this.Zd.execute(mc=>{mc.pGd(Object(x.a)(this,this.Kcb,"onPaneClosed"))})}get state(){return this.Ae}qgd(na){this.Ae!==na&&(this.Ae=na,this.Xc.ND(new sg.a(1)))}K0g(na){0===this.state&&
(cc.a.J(36966754,375,50,"[EditorPane] Begin opening Editor pane, reason: {0} Time: {1}",na,(new Date).getTime()),this.qgd(1),na={},na.ZT=ResourceStrings.L_EditorPaneTitle,na.assetId=this.Pyb.getAssetId(),na.dva=Object(x.a)(this,this.qve,"onPaneRendered"),na.bO={},na.bO.IdeasEnabled=this.dje.toString(),na.tnc=this.N7j,32!==this.ia.Ma(Pb.a.pIa,2,na)&&(cc.a.J(36966784,375,15,"[EditorPane] Failed to open Editor pane"),this.qgd(0)))}aK(na){if(2===this.state){var Pa=this.Pyb.SLc();Pa&&(cc.a.J(36966786,
375,50,"[EditorPane] Begin closing Editor pane, reason: {0}",na),32!==this.ia.Ma(Pb.a.fDc,2,Pa)&&cc.a.J(36966788,375,15,"[EditorPane] Failed to close Editor pane"))}}Kcb(na,Pa){2===this.state&&Pa&&(na=Pa.instanceId)&&na.length&&(Pa=this.Pyb.SLc(),Pa!==na&&Pa||(cc.a.J(37626588,375,50,"[EditorPane] Pane closed"),this.Gfe.UCk(new ze(na)),this.qgd(0),this.Axb.sessionEnd()))}qve(){const na=this.Pyb.SLc();1!==this.state?cc.a.J(37626590,375,15,"[EditorPaneActor] Received pane rendered event even though we weren't in opening state. Instance id={0}",
na):(cc.a.J(37626592,375,50,"[EditorPane] Pane rendered. Instance id={0}",na),this.qgd(2),this.Axb.zYk())}}Object(h.a)(zd,"EditorPane",null,[1204]);var Hd=d(336),Fh=d(113);class Gh{constructor(na,Pa){this.type=0;this.id=null;this.type=na;this.id=Pa}static jhb(na){return na.id&&na.id.toString().length&&Object(Rc.a)(Number,na.type)?new Gh(na.type,na.id.toString()):null}}Object(h.a)(Gh,"Message",null,[]);var ih=d(2);class ah{constructor(na,Pa,cb,R,ta,Ra,nb,Cb,mc,Sc,jd,Ad,ve,Ae,Ue,mg){this.CTd=new Wc.a;
this.ia=na;this.qEa=Pa;this.Xwb=cb;this.bEg=R;this.OZ=ta;this.iLg=Ra;this.QK=nb;this.Gfe=Cb;this.ua=mc;this.Aka=Sc;this.Q2c=jd;this.Dk=Ad;this.MYj=ve;this.Xc=Ae;this.PZj=Ue;this.qc=mg;this.YHc=new Wc.a(0);this.YHc.add(0,2001);this.YHc.add(1,2002);this.YHc.add(2,2003)}wb(){this.ia.ra(Pb.a.Nuk,Zc.a.application,Object(x.a)(this,this.$Xf,"editorPaneButtonClicked"),4);this.ia.ra(Pb.a.t7g,Zc.a.application,Object(x.a)(this,this.U6g,"queryEditorPaneButton"),96);this.ia.ra(Pb.a.Ouk,Zc.a.application,Object(x.a)(this,
this.$Xf,"editorPaneButtonClicked"),4);this.ia.ra(Pb.a.u7g,Zc.a.application,Object(x.a)(this,this.U6g,"queryEditorPaneButton"),96);this.ia.ra(Pb.a.sye,Zc.a.application,Object(x.a)(this,this.aYf,"editorPaneExtenal"),4);this.ia.ra(Pb.a.p4g,Zc.a.application,Object(x.a)(this,this.aYf,"editorPaneExtenal"),4);this.bEg.kGd(Object(x.a)(this,this.$gk,"onEditorPaneMessageReceived"));this.Aka.H2a(Object(x.a)(this,this.C_,"onSlidePresenceChanged"));this.Q2c.yk(Object(x.a)(this,this.Jla,"onSlidePropertyChanged"));
this.Dk.xM(Object(x.a)(this,this.hC,"onActiveSlideChanged"));this.Gfe.w3h(Object(x.a)(this,this.Kcb,"onPaneClosed"))}Fe(){}aYf(na,Pa,cb){if(1===cb)return 32;switch(na){case Pb.a.sye:this.qEa.K0g(2);break;case Pb.a.p4g:this.qEa.aK(2);break;default:return cc.a.J(38412318,375,10,"[EditorPaneActor] Unsupported actionId: {0}",na),16}return 32}$Xf(na,Pa,cb){if(1===cb)return this.qc.wj()?32:16;switch(this.qEa.state){case 0:return this.qEa.K0g(1),32;case 2:return this.qEa.aK(1),32;case 1:return cc.a.J(37626594,
375,50,"[EditorPaneActor] User double clicked to open pane before it was rendered"),this.Xc.ND(new sg.a(1)),32;default:return cc.a.J(36966800,375,10,"[EditorPaneActor] Unsupported EditorPaneState"),16}}U6g(na,Pa,cb,R,ta){if(!ta||!Object(Rc.a)(Fh.a,ta))return 8;ta.Yf(2===this.qEa.state||1===this.qEa.state);return 32}$gk(na,Pa){this.ahk(Pa)}ahk(na){const Pa=this.OZ.oDi(na.message);if(Pa){var cb;({value:cb}=this.iLg.Nf(Pa.type)).returnValue||(cb=this.iLg.ga(0));var R=cb.process(na,Pa);R.continueWith(()=>
{const ta=R.result,Ra=this.OZ.JYf(ta);this.sendMessage(na.instanceId,Ra);this.lUj(na,Pa,ta)})}else cc.a.J(37025985,375,15,"[EditorPaneActor] OnEditorPaneMessageReceived, can't deserialize message."),ih.Task.ot(!1)}xBe(na){this.CTd.Kb(na)||this.CTd.$(na,this.PZj.yOd(200,()=>{const Pa=this.Xwb.hcj(na);if(Pa.length){var cb=new Gh(this.YHc.ga(na),Hd.a.create().toString());cb=this.OZ.JYf(cb);this.vXk(Pa,cb)}this.MYj.wBe(na)}));this.CTd.ga(na).perform()}vXk(na,Pa){for(const cb of na)this.sendMessage(cb,
Pa)}sendMessage(na,Pa){this.bEg.sendMessage(na,Pa)}lUj(na,Pa,cb){const R=new Date,ta=+R-+na.T9g;2E3<=ta&&cc.a.J(39331167,375,1E4<=ta?10:15,"[EditorPaneActor] Host was slow to respond to the message receivedInstanceId={0} receivedIsFromEditorPane={1} receivedTimestamp={2} currentTime={3} passedMilliseconds={4} receivedId={5} receivedType={6} responseId={7} responseType={8}",na.instanceId,na.D8d,na.T9g.toUTCString(),R.getTime(),ta.toString(),Pa.id,Pa.type,cb.id,cb.type)}Jla(na,Pa){Pa.property===od.a.isSlideCritiqueReady&&
this.xBe(1)}hC(){this.xBe(0)}C_(na,Pa){(na=this.ua.Ca)&&Pa.slideId.equals(na.Cb)&&this.xBe(2)}Kcb(na,Pa){this.Xwb.Zpl(Pa.instanceId);this.QK.visualizeCritiques([])}}Object(h.a)(ah,"EditorPaneActor",null,[]);class Fi{constructor(){this.va=new Qe.a}w3h(na){this.va.addHandler("PaneClosed",na)}UCk(na){this.va.raiseEvent("PaneClosed",na)}}Object(h.a)(Fi,"EditorPaneEventSource",null,[1205,1244,1245]);var Wi=d(4);class Mg{}Object(h.a)(Mg,"Paragraph",null,[]);var ee=d(209);class Lf{constructor(na,Pa,cb,R,
ta,Ra,nb,Cb,mc){this.ua=na;this.VB=Pa;this.USa=cb;this.ia=R;this.Fa=ta;this.v4j=Ra;this.Xee=nb;this.Zh=Cb;this.h1j=mc}checkProofingDirty(na){const Pa=na.includedTags;if(2===na.critiqueSelection&&1===Pa)return na=(na=this.ua.Ca)&&na.isConnected?!na.isSlideCritiqueReady:!0,this.Csa(0,!0),na;this.HAg("CheckProofingDirty");return!0}getCritiques(na){var Pa=na.includedTags;if(2===na.critiqueSelection&&1===Pa){na=this.ua.Ca;if(!na||!na.isConnected||!na.isSlideCritiqueReady)return null;Pa=na.tIa;na=[];for(let cb of Pa)if((Pa=
cb)&&Pa.isConnected){Pa=this.VB.ME(Pa,R=>{R=Object(E.a)(266,R.Gh);return!!R&&5===R.proofingType&&!R.vCa});for(const R of Pa)(Pa=Object(E.a)(266,R.Gh))&&na.push(Pa.IM)}this.Csa(1,!0);return this.Xee.NPf(na,Object(x.a)(this.Xee,this.Xee.qsi,"convertBox4Critique"))}this.HAg("GetCritiques");return null}Yag(na){var Pa=this.ua.Ca;if(!Pa||!Pa.isConnected)return null;const cb=[];na=Lf.Ubk(na);Pa=Pa.Vga;for(const R of na)(na=Object(E.a)(be.a,Pa.te(Hd.a.ig(R))))&&na.isConnected&&cb.push(Object.assign(new Mg,
{paragraphId:R,text:this.Zh.XDe(na,"\n")}));return cb}getSupportedLanguages(na){return this.v4j.wZi(na.includedTags).CWR(Pa=>{const cb=[];if(Pa=Object(E.a)(Wi.a,Pa)){Pa=Pa.result;for(let R of Pa)(Pa=vb.a.re(R))&&Array.add(cb,Pa.name)}this.Csa(6,!0);return cb})}getLanguagesOnCurrentSlide(){const na=[],Pa=[],cb=this.ua.Ca;let R=[];cb&&(R=cb.km());for(const ta of R)this.Fa.RI(ta,Ra=>{if(Ra&&Object(Rc.a)(ld.AParagraphNode,Ra)){Ra=Object(E.a)(ld.AParagraphNode,Ra);var nb=Ra.characterData;if(nb&&nb.length){var Cb=
-1,mc;for(nb=0;nb<Ra.Ra.length;nb++)if(mc=Ra.Ra.ga(nb).formatting)mc=gd.a.language(mc),Cb===mc||Array.contains(na,mc)||(Array.add(na,mc),(Cb=vb.a.re(mc))&&Array.add(Pa,Cb.name)),Cb=mc}}});this.Csa(7,!0);return Pa}visualizeCritiques(na){if(!na)return this.Csa(2,!1),1;const Pa=Array(na.length);if(!na.length)return this.USa.kPc(Pa),this.Csa(2,!0),0;for(let cb=0;cb<na.length;cb++)Pa[cb]=na[cb].critiqueId;this.USa.kPc(Pa);this.Csa(2,!0);return 0}resolveCritiques(na){if(!na||!na.length)return 1;const Pa=
new Wc.a(0);for(const cb of na)Pa.add(cb.critiqueId,cb.suggestionIndex);na=this.USa.Yth(Pa);this.Csa(3,na);return na?0:1}ignoreCritiques(na){if(!na||!na.length)return 1;const Pa=[];for(const cb of na)Array.add(Pa,cb.critiqueId);na=this.USa.ignoreCritiques(Pa,4);this.Csa(4,na);return na?0:1}openProofingSettingsDialog(){if(this.h1j){const na=this.ia.processAction(md.a.G8c,2);this.Csa(5,32===na)}}Csa(na,Pa){cc.a.J(37266337,375,50,"{0}: {1}",na,Pa?0:1)}HAg(na){cc.a.J(36750081,375,15,"{0}: Unsupported CritiqueFilter",
na)}static Ubk(na){const Pa=new ee.a;for(var cb of na)Pa.contains(cb.paragraphId)||Pa.add(cb.paragraphId);na=Array(Pa.count);cb=0;for(let R of Pa)na[cb++]=R;return na}}Object(h.a)(Lf,"EditorPaneHost",null,[1201]);class Vf{}Object(h.a)(Vf,"EditorRuntimeNotificationData",null,[]);class fd extends Sys.EventArgs{constructor(){super();this.PXb=this.uia=null}}Object(h.a)(fd,"EditorRuntimeNotificationEventArgs",Sys.EventArgs,[]);class Ee{constructor(){this.notificationConfidence=0;this.shouldRaiseNotification=
!1;this.confidence=0;this.resultStatus=null}}Object(h.a)(Ee,"InfraredResultBase",null,[]);var Yf=d(325),ij=d(517);class Md{constructor(na,Pa){this.includedTags=this.critiqueSelection=0;this.critiqueSelection=na;this.includedTags=Pa}static dH(na){return Object(Rc.a)(Number,na.critiqueSelection)&&Object(Rc.a)(Number,na.includedTags)?new Md(na.critiqueSelection,na.includedTags):null}}Object(h.a)(Md,"CritiqueFilter",null,[]);class pj{constructor(na,Pa,cb,R){this.ia=na;this.QK=Pa;this.ua=cb;this.cEg=R}wBe(na){if(this.cEg){var Pa=
new Md(2,1),cb=this.QK.checkProofingDirty(Pa),R=cb?[]:this.QK.getCritiques(Pa),ta=cb?[]:this.QK.Yag(R);Pa=this.jte();na=Object.assign(new Vf,{isProofingDirty:cb,critiques:R,paragraphs:ta,numberOfCoAuthors:Pa,contextChanged:0===na});ta=(R=!!R&&0<R.length)?1:0;let Ra=Yf.a.success;0<Pa?Ra=Yf.a.rGa:cb?Ra=Yf.a.pending:R||(Ra=Yf.a.rGa);cb=Object.assign(new fd,{uia:Object.assign(new Ee,{notificationConfidence:ta,shouldRaiseNotification:!1,confidence:1,resultStatus:Ra}),PXb:na});this.cEg.wBe(cb)}}jte(){var na=
this.ua.Ca;if(!na||!na.isConnected)return 0;na=Object.assign(new ij.a,{slideId:na.Cb});this.ia.Ma(Pb.a.uWa,2,na);return na.Gkc}}Object(h.a)(pj,"EditorRuntimeEventRaiser",null,[1200]);var qj=d(531),jj=d(682);class Ag{constructor(na){this.I_j=na}zYk(){this.rXa(0,0)}sessionEnd(){this.rXa(1,0)}Ifl(){this.rXa(2,4)}Jfl(){this.rXa(2,3)}rXa(na,Pa){this.I_j.execute(cb=>{const R=Object.assign(new jj.a,{cardId:qj.a.YXf,actionType:na,actionEngagement:Pa});cb.S5c(R)})}}Object(h.a)(Ag,"InfraredTelemetryLogger",
null,[1203]);class mf extends Gh{constructor(na,Pa,cb){super(na,Pa);this.payload=null;this.payload=cb}}Object(h.a)(mf,"MessageWithPayload",Gh,[]);class Ia extends mf{constructor(na,Pa,cb){super(na,Pa,cb)}}Object(h.a)(Ia,"CheckProofingDirtyAndGetCritiquesResponse",mf,[]);class tb extends mf{constructor(na,Pa,cb){super(na,Pa,cb)}}Object(h.a)(tb,"ResponseMessage",mf,[]);class Qb{constructor(na){this.statusCode=0;this.logErrorMessage=null;this.statusCode=na;this.logErrorMessage="";0!==na&&(this.logErrorMessage=
na.toString())}}Object(h.a)(Qb,"Response",null,[]);class qc extends Qb{constructor(na,Pa,cb,R){super(0);this.isProofingDirty=!1;this.languagesOnTheCurrentSlide=this.paragraphs=this.critiques=null;this.isProofingDirty=na;this.critiques=Pa;this.paragraphs=cb;this.languagesOnTheCurrentSlide=R}}Object(h.a)(qc,"ProofingDirtyAndCritiques",Qb,[]);class Lc{constructor(na,Pa,cb){this.ua=na;this.QK=Pa;this.OZ=cb}process(na,Pa){var cb=this.OZ.ABi(na.message);if(!cb)return cc.a.J(37025993,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Can't decode message."),
na=new Qb(1),ih.Task.ot(new tb(1003,Pa.id,na));na=this.ua.Ca;if(!na||!na.isConnected)return cc.a.J(37025995,375,50,"[CheckProofingDirtyAndGetCritiquesProcessor] Active slide doesn't exist or is not connected"),na=new qc(!1,[],[],[]),Pa=new Ia(1003,Pa.id,na),ih.Task.ot(Pa);cb=(na=this.QK.checkProofingDirty(cb.payload))?[]:this.QK.getCritiques(cb.payload);if(!cb)return cc.a.J(38418246,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] No box4 critiques were returned by host"),na=new Qb(2),ih.Task.ot(new tb(1003,
Pa.id,na));const R=na?[]:this.QK.Yag(cb),ta=na?[]:this.QK.getLanguagesOnCurrentSlide();if(!ta)return cc.a.J(38418248,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Failed to query languages on current slide"),na=new Qb(7),ih.Task.ot(new tb(1003,Pa.id,na));na=new qc(na,cb,R,ta);Pa=new Ia(1003,Pa.id,na);return ih.Task.ot(Pa)}}Object(h.a)(Lc,"CheckProofingDirtyAndGetCritiquesProcessor",null,[1243]);class Jd{constructor(na,Pa,cb){this.QK=na;this.OZ=Pa;this.Axb=cb}process(na,Pa){var cb=this.OZ.CBi(na.message);
if(!cb)return cc.a.J(37087328,375,15,"[IgnoreProcessor] Can't decode message."),na=new Qb(1),ih.Task.ot(new tb(1006,Pa.id,na));cb=this.QK.ignoreCritiques(cb.payload);0===cb&&na.D8d&&this.Axb.Jfl();na=0===cb?new Qb(0):new Qb(6);return ih.Task.ot(new tb(1006,Pa.id,na))}}Object(h.a)(Jd,"IgnoreProcessor",null,[1243]);class le extends mf{constructor(na,Pa,cb){super(na,Pa,cb)}}Object(h.a)(le,"NumberOfCoAuthorsResponse",mf,[]);class je extends Qb{constructor(na){super(0);this.numberOfCoAuthors=0;this.numberOfCoAuthors=
na}}Object(h.a)(je,"NumberOfCoAuthorsModel",Qb,[]);class Gf{constructor(na,Pa){this.ia=na;this.ua=Pa}process(na,Pa){na=this.jte();na=new je(na);return ih.Task.ot(new le(1009,Pa.id,na))}jte(){var na=this.ua.Ca;if(!na||!na.isConnected)return 0;na=Object.assign(new ij.a,{slideId:na.Cb});this.ia.Ma(Pb.a.uWa,2,na);return na.Gkc}}Object(h.a)(Gf,"NumberOfCoAuthorsProcessor",null,[1243]);class Wf{constructor(na,Pa,cb){this.ia=na;this.qEa=Pa;this.dje=cb}process(na,Pa){if(!this.dje)return cc.a.J(38412446,375,
15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Ideas disabled, but we were asked to open Ideas pane"),na=new Qb(10),ih.Task.ot(new tb(1011,Pa.id,na));this.qEa.aK(3);na=this.ia.processAction(Pb.a.fLe,2);32!==na&&cc.a.J(38412448,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Failed to open Ideas pane");na=new Qb(32!==na?9:0);return ih.Task.ot(new tb(1011,Pa.id,na))}}Object(h.a)(Wf,"OpenIdeasPaneAndCloseEditorPaneProcessor",null,[1243]);class fh{constructor(na){this.QK=na}process(na,Pa){this.QK.openProofingSettingsDialog();
na=new Qb(0);return ih.Task.ot(new tb(1007,Pa.id,na))}}Object(h.a)(fh,"OpenProofingSettingsProcessor",null,[1243]);class zh{constructor(na,Pa,cb){this.QK=na;this.OZ=Pa;this.Axb=cb}process(na,Pa){var cb=this.OZ.DBi(na.message);if(!cb)return cc.a.J(37087330,375,15,"[ResolveProcessor] Can't decode message."),na=new Qb(1),ih.Task.ot(new tb(1005,Pa.id,na));cb=this.QK.resolveCritiques(cb.payload);0===cb&&na.D8d&&this.Axb.Ifl();na=0===cb?new Qb(0):new Qb(5);return ih.Task.ot(new tb(1005,Pa.id,na))}}Object(h.a)(zh,
"ResolveProcessor",null,[1243]);class Qg extends mf{constructor(na,Pa,cb){super(na,Pa,cb)}}Object(h.a)(Qg,"SubscriptionResponse",mf,[]);class Rg extends Qb{constructor(na){super(0);this.telemetryCorrelationId=null;this.telemetryCorrelationId=na}}Object(h.a)(Rg,"SubscriptionModel",Qb,[]);class wi{constructor(na,Pa){this.Xwb=na;this.OZ=Pa}process(na,Pa){const cb=this.OZ.EBi(na.message);if(!cb)return cc.a.J(39331169,375,15,"[SubscribeProcessor] Can't decode message."),na=new Qb(1),ih.Task.ot(new tb(1001,
Pa.id,na));cc.a.J(39331171,375,50,"Editor pane telemetry correlation id={0}",cb.payload.telemetryCorrelationId);this.Xwb.subscribe(na.instanceId,0);this.Xwb.subscribe(na.instanceId,1);this.Xwb.subscribe(na.instanceId,2);na=new Rg("not available");return ih.Task.ot(new Qg(1001,Pa.id,na))}}Object(h.a)(wi,"SubscribeProcessor",null,[1243]);class Ng extends mf{constructor(na,Pa,cb){super(na,Pa,cb)}}Object(h.a)(Ng,"SupportedLanguagesResponse",mf,[]);class Fj extends Qb{constructor(na){super(0);this.supportedLanguages=
null;this.supportedLanguages=na}}Object(h.a)(Fj,"SupportedLanguagesModel",Qb,[]);class Hh{constructor(na,Pa){this.QK=na;this.OZ=Pa}process(na,Pa){na=this.OZ.FBi(na.message);if(!na)return cc.a.J(38094432,375,15,"[SupportedLanguagesProcessor] Can't decode message."),na=new Qb(1),ih.Task.ot(new tb(1010,Pa.id,na));const cb=this.QK.getSupportedLanguages(na.payload);return cb.CWR(()=>{var R=cb.result;if(!R)return cc.a.J(38094434,375,15,"[SupportedLanguagesProcessor] Failed to query supported languages"),
R=new Qb(8),new tb(1010,Pa.id,R);R=new Fj(R);return new Ng(1010,Pa.id,R)})}}Object(h.a)(Hh,"SupportedLanguagesProcessor",null,[1243]);class gg{process(na,Pa){cc.a.J(37025999,375,15,"[UnsupportedMessageProcessor] Unsupported message type: {0}",Pa.type);na=new Qb(3);return ih.Task.ot(new tb(Pa.type,Pa.id,na))}}Object(h.a)(gg,"UnsupportedMessageProcessor",null,[1243]);class Og{constructor(na,Pa){this.QK=na;this.OZ=Pa}process(na,Pa){na=this.OZ.GBi(na.message);if(!na)return cc.a.J(37026001,375,15,"[VisualizeProcessor] Can't decode message."),
na=new Qb(1),ih.Task.ot(new tb(1004,Pa.id,na));na=0===this.QK.visualizeCritiques(na.payload)?new Qb(0):new Qb(4);return ih.Task.ot(new tb(1004,Pa.id,na))}}Object(h.a)(Og,"VisualizeProcessor",null,[1243]);class vg extends mf{constructor(na,Pa,cb){super(na,Pa,cb)}static dH(na){const Pa=Gh.jhb(na);return Pa&&na.payload?(na=Md.dH(na.payload))?new vg(Pa.type,Pa.id,na):null:null}}Object(h.a)(vg,"CheckProofingDirtyAndGetCritiquesMessage",mf,[]);class Sg{constructor(na){this.bLb=na}get critiqueId(){return this.bLb}static dH(na){return na.critiqueId&&
Object(E.a)(String,na.critiqueId)?new Sg(na.critiqueId.toString()):null}}Object(h.a)(Sg,"CritiqueIgnore",null,[]);class wh extends mf{constructor(na,Pa,cb){super(na,Pa,cb)}static dH(na){const Pa=Gh.jhb(na);if(!Pa||!na.payload||!Object(Rc.a)(Array,na.payload))return null;na=na.payload;const cb=Array(na.length);for(let R=0;R<na.length;R++){const ta=Sg.dH(na[R]);if(!cb)return null;cb[R]=ta}return new wh(Pa.type,Pa.id,cb)}}Object(h.a)(wh,"IgnoreCritiquesMessage",mf,[]);class ci{constructor(na,Pa){this.bLb=
na;this.DUh=Pa}get critiqueId(){return this.bLb}get suggestionIndex(){return this.DUh}static dH(na){return na.critiqueId&&Object(E.a)(String,na.critiqueId)&&Object(Rc.a)(Number,na.suggestionIndex)?new ci(na.critiqueId.toString(),na.suggestionIndex):null}}Object(h.a)(ci,"CritiqueResolution",null,[]);class Rh extends mf{constructor(na,Pa,cb){super(na,Pa,cb)}static dH(na){const Pa=Gh.jhb(na);if(!Pa||!na.payload||!Object(Rc.a)(Array,na.payload))return null;na=na.payload;const cb=Array(na.length);for(let R=
0;R<na.length;R++){const ta=ci.dH(na[R]);if(!cb)return null;cb[R]=ta}return new Rh(Pa.type,Pa.id,cb)}}Object(h.a)(Rh,"ResolveCritiquesMessage",mf,[]);class se{constructor(na){this.telemetryCorrelationId=null;this.telemetryCorrelationId=na}static dH(na){let Pa="unavailable";na.telemetryCorrelationId&&Object(E.a)(String,na.telemetryCorrelationId)&&na.telemetryCorrelationId.toString().length&&50>=na.telemetryCorrelationId.toString().length&&(Pa=na.telemetryCorrelationId.toString());return new se(Pa)}}
Object(h.a)(se,"Subscription",null,[]);class bf extends mf{constructor(na,Pa,cb){super(na,Pa,cb)}static dH(na){const Pa=Gh.jhb(na);if(!Pa)return null;na.payload||(na.payload={});return(na=se.dH(na.payload))?new bf(Pa.type,Pa.id,na):null}}Object(h.a)(bf,"SubscribeMessage",mf,[]);class Sh extends mf{constructor(na,Pa,cb){super(na,Pa,cb)}static dH(na){const Pa=Gh.jhb(na);return Pa&&na.payload?(na=Md.dH(na.payload))?new Sh(Pa.type,Pa.id,na):null:null}}Object(h.a)(Sh,"SupportedLanguagesMessage",mf,[]);
class $c{constructor(na){this.bLb=na}get critiqueId(){return this.bLb}static dH(na){return na.critiqueId&&Object(E.a)(String,na.critiqueId)&&na.critiqueId.toString().length?new $c(na.critiqueId.toString()):null}}Object(h.a)($c,"CritiqueToVisualize",null,[]);class Gi extends mf{constructor(na,Pa,cb){super(na,Pa,cb)}static dH(na){const Pa=Gh.jhb(na);if(!Pa||!na.payload||!Object(Rc.a)(Array,na.payload))return null;na=na.payload;const cb=Array(na.length);for(let R=0;R<na.length;R++){const ta=$c.dH(na[R]);
if(!cb)return null;cb[R]=ta}return new Gi(Pa.type,Pa.id,cb)}}Object(h.a)(Gi,"VisualizeCritiquesMessage",mf,[]);class Hk{oDi(na){return this.ihb(na,Gh.jhb)}EBi(na){return this.ihb(na,bf.dH)}ABi(na){return this.ihb(na,vg.dH)}GBi(na){return this.ihb(na,Gi.dH)}DBi(na){return this.ihb(na,Rh.dH)}CBi(na){return this.ihb(na,wh.dH)}FBi(na){return this.ihb(na,Sh.dH)}ihb(na,Pa){try{let cb;return({Ev:cb}=u.d(na)).returnValue?Pa(cb):null}catch(cb){return null}}JYf(na){return u.c(na)}}Object(h.a)(Hk,"MessageEncoder",
null,[1209]);var Gj=d(82);class Hj extends Sys.EventArgs{constructor(na,Pa,cb){super();this.instanceId=na;this.message=Pa;this.D8d=cb;this.T9g=new Date}}Object(h.a)(Hj,"MessageReceivedEventArgs",Sys.EventArgs,[]);class wa{constructor(na,Pa,cb){this.va=new Qe.a;this.Pyb=na;this.yBg=Pa;this.x_j=new RegExp(cb,"i")}initialize(){try{if(window.addEventListener)return window.addEventListener("message",Object(x.a)(this,this.Dbc,"messageReceivedHandler"),!1),!0;if(-1<window.navigator.userAgent.indexOf("MSIE")&&
window.attachEvent)return window.attachEvent("onmessage",Object(x.a)(this,this.Dbc,"messageReceivedHandler")),!0;cc.a.J(37026003,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window")}catch(na){cc.a.J(37026005,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",na.message,na.stack)}return!1}kGd(na){this.va.addHandler("MessageReceived",na)}Fbh(na){this.va.removeHandler("MessageReceived",
na)}sendMessage(na,Pa){if(na&&Pa){var cb={};cb.message=Pa;cb.editorPaneWildCard=".";this.sXk(na,cb)}}sXk(na,Pa){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(na,"onCustomMessage",Pa,cb=>{cb&&cc.a.J(37026007,375,15,"Couldn't deliver the message to Editor pane, status: {0}.",cb)})}Dbc(na){const Pa=na.origin;if(this.R3b(Pa)){var cb;({Ev:cb}=u.d(na.data)).returnValue&&cb&&"."===cb.editorPaneWildCard&&cb.message&&this.va.raiseEvent("MessageReceived",new Hj(this.Pyb.SLc(),cb.message,Pa===this.yBg))}}R3b(na){const Pa=
Gj.a.hS(window.location.href);return!!na&&0<na.length&&"null"!==na&&(na===this.yBg||na===Pa||this.x_j.test(na))}}Object(h.a)(wa,"Messenger",null,[1208]);class Ma{constructor(na,Pa){this.Zd=na;this.assetId=Pa.A4g}SLc(){if(!this.Zd.instance)return cc.a.J(37025987,375,15,"[EditorPaneManager] App for office manager not present"),null;const na=this.Zd.instance.YY(this.assetId);return na?na.instanceId?na.instanceId:(cc.a.J(37025991,375,15,"[EditorPaneManager] App for office doesn't have instance id"),null):
(cc.a.J(37025989,375,200,"[EditorPaneManager] App for office not found"),null)}getAssetId(){return this.assetId}}Object(h.a)(Ma,"PaneIdsProvider",null,[1206]);class hb{constructor(){this.Vr=new Wc.a}subscribe(na,Pa){na&&(this.Vr.Kb(Pa)||this.Vr.add(Pa,[]),Array.contains(this.Vr.ga(Pa),na)||this.Vr.ga(Pa).push(na))}unsubscribe(na,Pa){na&&this.Vr.Kb(Pa)&&(na=Array.indexOf(this.Vr.ga(Pa),na),-1!==na&&Array.removeAt(this.Vr.ga(Pa),na))}Zpl(na){na&&(this.unsubscribe(na,0),this.unsubscribe(na,1),this.unsubscribe(na,
2))}hcj(na){return this.Vr.Kb(na)?this.Vr.ga(na):[]}}Object(h.a)(hb,"EditorPaneSubscriptionsManager",null,[1207]);class ub{constructor(){this.K=null}get name(){return"PowerPointWebEditor.EditorPane"}Yb(na){na&&(this.K=na,this.K.register(Eh,"PowerPointWebEditor.Proofing.CritiquesHighlightActor").ma().na(()=>new Eh(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorConsistencyCheckIsEnabled)),this.K.register(1199,"PowerPointWebEditor.Proofing.IConsistencyCheckActor").ma().na(()=>
new qh(this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.Proofing.CritiquesHighlightActor"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFocusDocumentAfterActionOnEditorPaneIsEnabled)),this.K.register(ah,"PowerPointWebEditor.EditorPane.EditorPaneActor").ma().na(()=>new ah(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.Zwi(),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.K.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))),this.K.register(1200,"PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser").ma().na(()=>new pj(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"))),this.K.register(Xc,"PowerPointWebEditor.Editor.Common.Model.EditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventNotifier").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventHandler").ma().na(()=>
new Xc),this.K.register(1201,"PowerPointWebEditor.EditorPane.IEditorPaneHost").ma().na(()=>new Lf(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckActor"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IDataContractMapper"),
this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Common.IAppSettingsManager").ka(Id.a.pa(299)))),this.K.register(1202,"PowerPointWebEditor.EditorPane.IDataContractMapper").ma().na(()=>new vh),this.K.register(1203,"PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger").ma().na(()=>new Ag(this.K.Oa("PowerPointWebEditor.IInfraredTelemetryListener"))),this.K.register(1204,"PowerPointWebEditor.EditorPane.IEditorPane").ma().na(()=>new zd(this.K.resolve("Common.IActionManagerExtended"),this.K.Oa("PowerPointWebEditor.IAppForOfficeManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled,!0)),this.K.register(1205,"PowerPointWebEditor.EditorPane.IEditorPaneEventSource").ma().na(()=>new Fi),this.K.register(1206,"PowerPointWebEditor.EditorPane.IPaneIdsProvider").ma().na(()=>
new Ma(this.K.Oa("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(1207,"PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager").ma().na(()=>new hb),this.K.register(1208,"PowerPointWebEditor.EditorPane.Messaging.IMessenger").ma().na(()=>new wa(this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Bvk,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasApprovedOriginPattern)),
this.K.register(1209,"PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder").ma().na(()=>new Hk),this.K.register(gg,"PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor").ma().na(()=>new gg),this.K.register(wi,"PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor").ma().na(()=>new wi(this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(zh,
"PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor").ma().na(()=>new zh(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(Jd,"PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor").ma().na(()=>new Jd(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(fh,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor").ma().na(()=>new fh(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"))),this.K.register(Lc,"PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor").ma().na(()=>new Lc(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Og,"PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor").ma().na(()=>new Og(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Gf,"PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor").ma().na(()=>new Gf(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),
this.K.register(Hh,"PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor").ma().na(()=>new Hh(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Wf,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor").ma().na(()=>new Wf(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled)))}init(){this.K&&
this.K.resolve("Common.IAppSettingsManager").gf(()=>{var na=this.K.resolve("PowerPointWebEditor.IApplicationSettings");ub.b7k(na)&&this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger").initialize()&&(na=this.K.resolve("PowerPointWebEditor.EditorPane.EditorPaneActor"),na.wb(),na.Fe())})}dispose(){}Zwi(){const na=new Wc.a;na.$(0,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor"));na.$(1,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor"));
na.$(3,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor"));na.$(4,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor"));na.$(5,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor"));na.$(6,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor"));na.$(7,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor"));na.$(9,
this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor"));na.$(10,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor"));na.$(11,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor"));return na}static main(){v.a.instance.Ec(new ub)}static b7k(na){return na.pptEditorConsistencyCheckIsEnabled&&ub.jAj(na.A4g)}static jAj(na){return!!na&&0<na.length}}Object(h.a)(ub,"PptWebEditorEditorPanePackage",
null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.ContentUpdateDetection");Type.registerNamespace("PowerPointWebEditor.EditorPane");Type.registerNamespace("PowerPointWebEditor.EditorPane.MessageProcessing");Type.registerNamespace("PowerPointWebEditor.EditorPane.Messaging");Type.registerNamespace("PowerPointWebEditor.EditorPane.Model");Type.registerNamespace("PowerPointWebEditor.EditorPane.Subscription");
Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.TextPrediction");Sb.main();$a.main();We.main();ub.main()},666:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(17),e=d(96),m=d(27),r=d(48);d(97);class v{constructor(){this.hZ=null}get etb(){return!1}fwh(A,x){let y=new h.a;const u=new r.GraphTransaction(3);try{u.hd(m.App.Fb.Fd.Xm.ug),this.T4b(x)&&(y=this.G2b(x,y)),x!==A&&this.T4b(A)&&(y=this.G2b(A,y))}finally{u&&u.dispose()}return y.toArray()}T4b(A){return!!A}jcd(A){let x=
!1;for(const y of this.b4d)x||!Sys.UI.DomElement.containsCssClass(A,y.className)&&!Sys.UI.DomElement.containsCssClass(A,y.X0b)||(x=!0),e.a.uHa(A,y.className),e.a.uHa(A,y.X0b)}}Object(J.a)(v,"AHighlightActor",null,[1252])},667:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.className=e;this.X0b=m}}Object(J.a)(h,"HighlightCssClassPair",null,[])},668:function(J,V,d){d.d(V,"b",function(){return r});d.d(V,"a",function(){return v});var h=d(96);d(27);var e=d(48);d(31);
d(89);var m=d(97);const r=A=>{const x=new e.GraphTransaction(3);try{x.hd(A),A.Su(32,!0)}finally{x&&x.dispose()}},v=A=>{if(A){A=h.a.Rha(A);if(-1===A.indexOf(m.a.C6)&&-1!==A.indexOf(m.a.AM)&&-1===A.indexOf(m.a.xWb))return 2;if(-1===A.indexOf(m.a.C6)&&(-1!==A.indexOf(m.a.wWb)||-1!==A.indexOf(m.a.RM)||-1!==A.indexOf(m.a.xWb)||-1!==A.indexOf(m.a.GDc)||-1!==A.indexOf(m.a.qFc)||-1!==A.indexOf(m.a.oFc)||-1!==A.indexOf(m.a.nFc)||-1!==A.indexOf(m.a.EPd)||-1!==A.indexOf(m.a.zPd)||-1!==A.indexOf(m.a.BPd)||-1!==
A.indexOf(m.a.pFc)||-1!==A.indexOf(m.a.yPd)))return 1;if(-1!==A.indexOf("WACImageContainer"))return 3}return 0}},669:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.type=this.action=0;this.Cdb=this.Iba=null}}Object(J.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.augloop.js.map