var SlideGrid=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=16)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewBindingParam=function(){};t.ViewModelBindingParam=function(){};var i=function(){function e(e,t){var n=this;this._bindingList=[],null!=e&&null!=t&&null!=Object(e)[t]&&(delete Object(e)[t].get,delete Object(e)[t].set),Object.defineProperty(e,t,{set:function(i){Object(e)["_"+t]=i,n._bindingList.forEach((function(e){e.attribute&&""!==e.attribute&&(Object(e.element)[e.attribute]=i),null!=e.onValueChanged&&e.onValueChanged(i)}))},get:function(){return Object(e)["_"+t]},configurable:!0})}return e.prototype.addBinding=function(e){this._bindingList.push(e)},e}();t.ViewBinding=i;var r=function(){function e(e,t){var n=this;this._bindingList=[],null!=e&&null!=t&&null!=Object(e)[t]&&(delete Object(e)[t].get,delete Object(e)[t].set),Object.defineProperty(e,t,{set:function(i){Object(e)["_"+t]=i,n._bindingList.forEach((function(e){Object(e.target)[t]=i,null!=e.onValueChanged&&e.onValueChanged(i)}))},get:function(){return Object(e)["_"+t]},configurable:!0})}return e.prototype.addBinding=function(e){this._bindingList.push(e)},e}();t.ViewModelBinding=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.subs=[]}return e.prototype.signal=function(e,t){this.subs.forEach((function(n){n(e,t)}))},e.prototype.subscribe=function(e){this.subs.push(e)},e.prototype.unsubscribe=function(e){var t=this.subs.indexOf(e);return-1!==t&&(this.subs.splice(t,1),!0)},e}();t.Event=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.m_genericViewClassName="generic-view-class",this._parent=e,this._container=document.createElement("div"),this._container.classList.add(this.m_genericViewClassName),this._parent.appendChild(this._container)}return e.prototype.dispose=function(){try{this._parent.removeChild(this._container)}catch(e){}},Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),e}();t.View=i},function(e,t,n){var i=n(23),r=n(24),o=r;o.v1=i,o.v4=r,e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){null!=this._parent&&(this._parent=e)}return e.prototype.dispose=function(){null!=this._view&&this._view.dispose()},e}();t.ViewModel=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),(i=t.DragDropObjectType||(t.DragDropObjectType={}))[i.Slide=0]="Slide",i[i.Section=1]="Section",i[i.SlidePlaceholder=2]="SlidePlaceholder";var r=function(){function e(e,t){this.m_index=t,this.m_type=e}return e.prototype.isEqual=function(e){return this.m_index===e.index&&this.dragDropObjectType===e.dragDropObjectType},Object.defineProperty(e.prototype,"index",{get:function(){return this.m_index},set:function(e){this.m_index=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragDropObjectType",{get:function(){return this.m_type},enumerable:!0,configurable:!0}),e}();t.ObjectData=r},function(e,t,n){"use strict";var i,r,o;Object.defineProperty(t,"__esModule",{value:!0}),(i=t.SlideSelectionTrigger||(t.SlideSelectionTrigger={}))[i.Click=0]="Click",i[i.DoubleClick=1]="DoubleClick",i[i.RightClick=2]="RightClick",i[i.EnterKey=3]="EnterKey",i[i.ActiveSlideChange=4]="ActiveSlideChange",i[i.MouseDown=5]="MouseDown",i[i.ActiveSectionChange=6]="ActiveSectionChange",i[i.ArrowKey=7]="ArrowKey",i[i.CtrlAKey=8]="CtrlAKey",(r=t.SectionSelectionTrigger||(t.SectionSelectionTrigger={}))[r.Click=0]="Click",r[r.RightClick=2]="RightClick",r[r.ActiveSectionChange=3]="ActiveSectionChange",(o=t.PresenceTouchTargetTrigger||(t.PresenceTouchTargetTrigger={}))[o.MouseOver=0]="MouseOver",o[o.MouseOut=1]="MouseOut"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.MoveSlideByIndex=function(e,t,n,i,r,o){var s=e.filter((function(e){return 0<=n.indexOf(e.slideOrderIndex)})),a=s.map((function(e){return e.slideID})),l=e.slice();s=s.sort((function(e,t){return e.slideOrderIndex-t.slideOrderIndex}));for(var d=function(n){var o=null!=l.filter((function(e){return e.slideID===s[n].slideID}))?l.filter((function(e){return e.slideID===s[n].slideID}))[0]:null;if(o){var a=l.map((function(e){return e.slideID})).indexOf(s[n].slideID);if(0<=i){var d=t[o.sectionIndex];d.slideIdList.splice(d.slideIdList.indexOf(o.slideID),1);var c=0<=r?r:e[i].sectionIndex;o.sectionIndex=c,null==t[c].slideIdList&&(t[c].slideIdList=[]),t[c].slideIdList.push(o.slideID)}o.slideOrderIndex,l.splice(a,1)}},c=0;c<s.length;c+=1)d(c);var u=-1;for(c=0;c<l.length;c+=1)l[c].slideOrderIndex===i&&(u=c);for(u=o?u+1:u,l.splice.apply(l,[u,0].concat(s)),l.forEach((function(e,t){e.slideOrderIndex=t})),c=0;c<e.length;c+=1)e[c]=l[c];return e.filter((function(e){return 0<=a.indexOf(e.slideID)})).map((function(e){return e.slideOrderIndex}))},e.isFirstSlideOfSection=function(e,t){if(t<0||null==e||0===e.length||t>e.length-1)return!1;var n=e[t];return t===e.filter((function(e){return e.sectionIndex===n.sectionIndex})).map((function(e){return e.slideOrderIndex})).reduce((function(e,t){return Math.min(e,t)}))},e.isLastSlideOfSection=function(e,t){if(t<0||null==e||0===e.length||t>e.length-1)return!1;var n=e[t];return t===e.filter((function(e){return e.sectionIndex===n.sectionIndex})).map((function(e){return e.slideOrderIndex})).reduce((function(e,t){return Math.max(e,t)}))},e.MoveSlideById=function(t,n,i,r,o,s){var a=t.filter((function(e){return e.slideID.slideSid===i.slideSid&&e.slideID.slideCid===i.slideCid}))[0].slideOrderIndex,l=t.filter((function(e){return e.slideID.slideSid===r.slideSid&&e.slideID.slideCid===r.slideCid}))[0].slideOrderIndex;e.MoveSlideByIndex(t,n,[a],l,o,s)},e.NearestPreviousNonSourceSlide=function(e,t,n){var i=0,r=e.filter((function(e){return e.slideOrderIndex<=n&&0===t.filter((function(t){return t===e.slideOrderIndex})).length}));return 0<r.length&&0<(r=r.sort((function(e,t){return t.slideOrderIndex-e.slideOrderIndex}))).length&&(i=r[0].slideOrderIndex),i},e.NearestPreviousNonSourceSlideBySection=function(e,t,n,i){var r=t.filter((function(e){return e.sectionIndex<=i&&null!=e.slideIdList&&0<e.slideIdList.length})).sort((function(e,t){return t.sectionIndex-e.sectionIndex})),o=0;if(null!=r&&0<r.length){var s=e.filter((function(e){return 0<r.filter((function(t){return t.sectionIndex===e.sectionIndex})).length&&0===n.filter((function(t){return t===e.slideOrderIndex})).length}));0<(s=s.sort((function(e,t){return t.slideOrderIndex-e.slideOrderIndex}))).length&&(o=s[0].slideOrderIndex)}return o},e.IsSlideIdListEmpty=function(e){return null!=e&&null!=e.slideIdList&&0===e.slideIdList.length},e.IsSlideIdListNotEmpty=function(e){return null!=e&&null!=e.slideIdList&&0<e.slideIdList.length},e.isSlideIDEqual=function(e,t){return e.slideCid===t.slideCid&&e.slideSid==e.slideSid},e}();t.DataUtils=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r,o=n(40),s=n(41),a=n(1),l=n(5),d=n(43);(r=i=t.DropContainerPosition||(t.DropContainerPosition={}))[r.ContainerLeft=0]="ContainerLeft",r[r.ContainerRight=1]="ContainerRight",r[r.ContainerTop=2]="ContainerTop",r[r.ContainerBottom=3]="ContainerBottom";var c=function(){function e(e){this.m_openedFirstSlidePlaceHolder=!1,this.m_shouldScrollRootContainer=!1,this.m_draggableList=[],this.m_dropContainerList=[],this.m_hasDraggingElement=!1,this.m_dragReadyElements=[],this.m_currentDraggables=[],this.m_dragDropOperationCompletedEvent=new a.Event,this.m_dragDropMoveOverEvent=new a.Event,this.m_dragDropMoveEvent=new a.Event,this.m_dragDropOperationStartedEvent=new a.Event,this.m_dragDropVisualFactory=new d.DragDropVisualFactory(this.m_dragReadyElements),this.m_dragDropSettings=e}return e.prototype.addNewDraggable=function(e,t){var n=this,i=new s.Draggable(e,t,this.m_dragDropVisualFactory,this.m_dragDropSettings.scrollThresholdInPx);return this.m_draggableList.push(i),i.dragStartEvent.subscribe((function(e,t){n.onDragStart(t)})),i.dragMoveEvent.subscribe((function(e,t){n.onDragMove(t)})),i.dragStopEvent.subscribe((function(e,t){n.onDragStop(t),n.m_shouldScrollRootContainer=!1})),i.dragToTopEvent.subscribe((function(){n.scrollRootContainer(!0),n.m_shouldScrollRootContainer=!0})),i.dragToBottomEvent.subscribe((function(){n.scrollRootContainer(!1),n.m_shouldScrollRootContainer=!0})),i.dragToCenterEvent.subscribe((function(){n.m_shouldScrollRootContainer=!1})),i},e.prototype.onDragStop=function(e){if(this.m_hasDraggingElement){var t=[],n=[],i=this.updateInRangeContainerStatusLists(e,t,n),r=t.map((function(e){return e.objectData.dragDropObjectType})).indexOf(l.DragDropObjectType.Section);if(i){var o={draggableObjectDataList:this.m_currentDraggables.map((function(e){return e.objectData})),dropTargetObjectDataList:t.map((function(e){return e.objectData})),dropContainerPositionList:n,hasValidDropTarget:!0,sectionObjectData:-1<r?t[r].objectData:null};this.m_dragDropOperationCompletedEvent.signal(null,o)}i||this.m_dragDropOperationCompletedEvent.signal(null,{hasValidDropTarget:!1}),this.m_currentDraggables=[],this.m_hasDraggingElement=null!=this.m_dragReadyElements&&0<this.m_dragReadyElements.length,this.m_openedFirstSlidePlaceHolder=!1}},e.prototype.onDragMove=function(e){this.m_hasDraggingElement=!0;var t=[],n=[];if(this.updateInRangeContainerStatusLists(e,t,n)){var r=t.map((function(e){return e.objectData.dragDropObjectType})).indexOf(l.DragDropObjectType.Slide),o=t.map((function(e){return e.objectData.dragDropObjectType})).indexOf(l.DragDropObjectType.SlidePlaceholder),s=t.map((function(e){return e.objectData.dragDropObjectType})).indexOf(l.DragDropObjectType.Section);if(0<=r){var a=t[r].objectData;n[r]===i.ContainerLeft&&this.m_openedFirstSlidePlaceHolder&&(a=new l.ObjectData(t[r].objectData.dragDropObjectType,t[r].objectData.index+1));var d={draggableObjectData:e.objectData,hasValidDropTarget:!0,dropTargetObjectData:a,sectionObjectData:0<=s?t[s].objectData:null};this.m_dragDropMoveOverEvent.signal(null,d),this.m_openedFirstSlidePlaceHolder=!0}else o<0&&(d={draggableObjectData:e.objectData,dropTargetObjectData:t[0].objectData,hasValidDropTarget:!0,sectionObjectData:0<=s?t[s].objectData:null},this.m_dragDropMoveOverEvent.signal(null,d))}else this.m_dragDropMoveOverEvent.signal(null,{hasValidDropTarget:!1});for(var c=0;c<this.m_dragReadyElements.length;c+=1)this.m_currentDraggables.indexOf(this.m_dragReadyElements[c])<0&&this.m_currentDraggables.push(this.m_dragReadyElements[c]),this.m_dragDropMoveEvent.signal(null,{draggableObjectData:this.m_dragReadyElements[c].objectData})},e.prototype.onDragStart=function(e){this.m_dragDropOperationStartedEvent.signal(null,{draggableObjectData:e.objectData})},e.prototype.addNewDropContainer=function(e,t){var n=new o.DropContainer(e,t);return this.m_dropContainerList.push(n),n},Object.defineProperty(e.prototype,"initialDragReadyElements",{set:function(e){for(var t=this.m_draggableList.map((function(e){return e.objectData})),n=0;n<t.length;n+=1)0<=e.indexOf(t[n])&&(this.m_dragReadyElements.push(this.m_draggableList[n]),this.m_draggableList[n].isDragReady=!0);this.m_dragDropVisualFactory.dragReadyElements=this.m_dragReadyElements},enumerable:!0,configurable:!0}),e.prototype.removeDraggable=function(e){var t=-1;null!=this.m_currentDraggables&&-1!==(t=this.m_currentDraggables.indexOf(e))&&this.m_currentDraggables.splice(t,1),null!=this.m_dragReadyElements&&-1!==(t=this.m_dragReadyElements.indexOf(e))&&(this.m_dragReadyElements.splice(t,1),this.dragReadyElements=this.m_dragReadyElements),-1!==(t=this.m_draggableList.indexOf(e))&&this.m_draggableList.splice(t,1)},e.prototype.removeDropContainer=function(e){var t=this.m_dropContainerList.indexOf(e);return-1!==t&&(this.m_dropContainerList.splice(t,1),!0)},Object.defineProperty(e.prototype,"dragDropOperationCompletedEvent",{get:function(){return this.m_dragDropOperationCompletedEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragDropMoveOverEvent",{get:function(){return this.m_dragDropMoveOverEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragDropOperationStartedEvent",{get:function(){return this.m_dragDropOperationStartedEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragDropMoveEvent",{get:function(){return this.m_dragDropMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragDropRootContainer",{set:function(e){this.m_dragDropRootContainer=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragReadyElements",{get:function(){return this.m_dragReadyElements},set:function(e){this.m_dragReadyElements=e;for(var t=0;t<this.m_draggableList.length;t+=1)0<=this.m_dragReadyElements.indexOf(this.m_draggableList[t])?this.m_draggableList[t].isDragReady=!0:this.m_draggableList[t].isDragReady=!1;this.m_dragDropVisualFactory.dragReadyElements=this.m_dragReadyElements},enumerable:!0,configurable:!0}),e.prototype.updateInRangeContainerStatusLists=function(e,t,n){var i=!1;if(new l.ObjectData(l.DragDropObjectType.Slide,-1),null!=e)for(var r=0;r<this.m_dropContainerList.length;r+=1)if(void 0!==e.pageX&&void 0!==e.pageY&&this.m_dropContainerList[r].isDraggableInRange(e.pageX,e.pageY)){var o=this.m_dropContainerList[r].dropContainerPosition(e.pageX,e.pageY);i=!0,this.m_dropContainerList[r].objectData,n.push(o),t.push(this.m_dropContainerList[r])}return i},e.prototype.scrollRootContainer=function(e){var t=this,n=e?-1:1;this.m_dragDropRootContainer.scrollTop+n<=this.m_dragDropRootContainer.scrollHeight&&0<=this.m_dragDropRootContainer.scrollTop+n&&(this.m_dragDropRootContainer.scrollTop=this.m_dragDropRootContainer.scrollTop+n),this.m_shouldScrollRootContainer&&setTimeout((function(){return t.scrollRootContainer(e)}),this.m_dragDropSettings.scrollTimeoutInMs)},e}();t.DragDropManager=c},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),(i=t.SlideGridHighContrastMode||(t.SlideGridHighContrastMode={})).None="None",i.HighContrastBlack="HighContrastBlack"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r,o=n(7);(r=i=t.FocusMoveType||(t.FocusMoveType={})).None="none",r.Up="up",r.Down="down",r.Left="left",r.Right="right";var s=function(){function e(e){this.m_slideGridSettings=e}return e.prototype.handleSlideFocusMove=function(e,t,n,r,o){var s=-1;switch(e){case i.Up:s=this.handleSlideFocusMoveUp(t,n,r,o);break;case i.Down:s=this.handleSlideFocusMoveDown(t,n,r,o);break;case i.Left:s=this.handleSlideFocusMoveLeft(t);break;case i.Right:s=this.handleSlideFocusMoveRight(t,r.length)}return s},e.prototype.handleSectionFocusMove=function(e,t,n,r,o,s){var a=-1;switch(e){case i.Up:a=this.handleSectionFocusMoveUp(n,t,o,s,r);break;case i.Down:a=this.handleSectionFocusMoveDown(n,t,o,s,r);break;case i.Left:a=this.handleSectionFocusMoveLeft(n,t,o,s);break;case i.Right:a=this.handleSectionFocusMoveRight(n,t,o,s)}return a},e.prototype.handleSlideFocusMoveFromSectionFocus=function(e,t,n,r,s){return-1===t?o.DataUtils.IsSlideIdListEmpty(s[n])?-1:this.getFirstSlideInSection(r,n):-1===n?e===i.Up||e===i.Left?0<t?o.DataUtils.IsSlideIdListEmpty(s[t-1])?-1:this.getLastSlideInSection(r,t-1):-1:o.DataUtils.IsSlideIdListEmpty(s[t])?-1:this.getFirstSlideInSection(r,t):o.DataUtils.IsSlideIdListEmpty(s[n])?-1:this.getFirstSlideInSection(r,n)},e.prototype.handleSlideFocusMoveUp=function(e,t,n,i){if(e<0||t<1||null==n||n.length<=0||e>=n.length)return-1;var r=e-t;if(1===t&&!this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering)return 0<=r?r:0;var o=n.filter((function(t){return t.sectionIndex===n[e].sectionIndex}));if(null==o||o.length<=0)return-1;var s=e>=o[0].slideOrderIndex&&e<o[0].slideOrderIndex+t,a=n[e].sectionIndex<=0;if(s){if(a)return e;var l=this.nextNonEmptySectionIndex(!0,i,n[e].sectionIndex);if(-1===l)return e;var d=n.filter((function(e){return e.sectionIndex===l})).length,c=Math.ceil(d/t)*t-d;if(null!=n[r+=c]&&n[r].sectionIndex===l)return r;var u=n.filter((function(e){return e.sectionIndex===l}));return u[u.length-1].slideOrderIndex}return r},e.prototype.handleSlideFocusMoveDown=function(e,t,n,i){if(e<0||t<1||null==n||n.length<=0||e>=n.length)return-1;var r=e+t;if(1===t)return r<n.length?r:n.length-1;var o=n.filter((function(t){return t.sectionIndex===n[e].sectionIndex}));if(null==o||o.length<=0)return-1;var s=this.isSlideInSectionLastRow(e,o[0].slideOrderIndex,o.length,t),a=n[e].sectionIndex>=i.length-1;if(s){if(a)return e;r-=o.length>t?t-o.length%t:t-o.length;var l=this.nextNonEmptySectionIndex(!1,i,n[e].sectionIndex);if(-1===l)return e;if(null!=n[r]&&n[r].sectionIndex===l)return r;var d=n.filter((function(e){return e.sectionIndex===l}));return d[d.length-1].slideOrderIndex}return null!=n[r]&&n[r].sectionIndex===n[e].sectionIndex?r:o[o.length-1].slideOrderIndex},e.prototype.handleSlideFocusMoveLeft=function(e){return e<0?-1:0<e?e-1:0},e.prototype.handleSlideFocusMoveRight=function(e,t){return e<0?-1:e<t-1?e+1:t-1},e.prototype.handleSectionFocusMoveUp=function(e,t,n,i,r){if(null===n||0===n.length||null==i||0===i.length||r<0)return-1;if(-1===t)return 0===e?e:o.DataUtils.IsSlideIdListEmpty(i[e-1])?e-1:-1;var s=n.filter((function(e){return e.sectionIndex===n[t].sectionIndex}));if(null==s||s.length<=0)return-1;var a=t>=s[0].slideOrderIndex&&t<s[0].slideOrderIndex+r,l=0===e;return-1===e?a?n[t].sectionIndex:-1:e===n[t].sectionIndex?l?e:o.DataUtils.IsSlideIdListEmpty(i[e-1])?e-1:-1:-1},e.prototype.handleSectionFocusMoveDown=function(e,t,n,i,r){if(null===n||0===n.length||null==i||0===i.length||r<0)return-1;if(-1===t)return e===i.length-1?e:e+1;var s=n.filter((function(e){return e.sectionIndex===n[t].sectionIndex}));if(null==s||s.length<=0)return-1;var a=this.isSlideInSectionLastRow(t,s[0].slideOrderIndex,s.length,r),l=n[t].sectionIndex,d=l>=i.length-1;return-1===e?a?d?-1:l+1:-1:e===n[t].sectionIndex||o.DataUtils.IsSlideIdListEmpty(i[e])?d?e:o.DataUtils.IsSlideIdListEmpty(i[e+1])||o.DataUtils.IsSlideIdListEmpty(i[e])?e+1:-1:-1},e.prototype.handleSectionFocusMoveRight=function(e,t,n,i){if(null===n||0===n.length||null==i||0===i.length)return-1;if(-1===t)return e===i.length-1?e:e+1;if(-1!==e)return o.DataUtils.IsSlideIdListNotEmpty(i[e])?-1:e<i.length-1?e+1:-1;var r=n[t].sectionIndex;return t===this.getLastSlideInSection(n,r)&&r<i.length-1?r+1:-1},e.prototype.handleSectionFocusMoveLeft=function(e,t,n,i){if(null===n||0===n.length||null==i||0===i.length)return-1;if(t<0)return 0===e?e:o.DataUtils.IsSlideIdListEmpty(i[e-1])?e-1:-1;var r=n[t].sectionIndex;return-1!==e?0===e?0:o.DataUtils.IsSlideIdListEmpty(i[e-1])?e-1:-1:t===this.getFirstSlideInSection(n,r)?n[t].sectionIndex:-1},e.prototype.nextNonEmptySectionIndex=function(e,t,n){for(var i=e?-1:t.length,r=e?-1:1,s=n+r;s!==i;s+=r)if(o.DataUtils.IsSlideIdListNotEmpty(t[s]))return s;return-1},e.prototype.getFirstSlideInSection=function(e,t){return e.filter((function(e){return e.sectionIndex===t})).map((function(e){return e.slideOrderIndex})).sort((function(e,t){return e-t}))[0]},e.prototype.getLastSlideInSection=function(e,t){var n=e.filter((function(e){return e.sectionIndex===t})).map((function(e){return e.slideOrderIndex}));return n.sort((function(e,t){return e-t}))[n.length-1]},e.prototype.isSlideInSectionLastRow=function(e,t,n,i){var r=!1;if(i<=0||e<0||t<0||n<=0)return!1;if(n<=i)return!0;var o,s=(n-n%i)/i;return(o=n%i==0?t+i*(s-1):t+i*s)<=e&&o<t+n&&(r=!0),r},e}();t.SlideGridFocusMoveUtils=s},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(21),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(22))},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,r=n;return[r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]]].join("")}},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(35),a=n(0),l=function(e){function t(t,n,i,r){var o=e.call(this,t)||this;return o._events=r,o._view=new s.GridContentBoundaryView(t,n,i),new a.ViewModelBinding(o,"isSelected").addBinding({target:o._view}),new a.ViewModelBinding(o,"slideIndex").addBinding({target:o._view}),new a.ViewModelBinding(o,"shouldDisplaySection").addBinding({target:o._view}),new a.ViewModelBinding(o,"isVisible").addBinding({target:o._view}),o._view.onViewClick.subscribe((function(e,t){o._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:t.insertIndex})})),o}return r(t,e),t}(o.ViewModel);t.GridContentBoundaryViewModel=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(50);var i=n(17),r=function(){function e(){}return e.CreateSlideGrid=function(e,t){return new i.SlideGrid(e,t)},e}();t.SlideGridFactory=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(18),r=n(44),o=n(8),s=n(5),a=n(12),l=n(11),d=function(){function e(e,t){if(e.disabledChangeGates&&a.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),l.Settings.load(e.settings?e.settings.slidegrid:{}),this._parent=t,this._events=new r.SlideGridEvents,this.slideGridSettings=e,this.slideGridSettings.allowMoveSlide){var n={scrollThresholdInPx:e.dragDropScrollThresholdInPx,scrollTimeoutInMs:e.dragDropScrollTimeoutInMs};this.m_dragDropManager=new o.DragDropManager(n)}this._sectionListViewModel=new i.SectionListViewModel(this.slideGridSettings,this._parent,this._events,this.m_dragDropManager)}return e.prototype.show=function(e,t,n,i){if(null!=this._sectionListViewModel){if(null!=n&&(this._sectionListViewModel.slideDataList=n),null!=i&&(this._sectionListViewModel.sectionDataList=i,this._events.onVisibleSlideRangeChanged.signal(null,null)),0<=e.length&&(this._sectionListViewModel.currentSelectedSlideIndexes=e,this._sectionListViewModel.activeFocusSlideIndex=t),this.slideGridSettings.allowMoveSlide){var r=e.map((function(e){return new s.ObjectData(s.DragDropObjectType.Slide,e)}));this.m_dragDropManager.initialDragReadyElements=r}this._sectionListViewModel.shouldDisplayCollabMarkersHint=!1}},Object.defineProperty(e.prototype,"presenceInfoList",{get:function(){return this._sectionListViewModel.presenceInfoList},set:function(e){this._sectionListViewModel.presenceInfoList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedSectionIndex",{set:function(e){this._sectionListViewModel.currentSelectedSectionIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editableSectionTitleIndex",{set:function(e){this._sectionListViewModel.currentEditableSectionIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldDisplaySections",{set:function(e){this._sectionListViewModel.shouldDisplaySections=e},enumerable:!0,configurable:!0}),e.prototype.restoreFocusToGrid=function(){this._sectionListViewModel.activeFocusSlideIndex=this._sectionListViewModel.activeFocusSlideIndex},Object.defineProperty(e.prototype,"slideDataList",{get:function(){return this._sectionListViewModel.slideDataList},set:function(e){this._sectionListViewModel.slideDataList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sectionDataList",{get:function(){return this._sectionListViewModel.sectionDataList},set:function(e){this._sectionListViewModel.sectionDataList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleSlideRange",{get:function(){return this._sectionListViewModel.visibleSlideRange},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeFocusSlideIndex",{set:function(e){this._sectionListViewModel.activeFocusSlideIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedSlideIndexes",{get:function(){return this._sectionListViewModel.currentSelectedSlideIndexes},set:function(e){this._sectionListViewModel.currentSelectedSlideIndexes=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"insertBetweenSlideIndex",{set:function(e){this._sectionListViewModel.insertBetweenSlidesIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highContrastMode",{get:function(){return this._sectionListViewModel.highContrastMode},set:function(e){this._sectionListViewModel.highContrastMode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedSlidesContentAreaRect",{get:function(){return this._sectionListViewModel.selectedSlidesContentAreaRect},enumerable:!0,configurable:!0}),e}();t.SlideGrid=d},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(19),s=n(25),a=n(4),l=n(6),d=n(0),c=n(9),u=n(10),g=n(7),p=n(8),h=n(5),m=function(e){function t(t,n,i,r){var s=e.call(this,n)||this;return s._highContrastMode=c.SlideGridHighContrastMode.None,s._events=i,s.m_slideGridSettings=t,s.m_slideGridFocusMoveUtils=new u.SlideGridFocusMoveUtils(s.m_slideGridSettings),s.m_dragDropManager=r,s._view=new o.SectionListView(s.m_slideGridSettings,n),s._sectionViewModelList=[],new d.ViewModelBinding(s,"highContrastMode").addBinding({target:s._view}),null!=s.m_slideGridSettings.highContrastMode&&(s.highContrastMode=s.m_slideGridSettings.highContrastMode),s._view.onViewAreaChanged.subscribe((function(){s.visibleSlideRange,i.onVisibleSlideRangeChanged.signal(null,null)})),s._view.onViewScrolled.subscribe((function(){i.onSlideGridScrolled.signal(null,null)})),s._events.onMoveSlide.subscribe((function(e,t){var n=t.dragStartIndexes,i=t.dropTargetIndex,r=null!=t.sectionIndex?t.sectionIndex:-1,o=!0;void 0!==t.shouldInsertSlideAfter&&(o=t.shouldInsertSlideAfter);var a=g.DataUtils.MoveSlideByIndex(s._slideDataList,s._sectionDataList,n,i,r,o);s.slideDataList=s._slideDataList,s.sectionDataList=s._sectionDataList,s._currentSelectedSlideIndexes=a})),s._events.onSlideSelectionChanged.subscribe((function(e,n){var i=n.slideIndex;if(s.m_slideGridSettings.allowMultipleSelect&&n.isSelectingMultiple){if(!(0<=s._currentSelectedSlideIndexes.indexOf(n.slideIndex)&&n.slideSelectionTrigger===l.SlideSelectionTrigger.MouseDown)){if(n.isSelectingRange){s._currentSelectedSlideIndexes=[];var r=s.activeFocusSlideIndex<=i?s.activeFocusSlideIndex:i,o=s.activeFocusSlideIndex<=i?i:s.activeFocusSlideIndex;n.slideSelectionTrigger===l.SlideSelectionTrigger.CtrlAKey&&(r=0,o=s.slideDataList.length-1);for(var a=r;a<=o;a+=1)s._currentSelectedSlideIndexes.push(a);s.m_shiftArrowKeyFocusIndex=i}else s._currentSelectedSlideIndexes.indexOf(i)<0&&s._currentSelectedSlideIndexes.push(i);s.currentSelectedSlideIndexes=s._currentSelectedSlideIndexes}}else 0<=s._currentSelectedSlideIndexes.indexOf(n.slideIndex)&&n.slideSelectionTrigger===l.SlideSelectionTrigger.MouseDown&&!n.isSelectingRange||(s.currentSelectedSlideIndexes=[i]);n.isSelectingRange&&1!==s._currentSelectedSlideIndexes.length||(s.activeFocusSlideIndex=i),(s.m_slideGridSettings.enableRevisionTrackingInfo||s.m_slideGridSettings.isDisplayPresenceIcon)&&(n.slideSelectionTrigger!==l.SlideSelectionTrigger.ActiveSlideChange&&n.slideSelectionTrigger!==l.SlideSelectionTrigger.ActiveSectionChange||n.isSelectingRange||1!==s._currentSelectedSlideIndexes.length||-1!==s.currentActiveSectionIndex?s.shouldDisplayCollabMarkersHint=!1:s.shouldDisplayCollabMarkersHint=!0),n.slideSelectionTrigger!==l.SlideSelectionTrigger.ActiveSectionChange&&(s.currentActiveSectionIndex=-1),t.enableSelectionBetweenSlides&&(s.insertBetweenSlidesIndex=-1,s._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:-1})),n.isSelectingRange||(s.m_shiftArrowKeyFocusIndex=-1)})),s._events.onSectionSelectionChanged.subscribe((function(e,n){n.clickedAway?(s._sectionViewModelList.forEach((function(e){e.isSelected=!1})),s.currentActiveSectionIndex=-1):(s._sectionViewModelList.forEach((function(e){e.isSelected=e.sectionIndex===n.sectionIndex})),s.currentActiveSectionIndex=n.sectionIndex),t.enableSelectionBetweenSlides&&(n.clickedAway||(s.insertBetweenSlidesIndex=-1,s._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:-1})))})),s.m_slideGridSettings.enableSelectionBetweenSlides&&s._events.onInsertBetweenSlidesPositionChanged.subscribe((function(e,t){s.insertBetweenSlidesIndex=t.insertIndex,-1!==s.insertBetweenSlidesIndex&&(s.currentSelectedSlideIndexes=[],s.activeFocusSlideIndex=-1)})),s._view.onCurrentActiveFocusChanged.subscribe((function(e,t){s.currentActiveFocusChangedHandler(t)})),s._view.onEnterKey.subscribe((function(){s._events.onSlideSelectionChanged.signal(null,{slideIndex:s.activeFocusSlideIndex,slideSelectionTrigger:l.SlideSelectionTrigger.EnterKey})})),s._view.onCtrlAkey.subscribe((function(){s._events.onSlideSelectionChanged.signal(null,{slideIndex:s.activeFocusSlideIndex,slideSelectionTrigger:l.SlideSelectionTrigger.CtrlAKey,isSelectingRange:s.m_slideGridSettings.allowMultipleSelect,isSelectingMultiple:s.m_slideGridSettings.allowMultipleSelect})})),s._view.onShiftArrowKey.subscribe((function(e,t){try{if(!t||t.focusMoveType===u.FocusMoveType.Up||t.focusMoveType===u.FocusMoveType.Down)return;var n,i=-1===s.m_shiftArrowKeyFocusIndex?s.activeFocusSlideIndex:s.m_shiftArrowKeyFocusIndex;n=t.focusMoveType===u.FocusMoveType.Left?0===i?i:i-1:i===s._slideDataList.length-1?i:i+1,s._events.onSlideSelectionChanged.signal(null,{slideIndex:n,slideSelectionTrigger:l.SlideSelectionTrigger.ArrowKey,isSelectingRange:s.m_slideGridSettings.allowMultipleSelect,isSelectingMultiple:s.m_slideGridSettings.allowMultipleSelect})}catch(e){return}})),s.m_slideGridSettings.allowMoveSlide&&(s.m_dragDropManager.dragDropOperationCompletedEvent.subscribe((function(e,t){s.dragDropOperationCompletedHandler(t)})),s.m_dragDropManager.dragDropRootContainer=s._view.container),s._events.onActiveSectionFocusChanged.subscribe((function(e,t){var n=t.currentActiveFocusSectionIndex;if(-1!==n&&0<s.sectionDataList[n].slideIdList.length){var i=s.slideDataList.filter((function(e){return e.sectionIndex===n})).map((function(e){return e.slideOrderIndex}));0<i.length&&(s.currentSelectedSlideIndexes=i)}})),s}return r(t,e),Object.defineProperty(t.prototype,"currentSelectedSectionIndex",{set:function(e){this.currentActiveSectionIndex=e,this._sectionViewModelList.forEach((function(t){t.isSelected=t.sectionIndex===e}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentEditableSectionIndex",{set:function(e){e<0||e>=this._sectionViewModelList.length||(this._sectionViewModelList[e].titleEditMode=!0,this._currentEditableSectionIndex=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldDisplaySections",{get:function(){return this.m_shouldDisplaySections},set:function(e){this._sectionViewModelList.forEach((function(t){t.shouldDisplaySection=e})),this.m_shouldDisplaySections=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"presenceInfoList",{get:function(){return this.presenceInfoList},set:function(e){this.m_slideGridSettings.isDisplayPresenceIcon&&(this._presenceInfoList=e,this._sectionViewModelList.forEach((function(t){var n=t.slideDataList.map((function(e){return e.slideID}));t.presenceInfoList=e.filter((function(e){return n.some((function(t){return g.DataUtils.isSlideIDEqual(e.slideID,t)}))}))})))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"slideDataList",{get:function(){return this._slideDataList},set:function(e){var t=this;this._slideDataList=e,this._sectionViewModelList.forEach((function(e){e.slideDataList=t._slideDataList.filter((function(t){return t.sectionIndex===e.sectionIndex})),e.totalSlideCount=t._slideDataList.length}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sectionDataList",{get:function(){return this._sectionDataList},set:function(e){var t=this;this._sectionDataList=e;var n=0;this._currentSelectedSlideIndexesVMDB=new d.ViewModelBinding(this,"currentSelectedSlideIndexes"),this._activeFocusSlideIndexVMDB=new d.ViewModelBinding(this,"activeFocusSlideIndex"),(this.m_slideGridSettings.enableRevisionTrackingInfo||this.m_slideGridSettings.isDisplayPresenceIcon)&&(this._shouldDisplayCollabMarkersHintVMDB=new d.ViewModelBinding(this,"shouldDisplayCollabMarkersHint")),this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&(this._currentActiveSectionIndexVMDB=new d.ViewModelBinding(this,"currentActiveSectionIndex")),this.m_slideGridSettings.enableSelectionBetweenSlides&&(this._insertBetweenSlidesIndexVMDB=new d.ViewModelBinding(this,"insertBetweenSlidesIndex")),this._activeFocusSlideIndexVMDB.addBinding({target:this._view,onValueChanged:function(){t.m_shiftArrowKeyFocusIndex=-1}}),this._sectionDataList.forEach((function(e){var i;null==t._sectionViewModelList[n]?(i=new s.SectionViewModel(t.m_slideGridSettings,t._view.container,t._events,t.m_dragDropManager),t._sectionViewModelList.push(i)):i=t._sectionViewModelList[n],i.sectionTitle=e.sectionTitle,i.sectionIndex=e.sectionIndex,i.slideDataList=t._slideDataList.filter((function(t){return t.sectionIndex===e.sectionIndex})),t._currentSelectedSlideIndexesVMDB.addBinding({target:i}),t._activeFocusSlideIndexVMDB.addBinding({target:i}),t.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&t._currentActiveSectionIndexVMDB.addBinding({target:i}),t.m_slideGridSettings.enableSelectionBetweenSlides&&t._insertBetweenSlidesIndexVMDB.addBinding({target:i}),(t.m_slideGridSettings.enableRevisionTrackingInfo||t.m_slideGridSettings.isDisplayPresenceIcon)&&t._shouldDisplayCollabMarkersHintVMDB.addBinding({target:i}),n+=1,t.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&i.onCurrentActiveSectionChanged.subscribe((function(e,n){n.hasFocus?t.currentActiveSectionIndex=n.sectionIndex:t.currentActiveSectionIndex=-1}))})),this._sectionViewModelList.length>n&&(this._sectionViewModelList.slice(n).forEach((function(e){e.dispose()})),this._sectionViewModelList=this._sectionViewModelList.slice(0,n))},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._sectionViewModelList=[]},Object.defineProperty(t.prototype,"visibleSlideRange",{get:function(){var e=this,t=[];return this._sectionViewModelList.forEach((function(n){var i=e._view.renderAreaRect,r=n.getVisibleSlideRange(i);t=t.concat(r)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedSlidesContentAreaRect",{get:function(){var e=[];return this._sectionViewModelList.forEach((function(t){var n=t.getSelectedSlidesContentAreaRect();e=e.concat(n)})),e},enumerable:!0,configurable:!0}),t.prototype.currentActiveFocusChangedHandler=function(e){var t=e.focusMoveType;this.m_slideGridSettings.isRTL&&(t===u.FocusMoveType.Left?t=u.FocusMoveType.Right:t===u.FocusMoveType.Right&&(t=u.FocusMoveType.Left));var n=this.activeFocusSlideIndex,i=!1;if(this.m_slideGridSettings.enableSelectionBetweenSlides){if(this.insertBetweenSlidesIndex===this.slideDataList.length&&(t===u.FocusMoveType.Down||t===u.FocusMoveType.Right)&&this.slideDataList[this.slideDataList.length-1].sectionIndex===this.sectionDataList[this.sectionDataList.length-1].sectionIndex)return;this.activeFocusSlideIndex<0&&0<=this.insertBetweenSlidesIndex&&(n=0===this.insertBetweenSlidesIndex?0:this.insertBetweenSlidesIndex-1,i=!0)}var r=n;if(!i||t!==u.FocusMoveType.Left||0===r){if(this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&this.shouldDisplaySections){var o=void 0===this.currentActiveSectionIndex?-1:this.currentActiveSectionIndex,s=o,a=this.m_slideGridFocusMoveUtils.handleSectionFocusMove(t,n,o,this.slideCapacityPerRow,this.slideDataList,this.sectionDataList);if(this.currentActiveSectionIndex=a,this.currentActiveSectionIndex!==s||0===this.currentActiveSectionIndex||this.currentActiveSectionIndex===this.sectionDataList.length-1){var d=this.m_slideGridFocusMoveUtils.handleSlideFocusMoveFromSectionFocus(t,s,this.currentActiveSectionIndex,this.slideDataList,this.sectionDataList);return this._events.onSlideSelectionChanged.signal(null,{slideIndex:d,slideSelectionTrigger:l.SlideSelectionTrigger.ActiveSectionChange}),this._events.onSectionSelectionChanged.signal(null,{clickedAway:this.currentActiveSectionIndex<0,sectionSelectionTrigger:l.SectionSelectionTrigger.ActiveSectionChange,sectionIndex:this.currentActiveSectionIndex}),void this._events.onActiveSectionFocusChanged.signal(null,{currentActiveFocusSectionIndex:this.currentActiveSectionIndex,newActiveSlideIndex:d})}}r=this.m_slideGridFocusMoveUtils.handleSlideFocusMove(t,n,this.slideCapacityPerRow,this.slideDataList,this.sectionDataList)}-1<r&&(this.m_slideGridSettings.enableTriggerSelectionFromActiveSlideChange?this._events.onSlideSelectionChanged.signal(null,{slideIndex:r,slideSelectionTrigger:l.SlideSelectionTrigger.ActiveSlideChange}):this.activeFocusSlideIndex=r)},t.prototype.dragDropOperationCompletedHandler=function(e){if(e.hasValidDropTarget){if(1===e.dropTargetObjectDataList.length&&e.dropTargetObjectDataList[0].dragDropObjectType===h.DragDropObjectType.Section){var t=this._sectionViewModelList[e.dropTargetObjectDataList[0].index],n=null==t.slideDataList||0===t.slideDataList.length;if(e.dropTargetObjectDataList[0].dragDropObjectType===h.DragDropObjectType.Section)if(n){var i=e.draggableObjectDataList.map((function(e){return e.index})),r=e.dropTargetObjectDataList[0].index;this.handleDragDropIntoEmptySection(i,r)}else{var o=e.draggableObjectDataList.map((function(e){return e.index})),s=t.slideDataList[t.slideDataList.length-1].slideOrderIndex,a=g.DataUtils.NearestPreviousNonSourceSlide(this._slideDataList,o,s),l=!0;r=0<=t.sectionIndex?t.sectionIndex:-1,this._events.onMoveSlide.signal(null,{dropTargetIndex:a,dragStartIndexes:o,sectionIndex:r,shouldInsertSlideAfter:l})}}else{for(var d=-1,c=0;c<e.dropTargetObjectDataList.length;c+=1)e.dropTargetObjectDataList[c].dragDropObjectType===h.DragDropObjectType.Section&&(d=c);if(-1===d)return;for(c=0;c<e.dropTargetObjectDataList.length;c+=1)if(e.dropTargetObjectDataList[c].dragDropObjectType===h.DragDropObjectType.Slide||e.dropTargetObjectDataList[c].dragDropObjectType===h.DragDropObjectType.SlidePlaceholder){o=e.draggableObjectDataList.map((function(e){return e.index})),a=e.dropTargetObjectDataList[c].index;var u=g.DataUtils.isFirstSlideOfSection(this.slideDataList,a),m=e.dropTargetObjectDataList[d].index;if(l=void 0,e.dropTargetObjectDataList[c].dragDropObjectType===h.DragDropObjectType.SlidePlaceholder){var _=a-1;l=null!=this.slideDataList[_],null!=this.slideDataList[_]&&(a=_)}else l=!(u&&e.dropContainerPositionList[c]===p.DropContainerPosition.ContainerLeft);a=g.DataUtils.NearestPreviousNonSourceSlide(this._slideDataList,o,a),this._events.onMoveSlide.signal(null,{dropTargetIndex:a,dragStartIndexes:o,sectionIndex:m,shouldInsertSlideAfter:l});break}}this.currentSelectedSlideIndexes=this._currentSelectedSlideIndexes,this.activeFocusSlideIndex=this._currentSelectedSlideIndexes[0]}},t.prototype.handleDragDropIntoEmptySection=function(e,t){if(null!=this._sectionDataList[t]&&(null==!this._sectionDataList[t].slideIdList||0===this._sectionDataList[t].slideIdList.length)){var n=g.DataUtils.NearestPreviousNonSourceSlideBySection(this._slideDataList,this._sectionDataList,e,t);this._events.onMoveSlide.signal(null,{dragStartIndexes:e,dropTargetIndex:n,sectionIndex:t,shouldInsertSlideAfter:0<n})}},Object.defineProperty(t.prototype,"slideCapacityPerRow",{get:function(){for(var e=this._view.renderAreaRect,t=-1,n=0,i=this._sectionViewModelList;n<i.length&&!(0<(t=i[n].getSlideCapacityPerRow(e)));n++);return t},enumerable:!0,configurable:!0}),t}(a.ViewModel);t.SectionListViewModel=m},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(2),a=n(20),l=n(9),d=n(10),c=n(0),u=n(11),g=n(12),p=n(3),h=function(e){function t(t,n){var i=e.call(this,n)||this;i.visibleStyleClassName="section-list-view-visible-class",i.hiddenStyleClassName="section-list-view-hidden-class",i.rtlStyleClassName="rtl-class",i.displayHorizontalStyleClassName="display-horizontal-class",i.highContrastBlackModeClassName="slidegrid-high-contrast-black",i._elementId="section-list-view-id"+p.v4(),i._highContrastMode=l.SlideGridHighContrastMode.None,i._container.id=i._elementId,i._container.classList.add(i.visibleStyleClassName),i._onViewAreaChanged=new o.Event,i._onViewScrolled=new o.Event,i._onCurrentActiveFocusChanged=new o.Event,i._onEnterKey=new o.Event,i._onCtrlAKey=new o.Event,i._onShiftArrowKey=new o.Event,i.slideGridSettings=t,i.slideGridSettings.isRTL&&i._container.classList.add(i.rtlStyleClassName),i.slideGridSettings.isDisplayHorizontal&&i._container.classList.add(i.displayHorizontalStyleClassName),new c.ViewBinding(i,"highContrastMode").addBinding({element:i._parent,onValueChanged:i.handleHighContrastModeChange.bind(i)});var r=function(e){null!=e&&e.preventDefault(),i._onViewAreaChanged.signal(null,null)};return t.isMobileScreenReader?(i._container.setAttribute("role","menu"),i._container.setAttribute("aria-label",t.mobileThumbnailSlideAriaLabel)):i._container.setAttribute("role","listbox"),i._container.addEventListener("scroll",a.EventThrottlerFactory.CreateThrottler(r,i.slideGridSettings.throttleTimeoutInMs).bind(i)),i._container.addEventListener("scroll",a.EventDebouncerFactory.CreateDebouncer(r,i.slideGridSettings.debounceWaitTimeInMs).bind(i)),g.ChangeGate.isChangeGateEnabled("SG.FrequentScrollEvent")&&i._container.addEventListener("scroll",a.EventThrottlerFactory.CreateThrottler((function(e){null!=e&&e.preventDefault(),i._onViewScrolled.signal(null,null)}),u.Settings.readNumberOrDefault("gridViewScrollThrottleTimeoutMs",100)).bind(i)),window.addEventListener("resize",a.EventThrottlerFactory.CreateThrottler(r,i.slideGridSettings.throttleTimeoutInMs).bind(i)),window.addEventListener("resize",a.EventDebouncerFactory.CreateDebouncer(r,i.slideGridSettings.debounceWaitTimeInMs).bind(i)),i._container.addEventListener("keydown",(function(e){var t=e.key.toLowerCase(),n=e.shiftKey,r=e.ctrlKey;switch(t){case"up":case"arrowup":e.preventDefault(),i._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Up});break;case"down":case"arrowdown":e.preventDefault(),i._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Down});break;case"left":case"arrowleft":e.preventDefault(),n&&i.slideGridSettings.allowMultipleSelect?i._onShiftArrowKey.signal(null,{focusMoveType:d.FocusMoveType.Left}):i._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Left});break;case"right":case"arrowright":e.preventDefault(),n&&i.slideGridSettings.allowMultipleSelect?i._onShiftArrowKey.signal(null,{focusMoveType:d.FocusMoveType.Right}):i._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Right});break;case"enter":e.preventDefault(),i._onEnterKey.signal(null,null);break;case"a":e.preventDefault(),r&&i.slideGridSettings.allowMultipleSelect&&i._onCtrlAKey.signal(null,null);break;case"tab":if(i.slideGridSettings.allowDefaultTabBehavior)break;e.preventDefault()}})),i.slideGridSettings.isDisplayHorizontal&&i.slideGridSettings.allowHorizontalScrollWithMouseWheel&&i._container.addEventListener("wheel",(function(e){var t=e.deltaY<0&&0<i._container.scrollLeft,n=0<e.deltaY&&i._container.scrollLeft<i._container.scrollWidth-i._container.clientWidth;(t||n)&&(e.preventDefault(),i._container.scrollLeft+=e.deltaY)})),i}return r(t,e),Object.defineProperty(t.prototype,"onViewAreaChanged",{get:function(){return this._onViewAreaChanged},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onViewScrolled",{get:function(){return this._onViewScrolled},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onCurrentActiveFocusChanged",{get:function(){return this._onCurrentActiveFocusChanged},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onEnterKey",{get:function(){return this._onEnterKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onCtrlAkey",{get:function(){return this._onCtrlAKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onShiftArrowKey",{get:function(){return this._onShiftArrowKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderAreaRect",{get:function(){var e=this._parent.getBoundingClientRect();return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}},enumerable:!0,configurable:!0}),t.prototype.handleHighContrastModeChange=function(e){switch(e){case l.SlideGridHighContrastMode.None:this._parent.classList.remove(this.highContrastBlackModeClassName),this._container.classList.remove(this.highContrastBlackModeClassName);break;case l.SlideGridHighContrastMode.HighContrastBlack:this._parent.classList.add(this.highContrastBlackModeClassName),this._container.classList.add(this.highContrastBlackModeClassName)}},t}(s.View);t.SectionListView=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.CreateThrottler=function(e,t){var n=0;return function(i){(0===n||n+t-Date.now()<0)&&(e(i),n=Date.now())}},e}();t.EventThrottlerFactory=i;var r=function(){function e(){}return e.CreateDebouncer=function(e,t){var n;return function(i){clearTimeout(n),n=setTimeout((function(){e(i)}),t)}},e}();t.EventDebouncerFactory=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Settings=void 0;var i=function(){function e(){}return e.load=function(t){for(var n in t)e.m_settings[n]=t[n]},e.readBooleanOrDefault=function(t,n){var i=void 0===e.m_settings?"":typeof e.m_settings[t];return"string"===i?"true"===e.m_settings[t].toLowerCase():"boolean"===i?e.m_settings[t]:n},e.readNumberOrDefault=function(t,n){var i=void 0===e.m_settings?"":typeof e.m_settings[t];return"string"===i||"number"===i?Number(e.m_settings[t]):n},e.readStringOrDefault=function(t,n){return void 0===e.m_settings||"string"!=typeof e.m_settings[t]?n:e.m_settings[t]},e.addOrUpdateSettingsFromUrl=function(t,n){var i=n.get("wdset");if(!i)return t;for(var r=0,o=i.split(",");r<o.length;r++){var s=o[r].split(":"),a=s[0].split("."),l=a[0],d=a[1],c=s[1];d&&c&&e.addOrUpdateSetting(t,l,d,c)}return t},e.addOrUpdateSetting=function(e,t,n,i){e[t]||(e[t]={}),e[t][n]=i},e.m_settings={},e}();t.Settings=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.initSettings=function(e){e.disabledChangeGates&&(this.m_disabledChangeGateList=e.disabledChangeGates.split(";"))},e.isChangeGateEnabled=function(e){return!!e&&(!this.m_disabledChangeGateList||this.m_disabledChangeGateList.indexOf(e)<0)},e.m_disabledChangeGateList=[""],e}();t.ChangeGate=i},function(e,t,n){var i,r,o=n(13),s=n(14),a=0,l=0;e.exports=function(e,t,n){var d=t&&n||0,c=t||[],u=(e=e||{}).node||i,g=void 0!==e.clockseq?e.clockseq:r;if(null==u||null==g){var p=o();null==u&&(u=i=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==g&&(g=r=16383&(p[6]<<8|p[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:l+1,_=h-a+(m-l)/1e4;if(_<0&&void 0===e.clockseq&&(g=g+1&16383),(_<0||a<h)&&void 0===e.nsecs&&(m=0),1e4<=m)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=h,r=g;var v=(1e4*(268435455&(h+=122192928e5))+(l=m))%4294967296;c[d++]=v>>>24&255,c[d++]=v>>>16&255,c[d++]=v>>>8&255,c[d++]=255&v;var f=h/4294967296*1e4&268435455;c[d++]=f>>>8&255,c[d++]=255&f,c[d++]=f>>>24&15|16,c[d++]=f>>>16&255,c[d++]=g>>>8|128,c[d++]=255&g;for(var S=0;S<6;++S)c[d+S]=u[S];return t||s(c)}},function(e,t,n){var i=n(13),r=n(14);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||r(s)}},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(26),s=n(27),a=n(0),l=n(4),d=n(1),c=n(5),u=function(e){function t(t,n,i,r){var l=e.call(this,n)||this;l.m_dragDropCompletedHandlerBound=l.dragDropCompletedHandler.bind(l),l.m_dragDropMoveOverHandlerBound=l.dragDropMoveOverHandler.bind(l),l.m_dragDropMoveHandlerBound=l.dragDropMoveHandler.bind(l),l._events=i,l.m_slideGridSettings=t,l.m_dragDropManager=r,l.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&(l.m_currentActiveSectionChangedEvent=new d.Event),l._view=new o.SectionView(t,n),l._gridListViewModel=new s.GridListViewModel(l.m_slideGridSettings,l._view.container,l._events,l.m_dragDropManager),new a.ViewModelBinding(l,"sectionTitle").addBinding({target:l._view}),new a.ViewModelBinding(l,"currentSelectedSlideIndexes").addBinding({target:l._gridListViewModel}),new a.ViewModelBinding(l,"insertBetweenSlidesIndex").addBinding({target:l._gridListViewModel}),new a.ViewModelBinding(l,"totalSlideCount").addBinding({target:l._gridListViewModel}),new a.ViewModelBinding(l,"isSelected").addBinding({target:l._view}),new a.ViewModelBinding(l,"titleEditMode").addBinding({target:l._view});var u=new a.ViewModelBinding(l,"shouldDisplaySection");u.addBinding({target:l._view}),u.addBinding({target:l._gridListViewModel}),new a.ViewModelBinding(l,"activeFocusSlideIndex").addBinding({target:l._gridListViewModel}),l.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&new a.ViewModelBinding(l,"currentActiveSectionIndex").addBinding({target:l._view});var g=new a.ViewModelBinding(l,"sectionIndex");return g.addBinding({target:l._gridListViewModel,onValueChanged:function(e){l.m_slideGridSettings.allowMoveSlide&&(l.m_dropContainer.objectData.index=e)}}),g.addBinding({target:l._view}),l.m_slideGridSettings.allowMoveSlide&&(l.m_dropContainer=l.m_dragDropManager.addNewDropContainer(l._view.container,new c.ObjectData(c.DragDropObjectType.Section,l.sectionIndex)),l.m_dragDropManager.dragDropOperationCompletedEvent.subscribe(l.m_dragDropCompletedHandlerBound),l.m_dragDropManager.dragDropMoveOverEvent.subscribe(l.m_dragDropMoveOverHandlerBound),l.m_dragDropManager.dragDropMoveEvent.subscribe(l.m_dragDropMoveHandlerBound),l.m_draggingSlideIndexes=[]),t.allowSectionEdit&&(l._view.onViewUpdateSectionTitle.subscribe((function(e,t){t&&l._events.onSectionTitleUpdate.signal(null,{sectionIndex:l.sectionIndex,sectionTitleBefore:t.sectionTitleBefore,sectionTitleAfter:t.sectionTitleAfter})})),l._view.onViewSelectSection.subscribe((function(e,t){l._events.onSectionSelectionChanged.signal(null,{clickedAway:t.clickedAway,sectionSelectionTrigger:t.sectionSelectionTrigger,sectionIndex:l.sectionIndex})}))),t.allowSectionsInKeyboardFocusOrdering&&l._view.onCurrentActiveSectionChanged.subscribe((function(e,t){l.m_currentActiveSectionChangedEvent.signal(null,t)})),l}return r(t,e),Object.defineProperty(t.prototype,"presenceInfoList",{get:function(){return this._presenceInfoList},set:function(e){this._presenceInfoList=e,this._gridListViewModel.presenceInfoList=this._presenceInfoList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldDisplayCollabMarkersHint",{get:function(){return this._shouldDisplayCollabMarkersHint},set:function(e){this._shouldDisplayCollabMarkersHint=e,this._gridListViewModel.shouldDisplayCollabMarkersHint=this._shouldDisplayCollabMarkersHint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"slideDataList",{get:function(){return this._gridListViewModel.slideDataList},set:function(e){this.m_slideGridSettings.isHideEmptySection&&0===e.length&&(this._view.shouldDisplaySection=!1),this._gridListViewModel.slideDataList=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldDisplaySection",{set:function(e){this.m_slideGridSettings.isHideEmptySection&&0===this.slideDataList.length?this._view.shouldDisplaySection=!1:this._shouldDisplaySection=e},enumerable:!0,configurable:!0}),t.prototype.getVisibleSlideRange=function(e){return this._gridListViewModel.getVisibleSlideRange(e)},t.prototype.getSlideCapacityPerRow=function(e){return this._gridListViewModel.getSlideCapacityPerRow(e)},t.prototype.getSelectedSlidesContentAreaRect=function(){return this._gridListViewModel.getSelectedSlidesContentAreaRect()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.m_slideGridSettings.allowMoveSlide&&null!=this.m_dragDropManager&&(this.m_dragDropManager.removeDropContainer(this.m_dropContainer),this.m_dragDropManager.dragDropOperationCompletedEvent.unsubscribe(this.m_dragDropCompletedHandlerBound),this.m_dragDropManager.dragDropMoveOverEvent.unsubscribe(this.m_dragDropMoveOverHandlerBound),this.m_dragDropManager.dragDropMoveEvent.unsubscribe(this.m_dragDropMoveHandlerBound))},t.prototype.dragDropMoveOverHandler=function(e,t){!t.hasValidDropTarget||null!=this.slideDataList&&this.slideDataList.length-this.m_draggingSlideIndexes.length!=0||t.dropTargetObjectData.index!==this.sectionIndex||t.dropTargetObjectData.dragDropObjectType!==c.DragDropObjectType.Section?this._view.isDragOver=!1:this._view.isDragOver=!0},t.prototype.dragDropMoveHandler=function(e,t){t.draggableObjectData&&null!=t.draggableObjectData.index&&-1===this.m_draggingSlideIndexes.indexOf(t.draggableObjectData.index)&&0<=this.slideDataList.map((function(e){return e.slideOrderIndex})).indexOf(t.draggableObjectData.index)&&this.m_draggingSlideIndexes.push(t.draggableObjectData.index)},t.prototype.dragDropCompletedHandler=function(e,t){this._view.isDragOver=!1,this.m_draggingSlideIndexes=[]},Object.defineProperty(t.prototype,"onCurrentActiveSectionChanged",{get:function(){return this.m_currentActiveSectionChangedEvent},enumerable:!0,configurable:!0}),t}(l.ViewModel);t.SectionViewModel=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),s=n(2),a=n(1),l=n(6),d=n(3),c=function(e){function t(t,n){var i=e.call(this,n)||this;return i.visibleStyleClassName="section-view-visible-class",i.sectionTitleDefaultClassName="section-view-title-default-class",i.sectionTitleEditClassName="section-view-edit-title-class",i.sectionTitleInputClassName="section-view-title-input-class",i.sectionTitleSpanClassName="section-view-title-span-class",i.sectionDragOverDivClassName="section-view-drag-over-div-class",i.sectionDragOverDivVisibleClassName="section-view-drag-over-div-visible-class",i.sectionTitleFocusStyleClassName="section-view-title-focus-class",i.sectionTitleSelectedClassName="section-view-title-selected-class",i.sectionTitleInputDblClickColorName="rgba(255, 255, 255, 0.7)",i.sectionTitleInputDblClickBorderName="1px solid rgb(200, 198, 196)",i._elementId="section-view-id"+d.v4(),i.m_slideGridSettings=t,i._container.id=i._elementId,i._container.className=i.visibleStyleClassName,i.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&(i.m_onCurrentActiveSectionChanged=new a.Event),i.createBasicSectionDom(),i.m_slideGridSettings.allowSectionEdit&&i.createSectionDomWithEdit(),i}return r(t,e),Object.defineProperty(t.prototype,"onViewUpdateSectionTitle",{get:function(){return this.m_viewUpdateSectionTitle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onViewSelectSection",{get:function(){return this.m_viewSelectSection},enumerable:!0,configurable:!0}),t.prototype.createBasicSectionDom=function(){var e=this;this.m_sectionTitleDiv=document.createElement("div"),this.m_sectionTitleSpan=document.createElement("span"),this.m_slideGridSettings.disableAutomaticTabStops||(this.m_sectionTitleSpan.tabIndex=0,this.m_sectionTitleSpan.setAttribute("aria-hidden","false")),this.m_sectionTitleDiv.className=this.sectionTitleDefaultClassName,this.m_sectionTitleDiv.appendChild(this.m_sectionTitleSpan),new o.ViewBinding(this,"sectionTitle").addBinding({element:this.m_sectionTitleSpan,attribute:"innerText",onValueChanged:function(t){e.m_sectionTitleSpan.setAttribute("aria-label",t)}}),new o.ViewBinding(this,"isSelected").addBinding({element:this.m_sectionTitleDiv,onValueChanged:function(t){t?e.m_sectionTitleDiv.classList.add(e.sectionTitleSelectedClassName):e.m_sectionTitleDiv.classList.remove(e.sectionTitleSelectedClassName)}}),new o.ViewBinding(this,"shouldDisplaySection").addBinding({element:this.m_sectionTitleDiv,onValueChanged:function(t){e.m_sectionTitleDiv.style.display=t?"block":"none",t?(e.m_sectionTitleSpan.setAttribute("aria-hidden","false"),e.m_sectionTitleSpan.setAttribute("aria-label",e._sectionTitle),e._container.setAttribute("aria-hidden","false")):(e.m_sectionTitleSpan.setAttribute("aria-hidden","true"),e._container.setAttribute("aria-hidden","true"))}}),new o.ViewBinding(this,"titleEditMode").addBinding({element:this.m_sectionTitleDiv,onValueChanged:function(t){t&&e.enableEditMode()}}),this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&new o.ViewBinding(this,"currentActiveSectionIndex").addBinding({element:this.m_sectionTitleDiv,onValueChanged:function(t){t===e.sectionIndex?(e.m_sectionTitleSpan.focus(),e.m_sectionTitleDiv.classList.add(e.sectionTitleFocusStyleClassName)):e.m_sectionTitleDiv.classList.remove(e.sectionTitleFocusStyleClassName)}}),new o.ViewBinding(this,"isDragOver").addBinding({element:this.m_sectionDragOverDiv,onValueChanged:function(t){t?e.m_sectionDragOverDiv.classList.add(e.sectionDragOverDivVisibleClassName):e.m_sectionDragOverDiv.classList.remove(e.sectionDragOverDivVisibleClassName)}}),this._container.appendChild(this.m_sectionTitleDiv),this._container.classList.add(this.visibleStyleClassName),this.m_slideGridSettings.allowMoveSlide&&(this.m_sectionDragOverDiv=document.createElement("div"),this.m_sectionDragOverDiv.className=this.sectionDragOverDivClassName,this._container.appendChild(this.m_sectionDragOverDiv))},t.prototype.updateSectionTitle=function(){this.isEmptyTitle(this.m_sectionTitleInput.value)||this.m_sectionTitleInput.readOnly?(this.m_sectionTitleSpan.innerText=this.sectionTitle,this.m_sectionTitleInput.readOnly=!0):this.setSectionTitle(),this.m_sectionTitleSpan.style.visibility="",this.m_sectionTitleInput.setAttribute("aria-hidden","true"),this.m_sectionTitleSpan.setAttribute("aria-hidden","false")},t.prototype.enableEditMode=function(){this.m_sectionTitleInput.setAttribute("aria-hidden","false"),this.m_sectionTitleSpan.setAttribute("aria-hidden","true"),this.m_sectionTitleInput.readOnly=!1,this.m_sectionTitleInput.style.background=this.sectionTitleInputDblClickColorName,this.m_sectionTitleInput.style.border=this.sectionTitleInputDblClickBorderName,this.m_sectionTitleSpan.style.visibility="hidden",""===this.m_sectionTitleInput.value&&(this.m_sectionTitleInput.value=this.sectionTitle),this.m_sectionTitleInput.select()},t.prototype.isEmptyTitle=function(e){return""===e||0===e.trim().length},t.prototype.setSectionTitle=function(){var e=this.sectionTitle;this.sectionTitle=this.m_sectionTitleInput.value,this.m_sectionTitleInput.value="",this.m_sectionTitleInput.readOnly=!0,this.m_viewUpdateSectionTitle.signal(null,{sectionTitleBefore:e,sectionTitleAfter:this.sectionTitle})},t.prototype.createSectionDomWithEdit=function(){var e=this;this.m_viewUpdateSectionTitle=new a.Event,this.m_viewSelectSection=new a.Event,this.m_sectionTitleDiv.classList.add(this.sectionTitleEditClassName),this.m_sectionTitleInput=document.createElement("input"),this.m_sectionTitleInput.className=this.sectionTitleInputClassName,this.m_sectionTitleInput.maxLength=this.m_slideGridSettings.sectionTitleMaxLength,this.m_sectionTitleInput.readOnly=!0,this.m_sectionTitleInput.style.width=this.m_slideGridSettings.slideWidth+"px",this.m_sectionTitleSpan.classList.add(this.sectionTitleSpanClassName),this.m_sectionTitleDiv.appendChild(this.m_sectionTitleInput),this.m_sectionTitleDiv.classList.remove(this.sectionTitleDefaultClassName),this.m_sectionTitleInput.setAttribute("aria-hidden","true"),this.m_sectionTitleDiv.onclick=function(){e.m_viewSelectSection.signal(null,{clickedAway:!1,sectionSelectionTrigger:l.SectionSelectionTrigger.Click})},this.m_sectionTitleDiv.oncontextmenu=function(){e.m_viewSelectSection.signal(null,{clickedAway:!1,sectionSelectionTrigger:l.SectionSelectionTrigger.RightClick})},this.m_sectionTitleDiv.onmousedown=function(){e.m_mouseDown=!0},this.m_sectionTitleDiv.onmouseup=function(){e.m_mouseDown=!1},this._container.onclick=function(t){t.target!==e.m_sectionTitleDiv&&t.target!==e.m_sectionTitleInput&&t.target!==e.m_sectionTitleSpan&&e.m_viewSelectSection.signal(null,{clickedAway:!0})},this.m_sectionTitleDiv.onfocus=function(t){t.preventDefault(),e.m_mouseDown||e.m_onCurrentActiveSectionChanged.signal(null,{hasFocus:!0,sectionIndex:e.sectionIndex})},this.m_sectionTitleDiv.onblur=function(t){t.preventDefault(),e.m_onCurrentActiveSectionChanged.signal(null,{hasFocus:!1,sectionIndex:e.sectionIndex})},this.m_sectionTitleDiv.ondblclick=function(t){t.preventDefault(),e.enableEditMode()},this.m_sectionTitleInput.onclick=function(e){e.preventDefault()},this.m_sectionTitleInput.onblur=function(t){t.preventDefault(),e.m_sectionTitleInput.style.background="",e.m_sectionTitleInput.style.border="",e.m_sectionTitleInput.readOnly||e.updateSectionTitle()},this.m_sectionTitleInput.onkeyup=function(){e.isEmptyTitle(e.m_sectionTitleInput.value)||(e.sectionTitle=e.m_sectionTitleInput.value)},this.m_sectionTitleInput.onkeydown=function(t){if(!e.m_sectionTitleInput.readOnly){if(13===t.keyCode||27===t.keyCode)e.updateSectionTitle(),e.m_sectionTitleInput.style.background="",e.m_sectionTitleInput.style.border="";else{e.isEmptyTitle(e.m_sectionTitleInput.value)||(e.sectionTitle=e.m_sectionTitleInput.value);var n=null!=e.m_sectionTitleSpan.offsetWidth?e.m_sectionTitleSpan.offsetWidth:0,i=0<n?n.toString():0,r=Number(i)+e.m_sectionTitleInput.offsetHeight,o=null!=e._container.offsetWidth?e._container.offsetWidth:-1,s=0<o?o.toString():"inf";null!=n&&r>e.m_slideGridSettings.slideWidth&&r<=Number(s)?(e.m_sectionTitleInput.style.width=r+"px",e.m_sectionTitleSpan.style.overflow=""):r<e.m_slideGridSettings.slideWidth?e.m_sectionTitleInput.style.width=e.m_slideGridSettings.slideWidth+"px":r>Number(s)&&(e.m_sectionTitleInput.style.width=s,e.m_sectionTitleSpan.style.width=s,e.m_sectionTitleSpan.style.overflow="hidden")}t.stopPropagation()}}},Object.defineProperty(t.prototype,"onCurrentActiveSectionChanged",{get:function(){return this.m_onCurrentActiveSectionChanged},enumerable:!0,configurable:!0}),t}(s.View);t.SectionView=c},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(28),s=n(29),a=n(4),l=n(38),d=n(15),c=n(5),u=n(0),g=n(7),p=n(3),h=function(e){function t(t,n,i,r){var s=e.call(this,n)||this;s._currentSelectedSlideIndexes=[],s.m_totalSlideCount=0,s.m_firstSlideIndex=-1,s.m_dragDropMoveOverHandlerBound=s.dragDropMoveOverHandler.bind(s),s.m_dragDropCompletedHandlerBound=s.dragDropCompletedHandler.bind(s),s._events=i,s.m_slideGridSettings=t,s._dragDropManager=r,s.m_slideGridSettings.allowMoveSlide&&(s.m_draggingSlideIndexList=[]),s._view=new o.GridListView(n);var a=p.v4(),l=n.getElementsByTagName("span")[0];return l&&(l.setAttribute("id",""+a),s._view.container.setAttribute("aria-labelledby",""+a)),s._gridFrameViewModelList=[],s._dragOverFrameViewModelList=[],s.m_slideGridSettings.enableSelectionBetweenSlides&&s._view.onViewClick.subscribe((function(e,t){var n=s.calculateInsertionIndex(t.clientX,t.clientY);-1!==n&&s._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:n})})),s.m_slideGridSettings.allowMoveSlide&&(s._dragDropManager.dragDropMoveOverEvent.subscribe(s.m_dragDropMoveOverHandlerBound),s._dragDropManager.dragDropOperationCompletedEvent.subscribe(s.m_dragDropCompletedHandlerBound)),s}return r(t,e),Object.defineProperty(t.prototype,"slideDataList",{get:function(){return this._slideDataList},set:function(e){var t=this;this._slideDataList=e,this.m_slideGridSettings.allowMoveSlide&&(this.m_draggingSlideIndexList=[]),0===this.sectionIndex&&0===this._slideDataList.length&&this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isVisible=!1);var n=0;if(this._slideDataList.forEach((function(e){var i,r;if(0===n&&(t.m_firstSlideIndex=e.slideOrderIndex),0===t.sectionIndex&&t.m_slideGridSettings.enableSelectionBetweenSlides&&0<t._slideDataList.length&&(null==t.m_firstSlideInFirstSectionBoundary&&(t.m_firstSlideInFirstSectionBoundary=new d.GridContentBoundaryViewModel(t._view.container,t.m_slideGridSettings,!0,t._events),new u.ViewModelBinding(t,"shouldDisplaySection").addBinding({target:t.m_firstSlideInFirstSectionBoundary}),t.m_firstSlideInFirstSectionBoundary.shouldDisplaySection=t.shouldDisplaySection,t.m_firstSlideInFirstSectionBoundary.slideIndex=0),t.m_firstSlideInFirstSectionBoundary.isVisible=!0),null==t._gridFrameViewModelList[n]){var o=void 0;if(0===n&&(o=new l.DragOverFrameViewModel(t.m_slideGridSettings,t._view.container,t._dragDropManager,e.slideOrderIndex),t._dragOverFrameViewModelList.push(o)),i=new s.GridFrameViewModel(t.m_slideGridSettings,t._view.container,t._events,t._dragDropManager),t._gridFrameViewModelList.push(i),t.m_slideGridSettings.allowMoveSlide){var a=0;0===n&&(a=1),r=new l.DragOverFrameViewModel(t.m_slideGridSettings,t._view.container,t._dragDropManager,e.slideOrderIndex+a),i.onFrameInDragState.subscribe((function(e,n){var i=n.index;t.m_draggingSlideIndexList.push(i)})),t._dragOverFrameViewModelList.push(r)}}else i=t._gridFrameViewModelList[n],t.m_slideGridSettings.allowMoveSlide&&(0===n&&(t._dragOverFrameViewModelList[n].slideIndex=e.slideOrderIndex,null!=t._dragOverFrameViewModelList[n+1]&&(t._dragOverFrameViewModelList[n+1].slideIndex=e.slideOrderIndex+1)),t._dragOverFrameViewModelList[n+1].slideIndex=e.slideOrderIndex+1);i.slideIndex=e.slideOrderIndex,i.slideID=e.slideID,i.isHiddenSlide=e.isHiddenSlide,i.contentImage=e.thumbnailImage,i.slideTitle=e.slideTitle,i.slideAriaLabel=e.slideAriaLabel,i.totalSlideCount=t.m_totalSlideCount,i.displayTransitionOrAnimationIcon=!1,i.displayCommentIcon=!1,t.m_slideGridSettings.commentsEnabled&&(i.displayCommentIcon=!1,i.numComments="",null!=e.numComments&&0<e.numComments&&(i.numComments=""+e.numComments,i.displayCommentIcon=!0)),t.m_slideGridSettings.shouldRenderAnimationOrTransitionInfo&&(i.displayTransitionOrAnimationIcon=e.hasTransitionOrAnimation),t.m_slideGridSettings.enableRevisionTrackingInfo&&(i.displayRevisionTrackingInfo=e.hasUnreadChanges),n+=1})),this._gridFrameViewModelList.length>n&&(this._gridFrameViewModelList.slice(n).forEach((function(e){e.dispose()})),this._gridFrameViewModelList=this._gridFrameViewModelList.slice(0,n),this.m_slideGridSettings.allowMoveSlide&&this._dragOverFrameViewModelList.length>n+1)){var i=0===n?0:n+1;this._dragOverFrameViewModelList.slice(i).forEach((function(e){e.dispose()})),this._dragOverFrameViewModelList=this._dragOverFrameViewModelList.slice(0,i)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"presenceInfoList",{get:function(){return this._presenceInfoList},set:function(e){this._presenceInfoList=e,this._gridFrameViewModelList.forEach((function(t){var n=e.filter((function(e){return g.DataUtils.isSlideIDEqual(e.slideID,t.slideID)}));t.presenceUserList=n.map((function(e){return e.presenceUser}))}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldDisplayCollabMarkersHint",{get:function(){return this._shouldDisplayCollabMarkersHint},set:function(e){var t=this;this._shouldDisplayCollabMarkersHint=e,this._gridFrameViewModelList.forEach((function(e){var n=e.slideIndex;e.shouldDisplayCollabMarkersHint=!(t._activeFocusSlideIndex!==n||!t._shouldDisplayCollabMarkersHint)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"insertBetweenSlidesIndex",{set:function(e){var t=this;this._gridFrameViewModelList.forEach((function(n){n.isShowingRedLine=e===n.slideIndex+1,t.m_firstSlideInFirstSectionBoundary&&(t.m_firstSlideInFirstSectionBoundary.isSelected=!1)})),0===e&&this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isSelected=!0)},enumerable:!0,configurable:!0}),t.prototype.calculateInsertionIndex=function(e,t){for(var n=this._gridFrameViewModelList.length-1;0<=n;n-=1)if(e>=this._gridFrameViewModelList[n].renderAreaRect.right&&this._gridFrameViewModelList[n].renderAreaRect.bottom>=t&&this._gridFrameViewModelList[n].renderAreaRect.top<=t)return this._slideDataList[n].slideOrderIndex+1;return-1},Object.defineProperty(t.prototype,"m_currentLastSlideOfSection",{get:function(){var e=this,t=this._slideDataList.map((function(e){return e.slideOrderIndex}));if(this.m_draggingSlideIndexList&&0<this.m_draggingSlideIndexList.length){var n=t.filter((function(t){return e.m_draggingSlideIndexList.indexOf(t)<0}));return n[n.length-1]}return t[t.length-1]},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._gridFrameViewModelList=[],this.m_slideGridSettings.allowMoveSlide&&null!=this._dragDropManager&&(this._dragDropManager.dragDropOperationCompletedEvent.unsubscribe(this.m_dragDropCompletedHandlerBound),this._dragDropManager.dragDropMoveOverEvent.unsubscribe(this.m_dragDropMoveOverHandlerBound))},t.prototype.getVisibleSlideRange=function(e){var t=this,n=[];return e.bottom-e.top<=0||e.right-e.left<=0||this._gridFrameViewModelList.forEach((function(i){var r=i.renderAreaRect;if(t.m_slideGridSettings.isDisplayHorizontal){if(r.left>e.right)return;if(r.right<e.left)return}else{if(r.top>e.bottom)return;if(r.bottom<e.top)return}n.push(i.slideID)})),n},t.prototype.getSlideCapacityPerRow=function(e){var t=-1,n=e.right-e.left;if(n<=0)return-1;for(var i=0,r=this._gridFrameViewModelList;i<r.length;i++){var o=r[i].renderAreaRect;if(null!=o){var s=o.right-o.left;if(0<(t=Math.floor(n/s)))break}}return t},t.prototype.getSelectedSlidesContentAreaRect=function(){var e=[];return this._gridFrameViewModelList.forEach((function(t){t.isSelected&&e.push(t.contentAreaRect)})),e},Object.defineProperty(t.prototype,"currentSelectedSlideIndexes",{set:function(e){var t=this;this._currentSelectedSlideIndexes=e,this._gridFrameViewModelList.forEach((function(e){var n=e.slideIndex;e.isSelected=0<=t._currentSelectedSlideIndexes.indexOf(n)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeFocusSlideIndex",{set:function(e){var t=this;this._activeFocusSlideIndex=e,this._gridFrameViewModelList.forEach((function(e){var n=e.slideIndex;e.hasActiveFocus=t._activeFocusSlideIndex===n}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"totalSlideCount",{set:function(e){this.m_totalSlideCount=e},enumerable:!0,configurable:!0}),t.prototype.dragDropCompletedHandler=function(){this._dragOverFrameViewModelList.forEach((function(e){e.isHidden=!0,e.isShowingDragOverRedLine=!1}))},t.prototype.dragDropMoveOverHandler=function(e,t){var n=this;if(t.hasValidDropTarget){var i=t.dropTargetObjectData.index;if(t.dropTargetObjectData.dragDropObjectType!==c.DragDropObjectType.Section)for(var r=0;r<this._dragOverFrameViewModelList.length;r+=1){var o=i===this._dragOverFrameViewModelList[r].slideIndex&&null!=t.sectionObjectData&&t.sectionObjectData.index===this.sectionIndex;this._dragOverFrameViewModelList[r].isHidden=!o,this._dragOverFrameViewModelList[r].isShowingDragOverRedLine=i===this.m_currentLastSlideOfSection+1&&o}else this._dragOverFrameViewModelList.forEach((function(e){var t=e.slideIndex===n.m_currentLastSlideOfSection+1&&n.sectionIndex===i;e.isHidden=!t,e.isShowingDragOverRedLine=t}))}else this._dragOverFrameViewModelList.forEach((function(e){e.isHidden=!0,e.isShowingDragOverRedLine=!1}))},t}(a.ViewModel);t.GridListViewModel=h},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(1),a=n(3),l=function(e){function t(t){var n=e.call(this,t)||this;return n.visibleStyleClassName="grid-list-view-visible-class",n._elementId="grid-list-view-id"+a.v4(),n._container.id=n._elementId,n._container.classList.add(n.visibleStyleClassName),n._onViewClick=new s.Event,n.container.onclick=function(e){n.raiseEventFromClick(e)},n.container.oncontextmenu=function(e){e.preventDefault(),n.raiseEventFromClick(e)},n}return r(t,e),t.prototype.raiseEventFromClick=function(e){e.preventDefault();var t=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null,n=new RegExp("grid-list-view");null!=t&&0<(t.getAttribute("class")||"").search(n)&&this._onViewClick.signal(null,{clientX:e.clientX,clientY:e.clientY})},Object.defineProperty(t.prototype,"onViewClick",{get:function(){return this._onViewClick},enumerable:!0,configurable:!0}),t}(o.View);t.GridListView=l},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(30),s=n(31),a=n(0),l=n(4),d=n(1),c=n(6),u=n(15),g=n(5),p=n(36),h=function(e){function t(t,n,i,r){var l=e.call(this,n)||this;l.m_dragDropCompletedHandlerBound=l.dragDropCompletedHandler.bind(l),l.m_dragDropMoveHandlerBound=l.dragDropMoveHandler.bind(l),l.m_presenceHoverHandlerBound=l.presenceHoverHandler.bind(l),l._presenceIconExpanded=!1,l._events=i,l.m_dragDropManager=r,l.m_slideGridSettings=t,l._onFrameDragOver=new d.Event,l._onFrameInDragState=new d.Event,l._view=new o.GridFrameView(t,n),l._gridContentViewModel=new s.GridContentViewModel(l.m_slideGridSettings,l._view.innerContainer,l._events,l.m_dragDropManager),l.m_slideGridSettings.enableSelectionBetweenSlides&&(l._gridContentBoundaryViewModel=new u.GridContentBoundaryViewModel(l._view.container,l.m_slideGridSettings,!1,l._events)),l.m_slideGridSettings.allowMoveSlide&&(l.m_dropContainer=l.m_dragDropManager.addNewDropContainer(l._view.container,new g.ObjectData(g.DragDropObjectType.Slide,l.slideIndex)),l.m_dragDropManager.dragDropOperationCompletedEvent.subscribe(l.m_dragDropCompletedHandlerBound),l.m_dragDropManager.dragDropMoveEvent.subscribe(l.m_dragDropMoveHandlerBound)),l.m_slideGridSettings.enableRevisionTrackingInfo&&(l._revisionTrackingViewModel=new p.RevisionTrackingViewModel(l._view.slideInfoContainer,l.m_slideGridSettings));var h=new a.ViewModelBinding(l,"slideIndex");h.addBinding({target:l._view,onValueChanged:function(e){l.m_slideGridSettings.allowMoveSlide&&(l.m_dropContainer.objectData.index=e)}}),h.addBinding({target:l._gridContentViewModel}),l.m_slideGridSettings.enableSelectionBetweenSlides&&h.addBinding({target:l._gridContentBoundaryViewModel}),new a.ViewModelBinding(l,"totalSlideCount").addBinding({target:l._gridContentViewModel}),new a.ViewModelBinding(l,"isHiddenSlide").addBinding({target:l._view});var m=new a.ViewModelBinding(l,"isSelected");m.addBinding({target:l._view}),m.addBinding({target:l._gridContentViewModel});var _=new a.ViewModelBinding(l,"hasActiveFocus");return _.addBinding({target:l._view}),_.addBinding({target:l._gridContentViewModel}),new a.ViewModelBinding(l,"slideTitle").addBinding({target:l._gridContentViewModel}),new a.ViewModelBinding(l,"slideAriaLabel").addBinding({target:l._gridContentViewModel}),t.commentsEnabled&&(new a.ViewModelBinding(l,"displayCommentIcon").addBinding({target:l._view}),new a.ViewModelBinding(l,"numComments").addBinding({target:l._view})),t.shouldRenderAnimationOrTransitionInfo&&new a.ViewModelBinding(l,"displayTransitionOrAnimationIcon").addBinding({target:l._view}),t.enableRevisionTrackingInfo&&new a.ViewModelBinding(l,"displayRevisionTrackingInfo").addBinding({target:l._revisionTrackingViewModel}),l._view.onViewClick.subscribe((function(e,n){if(l._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:l.slideIndex}),t.isMobileScreenReader){var i=l._slideIndex;l._events.onSlideSelectionChanged.signal(null,{slideIndex:i,slideSelectionTrigger:null!=n?n.slideSelectionTrigger:c.SlideSelectionTrigger.Click})}})),l}return r(t,e),t.prototype.presenceHoverHandler=function(e,t){null!=t&&null!=t.presenceTouchTargetTrigger&&(t.presenceTouchTargetTrigger===c.PresenceTouchTargetTrigger.MouseOut?this.presenceMouseOutHandler():t.presenceTouchTargetTrigger===c.PresenceTouchTargetTrigger.MouseOver&&this.presenceMouseOverHandler())},t.prototype.presenceMouseOutHandler=function(){this.shouldDisplayCollabMarkersHint||(this._view.presenceCollapseStyling(),this._presenceIconExpanded=!1,null!=this._pendingPresenceUserList&&0<this._pendingPresenceUserList.length&&(this.presenceUserList=this._pendingPresenceUserList,this._pendingPresenceUserList=[]))},t.prototype.presenceMouseOverHandler=function(){this._view.presenceExpandStyling(),this._presenceIconExpanded=!0},Object.defineProperty(t.prototype,"presenceUserList",{set:function(e){if(this._presenceIconExpanded)this._pendingPresenceUserList=e;else{var t=this._presenceUserList?this._presenceUserList.length:0,n=e.length;0===t&&0<n&&this._view.onPresenceHover.subscribe(this.m_presenceHoverHandlerBound),0<t&&0===n&&this._view.onPresenceHover.unsubscribe(this.m_presenceHoverHandlerBound),this._presenceUserList=e,this._view.presenceUserList=this._presenceUserList}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldDisplayCollabMarkersHint",{get:function(){return this._shouldDisplayCollabMarkersHint},set:function(e){this._shouldDisplayCollabMarkersHint=e,void 0!==this._revisionTrackingViewModel&&(this._revisionTrackingViewModel.shouldDisplayRevisionTrackingHint=this._shouldDisplayCollabMarkersHint),this.m_slideGridSettings.isDisplayPresenceIcon&&(e?this.presenceMouseOverHandler():this.presenceMouseOutHandler())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isShowingRedLine",{set:function(e){this._gridContentBoundaryViewModel.isSelected=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentImage",{set:function(e){this._gridContentViewModel.contentImage=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderAreaRect",{get:function(){return this._view.renderAreaRect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"slideID",{get:function(){return this._slideID},set:function(e){this._slideID=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onFrameDragOver",{get:function(){return this._onFrameDragOver},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onFrameInDragState",{get:function(){return this._onFrameInDragState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentAreaRect",{get:function(){return this._gridContentViewModel.renderAreaRect},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._gridContentViewModel.dispose(),this.m_slideGridSettings.allowMoveSlide&&null!=this.m_dragDropManager&&(this.m_dragDropManager.removeDropContainer(this.m_dropContainer),this.m_dragDropManager.dragDropOperationCompletedEvent.unsubscribe(this.m_dragDropCompletedHandlerBound),this.m_dragDropManager.dragDropMoveEvent.unsubscribe(this.m_dragDropMoveHandlerBound)),this.m_slideGridSettings.isDisplayPresenceIcon&&this._view.onPresenceHover.unsubscribe(this.m_presenceHoverHandlerBound)},t.prototype.dragDropCompletedHandler=function(){this._view.isInDragState=!1},t.prototype.dragDropMoveHandler=function(e,t){this._slideIndex===t.draggableObjectData.index&&(this._view.isInDragState=!0,this.onFrameInDragState.signal(null,{index:this._slideIndex}))},t}(l.ViewModel);t.GridFrameViewModel=h},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,s,a,l,d=n(0),c=n(2),u=n(1),g=n(6),p=n(3);(s=o||(o={}))[s["presence-flyout-collapsed-class-0"]=0]="presence-flyout-collapsed-class-0",s[s["presence-flyout-collapsed-class-1"]=1]="presence-flyout-collapsed-class-1",s[s["presence-flyout-collapsed-class-2"]=2]="presence-flyout-collapsed-class-2",(l=a||(a={}))["#498205"]="persona-color-498205",l["#e3008c"]="persona-color-e3008c",l["#0078d4"]="persona-color-0078d4",l["#986f0b"]="persona-color-986f0b",l["#a4262c"]="persona-color-a4262c",l["#4f6bed"]="persona-color-4f6bed",l["#c239b3"]="persona-color-c239b3",l["#038387"]="persona-color-038387",l["#393939"]="persona-color-393939",l["#0b6a0b"]="persona-color-0b6a0b",l["#8764b8"]="persona-color-8764b8",l["#750b1c"]="persona-color-750b1c",l["#7a7574"]="persona-color-7a7574",l["#004e8c"]="persona-color-004e8c",l["#8e562e"]="persona-color-8e562e",l["#69797e"]="persona-color-69797e",l["#881798"]="persona-color-881798",l["#005b70"]="persona-color-005b70";var h=function(e){function t(t,n){var i,r=e.call(this,n)||this;(r.visibleStyleClassName="grid-frame-view-visible-class",r.hiddenStyleClassName="grid-frame-view-hidden-class",r.dragStyleClassName="grid-frame-view-in-drag-class",r.selectedStyleClassName="grid-frame-view-selected-class",r.activeFocusStyleClassName="grid-frame-view-active-focus-class",r.hiddenSlideStyleClassName="grid-frame-view-hidden-slide-class",r.slideInfoContainerClassName="grid-frame-view-slide-info-container-class",r.slideIndexContainerClassName="grid-frame-view-slide-index-container-class",r.containerRenderedAsGridStyleClassName="container-rendered-as-grid-class",r.transitionOrAnimationIconContainerClassName="grid-frame-view-transition-or-animation-icon-container-class",r.gridFrameViewInnerContainerClassName="grid-frame-view-inner-container-class",r.commentIconContainerClassName="grid-frame-view-num-comments-with-icon-container-class",r.numCommentsOnCommentIconClassName="grid-frame-view-num-comments-on-comment-icon",r.commentIconClassName="comment-icon-class",r.presenceHiddenClassName="presence-collapsed-hidden-class",r.presenceOuterContainerClassName="presence-outer-container-class",r.presenceInnerContainerClassName="presence-inner-container-class",r.presenceTouchTargetClassName="presence-touch-target-class",r.presenceFlyoutContainerClassName="presence-flyout-container-class",r.presenceFlyoutsCollapsedClassName="presence-flyouts-collapsed-class",r.presenceFlyoutCollapsedTextName="presence-flyout-collapsed-text-class",r.presenceFlyoutsExpandedClassName="presence-flyout-expanded-class",r.presenceFlyoutExpandedTextName="presence-flyout-expanded-text-class",r.presenceExpandedContainerClassName="presence-flyout-expanded-container-class",r.postionRelativeClassName="grid-frame-view-postion-relative-class",r.transitionOrAnimationIconClassName="transition-or-animation-icon-class",r.c_transitionOrAnimationIconStarPath="M 809 1703 l 158 -547 l -455 -374 h 569 l 185 -526 l 194 527 h 570 l -450 368 l 167 544 l -472 -319 z",r.c_transitionOrAnimationIconGlitterPath="M 392 619 l -392 -120 l 50 -98 l 387 122 m -53 640 h -384 v -128 h 384 m -364 668 l 373 -150 l 55 100 l -368 150 z",r.c_collabMarkerViewBox="0 0 2048 2048",r.c_commentIconPath="M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -1280 z",r._elementId="grid-frame-view-id"+p.v4(),r._presenceFlyouts=new Array,r._totalPresenceUsers=0,r._currentPresenceUsers=0,r._presenceUserList=new Array,r._container.id=r._elementId,r._container.classList.add(r.visibleStyleClassName),r.m_slideGridSettings=t,r._onViewClick=new u.Event,r._innerContainer=document.createElement("div"),r._container.appendChild(r._innerContainer),r._innerContainer.className=r.gridFrameViewInnerContainerClassName,r.m_slideGridSettings.isDisplayPresenceIcon&&r._innerContainer.classList.add(r.postionRelativeClassName),r._slideIndexContainer=document.createElement("div"),r._slideIndexContainer.classList.add(r.slideIndexContainerClassName),r._slideIndexContainer.setAttribute("aria-hidden","true"),r._slideIndexSpan=document.createElement("span"),r._slideIndexContainer.appendChild(r._slideIndexSpan),t.isDisplayPresenceIcon&&(r._onPresenceHover=new u.Event,r._presenceOuterContainer=document.createElement("div"),r._presenceOuterContainer.classList.add(r.presenceOuterContainerClassName),r._presenceOuterContainer.style.width=r.m_slideGridSettings.slideWidth.toString()+"px",r._presenceOuterContainer.style.height=r.m_slideGridSettings.slideHeight.toString()+"px",r._innerContainer.appendChild(r._presenceOuterContainer),r._presenceInnerContainer=document.createElement("div"),r._presenceInnerContainer.classList.add(r.presenceInnerContainerClassName),r._presenceOuterContainer.appendChild(r._presenceInnerContainer),r._presenceTouchtarget=document.createElement("div"),r._presenceTouchtarget.classList.add(r.presenceTouchTargetClassName),r._presenceInnerContainer.appendChild(r._presenceTouchtarget),r._presenceFlyoutContainer=document.createElement("div"),r._presenceFlyoutContainer.classList.add(r.presenceFlyoutContainerClassName),r._presenceInnerContainer.appendChild(r._presenceFlyoutContainer)),t.enableRevisionTrackingInfo||t.commentsEnabled||t.shouldRenderAnimationOrTransitionInfo?(r._slideInfoContainer=document.createElement("div"),r._slideInfoContainer.classList.add(r.slideInfoContainerClassName),r._container.classList.add(r.containerRenderedAsGridStyleClassName),r._slideIndexContainer.classList.add(r.containerRenderedAsGridStyleClassName),r._innerContainer.appendChild(r._slideInfoContainer),r._slideInfoContainer.appendChild(r._slideIndexContainer)):r._innerContainer.appendChild(r._slideIndexContainer),t.shouldRenderAnimationOrTransitionInfo&&(r._transitionOrAnimationIconContainer=document.createElement("div"),r._transitionOrAnimationIconContainer.classList.add(r.transitionOrAnimationIconContainerClassName),r._transitionOrAnimationIconContainer.setAttribute("aria-hidden","true"),r._transitionOrAnimationIcon=document.createElementNS("http://www.w3.org/2000/svg","svg"),void 0===r._transitionOrAnimationIcon.classList?(i=-1===(i=r._transitionOrAnimationIcon.getAttribute("class")||"").split(" ").indexOf(r.transitionOrAnimationIconClassName)?i.concat(" ",r.transitionOrAnimationIconClassName):i,r._transitionOrAnimationIcon.setAttribute("class",i)):r._transitionOrAnimationIcon.classList.add(r.transitionOrAnimationIconClassName),r._transitionOrAnimationIcon.setAttribute("viewBox",r.c_collabMarkerViewBox),r._transitionOrAnimationIconStarPath=document.createElementNS("http://www.w3.org/2000/svg","path"),r._transitionOrAnimationIconStarPath.setAttribute("d",r.c_transitionOrAnimationIconStarPath),r._transitionOrAnimationIconGlitterPath=document.createElementNS("http://www.w3.org/2000/svg","path"),r._transitionOrAnimationIconGlitterPath.setAttribute("d",r.c_transitionOrAnimationIconGlitterPath),r._transitionOrAnimationIcon.appendChild(r._transitionOrAnimationIconStarPath),r._transitionOrAnimationIcon.appendChild(r._transitionOrAnimationIconGlitterPath),r._transitionOrAnimationIconContainer.appendChild(r._transitionOrAnimationIcon),r._slideInfoContainer.appendChild(r._transitionOrAnimationIconContainer)),t.commentsEnabled)&&(r._numCommentsSpan=document.createElement("span"),r._commentIconContainer=document.createElement("div"),r._commentIconContainer.classList.add(r.commentIconContainerClassName),r._commentIconContainer.setAttribute("aria-hidden","true"),r._commentIcon=document.createElementNS("http://www.w3.org/2000/svg","svg"),void 0===r._commentIcon.classList?(i=(i=r._commentIcon.getAttribute("class")||"").concat(" ",r.commentIconClassName),r._commentIcon.setAttribute("class",i)):r._commentIcon.classList.add(r.commentIconClassName),r._commentIcon.setAttribute("viewBox",r.c_collabMarkerViewBox),r._commentIconPath=document.createElementNS("http://www.w3.org/2000/svg","path"),r._commentIconPath.setAttribute("d",r.c_commentIconPath),r._commentIcon.appendChild(r._commentIconPath),r._commentIconContainer.appendChild(r._commentIcon),r._numCommentsSpan.classList.add(r.numCommentsOnCommentIconClassName),r._slideInfoContainer.appendChild(r._commentIconContainer),r._commentIconContainer.appendChild(r._numCommentsSpan));return new d.ViewBinding(r,"slideIndex").addBinding({element:r._slideIndexSpan,onValueChanged:function(){var e=""+(r._slideIndex+1);r._slideIndexSpan.innerText=e}}),new d.ViewBinding(r,"isInDragState").addBinding({element:r._container,attribute:"display",onValueChanged:function(e){e?r._container.classList.add(r.dragStyleClassName):r._container.classList.remove(r.dragStyleClassName)}}),t.commentsEnabled&&(new d.ViewBinding(r,"numComments").addBinding({element:r._numCommentsSpan,attribute:"innerText"}),new d.ViewBinding(r,"displayCommentIcon").addBinding({element:r._commentIconContainer,attribute:"display",onValueChanged:function(e){e?r._commentIconContainer.classList.remove("grid-frame-view-Comments-icon-hidden-class"):r._commentIconContainer.classList.add("grid-frame-view-Comments-icon-hidden-class")}})),t.shouldRenderAnimationOrTransitionInfo&&new d.ViewBinding(r,"displayTransitionOrAnimationIcon").addBinding({element:r._transitionOrAnimationIconContainer,attribute:"display",onValueChanged:function(e){e?r._transitionOrAnimationIconContainer.classList.remove("grid-frame-view-transition-or-animation-icon-hidden-class"):r._transitionOrAnimationIconContainer.classList.add("grid-frame-view-transition-or-animation-icon-hidden-class")}}),t.enableSelectionBetweenSlides&&(r._container.onclick=function(e){r.raiseEventFromClick(e)},r._container.oncontextmenu=function(e){e.preventDefault(),r.raiseEventFromClick(e)}),t.isMobileScreenReader&&r._container.addEventListener("click",(function(e){e.preventDefault(),r._onViewClick.signal(null,{slideSelectionTrigger:g.SlideSelectionTrigger.Click})})),t.isDisplayPresenceIcon&&(r._presenceTouchtarget.addEventListener("mouseout",(function(){r._onPresenceHover.signal(null,{presenceTouchTargetTrigger:g.PresenceTouchTargetTrigger.MouseOut})})),r._presenceTouchtarget.addEventListener("mouseover",(function(){r._onPresenceHover.signal(null,{presenceTouchTargetTrigger:g.PresenceTouchTargetTrigger.MouseOver})}))),r}return r(t,e),t.prototype.raiseEventFromClick=function(e){var t=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null,n=new RegExp("grid-frame-view");null!=t&&0<(t.getAttribute("class")||"").search(n)&&this._onViewClick.signal(null,null)},Object.defineProperty(t.prototype,"renderAreaRect",{get:function(){var e=this._container.getBoundingClientRect();return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"presenceUserList",{set:function(e){for(this._presenceUserList=e,this._totalPresenceUsers=this._presenceUserList.length;this._currentPresenceUsers<this._totalPresenceUsers;){var t=document.createElement("div");this._presenceFlyoutContainer.appendChild(t),this._presenceFlyouts.push(t),this._currentPresenceUsers+=1}for(;this._currentPresenceUsers>this._totalPresenceUsers;){var n=this._presenceFlyoutContainer.firstChild;n&&(this._presenceFlyoutContainer.removeChild(n),this._presenceFlyouts.splice(0,1)),this._currentPresenceUsers-=1}this.presenceCollapseStyling()},enumerable:!0,configurable:!0}),t.prototype.presenceExpandStyling=function(){var e=this;if(this._currentPresenceUsers===this._totalPresenceUsers&&(null===this._presenceUserList||this._currentPresenceUsers===this._presenceUserList.length)){var t=this._totalPresenceUsers-1;this._presenceFlyoutContainer.classList.add(this.presenceExpandedContainerClassName),this._presenceFlyouts.forEach((function(n){n.classList.remove(e.presenceFlyoutsCollapsedClassName),n.classList.remove(e.presenceFlyoutCollapsedTextName),n.classList.remove(o[0]),n.classList.remove(o[1]),n.classList.remove(o[2]),n.classList.remove(e.presenceHiddenClassName),n.classList.add(e.presenceFlyoutsExpandedClassName),n.classList.add(e.presenceFlyoutExpandedTextName),n.innerText=e._presenceUserList[t].userName?e._presenceUserList[t].userName:"";var i=a[e._presenceUserList[t].color];n.classList.add(i),t-=1}))}},t.prototype.presenceCollapseStyling=function(){var e=this;if(this._currentPresenceUsers===this._totalPresenceUsers&&(null===this._presenceUserList||this._currentPresenceUsers===this._presenceUserList.length)){var t=this._totalPresenceUsers-1;this._presenceFlyoutContainer.classList.remove(this.presenceExpandedContainerClassName),this._presenceFlyouts.forEach((function(n){n.classList.remove(e.presenceFlyoutsExpandedClassName),n.classList.remove(e.presenceFlyoutExpandedTextName),n.classList.add(e.presenceFlyoutsCollapsedClassName),n.classList.add(e.presenceFlyoutCollapsedTextName),e.presenceCollapseStylingHelper(t,n);var i=a[e._presenceUserList[t].color];n.classList.add(i),t-=1}))}},t.prototype.presenceCollapseStylingHelper=function(e,t){switch(e){case 0:t.innerText=this._presenceUserList[e].initials?this._presenceUserList[e].initials:"",t.classList.add(o[0]),t.classList.remove(o[1]),t.classList.remove(o[2]),t.classList.remove(this.presenceHiddenClassName);break;case 1:t.innerText="",t.classList.remove(o[0]),t.classList.add(o[1]),t.classList.remove(o[2]),t.classList.remove(this.presenceHiddenClassName);break;case 2:t.innerText="",t.classList.remove(o[0]),t.classList.remove(o[1]),t.classList.add(o[2]),t.classList.remove(this.presenceHiddenClassName);break;default:t.innerText="",t.classList.remove(o[0]),t.classList.remove(o[1]),t.classList.remove(o[2]),t.classList.add(this.presenceHiddenClassName)}},Object.defineProperty(t.prototype,"isSelected",{set:function(e){this._isSelected=e,this._isSelected?this._container.classList.add(this.selectedStyleClassName):this._container.classList.remove(this.selectedStyleClassName)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onViewClick",{get:function(){return this._onViewClick},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onPresenceHover",{get:function(){return this._onPresenceHover},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasActiveFocus",{set:function(e){this._hasActiveFocus=e,this._hasActiveFocus?(this._container.classList.add(this.activeFocusStyleClassName),this.m_slideGridSettings.allowScrollIntoView&&this._container.scrollIntoView({block:"nearest"})):this._container.classList.remove(this.activeFocusStyleClassName)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHiddenSlide",{set:function(e){this._isHiddenSlide=e,this._isHiddenSlide?this._container.classList.add(this.hiddenSlideStyleClassName):this._container.classList.remove(this.hiddenSlideStyleClassName)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerContainer",{get:function(){return this._innerContainer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"slideInfoContainer",{get:function(){return this._slideInfoContainer},enumerable:!0,configurable:!0}),t}(c.View);t.GridFrameView=h},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(32),s=n(33),a=n(0),l=n(6),d=n(4),c=n(5),u=function(e){function t(t,n,i,r){var d=e.call(this,n)||this;return d._events=i,d._dragDropManager=r,d.m_slideGridSettings=t,d._view=new o.GridContentView(d.m_slideGridSettings,n),d._contentImageViewModel=new s.ContentImageViewModel(d._view.container,d._events),t.allowMoveSlide&&(d._draggable=d._dragDropManager.addNewDraggable(d._view.container,new c.ObjectData(c.DragDropObjectType.Slide,d._slideIndex))),new a.ViewModelBinding(d,"slideIndex").addBinding({target:d._view,onValueChanged:function(e){d.m_slideGridSettings.allowMoveSlide&&(d._draggable.objectData.index=e)}}),new a.ViewModelBinding(d,"totalSlideCount").addBinding({target:d._view}),new a.ViewModelBinding(d,"slideAriaLabel").addBinding({target:d._view}),new a.ViewModelBinding(d,"slideTitle").addBinding({target:d._view}),new a.ViewModelBinding(d,"hasActiveFocus").addBinding({target:d._view}),new a.ViewModelBinding(d,"isSelected").addBinding({target:d._view,onValueChanged:function(e){if(d.m_slideGridSettings.allowMoveSlide){var t=d._dragDropManager.dragReadyElements;if(e)t.indexOf(d._draggable)<0&&(t.push(d._draggable),d._dragDropManager.dragReadyElements=t);else{var n=t.indexOf(d._draggable);0<=n&&(t.splice(n,1),d._dragDropManager.dragReadyElements=t)}}}}),d._view.onViewClick.subscribe((function(e,t){var n=d._slideIndex,i=t.isSelectingMultiple,r=t.isSelectingRange;d.m_slideGridSettings.allowMoveSlide&&t.slideSelectionTrigger===l.SlideSelectionTrigger.RightClick&&d.m_slideGridSettings.allowMultipleSelect&&(d._dragDropManager.dragReadyElements.indexOf(d._draggable)<0?d._dragDropManager.dragReadyElements=[d._draggable]:i=!0),d._events.onSlideSelectionChanged.signal(null,{slideIndex:n,slideSelectionTrigger:null!=t?t.slideSelectionTrigger:l.SlideSelectionTrigger.Click,isSelectingMultiple:i,isSelectingRange:r})})),d}return r(t,e),Object.defineProperty(t.prototype,"contentImage",{set:function(e){this._contentImageViewModel.image=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderAreaRect",{get:function(){return this._view.renderAreaRect},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.m_slideGridSettings.allowMoveSlide&&null!=this._dragDropManager&&this._dragDropManager.removeDraggable(this._draggable)},t}(d.ViewModel);t.GridContentViewModel=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(2),a=n(6),l=n(0),d=n(3),c=function(e){function t(t,n){var i=e.call(this,n)||this;return i.visibleStyleClassName="grid-content-view-visible-class",i.containerRenderedAsGridStyleClassName="container-rendered-as-grid-class",i.hiddenStyleClassName="grid-content-view-hidden-class",i._elementId="grid-content-view-id"+d.v4(),i._container.classList.add(i.visibleStyleClassName),i._container.id=i._elementId,i.m_slideGridSettings=t,i.m_slideGridSettings.commentsEnabled&&i._container.classList.add(i.containerRenderedAsGridStyleClassName),i._viewClickEvent=new o.Event,i._container.style.width=i.m_slideGridSettings.slideWidth.toString()+"px",i._container.style.height=i.m_slideGridSettings.slideHeight.toString()+"px",i._container.tabIndex=i.m_slideGridSettings.disableAutomaticTabStops?-1:0,i._container.setAttribute("aria-level","1"),t.isMobileScreenReader?i._container.setAttribute("role","menuitem"):i._container.setAttribute("role","option"),i._container.onclick=function(e){e.preventDefault();var t=(e.metaKey||e.ctrlKey||e.shiftKey)&&i.m_slideGridSettings.allowMultipleSelect,n=e.shiftKey;i.onViewClick.signal(null,{slideSelectionTrigger:a.SlideSelectionTrigger.Click,isSelectingMultiple:t,isSelectingRange:n})},i.m_slideGridSettings.allowMoveSlide&&(i._container.onmousedown=function(e){if(0===e.button){e.preventDefault();var t=(e.metaKey||e.ctrlKey||e.shiftKey)&&i.m_slideGridSettings.allowMultipleSelect,n=e.shiftKey;i.onViewClick.signal(null,{slideSelectionTrigger:a.SlideSelectionTrigger.MouseDown,isSelectingMultiple:t,isSelectingRange:n})}}),i.m_slideGridSettings.enableTriggerSelectionFromRightClick&&(i._container.oncontextmenu=function(e){e.preventDefault();var t=(e.metaKey||e.ctrlKey||e.shiftKey)&&i.m_slideGridSettings.allowMultipleSelect,n=e.shiftKey;i.onViewClick.signal(null,{slideSelectionTrigger:a.SlideSelectionTrigger.RightClick,isSelectingMultiple:t,isSelectingRange:n})}),i.m_slideGridSettings.enableTriggerSelectionFromDoubleClick&&(i._container.ondblclick=function(e){e.preventDefault();var t=(e.metaKey||e.ctrlKey||e.shiftKey)&&i.m_slideGridSettings.allowMultipleSelect,n=e.shiftKey;i.onViewClick.signal(null,{slideSelectionTrigger:a.SlideSelectionTrigger.DoubleClick,isSelectingMultiple:t,isSelectingRange:n})}),new l.ViewBinding(i,"totalSlideCount").addBinding({element:i._container,onValueChanged:function(){i._container.setAttribute("aria-setsize",i._totalSlideCount.toString())}}),new l.ViewBinding(i,"slideTitle").addBinding({element:i._container,onValueChanged:function(e){i._container.title=e}}),new l.ViewBinding(i,"slideAriaLabel").addBinding({element:i._container,onValueChanged:function(e){i._container.setAttribute("aria-label",null!=e&&""!==e?e:i._slideTitle)}}),new l.ViewBinding(i,"slideIndex").addBinding({element:i._container,onValueChanged:function(){var e=""+(i._slideIndex+1);i._container.setAttribute("aria-posinset",e)}}),new l.ViewBinding(i,"isSelected").addBinding({element:i._container,onValueChanged:function(){i._container.setAttribute("aria-selected",i._isSelected.toString())}}),i}return r(t,e),Object.defineProperty(t.prototype,"onViewClick",{get:function(){return this._viewClickEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"slideIndex",{set:function(e){this._slideIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasActiveFocus",{set:function(e){this._hasActiveFocus=e,this._hasActiveFocus&&this._container.focus()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderAreaRect",{get:function(){var e=this._container.getBoundingClientRect();return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}},enumerable:!0,configurable:!0}),t}(s.View);t.GridContentView=c},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(34),s=n(0),a=function(e){function t(t,n){var i=e.call(this,t)||this;return i._events=n,i._view=new o.ContentImageView(t),new s.ViewModelBinding(i,"image").addBinding({target:i._view}),i}return r(t,e),t}(n(4).ViewModel);t.ContentImageViewModel=a},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),s=n(2),a=n(3),l=function(e){function t(t){var n=e.call(this,t)||this;return n.visibleStyleClassName="content-image-view-visible-class",n.hiddenStyleClassName="content-image-view-hidden-class",n._elementId="content-image-view-id"+a.v4(),n._imageElement=document.createElement("img"),n._container.id=n._elementId,n._container.classList.add(n.visibleStyleClassName),n._container.appendChild(n._imageElement),n._container.setAttribute("aria-hidden","true"),new o.ViewBinding(n,"image").addBinding({element:n._imageElement,attribute:"src",onValueChanged:n.handleImageChange.bind(n)}),n}return r(t,e),t.prototype.handleImageChange=function(e){null==e||""===e?(this._container.classList.remove(this.visibleStyleClassName),this._container.classList.add(this.hiddenStyleClassName)):(this._container.classList.remove(this.hiddenStyleClassName),this._container.classList.add(this.visibleStyleClassName))},t}(s.View);t.ContentImageView=l},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(0),a=n(1),l=n(3),d=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.gridContentPaddingLength=23,r.defaultStyleClassName="grid-content-boundary-view-default-class",r.deselectedStyleClassName="grid-content-boundary-view-deselected-class",r.selectedStyleClassName="grid-content-boundary-view-selected-class",r.hiddenStyleClassName="grid-content-boundary-view-hidden-class",r.firstSlideLeftBoundaryWithSectionsStyleClassName="grid-content-boundary-view-first-slide-with-sections-class",r.firstSlideLeftBoundaryWithoutSectionsStyleClassName="grid-content-boundary-view-first-slide-without-sections-class",r._elementId="grid-content-boundary-view"+l.v4(),r.m_isFirstSlideLeftBoundary=!0,r._container.id=r._elementId,r._container.classList.add(r.defaultStyleClassName),r._container.classList.add(r.deselectedStyleClassName),r._onViewClick=new a.Event,r.m_isFirstSlideLeftBoundary=i,r._container.setAttribute("aria-hidden","true"),new s.ViewBinding(r,"isSelected").addBinding({element:r._container,onValueChanged:function(e){e?(r._container.classList.remove(r.deselectedStyleClassName),r._container.classList.add(r.selectedStyleClassName),r._container.tabIndex=0,r._container.focus()):(r._container.classList.remove(r.selectedStyleClassName),r._container.classList.add(r.deselectedStyleClassName),r._container.tabIndex=-1,r._container.blur())}}),new s.ViewBinding(r,"isVisible").addBinding({element:r._container,onValueChanged:function(e){e?r._container.classList.remove(r.hiddenStyleClassName):(r.isSelected=!1,r._container.classList.add(r.hiddenStyleClassName))}}),i&&new s.ViewBinding(r,"shouldDisplaySection").addBinding({element:r._container,onValueChanged:function(e){e?(r._container.classList.add(r.firstSlideLeftBoundaryWithSectionsStyleClassName),r._container.classList.remove(r.firstSlideLeftBoundaryWithoutSectionsStyleClassName)):(r._container.classList.add(r.firstSlideLeftBoundaryWithoutSectionsStyleClassName),r._container.classList.remove(r.firstSlideLeftBoundaryWithSectionsStyleClassName))}}),r._container.onclick=function(e){r.raiseEventFromClick(e)},r._container.oncontextmenu=function(e){e.preventDefault(),r.raiseEventFromClick(e)},r._container.style.height=(n.slideHeight+r.gridContentPaddingLength).toString()+"px",r}return r(t,e),t.prototype.raiseEventFromClick=function(e){e.preventDefault();var t=this.m_isFirstSlideLeftBoundary?0:this.slideIndex+1;this.onViewClick.signal(null,{insertIndex:t})},Object.defineProperty(t.prototype,"onViewClick",{get:function(){return this._onViewClick},enumerable:!0,configurable:!0}),t}(o.View);t.GridContentBoundaryView=d},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(37),a=n(0),l=function(e){function t(t,n){var i=e.call(this,t)||this;return i._view=new s.RevisionTrackingView(t,n),new a.ViewModelBinding(i,"displayRevisionTrackingInfo").addBinding({target:i._view}),new a.ViewModelBinding(i,"shouldDisplayRevisionTrackingHint").addBinding({target:i._view,onValueChanged:function(e){i.displayRevisionTrackingInfo&&(e?i._view.showRevisionTrackingFlyout():i._view.hideRevisionTrackingFlyout())}}),i}return r(t,e),t}(o.ViewModel);t.RevisionTrackingViewModel=l},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(0),a=function(e){function t(t,n){var i=e.call(this,t)||this;if(i.c_revisionTrackingBackgroundLeftOut=8,i.c_revisionTrackingBackgroundRightOut=8,i.c_revisionTrackingBackgroundTopOut=8,i.c_revisionTrackingBackgroundBottomOut=32,i.revisionTrackingBackGroundViewClassName="revisiontracking-background-view-class",i.revisionTrackingContainerClassName="revisiontracking-container-class",i.revisionTrackingPawnContainerClassName="revisiontracking-pawn-container-class",i.revisionTrackingPawnClassName="revisiontracking-pawn-class",i.revisionTrackingIconClassName="revisiontracking-icon-class",i.revisionTrackingFlyoutContainerClassName="revisiontracking-flyout-container-class",i.revisionTrackingViewHiddenClass="revisiontracking-view-hidden-class",i.c_revisionTrackingIconPathAttribute="M13,7.5c0,0.5-0.4,0.9-0.9,0.9H9.7l2.6,2.6c0.4,0.4,0.4,0.9,0,1.3c-0.4,0.4-0.9,0.4-1.3,0L8.4,9.7v2.4C8.4,12.6,8,13,7.5,13c-0.5,0-0.9-0.4-0.9-0.9V9.7L4,12.3c-0.4,0.4-0.9,0.4-1.3,0c-0.4-0.4-0.4-0.9,0-1.3l2.6-2.6H2.9C2.4,8.4,2,8,2,7.5C2,7,2.4,6.6,2.9,6.6h2.4L2.7,4c-0.4-0.4-0.4-0.9,0-1.3c0.4-0.4,0.9-0.4,1.3,0l2.6,2.6V2.9C6.6,2.4,7,2,7.5,2C8,2,8.4,2.4,8.4,2.9v2.4L11,2.7c0.4-0.4,0.9-0.4,1.3,0c0.4,0.4,0.4,0.9,0,1.3L9.7,6.6h2.4C12.6,6.6,13,7,13,7.5z M7.5,5.6c-1,0-1.8,0.8-1.8,1.8c0,1,0.8,1.8,1.8,1.8c1,0,1.8-0.8,1.8-1.8C9.3,6.4,8.5,5.6,7.5,5.6z",i.modernRevisionTrackingIconClassName="modern-revisiontracking-icon-class",i.c_modernRevisionTrackingIconPathAttribute="M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0",i.modernRevisionTrackingIconPathClassName="modern-revisiontracking-svg-path-class",i.modernRevisionTrackingFlyoutContainerClassName="modern-revisiontracking-flyout-container-class",n.shouldDisplayModernCatchupUx||(i._revisionTrackingBackGroundView=document.createElement("div"),i._revisionTrackingBackGroundView.classList.add(i.revisionTrackingBackGroundViewClassName),i._revisionTrackingBackGroundView.style.width=(n.slideWidth+i.c_revisionTrackingBackgroundLeftOut+i.c_revisionTrackingBackgroundRightOut).toString()+"px",i._revisionTrackingBackGroundView.style.height=(n.slideHeight+i.c_revisionTrackingBackgroundTopOut+i.c_revisionTrackingBackgroundBottomOut).toString()+"px",t.appendChild(i._revisionTrackingBackGroundView)),i._revisionTrackingContainer=document.createElement("div"),i._revisionTrackingContainer.classList.add(i.revisionTrackingContainerClassName),i._revisionTrackingContainer.setAttribute("aria-label",n.revisionTrackingFlyoutContent),i._revisionTrackingPawnContainer=document.createElement("div"),i._revisionTrackingPawnContainer.classList.add(i.revisionTrackingPawnContainerClassName),i._revisionTrackingPawnContainer.setAttribute("aria-hidden","true"),i._revisionTrackingPawn=document.createElement("div"),i._revisionTrackingPawn.classList.add(i.revisionTrackingPawnClassName),i._revisionTrackingIcon=document.createElementNS("http://www.w3.org/2000/svg","svg"),n.shouldDisplayModernCatchupUx)i._revisionTrackingIcon.setAttribute("class",i.modernRevisionTrackingIconClassName),i._revisionTrackingIcon.setAttribute("viewBox","0 0 10 10");else{if(void 0===i._revisionTrackingIcon.classList){var r=i._revisionTrackingIcon.getAttribute("class")||"";r=-1===r.split(" ").indexOf(i.revisionTrackingIconClassName)?r.concat(" ",i.revisionTrackingIconClassName):r,i._revisionTrackingIcon.setAttribute("class",r)}else i._revisionTrackingIcon.classList.add(i.revisionTrackingIconClassName);i._revisionTrackingIcon.setAttribute("viewBox","0 0 16 16")}i._revisionTrackingIconPath=document.createElementNS("http://www.w3.org/2000/svg","path"),n.shouldDisplayModernCatchupUx?(i._revisionTrackingIconPath.setAttribute("d",i.c_modernRevisionTrackingIconPathAttribute),i._revisionTrackingIconPath.setAttribute("class",i.modernRevisionTrackingIconPathClassName)):i._revisionTrackingIconPath.setAttribute("d",i.c_revisionTrackingIconPathAttribute),i._revisionTrackingIcon.appendChild(i._revisionTrackingIconPath),i._revisionTrackingPawn.appendChild(i._revisionTrackingIcon),i._revisionTrackingPawnContainer.appendChild(i._revisionTrackingPawn),i._revisionTrackingContainer.appendChild(i._revisionTrackingPawnContainer),i._revisionTrackingFlyoutContainer=document.createElement("div"),n.shouldDisplayModernCatchupUx?i._revisionTrackingFlyoutContainer.classList.add(i.modernRevisionTrackingFlyoutContainerClassName):i._revisionTrackingFlyoutContainer.classList.add(i.revisionTrackingFlyoutContainerClassName),i._revisionTrackingFlyoutContainer.setAttribute("aria-hidden","true"),i._revisionTrackingFlyout=document.createElement("span"),i._revisionTrackingFlyout.innerText=null!=n.revisionTrackingFlyoutContent?n.revisionTrackingFlyoutContent:"",i._revisionTrackingFlyoutContainer.appendChild(i._revisionTrackingFlyout),i._revisionTrackingContainer.appendChild(i._revisionTrackingFlyoutContainer),t.appendChild(i._revisionTrackingContainer),i.hideRevisionTrackingFlyout();var o=new s.ViewBinding(i,"displayRevisionTrackingInfo");return o.addBinding({element:i._revisionTrackingContainer,onValueChanged:function(e){e?(i.shouldDisplayRevisionTrackingHint||i.hideRevisionTrackingFlyout(),i._revisionTrackingContainer.classList.remove(i.revisionTrackingViewHiddenClass)):i._revisionTrackingContainer.classList.add(i.revisionTrackingViewHiddenClass)}}),n.shouldDisplayModernCatchupUx||o.addBinding({element:i._revisionTrackingBackGroundView,onValueChanged:function(e){e?i._revisionTrackingBackGroundView.classList.remove(i.revisionTrackingViewHiddenClass):i._revisionTrackingBackGroundView.classList.add(i.revisionTrackingViewHiddenClass)}}),i._revisionTrackingPawn.onmouseover=function(e){e.preventDefault(),i.showRevisionTrackingFlyout()},i._revisionTrackingPawn.onmouseout=function(e){e.preventDefault(),i.hideRevisionTrackingFlyout()},i}return r(t,e),t.prototype.showRevisionTrackingFlyout=function(){this._revisionTrackingFlyoutContainer.classList.remove(this.revisionTrackingViewHiddenClass)},t.prototype.hideRevisionTrackingFlyout=function(){this._revisionTrackingFlyoutContainer.classList.add(this.revisionTrackingViewHiddenClass)},t}(o.View);t.RevisionTrackingView=a},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(39),a=n(0),l=n(5),d=function(e){function t(t,n,i,r){var o=e.call(this,n)||this;return o._view=new s.DragOverFrameView(t,n),new a.ViewModelBinding(o,"isHidden").addBinding({target:o._view}),new a.ViewModelBinding(o,"isShowingDragOverRedLine").addBinding({target:o._view}),new a.ViewModelBinding(o,"slideIndex").addBinding({target:o._view,onValueChanged:function(e){o.m_dropContainer.objectData.index=e}}),o._slideIndex=r,o.m_dragDropManager=i,(o.m_slideGridSettings=t).allowMoveSlide&&(o.m_dropContainer=o.m_dragDropManager.addNewDropContainer(o._view.container,new l.ObjectData(l.DragDropObjectType.SlidePlaceholder,o._slideIndex))),o.isHidden=!0,o}return r(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.m_slideGridSettings.allowMoveSlide&&null!=this.m_dragDropManager&&this.m_dragDropManager.removeDropContainer(this.m_dropContainer)},t}(o.ViewModel);t.DragOverFrameViewModel=d},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(0),a=n(3),l=function(e){function t(t,n){var i=e.call(this,n)||this;return i.visibleStyleClassName="drag-over-frame-view-visible-class",i.hiddenStyleClassName="drag-over-frame-view-hidden-class",i.redlineStyleClassName="drag-over-frame-view-indicator-class",i.innerRedlineStyleClassName="drag-over-frame-view-inner-indicator-class",i._elementId="drag-over-frame-view-id"+a.v4(),i.innerRedlinePaddingLength=23,i._container.id=i._elementId,i._container.classList.add(i.hiddenStyleClassName),i.m_dragOverRedLineDiv=document.createElement("div"),i.m_dragOverRedLineInnerDiv=document.createElement("div"),i.m_dragOverRedLineDiv.appendChild(i.m_dragOverRedLineInnerDiv),i._container.appendChild(i.m_dragOverRedLineDiv),new s.ViewBinding(i,"isHidden").addBinding({element:i._container,onValueChanged:function(e){i._container.style.height=e?(i._container.classList.remove(i.visibleStyleClassName),i._container.classList.add(i.hiddenStyleClassName),i._container.style.width="0px"):(i._container.classList.remove(i.hiddenStyleClassName),i._container.classList.add(i.visibleStyleClassName),i._container.style.width=t.slideWidth+34+"px",t.slideHeight+50+"px")}}),new s.ViewBinding(i,"isShowingDragOverRedLine").addBinding({element:i.m_dragOverRedLineDiv,onValueChanged:function(e){e?(i.m_dragOverRedLineDiv.classList.add(i.redlineStyleClassName),i.m_dragOverRedLineInnerDiv.classList.add(i.innerRedlineStyleClassName)):(i.m_dragOverRedLineDiv.classList.remove(i.redlineStyleClassName),i.m_dragOverRedLineInnerDiv.classList.remove(i.innerRedlineStyleClassName))}}),i.m_dragOverRedLineInnerDiv.style.height=(t.slideHeight+i.innerRedlinePaddingLength).toString()+"px",i}return r(t,e),t}(o.View);t.DragOverFrameView=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),r=function(){function e(e,t){this.m_objectData=t,this.m_container=e}return Object.defineProperty(e.prototype,"objectData",{get:function(){return this.m_objectData},set:function(e){this.m_objectData=e},enumerable:!0,configurable:!0}),e.prototype.dropContainerPosition=function(e,t){var n=this.m_container.getBoundingClientRect(),r=n.left+(n.right-n.left)/2,o=n.top+.1*(n.bottom-n.top),s=n.bottom-.1*(n.bottom-n.top);return t<o?i.DropContainerPosition.ContainerTop:s<=t?i.DropContainerPosition.ContainerBottom:e<r?i.DropContainerPosition.ContainerLeft:i.DropContainerPosition.ContainerRight},e.prototype.isDraggableInRange=function(e,t){var n=this.m_container.getBoundingClientRect();return n.top<=t&&n.bottom>t&&n.right>=e&&n.left<e},e}();t.DropContainer=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(42),r=n(1),o=function(){function e(e,t,n,o){var s=this;this.draggableContainer=null,this.originalSourceContainer=e,this.m_objectData=t,this.m_dragStartEvent=new r.Event,this.m_dragMoveEvent=new r.Event,this.m_dragStopEvent=new r.Event,this.m_dragToTopEvent=new r.Event,this.m_dragToBottomEvent=new r.Event,this.m_dragToCenterEvent=new r.Event,this.m_dragDropVisualFactory=n,this.m_scrollThreshold=o,this.sensor=new i.MouseSensor(this.originalSourceContainer,this.m_scrollThreshold),this.sensor.dragStartSensorEvent.subscribe((function(){s.m_isDragReady&&s.onDragStart()})),this.sensor.dragMoveSensorEvent.subscribe((function(e,t){s.onDragMove(t)})),this.sensor.dragStopSensorEvent.subscribe((function(e,t){s.onDragStop(t)})),this.sensor.dragDismissSensorEvent.subscribe((function(e,t){s.onDragDismiss(t)})),this.sensor.dragToTopSensorEvent.subscribe((function(){s.onDragToTop()})),this.sensor.dragToBottomSensorEvent.subscribe((function(){s.onDragToBottom()})),this.sensor.dragToCenterSensorEvent.subscribe((function(){s.onDragToCenter()}))}return e.prototype.onDragToCenter=function(){this.m_dragToCenterEvent.signal(null,null)},e.prototype.onDragToBottom=function(){this.m_dragToBottomEvent.signal(null,null)},e.prototype.onDragToTop=function(){this.m_dragToTopEvent.signal(null,null)},e.prototype.onDragStart=function(){this.m_dragStartEvent.signal(null,{objectData:this.m_objectData}),this.draggableContainer=this.m_dragDropVisualFactory.createDragDropVisual(this.originalSourceContainer),this.sensor.draggableContainer=this.draggableContainer},e.prototype.onDragMove=function(e){null!=this.draggableContainer&&(document.body.appendChild(this.draggableContainer),this.m_dragMoveEvent.signal(null,{pageX:e.pageX,pageY:e.pageY,objectData:this.m_objectData}))},e.prototype.onDragStop=function(e){try{this.m_dragStopEvent.signal(null,{objectData:this.m_objectData,pageX:e.pageX,pageY:e.pageY}),null!=this.draggableContainer&&(document.body.removeChild(this.draggableContainer),this.draggableContainer=null)}catch(e){}},e.prototype.onDragDismiss=function(e){try{this.m_dragStopEvent.signal(null,e),null!=this.draggableContainer&&(document.body.removeChild(this.draggableContainer),this.draggableContainer=null)}catch(e){}},Object.defineProperty(e.prototype,"dragStartEvent",{get:function(){return this.m_dragStartEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragMoveEvent",{get:function(){return this.m_dragMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragStopEvent",{get:function(){return this.m_dragStopEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragToBottomEvent",{get:function(){return this.m_dragToBottomEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragToTopEvent",{get:function(){return this.m_dragToTopEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragToCenterEvent",{get:function(){return this.m_dragToCenterEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"objectData",{get:function(){return this.m_objectData},set:function(e){this.m_objectData=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDragReady",{get:function(){return this.m_isDragReady},set:function(e){this.m_isDragReady=e},enumerable:!0,configurable:!0}),e}();t.Draggable=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=function(){function e(e,t){this.m_dismissTimeoutHandle=-1,this.m_mouseLeaveHandlerBound=this.onMouseLeaveHandler.bind(this),this.m_mouseEnterHandlerBound=this.onMouseEnterHandler.bind(this),this.m_originalSourceContainer=e,this.m_dragMoveSensorEvent=new i.Event,this.m_dragStartSensorEvent=new i.Event,this.m_dragStopSensorEvent=new i.Event,this.m_dragDismissSensorEvent=new i.Event,this.m_dragToBottomSensorEvent=new i.Event,this.m_dragToTopSensorEvent=new i.Event,this.m_dragToCenterSensorEvent=new i.Event,this.m_isDragging=!1,this.m_scrollThreshold=t,this.onMouseDownHandler=this.onMouseDownHandler.bind(this),this.onMouseUpHandler=this.onMouseUpHandler.bind(this),this.onMouseMoveHandler=this.onMouseMoveHandler.bind(this),this.m_originalSourceContainer.addEventListener("mousedown",this.onMouseDownHandler)}return e.prototype.onMouseDownHandler=function(e){e.preventDefault(),0===e.button&&(document.addEventListener("mousemove",this.onMouseMoveHandler),document.addEventListener("mouseup",this.onMouseUpHandler),document.addEventListener("mouseleave",this.m_mouseLeaveHandlerBound),document.addEventListener("mouseenter",this.m_mouseEnterHandlerBound),this.m_horizontalShift=e.pageX-this.m_originalSourceContainer.getBoundingClientRect().left,this.m_verticalShift=e.pageY-this.m_originalSourceContainer.getBoundingClientRect().top,this.m_dragStartSensorEvent.signal(null,{pageX:e.pageX-this.m_horizontalShift,pageY:e.pageY-this.m_verticalShift}),this.m_originalSourceContainer.removeEventListener("mousedown",this.onMouseDownHandler),this.m_mouseDownX=e.pageX,this.m_mouseDownY=e.pageY)},e.prototype.onMouseMoveHandler=function(e){if(e.preventDefault(),1<Math.abs(e.pageX-this.m_mouseDownX)&&1<Math.abs(e.pageY-this.m_mouseDownY)){var t=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null;null!==t&&(this.m_draggableContainer.style.left=e.pageX-this.m_horizontalShift+"px",this.m_draggableContainer.style.top=e.pageY-this.m_verticalShift+"px",this.m_dragMoveSensorEvent.signal(null,{pageX:this.m_horizontalMidpoint,pageY:this.m_verticalMidpoint,target:t})),this.m_isDragging=!0,this.clearDismissTimeoutHandler()}e.pageY>window.innerHeight-this.m_scrollThreshold?this.m_dragToBottomSensorEvent.signal(null,null):e.pageY<this.m_scrollThreshold?this.m_dragToTopSensorEvent.signal(null,null):this.m_dragToCenterSensorEvent.signal(null,null)},e.prototype.onMouseUpHandler=function(e){if(e.preventDefault(),this.m_isDragging){var t=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null;null!==t?(this.m_dragStopSensorEvent.signal(null,{target:t,pageX:this.m_horizontalMidpoint,pageY:this.m_verticalMidpoint}),this.m_isDragging=!1):this.m_dragDismissSensorEvent.signal(null,null)}this.finishMouseSensing()},e.prototype.onMouseLeaveHandler=function(e){e.preventDefault(),this.registerDismissTimeoutHandler()},e.prototype.onMouseEnterHandler=function(e){e.preventDefault(),this.registerDismissTimeoutHandler()},e.prototype.registerDismissTimeoutHandler=function(){var e=this;this.clearDismissTimeoutHandler(),this.m_dismissTimeoutHandle=window.setTimeout((function(){e.m_dragDismissSensorEvent.signal(null,null),e.finishMouseSensing()}),500)},e.prototype.clearDismissTimeoutHandler=function(){0<=this.m_dismissTimeoutHandle&&window.clearTimeout(this.m_dismissTimeoutHandle)},Object.defineProperty(e.prototype,"m_horizontalMidpoint",{get:function(){var e=this.m_draggableContainer.getBoundingClientRect().right-this.m_draggableContainer.getBoundingClientRect().left;return this.m_draggableContainer.getBoundingClientRect().left+Math.round(e/2)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"m_verticalMidpoint",{get:function(){var e=this.m_draggableContainer.getBoundingClientRect().bottom-this.m_draggableContainer.getBoundingClientRect().top;return this.m_draggableContainer.getBoundingClientRect().top+Math.round(e/2)},enumerable:!0,configurable:!0}),e.prototype.finishMouseSensing=function(){this.clearDismissTimeoutHandler(),document.removeEventListener("mousemove",this.onMouseMoveHandler),document.removeEventListener("mouseup",this.onMouseUpHandler),document.removeEventListener("mouseleave",this.m_mouseLeaveHandlerBound),document.removeEventListener("mouseenter",this.m_mouseEnterHandlerBound),this.m_originalSourceContainer.addEventListener("mousedown",this.onMouseDownHandler),this.m_isDragging=!1,this.m_mouseDownX=-1,this.m_mouseDownY=-1},Object.defineProperty(e.prototype,"dragStopSensorEvent",{get:function(){return this.m_dragStopSensorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragMoveSensorEvent",{get:function(){return this.m_dragMoveSensorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragStartSensorEvent",{get:function(){return this.m_dragStartSensorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragDismissSensorEvent",{get:function(){return this.m_dragDismissSensorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragToBottomSensorEvent",{get:function(){return this.m_dragToBottomSensorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragToTopSensorEvent",{get:function(){return this.m_dragToTopSensorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragToCenterSensorEvent",{get:function(){return this.m_dragToCenterSensorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"draggableContainer",{set:function(e){this.m_draggableContainer=e},enumerable:!0,configurable:!0}),e}();t.MouseSensor=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.singleDraggableStyleClassName="single-select-draggable-class",this.multipleDraggableOuterContainerStyleClassName="multiple-select-draggable-outer-container-class",this.multipleDraggableInnerContainerStyleClassName="multiple-select-draggable-inner-container-class",this.clonedSlideStyleClassName="draggable-cloned-style-class",this.clonedImageStyleClassName="draggable-cloned-image-style-class",this.draggableContainerCountStyleClassName="draggable-count-container-class",this.primarytabbedDraggableStyleClassName="primary-tabbed-draggable-container-class",this.secondarytabbedDraggableStyleClassName="secondary-tabbed-draggable-container-class",this.m_dragReadyElements=e}return Object.defineProperty(e.prototype,"dragReadyElements",{get:function(){return this.m_dragReadyElements},set:function(e){this.m_dragReadyElements=e},enumerable:!0,configurable:!0}),e.prototype.createDragDropVisual=function(e){var t;if(this.m_dragReadyElements&&1<this.m_dragReadyElements.length){(t=document.createElement("div")).className=this.multipleDraggableOuterContainerStyleClassName;var n=e.cloneNode(!0),i=document.createElement("div");i.className=this.multipleDraggableInnerContainerStyleClassName,n.children[0].className=this.clonedSlideStyleClassName,n.children[0].children[0].className=this.clonedImageStyleClassName;var r=document.createElement("div");r.className=this.draggableContainerCountStyleClassName;var o=document.createElement("span");o.innerText=this.m_dragReadyElements.length.toString();var s=document.createElement("div");if(s.className=this.primarytabbedDraggableStyleClassName,2<this.m_dragReadyElements.length){var a=document.createElement("div");a.className=this.secondarytabbedDraggableStyleClassName,i.appendChild(a)}r.appendChild(o),i.appendChild(n),i.appendChild(r),i.appendChild(s),t.appendChild(i)}else(t=e.cloneNode(!0)).className=this.singleDraggableStyleClassName;return t.setAttribute("aria-hidden","true"),t},e}();t.DragDropVisualFactory=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=function(){function e(){this._onSlideSelectionChanged=new i.Event,this._onVisibleSlideRangeChanged=new i.Event,this._onSlideGridScrolled=new i.Event,this._onMoveSlide=new i.Event,this._onSectionTitleUpdate=new i.Event,this._onActiveSectionFocusChanged=new i.Event,this._onSectionSelectionChanged=new i.Event,this._onInsertBetweenSlidesPositionChanged=new i.Event}return Object.defineProperty(e.prototype,"onSlideSelectionChanged",{get:function(){return this._onSlideSelectionChanged},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onSectionSelectionChanged",{get:function(){return this._onSectionSelectionChanged},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onVisibleSlideRangeChanged",{get:function(){return this._onVisibleSlideRangeChanged},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onSlideGridScrolled",{get:function(){return this._onSlideGridScrolled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onMoveSlide",{get:function(){return this._onMoveSlide},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onSectionTitleUpdate",{get:function(){return this._onSectionTitleUpdate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onActiveSectionFocusChanged",{get:function(){return this._onActiveSectionFocusChanged},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onInsertBetweenSlidesPositionChanged",{get:function(){return this._onInsertBetweenSlidesPositionChanged},enumerable:!0,configurable:!0}),e}();t.SlideGridEvents=r},,,,,,function(e,t){}]);
//# sourceMappingURL=SlideGrid.js.map