'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1201:function(J,V,d){d.r(V);J=d(0);var h=d(374),e=d(332),m=d(25),r=d(69),v=d(91),A=d(66),x=d(94),y=d(178),u=d(55),H=d(13),G=d(38),E=d(118),I=d(64),Q=d(354),D=d(26);class Y{constructor(){this.slideHeight=this.slideWidth=this.debounceWaitTimeInMs=this.throttleTimeoutInMs=0;this.enableSelectionBetweenSlides=this.enableTriggerSelectionFromActiveSlideChange=this.enableTriggerSelectionFromRightClick=this.enableTriggerSelectionFromDoubleClick=
this.allowSectionEdit=this.allowSectionsInKeyboardFocusOrdering=this.allowMoveSlide=this.allowMultipleSelect=this.isRTL=!1;this.dragDropScrollTimeoutInMs=this.dragDropScrollThresholdInPx=this.sectionTitleMaxLength=0;this.enableRevisionTrackingInfo=!1;this.revisionTrackingFlyoutContent=null;this.shouldDisplayModernCatchupUx=this.shouldRenderAnimationOrTransitionInfo=this.commentsEnabled=this.isDisplayPresenceIcon=!1}}Object(J.a)(Y,"SlideGridSettings",null,[]);var M=d(73),N=d(140),W=d(52),K=d(28);class ca{constructor(ab,
fb,db,gc,ob,Sb){this.dYc=this.TYc=this.UYc=this.sTa=this.nW=this.f3=this.kp=null;this.El=this.QEa=!1;this.Ng=null;this.X2=-1;this.Sxb=this.eyb=!1;this.d9b=this.I_c=0;this.B2c=this.FXc=this.QWc=-1;this.ZEa=this.p3=0;this.HEa=!0;this.gEa=0;this.Jwb=null;this.nf=ab;this.r_=fb;this.ia=db;this.Ua=gc;this.xo=ob;this.KTa=!1;this.vD=null;this.Or=Sb;this.HXj=m.AFrameworkApplication.fa.Gc("PPTCloseGridViewTimeoutMs",500);this.ODg=m.AFrameworkApplication.fa.Gc("PPTGridViewDisplayNoneTimeoutMs",800);this.i_j=
m.AFrameworkApplication.fa.Gc("PPTGridViewTransitionTimeoutMs",500);this.q$a=[];this.mOg=m.AFrameworkApplication.fa.appSettings[W.a.pa(1091)]}wb(){this.ia.ya(K.a.JGb,G.a.application,Object(H.a)(this,this.JGb,"showGridView"));this.ia.ya(K.a.$jd,G.a.application,Object(H.a)(this,this.$jd,"toggleGridView"));this.Ua.xY(Object(H.a)(this,this.Gda,"onSlideshowExitHandler"))}JGb(ab,fb,db){return 2===db?this.TKe():32}TKe(){try{const ab=(new Date).getTime();D.a.J(537012229,822,15,"ShowGridView: Open grid view.");
this.zIb(this.QWc);this.QWc=-1;this.zIb(this.FXc);this.FXc=-1;this.zIb(this.B2c);this.B2c=-1;this.KTa=!0;this.QEa=this.eyb=this.Sxb=!1;const fb=this.xo.kS();if(!fb)return D.a.J(537012230,822,10,"ShowGridView: slideOrder is null."),this.GRd(),8;D.a.J(537012231,822,15,"ShowGridView: slideOrder length: {0}.",fb.length);this.xo.iah();this.Ua.C2a(Object(H.a)(this,this.Bda,"onGetCurrentPositionHandler"));this.HEa=!0;const db=this.xo.eeg();!this.Jwb||db.width===this.Jwb.width&&db.height===this.Jwb.height||
(D.a.J(537012232,822,50,"ShowGridView: thumbnailSize updated, new width: {0}, new height: {1}, old width: {2}, old height: {3}",db.width,db.height,this.Jwb.width,this.Jwb.height),this.GRd());if(this.kp&&this.kp.za){this.kp.deb("pptonline-slideshow-grid-view-transition-class");this.kp.za.style.display=M.a.wl;this.kp.za.style.opacity="1";this.p3=Date.now();this.Ng.events.onSlideSelectionChanged.subscribe(Object(H.a)(this,this.VGb,"slideSelectionChangeHandler"));this.Ng.events.onVisibleSlideRangeChanged.subscribe(Object(H.a)(this,
this.AJb,"visibleSlideRangeChangedHandler"));let ob=this.r_.qnb(fb,this.xo.E6a());this.fFd(ob);this.Ng.slideDataList=ob;this.Ng.sectionDataList=this.r_.pnb(ob)}else{this.Yvi();v.a.addHandler(this.kp.za,A.a.Rf,Object(H.a)(this,this.xz,"keyDownHandler"));this.Or.aZ&&!this.vD&&(this.vD=Object(H.a)(this,this.HTi,"fullScreenChangeHandler"),$addHandler(this.nf,this.Or.aZ,this.vD));let ob=this.r_.qnb(fb,this.xo.E6a());const Sb=this.r_.pnb(ob);this.Jwb=db;const Jb=this.Q5h(db);if(!this.Ng){const Ab=new Y;
Ab.throttleTimeoutInMs=1E3;Ab.debounceWaitTimeInMs=200;Ab.allowMultipleSelect=!1;Ab.allowSectionsInKeyboardFocusOrdering=!0;Ab.slideWidth=Jb.width;Ab.slideHeight=Jb.height;Ab.enableSelectionBetweenSlides=!1;Ab.isRTL=m.AFrameworkApplication.isRtl;this.Ng=SlideGrid.SlideGridFactory.CreateSlideGrid(Ab,this.UYc)}this.p3=Date.now();this.Ng.events.onSlideSelectionChanged.subscribe(Object(H.a)(this,this.VGb,"slideSelectionChangeHandler"));this.Ng.events.onVisibleSlideRangeChanged.subscribe(Object(H.a)(this,
this.AJb,"visibleSlideRangeChangedHandler"));this.Ng.show([0],0,ob,Sb);this.Sia()&&v.a.addHandler(this.kp.za,A.a.focus,Object(H.a)(this,this.bik,"onGridViewContainerDivFocus"))}this.Ua.getCurrentPositionWithTimeLines();if(this.mOg)this.ia.Ma(K.a.$ig,2,null);else if(this.Sia()){const ob=document.getElementById("slideshow-toolbar");ob&&(ob.style.display=M.a.og)}const gc=document.getElementById("LiveURLBarLayerHost");gc&&(gc.style.display=M.a.og);this.kp.deb("pptonline-slideshow-grid-view-transition-class");
this.kp.za.style.display=M.a.wl;this.kp.za.style.opacity="1";this.t3a(null);x.FocusManager.xr(this.kp.za);this.Ua.pausePresentation();this.Mmc(!1);this.xo.aCf(Object(H.a)(this,this.MBb,"onDataStoreUpdated"));this.Ua.JWa(Object(H.a)(this,this.bMe,"slideChangedHandler"));D.a.J(537012233,822,50,"GridViewActor: time taken for ShowGridViewImpl: {0}.",(new Date).getTime()-ab);return 32}catch(ab){return D.a.J(537012234,822,10,"GridViewActor: Exception in ShowGridView: {0}.",ab),this.d$k(),8}}$jd(ab,fb,db){try{if(2===
db)if(D.a.J(537012235,822,15,"ToggleGridView called."),this.KTa)this.Mmc(!0),this.eAa(!1);else return this.TKe();return 32}catch(gc){return D.a.J(537012236,822,10,"GridViewActor: Exception in ToggleGridView: {0}.",gc),8}}Q5h(ab){const fb=new E.a(0,0);ab.height&&ab.width?(ab=ab.width/ab.height,1<=ab?(fb.width=247,fb.height=247/ab):(fb.height=247,fb.width=247*ab)):(fb.width=247,fb.height=247/1.76);return fb}Sia(){return this.Ua.ivb()}Bda(ab,fb){try{this.Ua.GWa(Object(H.a)(this,this.Bda,"onGetCurrentPositionHandler")),
this.X2=fb.slideIndex,this.Ua.VNc(this.X2,fb.imc)}catch(db){D.a.J(537012237,822,10,"Exception in GoToSlideWithTimeLines: {0}.",db)}try{this.Sia()&&this.kp&&(this.kp.za.style.display=M.a.wl);this.kp&&x.FocusManager.xr(this.kp.za);this.gEa=0;const db=this.xo.kS();if(db){const gc=this.r_.qnb(db,this.xo.E6a());this.fFd(gc);const ob=this.r_.pnb(gc);this.Ng.show([this.X2],this.X2,gc,ob)}}catch(db){D.a.J(537012238,822,10,"Exception in OnGetCurrentPositionHandler: {0}.",db)}}bMe(ab,fb){try{if(this.eyb&&fb){const db=
fb.slideIndex;this.X2!==db||0>this.X2?D.a.J(537012239,822,15,"GridViewActor-SlideChangedHandler: currentSelectedSlideIndex not equal to slideIndex in args. currentSelectedSlideIndex: {0}, slideIndex: {1}.",this.X2,db):(this.Ua.JWa(Object(H.a)(this,this.bMe,"slideChangedHandler")),this.Ua.Cra(db),this.d9b=Date.now(),this.zAg(),this.eAa(!0),this.eyb=!1)}}catch(db){D.a.J(537012240,822,10,"Exception in SlideChangedHandler: {0}.",db)}}bik(){this.Ng&&this.Ng.restoreFocusToGrid()}xz(ab){try{if(ab.keyCode===
y.a.LJb)this.Nob(null);else if(ab.keyCode===y.a.Xp){const fb=this.q$a?this.q$a[this.gEa]:null;!fb||fb.className!==this.TYc.className&&fb.className!==this.dYc.className||this.Nob(null)}else if(ab.keyCode===y.a.rJb&&!this.Or.B7)this.KTa&&(this.Sia()?this.Ua.exit():this.Ua.irb(),this.eAa(!1));else if(ab.keyCode===y.a.tq)ab.preventDefault(),ab.stopPropagation();else if(ab.keyCode===y.a.dE)this.Ng.activeFocusSlideIndex=0;else if(ab.keyCode===y.a.mw){const fb=this.xo.kS();fb&&0<fb.length&&(this.Ng.activeFocusSlideIndex=
fb.length-1)}ab.ctrlKey&&ab.keyCode===y.a.I0&&((this.gEa=ab.shiftKey?Math.abs((this.gEa-1)%this.q$a.length):(this.gEa+1)%this.q$a.length)?0<this.gEa?x.FocusManager.xr(this.q$a[this.gEa]):D.a.J(537012241,822,15,"GridViewActor: wrong focus index value: {0}.",this.gEa):this.Ng.restoreFocusToGrid())}catch(fb){D.a.J(537012242,822,10,"GridViewActor: Exception in KeyDownHandler : {0}.",fb)}}MBb(ab,fb){try{const gc=this.xo.kS();if(gc){var db=this.r_.qnb(gc,this.xo.E6a());this.fFd(db);this.Ng.slideDataList=
db;this.Ng.sectionDataList=this.r_.pnb(db);if(fb.SlideIndex){const ob=fb.SlideIndex;-1!==ob&&(0<=ob&&ob<gc.length?this.t3a(gc[ob]):D.a.J(537012244,822,10,"OnDataStoreUpdated: slideIndex is invalid: {0}.",ob))}else D.a.J(537012245,822,10,"OnDataStoreUpdated: SlideIndex is null from eventData.")}else D.a.J(537012243,822,10,"OnDataStoreUpdated: slideOrder is null.")}catch(gc){D.a.J(537012246,822,10,"Exception in OnDataStoreUpdated: {0}.",gc)}}t3a(ab){try{const fb=this.Ng.visibleSlideRange;let db=!1;
if(ab)for(const gc of fb){if(gc.slideSid===ab.sid){db=!0;break}}else db=!0;if(db){ab=!0;for(const gc of fb)for(const ob of this.Ng.slideDataList)if(ob.slideID.slideSid===gc.slideSid&&ob.slideID.slideCid===gc.slideCid&&!ob.thumbnailImage){ab=!1;break}ab&&0<this.p3&&(this.ZEa=Date.now(),D.a.J(537012247,822,15,"VisibleSlideRangePLT - firstVisibleRangePLTCalc: {0}, visibleSlideLength: {1}, startTime: {2}, endTime: {3}, elapse: {4}.",this.HEa,fb.length,this.p3,this.ZEa,this.ZEa-this.p3),this.HEa&&(this.HEa=
!1),this.ZEa=this.p3=0)}}catch(fb){D.a.J(537012248,822,10,"Exception in CheckAndLogVisibleSlideRangePLT: {0}.",fb)}}VGb(ab,fb){try{this.I_c=Date.now();const ob=fb.slideIndex;D.a.J(537012249,822,15,"GridViewActor: SlideSelectionChangeHandler - targetSlideIndex: {0}.",ob);if(0>this.X2)D.a.J(537012250,822,10,"GridViewActor-SlideSelectionChangeHandler: wrong currentSelectedSlideIndex: {0}.",this.X2);else{var db=this.xo.kS();if(!db||0>=db.length)D.a.J(537012251,822,10,"GridViewActor-SlideSelectionChangeHandler: wrong slideOrder.");
else{var gc=this.X2===db.length-1;this.X2!==ob||gc?(this.Ua.rpa(Object(H.a)(this,this.bMe,"slideChangedHandler")),this.X2=ob,this.eyb=!0,this.Mmc(!0),0<=ob&&this.Ua.Cra(ob),this.zIb(this.QWc),this.QWc=window.setTimeout(()=>{try{this.KTa&&this.eyb&&this.eAa(!0)}catch(Sb){D.a.J(537012253,822,10,"GridViewActor: Exception in closeGridViewTimeoutHandler: {0}.",Sb)}},this.HXj)):(D.a.J(537012252,822,15,"GridViewActor: SlideSelectionChangeHandler - targetSlideIndex is the same to currentSelectedSlideIndex: {0}",
this.X2),this.eyb||(this.Mmc(!0),this.d9b=Date.now(),this.zAg(),this.eAa(!0)))}}}catch(ob){D.a.J(537012254,822,10,"GridViewActor: Exception in SlideSelectionChangeHandler: {0}.",ob)}}Mmc(ab){this.Ua?(this.Ua.Zgb(ab),ab&&!this.QEa&&(u.a.rj||document.activeElement.blur(),this.Ua.restoreFocus())):D.a.J(537012255,822,10,"GridViewActor: m_frame is null in TryToggleSlideShowFrame.")}AJb(){try{this.p3=Date.now();this.t3a(null);const ab=this.Ng.visibleSlideRange,fb=[];for(const db of ab)fb.push(new I.a(Object.assign(new Q.a,
{Cid:db.slideCid,Sid:db.slideSid})));this.xo.Sdh(fb)}catch(ab){D.a.J(537012256,822,10,"GridViewActor: Exception in VisibleSlideRangeChangedHandler: {0}.",ab)}}fFd(ab){if(ab)for(const fb of ab)fb.slideAriaLabel=fb.slideTitle,fb.isHiddenSlide&&(fb.slideAriaLabel+=", "+ResourceStrings.l_SlideIsHidden),fb.slideAriaLabel+=" "+ResourceStrings.l_GridView_GridThumbnailTitle}Yvi(){this.kp=new N.a;this.q$a.push(this.kp.za);this.UYc=document.createElement("div");this.kp.za.appendChild(this.UYc);this.kp.za.setAttribute("tabindex",
"0");this.kp.za.setAttribute("aria-label",ResourceStrings.L_GridView_GridContainerTitle);this.TYc||(this.TYc=this.mRf());this.kp.za.appendChild(this.TYc);this.kp.za.id="pptonline-slideshow-grid-view-id";this.kp.za.className="pptonline-slideshow-grid-view-class";this.UYc.className="pptonline-slideshow-grid-view-inner-container-class";this.nf.appendChild(this.kp.za);this.kp.za.style.width="100%";this.kp.za.style.height="100%";this.kp.deb("pptonline-slideshow-grid-view-transition-class");this.kp.za.style.display=
M.a.wl;this.kp.za.style.opacity="1"}mRf(){const ab=document.createElement("div");this.q$a.push(ab);var fb=m.AFrameworkApplication.isRtl;ab.setAttribute("role","button");ab.className=fb?"pptonline-slideshow-grid-view-close-button-class rtl-ui":"pptonline-slideshow-grid-view-close-button-class";ab.setAttribute("tabindex","0");fb=document.createElement("i");fb.className="ms-Icon ms-Icon--Back";ab.appendChild(fb);ab.title=ResourceStrings.L_GridView_CloseButtonNewText;ab.setAttribute("aria-label",ResourceStrings.L_GridView_CloseButtonNewText);
v.a.addHandler(ab,A.a.click,Object(H.a)(this,this.Nob,"closeButtonClickHandler"));return ab}eAa(ab){try{if(D.a.J(537012257,822,50,"GridViewActor: CloseGridView called."),this.Sxb)D.a.J(537012258,822,15,"GridViewActor: GridView is in closing status.");else if(this.kp){this.Sxb=!0;this.xo.yRe();this.xo.Nbh(Object(H.a)(this,this.MBb,"onDataStoreUpdated"));this.kp.gt("pptonline-slideshow-grid-view-transition-class");this.f3&&(this.f3.za.style.display=M.a.og);ab?(this.zIb(this.B2c),this.zIb(this.FXc),
this.B2c=window.setTimeout(()=>{try{this.kp.za.style.opacity="0",this.KTa=!1}catch(db){D.a.J(537012259,822,10,"Exception in setZeroOpacityHandler: {0}.",db)}},this.ODg-this.i_j),this.FXc=window.setTimeout(()=>{try{this.Sxb=!1,this.kp.za.style.display=M.a.og}catch(db){D.a.J(537012288,822,10,"Exception in displayNoneTimeoutHandler: {0}.",db)}},this.ODg)):(this.kp.za.style.opacity="0",this.Sxb=this.KTa=!1,this.kp.za.style.display=M.a.og);this.Ng&&(this.Ng.events.onSlideSelectionChanged.unsubscribe(Object(H.a)(this,
this.VGb,"slideSelectionChangeHandler")),this.Ng.events.onVisibleSlideRangeChanged.unsubscribe(Object(H.a)(this,this.AJb,"visibleSlideRangeChangedHandler")));this.mOg&&this.ia.Ma(K.a.Hoh,2,null);var fb=document.getElementById("LiveURLBarLayerHost");fb&&(fb.style.display=M.a.wl)}}catch(db){D.a.J(537012289,822,10,"GridViewActor: Exception in CloseGridView: {0}.",db),this.Sxb=!1}}d$k(){try{if(!this.f3){this.f3=new N.a;this.nW=new N.a;this.dYc||(this.dYc=this.mRf());this.f3.za.appendChild(this.dYc);this.f3.za.appendChild(this.nW.za);
this.nW.gt("pptonline-slideshow-grid-view-error-ui-inner");const ab=document.createElement("div"),fb=document.createElement("span");fb.innerText=ResourceStrings.L_GridView_TryAgainError;ab.setAttribute("tabindex","0");ab.className="pptonline-slideshow-grid-view-error-ui-message";ab.appendChild(fb);this.nW.za.appendChild(ab);const db=document.createElement("div"),gc=document.createElement("span");gc.innerText=ResourceStrings.L_GridView_TryAgainButton;db.setAttribute("tabindex","0");db.className="pptonline-slideshow-grid-view-try-again-button";
db.appendChild(gc);this.nW.za.appendChild(db);v.a.addHandler(db,A.a.click,Object(H.a)(this,this.AQe,"tryAgainButtonClickHandler"));if(this.nf)this.nf.appendChild(this.f3.za);else{this.f3=null;return}this.f3.za.setAttribute("tabindex","0");this.f3.gt("pptonline-slideshow-grid-view-error-ui-class");this.f3.gt("pptonline-slideshow-grid-view-class")}this.nW.za.style.display=M.a.wl;this.f3.za.style.display="flex";v.a.addHandler(this.kp.za,A.a.Rf,Object(H.a)(this,this.xz,"keyDownHandler"));x.FocusManager.xr(this.kp.za)}catch(ab){D.a.J(537012290,
822,10,"Exception in ShowGridViewErrorUI: {0}.",ab)}}oLe(){if(!this.sTa){this.sTa=new N.a;this.sTa.gt("grid-view-spinner-class");const ab=document.createElement("div");ab.className="grid-view-spinner-inner-class";this.sTa.za.appendChild(ab);if(this.nf)this.nf.appendChild(this.sTa.za);else{this.sTa=null;return}}this.sTa.za.style.display="flex"}AQe(){try{this.oLe(),this.nW.za.style.display=M.a.og,window.setTimeout(()=>{this.f3&&(this.f3.za.style.display=M.a.og);this.sTa.za.style.display=M.a.og;this.TKe()},
1E3)}catch(ab){D.a.J(537012291,822,10,"Exception in TryAgainButtonClickHandler: {0}.",ab)}}zIb(ab){0<=ab&&window.clearTimeout(ab)}Gda(){try{this.QEa=!0,this.Ua.R_(Object(H.a)(this,this.Gda,"onSlideshowExitHandler")),this.KTa&&(this.Sia()||this.Ua.irb(),this.eAa(!1))}catch(ab){D.a.J(537012292,822,10,"GridViewActor: Exception in OnSlideshowExitHandler: {0}.",ab)}}HTi(){try{this.KTa&&(this.Sia()||this.Ua.irb(),this.eAa(!1))}catch(ab){D.a.J(537012293,822,10,"GridViewActor: Exception in FullScreenChangeHandler: {0}.",
ab)}}Nob(){try{this.Mmc(!0),this.eAa(!1)}catch(ab){D.a.J(537012294,822,10,"GridViewActor: Exception in CloseButtonClickHandler: {0}.",ab)}}zAg(){D.a.J(537012295,822,15,"GridViewActor: selectedSlideIndex: {0}, selectedTime: {1}, showTime: {2}, elapse: {3}",this.X2,this.I_c,this.d9b,this.d9b-this.I_c);this.d9b=this.I_c=0}dispose(){try{this.El||(this.El=!0,this.eAa(!1),this.Ua.R_(Object(H.a)(this,this.Gda,"onSlideshowExitHandler")),this.Or.aZ&&this.vD&&$removeHandler(this.nf,this.Or.aZ,this.vD),this.GRd())}catch(ab){D.a.J(537012296,
822,10,"GridViewActor: Exception in Dispose: {0}.",ab)}}GRd(){D.a.J(537012297,822,50,"GridViewActor: DisposeSlideGridComponentIfExist.");this.kp&&(v.a.removeHandler(this.kp.za,A.a.Rf,Object(H.a)(this,this.xz,"keyDownHandler")),this.nf.removeChild(this.kp.za),this.kp=null);this.Ng&&(this.Ng=null)}}Object(J.a)(ca,"GridViewActor",null,[1198,109]);var P=d(45);class ea{constructor(){this.presenceUser=this.slideID=null}}Object(J.a)(ea,"PresenceInfo",null,[]);class da{constructor(){this.color=this.initials=
this.userName=null}}Object(J.a)(da,"PresenceUser",null,[]);class ia{constructor(){this.sectionTitle=null;this.sectionIndex=0;this.slideIdList=null}}Object(J.a)(ia,"SectionData",null,[]);class C{constructor(){this.slideID=null;this.sectionIndex=this.slideOrderIndex=0;this.thumbnailImage=null;this.isHiddenSlide=!1;this.slideAriaLabel=this.slideTitle=null;this.hasUnreadChanges=!1;this.numComments=0;this.hasTransitionOrAnimation=!1}}Object(J.a)(C,"SlideData",null,[]);class oa{constructor(){this.slideSid=
this.slideCid=0}}Object(J.a)(oa,"SlideID",null,[]);class Z{constructor(ab){this.xo=ab}ZFf(ab){const fb=[];for(const db of ab)db.presenceUser&&(ab=Object.assign(new ea,{slideID:Object.assign(new oa,{slideSid:db.Lj.sid,slideCid:db.Lj.cid}),presenceUser:Object.assign(new da,{userName:db.userName,initials:P.a.lZd(db.userName,m.AFrameworkApplication.isRtl),color:db.presenceUser.color})}),fb.push(ab));return fb}qnb(ab,fb){const db=[];for(let ob=0;ob<ab.length;ob++){var gc=fb?fb[ab[ob].sid.toString()]:null;
const Sb=gc?gc.Ljd+", "+String.format(ResourceStrings.L_GridView_SlideSelectionNarratorTitle,ob+1,ab.length):String.format(ResourceStrings.L_GridView_SlideSelectionNarratorTitle,ob+1,ab.length),Jb=this.wdi(Sb,gc);gc=Object.assign(new C,{slideID:Object.assign(new oa,{slideCid:ab[ob].cid,slideSid:ab[ob].sid}),slideOrderIndex:ob,sectionIndex:this.xo.r2(ab[ob]),thumbnailImage:gc?gc.thumbnailImage:"",isHiddenSlide:gc?gc.isHiddenSlide:!1,slideTitle:Sb,hasUnreadChanges:gc?gc.hasUnreadChanges:!1,numComments:gc?
gc.numComments:0,hasTransitionOrAnimation:gc?gc.hasTransitionOrAnimation:!1,slideAriaLabel:Jb});db.push(gc)}return db}pnb(ab){const fb=this.xo.eQa();return fb&&0<fb.length?this.Gyi(fb):this.avi(ab)}wdi(ab,fb){const db=new Sys.StringBuilder;ab&&""!==ab&&db.append(ab);fb&&fb.hasUnreadChanges&&db.append(", "+ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);fb&&0<fb.numComments&&(1===fb.numComments?db.append(", "+String.format(ResourceStrings.l_SlideHasSingleCommentWithCount,fb.numComments)):
db.append(", "+String.format(ResourceStrings.l_SlideHasMultipleCommentsWithCounts,fb.numComments)));fb&&fb.hasTransitionOrAnimation&&db.append(", "+ResourceStrings.l_SlideHasAnimationOrTransition);return db.toString()}Gyi(ab){const fb=[];for(let gc=0;gc<ab.length;gc++){var db=[];for(const ob of ab[gc].SlideIds)db.push(Object.assign(new oa,{slideCid:ob.Cid,slideSid:ob.Sid}));db=Object.assign(new ia,{sectionIndex:gc,slideIdList:db,sectionTitle:ab[gc].Title});fb.push(db)}D.a.J(537012227,822,50,String.format("SlideGridHelper::CreateSectionListItems, sections count:{0}",
fb.length));return fb}avi(ab){const fb=[],db=Object.assign(new ia,{sectionTitle:"",sectionIndex:0,slideIdList:[]});for(const gc of ab)db.slideIdList.push(gc.slideID);fb.push(db);D.a.J(537012228,822,50,"SlideGridHelper: Created default section");return fb}}Object(J.a)(Z,"SlideGridHelper",null,[964]);var pa=d(284),ya=d(63),Ja=d(1033),Ka=d(187),ma=d(1154),ra=d(202);class Da{constructor(ab,fb,db,gc,ob=null){this.a9d=ab;this.qda=fb;this.Lbc=db;this.sectionIndex=gc;this.Ca=ob}}Object(J.a)(Da,"SlideMoveByIdData",
null,[]);class va{constructor(ab,fb){this.sectionIndex=ab;this.Ful=fb}}Object(J.a)(va,"UpdateSectionData",null,[]);var Fa=d(432),ka=d(42),qa=d(206),Ua=d(46);class Ya{constructor(ab,fb,db,gc,ob,Sb,Jb,Ab,lc,Mc,Jc,rb,cc,jb,Xb,yb,mb,Ub,ec,nc){this.Vka=this.nW=this.mL=this.V8=this.ZV=this.Ur=null;this.T9a=0;this.lGg=this.dJg=this.El=!1;this.Ng=null;this.wqe=!1;this.ZEa=this.p3=0;this.HEa=!0;this.nf=ab;this.r_=fb;this.ia=db;this.xo=gc;this.sa=ob;this.Wb=Sb;this.qc=Jb;this.Pb=Ab;this.Xc=lc;this.ua=Mc;this.yh=
Jc;this.ph=rb;this.Ga=cc;this.uD=jb;this.NG=Xb;this.Qd=yb;this.sbb=[];this.hc=mb;this.Oc=Ub;this.zD=nc;this.ZLg=ec;this.ZLg.H2a(Object(H.a)(this,this.C_,"onSlidePresenceChanged"))}wb(){this.ia.ra(K.a.JDe,G.a.application,Object(H.a)(this,this.mmj,"handleRenameSection"),4);this.ia.ra(K.a.qQe,G.a.application,Object(H.a)(this,this.Enj,"handleTriggerRenameSection"),4);this.ia.ra(K.a.Ced,G.a.application,Object(H.a)(this,this.Jmj,"handleSelectSectionAndSlides"),4)}ZXa(ab,fb,db){return 2===db?((ab=e.a.instance)&&
!this.lGg&&ab.jc("SlideGridFirstOpenSorterView",Date.now()),this.lGg=!0,this.Xc.ND(new qa.a(2)),ab=this.GLe(!1),m.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")&&m.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesIsEnabled")||this.ia.processAction(K.a.XUb,2),ab):32}GLe(ab){try{if(1===this.Pb.Aw&&!ab)return D.a.J(537012112,822,50,"ShowSorterView: already in sorter view."),32;this.Pb.Aw=1;D.a.J(537012113,822,15,"ShowSorterView: Open sorter view.");this.Ur||(this.ozi(),v.a.addHandler(this.Ur.za,
A.a.Rf,Object(H.a)(this,this.xz,"keyDownHandler")),this.O4k(),pa.a.instance.pb(this.Ur.za,Object(H.a)(this,this.CB,"contextMenuHandler")));this.Ng?this.dJg!==this.hc.An&&this.t$g():this.rSf();var fb=Object(ma.a)(132,this.ua.Ca);if(!fb)return D.a.J(537012114,822,50,"ShowSorterView: active slideNode is null."),this.moh(),32;const db=this.sa.rf();db&&db.length||D.a.J(537012115,822,50,"ShowSorterView: no selected slide nodes");this.Ga.Kj(Ua.a.vea,!0);this.xo.iah();this.yh.xM(Object(H.a)(this,this.hC,
"onActiveSlideChanged"));this.HEa=!0;const gc=this.xo.kS();D.a.J(537012116,822,15,"ShowSorterView: slideOrder length: {0}.",gc?gc.length:-1);this.Ur.za.style.display=M.a.wl;this.V8.style.display=M.a.wl;const ob=fb.slideIndex,Sb=ra.b(db,Ab=>Ab.slideIndex);ab={};ab.SlideNode=fb;try{this.ia.Ma(K.a.HQg,2,ab)}catch(Ab){D.a.J(537012117,804,15,String.format("ShowSorterView: Exception thrown while dismissing revision tracking changes for active slide. Exception Message - {0}",Ab.message))}this.rph(Sb,ob,
gc);fb=[];this.zD.instance?fb=this.zD.instance.f2():D.a.J(537012118,804,50,"ShowSorterViewImp: PresenceManager is null");this.Ng.presenceInfoList=this.r_.ZFf(fb);const Jb=this.ua.presentation;this.Ng.shouldDisplaySections=!(!Jb||!Jb.xp||!Jb.xp.length);this.ZV&&(this.ZV.za.style.display=M.a.og);this.t3a(null);this.xo.aCf(Object(H.a)(this,this.MBb,"onDataStoreUpdated"));this.Oc.Bga(Object(H.a)(this,this.Wz,"onUnifiedAppStateChanged"));return 32}catch(db){return D.a.J(537012119,822,10,"SorterViewActor: Exception in ShowSorterView: {0}.",
db),this.ual(),8}}rSf(){var ab=this.xo.eeg();ab=this.R5h(ab);if(!this.Ng){const fb=new Y;fb.throttleTimeoutInMs=1E3;fb.debounceWaitTimeInMs=200;fb.slideWidth=ab.width;fb.slideHeight=ab.height;fb.isRTL=m.AFrameworkApplication.isRtl;fb.allowMultipleSelect=!0;fb.allowMoveSlide=this.hc.An;fb.allowSectionsInKeyboardFocusOrdering=!0;fb.allowSectionEdit=this.hc.An;fb.enableSelectionBetweenSlides=!0;fb.enableTriggerSelectionFromDoubleClick=!0;fb.enableTriggerSelectionFromRightClick=!0;fb.enableTriggerSelectionFromActiveSlideChange=
!0;fb.sectionTitleMaxLength=m.AFrameworkApplication.fa.Gc("PptSorterViewSectionTitleMaxLength",100);fb.dragDropScrollThresholdInPx=150;fb.dragDropScrollTimeoutInMs=100;fb.enableRevisionTrackingInfo=!0;fb.revisionTrackingFlyoutContent=ResourceStrings.l_RevisionTracking_Slide_Has_Unread_Changes;fb.isDisplayPresenceIcon=!0;fb.shouldRenderAnimationOrTransitionInfo=!0;fb.commentsEnabled=!0;fb.shouldDisplayModernCatchupUx=m.AFrameworkApplication.fa.ka(W.a.pa(1166));this.Ng=SlideGrid.SlideGridFactory.CreateSlideGrid(fb,
this.V8);this.dJg=this.hc.An}}rph(ab,fb,db){this.p3=Date.now();this.Ng.selectedSlideIndexes=ab;this.Ng.activeFocusSlideIndex=fb;this.Ng.events.onSlideSelectionChanged.subscribe(Object(H.a)(this,this.VGb,"slideSelectionChangeHandler"));this.Ng.events.onVisibleSlideRangeChanged.subscribe(Object(H.a)(this,this.AJb,"visibleSlideRangeChangedHandler"));this.Ng.events.onMoveSlide.subscribe(Object(H.a)(this,this.HSg,"moveSlideHandler"));this.Ng.events.onSectionTitleUpdate.subscribe(Object(H.a)(this,this.phh,
"sectionTitleUpdateHandler"));this.Ng.events.onSectionSelectionChanged.subscribe(Object(H.a)(this,this.ohh,"sectionSelectionChangedHandler"));this.Ng.events.onActiveSectionFocusChanged.subscribe(Object(H.a)(this,this.lhh,"sectionFocusChangedHandler"));this.Ng.events.onInsertBetweenSlidesPositionChanged.subscribe(Object(H.a)(this,this.axj,"insertBetweenSlidesPositionChangedHandler"));db=this.r_.qnb(db,this.xo.E6a());const gc=this.r_.pnb(db);this.Ng.show(ab,fb,db,gc)}ual(){try{this.mL||this.pzi(),this.Ur&&
(this.Ur.za.style.display=M.a.wl),this.V8&&(this.V8.style.display=M.a.og),this.T9a=0,this.mL.za.style.display="flex",this.nW.za.style.display=M.a.wl,x.FocusManager.xr(this.mL.za),this.Ga.Kj(Ua.a.vea,!0)}catch(ab){D.a.J(537012120,822,10,"Exception in ShowSorterViewErrorUI: {0}.",ab)}}pzi(){this.mL=new N.a;this.nW=new N.a;this.mL.za.appendChild(this.nW.za);this.mL.za.setAttribute("tabindex","0");this.mL.za.setAttribute("aria-label",ResourceStrings.L_SlideSorter);this.nW.gt("pptonline-sorter-view-error-ui-inner-class");
var ab=document.createElement("div");ab.className="pptonline-sorter-view-error-ui-image-container-class";var fb=document.createElement("img");fb.src=this.Qd.rk("SlideSorterViewErrorIllustration.svg");ab.appendChild(fb);this.nW.za.appendChild(ab);ab=document.createElement("div");fb=document.createElement("span");fb.innerText=ResourceStrings.l_SlideSorterViewErrorPageTitle;ab.setAttribute("tabindex","0");ab.className="pptonline-sorter-view-error-ui-title-class";ab.setAttribute("aria-label",ResourceStrings.l_SlideSorterViewErrorPageTitle);
ab.appendChild(fb);this.nW.za.appendChild(ab);fb=document.createElement("div");var db=document.createElement("span");db.innerText=ResourceStrings.l_SlideSorterViewErrorPageText;fb.setAttribute("tabindex","0");fb.setAttribute("aria-label",ResourceStrings.l_SlideSorterViewErrorPageText);fb.className="pptonline-sorter-view-error-ui-message-class";fb.appendChild(db);this.nW.za.appendChild(fb);db=document.createElement("div");const gc=document.createElement("button");gc.className="pptonline-sorter-view-try-again-button-class";
const ob=document.createElement("span");ob.innerText=ResourceStrings.l_SlideSorterViewTryAgainText;db.className="pptonline-sorter-view-try-again-button-container-class";gc.setAttribute("aria-label",ResourceStrings.l_SlideSorterViewTryAgainText);gc.appendChild(ob);db.appendChild(gc);this.nW.za.appendChild(db);v.a.addHandler(gc,A.a.click,Object(H.a)(this,this.AQe,"tryAgainButtonClickHandler"));this.Ur?(this.Ur.za.appendChild(this.mL.za),this.mL.za.setAttribute("tabindex","0"),this.mL.gt("pptonline-sorter-view-error-ui-class"),
this.mL.gt("pptonline-sorter-view-class"),this.sbb.push(this.mL.za),this.sbb.push(ab),this.sbb.push(fb),this.sbb.push(gc)):(D.a.J(537012121,822,10,"SoterViweActor::ShowSorterViewErrorUI - no parent container."),this.mL=null)}oLe(){if(!this.Vka){this.Vka=new N.a;this.Vka.gt("pptonline-sorter-view-spinner-class");const ab=document.createElement("div");ab.className="pptonline-sorter-view-spinner-inner-class";this.Vka.za.appendChild(ab);if(this.Ur)this.Ur.za.appendChild(this.Vka.za);else{this.Vka=null;
D.a.J(537012122,822,10,"SoterViweActor::ShowLoadingSpinner - no parent container.");return}}this.Vka.za.style.display="flex"}AQe(ab){try{ab.preventDefault(),this.mL.za.style.display=M.a.og,this.oLe(),window.setTimeout(()=>{this.Vka&&(this.Vka.za.style.display=M.a.og);this.GLe(!0)},1E3)}catch(fb){D.a.J(537012123,822,10,"Exception in TryAgainButtonClickHandler: {0}.",fb)}}O4k(){this.uD.o7(Ua.a.vea,Ua.a.kj,this.Ur.za,()=>{this.Ng&&this.Ng.restoreFocusToGrid()},()=>{this.Ur&&this.Ur.deb("pptonline-sorter-view-f6focus-class")});
this.ph.pjc(Ua.a.vea,()=>{this.Ur&&this.Ur.gt("pptonline-sorter-view-f6focus-class")})}Wz(ab,fb){if(fb.X7a){D.a.J(537012124,822,50,"SorterViewActor: Re-loading slide grid on editing mode changed");this.t$g();ab=this.xo.kS();fb=this.ua.Ca.slideIndex;const db=ra.b(this.sa.rf(),gc=>gc.slideIndex);1===this.Pb.Aw&&(this.rph(db,fb,ab),ab=this.ua.presentation,this.Ng.shouldDisplaySections=!(!ab||!ab.xp||!ab.xp.length))}}t$g(){this.Ng=null;this.V8&&this.V8.firstChild&&this.V8.removeChild(this.V8.firstChild);
this.rSf()}R5h(ab){const fb=new E.a(0,0);ab.height&&ab.width?(ab=ab.width/ab.height,1<=ab?(fb.width=247,fb.height=247/ab):(fb.height=247,fb.width=247*ab)):(fb.width=247,fb.height=247/1.76);return fb}hC(ab,fb){try{if(fb.nla){fb.nla.zK&&this.MBb(null,{SlideIndex:-1});var db=this.xo.eQa(),gc=this.ua.qA;if(-1===gc||db[gc].SlideIds.length)if(this.wqe)this.wqe=!1;else{this.Ng.activeFocusSlideIndex=fb.nla.Ge;const ob=this.sa.rf();if(ob){const Sb=ra.b(ob,Jb=>Jb.slideIndex);this.Ng.selectedSlideIndexes=Sb}else D.a.J(537012126,
822,15,"SorterViewActor::OnActiveSlideChanged - selectedSlideNodes is null.");this.Ng.insertBetweenSlideIndex=-1}else this.Ng.insertBetweenSlideIndex=-1}else D.a.J(537012125,822,50,"SorterViewActor::OnActiveSlideChanged - active slide was null. CorrelationId")}catch(ob){D.a.J(537012127,822,10,"SorterViewActor::OnActiveSlideChanged Exception: {0}.",ob)}}C_(ab,fb){D.a.J(537012128,822,50,"OnSlidePresenceChanged: Add/Remove Presence User for slideID {0}",fb.slideId);ab=[];this.zD.instance?ab=this.zD.instance.f2():
D.a.J(537012129,804,50,"OnSlidePresenceChanged: PresenceManager is null");this.Ng&&(this.Ng.presenceInfoList=this.r_.ZFf(ab))}MBb(ab,fb){try{const ob=this.xo.kS();if(ob)if(ob.length){var db=this.ua.presentation,gc=this.r_.qnb(ob,this.xo.E6a());this.Ng.slideDataList=gc;this.Ng.sectionDataList=this.r_.pnb(gc);this.Ng.shouldDisplaySections=!(!db||!db.xp||!db.xp.length);ab=!1;try{ab="Number"===Object.getType(fb.SlideIndex).getName()}catch(Sb){D.a.J(537012160,822,10,"OnDataStoreUpdated: SlideIndex is null from eventData.",
Sb)}if(ab){const Sb=fb.SlideIndex;-1!==Sb&&(0<=Sb&&Sb<ob.length?this.t3a(ob[Sb]):D.a.J(537012161,822,10,"OnDataStoreUpdated: slideIndex is out of range: {0}.",Sb))}}else D.a.J(537012131,822,50,"OnDataStoreUpdated: ShowAddFirstSlidePane since slideOrder length is 0."),this.moh();else D.a.J(537012130,822,10,"OnDataStoreUpdated: slideOrder is null.")}catch(ob){D.a.J(537012162,822,10,"Exception in OnDataStoreUpdated: {0}.",ob)}}CB(ab){let fb=8;try{if(this.ZV&&this.ZV.za.style.display!==M.a.og||this.mL&&
this.mL.za.style.display!==M.a.og)return!0;if(ab.clientPoint&&"NaN"!==ab.clientPoint.x.toString()&&"NaN"!==ab.clientPoint.y.toString()){const db=ya.a.EPa(ab.clientPoint),gc=RegExp("edit-title"),ob=RegExp("title-input"),Sb=RegExp("content-image-view");if(!db.className.length&&void 0!==db.parentNode&&null!==db.parentNode&&0<db.parentNode.className.search(Sb))fb=this.ia.Ma(K.a.GNd,2,ab);else if(0<db.className.search(gc)||0<db.className.search(ob)){let Jb=this.jSf(ab);fb=this.ia.Ma(K.a.DNd,2,Jb)}else fb=
this.ia.Ma(K.a.DPf,2,ab)}else if(ab.clientPoint.x=ya.a.tKc(this.Ur.za),ab.clientPoint.y=ya.a.uKc(this.Ur.za),0<=this.ua.qA){let db=this.jSf(ab);fb=this.ia.Ma(K.a.DNd,2,db)}else this.sa.rf()&&0<this.sa.rf().length&&(fb=this.ia.Ma(K.a.GNd,2,ab))}catch(db){D.a.J(537012163,822,10,"Exception in ContextMenuHandler: {0}.",db),fb=8}return 32===fb}moh(){try{if(this.Ur){this.Ur.za.style.display=M.a.wl;this.V8.style.display=M.a.og;if(!this.ZV){const ab=m.AFrameworkApplication.isRtl;this.ZV=new N.a;this.ZV.za.className=
ab?"pptonline-sorter-view-add-first-slide-container-class rtl-ui":"pptonline-sorter-view-add-first-slide-container-class";this.ZV.za.title=ResourceStrings.l_ClickToAddSlide;this.ZV.za.setAttribute("aria-label",ResourceStrings.l_ClickToAddSlide);this.ZV.za.setAttribute("tabindex","0");const fb=document.createElement("span");fb.innerText=ResourceStrings.l_ClickToAddSlide;this.ZV.za.appendChild(fb);this.Ur.za.appendChild(this.ZV.za);v.a.addHandler(this.ZV.za,A.a.click,Object(H.a)(this,this.YYh,"addFirstSlidePaneClickHandler"))}this.ZV.za.style.display=
M.a.wl;this.ZV.za.focus()}else D.a.J(537012164,822,10,"ShowAddFirstSlidePane: no sorter view container.")}catch(ab){D.a.J(537012165,822,10,"Exception in ShowAddFirstSlidePane: {0}.",ab)}}YYh(){try{this.oAf()}catch(ab){D.a.J(537012166,822,10,"Exception in AddFirstSlidePaneClickHandler: {0}.",ab)}}oAf(){this.ia.processAction(K.a.nAf,2);this.ZV.za.style.display=M.a.og;this.V8.style.display=M.a.wl;this.Ryh();this.GLe(!0)}jSf(ab){const fb={};fb.contextMenuArgs=ab;fb.isEmptySection=0<=this.ua.qA?!this.qc.prb(this.ua.qA).length:
!1;return fb}t3a(ab){try{const fb=this.Ng.visibleSlideRange;let db=!1;if(ab)for(const gc of fb){if(gc.slideSid===ab.sid){db=!0;break}}else db=!0;if(db){ab=!0;for(const gc of fb)for(const ob of this.Ng.slideDataList)if(ob.slideID.slideSid===gc.slideSid&&ob.slideID.slideCid===gc.slideCid&&!ob.thumbnailImage){ab=!1;break}ab&&0<this.p3&&(this.ZEa=Date.now(),D.a.J(537012167,822,15,"VisibleSlideRangePLT - firstVisibleRangePLTCalc: {0}, visibleSlideLength: {1}, startTime: {2}, endTime: {3}, elapse: {4}.",
this.HEa,fb.length,this.p3,this.ZEa,this.ZEa-this.p3),this.HEa&&(this.HEa=!1),this.ZEa=this.p3=0)}}catch(fb){D.a.J(537012168,822,10,"Exception in CheckAndLogVisibleSlideRangePLT: {0}.",fb)}}ohh(ab,fb){try{const db=fb.sectionIndex,gc=fb.clickedAway;D.a.J(537012169,822,15,"SorterViewActor: SectionSelectionChangedHandler - targetSectionIndex: {0}.",db);if(gc||this.ua.qA!==db)if(this.ua.qA=gc?-1:db,!gc){const ob=this.xo.eQa();if(ob&&ob[db]){const Sb=this.qc.vLc(db,ob),Jb=this.qc.prb(db);this.Ng.selectedSlideIndexes=
Jb;this.Ng.activeFocusSlideIndex=ob[db].SlideIds.length?Sb:-1;this.UIb(Jb,!0);this.OIb(Sb)}}}catch(db){D.a.J(537012170,822,10,"SorterViewActor: Exception in SectionSelectionChangedHandler: {0}.",db)}}lhh(ab,fb){try{const db=fb.currentActiveFocusSectionIndex;this.ua.qA=db;let gc=fb.newActiveSlideIndex;gc=0<gc?gc:0;const ob=this.qc.prb(db);this.UIb(ob,!0);this.OIb(gc)}catch(db){D.a.J(537012171,822,10,"SorterViewActor: Exception in SectionFocusChangedHandler: {0}.",db)}}axj(ab,fb){try{let db=fb.insertIndex;
D.a.J(537012172,822,50,"SorterViewActor: InsertBetweenSlidesPositionChangedHandler - targetSlideIndex: {0}.",db);this.wqe=0>db?!1:!0;ka.a("SlideSorterInsertionAfterFirstSlide")?(--db,this.Wb.MCb=db):(db=db?db-1:db,this.Wb.MCb=0<=db?db:-1);this.UIb([db],!0);this.OIb(db)}catch(db){D.a.J(537012173,822,10,"SorterViewActor: Exception in InsertBetweenSlidesPositionChangedHandler: {0}.",db)}}VGb(ab,fb){try{const ob=fb.slideSelectionTrigger,Sb=fb.slideIndex,Jb=fb.isSelectingMultiple,Ab=fb.isSelectingRange;
this.ua.qA=-1;D.a.J(537012174,822,15,"SorterViewActor: SlideSelectionChangeHandler - targetSlideIndex: {0}.",Sb);const lc=this.xo.kS();if(!lc||0>=lc.length)D.a.J(537012175,822,10,"SorterViewActor-SlideSelectionChangeHandler: wrong slideOrder.");else{ab=!1;if(0<=Sb){var db=this.qc.UH(Sb);ab=this.sa.DTc(db)}if(5===ob&&ab)D.a.J(537012176,822,50,"SorterViewActor: SlideSelectionChangeHandler - mouse down on selected set of slides");else{db=[];if(Ab)if(this.ua.Ca&&0<=Sb){var gc=this.ua.Ca.slideIndex;ab=
gc<=Sb?gc:Sb;for(gc=gc<=Sb?Sb:gc;ab<=gc;ab+=1)db.push(ab)}else{D.a.J(537012177,822,10,"SorterViewActor-SlideSelectionChangeHandler: active slide in workspace is null.");return}else db=[Sb];0<=Sb&&(this.UIb(db,!Jb||Ab),Ab||this.OIb(Sb));1!==ob&&3!==ob||this.ia.processAction(K.a.Tfb,2)}}}catch(ob){D.a.J(537012178,822,10,"SorterViewActor: Exception in SlideSelectionChangeHandler: {0}.",ob)}}OIb(ab){D.a.J(537012179,822,50,"SorterViewActor: UpdateActiveSlideForWorkspace called with targetSlideIndex: {0}",
ab);0<=ab&&(ab=this.qc.UH(ab),this.Wb.Ca=ab)}UIb(ab,fb){D.a.J.apply(null,[537012180,822,50,"SorterViewActor: UpdateCurrentSelectedSlidesForWorkspace called with targetSlideIndexes: {0}"].concat(ab));if(fb){var db=[];for(fb=0;fb<ab.length;fb+=1){if(0>ab[fb])return;db.push(this.qc.UH(ab[fb]))}var gc;(gc=this.sa).tX.apply(gc,db)}else for(gc=0;gc<ab.length;gc+=1)if(fb=ab[gc],0<=fb){fb=this.qc.UH(fb);const ob=this.sa.rf();ob?this.sa.DTc(fb)||(ob.push(fb),(db=this.sa).tX.apply(db,ob)):D.a.J(537012181,822,
15,"SorterViewActor::UpdateCurrentSelectedSlidesForWorkspace - selectedSlideNodes is null.")}}AJb(){try{this.p3=Date.now();this.t3a(null);const ab=this.Ng.visibleSlideRange,fb=[];for(const db of ab)fb.push(new I.a(Object.assign(new Q.a,{Cid:db.slideCid,Sid:db.slideSid})));this.xo.Sdh(fb)}catch(ab){D.a.J(537012182,822,10,"SorterViewActor: Exception in VisibleSlideRangeChangedHandler: {0}.",ab)}}HSg(ab,fb){try{const ob=fb.dragStartIndexes;var db=fb.dropTargetIndex;const Sb=this.xo.kS();var gc=fb.sectionIndex;
gc=null!=gc?gc:-1;if(!Sb||db>Sb.length)D.a.J(537012183,822,10,"SorterViewActor-MoveSlideHandler: slide order is null or dropIndex {0} is larger than slideOrder length {1}.",db,Sb?Sb.length:-1);else if(ob)if(ab=db,fb.shouldInsertSlideAfter||(ab--,0>gc&&(gc=this.xo.r2(Sb[db])),D.a.J(537012185,822,50,"SorterViewActor: adjustedDropSlideIndex:{0}, sectionIndex:{1}.",ab,gc)),1!==ob.length||db!==ob[0]-1||0<=gc){fb=[];for(db=0;db<ob.length;db+=1)fb.push(Sb[ob[db]]);const Jb=new Da(!1,fb,0<=ab?Sb[ab]:null,
gc);this.ia.Ma(K.a.GSg,2,Jb)}else D.a.J(537012186,822,50,"SorterViewActor-MoveSlideHandler: no index change: {0}, so no move.",db);else D.a.J(537012184,822,10,"SorterViewActor: dragStartIndexes is null.")}catch(ob){D.a.J(537012187,822,10,"SorterViewActor: Exception in MoveSlideHandler: {0}.",ob)}}phh(ab,fb){try{const db=fb.sectionIndex,gc=fb.sectionTitleAfter,ob=this.xo.eQa();if(0<=db&&ob&&ob[db]&&ob[db].Title!==gc){const Sb=new va(db,gc);this.ia.Ma(K.a.NSe,2,Sb)}}catch(db){D.a.J(537012188,822,10,
"SorterViewActor: Exception in SectionTitleUpdateHandler: {0}.",db)}}xz(ab){try{let fb=!1;if(ab.keyCode===y.a.vO||ab.keyCode===y.a.WQ||ab.keyCode===y.a.A0||ab.keyCode===y.a.C0)ab.stopPropagation();else if(ab.keyCode===y.a.ona||ab.keyCode===y.a.fH)fb=!0,this.ia.processAction(K.a.LM,2);else if(ab.keyCode===y.a.dE)fb=!0,this.Ng.selectedSlideIndexes=[0],this.Ng.activeFocusSlideIndex=0,this.UIb([0],!0),this.OIb(0);else if(ab.keyCode===y.a.mw){fb=!0;const db=this.xo.kS();db&&0<db.length&&(this.Ng.selectedSlideIndexes=
[db.length-1],this.Ng.activeFocusSlideIndex=db.length-1,this.UIb([db.length-1],!0),this.OIb(0))}else if(ka.a("EnableCutInSorterView")&&this.Iia(ab)&&ab.keyCode===y.a.ioc)fb=!0,this.ia.processAction(K.a.ZPd,2),this.Ga.Kj(Ua.a.vea,!0);else if(this.Iia(ab)&&ab.keyCode===y.a.EJa)fb=!0,this.ia.processAction(K.a.oye,2),this.Ga.Kj(Ua.a.vea,!0);else if(this.Iia(ab)&&ab.keyCode===y.a.Thb)fb=!0,this.NG.paste(new Fa.a(!0),null,!1),this.Ga.Kj(Ua.a.vea,!0);else if(ab.ctrlKey&&ab.keyCode===y.a.FJa)fb=!0,this.ia.processAction(K.a.YR,
2),this.Ga.Kj(Ua.a.vea,!0);else if(ab.ctrlKey&&ab.keyCode===y.a.Xea){fb=!0;const db=this.ua.presentation;if(!db)throw Error.argumentNull("Presentation is null");0<(db.slides||[]).length?(this.ia.processAction(K.a.pla,2),this.Ga.Kj(Ua.a.vea,!0)):this.oAf()}else if(ab.shiftKey&&ab.keyCode===y.a.vna||ab.keyCode===y.a.vJa){fb=!0;const db=Ja.a.create(A.a.contextMenu,ab,1);this.CB(db)}else ab.keyCode===y.a.tq&&this.mL&&this.mL.za.style.display!==M.a.og&&this.ajj(ab);fb&&D.a.J(537012189,822,50,"SoterViewActor: processing shortcut key: {0}.",
ab.keyCode)}catch(fb){D.a.J(537012190,822,10,"SorterViewActor: Exception in KeyDownHandler: {0}.",fb)}}Iia(ab){if(ka.a("IsCommandKeyFixSorterView"))return u.a.ak?Ka.KeyInputManager.i_b(ab,"metaKey"):ab.ctrlKey;const fb=u.a.ak&&Ka.KeyInputManager.i_b(ab,"metaKey");return ab.keyCode===y.a.Rea&&!u.a.ak||fb}ajj(ab){this.T9a=ab.shiftKey?0<=this.T9a-1?this.T9a-1:this.sbb.length-1:(this.T9a+1)%this.sbb.length;0<=this.T9a&&x.FocusManager.xr(this.sbb[this.T9a]);ab.preventDefault();ab.stopPropagation()}mmj(ab,
fb,db){try{if(1===db){const gc=this.ua.presentation;return gc&&gc.xp&&gc.xp.length?32:8}2===db&&(D.a.J(537012191,822,50,"HandleRenameSection called."),this.Ng.editableSectionTitleIndex=this.ua.qA);return 32}catch(gc){return D.a.J(537012192,822,10,"SorterViewActor: Exception in HandleRenameSection: {0}.",gc),8}}Enj(ab,fb,db){try{if(1===db){const gc=this.ua.presentation;return gc&&gc.xp&&gc.xp.length?32:8}2===db&&this.Ng&&(this.Ng.activeFocusSlideIndex=this.ua.Ca.Ge,this.Ng.selectedSlideIndexes=[this.ua.Ca.Ge],
this.Ng.selectedSectionIndex=this.ua.qA,this.Ng.editableSectionTitleIndex=this.ua.qA);return 32}catch(gc){return D.a.J(537012193,822,10,"SorterViewActor: Exception in HandleTriggerRenameSection: {0}.",gc),8}}Jmj(ab,fb,db,gc,ob){try{if(2===db&&ob){D.a.J(537012194,822,50,"HandleSelectSectionAndSlides called.");ab=null;const Sb=this.xo.eQa();0<=ob.sectionIndex&&(this.Ng.selectedSectionIndex=ob.sectionIndex,ab=this.qc.prb(ob.sectionIndex));0<=ob.slideIndex&&!!ab&0<ab.length&&(this.Ng.activeFocusSlideIndex=
this.qc.vLc(ob.sectionIndex,Sb),this.Ng.selectedSlideIndexes=ab&&0<ab.length?ab:[ob.slideIndex])}return 32}catch(Sb){return D.a.J(537012195,822,10,"SorterViewActor: Exception in HandleSelectSectionAndSlides: {0}.",Sb),8}}ozi(){this.Ur=new N.a;this.V8=document.createElement("div");this.Ur.za.appendChild(this.V8);this.Ur.za.setAttribute("tabindex","0");this.Ur.za.setAttribute("role","tabpanel");this.Ur.za.setAttribute("aria-label",ResourceStrings.L_SlideSorter);this.Ur.za.id="pptonline-sorter-view-id";
this.Ur.za.className="pptonline-sorter-view-class";this.V8.className="pptonline-sorter-view-inner-container-class";this.nf.appendChild(this.Ur.za);this.Ur.za.style.width="100%";this.Ur.za.style.display=M.a.wl}kDc(ab,fb,db){2===db&&this.yNf();return 32}yNf(){try{D.a.J(537012224,822,50,"SorterViewActor: CloseSorterView called."),this.Ga.Kj(Ua.a.vea,!1),this.Ur&&(this.Ur.za.style.display=M.a.og),this.mL&&(this.mL.za.style.display=M.a.og),this.Vka&&(this.Vka.za.style.display=M.a.og),this.Ryh()}catch(ab){D.a.J(537012225,
822,10,"SorterViewActor: Exception in CloseSorterView: {0}.",ab)}}Ryh(){this.xo&&(this.xo.yRe(),this.xo.Nbh(Object(H.a)(this,this.MBb,"onDataStoreUpdated")));this.yh&&this.yh.H9(Object(H.a)(this,this.hC,"onActiveSlideChanged"));this.Oc&&this.Oc.tEb(Object(H.a)(this,this.Wz,"onUnifiedAppStateChanged"));this.Ng&&(this.Ng.events.onSlideSelectionChanged.unsubscribe(Object(H.a)(this,this.VGb,"slideSelectionChangeHandler")),this.Ng.events.onVisibleSlideRangeChanged.unsubscribe(Object(H.a)(this,this.AJb,
"visibleSlideRangeChangedHandler")),this.Ng.events.onMoveSlide.unsubscribe(Object(H.a)(this,this.HSg,"moveSlideHandler")),this.Ng.events.onSectionTitleUpdate.unsubscribe(Object(H.a)(this,this.phh,"sectionTitleUpdateHandler")),this.Ng.events.onSectionSelectionChanged.unsubscribe(Object(H.a)(this,this.ohh,"sectionSelectionChangedHandler")),this.Ng.events.onActiveSectionFocusChanged.unsubscribe(Object(H.a)(this,this.lhh,"sectionFocusChangedHandler")))}dispose(){try{this.El||(this.El=!0,this.ZLg.GDe(Object(H.a)(this,
this.C_,"onSlidePresenceChanged")),this.yNf(),this.Ur&&(pa.a.instance.zb(this.Ur.za,Object(H.a)(this,this.CB,"contextMenuHandler")),this.nf.removeChild(this.Ur.za),this.Ur=null))}catch(ab){D.a.J(537012226,822,10,"SorterViewActor: Exception in Dispose: {0}.",ab)}}}Object(J.a)(Ya,"SorterViewActorLazy",null,[109,965]);var Va=d(78),ua=d(37),Ca=d(422);class Ea{constructor(ab,fb){this.Ljd=null;this.hasUnreadChanges=this.isHiddenSlide=!1;this.numComments=0;this.hasTransitionOrAnimation=!1;this.slideID=ab;
this.thumbnailImage=fb}}Object(J.a)(Ea,"ThumbnailDataStoreItem",null,[]);class wb{constructor(ab,fb,db,gc,ob,Sb){this.va=new Va.a;this.mua=null;this.El=!1;this.Je=ab;this.A3c={};this.Kx=fb;this.l$b=db;this.qNg=gc;this.Dk=ob;this.Lka=Sb}E6a(){this.O$g();return this.A3c}iah(){this.Kx.LMa(Object(H.a)(this,this.A9,"onThumbnailDrawCompleted"));this.l$b.ZF(Object(H.a)(this,this.YA,"onChildTopologyChanged"));this.qNg.yk(Object(H.a)(this,this.HZg,"onSectionPropertyChanged"));this.Dk.l3h(Object(H.a)(this,
this.r_g,"onSlidesRemoved"));this.Dk.c3h(Object(H.a)(this,this.IZg,"onSectionRemoved"));this.Dk.b3h(Object(H.a)(this,this.GZg,"onSectionOrderChanged"));this.Lka.instance?this.Lka.instance.HCf(Object(H.a)(this,this.qdc,"onSlideUnreadStateChanged")):D.a.J(537012100,804,10,"ThumbnailDataStoreManager: m_revisionTrackingEventHandlers is null")}yRe(){this.Kx.sEb(Object(H.a)(this,this.A9,"onThumbnailDrawCompleted"));this.l$b.kO(Object(H.a)(this,this.YA,"onChildTopologyChanged"));this.qNg.Pm(Object(H.a)(this,
this.HZg,"onSectionPropertyChanged"));this.Dk.GNk(Object(H.a)(this,this.r_g,"onSlidesRemoved"));this.Dk.BNk(Object(H.a)(this,this.IZg,"onSectionRemoved"));this.Dk.ANk(Object(H.a)(this,this.GZg,"onSectionOrderChanged"));this.Lka.instance?this.Lka.instance.rch(Object(H.a)(this,this.qdc,"onSlideUnreadStateChanged")):D.a.J(537012101,804,10,"ThumbnailDataStoreManager: m_revisionTrackingEventHandlers is null")}kS(){try{return this.mua=this.Je.M4}catch(ab){return D.a.J(537012102,822,10,"ThumbnailDataStoreManager: Exception in GetSlideOrder: {0}",
ab),null}}r2(ab){return this.Je.r2(ab)}eQa(){return this.Je.eQa()}Sdh(ab){try{const fb={TriggerSource:"SlideGrid"};fb.TriggerSourceStartTime=Date.now();this.mua=this.Je.M4;let db=this.mua.length,gc=0;for(let Sb=0;Sb<this.mua.length;Sb++)for(let Jb=0;Jb<ab.length;Jb++)this.mua[Sb].sid===ab[Jb].sid&&this.mua[Sb].cid===ab[Jb].cid&&(Sb<=db&&(db=Sb),Sb>=gc&&(gc=Sb));const ob=new Ca.a(db,gc>db?gc-db+1:1);this.Je.cJe(ob,!0,fb)}catch(fb){D.a.J(537012103,822,10,"ThumbnailDataStoreManager: Exception in RequestThumbnails: {0}",
fb)}}aCf(ab){this.va.addHandler("ThumbnailDataStoreUpdated",ab)}Nbh(ab){this.va.removeHandler("ThumbnailDataStoreUpdated",ab)}eeg(){try{return this.Je.s2(0).OP}catch(ab){return D.a.J(537012104,822,10,"ThumbnailDataStoreManager: Exception in GetThumbnailSize: {0}",ab),new E.a(176,100)}}dispose(){try{this.El||(this.El=!0,this.yRe())}catch(ab){D.a.J(537012105,822,10,"ThumbnailDataStoreManager: Exception in Dispose: {0}.",ab)}}A9(ab,fb){fb&&fb.succeeded&&this.vWa(fb.slideIndex)}YA(ab,fb){try{2===fb.GY&&
(fb.node.isDirty||this.vWa(-1))}catch(db){D.a.J(537012106,822,10,"ThumbnailDataStoreManager: Exception in OnChildTopologyChanged: {0}.",db)}}HZg(ab,fb){fb.property===ua.a.nGe?(ab=fb.node)&&ab.bA&&0<ab.bA.length&&this.vWa(-1):fb.property===ua.a.sectionTitle&&this.vWa(-1)}IZg(ab,fb){D.a.J(537012107,822,50,"ThumbnailDataStoreManager: OnSectionRemoved handler called.");fb&&this.vWa(-1)}r_g(ab,fb){D.a.J(537012108,822,50,"ThumbnailDataStoreManager: OnSlidesRemoved handler called.");fb&&this.vWa(-1)}GZg(){this.vWa(-1)}qdc(ab,
fb){D.a.J(537012109,804,50,"ThumbnailDataStoreManager: OnSlideUnreadStateChanged handler called.");fb&&this.vWa(-1)}vWa(ab){this.O$g();const fb={};fb.SlideIndex=ab;this.va.raiseEvent("ThumbnailDataStoreUpdated",fb)}O$g(){this.mua=this.Je.M4;for(let ab=0;ab<this.mua.length;ab++){const fb=this.mua[ab];this.A3c[fb.sid.toString()]||(this.A3c[fb.sid.toString()]=new Ea(fb,""));const db=this.A3c[fb.sid.toString()],gc=this.Je.s2(ab);gc&&(gc.image&&gc.image.src&&gc.image.src.length&&(gc.L2?(D.a.J(537012110,
822,50,"ThumbnailDataStoreManager: slide {0} is not ready for render, Sid={1}, Cid={2}.",ab,fb.sid,fb.cid),db.thumbnailImage=""):db.thumbnailImage=gc.image.src),gc.Ud?db.hasUnreadChanges=gc.Ud.Bs:D.a.J(537012111,804,10,"ThumbnailDataStoreManager: SlideNode not found for thumbnail view element"),db.hasTransitionOrAnimation=gc.v2,db.isHiddenSlide=gc.zn,db.Ljd=gc.Ljd,db.numComments=gc.gVb)}}}Object(J.a)(wb,"ThumbnailDataStoreManager",null,[963]);class Oa{constructor(){this.K=null;this.CIg=!1}get name(){return"PowerPointWebEditor.SorterGrid"}Yb(ab){this.K=
ab}init(){e.a.instance&&e.a.instance.jc("SlideGridPackageLoaded",Date.now());this.Jvj()}Jvj(){try{this.CIg=m.AFrameworkApplication.fa.ka("PPTSorterViewEnabled");h.ULS.sendTraceTag(536941768,202,50,"SorterGrid:Init - Grid component package");const ab=e.a.instance;ab&&ab.jc("SorterGridFullAppSettingsReady",Date.now());this.VVb()}catch(ab){h.ULS.sendTraceTag(536941769,811,10,"PPTWebEditorSorterGridPackage: exception in OnFullAppSettingsReady: {0}",ab)}}VVb(){const ab=(new Date).getTime(),fb=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").iG();
var db=document.createElement("link");db.setAttribute("rel","stylesheet");db.setAttribute("type","text/css");db.setAttribute("href",this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptGridViewComponentCssUrl);fb.appendChild(db);db=m.AFrameworkApplication.fa.Ia("PPTFabricIconBackArrowCssUrl");const gc=document.createElement("link");gc.setAttribute("rel","stylesheet");gc.setAttribute("type","text/css");gc.setAttribute("href",db);fb.appendChild(gc);this.K.register(963,"PowerPointWebEditor.IThumbnailDataStoreManager").na(()=>
new wb(this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(7),this.K.resolve("Box4.Graph.IGraphInstance").Cd(68),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.Oa("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"))).ma();this.K.register(964,"PowerPointWebEditor.ISlideGridHelper").na(()=>new Z(this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"))).ma();
this.K.register(ca,"PowerPointWebEditor.GridViewActor").na(()=>new ca(fb,this.K.resolve("PowerPointWebEditor.ISlideGridHelper"),m.AFrameworkApplication.Va,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"))).ma();this.K.resolve("PowerPointWebEditor.GridViewActor").wb();if(this.CIg){let ob=document.getElementById("WACDocumentPanel");m.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")&&
m.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesIsEnabled")&&(db=this.K.resolve("PowerPointWebEditor.ITaskPaneManager"))&&(ob=db.za);this.K.register(965,"PowerPointWebEditor.ISorterViewActorLazy").na(()=>new Ya(ob,this.K.resolve("PowerPointWebEditor.ISlideGridHelper"),m.AFrameworkApplication.Va,this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IPasteManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.Oa("PowerpointPresence.IPresenceManager"))).ma();this.K.resolve("PowerPointWebEditor.ISorterViewActorLazy").wb();(db=this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))?(db.ND(new qa.a(2)),db.ND(new qa.a(1)),db.DCk()):h.ULS.sendTraceTag(536941770,811,15,"PPTWebEditorSorterGridPackage: no viewEventSource object.")}h.ULS.sendTraceTag(536941771,811,50,"PPTWebEditorSorterGridPackage: Time Taken to create and Register SorterGrid Objects: {0}",
(new Date).getTime()-ab)}dispose(){try{const ab=this.K.qb("PowerPointWebEditor.IThumbnailDataStoreManager"),fb=this.K.qb("PowerPointWebEditor.GridViewActor");ab&&ab.dispose();fb&&fb.dispose()}catch(ab){h.ULS.sendTraceTag(536941772,811,10,"PPTWebEditorSorterGridPackage: exception in Dispose: {0}",ab)}}static main(){r.a.instance.Ec(new Oa)}}Object(J.a)(Oa,"PPTWebEditorSorterGridPackage",null,[2,3]);Type.registerNamespace("PPTGridComponent");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.SorterGrid");
Oa.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.sortergrid.js.map