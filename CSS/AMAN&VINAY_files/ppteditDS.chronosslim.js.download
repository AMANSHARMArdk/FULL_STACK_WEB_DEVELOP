'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1086:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.y4g="WAC_Powerpoint";h.K1b=null;Object(J.a)(h,"AddinHostApp",null,[])},1099:function(J,V,d){J=d(0);var h=d(13),e=d(1154),m=d(228),r=d(229),v=d(66),A=d(96);class x extends m.a{constructor(M,N){super(M);this.Af=null;this.xH=N.get(8,!1);this.fR=N.get(6,0);this.element=M;this.element.className=x.q5a;this.a2a=this.createElement("ul");this.element.appendChild(this.a2a);
this.mn=N.get(10);this.mn.pb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.Fo=N.get(9);this.Fo.pb(v.a.pointerOut,this.element,Object(h.a)(this,this.Oy,"onPointerOut"));this.Fo.pb(v.a.pointerDown,this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior"));this.hM=N.get(13);this.hM.pb(this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior"))}NU(M){this.addHandler(r.a.No,M)}P_(M){this.removeHandler(r.a.No,M)}get p$(){return this.Af}dispose(){this.element&&
(this.mn.zb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.Fo.zb(v.a.pointerDown,this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),this.Fo.zb(v.a.pointerOut,this.element,Object(h.a)(this,this.Oy,"onPointerOut")),this.hM.zb(this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(M,N,W){this.hide();!M||0>=M.length||(this.xH?this.element.style.right=N+"px":this.element.style.left=
N+"px",this.element.style.top=W+"px",this.aGd(M),this.visible=!0)}aGd(M){this.Af=M;A.a.Vt(this.a2a);for(let N=M.length-1;0<=N;N--)this.kz(M[N])}kz(M){const N=document.createElement("li");N.style.backgroundColor=M.color;N.style.height=this.fR+"px";N.id="fly_"+M.clientId;N.style.lineHeight=this.fR+"px";A.a.Zw(N,M.userName);N.setAttribute("dir","auto");this.a2a.appendChild(N)}onClick(){this.hide();return!1}Oy(M){this.raiseEvent(r.a.No,new r.a(3,M));return!1}}x.q5a="prFlyout UIFont";Object(J.a)(x,"PresenceTooltipFlyoutControl",
m.a,[]);var y=d(72);class u extends m.a{constructor(M,N,W){super(M);this.mM=null;this.Af=[];this.element.className="prGlyph";this.Ic=N;this.W5=this.Ic.get(9);this.Rm=this.Ic.get(10);this.hM=this.Ic.get(13);this.d4d();this.kz(W);this.e0a=!1}get cO(){return this.Af.length}get p$(){return this.Af}NU(M){this.addHandler(r.a.No,M)}P_(M){this.removeHandler(r.a.No,M)}dispose(){this.CRe();super.dispose()}kz(M){Array.add(this.Af,M);2===this.cO?this.m$(!0):1===this.cO?this.m$(!1):this.m$(this.e0a)}BL(M){this.SUd(M)&&
(1<this.cO&&this.m$(!0),1===this.cO?this.m$(!1):1>this.cO&&this.hide())}show(){this.m$(2<=this.cO);this.visible=!0}hide(){this.visible=!1}gZd(M){return M?this.XZb(0,5):this.XZb(1,4)}SUd(M){for(let N=0;N<this.cO;N++)if(this.Af[N].clientId===M)return M=this.Af[N],Array.removeAt(this.Af,N),M;return null}m$(M){this.e0a!==M&&(this.mM&&this.element.removeChild(this.mM),this.mM=this.gZd(M),this.element.appendChild(this.mM),this.e0a=M);this.mM.childNodes[0].style.backgroundColor=this.Af[this.Af.length-1].color}XZb(M,
N){const W=this.Ic.get(6,0),K=this.Ic.get(14);return y.createClusteredImageFromClusterWithImageClass(W,W,this.Ic.get(M),this.Ic.get(N),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,K?K.cloneNode(!0):null)}iC(M){3!==M.Qf&&this.raiseEvent(r.a.No,new r.a(2,M));return!1}onClick(M){this.raiseEvent(r.a.No,new r.a(1,M));return!0}Oy(M){3!==M.Qf&&this.raiseEvent(r.a.No,new r.a(3,M));return!1}CRe(){this.element&&(this.W5.zb(v.a.pointerDown,this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),
this.W5.zb(v.a.pointerOver,this.element,Object(h.a)(this,this.iC,"onPointerOver")),this.W5.zb(v.a.pointerOut,this.element,Object(h.a)(this,this.Oy,"onPointerOut")),this.Rm.zb(v.a.doubleClick,this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),this.Rm.zb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.hM.zb(this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")))}d4d(){this.element&&(this.W5.pb(v.a.pointerDown,this.element,
Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),this.W5.pb(v.a.pointerOver,this.element,Object(h.a)(this,this.iC,"onPointerOver")),this.W5.pb(v.a.pointerOut,this.element,Object(h.a)(this,this.Oy,"onPointerOut")),this.Rm.pb(v.a.doubleClick,this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),this.Rm.pb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.hM.pb(this.element,Object(h.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")))}}
Object(J.a)(u,"PresenceTooltipGlyph",m.a,[]);var H=d(115);d(63);var G=d(197);class E extends m.a{constructor(M,N,W){super(M);this.Af=[];this.Jl=[];this.uH=0;this.gga=this.D5=!1;this.VJb=null;this.zfa={};this.Ic=W;this.Oi=W.get(8,!1);this.QF=W.get(11,!1);M=W.get(12,0);this.imageDimension=W.get(6,0);this.E1a=N;this.element.id=E.E5a();this.element.className=m.a.rpb("prControl",this.Oi);M&&(this.zIndex=M);this.rtl=this.Oi;this.dfb(N);this.$y=this.createElement("div");this.$y.className=this.QF?"prContainerV":
"prContainerHr";this.element.appendChild(this.$y);this.mMb=Array(this.uH);for(N=0;N<this.uH;N++)this.Fv[N]=new x(this.createElement("div"),this.Ic),this.Fv[N].NU(Object(h.a)(this,this.pF,"onInteractivityChanged")),this.element.appendChild(this.Fv[N].element)}get xdb(){return G.a.clone(this.Af)}getGlyph(M){return this.zfa[M]}get Fv(){return this.mMb}get $Rb(){return this.VJb}get wIa(){return this.imageDimension+2}get width(){return this.QF?this.wIa:this.E1a}get height(){return this.QF?this.E1a:this.wIa}NU(M){this.addHandler(r.a.No,
M)}P_(M){this.removeHandler(r.a.No,M)}dispose(){if(this.Fv)for(const M of this.Fv)M.P_(Object(h.a)(this,this.pF,"onInteractivityChanged")),H.a.Xw(M);H.a.jed(this.Jl);this.Jl=this.mMb=null;super.dispose()}tea(){this.aN();this.Ufb();this.visible=!0;this.D5=!1}Vfb(){!this.Jl||1>this.Jl.length||(this.aN(),this.visible=!0,this.Ufb(),this.ZGa(this.Jl[this.Jl.length-1]),this.D5=!0)}vwa(){if(this.Jl&&!(1>this.Jl.length)){this.visible=!0;this.Ufb();var M=0;for(const N of this.Jl)this.ZGa(N,M++);this.D5=!1;
this.gga=!0}}hide(){this.visible=!1;this.aN();for(let M=0;M<this.Jl.length;M++)this.Jl[M].hide();this.D5=!1}BUb(){if(!this.gga)return!1;let M=0;for(const N of this.Fv)N.visible&&M++;return this.gga=0<M&&(this.Af.length<=this.uH?M===this.Af.length:M===this.uH)}kz(M){if(!(0>=this.uH)){M.clientId||(M.clientId=(E.Ffa++).toString());if(M.clientId in this.zfa){var N=this.cS(M.clientId);if(0<=N){N=this.Af[N];if(N.color===M.color&&N.userName===M.userName)return;this.BL(M.clientId)}}N=this.BUb();var W=0;if(this.Af.length<
this.uH){var K=new u(this.createElement("div"),this.Ic,M);K.NU(Object(h.a)(this,this.pF,"onInteractivityChanged"));this.Oi&&!this.QF&&0<this.Af.length?this.$y.insertBefore(K.element,this.$y.firstChild):(this.$y.appendChild(K.element),W=this.Jl.length);Array.add(this.Jl,K)}else this.Oi&&!this.QF?K=this.Jl[0]:(W=this.Jl.length-1,K=this.Jl[W]),K.kz(M);K.show();this.zfa[M.clientId]=K;Array.add(this.Af,M);this.bnc(K,W);N&&this.vwa()}}BL(M){const N=this.BUb();N&&this.aN();this.kma(M);this.Af.length>=this.uH&&
this.Jl.length<this.uH&&this.WBe();0>=this.Af.length?this.hide():N&&this.vwa()}ocb(){}kma(M){var N=this.cS(M);0>N||(M=this.Af[N],Array.removeAt(this.Af,N),N=this.zfa[M.clientId],delete this.zfa[M.clientId],N.BL(M.clientId),this.bnc(N),0>=N.cO&&(this.$y.removeChild(N.element),Array.remove(this.Jl,N),N.dispose()))}Afb(){}WBe(){var M=this.n_d();!M||1>=M.p$.length||(M=Array.clone(this.Af),M.forEach(N=>{this.kma(N.clientId)}),M.forEach(N=>{this.kz(N)}))}cS(M){for(let N=0;N<this.Af.length;N++)if(this.Af[N].clientId===
M)return N;return-1}n_d(){return this.Oi&&!this.QF?this.Jl[0]:this.Jl[this.Jl.length-1]}position(M,N){this.element.style.top=N+"px";this.element.style.left=M+"px"}Ufb(){for(let M=0;M<this.Jl.length;M++)this.Jl[M].show()}aN(){for(let M=0;M<this.uH;M++)this.Fv[M].hide();this.gga=!1}ZGa(M,N=0){if(M)if(this.VJb=M,this.QF){const W=this.imageDimension;if(1<M.p$.length)this.Fv[N].show(M.p$,W,this.height-this.imageDimension);else{const K=this.$y.children.length;for(let ca=0;ca<this.$y.children.length;ca++)M.element===
this.$y.children[ca]&&this.Fv[N].show(M.p$,W,this.height-(K-ca)*this.wIa+2)}}else this.Fv[N].show(M.p$,this.width,0)}pF(M,N){var W=Object(e.a)(u,M);W=W?this.NYb(W):-1;if(2===N.type||1===N.type&&-1!==W&&!this.Fv[W].visible)this.ZGa(M);else if(1===N.type)this.aN(),this.D5=!1;else if(3===N.type){if(this.qYb(N.Ri))return;this.D5||this.aN()}this.raiseEvent(r.a.No,N)}qYb(M){M=E.r6a(M);let N=!1;for(const W of this.Fv)if(A.a.asa(W.element,M)){N=!0;break}return this.$y!==M&&A.a.asa(this.$y,M)||N}bnc(M,N=0){const W=
this.b7d(M);W&&0>=M.cO?this.Fv[N].hide():W?this.ZGa(M):this.Fv[N].hide()}NYb(M){let N=0;for(const W of this.Jl){if(M===W)return N;N++}return-1}b7d(M){const N=this.NYb(M);return!!this.$Rb&&M===this.$Rb&&-1!==N&&this.Fv[N].visible}dfb(M){this.uH=M===this.imageDimension?1:Math.floor(M/this.wIa);this.QF?(this.element.style.height=M+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=M+"px",this.element.style.height=this.imageDimension+"px")}static E5a(){return String.format("{0}-{1}",
"presencetooltip",E.Ffa++)}static r6a(M){M=M.nc.rawEvent;return M.relatedTarget||M.toElement}}E.Ffa=0;Object(J.a)(E,"PresenceTooltipControl",m.a,[396,109]);var I=d(217),Q=d(284),D=d(264);d.d(V,"a",function(){return Y});class Y{constructor(M){this.Ic=M;this.Ic.UC(10,I.a.instance);this.Ic.UC(9,D.a.instance);this.Ic.UC(6,16);this.Ic.UC(13,Q.a.instance)}KEc(M,N){return new E(M,N,this.Ic)}lpb(M){return new E(M,16,this.Ic)}}Object(J.a)(Y,"PresenceTooltipFactory",null,[395])},1113:function(J,V,d){J=d(0);
class h{}h.taskPaneWidth=330;Object(J.a)(h,"AppsForOfficeConstants",null,[]);d.d(V,"a",function(){return e});class e{constructor(){this.aV=null;this.resizeMaxWidth=this.resizeMinWidth=0;this.taskPaneWidth=h.taskPaneWidth;this.ZT=this.sourceLocationOverrideResourceId=null;this.bO={};this.onTaskPaneClose=null;this.isResizable=this.isModernPane=!1;this.sharedRuntimeId=null;this.isPaneAutoOpened=this.isPreload=!1}}Object(J.a)(e,"FirstPartyAddInOptionalParameters",null,[])},1188:function(J,V,d){d.d(V,
"a",function(){return A});J=d(0);var h=d(83),e=d(120),m=d(25),r=d(94),v=d(244);class A extends h.a{constructor(x,y=!1){super(x,!1,y)}get I3b(){return!1}get kK(){return v.a.fXb+"/modeless"}get Hvb(){return null}set Hvb(x){}get Dvb(){return null}set Dvb(x){}qj(x,y=null,u=null){this.RJ&&(u.isModal=!1);super.qj(x,y,u)}hide(){if(m.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.sc)this.cAh(),m.AFrameworkApplication.Ba.iw.ap(e.AFrame.v_),
super.hide()}WYh(){const x=m.AFrameworkApplication.Ba.iw,y=m.AFrameworkApplication.Ba.vr;x.q1(this.kK);x.kpa(this.kK);y.Bc(this.kK).parent=e.AFrame.kj}lpa(){r.FocusManager.ZL()&&(super.lpa(),this.WYh(),m.AFrameworkApplication.Ba.iw.SJ(e.AFrame.v_))}feb(){if(r.FocusManager.ZL()&&!m.AFrameworkApplication.Xg){const x=r.FocusManager.instance();x.n4(this.kK);const y=x.AP(this.kK);y&&y.gj.aE(null);x.kEb(this.kK)}}Yla(){"DL"===this.dpa||"DP"===this.dpa?super.Yla():m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.ka("WacAutoFitNonModalDialogIsEnabled")?
(this.cAh(),this.DGf()&&this.Nph(this.sc.clientHeight,this.sc.clientWidth)):this.AF()}AF(){this.Nph(h.a.PYe,h.a.TYe)}Nph(x,y){if(this.Dvb&&this.Hvb){let u,H;u=v.a.Iec+this.Hvb;H=v.a.Hec+this.Dvb;u+x>this.Yha()&&(u=this.Yha()-x);H+y>this.pra()&&(H=this.pra()-y);this.Bhd(u,H)}else super.AF()}h_d(x){if(!x)return null;x.endsWith("px")&&(x=x.substring(0,x.length-2));return v.a.Gub(x)?((x=parseInt(x))||(x=1),x):null}cAh(){if(this.sc&&this.sc.style){var x=this.h_d(this.sc.style.top);x&&(this.Hvb=x-v.a.Iec);
if(x=m.AFrameworkApplication.isRtl?this.h_d(this.sc.style.right):this.h_d(this.sc.style.left))this.Dvb=x-v.a.Hec}}}Object(J.a)(A,"ModelessCustomDialog",h.a,[])},1192:function(J,V,d){d.r(V);var h=d(0),e=d(374),m=d(1155),r=d(1156),v=d(13),A=d(1154),x;(function(z){z[z.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";z[z.cloudPolicySettings=1]="cloudPolicySettings";z[z.alternateAuthToken=2]="alternateAuthToken"})(x||(x={}));Object(h.b)("ApplicationFeatureHelperRequestType",x);class y{constructor(){this.message=
null;this.oy=0}}Object(h.a)(y,"HttpRequstToPromiseRejectData",null,[]);var u=d(95),H=d(180);class G{constructor(z,T){this.mb=z;this.Di=T}COd(z,T,ja,Ba=null,Ga=null,Fb=null,Rb=null,tc=null){const Ac=x[ja],kd=Ac+"RequestFailure";u.Health.instance.recordKpiUsage(kd,0,"jpittsdirects",null);return new Promise((nd,Bd)=>{e.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",Ac);const Zd=null!=Rb?Rb:this.mb.Gc("ApplicationFeatureHelperRequestQueueTimeout",
15E3),df=null!=tc?tc:this.mb.Gc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Di.wY(z,1,null,this.g2i(ja,Ba),Fb,1,Ke=>{e.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Ac);try{if(void 0===Ke||null===Ke||void 0===Ke.data||null===Ke.data||void 0===Ke.data.je||null===Ke.data.je){u.Health.instance.recordKpiFailure(kd,"Invalid RequestSucceededEventArgs",!1,!0,null);let Sf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
Ac);Bd(this.N_b(Sf,Ke))}else if(Ke.data.tf!==H.a.Xy){u.Health.instance.recordKpiFailure(kd,"HttpStatusCode_"+Ke.data.tf.toString(),!1,!0,null);let Sf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Ke.data.tf,Ac);Bd(this.N_b(Sf,Ke))}else{void 0!==Ga&&null!==Ga&&void 0!==Ke.data.lj&&null!==Ke.data.lj&&Ga(Ke.data.lj);var zf=T(Ke.data.je);if(zf)e.ULS.sendTraceTag(50622690,3004,
50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",Ac),nd(zf);else{u.Health.instance.recordKpiFailure(kd,"Parse Failure",!1,!0,null);let Sf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",Ac);Bd(this.N_b(Sf,Ke))}}}catch(Sf){u.Health.instance.recordKpiFailure(kd,"Unexpected Failure",!1,!0,null),zf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
Sf,Ac),Bd(this.N_b(zf,Ke))}},Ke=>{let zf;Ke.data?(u.Health.instance.recordKpiFailure(kd,"HttpStatusCode_"+Ke.data.tf.toString(),!1,!0,null),zf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Ke.data.tf,Ke.data.je||"No Data",Ac)):(u.Health.instance.recordKpiFailure(kd,"Invalid RequestFailedEventArgs",!1,!0,null),zf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
Ac));Bd(this.N_b(zf,Ke))},null,void 0,void 0,Zd,df)})}N_b(z,T){const ja=new y;ja.message=z;ja.oy=T&&T.data?T.data.tf:-1;return ja}g2i(z,T){const ja={};ja["x-UserDataSignature"]=this.mb.Ia("UserDataSignature");ja["x-LicensingIsEnabled"]=this.mb.ka("LicensingIsEnabled").toString();ja["x-CacheIsEnabled"]=this.mb.ka("LicensingRedisIsEnabled").toString();ja["x-OcpsIsEnabled"]=this.mb.ka("OcpsIsEnabled").toString();ja["x-LicensingAADIdIsEnabled"]=this.mb.ka("LicensingAadIdIsEnabled").toString();0===z&&
(ja["x-LicenseCheckOnTenantEnabled"]=this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1).toString(),ja["x-SupportUserConsentDependentFeatures"]="true",ja["x-AFHUserConsentGroupValue"]="0",ja["x-UseShellServiceForUserConsentGroup"]="true",ja["x-SMBUserLicensingEnabled"]="true");if(T)for(let Ba of T.keys)ja[Ba]=T.ga(Ba);return ja}}Object(h.a)(G,"HttpRequestToPromiseUtility",null,[]);var E=d(25),I;(function(z){z[z.loki=0]="loki";z[z.augloopACLP=1]="augloopACLP"})(I||
(I={}));Object(h.b)("AlternateAuthSupportApp",I);var Q=d(259),D=d(33);class Y{constructor(){this.Token=null;this.ExpirationTime=0}}Object(h.a)(Y,"WacAlternateAuthToken",null,[]);class M{constructor(z,T){this.skl=3E5;if(void 0===z||null===z||void 0===T||null===T)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.mb=z;this.Doc=new m.a(r.a.rt());this.UMb=new G(z,T);void 0!==Q.a.xce&&null!==Q.a.xce&&void 0!==Q.a.FVc&&null!==Q.a.FVc&&0<Q.a.FVc&&(z=new Y,z.Token=Q.a.xce,z.ExpirationTime=
Q.a.FVc,this.Doc.$("loki",z))}VVi(){let z=null;this.Doc.Kb(I[0])&&(z=this.Doc.ga(I[0]));return void 0===z||null===z||this.NMj(z)?this.vOi():Promise.resolve(z.Token)}NMj(z){return z.ExpirationTime-Date.now()<this.skl}vOi(){const z=new m.a(r.a.rt());z.$("X-AlternateAuthApp",I[0]);return this.UMb.COd(this.HPa("/afhs/AlternateAuthHelperHandler.ashx"),Object(v.a)(this,this.mqk,"parseAlternateAuthTokenResponse"),2,z).then(T=>{e.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",
I[0]);this.Doc.$(I[0],T);return T.Token},T=>{T=Object(A.a)(y,T);e.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",T.message,T.oy);return null})}mqk(z){let T=null;({Ev:T}=D.d(z));e.ULS.sendTraceTag(545821457,3004,T?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",z);return T}HPa(z){return String.format("{0}{1}?{2}",this.mb.Ia("WebServiceBase"),z,E.AFrameworkApplication.$g)}}Object(h.a)(M,"AlternateAuthHelper",
null,[655]);var N=d(1024);class W{constructor(z,T,ja){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=z;this.isEnabled=T;this.tierName=ja}}Object(h.a)(W,"FeatureStateChangeArgs",null,[]);var K=d(214),ca=d(218),P=d(55),ea=d(105),da=d(114),ia;(function(z){z[z.Enabled=0]="Enabled";z[z.Disabled=1]="Disabled"})(ia||(ia={}));Object(h.b)("FeatureState",ia);var C=d(57),oa=d(35),Z=d(88);class pa{constructor(z,T,ja=null,Ba=null,Ga=null){this.dPa=this.DU=this.vrf=this.cLa=this.Zwc=null;
this.UMb=new G(z,T);this.mb=z;this.fOh=z.Gc("LicensingMaxRetryAttempts",0);this.Tud=z.ka("IsO365ConsumerHost");this.Sud=z.ka("IsO365CommercialHost");this.Asc=z.ka("PremiumUpsellIsEnabled");this.IXe=ja;this.hyf=Ba;this.Da=Ga;this.bLa=z.ka("LicensingIsEnabled");this.qoa=z.ka("OcpsIsEnabled")&&this.Sud;this.pEd=z.ka("ShowPrivacyDialog")&&!!Ba;this.O5e=z.ka("IsAnonymousUser");this.oUd=new Promise(Fb=>{Fb(!1)});this.MYa=new Promise(Fb=>{Fb(!0)});this.cPa=new m.a(r.a.rt());this.iyc=!0;this.Tbf=this.Z3i();
this.u9d()&&!this.O5e?(void 0!==E.AFrameworkApplication.Ba&&null!==E.AFrameworkApplication.Ba&&(this.Zwc=E.AFrameworkApplication.Ba.aU,void 0!==this.Zwc&&null!==this.Zwc&&(this.cLa=this.Zwc.KAb("WebServiceCall","ApplicationFeatureHelperService"))),this.dPa=this.TQe()):this.dPa=new Promise(Fb=>{Fb({})});this.dPa.catch(Fb=>{e.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(Fb))});this.iyc&&(this.Asc=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(Fb=>{this.Asc=this.mb.ka("PremiumUpsellIsEnabled")&&
Fb;return null}))}Z3i(){const z=this.mb.Fu("AllLicensedFeatures")?this.mb.JB("AllLicensedFeatures"):[],T=new N.a;for(let ja=0;ja<z.length;ja++)T.add(z[ja]);return T}u9d(){return this.Sud||this.Tud}TQe(z=0,T=!1){e.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",T);const ja=K.a.oz();ja&&(ja.set("retryAttempt",z.toString()),ja.set("forceRefresh",T.toString()),ja.set("isO365ConsumerHost",this.Tud.toString()),ja.set("isO365CommercialHost",this.Sud.toString()),
ja.set("isFreemiumUpsellEnabled",this.Asc.toString()));u.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",ja);u.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",ja);void 0!==this.cLa&&null!==this.cLa&&this.cLa.start();let Ba=null;T&&(Ba=new m.a(r.a.rt()),Ba.$("x-LicensingForceRefresh","true"));this.vrf=new Date;return(this.bLa?this.UMb.COd(this.HPa("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(v.a)(this,this.pqk,"parseApplicationFeatureHelperResponse"),
0,Ba,Object(v.a)(this,this.ayk,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(Ga=>{const Fb=Object.assign(new Z.a,{durationMs:this.Mrh()});Fb.extendedProperties=ja;Fb.extendedProperties&&Ga&&(Fb.extendedProperties.set("featureCount",ea.a.count(Ga).toString()),Fb.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Ga).toString()),Fb.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Ga).toString()),this.DU&&Fb.extendedProperties.set("fromCache",
(this.DU<this.vrf).toString()));u.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Fb);return Ga},Ga=>{const Fb=Object.assign(new Z.a,{durationMs:this.Mrh()}),Rb=Object(A.a)(y,Ga);if(!Rb)return e.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),u.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Fb),new Promise((tc,Ac)=>{Ac(Ga)});Fb.extendedProperties=
ja;Fb.extendedProperties&&Fb.extendedProperties.set("status",Rb.oy.toString());u.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Fb);return 408===Rb.oy&&++z<=this.fOh?this.TQe(z):new Promise((tc,Ac)=>{Ac(Rb)})})}pqk(z){(z=D.b(z))?(e.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),e.ULS.sendTraceTag(50938594,3004,50,"{0}",z)):e.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return z.Features}HPa(z){var T=String.format("{0}{1}",this.mb.Ia("WebServiceBase"),z);this.mb.Fu("ApplicationFeatureHelperHttpCachingEnabled")&&this.mb.ka("ApplicationFeatureHelperHttpCachingEnabled")&&(z=pa.cMc(this.mb))&&0<z.length&&(this.iyc&&(z+="ucbf"),T=new ca.QueryStringBuilder(T),T.nj("afhskey",z),T=T.toString());return T}isFeatureEnabled(z,T){if(!this.qoa&&!this.pEd&&!this.bLa)return this.MYa;e.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
z);if("ConnectedServices"===z){var ja=this.qoa?this.IXe.h2("ControllerConnectedServicesEnabled"):this.MYa;const Fb=this.pEd?this.hyf.getSettings().then(Rb=>2!==Rb.DB,()=>T):this.MYa;return ja.then(Rb=>Rb?Fb:this.oUd)}ja=null;ja=this.qoa?this.IXe.isFeatureEnabled(z):this.MYa;let Ba=null;Ba=this.bLa?this.HDj(z,T):this.MYa;let Ga=null;Ga=this.pEd?this.hyf.isFeatureEnabled(z):this.MYa;return ja.then(Fb=>Fb?Ga.then(Rb=>Rb?Ba:this.oUd):this.oUd).then(Fb=>{this.Yzg(z,Fb,!0);return Fb},()=>{this.Yzg(z,T,
!1);return T})}Yzg(z,T,ja){e.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",z,T,ja)}getFeatureTier(z,T){if(!this.bLa)return new Promise(ja=>{ja(2)});e.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",z);return this.dPa.then(ja=>this.vNc(z,ja,T),()=>T)}isFreemiumUpsellEnabled(){return this.Asc&&this.Tud&&!this.O5e}launchUpsellExperience(z,T=null){e.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",
z));var ja=K.a.oz();ja&&(ja.set("experienceId",z),T&&ja.set("campaignId",T));u.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",ja);if(ja=C.a.instance.qb("Common.IInProductMessagingUIManager")){const Ba=Object(v.a)(this,this.Lij,"handleDimeTaskComplete");ja.Ayg(z,Ba,T)}else e.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Da.Ma(oa.a.QJc,
2,{["experience"]:z})}Xdb(z,T){if(!this.bLa)return null;if(!z||!T)return e.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const ja=da.a.create().toString();this.cPa.Kb(z)||this.cPa.$(z,new m.a(r.a.rt()));this.cPa.ga(z).add(ja,T);e.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",ja,z));return ja}fEb(z,T){this.bLa&&(z&&this.cPa.Kb(z)?
T&&da.a.isValid(T)?this.cPa.ga(z).Kb(T)?(e.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",T,z)),this.cPa.ga(z).remove(T)):e.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",T,z)):e.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
T,z)):e.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",z)))}vNc(z,T,ja){return this.iyc?z in T?T[z].LicenseTier:ja:z in T?this.Xqk(T[z],ja):ja}Xqk(z,T){switch(z.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return T}}Lij(){e.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.dPa.then(z=>{this.G$g(z)}).catch(()=>
{this.G$g({})})}G$g(z){e.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const T=this.TQe(0,!0);T.then(ja=>{this.dPa=T;ea.a.count(ja)>ea.a.count(z)?u.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let Ba of this.cPa.keys)if(Ba in ja){const Ga=this.vNc(Ba,ja,0);Ba in z?this.vNc(Ba,z,0)!==Ga&&this.ate(Ba,!0,Ga):this.ate(Ba,
!0,Ga)}else Ba in z&&this.ate(Ba,!1,this.vNc(Ba,z,0))}).catch(ja=>{u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);e.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(ja))})}ate(z,T,ja){e.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",z,T,ja);T=new W(z,T,ja);ja=this.cPa.ga(z);for(let Ba of ja)try{Ba.value(T)}catch(Ga){e.ULS.sendTraceTag(594051084,
3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",z,Ba.key,Ga.message))}}GDj(z,T){if(this.bLa){const ja=this.Tbf.contains(z);let Ba=!0,Ga="",Fb=!1;return this.dPa.then(Rb=>{z in Rb?(Rb=Rb[z],Ga=ia[Rb.FeatureState],Ba=1!==Rb.FeatureState):Ba=!ja;this.hAg(z,ja,Ga,Fb,T,Ba);return Ba},()=>{Fb=!0;ja&&(Ba=T);this.hAg(z,ja,Ga,Fb,T,Ba);return Ba})}return this.MYa}hAg(z,T,ja,Ba,Ga,Fb){e.ULS.sendTraceTag(557389507,
3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",z,T,Ba,ja,Ga,Fb)}HDj(z,T){if(this.iyc)return this.GDj(z,T);if(this.bLa){if(this.Tbf.contains(z))return this.dPa.then(ja=>z in ja,()=>T);e.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",z)}return this.MYa}ayk(z){try{z&&"Date"in z&&(this.DU=new Date(z.Date),
e.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.DU.toString()))}catch(T){e.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",T)}}Mrh(){if(void 0!==this.cLa&&null!==this.cLa){const z=this.cLa.vq;this.cLa.stop();return z}return null}static cMc(z){try{if(P.a.GNe){const T=z.Ia("UserDataSignature").split(".");if(1<T.length){const ja=window.self.atob(T[1]),Ba=JSON.parse(ja).LocalStorageKey;if(void 0!==Ba&&
null!==Ba&&0<Ba.length)return Ba}}}catch(T){e.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",T.toString())}return null}}Object(h.a)(pa,"ApplicationFeatureHelper",null,[656]);var ya=d(17);class Ja{constructor(z,T){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=z.PolicySettings;z=new Date;z.setMinutes(z.getMinutes()+T);this.ExpirationTime=z.getTime()}}Object(h.a)(Ja,"CloudPolicySettingsCacheData",null,[]);var Ka=d(418),ma=d(231),ra=d(280);class Da{static Hph(){return E.AFrameworkApplication.fa.ka("SideCarIsEnabled")?
Da.sed&&Da.CRc?new Promise(z=>{z(!0)}):new Promise((z,T)=>{Da.sed=ra.a.create(E.AFrameworkApplication.fa.Ia("SideCarUrl"));ma.a.nt(Da.sed);Da.sed.yM((ja,Ba)=>{(Da.CRc=Ba.succeeded)?z(Ba.succeeded):T(Ba.succeeded)})}):new Promise(z=>{z(!1)})}}Da.CRc=!1;Da.sed=null;Object(h.a)(Da,"SideCarLoader",null,[]);class va{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(h.a)(va,"CloudPolicySettingsData",null,[]);class Fa{constructor(z,T){this.ypd=0;this.mDc=null;this.UMb=
new G(z,T);this.mb=z;T=z.Ia("HostAuthType");this.qoa=z.ka("OcpsIsEnabled")&&z.ka("IsO365CommercialHost")&&!(void 0===T||null===T)&&"aad"===T.toLowerCase();this.Kef=D.b(z.Ia("OcpsDefaultSettings")||"{}");this.mOb=this.cMc();T=this.mb.Fu("ServicesControlsMicrosoftControllerServicesList")?this.mb.JB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Qpc=new N.a;for(let ja=0;ja<T.length;ja++)this.Qpc.add(T[ja]);this.qoa&&!z.ka("IsAnonymousUser")&&z.ka("SideCarIsEnabled")?this.mDc=this.Bnl():
this.mDc=this.SQe(this.qoa,this.HPa("/afhs/CloudPolicySettings.ashx"),Object(v.a)(this,this.wqk,"parseCloudPolicySettingsResponse"));this.mDc.then(()=>null).catch(ja=>{e.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(ja))})}h2(z,T=!0){if(!this.qoa){const Fb=this;return new Promise(Rb=>{Rb(Fb.z_b(z))})}let ja=this,Ba=this;const Ga=this.mDc.then(Fb=>{try{let Rb=null;Fb.PolicySettings&&"unknown"in Fb.PolicySettings&&(Rb=Fb.PolicySettings.unknown);if(Rb){if(z in Rb&&void 0!==Rb[z]&&null!==Rb[z])return new Promise(Ac=>
{Ac("0"!==Rb[z])});const tc=z.toLowerCase();if(tc in Rb&&void 0!==Rb[tc]&&null!==Rb[tc])return new Promise(Ac=>{Ac("0"!==Rb[tc])});e.ULS.sendTraceTag(51512667,3004,50,"Policy"+z+" not found, using default");return new Promise(Ac=>{Ac(ja.z_b(z))})}return new Promise(tc=>{tc(ja.z_b(z))})}catch(Rb){return e.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+z+" policy value. Error Message: {0}",Rb.message),ja.handleError(Rb.toString(),T,ja.z_b(z))}},Fb=>Ba.handleError(Fb,T,Ba.z_b(z)));Ga.then(Fb=>{e.ULS.sendTraceTag(50651667,
3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",z,Fb);return null});return Ga}isFeatureEnabled(z,T=!0){if(this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.JDj(z,T);let ja=new Promise(Ga=>{Ga(!0)}),Ba="";this.Qpc.contains(z)&&(Ba="ControllerConnectedServicesEnabled",ja=this.h2(Ba,T));ja.then(Ga=>{e.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
z,Ga,Ba);return null});return ja}JDj(z,T=!0){let ja=new Promise(Ga=>{Ga(!0)}),Ba="";"mso_sendASmile"===z?Ba="Enabled":"Survey"===z||"FloodgateSurvey"===z?Ba="SurveyEnabled":this.Qpc.contains(z)&&(Ba="ControllerConnectedServicesEnabled");""!==Ba&&(ja=this.h2(Ba,T));ja.then(Ga=>{e.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",z,Ga,Ba);return null});return ja}handleError(z,T,ja){return T?new Promise(Ba=>{Ba(ja)}):
new Promise((Ba,Ga)=>{Ga(z)})}SQe(z,T,ja){if(!z)return Promise.resolve(new va);let Ba=!1,Ga=null;u.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let Fb=this.fOd("GetCloudPolicySettings");return(new Promise((Rb,tc)=>{if(void 0!==this.mOb&&null!==this.mOb&&0<this.mOb.length){const Ac=this.hnl();if(void 0!==Ac&&null!==Ac){Ba=!0;Rb(Ac);return}}this.UMb.COd(T,ja,1,null,Object(v.a)(this,this.hyk,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.mb.Gc("CloudPolicySettingsRequestQueueTimeout",
15E3),this.mb.Gc("CloudPolicySettingsRequestSentTimeout",3E4)).then(Ac=>{e.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.nol(Ac);Rb(Ac);return Ac},Ac=>{tc(Ac);return null})})).then(Rb=>{({Tx:Fb,returnValue:Ga}=this.aid(Fb));var tc=K.a.oz();tc&&tc.set("FromCache",Ba.toString());tc=Object.assign(new Z.a,{durationMs:Ga,extendedProperties:tc});u.Health.instance.recordKpiSuccess("GetCloudPolicySettings",tc);return Rb})}Bnl(){return Da.Hph().then(()=>{e.ULS.sendTraceTag(593282845,
3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}HPa(z){return String.format("{0}{1}",this.mb.Ia("WebServiceBase"),z)}wqk(z){let T=null;({Ev:T}=D.d(z));e.ULS.sendTraceTag(50622687,3004,T?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",z);return T}hyk(z){try{if(void 0!==z&&null!==z&&"CheckIn-Interval"in z){const T=parseInt(z["CheckIn-Interval"]);void 0!==T&&null!==
T&&0<T&&(this.ypd=T)}}catch(T){e.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",T)}}z_b(z){return z in this.Kef?"0"!==this.Kef[z]:!0}hnl(){try{const z=Ka.a.instance.getItem(this.mOb);if(void 0===z||null===z)return e.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;e.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",z);const T=JSON.parse(z);
if(void 0===T||null===T)return e.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===T.ExpirationTime||null===T.ExpirationTime)return e.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(T.ExpirationTime)).getTime()<Date.now())return e.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),
null;const ja=new va;ja.PolicySettings=T.PolicySettings;ja.ControllerConnectedServicesFeatureNames=new ya.a;this.mb.Fu("ServicesControlsMicrosoftControllerServicesList")&&this.mb.JB("ServicesControlsMicrosoftControllerServicesList");for(let Ba of this.Qpc)ja.ControllerConnectedServicesFeatureNames.add(Ba);e.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return ja}catch(z){return e.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",
z.toString()),null}}nol(z){try{if(void 0===z||null===z||void 0===z.PolicySettings||null===z.PolicySettings)e.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.ypd)e.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const T=new Ja(z,this.ypd),ja=JSON.stringify(T);e.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",ja);Ka.a.instance.setItem(this.mOb,
ja);e.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(T){e.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",T.toString())}}cMc(){const z=pa.cMc(this.mb);return z&&0<z.length?"OCPS"+z:null}fOd(z){const T=C.a.instance.qb("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==T&&null!==T?T.wi("WebServiceCall",z):null}aid(z){if(void 0!==z&&null!==z){const T=z.vq;z.stop();return{returnValue:T,Tx:null}}return{returnValue:null,
Tx:z}}}Object(h.a)(Fa,"CloudPolicySettingsHelper",null,[653]);class ka{constructor(){this.eXf=this.JBh=this.DB=0;this.fXf=this.KBh=this.T3a="";this.mCd=this.wxa=2}clone(){const z=new ka;z.DB=this.DB;z.JBh=this.JBh;z.eXf=this.eXf;z.T3a=this.T3a;z.KBh=this.KBh;z.fXf=this.fXf;z.wxa=this.wxa;z.mCd=this.src;return z}get src(){return this.mCd}serialize(z=null){const T={};if(!z||z.contains(ka.zcb))T[ka.zcb]=this.DB;if(!z||z.contains(ka.scc))T[ka.scc]=this.T3a;if(!z||z.contains(ka.tcc))T[ka.tcc]=this.wxa;
return JSON.stringify(T)}static create(z,T=null){const ja=new ka;ja.mCd=z;void 0!==T&&null!==T&&(ka.zcb in T&&(ja.DB=T[ka.zcb]),ka.scc in T&&(ja.T3a=T[ka.scc]),ka.tcc in T&&(ja.wxa=T[ka.tcc]));return ja}static deserialize(z,T){try{const ja=JSON.parse(z);if(void 0!==ja&&null!==ja)return ka.create(T,ja);e.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",z);throw Error.argument("settingsData");}catch(ja){throw e.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",
ja.toString()),ja;}}}ka.zcb="CCS";ka.scc="CCSTime";ka.tcc="OfficePrivacyRoamedNoticeShown";Object(h.a)(ka,"UserPrivacySettings",null,[]);var qa=d(213);class Ua{constructor(z,T){if(void 0===z||null===z||void 0===T||null===T)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.mb=z;this.Di=T;this.CBd=this.Ic=null}HPa(z){var T=String.format("{0}RoamingServiceHandler.ashx?action=",this.mb.appSettings.RoamingServiceHandlerWebServiceBase||"");T=new Sys.StringBuilder(T);T.append(z);T.append("&");
T.append(E.AFrameworkApplication.$g);return T.toString()}executeRequest(z,T,ja,Ba=null){return this.Di.umb(z,T,Ba,null,2,ja,"33",!1,null,6E4)}saveSettings(z){return new Promise((T,ja)=>{try{if(void 0===this.Ic||null===this.Ic||void 0===z||null===z)e.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),ja("Can't determine setting changes to save");else{var Ba=this.Ic.DB!==z.DB;if(2===this.Ic.src&&Ba)this.eVk(z),T(!0);else{var Ga=this.iYk(z);if(void 0===
Ga||null===Ga||!Ga.length)e.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),ja("No changes to save");else if(1===this.Ic.src)T(this.Cxh(Ga));else if(0===this.Ic.src){e.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Ga);const Fb=this.executeRequest(this.HPa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Ga);Fb.continueWith(()=>{if(Fb.yn||Fb.Sl)e.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
T(!1);else{var Rb=Fb.result;void 0!==Rb.Qi&&null!==Rb.Qi&&void 0!==Rb.Qi.data&&null!==Rb.Qi.data&&Rb.Qi.data.tf===H.a.Xy?(e.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),T(!0)):(e.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),T(!1))}})}}}}catch(Fb){e.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",Fb.toString()),T(!1)}})}iYk(z){if(void 0===this.Ic||null===this.Ic||void 0===z||null===z)throw Error.invalidOperation("User Privacy settings have not been initialized");
const T=new ya.a;0===z.src?(this.Ic.DB!==z.DB&&(T.add(ka.zcb),T.add(ka.scc)),this.Ic.wxa!==z.wxa&&T.add(ka.tcc)):1===z.src&&this.Ic.DB!==z.DB&&T.add(ka.zcb);return T.count?z.serialize(T):(e.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.CBd){const z=this;this.CBd=new Promise(T=>{try{z.Ic?T(z.Ic.clone()):z.qnl().then(ja=>{z.Ic=ja;T(z.Ic.clone());return null},()=>{z.onl().then(ja=>{z.Ic=ja;T(z.Ic.clone());return null},()=>{z.pnl().then(ja=>
{z.Ic=ja;T(z.Ic.clone());return null},()=>{e.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");z.Ic=new ka;T(z.Ic.clone());return null});return null});return null})}catch(ja){e.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",ja.toString()),z.Ic=new ka,T(z.Ic.clone())}})}return this.CBd}qnl(){return new Promise((z,T)=>{try{const Ba=-1!==window.location.href.indexOf("&wd_pn=2");if(this.mb.ka("PrivacyDialogShouldCheckRoaming")||
Ba){var ja=this.executeRequest(this.HPa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");ja.continueWith(()=>{try{if(ja.yn||ja.Sl)e.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const Ga=ja.result;if(Ga&&Ga.Qi&&Ga.Qi.data)if(Ga.Qi.data.tf!==H.a.Xy)e.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Ga.Qi.data.tf);else{if(Ga.Qi.data.je){z(Ua.parse(Ga.Qi.data.je,0));e.ULS.sendTraceTag(51258447,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Ga.Qi.data.je);return}e.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else e.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");T("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Ga){e.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",
Ga.toString()),T("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else e.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),T("Roaming should not be used")}catch(Ba){e.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",Ba.toString()),T("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}onl(){return new Promise((z,T)=>{try{const ja=qa.a.get("WacUPToggleState");let Ba=null;void 0!==
ja&&null!==ja&&0<ja.length&&(Ba=decodeURIComponent(ja));if(void 0!==Ba&&null!==Ba&&0<Ba.length){const Ga=Ua.parse(Ba,1);e.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Ga.toString());z(Ga)}else{const Ga=ka.create(1),Fb=new ya.a;Fb.add(ka.zcb);const Rb=Ga.serialize(Fb);this.Cxh(Rb)?(e.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Rb),z(Ga)):(e.ULS.sendTraceTag(51258450,
3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Rb),T("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(ja){e.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",ja.toString()),T("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}pnl(){return new Promise(z=>{try{var T=-1!==window.location.href.indexOf("&wdccsoff=1");let ja=ka.create(2);T?(ja.DB=2,E.AFrameworkApplication.TVf(),e.ULS.sendTraceTag(51258451,
3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",ja.toString())):(ja.DB=1,e.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",ja.toString()));z(ja)}catch(ja){e.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",ja.toString()),T=ka.create(2),T.DB=1,z(T)}})}eVk(z){e.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===z.DB?E.AFrameworkApplication.TVf():
E.AFrameworkApplication.yIi();e.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",z)}Cxh(z){try{e.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",z);const T=this.mb.Ia("PrivacyCookieDomain")||"";if(!T||!T.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");e.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",z);return qa.a.zlh("WacUPToggleState",z,qa.a.qL,T)}catch(T){return e.ULS.sendTraceTag(50860942,
3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",T.toString()),!1}}isFeatureEnabled(z){return this.getSettings().then(T=>{const ja=this.mb.Fu("ServicesControlsMicrosoftControllerServicesList")?this.mb.JB("ServicesControlsMicrosoftControllerServicesList"):[],Ba=new N.a;for(let Ga=0;Ga<ja.length;Ga++)Ba.add(ja[Ga]);return Ba.contains(z)?2!==T.DB:!0},()=>{e.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",z);return!0})}static parse(z,T){try{return e.ULS.sendTraceTag(50860943,
3004,50,"Parsing user privacy settings {0} from {1}",z,T),ka.deserialize(z,T)}catch(ja){throw e.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",ja.toString()),ja;}}}Object(h.a)(Ua,"UserPrivacySettingsHelper",null,[654]);var Ya=d(69);class Va{constructor(){this.Ea=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Yb(z){this.Ea=z;this.Ea.register(653,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ma().na(()=>new Fa(E.AFrameworkApplication.fa,
E.AFrameworkApplication.Be));this.Ea.register(654,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ma().na(()=>new Ua(E.AFrameworkApplication.fa,E.AFrameworkApplication.Be));this.Ea.register(655,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ma().na(()=>new M(E.AFrameworkApplication.fa,E.AFrameworkApplication.Be));this.Ea.register(656,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ma().na(()=>new pa(E.AFrameworkApplication.fa,E.AFrameworkApplication.Be,
this.Ea.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Ea.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),E.AFrameworkApplication.Va))}init(){E.AFrameworkApplication.fa.gf(()=>{const z=this.Ea.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");E.AFrameworkApplication.fa.ka("LicensingIsEnabled")&&(z.isFeatureEnabled("LicensingTestFeature",!1).then(T=>{e.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",
T,E.AFrameworkApplication.fa.Ia("IsAnonymousUser"));return null}),z.getFeatureTier("LicensingTestFeature",0).then(T=>{e.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",T,E.AFrameworkApplication.fa.Ia("IsAnonymousUser"));return null}));this.Ea.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.sil()})}dispose(){}sil(){try{E.AFrameworkApplication.fa.ka("SideCarIsEnabled")&&Da.Hph().then(z=>
{e.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",z);return z})}catch(z){}}static main(){Ya.a.instance.Ec(new Va)}}Object(h.a)(Va,"ApplicationFeatureHelperPackage",null,[2,3]);var ua=d(505),Ca=d(82),Ea=d(6);class wb{constructor(z,T){this.Di=z;this.MC=T}dw(z,T,ja,Ba=null){return this.mGi(z,Ba,Ga=>this.Di.umb(Ga,2,ja,T,2,void 0,void 0,void 0,void 0,void 0,"2"))}mGi(z,T,ja){const Ba=!!T&&""!==T;let Ga=z;Ba&&(Ga=Ca.a.x2a(z,"perfTag",T));const Fb=
new Date;return ua.a.then(ja(Ga),Rb=>{const tc=+new Date-+Fb;if(!Rb||!Rb.Qi||!Rb.Qi.data)return Rb;Ba&&Rb.Qi.data.request&&this.BXk(Rb.Qi.data.request.getResolvedUrl(),T,tc);return Rb})}BXk(z,T,ja){z=this.MC.o9i(z);if(z.count&&(z=Ea.last(z))){const Ba={Message:"Request durations for activities calls."};Ba.PerfTag=T;Ba.CustomDuration=ja;Ba.PerformanceDuration=z.duration;e.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Ba))}}}Object(h.a)(wb,"CatchUpNetworkingWrapper",null,[849]);var Oa=d(367);class ab extends Oa.a{constructor(z,
T){super(z,T)}Lk(){return 6}}Object(h.a)(ab,"GetActivityFeedRequest",Oa.a,[]);class fb extends Oa.a{constructor(z,T,ja,Ba,Ga,Fb){super(z,T);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=ja;this.ActivityStatesToSet=Ba;this.ActivityStatesToReset=Ga;this.ResetUnseenCount=Fb}Lk(){return 7}}Object(h.a)(fb,"UpdateActivityFeedStateRequest",Oa.a,[]);var db=d(518);class gc{constructor(z,T,ja){this.bef=z;this.LZa=T;this.WZa=ja}getActivityFeed(z){return ua.a.then(this.WZa.execute(new ab(this.LZa(),
null),(T,ja,Ba)=>this.bef.dw(T,ja,Ba,"ActivityFeed"),z),T=>{if(!T)return e.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!T.Qi)return e.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;if(!T.Qi.data)return e.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!T.Qi.data.je)return e.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;T=db.a.q4a(T.Qi.data.je);
return T?T:(e.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}iql(z,T,ja,Ba,Ga){return ua.a.then(this.WZa.execute(new fb(this.LZa(),null,T,ja,Ba,Ga),(Fb,Rb,tc)=>this.bef.dw(Fb,Rb,tc,"UpdateActivityFeedState"),z),Fb=>{try{return Fb.succeeded}catch(Rb){return e.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception: "+Rb.message),!1}})}}Object(h.a)(gc,"CatchUpRequestHandler",null,[846]);var ob=d(209);class Sb{constructor(z){this.Blb=z;this.ucf=
new ob.a}eTj(){this.UTj()}UTj(){if(this.Blb){var z=T=>{this.ucf.contains("CatchUpChangesFeedback")||(this.ucf.add("CatchUpChangesFeedback"),T.logActivity("CatchUpChangesFeedback",null))};this.Blb.execute(T=>{window.setTimeout(()=>{z(T)},2E4)})}else e.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(h.a)(Sb,"FloodgateEventLogger",null,[]);class Jb{constructor(z){this.JQh=z}get duration(){return this.JQh.duration}}Object(h.a)(Jb,"PerformanceResourceTimingWrapper",
null,[]);class Ab{constructor(z){this.MC=z}o9i(z){const T=new ya.a;if(!this.MC)return T;z=this.MC.getEntriesByName(z,"resource");if(!z)return T;for(const ja of z)T.add(new Jb(ja));return T}}Object(h.a)(Ab,"PerformanceWrapper",null,[]);class lc{constructor(){this.Ea=null}get name(){return"Common.App.CatchUpActivity"}Yb(z){this.Ea=z;this.Ea.register(wb,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").ma().na(()=>new wb(E.AFrameworkApplication.Be,
new Ab(window.performance)));this.Ea.register(gc,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").ma().na(()=>new gc(this.Ea.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>E.AFrameworkApplication.$g,new db.a));this.Ea.register(Sb,"Common.App.CatchUpActivity.FloodgateEventLogger").ma().na(()=>new Sb(this.Ea.Oa("Common.ISystemInitiatedFeedback")))}init(){this.Ea.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");
this.Ea.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){Ya.a.instance.Ec(new lc)}}Object(h.a)(lc,"CatchUpActivityPackage",null,[2,3]);var Mc=d(1153),Jc=d(102);class rb{constructor(z,T,ja){this.pLe=this.qLe=this.rLe=!1;this.CLe=!z&&!T;this.DLe=!z&&!ja;this.CLe||this.DLe||(this.rLe=!z,this.qLe=!T,this.pLe=!ja)}}Object(h.a)(rb,"RenameDisabledDialogInfo",null,[]);class cc extends Jc.StandardDialog{constructor(z,T,ja,Ba,Ga){super();this.QOe=[];this.b1=new rb(z,T,ja);
this.vMa=Ba;this.VKa=Ga;this.kg="RenameDisabledDialog";this.vd=0;this.Pe(1,CommonUIStrings.l_DialogClose);this.v3k();this.aPk()}v3k(){this.b1.CLe?this.vkc(this.vMa?this.VKa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.b1.DLe?this.vkc(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.KZh();this.Lyc(this.QOe)}vkc(z){Array.add(this.QOe,z)}KZh(){const z=[];this.b1.rLe||
Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.b1.qLe||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.b1.pLe||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<z.length&&Array.add(this.QOe,z)}}Object(h.a)(cc,"ReactRenameDisabledDialogBase",Jc.StandardDialog,[]);class jb extends cc{constructor(z,T,ja,Ba,Ga){super(z,T,ja,Ba,Ga)}aPk(){this.NAb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(h.a)(jb,"ReactRenameDisabledDialog",
cc,[]);var Xb=d(83);class yb{static get Wf(){return Xb.a.tA(yb.Ym,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}yb.Ym="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(h.a)(yb,"RenameDisabledDialogHtml",null,[]);class mb extends Xb.a{constructor(z,T,ja,Ba,Ga){super();this.b1=new rb(z,T,ja);this.vMa=Ba;this.VKa=Ga;this.kg="RenameDisabledDialog";this.vd=0;this.Pe(1,CommonUIStrings.l_DialogClose);this.Wf=yb.Wf;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.D4("RenameRow")}Yua(){if(this.b1.CLe){let z;z=this.vMa?this.VKa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;mb.vkc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),z)}else this.b1.DLe?mb.vkc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.kqj()}kqj(){this.b1.rLe&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.b1.qLe&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.b1.pLe&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static vkc(z,T,ja){z.style.display="none";T.innerText=ja}}Object(h.a)(mb,"RenameDisabledDialog",Xb.a,[]);var Ub=d(45),ec=d(70);class nc{constructor(z,T){this.B0a=0;this.Da=z;this.Ona=T}initialize(z){if(!this.Da||!this.Ona)return!1;this.B0a=z;this.wb();return!0}wb(){this.Da.ya(oa.a.VMd,ec.a.frame,Object(v.a)(this,this.VMd,"commitNewDocumentTitle"))}VMd(z,T,ja,Ba,Ga){if(1===ja)return this.Da.processAction(oa.a.renameFile,
1);z=Ub.a.jG(this.Ona.nx);Ga=(0,Ga.getNewDocumentTitle)();Ga.length>this.B0a&&(Ga=Ga.substr(0,this.B0a));if(32!==this.Da.Ma(oa.a.renameFile,2,Ga))return this.fJb(z),8;this.fJb(Ga);return 32}fJb(z){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(z))}static IB(){return new nc(E.AFrameworkApplication.Va,E.AFrameworkApplication.$t)}}Object(h.a)(nc,"ReactRenameUIHandler",null,[881]);var Lb=d(262),Zc=d(656),Pb=d(563),eb=d(66),$a=d(187),vb=d(264),bc=d(132),Cc=d(63);class Gc{constructor(z,T,
ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd){this._initialized=!1;this._element=null;this.B0a=0;this.nBd=this.ztd=!1;this.Da=z;this.Iod=T;this.Kg=ja;this.Fo=Ba;this.Ona=Ga;this.Nsf=Fb;this.pwc=Rb;this.Dpd=tc;this.$na=Ac;this.r8e=kd;this.Zi=nd;this.vud=Bd}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(z,T,ja){if(!(this.Da&&this.Ona&&this.Nsf&&this.pwc&&this.Dpd&&T)||0>=z)return!1;this._element=T;this._element.title=ja;this._element.setAttribute(bc.a.ff,bc.a.St);this._element.setAttribute("Unselectable",
"on");this.B0a=z;this.VI();return this._initialized=!0}VI(){this.Iod&&(this.Iod.pb(eb.a.blur,this._element,Object(v.a)(this,this.onBlur,"onBlur")),this.Iod.pb(eb.a.paste,this._element,Object(v.a)(this,this.Xjk,"onPaste")));this.Kg.pb(eb.a.Rf,this._element,Object(v.a)(this,this.onKeyDown,"onKeyDown"));this.Fo.pb(eb.a.pointerDown,this._element,Object(v.a)(this,this.ava,"onPointerDown"));this.Fo.pb(eb.a.CQ,this._element,Object(v.a)(this,this.vve,"onPointerUp"))}onBlur(){this.isActive&&!this.ztd&&(this.r8e||
this.Dpd(this._element),this.BOf(),this.eQd(!1));return this.ztd=!1}Xjk(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(z){return this.isActive?this.Fik(z):this.Gik(z)}Fik(z){let T=!1;switch(z.nc.keyCode){case Sys.UI.Key.enter:this.BOf();this.eQd(this.Zi||this.vud);T=!0;break;case Sys.UI.Key.tab:this.r8e&&this.Dpd(this._element);break;case Sys.UI.Key.esc:this.SEe(),this.eQd(this.Zi||this.vud),T=!0}return T}Gik(z){let T=!1;switch(z.nc.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.wwh(this.vud),
this.isActive&&this.pwc(this._element),T=!0}return T}ava(){this.isActive||(this.wwh(!1),this.isActive&&(this._element.focus(),this.pwc(this._element),this.nBd=!0));return!1}vve(){return this.nBd?(this.pwc(this._element),this.nBd=!1,!0):!1}Uub(){return 32===this.Da.processAction(oa.a.renameFile,1)}BOf(){const z=Ub.a.jG(this.Ona.nx);let T=this._element.innerText.trim();T.length>this.B0a&&(T=T.substr(0,this.B0a));T!==z&&""!==T?32!==this.Da.Ma(oa.a.renameFile,2,T)?this.SEe():this.fJb(T):this.SEe()}SEe(){this.fJb(Ub.a.jG(this.Ona.nx))}fJb(z){this._initialized&&
(this._element.innerText=z,this.Nsf())}wwh(z){this.Uub()?this.isActive||(z&&(this.ztd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(bc.a.ff,bc.a.TFf),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Lb.CuiHelper.QXf),this.$na&&this.$na.execute(T=>{T.Q8g(!0)}),z&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Da.processAction(oa.a.QGb,
2)}eQd(z){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(bc.a.ff,bc.a.St);Sys.UI.DomElement.removeCssClass(this._element,Lb.CuiHelper.QXf);this.$na&&this.$na.execute(T=>{T.Q8g(!1)});z&&(this._element.blur(),this._element.focus())}static gXa(){Zc.a.gXa(E.AFrameworkApplication.isRtl)}static IB(){return new Gc(E.AFrameworkApplication.Va,Pb.a.instance,$a.KeyInputManager.instance,vb.a.instance,E.AFrameworkApplication.$t,Gc.gXa,
Cc.a.pWk,Cc.a.UMf,C.a.instance.Oa("Common.App.Header.HeaderEventSource"),P.a.XE,P.a.Ji,P.a.ag)}}Object(h.a)(Gc,"RenameUIHandler",null,[881]);class sd{static get instance(){return E.AFrameworkApplication.Ba.jb.kN?sd.Ka||(sd.Ka=nc.IB()):sd.Ka||(sd.Ka=Gc.IB())}}sd.Ka=null;Object(h.a)(sd,"RenameUIHandlerFactory",null,[]);class Sd{constructor(){this.Ese=this.$bk=this.SAi=null}}Object(h.a)(Sd,"RenameMruEntryProperties",null,[]);var ie=d(170),De=d(125),yd=d(426),ib;(function(z){z[z.unknown=-1]="unknown";
z[z.success=0]="success";z[z.renameInvalidFileName=1]="renameInvalidFileName";z[z.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";z[z.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";z[z.permissionDenied=4]="permissionDenied";z[z.serverCommunicationFailure=5]="serverCommunicationFailure";z[z.fileNameTooLong=6]="fileNameTooLong"})(ib||(ib={}));Object(h.b)("CommonOperationResult",ib);class dc{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd){this.h$e=z;this.Da=T;this.ifa=ja;this.iE=
Ba;this.r0a=Ga;this.vWh=Fb;this.vMa=Rb;this.Kxf=tc;this.YRh=Ac;this.VKa=kd;this.mb=nd;this.XRh=Bd}wb(){E.AFrameworkApplication.Ba&&E.AFrameworkApplication.Ba.jb.kN||this.Ho.ya(oa.a.n2b,ec.a.frame,Object(v.a)(this,this.n2b,"initializeRenameUIHandler"));this.Ho.ya(oa.a.QGb,ec.a.frame,Object(v.a)(this,this.QGb,"showRenameDisabledDialog"));this.Ho.ya(oa.a.renameFile,ec.a.frame,Object(v.a)(this,this.renameFile,"renameFile"));this.Ho.ra(oa.a.fileNameUpdate,ec.a.frame,Object(v.a)(this,this.qHk,"refreshFilename"),
64);this.Ho.ra(oa.a.n5c,ec.a.frame,Object(v.a)(this,this.n5c,"moveToFolderCompleteByHost"),64);this.Ho.ya(oa.a.ncb,ec.a.frame,Object(v.a)(this,this.ncb,"moveToFolder"));E.AFrameworkApplication.Ba&&(E.AFrameworkApplication.fa.ka("PostMessageEmbedded")||E.AFrameworkApplication.fa.ka("IsJsApi"))&&E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&E.AFrameworkApplication.tV().execute(z=>{z.Qt(De.a.LSg);z.cB(De.a.LSg,dc.xFk);z.Qt(De.a.DUd);z.cB(De.a.DUd,
dc.vFk)})}Uub(){return 0===this.XRh.Pbg()?32:8}jvl(){return this.oA?this.vMa?this.oA.ORd:this.oA.zBa:!0}n2b(){return sd.instance.initialize(E.AFrameworkApplication.LIc,E.AFrameworkApplication.VGc,E.AFrameworkApplication.tch||CommonUIStrings.l_RenameFileTooltip)?32:8}QGb(){const z=this.jvl(),T=this.vWh();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.r0a,T,z,this.vMa);E.AFrameworkApplication.Ba&&E.AFrameworkApplication.Ba.jb.QB&&E.AFrameworkApplication.fa.ka("ReactRenameDisabledDialogIsEnabled")?new jb(this.r0a,!T,!z,this.vMa,this.VKa()):new mb(this.r0a,!T,!z,this.vMa,this.VKa());return 32}renameFile(z,T,ja,Ba,Ga){if(1===ja)return this.Uub();if(!E.AFrameworkApplication.R4a)return 8;if(8===this.Uub())return this.Ho.processAction(oa.a.QGb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");E.AFrameworkApplication.R4a(Ga,Object(v.a)(this,
this.edc,"onRenameFileSuccess"),Object(v.a)(this,this.Hkk,"onRenameFileFailure"));return 32}edc(z,T){z?0!==z.OperationResult?this.pgg(z.OperationResult):(this.uXk(T,z.NewName),this.sql(z,Object(v.a)(E.AFrameworkApplication.Ba.jb,E.AFrameworkApplication.Ba.jb.sAh,"updateOpenInClientDocumentUrl")),E.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&E.AFrameworkApplication.Ba.updateCommandUI(),this.YRh.czh()):this.pgg(5)}uXk(z,T){const ja={};ja[ie.a.POi]=T;z.sendMessage(De.a.DUd,ja)}sql(z,
T){this.Dql(z);E.AFrameworkApplication.pGc=z.DirectInvokeDavUrl;T=T(z.EditDocInClientUrl);const ja=new Sd;ja.Ese=this.iE.nx;ja.SAi=T;ja.$bk=z.EditDocInClientUrl;this.Ho.Ma(oa.a.uch,2,ja)}pgg(z){switch(z){case 1:z=new Jc.StandardDialog,z.vd=0,z.nO(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.Deh()}}Dql(z){this.iE.nx=dc.g7h(this.iE.nx,z.NewName);z.BreadcrumbFolderName&&(this.iE.breadcrumbFolderName=z.BreadcrumbFolderName);z.BreadcrumbFolderUrl&&(this.iE.breadcrumbFolderUrl=
z.BreadcrumbFolderUrl);this.Kxf(z.NewName)}Hkk(z){const T=new Jc.StandardDialog;T.vd=0;switch(z){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");T.Wfb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");T.Wfb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:e.ULS.sendTraceTag(38114565,
203,15,"OnRenameFileFailure: {0}",{["Result"]:z}),T.Wfb(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}E.AFrameworkApplication.tV().execute(ja=>{ja.sendMessage(De.a.OOi,{["FailureMessage"]:ib[z]})});this.Deh()}qHk(z,T,ja){if(1===ja)return this.Uub();if(!E.AFrameworkApplication.Bqa)return 8;E.AFrameworkApplication.Bqa(Object(v.a)(this,this.aCb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.W7c,"onRefreshFilenameFailure"),!1);return 32}ncb(z,T,ja,Ba,
Ga){if(1===ja)return E.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?32:8;if(2===ja){const Fb={};z=E.AFrameworkApplication.R8a;T=E.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");z=(!z||z&&T)&&E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Fb[ie.a.Mfl]=z;Ga&&Ga.MoveButtonClickedTime&&(Fb[ie.a.bbk]=Ga.MoveButtonClickedTime.getTime());E.AFrameworkApplication.tV().execute(Rb=>{Rb.sendMessage(De.a.ncb,Fb)});Ga&&Ga.MoveButtonClickedTime&&
((z=K.a.oz())&&z.set("MovePostDuration",((new Date).getTime()-Ga.MoveButtonClickedTime.getTime()).toString()),u.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",z));return 32}return 8}n5c(z,T,ja,Ba,Ga){if(1===ja)return E.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?this.Uub():8;if(2===ja){if(!E.AFrameworkApplication.Vic)return u.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Ga)return u.Health.instance.recordKpiFailure("MoveToFolder",
"Null actiondata",!1,!1,null),8;if(Ga[ie.a.sCj])if(Ga[ie.a.mBh])if(z=Ga[ie.a.mBh].toLowerCase(),T=E.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),ja=E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),T&&E.AFrameworkApplication.R8a&&ja){const Fb={};Fb[ie.a.SDb]="1";Fb[ie.a.documentUrl]=z;Fb[ie.a.reason]=yd.a.QFe;u.Health.instance.recordKpiSuccess("MoveToFolder",null);E.AFrameworkApplication.tV().execute(Rb=>{Rb.sendMessage(De.a.TAa,Fb)})}else if(!E.AFrameworkApplication.R8a&&
ja)u.Health.instance.recordKpiSuccess("MoveToFolder",null),Cc.a.Qm(z,Cc.a.u$(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return u.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else u.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else E.AFrameworkApplication.Bqa(Object(v.a)(this,this.aCb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.W7c,"onRefreshFilenameFailure"),!1),E.AFrameworkApplication.Vic(),u.Health.instance.recordKpiSuccess("MoveToFolder",
null)}return 32}F8k(z,T){return z&&T?z!==this.iE.breadcrumbFolderName||T!==this.iE.breadcrumbFolderUrl:!1}aCb(z,T){z&&(z.NewName!==Ub.a.jG(this.iE.nx)||this.F8k(z.BreadcrumbFolderName,z.BreadcrumbFolderUrl))&&this.edc(z,T)}W7c(){}Deh(){this.Kxf(Ub.a.jG(this.iE.nx))}get Ho(){return this.Da.value}get oA(){return this.ifa.value}static get instance(){return dc.Ka||(dc.Ka=dc.I5a())}static I5a(){return new dc(E.AFrameworkApplication.e4b,new Mc.a(()=>E.AFrameworkApplication.Va),new Mc.a(()=>E.AFrameworkApplication.oA),
E.AFrameworkApplication.$t,E.AFrameworkApplication.XP,()=>E.AFrameworkApplication.xnc,E.AFrameworkApplication.Khc,Object(v.a)(sd.instance,sd.instance.fJb,"updateTitle"),C.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>E.AFrameworkApplication.wS,E.AFrameworkApplication.fa,C.a.instance.resolve("Common.IRenameProps"))}static g7h(z,T){z=Ub.a.nV(z);return T+z}static xFk(z){const T=z.Values[ie.a.NGj];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",T);
T?E.AFrameworkApplication.Va.Ma(oa.a.n5c,2,z.Values):u.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static vFk(z){E.AFrameworkApplication.Va.Ma(oa.a.renameFile,2,z.Values.NewName)}}dc.Ka=null;Object(h.a)(dc,"RenameActor",null,[]);var Bc=d(375),Ob=d(641),yc=d(582),fc=d(193);class Nb{constructor(z,T){this.Da=z;this.Lqd=T}wb(){this.Da.ya(oa.a.gal,ec.a.frame,Object(v.a)(this,this.hal,"showRenameDialogAction"))}hal(z,T,ja){z=32;if(1===ja)return fc.SessionStatusManager.instance.nia||
E.AFrameworkApplication.SP?8:32;2===ja&&(32!==this.Da.processAction(oa.a.renameFile,1)?(this.Da.processAction(oa.a.QGb,2),Bc.a.instance.Vb(Ob.a.Fha,{["Reason"]:yc.a.DOk}),z=8):32===this.Da.processAction(oa.a.ukc,1)?this.Da.processAction(oa.a.ukc,2):this.Lqd.value.create().MT());return z}}Object(h.a)(Nb,"RenameDialogActor",null,[861]);class lb{constructor(z,T,ja){this.dialog=null;this.Da=z;this.iE=T;this.xKa=ja}i9i(){const z={};z.nameInputProps={["type"]:"AppInputProps",["id"]:lb.Wpb,["label"]:CommonUIStrings.l_RenameDialogLabel,
["value"]:Ub.a.jG(this.iE.nx),["maxLength"]:this.xKa};return z}MT(){const z={["id"]:"RenameDialog",["bodyControls"]:this.i9i()};this.dialog=new Xb.a(!1,!1,!0);this.dialog.vd=1;this.dialog.kg="RenameDialog";this.dialog.qj(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.IDe,"renameDialogHandler"),z)}IDe(z,T){if(T&&1===z){if(T[lb.Wpb]&&(z=Ub.a.jG(this.iE.nx),T=(T[lb.Wpb]||"").trim(),T!==z&&""!==T)){this.Da.Ma(oa.a.renameFile,2,T);return}Bc.a.instance.Vb(Ob.a.uXb,{["Reason"]:yc.a.E1f})}}}lb.Wpb=
"txtDocumentName";Object(h.a)(lb,"ReactRenameDialog",null,[883]);class Qc{static get Wf(){return Xb.a.tA(Qc.Ym,CommonUIStrings.l_RenameDialogLabel)}}Qc.Ym="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(h.a)(Qc,"RenameDialogHtml",null,[]);class Rc extends Xb.a{constructor(z,T,ja){super();this.Da=z;this.iE=T;this.xKa=
ja;this.kg="RenameDialog";this.Wf=Qc.Wf}MT(){var z={["txtDocumentName"]:Ub.a.jG(this.iE.nx)};this.qj(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.IDe,"renameDialogHandler"),z);z=document.getElementById(Rc.Wpb);0<this.xKa&&(z.maxLength=this.xKa);z.focus()}IDe(z,T){if(1===z&&(z=Ub.a.jG(this.iE.nx),T=(T[Rc.Wpb]||"").trim(),T!==z&&""!==T)){this.Da.Ma(oa.a.renameFile,2,T);return}Bc.a.instance.Vb(Ob.a.uXb,{["Reason"]:yc.a.E1f})}}Rc.Wpb="txtDocumentName";Object(h.a)(Rc,"RenameDialog",Xb.a,[883]);
class ld{constructor(z){this.Ona=null;this.xKa=0;this.Da=z;this._initialized=!1}initialize(z,T){this.Ona=z;this.xKa=T;this._initialized=!0}create(){return this._initialized?E.AFrameworkApplication.Ba&&E.AFrameworkApplication.Ba.jb.QB&&E.AFrameworkApplication.fa.ka("ReactRenameDialogIsEnabled")?new lb(this.Da,this.Ona,this.xKa):new Rc(this.Da,this.Ona,this.xKa):null}}Object(h.a)(ld,"RenameDialogFactory",null,[862]);var Dd=d(120),gd=d(104),be=d(76),od=d(79),$d=d(137);class xf{constructor(z,T){this.Da=
z;this.Kd=T}wb(){this.Da.ya(oa.a.ukc,ec.a.frame,Object(v.a)(this,this.ial,"showRenameFlyoutAction"))}ohi(){return be.d("setDocumentTitleFlyoutOpened")&&E.AFrameworkApplication.Ba.jb.kN}ial(z,T,ja){if(1===ja)return this.ohi()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}R_h(){xf.eLj&&E.AFrameworkApplication.jsa&&$d.a.instance.Hb(new od.a(5,1,5E3,()=>{32===this.Da.processAction(oa.a.ukc,1)&&this.Kd&&this.Kd.ye.name===Dd.AFrame.gV&&(gd.a("RenameFloatieShownOnNewDocumentLoad",
!0),this.Da.processAction(oa.a.ukc,2))}))}static get eLj(){xf.Ssc&&null!=xf.Ssc||(E.AFrameworkApplication.M5b("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),xf.Ssc=E.AFrameworkApplication.fa?E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return xf.Ssc}}xf.Ssc=null;Object(h.a)(xf,"RenameFlyoutActor",null,[860]);class Na{constructor(z,T,ja,Ba,Ga){this.yMd=null;this.ifa=Ga;this.i$e=ja;this.h$e=
Ba;this.xWh=z;this.VKa=T}get oA(){return this.ifa.value}Pbg(){if(!this.h$e())return 5;if(this.VKa())return 1;if(this.oA){if(this.i$e&&!this.oA.ORd)return 3;if(!this.i$e&&!this.oA.zBa)return 4}return this.xWh()?0:2}}Object(h.a)(Na,"RenameProps",null,[859]);var xb=d(67);class sc{constructor(z,T,ja,Ba,Ga,Fb){this.Ap=!1;this.gwd=new xb.a;this.ijb=T;this.fqc=ja;this.upc=Ba;this.mb=Ga;this.iga=Fb}enable(){this.Ap||(this.czh(),this.MMe(),this.Ap=!0)}generateKey(z,T,ja){return String.format("{0}/{1}/{2}",
ja,z,T)}s3i(){const z=Ub.a.jG(this.ijb().nx);return this.generateKey(this.ijb().breadcrumbFolderName,this.ijb().breadcrumbFolderUrl,z)}t3i(z,T,ja){return z&&T?this.generateKey(z,T,ja):ja}GEi(z,T,ja){return z&&z!==this.ijb().breadcrumbFolderName||T&&T!==this.ijb().breadcrumbFolderUrl?!0:ja!==Ub.a.jG(this.ijb().nx)}czh(){const z=this.s3i();this.gwd.$(z,new Date)}Axe(z){this.o7k(z)&&this.rzf(z)}o7k(z){const T=this.upc();return T?this.iga&&this.iga.q8a||!T.p8d||!E.AFrameworkApplication.Bqa?(this.Qrh(z),
this.Ap=!1):!0:!1}x_g(z,T,ja,Ba){const Ga=this.GEi(z,T,ja);z=this.t3i(z,T,ja);T=this.gwd.Nf(z).returnValue;Ga&&!T&&(this.sgg(Ba),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.jce));Ga||this.gwd.$(z,this.fqc())}}Object(h.a)(sc,"ARenamedFileChecker",null,[843]);class cd extends sc{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc){super(z,T,ja,Ba,Ga,Fb);this.Cqf=Ga;this.WRh=Rb;this.ntd=tc}get jce(){return"RenamedFileCheckerUsingSettingsRefresh"}MMe(){this.Cqf.rGd(Object(v.a)(this,this.phg,"handleSettingsRefresh"))}phg(z,
T){T&&T.ecc&&T.hek&&(T.dvb("BreadcrumbDocName")||T.dvb("BreadcrumbFolderName")||T.dvb("BreadcrumbFolderUrl")||T.dvb("DirectInvokeDAVUrl")||T.dvb("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.jce),this.Axe(T))}Qrh(){this.Cqf.ENk(Object(v.a)(this,this.phg,"handleSettingsRefresh"))}rzf(z){if(z&&z.ecc){const T=z.ecc;this.x_g(T.Ia("BreadcrumbFolderName"),T.Ia("BreadcrumbFolderUrl"),T.Ia("BreadcrumbDocName"),z)}}sgg(z){const T={OperationResult:0,classId:1};
z=z.ecc;T.BreadcrumbFolderName=z.Ia("BreadcrumbFolderName");T.BreadcrumbFolderUrl=z.Ia("BreadcrumbFolderUrl");T.DirectInvokeDavUrl=z.Ia("DirectInvokeDAVUrl");T.EditDocInClientUrl=z.Ia("EditDocInClientUrl");z=z.Ia("BreadcrumbDocName");T.NewName=E.AFrameworkApplication.RGc?z:Ub.a.jG(z);this.ntd.execute(ja=>{this.czj(T,ja)})}czj(z,T){this.WRh().edc(z,T)}}Object(h.a)(cd,"RenamedFileCheckerUsingSettingsRefresh",sc,[]);class Ta extends sc{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd){super(z,ja,Ba,Ga,Fb,Ac);
this.SPb=this.ryc=null;this.OQh=T;this.Da=Rb;this.Md=tc;kd&&kd.execute(nd=>{this.cKk(nd)})}get jce(){return"RenamedFileCheckerUsingTask"}cKk(z){this.ryc=z;this.ryc.tGd(Object(v.a)(this,this.a3d,"handleVisibilityChange"))}a3d(z,T){!this.Ap||0!==T.newState&&1!==T.newState||this.SPb||(this.MMe(),this.Axe(this.SPb))}MMe(){this.SPb=new od.a(3,2,this.OQh(),Object(v.a)(this,this.Axe,"performRenameFileCheckTick"),89);this.Md.Hb(this.SPb)}Qrh(z){this.Md.ah(z)}rzf(z){this.ryc&&2===this.ryc.M2a?this.hLk(z):
E.AFrameworkApplication.Bqa(Object(v.a)(this,this.aCb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.W7c,"onRefreshFilenameFailure"),!0)}hLk(z){this.Md.ah(z);this.SPb=null}aCb(z){z&&this.x_g(z.BreadcrumbFolderName,z.BreadcrumbFolderUrl,z.NewName,null)}sgg(){this.Da.processAction(oa.a.fileNameUpdate,2)}W7c(){}}Object(h.a)(Ta,"RenamedFileCheckerUsingTask",sc,[]);var Hb=d(94);class oc{constructor(){this.mb=this.Ea=null}get name(){return"Common.App.RenameFile"}Yb(z){this.Ea=z;this.mb=E.AFrameworkApplication.fa;
this.Ea.register(Nb,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").na(()=>new Nb(E.AFrameworkApplication.Va,this.Ea.qe("Common.App.Rename.IRenameDialogFactory"))).ma();this.Ea.register(ld,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").na(()=>new ld(E.AFrameworkApplication.Va)).ma();this.Ea.register(843,"Common.App.Rename.IRenamedFileChecker").na(()=>this.iyi()).ma();this.Ea.register(xf,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").na(()=>
new xf(E.AFrameworkApplication.Va,Hb.FocusManager.instance())).ma()}iyi(){if(this.mb.ka("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const z=this.Ea.qb("Common.IRefreshableAppSettings");if(z&&z.JJj)return new cd(()=>z.Gc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>E.AFrameworkApplication.$t,()=>new Date,()=>E.AFrameworkApplication.oA,z,this.Ea.qb("Common.ISessionStatus"),()=>dc.instance,this.Ea.Oa("Postmessage.IHostPostmessenger"))}return new Ta(()=>this.mb.Gc("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.mb.Gc("RenamedFileCheckerPingIntervalInMs",12E4),()=>E.AFrameworkApplication.$t,()=>new Date,()=>E.AFrameworkApplication.oA,E.AFrameworkApplication.fa,E.AFrameworkApplication.Va,E.AFrameworkApplication.ve,this.Ea.qb("Common.ISessionStatus"),this.Ea.Oa("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.mb.gf(Object(v.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){const z=E.AFrameworkApplication.Ba.jb.kN;E.AFrameworkApplication.e4b()&&sd.instance.initialize(E.AFrameworkApplication.LIc,
z?null:E.AFrameworkApplication.VGc,z?null:E.AFrameworkApplication.tch||CommonUIStrings.l_RenameFileTooltip)&&(this.Ea.register(Na,"Common.App.Rename.RenameProps").as("Common.IRenameProps").na(()=>new Na(()=>E.AFrameworkApplication.xnc,()=>E.AFrameworkApplication.wS,E.AFrameworkApplication.Khc,E.AFrameworkApplication.e4b,new Mc.a(()=>E.AFrameworkApplication.oA))).ma(),dc.instance.wb(),this.mb.ka("RenameDialogIsEnabled")&&(this.Ea.resolve("Common.App.Rename.RenameDialogFactory").initialize(E.AFrameworkApplication.$t,
E.AFrameworkApplication.LIc),this.Ea.resolve("Common.App.Rename.IRenameDialogActor").wb()),this.Ea.resolve("Common.App.Rename.IRenameFlyoutActor").wb(),E.AFrameworkApplication.Khc&&this.Ea.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Ea.resolve("Common.App.Rename.IRenameFlyoutActor").R_h())}dispose(){}}Object(h.a)(oc,"PackageManager",null,[2,3]);const Oc=z=>{try{return D.a(z)}catch(T){}return null};class Yc{constructor(z,T,ja,Ba,Ga,Fb){this.Y0=!1;this.uR=null;this.dzd=!1;this.Da=
z;this.Di=T;this.ifa=ja;this.Qbf=Ba;this.mb=Ga;this.ZNh=Fb}init(z,T){T&&z.Oa("Common.Interface.IRtcBasicProvider").execute(Object(v.a)(this,this.aJd,"awaitRtc"))}aJd(z){const T=z.nL.task;T.continueWith(()=>{this.uR=T.result;this.dzd&&(this.uR.kea(2,null,!0),this.dzd=!1);this.uR.Eza((ja,Ba)=>{2===Ba.type&&this.Ho.processAction(oa.a.fileNameUpdate,2)});this.uR.B2a((ja,Ba)=>{2===Ba.newState&&this.Ho.processAction(oa.a.fileNameUpdate,2)});2===this.uR.connectionState&&this.Ho.processAction(oa.a.fileNameUpdate,
2)})}Bqa(z){this.O_f(z,!0)}O_f(z,T){const ja=this.rdi(z.Pph),Ba={};Ba[Yc.yPf]=Yc.zPf;this.Ndh.Jj(ja,2,"",Ba,!1,2,Object(v.a)(this,this.aCb,"onRefreshFilenameSuccess"),T?Object(v.a)(this,this.Ckk,"onRefreshFilenameFailureRetry"):Object(v.a)(this,this.oZg,"onRefreshFilenameFailureNoRetry"),z)}aCb(z){this.Y0=!1;const T=Oc(z.data.je);z.data.state.onSuccess(T,this.Qbf.value)}Ckk(z){5!==z.data.status||this.Y0?this.oZg(z):(this.Y0=!0,this.O_f(z.data.state,!1))}oZg(z){z.data.state.Tz(-1)}R4a(z){this.P_f(z,
!0)}P_f(z,T){const ja=this.sdi(),Ba={};Ba[Yc.yPf]=Yc.zPf;Ba[Yc.aoj]=Ub.a.Me(z.Vdh);Ba[Yc.Znj]=this.ZNh.value.yMd;this.Ndh.Jj(ja,2,"",Ba,!1,2,Object(v.a)(this,this.edc,"onRenameFileSuccess"),T?Object(v.a)(this,this.Ikk,"onRenameFileFailureRetry"):Object(v.a)(this,this.uZg,"onRenameFileFailureNoRetry"),z)}sdi(){return this.nIf()}rdi(z){let T=this.nIf();return T=Ca.a.aj(T,Yc.eoj,z?"2":"1")}nIf(){let z=(this.mb.value.appSettings.RenameWebServiceBase||"")+Yc.$nj;z=Ca.a.aj(z,Yc.boj,Ub.a.Me(E.AFrameworkApplication.$g));
this.oA&&this.oA.p8d&&(z=Ca.a.aj(z,Yc.doj,"1"));return z}edc(z){this.Y0=!1;const T=Oc(z.data.je);z.data.state.onSuccess(T,this.Qbf.value);this.jUg()}jUg(){this.uR?this.uR.kea(2,null,!0):this.dzd=!0}Ikk(z){5!==z.data.status||this.Y0?this.uZg(z):(this.Y0=!0,this.P_f(z.data.state,!1))}uZg(z){z.data.state.Tz(-1)}get Ho(){return this.Da.value}get Ndh(){return this.Di.value}get oA(){return this.ifa.value}static get instance(){return Yc.Ka||(Yc.Ka=Yc.I5a())}static I5a(){return new Yc(new Mc.a(()=>E.AFrameworkApplication.Va),
new Mc.a(()=>E.AFrameworkApplication.Be),new Mc.a(()=>E.AFrameworkApplication.oA),new Mc.a(()=>C.a.instance.resolve("Postmessage.IHostPostmessenger")),new Mc.a(()=>E.AFrameworkApplication.fa),new Mc.a(()=>C.a.instance.resolve("Common.IRenameProps")))}}Yc.yPf="Content-Type";Yc.zPf="application/json; charset=utf-8";Yc.$nj="renamehandler.ashx";Yc.boj="qs";Yc.aoj="n";Yc.doj="sl";Yc.Znj="X-CoauthLockId";Yc.eoj="u";Yc.Ka=null;Object(h.a)(Yc,"ExecuteRenameFileHandler",null,[]);class Qd{constructor(){this.Tz=
this.onSuccess=null;this.Pph=!1}}Object(h.a)(Qd,"ExecuteRefreshFilenameData",null,[]);class ce{constructor(){this.Tz=this.onSuccess=this.Vdh=null}}Object(h.a)(ce,"ExecuteRenameFileData",null,[]);class id{constructor(){this.Ea=null;this.Nrd=Yc.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}Yb(z){this.Ea=z}init(){E.AFrameworkApplication.fa.gf(Object(v.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){E.AFrameworkApplication.e4b()&&(Yc.instance.init(this.Ea,E.AFrameworkApplication.Khc),
E.AFrameworkApplication.R4a=Object(v.a)(this,this.R4a,"executeRenameFile"),E.AFrameworkApplication.Bqa=Object(v.a)(this,this.Bqa,"executeRefreshFilename"),E.AFrameworkApplication.Vic=Object(v.a)(this,this.Vic,"sendFileNameAndLocationUpdateNotification"))}R4a(z,T,ja){const Ba=new ce;Ba.Vdh=z;Ba.onSuccess=T;Ba.Tz=ja;this.Nrd.R4a(Ba)}Bqa(z,T,ja){const Ba=new Qd;Ba.onSuccess=z;Ba.Tz=T;Ba.Pph=ja;this.Nrd.Bqa(Ba)}Vic(){this.Nrd.jUg()}dispose(){}}Object(h.a)(id,"PackageManager",null,[2,3]);class gb{constructor(z,
T,ja,Ba,Ga,Fb){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=z;this.WebAffinitizedUrl=T;this.PolicyCookie=ja;this.PolicyCookieTTL=Ba;this.WasServiceDown=Ga;this.AffinitizedUrl=Fb}}Object(h.a)(gb,"SafeLinksData",null,[]);class pc{constructor(z,T){this.kjd=z;this.Tx=T}}Object(h.a)(pc,"SafeLinksGetUrlReputationRequestData",null,[]);class zc{constructor(z,T,ja,Ba){this.mb=z;this.Di=T;
this.VKh=ja;zc.Sh=Ba}Mkd(z,T,ja){try{var Ba=null;zc.Sh&&(Ba=zc.Sh.wi("WebServiceCall","SafeLinksGetUrlReputation"));const Ga=new pc(T,Ba);Ba={};Ba.AffinitizedUrl=z;Ba.TargetUrl=T;Ba.PolicyCookie=ja;const Fb=D.c(Ba);this.Di.Jj(this.VKh,2,Fb,null,!1,2,Object(v.a)(this,this.Thk,"onGetUrlReputationSuccessCallback"),Object(v.a)(this,this.Shk,"onGetUrlReputationFailureCallback"),Ga,void 0,void 0,3E3,3E3,"36");return!0}catch(Ga){e.ULS.sendTraceTag(588788033,378,10,Ga.message)}return!1}Thk(z){let T="OnGetUrlReputationSuccessCallback: ",
ja=10;const Ba=z.data.state;try{const Ga=D.b(z.data.je).reputationResults[0],Fb=Ga.navigateUrl.length,Rb=Ba.kjd.length,tc=Ga.navigateUrl===Ba.kjd;Ga.navigateUrl&&0<Ga.navigateUrl.length&&(Ba.kjd=Ga.navigateUrl);T+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",z.data.tf,Ga.verdict,Rb.toString(),Fb.toString(),tc.toString());ja=50}catch(Ga){T+=String.format("Exception {0}",Ga.message)}this.xgg(Ba,T,ja)}Shk(z){let T="OnGetUrlReputationFailureCallback: ";
const ja=z.data.state;try{T+=String.format("HttpStatus {0}",z.data.tf)}catch(Ba){T+=String.format("Exception {0}",Ba.message)}this.xgg(ja,T,10)}xgg(z,T,ja){z.Tx&&(z.Tx.stop(),z.Tx=null);e.ULS.sendTraceTag(588788034,378,ja,T);Cc.a.Qm(z.kjd,void 0,"noopener,noreferrer","SafeLinksNav")}}zc.Sh=null;Object(h.a)(zc,"SafeLinksNavigationHelper",null,[]);var Ic;(function(z){z[z.enabledByPolicy=0]="enabledByPolicy";z[z.disabledByPolicy=1]="disabledByPolicy";z[z.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";
z[z.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(Ic||(Ic={}));Object(h.b)("SafeLinksNavigationState",Ic);var Fc=d(490);class rd{constructor(z,T,ja,Ba=!1,Ga=null,Fb=null){this.J_a=this.I_a=0;this.p3b=this.Arc=!1;this.ILa=null;this.ekb=!0;this.ywc=null;e.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.mb=z;this.Di=T;this.Ana=ja;rd.Sh=Fb;this.PWh=Ba?this.mb.Ia("SafeLinksHandlerWebServiceBase"):this.mb.Ia("WebServiceBase");this.yWh=this.mb.Ia("SafeLinksHashedUserId");
this.Lyl=this.mb.Ia("SafeLinksWorkloadIdHeaderValue");this.Itc=this.mb.Gc("SafeLinksMaxGetPolicyBootRetries",2);this.Jtc=this.mb.Gc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.vsc=this.mKj();this.usc=this.lKj();e.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.vsc,this.usc);if(this.vsc&&this.usc){T=(z=this.vrb())?z.IsSafeLinksEnabled.toLowerCase():"";ja=this.Q9d();e.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",
T,ja);var Rb=!z||"unknown"===T||z.WasServiceDown||ja,tc=K.a.oz();tc&&(tc.set("shouldGetSafeLinksDataFromServer",Rb.toString()),tc.set("isSafeLinksEnabledCacheValue",T.toString()));this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1)&&Ga?(this.ekb=!1,Ga.execute(Ac=>{Ac.isFeatureEnabled("MsoUrlreputation",!0).then(kd=>{this.ekb=kd;tc.set("isUserLicensedForSafeLinks",this.ekb.toString());u.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",tc);this.ekb&&
Rb&&this.QMc(!0);return null})})):(u.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",tc),Rb&&this.QMc(!0))}}get appName(){return this.Ana}get Fmd(){return this.PWh}get userId(){return this.yWh}get Q7i(){const z=this.Fmd?this.Fmd+"/":"",T=new ca.QueryStringBuilder("SafeLinksHandler.ashx");T.nj("app",this.appName);this.mb.ka("SafeLinksUseDebugHeader")&&T.nj("action","debug");this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&T.nj("s2satpop",
"1");this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&T.nj("s2saat","1");this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&T.nj("s2se03","1");return String.format("{0}{1}&{2}",z,T.toString(),E.AFrameworkApplication.$g)}get Aej(){const z=this.Fmd?this.Fmd+"/":"",T=new ca.QueryStringBuilder("SafeLinksHandler.ashx");T.nj("app",this.appName);this.mb.ka("SafeLinksUseDebugHeader")&&T.nj("action","debug");this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",
!1)&&T.nj("s2satpop","1");this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&T.nj("s2saat","1");this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&T.nj("s2se03","1");T.nj("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",z,T.toString(),E.AFrameworkApplication.$g)}get Obk(){rd.XAd||(rd.XAd=new zc(this.mb,this.Di,this.Aej,rd.Sh));return rd.XAd}Mkd(z){if(!z)return e.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),
!1;var T=this.cFj(z);e.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",T,this.vsc,this.usc,this.ekb);if(!(T&&this.vsc&&this.usc&&this.ekb))return!1;T=0;const ja=({state:T}=this.D8k()).returnValue;e.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Ic[T]);const Ba=K.a.oz();Ba&&Ba.set("SafeLinksNavigationState",Ic[T]);u.Health.instance.recordKpiUsage("SafeLinksNavigations",
0,"jpittsdirects",Ba);if(!ja)return 2!==T&&3!==T||u.Health.instance.recordKpiFailure("SafeLinksNavigations",Ic[T],!1,!0,null),!1;e.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");if(this.Q8k())return this.Q9d()?!1:this.Obk.Mkd(this.EVi(),z,this.ibg());if(!this.Q9d())return this.lxh(z),!0;this.ILa=z;e.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.p3b=!1;this.QMc();return!0}cFj(z){z=z.toLowerCase();const T=this.mb.JB("SafeLinksUnsupportedProtocols");
if(T)for(let ja=0;ja<T.length;ja++)if(z.startsWith(T[ja]))return!1;return!0}QMc(z=!1){var T=K.a.oz();T&&T.set("isOnBootRequest",z.toString());u.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",T);u.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",T);T=this.fOd("SafeLinksGetPolicy");this.Di.Jj(this.Q7i,1,null,null,!0,2,Object(v.a)(this,this.f$i,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(v.a)(this,this.e$i,"getSafeLinksDataFromServer_OnFailureCallback"),
T,void 0,void 0,void 0,void 0,"23");this.p3b=z;this.Arc=!0;z?this.I_a++:this.J_a++}f$i(z){let T=H.a.Pck,ja="";try{this.Arc=this.p3b=!1;var Ba=z.data.state;const Bd=({Tx:Ba}=this.aid(Ba)).returnValue,Zd=Object.assign(new Z.a,{durationMs:Bd});u.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Zd);e.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",z.data.tf,z.data.je.length,Bd);if(z.data.tf!==H.a.Xy)ja=
"Unexpected httpStatus: "+z.data.tf.toString();else{Ba=null;try{Ba=D.b(z.data.je)}catch(df){ja="Exception:"+df.toString()+" deserializing response";return}if(Ba){var Ga=Ba.IsSafeLinksEnabled;if(void 0===Ga||null===Ga||0>=Ga.length)ja="Invalid isSafeLinksEnabledString";else{e.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",Ga);var Fb=rd.axe(Ga);if(void 0===Ba.WebAffinitizedUrl||null===Ba.WebAffinitizedUrl||0>=Ba.WebAffinitizedUrl.length)ja="Invalid WebAffinitizedUrl";else if(void 0===
Ba.PolicyCookie||null===Ba.PolicyCookie||0>=Ba.PolicyCookie.length)ja="Invalid PolicyCookie";else if(void 0===Ba.PolicyCookieTTL||null===Ba.PolicyCookieTTL)ja="Invalid PolicyCookieTTL";else{var Rb=Ba.WebAffinitizedUrl,tc=Ba.PolicyCookie,Ac=Ba.AffinitizedUrl,kd=new Date;kd.setMinutes(kd.getMinutes()+(5<Ba.PolicyCookieTTL?Ba.PolicyCookieTTL-5:0));var nd=new gb(Ga,Rb,tc,kd.getTime(),!1,Ac);this.Qih(nd);T=z.data.tf;this.ILa&&(Fb?(this.lxh(this.ILa),this.J_a=this.I_a=0):(e.ULS.sendTraceTag(26019602,378,
50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),u.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Cc.a.uJc(this.ILa)),this.ILa=null)}}}else ja="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Bd){ja="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Bd.toString()}finally{T!==H.a.Xy&&this.wgg(T,ja)}}e$i(z){this.Arc=!1;let T=500,ja="";try{let Ba=z.data.state;const Ga=({Tx:Ba}=this.aid(Ba)).returnValue,
Fb=Object.assign(new Z.a,{durationMs:Ga});T=z.data.tf;u.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+T.toString(),!1,!0,Fb);ja="Request Failed, Status="+Fc.a[z.data.status]+" Duration: "+Ga}catch(Ba){ja="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+Ba.toString()}finally{this.wgg(T,ja)}}wgg(z,T=""){try{if(e.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",z,T),this.I_a<this.Itc&&this.J_a<this.Jtc)this.QMc(this.p3b);
else{this.p3b=!1;e.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.I_a,this.J_a,z,T);T=null;const ja=K.a.oz();ja&&(ja.set("HttpStatus",z.toString()),T=Object.assign(new Z.a,{extendedProperties:ja}));u.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,T);const Ba=new gb("false","","",0,!0,"");this.Qih(Ba);this.ILa&&(e.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}",
"disabled_GetPolicyFailure"),u.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),Cc.a.uJc(this.ILa),this.ILa=null)}}catch(ja){e.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",ja.toString())}}lxh(z){const T=this.ibg(),ja=this.sfj(),Ba={};Ba.Url=z;Ba.SafeLinksCookie=T;Ba.CorrelationId=da.a.create().toString();Ba.WorkloadId=this.Lyl;Ba.UserAgentInfo=P.a.ey+"|"+this.appName;e.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",
Ba.CorrelationId);Cc.a.c$c(Cc.a.u$(4),ja,Ba)}mKj(){const z=this.mb.Ia("IsSafeLinksEnabledForUser");return z?rd.axe(z):!1}lKj(){const z=this.mb.JB("SafeLinksDisabledBrowsers");if(P.a.sS){if(this.mb.Fu("SafeLinksForTeamsIsEnabled")&&this.mb.ka("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(z,"Electron"))return!1}else if(Array.contains(z,P.a.ey))return!1;return"officecomhwa"===(this.mb.Ia(E.AFrameworkApplication.lJ)||"").toLowerCase()?!1:!0}Q8k(){return-1!==window.location.href.indexOf("&wd_slnh=1")||
this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&P.a.l9d?!0:P.a.sS}D8k(){let z;z=0;const T=this.vrb(),ja=T?T.IsSafeLinksEnabled:"";if(""!==ja)return T.WasServiceDown?(e.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===ja.toLowerCase()?(e.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:rd.axe(ja),state:z};if(this.Arc)return z=3,e.ULS.sendTraceTag(595079384,
378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:z};if(this.I_a>=this.Itc||this.J_a>=this.Jtc)return z=2,e.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.I_a,this.Itc,this.J_a,this.Jtc),{returnValue:!1,state:z};e.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.Itc+this.Jtc-(this.I_a+this.J_a));return{returnValue:!0,state:z}}ibg(){const z=this.vrb();return z?z.PolicyCookie:""}sfj(){const z=this.vrb();return z?z.WebAffinitizedUrl:""}EVi(){const z=this.vrb();return z?z.AffinitizedUrl:""}Q0i(){const z=new Date;try{const T=this.vrb();z.setTime(T?T.PolicyCookieTTL:0)}catch(T){e.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",T)}return z}Q9d(){const z=this.Q0i();return!!z&&z.getTime()<Date.now()}vrb(){if(!this.ywc){const z=
Ka.a.instance.getItem(this.userId);if(!z||""===z)return null;this.ywc=JSON.parse(z)}return this.ywc}Qih(z){if(void 0===z||null===z)throw Error.argumentNull("safeLinksData");if(void 0===z.IsSafeLinksEnabled||null===z.IsSafeLinksEnabled||0>=z.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.ywc=z;z.WasServiceDown||this.Syl(z)}Syl(z){z=JSON.stringify(z);Ka.a.instance.setItem(this.userId,z)}fOd(z){return void 0!==rd.Sh&&null!==rd.Sh?rd.Sh.wi("WebServiceCall",
z):null}aid(z){if(void 0!==z&&null!==z){const T=z.vq;z.stop();return{returnValue:T,Tx:null}}return{returnValue:null,Tx:z}}static axe(z){return"false"!==z.toLowerCase()?!0:!1}}rd.Sh=null;rd.XAd=null;Object(h.a)(rd,"SafeLinksManager",null,[814]);const Yd=z=>{switch(z){case 3:return"Word";case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},me=z=>{switch(z){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};var Db=d(208);class af{constructor(){this.K=
null}get name(){return"PowerPointSafeLinks"}Yb(z){this.K=z}init(){E.AFrameworkApplication.fa.gf(Object(v.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){const z=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),T=z?z.zg:!1;z.pptSafeLinksIsEnabled&&(this.K.register(rd,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ma().na(()=>new rd(E.AFrameworkApplication.fa,E.AFrameworkApplication.Be,String.format("{0}-{1}",Yd(E.AFrameworkApplication.Ba.jb.vm),me(E.AFrameworkApplication.Ba.jb.vGa)),
T)).ma(),this.K.qb("Common.App.SafeLinks.ISafeLinksManager"))}dispose(){}static main(){Ya.a.instance.Ec(Db.a(new af,0))}}Object(h.a)(af,"SafeLinksPackage",null,[2,3]);var bg=d(332),Qe=d(282),Af=d(1159),tf=d(86),uf=d(27),kg=d(178),Lg=d(91),$g=d(998);class yf{constructor(z,T,ja,Ba,Ga,Fb){this.RF=z;this._id=T;this.Zqd=Ba;this.eJh=Ga;this.fJh=Fb;this.pqc=this.Cpb;void 0!==ja&&null!==ja&&(this.Cpb=ja)}get defaultValue(){return this.pqc}get lcid(){return this.RF}get id(){return this._id}get Cpb(){return(this.eJh||
yf.V_e)(this.Zqd)}set Cpb(z){(this.fJh||yf.W_e)(this.Zqd,z)}get Pf(){return this.Zqd}static Qq(){yf.V_e=()=>null;yf.W_e=()=>{}}}yf.V_e=null;yf.W_e=null;Object(h.a)(yf,"GrammarSettingOption",null,[866]);yf.Qq();class Kf{constructor(z,T,ja){this.sVd=z;this.lGe=T;this.fck=ja}}Object(h.a)(Kf,"TwoLevelCacheKey",null,[]);var dd=d(32),lg=d(211),Wh=d(2);class Gd extends Xb.a{constructor(z,T,ja,Ba){super();this.sAd=this.h6=this.r2e=this.hLb=null;this.Wn=Ba;this.hqd=z;this.kg=Gd.id;this.TPh=()=>{this.hLb=ja?
ea.a.Ljc(ja):{};this.r2e=ja?ea.a.Ljc(ja):{};const Ga=this.Tbi(),Fb=Gd.Wui(Ga,Gd.Xed(Object(v.a)(this,this.Vui,"createCritiqueTypeSettingsTracker"))(Gd.roi(tc=>this.hLb=tc)));Fb(ja||{});var Rb=Gd.Xed(Gd.Xzi())(tc=>tc.cloneNode(!0));Gd.Xui(Ga,Gd.tui(Gd.myi(T),Gd.Uui(Rb))(ja))(z.toString());this.sAd=this.udi();Rb=tc=>{if("click"===tc.type||tc.keyCode===kg.a.Xp||tc.keyCode===kg.a.tJb)this.hLb[z.toString()]={},Ga.reset(),Gd.KQk(Fb)};Lg.a.addHandler(this.TWa,eb.a.click,Rb);Lg.a.addHandler(this.TWa,eb.a.Rf,
Rb)};this.Wf=""}get TWa(){return this.sAd}qNj(){var z=Gd.WCe(this.hLb),T=Gd.WCe(this.r2e);if(!z&&!T)return!1;let ja;try{ja=z?Object(A.a)(Object,z[this.hqd.toString()]):{};var Ba=T?Object(A.a)(Object,T[this.hqd.toString()]):{}}catch(Rb){return e.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!ja&&!Ba)return!1;ja=ja?ja:{};Ba=Ba?Ba:{};z=String.format("language: {0}",this.hqd.toString());T=!1;for(let Rb in ja){var Ga=Rb,Fb=ja[Rb];Ga in Ba&&Ba[Ga]===Fb||(T=!0,z=String.format("{0}, [{1}, {2}]",
z,Ga,Fb))}for(let Rb in Ba)Ba=Rb,Ba in ja||(T=!0,z=String.format("{0}, [{1}, default]",z,Ba));T&&e.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",z);return T}qj(z,T,ja){super.qj(z,T,ja);this.tFk()}MM(z){return z.Hc.id===Gd.deh?!1:super.MM(z)}xWk(){this.Wn.Mk().g5c();this.h6=this.Wn.Mk().gj.QY}tFk(){this.Wn.Mk().scope.Wo(Hb.FocusManager.instance().Roa);this.Wn.Mk().scope.Wo(Hb.FocusManager.instance().Soa);this.Wn.Mk().scope.bindAction(Hb.FocusManager.instance().Roa,dd.a.V0b);this.Wn.Mk().scope.bindAction(Hb.FocusManager.instance().Soa,
dd.a.U0b);this.Wn.Mk().scope.bindAction($a.KeyInputManager.La(kg.a.q$,0),dd.a.XNc);this.Wn.Mk().scope.bindAction($a.KeyInputManager.La(kg.a.Sea,0),dd.a.WNc);this.Wn.Mk().scope.bindAction($a.KeyInputManager.La(kg.a.OX,0),dd.a.XNc);this.Wn.Mk().scope.bindAction($a.KeyInputManager.La(kg.a.k5,0),dd.a.WNc)}get settings(){return Gd.WCe(this.hLb)}Yua(){super.Yua();this.TPh()}Tbi(){const z=Gd.mci(),T=Gd.JTb("WACDialogRow",z);this.YO.insertBefore(T,this.YO.firstChild);return z}Vui(z){const T=$g.a.merge(null,
z);return ja=>{ja.Cpb===(z&&z[ja.lcid]?z[ja.lcid][ja.id]:null)||ja.Cpb!==ja.defaultValue?Gd.Iag(T,ja.lcid)[ja.id]=ja.Cpb:delete Gd.Iag(T,ja.lcid)[ja.id];this.h6=this.z1i(ja.Pf);return T}}z1i(z){return z?(z=z.getElementsByTagName(Sys.UI.DomElement.containsCssClass(z,Gd.kPj)?"select":"input"))?z[0]:null:null}dispose(){this.TWa&&(Lg.a.Aah(this.TWa),this.sAd=null);super.dispose()}udi(){const z=document.createElement("input");z.id=Gd.deh;z.type="reset";z.setAttribute("form",Gd.d4f);z.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";
z.value=CommonUIStrings.l_ResetAll;const T=Gd.JTb("GrammarSettingsDialogResetButtonContainer",z),ja=document.getElementById("WACDialogButtonPanel");ja.parentNode.insertBefore(T,ja);return z}static get tWb(){return"CritiqueType"}static roi(z){return T=>ja=>z(T(ja))}static Xed(z){return T=>ja=>T(z(ja))}static WCe(z){const T={};ea.a.forEach(z,(ja,Ba)=>{0<lg.a(Ba).length&&(T[ja]=Ba)},null);return T}static mci(){const z=document.createElement("form");z.id=Gd.d4f;Sys.UI.DomElement.addCssClass(z,"WACDialogList");
Sys.UI.DomElement.addCssClass(z,Gd.qAi);return z}static Wui(z,T){const ja=Gd.yEk(z,eb.a.change);return Ba=>{const Ga=T(Ba);ja(Fb=>{Fb=Fb.target.parentNode;Sys.UI.DomElement.containsCssClass(Fb,Gd.tWb)&&Ga(Fb[Gd.kGf])})}}static yEk(z,T){let ja=null;return Ba=>{ja&&Lg.a.removeHandler(z,T,ja);Lg.a.addHandler(z,T,Ba);ja=Ba}}static Iag(z,T){return z[T]=z[T]||{}}static KQk(z){e.ULS.sendTraceTag(36489289,375,50,"User click reset all button");z(null)}static myi(z){let T=null;return ja=>{T=ja;return z.request(Number.parseInvariant(ja)).CWRCo(Ba=>
T===ja?Ba.result:null,Gd.hQd)}}static Xui(z,T){const ja=Gd.vWi(Ba=>Gd.Ojl(Ba.children));return Ba=>{const Ga=ja(Ba,z);z.innerHTML="";(Ga?Wh.Task.ot(Ga):T(Ba)).continueWith(Fb=>{Fb=Fb.result;for(let Rb=0;Rb<Fb.length;Rb++)z.appendChild(Fb[Rb])},Gd.hQd)}}static tui(z,T){return ja=>Ba=>z(Ba).CWRCo(Ga=>Ea.toArray(Ea.select(Ea.asEnumerable(Ga.result),Fb=>T(ja,Fb,Ba))),Gd.hQd)}static Ojl(z){const T=[];for(let ja=0;ja<z.length;ja++)T.push(z[ja]);return T}static vWi(z){const T={};let ja=null;return(Ba,Ga)=>
{ja&&!T[ja]&&(Ga=z(Ga))&&(T[ja]=Ga);ja=Ba;return T[Ba]}}static Xzi(){const z={};return T=>{z[T.sVd]=z[T.sVd]||{};const ja=z[T.sVd];ja[T.lGe]=ja[T.lGe]||T.fck();return ja[T.lGe]}}static Uui(z){return(T,ja,Ba)=>{const Ga=z(new Kf(Ba,ja.Id,()=>Gd.$bi(ja)));Ga.setAttribute("role","group");const Fb=Gd.hLf+ja.Name;Ga.setAttribute("aria-labelledby",Fb);for(const Rb of ja.CritiqueTypeInfoList){const tc=Gd.eUi(Ba,Rb,T,z);Ga.appendChild(tc);tc.setAttribute("aria-labelledby",Fb)}return Ga}}static eUi(z,T,ja,
Ba){Ba=Ba(new Kf(z,T.Id,()=>T.IsBinaryCritiqueType?Gd.Ybi(T):Gd.bdi(T)));z=new yf(z,T.Id,ja&&ja[z]?ja[z][T.Id]:null,Ba,T.IsBinaryCritiqueType?Ga=>Ga.children[0].checked:Ga=>Ga.children[1].selectedIndex,T.IsBinaryCritiqueType?(Ga,Fb)=>{Ga.children[0].checked=Fb}:(Ga,Fb)=>{Ga.children[1].selectedIndex=Fb});Ba[Gd.kGf]=z;return Ba}static $bi(z){z=Gd.aci(z.Name);z.className="WACWritingStylesDialogCategoryTitle";return Gd.JTb("CritiqueCategory",z)}static Ybi(z){const T=Gd.bci();T.id=z.Id;0<z.DefaultCritiqueValue&&
T.setAttribute("checked","checked");z=Gd.aIf(z.Name,z.Id);z.className="WACDialogLabel";const ja=Gd.JTb(Gd.tWb,T,z);ja.appendChild(T);ja.appendChild(z);return ja}static bdi(z){z=Gd.Pci(z.Id,z.Name,Gd.gdi(z.CritiqueTypeValues,z.DefaultCritiqueValue),z.DefaultCritiqueValue);Sys.UI.DomElement.addCssClass(z,Gd.tWb);return z}static gdi(z,T){return Ea.toArray(Ea.Si(Ea.asEnumerable(z||[]),(ja,Ba)=>{ja=Gd.fdi(ja,Ba.toString());Ba===T&&ja.setAttribute("selected","selected");return ja}))}static Pci(z,T,ja,Ba){T=
Gd.aIf(T,z);const Ga=document.createElement("select");Ga.id=z;Ga.className="WACDialogList";ja=ja||[];for(z=0;z<ja.length;z++)Ga.appendChild(ja[z]),Ba===z&&(ja[z].selected=!0);return Gd.JTb("GrammarSettingsDialogLabeledInlineList",T,Ga)}static fdi(z,T){const ja=document.createElement("option");ja.text=z;ja.value=T;return ja}static bci(){const z=document.createElement("input");z.type="checkbox";z.className="WACDialogCheckBox";return z}static aIf(z,T){const ja=document.createElement("label");ja.innerText=
z;ja.setAttribute("for",T);return ja}static aci(z){const T=document.createElement("div");T.innerText=z;T.id=Gd.hLf+z;return T}static JTb(z=null,...T){const ja=document.createElement("div");ja.className=z;for(const Ba of T)ja.appendChild(Ba);return ja}}Gd.id="GrammarSettingsDialog";Gd.d4f="CritiqueTypeSettings";Gd.qAi="CritiquesList";Gd.kPj="GrammarSettingsDialogLabeledInlineList";Gd.deh="ResetButton";Gd.hLf="WritingStylesCategory_";Gd.hQd=11;Gd.kGf="CritiqueType";Object(h.a)(Gd,"GrammarSettingsDialog",
Xb.a,[]);var Se=d(150),hj=d(1186),cg=d(340),ed=d(38);class Xg{constructor(){this.BuildId=0;this.BuildIds=null;this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.EffectType=this.EffectId=0;this.HasTrigger=this.HasMultiple=this.HasExisting=!1;this.Id=null;this.IsTrigger=this.IsTextRangeType=!1;this.ParaRangeStart=this.ParaRangeEnd=0;this.RenderAnimationImage=!1;this.StartType=this.SequenceIndex=this.SequenceId=0}}Object(h.a)(Xg,"EditAnimationInfo",null,[]);var Dh;(function(z){z[z.invalid=
0]="invalid";z[z.basicBlockList=1]="basicBlockList";z[z.alternatingHexagons=2]="alternatingHexagons";z[z.pictureCaptionList=3]="pictureCaptionList";z[z.linedList=4]="linedList";z[z.verticalBulletList=5]="verticalBulletList";z[z.verticalBoxList=6]="verticalBoxList";z[z.verticalBracketList=7]="verticalBracketList";z[z.varyingWidthList=8]="varyingWidthList";z[z.tabList=9]="tabList";z[z.horizontalBulletList=10]="horizontalBulletList";z[z.squareAccentList=11]="squareAccentList";z[z.pictureAccentList=12]=
"pictureAccentList";z[z.bendingPictureAccentList=13]="bendingPictureAccentList";z[z.stackedList=14]="stackedList";z[z.increasingCircleProcess=15]="increasingCircleProcess";z[z.pieProcess=16]="pieProcess";z[z.detailedProcess=17]="detailedProcess";z[z.groupedList=18]="groupedList";z[z.horizontalPictureList=19]="horizontalPictureList";z[z.continuousPictureList=20]="continuousPictureList";z[z.pictureStrips=21]="pictureStrips";z[z.verticalPictureList=22]="verticalPictureList";z[z.alternatingPictureBlocks=
23]="alternatingPictureBlocks";z[z.verticalPictureAccentList=24]="verticalPictureAccentList";z[z.titledPictureAccentList=25]="titledPictureAccentList";z[z.verticalBlockList=26]="verticalBlockList";z[z.verticalChevronList=27]="verticalChevronList";z[z.verticalAccentList=28]="verticalAccentList";z[z.verticalArrowList=29]="verticalArrowList";z[z.trapezoidList=30]="trapezoidList";z[z.descendingBlockList=31]="descendingBlockList";z[z.tableList=32]="tableList";z[z.segmentedProcess=33]="segmentedProcess";
z[z.verticalCurvedList=34]="verticalCurvedList";z[z.pyramidList=35]="pyramidList";z[z.targetList=36]="targetList";z[z.hierarchyList=37]="hierarchyList";z[z.verticalCircleList=38]="verticalCircleList";z[z.tableHierarchy=39]="tableHierarchy";z[z.architectureLayout=40]="architectureLayout";z[z.basicProcess=41]="basicProcess";z[z.stepUpProcess=42]="stepUpProcess";z[z.stepDownProcess=43]="stepDownProcess";z[z.accentProcess=44]="accentProcess";z[z.pictureAccentProcess=45]="pictureAccentProcess";z[z.alternatingFlow=
46]="alternatingFlow";z[z.continuousBlockProcess=47]="continuousBlockProcess";z[z.increasingArrowsProcess=48]="increasingArrowsProcess";z[z.interconnectedBlockProcess=49]="interconnectedBlockProcess";z[z.continuousArrowProcess=50]="continuousArrowProcess";z[z.convergingText=51]="convergingText";z[z.processArrows=52]="processArrows";z[z.circleAccentTimeline=53]="circleAccentTimeline";z[z.basicTimeline=54]="basicTimeline";z[z.circleProcess=55]="circleProcess";z[z.basicChevronProcess=56]="basicChevronProcess";
z[z.chevronAccentProcess=57]="chevronAccentProcess";z[z.closedChevronProcess=58]="closedChevronProcess";z[z.chevronList=59]="chevronList";z[z.subStepProcess=60]="subStepProcess";z[z.phasedProcess=61]="phasedProcess";z[z.randomtoResultProcess=62]="randomtoResultProcess";z[z.verticalProcess=63]="verticalProcess";z[z.staggeredProcess=64]="staggeredProcess";z[z.processList=65]="processList";z[z.circleArrowProcess=66]="circleArrowProcess";z[z.basicBendingProcess=67]="basicBendingProcess";z[z.repeatingBendingProcess=
68]="repeatingBendingProcess";z[z.verticalBendingProcess=69]="verticalBendingProcess";z[z.ascendingPictureAccentProcess=70]="ascendingPictureAccentProcess";z[z.upwardArrow=71]="upwardArrow";z[z.descendingProcess=72]="descendingProcess";z[z.circularBendingProcess=73]="circularBendingProcess";z[z.equation=74]="equation";z[z.verticalEquation=75]="verticalEquation";z[z.funnel=76]="funnel";z[z.gear=77]="gear";z[z.arrowRibbon=78]="arrowRibbon";z[z.opposingArrows=79]="opposingArrows";z[z.convergingArrows=
80]="convergingArrows";z[z.divergingArrows=81]="divergingArrows";z[z.basicCycle=82]="basicCycle";z[z.textCycle=83]="textCycle";z[z.blockCycle=84]="blockCycle";z[z.nondirectionalCycle=85]="nondirectionalCycle";z[z.continuousCycle=86]="continuousCycle";z[z.multidirectionalCycle=87]="multidirectionalCycle";z[z.segmentedCycle=88]="segmentedCycle";z[z.basicPie=89]="basicPie";z[z.hexagonRadial=90]="hexagonRadial";z[z.radialCycle=91]="radialCycle";z[z.basicRadial=92]="basicRadial";z[z.divergingRadial=93]=
"divergingRadial";z[z.radialVenn=94]="radialVenn";z[z.cycleMatrix=95]="cycleMatrix";z[z.radialCluster=96]="radialCluster";z[z.organizationChart=97]="organizationChart";z[z.pictureOrganizationChart=98]="pictureOrganizationChart";z[z.nameandTitleOrganizationChart=99]="nameandTitleOrganizationChart";z[z.halfCircleOrganizationChart=100]="halfCircleOrganizationChart";z[z.circlePictureHierarchy=101]="circlePictureHierarchy";z[z.hierarchy=102]="hierarchy";z[z.labeledHierarchy=103]="labeledHierarchy";z[z.horizontalOrganizationChart=
104]="horizontalOrganizationChart";z[z.horizontalMultiLevelHierarchy=105]="horizontalMultiLevelHierarchy";z[z.horizontalHierarchy=106]="horizontalHierarchy";z[z.horizontalLabeledHierarchy=107]="horizontalLabeledHierarchy";z[z.balance=108]="balance";z[z.circleRelationship=109]="circleRelationship";z[z.hexagonCluster=110]="hexagonCluster";z[z.opposingIdeas=111]="opposingIdeas";z[z.plusandMinus=112]="plusandMinus";z[z.reverseList=113]="reverseList";z[z.counterbalanceArrows=114]="counterbalanceArrows";
z[z.segmentedPyramid=115]="segmentedPyramid";z[z.nestedTarget=116]="nestedTarget";z[z.convergingRadial=117]="convergingRadial";z[z.radialList=118]="radialList";z[z.tabbedArc=119]="tabbedArc";z[z.basicTarget=120]="basicTarget";z[z.basicVenn=121]="basicVenn";z[z.linearVenn=122]="linearVenn";z[z.stackedVenn=123]="stackedVenn";z[z.interconnectedRings=124]="interconnectedRings";z[z.basicMatrix=125]="basicMatrix";z[z.titledMatrix=126]="titledMatrix";z[z.gridMatrix=127]="gridMatrix";z[z.basicPyramid=128]=
"basicPyramid";z[z.invertedPyramid=129]="invertedPyramid";z[z.accentedPicture=130]="accentedPicture";z[z.circularPictureCallout=131]="circularPictureCallout";z[z.radialPictureList=132]="radialPictureList";z[z.snapshotPictureList=133]="snapshotPictureList";z[z.spiralPicture=134]="spiralPicture";z[z.captionedPictures=135]="captionedPictures";z[z.bendingPictureCaption=136]="bendingPictureCaption";z[z.pictureFrame=137]="pictureFrame";z[z.bendingPictureSemiTransparentText=138]="bendingPictureSemiTransparentText";
z[z.bendingPictureBlocks=139]="bendingPictureBlocks";z[z.bendingPictureCaptionList=140]="bendingPictureCaptionList";z[z.titledPictureBlocks=141]="titledPictureBlocks";z[z.pictureGrid=142]="pictureGrid";z[z.pictureAccentBlocks=143]="pictureAccentBlocks";z[z.themePictureAccent=144]="themePictureAccent";z[z.themePictureGrid=145]="themePictureGrid";z[z.themePictureAlternatingAccent=146]="themePictureAlternatingAccent";z[z.alternatingPictureCircles=147]="alternatingPictureCircles";z[z.titlePictureLineup=
148]="titlePictureLineup";z[z.pictureLineup=149]="pictureLineup";z[z.framedTextPicture=150]="framedTextPicture";z[z.bubblePictureList=151]="bubblePictureList";z[z.linearArrowProcessNumbered=152]="linearArrowProcessNumbered";z[z.linearBlockProcessNumbered=153]="linearBlockProcessNumbered";z[z.basicLinearProcessNumbered=154]="basicLinearProcessNumbered";z[z.accentHomeChevronProcess=155]="accentHomeChevronProcess";z[z.basicProcessNew=156]="basicProcessNew";z[z.basicTimelineNew=157]="basicTimelineNew";
z[z.chevronBlockProcess=158]="chevronBlockProcess";z[z.hexagonTimeline=159]="hexagonTimeline";z[z.horizontalActionList=160]="horizontalActionList";z[z.repeatingBendingProcessNew=161]="repeatingBendingProcessNew";z[z.roundedRectangleTimeline=162]="roundedRectangleTimeline";z[z.verticalDownArrowProcess=163]="verticalDownArrowProcess";z[z.verticalHollowActionList=164]="verticalHollowActionList";z[z.verticalSolidActionList=165]="verticalSolidActionList";z[z.dropPinTimeline=166]="dropPinTimeline";z[z.horizontalLabelsTimeline=
167]="horizontalLabelsTimeline";z[z.horizontalPathTimeline=168]="horizontalPathTimeline";z[z.iconLabelList=169]="iconLabelList";z[z.iconCircleList=170]="iconCircleList";z[z.iconLabelDescriptionList=171]="iconLabelDescriptionList";z[z.iconVerticalSolidList=172]="iconVerticalSolidList";z[z.iconCircleLabelList=173]="iconCircleLabelList";z[z.iconCircleOutlineLabelList=174]="iconCircleOutlineLabelList";z[z.iconLeafLabelList=175]="iconLeafLabelList";z[z.iconLeafOutlineLabelList=176]="iconLeafOutlineLabelList";
z[z.centeredIconLabelDescriptionList=177]="centeredIconLabelDescriptionList"})(Dh||(Dh={}));Object(h.b)("SmartArtLayout",Dh);var Qf=d(155),Yb=d(379),li=d(60),re;(function(z){z[z.title=0]="title";z[z.body=1]="body";z[z.centerTitle=2]="centerTitle";z[z.subTitle=3]="subTitle";z[z.slideNum=5]="slideNum";z[z.footer=6]="footer";z[z.object=8]="object";z[z.graph=9]="graph";z[z.table=10]="table";z[z.clipArt=11]="clipArt";z[z.orgChart=12]="orgChart";z[z.media=13]="media";z[z.picture=15]="picture"})(re||(re=
{}));Object(h.b)("PlaceholderType",re);var lf=d(157),Id=d(46),We=d(868),Wc=d(26),Xc=d(28);class Ld{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd){this.ggb="Existing";this.Jhd="ExistingInMenu";this.Icl="AnimationExisting";this.Jcl="AnimationExistingInMenu";this.Lxb=!1;this.TYk=()=>32;this.Ymj=(Bd,Zd,df)=>1==df?32:lf.b("AnimationPaneActor::ShowHideAnimationPane PaneOpen:",this.Lxb.toString(),Bd,()=>{(this.Lxb=!this.Lxb)?this.b9k():this.Tpj();return 32});this.bad=(Bd,Zd,df,Ke,zf)=>{zf&&zf.Yf(this.Lxb);
return 32};this.b9k=()=>{const Bd=this.OE(),Zd={title:ResourceStrings.L_AnimationGalleryGroup,hideHeader:!1,width:Bd.spk,location:2,contentProps:Bd,onOpen:()=>{},onClose:()=>{this.Lxb=!1},isModernPane:!0};Se.UISurfaces.du().then(df=>{df.showTaskPane(Id.a.L2a,Zd);return null}).catch(df=>{Wc.a.J(0,833,10,"AnimationActor::showAnimationPane exception: {0}",df.toString())})};this.OE=()=>({type:"AnimationPaneProps",spk:We.a,sAl:!0,uAl:!0,wAl:!0});this.Tpj=()=>{Se.UISurfaces.du().then(Bd=>{Bd.hideTaskPane(Id.a.L2a,
2);return null}).catch(Bd=>{Wc.a.J(0,833,10,"AnimationActor::hideAnimationPane exception: {0}",Bd.toString())})};this.ia=z;this.Rp=T;this.sa=ja;this.W0c=nd.rk(li.a.oxe);this.Jb=Ga;this.Ga=Ba;this.zz=Fb;this.YCg=Rb;this.Zb=tc;this.Kxb=Ac.pptAnimationMarkersEnabled;this.Fa=kd;this.Cje=Ac.QMa}wb(){this.ia.ra(Xc.a.$$c,ed.a.application,Object(v.a)(this,this.$$c,"queryAnimationGallery"),97);this.ia.ra(Xc.a.GAe,ed.a.application,Object(v.a)(this,this.GAe,"queryMoreAnimationGallery"),96);this.ia.ra(Xc.a.IL,
ed.a.application,Object(v.a)(this,this.IL,"setAnimation"),5);this.ia.ra(Xc.a.ffd,ed.a.application,Object(v.a)(this,this.IL,"setAnimation"),5);this.ia.ra(Xc.a.sHe,ed.a.application,Object(v.a)(this,this.IL,"setAnimation"),5);this.ia.ra(Xc.a.ifd,ed.a.application,Object(v.a)(this,this.IL,"setAnimation"),5);this.ia.ra(Xc.a.aAk,ed.a.application,Object(v.a)(this,this.$zk,"queryEffectOptions"),100);this.ia.ra(Xc.a.gfd,ed.a.application,Object(v.a)(this,this.gfd,"setAnimationDirection"),5);this.ia.ra(Xc.a.Y$c,
ed.a.application,Object(v.a)(this,this.Y$c,"queryAnimationDirection"),97);this.ia.ra(Xc.a.hfd,ed.a.application,Object(v.a)(this,this.hfd,"setAnimationEffectData"),4);this.ia.ra(Xc.a.Z$c,ed.a.application,Object(v.a)(this,this.Z$c,"queryAnimationEffectData"),96);this.ia.ra(Xc.a.Gih,ed.a.application,Object(v.a)(this,this.jfd,"setAnimationSequence"),5);this.ia.ra(Xc.a.Hih,ed.a.application,Object(v.a)(this,this.jfd,"setAnimationSequence"),5);this.ia.ra(Xc.a.Iih,ed.a.application,Object(v.a)(this,this.jfd,
"setAnimationSequence"),5);this.ia.ra(Xc.a.Jih,ed.a.application,Object(v.a)(this,this.jfd,"setAnimationSequence"),5);this.ia.ra(Xc.a.cad,ed.a.application,Object(v.a)(this,this.cad,"queryAnimationSequence"),97);this.ia.ra(Xc.a.Vch,ed.a.application,Object(v.a)(this,this.J9,"reorderAnimation"),4);this.ia.ra(Xc.a.Wch,ed.a.application,Object(v.a)(this,this.J9,"reorderAnimation"),4);this.ia.ra(Xc.a.$xe,ed.a.application,Object(v.a)(this,this.$xe,"populateAnimationEffectOptions"),96);this.ia.ra(Xc.a.efd,
ed.a.application,Object(v.a)(this,this.efd,"setAnimationColor"),4);this.Cje&&(this.ia.ra(Xc.a.O6h,ed.a.application,Object(v.a)(this,this.UYk,"setAnimationStartHandler"),4),this.ia.ra(Xc.a.SYk,ed.a.application,Object(v.a)(this,this.TYk,"setAnimationDurationHandler"),4),this.ia.ra(Xc.a.g$k,ed.a.application,this.Ymj,4),this.ia.ra(Xc.a.bad,ed.a.application,this.bad,96),this.ia.ra(Xc.a.QYk,ed.a.application,Object(v.a)(this,this.RYk,"setAnimationDelayHandler"),4))}Fe(){}$xe(z,T,ja,Ba,Ga){z=this.iS();T=
this.sa.ny();if(!T||!z)return 8;if(1===ja)return 32;ja=Ld.q2(T,z);if(!ja||0===ja.EffectId)return 16;Ga.MenuItems=this.Ubi(ja,T,z);return 32}$$c(z,T,ja,Ba,Ga){z=Ga.queryResult;Ga=Ga.SourceControlId;var Fb=Ba=-1;Ga!==this.ggb&&({effectType:Fb,effectId:Ba}=this.zz.s8f(Ga));T=this.iS();var Rb=this.sa.ny();if(!Rb||!T)return 8;if(1!==ja)return 32;({image:ja,label:kd}=this.zz.t8f(Ga));var tc=kd;if(Ga===this.ggb||Ga===this.Jhd)tc=ResourceStrings.L_ExistingButtonDescription;this.DWd(Ga,ja,kd,z,tc);var Ac=
Ld.q2(Rb,T);var kd=Ac?Ac.EffectId:0;tc=Ac?Ac.EffectType:0;const nd=!this.zz.Y7a(Ac,T);Ac=this.zz.s9d(Ac,T);this.Kxb&&(Rb=Rb?Rb.gQa(T):null,Ac=Ac&&!this.zz.pKj(Rb));Ba=!nd&&!Ac&&Ba===kd&&Fb===tc;Fb=nd?!1:this.zz.Prg(tc,kd);Ga===this.ggb||Ga===this.Jhd?(Fb=Ga===this.ggb?this.dAk(this.ggb,z,Ac,Fb,ja,tc,kd):Ld.cAk(z,Ac,Fb),z.F4(nd||Ac||Fb)):T&&z.F4(Ba);return 32}dAk(z,T,ja,Ba,Ga,Fb,Rb){ja?this.DWd(z,Ga,ResourceStrings.L_AnimationMultiple,T,ResourceStrings.L_AnimationMultiple):Ba&&(Ga=this.zz.N0d(Fb,Rb),
{image:Ga,label:ja}=this.zz.t8f(Ga),this.DWd(z,Ga,ja,T,ja));return Ba}DWd(z,T,ja,Ba,Ga){let Fb;Fb=z===this.ggb?"298832323":z===this.Jhd?"1264919631":"2676673376";T=T.substring((li.a.y9c+"_").length,T.length-6);z=Object.assign(new hj.a,{Id:z,ExternalId:"Animation"+z,Icon:T,Command:Fb,QueryCommand:"1852964326",LabelText:ja,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Ga});Ba.T6=z}GAe(z,T){if(T.contextId!==ed.a.application)return 2;z=this.iS();
return!this.sa.ny()||!z||z.nZ||z.ar||z.hq?8:this.Zb.gd(z)?16:32}IL(z,T,ja,Ba,Ga){T=this.iS();var Fb=this.sa.ny();if(!Fb||!T||T.nZ||T.ar||T.hq)return 8;if(this.Zb.gd(T))return 16;var Rb=(Ba=Ld.q2(Fb,T))?Ba.EffectId:-1,tc=Ba?Ba.EffectType:-1;if(1===ja)return z===Xc.a.sHe||z===Xc.a.ifd?(Fb=this.zz.Prg(tc,Rb),ja=!!Ba&&!this.zz.Y7a(Ba,T),z===Xc.a.ifd&&(Fb=ja?!0:!1),T=!!Ba&&this.zz.s9d(Ba,T),T=ja||T,Fb||T?32:16):z===Xc.a.ffd?T.rd||T.Gq||T.hq?16:32:32;z=Ga.SourceControlId;if(!z)return 8;if(z===this.ggb||
z===this.Jhd||z===this.Icl||z===this.Jcl)return 32;({effectType:Ga,effectId:ja}=this.zz.s8f(z));Rb=this.zz.g_i(z);tc=this.zz.d_i(z);Ba=T.L7a()?Ld.Y_b(Fb,T):Ba;Ba||(Ba=new Xg,Ba.Id=T.id.toString(),Ba.BuildIds=[Fb.GXb+1],Ba.HasTrigger=!1,Ba.BuildId=Fb.GXb+1,Ba.SequenceIndex=0,Ba.IsTextRangeType=!1);Ba.HasExisting=!1;Ba.HasMultiple=!1;Ba.EffectType=Ga;Ba.SequenceId=1;Ba.EffectId=ja;Ba.Direction=Rb;Ba.EffectData=tc;Ba.IsTrigger=!1;this.wYb(Fb,T,Ba);e.ULS.sendTraceTag(588375195,800,50,"AnimationActor.SetAnimation: Effect={0}, SlideId.Sid={1}, ShapeId={2}",
z,Fb.Cb.sid,T.id);this.BVj(Fb);return 32}efd(z,T,ja,Ba,Ga){T=this.Rp.presentation;if(!T)throw Error.argumentNull("Presentation is null");z=this.iS();if(!z)return 8;T=Object(A.a)(132,T.LB(z.slideId));if(!T)return 8;Ba=Ld.q2(T,z);if(!(Ba&&Ga&&T&&z))return 8;if(this.Zb.gd(z))return 16;if(1===ja)return 32;ja=Qf.Box4ColorHelper.q0(Ga);ja=Qf.Box4ColorHelper.EEb(ja,T.Ye);if(!ja)return 8;Ba.EffectData=String.format("{0},{1},{2}",ja.r.toString(16),ja.g.toString(16),ja.b.toString(16));this.wYb(T,z,Ba);return 32}$zk(){const z=
this.iS();var T=this.sa.ny();return T&&z?this.Zb.gd(z)?16:(T=Ld.q2(T,z))&&this.zz.Zgi(z,this.Fa,T)?32:16:8}J9(z,T,ja){T=this.iS();const Ba=this.sa.ny();if(!Ba||!T)return 8;if(this.Zb.gd(T))return 16;const Ga=Ld.Y_b(Ba,T);let Fb;switch(z){case Xc.a.Vch:Fb=!1;break;case Xc.a.Wch:Fb=!0;break;default:return 8}let Rb=!1;if(T&&(Rb=!!Ga&&!Ga.HasTrigger&&1===Ga.BuildIds.length)){let tc=!1,Ac=!1;({gUb:tc,iUb:Ac}=Ld.ahi(Ba,Ga));Rb=Fb?Ac&&Rb:tc&&Rb}if(1===ja)return Rb?32:8;if(Rb){ja=this.Jb.xd(15,void 0,()=>
{this.sa.fj();this.Ga.Bd()});try{ja.lc(Ba),ja.fd=z,Ba.J9(T,Fb)}finally{ja&&ja.dispose()}}return 32}gfd(z,T,ja,Ba,Ga){z=this.iS();T=this.sa.ny();if(!T||!z)return 8;if(1===ja)return 32;if(this.Zb.gd(z))return 16;ja=Ld.Y_b(T,z);if(!ja)return 8;Ga=Ga.MenuItemId;ja.Direction=this.zz.iYd(Ga);this.wYb(T,z,ja);e.ULS.sendTraceTag(588375194,800,50,"AnimationActor.SetAnimationDirection: Effect={0}, EffectDirection={1}, SlideId.Sid={2}, ShapeId={3}",this.zz.N0d(ja.EffectType,ja.EffectId),Ga,T.sid,z.id);return 32}Y$c(z,
T,ja,Ba,Ga){T=this.iS();Ba=this.sa.ny();if(!Ba||!T)return 8;z=Ga.queryResult;Ga=this.zz.iYd(Ga.MenuItemId);T=Ld.q2(Ba,T);1===ja&&T&&z.Yf(T.Direction===Ga);return 32}jfd(z,T,ja,Ba,Ga){z=Ga.MenuItemId;T=this.iS();Ba=this.sa.ny();if(!Ba||!T)return 8;if(1===ja)return 32;if(this.Zb.gd(T))return 16;ja=Ld.Y_b(Ba,T);if(!ja)return 8;ja.SequenceId=this.zz.vcg(z);this.wYb(Ba,T,ja);return 32}cad(z,T,ja,Ba,Ga){z=this.iS();T=this.sa.ny();if(!T||!z)return 8;z=Ld.q2(T,z);T=Ga.queryResult;Ga=this.zz.vcg(Ga.MenuItemId);
1===ja&&z&&T.Yf(z.SequenceId===Ga);return 32}hfd(z,T,ja,Ba,Ga){z=this.iS();T=this.sa.ny();if(!T||!z)return 8;if(1===ja)return 32;if(this.Zb.gd(z))return 16;ja=Ld.Y_b(T,z);if(!ja)return 8;if(!Ga)return 2;ja.EffectData=this.zz.r8f(Ga.MenuItemId);this.wYb(T,z,ja);return 32}Z$c(z,T,ja,Ba,Ga){z=this.iS();T=this.sa.ny();if(!T||!z)return 8;z=Ld.q2(T,z);1===ja&&z&&Ga.queryResult.Yf(this.zz.goi(z.EffectData,Ga.MenuItemId));return 32}UYk(){return 32}RYk(){return 32}wYb(z,T,ja){const Ba=this.Jb.xd(15,void 0,
()=>{this.sa.fj();this.Ga.Bd()});try{Ba.lc(z),z.xjc(T,ja)}finally{Ba&&Ba.dispose()}}Ubi(z,T,ja){const Ba=Object.assign(new cg.a,{Id:"AnimationMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_EffectOptions,MenuSectionList:[]});Array.add(Ba.MenuSectionList,this.zz.Jbg(z.EffectId,z.EffectType,"Direction","2289594085","3782857737"));this.zz.Uqg(z)&&(Array.add(Ba.MenuSectionList,Yb.f(T.Ye,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",
2)),Array.add(Ba.MenuSectionList,Yb.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)));Array.add(Ba.MenuSectionList,this.zz.Jbg(z.EffectId,z.EffectType,"EffectData","2949363495","4132852551"));Array.add(Ba.MenuSectionList,this.zz.O8i(ja,this.Fa,z));return Ba}BVj(z){if(z){var T=z.km(),ja=String.format("{0}#{1}",z.sid,z.cid);if(T&&0<T.length)for(const Ba of T)if(T=z.cCa(Ba)){const Ga=T.EffectId,Fb=T.EffectType,Rb=T.Direction,tc=this.zz.N0d(Fb,
Ga),Ac=this.Fa.t9f(Ba),kd=Ld.uaj(Ba,Ac);e.ULS.sendTraceTag(588375193,800,50,"Slide animation info: Effect={0}, EffectID={1}, EffectType={2}, Direction={3}, Len={4}, ShapeType={5}, ShapeSubType={6}, SeqID={7}, SlideID={8}, ShapeID={9}",tc,Ga,Fb,Rb,Ba.hD().length,Ac,kd,T.SequenceId,ja,Ba.id)}}}iS(){const z=this.sa.Dq();return z?z.get_smartArtModelId()?this.Fa.Lr(z):z.xh?this.Fa.ys(z):z:null}static cAk(z,T,ja){T?z.AZb=ResourceStrings.L_AnimationMultiple:(z.AZb=ResourceStrings.L_AnimationExisting,ja&&
(ja=!1));return ja}static ahi(z,T){let ja,Ba;if(!T)return{gUb:!1,iUb:!1};const Ga=z.qSd,Fb=z.GXb,Rb=T.BuildIds[0];Ba=ja=!0;0===T.StartType?ja=Rb>Ga?!0:!1:Ba=Rb<Fb?!0:!1;if(Rb===Ga||Rb===Fb){if(!Rb)return{gUb:!1,iUb:Ba};for(const tc of z.sP)if(tc.Id!==T.Id)for(const Ac of tc.BuildIds)if(0===T.StartType){if(Ac>=Rb)return Ba=!0,{gUb:ja,iUb:Ba}}else if(Ac===Rb)return ja=!0,{gUb:ja,iUb:Ba};0===T.StartType?Ba=!1:ja=!1}return{gUb:ja,iUb:Ba}}static q2(z,T){return z&&T?z.q2(T):null}static Y_b(z,T){return z&&
T?z.cCa(T):null}static bKc(z,T,ja){z=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',z,ja);T=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',T);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',z,T)}static uaj(z,T){return 24===T?Dh[z.smartArtInfo.SmartArtLayout]:1===T?z.shapeType.toString():14===T?re[z.zj]:"Unknown"}}Object(h.a)(Ld,"AnimationActor",
null,[234]);class Xf{constructor(z,T,ja,Ba){this.wf=null;this.Da=z;this.Rib=T;this.bLh=ja;this.Bzd=Ba;this.Bzd.init();this.Rib.init()}wb(){this.Da.ra(dd.a.G8c,ed.a.application,Object(v.a)(this,this.G8c,"openGrammarSettings"),1028);this.Da.ya(dd.a.V0b,ec.a.frame,Object(v.a)(this,this.Efg,"grammarDialogTabFocusHandler"));this.Da.ya(dd.a.U0b,ec.a.frame,Object(v.a)(this,this.Efg,"grammarDialogTabFocusHandler"));this.Da.ya(dd.a.XNc,ec.a.frame,Object(v.a)(this,this.Dfg,"grammarDialogOptionFocusHandler"));
this.Da.ya(dd.a.WNc,ec.a.frame,Object(v.a)(this,this.Dfg,"grammarDialogOptionFocusHandler"))}G8c(z,T,ja,Ba,Ga){z=this.E7f();if(1===ja)return this.Bzd.request(z).result&&this.Bzd.request(z).result.length?6===this.Rib.x0a.status?32:8:8;this.wf=this.bLh(z,this.Rib.x0a.result);this.wf.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,Fb=>{e.ULS.sendTraceTag(36489285,375,50,"User click button of {0}",1===Fb?"OK":0===Fb?"Cancel":"");1===Fb&&(this.wf.qNj()?(e.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),
this.Rib.saveSettings(this.wf.settings)):e.ULS.sendTraceTag(36508631,375,50,"User click OK with but not update setting"))});z=ja="";Ga&&(ja+=Ga.SourceControlId,z+=Ga.Alt);e.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+ja+", Alt: "+z);return 32}E7f(){return E.AFrameworkApplication.lcid}Efg(z){if(!this.wf)return 2;var T=this.wf.Wn.Mk().gj.QY;if(T===this.wf.wv&&z===dd.a.V0b||T===this.wf.TWa&&z===dd.a.U0b)this.wf.h6?this.wf.Wn.Mk().gj.aE(this.wf.h6):this.wf.xWk();
else if(Sys.UI.DomElement.containsCssClass(T,Gd.tWb)||T.parentNode&&Sys.UI.DomElement.containsCssClass(T.parentNode,Gd.tWb))T=null,z===dd.a.V0b?T=this.wf.TWa:z===dd.a.U0b&&(T=this.wf.wv),this.wf.Wn.Mk().gj.aE(T);else if(z===dd.a.V0b)this.wf.Wn.Mk().ZAb();else if(z===dd.a.U0b)this.wf.Wn.Mk().XAb();else return 2;return 32}Dfg(z){if(!this.wf)return 2;let T=this.wf.Wn.Mk().gj.QY;if(T===this.wf.wv||T===this.wf.TWa||T===this.wf.AC)return 2;z===dd.a.WNc&&this.wf.Wn.Mk().ZAb();z===dd.a.XNc&&this.wf.Wn.Mk().XAb();
T=this.wf.Wn.Mk().gj.QY;T===this.wf.TWa?this.wf.Wn.Mk().XAb():T===this.wf.wv?this.wf.Wn.Mk().ZAb():this.wf.h6=T;return 32}}Object(h.a)(Xf,"GrammarSettingsActor",null,[]);class Le extends Xf{constructor(z,T,ja,Ba,Ga,Fb,Rb){super(z,T,ja,Ba);this.ob=Ga;this.ele=Fb;this.Fa=Rb}E7f(){let z=E.AFrameworkApplication.lcid;if(this.ob.vZ(this.ob.Pa)){var T=this.ob.he();T&&1===T.length&&(T=this.Fa.OPa(T[0]),0<T&&(z=T))}else this.ob.Pa.kb&&(T=this.ele.WLc(this.ob.Dj),0<T&&(z=T));return z}}Object(h.a)(Le,"EditorSettingsActor",
Xf,[]);var md=d(64),oj=d(321),Ie=d(256),qh=d(435),Od=d(40);class ef{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd){this.Iaa=null;this.ia=z;this.Ga=T;this.Zb=ja;this.sa=Ba;this.Jb=Ga;this.DW=Fb;this.ua=Rb;this.Mz=tc;this.jF=Ac;this.Dle=kd;this.Wd=nd;this.Ha=Bd}wb(){this.Ha.$Ij?(this.ia.ra(Xc.a.x5a,ed.a.application,Object(v.a)(this,this.W2d,"handleSlidesSolidFill"),4),this.ia.ra(Xc.a.kWd,ed.a.application,Object(v.a)(this,this.W2d,"handleSlidesSolidFill"),4),this.ia.ra(Xc.a.lWd,ed.a.application,Object(v.a)(this,
this.W2d,"handleSlidesSolidFill"),4),this.ia.ra(Xc.a.jWd,ed.a.application,Object(v.a)(this,this.V2d,"handleSlidesPicture"),4),this.ia.ra(Xc.a.e4f,ed.a.application,Object(v.a)(this,this.V2d,"handleSlidesPicture"),4),this.ia.ra(Xc.a.f4f,ed.a.application,Object(v.a)(this,this.V2d,"handleSlidesPicture"),4),this.ia.ra(Xc.a.HJc,ed.a.application,Object(v.a)(this,this.bnj,"handleSlidesFinalizePicture"),4)):(this.ia.ra(Xc.a.x5a,ed.a.application,Object(v.a)(this,this.X2d,"handleSolidFill"),4),this.ia.ra(Xc.a.kWd,
ed.a.application,Object(v.a)(this,this.X2d,"handleSolidFill"),4),this.ia.ra(Xc.a.lWd,ed.a.application,Object(v.a)(this,this.X2d,"handleSolidFill"),4),this.ia.ra(Xc.a.jWd,ed.a.application,Object(v.a)(this,this.M2d,"handlePicture"),4),this.ia.ra(Xc.a.e4f,ed.a.application,Object(v.a)(this,this.M2d,"handlePicture"),4),this.ia.ra(Xc.a.f4f,ed.a.application,Object(v.a)(this,this.M2d,"handlePicture"),4),this.ia.ra(Xc.a.HJc,ed.a.application,Object(v.a)(this,this.jjj,"handleFinalizePicture"),4));this.ia.ra(Xc.a.iWd,
ed.a.application,Object(v.a)(this,this.q2d,"handleApplyAll"),4);this.ia.ra(Xc.a.ySi,ed.a.application,Object(v.a)(this,this.q2d,"handleApplyAll"),4);this.ia.ra(Xc.a.zSi,ed.a.application,Object(v.a)(this,this.q2d,"handleApplyAll"),4);this.ia.ra(Xc.a.U3g,ed.a.application,Object(v.a)(this,this.ilj,"handlePopulateFillMenu"),96);this.ia.ra(Xc.a.Itk,ed.a.application,Object(v.a)(this,this.jlj,"handlePopulateFillMenuForCanvasContextMenu"),96);this.ia.ra(Xc.a.Jtk,ed.a.application,Object(v.a)(this,this.klj,
"handlePopulateFillMenuForThumbnailPaneContextMenu"),96);this.ia.ra(Xc.a.Mre,ed.a.application,Object(v.a)(this,this.rkj,"handleMoreFormatBackgroundColors"),96);this.ia.ra(Xc.a.k$c,ed.a.application,Object(v.a)(this,this.skj,"handleMoreFormatBackgroundColorsResponse"),4)}Fe(){}ilj(z,T,ja,Ba,Ga){z=this.ua.Ca;if(!z||this.Zb.gd(z))return 16;if(1===ja)return 32;if(!Ga)return Wc.a.J(8955407,822,10,"HandlePopulateFillMenu requires actionData"),8;ja=z.Ye;if(!ja)return Wc.a.J(18101336,822,10,"HandlePopulateFillMenu failed to get theme information from slide"),
8;z=this.DW.Bf.I1;T=Object.assign(new cg.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});Array.add(T.MenuSectionList,Yb.f(ja,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors","3049223287",1));Array.add(T.MenuSectionList,Yb.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors","3049223287",!1));z&&0<z.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),Array.add(T.MenuSectionList,
Yb.c(z,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors","1912773268",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));Array.add(T.MenuSectionList,Yb.a("More Format Background Color","Color.Menu.Controls","3938657252",ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));
Ga.MenuItems=T;return 32}jlj(z,T,ja,Ba,Ga){z=this.ua.Ca;if(!z||this.Zb.gd(z))return 16;if(1===ja)return 32;if(!Ga)return Wc.a.J(512623376,822,10,"HandlePopulateFillMenuForCanvasContextMenu requires actionData"),8;T=z.Ye;if(!T)return Wc.a.J(512623374,822,10,"HandlePopulateFillMenuForCanvasContextMenu failed to get theme information from slide"),8;ja=this.DW.Bf.I1;Ba=Xc.a.kWd.toString();z=Object.assign(new cg.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});z.MenuSectionList.push(Yb.f(T,"Theme Colors",
"Color.Menu.Controls","themeColor","FormatBackgroundThemeColorsFromCanvas",Ba,1));z.MenuSectionList.push(Yb.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColorsFromCanvas",Ba,!1));T=Xc.a.k$c.toString();ja&&0<ja.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),z.MenuSectionList.push(Yb.c(ja,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors",T,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",
!0));z.MenuSectionList.push(Yb.a("More Format Background Color","Color.Menu.Controls",Xc.a.Mre.toString(),ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));Ga.MenuItems=z;return 32}klj(z,T,ja,Ba,Ga){z=this.ua.Ca;if(!z||this.Zb.gd(z))return 16;if(1===ja)return 32;if(!Ga)return Wc.a.J(512623375,822,10,"HandlePopulateFillMenuForThumbnailPaneContextMenu requires actionData"),
8;T=z.Ye;if(!T)return Wc.a.J(512623373,822,10,"HandlePopulateFillMenuForThumbnailPaneContextMenu failed to get theme information from slide"),8;ja=this.DW.Bf.I1;Ba=Xc.a.lWd.toString();z=Object.assign(new cg.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});z.MenuSectionList.push(Yb.f(T,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColorsFromThumbnailPane",Ba,1));z.MenuSectionList.push(Yb.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColorsFromThumbnailPane",
Ba,!1));T=Xc.a.k$c.toString();ja&&0<ja.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),z.MenuSectionList.push(Yb.c(ja,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors",T,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));z.MenuSectionList.push(Yb.a("More Format Background Color","Color.Menu.Controls",Xc.a.Mre.toString(),ResourceStrings.l_MoreFormatBackgroundColors,
"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));Ga.MenuItems=z;return 32}X2d(z,T,ja,Ba,Ga){T=this.ua.Ca;if(!T||this.Zb.gd(T)||this.Ha.vz&&1!==this.sa.rf().length)return 16;if(1===ja)return 32;ja=ef.gec(Ga);if(!ja)return 8;Od.a.Db&&Od.a.Db.Ya("SlideCount","1");Ga=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()});try{Ga.lc(T),Ga.fd=z,T.X2a=ja}finally{Ga&&Ga.dispose()}return 32}W2d(z,T,ja,Ba,
Ga){T=this.sa.rf();if(!T||!T.length)return 16;for(const Fb of T)if(!Fb||this.Zb.gd(Fb))return 16;if(1===ja)return 32;ja=ef.gec(Ga);if(!ja)return 8;Od.a.Db&&Od.a.Db.Ya("SlideCount",T.length.toString());Ga=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()});try{Ga.lc(this.ua.Ca);Ga.fd=z;for(const Fb of T)Fb.X2a=ja}finally{Ga&&Ga.dispose()}return 32}M2d(z,T,ja){this.Iaa=this.ua.Ca;if(!this.Iaa||this.Zb.gd(this.Iaa)||md.a.DA(this.Iaa.Cb)||this.Ha.vz&&1!==this.sa.rf().length)return 16;if(1===ja)return 32;
this.Akc(!1);return 32}V2d(z,T,ja){this.Iaa=this.ua.Ca;z=this.sa.rf();if(!z||!z.length)return 16;for(const Ba of z)if(!Ba||this.Zb.gd(Ba)||md.a.DA(Ba.Cb))return 16;if(1===ja)return 32;this.Akc(!1);return 32}q2d(z,T,ja){T=this.ua.Ca;if(!T||this.Zb.gd(T))return 16;if(1===ja)return 32;ja=T.Cb;T=this.DW.Bf;if(!T)return 8;const Ba=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()});try{Ba.lc(T),Ba.fd=z,T.dnb=ja}finally{Ba&&Ba.dispose()}return 32}jjj(z,T,ja,Ba,Ga){if(!this.Iaa||!this.Iaa.isConnected||
this.Ha.vz&&1!==this.sa.rf().length)return 16;if(1===ja)return 32;this.jF.wva=new Date;const Fb=Od.a.Db;this.Mz.Xhd(Ga,Rb=>{Od.a.iK(Fb,()=>{this.N2d(Rb,z)})},Rb=>{this.V6a(Rb.error)});this.ua.Ca===this.Iaa&&(this.Ga.Bd(),this.sa.Rh());return 32}bnj(z,T,ja,Ba,Ga){T=this.sa.rf();if(!T||!T.length)return 16;for(const Rb of T)if(!Rb||!Rb.isConnected)return 16;if(1===ja)return 32;this.jF.wva=new Date;const Fb=Od.a.Db;this.Mz.Xhd(Ga,Rb=>{Od.a.iK(Fb,()=>{this.dnj(Rb,z)})},Rb=>{this.V6a(Rb.error)});this.ua.Ca===
this.Iaa&&(this.Ga.Bd(),this.sa.Rh());return 32}rkj(z,T,ja,Ba,Ga){z=this.ua.Ca;if(!z||this.Zb.gd(z))return Wc.a.J(595186560,822,10,"HandleMoreFormatBackgroundColors: currentSlide is null"),16;if(this.Ha.vz&&1!==this.sa.rf().length)return 16;if(1===ja)return this.ia.Ma(Xc.a.renderColorPicker,1,Ga);ja=Ie.a.parse(z.BY);if(!ja)return 8;Ga=ja.cJa();ja=null;Ga&&(ja=Qf.Box4ColorHelper.Vqa(Ga));Ga={};Ga.currentColor=ja;Ga.handleCommand=Xc.a.k$c;return this.ia.Ma(Xc.a.renderColorPicker,2,Ga)}skj(z,T,ja,Ba,
Ga){if(1===ja)return this.ia.Ma(Xc.a.x5a,ja,Ga);if(!Ga)return Wc.a.J(595186530,822,10,"HandleMoreFormatBackgroundColorsResponse: actionData is null"),16;z=this.ia.Ma(Xc.a.x5a,ja,Ga);32===z&&this.ia.Ma(Xc.a.zza,ja,Ga);return z}Akc(z){this.Dle?qh.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.Mz&&(this.Mz.jJb=1,this.Mz.y6g(z))}N2d(z,T){this.jF.vva=new Date;(z=z.result)?this.rLd(z,T):(T=Object.assign(new oj.a,{Code:94}),this.V6a(T))}dnj(z,T){this.jF.vva=new Date;(z=
z.result)?this.Iii(z,T):(T=Object.assign(new oj.a,{Code:94}),this.V6a(T))}rLd(z,T){const ja=this.Jb.xd(15);try{ja.lc(this.Iaa),ja.fd=T,this.Iaa.zA=z.ItemId}finally{ja&&ja.dispose()}if(z=Od.a.Db)z.actionName="FormatBackgroundPicture",z.Ya("PictureUploadStart",Od.a.Ve(this.jF.wva)),z.Ya("PictureUploadDurationMS",(+this.jF.vva-+this.jF.wva).toString())}Iii(z,T){const ja=this.sa.rf(),Ba=this.Jb.xd(15);try{Ba.lc(this.Iaa);Ba.fd=T;for(const Ga of ja)Ga.zA=z.ItemId}finally{Ba&&Ba.dispose()}if(z=Od.a.Db)z.actionName=
"FormatBackgroundPicture",z.Ya("PictureUploadStart",Od.a.Ve(this.jF.wva)),z.Ya("PictureUploadDurationMS",(+this.jF.vva-+this.jF.wva).toString())}V6a(z){this.jF.vva=new Date;this.Wd.YH(z.Code,T=>{T.$C=1;T.Z4a=z.ExtraErrorParam;return!1})}static gec(z){return Ie.a.parse(z.Color)}}Object(h.a)(ef,"FormatBackgroundActor",null,[234]);var dh=d(75),ad=d(31),Fg=d(406),Cd=d(30),zg=d(152);const Eh=z=>{let T=z.isBold?"b:1;":"";T+=z.isItalic?"i:1;":"";T+=z.mD?"u:1;":"";T+=z.YE?"s:1;":"";T+=z.isSuperscript?"sup:1;":
"";return T+=z.ZE?"sub:1;":""},eh=(z,T,ja)=>{let Ba=null;for(var Ga,Fb=ad.ParagraphReader.text(z),Rb=0;z.Ra&&Rb<z.Ra.length;){var tc=z.Ra.ga(Rb),Ac=tc.cp;Ga=Rb<z.Ra.length-1?z.Ra.ga(Rb+1).cp:ad.ParagraphReader.textLength(z);if(-1!==T&&Ga<=T)Rb++;else{if(-1!==ja&&Ac>ja)break;var kd="";tc.formatting?kd=Eh(tc.formatting.cache):({JUc:tc}=Fg.c(z.Ra,tc.cp),tc&&(kd=Eh(tc.cache)));tc=Ac;-1!==T&&(tc=Math.max(T,Ac));Ac=Ga;-1!==ja&&(Ac=Math.min(ja,Ga));Ac=Ub.a.substring(Fb,tc,Ac);0<Ac.length&&(Ga=document.createElement("span"),
Ga.setAttribute("style",kd),Ga.innerText=Ac,Ba||(Ba=document.createElement("p")),Ba.appendChild(Ga));Rb++}}if(Ba&&ad.ParagraphReader.FV(z)){T=Ba;ja=T.setAttribute;Rb=new Cd.GraphIterator;Rb.set(z);Rb.oc(11);Rb.Og(11);Fb="";if(z.Sf.rx(Rb))switch(Rb=z.Sf.rx(Rb),z=ad.ParagraphReader.cdb(z),kd=Rb.SV,Rb.listType){case 0:switch(Rb.listStyle){case 1:Fb="decimal";break;case 2:Fb="loweralpha";break;case 3:Fb="lowerroman";break;case 4:Fb="upperalpha";break;case 5:Fb="upperroman";break;default:Fb="decimal"}Fb=
String.format("lt:{0};in:{1};li:{2}",Fb,z,kd);break;case 1:switch(Rb.listStyle){case 1:Fb="disc";break;case 2:Fb="circle";break;case 3:Fb="square";break;default:Fb="disc"}Fb=String.format("lt:{0};in:{1}",Fb,z)}ja.call(T,"style",Fb)}return Ba},Gg=z=>{if(z){var T;(T=C.a.instance.resolve("PowerPointWebEditor.Graph.ITableReader"))?T=T.ZM(z):(Wc.a.J(570750409,822,10,"ImmersiveReader: TableReader is null."),T=null);if(T){z=null;T=T.r0b();for(let ja=0;ja<T.length;ja++){const Ba=vh(Object(A.a)(dh.AParagraphNode,
T[ja].ZYb));z=ze(Ba,z)}return z}z=Array.isArray(z.hD())?z.hD():null;return vh(z&&0<z.length?z[0]:null)}return null},vh=z=>{let T=null;for(;z;){const ja=eh(z,-1,-1);T=ze(ja,T);z=ad.ParagraphReader.ora(z,!1,!0,!1)}return T},ze=(z,T)=>{z&&(T||(T=document.createElement("div")),T.appendChild(z));return T},sg=z=>{const T=Object.assign(new zg.a,{Source:6});C.a.instance.resolve("PowerPointWebEditor.IErrorHandler").Mr(T,z,ja=>{ja.$C=1;ja.cAa=0;ja.title=ResourceStrings.L_ImmersiveReaderErrorDialogTitle;ja.message=
ResourceStrings.L_ImmersiveReaderErrorDialogMessage;return!1})};var zd=d(42);class Hd{constructor(z,T,ja,Ba){this.QGg=!1;this.r2c="";this.ia=z;this.Ga=T;this.ob=ja;const Ga=new Date;Ba("immersiveReader").then(()=>{this.QGg=!0;Wc.a.J(573334594,822,50,"ImmersiveReader: Loaded SDK successfully. Duration (ms): {0}",+new Date-+Ga)}).catch(Fb=>{const Rb=+new Date-+Ga;Wc.a.J(573334595,822,10,"ImmersiveReader: Failed to load SDK. Duration (ms): {0}, Exception: {1} ",Rb,Fb.toString());const tc=new Map;tc.set("JSLoadDurationInMs",
Rb.toString());tc.set("Exception",Fb.toString());u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","JSLoadFailed",!1,!0,Object.assign(new Z.a,{extendedProperties:tc}))})}wb(){this.ia.ya(Xc.a.immersiveReader,ed.a.view,Object(v.a)(this,this.wkg,"immersiveReaderHandler"));this.ia.ya(Xc.a.xkg,ed.a.view,Object(v.a)(this,this.wkg,"immersiveReaderHandler"))}Fe(){this.Ga.Bc(Id.a.QM).bindAction($a.KeyInputManager.La(kg.a.foc,$a.KeyInputManager.He|4),Xc.a.immersiveReader)}OVi(z){let T="";for(z=
Object(A.a)(dh.AParagraphNode,z.node);z;){const ja=ad.ParagraphReader.ora(z,!0,!0,!1);if(ja)z=ja;else break}for(;z;)T+="\n"+ad.ParagraphReader.text(z),z=ad.ParagraphReader.ora(z,!1,!0,!1);return T}Gci(){var z=this.ob.rf();let T=null;if(!z)return null;for(const ja of z)if(z=ja.xra())for(const Ba of z)z=Gg(Ba),T=ze(z,T);return T}Fci(){let z=null;var T=this.ob.Pa;if(!T)return null;for(let Ga of T)if(Ga)for(T=0;T<Ga.length;T++){var ja=Ga.ga(T),Ba=null;if(ja.contextId===ed.a.outline||ja.contextId===ed.a.Ff)if(ad.ParagraphReader.Pd(ja.node)){for(ja=
Object(A.a)(dh.AParagraphNode,ja.node);ja;)if(Ba=ad.ParagraphReader.ora(ja,!0,!0,!1))ja=Ba;else break;Ba=vh(ja)}else Ba=Gg(Object(A.a)(4,ja.node));else ja.contextId!==ed.a.endOfParagraph&&ad.ParagraphReader.Pd(ja.node)&&(Ba=eh(Object(A.a)(dh.AParagraphNode,ja.node),ja.Qa,ja.Lb));z=ze(Ba,z)}return z}Kci(){let z;return(z=this.ob.hu()?this.Gci():this.Fci())?z.innerHTML:""}kdj(){let z="";const T=this.ob.Pa.kb;if(T)for(let ja=0;ja<T.length;ja++){const Ba=T.ga(ja),Ga=Ba.Qa,Fb=Ba.Lb-Ga;let Rb;if(ad.ParagraphReader.Pd(Ba.node))switch(Rb=
Ba.node.characterData,Ba.contextId){case ed.a.paragraph:z+=Rb+"\r";break;case ed.a.textRange:0<Fb&&(z+=Rb.substr(Ga,Fb));break;case ed.a.endOfParagraph:z+="\r";break;case ed.a.Ff:z+=this.OVi(Ba)}}return z}Eyg(){const z=new XMLHttpRequest,T=C.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;var ja=C.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;ja=String.format("{0}PodHandler.ashx?action=ImmersiveReaderAuthToken&PodSID={1}",ja,T);z.open("GET",
ja,!0);const Ba=da.a.create().toString();z.setRequestHeader("X-UserSessionId",E.AFrameworkApplication.userSessionId);z.setRequestHeader("X-CorrelationID",Ba);z.setRequestHeader("X-WacCluster",C.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").qk);let Ga=null;const Fb=new Map;z.onreadystatechange=()=>{if(4===z.readyState)if(200===z.status){var Rb=+new Date-+Ga;Wc.a.J(572639116,822,50,"ImmersiveReader: auth token received. Duration (ms): {0}",Rb);Fb.set("AuthTokenDurationInMs",Rb.toString());
Rb=z.responseText.replace('"',"");const tc=new Date,Ac=zd.a("EnableSendingHTMLToIR")?[{["content"]:this.r2c,["mimeType"]:"text/html"}]:[{["content"]:this.r2c}];immersiveReader.launchAsync(Rb,null,{["title"]:ResourceStrings.L_ImmersiveReaderDialogTitle,["chunks"]:Ac},null).then(kd=>{kd=(kd=Object(A.a)(Object,kd))?kd.sessionId:"";const nd=+new Date-+tc,Bd=+new Date-+Ga;Wc.a.J(570970521,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",
nd,kd);Fb.set("LaunchAsyncDurationInMs",nd.toString());Fb.set("IRResponseSessionId",kd);Fb.set("UserPerceivedDurationInMs",Bd.toString());u.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",Object.assign(new Z.a,{extendedProperties:Fb}))}).catch(kd=>{sg(T);const nd=+new Date-+tc,Bd=+new Date-+Ga;Wc.a.J(570970522,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",nd,kd);Fb.set("LaunchAsyncDurationInMs",nd.toString());Fb.set("ErrorJson",kd.toString());Fb.set("UserPerceivedDurationInMs",
Bd.toString());u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,Object.assign(new Z.a,{extendedProperties:Fb}))})}else sg(T),Rb=+new Date-+Ga,Wc.a.J(572639117,822,10,"ImmersiveReader: Request for auth token failed. Duration (ms): {0}, statusCode:{1}, CorrelationId: {2}",Rb,z.status,Ba),Fb.set("CorrelationId",Ba),Fb.set("StatusCode",z.status.toString()),Fb.set("UserPerceivedDurationInMs",Rb.toString()),u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered",
"RequestForAuthTokenFailed",!1,!0,Object.assign(new Z.a,{extendedProperties:Fb}));else Wc.a.J(554026500,822,15,"Immersive Reader auth token request in progress. CorrelationId: {0}, Request Status: {1}",Ba,z.status)};Ga=new Date;Wc.a.J(572639119,822,50,"Begin request for ImmersiveReader auth token. StartTime: {0}, CorrelationId: {1}",Ga.getTime(),Ba);ja=new Map;ja.set("CorrelationId",Ba);ja.set("Info","RequestingAuthToken");u.Health.instance.recordKpiUsage("ImmersiveReaderTriggered",1,null,ja);z.send(null)}wkg(z,
T,ja){if(1===ja||6===this.ia.$p){if(!this.QGg)return 8;this.r2c=zd.a("EnableSendingHTMLToIR")?this.Kci():this.kdj();if(""===this.r2c)return 8}2===ja&&this.Eyg();return 32}}Object(h.a)(Hd,"ImmersiveReaderActor",null,[234]);var Fh=d(571),Gh=d(766);class ih{constructor(z){this.customData=null;this.vP=z}}Object(h.a)(ih,"PropertySetChangedState",null,[]);class ah{static eyk(z,T,ja){if(z&&T){var Ba=new ih(T),Ga=(Fb,Rb,tc)=>{ja.dyk(Fb,Rb,tc,Ba)};z=new Gh.a(T,z);z.Rzc=Ga;z.ACc=Ga;z.Jcd=Ga;z.Vda()}}}Object(h.a)(ah,
"PropertySetChangedManager",null,[]);class Fi{constructor(z){this.tRh=z}dyk(z,T,ja,Ba){const Ga=this.tRh[z.id.toString()];Ga&&Ga(z,T,ja,Ba)}}Object(h.a)(Fi,"PropertyChangedProcessor",null,[]);var Wi=d(1054),Mg=d(429),ee=d(58),Lf=d(570),Vf=d(388),fd=d(933);class Ee{constructor(){this.cAe=this.hVc=this.VPc=null}}Object(h.a)(Ee,"ParagraphDialogResults",null,[]);class Yf extends Xb.a{constructor(z,T,ja){super(void 0,void 0,!0);this.cta=null;if(null===z)throw Error.argumentNull("properties");this.Jca=
z.clone();this.y8=z.clone();this.LA=ja;this.ia=T;this.x4j=new Mc.a(Object(v.a)(this,this.byi,"createPropertyChangedHandlers"))}hhd(){this.kg="ParagraphDialog";const z={};z.bodyControls=this.lXd();this.qj(ResourceStrings.L_ParagraphDialogTitle,Object(v.a)(this,this.cRd,"dialogResultHandler"),z)}cRd(z,T){1===z&&(this.Zsl(T),z=Object.assign(new Ee,{VPc:this.Jca,hVc:this.y8,cAe:this.x4j}),this.ia.Ma(Xc.a.COf,2,z));this.dispose()}lXd(){this.cta=Yf.hYd();const z={};this.Upi(z);this.gpi(z);var T=fd.a("Inch",
3,0,56,.1);const ja=fd.a("Character",2,0,56,.1);T=[T,ja];this.wqi(z,T);this.lpi(z,T);T=[fd.a("Point",5,0,1584,1)];this.mpi(z,T);this.fpi(z,T);this.Vpi(z);return z}Zsl(z){this.nql(z);this.Otl(z);this.Aql(z);this.Bql(z);this.lql(z);this.nsl(z)}byi(){const z={};z[ee.a.pD.id.toString()]=Object(v.a)(this.LA,this.LA.JOj,"justificationChangedHandler");z[ee.a.uCb.id.toString()]=Object(v.a)(this.LA,this.LA.H1g,"paraIndentLeftChangedHandler");z[ee.a.vCb.id.toString()]=Object(v.a)(this.LA,this.LA.H1g,"paraIndentLeftChangedHandler");
z[ee.a.wea.id.toString()]=Object(v.a)(this.LA,this.LA.uMe,"specialIndentChangedHandler");z[ee.a.aHb.id.toString()]=Object(v.a)(this.LA,this.LA.uMe,"specialIndentChangedHandler");z[ee.a.bHb.id.toString()]=Object(v.a)(this.LA,this.LA.uMe,"specialIndentChangedHandler");z[ee.a.Iw.id.toString()]=Object(v.a)(this.LA,this.LA.FQj,"lineSpacingChangedHandler");z[ee.a.yCb.id.toString()]=Object(v.a)(this.LA,this.LA.K1g,"paraSpacingAfterChangedHandler");z[ee.a.xCb.id.toString()]=Object(v.a)(this.LA,this.LA.K1g,
"paraSpacingAfterChangedHandler");z[ee.a.BCb.id.toString()]=Object(v.a)(this.LA,this.LA.M1g,"paraSpacingBeforeChangedHandler");z[ee.a.ACb.id.toString()]=Object(v.a)(this.LA,this.LA.M1g,"paraSpacingBeforeChangedHandler");return z}Vpi(z){var T=Yf.c4i(this.Jca),ja="multiple"===T;z.lineSpacingComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,
["options"]:fd.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["selectedKey"]:T,["allowFreeForm"]:!1};T=0;let Ba=!1;this.Jca.Sa(ee.a.Iw)&&ja&&(T=this.Jca.getValue(ee.a.Iw),0<=T&&(Ba=!0));ja=[fd.a("none",0,0,9.99,.5)];ja={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:ja,["numberFormatInfo"]:this.cta,["validReservedValues"]:[""]};ja.value=Ba?T:"";z.atSpinButtonProps=ja}fpi(z,T){const ja=Yf.Y5f(this.Jca,ee.a.yCb,ee.a.xCb);z.afterSpacingSpinButtonProps=Yf.pgd(ja,{["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Lf.a.HVb(5),
["validUnits"]:T,["numberFormatInfo"]:this.cta,["validReservedValues"]:[""]})}mpi(z,T){const ja=Yf.Y5f(this.Jca,ee.a.BCb,ee.a.ACb);z.beforeSpacingSpinButtonProps=Yf.pgd(ja,{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Lf.a.HVb(5),["validUnits"]:T,["numberFormatInfo"]:this.cta,["validReservedValues"]:[""]})}lpi(z,T){let ja,Ba;({Z0g:Ba,
$0g:ja}=Yf.N9f(this.Jca,ee.a.vCb,ee.a.uCb,!1));T={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Lf.a.HVb(ja),["validUnits"]:T,["numberFormatInfo"]:this.cta,["validReservedValues"]:[""]};T=Yf.pgd(Ba,T);z.beforeTextSpinButtonProps=T}wqi(z,T){var ja={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:fd.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["allowFreeForm"]:!1},Ba=this.Jca.Sa(ee.a.wea)?this.Jca.getValue(ee.a.wea):-1;Yf.jwg(Ba)?ja.selectedKey=Ba.toString():ja.defaultSelectedKey="";z.specialIndentationComboBoxProps=ja;({Z0g:ja,$0g:Ba}=Yf.N9f(this.Jca,ee.a.bHb,
ee.a.aHb,1!==Ba&&2!==Ba));T={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Lf.a.HVb(Ba),["validUnits"]:T,["numberFormatInfo"]:this.cta};T=Yf.pgd(ja,T);z.bySpinButtonProps=T}gpi(z){const T={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,
["showLabel"]:!0,["options"]:fd.b([Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified],["1","2","3","6"]),["allowFreeForm"]:!1},ja=this.Jca.Sa(ee.a.pD)?this.Jca.getValue(ee.a.pD):0;Yf.VFj(ja)?T.selectedKey=ja.toString():T.defaultSelectedKey="";z.alignmentComboBoxProps=T}Upi(z){z.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,
["forId"]:"GeneralGroup"};z.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};z.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"}}nsl(z){if(z.lineSpacingComboBoxProps){const T=z.lineSpacingComboBoxProps.selectedKey.toString();let ja=fd.c(T);"multiple"===T&&(z=z.atSpinButtonProps)&&(ja=
parseFloat(z.value.toString()));this.y8.setValue(ee.a.Iw,ja);this.y8.setValue(ee.a.TV,2)}}lql(z){if(z.afterSpacingSpinButtonProps){z=z.afterSpacingSpinButtonProps;var T=Lf.a.GVb(z.unitType.toString().toLowerCase());""!==z.value.toString()&&(T=4===T?2:4,this.y8.setValue(ee.a.yCb,parseInt(z.value.toString())),this.y8.setValue(ee.a.xCb,T))}}Bql(z){if(z.beforeSpacingSpinButtonProps){z=z.beforeSpacingSpinButtonProps;var T=Lf.a.GVb(z.unitType.toString().toLowerCase());""!==z.value.toString()&&(T=4===T?
2:4,this.y8.setValue(ee.a.BCb,parseInt(z.value.toString())),this.y8.setValue(ee.a.ACb,T))}}Aql(z){if(z.beforeTextSpinButtonProps){var T=z.beforeTextSpinButtonProps;z=Lf.a.GVb(T.unitType.toString().toLowerCase());if(""!==T.value.toString()){T=parseFloat(T.value.toString());let ja;2===z?ja=2:(ja=1,T=Lf.a.Vxh(T,z));this.y8.setValue(ee.a.vCb,T);this.y8.setValue(ee.a.uCb,ja)}}}Otl(z){var T=z.bySpinButtonProps,ja=z.didChangeSpecialIndentationComboBoxValue;if(T&&""!==T.value.toString()||ja)if(z.specialIndentationComboBoxProps&&
(z=z.specialIndentationComboBoxProps,ja=-1,z.selectedKey&&(z=z.selectedKey.toString(),ja=parseInt(z)),Yf.jwg(ja)&&this.y8.setValue(ee.a.wea,ja)),T){z=parseFloat(T.value.toString());T=Lf.a.GVb(T.unitType.toString().toLowerCase());if(0>z||isNaN(z))z=0;2===T?ja=2:(ja=1,z=Lf.a.Vxh(z,T));this.y8.setValue(ee.a.bHb,z);this.y8.setValue(ee.a.aHb,ja)}}nql(z){z.alignmentComboBoxProps&&(z=z.alignmentComboBoxProps,z.selectedKey&&(z=parseInt(z.selectedKey.toString()),0<=z&&this.y8.setValue(ee.a.pD,z)))}static Y5f(z,
T,ja){if(z.Sa(T)&&z.Sa(ja)){ja=z.getValue(ja);if(2!==ja&&4!==ja)return Number.NaN;z=z.getValue(T);2===ja&&(z*=Yf.ctk);return z}return Number.NaN}static pgd(z,T){T.value=isNaN(z)?"":z;return T}static hYd(){return{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}static N9f(z,T,ja,Ba){let Ga=3;z.Sa(T)&&z.Sa(ja)&&!Ba?(T=z.getValue(T),2===z.getValue(ja)?Ga=2:T=Lf.a.vwl(T,Ga)):T=Number.NaN;return{Z0g:T,
$0g:Ga}}static VFj(z){return 1===z||2===z||3===z||6===z}static jwg(z){return 1===z||2===z||0===z}static c4i(z){if(Yf.Ioj(z)){z=z.getValue(ee.a.Iw);var T="multiple";Vf.a.ry(z,1)?T="1.00":Vf.a.ry(z,1.5)?T="1.50":Vf.a.ry(z,2)&&(T="2.00");return T}}static Ioj(z){return z.Sa(ee.a.Iw)&&z.Sa(ee.a.TV)&&2===z.getValue(ee.a.TV)?!0:!1}}Yf.ctk=72;Object(h.a)(Yf,"ReactParagraphDialog",Xb.a,[]);class ij{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd){this.mfe=[];this.ia=z;this.sa=T;this.Uca=ja;this.C8=Ba;this.Jb=Ga;
this.Zh=Fb;this.nFa=Rb;this.Fa=tc;this.LA=Ac;this.Rca=kd;this.aPg=nd}wb(){this.ia.ra(Xc.a.kbe,ed.a.application,Object(v.a)(this,this.Apk,"paragraphDialogHandler"),4);this.ia.ra(Xc.a.COf,ed.a.application,Object(v.a)(this,this.doi,"commitParagraphDialogHandler"),4);this.ia.ra(Xc.a.n7g,ed.a.view,Mg.a.J_,96);this.ia.ra(Xc.a.X6g,ed.a.view,Mg.a.J_,96);this.ia.ra(Xc.a.I7g,ed.a.view,Mg.a.J_,96);this.ia.ra(Xc.a.J7g,ed.a.view,Mg.a.J_,96);this.ia.ra(Xc.a.H7g,ed.a.view,Mg.a.J_,96);this.ia.ra(Xc.a.G7g,ed.a.view,
Mg.a.J_,96);this.ia.ra(Xc.a.h7g,ed.a.view,Mg.a.J_,96);this.ia.ra(Xc.a.i7g,ed.a.view,Mg.a.J_,96);this.ia.ya(Xc.a.L0g,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.Qqh,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.Kkg,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.Tqh,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.Sqh,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.O0g,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.P0g,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.I0g,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.Rqh,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.H0g,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.R0g,
ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.Q0g,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.Uqh,ed.a.view,Mg.a.oG);this.ia.ya(Xc.a.vad,ed.a.paragraph,Object(v.a)(this,this.s8i,"getPropertiesForParagraphDialog"));this.ia.ya(Xc.a.vad,ed.a.view,this.Rca);this.ia.$d(Xc.a.vad,96)}Fe(){}Apk(z,T,ja){if(this.sa.hu()||this.sa.E7())return 16;z=this.sa.he();if(!this.Fa.eZ(z,!0).length&&!this.sa.Uia())return 16;if(1===ja)return 32;this.aPg&&Wc.a.J(25040911,820,50,"Setting Paragraph properties from: {0}, IsDialogLancherButton: {1}",
this.ia.$p,"PptRibbon.Home"===this.ia.Spa);Array.clear(this.mfe);this.ia.processAction(Xc.a.vad,2);return(ja=Fh.APropertySet.i3i(this.mfe))?((new Yf(ja,this.ia,this.LA)).hhd(),32):16}doi(z,T,ja,Ba,Ga){if(1===ja)return 32;if(!(Ga&&Ga.VPc&&Ga.hVc&&Ga.cAe))return 16;T=this.sa.ny();this.LA.Ltj();ja=this.Jb.ie(15);try{ja.lc(T),ja.fd=z,Ga.VPc.equals(Ga.hVc)||this.Hmi(),ah.eyk(Ga.VPc,Ga.hVc,new Fi(Ga.cAe.value))}finally{ja&&ja.dispose()}if(this.aPg){let Fb;({uEh:z,vEh:Ga,xEh:T,wEh:ja,tEh:Ba,yEh:Fb}=this.LA.eil());
Wc.a.J(25040909,820,50,"IsJustificationChanged: {0}, IsLnSpacChanged: {1}, IsSpaceBeforeChanged: {2}, IsSpaceAfterChanged: {3}, IsIndentLeftChanged: {4}, IsSpecialIndentChanged: {5}",z,Ga,T,ja,Ba,Fb)}Od.a.uO(!0,!0);return 32}s8i(z,T,ja){if(1===ja)return 32;T=T.node;z=new Wi.DictionaryPropertySet;z.setValue(ee.a.pD,this.Zh.XM(T));ja=this.Uca.XPa(T);z.setValue(ee.a.TV,ja.Of);z.setValue(ee.a.Iw,ja.value);ja=this.Uca.qV(T);z.setValue(ee.a.ACb,ja.beforeSpacing.Of);z.setValue(ee.a.BCb,ja.beforeSpacing.value);
z.setValue(ee.a.xCb,ja.afterSpacing.Of);z.setValue(ee.a.yCb,ja.afterSpacing.value);ja=this.C8.d7(T);z.setValue(ee.a.uCb,1);z.setValue(ee.a.vCb,ja.aM);T=this.nFa.hQa(T);z.setValue(ee.a.wea,T.specialIndentType);z.setValue(ee.a.aHb,T.Of);z.setValue(ee.a.bHb,T.value);this.mfe.push(z);return 32}Hmi(){if(this.sa.rG()){var z=this.sa.he();z=this.Fa.eZ(z);for(const T of z)T.Tqa()}}}Object(h.a)(ij,"ParagraphDialogActor",null,[234]);var Md;(function(z){z[z.unspecified=-1]="unspecified";z[z.none=0]="none";z[z.left=
1]="left";z[z.center=2]="center";z[z.right=3]="right";z[z.inner=4]="inner";z[z.outer=5]="outer";z[z.both=6]="both";z[z.distribute=7]="distribute";z[z.margin=8]="margin";z[z.highKashida=9]="highKashida";z[z.lowKashida=10]="lowKashida";z[z.mediumKashida=11]="mediumKashida";z[z.numTab=12]="numTab";z[z.thaiDistribute=13]="thaiDistribute";z[z.start=14]="start";z[z.end=15]="end"})(Md||(Md={}));Object(h.b)("Justification",Md);var pj=d(567);class qj{constructor(){this.value=this.Of=0}}Object(h.a)(qj,"ParagraphSpacingCommandData",
null,[]);class jj{constructor(){this.Mqh=this.I1g=this.L1g=this.N1g=!1}}Object(h.a)(jj,"PptPropertySetChangedState",null,[]);class Ag{constructor(z){this.L$d=this.T8d=this.J$d=this.K$d=this.g9d=this.$8d=!1;this.U8b={};this.ia=z;this.Qtj()}JOj(z,T,ja){ja&&(z=this.U8b[Md[ja]],void 0!==z&&null!==z&&(this.ia.processAction(z,2),this.$8d=!0))}FQj(z,T,ja){void 0!==ja&&null!==ja&&(this.ia.Ma(Xc.a.Ola,2,ja),this.g9d=!0)}M1g(z,T,ja,Ba){void 0!==ja&&null!==ja&&(z=Ag.vKc(Ba),!z.N1g&&null!==Ba&&Ba.vP.Sa(ee.a.ACb)&&
Ba.vP.Sa(ee.a.BCb)&&(T=Ba.vP.getValue(ee.a.BCb),Ba=Ba.vP.getValue(ee.a.ACb),z.N1g=!0,this.ia.Ma(Xc.a.xfb,2,Object.assign(new qj,{value:T,Of:Ba})),this.K$d=!0))}K1g(z,T,ja,Ba){void 0!==ja&&null!==ja&&(z=Ag.vKc(Ba),!z.L1g&&null!==Ba&&Ba.vP.Sa(ee.a.xCb)&&Ba.vP.Sa(ee.a.yCb)&&(T=Ba.vP.getValue(ee.a.yCb),Ba=Ba.vP.getValue(ee.a.xCb),z.L1g=!0,this.ia.Ma(Xc.a.wfb,2,Object.assign(new qj,{value:T,Of:Ba})),this.J$d=!0))}H1g(z,T,ja,Ba){void 0!==ja&&null!==ja&&(T=Ag.vKc(Ba),!T.I1g&&null!==Ba&&Ba.vP.Sa(ee.a.uCb)&&
Ba.vP.Sa(ee.a.vCb)&&(z=Ba.vP.getValue(ee.a.vCb),Ba=Ba.vP.getValue(ee.a.uCb),T.I1g=!0,T=new pj.a,T.Of=Ba,T.value=z,this.ia.Ma(Xc.a.tia,2,T),this.T8d=!0))}uMe(z,T,ja,Ba){void 0!==ja&&null!==ja&&(ja=Ag.vKc(Ba),!ja.Mqh&&null!==Ba&&Ba.vP.Sa(ee.a.aHb)&&Ba.vP.Sa(ee.a.bHb)&&(T=0,Ba.vP.Sa(ee.a.wea)&&(T=Ba.vP.getValue(ee.a.wea)),z=Ba.vP.getValue(ee.a.bHb),Ba=Ba.vP.getValue(ee.a.aHb),ja.Mqh=!0,ja=0,1===T?ja=Xc.a.$Fb:2===T?ja=Xc.a.bGb:0===T&&(ja=Xc.a.dGb),T=new pj.a,T.Of=Ba,T.value=z,this.ia.Ma(ja,2,T),this.L$d=
!0))}eil(){return{uEh:this.$8d,vEh:this.g9d,xEh:this.K$d,wEh:this.J$d,tEh:this.T8d,yEh:this.L$d}}Ltj(){this.L$d=this.T8d=this.J$d=this.K$d=this.g9d=this.$8d=!1}Qtj(){this.U8b.left=dd.a.leftJustify;this.U8b.center=dd.a.centerJustify;this.U8b.right=dd.a.rightJustify;this.U8b.both=dd.a.fullJustify}static vKc(z){z.customData||(z.customData=new jj);return z.customData}}Object(h.a)(Ag,"ParagraphLevelPropertyChangedHandlers",null,[816]);var mf=d(523),Ia=d(197),tb=d(267),Qb=d(334),qc=d(36),Lc=d(49),Jd=d(81),
le=d(166);class je{constructor(z,T){this.vqb=z;this.Gh=T}}Object(h.a)(je,"DoNotCheckCritiqueTypeActionData",null,[]);var Gf=d(22);class Wf{u3a(z){return(z=Object(A.a)(je,z))?Object(Gf.a)(Qb.a,z.Gh):!1}Vve(z,T){if(T=Object(A.a)(je,T)){const ja=T.Gh;ja&&(ja.eJa(z,T.vqb),e.ULS.sendTraceTag(37855319,375,50,"Don't check this critique for whole doc finished, removed errors count: {0}",T.vqb))}}}Object(h.a)(Wf,"DoNotCheckCritiqueTypeCallback",null,[879]);var fh=d(460),zh=d(48);class Qg extends fh.a{constructor(z,
T,ja,Ba,Ga,Fb,Rb){super();this.kqe=null;this.init(z);this.vl("WholePresentationOperation");this.ACa(E.AFrameworkApplication.Va,T,ja,Ba,Ga);this.sab=0;this.lQg=Rb;this.WFg=Fb;this.fwb=Ga;this.V5b=T;this.u3a()?1===this.behavior&&(this.Zo=32,this.sX()):(this.Zo=8,this.sX())}run(){0===this.sab&&this.qJe();1===this.sab&&this.Mze();2===this.sab&&this.vOe();3===this.sab&&this.pVd()}u3a(){return this.lQg.u3a(this.fwb)}Vve(){this.lQg.Vve(this.V5b,this.fwb)}qJe(){this.kqe=new zh.GraphTransaction(3);this.kqe.lc(this.WFg.node);
this.sab=1}Mze(){this.nz||this.efb(this.WFg.HD);1!==this.Wla()&&(this.sab=2)}vOe(){this.Vve();this.kqe.dispose();this.sab=3}pVd(){this.sX()}}Object(h.a)(Qg,"WholePresentationOperation",fh.a,[]);var Rg=d(53);class wi{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd){this.tCa=!1;this.ia=z;this.dBg=T;this.AD=ja;this.Jb=Ba;this.iXc=Ga;this.ua=Fb;this.Fa=Rb;this.B3=nd;this.ele=tc;this.VB=Ac;this.ob=Bd;this.D5j=kd.cmh;this.n1j=kd.pptProofingRemoveWholeDocTargetCritiquesEnabled;this.z0j=kd.pptHideProofingErrorIsEnabled;
this.vvj()}get uWb(){return this.AD.IRa?this.iXc.instance:null}wb(){this.ia.ra(Xc.a.Pfc,Rg.a.application,Object(v.a)(this,this.Pfc,"queryLanguage"),96);this.ia.ra(Xc.a.M0g,Rg.a.application,Object(v.a)(this,this.Znk,"openPPTLanguageDialogView"),4);this.AD.Vsg&&this.ia.ra(dd.a.BPc,ed.a.Ff,Object(v.a)(this,this.BPc,"ignoreProofingError"),4);this.AD.a8d&&(this.n1j?(this.ia.ya(dd.a.rXb,ed.a.paragraph,Object(v.a)(this,this.MWf,"doNotCheckThisCritiqueTypeForNode")),this.ia.ya(dd.a.rXb,ed.a.section,Object(v.a)(this,
this.MWf,"doNotCheckThisCritiqueTypeForNode")),this.ia.KU(dd.a.rXb,ed.a.Ff,Object(v.a)(this,this.fGi,"doNotCheckThisCritiqueTypeForWholeDoc"),4),this.ia.ra(Xc.a.sXb,ed.a.Ff,Object(v.a)(this,this.sXb,"doNotCheckThisCritiqueTypeForCurrentSlide"),4)):this.ia.ra(dd.a.rXb,ed.a.Ff,Object(v.a)(this,this.sXb,"doNotCheckThisCritiqueTypeForCurrentSlide"),4));this.z0j&&(this.ia.ra(Xc.a.vAe,Rg.a.application,Object(v.a)(this,this.vAe,"queryHideProofingErrors"),100),this.ia.ra(Xc.a.hqj,Rg.a.application,Object(v.a)(this,
this.ekl,"toggleHideProofingErrors"),4))}Fe(){}vvj(){this.tCa=wi.U3d;e.ULS.sendTraceTag(37237070,375,50,"Initialized with hide proofing errors: {0}",this.tCa);this.tCa&&this.fjg(this.tCa)}vAe(z,T,ja,Ba,Ga){if(1===ja)return 32;if(!Ga)return 8;Ga[mf.a.On]=this.tCa;return 32}ekl(z,T,ja,Ba,Ga){if(1===ja)return 32;if(!(Ga&&mf.a.On in Ga))return 8;this.tCa=Ga[mf.a.On];wi.U3d=this.tCa;this.fjg(this.tCa);e.ULS.sendTraceTag(37237071,375,50,"User hide proofing errors: {0}",this.tCa);return 32}MWf(z,T,ja,Ba,
Ga){if(!T)return 8;z=T.node;if(!z)return 8;if(T.contextId===ed.a.section&&!z.ta(le.a.bsg,!1))return 32;if(T.contextId===ed.a.paragraph&&z.ta(le.a.$ba,!1)){T=Object(A.a)(je,Ga);if(!T)return 8;Ga=T.Gh;if(!Ga)return 8;T.vqb+=this.ebh(z,Ga.typeId,Ga.lcid)}return 2}fGi(z,T,ja,Ba,Ga){var Fb=this.NZi();Fb=new je(0,Fb);this.ia.li(ja,Xc.a.sXb,Ba,!1,Ga,Fb);ja=Lc.a.create(Object(A.a)(Jd.a,this.ua.presentation));e.ULS.sendTraceTag(37012126,375,50,"User click do not check this critique for whole doc with behavior: {0}",
Ba);return new Qg(z,T,Ba,Ga,Fb,ja,new Wf)}sXb(z,T,ja,Ba,Ga){z=Object(A.a)(je,Ga);if(!z)return 8;Ba=z.Gh;if(!Ba)return 8;if(1===ja)return 32;if(!T.node)return 8;e.ULS.sendTraceTag(36790874,375,50,"Don't check this critique triggerred, language id: {0}, critique type id: {1}",Ba.lcid,Ba.typeId);z.vqb+=this.PLk(Ba.typeId,Ba.lcid);this.uWb&&this.uWb.QEi(Ba.lcid.toString(),Ba.typeId);return 32}BPc(z,T,ja){if(1===ja)return 32;e.ULS.sendTraceTag(36790875,375,50,"Ignore proofing error triggerred");ja=this.VB.IPa(T);
if(!ja||!ja.Gh)return 8;T=T.node;var Ba=this.ua.Ca;if(!T||!Ba)return 8;Ba=this.Jb.ie(wi.dej(ja));try{Ba.lc(T),this.VB.vHa(T,[ja],!0),T.setValue(qc.a.kPf,!0)}finally{Ba&&Ba.dispose()}ja.Gh.eJa(z,1);this.ob.RRa()||Od.a.uO(!0,!1);e.ULS.sendTraceTag(36790876,375,50,"Ignore proofing error action succeeded");return 32}fjg(z){this.B3.gKe=z}NZi(){var z=this.ob.Pa.kb;if(!z)return null;z=this.VB.IPa(z.Wa);if(!z||!z.Gh)return null;z=Object(A.a)(Qb.a,z.Gh);return!z||0>=z.lcid?null:z}PLk(z,T){const ja=new Date;
if(!this.ua.Ca)return 0;const Ba=this.ua.Ca.km();if(!Ba)return 0;let Ga=0,Fb=0;const Rb=this.Jb.ie(3);try{Rb.lc(this.ua.Ca);for(const tc of Ba)this.Fa.RI(tc,Ac=>{++Fb;Ac.Sa(qc.a.Vp)&&Ac.ta(le.a.$ba,!1)&&(Ga+=this.ebh(Ac,z,T))})}finally{Rb&&Rb.dispose()}e.ULS.sendTraceTag(36825112,375,50,"Remove proofing error take time(ms): {0}, scanned paragraph count: {1}, scanned shape count: {2}, removed errors count: {3}",+new Date-+ja,Fb,Ba.length,Ga);return Ga}ebh(z,T,ja){const Ba=this.VB.ME(z,Ga=>{Ga=Object(A.a)(Qb.a,
Ga.Gh);return!!Ga&&Ga.typeId===T&&Ga.lcid===ja});if(Ia.a.Xa(Ba))return 0;this.VB.vHa(z,Ba);return Ba.length}Pfc(z,T,ja,Ba,Ga){Ga.vBc=this.G3i();return 32}G3i(){let z=E.AFrameworkApplication.lcid;if(this.ob.vZ(this.ob.Pa)){var T=this.ob.he();if(1<T.length||1!==T.length)return"";T=this.Fa.OPa(T[0]);0<T&&(z=T)}else this.ob.Pa.kb&&(T=this.ele.WLc(this.ob.Dj),0<T&&(z=T));return tb.a.re(z)?tb.a.re(z).displayName:tb.a.re(E.AFrameworkApplication.lcid).displayName}UKj(){const z=this.ob.he();return 1===z.length&&
z[0].cTc}Znk(z,T,ja){if(2!==ja)return 32;this.D5j&&this.ob.vZ(this.ob.Pa)&&this.UKj()?(e.ULS.sendTraceTag(8955537,806,50,"Set proofing language on shape level."),this.dBg.value.getInstance(!0).skc()):this.ob.Pa.kb&&(e.ULS.sendTraceTag(8955536,806,50,"Set proofing language in text edit view."),this.dBg.value.getInstance(!1).skc());return 32}static get U3d(){const z=qa.a.get("PowerPointHideProofingErrors");return z?"true"===z.toLowerCase():!1}static set U3d(z){qa.a.LL("PowerPointHideProofingErrors",
z.toString(),30)||e.ULS.sendTraceTag(37237069,375,10,"Failed to set cookie for hide proofing errors to {0}",z.toString())}static dej(z){return 1===z.Gh.proofingType?15:3}}Object(h.a)(wi,"ProofingActor",null,[234]);var Ng=d(289),Fj=d(770);class Hh{constructor(z,T){this.Ye=z.toLowerCase();this.variant=T}}Object(h.a)(Hh,"ThemeVariant",null,[]);var gg=d(37);class Og{constructor(z,T,ja){this.pUd=z;this.Eyh=T;this.zTe=ja}}Object(h.a)(Og,"ThemeData",null,[]);class vg{}vg.DIa=[new Og("62f939b6-93af-4db8-9c6b-d6c7dfdc589f",
"OfficeTheme",4),new Og("b8441adb-2e43-4af7-b97a-bd870242c6a8","Ion",4),new Og("28cdc826-8792-45c0-861b-85eb3adeda33","Organic",4),new Og("f226e7a2-7162-461c-9490-d27d9dc04e43","Frame",4),new Og("fc33163d-4339-46b1-8eed-24c834239d99","IonBoardroom",4),new Og("789ec3fe-34fd-429c-9918-760025e6c145","Mesh",4),new Og("5f128b03-dcca-4eeb-ab3b-cf2899314a46","Retrospect",8),new Og("0507925b-6ac9-4358-8e18-c330545d08f8","Slice",4),new Og("1306e473-ed32-493b-a2d0-240a757edd34","Savon",4),new Og("98dff888-2449-4d28-977c-6306c017633e",
"Banded",4),new Og("39ec5628-30ed-4578-acd8-9820edb8e15a","Quotable",4),new Og("7acabc62-bf99-48cf-a9dc-4db89c7b13dc","WoodType",4),new Og("5665723a-49ba-4b57-8411-a56f8f207965","Basis",4),new Og("3577f8c9-a904-41d8-97d2-fd898f53f20e","Integral",8),new Og("7cb32d59-10c0-40dd-b7bd-2e94284a981c","Wisp",4),new Og("9697a71b-4ab7-4a1a-bd5b-bb2d22835b57","Dividend",4),new Og("c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5","Celestial",4),new Og("3388167b-a2eb-4685-9635-1831d9aef8c4","Parallax",4),new Og("4c5440d6-04d2-4954-96cf-f251137069b2",
"Metropolitan",8),new Og("c0c680cd-088a-49fc-a102-d699147f32b2","Facet",4),new Og("ba0eb5a6-f2d4-4f82-977b-64adee4a2a69","View",4),new Og("5156b0e4-0eb1-49fe-a26b-15f6f698aec6","Atlas",4),new Og("025cb5fb-2dd3-45ee-b6f0-cc461540eb19","Madison",4)];Object(h.a)(vg,"DesignManager_data",null,[]);class Sg{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd){this.PXc=null;this.QXc=0;this.MEg=this.OXc=!1;this.qJg=null;this.WTb=new Hh("",0);this.nPg={["ThemesOfficeTheme"]:"62f939b6-93af-4db8-9c6b-d6c7dfdc589f",
["ThemesIon"]:"b8441adb-2e43-4af7-b97a-bd870242c6a8",["ThemesAtlas"]:"5156b0e4-0eb1-49fe-a26b-15f6f698aec6",["ThemesMadison"]:"025cb5fb-2dd3-45ee-b6f0-cc461540eb19",["ThemesOrganic"]:"28cdc826-8792-45c0-861b-85eb3adeda33",["ThemesFrame"]:"f226e7a2-7162-461c-9490-d27d9dc04e43",["ThemesIonBoardroom"]:"fc33163d-4339-46b1-8eed-24c834239d99",["ThemesMesh"]:"789ec3fe-34fd-429c-9918-760025e6c145",["ThemesRetrospect"]:"5f128b03-dcca-4eeb-ab3b-cf2899314a46",["ThemesSlice"]:"0507925b-6ac9-4358-8e18-c330545d08f8",
["ThemesSavon"]:"1306e473-ed32-493b-a2d0-240a757edd34",["ThemesBanded"]:"98dff888-2449-4d28-977c-6306c017633e",["ThemesQuotable"]:"39ec5628-30ed-4578-acd8-9820edb8e15a",["ThemesWoodType"]:"7acabc62-bf99-48cf-a9dc-4db89c7b13dc",["ThemesBasis"]:"5665723a-49ba-4b57-8411-a56f8f207965",["ThemesIntegral"]:"3577f8c9-a904-41d8-97d2-fd898f53f20e",["ThemesWisp"]:"7cb32d59-10c0-40dd-b7bd-2e94284a981c",["ThemesDividend"]:"9697a71b-4ab7-4a1a-bd5b-bb2d22835b57",["ThemesCelestial"]:"c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",
["ThemesParallax"]:"3388167b-a2eb-4685-9635-1831d9aef8c4",["ThemesMetropolitan"]:"4c5440d6-04d2-4954-96cf-f251137069b2",["ThemesFacet"]:"c0c680cd-088a-49fc-a102-d699147f32b2",["ThemesViewTheme"]:"ba0eb5a6-f2d4-4f82-977b-64adee4a2a69"};this.ia=z;this.Ga=T;this.Zb=ja;this.sa=Ga;this.Jb=Ba;this.Qd=Fb;this.Wb=Rb;this.ua=tc;this.qc=Ac;this.j7j=kd;this.N0j=nd;this.iHg=Bd}wb(){this.ia.ra(Xc.a.r3a,Rg.a.application,Object(v.a)(this,this.zhg,"handleThemeChange"),4);this.ia.ra(Xc.a.uNa,Rg.a.application,Object(v.a)(this,
this.zhg,"handleThemeChange"),4);this.ia.ra(Xc.a.qad,Rg.a.application,Object(v.a)(this,this.qad,"queryMoreThemeGallery"),96);this.ia.ra(Xc.a.HAe,Rg.a.application,Object(v.a)(this,this.HAe,"queryMoreVariantGallery"),96);this.ia.ra(Xc.a.gbd,Rg.a.application,Object(v.a)(this,this.gbd,"queryThemes"),97);this.ia.ra(Xc.a.fbd,Rg.a.application,Object(v.a)(this,this.fbd,"queryThemeVariants"),97);this.ia.ra(Xc.a.gye,Rg.a.application,Object(v.a)(this,this.gye,"populateVariantGallery"),96)}Fe(){}gbd(z,T,ja,Ba,
Ga){Ga&&Ga.OT&&(z=this.nPg[Ga.OT]===this.KBa().Ye,Ga.tWa.Yf(z));return 32}fbd(z,T,ja,Ba,Ga){if(Ga&&Ga.OT){z=this.KBa();T=z.Ye;ja=Ga.OT;try{var Fb=Number.parseInvariant(ja.substring(ja.length-1,ja.length))}catch(Rb){Fb=0}Ga=Ga.tWa;Ga.Yf(z.variant===Fb);Fb=Sg.m5f(ja,Fb,T);Ga.T6=Fb}return 32}qad(z,T,ja){if(T.contextId!==ed.a.application)return 2;z=this.sa.ny();var Ba=this.KBa();T=Sg.A0b(Ba.Ye);Ba=Ba.variant-1;return this.Zb.gd(z)?16:1!==ja||(e.ULS.sendTraceTag(24646592,801,50,"ThemeActor.QueryMoreThemeGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",
T,Ba),this.qc.wj())?32:8}HAe(z,T,ja){if(T.contextId!==ed.a.application)return 2;var Ba=this.sa.ny();T=this.KBa();z=Sg.A0b(T.Ye);T=T.variant-1;if(this.Zb.gd(Ba))return 16;if(1===ja)if(ja=Sg.G0b(this.KBa().Ye),Ba=this.j7j.TNj(ja),ja&&Ba)e.ULS.sendTraceTag(24924386,801,50,"ThemeActor.QueryMoreVariantGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",z,T);else return 16;return 32}zhg(z,T,ja,Ba,Ga){T=this.sa.rf();Ba=this.ua.Ca;if(!Ba||z===Xc.a.uNa&&this.KBa()===this.WTb||this.Zb.gd(Ba))return 16;
if(1===ja)return 32;ja=Object(A.a)(String,Ga);if(null===ja)return 8;Ga=this.nPg[ja];return z===Xc.a.r3a?this.hsk(Ba,Ga,T):z===Xc.a.uNa?this.isk(Ba,ja):8}hsk(z,T,ja){if(!z)return 16;1>=this.uQf()||this.iHg&&ja&&1<ja.length?(this.eId(z,T,0,!1,ja),e.ULS.sendTraceTag(24646593,801,50,"ThemeActor.PerformChangeTheme: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Sg.A0b(T),0,z.Cb.sid)):(this.PXc=T,this.QXc=0,this.OXc=!1,z=new Jc.StandardDialog,z.vd=1,z.nO(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,
Object(v.a)(this,this.vLf,"changeThemeHandler")));return 32}isk(z,T){if(!z)return 16;const ja=this.KBa();let Ba;try{if(Ba=Number.parseInvariant(T.substring(7,T.length))-1,0>Ba||Ba>Sg.G0b(ja.Ye))Ba=-1}catch(Ga){Ba=-1}1>=this.uQf()?(this.eId(z,ja.Ye,Ba,!0,null),e.ULS.sendTraceTag(24646594,801,50,"ThemeActor.PerformChangeVariant: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Sg.A0b(ja.Ye),Ba,z.Cb.sid)):(this.PXc=ja.Ye,this.QXc=Ba,this.OXc=!0,z=new Jc.StandardDialog,z.vd=1,z.nO(ResourceStrings.l_GenericDialogTitle,
ResourceStrings.l_MultipleMainMastersMessage,Object(v.a)(this,this.vLf,"changeThemeHandler")));return 32}KBa(){let z=null;var T=this.ua.Ca;if(T){T=T.vj;const Ba=this.qc.QH();if(Ba&&T)for(var ja of Ba)if(ja.Id===T){z=ja;break}}if(!z)return this.MEg?this.qJg:this.WTb;if(!z.ThemeFamilyId||z.ThemeFamilyId===Sg.nfi)return this.WTb;ja="5156b0e4-0eb1-49fe-a26b-15f6f698aec6"===z.ThemeFamilyId||"025cb5fb-2dd3-45ee-b6f0-cc461540eb19"===z.ThemeFamilyId;return!this.N0j&&ja?this.WTb:new Hh(z.ThemeFamilyId,z.VariantIndex+
1)}uQf(){const z=this.qc.QH();let T=0;if(z)for(const ja of z)ja.InContent&&(T+=1);return T}vLf(z){const T=this.ua.Ca;if(T){var ja=this.PXc,Ba=this.QXc,Ga=this.OXc;this.PXc=null;this.QXc=-1;this.OXc=!1;1===z&&(this.eId(T,ja,Ba,Ga,null),e.ULS.sendTraceTag(24646595,801,50,"ThemeActor.ChangeThemeHandler: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Sg.A0b(ja),Ba,T.Cb.sid))}}eId(z,T,ja,Ba,Ga){this.qJg=(this.MEg=Ba)?new Hh(T,0):this.WTb;const Fb=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()},
void 0,!0);try{if(Fb.lc(z),Fb.fd=Ba?Xc.a.uNa:Xc.a.r3a,this.iHg&&Ga)for(const Rb of Ga)Rb.setValue(gg.a.jPe,T),Rb.setValue(gg.a.r$,ja),Rb.setValue(gg.a.r8h,1<Ga.length);else z.setValue(gg.a.jPe,T),z.setValue(gg.a.r$,ja)}finally{Fb&&Fb.dispose()}this.Zb.DTb(this.Wb.Bf,z,"ChangeTheme")}gye(z,T,ja,Ba,Ga){if(1===ja)return 32;z=Math.max(Sg.G0b(this.KBa().Ye),4);T=this.KBa().Ye;Ga.MenuItems=Sg.R8i(z,T);return 32}static G0b(z){for(let T=0;T<vg.DIa.length;++T)if(vg.DIa[T].pUd===z)return vg.DIa[T].zTe;return 0}static A0b(z){for(let T=
0;T<vg.DIa.length;++T)if(vg.DIa[T].pUd===z)return vg.DIa[T].Eyh;return Sg.Kfi}static YNi(z){let T="";for(let ja=0;ja<vg.DIa.length;++ja)vg.DIa[ja].pUd===z&&(T=vg.DIa[ja].Eyh.replace(" ",""));return T}static R8i(z,T){const ja=Object.assign(new cg.a,{Id:"PptRibbon.Design.ThemeVariants.Anchor.Menu",MenuSectionList:[]});var Ba=Object.assign(new Ng.a,{Id:"PptRibbon.Design.ThemeVariants.MenuSection",DisplayMode:"Size85by48",ControlList:[]});Array.add(ja.MenuSectionList,Ba);const Ga=Object.assign(new Fj.a,
{Id:"PptRibbon.Design.ThemeVariants.Gallery",ExternalId:"MoreVariantsSection",ExternalGalleryId:"MoreVariantsGallery",Type:4,Width:4,ElementDimensions:"Size85by48",GalleryItems:[]});Array.add(Ba.ControlList,Ga);for(Ba=1;Ba<=z;++Ba)Array.add(Ga.GalleryItems,Sg.m5f("Variant"+Ba,Ba,T));return ja}static m5f(z,T,ja){ja=!Sg.G0b(ja)||T>Sg.G0b(ja)?"EmptyVariantsGallery_85x48x8":String.format("ThemeVariantGallery{0}{1}_85x48x24",Sg.YNi(ja),T);return Object.assign(new hj.a,{Id:z,ExternalId:z,Icon:ja,Alt:String.format(ResourceStrings.L_ThemeVariantAlt,
T),PreviewIconStyle:{root:{width:"49px",height:"28px",margin:"-2px"}},FullIconStyle:{root:{width:"85px",height:"48px"}},Command:"2759977169",QueryCommand:"1425701611"})}}Sg.nfi="00000000-0000-0000-0000-000000000000";Sg.Kfi="Unsupported Theme";Sg.X2g="pegal-mlr.png";Object(h.a)(Sg,"ThemeActor",null,[234]);var wh=d(468);class ci{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd){this.ia=z;this.Wb=T;this.ua=ja;this.sa=Ga;this.Ga=Fb;this.Jb=Ba;this.Lm=Rb;this.Zb=tc;this.nIg=Ac.XHj;this.Op=Ac.vz;this.c1j=Ac.aJj;
this.W0c=kd.rk(li.a.oxe);this.Pb=nd}wb(){this.c1j?(this.nIg?(this.ia.ra(Xc.a.nwa,ed.a.application,Object(v.a)(this,this.W2k,"setSlidesTransitionGalleryExceptExisting"),5),this.ia.ra(Xc.a.Xda,ed.a.application,Object(v.a)(this,this.QAk,"querySlidesTransitionGalleryExceptExisting"),97),this.ia.ra(Xc.a.owa,ed.a.application,Object(v.a)(this,this.X2k,"setSlidesTransitionGalleryExisting"),5),this.ia.ra(Xc.a.kIa,ed.a.application,Object(v.a)(this,this.Y2k,"setSlidesTransitionGalleryExistingInMenu"),5),this.ia.ra(Xc.a.Fva,
ed.a.application,Object(v.a)(this,this.RAk,"querySlidesTransitionGalleryExisting"),97),this.ia.ra(Xc.a.kHa,ed.a.application,Object(v.a)(this,this.SAk,"querySlidesTransitionGalleryExistingInMenu"),97)):(this.ia.ra(Xc.a.nwa,ed.a.application,Object(v.a)(this,this.HIe,"setSlidesTransitionGallery"),5),this.ia.ra(Xc.a.Xda,ed.a.application,Object(v.a)(this,this.aBe,"querySlidesTransitionGallery"),97),this.ia.ra(Xc.a.owa,ed.a.application,Object(v.a)(this,this.HIe,"setSlidesTransitionGallery"),5),this.ia.ra(Xc.a.kIa,
ed.a.application,Object(v.a)(this,this.HIe,"setSlidesTransitionGallery"),5),this.ia.ra(Xc.a.Fva,ed.a.application,Object(v.a)(this,this.aBe,"querySlidesTransitionGallery"),97),this.ia.ra(Xc.a.kHa,ed.a.application,Object(v.a)(this,this.aBe,"querySlidesTransitionGallery"),97)),this.ia.ra(Xc.a.SIe,ed.a.application,Object(v.a)(this,this.V2k,"setSlidesTransitionEffectOption"),5),this.ia.ra(Xc.a.nBe,ed.a.application,Object(v.a)(this,this.OAk,"querySlidesTransitionEffectOption"),97),this.ia.ra(Xc.a.ODb,ed.a.application,
Object(v.a)(this,this.PAk,"querySlidesTransitionEffectOptionsAnchor"),100),this.ia.ra(Xc.a.Gec,ed.a.application,Object(v.a)(this,this.guk,"populateSlidesTransitionEffectOptions"),96),this.ia.ra(Xc.a.jHa,ed.a.application,Object(v.a)(this,this.NAk,"querySlidesTransitionDuration"),97),this.ia.ra(Xc.a.kGb,ed.a.application,Object(v.a)(this,this.U2k,"setSlidesTransitionDuration"),5)):(this.nIg?(this.ia.ra(Xc.a.nwa,ed.a.application,Object(v.a)(this,this.P3k,"setTransitionGalleryExceptExisting"),5),this.ia.ra(Xc.a.Xda,
ed.a.application,Object(v.a)(this,this.iBk,"queryTransitionGalleryExceptExisting"),97),this.ia.ra(Xc.a.owa,ed.a.application,Object(v.a)(this,this.Q3k,"setTransitionGalleryExisting"),5),this.ia.ra(Xc.a.kIa,ed.a.application,Object(v.a)(this,this.R3k,"setTransitionGalleryExistingInMenu"),5),this.ia.ra(Xc.a.Fva,ed.a.application,Object(v.a)(this,this.Fva,"queryTransitionGalleryExisting"),97),this.ia.ra(Xc.a.kHa,ed.a.application,Object(v.a)(this,this.kHa,"queryTransitionGalleryExistingInMenu"),97)):(this.ia.ra(Xc.a.nwa,
ed.a.application,Object(v.a)(this,this.TIe,"setTransitionGallery"),5),this.ia.ra(Xc.a.Xda,ed.a.application,Object(v.a)(this,this.Xda,"queryTransitionGallery"),97),this.ia.ra(Xc.a.owa,ed.a.application,Object(v.a)(this,this.TIe,"setTransitionGallery"),5),this.ia.ra(Xc.a.kIa,ed.a.application,Object(v.a)(this,this.TIe,"setTransitionGallery"),5),this.ia.ra(Xc.a.Fva,ed.a.application,Object(v.a)(this,this.Xda,"queryTransitionGallery"),97),this.ia.ra(Xc.a.kHa,ed.a.application,Object(v.a)(this,this.Xda,"queryTransitionGallery"),
97)),this.ia.ra(Xc.a.SIe,ed.a.application,Object(v.a)(this,this.O3k,"setTransitionEffectOption"),5),this.ia.ra(Xc.a.nBe,ed.a.application,Object(v.a)(this,this.hBk,"queryTransitionEffectOption"),97),this.ia.ra(Xc.a.ODb,ed.a.application,Object(v.a)(this,this.ODb,"queryTransitionEffectOptionsAnchor"),100),this.ia.ra(Xc.a.Gec,ed.a.application,Object(v.a)(this,this.Gec,"populateTransitionEffectOptions"),96),this.ia.ra(Xc.a.jHa,ed.a.application,Object(v.a)(this,this.jHa,"queryTransitionDuration"),97),this.ia.ra(Xc.a.kGb,
ed.a.application,Object(v.a)(this,this.kGb,"setTransitionDuration"),5));this.ia.ra(Xc.a.jGb,ed.a.application,Object(v.a)(this,this.jGb,"setTransitionApplyAll"),4);this.ia.ra(Xc.a.Ogc,ed.a.application,Object(v.a)(this,this.Ogc,"queryTransitionApplyAll"),96)}Fe(){}Gec(z,T,ja,Ba,Ga){if(this.Op&&1!==this.sa.rf().length)return 16;if(1===ja)return 32;z=(z=this.ua.Ca)?z.Bo:null;if(!z)return 16;if(!Ga)return 8;z=this.Lm.Fsb(z);z.next&&(Ga.MenuItems=this.rIf(z));return 32}Xda(z,T,ja,Ba,Ga){if(!Ga)return 8;
z=Ga.queryResult;Ga=Ga.SourceControlId;T=this.Lm.EP(Ga);if(!T)return 8;z.xBa=ci.bKc(T.tc,T.mc,this.W0c);T=this.ua.Ca;if(!T)return 16;1===ja&&((ja=T.Bo)?(ja=this.Lm.jQa(ja),z.F4(!ja&&"TransitionExisting"===Ga||ja===Ga)):z.F4("TransitionNone"===Ga));return 32}iBk(z,T,ja,Ba,Ga){if(!Ga||z!==Xc.a.Xda)return 8;z=Ga.queryResult;Ga=Ga.SourceControlId;T=this.Lm.EP(Ga);if(!T)return 8;Ba=T.tc.split("_")[1]+"_24";T=ci.sPa(Ga,Ga,Ba,"2024601249","149145197",T.mc,T.mc);z.T6=T;T=this.ua.Ca;if(!T)return 16;1===ja&&
((ja=T.Bo)?(ja=this.Lm.jQa(ja),z.F4(ja===Ga)):z.F4("TransitionNone"===Ga));return 32}Fva(z,T,ja,Ba,Ga){if(!Ga||z!==Xc.a.Fva)return 8;z=Ga.queryResult;Ga=Ga.SourceControlId;if(!Ga||"TransitionExisting"!==Ga)return 16;T=this.Lm.EP(Ga);if(!T)return 8;Ba=T.tc.split("_")[1]+"_24";T=ci.sPa(Ga,Ga,Ba,"3752636652","3476251476",T.mc,T.mc);z.T6=T;T=this.ua.Ca;if(!T)return 16;if(1===ja&&(ja=T.Bo)){ja=this.Lm.jQa(ja);T=this.Lm.UTc(ja,this.Lm.Urb());if(ja&&!T){Ba=this.Lm.EP(ja);if(!Ba)return 8;const Fb=Ba.tc.split("_")[1]+
"_24";Ga=ci.sPa(Ga,Ga,Fb,"3752636652","3476251476",Ba.mc,Ba.mc);z.T6=Ga}z.F4(!ja||!!ja&&!T)}return 32}kHa(z,T,ja,Ba,Ga){if(!Ga||z!==Xc.a.kHa)return 8;z=Ga.queryResult;Ga=Ga.SourceControlId;if(!Ga||"TransitionExistingInMenu"!==Ga)return 16;T=this.Lm.EP(Ga);if(!T)return 8;Ba=T.tc.split("_")[1]+"_24";Ga=ci.sPa(Ga,Ga,Ba,"4036532528","2831233208",T.mc,T.mc);z.T6=Ga;Ga=this.ua.Ca;if(!Ga)return 16;1===ja&&(ja=Ga.Bo)&&(ja=this.Lm.jQa(ja),z.F4(!ja));return 32}ODb(z,T,ja){z=this.ua.Ca;if(!z)return 16;z=this.Lm.Fsb(z.Bo);
return!z||!z.next||this.Op&&1!==this.sa.rf().length?16:1===ja?32:8}TIe(z,T,ja,Ba,Ga){if(!Ga)return 8;T=Ga.SourceControlId;Ga=z===Xc.a.owa||z===Xc.a.kIa;Ba=this.ua.Ca;if(!Ba||this.Zb.gd(Ba)||this.Op&&1!==this.sa.rf().length)return 16;var Fb=Ba.Bo;const Rb=!!this.Lm.iQa(Fb);if(Ga&&(!Fb||Rb))return 16;if(1===ja)return 32;Fb=this.Lm.EP(T);if(!Fb)return 8;if(!Ga&&2===ja&&T){Od.a.ik("SlideCount","1");ja=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{ja.lc(Ba),ja.fd=z,Ba.Bo=Fb.rc}finally{ja&&
ja.dispose()}e.ULS.sendTraceTag(18954374,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",T,Fb.next||"null",Ba.Cb.sid)}return 32}P3k(z,T,ja,Ba,Ga){if(!Ga)return 8;T=Ga.SourceControlId;Ba=this.ua.Ca;if(!Ba)return 16;if(z!==Xc.a.nwa)return 8;if(this.Zb.gd(Ba)||this.Op&&1!==this.sa.rf().length)return 16;if(1===ja)return 32;Ga=this.Lm.EP(T);if(!Ga)return 8;if(2===ja&&T){Od.a.ik("SlideCount","1");ja=this.Jb.xd(15,void 0,()=>{this.sa.fj();
this.Ga.Bd()});try{ja.lc(Ba),ja.fd=z,Ba.Bo=Ga.rc}finally{ja&&ja.dispose()}e.ULS.sendTraceTag(21066185,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",T,Ga.next||"null",Ba.Cb.sid)}return 32}Q3k(z,T,ja,Ba,Ga){if(!Ga)return 8;T=this.ua.Ca;if(!T)return 16;if(z!==Xc.a.owa)return 8;if(this.Op&&1!==this.sa.rf().length)return 16;if(1!==ja)return 8;z=T.Bo;ja=!!this.Lm.iQa(z);T=this.Lm.Fsb(z);T=this.Lm.UTc(T?T.parent:null,this.Lm.Urb());
return z&&!ja||!T?32:16}R3k(z,T,ja,Ba,Ga){if(!Ga)return 8;T=this.ua.Ca;if(!T)return 16;if(z!==Xc.a.kIa)return 8;if(this.Op&&1!==this.sa.rf().length)return 16;if(1!==ja)return 8;z=T.Bo;ja=!!this.Lm.iQa(z);return!z||ja?16:32}jGb(z,T,ja){T=this.ua.Ca;if(!T||this.Zb.gd(T)||this.Op&&1!==this.sa.rf().length)return 16;if(1===ja)return 32;Od.a.ik("SlideCount","1");ja=this.Wb.Bf;const Ba=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{Ba.lc(ja),Ba.fd=z,ja.enb=T.Cb}finally{Ba&&Ba.dispose()}e.ULS.sendTraceTag(18954375,
801,50,"TransitionActor: Command=SetTransitionApplyAll");return 32}Ogc(z,T,ja,Ba,Ga){z=this.ua.Ca?!0:!1;if(!Ga)return 8;Ga=Ga.queryResult;Ga.xBa=ci.bKc("pegal_TransitionNewsFlash_32x32x32",ResourceStrings.L_TransitionApplyAll,this.W0c);Ga.F4(z);return z?32:16}O3k(z,T,ja,Ba,Ga){if(!Ga)return 8;T=Ga.MenuItemId;if(this.Op&&1!==this.sa.rf().length)return 16;if(1===ja)return 32;ja=this.ua.Ca;if(!ja||this.Zb.gd(ja))return 16;Ba=ja?ja.Bo:null;Ga=this.Lm.EP(T);if(!Ba||!Ga||!Ga.rc)return 16;Ba.TransitionType=
Ga.rc.TransitionType;Ba.Direction=Ga.rc.Direction;Ba.Duration=Ga.rc.Duration;Od.a.ik("SlideCount","1");const Fb=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{Fb.lc(ja),Fb.fd=z,ja.Bo=Ba}finally{Fb&&Fb.dispose()}e.ULS.sendTraceTag(18954376,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",Ga.parent,T,ja.Cb.sid);return 32}hBk(z,T,ja,Ba,Ga){if(!Ga)return 8;z=Ga.queryResult;Ga=Ga.MenuItemId;T=this.ua.Ca;if(!T)return 16;
1===ja&&z.Yf(this.Lm.iQa(T.Bo)===Ga);return 32}jHa(z,T,ja,Ba,Ga){z=this.ua.Ca;if(!z)return 16;if(!Ga)return 8;z=z.Bo;if(Ga=Ga.queryResult)Ga.xea=z?(z.Duration/1E3).toString():"0";return 32}kGb(z,T,ja,Ba,Ga){T=this.ua.Ca;if(!T||this.Zb.gd(T))return 16;if(!Ga)return 8;if(this.Op&&1!==this.sa.rf().length)return 16;Ba=Math.floor(1E3*Ga.Number);Ga=T.Bo;if(!Ga)return 16;Od.a.Db&&(Od.a.Db.actionName="SetTransitionDuration");if(1===ja)return"TransitionNone"===this.Lm.jQa(Ga)?16:32;if(2===ja){Ga.Duration=
Ba;const Fb=this.Ga.ye;Od.a.ik("SlideCount","1");ja=this.Jb.xd(15,void 0,()=>{this.sa.fj();!Fb||Fb.name!==Id.a.sg&&Fb.name!==Id.a.oC||this.Ga.Bd()});try{ja.lc(T),ja.fd=z,T.Bo=Ga}finally{ja&&ja.dispose()}}return 32}guk(z,T,ja,Ba,Ga){if(1===ja)return 32;if(!Ga)return 8;T=this.sa.rf();if(!T||!T.length)return 16;z=T[0].Bo;if(!z)return 16;z=this.Lm.Fsb(z);if(1<T.length)for(const Fb of T){T=Fb.Bo;if(!T)return 16;T=this.Lm.Fsb(T);if(z.parent!==T.parent)return 16}z.next&&(Ga.MenuItems=this.rIf(z));return 32}aBe(z,
T,ja,Ba,Ga){if(!Ga)return 8;z=Ga.queryResult;Ga=Ga.SourceControlId;T=this.Lm.EP(Ga);if(!T)return 8;z.xBa=ci.bKc(T.tc,T.mc,this.W0c);T=this.sa.rf();if(!T||!T.length)return 16;1===ja&&(ja="",({fna:ja}=this.sOa(T)).returnValue&&z.F4(!ja&&"TransitionExisting"===Ga||ja===Ga));return 32}QAk(z,T,ja,Ba,Ga){if(!Ga||z!==Xc.a.Xda)return 8;z=Ga.queryResult;Ga=Ga.SourceControlId;T=this.Lm.EP(Ga);if(!T)return 8;Ba=T.tc.split("_")[1]+"_24";T=ci.sPa(Ga,Ga,Ba,"2024601249","149145197",T.mc,T.mc);z.T6=T;T=this.sa.rf();
if(!T||!T.length)return 16;1===ja&&(ja="",({fna:ja}=this.sOa(T)).returnValue&&z.F4(ja===Ga));return 32}RAk(z,T,ja,Ba,Ga){if(!Ga||z!==Xc.a.Fva)return 8;z=Ga.queryResult;Ga=Ga.SourceControlId;if(!Ga||"TransitionExisting"!==Ga)return 16;T=this.Lm.EP(Ga);if(!T)return 8;Ba=T.tc.split("_")[1]+"_24";T=ci.sPa(Ga,Ga,Ba,"3752636652","3476251476",T.mc,T.mc);z.T6=T;T=this.sa.rf();if(!T||!T.length)return 16;if(1===ja&&(ja="",({fna:ja}=this.sOa(T)).returnValue)){T=this.Lm.UTc(ja,this.Lm.Urb());if(ja&&!T){Ba=this.Lm.EP(ja);
if(!Ba)return 8;const Fb=Ba.tc.split("_")[1]+"_24";Ga=ci.sPa(Ga,Ga,Fb,"3752636652","3476251476",Ba.mc,Ba.mc);z.T6=Ga}z.F4(!ja||!!ja&&!T)}return 32}SAk(z,T,ja,Ba,Ga){if(!Ga||z!==Xc.a.kHa)return 8;z=Ga.queryResult;Ga=Ga.SourceControlId;if(!Ga||"TransitionExistingInMenu"!==Ga)return 16;T=this.Lm.EP(Ga);if(!T)return 8;Ba=T.tc.split("_")[1]+"_24";Ga=ci.sPa(Ga,Ga,Ba,"4036532528","2831233208",T.mc,T.mc);z.T6=Ga;Ga=this.sa.rf();if(!Ga||!Ga.length)return 16;1===ja&&(ja="",({fna:ja}=this.sOa(Ga)).returnValue&&
z.F4(!ja));return 32}PAk(z,T,ja){z=this.sa.rf();if(!z||!z.length)return 16;T=this.Lm.Fsb(z[0].Bo);return!T||!T.next||1<z.length&&!this.sOa(z).returnValue?16:1===ja?32:8}HIe(z,T,ja,Ba,Ga){if(!Ga)return 8;T=Ga.SourceControlId;Ga=z===Xc.a.owa||z===Xc.a.kIa;Ba=this.sa.rf();if(!Ba||!Ba.length)return 16;for(var Fb of Ba)if(this.Zb.gd(Fb))return 16;Fb="";const Rb=({fna:Fb}=this.sOa(Ba)).returnValue;if(Ga&&(!Rb||Fb))return 16;if(1===ja)return 32;Fb=this.Lm.EP(T);if(!Fb)return 8;if(!Ga&&2===ja&&T){Od.a.ik("SlideCount",
Ba.length.toString());ja=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{ja.lc(this.Wb.Bf);ja.fd=z;for(const tc of Ba)tc.Bo=Fb.rc}finally{ja&&ja.dispose()}e.ULS.sendTraceTag(34444892,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",T,Fb.next||"null")}return 32}W2k(z,T,ja,Ba,Ga){if(!Ga)return 8;T=Ga.SourceControlId;if(z!==Xc.a.nwa)return 8;Ba=this.sa.rf();if(!Ba||!Ba.length)return 16;for(var Fb of Ba)if(this.Zb.gd(Fb))return 16;if(1===
ja)return 32;Fb=this.Lm.EP(T);if(!Fb)return 8;if(2===ja&&T){Od.a.ik("SlideCount",Ba.length.toString());ja=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()},()=>{1===this.Pb.Aw&&this.Ga.Kj(Id.a.vea,!0)});try{ja.lc(this.Wb.Bf);ja.fd=z;for(const Rb of Ba)Rb.Bo=Fb.rc}finally{ja&&ja.dispose()}e.ULS.sendTraceTag(34444893,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",T,Fb.next||"null")}return 32}X2k(z,T,ja,Ba,Ga){if(!Ga)return 8;T=this.sa.rf();
if(!T||!T.length)return 16;if(z!==Xc.a.owa||1!==ja)return 8;Ba="";z=({fna:Ba}=this.sOa(T)).returnValue;ja=!!Ba;T=Ba&&0<Ba.length?this.Lm.EP(Ba):null;T=this.Lm.UTc(T?T.parent:null,this.Lm.Urb());return!z||ja&&T?16:32}Y2k(z,T,ja,Ba,Ga){if(!Ga)return 8;T=this.sa.rf();if(!T||!T.length)return 16;if(z!==Xc.a.kIa||1!==ja)return 8;z="";return!({fna:z}=this.sOa(T)).returnValue||z?16:32}V2k(z,T,ja,Ba,Ga){if(!Ga)return 8;T=Ga.MenuItemId;if(1===ja)return 32;ja=this.sa.rf();if(!ja||!ja.length)return 16;for(var Fb of ja)if(this.Zb.gd(Fb)||
!Fb.Bo)return 16;Fb=this.Lm.EP(T);if(!Fb||!Fb.rc)return 16;Od.a.ik("SlideCount",ja.length.toString());Ba=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{Ba.lc(this.Wb.Bf);Ba.fd=z;for(const Rb of ja){let tc=Rb.Bo;tc.TransitionType=Fb.rc.TransitionType;tc.Direction=Fb.rc.Direction;tc.Duration=Fb.rc.Duration;Rb.Bo=tc}}finally{Ba&&Ba.dispose()}e.ULS.sendTraceTag(34444894,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}",Fb.parent,T);
return 32}OAk(z,T,ja,Ba,Ga){if(!Ga)return 8;z=Ga.queryResult;Ga=Ga.MenuItemId;T=this.sa.rf();if(!T||!T.length)return 16;1===ja&&(ja="",({fna:ja}=this.nGi(T)).returnValue&&z.Yf(ja===Ga));return 32}NAk(z,T,ja,Ba,Ga){if(!Ga)return 8;z=this.sa.rf();if(!z||!z.length)return 16;if(Ga=Ga.queryResult)z=ci.lbj(z),Ga.xea=z;return 32}U2k(z,T,ja,Ba,Ga){if(!Ga)return 8;T=this.sa.rf();if(!T||!T.length)return 16;for(const Fb of T)if(this.Zb.gd(Fb))return 16;Ga=Math.floor(1E3*Ga.Number);for(const Fb of T)if(!Fb.Bo)return 16;
Od.a.Db&&(Od.a.Db.actionName="SetTransitionDuration");if(1===ja){for(const Fb of T)if("TransitionNone"===this.Lm.jQa(Fb.Bo))return 16;return 32}if(2===ja){const Fb=this.Ga.ye;Od.a.ik("SlideCount",T.length.toString());ja=this.Jb.xd(15,void 0,()=>{this.sa.fj();!Fb||Fb.name!==Id.a.sg&&Fb.name!==Id.a.oC||this.Ga.Bd()});try{ja.lc(this.Wb.Bf);ja.fd=z;for(const Rb of T){const tc=Rb.Bo;tc.Duration=Ga;Rb.Bo=tc}}finally{ja&&ja.dispose()}}return 32}sOa(z){let T;T="";if(!z||!z.length)return{returnValue:!1,fna:T};
T=this.Lm.jQa(z[0].Bo);let ja=!0;if(1<z.length)for(const Ba of z)if(z=this.Lm.jQa(Ba?Ba.Bo:null),T!==z){ja=!1;break}ja||(T="");return{returnValue:ja,fna:T}}nGi(z){let T;T="";if(!z||!z.length)return{returnValue:!1,fna:T};T=this.Lm.iQa(z[0].Bo);let ja=!0;if(1<z.length)for(const Ba of z)if(z=this.Lm.iQa(Ba?Ba.Bo:null),T!==z){ja=!1;break}ja||(T="");return{returnValue:ja,fna:T}}rIf(z){const T=Object.assign(new cg.a,{Id:"TransitionMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_TransitionEffectOptions,
MenuSectionList:[]}),ja=Object.assign(new Ng.a,{Id:"MenuSectionEffectOptions",ControlsId:"MenuSectionEffectOptions.Controls",DisplayMode:"Menu32",ControlList:[]});Array.add(T.MenuSectionList,ja);let Ba=null;for(z=({key:Ba}=this.Lm.mag(z)).returnValue;z;)Array.add(ja.ControlList,Object.assign(new wh.a,{Command:"961566706",Id:Ba,ExternalId:"TransitionEffectOptions"+Ba,QueryCommand:"3535869262"})),{key:Ba,returnValue:z}=this.Lm.mag(z);return T}static lbj(z){let T;if(!z||!z.length)return"0";const ja=
z[0].Bo;T=ja?(ja.Duration/1E3).toString():"0";let Ba=!0;if(1<z.length)for(const Ga of z)if((z=Ga?Ga.Bo:null)||ja){if(!z&&ja||z&&!ja){Ba=!1;break}if(T!==(z.Duration/1E3).toString()){Ba=!1;break}}Ba||(T="0");return T}static bKc(z,T,ja){z=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',z,ja);T=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',T);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',
z,T)}static sPa(z,T,ja,Ba,Ga,Fb,Rb){return Object.assign(new hj.a,{Id:z,ExternalId:T,Icon:ja,Command:Ba,QueryCommand:Ga,LabelText:Fb,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Rb})}}Object(h.a)(ci,"TransitionActor",null,[234]);var Rh=d(981);class se{constructor(){this.effectId=this.effectType=0;this.labelText=this.Ne=this.xn=this.Vn=null}}Object(h.a)(se,"AnimInfo",null,[]);class bf{constructor(){this.yj=this.labelText=this.Ne=this.id=
null}}Object(h.a)(bf,"EffectOption",null,[]);class Sh extends bf{constructor(){super();this.value=null}}Object(h.a)(Sh,"EffectData",bf,[]);class $c{constructor(z){this.h6b=z;$c.il||($c.il=new Rh.a,$c.il.add("FromBottom",Object.assign(new bf,{id:"FromBottom",Ne:$c.$e("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottom,yj:CommonUIStrings.l_AnimationFromBottomKeytip})),$c.il.add("FromBottomLeft",Object.assign(new bf,{id:"FromBottomLeft",Ne:$c.$e("AnimEffectPropFromBottomLeft"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomLeft,yj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),$c.il.add("FromLeft",Object.assign(new bf,{id:"FromLeft",Ne:$c.$e("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromLeft,yj:CommonUIStrings.l_AnimationFromLeftKeytip})),$c.il.add("FromTopLeft",Object.assign(new bf,{id:"FromTopLeft",Ne:$c.$e("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopLeft,yj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),
$c.il.add("FromTop",Object.assign(new bf,{id:"FromTop",Ne:$c.$e("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTop,yj:CommonUIStrings.l_AnimationFromTopKeytip})),$c.il.add("FromTopRight",Object.assign(new bf,{id:"FromTopRight",Ne:$c.$e("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopRight,yj:CommonUIStrings.l_AnimationFromTopRightKeytip})),$c.il.add("FromRight",Object.assign(new bf,{id:"FromRight",Ne:$c.$e("AnimEffectPropFromRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromRight,yj:CommonUIStrings.l_AnimationFromRightKeytip})),$c.il.add("FromBottomRight",Object.assign(new bf,{id:"FromBottomRight",Ne:$c.$e("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomRight,yj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),$c.il.add("ToBottom",Object.assign(new bf,{id:"ToBottom",Ne:$c.$e("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottom,yj:CommonUIStrings.l_AnimationFromBottomKeytip})),
$c.il.add("ToBottomLeft",Object.assign(new bf,{id:"ToBottomLeft",Ne:$c.$e("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomLeft,yj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),$c.il.add("ToLeft",Object.assign(new bf,{id:"ToLeft",Ne:$c.$e("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToLeft,yj:CommonUIStrings.l_AnimationFromLeftKeytip})),$c.il.add("ToTopLeft",Object.assign(new bf,{id:"ToTopLeft",Ne:$c.$e("AnimEffectPropFromBottomRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionToTopLeft,yj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),$c.il.add("ToTop",Object.assign(new bf,{id:"ToTop",Ne:$c.$e("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionToTop,yj:CommonUIStrings.l_AnimationFromTopKeytip})),$c.il.add("ToTopRight",Object.assign(new bf,{id:"ToTopRight",Ne:$c.$e("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopRight,yj:CommonUIStrings.l_AnimationFromTopRightKeytip})),
$c.il.add("ToRight",Object.assign(new bf,{id:"ToRight",Ne:$c.$e("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToRight,yj:CommonUIStrings.l_AnimationFromRightKeytip})),$c.il.add("ToBottomRight",Object.assign(new bf,{id:"ToBottomRight",Ne:$c.$e("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomRight,yj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),$c.il.add("Horizontal",Object.assign(new bf,{id:"Horizontal",Ne:$c.$e("AnimEffectPropHorizontal"),
labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,yj:CommonUIStrings.l_AnimationHorizontalKeytip})),$c.il.add("HorizontalIn",Object.assign(new bf,{id:"HorizontalIn",Ne:$c.$e("AnimEffectPropHorizontalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalIn,yj:CommonUIStrings.l_AnimationHorizontalInKeytip})),$c.il.add("HorizontalOut",Object.assign(new bf,{id:"HorizontalOut",Ne:$c.$e("AnimEffectPropHorizontalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalOut,
yj:CommonUIStrings.l_AnimationHorizontalOutKeytip})),$c.il.add("Vertical",Object.assign(new bf,{id:"Vertical",Ne:$c.$e("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,yj:CommonUIStrings.l_AnimationVerticalKeytip})),$c.il.add("VerticalIn",Object.assign(new bf,{id:"VerticalIn",Ne:$c.$e("AnimEffectPropVerticalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalIn,yj:CommonUIStrings.l_AnimationVerticalInKeytip})),$c.il.add("VerticalOut",Object.assign(new bf,
{id:"VerticalOut",Ne:$c.$e("AnimEffectPropVerticalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalOut,yj:CommonUIStrings.l_AnimationVerticalOutKeytip})),$c.il.add("LeftDown",Object.assign(new bf,{id:"LeftDown",Ne:$c.$e("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftDown,yj:CommonUIStrings.l_AnimationLeftDownKeytip})),$c.il.add("LeftUp",Object.assign(new bf,{id:"LeftUp",Ne:$c.$e("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftUp,
yj:CommonUIStrings.l_AnimationLeftUpKeytip})),$c.il.add("RightDown",Object.assign(new bf,{id:"RightDown",Ne:$c.$e("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightDown,yj:CommonUIStrings.l_AnimationRightDownKeytip})),$c.il.add("RightUp",Object.assign(new bf,{id:"RightUp",Ne:$c.$e("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightUp,yj:CommonUIStrings.l_AnimationRightUpKeytip})),$c.il.add("In",Object.assign(new bf,{id:"In",Ne:$c.$e("AnimEffectPropIn"),
labelText:ResourceStrings.L_EffectOptionsDirectionIn,yj:CommonUIStrings.l_AnimationInKeytip})),$c.il.add("InBottom",Object.assign(new bf,{id:"InBottom",Ne:$c.$e("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInToScreenBottom,yj:CommonUIStrings.l_AnimationInToScreenBottomKeytip})),$c.il.add("InCenter",Object.assign(new bf,{id:"InCenter",Ne:$c.$e("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInCenter,yj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),
$c.il.add("InSlightly",Object.assign(new bf,{id:"InSlightly",Ne:$c.$e("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInSlightly,yj:CommonUIStrings.l_AnimationInSlightlyKeytip})),$c.il.add("Out",Object.assign(new bf,{id:"Out",Ne:$c.$e("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOut,yj:CommonUIStrings.l_AnimationOutKeytip})),$c.il.add("OutBottom",Object.assign(new bf,{id:"OutBottom",Ne:$c.$e("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutBottom,
yj:CommonUIStrings.l_AnimationOutFromScreenBottomKeytip})),$c.il.add("OutCenter",Object.assign(new bf,{id:"OutCenter",Ne:$c.$e("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutToScreenCenter,yj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),$c.il.add("OutSlightly",Object.assign(new bf,{id:"OutSlightly",Ne:$c.$e("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutSlightly,yj:CommonUIStrings.l_AnimationOutSlightlyKeytip})),$c.il.add("FloatUp",Object.assign(new bf,
{id:"FloatUp",Ne:$c.$e("AnimEffectPropFloatUp"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatUp,yj:CommonUIStrings.l_AnimationOutKeytip})),$c.il.add("FloatDown",Object.assign(new bf,{id:"FloatDown",Ne:$c.$e("AnimEffectPropFloatDown"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatDown,yj:CommonUIStrings.l_AnimationDownKeytip})),$c.il.add("ObjectCenter",Object.assign(new bf,{id:"ObjectCenter",Ne:$c.$e("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,
yj:CommonUIStrings.l_AnimationObjectCenterKeytip})),$c.il.add("SlideCenter",Object.assign(new bf,{id:"SlideCenter",Ne:$c.$e("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,yj:CommonUIStrings.l_AnimationSlideCenterKeytip})),$c.il.add("ObjectCenterOut",Object.assign(new bf,{id:"ObjectCenterOut",Ne:$c.$e("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,yj:CommonUIStrings.l_AnimationObjectCenterKeytip})),$c.il.add("SlideCenterOut",
Object.assign(new bf,{id:"SlideCenterOut",Ne:$c.$e("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,yj:CommonUIStrings.l_AnimationSlideCenterKeytip})),$c.il.add("Clockwise",Object.assign(new bf,{id:"Clockwise",Ne:$c.$e("AnimEffectPropClockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionClockwise,yj:CommonUIStrings.l_AnimationClockWiseKeytip})),$c.il.add("CounterClockwise",Object.assign(new bf,{id:"CounterClockwise",Ne:$c.$e("AnimEffectPropCounterclockwise"),
labelText:ResourceStrings.L_EffectOptionsDirectionCounterClockwise,yj:CommonUIStrings.l_AnimationCounterClockWiseKeytip})),$c.il.add("Across",Object.assign(new bf,{id:"Across",Ne:$c.$e("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionAcross,yj:CommonUIStrings.l_AnimationAcrossKeytip})),$c.il.add("Up",Object.assign(new bf,{id:"Up",Ne:$c.$e("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionUp,yj:CommonUIStrings.l_AnimationUpKeytip})),$c.il.add("Down",
Object.assign(new bf,{id:"Down",Ne:$c.$e("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionDown,yj:CommonUIStrings.l_AnimationDownKeytip})),$c.il.add("GrowShrinkHorizontal",Object.assign(new bf,{id:"GrowShrinkHorizontal",Ne:$c.$e("AnimEffectPropGrowShrinkHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,yj:CommonUIStrings.l_AnimationHorizontalKeytip})),$c.il.add("GrowShrinkVertical",Object.assign(new bf,{id:"GrowShrinkVertical",Ne:$c.$e("AnimEffectPropGrowShrinkVertical"),
labelText:ResourceStrings.L_EffectOptionsDirectionVertical,yj:CommonUIStrings.l_AnimationVerticalKeytip})),$c.il.add("GrowShrinkBoth",Object.assign(new bf,{id:"GrowShrinkBoth",Ne:$c.$e("AnimEffectPropBoth"),labelText:ResourceStrings.L_EffectOptionsDirectionBoth,yj:CommonUIStrings.l_AnimationBothKeytip})));$c.ZR||($c.ZR=new Rh.a,$c.ZR.add("Spin_Quarter",Object.assign(new Sh,{id:"Spin_Quarter",Ne:$c.$e("AnimEffectPropQuarterSpin"),labelText:ResourceStrings.L_EffectOptionsSpinQuarter,value:"90",yj:CommonUIStrings.l_AnimationQuarterSpinKeytip})),
$c.ZR.add("Spin_Half",Object.assign(new Sh,{id:"Spin_Half",Ne:$c.$e("AnimEffectPropHalfSpin"),labelText:ResourceStrings.L_EffectOptionsSpinHalf,value:"180",yj:CommonUIStrings.l_AnimationHalfSpinKeytip})),$c.ZR.add("Spin_Full",Object.assign(new Sh,{id:"Spin_Full",Ne:$c.$e("AnimEffectPropFullSpin"),labelText:ResourceStrings.L_EffectOptionsSpinFull,value:"360",yj:CommonUIStrings.l_AnimationFullSpinKeytip})),$c.ZR.add("Spin_Two",Object.assign(new Sh,{id:"Spin_Two",Ne:$c.$e("AnimEffectPropTwoSpins"),labelText:ResourceStrings.L_EffectOptionsSpinTwo,
value:"720",yj:CommonUIStrings.l_AnimationTwoSpinKeytip})),$c.ZR.add("Transparency_25",Object.assign(new Sh,{id:"Transparency_25",Ne:$c.$e("AnimEffectPropTransparent25"),labelText:ResourceStrings.L_EffectOptionsTransparency25Percent,value:"0.75",yj:CommonUIStrings.l_Animation25PerKeytip})),$c.ZR.add("Transparency_50",Object.assign(new Sh,{id:"Transparency_50",Ne:$c.$e("AnimEffectPropTransparent50"),labelText:ResourceStrings.L_EffectOptionsTransparency50Percent,value:"0.5",yj:CommonUIStrings.l_Animation50PerKeytip})),
$c.ZR.add("Transparency_75",Object.assign(new Sh,{id:"Transparency_75",Ne:$c.$e("AnimEffectPropTransparent75"),labelText:ResourceStrings.L_EffectOptionsTransparency75Percent,value:"0.25",yj:CommonUIStrings.l_Animation75PerKeytip})),$c.ZR.add("Transparency_100",Object.assign(new Sh,{id:"Transparency_100",Ne:$c.$e("AnimEffectPropTransparent100"),labelText:ResourceStrings.L_EffectOptionsTransparency100Percent,value:"0.0",yj:CommonUIStrings.l_Animation100PerKeytip})),$c.ZR.add("GrowShrink_Tiny",Object.assign(new Sh,
{id:"GrowShrink_Tiny",Ne:$c.$e("AnimEffectPropTiny"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkTiny,value:"25",yj:CommonUIStrings.l_AnimationTinyKeytip})),$c.ZR.add("GrowShrink_Smaller",Object.assign(new Sh,{id:"GrowShrink_Smaller",Ne:$c.$e("AnimEffectPropSmaller"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkSmaller,value:"50",yj:CommonUIStrings.l_AnimationSmallerKeytip})),$c.ZR.add("GrowShrink_Larger",Object.assign(new Sh,{id:"GrowShrink_Larger",Ne:$c.$e("AnimEffectPropLarger"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkLarger,
value:"150",yj:CommonUIStrings.l_AnimationLargerKeytip})),$c.ZR.add("GrowShrink_Huge",Object.assign(new Sh,{id:"GrowShrink_Huge",Ne:$c.$e("AnimEffectPropHuge"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkHuge,value:"400",yj:CommonUIStrings.l_AnimationHugeKeytip})));if(!$c.Ll)if($c.Ll=new Rh.a,$c.Ll.add("Existing",Object.assign(new se,{effectType:-1,effectId:-1,Ne:$c.$e("AnimFxMultiple"),labelText:ResourceStrings.L_AnimationExisting,Vn:[],xn:[]})),$c.Ll.add("None",Object.assign(new se,{effectType:0,
effectId:0,Ne:$c.$e("AnimFxNone"),labelText:ResourceStrings.L_AnimationNone,Vn:[],xn:[]})),$c.Ll.add("Appear",Object.assign(new se,{effectType:0,effectId:1,Ne:$c.$e("AnimFxEntranceAppear"),labelText:ResourceStrings.L_AnimationAppear,Vn:[],xn:[]})),$c.Ll.add("FadeIn",Object.assign(new se,{effectType:0,effectId:10,Ne:$c.$e("AnimFxEntranceFadeIn"),labelText:ResourceStrings.L_AnimationFade,Vn:[],xn:[]})),this.h6b){$c.Ll.add("FlyIn",Object.assign(new se,{effectType:0,effectId:2,Ne:$c.$e("AnimFxEntranceFlyIn"),
labelText:ResourceStrings.L_AnimationFlyIn,Vn:"FromBottom FromBottomLeft FromLeft FromTopLeft FromTop FromTopRight FromRight FromBottomRight".split(" "),xn:[]}));$c.Ll.add("Wipe",Object.assign(new se,{effectType:0,effectId:22,Ne:$c.$e("AnimFxEntranceWipeIn"),labelText:ResourceStrings.L_AnimationWipe,Vn:["FromBottom","FromLeft","FromRight","FromTop"],xn:[]}));$c.Ll.add("Zoom",Object.assign(new se,{effectType:0,effectId:53,Ne:$c.$e("AnimFxEntranceFadedZoom"),labelText:ResourceStrings.L_AnimationZoom,
Vn:["ObjectCenter","SlideCenter"],xn:[]}));$c.Ll.add("Checkerboard",Object.assign(new se,{effectType:0,effectId:5,Ne:$c.$e("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationCheckerboard,Vn:["Across","Down"],xn:[]}));$c.Ll.add("BasicZoom",Object.assign(new se,{effectType:0,effectId:23,Ne:$c.$e("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBasicZoom,Vn:"In InCenter InSlightly Out OutBottom OutSlightly".split(" "),xn:[]}));$c.Ll.add("Blinds",Object.assign(new se,{effectType:0,
effectId:3,Ne:$c.$e("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBlinds,Vn:["Horizontal","Vertical"],xn:[]}));let T;$c.Ll.add("Box",(T=new se,T.effectType=0,T.effectId=4,T.Ne=$c.$e("AnimFxEntranceShape"),T.labelText=ResourceStrings.L_AnimationBox,T.Vn=["In","Out"],T.xn=[],T));let ja;$c.Ll.add("PeekIn",(ja=new se,ja.effectType=0,ja.effectId=12,ja.Ne=$c.$e("AnimFxEntranceGeneric"),ja.labelText=ResourceStrings.L_AnimationPeekIn,ja.Vn=["FromBottom","FromLeft","FromRight","FromTop"],ja.xn=
[],ja));let Ba;$c.Ll.add("Expand",(Ba=new se,Ba.effectType=0,Ba.effectId=55,Ba.Ne=$c.$e("AnimFxEntranceGeneric"),Ba.labelText=ResourceStrings.L_AnimationExpand,Ba.Vn=[],Ba.xn=[],Ba));let Ga;$c.Ll.add("GrowAndTurn",(Ga=new se,Ga.effectType=0,Ga.effectId=31,Ga.Ne=$c.$e("AnimFxEntranceGrowAndTurn"),Ga.labelText=ResourceStrings.L_AnimationGrowAndTurn,Ga.Vn=[],Ga.xn=[],Ga));let Fb;$c.Ll.add("RandomBars",(Fb=new se,Fb.effectType=0,Fb.effectId=14,Fb.Ne=$c.$e("AnimFxEntranceRandomBars"),Fb.labelText=ResourceStrings.L_AnimationRandomBars,
Fb.Vn=["Horizontal","Vertical"],Fb.xn=[],Fb));let Rb;$c.Ll.add("RiseUp",(Rb=new se,Rb.effectType=0,Rb.effectId=37,Rb.Ne=$c.$e("AnimFxEntranceGeneric"),Rb.labelText=ResourceStrings.L_AnimationRiseUp,Rb.Vn=[],Rb.xn=[],Rb));let tc;$c.Ll.add("Split",(tc=new se,tc.effectType=0,tc.effectId=16,tc.Ne=$c.$e("AnimFxEntranceSplit"),tc.labelText=ResourceStrings.L_AnimationSplit,tc.Vn=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],tc.xn=[],tc));let Ac;$c.Ll.add("Strips",(Ac=new se,Ac.effectType=0,
Ac.effectId=18,Ac.Ne=$c.$e("AnimFxEntranceGeneric"),Ac.labelText=ResourceStrings.L_AnimationStrips,Ac.Vn=["LeftDown","LeftUp","RightDown","RightUp"],Ac.xn=[],Ac));let kd;$c.Ll.add("Stretch",(kd=new se,kd.effectType=0,kd.effectId=17,kd.Ne=$c.$e("AnimFxEntranceGeneric"),kd.labelText=ResourceStrings.L_AnimationStretch,kd.Vn=["Across","FromBottom","FromLeft","FromRight","FromTop"],kd.xn=[],kd));let nd;$c.Ll.add("Exit_Disappear",(nd=new se,nd.effectType=1,nd.effectId=1,nd.Ne=$c.$e("AnimFxExitDisappear"),
nd.labelText=ResourceStrings.L_AnimationDisappear,nd.Vn=[],nd.xn=[],nd));let Bd;$c.Ll.add("Exit_Fade",(Bd=new se,Bd.effectType=1,Bd.effectId=10,Bd.Ne=$c.$e("AnimFxExitFadeOut"),Bd.labelText=ResourceStrings.L_AnimationFade,Bd.Vn=[],Bd.xn=[],Bd));let Zd;$c.Ll.add("Exit_FlyOut",(Zd=new se,Zd.effectType=1,Zd.effectId=2,Zd.Ne=$c.$e("AnimFxExitFlyOut"),Zd.labelText=ResourceStrings.L_AnimationFlyOut,Zd.Vn="ToBottom ToBottomLeft ToLeft ToTopLeft ToTop ToTopRight ToRight ToBottomRight".split(" "),Zd.xn=[],
Zd));let df;$c.Ll.add("Exit_Wipe",(df=new se,df.effectType=1,df.effectId=22,df.Ne=$c.$e("AnimFxExitWipe"),df.labelText=ResourceStrings.L_AnimationWipe,df.Vn=["FromBottom","FromLeft","FromRight","FromTop"],df.xn=[],df));let Ke;$c.Ll.add("Exit_Zoom",(Ke=new se,Ke.effectType=1,Ke.effectId=53,Ke.Ne=$c.$e("AnimFxExitFadedZoom"),Ke.labelText=ResourceStrings.L_AnimationZoom,Ke.Vn=["ObjectCenterOut","SlideCenterOut"],Ke.xn=[],Ke));let zf;$c.Ll.add("Exit_Checkerboard",(zf=new se,zf.effectType=1,zf.effectId=
5,zf.Ne=$c.$e("AnimFxExitGeneric"),zf.labelText=ResourceStrings.L_AnimationCheckerboard,zf.Vn=["Across","Up"],zf.xn=[],zf));let Sf;$c.Ll.add("Exit_BasicZoom",(Sf=new se,Sf.effectType=1,Sf.effectId=23,Sf.Ne=$c.$e("AnimFxExitGeneric"),Sf.labelText=ResourceStrings.L_AnimationBasicZoom,Sf.Vn="Out OutCenter OutSlightly In InBottom InSlightly".split(" "),Sf.xn=[],Sf));let Lh;$c.Ll.add("Exit_Blinds",(Lh=new se,Lh.effectType=1,Lh.effectId=3,Lh.Ne=$c.$e("AnimFxExitGeneric"),Lh.labelText=ResourceStrings.L_AnimationBlinds,
Lh.Vn=["Horizontal","Vertical"],Lh.xn=[],Lh));let Mh;$c.Ll.add("Exit_Box",(Mh=new se,Mh.effectType=1,Mh.effectId=4,Mh.Ne=$c.$e("AnimFxExitShape"),Mh.labelText=ResourceStrings.L_AnimationBox,Mh.Vn=["In","Out"],Mh.xn=[],Mh));let si;$c.Ll.add("Exit_PeekOut",(si=new se,si.effectType=1,si.effectId=12,si.Ne=$c.$e("AnimFxExitGeneric"),si.labelText=ResourceStrings.L_AnimationPeekOut,si.Vn=["ToBottom","ToLeft","ToRight","ToTop"],si.xn=[],si));let Yh;$c.Ll.add("Exit_RandomBars",(Yh=new se,Yh.effectType=1,Yh.effectId=
14,Yh.Ne=$c.$e("AnimFxExitRandomBars"),Yh.labelText=ResourceStrings.L_AnimationRandomBars,Yh.Vn=["Horizontal","Vertical"],Yh.xn=[],Yh));let Xd;$c.Ll.add("Exit_Split",(Xd=new se,Xd.effectType=1,Xd.effectId=16,Xd.Ne=$c.$e("AnimFxExitSplit"),Xd.labelText=ResourceStrings.L_AnimationSplit,Xd.Vn=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],Xd.xn=[],Xd));let Cm;$c.Ll.add("Exit_Strips",(Cm=new se,Cm.effectType=1,Cm.effectId=18,Cm.Ne=$c.$e("AnimFxExitGeneric"),Cm.labelText=ResourceStrings.L_AnimationStrips,
Cm.Vn=["LeftDown","LeftUp","RightDown","RightUp"],Cm.xn=[],Cm));let Dm;$c.Ll.add("Exit_Stretchy",(Dm=new se,Dm.effectType=1,Dm.effectId=17,Dm.Ne=$c.$e("AnimFxExitGeneric"),Dm.labelText=ResourceStrings.L_AnimationStretchy,Dm.Vn=[],Dm.xn=[],Dm));let $m;$c.Ll.add("Exit_Zoom",($m=new se,$m.effectType=1,$m.effectId=53,$m.Ne=$c.$e("AnimFxExitFadedZoom"),$m.labelText=ResourceStrings.L_AnimationZoom,$m.Vn=["ObjectCenterOut","SlideCenterOut"],$m.xn=[],$m));let Em;$c.Ll.add("Emphasis_Spin",(Em=new se,Em.effectType=
2,Em.effectId=8,Em.Ne=$c.$e("AnimFxEmphasisSpin"),Em.labelText=ResourceStrings.L_AnimationSpin,Em.Vn=["Clockwise","CounterClockwise"],Em.xn=["Spin_Quarter","Spin_Half","Spin_Full","Spin_Two"],Em));let zj;$c.Ll.add("Emphasis_Transparency",(zj=new se,zj.effectType=2,zj.effectId=9,zj.Ne=$c.$e("AnimFxEmphasisTransparency"),zj.labelText=ResourceStrings.L_AnimationTransparency,zj.Vn=[],zj.xn=["Transparency_25","Transparency_50","Transparency_75","Transparency_100"],zj));let Fm;$c.Ll.add("Emphasis_GrowShrink",
(Fm=new se,Fm.effectType=2,Fm.effectId=6,Fm.Ne=$c.$e("AnimFxEmphasisGrowShrink"),Fm.labelText=ResourceStrings.L_AnimationGrowShrink,Fm.Vn=["GrowShrinkHorizontal","GrowShrinkVertical","GrowShrinkBoth"],Fm.xn=["GrowShrink_Tiny","GrowShrink_Smaller","GrowShrink_Larger","GrowShrink_Huge"],Fm));let t;$c.Ll.add("Emphasis_FillColor",(t=new se,t.effectType=2,t.effectId=1,t.Ne=$c.$e("AnimFxEmphasisChangeFillColor"),t.labelText=ResourceStrings.L_AnimationFillColor,t.Vn=[],t.xn=[],t));let X;$c.Ll.add("Emphasis_FontColor",
(X=new se,X.effectType=2,X.effectId=3,X.Ne=$c.$e("AnimFxEmphasisChangeFontColor"),X.labelText=ResourceStrings.L_AnimationFontColor,X.Vn=[],X.xn=[],X));let sa;$c.Ll.add("Emphasis_LineColor",(sa=new se,sa.effectType=2,sa.effectId=7,sa.Ne=$c.$e("AnimFxEmphasisChangeLineColor"),sa.labelText=ResourceStrings.L_AnimationLineColor,sa.Vn=[],sa.xn=[],sa))}else $c.Ll.add("FlyIn",Object.assign(new se,{effectType:0,effectId:2,Ne:$c.$e("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,Vn:["FromBottom",
"FromLeft","FromTop","FromRight"],xn:[]}))}UWd(z,T){let ja=null;$c.Ll.forEach((Ba,Ga)=>{Ga.effectType===z&&Ga.effectId===T&&(ja=Ga);return!0});return ja}N0d(z,T){let ja=null;$c.Ll.forEach((Ba,Ga)=>{Ga.effectType===z&&Ga.effectId===T&&(ja=Ba);return!0});return ja}Jbg(z,T,ja,Ba,Ga){const Fb=Object.assign(new Ng.a,{Id:"MenuSectionEffectOptions"+ja,ControlsId:"MenuSectionEffectOptionsDirection.Controls",DisplayMode:"Menu32",ControlList:[]});z=this.UWd(T,z);if(!z)return Fb;if((z=$c.l0i(z,ja))&&z.length)for(T=
0;T<z.length;T++){const Rb=$c.m0i(z[T],ja),tc="AnimationEffectOptions"+("Direction"===ja?"Direction":"Data")+Rb.id;Array.add(Fb.ControlList,Object.assign(new wh.a,{Command:Ba,Id:Rb.id,ExternalId:tc,QueryCommand:Ga}))}return Fb}s8f(z){var T;return(T=$c.Ll.ga(z))?(z=T.effectType,T=T.effectId,{returnValue:!0,effectType:z,effectId:T}):{returnValue:!1,effectType:-1,effectId:-1}}t8f(z){let T,ja;T=$c.$e("AnimFxMultiple");ja=ResourceStrings.L_AnimationExisting;if(z=$c.Ll.ga(z))T=z.Ne,ja=z.labelText;return{image:T,
label:ja}}Prg(z,T){if(0===z){if(0!==T&&1!==T&&2!==T&&10!==T)return!0}else if(0<z)return!0;return!1}Y7a(z,T){return z&&T?this.h6b?(T=T.L7a()?z.IsTrigger:z.HasTrigger,!!this.UWd(z.EffectType,z.EffectId)&&!T):!z.HasExisting:!0}s9d(z,T){return T&&z&&this.h6b?T.L7a()?!1:z.HasMultiple:!1}Uqg(z){if(z&&this.h6b&&2===z.EffectType)switch(z.EffectId){case 1:case 3:case 7:return!0}return!1}g_i(z){z=$c.Ll.ga(z);return this.iYd(z.Vn[0])}d_i(z){return(z=$c.Ll.ga(z))&&z.xn.length?this.r8f(z.xn[0]):""}iYd(z){switch(z){case "FromBottom":case "ToBottom":return 3;
case "FromBottomLeft":case "ToBottomLeft":case "LeftDown":return 8;case "FromLeft":case "ToLeft":return 4;case "FromTopLeft":case "ToTopLeft":case "LeftUp":return 5;case "FromTop":case "ToTop":return 1;case "FromTopRight":case "ToTopRight":case "RightUp":return 6;case "FromRight":case "ToRight":return 2;case "FromBottomRight":case "ToBottomRight":case "RightDown":return 7;case "Horizontal":case "Across":return 9;case "HorizontalIn":return 15;case "HorizontalOut":return 16;case "Vertical":case "Down":case "Up":return 10;
case "VerticalIn":return 17;case "VerticalOut":return 18;case "In":case "ObjectCenter":return 11;case "InCenter":case "SlideCenter":return 22;case "InBottom":return 23;case "InSlightly":return 21;case "Out":case "ObjectCenterOut":return 12;case "OutBottom":return 26;case "OutSlightly":return 24;case "OutCenter":case "SlideCenterOut":return 25;case "FloatUp":return 1;case "FloatDown":return 3;case "Clockwise":return 13;case "CounterClockwise":return 14;case "GrowShrinkHorizontal":return 27;case "GrowShrinkVertical":return 28;
case "GrowShrinkBoth":return 29;default:return 0}}r8f(z){return(z=$c.ZR.ga(z))?z.value:""}goi(z,T){return(T=$c.ZR.ga(T))&&parseFloat(z)===parseFloat(T.value)?!0:!1}vcg(z){switch(z){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}}Ygi(z){if(null===z)throw Error.argumentNull("animation");const T=this.UWd(z.EffectType,z.EffectId);return!!T&&(0<T.Vn.length||0<T.xn.length||this.Uqg(z))}Zgi(z,T,ja){return this.Y7a(ja,z)&&!this.s9d(ja,
z)&&(this.Ygi(ja)||this.mKf(z,T,ja)||this.HKd(z,T,ja)||this.lKf(z,T,ja)||this.IKd(z,ja))}O8i(z,T,ja){const Ba=Object.assign(new Ng.a,{Id:"MenuSectionEffectOptionsSequence",ControlsId:"MenuSectionEffectOptionsSequence.Controls",DisplayMode:"Menu32",ControlList:[]});this.mKf(z,T,ja)&&Array.add(Ba.ControlList,Object.assign(new wh.a,{Command:"1850236812",Id:"AsOneObject",ExternalId:"AnimationEffectOptionsSequenceAsOneObject",QueryCommand:"1125291975"}));this.lKf(z,T,ja)&&this.h6b&&Array.add(Ba.ControlList,
Object.assign(new wh.a,{Command:"2048458448",Id:"AllAtOnce",ExternalId:"AnimationEffectOptionsSequenceAllAtOnce",QueryCommand:"1125291975"}));this.HKd(z,T,ja)&&Array.add(Ba.ControlList,Object.assign(new wh.a,{Command:"3467781846",Id:"ByParagraph",ExternalId:"AnimationEffectOptionsSequenceByParagraph",QueryCommand:"1125291975"}));this.IKd(z,ja)&&Array.add(Ba.ControlList,Object.assign(new wh.a,{Command:"1486892994",Id:"OneByOne",ExternalId:"AnimationEffectOptionsSequenceOneByOne",QueryCommand:"1125291975"}));
return Ba}pKj(z){let T=!0,ja=0;if(!z)return!1;for(const Ba of z)if(T)ja=Ba.EffectId,T=!1;else if(Ba.EffectId!==ja)return!1;return!0}mKf(z,T,ja){return 0!==ja.SequenceId&&0!==ja.EffectId&&this.Y7a(ja,z)&&(z.fg||2!==ja.EffectType||1!==ja.EffectId&&7!==ja.EffectId)&&(z.bja||this.IKd(z,ja)||this.HKd(z,T,ja))}lKf(z,T,ja){return 0!==ja.SequenceId&&!z.bja&&!z.rd&&0!==ja.EffectId&&this.Y7a(ja,z)&&(z.fg||2!==ja.EffectType||1!==ja.EffectId&&7!==ja.EffectId)&&(z.ll||z.fg||z.isEditable&&0<T.zra(z).length)}HKd(z,
T,ja){return 0!==ja.SequenceId&&!z.fg&&!z.bja&&!z.rd&&0!==ja.EffectId&&this.Y7a(ja,z)&&(2!==ja.EffectType||1!==ja.EffectId&&7!==ja.EffectId)&&(z.ll||z.isEditable&&0<T.zra(z).length)}IKd(z,T){return 0!==T.SequenceId&&z.fg&&0!==T.EffectId&&this.Y7a(T,z)}static $e(z){return li.a.y9c+"_"+z+"_32x32x32"}static l0i(z,T){switch(T){case "Direction":return z.Vn;case "EffectData":return z.xn;default:return null}}static m0i(z,T){switch(T){case "Direction":return $c.il.ga(z);case "EffectData":return $c.ZR.ga(z);
default:return null}}}$c.il=null;$c.ZR=null;$c.Ll=null;Object(h.a)($c,"AnimationHelper",null,[852]);class Gi{constructor(z,T,ja,Ba,Ga,Fb,Rb){this.rD=null;this.bOe=!1;this.eFa=ja;this.sa=z;(this.rta=Ba)&&Ga.execute(tc=>{this.rD=tc});this.xa=Rb;this.ia=T;this.$ja=Fb}selectShape(){this.sa&&!this.sa.PV(this.xa)&&this.sa.selectShape(this.xa,!0)}onVolumeChanged(z){const T={ActionFromPlayer:!0};.2>=z?(T.SourceControlId="SetVolumeLow",this.ia.Ma(Xc.a.eJe,2,T)):.2<z&&.8>z?(T.SourceControlId="SetVolumeMedium",
this.ia.Ma(Xc.a.fJe,2,T)):.8<=z&&(T.SourceControlId="SetVolumeHigh",this.ia.Ma(Xc.a.dJe,2,T));this.selectShape()}onPlayToggled(z){const T={ActionFromPlayer:!0};z?this.ia.Ma(Xc.a.IId,2,T):this.ia.Ma(Xc.a.PAc,2,T);this.selectShape()}onMuteToggled(z){if(z)this.ia.Ma(Xc.a.gJe,2,{ActionFromPlayer:!0,SourceControlId:"SetVolumeMute"});else this.onVolumeChanged(this.xa.media.vlmField);this.selectShape()}onPlayerReadyStateChanged(z){z&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("AudioPlay",
!1))}onMouseHoverStateChanged(z){z||this.sa.C$d(this.xa)||(z=this.OH())&&z.showHidePlayer(!1)}onPlayerClicked(){this.rta&&this.ia.processAction(Xc.a.LIb,2)}onPlayerError(z){Wc.a.J(570783880,822,10,"AudioLibraryCallback::OnPlayerError Error Message: {0}",z);z&&-1<z.indexOf("PIPELINE_ERROR_READ")&&this.eFa.TZd(this.$ja.podSessionId,this.xa).then(T=>{const ja=this.OH();ja&&ja.setAudioSrc(T)})}onKeyDown(z){z===kg.a.rJb?(z=this.OH())&&z.removeFocusFromPlayer():z===kg.a.tq&&(this.bOe=!0)}onBlur(){const z=
this.OH();z&&(this.bOe?z.setFocusOnPlayer():z.removeFocusFromPlayer());this.bOe=!1}OH(){return this.rta&&this.rD?this.rD.OH(this.xa):null}}Object(h.a)(Gi,"AudioLibraryCallback",null,[865]);class Hk{constructor(z,T,ja,Ba,Ga,Fb){this.eFa=z;this.sa=T;this.ia=ja;this.rta=Ba;this.A9a=Fb;this.$ja=Ga}hui(z){return new Gi(this.sa,this.ia,this.eFa,this.rta,this.A9a,this.$ja,z)}}Object(h.a)(Hk,"AudioLibraryCallbackFactory",null,[818]);class Gj{constructor(z,T,ja,Ba){this.volume=0;this.mute=this.rewind=this.repeat=
!1;this.volume=z;this.mute=T;this.repeat=ja;this.rewind=Ba}}Object(h.a)(Gj,"MediaProperties",null,[]);class Hj{constructor(z,T,ja,Ba){this.iXj=z;this.Jle=T;this.eFa=ja;this.$ja=Ba}createAudioManager(z,T,ja){return new Promise((Ba,Ga)=>{this.Jle("audioPlayback").then(()=>{window.self.audioPlayback?(Wc.a.J(573853825,801,50,"audio script is loaded successfully"),Ba(this.iui(z,T,ja))):(Wc.a.J(570783879,801,10,"Audio script is loaded successfully but AudioPlayback namespace cannot be found"),Ga("Audio script is loaded successfully but AudioPlayback namespace cannot be found"))}).catch(Fb=>
{Wc.a.J(573853826,801,10,"Failed to load audio script "+Fb.toString());Ga("Failed to load audio script ")})})}iui(z,T,ja){const Ba=T.media;let Ga=null;Ba&&(Ga=new Gj(Ba.vlmField,Ba.mteField,Ba.repeatField,Ba.rewindField));const Fb=audioPlayback.pptAudioFactoryGlobal.createAudioManager(z,ja,this.iXj.hui(T),Ga);this.eFa.TZd(this.$ja.podSessionId,T).then(Rb=>{Fb&&Fb.setAudioSrc(Rb)});return Fb}}Object(h.a)(Hj,"AudioManagerFactory",null,[819]);var wa=d(1207);class Ma{constructor(){this.mwb=new wa.a}PHk(z,
T){T&&this.mwb.$(T.id,z)}Kyh(z){z&&this.mwb.Kb(z.id)&&(this.mwb.ga(z.id).dispose(),this.mwb.remove(z.id))}OH(z){return z&&this.mwb.Kb(z.id)?this.mwb.ga(z.id):null}}Object(h.a)(Ma,"AudioManagerStore",null,[817]);class hb{TNj(z){return!hb.Urb(hb.wwl)||z>hb.zTe?!0:!1}static Urb(z){return(z=document.getElementById(z))?z:null}}hb.wwl="PptRibbon.Design.ThemeVariants-MaxSize";hb.zTe=4;Object(h.a)(hb,"ThemeHelper",null,[845]);class ub{constructor(){this.Duration=this.Direction=0;this.IsManualAdvance=!1;this.TransitionType=
0}}Object(h.a)(ub,"EditTransitionInfo",null,[]);class na{constructor(){this.next=this.parent=this.rc=this.Ww=this.tc=this.mc=null}}Object(h.a)(na,"Transition",null,[]);class Pa{}Pa.none=0;Pa.NRi=5;Pa.ORi=4;Pa.ijl=1;Pa.Fgj=1;Pa.jai=2;Pa.S6=0;Pa.nPa=1;Pa.uBa=2;Pa.grb=3;Pa.TJc=4;Pa.SJc=5;Pa.VJc=6;Pa.UJc=7;Pa.SNc=2;Pa.bRa=1;Pa.ugj=1;Pa.JIf=0;Pa.bei=1;Pa.aei=2;Pa.wgj=0;Pa.vgj=1;Pa.yfg=2;Pa.Ggj=3;Pa.a2d=0;Pa.M0b=1;Pa.RNc=0;Pa.M6a=1;Pa.Dai=1;Pa.hHf=0;Pa.yqh=2;Pa.ucl=0;Pa.kjl=3;Pa.jjl=1;Pa.wheel=1;Pa.ffh=
29;Pa.B4f=0;Pa.gTi=1;Pa.pTi=2;Pa.ATi=3;Pa.A4f=8;Pa.fTi=9;Pa.oTi=10;Pa.zTi=11;Pa.C4f=12;Pa.jTi=13;Pa.rTi=14;Pa.DTi=15;Pa.D4f=4;Pa.kTi=5;Pa.sTi=6;Pa.ETi=7;Pa.qTi=0;Pa.BTi=1;Pa.uTi=2;Pa.hTi=3;Pa.w4f=4;Pa.CTi=5;Pa.vTi=6;Pa.iTi=7;Object(h.a)(Pa,"TransitionEffectOptions",null,[]);class cb{}cb.none=0;cb.cut=0;cb.random=1;cb.blinds=2;cb.MLd=3;cb.pAa=4;cb.dissolve=5;cb.fade=6;cb.mJa=7;cb.NBe=8;cb.Hmd=9;cb.wipe=10;cb.$lh=11;cb.split=13;cb.$4k=17;cb.e5k=18;cb.wedge=19;cb.push=20;cb.DMd=21;cb.xDf=23;cb.wheel=
26;cb.Xlh=27;cb.Mnc=28;cb.PEb=29;cb.nCa=30;cb.lic=39;cb.QNe=42;cb.flip=43;cb.zL=44;cb.Qxl=47;cb.mUd=48;cb.eSd=49;cb.fBi=50;cb.STe=51;cb.qxk=52;cb.PSi=53;cb.uAi=54;cb.nxe=55;cb.r1g=56;cb.Hwe=57;cb.ZGd=58;cb.uwe=59;cb.morph=60;cb.pan=36;cb.zWd=38;cb.PNd=37;cb.URd=33;cb.window=34;cb.jZb=32;cb.zoom=31;cb.ezl=22;Object(h.a)(cb,"TransitionTypes",null,[]);class R{constructor(z){let T=0;this.Ac=new Rh.a;this.Ac.$("TransitionExisting",Object.assign(new na,{mc:ResourceStrings.L_TransitionExisting,tc:R.Fc("TransitionFlash"),
parent:"TransitionExisting"}));this.Ac.$("TransitionExistingInMenu",Object.assign(new na,{mc:ResourceStrings.L_TransitionExisting,tc:R.Fc("TransitionFlash"),parent:"TransitionExisting"}));this.Ac.$("TransitionNone",Object.assign(new na,{mc:ResourceStrings.L_TransitionNone,tc:R.Fc("TransitionNone"),rc:Object.assign(new ub,{TransitionType:cb.none,Direction:Pa.jai,Duration:0,IsManualAdvance:!0}),parent:"TransitionNone"}));this.Ac.$("TransitionFade",Object.assign(new na,{mc:ResourceStrings.L_TransitionFade,
tc:R.Fc("TransitionFadeSmoothly"),rc:Object.assign(new ub,{TransitionType:cb.xDf,Direction:Pa.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeSmoothly"}));this.Ac.$("TransitionFadeSmoothly",Object.assign(new na,{mc:ResourceStrings.L_TransitionSmoothly,Ww:CommonUIStrings.l_TransitionFadeSmoothlyKeytip,tc:R.Fc("TransitionFadeSmoothly"),rc:Object.assign(new ub,{TransitionType:cb.xDf,Direction:Pa.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeThroughBlack"}));
this.Ac.$("TransitionFadeThroughBlack",Object.assign(new na,{mc:ResourceStrings.L_TransitionThroughBlack,Ww:CommonUIStrings.l_TransitionFadeThroughBlackKeytip,tc:R.Fc("TransitionFadeThroughBlack"),rc:Object.assign(new ub,{TransitionType:cb.fade,Direction:Pa.none,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionFade"}));let ja=[];if(z){ja=z.toLowerCase().split(",");for(let Ba=0;Ba<ja.length;Ba++)ja[Ba]=ja[Ba].trim()}Array.contains(ja,"push")||(this.Ac.$("TransitionPush",Object.assign(new na,{mc:ResourceStrings.L_TransitionPush,
tc:R.Fc("TransitionPushUp"),rc:Object.assign(new ub,{TransitionType:cb.push,Direction:Pa.nPa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromBottom"})),this.Ac.$("TransitionPushFromBottom",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromBottom,Ww:CommonUIStrings.l_TransitionPushFromBottomKeytip,tc:R.Fc("TransitionPushUp"),rc:Object.assign(new ub,{TransitionType:cb.push,Direction:Pa.nPa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromLeft"})),
this.Ac.$("TransitionPushFromLeft",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromLeft,Ww:CommonUIStrings.l_TransitionPushFromLeftKeytip,tc:R.Fc("TransitionPushRight"),rc:Object.assign(new ub,{TransitionType:cb.push,Direction:Pa.uBa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromRight"})),this.Ac.$("TransitionPushFromRight",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromRight,Ww:CommonUIStrings.l_TransitionPushFromRightKeytip,tc:R.Fc("TransitionPushLeft"),
rc:Object.assign(new ub,{TransitionType:cb.push,Direction:Pa.S6,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromTop"})),this.Ac.$("TransitionPushFromTop",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromTop,Ww:CommonUIStrings.l_TransitionPushFromTopKeytip,tc:R.Fc("TransitionPushDown"),rc:Object.assign(new ub,{TransitionType:cb.push,Direction:Pa.grb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush"})));Array.contains(ja,"cut")||(this.Ac.$("TransitionCut",
Object.assign(new na,{mc:ResourceStrings.L_TransitionCut,tc:R.Fc("TransitionCut"),rc:Object.assign(new ub,{TransitionType:cb.cut,Direction:Pa.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutNone"})),this.Ac.$("TransitionCutNone",Object.assign(new na,{mc:ResourceStrings.L_TransitionNone,Ww:CommonUIStrings.l_TransitionCutNoneKeytip,tc:R.Fc("TransitionCut"),rc:Object.assign(new ub,{TransitionType:cb.cut,Direction:Pa.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",
next:"TransitionCutThroughBlack"})),this.Ac.$("TransitionCutThroughBlack",Object.assign(new na,{mc:ResourceStrings.L_TransitionThroughBlack,Ww:CommonUIStrings.l_TransitionCutThroughBlackKeytip,tc:R.Fc("TransitionCutThroughBlack"),rc:Object.assign(new ub,{TransitionType:cb.cut,Direction:Pa.ijl,Duration:500,IsManualAdvance:!0}),parent:"TransitionCut"})));Array.contains(ja,"wipe")||(this.Ac.$("TransitionWipe",Object.assign(new na,{mc:ResourceStrings.L_TransitionWipe,tc:R.Fc("TransitionWipeLeft"),rc:Object.assign(new ub,
{TransitionType:cb.wipe,Direction:Pa.S6,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromRight"})),this.Ac.$("TransitionWipeFromRight",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromRight,Ww:CommonUIStrings.l_TransitionWipeFromRightKeytip,tc:R.Fc("TransitionWipeLeft"),rc:Object.assign(new ub,{TransitionType:cb.wipe,Direction:Pa.S6,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTop"})),this.Ac.$("TransitionWipeFromTop",Object.assign(new na,
{mc:ResourceStrings.L_TransitionFromTop,Ww:CommonUIStrings.l_TransitionWipeFromTopKeytip,tc:R.Fc("TransitionWipeDown"),rc:Object.assign(new ub,{TransitionType:cb.wipe,Direction:Pa.grb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromLeft"})),this.Ac.$("TransitionWipeFromLeft",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromLeft,Ww:CommonUIStrings.l_TransitionWipeFromLeftKeytip,tc:R.Fc("TransitionWipeRight"),rc:Object.assign(new ub,{TransitionType:cb.wipe,
Direction:Pa.uBa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottom"})),this.Ac.$("TransitionWipeFromBottom",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromBottom,Ww:CommonUIStrings.l_TransitionWipeFromBottomKeytip,tc:R.Fc("TransitionWipeUp"),rc:Object.assign(new ub,{TransitionType:cb.wipe,Direction:Pa.nPa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopRight"})),this.Ac.$("TransitionWipeFromTopRight",Object.assign(new na,
{mc:ResourceStrings.L_TransitionFromTopRight,Ww:CommonUIStrings.l_TransitionWipeFromTopRightKeytip,tc:R.Fc("TransitionStripsLeftDown"),rc:Object.assign(new ub,{TransitionType:cb.Hmd,Direction:Pa.VJc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomRight"})),this.Ac.$("TransitionWipeFromBottomRight",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromBottomRight,Ww:CommonUIStrings.l_TransitionWipeFromBottomRightKeytip,tc:R.Fc("TransitionStripsLeftUp"),rc:Object.assign(new ub,
{TransitionType:cb.Hmd,Direction:Pa.TJc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopLeft"})),this.Ac.$("TransitionWipeFromTopLeft",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromTopLeft,Ww:CommonUIStrings.l_TransitionWipeFromTopLeftKeytip,tc:R.Fc("TransitionStripsRightDown"),rc:Object.assign(new ub,{TransitionType:cb.Hmd,Direction:Pa.UJc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomLeft"})),this.Ac.$("TransitionWipeFromBottomLeft",
Object.assign(new na,{mc:ResourceStrings.L_TransitionFromBottomLeft,Ww:CommonUIStrings.l_TransitionWipeFromBottomLeftKeytip,tc:R.Fc("TransitionStripsRightUp"),rc:Object.assign(new ub,{TransitionType:cb.Hmd,Direction:Pa.SJc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe"})));Array.contains(ja,"morph")||(this.Ac.$("TransitionMorph",Object.assign(new na,{mc:ResourceStrings.L_TransitionMorph,tc:R.Fc("TransitionByObject"),rc:Object.assign(new ub,{TransitionType:cb.morph,Direction:Pa.JIf,Duration:2E3,
IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"})),this.Ac.$("TransitionMorphByObject",Object.assign(new na,{mc:ResourceStrings.L_TransitionByObject,Ww:CommonUIStrings.l_TransitionMorphObjectsKeytip,tc:R.Fc("TransitionByObject"),rc:Object.assign(new ub,{TransitionType:cb.morph,Direction:Pa.JIf,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByWord"})),this.Ac.$("TransitionMorphByWord",Object.assign(new na,{mc:ResourceStrings.L_TransitionByWord,
Ww:CommonUIStrings.l_TransitionMorphWordsKeytip,tc:R.Fc("TransitionByWord"),rc:Object.assign(new ub,{TransitionType:cb.morph,Direction:Pa.bei,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByChar"})),this.Ac.$("TransitionMorphByChar",Object.assign(new na,{mc:ResourceStrings.L_TransitionByChar,Ww:CommonUIStrings.l_TransitionMorphCharactersKeytip,tc:R.Fc("TransitionByChar"),rc:Object.assign(new ub,{TransitionType:cb.morph,Direction:Pa.aei,Duration:2E3,IsManualAdvance:!0}),
parent:"TransitionMorph"})));Array.contains(ja,"split")||(this.Ac.$("TransitionSplit",Object.assign(new na,{mc:ResourceStrings.L_TransitionSplit,tc:R.Fc("TransitionSplitOutVertical"),rc:Object.assign(new ub,{TransitionType:cb.split,Direction:Pa.yfg,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalOut"})),this.Ac.$("TransitionSplitVerticalOut",Object.assign(new na,{mc:ResourceStrings.L_TransitionVerticalOut,Ww:CommonUIStrings.l_TransitionSplitVerticalOutKeytip,
tc:R.Fc("TransitionSplitOutVertical"),rc:Object.assign(new ub,{TransitionType:cb.split,Direction:Pa.yfg,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalIn"})),this.Ac.$("TransitionSplitHorizontalIn",Object.assign(new na,{mc:ResourceStrings.L_TransitionHorizontalIn,Ww:CommonUIStrings.l_TransitionSplitHorizontalInKeytip,tc:R.Fc("TransitionSplitInHorizontal"),rc:Object.assign(new ub,{TransitionType:cb.split,Direction:Pa.vgj,Duration:1500,IsManualAdvance:!0}),
parent:"TransitionSplit",next:"TransitionSplitHorizontalOut"})),this.Ac.$("TransitionSplitHorizontalOut",Object.assign(new na,{mc:ResourceStrings.L_TransitionHorizontalOut,Ww:CommonUIStrings.l_TransitionSplitHorizontalOutKeytip,tc:R.Fc("TransitionSplitOutHorizontal"),rc:Object.assign(new ub,{TransitionType:cb.split,Direction:Pa.wgj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalIn"})),this.Ac.$("TransitionSplitVerticalIn",Object.assign(new na,{mc:ResourceStrings.L_TransitionVerticalIn,
Ww:CommonUIStrings.l_TransitionSplitVerticalInKeytip,tc:R.Fc("TransitionSplitInVertical"),rc:Object.assign(new ub,{TransitionType:cb.split,Direction:Pa.Ggj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit"})));if(!Array.contains(ja,"randombars")){this.Ac.$("TransitionRandomBars",Object.assign(new na,{mc:ResourceStrings.L_TransitionRandomBars,tc:R.Fc("TransitionRandomBarsVertical"),rc:Object.assign(new ub,{TransitionType:cb.NBe,Direction:Pa.M6a,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",
next:"TransitionRandomBarsVertical"}));this.Ac.$("TransitionRandomBarsVertical",Object.assign(new na,{mc:ResourceStrings.L_TransitionVertical,Ww:CommonUIStrings.l_TransitionRandomBarsVerticalKeytip,tc:R.Fc("TransitionRandomBarsVertical"),rc:Object.assign(new ub,{TransitionType:cb.NBe,Direction:Pa.M6a,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsHorizontal"}));let Ba,Ga;this.Ac.$("TransitionRandomBarsHorizontal",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionHorizontal,
Ga.Ww=CommonUIStrings.l_TransitionRandomBarsHorizontalKeytip,Ga.tc=R.Fc("TransitionRandomBarsHorizontal"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.NBe,Ba.Direction=Pa.RNc,Ba.Duration=1E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionRandomBars",Ga))}if(!Array.contains(ja,"shape")){let Ba,Ga;this.Ac.$("TransitionShape",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionShape,Ga.tc=R.Fc("TransitionShapeCircle"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.Xlh,Ba.Direction=Pa.none,Ba.Duration=800,Ba.IsManualAdvance=
!0,Ba),Ga.parent="TransitionShape",Ga.next="TransitionShapeCircle",Ga));let Fb,Rb;this.Ac.$("TransitionShapeCircle",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionCircle,Rb.Ww=CommonUIStrings.l_TransitionShapeCircleKeytip,Rb.tc=R.Fc("TransitionShapeCircle"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.Xlh,Fb.Direction=Pa.none,Fb.Duration=800,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionShape",Rb.next="TransitionShapeDiamond",Rb));let tc,Ac;this.Ac.$("TransitionShapeDiamond",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionDiamond,
Ac.Ww=CommonUIStrings.l_TransitionShapeDiamondKeytip,Ac.tc=R.Fc("TransitionShapeDiamond"),Ac.rc=(tc=new ub,tc.TransitionType=cb.$4k,tc.Direction=Pa.none,tc.Duration=800,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionShape",Ac.next="TransitionShapePlus",Ac));let kd,nd;this.Ac.$("TransitionShapePlus",(nd=new na,nd.mc=ResourceStrings.L_TransitionPlus,nd.Ww=CommonUIStrings.l_TransitionShapePlusKeytip,nd.tc=R.Fc("TransitionShapePlus"),nd.rc=(kd=new ub,kd.TransitionType=cb.e5k,kd.Direction=Pa.none,kd.Duration=
1E3,kd.IsManualAdvance=!0,kd),nd.parent="TransitionShape",nd.next="TransitionShapeIn",nd));let Bd,Zd;this.Ac.$("TransitionShapeIn",(Zd=new na,Zd.mc=ResourceStrings.L_TransitionIn,Zd.Ww=CommonUIStrings.l_TransitionShapeInKeytip,Zd.tc=R.Fc("TransitionBoxIn"),Zd.rc=(Bd=new ub,Bd.TransitionType=cb.$lh,Bd.Direction=Pa.M0b,Bd.Duration=1200,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionShape",Zd.next="TransitionShapeOut",Zd));let df,Ke;this.Ac.$("TransitionShapeOut",(Ke=new na,Ke.mc=ResourceStrings.L_TransitionOut,
Ke.Ww=CommonUIStrings.l_TransitionShapeOutKeytip,Ke.tc=R.Fc("TransitionBoxOut"),Ke.rc=(df=new ub,df.TransitionType=cb.$lh,df.Direction=Pa.a2d,df.Duration=1200,df.IsManualAdvance=!0,df),Ke.parent="TransitionShape",Ke))}if(!Array.contains(ja,"reveal")){let Ba,Ga;this.Ac.$("TransitionReveal",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionReveal,Ga.tc=R.Fc("TransitionRevealSmoothlyFromRight"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.lic,Ba.Direction=Pa.yqh,Ba.Duration=3400,Ba.IsManualAdvance=!0,Ba),Ga.parent=
"TransitionReveal",Ga.next="TransitionRevealSmoothlyFromRight",Ga));let Fb,Rb;this.Ac.$("TransitionRevealSmoothlyFromRight",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionSmoothlyFromRight,Rb.tc=R.Fc("TransitionRevealSmoothlyFromRight"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.lic,Fb.Direction=Pa.yqh,Fb.Duration=3400,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionReveal",Rb.next="TransitionRevealSmoothlyFromLeft",Rb));let tc,Ac;this.Ac.$("TransitionRevealSmoothlyFromLeft",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionSmoothlyFromLeft,
Ac.tc=R.Fc("TransitionRevealSmoothlyFromLeft"),Ac.rc=(tc=new ub,tc.TransitionType=cb.lic,tc.Direction=Pa.ucl,tc.Duration=3400,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionReveal",Ac.next="TransitionRevealFromRight",Ac));let kd,nd;this.Ac.$("TransitionRevealFromRight",(nd=new na,nd.mc=ResourceStrings.L_TransitionThroughBlackFromRight,nd.tc=R.Fc("TransitionRevealFromRight"),nd.rc=(kd=new ub,kd.TransitionType=cb.lic,kd.Direction=Pa.kjl,kd.Duration=3400,kd.IsManualAdvance=!0,kd),nd.parent="TransitionReveal",
nd.next="TransitionRevealFromLeft",nd));let Bd,Zd;this.Ac.$("TransitionRevealFromLeft",(Zd=new na,Zd.mc=ResourceStrings.L_TransitionThroughBlackFromLeft,Zd.tc=R.Fc("TransitionRevealFromLeft"),Zd.rc=(Bd=new ub,Bd.TransitionType=cb.lic,Bd.Direction=Pa.jjl,Bd.Duration=3400,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionReveal",Zd))}if(!Array.contains(ja,"cover")){let Ba,Ga;this.Ac.$("TransitionCover",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionCover,Ga.tc=R.Fc("TransitionCoverLeft"),Ga.rc=(Ba=new ub,
Ba.TransitionType=cb.pAa,Ba.Direction=Pa.S6,Ba.Duration=1E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionCover",Ga.next="TransitionCoverFromRight",Ga));let Fb,Rb;this.Ac.$("TransitionCoverFromRight",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionFromRight,Rb.tc=R.Fc("TransitionCoverLeft"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.pAa,Fb.Direction=Pa.S6,Fb.Duration=1E3,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionCover",Rb.next="TransitionCoverFromTop",Rb));let tc,Ac;this.Ac.$("TransitionCoverFromTop",
(Ac=new na,Ac.mc=ResourceStrings.L_TransitionFromTop,Ac.tc=R.Fc("TransitionCoverDown"),Ac.rc=(tc=new ub,tc.TransitionType=cb.pAa,tc.Direction=Pa.grb,tc.Duration=1E3,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionCover",Ac.next="TransitionCoverFromLeft",Ac));let kd,nd;this.Ac.$("TransitionCoverFromLeft",(nd=new na,nd.mc=ResourceStrings.L_TransitionFromLeft,nd.tc=R.Fc("TransitionCoverRight"),nd.rc=(kd=new ub,kd.TransitionType=cb.pAa,kd.Direction=Pa.uBa,kd.Duration=1E3,kd.IsManualAdvance=!0,kd),nd.parent=
"TransitionCover",nd.next="TransitionCoverFromBottom",nd));let Bd,Zd;this.Ac.$("TransitionCoverFromBottom",(Zd=new na,Zd.mc=ResourceStrings.L_TransitionFromBottom,Zd.tc=R.Fc("TransitionCoverUp"),Zd.rc=(Bd=new ub,Bd.TransitionType=cb.pAa,Bd.Direction=Pa.nPa,Bd.Duration=1E3,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionCover",Zd.next="TransitionCoverFromTopRight",Zd));let df,Ke;this.Ac.$("TransitionCoverFromTopRight",(Ke=new na,Ke.mc=ResourceStrings.L_TransitionFromTopRight,Ke.tc=R.Fc("TransitionCoverLeftDown"),
Ke.rc=(df=new ub,df.TransitionType=cb.pAa,df.Direction=Pa.VJc,df.Duration=1E3,df.IsManualAdvance=!0,df),Ke.parent="TransitionCover",Ke.next="TransitionCoverFromBottomRight",Ke));let zf,Sf;this.Ac.$("TransitionCoverFromBottomRight",(Sf=new na,Sf.mc=ResourceStrings.L_TransitionFromBottomRight,Sf.tc=R.Fc("TransitionCoverLeftUp"),Sf.rc=(zf=new ub,zf.TransitionType=cb.pAa,zf.Direction=Pa.TJc,zf.Duration=1E3,zf.IsManualAdvance=!0,zf),Sf.parent="TransitionCover",Sf.next="TransitionCoverFromTopLeft",Sf));
let Lh,Mh;this.Ac.$("TransitionCoverFromTopLeft",(Mh=new na,Mh.mc=ResourceStrings.L_TransitionFromTopLeft,Mh.tc=R.Fc("TransitionCoverRightDown"),Mh.rc=(Lh=new ub,Lh.TransitionType=cb.pAa,Lh.Direction=Pa.UJc,Lh.Duration=1E3,Lh.IsManualAdvance=!0,Lh),Mh.parent="TransitionCover",Mh.next="TransitionCoverFromBottomLeft",Mh));let si,Yh;this.Ac.$("TransitionCoverFromBottomLeft",(Yh=new na,Yh.mc=ResourceStrings.L_TransitionFromBottomLeft,Yh.tc=R.Fc("TransitionCoverRightUp"),Yh.rc=(si=new ub,si.TransitionType=
cb.pAa,si.Direction=Pa.SJc,si.Duration=1E3,si.IsManualAdvance=!0,si),Yh.parent="TransitionCover",Yh))}if(!Array.contains(ja,"uncover")){let Ba,Ga;this.Ac.$("TransitionUncover",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionUncover,Ga.tc=R.Fc("TransitionUncoverLeft"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.mJa,Ba.Direction=Pa.S6,Ba.Duration=750,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionUncover",Ga.next="TransitionUncoverFromRight",Ga));let Fb,Rb;this.Ac.$("TransitionUncoverFromRight",(Rb=new na,Rb.mc=
ResourceStrings.L_TransitionFromRight,Rb.tc=R.Fc("TransitionUncoverLeft"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.mJa,Fb.Direction=Pa.S6,Fb.Duration=750,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionUncover",Rb.next="TransitionUncoverFromTop",Rb));let tc,Ac;this.Ac.$("TransitionUncoverFromTop",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionFromTop,Ac.tc=R.Fc("TransitionUncoverDown"),Ac.rc=(tc=new ub,tc.TransitionType=cb.mJa,tc.Direction=Pa.grb,tc.Duration=750,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionUncover",
Ac.next="TransitionUncoverFromLeft",Ac));let kd,nd;this.Ac.$("TransitionUncoverFromLeft",(nd=new na,nd.mc=ResourceStrings.L_TransitionFromLeft,nd.tc=R.Fc("TransitionUncoverRight"),nd.rc=(kd=new ub,kd.TransitionType=cb.mJa,kd.Direction=Pa.uBa,kd.Duration=750,kd.IsManualAdvance=!0,kd),nd.parent="TransitionUncover",nd.next="TransitionUncoverFromBottom",nd));let Bd,Zd;this.Ac.$("TransitionUncoverFromBottom",(Zd=new na,Zd.mc=ResourceStrings.L_TransitionFromBottom,Zd.tc=R.Fc("TransitionUncoverUp"),Zd.rc=
(Bd=new ub,Bd.TransitionType=cb.mJa,Bd.Direction=Pa.nPa,Bd.Duration=750,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionUncover",Zd.next="TransitionUncoverFromTopRight",Zd));this.Ac.$("TransitionUncoverFromTopRight",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromTopRight,tc:R.Fc("TransitionUncoverLeftDown"),rc:Object.assign(new ub,{TransitionType:cb.mJa,Direction:Pa.VJc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomRight"}));this.Ac.$("TransitionUncoverFromBottomRight",
Object.assign(new na,{mc:ResourceStrings.L_TransitionFromBottomRight,tc:R.Fc("TransitionUncoverLeftUp"),rc:Object.assign(new ub,{TransitionType:cb.mJa,Direction:Pa.TJc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromTopLeft"}));this.Ac.$("TransitionUncoverFromTopLeft",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromTopLeft,tc:R.Fc("TransitionUncoverRightDown"),rc:Object.assign(new ub,{TransitionType:cb.mJa,Direction:Pa.UJc,Duration:750,IsManualAdvance:!0}),
parent:"TransitionUncover",next:"TransitionUncoverFromBottomLeft"}));this.Ac.$("TransitionUncoverFromBottomLeft",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromBottomLeft,tc:R.Fc("TransitionUncoverRightUp"),rc:Object.assign(new ub,{TransitionType:cb.mJa,Direction:Pa.SJc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover"}))}if(!Array.contains(ja,"menusectionexciting")){if(!Array.contains(ja,"fallover")){this.Ac.$("TransitionFallOver",Object.assign(new na,{mc:ResourceStrings.L_TransitionFallOver,
tc:R.Fc("TransitionFallOverLeft"),rc:Object.assign(new ub,{TransitionType:cb.mUd,Direction:Pa.none,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionFallOver",next:"TransitionFallOverLeft"}));let Ba,Ga;this.Ac.$("TransitionFallOverLeft",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionGoLeft,Ga.tc=R.Fc("TransitionFallOverLeft"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.mUd,Ba.Direction=Pa.none,Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionFallOver",Ga.next="TransitionFallOverRight",Ga));
let Fb,Rb;this.Ac.$("TransitionFallOverRight",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionGoRight,Rb.tc=R.Fc("TransitionFallOverRight"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.mUd,Fb.Direction=Pa.bRa,Fb.Duration=2E3,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionFallOver",Rb))}if(!Array.contains(ja,"drape")){let Ba,Ga;this.Ac.$("TransitionDrape",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionDrape,Ga.tc=R.Fc("TransitionDrapeLeft"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.eSd,Ba.Direction=Pa.none,Ba.Duration=
2E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionDrape",Ga.next="TransitionDrapeLeft",Ga));let Fb,Rb;this.Ac.$("TransitionDrapeLeft",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionGoLeft,Rb.tc=R.Fc("TransitionDrapeLeft"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.eSd,Fb.Direction=Pa.none,Fb.Duration=2E3,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionDrape",Rb.next="TransitionDrapeRight",Rb));let tc,Ac;this.Ac.$("TransitionDrapeRight",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionGoRight,Ac.tc=R.Fc("TransitionDrapeRight"),
Ac.rc=(tc=new ub,tc.TransitionType=cb.eSd,tc.Direction=Pa.bRa,tc.Duration=2E3,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionDrape",Ac))}if(!Array.contains(ja,"curtains")){let Ba,Ga;this.Ac.$("TransitionCurtains",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionCurtains,Ga.tc=R.Fc("TransitionCurtains"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.fBi,Ba.Direction=Pa.none,Ba.Duration=6E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionCurtains",Ga))}if(!Array.contains(ja,"wind")){let Ba,Ga;this.Ac.$("TransitionWind",
(Ga=new na,Ga.mc=ResourceStrings.L_TransitionWind,Ga.tc=R.Fc("TransitionWindRight"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.STe,Ba.Direction=Pa.none,Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionWind",Ga.next="TransitionWindRight",Ga));let Fb,Rb;this.Ac.$("TransitionWindRight",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionGoRight,Rb.tc=R.Fc("TransitionWindRight"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.STe,Fb.Direction=Pa.none,Fb.Duration=2E3,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionWind",
Rb.next="TransitionWindLeft",Rb));let tc,Ac;this.Ac.$("TransitionWindLeft",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionGoLeft,Ac.tc=R.Fc("TransitionWindLeft"),Ac.rc=(tc=new ub,tc.TransitionType=cb.STe,tc.Direction=Pa.bRa,tc.Duration=2E3,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionWind",Ac))}if(!Array.contains(ja,"prestige")){let Ba,Ga;this.Ac.$("TransitionPrestige",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionPrestige,Ga.tc=R.Fc("TransitionPrestige"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.qxk,
Ba.Direction=Pa.none,Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionPrestige",Ga))}if(!Array.contains(ja,"fracture")){let Ba,Ga;this.Ac.$("TransitionFracture",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionFracture,Ga.tc=R.Fc("TransitionFracture"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.PSi,Ba.Direction=Pa.none,Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionFracture",Ga))}if(!Array.contains(ja,"crush")){let Ba,Ga;this.Ac.$("TransitionCrush",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionCrush,
Ga.tc=R.Fc("TransitionCrush"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.uAi,Ba.Direction=Pa.none,Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionCrush",Ga))}if(!Array.contains(ja,"peeloff")){let Ba,Ga;this.Ac.$("TransitionPeelOff",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionPeelOff,Ga.tc=R.Fc("TransitionPeelOffLeft"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.nxe,Ba.Direction=Pa.none,Ba.Duration=1250,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionPeelOff",Ga.next="TransitionPeelOffLeft",Ga));
let Fb,Rb;this.Ac.$("TransitionPeelOffLeft",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionGoLeft,Rb.tc=R.Fc("TransitionPeelOffLeft"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.nxe,Fb.Direction=Pa.none,Fb.Duration=1250,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionPeelOff",Rb.next="TransitionPeelOffRight",Rb));let tc,Ac;this.Ac.$("TransitionPeelOffRight",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionGoRight,Ac.tc=R.Fc("TransitionPeelOffRight"),Ac.rc=(tc=new ub,tc.TransitionType=cb.nxe,tc.Direction=Pa.bRa,
tc.Duration=1250,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionPeelOff",Ac))}if(!Array.contains(ja,"pagecurl")){let Ba,Ga;this.Ac.$("TransitionPageCurl",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionPageCurl,Ga.tc=R.Fc("TransitionTwoPageCurlFromRight"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.Hwe,Ba.Direction=Pa.none,Ba.Duration=1250,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionPageCurl",Ga.next="TransitionPageCurlDoubleLeft",Ga));let Fb,Rb;this.Ac.$("TransitionPageCurlDoubleLeft",(Rb=new na,Rb.mc=
ResourceStrings.L_TransitionEffectOptionDoubleLeft,Rb.tc=R.Fc("TransitionTwoPageCurlFromRight"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.Hwe,Fb.Direction=Pa.none,Fb.Duration=1250,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionPageCurl",Rb.next="TransitionPageCurlDoubleRight",Rb));let tc,Ac;this.Ac.$("TransitionPageCurlDoubleRight",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionEffectOptionDoubleRight,Ac.tc=R.Fc("TransitionTwoPageCurlFromLeft"),Ac.rc=(tc=new ub,tc.TransitionType=cb.Hwe,tc.Direction=Pa.bRa,
tc.Duration=1250,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionPageCurl",Ac.next="TransitionPageCurlSingleLeft",Ac));let kd,nd;this.Ac.$("TransitionPageCurlSingleLeft",(nd=new na,nd.mc=ResourceStrings.L_TransitionEffectOptionSingleLeft,nd.tc=R.Fc("TransitionPageCurlFromRight"),nd.rc=(kd=new ub,kd.TransitionType=cb.r1g,kd.Direction=Pa.none,kd.Duration=1250,kd.IsManualAdvance=!0,kd),nd.parent="TransitionPageCurl",nd.next="TransitionPageCurlSingleRight",nd));let Bd,Zd;this.Ac.$("TransitionPageCurlSingleRight",
(Zd=new na,Zd.mc=ResourceStrings.L_TransitionEffectOptionSingleRight,Zd.tc=R.Fc("TransitionPageCurlFromLeft"),Zd.rc=(Bd=new ub,Bd.TransitionType=cb.r1g,Bd.Direction=Pa.bRa,Bd.Duration=1250,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionPageCurl",Zd))}if(!Array.contains(ja,"airplane")){let Ba,Ga;this.Ac.$("TransitionAirplane",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionAirplane,Ga.tc=R.Fc("TransitionAirplaneRight"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.ZGd,Ba.Direction=Pa.none,Ba.Duration=1250,Ba.IsManualAdvance=
!0,Ba),Ga.parent="TransitionAirplane",Ga.next="TransitionAirplaneRight",Ga));let Fb,Rb;this.Ac.$("TransitionAirplaneRight",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionGoRight,Rb.tc=R.Fc("TransitionAirplaneRight"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.ZGd,Fb.Direction=Pa.none,Fb.Duration=1250,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionAirplane",Rb.next="TransitionAirplaneLeft",Rb));let tc,Ac;this.Ac.$("TransitionAirplaneLeft",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionGoLeft,Ac.tc=R.Fc("TransitionAirplaneLeft"),
Ac.rc=(tc=new ub,tc.TransitionType=cb.ZGd,tc.Direction=Pa.bRa,tc.Duration=1250,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionAirplane",Ac))}if(!Array.contains(ja,"origami")){let Ba,Ga;this.Ac.$("TransitionOrigami",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionOrigami,Ga.tc=R.Fc("TransitionOrigamiRight"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.uwe,Ba.Direction=Pa.none,Ba.Duration=3250,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionOrigami",Ga.next="TransitionOrigamiRight",Ga));let Fb,Rb;this.Ac.$("TransitionOrigamiRight",
(Rb=new na,Rb.mc=ResourceStrings.L_TransitionGoRight,Rb.tc=R.Fc("TransitionOrigamiRight"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.uwe,Fb.Direction=Pa.none,Fb.Duration=3250,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionOrigami",Rb.next="TransitionOrigamiLeft",Rb));let tc,Ac;this.Ac.$("TransitionOrigamiLeft",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionGoLeft,Ac.tc=R.Fc("TransitionOrigamiLeft"),Ac.rc=(tc=new ub,tc.TransitionType=cb.uwe,tc.Direction=Pa.bRa,tc.Duration=3250,tc.IsManualAdvance=!0,tc),Ac.parent=
"TransitionOrigami",Ac))}Array.contains(ja,"dissolve")||this.Ac.$("TransitionDissolve",Object.assign(new na,{mc:ResourceStrings.L_TransitionDissolve,tc:R.Fc("TransitionDissolve"),rc:Object.assign(new ub,{TransitionType:cb.dissolve,Direction:Pa.none,Duration:1200,IsManualAdvance:!0}),parent:"TransitionDissolve"}));Array.contains(ja,"checker")||(this.Ac.$("TransitionChecker",Object.assign(new na,{mc:ResourceStrings.L_TransitionChecker,tc:R.Fc("TransitionCheckerboardAcross"),rc:Object.assign(new ub,
{TransitionType:cb.MLd,Direction:Pa.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromLeft"})),this.Ac.$("TransitionCheckerFromLeft",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromLeft,tc:R.Fc("TransitionCheckerboardAcross"),rc:Object.assign(new ub,{TransitionType:cb.MLd,Direction:Pa.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromTop"})),this.Ac.$("TransitionCheckerFromTop",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromTop,
tc:R.Fc("TransitionCheckerboardDown"),rc:Object.assign(new ub,{TransitionType:cb.MLd,Direction:Pa.ugj,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker"})));if(!Array.contains(ja,"blinds")){this.Ac.$("TransitionBlinds",Object.assign(new na,{mc:ResourceStrings.L_TransitionBlinds,tc:R.Fc("TransitionBlindsVertical"),rc:Object.assign(new ub,{TransitionType:cb.blinds,Direction:Pa.hHf,Duration:1600,IsManualAdvance:!0}),parent:"TransitionBlinds",next:"TransitionBlindsVertical"}));let Ba,Ga;this.Ac.$("TransitionBlindsVertical",
(Ga=new na,Ga.mc=ResourceStrings.L_TransitionVertical,Ga.tc=R.Fc("TransitionBlindsVertical"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.blinds,Ba.Direction=Pa.hHf,Ba.Duration=1600,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionBlinds",Ga.next="TransitionBlindsHorizontal",Ga));let Fb,Rb;this.Ac.$("TransitionBlindsHorizontal",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionHorizontal,Rb.tc=R.Fc("TransitionBlindsHorizontal"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.blinds,Fb.Direction=Pa.Dai,Fb.Duration=1600,Fb.IsManualAdvance=
!0,Fb),Rb.parent="TransitionBlinds",Rb))}if(!Array.contains(ja,"wheel")){let Ba,Ga;this.Ac.$("TransitionWheel",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionWheel,Ga.tc=R.Fc("TransitionWheelClockwise1"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.wheel,Ba.Direction=Pa.wheel,Ba.Duration=1E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionWheel",Ga.next="TransitionWheelClockwise",Ga));let Fb,Rb;this.Ac.$("TransitionWheelClockwise",(Rb=new na,Rb.mc=ResourceStrings.l_TransitionWheelClockWise,Rb.tc=R.Fc("TransitionWheelClockwise1"),
Rb.rc=(Fb=new ub,Fb.TransitionType=cb.wheel,Fb.Direction=Pa.wheel,Fb.Duration=1E3,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionWheel",Rb.next="TransitionWheelCounterclockwise",Rb));let tc,Ac;this.Ac.$("TransitionWheelCounterclockwise",(Ac=new na,Ac.mc=ResourceStrings.l_TransitionWheelCounterClockWise,Ac.tc=R.Fc("TransitionWheelCounterclockwise1"),Ac.rc=(tc=new ub,tc.TransitionType=cb.Qxl,tc.Direction=Pa.wheel,tc.Duration=1E3,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionWheel",Ac.next="TransitionWheelWedge",
Ac));let kd,nd;this.Ac.$("TransitionWheelWedge",(nd=new na,nd.mc=ResourceStrings.l_TransitionWheelWedge,nd.tc=R.Fc("TransitionWedge"),nd.rc=(kd=new ub,kd.TransitionType=cb.wedge,kd.Direction=Pa.none,kd.Duration=1E3,kd.IsManualAdvance=!0,kd),nd.parent="TransitionWheel",nd))}if(!Array.contains(ja,"ripple")){let Ba,Ga;this.Ac.$("TransitionRipple",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionRipple,Ga.tc=R.Fc("TransitionRipple"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.PEb,Ba.Direction=Pa.ffh,Ba.Duration=
1400,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionRipple",Ga.next="TransitionRippleCenter",Ga));let Fb,Rb;this.Ac.$("TransitionRippleCenter",(Rb=new na,Rb.mc=ResourceStrings.L_EffectOptionsDirectionCenter,Rb.tc=R.Fc("TransitionRipple"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.PEb,Fb.Direction=Pa.ffh,Fb.Duration=1400,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionRipple",Rb.next="TransitionRippleBottomLeft",Rb));let tc,Ac;this.Ac.$("TransitionRippleBottomLeft",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionFromBottomLeft,
Ac.tc=R.Fc("TransitionRippleBottomLeft"),Ac.rc=(tc=new ub,tc.TransitionType=cb.PEb,tc.Direction=Pa.SJc,tc.Duration=1500,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionRipple",Ac.next="TransitionRippleBottomRight",Ac));let kd,nd;this.Ac.$("TransitionRippleBottomRight",(nd=new na,nd.mc=ResourceStrings.L_TransitionFromBottomRight,nd.tc=R.Fc("TransitionRippleBottomRight"),nd.rc=(kd=new ub,kd.TransitionType=cb.PEb,kd.Direction=Pa.TJc,kd.Duration=1500,kd.IsManualAdvance=!0,kd),nd.parent="TransitionRipple",
nd.next="TransitionRippleTopRight",nd));let Bd,Zd;this.Ac.$("TransitionRippleTopRight",(Zd=new na,Zd.mc=ResourceStrings.L_TransitionFromTopRight,Zd.tc=R.Fc("TransitionRippleTopRight"),Zd.rc=(Bd=new ub,Bd.TransitionType=cb.PEb,Bd.Direction=Pa.VJc,Bd.Duration=1500,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionRipple",Zd.next="TransitionRippleTopLeft",Zd));let df,Ke;this.Ac.$("TransitionRippleTopLeft",(Ke=new na,Ke.mc=ResourceStrings.L_TransitionFromTopLeft,Ke.tc=R.Fc("TransitionRippleTopLeft"),Ke.rc=
(df=new ub,df.TransitionType=cb.PEb,df.Direction=Pa.UJc,df.Duration=1500,df.IsManualAdvance=!0,df),Ke.parent="TransitionRipple",Ke))}if(!Array.contains(ja,"glitter")){let Ba,Ga;this.Ac.$("TransitionGlitter",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionGlitter,Ga.tc=R.Fc("TransitionGlitterHexagonLeft"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.nCa,Ba.Direction=Pa.w4f,Ba.Duration=3900,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionGlitter",Ga.next="TransitionGlitterHexagonLeft",Ga));let Fb,Rb;this.Ac.$("TransitionGlitterHexagonLeft",
(Rb=new na,Rb.mc=ResourceStrings.L_TransitionHexagonsFromLeft,Rb.tc=R.Fc("TransitionGlitterHexagonLeft"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.nCa,Fb.Direction=Pa.w4f,Fb.Duration=3900,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionGlitter",Rb.next="TransitionGlitterHexagonTop",Rb));let tc,Ac;this.Ac.$("TransitionGlitterHexagonTop",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionHexagonsFromTop,Ac.tc=R.Fc("TransitionGlitterHexagonTop"),Ac.rc=(tc=new ub,tc.TransitionType=cb.nCa,tc.Direction=Pa.CTi,tc.Duration=
3900,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionGlitter",Ac.next="TransitionGlitterHexagonRight",Ac));let kd,nd;this.Ac.$("TransitionGlitterHexagonRight",(nd=new na,nd.mc=ResourceStrings.L_TransitionHexagonsFromRight,nd.tc=R.Fc("TransitionGlitterHexagonRight"),nd.rc=(kd=new ub,kd.TransitionType=cb.nCa,kd.Direction=Pa.vTi,kd.Duration=3900,kd.IsManualAdvance=!0,kd),nd.parent="TransitionGlitter",nd.next="TransitionGlitterHexagonBottom",nd));let Bd,Zd;this.Ac.$("TransitionGlitterHexagonBottom",(Zd=
new na,Zd.mc=ResourceStrings.L_TransitionHexagonsFromBottom,Zd.tc=R.Fc("TransitionGlitterHexagonBottom"),Zd.rc=(Bd=new ub,Bd.TransitionType=cb.nCa,Bd.Direction=Pa.iTi,Bd.Duration=3900,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionGlitter",Zd.next="TransitionGlitterDiamondLeft",Zd));let df,Ke;this.Ac.$("TransitionGlitterDiamondLeft",(Ke=new na,Ke.mc=ResourceStrings.L_TransitionDiamondsFromLeft,Ke.tc=R.Fc("TransitionGlitterDiamondLeft"),Ke.rc=(df=new ub,df.TransitionType=cb.nCa,df.Direction=Pa.qTi,
df.Duration=3900,df.IsManualAdvance=!0,df),Ke.parent="TransitionGlitter",Ke.next="TransitionGlitterDiamondTop",Ke));let zf,Sf;this.Ac.$("TransitionGlitterDiamondTop",(Sf=new na,Sf.mc=ResourceStrings.L_TransitionDiamondsFromTop,Sf.tc=R.Fc("TransitionGlitterDiamondTop"),Sf.rc=(zf=new ub,zf.TransitionType=cb.nCa,zf.Direction=Pa.BTi,zf.Duration=3900,zf.IsManualAdvance=!0,zf),Sf.parent="TransitionGlitter",Sf.next="TransitionGlitterDiamondRight",Sf));let Lh,Mh;this.Ac.$("TransitionGlitterDiamondRight",
(Mh=new na,Mh.mc=ResourceStrings.L_TransitionDiamondsFromRight,Mh.tc=R.Fc("TransitionGlitterDiamondRight"),Mh.rc=(Lh=new ub,Lh.TransitionType=cb.nCa,Lh.Direction=Pa.uTi,Lh.Duration=3900,Lh.IsManualAdvance=!0,Lh),Mh.parent="TransitionGlitter",Mh.next="TransitionGlitterDiamondBottom",Mh));let si,Yh;this.Ac.$("TransitionGlitterDiamondBottom",(Yh=new na,Yh.mc=ResourceStrings.L_TransitionDiamondsFromBottom,Yh.tc=R.Fc("TransitionGlitterDiamondBottom"),Yh.rc=(si=new ub,si.TransitionType=cb.nCa,si.Direction=
Pa.hTi,si.Duration=3900,si.IsManualAdvance=!0,si),Yh.parent="TransitionGlitter",Yh))}if(!Array.contains(ja,"vortex")){let Ba,Ga;this.Ac.$("TransitionVortex",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionVortex,Ga.tc=R.Fc("TransitionVortexFromLeft"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.Mnc,Ba.Direction=Pa.uBa,Ba.Duration=4E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionVortex",Ga.next="TransitionVortexFromLeft",Ga));let Fb,Rb;this.Ac.$("TransitionVortexFromLeft",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionFromLeft,
Rb.tc=R.Fc("TransitionVortexFromLeft"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.Mnc,Fb.Direction=Pa.uBa,Fb.Duration=4E3,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionVortex",Rb.next="TransitionVortexFromTop",Rb));let tc,Ac;this.Ac.$("TransitionVortexFromTop",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionFromTop,Ac.tc=R.Fc("TransitionVortexFromTop"),Ac.rc=(tc=new ub,tc.TransitionType=cb.Mnc,tc.Direction=Pa.grb,tc.Duration=4E3,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionVortex",Ac.next="TransitionVortexFromRight",
Ac));let kd,nd;this.Ac.$("TransitionVortexFromRight",(nd=new na,nd.mc=ResourceStrings.L_TransitionFromRight,nd.tc=R.Fc("TransitionVortexFromRight"),nd.rc=(kd=new ub,kd.TransitionType=cb.Mnc,kd.Direction=Pa.S6,kd.Duration=4E3,kd.IsManualAdvance=!0,kd),nd.parent="TransitionVortex",nd.next="TransitionVortexFromBottom",nd));let Bd,Zd;this.Ac.$("TransitionVortexFromBottom",(Zd=new na,Zd.mc=ResourceStrings.L_TransitionFromBottom,Zd.tc=R.Fc("TransitionVortexFromBottom"),Zd.rc=(Bd=new ub,Bd.TransitionType=
cb.Mnc,Bd.Direction=Pa.nPa,Bd.Duration=4E3,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionVortex",Zd))}Array.contains(ja,"switch")||(this.Ac.$("TransitionSwitch",Object.assign(new na,{mc:ResourceStrings.L_TransitionSwitch,tc:R.Fc("TransitionSwitchRight"),rc:Object.assign(new ub,{TransitionType:cb.QNe,Direction:Pa.SNc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchRight"})),this.Ac.$("TransitionSwitchRight",Object.assign(new na,{mc:ResourceStrings.L_TransitionGoRight,
tc:R.Fc("TransitionSwitchRight"),rc:Object.assign(new ub,{TransitionType:cb.QNe,Direction:Pa.SNc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchLeft"})),this.Ac.$("TransitionSwitchLeft",Object.assign(new na,{mc:ResourceStrings.L_TransitionGoLeft,tc:R.Fc("TransitionSwitchLeft"),rc:Object.assign(new ub,{TransitionType:cb.QNe,Direction:Pa.none,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch"})));if(!Array.contains(ja,"flip")){this.Ac.$("TransitionFlip",
Object.assign(new na,{mc:ResourceStrings.L_TransitionFlip,tc:R.Fc("TransitionFlipRight"),rc:Object.assign(new ub,{TransitionType:cb.flip,Direction:Pa.SNc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipRight"}));this.Ac.$("TransitionFlipRight",Object.assign(new na,{mc:ResourceStrings.L_TransitionGoRight,tc:R.Fc("TransitionFlipRight"),rc:Object.assign(new ub,{TransitionType:cb.flip,Direction:Pa.SNc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipLeft"}));
let Ba,Ga;this.Ac.$("TransitionFlipLeft",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionGoLeft,Ga.tc=R.Fc("TransitionFlipLeft"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.flip,Ba.Direction=Pa.none,Ba.Duration=1250,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionFlip",Ga))}if(!Array.contains(ja,"galleryicon")){let Ba,Ga;this.Ac.$("TransitionGalleryIcon",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionGallery,Ga.tc=R.Fc("TransitionGalleryRight"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.zWd,Ba.Direction=Pa.S6,Ba.Duration=
1600,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionGalleryIcon",Ga.next="TransitionGalleryIconFromRight",Ga));let Fb,Rb;this.Ac.$("TransitionGalleryIconFromRight",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionFromRight,Rb.tc=R.Fc("TransitionGalleryRight"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.zWd,Fb.Direction=Pa.S6,Fb.Duration=1600,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionGalleryIcon",Rb.next="TransitionGalleryIconFromLeft",Rb));let tc,Ac;this.Ac.$("TransitionGalleryIconFromLeft",(Ac=new na,
Ac.mc=ResourceStrings.L_TransitionFromLeft,Ac.tc=R.Fc("TransitionGalleryLeft"),Ac.rc=(tc=new ub,tc.TransitionType=cb.zWd,tc.Direction=Pa.uBa,tc.Duration=1600,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionGalleryIcon",Ac))}if(!Array.contains(ja,"cube")){let Ba,Ga;this.Ac.$("TransitionCube",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionCube,Ga.tc=R.Fc("TransitionCubeFromRight"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.zL,Ba.Direction=Pa.B4f,Ba.Duration=1200,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionCube",
Ga.next="TransitionCubeFromRight",Ga));let Fb,Rb;this.Ac.$("TransitionCubeFromRight",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionFromRight,Rb.tc=R.Fc("TransitionCubeFromRight"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.zL,Fb.Direction=Pa.B4f,Fb.Duration=1200,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionCube",Rb.next="TransitionCubeFromBottom",Rb));let tc,Ac;this.Ac.$("TransitionCubeFromBottom",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionFromBottom,Ac.tc=R.Fc("TransitionCubeFromBottom"),Ac.rc=(tc=
new ub,tc.TransitionType=cb.zL,tc.Direction=Pa.gTi,tc.Duration=1200,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionCube",Ac.next="TransitionCubeFromLeft",Ac));let kd,nd;this.Ac.$("TransitionCubeFromLeft",(nd=new na,nd.mc=ResourceStrings.L_TransitionFromLeft,nd.tc=R.Fc("TransitionCubeFromLeft"),nd.rc=(kd=new ub,kd.TransitionType=cb.zL,kd.Direction=Pa.pTi,kd.Duration=1200,kd.IsManualAdvance=!0,kd),nd.parent="TransitionCube",nd.next="TransitionCubeFromTop",nd));let Bd,Zd;this.Ac.$("TransitionCubeFromTop",
(Zd=new na,Zd.mc=ResourceStrings.L_TransitionFromTop,Zd.tc=R.Fc("TransitionCubeFromTop"),Zd.rc=(Bd=new ub,Bd.TransitionType=cb.zL,Bd.Direction=Pa.ATi,Bd.Duration=1200,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionCube",Zd))}if(!Array.contains(ja,"doors")){let Ba,Ga;this.Ac.$("TransitionDoors",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionDoors,Ga.tc=R.Fc("TransitionDoorsVertical"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.URd,Ba.Direction=Pa.M6a,Ba.Duration=1400,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionDoors",
Ga.next="TransitionDoorsVertical",Ga));let Fb,Rb;this.Ac.$("TransitionDoorsVertical",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionVertical,Rb.tc=R.Fc("TransitionDoorsVertical"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.URd,Fb.Direction=Pa.M6a,Fb.Duration=1400,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionDoors",Rb.next="TransitionDoorsHorizontal",Rb));let tc,Ac;this.Ac.$("TransitionDoorsHorizontal",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionHorizontal,Ac.tc=R.Fc("TransitionDoorsHorizontal"),Ac.rc=
(tc=new ub,tc.TransitionType=cb.URd,tc.Direction=Pa.RNc,tc.Duration=1400,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionDoors",Ac))}if(!Array.contains(ja,"box")){let Ba,Ga;this.Ac.$("TransitionBox",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionBox,Ga.tc=R.Fc("TransitionBoxFromRight"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.zL,Ba.Direction=Pa.A4f,Ba.Duration=1600,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionBox",Ga.next="TransitionBoxFromRight",Ga));let Fb,Rb;this.Ac.$("TransitionBoxFromRight",(Rb=
new na,Rb.mc=ResourceStrings.L_TransitionFromRight,Rb.tc=R.Fc("TransitionBoxFromRight"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.zL,Fb.Direction=Pa.A4f,Fb.Duration=1600,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionBox",Rb.next="TransitionBoxFromBottom",Rb));let tc,Ac;this.Ac.$("TransitionBoxFromBottom",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionFromBottom,Ac.tc=R.Fc("TransitionBoxFromBottom"),Ac.rc=(tc=new ub,tc.TransitionType=cb.zL,tc.Direction=Pa.fTi,tc.Duration=1600,tc.IsManualAdvance=!0,tc),
Ac.parent="TransitionBox",Ac.next="TransitionBoxFromLeft",Ac));let kd,nd;this.Ac.$("TransitionBoxFromLeft",(nd=new na,nd.mc=ResourceStrings.L_TransitionFromLeft,nd.tc=R.Fc("TransitionBoxFromLeft"),nd.rc=(kd=new ub,kd.TransitionType=cb.zL,kd.Direction=Pa.oTi,kd.Duration=1600,kd.IsManualAdvance=!0,kd),nd.parent="TransitionBox",nd.next="TransitionBoxFromTop",nd));let Bd,Zd;this.Ac.$("TransitionBoxFromTop",(Zd=new na,Zd.mc=ResourceStrings.L_TransitionFromTop,Zd.tc=R.Fc("TransitionBoxFromTop"),Zd.rc=(Bd=
new ub,Bd.TransitionType=cb.zL,Bd.Direction=Pa.zTi,Bd.Duration=1600,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionBox",Zd))}if(!Array.contains(ja,"comb")){let Ba,Ga;this.Ac.$("TransitionComb",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionComb,Ga.tc=R.Fc("TransitionCombHorizontal"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.DMd,Ba.Direction=Pa.none,Ba.Duration=1E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionComb",Ga.next="TransitionCombHorizontal",Ga));let Fb,Rb;this.Ac.$("TransitionCombHorizontal",
(Rb=new na,Rb.mc=ResourceStrings.L_TransitionHorizontal,Rb.tc=R.Fc("TransitionCombHorizontal"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.DMd,Fb.Direction=Pa.RNc,Fb.Duration=1E3,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionComb",Rb.next="TransitionCombVertical",Rb));let tc,Ac;this.Ac.$("TransitionCombVertical",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionVertical,Ac.tc=R.Fc("TransitionCombVertical"),Ac.rc=(tc=new ub,tc.TransitionType=cb.DMd,tc.Direction=Pa.M6a,tc.Duration=1E3,tc.IsManualAdvance=!0,tc),
Ac.parent="TransitionComb",Ac))}if(!Array.contains(ja,"zoom")){let Ba,Ga;this.Ac.$("TransitionZoom",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionZoom,Ga.tc=R.Fc("TransitionZoomIn"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.zoom,Ba.Direction=Pa.M0b,Ba.Duration=900,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionZoom",Ga.next="TransitionZoomIn",Ga));let Fb,Rb;this.Ac.$("TransitionZoomIn",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionIn,Rb.tc=R.Fc("TransitionZoomIn"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.zoom,
Fb.Direction=Pa.M0b,Fb.Duration=900,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionZoom",Rb.next="TransitionZoomOut",Rb));let tc,Ac;this.Ac.$("TransitionZoomOut",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionOut,Ac.tc=R.Fc("TransitionZoomOut"),Ac.rc=(tc=new ub,tc.TransitionType=cb.zoom,tc.Direction=Pa.a2d,tc.Duration=900,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionZoom",Ac.next="TransitionZoomAndRotate",Ac));let kd,nd;this.Ac.$("TransitionZoomAndRotate",(nd=new na,nd.mc=ResourceStrings.L_TransitionZoomAndRotate,
nd.tc=R.Fc("TransitionNewsFlash"),nd.rc=(kd=new ub,kd.TransitionType=cb.ezl,kd.Direction=Pa.none,kd.Duration=1500,kd.IsManualAdvance=!0,kd),nd.parent="TransitionZoom",nd))}if(!Array.contains(ja,"random")){let Ba,Ga;this.Ac.$("TransitionRandom",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionRandom,Ga.tc=R.Fc("TransitionRandom"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.random,Ba.Direction=Pa.Fgj,Ba.Duration=1500,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionRandom",Ga))}}if(!Array.contains(ja,"menusectiondynamiccontent")){if(!Array.contains(ja,
"pan")){let Ba,Ga;this.Ac.$("TransitionPan",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionPan,Ga.tc=R.Fc("TransitionPanFromBottom"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.pan,Ba.Direction=Pa.nPa,Ba.Duration=1300,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionPan",Ga.next="TransitionPanFromBottom",Ga));this.Ac.$("TransitionPanFromBottom",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromBottom,tc:R.Fc("TransitionPanFromBottom"),rc:Object.assign(new ub,{TransitionType:cb.pan,Direction:Pa.nPa,Duration:1300,
IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromLeft"}));this.Ac.$("TransitionPanFromLeft",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromLeft,tc:R.Fc("TransitionPanFromLeft"),rc:Object.assign(new ub,{TransitionType:cb.pan,Direction:Pa.uBa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromRight"}));this.Ac.$("TransitionPanFromRight",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromRight,tc:R.Fc("TransitionPanFromRight"),rc:Object.assign(new ub,
{TransitionType:cb.pan,Direction:Pa.S6,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromTop"}));this.Ac.$("TransitionPanFromTop",Object.assign(new na,{mc:ResourceStrings.L_TransitionFromTop,tc:R.Fc("TransitionPanFromTop"),rc:Object.assign(new ub,{TransitionType:cb.pan,Direction:Pa.grb,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan"}))}if(!Array.contains(ja,"conveyor")){this.Ac.$("TransitionConveyor",Object.assign(new na,{mc:ResourceStrings.L_TransitionConveyor,
tc:R.Fc("TransitionConveyorRight"),rc:Object.assign(new ub,{TransitionType:cb.PNd,Direction:Pa.S6,Duration:1600,IsManualAdvance:!0}),parent:"TransitionConveyor",next:"TransitionConveyorFromRight"}));let Ba,Ga;this.Ac.$("TransitionConveyorFromRight",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionFromRight,Ga.tc=R.Fc("TransitionConveyorRight"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.PNd,Ba.Direction=Pa.S6,Ba.Duration=1600,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionConveyor",Ga.next="TransitionConveyorFromLeft",
Ga));let Fb,Rb;this.Ac.$("TransitionConveyorFromLeft",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionFromLeft,Rb.tc=R.Fc("TransitionConveyorLeft"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.PNd,Fb.Direction=Pa.uBa,Fb.Duration=1600,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionConveyor",Rb))}if(!Array.contains(ja,"rotate")){let Ba,Ga;this.Ac.$("TransitionRotate",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionRotate,Ga.tc=R.Fc("TransitionRotateLeft"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.zL,Ba.Direction=Pa.D4f,
Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionRotate",Ga.next="TransitionRotateFromRight",Ga));let Fb,Rb;this.Ac.$("TransitionRotateFromRight",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionFromRight,Rb.tc=R.Fc("TransitionRotateLeft"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.zL,Fb.Direction=Pa.D4f,Fb.Duration=2E3,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionRotate",Rb.next="TransitionRotateFromBottom",Rb));let tc,Ac;this.Ac.$("TransitionRotateFromBottom",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionFromBottom,
Ac.tc=R.Fc("TransitionRotateTop"),Ac.rc=(tc=new ub,tc.TransitionType=cb.zL,tc.Direction=Pa.kTi,tc.Duration=2E3,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionRotate",Ac.next="TransitionRotateFromLeft",Ac));let kd,nd;this.Ac.$("TransitionRotateFromLeft",(nd=new na,nd.mc=ResourceStrings.L_TransitionFromLeft,nd.tc=R.Fc("TransitionRotateRight"),nd.rc=(kd=new ub,kd.TransitionType=cb.zL,kd.Direction=Pa.sTi,kd.Duration=2E3,kd.IsManualAdvance=!0,kd),nd.parent="TransitionRotate",nd.next="TransitionRotateFromTop",
nd));let Bd,Zd;this.Ac.$("TransitionRotateFromTop",(Zd=new na,Zd.mc=ResourceStrings.L_TransitionFromTop,Zd.tc=R.Fc("TransitionRotateBottom"),Zd.rc=(Bd=new ub,Bd.TransitionType=cb.zL,Bd.Direction=Pa.ETi,Bd.Duration=2E3,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionRotate",Zd))}if(!Array.contains(ja,"window")){let Ba,Ga;this.Ac.$("TransitionWindow",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionWindow,Ga.tc=R.Fc("TransitionWindowVertical"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.window,Ba.Direction=Pa.M6a,
Ba.Duration=1500,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionWindow",Ga.next="TransitionWindowVertical",Ga));let Fb,Rb;this.Ac.$("TransitionWindowVertical",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionVertical,Rb.tc=R.Fc("TransitionWindowVertical"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.window,Fb.Direction=Pa.M6a,Fb.Duration=1500,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionWindow",Rb.next="TransitionWindowHorizontal",Rb));let tc,Ac;this.Ac.$("TransitionWindowHorizontal",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionHorizontal,
Ac.tc=R.Fc("TransitionWindowHorizontal"),Ac.rc=(tc=new ub,tc.TransitionType=cb.window,tc.Direction=Pa.RNc,tc.Duration=1500,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionWindow",Ac))}if(!Array.contains(ja,"orbit")){let Ba,Ga;this.Ac.$("TransitionOrbit",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionOrbit,Ga.tc=R.Fc("TransitionOrbitFromRight"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.zL,Ba.Direction=Pa.C4f,Ba.Duration=1600,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionOrbit",Ga.next="TransitionOrbitFromRight",
Ga));let Fb,Rb;this.Ac.$("TransitionOrbitFromRight",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionFromRight,Rb.tc=R.Fc("TransitionOrbitFromRight"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.zL,Fb.Direction=Pa.C4f,Fb.Duration=1600,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionOrbit",Rb.next="TransitionOrbitFromBottom",Rb));let tc,Ac;this.Ac.$("TransitionOrbitFromBottom",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionFromBottom,Ac.tc=R.Fc("TransitionOrbitFromBottom"),Ac.rc=(tc=new ub,tc.TransitionType=cb.zL,
tc.Direction=Pa.jTi,tc.Duration=1600,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionOrbit",Ac.next="TransitionOrbitFromLeft",Ac));let kd,nd;this.Ac.$("TransitionOrbitFromLeft",(nd=new na,nd.mc=ResourceStrings.L_TransitionFromLeft,nd.tc=R.Fc("TransitionOrbitFromLeft"),nd.rc=(kd=new ub,kd.TransitionType=cb.zL,kd.Direction=Pa.rTi,kd.Duration=1600,kd.IsManualAdvance=!0,kd),nd.parent="TransitionOrbit",nd.next="TransitionOrbitFromTop",nd));let Bd,Zd;this.Ac.$("TransitionOrbitFromTop",(Zd=new na,Zd.mc=ResourceStrings.L_TransitionFromTop,
Zd.tc=R.Fc("TransitionOrbitFromTop"),Zd.rc=(Bd=new ub,Bd.TransitionType=cb.zL,Bd.Direction=Pa.DTi,Bd.Duration=1600,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionOrbit",Zd))}if(!Array.contains(ja,"flythrough")){let Ba,Ga;this.Ac.$("TransitionFlyThrough",(Ga=new na,Ga.mc=ResourceStrings.L_TransitionFlyThrough,Ga.tc=R.Fc("TransitionFlyThroughIn"),Ga.rc=(Ba=new ub,Ba.TransitionType=cb.jZb,Ba.Direction=Pa.M0b,Ba.Duration=800,Ba.IsManualAdvance=!0,Ba),Ga.parent="TransitionFlyThrough",Ga.next="TransitionFlyThroughIn",
Ga));let Fb,Rb;this.Ac.$("TransitionFlyThroughIn",(Rb=new na,Rb.mc=ResourceStrings.L_TransitionIn,Rb.tc=R.Fc("TransitionFlyThroughIn"),Rb.rc=(Fb=new ub,Fb.TransitionType=cb.jZb,Fb.Direction=Pa.M0b,Fb.Duration=800,Fb.IsManualAdvance=!0,Fb),Rb.parent="TransitionFlyThrough",Rb.next="TransitionFlyThroughOut",Rb));let tc,Ac;this.Ac.$("TransitionFlyThroughOut",(Ac=new na,Ac.mc=ResourceStrings.L_TransitionOut,Ac.tc=R.Fc("TransitionFlyThroughOut"),Ac.rc=(tc=new ub,tc.TransitionType=cb.jZb,tc.Direction=Pa.a2d,
tc.Duration=800,tc.IsManualAdvance=!0,tc),Ac.parent="TransitionFlyThrough",Ac.next="TransitionFlyThroughInWithBounce",Ac));let kd,nd;this.Ac.$("TransitionFlyThroughInWithBounce",(nd=new na,nd.mc=ResourceStrings.L_TransitionInWithBounce,nd.tc=R.Fc("TransitionFlyThroughIn"),nd.rc=(kd=new ub,kd.TransitionType=cb.jZb,kd.Direction=Pa.NRi,kd.Duration=900,kd.IsManualAdvance=!0,kd),nd.parent="TransitionFlyThrough",nd.next="TransitionFlyThroughOutWithBounce",nd));let Bd,Zd;this.Ac.$("TransitionFlyThroughOutWithBounce",
(Zd=new na,Zd.mc=ResourceStrings.L_TransitionOutWithBounce,Zd.tc=R.Fc("TransitionFlyThroughOut"),Zd.rc=(Bd=new ub,Bd.TransitionType=cb.jZb,Bd.Direction=Pa.ORi,Bd.Duration=900,Bd.IsManualAdvance=!0,Bd),Zd.parent="TransitionFlyThrough",Zd))}}this.Ac.forEach((Ba,Ga)=>{Ba===Ga.parent&&++T;return!0})}iQa(z){let T=null;z?this.Ac.forEach((ja,Ba)=>{Ba.rc&&Ba.rc.TransitionType===z.TransitionType&&Ba.rc.Direction===z.Direction&&(T=ja);return!0}):T="TransitionNone";return T}EP(z){return this.Ac.ga(z)}Fsb(z){return(z=
this.iQa(z))?this.Ac.ga(this.Ac.ga(z).parent):null}jQa(z){return(z=this.iQa(z))?this.Ac.ga(z).parent:null}mag(z){let T,ja=null;T=null;z&&z.next&&(T=z.next,ja=this.EP(T));return{returnValue:ja,key:T}}Urb(){var z=[R.PTi,R.GEk,R.HEk];for(const T of z)if(z=document.getElementById(T))return z;return null}UTc(z,T){return z&&T&&T.childNodes?z.startsWith(R.QTi)?T.contains(document.getElementById(z)):!1:!T&&z?"TransitionExisting"===z||"TransitionNone"===z||"TransitionMorph"===z||"TransitionCut"===z||"TransitionFade"===
z||"TransitionPush"===z||"TransitionWipe"===z:!1}static Fc(z){return li.a.y9c+"_"+z+"_32x32x32"}}R.PTi="PptRibbon.Transition.Gallery-MaxSize-1-0";R.GEk="Transitions";R.HEk="Transitions-previewWrapper";R.QTi="Transition";Object(h.a)(R,"TransitionHelper",null,[844]);var ta=d(242),Ra=d(52);class nb{constructor(){this.hh=this.K=null}get name(){return"PowerPointWebEditor.Advanced"}Yb(z){this.K=z;this.hh=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder").YBa(0,this.name);this.K.register(816,
"PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers").ma().na(()=>new Ag(this.K.resolve("Common.IActionManagerExtended")));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").gP){const T=ta.a(this.K);this.K.register(817,"PowerPointWebEditor.IAudioManagerStore").ma().na(()=>new Ma);this.K.register(818,"PowerPointWebEditor.IAudioLibraryCallbackFactory").ma().na(()=>new Hk(this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").gP,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.Oa("PowerPointWebEditor.IAudioManagerStore")));this.K.register(819,"PowerPointWebEditor.IAudioManagerFactory").ma().na(()=>new Hj(this.K.resolve("PowerPointWebEditor.IAudioLibraryCallbackFactory"),T,this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.resolve("PowerPointWebEditor.IAudioManagerFactory");
this.K.resolve("PowerPointWebEditor.IAudioManagerStore")}}init(){let z=this.hh.Ut("resolve");var T=this.K.resolve("Common.AFrameworkApplication");const ja=this.K.resolve("PowerPointWebEditor.IApplicationContext"),Ba=ja.kd;T=T.Uq;const Ga=this.K.resolve("Common.IActionManagerExtended"),Fb=this.K.resolve("PowerPointWebEditor.IFocusManager");T=T.Fd;const Rb=this.K.resolve("Common.Transaction.ITransactionFactory"),tc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Ac=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager");
var kd=this.K.resolve("PPTe.IColorPickerBuilderFactory");const nd=this.K.resolve("PowerPointWebEditor.PictureContext"),Bd=this.K.resolve("PowerPoint.IPathManager"),Zd=this.K.resolve("PowerPointWebEditor.IPresentationReader"),df=this.K.resolve("PowerPointWebEditor.IShapeReader"),Ke=this.K.resolve("PowerPointWebEditor.IPictureUploader"),zf=this.K.qe("PowerPointWebEditor.IPPTLanguageDialogFactory");this.K.resolve("PowerPointWebEditor.IApplicationSettings");const Sf=this.K.resolve("Box4.IParagraphReader");
this.hh.au(z);z=this.hh.Ut("regactors");kd=[new Ld(Ga,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),tc,Fb,Rb,new $c(Ba.yFf),kd,Ac,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),df,Bd),new ij(Ga,tc,this.K.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),Sf,this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),df,this.K.resolve("PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers"),
uf.App.VIa.GEc(12),Ba.telemetryForPptParagraphSettingEnabled),new Sg(Ga,Fb,Ac,Rb,tc,Bd,T,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Zd,new hb,Ba.Xtg,this.K.resolve("Common.IAppSettingsManager").ka("ChangingThemeSelectedSlidesEnabled")),new ci(Ga,T,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Rb,tc,Fb,new R(Ba.gJa),Ac,Ba,Bd,this.K.resolve("PowerPointWebEditor.View.IPPTPageView"))];Ba.powerPointFormatBackgroundEnabled&&kd.push(new ef(Ga,Fb,Ac,tc,Rb,T,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Ke,nd,E.AFrameworkApplication.XP,this.K.resolve("PowerPointWebEditor.IErrorHandler"),Ba));for(const Lh of kd)Lh.wb(),Lh.Fe();this.hh.au(z);E.AFrameworkApplication.fa.gf(()=>{z=this.hh.Ut("regfullactors");const Lh=[],Mh=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");Mh.IRa=this.K.resolve("Common.IAppSettingsManager").ka(Ra.a.pa(299));ja.kd.xDb&&Lh.push(new wi(Ga,zf,Mh,this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.Oa("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.ILanguageReader"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Box4.IProofingManager"),tc));this.K.resolve("PowerPointWebEditor.IApplicationSettings").f2b&&Lh.push(new Hd(Ga,Fb,tc,ta.a(this.K)));for(const si of Lh)si.wb(),si.Fe();Mh.IRa&&(new Le(Ga,this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),(si,Yh)=>new Gd(si,this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),
Yh,this.K.resolve("Common.IFocusManager")),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),tc,this.K.resolve("Box4.ILanguageReader"),df)).wb();this.hh.au(z)})}dispose(){}}Object(h.a)(nb,"AdvancedPackage",null,[2,3]);class Cb{get container(){return C.a.instance.resolve("PowerPointWebEditor.IRibbonPane").za}}Object(h.a)(Cb,"PPTFloatPaneContainer",null,[801]);class mc{constructor(z,T,ja=null){this.Lbb=new Rh.a(0);this.vva=null;this.wva=this.vva=uf.App.Bm;this.she=z;this.OPg=1E3*T;this.SFg=ja||
(()=>(new Date).getTime())}hai(z){this.she&&this.Lbb.add(z,(new Date).getTime())}cZf(z){this.she&&(this.Lbb.remove(z),this.Fkl(this.SFg()-this.OPg))}Fkl(z){if(this.Lbb.count){var T=[];this.Lbb.forEach((ja,Ba)=>{Ba<z&&T.push(ja);return!0});for(const ja of T)this.Lbb.remove(ja)}}get nsg(){return this.wva<=this.vva}foj(){if(!this.she||!this.Lbb.count)return!1;let z=!1;const T=this.SFg();this.Lbb.forEach((ja,Ba)=>T-Ba<this.OPg?(z=!0,!1):!0);return z}}Object(h.a)(mc,"PictureContext",null,[815]);var Sc=
d(878),jd=d(365);class Ad{constructor(){this.U$a=this.Nle=this.KJg=this.LJg=!1;this.K3=this.hh=this.C3=this.Vyb=this.cKg=this.K=null;this.Z6b=[new nb];this.zW=[]}get name(){return"PowerPointWebEditor.Chronos"}Yb(z){this.K=z;this.C3=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.hh=this.C3.YBa(0,this.name);this.K3=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");for(let T=0;T<this.Z6b.length;++T)Array.add(this.zW,Db.a(this.Z6b[T],0));for(const T of this.zW)T.Yb(z);
Ad.Cpi(z);this.K.register(mc,"PowerPointWebEditor.PictureContext").as("PowerPointWebEditor.IPictureContext").ma().na(()=>new mc(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingPromptUnsavedDialogForUploadingImageEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingUploadLargeImageTimeoutInSeconds))}fdc(z,T){z=bg.a.instance;for(let Ba=0;Ba<T.entries.length;Ba++){var ja=T.entries[Ba];ja.url=Ca.a.removeParameter(ja.url,E.AFrameworkApplication.JU);const Ga=
Ca.a.ema(ja.url);let Fb=!1;if("about:blank"===ja.url||Ga.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===Ga&&"2"===Ca.a.rV(ja.url,"u")||this.U$a&&(Fb=Ga.endsWith("PowerPoint.ashx"))&&ja.url.endsWith("ib=1"))ja.behavior=1;else{if(Fb||Ga.endsWith("PowerPoint.ashx")||Ga.endsWith("GetUpdates")||Ga.endsWith("images.ashx")||Ga.endsWith("GetThumb"))ja.behavior=2;if(!this.LJg&&Ga.endsWith("PowerPoint.ashx")&&"true"===Ca.a.rV(ja.url,tf.a.Xpk))ja=ja.eB,z.jc(Qe.a.xNd,parseInt(String(ja.fetchStart))),z.jc(Qe.a.Vri,
parseInt(String(ja.responseStart))),z.jc(Qe.a.Mri,parseInt(String(ja.responseEnd-ja.responseStart))),this.LJg=!0;else if(!this.KJg&&Ga.endsWith("PowerPoint.ashx")&&"true"===Ca.a.rV(ja.url,"dSlide")){this.KJg=!0;ja=ja.eB;z.jc("SlideImageFetchStart",parseInt(String(ja.fetchStart)));z.jc("SlideImageResponseStart",parseInt(String(ja.responseStart)));z.jc("SlideImageDownloadDuration",parseInt(String(ja.responseEnd-ja.responseStart)));let Rb;({transferSize:Rb}=Ad.Lxh(ja)).returnValue&&z.jc("SlideImageSize",
Rb)}else if(!this.Nle&&Ga.endsWith("images.ashx")&&"true"===Ca.a.rV(ja.url,"minimalboot")&&Ca.a.rV(ja.url,"index")===this.cKg){this.Nle=!0;ja=ja.eB;z.jc("MBootFetchStart",parseInt(String(ja.fetchStart)));z.jc("MBootResponseStart",parseInt(String(ja.responseStart)));z.jc("MBootDownload",parseInt(String(ja.responseEnd-ja.responseStart)));let Rb;({transferSize:Rb}=Ad.Lxh(ja)).returnValue&&z.jc("MBootSize",Rb)}}}}P0k(){const z=window.self.FirstSlideRequestIndex;void 0===z||null===z?this.Nle=!0:this.cKg=
z.toString()}init(){Wc.a.J(38876310,809,50,"ChronosPackage::Init");const z=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),T=this.K.resolve("Common.ITaskManager");for(var ja of this.zW)this.hh.Ut(ja.name),ja.init(),this.hh.au(ja.name);this.K.resolve("Common.IAppSettingsManager").gf(()=>{if(z.podsAnimationSuggestionEnabled){const Ba=this.hh.Ut("animationpreview");this.Ouj();this.hh.au(Ba)}});this.K.resolve("Common.IActionManagerExtended").bma(this.K.resolve("PowerPointWebEditor.IPasteFloatieHelper"));
ja=C.a.instance.resolve("Box4.IProofingManager");if(null!==ja){let Ba=this.hh.Ut("proofingresume");ja.resume();this.hh.au(Ba)}if(z.ksa||!z.QRa)ja=this.hh.Ut("loaddelayedres"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").orh(),this.hh.au(ja);this.P0k();this.U$a=z.podsUseRealtimeCoauthReplicationTimerForInbound;ja=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");ja.Yb(30,0);ja.NBf(Object(v.a)(this,this.fdc,"onResourceTimingEntriesAvailable"));ja.activate();z.gDa&&
(this.Vyb=window.self.PerfMeterData,void 0!==this.Vyb&&null!==this.Vyb&&(T.Hb(new od.a(3,2,6E4,Object(v.a)(this,this.collectPerfMeterData,"collectPerfMeterData"),90,"67")),Wc.a.J(38537040,809,50,"CollectPerfMeterData task started"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler").wB(()=>{this.collectPerfMeterData(null)})));this.mRj(z)}mRj(z){Wc.a.J(40122147,809,50,"Start to download chronos1 js file");if(z.Vmc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Bha("pptedit.chronos1",
null,()=>d.e(2).then(d.bind(null,1196)));else{z=Af.a.create("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1196)));const T=this.K.resolve("PowerPointWebEditor.ISessionState");z.yM(()=>{T&&T.L_("Chronos1DownloadFinished")});ma.a.nt(z)}}collectPerfMeterData(){if(0<this.Vyb.length){const z=[];for(const T of this.Vyb)z.push({["Id"]:T.Id,["Value"]:T.Value.toFixed(2),["Start"]:T.Start.toFixed(2),["Duration"]:T.Duration.toFixed(2)});Wc.a.J(38537042,813,50,JSON.stringify(z));this.Vyb.length=0}}dispose(){for(var z of this.zW)z.dispose();
z=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");z.deactivate(!0);z.Cbh(Object(v.a)(this,this.fdc,"onResourceTimingEntriesAvailable"))}Ouj(){const z=Af.a.create("pptedit.animationpreview",null,()=>d.e(18).then(d.bind(null,1209)));try{ma.a.nt(z)}catch(T){Wc.a.J(38397957,809,10,"ChronosPackage::InitializeAnimationPreview - Failed to download animationpreview script, Exception: {0}",T.toString())}}static Cpi(z){z.register(801,"Common.IFloatPaneContainer").ma().na(()=>new Cb)}static Lxh(z){z=
parseInt(String(Sc.a(z,"transferSize")));return{returnValue:!z.toString().startsWith("NaN"),transferSize:z}}static main(){E.AFrameworkApplication.Xg&&P.a.ag?Wc.a.J(19964809,809,15,"Firefox attempts to load chronos package when App is disposing"):(bg.a.instance.jc(jd.a.OLd,(new Date).getTime()),Ya.a.instance.Ec(Db.a(new Ad,0)))}}Object(h.a)(Ad,"ChronosPackage",null,[2,3]);class ve{constructor(z,T,ja,Ba,Ga,Fb,Rb){this.Ooe=this.ySa=!1;this.ua=z;this.uc=T;this.Ow=ja;this.hv=Ba;this.FBg=Fb;this.Ue=Ga;
this.a8=this.ua.Ca;this.Kc=Rb}initialize(){this.Ow.yk(Object(v.a)(this,this.Ah,"onPropertyChanged"));this.Ue.Imb(Object(v.a)(this,this.fva,"onRibbonTabSwitched"));this.hv.DR(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.hv.CSb(Object(v.a)(this,this.QVa,"onShapeViewElementAdded"));this.hv.f4h(Object(v.a)(this,this.c_g,"onShapesAllSelected"))}dispose(){this.Ow.Pm(Object(v.a)(this,this.Ah,"onPropertyChanged"));this.Ue.Hhc(Object(v.a)(this,this.fva,"onRibbonTabSwitched"));
this.hv.lma(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.hv.Fcd(Object(v.a)(this,this.QVa,"onShapeViewElementAdded"));this.hv.gOk(Object(v.a)(this,this.c_g,"onShapesAllSelected"))}Ah(z,T){T.property===gg.a.WJc&&this.ySa&&this.uc.Sg(T.node)===this.a8&&this.Rbd(this.ySa)}fva(z,T){if(this.ySa=!!T.ola&&0<=T.ola.indexOf("Animation"))this.Ooe=!0;this.Rbd(this.ySa)}QVa(z,T){(z=this.ua.Ca)&&z.OV&&z===this.a8&&(T=T.$w)&&T.shapeNode&&this.a8&&this.F8a(this.a8.Cb,T.shapeNode)&&
this.Rbd(this.ySa)}F8a(z,T){return z&&T?z.equals(T.slideId):!1}onActiveSlideDomReady(z,T){(z=Object(A.a)(132,T.Ca))&&this.a8&&this.a8.Cb!==z.Cb&&(this.a8=z,this.Rbd(this.ySa))}c_g(){this.lXa()}lXa(){if(this.ySa&&this.a8&&this.a8.zQa&&this.Ooe){var z=this.a8.km();if(z&&0<z.length)for(const T of z)T&&T.L7a()&&(z=this.FBg.yP(T))&&(z.JUb(),z.lXa(!0))}}Rbd(z){if(this.Ooe&&this.a8&&this.a8.OV&&this.Kc.Mc&&this.Kc.Mc.GDf){var T=this.a8.km();if(T&&0<T.length)for(const ja of T)ja&&(T=this.FBg.yP(ja))&&(T.visible=
z,T.pCe())}}}Object(h.a)(ve,"AnimationMarkerManager",null,[109]);var Ae=d(78),Ue=d(61);class mg{constructor(z,T){this.height=z;this.top=T}}Object(h.a)(mg,"ParagraphProperties",null,[]);var ki=d(47),di=d(68),lk=d(140),Rf=d(173),Kd=d(203),Ql=d(191);class Uj{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd,Zd,df){this.ZZc=this.Doe=this.El=this.Sb=!1;this.RSa=this.A6b=-1;this.iKg=this.HG=!1;this.va=new Ae.a;this.SKg=this.ud=1;this.WN=this.QN=this.ji=this.Ab=this.xb=null;this.xa=z;this.uc=T;this.um=ja;this.Zh=
Ba;this.eC=Fb;this.Y6j=Ga;this.Nca=Rb.Mc?Rb.Mc.GDf:null;this.e6j=Rb.Mc?Rb.Mc.Dhd:null;this.Xh=tc;this.jd=Ac;this.Ga=kd;this.Bb=nd;this.Nja=Zd;this.RYj=df;this.Qj=Bd}dispose(){this.El||(this.Nja(),this.El=!0,this.Sb=!1,this.JUb(),this.UCc(),this.Xh&&this.QN&&(this.Xh.zb(eb.a.Is,this.QN.za,Object(v.a)(this,this.SW,"onSelectionAreaHover")),this.Xh.zb(eb.a.Wv,this.QN.za,Object(v.a)(this,this.SW,"onSelectionAreaHover"))),this.QN=null,this.Xh&&this.WN&&(this.Xh.zb(eb.a.Is,this.WN.za,Object(v.a)(this,this.SW,
"onSelectionAreaHover")),this.Xh.zb(eb.a.Wv,this.WN.za,Object(v.a)(this,this.SW,"onSelectionAreaHover"))),this.Ab=this.ji=this.Nca=this.xb=this.WN=null)}get visible(){return this.Sb}set visible(z){this.Sb=z}get qC(){return this.Ab}get qq(){return this.ji}get oe(){return this.xb}Vm(z){z&&this.Nca?(this.xb=new lk.a,this.xb.gt("AnimationMarkerView"),this.Nca.appendChild(this.xb.za),this.Ab=new Ql.a,this.Ab.Uk(0),this.xb.appendChild(this.Ab.viewport),this.ji=new Rf.a,this.ji.Uk(1),this.ji.setVisibility(!1),
this.Ab.appendChild(this.ji),this.QN=new lk.a,this.QN.gt("ShapeAnimationMarkerContainer"),this.QN.za.id=this.xa.id.toString(),this.QN.Bh(20,this.xb.za.clientHeight),this.QN.Uk(1),this.xb.appendChild(this.QN),this.WN=new lk.a,this.WN.gt("TextAnimationMarkerContainer"),this.WN.za.id=this.xa.id.toString(),this.WN.Bh(20,this.xb.za.clientHeight),this.WN.Uk(1),this.xb.appendChild(this.WN),this.Xh.pb(eb.a.Is,this.QN.za,Object(v.a)(this,this.SW,"onSelectionAreaHover")),this.Xh.pb(eb.a.Wv,this.QN.za,Object(v.a)(this,
this.SW,"onSelectionAreaHover")),this.Xh.pb(eb.a.Is,this.WN.za,Object(v.a)(this,this.SW,"onSelectionAreaHover")),this.Xh.pb(eb.a.Wv,this.WN.za,Object(v.a)(this,this.SW,"onSelectionAreaHover")),this.setVisibility()):Wc.a.J(36549457,800,10,"AnimationMarkerView: {0} is null",z?"m_markerViewParentElement":"parent")}IP(z){let T=!1;z&&z.Hc.id.startsWith(li.a.gAc)||z.Hc.id.startsWith("overlappedMarker")?(this.Xik(z),T=!0):(this.JUb(),this.lXa(!0));return T}setSelection(z){if(z&&!this.ZZc||!z)this.lXa(z),
this.JUb()}setVisibility(){let z=this.Sb&&!this.HG;this.xa&&this.xa.isHiddenShape&&(z=!1);this.xb&&this.xb.Sd(z);this.QN&&this.QN.Sd(z);this.WN&&this.WN.Sd(z)}lXa(z){if(this.H3b()){this.Doe=z;z=[this.QN.za.childNodes,this.WN.za.childNodes];for(const T of z)for(z=0;T&&z<T.length;z++)this.Chh(T[z],this.Doe)}}bWi(z){if(!z||!this.xa)return null;z=z.getAttribute("AnimProps");if(!z||!z.toString()||!z.toString().trim().length)return null;z=z.toString().split(" ");if(!z||4!==z.length)return null;const T=
[];for(const ja of z){if(!ja||!ja.trim().length)return null;T.push(Number.parseInvariant(ja.trim()))}return T}H3b(){const z=!!this.xa&&!!this.Nca&&!!this.QN&&!!this.WN;z||Wc.a.J(36549459,800,10,"AnimationMarkerView: the containers are not exist.");return z}UCc(){this.IUb(!0);this.IUb(!1)}IUb(z){if(this.Xh&&this.jd&&this.H3b()&&(z=z?this.WN.za:this.QN.za)&&z.childNodes&&0<z.childNodes.length){const T=z.childNodes;for(const ja=0;ja<T.length;)z.removeChild(T[ja])}}OXh(){if(this.H3b()){var z=this.D5f(this.xa);
if(z&&z.length){var T=!1,ja=!1,Ba=[];for(const Ga of z)Ga.IsTextRangeType?ja=!0:(T=!0,Ba.push(Ga));this.iKg=T&&ja;this.mld(!0);this.mld(!1);this.IUb(!1);0<Ba.length&&(Wc.a.J(37066063,800,50,"AnimationMarkerView: draw shape animation markers."),this.uXf(Ba,this.Qj.IQ(this.xa.Vq.ic,this.ud),this.Qj.IQ(this.xa.Vq.Xb-this.xa.Vq.ic,this.ud),!1,-1)||Wc.a.J(37012629,800,10,"AnimationMarkerView: no shape marker is rendered"));ja?this.GKi():this.IUb(!0);if(!ja&&-1!==this.RSa||-1!==this.RSa&&-1===this.RSa&&
!T)this.bMd(),this.lXa(!0)}else this.UCc()}}GKi(){const z=new od.a(2,1,0,Object(v.a)(this,this.ensureTextIsRenderedAndDrawMarkers,"ensureTextIsRenderedAndDrawMarkers"),90,"26");this.Bb.Hb(z)}ensureTextIsRenderedAndDrawMarkers(){this.El||(this.RYj(),this.AXf())}AXf(){this.IUb(!0);if(this.npj(this.xa)){var z=this.raj();if(z&&z.length){var T;if(({top:T}=this.Uaj()).returnValue){var ja=0;Wc.a.J(37066067,800,50,"AnimationMarkerView: draw paragraph animation markers.");for(let Ga=0;Ga<z.length;Ga++){var Ba=
this.uc.Sg(this.xa);if(!Ba)return;(Ba=Ba.yMc(this.xa,Ga))&&0<Ba.length&&z[Ga]&&(ja+=this.uXf(Ba,z[Ga].top-T,z[Ga].height,!0,Ga))}ja||Wc.a.J(37012633,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Wc.a.J(37106E3,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Wc.a.J(36967690,800,50,"AnimationMarkerView: the paragrph view is not rendered")}}raj(){const z=[];var T=Cd.GraphIterator.nb(this.xa);T=this.um.A6(T,T.currentNode);for(var ja;T.moveNext();)(ja=T.currentNode)&&
this.Zh.Pd(ja)&&ja&&(ja=ja.pc(this.eC))&&ja.htmlElement&&(ja=this.YPa(ja.htmlElement))&&ja.height&&z.push(ja);return z}Uaj(){return this.getClientRects(this.e6j)}getClientRects(z){let T,ja;T=ja=0;if(!z)return Wc.a.J(36967698,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:T,top:ja};z=z.getClientRects();if(!z||!z.length||!z[0])return Wc.a.J(37106008,800,50,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:T,top:ja};ja=Math.round(z[0].top);
T=Math.round(z[0].left);return{returnValue:!0,left:T,top:ja}}YPa(z){if(!z)return Wc.a.J(36967700,800,10,"AnimationMarkerView: paragraph is null"),null;z=z.querySelectorAll(".TextRun");if(!z||!z.length)return null;let T=0,ja=0;let Ba,Ga=!1;for(let Rb=0;Rb<z.length&&z[Rb];Rb++){var Fb=z[Rb].getClientRects();({top:Fb,bottom:Ba}=this.rPi(Fb)).returnValue&&(Rb?(T=T>Fb?Fb:T,ja=ja<Ba?Ba:ja):(T=Fb,ja=Ba),Ga=!0)}if(Ga)return new mg(ja-T,T);Wc.a.J(37106011,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");
return null}rPi(z){let T,ja;T=ja=0;if(!z||!z.length||!z[0])return Wc.a.J(36967702,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),{returnValue:!1,top:T,bottom:ja};T=z[0].top;ja=z[0].bottom;for(let Ba=1;Ba<z.length&&z[Ba];Ba++)T=z[Ba].top>T?T:z[Ba].top,ja=z[Ba].bottom<ja?ja:z[Ba].bottom;return{returnValue:!0,top:T,bottom:ja}}uXf(z,T,ja,Ba,Ga){if(!this.H3b()||!z||!z.length)return 0;const Fb=Ba?this.WN.za:this.QN.za;ja=(ja=Math.floor(this.Qj.jn(ja)/21))?ja:1;let Rb=0,tc=null,Ac=new lk.a,
kd=!1,nd=!1;const Bd=Ga===this.RSa&&z.length<this.A6b+1;for(let df=0;df<z.length;df++){const Ke=z[df],zf=new lk.a;zf.za.id=li.a.gAc+Ke.BuildId;zf.Bh(20,16);zf.Uk(1);if(Ke.IsTrigger){var Zd=this.Wzi();zf.za.appendChild(Zd)}else zf.za.innerText=Ke.BuildId.toString();let Sf=Zd=!1;df<ja?(Ba&&(zf.za.style.position=di.a.absolute,zf.za.style.top=ki.a.Nc(this.Qj.jn(T)+21*Rb)),zf.za.setAttribute("AnimProps",String.format("{0} {1} {2} {3}",df,Ga,Ke.BuildId,Ke.EffectId)),nd=this.Doe||Bd&&z.length-1===df||this.ZZc&&
this.A6b===df&&this.RSa===Ga,zf.za.setAttribute(di.a.FUb,nd?"animMarkerSelected":"animMarkerUnselected"),Fb.appendChild(zf.za),Rb++):df===ja&&Ac.za?(kd=kd&&Ke.EffectId===tc.EffectId,Zd=!0,Sf=tc.IsTrigger):kd=kd&&Ke.EffectId===tc.EffectId;Zd&&Ac.za.appendChild(this.hdi(Sf,kd,nd));Ac=zf;tc=Ke}this.GX();return Rb}hdi(z,T,ja){const Ba=new lk.a;Ba.za.id="overlappedMarker";Ba.za.style.marginTop=z?"3px":"-13px";Ba.za.setAttribute(di.a.FUb,"overlappedMarker "+(ja?"animMarkerSelected":"animMarkerUnselected"));
T&&this.hfb(Ba.za,"SameEffectOverlapped",1);return Ba.za}GX(){this.Y6j(this.xb.za,!0)}D5f(z){if(!z)return null;const T=this.uc.Sg(z);return T?T.gQa(z):null}npj(z){z=this.D5f(z);if(!z||!z.length)return!1;for(const T of z)if(T.IsTextRangeType)return!0;return!1}mld(z){if(this.H3b()){var T=z?this.QN.za:this.WN.za,ja,Ba;T&&({x:ja,y:Ba}=this.S4i(z)).returnValue&&(T.style.position=di.a.absolute,T.style.left=ki.a.Nc(ja),T.style.zIndex="20000",z?T.style.top=ki.a.Nc(Ba):this.AXf())}}S4i(z){let T,ja;T=ja=0;
if(!this.xa)return{returnValue:!1,x:T,y:ja};var Ba=Object(A.a)(133,this.xa.pc(this.eC));if(!Ba)return{returnValue:!1,x:T,y:ja};Ba=Ba.vs();if(!Ba)return{returnValue:!1,x:T,y:ja};T=z?Ba.fc-(this.iKg?61:35):Ba.fc-20-15;ja=Ba.ic;return{returnValue:!0,x:T,y:ja}}Xik(z){if(this.va&&z&&this.Ga&&z.Hc){var T=z.Hc.id.startsWith("overlappedMarker")&&z.Hc.offsetParent?z.Hc.offsetParent:z.Hc;this.CZk(T);this.Ohg(T)&&!this.qKj(T)&&this.bMd();this.lXa(!1);this.Chh(T,!0);this.va.raiseEvent("OnMarkerClick",z);this.Ga.Bd()}}JUb(){this.ZZc=
!1;this.RSa=this.A6b=-1;this.bMd()}CZk(z){(z=this.bWi(z))?(this.ZZc=!0,this.A6b=z[0],this.RSa=z[1],this.xa.bwa=this.A6b,this.xa.QHa=this.RSa):Wc.a.J(37066075,800,10,"AnimationMarkerView: failed to parse the animation properties.")}bMd(){this.xa&&(this.xa.bwa=-1,this.xa.QHa=-1)}xm(){this.Ab&&(this.Nld(),this.Ab.xm())}Nld(){if(this.xa&&this.ji){var z=this.xa.Vq.points;z=Uj.Hza(z,this.WMc());this.ji.Mt(z)}}WMc(){let z=li.a.Qic;this.xa.fg||!this.xa.xDa&&!this.xa.ll||(z+=6);return z}eq(){this.Ab&&this.SKg!==
this.ud&&this.pCe();return null}Nq(){}ov(){}Ej(z){this.SKg=this.ud;this.ud=z}setZIndex(z){this.Ab&&this.Ab.tC(z)}draw(){this.pCe()}pCe(){this.xb&&this.Nca&&this.Sb&&!this.HG&&this.OXh();this.setVisibility()}SW(z){if(!this.va||!z)return!1;this.va.raiseEvent("OnSelectionAreaHover",z);z.eventName===eb.a.Is?this.hfb(z.Hc,"animMarkerHovered",1):z.eventName===eb.a.Wv&&this.hfb(z.Hc,"animMarkerHovered",2);return!0}Chh(z,T){z&&(T?(this.hfb(z,"animMarkerUnselected",2),this.hfb(z,"animMarkerSelected",1)):(this.hfb(z,
"animMarkerSelected",2),this.hfb(z,"animMarkerUnselected",1)))}hfb(z,T,ja){const Ba=this.Ohg(z);switch(ja){case 0:z.setAttribute(di.a.FUb,T);Ba&&z.lastChild.setAttribute(di.a.FUb,T);break;case 1:Sys.UI.DomElement.addCssClass(z,T);Ba&&Sys.UI.DomElement.addCssClass(z.lastChild,T);break;case 2:Sys.UI.DomElement.removeCssClass(z,T),Ba&&Sys.UI.DomElement.removeCssClass(z.lastChild,T)}}Ohg(z){return!!z&&!!z.lastChild&&!!z.lastChild.id&&"overlappedMarker"===z.lastChild.id}qKj(z){return!!z&&!!z.lastChild&&
!!z.lastChild.id&&0<=z.lastChild.className.indexOf("SameEffectOverlapped")}setPosition(){}wF(z){(this.HG=z)?this.JUb():(this.Ss(),this.lXa(!0));this.setVisibility()}TE(){return null}Rx(){}MD(){return[]}mz(){}SD(){}Ss(){!this.El&&this.Nca&&(this.mld(!0),this.mld(!1))}Wzi(){const z=new Kd.a;z.Bh(10,10);z.za.setAttribute(di.a.FUb,"pointer-events-none");z.pwa("0 0 2048 2048");const T=new Rf.a;T.$_("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");
T.xF("#E67E22");T.pv("#FFFF00");T.sr(5);z.appendChild(T);return z.za}static Hza(z,T){return[new Ue.a(z[0]._x-T,z[0]._y-T),new Ue.a(z[1]._x+T,z[1]._y-T),new Ue.a(z[2]._x+T,z[2]._y+T),new Ue.a(z[3]._x-T,z[3]._y+T)]}}Object(h.a)(Uj,"AnimationMarkerView",null,[793,283,284,109]);var fm=d(277);class Ij{constructor(){this.K=null;this.Kxb=!1}get name(){return"PowerPointWebEditor.Animations"}Yb(z){this.K=z;if(this.Kxb=this.K.resolve("PowerPointWebEditor.IApplicationContext").kd.pptAnimationMarkersEnabled)this.K.register(259,
"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>").ma().na(()=>new fm.a((T,ja)=>{let Ba=null;const Ga=Object(A.a)(133,T.pc(this.K.resolve("Box4.IPageView").Na));Ga&&!Ga.kl&&Ga.za&&(Ba=new Uj(T,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(v.a)(Ga,Ga.GX,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),E.AFrameworkApplication.ve,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),ja,()=>{Ga.POa()}),Ba.Vm(Ga.za),Ba.setZIndex(4),Ba.visible=!1,Ga.GX(Ba.oe.za,!0),Ga.Bza(Ba,4));return Ba})),this.K.register(ve,"PowerPointWebEditor.Animations.AnimationMarkerManager").ma().na(()=>new ve(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),
this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager")))}init(){this.Kxb&&this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManager").initialize()}dispose(){this.Kxb&&
this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManager").dispose()}static main(){Ya.a.instance.Ec(Db.a(new Ij,0))}}Object(h.a)(Ij,"PPTWebEditorAnimationsPackage",null,[2,3]);var Nm=d(1002),jf=d(112);class Hf{constructor(z,T,ja,Ba){this.ia=z;this.Ga=T;this.mie=ja;this.qc=Ba}wb(){this.ia.ya(Xc.a.find,ed.a.view,Object(v.a)(this,this.findText,"findText"));this.ia.ya(Xc.a.find,ed.a.notes,Object(v.a)(this,this.findText,"findText"));this.ia.ya(Xc.a.find,ed.a.Ff,Object(v.a)(this,this.findText,
"findText"));this.ia.ya(oa.a.findInDocument,ed.a.view,Object(v.a)(this,this.findInDocument,"findInDocument"));zd.a("EnableFindInReadOnlyMode")?this.ia.$d(Xc.a.find,0):this.ia.$d(Xc.a.find,4);this.ia.ya(Xc.a.u4,ed.a.view,Object(v.a)(this,this.u4,"replaceText"));this.ia.ya(Xc.a.u4,ed.a.notes,Object(v.a)(this,this.u4,"replaceText"));this.ia.ya(Xc.a.u4,ed.a.Ff,Object(v.a)(this,this.u4,"replaceText"));this.ia.$d(Xc.a.u4,4)}Fe(){const z=[this.Ga.Bc(jf.a.zB),this.Ga.Bc(jf.a.VU),this.Ga.Bc(Id.a.sg),this.Ga.Bc(Id.a.QM)];
for(const T of z)T.bindAction($a.KeyInputManager.La(kg.a.H0,$a.KeyInputManager.He),Xc.a.find),T.bindAction($a.KeyInputManager.La(kg.a.Rhb,$a.KeyInputManager.He),Xc.a.u4)}findText(z,T,ja){return T.contextId!==ed.a.view&&T.contextId!==ed.a.notes&&T.contextId!==ed.a.Ff?2:1===ja?this.qc.wj()?32:8:2===ja?(this.mie.lrh(T),Wc.a.J(539773087,820,50,"FindTextDialog is initialized."),32):8}u4(z,T,ja){return T.contextId!==ed.a.view&&T.contextId!==ed.a.notes&&T.contextId!==ed.a.Ff?2:1===ja?this.qc.wj()?32:8:2===
ja?(this.mie.oel(T),Wc.a.J(539773088,820,50,"ReplaceTextDialog is initialized."),32):8}findInDocument(z,T,ja,Ba,Ga){if(T.contextId!==ed.a.view&&T.contextId!==ed.a.notes&&T.contextId!==ed.a.Ff)return 2;if(1===ja)return 32;if(2===ja){if(!Ga)return 8;z=Ga.CommandValueId||"";Wc.a.J(539773089,820,50,"Find. ActionData QueryLength: {0}",z.length);this.mie.Wdl(T,z);Wc.a.J(539773090,820,50,"FindTextDialog is initialized from Search Box.");return 32}return 8}}Object(h.a)(Hf,"FindReplaceTextActor",null,[234]);
var rj=d(1188);class Om extends rj.a{constructor(z,T,ja){super(!1,!0);this.fta=!1;this.n2c=null;this.Bta=!1;this.axb=this.O7b=null;this.p$a=!0;this.vie=this.wie=this.yEa=!1;this.Ika=null;this.J1c=!1;this.Yne=!0;this.Rzb=this.lIg=!1;this.uMg=this.wMg=null;this.ZJg=0;this.Ga=z;this.PK=T;this.d7j="FindReplaceTextDialog";this.NZ=ResourceStrings.l_FindTextTitle;ja&&(this.NZ=ResourceStrings.l_ReplaceTextTitle);this.Fke=ja;this.mR=!1}MT(){this.qj(this.NZ,this.PK,this.WM());this.fta=!1}dispose(){super.dispose();
this.fta=!0}kRd(){this.yEa=this.p$a=!1;this.VQ(this.NZ,this.PK,this.WM())}XXb(z){z&&(this.Ga.vf(Dd.AFrame.v_),this.yEa=!0);this.p$a=!0;this.VQ(this.NZ,this.PK,this.WM())}k7a(){this.hide()}NZk(z){this.n2c=z.searchString;this.Bta=z.matchCase;this.Ika=z.replaceString}kl(){return this.fta}oea(z,T){this.axb=z;this.ZJg=T;this.Rzb=0===T;this.VQ(this.NZ,this.PK,this.WM())}yfd(z){this.O7b=z;this.VQ(this.NZ,this.PK,this.WM())}Ufd(z){this.wMg=z;this.VQ(this.NZ,this.PK,this.WM())}tIe(z){this.uMg=z;this.VQ(this.NZ,
this.PK,this.WM())}get jXa(){return this.n2c}set jXa(z){this.n2c=z}get matchCase(){return this.Bta}set matchCase(z){this.Bta=z}get $De(){return this.Ika}set $De(z){this.Ika=z}OIi(z){z&&(this.Ga.vf(Dd.AFrame.v_),this.wie=!0);this.J1c=!0;this.VQ(this.NZ,this.PK,this.WM())}lRd(){this.wie=this.J1c=!1;this.VQ(this.NZ,this.PK,this.WM())}NIi(z){z&&(this.Ga.vf(Dd.AFrame.v_),this.vie=!0);this.Yne=!0;this.VQ(this.NZ,this.PK,this.WM())}TEi(){this.vie=this.Yne=!1;this.VQ(this.NZ,this.PK,this.WM())}kgl(){this.NZ=
ResourceStrings.l_ReplaceTextTitle;this.Fke=!0;zd.a("EnableFindInReadOnlyMode")&&(this.J1c=!1);this.VQ(this.NZ,this.PK,this.WM());this.Ga.vf(Dd.AFrame.v_)}MIi(){this.lIg=!0;this.VQ(this.NZ,this.PK,this.WM())}mXd(){return{["searchString"]:this.n2c,["findNextButtonAriaLabel"]:this.O7b,["errorMessage"]:this.axb,["findNextButtonIsEnabled"]:this.p$a,["focusFindNextButton"]:this.yEa,["focusDialog"]:Object(v.a)(this,this.OVd,"focusDialog"),["isReplaceActive"]:this.Fke,["replaceButtonIsEnabled"]:this.J1c,
["replaceAllButtonIsEnabled"]:this.Yne,["showMessageAsError"]:this.Rzb,["messageStatus"]:this.ZJg,["focusReplaceButton"]:this.wie,["focusReplaceAllButton"]:this.vie,["replaceButtonAriaLabel"]:this.wMg,["replaceAllButtonAriaLabel"]:this.uMg,["readOnlyModeEnabled"]:zd.a("EnableFindInReadOnlyMode")&&this.lIg}}WM(){return{["id"]:this.d7j,["bodyControls"]:this.mXd(),["isModal"]:!1}}OVd(){this.Ga.vf(Dd.AFrame.v_)}}Object(h.a)(Om,"ReactFindReplaceTextDialog",rj.a,[812]);class gm{constructor(z){this.Ga=z}getInstance(z,
T){return new Om(this.Ga.value,z,T)}}Object(h.a)(gm,"FindReplaceTextDialogFactory",null,[763]);class sj{constructor(){this.iJ=this.sO=this.paragraphIndex=this.rv=this.slideIndex=0}reset(){this.slideIndex=this.rv=this.paragraphIndex=0;this.sO=this.iJ=-1}clone(){const z=new sj;z.slideIndex=this.slideIndex;z.rv=this.rv;z.paragraphIndex=this.paragraphIndex;z.sO=this.sO;z.iJ=this.iJ;return z}}Object(h.a)(sj,"TextPosition",null,[]);class Rl{constructor(){this.jle=this.pXc=null;this.Ps=new sj;this.Vf=new sj;
this.state=this.uea=0;this.Wga=this.rYb=!1;this.pattern=this.zAa=this.CWb=null;this.matchCase=!1;this.reset()}reset(){this.uea=0;this.Ps.reset();this.Vf.reset();this.state=0;this.Wga=this.rYb=!1;this.jle=this.jqa=this.zAa=this.CWb=null}get jqa(){return this.pXc}set jqa(z){if(this.pXc=z)this.jle=this.pXc}get rPj(){return this.jle}}Object(h.a)(Rl,"FindContext",null,[]);var Dl=d(50),Pm=d(89);class hl{constructor(){this.ShouldMatchCase=!1}}Object(h.a)(hl,"MatchTextInfo",null,[]);class Tk{constructor(){this.ActiveSlideSid=
this.ActiveSlideCid=0;this.OldStr=this.NewStr=this.MatchTxtInfo=null}}Object(h.a)(Tk,"ReplaceAllTextInfo",null,[]);var de=d(664),Nf=d(153);class vm{constructor(){this.message=this.title=null;this.tig=!1;this.pDb=null;this.yig=!1;this.wed=null;this.cWk=this.Ixk=0;this.dWk=this.Jxk=null;this.sPe=0}}Object(h.a)(vm,"CalloutNotificationMessageAttributes",null,[]);var Uk=d(296);class El{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd,Zd,df,Ke,zf,Sf,Lh,Mh,si,Yh,Xd,Cm){this.A3=this.mm=this.Ez=null;this.Qb=
new Rl;this.Ika=this.Lz="";this.o9b=!1;this.vzb=this.uab=0;this.uzb=Date.now();this.I1c=-1;this.ia=z;this.vEa=T;this.Ga=ja;this.Hn=Ba;this.qc=Ga;this.Fa=Fb;this.fk=Rb;this.t3=tc;this.Pb=Ac;this.Bb=kd;this.Wb=nd;this.ua=Bd;this.Ib=Zd;this.Jb=zf;this.Ue=df;this.kq=Ke;this.cW=Sf;this.U8=Lh;this.yJg=Mh;this.Qab=si;this.k$b=Yh;this.cQ=Cm;this.vMg=Xd}lrh(z){this.Ez=z;this.mm=this.yJg.value.getInstance(Object(v.a)(this,this.p2f,"findReplaceTextDialogResultHandler"),!1);this.Lz&&(this.mm.jXa=this.Lz);this.mm.MT(z);
zd.a("EnableFindInReadOnlyMode")&&3!=this.ia.mode&&this.mm.MIi();this.KRa()&&this.iRd()}Wdl(z,T){this.KRa()||(this.Lz=T);this.lrh(z);this.KRa()||(this.mm.jXa=this.Lz,this.mm.MT(z),this.mQe(T,!1))}oel(z){this.Ez=z;this.mm=this.yJg.value.getInstance(Object(v.a)(this,this.p2f,"findReplaceTextDialogResultHandler"),!0);this.Lz&&(this.mm.jXa=this.Lz);this.mm.MT(z);this.KRa()&&this.iRd()}p2f(z,T){if(T)switch(this.mm.NZk(T),z){case 1:this.Kfk();break;case 2:this.Lfk();break;case 3:this.Mfk(this.mm.$De);break;
default:this.k9k(),this.clearSelection(),this.Qb.reset(),this.mm.k7a()}else Wc.a.J(539550656,820,10,"Got null control value for findreplace dialog")}mQe(z,T){this.VVf();0!==this.Qb.state&&3!==this.Qb.state&&z===this.Lz&&T===this.o9b||this.n5d(z,T);this.Qb.Wga=!1;this.DGa()}get aSb(){return this.ua.Ca?this.ua.Ca.Ge:0}n5d(z,T){const ja=z===this.Lz&&3===this.Qb.state,Ba=this.Qb.Ps.clone();this.Qb.reset();this.Lz=z;this.o9b=T;zd.a("FixFindReplaceWrapSearch")&&ja?this.Qb.Ps=Ba.clone():(this.Qb.Ps.slideIndex=
this.aSb,this.t1i());this.Qb.Vf=this.Qb.Ps.clone()}DGa(){this.jVd(this.Lz,this.o9b)?4!==this.Qb.state&&this.setSelection():(e.ULS.sendTraceTag(539829126,820,50,"Text not found"),this.zha())}jVd(z,T){var ja=this.ua.presentation;if(!ja)throw Error.argumentNull("Presentation is null");if(ja=ja.slides||[],ja.length){this.Qb.uea=ja.length;const Ba=ja.length+this.Qb.Ps.slideIndex;for(;this.Qb.Vf.slideIndex<=Ba;){const Ga=this.Qb.Vf.slideIndex%ja.length,Fb=this.lVd(ja[Ga],z,T,this.Qb.Vf.slideIndex===Ba?
this.Qb.Ps.rv:El.kre);if(Fb&&(this.Qb.CWb=this.qc.Bk(Fb.Cb)))return!0;if(7===this.Qb.state)return this.Qb.Wga&&(Wc.a.J(539829127,820,50,"call into PerformBackendFind recursively."),this.Qb.state=0),this.yxe(ja[Ga]?ja[Ga].Cb:null,z,T);if(3===this.Qb.state)break;let Rb;(Rb=this.Qb.Vf).slideIndex=Rb.slideIndex+1;this.Qb.Vf.rv=0}}else this.Qb.state=1;return!1}lVd(z,T,ja,Ba){if(!z)return null;var Ga=this.qc.Bk(z.Cb),Fb=this.Ib.Jc(Ga);Ga=Ga.xra()||[];(Fb=Fb.yb(27))&&Ga.push(Fb);if(!Ga.length)return this.Qb.state=
7,null;for(;this.Qb.Vf.rv<=Math.min(Ga.length-1,Ba);){if(this.Qb.zAa=this.kVd(Ga[this.Qb.Vf.rv],T,ja,this.Qb.Vf.rv===Ba?this.Qb.Ps.paragraphIndex:El.kre))return z;let Rb;(Rb=this.Qb.Vf).rv=Rb.rv+1;this.Qb.Vf.paragraphIndex=0}return null}kVd(z,T,ja,Ba){if(zd.a("FindTextInShapePromptFix")&&!this.fk.Tia(z)&&z.FA)return null;const Ga=Pm.a.createInstance(z);let Fb=0;for(;Ga.moveNext()&&this.Qb.Vf.paragraphIndex<=Ba;){const Rb=Ga.currentNode;if(ad.ParagraphReader.Pd(Rb)&&Fb++===this.Qb.Vf.paragraphIndex){if(this.Qb.jqa=
this.iVd(Rb,T,ja,this.Qb.Vf.paragraphIndex===Ba?this.Qb.Ps.sO:El.kre))return z;let tc;(tc=this.Qb.Vf).paragraphIndex=tc.paragraphIndex+1;this.Qb.Vf.sO=this.Qb.Vf.iJ=-1}}return null}iVd(z,T,ja,Ba){if(!ad.ParagraphReader.Pd(z))return null;let Ga=z.X5a();if(!Ga.length)return null;Ga=Ga.substring(0,Math.min(Ga.length,Ba));return this.mVd(Ga,Math.max(0,this.Qb.Vf.iJ),T,ja)?z:null}mVd(z,T,ja,Ba){let Ga=z,Fb=ja;Ba||(Ga=z.toLowerCase(),Fb=ja.toLowerCase());z=Ga.indexOf(Fb,-1===T?0:T);if(-1!==z)return this.Qb.Vf.sO=
z,this.Qb.Vf.iJ=z+Fb.length,this.Qb.state=2,this.Qb.rYb=!0;this.Qb.state=1;return!1}t1i(){var z=Nf.b(this.Ez);z=z?z.Eb:null;if(!z||!z.Pa)e.ULS.sendTraceTag(539829130,820,50,"There could be no slide at all");else if(z.Pa.kb){var T=z.Pa.kb.Wa;if(ad.ParagraphReader.Pd(T.node)){z=Object(A.a)(5,T.node);this.Qb.Ps.sO=T.Qa;this.Qb.Ps.iJ=T.Qa;const ja=this.Fa.f7(T.node);ja?(this.Qb.Ps.rv=ja.get_zIndex()-1,this.Qb.Ps.paragraphIndex=this.C_b(z)):this.fk.p6a(T.node)&&(T=this.ua.Ca?this.ua.Ca.xra():null,this.Qb.Ps.rv=
T?T.length:0,this.Qb.Ps.paragraphIndex=this.C_b(z))}else this.Fa.rsa(T.node)&&(this.Qb.Ps.rv=T.node.get_zIndex()-1)}}C_b(z){z=this.Ib.Jc(z);if(!z.t0(ja=>10===ja.type||60===ja.type||16===ja.type))return 0;z.yc();const T=z.Gp;z.yc();return Math.max(0,z.DBa(T))}$bc(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");return this.Qb.Ps.slideIndex||this.Qb.Ps.rv?this.Qb.Vf.slideIndex<(z.slides||[]).length:!1}T0b(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");
this.Qb.Vf.slideIndex=z.slides?z.slides.length:0;this.Qb.Wga=!1;this.DGa()}wRc(){return this.mm.kl()}Ite(z){if(!this.wRc()){Wc.a.J(539829132,820,50,"OnBackendFindSucceeded");var T=md.a.empty;({slideId:T}=md.a.OQe(z));(z=this.qc.bia(T))?(T=z.slideIndex,T>this.Qb.Ps.slideIndex&&T<this.Qb.Vf.slideIndex?this.zha():this.Wb.Ca!==z?(this.Hn.DR(Object(v.a)(this,this.Tua,"onActiveSlideDomChanged")),this.Wb.Ca=z):(this.Qb.state=5,this.Qb.Wga=!0,this.Qb.Vf.slideIndex=this.Qb.Vf.slideIndex>T?T+this.Qb.uea:T,
this.Qb.Vf.rv=0,this.Qb.Vf.paragraphIndex=0,this.Qb.Vf.sO=-1,this.Qb.Vf.iJ=-1,this.DGa())):this.$bc()?this.T0b():this.zha()}}Tua(){Wc.a.J(539829133,820,50,"OnActiveSlideDomChanged");this.Hn.lma(Object(v.a)(this,this.Tua,"onActiveSlideDomChanged"));this.wRc()||this.A3||(this.A3=new od.a(3,1,0,Object(v.a)(this,this.bdc,"onPostActiveSlideDomChangedTask"),90,"30"),this.Bb.Hb(this.A3))}bdc(){Wc.a.J(539829134,820,50,"OnPostActiveSlideDomChangedTask");this.A3=null;if(!this.wRc())if(4===this.Qb.state){const z=
this.aSb;this.Qb.Vf.slideIndex=this.Qb.Vf.slideIndex>z?z+this.Qb.uea:z;this.Qb.state=5;this.Qb.Wga=!0;this.DGa()}else 2===this.Qb.state?this.setSelection():this.zha()}Hte(){this.wRc()||(Wc.a.J(539829135,820,50,"OnBackendFindFailed"),this.$bc()?this.T0b():this.zha())}yxe(z,T,ja){Wc.a.J(539829136,820,50,"PerformBackendFind");this.vEa.findText(T,ja,z.toString(),Object(v.a)(this,this.Ite,"onBackendFindSucceeded"),Object(v.a)(this,this.Hte,"onBackendFindFailed"));this.Qb.state=4;return!0}zha(){this.Qb.state=
this.Qb.rYb?3:1;Wc.a.J(539829137,820,50,"End of Find: {0}",this.Qb.state);this.clearSelection();this.oea(0,"");zd.a("FixFindReplaceWrapSearch")||this.Qb.reset()}getShapeType(z){return z.xx?ResourceStrings.L_TextBox:z.Gq?ResourceStrings.l_Chart:z.rd?ResourceStrings.L_Table:z.fg?ResourceStrings.L_SmartArt:z.hq?ResourceStrings.L_Media:z.sk?ResourceStrings.l_Picture:z.ll?ResourceStrings.l_Placeholder:ResourceStrings.l_ShapeObject}setSelection(){var z=this.Qb.jqa,T=this.Qb.CWb;if(this.Wb.Ca!==T)this.Hn.DR(Object(v.a)(this,
this.Tua,"onActiveSlideDomChanged")),this.Wb.Ca=T;else{z=Dl.SelectionFactory.PY(z,this.Qb.Vf.sO,this.Qb.Vf.iJ);if(this.fk.Tia(this.Qb.zAa))this.ia.Ma(Xc.a.VXa,2,new de.a(!0)),this.Ga.vf(jf.a.VU),this.t3.setSelection(z),this.oea(this.Qb.Vf.slideIndex%this.qc.wj()+1,ResourceStrings.l_NotesPaneType);else{T=this.Qb.zAa;const ja=this.Qb.zAa.yg(this.Pb.Na);if(ja)if(ja.jp){let Ba;(Ba=this.Qb.Vf).rv=Ba.rv+1;this.Qb.Vf.paragraphIndex=0;this.Qb.Vf.sO=0;this.Qb.Vf.iJ=0;ja.tkc()}else this.k$b&&T.fg?(this.Ue.HBe(new Uk.a(T)),
this.U8.setSelection(z)):(this.Ga.vf(Id.a.sg),this.Pb.setSelection(z));this.oea(this.Qb.Vf.slideIndex%this.qc.wj()+1,this.getShapeType(T))}Wc.a.J(539829139,820,50,"Find Text: {0}/{1}/{2}/({3},{4} )",this.Qb.Vf.slideIndex,this.Qb.Vf.rv,this.Qb.Vf.paragraphIndex,this.Qb.Vf.sO,this.Qb.Vf.iJ);this.GSd()}}clearSelection(){var z=Nf.b(this.Ez);if(z=z?z.Eb:null)if(zd.a("FixFindReplaceDialogFocusLost")){var T=this.Qb.rPj;T&&(T=Dl.SelectionFactory.Lg(T,0),z.setSelection(T))}else z.setSelection(null);else Wc.a.J(539084303,
820,10,"Find Replace Text: Selection manager received as null when clearing selection")}oea(z,T){const ja=new Sys.StringBuilder,Ba=new Sys.StringBuilder;let Ga=!1;switch(this.Qb.state){case 1:Ga=!0;ja.append(ResourceStrings.l_FindTextNotFound);break;case 3:ja.append(ResourceStrings.l_FindTextFindOver);break;case 6:Ga=!0;ja.append(ResourceStrings.l_FindTextFindAgain);break;case 2:Ba.append(String.format(ResourceStrings.l_FindTextMessage,z,T));break;default:Wc.a.J(539829140,820,50,"Find Text: {0}",
this.Qb.state)}this.O0k(ja.toString(),Ga,Ba.isEmpty()?ja.toString():Ba.toString());this.GSd()}eml(z){z=this.wPk(z);32===z&&this.mQe(this.Lz,this.o9b);16===z&&(this.mm.oea(ResourceStrings.l_ReplaceTextErrorMessage,0),this.mm.lRd(),this.mm.XXb(!0))}wPk(z){return Od.a.dIc("SingleReplaceAction",Xc.a.u4,()=>{z||(z="",Wc.a.J(537953098,820,50,"Replacing with empty string"));var T=this.Qb.jqa;if(!T)return Wc.a.J(537953099,820,10,"ParagraphNode not set in findContext"),16;var ja=this.Qb.Vf.sO;const Ba=this.Qb.Vf.iJ;
if(-1===ja||-1===Ba)return Wc.a.J(537953100,820,10,"Invalid start or end position of current text selection."),16;const Ga=this.kq.ie(15);Ga.hd(T);this.cW.replaceTextRange(Lc.a.createTextRange(T,ja,Ba),z,!0,!1,Xc.a.u4);T=ja+z.length;ja=T!==this.Qb.Vf.iJ;this.Qb.Vf.iJ=T;Ga.dispose();ja&&this.setSelection();return 32})}GSd(){this.mm.XXb(1===this.uab);this.Qb.jqa?this.mm.OIi(2===this.uab):this.mm.lRd();this.mm.NIi(3===this.uab)}VVf(){this.mm.kRd();this.mm.lRd();this.mm.TEi()}O0k(z,T,ja){2===this.uab?
(this.mm.Ufd(ResourceStrings.l_ReplaceTextReplaced+". "+ja),this.mm.yfd("")):(this.mm.yfd(ja),this.mm.Ufd(""));this.mm.tIe("");this.mm.oea(z,T?0:1)}Kfk(){zd.a("FixFindReplaceEmptyInputCrash")&&Ub.a.Xa(this.mm.jXa)||Od.a.dIc("FindNext",Xc.a.find,()=>{Wc.a.J(538998996,820,50,"Find Text Started");this.uab=1;this.mQe(this.mm.jXa,this.mm.matchCase);return 32})}Lfk(){this.mm.Fke?(Wc.a.J(538998997,820,50,"Replace Text Started"),this.uab=2,this.eml(this.mm.$De)):(this.mm.kgl(),Wc.a.J(539084640,820,50,"Find dialog switched to replace dialog"))}Mfk(z){this.KRa()?
Wc.a.J(526951570,820,10,"ReplaceAll Already in progress. ReplaceAllStartTime:{0}, Time diff:{1}",this.vzb,Date.now()-this.vzb):Ub.a.Xa(this.mm.jXa)||(this.Lz=this.mm.jXa,this.Ika=z?z:"",this.vzb=Date.now(),this.uab=3,this.iRd(),this.pPi(this.ua.Ca,this.Lz,this.Ika,this.o9b),0<this.vMg&&(this.I1c=window.setTimeout(()=>{this.vZg()},this.vMg)),16===this.replaceAll()&&(this.uzb=Date.now(),this.RMf(),this.vZg()))}replaceAll(){return Od.a.dIc("ReplaceAllAction",Xc.a.u4,()=>{Wc.a.J(536887459,820,50,"ReplaceAll Text Started");
const z=this.ua.presentation;if(z){const T=this.Jb.xd(15);try{T.lc(z),this.Qab.yk(Object(v.a)(this,this.Mcb,"onPresentationPropertyChange")),z.vEb=Object.assign(new Tk,{NewStr:this.Ika,OldStr:this.Lz,ActiveSlideCid:this.ua.Ca.cid,ActiveSlideSid:this.ua.Ca.sid,MatchTxtInfo:Object.assign(new hl,{ShouldMatchCase:this.mm.matchCase})})}finally{T&&T.dispose()}return 32}return 16})}pPi(z,T,ja,Ba){if(z){z=this.qc.Bk(z.Cb);var Ga=this.Ib.Jc(z);z=z.xra()||[];(Ga=Ga.yb(27))&&z.push(Ga);if(z.length)for(Ga=0;Ga<=
z.length-1;)this.sQi(z[Ga],T,ja,Ba),Ga++}else Wc.a.J(527270942,820,50,"slide must not be null.")}sQi(z,T,ja,Ba){if(this.fk.Tia(z)||!z.FA)for(z=Pm.a.createInstance(z);z.moveNext();){const Ga=z.currentNode;if(!ad.ParagraphReader.Pd(Ga))continue;let Fb=null;(Fb=this.oQi(Ga,T,Ba))&&Fb.characterData.replace(T,ja)}}oQi(z,T,ja){if(!ad.ParagraphReader.Pd(z))return Wc.a.J(527270943,820,50,"node must be ParagraphNode"),null;const Ba=z.X5a();return Ba.length?this.pQi(Ba,T,ja)?z:null:null}pQi(z,T,ja){let Ba=
z,Ga=T;ja||(Ba=z.toLowerCase(),Ga=T.toLowerCase());return-1!==Ba.indexOf(Ga,0)?!0:!1}Mcb(z,T){if(!this.KRa())Wc.a.J(526951571,820,50,"ReplaceAll Not Iniitated");else if(T.property===gg.a.WDe){this.RMf();z=Object(A.a)(408,T.node);if(-1!==z.oma){var ja=2;if(0===z.oma){T=ResourceStrings.l_FindTextNotFound;var Ba=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchMessage;ja=0;var Ga=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchTitle}else 1===z.oma?(T=String.format(ResourceStrings.l_ReplaceAllSuccessSingular,
z.oma,this.Lz,this.Ika),Ba=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessageSingular,z.oma,this.Lz,this.Ika)):(T=String.format(ResourceStrings.l_ReplaceAllSuccessPlural,z.oma,this.Lz,this.Ika),Ba=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessagePlural,z.oma,this.Lz,this.Ika)),Ga=ResourceStrings.l_ReplaceAllCalloutNotificationSuccessTitle}else Ga=ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,T=Ba=ResourceStrings.l_ReplaceAllErrorMessage,ja=0,Wc.a.J(525111622,
820,10,"Invalid ReplaceAllTextCount");this.uzb=Date.now();Wc.a.J(524326939,820,50,"Time taken for Replace All operation in ms: {0}",this.uzb-this.vzb);this.xYf(T,ja);this.Qab.Pm(Object(v.a)(this,this.Mcb,"onPresentationPropertyChange"));this.mm.kl()&&this.JKe(Ga,Ba,10);z.oma=-16}}KRa(){return this.vzb>this.uzb}iRd(){var z=String.format(ResourceStrings.l_ReplaceAllInProgress,this.Lz);this.mm.oea(z,3);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceAllTextReplaceAll,
this.Lz);this.mm.tIe(z);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceTextReplace,this.Lz);this.mm.Ufd(z);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_FindTextFindNext,this.Lz);this.mm.yfd(z);this.VVf()}xYf(z,T){this.mm.oea(z,T);this.mm.tIe(z);this.mm.Ufd("");this.mm.yfd("");this.GSd()}k9k(){if(this.KRa()){var z=String.format(ResourceStrings.l_ReplaceAllInProgress,this.Lz);this.JKe(ResourceStrings.l_ReplaceAllCalloutNotificationProgressTitle,
z,1024)}}JKe(z,T,ja){this.cQ?(this.cQ.pRd(),Wc.a.J(524038754,820,50,"Callout notification called for Replace All operation"),z=Object.assign(new vm,{title:z,message:T,sPe:ja}),z=this.cQ.l9k(z),z.oRa&&Wc.a.J(526149376,820,10,"Error in callout notification: Error:{0}",z.message)):Wc.a.J(526198044,820,10,"Find Replace Text: m_calloutNotification adapter is null.")}vZg(){let z=!1;this.KRa()&&(z=!0,this.uzb=Date.now());Wc.a.J(520970945,820,10,"Error returned in replace all operation. ReplaceAll Timeout: {0}, Time taken in ms: {1}",
z,this.uzb-this.vzb);this.xYf(ResourceStrings.l_ReplaceAllErrorMessage,0);this.Qab.Pm(Object(v.a)(this,this.Mcb,"onPresentationPropertyChange"));this.mm.kl()&&this.JKe(ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,ResourceStrings.l_ReplaceAllErrorMessage,10);this.ua.presentation.oma=-16}RMf(){-1!==this.I1c&&(window.clearTimeout(this.I1c),this.I1c=-1)}}El.kre=1024;Object(h.a)(El,"FindReplaceTextHandler",null,[764]);class Jj{constructor(z,T,ja,Ba,Ga){this.ia=z;this.Ga=T;this.la=ja;this.zJg=
Ba;this.qc=Ga}wb(){this.la.q8d&&(this.ia.ya(Xc.a.find,ed.a.view,Object(v.a)(this,this.findText,"findText")),this.ia.ya(Xc.a.find,ed.a.notes,Object(v.a)(this,this.findText,"findText")),this.ia.ya(Xc.a.find,ed.a.Ff,Object(v.a)(this,this.findText,"findText")),this.ia.ya(oa.a.findInDocument,ed.a.view,Object(v.a)(this,this.findInDocument,"findInDocument")),this.ia.$d(Xc.a.find,100))}Fe(){if(this.la.q8d){const z=this.Ga.Bc(jf.a.zB),T=this.Ga.Bc(jf.a.VU),ja=this.Ga.Bc(Id.a.sg),Ba=this.Ga.Bc(Id.a.QM);z.bindAction($a.KeyInputManager.La(kg.a.H0,
2),Xc.a.find);T.bindAction($a.KeyInputManager.La(kg.a.H0,2),Xc.a.find);ja.bindAction($a.KeyInputManager.La(kg.a.H0,2),Xc.a.find);Ba.bindAction($a.KeyInputManager.La(kg.a.H0,2),Xc.a.find)}}findText(z,T,ja){return T.contextId!==ed.a.view&&T.contextId!==ed.a.notes&&T.contextId!==ed.a.Ff?2:1===ja?this.qc.wj()?32:8:2===ja?(z=this.zJg.value.getInstance(),Wc.a.J(21849537,820,50,"FindTextDialog is initialized."),z.MT(T),32):8}findInDocument(z,T,ja,Ba,Ga){if(T.contextId!==ed.a.view&&T.contextId!==ed.a.notes&&
T.contextId!==ed.a.Ff)return 2;if(1===ja)return 32;if(2===ja){if(!Ga)return 8;z=Ga.CommandValueId||"";Wc.a.J(40208283,820,50,"Find. ActionData QueryLength: {0}",z.length);ja=this.zJg.value.getInstance();Wc.a.J(40208286,820,50,"FindTextDialog is initialized.");ja.E9k(T,z);return 32}return 8}}Object(h.a)(Jj,"FindTextActor",null,[234]);class Kj extends rj.a{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd,Zd,df,Ke,zf){super(!1,!0);this.PK=null;this.Qb=new Rl;this.Ez=null;this.fta=!1;this.Lz="";this.Bta=
!1;this.axb=this.O7b=null;this.p$a=!0;this.Rzb=this.yEa=!1;this.A3=null;this.ia=z;this.vEa=T;this.Ga=ja;this.Hn=Ba;this.qc=Ga;this.Fa=Fb;this.fk=Rb;this.t3=tc;this.Pb=Ac;this.Bb=kd;this.Wb=nd;this.ua=Bd;this.Ib=Zd;this.Ue=df;this.U8=Ke;this.k$b=zf;this.mR=!1}MT(z){this.Ez=z;this.PK=Object(v.a)(this,this.FEk,"reactFindTextDialogResultHandler");this.qj(ResourceStrings.l_FindTextTitle,this.PK,this.WM())}E9k(z,T){this.MT(z);this.startSearch(T,!0)}dispose(){super.dispose();this.fta=!0}FEk(z,T){Od.a.EE(Od.a.Nm("FindNext",
1),()=>{this.fta=!1;1===z?(this.kwl(T),Wc.a.J(539842781,820,50,"FindNext is clicked")):this.k7a()})}kwl(z){if(z){var T=z.searchString;T&&this.startSearch(T,z.matchCase)}}startSearch(z,T){Kj.Mgh=z;this.kRd();0!==this.Qb.state&&z===this.Lz&&T===this.Bta||this.n5d(z,T);this.Qb.Wga=!1;this.DGa()}kRd(){this.yEa=this.p$a=!1;this.VQ(ResourceStrings.l_FindTextTitle,this.PK,this.WM())}XXb(){this.Ga.vf(Dd.AFrame.v_);this.yEa=this.p$a=!0;this.VQ(ResourceStrings.l_FindTextTitle,this.PK,this.WM())}n5d(z,T){this.Qb.reset();
this.Lz=z;this.Bta=T;this.Qb.Ps.slideIndex=this.aSb;this.kuk();this.Qb.Vf=this.Qb.Ps.clone();this.axb="";this.yEa=this.Rzb=!1;this.VQ(ResourceStrings.l_FindTextTitle,this.PK,this.WM())}kuk(){var z=Nf.b(this.Ez);if((z=z?z.Eb:null)&&z.Pa&&z.Pa.kb){var T=z.Pa.kb.Wa;if(T)if(ad.ParagraphReader.Pd(T.node)){z=Object(A.a)(5,T.node);this.Qb.Ps.sO=T.Qa;this.Qb.Ps.iJ=T.Qa;const ja=this.Fa.f7(T.node);ja?(this.Qb.Ps.rv=ja.get_zIndex()-1,this.Qb.Ps.paragraphIndex=this.C_b(z)):this.fk.p6a(T.node)?(T=this.ua.Ca?
this.ua.Ca.xra():null,this.Qb.Ps.rv=T?T.length:0,this.Qb.Ps.paragraphIndex=this.C_b(z)):Wc.a.J(541640769,820,10,"Orphan paragraph node.")}else this.Fa.rsa(T.node)&&(this.Qb.Ps.rv=T.node.get_zIndex()-1)}}DGa(){this.jVd(this.Lz,this.Bta)?4!==this.Qb.state&&this.setSelection():this.zha()}zha(){this.Qb.state=this.Qb.rYb?3:1;this.oea(0,"");this.Qb.reset()}setSelection(){var z=this.Qb.jqa,T=this.Qb.CWb;if(this.Wb.Ca!==T)this.Hn.DR(Object(v.a)(this,this.Tua,"onActiveSlideDomChanged")),this.Wb.Ca=T;else{z=
Dl.SelectionFactory.PY(z,this.Qb.Vf.sO,this.Qb.Vf.iJ);if(this.fk.Tia(this.Qb.zAa))this.ia.Ma(Xc.a.VXa,2,new de.a(!0)),this.Ga.vf(jf.a.VU),this.t3.setSelection(z),this.oea(this.Qb.Vf.slideIndex%this.qc.wj()+1,ResourceStrings.l_NotesPaneType);else{T=this.Qb.zAa;const ja=this.Qb.zAa.yg(this.Pb.Na);if(ja)if(ja.jp){let Ba;(Ba=this.Qb.Vf).rv=Ba.rv+1;this.Qb.Vf.paragraphIndex=0;this.Qb.Vf.sO=0;this.Qb.Vf.iJ=0;ja.tkc()}else this.k$b&&T.fg?(this.Ue.HBe(new Uk.a(T)),this.U8.setSelection(z)):(this.Ga.vf(Id.a.sg),
this.Pb.setSelection(z));else Wc.a.J(541640770,820,10,"ShapeViewElement is null.");this.oea(this.Qb.Vf.slideIndex%this.qc.wj()+1,this.getShapeType(T))}this.XXb()}}getShapeType(z){return z.xx?ResourceStrings.L_TextBox:z.Gq?ResourceStrings.l_Chart:z.rd?ResourceStrings.L_Table:z.fg?ResourceStrings.L_SmartArt:z.hq?ResourceStrings.L_Media:z.sk?ResourceStrings.l_Picture:z.ll?ResourceStrings.l_Placeholder:ResourceStrings.l_ShapeObject}jVd(z,T){var ja=this.ua.presentation;if(!ja)throw Error.argumentNull("Presentation");
if(ja.slides&&ja.slides.length){ja=ja.slides;this.Qb.uea=ja.length;const Ga=ja.length+this.Qb.Ps.slideIndex;for(;this.Qb.Vf.slideIndex<=Ga;){var Ba=this.Qb.Vf.slideIndex%ja.length;const Fb=this.lVd(ja[Ba],z,T,this.Qb.Vf.slideIndex===Ga?this.Qb.Ps.rv:1024);if(Fb&&(this.Qb.CWb=this.qc.Bk(Fb.Cb)))return!0;if(7===this.Qb.state&&(this.Qb.Wga&&(this.Qb.state=0),Ba=ja[Ba]?ja[Ba].Cb:null))return this.yxe(Ba,z,T);if(3===this.Qb.state)break;let Rb;(Rb=this.Qb.Vf).slideIndex=Rb.slideIndex+1;this.Qb.Vf.rv=0}}else this.Qb.state=
1;return!1}lVd(z,T,ja,Ba){if(!z)return Wc.a.J(541640771,820,10,"Slide is null."),null;var Ga=this.qc.Bk(z.Cb),Fb=this.Ib.Jc(Ga);Ga=Ga.xra()||[];(Fb=Fb.yb(27))&&Ga.push(Fb);if(!Ga.length)return this.Qb.state=7,null;for(;this.Qb.Vf.rv<=Math.min(Ga.length-1,Ba);){if(this.Qb.zAa=this.kVd(Ga[this.Qb.Vf.rv],T,ja,this.Qb.Vf.rv===Ba?this.Qb.Ps.paragraphIndex:1024))return z;let Rb;(Rb=this.Qb.Vf).rv=Rb.rv+1;this.Qb.Vf.paragraphIndex=0}return null}kVd(z,T,ja,Ba){if(zd.a("FindTextInShapePromptFix")&&!this.fk.Tia(z)&&
z.FA)return null;const Ga=Pm.a.createInstance(z);let Fb=0;for(;Ga.moveNext()&&this.Qb.Vf.paragraphIndex<=Ba;){const Rb=Ga.currentNode;if(ad.ParagraphReader.Pd(Rb)&&Fb++===this.Qb.Vf.paragraphIndex){if(this.Qb.jqa=this.iVd(Rb,T,ja,this.Qb.Vf.paragraphIndex===Ba?this.Qb.Ps.sO:1024))return z;let tc;(tc=this.Qb.Vf).paragraphIndex=tc.paragraphIndex+1;this.Qb.Vf.sO=this.Qb.Vf.iJ=-1}}return null}yxe(z,T,ja){this.vEa.findText(T,ja,z.toString(),Object(v.a)(this,this.Ite,"onBackendFindSucceeded"),Object(v.a)(this,
this.Hte,"onBackendFindFailed"));this.Qb.state=4;return!0}T0b(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation");this.Qb.Vf.slideIndex=z.slides?z.slides.length:0;this.Qb.Wga=!1;this.DGa()}$bc(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation");return this.Qb.Ps.slideIndex||this.Qb.Ps.rv?this.Qb.Vf.slideIndex<(z.slides||[]).length:!1}Hte(){this.fta||(this.$bc()?this.T0b():this.zha())}Ite(z){if(!this.fta){var T=md.a.empty;({slideId:T}=md.a.OQe(z));
(z=this.qc.bia(T))?(T=z.slideIndex,T>this.Qb.Ps.slideIndex&&T<this.Qb.Vf.slideIndex?this.zha():this.Wb.Ca!==z?(this.Hn.DR(Object(v.a)(this,this.Tua,"onActiveSlideDomChanged")),this.Wb.Ca=z):(this.Qb.state=5,this.Qb.Wga=!0,this.Qb.Vf.slideIndex=this.Qb.Vf.slideIndex>T?T+this.Qb.uea:T,this.Qb.Vf.rv=0,this.Qb.Vf.paragraphIndex=0,this.Qb.Vf.sO=-1,this.Qb.Vf.iJ=-1,this.DGa())):this.$bc()?this.T0b():this.zha()}}iVd(z,T,ja,Ba){if(!ad.ParagraphReader.Pd(z))return Wc.a.J(541640772,820,10,"node must be Paragraph node."),
null;let Ga=z.X5a();if(!Ga.length)return null;Ga=Ga.substring(0,Math.min(Ga.length,Ba));return this.mVd(Ga,Math.max(0,this.Qb.Vf.iJ),T,ja)?z:null}Tua(){this.Hn.lma(Object(v.a)(this,this.Tua,"onActiveSlideDomChanged"));this.fta||this.A3||(this.A3=new od.a(3,1,0,Object(v.a)(this,this.bdc,"onPostActiveSlideDomChangedTask"),90,"30"),this.Bb.Hb(this.A3))}bdc(){this.A3=null;if(!this.fta)if(4===this.Qb.state){const z=this.aSb;this.Qb.Vf.slideIndex=this.Qb.Vf.slideIndex>z?z+this.Qb.uea:z;this.Qb.state=5;
this.Qb.Wga=!0;this.DGa()}else 2===this.Qb.state?this.setSelection():this.zha()}mVd(z,T,ja,Ba){let Ga=z,Fb=ja;Ba||(Ga=z.toLowerCase(),Fb=ja.toLowerCase());z=Ga.indexOf(Fb,-1===T?0:T);if(-1!==z)return this.Qb.Vf.sO=z,this.Qb.Vf.iJ=z+Fb.length,this.Qb.state=2,this.Qb.rYb=!0;this.Qb.state=1;return!1}C_b(z){z=this.Ib.Jc(z);if(!z.t0(ja=>10===ja.type||60===ja.type||16===ja.type))return 0;z.yc();const T=z.Gp;z.yc();return Math.max(0,z.DBa(T))}get aSb(){return this.ua.Ca?this.ua.Ca.Ge:0}k7a(){this.Qb.reset();
this.hide()}mXd(){return{["searchString"]:Kj.Mgh,["findNextButtonAriaLabel"]:this.O7b,["errorMessage"]:this.axb,["findNextButtonIsEnabled"]:this.p$a,["focusFindNextButton"]:this.yEa,["focusDialog"]:Object(v.a)(this,this.OVd,"focusDialog"),["showMessageAsError"]:this.Rzb}}OVd(){this.Ga.vf(Dd.AFrame.v_)}WM(){return{["id"]:"FindTextDialog",["bodyControls"]:this.mXd(),["isModal"]:!1}}oea(z,T){const ja=new Sys.StringBuilder,Ba=new Sys.StringBuilder;let Ga=!1;switch(this.Qb.state){case 1:Ga=!0;ja.append(ResourceStrings.l_FindTextNotFound);
break;case 3:ja.append(ResourceStrings.l_FindTextFindOver);break;case 6:Ga=!0;ja.append(ResourceStrings.l_FindTextFindAgain);break;case 2:Ba.append(String.format(ResourceStrings.l_FindTextMessage,z,T))}this.axb=ja.toString();this.Rzb=Ga;this.O7b=Ba.toString();this.yEa=!0;this.VQ(ResourceStrings.l_FindTextTitle,this.PK,this.WM());this.XXb()}}Kj.Mgh=null;Object(h.a)(Kj,"ReactFindTextDialog",rj.a,[810]);class Hi{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd,Zd,df,Ke,zf){this.ia=z;this.vEa=T;this.Ga=
ja;this.Hn=Ba;this.qc=Ga;this.Fa=Fb;this.fk=Rb;this.t3=tc;this.Pb=Ac;this.Bb=kd;this.Wb=nd;this.ua=Bd;this.Ib=Zd;this.Ue=df;this.U8=Ke;this.k$b=zf}getInstance(){return new Kj(this.ia,this.vEa.value,this.Ga.value,this.Hn,this.qc,this.Fa,this.fk,this.t3,this.Pb,this.Bb.value,this.Wb,this.ua,this.Ib,this.Ue,this.U8,this.k$b)}}Object(h.a)(Hi,"FindTextDialogFactory",null,[762]);class xi{constructor(z){this.QJg=this.wOg=null;this.Bta=!1;this.D3=z}findText(z,T,ja,Ba,Ga){this.QJg=z;this.Bta=T;this.wOg=ja;
this.D3.JE(Ba,Ga,null)}get qel(){return this.wOg}get matchCase(){return this.Bta}get z4c(){return this.QJg}}Object(h.a)(xi,"FindTextManager",null,[761]);var ni=d(376),pg=d(107);class ul extends pg.a{constructor(){super();this.MatchText=null;this.MatchCase=!1;this.SlideID=null}Lk(){return 54}static mNd(z,T,ja){const Ba=new ul;Ba.SlideID=ja;Ba.MatchText=z;Ba.MatchCase=T;return Ba}}Object(h.a)(ul,"FindTextRequest",pg.a,[]);class Rn extends ni.a{constructor(z,T,ja,Ba){super();this.tEa=this.XFa=null;this.BN=
this.Z2=!1;this.T6b=null;this.Wd=ja;this.YVc=!1;this.vEa=T;this.Za=Ba;this.Zl=z;this.enabled=2;this.Zl.register(this)}JE(z,T){this.YVc=!0;this.XFa=z;this.tEa=T;this.Zl.P9()}forceOutbound(){}mia(){return this.YVc&&!this.Z2}JP(){return!1}DQa(){return this.Nd&&2===this.Nd.status?!0:this.mia()}zEb(){if(1===this._state)this.T6b=this.Za.podSessionId,this.Nd.$G=ul.mNd(this.vEa.value.z4c,this.vEa.value.matchCase,this.vEa.value.qel),this.Nd.status=1,this._state=3;else if(3===this._state&&this.Nd&&2===this.Nd.status){if(2!==
this.Nd.statusCode)this.UG();else{if(!this.Nd.pr||1!==this.Nd.pr.length){this.UG();return}const z=this.Nd.pr[0];0===z.StatusCode?(this.A_(),this.XFa&&this.XFa(z.SlideID)):(this.UG(z),124===z.StatusCode&&this.Wd.Mr(z.ServerError,this.T6b))}this.T6b=null}}UG(z=null){this.YVc=!1;this._state=1;Wc.a.J(21849603,824,15,"FindTextRequest failed. OperationResult:{0}, RequestStatus:{1}, HttpStatusCode:{2}, IsLastReplicationFailed:{3}, PodSessionId:{4}",z?z.StatusCode:-1,this.Nd?Fc.a[this.Nd.statusCode]:"NULL",
this.Nd?this.Nd.oy:-1,this.BN,this.T6b||"NULL");this.BN=!0;this.tEa&&this.tEa(-1,-1)}A_(){this.YVc=!1;this._state=1;Wc.a.J(25012056,818,this.BN?15:50,"FindTextRequest succeeded. IsLastReplicationFailed:{0}, PodSessionId:{1}",this.BN,this.T6b||"NULL");this.BN=!1}dispose(){this.Z2||(1===this._state&&this.Zl.unregister(this),this.Z2=!0)}}Object(h.a)(Rn,"FindTextReplicator",ni.a,[109]);class ek{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FindText"}Yb(z){this.K=z;z=this.K.resolve("PowerPointWebEditor.IApplicationContext");
this.K.register(761,"PowerPointWebEditor.IFindTextManager").ma().na(()=>new xi(new Rn(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler"),this.K.qe("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"))));if(z.kd.yYf){this.K.register(763,"PowerPointWebEditor.IFindReplaceTextDialogFactory").ma().na(()=>new gm(this.K.qe("PowerPointWebEditor.IFocusManager")));const T=new Nm.a(this.K.resolve("Common.App.CalloutNotification.ICalloutNotification"),
this.K.resolve("PowerPointWebEditor.IRibbonPane").za);this.K.register(764,"PowerPointWebEditor.IFindReplaceTextHandler").ma().na(()=>new El(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),
this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),
this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.qe("PowerPointWebEditor.IFindReplaceTextDialogFactory"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(7),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("Common.IAppSettingsManager").Gc("ReplaceAllClientTimeoutMS",0),T))}else this.K.register(762,"PowerPointWebEditor.IFindTextDialogFactory").ma().na(()=>new Hi(this.K.resolve("Common.IActionManagerExtended"),this.K.qe("PowerPointWebEditor.IFindTextManager"),
this.K.qe("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("Box4.IPageView"),this.K.qe("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled))}init(){var z=this.K.resolve("PowerPointWebEditor.IApplicationContext");z.kd.yYf?(z=new Hf(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IFindReplaceTextHandler"),
this.K.resolve("PowerPointWebEditor.IPresentationReader")),z.wb(),z.Fe()):z.kd.q8d&&(z=new Jj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),z.kd,this.K.qe("PowerPointWebEditor.IFindTextDialogFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader")),z.wb(),z.Fe())}dispose(){}static main(){Ya.a.instance.Ec(Db.a(new ek,0))}}Object(h.a)(ek,"PPTWebEditorFindTextPackage",null,[2,3]);class ln{constructor(z){this.Ha=z}get pHd(){return"PowerPoint"}get kKf(){return"c551d75c-10b1-4de2-83cc-cce22d7c06bd"}get version(){return 1}get currentVersion(){return 0}get CCj(){return this.Ha.powerPointEditorFirstRunExperienceDataStoreIsEnabled}get rvb(){return this.Ha.powerPointEditorFirstRunExperienceUIIsEnabled}get Pwg(){return this.Ha.powerPointEditorFirstRunExperienceTestIsEnabled}get tRi(){return"Microsoft.Office.Server.Powerpoint.Web.IWacPptEditorFirstRunExperienceUISettings"}get VRg(){return 24}get gfh(){return 4E3}get ric(){return this.Ha.roamingServiceHandlerWebServiceBase||
""}static isEnabled(){const z=E.AFrameworkApplication.Zc?Object(A.a)(String,E.AFrameworkApplication.Zc.AudienceGroup):"";return"Unknown"!==z&&"Automation"!==z}}Object(h.a)(ln,"FirstRunExperienceLauncherSettings",null,[791]);class Fl{constructor(z){this.vFg=z}U9k(z){this.vFg&&this.vFg.RKe(z)}}Object(h.a)(Fl,"FirstRunExperienceManager",null,[759]);class fk{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FirstRunExperience"}Yb(z){if(!z)throw Error.argumentNull("container");this.K=z;this.K.register(759,
"PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager").ma().na(()=>new Fl(this.K.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher")))}init(){this.K.resolve("Common.IAppSettingsManager").gf(()=>{this.RKe()})}dispose(){}RKe(){var z=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(!z)throw Error.argumentNull("appSettings");const T=this.K.resolve("PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager");T&&(z=new ln(z),T.U9k(z))}static main(){Ya.a.instance.Ec(new fk)}}
Object(h.a)(fk,"PPTWebEditorFirstRunExperiencePackage",null,[2,3]);var Oi=d(177),xh=d(387);class mn{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(h.a)(mn,"CatchUpConfiguration",null,[]);class rh{constructor(){this.emptyCatchUpBehaviorManager=
this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(h.a)(rh,"SharedControllerFactoryParameters",null,[]);const aj=(z,T)=>{if(!z)throw Error.create(String.format("Argument {0} is null.",T));},za=z=>{if(!z.navigationId)return Wc.a.J(524895832,3012,10,"CreateNavigationData: navigation id is missing."),null;
try{const T=window.atob(z.navigationId);return T&&""!==T?{["NavigationId"]:T}:null}catch(T){return Wc.a.J(524145986,3012,10,"CreateNavigationData: decoding navigation id failed.",T),null}};class uk{constructor(z){aj(z,"ActivityContentManager.IActionManagerExtended");this.ia=z}doesContentExist(z){if(!z)return Wc.a.J(524895831,3012,10,"DoesContentExist: activity is null."),!1;switch(z.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:return(z=za(z))?32===this.ia.Ma(oa.a.Ypb,2,z):!1;default:return!1}}}
Object(h.a)(uk,"ActivityContentManager",null,[756]);class Lj{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(h.a)(Lj,"Person",null,[]);var hm=d(636),Mf=d(238),im=d(167);class $b extends pg.a{constructor(z){super();this.StartTime=null;this.StartTime=z}Lk(){return 93}}Object(h.a)($b,"GetFileRevisionHistoryRequest",pg.a,[]);class Cf{constructor(z,T,ja){this.ProviderId=this.UserId=this.UserName=null;this.UserName=z;this.UserId=T;this.ProviderId=
ja}}Object(h.a)(Cf,"Author",null,[]);const Kc=(z,T)=>z&&T?z.providerIdField===T.ProviderId?z.userIdField===T.UserId:z.userNameField===T.UserName:!1;var kf=d(239);class Gl{constructor(z,T,ja){this.PYc=this.B9a=null;this.Yh=z;this.N9a=ja;this.N9a.B2h(Object(v.a)(this,this.rXg,"onFileRevisionHistoryReady"));T.gf(()=>{this.B9a=new Cf(T.Ia("UserName"),T.Ia(Ra.a.pa(387)),T.Ia(Ra.a.pa(388)))})}dispose(){this.N9a.gNk(Object(v.a)(this,this.rXg,"onFileRevisionHistoryReady"));this.B9a=null}a1i(z,T,ja){z&&ja&&
(this.PYc=ja,z=new kf.a(new $b(z),Ba=>{this.uAg(Ba,T);this.X7c(Ba)},Ba=>{this.uAg(Ba,T);return this.Ocb(Ba)}),this.Yh.Hb(z))}rXg(z,T){z=null;const ja=[];Ub.a.Xa(T.NIc)||(({NIc:T}=this.Onl(T.NIc)).returnValue?im.b(T.fileRevisionEntriesField,Ba=>this.IHj(Ba.changesDataField),Ba=>{ja.push(Ba.changesDataField)}):z="ErrorGetFileRevisionHistoryParseJsonException");this.Iue(ja,z)}X7c(z){let T=null;z.ServerError&&0!==z.ServerError.Code?T=Mf.a[z.ServerError.Code]:0!==z.StatusCode&&(T=hm.a[z.StatusCode]);T&&
this.Iue(null,T)}Ocb(z){Wc.a.J(34096738,811,15,"OnGetFileRevisionAuthorNamesFailed() - "+z.toString());this.Iue(null,"ErrorGetFileRevisionHistoryFailed");return!0}Iue(z,T){this.PYc&&(z=this.rVi(z),this.PYc(z,T),this.PYc=null)}Onl(z){let T;T=null;try{T=Sys.Serialization.JavaScriptSerializer.deserialize(z)}catch(ja){Wc.a.J(34096768,811,10,"TryParseFileRevisionList() - Exception: "+ja)}return{returnValue:!!T,NIc:T}}IHj(z){return!Kc(z,this.B9a)}uAg(z,T){z.Qva&&T.Dm("GetAuthorNamesRequestInvokedTime",
z.Qva);T.Ya("GetAuthorNamesRequestCorrelationId",z.Oh)}rVi(z){if(!z)return[];const T=Array(z.length);for(let Ba=0;Ba<z.length;Ba++){var ja=z[Ba];ja=Object.assign(new Lj,{displayName:ja.userNameField,id:ja.userIdField,provider:ja.providerIdField});T[Ba]=ja}return T}}Object(h.a)(Gl,"FileRevisionHistoryService",null,[789,109]);class Mj{constructor(z,T){aj(z,"FlyoutFocus.IF6Manager");aj(T,"FlyoutFocus.IFocusManagerHelper");this.ph=z;this.uD=T}initialize(){this.uD.o7(Id.a.tob,Id.a.kj,null,Object(v.a)(this,
this.RRi,"focusOnFirstFlyoutItem"),()=>{},!0)}enableF6Focus(){this.ph.SJ(Id.a.tob)}disableF6Focus(){this.ph.ap(Id.a.tob)}RRi(){const z=document.getElementById("flyoutItem0");z&&(Wc.a.J(570730465,3012,50,"Focused on the catch-up flyout via ctrl+F6"),z.focus())}}Object(h.a)(Mj,"FlyoutFocus",null,[788]);class Zf{constructor(z,T,ja,Ba){this.DWc=null;this.oCg=this.bGg=this.Rxb=this.PZc=!1;aj(T,"FlyoutRibbonButton.IActionManagerExtended");aj(ja,"FlyoutRibbonButton.IFocusManager");aj(Ba,"FlyoutRibbonButton.FloodgateEventLogger");
this.Rb=z;this.ia=T;this.Ga=ja;this.BZj=Ba;this.DZj=new Date}initialize(){E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&zd.a("DelayRegisterCatchUpActions")||this.wb()}registerButtonClickedEvent(z){this.DWc&&Wc.a.J(571532947,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.DWc=z.buttonClickedCallback}onFlyoutInitialized(){this.PZc&&Wc.a.J(571532948,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");
const z=(new Date).getTime()-this.DZj.getTime();Wc.a.J(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",z);this.PZc=!0;gd.c(oa.a.Whi,!0,gd.e,0,0,z);E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&zd.a("DelayRegisterCatchUpActions")&&this.wb();this.Rb&&this.Rb.updateCommandUI()}logFlightTriggers(){}onFlyoutVisibilityChanged(z){this.Rxb!==z.flyoutIsVisible&&(this.Rxb=z.flyoutIsVisible,this.Rb&&this.Rb.updateCommandUI(!0),
this.Rxb&&this.oCg?this.Ga.vf(Id.a.tob):this.Rxb||this.Ga.vf(Id.a.kj),this.Rxb||this.BZj.eTj())}wb(){this.ia.ya(oa.a.ckl,ec.a.frame,Object(v.a)(this,this.Fmk,"onToggleCatchUpFlyout"));this.ia.ra(oa.a.fBk,ec.a.frame,Object(v.a)(this,this.rkk,"onQueryToggleCatchUpFlyout"),96)}Fmk(z,T,ja){if(1===ja)return this.PZc?(this.bGg||(this.bGg=!0,Wc.a.J(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.DWc)return 8;this.oCg=!0;this.DWc();return 32}rkk(z,T,ja,Ba,Ga){Ga[mf.a.Visible]=!0;Ga[mf.a.On]=
this.Rxb&&this.PZc;return 32}}Object(h.a)(Zf,"FlyoutRibbonButton",null,[787]);const Hg=z=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+z)};class jm{constructor(z,T,ja,Ba,Ga,Fb){aj(z,"PowerPointActivityNavigationManager.IActionManagerExtended");aj(T,"PowerPointActivityNavigationManager.IPresentationReader");aj(ja,"PowerPointActivityNavigationManager.IThumbnailNavigationPaneView");aj(Ba,"PowerPointActivityNavigationManager.IRibbonUser");aj(Fb,
"PowerPointActivityNavigationManager.IActivityContentManager");this.ia=z;this.qc=T;this.Je=ja;this.BD=Ba;this.d5j=Ga;this.OWj=Fb}navigateToActivity(z){if(z.fromSummaryString)return this.S_k(),this.Egj(),this.Bgj(),this.o9k(),Promise.resolve(1);z=z.activity;if(!z)return Wc.a.J(524145984,3012,10,"NavigateToActivity: activity is null."),Promise.resolve(8);if(!z.navigationId)return Wc.a.J(524145985,3012,10,"NavigateToActivity: navigation id is null."),Promise.resolve(4);if(!this.OWj.doesContentExist(z))return Promise.resolve(2);
switch(z.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:z=za(z);if(!z)return Promise.resolve(5);z=this.ia.Ma(oa.a.fVb,2,z);return Promise.resolve(32===z?1:6);default:return Promise.resolve(7)}}S_k(){const z=this.qc.un;z?z.jBa=!0:Wc.a.J(570831450,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}Egj(){this.BD.selectRibbonTabById(this.d5j)}Bgj(){var z=this.qc.un;if(z&&z.slides){var T=null;for(const ja of z.slides)if(ja&&(z=this.qc.Bk(ja.Cb))&&z.Bs){T=z;break}T?
(this.Je.MHe(),this.Je.rda(T.Ge)):Wc.a.J(570831452,3012,15,"PowerPointActivityNavigationManager: Could not find any unread slides.")}else Wc.a.J(570831451,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}o9k(){this.ia.Ma(Xc.a.KGb,2,{InvokeSource:1,ShowRevisionTrackingStatus:3})}}Object(h.a)(jm,"PowerPointActivityNavigationManager",null,[757]);class aa{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}
Object(h.a)(aa,"ActivityFeedItem",null,[]);class bj{constructor(){this.activityFeedItems=null}}Object(h.a)(bj,"ActivityFeedPayload",null,[]);class tj{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(h.a)(tj,"ActivityRequestPayload",null,[]);var Vj=d(431);class Xh{constructor(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=
this.displayTimestamp=this.location=this.actors=null}}Object(h.a)(Xh,"Activity",null,[]);class hf{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc){this.Te=this.vle=null;aj(z,"PowerPointActivityRequestManager.IJsonpHelperManager");aj(T,"PowerPointActivityRequestManager.PowerPointWaterlineUpdater");aj(ja,"PowerPointActivityRequestManager.IFileRevisionHistoryService");aj(Ba,"PowerPointActivityRequestManager.IAppSettingsManager");aj(Ga,"PowerPointActivityRequestManager.IApplicationSettings");aj(Fb,"PowerPointActivityRequestManager.IActionManagerExtended");
aj(Rb,"PowerPointActivityRequestManager.ICatchUpRequestHandler");this.SEa=z;this.k8j=T;this.vZj=ja;this.kc=Ba;this.ia=Fb;this.LWc=Rb;this.xNg=tc}requestWYWAActivities(){return new Promise((z,T)=>{this.Te=Od.a.Nm("ShowWYWACallout",2);this.k8j.FSk(ja=>{ja=this.Syk(ja);hf.isExpectedError(ja)?z(hf.NFc):ja?(Wc.a.J(572111054,3012,10,"OnReadRoamingSucceeded() - Error: {0}",ja),T(ja)):this.vZj.a1i(this.vle,this.Te,(Ba,Ga)=>{Ga&&(Wc.a.J(572111055,3012,10,"GetFileRevisionAuthorNamesAsync() - Error: {0}",Ga),
T(Ga));z(hf.nsi(Ba))})},ja=>{const Ba=!!ja.data&&hf.DDj(ja.data.tf);ja=this.SEa.Vha(ja);Wc.a.J(572111056,3012,Ba?50:10,"OnReadRoamingFailed() - Error: {0}",ja);Ba?z(hf.NFc):T(ja)})})}requestActivities(){return Promise.resolve(hf.NFc)}requestRelevantActivities(){return Promise.resolve(hf.NFc)}requestActivityFeed(){return this.LWc?Vj.b(this.LWc.getActivityFeed(this.xNg)).then(z=>Object.assign(new bj,{activityFeedItems:hf.tll(z)})):Promise.resolve(Object.assign(new bj,{activityFeedItems:[]}))}updateActivityState(z){return this.LWc?
Vj.b(this.LWc.iql(this.xNg,z.itemIds,z.activityStatesToSet||0,z.activityStatesToReset||0,z.resetUnseenCount)):Promise.resolve(!1)}Syk(z){z=z.data.je;if(!z)return"ErrorReadRoamingEmptyResponseBody";let T;try{T=JSON.parse(z)}catch(ja){return ja.toString()}z=null;if(!T.Error){if(!T.Timestamp)throw Error.create("response.Error and response.Timestamp are empty");z=T.Timestamp}this.vle=this.oul(z);Wc.a.J(561588038,3012,100,"Timestamp for retrieving activities: "+this.vle);return T.Error}oul(z){const T=
{};var ja=this.kc.Gc("AppWaterlineOverrideTimestampValue",0);return ja?(z=new Date(1E3*ja),T.timestamp=z,this.ia.Ma(Xc.a.xLe,2,T),z.format("yyyy-MM-ddTHH:mm:ssZ")):z?(ja=this.kc.Gc("AppWaterlineOverrideDaysValue",0))?(z=new Date(+new Date(z)-+new Date(864E5*ja)),T.timestamp=z,this.ia.Ma(Xc.a.xLe,2,T),z.format("yyyy-MM-ddTHH:mm:ssZ")):z:null}static nsi(z){return z?Object.assign(new tj,{actors:z}):null}static tll(z){const T=[];if(!z)return T;for(const ja of z)T.push(Object.assign(new aa,{id:ja.id,type:ja.type,
collectionId:ja.collectionId,activityState:ja.activityState,activityFeedItemPayload:ja.activityFeedItemPayload,timestamp:ja.timestamp}));return T}static isExpectedError(z){return"ErrorDocNotInRoamingList"===z||"ErrorLastViewedDocListIsEmpty"===z}static DDj(z){return 403===z}}hf.NFc=Object.assign(new tj,{activities:[],actors:[],hasMore:!1,highWaterline:"",lowWaterline:"",wywaWaterline:""});Object.assign(new tj,{activities:[Object.assign(new Xh,{activityId:"activityId1",type:3,actors:[Object.assign(new Lj,
{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new Xh,{activityId:"activityId2",type:4,actors:[Object.assign(new Lj,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId2"})]});Object.assign(new bj,{activityFeedItems:[Object.assign(new aa,{id:"FeedItemId1",type:"UserAtMentioned",
collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"1","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a1","navigationId":"n1","commentThreadId":"1","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"kat.larsson@microsoft.com","userPrincipalName":"klarsson@microsoft.com","name":"Kat Larsson","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()}),Object.assign(new aa,{id:"FeedItemId2",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"2","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a2","navigationId":"n2","commentThreadId":"2","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"frankie.smith@microsoft.com","userPrincipalName":"fsmith@microsoft.com","name":"Frankie Smith","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()})]});Object(h.a)(hf,"PowerPointActivityRequestManager",null,[758]);var gk=d(257);class Ii{constructor(z,T,ja,Ba,Ga,Fb){this.Q$a=!1;this.tJg=null;this.Oc=z;this.Dz=T;this.i5j=ja;this.SEa=Ba;this.Bb=Ga;this.Mzb=Fb}initialize(){this.Oc&&(this.Oc.F2a(Object(v.a)(this,this.l6c,"onBeforeSessionEnd")),this.Oc.wB(Object(v.a)(this,this.tL,"onSessionClosed")));this.FVk()}FSk(z,T){const ja=this.Ybg("getPPTDocLastViewedTimestamp");this.dw(ja,1,z,T)}l6c(){this.hDh()}tL(){this.Q$a=
!0}FVk(){if(this.Bb){var z=new od.a(3,2,3E4,Object(v.a)(this,this.FQk,"requestWriteWaterline"),90,"29");this.Bb.Hb(z)}}FQk(){!this.Q$a&&3E4<+Od.a.h5b-+this.tJg&&(this.hDh(),this.tJg=Od.a.h5b)}hDh(){const z=this.Ybg("savePPTDocLastViewedTimestamp");this.Mzb.ka("SendBeaconOnRoamingRequestsIsEnabled")?this.Dz.RHa(z,""):this.dw(z,2,Object(v.a)(this,this.pnk,"onWriteWaterlineSucceeded"),Object(v.a)(this,this.onk,"onWriteWaterlineFailed"))}pnk(z){let T=null;try{const ja=z.data.je;T=ja?JSON.parse(ja).Error:
"ErrorWriteRoamingEmptyResponseBody"}catch(ja){T="ErrorWriteRoamingParseJsonResponseException",Wc.a.J(572555921,3012,10,"OnWriteRoamingSucceeded() - Exception: "+ja)}finally{T&&this.IAg(T)}Wc.a.J(572555922,3012,50,"OnWriteRoamingSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+z.data.Eu-+z.data.JH,+z.data.wt-+z.data.JH)}onk(z){this.IAg("ErrorReadRoamingFailed");Wc.a.J(572555923,3012,10,"OnWriteRoamingFailed() - Failure message: {0}",this.SEa.Vha(z))}Ybg(z){return this.i5j+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
z,E.AFrameworkApplication.$g)}dw(z,T,ja,Ba){const Ga={};Ga["X-StatelessPopsAffinityRoutingEnabled"]=this.Mzb.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Dz.Jj(z,T,null,Ga,!1,1,ja,Ba,null,void 0,void 0,void 0,void 0,gk.a("5"))}IAg(z){Wc.a.J(572555924,811,50,z)}}Object(h.a)(Ii,"PowerPointWaterlineUpdater",null,[]);class nn{get name(){return"PowerPointWebEditor.Activity"}get Vpg(){return E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)}init(){this.K.resolve("Common.IAppSettingsManager").gf(Object(v.a)(this,this.FCi,"delayedInit"))}Yb(z){this.K=z}dispose(){this.K=this.KWc=null}q6k(z){return!z||z.ka("IsAnonymousUser")?!1:z.ka("PPTCatchUpFlyoutIsEnabled")}FCi(){const z=this.K.resolve("Common.IAppSettingsManager");this.q6k(z)&&(Hg("Begin"),this.SGi(),this.JTj())}SGi(){Oi.a.get_instance().Ak(7,()=>{Hg("ScriptDownload");ta.a(this.K)("catchUpActivity").catch(()=>{Wc.a.J(572846100,3012,10,"Failed to download catch-up script")}).then(()=>
this.Btj()).catch(()=>{Wc.a.J(572846101,3012,10,"Failed to initialize shared catch-up code")})})}JTj(){Wc.a.J(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.Vpg&&Wc.a.J(526718752,3012,50,"ActivityFeedData is enabled")}Btj(){const z=new Gl(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler")),T=this.K.resolve("Common.AFrameworkApplication");this.K.register(Ii,
"PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").ma().na(()=>new Ii(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),E.AFrameworkApplication.Be,this.K.resolve("PowerPointWebEditor.IApplicationSettings").roamingServiceHandlerWebServiceBase,this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));this.K.register(756,"Common.App.CatchUpActivity.IActivityContentManager").ma().na(()=>new uk(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(757,"Common.App.CatchUpActivity.IActivityNavigationManager").ma().na(()=>new jm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),li.a.WEk,this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager")));let ja=null;this.K.resolve("PowerPointWebEditor.IApplicationSettings").zg&&
(ja=this.K.resolve("Common.IAppSettingsManager").Ia(Ra.a.pa(368))+"p");this.K.register(758,"Common.App.CatchUpActivity.IActivityRequestManager").ma().na(()=>new hf(this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater"),z,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler"),
ja));this.K.register(Zf,"PowerPointWebEditor.Activity.FlyoutRibbonButton").as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ma().na(()=>new Zf(T.Uq,E.AFrameworkApplication.Va,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.App.CatchUpActivity.FloodgateEventLogger")));this.K.register(Mj,"PowerPointWebEditor.Activity.FlyoutFocus").as("Common.App.CatchUpActivity.IFlyoutFocus").ma().na(()=>new Mj(this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper")));
this.KWc=catchUpActivity.FactoryGlobal.getPowerPointCatchUpAppInstance(Object.assign(new rh,{activityContentManager:this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.K.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.K.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),dataCulture:E.AFrameworkApplication.dataCulture,flyoutFocus:this.K.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),flyoutRibbonButton:this.K.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),
uiCulture:E.AFrameworkApplication.uiCulture,ulsLogger:new xh.a}));if(!this.KWc)return Promise.reject("Failure to create CatchUpApp");this.K.resolve("PowerPointWebEditor.Activity.FlyoutRibbonButton").initialize();this.K.resolve("PowerPointWebEditor.Activity.FlyoutFocus").initialize();this.KWc.setWebpackPublicPath(E.AFrameworkApplication.zea);Hg("InitializeCatchUpApp");return this.KWc.initialize(Object.assign(new mn,{activityFeedDataEnabled:this.Vpg,featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0})).then(()=>
{this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").initialize()})}static main(){Ya.a.instance.Ec(Db.a(new nn,0))}}Object(h.a)(nn,"PPTWebEditorActivityPackage",null,[2,3]);var Ji=d(714);class Sl extends Sys.EventArgs{constructor(z,T){super();this.shape=z;this.jBa=T}}Object(h.a)(Sl,"ShowHideStateChangedEventArgs",Sys.EventArgs,[]);var wm=d(206);class Xi{constructor(z,T,ja,Ba,Ga,Fb,Rb){this.Te=null;this.ia=z;this.ua=T;this.Dzb=ja;this.b2c=Ba;this.Ub=Ga;this.Xc=Fb;this.$ab=Rb}dispose(){this.Te&&
(this.Te=null)}Fe(){}wb(){this.ia.ya(Xc.a.HQg,Rg.a.application,Object(v.a)(this,this.jkj,"handleMarkAsRead"));this.ia.ya(Xc.a.KGb,Rg.a.application,Object(v.a)(this,this.Zmj,"handleShowHideChanges"));this.ia.ra(Xc.a.B7g,ed.a.application,Object(v.a)(this,this.Jlj,"handleQueryShowHideChanges"),96);this.ia.ra(Xc.a.xLe,Rg.a.application,Object(v.a)(this,this.$mj,"handleShowRevisionTrackingWithUrlOverrides"),96)}jkj(z,T,ja,Ba,Ga){if(1===ja)return this.Ub.wj()?32:8;z=new Date;if(!Ga)throw Error.argumentNull("actionData is null");
if(Ga.SlideNode){if(Ga=Object(A.a)(132,Ga.SlideNode))Wc.a.J(590448578,804,50,String.format("HandleMarkAsRead: Mark slide {0} as read",Ga.slideIndex+1)),Ga.zZ=z,this.Dzb.uCe(Ga)}else this.f9j(z);return 32}f9j(z){const T=this.ua.presentation;if(!T)throw Error.argumentNull("Presentation is null");this.Te=Od.a.Nm("MarkActivitiesAsRead",1);Wc.a.J(38012997,804,50,"MarkAllSlidesAsRead: User marks slides as read via Ribbon button");im.b(T.slides||[],null,ja=>{if(ja=Object(A.a)(132,ja))ja.zZ=z});this.Dzb.C$g()}Zmj(z,
T,ja,Ba,Ga){if(1===ja)return this.Ub.wj()?32:8;const Fb=this.Ub.un;z=this.ua.Ca;if(!(Fb&&z&&z.isConnected&&Ga))return 16;ja=T=!1;switch(Ga.ShowRevisionTrackingStatus){case 0:ja=T=!1;break;case 2:T=!0;ja=!1;break;case 3:ja=T=!0;break;case 1:T=Fb.jBa&&!this.Dzb.fMd?!0:!Fb.jBa;ja=!0;break;default:return 8}if(this.Dzb.fMd&&!ja)return 32;Ga=Ga.InvokeSource;Fb.jBa=T;this.Dzb.fMd=T&&ja;ja&&this.$ab.mVj(Ga,T);Ga=z.km();im.b(Ga,null,Rb=>{this.b2c.SDk(new Sl(Rb,Fb.jBa))});this.Xc.ND(new wm.a(1));return 32}Jlj(z,
T,ja,Ba,Ga){z=this.Ub.un;if(!z)return 16;Ga.Yf(z.jBa);return 32}$mj(z,T,ja,Ba,Ga){z=this.ua.presentation;if(!Ga||!z||!z.slides)return 8;Ga=Ga.timestamp;if(!Ga)return 8;for(const Fb of z.slides)Object(A.a)(132,Fb).zZ=Ga;this.Dzb.vCe(z.slides);return 32}}Object(h.a)(Xi,"RevisionTrackingActor",null,[234,109]);class Xe{constructor(z){this.backgroundColor=this.foregroundColor=null;E.AFrameworkApplication.fa.ka(Ra.a.pa(1166))?z&&z.isInHighContrastMode&&z.highContrastColors?(this.foregroundColor=z.highContrastColors.foregroundTextColor||
"#006BFF",this.backgroundColor=z.highContrastColors.backgroundColor||"#006BFF"):this.backgroundColor=this.foregroundColor="#006BFF":z&&z.isInHighContrastMode&&z.highContrastColors?(this.foregroundColor=z.highContrastColors.foregroundTextColor||"#00828C",this.backgroundColor=z.highContrastColors.backgroundColor||"#00828C"):this.backgroundColor=this.foregroundColor="#00828C"}}Object(h.a)(Xe,"RevisionTrackingColorProvider",null,[]);class Qm{constructor(){this.va=new Ae.a}WDk(z){this.va.raiseEvent("SlideUSC",
z)}HCf(z){this.va.addHandler("SlideUSC",z)}rch(z){this.va.removeHandler("SlideUSC",z)}yDk(z){this.va.raiseEvent("ShapeUSC",z)}Y3h(z){this.va.addHandler("ShapeUSC",z)}aOk(z){this.va.removeHandler("ShapeUSC",z)}SDk(z){this.va.raiseEvent("ShowHideSC",z)}i4h(z){this.va.addHandler("ShowHideSC",z)}hOk(z){this.va.removeHandler("ShowHideSC",z)}}Object(h.a)(Qm,"RevisionTrackingEventSource",null,[797,798,799]);class Rm extends Sys.EventArgs{constructor(z,T){super();this.shape=z;this.slide=T}}Object(h.a)(Rm,
"ShapeUnreadStateChangedEventArgs",Sys.EventArgs,[]);class qd{constructor(){this.cid=this.sid=0}}Object(h.a)(qd,"Slide",null,[]);class il{constructor(z,T){this.dt=this.mk=null;this.mk=Object.assign(new qd,{sid:z.sid,cid:z.cid});this.dt=T}}Object(h.a)(il,"SlideLastViewedVersion",null,[]);class Sm{constructor(){this.v=0;this.lv=this.defLv=null;this.v=1}}Object(h.a)(Sm,"SlideLastViewedVersions",null,[]);class Vk extends Sys.EventArgs{constructor(z){super();this.slide=z}}Object(h.a)(Vk,"SlideUnreadStateChangedEventArgs",
Sys.EventArgs,[]);class L{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd,Zd,df,Ke){this.Kwb=this.B9a=null;this.uFg=!1;this.nje=null;this.F_c=0;this.qyb=this.$8b=null;this.ane=[];this.s1c=null;this.v2c=!1;this.Ava=null;this.fMd=!1;Wc.a.J(23606094,804,50,"Start RevisionTrackingManager::RevisionTrackingManager()");this.ooe=z;this.ua=T;this.Bb=ja;this.uc=Ba;this.Ub=Ga;this.zd=Fb;this.Tac=Rb;this.Oc=tc;this.Dk=Ac;this.b2c=nd;this.HNg=kd;this.kc=Zd;this.o8j=Bd.pptEditingRevisionTrackingWriteRoamingCacheIntervalMs;
this.uIg=Bd.$Jj;this.VNg=!0;this.OG=!1;this.DFa=new Rh.a;this.Oc.Nzc(Object(v.a)(this,this.Ila,"onSessionAccessTokenExpired"));E.AFrameworkApplication.wz&&this.Oc.Qzc(Object(v.a)(this,this.Hda,"onWopiTokenRefreshed"));this.kc.gf(()=>{this.initialize();this.C$g()});this.$ab=df;this.Pb=Ke}dispose(){this.B9a&&(this.zd.lma(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.zd.Fcd(Object(v.a)(this,this.QVa,"onShapeViewElementAdded")),this.Tac.pDe(Object(v.a)(this,this.Icb,"onMarkedUndo")),
this.Oc.DDe(Object(v.a)(this,this.l6c,"onBeforeSessionEnd")),this.Oc.aea(Object(v.a)(this,this.tL,"onSessionClosed")),this.Oc.cea(Object(v.a)(this,this.eo,"onSessionRehydrated")),this.Dk.lOk(Object(v.a)(this,this.j_g,"onSlideChangesDataChanged")),this.Dk.RNk(Object(v.a)(this,this.jZg,"onPresentationLastModifiedTimeReceived")),this.uIg&&this.HNg.Pm(Object(v.a)(this,this.WZg,"onShapePropertyChanged")),this.Oc.hch(Object(v.a)(this,this.Ila,"onSessionAccessTokenExpired")))}initialize(){Wc.a.J(23606096,
804,50,"Start RevisionTrackingManager::Initialize()");this.nje=new Date;this.F_c=this.nje.getTime();this.dZk();this.zd.DR(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.zd.CSb(Object(v.a)(this,this.QVa,"onShapeViewElementAdded"));this.Tac.vSb(Object(v.a)(this,this.Icb,"onMarkedUndo"));this.Oc.F2a(Object(v.a)(this,this.l6c,"onBeforeSessionEnd"));this.Oc.wB(Object(v.a)(this,this.tL,"onSessionClosed"));this.Oc.xB(Object(v.a)(this,this.eo,"onSessionRehydrated"));this.Dk.o4h(Object(v.a)(this,
this.j_g,"onSlideChangesDataChanged"));this.Dk.F3h(Object(v.a)(this,this.jZg,"onPresentationLastModifiedTimeReceived"));this.uIg&&this.HNg.yk(Object(v.a)(this,this.WZg,"onShapePropertyChanged"));this.Ava=this.ua.Ca;this.Kwb=this.k_i();this.getSlideLastViewedVersions();const z=new od.a(3,2,this.o8j,()=>{this.getSlideLastViewedVersions()},90,"12");this.Bb.Hb(z)}onActiveSlideDomReady(z,T){z=Object(A.a)(132,T.Ca);this.Ava&&z!==this.Ava&&this.ZJe()&&(this.Ava.isConnected&&(this.Ava.Bs&&this.WQg(this.Ava),
this.Ava.ox&&(this.Ava.zZ=this.Ava.ox.dtField)),z&&z.Bs&&this.N$g(z));this.Ava=z;this.F_c=Date.now()}Icb(z,T){T.actionId!==dd.a.VQa&&T.xub&&(z=this.ua.Ca)&&z.isConnected&&z.Bs&&this.ZJe()&&this.WQg(z)}l6c(){this.ZJe()&&this.hql();this.kDh()}tL(){this.$ab.log();this.OG=!0}eo(){this.OG=!1;this.$8b&&this.ezh(this.$8b)}ezh(z){var T=this.ua.presentation;if(!T)throw Error.argumentNull("Presentation is null");T=T.slides||[];0<T.length&&(this.Htl(T,z),this.vCe(T))}wkk(z){Wc.a.J(23606098,804,50,"OnReceiveLastViewedVersionInfo()");
z&&(this.DFa=new Rh.a,this.forEach(z.lv,Ba=>{const Ga=Ba.mk.sid;(!this.DFa.Kb(Ga)||this.DFa.ga(Ga).dt<Ba.dt)&&this.DFa.$(Ga,Ba)}));const T=Od.a.h5b;let ja=!1;this.qyb&&this.ooe.pOj&&T!==this.qyb&&(this.$8b&&D.c(this.g5f())===D.c(this.$8b)||(ja=!0));z&&z.defLv&&(this.Kwb=z.defLv,this.VNg=!1,z.lv&&0<z.lv.length&&this.ezh(z));ja&&this.kDh();this.qyb=Od.a.h5b}j_g(z,T){this.forEach(T.slides,ja=>{this.y7d(ja.ox)||(this.ua.Ca&&ja.Cb!==this.ua.Ca.Cb||this.spj(Object(A.a)(132,ja)))&&this.uCe(Object(A.a)(132,
ja))})}jZg(z,T){this.VNg&&(this.Kwb=T.oxk)}WZg(z,T){z=T.property;T=Object(A.a)(4,T.node);z===gg.a.mic&&(z=this.uc.Sg(T),z===this.ua.Ca&&z.Bs&&T.ox.dtField<=z.ox.dtField&&(Wc.a.J(24133922,804,50,"Trying to highlight a shape in active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.F_c),this.tCe(this.ua.Ca,T)))}QVa(z,T){z=T.$w.shapeNode;this.ua.Ca.Bs&&this.F8a(this.ua.Ca.Cb,z)&&!this.y7d(z.ox)&&(this.ane.push(z),this.s1c||(this.s1c=new od.a(2,1,0,Object(v.a)(this,this.tryHighlightInsertedShapes,
"tryHighlightInsertedShapes"),90,"13"),this.Bb.Hb(this.s1c)))}getSlideLastViewedVersions(){this.OG||this.v2c||this.ooe.getSlideLastViewedVersionInfo(Object(v.a)(this,this.wkk,"onReceiveLastViewedVersionInfo"))}kDh(){if(!this.OG&&!this.v2c){var z=this.g5f();this.ooe.putSlideLastViewedVersionInfo(z);this.$8b=z}}g5f(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");const T=Object.assign(new Sm,{defLv:this.Kwb}),ja=[];this.forEach(z.slides||[],Ba=>{Ba=Ba.Cb;const Ga=
this.Ub.Bk(Ba);Ga&&Ga.zZ&&(!Ba.cid&&this.DFa.Kb(Ba.sid)?Ba=md.a.XD(Ba.sid,this.DFa.ga(Ba.sid).mk.cid):Ba.cid&&this.DFa.Kb(Ba.sid)&&Ba.cid!==this.DFa.ga(Ba.sid).mk.cid&&Wc.a.J(25203088,804,50,"The same sid {0} has different cid. Roaming cid:{1}, Slide node cid:{2}",Ba.sid,this.DFa.ga(Ba.sid),Ba.cid),ja.push(new il(Ba,Ga.zZ)))});T.lv=ja;return T}Htl(z,T){const ja=T.lv;this.forEach(z,Ba=>{const Ga=Object(A.a)(132,Ba);this.forEach(ja,Fb=>{Ga&&this.U8h(Ga,Fb.mk)&&(!Ga.zZ||Ga.zZ<Fb.dt)&&(Ga.zZ=Fb.dt)})})}U8h(z,
T){return z.cid&&T.cid?z.sid===T.sid&&z.cid===T.cid:z.sid===T.sid}vCe(z){this.forEach(z,T=>{this.uCe(Object(A.a)(132,T))})}C$g(){var z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");z=z.slides||[];0<z.length&&this.vCe(z)}N$g(z){this.ACh(z,T=>{this.tCe(z,T)})}uCe(z){if(z&&z.isConnected&&z.ox){const T=this.z7d(z.ox,this.qZd(z));T!==z.Bs&&(this.VQg(z,T),this.$nl(),z===this.ua.Ca&&this.N$g(z))}}tCe(z,T){if(T&&T.isConnected&&T.Sa(gg.a.mic)){const ja=this.z7d(T.ox,this.qZd(z));
this.TQg(z,T,ja)}}TQg(z,T,ja){ja!==T.Bs&&(Wc.a.J(23606100,804,50,"Shape unread state changed: {0} -> {1}",T.Bs,ja),T.Bs=ja,this.b2c.yDk(new Rm(T,z)))}VQg(z,T){T!==z.Bs&&(Wc.a.J(23606102,804,50,"Slide unread state changed: {0} -> {1}, SlideId={2}",z.Bs,T,z.Cb.toString()),z.Bs=T,this.b2c.WDk(new Vk(z)))}WQg(z){this.ACh(z,T=>{this.TQg(z,T,!1)});this.VQg(z,!1)}ACh(z,T){z&&(z=z.km(),this.forEach(z,ja=>{T(ja)}))}forEach(z,T){im.b(z,null,T)}y7d(z){return Kc(z,this.B9a)}z7d(z,T){return!!z&&!!z.dtField&&!this.y7d(z)&&
z.dtField>T}k_i(){const z=this.Ub.un;if(z&&z.Wye)return z.Wye;Wc.a.J(23462038,808,50,"GetDefaultLastViewedTime - No PresLastModifiedTime");return new Date}dZk(){const z=this.kc.Ia("UserName"),T=this.kc.Ia(Ra.a.pa(387)),ja=this.kc.Ia(Ra.a.pa(388));this.B9a=new Cf(z,T,ja)}hql(){const z=this.ua.Ca;z&&(z.zZ=z.ox?z.ox.dtField:this.Kwb)}qZd(z){return z.zZ||this.Kwb}$nl(){this.uFg||(this.uFg=!0,Wc.a.J(23606107,804,50,"First revision tracking view render completed!"))}spj(z){return z.isConnected&&z.ox&&z.ox.dtField?
z.ox.dtField<=this.nje&&this.z7d(z.ox,this.qZd(z)):!1}F8a(z,T){return z.equals(T.slideId)}tryHighlightInsertedShapes(){Wc.a.J(24761090,804,50,"Trying to highlight inserted shapes on active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.F_c);this.s1c=null;const z=this.ua.Ca;if(z&&z.Bs){const T=z.Cb;for(const ja of this.ane)this.F8a(T,ja)&&this.tCe(z,ja)}Array.clear(this.ane)}Ila(){this.v2c=!0}Hda(z,T){try{T.RTc?(Wc.a.J(594040785,804,50,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh succeeded."),
this.v2c=!1):Wc.a.J(594040783,804,15,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh failed.")}catch(ja){Wc.a.J(594040781,804,10,"RevisionTrackingManager::OnWopiTokenRefreshed Exception: {0}",ja)}}ZJe(){return 1!==this.Pb.Aw}}Object(h.a)(L,"RevisionTrackingManager",null,[]);class ba{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd){this.ua=z;this.Ub=T;this.loe=ja;this.zd=Ba;this.Lka=Ga;this.Fa=Fb;this.UWc=Rb;this.Gbb=tc;this.Le=Ac;this.Yxb=kd;this.K0j=nd;this.lLg=!1;this.zd.Kmb(Object(v.a)(this,
this.n0g,"onVisibleThumbnailRangeChanged"));this.zd.DGd(Object(v.a)(this,this.gCb,"onThumbnailRefresh"));this.zd.b4h(Object(v.a)(this,this.VZg,"onShapePresenceStateChanged"));this.zd.B4h(Object(v.a)(this,this.X_g,"onThumbnailPresenceStateChanged"));this.zd.j3h(Object(v.a)(this,this.Nlk,"onShapeViewElementShowRevisionTrackingHint"));this.zd.g3h(Object(v.a)(this,this.Glk,"onShapeViewElementHideRevisionTrackingHint"));this.Lka.HCf(Object(v.a)(this,this.qdc,"onSlideUnreadStateChanged"));this.Lka.Y3h(Object(v.a)(this,
this.a_g,"onShapeUnreadStateChanged"));this.Lka.i4h(Object(v.a)(this,this.e_g,"onShowHideStateChanged"))}dispose(){this.zd.sch(Object(v.a)(this,this.n0g,"onVisibleThumbnailRangeChanged"));this.zd.uOk(Object(v.a)(this,this.gCb,"onThumbnailRefresh"));this.zd.dOk(Object(v.a)(this,this.VZg,"onShapePresenceStateChanged"));this.zd.tOk(Object(v.a)(this,this.X_g,"onThumbnailPresenceStateChanged"));this.Lka.rch(Object(v.a)(this,this.qdc,"onSlideUnreadStateChanged"));this.Lka.aOk(Object(v.a)(this,this.a_g,
"onShapeUnreadStateChanged"));this.Lka.hOk(Object(v.a)(this,this.e_g,"onShowHideStateChanged"))}n0g(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");im.b(z.slides||[],null,T=>{(T=this.Ub.Bk(T.Cb))&&T.Bs&&this.ELe(T)})}gCb(z,T){z=this.Ub.Bk(T.avh);z.Bs&&this.ELe(z)}qdc(z,T){z=T.slide;z.Bs?this.ELe(z):this.YLk(z)}a_g(z,T){z=T.shape;T=T.slide;z&&(z.Bs?T===this.ua.Ca&&this.ALe(z):this.iDe(z))}VZg(z,T){z=T.shape;z.Iv?this.iDe(z):z.Bs&&this.ALe(z,!0)}X_g(z,T){z=T.slide;
z.Iv&&!this.uKe?this.bMk(z):z.Bs&&this.Gal(z)}e_g(z,T){z=T.shape;T.jBa&&z.Bs?this.ALe(z):this.iDe(z)}get uKe(){return this.K0j}ELe(z){z&&z.isConnected&&this.Uld(z,T=>{T.kal();z.Iv&&!this.uKe||this.hBf(T)})}YLk(z){z&&z.isConnected&&this.Uld(z,T=>{T.VLk();T.lbh()})}Gal(z){z.Iv&&!this.uKe||this.Uld(z,Object(v.a)(this,this.hBf,"addRevisionTrackingPawnForThumbnail"))}bMk(z){this.Uld(z,T=>{T.lbh()})}Jnh(){const z=this.Ub.un;return!this.Yxb||this.Yxb&&z.jBa}ALe(z,T=!1){this.Jnh()&&!z.Iv&&z.Sa(gg.a.mic)&&
(Object(A.a)(133,z.pc(this.Le))?(this.loe.yP(z).display(()=>this.Fa.NMc(z)),this.Enl(),Wc.a.J(23606109,804,50,"ShowShapeRevisionTrackingView(), IsTriggeredByPresenceUpdate={0}",T)):Wc.a.J(23606111,804,50,"ShowShapeRevisionTrackingView() failed, no shape view element created"))}iDe(z){const T=this.loe.QE(z);T?T.dismiss():this.Jnh()&&z.Bs&&Wc.a.J(23606113,804,50,"RemoveShapeRevisionTrackingView() failed, a revision tracking view is expected but not found")}Uld(z,T){z&&((z=Object(A.a)(796,z.yg(this.Gbb)))?
T(z):Wc.a.J(23606115,804,50,"UpdateThumbnailRevisionTrackingView() failed, no thumbnail view element found"))}hBf(z){z.gBf(this.UWc.backgroundColor,ResourceStrings.l_RevisionTracking_Slide_Has_Unread_Changes)}Nlk(z,T){this.VAh(T.$w.shapeNode,!0)}Glk(z,T){this.VAh(T.$w.shapeNode,!1)}VAh(z,T){(z=this.loe.QE(z))&&(T?z.ywa():z.gZ())}Enl(){this.lLg||(this.lLg=!0,gd.c(oa.a.Xhi))}}Object(h.a)(ba,"RevisionTrackingPresenter",null,[]);class Sa{iSf(){const z=new Kd.a;z.Bh(16,16);z.za.setAttribute("class","RevisionTrackingIconSVG");
z.pwa("0 0 16 16");const T=new Rf.a;T.$_("M13,7.5c0,0.5-0.4,0.9-0.9,0.9H9.7l2.6,2.6c0.4,0.4,0.4,0.9,0,1.3c-0.4,0.4-0.9,0.4-1.3,0L8.4,9.7v2.4C8.4,12.6,8,13,7.5,13c-0.5,0-0.9-0.4-0.9-0.9V9.7L4,12.3c-0.4,0.4-0.9,0.4-1.3,0c-0.4-0.4-0.4-0.9,0-1.3l2.6-2.6H2.9C2.4,8.4,2,8,2,7.5C2,7,2.4,6.6,2.9,6.6h2.4L2.7,4c-0.4-0.4-0.4-0.9,0-1.3c0.4-0.4,0.9-0.4,1.3,0l2.6,2.6V2.9C6.6,2.4,7,2,7.5,2C8,2,8.4,2.4,8.4,2.9v2.4L11,2.7c0.4-0.4,0.9-0.4,1.3,0c0.4,0.4,0.4,0.9,0,1.3L9.7,6.6h2.4C12.6,6.6,13,7,13,7.5z M7.5,5.6c-1,0-1.8,0.8-1.8,1.8c0,1,0.8,1.8,1.8,1.8c1,0,1.8-0.8,1.8-1.8C9.3,6.4,8.5,5.6,7.5,5.6z");
z.appendChild(T);return z.za}KRf(){const z=new Kd.a;z.Bh(10,10);z.pwa("0 0 10 10");z.za.setAttribute("class","ModernRevisionTrackingIconSVG");const T=new Rf.a;T.$_("M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0");T.za.setAttribute("class","ModernRevisionTrackingIconPath");z.appendChild(T);return z.za}}Object(h.a)(Sa,"RevisionTrackingSVGProvider",null,[755]);class sb{constructor(){this.d2c=this.C3c=this.B3c=this.qme=0}QVj(){this.C3c+=1}mVj(z,T){switch(z){case 2:T&&(this.B3c+=1);break;case 0:T?(this.d2c+=1,Wc.a.J(39068549,
804,50,"HandleShowHideChanges: User enables detailed highlight via Ribbon button")):Wc.a.J(39068551,804,50,"HandleShowHideChanges: User disables detailed highlight via Ribbon button");break;case 1:T&&(this.qme+=1)}}log(){Wc.a.J(39068553,804,15,"WYWA Notification Clicks:{0}; Thumbnail Revision Tracking Pawn Clicks: {1}; Thumbnail Revision Tracking Pawn Hovers: {2}; Show Hide Changes Ribbon Clicks:{3};",this.qme,this.B3c,this.C3c,this.d2c);0<this.B3c+this.C3c+this.d2c&&gd.c(oa.a.eLd)}}Object(h.a)(sb,
"RevisionTrackingTelemetry",null,[]);var Tb=d(996),Tc=d(1099),Vb=d(72),Ed=d(565);class ae{constructor(z,T,ja,Ba,Ga){this.y9a=null;this.CFa=z;this.$ab=T;this.Dc=Ga;this.Wb=ja;this.sa=Ba;this.CFa.NU(Object(v.a)(this,this.pF,"onInteractivityChanged"))}dispose(){this.CFa&&this.CFa.dispose();this.y9a=this.CFa=null}display(z,T){this.y9a||(this.y9a=new Ed.a);this.y9a.color=z;this.y9a.userName=T;this.CFa.kz(this.y9a)}dismiss(){this.CFa.BL(this.y9a.clientId)}ywa(){this.CFa.vwa()}gZ(){this.CFa.tea()}get DId(){const z=
this.CFa.xdb;return 0<z.length?z[0]:null}pF(z,T){z={InvokeSource:2,ShowRevisionTrackingStatus:null};1===T.type?(this.Wb.Ca!==this.Dc?(this.Dc&&(this.Wb.Ca=this.Dc,this.sa.gy()),z.ShowRevisionTrackingStatus=3):z.ShowRevisionTrackingStatus=1,E.AFrameworkApplication.Va.Ma(Xc.a.KGb,2,z)):2===T.type?this.Dc&&this.Wb.Ca===this.Dc&&(z.ShowRevisionTrackingStatus=2,E.AFrameworkApplication.Va.Ma(Xc.a.KGb,2,z),this.$ab.QVj()):3===T.type&&this.Dc&&this.Wb.Ca===this.Dc&&(z.ShowRevisionTrackingStatus=0,E.AFrameworkApplication.Va.Ma(Xc.a.KGb,
2,z))}}Object(h.a)(ae,"ThumbnailRevisionTrackingPawn",null,[808,109]);var Rd=d(363);class pe{constructor(z,T,ja,Ba,Ga,Fb){this.we=z;z=Vb.getImageClassWithCluster("pegal","UnreadNotification_16x16x32");T=T.rk("pegal.png");ja=E.AFrameworkApplication.fa.ka(Ra.a.pa(1166))?ja.KRf():ja.iSf();this.n4j=this.Tzi(E.AFrameworkApplication.isRtl,z,T,ja);this.$ab=Ba;this.Wb=Ga;this.sa=Fb}Oml(z){let T=null;z&&(T=this.we.De(),z.kPe?(T.style.width=this.Nc(Rd.a.mjl+z.kPe.width),T.style.left=this.Nc(Math.min(z.wak,
-16)-2),T.style.height=this.Nc(6+Math.abs(Rd.a.Zuh)+z.kPe.height),T.style.top=this.Nc(Rd.a.Zuh-2)):Wc.a.J(591681751,804,10,"TryCreateBackground: thumbnailViewElement.ThumbOuterBorderSize is null"),this.we.addCssClass(T,"rtThumbnail"));return T}Jxi(z,T){return new ae(this.n4j.lpb(z),this.$ab,this.Wb,this.sa,T)}Nc(z){return this.we.Nc(z)}Tzi(z,T,ja,Ba){const Ga=new Tb.a;Ga.add(1,T);Ga.add(4,ja);Ga.add(6,16);Ga.add(8,z);Ga.add(12,2);Ga.add(11,!1);Ga.add(14,Ba);return new Tc.a(Ga)}}Object(h.a)(pe,"RevisionTrackingThumbnailGadgetsFactory",
null,[754]);class ff{constructor(z,T,ja){this.RZc=this.T8b=!0;this.Dz=z;this.SEa=T;this.la=ja}get pOj(){return this.T8b}getSlideLastViewedVersionInfo(z){if(this.RZc){Wc.a.J(25203102,824,50,"GetSlideLastViewedVersionInfo(), Start sending read request to FE at [{0}]",JSON.stringify(new Date));var T=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPPTSlideLastViewedMetadata",E.AFrameworkApplication.$g),ja={};ja["X-StatelessPopsAffinityRoutingEnabled"]=
this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Dz.Jj(T,1,null,ja,!1,2,Object(v.a)(this,this.Xhk,"onGetVersionInfoSucceeded"),Object(v.a)(this,this.Whk,"onGetVersionInfoFailed"),z,void 0,void 0,void 0,void 0,gk.a("12"));this.RZc=!1}else Wc.a.J(25203100,824,50,"Response of previous get roaming request is not back yet.")}putSlideLastViewedVersionInfo(z){if(this.T8b){Wc.a.J(25203106,824,50,"PutSlideLastViewedVersionInfo(), Start sending write request to FE");var T=D.c(z),ja=this.la.pptRevisionTrackingMaxRoamingDataSizeInBytes;
if(T.length>ja)Wc.a.J(25203136,824,50,"Roaming data size is bigger than the limitation, won't write to roaming service, slideNum={0}, dataSize={1}, sizeLimitation={2}",z.lv.length,T.length,ja);else{ja=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePPTSlideLastViewedMetadata",E.AFrameworkApplication.$g);if(E.AFrameworkApplication.fa.ka("SendBeaconOnRoamingRequestsIsEnabled"))this.Dz.RHa(ja,T);else{const Ba={};Ba["X-StatelessPopsAffinityRoutingEnabled"]=
this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Dz.Jj(ja,2,T,Ba,!1,2,Object(v.a)(this,this.qkk,"onPutVersionInfoSucceeded"),Object(v.a)(this,this.pkk,"onPutVersionInfoFailed"),z.lv.length,void 0,void 0,void 0,void 0,gk.a("13"))}this.T8b=!1}}else Wc.a.J(25203104,824,50,"Response of previous write roaming request is not back yet.")}dispose(){}Xhk(z){this.RZc=!0;let T=0;try{let ja=null;z.data.je&&0<z.data.je.trim().length&&(T=z.data.je.length,ja=JSON.parse(z.data.je,Object(v.a)(this,this.EOj,
"jsonDateReviver")));const Ba=z.data.state;Ba(ja)}catch(ja){Wc.a.J(23132289,824,10,"OnGetVersionInfoSucceeded catched exception: {0}",ja.toString())}z=String.format("OnGetVersionInfoSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",T,JSON.stringify(z.data.JH),JSON.stringify(z.data.wt),JSON.stringify(z.data.Eu));Wc.a.J(25203139,824,50,z)}Whk(z){this.RZc=!0;z=this.SEa.Vha(z);Wc.a.J(23132291,824,50,"OnGetVersionInfoFailed: Web service failed with {0}",z)}qkk(z){this.T8b=
!0;Wc.a.J(25203142,824,50,"OnPutVersionInfoSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+z.data.Eu-+z.data.JH,+z.data.wt-+z.data.JH)}pkk(z){this.T8b=!0;const T=this.SEa.Vha(z);Wc.a.J(23132293,824,50,"OnPutVersionInfoFailed: Web service failed with {0}, NumSlides={1}",T,z.data.state)}EOj(z,T){return"dt"===z||"defLv"===z?new Date(T):T}}Object(h.a)(ff,"RoamingCacheProxy",null,[753,109]);var eg=d(670),kh=d(111);class Wa{constructor(z,T,ja){this.Ag=z;this.EI=Object(A.a)(eg.a,this.Ag.bmh);this.UWc=T;this.FOg=
ja;this.$Z=E.AFrameworkApplication.fa.ka(Ra.a.pa(1166));this.Ag.Stg=this.$Z}display(z){let T;T=this.$Z?this.FOg.KRf():this.FOg.iSf();this.EI.fBf(this.UWc.backgroundColor,z,T);this.Ag.PIb(this.UWc.foregroundColor);this.Ag.setVisibility()}dismiss(){this.EI.clear();this.Ag.PIb(kh.a.none);this.Ag.setVisibility()}Vm(z){this.Ag.Vm(z)}SD(z){this.Ag.SD(z)}eq(){return this.Ag.eq()}IP(z){return this.Ag.Ytb(z)}Rx(z){this.Ag.Rx(z)}dispose(){this.Ag.dispose()}mz(){this.Ag.mz()}TE(z){return this.Ag.TE(z)}MD(z){return this.Ag.MD(z)}draw(z,
T){this.Ag.draw(z,T)}get visible(){return this.Ag.visible}set visible(z){this.Ag.visible=z}setPosition(z,T){this.Ag.setPosition(z,T)}Ej(z){this.Ag.Ej(z)}Nq(z){this.Ag.Nq(z)}ov(z){this.Ag.ov(z)}setZIndex(z){this.Ag.setZIndex(z)}wF(z,T){this.Ag.wF(z,T)}ywa(){this.EI.ywa()}gZ(){this.EI.gZ()}setSelection(){}}Object(h.a)(Wa,"ShapeRevisionTrackingView",null,[786,283,284,109]);class qb{constructor(){this.K=null;this.Yxb=this.vke=this.tW=this.OEa=!1}get name(){return"PowerPointWebEditor.RevisionTracking"}init(){}Yb(z){this.K=
z;z.resolve("Common.IAppSettingsManager").gf(()=>{this.tW=z.resolve("PowerPointWebEditor.IApplicationContext").kd.zg;this.vke=z.resolve("PowerPointWebEditor.IApplicationContext").kd.KIj;this.OEa=z.resolve("PowerPointWebEditor.IApplicationContext").kd.$vg;this.Yxb=z.resolve("PowerPointWebEditor.IApplicationContext").kd.z9d;this.register();this.resolve()})}dispose(){this.OEa&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").dispose())}register(){const z=this.K;this.tW&&this.vke&&z.register(Ji.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>new Ji.a(E.AFrameworkApplication.Be,z.resolve("PowerPointWebEditor.ISessionInfoOwner"),z.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),z.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),z.resolve("PowerPointWebEditor.IErrorHandler"),z.resolve("Common.ITaskManager"),z.resolve("Common.IAppSettingsManager")));
this.OEa&&(z.register(sb,"RevisionTrackingTelemetry").ma().na(()=>new sb),z.register(L,"PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").ma().na(()=>new L(z.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy"),z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("Common.ITaskManager"),z.resolve("PowerPointWebEditor.ISlideReader"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
z.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),z.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),z.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),z.resolve("Box4.Graph.IGraphInstance").Cd(10),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource"),z.resolve("PowerPointWebEditor.IApplicationSettings"),z.resolve("Common.IAppSettingsManager"),z.resolve("RevisionTrackingTelemetry"),z.resolve("PowerPointWebEditor.View.IPPTPageView"))),z.register(ba,
"PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").ma().na(()=>new ba(z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>"),z.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),z.resolve("PowerPointWebEditor.IShapeReader"),
z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),z.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Na,z.resolve("Box4.IPageView").Na,z.resolve("PowerPointWebEditor.IApplicationSettings").z9d,z.resolve("Common.IAppSettingsManager").ka(Ra.a.bHa))),z.register(753,"PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").ma().na(()=>new ff(E.AFrameworkApplication.Be,z.resolve("PowerPointWebEditor.IJsonpHelperManager"),z.resolve("PowerPointWebEditor.IApplicationSettings"))),
z.register(754,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory").ma().na(()=>new pe(z.resolve("PowerPoint.IBrowserHelperManager"),z.resolve("PowerPoint.IPathManager"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider"),z.resolve("RevisionTrackingTelemetry"),z.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),z.resolve("PowerPointWebEditor.IPptSelectionManager"))),z.register(Qm,"PowerPointWebEditor.RevisionTracking.RevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers").ma().na(()=>
new Qm),z.register(259,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>").ma().na(()=>new fm.a((T,ja)=>{let Ba=null;const Ga=Object(A.a)(133,T.pc(z.resolve("Box4.IPageView").Na));Ga&&!Ga.kl&&(T=z.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").gPd(z.resolve("PowerPointWebEditor.IPptSelectionManager"),(Fb,Rb,tc)=>z.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").Oyi(Fb,Rb,tc,z.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),
T,ja,Ga.IT),Ba=new Wa(T,z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider")),Ba.Vm(Ga.IT),Ga.Bza(Ba,1),Ba.visible=Ga.KP||Ga.Bn);return Ba})),z.register(Xe,"PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider").ma().na(()=>new Xe(z.resolve("Common.Utils.IHighContrastDetector"))),z.register(755,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider").ma().na(()=>new Sa),
this.tW&&this.Yxb&&z.register(Xi,"PowerPointWebEditor.RevisionTracking.RevisionTrackingActor").ma().na(()=>new Xi(z.resolve("Common.IActionManagerExtended"),z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.View.IViewEventSource"),z.resolve("RevisionTrackingTelemetry"))))}resolve(){this.tW&&
this.vke&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");if(this.OEa&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter"),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory"),this.Yxb)){const z=this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingActor");z.wb();z.Fe()}}static main(){Ya.a.instance.Ec(Db.a(new qb,0))}}Object(h.a)(qb,
"PPTWebEditorRevisionTrackingPackage",null,[2,3]);var dg=d(533),zb=d(671);class km{get name(){return"Common.App.OAuth.OAuthPackage"}Yb(z){z.register(790,"Common.App.OAuth.IOAuthManager").ma().na(()=>new dg.OAuthManager)}init(){const z=C.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.tol(z)}tol(z){const T=E.AFrameworkApplication.fa.Ia("FileSource");if(E.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||E.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===T){var ja=Q.a.xti;
if(ja&&ja.IsEnabled){var Ba=ja.Application,Ga=Q.a.authority;if(void 0!==Ba&&null!==Ba&&Ba.length&&void 0!==Ga&&null!==Ga&&Ga.length){var Fb=zb.a[z.p5],Rb=P.a.ey,tc=z.fD();try{var Ac=new Map;void 0!==Ac&&null!==Ac?(Ac.set("SupportStatus",Fb),Ac.set("Browser",Rb),Ac.set("AuthStrategy",tc)):Ac=null}catch(nd){Ac=null}u.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Ac);var kd=Cc.a.pj();z.p0("Core",Ba).then(nd=>{const Bd=Math.floor(Cc.a.pj()-kd);Fb=zb.a[z.p5];Rb=P.a.ey;tc=z.fD();
e.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',Bd,nd.IsSuccess,Fb,nd.ErrorCode,T,Rb,tc);Ac&&(Ac.set("SupportStatus",Fb),Ac.set("Browser",Rb),Ac.set("AuthStrategy",tc));var Zd=Object.assign(new Z.a,{durationMs:Bd,extendedProperties:Ac});if(nd.IsSuccess){if(u.Health.instance.recordKpiSuccess("WacCorePFT",Zd),Zd=ja.Endpoint){var df=Cc.a.pj();
E.AFrameworkApplication.Be.umb(Zd,1,null,{["Authorization"]:"Bearer "+nd.Token},2,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Ke=>{var zf=Math.floor(Cc.a.pj()-df),Sf=null;Ke.yn?Ke="Canceled":Ke.Sl?Ke="Faulted":(Sf=Ke.result,Ke=Sf.succeeded?"Completed":"Failed");zf={["TaskResult"]:Ke,["BrowserTokenDurationMS"]:Bd,["BrowserValidationDurationMS"]:zf};Sf&&(zf.HttpStatus=Sf.Qi.data.tf,Sf.succeeded&&(Sf=D.a(Sf.Qi.data.je),zf.ServerValidationDurationMS=Sf.ElapsedMilliseconds,zf.ServerValidationResult=
Sf.ValidatedToken,zf.KMSI=Sf.KMSI,zf.Scopes=Sf.Scopes,zf.TokenExpirationS=Math.floor(parseInt(Sf.Expiration)-(new Date).getTime()/1E3)));e.ULS.sendTraceTag(520632322,3E3,"Completed"===Ke?50:15,ea.a.toJSON(zf))})}}else u.Health.instance.recordKpiFailure("WacCorePFT",nd.ErrorCode,!1,!1,Zd)}).catch(nd=>{var Bd=Math.floor(Cc.a.pj()-kd);Bd=Object.assign(new Z.a,{durationMs:Bd,extendedProperties:Ac});u.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+nd.toString(),!1,!1,Bd)})}}}}dispose(){}static main(){Ya.a.instance.Ec(new km)}}
Object(h.a)(km,"OAuthPackage",null,[2,3]);var Nj=d(395),Wj=d(220),Oj=d(133);class Tl{constructor(z){this.kMa=[dd.a.wlc,dd.a.xlc,dd.a.ylc,dd.a.zlc,dd.a.Alc];this.f_e=z}c8f(z){return this.f_e?this.f_e.fLc(z.Wa):null}create(z){return z?(z=this.eWb(z))?Oj.m(z):"":""}ivi(z){z=z.suggestions;if(!z||!z.count)return null;z=({GUf:T}=this.Bzi(z)).returnValue;var T=Tl.jwi(T);const ja=Object.assign(new Nj.a,{ExternalId:"DictationCorrectionMenu",Command:"798637440",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsFlyoutTitle,
Image16by16Class:Vb.getImageClassWithCluster(E.AFrameworkApplication.bN,Tl.CEi),Image16by16:E.AFrameworkApplication.Rl,Menu:Object.assign(new cg.a,{ExternalId:"DictationCorrectionSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,MenuSectionList:[]})});z&&Array.add(ja.Menu.MenuSectionList,z);Array.add(ja.Menu.MenuSectionList,T);return ja}Bzi(z){let T;const ja=Object.assign(new Ng.a,{Id:"DictationCorrectionSuggestions",ControlList:[],ControlsId:"DictationCorrectionSuggestionsControls",Title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle});
T=null;for(let Ba=0,Ga=Math.min(this.kMa.length,z.count);Ba<Ga;++Ba){if(!T&&""===z.ga(Ba).suggestion){T=this.kMa[Ba].toString();continue}const Fb=Object.assign(new Wj.a,{ExternalId:"btnDictationCorrectionSuggestion"+Ba,Command:this.kMa[Ba].toString(),LabelText:z.ga(Ba).suggestion});Array.add(ja.ControlList,Fb)}return ja.ControlList.length?{returnValue:ja,GUf:T}:{returnValue:null,GUf:T}}eWb(z){if(z=this.ivi(z)){const T=Object.assign(new Ng.a,{Id:"DictationCorrectionSection",ControlList:[],ControlsId:"DictationCorrectionSection"});
Array.add(T.ControlList,z);return T}return null}static jwi(z){const T=Object.assign(new Ng.a,{Id:"DictationCorrectionIgnoreSuggestionSection",ControlList:[],ControlsId:"DictationCorrectionIgnoreSuggestionSectionControls"}),ja=Object.assign(new Wj.a,{ExternalId:"btnIgnoreDictationCorrectionSuggestion",Command:"421768503",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsIgnoreSuggetion});Array.add(T.ControlList,ja);z&&(z=Object.assign(new Wj.a,{ExternalId:"btnDeleteDictationCorrectionSuggestion",
Command:z,LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsDeleteSuggetion}),Array.add(T.ControlList,z));return T}}Tl.CEi="Insertaudio_16x16x32";Object(h.a)(Tl,"DictationCorrectionContextMenuManager",null,[783]);var qo=d(430);class lm{constructor(z,T){this.$pc=null;this.Tq=z;this.eY=T}get key(){return"DICTATIONCORRECTION"}get w6(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle}reset(z){this.Tq.Pd(z.node)?this.$pc=z.node:this.$pc=null}Gmc(z){let T;T=null;if(!this.$pc)return{returnValue:!1,
uza:T};z=this.eY.I_i(this.$pc,z);if(!z)return{returnValue:!1,uza:T};T=Object.assign(new qo.a,{F_:this.key,kP:z,description:this.RXd()});return{returnValue:!0,uza:T}}RXd(){return E.AFrameworkApplication.fa&&E.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}}Object(h.a)(lm,"DictationCorrectionDetailsProvider",null,[777,403]);var Jo=d(601),vl=d(141);class An{constructor(z,T,ja=-1){this.TriggerType="click";this.TreatedInUX=
"true";this.PhraseId=z.vsk;this.CorrectionId=z.id;switch(T){case 0:this.EditType="alternate";this.AlternateId=ja;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:e.ULS.sendTraceTag(51246608,394,10,"Invalid CorrectionEditType value")}}}Object(h.a)(An,"CorrectionEvent",null,[]);class uj{constructor(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=null}}Object(h.a)(uj,"CorrectionTelemetry",null,[]);class cf{constructor(){this.Id=
"Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}}Object(h.a)(cf,"CorrectionsSessionTelemetry",null,[]);class Tm{constructor(){this.pR=!1;this.xnd=this.jwd=0}start(){this.pR||(this.pR=!0,this.jwd=this.getTime())}stop(){this.pR&&(this.xnd+=this.getTime()-this.jwd,this.pR=!1)}get vq(){return this.xnd+(this.pR?this.getTime()-this.jwd:0)}getTime(){return(new Date).getTime()}}Object(h.a)(Tm,"DictationCorrectionsSessionTimer",null,[]);class $o{constructor(){this.StartTime=
"";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}}Object(h.a)($o,"SessionInfo",null,[]);class vf{constructor(){this.FinalText="";this.PhraseIds=null}}Object(h.a)(vf,"TextInfo",null,[]);var Ve=d(179),pf=d(139);class fe{constructor(z){this.wef=this.Rxd=this.Sxd=0;this.aFh="Office.Voice.Online.DictationCorrectionsSession";this.w1a=null;this.slb=Object.assign(new $o,{TextInfo:[new vf]});this.W2e=z}startSession(){this.w1a||(this.slb.StartTime=(new Date).toISOString(),
this.w1a=new Tm);this.w1a.start()}pauseSession(){this.w1a.stop()}endSession(){this.w1a.stop();var z=new Ve.a;z.name=this.aFh;z.samplingPolicy=2;z.durationMs=this.w1a.vq;z.dataFields=[];Array.add(z.dataFields,Object.assign(new pf.a,{name:"CorrectionSessionId",string:this.ewa}));Array.add(z.dataFields,Object.assign(new pf.a,{name:"StartTime",string:this.slb.StartTime}));Array.add(z.dataFields,Object.assign(new pf.a,{name:"NumberOfCorrectionsMarked",int64:this.Sxd}));Array.add(z.dataFields,Object.assign(new pf.a,
{name:"NumberOfCorrectionsMade",int64:this.Rxd}));Array.add(z.dataFields,Object.assign(new pf.a,{name:"NumberOfCorrectionsDismissed",int64:this.wef}));vl.a.sendActivityEvent(z);if(uf.App.TY&&0<uf.App.TY.o3g.length){this.slb.AlternateEditCount=this.Rxd;this.slb.Duration=Math.floor(this.w1a.vq/1E3);this.slb.TextInfo[0].PhraseIds=uf.App.TY.o3g;var T=new cf;T.ClientSessionId=this.ewa;T.SessionInfo=this.slb;if(z=this.W2e())T=D.c(T),z.Tzg(T)}}Fgk(z){this.Sxd+=z}IWg(z,T,ja=-1){0===T?this.Rxd++:1===T&&this.wef++;
var Ba=new uj;Ba.ClientSessionId=this.ewa;Ba.CorrectionEvents=[new An(z,T,ja)];if(z=this.W2e())Ba=D.c(Ba),z.Tzg(Ba)}get ewa(){return uf.App.TY?uf.App.TY.ewa:""}}Object(h.a)(fe,"DictationCorrectionsTelemetry",null,[]);var te=d(41),ne=d(39);class Pj{constructor(z,T,ja){this.HM=z;this.Lb=T;this.dG=ja}}Object(h.a)(Pj,"DictationCorrectionRange",null,[]);var hk=d(347);class xm{constructor(z,T,ja){this.ewf=this.uq=null;this.Oib=z;this.Oxa=T;this.Tuc=new hk.a(new Jo.a);this.Spc=ja;this.r4()}E6d(z){this.Oxa.LAa&&
ad.ParagraphReader.Pd(z)&&this.Tuc.contains(z.id)&&this.Oib.E6d(z)}Tdl(){this.Oxa.LAa=!0;this.uq=new fe(()=>this.ewf);this.uq.startSession()}Mel(){this.Oxa.LAa=!1;var z=uf.App.Fb.Fd.Xm.ug;if(z){z=z.Eh;for(let T of this.Tuc){const ja=z.te(T);ja&&ad.ParagraphReader.Pd(ja)&&this.Oib.hli(ja)}}this.Spc.clear();this.Tuc.clear();this.uq.endSession()}iSk(z){if(this.Oxa.LAa){var T=z.ta(ne.a.dRd,null);if(!Ia.a.Xa(T)){var ja=new ya.a,Ba=Math.min(T.length,z.Ra.length);for(let Ga=0;Ga<Ba;Ga++){const Fb=this.Spc.jZi(T[Ga]);
if(Fb){const Rb=z.Ra.ga(Ga).cp;ja.add(new Pj(Rb,Rb+Fb.source.length,Fb))}}this.Oib.g9j(z,ja)}}}XRe(z,T){if(!T)return!1;if(!this.Oxa.LAa||!z)return T.add(null),!1;T.add(z.Hu?z.Hu.dG.key:null);return!!z.Hu}TUk(z,T){this.Oxa.LAa&&T&&Ea.AT(T,ja=>!!ja)?z.ke(ne.a.dRd,T.toArray()):z.removeProperty(ne.a.dRd)}cah(z){this.ewf=z}r4(){this.Oib.q1h(Object(v.a)(this,this.Cgk,"onDictationCorrectionMarkerAdded"));Lg.a.addHandler(window.self,eb.a.blur,()=>{this.uq&&this.Oxa.LAa&&this.uq.pauseSession()});Lg.a.addHandler(window.self,
eb.a.focus,()=>{this.uq&&this.Oxa.LAa&&this.uq.startSession()});this.Oib.r1h(Object(v.a)(this,this.Dgk,"onDictationCorrectionMarkerRemoved"))}Dgk(z,T){this.Spc.YKk(T.sQf)}Cgk(z,T){this.Tuc.add(T.Epk);this.uq&&this.uq.Fgk(T.J9j);this.Spc.KYh(T.sQf)}Bgk(z,T){this.uq&&this.uq.IWg(z,0,T)}Egk(z){this.uq&&this.uq.IWg(z,1)}I_i(z,T){if(!this.Oxa.LAa)return null;z=Lc.a.Wj(z,T);return this.Oib.fLc(z)}}Object(h.a)(xm,"DictationCorrectionManager",null,[782]);var Pi=d(336);class Ce extends Sys.EventArgs{constructor(z,
T){super();this.Epk=z;this.J9j=T?T.count:0;this.sQf=T}}Object(h.a)(Ce,"DictationCorrectionMarkerEventArgs",Sys.EventArgs,[]);class Wk{constructor(z,T,ja,Ba,Ga){this.LQh=z;this._id=T;this.MHh=Ba;this.YQb=Ga;this.$s=ja;this.QNb=String.format("{0}_{1}",z,T)}get vsk(){return this.LQh}get id(){return this._id}get source(){return this.$s}get confidence(){return this.MHh}get suggestions(){return this.YQb}get key(){return this.QNb}S$j(z){this.suggestions.addRange(z.suggestions)}}Object(h.a)(Wk,"DictationCorrectionDetails",
null,[]);class vk{constructor(z,T,ja){this.nn=z;this.iIh=T;this.SPh=ja}get dG(){return this.iIh}get KXg(){return this.SPh}get xe(){return this.nn}Vd(z){return new vk(z||this.xe,this.dG,this.KXg)}}Object(h.a)(vk,"DictationCorrectionObject",null,[149]);class nf{constructor(z,T){this.source=z;this.suggestion=T}}Object(h.a)(nf,"DictationCorrectionSuggestion",null,[]);class qg{constructor(z){this.Vg=z;this.Ta=new Ae.a}q1h(z){this.Ta.addHandler("ADCM",z)}r1h(z){this.Ta.addHandler("RDCM",z)}g9j(z,T){this.q9j(z,
T)}q9j(z,T){if(z&&T&&T.count&&(T=qg.hwl(z,T))&&T.count){this.uli(z,T);var ja=new ya.a;for(var Ba of T)ja.add(Ba.HM),ja.add(Ba.Lb);z.ZSd(ja);for(let Ga of T)Ba=z.Ra.fS(Ga.HM),Ba.Hu=new vk(Ba,Ga.dG,Object(v.a)(this,this.Pkj,"handleParagraphSplit")),Ba.isFromErrorRangeSplit=!0,Ba=z.Ra.fS(Ga.Lb),Ba.isDictationCorrectionEnd=!0,Ba.isFromErrorRangeSplit=!0;0<T.count&&this.Ta.raiseEvent("ADCM",new Ce(z.id,T))}}b8f(z){const T=new ya.a;if(z){let ja=null,Ba=-1;for(let Ga=0;Ga<z.Ra.length;Ga++){const Fb=z.Ra.ga(Ga);
Fb.Hu?(Ba=Fb.cp,ja=Fb.Hu.dG):Fb.isDictationCorrectionEnd&&(ja?T.add(new Pj(Ba,Fb.cp,ja)):e.ULS.sendTraceTag(593285261,394,10,"Correction range end with no start."),ja=null)}}return T}vhc(z,T){if(z&&T&&T.count){for(let ja of T){let Ba=z.Ra.fS(ja.HM);Ba&&(Ba.Hu=null);if(Ba=z.Ra.fS(ja.Lb))Ba.isDictationCorrectionEnd=!1}this.Ta.raiseEvent("RDCM",new Ce(z.id,T))}}hli(z){if(z)for(let T=0;T<z.Ra.length;T++){const ja=z.Ra.ga(T);ja.Hu&&(ja.Hu=null);ja.isDictationCorrectionEnd&&(ja.isDictationCorrectionEnd=
!1)}}fLc(z){if(!z||!te.SelectionEditor.Oj(z)&&!te.SelectionEditor.Mg(z))return null;const T=z.node;let ja=z.Qa;z=z.Lb;let Ba=0,Ga=null;for(let Fb=0;Fb<T.Ra.length;Fb++){const Rb=T.Ra.ga(Fb);if(Rb.Hu&&ja>=Rb.cp)Ga=Rb.Hu,Ba=Rb.cp;else if(Ga&&Rb.isDictationCorrectionEnd){if(z<=Rb.cp)return new Pj(Ba,Rb.cp,Ga.dG);Ga=null}}return null}iwl(z,T,ja){if(!z)return!1;z=ad.ParagraphReader.text(z);return qg.eCh(z,T.source,ja)}E6d(z){if(z){var T=this.b8f(z);if(T&&0<T.count){const ja=new ya.a,Ba=ad.ParagraphReader.text(z);
for(let Ga of T)qg.dCh(Ba,Ga)||ja.add(Ga);this.vhc(z,ja)}}}uli(z,T){T.ga(0);T.ga(T.count-1);const ja=this.b8f(z);let Ba=0,Ga=0;const Fb=new ya.a;for(;Ga<T.count&&Ba<ja.count;){const Rb=T.ga(Ga),tc=ja.ga(Ba);Rb.Lb<tc.HM?Ga++:(tc.Lb>Rb.HM&&Fb.add(tc),Ba++)}this.vhc(z,Fb)}Pkj(z,T){const ja=T.xe;for(var Ba=z.Ra.Yrb(ja.cp)+1;Ba<z.Ra.length;Ba++){const Ga=z.Ra.ga(Ba);if(Ga.isDictationCorrectionEnd){let Fb;this.vhc(z,(Fb=new ya.a,Fb.add(new Pj(ja.cp,Ga.cp,T.dG)),Fb));break}}}lmk(z,T){(z=uf.App.Fb.Fd.Xm.ug)&&
(T=z.Eh.te(Pi.a.ig(T.nodeId)))&&ad.ParagraphReader.Pd(T)&&this.ZKk(T)}ZKk(z){if(z){var T=0,ja=!1,Ba=!1,Ga=new ya.a;for(let Fb=0;Fb<z.Ra.length;Fb++){const Rb=z.Ra.ga(Fb);Rb.Hu&&(T=Fb,ja=!0);ja&&(Rb.yp||Rb.GK)&&(Ba=!0);Rb.isDictationCorrectionEnd&&ja&&(ja=!1,Ba&&(Ba=z.Ra.ga(T),Ba.Hu&&Ba.Hu.dG&&Ga.add(new Pj(Ba.cp,Rb.cp,Ba.Hu.dG)),Ba.Hu=null,Ba=Rb.isDictationCorrectionEnd=!1))}this.Ta.raiseEvent("RDCM",new Ce(z.id,Ga))}}static hwl(z,T){if(!T.count)return T;T.Sc((Ba,Ga)=>Ba.HM!==Ga.HM?Ba.HM-Ga.HM:Ba.Lb-
Ga.Lb);z=ad.ParagraphReader.text(z);const ja=new ya.a;for(let Ba=0;Ba<T.count;Ba++){const Ga=T.ga(Ba);if(Ga.HM>z.length||Ga.Lb>z.length)break;if(!qg.dCh(z,Ga))continue;if(!ja.count){ja.add(Ga);continue}const Fb=ja.ga(ja.count-1);Ga.HM>Fb.Lb?ja.add(Ga):Fb.HM===Ga.HM&&Fb.Lb===Ga.Lb&&Fb.dG.S$j(Ga.dG)}return ja}static eCh(z,T,ja){if(ja+T.length<=z.length){for(let Ba=0;Ba<T.length;Ba++)if(T.charAt(Ba)!==z.charAt(Ba+ja))return!1;return!0}return!1}static dCh(z,T){return!z||T.HM>z.length||T.Lb>z.length||
!T.dG||!T.dG.source?!1:qg.eCh(z,T.dG.source,T.HM)}}Object(h.a)(qg,"DictationCorrectionRangeEditor",null,[781]);class ro{constructor(){this.LAa=!1}}Object(h.a)(ro,"DictationCorrectionSettings",null,[]);var Xk=d(14);class Um{constructor(){this.UQb=new Xk.ScriptSharpLegacyMap}KYh(z){if(z&&z.count)for(let T of z)T.dG?(z=T.dG.key,this.UQb.Kb(z)||this.UQb.add(z,T.dG)):e.ULS.sendTraceTag(593285260,394,10,"Correction details is null.")}YKk(z){if(z&&z.count)for(let T of z)T.dG?this.UQb.remove(T.dG.key):e.ULS.sendTraceTag(593285259,
394,10,"Correction details is null.")}jZi(z){if(!z)return null;let T;return({value:T}=this.UQb.Nf(z)).returnValue?T:null}clear(){this.UQb=new Xk.ScriptSharpLegacyMap}}Object(h.a)(Um,"DictationCorrectionStorage",null,[804]);class Xj{constructor(z,T,ja,Ba,Ga,Fb,Rb){this.Vg=z;this.vLb=T;this.eY=ja;this.Da=Ba;this.Rc=Ga;this.ef=Fb;this.kk=Rb}wb(){this.Da.ya(dd.a.wlc,ed.a.Ff,Object(v.a)(this,this.Blc,"takeSuggestedDictationCorrectionAction"));this.Da.ya(dd.a.xlc,ed.a.Ff,Object(v.a)(this,this.Blc,"takeSuggestedDictationCorrectionAction"));
this.Da.ya(dd.a.ylc,ed.a.Ff,Object(v.a)(this,this.Blc,"takeSuggestedDictationCorrectionAction"));this.Da.ya(dd.a.zlc,ed.a.Ff,Object(v.a)(this,this.Blc,"takeSuggestedDictationCorrectionAction"));this.Da.ya(dd.a.Alc,ed.a.Ff,Object(v.a)(this,this.Blc,"takeSuggestedDictationCorrectionAction"));this.Da.ya(dd.a.vlc,ed.a.Ff,Object(v.a)(this,this.vlc,"takeIgnoreSuggestedDictationCorrection"));this.Da.ya(dd.a.wlc,ed.a.view,Object(v.a)(this,this.Pob,"collapseIpThenExecuteAction"));this.Da.ya(dd.a.xlc,ed.a.view,
Object(v.a)(this,this.Pob,"collapseIpThenExecuteAction"));this.Da.ya(dd.a.ylc,ed.a.view,Object(v.a)(this,this.Pob,"collapseIpThenExecuteAction"));this.Da.ya(dd.a.zlc,ed.a.view,Object(v.a)(this,this.Pob,"collapseIpThenExecuteAction"));this.Da.ya(dd.a.Alc,ed.a.view,Object(v.a)(this,this.Pob,"collapseIpThenExecuteAction"));this.Da.ya(dd.a.vlc,ed.a.view,Object(v.a)(this,this.Pob,"collapseIpThenExecuteAction"));this.Da.$d(dd.a.wlc,96);this.Da.$d(dd.a.xlc,96);this.Da.$d(dd.a.ylc,96);this.Da.$d(dd.a.zlc,
96);this.Da.$d(dd.a.Alc,96);this.Da.$d(dd.a.vlc,96)}G7h(z,T,ja){const Ba=this.kk.ie(15);try{Ba.hd(z);let Ga;this.vLb.vhc(z,(Ga=new ya.a,Ga.add(T),Ga));const Fb=T.dG.suggestions.ga(ja);if(this.vLb.iwl(z,Fb,T.HM)){const Rb=Lc.a.createTextRange(z,T.HM,T.HM+Fb.source.length);this.Vg.replaceTextRange(Rb,Fb.suggestion);this.eY.Bgk(T.dG,ja)}else e.ULS.sendTraceTag(50946527,394,100,"Failed to apply Suggestion")}finally{Ba&&Ba.dispose()}}Blc(z,T,ja){2===ja&&T.Ok&&(ja=this.vLb.fLc(T))&&this.G7h(T.node,ja,this.lZi(z));
return 32}Pob(z,T,ja,Ba,Ga){if(2===ja){T=this.Rc.Pa.kb;if(!T)return 2;T=this.ef.xl(T,!0,!1);return this.Da.li(T.Wa,z,ja,!1,Ba,Ga)}return 32}vlc(z,T,ja){if(2===ja&&T.Ok&&(z=this.vLb.fLc(T))){let Ba;this.vLb.vhc(T.node,(Ba=new ya.a,Ba.add(z),Ba));this.eY.Egk(z.dG)}return 32}lZi(z){switch(z){case dd.a.wlc:return 0;case dd.a.xlc:return 1;case dd.a.ylc:return 2;case dd.a.zlc:return 3;case dd.a.Alc:return 4;default:return-1}}}Object(h.a)(Xj,"DictationCorrectionsActor",null,[803]);var ap=d(312),ym=d(62);
class If{constructor(){this.g_e=this.Ea=null}get name(){return"Box4.DictationCorrections"}Yb(z){this.Ea=z;this.Ea.register(781,"Box4.DictationCorrections.IDictationCorrectionRangeEditor").ma().na(()=>new qg(this.Ea.resolve("Box4.ICharacterPropertiesEditor")));this.Ea.register(782,"Box4.DictationCorrections.IDictationCorrectionManager").ma().na(()=>new xm(this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),new ro,new Um));this.Ea.register(783,"Box4.DictationCorrections.IDictationCorrectionContextMenuManager").ma().na(()=>
new Tl(this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor")))}init(){this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionManager");this.g_e=new Xj(this.Ea.resolve("Box4.ICharacterPropertiesEditor"),this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionManager"),E.AFrameworkApplication.Va,ym.a.instance,ap.a.instance,this.Ea.resolve("Box4.Graph.IGraphTransactionFactory"));this.g_e.wb();
this.jIk(this.Ea.Oa("Box4.Accessibility.IAccessibilityContextManager"),this.Ea.resolve("Box4.IParagraphReader"),this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionManager"));const z=this.Ea.qb("Box4.Proofing.IErrorRangeEditor"),T=this.Ea.qb("Box4.DictationCorrections.IDictationCorrectionRangeEditor");E.AFrameworkApplication.fa.ka("WacBox4DictationFloatieIsEnabled")&&z&&T&&z.y2h(Object(v.a)(T,T.lmk,"onSpellingErrorRangesChangedEventHandler"));uf.App.Fb.updateCommandUI()}dispose(){}jIk(z,
T,ja){z&&z.execute(Ba=>{Ba.DWa(new lm(T,ja))})}}Object(h.a)(If,"DictationCorrectionsPackageManager",null,[2,3]);d(1167);d(701);var Ul=d(478);class oi{constructor(z,T,ja,Ba=null,Ga=null){this.nn=z;this.XF=T;this.mNh=ja;this._id=Ba;this.Ttd=Ga}get xe(){return this.nn}get type(){return this.XF}get ek(){return this.mNh}get id(){return this._id}get bpg(){return this.Ttd}Vd(z){return new oi(z,this.type,this.ek,this.id,this.bpg)}toString(){return String.format("Type = {0}, IsStart = {1}, Id = {2}",this.type,
this.ek,this.id?this.id.toString():"<null>")}}Object(h.a)(oi,"IntentObject",null,[149]);d(589);class hg{constructor(z,T,ja,Ba=null,Ga=null){Ul.a(z);this.XF=z;this.Jod=T;this.wrd=ja;this._id=Ba;this.Ttd=Ga}get type(){return this.XF}get begin(){return this.Jod}get end(){return this.wrd}get id(){return this._id}get bpg(){return this.Ttd}toString(){return String.format("Type = {0}, Begin = {1}, End = {2}, Id = {3}",this.type,this.begin,this.end,this.id?this.id.toString():"<null>")}}Object(h.a)(hg,"IntentRange",
null,[294]);d(346);d(161);d(216);class jl{constructor(z){this.Vg=z}}Object(h.a)(jl,"IntentRangeEditor",null,[780]);class wg{constructor(){this.Ea=null}get name(){return"Box4.Intent"}Yb(z){this.Ea=z;this.Ea.register(jl,"Box4.Intent.IntentRangeEditor").as("Box4.Intent.IIntentRangeEditor").ma().na(()=>new jl(this.Ea.resolve("Box4.ICharacterPropertiesEditor")))}init(){this.Ea.resolve("Box4.IProofingManager")}dispose(){}static main(){Ya.a.instance.Ec(new wg)}}Object(h.a)(wg,"PackageManager",null,[2,3]);
var Ef=d(1113),mk=d(1078),Fe=d(298),pi=d(1079),Sn=d(906),zm=d(773);class gh{}gh.productionLanguages="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-IN en-AU".split(" ");gh.previewLanguages="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");gh.mxl="en-US en-CA en-GB en-AU en-IN en-NZ".split(" ");
gh.q$h=["en-US","en-CA","en-GB","en-AU","en-IN"];gh.r$h="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");gh.VBi="en-US";gh.sEi="btnStartDictation";gh.DEi="btnDictationFloatieToggle";gh.xEi="Dictation";gh.EEi="DictationFloatieToggle";gh.FVf="Insertaudio_32x32x32";gh.EVf=
"Insertaudio_16x16x32";gh.wEi="JotInsertAudioRecordingShort_32x32x32";gh.vEi="JotInsertAudioRecordingShort_16x16x32";gh.Wcl="speechOn.wav";gh.Vcl="speechOff.wav";Object(h.a)(gh,"DictationConstants",null,[]);class Am{constructor(z){this.abf=z;this.nKa=(z=tb.a.re(z))?z.displayName:this.abf;this.RF=z?z.LCID:Am.jQj}get CUc(){return this.abf}get displayName(){return this.nKa}get LCID(){return this.RF}}Am.jQj=1033;Object(h.a)(Am,"DictationLanguage",null,[]);class Ki{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac){this.ntc=
null;this.u3e=!1;this.H$=null;this.$lb=!1;this.Da=z;this.eY=uf.App.CYa;this.tqc=uf.App.TY;this.W0=ja;this.$vc=T;this.If=Ba;this.HO=Ga;this.qg=Rb;this.Kd=Ac;this.qg.xK&&(this.H$=Fb);this.ZFh=tc}wb(){this.Da.ra(dd.a.X9c,ed.a.view,Object(v.a)(this,this.X9c,"populateDictationLanguages"),96);this.Da.ra(dd.a.DHe,ed.a.view,Object(v.a)(this,this.DHe,"setDictationLanguage"),1028);this.Da.ra(dd.a.PAe,ed.a.view,Object(v.a)(this,this.PAe,"querySelectedDictationLanguage"),96);this.Da.ra(dd.a.nmc,ed.a.view,Object(v.a)(this,
this.nmc,"toggleDictation"),1028);this.Da.ra(dd.a.kAe,ed.a.view,Object(v.a)(this,this.kAe,"queryDictation"),96);this.Da.ra(dd.a.BVf,ed.a.view,Object(v.a)(this,this.NBb,"onDictationError"),64);this.Da.ra(dd.a.GVf,ed.a.view,Object(v.a)(this,this.NBb,"onDictationError"),64);this.Da.ra(dd.a.JVf,ed.a.view,Object(v.a)(this,this.Jgk,"onDictationRecordingStarted"),64);this.Da.ra(dd.a.KVf,ed.a.view,Object(v.a)(this,this.Kgk,"onDictationRecordingStopped"),64);this.Da.ra(dd.a.HVf,ed.a.view,Object(v.a)(this,
this.Igk,"onDictationModifyRunLanguage"),64);this.Da.ra(dd.a.DVf,ed.a.view,Object(v.a)(this,this.Hgk,"onDictationFocusLost"),64);this.Da.ra(dd.a.MVf,ed.a.view,Object(v.a)(this,this.hhk,"onFailedToInsertText"),64);this.Da.ra(dd.a.IVf,ed.a.view,Object(v.a)(this,this.Mgk,"onDictationTimeout"),64);this.Da.ra(dd.a.R3g,ed.a.view,Object(v.a)(this,this.X9c,"populateDictationLanguages"),96);this.Da.ra(dd.a.EHe,ed.a.view,Object(v.a)(this,this.EHe,"setDictationSettingsLanguage"),1028);this.Da.ra(dd.a.lAe,ed.a.view,
Object(v.a)(this,this.lAe,"queryDictationSettingsLanguage"),96);this.Da.ra(dd.a.zEi,ed.a.view,Object(v.a)(this,this.showHelpPane,"showHelpPane"),96);this.Da.ra(dd.a.AEi,ed.a.view,Object(v.a)(this,this.showHelpPane,"showHelpPane"),96);this.Da.ra(dd.a.yEi,ed.a.view,Object(v.a)(this,this.bkl,"toggleAutoPunctuation"),96);this.Da.ra(dd.a.Wzk,ed.a.view,Object(v.a)(this,this.eBk,"queryToggleAutoPunctuation"),96);this.Da.ra(dd.a.BEi,ed.a.view,Object(v.a)(this,this.okl,"toggleVoiceCommands"),96);this.Da.ra(dd.a.Xzk,
ed.a.view,Object(v.a)(this,this.gBk,"queryToggleVoiceCommands"),96);this.Da.ra(dd.a.Zjd,ed.a.view,Object(v.a)(this,this.Zjd,"toggleDictationInFloatie"),1028);this.Da.ra(dd.a.CVf,ed.a.view,Object(v.a)(this,this.Ggk,"onDictationFloatieDismissed"),1028);this.Da.ra(dd.a.uEi,ed.a.view,Object(v.a)(this,this.Yjk,"onPauseDictationCommand"),96);this.Da.ra(dd.a.tEi,ed.a.view,Object(v.a)(this,this.fhk,"onExitDictationCommand"),96);const z=$a.KeyInputManager.La(kg.a.QBh,1);this.Kd.Bc(Dd.AFrame.kj).bindAction(z,
dd.a.LVf);this.Da.ra(dd.a.LVf,ed.a.view,Object(v.a)(this,this.Lgk,"onDictationShortcut"),1028)}eLc(){return E.AFrameworkApplication.Ba&&E.AFrameworkApplication.Ba.jb.Ip?this.qg.xK?gh.EEi:gh.xEi:this.qg.xK?gh.DEi:gh.sEi}kAe(z,T,ja,Ba,Ga){if(1===ja)return 32;Ga&&(z=!!E.AFrameworkApplication.Ba&&E.AFrameworkApplication.Ba.jb.Ip,this.H$?Ga[z?mf.a.On:mk.a.On]=this.H$.isVisible():(ja=this.W0.PH(),ja=(T=2===ja)||1===ja,z?(Ga[mf.a.On]=ja,Ga[Fe.a.IconSet]=T?(new pi.a("JotInsertAudioRecordingShort_20")).iconSet:
E.AFrameworkApplication.Ba.jb.Pma?(new pi.a("InsertAudio_32")).iconSet:(new pi.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet):(Ga[mk.a.On]=ja,T?(Ga[mk.a.Image32by32Class]=Vb.getImageClass(gh.wEi),Ga[mk.a.Image16by16Class]=Vb.getImageClass(gh.vEi)):(Ga[mk.a.Image32by32Class]=Vb.getImageClass(gh.FVf),Ga[mk.a.Image16by16Class]=Vb.getImageClass(gh.EVf)))));return 32}nmc(z,T,ja){if(2===ja)if(this.H$)this.rvh();else return this.HTd();return 32}Zjd(z,T,ja){return 2!==ja?32:this.HTd()}X9c(z,T,ja,
Ba,Ga){if(1===ja)return 32;this.Btk(Ga,z===dd.a.R3g);return 32}PAe(z,T,ja,Ba,Ga){if(1===ja)return 32;Ga&&((z=Ga.MenuItemId)&&z===this.qg.UR?(Ga[mf.a.On]=!0,this.ntc=Ga.SourceControlId):Ga[mf.a.On]=!1);return 32}lAe(z,T,ja,Ba,Ga){if(1===ja)return 32;Ga&&(Ga[Sn.a.Value]=(new Am(this.qg.UR)).displayName);return 32}DHe(z,T,ja,Ba,Ga){if(1===ja)return 32;Ga&&(z=Ga.SourceControlId,this.ntc!==z&&(this.qg.UR=Ga.MenuItemId,this.aAh(this.ntc),this.aAh(z),this.ntc=z,2===this.W0.PH()&&this.TT()));return 32}EHe(z,
T,ja,Ba,Ga){if(1===ja)return 32;if(Ga){z=Ga.MenuItemId;if(this.qg.UR!==z){this.qg.UR=z;if(this.H$)this.H$.onDictationLanguageChanged(z);2===this.W0.PH()&&this.TT()}this.aSe()}return 32}showHelpPane(z,T,ja,Ba,Ga){if(1===ja)return 32;z=this.ZFh.value;if(!z)return 0;Ga&&(Ga={},Ga.query="AssetID="+(this.qg.Oul?Ki.iLh:Ki.ctd),Ga=Object.assign(new Ef.a,{bO:Ga}),z.pIa(Ki.btd,Ga));return 32}bkl(z,T,ja,Ba,Ga){if(1===ja)return this.qg.n7d?32:8;Ga&&this.qg&&(this.qg.useAutoPunctuation=Ga[mf.a.On]);2===this.W0.PH()&&
this.TT();this.aSe();return 32}okl(z,T,ja,Ba,Ga){if(1===ja)return this.qg.uae?32:8;Ga&&this.qg&&(this.qg.pJb=Ga[mf.a.On]);2===this.W0.PH()&&(this.W0.TT(),this.WIb());this.Bzh();return 32}eBk(z,T,ja,Ba,Ga){if(1===ja)return 32;Ga&&this.qg&&(Ga[mf.a.On]=this.qg.useAutoPunctuation);return 32}gBk(z,T,ja,Ba,Ga){if(1===ja)return 32;Ga&&this.qg&&(Ga[mf.a.On]=this.qg.pJb);return 32}Ggk(z,T,ja){2===ja&&this.xHc();return 32}Yjk(z,T,ja){2===ja&&this.qg.xK&&2===this.W0.PH()&&this.TT();return 32}fhk(z,T,ja){2===
ja&&this.qg.xK&&this.xHc();return 32}JYh(){const z=Object.assign(new Ng.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",ControlList:[]}),T=Object.assign(new wh.a,{Id:"DictationLanguageList_"+this.eLc(),ExternalId:"DictationLanguageList_"+this.eLc(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,Command:"1394650145",MenuItemId:this.eLc(),QueryCommand:"2417470717",Image16by16Class:Vb.getImageClass(gh.EVf),Image32by32Class:Vb.getImageClass(gh.FVf),
Visible:!0,AriaLabel:bc.a.i9h});Array.add(z.ControlList,T);return z}Btk(z,T){z.MenuItems=Object.assign(new cg.a,{Id:T?"DictationSettingsLanguageList":"DictationLanguageList",MenuSectionList:[],UpdateDynamically:!0});if(!T){var ja=this.JYh();Array.add(z.MenuItems.MenuSectionList,ja)}ja=this.qg.v6g;0<ja.length&&(ja=Ki.WEc(ja,"dictationProdcutionLanguages","",T),Array.add(z.MenuItems.MenuSectionList,ja));ja=this.qg.u5g;0<ja.length&&(T=Ki.WEc(ja,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,
T),Array.add(z.MenuItems.MenuSectionList,T));z.PopulationXML=Oj.l(z.MenuItems);this.u3e=!0}WIb(){const z=this.$vc.value;if(z){const T=this.eLc();if(E.AFrameworkApplication.Ba&&E.AFrameworkApplication.Ba.jb.Ip){const ja={};ja[T]=this.qg.xK?"ToggleButtonModel":"SplitButtonModel";this.u3e&&!this.qg.xK&&(ja["DictationLanguageList_"+T]="ToggleButtonModel");z.TIb(ja)}this.aSe();this.Bzh()}}aSe(){if(this.qg.xK){const z=this.$vc.value;E.AFrameworkApplication.Ba&&E.AFrameworkApplication.Ba.jb.Ip&&z.TIb({DictationSettingsAutoPunctuation:"CheckboxModel"})}}Bzh(){if(this.qg.xK){const z=
this.$vc.value;E.AFrameworkApplication.Ba&&E.AFrameworkApplication.Ba.jb.Ip&&z.TIb({DictationSettingsVoiceCommands:"CheckboxModel"})}}aAh(z){const T=this.$vc.value;if(T&&E.AFrameworkApplication.Ba&&E.AFrameworkApplication.Ba.jb.Ip){const ja={};ja[z]="ToggleButtonModel";T.TIb(ja)}}NBb(z,T,ja){2===ja&&(this.qg.xK?this.xHc():this.TT());return 32}hhk(z,T,ja){2===ja&&this.TT();return 32}Jgk(z,T,ja){2===ja&&this.WIb();return 32}Kgk(z,T,ja){2===ja&&(this.W0.TT(),this.WIb());return 32}Igk(z,T,ja,Ba,Ga){2===
ja&&Ga&&(z=tb.a.re(this.qg.UR),this.If.mjc(this.HO.xs(Ga),z.LCID,Ga.Lb));return 32}Hgk(z,T,ja){2===ja&&this.TT();return 32}Mgk(z,T,ja){2===ja&&this.TT();return 32}rvh(){this.$lb||(this.$lb=!0,this.H$.isVisible()?(this.xHc(),this.$lb=!1):this.showFloatie(),this.WIb())}showFloatie(){this.H$.showFloatie((new Am(this.qg.UR)).displayName).then(()=>{0===this.W0.PH()&&this.W0.jgb().then(()=>{this.$lb=!1}).catch(z=>{this.$lb=!1;e.ULS.sendTraceTag(577901849,394,10,"Failed to start dictation {0}",z)});this.qg.d3b&&
this.eY&&this.eY.Tdl();this.tqc&&this.tqc.startSession()}).catch(()=>{this.$lb=!1})}HTd(){const z=this.W0.PH();if(1===z||3===z)return 1;0===z?this.jgb():this.TT();return 32}xHc(){const z=this.W0.PH();1!==z&&(this.H$&&this.H$.hideFloatie(),this.eY&&this.eY.Mel(),0!==z&&this.TT(),this.tqc&&this.tqc.endSession(),this.WIb())}TT(){this.W0.TT();this.WIb()}jgb(){this.W0.jgb().then(()=>{}).catch(z=>{e.ULS.sendTraceTag(577901848,394,10,"Failed to start dictation {0}",z)})}Lgk(z,T,ja){return 2===ja&&this.qg&&
this.qg.KCj?this.qg.xK&&this.H$&&!this.H$.isVisible()?(this.rvh(),32):this.HTd():32}static createInstance(z,T,ja,Ba,Ga,Fb,Rb,tc){return Ki.Ka||(Ki.Ka=new Ki(E.AFrameworkApplication.Va,z,T,ja,Ba,Ga,Fb,Rb,tc))}static WEc(z,T,ja,Ba){ja=Object.assign(new Ng.a,{DisplayMode:"Menu",Title:ja,Id:T,ControlsId:"ctr"+T,ControlList:[]});for(const Ga of z){z=T+"_"+Ga.CUc;const Fb=Ga.displayName,Rb=Ga.CUc;Ba?(z=Object.assign(new zm.a,{Id:z,ExternalId:z,LabelText:Fb,Command:"3662249320",MenuItemId:Rb,Visible:!0}),
Array.add(ja.ControlList,z)):(z=Object.assign(new wh.a,{Id:z,ExternalId:z,LabelText:Fb,Command:"2863762275",MenuItemId:Rb,QueryCommand:"2739750502",Visible:!0,AriaLabel:bc.a.onb}),Array.add(ja.ControlList,z))}return ja}}Ki.Ka=null;Ki.btd="FA000000012";Ki.ctd="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";Ki.iLh="78766431-0933-4603-abf5-5bcc1dee9dda";Object(h.a)(Ki,"DictationActor",null,[677]);var vj=d(268),Hl=d(1076),Bn=d(154);class xg{constructor(z,T){this.fY=null;this.R$=!1;this.gKa=null;this.SIh=z;this.qg=
T}isVisible(){return this.R$}RQc(){return this.R$&&!!this.fY}KJi(){if(this.fY)return!0;this.fY=this.SIh.value;if(!this.fY)return!1;this.fY.rBl(dd.a.Zjd);this.fY.lBl(dd.a.CVf);Lg.a.addHandler(window.self,eb.a.resize,()=>{this.Unj()});const z=Hb.FocusManager.instance().Bc(Bn.AppFrame.t4a);z.xaa(T=>{this.zRi(T)});z.wza((T,ja)=>{this.yRi(ja)});z.HK=!0;z.REe=!0;vj.a.instance.q1(Bn.AppFrame.t4a,!0);vj.a.instance.ap(Bn.AppFrame.t4a);return!0}zRi(z){this.RQc()&&z.name!==Dd.AFrame.fO&&this.fY.focus()}yRi(z){this.RQc()&&
z.name!==Dd.AFrame.fO&&this.fY.blur()}showFloatie(z){return this.R$?Promise.resolve(null):this.KJi()?new Promise((T,ja)=>{this.fY.pAl().then(()=>{this.fY.showDictationFloatie(this.yLc(),!1,z,this.qg.useAutoPunctuation);this.gKa=z;this.R$=!0;vj.a.instance.SJ(Bn.AppFrame.t4a);T(null)}).catch(()=>{ja("failed to intialize the floatie")})}):Promise.reject("Unable to find the dictation floatie controller")}hideFloatie(){this.RQc()&&(this.fY.dismissDictationFloatie(),vj.a.instance.ap(Bn.AppFrame.t4a),this.R$=
!1)}showDictationWarning(z){this.RQc()&&this.fY.showDictationWarning(z)}onDictationLanguageChanged(z){this.gKa=z}yLc(){var z=uf.App.Fb.z4a.getBoundingClientRect();const T=z.left+z.width/2-44;z=z.top+z.height-70;return Object.assign(new Hl.a,{x:T,y:z})}Unj(){this.R$&&this.fY&&(this.fY.dismissDictationFloatie(),this.fY.showDictationFloatie(this.yLc(),!1,this.gKa,this.qg.useAutoPunctuation))}}Object(h.a)(xg,"DictationFloatieManager",null,[]);class Vm{constructor(){this.Rfa=this.yya=0;this.Qqc=null;this.T$=
!0;this.joc="";this.qg=this.Dh=null;this.zya=this.Y$=this.AKa=this.Us=this.Bj=0;this.zrd=this.ZX="";this.OPb=this.UKb=0;this.Trd=this.jsd=this.isd=!1;this.jCd="";this.wPb=this.vMb=this.Sh=this.V0=null;this.gqd=this.Otc=this.Ntc=this.MDd=this.Wwf=this.S1a=this.Q1a=0}set Rqi(z){this.ZX=z}get ewa(){return uf.App.TY?uf.App.TY.ewa:""}get RYa(){return uf.App.TY?uf.App.TY.RYa:""}set RYa(z){uf.App.TY&&(uf.App.TY.RYa=z)}onFragment(z){this.AKa||(this.AKa=(new Date).getTime());this.vMb&&(this.vMb.stop(),this.Q1a+=
this.vMb.vq,this.vMb.start());this.yya++;this.zya+=z.split(" ").length}onFinalPhrase(z){this.AKa||(this.AKa=(new Date).getTime());this.wPb&&(this.wPb.stop(),this.S1a+=this.wPb.vq,this.wPb.start());this.zya=0;this.Rfa++;this.Y$+=z.split(" ").length}onConnectionStarted(z){this.UKb=(new Date).getTime();this.Rqi=z;this.Sh&&(this.vMb=this.Sh.wi("WebServiceCall","FragmentResponse"),this.wPb=this.Sh.wi("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.OPb=(new Date).getTime()}onMicrophoneError(z){this.onCustomError("MicrophoneError",
z)}onCustomError(z,T=null){this.T$=!1;this.Qqc=z;this.setEndReason(T||z)}setEndReason(z){this.zrd=z}onTextInsertionError(){this.onCustomError("FailedToInsertText")}onTextInserted(z,T){this.gqd=T;z?(this.MDd+=T,T>this.Otc&&(this.Otc=T)):(this.Wwf=T,T>this.Ntc&&(this.Ntc=T))}onFocusLost(){this.isd=!0}onFocusLostWhileStarting(){this.jsd=!0}onFailedToStartTurn(){this.Trd=!0}onSpeechSessionStarted(z){this.jCd=z}setDictationLatency(z){this.V0=z}endActivity(){}onCommandCalled(){}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(){}setCurFinalResultAnnotationResponseTime(){}calculateMaxAndMinFinalResultUserPerceivedLatency(){}setCurPartialResultAnnotationResponseTime(){}calculateMaxAndMinPartialResultUserPerceivedLatency(){}setFirstAudioChunkStartTime(){}setMicrophoneWarmUpLatency(){}getDictationStartTime(){}}
Object(h.a)(Vm,"AbstractDictationSessionTelemetry",null,[713]);class Yi{}Yi.seen="Seen";Yi.tried="Tried";Yi.kept="Kept";Object(h.a)(Yi,"FunnelStatus",null,[]);class wl{constructor(){this.dataFields=this.name=null}}Object(h.a)(wl,"Contract",null,[]);class yi extends Vm{constructor(z,T){super();this.TXe=this.SXe=this.RVe=!1;this.Zwd=this.Uwd=this.bAd=0;this.ixd=this.hxd=2147483647;this.LDd=this.JDd=0;this.qg=z;this.Bj=(new Date).getTime();this.Sh=T;this.RYa=da.a.create().toString();this.Dh=new Ve.a;
this.Dh.dataFields=[];this.joc="Office.Voice.Online.ALDictationSession"}onFinalResultAnnotationResponse(z,T,ja){z=z+this.gqd-(this.bAd+(T+ja)/1E4);this.JDd+=z;this.Uwd<z&&(this.Uwd=z);this.hxd>z&&(this.hxd=z)}onPartialResultAnnotationResponse(z,T,ja){z=z+this.gqd-(this.bAd+(T+ja)/1E4);this.LDd+=z;this.Zwd<z&&(this.Zwd=z);this.ixd>z&&(this.ixd=z)}setRecordingStartTime(z){this.bAd=z}onCommandCalled(){this.SXe=!0}onAugloopError(z){this.T$=!1;this.RVe=!0;this.Qqc=z}onCommandError(){this.TXe=!0}endActivity(){this.Y$+=
this.zya;this.Us=(new Date).getTime();this.Dh.succeeded=this.T$;this.Dh.durationMs=this.Us-this.Bj;Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"Success",bool:this.T$}));this.T$||Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"error",string:this.Qqc}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"SessionID",string:this.ewa}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"SpeechSessionID",string:this.jCd}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,
{name:"TurnID",string:this.RYa}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"NumberOfWords",int64:0<this.zya?this.zya+this.Y$:this.Y$}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"NumberOfFragments",int64:this.yya}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"NumberOfFinalPhrases",int64:this.Rfa}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"Language",string:this.qg.UR}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"connectionID",
string:this.ZX}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"IsUsingFloatie",bool:this.qg.xK}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"UseAutoPunctuation",bool:this.qg.useAutoPunctuation}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"EndReason",string:this.zrd}));this.AKa&&Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"TimeToGetFirstResult",int64:this.AKa-
this.UKb}));this.T$&&(Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"TimeToStartRecording",int64:this.OPb-this.Bj})),Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"TimeToOpenConnection",int64:this.UKb-this.OPb})));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"FocusLost",bool:this.isd}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"FocusLostWhileStarting",bool:this.jsd}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"FailedToStartTurn",
bool:this.Trd}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"MaxTimeToInsertFragment",int64:this.Ntc}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"MaxTimeToInsertPhrase",int64:this.Otc}));var z=Yi.seen;this.T$&&0<this.Y$&&(z=0<this.Rfa?Yi.kept:Yi.tried);Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"DictationFunnel",contract:Object.assign(new wl,{name:"Office.System.Funnel",dataFields:[Object.assign(new pf.a,{name:"Name",string:"Dictation"}),Object.assign(new pf.a,
{name:"State",string:z})]})}));this.Dh.name=this.joc;this.Dh.samplingPolicy=2;Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"AugloopFailed",bool:this.RVe}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"CommandsUsed",bool:this.SXe}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"CommandsFailed",bool:this.TXe}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.Uwd}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,
{name:"MinFinalResultUserPerceivedLatency",int64:this.hxd}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"MaxPartialResultUserPerceivedLatency",int64:this.Zwd}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.ixd}));z=0<this.Rfa?this.JDd/this.Rfa:0;const T=0<this.yya?this.LDd/this.yya:0;Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"AverageFinalResultUserPerceivedLatency",double:z}));Array.add(this.Dh.dataFields,
Object.assign(new pf.a,{name:"AveragePartialResultUserPerceivedLatency",double:T}));vl.a.sendActivityEvent(this.Dh)}}Object(h.a)(yi,"AugloopDictationTelemetry",Vm,[]);var Vl=d(222);class wj{constructor(z){this.o5=z}play(){this.o5.play()}pause(){this.o5.pause()}get paused(){return this.o5.paused}get currentTime(){return this.o5.currentTime}set currentTime(z){this.o5.currentTime=z}get duration(){return this.o5.duration}get error(){const z=this.o5.error;return z?z.code:0}get readyState(){return this.o5.readyState}get src(){return this.o5.getAttribute("src")}set src(z){this.o5.setAttribute("src",
z)}get preload(){return this.o5.getAttribute("preload")}set preload(z){this.o5.setAttribute("preload",z)}get Pf(){return this.o5}}Object(h.a)(wj,"AudioElement",null,[]);class Qi{constructor(){this.Yxd=this.Xxd=this.S1a=this.Q1a=this.Vqd=0}onAudioData(){this.Vqd||(this.Vqd=(new Date).getTime())}onFragment(z){this.Q1a+=this.heg(z);this.Xxd++}$jk(z){this.S1a+=this.heg(z);this.Yxd++}U5f(){return this.Yxd?this.S1a/this.Yxd:0}xWi(){return this.Xxd?this.Q1a/this.Xxd:this.U5f()}heg(z){if(!z)return 0;const T=
(new Date).getTime();let ja=null;return({Ev:ja}=D.d(z)).returnValue?T-this.Vqd-(ja.Offset+ja.Duration)/1E4:0}}Object(h.a)(Qi,"DictationLatency",null,[]);class Il{constructor(z,T){this.A5=0;this.hCd=this.iCd=null;this.MNb=!1;this.Utc=null;this.ysc=!1;this.V0=this.uq=null;this.MF=T;this.M$=z}onFinalText(z,T){if(2===this.A5){var ja=z.size;if(1!==ja&&(e.ULS.sendTraceTag(51442337,394,10,"Final text mapping has invalid size of {0}",ja),!ja))return;T=T.get("JsonResult");this.V0&&this.V0.$jk(T);this.MF.onFinalPhrase(z.values().next().value,
T)}}onFragmentText(z,T){if(2===this.A5){var ja=z.size;if(1!==ja&&(e.ULS.sendTraceTag(51442338,394,10,"Fragment text mapping has invalid size of {0}",ja),!ja))return;T=T.get("JsonResult");if(this.V0)this.V0.onFragment(T);this.MF.onFragment(z.values().next().value)}}onError(z){if(0!==this.A5&&3!==this.A5&&"ErrorNone"!==z){this.A5=3;switch(z){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.MF.mek(z);
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.MF.fgk(z);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.MF.yQ(z);break;case "ErrorInitialSilenceTimeout":this.MF.oik(z);break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.MF.onMicrophoneError(z);break;
case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.MF.Que("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.MF.Que("NotFoundError");break;case "ErrorAudioNotReadableError":this.MF.Que("NotReadableError");break;default:this.MF.Smk(z)}this.A5=0}}onSpeechRecognitionStarted(z){window.self.document.hasFocus()?(this.A5=2,this.MNb=!1,this.MF.onRecordingStarted(),this.MF.onConnectionStarted(z),this.iCd||
(this.iCd=Object.assign(new wj(document.createElement("audio")),{src:Vl.a.box4Image(gh.Wcl)})),this.iCd.play()):(this.GRe(),this.MF.onFocusLost())}onSpeechEnd(){this.GRe();0!==this.PH()&&(this.A5=3,this.MF.Akk(),this.A5=0,this.hCd||(this.hCd=Object.assign(new wj(document.createElement("audio")),{src:Vl.a.box4Image(gh.Vcl)})),this.hCd.play())}onAudioData(z){if(this.V0)this.V0.onAudioData();if(this.M$){var T=0;for(const ja of z)T+=Math.pow(ja,2);z=Math.sqrt(T/z.length)>Il.Hcl;!this.MNb&&z?(this.MNb=
!0,this.Utc=null):this.MNb&&!z&&(this.Utc?(new Date).getTime()>=this.Utc+Il.qak&&(this.MNb=!1):this.Utc=(new Date).getTime())}}onSpeechSessionStarted(z){this.MF.onSpeechSessionStarted(z)}onEventUpdate(z){if(this.M$&&"QualityStatusUpdate"===z.eventName)switch(z.shortCode){case 13:case 2:this.M$.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);break;case 3:case 4:this.M$.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;case 8:case 6:case 7:this.M$.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}kYa(z,
T){this.MF.MOa(!1);this.MF.Yw=z;this.MF.mqg=T;this.zIk();this.uq=z;this.A5=1;this.V0=new Qi;this.uq&&this.uq.setDictationLatency(this.V0)}PH(){return this.A5}zIk(){this.ysc||(Lg.a.addHandler(window.self,eb.a.blur,Object(v.a)(this,this.AXg,"onFocusLostEventHandler")),this.ysc=!0)}GRe(){this.ysc&&(Lg.a.removeHandler(window.self,eb.a.blur,Object(v.a)(this,this.AXg,"onFocusLostEventHandler")),this.ysc=!1)}AXg(){if(1===this.A5){if(this.uq)this.uq.onFocusLostWhileStarting()}else 2===this.A5&&(this.GRe(),
this.MF.onFocusLost())}}Il.Hcl=350;Il.qak=350;Object(h.a)(Il,"FrontdoorSpeechClientObserver",null,[725]);class on extends Il{constructor(z,T){super(z,T);this.BKa=new Il(z,T)}onFinalText(z,T){this.BKa.onFinalText(z,T)}onFragmentText(z,T){this.BKa.onFragmentText(z,T)}onError(z){this.BKa.onError(z)}onSpeechRecognitionStarted(z){this.BKa.onSpeechRecognitionStarted(z)}onSpeechEnd(){this.BKa.onSpeechEnd()}onAudioData(z){this.BKa.onAudioData(z)}kYa(z,T){this.BKa.kYa(z,T)}PH(){return this.BKa.PH()}}Object(h.a)(on,
"AugloopFrontdoorSpeechObserverAbstractDecorator",Il,[]);class Wm extends on{constructor(z,T,ja){super(z,T);this.Rc=ja}onFinalText(z,T){super.onFinalText(z,T)}onFragmentText(z,T){if(this.t$d())super.onFragmentText(z,T)}onError(z){super.onError(z)}onSpeechRecognitionStarted(z=null){const T=da.a.create().toString();super.onSpeechRecognitionStarted(z?z:T)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(z){super.onAudioData(z)}kYa(z,T){super.kYa(z,T)}PH(){return super.PH()}t$d(){const z=this.Rc.Pa.kb.Wa;
return z.Lb!==z.Qa?!1:!0}}Object(h.a)(Wm,"AugloopFrontdoorSpeechObserverDecorator",on,[]);class Ik{constructor(z){this.vyf=z}onVoiceCommand(z){this.vyf.onVoiceCommand(z)}setDictationSessionTelemetry(z){this.vyf.setDictationSessionTelemetry(z)}}Object(h.a)(Ik,"AugloopVoiceCommandObserverAbstractDecorator",null,[714]);class Cn extends Ik{constructor(z,T,ja){super(z);this.S0=T;this.Rc=ja}onVoiceCommand(z){this.t$d()&&this.S0.GBl();super.onVoiceCommand(z)}setDictationSessionTelemetry(z){super.setDictationSessionTelemetry(z)}t$d(){const z=
this.Rc.Pa.kb.Wa;return z.Lb!==z.Qa?!1:!0}}Object(h.a)(Cn,"AugloopVoiceCommandObserverDecorator",Ik,[]);class Qj{constructor(z){this.qg=z}Tzg(z){const T=E.AFrameworkApplication.Be;if(T){var ja=this.qg.G4f;ja&&""!==ja&&T.Jj(String.format("https://{0}/SpeechHandler.ashx?action=SendCorrectionTelemetry",ja),2,z,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(h.a)(Qj,"FrontdoorCorrectionsTelemetryLogger",null,[715]);class Yj{constructor(){this.properties=this.useCorrections=
this.useAutoPunctuation=this.dictationLanguage=null}}Object(h.a)(Yj,"SpeechDictationSettings",null,[]);class Yk{constructor(z,T,ja,Ba){this.Uqd=this.Wx=null;this.S0=z;this.M$=T;this.MF=ja;this.Jib=Ba;this.initializeCommandsDictionary()}onVoiceCommand(z){if(this.Uqd)this.Uqd.onCommandCalled();var T=4;if(({value:T}=this.Wx.Nf(z.commandId,0)).returnValue&&4!==T){let ja=null;z.commandValue&&(ja=new m.a(r.a.rt()),ja.add("commandValue",z.commandValue));this.MF.MOa(!1);T=this.S0.executeCommand(T,ja);if(z.offset&&
z.duration)this.Jib.onCommandFinished(z.commandId,T,z.offset,z.duration)}}setDictationSessionTelemetry(z){this.Uqd=z}initializeCommandsDictionary(){this.Wx=new m.a(r.a.rt());this.Wx.add("Word.Editing.Undo",2);this.Wx.add("Word.Editing.Bold",5);this.Wx.add("Word.Editing.Italics",6);this.Wx.add("Word.Editing.Underline",10);this.Wx.add("Word.Editing.StrikeThrough",20);this.Wx.add("Word.Editing.Subscript",19);this.Wx.add("Word.Editing.Superscript",18);this.Wx.add("Word.Editing.RemoveBold",11);this.Wx.add("Word.Editing.RemoveUnderline",
13);this.Wx.add("Word.Editing.RemoveItalics",12);this.Wx.add("Word.Editing.RemoveStrikeThrough",21);this.Wx.add("Word.Editing.RemoveSubscript",22);this.Wx.add("Word.Editing.RemoveSuperscript",24);this.Wx.add("Word.Editing.Paste",7);this.Wx.add("Word.Editing.InsertTable",8);this.Wx.add("Word.Editing.InsertComment",9);this.Wx.add("Word.Editing.InsertBullet",23);this.Wx.add("Word.Editing.FullJustify",14);this.Wx.add("Word.Editing.CenterJustify",15);this.Wx.add("Word.Editing.LeftJustify",16);this.Wx.add("Word.Editing.RightJustify",
17);this.Wx.add("Command.Exit",1);this.Wx.add("Command.Pause",0);this.Wx.add("Command.ShowHelp",26);this.Wx.add("Command.ShowCommand",27);this.Wx.add("Word.Editing.RemoveFormatting",28)}}Object(h.a)(Yk,"VoiceCommandObserver",null,[714]);var Fq=d(937);class Jk{constructor(z,T,ja,Ba,Ga,Fb,Rb){this.uq=this.HRb=null;this.Nrj=0;this.Jib=Ga;this.qg=Rb;Ga=new Yj;Ga.dictationLanguage=Rb.UR;Ga.useAutoPunctuation=Rb.useAutoPunctuation?"Intelligent":"Explicit";Ga.useCorrections=Rb.d3b.toString();alVoiceClient.DictationSettingsManager.dictationSettings=
Ga;this.c6=new Wm(z,Fb,Ba);this.wyf=new Cn(new Yk(T,z,Fb,this.Jib),T,Ba);this.Joc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.uVe=Array(ja);this.Joc.setAnnotationResultCallback(Object.assign(new Fq.a,{handler:tc=>{for(const Ac of this.uVe)Ac.onAnnotationResult(tc)}}));this.OQb=new alVoiceClient.SpeechToTextClient(this.Joc,this.c6,Rb.whb||Rb.amd,!1);this.Mzf(this.OQb.getAnnotationObserver());this.GRb=new alVoiceClient.VoiceCommandingClient(this.Joc,this.wyf,this.c6);this.Mzf(this.GRb.getAnnotationObserver());
Rb.d3b&&(z=new Qj(Rb),(T=uf.App.CYa)&&T.cah(z))}nlg(z,T){return new Promise(ja=>{const Ba=new Yj;Ba.dictationLanguage=z;Ba.useAutoPunctuation=this.qg.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings=Ba;this.uq=T;ja(this.Zuj())})}jgb(z){if(!this.OQb)return 3;this.HRb.startVoiceSessionFromMicrophoneInput();this.c6.kYa(this.uq,z);z=this.qg.pJb;this.OQb.initializeAsync(z?[1]:[1,0],this.uq);z&&this.zel();return 0}TT(z){if(z&&this.c6)this.c6.onSpeechEnd();
this.OQb&&this.OQb.uninitializeAsync();this.HRb&&(this.HRb.stopVoiceSession(),this.HRb=null);this.uq=null;this.qg.pJb&&this.Zel()}PH(){return this.c6.PH()}Zuj(){this.qg.pJb&&this.wyf.setDictationSessionTelemetry(this.uq);this.HRb=new alVoiceClient.VoiceSession(this.Joc,this.c6,this.qg.whb,this.Jib,this.uq);return 0}zel(){this.GRb&&this.GRb.initializeAsync(this.uq)}Zel(){this.GRb&&this.GRb.uninitializeAsync()}Mzf(z){this.uVe[this.Nrj++]=z}}Object(h.a)(Jk,"AugloopSpeechClientProxy",null,[698]);class Tn extends Vm{constructor(z,
T){super();this.qg=z;this.Bj=(new Date).getTime();this.Sh=T;this.RYa=da.a.create().toString();this.Dh=new Ve.a;this.Dh.dataFields=[];this.joc="Office.Voice.Online.DictationSession"}endActivity(){this.Y$+=this.zya;this.Us=(new Date).getTime();this.Dh.succeeded=this.T$;this.Dh.durationMs=this.Us-this.Bj;Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"Success",bool:this.T$}));this.T$||Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"error",string:this.Qqc}));Array.add(this.Dh.dataFields,
Object.assign(new pf.a,{name:"SessionID",string:this.ewa}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"SpeechSessionID",string:this.jCd}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"TurnID",string:this.RYa}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"NumberOfWords",int64:0<this.zya?this.zya+this.Y$:this.Y$}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"NumberOfFragments",int64:this.yya}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,
{name:"NumberOfFinalPhrases",int64:this.Rfa}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"Language",string:this.qg.UR}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"connectionID",string:this.ZX}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"IsUsingFloatie",bool:this.qg.xK}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"UseAutoPunctuation",bool:this.qg.useAutoPunctuation}));
Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"EndReason",string:this.zrd}));this.AKa&&Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"TimeToGetFirstResult",int64:this.AKa-this.UKb}));this.T$&&(Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"TimeToStartRecording",int64:this.OPb-this.Bj})),Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"TimeToOpenConnection",int64:this.UKb-this.OPb})));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"FocusLost",
bool:this.isd}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"FocusLostWhileStarting",bool:this.jsd}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"FailedToStartTurn",bool:this.Trd}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"AverageFragmentLatency",double:this.V0?this.V0.xWi():0<this.yya?this.Q1a/this.yya:0}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"AveragePhraseLatency",double:this.V0?this.V0.U5f():0<this.Rfa?this.S1a/this.Rfa:0}));
Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"AveragePhraseInsertionLatency",double:0<this.Rfa?this.MDd/this.Rfa:0}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"AverageFragmentInsertionLatency",double:0<this.yya?this.Wwf/this.yya:0}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"MaxTimeToInsertFragment",int64:this.Ntc}));Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"MaxTimeToInsertPhrase",int64:this.Otc}));let z=Yi.seen;this.T$&&0<this.Y$&&(z=
0<this.Rfa?Yi.kept:Yi.tried);Array.add(this.Dh.dataFields,Object.assign(new pf.a,{name:"DictationFunnel",contract:Object.assign(new wl,{name:"Office.System.Funnel",dataFields:[Object.assign(new pf.a,{name:"Name",string:"Dictation"}),Object.assign(new pf.a,{name:"State",string:z})]})}));this.Dh.name=this.joc;this.Dh.samplingPolicy=2;vl.a.sendActivityEvent(this.Dh)}}Object(h.a)(Tn,"DictationSessionTelemetry",Vm,[]);var bp=d(1108);class qi{constructor(z,T){this.ouc=z;this.lMh=T}getAccessToken(z){this.lMh&&
this.ouc?this.ouc.p0("OfficeDictation",E.AFrameworkApplication.fa.Ia("DictationResourceID")).then(T=>{T.IsSuccess?z(T.Token):z(qi.gSd)}).catch(()=>{z(qi.gSd)}):z(qi.gSd)}}qi.gSd="dictation access token";Object(h.a)(qi,"AuthenticationProvider",null,[]);class ge{constructor(z){this.sMh=z;this.Rxc=new xh.a}debugAssertTag(z,T,ja,Ba){this.Tmd(Ba);this.Rxc.debugAssertTag(z,T,ja,Ba)}debugTraceTag(z,T,ja,Ba){this.Tmd(Ba);this.Rxc.debugTraceTag(z,T,ja,Ba)}sendTraceTag(z,T,ja,Ba){this.Tmd(Ba);this.Rxc.sendTraceTag(z,
T,ja,Ba)}shipAssertTag(z,T,ja,Ba){this.Tmd(Ba);this.Rxc.shipAssertTag(z,T,ja,Ba)}Tmd(z){if(this.sMh){const T=window.console;T&&T.log(String.format("FDSpeechService: {0}",z))}}}Object(h.a)(ge,"FrontdoorExternalLogger",null,[257]);class ri{constructor(){this.accessToken=null}}Object(h.a)(ri,"IAuthenticationProvider",null,[]);class ic{constructor(){this.customEndpointConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=
0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(h.a)(ic,"ISpeechConfig",null,[]);class ng{constructor(z,T,ja,Ba,Ga){this.uq=this.Glb=null;this.wCd=!1;this.c6=new Il(ja,Ba);this.pU=z;this.qg=T;this.qGh=new qi(Ga,T.JCj);this.qg.d3b&&(z=new Qj(T),(T=uf.App.CYa)&&T.cah(z))}nlg(z,T){return new Promise(ja=>{this.qGh.getAccessToken(Ba=>{ja(this.Buj(z,T,Ba))})})}Buj(z,T,ja){this.uq=T;z=this.rOd(z);ja=Object.assign(new ri,
{accessToken:ja});T=new ge(this.qg.yRc);this.Glb=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(z,this.c6,ja,null,T);return this.Glb?0:(e.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}jgb(z){if(!this.Glb)return 3;this.c6.kYa(this.uq,z);this.Glb.startSpeechRecognition();return 0}TT(z){if(!this.wCd){this.wCd=!0;if(this.Glb)try{this.Glb.stopSpeechRecognition()}catch(T){e.ULS.shipAssertTag(593277727,394,!1,T.message)}if(z&&this.c6)this.c6.onSpeechEnd();
this.uq=null;this.wCd=!1}}PH(){return this.c6.PH()}rOd(z){const T=new ic;T.speechMode="Dictation";T.sourceLanguage=z;(z=this.qg.G4f)&&""!==z&&(T.speechFDBase=String.format("wss://{0}/",z));T.properties=new Map;this.pU&&(T.properties.set("DictationInsertionPointLeft",this.pU.Sdg()),T.properties.set("DictationInsertionPointRight",this.pU.ddj()));T.properties.set("Corrections","true");T.properties.set("punctuation",this.qg&&this.qg.useAutoPunctuation?"Intelligent":"Explicit");this.qg.yRc&&T.properties.set("EnableAudioLogging",
this.qg.yRc.toString());switch(bp.a.zHd){case "Word":T.clientApp=1;break;case "PowerPoint":T.clientApp=0;break;case "OneNote":T.clientApp=2}return T}}Object(h.a)(ng,"FrontdoorSpeechClientProxy",null,[698]);class vd{static U8k(){vd.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage)}static s9k(){vd.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage)}static F$k(z){vd.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,
z)}static Oal(){vd.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}static showDialog(z,T){vd.wf||(vd.wf=new Jc.StandardDialog,vd.wf.Zq=E.AFrameworkApplication.Sba,vd.wf.vd=0,vd.wf.Pe(1,CommonUIStrings.l_DialogClose),vd.wf.nO(z,T,()=>{vd.wf=null}))}}vd.wf=null;Object(h.a)(vd,"Dialogs",null,[]);class Xm{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc){this.Akb=this.emb=!1;this.Yw=null;this.pU=z;this.mqg=T;this.Da=ja;this.WJa=Ba;this.qg=Ga;this.S0=Fb;
this.RKb=Rb;this.M$=tc;this.eqf=new N.a;for(z=0;z<Xm.dqf.length;z++)this.eqf.add(Xm.dqf.charAt(z).toString())}onFinalPhrase(z,T=null){let ja=!0;if(this.Yw)this.Yw.onFinalPhrase(z);if(this.RKb&&this.S0){var Ba=this.RKb.JAl(z);if(Ba){this.MOa(!1);this.S0.executeCommand(Ba.commandId,null);return}}Ba=(new Date).getTime();if(1===z.length&&"\n"===z)this.x2d("",null),this.I_f();else{let Ga=z.indexOf("\n");for(0<Ga&&Ga!==z.length-1&&(ja=!1);0<=Ga;)this.x2d(z.substr(0,Ga),ja?T:null),this.I_f(),z=z.substr(Ga+
1),Ga=z.indexOf("\n"),ja=!1;this.x2d(z,ja?T:null)}z=(new Date).getTime();if(this.Yw)this.Yw.onTextInserted(!0,z-Ba)}onFragment(z){if(this.emb)var T=this.tNc(z);else{if(!this.Whd())return;T=this.Akb?this.tNc(z):z}if(this.Yw)this.Yw.onFragment(z);z=!0;const ja=(new Date).getTime();this.pU&&!this.pU.s7h(T)&&(this.qgg(),z=!1);T=(new Date).getTime();if(this.Yw)this.Yw.onTextInserted(!1,T-ja);z&&this.S0&&this.S0.DAl()}onRecordingStarted(){this.Da.processAction(dd.a.JVf,2);if(this.Yw)this.Yw.onRecordingStarted()}onMicrophoneError(z=
""){this.Hgg(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,z)}NBb(z){if(this.Yw)this.Yw.onCustomError(z);this.Da.Ma(dd.a.BVf,2,z)}mek(z){this.NBb(z);vd.U8k()}fgk(z){this.NBb(z);vd.s9k()}Smk(z){this.NBb(z);vd.Oal()}yQ(z){this.Yw&&this.Yw.setEndReason(z);this.Da.Ma(dd.a.IVf,2,z)}oik(z){this.yQ(z);this.sal()}Akk(){this.MOa(!1);this.Da.processAction(dd.a.KVf,2)}onConnectionStarted(z){if(this.Yw)this.Yw.onConnectionStarted(z)}Que(z){this.Hgg(this.i5i(z),z)}onFocusLost(){if(this.Yw)this.Yw.onFocusLost();
this.Da.processAction(dd.a.DVf,2)}ELj(z){return this.mqg&&!Ub.a.wae(z)&&!this.eqf.contains(z.toString())}tNc(z){return 0<z.length&&this.ELj(z.charAt(0))?" "+z:z}Whd(){if(this.emb)return!0;if(this.pU){const z=this.pU.Sdg();this.Akb=!1;z&&0<z.length&&(this.Akb=!Ub.a.wae(z.charAt(z.length-1))&&!z.endsWith("\u201c"));return this.emb=this.pU.Whd()}if(this.Yw)this.Yw.onFailedToStartTurn();this.S0&&this.S0.FAl();return!1}MOa(z){this.Akb=this.emb=!1;this.pU&&(z&&this.pU.Rak(),this.pU.MOa())}onSpeechSessionStarted(z){if(this.Yw)this.Yw.onSpeechSessionStarted(z);
this.qg.yRc&&this.NKe(z)}Hgg(z,T=""){if(this.Yw)this.Yw.onMicrophoneError(T);this.Da.processAction(dd.a.GVf,2);vd.F$k(z)}i5i(z){z=z.trimStart();return z.startsWith("NotAllowedError")||z.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:z.startsWith("NotFoundError")||z.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:z.startsWith("NotReadableError")||z.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:
Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}sal(){this.WJa&&this.WJa.execute(z=>{z.G9k()})}NKe(z){this.WJa&&this.WJa.execute(T=>{T.NKe(String.format("ServiceSessionID:{0} ClientSessionId: {1}",z,this.bmi))})}x2d(z,T){if(this.emb||this.Whd()){if(this.pU){const ja=this.Akb?this.tNc(z):z;(this.qg.d3b&&Object(Gf.a)(697,this.pU)?this.pU.rAl(ja,T,0<z.length&&z.charAt(0)!==ja.charAt(0)):this.pU.jxj(this.Akb?this.tNc(z):z))||this.qgg()}this.MOa(!0)}}qgg(){if(this.Yw)this.Yw.onTextInsertionError();
this.Da.processAction(dd.a.MVf,2)}I_f(){this.Da.processAction(dd.a.WA,2)}get bmi(){return uf.App.TY?uf.App.TY.ewa:""}}Xm.dqf='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d';Object(h.a)(Xm,"SpeechClientObserverController",null,[]);class qe{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd){this.RKb=this.S0=this.M$=this.uq=this.iMa=null;this.gx=z;this.TIh=T;this.Rc=ja;this.WJa=Ba;this.Sh=Ga;this.qg=Fb;this.ouc=nd;this.Mtf=Bd;this.qg.xK&&(this.M$=Rb);if(this.qg.Drg||this.qg.whb)this.S0=
tc;this.qg.Drg&&(this.RKb=Ac);this.Jib=kd}jgb(){this.WJa&&this.WJa.execute(z=>{z.Wpj()});return new Promise((z,T)=>{this.iMa?this.T_f(z,T):this.aSj().then(()=>{var ja=this.TIh.value;ja?(ja=ja.hvi(),this.iMa=this.qzi(ja),this.T_f(z,T)):T(4)}).catch(()=>{T(2)})})}T_f(z,T){this.kYa().then(ja=>{0===ja?z(0):T(ja)}).catch(ja=>{T(ja)})}kYa(){return new Promise((z,T)=>{this.uq=new Tn(this.qg,this.Sh);if(this.qg.amd||this.qg.whb)this.uq=new yi(this.qg,this.Sh);this.iMa.nlg(this.qg.UR,this.uq).then(ja=>{0!==
ja?z(ja):z(this.iMa.jgb(this.wxg()))}).catch(ja=>{T(ja)})})}aSj(){return this.qg.amd||this.qg.whb?this.uzg("alVoiceClient",!0):this.uzg("PPTSpeechClient")}uzg(z,T=!1){return!T&&this.Mtf&&E.AFrameworkApplication.Ba.jb.dsg?(T=E.AFrameworkApplication.Rj(z,2),Vj.a(this.Mtf.Tvb(T))):this.gx?this.gx.loadScript(z):new Promise((ja,Ba)=>{Ba("Unable to load speech client "+z)})}TT(z=!0){0!==this.PH()&&(this.iMa&&this.iMa.TT(z),this.uq&&(this.uq.endActivity(),this.uq=null))}PH(){return this.iMa?this.iMa.PH():
0}wxg(){return"zh-CN"!==this.qg.UR&&"ja-JP"!==this.qg.UR}qzi(z){const T=new Xm(z,this.wxg(),E.AFrameworkApplication.Va,this.WJa,this.qg,this.S0,this.RKb,this.M$);return this.qg.amd||this.qg.whb?new Jk(this.M$,this.S0,2,this.Rc,this.Jib,T,this.qg):new ng(z,this.qg,this.M$,T,this.ouc)}}Object(h.a)(qe,"DictationManager",null,[]);class xl{constructor(){this.sgf=[];this.RYa=this.xBd=""}startSession(){this.xBd=da.a.create().toString();this.sgf=[]}endSession(){this.xBd=""}get ewa(){return this.xBd}get o3g(){return this.sgf}}
Object(h.a)(xl,"DictationSessionInfo",null,[660]);class Zk{constructor(z,T,ja){this.mEd=this.CRb=this.jEd=this.BRb=!1;this.gKa="";this.mb=z?z:E.AFrameworkApplication.fa;this.l0a=T;this.Rc=ja}get useAutoPunctuation(){if(!this.xK||!this.n7d)return!1;if(this.jEd)return this.BRb;const z=Ka.a.instance.getItem("WACDictationFUseAutoPunctuation");this.BRb=void 0===z||null===z?this.mb.ka("DictationAutoPunctuationEnglishDefaultOnIsEnabled")?Array.contains(gh.q$h,this.UR):!1:Boolean.parse(z);this.jEd=!0;return this.BRb}set useAutoPunctuation(z){this.xK&&
this.n7d&&(this.BRb=z,this.jEd=!0,Ka.a.instance.setItem("WACDictationFUseAutoPunctuation",this.BRb.toString()))}get pJb(){if(!this.xK||!this.uae)return!1;if(this.mEd)return this.CRb;const z=Ka.a.instance.getItem("WACDictationFloatieUseVoiceCommands");this.CRb=void 0===z||null===z?!0:Boolean.parse(z);this.mEd=!0;return this.CRb}set pJb(z){this.xK&&this.uae&&(this.CRb=z,this.mEd=!0,Ka.a.instance.setItem("WACDictationFloatieUseVoiceCommands",this.CRb.toString()))}get n7d(){return Array.contains(gh.r$h,
this.UR)}get uae(){return this.whb&&Array.contains(gh.mxl,this.UR)}get UR(){""===this.gKa&&(this.gKa=this.f_i());return this.gKa}set UR(z){z&&(this.gKa=z)}get d3b(){return this.xK}get xK(){return this.mb.ka("WacBox4DictationFloatieIsEnabled")}get Oul(){return this.mb.ka("WacBox4DictationInternalArticle")}get G4f(){return this.mb.Ia("DictationFrontdoorDomain")}get amd(){return this.mb.ka("WacBox4DictationUseAugloopService")}get Drg(){return this.mb.ka("WacBox4DictationCommandsIsEnabled")&&this.xK}get whb(){return this.mb.ka("WacBox4DictationUseAugloopServiceWithFrontdoor")}get JCj(){return this.mb.ka("WacDictationAuthenticationEnabled")}get yRc(){return this.mb.ka("DictationDebugModeEnabled")}get v6g(){return this.getSupportedLanguages(0)}get u5g(){return this.getSupportedLanguages(1)}get KCj(){return P.a.Hsh&&
this.mb.ka("UserCanUseDictation")}getSupportedLanguages(z){const T=[];z=0===z?gh.productionLanguages:gh.previewLanguages;for(const ja of z)Array.add(T,new Am(ja));T.sort((ja,Ba)=>ja.displayName.localeCompare(Ba.displayName));return T}f_i(){if(this.l0a&&this.Rc){const z=this.l0a.WLc(this.Rc.Dj);for(const T of this.v6g)if(T.LCID===z)return T.CUc;for(const T of this.u5g)if(T.LCID===z)return T.CUc}return gh.VBi}}Object(h.a)(Zk,"DictationSettings",null,[]);class gf{constructor(){this.e_e=this.Ea=null}get name(){return"Box4.Dictation"}Yb(z){this.Ea=
z;const T=C.a.instance.qb("Common.IDynamicScriptLoaderProvider");let ja=null;T&&(ja=T.gx);const Ba=C.a.instance.qe("Box4.Dictation.IDictationHostFactory");this.Ea.register(Zk,"Box4.Dictation.DictationSettings").ma().na(()=>new Zk(this.Ea.resolve("Common.IAppSettingsManager"),this.Ea.resolve("Box4.ILanguageReader"),this.Ea.resolve("Box4.ISelectionManager")));const Ga=C.a.instance.qe("Common.IDictationFloatieController");this.Ea.register(xg,"Box4.Dictation.DictationFloatieManager").ma().na(()=>new xg(Ga,
this.Ea.resolve("Box4.Dictation.DictationSettings")));this.Ea.register(qe,"Box4.Dictation.DictationManager").ma().na(()=>new qe(ja,Ba,this.Ea.resolve("Box4.ISelectionManager"),z.Oa("Box4.IBusinessBarController"),z.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Ea.resolve("Box4.Dictation.DictationSettings"),this.Ea.resolve("Box4.Dictation.DictationFloatieManager"),this.Ea.qb("Box4.DictationCommands.IDictationCommandManager"),this.Ea.qb("Box4.DictationCommands.IDictationCommandParser"),
this.Ea.qb("Box4.DictationCommands.IDictationCommandsTelemetry"),this.Ea.resolve("Common.App.OAuth.IOAuthManager"),this.Ea.resolve("Common.ISharedDependencyLoader")));this.Ea.register(660,"Box4.Dictation.IDictationSessionInfo").ma().na(()=>new xl)}init(){this.Ea.resolve("Box4.Dictation.IDictationSessionInfo");this.e_e=Ki.createInstance(this.Ea.qe("Common.IRibbonButtonUpdater"),this.Ea.resolve("Box4.Dictation.DictationManager"),this.Ea.resolve("Box4.IFormattingEditor"),this.Ea.resolve("Box4.IFormattingReader"),
this.Ea.resolve("Box4.Dictation.DictationFloatieManager"),this.Ea.resolve("Box4.Dictation.DictationSettings"),this.Ea.qe("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Hb.FocusManager.instance());this.e_e.wb();uf.App.Fb.updateCommandUI()}dispose(){}}Object(h.a)(gf,"DictationPackageManager",null,[2,3]);class wk{constructor(z,T,ja){this.AW=null;this.bF=this.hW=-1;this.nxb=!1;this.cW=z;this.sa=T;this.ia=ja}Sdg(){return this.Vdg(!1)}ddj(){return this.Vdg(!0)}Whd(){this.AW&&this.MOa();const z=
this.sa.Pa.kb;if(z){const T=z.Wa;if(T&&ad.ParagraphReader.Pd(T.node))return this.AW=T.node,this.bF=z.Wa.q2a,this.hW=z.Wa.bSb,this.nxb=!0}return!1}MOa(){this.AW=null;this.nxb=!1;this.hW=this.bF=-1}s7h(z){if(this.AW){const T=new zh.GraphTransaction(15);try{T.hd(this.AW);const ja=this.nxb&&this.bF!==this.hW?Lc.a.createTextRange(this.AW,this.bF,this.hW):Lc.a.Wj(this.AW,this.hW);this.cW.replaceTextRange(ja,z);this.hW=this.nxb?this.bF+z.length:this.hW+z.length;const Ba=Dl.SelectionFactory.Lg(this.AW,this.hW);
this.sa.setSelection(Ba);this.nxb=!1;return!0}finally{T&&T.dispose()}}return!1}jxj(z){if(this.AW){const T=new zh.GraphTransaction(15);try{T.hd(this.AW);const ja=this.bF!==this.hW?Lc.a.createTextRange(this.AW,this.bF,this.hW):Lc.a.Wj(this.AW,this.hW);this.cW.replaceTextRange(ja,z);this.hW=this.bF+z.length;const Ba=Dl.SelectionFactory.Lg(this.AW,this.hW);this.sa.setSelection(Ba);this.nxb=!1;return!0}finally{T&&T.dispose()}}return!1}Rak(){var z=this.J_i();this.ia&&z&&z.q2a!==z.bSb&&0<=z.q2a&&(z=Lc.a.createTextRange(z.node,
z.q2a,z.bSb),this.ia.Ma(dd.a.HVf,2,z))}J_i(){return this.AW?this.bF!==this.hW?Lc.a.createTextRange(this.AW,this.bF,this.hW):Lc.a.Wj(this.AW,this.hW):null}Vdg(z){var T=this.sa.Pa.kb;if(T){var ja=T.Wa;if(ja&&(T=ja.node,ad.ParagraphReader.Pd(T)&&(ja=z?ja.bSb:ja.q2a,T=ad.ParagraphReader.text(T),ja<=T.length)))return z?T.substring(ja,T.length):T.substring(0,ja)}return""}}Object(h.a)(wk,"DictationHost",null,[676]);class Zj{constructor(z,T,ja){this.cW=z;this.sa=T;this.ia=ja}hvi(){return new wk(this.cW,this.sa,
this.ia)}}Object(h.a)(Zj,"DictationHostFactory",null,[659]);class Ym{get name(){return"PowerPointWebEditor.Dictation"}Yb(z){z.register(Zj,"PowerPointWebEditor.Dictation.DictationHostFactory").as("Box4.Dictation.IDictationHostFactory").ma().na(()=>new Zj(z.resolve("Box4.ICharacterPropertiesEditor"),z.resolve("Box4.ISelectionManager"),E.AFrameworkApplication.Va))}init(){}dispose(){}static main(){Ya.a.instance.Ec(new Ym)}}Object(h.a)(Ym,"PPTWebEditorDictationPackage",null,[2,3]);var pn=d(449);class qn{constructor(z,
T,ja=null){this.id=z.Id;ja||(ja="");this.BFk=ja;this.sensitivityLabel=z}}Object(h.a)(qn,"AutoPolicyLabelData",null,[]);class Un{constructor(z,T){this.zaa=z;this.displayName=T}}Object(h.a)(Un,"PolicyLabelRequestState",null,[]);class rn{static get Fae(){return rn.LOj}}rn.LOj="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(h.a)(rn,"JustificationDialogHtml",null,[]);class Ri extends Xb.a{constructor(z,T){super(!1,!1,Ri.y0);this.YKa=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.Cvc=null;this.Bvc=!1;this.qwc=z;this.BC=T;this.Wf=this.pci();this.vd=1;this.kg=Ri.id;this.Pe(1,CommonUIStrings.l_DialogChange);this.rC(1,!1);this.hwa(0)}mLe(){if(Ri.y0)this.qj(CommonUIStrings.l_SensitivityJustificationTitle,
Object(v.a)(this,this.C9g,"reactJustificationDialogHandler"),this.Ibg(this.Bvc));else{const z={};for(let T=0;T<this.YKa.length;T++)z[Ri.rBe+T]=!1;z[Ri.Olc]="";this.qj(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.KOj,"justificationDialogHandler"),z);this.DCe();Lg.a.addHandler($get(Ri.Olc),eb.a.input,Object(v.a)(this,this.zil,"textAreaHandler"))}}validate(){if(Ri.y0)return this.gCh(this.Cvc);const z=$get(Ri.Olc);return z.disabled?!0:this.gCh(z.value)}gCh(z){const T=2>z.length,
ja=500<z.length,Ba=RegExp("[{|}|;|\\\\]").test(z);z=""===Ub.a.UCe(z);return!T&&!ja&&!Ba&&!z}KOj(z,T){let ja="";if(1===z)for(let Ba=0;Ba<this.YKa.length;Ba++)if(T[Ri.rBe+Ba]){ja=Ba===this.YKa.length-1?T[Ri.Olc]:this.YKa[Ba];break}this.BC(z,this.qwc,ja)}C9g(z){let T="";1===z&&this.Cvc&&(T=this.Cvc);this.BC(z,this.qwc,T)}Dik(z){this.Cvc=z;z=this.validate();this.Bvc!==z&&(this.Bvc=z,this.VQ(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.C9g,"reactJustificationDialogHandler"),this.Ibg(this.Bvc)))}Ibg(z){return{["id"]:this.kg,
["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!z},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,
["onJustificationUpdated"]:Object(v.a)(this,this.Dik,"onJustificationUpdated")}}zil(z){z.target&&this.rC(1,this.validate())}pci(){return Xb.a.tA(Ri.Fae,E.AFrameworkApplication.Rl,Vb.getImageClass(Ri.uCa),CommonUIStrings.l_SensitivityJustificationMessage,this.YKa[0],this.YKa[1],this.YKa[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}DCe(){const z=document.getElementsByName(Ri.$Qj);for(let T=0;T<z.length;T++)Lg.a.addHandler(z[T],eb.a.focus,Object(v.a)(this,this.hbd,"radioButtonFocusHandler")),
Lg.a.addHandler(z[T],eb.a.click,Object(v.a)(this,this.hbd,"radioButtonFocusHandler"))}hbd(z){if(z=z.target){z.checked=!0;var T=$get(Ri.Olc);z.id===Ri.rBe+(this.YKa.length-1)?(T.disabled=!1,Sys.UI.DomElement.setVisible(T,!0),T.focus()):(T.disabled=!0,z.focus());this.rC(1,this.validate())}}static get y0(){return E.AFrameworkApplication.Ba.jb.QB&&E.AFrameworkApplication.Ba.jb.a$d}}Ri.Fae=rn.Fae;Ri.$Qj="ListRadioBox";Ri.rBe="radiobox";Ri.Olc="txtJustification";Ri.uCa="Info_32x32x32";Ri.id="JustificationDialog";
Object(h.a)(Ri,"JustificationDialog",Xb.a,[]);class cp extends Xb.a{constructor(z,T,ja){super(!1,!1,!0);if(z&&ja){var Ba={["id"]:"MandatoryLabellingDialog"};this.PIh=ja;this.qwd=T;if(!E.AFrameworkApplication.fa.ka("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.qwd&&""!==this.qwd)Ba.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.qwd,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};
T={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(T.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:z});Ba.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:T};z={["id"]:"MandatoryLabellingDialog",["bodyControls"]:Ba};Ba.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;Ba.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;
this.qj(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(v.a)(this,this.X8j,"mandatoryLabellingDialogHandler"),z)}else e.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}X8j(z,T){1===z&&T.selectedLabel&&(z=T.selectedLabel,""!==z&&this.PIh(z))}}Object(h.a)(cp,"MandatoryLabellingDialog",Xb.a,[]);class Jl{constructor(){this.doa=!!E.AFrameworkApplication.Ba&&E.AFrameworkApplication.Ba.jb.QB}Qwi(z,T,ja){this.doa&&new cp(z,T,ja)}static get instance(){return Jl.Ka||
(Jl.Ka=new Jl)}}Jl.Ka=null;Object(h.a)(Jl,"MandatoryLabellingDialogFactory",null,[699]);class Je{}Je.Fel="sbProtectForm14";Je.Iel="SBStatusBarMarkAsReadOnly14";Je.lQj="Info_16x16x32";Je.MLf="QuickSearchCompletedToday_16x16x32";Je.OBe="CommonControlCheckboxCheck_16";Je.pvh="On";Je.visible="Visible";Je.PRi="ImageIsVisible";Je.OT="SourceControlId";Je.menuItemId="MenuItemId";Je.menu="Menu";Je.RDf="AppLockId";Je.value="Value";Je.labelText="LabelText";Je.alt="Alt";Je.ckg="Image16by16";Je.ntb="Image16by16Class";
Je.Eel="SBProtectForm_16";Je.Hel="SBStatusBarMarkAsReadOnly_16";Je.icon="Icon";Je.iconColor="IconColor";Je.customTooltip="CustomTooltip";Je.aFk="MipTagDynamicFillWithOutline_20";Je.bFk="MipTagLockDynamicFillWithOutline_20";Je.$Ek="MipTagErrorOutline_20";Je.cFk="MipTagQuestionOutline_20";Je.cQe="transparent";Object(h.a)(Je,"PolicyConstants",null,[]);class Zm extends Xb.a{constructor(z,T,ja){super(!1,!1,Zm.y0);this.qwc=z;this.g1=T;this.BC=ja;this.vd=1;this.kg=Zm.id;this.hwa(1);this.hwa(0)}OLe(){const z=
{["id"]:"UserDefinedPermissionsDialog"};Zm.y0&&this.qj("Defined Permissions",Object(v.a)(this,this.pvl,"userDefinedPermissionsDialogHandler"),z)}pvl(z){1!==z&&this.BC(z,this.qwc,"",this.g1)}static get y0(){return E.AFrameworkApplication.Ba.jb.QB&&E.AFrameworkApplication.Ba.jb.a$d}}Zm.id="UserDefinedPermissionsDialog";Object(h.a)(Zm,"UserDefinedPermissionsDialog",Xb.a,[]);var Ap=d(573),to=d(247),Vn=d(465);class zi{constructor(z,T,ja,Ba){this.Nvd=this.Ovd=null;this.Q7e=this.avd=this.Bvd=this.FNb=this.Waf=
this.Lcf=this.xqd=!1;this.Sib=this.Txa=this.Nya=this.RJa=this.g1=this.IC=this.toa=this.Jk=null;this.Dod=0;this.Xrd=this.jaf=this.jWe=null;this.Da=z;this.Mh=T;this.mb=ja;this.Tj=Ba;this.BOb={};this.xif={};this.Ncf={};this.Q2b=ja.ka("WacApplyManualPolicyLabelIsEnabled");this.Tj.value.BGd(Object(v.a)(this,this.pze,"processAutoSensitivityLabel"));this.Tj.value.ACf(Object(v.a)(this,this.pze,"processAutoSensitivityLabel"));this.Tj.value.jGd(Object(v.a)(this,this.Umk,"onUpdateLabelInfo"));E.AFrameworkApplication.Ba&&
E.AFrameworkApplication.Ba.aP(Object(v.a)(this,this.oHk,"refreshDocumentPolicyLabelsOnModeChange"));ja.ka("SupportsPolicies")&&ja.Ia("AppliedPolicyId")&&(this.Ovd=ja.Ia("IrmPolicyTitle"),this.Nvd=ja.Ia("IrmPolicyDescription"));this.Hzd=ja.ka("ProtectedFile");this.tGh=this.mb.Gc("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.uGh=this.mb.Gc("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get jsa(){return E.AFrameworkApplication.jsa||!!this.jaf&&this.jaf()}wb(){this.Da.ya(oa.a.x0g,ec.a.frame,
Object(v.a)(this,this.VWf,"documentLabelPaneHandler"));this.Da.ra(oa.a.Ufc,ec.a.frame,Object(v.a)(this,this.Ufc,"queryPolicyLabel"),96);this.Da.ya(oa.a.$gb,ec.a.frame,Object(v.a)(this,this.$gb,"toggleSensitivity"));this.Da.ya(oa.a.qdb,ec.a.frame,Object(v.a)(this,this.qdb,"populateSensitivityFlyout"));this.Da.ya(oa.a.rfb,ec.a.frame,Object(v.a)(this,this.rfb,"setSensitivity"));this.Da.ra(oa.a.qgc,ec.a.frame,Object(v.a)(this,this.qgc,"querySensitivity"),96);this.Da.ya(oa.a.Ndb,ec.a.frame,Object(v.a)(this,
this.Ndb,"querySensitivityToggleButton"));this.Da.ya(oa.a.Mdb,ec.a.frame,Object(v.a)(this,this.Mdb,"querySensitivitySubFlyout"));this.YRb(oa.a.$gb)||this.Da.$d(oa.a.$gb,4);this.YRb(oa.a.qdb)||this.Da.$d(oa.a.qdb,4);this.YRb(oa.a.rfb)||this.Da.$d(oa.a.rfb,4);this.YRb(oa.a.Ndb)||this.Da.$d(oa.a.Ndb,4);this.YRb(oa.a.Mdb)||this.Da.$d(oa.a.Mdb,4);this.Mh.updateCommandUI();E.AFrameworkApplication.fa&&E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",
!1)&&be.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.Tj.value.GMk(Object(v.a)(this,this.S$g,"registerActionsHandler"))}S$g(){this.wb()}Jyh(){this.Da.gO(oa.a.x0g,ec.a.frame,Object(v.a)(this,this.VWf,"documentLabelPaneHandler"));this.Da.gO(oa.a.Ufc,ec.a.frame,Object(v.a)(this,this.Ufc,"queryPolicyLabel"));this.Da.gO(oa.a.$gb,ec.a.frame,Object(v.a)(this,this.$gb,"toggleSensitivity"));this.Da.gO(oa.a.qdb,ec.a.frame,Object(v.a)(this,
this.qdb,"populateSensitivityFlyout"));this.Da.gO(oa.a.rfb,ec.a.frame,Object(v.a)(this,this.rfb,"setSensitivity"));this.Da.gO(oa.a.qgc,ec.a.frame,Object(v.a)(this,this.qgc,"querySensitivity"));this.Da.gO(oa.a.Ndb,ec.a.frame,Object(v.a)(this,this.Ndb,"querySensitivityToggleButton"));this.Da.gO(oa.a.Mdb,ec.a.frame,Object(v.a)(this,this.Mdb,"querySensitivitySubFlyout"))}$gb(){return 32}L5f(z){const T="mandatoryLabelling_"+z.Id;this.Ncf[T]=z.Id;return{["type"]:"AppToggleButtonProps",["id"]:T,["label"]:z.DisplayName,
["hideLabel"]:!1,["customTooltip"]:z.Tooltip}}Q8a(){return this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",!1)}P4i(){const z=[],T=this.toa;for(let Ba in T){var ja=T[Ba];const Ga=this.IC[Ba];if(this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideUDPFromMandatoryDialogEnabled",!1)){if(!Ga||!Ga.Enabled||Ga.HasUserDefinedPermissions)continue}else if(!Ga||!Ga.Enabled)continue;if(ja.count){const Fb={["sections"]:[],["shouldAutoOpen"]:!1},Rb={["id"]:"mandatoryLabelling_flyoutMenuSection_"+
Ga.Id,["controls"]:[]};for(let tc of ja){ja=this.IC[tc];if(this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideUDPFromMandatoryDialogEnabled",!1)){if(!ja||!ja.Enabled||ja.HasUserDefinedPermissions)continue}else if(!ja||!ja.Enabled)continue;Array.add(Rb.controls,this.L5f(ja))}Array.add(Fb.sections,Rb);Array.add(z,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+Ga.Id,["label"]:Ga.DisplayName,["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:Fb})}else Array.add(z,
this.L5f(Ga))}return z}qdb(z,T,ja,Ba,Ga){if(1===ja||!this.Tj.value.mnb(!0))return 32;Ga.MenuItems=Object.assign(new cg.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(Ga.MenuItems.MenuSectionList,this.WEc(!this.isReactRibbonEnabled()));this.Jk.CustomUrl&&Array.add(Ga.MenuItems.MenuSectionList,this.wwi(this.isReactRibbonEnabled()?this.Jk.CustomUrl:Ub.a.le(this.Jk.CustomUrl)));this.isReactRibbonEnabled()||(Ga.PopulationXML=Oj.l(Ga.MenuItems));return 32}qgc(z,T,ja,Ba,Ga){if(1===
ja||!Ga||!this.Q2b)return 32;this.Jk=this.Tj.value.uw;if(this.Tj.value.mnb(!0)&&(Ga[Je.visible]=!0,this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelsAvailableActivityControlEnabled",!1)?this.Waf||(gd.a("MipLabelsAvailable"),this.Waf=!0):gd.a("MipLabelsAvailable"),this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&this.Jk&&this.Jk.AreLabelsAvailable&&(z=C.a.instance.Oa("Common.ISystemInitiatedFeedback")))){const Fb=zi.Xa(this.Jk.AppliedPolicyId)?
"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";z.execute(Rb=>{Rb.logActivity(Fb,null)})}return 32}Ndb(z,T,ja,Ba,Ga){if(1===ja||!Ga)return 32;let Fb,Rb;Ga[Je.pvh]=!!(Fb=Ga[Je.menuItemId])&&!!(Rb=this.BOb[Fb])&&Rb===this.Jk.AppliedPolicyId;return 32}Mdb(z,T,ja,Ba,Ga){if(1===ja||!Ga)return 32;let Fb,Rb,tc;z=!!(Fb=Ga[Je.OT])&&!!(Rb=this.BOb[Fb])&&!!(tc=this.toa[Rb])&&tc.contains(this.Jk.AppliedPolicyId);Ga[Je.PRi]=z;Ga[Je.pvh]=z;return 32}rfb(z,T,ja,Ba,Ga){return 1!==
ja&&Ga?this.sfb(this.BOb[Ga[Je.OT]],Ga,2):32}BRc(){return!!E.AFrameworkApplication.Ba&&1===E.AFrameworkApplication.Ba.mode}oHk(){this.avd&&!this.BRc()&&(this.avd=!1,this.Tj.value.nHk())}Jll(){this.Jk.DefaultLabelId&&this.Jk.MandatoryLabelingEnforced?this.xqd||this.BRc()?this.Jk.AppliedPolicyId?this.wTd(""):(this.Tj.value.WJj(this.Tj.value.l5b)||this.BRc())&&this.dZf():this.fjh():this.Jk.DefaultLabelId?this.fjh():this.Jk.MandatoryLabelingEnforced&&(this.Jk.AppliedPolicyId?this.wTd(""):this.dZf())}Ntg(){return this.Jk.MandatoryLabelingEnforced?
this.Jk&&this.Jk.AreLabelsAvailable?this.mb.ka("TestOverrideIsReactDialogEnabled")||this.Mh&&this.Mh.jb&&this.Mh.jb.QB?!0:(e.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(e.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(e.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}dZf(){!this.Ntg()||E.AFrameworkApplication.SP||this.Lcf||
(this.Lcf=E.AFrameworkApplication.SP=!0,e.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.Tj.value.E8g("",1),this.Tj.value.JFd(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,()=>{this.V8j()}))}wTd(z){this.Ntg()&&E.AFrameworkApplication.SP&&(E.AFrameworkApplication.SP=!1,e.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),
this.Tj.value.aDe(),this.Tj.value.E8g(z,2))}V8j(){Jl.instance.Qwi(this.P4i(),this.Jk.CustomUrl,Object(v.a)(this,this.W8j,"mandatoryLabellingDialogCallback"))}W8j(z){this.wTd(this.Ncf[z])}MGf(){return this.mb.ka("CoAuthForProtectedFilesEnabled")&&this.mb.ka("SupportsOfficeClientCoauthoring")&&this.mb.ka("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.Xrd&&this.jsa}sfb(z,T,ja,Ba=null){this.Tj.value.wDk(ja);let Ga=32,Fb=!1,Rb=!0;const tc=2===ja||8===ja||16===ja,Ac=z===this.Jk.AppliedPolicyId;
if(this.jWe&&this.jWe(z,tc))e.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",ja),this.Mh.updateCommandUI();else if(T&&Je.RDf in T&&this.Tj.value.dIe(T[Je.RDf]),z)if(this.Tj.value.Vvg()||this.MGf()&&this.Bvd)e.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",ja),this.Mh.updateCommandUI(),tc&&this.bAc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,
CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.mb.ka("HasDocumentEditRights"))if(this.Tj.value.rhi(z))if(!this.Q8a()&&this.IC[z]&&this.IC[z].HasUserDefinedPermissions&&!Ac)e.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",ja),1!==ja&&4!==ja&&this.q6h();else if(tc&&this.Jk.MandatoryLabelingEnforced&&Ac)e.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",
ja),this.bAc(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);else{if(tc&&this.mb.ka("WacLabelingJustificationDialogIsEnabled")&&this.Jk.RequiredDowngradeJustification&&(Ac||this.IC[z].RequiredDowngradeJustification)&&(this.Q8a()?!this.Q7e&&!Ba:!this.g1))return e.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",ja),this.mLe(z),Ga;if(this.Q8a()&&this.IC[z].HasUserDefinedPermissions&&
!Ac)return e.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",ja),this.OLe(z,Ba),Ga;if(this.MGf()&&!this.Xrd())this.Dod<this.tGh?(e.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.Dod,ja),this.Bvd=!0,this.Dod++,Wh.Task.delay(this.uGh).continueWith(()=>{this.Bvd=!1;this.sfb(z,T,ja)})):(e.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",
ja),Fb=1!==ja,Rb=!1,Ga=8);else{if(this.jIj(z)&&(e.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",ja),1===ja||8===ja||4===ja))return Ga;e.ULS.sendTraceTag(570972056,306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",ja);this.setPolicyLabel(Ac?"":z,this.Q8a()?Ba:this.g1,"",ja);return Ga}}else e.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",
ja),this.Mh.updateCommandUI(),tc&&this.bAc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else e.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",ja),this.Mh.updateCommandUI(),tc&&this.bAc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else e.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",
ja),this.Mh.updateCommandUI(),Fb=tc,Rb=!1,Ga=8;this.Tj.value.Z8g(0,ja,Fb,Rb);return Ga}REf(z,T,ja=null,Ba=!1){u.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",0,"wordclpfc",null);this.mb.ka("SupportsOfficeClientCoauthoring")&&this.mb.ka("CoAuthForProtectedFilesIsEnabled")?(this.FNb=!1,(this.Jk=this.Tj.value.uw)&&!this.Jk.AppliedPolicyId?this.FNb=!0:this.Jk&&this.Jk.PolicyLabelAssignmentMethod&&(this.FNb=to.e(this.Jk.PolicyLabelAssignmentMethod)===to.e("standard"))):this.FNb=Ba;z=zi.Xa(z)?
null:this.IC[z];(T=zi.Xa(T)?null:this.IC[T])?this.Nya=new qn(T,!0,ja):(this.Tj.value.Mva(29),this.Txa=null);z?this.RJa=new qn(z,!1):this.Sib=null;this.pze(null,null)}Y7h(z){this.sfb(z,null,16)}Z_k(){this.IC={};if(this.Jk=this.Tj.value.uw)for(const z of this.Jk.SensitivityLabels)this.IC[z.Id]=z}jIj(z){if(this.toa&&z in this.toa){z=this.toa[z];for(let T of z)if((z=this.IC[T])&&z.Enabled)return!0}return!1}t1k(){this.toa={};if(this.Jk=this.Tj.value.uw){for(const z of this.Jk.SensitivityLabels)z.ParentId||
(this.toa[z.Id]=new ya.a);for(const z of this.Jk.SensitivityLabels)z.ParentId&&z.ParentId in this.toa&&this.toa[z.ParentId].add(z.Id)}}GAk(){if(this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)){this.Jk=this.Tj.value.uw;const z=this.Q2b&&this.isReactRibbonEnabled()&&this.Tj.value.mnb();zi.neb(z)}else this.Q2b&&this.isReactRibbonEnabled()?(this.Jk=this.Tj.value.uw,this.Tj.value.mnb()?(zi.neb(!0),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",
!1))):zi.neb(!1)):zi.neb(!1)}vIk(z){this.Xrd=z}fjh(){this.mb.ka("WacApplyDefaultPolicyLabelIsEnabled")&&(this.BRc()?this.avd=!0:this.xqd||(this.xqd=!0,(this.Jk=this.Tj.value.uw)&&this.Jk.DefaultLabelId&&!this.Jk.AppliedPolicyId&&(e.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.Jk.DefaultLabelId),this.sfb(this.Jk.DefaultLabelId,null,1))))}pze(){if(!this.Tj.value.Vvg()){var z=this.IC[this.Tj.value.uw.AppliedPolicyId];this.FNb&&this.RJa&&this.Sib!==this.RJa.id&&
(!z||z.Order<this.RJa.sensitivityLabel.Order)&&(z=this.sfb(this.RJa.id,{},4),32!==z?e.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+z):(this.Sib=this.RJa.id,this.Txa&&(z=this.IC[this.Txa])&&z.Order<=this.RJa.sensitivityLabel.Order&&(this.Tj.value.Mva(29),this.Txa=null)));z=this.IC[this.Tj.value.uw.AppliedPolicyId];if(this.Nya&&this.Txa!==this.Nya.id&&(!z||z.Order<this.Nya.sensitivityLabel.Order)){const T=this.Nya.id;this.Tj.value.Mva(29);
this.Tj.value.Oyc(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.z_d(this.Nya.sensitivityLabel))+" "+this.Nya.BFk,CommonUIStrings.l_PolicyLabelRecommendationButton,()=>{this.sfb(T,{},8)});this.Txa=this.Nya.id}this.Nya=this.RJa=null}}setPolicyLabel(z,T,ja,Ba=2){this.Q8a()?T&&(this.Q7e=!0):this.g1=T;this.Tj.value.setPolicyLabel(z);this.Mh.updateCommandUI();ja=new Un(Ba,this.z_d(this.IC[z]));this.Tj.value.pIe(z,this.Q8a()?T:this.g1,ja)}isi(z,
T,ja,Ba){1===z&&this.setPolicyLabel(T,Ba,ja)}hsi(z,T,ja){1===z?this.Q8a()?this.sfb(T,null,2,ja):this.setPolicyLabel(T===this.Jk.AppliedPolicyId?"":T,ja,""):this.Mh.updateCommandUI()}mLe(z){(new Ri(z,Object(v.a)(this,this.hsi,"continueToSetPolicyLabelFromJustificationDialog"))).mLe()}OLe(z,T){(new Zm(z,T,Object(v.a)(this,this.isi,"continueToSetPolicyLabelFromUDPDialog"))).OLe()}bAc(z="",T=""){const ja=new Jc.StandardDialog;ja.Zq=E.AFrameworkApplication.Sba;ja.vd=0;ja.Pe(1,CommonUIStrings.l_DialogClose);
ja.nO(z,T,null)}Lai(z){1===z&&this.Tj.value.hEk()}q6h(){const z=new Jc.StandardDialog;z.Zq=E.AFrameworkApplication.Sba;z.vd=1;z.Pe(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);z.Pe(0,CommonUIStrings.l_DialogClose);z.nO(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,Object(v.a)(this,this.Lai,"blockUDPSetLabelHandler"))}isReactRibbonEnabled(){return!!this.Mh&&!!this.Mh.jb&&this.Mh.jb.mo}Nub(){return this.Mh&&this.Mh.jb?this.Mh.jb.Nub:
!1}VWf(){return 32}Ufc(z,T,ja,Ba,Ga){if(1===ja)return 32;this.Jk=this.Tj.value.uw;if(!this.Jk||!Ga)return 32;Ga[Je.value]="";Ga[Je.labelText]="";Ga[Je.alt]=null;Ga[Je.ckg]=null;Ga[Je.ntb]=null;Ga[Je.customTooltip]="";Ga[Je.visible]=!1;Ga[Je.iconColor]="";ja=T=z=Ga[Je.icon]="";if(!this.Jk.AreLabelsAvailable){if(!this.Ovd)return 32;z=this.Ovd;ja=Je.cQe;this.Nvd&&(T=this.Nvd)}else if(this.Jk.AppliedPolicyId){Ba=null;for(const Fb of this.Jk.SensitivityLabels)if(Fb.Id.toLowerCase()===this.Jk.AppliedPolicyId.toLowerCase()){Ba=
Fb;break}Ba&&(z=this.z_d(Ba),T=Ba.Tooltip,this.Hzd=E.AFrameworkApplication.AL=Ba.IsEndpointProtectionEnabled,ja=this.Z6f(Ba))}this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(z?(Ga[Je.value]=z,Ga[Je.labelText]=z,Ga[Je.customTooltip]=T,this.Mjh(ja,this.Hzd,Ga)):this.mb.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ClpUseOutlineImageForNoLabel")?(Ga[Je.iconColor]=Je.cQe,this.Jk.MandatoryLabelingEnforced?(Ga[Je.value]=Ga[Je.labelText]=HeaderStrings.SelectASensitivityLabel,
Ga[Je.icon]=Je.$Ek):(Ga[Je.value]=Ga[Je.labelText]=HeaderStrings.NoSensitivityLabel,Ga[Je.icon]=Je.cFk)):(Ga[Je.iconColor]="#000000",this.Jk.MandatoryLabelingEnforced?(Ga[Je.value]=Ga[Je.labelText]=HeaderStrings.SelectASensitivityLabel,Ga[Je.icon]="MipTagErrorDynamicColor_20"):(Ga[Je.value]=Ga[Je.labelText]=HeaderStrings.NoSensitivityLabel,Ga[Je.icon]="MipTagQuestionDynamicColor_20")),Ga[Je.visible]=!0):z&&(Ga[Je.value]=z,Ga[Je.labelText]=z,this.Nub()?Ga[Je.customTooltip]=T:Ga[Je.alt]=T,this.Mjh(ja,
this.Hzd,Ga),Ga[Je.visible]=!0);return 32}z_d(z){return z?this.IC?z.ParentId&&this.IC[z.ParentId]?this.IC[z.ParentId].DisplayName+"\\"+z.DisplayName:z.DisplayName:(e.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),z.DisplayName):""}Mjh(z,T,ja){this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(ja[Je.icon]=this.Mdg(T),ja[Je.iconColor]=this.Ndg(z)):this.Nub()?ja[Je.icon]=T?Je.Eel:Je.Hel:(ja[Je.ckg]=E.AFrameworkApplication.Rl,
ja[Je.ntb]=T?Vb.getImageClass(Je.Fel):Vb.getImageClass(Je.Iel))}wwi(z){const T=this.Xt("LearnMoreSection",!0);z=Object.assign(new Wj.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:z,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:E.AFrameworkApplication.Rl,Image16by16Class:Vb.getImageClass(Je.lQj),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(T.ControlList,z);return T}HSf(z,T,ja=!1){let Ba;Ba="Toggle_"+z.Id;Ba="Sensitivity_"+
Ba;const Ga=z.DisplayName,Fb=z.Tooltip;var Rb=z.Id===this.Jk.AppliedPolicyId,tc=ja?Ub.a.le(Ba):Ba;this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(Rb=this.Z6f(z),T=Object.assign(new wh.a,{Id:tc,ExternalId:tc,LabelText:ja?Ub.a.le(Ga):Ga,Command:"2935633379",MenuItemId:tc,QueryCommand:"991261903",Visible:!0,Alt:ja?Ub.a.le(Fb):Fb,AriaLabel:bc.a.onb,IconColor:this.Ndg(Rb),KeyTip:T}),T.ExternalImageId=this.Mdg(z.IsEndpointProtectionEnabled)):(tc=Object.assign(new Ap.a,
{Id:tc,ExternalId:tc,LabelText:ja?Ub.a.le(Ga):Ga,Command:"2935633379",MenuItemId:tc,QueryCommand:"991261903",CheckedImage:E.AFrameworkApplication.Rl,Visible:!0,Alt:ja?Ub.a.le(Fb):Fb,IsChecked:Rb,AriaLabel:bc.a.onb,KeyTip:T}),this.isReactRibbonEnabled()?(tc.CheckedImageClass=Vb.getImageClass(Je.OBe),tc.ExternalImageId=Je.OBe):tc.CheckedImageClass=Vb.getImageClass(Je.MLf),T=tc);tc=Ba;this.BOb[tc]=z.Id;this.xif[z.Id]=tc;return T}Xt(z,T=!1){return Object.assign(new Ng.a,{Title:"",Id:z,DisplayMode:Je.menu,
ShowMenuSectionSeparator:T,ControlsId:"Ctrl_"+z,ControlList:[]})}wzi(z,T,ja){z=this.Xt(z+"Sub");let Ba=1;for(let Ga of T)(T=this.IC[Ga])&&T.Enabled&&(Array.add(z.ControlList,this.HSf(T,Ba.toString(),ja)),Ba++);return z}WEc(z=!1){const T=this.Xt("SensitivitySection");let ja=1;const Ba=this.toa;for(let Fb in Ba){const Rb=Ba[Fb],tc=this.IC[Fb];if(tc&&tc.Enabled){if(Rb.count){const Ac="Sensitivity_"+tc.Name;var Ga=z?Ub.a.le(Ac):Ac;Ga=Object.assign(new Nj.a,{Id:Ga,ExternalId:Ga,LabelText:z?Ub.a.le(tc.DisplayName):
tc.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new cg.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:bc.a.onb,KeyTip:ja.toString()});this.isReactRibbonEnabled()?Ga.ExternalImageId=Je.OBe:(Ga.Image16by16=E.AFrameworkApplication.Rl,Ga.Image16by16Class=Vb.getImageClass(Je.MLf));Array.add(Ga.Menu.MenuSectionList,this.wzi(Ac,Rb,z));Array.add(T.ControlList,Ga);this.BOb[Ga.Id]=tc.Id;this.xif[tc.Id]=
Ga.Id}else Array.add(T.ControlList,this.HSf(tc,ja.toString(),z));ja++}}return T}YRb(z){return!!this.Da.eS(z)&&!!this.Da.eS(z).flags&&!!this.Da.eS(z).flags.length}Umk(z,T){T.onSuccess&&this.IC&&(z=this.IC[this.Tj.value.uw.AppliedPolicyId])&&(this.Txa&&(T=this.IC[this.Txa])&&T.Order<=z.Order&&(this.Tj.value.Mva(29),this.Txa=null),this.Sib&&this.Sib!==z.Id&&(this.Tj.value.Mva(28),this.Sib=null))}Mdg(z){return z?Je.bFk:Je.aFk}Ndg(z){return z?z:Je.cQe}Z6f(z){if(z.Color||!z.ParentId)return z.Color;const T=
this.IC[z.ParentId];return T?T.Color:z.Color}static neb(z){E.AFrameworkApplication.fa&&E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(z?(Vn.a.Rua("ribbon","sensitivity"),Vn.a.Qua("ribbon","sensitivity")):Vn.a.t9("ribbon","sensitivity"));E.AFrameworkApplication.fa&&E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&be.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",
!z))}static Xa(z){return z&&z.length?!1:!0}}Object(h.a)(zi,"PolicyActor",null,[675]);var Ll=d(1157),Wl;(function(z){z[z.unknown=0]="unknown";z[z.boot=1]="boot";z[z.refresh=2]="refresh";z[z.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(Wl||(Wl={}));Object(h.b)("GetPolicyLabelsReason",Wl);class Bg extends Sys.EventArgs{constructor(z,T,ja,Ba,Ga,Fb){super();this.Vnb=z;this.title=T;this.message=ja;this.buttonText=Ba;this.RTb=Ga;this.hTc=Fb}}Object(h.a)(Bg,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,
[]);class Ko extends Sys.EventArgs{constructor(z,T,ja,Ba,Ga){super();this.Vnb=z;this.title=T;this.message=ja;this.buttonText=Ba;this.RTb=Ga}}Object(h.a)(Ko,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var xk;(function(z){z[z.none=0]="none";z[z.reasonDefaultLabel=1]="reasonDefaultLabel";z[z.reasonManual=2]="reasonManual";z[z.reasonAutomatic=4]="reasonAutomatic";z[z.reasonRecommended=8]="reasonRecommended";z[z.reasonMandatory=16]="reasonMandatory"})(xk||(xk={}));Object(h.b)("ApplyLabelFlags",
xk);class Kk extends Sys.EventArgs{constructor(z,T,ja){super();this.FNf=z;this.ENf=T;this.existingLabelPriority=ja}}Object(h.a)(Kk,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class yl extends Sys.EventArgs{constructor(){super()}}Object(h.a)(yl,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class Wn extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Wn,"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class zl{constructor(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=
this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelId=null;this.AreLabelsAvailable=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelId="";this.SensitivityLabels=[];this.MandatoryLabelingEnforced=!1;this.CustomUrl=""}}Object(h.a)(zl,"GetPolicyLabelsData",null,[]);class xj extends Sys.EventArgs{constructor(z=
!1){super();this.onSuccess=z}}Object(h.a)(xj,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class $k extends Sys.EventArgs{constructor(z,T){super();this.FQg=z;this.oHd=T}}Object(h.a)($k,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class yj extends Sys.EventArgs{constructor(z,T,ja,Ba){super();this.title=z;this.itk=T;this.buttonText=ja;this.xfk=Ba}}Object(h.a)(yj,"PolicyTipEventArgs",Sys.EventArgs,[]);class En extends Sys.EventArgs{constructor(z,T){super();this.Vnb=z;this.hTc=T}}Object(h.a)(En,
"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Al extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Al,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Cg extends Sys.EventArgs{constructor(z,T){super();this.L3g=z;this.zaa=T}}Object(h.a)(Cg,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class Xn extends Sys.EventArgs{constructor(z,T,ja,Ba=null,Ga=null,Fb=null,Rb=null){super();this.errorType=z;this.D$k=ja;this.title=Ba;this.message=Ga;this.buttonText=
Fb;this.RTb=Rb}}Object(h.a)(Xn,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class Bp extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Bp,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class Fn extends Sys.EventArgs{constructor(z){super();this.k7k=z}}Object(h.a)(Fn,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var Gn=d(672),kl=d(443);class ik{static t_k(z,T){if(!z||!T||z.count!==T.count)return!1;for(let ja of z)if(!T.contains(ja))return!1;return!0}static toArray(z){if(!z)return null;
const T=Array(z.count);let ja=0;for(let Ba of z)T[ja]=Ba,ja++;return T}}Object(h.a)(ik,"HashSetUtils",null,[]);var yk=d(756);class Yn{constructor(z,T,ja,Ba=0,Ga=null){this.tqd=this.e0e=null;this.fMa=this.DMb=this.EMb=0;this.bfa="";this.v1a=this.Vaf=this.tod=this.dud=this.Fxa=this.Gwd=null;this.T7e=!1;this.HZa=null;this.jtd=0;this.ivc=this.y1a=this.G_a=this.hvc=null;this.Ta=new Ae.a;this.rjc=this.F_b=this.uR=null;this.Ztd=!1;this.l5b=null;this.mb=z;this.Di=T;this.Sh=ja;this.Ltc=Ba;this.uw=new zl;this.wif=
this.mb.Ia("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.IF=Ga;this.Q2b=z.ka("WacApplyManualPolicyLabelIsEnabled");this.Y2b=z.ka("CoAuthForProtectedFilesIsEnabled");this.vgb=z.ka("SupportsOfficeClientCoauthoring");this.TKj=!1;this.A1k=3E4;this.Md=$d.a.instance;z.ka("SupportsPolicies")&&gd.a("MipSupportsPolicies");this.Y2b&&this.vgb&&gd.a("MipSupportsOfficeClientCoauthoring")}get m7d(){return this.Ztd}z3h(z){this.Ta.addHandler("PolicyTipEvent",z)}jGd(z){this.Ta.addHandler("LabelInfoUpdateEvent",
z)}GMk(z){this.Ta.removeHandler("LabelInfoUpdateEvent",z)}BGd(z){this.Ta.addHandler("SetPolicyLabelEventKey",z)}kch(z){this.Ta.removeHandler("SetPolicyLabelEventKey",z)}ACf(z){this.Ta.addHandler("SetPolicyLabelFailureEventKey",z)}C1h(z){this.Ta.addHandler("GetAutoPolicyLabelEventKey",z);this.m7d&&(e.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.zBe(new yl(0)))}n1h(z){this.Ta.addHandler("CreateAutoCLPSecurityNodesEventKey",
z)}K4h(z){this.Ta.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",z)}L4h(z){this.Ta.addHandler("UpdateAutoCLPSITNodesEventKey",z)}T0h(z){this.Ta.addHandler("AddAutoPolicyBusinessBarEntryEventKey",z)}L3h(z){this.Ta.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",z)}U0h(z){this.Ta.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",z)}M3h(z){this.Ta.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",z)}W1h(z){this.Ta.addHandler("MandatoryLabellingAppHandlerEventKey",z)}H4h(z){this.Ta.addHandler("UDPLabelingAppHandlerEventKey",
z)}get BDj(){if(!this.e0e)return!1;for(const z of this.e0e.QWd())if(!z.Capabilities||!z.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get Cvg(){return!!this.uR}euj(z){z&&this.Y2b&&this.vgb&&z.execute(Object(v.a)(this,this.aJd,"awaitRtc"))}aJk(z){this.dud=z}Gji(){return this.dud?this.dud():!1}OHk(z){this.tod=z}LE(){return(new Date).getTime()}aJd(z){if(!this.Cvg){var T=z.nL.task;T.continueWith(()=>{this.uR=T.result;this.uR.Eza(Object(v.a)(this,this.Iik,"onLabelChangeUpdateOverRtc"))})}}Iik(z,
T){12===T.type&&(this.Vaf?this.Vaf():this.DPa(this.bfa,2,this.Fxa,!0))}j8f(){this.Sh&&(this.hvc=this.Sh.wi("WebServiceCall","Call Get Policy Endpoint On Server"));var z=yk.a.uAa(1,1);this.mb.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(z=new Gn.a(this.msb("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,z),this.Di.send(z).$Db(Object(v.a)(this,this.zWg,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.yWg,"onDataLossPolicyFailureCallback"))):
this.Di.Jj(this.msb("datalosspolicy"),1,null,null,!0,2,Object(v.a)(this,this.zWg,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.yWg,"onDataLossPolicyFailureCallback"),null);this.EMb++;e.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.wif,this.EMb)}nHk(){this.DPa(this.bfa,2,this.Fxa)}DPa(z,T=0,ja=null,Ba=!1){u.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.sYd(void 0,T));this.F_b=this.LE();
const Ga=this.BOd(T);this.hLc(z,Ga,ja,Ba,T);this.hEe(!0)}zWg(z){this.K3g();let T="";({data:T}=this.NQe(z)).returnValue&&(e.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.EMb=0,this.Sh&&(this.ivc=this.Sh.wi("Task","Parse and Handle Get Policy Response")),this.oqk(T),this.ivc&&(this.ivc.stop(),this.ivc=null))}yWg(z){this.K3g();this.EMb<=this.Ltc?this.j8f():(e.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",
z?z.data?z.data.IEb:null:null),this.EMb=0)}Vvg(){return 0<this.fMa}setPolicyLabel(z){this.uw.AppliedPolicyId=z}pIe(z,T,ja=null){const Ba=this.dwi(ja);this.z1k(z,T,Ba,ja)}MZg(z){this.y1a&&(this.y1a.stop(),this.y1a=null);let T,ja;({Hhh:T,okh:ja}=this.xcg(z));const Ba=z.data.state,Ga=Ba?Ba.zaa:2;let Fb="";({data:Fb}=this.NQe(z)).returnValue?(e.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",Ga),this.fMa=0,this.Tqk(Fb,T,ja,Ba)):this.fFe(Ga)}wDk(z){u.Health.instance.recordKpiUsage("MipSetPolicyLabel",
0,"officewebclp",this.sYd(z));this.rjc=this.LE();e.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.Ta.raiseEvent("SetPolicyLabelTriggeredEventKey",new Bp(z))}ndk(){this.Y2b&&this.vgb&&this.Cvg&&this.uR.kea(12,null,!0)}LZg(z){this.y1a&&(this.y1a.stop(),this.y1a=null);let T;({Hhh:ja,okh:T}=this.xcg(z));if(this.fMa<=this.Ltc)this.pIe(ja,T);else{var ja=(ja=z.data.state)?ja.zaa:2;e.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",
z?z.data?z.data.IEb:null:null,ja);this.l5b="WACServerConnectionFailed";this.fMa=0;this.fFe(ja)}}WJj(z){if(z&&("LabelNotSupported"===z||"LabelErrorRetryLater"===z||"CoherencyFailure"===z||"LabelIdNotFound"===z||"LabelDisabled"===z))return e.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",z),!0;e.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",z);return!1}rhi(z){if(!z)return!1;let T=null,ja=null;for(const Ba of this.uw.SensitivityLabels)Ba.Id===z&&(T=Ba),Ba.Id===
this.bfa&&(ja=Ba);if(!T)return!1;if(this.Y2b&&this.vgb){if(this.tod&&this.tod()||this.BDj)return!0}else if(E.AFrameworkApplication.oA&&E.AFrameworkApplication.oA.zBa||this.Fxa&&this.Fxa())return!0;return T.IsEndpointProtectionEnabled===(!!ja&&ja.IsEndpointProtectionEnabled)}Oyc(z,T,ja,Ba,Ga){28===z?this.q8g(new Bg(z,T,ja,Ba,Ga,!1)):this.q8g(new Bg(z,T,ja,Ba,Ga,!0))}Mva(z){28===z?this.P8g(new En(z,!1)):this.P8g(new En(z,!0))}UBk(z,T,ja){e.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");
this.Ta.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new Kk(z,T,ja))}kEk(z){e.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.Ta.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new Kk(null,null,z))}lEk(z,T){e.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.Ta.raiseEvent("UpdateAutoCLPSITNodesEventKey",new Kk(z,T,null))}E8g(z,T){e.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===T?"Reading":"Edit")+
" switch event.");this.Ta.raiseEvent("MandatoryLabellingAppHandlerEventKey",new $k(z,T))}JFd(z,T,ja,Ba,Ga){37===z&&this.zBk(new Ko(37,T,ja,Ba,Ga))}aDe(){this.gDk(new Al)}hEk(){e.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.Ta.raiseEvent("UDPLabelingAppHandlerEventKey",new Fn(!0))}mnb(z=!1){const T=!!this.uw&&this.uw.AreLabelsAvailable&&!!this.uw.SensitivityLabels&&0<this.uw.SensitivityLabels.length&&Ia.a.any(this.uw.SensitivityLabels,ja=>!!ja&&ja.Enabled);T||z||zi.neb(!1);
return T}GXg(z){this.G_a&&(this.G_a.stop(),this.G_a=null);var T="";this.hEe(!1);({data:T}=this.NQe(z)).returnValue?(e.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.DMb=0,T=this.Eqk(T),z=this.jbg(z.data),u.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.gKc(void 0,z,this.F_b)),this.F_b=null,z=new yl(z),this.lCk(z),this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?T&&this.R5k()?this.m7d?this.xql():(this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",
!1)||this.yEc(),this.zBe(z),this.Ztd=!0):T||this.wbd():!this.m7d&&T&&this.mb.ka("WacApplyManualPolicyLabelIsEnabled")&&this.CFf()?(this.zBe(z),this.Ztd=!0):T||this.wbd()):this.wbd()}R5k(){if(!this.mb.ka("WacApplyManualPolicyLabelIsEnabled"))return e.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.CFf())return!1;if(""===this.bfa)return e.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),
!0;if(this.HZa===this.jtd)return e.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;e.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0}yEc(){this.jzh();e.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.v1a.count,this.HZa);const z=ik.toArray(this.v1a);this.UBk(z,
z,this.HZa)}xql(){var z=this.v1a;this.jzh();ik.t_k(z,this.v1a)||(e.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.v1a.count),z=ik.toArray(this.v1a),this.lEk(z,z));this.T7e&&(e.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.HZa),this.kEk(this.HZa))}jzh(){const z=new Ll.a(r.a.rt());for(const T of this.uw.SensitivityLabels)if(T&&T.AutoLabelingSensitiveTypeIds&&0<T.AutoLabelingSensitiveTypeIds.length)for(const ja of T.AutoLabelingSensitiveTypeIds)ja&&
z.add(ja);this.v1a=z}FXg(z){const T=this.jbg(z.data);u.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.gKc(void 0,T,this.F_b));this.F_b=null;this.G_a&&(this.G_a.stop(),this.G_a=null);if(this.DMb<=this.Ltc){if(this.mb.ka("SendHostAttributionInfoForPolicyLabelEnabled")){const ja=z.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in ja&&ja[yk.a.cGe]&&"HostAttributionInfo.ScenarioTypeParamName"in ja&&ja[yk.a.dGe]){z.data.request.get_headers();
z.data.request.get_headers();z=this.BOd(T);this.hLc(this.bfa,z,this.Fxa,void 0,T);return}}this.DPa(this.bfa,T,this.Fxa)}else e.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",z?z.data?z.data.IEb:null:null),this.wbd(),this.DMb=0,this.hEe(!1)}jbg(z){return z.state?z.state:0}msb(z,T=!1){let ja=String.format("{0}{1}?action={2}&{3}",this.mb.Ia("PolicyHandlerWebServiceBase")||E.AFrameworkApplication.Ba.jb.tda,this.wif,z,E.AFrameworkApplication.$g);"setpolicylabel"===
z&&E.AFrameworkApplication.oA&&E.AFrameworkApplication.oA.p8d&&(ja=Ca.a.aj(ja,"sl","1"));T&&(ja=Ca.a.aj(ja,"cbd","1"));return ja}xcg(z){let T,ja;T=ja=null;z&&z.data&&z.data.request&&z.data.request.get_headers()&&(T=z.data.request.get_headers()[kl.a.Ihh],ja=z.data.request.get_headers()[kl.a.pkh]);return{Hhh:T,okh:ja}}NQe(z){z=z?z.data?z.data.je:null:null;return z&&z.length&&!this.PKj(z)?{returnValue:!0,data:z}:(e.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,
data:z})}oqk(z){let T;try{T=D.b(z)}catch(ja){e.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(T)if(T.IsPolicyTipAvailable)switch(T.IsPolicyTipAvailable.toLowerCase()){case "false":e.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":e.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.tqd=T.NavigateUrl;this.V$k(T.GeneralText,Object(v.a)(this,
this.sgk,"onDataLossPolicyOverrideButtonClick"));break;default:e.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",T.IsPolicyTipAvailable)}else e.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else e.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")}Tqk(z,T,ja,Ba){var Ga=Ba?Ba.zaa:2;let Fb=0,Rb="",tc;
if(({Ev:tc}=D.d(z)).returnValue)if(tc){Rb="Success";z=this.BOd(3);if(tc.IsSuccessful){u.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.gKc(Ga,void 0,this.rjc));this.l5b=this.rjc=null;e.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",Ga);2===Ga&&this.Mva(29);this.u2k(T,Ga);this.ndk();this.Mva(28);Ba&&4===Ga&&this.Oyc(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,
Ba.displayName),CommonUIStrings.l_DialogOk,()=>{});gd.a("MipAppliedLabels",void 0,void 0,[Object.assign(new pf.a,{name:"SetPolicyLabelApplyFlag",string:xk[Ga]})]);this.hLc(T,z,this.Fxa,void 0,3);return}e.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",Ga,tc.FailureReason);this.l5b=tc.FailureReason;"FileTooLarge"===tc.FailureReason?Fb=1:"LabelNotSupported"===tc.FailureReason?Fb=2:
"LabelDisabled"===tc.FailureReason?Fb=3:"MinorVersionLimitExceeded"===tc.FailureReason&&(Fb=5);this.TKj&&0<=tc.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(Ba=new od.a(2,1,this.A1k,()=>{e.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",this.fMa);this.fMa<=this.Ltc&&this.pIe(T,ja)}),this.Md.Hb(Ba));this.Y2b&&this.vgb&&this.hLc(this.uw.AppliedPolicyId,z,this.Fxa,!0,3)}else Rb="setPolicyLabelData null.",
e.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",Ga);else Rb="TryDeserialize failed.",e.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",Ga);this.fFe(Ga,Fb);Ga=this.gKc(Ga,void 0,this.rjc);this.rjc=null;Ga.extendedProperties.set("SetPolicyLabelDataFailureReason",this.l5b);Ga.extendedProperties.set("SetPolicyLabelDataParseStatus",Rb.toString());u.Health.instance.recordKpiFailure("MipSetPolicyLabel",
"SetPolicyLabelFailure",!1,!1,Ga)}fFe(z,T=0){this.setPolicyLabel(this.bfa);this.D8g(new xj);this.Z8g(T,z,2===z||8===z||16===z,!1)}u2k(z,T){this.setPolicyLabel(this.bfa=z);if(""===z)E.AFrameworkApplication.AL=!1,E.AFrameworkApplication.YXb=!1;else for(const ja of this.uw.SensitivityLabels)if(ja.Id===z){E.AFrameworkApplication.AL=ja.IsEndpointProtectionEnabled;break}this.vDk(new Cg(z,T))}hsl(){for(const z of this.uw.SensitivityLabels)z&&z.Enabled&&(z.Id===this.bfa&&(this.T7e=this.HZa!==z.Order,this.HZa=
z.Order),z.Order>this.jtd&&(this.jtd=z.Order))}Eqk(z){if(!({Ev:z}=D.d(z)).returnValue)return e.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!z)return e.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!z.AreLabelsAvailable)return!1;this.uw=z;this.bfa=z.AppliedPolicyId;this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.hsl();this.mnb()&&e.ULS.sendTraceTag(51197846,
306,50,"Labels are available for display after GetPolicyLabels call.");this.D8g(new xj(!0));return!0}CFf(){if(!this.mnb())return e.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const z of this.uw.SensitivityLabels)if(z&&z.AutoLabelingSensitiveTypeIds&&0<z.AutoLabelingSensitiveTypeIds.length)return!0;e.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}D8g(z){e.ULS.sendTraceTag(35393610,
306,50,"Raising label info update event.");this.Ta.raiseEvent("LabelInfoUpdateEvent",z)}lCk(z){e.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.Ta.raiseEvent("GetPolicyLabelEventKey",z)}wbd(){zi.neb(!1);this.Ta.raiseEvent("GetPolicyLabelFailureEventKey",new Wn)}zBe(z){this.IF&&this.IF.execute(T=>{T=[T.isFeatureEnabled("MsoClpSpTwo",!0),T.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(T).then(ja=>{Ia.a.any(ja,Ba=>Ba)&&(e.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),
this.Ta.raiseEvent("GetAutoPolicyLabelEventKey",z),this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)&&this.yEc(),gd.a("MipAutoClassificationEnabled"));return null})})}sYd(z=null,T=null){const ja=new Map;ja.set("ClpCoauth",this.vgb.toString());null!=z&&ja.set("ApplyLabelFlags",xk[z]);null!=T&&ja.set("GetPolicyLabelsReason",Wl[T]);return ja}gKc(z=null,T=null,ja=null){const Ba=new Z.a;Ba.extendedProperties=this.sYd(z,T);null!=ja&&(Ba.durationMs=this.LE()-
ja);return Ba}vDk(z){e.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.Ta.raiseEvent("SetPolicyLabelEventKey",z)}q8g(z){e.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");z&&z.hTc&&gd.a("MipRecommendations");this.Ta.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",z)}P8g(z){e.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.Ta.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",z)}zBk(z){e.ULS.sendTraceTag(573842331,
306,50,"Raising an add mandatory labelling business bar entry event.");this.Ta.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",z)}gDk(z){e.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");this.Ta.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",z)}V$k(z,T=null){e.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.Ta.raiseEvent("PolicyTipEvent",new yj(CommonUIStrings.l_PolicyBusinessBarTitle,z,CommonUIStrings.l_PolicyOverrideButton,
T))}Z8g(z,T,ja,Ba=!0){e.ULS.sendTraceTag(42074656,306,Ba?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",T);Ba=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;let Ga=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,Fb=null,Rb=null;switch(z){case 1:Ba=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;Ga=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;break;case 2:Ba=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;
Ga=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 3:Ba=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;Ga=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 4:Ba=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;Ga=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;break;case 5:Ba=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,
Ga=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,Fb=CommonUIStrings.l_LearnMore,Rb=()=>{this.B1k()}}z=new Xn(z,T,ja,Ba,Ga,Fb,Rb);this.Ta.raiseEvent("SetPolicyLabelFailureEventKey",z)}dIe(z){this.Gwd=z}sgk(){this.tqd?(e.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),Cc.a.uJc(this.tqd)):e.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}PKj(z){if(!z.startsWith("<")||-1===z.indexOf("Error")&&
-1===z.indexOf("Unavailable"))return!1;e.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}K3g(){this.hvc&&(this.hvc.stop(),this.hvc=null)}jVi(z){if(!z)return"manual";switch(z.zaa){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}}oWi(z){if(!z)return"privileged";
z=z.zaa;let T="privileged";if(4===z||1===z)T="standard";return T}hLc(z,T,ja=null,Ba=!1,Ga=0){this.mb.ka("WacLabelingGetPolicyLabelsIsEnabled")&&(this.bfa=z,this.Fxa=ja,this.Sh&&(this.G_a=this.Sh.wi("WebServiceCall","Call Get Policy Endpoint On Server")),ja={},ja[kl.a.x7h]=z,this.mb.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(z=new Gn.a(this.msb("getpolicylabels",Ba),1,null,ja,!0,2,Ga,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,T),this.Di.send(z).$Db(Object(v.a)(this,
this.GXg,"onGetPolicyLabelsSuccessCallback"),Object(v.a)(this,this.FXg,"onGetPolicyLabelsFailureCallback"))):this.Di.Jj(this.msb("getpolicylabels",Ba),1,null,ja,!0,2,Object(v.a)(this,this.GXg,"onGetPolicyLabelsSuccessCallback"),Object(v.a)(this,this.FXg,"onGetPolicyLabelsFailureCallback"),Ga,void 0,void 0,void 0,void 0,"22"),this.DMb++,e.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.DMb))}z1k(z,T,ja,Ba=null){if(this.Q2b){this.Sh&&(this.y1a=this.Sh.wi("WebServiceCall",
"Call Set Policy Endpoint On Server"));var Ga={};Ga[kl.a.Ihh]=z;T&&(Ga[kl.a.pkh]=encodeURIComponent(T));this.Gwd&&(Ga[kl.a.W6h]=this.Gwd);Ba?(Ga[kl.a.mkh]=this.jVi(Ba),Ga[kl.a.nkh]=this.oWi(Ba)):(Ga[kl.a.mkh]="manual",Ga[kl.a.nkh]="privileged");this.vgb&&this.uw&&(Ga[kl.a.htk]=this.uw.PolicyLabelVersionToken);this.mb.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(z=new Gn.a(this.msb("setpolicylabel",!0),1,null,Ga,!0,2,Ba,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,
void 0,ja),this.Di.send(z).$Db(Object(v.a)(this,this.MZg,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,this.LZg,"onSetPolicyLabelFailureCallback"))):this.Di.Jj(this.msb("setpolicylabel",!0),1,null,Ga,!0,2,Object(v.a)(this,this.MZg,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,this.LZg,"onSetPolicyLabelFailureCallback"),Ba,void 0,void 0,void 0,void 0,"32");this.fMa++;e.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.fMa)}else e.ULS.sendTraceTag(570972052,
306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}B1k(){const z=new Jc.StandardDialog,T=this.mb.Ia("BreadcrumbFolderUrl");T?(z.vd=11,z.Pe(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),z.Pe(2,CommonUIStrings.l_DialogOk)):(z.vd=0,z.Pe(1,CommonUIStrings.l_DialogOk));z.FFd(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");z.cLk();z.nO(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,
CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,ja=>{1===ja&&T&&Cc.a.Qm(T,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}BOd(z){switch(z){case 1:return yk.a.uAa(1,1);case 2:return yk.a.uAa(7,1);case 3:return yk.a.uAa(8,1);default:return yk.a.uAa(7,0)}}dwi(z=null){if(!z)return yk.a.uAa(8,0);switch(z.zaa){case 1:case 16:return yk.a.uAa(1,1);case 4:case 2:case 8:return yk.a.uAa(8,1);default:return yk.a.uAa(8,0)}}hEe(z){this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",
!1)&&appChrome.api.setAsyncRequestStatus("sensitivity",z)}}Object(h.a)(Yn,"PolicyManager",null,[657]);class Lo{constructor(){this.ABd=this.jzd=this.Mcf=this.wqf=this.WVe=this.Mn=this.KLa=this.Ea=this.Tj=null}get name(){return"Common.App.Policy"}init(){E.AFrameworkApplication.fa.ka("ShouldInitCommonPolicyPackage")&&(E.AFrameworkApplication.fa.ka("IsDataLossPreventionEnabledForUser")&&E.AFrameworkApplication.Ba&&(this.Tj=this.Ea.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.Tj.z3h(Object(v.a)(this,
this.U$k,"showPolicyBusinessBar")),e.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),Oi.a.get_instance().Ak(6,()=>{this.Tj.j8f()})),E.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&E.AFrameworkApplication.fa.ka("SupportsPolicies")?Oi.a.get_instance().Ak(6,Object(v.a)(this,this.Eek,"onAfterRibbonBehaviorAttached")):zi.neb(!1))}dispose(){}Yb(z){z.register(657,"Common.App.Policy.Contracts.IPolicyManager").ma().na(()=>new Yn(E.AFrameworkApplication.fa,E.AFrameworkApplication.Be,
E.AFrameworkApplication.Ba.aU,E.AFrameworkApplication.fa.Gc("MaxGetPolicyRetries",1),z.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),E.AFrameworkApplication.Ba.jb.vm));z.register(zi,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ma().na(()=>new zi(E.AFrameworkApplication.Va,E.AFrameworkApplication.Ba,E.AFrameworkApplication.fa,z.qe("Common.App.Policy.Contracts.IPolicyManager")));this.Ea=z}Eek(){this.Mn=this.Ea.qb("CommonUI.BusinessBar");this.Tj||
(this.Tj=this.Ea.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.KLa=this.Ea.resolve("Common.App.Policy.PolicyActor");E.AFrameworkApplication.fa&&E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&be.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.Tj.jGd(Object(v.a)(this.KLa,this.KLa.S$g,"registerActionsHandler")):this.KLa.wb();this.Tj.jGd(Object(v.a)(this,
this.gsl,"updateLabelInfo"));E.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&(this.Tj.ACf(Object(v.a)(this,this.Smj,"handleSetPolicyLabelFailure")),this.Tj.T0h(Object(v.a)(this,this.Oyc,"addAutoPolicyBusinessBarEntry")),this.Tj.L3h(Object(v.a)(this,this.Mva,"removeAutoPolicyBusinessBarEntry")),this.Tj.U0h(Object(v.a)(this,this.JFd,"addMandatoryLabellingBusinessBarEntry")),this.Tj.M3h(Object(v.a)(this,this.aDe,"removeMandatoryLabellingBusinessBarEntry")))}gsl(){this.KLa.t1k();
this.KLa.Z_k();this.KLa.GAk();const z=this.Tj.Gji();E.AFrameworkApplication.fa.ka("HasDocumentEditRights")&&!z?this.KLa.Jll():e.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",E.AFrameworkApplication.fa.ka("HasDocumentEditRights"),z);E.AFrameworkApplication.Ba.updateCommandUI()}U$k(z,T){this.jzd&&this.Mn.Tba(38)&&this.Mn.removeEntry(this.jzd);z=this.hbg(T.title,T.itk,38,T.xfk,T.buttonText);E.AFrameworkApplication.Ba.jb.Ryc(z,
!0)?(this.jzd=z,e.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):e.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")}Smj(z,T){T.D$k&&(this.ABd&&this.Mn.Tba(21)&&this.Mn.removeEntry(this.ABd),z=this.hbg(T.title,T.message,21,null,null,T.RTb,T.buttonText),E.AFrameworkApplication.Ba.jb.Ryc(z,!0)?(this.ABd=z,e.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):
e.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))}Mva(z,T){(z=T.hTc?this.wqf:this.WVe)&&this.Mn&&this.Mn.Tba(T.Vnb)&&this.Mn.removeEntry(z)}Oyc(z,T){this.Mn&&(this.Tj.Mva(T.Vnb),z=new pn.a(T.title,T.message,null),z.id=T.Vnb,z.closeable=!0,z.image=3,z.addButton(T.buttonText,T.RTb,T.buttonText,!0),this.Mn.ai(z,!1),T.hTc?this.wqf=z:this.WVe=z)}JFd(z,T){this.Mn&&(z=new pn.a(T.title,T.message,null),z.id=T.Vnb,z.closeable=!1,z.image=
3,z.addButton(T.buttonText,T.RTb,T.buttonText,!1),this.Mn.ai(z,!1),this.Mcf=z)}aDe(){const z=this.Mcf;z&&this.Mn&&this.Mn.Tba(z.id)&&this.Mn.removeEntry(z)}hbg(z,T,ja,Ba=null,Ga=null,Fb=null,Rb=null){z=new pn.a(z,T,null);z.id=ja;z.closeable=!0;Ba&&z.KAf(Ga,Ba);Fb&&z.addButton(Rb,Fb,Rb);return z}static main(){Ya.a.instance.Ec(new Lo)}}Object(h.a)(Lo,"PackageManager",null,[2,3]);var Hn=d(286),tn=d(254),Cp=d(128);class lh extends tn.a{constructor(){super();this.fullDocSITs=this.partialDocSITs=null;this.H_=
Object.assign(new Cp.a,{T_:lh.getTypeName(),B_:lh.jl()})}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static jl(){return[]}}Object(h.a)(lh,"SecurityShared",tn.a,[]);class un extends lh{constructor(){super();this.existingLabelPriority=null;this.H_=Object.assign(new Cp.a,{T_:un.getTypeName(),B_:un.jl()})}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static jl(){return["AugLoop_SecurityShared_SecurityShared"]}}Object(h.a)(un,"CLP",lh,[]);var Zn=d(456),rc=d(425),cj=d(673);
class Mo extends pg.a{constructor(z){super();this.TenantId=null;this.TenantId=z}Lk(){return 103}}Object(h.a)(Mo,"GetAppliedPolicyIdRequest",pg.a,[]);class zk extends Sys.EventArgs{constructor(z){super();this.Fga=z}}Object(h.a)(zk,"OnAppliedPolicyReceivedEventArgs",Sys.EventArgs,[]);class Ak{constructor(z,T,ja){this.a9=this.Die=this.OYc=null;this.va=new Ae.a;this.G3b=!1;this.Yh=z;this.N9a=T;this.kc=ja;this.N9a.b2h(Object(v.a)(this,this.CVg,"onAppliedPolicyIdReady"));this.N9a.L2h(Object(v.a)(this,this.aYg,
"onIsManuallyAppliedReady"))}c2h(z){this.va.addHandler("AppliedPolicyEventReceivedKey",z)}dispose(){this.N9a.QMk(Object(v.a)(this,this.CVg,"onAppliedPolicyIdReady"));this.N9a.nNk(Object(v.a)(this,this.aYg,"onIsManuallyAppliedReady"))}M5f(z,T){z?(this.a9=z,this.OYc=T,z=new kf.a(new Mo(z),ja=>{this.X7c(ja)},ja=>this.Ocb(ja)),this.Yh.Hb(z)):Wc.a.J(41735234,822,15,"GetAppliedPolicyIdAsync: tenantId is null or empty")}l3i(z,T){!T||Ub.a.Xa(z)?Wc.a.J(51446608,822,15,"GetIsManuallyAppliedAsync: tenantId or callback is null or empty"):
(this.a9=z,this.Die=T,z=new kf.a(new Mo(z),ja=>{this.X7c(ja)},ja=>this.Ocb(ja)),this.Yh.Hb(z))}CVg(z,T){z="";Ub.a.Xa(T.Fga)||(z=T.Fga);"00000000-0000-0000-0000-000000000000"===z?(T=Ub.a.Xa(this.a9)?this.kc.Ia("TenantId"):this.a9,this.M5f(T,this.OYc)):this.Ete(z,null)}aYg(z,T){this.Bik(T.G3b)}X7c(z){let T=null;z.ServerError&&0!==z.ServerError.Code?T=Mf.a[z.ServerError.Code]:0!==z.StatusCode&&(T=hm.a[z.StatusCode]);T&&this.Ete("",T)}Ocb(){Wc.a.J(41735236,822,15,"OnGetAppliedPolicyIdFailed()");this.Ete("",
"ErrorGetAppliedPolicyIdFailed");return!0}Ete(z,T){T&&Wc.a.J(41735238,822,15,"OnAppliedPolicyIdReceived: error: "+T);this.OYc?this.OYc(z,T):Wc.a.J(50628552,822,15,"m_getAppliedPolicyIdCallback is null");Wc.a.J(587239824,822,50,"OnAppliedPolicyIdReceived: Triggering OnAppliedPolicyReceivedEvent");z=new zk(z);this.va.raiseEvent("AppliedPolicyEventReceivedKey",z)}Bik(z){this.Die?this.Die(z,null):Wc.a.J(51446615,822,15,"m_getIsManuallyAppliedCallback is null")}}Object(h.a)(Ak,"AppliedPolicyIdService",
null,[620,109]);class ye{constructor(z,T,ja,Ba){this.$yb=z;this.QDa=T;this.aT=ja;this.la=Ba}mQa(z){var T=z.automatic||{},ja=T.sensitivityLabel||{};T=this.l7d()?T.id:ja.id;ja=z.recommended||{};const Ba=ja.sensitivityLabel||{};z=this.l7d()?ja.id:Ba.id;ja=this.l7d()?ja.policyTip:Ba.policyTip;this.la.pptIsManuallyAppliedForAclpIsEnabled?this.$yb.REf(T,z,ja,!this.aT.uw.AppliedPolicyId||!this.QDa.G3b):this.$yb.REf(T,z,ja,!this.aT.uw.AppliedPolicyId)}l7d(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",
!1)}}Object(h.a)(ye,"AutoClpAnnotationEventHandler",null,[]);class $n{constructor(){this.ApplyLabelType=0;this.LabelJson=this.LabelId=this.DocLocation=null;this.SkipContentMarking=!1;this.UserPrincipalName=this.UserName=this.TenantId=null}}Object(h.a)($n,"PolicyInfo",null,[]);var No=d(969);class ao{constructor(){this.OCb=this.startTime=null}}Object(h.a)(ao,"PollingData",null,[]);class Xl{constructor(z,T,ja,Ba,Ga,Fb,Rb,tc,Ac,kd,nd,Bd){this.HXc=null;this.ia=z;this.$yb=T;this.aT=ja;this.a9=Ba;this.QNg=
this.Uxb=!1;this.pDg=new ya.a;this.RZj=Ga;this.QDa=Fb;this.Bb=Rb;this.PNg=tc;this.jq=Ac;this.zG=kd;this.$u=nd;this.hc=Bd;this.GLg=E.AFrameworkApplication.fa.Gc("ClpLabelPollingIntervalMs",3E4);this.lne=E.AFrameworkApplication.fa.Gc("ClpLabelPollingTimeoutMs",3E5);this.bla=E.AFrameworkApplication.fa.Ia("UserName");this.Q7j=E.AFrameworkApplication.fa.Ia("UserPrincipalName");this.yYj=this.U_i()}U_i(){let z;if(E.AFrameworkApplication.fa.ka("DynamicVariableCLPFixEnabled")){if(z=E.AFrameworkApplication.fa.Ia("EditDocInClientUrl"))return Wc.a.J(521204183,
822,50,"PptPolicyManager::GetDocLocation EditDocInClientUrl is not null"),z;Wc.a.J(521413841,822,10,"PptPolicyManager::GetDocLocation EditDocInClientUrl is null")}(z=E.AFrameworkApplication.fa.Ia("WOPISrc"))||Wc.a.J(521413840,822,10,"PptPolicyManager::GetDocLocation WOPISrc is null");Wc.a.J(521204182,822,50,"PptPolicyManager::GetDocLocation WOPISrc is not null");return z}dispose(){this.$yb=null;if(this.Uxb){this.aT.kch(Object(v.a)(this,this.KZg,"onSetLabelSucceeded"));for(let z of this.pDg)this.aT.kch(z)}}init(){this.$yb.wb();
this.$yb.Fe();if(E.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&E.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")){const z=Object(A.a)(No.a,uf.App.Hh);z&&this.aT.OHk(Object(v.a)(z,z.A8h,"areAllCoauthorsInSessionClientMipTrusted"));this.aT.euj(this.RZj);0<this.GLg&&0<this.lne&&this.QDa.c2h(Object(v.a)(this,this.Sgk,"onDocumentContentPolicyChanged"));E.AFrameworkApplication.jsa&&this.PNg.vIk(()=>this.jq.uDh);this.jq.Q2&&(Wc.a.J(575714112,822,50,"PPTPolicyManager::Init - Setting LockId to {0}",
this.jq.Q2),this.aT.dIe(this.jq.Q2));this.zG.R1h(()=>{Wc.a.J(575714113,822,50,"PPTPolicyManager::LockIdChanged - Setting LockId to {0}",this.jq.Q2);this.aT.dIe(this.jq.Q2)})}this.aT.H4h(Object(v.a)(this,this.x8h,"applyUdpLabeling"));this.aT.aJk(Object(v.a)(this,this.HBj,"isClpBlockedByAppSpecificScenario"));this.aT.W1h(Object(v.a)(this,this.X7h,"applyMandatoryLabeling"));this.aT.BGd(Object(v.a)(this,this.KZg,"onSetLabelSucceeded"));this.Uxb=!0}x8h(z,T){T.k7k&&E.AFrameworkApplication.Va.processAction(Xc.a.openInClient,
2)}HBj(){const z=!this.hc.getState(2)&&!this.hc.bug;this.QNg!==z&&(this.hc.BAg(),Wc.a.J(545296981,822,50,"PPTPolicyManager::IsClpBlockedByAppSpecificScenario - {0}",z),this.QNg=z);return z}get Fga(){return this.aT.uw.AppliedPolicyId}nJk(z){this.aT.BGd(z);this.pDg.add(z)}rsk(z,T,ja){const Ba=new $n;Ba.TenantId=this.a9;Ba.LabelId=z;Ba.ApplyLabelType=T;Ba.LabelJson=Xl.SQi(D.c(ja));Ba.SkipContentMarking=!1;Ba.UserName=this.bla;Ba.UserPrincipalName=this.Q7j;Ba.DocLocation=this.yYj;Wc.a.J(590414860,822,
50,"PersistLabelToWorker: Updating worker with received policy");this.ia.Ma(Xc.a.l4g,2,Ba)}X7h(z,T){T&&0!==T.oHd?((z=1===T.oHd)?this.$u.$sh():(this.$u.Wsh(),""!==T.FQg&&this.PNg.Y7h(T.FQg)),T=z?1:3,z=E.AFrameworkApplication.Va.mode,T!==z&&Wc.a.J(561583749,822,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",T,z)):Wc.a.J(571549022,822,50,"ApplyMandatoryLabelling is called with invalid inputs.")}KZg(z,T){this.rsk(T.L3g,T.zaa,this.aT.uw);Wc.a.J(41951564,822,50,"OnSetLabelSucceeded: Set policy label to ppt file after set label succeeded on host.")}dUd(z){z&&
this.Fga?z=this.Fga.toLowerCase()===z.toLowerCase():(Wc.a.J(587239818,822,50,"FLabelIdMatchesPolicyManager: null labelId or null AppliedPolicyId, can't compare case insensitively. fNullLabelId:{0} fNullAppliedPolicyId:{1}",!z,!this.Fga),z=z===this.Fga);Wc.a.J(587239816,822,50,"FLabelIdMatchesPolicyManager: fLabelIdMatchesPolicyManager:{0}",z);return z}mtk(z){const T=Object(A.a)(ao,z.customData);if(T){var ja=+new Date-+T.startTime;Wc.a.J(587239812,822,50,"PollingTaskCallback: Callback received, durationMs:{0}",
ja);this.dUd(T.OCb)||ja>this.lne||T.OCb!==this.HXc?(Wc.a.J(587239810,822,50,"PollingTaskCallback: Stopping loop due to FAreInSync:{0} fDidTimeout:{1} fStaleLabelId:{2}",this.dUd(T.OCb),ja>this.lne,T.OCb!==this.HXc),this.Bb.ah(z)):(Wc.a.J(587239808,822,50,"PollingTaskCallback: Triggering GetPolicy call"),this.aT.DPa(T.OCb,void 0,Xl.OMa,!0))}else Wc.a.J(587239814,822,15,"PollingTaskCallback: Failed to get pollingData from taskItem, removing task"),this.Bb.ah(z)}yfl(z){Wc.a.J(587239778,822,50,"SubmitPollingTask: Submitting new polling task");
const T=new od.a(2,2,this.GLg,Object(v.a)(this,this.mtk,"pollingTaskCallback"),90,"113");T.customData=Object.assign(new ao,{startTime:new Date,OCb:z});this.Bb.Hb(T)}Sgk(z,T){Wc.a.J(587239776,822,50,"OnDocumentContentPolicyChanged: Notification received");T.Fga||Wc.a.J(587239774,822,50,"OnDocumentContentPolicyChanged: Empty labelId - could indicate bug or all labels removed");this.HXc=T.Fga;this.dUd(this.HXc)?Wc.a.J(587239772,822,50,"OnDocumentContentPolicyChanged: PODS is in agreement with SPO, no need to poll"):
this.yfl(T.Fga)}static OMa(){const z=uf.App.Hh.amIAlone,T=uf.App.Hh.OMa;let ja=!1;const Ba=Object(A.a)(No.a,uf.App.Hh);Ba&&(ja=Ba.B8h());Wc.a.J(579609283,822,50,"AmITheOnlyCoauthor: Used block self coauth flow, fAmIAlone:{0} fAmITheOnlyCoauthor:{1} fAreAllCoauthorsWebClients:{2}",z,T,ja);return z||T&&ja}static SQi(z){z=z.replace(RegExp(":null","gi"),':""');return z=z.replace(RegExp('"LabelActions":',"gi"),'"Actions":')}}Object(h.a)(Xl,"PptPolicyManager",null,[109]);class In{constructor(z,T,ja,Ba){this.MWj=
z;this.qc=T;this.Jb=ja;this.la=Ba}wb(){this.MWj.ra(Xc.a.l4g,Rg.a.application,Object(v.a)(this,this.xhj,"handleApplySensitivity"),4)}Fe(){}xhj(z,T,ja,Ba,Ga){if(!(E.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&E.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&E.AFrameworkApplication.fa.ka("SupportsPolicies")))return 16;if(T.contextId!==Rg.a.application)return 2;if(!Ga||!Object(Gf.a)($n,
Ga))return 8;z=Object(A.a)($n,Ga);if(Ub.a.Xa(z.TenantId))return Wc.a.J(41793040,808,10,"The tenant id of policy info is empty or null"),8;if(Ub.a.Xa(z.LabelJson))return Wc.a.J(41793042,808,10,"The label json of policy info is empty or null"),8;if(1===ja)return 32;ja=this.qc.un;T=this.Jb.xd(7);try{T.lc(ja),ja.PCb=z}finally{T&&T.dispose()}return 32}}Object(h.a)(In,"SetPolicyActor",null,[234]);class mm{constructor(){this.k6b=this.sne=this.kc=this.QDa=this.K=null;this.nMg=!0}get name(){return"PowerPointWebEditor.Policy"}Yb(z){this.K=
z;this.K.register(620,"PowerPointWebEditor.Policy.IAppliedPolicyIdService").ma().na(()=>new Ak(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.kc=this.K.resolve("Common.IAppSettingsManager");this.kc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SensitivityTTVRImprovementEnabled",!1)?this.kc.Ntb(Object(v.a)(this,this.Fl,"onFullAppSettingsReady")):this.K.resolve("Common.IAppSettingsManager").gf(Object(v.a)(this,
this.Fl,"onFullAppSettingsReady"))}dispose(){}Fl(){if(this.kc.ka("WacLabelingPoliciesIsEnabled")&&this.kc.ka("SupportsPolicies")&&this.kc.ka(Ra.a.pa(890)))this.QDa=this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),Oi.a.get_instance().Ak(10,Object(v.a)(this,this.Fek,"onAfterRibbonDisplayed")),Hn.a.su(this.K.Oa("Common.App.Policy.Contracts.IPolicyManager")).continueWith(z=>{const T=new In(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"));z=z.result;this.sne=new Xl(this.K.resolve("Common.IActionManagerExtended"),T,z,this.kc.Ia("TenantId"),this.K.Oa("Common.Interface.IRtcBasicProvider"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),
this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"));this.sne.init()});else if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Feb){const z=this.K.resolve("PowerPointWebEditor.IPPTRumTracker");z.t9(z.z4,z.mih)}}Fek(){Hn.a.su(this.K.Oa("Common.App.Policy.Contracts.IPolicyManager")).continueWith(z=>{const T=z.result;E.AFrameworkApplication.fa.ka("AutoClpIsEnabled")&&(Wc.a.J(574223201,822,50,"OnAfterRibbonDisplayed: Registering with GetAutoPolicyLabelHandler API"),
this.k6b=new Mc.a(()=>new ye(this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),T,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.kc.Ia("TenantId"))),T.C1h(Object(v.a)(this,this.QHk,"registerAutoClpAnnotationEventHandler")),E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(T.n1h(Object(v.a)(this,this.yEc,"createAutoCLPSecurityNodes")),T.K4h(Object(v.a)(this,
this.vql,"updateAutoCLPLabelPriorityNode")),T.L4h(Object(v.a)(this,this.wql,"updateAutoCLPSITNodes"))));(z=this.kc.Ia("AppliedPolicyId"))||E.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&E.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")?E.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?T.DPa(z,void 0,Xl.OMa):T.DPa(z):(z=this.kc.Ia("TenantId"),Ub.a.Xa(z)?Wc.a.J(41735240,822,15,"OnAfterRibbonDisplayed: tenantId is null or empty"):(Wc.a.J(41735242,822,50,"OnAfterRibbonDisplayed: Call AppliedPolicyIdService.GetAppliedPolicyIdAsync"),
this.QDa.M5f(z,(ja,Ba)=>{Ba&&Wc.a.J(41735244,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync failed: "+Ba);Ub.a.Xa(ja)&&(ja="",Wc.a.J(41735246,822,50,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync: appliedPolicyIdInFile is empty"));E.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?T.DPa(ja,void 0,Xl.OMa):T.DPa(ja)}),this.QDa.l3i(z,(ja,Ba)=>{Ba?Wc.a.J(51446622,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetIsManuallyAppliedAsync failed: "+
Ba):this.QDa.G3b=ja}),this.sne.nJk(Object(v.a)(this,this.esl,"updateIsManuallyApplied"))))})}QHk(){const z=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.nMg&&2===z.mode&&(this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(T=>{Wc.a.J(574223202,822,50,"RegisterAutoClpAnnotationEventHandler: Registering with AugLoopRuntimeManager");E.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?(T.mmb("AugLoop_SecurityClp_LabellingAnnotation"),
T.jhc("AugLoop_SecurityClp_LabellingAnnotation",Object(v.a)(this.k6b.value,this.k6b.value.mQa,"handleAnnotationEvent"))):(T.mmb("AugLoop_Automatic_Clp_LabellingAnnotation"),T.jhc("AugLoop_Automatic_Clp_LabellingAnnotation",Object(v.a)(this.k6b.value,this.k6b.value.mQa,"handleAnnotationEvent")))}),this.nMg=!1)}yEc(z,T){z=[Object.assign(new rc.a,{id:"clp",body:Object.assign(new un,{existingLabelPriority:T.existingLabelPriority,partialDocSITs:T.FNf,fullDocSITs:T.ENf})})];const ja=Object.assign(new Zn.a,
{parentPath:["session","doc","security"],items:z});this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ba=>{Wc.a.J(543782932,822,50,"CreateAutoCLPSecurityNodes: Submit AddOperations to AugLoopRuntimeManager");Ba.submitOperation(ja)})}vql(z,T){z=[Object.assign(new rc.a,{id:"clp",body:Object.assign(new un,{existingLabelPriority:T.existingLabelPriority})})];const ja=Object.assign(new cj.a,{parentPath:["session","doc","security"],items:z});this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ba=>
{Wc.a.J(543782933,822,50,"UpdateAutoCLPLabelPriorityNode: Submit UpdateOperation to AugLoopRuntimeManager");Ba.submitOperation(ja)})}wql(z,T){z=[Object.assign(new rc.a,{id:"clp",body:Object.assign(new un,{partialDocSITs:T.FNf,fullDocSITs:T.ENf})})];const ja=Object.assign(new cj.a,{parentPath:["session","doc","security"],items:z});this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ba=>{Wc.a.J(543782934,822,50,"updateAutoCLPSITNodes: Submit UpdateOperation to AugLoopRuntimeManager");
Ba.submitOperation(ja)})}esl(z,T){T&&(this.QDa.G3b=T.L3g&&0!==T.zaa?2===T.zaa||8===T.zaa||16===T.zaa?!0:!1:!1)}static main(){Ya.a.instance.Ec(new mm)}}Object(h.a)(mm,"PPTWebEditorPolicyPackage",null,[2,3]);Type.registerNamespace("B4Intent");Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCorrections");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");
Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointSafeLinks");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Activity");Type.registerNamespace("PowerPointWebEditor.Animations");Type.registerNamespace("PowerPointWebEditor.Dictation");Type.registerNamespace("PowerPointWebEditor.FirstRunExperience");Type.registerNamespace("PowerPointWebEditor.Policy");Type.registerNamespace("PowerPointWebEditor.RevisionTracking");
Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Va.main();Type.registerNamespace("Common.App.CatchUpActivity");lc.main();Type.registerNamespace("Common.Comments");Type.registerNamespace("Common.App.Rename");Ya.a.instance.Ec(new oc,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");Ya.a.instance.Ec(new id);Type.registerNamespace("Common.App.SafeLinks");af.main();Ad.main();Ij.main();ek.main();fk.main();nn.main();qb.main();Type.registerNamespace("Common.App.OAuth");
km.main();Ya.a.instance.Ec(new If);wg.main();Ya.a.instance.Ec(new gf);Ym.main();Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");Lo.main();mm.main()},208:function(J,V,d){J=d(0);var h=d(57);class e{constructor(v,A,x,y,u){this.KEa=!1;this.Dxb=v;this.Lwb=A;this.q6b=x;this.r0j=u;this.Nyb=y.YBa(x,A.name)}get AIf(){return this.q6b}Yb(v){this.Nyb.XGf();this.Lwb.Yb(v);this.Nyb.RYf()}init(){this.Nyb.Ut(this.Lwb.name+
"_d");this.r0j?this.Dxb.cuj(this,this.q6b):this.Dxb.buj(this,this.q6b)}auj(){this.Nyb.au(this.Lwb.name+"_d");this.Nyb.ZGf();this.Lwb.init();this.KEa=!0;this.Nyb.UYf()}dispose(){this.KEa&&this.Lwb.dispose()}get name(){return this.Lwb.name}}Object(J.a)(e,"DelayLoadedPackage",null,[825,2,3]);class m{constructor(v,A){this.Dxb=null;v.execute(x=>{this.Dxb=x});this.xXj=A}create(v,A,x){return this.Dxb?new e(this.Dxb,v,A,this.xXj.value,x):v}static get instance(){return m.Ka||(m.Ka=new m(h.a.instance.Oa("PowerPointWebEditor.DelayLoadedPackageInitializer"),
h.a.instance.qe("PowerPointWebEditor.Core.IBundleMetricRecorder")))}}m.Ka=null;Object(J.a)(m,"DelayLoadedPackageFactory",null,[]);d.d(V,"a",function(){return r});const r=(v,A)=>m.instance.create(v,A,!1)},228:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(78);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=
e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}ax(){return!0}static rpb(e,m){return e+(m?"Rtl":"")}}Object(J.a)(h,"BasePresenceControl",
d.a,[109,394])},229:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m){super();this.type=e;this.Ri=m}}h.No="InteractivityChanged";Object(J.a)(h,"InteractivityChangedEventArgs",Sys.EventArgs,[])},230:function(J,V,d){d.d(V,"a",function(){return r});J=d(0);var h=d(25),e=d(1086),m=d(45);class r{static W8f(){return r.W4h+"_"+e.a.K1b+"_"+m.a.BM(h.AFrameworkApplication.userName)+"_"}static t5f(v){return v+"_"+e.a.K1b+"_"+m.a.BM(h.AFrameworkApplication.userName)+
"_"}static xbg(){return r.Yxk+"_"+e.a.K1b+"_"+m.a.BM(h.AFrameworkApplication.userName)+"_"}}r.yaa="ack0";r.Fza="ack1";r.Szc="ack2";r.W4h="ack3";r.FSb="ack4";r.KCf="ack7";r.fbe="ack8";r.roh="ack9";r.ZId="ack10";r.IKe="ack13";r.U4h="DdaMethod";r.T4h="ControlId";r.HGd="SecurityOrigin";r.Omb="ak0";r.FGd="ak1";r.OCf="ak2";r.GSb="ak4";r.ICf="Office.AutoShowTaskpaneWithDocument";r.MCf="refreshRequired";r.LCf="value";r.Z4h="errorCode";r.oSd="SolutionId";r.mSd="MethodData";r.nSd="DynamicAddinCommandsMethodDispatchId";
r.zHi="OsfControl";r.AHi="RibbonUpdaterData";r.Hjd="AddinShared";r.Yxk="__OSF_PRIVATECATALOG_ADDINIDS";Object(J.a)(r,"AddinConstantsString",null,[])},277:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(981);class e{constructor(m){this.Rk=new h.a;this.aVa=m}yP(m){const r=m.id;let v=null;this.Rk.Kb(r)?v=this.Rk.ga(r):(this.aVa&&(v=this.aVa(m,()=>{this.whc(r)})),v&&this.Rk.$(r,v));return v}QE(m){m=m.id;return this.Rk.Kb(m)?this.Rk.ga(m):null}whc(m){this.Rk.remove(m)}}Object(J.a)(e,"ShapeComponentViewManager",
null,[259])},368:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"OAuthResult",null,[])},436:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(66),e=d(13),m=d(318),r=d(111);class v{constructor(A,x,y,u,H,G,E,I,Q,D,Y,M){this.XTb=1;this.SS=x;this.$h=A;this.iee=y;this.we=Q;this.So=D;this.jd=Y;this.JFa=I;this.jFa=H;this.kFa=u;this.HN=G;this.we.addCssClass(this.$h,"prControl");this.$h.style.width=this.we.Nc(x);this.kr=E.qSf();this.xEa=E.pSf();this.kr.Rga(A);this.xEa.Rga(A,
x,x);this.sUa=M;this.r4()}dispose(){this.Smc();this.clear();this.kr.dispose();this.xEa.dispose();this.we.removeCssClass(this.$h,"prControl")}get Nda(){return r.a.none}clear(){this.Ppa();this.Iob();this.KEb()}setZIndex(A){this.$h.style.zIndex=String(A)}ubc(){this.sUa.za.style.zIndex=String(this.XTb+m.a.w$)}KEb(){this.sUa.za.style.zIndex="0"}Cfd(A,x,y=null){A=this.JFa.zOd(this.SS,this.SS,this.iee,A,"",y);this.kr.aIa(A,x)}v2a(A,x){this.xEa.add(A,x)}Iob(){this.xEa.clear()}Ppa(){this.kr.clear()}onClick(){return!0}r4(){this.kFa&&
this.So.pb(h.a.pointerOver,this.$h,this.kFa);this.jFa&&this.So.pb(h.a.pointerOut,this.$h,this.jFa);this.HN?this.jd.pb(h.a.click,this.$h,this.HN):this.jd.pb(h.a.click,this.$h,Object(e.a)(this,this.onClick,"onClick"));this.jd.pb(h.a.doubleClick,this.$h,Object(e.a)(this,this.onClick,"onClick"))}Smc(){this.kFa&&this.So.zb(h.a.pointerOver,this.$h,this.kFa);this.jFa&&this.So.zb(h.a.pointerOut,this.$h,this.jFa);this.HN?this.jd.zb(h.a.click,this.$h,this.HN):this.jd.zb(h.a.click,this.$h,Object(e.a)(this,this.onClick,
"onClick"));this.jd.zb(h.a.doubleClick,this.$h,Object(e.a)(this,this.onClick,"onClick"))}}Object(J.a)(v,"ShapePawn",null,[260])},533:function(J,V,d){d.r(V);J=d(0);var h=d(374),e=d(1175),m=d(671),r;(function(va){va[va.external=0]="external";va[va.msa=1]="msa";va[va.aad=2]="aad"})(r||(r={}));Object(J.b)("AuthorityType",r);var v=d(368);class A{constructor(va){this.dPh=va}initialize(){return Promise.resolve(0)}iVc(){return Promise.resolve(0)}p0(){h.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");
return Promise.resolve(Object.assign(new v.a,{IsSuccess:!0,Token:this.dPh}))}Kkd(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Did(){return!1}k0b(){return"MockAuthTokenStrategy"}}Object(J.a)(A,"MockAuthTokenStrategy",null,[827]);var x=d(706);class y{static get(va,Fa,ka){if(!ka)return va;let qa=0;return Promise.race([va,new Promise(Ua=>{qa=
window.setTimeout(()=>{Ua(Fa)},ka)})]).then(Ua=>{window.clearTimeout(qa);return Promise.resolve(Ua)}).catch(()=>{window.clearTimeout(qa);return Promise.resolve(Fa)})}}Object(J.a)(y,"PromiseWithTimeout",null,[]);var u=d(25),H=d(259);class G{constructor(va,Fa,ka,qa,Ua){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=va;this.scope=Fa;this.silentLogin=ka;this.options=qa;this.correlationId=Ua}}Object(J.a)(G,"TokenRequestParameters",null,[848]);var E=
d(55),I=d(57);class Q{constructor(){this.Lyf=null;let va=u.AFrameworkApplication.fa.Ia(u.AFrameworkApplication.lJ),Fa=u.AFrameworkApplication.fa.Ia(u.AFrameworkApplication.fyh);this.Llb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",va&&""!==va?va:"Unspecified",Fa&&""!==Fa?Fa:"Unspecified")}initialize(){return new Promise(va=>{I.a.instance.Oa("Common.App.WopiIdentity.IWopiIdentity").execute(Fa=>{this.Lyf=Fa;va(0)})})}Bc(va){const Fa=["HTTPS:","API:"];let ka=!1;const qa=
va.toLocaleUpperCase();for(const Ua of Fa)if(qa.startsWith(Ua)){ka=!0;break}return ka||this.NEj(va)?va+"/.default":va}NEj(va){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(va)}iVc(){return Promise.resolve(0)}p0(va,Fa,ka,qa,Ua,Ya,Va){if(E.a.yDa){Ua=H.a.qxl;if(!Ua)return Fa=Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Fa);if(!Array.contains(Ua,va))return Fa=Object.assign(new v.a,
{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+va}),Promise.resolve(Fa)}va=this.Bc(ka);ka=new G(ka,va,!qa,null,u.AFrameworkApplication.userSessionId);return this.Lyf.getAccessToken(ka,Fa,Va).then(ua=>Object.assign(new v.a,{IsSuccess:!0,Token:ua.accessToken}),ua=>Object.assign(new v.a,{IsSuccess:!1,ErrorCode:ua}))}Kkd(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Did(){return!1}k0b(){return this.Llb}}
Object(J.a)(Q,"ParentFrameTokenStrategy",null,[827]);var D=d(13),Y=d(449),M=d(17);class N{constructor(){this.reject=this.resolve=null;this.startTime=0;this.x6g=this.SGf=null}}Object(J.a)(N,"PromiseWrapper",null,[]);class W{constructor(va=0){this.iM=0;this.qPb=!1;this.Pt=new M.a;this._timeout=va}enqueue(va){return new Promise((Fa,ka)=>{this.Pt.add(Object.assign(new N,{x6g:va,resolve:Fa,reject:ka}));this.process()})}process(){if(this.qPb||this.iM===this.Pt.count)return!1;const va=this.Pt.ga(this.iM++);
try{this.qPb=!0,va.x6g().then(Fa=>{this.qPb=!1;this.aNd(va,Fa,null,!0)}).catch(Fa=>{this.qPb=!1;this.aNd(va,null,Fa,!1)})}catch(Fa){this.qPb=!1,this.aNd(va,null,Fa,!1)}return!0}aNd(va,Fa,ka,qa){if(qa){const Ua=()=>{va.resolve(Fa);this.process()};0<this._timeout?window.setTimeout(()=>{Ua()},this._timeout):Ua()}else{const Ua=()=>{va.reject(ka);this.process()};0<this._timeout?window.setTimeout(()=>{Ua()},this._timeout):Ua()}}}Object(J.a)(W,"PromiseQueue",null,[]);class K{constructor(){this.correlationId=
this.resolve=null}}Object(J.a)(K,"ResolveWithCorrelation",null,[]);var ca=d(1154),P=d(83),ea=d(520),da=d(125);class ia extends P.a{constructor(va,Fa,ka,qa,Ua,Ya,Va){super(!1,!1,!0);this.b_e=this.mfa=null;this.haa=va;this.fRh=ka;this.gE=qa;this.PVh=Ua;this.d0a=Ya;this.iA=document.createElement("iframe");this.iA.id="SharedAuthInteractiveFrame";this.iA.setAttribute("name","SharedAuthInteractiveFrame");this.iA.setAttribute("title","SharedAuthInteractiveFrame");this.iA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.iA.style.border="0";this.iA.style.height="48px";this.iA.style.width="190px";$addHandler(this.iA,"error",Object(D.a)(this,this.Plk,"onSharedAuthFrameError"));va=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.haa,Fa,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",u.AFrameworkApplication.userType);Va&&(va+="&vnext=1");this.iA.src=va;this.QIh=new Promise(ua=>{this.b_e=ua});this.c_e=!1}MT(){this.mfa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.fRh,
["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:u.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(D.a)(this,this.Jvi,"createFrame"),["resolveDialogStyles"]:this.b_e}};this.vd=5;this.qj(CommonUIStrings.l_SignIn,Object(D.a)(this,this.y5k,"sharedAuthConsentDialogHandler"),this.mfa)}EAh(va=!1,Fa=5){this.mfa&&this.mfa.bodyControls&&(!0!==Object(ca.a)(Object,this.mfa.bodyControls).frameLoaded&&(Object(ca.a)(Object,this.mfa.bodyControls).frameLoaded=!0),va!==Object(ca.a)(Object,
this.mfa.bodyControls).frameLoadSuccess&&(Object(ca.a)(Object,this.mfa.bodyControls).frameLoadSuccess=va),Fa!==this.mfa.dialogButtonsOption&&(this.mfa.dialogButtonsOption=null,this.vd=Fa),this.update(this.mfa))}qal(va,Fa){const ka=new ea.a(da.a.C5k);ka.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:u.AFrameworkApplication.isRtl,["messageCorrelationId"]:va,["dialogStyles"]:Fa};this.gE.Veb(ka,this.iA.contentWindow,this.haa)}$3f(){this.EAh(!1,
6)}get jmh(){return this.iA}get oEi(){return this.QIh.then(va=>{this.c_e=!0;return va})}get pEi(){return this.c_e}Plk(){this.$3f()}Jvi(){return this.iA}y5k(va){0===va&&(this.PVh.reject(Object.assign(new v.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.d0a(null))}}Object(J.a)(ia,"SharedAuthConsentDialog",P.a,[847]);var C=d(652),oa=d(95),Z=d(214),pa=d(63),ya=d(114),Ja=d(88);class Ka{constructor(){this.iA=null;this.Vrc=0;this.vkb=this.dmb=this.zod=
this.d0a=this.nY=this.nxf=null;this.gE=new C.a(null,null);this.gyc=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthVNext",!1);this.Llb="SharedAuthTokenStrategy "+(this.gyc?"BrowserAuth 1.20210701.2/MSAL 2.11.0":"BrowserAuth 1.20210426.1/MSAL 2.11.0");this.haa=H.a.A5k;this.Ntf=H.a.z5k;this.s0e=H.a.enableConsoleLogging;this.AJh=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.gUh=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",
this.gyc);this.NLa={};this.YLh=new W(1500)}k0b(){return this.Llb}initialize(){var {OAuthManager:va}=d(533);if("loadFrame"in this.NLa)return this.NLa.loadFrame.SGf;if(!this.haa)return oa.Health.instance.recordKpiFailure(va.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),h.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);va=this.eid("loadFrame");this.Vrc=pa.a.pj();var Fa=this.haa+this.Ntf+"?replyUrl="+window.location.protocol+
"//"+window.location.host+"&usid="+u.AFrameworkApplication.userSessionId+"&WacUserType="+u.AFrameworkApplication.userType;this.gyc&&(Fa+="&vnext=1");this.iA=document.createElement("iframe");this.YPc(this.iA);this.iA.style.cssText="height:0;width:0;display:none;";this.iA.id="SharedAuthFrame";this.iA.setAttribute("name","SharedAuthFrame");this.iA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.iA.setAttribute("title","SharedAuthFrame");this.iA.src=Fa;document.body.appendChild(this.iA);
Fa=pa.a.pj()-this.Vrc;h.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Fa,this.iA.src);return va}iVc(va){this.zod=va;const Fa=new ea.a(da.a.mmh);Fa.Values=this.wGf(va);va=this.eid("initFrame");this.gE.Veb(Fa,this.iA.contentWindow,this.haa);h.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return va}p0(va,Fa,ka,qa,Ua,Ya){const Va=new ea.a(da.a.D5k),ua=this.Sbg();Va.Values=
this.Uwh(va,Fa,ka,qa,Ua,Ya,ua);va=this.eid(ua);qa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.YLh.enqueue(()=>new Promise(Ca=>{this.rnl(Ya,Va,Ca,ua)})):(this.gE.Veb(Va,this.iA.contentWindow,this.haa),h.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Fa));return va}rnl(va,Fa,ka,qa){const Ua=this.NLa[qa];Ua&&(this.dmb=Fa,this.d0a=Object.assign(new K,{resolve:ka,correlationId:qa}),
this.nY=new ia(this.haa,this.Ntf,va,this.gE,Ua,ka,this.gyc),this.nY.MT())}Sbg(){return ya.a.create().toString()}Uwh(va,Fa,ka,qa,Ua,Ya,Va){const ua={};ua.appName=va;ua.appId=Fa;ua.target=ka;ua.withPopup=qa;ua.claims=Ua;ua.promptMessage=Ya;ua.messageCorrelationId=Va;return ua}YPc(va){$addHandler(va,"load",Object(D.a)(this,this.hik,"onIFrameLoaded"));$addHandler(va,"error",Object(D.a)(this,this.Uue,"onIFrameError"));this.gE.Myc(this.haa);this.gE.Qt(da.a.pmh);this.gE.cB(da.a.pmh,Object(D.a)(this,this.klk,
"onScriptLoaded"));this.gE.Qt(da.a.omh);this.gE.cB(da.a.omh,Object(D.a)(this,this.jlk,"onScriptInitialized"));this.gE.Qt(da.a.kmh);this.gE.cB(da.a.kmh,Object(D.a)(this,this.Rhk,"onGetTokenResponse"));this.gE.Qt(da.a.qmh);this.gE.cB(da.a.qmh,Object(D.a)(this,this.Uik,"onLoginResponse"));this.gE.Qt(da.a.nmh);this.gE.cB(da.a.nmh,Object(D.a)(this,this.vik,"onInteractiveFlowReady"));this.gE.Qt(da.a.lmh);this.gE.cB(da.a.lmh,Object(D.a)(this,this.dik,"onHideDialog"));this.gE.Qt(da.a.imh);this.gE.cB(da.a.imh,
Object(D.a)(this,this.Ofk,"onCloseDialog"))}eid(va){const Fa=new N;Fa.startTime=pa.a.pj();const ka=new Promise((qa,Ua)=>{Fa.resolve=qa;Fa.reject=Ua});Fa.SGf=ka;this.NLa[va]=Fa;return ka}hik(){const va=pa.a.pj()-this.Vrc;h.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",va)}Uue(va){const {OAuthManager:Fa}=d(533),ka=pa.a.pj()-this.Vrc,qa=Object.assign(new Ja.a,{durationMs:ka});oa.Health.instance.recordKpiFailure(Fa.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,
!0,qa);h.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ka,this.s0e?JSON.stringify(va):"")}klk(va){const {OAuthManager:Fa}=d(533),ka=this.NLa.loadFrame;var qa=pa.a.pj()-ka.startTime,Ua=va.Values.AuthLibrary.toString();va=va.Values.Success.toString();h.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",va,Ua,qa);Ua&&(this.Llb="SharedAuthTokenStrategy "+Ua);Ua=Boolean.parse(va);Ua||(va=Z.a.oz(),
void 0!==va&&null!==va&&(va.set("AuthLibrary",this.k0b()),qa=Object.assign(new Ja.a,{durationMs:qa,extendedProperties:va}),oa.Health.instance.recordKpiFailure(Fa.kpiName,"SharedAuthStrategyInitFailed",!1,!0,qa)));ka.resolve(Ua?0:1)}jlk(va){if(va.Values.interactive&&this.dmb&&this.dmb.Values.messageCorrelationId){const ka=this.dmb.Values.messageCorrelationId.toString();if(va.Values.interactive&&this.nY){this.nY.oEi.then(qa=>{this.gE.Veb(this.dmb,this.nY.jmh.contentWindow,this.haa);this.nY.qal(ka,qa);
this.nY.EAh(!0);this.dmb=null});return}}va=this.NLa.initFrame;const Fa=pa.a.pj()-va.startTime;h.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Fa);va.resolve(0)}Rhk(va){if(va.Values.messageCorrelationId&&va.Values.messageCorrelationId.toString()){var Fa=va.Values.messageCorrelationId.toString(),ka=this.NLa[Fa];if(ka){var qa=pa.a.pj()-ka.startTime;h.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",qa);va.Values.isSuccess&&
va.Values.isSuccess?ka.resolve(va.Values.response):ka.reject(va.Values.response);this.zxh(Fa)}else h.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}vik(){if(this.nY.pEi)this.nY.$3f();else if(this.zod&&this.nY){const va=new ea.a(da.a.mmh);va.Values=this.wGf(this.zod,!0);this.gE.Veb(va,this.nY.jmh.contentWindow,
this.haa)}}dik(){this.nY&&this.nY.T3d()}Ofk(va){va.Values.cancelled&&va.Values.cancelled&&va.Values.messageCorrelationId&&this.zxh(va.Values.messageCorrelationId.toString());this.nY&&this.nY.hide()}wGf(va,Fa=!1){const ka={};ka.appIds=this.fWi();ka.upn=va.loginHint;ka.authority=va.authority;ka.authorityType=Object(e.a)(r,va.authorityType);ka.tenantId=va.tenantId;ka.correlationId=u.AFrameworkApplication.userSessionId;ka.enableConsoleLogging=this.s0e;ka.enablePopupFlash=this.AJh;ka.skipUpnCheck=this.gUh;
ka.interactive=Fa;return ka}fWi(){const va=[],Fa=H.a.nHd;for(let ka in Fa)Array.add(va,Fa[ka]);return va}Kkd(va,Fa,ka,qa,Ua,Ya){const Va=new ea.a(da.a.B5k),ua=this.Sbg();Va.Values=this.Uwh(va,Fa,ka,qa,Ua,Ya,ua);this.nxf=Va;va=this.eid(ua);h.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Fa);this.g9k();return va}Did(){return!0}g9k(){this.vkb||(this.vkb=new Y.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,
null),this.vkb.id=16,this.vkb.p9d=!1,this.vkb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{h.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.gE.Veb(this.nxf,this.iA.contentWindow,this.haa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),u.AFrameworkApplication.Ba.jb.Ryc(this.vkb,!0)||h.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Uik(va){if(va.Values.messageCorrelationId&&
va.Values.messageCorrelationId.toString()){var Fa=this.NLa[va.Values.messageCorrelationId.toString()];if(Fa){var ka=pa.a.pj()-Fa.startTime;h.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ka);va.Values.isSuccess&&va.Values.isSuccess?Fa.resolve(va.Values.response):Fa.reject(va.Values.response)}else h.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(555049439,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}zxh(va){this.d0a&&this.d0a.correlationId===va&&(this.d0a.resolve(null),this.d0a=null)}}Object(J.a)(Ka,"SharedAuthTokenStrategy",null,[827]);class ma{constructor(va){this.Zzd=va;this.Llb="UnsupportedAuthTokenStrategy Reason="+m.a[this.Zzd]}initialize(){return Promise.resolve(0)}iVc(){return Promise.resolve(0)}p0(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:m.a[this.Zzd],ErrorMessage:"Unable to get a token. Reason: ["+
m.a[this.Zzd]+"]"}))}Kkd(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Did(){return!1}k0b(){return this.Llb}}Object(J.a)(ma,"UnsupportedAuthTokenStrategy",null,[827]);var ra=d(230);d.d(V,"OAuthManager",function(){return Da});class Da{constructor(va=null){this.p5=0;this.M0=null;this.h1a=0;const Fa=pa.a.pj();this.QLh=this.ODi(va).then(ka=>
ka?this.xtj():(h.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.fD(),Math.floor(pa.a.pj()-Fa)),ka=Z.a.oz(),void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.fD()),ka=Object.assign(new Ja.a,{durationMs:Math.floor(pa.a.pj()-Fa),extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Da.kpiName,"StrategyPickFailed",!1,!0,ka)),Promise.resolve(1))).then(ka=>0!==ka?Promise.resolve(ka):this.iRj())}PDi(){var va=H.a.Iak;
va&&0<va.length?(this.p5=1,this.M0=new A(va)):u.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||u.AFrameworkApplication.fa.ka("IsO365CommercialHost")?u.AFrameworkApplication.fa.ka("IsAnonymousUser")?(this.p5=2,this.M0=new ma(this.p5)):(va=x.a.getAuthContext().loginHint)&&va.length?H.a.l7a?(this.p5=1,this.M0=new Q):(this.p5=1,this.M0=new Ka):(this.p5=3,this.M0=new ma(this.p5)):(this.p5=4,this.M0=new ma(this.p5))}fD(){return this.M0?this.M0.k0b()||"Unknown":"None"}ODi(va=null){h.ULS.sendTraceTag(562128578,
3E3,50,"Creating OAuthManager.");const Fa=pa.a.pj();return u.AFrameworkApplication.fa.M1i().then(ka=>{ka?(this.PDi(),va&&(this.M0=va),h.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",H.a.clientVersion,H.a.appVersion,H.a.xGi,this.fD(),Math.floor(pa.a.pj()-Fa))):h.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(pa.a.pj()-Fa));return Promise.resolve(ka)},()=>{h.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(pa.a.pj()-Fa));return Promise.resolve(!1)})}xtj(){h.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.fD());const va=pa.a.pj();return y.get(this.M0.initialize(),2,H.a.Zze).then(Fa=>{if(0===Fa)h.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",
this.fD(),Math.floor(pa.a.pj()-va));else if(1===Fa){h.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.fD(),Math.floor(pa.a.pj()-va));var ka=Z.a.oz();void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.fD()),ka=Object.assign(new Ja.a,{durationMs:Math.floor(pa.a.pj()-va),extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Da.kpiName,"StrategyInitFailed",!1,!0,ka))}else 2===Fa&&(h.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.fD(),Math.floor(pa.a.pj()-va)),ka=Z.a.oz(),void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.fD()),ka=Object.assign(new Ja.a,{durationMs:Math.floor(pa.a.pj()-va),extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Da.kpiName,"StrategyInitTimedOut",!1,!0,ka)));return Promise.resolve(Fa)},()=>{h.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.fD(),Math.floor(pa.a.pj()-va));return Promise.resolve(1)})}iRj(){h.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.fD());const va=pa.a.pj();return y.get(this.M0.iVc(x.a.getAuthContext()),2,H.a.Zze).then(Fa=>{if(0===Fa)h.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.fD(),Math.floor(pa.a.pj()-va));else if(1===Fa){h.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.fD(),Math.floor(pa.a.pj()-va));var ka=Z.a.oz();void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.fD()),ka=Object.assign(new Ja.a,
{durationMs:Math.floor(pa.a.pj()-va),extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Da.kpiName,"StrategyLoadFailed",!1,!0,ka))}else 2===Fa&&(h.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.fD(),Math.floor(pa.a.pj()-va)),ka=Z.a.oz(),void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.fD()),ka=Object.assign(new Ja.a,{durationMs:Math.floor(pa.a.pj()-va),extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Da.kpiName,
"StrategyLoadTimedOut",!1,!0,ka)));return Promise.resolve(Fa)},()=>{h.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.fD(),Math.floor(pa.a.pj()-va));return Promise.resolve(1)})}p0(va,Fa,ka=null){return this.EIb(va,Fa,!1,null,"",ka)}Vwh(va,Fa,ka,qa,Ua=null){return this.EIb(va,Fa,!0,ka,qa,Ua)}EIb(va,Fa,ka,qa,Ua,Ya,Va=0){Va+=1;h.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
va,this.Ieb(va,Fa),this.fD(),Va);var ua=Z.a.oz();void 0!==ua&&null!==ua&&(ua.set("AuthLibrary",this.fD()),ua.set("AppName",va),ua.set("Target",this.Ieb(va,Fa)),oa.Health.instance.recordKpiUsage(Da.kpiName,0,"WacOAuthFC",ua));if(!H.a.isEnabled){var Ca;return this.$be((Ca=new v.a,Ca.IsSuccess=!1,Ca.Token=null,Ca.ErrorCode="NotEnabled",Ca.ErrorMessage="OAuthManager is disabled.",Ca),va)}const Ea=H.a.nHd[va];if(void 0===Ea||null===Ea){h.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
va);var wb;return this.$be((wb=new v.a,wb.IsSuccess=!1,wb.Token=null,wb.ErrorCode="DisallowedApp",wb.ErrorMessage="Disallowed appName: "+va,wb),va)}const Oa=pa.a.pj(),ab=this;ua=this.QLh.then(ob=>ab.hzj(va,Ea,Fa,ka,qa,Ua,Ya,ob));Ca=ka?0:H.a.Zze;let fb;wb=(fb=new v.a,fb.IsSuccess=!1,fb.Token=null,fb.ErrorCode="authTokenStrategy_timeout",fb.ErrorMessage="Auth Strategy timed out after ["+Ca+"] ms when fetching token",fb);let db=this,gc=this;return y.get(ua,wb,Ca).then(ob=>Va<=Da.t$j&&(ob.ErrorCode===
Da.fvh||ob.ErrorCode===Da.efl)?(h.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Va,Math.floor(pa.a.pj()-Oa)),db.EIb(va,Fa,ka,qa,Ua,Ya,Va)):ob.ErrorCode===Da.Exg&&!ka&&(h.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Va,Da.AYf),Da.HIi&&db.M0.Did()&&db.M0.Kkd(va,Ea,Fa,ka,qa,Ua).then(Sb=>Promise.resolve(db.xVc(Sb,va,Fa,Ea,Oa))).catch(()=>{let Sb;const Jb=(Sb=new v.a,Sb.IsSuccess=
!1,Sb.Token=null,Sb.ErrorCode="authTokenStrategy_failure",Sb.ErrorMessage="LoginPopup failed, GetToken could not be called",Sb);return Promise.resolve(db.xVc(Jb,va,Fa,Ea,Oa))}),Da.AYf)?db.EIb(va,Fa,!0,qa,Ua,Ya,Va):Promise.resolve(db.xVc(ob,va,Fa,Ea,Oa))).catch(()=>{let ob;const Sb=(ob=new v.a,ob.IsSuccess=!1,ob.Token=null,ob.ErrorCode="authTokenStrategy_failure",ob.ErrorMessage="Auth Strategy failed with an unknown error",ob);return Promise.resolve(gc.xVc(Sb,va,Fa,Ea,Oa))})}hzj(va,Fa,ka,qa,Ua,Ya,
Va,ua){return 1===ua||2===ua?this.$be(Object.assign(new v.a,{IsSuccess:!1,Token:null,ErrorCode:1===ua?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),va):this.M0.p0(va,Fa,ka,qa,Ua,Ya,Va).then(Ca=>Promise.resolve(this.TTg(Ca,!0,va))).catch(Ca=>Promise.resolve(this.TTg(Ca,!1,va)))}xVc(va,Fa,ka,qa,Ua){const Ya={};Ua=pa.a.pj()-Ua;Ya.IsSuccess=va.IsSuccess;Ya.ErrorCode=va.IsSuccess?"Success":va.ErrorCode||"";Ya.ErrorMessage=va.IsSuccess?"Success":this.Ieb(Fa,va.ErrorMessage||
"");Ya.Target=this.Ieb(Fa,ka||"");Ya.TimeInMS=Math.floor(Ua);Ya.AuthLibrary=this.fD();Ya.AppName=Fa;Ya.AuthorityType=Object(e.a)(r,x.a.rKc());Ya.UserType=this.Pej(x.a.getAuthContext());Ya.IsAuthSupportedInSession=m.a[this.p5];Ya.RequestCount=++this.h1a;Ya.AppId=qa;h.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Ya));va.IsSuccess||(ka=Z.a.oz(),void 0!==ka&&null!==ka&&(ka.set("AppName",Fa),ka.set("AuthLibrary",this.fD()),ka.set("ErrorCode",va.ErrorCode),ka.set("ErrorMessage",this.Ieb(Fa,va.ErrorMessage)),
Fa=Object.assign(new Ja.a,{durationMs:Ua,extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Da.kpiName,"TryGetTokenFailure",!1,!0,Fa)));return va}$be(va,Fa){h.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Fa,this.Ieb(Fa,va.ErrorMessage));const ka=Z.a.oz();void 0!==ka&&null!==ka&&(ka.set("AppName",Fa),ka.set("AuthLibrary",this.fD()),ka.set("ErrorCode",va.ErrorCode),ka.set("ErrorMessage",this.Ieb(Fa,va.ErrorMessage)),Fa=Object.assign(new Ja.a,
{extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Da.kpiName,"FailureBeforeGetToken",!1,!0,Fa));return Promise.resolve(va)}Csg(va){return va===ra.a.Hjd}Ieb(va,Fa){return this.Csg(va)&&Fa?"REDACTED":Fa}Pej(va){return u.AFrameworkApplication.fa.ka("IsAnonymousUser")?"anonymous":!va.loginHint||1>va.loginHint.length?"empty":-1<va.loginHint.indexOf("guest#")?"guest":-1<va.loginHint.indexOf("ext#")?"external":0>va.upn.indexOf("@")?"no-at":"supported"}nAj(){return 1===this.p5}TTg(va,Fa,ka){let qa=
null,Ua=null,Ya=null,Va=null;va?va.ErrorCode||va.ErrorMessage?(Ua=va.ErrorCode?va.ErrorCode:Da.v_f,Ya=va.ErrorMessage?va.ErrorMessage:"No message"):va.Token?Fa?qa=va.Token:(Ua=Da.mKk,Ya="A rejected promise returned a token."):(Ua=Da.v_f,Ya=JSON.stringify(va)):(Ua=Da.zck,Ya="No result came from Auth Token Strategy");va&&va.Telemetry&&!this.Csg(ka)&&(Va=va.Telemetry,h.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Va)));if(Ua===Da.Wak||Ua===Da.tkl)Ua=Da.fvh,Ya="Auth Library Timed Out";Ua===Da.h$h&&
-1<Ya.indexOf(Da.bXh)&&(Ua=Da.Exg);if(Ua||Ya)qa=null;return Object.assign(new v.a,{IsSuccess:!!qa,Token:qa,ErrorCode:Ua,ErrorMessage:Ya,Telemetry:Va})}static get AYf(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get HIi(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}Da.tkl="token_renewal_error";Da.v_f="Exception";Da.zck="NoResult";Da.mKk="RejectToken";
Da.Wak="monitor_window_timeout";Da.fvh="Timeout";Da.efl="authTokenStrategy_timeout";Da.h$h="login_required";Da.bXh="AADSTS50058";Da.Exg="Cookies Disabled";Da.kpiName="OAuthManager";Da.t$j=2;Object(J.a)(Da,"OAuthManager",null,[790])},670:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(1154),e=d(13),m=d(104),r=d(35),v=d(26),A=d(436),x=d(111);class y{constructor(u,H,G,E,I,Q){this.V0a=this.nEa=null;this.Kq=Object(h.a)(A.a,E.fPd(u,H,G,Object(e.a)(this,this.iC,"onPointerOver"),Object(e.a)(this,
this.Oy,"onPointerOut"),I));this.rFa=0;this.Oc=Q;this.Oc.wB(Object(e.a)(this,this.ZA,"onSessionEnd"));this.clear()}dispose(){this.Kq.dispose();this.nEa=null}get Nda(){return this.V0a}setZIndex(u){this.Kq.setZIndex(u)}fBf(u,H,G){this.V0a=u;this.nEa=H;this.Kq.Cfd("UnreadNotification_16x16x32",this.Nda,G)}clear(){this.Kq.clear();this.V0a=x.a.none}ywa(){this.gZ();this.Kq.v2a(this.Nda,this.mXb);this.Kq.ubc()}gZ(){this.Kq.Iob();this.Kq.KEb()}ZA(){v.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",
this.rFa);0<this.rFa&&m.c(r.a.eLd)}get mXb(){return this.nEa?this.nEa():""}iC(){this.ywa();v.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.rFa+=1;return!0}Oy(){this.gZ();return!0}}Object(J.a)(y,"ShapeRevisionTrackingPawn",null,[260])},671:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";
e[e.hostUnsupported=4]="hostUnsupported"})(h||(h={}));Object(J.b)("SupportStatus",h)},672:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m,r,v,A,x,y,u=null,H=null,G=!1,E=null,I=null,Q=null,D=null,Y=!1,M=null,N=null,W=null,K=null,ca=null,P=null){this.url=e;this.ywl=m;this.body=r;this.headers=v;this.tKe=A;this.priority=x;this.state=y;this.ICh=u;this.Xdh=H;this.Ui=G;this.sBk=E;this.bYk=I;this.name=Q;this.qCb=D;this.gWd=Y;this.Cwe=M;this.iy=N;this.Otb=W;this.HEb=K;this.wqj=
ca;this.responseType=P}}Object(J.a)(h,"ClientRequest",null,[])},673:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(511);var h=d(128);class e extends V.a{constructor(){super();this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.jl()})}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static jl(){return["AugLoop_Core_Operation"]}}Object(J.a)(e,"UpdateOperation",V.a,[])},706:function(J,V,d){J=d(0);class h{}Object(J.a)(h,"AuthContext",null,[]);var e=d(25),m=d(259);d.d(V,"a",function(){return r});
class r{static getAuthContext(){const v=e.AFrameworkApplication.fa.Ia("UserPrincipalName")||"";let A=v;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(A=m.a.Rdk||v);return Object.assign(new h,{upn:v,loginHint:A,authority:m.a.authority,authorityType:r.rKc(),tenantId:e.AFrameworkApplication.fa.Ia("TenantId")||""})}static rKc(){let v=0;const A=r.R5f();"aad"===A.toLowerCase()?v=2:"msa"===A.toLowerCase()&&(v=1);return v}static R5f(){return e.AFrameworkApplication.fa.Ia("HostAuthType")||
""}}Object(J.a)(r,"OAuthIdentity",null,[])},714:function(J,V,d){J=d(0);var h=d(25),e=d(114),m=d(79),r=d(13),v=d(33),A=d(86),x=d(26),y=d(257);class u{constructor(){this.TenantId=this.LoggableUserId=this.FileSource=this.ProviderId=this.UserId=this.UserName=null;this.EnableMacrosForProtectedFile=this.BrowserCacheAllowed=!1;this.ComplianceDomainPrefix=this.ServerDocId=null;this.IsCLPCoauthoringEnabled=this.IsO365CommercialHost=this.IsO365ConsumerHost=!1}}Object(J.a)(u,"PodsInfo",null,[]);var H=d(52);
d.d(V,"a",function(){return G});class G{constructor(E,I,Q,D,Y,M,N){x.a.J(36197340,804,50,"Start PodsInfoSender::PodsInfoSender()");this.kc=N;this.Dz=E;this.Za=I;this.Oc=Q;this.Ey=D;this.Wd=Y;this.Bb=M;this.Uxb=!1;this.qUa=0;this.kc.gf(Object(r.a)(this,this.initialize,"initialize"))}initialize(){x.a.J(36197342,804,50,"Start PodsInfoSender::Initialize()");this.sendInfoToPods(null);this.Oc.xB(Object(r.a)(this,this.eo,"onSessionRehydrated"));this.Ey.Hmb(Object(r.a)(this,this.Cda,"onPodSessionRefreshed"));
this.Uxb=!0}dispose(){this.Uxb&&(this.Oc.cea(Object(r.a)(this,this.eo,"onSessionRehydrated")),this.Ey.ieb(Object(r.a)(this,this.Cda,"onPodSessionRefreshed")),this.Uxb=!1)}sendInfoToPods(){var E=this.kc.Ia(H.a.pa(361)),I=this.Za.podSessionId;const Q=this.Za.qk,D=h.AFrameworkApplication.userSessionId,Y=e.a.create().toString();x.a.J(36197344,804,50,"PodsInfoSender.SendInfoToPods: Send user info to Pods, correlation={0}",Y);E=String.format("{0}PodHandler.ashx?action=SendUserInfo&PodSID={1}",E,I);I={"Content-Type":"application/json; charset=utf-8",
WaitForSessionTimeoutMs:"0"};I["X-UserSessionId"]=D;I["X-CorrelationID"]=Y;I["X-WacCluster"]=Q;try{const M=Object.assign(new u,{UserName:this.kc.Ia(A.a.dqk),UserId:this.kc.Ia(H.a.pa(387)),ProviderId:this.kc.Ia(H.a.pa(388)),FileSource:this.kc.Ia("FileSource"),LoggableUserId:this.kc.Ia("LoggableUserId"),TenantId:this.kc.Ia("TenantId"),BrowserCacheAllowed:this.kc.ka(H.a.pa(535))&&this.kc.ka(H.a.pa(431)),EnableMacrosForProtectedFile:h.AFrameworkApplication.YXb,ServerDocId:this.kc.Ia("ServerDocId"),ComplianceDomainPrefix:h.AFrameworkApplication.fa.Ia("ComplianceDomainPrefix"),
IsO365CommercialHost:this.kc.ka("IsO365CommercialHost"),IsO365ConsumerHost:this.kc.ka("IsO365ConsumerHost"),IsCLPCoauthoringEnabled:this.kc.ka("PPTClpSwitchEnabled")&&this.kc.ka("SupportsOfficeClientCoauthoring")}),N=v.c(M);this.Dz.Jj(E,2,N,I,!1,1,Object(r.a)(this,this.rlk,"onSendUserInfoSucceeded"),Object(r.a)(this,this.qlk,"onSendUserInfoFailed"),null,void 0,void 0,void 0,void 0,y.a("6"))}catch(M){x.a.J(36197346,804,15,"PodsInfoSender.SendInfoToPods: error serializing user info {0}",M)}}rlk(){x.a.J(36197376,
804,50,"PodsInfoSender.OnSendUserInfoSucceeded");this.qUa=0}qlk(){x.a.J(36197378,804,50,"PodsInfoSender.OnSendUserInfoFailed");3>this.qUa?this.KSk():this.qgj()}KSk(){this.qUa++;x.a.J(36197380,804,50,"PodsInfoSender.RetryRequestOnFailure: Request failed - retrying (failures count: {0})",this.qUa);const E=new m.a(1,1,5E3,Object(r.a)(this,this.sendInfoToPods,"sendInfoToPods"),90,"22");this.Bb.Hb(E)}qgj(){x.a.J(36197382,804,15,"PodsInfoSender.GiveUp: Request failed - giving up (failures count: {0})",
this.qUa);this.Wd.YH(307,null);this.qUa=0}eo(){this.qUa=0;x.a.J(36197384,804,50,"PodsInfoSender.OnSessionRehydrated");this.sendInfoToPods(null)}Cda(){this.qUa=0;x.a.J(36197386,804,50,"PodsInfoSender.OnPodSessionRefreshed");this.sendInfoToPods(null)}}Object(J.a)(G,"PodsInfoSender",null,[])},937:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.handler=null}}Object(J.a)(h,"SetAnnotationResultCallbackParameters",null,[])},996:function(J,V,d){J=d(0);var h;(function(m){m[m.multipleBrowsersImageClassName=
0]="multipleBrowsersImageClassName";m[m.peopleImageClassName=1]="peopleImageClassName";m[m.peopleImageClusterPath=4]="peopleImageClusterPath";m[m.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";m[m.imageDimension=6]="imageDimension";m[m.rtl=8]="rtl";m[m.pointerInputManager=9]="pointerInputManager";m[m.clickInputManager=10]="clickInputManager";m[m.vertical=11]="vertical";m[m.zIndex=12]="zIndex";m[m.contextMenuInputManager=13]="contextMenuInputManager";m[m.imageDomElement=14]="imageDomElement";
m[m.useIdleTooltip=15]="useIdleTooltip";m[m.viewportBoundsCallback=16]="viewportBoundsCallback";m[m.flipHorizontalDirection=17]="flipHorizontalDirection";m[m.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";m[m.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";m[m.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||(h={}));Object(J.b)("PresenceTooltipSettingKeys",h);d.d(V,"a",function(){return e});class e{constructor(){this.Yx={}}get(m,r=null){m=h[m];return"number"===
typeof r?(r=this.Yx[m])?Number.parseInvariant(r.toString()):0:this.Yx[m]}add(m,r){this.Yx[h[m]]=r}UC(m,r){h[m]in this.Yx||(this.Yx[h[m]]=r)}remove(m){delete this.Yx[h[m]]}}Object(J.a)(e,"PresenceTooltipSettings",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.chronosslim.js.map