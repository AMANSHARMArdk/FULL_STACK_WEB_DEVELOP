'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1199:function(J,V,d){d.r(V);J=d(0);var h=d(13);class e{constructor(eb,$a){this.Lya=null;this.tPb=eb;this.PQh=$a}init(){this.tPb.continueWith(()=>{this.Lya=this.tPb.result;this.Lya.Lmb(Object(h.a)(this,this.aX,"onUsersUpdated"))})}aX(){e.JFf(this.Lya.H5a())&&(this.Lya.Icd(Object(h.a)(this,this.aX,"onUsersUpdated")),this.PQh.IsRealCoauthSession=!0)}static JFf(eb){let $a=null;for(const vb of eb)if(vb)if(eb=vb.isAnonymous||
!vb.email?vb.clientId:vb.email.toUpperCase(),!$a)$a=eb;else if($a!==eb)return!0;return!1}}Object(J.a)(e,"CoauthTelemetry",null,[1033]);var m=d(374),r=d(1019),v=d(1154),A=d(25),x;(function(eb){eb[eb.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";eb[eb.notImplemented=1]="notImplemented";eb[eb.renderHandled=2]="renderHandled";eb[eb.renderHandledWithVeto=3]="renderHandledWithVeto"})(x||(x={}));Object(J.b)("CoauthorGalleryTelemetryEndResult",x);var y=d(95),u=d(105),H=d(2);class G{constructor(eb,
$a,vb,bc,Cc,Gc,sd,Sd,ie){this.kgf=this.OXe=this.JJ=null;this.wna=eb;this.Vwc=new r.a;this.mb=vb;this.Mpd=$a;this.$ea=bc;this.oi=Cc;this.fzd=Gc;this.JLa=sd;this.aGh=Sd;this.K3e=this.H3e=!1;this.Exc=0;this.LXe=1;this.OZa=ie;this.ERb=this.mb.ka("PeoplesWellExtraButtonInfoIsEnabled");this.gib=Object(v.a)(String,A.AFrameworkApplication.Zc.Application)||""}get Erh(){return this.Vwc.task}init(){H.Task.WAA.call(null,this.JLa,this.Mpd,this.fzd).continueWith(()=>{this.JJ=this.JLa.result;this.OXe=this.Mpd.result;
this.kgf=this.fzd.result;H.Task.WAA.call(null,this.Mpd.result.gAa,this.fzd.result.Ojd).continueWith(()=>{this.LXe=this.OXe.gAa.result;this.Exc=this.kgf.Ojd.result;this.JJ.Lmb(Object(h.a)(this,this.D8c,"onUsersUpdatedEventListener"));this.JJ.H5a().length&&this.aX()})})}D8c(){this.aX()}aX(){this.aGh(this.JJ.H5a())?(this.JJ.Icd(Object(h.a)(this,this.D8c,"onUsersUpdatedEventListener")),this.phk(this.H3e)):this.Vwc.VL(1);this.H3e=!0}phk(eb){this.K3e?this.Erh.continueWith(()=>{m.ULS.sendTraceTag(42062996,
325,15,"We already attempted to log a render of coauthor gallery: {0}",x[this.Erh.result])}):(this.K3e=!0,this.dzk(0===this.LXe&&!eb))}dzk(eb){eb?this.$ea.Ak(4,Object(h.a)(this,this.bve,"onInteractiveReady")):this.Vwc.VL(1)}bve(){const eb=this.oi.Rg("AppInitStatus_interactivityReady");m.ULS.shipAssertTag(42259235,325,!!this.Exc);const $a=this.Exc-eb,vb={};vb.InteractiveTime=eb;vb.ReactRenderComplete=this.Exc;vb.HadTabSwitch=this.OZa();vb.IsModernGallery=this.ERb;m.ULS.sendTraceTag(594883104,325,50,
u.a.toJSON(vb));this.ERb?(m.ULS.sendTraceTag(42062997,325,15,$a.toString()),this.Vwc.VL(this.Hwl($a)?3:2)):m.ULS.sendTraceTag(594883103,325,15,$a.toString())}Hwl(eb){const $a=eb>this.mb.Gc("CoauthorGalleryTimeToRenderDurationMs",1E4),vb="Word"===this.gib;if(this.OZa())return m.ULS.sendTraceTag(50455714,325,50,$a.toString()),!1;vb&&y.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);$a&&(vb&&y.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded",
"CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),m.ULS.sendTraceTag(42062998,325,15,eb.toString()));return $a}}Object(J.a)(G,"CoauthorGalleryTelemetry",null,[1032]);class E{constructor(eb){this.JJ=null;this.tpc={};this.avc={};this.eNb=null;this.JLa=eb}GMc(eb){const $a=new r.a;this.init().continueWith(()=>{eb in this.tpc?$a.VL(this.tpc[eb]):this.avc[eb]=$a});return $a.task}init(){if(this.eNb)return this.eNb.task;this.eNb=new r.a;this.JLa.continueWith(()=>{this.JJ=this.JLa.result;this.JJ.Lmb(Object(h.a)(this,
this.aX,"onUsersUpdated"));this.AAh();this.eNb.Ig(null)});return this.eNb.task}AAh(){const eb=this.JJ.H5a();eb.sort(Object(h.a)(this,this.ioi,"comparePresenceUsers"));this.tpc={};for(let $a=0;$a<eb.length&&eb[$a]&&eb[$a].ADa;$a++)this.s_h(this.tpc,eb[$a].clientId,$a)}s_h(eb,$a,vb){eb[$a]=vb;$a in this.avc&&(this.avc[$a].VL(vb),delete this.avc[$a])}aX(){this.AAh()}ioi(eb,$a){return eb.ADa>$a.ADa?1:eb.ADa<$a.ADa?-1:0}}Object(J.a)(E,"CoauthorPositionFinder",null,[1031]);var I=d(17),Q=d(197);class D{constructor(eb,
$a,vb,bc){this.Lya=null;this.krd=this.xxd=!1;this.Kbf=0;this.tPb=eb;this.PCd=$a;this.mb=vb;this.yxd=bc;this.IFh=A.AFrameworkApplication.yhb||A.AFrameworkApplication.XP}get zFc(){return this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}init(){this.tPb.continueWith(()=>{this.Lya=this.tPb.result;this.Lya.Lmb(Object(h.a)(this,this.aX,"onUsersUpdated"))})}aX(){this.mni(this.Lya.H5a());!this.xxd||this.zFc&&!this.krd||this.Lya.Icd(Object(h.a)(this,this.aX,"onUsersUpdated"))}mni(eb){const $a=
new I.a;let vb=0;for(const bc of eb)if(bc&&bc.isAnonymous){A.AFrameworkApplication.M5b("70eb6120;2gfeb930");if(this.zFc&&!this.krd)if($a.contains(bc.userName)){const Cc=this.Zdj(eb);m.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected among {0} total guest coauthors",Cc);this.krd=!0}else $a.add(bc.userName);bc.clientId!==this.yxd&&(vb++,2<=vb&&!this.xxd&&this.LUj())}this.zFc&&this.Kbf!==vb&&(m.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",vb+(this.IFh?1:0)),
this.Kbf=vb)}LUj(){m.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.xxd=!0;this.zFc&&this.PCd&&this.PCd.continueWith(()=>{window.setTimeout(()=>{this.PCd.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}Zdj(eb){return Q.a.Xa(eb)?0:Q.a.tna(eb,$a=>$a.isAnonymous).length}}Object(J.a)(D,"GuestCoauthTelemetry",null,[]);var Y=d(1153);class M{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(J.a)(M,"PL",
null,[]);var N=d(33);class W{constructor(){this.ct=this.vt=this.d=0}static oih(eb,$a,vb){const bc=new W;bc.d=eb;bc.vt=$a;bc.ct=vb;return N.c(bc)}}Object(J.a)(W,"VD",null,[]);var K=d(88);class ca{constructor(eb,$a,vb,bc,Cc,Gc,sd,Sd,ie){this.Etf=!1;this._id=eb;this.Bj=$a;this.Us=vb;this.zxd=bc;this.sDd=Cc;this.i2a=Gc;this.i_a=sd;this.qHh=Sd;this.OZa=ie;this.gib=Object(v.a)(String,A.AFrameworkApplication.Zc.Application)||""}xmd(eb){H.Task.WAA(this.zxd,this.sDd).continueWith(()=>{if(this.zxd.result<=
this.sDd.result)eb.VL(!1);else{var $a=this.Us-this.Bj,vb=new M;vb.id=this._id;vb.et=this.Us;vb.st=this.Bj;vb.d=this.Us-this.Bj;vb.mp=this.zxd.result;vb.tp=this.sDd.result;vb.ct=this.LXi(this.qHh);vb.vc=this.OZa();var bc=N.c(vb),Cc="Word"===this.gib;m.ULS.sendTraceTag(42078597,302,15,bc);if(Cc){const Gc=new Map;Gc.set("data",bc);y.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",Gc)}$a>this.i2a.value&&!this.Etf&&!vb.vc&&(this.Etf=!0,eb.VL(!0),vb=Object.assign(new K.a,{inStaging:!0,
extendedProperties:new Map}),vb.extendedProperties.set("data",bc),Cc&&y.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,vb),$a<this.i_a.value&&m.ULS.sendTraceTag(42078598,302,15,W.oih($a,this.i2a.value,this.i_a.value)));eb.task.isCompleted||eb.VL(!1)}})}LXi(eb){switch(eb){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(J.a)(ca,"PresenceLatencyActivityLogger",null,[]);class P{constructor(eb,$a,vb){this.VWe=
this.KXe=this.gpc=this.spc=this.cib=0;this._id=eb;this.i2a=$a;this.i_a=vb;this.gib=Object(v.a)(String,A.AFrameworkApplication.Zc.Application)||""}get lDf(){return this.cib}set lDf(eb){this.cib=eb;this.zLd()}get HNf(){return this.spc}set HNf(eb){this.spc=eb;this.zLd()}get ZKf(){return this.gpc}set ZKf(eb){this.gpc=eb;this.zLd()}get INf(){return 0!==this.KXe}get $Kf(){return 0!==this.VWe}zLd(){!this.INf&&this.cib&&this.spc&&(this.KXe=this.xmd(this.spc,"CoauthGalleryLightupDurationTooLong"));!this.$Kf&&
this.cib&&this.gpc&&(this.VWe=this.xmd(this.gpc,"CanvasPresenceLightupDurationTooLong"))}xmd(eb,$a){const vb=eb-this.cib;var bc=new M;bc.id=this._id;bc.et=eb;bc.st=this.cib;bc.d=vb;var Cc=N.c(bc);eb="Word"===this.gib;bc="CanvasPresenceLightupDurationTooLong"===$a?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===$a?m.ULS.sendTraceTag(572289499,302,15,Cc):m.ULS.sendTraceTag(571524118,302,15,Cc);if(eb){var Gc=new Map;Gc.set("data",Cc);y.Health.instance.recordKpiUsage(bc,
0,"wordcollabrel",Gc)}return vb>this.i2a.value?(Gc=Object.assign(new K.a,{inStaging:!0,extendedProperties:new Map}),Gc.extendedProperties.set("data",Cc),Cc=vb<this.i_a.value,Gc.extendedProperties.set("cash",Cc?"true":"false"),eb&&y.Health.instance.recordKpiFailure(bc,$a,!1,!0,Gc),m.ULS.sendTraceTag(572289500,302,15,W.oih(vb,this.i2a.value,this.i_a.value)),Cc?2:1):3}}Object(J.a)(P,"PresenceLightupLatencyLogger",null,[]);var ea=d(282),da=d(279);class ia{constructor(eb,$a,vb,bc,Cc,Gc,sd=null,Sd=null,
ie=null){this.Qpf={};this.Lpd={};this.Maf=new I.a;this.fNb=this.JJ=this.iwc=null;this.hvf=this.fvf=0;this.i2a=new Y.a(()=>sd.xP("PresenceBootLatencyThreshold",1E4));this.i_a=new Y.a(()=>sd.xP("PresenceBootLatencyCutoffThreshold",6E4));this.HWh=new Y.a(()=>sd.xP("PresenceLightupLatencyThreshold",2E3));this.wIh=new Y.a(()=>sd.xP("PresenceLightupLatencyCutoffThreshold",1E4));this.RQh=bc;this.MXe=eb;this.osf=$a;this.JLa=vb;this.oi=Cc;this.yxd=Sd;this.OZa=Gc;this.zf=ie;this.mWe=!1;this.init()}hJi(eb,$a=
0){var vb=new Date;const bc=new r.a;this.init().continueWith(()=>{this.ikk(eb);this.iJi(bc,eb,vb,$a)})}get iTg(){return this.yxd||"{"+A.AFrameworkApplication.userSessionId+"}"}init(){if(this.fNb)return this.fNb.task;this.fNb=new r.a;this.OZa()&&m.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.MXe.continueWith(()=>{const eb=this.MXe.result,$a=eb.gAa,vb=eb.d5c;vb.continueWith(()=>{$a.continueWith(()=>{this.zf&&this.zf.addQosPillar("RealTimeCoauth");this.vel($a.result,vb.result);this.fNb.Ig(null)})})});
this.osf.continueWith(()=>{this.iwc=this.osf.result;this.iwc.B2a(Object(h.a)(this,this.Wkk,"onRtcConnection"));this.iwc.Eza(Object(h.a)(this,this.Ufk,"onCoauthorBootReceived"))});this.JLa.continueWith(()=>{this.JJ=this.JLa.result;this.JJ.Lmb(Object(h.a)(this,this.D8c,"onUsersUpdatedEventListener"));0<this.JJ.H5a().length&&this.aX()});return this.fNb.task}P6f(){return this.oi.qn(ea.a.xhb)?this.oi.Rg(ea.a.xhb):da.a.Uza?window.performance.timing.fetchStart:-1}Wkk(eb,$a){this.mWe||2!==$a.newState||(eb=
this.P6f(),eb=Date.now()-eb,$a={},$a.clientId=this.iTg,$a.bootTime=eb,this.mWe=!0,this.iwc.kea(15,$a))}Ufk(eb,$a){if(15===$a.type){eb=Date.now();$a=$a.rxa;var vb=$a.bootTime;this.uZd($a.clientId).lDf=eb-vb}}D8c(){this.aX()}aX(){const eb=Date.now();var $a=this.JJ.H5a();const vb=new I.a;for(const bc of $a)this.Maf.contains(bc.clientId)||(this.Maf.add(bc.clientId),vb.add(bc.clientId));if(0<vb.count)for(let bc of vb)$a=this.uZd(bc),$a.INf||($a.HNf=eb)}ikk(eb){eb=this.uZd(eb);eb.$Kf||(eb.ZKf=Date.now())}uZd(eb){return eb in
this.Lpd?this.Lpd[eb]:this.Lpd[eb]=new P(eb,this.HWh,this.wIh)}vel(eb,$a=0){this.fvf=eb;this.hvf=$a?$a:(new Date).getTime()}iJi(eb,$a,vb,bc){vb=vb?vb.getTime():(new Date).getTime();$a in this.Qpf?eb.s0():(bc=new ca($a,this.Hbj(),vb,this.GMc(this.iTg),this.GMc($a),this.i2a,this.i_a,bc,this.OZa),this.Qpf[$a]=bc,bc.xmd(eb))}Hbj(){return 1===this.fvf?this.hvf:this.P6f()}GMc(eb){return this.RQh.GMc(eb)}}Object(J.a)(ia,"PresenceBootTelemetry",null,[1007]);var C=d(177),oa=d(69),Z=d(332),pa=d(57),ya=d(286);
class Ja{get name(){return"Common.App.CoauthTelemetry"}Yb(eb){eb.register(e,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").ma().na(()=>new e(ya.a.su(eb.Oa("Common.IPeopleInfoProvider")),A.AFrameworkApplication.Qg));eb.register(G,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").ma().na(()=>new G(A.AFrameworkApplication.Va,ya.a.su(eb.Oa("Common.ICoauthoringTelemeryInfoProvider")),A.AFrameworkApplication.fa,
C.a.get_instance(),Z.a.instance,ya.a.su(eb.Oa("Common.IPeoplesWell")),ya.a.su(eb.Oa("Common.IPeopleInfoProvider")),e.JFf,()=>this.QHf()));eb.register(ia,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").ma().na(()=>new ia(ya.a.su(eb.Oa("Common.ICoauthoringTelemeryInfoProvider")),ya.a.su(eb.Oa("Common.IRealtimeChannelBasic")),ya.a.su(eb.Oa("Common.IPeopleInfoProvider")),eb.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),Z.a.instance,
()=>this.QHf(),A.AFrameworkApplication.fa,null,y.Health.instance));eb.register(E,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").ma().na(()=>new E(ya.a.su(eb.Oa("Common.IPeopleInfoProvider"))));eb.register(D,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").ma().na(()=>new D(ya.a.su(eb.Oa("Common.IPeopleInfoProvider")),ya.a.su(eb.Oa("Common.ISystemInitiatedFeedback")),A.AFrameworkApplication.fa,"{"+A.AFrameworkApplication.userSessionId+
"}"))}init(){A.AFrameworkApplication.fa.gf(()=>{pa.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();pa.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();A.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&pa.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();A.AFrameworkApplication.fa.ka("CashTelemetryIsEnabled")&&(pa.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),pa.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})}dispose(){}QHf(){return da.a.Uza&&
Z.a.instance.qn(ea.a.wnc)?0<Z.a.instance.Rg(ea.a.wnc)[ea.a.Bmd]:!1}static main(){oa.a.instance.Ec(new Ja)}}Object(J.a)(Ja,"CoauthTelemetryPackage",null,[2,3]);var Ka=d(262),ma=d(1159),ra=d(231),Da=d(465);class va{constructor(eb,$a,vb,bc,Cc){this.Ic=eb;this._clientId=$a;this.XIh=Cc;this.WKh=vb||(()=>null);this.XKh=bc||(()=>null)}get id(){return this.Ic.id}get yyc(){return this.Ic.yyc}get Cyc(){return this.Ic.Cyc}get Byc(){return this.Ic.Byc}get Ayc(){return this.Ic.Ayc}get zyc(){return this.Ic.zyc}get Eyc(){return this.Ic.Eyc}get YEd(){return this.Ic.YEd}get UGb(){return this.Ic.UGb}get Ahd(){return this.Ic.Ahd}get t5c(){return this.Ic.t5c}get clientId(){return this._clientId}get Ara(){return this.WKh}get t2(){return this.XKh}get vFi(){return this.XIh}static createInstance(eb,
$a,vb,bc,Cc=!1){return new va(eb,$a,vb,bc,Cc)}}Object(J.a)(va,"PeoplesWellSettings",null,[]);var Fa=d(26);class ka{constructor(eb){this.sj=eb}get gAa(){return this.sj.gAa}get d5c(){return this.sj.d5c}}Object(J.a)(ka,"CoauthoringTelemetryInfoProvider",null,[696]);var qa=d(896),Ua=d(78),Ya=d(115),Va=d(758),ua=d(565);class Ca{constructor(eb,$a,vb,bc,Cc){this.wAb=new Ua.a;this.Iy=null;this.sj=eb;this.Pab=vb;this.zG=bc;this.zG.gGd(Object(h.a)(this,this.L6c,"onEditorTableUpdate"));this.fZj=A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
this.Ene=Cc;$a&&$a.execute(Gc=>{this.Iy=Gc})}dispose(){this.wAb&&(Ya.a.jed([this.wAb]),this.wAb=null);this.zG.Bbh(Object(h.a)(this,this.L6c,"onEditorTableUpdate"))}Lmb(eb){this.wAb.addHandler("UsersUpdatedEvent",eb)}Icd(eb){this.wAb.removeHandler("UsersUpdatedEvent",eb)}H5a(){return this.z5f(!1)}PVi(){return this.z5f(!0)}z5f(eb){const $a=[];this.sj.lhb(this.sj.gC).returnValue||Fa.a.J(50440398,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",this.sj.gC);var vb=
null;this.Iy&&(vb=this.Iy.iKc());const bc=this.Ene.w8f();let Cc=!1;for(const Gc of this.sj.UY)eb&&Ca.HAc(bc,Gc.EmailAddress)?Cc=!0:Array.add($a,this.Zxi(Gc,vb));vb={};vb.fExcludeCurrent=eb;vb.fCurrentExcluded=Cc;vb.CurrentID=this.sj.gC;vb.EditorCount=this.sj.UY.length;vb.IsRtcNull=!this.Iy;vb.UserCount=$a.length;Fa.a.J(50642948,814,50,"PeopleInfoProvider::GetAllUsers:{0}",N.c(vb));return $a}Zxi(eb,$a){const vb=this.Pab.iCa(new qa.a(eb.EmailAddress,void 0,eb.Name),eb.ColorIndex,eb.ID,1),bc=new Va.a;
bc.xXa(0);let Cc=0,Gc=!1,sd=!1;if($a&&eb.ID in $a){bc.xXa(1);if(this.fZj){const Sd=$a[eb.ID];Sd&&Sd.capabilities&4&&bc.xXa(4);Gc=!0;Sd&&(Cc=Sd.capabilities,sd=Sd.isAnonymous)}delete $a[eb.ID]}Fa.a.J(50440404,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities: {6}; fIssuserinrtc: {7}; isAnonymous: {8}",eb.ID,vb,bc.Gba(1),bc.Gba(4),this.sj.gC,
!eb.EmailAddress,Cc,Gc,sd);return new ua.a(eb.ID,eb.Name,vb,bc,null,eb.EmailAddress,void 0,void 0,sd,void 0,void 0,eb.JoinCoauthTime)}L6c(){Fa.a.J(50440406,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.wAb.raiseEvent("UsersUpdatedEvent",this)}static HAc(eb,$a){return!!eb&&!!$a&&eb.toLowerCase()===$a.toLowerCase()}}Object(J.a)(Ca,"PeopleInfoProvider",null,[1111]);var Ea=d(79),wb=d(220),Oa=d(133),ab=d(340),fb=d(289);class db extends wb.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=
!1;this.ImageUrl=null;this.CanJump=this.ActiveStatus=!1;this.Upn=null}get ControlType(){return 5}}Object(J.a)(db,"PeopleButtonProps",wb.a,[]);var gc=d(743),ob=d(45),Sb=d(114),Jb=d(1156),Ab=d(67);class lc{constructor(eb){this.znc=new Ab.a;this.RPd=null;this.clientId=eb}b4k(eb){this.FKk();this.RZk(eb);for(const $a of eb)$a.clientId!==this.clientId&&this.FBf($a)}get imd(){const eb=[];for(let $a of this.znc.values){const vb=this.Fhh($a);Array.add(eb,vb)}return eb}get Sua(){return this.znc.count}$Fd(eb,
$a){eb=eb.toUpperCase();let vb;({value:vb}=this.znc.Nf(eb)).returnValue||(vb=[],this.znc.$(eb,vb));Array.add(vb,$a)}FKk(){this.znc=new Ab.a}RZk(eb){for(const $a of eb)if($a.clientId===this.clientId){this.RPd=$a;break}}}Object(J.a)(lc,"UserTracker",null,[1663]);class Mc extends lc{constructor(eb,$a){super(eb);this.YKh=$a}FBf(eb){eb.isAnonymous||!eb.email?this.$Fd(eb.clientId,eb):this.RPd&&Jb.a.rt().equals(this.RPd.email,eb.email)||this.$Fd(eb.email,eb)}Fhh(eb){let $a=new Date(0),vb=0<eb.length?eb[0]:
null;for(const bc of eb)(eb=this.YKh(bc.clientId))&&$a.getTime()<eb.Gvb.getTime()&&($a=eb.Gvb,vb=bc);return vb}}Object(J.a)(Mc,"UniqueUserTracker",lc,[]);class Jc extends lc{constructor(eb){super(eb)}FBf(eb){this.$Fd(eb.clientId,eb)}Fhh(eb){return eb[0]}}Object(J.a)(Jc,"UserInstanceTracker",lc,[]);const rb=(eb,$a,vb)=>vb?new Mc(eb,$a):new Jc(eb);var cc=d(70),jb=d(655),Xb=d(35);class yb{constructor(eb,$a=null,vb=null){this.JJ=null;this.wDd=new r.a;this.Ic=eb;this.z9c=$a;vb&&vb.continueWith(()=>{this.JJ=
vb.result;this.JJ.Lmb(Object(h.a)(this,this.aX,"onUsersUpdated"));this.Tbd()});new ua.a(this.settings.clientId,"Anonymous user","#cccccc",new Va.a(7));this.URc=this.vvd=!0;this.Ysd=this.ezd=!1;this.z0=rb(this.settings.clientId,this.settings.t2,eb.vFi)}get settings(){return this.Ic}get LBj(){return A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.ka("ColorPresenceHashIsEnabled"):!1}get Tqg(){return A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled"):
!1}aZi(){let eb;let $a,vb,bc,Cc;var Gc=this.bZi();this.z0.Sua?1===this.z0.Sua?($a=!0,vb=this.settings.UGb.cluster,bc=this.settings.UGb.mFc,Cc=this.z0.imd[0].color):($a=!0,vb=this.settings.t5c.cluster,bc=this.settings.t5c.mFc,Cc=""):($a=!1,Cc=bc=vb="");eb=Gc[0];Gc=Gc.slice(1);return{zok:eb,Aok:Gc,vok:$a,GAl:vb,xok:bc,wok:Cc}}bZi(){if(2<=this.z0.Sua)return[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.z0.Sua)];if(1===this.z0.Sua){const eb=this.z0.imd[0],$a=this.settings.t2(eb.clientId);
return $a&&2===$a.status?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,eb.userName]:[eb.isReadOnly?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,eb.userName]}return[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself]}Nej(eb){return this.Oej(eb)}vKf(eb,$a,vb){return $a?this.mhi($a)?(eb=this.settings.t2(eb))&&2===eb.status?!1:!0:(vb&&m.ULS.sendTraceTag(4482394,325,50,"User has presence data but app can't use it"),!1):(vb&&m.ULS.sendTraceTag(4482393,
325,50,"User does not have any presence data"),!1)}Lbj(eb){return eb.isReadOnly?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}Oej(eb){if(!eb.capabilities.Gba(1))return this.Lbj(eb);const $a=eb.isReadOnly,vb=this.settings.t2(eb.clientId);eb=this.settings.Ara(eb.clientId);if(!vb)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(vb.status){case 1:return eb?$a?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline:this.$si(eb)||
CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}M2i(eb){if(this.z9c.lae)return this.z9c.qWb(eb.email,"O365",A.AFrameworkApplication.$g,0)}Cej(eb){eb=this.settings.t2(eb.clientId);return!eb||eb&&1===eb.status?!0:!1}Dej(eb){var $a=String.format("buttonPeoplesWellUser-{0}",eb.clientId),vb=eb.clientId,bc=this.Nej(eb);
const Cc=eb.userName,Gc=eb.color;var sd=Object,Sd=sd.assign,ie=new db,De=this.settings.Eyc.toString(),yd=this.settings.Ahd.cluster,ib=this.settings.Ahd.mFc,dc=this.f8f(),Bc=eb.isAnonymous,Ob;if(Ob=[Cc],Ob.length){var yc=new Sys.StringBuilder("STRARRY@");for(const fc of Ob)yc.append(fc?fc.length:0),yc.append(","),yc.append(fc),yc.append(",");Ob=yc.toString().slice(0,-1)}else Ob=null;$a=Sd.call(sd,ie,{Id:$a,Command:De,LabelText:"{0}",Image32by32:yd,Image32by32Class:ib,MenuItemId:vb,CommandValueId:vb,
Alt:Cc,DisplayMode:dc,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:bc,ImageBackColor:Gc,IsAnonymous:Bc,LabelTextUserGeneratedPlaceholderReplacements:Ob,Upn:eb.email});A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&this.z9c&&(vb=this.M2i(eb),bc=this.Cej(eb),$a.ImageUrl=vb,$a.ActiveStatus=bc,$a.JoinTimeInMS=eb.ADa,eb=this.vKf(eb.clientId,this.settings.Ara(eb.clientId),!1),$a.CanJump=eb,""===vb&&m.ULS.sendTraceTag(40969413,
302,50,"ImageURL collection failed"));return $a}Y1i(){return Object.assign(new wb.a,{Id:"BasicChat",Command:"2288458806",LabelText:CommonUIStrings.l_StartGroupChat,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}f8f(){return this.LBj?"Initials":"Menu32"}Eej(eb){const $a=[];for(const vb of eb)eb=this.Dej(vb),Array.add($a,eb);return $a}N7d(){return 0<this.z0.Sua}jBk(eb){if(!this.vvd)return!0;this.URc||(eb[jb.a.Visible]=!0);let $a,vb,bc,Cc,Gc;({zok:$a,
Aok:vb,vok:bc,xok:Cc,wok:Gc}=this.aZi());eb[jb.a.LabelText]=$a;vb&&vb.length&&(eb[jb.a.LabelTextUserGeneratedPlaceholderReplacements]=vb);eb[jb.a.ImageIsVisible]=bc;eb[jb.a.Image16by16Class]=Cc;eb[jb.a.ImageBackColor]=Gc;this.vvd=!1;return!0}Ftk(eb){if(0>=this.z0.Sua)return!1;var $a=this.Fcl(this.z0.imd),vb=this.Eej($a);$a=Object.assign(new ab.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});vb=Object.assign(new fb.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.f8f(),
ControlList:vb});A.AFrameworkApplication.fa.ka("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.z9c&&(vb.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,vb.TitleId="menuCoauthorsTitle",vb.Theme="Light");Array.add($a.MenuSectionList,vb);A.AFrameworkApplication.fa.ka("DocChatIsEnabled")&&A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&A.AFrameworkApplication.Ba&&A.AFrameworkApplication.Ba.jb.mo&&(vb=[],Array.add(vb,this.Y1i()),vb=Object.assign(new fb.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",
ControlList:vb}),Array.add($a.MenuSectionList,vb));A.AFrameworkApplication.Ba&&A.AFrameworkApplication.Ba.jb.mo?eb.MenuItems=$a:eb.PopulationXML=Oa.l($a);return!0}gvl(eb){m.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");eb=eb.MenuItemId;if(!eb)return!1;const $a=this.settings.Ara(eb);if(!this.vKf(eb,$a,!0))return!1;this.HOj(eb,$a);return!0}lHk(){const eb=this.SVi();this.z0.b4k(eb);this.URc&&1<=this.z0.Sua&&(m.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),
this.URc=!1);this.vvd=!0}aX(){this.Ysd||(window.setTimeout(()=>{this.Tbd();this.Ysd=!1},3E3),this.Ysd=!0)}SVi(){let eb;eb=this.QVi()||[];for(const $a of eb)this.EUk($a);return eb}EUk(eb){eb.clientId||(eb.clientId=Sb.a.create().toString());eb.userName||(eb.userName="Anonymous user");eb.capabilities||(eb.capabilities=new Va.a);eb.color||(eb.color="#cccccc");eb.ADa||(eb.ADa=0)}Fcl(eb){const $a=[];Array.addRange($a,eb);$a.sort(yb.kok);return $a}uJk(){A.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&
!this.ezd&&(A.AFrameworkApplication.Va.eS(Xb.a.LNf)&&gc.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||A.AFrameworkApplication.Va.ra(Xb.a.LNf,cc.a.frame,Object(h.a)(this,this.Vfk,"onCoauthorGalleryFirstRender"),96));this.vJk();this.ezd=!0;this.Tbd()}Vfk(eb,$a,vb,bc,Cc){this.wDd.VL(Cc.RenderTime);return 32}get Ojd(){return this.wDd.task}Tbd(){if(!this.ezd&&(this.wDd.VL((new Date).getTime()),m.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),
this.Tqg))return;this.lHk();this.Tqg&&this.URc?A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||Da.a.t9("ribbon","coauthorGallery"):(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(Da.a.Rua("ribbon","coauthorGallery"),Da.a.Qua("ribbon","coauthorGallery")),this.mHk())}dispose(){this.JJ&&(this.JJ.Icd(Object(h.a)(this,
this.aX,"onUsersUpdated")),this.JJ=null)}static kok(eb,$a){return eb.capabilities.Gba(1)&&$a.capabilities.Gba(1)||!eb.capabilities.Gba(1)&&!$a.capabilities.Gba(1)?ob.a.localeCompare(eb.userName,$a.userName):eb.capabilities.Gba(1)?-1:1}}Object(J.a)(yb,"APeoplesWell",null,[1546,109]);var mb=d(38);class Ub extends yb{constructor(eb,$a,vb=null,bc=null){super(eb,vb,bc);this.$xa=()=>!0;this.Da=$a}lBk(eb){return this.jBk(eb)}Htk(eb){return this.Ftk(eb)}ivl(eb){return this.gvl(eb)}HP(eb,$a,vb,bc,Cc,Gc){eb=
!1;switch(vb){case 1:eb=Cc(bc);break;case 2:eb=Gc(bc)}return Ub.Rai(eb)}iCj(eb,$a,vb,bc,Cc){return this.HP(eb,$a,vb,Cc,()=>this.N7d(),this.$xa)}kBk(eb,$a,vb,bc,Cc){return this.HP(eb,$a,vb,Cc,Object(h.a)(this,this.lBk,"queryUsersProxy"),this.$xa)}Gtk(eb,$a,vb,bc,Cc){return this.HP(eb,$a,vb,Cc,this.$xa,Object(h.a)(this,this.Htk,"populateFlyoutContentsProxy"))}Gni(eb,$a,vb,bc,Cc){return this.HP(eb,$a,vb,Cc,this.$xa,this.$xa)}Fni(eb,$a,vb,bc,Cc){return this.HP(eb,$a,vb,Cc,this.$xa,this.$xa)}hvl(eb,$a,
vb,bc,Cc){return this.HP(eb,$a,vb,Cc,this.$xa,Object(h.a)(this,this.ivl,"userButtonClickProxy"))}esk(eb,$a,vb,bc,Cc){return this.HP(eb,$a,vb,Cc,this.$xa,()=>{this.Tbd();return!0})}vJk(){this.Da.ya(this.settings.yyc,mb.a.application,Object(h.a)(this,this.iCj,"isControlEnabledHandler"));this.Da.ra(this.settings.Cyc,mb.a.application,Object(h.a)(this,this.kBk,"queryUsersHandler"),96);this.Da.ra(this.settings.Ayc,mb.a.application,Object(h.a)(this,this.Gni,"commandMenuOpenHandler"),96);this.Da.ra(this.settings.zyc,
mb.a.application,Object(h.a)(this,this.Fni,"commandMenuCloseHandler"),96);this.Da.ra(this.settings.Byc,mb.a.application,Object(h.a)(this,this.Gtk,"populateFlyoutContentsHandler"),96);this.Da.ya(this.settings.Eyc,mb.a.application,Object(h.a)(this,this.hvl,"userButtonClickHandler"));this.Da.ra(this.settings.YEd,mb.a.application,Object(h.a)(this,this.esk,"peoplesWellRefreshControlHandler"),96)}dispose(){super.dispose()}static Rai(eb){return eb?32:8}}Object(J.a)(Ub,"ABox4PeoplesWell",yb,[]);var ec=d(715);
class nc extends Sys.EventArgs{constructor(eb){super();this.controlId=eb}}Object(J.a)(nc,"RibbonControlStatusChangedEventArgs",Sys.EventArgs,[]);class Lb extends Ub{constructor(eb,$a,vb,bc,Cc,Gc,sd,Sd,ie,De,yd,ib,dc,Bc,Ob,yc,fc,Nb){super(eb,$a,yc,Nb?H.Task.ot(Nb):null);this.Iy=null;this.Nie=!1;if(!Cc)throw Error.argumentNull("coauthStateGetter");if(!Gc)throw Error.argumentNull("appFrame");if(!sd)throw Error.argumentNull("taskManager");this.sj=Cc;this.Rb=Gc;this.Bb=sd;bc&&bc.execute(lb=>{this.Iy=lb});
vb&&vb.execute(lb=>{lb.E3h(Object(h.a)(this,this.ixk,"presenceChanged"))});this.qc=Sd;this.Je=ie;this.Ue=De;this.w8b=dc;this.tXj=yd;this.Pab=ib;this.Ywb=Bc;this.bT=Ob;this.Ene=fc;this.uLg=Nb;this.Ojd.continueWith(()=>{this.bT.eKi(this.Ojd.result)})}HOj(eb,$a){let vb=null;({data:vb}=this.MQe($a)).returnValue&&vb&&vb.Lj&&(Fa.a.J(8958488,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",eb,vb.Lj,this.sj.gC),(eb=this.qc.bia(vb.Lj))?(this.Je.MHe(),this.Je.rda(eb.Ge)):
Fa.a.J(19191178,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",vb.Lj))}MQe(eb){let $a;$a=null;if(!eb)throw Fa.a.J(8958490,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",this.sj.gC),Error.argumentNull("presence");return eb?($a=ec.a.LEc(eb.data))?{returnValue:!0,data:$a}:{returnValue:!1,data:$a}:{returnValue:!1,data:$a}}mhi(eb){let $a=null;return({data:$a}=this.MQe(eb)).returnValue&&$a&&$a.Lj?!0:!1}QVi(){if(this.uLg)return this.uLg.PVi();
Fa.a.J(50440411,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null.");const eb=this.RVi();0<eb.length&&Fa.a.J(50942294,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",eb.length);return eb}RVi(){const eb=[],$a=this.Ene.w8f();this.sj.lhb(this.sj.gC).returnValue||Fa.a.J(38589792,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",this.sj.gC);let vb=null;this.Iy&&(vb=this.Iy.iKc());var bc=A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
for(var Cc of this.sj.UY){var Gc=this.Pab.iCa(new qa.a(Cc.EmailAddress,void 0,Cc.Name),Cc.ColorIndex,Cc.ID,1),sd=new Va.a;sd.xXa(0);let Sd=0,ie=!1;if(Lb.rNj(Cc.ID,vb)){sd.xXa(1);if(bc){let De=vb[Cc.ID];De&&(Sd=De.capabilities);ie=!0;De&&De.capabilities&4&&sd.xXa(4)}delete vb[Cc.ID]}Lb.HAc($a,Cc.EmailAddress)||(Array.add(eb,new ua.a(Cc.ID,Cc.Name,Gc,sd,null,Cc.EmailAddress)),Fa.a.J(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",
Cc.ID,Gc,sd.Gba(1),sd.Gba(4),this.sj.gC,!Cc.EmailAddress,Sd,ie))}if(!bc&&this.w8b&&vb)for(let Sd in vb)bc=vb[Sd],!Lb.HAc($a,bc.email)&&bc&&bc.userName&&(Cc=new Va.a,Cc.xXa(1),bc.capabilities&4&&Cc.xXa(4),Gc=this.Ywb.lYd(bc.email)||bc.email,sd=this.Pab.iCa(new qa.a(Gc,void 0,bc.userName),null,bc.clientId,1),Array.add(eb,new ua.a(bc.clientId,bc.userName,sd,Cc,null,Gc)),Fa.a.J(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
bc.clientId,sd,Cc.Gba(1),Cc.Gba(4),this.Iy.clientId,!bc.email,bc.capabilities));return eb}$si(eb){let $a=null,vb=" ";({data:$a}=this.MQe(eb)).returnValue&&$a&&$a.Lj&&(eb=this.qc.bia($a.Lj))&&(vb=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,eb.Ge+1));return vb}ixk(){this.Rb.kt.aDa?this.Nie||(this.Bb.Hb(new Ea.a(2,1,0,Object(h.a)(this,this.handlePendingRefresh,"handlePendingRefresh"),90,"70")),this.Nie=!0):this.Da.processAction(Xb.a.H3a,2)}mHk(){this.Ue.lDk(new nc(this.settings.id,
!0));const eb=1<this.z0.Sua||1===this.z0.Sua&&this.z0.imd[0].clientId!==this.settings.clientId;this.tXj.execute($a=>{eb&&this.bT&&this.bT.XUj();$a.aJb()});eb&&this.bT.ai(14,Date.now())}handlePendingRefresh(){this.Nie=!1;this.Da.processAction(Xb.a.H3a,2)}dispose(){super.dispose()}static rNj(eb,$a){return $a&&eb in $a?!0:!1}static HAc(eb,$a){return!!eb&&!!$a&&eb.toLowerCase()===$a.toLowerCase()}}Object(J.a)(Lb,"PowerPointPeoplesWell",Ub,[]);class Zc{constructor(eb){this.n$b=null;eb.execute($a=>{this.n$b=
$a})}Ara(eb){return this.n$b?this.n$b.Ara(eb):null}t2(eb){return this.n$b?this.n$b.t2(eb):null}}Object(J.a)(Zc,"PresenceUserInfoGetterProxy",null,[967]);class Pb{constructor(){this.C3=this.zG=this.hh=this.K=null}get name(){return"PowerPointWebEditor.PeoplesWell"}Yb(eb){Pb.I6b=Date.now();this.K=eb;this.C3=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.hh=this.C3.YBa(6,this.name);this.K.register(967,"PowerPointWebEditor.IPresenceUserInfoGetter").ma().na(()=>new Zc(this.K.Oa("PowerPointWebEditor.IDelayedPresenceUserInfoGetter")));
this.K.register(696,"Common.ICoauthoringTelemeryInfoProvider").ma().na(()=>new ka(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(Ca,"PowerpointPresence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").ma().na(()=>new Ca(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.Oa("Common.IRealtimeChannelBasic"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser")));
Fa.a.J(50943688,814,50,"PPTWebEditorPeoplesWellPackage:Configure")}init(){if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("UnifiedScriptLoaderForDSEnabled"))this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Bha("pptedit.presence1",null,()=>d.e(4).then(d.bind(null,1198)));else{const eb=ma.a.create("pptedit.presence1",null,()=>d.e(4).then(d.bind(null,1198)));ra.a.nt(eb)}this.K.resolve("Common.ICoauthoringTelemeryInfoProvider");this.K.resolve("Common.IPeopleInfoProvider");
A.AFrameworkApplication.oA.zBa?(this.zG=this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),Da.a.t9("ribbon","coauthorGallery"),this.zG.fGd(Object(h.a)(this,this.rlg,"initializePeoplesWellHandler"))):this.qlg()}rlg(){try{A.AFrameworkApplication.oA.zBa||(this.qlg(),this.zG.nDe(Object(h.a)(this,this.rlg,"initializePeoplesWellHandler")))}catch(eb){Fa.a.J(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",eb)}}qlg(){const eb=this.hh.Ut("peoplewell");this.Qvj(this.K.resolve("PowerPointWebEditor.IPresenceUserInfoGetter"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerpointPresence.RtcParams").clientId);this.hh.au(eb)}Qvj(eb,$a,vb,bc,Cc,Gc){var sd=this.K.resolve("PowerpointPresence.IPresencePerfLogger");sd.ai(10,Pb.I6b);sd.ai(9,Pb.x$b);sd.ai(11,(new Date).getTime());sd=Date.now();const Sd=Ka.CuiHelper.D7i(A.AFrameworkApplication.Rl,A.AFrameworkApplication.Rl,
A.AFrameworkApplication.Rl);eb=va.createInstance(Sd,Gc,Object(h.a)(eb,eb.Ara,"getUserPresence"),Object(h.a)(eb,eb.t2,"getUserStatusInfo"),!0);(Gc=this.K.resolve("PowerpointPresence.PeopleInfoProvider"))||Fa.a.J(50642959,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider");Fa.a.J(50943691,814,50,"InitializePeoplesWellInternal; creating peopleswell");const ie=new Lb(eb,$a,this.K.Oa("PowerpointPresence.IPresenceManager"),this.K.Oa("Common.IRealtimeChannelBasic"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),
vb,bc,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Oa("Box4.IBox4BridgeCommandUi"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),Cc.podsDefaultToRtcForPresenceEnabled,this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.resolve("Common.App.People.IPeopleManager"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser"),
Gc);ie.uJk();this.K.register(Lb,"PowerpointPresence.PowerPointPeoplesWell").as("Common.IPeoplesWell").ma().na(()=>ie);this.K.resolve("Common.IPeoplesWell");this.K.Oa("Box4.IBox4BridgeCommandUi").execute(De=>{De.aJb()});Fa.a.J(8958615,814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",Date.now()-sd);this.K.resolve("PowerpointPresence.IPresencePerfLogger").jKi()}dispose(){}static main(){Pb.x$b=Date.now();if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")){const eb=
new Pb;eb.Yb(pa.a.instance);eb.init()}else oa.a.instance.Ec(new Pb)}}Pb.x$b=0;Pb.I6b=0;Object(J.a)(Pb,"PPTWebEditorPeoplesWellPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PeoplesWell");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("RealtimePresenceUI");window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");Ja.main();Type.registerNamespace("RealtimePresenceUI");Pb.main()},715:function(J,
V,d){J=d(0);var h=d(64);class e{constructor(r,v,A){this.slideId=r;this.shapes=v;this.sn=A}}Object(J.a)(e,"SerializablePresenceData",null,[]);d.d(V,"a",function(){return m});class m{constructor(r,v,A=0){if(!m.isValid(r))throw Error.create("Invalid Presence Data");this.TA=r;this.H2c=v;this.vNg=A?A:++m.$Ai}get Lj(){return this.TA}get GT(){return this.H2c}toString(){return this.TA.toString()+" : "+(this.GT&&this.GT.length?this.GT[0].toString():"")+" : "+this.vNg}m0d(){return new e(this.TA.Qnc,this.H2c,
this.vNg)}static isValid(r){return!!r}static LEc(r){return new m(new h.a(r.slideId),r.shapes,r.sn)}}m.$Ai=0;Object(J.a)(m,"PresenceData",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.presence.js.map