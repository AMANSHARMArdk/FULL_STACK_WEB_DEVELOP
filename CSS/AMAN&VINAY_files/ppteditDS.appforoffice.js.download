'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1193:function(J,V,d){d.r(V);var h=d(0),e=d(17),m=d(374),r=d(289);class v{constructor(){this.XGh=new e.a}get NBc(){return this.XGh}E6i(L){m.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",L);const ba=new e.a;for(let Sa of this.NBc)for(let sb of Sa.rcc)sb.id===L&&ba.add(sb);return ba}jci(){var L=this.E6i("ContextMenuText");if(L&&0<L.count){const ba=Object.assign(new r.a,{ControlList:[]});for(let Sa of L)L=
Sa.jmc(),0<L.length&&Array.addRange(ba.ControlList,L);return ba}return null}bAf(L){this.NBc.add(L)}TKk(L){for(let ba of this.NBc)if(ba.mDf===L.mDf){this.NBc.remove(ba);break}}static PEi(L,ba,Sa=null){L=v.SYi(L);0<L.length&&(v.xfd(L,!1),Sa&&Sa(ba,L))}static SYi(L){const ba=[];if(L&&L.rcc&&0<L.rcc.count)for(let Sa of L.rcc)if(Sa.controls&&0<Sa.controls.count)for(let sb of Sa.controls)if(sb.menuItems&&0<sb.menuItems.count)for(let Tb of sb.menuItems)Array.add(ba,Tb.id);return ba}static xfd(L,ba){if(L.length){var Sa=
[];for(const sb of L)Sa.push(appChrome.actions.updateControlEnabledDisabledState(sb,ba));appChrome.api.dispatch(Sa)}}}Object(h.a)(v,"ContextMenuExtensibilityCache",null,[1100,1101]);var A=d(25),x=d(418),y=d(102),u=d(69),H=d(13);class G{constructor(L,ba,Sa){this._id=L;this.xFh=ba;this.EHh=Sa;this.Jpg=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get GGd(){return this.xFh}get Dni(){return this.EHh}execute(L,ba,Sa){Sa=Sa||{};Sa.commandMode=this.Jpg;ba.invokeAppCommand(this.GGd,this.Dni,
Sa,(sb,Tb)=>{L.BYg(this.id,this.GGd,sb,Tb)})}}Object(h.a)(G,"AddinNativeActionBase",null,[826]);class E extends G{constructor(L,ba){super(1,L,ba);this.Jpg=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(h.a)(E,"AddinTakeSnapshotAction",G,[]);class I{zQf(L,ba){let Sa=null;switch(L){case 1:Sa=new E(ba,this.OWd().getNativeActionName(L));break;case 2:Sa=new G(2,ba,this.OWd().getNativeActionName(L));break;case 3:Sa=new G(3,ba,this.OWd().getNativeActionName(L))}return Sa}OWd(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}
Object(h.a)(I,"AddinNativeActionManager",null,[807]);class Q{invokeAppCommand(L,ba,Sa,sb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(L,ba,Sa,sb)}static getInstance(){Q.Ka||(Q.Ka=new Q);return Q.Ka}}Q.Ka=null;Object(h.a)(Q,"OSFAddinCommandsRuntimeManager",null,[806]);var D=d(78);class Y{constructor(){this.GXf=this.displayName=this.BVb=this.ZI=this.uL=null;this.isUpgraded=!1}Gvg(L,ba){return this.uL.getStoreType().toLowerCase()===L.toLowerCase()&&this.uL.getSolutionId().toLowerCase()===
ba.toLowerCase()}}Object(h.a)(Y,"AddinCommandsResourceItem",null,[]);class M{constructor(){this.Vnd=null;this.Qsd=0;this.rud=!1;this.Ta=new D.a;this.XLh=new e.a}X0h(L){this.Ta.addHandler("AddinCommandsLoadingMessageChanged",L)}get HSb(){return this.Vnd}lGb(L){L!==this.Vnd&&(this.Vnd=L,this.Ta.raiseEvent("AddinCommandsLoadingMessageChanged"))}hZk(){this.Qsd++;this.HSb||this.lGb(CommonUIStrings.l_LoadingAddInsTitle)}HHe(){this.Qsd--;this.Mbe()&&(this.rud?this.HSb!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&
this.lGb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.lGb(null))}v_k(){this.rud=!0;this.lGb(CommonUIStrings.l_ErrorLoadingAddInsTitle)}lMf(){this.rud=!1;this.Mbe()?this.lGb(null):this.lGb(CommonUIStrings.l_LoadingAddInsTitle)}Mbe(){return 0>=this.Qsd}get Htb(){return this.XLh}k5a(L,ba,Sa=0){for(let sb of this.Htb)if(sb.Gvg(L,ba)&&(!sb.ZI||sb.ZI.XUi===Sa))return sb;return null}MAf(L,ba,Sa,sb){const Tb=new Y;Tb.uL=L;Tb.ZI=ba;Tb.BVb=Sa;Tb.displayName=sb;this.Htb.add(Tb)}WZh(L,ba,Sa,sb){const Tb=new Y;
Tb.uL=L;Tb.ZI=ba;Tb.BVb=null;Tb.GXf=Sa;Tb.displayName=sb;this.Htb.add(Tb)}AKk(L,ba){let Sa=0;for(let sb of this.Htb)sb.uL.getStoreType()===L&&sb.uL.getSolutionId()===ba?this.Htb.removeAt(Sa):Sa++}static getInstance(){M.Ka||(M.Ka=new M);return M.Ka}}M.Ka=null;Object(h.a)(M,"AddinCommandsResourceManager",null,[]);var N=d(230),W=d(529),K=d(168),ca=d(141);class P extends Sys.EventArgs{constructor(){super();this.ZI=this.eu=null}}Object(h.a)(P,"InsertionParamEventArgs",Sys.EventArgs,[]);class ea{constructor(L,
ba,Sa,sb,Tb,Tc){this.Ax=L;this.eu=ba;this.N9=Sa;this.displayName=Tb;this.gyg=Tc}}Object(h.a)(ea,"PostLaunchAddinCommandsParameters",null,[]);var da=d(33),ia=d(45),C=d(1154);class oa{constructor(L,ba,Sa,sb=null){this.ric=A.AFrameworkApplication.fa.Ia("RoamingServiceHandlerWebServiceBase");this.appName=L;this.FMb=ba;this.CMb=Sa;this.zPb=sb}cIc(L){const ba=new Sys.StringBuilder(this.ric);ba.append("RoamingServiceHandler.ashx?action=");ba.append("getAddinTeachingCalloutSettings");ba.append("&");ba.append(this.L_d(L));
ba.append("&");ba.append(A.AFrameworkApplication.$g);A.AFrameworkApplication.Be.Jj(ba.toString(),1,null,null,!0,2,Object(H.a)(this,this.$Ba,"getRequestSuccessCallback"),Object(H.a)(this,this.aia,"getRequestFailureCallback"),null)}yqb(L){var ba=new Sys.StringBuilder(this.ric);ba.append("RoamingServiceHandler.ashx?action=");ba.append("saveAddinTeachingCalloutSettings");ba.append("&");ba.append(A.AFrameworkApplication.$g);ba=ba.toString();L=da.c(L);A.AFrameworkApplication.Be.Jj(ba,2,L,null,!0,4,null,
Object(H.a)(this,this.E9,"postRequestFailureCallback"),null)}$Ba(L){let ba=!1,Sa=null;try{if(0<L.data.je.length){const sb=Object(C.a)(Object,da.a(L.data.je)),Tb=sb?sb[this.appName]:null;Tb&&(Sa=Object(C.a)(Object,da.a(Tb.toString())))}ba=!0}catch(sb){this.aia(null)}ba&&this.FMb&&this.FMb(Sa)}aia(L){this.CMb&&this.CMb(L?L.data:null)}E9(L){this.zPb&&this.zPb(L?L.data:null)}L_d(L){const ba=new Sys.StringBuilder("requestedsettings=");for(let Sa=0;Sa<L.count;Sa++)ba.append(L.ga(Sa)),Sa<L.count-1&&ba.append(";");
return ba.toString()}}Object(h.a)(oa,"AddinTeachingUIRoamingRequestHandler",null,[]);var Z=d(195);class pa{constructor(L,ba,Sa){this.qic=!1;this.A$=null;this.Ta=L;this.jNb=ba;this.$Jb=Sa}yFd(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(H.a)(this,this.fve,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(H.a)(this,this.zue,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(H.a)(this,this.mue,
"onCloseButtonClickedEventHandler"),!0),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(H.a)(this,this.zcc,"onCampaignLaunchedHandler"),!0)):m.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}fve(){const L={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:pa.sV(this.jNb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
this.$Jb&&this.$Jb.tabs&&!this.$Jb.tabs[0].isOfficeTab&&(L["SDX.FeatureFlags"]="NonOfficeTab");ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.bD(L)}));A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.jGa();this.$Jb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.$Jb,()=>{const ba=new P;ba.eu=this.jNb;this.Ta.raiseEvent(N.a.fbe,ba)}):m.ULS.sendTraceTag(525112602,
220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}mue(){const L={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:pa.sV(this.jNb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.bD(L)}));A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.jGa()}zue(){const L=
{["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:pa.sV(this.jNb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.bD(L)}));A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.jGa()}zcc(L){if(L&&(L=L.detail)&&L.id&&this.v7d(L.id)){const Sa=(L.action||"").toLowerCase();if(L.success&&
"opened"===Sa){var ba={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:pa.sV(this.jNb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.bD(ba)}));m.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.jGa();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(H.a)(this,this.zcc,"onCampaignLaunchedHandler"),!0)}else try{ba=JSON.stringify(L),m.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+ba)}catch(sb){ba="id : "+L.id+" telemetryEventName: "+L.telemetryEventName,m.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+ba+" Error: "+(sb?sb.toString():""))}}}v7d(L){L=ia.a.vg(L);return-1!==L.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==L.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==L.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==L.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==L.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==L.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}zma(L){const ba=A.AFrameworkApplication.fa.Ia("WebAppShortName");if(ba){const Sa={},sb={};sb.LastTeachingUIShowTime=(new Date).toUTCString();sb.AddinHasShown=L;Sa[ba]=da.c(sb);this.A$=new oa(ba,null,null,Object(H.a)(this,this.E9,"postRequestFailureCallback")),this.A$.yqb(Sa),m.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else m.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}jGa(){if(!this.qic){const L=window.g_roamingAddinList;L&&(this.zma(L),this.qic=!0)}}E9(L){m.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",L?L.tf:-1)}static sV(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}}Object(h.a)(pa,"PrivateCatalogTeachingCalloutHandler",null,[]);var ya=d(14),Ja=d(15),Ka=d(958);class ma{constructor(){this.addinId=
null;this.targetType=0;this.storeId=this.solutionId=null}}Object(h.a)(ma,"AddinAbstract",null,[]);class ra extends Sys.EventArgs{constructor(L){super();this.solutionId=L.solutionId;this.assetId=L.assetId;this.storeType=L.storeType;this.storeId=L.storeId;this.assetStoreId=L.assetStoreId;this.targetType=L.targetType;this.width=L.width;this.height=L.height;this.displayName=L.displayName;this.version=L.version}}Object(h.a)(ra,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Da=d(124);
class va{constructor(L){this.Pmb=this.eu=null;this.qic=!1;this.cKa=this.xoc=this.mHa=this.Ko=this.A$=this.W_=null;this.ep=L}get appName(){return A.AFrameworkApplication.fa.Ia("WebAppShortName")}get PCf(){this.A$||(this.A$=new oa(this.appName,Object(H.a)(this,this.$Ba,"getRequestSuccessCallback"),Object(H.a)(this,this.aia,"getRequestFailureCallback"),Object(H.a)(this,this.E9,"postRequestFailureCallback")));return this.A$}get MMa(){this.xoc||(this.xoc=new e.a);return this.xoc}set MMa(L){this.xoc=L}get Q3a(){this.cKa||
(this.cKa=new e.a);return this.cKa}set Q3a(L){this.cKa=L}yFd(L,ba){window.addEventListener?(this.eu=L,this.Pmb=ba,window.addEventListener("LaunchAddinTaskpane",Object(H.a)(this,this.fve,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(H.a)(this,this.zue,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(H.a)(this,this.mue,"onCloseButtonClickedEventHandler"),!0),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&window.addEventListener("FGWebSurfaceEvent",Object(H.a)(this,this.zcc,"onCampaignLaunchedHandler"),!0)):m.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}hml(L,ba,Sa,sb){this.Ko=L;this.MMa=ba;this.Q3a=Sa;this.mHa=sb;m.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",ba?ba.count.toString():"null",Sa?Sa.count.toString():"null");0<this.MMa.count||0<this.Q3a.count?(L=new e.a,
L.add(this.appName),this.PCf.cIc(L)):this.mHa(new e.a,null)}fve(){const L=new ya.ScriptSharpLegacyMap;this.Pmb&&this.Pmb.tabs&&!this.Pmb.tabs[0].isOfficeTab&&L.$("SDX.FeatureFlags","NonOfficeTab");this.KDa(va.sV(this.eu),"ClickOnLaunch",L);A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.jGa();this.Pmb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Pmb,()=>{const ba=new P;ba.eu=this.eu;this.ep.raiseEvent(N.a.fbe,ba)}):m.ULS.sendTraceTag(525112602,
220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}mue(){this.KDa(va.sV(this.eu),"ClickOnClose");A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.jGa()}zue(){this.KDa(va.sV(this.eu),"ClickOnDismiss");A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.jGa()}zcc(L){if(L&&(L=L.detail)&&L.id&&this.v7d(L.id)){const ba=(L.action||"").toLowerCase();if(L.success&&
"opened"===ba)this.KDa(va.sV(this.eu),"CampaignLaunched"),m.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.jGa(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(H.a)(this,this.zcc,"onCampaignLaunchedHandler"),!0);else{let Sa;try{Sa=JSON.stringify(L),m.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Sa)}catch(sb){Sa="id : "+L.id+" telemetryEventName: "+L.telemetryEventName,m.ULS.sendTraceTag(523321996,
220,50,"Error serializing campaign event. "+Sa+" Error: "+(sb?sb.toString():""))}}}}v7d(L){L=ia.a.vg(L);return-1!==L.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==L.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==L.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==L.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==L.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==L.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}zma(L){if(this.appName){const ba={},Sa={};Sa.LastTeachingUIShowTime=
(new Date).toUTCString();Sa.AddinHasShown=L;ba[this.appName]=da.c(Sa);this.PCf.yqb(ba);m.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else m.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}jGa(){if(!this.qic){const L=window.g_roamingAddinList;L&&(this.zma(L),this.qic=!0)}}$Ba(L){L?this.vKe(L)?(m.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.W_="AddinHasShown"in
L&&L.AddinHasShown?L.AddinHasShown.toString():null,this.oVb()):(m.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.mHa(this.MMa,null)):(m.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.W_=null,this.oVb())}aia(L){m.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",L?L.tf:-1);this.mHa(this.MMa,null)}E9(L){m.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",L?
L.tf:-1)}oVb(){const L=this.YQd();0===L.targetType?(L.solutionId?this.oAe(L):this.KDa(null,"NoSolutionId"),this.JAh(L),this.mHa(this.MMa,null)):this.mHa(this.MMa,L);m.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",L.addinId)}oAe(L){const ba=new Ka.a;ba.callbackFunc=Sa=>{if(Sa.errorCode){if(this.KDa(L.solutionId,"FailToGetAppDetails"),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var sb=window.g_roamingAddinList;sb&&this.zma(sb)}}else if(Sa.value)for(sb of Sa.value){var Tb=
sb[1];if(Tb===L.solutionId){Sa={};Sa.solutionId=Tb;Sa.assetId=sb[5];Tb=A.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");Sa.storeType=Tb?sb[12]:sb[6];A.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?Sa.storeId=L.storeId:Sa.storeId=sb[11];Sa.assetStoreId=sb[6];Sa.targetType=sb[3];Sa.width=sb[7];Sa.height=sb[8];Sa.displayName=sb[0];Sa.version=sb[4];m.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",L.solutionId);
sb=new ra(Sa);this.ep.raiseEvent(N.a.IKe,sb);break}}};ba.storeType=OSF.StoreTypeEnum.PrivateCatalog;ba.fromInsertDialog=!1;ba.refresh=!1;this.Ko.queryEntitlementDetails(ba)}vKe(L){if("LastTeachingUIShowTime"in L){if(L=+new Date-+new Date(L.LastTeachingUIShowTime.toString()),L<A.AFrameworkApplication.fa.xP("AddinShowTeachingUIIntervalInMS",864E5))return m.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",L),!1}else m.ULS.sendTraceTag(527523846,220,
50,"userSetting has no date key");return!0}YQd(){let L=new Ja.a(new ma,0),ba=new Ja.a(new ma,0),Sa=0,sb=0,Tb=0;var Tc=new e.a;for(var Vb of this.MMa)Tc.add(Vb);for(let Ed of this.Q3a)Tc.add(Ed);for(let Ed of Tc)if(!("excatalog"!==Ed.storeType||Da.b(Ed.installTimeInMS)||!Ed.installTimeInMS||Ed.installTimeInMS<=A.AFrameworkApplication.fa.xP("DateTimeInMSForNewAddin",16409952E5))){Tc=va.GZb(Ed);if(this.W_&&(Vb=this.W_.split(","),0<Vb.length&&Array.contains(Vb,Tc))){Tb++;m.ULS.sendTraceTag(528345032,
220,50,"This addin has shown teaching UI before");continue}Tc.startsWith("private_")?(L=va.q$f(Ed,L),sb++):(ba=va.q$f(Ed,ba),Sa++)}m.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",sb,Sa,Tb);return 0<ba.value?ba.key:0<L.value?L.key:Object.assign(new ma,{addinId:null,targetType:-1,solutionId:null,storeId:null})}KDa(L,ba,Sa=null){L={["AppTeachingUICalloutAction"]:ba,["SDX.Id"]:L,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};if(Sa)for(let sb of Sa.keys)L[sb]=Sa.ga(sb);ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.bD(L)}))}JAh(L){L&&(L=this.W_?this.W_+","+L.addinId:L.addinId,A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=L:this.zma(L))}static sV(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,
null,null,L.storeId)}static q$f(L,ba){return ba.value<L.installTimeInMS?new Ja.a(Object.assign(new ma,{addinId:va.GZb(L),targetType:L.targetType,storeId:L.storeId,solutionId:L.solutionId}),L.installTimeInMS):ba}static GZb(L){return Telemetry.PrivacyRules.IsPrivateAddin(L.storeType,L.assetId,null,null,L.storeId)?"private_"+L.installTimeInMS:L.solutionId}}Object(h.a)(va,"PrivateCatalogTeachingCalloutHandler2",null,[]);class Fa{constructor(L){this.dbf=null;this.W4e=L}get eSa(){return this.dbf}vmb(L,
ba=null){this.W4e.vmb(L,ba);this.dbf=L}fDe(L){this.W4e.fDe(L)}}Object(h.a)(Fa,"RibbonExtensibilityManagerWithChangeDetection",null,[1128]);var ka=d(82);const qa=()=>{const L=ka.a.ksb(window.location.href.toLowerCase(),"wdomexsrctype");return!!L&&"4"===L},Ua=()=>ka.a.ksb(window.location.href.toLowerCase(),"wdtpl"),Ya=()=>{const L=ka.a.ksb(window.location.href.toLowerCase(),"wdomexsrctype");return!!L&&"1"===L},Va=L=>{let ba=null;switch(L){case 0:ba="omex";break;case 1:ba="spcatalog";break;case 2:ba=
"spapp";break;case 3:ba="filesystem";break;case 4:ba="exchange";break;case 6:ba="registry";break;case 7:ba="inmemory";break;case 8:ba="uploadfiledevcatalog";break;case 9:ba="hardcodedpreinstall";break;case 10:ba="excatalog";break;case 16:ba="wopicatalog"}return ba},ua=L=>{let ba=-1;switch(L.toLowerCase()){case "omex":ba=0;break;case "spcatalog":ba=1;break;case "spapp":ba=2;break;case "filesystem":ba=3;break;case "exchange":ba=4;break;case "registry":ba=6;break;case "inmemory":ba=7;break;case "uploadfiledevcatalog":ba=
8;break;case "hardcodedpreinstall":ba=9;break;case "excatalog":ba=10;break;case "wopicatalog":ba=16}return ba};class Ca{constructor(){this.title=this.id=this.tabs=null}}Object(h.a)(Ca,"AddInDataTransferObject",null,[]);class Ea{constructor(L,ba,Sa){this.uoc=L;this.tFh=ba;this.uFh=Sa}get yE(){return this.uoc}get zZh(){return this.tFh}get AZh(){return this.uFh}static lrb(L){return(L=L.B9)?Object.assign(new Ca,{tabs:L.yE.toArray(),id:L.zZh,title:L.AZh}):null}}Object(h.a)(Ea,"OneLineRibbonExtensibility",
null,[]);class wb{vmb(L,ba=null){if(L=Ea.lrb(L)){appChrome.addInApi.dispatchActionsToInstallAddIn(L,ba);for(const Sa of L.tabs)if(Sa.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(L,()=>{});break}}}fDe(L){(L=Ea.lrb(L))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(L)}static UEi(L,ba,Sa=null){L=wb.w9i(L);0<L.length&&(wb.xfd(L,!1),Sa&&Sa(ba,L))}static w9i(L){const ba=[];if(L&&(L=L.B9,L.yE&&0<L.yE.count))for(let Sa of L.yE)if(Sa.groups&&0<Sa.groups.length)for(const sb of Sa.groups)if(sb.controls&&
0<sb.controls.length)for(const Tb of sb.controls)Array.add(ba,Tb.id);return ba}static xfd(L){if(L.length){var ba=[];for(const Sa of L)ba.push(appChrome.actions.updateControlEnabledDisabledState(Sa,!0));appChrome.api.dispatch(ba)}}}Object(h.a)(wb,"OneLineRibbonExtensibilityManager",null,[1128]);class Oa{constructor(){this.Ver=1}}Object(h.a)(Oa,"CacheItem",null,[]);class ab{constructor(){}}Object(h.a)(ab,"AppsDataCacheManager",null,[746]);class fb{constructor(){new ab(x.a.instance)}Eih(L,ba){L=N.a.W8f()+
L;x.a.instance.setItem(L,ba.toString())}ubg(){var L=N.a.xbg();m.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",L);L=x.a.instance.getItem(L);return da.a(L)}qkh(L){const ba=N.a.xbg();m.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",ba);x.a.instance.setItem(ba,da.c(L))}Ftg(){return!!x.a.instance.localStorage}static get instance(){fb.Ka||(fb.Ka=new fb);return fb.Ka}}fb.Ka=null;Object(h.a)(fb,"AddInCommandsCacheManager",null,[1092]);var db=d(681),gc=d(67);class ob{static C9f(L){const ba=
new e.a;if(ob.DOf)for(var Sa of ob.DOf)ba.add(Sa);Sa=null;switch(L){case "Workbook":Sa=ob.Iyl;break;case "Document":Sa=ob.zGi;break;case "Presentation":Sa=ob.mxk}if(Sa)for(const sb of Sa)ba.add(sb);return ba}}ob.DOf=["PrimaryCommandSurface","ContextMenu"];ob.Iyl=null;ob.zGi=null;ob.mxk=null;Object(h.a)(ob,"ExtensionPointType",null,[]);class Sb{constructor(L){this.Nef=null;if(Da.b(L))throw m.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");
this.FFh=L}get rcc(){return this.Nef||(this.Nef=new e.a)}get mDf(){return this.FFh}}Object(h.a)(Sb,"ContextMenuExtensibility",null,[1103]);class Jb{constructor(L,ba=null,Sa=0){if(Da.b(L))throw m.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.XPh=L;this.tUh=ba;this.EKh=Sa}get B9(){return this.XPh}get startedNode(){return this.tUh}get XUi(){return this.EKh}}Object(h.a)(Jb,
"RibbonExtensibility",null,[1158]);class Ab{constructor(L){this.FJh=L.entitlement}get entitlement(){return this.FJh}createActionContext(L,ba){L={};L.ownerAddinInfo=this.entitlement;L.action=ba;return L}}Object(h.a)(Ab,"AddInCommandsContextProvider",null,[]);class lc{constructor(L,ba,Sa){this.gVe=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=L;this.eventBuilder=ba;this.contextMenuBuilder=Sa}get NCf(){return this.gVe}Pui(L){return new Ab(L)}createActionBuilder(L,
ba){return OfficeExt.DefaultControlActionBinder.createActionBuilder(L,ba.entitlement,ba.manifest)}startApplyAddin(L){this.gVe=L;const ba=this.Pui(L);this.actionBuilder=this.createActionBuilder(ba,L)}endApplyAddin(){}EWd(L,ba,Sa=0){return this.ribbonBuilder.yE&&0<this.ribbonBuilder.yE.count?new Jb(this.IUi(L,ba),this.NCf.startedNode,Sa):null}W4f(){var L=null;if(this.contextMenuBuilder.K4c&&0<this.contextMenuBuilder.K4c.count){L||(L=this.NCf.entitlement.solutionId);L=new Sb(L);for(let ba of this.contextMenuBuilder.K4c)L.rcc.add(ba);
return L}return null}IUi(L,ba){return this.ribbonBuilder.yE&&0<this.ribbonBuilder.yE.count?new Ea(this.ribbonBuilder.yE,L,ba):null}}Object(h.a)(lc,"AddinCommandsBuilder",null,[]);class Mc{constructor(L,ba,Sa,sb,Tb,Tc,Vb){this.pgb=new gc.a;this.Ax=L;this.Ko=ba;this.FR=Sa;this.nic=sb;this.CNd=Tb;this.IHa=Tc;this.Mmb=Vb;this.b$=A.AFrameworkApplication.Ba.aU}SUc(L,ba,Sa,sb,Tb,Tc,Vb){const Ed=(ae,Rd,pe,ff)=>{Tb(ae,Rd,pe,ff);ae=db.a[this.Ax]+Rd.assetId;({value:Rd}=this.pgb.Nf(ae)).returnValue&&(Rd.stop(),
this.pgb.remove(ae))};if(0!==this.Ax&&L){m.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",L.count);4===this.Ax&&(m.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",sb)),this.Wki(L,sb),Tc());for(let ae of L)if(L=ae,m.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.FR.mS,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId))),this.lCh(L))if(Vb&&L.requireConsent)Vb(L,
Rd=>{try{if(this.b$){const ff=db.a[this.Ax]+Rd.solutionId,eg=this.b$.wi("ComponentAttach",ff);this.pgb.$(ff,eg)}const pe=this.IHa.k5a(Rd.storeType,Rd.solutionId);6!==this.Ax&&(pe&&(this.PCc(pe),pe.uL.purge(!1)),this.Ko.insertOsfControl(this.rfc(Rd,ba,Sa,Ed)),pe&&this.Ko.ownerAddinControlRecreated(Rd.solutionId,Rd.storeType))}catch(pe){m.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.FR.mS,Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.solutionId,Rd.ownerAddinStoreType||Rd.storeType,Rd.assetId,null,null,Rd.storeId),Rd.version,Rd.storeType,Rd.storeId,pe.message)),Ed(!1,Rd,null,null)}});else try{if(this.b$){const pe=db.a[this.Ax]+L.solutionId,ff=this.b$.wi("ComponentAttach",pe);this.pgb.$(pe,ff)}const Rd=this.IHa.k5a(L.storeType,L.solutionId);6!==this.Ax&&(Rd&&(this.PCc(Rd),Rd.uL.purge(!1)),this.Ko.insertOsfControl(this.rfc(L,ba,Sa,Ed)),Rd&&this.Ko.ownerAddinControlRecreated(L.solutionId,
L.storeType))}catch(Rd){m.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.FR.mS,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId,Rd.message)),Ed(!1,L,null,null)}else Ed(!1,L,null,null)}}GPj(L,ba,Sa,sb,Tb,Tc){const Vb=(Ed,ae,Rd,pe)=>{Tc(Ed,ae,Rd,pe);Ed=db.a[this.Ax]+ae.solutionId;
({value:ae}=this.pgb.Nf(Ed)).returnValue&&(ae.stop(),this.pgb.remove(Ed))};if(6===this.Ax&&L)if(m.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.FR.mS,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId))),this.lCh(L))try{if(this.b$){const ae=db.a[this.Ax]+L.solutionId,Rd=this.b$.wi("ComponentAttach",ae);this.pgb.$(ae,Rd)}const Ed=this.IHa.k5a(L.storeType,L.solutionId);Ed||Vb(!1,L,null,null);
A.AFrameworkApplication.Ba&&A.AFrameworkApplication.Ba.jb.lUf?this.l5f(L,ba,sb,Tb,Sa,ae=>{Vb(ae,L,Sa,Ed.displayName)}):(this.l5f(L,ba,sb,Tb,Sa),Vb(!0,L,Sa,Ed.displayName))}catch(Ed){m.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.FR.mS,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,
L.storeType,L.storeId,Ed.message)),Vb(!1,L,null,null)}else Vb(!1,L,null,null)}uek(L,ba,Sa,sb,Tb,Tc){if(Tc)if(Tc._isAddinCommandsManifest(this.FR.mS))try{A.AFrameworkApplication.Ba&&A.AFrameworkApplication.Ba.jb.lUf?this.k5f(L,ba,Sa,Tb,Tc,Vb=>{sb(Vb,L,Tc,Tc.getDefaultDisplayName())}):(this.k5f(L,ba,Sa,Tb,Tc),sb(!0,L,Tc,Tc.getDefaultDisplayName()))}catch(Vb){m.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",
this.FR.mS,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId,Vb.message)),sb(!1,L,Tc,Tc.getDefaultDisplayName())}else m.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.FR.mS,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,
L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId)),sb(!1,L,null,null);else m.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.FR.mS,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId)),sb(!1,L,null,null)}rfc(L,ba,Sa,sb){const Tb={},Tc=document.createElement("div");Tc.setAttribute("visible",
"false");Tb.div=Tc;Tb.id=L.solutionId;Tb.solutionId=L.solutionId;Tb.version=L.version;Tb.storeType=L.storeType;Tb.storeId=L.storeId;Tb.assetId=L.assetId;Tb.assetStoreId=L.assetStoreId;Tb.isvirtualOsfControl=!0;Tb.virtualOsfControlActivationCallback=(Vb,Ed)=>{const ae=this.IHa.k5a(L.storeType,L.solutionId);ae&&(ae.isUpgraded&&(L.isUpgraded=!0),this.PCc(ae));this.uek(L,ba,Sa,sb,Vb,Ed)};Tb.reason=3===this.Ax?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;
return Tb}k5f(L,ba,Sa,sb,Tb,Tc=null){const Vb={};Vb.solutionId=sb.getSolutionId();Vb.version=sb.getVersion();Vb.storeType=sb.getStoreType();Vb.storeId=sb.getStoreId();Vb.assetId=sb.getSolutionId();Vb.assetStoreId=sb.getAssetStoreId();Vb.targetType=sb.getOsfControlType();let Ed=null,ae=null;if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Ed=(new OfficeExt.Parser.AddinCommandsManifestParser(this.FR.mS,this.FR.formFactor)).parseExtensions(Vb,
Tb,this.Mmb),ae=ob.C9f(this.FR.mS);else try{Ed=(new OfficeExt.Parser.AddinCommandsManifestParser(this.FR.mS,this.FR.formFactor)).parseExtensions(Vb,Tb,this.Mmb),ae=ob.C9f(this.FR.mS)}catch(pe){throw m.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+pe.message),pe;}if(ae&&0<ae.count){if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Rd=ba(L);ba=Sa(L);Sa=!!A.AFrameworkApplication.fa&&
A.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");Rd=new lc(Rd,null,ba);for(let pe of ae)Rd.commandSurface=pe,Ed.apply(Rd,this.Mmb,Sa)}else try{let pe=ba(L),ff=Sa(L),eg=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");Rd=new lc(pe,null,ff);for(let kh of ae)Rd.commandSurface=kh,Ed.apply(Rd,this.Mmb,eg)}catch(pe){throw m.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+pe.message),pe;
}if(OSF.OUtil.checkFlight(14))try{let pe=Rd.EWd(L.solutionId,Tb.getDefaultDisplayName()),ff=Rd.W4f();pe&&this.nic.vmb(pe,Tc);ff&&this.CNd.bAf(ff);this.IHa.MAf(sb,pe,ff,Tb.getDefaultDisplayName());m.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Tb.getDefaultDisplayName())}catch(pe){throw OfficeExt.DevConsole.log(pe),m.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+pe.message),pe;}else try{let pe=Rd.EWd(L.solutionId,Tb.getDefaultDisplayName()),ff=Rd.W4f();
pe&&this.nic.vmb(pe);ff&&this.CNd.bAf(ff);this.IHa.MAf(sb,pe,ff,Tb.getDefaultDisplayName());m.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Tb.getDefaultDisplayName())}catch(pe){throw m.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+pe.message),pe;}}}l5f(L,ba,Sa,sb,Tb,Tc=null){const Vb={};Vb.solutionId=L.solutionId;Vb.version=L.version;Vb.storeType=L.storeType;Vb.storeId=L.assetStoreId;Vb.assetId=L.assetId;Vb.assetStoreId=L.assetStoreId;Vb.targetType=
L.targetType;const Ed=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.FR.mS,this.FR.formFactor);try{const ae=ba.getManifest(),Rd=Ed.parse(Vb,ae,Tb,this.Mmb,ba.getSharedRuntimeId(),ba),pe=Sa(L),ff=sb(L),eg=new lc(pe,null,ff);eg.commandSurface="PrimaryCommandSurface";Rd.apply(eg,this.Mmb,!0);if(eg.ribbonBuilder.yE&&0<eg.ribbonBuilder.yE.count){const kh=eg.EWd(L.solutionId,ba.getManifest().getDefaultDisplayName(),1);A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.nic.vmb(kh,Tc):kh&&this.nic.vmb(kh,Tc);this.IHa.WZh(ba,kh,Tb,ba.getManifest().getDefaultDisplayName());m.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",ba.getManifest().getDefaultDisplayName())}}catch(ae){m.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",ba.getManifest().getDefaultDisplayName(),ae.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(ae)}}PCc(L){L.ZI&&this.nic.fDe(L.ZI);L.BVb&&this.CNd.TKk(L.BVb);
this.IHa.AKk(L.uL.getStoreType(),L.uL.getSolutionId())}Wki(L,ba){ba=Va(ba);for(let Sa of this.IHa.Htb){if(Sa.uL.getStoreType()!==ba)continue;let sb=!0;for(let Tb of L){const Tc=Tb;if(Tc&&Sa.Gvg(Tc.storeType,Tc.solutionId)){sb=!1;break}}sb&&(this.PCc(Sa),Sa.uL.purge(!1))}}lCh(L){return!!L&&!!L.solutionId&&!!L.version&&!!L.storeType&&!!L.storeId}}Object(h.a)(Mc,"AddInCommandsIntegration",null,[]);var Jc=d(1105),rb=d(163),cc=d(904),jb=d(566),Xb=d(390),yb=d(905),mb=d(150),Ub=d(96),ec=d(63),nc=d(57);class Lb{static get p6(){return Lb.sJ||
(Lb.sJ=nc.a.instance.qb("Common.Utils.IAriaNotifier"))}static DQf(L,ba,Sa,sb){Lb.yU&&Lb.yU.yK&&Lb.yU.dismiss();Lb.yU=Jc.a.LOd(ba,L,L,3);Lb.yU.content=Sa;Da.a(sb)||(Lb.yU.title=sb,Lb.yU.y1b=!0);L=new Sys.UI.Bounds(0,0,Ub.a.JNc(),Ub.a.INc());Lb.yU.DY=Lb.uXd(L,ba,Lb.yU.t$,1);Lb.yU.show();Lb.p6&&Lb.p6.sendNotification(Sa.innerText,!0)}static eOd(L,ba,Sa,sb=null){mb.UISurfaces.pV().then(Tb=>{let Tc=null;Lb.IPb&&(Tb.removeNotification(Lb.IPb),Lb.IPb=null);const Vb=Tb.callout(Object.assign(new cc.a,{target:L,
title:ba,content:Sa,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new yb.a,{onDismiss:()=>{Tb.removeNotification(Tc)},directionalHint:null!=sb?sb:null})})),Ed=Object.assign(new Xb.a,{expirationOptions:Object.assign(new jb.a,{displayTimeoutSeconds:7,onExpire:()=>{Tb.removeNotification(Lb.IPb)}})});Tc=Lb.IPb=Tb.addNotification(Vb,Ed);return null},Tb=>{m.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",Tb);return null})}static GKe(L){Lb.yU&&
Lb.yU.yK&&Lb.yU.dismiss();const ba=new y.StandardDialog;ba.YXa=!1;ba.vd=0;ba.Sx(rb.a.APj,CommonUIStrings.l_DialogError,Da.a(L)?Lb.a8f():L,null)}static Y8k(L){Lb.yU&&Lb.yU.yK&&Lb.yU.dismiss();m.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",L.errorCode));const ba=Da.a(L.description)?Lb.a8f():L.description,Sa=new y.StandardDialog;let sb=null;L.TTb?(Sa.vd=1,Sa.Pe(1,L.buttonText),Sa.hwa(1)):Sa.vd=0;sb=Tb=>{1===Tb?L.TTb():L.jXb&&L.jXb()};Sa.YXa=!1;0===L.i5d?
Sa.Sx(L.errorCode,L.title?L.title:CommonUIStrings.l_DialogError,ba,sb):1===L.i5d?Sa.nO(L.title?L.title:CommonUIStrings.l_DialogWarning,ba,sb):Sa.Wfb(L.title?L.title:CommonUIStrings.l_DialogInfo,ba,sb)}static uXd(L,ba,Sa,sb){let Tb=0===sb?0:4;const Tc=L.x+L.width-ba.x-ba.width;ba.x-L.x+ba.width/2<=Sa/2?Tb=0===sb?2:5:Tc+ba.width/2<=Sa/2&&(Tb=0===sb?3:6);return Tb}static i9k(L,ba,Sa,sb=!1){(ba=Ea.lrb(ba))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(ba,
Tb=>{Tb&&(sb||Lb.eOd(Tb,Sa,L,5))})}static j9k(L,ba,Sa=!1){Lb.i9k(ba.startedNode?ba.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,L),ba,ba.startedNode?ba.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,L),Sa)}static h9k(L,ba,Sa,sb){if(Lb.EBh)L=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Sa,sb,CommonUIStrings.l_InsertionDialogRefresh)),Lb.eOd(ba,L,CommonUIStrings.l_ErrorLoadingAddInsTitle,
1);else{ba=ec.a.ei(ba);var Tb=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),Tc=document.createElement("span");Tc.innerText=Tb[0];var Vb=document.createElement("span");Vb.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Sa,sb,CommonUIStrings.l_InsertionDialogRefresh);Vb.className="UIFontBold";Sa=document.createElement("span");Sa.innerText=Tb[1];sb=document.createElement("div");Sys.UI.DomElement.addCssClass(sb,"ModalCalloutControl");sb.appendChild(Tc);
sb.appendChild(Vb);sb.appendChild(Sa);Lb.DQf(L,ba,sb,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static E$k(L,ba){var Sa=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,sb=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;Lb.EBh?Lb.eOd(ba,Sa,sb):(ba=ec.a.ei(ba),Lb.DQf(L,ba,Lb.Kdi(sb),Sa))}static Kdi(L){const ba=document.createElement("div");Sys.UI.DomElement.addCssClass(ba,"ModalCalloutControl");ba.innerText=L;return ba}static a8f(){return CommonUIStrings.l_InternalError+" "+
CommonUIStrings.l_InternalError_Directive}static get EBh(){return A.AFrameworkApplication.Ba.jb.mo&&A.AFrameworkApplication.Ba.jb.JRa}}Lb.yU=null;Lb.IPb=null;Lb.sJ=null;Object(h.a)(Lb,"AddInCommandsNotificationFactory",null,[]);class Zc{constructor(L,ba,Sa,sb,Tb,Tc,Vb,Ed=null){this.Ta=new D.a;this.Wnd=L;this.ZHh=ba;this.cR=Sa;this.txf=sb;this.glb=Tb;this.vFh=Tc;this.yoc=Vb;this.OPh=Ed;this.xMh=A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.Ytd=
A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}W0h(L){this.Ta.addHandler(N.a.KCf,L)}Q1h(L){this.Ta.addHandler(N.a.fbe,L)}h4h(L){this.Ta.addHandler(N.a.roh,L)}h1h(L){this.Ta.addHandler(N.a.ZId,L)}PPj(L,ba,Sa){const sb=Sa[N.a.Szc],Tb=void 0===Sa[N.a.yaa]?0:Sa[N.a.yaa];if(sb&&0!==Tb)if(0>=sb.count&&4!==Tb)this.g4g(new ea(Tb,null,null,ba,null,!0));else{var Tc=sb.count,Vb=new Fa(new wb),Ed=void 0===Sa[N.a.Fza]?-1:Sa[N.a.Fza],ae=new Mc(Tb,this.cR,this.Wnd,
Vb,this.ZHh,this.glb,this.yoc),Rd=Wa=>this.txf.edi(Wa.solutionId,this.yoc,this.Wnd,L),pe=Wa=>this.txf.ici(Wa.solutionId),ff=(Wa,qb,dg)=>{Tc--;dg=new ea(Tb,qb,Vb,ba,dg,0>=Tc);if(Wa&&qb)this.g4g(dg);else{if(3===Tb||qb&&qb.isUpgraded)Wa="",qb&&(Wa=Telemetry.PrivacyRules.GetPrivacyCompliantId(qb.solutionId,qb.ownerAddinStoreType||qb.storeType,qb.assetId,null,null,qb.storeId)),qb={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:Wa},ca.a.sendTelemetryEvent(Object.assign(new Z.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.bD(qb)}));this.f4g(dg)}Tc||A.AFrameworkApplication.Ba.updateCommandUI()},eg=(Wa,qb,dg,zb)=>{ff(Wa,qb,zb)},kh=()=>{this.bte();0>=sb.count&&4===Tb&&this.glb.HHe()};6===Tb?(Ed=Sa[N.a.zHi],Sa=Sa[N.a.AHi],ae.GPj(sb.ga(0),Ed,Sa,Rd,pe,(Wa,qb,dg,zb)=>{ff(Wa,qb,zb)})):ae.SUc(sb,Rd,pe,Ed,eg,kh,this.OPh)}else ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.bD({["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),m.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.Wnd.mS)),this.f4g(new ea(Tb,null,null,ba,null,!0))}f4g(L){this.bte(L);this.hph(!1,L)}g4g(L){const ba=L.eu;let Sa=null;null!==ba&&(Sa=ba.storeType,Sa=Sa.toLowerCase());if(L&&"omex"===Sa&&(3===L.Ax||ba.isUpgraded)){var sb={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ba.solutionId,
ba.ownerAddinStoreType||ba.storeType,ba.assetId,null,null,ba.storeId)};ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.bD(sb)}))}this.bte(L);sb=this.Ytd&&Ya()&&"omex"===Sa&&!!L.N9&&!!ba.solutionId&&2===L.Ax&&ba.solutionId.toLowerCase()===Ua().toLowerCase();if("omex"===Sa&&L.N9&&(3===L.Ax&&"hardcodedpreinstall"!==Sa||ba.isUpgraded)||sb)sb=new P,sb.eu=ba,sb.ZI=L.N9.eSa,this.Ta.raiseEvent(N.a.ZId,sb);if(this.xMh){sb=qa();const Tb=Ua();sb&&ba&&
"excatalog"===ba.storeType&&L.N9&&5===L.Ax&&Tb&&(ba.storeId&&ba.storeId.toLowerCase()===Tb.toLowerCase()||ba.assetId&&ba.assetId.toLowerCase()===Tb.toLowerCase())&&(sb=new P,sb.eu=ba,sb.ZI=L.N9.eSa,this.Ta.raiseEvent(N.a.ZId,sb),m.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}ba&&(fb.instance.Eih(ua(Sa),!0),"uploadfiledevcatalog"===Sa&&(sb=this.vFh.createAddinDataProvider(Sa,this.cR))&&sb.localCacheAddinCommands(this.cR.kva,ba.solutionId,ba.version,ba.storeId),
W.a.GIb(N.a.GSb,"true",ua(Sa)));this.hph(!0,L)}hph(L,ba){L?A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&ba.N9&&5===ba.Ax&&ba.N9.eSa&&void 0!==ba.eu.showCallout&&null!==ba.eu.showCallout&&ba.eu.showCallout?(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new va(this.Ta)).yFd(ba.eu,Ea.lrb(ba.N9.eSa)):(new pa(this.Ta,ba.eu,Ea.lrb(ba.N9.eSa))).yFd(),L=new P,
L.ZI=ba.N9.eSa,L.eu=ba.eu,this.Ta.raiseEvent(N.a.roh,L)):3!==ba.Ax?ba.gyg&&this.glb.HHe():ba.N9&&ba.N9.eSa&&"hardcodedpreinstall"!==ba.eu.storeType&&Lb.j9k(ba.displayName,ba.N9.eSa,ba.eu.isAutoLaunched):3===ba.Ax?ba.eu&&"uploadfiledevcatalog"===ba.eu.storeType.toLowerCase()?(ba=this.yoc.J0i(ba.eu.solutionId),Lb.GKe(ba?ba:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.glb.v_k():ba.gyg&&this.glb.HHe()}bte(L=null){var ba=L?L.eu:null;const Sa=new P;if(Sa.eu=ba){var sb=
this.glb.k5a(ba.storeType,ba.solutionId,6===L.Ax?1:0);if(sb&&sb.ZI){Sa.ZI=sb.ZI;var Tb=this.Ytd?Ua():null;Tb=this.Ytd&&Ya()&&!!ba.solutionId&&!!Tb&&ba.solutionId.toLowerCase()===Tb.toLowerCase()&&2===L.Ax;if(3===L.Ax&&"hardcodedpreinstall"!==ba.storeType||Tb)L="",sb.ZI.B9&&sb.ZI.B9.yE&&(sb=sb.ZI.B9.yE.ga(0))&&(L=sb.id),ba={["SDX_CommandPlacement"]:L,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ba.solutionId,ba.ownerAddinStoreType||
ba.storeType,ba.assetId,null,null,ba.storeId)},ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:K.a.bD(ba)}))}}this.Ta.raiseEvent(N.a.KCf,Sa)}}Object(h.a)(Zc,"LaunchAddinCommandsHandler",null,[1098]);class Pb{constructor(L){this.hQh=L}get kva(){return this.hQh}insertOsfControl(L){return this.kva.insertOsfControl(L)}getManifestInvaildErrorString(){return this.kva.getManifestInvaildErrorString()}isAddinCommandsAsync(L,ba){this.kva.isAddinCommandsAsync(L,
ba)}isAddinCommandsExAsync(L,ba){this.kva.isAddinCommandsExAsync(L,ba)}ownerAddinControlRecreated(L,ba){this.kva.ownerAddinControlRecreated(L,ba)}queryEntitlementDetails(L){this.kva.queryEntitlementDetails(L)}}Object(h.a)(Pb,"ContextActivationMgrWrapper",null,[1099]);class eb{}eb.Lhb="Alt";eb.Mhb="Command";eb.id="Id";eb.qZa="Image16by16";eb.Nhb="LabelText";eb.button="Button";eb.HVd="FlyoutAnchor";Object(h.a)(eb,"AddinDataNodeConstants",null,[]);var $a=d(220),vb=d(395),bc=d(340),Cc=d(76);class Gc{constructor(L,
ba){this.Rtc=this.pYe=null;if(Da.b(L)||Da.b(ba))throw m.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.dqd=ba;this._id=L;this.FM[eb.id]=this._id}get id(){return this._id||""}get FM(){return this.pYe||(this.pYe={})}get controlType(){return this.dqd||""}get menuItems(){return this.Rtc||(this.Rtc=new e.a)}jmc(){let L=null;this.dqd===eb.HVd?L=Object.assign(new vb.a,{Menu:this.F$j()}):
this.dqd===eb.button&&(L=Object.assign(new $a.a,{}));L&&(this.FM[eb.id]&&(L.ExternalId=this.FM[eb.id]),this.FM[eb.Mhb]&&(L.Command=this.FM[eb.Mhb].toString()),this.FM[eb.Nhb]&&(L.LabelText=this.FM[eb.Nhb]),this.FM[eb.Lhb]&&(L.Alt=this.FM[eb.Lhb]),this.FM[eb.qZa]&&(Cc.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.FM[eb.qZa]),L.ExternalImageId=this._id));return L}F$j(){const L=Object.assign(new bc.a,{UpdateDynamically:!0,MenuSectionList:[]});if(this.Rtc){const ba=
Object.assign(new r.a,{ControlList:[]});for(let Sa of this.Rtc)Array.add(ba.ControlList,Sa.jmc());Array.add(L.MenuSectionList,ba)}return L}}Object(h.a)(Gc,"ControlDefinition",null,[1097]);class sd{constructor(L){this.W$=null;if(Da.b(L))throw m.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=L;this.wbc[eb.id]=this._id}get wbc(){return this.W$||(this.W$={})}get id(){return this._id||
""}jmc(){const L=Object.assign(new $a.a,{});this.W$[eb.id]&&(L.ExternalId=this.W$[eb.id]);this.W$[eb.Mhb]&&(L.Command=this.W$[eb.Mhb].toString());this.W$[eb.Nhb]&&(L.LabelText=this.W$[eb.Nhb]);this.W$[eb.Lhb]&&(L.Alt=this.W$[eb.Lhb]);this.W$[eb.qZa]&&(Cc.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.W$[eb.qZa]),L.ExternalImageId=this._id);return L}}Object(h.a)(sd,"MenuItemDefinition",null,[1136]);class Sd{constructor(L){this.Rpc=null;if(Da.b(L))throw m.ULS.sendTraceTag(9175314,
220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=L}get id(){return this._id}get controls(){return this.Rpc||(this.Rpc=new e.a)}jmc(){const L=[];if(this.Rpc)for(let ba of this.Rpc){const Sa=ba.jmc();Sa&&L.push(Sa)}return L}}Object(h.a)(Sd,"OfficeMenuDefinition",null,[1096]);var ie=d(35);class De{constructor(L,ba,Sa){this.oU=this.Zib=null;this.Bxd=L;this.Gib=ba;this.Vhb=Sa;this.XOh=new e.a}get u5c(){return this.Bxd}get eVb(){return this.Gib}get VEd(){return this.Vhb}addButton(L){m.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",L.actionType);this.oU=new Gc(this.iNa(L.id),eb.button);this.oU.FM[eb.Nhb]=L.label;this.oU.FM[eb.Lhb]=L.label;this.oU.FM[eb.qZa]=L.icon["16"];this.ATb(this.oU.FM[eb.id],L.action);this.t2a(this.oU.FM);this.Zib.controls.add(this.oU);this.oU=null}startBuildMenu(L){if(Da.b(this.Zib))this.Zib=new Sd(L.id);else{const ba=this.iNa(L.id);this.oU=new Gc(ba,eb.HVd);this.Qnb(this.oU.FM,L);this.oU.FM[eb.qZa]=L.icon["16"];this.oU.FM[eb.Mhb]=ie.a.Ymb}}addMenuItem(L){m.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",L.actionType);const ba=new sd(this.iNa(L.id));this.Qnb(ba.wbc,L);L.icon&&(ba.wbc[eb.qZa]=L.icon["16"]);this.ATb(ba.wbc[eb.id],L.action);this.t2a(ba.wbc);this.oU.menuItems.add(ba)}endBuildMenu(){Da.b(this.oU)?(this.K4c.add(this.Zib),this.Zib=null):(this.Zib.controls.add(this.oU),this.oU=null)}get K4c(){return this.XOh}ATb(L,ba){this.VEd.bindAction(L,ba)}t2a(L){this.eVb.t2a(L)}iNa(L){return this.u5c.IBa(L)}Qnb(L,ba){L[eb.Nhb]=ba.label;L[eb.Lhb]=ba.label}}
Object(h.a)(De,"ContextMenuExtensibilityCreator",null,[1127,1124]);class yd{constructor(L){this.KOb=L}get Xbc(){return this.KOb}IBa(L){return this.Xbc+L}}Object(h.a)(yd,"DefaultContextMenuNamingProvider",null,[1126]);class ib{constructor(L,ba,Sa,sb){this.KOb=L;A.AFrameworkApplication.fa.ka("AddInCommandsMissingTabIsEnabled")&&Sa.d5i();this.gGh=this.Wuf=ba;this.GTh=sb}get Xbc(){return this.KOb}get solutionId(){return this.Wuf}get assetId(){return this.gGh}get lKe(){return this.GTh}IBa(L){L=this.Xbc+
this.solutionId+L;return this.lKe?(L in ib.Tzc||(ib.Tzc[L]="AddinControl"+ib.X4h++),ib.Tzc[L]):L}uTf(L){if(this.lKe){const Sa=ib.Tzc;for(let sb in Sa){var ba=sb;if(L===Sa[sb])return ba.substr(this.Xbc.length+this.solutionId.length)}}return L}Ccj(L){L=this.Xbc+this.solutionId+L;return this.lKe?(L in ib.MGd||(ib.MGd[L]="AddinTab"+ib.d5h++),ib.MGd[L]):L}}ib.Tzc={};ib.MGd={};ib.d5h=0;ib.X4h=0;Object(h.a)(ib,"DefaultRibbonNamingProvider",null,[1095]);class dc{bindAction(L,ba){OfficeExt.DefaultControlActionBinder.bindAction(L,
ba)}}Object(h.a)(dc,"DefaultUIControlActionBinder",null,[1125]);class Bc{constructor(L){this.DHh=L}get command(){return this.DHh}t2a(L){L[eb.Mhb]=this.command}}Object(h.a)(Bc,"DefaultUIControlCommandBinder",null,[1122]);var Ob=d(522);class yc{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(h.a)(yc,"AddInControl",null,[]);class fc{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=
null}}Object(h.a)(fc,"AddInGroup",null,[]);class Nb{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(h.a)(Nb,"AddInMenuItem",null,[]);class lb{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(h.a)(lb,"AddInTab",null,[]);class Qc{constructor(L,ba,Sa,sb,Tb,Tc){this.uoc=new e.a;this.fLb=this.Rxa=this.$ib=null;this.Bxd=L;this.Vhb=
ba;this.Gib=Sa;this.Wuf=sb;this.yoc=Tb;this.e1e=Tc}get u5c(){return this.Bxd}get yE(){return this.uoc}get VEd(){return this.Vhb}get eVb(){return this.Gib}startBuildTab(L){const ba=L.isOfficeTab?L.id:this.u5c.Ccj(L.id),Sa=L.isOfficeTab?null:L.label;this.$ib=Object.assign(new lb,{id:ba,title:Sa,isOfficeTab:L.isOfficeTab,visible:L.visible,groups:[],tabType:L.tabType,insertBefore:L.insertBefore,insertAfter:L.insertAfter,autoFocus:L.autoFocus})}startBuildGroup(L){const ba=this.iNa(L.id);this.Rxa=Object.assign(new fc,
{id:ba,mlrId:L.mlrId,title:L.label,controls:[],groupType:0})}addNativeGroup(L){this.Rxa=Object.assign(new fc,{id:L.id,mlrId:L.mlrId,title:L.label,controls:[],groupType:1});this.$ib.groups.push(this.Rxa)}addButton(L){const ba=this.iNa(L.id);ba&&(this.ATb(ba,L.action),m.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",L.actionType),L=Object.assign(new yc,{id:ba,title:L.label,iconLocation:this.cZd(L),enabled:L.enabled,controlType:0,attributes:this.Qnb()}),this.e1e.Jzf(new Ob.a(ba,
this.eVb.command.toString())),this.Rxa.controls.push(L))}addNativeControl(L){L.id&&(m.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",L.actionType),L=Object.assign(new yc,{id:L.id,title:"",iconLocation:"",enabled:L.enabled,controlType:2,attributes:this.Qnb()}),this.Rxa.controls.push(L))}startBuildMenu(L){const ba=this.iNa(L.id);ba&&(this.fLb=Object.assign(new yc,{id:ba,title:L.label,iconLocation:this.cZd(L),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(L){const ba=
this.iNa(L.id);ba&&(this.ATb(ba,L.action),m.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",L.actionType),L=Object.assign(new Nb,{id:ba,title:L.label,iconLocation:this.cZd(L),enabled:L.enabled,attributes:this.Qnb()}),this.e1e.Jzf(new Ob.a(ba,this.eVb.command.toString())),this.fLb.menuItems.push(L))}endBuildMenu(){Da.b(this.fLb.id)||this.Rxa.controls.push(this.fLb);this.fLb=null}endBuildGroup(){Da.b(this.Rxa.id)||this.$ib.groups.push(this.Rxa);this.Rxa=null}endBuildTab(){Da.b(this.$ib.id)||
this.uoc.add(this.$ib);this.$ib=null}Qnb(){const L={};this.t2a(L);return L}cZd(L){return L.icon["80"]?L.icon["80"]:L.icon["32"]}t2a(L){this.eVb.t2a(L)}iNa(L){return this.u5c.IBa(L)}ATb(L,ba){this.VEd.bindAction(L,ba)}}Object(h.a)(Qc,"OneLineRibbonExtensibilityCreator",null,[1123,1124]);class Rc{constructor(L,ba){this.KOb=L;this.Vhb=new dc;this.Gib=new Bc(ba)}ici(L){L=new yd(L);return new De(L,this.Gib,this.Vhb)}edi(L,ba,Sa,sb){Sa=new ib(this.KOb,L,Sa,!0);return new Qc(Sa,this.Vhb,this.Gib,L,ba,sb)}}
Object(h.a)(Rc,"UIExtensibilityFactory",null,[1093]);class ld{createAddinDataProvider(L,ba){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(L,ba.kva)}static get instance(){ld.Ka||(ld.Ka=new ld);return ld.Ka}}ld.Ka=null;Object(h.a)(ld,"OSFAddinDataProviderFactory",null,[1094]);class Dd{constructor(){this.Nmb=null}setErrorMessageForAddin(L,ba){this.Nmb||(this.Nmb={});this.Nmb[L]=ba}J0i(L){return this.Nmb&&L in this.Nmb?this.Nmb[L]:null}}Object(h.a)(Dd,"AddinCommandsErrorManager",null,
[]);class gd{constructor(){this.i5d=0;this.TTb=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.ljg=!1;this.Orj=this.jXb=null}}Object(h.a)(gd,"AddInCommandsNotificationParameters",null,[]);class be{constructor(){this.YVe=this.Bnd=null}get WEd(){return this.Bnd||(this.Bnd=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set WEd(L){this.Bnd=L}get u$h(){return this.YVe||(this.YVe=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromAssetIdRuntimeId(L,
ba){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(L,ba)}$0b(L,ba,Sa,sb,Tb){m.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",L);if((L=ba.k5a(Tb.ownerAddinInfo.storeType,Tb.ownerAddinInfo.solutionId))&&L.uL&&!L.uL.getIsUpgrading())if(ba=null,0<L.uL.getNotificationParams().length&&(ba=this.eIf(L.uL.getNotificationParams()[0]))&&2147758681===ba.errorCode&&(L.isUpgraded=!0),2!==L.uL.getStatus()&&(1!==L.uL.getStatus()||ba&&2147758681===ba.errorCode))ba&&this.ooh(L,
ba,null);else try{Sa.setOwnerAddinEToken(L.uL.getEToken()),Tb.action(Sa,sb.kva)}catch(Tc){m.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",A.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Tc.stack:Tc.message)),Lb.GKe(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}ooh(L,ba,Sa=null){const sb=L.uL;if(1===sb.getNotificationParams().length||ba.ljg){const Tb=ba.TTb,Tc=ba.jXb;
ba.TTb=()=>{sb.removeFirstNotification();if(0<sb.getNotificationParams().length){const Vb=this.eIf(sb.getNotificationParams()[0]);this.ooh(L,Vb)}2147758681===ba.errorCode&&(wb.UEi(L.ZI,sb,Object(H.a)(this,this.dlg,"initUpgradeStateDetectTask")),v.PEi(L.BVb,sb,Object(H.a)(this,this.dlg,"initUpgradeStateDetectTask")));Tb&&Tb()};ba.jXb=()=>{Tc&&Tc();Sa&&Sa()};Lb.Y8k(ba)}}dlg(L,ba){let Sa=null;Sa=()=>{L.getIsUpgrading()?window.setTimeout(Sa,1E3):L.getUpgradingFailed()?wb.xfd(ba,!0):A.AFrameworkApplication.Ba.updateCommandUI()};
window.setTimeout(Sa,1E3)}eIf(L){const ba=new gd;ba.i5d=L.infoType;ba.id=L.id;ba.title=L.title;ba.description=L.description;ba.buttonText=L.buttonTxt;ba.TTb=L.buttonCallback;ba.ljg=L.highPriority;ba.jXb=L.dismissCallback;ba.errorCode=L.errorCode;ba.Orj=L.iframeNotificationUrl;return ba}}Object(h.a)(be,"AddinCommandsActionHandler",null,[1104]);class od{constructor(){this.labelText=null;this.visible=!1}}Object(h.a)(od,"AddinStatusCommandValues",null,[]);class $d{static qAk(L){const ba=new od;ba.labelText=
L.HSb;ba.visible=ba.labelText?!0:!1;return ba}static nLe(){const L=document.getElementById(void 0);L?$d.cph(void 0,void 0,L,void 0,void 0):m.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",void 0))}static cph(L,ba,Sa,sb,Tb){Sa?L.HSb===CommonUIStrings.l_ErrorLoadingAddInsTitle?Lb.h9k(ba,Sa,sb,Tb):L.HSb===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Lb.E$k(ba,Sa):m.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}
Object(h.a)($d,"AddinCommandsStatusHandler",null,[]);class xf{constructor(){this.Ax=this.G_=0;this.EGd=null;this.N$c=this.jkd=0;this.cKa=this.osd=this.Und=this.$Dc=this.vBa=this.spa=null}get JCf(){this.Und||(this.Und=new e.a);return this.Und}get xWd(){this.osd||(this.osd=new e.a);return this.osd}get Q3a(){this.cKa||(this.cKa=new e.a);return this.cKa}}Object(h.a)(xf,"AddinCommandsListLoaderContext",null,[]);const Na=L=>{const ba={};ba.solutionId=L.solutionId;ba.version=L.version;ba.storeType=L.storeType;
ba.storeId=L.storeId;ba.assetId=L.assetId;ba.assetStoreId=L.assetStoreId;ba.targetType=L.targetType;ba.requireConsent=L.requireConsent||!1;ba.isAddinCommands=!0;ba.addinCommandsActionType=0;return ba};class xb{constructor(L,ba){this.entitlement=L;this.metadata=ba}Rjl(){const L=Na(this.entitlement);L.targetType=this.targetType;return L}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(h.a)(xb,"AddinEntitlementEx",null,[]);var sc=d(21);class cd{constructor(L){this.rg=null;this.L$=L}get_current(){if(!this.rg)throw Error.argumentOutOfRange();return this.rg.data}moveNext(){if(!this.rg)return this.rg=this.L$,!!this.L$;if(!this.rg.next)return!1;
this.rg=this.rg.next;return!0}reset(){this.rg=this.L$}}Object(h.a)(cd,"ListEnumerator",null,[0]);class Ta{constructor(L,ba,Sa){this.next=Sa;this.previous=ba;this.data=L}}Object(h.a)(Ta,"ListNode",null,[]);class Hb{constructor(){this.L1a=this.yfa=null;this.Hk=0}add(L){this.yfa?this.L1a=this.L1a.next=new Ta(L,this.L1a,null):this.yfa=this.L1a=new Ta(L,null,null);this.Hk=this.count+1}insert(L,ba){if(L>this.count||0>L)throw Error.argumentOutOfRange("pos");if(L===this.count)this.add(ba);else{for(var Sa=
this.yfa;0!==L--;)Sa=Sa.next;L=new Ta(ba,Sa.previous,Sa);L.previous?L.previous.next=L:this.yfa=L;L.next?L.next.previous=L:this.L1a=L;this.Hk=this.count+1}}remove(L){let ba=this.yfa;for(;ba&&ba.data!==L;)ba=ba.next;if(!ba)return!1;ba.previous?ba.previous.next=ba.next:this.yfa=ba.next;ba.next?ba.next.previous=ba.previous:this.L1a=ba.previous;this.Hk=this.count-1;return!0}clear(){let L=this.yfa,ba;for(this.L1a=this.yfa=null;L;)ba=L.next,L.previous=null,L.next=null,L=ba;this.Hk=0}indexOf(L){let ba=this.yfa,
Sa=0;for(;ba&&ba.data!==L;)ba=ba.next,Sa++;return ba?Sa:-1}ga(L){return this.at(L).data}get count(){return this.Hk}getEnumerator(){return new cd(this.yfa)}[Symbol.iterator](){return Object(sc.a)(this.getEnumerator())}toArray(){const L=Array(this.count);let ba=0;for(let Sa of this)L[ba]=Sa,ba++;return L}at(L){let ba=this.yfa,Sa=0;for(;Sa!==L;){if(!ba)throw Error.argumentOutOfRange("pos");ba=ba.next;Sa++}return ba}}Object(h.a)(Hb,"List",null,[1]);class oc extends Sys.EventArgs{constructor(L){super();
this.properties=L}}Object(h.a)(oc,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class Oc{constructor(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}}Object(h.a)(Oc,"MiniAddinInfo",null,[]);class Yc{constructor(L,ba,Sa){this.ep=new D.a;this.context=new xf;this.bDd=this.Srh=this.nMe=this.I2a=this.W_=this.A$=null;this.contextActivationMgr=L;this.Y4h=ba;this.J2a=Sa;this.appName=A.AFrameworkApplication.fa.Ia("WebAppShortName")}get guh(){this.bDd||(this.bDd=new va(this.ep));
return this.bDd}V0h(L){this.ep.addHandler(N.a.FSb,L)}j4h(L){this.ep.addHandler(N.a.IKe,L)}dol(L){null!==L&&(this.context.G_=L[N.a.Fza],this.context.Ax=L[N.a.yaa],this.context.jkd=this.context.N$c=0,L=N.a.Omb in L?L[N.a.Omb]:0,-1!==this.context.G_&&0!==this.context.Ax&&(this.context.spa=new Hb,this.context.vBa=new Hb,this.context.$Dc=new Hb,this.context.EGd=this.Y4h.createAddinDataProvider(Va(this.context.G_),this.contextActivationMgr),this.context.EGd?this.context.EGd.getEntitlementsAsync(this.contextActivationMgr.kva,
!0,L,ba=>{this.Qik(ba)}):m.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.G_)))}Qik(L){if(L&&0<L.length){this.context.jkd=L.length;const Sa=A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Ua():null;for(let sb=0;sb<L.length;sb++){const Tb=L[sb];if(A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&Ya()&&Tb&&Tb.storeType&&"omex"===Tb.storeType.toLowerCase()&&Tb.assetId&&
Sa&&Tb.assetId.toLowerCase()===Sa.toLowerCase()){var ba={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:Yc.sV(Tb)};ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.bD(ba)}))}!Tb||1!==Tb.targetType&&-1!==Tb.targetType?this.d6c():(ba={},A.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(ba.solutionId=Tb.solutionId,ba.version=Tb.version):(ba.marketplaceId=
Tb.solutionId,ba.marketplaceVersion=Tb.version),ba.storeType=Tb.storeType,ba.storeId=Tb.storeId,ba.targetData=Tb,Yc.Elc?this.contextActivationMgr.isAddinCommandsExAsync(ba,Object(H.a)(this,this.Aik,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(ba,(Tc,Vb,Ed)=>{Tc?(Vb&&this.context.spa.add(Ed.targetData),10===this.context.G_&&(Tc=Ed.targetData,Vb=Tc.targetType,Da.b(Ed.targetTypeForExp)||(Vb=Ed.targetTypeForExp,Tc.targetType=Vb),this.context.vBa.add(Tc),0===Vb&&this.context.$Dc.add(Tc))):
(Ed=Ed.targetData,m.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ed.solutionId,Ed.storeType,Ed.assetId,null,null,Ed.storeId),Ed.storeType));this.d6c()}))}}else this.d6c()}d6c(){var L;(L=this.context).N$c=L.N$c+1;this.context.N$c>=this.context.jkd&&(this.J2a.Eih(this.context.G_,!1),0<this.context.jkd&&10===this.context.G_&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(L=!1,A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&
qa()&&(L=this.BTj()),this.USj(),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!L?Yc.Elc?this.guh.hml(this.contextActivationMgr,this.context.JCf,this.context.Q3a,(ba,Sa)=>{const sb=new e.a;for(let Tb of ba)ba=Tb.Rjl(),Sa&&Sa.solutionId===Tb.solutionId&&(ba.showCallout=!0,this.guh.JAh(Sa)),sb.add(ba);this.mHa(sb)}):this.zVi(this.context.spa):this.Xyc(this.context.spa)):this.Xyc(this.context.spa))}Xyc(L){if(Yc.Elc)this.mHa(this.yoi(L));
else{var ba=new e.a;if(L)for(let Sa of this.context.spa)ba.add(Na(Sa));this.context.spa&&1>this.context.spa.count&&W.a.GIb(N.a.GSb,"false",this.context.G_);L={["ack2"]:ba};L[N.a.Fza]=this.context.G_;L[N.a.yaa]=this.context.Ax;this.ep.raiseEvent(N.a.FSb,new oc(L),this)}}yoi(L){const ba=new e.a;if(L)for(let Sa of L)ba.add(Na(Sa));return ba}mHa(L){L&&L.count||W.a.GIb(N.a.GSb,"false",this.context.G_);L={["ack2"]:L};L[N.a.Fza]=this.context.G_;L[N.a.yaa]=this.context.Ax;this.ep.raiseEvent(N.a.FSb,new oc(L),
this)}zma(L){if(this.appName){const ba={},Sa={};Sa.LastTeachingUIShowTime=(new Date).toUTCString();Sa.AddinHasShown=L;ba[this.appName]=da.c(Sa);this.A$&&(this.A$.yqb(ba),m.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else m.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}zVi(L){(this.I2a=L)?(L=new e.a,L.add(this.appName),this.A$=new oa(this.appName,Object(H.a)(this,
this.$Ba,"getRequestSuccessCallback"),Object(H.a)(this,this.aia,"getRequestFailureCallback"),Object(H.a)(this,this.E9,"postRequestFailureCallback")),this.A$.cIc(L)):(L={["ack2"]:new e.a},L[N.a.Fza]=this.context.G_,L[N.a.yaa]=this.context.Ax,this.ep.raiseEvent(N.a.FSb,new oc(L),this))}$Ba(L){L?this.vKe(L)?(m.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.W_="AddinHasShown"in L&&L.AddinHasShown?L.AddinHasShown.toString():null,this.oVb()):(m.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),
this.Xyc(this.I2a)):(m.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.W_=null,this.oVb())}aia(L){m.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",L?L.tf:-1);this.Xyc(this.I2a)}E9(L){m.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",L?L.tf:-1)}oVb(){const L=this.YQd();if(0===L.targetType){L.solutionId?(this.nMe=L.solutionId,this.Srh=L.storeId,this.oAe()):this.KDa("NoSolutionId");
if(L.addinId){const ba=this.W_?this.W_+","+L.addinId:L.addinId;A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=ba:this.zma(ba)}this.DAf(null)}else this.DAf(L.addinId);m.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",L.addinId)}oAe(){const L=new Ka.a;L.callbackFunc=ba=>{if(ba.errorCode){if(this.KDa("FailToGetAppDetails"),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)){var Sa=window.g_roamingAddinList;Sa&&this.zma(Sa)}}else if(ba.value)for(Sa of ba.value){var sb=Sa[1];if(sb===this.nMe){ba={};ba.solutionId=sb;ba.assetId=Sa[5];sb=A.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");ba.storeType=sb?Sa[12]:Sa[6];A.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?ba.storeId=this.Srh:ba.storeId=Sa[11];ba.assetStoreId=Sa[6];ba.targetType=Sa[3];ba.width=Sa[7];ba.height=Sa[8];ba.displayName=Sa[0];ba.version=Sa[4];
Sa=new ra(ba);this.ep.raiseEvent(N.a.IKe,Sa);break}}};L.storeType=OSF.StoreTypeEnum.PrivateCatalog;L.fromInsertDialog=!1;L.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(L)}vKe(L){if("LastTeachingUIShowTime"in L){if(L=+new Date-+new Date(L.LastTeachingUIShowTime.toString()),L<A.AFrameworkApplication.fa.xP("AddinShowTeachingUIIntervalInMS",864E5))return m.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",L),!1}else m.ULS.sendTraceTag(527523846,
306,50,"userSetting has no date key");return!0}YQd(){let L=new Ja.a(new Oc,0),ba=new Ja.a(new Oc,0),Sa=0,sb=0,Tb=0;var Tc=new Hb;if(0<this.context.spa.count)for(var Vb of this.context.spa)Tc.add(Vb);if(0<this.context.$Dc.count)for(let Ed of this.context.$Dc)Tc.add(Ed);for(let Ed of Tc)if(!("excatalog"!==Ed.storeType||Da.b(Ed.installTimeInMS)||!Ed.installTimeInMS||Ed.installTimeInMS<=A.AFrameworkApplication.fa.xP("DateTimeInMSForNewAddin",16409952E5))){Tc=Yc.GZb(Ed);if(this.W_&&(Vb=this.W_.split(","),
0<Vb.length&&Array.contains(Vb,Tc))){Tb++;m.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}Tc.startsWith("private_")?(L.value<Ed.installTimeInMS&&(L=new Ja.a(Object.assign(new Oc,{addinId:Tc,targetType:Ed.targetType,storeId:Ed.storeId,solutionId:Ed.solutionId}),Ed.installTimeInMS)),sb++):(ba.value<Ed.installTimeInMS&&(ba=new Ja.a(Object.assign(new Oc,{addinId:Tc,targetType:Ed.targetType,storeId:Ed.storeId,solutionId:Ed.solutionId}),Ed.installTimeInMS)),Sa++)}m.ULS.sendTraceTag(528345033,
306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",sb,Sa,Tb);return 0<ba.value?ba.key:0<L.value?L.key:Object.assign(new Oc,{addinId:null,targetType:-1,solutionId:null,storeId:null})}DAf(L){const ba=new e.a;for(let sb of this.I2a){const Tb=Na(sb);if(L){var Sa=Yc.GZb(sb);L===Sa&&(Tb.showCallout=!0,Sa=this.W_?this.W_+","+L:L,A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=
Sa:this.zma(Sa))}ba.add(Tb)}this.I2a&&1>this.I2a.count&&W.a.GIb(N.a.GSb,"false",this.context.G_);L={["ack2"]:ba};L[N.a.Fza]=this.context.G_;L[N.a.yaa]=this.context.Ax;this.ep.raiseEvent(N.a.FSb,new oc(L),this)}BTj(){if(Yc.Elc)return this.CTj(this.context.xWd);var L=!1;if(this.context.vBa&&1>this.context.vBa.count)return L;const ba=Ua();if(!ba)return L;for(let Sa of this.context.vBa)if(Sa.storeId&&Sa.storeId.toLowerCase()===ba.toLowerCase()||Sa.assetId&&Sa.assetId.toLowerCase()===ba.toLowerCase())L=
{["SDX_Id"]:Yc.sV(Sa),["SDX_TargetType"]:Da.b(Sa.targetType)?"":Sa.targetType.toString()},ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:K.a.bD(L)})),L=!0;return L}USj(){if(Yc.Elc)this.VSj(this.context.xWd);else if(!(this.context.vBa&&1>this.context.vBa.count))if(this.J2a.Ftg()){var L=this.J2a.ubg();L?(L=this.B7f(this.context.vBa,L),m.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(L=this.B7f(this.context.vBa,
null),m.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.J2a.qkh(L)}else m.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}B7f(L,ba){const Sa={};let sb=!1;for(let Tb of L)if(L=Yc.sV(Tb))!ba||L in ba||(this.tSa(Tb,L),m.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===L.toLowerCase()?sb||(sb=!0,Sa[L]=null):Sa[L]=null;return Sa}tSa(L,ba){var Sa=L.installTimeInMS?(new Date(L.installTimeInMS)).toISOString():"";Sa={["SDX.Id"]:ba,["SDX.AppInstallOrigin"]:"Organization",
["SDX.TargetType"]:Da.b(L.targetType)?"":L.targetType.toString(),["SDX.AdminDeploymentTime"]:Sa};ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.bD(Sa)}));1===L.targetType&&(L={["SDX.Id"]:ba,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:K.a.bD(L)})))}CTj(L){let ba=!1;if(L&&1>L.count)return ba;const Sa=Ua();if(!Sa)return ba;
for(let sb of L)if(sb.storeId&&sb.storeId.toLowerCase()===Sa.toLowerCase()||sb.assetId&&sb.assetId.toLowerCase()===Sa.toLowerCase())L={["SDX_Id"]:Yc.wbg(sb),["SDX_TargetType"]:Da.b(sb.targetType)?"":sb.targetType.toString()},ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:K.a.bD(L)})),ba=!0;return ba}VSj(L){if(!(L&&1>L.count))if(this.J2a.Ftg()){var ba=this.J2a.ubg();ba?(L=this.C7f(L,ba),m.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):
(L=this.C7f(L,null),m.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.J2a.qkh(L)}else m.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}C7f(L,ba){const Sa={};let sb=!1;for(let Tb of L)if(L=Yc.wbg(Tb))!ba||L in ba||(this.IVj(Tb,L),m.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===L.toLowerCase()?sb||(sb=!0,Sa[L]=null):Sa[L]=null;return Sa}IVj(L,ba){var Sa=L.installTimeInMS?(new Date(L.installTimeInMS)).toISOString():"";Sa={["SDX.Id"]:ba,
["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Da.b(L.targetType)?"":L.targetType.toString(),["SDX.AdminDeploymentTime"]:Sa};ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.bD(Sa)}));1===L.targetType&&(L={["SDX.Id"]:ba,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:K.a.bD(L)})))}Aik(L,ba,Sa,sb){L?(-1===
sb.targetType&&(sb.targetType=Sa.targetTypeForExp),L=new xb(Sa.targetData,sb),ba&&this.context.JCf.add(L),10===this.context.G_&&(this.context.xWd.add(L),0===L.targetType&&this.context.Q3a.add(L))):(ba=Sa.targetData,m.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ba.solutionId,ba.storeType,ba.assetId,null,null,ba.storeId),ba.storeType));this.d6c()}KDa(L){L={["AppTeachingUICalloutAction"]:L,["SDX.Id"]:this.nMe,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.bD(L)}))}static get Elc(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)}static sV(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}static wbg(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,
L.storeType,L.assetId,null,null,L.storeId)}static GZb(L){return Telemetry.PrivacyRules.IsPrivateAddin(L.storeType,L.assetId,null,null,L.storeId)?"private_"+L.installTimeInMS:L.solutionId}}Object(h.a)(Yc,"AddInCommandsListLoader",null,[]);var Qd=d(1086),ce=d(177),id=d(1187),gb=d(27),pc=d(60);class zc{constructor(L,ba,Sa){this.r9a=this.PDa=this.Kca=this.abb=null;this.Vne=this.F1c=-1;this.AG=null;this.YMg=!1;this.pBg=L;this.kc=ba;this.sBg=this.kc.Gc("AddinMaxTabSwitchDetectionTimesForTeachingUI",3);
this.QWj=this.kc.Gc("AddinMaxDOMElementDetectionTimesForTeachingUI",10);this.lWc=this.kc.Ia("WebAppShortName");this.Xc=Sa;ia.a.Xa(this.lWc)&&(this.lWc="PowerPoint")}sV(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}SJk(L){this.AG=L;this.Xc.Imb(Object(H.a)(this,this.YXg,"onInsertTabSwitched_ContentAddin"));window.addEventListener("LaunchContentAddin",Object(H.a)(this,this.Nmk,"onTryItButtonClicked_ContentAddin"),!0);window.addEventListener("DismissCallout",
Object(H.a)(this,this.Ogk,"onDismissButtonClicked_ContentAddin"),!0);window.addEventListener("CloseCallout",Object(H.a)(this,this.Nfk,"onCloseButtonClicked_ContentAddin"),!0)}Jik(){this.Kca&&this.r9a&&(this.pBg.$0b({["SourceControlId"]:this.r9a}),m.ULS.sendTraceTag(528815521,220,50,"Launch addin command has been triggered"))}n9k(L,ba){ba?(this.Kca=ba.eu,(this.abb=ba.ZI)&&this.abb.B9&&this.abb.B9.yE&&(this.PDa=this.abb.B9.yE.ga(0)),this.PDa?this.PDa.isOfficeTab?(L=this.Kca.solutionId,ba=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),
L in ba?this.r9a=ba[L]:(m.ULS.sendTraceTag(528815523,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",this.sV(this.Kca)),this.r9a=this.wVi(this.abb)),this.r9a?0<this.PDa.id.indexOf(pc.a.D9g)?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Ea.lrb(this.abb),()=>{this.tph(this.JMc(this.r9a))}):this.Xc.Imb(Object(H.a)(this,this.K_g,"onTabSwitched")):(this.uSa("NoEnabledButtonFound",this.Kca),m.ULS.sendTraceTag(528815552,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),
this.iGa())):this.vph(this.JMc(this.PDa.id),0):(this.uSa("NoTabFound",this.Kca),m.ULS.sendTraceTag(528815522,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.iGa())):this.iGa()}K_g(L,ba){!this.PDa||void 0===this.PDa.id||null===this.PDa.id||0>ia.a.vg(this.PDa.id).indexOf(ia.a.vg(ba.ola))||(this.Xc.Hhc(Object(H.a)(this,this.K_g,"onTabSwitched")),this.ILd(ba.ZUg,ba.ola,this.sBg,!1))}YXg(L,ba){"Insert"===ba.ola&&(this.Xc.Hhc(Object(H.a)(this,this.YXg,"onInsertTabSwitched_ContentAddin")),
this.ILd(ba.ZUg,ba.ola,this.sBg,!0))}ILd(L,ba,Sa,sb){if(0>Sa)this.uSa("TabSwitchTimeOut",this.Kca);else{var Tb=document.querySelector("button"+this.JMc(ba));Tb.hasAttribute("aria-selected")&&"false"!==Tb.getAttribute("aria-selected")?(0<this.Vne&&window.clearTimeout(this.Vne),sb?this.Eal():this.tph(this.JMc(this.r9a))):this.Vne=window.setTimeout(()=>{this.ILd(L,ba,Sa-1,sb)},1E3)}}JMc(L){return"[id="+L+"]"}Eal(){let L=document.querySelector("button[data-unique-id = 'Ribbon-InsertAddIns']");var ba=
L?window.getComputedStyle(L,null):null;if(!L||ba&&"none"===ba.display)if(L=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']"))m.ULS.sendTraceTag(528234381,220,15,"Callout show on Overflow button");else{this.Yvb("NoAnchor",this.AG);m.ULS.sendTraceTag(528234380,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}else m.ULS.sendTraceTag(528234382,220,15,"Callout show on OfficeAddin Button");(ba=nc.a.instance.Oa("Common.ISystemInitiatedFeedback"))&&
L?(ba.execute(Sa=>{Sa.logActivity("ShowTeachingUIForContentAddin",null)}),this.Yvb("Show",this.AG),m.ULS.sendTraceTag(528234384,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity")):(this.Yvb("NoSifFutureObject",this.AG),m.ULS.sendTraceTag(528234383,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"))}Nmk(){this.Yvb("ClickOnLaunch",this.AG);this.iGa();const L={};L.solutionId=this.AG.solutionId;L.assetId=this.AG.assetId;L.assetStoreId=this.AG.assetStoreId;L.height=
this.AG.height?this.AG.height:600;L.storeId=this.AG.storeId;L.targetType=this.AG.targetType;L.width=this.AG.width?this.AG.width:600;L.displayName=this.AG.displayName;L.version=this.AG.version;L.storeType=this.AG.storeType;L.isAddinCommands=!1;this.pBg.Ce.Jvb("0",3,L)}Nfk(){this.Yvb("ClickOnClose",this.AG);this.iGa()}Ogk(){this.Yvb("ClickOnDismiss",this.AG);this.iGa()}vph(L,ba){if(ba>this.QWj)window.clearTimeout(this.F1c),this.uph("[data-unique-id='pivotOverflowButton']"),m.ULS.sendTraceTag(528815553,
220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time");else{var Sa=document.querySelector("button"+L);!Sa||Sa.hasAttribute("tabIndex")&&"-1"===Sa.getAttribute("tabIndex")?this.F1c=window.setTimeout(()=>{this.vph(L,ba+1)},1E3):(0<this.F1c&&window.clearTimeout(this.F1c),this.uph(L))}}tph(L){let ba=document.querySelector("button[data-unique-id='RightPaddle']");if(ba)this.uSa("RightPaddlePresent",this.Kca);else if(L=(ba=document.querySelector("button"+L))?window.getComputedStyle(ba,
null):null,!ba||L&&"none"===L.display)if(ba=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!ba){this.uSa("NoAnchor",this.Kca);m.ULS.sendTraceTag(528815554,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.iGa();return}this.hwh(ba,"ShowTeachingUIForAddinButton")}uph(L){let ba=document.querySelector("button"+L);if(!ba&&("[data-unique-id='pivotOverflowButton']"!==L&&(ba=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!ba)){this.uSa("NoAnchor",
this.Kca);m.ULS.sendTraceTag(528815555,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.iGa();return}this.hwh(ba,"ShowTeachingUIForAddinTab")}hwh(L,ba){L.setAttribute("lpp-id","latestAddin");const Sa=nc.a.instance.Oa("Common.ISystemInitiatedFeedback");Sa&&L?(this.uSa("Show",this.Kca),Sa.execute(sb=>{sb.logActivity(ba,null)}),m.ULS.sendTraceTag(528815557,220,50,"TriggerLPPActivity triggered an LPP activity")):(this.uSa("NoSifFutureObject",this.Kca),m.ULS.sendTraceTag(528815556,
220,15,"TriggerLPPActivity failed to get a sifFuture"),this.iGa())}wVi(L){if(!L||!L.B9||!L.B9.yE)return null;for(let ba of L.B9.yE)if(ba)for(const Sa of ba.groups)if(Sa)for(const sb of Sa.controls){if(sb&&sb.attributes&&0===sb.controlType&&sb.enabled)return sb.id;if(sb.menuItems)for(const Tb of sb.menuItems)if(Tb.attributes&&Tb.enabled)return sb.id}return null}uSa(L,ba){zc.tSa(L,this.sV(ba))}Yvb(L,ba){ba=Telemetry.PrivacyRules.GetPrivacyCompliantId(ba.solutionId,ba.storeType,ba.assetId,null,null,
ba.storeId);zc.tSa(L,ba)}zma(L){const ba={};ba[this.lWc]=da.c({["LastTeachingUIShowTime"]:(new Date).toUTCString(),["AddinHasShown"]:L});(new oa(this.lWc,null,null,Object(H.a)(this,this.E9,"postRequestFailureCallback"))).yqb(ba);m.ULS.sendTraceTag(523285644,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}E9(L){m.ULS.sendTraceTag(523285646,306,15,"failed to POST data to Roaming Settings Service with status: {0}",L?L.tf:-1)}iGa(){if(this.kc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&!this.YMg){const L=window.g_roamingAddinList;L&&(this.zma(L),this.YMg=!0)}}static tSa(L,ba){L={["AppTeachingUICalloutAction"]:L,["SDX.Id"]:ba,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.bD(L)}))}}Object(h.a)(zc,"AddinTeachingCalloutHandler",null,[]);class Ic{}Object(h.a)(Ic,"AddinCommandsHost",null,[]);var Fc=d(83),rd=d(132);class Yd extends Fc.a{constructor(){super(void 0,
void 0,void 0,!0);this.uLb="AddinCommandsUILessDialog";this.CDd="WACDialogTitleText";this.Lib="0";this.o_a=380;this.xLb=190;this.kg=this.uLb;this.vd=5;this.SHh=String.format("{0}px",this.o_a);this.Kib=String.format("{0}px",this.xLb);this.f3d=this.Zq=!1;this.Vw()}Vw(){super.Vw();this.Yy.style.width=this.SHh;this.Yy.style.height=this.Kib;this.Yy.style.padding=this.Lib}iwa(L){this.AF();document.getElementById(this.ki(this.CDd)).innerText=L}AF(){super.AF();this.sc.style.width=String.format("{0}px",this.o_a);
this.sc.style.height=String.format("{0}px",this.xLb);this.sc.removeAttribute(rd.a.ff);this.sc.removeAttribute(rd.a.o6)}hide(){this.T3d()}get eXb(){return this.Yy}initializeAndShowWithTitle(){this.qj(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(h.a)(Yd,"AddinCommandsUILessDialog",Fc.a,[1102]);var me=d(39),Db=d(166),af=d(37),bg=d(323),Qe=d(42);class Af extends Ic{constructor(L,ba,Sa,sb){super();this.nE=!!A.AFrameworkApplication.Ba&&!!A.AFrameworkApplication.Ba.jb&&A.AFrameworkApplication.Ba.jb.NV;
this.B8=L;this.Zd=ba;this.X_j=Sa;this.Jbb=sb}setOwnerAddinEToken(L){this.B8.eToken=L}showTaskpane(L,ba,Sa){m.ULS.sendTraceTag(17687394,220,50,String.format("ShowTaskpane action called."));this.Mlg(L,ba,Sa,!0)||m.ULS.sendTraceTag(17687395,806,10,String.format("ShowTaskpane : instance id is null."))}showDialog(){}createUILessSandbox(L,ba,Sa){m.ULS.sendTraceTag(17687424,220,50,String.format("UILess action called."));this.Mlg(L,ba,Sa,!1,this.X_j)||m.ULS.sendTraceTag(17687425,806,10,String.format("UILess : instance id is null."))}disposeHost(){}Mlg(L,
ba,Sa,sb,Tb=!1){var Tc=this.Zd.YY(L.solutionId);Tc||(Tc=this.Zd.iQi(L,ba,this.B8.solutionId,Tb));if(Tc&&this.Zd.csa(Tc.instanceId))return this.Zd.jeb(Tc.instanceId),Sa(Tc.instanceId,0),Tb||this.Zd.yFb(Tc.instanceId,sb),!0;let Vb=null;if(!Tc)if(Tc=this.Zd.Wbi(L,ba,sb,this.B8.solutionId,Tb),Tc.setValue(af.a.ownerAddinStoreType,this.B8.storeType),Vb=Tc.ta(Db.a.sharedRuntimeId,null),this.yAg(!!Vb,!0),Tb&&(Tb=Tb&&!Vb),ba=Tb?new Yd:null,Tb?this.Zd.Sfb(Tc,ba.eXb):(Qe.a("SharedRuntimeHiddenTaskpaneFix")&&
Tc.setValue(me.a.WSb,sb||!!Vb),this.Zd.xch(Tc)),Tc=this.Zd.YY(L.solutionId))if(Tb&&this.Jbb.$(Tc.instanceId,ba),L=this.Zd.oBa(this.B8.solutionId)){if(L=new bg.a(L),this.Zd.gzh(L.id,Tc.instanceId),Vb&&!this.Zd.TYb(L.Gva)&&(L=this.Zd.I5f(L.Gva)))L.Cv||L.TXh(Vb),this.Zd.fzc(this.B8.solutionId,L)}else{L=this.Zd.Vbi(this.B8,Vb);if(!L)return Sa(null,5001),!1;this.Zd.fzc(this.B8.solutionId,L);this.OSj(!!Vb)}else return Sa(null,5001),!1;Sa(Tc.instanceId,0);this.nE&&(Sa=this.Zd.csa(Tc.instanceId),this.Zd.yFb(Tc.instanceId,
Sa?sb:!0));this.yAg(!!Vb,!1);return!0}yAg(L,ba){L&&window.performance&&window.performance.memory&&m.ULS.sendTraceTag(562701315,802,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",ba,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)}OSj(L){m.ULS.sendTraceTag(539276249,802,50,"PPT WAC add-in created: SolutionId: {0}, StoreType: {1}, IsShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.B8.solutionId,
this.B8.storeType,this.B8.assetId,null,null,this.B8.storeId),this.B8.storeType,L)}}Object(h.a)(Af,"WACPowerPointAddInCommandsHost",Ic,[]);var tf=d(206),uf=d(52);class kg{constructor(L,ba,Sa,sb,Tb,Tc,Vb,Ed,ae,Rd,pe){this.AG=this.YOg=null;if(!L)throw Error.argumentNull("app");this.Isa=new M;this.hDg=Sa;this.Rb=L.Uq;this.Ue=Vb;this.Zd=ba;this.qja=Tc;this.Zd.K2h(Object(H.a)(this,this.wli,"clearLoadingAddinMessage"));this.Isa.X0h(Object(H.a)(this,this.ihj,"handleAddinCommandsLoadingMessageChanged"));this.Ha=
sb;this.kc=Tb;Qd.a.K1b=Qd.a.y4g;this.Jbb=new gc.a;this.exb=ae;this.ql=Rd;this.lYj=new e.a;this.Rwb=new e.a;this.Xc=pe}get Ce(){return this.Zd}SUc(L){m.ULS.sendTraceTag(588375576,220,50,"LaunchOperationType {0}.",L[N.a.yaa]);if(this.Ha.E9d||!this.Ha.ypa){var ba=L[N.a.Szc];if(ba&&0<ba.count){const sb=ba.count;for(let Tb=sb-1;0<=Tb;Tb--){const Tc=ba.ga(Tb);OSF.OsfControl.isFirstPartyStoreString(Tc.storeType)||ba.remove(ba.ga(Tb))}ba.count<sb&&(this.Ha.E9d&&!this.ql.Tba(22)&&this.ql.QAa(22),this.Ha.ypa||
this.ql.Tba(36)||this.ql.QAa(36));if(!ba.count)return}}let Sa=null;Sa=A.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled")?new Zc(this.qja,this.hDg,new Pb(this.Zd.Ko),new Rc("",ie.a.w2a),this.Isa,ld.instance,new Dd,(sb,Tb)=>{const Tc={};Tc.solutionId=sb.solutionId;Tc.version=sb.version;Tc.storeType=sb.storeType;Tc.storeId=sb.storeId;Tc.assetId=sb.assetId;Tc.assetStoreId=sb.assetStoreId;this.Zd.Lal(Tc,()=>{Tb(sb)})}):new Zc(this.qja,this.hDg,new Pb(this.Zd.Ko),new Rc("",ie.a.w2a),this.Isa,ld.instance,
new Dd);Sa.h1h(Object(H.a)(this,this.ffk,"onAutoLaunchAddin"));Sa.W0h(Object(H.a)(this,this.Kik,"onLaunchAddinCommandsCompleted"));this.kc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&(ba=new zc(this,this.kc,this.Xc),Sa.Q1h(Object(H.a)(ba,ba.Jik,"onLaunchAddinButtonClicked")),Sa.h4h(Object(H.a)(ba,ba.n9k,"showCalloutOnAddin")));try{ce.a.get_instance().Ak(5,null).continueWith(()=>{Sa.PPj(this.exb,gb.App.Fb.iG(),L)},11)}catch(sb){m.ULS.sendTraceTag(588375575,
220,10,String.format("LaunchAddinCommands error message : {0}.",sb.message))}}ghj(L){L=L[this.qja.HNa];L=(new be).WEd(L);return A.AFrameworkApplication.ypa||OSF.OsfControl.isFirstPartyStoreString(L.ownerAddinInfo.storeType)}$0b(L){const ba=new be;this.p2d(ba,L[this.qja.HNa])}p2d(L,ba){const Sa=L.WEd(ba),sb=new Af(Sa.ownerAddinInfo,this.Zd,this.Ha.Cia,this.Jbb);L.$0b(ba,this.Isa,sb,new Pb(this.Zd.Ko),Sa)}Q6g(L){const ba=$d.qAk(this.Isa);L[id.a.LabelText]=ba.labelText;L[id.a.Visible]=ba.visible}Z8k(){this.nLe()}HGb(L){L&&
N.a.FGd in L&&L[N.a.FGd]&&Lb.GKe(L[N.a.FGd].toString())}gHk(){if(this.Isa.Mbe()){this.Isa.lMf();const L=this.eXd();if(L&&0<L.count)for(let ba of L)this.MEb({["ack1"]:ba,["ack0"]:4,["ak0"]:(new Date).getTime()})}}ihj(){this.Ue.ND(new tf.a(2));this.nLe()}MEb(L){m.ULS.sendTraceTag(588375574,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",L[N.a.yaa],L[N.a.Fza]);this.Isa.hZk();window.setTimeout(()=>{const ba=new Yc(new Pb(this.Zd.Ko),ld.instance,fb.instance);
ba.V0h((Sa,sb)=>{this.SUc(sb.properties)});ba.j4h((Sa,sb)=>{this.AG=sb;this.YOg=new zc(this,this.kc,this.Xc);this.YOg.SJk(this.AG)});ba.dol(L)},0)}wli(){this.Isa.lMf()}p$h(L){var ba=this.Zd.YY(L);if(ba&&ba.Cv&&ba.Cv.Xva&&!(0>=ba.Cv.state)){var Sa=new be,sb=Sa.getTaskPaneControlIdFromAssetIdRuntimeId(L,ba.Cv.Xva);sb&&(this.Zd.fzc(L,ba),this.p2d(Sa,sb),this.Zd.sNf(L),(ba=this.Zd.YY(L+sb))?this.Zd.setInitialDisplayMode(ba.instanceId,1):m.ULS.sendTraceTag(541201820,802,10,"Failed to find auto-loaded shared runtime pane for "+
L))}}t$h(L){if(L&&L.solutionId){var ba=new be,Sa=ba.u$h;if(Sa=L.solutionId in Sa?Sa[L.solutionId]:null){let sb=this.Zd.YY(L.solutionId);if(!sb){sb=this.Zd.I5f(L.solutionId);if(!sb){m.ULS.sendTraceTag(588375573,220,15,String.format("AutoShowTaskPane appForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)));return}this.Zd.fzc(L.solutionId,sb)}L=sb.settings;(L=N.a.ICf in L?L[N.a.ICf]:null)&&"true"===L.toLowerCase()&&this.p2d(ba,
Sa)}}else m.ULS.sendTraceTag(562119948,220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid solution id.")}i6k(L){if(void 0===L||null===L||void 0===L[this.qja.HNa]||null===L[this.qja.HNa])return!1;L=L[this.qja.HNa];return ia.a.Xa(L)?!1:this.Rwb.contains(L)}e2k(L){L=L.B9;if(!L)m.ULS.sendTraceTag(542201745,220,15,"Ribbon Extensibility for React ribbons should not be null.");else if(L.yE)for(let ba of L.yE)if(ba.groups)for(const Sa of ba.groups)if(Sa.controls)for(const sb of Sa.controls)if(this.TNe(sb.id,
sb.enabled),1===sb.controlType&&sb.menuItems)for(const Tb of sb.menuItems)this.TNe(Tb.id,Tb.enabled)}TNe(L,ba){if(L&&L.length){var Sa=this.Rwb.contains(L);Sa&&ba&&this.Rwb.remove(L);Sa||ba||this.Rwb.add(L)}}Zql(L){let ba=null,Sa=null,sb=!0;void 0!==L[N.a.oSd]&&null!==L[N.a.oSd]&&void 0!==L[this.qja.HNa]&&null!==L[this.qja.HNa]&&void 0!==L[N.a.mSd]&&null!==L[N.a.mSd]&&(ba=L[N.a.oSd],Sa=L[this.qja.HNa],sb=L[N.a.mSd]);ia.a.Xa(ba)||ia.a.Xa(Sa)||(L=(new ib("",ba,this.qja,!0)).IBa(Sa),this.TNe(L,sb),this.Rb.updateCommandUI())}uYb(L){if(void 0!==
L&&null!==L&&void 0!==L[N.a.nSd]&&null!==L[N.a.nSd])switch(L[N.a.nSd]){case 1:this.Zql(L);break;case 4:this.Rwb.clear(),this.Rwb.addRange(this.lYj)}}ffk(L,ba){if(ba)if(ba){L=ba.eu;ba=ba.ZI;var Sa=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();(ba=L.solutionId in Sa?Sa[L.solutionId]:this.$Yi(ba))?(this.$0b({["SourceControlId"]:ba}),L.isAutoLaunched=!0):m.ULS.sendTraceTag(526996437,220,15,"addinCommandControlId is null")}else m.ULS.sendTraceTag(526996436,220,15,"agaveParams is null");
else m.ULS.sendTraceTag(526996435,220,15,"No args for OnAutoLaunchAddin event")}$Yi(L){if(!L)return m.ULS.sendTraceTag(526996438,220,10,"Failed to get button id for addin"),null;L=L.B9;if(!L||!L.yE||!L.yE.count)return m.ULS.sendTraceTag(526996439,220,15,"It has 0 or multiple tabs"),null;L=L.yE.ga(0);if(!L.groups||1!==L.groups.length)return m.ULS.sendTraceTag(526996440,220,15,"It has 0 or multiple groups"),null;L=L.groups[0];if(!L.controls||1!==L.controls.length)return m.ULS.sendTraceTag(526996441,
220,15,"It has 0 or multiple buttons"),null;L=L.controls[0];return L.attributes&&0===L.controlType&&L.enabled?L.id:null}Kik(L,ba){let Sa=null;ba&&(Sa=ba);Sa&&Sa.ZI&&this.e2k(Sa.ZI);Sa?(Sa.eu&&this.p$h(Sa.eu.solutionId),this.Ha.xzj&&window.setTimeout(()=>{Sa.eu&&this.t$h(Sa.eu)},0)):m.ULS.sendTraceTag(588375572,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null."))}eXd(){const L=new e.a;this.Ha.Sra&&(this.Ha.cqg&&L.add(0),this.kc.ka(uf.a.pa(187))&&L.add(1),this.kc.ka(uf.a.pa(305))&&
L.add(10),L.add(8));return L}nLe(){const L=document.querySelector("[data-unique-id='ShowAddInCommandsLoadStatusCallout']");$d.cph(this.Isa,this.Rb.iG(),L,ResourceStrings.L_Insert,CommonUIStrings.L_ButtonOfficeAddins)}ykc(L){L&&this.Jbb.Kb(L)&&this.Jbb.ga(L).initializeAndShowWithTitle()}G1b(L){L&&this.Jbb.Kb(L)&&this.Jbb.ga(L).hide()}}Object(h.a)(kg,"AddinCommandsManager",null,[1060]);class Lg{constructor(){this.HOg={["tabhome"]:"PptRibbon.Home",["tabinsert"]:"PptRibbon.InsertTab",["tabdesign"]:"PptRibbon.Design",
["tabtransitions"]:"PptRibbon.Transition",["tabanimations"]:"PptRibbon.Animation",["tabview"]:"PptRibbon.View"};this.dKg={["tabslideshow"]:["PptRibbon.SlideShow",ResourceStrings.l_SlideShowTab,CommonUIStrings.l_SlideShowTabKeytip],["tabreview"]:["PptRibbon.Review",ResourceStrings.L_ReviewTab,CommonUIStrings.l_ReviewTabKeytip],["tabdeveloper"]:["PptRibbon.Developer",ResourceStrings.l_DeveloperTab,CommonUIStrings.l_DeveloperTabKeytip],["tabaddins"]:["PptRibbon.AddIns",ResourceStrings.l_AddInsTab,CommonUIStrings.l_AddInsTabKeytip]};
this.l0c=null}get HNa(){return"SourceControlId"}get mS(){return"Presentation"}get formFactor(){return"DesktopFormFactor"}d5i(){if(!this.l0c){this.l0c={};for(const L of Object.keys(this.HOg))this.l0c[L]=this.HOg[L];for(const L of Object.keys(this.dKg))this.l0c[L]=this.dKg[L][0]}}}Object(h.a)(Lg,"AddinCommandsStringProvider",null,[1059]);class $g{constructor(L){this.asi=L}iUi(){return this.asi.jci()}}Object(h.a)($g,"ContextMenuExtensibilityHandler",null,[1058]);var yf=d(79);class Kf{constructor(L,ba,
Sa,sb){this.rle=null;this.Zd=L;this.VOg=ba;this.sa=Sa;this.yh=sb}get g5b(){return this.rle}set g5b(L){this.rle=L}register(){this.sa.VJ(Object(H.a)(this,this.Ked,"selectionChangeEventHandler"));Qe.a("ExtensibilitySlideSelectionChangedEventFix")&&this.yh.Jmb(Object(H.a)(this,this.Ked,"selectionChangeEventHandler"))}dispose(){this.sa.yHa(Object(H.a)(this,this.Ked,"selectionChangeEventHandler"));Qe.a("ExtensibilitySlideSelectionChangedEventFix")&&this.yh.Hcd(Object(H.a)(this,this.Ked,"selectionChangeEventHandler"))}Ked(){try{this.g5b&&
this.VOg.ah(this.g5b),this.rle=new yf.a(4,1,0,()=>{this.g5b=null;this.Oll()},90,"50"),this.VOg.Hb(this.g5b)}catch(L){m.ULS.sendTraceTag(18442309,802,10,L.toString())}}Oll(){try{this.Zd.w8g(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),null);const ba=this.sa.ny();if(ba){var L=ba.km();if(L)for(const Sa of L)if(Sa.ar){const sb=new bg.a(Sa);this.Zd.wWa(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),sb.id,null)}}}catch(ba){m.ULS.sendTraceTag(18442310,802,10,ba.toString())}}}
Object(h.a)(Kf,"AppForOfficeApiSelectionChangeEventListener",null,[1048,109]);var dd=d(537),lg=d(965),Wh=d(706);class Gd{}Gd.generalException="generalException";Gd.invalidArgument="invalidArgument";Gd.notAllowed="notAllowed";Gd.apiNotAvailable="apiNotAvailable";Gd.unresolvedPendingRequest="unresolvedPendingRequest";Gd.timeout="timeout";Gd.adalTimeout="adalTimeout";Gd.userNotSignedIn="userNotSignedIn";Gd.userAborted="userAborted";Gd.silentSignInFailed="silentSignInFailed";Gd.invalidResourceUrl="invalidResourceUrl";
Gd.invalidGrant="invalidGrant";Gd.connectionLost="connectionLost";Gd.clientError="clientError";Gd.serverError="serverError";Object(h.a)(Gd,"WopiHostErrorCodes",null,[]);var Se=d(259);class hj{}Object(h.a)(hj,"OAuthCallerMetadata",null,[]);var cg=d(55);class ed{constructor(L){this.dL=L;this.zJh=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}pXh(L,ba,Sa,sb,Tb,Tc){if(!this.dL)return sb=new lg.a,sb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
Promise.resolve(sb);const Vb=new hj;Vb.AddinName=Tb;Vb.AddinTrustId=Tc;let Ed=-1;Tc=null;if(sb&&this.ntg())Tc=this.dL.Vwh(N.a.Hjd,L,sb,ed.zbg(Tb),Vb);else{const ae=Date.now();Tc=this.dL.p0(N.a.Hjd,L,Vb).then(Rd=>{Ed=Date.now()-ae;const pe=(ba||Sa)&&"login_required"===Rd.ErrorCode;return(ba&&("interaction_required"===Rd.ErrorCode||"consent_required"===Rd.ErrorCode||"invalid_grant"===Rd.ErrorCode)||pe)&&this.ntg()?this.dL.Vwh(N.a.Hjd,L,null,ed.zbg(Tb),Vb):Promise.resolve(Rd)})}return Tc.then(ae=>{const Rd=
new lg.a;ae.IsSuccess?(Rd.token=ae.Token,ae.Telemetry&&(Rd.ahb=ae.Telemetry.fromCache,Rd.expiresOn=ae.Telemetry.expiresOn)):(Rd.errorCode=this.c9j(ae),Rd.xOe=this.lqk(ae));return Rd}).catch(()=>{const ae=new lg.a;ae.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(ae)}).then(ae=>{ae.Pza="OauthManager";0<=Ed&&(ae.C0b=Ed);return ae})}tDj(L){const ba=(A.AFrameworkApplication.fa.Ia(A.AFrameworkApplication.lJ)||"").toLowerCase();return(cg.a.yDa||"teams"===ba&&Se.a.l7a)&&
!ed.OCj(L)||!this.dL||!this.dL.nAj()?!1:!0}ntg(){return this.zJh||1!==Wh.a.rKc()}c9j(L){switch(L.ErrorCode){case "UserCancelled":case "interaction_required":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:L=L.ErrorCode===Gd.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:L.ErrorCode===Gd.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:L.ErrorCode===Gd.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:L.ErrorCode===Gd.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:L.ErrorCode===Gd.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return L}lqk(L){let ba="";(L=RegExp("AADSTS(\\d+)").exec(L.ErrorMessage))&&1<L.length&&(ba=L[1]);return ba}static zbg(L){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,L)}static OCj(L){if(!L)return!1;L=L.toLowerCase();for(const ba of dd.AppsForOfficeSingleSignOnManager.hJc)if(ba===
L)return!0;return!1}}Object(h.a)(ed,"AppsforOfficeTokenFromOauthManager",null,[1154]);class Xg{constructor(L){this.t7j=L}static SQe(){if(A.AFrameworkApplication.fa.ka("AppForOfficeSSOV2IsEnabled")){var L=null;try{L=nc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ba){m.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+ba)}L=new ed(L);Xg.Ka=new Xg(L)}}static getInstance(){Xg.Q4e||(Xg.SQe(),Xg.Q4e=!0);return Xg.Ka}}Xg.Ka=null;Xg.Q4e=!1;Object(h.a)(Xg,"AppsForOfficeOauthManagerFactory",
null,[1133]);class Dh{constructor(L){const ba=Xg.getInstance();this.wuf=new dd.AppsForOfficeSingleSignOnManager(L,ba)}getAccessTokenAsync(L,ba){return new Promise(Sa=>{const sb=A.AFrameworkApplication.fa.ka(uf.a.pa(342));this.wuf.getAccessToken(L,sb,ba,(Tb,Tc)=>{const Vb={};Vb.errorCode=Tb;Vb.accessToken=Tc?Tc.accessToken:"";Sa(Vb)})})}removeCallbackForAddin(L){this.wuf.removeCallbackForAddin(L)}}Object(h.a)(Dh,"AppForOfficeAuthProvider",null,[1089]);class Qf{kui(L){return new Dh(L)}}Object(h.a)(Qf,
"AppForOfficeAuthFactory",null,[1026]);var Yb=d(226),li=d(64),re=d(47),lf=d(613);class Id{constructor(L,ba,Sa,sb,Tb,Tc,Vb){this.mpe=this.lpe=this.Mme=this.Lme=0;this.YKg=.5;this.iyb=null;this.Cie=0;this.eXj={};this.O9b=document.createElement("div");this.O9b.className="OsfAddinOverlay";ba.appendChild(this.O9b);Sa.$_k(this.O9b);this.q8j=L;this.JI=Vb;this.JI.tzc(Object(H.a)(this,this.iCb,"onZoomed"));this.ua=sb;this.Kc=Tb;this.Hn=Tc;this.Hn.DR(Object(H.a)(this,this.KCe,"registerSlideViewElementEvents"))}dispose(){this.JI.tcd(Object(H.a)(this,
this.iCb,"onZoomed"));this.Hn.lma(Object(H.a)(this,this.KCe,"registerSlideViewElementEvents"))}initialize(){if(this.ua.Ca){this.KCe(null,null);const L=this.Kc.Mc;L&&(this.Lme=parseFloat(L.rT.style.left),this.Mme=parseFloat(L.rT.style.top),this.lpe=parseFloat(L.oe.za.style.left),this.mpe=parseFloat(L.oe.za.style.top))}this.zSe();this.iCb(null,new lf.a(this.q8j.zoom))}KCe(L,ba){(L=this.Kc.Mc)&&L!==this.iyb&&(L.r4h(Object(H.a)(this,this.rAh,"updateOffsetFromSlideView")),L.t3h(Object(H.a)(this,this.qAh,
"updateOffsetFromPageContentContainer")),this.iyb&&(this.iyb.oOk(Object(H.a)(this,this.rAh,"updateOffsetFromSlideView")),this.iyb.MNk(Object(H.a)(this,this.qAh,"updateOffsetFromPageContentContainer")),this.RNe(this.iyb,!1)),ba&&ba.CTc&&1!==this.Cie&&this.RNe(L,!0),this.iyb=L)}RNe(L,ba){if(L&&(L=L.Ud)&&L.isConnected){var Sa=L.km();if(Sa&&Sa.length)for(const Tc of Sa)if(Tc.ar){Sa=Tc.ta(af.a.yY,null);var sb=L.getValue(af.a.sid),Tb=L.getValue(af.a.cid);sb=li.a.XD(sb,Tb).toString();Tb=Tc.get_shapeId().toString();
Sa=Sa+Tb+sb;Qe.a("Microsoft.Office.PowerPointOnline.FixBug6808089KillSwitch")?this.VHa(Sa,ba,null):(sb=Tc.yg(0),(null===sb||void 0===sb?0:sb.za)?this.VHa(Sa,ba,sb.za.fe):this.VHa(Sa,ba,null))}}}T4(L){this.Cie=L;const ba=this.Kc.Mc;ba?(m.ULS.sendTraceTag(512369926,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: Hide the addin container on active slide('{0}#{1}').",ba.Ud.sid,ba.Ud.cid),this.RNe(ba,2===L)):m.ULS.sendTraceTag(512369925,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: SlideViewElement is null.")}qAh(L,
ba){this.Lme=ba.x;this.Mme=ba.y;this.zSe()}rAh(L,ba){this.lpe=ba.x;this.mpe=ba.y;this.zSe()}zSe(){this.O9b.style.left=re.a.Nc(this.Lme+this.lpe+Yb.a.N4-this.YKg);this.O9b.style.top=re.a.Nc(this.Mme+this.mpe+Yb.a.N4-this.YKg)}Yzj(L){return L in this.vpa}GUk(L,ba){this.vpa[L]=ba}VHa(L,ba,Sa){1===this.Cie&&ba||L in this.vpa&&this.vpa[L].VHa(ba,Sa)}Bah(L){L in this.vpa&&(this.vpa[L].dispose(),delete this.vpa[L])}uHe(L,ba){L in this.vpa&&this.vpa[L].uHe(ba)}iCb(){}get vpa(){return this.eXj}}Object(h.a)(Id,
"AppForOfficeContentAppsContainer",null,[1057,109]);var We=d(388);class Wc extends y.StandardDialog{constructor(L,ba){super();this.iHh=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.QJh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.RJh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.OIh=L;this.tLb=ba}showDialog(L,ba){const Sa=new Fc.a(void 0,void 0,!1);Sa.vd=0;Sa.kg=We.a.Ebd(Number.MAX_VALUE).toString();Sa.Wf=String.format("<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",
ba,this.RJh,this.QJh,this.iHh);Sa.qj(L,Object(H.a)(this,this.Ifk,"onCheckboxExecute$4"),{optInCheckbox:!1})}Ifk(L,ba){1===L&&ba.optInCheckbox&&(x.a.instance.getItem("optedIntoAddinDeveloperMode")?x.a.instance.removeItem("optedIntoAddinDeveloperMode"):(x.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Ckc()))}Ckc(){const L=new y.StandardDialog;L.vd=4;const ba=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,
this.OIh)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;L.nO(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,ba,this.tLb)}}Object(h.a)(Wc,"AppForOfficeDeveloperModeOptInDialog",y.StandardDialog,[]);const Xc=L=>{const ba=[];if(!L)return ba;ba[OSF.DDA.Marshaling.ThemingKeys.Accent1]=Ld(L.Accent1);ba[OSF.DDA.Marshaling.ThemingKeys.Accent2]=Ld(L.Accent2);ba[OSF.DDA.Marshaling.ThemingKeys.Accent3]=Ld(L.Accent3);ba[OSF.DDA.Marshaling.ThemingKeys.Accent4]=Ld(L.Accent4);ba[OSF.DDA.Marshaling.ThemingKeys.Accent5]=
Ld(L.Accent5);ba[OSF.DDA.Marshaling.ThemingKeys.Accent6]=Ld(L.Accent6);ba[OSF.DDA.Marshaling.ThemingKeys.Background1]=Ld(L.OsfColorScheme?L.OsfColorScheme.Background1:null);ba[OSF.DDA.Marshaling.ThemingKeys.Background2]=Ld(L.OsfColorScheme?L.OsfColorScheme.Background2:null);ba[OSF.DDA.Marshaling.ThemingKeys.Text1]=Ld(L.OsfColorScheme?L.OsfColorScheme.Text1:null);ba[OSF.DDA.Marshaling.ThemingKeys.Text2]=Ld(L.OsfColorScheme?L.OsfColorScheme.Text2:null);ba[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=Ld(L.Hyperlink);
ba[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=Ld(L.FollowedHyperlink);const Sa=L.OsfFontScheme;Sa&&(ba[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=Sa.HdEaFt,ba[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=Sa.HdLtnFt,ba[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=Sa.HdLclFt,ba[OSF.DDA.Marshaling.ThemingKeys.HdScript]=Sa.HdSptFt,ba[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=Sa.BdEaFt,ba[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=Sa.BdLtnFt,ba[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=Sa.BdLclFt,ba[OSF.DDA.Marshaling.ThemingKeys.BdScript]=
Sa.BdSptFt);ba[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=Ld(L.Background);return ba},Ld=L=>{if(!L)return null;let ba;ba=L.b;ba+=L.g<<8;return ba+=L.r<<16};class Xf{constructor(L,ba,Sa){this.cLg=L;this.ES=ba;this.nZj=Sa}register(){this.cLg.yk(Object(H.a)(this,this.Nuh,"themeChangedCallback"))}dispose(){this.cLg.Pm(Object(H.a)(this,this.Nuh,"themeChangedCallback"))}Nuh(L,ba){if(ba.node.Sa(af.a.Ye)&&(ba.property===af.a.Ye||ba.property===af.a.r$)){L=ba.node;try{var Sa=Xc(L?L.Ye:null)}catch(sb){return}if(L){L=
L.km();for(const sb of L)sb.ar&&(L=this.nZj.M1(sb),this.ES.wWa(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),L.id,Sa))}this.ES.w8g(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),Sa)}}}Object(h.a)(Xf,"AppForOfficeDocumentThemeListener",null,[1048,109]);var Le=d(244);class md extends Fc.a{constructor(L,ba,Sa){super();this.Yoa=null;this.CDd="WACDialogTitleText";this.Lib="0";this.Epc="15px";this.RHh="0px";this.Kib="calc(100% - 30px)";this.QHh="100%";this.Oqf=0;this.Ta=
new D.a;this.zFh=new I;this.vd=5;this.kg=this.uLb=Sa;this.Sqd=L;this.WZe=ba;this.urd=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}u2h(L){this.Ta.addHandler("OnDialogClosedEventKey",L)}N0k(){this.ioa=null}Vw(){super.Vw();this.Yy.style.width="100%";this.Yy.style.height=this.OOc?this.Kib:this.QHh;this.Yy.style.marginTop=this.OOc?this.Epc:this.RHh;this.Yy.style.padding=this.Lib}AF(){super.AF();this.sc.style.width=String.format("{0}px",this.Sqd*
window.innerWidth/100);this.sc.style.height=String.format("{0}px",this.WZe*window.innerHeight/100);this.sc.style.minWidth="0px";this.urd&&A.AFrameworkApplication.isRtl&&100===this.Sqd&&(this.sc.style.right="0px",this.sc.style.marginRight="0px");this.Yoa=document.getElementById(this.ki(this.CDd));this.Yoa.style.position="absolute";this.Yoa.style.whiteSpace="nowrap";this.Yoa.style.textOverflow="ellipsis";A.AFrameworkApplication.isRtl?(this.Yoa.style.right="14px",this.Yoa.style.left="44px"):(this.Yoa.style.right=
"44px",this.Yoa.style.left="14px")}iwa(L){super.iwa(L);this.Yoa&&this.Yoa.setAttribute("title",L)}get eXb(){return this.Yy}zEe(){this.sc.style.width=String.format("{0}px",this.Sqd*window.innerWidth/100);this.sc.style.height=String.format("{0}px",this.WZe*window.innerHeight/100);this.sc.style.overflowY="hidden";this.sc.style.overflowX="hidden";this.sc.style.marginTop="";this.sc.style.top="";cg.a.n8a&&A.AFrameworkApplication.isRtl?(this.sc.style.right="",this.sc.style.marginRight=""):(this.sc.style.left=
"",this.sc.style.marginLeft="")}hide(){this.zFh.zQf(3,this.uLb).execute(this,Q.getInstance(),{});this.Oqf=window.setTimeout(()=>{this.Ta.raiseEvent("OnDialogClosedEventKey",this.uLb);Le.a.prototype.hide.call(this)},500)}BYg(L){3===L&&(window.clearTimeout(this.Oqf),this.Ta.raiseEvent("OnDialogClosedEventKey",this.uLb),super.hide())}}Object(h.a)(md,"AppsForOfficeDialog",Fc.a,[784,785]);class oj{constructor(){this.dialog=this.kg=null}}Object(h.a)(oj,"DialogInfo",null,[]);class Ie{}Ie.url="url";Ie.height=
"height";Ie.width="width";Ie.zRd="displayInIframe";Ie.iPc="hideTitle";Object(h.a)(Ie,"DialogSettings",null,[]);class qh{constructor(){this.height=this.width=0;this.kg=this.controlId=this.pageUrl=null;this.iPc=this.zRd=!1}}Object(h.a)(qh,"DisplayDialogParams",null,[]);class Od extends Sys.EventArgs{constructor(L,ba,Sa=null,sb="",Tb=""){super();this.controlId=L;this.messageType=ba;this.messageContent=Sa;this.zre=sb;this.OIa=Tb}}Object(h.a)(Od,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class ef extends Sys.EventArgs{constructor(L,
ba,Sa=null,sb="",Tb=""){super();this.controlId=L;this.messageType=ba;this.messageContent=Sa;this.zre=sb;this.OIa=Tb}}Object(h.a)(ef,"OnMessageParentEventArgs",Sys.EventArgs,[]);var dh=d(114);class ad{constructor(L){this.Ta=new D.a;this.cR=L}P2h(L){this.Ta.addHandler("OnMessageParentEventKey",L)}Sbh(L){this.Ta.removeHandler("OnMessageParentEventKey",L)}O2h(L){this.Ta.addHandler("OnMessageDialogEventKey",L)}qNk(L){this.Ta.removeHandler("OnMessageDialogEventKey",L)}showDialog(L,ba,Sa,sb){if(ad.xna.Kb(ba))m.ULS.sendTraceTag(18896285,
344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Sa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const ff=da.b(L),eg=ff[Ie.url];if(this.cR.getOsfControl(ba).checkAppDomains(eg)){var Tb=new qh;Tb.width=ff[Ie.width];Tb.height=ff[Ie.height];Tb.pageUrl=eg;Tb.zRd=ff[Ie.zRd];Tb.iPc=ff[Ie.iPc];Tb.controlId=ba;Tb.kg=dh.a.create().toString();var Tc=new oj;Tc.kg=Tb.kg;var Vb=this.cR.getOsfControl(Tb.controlId).getManifest().getDefaultDisplayName(),Ed=this.cR.getOsfControl(Tb.controlId).getStoreType().toLowerCase();
L=null;var ae=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",!1);L=(4===A.AFrameworkApplication.Ba.jb.vm&&"hardcodedpreinstall"===Ed||ae&&"sdxcatalog"===Ed)&&Tb.iPc?this.createAndShowAppsForOfficeDialog(Tb.width,Tb.height,Tb.kg,!0,Vb):this.createAndShowAppsForOfficeDialog(Tb.width,Tb.height,Tb.kg,!1,Vb);var Rd=this.cR.getOsfControl(Tb.controlId),pe=Rd.getManifest();ae={};ae.id=Tb.kg;ae.solutionId=Rd.getSolutionId();ae.version=Rd.getVersion();
ae.storeType=Ed;ae.storeId=Rd.getStoreId();ae.assetId=Rd.getAssetId();ae.assetStoreId=Rd.getAssetStoreId();ae.ownerAddinSolutionId=Rd.getOwnerAddinSolutionId();ae.ownerAddinStoreType=Rd.getOwnerAddinStoreType();ae.appDomains=pe.getAppDomains();ae.dialogUrl=eg;ae.osfControlType=1;ae.agaveName=Vb;ae.div=L.eXb;m.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ae.solutionId,ae.ownerAddinStoreType||ae.storeType,ae.assetId,null,
null,ae.storeId),ia.a.BM(Tb.pageUrl));this.cR.insertDialogControl(ae);L.u2h(Object(H.a)(this,this.Agk,"onDialogClosed"));Tc.dialog=L;ad.xna.$(Tb.controlId,Tc);sb&&sb(ae);Sa(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else m.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Sa(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(ff){m.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",ff.message),Sa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}mak(L,
ba,Sa,sb){A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===sb&&(sb=Sa);try{const Tb=this.IBa(L);Tb&&this.Ta.raiseEvent("OnMessageParentEventKey",new ef(Tb,OSF.DialogMessageType.DialogMessageReceived,ba,Sa,sb))}catch(Tb){return m.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Tb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}zmi(L,
ba){if(ad.xna.Kb(L))try{const Sa=ad.xna.ga(L);Sa.dialog&&Sa.dialog.hide();this.cR.purgeDialogControl(Sa.kg);ad.xna.remove(L);ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Sa){m.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Sa.message),ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else m.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}tXk(L,
ba,Sa,sb){A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===sb&&(sb=Sa);if(ad.xna.Kb(L)&&(L=ad.xna.ga(L),L.dialog))try{this.Ta.raiseEvent("OnMessageDialogEventKey",new Od(L.kg,OSF.DialogMessageType.DialogParentMessageReceived,ba,Sa,sb))}catch(Tb){m.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Tb.message)}}IBa(L){let ba=null;for(let Sa of ad.xna)if(Sa.value.kg===L){ba=Sa.key;
break}return ba}Agk(L,ba){if(L=this.IBa(ba))this.cR.purgeDialogControl(ba),ad.xna.remove(L),this.Ta.raiseEvent("OnMessageParentEventKey",new ef(L,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(L,ba,Sa,sb,Tb){L=new md(L,ba,Sa);Tb=sb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Tb);sb&&(L.OOc=!1,L.Zq=!1);L.qj(Tb,null,null);L.N0k();return L}static Zeg(){return ad.xna}static getInstance(L){ad.Ka||(ad.Ka=new ad(L));return ad.Ka}}ad.Ka=null;ad.xna=
new gc.a;Object(h.a)(ad,"AppsForOfficeDialogManager",null,[749]);var Fg=d(701),Cd=d(66),zg=d(120),Eh=d(94),eh=d(178),Gg=d(112);class vh extends Sys.EventArgs{constructor(L){super();this.Ega=L}}Object(h.a)(vh,"AppForOfficeFocusOnAddinPaneEventArgs",Sys.EventArgs,[]);var ze=d(46);class sg{constructor(L,ba,Sa,sb,Tb,Tc){this.aQ=[];this.Hqe=new Fg.a;this.nE=!!A.AFrameworkApplication.Ba&&!!A.AFrameworkApplication.Ba.jb&&A.AFrameworkApplication.Ba.jb.NV;this.BW=L;this.N_j=this.BW.firstChild;this.Ga=ba;this.ju=
Sa;this.ob=sb;this.Zd=Tb;this.Ue=Tc}get s1(){return this.aQ}get Ce(){return this.Zd.value}d3d(){return 0<this.ncc}wM(L){if(L){this.s1.push(L);var ba=L.za;ba&&!this.nE&&this.BW.insertBefore(ba,this.N_j);1===this.ncc&&this.Ga.Kj(Gg.a.bKd,!0);L.isVisible&&this.ju.addHandler(L.za,Cd.a.Rf,Object(H.a)(this,this.rhg,"handleShortCutsOnAddinPane"))}}cbh(L){L&&(Array.remove(this.aQ,L),L=L.za,this.ju.removeHandler(L,Cd.a.Rf,Object(H.a)(this,this.rhg,"handleShortCutsOnAddinPane")),L&&!this.nE&&this.BW.removeChild(L),
this.ncc||this.Ga.Kj(Gg.a.bKd,!1))}T4(L){if(1===L||2===L){if(1===L){this.Hqe=new Fg.a;for(const ba of this.s1)ba.isVisible&&this.Hqe.add(ba.id.toLowerCase())}L=2===L;for(const ba of this.s1)this.Hqe.contains(ba.id.toLowerCase())&&(ba.Uo(L),(L&&1===this.ncc||!L&&!this.ncc)&&this.Ga.Kj(Gg.a.bKd,L))}}ekj(L,ba){for(const Sa of this.aQ)L=Sa.layout(L,ba)}RW(L,ba){if(L){L=null;if(ba===ze.a.sg)for(ba=this.aQ.length-1;0<=ba;ba--){if(this.aQ[ba].isVisible){L=this.aQ[ba];break}}else if(ba===Gg.a.PIf||ba===Gg.a.hei||
ba===zg.AFrame.sY||ba===zg.AFrame.lJc||ba===Gg.a.VU||ba===Gg.a.mei||ba===ze.a.RD||ba===ze.a.tK||ba===ze.a.$Y)for(ba=0;ba<this.aQ.length;ba++)if(this.aQ[ba].isVisible){L=this.aQ[ba];break}this.PVd(L)}}PVd(L){if(L){var ba=this.Ce.hVd(L.id);ba&&this.Ue.EBk(new vh(ba.Ega));this.Ce.notifyAgave(L.id,11)}else m.ULS.sendTraceTag(19014042,806,10,"Focus could not be put on the null addin pane!")}SRi(L,ba){var Sa;for(Sa=0;Sa<this.aQ.length&&this.aQ[Sa].id!==L;Sa++);if(Sa===this.aQ.length)m.ULS.sendTraceTag(19014043,
806,10,String.format("Failed to find the taskpane with instance id: {0}",L)),this.pQe(ba);else{L=null;if(5===ba)for(--Sa;0<=Sa;Sa--){if(this.aQ[Sa].isVisible){L=this.aQ[Sa];break}}else if(6===ba)for(Sa+=1;Sa<this.aQ.length;Sa++)if(this.aQ[Sa].isVisible){L=this.aQ[Sa];break}L?this.PVd(L):this.pQe(ba)}}C3f(L){for(const ba of this.aQ)if(ba.id===L){Eh.FocusManager.xr(ba.Gmi);return}m.ULS.sendTraceTag(19014044,806,10,String.format("Failed to focus on addinpane's the close button with instance id: {0}",
L))}xnl(L){for(let ba of ad.Zeg())if(ba.value.kg.toLowerCase()===L.toLowerCase())return ba.value.dialog.hide(),ba.key;return null}pQe(L){5===L?this.Ga.T6a(!1):6===L&&this.Ga.T6a(!0)}X_f(){const L=this.ob.he();L&&1===L.length&&(this.ob.selectShape(L[0],!0),this.Ga.Bd())}get ncc(){let L=0;for(const ba of this.s1)ba.isVisible&&L++;return L}rhg(L){if(L.keyCode===eh.a.I0&&L.ctrlKey)for(var ba=0;ba<this.s1.length;ba++){var Sa=this.s1[ba];if(Sa.isVisible&&Sa.za.contains(L.target)){Sa=null;if(L.shiftKey)for(ba+=
1;ba<this.s1.length;ba++){if(this.s1[ba].isVisible){Sa=this.s1[ba];break}}else for(--ba;0<=ba;ba--)if(this.s1[ba].isVisible){Sa=this.s1[ba];break}Sa&&(this.PVd(Sa),L.preventDefault(),L.stopPropagation());break}}}vf(L){this.Ga.vf(L)}}Object(h.a)(sg,"AppForOfficeFocusManager",null,[1056]);var zd=d(913);class Hd{Mui(L,ba,Sa){L=zd.a.mdg(L.kdb);L.appName=OSF.AppName.PowerpointWebApp;L.clientMode=1;L.formFactor="DefaultSettings";L.hostControl=ba;ba=nc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager");
L.allowExternalMarketplace=L.allowExternalMarketplace&&ba.CVb;Sa.register(L);Sa=new OSF.ContextActivationManager(L);Sa.setWSA(A.AFrameworkApplication.Yi);return Sa}IQf(){const L={};L.AddinRibbonIdAllowUnknown=A.AFrameworkApplication.fa.ka("AddinRibbonIdAllowUnknown");L.AddinRibbonNativeGroupControlIsEnabled=!0;L.AddinRibbonTabAutoFocusIsEnabled=!0;L.AddinRibbonTabPositionIsEnabled=!0;L.AgaveAddinUploadEnabled=A.AFrameworkApplication.fa.ka("AgaveAddinUploadEnabled");L.DevConsoleEnabled=A.AFrameworkApplication.fa.ka("AddinDevConsoleLog");
L.ManifestParserDevConsoleEnabled=!0;L.flightingTreatmentVariables=A.AFrameworkApplication.fa.dZb;return L}}Object(h.a)(Hd,"AppForOfficeImportedClassFactory",null,[1055]);class Fh{constructor(L){this.JBg=L}zCe(){for(const L of this.JBg)L.register()}dispose(){for(const L of this.JBg)L.dispose()}}Object(h.a)(Fh,"AppForOfficeListenerManager",null,[1054,109]);var Gh=d(197),ih=d(336);class ah extends Fc.a{constructor(){super();this.Kib="calc(100% - 46px)";this.Epc="15px";this.Lib="0";this.YIh="WACDialogPanel";
this.o_a=695;this.ZIh=462;this.xLb="80%";this.FGh=350;this.kWe="100%";this.vd=5;this.kg="AppsForOfficeInsertionDialog";this.urd=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}Vw(){super.Vw();this.Yy.style.width=this.kWe;this.Yy.style.height=this.Kib;this.Yy.style.marginTop=this.Epc;this.Yy.style.padding=this.Lib}Yla(){this.Yy.style.width=this.kWe;this.Yy.style.height=this.Kib;this.Yy.style.marginTop=this.Epc;this.Yy.style.padding=this.Lib;
this.o_a>Le.a.Ida?(this.sc.style.width=String.format("{0}px",Le.a.Ida),this.sc.style.overflowX="scroll",A.AFrameworkApplication.isRtl?this.sc.style.right="0":this.sc.style.left="0"):(this.sc.style.width=String.format("{0}px",this.o_a),this.sc.style.overflowX="hidden");this.sc.offsetHeight>Le.a.Nla||this.ZIh+50>Le.a.Nla?(this.sc.style.height=String.format("{0}px",Le.a.Nla),this.sc.style.overflowY="scroll",this.sc.style.top="0",A.AFrameworkApplication.isRtl?this.sc.style.right="0":this.sc.style.left=
"0",this.urd||(this.sc.style.marginTop="-48px"),this.Yy.style.minHeight=String.format("{0}px",this.FGh)):(this.sc.style.overflowY="hidden",this.sc.style.top="10%",this.sc.style.height=this.xLb);this.oUb()}oUb(){if(this.sc){var L=this.sc.style.zIndex;this.sc.style.zIndex="-9999";if(this.o_a>Le.a.Ida)A.AFrameworkApplication.isRtl?this.sc.style.marginRight="0":this.sc.style.marginLeft="0";else{const ba=String.format("{0}px",Math.floor(-this.sc.offsetWidth/2));A.AFrameworkApplication.isRtl?this.sc.style.marginRight=
ba:this.sc.style.marginLeft=ba;A.AFrameworkApplication.isRtl?this.sc.style.right="50%":this.sc.style.left="50%"}this.sc.style.zIndex=String(L)}else m.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}AF(){super.AF();const L=document.getElementById(this.ki(this.YIh));L.style.width=String.format("{0}px",this.o_a);L.style.height=this.xLb}get eXb(){return this.Yy}}Object(h.a)(ah,"AppsForOfficeInsertionDialog",Fc.a,[744]);var Fi=d(1156),Wi=d(180);class Mg{constructor(L,ba,Sa){this.mtb=
L;this.onSuccess=ba;this.onError=Sa;$addHandler(window,"message",Object(H.a)(this,this.g1b,"handleResponse"))}g1b(L){try{if(L&&L.rawEvent&&L.rawEvent.origin&&this.mtb&&this.mtb.id){var ba=this.i2g(L.rawEvent.origin);const Sa=this.i2g(document.domain);if(Fi.a.rt().equals(Sa,ba))if(L.rawEvent.source&&L.rawEvent.source.frameElement&&L.rawEvent.source.frameElement.id&&Fi.a.rt().equals(L.rawEvent.source.frameElement.id,this.mtb.id)){ba=null;try{ba=JSON.parse(L.rawEvent.data)}catch(sb){m.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",sb.message)}ba?(ba.statusCode!==Wi.a.Xy||void 0!==ba.error&&ba.error?(m.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",ba.statusCode,ba.error),this.onError()):(m.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(ba.authorizationCode?ba.authorizationCode:
ba.signInUrl)),$removeHandler(window,"message",Object(H.a)(this,this.g1b,"handleResponse")),this.mtb?document.body.contains(this.mtb)?document.body.removeChild(this.mtb):m.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):m.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):m.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else m.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else m.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else m.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Sa){m.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Sa.message)}}i2g(L){let ba="";try{L&&(ba=-1<L.indexOf("//")?L.split("/")[2]:L.split("/")[0])&&(ba=ba.split(":")[0],ba=ba.split("?")[0])}catch(Sa){m.ULS.sendTraceTag(51451615,
344,10,"Failed to parse host name from url: {0}",Sa.message)}return ba}static kA(L,ba,Sa){new Mg(L,ba,Sa)}}Object(h.a)(Mg,"ResponseHandler",null,[]);var ee=d(218);class Lf{constructor(L){this.cpa=L}tryAuthenticate(L,ba){this.C9c(Lf.CLh,()=>{L()},ba)}tryAuthorize(L,ba){this.C9c(Lf.pGh,L,ba)}getSignInUrl(L,ba){this.C9c(Lf.uuf,L,ba)}signOut(L,ba){this.C9c(Lf.YTh,L,ba)}C9c(L,ba,Sa){var sb=new ee.QueryStringBuilder("AuthenticationProxyHandler.aspx");sb.nj("responseType",L);A.AFrameworkApplication.BMa(sb);
sb=String.format("{0}{1}&{2}",this.cpa,sb.toString(),A.AFrameworkApplication.$g);const Tb=document.createElement("iframe");Tb.setAttribute("id","privateCatalogIframe");Tb.setAttribute("name","privateCatalogIframe");Tb.setAttribute("style","display: none");Fi.a.rt().equals(L,Lf.uuf)||Tb.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Mg.kA(Tb,ba,Sa);Tb.setAttribute("src",sb);document.body.appendChild(Tb)}}Lf.pGh="authcode";Lf.CLh="identitytoken";
Lf.uuf="signinurl";Lf.YTh="signout";Object(h.a)(Lf,"AuthenticationProxy",null,[]);class Vf{}Vf.getUserId="getUserId";Vf.getLastStoreUpdate="laststoreupdate";Vf.getEntitlement="getEntitlements";Vf.getEToken="getEToken";Vf.getManifest="getManifest";Vf.getAppState="getAppState";Vf.getKilledApps="getRemovedAddins";Vf.getAppDetails="getAppDetails";Vf.removeApps="removeAddin";Vf.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Vf.getPrivateCatalogAddIns="getAddIns";Vf.getPrivateCatalogManifests=
"getAppManifests";Vf.isStoreDisabled="isStoreDisabled";Object(h.a)(Vf,"S2SWebRequestActions",null,[]);var fd=d(516);class Ee{getUserId(L,ba){const Sa=new e.a;Sa.add(new Ja.a("corr",L));this.dw(Vf.getUserId,Sa,1,ba)}getLastStoreUpdate(L,ba,Sa){const sb=new e.a;sb.add(new Ja.a("lc",L));sb.add(new Ja.a("corr",ba));this.dw(Vf.getLastStoreUpdate,sb,1,Sa)}getEntitlement(L,ba,Sa,sb){L=new e.a;L.add(new Ja.a("av",ba));L.add(new Ja.a("corr",Sa));this.dw(Vf.getEntitlement,L,1,sb)}getEToken(L,ba,Sa,sb,Tb,Tc){const Vb=
new e.a;Vb.add(new Ja.a("cmu",L));Vb.add(new Ja.a("cmf",ba));Vb.add(new Ja.a("assetid",Sa));Vb.add(new Ja.a("expver",sb));Vb.add(new Ja.a("corr",Tb));this.dw(Vf.getEToken,Vb,1,Tc)}getManifest(L,ba,Sa,sb){const Tb=new e.a;Tb.add(new Ja.a("cmu",L));Tb.add(new Ja.a("assetid",ba));Tb.add(new Ja.a("corr",Sa));this.dw(Vf.getManifest,Tb,1,sb)}getAppState(L,ba,Sa){const sb=new e.a;sb.add(new Ja.a("ma",L));sb.add(new Ja.a("corr",ba));this.dw(Vf.getAppState,sb,1,Sa)}getKilledApps(L,ba){const Sa=new e.a;Sa.add(new Ja.a("corr",
L));this.dw(Vf.getKilledApps,Sa,1,ba)}getAppDetails(L,ba,Sa,sb){const Tb=new e.a;Tb.add(new Ja.a("cmo",L));Tb.add(new Ja.a("corr",Sa));this.sendWithBody(Vf.getAppDetails,Tb,ba,2,sb,!1)}removeApps(L,ba,Sa){const sb=new e.a;sb.add(new Ja.a("corr",ba));this.sendWithBody(Vf.removeApps,sb,L,2,Sa,!1)}getLastPrivateCatalogUpdate(L,ba,Sa,sb,Tb,Tc){const Vb=new e.a;Vb.add(new Ja.a("catalog","privatecatalog"));Vb.add(new Ja.a("clientCode",L));Vb.add(new Ja.a("clientVersion",ba));Vb.add(new Ja.a("corr",Tb));
L=String.format("authorizationCode={0}&refreshToken={1}",Sa?ia.a.Me(Sa):"",sb?ia.a.Me(sb):"");this.sendWithBody(Vf.getLastPrivateCatalogUpdate,Vb,L,2,Tc,!0)}getPrivateCatalogAddIns(L,ba,Sa,sb,Tb,Tc){const Vb=new e.a;Vb.add(new Ja.a("catalog","privatecatalog"));Vb.add(new Ja.a("clientCode",L));Vb.add(new Ja.a("clientVersion",ba));Vb.add(new Ja.a("corr",Tb));L=String.format("authorizationCode={0}&refreshToken={1}",Sa?ia.a.Me(Sa):"",sb?ia.a.Me(sb):"");this.sendWithBody(Vf.getPrivateCatalogAddIns,Vb,
L,2,Tc,!0)}getPrivateCatalogManifests(L,ba,Sa,sb,Tb){const Tc=new e.a;Tc.add(new Ja.a("catalog","privatecatalog"));Tc.add(new Ja.a("corr",sb));L=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",ia.a.Me(L),ba?ia.a.Me(ba):"",Sa?ia.a.Me(Sa):"");this.sendWithBody(Vf.getPrivateCatalogManifests,Tc,L,2,Tb,!0)}isStoreDisabled(L,ba){const Sa=new e.a;Sa.add(new Ja.a("corr",L));this.dw(Vf.isStoreDisabled,Sa,2,ba)}dw(L,ba,Sa,sb){this.sendWithBody(L,ba,null,Sa,sb,!1)}sendWithBody(L,ba,Sa,
sb,Tb,Tc){const Vb=new ee.QueryStringBuilder("AddinServiceHandler.ashx");Vb.nj("action",L);Vb.nj("app",fd.a[A.AFrameworkApplication.Ba.jb.vm]);for(let Ed of ba)Vb.nj(Ed.key,Ed.value);ba=String.format("{0}{1}&{2}",A.AFrameworkApplication.Ba.jb.tda,Vb.toString(),A.AFrameworkApplication.$g);A.AFrameworkApplication.Be.Jj(ba,sb,Sa,null,!1,2,Ed=>{let ae=null,Rd=null;Ed&&Ed.data&&(Ed.data.lj["X-BlockedForMinor"]&&"1"===Ed.data.lj["X-BlockedForMinor"].toString()&&(Ed.data.tf=451),ae=Ed.data.je,Rd=Ed.data.lj);
Tb(Ed.data.tf,ae,Rd)},Ed=>{var ae=null;let Rd=null;Tc&&Ed&&Ed.data&&Ed.data.je&&(ae=Ed.data.je,Rd=Ed.data.lj);Tb(Ed.data.tf,ae,Rd);if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){ae={message:"AddinServiceHandler request failed"};ae.code=Ed.data.tf;ae.action=L;if(Ed.data.request||Ed.data.request.get_headers())ae["X-UserSessionId"]=Ed.data.request.get_headers()["X-UserSessionId"];408===Ed.data.tf||503===Ed.data.tf?m.ULS.sendTraceTag(538784582,
220,10,JSON.stringify(ae)):m.ULS.sendTraceTag(18392345,220,50,JSON.stringify(ae))}else m.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Ed.data.tf)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+L,void 0,void 0,void 0,void 0,["X-UserKey"])}}Object(h.a)(Ee,"S2SWebRequestManager",null,[]);var Yf=d(247),ij=d(30),Md=d(81);class pj{constructor(L,ba){this.state=L;this.Xva=ba}}Object(h.a)(pj,"BackgroundAppData",null,[1090]);class qj{constructor(L,ba,Sa,sb,Tb,Tc,Vb){this.Ega=
null;this.TFh=L;this.cVh=sb;this.Rtd=ba;this.aza=Sa;this.settings=Tb;this.n5=Tc;this.Cv=Vb}get Um(){return this.TFh}get taskpane(){return this.cVh}get instanceId(){return this.Rtd}get shape(){return this.aza}get ay(){return this.n5}TXh(L){this.Cv=new pj(0,L)}}Object(h.a)(qj,"AppForOffice",null,[1051]);var jj=d(29);class Ag{}Ag.c_Error="Error";Object(h.a)(Ag,"ApiResponseKeyStrings",null,[]);class mf{constructor(L,ba,Sa,sb,Tb){this.EventDispId=L;this.ControlId=ba;this.TargetId=Sa;this.Handler=sb;this.Callback=
Tb}}Object(h.a)(mf,"EventRegistrationParams",null,[]);var Ia=d(26);class tb{constructor(L,ba){this.invokeDdaMethod=this.InvokeDdaMethod;this.registerDdaEventAsync=this.RegisterDdaEventAsync;this.Bb=A.AFrameworkApplication.ve;this.fme=L;this.oEg=ba}InvokeDdaMethod(L,ba,Sa){const sb=L.DdaMethod.DispatchId,Tb=this.fme.cWi(sb);Tb?(Tb.parameters=L,Tb.callback=ba,Tb.f5h=Sa,Tb.controlId=L.DdaMethod.ControlId,this.Bb.Hb(new yf.a(2,1,0,Object(H.a)(Tb,Tb.go,"go"),90,"51"))):(L="API Call for method ID "+sb+
" does not exist:"+jj.Debug.qt(),Ia.a.J(8958091,802,10,L),this.FKd(ba))}RegisterDdaEventAsync(L,ba,Sa,sb,Tb){const Tc=new yf.a(2,1,0,Object(H.a)(this,this.sIk,"registerEventTaskProcess"),90,"52");Tc.customData=new mf(L,ba,Sa,sb,Tb);this.Bb.Hb(Tc)}UnregisterDdaEventAsync(L,ba,Sa,sb,Tb){const Tc=new yf.a(2,1,0,Object(H.a)(this,this.Epl,"unregisterEventTaskProcess"),90,"53");Tc.customData=new mf(L,ba,Sa,sb,Tb);this.Bb.Hb(Tc)}sIk(L){L=L.customData;var ba=this.oEg.XWd(L.EventDispId);ba?ba.addHandler(L.ControlId,
L.Handler,L.Callback,L.TargetId):(ba="Event for dispatch ID "+L.EventDispId+" does not exist:"+jj.Debug.qt(),Ia.a.J(8958093,802,10,ba),this.FKd(L.Callback))}Epl(L){L=L.customData;var ba=this.oEg.XWd(L.EventDispId);ba?ba.removeHandler(L.ControlId,L.Handler,L.Callback,L.TargetId):(ba="Event for dispatch ID "+L.EventDispId+" does not exist:"+jj.Debug.qt(),Ia.a.J(8958095,802,10,ba),this.FKd(L.Callback))}FKd(L){if(L){var ba={};ba[Ag.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;L(ba)}}}
Object(h.a)(tb,"AppForOfficeApiAdapter",null,[1108]);class Qb{constructor(L,ba,Sa,sb){this.menuItemId=L;this.OT=ba;this.ffl=Sa;this.QOi=sb}}Object(h.a)(Qb,"NewDocumentParameters",null,[]);var qc=d(570),Lc=d(129),Jd=d(138),le=d(41),je=d(50),Gf=d(75),Wf=d(31),fh=d(36),zh=d(49),Qg=d(38),Rg=d(32),wi=d(61);class Ng{constructor(L,ba,Sa){this.hbb=[];this.kYc=this.hxb=!1;this.xa=L;this.bF=ba;this.Dy=Sa}build(){const L=this.xa.hD();if(!L)return this.hbb;for(const ba of L)if(this.Lyk(ba),this.kYc)break;return this.hbb}Lyk(L){const ba=
Wf.ParagraphReader.textLength(L);this.Myk(L,ba);this.kYc||this.qyk(L)}Myk(L,ba){this.hxb||(this.bF>=ba?this.bF-=ba:(this.hxb=!0,this.Dy||this.hbb.push(zh.a.Wj(Object(C.a)(Md.a,L),this.bF))));this.hxb&&(this.Dy>ba-this.bF?0<ba&&(this.hbb.push(zh.a.createTextRange(Object(C.a)(Md.a,L),this.bF,ba)),this.Dy-=ba-this.bF,this.bF=0):0<this.Dy&&(this.hbb.push(zh.a.createTextRange(Object(C.a)(Md.a,L),this.bF,this.bF+this.Dy)),this.Dy=0));0>=this.Dy&&(this.kYc=!0)}qyk(L){this.hxb||(0<this.bF?--this.bF:(this.hxb=
!0,this.Dy||this.hbb.push(zh.a.PNa(Object(C.a)(Md.a,L)))));this.hxb&&0<this.Dy&&(this.hbb.push(zh.a.Saa(Object(C.a)(Md.a,L))),--this.Dy);0>=this.Dy&&(this.kYc=!0)}}Object(h.a)(Ng,"TextSelectionBuilder",null,[]);var Fj=d(959),Hh=d(28);class gg{constructor(L,ba,Sa,sb,Tb,Tc,Vb,Ed,ae,Rd,pe,ff,eg,kh,Wa,qb,dg,zb,km,Nj,Wj,Oj,Tl){this.Ha=L;this.kc=ba;this.uI=Sa;this.M9b=sb;this.sa=Tb;this.cW=Tc;this.U_c=Vb;this.Jb=Ed;this.ia=ae;this.ua=pe;this.Wb=Rd;this.Ub=ff;this.uc=eg;this.aXj=kh;this.ob=Wa;this.Pb=qb;
this.rm=dg;this.Fa=zb;this.Ib=km;this.wab=Nj;this.Zh=Wj;this.Ix=Oj;this.V2j=Tl}F$i(){let L;L="";if(this.ob.rG()){if(1<this.ob.Hed())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Pic:L};const ba=this.ob.Dq();if(this.VLj(ba)){const Sa=[];this.Fa.RI(ba,sb=>{sb&&Sa.push(sb.characterData)});L=Sa.join(gg.DJf);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Pic:L}}}else if(this.ob.jD())return this.getSelectedTextRange();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,
Pic:L}}B$i(){let L;L="";return{returnValue:({eMe:L}=this.getSelectedSlides()).returnValue,JWk:L}}Krb(){return this.uI.kdb.documentUrl}ygj(L){if(!L)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;var ba=this.Ub.wj();if(!this.ua.Ca)throw Error.argumentNull("ActiveSlide is null");const Sa=this.ua.Ca.Ge;switch(L){case "previous":L=Sa-1;break;case "next":L=Sa+1;break;case "first":L=0;break;case "last":L=ba-1;break;default:if(L=parseInt(L),isNaN(L))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo}if(0>
L||L>ba-1)return OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound;ba=this.Ub.UH(L);if(!ba)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;this.Wb.Ca=ba;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}zgj(L){if(!L)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;L=parseInt(L);if(isNaN(L))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;L=this.E0d(L);if(!L)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.Wb.Ca=L;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}x2k(L){var ba=
this.ob.he();if(!ba.length){if(ba=Object(C.a)(132,this.ob.ny()||this.ua.Ca)){var Sa=ba.Cb;L=this.rm.VOd(Sa.cid,Sa.sid,ba.Mu()+1,L,"");Sa=this.Jb.xd(7);Sa.lc(ba);ba.uB(L);this.ob.selectShape(L,!0);Sa.dispose();this.Ix.oI=L;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}else if(1===ba.length){if(this.ob.rG())return this.x3k(L);if(this.ob.jD())return this.y3k(L)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}s2k(L,ba,Sa,sb,Tb,Tc,Vb){if(this.rIc(Tb,0,gg.Phb)||this.rIc(Tc,
0,gg.Phb)||this.rIc(Sa,-gg.Phb,gg.Phb)||this.rIc(sb,-gg.Phb,gg.Phb)||0!==Vb&&1!==Vb)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(L.length>this.Ha.pptEditorAppsForOfficeImageMaxSizeInBytes)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge;var Ed=this.ob.he().length;if(ba||Tb||Tc||!Ed){Ed=this.ua.Ca;if(!Ed)throw Error.argumentNull("ActiveSlide is null");const ae=Ed.Cb,Rd=Ed.Mu();let pe=!0,ff=new wi.a(0,0);ba?ff=new wi.a(Sa,sb):!this.Ha.Puk||Tb&&Tc?ff=this.Ub.rra(Tb,Tc):
pe=!1;ba=this.rm.eqa(!1,ae.cid,ae.sid,0,qc.a.XG(ff.x),qc.a.XG(ff.y),qc.a.XG(Tb),qc.a.XG(Tc),Rd+1,!0);pe||(ba.Kn(fh.a.My),ba.Kn(fh.a.Ny));ba.sk=!0;ba.rhd=!0;ba.py=Vb;ba.ria=0===Vb?this.UQf(L):L;ba.Utb=!0;L=this.Jb.xd(7);try{L.lc(Ed),Ed.uB(ba),this.ob.selectShape(ba,!0)}finally{L&&L.dispose()}this.Ix.oI=ba;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}if(1===Ed&&(Ed=this.ob.Dq())&&Ed.bCc){ba=this.ua.Ca;if(!ba)throw Error.argumentNull("ActiveSlide is null");Sa=this.y6a(ba,Ed);Sa.sk=!0;Sa.py=
Vb;Sa.ria=0===Vb?this.UQf(L):L;Sa.Utb=!0;L=this.Jb.xd(7);try{L.lc(ba),ba.xT([Ed]),ba.uB(Sa),this.ob.selectShape(Sa,!0)}finally{L&&L.dispose()}this.Ix.oI=Sa;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Ia.a.J(17687456,802,10,"No placehoder seleted or multi-shape seleted.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Cia(){return this.Ha.Cia}bAj(){return this.kc.ka(uf.a.pa(342))}Z_i(L){if(!L)return null;L=this.aXj.M1(L);L=0===L.ay?L.node:this.ua.Ca;if(!L)return null;
L=Object(C.a)(131,this.uc.Sg(L));return Xc(L.Ye)}XFe(L,ba){if(L&&ba)if(Qe.a("UseUndoTransactionForSaveSettingToApp")){var Sa=this.Jb.xd(15,void 0,void 0,void 0,!0);try{Sa.lc(L),Sa.fd=Hh.a.Nlg,Fj.a.fzh(this.U_c.value,L,ba)}finally{Sa&&Sa.dispose()}}else{Sa=this.Jb.xd(4);try{Sa.lc(L),Fj.a.fzh(this.U_c.value,L,ba),this.Wb.Gi.Ama()}finally{Sa&&Sa.dispose()}}}$3a(L,ba,Sa){const sb=new y.StandardDialog;sb.vd=4;sb.Tw(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,
1,Tb=>{2===Tb||0===Tb?Sa(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled):(Tb=new Qb("blank","agave",L?gg.cck:gg.dck,L),this.V2j.create(ba,Sa,Tb).$3a())})}rf(){return this.ob.rf()}he(){return this.ob.he()}J$i(){var L=this.ob.he();if(!(L.length&&this.ob.jD()&&this.sa.value&&this.sa.value.Pa.length))return[];const ba=this.sa.value.Pa.ga(0);return(L=gg.J8i(L[0],ba))&&2===L.length?L:[]}hol(L){if(!L)return!1;this.ob.$Wb();if(!L.length)return!0;L[0]!==this.ua.Ca&&(this.Wb.Ca=L[0]);for(const ba of L)ba&&
this.ob.z2a(ba);return!0}gol(L){if(!L)return!1;if(!L.length)return this.ob.Rh(),!0;this.ob.mXa(L,!0);return!0}iol(L,ba,Sa){if(!gg.uwg(L))return!1;if(0>ba)return!0;L=(new Ng(L,ba,Sa)).build();L=[new Lc.Selection(L,!0)];L=new Jd.SelectionCollection(L,0);this.ob.UD(L);return!0}getSelectedSlides(){let L;L="";var ba=null;if(!ba||!ba.length){var Sa=this.ob.ny()||this.ua.Ca;ba||(ba=[]);Sa&&ba.push(Sa)}if(!ba.length)return Ia.a.J(8958112,802,10,"Unexpected error: cannot get current slide."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
eMe:L};Sa=[];for(const sb of ba){ba=sb.Ge+1;if(!ba)return Ia.a.J(8958144,802,10,"Returned slide index is invalid."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,eMe:L};Array.add(Sa,[sb.sid.toString(),sb.title||"",ba.toString()])}L=da.c(Sa);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,eMe:L}}getSelectedTextRange(){var L=[];for(let ba=0;ba<this.sa.value.Pa.length;ba++){const Sa=this.sa.value.Pa.ga(ba);Array.add(L,this.VMc(Sa))}L=L.join(gg.DJf);if(L===Gf.AParagraphNode.VY)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,
Pic:L};L=Gf.AParagraphNode.qcd(L);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Pic:L}}VLj(L){if(!L)return!1;let ba=L.osa||L.xx||L.fg||L.rd;if(!ba&&L.ll)switch(L.zj){case 0:case 2:case 1:case 3:case 10:case 8:ba=!0}return ba}WLj(L){if(!L)return!1;let ba=L.osa||L.xx;if(!ba&&L.ll)switch(L.zj){case 0:case 2:case 1:case 3:case 8:ba=!0}return ba}VMc(L){let ba="";if(L)for(let Sa=0;Sa<L.length;Sa++){const sb=L.ga(Sa),Tb=sb.Qa,Tc=sb.Lb-Tb;let Vb="";Wf.ParagraphReader.Pd(sb.node)&&(Vb=
sb.node.characterData);switch(sb.contextId){case Qg.a.paragraph:ba+=Vb+"\r";break;case Qg.a.textRange:0<Tc&&(ba+=Vb.substr(Tb,Tc));break;case Qg.a.endOfParagraph:ba+="\r"}}return ba}E0d(L){var ba=this.ua.presentation;if(!ba)throw Error.argumentNull("Presentation is null");ba=ba.slides||[];for(let Sa=0;Sa<ba.length;Sa++)if(ba[Sa].Cb.sid===L)return Object(C.a)(132,ba[Sa]);return null}y3k(L){if(!this.sa.value||!this.cW.value||!this.M9b.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
if(1===this.sa.value.Pa.length){if(!le.SelectionEditor.Ew(this.sa.value.Pa.kb)&&32!==this.ia.processAction(Rg.a.HAa,2))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var ba=this.sa.value.Pa.kb.Wa;const Sa=ba.node,sb=ba.Qa;ba=ba.Lb;const Tb=this.Jb.xd(7);try{Tb.lc(Sa);let Tc=null;Tc=sb===ba?zh.a.Wj(Sa,sb):zh.a.createTextRange(Sa,sb,ba);this.cW.value.replaceTextRange(Tc,L)}finally{Tb.dispose()}ba=sb+L.length;this.sa.value.setSelection(je.SelectionFactory.PY(Sa,sb,ba));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Ia.a.J(9246755,
802,10,"SetTextForSelectedTextRange is called when there are more than one shape selected.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}x3k(L){if(!this.sa.value||!this.cW.value||!this.M9b.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const ba=this.ob.Dq();if(!ba)return L="Fail to get shape while setting selected shape's text: shape returned as null: "+jj.Debug.qt(),Ia.a.J(9246785,802,10,L),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.WLj(ba)){const Sa=
this.Ib.Jc(ba),sb=this.Jb.xd(7);try{sb.lc(Sa);ba.deleteParagraph();this.M9b.value.zY(Sa,!0);this.wab.ti(Sa);const Tb=Sa.currentNode,Tc=this.Zh.textLength(Tb),Vb=zh.a.createTextRange(Tb,0,Tc);this.cW.value.replaceTextRange(Vb,L)}finally{sb.dispose()}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Ia.a.J(17310298,802,10,"Shape is not supported by SetDataAsync");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}rIc(L,ba,Sa){return L<ba||Sa<L}UQf(L){return"data:image/png;base64,"+
L}y6a(L,ba){if(!L)return null;var Sa=L.Cb;L=L.Mu();let sb;const Tb=pc.a.p9,Tc=pc.a.o9;sb=ba?ba.fsb(pc.a.p9,pc.a.o9):this.Ub.rra(pc.a.p9,pc.a.o9);Sa=this.rm.eqa(!0,Sa.cid,Sa.sid,0,sb.x,sb.y,Tb,Tc,L+1,!0);ba&&(Sa.Haa=ba.id);return Sa}static uwg(L){if(!L)return!1;let ba=L.osa||L.xx;if(!ba&&L.ll)switch(L.zj){case 0:case 2:case 1:case 3:case 5:case 6:case 8:ba=!0}return ba}static rdj(L,ba){L=L.hD();if(!L||!ba)return 0;let Sa=0;for(const sb of L){if(sb===ba)break;Sa+=Wf.ParagraphReader.textLength(Object(C.a)(Md.a,
sb))+1}return Sa}static J8i(L,ba){if(!gg.uwg(L)||!ba)return[];var Sa=-1;let sb=0;for(let Tb of ba){ba=Wf.ParagraphReader.Pd(Tb.node)?Wf.ParagraphReader.textLength(Tb.node):0;if(-1===Sa)switch(Sa=Wf.ParagraphReader.Pd(Tb.node)?gg.rdj(L,Object(C.a)(5,Tb.node)):0,Tb.contextId){case Qg.a.paragraph:break;case Qg.a.textRange:case Qg.a.Ff:Sa+=Tb.Qa;break;case Qg.a.endOfParagraph:Sa+=ba;break;default:return[]}switch(Tb.contextId){case Qg.a.paragraph:sb+=ba+1;break;case Qg.a.textRange:sb+=Math.max(0,Tb.Lb-
Tb.Qa);break;case Qg.a.endOfParagraph:sb+=1}}return[Sa,sb]}}gg.DJf=" ";gg.Phb=169056;gg.dck="streamEmpty";gg.cck="streamBase64";Object(h.a)(gg,"AppForOfficeApiFacadeEditorImpl",null,[1107]);class Og{Wgg(L,ba,Sa){if(Sa.oBa(L))m.ULS.sendTraceTag(512360733,806,10,"[HandlePersistedOwnerApp]This method should not be invoked when OwnerApp already exists.");else if(L=Sa.TYb(L)){const sb={};sb.solutionId=L.Um.id;sb.version=L.Um.version;sb.storeType=L.Um.storeType;sb.storeId=L.Um.store;sb.assetId=L.Um.id;
sb.assetStoreId=L.Um.storeType;sb.targetType=1;sb.isAddinCommands=!0;sb.addinCommandsActionType=1;sb.sharedRuntimeId=L.Cv?L.Cv.Xva:null;sb.backgroundState=L.Cv?L.Cv.state:-1;L.settings=ba;Sa.xHd.lK().Ma(Hh.a.dQc,2,sb);return!0}return!1}Zzj(L,ba){if(!L&&!ba)return!0;if(!L||!ba||Object.keys(L).length!==Object.keys(ba).length)return!1;for(let Tb in L){var Sa=Tb,sb=L[Tb];if(!(Sa in ba)||ba[Sa]!==sb)return!1}return!0}}Object(h.a)(Og,"AppForOfficeAppSettingProxy",null,[]);class vg{constructor(L,ba,Sa,sb){this._id=
L;this.hmb=ba;this.d6=Sa;this.rvf=sb}get id(){return this._id}get version(){return this.hmb}get store(){return this.d6}get storeType(){return this.rvf}}Object(h.a)(vg,"AppForOfficeReference",null,[1106]);class Sg{constructor(L,ba){this._id=L;this.jUh=ba}get id(){return this._id}get slideId(){return this.jUh}}Object(h.a)(Sg,"AppForOfficeShape",null,[1105]);class wh{constructor(L,ba,Sa,sb,Tb,Tc=null,Vb=!1){this.aJh=L;this.MWh=ba;this.k2a=Sa;this.FSh=sb;this.Gyd=Tb;this.isForUILessAction=Vb;this.nQh=
Tc}get TWf(){return this.aJh}get visibility(){return this.MWh}get width(){return this.k2a}get row(){return this.FSh}get ownerAddinSolutionId(){return this.Gyd}get ownerAddinStoreType(){return this.nQh}}Object(h.a)(wh,"AppForOfficeTaskpane",null,[1091]);class ci{constructor(L,ba,Sa,sb=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=L;this.controlId=ba;this.ddaBinding=Sa;this.ArrayData=sb}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}
Object(h.a)(ci,"DdaEventArgs",null,[]);class Rh{constructor(L,ba){this.bxb=null;this.Zd=L;this.ia=ba}XWd(L){this.bxb||this.Ctk();if(!L||!this.bxb[L])return null;L=this.bxb[L];L.Ce=this.Zd;L.Ho=this.ia;return L}FMf(L){const ba=this.bxb;for(let Sa in ba)ba[Sa].removeHandler(L)}set(L,ba){this.bxb[L]=ba}}Object(h.a)(Rh,"ApiEventStore",null,[]);class se{constructor(){this.$n=this.ia=this.Zd=null;this.fl={}}get handlers(){return this.fl}get Ho(){return this.ia}set Ho(L){this.ia=L}get Ce(){return this.Zd}set Ce(L){this.Zd=
L}raiseEvent(L,ba=null){L=this.tra(L);if(ba){var Sa=this.fl[ba];Sa&&Sa(L)}else for(Sa in ba=this.fl,ba){const sb=ba[Sa];sb&&sb(L)}}addHandler(L,ba,Sa=null){this.fl[L]=ba;this.o3a(Sa)}removeHandler(L,ba,Sa=null){delete this.fl[L];this.o3a(Sa)}get result(){return this.$n}o3a(L){this.mA(L,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}mA(L,ba){L&&(this.$n={},this.$n[Ag.c_Error]=ba,L(this.$n))}}Object(h.a)(se,"ApiEvent",null,[1134]);class bf extends se{constructor(){super()}tra(L){return L}static get instance(){bf.np||
(bf.np=new bf);return bf.np}}bf.np=null;Object(h.a)(bf,"ActivationStatusChangedEvent",se,[]);class Sh extends se{constructor(){super()}tra(){return"view"}static get instance(){Sh.np||(Sh.np=new Sh);return Sh.np}}Sh.np=null;Object(h.a)(Sh,"ActiveViewChangedEvent",se,[]);var $c=d(105);class Gi extends se{constructor(){super();this.kde=null}tra(){return null}get rqa(){!this.kde&&this.Ce&&(this.kde=ad.getInstance(this.Ce.Ko));return this.kde}addHandler(L,ba,Sa=null,sb=null){this.Ce?this.Ce.Rt.Cia()?L in
this.handlers?this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(m.ULS.sendTraceTag(20247126,802,50,"AddHandler was called."),this.showDialog(L,sb,Tb=>{Tb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?($c.a.count(this.handlers)||this.rqa.P2h(Object(H.a)(this,this.ive,"onMessageParentEvent")),this.handlers[L]=ba,this.Ce.Ko?({value:Tb}=ad.Zeg().Nf(L),Tb?(this.Ce.Ko.setActivationCompletedStatus(Tb.kg,!0),this.Ce.wWa(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),
Tb.kg,!0)):m.ULS.sendTraceTag(24463263,806,15,"Show dialog successed but get dialogInfo failed")):m.ULS.sendTraceTag(24463264,806,15,"Show dialog successed but ContextActivationManager is null"),this.o3a(Sa)):(m.ULS.sendTraceTag(20247127,806,10,"Show dialog failed. Error code: {0}",Tb.toString()),this.mA(Sa,Tb))})):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(L,ba,Sa=null){this.Ce?this.Ce.Rt.Cia()?
L in this.handlers?(m.ULS.sendTraceTag(20247128,802,50,"RemoveHandler was called."),this.rqa.zmi(L,sb=>{delete this.handlers[L];$c.a.count(this.handlers)||this.rqa.Sbh(Object(H.a)(this,this.ive,"onMessageParentEvent"));sb!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&m.ULS.sendTraceTag(20247129,806,10,"Close dialog failed. Error code: {0}",sb.toString());this.mA(Sa,sb)})):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):
this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}showDialog(L,ba,Sa){try{this.rqa.showDialog(ba,L,Sa,null)}catch(sb){m.ULS.sendTraceTag(19535264,806,10,"DialogMessageReceivedEvent: Show dialog failed. Exception message: {0}",sb.message),Sa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}ive(L,ba){if(ba.controlId in this.fl){L={};L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=ba.messageType;L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=
ba.messageContent;L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=ba.zre;L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=ba.OIa;const Sa=this.fl[ba.controlId];Sa&&Sa(L);ba.messageType===OSF.DialogMessageType.DialogClosed&&(delete this.fl[ba.controlId],$c.a.count(this.fl)||this.rqa.Sbh(Object(H.a)(this,this.ive,"onMessageParentEvent")))}}static get instance(){Gi.np||(Gi.np=new Gi);return Gi.np}}Gi.np=null;Object(h.a)(Gi,"DialogMessageReceivedEvent",
se,[]);class Hk extends se{constructor(){super()}tra(){return null}addHandler(L,ba,Sa=null){this.Ce?this.Ce.Rt.Cia()?(ba=this.Ce.qrb(L))&&ba.taskpane&&ba.taskpane.isForUILessAction?(this.Ho.Ma(ie.a.ykc,2,L),this.o3a(Sa)):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(L,ba,Sa=null){this.Ce?this.Ce.Rt.Cia()?(ba=this.Ce.qrb(L))&&ba.taskpane?
ba.taskpane.isForUILessAction?(this.Ho.Ma(ie.a.G1b,2,L),this.o3a(Sa)):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Object(h.a)(Hk,"DialogNotificationShownInAddinEvent",se,[]);class Gj extends se{constructor(){super();this.Ko=this.hId=null}tra(){return null}get rqa(){this.hId||
(this.hId=ad.getInstance(this.contextActivationMgr));return this.hId}get contextActivationMgr(){!this.Ko&&this.Ce&&(this.Ko=this.Ce.Ko);return this.Ko}addHandler(L,ba,Sa=null){this.Ce&&!this.Ce.Rt.Cia()?this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):L in this.fl?this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):($c.a.count(this.fl)||this.rqa.O2h(Object(H.a)(this,this.wYg,"onMessageDialogEvent")),this.fl[L]=ba,this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess))}removeHandler(L,
ba,Sa=null){this.Ce&&!this.Ce.Rt.Cia()?this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):L in this.fl?(delete this.fl[L],$c.a.count(this.fl)||this.rqa.qNk(Object(H.a)(this,this.wYg,"onMessageDialogEvent")),this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}wYg(L,ba){ba.controlId in this.fl&&(L={},L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=ba.messageType,L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=
ba.messageContent,L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=ba.zre,L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=ba.OIa,(ba=this.fl[ba.controlId])&&ba(L))}static get instance(){Gj.np||(Gj.np=new Gj);return Gj.np}}Gj.np=null;Object(h.a)(Gj,"DialogParentMessageReceivedEvent",se,[]);class Hj extends se{constructor(){super()}tra(){return{}}static get instance(){Hj.np||(Hj.np=new Hj);return Hj.np}}Hj.np=null;Object(h.a)(Hj,"DocumentSelectionChangedEvent",
se,[]);class wa extends se{constructor(){super()}tra(){return null}raiseEvent(L,ba){try{const Sa=this.fl[ba];Sa&&(ba={},ba[OSF.DDA.Marshaling.ThemingKeys.DocumentTheme.toString()]=L,Sa(ba))}catch(Sa){Ia.a.J(17687447,802,10,"DocumentThemeChanged Event failed, message: "+Sa.message)}}static get instance(){wa.np||(wa.np=new wa);return wa.np}}wa.np=null;Object(h.a)(wa,"DocumentThemeChangedEvent",se,[]);class Ma extends se{constructor(){super()}tra(){return null}addHandler(L,ba,Sa=null){this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}removeHandler(L,
ba,Sa=null){this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}static get instance(){Ma.np||(Ma.np=new Ma);return Ma.np}}Ma.np=null;Object(h.a)(Ma,"OfficeThemeChangedEvent",se,[]);class hb{constructor(){}}Object(h.a)(hb,"RichApiEventManagerHost",null,[1135]);class ub extends se{constructor(){super();this.FAd=null}tra(L){return L}addHandler(L,ba,Sa=null,sb=null){this.Ce&&Da.a(sb)?(this.FAd||(this.FAd=new hb(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.FAd)),
this.fl[L]=ba,this.o3a(Sa)):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(L,ba,Sa=null,sb=null){this.Ce&&Da.a(sb)&&L in this.fl?(delete this.fl[L],this.o3a(Sa)):this.mA(Sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}static get instance(){return ub.Ka||(ub.Ka=new ub)}}ub.Ka=null;Object(h.a)(ub,"RichApiMessageEvent",se,[]);class na extends se{constructor(){super()}tra(L){return L}static get instance(){na.np||(na.np=new na);return na.np}}na.np=null;Object(h.a)(na,
"SettingsChangedEvent",se,[]);class Pa extends Rh{constructor(L,ba){super(L,ba)}Ctk(){this.bxb={};this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,na.instance);this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,Sh.instance);this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,bf.instance);this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,wa.instance);this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,Ma.instance);this.set(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,
Hj.instance);this.set(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Gi.instance);this.set(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Gj.instance);this.set(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,new Hk);this.set(OSF.DDA.EventDispId.dispidRichApiMessageEvent,ub.instance)}}Object(h.a)(Pa,"EditorEventStore",Rh,[]);class cb{constructor(L){this.q9b=null;this.Zd=L}cWi(L){this.q9b||this.Utk();if(!L||!this.q9b[L])return null;if(L=this.q9b[L]())L.Ce=this.Zd;return L}set(L,
ba){this.q9b[L]=ba}}Object(h.a)(cb,"ApiMethodFactory",null,[]);class R{constructor(L,ba,Sa,sb){this.instanceId=L.toLowerCase();this.fileSize=ba;this.BUd=sb;this.lqh=Sa}}Object(h.a)(R,"DocumentCopy",null,[]);var ta=d(377),Ra=d(275);class nb extends ta.a{constructor(L,ba,Sa,sb,Tb,Tc,Vb){super();this.NA=L.string;this.GG=ba;this.Uja=Sa;this.eda=Tb;this.a6j=sb;this.S5b=Tc;this.zSa=Vb;this.KVa=Object(H.a)(this,this.Fhk,"onGetDocumentCopyChunkFinished");this.onError=Object(H.a)(this,this.Ehk,"onGetDocumentCopyChunkError")}start(){this.Sgd=
!1;Ra.a.i8f(this.NA,this.GG,this.Uja,this.a6j,this.eda,Object(H.a)(this,this.Fba,"handleWebserviceResponse"),Object(H.a)(this,this.Eba,"handleWebserviceError"))}Fhk(L){if(L.aPa){const ba={};L=L.result;ba.value=L.FileData;ba.errorCode=L.ErrorCode;this.S5b(this.GG,ba)}else this.handleError(L)}Ehk(L){this.handleError(L)}handleError(L){this.zSa&&(L=L.error,this.zSa(this.GG,!!L&&2===L.type))}}Object(h.a)(nb,"GetDocumentCopyChunkTask",ta.a,[]);class Cb extends ta.a{constructor(L,ba,Sa,sb,Tb,Tc){super();
this.NA=L.string;this.GG=ba;this.Uja=Sa;this.eda=sb;this.S5b=Tb;this.zSa=Tc;this.KVa=Object(H.a)(this,this.Hhk,"onGetDocumentCopyFinished");this.onError=Object(H.a)(this,this.Ghk,"onGetDocumentCopyError")}start(){this.Sgd=!1;Ra.a.W_i(this.NA,this.GG,this.Uja,Object(H.a)(this,this.Fba,"handleWebserviceResponse"),Object(H.a)(this,this.Eba,"handleWebserviceError"))}Hhk(L){if(L.aPa){const ba={};L=L.result;ba.fileSize=L.FileSize;ba.errorCode=L.ErrorCode;ba.format=this.Uja;ba.sliceSize=this.eda;this.S5b(this.GG,
ba)}else this.handleError(L)}Ghk(L){this.handleError(L)}handleError(L){this.zSa&&(L=L.error,this.zSa(this.GG,!!L&&2===L.type))}}Object(h.a)(Cb,"GetDocumentCopyTask",ta.a,[]);class mc extends ta.a{constructor(L,ba,Sa,sb,Tb,Tc,Vb){super();this.NA=L.string;this.GG=ba;this.Uja=Sa;this.m1j=sb;this.l1j=Tb;this.S5b=Tc;this.zSa=Vb;this.KVa=Object(H.a)(this,this.Gkk,"onReleaseDocumentCopyFinished");this.onError=Object(H.a)(this,this.Fkk,"onReleaseDocumentCopyError")}start(){this.Sgd=!1;Ra.a.qhc(this.NA,this.GG,
this.Uja,this.m1j,this.l1j,Object(H.a)(this,this.Fba,"handleWebserviceResponse"),Object(H.a)(this,this.Eba,"handleWebserviceError"))}Gkk(L){if(L.aPa){const ba={};ba.errorCode=L.result.ErrorCode;this.S5b(this.GG,ba)}else this.handleError(L)}Fkk(L){this.handleError(L)}handleError(L){this.zSa&&(L=L.error,this.zSa(this.GG,!!L&&2===L.type))}}Object(h.a)(mc,"ReleaseGetDocumentCopyTask",ta.a,[]);class Sc{constructor(){this.u3c=null}start(){this.u3c.start()}static Qvi(L,ba,Sa,sb,Tb,Tc){const Vb=new Sc;Vb.u3c=
new Cb(L,ba,Sa,sb,Tb,Tc);return Vb}static Pvi(L,ba,Sa,sb,Tb,Tc,Vb){const Ed=new Sc;Ed.u3c=new nb(L,ba,Sa,sb,Tb,Tc,Vb);return Ed}static cSf(L,ba,Sa,sb,Tb,Tc,Vb){const Ed=new Sc;Ed.u3c=new mc(L,ba,Sa,sb,Tb,Tc,Vb);return Ed}}Object(h.a)(Sc,"AppForOfficeTask",null,[]);class jd{constructor(){this.Tee=1;this.v1e=new gc.a}get mBa(){return this.v1e}Rfi(L,ba,Sa,sb){const Tb=this.jag();L=new R(L,ba,Sa,sb);this.mBa.$(Tb.toString(),L);return Tb}Erg(L,ba){for(let Sa of this.mBa){const sb=Sa.value;if(sb.instanceId===
L.toLowerCase()&&sb.BUd===ba)return!0}return!1}n6f(L){return this.mBa.ga(L.toString())}KKk(L){this.mBa.remove(L.toString())}qhc(L,ba,Sa,sb){(sb&&this.LKk(ba)||Sa&&this.CKk())&&Sc.cSf(L,ba,4,Sa,sb,()=>{},()=>{}).start()}CKk(){let L=!1;0<this.mBa.count&&(this.v1e=new gc.a,L=!0);return L}LKk(L){if(!L)return!1;const ba=[];for(let Sa of this.mBa)Sa.value.instanceId===L.toLowerCase()&&ba.push(Sa.key);for(L=0;L<ba.length;L++)this.mBa.remove(ba[L]);return 0<ba.length}jag(){return this.Tee++}}Object(h.a)(jd,
"GetDocumentCopyHelper",null,[1046]);class Ad{constructor(L,ba){this.rFg=ba.length;this.eda=L;this.$5j=Math.ceil(this.rFg/L);this.Ssi(ba)}Ssi(L){for(let ba=0;ba<this.$5j;ba++){const Sa=ba*this.eda;L.slice(Sa,Math.min(Sa+this.eda,this.rFg))}}}Object(h.a)(Ad,"DocumentCopyCache",null,[]);class ve{constructor(){this.Wme=this.xne=null;this.Xme=this.yne=0}add(L,ba,Sa,sb){4===ba?(this.yne=L,this.xne=new Ad(Sa,sb)):3===ba&&(this.Xme=L,this.Wme=new Ad(Sa,sb))}remove(L){this.yne===L?(this.yne=0,this.xne=null):
this.Xme===L&&(this.Xme=0,this.Wme=null)}contains(L){return 4===L&&!!this.xne||3===L&&!!this.Wme}}Object(h.a)(ve,"PerAppCache",null,[]);class Ae{get cache(){return Ae.hi}get CUd(){return Ae.rZj}Erg(L,ba){return L in this.cache&&this.cache[L].contains(ba)}i8f(){}qhc(L){if(L.toString()in this.CUd){const ba=this.CUd[L.toString()];delete this.CUd[L.toString()];this.cache[ba].remove(L)}}jag(){return Ae.Tee++}}Ae.hi={};Ae.rZj={};Ae.Tee=1;Object(h.a)(Ae,"GetFileApiProxy",null,[1155]);class Ue{constructor(L,
ba,Sa){this.oh=0;this.controlId=this.kya=this.CD=this.kwb=this.Zd=this.$n=null;this.parameters=L;this.callback=ba;this.f5h=Sa;new Ae;this.w9a=new Og;this.oTa=new jd}get jAc(){this.w9a||(this.w9a=new Og);return this.w9a}get uba(){return this.oTa}get FUk(){this.CD||(this.CD=nc.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"));return this.CD}get Iqj(){return this.kya||(this.kya=nc.a.instance.Oa("Postmessage.IHostPostmessenger"))}get errorCode(){return this.oh}set errorCode(L){this.oh=
L}get result(){return this.$n}set result(L){this.$n=L}get Rt(){return this.kwb}get Ce(){return this.Zd}set Ce(L){(this.Zd=L)?(this.kwb=this.Zd.Rt,this.oTa=this.Zd.uba):this.oTa=this.kwb=null}go(){this.$n={};try{this.Aq()}catch(L){this.TSj(L)}this.aH()}TSj(L){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;Ia.a.J(18396573,802,10,"Error when executing API: {0}",L.toString())}aH(){this.oh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&Ia.a.J(18985232,802,10,"Error when API method failed. m_errorCode = {0}",
this.oh);this.$n[Ag.c_Error]=this.oh;this.callback(this.$n)}ZWd(){return this.controlId?this.Ce?this.Ce.lZ.lV(this.controlId):null:null}iWi(){if(!this.controlId)return null;let L=null;this.Ce&&(L=this.Ce.lZ.lV(this.controlId));return L?0===L.ay?this.Ce.U1f(L.shape.slideId,L.shape.id):1===L.ay?this.Ce.oBa(L.Um.id):null:null}m1d(L){return L?this.Ce?this.Ce.m1d(L):null:null}}Object(h.a)(Ue,"ApiMethod",null,[]);class mg extends Ue{constructor(){super()}Aq(){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[N.a.U4h][N.a.T4h],
this.parameters);this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Run AddinCommandsRuntimeManager InvocationCompleted."}}Object(h.a)(mg,"AppCommandInvocationCompletedMethod",Ue,[]);class ki extends Ue{constructor(){super()}go(){this.$n={};this.Aq()}Aq(){if(this.Rt)try{const L=this.parameters[OSF.DDA.Marshaling.CreateDocument.Base64].toString();L&&L.length>this.Ce.xHd.kd.pptEditorAppsForOfficeCreateDocumentApiMaxAllowedBase64?(m.ULS.sendTraceTag(587747342,802,15,"Too large base64 stream size:{0}",
L.length),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.aH()):this.Rt.$3a(L,Object(H.a)(this,this.mvi,"createDocumentSuccessCallback"),Object(H.a)(this,this.lvi,"createDocumentFailCallback"))}catch(L){Ia.a.J(35156300,802,10,"Exception thrown at CreateDocumentMethod: "+L.toString()),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.aH()}else this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.aH()}mvi(L){const ba=new y.StandardDialog;ba.vd=4;ba.Tw(CommonUIStrings.l_GeneralAddInMessageDialogTitle,
CommonUIStrings.l_OpenWindowConsentMessage,1,Sa=>{1===Sa&&window.open(L);this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.aH()})}lvi(L){this.oh=L?L:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.aH()}get description(){return"Create a new ppt document in the user's default folder."}}Object(h.a)(ki,"CreateDocumentMethod",Ue,[]);var di=d(95),lk=d(88);class Rf{static HFk(L){const ba=new Map;ba.set("ApiId",L.toString());di.Health.instance.recordKpiUsage(Rf.cgh,1,Rf.Zfh,ba)}static GFk(L,
ba,Sa){const sb=new Map;sb.set("ApiId",L.toString());L=Object.assign(new lk.a,{extendedProperties:sb,durationMs:Rf.o8f(ba,Sa)});di.Health.instance.recordKpiSuccess(Rf.cgh,L)}static l$g(L){const ba=new Map;ba.set("fWacPartition",L.toString());di.Health.instance.recordKpiUsage(Rf.dgh,1,Rf.Zfh,ba)}static nCe(L,ba){L=Object.assign(new lk.a,{durationMs:Rf.o8f(L,ba)});di.Health.instance.recordKpiSuccess(Rf.dgh,L)}static o8f(L,ba){let Sa=null;L&&ba&&(Sa=ba-L);return Sa}}Rf.cgh="PptApiCall";Rf.dgh="PptApiRequest";
Rf.Zfh="pptom";Object(h.a)(Rf,"PptWacApiTelemetry",null,[]);class Kd{constructor(){this.ver=0;this.exec=this.sel=null}}Object(h.a)(Kd,"ApiRequest",null,[]);class Ql{constructor(){this.txRn=this.shpLst=this.sldLst=null}}Object(h.a)(Ql,"SelectionData",null,[]);const Uj=(L,ba)=>{var Sa=Object,sb=Sa.assign,Tb=new Kd,Tc=Object,Vb=Tc.assign,Ed=new Ql,ae=L.Rt.rf();const Rd=[];if(ae){Rd.length=ae.length;for(var pe=0;pe<ae.length;pe++)Rd[pe]=ae[pe].Cb.toString()}ae=L.Rt.he();pe=[];if(ae){pe.length=ae.length;
for(let ff=0;ff<ae.length;ff++)pe[ff]=ae[ff].get_shapeId().toString()}L=sb.call(Sa,Tb,{ver:1,exec:ba,sel:Vb.call(Tc,Ed,{sldLst:Rd,shpLst:pe,txRn:L.Rt.J$i()})});return Sys.Serialization.JavaScriptSerializer.serialize(L)},fm=L=>{let ba,Sa;ba=L.addType("Microsoft.Office.PowerPoint.Application","{549654b5-691c-491b-bed1-3eccfa85e525}","{64189aae-7617-40e1-ba92-365392bd2387}",3,0);Sa=ba.addMethod("InsertHyperLink",1001,"Void",0,0,"InsertHyperLink",4);Sa.addParameter("address","String",1,null,0);Sa.addParameter("displayName",
"String",1,null,0);Sa=ba.addMethod("InsertSlideFromContent",1002,"Microsoft.Office.PowerPoint.InsertSlideReturnCode",1,0,"InsertSlideFromContent",4);Sa.addParameter("slideContent","String",1,null,0);ba=L.addType("Microsoft.Office.PowerPoint.Presentation","{a8af8473-88c1-49d7-a986-565cb7100e9e}","",3,0);ba.addProperty("SlideMasters",3,"Microsoft.Office.PowerPoint.SlideMasterCollection",3,!0,null,0);ba.addProperty("Slides",2,"Microsoft.Office.PowerPoint.SlideCollection",3,!0,null,0);ba.addProperty("Tags",
4,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ba.addProperty("Title",1,"String",1,!0,null,0);ba.addMethod("GetSelectedShapes",5,"Microsoft.Office.PowerPoint.ShapeScopedCollection",3,0,"SelectedShapes",0);ba.addMethod("GetSelectedSlides",6,"Microsoft.Office.PowerPoint.SlideScopedCollection",3,0,"SelectedSlides",0);ba.addMethod("GetSelectedTextRange",7,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRange",0);ba.addMethod("GetSelectedTextRangeOrNullObject",9,"Microsoft.Office.PowerPoint.TextRange",
3,0,"SelectedTextRangeOrNullObject",0);Sa=ba.addMethod("InsertSlidesFromBase64",1003,"Void",0,0,"InsertSlidesFromBase64",0);Sa.addParameter("base64File","String",1,null,0);Sa.addParameter("options","Microsoft.Office.PowerPoint.InsertSlideOptions",2,null,0);Sa=ba.addMethod("SetSelectedSlides",8,"Void",0,0,"SetSelectedSlides",0);Sa.addParameter("slideIds","String[]",1,null,0);Sa=ba.addMethod("_RegisterEvent",1001,"Void",0,1,"_RegisterEvent",0);Sa.addParameter("referenceId","String",1,null,0);Sa.addParameter("eventType",
"Int32",1,null,0);Sa=ba.addMethod("_UnregisterEvent",1002,"Void",0,1,"_UnregisterEvent",0);Sa.addParameter("referenceId","String",1,null,0);Sa.addParameter("eventType","Int32",1,null,0);ba=L.addType("Microsoft.Office.PowerPoint.AddSlideOptions","{171a8d61-4952-4d67-b7e1-0197ac277d6a}","{af133e5f-ae0b-4a2b-8316-7b26d0a6b4f6}",2,0);ba.addProperty("LayoutId",1,"String",1,!1,null,0);ba.addProperty("SlideMasterId",2,"String",1,!1,null,0);ba=L.addType("Microsoft.Office.PowerPoint.BulletFormat","{43bd46c0-809f-4417-b22c-84e44ab6e592}",
"",3,0);ba.addProperty("Visible",2,"Boolean",1,!1,null,0);ba.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ba=L.addEnumType("Microsoft.Office.PowerPoint.ConnectorType");ba.addEnumField("Straight",0);ba.addEnumField("Elbow",1);ba.addEnumField("Curve",2);ba=L.addEnumType("Microsoft.Office.PowerPoint.GeometricShapeType");ba.addEnumField("LineInverse",0);ba.addEnumField("Triangle",1);ba.addEnumField("RightTriangle",2);ba.addEnumField("Rectangle",3);ba.addEnumField("Diamond",4);ba.addEnumField("Parallelogram",
5);ba.addEnumField("Trapezoid",6);ba.addEnumField("NonIsoscelesTrapezoid",7);ba.addEnumField("Pentagon",8);ba.addEnumField("Hexagon",9);ba.addEnumField("Heptagon",10);ba.addEnumField("Octagon",11);ba.addEnumField("Decagon",12);ba.addEnumField("Dodecagon",13);ba.addEnumField("Star4",14);ba.addEnumField("Star5",15);ba.addEnumField("Star6",16);ba.addEnumField("Star7",17);ba.addEnumField("Star8",18);ba.addEnumField("Star10",19);ba.addEnumField("Star12",20);ba.addEnumField("Star16",21);ba.addEnumField("Star24",
22);ba.addEnumField("Star32",23);ba.addEnumField("RoundRectangle",24);ba.addEnumField("Round1Rectangle",25);ba.addEnumField("Round2SameRectangle",26);ba.addEnumField("Round2DiagonalRectangle",27);ba.addEnumField("SnipRoundRectangle",28);ba.addEnumField("Snip1Rectangle",29);ba.addEnumField("Snip2SameRectangle",30);ba.addEnumField("Snip2DiagonalRectangle",31);ba.addEnumField("Plaque",32);ba.addEnumField("Ellipse",33);ba.addEnumField("Teardrop",34);ba.addEnumField("HomePlate",35);ba.addEnumField("Chevron",
36);ba.addEnumField("PieWedge",37);ba.addEnumField("Pie",38);ba.addEnumField("BlockArc",39);ba.addEnumField("Donut",40);ba.addEnumField("NoSmoking",41);ba.addEnumField("RightArrow",42);ba.addEnumField("LeftArrow",43);ba.addEnumField("UpArrow",44);ba.addEnumField("DownArrow",45);ba.addEnumField("StripedRightArrow",46);ba.addEnumField("NotchedRightArrow",47);ba.addEnumField("BentUpArrow",48);ba.addEnumField("LeftRightArrow",49);ba.addEnumField("UpDownArrow",50);ba.addEnumField("LeftUpArrow",51);ba.addEnumField("LeftRightUpArrow",
52);ba.addEnumField("QuadArrow",53);ba.addEnumField("LeftArrowCallout",54);ba.addEnumField("RightArrowCallout",55);ba.addEnumField("UpArrowCallout",56);ba.addEnumField("DownArrowCallout",57);ba.addEnumField("LeftRightArrowCallout",58);ba.addEnumField("UpDownArrowCallout",59);ba.addEnumField("QuadArrowCallout",60);ba.addEnumField("BentArrow",61);ba.addEnumField("UturnArrow",62);ba.addEnumField("CircularArrow",63);ba.addEnumField("LeftCircularArrow",64);ba.addEnumField("LeftRightCircularArrow",65);
ba.addEnumField("CurvedRightArrow",66);ba.addEnumField("CurvedLeftArrow",67);ba.addEnumField("CurvedUpArrow",68);ba.addEnumField("CurvedDownArrow",69);ba.addEnumField("SwooshArrow",70);ba.addEnumField("Cube",71);ba.addEnumField("Can",72);ba.addEnumField("LightningBolt",73);ba.addEnumField("Heart",74);ba.addEnumField("Sun",75);ba.addEnumField("Moon",76);ba.addEnumField("SmileyFace",77);ba.addEnumField("IrregularSeal1",78);ba.addEnumField("IrregularSeal2",79);ba.addEnumField("FoldedCorner",80);ba.addEnumField("Bevel",
81);ba.addEnumField("Frame",82);ba.addEnumField("HalfFrame",83);ba.addEnumField("Corner",84);ba.addEnumField("DiagonalStripe",85);ba.addEnumField("Chord",86);ba.addEnumField("Arc",87);ba.addEnumField("LeftBracket",88);ba.addEnumField("RightBracket",89);ba.addEnumField("LeftBrace",90);ba.addEnumField("RightBrace",91);ba.addEnumField("BracketPair",92);ba.addEnumField("BracePair",93);ba.addEnumField("Callout1",94);ba.addEnumField("Callout2",95);ba.addEnumField("Callout3",96);ba.addEnumField("AccentCallout1",
97);ba.addEnumField("AccentCallout2",98);ba.addEnumField("AccentCallout3",99);ba.addEnumField("BorderCallout1",100);ba.addEnumField("BorderCallout2",101);ba.addEnumField("BorderCallout3",102);ba.addEnumField("AccentBorderCallout1",103);ba.addEnumField("AccentBorderCallout2",104);ba.addEnumField("AccentBorderCallout3",105);ba.addEnumField("WedgeRectCallout",106);ba.addEnumField("WedgeRRectCallout",107);ba.addEnumField("WedgeEllipseCallout",108);ba.addEnumField("CloudCallout",109);ba.addEnumField("Cloud",
110);ba.addEnumField("Ribbon",111);ba.addEnumField("Ribbon2",112);ba.addEnumField("EllipseRibbon",113);ba.addEnumField("EllipseRibbon2",114);ba.addEnumField("LeftRightRibbon",115);ba.addEnumField("VerticalScroll",116);ba.addEnumField("HorizontalScroll",117);ba.addEnumField("Wave",118);ba.addEnumField("DoubleWave",119);ba.addEnumField("Plus",120);ba.addEnumField("FlowChartProcess",121);ba.addEnumField("FlowChartDecision",122);ba.addEnumField("FlowChartInputOutput",123);ba.addEnumField("FlowChartPredefinedProcess",
124);ba.addEnumField("FlowChartInternalStorage",125);ba.addEnumField("FlowChartDocument",126);ba.addEnumField("FlowChartMultidocument",127);ba.addEnumField("FlowChartTerminator",128);ba.addEnumField("FlowChartPreparation",129);ba.addEnumField("FlowChartManualInput",130);ba.addEnumField("FlowChartManualOperation",131);ba.addEnumField("FlowChartConnector",132);ba.addEnumField("FlowChartPunchedCard",133);ba.addEnumField("FlowChartPunchedTape",134);ba.addEnumField("FlowChartSummingJunction",135);ba.addEnumField("FlowChartOr",
136);ba.addEnumField("FlowChartCollate",137);ba.addEnumField("FlowChartSort",138);ba.addEnumField("FlowChartExtract",139);ba.addEnumField("FlowChartMerge",140);ba.addEnumField("FlowChartOfflineStorage",141);ba.addEnumField("FlowChartOnlineStorage",142);ba.addEnumField("FlowChartMagneticTape",143);ba.addEnumField("FlowChartMagneticDisk",144);ba.addEnumField("FlowChartMagneticDrum",145);ba.addEnumField("FlowChartDisplay",146);ba.addEnumField("FlowChartDelay",147);ba.addEnumField("FlowChartAlternateProcess",
148);ba.addEnumField("FlowChartOffpageConnector",149);ba.addEnumField("ActionButtonBlank",150);ba.addEnumField("ActionButtonHome",151);ba.addEnumField("ActionButtonHelp",152);ba.addEnumField("ActionButtonInformation",153);ba.addEnumField("ActionButtonForwardNext",154);ba.addEnumField("ActionButtonBackPrevious",155);ba.addEnumField("ActionButtonEnd",156);ba.addEnumField("ActionButtonBeginning",157);ba.addEnumField("ActionButtonReturn",158);ba.addEnumField("ActionButtonDocument",159);ba.addEnumField("ActionButtonSound",
160);ba.addEnumField("ActionButtonMovie",161);ba.addEnumField("Gear6",162);ba.addEnumField("Gear9",163);ba.addEnumField("Funnel",164);ba.addEnumField("MathPlus",165);ba.addEnumField("MathMinus",166);ba.addEnumField("MathMultiply",167);ba.addEnumField("MathDivide",168);ba.addEnumField("MathEqual",169);ba.addEnumField("MathNotEqual",170);ba.addEnumField("CornerTabs",171);ba.addEnumField("SquareTabs",172);ba.addEnumField("PlaqueTabs",173);ba.addEnumField("ChartX",174);ba.addEnumField("ChartStar",175);
ba.addEnumField("ChartPlus",176);ba=L.addEnumType("Microsoft.Office.PowerPoint.InsertSlideFormatting");ba.addEnumField("KeepSourceFormatting",0);ba.addEnumField("UseDestinationTheme",1);ba=L.addType("Microsoft.Office.PowerPoint.InsertSlideOptions","{9ca3e504-5701-467b-9596-15521056bac3}","{806c3519-08f4-41ba-b0d9-3c323c51c3e9}",2,0);ba.addProperty("Formatting",1,"Microsoft.Office.PowerPoint.InsertSlideFormatting",1,!1,null,0);ba.addProperty("SourceSlideIds",4,"String[]",1,!1,null,0);ba.addProperty("TargetSlideId",
5,"String",1,!1,null,0);ba=L.addEnumType("Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment");ba.addEnumField("Left",0);ba.addEnumField("Center",1);ba.addEnumField("Right",2);ba.addEnumField("Justify",3);ba.addEnumField("JustifyLow",4);ba.addEnumField("Distributed",5);ba.addEnumField("ThaiDistributed",6);ba=L.addType("Microsoft.Office.PowerPoint.ParagraphFormat","{c164d05d-7a4f-409f-8a5e-ef5f1d2ffa54}","",3,0);ba.addProperty("BulletFormat",1,"Microsoft.Office.PowerPoint.BulletFormat",3,!0,
null,0);ba.addProperty("HorizontalAlignment",2,"Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment",1,!1,null,0);ba.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ba=L.addType("Microsoft.Office.PowerPoint.ShapeAddOptions","{b75ad347-9abe-4531-a338-3ba7a70bf9e1}","{2b45cbde-9fbf-4aa2-9972-5508e4c99ad8}",2,0);ba.addProperty("Height",1,"Double",1,!1,null,0);ba.addProperty("Left",2,"Double",1,!1,null,0);ba.addProperty("Top",3,"Double",1,!1,null,0);ba.addProperty("Width",4,"Double",1,!1,null,
0);ba=L.addType("Microsoft.Office.PowerPoint.ShapeCollection","{27a07ec1-bcc6-45bf-9c60-07250facfbca}","",3,0);Sa=ba.addMethod("AddGeometricShape",6,"Microsoft.Office.PowerPoint.Shape",3,0,"AddGeometricShape",0);Sa.addParameter("geometricShapeType","Microsoft.Office.PowerPoint.GeometricShapeType",1,null,0);Sa.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Sa=ba.addMethod("AddLine",7,"Microsoft.Office.PowerPoint.Shape",3,0,"AddLine",0);Sa.addParameter("connectorType",
"Microsoft.Office.PowerPoint.ConnectorType",1,null,0);Sa.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Sa=ba.addMethod("AddTextBox",8,"Microsoft.Office.PowerPoint.Shape",3,0,"AddTextBox",0);Sa.addParameter("text","String",1,null,0);Sa.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);ba.addMethod("GetCount",1,"Int32",1,1,"Count",0);Sa=ba.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Sa.addParameter("key","String",1,null,0);
Sa=ba.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Sa.addParameter("index","Int32",1,null,0);Sa=ba.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Sa.addParameter("id","String",1,null,0);ba.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ba.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);ba=L.addType("Microsoft.Office.PowerPoint.SlideLayout","{4494143a-d362-45fd-89c6-506e97741384}","",3,0);ba.addProperty("Id",
1,"String",1,!0,null,0);ba.addProperty("Name",3,"String",1,!0,null,0);ba.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ba.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ba=L.addType("Microsoft.Office.PowerPoint.SlideLayoutCollection","{8f09fea3-67af-49f9-b42a-0a8f8cd02615}","",3,0);ba.addMethod("GetCount",1,"Int32",1,1,"Count",0);Sa=ba.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideLayout",3,0);Sa.addParameter("key","String",1,null,0);Sa=ba.addMethod("GetItemAt",
3,"Microsoft.Office.PowerPoint.SlideLayout",3,1,"ItemAt",0);Sa.addParameter("index","Int32",1,null,0);Sa=ba.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ItemOrNullObject",0);Sa.addParameter("id","String",1,null,0);ba.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ba.setCollectionInfo("Microsoft.Office.PowerPoint.SlideLayout",!0);ba=L.addType("Microsoft.Office.PowerPoint.SlideMaster","{4a835b29-4422-4659-ab73-2e1e0096e7c1}","",3,0);ba.addProperty("Id",1,"String",
1,!0,null,0);ba.addProperty("Layouts",3,"Microsoft.Office.PowerPoint.SlideLayoutCollection",3,!0,null,0);ba.addProperty("Name",4,"String",1,!0,null,0);ba.addProperty("Shapes",5,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ba.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ba=L.addType("Microsoft.Office.PowerPoint.Tag","{f26bc228-f6da-40de-b9ef-2a57ad2b5162}","",3,0);ba.addProperty("Key",2,"String",1,!0,null,0);ba.addProperty("Value",3,"String",1,!1,null,0);ba.addMethod("_OnAccess",
1,"Void",0,1,"_OnAccess",0);ba=L.addType("Microsoft.Office.PowerPoint.TagCollection","{edf01799-a99c-4e57-94f2-5830600f5da4}","",3,0);Sa=ba.addMethod("Add",1,"Void",0,0,"Add",0);Sa.addParameter("key","String",1,null,0);Sa.addParameter("value","String",1,null,0);Sa=ba.addMethod("Delete",2,"Void",0,0,"Delete",0);Sa.addParameter("key","String",1,null,0);ba.addMethod("GetCount",3,"Int32",1,1,"Count",0);Sa=ba.addIndexerMethod(4,"Microsoft.Office.PowerPoint.Tag",3,0);Sa.addParameter("key","String",1,null,
0);Sa=ba.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Tag",3,1,"ItemAt",0);Sa.addParameter("index","Int32",1,null,0);Sa=ba.addMethod("GetItemOrNullObject",6,"Microsoft.Office.PowerPoint.Tag",3,0,"ItemOrNullObject",0);Sa.addParameter("key","String",1,null,0);ba.addMethod("_OnAccess",7,"Void",0,1,"_OnAccess",0);ba.setCollectionInfo("Microsoft.Office.PowerPoint.Tag",!0);ba=L.addType("Microsoft.Office.PowerPoint.Slide","{61c859a3-9c46-44a7-a415-aeb6f43a1dc7}","",3,0);ba.addProperty("Id",1,"String",
1,!0,null,0);ba.addProperty("Layout",5,"Microsoft.Office.PowerPoint.SlideLayout",3,!0,null,0);ba.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ba.addProperty("SlideMaster",6,"Microsoft.Office.PowerPoint.SlideMaster",3,!0,null,0);ba.addProperty("Tags",7,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ba.addMethod("Delete",3,"Void",0,0,"Delete",0);Sa=ba.addMethod("SetSelectedShapes",8,"Void",0,0,"SetSelectedShapes",0);Sa.addParameter("shapeIds","String[]",
1,null,0);ba.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ba=L.addEnumType("Microsoft.Office.PowerPoint.ShapeFillType");ba.addEnumField("NoFill",0);ba.addEnumField("Solid",1);ba.addEnumField("Gradient",2);ba.addEnumField("Pattern",3);ba.addEnumField("PictureAndTexture",4);ba.addEnumField("SlideBackground",5);ba=L.addType("Microsoft.Office.PowerPoint.ShapeFill","{2df31ab1-fa27-4e46-9704-1fb3f49bed4b}","",3,0);ba.addProperty("ForegroundColor",2,"String",1,!1,null,0);ba.addProperty("Transparency",
5,"Double",1,!1,null,0);ba.addProperty("Type",6,"Microsoft.Office.PowerPoint.ShapeFillType",1,!0,null,0);ba.addMethod("Clear",1,"Void",0,0,"Clear",0);Sa=ba.addMethod("SetSolidColor",4,"Void",0,0,"SetSolidColor",0);Sa.addParameter("color","String",1,null,0);ba.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ba=L.addEnumType("Microsoft.Office.PowerPoint.ShapeLineStyle");ba.addEnumField("Single",0);ba.addEnumField("ThickBetweenThin",1);ba.addEnumField("ThickThin",2);ba.addEnumField("ThinThick",3);
ba.addEnumField("ThinThin",4);ba=L.addEnumType("Microsoft.Office.PowerPoint.ShapeLineDashStyle");ba.addEnumField("Dash",0);ba.addEnumField("DashDot",1);ba.addEnumField("DashDotDot",2);ba.addEnumField("LongDash",3);ba.addEnumField("LongDashDot",4);ba.addEnumField("RoundDot",5);ba.addEnumField("Solid",6);ba.addEnumField("SquareDot",7);ba.addEnumField("LongDashDotDot",8);ba.addEnumField("SystemDash",9);ba.addEnumField("SystemDot",10);ba.addEnumField("SystemDashDot",11);ba=L.addType("Microsoft.Office.PowerPoint.ShapeLineFormat",
"{f275eab8-4363-41e8-b11a-e41e3c725f21}","",3,0);ba.addProperty("Color",1,"String",1,!1,null,0);ba.addProperty("DashStyle",2,"Microsoft.Office.PowerPoint.ShapeLineDashStyle",1,!1,null,0);ba.addProperty("Style",4,"Microsoft.Office.PowerPoint.ShapeLineStyle",1,!1,null,0);ba.addProperty("Transparency",5,"Double",1,!1,null,0);ba.addProperty("Visible",6,"Boolean",1,!1,null,0);ba.addProperty("Weight",7,"Double",1,!1,null,0);ba.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ba=L.addEnumType("Microsoft.Office.PowerPoint.ShapeType");
ba.addEnumField("Unsupported",0);ba.addEnumField("Image",1);ba.addEnumField("GeometricShape",2);ba.addEnumField("Group",3);ba.addEnumField("Line",4);ba=L.addEnumType("Microsoft.Office.PowerPoint.ShapeAutoSize");ba.addEnumField("AutoSizeNone",0);ba.addEnumField("AutoSizeTextToFitShape",1);ba.addEnumField("AutoSizeShapeToFitText",2);ba.addEnumField("AutoSizeMixed",3);ba=L.addEnumType("Microsoft.Office.PowerPoint.TextVerticalAlignment");ba.addEnumField("Top",0);ba.addEnumField("Middle",1);ba.addEnumField("Bottom",
2);ba.addEnumField("TopCentered",3);ba.addEnumField("MiddleCentered",4);ba.addEnumField("BottomCentered",5);ba=L.addEnumType("Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle");ba.addEnumField("None",0);ba.addEnumField("Single",1);ba.addEnumField("Double",2);ba.addEnumField("Heavy",3);ba.addEnumField("Dotted",4);ba.addEnumField("DottedHeavy",5);ba.addEnumField("Dash",6);ba.addEnumField("DashHeavy",7);ba.addEnumField("DashLong",8);ba.addEnumField("DashLongHeavy",9);ba.addEnumField("DotDash",10);
ba.addEnumField("DotDashHeavy",11);ba.addEnumField("DotDotDash",12);ba.addEnumField("DotDotDashHeavy",13);ba.addEnumField("Wavy",14);ba.addEnumField("WavyHeavy",15);ba.addEnumField("WavyDouble",16);ba=L.addType("Microsoft.Office.PowerPoint.ShapeFont","{06c9e9fa-f317-4016-b9f4-aea94e9690f4}","",3,0);ba.addProperty("Bold",1,"Boolean",1,!1,null,0);ba.addProperty("Color",2,"String",1,!1,null,0);ba.addProperty("Italic",3,"Boolean",1,!1,null,0);ba.addProperty("Name",5,"String",1,!1,null,0);ba.addProperty("Size",
6,"Double",1,!1,null,0);ba.addProperty("Underline",7,"Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle",1,!1,null,0);ba.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ba=L.addType("Microsoft.Office.PowerPoint.TextRange","{1eb59e56-2d48-4b16-b3bb-4fe7debe51c2}","",3,0);ba.addProperty("Font",1,"Microsoft.Office.PowerPoint.ShapeFont",3,!0,null,0);ba.addProperty("Length",7,"Int32",1,!1,null,0);ba.addProperty("ParagraphFormat",4,"Microsoft.Office.PowerPoint.ParagraphFormat",3,!0,null,0);ba.addProperty("Start",
9,"Int32",1,!1,null,0);ba.addProperty("Text",5,"String",1,!1,null,0);ba.addMethod("GetParentTextFrame",10,"Microsoft.Office.PowerPoint.TextFrame",3,0,"ParentTextFrame",0);Sa=ba.addMethod("GetSubstring",2,"Microsoft.Office.PowerPoint.TextRange",3,0,"Substring",0);Sa.addParameter("start","Int32",1,null,0);Sa.addParameter("length","Int32",1,null,0);ba.addMethod("SetSelected",8,"Void",0,0,"SetSelected",0);ba.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ba=L.addType("Microsoft.Office.PowerPoint.TextFrame",
"{b5929948-a2b9-4816-8e79-fe9deef82e48}","",3,0);ba.addProperty("AutoSizeSetting",1,"Microsoft.Office.PowerPoint.ShapeAutoSize",1,!1,null,0);ba.addProperty("BottomMargin",2,"Double",1,!1,null,0);ba.addProperty("HasText",4,"Boolean",1,!0,null,0);ba.addProperty("LeftMargin",6,"Double",1,!1,null,0);ba.addProperty("RightMargin",7,"Double",1,!1,null,0);ba.addProperty("TextRange",8,"Microsoft.Office.PowerPoint.TextRange",3,!0,null,0);ba.addProperty("TopMargin",9,"Double",1,!1,null,0);ba.addProperty("VerticalAlignment",
10,"Microsoft.Office.PowerPoint.TextVerticalAlignment",1,!1,null,0);ba.addProperty("WordWrap",11,"Boolean",1,!1,null,0);ba.addMethod("DeleteText",3,"Void",0,0,"DeleteText",0);ba.addMethod("GetParentShape",13,"Microsoft.Office.PowerPoint.Shape",3,0,"ParentShape",0);ba.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ba=L.addType("Microsoft.Office.PowerPoint.Shape","{62ed0f8f-a9ce-46bd-8ad2-61634aee155d}","",3,0);ba.addProperty("Fill",11,"Microsoft.Office.PowerPoint.ShapeFill",3,!0,null,0);ba.addProperty("Height",
5,"Double",1,!1,null,0);ba.addProperty("Id",1,"String",1,!0,null,0);ba.addProperty("Left",6,"Double",1,!1,null,0);ba.addProperty("LineFormat",12,"Microsoft.Office.PowerPoint.ShapeLineFormat",3,!0,null,0);ba.addProperty("Name",7,"String",1,!1,null,0);ba.addProperty("Tags",3,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ba.addProperty("TextFrame",13,"Microsoft.Office.PowerPoint.TextFrame",3,!0,null,0);ba.addProperty("Top",8,"Double",1,!1,null,0);ba.addProperty("Type",9,"Microsoft.Office.PowerPoint.ShapeType",
1,!0,null,0);ba.addProperty("Width",10,"Double",1,!1,null,0);ba.addMethod("Delete",4,"Void",0,0,"Delete",0);ba.addMethod("GetParentSlide",15,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlide",0);ba.addMethod("GetParentSlideLayout",16,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayout",0);ba.addMethod("GetParentSlideLayoutOrNullObject",18,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayoutOrNullObject",0);ba.addMethod("GetParentSlideMaster",17,"Microsoft.Office.PowerPoint.SlideMaster",
3,0,"ParentSlideMaster",0);ba.addMethod("GetParentSlideMasterOrNullObject",19,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMasterOrNullObject",0);ba.addMethod("GetParentSlideOrNullObject",20,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlideOrNullObject",0);ba.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ba=L.addType("Microsoft.Office.PowerPoint.ShapeScopedCollection","{607dbfd7-bd79-4651-b5ff-3a66bc46be74}","",3,0);ba.addMethod("GetCount",1,"Int32",1,1,"Count",0);Sa=ba.addIndexerMethod(2,
"Microsoft.Office.PowerPoint.Shape",3,0);Sa.addParameter("key","String",1,null,0);Sa=ba.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Sa.addParameter("index","Int32",1,null,0);Sa=ba.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Sa.addParameter("id","String",1,null,0);ba.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ba.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);ba=L.addType("Microsoft.Office.PowerPoint.SlideCollection",
"{450b9577-a7dd-4d69-8dc9-afa8fba58465}","",3,0);Sa=ba.addMethod("Add",6,"Void",0,0,"Add",0);Sa.addParameter("options","Microsoft.Office.PowerPoint.AddSlideOptions",2,null,0);ba.addMethod("GetCount",1,"Int32",1,1,"Count",0);Sa=ba.addIndexerMethod(5,"Microsoft.Office.PowerPoint.Slide",3,0);Sa.addParameter("key","String",1,null,0);Sa=ba.addMethod("GetItemAt",2,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Sa.addParameter("index","Int32",1,null,0);Sa=ba.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Slide",
3,0,"ItemOrNullObject",0);Sa.addParameter("id","String",1,null,0);ba.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ba.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);ba=L.addType("Microsoft.Office.PowerPoint.SlideScopedCollection","{574045cb-b56d-4fca-89e5-b567250b9ce5}","",3,0);ba.addMethod("GetCount",1,"Int32",1,1,"Count",0);Sa=ba.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Slide",3,0);Sa.addParameter("key","String",1,null,0);Sa=ba.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Slide",
3,1,"ItemAt",0);Sa.addParameter("index","Int32",1,null,0);Sa=ba.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Sa.addParameter("id","String",1,null,0);ba.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ba.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);ba=L.addType("Microsoft.Office.PowerPoint.SlideMasterCollection","{d5e75669-5fac-49ec-aaad-e1f6181f6fbd}","",3,0);ba.addMethod("GetCount",1,"Int32",1,1,"Count",0);Sa=ba.addIndexerMethod(2,
"Microsoft.Office.PowerPoint.SlideMaster",3,0);Sa.addParameter("key","String",1,null,0);Sa=ba.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideMaster",3,1,"ItemAt",0);Sa.addParameter("index","Int32",1,null,0);Sa=ba.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ItemOrNullObject",0);Sa.addParameter("id","String",1,null,0);ba.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ba.setCollectionInfo("Microsoft.Office.PowerPoint.SlideMaster",!0);ba=L.addType("Microsoft.AppRuntime.AppRuntimeService",
"{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ba.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Sa=ba.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Sa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ba=L.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ba.addEnumField("Inactive",0);ba.addEnumField("Background",1);ba.addEnumField("Visible",2);ba=L.addEnumType("Microsoft.AppRuntime.Visibility");
ba.addEnumField("Hidden",1);ba.addEnumField("Visible",2);ba=L.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}","{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);ba.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeStartState",0);Sa=ba.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0);Sa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ba=L.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");
ba.addEnumField("Unknown",0);ba.addEnumField("Basic",1);ba.addEnumField("Premium",2);ba=L.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Sa=ba.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Sa.addParameter("feature","String",1,null,0);Sa.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Sa=ba.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",
3,1,"LicenseFeature",0);Sa.addParameter("feature","String",1,null,0);Sa=ba.addMethod("GetMsaDeviceTicket",7,"String",1,1,"MsaDeviceTicket",4);Sa.addParameter("resource","String",1,null,0);Sa.addParameter("policy","String",1,null,0);Sa.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);Sa=ba.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Sa.addParameter("feature","String",1,null,0);Sa.addParameter("fallbackValue","Boolean",1,null,0);ba.addMethod("IsFreemiumUpsellEnabled",
3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Sa=ba.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Sa.addParameter("experienceId","String",1,null,0);Sa=ba.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Sa.addParameter("feature","String",1,null,0);ba=L.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);ba.addProperty("Id",5,"String",1,!0,null,0);ba.addMethod("_RegisterStateChange",6,"Void",
0,1,"_RegisterStateChange",0);ba.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ba=L.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",3,0);ba.addProperty("Scopes",1,"String",1,!1,null,0);ba=L.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ba.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",
3,!0,null,0);Sa=ba.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Sa.addParameter("jsonCreate","String",1,null,0);Sa=ba.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Sa.addParameter("jsonUpdate","String",1,null,0);Sa=ba.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Sa.addParameter("id","String",1,null,0);Sa=ba.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Sa.addParameter("id","String",1,null,
0);ba.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ba=L.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);ba.addProperty("Id",2,"String",1,!0,null,0);Sa=ba.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Sa.addParameter("visibility","Boolean",1,null,0);ba.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ba=L.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);ba.addProperty("Enabled",3,"Boolean",
1,!1,null,0);ba.addProperty("Id",2,"String",1,!0,null,0);ba.addProperty("Label",4,"String",1,!0,null,0);Sa=ba.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Sa.addParameter("enabled","Boolean",1,null,0);ba.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ba=L.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ba.addMethod("GetCount",3,"Int32",1,1,"Count",0);Sa=ba.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Sa.addParameter("key",
"String",1,null,0);ba.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ba.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0)};var Ij=d(40);class Nm{constructor(L,ba){this.J$b=L;this.p$b=ba}fRf(L){return[200,null,L]}QLi(L,ba,Sa,sb,Tb,Tc){const Vb=Ij.a.KX(),Ed=this.J$b.create(ba,Sa,sb);sb.Czf=Ed;const ae=this.p$b.create(Tc);ae.context.appId=ba;ae.context.controlId=Sa;const Rd=()=>{Rf.l$g(!0);Ed.cze=!1;OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Ed,fm,ae,L).then(ff=>{if(!ff)return m.ULS.sendTraceTag(587745500,
802,10,"ExecuteRichApiRequest failed."),Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),null;Rf.nCe(Vb,Ij.a.KX());Tb(ff,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},ff=>{m.ULS.sendTraceTag(587745499,802,10,"A PPT Rich API batch execution was failed, AppId: {0}  Reason: {1}",ba,ff);Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})},pe=()=>{Rf.l$g(!1);let ff=L[4];Qe.a("ExtensibilityUseSerializedPayloads")&&(ff=Uj(sb,ff));OfficeExtension.WacRuntime.Utility.createPromise(eg=>
{const kh={};kh.promiseToResolve=eg;kh.requestBody=ff;A.AFrameworkApplication.Va.Ma(Hh.a.ETd,2,kh)}).then(eg=>{Qe.a("ExtensibilityResetResponse")&&A.AFrameworkApplication.Va.Ma(Hh.a.ETd,2,{promiseToResolve:null,requestBody:""});if(Qe.a("ExtensibilityUseSerializedPayloads")){a:if((eg=Sys.Serialization.JavaScriptSerializer.deserialize(eg.toString()))&&eg.sel&&eg.sel.sldLst){var kh=Tc.presentation,Wa=eg.sel.sldLst,qb=[];if(Wa)for(dg of Wa)({slideId:Wa}=li.a.OQe(dg)).returnValue&&(Wa=Object(C.a)(132,
kh.LB(Wa)))&&qb.push(Wa);var dg=qb;if(dg.length&&!sb.Rt.hol(dg))eg=null;else{dg=1===dg.length?dg[0]:null;kh=null;if(dg&&eg.sel.shpLst){qb=eg.sel.shpLst;kh=[];if(qb)for(zb of qb)(qb=dg.jS(parseInt(zb)))&&kh.push(qb);var zb=kh;if(zb.length&&!sb.Rt.gol(zb)){eg=null;break a}kh=1===zb.length?zb[0]:null}eg=kh&&eg.sel.txRn&&(eg.sel.txRn.length&&2!==eg.sel.txRn.length||2===eg.sel.txRn.length&&0<=eg.sel.txRn[0]&&!sb.Rt.iol(kh,eg.sel.txRn[0],eg.sel.txRn[1]))?null:eg.rst}}else eg=null;eg?(Rf.nCe(Vb,Ij.a.KX()),
Tb(this.fRf(eg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else Rf.nCe(Vb,Ij.a.KX()),Tb(this.fRf(eg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})};L?(Ed.cze=!0,OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Ed,fm,ae,L).then(ff=>{ff&&Ed.HEg?Rd():pe();return null},()=>{pe();return null})):Rd()}}Object(h.a)(Nm,"RichApiRequest",
null,[]);class jf extends Ue{constructor(L,ba,Sa){super();this.J$b=L;this.p$b=ba;this.ua=Sa}go(){this.$n={};this.Aq()}Aq(){const L=this.parameters.ArrayData;if(L){var ba=null,Sa=this.ZWd();Qe.a("SetOwnerAddinAssetIdForSharedRuntimeAPIsInPptWac")?Sa&&Sa.taskpane&&(ba=Sa.taskpane.ownerAddinSolutionId):Sa&&(ba=Sa.Um.id);try{(new Nm(this.J$b,this.p$b)).QLi(L,ba,this.controlId,this.Ce,Object(H.a)(this,this.RLi,"executeRichApiRequestCallback"),this.ua)}catch(sb){Ia.a.J(36804577,802,10,"Exception thrown at ExecuteRichApiRequestMethod: "+
sb.toString()),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.aH()}}else this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.aH()}RLi(L,ba){this.errorCode=ba;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.$n.Data=L);this.aH()}get description(){return"Run ExecuteRichApi Invocation Completed."}}Object(h.a)(jf,"ExecuteRichApiRequestMethod",Ue,[]);class Hf extends Ue{constructor(){super()}go(){this.$n={};this.Aq()}Aq(){const L=this.kwb.bAj();m.ULS.sendTraceTag(587747344,
802,50,"GetAccessToken was called!");const ba=(Sa,sb)=>{Sa===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(sb=sb.accessToken,this.$n[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=sb):(sb=this.Ce.lZ.lV(this.controlId),m.ULS.sendTraceTag(587747343,802,10,"{0}",{["errorCode"]:Sa.toString(),["appId"]:sb.Um.id,["storeType"]:sb.Um.storeType}));this.oh=Sa;this.aH()};this.Iqj.execute(Sa=>{const sb=this.Ce.Ko,Tb=Xg.getInstance();dd.AppsForOfficeSingleSignOnManager.getInstance(sb,Sa,
Tb).getAccessToken(this.controlId,L,this.parameters,ba)})}get description(){return"Postmessage to wac host layer to get an access token for Addin."}}Object(h.a)(Hf,"GetAccessTokenMethod",Ue,[]);class rj extends Ue{constructor(){super()}Aq(){let L=null;this.Rt&&(L=Microsoft.Office.WebExtension.ActiveView.Edit);L?(this.result[Microsoft.Office.WebExtension.Parameters.Data]=L,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Returns the ActiveView value for current mode."}}
Object(h.a)(rj,"GetActiveViewMethod",Ue,[]);var Om=d(1093);class gm extends Ue{constructor(){super()}go(){this.$n={};this.Aq()}Aq(){var L=this.Zd.Ko.getOsfControl(this.controlId);if(!A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!1)||L.isFirstParty()){L=L.getManifest();var ba=L.getMarketplaceID(),Sa=L.getWebApplicationId(),sb=L.getWebApplicationMsaId();nc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(ba).then(Tb=>{this.errorCode=
0;const Tc={};Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Tb.upn;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Tb.userId;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Sa;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=sb?sb:Sa;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Tb.authority;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Om.a.sWi(Tb.authorityType);Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
Tb.isAnonymous;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Tb.tenantId;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Tb.supportsAuthToken;this.$n[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Tc;this.aH()},Tb=>{this.oh=1;this.$n[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Tb;this.aH()})}}get description(){return"Return authentication context needed by WebAuth stack."}}Object(h.a)(gm,"GetAuthContextMethod",Ue,[]);class sj extends Ue{constructor(){super()}go(){this.$n=
{};this.Aq();this.oh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.aH()}Aq(){var L=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const ba=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];L=this.uba.n6f(L);!L||ba*L.lqh>=L.fileSize?this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange:(Sc.Pvi(this.Ce.presentationId,this.controlId,L.BUd,ba,L.lqh,Object(H.a)(this,this.IWb,"customizedOnFinished"),Object(H.a)(this,this.HWb,"customizedOnError")).start(),
this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}IWb(L,ba){L?0===ba.errorCode?(L=ba.value,this.$n[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=L,this.$n[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=L.length,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.aH()}HWb(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
this.aH()}get description(){return"Returns the specified slice."}}Object(h.a)(sj,"GetDocumentCopyChunkMethod",Ue,[]);class Rl extends Ue{constructor(){super();this.eda=this.Uja=0}go(){this.$n={};this.Aq();this.oh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.aH()}Aq(){try{const L=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()];this.eda=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()];if(1>this.eda||4194304<this.eda)Ia.a.J(17310339,802,
50,"GetDocumentCopyMethod: Invalid slice size: "+this.eda),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;else{switch(L){case 1:this.Uja=4;break;case 2:this.Uja=3;break;default:Ia.a.J(17310341,802,50,"GetDocumentCopyMethod: Unsupported file type: "+L);this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported;return}this.uba.Erg(this.controlId,this.Uja)?this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:this.uba.mBa.count>=this.Ce.xHd.kd.pptEditorAppForOfficeMaxDocumentReaders?
this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:(this.FUk.d2(!1,!0,()=>{this.QUk()},Object(H.a)(this,this.Yva,"saveFailureCallback")),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}catch(L){Ia.a.J(17310343,802,10,"Exception thrown at GetDocumentCopyMethod: "+L.toString()),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}QUk(){Sc.Qvi(this.Ce.presentationId,this.controlId,this.Uja,this.eda,Object(H.a)(this,this.IWb,"customizedOnFinished"),Object(H.a)(this,
this.HWb,"customizedOnError")).start()}Yva(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.aH();return!1}IWb(L,ba){if(L&&L.length){L=ba.format;var Sa=ba.sliceSize,sb=ba.errorCode;0===sb?(ba=ba.fileSize,this.$n[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=ba,ba=this.uba.Rfi(this.controlId,ba,Sa,L),this.$n[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=ba,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=174===sb?OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:
175===sb?OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.aH()}HWb(L,ba){this.oh=ba?OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.aH()}get description(){return"Returns the entire document file in slices."}}Object(h.a)(Rl,"GetDocumentCopyMethod",Ue,[]);class Dl extends Ue{constructor(){super()}Aq(){this.oh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;try{const L=this.iWi(),ba=this.Rt.Z_i(L);ba&&(this.$n[""+OSF.DDA.Marshaling.ThemingKeys.DocumentTheme]=ba,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(L){Ia.a.J(17687510,802,10,"Exception thrown at GetDocumentThemeMethod: "+L)}}get description(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."}}Object(h.a)(Dl,"GetDocumentThemeMethod",Ue,[]);class Pm extends Ue{constructor(){super()}Aq(){this.oh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;let L=null;if(this.Rt&&void 0!==(L=this.Rt.Krb())&&null!==(L=this.Rt.Krb())){var ba={};ba[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=L;this.result[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=ba;this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}get description(){return"Returns the file properties. Now it only returns the URL."}}Object(h.a)(Pm,"GetFilePropertiesMethod",Ue,[]);class hl extends Ue{constructor(){super()}Aq(){this.oh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext}get description(){return"(Not implemented) Returns OfficeTheme properties."}}Object(h.a)(hl,"GetOfficeThemeMethod",Ue,[]);class Tk extends Ue{constructor(){super()}Aq(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Rt)try{var L=this.parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString();L===Microsoft.Office.WebExtension.CoercionType.SlideRange?(L=null,this.oh=({JWk:L}=this.Rt.B$i()).returnValue,this.$n[OSF.DDA.WAC.UniqueArguments.Data]=
L):L===Microsoft.Office.WebExtension.CoercionType.Text?(L=null,this.oh=({Pic:L}=this.Rt.F$i()).returnValue,this.$n[OSF.DDA.WAC.UniqueArguments.Data]=L):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}catch(ba){Ia.a.J(8958164,802,10,"Exception thrown at GetSelectedDataMethod: "+ba.toString())}}get description(){return"Get data contained in the current selection of the document."}}Object(h.a)(Tk,"GetSelectedDataMethod",Ue,[]);class de extends Ue{constructor(){super()}Aq(){var L=
this.ZWd();if(L){const ba={};ba.Settings=this.oWd(L.settings);this.$n[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=ba;this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else L="AppForOffice instance could not be found for ID "+this.controlId+jj.Debug.qt(),Ia.a.J(8958160,802,10,L),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Loads/Refreshes Settings object for an app"}oWd(L){const ba={};let Sa=0;for(let sb in L)ba[Sa.toString()]=[sb,L[sb]],Sa++;return ba}}
Object(h.a)(de,"LoadSettingsMethod",Ue,[]);class Nf extends Ue{constructor(){super()}Aq(){m.ULS.sendTraceTag(587747346,802,50,"ExecuteAsync was called!");this.kwb.Cia()?(this.oh=Gi.instance.rqa.mak(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],this.parameters[N.a.HGd],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]),this.oh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&m.ULS.sendTraceTag(587747345,806,10,"ExecuteAsync failed. Error code: {0}",
this.oh.toString())):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run messageParent method."}}Object(h.a)(Nf,"MessageParentMethod",Ue,[]);class vm extends Ue{constructor(){super()}Aq(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Rt)try{const L=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],ba=L[OSF.DDA.Marshaling.NavigationKeys.GoToType],Sa=L[OSF.DDA.Marshaling.NavigationKeys.Id].toString();this.oh=ba===
OSF.DDA.Marshaling.GoToType.Index?this.Rt.ygj(Sa):ba===OSF.DDA.Marshaling.GoToType.Slide?this.Rt.zgj(Sa):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration}catch(L){Ia.a.J(8958162,802,10,"Exception thrown at navigatetomethod: "+L.toString())}}get description(){return"Go to the slide specified by user."}}Object(h.a)(vm,"NavigateToMethod",Ue,[]);class Uk extends Ue{constructor(){super();this.jie=0}go(){this.$n={};this.Aq();this.oh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.aH()}Aq(){this.jie=
this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const L=this.uba.n6f(this.jie);L?(Sc.cSf(this.Ce.presentationId,this.controlId,L.BUd,!1,!1,Object(H.a)(this,this.IWb,"customizedOnFinished"),Object(H.a)(this,this.HWb,"customizedOnError")).start(),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist}IWb(L,ba){L?0===ba.errorCode?(this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.uba.KKk(this.jie)):
this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.aH()}HWb(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.aH()}get description(){return"Closes the document file."}}Object(h.a)(Uk,"ReleaseDocumentCopyMethod",Ue,[]);class El extends Ue{constructor(){super();this.IFa=null}Aq(){var L=this.ZWd();if(L){var ba=this.parameters[OSF.DDA.WAC.UniqueArguments.SettingsRequest];this.IFa=this.oWd(Array.isArray(ba[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?
ba[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null);ba=null;L.taskpane&&(ba=L.taskpane.ownerAddinSolutionId);var Sa;if(L.taskpane&&ba)if(Sa=this.Ce.oBa(ba)){this.Rt.XFe(Sa,this.IFa);if(Sa=this.Ce.lZ.YWd(ba))Sa.settings=this.IFa;L.settings=this.IFa;this.Ce.RSe(ba,this.IFa);this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.jAc.Wgg(ba,this.IFa,this.Zd)?(L.settings=this.IFa,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
else(Sa=0===L.ay?this.Ce.U1f(L.shape.slideId,L.shape.id):this.Ce.oBa(L.Um.id))?(this.Rt.XFe(Sa,this.IFa),L.settings=this.IFa,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else L="AppForOffice instance could not be found for ID "+this.controlId+jj.Debug.qt(),Ia.a.J(9052994,802,10,L),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Saves settings to document."}oWd(L){const ba={};if(L)for(let Sa=
0;Sa<L.length;Sa++){const sb=Array.isArray(L[Sa])?L[Sa]:null;sb&&1<sb.length&&(ba[sb[0]]=sb[1])}return ba}}Object(h.a)(El,"SaveSettingsMethod",Ue,[]);class Jj extends Ue{constructor(){super()}Aq(){this.kwb.Cia()?(Gi.instance.rqa.tXk(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[N.a.HGd],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run sendMessage/messageChild method."}}
Object(h.a)(Jj,"SendMessageMethod",Ue,[]);class Kj extends Ue{constructor(){super()}Aq(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Rt)try{const ba=this.parameters[OSF.DDA.WAC.UniqueArguments.SetData];var L=ba.CoerceType.toString();const Sa=ba[OSF.DDA.WAC.UniqueArguments.Data];if(L===Microsoft.Office.WebExtension.CoercionType.Text)this.oh=this.Rt.x2k(Sa);else{let sb;if(L===Microsoft.Office.WebExtension.CoercionType.Image)sb=0;else if(L===Microsoft.Office.WebExtension.CoercionType.XmlSvg)sb=
1;else{this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;return}L=!1;let Tb=0,Tc=0,Vb=0,Ed=0;({apj:L,x:Tb,y:Tc,width:Vb,height:Ed}=this.IMi(ba,L,Tb,Tc,Vb,Ed));this.oh=this.Rt.s2k(Sa,L,Tb,Tc,Vb,Ed,sb)}}catch(ba){Ia.a.J(17310337,802,10,"Exception thrown at SetSelectedDataMethod: "+ba)}}IMi(L,ba,Sa,sb,Tb,Tc){const Vb=L[OSF.DDA.Marshaling.SetDataKeys.ImageLeft],Ed=L[OSF.DDA.Marshaling.SetDataKeys.ImageTop];void 0!==Vb&&null!==Vb&&"number"===typeof Vb&&void 0!==Ed&&null!==Ed&&"number"===
typeof Ed&&(ba=!0,Sa=Vb,sb=Ed);L[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]&&(Tb=L[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]);L[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]&&(Tc=L[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]);return{apj:ba,x:Sa,y:sb,width:Tb,height:Tc}}get description(){return"Writes data to the current selection in the document."}}Object(h.a)(Kj,"SetSelectedDataMethod",Ue,[]);class Hi extends cb{constructor(L){super(L)}Utk(){this.q9b={};this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,
()=>new de);this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new El);this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,()=>new rj);this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>new vm);this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>new Tk);this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new Pm);this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,()=>new Dl);this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,()=>new hl);this.set(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,
()=>new Kj);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new Rl);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new sj);this.set(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new Uk);this.set(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new mg);this.set(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>new Nf);this.set(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>new Jj);this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,
()=>new Hf);this.set(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new gm);this.set(OSF.DDA.MethodDispId.dispidCreateDocumentMethod,()=>new ki);this.set(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>new jf(this.Zd.bTk,this.Zd.nxk,this.Zd.k2d))}}Object(h.a)(Hi,"EditorMethodFactory",cb,[]);class xi extends Sys.EventArgs{constructor(L){super();this.Rtd=L}get instanceId(){return this.Rtd}}Object(h.a)(xi,"FirstPartyAddInHidingEventArgs",Sys.EventArgs,[]);class ni{constructor(){this.DTa=
{};this.rje={};this.B1c={};this.uZc={}}Nzf(L,ba){ba&&L&&(this.DTa[L]=ba,this.uZc[L]=!1)}CYh(L,ba){L&&ba&&(this.B1c[L]=ba)}GKk(L){if(L){var ba=this.DTa[L];ba&&(delete this.B1c[ba.Um.id],delete this.DTa[L],delete this.rje[L],delete this.uZc[L])}}lV(L){return L?this.DTa[L]:null}k3i(L){return L?this.uZc[L]:!1}rbj(L){return L?this.rje[L]:null}Zzh(L,ba){L&&(this.uZc[L]=ba)}Jtl(L,ba){L&&(this.rje[L]=ba)}YWd(L){if(!L)return null;const ba=this.DTa;for(let Sa in ba){const sb=ba[Sa];if(sb&&sb.Um.id.toLowerCase()===
L.toLowerCase())return sb}return null}eWi(L,ba,Sa){if(!L||!ba||!Sa)return null;const sb=this.DTa;for(let Tb in sb){const Tc=sb[Tb];if(Tc&&Tc.taskpane&&Tc.taskpane.ownerAddinSolutionId&&Tc.taskpane.ownerAddinSolutionId.toLowerCase()===L.toLowerCase()){const Vb=Sa.getOsfControl(Tc.instanceId);if(Vb&&Vb.getSharedRuntimeId()===ba)return Tc}}return null}ZVd(L){$c.a.forEach(this.DTa,(ba,Sa)=>{ba=Object(C.a)(1051,Sa);1===ba.ay&&L(ba)},null)}aPi(L){const ba=this.DTa;for(let Sa in ba){const sb=Object(C.a)(1051,
ba[Sa]);if(sb&&L(sb))return sb}return null}T1f(L){return L in this.B1c?this.B1c[L]:null}}Object(h.a)(ni,"OsfAppInstacneCache",null,[]);class pg{constructor(L,ba,Sa,sb,Tb,Tc,Vb,Ed,ae,Rd,pe,ff,eg,kh,Wa,qb,dg,zb,km,Nj,Wj,Oj,Tl,qo,lm){this.$xb=!!A.AFrameworkApplication.Ba&&!!A.AFrameworkApplication.Ba.jb&&A.AFrameworkApplication.Ba.jb.NV;this.CVb=!1;this.lwb=this.n8b=this.bde=this.Czf=null;this.va=new D.a;this.xHg=!1;this.Kp=L;this.uI=ba;this.fme=new Hi(this);this.kWc=new Pa(this,Nj);this.oTa=Wj;this.VSa=
sb;this.tCg={};this.fF=new ni;this.bXj=Sa;this.ywb=Tb.value;this.Az=Vb;this.Ib=Tc;this.DW=Ed;this.Rb=ae;this.RWj=dg;this.mWc=Rd;this.kc=pe;this.Yh=ff;this.ua=eg;this.Fa=kh;this.uc=Wa;this.qc=qb;this.e6b=km;this.w9a=new Og;this.PWj=zb;this.ql=Oj;this.J$b=Tl;this.p$b=qo;this.d3j=lm}initialize(){this.T4(this.Rb.mode);this.Rb.aP(Object(H.a)(this,this.Igg,"handleModeSwitch"))}dispose(){this.Rb.Q_(Object(H.a)(this,this.Igg,"handleModeSwitch"))}get jAc(){this.w9a||(this.w9a=new Og);return this.w9a}get Ko(){if(!pg.Ksa){this.Kp&&
(this.Kp.kd.aAj&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Ee),this.kc.ka(uf.a.pa(305))&&OfficeExt.PrivateCatalogService.initRequestHandler(new Ee,new Lf(this.Kp.kd.zg?A.AFrameworkApplication.fa.appSettings.AuthProxyHandlerWebServiceBase:A.AFrameworkApplication.fa.appSettings.WebServiceBase),this.kc.ka(uf.a.pa(306))),OfficeExt.MosRequestHandler.init(new Ee),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Ee));const L=new tb(this.fme,
this.kWc);this.lwb=this.zE.aui(this.fF);pg.Ksa=this.bXj.Mui(this.uI,L,this.lwb);pg.Ksa.setOAuthManager(this.d3j);pg.Ksa&&"undefined"!==typeof pg.Ksa.hostCheckReadyHandler&&A.AFrameworkApplication.M1h(Object(H.a)(pg.Ksa,pg.Ksa.hostCheckReadyHandler,"hostCheckReadyHandler"))}return pg.Ksa}wzh(L){(L=this.Ko.getOsfControl(L))&&this.lwb&&this.lwb.uWg(L)}Jvb(L,ba,Sa){this.lwb?this.lwb.BPj(L,ba,Sa):m.ULS.sendTraceTag(512508178,806,10,"m_appEventListener is null")}Sfb(L,ba,Sa=null){const sb=this.zE.M1(L);
if(this.kc.ka(uf.a.pa(569))&&!OSF.OsfControl.isFirstPartyStoreString(this.fpb(sb.storeType)))this.ql.Tba(22)||this.ql.QAa(22);else if(0===sb.ay)this.VSa.Yzj(sb.id)?(Sa=this.VSa.vpa[sb.id],Qe.a("Microsoft.Office.PowerPointOnline.FixBug6808089KillSwitch")?(Sa.tHe(ba),this.VSa.VHa(sb.id,this.$Je(L),null)):this.VSa.VHa(sb.id,this.$Je(L),ba)):(L=this.HKe(L,ba),L.tHe(ba),this.VSa.GUk(sb.id,L));else if(1===sb.ay){const Tb=sb.node.ta(af.a.yY,null);this.csa(sb.id)?sb.Zpg||this.yFb(Tb,!0):this.HKe(L,ba,Sa);
this.Kp.kd.Sra&&!sb.ownerAddinSolutionId&&(ba=this.m1d(sb.Gva),this.RSe(sb.Gva,ba.settings))}}launchInsertDialog(){this.va.raiseEvent("OnInsertionDialogOpened");this.n8b=new ah;this.n8b.qj("",null,null);this.Ko.launchInsertDialog(this.n8b.eXb)}bjg(){this.n8b&&this.n8b.hide()}jeb(L){const ba=this.v2f(L);ba?this.xch(ba):m.ULS.sendTraceTag(512508177,806,10,String.format("Failed to find the AppNode with instance id: {0}",L))}xch(L){const ba=this.zE.M1(L);if(this.kc.ka(uf.a.pa(569))&&!OSF.OsfControl.isFirstPartyStoreString(this.fpb(ba.storeType)))this.ql.Tba(22)||
this.ql.QAa(22);else{var Sa=(sb,Tb)=>{const Tc=this.zE.M1(sb),Vb=this.zE.wEc(A.AFrameworkApplication.isRtl,Tc.id,Tc.width,Tc.visibility);Tb.wM(Vb);this.$xb||Vb.Uo(Tc.visibility);let Ed=Tb=null;this.Kp.kd.Sra&&this.Kp.kd.tMj&&(Ed=this.Gbd(L),Tb=()=>{this.aK(Vb,!0,!1);this.uIb(Ed)});this.Sfb(sb,Vb.iAc,Tb);this.$xb&&(Ed&&(sb=this.YY(Ed.Um.id).Ega,Vb.H3k(sb)),Vb.Uo(Tc.visibility))};if(this.Kp.kd.Sra){const sb=this.zE.M1(L),Tb={};Tb.marketplaceId=sb.Gva;Tb.marketplaceVersion=sb.version;Tb.storeType=this.fpb(sb.storeType);
Tb.storeId=sb.store;Tb.targetData=L;this.Ko.isAddinCommandsAsync(Tb,(Tc,Vb)=>{const Ed=this.Gbd(L);var ae=L.ta(Db.a.isForUILessAction,!1);const Rd=L.ta(Db.a.sharedRuntimeId,null),pe=sb.ownerAddinSolutionId,ff=!!Ed.Cv&&0<Ed.Cv.state&&!!Ed.Cv.Xva;if(!Vb&&sb.visibility||Vb&&pe&&!ff||ae&&!ia.a.Xa(Rd))Sa(L,this.Az),this.lZ.Zzh(sb.id,Vb);else if(Vb){if(ae=this.TYb(sb.Gva))Ed.settings=ae.settings,this.Rt.XFe(L,Ed.settings);this.lZ.Nzf(Ed.instanceId,Ed);this.lZ.Zzh(Ed.instanceId,Vb);this.RSe(Ed.Um.id,Ed.settings);
if(sb.visibility&&this.mWc.installVisibleAddinCommandsEnabled||ff){if("omex"!==Tb.storeType.toLowerCase()&&!ff)return;let eg=!1;this.pAe(kh=>{if(!kh[N.a.Z4h]){if(kh[N.a.LCf])for(const Wa of kh[N.a.LCf])if(eg=Yf.e(Wa[1])===Yf.e(sb.Gva))break;eg||this.Gyc(Ed)}})}}Tc||Ia.a.J(512508176,220,10,"Checking AddinCommands fails for {0} from {1}",sb.Gva,this.fpb(sb.storeType))})}else Sa(L,this.Az)}}DZb(L){return L&&L.assetId?L.sourceLocationOverrideResourceId?String.format("{0}.{1}",L.assetId,L.sourceLocationOverrideResourceId):
L.assetId:null}QOk(L){const ba=this.uci(L),Sa=this.zE.M1(ba);if(A.AFrameworkApplication.o$d(Sa.Gva)){const sb=this.zE.wEc(A.AFrameworkApplication.isRtl,Sa.id,Sa.width,Sa.visibility,L);this.Az.wM(sb);sb.Uo(Sa.visibility);this.HKe(ba,sb.iAc,null,L)}}pAe(L){const ba={};ba.callback=L;A.AFrameworkApplication.Va.Ma(ie.a.oWa,2,ba)}Gyc(L){const ba=this.zE.wEc(A.AFrameworkApplication.isRtl,L.instanceId,L.taskpane.width,L.taskpane.visibility);this.Az.wM(ba);ba.Uo(L.taskpane.visibility);const Sa=ba.iAc;Object(C.a)(1050,
this.zE.iOd(this.Kp.kd,L,Sa,A.AFrameworkApplication.isRtl,this)).Gyc(this.Ko,Sa,()=>{this.uIb(L);this.aK(ba,!1,!!L.Cv&&!!L.Cv.Xva);x.a.instance.setItem(N.a.MCf,"true")})}aK(L,ba,Sa){L.Uo(!1);Sa||(pg.Ksa.purgeOsfControl(L.id,!1),ba?this.Kp.lK().Ma(Hh.a.$Oc,2,L.id):this.kWc.FMf(L.id),L.dispose())}uIb(L){var ba={};ba.solutionId=L.Um.id;ba.version=L.Um.version;ba.storeType=L.Um.storeType;ba.storeId=L.Um.store;ba.assetId=L.Um.id;ba.assetStoreId=L.Um.storeType;ba.sharedRuntimeId=L.Cv?L.Cv.Xva:null;ba.backgroundState=
L.Cv?L.Cv.state:-1;L=new e.a;L.add(ba);ba={};ba[N.a.Szc]=L;ba[N.a.yaa]=3;this.Kp.lK().Ma(ie.a.RUc,2,ba)}oKc(){const L=this.DW.Bf;var ba=null;L&&(ba=new ij.GraphIterator,ba.set(L),ba=ba.yb(18));return ba}YY(L){return L?(L=this.fF.YWd(L))&&L.taskpane?L:null:null}iQi(L,ba,Sa,sb){if(!L||!ba||!Sa)return null;L=this.getSharedRuntimeId(ba,sb,L.solutionId,Sa);return(Sa=this.fF.eWi(Sa,L,this.Ko))&&Sa.taskpane?Sa:null}hVd(L){return L?(L=this.fF.lV(L))&&L.taskpane?L:null:null}oBa(L){if(!L)return null;var ba=
this.oKc();if(ba&&(ba=this.Ib.Jc(ba))&&ba.yb(19)){do{const Sa=ba.currentNode;if(this.jTb(Sa.ta(me.a.anb,null),L))return Sa}while(ba.xj(19))}return null}v2f(L){if(!L)return null;var ba=this.oKc();if(ba&&(ba=this.Ib.Jc(ba))&&ba.yb(19)){do{const Sa=ba.currentNode;if(this.jTb(Sa.ta(af.a.yY,null),L))return Sa}while(ba.xj(19))}return null}U1f(L,ba){return(L=this.qc.Bk(L))?L.jS(ba):null}yzj(L){return L?this.fF.k3i(L):!1}Wbi(L,ba,Sa,sb,Tb){if(!L||!L)return null;let Tc;if(!(L.solutionId&&L.version&&L.storeId&&
L.storeType))return m.ULS.sendTraceTag(512508175,802,15,"Invalid entitlement"),null;Tc=Object(C.a)(Md.a,this.ywb.createInstance(1074135137));Tc.setValue(me.a.anb,L.solutionId);Tc.setValue(me.a.rAc,L.version);Tc.setValue(me.a.qAc,L.storeId);Tc.setValue(af.a.USb,this.hEc(L.storeType));Tc.setValue(me.a.mAc,!1);Tc.setValue(af.a.yY,dh.a.create().toString());Tc.setValue(me.a.tHd,"right");Tc.setValue(me.a.WSb,Sa);Tb&&Tc.setValue(Db.a.isForUILessAction,Tb);sb&&(Tc.setValue(af.a.m1g,sb),(L=this.getSharedRuntimeId(ba,
Tb,L.solutionId,sb))&&Tc.setValue(Db.a.sharedRuntimeId,L));return Tc}I5f(L){L=this.oBa(L);return this.Gbd(L)}Vbi(L,ba){if(!(L&&L&&L.solutionId&&L.version&&L.storeId&&L.storeType))return null;L=new vg(L.solutionId,L.version,L.storeId,L.storeType);ba=ba?new pj(0,ba):null;return new qj(L,null,null,null,{},1,ba)}ERd(L){dd.AppsForOfficeSingleSignOnManager.Uii(L);const ba=this.fF.lV(L);ba&&(pg.Ksa.purgeOsfControl(ba.instanceId,!1),this.kWc.FMf(ba.instanceId),this.fF.GKk(ba.instanceId),this.VSa.Bah(ba.instanceId),
this.oTa.qhc(this.presentationId,L,!1,!0))}notifyAgave(L,ba){this.Ko.notifyAgave(L,ba)}LHk(L){!this.xHg&&L.zk&&(L=L.zk,L.Cd(47).l6(Object(H.a)(this,this.NDf,"appDisposeHandler")),L.Cd(10).l6(Object(H.a)(this,this.NDf,"appDisposeHandler")),this.xHg=!0)}NDf(L,ba){L=ba.node;ba=1074135137===L.Oe;if(L.ta(af.a.ar,!1)||ba)L=this.zE.M1(L),this.ERd(L.id)}uci(L){const ba=Object(C.a)(9,this.ywb.createInstance(1074135137));ba.setValue(me.a.rAc,"1.0.0.0");ba.setValue(me.a.qAc,"en-US");ba.setValue(af.a.yY,dh.a.create().toString());
ba.setValue(me.a.WSb,!0);ba.setValue(af.a.lHd,L.assetId);ba.setValue(me.a.anb,this.DZb(L));L.tnc?(ba.setValue(me.a.VSb,"sdxcatalog"),ba.setValue(af.a.mHd,"sdxcatalog"),ba.setValue(af.a.USb,this.hEc("sdxcatalog"))):(ba.setValue(me.a.VSb,"firstparty"),ba.setValue(af.a.mHd,"firstparty"),ba.setValue(af.a.USb,this.hEc("firstparty")));ba.setValue(af.a.isAddinCommands,!1);ba.setValue(me.a.mAc,!1);ba.setValue(me.a.tHd,"right");return ba}Gbd(L,ba=null){if(!L)return null;L=this.zE.M1(L);const Sa=this.fpb(L.storeType),
sb=new vg(L.Gva,L.version,L.store,Sa);let Tb=null,Tc=null;if(0===L.ay)Tb=new Sg(L.shapeId,L.slideId);else if(1===L.ay)Tc=new wh(L.TWf,L.visibility,L.width,L.row,L.ownerAddinSolutionId,L.ownerAddinStoreType,L.Zpg);else return null;let Vb={};ba&&OSF.OsfControl.isFirstPartyStoreString(Sa)?Vb=OSF.OUtil.serializeSettings(ba.bO):L.ownerAddinSolutionId||(Vb=L.settings);ba=L.W2a?new pj(L.znb,L.W2a):null;return new qj(sb,L.id,Tb,Tc,Vb,L.ay,ba)}F$g(L,ba=null){if(this.kc.ka(uf.a.pa(883))){var Sa=this.Ko.getOsfControl(L);
if(Sa&&ba){ba.bO&&Sa.setSettings(OSF.OUtil.serializeSettings(ba.bO));if(ba.ZT){const sb=Object(C.a)(1051,this.hVd(L));sb&&(sb.Ega=ba.ZT,this.$xb&&this.yFb(L,!0))}Sa.refresh();this.wzh(L)}}}HKe(L,ba,Sa=null,sb=null){const Tb=this.Gbd(L,sb);if(!Tb||OSF.OsfControl.isFirstPartyStoreString(Tb.Um.storeType)&&!A.AFrameworkApplication.o$d(Tb.Um.id))return null;var Tc=this.zE.M1(L);if(this.kc.ka(uf.a.pa(569))&&!OSF.OsfControl.isFirstPartyStoreString(this.fpb(Tc.storeType)))return this.ql.Tba(22)||this.ql.QAa(22),
null;sb&&sb.ZT&&(Tb.Ega=sb.ZT);Tc=Object(C.a)(1050,this.zE.iOd(this.Kp.kd,Tb,ba,A.AFrameworkApplication.isRtl,this));this.fF.Nzf(Tb.instanceId,Tb);this.fF.CYh(Tb.Um.id,ba);sb&&sb.dva&&sb.dva();this.Kp.kd.Sra&&Tb.taskpane&&Tb.taskpane.ownerAddinSolutionId&&(ba=this.fF.YWd(Tb.taskpane.ownerAddinSolutionId))&&this.gzh(ba.instanceId,Tb.instanceId);Tc.c9k(this.Ko,this.$Je(L),Sa,sb,this.mWc.powerPointDragInsertImageIsEnabled);Tb.taskpane&&Tb.taskpane.ownerAddinSolutionId||this.LHk(L);return Tc}Wth(L){if(this.mWc.jNj){const Sa=
this.lZ.lV(L);if(Sa&&0===Sa.ay&&Sa.shape){var ba=this.lZ.rbj(L);const sb=new Date;!ba||sb.getTime()-ba.getTime()>=this.mWc.pptEditorAppForOfficeSnapshotIntervalTime?(m.ULS.sendTraceTag(512508173,806,50,"Start to generate addin [{0}] {1} snapshot",Sa.Um.id,L),(ba=this.RWj.zQf(1,L))?(this.lZ.Jtl(L,sb),ba.execute(this,this.PWj,null)):m.ULS.sendTraceTag(512508172,806,50,"Snapshot action is null for addin [{0}] {1}.",Sa?Sa.Um.id:"AppNotExist",L)):m.ULS.sendTraceTag(512508171,806,50,"Addin [{0}] {1} snapshot interval is less than config interval threshold.",
Sa?Sa.Um.id:"AppNotExist",L)}}}BYg(L,ba,Sa,sb){1===L&&this.wmk(ba,Sa,sb)}wmk(L,ba,Sa){let sb=null;Sa&&Sa.result&&(Sa=Sa.result,sb=Sa.substr(Sa.indexOf("base64,")+7));const Tb=this.lZ.lV(L);ba===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&sb&&0<sb.length&&Tb?0===Tb.ay&&Tb.shape&&Tb.Um&&this.Yh.vzh(Tb.shape.slideId.toString(),Tb.shape.id,sb,()=>{m.ULS.sendTraceTag(512508170,806,50,"Update addin [{0}] {1} snapshot succeed with {2} bytes",Tb.Um.id,L,sb.length)},()=>{m.ULS.sendTraceTag(512508169,806,
10,"Update addin [{0}] {1} snapshot failed",Tb.Um.id,L);return!1}):m.ULS.sendTraceTag(512508168,806,10,"Generate addin [{0}] {1} snapshot failed with {2} bytes",Tb?Tb.Um.id:"AppNotExist",L,sb?sb.length:0)}TYb(L){return L?this.tCg[L]:null}fzc(L,ba){L&&ba&&(this.tCg[L]=ba)}get Rt(){this.bde||(this.bde=new gg(this.Kp.kd,nc.a.instance.resolve("Common.IAppSettingsManager"),this.uI,nc.a.instance.qe("Box4.IOutlineEditor"),nc.a.instance.qe("Box4.ISelectionManager"),nc.a.instance.qe("Box4.ICharacterPropertiesEditor"),
nc.a.instance.qe("PowerPointWebEditor.IClassFactory"),nc.a.instance.resolve("Common.Transaction.ITransactionFactory"),this.Kp.lK(),nc.a.instance.resolve("PowerPointWebEditor.IPPTWorkspace"),nc.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),nc.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),nc.a.instance.resolve("PowerPointWebEditor.ISlideReader"),nc.a.instance.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"),nc.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),
nc.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),nc.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),nc.a.instance.resolve("PowerPointWebEditor.IShapeReader"),nc.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),nc.a.instance.resolve("Box4.IOutlineElementNavigator"),nc.a.instance.resolve("Box4.IParagraphReader"),nc.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager"),nc.a.instance.resolve("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory")));return this.bde}get uba(){return this.oTa}wWa(L,
ba,Sa){this.kWc.XWd(L).raiseEvent(Sa,ba)}w8g(L,ba){this.fF.ZVd(Sa=>{this.wWa(L,Sa.instanceId,ba)})}gzh(L,ba){if(L&&ba){L=this.lZ.lV(L);var Sa=this.lZ.lV(ba);L&&Sa&&(Sa.settings=L.settings,this.GYg(ba,L.settings))}}RSe(L,ba){L&&ba&&this.lZ.ZVd(Sa=>{this.jTb(Sa.taskpane.ownerAddinSolutionId,L)&&!this.jAc.Zzj(Sa.settings,ba)&&(Sa.settings=ba,this.GYg(Sa.instanceId,ba))})}Igg(L){this.T4(L.mode)}T4(L){if(1!==L&&2!==L)throw Error.invalidOperation(String.format("The mode '{0}' being swtiched to is unsupported.",
L));m.ULS.sendTraceTag(512508167,806,50,"AppForOfficeManager.SwitchToMode: {0} the content add-in's container on active slide.",2===L?"Show":"Edit");this.VSa.T4(L);this.Az.T4(L)}GYg(L,ba){const Sa=OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString();this.wWa(Sa,L,ba)}fpb(L){switch(L){case 0:L="spcatalog";break;case 1:L="filesystem";break;case 2:L="omex";break;case 3:L="spapp";break;case 4:L="registry";break;case 5:L="inmemory";break;case 6:L="uploadfiledevcatalog";break;case 7:L="excatalog";
break;case 8:L="firstparty";break;case 9:L="sdxcatalog";break;default:throw Error.create(String.format("[{0}] is not the valid store type int value.",L));}return L}hEc(L){if(!L)throw Error.create("Store Type should not be null.");pg.A4||pg.tuj();if(L in pg.A4)return pg.A4[L];throw Error.create(String.format("[{0}] is not the valid store type.",L));}m1d(L){return L?this.fF.aPi(ba=>this.jTb(ba.Um.id,L)):null}get xHd(){return this.Kp}K2h(L){this.va.addHandler("OnInsertionDialogOpened",L)}pGd(L){this.va.addHandler("OnFirstPartyAddInHidden",
L)}hNk(L){this.va.removeHandler("OnFirstPartyAddInHidden",L)}hCk(L){this.va.raiseEvent("OnFirstPartyAddInHidden",new xi(L))}oMd(L){const ba=Gh.a.tna(this.Az.s1,Sa=>Sa.id===L);if(1!==ba.length)return!1;this.aK(ba[0],!0,this.csa(L));return!0}yFb(L,ba){const Sa=Gh.a.tna(this.Az.s1,sb=>sb.id===L);1!==Sa.length?Ia.a.J(512508166,220,50,"Panes with appropriate instance id are {0}",Sa.length):Sa[0].Uo(ba)}sVi(L){const ba=Gh.a.tna(this.Az.s1,Sa=>Sa.id===L);return 1!==ba.length?(Ia.a.J(512508165,220,50,"Panes with appropriate instance id are {0}",
ba.length),!1):ba[0].isVisible}mol(L,ba){const Sa=this.TYb(L);Sa&&Sa.Cv&&Sa.Cv.Xva&&(Sa.Cv.state=ba?1:0,(this.oBa(L)||this.jAc.Wgg(L,Sa.settings,this))&&this.Kp.lK().Ma(Hh.a.kzh,2,Sa))}tVi(L){return(L=this.TYb(L))&&L.Cv?1===L.Cv.state:!1}sNf(L){this.lZ.ZVd(ba=>{this.jTb(ba.taskpane.ownerAddinSolutionId,L)&&this.oMd(ba.instanceId)})}qrb(L){return this.fF.lV(L)}csa(L){if(!L||4===this.Ko.getOsfControlStatus(L))return!1;L=this.Ko.getOsfControl(L);return!!L&&!!L.getSharedRuntimeId()}setInitialDisplayMode(L,
ba){(L=this.Ko.getOsfControl(L))&&L.setInitialDisplayMode(ba)}getSharedRuntimeId(L,ba,Sa,sb){if(!L)return null;const Tb=new Lg;if(!Tb)return null;if(ba)return L.getSharedRuntimeId(Tb.mS,ba,null);Sa=(new ib("",sb,Tb,!0)).uTf(Sa.substr(sb.length));return L.getSharedRuntimeId(Tb.mS,ba,Sa)}yQi(L,ba){const Sa={};Sa.visibility=ba?"Visible":"Hidden";ba=JSON.stringify(Sa);this.K2f(L,65539,"",ba)}AQi(L,ba,Sa){this.K2f(L,1,ba,Sa)}Lal(L,ba){L=new vg(L.solutionId,L.version,L.storeId,L.storeType);var Sa=new wh("right",
!0,350,0,null,null,!1);L=new qj(L,ih.a.create().toString(),null,Sa,{},1,null);const sb=this.zE.wEc(A.AFrameworkApplication.isRtl,L.instanceId,L.taskpane.width,L.taskpane.visibility);this.Az.wM(sb);sb.Uo(L.taskpane.visibility);Sa=sb.iAc;Object(C.a)(1050,this.zE.iOd(this.Kp.kd,L,Sa,A.AFrameworkApplication.isRtl,this)).Gyc(this.Ko,Sa,()=>{this.aK(sb,!1,!1);ba()})}K2f(L,ba,Sa,sb){var Tb=Array(6);Tb[0]=65536;Tb[1]=ba;Tb[2]=Sa;Tb[3]=sb;Tb[4]=-1;Tb[5]=!1;ba=Array(1);ba[0]=Tb;Tb=new ci(OSF.DDA.EventDispId.dispidRichApiMessageEvent,
L,null,ba);this.wWa(OSF.DDA.EventDispId.dispidRichApiMessageEvent.toString(),L,Tb)}jTb(L,ba){return L&&ba?L.toLowerCase()===ba.toLowerCase():!1}$Je(L){return!this.Rb||1!==this.Rb.mode||L&&"FA000000012"===L.ta(af.a.lHd,null)?1===this.zE.M1(L).ay?!0:this.Fa.rsa(L)?this.ua.Ca===this.uc.Sg(L):!1:!1}get presentationId(){return this.Kp.aQa().presentationId}get tPf(){return this.VSa}get lZ(){return this.fF}get zE(){return this.e6b.value}get bTk(){return this.J$b}get nxk(){return this.p$b}get k2d(){return this.ua}static tuj(){pg.A4=
{};pg.A4.inmemory=5;pg.A4.uploadfiledevcatalog=6;pg.A4.spcatalog=0;pg.A4.omex=2;pg.A4.registry=4;pg.A4.spapp=3;pg.A4.filesystem=1;pg.A4.excatalog=7;pg.A4.firstparty=8;pg.A4.sdxcatalog=9}}pg.A4=null;pg.Ksa=null;Object(h.a)(pg,"AppForOfficeManager",null,[1052,109,785]);class ul{constructor(L,ba,Sa){this.ES=L;this.YFg=ba;this.Ib=Sa}register(){this.YFg.yk(Object(H.a)(this,this.WDf,"appSettingChangedEventHandler"))}dispose(){this.YFg.Pm(Object(H.a)(this,this.WDf,"appSettingChangedEventHandler"))}WDf(L,
ba){L=ba.node;ba=ba.property;try{if(1074135139===L.Oe&&ba===me.a.pAc){ba=null;var Sa=this.Ib.Jc(L);Sa.oc(47)||Sa.oc(10);Sa.yc();this.L7d(Sa.currentNode)&&(ba=new bg.a(Sa.currentNode));var sb=ba.settings;Qe.a("RefreshAppSettingsValue")&&(this.ES.qrb(ba.id).settings=sb);this.ES.wWa(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),ba.id,sb)}}catch(Tb){m.ULS.sendTraceTag(18442307,802,10,"Failed to execute AppSettingChangedEventHanlder: {0}.",Tb)}}L7d(L){if(!L)return!1;const ba=Object(C.a)(4,
L);return 1074135137===L.Oe||!!ba&&ba.ar}}Object(h.a)(ul,"AppForOfficeSettingChangedEventListener",null,[1048,109]);class Rn{constructor(L,ba,Sa){this.ES=L;this.LBg=ba;this.Ib=Sa}register(){for(const L of this.LBg)L.ZF(Object(H.a)(this,this.XDf,"appSettingCreatedEventHandler"))}dispose(){for(const L of this.LBg)L.kO(Object(H.a)(this,this.XDf,"appSettingCreatedEventHandler"))}XDf(L,ba){L=ba.node;try{if(this.L7d(L)&&21===ba.GY){this.Ib.Jc(L).P0b()||m.ULS.sendTraceTag(20821900,802,15,"Got OnChildTopologyChanged event but no child found.");
const Sa=new bg.a(L),sb=Sa.settings;this.ES.wWa(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),Sa.id,sb)}}catch(Sa){m.ULS.sendTraceTag(20821901,802,10,"Failed to execute AppSettingCreatedEventHandler: {0}.",Sa)}}L7d(L){if(!L)return!1;const ba=Object(C.a)(4,L);return 1074135137===L.Oe||!!ba&&ba.ar}}Object(h.a)(Rn,"AppForOfficeSettingCreatedEventListener",null,[1048,109]);class ek{constructor(L,ba){this.ia=L;this.Ow=ba}register(){this.Ow.yk(Object(H.a)(this,this.fuh,"taskpaneAppCreatedEventHandler"))}dispose(){this.Ow.Pm(Object(H.a)(this,
this.fuh,"taskpaneAppCreatedEventHandler"))}fuh(L,ba){if(L=ba.node)L=new bg.a(L),ba.property.id===af.a.yY.id&&1===L.ay&&(ba=ba.node.ta(af.a.yY,null))&&this.ia.Ma(Hh.a.jeb,2,ba)}}Object(h.a)(ek,"AppForOfficeTaskpaneAppCreatedEventListener",null,[1048,109]);var ln=d(634),Fl=d(521),fk=d(872);class Oi{constructor(L,ba,Sa,sb,Tb){this.$xb=!!A.AFrameworkApplication.Ba&&!!A.AFrameworkApplication.Ba.jb&&A.AFrameworkApplication.Ba.jb.NV;this.ES=L;this.Kp=ba;this.Rb=Sa;this.fF=sb;this.Az=Tb}register(L){L.controlStatusChanged=
Object(H.a)(this,this.uWg,"onControlStatusChanged");L.notifyHost=Object(H.a)(this,this.HYg,"onOsfNotifyHost")}uWg(L){let ba=this.fF.T1f(L.getSolutionId());const Sa=this.fF.lV(L.getID());Sa&&Sa.Um&&L.isFirstParty()&&(ba=this.fF.T1f(Sa.Um.id));if(ba&&Sa&&ba.previousSibling){var sb=L.getSolutionId(),Tb=L.getVersion(),Tc=null,Vb=null;Vb=L.isFirstParty()?OSF.OsfManifestManager.getCachedManifest(sb,""):OSF.OsfManifestManager.getCachedManifest(sb,Tb);L.isFirstParty()&&Sa.Ega?Tc=Sa.Ega:Vb&&(Tc=Vb.getDefaultDisplayName(),
Sa.Ega=Tc);if(0!==Sa.ay){if(Qe.a("TaskpaneIconUrlPassing")&&this.$xb){Tb=null;Vb&&(Tb=Vb.getDefaultIconUrl());Vb=null;Qe.a("UpdateTaskpaneWithInstanceId")&&(Vb=Object.assign(new fk.a,{getContent:()=>ba,type:"LegacyTaskPaneProps"}));const Ed=Object.assign(new ln.a,{title:Tc,hideHeader:Qe.a("UpdateTaskpaneWithInstanceId"),iconUrl:Tb,width:320,location:2,contentProps:Vb,onOpen:()=>{},onClose:()=>{},isModernPane:!0});mb.UISurfaces.du().then(ae=>{if(Qe.a("UpdateTaskpaneWithInstanceId")){const Rd=L.getID();
ae.updateTaskPane(Rd,Ed)}else ae.updateTaskPane(sb,Ed);return null}).catch(()=>{Ia.a.J(512360770,220,10,"taskPaneAPI.UpdateTaskpane() fails for {0}",sb)})}ba.previousSibling&&(ba.previousSibling.innerText===Tc||!L.isFirstParty()&&""!==ba.previousSibling.innerText)||!Tc||!Sa.taskpane||Sa.taskpane.isForUILessAction||(ba.previousSibling.innerText=Tc,this.Rb.oQa())}}}BPj(L,ba,Sa){this.HYg(L,ba,Sa)}HYg(L,ba,Sa){3===ba?(this.ES.bjg(),this.Az.vf(ze.a.ZD),Sa?this.Kp.lK().Ma(Hh.a.dQc,2,Sa):m.ULS.sendTraceTag(512360769,
806,10,"InsertAgave: should have valid insert agave parameters")):36===ba?Sa?this.Kp.lK().Ma(Hh.a.dQc,2,Sa):m.ULS.sendTraceTag(512360768,806,10,"InsertDevManifest: should have valid insert agave parameters"):37===ba?Sa&&(L=Object(C.a)(Object,Sa),L={["ak1"]:this.ES.Ko.getDevManifestInvalidUrlErrorString(L.manifestUrl)},this.Kp.lK().Ma(ie.a.HGb,2,L)):2===ba?this.ES.bjg():9===ba?this.Kp.kd.Sra&&this.Kp.kd.Wpg&&this.Kp.lK().Ma(ie.a.oCe,2,Sa):5===ba||6===ba?(Sa=this.fF.lV(L))?0===Sa.ay?this.Az.pQe(ba):
this.Az.SRi(L,ba):m.ULS.sendTraceTag(512360738,806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):13===ba||14===ba?(Sa=this.fF.lV(L))?0===Sa.ay||Sa.taskpane&&Sa.taskpane.isForUILessAction?this.ES.notifyAgave(L,13===ba?11:12):(cg.a.ag&&document.activeElement.blur(),this.$xb&&13===ba?Eh.FocusManager.instance().yIe(ze.a.rO):this.Az.C3f(L)):m.ULS.sendTraceTag(512360737,806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):16===ba?(ba=this.fF.lV(L))?
0===ba.ay&&this.Az.X_f():m.ULS.sendTraceTag(512360736,806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):17===ba||18===ba?(ba=this.fF.lV(L))?0===ba.ay?this.Az.X_f():(cg.a.ag&&document.activeElement.blur(),this.Az.C3f(L)):m.ULS.sendTraceTag(512360735,806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):1===ba||10===ba?(ba=this.fF.lV(L))?0===ba.ay&&this.ES.Wth(L):m.ULS.sendTraceTag(512360734,806,10,String.format("Failed to find the cached app with instance Id: {0}",
L)):8===ba?(L={["ak1"]:this.ES.Ko.getManifestInvaildErrorString()},this.Kp.lK().Ma(ie.a.HGb,2,L)):15===ba?(L=this.Az.xnl(L))&&(ba=this.ES.qrb(L))&&ba.taskpane&&!ba.taskpane.isForUILessAction&&this.ES.notifyAgave(L,11):23===ba?ca.a.sendOtelEvent(Object.assign(new Fl.a,{otelEvent:Sa})):38===ba?ca.a.sendOtelCustomerContent(Object.assign(new Fl.a,{otelEvent:Sa})):32===ba?(L=Object(C.a)(Object,Sa).solutionId,this.ES.sNf(L)):34===ba&&(L=Object(C.a)(Object,Sa),ba=L.controlId,Sa=new ib("",L.ownerAddinSolutionId,
new Lg,!0),L.originalControlId=Sa?Sa.uTf(ba):ba)}}Object(h.a)(Oi,"AppForOfficeAppEventHandler",null,[1086]);var xh=d(248),mn=d(1172);class rh{static p_h(L){var ba=L.getAttribute("style");ba=ba?ba.toString():"";0>ba.indexOf("pointer-events: auto")&&L.className!==rh.TEb&&L.setAttribute("style",ba+" pointer-events: auto")}static WAf(L){var ba=L.getAttribute("style");ba=ba?ba.toString():"";0>ba.indexOf("pointer-events: none")&&L.className===rh.TEb&&L.setAttribute("style",ba+" pointer-events: none")}static NLk(L){var ba=
L.getAttribute("style");ba=ba?ba.toString():"";0<=ba.indexOf("pointer-events: none")&&L.className===rh.TEb&&(ba=ba.replace("pointer-events: none",""),L.setAttribute("style",ba))}}rh.NTk="AppForOfficeContainer EditAppForOfficeContainer";rh.TEb="AppForOfficeContainer EditAppForOfficeHidden EditAppForOfficeContainer";rh.FFe="";Object(h.a)(rh,"AppForOfficeViewHelper",null,[]);var aj=d(957),za=d(140);class uk{constructor(L,ba,Sa,sb,Tb){this.Bz=this.rBg=null;this.dzb=!1;this.la=L;this.IA=ba;this.ika=sb;
this.$h=Sa;ba&&ba.taskpane&&ba.taskpane.isForUILessAction?(this.Bz=null,this.rBg=Sa):(this.Bz=new za.a,this.Bz.fe.className=rh.TEb,this.Bz.fe.id="AppForOffice_"+this.IA.instanceId,this.Bz.fe.style.width="100%",this.Bz.fe.style.height="100%",this.Bz.fe.style.position="relative",this.Bz.fe.style.left="0",this.Bz.fe.style.top="0",Sa.appendChild(this.Bz.fe));this.Zd=Tb}dispose(){this.HKk();this.IA=null}HKk(){this.Bz&&this.Bz.aq()}tHe(L){L&&this.Bz&&L!==this.$h&&(this.$h=L,L.appendChild(this.Bz.fe),this.dzb&&
this.Nba())}$za(L){L&&(L.fe.innerHTML="")}c9k(L,ba,Sa=null,sb=null,Tb=!1){this.zXh(L,ba,Sa,sb,Tb)}Gyc(L,ba,Sa){ba=this.rfc(ba);L.insertBlankControlWithErrorUX(ba,()=>{Sa()})}zXh(L,ba,Sa=null,sb=null,Tb=!1){this.dzb=Tb;this.$za(this.Bz);this.IA&&L&&(this.VHa(ba,null),ba=this.rfc(this.Bz?this.Bz.fe:this.rBg,sb,L),ba.virtualOsfControlActivationCallback=Sa,L.insertOsfControl(ba),L.setActivationCompletedStatus(this.IA.instanceId,!0),Tb&&this.Nba())}Nba(){if(this.Bz){var L=this.Bz.za;if(L){var ba=L.parentNode;
ba&&"OsfAddinOverlay"!==ba.className&&(xh.a.instance.pb(Cd.a.ila,ba,Object(H.a)(this,this.fbh,"removePointerEventsStyleHandler")),mn.a.instance.pb(Cd.a.drop,ba,Object(H.a)(this,this.fbh,"removePointerEventsStyleHandler")),xh.a.instance.pb(Cd.a.jla,ba,Object(H.a)(this,this.q_h,"addPointerEventsStyleHandler")),rh.WAf(L))}}}fbh(L){L=L.nc.target;for(let ba=0;ba<L.childNodes.length;++ba)rh.NLk(L.childNodes[ba]);return!0}q_h(L){L=L.nc.target;for(let ba=0;ba<L.childNodes.length;++ba)rh.WAf(L.childNodes[ba]);
return!0}VHa(L,ba){this.Bz&&(L?(null!=ba&&this.tHe(ba),this.Bz.fe.className=""===rh.FFe?rh.NTk:rh.FFe,rh.p_h(this.Bz.za)):(this.Bz.fe.className!==rh.TEb&&(rh.FFe=this.Bz.fe.className),this.Bz.fe.className=rh.TEb))}uHe(L){this.Bz&&(this.Bz.fe.style.zIndex=String(L))}rfc(L,ba=null,Sa=null){const sb={};sb.div=L;sb.id=this.IA.instanceId;L=this.IA.Um.id;const Tb=this.IA.taskpane?this.IA.taskpane.ownerAddinSolutionId:null;if(Sa&&Tb){const Tc=this.IA.taskpane.isForUILessAction;this.IA.Cv?sb.sharedRuntimeId=
this.IA.Cv.Xva:(Sa=Sa.getOsfControl(Tb).getManifest(),sb.sharedRuntimeId=this.Zd.getSharedRuntimeId(Sa,Tc,L,Tb));sb.initialDisplayMode=Tc?1:2}sb.hostInfoFlags=0;sb.sharedRuntimeId?(sb.hostInfoFlags|=1,sb.solutionId=Tb):ba?(sb.solutionId=ba.assetId,sb.sourceLocationOverrideResourceId=ba.sourceLocationOverrideResourceId,sb.featureGates=A.AFrameworkApplication.fa.x1i(ba.assetId)):sb.solutionId=L;sb.version=this.IA.Um.version;sb.storeId=this.IA.Um.store;sb.storeType=this.IA.Um.storeType;sb.assetId=null;
sb.assetStoreId=null;sb.settings=this.IA.settings;sb.reason=aj.a.contains(this.IA.Um.id,this.IA.ay,this.IA.Um.store,this.IA.Um.storeType,this.IA.Um.version)?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;0===this.IA.ay?sb.osfControlType=0:1===this.IA.ay&&(sb.osfControlType=1);A.AFrameworkApplication.ypa||OSF.OsfControl.isFirstPartyStoreString(sb.storeType)||(m.ULS.sendTraceTag(512369924,802,50,(0===this.IA.ay?"Content":
"Taskpane")+" web add-in disabled by doc IRM"),sb.hostInfoFlags|=4);this.IA.taskpane?(sb.isForUILessAction=this.IA.taskpane.isForUILessAction,sb.ownerAddinSolutionId=Tb,sb.ownerAddinStoreType=this.IA.taskpane.ownerAddinStoreType):sb.isForUILessAction=!1;return sb}}Object(h.a)(uk,"AppForOfficeView",null,[1050]);var Lj=d(276),hm=d(72);class Mf{constructor(L,ba,Sa,sb,Tb,Tc,Vb,Ed,ae,Rd,pe,ff,eg,kh,Wa){new Lj.a(0,0,0,0);this.x9a=this.rN=this.Zn=null;this.wPg=ResourceStrings.l_AddinPane;this.nE=!!A.AFrameworkApplication.Ba&&
!!A.AFrameworkApplication.Ba.jb&&A.AFrameworkApplication.Ba.jb.NV;this.xb=re.a.De();this.Rb=Tc;this.jd=Ed;this.Az=Vb;this.Qd=ae;this.At=L;this.GG=ba;this.Kp=Sa;this.SWj=sb;this.Sb=Tb;this.ju=Rd;this.Zd=pe;this.Oc=ff;this.hc=eg;this.SG=kh;this.lTa=Wa;this.initialize()}dispose(){this.jd&&this.Zn&&(this.jd.zb(Cd.a.click,this.Zn,Object(H.a)(this,this.fAa,"closePaneButtonClickHandler")),this.ju.removeHandler(this.Zn,Cd.a.Rf,Object(H.a)(this,this.shg,"handleShortCutsOnCloseButton")),this.Zn=null);this.Oc.tEb(Object(H.a)(this,
this.Wz,"onUnifiedAppStateChanged"));this.Rb.qEb(Object(H.a)(this,this.UW,"onSetOffline"));this.Az.cbh(this)}initialize(){const L="label_"+this.GG;this.xb.className=this.At?"AddinPane AddinPaneRTL":"AddinPane AddinPaneLTR";this.xb.style.position="absolute";this.xb.style.display="none";this.xb.setAttribute(rd.a.ff,rd.a.Nza);this.xb.setAttribute(rd.a.o6,L);this.Zn=this.tAa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.Zn,"AddinPaneCloseButton");this.jd.pb(Cd.a.click,this.Zn,Object(H.a)(this,
this.fAa,"closePaneButtonClickHandler"));this.ju.addHandler(this.Zn,Cd.a.Rf,Object(H.a)(this,this.shg,"handleShortCutsOnCloseButton"));this.xb.appendChild(this.Zn);this.x9a=re.a.De();this.x9a.className="PaneLabel";this.x9a.id=L;this.x9a.setAttribute(rd.a.ff,rd.a.NFf);this.x9a.setAttribute(rd.a.kTb,"1");this.xb.appendChild(this.x9a);this.rN=re.a.De();this.rN.className=this.Kp.kd.zWa?"AddinPanePanelResize":"AddinPanePanel";this.xb.appendChild(this.rN);this.Oc.Bga(Object(H.a)(this,this.Wz,"onUnifiedAppStateChanged"));
this.Rb.D2a(Object(H.a)(this,this.UW,"onSetOffline"))}Wz(L,ba){ba.X7a&&!this.hc.An&&this.isVisible&&this.Sig()}UW(L){L&&this.isVisible&&this.Sig()}Sig(){this.Uo(!1);this.Kp.lK().Ma(Hh.a.$Oc,2,this.GG);this.Gae()||this.dispose()}layout(L,ba){const Sa=ba?L.CF(this.width):L.DF(this.width);this.isVisible&&(ba?Sa.CF(1):Sa.DF(1),this.rN.style.height=(L.height-this.Zn.clientHeight-this.x9a.clientHeight).toString()+"px",this.rN.style.width="100%");re.a.b0(this.xb,Sa);return L}H3k(L){this.wPg=L}Uo(L){const ba=
this.Sb!==L;if(this.Sb=L)this.xb.style.display="block";const Sa=this.Gae();this.SG.r0k(this.GG,Sa);this.nE?this.SG.ML(this,this.Sb,this.lTa?this.lTa.ZT:this.wPg,this.GG):this.Rb.oQa();Sa&&(this.Zn.style.visibility=L?"visible":"hidden",ba&&this.Zd.yQi(this.GG,L))}Gae(){return this.Zd.csa(this.GG)}fAa(){this.Uo(!1);this.Kp.lK().Ma(Hh.a.$Oc,2,this.GG);this.Gae()||this.dispose();return!0}sAa(L,ba,Sa,sb,Tb,Tc){const Vb=re.a.FB();Vb.alt=Tb;Vb.className=hm.getImageClassWithCluster(L,sb);Vb.src=this.Qd.rk(L+
".png");Vb.setAttribute("Unselectable","on");L=re.a.tn();L.className=ba+" cui-img-cont-float";L.appendChild(Vb);ba=re.a.tn();ba.className=Sa;ba.setAttribute("Unselectable","on");ba.appendChild(L);Sa=re.a.Raa();Sa.className="CommentPaneNoBorderButton cui-ctl";Sa.title=Tb;Sa.setAttribute(rd.a.ff,rd.a.St);Sa.tabIndex=0;Sa.appendChild(ba);Tc&&(Tb=re.a.tn(),Tb.className="cui-ctl-mediumlabel",Tb.setAttribute("Unselectable","on"),Tb.innerText=Tc,Sa.appendChild(Tb));return Sa}tAa(L,ba){return this.sAa(L,
"cui-img-16by16","cui-ctl-iconContainer",ba,CommonUIStrings.l_DialogClose,null)}shg(L){L.keyCode===eh.a.Xp||L.keyCode===eh.a.wO?(this.fAa(null),L.preventDefault(),L.stopPropagation()):L.keyCode===eh.a.tq&&(L.shiftKey?this.Zd.notifyAgave(this.GG,12):this.Zd.notifyAgave(this.GG,11),L.preventDefault(),L.stopPropagation())}get isVisible(){return this.Sb}get za(){return this.xb}get order(){return 6}get width(){return this.isVisible?this.SWj:0}get iAc(){return this.rN}get Gmi(){return this.Zn}get id(){return this.GG}}
Object(h.a)(Mf,"AddInPane",null,[1085,454,109]);class im{constructor(L,ba,Sa,sb,Tb,Tc,Vb,Ed,ae,Rd){this.Kp=L;this.Rb=ba;this.Az=Sa;this.jd=sb;this.Qd=Tb;this.XZ=Tc;this.Zd=Vb;this.Oc=Ed;this.hc=ae;this.SG=Rd}wEc(L,ba,Sa,sb,Tb){return new Mf(L,ba,this.Kp,Sa,sb,this.Rb,this.Az,this.jd,this.Qd,this.XZ,this.Zd,this.Oc,this.hc,this.SG,Tb)}M1(L){return new bg.a(L)}aui(L){return new Oi(this.Zd,this.Kp,this.Rb,L,this.Az)}iOd(L,ba,Sa,sb,Tb){return new uk(L,ba,Sa,sb,Tb)}}Object(h.a)(im,"AppforOfficeClassFactory",
null,[1047]);class $b{constructor(L){this.aFg=this.iQ=!1;this.tm=Ij.a.KX();this.GBg=L;Rf.HFk(this.GBg)}qv(){this.aFg=!0}dispose(){if(this.aFg&&!this.iQ){var L=Ij.a.KX();Rf.GFk(this.GBg,this.tm,L);this.iQ=!0}}}Object(h.a)($b,"ApiCallLogger",null,[109]);class Cf{get formatting(){return 0}set formatting(L){}get sourceSlideIds(){return null}set sourceSlideIds(L){}get targetSlideId(){return null}set targetSlideId(L){}getTypeName(){return"Microsoft.Office.PowerPoint.InsertSlideOptions"}invokePropertyGet(L){switch(L){case 1:return this.formatting;
case 4:return this.sourceSlideIds;case 5:return this.targetSlideId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,ba){switch(L){case 1:this.formatting=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"int");return;case 4:this.sourceSlideIds=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"Array<string>");
return;case 5:this.targetSlideId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}
Object(h.a)(Cf,"InsertSlideOptions",null,[]);class Kc{constructor(){this.controlId=this.appId=null}}Object(h.a)(Kc,"RequestContext",null,[]);class kf{constructor(){this.Juf=this.Obf=null}get layoutId(){return this.Obf}set layoutId(L){this.Obf=L}get slideMasterId(){return this.Juf}set slideMasterId(L){this.Juf=L}getTypeName(){return"Microsoft.Office.PowerPoint.AddSlideOptions"}invokePropertyGet(L){switch(L){case 1:return this.layoutId;case 2:return this.slideMasterId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,ba){switch(L){case 1:this.layoutId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"string");return;case 2:this.slideMasterId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}Object(h.a)(kf,"AddSlideOptions",null,[]);class Gl{constructor(L,ba,Sa){this.f6b=L;this.Y7=ba;this.Zd=Sa}getAppRuntimeStartState(){if(!this.Zd.csa(this.Y7))throw Error.invalidOperation("GetAppRuntimeStartState: Invalid controlId or it is not shared runtime.");return this.Zd.tVi(this.f6b)?1:0}setAppRuntimeStartState(L){if(!this.Zd.csa(this.Y7)||0!==L&&1!==L)throw Error.invalidOperation("SetAppRuntimeStartState: Invalid controlId or state, or it is not shared runtime.");
this.Zd.mol(this.f6b,1===L)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,
ba){switch(L){case 2:return this.kWi();case 1:return this.WYk(ba)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}kWi(){return this.getAppRuntimeStartState()}WYk(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");this.setAppRuntimeStartState(L);return null}}Object(h.a)(Gl,"AppRuntimePersistenceService",null,[]);class Mj{constructor(L,
ba){this.Y7=L;this.Zd=ba}getAppRuntimeState(){if(!this.Zd.csa(this.Y7))throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or it is not shared runtime.");return this.Zd.sVi(this.Y7)?2:1}setAppRuntimeState(L){if(!this.Zd.csa(this.Y7)||2!==L&&1!==L)throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or state, or it is not shared runtime.");this.Zd.yFb(this.Y7,2===L)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ba){switch(L){case 2:return this.lWi();case 1:return this.XYk(ba)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,
ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}lWi(){return this.getAppRuntimeState()}XYk(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");this.setAppRuntimeState(L);return null}}Object(h.a)(Mj,"AppRuntimeService",null,[]);class Zf{insertHyperLink(){}insertSlideFromContent(){return 0}getTypeName(){return"Microsoft.Office.PowerPoint.Application"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ba){switch(L){case 1001:return this.lxj(ba);case 1002:return this.Lxj(ba)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}lxj(L){const ba=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"string");this.insertHyperLink(ba,L);return null}Lxj(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.insertSlideFromContent(L)}}Object(h.a)(Zf,"Application",null,[]);class Hg{constructor(L,
ba){this.NF=!1;this._id=L;this.Gyd=ba}get enabled(){return this.NF}set enabled(L){this.NF=L;A.AFrameworkApplication.Va.Ma(ie.a.uYb,2,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.Gyd,["SourceControlId"]:this.id,["MethodData"]:this.enabled})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(L){switch(L){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,ba){switch(L){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ba){switch(L){case 5:return this.m_k(ba);
case 1:return this.gH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}m_k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"boolean");this.setEnabled(L);return null}gH(){this._OnAccess();return null}}Object(h.a)(Hg,"RibbonButton",null,[]);class jm{constructor(L){this._id=L}get id(){return null}setVisibility(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(L){switch(L){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ba){switch(L){case 3:return this.g4k(ba);case 1:return this.gH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,
ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}g4k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"boolean");this.setVisibility(L);return null}gH(){this._OnAccess();return null}}Object(h.a)(jm,"RibbonTab",null,[]);class aa{constructor(L,ba){this.PJa=this.cR=this.Juc=null;this.Kpc=L;this.EZa=ba;ia.a.Xa(this.Kpc)||(this.PJa=ba.qrb(L),this.Juc=(this.cR=this.EZa?this.EZa.Ko:null)?this.cR.getOsfControl(this.Kpc):null)}get buttons(){return null}executeRequestCreate(){return null}executeRequestUpdate(){return null}getButton(L){let ba=
null;if(!this.Jrg())return this.GQf();if(!ia.a.Xa(L)&&this.PJa&&this.PJa.taskpane){if(!this.TLf(L))return this.SQf(L);ba=new Hg(L,this.PJa.taskpane.ownerAddinSolutionId)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ba)}getTab(L){let ba=null;if(!this.Jrg())return this.GQf();if(!ia.a.Xa(L)&&this.PJa&&this.PJa.taskpane){if(!this.TLf(L))return this.SQf(L);ba=new jm(L)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ba)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(L){switch(L){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 1:return this.gH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){switch(L){case 7:return this.OLi(ba);
case 6:return this.PLi(ba);case 3:return this.aXi(ba);case 5:return this.Dcj(ba)}L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}OLi(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.executeRequestCreate(L)}PLi(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.executeRequestUpdate(L)}aXi(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getButton(L)}Dcj(L){L=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getTab(L)}gH(){this._OnAccess();return null}SQf(L){return this.dRf("ControlIdNotFound",ResourceStrings.L_RichApiErrorMessage_ControlIdNotFound+L)}GQf(){return this.dRf("ApiNotAvailable",ResourceStrings.L_RichApiErrorMessage_ApiNotAvailable)}Jrg(){const L=!ia.a.Xa(this.Juc.getSharedRuntimeId());Ia.a.J(588375632,802,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",L));return L}TLf(L){if(this.Juc){var ba=
this.Juc.getManifest();if(ba&&(ba=ba.getRibbonExtensionControlMap()))return L in ba||this.eji(L)}return!1}eji(L){var ba=this.$Pi();if(ba){ba=ba.GXf;for(const Sa of ba.tabs){if(Sa.id===L)return!0;for(const sb of Sa.groups)for(const Tb of sb.controls){if(Tb.id===L)return!0;if("Menu"===Tb.type){ba=Tb;for(const Tc of ba.items)if(Tc.id===L)return!0}}}}return!1}$Pi(){return M.getInstance().k5a(this.PJa.taskpane.ownerAddinStoreType,this.PJa.taskpane.ownerAddinSolutionId,1)}dRf(L,ba){return OfficeExtension.WacRuntime.Utility.createPromise((Sa,
sb)=>{sb(OfficeExtension.WacRuntime.Utility.createRichApiException(L,ba))})}}Object(h.a)(aa,"DynamicRibbon",null,[]);class bj{constructor(L,ba,Sa,sb){this.GWe="";this.Wqc=0;this.IF=L;this._id=ba;this.bPb=Sa;this.EZa=sb}get id(){return this._id}_RegisterStateChange(){this.Wqc||this.IF.execute(L=>{OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.bPb,this._id,1);this.GWe=L.Xdb(this._id,ba=>{this.EZa.AQi(this.bPb,this._id,JSON.stringify(ba))})});this.Wqc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.Wqc--;
this.Wqc||this.IF.execute(L=>{L.fEb(this._id,this.GWe)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(L){switch(L){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){switch(L){case 6:return this.$Eh();case 7:return this.dFh()}L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}$Eh(){return this._RegisterStateChange()}dFh(){return this._UnregisterStateChange()}}Object(h.a)(bj,"LicenseFeature",
null,[]);class tj{get scopes(){return null}set scopes(L){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(L){switch(L){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,ba){switch(L){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"string");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}Object(h.a)(tj,"MsaDeviceTicketOptions",null,[]);class Vj{constructor(L,ba){this.IF=
nc.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.bPb=L;this.EZa=ba}getFeatureTier(L,ba){return OfficeExtension.WacRuntime.Utility.createPromise(Sa=>{const sb=1===ba?1:2===ba?2:0;this.IF.execute(Tb=>{Tb.getFeatureTier(L,sb).then(Tc=>{Sa(this.Y3i(Tc))},()=>{Sa(ba)})})})}getLicenseFeature(L){L=new bj(this.IF,L,this.bPb,this.EZa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}getMsaDeviceTicket(){return null}isFeatureEnabled(L,ba){return OfficeExtension.WacRuntime.Utility.createPromise(Sa=>
{this.IF.execute(sb=>{sb.isFeatureEnabled(L,ba).then(Tb=>{Sa(Tb)},()=>{Sa(ba)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(L=>{this.IF.execute(ba=>{ba=ba.isFreemiumUpsellEnabled();L(ba)})})}launchUpsellExperience(L){if(this.EZa.Ko.getOsfControl(this.bPb).isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.IF.execute(ba=>{ba.launchUpsellExperience(L)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException("AccessDenied",
"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,
ba){switch(L){case 7:return this.K5i(ba);case 6:return this.bFh(ba)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){switch(L){case 2:return this.Y0i(ba);case 5:return this.X3i(ba);case 1:return this.IDj(ba);case 3:return this.tEj();case 4:return this.RPj(ba)}L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}Y0i(L){const ba=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
1,"int");return this.getFeatureTier(ba,L)}X3i(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getLicenseFeature(L)}K5i(L){const ba=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string"),Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,2,tj);return this.getMsaDeviceTicket(ba,Sa,L)}IDj(L){const ba=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"boolean");return this.isFeatureEnabled(ba,L)}tEj(){return this.isFreemiumUpsellEnabled()}RPj(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.launchUpsellExperience(L)}bFh(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");this._TestFireStateChangedEvent(L);return null}Y3i(L){switch(L){case 1:return 1;case 2:return 2;default:return 0}}}Object(h.a)(Vj,"License",
null,[]);class Xh{get height(){return 0}set height(L){}get left(){return 0}set left(L){}get top(){return 0}set top(L){}get width(){return 0}set width(L){}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeAddOptions"}invokePropertyGet(L){switch(L){case 1:return this.height;case 2:return this.left;case 3:return this.top;case 4:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,
ba){switch(L){case 1:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"number");return;case 2:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"number");return;case 3:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"number");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,
ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}Object(h.a)(Xh,"ShapeAddOptions",null,[]);class hf{constructor(L,ba,Sa){this.cze=!1;this.HEg=!0;this.f6b=L;this.Y7=ba;this.Zd=Sa}hostName(){return"PowerPointOnline"}appId(){return this.f6b}controlId(){return this.Y7}createInstance(L){switch(L){case "Microsoft.Office.PowerPoint.AddSlideOptions":return new kf;
case "Microsoft.Office.PowerPoint.Application":return new Zf;case "Microsoft.Office.PowerPoint.InsertSlideOptions":return new Cf;case "Microsoft.Office.PowerPoint.ShapeAddOptions":return new Xh;case "Microsoft.AppRuntime.AppRuntimeService":return new Mj(this.Y7,this.Zd);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return new Gl(this.f6b,this.Y7,this.Zd);case "Microsoft.Office.Licensing.License":return new Vj(this.Y7,this.Zd);case "Microsoft.DynamicRibbon.DynamicRibbon":return new aa(this.Y7,
this.Zd)}m.ULS.sendTraceTag(588375570,802,10,"Typename: {0} is an invalid parameter. Only instance for Application can be created through this method.",L);return null}static Bq(L){const ba=nc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager").Czf;L||(ba.HEg=!1);return!ba.cze}}Object(h.a)(hf,"RichApiHost",null,[1088]);class gk{constructor(L,ba,Sa){this.wnd=this.Nh=-1;this.mB=Sa;0<=L&&(this.Nh+=L,this.wnd=0<ba?L+ba<this.mB.getCount()?L+ba:this.mB.getCount():this.mB.getCount())}get_current(){return-1<
this.Nh&&this.Nh<this.wnd?this.mB.getItemAt(this.Nh):null}moveNext(){const L=this.Lnl();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}Lnl(){return this.Nh+1<this.wnd?(this.Nh++,!0):!1}}Object(h.a)(gk,"ElementEnumerator",null,[1132]);class Ii{constructor(L,ba){this.aza=L;this.vR=ba}get fill(){hf.Bq(!1);return null}get height(){hf.Bq(!1);return 0}set height(L){hf.Bq(!1)}get id(){const L=new $b(28);try{Ia.a.J(572643292,802,50,"PptApi Call - Shape.GetId");if(!this.aza)return Ia.a.J(577525073,
802,10,"Shape is null."),"";const ba=this.aza.get_shapeId().toString();L.qv();return ba}finally{L&&L.dispose()}}get left(){hf.Bq(!1);return 0}set left(L){hf.Bq(!1)}get lineFormat(){hf.Bq(!1);return null}get name(){hf.Bq(!1);return null}set name(L){hf.Bq(!1)}get tags(){hf.Bq(!1);return null}get textFrame(){hf.Bq(!1);return null}get top(){hf.Bq(!1);return 0}set top(L){hf.Bq(!1)}get type(){hf.Bq(!1);return 0}get width(){hf.Bq(!1);return 0}set width(L){hf.Bq(!1)}deleteObject(){if(hf.Bq(!0)){var L=new $b(45);
try{Ia.a.J(572527067,802,50,"PptApi Call - Shape.Delete");const ba=Object(C.a)(132,this.vR);ba&&(ba.UCi(Object(C.a)(4,this.aza)),L.qv())}finally{L&&L.dispose()}}}getParentSlide(){hf.Bq(!1);return null}getParentSlideLayout(){hf.Bq(!1);return null}getParentSlideLayoutOrNullObject(){hf.Bq(!1);return null}getParentSlideMaster(){hf.Bq(!1);return null}getParentSlideMasterOrNullObject(){hf.Bq(!1);return null}getParentSlideOrNullObject(){hf.Bq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Shape"}invokePropertyGet(L){switch(L){case 11:return this.fill;
case 5:return this.height;case 1:return this.id;case 6:return this.left;case 12:return this.lineFormat;case 7:return this.name;case 3:return this.tags;case 13:return this.textFrame;case 8:return this.top;case 9:return this.type;case 10:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,ba){switch(L){case 5:this.height=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"number");return;case 6:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"number");return;case 7:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"string");return;case 8:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"number");return;case 10:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ba,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 4:return this.FQd();case 15:return this.n7i();case 16:return this.o7i();case 18:return this.p7i();case 17:return this.q7i();case 19:return this.r7i();case 20:return this.s7i();case 2:return this.gH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}FQd(){this.deleteObject();
return null}n7i(){return this.getParentSlide()}o7i(){return this.getParentSlideLayout()}p7i(){return this.getParentSlideLayoutOrNullObject()}q7i(){return this.getParentSlideMaster()}r7i(){return this.getParentSlideMasterOrNullObject()}s7i(){return this.getParentSlideOrNullObject()}gH(){this._OnAccess();return null}}Object(h.a)(Ii,"Shape",null,[]);class nn{constructor(L){this.WMb=this.tlb=null;this.vR=L;if(L=Object(C.a)(132,this.vR))this.tlb=L.xra();this.Ntk()}Ntk(){this.WMb=new ya.ScriptSharpLegacyMap;
if(this.tlb)for(const L of this.tlb){const ba=new Ii(L,this.vR);this.WMb.add(ba.id,ba)}}addGeometricShape(){hf.Bq(!1);return null}addLine(){hf.Bq(!1);return null}addTextBox(){hf.Bq(!1);return null}getCount(){const L=new $b(29);try{Ia.a.J(572643288,802,50,"PptApi Call - ShapeCollection.GetCount");if(!this.tlb)return Ia.a.J(577525071,802,50,"In Shape.GetCount(), _shapes is null"),0;L.qv();return this.tlb.length}finally{L&&L.dispose()}}getItem(L){const ba=new $b(31);try{Ia.a.J(572643289,802,50,"PptApi Call - ShapeCollection.GetItem");
try{const Sa=this.WMb.ga(L);ba.qv();return Sa}catch(Sa){throw Ia.a.J(577525069,802,15,String.format("In Shape.GetItem(id), Exception: {0} ",Sa.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{ba&&ba.dispose()}}getItemAt(L){const ba=new $b(30);try{Ia.a.J(572643290,802,50,"PptApi Call - ShapeCollection.GetItemAt");try{const Sa=this.tlb[L].get_shapeId().toString(),sb=this.WMb.ga(Sa);
ba.qv();return sb}catch(Sa){throw Ia.a.J(577525067,802,15,String.format("In Shape.GetItemAt(index), Exception: {0} ",Sa.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{ba&&ba.dispose()}}getItemOrNullObject(L){const ba=new $b(32);try{Ia.a.J(572643291,802,50,"PptApi Call - ShapeCollection.GetItemOrNullObject");let Sa;({value:Sa}=this.WMb.Nf(L));ba.qv();return Sa}finally{ba&&
ba.dispose()}}_OnAccess(){}getAsyncEnumerator(L,ba){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new gk(L,ba,this))}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ba){switch(L){case 6:return this.iZh(ba);case 7:return this.IZh(ba);case 8:return this.r0h(ba);case 1:return this.R5a();case 2:return this.h6a(ba);case 5:return this.g6a(ba);case 3:return this.i6a(ba);case 4:return this.gH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}iZh(L){const ba=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,Xh);return this.addGeometricShape(ba,L)}IZh(L){const ba=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,Xh);return this.addLine(ba,L)}r0h(L){const ba=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
1,Xh);return this.addTextBox(ba,L)}R5a(){return this.getCount()}h6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItem(L)}g6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");return this.getItemAt(L)}i6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItemOrNullObject(L)}gH(){this._OnAccess();return null}}Object(h.a)(nn,"ShapeCollection",null,[1112]);class Ji{constructor(L){this.Rwc=
L}get id(){const L=new $b(15);try{Ia.a.J(572643276,802,50,"PptApi Call - SlideLayout.GetId");if(!this.Rwc)return Ia.a.J(576581654,802,10,"SlideLayout is null."),"";const ba=this.Rwc.Id.toString();L.qv();return ba}finally{L&&L.dispose()}}get name(){const L=new $b(16);try{Ia.a.J(572643277,802,50,"PptApi Call - SlideLayout.GetName");if(!this.Rwc)return Ia.a.J(576581655,802,10,"SlideLayout is null."),"";const ba=this.Rwc.Name;L.qv();return ba}finally{L&&L.dispose()}}get shapes(){hf.Bq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayout"}invokePropertyGet(L){switch(L){case 1:return this.id;
case 3:return this.name;case 4:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 2:return this.gH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}gH(){this._OnAccess();return null}}Object(h.a)(Ji,"SlideLayout",null,[]);class Sl{constructor(L){this.XMb=null;this.MQb=L;this.Otk()}Otk(){this.XMb=new ya.ScriptSharpLegacyMap;if(this.MQb)for(const L of this.MQb){const ba=new Ji(L);this.XMb.add(ba.id,ba)}}getCount(){const L=new $b(17);try{Ia.a.J(572643272,802,50,"PptApi Call - SlideLayoutCollection.GetCount");if(!this.MQb)return Ia.a.J(576581651,
802,50,"In SlideLayouts.GetCount(), _slideLayouts is null"),0;L.qv();return this.MQb.length}finally{L&&L.dispose()}}getItem(L){const ba=new $b(19);try{Ia.a.J(572643273,802,50,"PptApi Call - SlideLayoutCollection.GetItem");try{const Sa=this.XMb.ga(L);ba.qv();return Sa}catch(Sa){throw Ia.a.J(576581652,802,15,String.format("In SlideLayout.GetItem(id), Exception: {0} ",Sa.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{ba&&ba.dispose()}}getItemAt(L){const ba=new $b(18);try{Ia.a.J(572643274,802,50,"PptApi Call - SlideLayoutCollection.GetItemAt");try{const Sa=this.XMb.ga(this.MQb[L].Id.toString());ba.qv();return Sa}catch(Sa){throw Ia.a.J(576581653,802,15,String.format("In SlideLayouts.GetItemAt(index), Exception: {0} ",Sa.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{ba&&ba.dispose()}}getItemOrNullObject(L){const ba=new $b(20);try{Ia.a.J(572643275,802,50,"PptApi Call - SlideLayoutCollection.GetItemOrNullObject");let Sa;({value:Sa}=this.XMb.Nf(L));ba.qv();return Sa}finally{ba&&ba.dispose()}}_OnAccess(){}getAsyncEnumerator(L,ba){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new gk(L,ba,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayoutCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ba){switch(L){case 1:return this.R5a();case 2:return this.h6a(ba);case 3:return this.g6a(ba);case 4:return this.i6a(ba);case 5:return this.gH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}R5a(){return this.getCount()}h6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItem(L)}g6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");return this.getItemAt(L)}i6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItemOrNullObject(L)}gH(){this._OnAccess();return null}}
Object(h.a)(Sl,"SlideLayoutCollection",null,[1112]);class wm{constructor(L){this.Dlb=L}get id(){const L=new $b(21);try{Ia.a.J(572643269,802,50,"PptApi Call - SlideMaster.GetId");if(!this.Dlb)return Ia.a.J(576581648,802,10,"SlideMaster is null."),"";const ba=this.Dlb.Id.toString();L.qv();return ba}finally{L&&L.dispose()}}get layouts(){const L=new $b(23);try{Ia.a.J(572643270,802,50,"PptApi Call - SlideMaster.GetLayouts");if(!this.Dlb)return Ia.a.J(576581649,802,10,"SlideMaster is null."),null;const ba=
new Sl(this.Dlb.ContentMasters);L.qv();return ba}finally{L&&L.dispose()}}get name(){const L=new $b(22);try{Ia.a.J(572643271,802,50,"PptApi Call - SlideMaster.GetName");if(!this.Dlb)return Ia.a.J(576581650,802,10,"SlideMaster is null."),"";const ba=this.Dlb.Name;L.qv();return ba}finally{L&&L.dispose()}}get shapes(){hf.Bq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMaster"}invokePropertyGet(L){switch(L){case 1:return this.id;case 3:return this.layouts;case 4:return this.name;
case 5:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 2:return this.gH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}gH(){this._OnAccess();return null}}Object(h.a)(wm,"SlideMaster",null,[]);class Xi{constructor(L,ba){this.vR=L;this.Hya=ba}get id(){const L=new $b(5);try{Ia.a.J(572643283,802,50,"PptApi Call - Slide.GetId");if(!this.vR)return Ia.a.J(587747398,802,10,"Slide is null."),"";const ba=this.vR.Cb.toString();L.qv();return ba}finally{L&&L.dispose()}}get layout(){const L=new $b(9);try{Ia.a.J(572643284,
802,50,"PptApi Call - Slide.GetLayout");const ba=this.Hya.l9;for(let Sa=0;Sa<ba.length;Sa++){const sb=ba[Sa].ContentMasters;for(let Tb=0;Tb<sb.length;Tb++)if(this.vR.Tn===sb[Tb].Id){const Tc=new Ji(sb[Tb]);L.qv();return Tc}}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a Layout.");}finally{L&&L.dispose()}}get shapes(){const L=new $b(6);try{Ia.a.J(572643285,802,50,"PptApi Call - Slide.GetShapes");
const ba=new nn(this.vR);L.qv();return ba}finally{L&&L.dispose()}}get slideMaster(){const L=new $b(8);try{Ia.a.J(572643286,802,50,"PptApi Call - Slide.GetSlideMaster");const ba=this.Hya.l9;for(let Sa=0;Sa<ba.length;Sa++)if(this.vR.vj===ba[Sa].Id){const sb=new wm(ba[Sa]);L.qv();return sb}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a SlideMaster.");}finally{L&&L.dispose()}}get tags(){hf.Bq(!1);return null}deleteObject(){if(hf.Bq(!0)){var L=
new $b(7);try{Ia.a.J(572643287,802,50,"PptApi Call - Slide.Delete"),this.Hya.LM(this.vR),L.qv()}finally{L&&L.dispose()}}}setSelectedShapes(){hf.Bq(!1)}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Slide"}invokePropertyGet(L){switch(L){case 1:return this.id;case 5:return this.layout;case 4:return this.shapes;case 6:return this.slideMaster;case 7:return this.tags}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ba){switch(L){case 3:return this.FQd();case 8:return this.v2k(ba);case 2:return this.gH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){L=this.invokeMethod(L,
ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}FQd(){this.deleteObject();return null}v2k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"Array<string>");this.setSelectedShapes(L);return null}gH(){this._OnAccess();return null}}Object(h.a)(Xi,"Slide",null,[]);class Xe{constructor(L){this.YMb=null;this.Hya=L;this.Elb=this.Hya.slides;this.Ptk()}Ptk(){this.YMb=new ya.ScriptSharpLegacyMap;if(this.Elb)for(const L of this.Elb){const ba=new Xi(L,this.Hya);this.YMb.add(ba.id,
ba)}}j_i(){return 0<this.getCount()?this.Elb[this.getCount()-1]:null}p_i(L){return L?L.vj:this.Hya.l9[0].Id}l_i(L){const ba=this.Hya.l9;for(let Sa=0;Sa<ba.length;Sa++)if(L===ba[Sa].Id)return ba[Sa].ContentMasters[0].Id;return 0}add(L){if(hf.Bq(!0)){var ba=new $b(10);try{Ia.a.J(572643278,802,50,"PptApi Call - SlideCollection.Add");const Sa=this.j_i();let sb=0;sb=L&&L.slideMasterId?parseInt(L.slideMasterId):this.p_i(Sa);let Tb=0;Tb=L&&L.layoutId?parseInt(L.layoutId):this.l_i(sb);this.Hya.ezc(Sa,null,
sb,Tb);ba.qv()}finally{ba&&ba.dispose()}}}getCount(){const L=new $b(11);try{Ia.a.J(572643279,802,50,"PptApi Call - SlideCollection.GetCount");if(!this.Elb)return Ia.a.J(587747396,802,50,"In Slides.GetCount(), _slides is null"),0;L.qv();return this.Elb.length}finally{L&&L.dispose()}}getItem(L){const ba=new $b(13);try{Ia.a.J(572643280,802,50,"PptApi Call - SlideCollection.GetItem");try{const Sa=this.YMb.ga(L);ba.qv();return Sa}catch(Sa){throw Ia.a.J(587747394,802,15,String.format("In Slide.GetItem(id), Exception: {0} ",
Sa.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{ba&&ba.dispose()}}getItemAt(L){const ba=new $b(12);try{Ia.a.J(572643281,802,50,"PptApi Call - SlideCollection.GetItemAt");try{const Sa=this.YMb.ga(this.Elb[L].Cb.toString());ba.qv();return Sa}catch(Sa){throw Ia.a.J(587747392,802,15,String.format("In Slide.GetItemAt(index), Exception: {0} ",Sa.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItemAt(index)");}}finally{ba&&ba.dispose()}}getItemOrNullObject(L){const ba=new $b(14);try{Ia.a.J(572643282,802,50,"PptApi Call - SlideCollection.GetItemOrNullObject");let Sa;({value:Sa}=this.YMb.Nf(L));ba.qv();return Sa}finally{ba&&ba.dispose()}}_OnAccess(){}getAsyncEnumerator(L,ba){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new gk(L,ba,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ba){switch(L){case 6:return this.GZh(ba);case 1:return this.R5a();case 5:return this.h6a(ba);case 2:return this.g6a(ba);case 3:return this.i6a(ba);
case 4:return this.gH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}GZh(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,kf);this.add(L);return null}R5a(){return this.getCount()}h6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItem(L)}g6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
0,"int");return this.getItemAt(L)}i6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItemOrNullObject(L)}gH(){this._OnAccess();return null}}Object(h.a)(Xe,"SlideCollection",null,[1112]);class Qm{constructor(L){this.ZMb=null;this.NQb=L;this.Qtk()}Qtk(){this.ZMb=new ya.ScriptSharpLegacyMap;if(this.NQb)for(const L of this.NQb){const ba=new wm(L);this.ZMb.add(ba.id,ba)}}getCount(){const L=new $b(24);try{Ia.a.J(572643265,802,50,"PptApi Call - SlideMasterCollection.GetCount");
if(!this.NQb)return Ia.a.J(576581645,802,50,"In SlideMasters.GetCount(), _slideMasters is null"),0;L.qv();return this.NQb.length}finally{L&&L.dispose()}}getItem(L){const ba=new $b(26);try{Ia.a.J(572643266,802,50,"PptApi Call - SlideMasterCollection.GetItem");try{const Sa=this.ZMb.ga(L);ba.qv();return Sa}catch(Sa){throw Ia.a.J(576581646,802,15,String.format("In SlideMaster.GetItem(id), Exception: {0} ",Sa.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{ba&&ba.dispose()}}getItemAt(L){const ba=new $b(25);try{Ia.a.J(572643267,802,50,"PptApi Call - SlideMasterCollection.GetItemAt");try{const Sa=this.ZMb.ga(this.NQb[L].Id.toString());ba.qv();return Sa}catch(Sa){throw Ia.a.J(576581647,802,15,String.format("In SlideMasters.GetItemAt(index), Exception: {0} ",Sa.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{ba&&ba.dispose()}}getItemOrNullObject(L){const ba=new $b(27);try{Ia.a.J(572643268,802,50,"PptApi Call - SlideMasterCollection.GetItemOrNullObject");let Sa;({value:Sa}=this.ZMb.Nf(L));ba.qv();return Sa}finally{ba&&ba.dispose()}}_OnAccess(){}getAsyncEnumerator(L,ba){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new gk(L,ba,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMasterCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ba){switch(L){case 1:return this.R5a();case 2:return this.h6a(ba);case 3:return this.g6a(ba);case 4:return this.i6a(ba);case 5:return this.gH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}R5a(){return this.getCount()}h6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItem(L)}g6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");return this.getItemAt(L)}i6a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItemOrNullObject(L)}gH(){this._OnAccess();return null}}
Object(h.a)(Qm,"SlideMasterCollection",null,[1112]);class Rm{constructor(L){this.Ez=new Kc;this.Wca=L.presentation}get context(){return this.Ez}get slideMasters(){const L=new $b(2);try{Ia.a.J(572643293,802,50,"PptApi Call - Presentation.GetSlideMasters");const ba=new Qm(this.Wca.l9);L.qv();return ba}finally{L&&L.dispose()}}get slides(){const L=new $b(3);try{Ia.a.J(572643294,802,50,"PptApi Call - Presentation.GetSlides");const ba=new Xe(this.Wca);L.qv();return ba}finally{L&&L.dispose()}}get tags(){hf.Bq(!1);
return null}get title(){const L=new $b(4);try{return Ia.a.J(572643295,802,50,"PptApi Call - Presentation.GetTitle"),L.qv(),"This is the title property"}finally{L&&L.dispose()}}getSelectedShapes(){hf.Bq(!1);return null}getSelectedSlides(){hf.Bq(!1);return null}getSelectedTextRange(){hf.Bq(!1);return null}getSelectedTextRangeOrNullObject(){hf.Bq(!1);return null}insertSlidesFromBase64(){hf.Bq(!1)}setSelectedSlides(){hf.Bq(!1)}_RegisterEvent(L,ba){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,
L,ba)}_UnregisterEvent(L,ba){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,L,ba)}getTypeName(){return"Microsoft.Office.PowerPoint.Presentation"}invokePropertyGet(L){switch(L){case 3:return this.slideMasters;case 2:return this.slides;case 4:return this.tags;case 1:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,ba){this.invokePropertySet(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ba){switch(L){case 5:return this.A$i();case 6:return this.C$i();case 7:return this.H$i();case 9:return this.I$i();case 1003:return this.Mxj(ba);case 8:return this.w2k(ba);case 1001:return this.ZEh(ba);case 1002:return this.cFh(ba)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ba){L=this.invokeMethod(L,ba);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}A$i(){return this.getSelectedShapes()}C$i(){return this.getSelectedSlides()}H$i(){return this.getSelectedTextRange()}I$i(){return this.getSelectedTextRangeOrNullObject()}Mxj(L){const ba=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,Cf);this.insertSlidesFromBase64(ba,L);return null}w2k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"Array<string>");this.setSelectedSlides(L);return null}ZEh(L){const ba=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"int");this._RegisterEvent(ba,L);return null}cFh(L){const ba=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"int");this._UnregisterEvent(ba,L);return null}}Object(h.a)(Rm,"Presentation",null,[]);class qd{create(L){return new Rm(L)}}Object(h.a)(qd,"PresentationFactory",null,[1053]);class il{create(L,ba,Sa){return new hf(L,ba,Sa)}}Object(h.a)(il,"RichApiHostFactory",null,[1049]);class Sm{constructor(L){this.xb=document.createElement("div");this.xb.className="AddinPaneFrame";
this.Az=L}dispose(){}layout(L,ba){this.Az.value.ekj(L,ba);return L}get isVisible(){return!1}get za(){return this.xb}get order(){return 13}}Object(h.a)(Sm,"AddinPaneFrame",null,[1025,454,109]);class Vk{constructor(){this.Z9a=this.BXc=this.K=this.Zd=this.sI=null;this.nE=!!A.AFrameworkApplication.Ba&&!!A.AFrameworkApplication.Ba.jb&&A.AFrameworkApplication.Ba.jb.NV}get name(){return"PowerPointWebEditor.AppForOffice"}Yb(L){this.sI=L.resolve("Common.AFrameworkApplication");this.K=L;this.K.register(jd,
"PowerPointWebEditor.AppForOfficeApi.GetDocumentCopyHelper").as("PowerPointWebEditor.IGetDocumentCopyHelper").na(()=>new jd).ma();this.K.register(sg,"PowerPointWebEditor.AppForOfficeFocusManager").as("PowerPointWebEditor.IAppForOfficeFocusManager").na(()=>new sg(this.K.resolve("PowerPointWebEditor.IAddinPaneFrame").za,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.qe("PowerPointWebEditor.IAppForOfficeManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"))).ma();this.K.register(Id,"PowerPointWebEditor.AppForOfficeContentAppsContainer").as("PowerPointWebEditor.IAppForOfficeContentAppsContainer").na(()=>new Id(this.K.resolve("PowerPointWebEditor.IPPTZoomManager"),this.K.resolve("Box4.IPageView").container,this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"))).ma();this.K.register(pg,"PowerPointWebEditor.AppForOfficeManager").as("PowerPointWebEditor.IAppForOfficeManager").na(()=>new pg(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.IFrameContext"),new Hd,this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer"),this.K.qe("PowerPointWebEditor.IClassFactory"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),new I,Q.getInstance(),this.K.qe("PowerPointWebEditor.IAppforOfficeClassFactory"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IGetDocumentCopyHelper"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory"),this.K.resolve("Common.App.OAuth.IOAuthManager"))).ma();const ba=new v;this.K.register(kg,"PowerPointWebEditor.AddinCommandsManager").as("PowerPointWebEditor.IAddinCommandsManager").na(()=>
new kg(this.sI,this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),ba,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),new Lg,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("Common.IRibbonExternal"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.K.register($g,"PowerPointWebEditor.ContextMenuExtensibilityHandler").as("PowerPointWebEditor.IContextMenuExtensibilityHandler").na(()=>
new $g(ba)).ma();this.K.register(Fh,"PowerPointWebEditor.AppForOfficeListenerManager").as("PowerPointWebEditor.IAppForOfficeListenerManager").na(()=>new Fh(this.hUi())).ma();this.K.register(im,"PowerPointWebEditor.AppforOfficeClassFactory").as("PowerPointWebEditor.IAppforOfficeClassFactory").na(()=>new im(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager"))).ma();this.K.register(il,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").na(()=>new il).ma();
this.K.register(qd,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").na(()=>new qd).ma();this.K.register(1025,"PowerPointWebEditor.IAddinPaneFrame").ma().na(()=>new Sm(this.K.qe("PowerPointWebEditor.IAppForOfficeFocusManager")));this.K.register(1026,"PowerPointWebEditor.IAppForOfficeAuthFactory").ma().na(()=>new Qf)}init(){A.AFrameworkApplication.MAa||this.K.resolve("Common.IAppSettingsManager").gf(Object(H.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){this.Zd=
this.K.resolve("PowerPointWebEditor.IAppForOfficeManager");this.Zd.CVb=!0;A.AFrameworkApplication.fa.ka("OcpsIsEnabled")?this.K.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(L=>{L.isFeatureEnabled(Vk.g3j,!0).then(ba=>{this.Zd.CVb=ba;this.wtb();return null})}):this.wtb()}wtb(){this.K.resolve("PowerPointWebEditor.IAddinCommandsManager");this.K.resolve("PowerPointWebEditor.IAppForOfficeAuthFactory");this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").zCe();
this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer").initialize();const L=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");L.cml();L.dml();L.lij();this.aol();this.Luj();this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").dispose();this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").dispose()}Luj(){const L=this.K.resolve("PowerPointWebEditor.IAddinPaneFrame");
this.nE||this.K.resolve("PowerPointWebEditor.IPaneManager").wM(L);const ba=this.K.resolve("PowerPointWebEditor.IFocusManager"),Sa=this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager");ba.o7(ze.a.Gza,ze.a.kj,L,!Sa.d3d());this.sI.Uq.Mq()}hUi(){const L=[];var ba=[];ba.push(this.K.resolve("Box4.Graph.IGraphInstance").Cd(47));ba.push(this.K.resolve("Box4.Graph.IGraphInstance").Cd(10));ba=new Rn(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),ba,this.K.resolve("Box4.Graph.IGraphIteratorFactory"));
L.push(ba);ba=new ul(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(49),this.K.resolve("Box4.Graph.IGraphIteratorFactory"));L.push(ba);ba=new Kf(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"));L.push(ba);ba=new ek(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.Graph.IGraphInstance").Cd(47));L.push(ba);ba=new Xf(this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"));L.push(ba);return L}aol(){this.Z9a=A.AFrameworkApplication.fa.Ia("DevAddinManifestFileUrl");this.BXc=A.AFrameworkApplication.fa.Ia("DevAddinManifestGuid");var L=A.AFrameworkApplication.fa.Ia("IsDevAddinTest");if(this.Z9a&&this.BXc&&L)if(L="true"===L,x.a.instance.getItem("optedIntoAddinDeveloperMode")||
L&&A.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))if(x.a.instance.getItem(this.BXc)||L&&A.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))this.Zd.Ko.validateAndCacheNewDevAddinManifest(this.Z9a);else{L=new y.StandardDialog;L.vd=4;const ba=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.Z9a)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;L.nO(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,
ba,Object(H.a)(this,this.W$g,"registerDevAddinManifestHandler"))}else L=Object(H.a)(this,this.W$g,"registerDevAddinManifestHandler"),L=new Wc(this.Z9a,L),L.vd=0,L.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage)}W$g(L){1===L&&this.Z9a&&this.iIk()}iIk(){this.Zd&&(this.Zd.Ko.validateAndCacheNewDevAddinManifest(this.Z9a),x.a.instance.setItem(this.BXc,"true"))}static main(){u.a.instance.Ec(new Vk)}}Vk.g3j=
"mso_officeStore";Object(h.a)(Vk,"AppForOfficePackage",null,[2,3]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("OSF");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AppForOfficeApi");Type.registerNamespace("CommandUI.AddInCommands");Vk.main()},537:function(J,V,d){d.r(V);J=d(0);var h=d(17),e=d(374),m=d(67);class r{constructor(){this.startTime=0;this.callback=null}}Object(J.a)(r,"SSOCallbackInfo",null,[]);class v{constructor(){this.accessToken=
null}}Object(J.a)(v,"AccessTokenInformation",null,[1156]);var A=d(965);class x{constructor(){this.token=null;this.expiresOn=0;this.Pza=this.SU=null}}Object(J.a)(x,"CachedTokenInfo",null,[]);class y{constructor(){this.dpc=new h.a;this.upa=this.tpa=!1;this.dJa=this.SU=null;this.startTime=this.retryCount=0;this.QCf=null}get GKd(){return this.dpc}}Object(J.a)(y,"SSORequestInfo",null,[]);class u extends y{constructor(){super();this.errorCode=0}}Object(J.a)(u,"SSOFailedRequestInfo",y,[]);var H=d(25);class G{constructor(ca,
P,ea,da){this.Z5=new h.a;this.iR=new h.a;this.YJa=null;this.MPb=new h.a;this.Ebf=Promise.resolve(null);this.suf=!1;this.jSh=P;this.Kpc=ca;this.rvf=ea;this.yFh=da}C7k(ca){if(this.YJa&&this.YJa.SU===ca.SU){if(Date.now()/1E3+G.b$j>this.YJa.expiresOn)return this.YJa=null,!1;ca=new A.a;ca.token=this.YJa.token;ca.expiresOn=this.YJa.expiresOn;ca.Pza=this.YJa.Pza;ca.ahb=!0;ca.C0b=0;this.l1b(ca);return!0}return!1}f6k(ca){for(let P=0;P<this.iR.count;P++)if(this.iR.ga(P).SU===ca.SU&&this.iR.ga(P).dJa===ca.dJa){let ea;
(ea=this.iR.ga(P)).retryCount=ea.retryCount+1;ca.retryCount=this.iR.ga(P).retryCount;if(this.iR.ga(P).retryCount<G.MAb||!this.iR.ga(P).tpa&&ca.tpa||!this.iR.ga(P).upa&&ca.upa){if(!this.iR.ga(P).tpa&&ca.tpa||!this.iR.ga(P).upa&&ca.upa)ca.retryCount=0;this.iR.removeAt(P);break}ca=new A.a;ca.errorCode=this.iR.ga(P).errorCode;this.l1b(ca);return!0}return!1}x0h(ca,P){for(let ea=0;ea<this.iR.count;ea++)if(this.iR.ga(ea).dJa===ca.dJa&&this.iR.ga(ea).SU===ca.SU)return;this.iR.add(Object.assign(new u,{tpa:ca.tpa,
upa:ca.upa,SU:ca.SU,dJa:ca.dJa,errorCode:P,retryCount:ca.retryCount}))}get resource(){return this.jSh}KWd(ca,P,ea,da,ia,C){const {AppsForOfficeSingleSignOnManager:oa}=d(537);""===ea&&(ea=null);if(this.suf)oa.oja(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var Z=null;for(let pa of this.Z5)if(pa.tpa===ca&&pa.upa===P&&pa.SU===ea&&pa.dJa===ia){Z=pa;break}Z||(Z=Object.assign(new y,{tpa:ca,upa:P,SU:ea,QCf:da,dJa:ia,retryCount:0,startTime:oa.LE()}),this.Z5.add(Z));Z.retryCount=
0;Z.GKd.add(C);this.Ebf=this.Ebf.then(()=>{var {AppsForOfficeSingleSignOnManager:pa}=d(537);if(0<this.Z5.count){var ya=this.Z5.ga(0);if(this.C7k(ya)||this.f6k(ya))return null;for(let Ka=0;Ka<this.MPb.count;)this.MPb.ga(Ka)+G.hjl<pa.LE()?this.MPb.removeAt(Ka):Ka++;if(this.MPb.count>=G.r$j||this.Z5.count>=G.Z9j)return ya=new A.a,ya.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.l1b(ya),null;let Ja=null;H.AFrameworkApplication.Ba&&(pa=H.AFrameworkApplication.Ba.aU)&&(Ja=pa.wi("ComponentAttach",
this.Kpc+G.yUh));return ya.dJa.pXh(this.resource,ya.tpa,ya.upa,ya.SU,this.yFh,ya.QCf).then(Ka=>{Ja&&Ja.stop();this.l1b(Ka)},()=>{Ja&&Ja.stop();const Ka=new A.a;Ka.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.l1b(Ka)})}return null})}}l1b(ca){const {AppsForOfficeSingleSignOnManager:P}=d(537);try{if(this.Z5.count){var ea=this.Z5.ga(0);this.Z5.removeAt(0);var da=null;ca.errorCode||(da=new v,da.accessToken=ca.token);ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&
ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.x0h(ea,ca.errorCode);var ia={};null!=ca.C0b&&(ia.getTokenSilentTime=ca.C0b.toString());null!=ca.x1d&&(ia.getTokenPopupTime=ca.x1d.toString());null!=ca.bZd&&(ia.getIDTokenTime=ca.bZd.toString());null!=ca.ahb&&(ia.tokenCached=ca.ahb.toString());ca.xOe&&(ia.detailedError=ca.xOe);ca.Pza&&
(ia.authLibrary=ca.Pza);ea.retryCount&&(ia.retryCount=ea.retryCount);for(var C of ea.GKd)P.oja(C,ca.errorCode,da,ia);null!=ca.ahb&&ca.ahb||this.MPb.add(ea.startTime);if(!ca.errorCode)for(null!=ca.expiresOn&&(this.YJa=Object.assign(new x,{token:ca.token,expiresOn:ca.expiresOn,SU:ea.SU,Pza:ca.Pza})),this.iR.clear(),C=0;C<this.Z5.count;)if(this.Z5.ga(C).SU===ea.SU){for(let oa of this.Z5.ga(C).GKd)P.oja(oa,ca.errorCode,da,ia);this.Z5.removeAt(C)}else C++}}catch(oa){e.ULS.sendTraceTag(21628945,344,10,
"ReceivedAccessTokenHandler: exception message: {0}",oa.message)}}shutdown(){this.suf=!0;this.Z5.clear()}}G.hjl=6E4;G.r$j=6;G.Z9j=6;G.MAb=3;G.b$j=300;G.yUh="GetAccessToken";Object(J.a)(G,"SSOCallbackManager",null,[]);var E=d(230),I=d(259),Q=d(168),D=d(82),Y=d(55),M=d(45),N=d(141),W=d(195);d.d(V,"AppsForOfficeSingleSignOnManager",function(){return K});class K{constructor(ca,P,ea=null){this.bib=new m.a;const da=new h.a;P&&da.add(P.t7j);ea&&da.addRange(ea);this.cR=ca;this.FVh=da}removeCallbackForAddin(ca){this.bib.Kb(ca)&&
(this.bib.ga(ca).shutdown(),this.bib.remove(ca))}LWd(ca,P,ea,da,ia,C,oa,Z,pa,ya){ya=Object.assign(new r,{startTime:K.LE(),callback:ya});try{const ma=!!ea&&""!==ea;var Ja=ya.startTime;const ra=this.getOsfControl(ca);let Da=ra.getStoreType()||"",va=ra.getOwnerAddinStoreType()||"",Fa=ra.getSolutionId()||"";const ka=ra.getVersion()||"";Da=Da.toLowerCase();va=va.toLowerCase();Fa=Fa.toLowerCase();var Ka=D.a.FLc(P)||"";const qa=D.a.FLc(ra.getIframeUrl())||"",Ua=Ka.toLowerCase()===qa.toLowerCase();Ka=Da;
"inmemory"===Da&&(Ka=va);const Ya=Telemetry.PrivacyRules.GetPrivacyCompliantId(Fa,Ka,ra.getAssetId(),null,null,ra.getStoreId()),Va={["callInstanceId"]:Ja.toString(),["controlAssetId"]:Ya,["controlVersion"]:ka,["storeType"]:Da,["ownerStoreType"]:va,["allowConsentPrompt"]:da.toString(),["forMSGraphAccess"]:ia.toString(),["allowSignInPrompt"]:C.toString(),["hasAddinAuthChallenge"]:ma.toString(),["securityOriginEqualsSourceLocation"]:Ua.toString(),["singleSignOnEnabled"]:oa.toString(),["accountTypeFilter"]:Z||
""};e.ULS.sendTraceTag(51401115,344,50,"{0}",Va);N.a.sendTelemetryEvent(Object.assign(new W.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:Q.a.bD(Va)}));Ja=!0;const ua=H.AFrameworkApplication.fa.Ia("HostAuthType");switch(Z){case "aad":Ja="aad"===ua;break;case "msa":Ja="msa"===ua;break;default:Ja=!Z||"noFilter"===Z}if(Ja){Z=null;if(oa)for(let Ca of this.FVh)if(Ca.tDj(Fa)){Z=Ca;break}Z?this.isSSOAddin(ca)?(oa=!0,"omex"===Ka&&(oa=!1),"spapp"===Ka||"spcatalog"===Ka?(e.ULS.sendTraceTag(594043737,
344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),K.oja(ya,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):ia&&!oa?(e.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),K.oja(ya,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(ia&&"exchange"===Ka&&(da=!1),this.KWd(ca,P,ea,Ka,da,C,pa,Z,ya))):(e.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),
K.oja(ya,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):K.oja(ya,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else K.oja(ya,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(ma){this.rVc(),e.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",ma.message),K.oja(ya,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(ca,P,ea,da){this.LWd(ca,ea[E.a.HGd]||null,
ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,P,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,da)}KWd(ca,P,ea,da,ia,C,oa,Z,pa){this.bib.Kb(ca)?
da=this.bib.ga(ca):(da=new G(ca,this.getWebApplicationResource(ca).split(",")[0],da,this.getDefaultDisplayName(ca)),this.bib.add(ca,da));const ya=da.resource;ca=K.p9i(ya,this.getWebApplicationId(ca));const Ja=OfficeExt.WACUtils.getHostSecure(P);ca&&Ja?ca.toLowerCase()===Ja.toLowerCase()?da.KWd(ia,C,ea,oa,Z,pa):(K.n9a('SSO Resource "'+ya+'" cannot be used from "'+P+'" origin due to domain mismatch.'),e.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),
K.oja(pa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(ca||e.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Ja||e.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),K.oja(pa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}rVc(){e.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(ca){return this.cR.getOsfControl(ca)}isSSOAddin(ca){return this.getOsfControl(ca).getManifest().isSSOAddin()}getWebApplicationId(ca){return this.getOsfControl(ca).getManifest().getWebApplicationId()}getWebApplicationResource(ca){return this.getOsfControl(ca).getManifest().getWebApplicationResource()}getDefaultDisplayName(ca){return this.getOsfControl(ca).getManifest().getDefaultDisplayName()}static Ocg(){try{const ca=
{};Y.a.yDa&&I.a.l7a&&(ca.UiHostSupportsAuthTokenAddinList=K.hJc);ca.UiHostSupportsAuthToken=I.a.l7a;return ca}catch(ca){e.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",ca.message)}return null}static getInstance(ca,P,ea=null){K.Ka||(K.Ka=new K(ca,ea));return K.Ka}static Uii(ca){K.Ka&&K.Ka.removeCallbackForAddin(ca)}static n9a(ca){window.console.warn&&window.console.warn(ca)}static p9i(ca,P){if(!ca)return"";P||(P="");let ea=ca.toLowerCase();var da=P.toLowerCase();
RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(da)||(K.n9a('SSO App Id "'+P+'" is not a valid format. It will be rejected from store submission.'),e.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));ea.endsWith(da)||(K.n9a('SSO Resource "'+ca+'" does not end with App Id "'+P+'". It will be rejected from store submission.'),e.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!ea.startsWith("https://")&&!ea.startsWith("api://"))return K.n9a('SSO Resource "'+
ca+'" must be https:// or api:// protocol.'),e.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(P=0;P<ca.length;P++){da=ca.charAt(P);const ia=M.a.charCodeAt(ca,P);if(33>ia||126<ia||"&"===da||"?"===da||"#"===da||"%"===da||"\\"===da)return K.n9a('SSO Resource "'+ca+'" contains an invalid character "'+da+'".'),e.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+da+"' in resource URI."),""}if(0<=ca.indexOf("::"))return K.n9a('SSO Resource "'+ca+'" contains an invalid string "::".'),
e.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<ca.length)return K.n9a('SSO Resource "'+ca+'" is '+ca.length+" characters and exceeds the max length of 120 characters."),e.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+ca.length+"."),"";ea.startsWith("api://")&&(ea="https://"+ea.substring(6,ea.length));return 8===ea.length?"":OfficeExt.WACUtils.getHostSecure(ea)||""}static oja(ca,P,ea,da){var ia=ca.startTime;let C=0;0<ia&&(C=K.LE()-ia);ia={["callInstanceId"]:ia.toString(),
["callDuration"]:C.toString(),["errorCode"]:P.toString()};if(da)for(let oa in da)ia[oa]=da[oa];e.ULS.sendTraceTag(51401116,344,50,"{0}",ia);N.a.sendTelemetryEvent(Object.assign(new W.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:Q.a.bD(ia)}));ca.callback(P,ea)}static LE(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(ca){}return Date.now()}}K.hJc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
K.Ka=null;Object(J.a)(K,"AppsForOfficeSingleSignOnManager",null,[1113])},965:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.Pza=this.ahb=this.bZd=this.x1d=this.C0b=this.xOe=null}}Object(J.a)(h,"AppsForOfficeOauthResult",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.appforoffice.js.map