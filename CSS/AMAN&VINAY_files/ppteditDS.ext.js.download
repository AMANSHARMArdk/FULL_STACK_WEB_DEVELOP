'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1001:function(J,V,d){J=d(0);var h=d(132),e=d(82),m=d(1162),r=d(25),v=d(197),A=d(45),x=d(162),y=d(26),u=d(433),H=d(526);class G{constructor(){this.alt=null;this.height=0;this.src=this.alt="";this.width=this.height=0}}Object(J.a)(G,"ImagePasteArgs",null,[]);var E=d(316),I=d(40),Q=d(47),D=d(28);d.d(V,"a",function(){return Y});class Y{constructor(M,N,W,K,ca,P,ea,da,ia,C,oa,Z){this.ia=M;this.Ga=N;this.pFa=W;this.sa=
K;this.j8j=ca;this.oo=P;this.wja=ea;this.we=C;this.Mz=oa;this.zc=Z;this.dIg=da;this.o1j=ia;this.L2c=!1;this.p9b=-1}uP(M){if(!this.pFa.R2b(this.Ga)||!M)return!1;if(M.wIc&&M.C4d)return this.L2c=!1,M.uP=this.dIg;if(!M.Om||0<M.Om.getElementsByTagName(Q.a.Xjg).length)return!1;this.L2c=!this.Joj(M)&&this.lLj(this.sa.he());M.uP=this.L2c?this.o1j:this.dIg;return M.uP}lLj(M){return 1===M.length?M[0].BMj:!1}wyk(M,N){this.a6g(M,N,0);if(!M.firstChild||!M.firstChild.className||!u.a.Ppg(M.firstChild.className))if(!this.oo.ag||
"<br>"!==M.innerHTML){const W=x.b(M);W&&0<W.length&&(N.IX=M.innerHTML)}}a6g(M,N,W){if(M){if(W>=Y.xBc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",Y.xBc));if(1===M.nodeType){var K=M.tagName.toLowerCase();if(this.wja.tJj(K))M.parentNode.removeChild(M);else{for(let P=M.firstChild;P;P=ca){var ca=P.nextSibling;this.a6g(P,N,W+1)}K===Q.a.Lba?(M.parentNode.removeChild(M),this.xyk(M,N)):K===Q.a.OHb?(M.parentNode.removeChild(M),this.czk(M,N)):K===Q.a.listTag&&this.Dyk(M);this.zc.MIe(M,
N.Tb)}}}}Dyk(M){if(M){var N=M.getAttribute("data-"+h.a.kTb);if(N&&0<N.length&&M.style){var W=parseInt(N);if(1!==N.length||isNaN(W)||1>W||W>E.a.s6)N="1",W=1;W>this.p9b&&(this.p9b=W);N=String.format(Q.a.TQj,N);(W=M.style.cssText)?M.setAttribute("style",N+W):M.setAttribute("style",N)}if((N=M.parentNode)&&!this.we.oGj(N.tagName)){W=M.nextSibling;const K=this.we.oWb();K.appendChild(M);N.insertBefore(K,W)}}}xyk(M,N){if(M&&M.src&&M.src.length){var W=window.location.href.toLowerCase();W=e.a.hS(W);if(M.src.startsWith(W))y.a.J(20501650,
826,50,"Pasted image src is an empty string.");else{W=Math.ceil(m.a.Ie(this.wja.N2i(M),0,!1));var K=Math.ceil(m.a.Ie(this.wja.F2i(M),1,!1));N.Jba.push(Object.assign(new G,{src:M.src,alt:M.alt,width:W?W:M.width,height:K?K:M.height}))}}}czk(M,N){M&&M.innerHTML&&M.rows&&M.rows.length&&(M.getElementsByTagName(Q.a.ajd).length||M.getElementsByTagName(Q.a.fhl).length)&&(M=x.c(M),!M||0>=M.length||N.Igb.push(M))}Joj(M){if(M.wIc)return!0;const N=M.Om.getElementsByTagName(Q.a.OHb).length;return 0<M.Om.getElementsByTagName(Q.a.Lba).length||
0<N}paste(M){if(r.AFrameworkApplication.XP)this.j8j.Ckc(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null);else{const N=Object.assign(new H.a,{Tb:M.Tb});let W=!0;N.hkc=this.L2c;if(M.wIc)N.Jba.push(Object.assign(new G,{src:M.C4d,width:0,height:0}));else try{this.wyk(M.Om,N),0<this.p9b&&(y.a.J(21050954,826,50,String.format("max list level pasted into new shape = {0}.",this.p9b-1)),this.p9b=-1)}catch(K){W=!1,y.a.J(23634591,826,15,K.message)}W&&(this.s6k(N)?this.Brk(N):this.ia.Ma(D.a.QGa,
2,N))}}s6k(M){return v.a.Xa(M.Igb)&&A.a.Xa(M.IX)&&!!M.Jba&&1===M.Jba.length&&this.wNj(M.Jba[0].src)}wNj(M){if(A.a.Xa(M)||!M.startsWith("data:image"))return!1;M=M.split(";");if(!M||2!==M.length)return!1;M=M[0].replace("/",".");return 0===this.Mz.rmd(M,!0)}Brk(M){let N=new Image;const W=M.Jba[0],K=I.a.Db;if(W.width&&W.height)M.QSc=!0,this.ia.Ma(D.a.QGa,2,M);else{const ca=new Date;N.onload=()=>{M.gxe=+new Date-+ca;W.width=N.width;W.height=N.height;M.QSc=!0;N=null;I.a.EE(K,()=>{this.ia.Ma(D.a.QGa,2,M)})};
N.onerror=()=>{N=null;I.a.EE(K,()=>{this.ia.Ma(D.a.QGa,2,M)})};N.src=W.src}}}Y.xBc=100;Object(J.a)(Y,"HtmlPasteHandler",null,[422])},1002:function(J,V,d){J=d(0);var h=d(45);class e{constructor(r,v){this.q0j=r;this.n0c=v}get oRa(){return this.q0j}get message(){return this.n0c}}Object(J.a)(e,"CalloutNotificationError",null,[]);d.d(V,"a",function(){return m});class m{constructor(r,v){this.ECg=r;this.h5j=v}wwa(r,v,A,x,y,u,H,G,E,I,Q,D){this.ECg.show(this.h5j,null,!1,E,I,r,v,A,y,x,u,H,G,Q,D)}pRd(){this.ECg.dismiss()}l9k(r){if(!r)throw Error.argumentNull("CalloutNotificationMessageAttributes");
const v=this.bwl(r);if(v&&v.oRa)return v;this.wwa(r.title,r.message,r.tig,r.pDb,r.yig,r.wed,r.Ixk,r.cWk,r.Jxk,r.dWk,!!r.sPe,r.sPe);return new e(!1,null)}bwl(r){return h.a.Xa(r.title)?new e(!0,"Invalid Title"):h.a.Xa(r.message)?new e(!0,"Invalid Message"):r.tig&&h.a.Xa(r.pDb)?new e(!0,"Missing PrimaryButtonLabel"):r.yig&&h.a.Xa(r.wed)?new e(!0,"Missing SecondaryButtonLabel"):new e(!1,null)}}Object(J.a)(m,"CalloutNotificationAdapter",null,[339])},1003:function(J,V,d){J=d(0);var h=d(25),e=d(713),m=d(224);
class r extends e.a{constructor(A,x){super(A);this.pXj=x}lvh(A){return m.i(m.g(A))}yPe(A){return m.i(A)}kmc(A){return this.pXj?A.oai:A.kmc().toString()}Qdi(A,x,y){const u=new Sys.StringBuilder;u.append(String.format('<Menu Id="{0}">',"menuFontColor"));u.append(this.S1d(A,x,y));u.append('<MenuSection Id="More Font Colors"><Controls Id="Color.Menu.Controls">');u.append(String.format('<Button Id="Color.Menu.MoreFontColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />',
"862825906",h.AFrameworkApplication.Rl,ResourceStrings.l_MoreFontColors,ResourceStrings.l_MoreFontColorsKeytip));u.append("</Controls> </MenuSection>");u.append("</Menu>");return u.toString()}}Object(J.a)(r,"ColorMenuBuilder",e.a,[]);d.d(V,"a",function(){return v});class v{jYi(A){return new e.a(A)}$6f(A,x){return new r(A,x)}}Object(J.a)(v,"ColorPickerBuilderFactory",null,[357])},1005:function(J,V,d){J=d(0);var h=d(892),e=d(128);class m extends h.a{constructor(){super();this.languageId=null;this.startOfSentence=
!1;this.userInitQuery=this.text=null;this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.jl()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignalBase"}static jl(){return["AugLoop_Signals_Signal"]}}Object(J.a)(m,"TextPredictorSignalBase",h.a,[]);d.d(V,"a",function(){return r});class r extends m{constructor(){super();this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.jl()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignal"}static jl(){return["AugLoop_Signals_TextPredictorSignalBase",
"AugLoop_Signals_Signal"]}}Object(J.a)(r,"TextPredictorSignal",m,[])},1006:function(J,V,d){var h=d(114),e=d(55),m=d(82),r=d(25),v=d(33),A=d(86),x=d(27),y=d(321),u=d(26);J=d(0);var H=d(45),G=d(91);class E{constructor(K){this.Pbb=null;this.zYc=K;switch(this.zYc){case "audio":this.Pbb=E.xAb;break;case "captions":this.Pbb=E.R7j;break;default:u.a.J(521434624,822,10,"Invalid file type")}}wji(K){switch(this.zYc){case "audio":return E.DCc(K);case "captions":return E.vji(K);default:return u.a.J(521434595,
822,10,"Invalid file type"),new Promise(ca=>{ca(!1)})}}lwl(K){K=H.a.vg(K);for(let ca=0;ca<this.Pbb.length;++ca){const P=this.Pbb[ca];if(P&&0<P.length&&K.endsWith(P))return!0}return!1}static DCc(K){return new Promise((ca,P)=>{if(K&&K.size){var ea=document.createElement("video"),da=URL.createObjectURL(K);ea.setAttribute("src",da);G.a.addHandler(ea,"loadedmetadata",()=>{URL.revokeObjectURL(da);const ia=ea.videoHeight,C=ea.videoWidth;0<ea.duration&&!ia&&!C?ca(!0):(u.a.J(521434593,822,10,"Invalid audio File"),
ca(!1))});G.a.addHandler(ea,"error",()=>{URL.revokeObjectURL(da);u.a.J(521434592,822,10,"Invalid audio File");P(ResourceStrings.L_InvalidAudioFileError)})}else u.a.J(521434594,822,10,"Empty media File"),ca(!1)})}static vji(K){return new Promise((ca,P)=>{if(K&&K.size){var ea=URL.createObjectURL(K),da=document.createElement("video"),ia=document.createElement("track");da.appendChild(ia);G.a.addHandler(ia,"load",()=>{URL.revokeObjectURL(ea);ca(!0)});G.a.addHandler(ia,"error",()=>{URL.revokeObjectURL(ea);
u.a.J(521434590,822,10,"Invalid captions File");P(ResourceStrings.l_InvalidCaptionsFileError)});ia.setAttribute("src",ea);ia.setAttribute("default","true")}else u.a.J(521434591,822,10,"Empty captions File"),ca(!1)})}static W5a(K){return K&&K.value?K.files[0].size.toString():"Invalid number of files"}static OBa(K){if(!K||!K.value)return"Input file name is null";const ca=K.value.lastIndexOf(".");return-1===ca?"":K.value.substring(ca+1,ca+5)}}E.A2j=16;E.R7j=[".vtt"];E.xAb=[".mp3",".wav",".m4a",".aac",
".oga"];Object(J.a)(E,"MediaValidationHelper",null,[]);var I=d(935),Q=d(67);d.d(V,"a",function(){return D});d.d(V,"b",function(){return Y});const D=(K,ca,P,ea)=>{const da=String.format("{0}{1}",P,h.a.create().toString());return Object.assign(new I.a,{OGd:W(da,ea),kye:N(P,ea),n6c:(ia,C)=>{C.blockContent(ia,"Insert Media")},onSuccess:(ia,C,oa,Z,pa,ya)=>{ca(K,da,C,oa,pa,ya)},Tz:(ia,C,oa,Z,pa)=>{oa.fN(C)&&u.a.J(521434627,822,15,"Media::InsertMediaFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+C.bha);oa.mJ(C);C=null;try{const ya=v.a(ia);C=ya?ya.Error:null}catch(ya){u.a.J(521434626,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",ia)}C||(C=Object.assign(new y.a,{Code:444}));pa&&(pa.finish(),pa=null);u.a.J(521434625,822,10,"Upload media failed");M(Z,pa,C.Code,null)}})},Y=(K,ca,P,ea)=>new Promise((da,ia)=>{const C=new E(ea);u.a.J(521434632,822,50,"Media File details: Number of media files: {0}, media file extension: {1}, media file size: {2}",
K&&K.value?K.files.length:0,E.OBa(K),E.W5a(K));P&&P.Ya("MediaFileValidationStarts",String.format("Number of media files: {0}, media file extension: {1}, media file size: {2}",K&&K.value?K.files.length:0,E.OBa(K),E.W5a(K)));if(K&&K.value&&K.value.length)if(C.lwl(K.value)){var oa=K.files[0];oa.size>1048576*E.A2j?(u.a.J(521434630,822,10,"Media::Insert:Invalid media file size:{0}",oa.size),M(ca,P,442,["16"]),ia(442)):C.wji(oa).then(Z=>{Z?(P&&P.Ya("MediaFileValidationPassedOnUI","true"),da(!0)):(M(ca,
P,443,[C.Pbb.join(", ")]),ia(443))},()=>{u.a.J(521434629,822,10,"Invalid media file");M(ca,P,443,[C.Pbb.join(", ")]);ia(443)})}else u.a.J(521434631,822,10,"Media::Insert:Invalid media file type:{0}",E.OBa(K)),M(ca,P,441,[C.Pbb.join(", ")]),ia(441);else M(ca,P,440,null),ia(440)}),M=(K,ca,P,ea)=>{ca&&ca.finish();K.YH(P,da=>{da.$C=1;da.Z4a=ea;return!1})},N=(K,ca)=>{let P="MediaUpload.ashx";if(x.App.webServiceBase)P=x.App.webServiceBase+P;else if(e.a.ag||e.a.zsa)P=m.a.yBa(P);let ea="";switch(K){case "audio":ea=
"audio";break;case "captions":ea="captions";break;default:u.a.J(521434628,822,10,"Media::GetMediaUploadEndpoint: file type not supported")}P+=String.format("?MediaType={0}&{1}&{2}&{3}",ea,r.AFrameworkApplication.fQa(),ca.presentationId.string,r.AFrameworkApplication.PZb());ca.podSessionId&&(P+=String.format("&{0}={1}",A.a.C9,ca.podSessionId));ca.qk&&(P+=String.format("&waccluster={0}",ca.qk));return P},W=(K,ca)=>{const P=new Q.a;P.$("PresentationId",ca.presentationId.string);P.$(A.a.Mda,ca.sessionInfo);
P.$("Canary",r.AFrameworkApplication.canary);P.$("access_token",r.AFrameworkApplication.accessToken);P.$("MediaToken",K);return P}},1069:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(96);class e{constructor(m){this.Jpd=m.cloneNode(!0);this.vff=m}restore(){for(h.a.Vt(this.vff);this.Jpd.firstChild;){const m=this.Jpd.firstChild;h.a.hO(m);this.vff.appendChild(m)}this.Jpd=null}}Object(J.a)(e,"DomElementContentState",null,[])},1070:function(J,V,d){d.r(V);d.d(V,"SpellingRequestObjectUpdatedV2",
function(){return m});J=d(0);var h=d(650),e=d(649);class m extends h.a{constructor(){super();this.ProofingEngine=0;this.UseContextualResults=!1;this.TextUnit=0;this.Descriptors=this.OverriddenCritiqueTypeOptions=null;this.UxLcid=0}static wWd(r,v){const A=new m;h.a.aye(A,r,v);A.UserActionType=e.a[r.userAction];A.ProofingEngine=r.Wda;A.Descriptors=r.descriptors;A.OverriddenCritiqueTypeOptions=r.overriddenCritiqueTypeOptions;A.UxLcid=r.OBh;2===r.Wda?A.TextUnit=r.range.textUnit:1===r.Wda&&(A.UseContextualResults=
!0);return A}}Object(J.a)(m,"SpellingRequestObjectUpdatedV2",h.a,[])},1071:function(J,V,d){d.r(V);d.d(V,"SpellingRequestObjectUpdated",function(){return m});J=d(0);var h=d(650),e=d(649);class m extends h.a{constructor(){super();this.UseContextualResults=this.TrackMetrics=this.UseOneSpeller=!1;this.ExperimentId=null}static wWd(r,v,A,x,y,u){const H=new m;h.a.aye(H,r,v);H.UserActionType=e.a[r.userAction];H.UseOneSpeller=A;H.TrackMetrics=x;H.UseContextualResults=y;u&&(H.ExperimentId=u);return H}}Object(J.a)(m,
"SpellingRequestObjectUpdated",h.a,[])},1072:function(J,V,d){d.r(V);d.d(V,"ReactOICErrorDialogWithTrial",function(){return r});J=d(0);var h=d(13);V=d(898);var e=d(192),m=d(83);class r extends V.a{constructor(v,A,x,y,u,H){super(v,A,x,y,u,H);A={["errorMessage"]:this.h_f,["offerString"]:this.MUg};v=new m.a(!1,!1,!0);this.Koh?(v.vd=1,A.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.NQa,["onExecute"]:()=>{e.Redirect.showHelp(this.Pig)}}):(v.vd=4,v.Pe(2,this.Kjg));v.Pe(1,this.szf);v.kg=
this.id;A={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:A};v.qj(this.oOa,Object(h.a)(this,this.NEk,"reactOICErrorDialogWithTrialHandler"),A)}}Object(J.a)(r,"ReactOICErrorDialogWithTrial",V.a,[])},1073:function(J,V,d){d.r(V);d.d(V,"OICErrorDialogWithTrial",function(){return m});J=d(0);var h=d(13);V=d(898);var e=d(102);class m extends V.a{constructor(r,v,A,x,y,u){super(r,v,A,x,y,u);r=document.createElement("span");r.innerText=this.h_f;r.appendChild(document.createElement("br"));r.appendChild(document.createElement("br"));
v=document.createElement("span");v.innerText=this.MUg;r.appendChild(v);v=new e.StandardDialog;this.Koh?(v.vd=1,v.FFd(this.NQa,this.Pig)):(v.vd=4,v.Pe(2,this.Kjg));v.Pe(1,this.szf);v.kg=this.id;v.Tw(this.oOa,null,this.icon,Object(h.a)(this,this.uQj,"legacyOICErrorDialogWithTrialHandler"),r)}}Object(J.a)(m,"OICErrorDialogWithTrial",V.a,[])},1074:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(J.a)(h,"HeaderButtonInfo",
null,[])},1075:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(J.a)(h,"CalloutButtonProps",null,[])},1076:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.y=this.x=0}}Object(J.a)(h,"IPoint",null,[])},1077:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(25);d=d(78);class e{static n2h(m){e.HUe.addHandler(e.XNf,m)}static NBk(m){h.AFrameworkApplication.fa.ka("SqmCommandEventSourceEnabled")&&
e.HUe.raiseEvent(e.XNf,m)}}e.XNf="CommandClickEvent";e.HUe=new d.a;Object(J.a)(e,"CommandClickEvents",null,[])},1078:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.Image16by16Class="Image16by16Class";h.Image32by32Class="Image32by32Class";h.On="On";h.LabelText="LabelText";h.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";h.EnsureControlRoleIsButton="EnsureControlRoleIsButton";h.Visible="Visible";Object(J.a)(h,"SplitButtonCommandProperties",null,[])},1079:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);class h{constructor(e,m=null,r=null,v=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=m;this.iconSet.icon24=r;this.iconSet.icon32=v}}Object(J.a)(h,"IconSetContainer",null,[])},1080:function(J,V,d){d.r(V);d.d(V,"NewCustomEventFactory",function(){return h});J=d(0);d=d(525);class h extends d.a{constructor(){super()}create(e,m){const r={};r.detail=m;return new CustomEvent(e,r)}}Object(J.a)(h,"NewCustomEventFactory",d.a,[])},1081:function(J,V,d){d.r(V);
d.d(V,"IECustomEventFactory",function(){return h});J=d(0);d=d(525);class h extends d.a{constructor(){super()}create(e,m){const r=window.document.createEvent("CustomEvent");r.initCustomEvent(e,!1,!1,m);return r}}Object(J.a)(h,"IECustomEventFactory",d.a,[])},1082:function(J,V,d){d.r(V);d.d(V,"CheckRoamingRightsRequest",function(){return h});J=d(0);d=d(927);class h extends d.a{constructor(){super()}osb(){return 2}Lk(){return 1}}Object(J.a)(h,"CheckRoamingRightsRequest",d.a,[])},1083:function(J,V,d){d.r(V);
d.d(V,"GetRoamingLauncherRequest",function(){return h});J=d(0);d=d(927);class h extends d.a{constructor(){super()}osb(){return 0}Lk(){return 2}}Object(J.a)(h,"GetRoamingLauncherRequest",d.a,[])},1084:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(196),e=d(94);class m{constructor(r){this.Gr=r;this.iM=Array.indexOf(this.Gr,this.Jha)}dispose(){this.Gr=null}get QY(){return this.Gr[this.iM]}aE(r){this.djc(r,!1);return!0}w5a(r){this.djc(r,!0)}djc(r,v){r&&(this.QY!==r||v)&&(r.tabIndex=0,
e.FocusManager.xr(r));Array.contains(this.Gr,r)&&(this.iM=Array.indexOf(this.Gr,r))}get y5g(){let r=this.iM;do if(r)if(0<r&&r<this.Gr.length)r--;else break;else r=this.Gr.length-1;while(!h.DOMFocusListing.XAa(this.Gr[r])&&r!==this.iM);return this.Gr[r]}get ETg(){let r=this.iM;do if(r===this.Gr.length-1)r=0;else if(0<=r&&r<this.Gr.length-1)r++;else break;while(!h.DOMFocusListing.XAa(this.Gr[r])&&r!==this.iM);return this.Gr[r]}get Jha(){let r=0;for(;!h.DOMFocusListing.XAa(this.Gr[r])&&r<this.Gr.length;)r++;
return h.DOMFocusListing.XAa(this.Gr[r])?this.Gr[r]:null}get Cvb(){let r=this.Gr.length-1;for(;!h.DOMFocusListing.XAa(this.Gr[r])&&0<r;)r--;return h.DOMFocusListing.XAa(this.Gr[r])?this.Gr[r]:null}}Object(J.a)(m,"DialogFocusListing",null,[188])},1085:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(298);class h{}h.Value="Value";h.Image16by16Class="Image16by16Class";h.Alt="Alt";h.Visible=d.a.visible;Object(J.a)(h,"LabelCommandProperties",null,[])},1094:function(J,V,d){d.r(V);J=d(0);var h=
d(374),e=d(13),m=d(1154),r=d(25),v=d(150),A=d(451),x=d(266),y=d(193),u=d(57),H=d(70),G=d(35);class E{constructor(jb,Xb,yb,mb,Ub){this.qxd=null;this.KO=!0;this.DO=null;this.Da=jb;this.Mh=Xb;this.rqd=yb;this.dTh=mb;this.Qg=Ub;r.AFrameworkApplication.uzc(Object(e.a)(this,this.jsl,"updateLastError"));this.dTh.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(this.KO=r.AFrameworkApplication.WD,u.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ec=>
{ec.isFeatureEnabled("mso_sendASmile",!0).then(nc=>{this.KO=r.AFrameworkApplication.WD&&nc;this.Mh&&this.Mh.updateCommandUI();return null},()=>null)})):u.a.instance.Oa("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(ec=>{ec.h2("Enabled").then(nc=>{this.KO=nc;return null},()=>null)})}get Qg(){this.DO||(r.AFrameworkApplication.Qg||(r.AFrameworkApplication.Qg=new A.a),this.DO=r.AFrameworkApplication.Qg);return this.DO}set Qg(jb){this.DO=jb}jsl(jb,Xb){void 0!==Xb&&null!==Xb&&
Xb&&(this.qxd=Xb.errorCode)}wb(){this.Da.ya(G.a.giveFeedback,H.a.frame,Object(e.a)(this,this.pgj,"giveFeedbackHandler"));this.Da.ya(G.a.nQe,H.a.frame,Object(e.a)(this,this.nQe,"triggerFloodgateSurvey"));this.Mh.updateCommandUI()}nQe(jb,Xb,yb,mb,Ub){if(1===yb)return 32;if(2===yb&&!Ub)return 8;u.a.instance.Oa("Common.ISystemInitiatedFeedback").execute(ec=>{ec.logActivity(Object(m.a)(String,Ub.ActivityName),Object(m.a)(String,Ub.BRSName))});return 32}pgj(jb,Xb,yb,mb,Ub){if(1===yb)return r.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||
(this.KO=!1),this.KO&&y.SessionStatusManager.instance.N2?32:8;if(2===yb){h.ULS.sendTraceTag(8405838,356,50,"");this.Qg.Feedback|=x.a.kOi;const ec=Ub||{};void 0!==ec.ErrorCode&&null!==ec.ErrorCode||null==this.qxd||(ec.ErrorCode=this.qxd);r.AFrameworkApplication.fa.zAf(ec);this.rqd&&(this.rqd.instance||3===r.AFrameworkApplication.Ba.jb.vm&&1===r.AFrameworkApplication.Ba.jb.vGa||u.a.instance.qb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.rqd.execute(nc=>{r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OcvFeedbackvNextModalWacEnabled",
!1)?v.UISurfaces.D6i().then(Lb=>{void 0!==Lb&&null!==Lb?(nc.NPj(ec,Lb),h.ULS.sendTraceTag(8405838,356,100,"Opened OCV vNext Modal")):(h.ULS.sendTraceTag(520626707,356,15,"feedbackAPI not retrived"),nc.hbe(ec));return Lb},()=>{h.ULS.sendTraceTag(520626706,356,15,"error while retieving feedbackAPI");nc.hbe(ec);return null}):nc.hbe(ec)}))}return 32}}Object(J.a)(E,"CustomerFeedbackActor",null,[608]);class I{constructor(jb,Xb,yb){this.ONb=this.Cwd=!1;this.DO=this.nYe=null;this.$1a=jb;this.Svc=Xb;this.Qg=
yb}get Qg(){this.DO||(r.AFrameworkApplication.Qg||(r.AFrameworkApplication.Qg=new A.a),this.DO=r.AFrameworkApplication.Qg);return this.DO}set Qg(jb){this.DO=jb}hbe(jb){this.nYe=jb;this.$kg()||this.z5b()}NPj(jb,Xb){this.$1a.R9k(jb,Xb)}z5b(){this.Cwd||(this.Cwd=!0,this.Svc.$Rd(Object(e.a)(this,this.Sdk,"oFeedbackJsDownloadFinished")))}Sdk(jb){jb?(this.ONb=!0,this.Qg.Feedback|=x.a.oOi,this.$kg(),h.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.Qg.Feedback|=x.a.nOi,h.ULS.sendTraceTag(7611925,
356,100,"CF - JS download failed"));this.Cwd=!1}$kg(){return this.ONb?(this.$1a.Nal(this.nYe),!0):!1}Nxg(jb){this.ONb=jb}}Object(J.a)(I,"CustomerFeedbackC3FormManager",null,[726]);var Q=d(17),D=d(653),Y=d(169),M=d(231),N=d(280);class W{constructor(jb=null){this.cff=null;this.Buc=new Q.a;this.AO=jb}$Rd(jb){W.X4b()?this.Buc.add(jb):this.cff=jb;var Xb="Feedback/officebrowserfeedback_floodgate.js";D.a.y8d()&&(Xb="Feedback/latest/officebrowserfeedback_floodgate.js");jb="OFeedbackIntl";r.AFrameworkApplication.fa.Fu("IsServerFlavorDebug")&&
r.AFrameworkApplication.fa.ka("IsServerFlavorDebug")&&(jb+=".debug");jb+=".js";Xb=Y.a.lVb(Xb);Y.a.foi(jb);jb=N.a.create(Xb);jb.yM(Object(e.a)(this,this.Cik,"onJsDownloadFinished"));M.a.nt(jb);h.ULS.sendTraceTag(7611929,356,100,"CF - Downloading JS from: {0}",Xb)}qZk(jb){this.AO?jb&&this.AO.add(jb):this.AO=jb}Cik(jb,Xb){if(W.X4b()){for(jb=0;jb<this.Buc.count;jb++)this.Buc.ga(jb)(Xb.succeeded,this.AO);this.Buc.clear()}else this.cff(Xb.succeeded,this.AO)}static X4b(){return!!r.AFrameworkApplication.Ba&&
!!r.AFrameworkApplication.Ba.jb&&3===r.AFrameworkApplication.Ba.jb.vm&&1===r.AFrameworkApplication.Ba.jb.vGa}}Object(J.a)(W,"CustomerFeedbackResourceDownloadManager",null,[642]);class K{constructor(){this.audienceGroup=null;this.qte=this.Ceb=0}ivg(){return!this.qte}}Object(J.a)(K,"OCVData",null,[]);var ca=d(120),P=d(196),ea=d(104);class da extends Sys.EventArgs{constructor(jb){super();this.zfl=jb}}Object(J.a)(da,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var ia=d(168),C=d(76),oa=d(192),Z=d(33),
pa=d(247),ya=d(267),Ja=d(45),Ka=d(982),ma=d(78);class ra{constructor(jb,Xb){this.w8j="obf-MainContentHolder";this.BQj="obf-OverallSmileAnchor";this.exl="obf-visible";this.FKb=this.EKb=ra.fdd;this.tud=this.sud=this.KO=!0;this.F5e=this.Xjb=this.esd=this.dsd=this.Vsc=this.tsc=this.BNb=!1;this.xsc=!0;this.Qwd=this.twd=this.DO=this.G6c=this.Utd=this.ECd=null;this.ZJh=r.AFrameworkApplication.fa.ka("FeedbackTabHandlerEnabled");this.Kd=jb;this.Qg=Xb;this.Ta=new ma.a;if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)){const ec=this;u.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Lb=>{Lb.isFeatureEnabled("mso_sendASmile",ec.KO).then(Zc=>{ec.KO=Zc;return null},()=>null);Lb.isFeatureEnabled("FloodgateSurvey",ec.Vsc).then(Zc=>{ec.Vsc=Zc;ec.esd=!0;return null},()=>null)});const nc=this;u.a.instance.Oa("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Lb=>{Lb.h2("IncludeScreenshot").then(Zc=>{nc.BNb=Zc;return null},()=>null);Lb.h2("IncludeEmail").then(Zc=>
{nc.tsc=Zc;nc.dsd=!0;return null},()=>null)})}else{const ec=this;u.a.instance.Oa("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(nc=>{nc.h2("Enabled").then(Lb=>{ec.KO=Lb;return null},()=>null);nc.h2("IncludeScreenshot").then(Lb=>{ec.BNb=Lb;return null},()=>null);nc.h2("IncludeEmail").then(Lb=>{ec.tsc=Lb;ec.dsd=!0;return null},()=>null);nc.h2("SurveyEnabled").then(Lb=>{ec.Vsc=Lb;ec.esd=!0;return null},()=>null)})}if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForUpsell",
!0)){this.Xjb=r.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled");const ec=this;u.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(nc=>{ec.Xjb=nc.isFreemiumUpsellEnabled();nc.isFeatureEnabled("mso_sendASmile",!1).then(Lb=>{ec.F5e=Lb;return null},()=>null)})}const yb=this;u.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ec=>{ec.isFeatureEnabled("FeedbackForum",yb.xsc).then(nc=>{yb.xsc=nc;return null},()=>null)});const mb=
this;u.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ec=>{ec.isFeatureEnabled("FeedbackComplianceCannotConsent",mb.sud).then(nc=>{mb.sud=nc;return null},()=>null)});const Ub=this;u.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ec=>{ec.isFeatureEnabled("FeedbackComplianceCannotPartialConsent",Ub.tud).then(nc=>{Ub.tud=nc;return null},()=>null)});D.a.y8d()?(this.ECd=Y.a.lVb("Feedback/latest/officebrowserfeedback.css"),
this.Utd=Y.a.XMd("Feedback/latest/Intl/")):(this.ECd=Y.a.lVb("Feedback/officebrowserfeedback.css"),this.Utd=Y.a.XMd("Feedback/Intl/"))}get Qg(){this.DO||(r.AFrameworkApplication.Qg||(r.AFrameworkApplication.Qg=new A.a),this.DO=r.AFrameworkApplication.Qg);return this.DO}set Qg(jb){this.DO=jb}get sbe(){return this.twd||(this.twd=document.getElementById(this.BQj))}get m4c(){return this.Qwd||(this.Qwd=document.getElementById(this.w8j))}A2h(jb){this.Ta.addHandler(ra.kXg,jb)}ali(){this.Qwd=this.twd=null}iDj(jb){return!!jb&&
0<=jb.className.toLowerCase().indexOf(this.exl.toLowerCase())}R9k(jb,Xb){r.AFrameworkApplication.WD?this.KO&&(h.ULS.sendTraceTag(520626705,356,15,"Feedback api retrieved"),jb=jb||{},this.getContext(jb),Xb.initializeFeedbackModal(jb),h.ULS.sendTraceTag(7948385,356,50,"Successfully opened feedback form and set focus."),this.Qg.Feedback|=x.a.u1f):h.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible")}Nal(jb){if(!r.AFrameworkApplication.WD)h.ULS.sendTraceTag(520626704,
356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");else if(this.KO){jb=jb||{};this.getContext(jb);var Xb=ra.UDi(jb.AppMode||"Unknown");Ka.a.init(Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"),356,Xb,jb);this.hvj();ra.allowKeytips(!1);h.ULS.sendTraceTag(520488648,356,50,"Successfully opened feedback form and set focus.");this.Qg.Feedback|=x.a.u1f}}XOi(jb,Xb){Xb&&2>=Xb.Ceb?((Xb=r.AFrameworkApplication.fa.Ia("UserPrincipalName"))&&
0<Xb.length&&(jb.userEmail=Xb),jb.userEmailConsentDefault=!0):jb.userEmail=""}G5f(jb){const Xb={};if(void 0!==jb.appData&&null!==jb.appData){var yb=jb.appData;for(var mb in yb)Xb[mb]=yb[mb]}Xb.App=jb.Application||"";Xb.AppMode=jb.AppMode||"";Xb.AppModeExt=jb.ApplicationMode||"";Xb.Host=jb.Host||"";Xb.Language=jb.locale;Xb.IsError=jb.Error||!1;Xb.IsCrash=jb.Crash||!1;Xb.ServerDocId=jb.ServerDocId||"";jb.ErrorCode&&""!==jb.ErrorCode.toString()&&(Xb.IsError=!0);"Origin"in jb&&(Xb.Origin=jb.Origin);Xb.ClientThrottlingProtection=
this.Qg.ClientThrottlingProtection||"";Xb.HostServiceLevel=this.Qg.HostServiceLevel||"";Xb.RequestedCallThrottling=this.Qg.RequestedCallThrottling||"";Xb.WacServiceLevel=this.Qg.WacServiceLevel||"";this.Qg.HostResponseStats&&(yb=this.Qg.HostResponseStats.Label)&&(Xb.HostFarmHint=yb);yb=r.AFrameworkApplication.fa;(mb=yb.Ia(r.AFrameworkApplication.lJ))&&""!==mb&&(Xb.UiHost=mb);(mb=yb.Ia(r.AFrameworkApplication.fyh))&&""!==mb&&(Xb.UiHostIntegrationType=mb);yb.ka("OcvFeedbackIncludesSessionOriginIsEnabled")&&
(yb=jb.SessionOrigin,yb&&""!==yb||(jb=jb.SourceControlId)&&""!==jb&&pa.a(pa.d(jb),"feedback")&&(yb=this.t7f().SessionOrigin),yb&&""!==yb&&(Xb.SessionOrigin=yb));jb=null;try{jb=Z.c(Xb),jb=Ja.a.gba(jb,Ja.a.wvb)}catch(Ub){jb="",h.ULS.sendTraceTag(520644571,356,10,"Exception trying to serialize appData:"+Ub.message)}return{["appData"]:jb||""}}RZi(jb){const Xb={};for(let yb in jb)Xb[yb]=jb[yb];Xb.IsFreemiumUpsellEnabled=this.Xjb;Xb.IsAadcEnabled=this.F5e;Xb.IsFeedbackEnabled=this.KO;return Xb}UZi(){let jb=
null;try{const Xb=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.WebSurfacesSettings",null);Xb&&(jb=Z.b(Xb))}catch(Xb){h.ULS.sendTraceTag(543520794,356,10,"Could not deserialize WebSurfacesSettingsJson")}return jb||{}}BYi(jb,Xb){if(jb&&Xb){jb.LanguageID?jb.locale=ya.a.re(jb.LanguageID).name||"":jb.ApplicationLCID&&(jb.locale=jb.ApplicationLCID);jb.applicationGroup=this.G5f(jb);jb.applicationSettings=this.RZi(r.AFrameworkApplication.fa.appSettings);jb.webSurfacesSettings=
this.UZi();ra.pVf(Xb,jb);jb.appId=ra.ZDi();jb.environment=Xb.qte;jb.stylesUrl=this.ECd;jb.intlUrl=this.Utd;jb.rtl=r.AFrameworkApplication.fa.ka("Rtl")?"rtl":"ltr";var yb=ra.YDi();jb.primaryColour=yb.primaryColour;jb.secondaryColour=yb.secondaryColour;jb.sessionId=jb.SessionID||jb.WACSessionID||"";jb.build=jb.ApplicationVersion||jb.WFEVersion||"";yb=jb.FlightIDs?jb.FlightIDs.toString():jb.Flights?jb.Flights.toString():"";var mb="";jb.ErrorCode&&(mb=jb.ErrorCode.toString());var Ub=this.J7i(jb),ec=Xb.ivg()?
r.AFrameworkApplication.fa.Ia("TenantId"):"";if(!ec||r.AFrameworkApplication.fa.ka("TenantIdValidationForOCVFeedbackEnabled")&&"0"===ec)ec="";var nc=r.AFrameworkApplication.fa.Ia("LoggableUserIdSpace"),Lb=r.AFrameworkApplication.fa.Ia("LoggableUserId")||"";switch(nc){case "MsaPuid":Lb="p:"+Lb;break;case "MsaCid":Lb="m:"+Lb;break;case "OrgIdPuid":Lb="a:"+(r.AFrameworkApplication.fa.Ia("AADUserObjectId")||Lb);break;default:h.ULS.sendTraceTag(575415951,356,50,"Unknown LoggableUserIdSpace. LoggableUserId: "+
Lb+", LoggableUserIdSpace: "+nc),Lb=""}nc={};if(void 0!==jb.telemetryGroup&&null!==jb.telemetryGroup){const Zc=jb.telemetryGroup;for(let Pb in Zc)nc[Pb]=Zc[Pb]}nc.audienceGroup=Xb.audienceGroup;nc.audience=Xb.audienceGroup;nc.flights=yb;nc.platform=Ub;nc.ringId=Xb.Ceb;nc.officeUILang=r.AFrameworkApplication.lcid;nc.errorCode=mb;nc.loggableUserId=Lb;nc.processSessionId=jb.SessionID||jb.WACSessionID||"";nc.officeBuild=jb.ApplicationVersion||jb.WFEVersion||"";0<ec.length&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==
ec&&(nc.tenantId=ec);jb.telemetryGroup=nc;jb.webGroup={["browser"]:jb.Browser||"",["browserVersion"]:(jb.BrowserMajorVersion||"")+"."+(jb.BrowserMinorVersion||""),["dataCenter"]:jb.Datacenter||jb.WACDatacenter||""};jb.isCommercialHost=r.AFrameworkApplication.fa.ka("IsO365CommercialHost");this.SDi(jb);jb.disableIncludeScreenshot=!this.BNb;jb.screenshot=this.BNb;jb.showEmailAddress=this.tsc;jb.emailPolicyValue=this.tsc?1:0;jb.screenshotPolicyValue=this.BNb?1:0;r.AFrameworkApplication.fa.ka("IsO365CommercialHost")||
(jb.disableIncludeScreenshot=!1,jb.showEmailAddress=!0,jb.screenshot=!0);r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&(jb.surveyEnabled=this.Vsc,r.AFrameworkApplication.fa.ka("IsO365ConsumerHost")&&(jb.showEmailAddress=!0,jb.surveyEnabled=!0));this.XOi(jb,Xb);this.G6c=jb.DismissHandler?jb.DismissHandler:null;this.QDi(jb)}}N8h(){return this.dsd&&this.esd}getContext(jb){jb=jb||this.t7f();const Xb=new K;this.BYi(jb,Xb);return jb}J7i(jb){let Xb=
"";jb.Platform&&(Xb=jb.Platform.toString());jb.PlatformMajorVersion&&(0<Xb.length&&(Xb+=" "),Xb+=jb.PlatformMajorVersion.toString()+".");jb.PlatformMinorVersion&&(Xb+=jb.PlatformMinorVersion.toString());return Xb}Ldl(jb){jb.ApplicationMode&&(jb.AppMode=jb.ApplicationMode);jb.ApplicationModeExtended&&(jb.ApplicationMode=jb.ApplicationModeExtended)}t7f(){let jb;try{jb=Z.b(r.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),this.Ldl(jb)}catch(Xb){h.ULS.sendTraceTag(36794389,356,10,
"Could not deserialize SessionStartInfoJson"),jb={}}return jb}onError(jb){h.ULS.sendTraceTag(37259477,356,10,"FB submit error: "+jb);this.Qg.Feedback|=x.a.mOi;ra.allowKeytips(!0)}eGi(){if(ra.Vtg()){h.ULS.sendTraceTag(40112215,356,50,ra.rUg);var jb=u.a.instance.resolve("Common.ISystemInitiatedFeedback");jb&&jb.logActivity("AppUsageNPSLocalizationTest",null)}}onDismiss(jb){this.fma();this.ali();ia.a.EBb()&&h.ULS.sendTraceTag(34936718,356,50,"FB dismiss");ia.a.$Ra()&&ea.c(jb?G.a.jOi:G.a.fOi,!0,null,
2,8);jb?(ia.a.EBb()&&h.ULS.sendTraceTag(34936719,356,15,"FB submit"),this.Qg.Feedback|=x.a.pOi):(this.Qg.Feedback|=x.a.lOi,this.eGi());this.Ta.raiseEvent(ra.kXg,new da(jb));ra.allowKeytips(!0);this.G6c&&(this.G6c(),this.G6c=null)}hvj(){if(this.Kd){let jb=!1,Xb=5,yb=!1;this.FKb=this.clearInterval(this.FKb);this.EKb=this.clearInterval(this.EKb);this.EKb=window.setInterval(()=>{if(this.sbe){yb=!0;var mb=this.Kd.Bc(ra.i4a);mb.HK=!0;mb.parent=ca.AFrame.kj;mb.u2a(ra.iBi);mb.xaa(()=>{let Ub=this.Kd.AP(ra.i4a),
ec=null,nc=5,Lb=!1;this.FKb=window.setInterval(()=>{this.iDj(this.m4c)&&(Lb=!0,this.sbe.focus(),Ub||(Ub=this.Kd.AP(ra.i4a)),Ub&&!ec&&(ec=Ub.gj),ec&&ec.aE(this.sbe));nc--;if(Lb||!nc)this.FKb=this.clearInterval(this.FKb)},1E3)});jb||(this.Kd.hX(ra.i4a,!0),jb=!0);this.ZJh&&this.m4c&&(mb=new P.DOMFocusListing(()=>this.m4c),mb.ho(1),mb.ho(2),mb.ho(3),mb.ho(5),mb=this.Kd.Sga(()=>this.m4c,this.Kd.Bc(ra.i4a),mb),mb.beb(),mb.CS=!0,mb.GNa=!0,mb.ASg())}Xb--;if(yb||!Xb)this.EKb=this.clearInterval(this.EKb)},
1E3)}}clearInterval(jb){jb!==ra.fdd&&(window.clearInterval(jb),jb=ra.fdd);return jb}fma(){this.Kd&&(this.Kd.n4(ra.i4a),this.Kd.kEb(ra.i4a))}QDi(jb){this.sud?this.tud||(jb.ageGroup=4):jb.ageGroup=3;r.AFrameworkApplication.fa.ka("IsAnonymousUser")?jb.authenticationType=2:jb.authenticationType="aad"===r.AFrameworkApplication.fa.Ia("HostAuthType")?1:0}SDi(jb){this.xsc&&(jb.myFeedbackForumUrl="https://go.microsoft.com/fwlink/?linkid=2171883",jb.MyFeedbackPortalUrl="https://go.microsoft.com/fwlink/?linkid=2171883");
if(this.xsc){const Xb=ra.TDi();void 0!==Xb&&null!==Xb&&(jb.feedbackPortalUrl=Xb,jb.feedbackForumUrl=Xb)}}static allowKeytips(jb){r.AFrameworkApplication.Ba.jb.mo&&C.a("allowKeytips")&&appChrome.api.allowKeytips(jb)}static pVf(jb,Xb){if(Xb){jb.Ceb=parseInt(Xb.Ring);if(isNaN(jb.Ceb))jb.audienceGroup="Unknown",jb.Ceb=-2;else switch(jb.Ceb){case 0:case 1:jb.audienceGroup="Dogfood";break;case 2:jb.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:jb.audienceGroup="Production";break;default:jb.audienceGroup=
"Unknown"}var yb=!0;Xb.Host&&(yb="MsInternal"!==Xb.Host&&"Blue Chicken"!==Xb.Host);jb.qte=yb?0:1}}static ZDi(){let jb=0;switch(oa.Redirect.application){case 2:jb=2155;break;case 4:jb=2158;break;case 3:jb=2157;break;case 1:jb=2156;break;case 5:jb=2159;break;default:h.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",oa.Redirect.application.toString())}return jb}static YDi(){const jb={};let Xb="#2B579A",yb="#3C65A4";switch(oa.Redirect.application){case 2:r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.ka("AppColorUpdateIsEnabled")?
(Xb="#185ABD",yb="#2E6AC5"):(Xb="#2B579A",yb="#3C65A4");break;case 4:Xb="#7719AA";yb="#9953C0";break;case 3:Xb="#B7472A";yb="#C75033";break;case 1:Xb="#217346";yb="#3F8159";break;case 5:Xb="#3955A3";yb="#4D6AB8";break;default:h.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",oa.Redirect.application.toString())}jb.primaryColour=Xb;jb.secondaryColour=yb;return jb}static TDi(){let jb=null;switch(oa.Redirect.application){case 2:jb="https://go.microsoft.com/fwlink/?linkid=2170869&clcid=0x409";
break;case 4:jb="https://go.microsoft.com/fwlink/?linkid=2172997&clcid=0x409";break;case 3:jb="https://go.microsoft.com/fwlink/?linkid=2171000&clcid=0x409";break;case 1:jb="https://go.microsoft.com/fwlink/?linkid=2170798&clcid=0x409";break;case 5:jb="https://go.microsoft.com/fwlink/?linkid=2173231&clcid=0x409";break;default:h.ULS.sendTraceTag(540577997,356,10,"Unexpected Application: {0}",oa.Redirect.application.toString())}return jb}static UDi(jb){let Xb=356;switch(oa.Redirect.application){case 2:switch(jb){case "Edit":Xb=
364;break;case "View":case "Attendee":case "Presenter":Xb=363;break;default:h.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",r.AFrameworkApplication.Ba.oVa),Xb=363}break;case 4:Xb=362;break;case 3:switch(jb){case "Edit":Xb=361;break;case "View":case "Attendee":case "Presenter":case "Outline":case "":Xb=360;break;default:h.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",r.AFrameworkApplication.Ba.oVa),
Xb=360}break;case 1:switch(jb){case "Edit":Xb=358;break;case "View":Xb=357;break;case "Survey":Xb=359;break;default:h.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",r.AFrameworkApplication.Ba.oVa),Xb=357}break;case 5:switch(jb){case "View":Xb=373;break;case "Edit":Xb=374;break;default:h.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",r.AFrameworkApplication.Ba.oVa),Xb=373}break;default:h.ULS.sendTraceTag(7652226,
356,10,"Unexpected Application: {0}",oa.Redirect.application.toString())}return Xb}static iBi(){h.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")}static Vtg(){if(!ra.fte){const jb=!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.ka(ra.rUg);ra.fte=jb?2:1}return 2===ra.fte}}ra.i4a="CustomerFeedbackFocusId";ra.kXg="FUID";ra.fdd=-1;ra.fte=0;ra.rUg="NPSLocalizationTestingIsEnabled";Object(J.a)(ra,"CustomerFeedbackUiWrapper",null,[641]);var Da=d(14),va=d(1155),Fa=d(1156);class ka{constructor(jb,
Xb,yb,mb){this.KWe=jb;this.Zea=Xb;this.JWe=yb;this.FPh=mb}activityName(){return this.Zea}object(){return this.FPh}}Object(J.a)(ka,"OneCallBackData",null,[]);class qa{constructor(jb,Xb,yb,mb){this.ZJa=[];Array.add(this.ZJa,new ka(jb,Xb,yb,mb))}add(jb){jb&&Array.addRange(this.ZJa,jb.ZJa)}cli(){Array.clear(this.ZJa)}}Object(J.a)(qa,"CallBackData",null,[]);var Ua=d(654);class Ya extends Ua.a{constructor(jb,Xb,yb=null,mb=!1,Ub=!1,ec=null,nc=null,Lb=null){super("FloodgateTeachingCallout");this.image=this.footer=
this.message=this.smallHeadline=this.title=null;this.positionImageAtLeft=!1;this.secondaryButtonProps=this.primaryButtonProps=null;this.footer=jb;this.message=Xb;this.image=yb;this.positionImageAtLeft=mb;this.smallHeadline=Ub;this.title=ec;this.primaryButtonProps=nc;this.secondaryButtonProps=Lb}}Object(J.a)(Ya,"FloodgateCalloutContent",Ua.a,[]);class Va{constructor(){this.H6g=this.options=null}}Object(J.a)(Va,"Notification",null,[]);var ua=d(1075),Ca=d(904),Ea=d(390);class wb extends Ua.a{constructor(jb,
Xb,yb=null,mb=null){super("PremiumUpsellCallout");this.imageHeight=this.imageProps=this.content=this.title=null;this.title=jb;this.content=Xb;this.imageProps=yb;this.imageHeight=mb}}Object(J.a)(wb,"PremiumUpsellCalloutContentProps",Ua.a,[]);var Oa=d(905);class ab{constructor(jb){this.alt=this.ariaLabel=this.src=null;this.src=jb}}Object(J.a)(ab,"ImageProps",null,[]);class fb{static KNd(jb){return fb.M8i().then(Xb=>{try{const yb=[];for(let mb=0;mb<jb.length;mb++){const Ub=jb[mb],ec=fb.XLj(Ub.surfaceType),
nc=new Va;nc.options=fb.t6i(Ub,!ec);nc.H6g=ec?Xb.callout(fb.M8j(jb[mb])):Xb.externalNotification();yb.push(nc)}return fb.$9k(Xb,yb)}catch(yb){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+yb.message);}})}static XLj(jb){switch(jb.toLowerCase()){case "teaching":case "coachmark":case "sequence":case "premiumupsell":return!0;default:return!1}}static t6i(jb,Xb){const yb=new Ea.a;Xb&&(yb.onShow=jb.onUnsupportedSurfaceType);yb.telemetryId="FloodgateTeachingUx-Surface"+
(Xb?"NotSupported":"Supported");return yb}static M8j(jb){var Xb="premiumupsell"!==jb.surfaceType.toLowerCase()?new Ya(jb.footer,jb.description,jb.illustrationImage?Object.assign(new ab(jb.illustrationImage),{ariaLabel:jb.imageAriaLabel}):null,"left"===jb.position,jb.smallHeadline,jb.title,fb.wKc(jb.primaryButtonText,jb.primaryButtonAction),fb.wKc(jb.secondaryButtonText,jb.secondaryButtonAction)):new wb(jb.title,jb.description,jb.illustrationImage?Object.assign(new ab(jb.illustrationImage),{ariaLabel:jb.imageAriaLabel}):
null);Xb=Object.assign(new Ca.a,{target:jb.selector,content:Xb,showCloseIcon:null!=jb.hasCloseButton?jb.hasCloseButton:!0,preventLightDismiss:null!=jb.preventAutoDismiss?jb.preventAutoDismiss:!1,useTeachingStyles:!0,calloutProps:Object.assign(new Oa.a,{onDismiss:()=>{if(jb.onClosed)jb.onClosed("close")},directionalHint:jb.anchorHint,setInitialFocus:!0})});"coachmark"===jb.surfaceType.toLowerCase()?(Xb.hasDynamicSizing=!1,Xb.useCoachmark=!0,Xb.calloutProps.setInitialFocus=!1):"premiumupsell"===jb.surfaceType.toLowerCase()&&
(Xb.primaryButtonProps=fb.wKc(jb.primaryButtonText,jb.primaryButtonAction),Xb.secondaryButtonProps=fb.wKc(jb.secondaryButtonText,jb.secondaryButtonAction),Xb.showCloseIcon=!1,Xb.useTeachingStyles=!1,Xb.calloutProps.preventDismissOnLostFocus=!1);return Xb}static wKc(jb,Xb){return jb&&""!==jb&&Xb?Object.assign(new ua.a,{label:jb,onExecute:Xb}):(h.ULS.shipAssertTag(594569111,356,(!jb||""===jb)&&!Xb,"A callout button needs both a caption and an action."),null)}static M8i(){fb.nJc||(r.AFrameworkApplication.Ba.jb.JRa&&
r.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled")?fb.nJc=v.UISurfaces.pV().then(jb=>{const Xb=new Ya(null,null);if(jb.isCustomContentSupported&&jb.isCustomContentSupported(Xb))return jb;throw Error.create("Custom Content not supported: "+Xb.type);},jb=>{h.ULS.sendTraceTag(593352343,383,15,"Failed to GetNotificationsAPIAsync: {0}",jb);return null}):fb.nJc=Promise.reject("React Notifications not enabled"));return fb.nJc}static $9k(jb,Xb){if(!Xb||!Xb.length)return[];const yb=
[];for(let mb=0;mb<Xb.length;mb++){const Ub=fb.M$k(jb,Xb[mb]);yb.push(Ub)}return yb}static M$k(jb,Xb){const yb=jb.addNotification(Xb.H6g,Xb.options);return()=>{jb.removeNotification(yb)}}}fb.nJc=null;Object(J.a)(fb,"FloodgateNotifications",null,[]);const db=(jb,Xb)=>{jb=r.AFrameworkApplication.fa.Ia("UserPrincipalName");if(Xb=!!Xb.HUg&&2===Xb.HUg.Ceb)Xb=(Xb=jb.toLowerCase())?0<Xb.indexOf("linkedin.com")||0<Xb.indexOf("linkedin.biz"):!1;return Xb};class gc{constructor(jb,Xb){this.HUg=jb;this.context=
Xb}}Object(J.a)(gc,"SurveyMetadata",null,[]);var ob=d(66),Sb=d(268),Jb=d(91),Ab=d(79);class lc{constructor(jb){this.oRa=this.isInitialized=!1;this.mha=this.hib=null;this.iZa=!1;this.MNe=null;this.$rg=!1;this.PFc=0;this.hUf=-1;this.jye=this.OFc=null;this.A1b=!0;this.pP=jb;this.fmc={};this.oGf=!1;this.LEb=this.oa=null;this.mJc=0}Ewj(jb){this.isInitialized&&this.hib||this.oRa?h.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."):
null===jb?h.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"):(this.iZa=jb.iZa,h.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"))}uwj(){const jb=this.pP.getContext(null),Xb=new K;ra.pVf(Xb,jb);this.MNe=new gc(Xb,jb);this.LEb=new Da.ScriptSharpLegacyMap;this.LEb.$("LinkedInWACUsage",db)}get bnb(){this.hib||(this.hib=u.a.instance.qb("Common.App.IAppSpecificFeedbackData"));return this.hib}logActivity(jb,Xb,yb=null){jb&&this.o5a(jb,
lc.Ybb,Xb)&&(this.isInitialized?(h.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+jb),Ka.a.logActivity(jb,yb)):(h.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+jb),this.D5d(new qa(Ka.a.logActivity,jb,null,yb))))}Tbe(jb){try{r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTriggerActivityName",!1)&&h.ULS.sendTraceTag(520140175,356,50,"Trigger Activity Name: "+jb),-1===this.hUf&&(this.hUf=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.DeferredActivityDelayInMilliSeconds",
lc.LTf)),this.OFc||(this.OFc=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDeferredActivityAllowedList"," ").toString().toLowerCase()),!r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowAllTriggerActivities",!0)&&this.OFc&&jb&&jb.startsWith("Ribbon_")&&-1===this.OFc.indexOf(jb.toLowerCase())?h.ULS.sendTraceTag(527247310,356,100,"SIFB: LogActivityDeferred activity ignored"):this.isInitialized?(0<this.PFc&&r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClearNearActivityTimeouts",
!1)&&(window.clearTimeout(this.PFc),h.ULS.sendTraceTag(592217693,356,50,"SIFB: LogActivityDeferred cancelled "+jb)),this.PFc=window.setTimeout(()=>{this.PFc=0;this.logActivity(jb,null)},lc.LTf)):h.ULS.sendTraceTag(592217692,356,50,"SIFB: LogActivityDeferred called before initialization "+jb)}catch(Xb){h.ULS.sendTraceTag(527247311,356,10,"SIFB: LogActivityDeferred activity failed: "+(Xb?Xb.toString():""))}}D5b(jb,Xb){jb&&this.o5a(jb,lc.Ybb,Xb)&&(this.Izg(jb,Xb),this.fmc[jb]=Xb)}Izg(jb,Xb){this.o5a(jb,
lc.Ybb,Xb)&&(this.isInitialized?(h.ULS.sendTraceTag(37754501,356,50,"SIFB: LogActivityStartInternal "+jb),Ka.a.D5b(jb,null)):(h.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+jb),this.D5d(new qa(Ka.a.D5b,jb,null,null))))}Gzg(jb){jb&&this.isInitialized&&this.o5a(jb,lc.Ybb,void 0)&&(jb in this.fmc&&delete this.fmc[jb],this.Hzg(jb,void 0))}Hzg(jb,Xb){this.isInitialized&&this.o5a(jb,lc.Ybb,Xb)&&(h.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+
jb),Ka.a.Gzg(jb))}RGb(jb,Xb){if(this.o5a(jb,lc.Ybb,Xb))if(this.bnb){if(Xb=this.bnb.E1d(jb))this.isInitialized?(h.ULS.sendTraceTag(38605911,356,50,"SIFB:ShowUserInitiatedSurvey "+jb),Ka.a.RGb(Xb)):(h.ULS.sendTraceTag(38605912,356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+jb),this.D5d(new qa(null,null,Ka.a.RGb,Xb)))}else h.ULS.sendTraceTag(556896919,356,10,"AppSpecificFeedbackData is null")}o5a(jb,Xb,yb){if(this.oRa)return!1;if(!r.AFrameworkApplication.WD)return h.ULS.sendTraceTag(37601796,
356,50,"SIFB: All feedback/floodgate is disabled"),!1;if(!this.bEj())return!1;this.eui();return(this.VCj(jb)||this.UAi(jb)||this.Gzj(jb))&&this.mbi(Xb,yb)&&this.bgl(jb)}eui(){if(!this.hib){const jb=u.a.instance.qb("Common.App.IAppSpecificFeedbackData");jb?this.hib=jb:h.ULS.sendTraceTag(589641477,356,10,"SIFB.Error:IAppSpecificFeedbackData not found in the container")}}cEj(jb){return 6!==jb}bEj(){if(0===this.mJc){const jb=this.pP.getContext(null);this.mJc=this.cEj(parseInt(jb.Ring))?1:2;2===this.mJc&&
h.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===this.mJc}bgl(jb){null===this.LEb&&this.uwj();return jb&&this.LEb&&this.LEb.Kb(jb)?this.LEb.ga(jb)(jb,this.MNe):!0}LZi(){if(!this.mha&&!this.oGf){this.oGf=!0;const jb=this.pP.getContext(null);this.mha="locale"in jb?jb.locale:"";this.mha=this.mha.toLowerCase()}return this.mha}UAi(jb){this.mha||(this.mha=this.LZi());if(!(this.mha&&this.mha.length&&jb&&jb.length))return!1;let Xb="en-us"===this.mha||this.bHj(jb)||
ra.Vtg();!Xb&&this.SGj(jb)&&(Xb=this.TGj(this.mha));return Xb}SGj(jb){return this.bnb?"AppUsageNPS"===jb||"AppUsageTimeSatisfiedNPS"===jb||"SuiteUsageNPS"===jb||"SuiteUsageTimeSatisfiedNPS"===jb:(h.ULS.sendTraceTag(593769179,356,10,"SIFB:IsNPSActivity AppSpecificFeedbackData was null. activityName: "+jb),!1)}VCj(jb){return!!jb&&-1!==jb.toLowerCase().indexOf("floodgateflight")}bHj(jb){return!!jb&&-1!==jb.toLowerCase().indexOf("nlqs")}TGj(jb){if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAllNpsLanguages",
!1))return!0;if(!jb||!jb.length)return!1;if(!r.AFrameworkApplication.fa.ka("WacNPSLocalizedLanguagesEnabled"))return"en-us"===jb;let Xb=!1;switch(jb){case "en-us":case "es-es":case "ja-jp":case "en-gb":case "pt-br":case "nl-nl":case "de-de":case "fr-fr":case "sv-se":case "fi-fi":case "nb-no":case "da-dk":case "ru-ru":case "es-mx":case "pl-pl":case "zh-cn":case "zh-tw":case "it-it":case "ko-kr":Xb=!0}return Xb}mbi(jb,Xb){return r.AFrameworkApplication.fa.ka(jb)?Xb&&!r.AFrameworkApplication.fa.ka(Xb)?
(h.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+Xb+") is off"),!1):!0:(h.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+jb+") is off"),!1)}Gzj(jb){const Xb=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.AllowedCampaignActivities","ShowFirstRunExperienceUIV2");return!!jb&&!!Xb&&-1!==Xb.toLowerCase().indexOf(jb.toLowerCase())}D5d(jb){if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1))r.AFrameworkApplication.fa.gf(()=>
{try{this.XGc(jb)}catch(Xb){h.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+Xb)}});else try{this.XGc(jb)}catch(Xb){h.ULS.sendTraceTag(574997505,356,10,"SIFB.Error:Download and initialize failed "+Xb)}}zdc(){this.iZa||this.start()}knk(){this.iZa||this.stop()}GMe(){this.iZa&&this.start()}Nel(){this.iZa&&this.stop()}start(){h.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized);if(this.isInitialized)if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStart",
!1)){const jb=Ab.a.ZEc(10,Object(e.a)(this,this.zrh,"startSurvey"),r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStartIdleOverrideMs",1E3));r.AFrameworkApplication.ve.Hb(jb)}else this.zrh(null)}zrh(){Ka.a.BRi();this.xjl()}stop(){h.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized);this.isInitialized&&(this.wjl(),Ka.a.CRi())}xjl(){const jb=this.fmc;for(let Xb in jb)this.Izg(Xb,jb[Xb])}wjl(){const jb=this.fmc;for(let Xb in jb)this.Hzg(Xb,
jb[Xb])}XGc(jb){h.ULS.sendTraceTag(36546388,356,100,"SIFB: Entered DownloadResources");var Xb=u.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");Xb&&(Xb.ONb?this.r3f(!0,jb):(Xb=u.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),Xb.qZk(jb),Xb.$Rd(Object(e.a)(this,this.r3f,"floodgateJsDownloadFinished"))))}r3f(jb,Xb){h.ULS.sendTraceTag(36546389,356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+jb);let yb="";Xb&&
Xb.ZJa&&0<Xb.ZJa.length&&(yb=Xb.ZJa[0].activityName());if(jb)if(D.a.y8d())if(this.isInitialized)this.IRd(Xb);else{if(this.oRa||!this.jye)this.jye=this.c4g();this.jye.then(()=>{this.IRd(Xb)}).catch(mb=>this.d4g(yb,mb))}else this.c4g().then(()=>{this.IRd(Xb)}).catch(mb=>this.d4g(yb,mb));else this.oRa=!0,h.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+yb)}d4g(jb,Xb){this.oRa=!0;h.ULS.sendTraceTag(36546390,356,10,"SIFB Error: in post download init. Activity name "+jb+
". "+Xb.toString())}DRi(jb){this.oa||this.Awj();let Xb=jb;jb&&0<jb.length&&(Xb=this.oa&&this.oa.Kb(jb)?this.oa.ga(jb):jb);return Xb?Xb:""}c4g(){var jb=u.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");jb&&jb.Nxg(!0);this.K4k();this.k4k();this.initOptions();if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&r.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return this.HVi().then(Xb=>
{this.ace(Xb);return Xb}).then(Xb=>Ka.a.s5d(Object(e.a)(this,this.Ive,"onSIFeedbackDismiss"),Object(e.a)(this.pP,this.pP.onError,"onError"),Xb,Object(e.a)(this.pP,this.pP.onDismiss,"onDismiss")));if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&r.AFrameworkApplication.fa.ka("IsO365CommercialHost")&&r.AFrameworkApplication.fa.ka("OcpsIsEnabled"))return lc.yCi(this.X9f()).then(()=>{const Xb=this.RWd();this.ace(Xb);return Xb}).then(Xb=>
Ka.a.s5d(Object(e.a)(this,this.Ive,"onSIFeedbackDismiss"),Object(e.a)(this.pP,this.pP.onError,"onError"),Xb,Object(e.a)(this.pP,this.pP.onDismiss,"onDismiss")));jb=this.RWd();this.ace(jb);return Ka.a.s5d(Object(e.a)(this,this.Ive,"onSIFeedbackDismiss"),Object(e.a)(this.pP,this.pP.onError,"onError"),jb,Object(e.a)(this.pP,this.pP.onDismiss,"onDismiss"))}HVi(){return new Promise(jb=>{u.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Xb=>{const yb=this.RWd();Xb.isFeatureEnabled("FloodgateSurvey",
!0).then(mb=>{yb.surveyEnabled="surveyEnabled"in yb?mb&&yb.surveyEnabled:mb;jb(yb);return null},mb=>{h.ULS.sendTraceTag(555857947,356,15,"GetAllContextForFloodgatePromise Error {0}",mb.toString());jb(yb);return null})})})}TZi(){let jb=null;try{const Xb=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.MessagingServiceSettings",null);Xb&&(jb=Z.b(Xb))}catch(Xb){h.ULS.sendTraceTag(540285072,356,10,"Could not deserialize MessagingServiceSettingsJson")}return jb||{}}RWd(){const jb=
this.pP.getContext(null);jb.FloodgateUIAutoDismissTimeEnum=this.uWi();jb.uIStringGetter=Object(e.a)(this,this.DRi,"floodgateUIStringGetter");jb.authTokenCallback=lc.lui(Object(m.a)(String,jb.AudienceGroup));jb.augLoopCallback=lc.jui();jb.onTeachingCampaignRender=lc.KNd;jb.governanceServiceEnabled=lc.q9f();jb.governanceServiceConfig=lc.R1i();jb.personalizerEnabled=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);jb.messagingServiceSettings=
this.TZi();jb.isPriorityEnabled=lc.l8i();return jb}ace(jb){const Xb=this.pP.N8h(),yb=this.X9f(),mb=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1),Ub=r.AFrameworkApplication.fa.ka("IsO365CommercialHost"),ec=r.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),nc=r.AFrameworkApplication.fa.ka("OcpsIsEnabled"),Lb="surveyEnabled"in jb?jb.surveyEnabled:"null or undefined",Zc="showEmailAddress"in jb?jb.showEmailAddress:"null or undefined",
Pb=lc.q9f(),eb=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);h.ULS.sendTraceTag(575947136,356,50,'"Info": "SIFB Info: Floodgate SDK will init.", "OcpsPoliciesSet": "{0}", "FGAdminControlsEnabled": "{1}", "IsO365CommercialHost": "{2}", "IsO365ConsumerHost": "{3}", "OcpsIsEnabled": "{4}", "FGInitDelayTime": "{5}", "ShowEmailAddress": "{6}", "surveyEnabled": "{7}", "governanceServiceEnabled": "{8}", "governanceServiceConfig": "{9}", "personalizerEnabled": "{10}"',
Xb,mb,Ub,ec,nc,yb,Zc,Lb,Pb,Z.c(jb.governanceServiceConfig),eb)}uWi(){return db(null,this.MNe)?(h.ULS.sendTraceTag(593278928,356,50,"SIFB Info:LinkedIn - Floodgate AutoDismissTimeEnum:0"),0):r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgatePromptAutoDismissEnum",r.AFrameworkApplication.fa.Gc("FloodgateUIAutoDismissTimeEnum",2))}X9f(){return r.AFrameworkApplication.fa.Gc("FloodgateContextAndInitDelayInMilliSeconds",lc.dCi)}IRd(jb){this.isInitialized=!0;this.R0h();
Ka.a.VZk(Object(e.a)(this,this.WVj,"logTriggerEvent"));if(jb){for(const Xb of jb.ZJa)Xb.KWe?(0,Xb.KWe)(Xb.activityName(),Xb.object()):Xb.JWe?(0,Xb.JWe)(Xb.object()):h.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null");jb.cli()}else h.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{const Xb=this.pP.getContext(null),yb=Ka.a.X8f(Array.isArray(Xb.Flights)?Xb.Flights:null),mb=yb?Object(m.a)(String,yb.SelfTriggerActivity):null;if(mb)for(const Ub of mb.split(";"))Ub&&
""!==Ub&&this.logActivity(Ub,null)}catch(Xb){h.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+(Xb?Xb.toString():""))}}R0h(){if(!this.$rg&&window.addEventListener){const jb=Object(e.a)(this,this.gnk,"onWebCampaignEvent");window.addEventListener("FGWebSurfaceEvent",jb,!0);this.$rg=!0}}Pzg(jb,Xb){jb&&(r.AFrameworkApplication.Pj(jb),r.AFrameworkApplication.tVc(jb));h.ULS.sendTraceTag(50704975,306,50,"Web Campaign UI launched. "+Xb)}kCj(jb){if(!jb)return!1;try{const Xb=(r.AFrameworkApplication.fa.Ia("FlightId")||
"").toLocaleLowerCase(),yb=jb.toString().toLocaleLowerCase().split(";");for(const mb of yb)if(2<mb.length&&(mb.lastIndexOf("-control")===mb.length-8||mb.lastIndexOf("cf")===mb.length-2&&-1!==Xb.indexOf(mb)))return!0}catch(Xb){h.ULS.sendTraceTag(512505555,306,50,"Error serializing campaign event -"+(Xb?Xb.toString():""))}return!1}WVj(jb,Xb){Xb=Xb||{};if(jb&&!("isControl"in Xb)){const yb=this.kCj(jb);yb&&(Xb.isControl=yb)}this.Pzg(jb,JSON.stringify(Xb))}gnk(jb){if(jb=jb?jb.detail:null){var Xb=!r.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled"),
yb=(jb.action||"").toLowerCase();switch(yb){case "dismissed":Xb&&Sb.a.instance.ap("obf-DynamicWebSurfaces");break;case "updated":Xb&&Ka.a.lpa("obf-DynamicWebSurfaces");break;case "opened":case "":yb=jb.telemetryEventName;let mb;try{mb=JSON.stringify(jb)}catch(Ub){mb="id : "+jb.id+" telemetryEventName: "+yb,h.ULS.sendTraceTag(51131789,306,50,"Error serializing campaign event. "+mb+" Error: "+(Ub?Ub.toString():""))}jb.success?this.Pzg(yb,mb):h.ULS.sendTraceTag(50422098,306,10,"Error launching Web Campaign UI."+
mb);jb.isHidden||jb.isAA||!Xb||Ka.a.lpa("obf-DynamicWebSurfaces");break;default:h.ULS.sendTraceTag(594626399,306,50,"Unrecognized action "+yb)}}}sml(jb){var Xb=["Live"];if(!jb)return null;try{const yb=Z.b(jb),mb=new Q.a;for(const Ub of yb){const ec=Ub.Tags;if(ec)for(const nc of Xb)Array.contains(ec,nc)&&mb.add(Ub)}return Z.c(mb.toArray())}catch(yb){return h.ULS.sendTraceTag(523904348,356,10,"Could not deserialize CampaignDefinitionsJson"),null}}K4k(){let jb=!1,Xb=null;const yb=this.bMc();if(yb&&this.bnb)try{let mb=
this.bnb.jXi();r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.FilterOfficeLiveSurvey",!1)&&r.AFrameworkApplication.isa&&(mb=this.sml(mb));mb?(yb.setItem(lc.Wgi,mb),jb=!0):(Xb="SIFB.campaign str was null",h.ULS.sendTraceTag(594143442,356,10,Xb))}catch(mb){Xb="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+mb,h.ULS.sendTraceTag(594143441,356,50,Xb)}else this.bnb?(Xb="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",
h.ULS.sendTraceTag(594143440,356,50,Xb)):(Xb="SIFB.Floodgate surveys not available. App Specific Feedback data was null",h.ULS.sendTraceTag(556896920,356,50,Xb));h.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+jb+" errorString: "+(Xb?Xb:"null"))}Ive(jb,Xb){ia.a.EBb()&&h.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",Xb,jb);ia.a.$Ra()&&ea.c(Xb?G.a.tvl:G.a.svl,!0,null,2,8);Sb.a.instance.ap(Ka.a.q3f)}initOptions(){}k4k(){this.iZa||(Jb.a.addHandler(window.self,
ob.a.focus,Object(e.a)(this,this.zdc,"onWindowFocus")),Jb.a.addHandler(window.self,ob.a.blur,Object(e.a)(this,this.knk,"onWindowBlur")))}bMc(){if(!this.A1b)return null;let jb=null;try{jb=localStorage}catch(Xb){this.A1b=!1,jb=null,h.ULS.sendTraceTag(594052320,356,50,"SIFB.GetLocalStorage error "+(Xb?Xb.toString():""))}return jb}Awj(){h.ULS.sendTraceTag(39077269,356,50,"inside InitializeUIStringGetter");try{this.oa=new va.a(Fa.a.rt()),this.oa.$("nps_Title",CommonUIStrings.l_WAC_NPS_Title),this.oa.$("nps_PromptQuestion",
CommonUIStrings.l_WAC_NPS_PromptQuestion),this.oa.$("nps_RatingQuestion",CommonUIStrings.l_WAC_NPS_RatingQuestion),this.oa.$("nps_RatingQuestion_Word",lc.Yeg()),this.oa.$("nps_RatingQuestion_OneNote",lc.Gfj()),this.oa.$("nps_OneClickPromptQuestion_PPT",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_PPT),this.oa.$("nps_OneClickPromptQuestion_Excel",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_Excel),this.oa.$("nps_OneClickRatingQuestion_Excel",lc.Weg()),this.oa.$("nps_OneClickRatingQuestion_PowerPoint",
lc.Xeg()),this.oa.$("nps_RatingQuestion_PowerPoint",lc.Xeg()),this.oa.$("nps_RatingQuestion_Excel",lc.Weg()),this.oa.$("nps_RatingQuestion_Visio",CommonUIStrings.l_WAC_NPS_RatingQuestion_Visio),this.oa.$("nps_Rating_Values_1",CommonUIStrings.l_WAC_NPS_Rating_Values_1),this.oa.$("nps_Rating_Values_2",CommonUIStrings.l_WAC_NPS_Rating_Values_2),this.oa.$("nps_Rating_Values_3",CommonUIStrings.l_WAC_NPS_Rating_Values_3),this.oa.$("nps_Rating_Values_4",CommonUIStrings.l_WAC_NPS_Rating_Values_4),this.oa.$("nps_Rating_Values_5",
CommonUIStrings.l_WAC_NPS_Rating_Values_5),this.oa.$("nps_QuestionQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.oa.$("nps_OneClickPromptQuestion",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion),this.oa.$("nps_OneClickRatingQuestion_Word",lc.Yeg()),this.oa.$("nps_OneClickRating_Values_1",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_1),this.oa.$("nps_OneClickRating_Values_2",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_2),this.oa.$("nps_OneClickRating_Values_3",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_3),
this.oa.$("nps_OneClickRating_Values_4",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_4),this.oa.$("nps_OneClickRating_Values_5",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_5),this.oa.$("nps_Suite_RatingQuestion","How likely are you to recommend Microsoft 365 to others, if asked?"),this.oa.$("nps_Suite_QuestionQuestion","Please tell us more. Why did you choose that answer?"),this.oa.$("NSVPromptTitle",CommonUIStrings.l_Excel_NSV_Prompt),this.oa.$("NSVTimedSurvey_Question",CommonUIStrings.l_Excel_NSV_Overview_Question),
this.oa.$("SatisfactionRating_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.oa.$("SatisfactionRating_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.oa.$("SatisfactionRating_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.oa.$("SatisfactionRating_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.oa.$("SatisfactionRating_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.oa.$("NSV_Timed_Feedback_Freeform_Question",CommonUIStrings.l_Excel_NSV_Timed_Feedback_Freeform_Question),this.oa.$("NSV_Prompt_Title_Feedback",
CommonUIStrings.l_Title_For_NSV_Floodgate_Prompt),this.oa.$("NSVDidntCreateSheetViewQuestion",CommonUIStrings.l_NSV_Didnt_Create_NSV_Survey_Question),this.oa.$("NSVDidntCreateNSVOption_1",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_1),this.oa.$("NSVDidntCreateNSVOption_2",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_2),this.oa.$("NSVDidntCreateNSVOption_3",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_3),this.oa.$("NSVDidntCreateNSVOption_4",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_4),this.oa.$("NSVFreeformDidntCreateSheetView",
CommonUIStrings.l_NSV_Freeform_Reason_Didnt_Create_SheetView),this.oa.$("NSVDidntCreatePrompt",CommonUIStrings.l_NSV_Didnt_Create_SheetView_Prompt),this.oa.$("NSVPromptQuestion",CommonUIStrings.l_NSV_PromptQuestion),this.oa.$("CatchUpFPS_Title",CommonUIStrings.l_WAC_CatchUpFPS_Title),this.oa.$("CatchUpFPS_Question",CommonUIStrings.l_WAC_CatchUpFPS_Question),this.oa.$("CatchUpFPS_YesLabel",CommonUIStrings.l_WAC_CatchUpFPS_YesLabel),this.oa.$("CatchUpFPS_NoLabel",CommonUIStrings.l_WAC_CatchUpFPS_NoLabel),
this.oa.$("CatchUpFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpFPS_RatingQuestion),this.oa.$("CatchUpFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.oa.$("CatchUpFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.oa.$("CatchUpFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.oa.$("CatchUpFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.oa.$("CatchUpFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),
this.oa.$("CatchUpFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpFPS_WhyQuestion),this.oa.$("ReviewMode_FloodgatePromptTitle",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptTitle),this.oa.$("ReviewMode_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptQuestion),this.oa.$("ReviewMode_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_YesLabel),this.oa.$("ReviewMode_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_NoLabel),this.oa.$("ReviewMode_FloodgateRatingQuestion",
CommonUIStrings.l_WAC_ReviewMode_FloodgateRatingQuestion),this.oa.$("ReviewMode_FloodgateRating_1",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_1),this.oa.$("ReviewMode_FloodgateRating_2",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_2),this.oa.$("ReviewMode_FloodgateRating_3",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_3),this.oa.$("ReviewMode_FloodgateRating_4",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_4),this.oa.$("ReviewMode_FloodgateRating_5",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_5),
this.oa.$("ReviewMode_FloodgateQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateQuestion),this.oa.$("collab_RatingQuestion_Visio",CommonUIStrings.l_Visio_Collab_RatingQuestion),this.oa.$("collab_Title_Visio",CommonUIStrings.l_Visio_Collab_Title),this.oa.$("collab_Prompt_Question_Visio",CommonUIStrings.l_Visio_Collab_Prompt_Question),this.oa.$("collab_Rating_Values_1",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_1),this.oa.$("collab_Rating_Values_2",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_2),
this.oa.$("collab_Rating_Values_3",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_3),this.oa.$("collab_Rating_Values_4",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_4),this.oa.$("collab_Rating_Values_5",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_5),this.oa.$("collab_Question_Visio",CommonUIStrings.l_Visio_Collab_Question),this.oa.$("connector_campaign_Survey_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Survey_Question),this.oa.$("connector_campaign_Title",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Title),
this.oa.$("connector_campaign_Prompt_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Prompt_Question),this.oa.$("connector_campaign_Rating_Values_1",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_1),this.oa.$("connector_campaign_Rating_Values_2",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_2),this.oa.$("connector_campaign_Rating_Values_3",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_3),this.oa.$("connector_campaign_Rating_Values_4",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_4),
this.oa.$("connector_campaign_Rating_Values_5",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_5),this.oa.$("connector_campaign_Verbatim_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Verbatim_Question),this.oa.$("WordFollowUpFeelingsFPS_PromptTitle",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptTitle),this.oa.$("WordFollowUpFeelingsFPS_PromptQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptQuestion),this.oa.$("WordFollowUpFeelingsFPS_Prompt_YesLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_YesLabel),
this.oa.$("WordFollowUpFeelingsFPS_Prompt_NoLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_NoLabel),this.oa.$("WordFollowUpFeelingsFPS_RatingQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingQuestion),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_1",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_1),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_2",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_2),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_3",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_3),
this.oa.$("WordFollowUpFeelingsFPS_RatingValue_4",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_4),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_5",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_5),this.oa.$("WordFollowUpFeelingsFPS_WhyQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_WhyQuestion),this.oa.$("DictationV2_Title",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_Title),this.oa.$("DictationV2_GreetingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingQuestion),
this.oa.$("DictationV2_GreetingAnswer_Sure",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Sure),this.oa.$("DictationV2_GreetingAnswer_Notnow",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Notnow),this.oa.$("DictationV2_RatingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingQuestion),this.oa.$("DictationV2_RatingAnswer_1",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_1),this.oa.$("DictationV2_RatingAnswer_2",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_2),
this.oa.$("DictationV2_RatingAnswer_3",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_3),this.oa.$("DictationV2_RatingAnswer_4",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_4),this.oa.$("DictationV2_RatingAnswer_5",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_5),this.oa.$("DictationV2_PromptQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_PromptQuestion),this.oa.$("OfficeScriptsFPS_Title",CommonUIStrings.l_WAC_OfficeScriptsFPS_Title),
this.oa.$("OfficeScriptsFPS_Question",CommonUIStrings.l_WAC_OfficeScriptsFPS_Question),this.oa.$("OfficeScriptsFPS_YesLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_YesLabel),this.oa.$("OfficeScriptsFPS_NoLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_NoLabel),this.oa.$("OfficeScriptsFPS_RatingQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingQuestion),this.oa.$("OfficeScriptsFPS_RatingValue_1",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_1),this.oa.$("OfficeScriptsFPS_RatingValue_2",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_2),
this.oa.$("OfficeScriptsFPS_RatingValue_3",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_3),this.oa.$("OfficeScriptsFPS_RatingValue_4",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_4),this.oa.$("OfficeScriptsFPS_RatingValue_5",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_5),this.oa.$("OfficeScriptsFPS_WhyQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_WhyQuestion),this.oa.$("ExcelAddins_Prompt",CommonUIStrings.l_Excel_Addins_Prompt),this.oa.$("ExcelAddins_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.oa.$("ExcelAddins_Rating_Question",CommonUIStrings.l_Excel_Addins_Rating_Question),this.oa.$("ExcelAddins_QuestionQuestion",CommonUIStrings.l_Excel_Addins_QuestionQuestion),this.oa.$("ExcelAddins_Rating_1_Expectations",CommonUIStrings.l_Excel_Addins_Choice_1),this.oa.$("ExcelAddins_Rating_2_Expectations",CommonUIStrings.l_Excel_Addins_Choice_2),this.oa.$("ExcelAddins_Rating_3_Expectations",CommonUIStrings.l_Excel_Addins_Choice_3),this.oa.$("ExcelAddins_Rating_4_Expectations",CommonUIStrings.l_Excel_Addins_Choice_4),
this.oa.$("ExcelAddins_Rating_5_Expectations",CommonUIStrings.l_Excel_Addins_Choice_5),this.oa.$("ExcelIdeas_Prompt",CommonUIStrings.l_Excel_Ideas_Prompt),this.oa.$("ExcelIdeas_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("ExcelIdeas_Rating_Question",CommonUIStrings.l_Excel_Ideas_Rating_Question),this.oa.$("ExcelIdeas_ExpectationsQuestion",CommonUIStrings.l_Excel_Ideas_ExpectationsQuestion),this.oa.$("ExcelIdeas_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),
this.oa.$("ExcelIdeas_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.oa.$("ExcelIdeas_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),this.oa.$("ExcelIdeas_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.oa.$("ExcelIdeas_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.oa.$("ExcelRecommendedCharts_Prompt",CommonUIStrings.l_Excel_RecommendedCharts_Prompt),this.oa.$("ExcelRecommendedCharts_PromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("ExcelRecommendedCharts_Rating_Question",CommonUIStrings.l_Excel_RecommendedCharts_Rating_Question),this.oa.$("ExcelRecommendedCharts_WhyQuestion",CommonUIStrings.l_Excel_RecommendedCharts_WhyQuestion),this.oa.$("ExcelRecommendedCharts_Rating_1_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_1_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_2_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_2_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_3_Satisfied",
CommonUIStrings.l_ExcelRecommendedCharts_Rating_3_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_4_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_4_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_5_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_5_Satisfied),this.oa.$("ExcelRecommendedPivotTable_Prompt",CommonUIStrings.l_Excel_RecommendedPivotTable_Prompt),this.oa.$("ExcelRecommendedPivotTable_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("ExcelRecommendedPivotTable_Rating_Question",
CommonUIStrings.l_Excel_RecommendedPivotTable_Rating_Question),this.oa.$("ExcelRecommendedPivotTable_ExpectationsQuestion",CommonUIStrings.l_Excel_RecommendedPivotTable_ExpectationsQuestion),this.oa.$("ExcelRecommendedPivotTable_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.oa.$("ExcelRecommendedPivotTable_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.oa.$("ExcelRecommendedPivotTable_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),
this.oa.$("ExcelRecommendedPivotTable_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.oa.$("ExcelRecommendedPivotTable_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.oa.$("Download_as_Image_Rating_Question",CommonUIStrings.l_Visio_Download_As_Image_Rating_Question),this.oa.$("Download_as_Image_Title",CommonUIStrings.l_Visio_Download_As_Image_Title),this.oa.$("Download_as_Image_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question),this.oa.$("Download_as_Image_Rating_Values_1",
CommonUIStrings.l_Visio_FPS_Rating_Values_1),this.oa.$("Download_as_Image_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.oa.$("Download_as_Image_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.oa.$("Download_as_Image_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.oa.$("Download_as_Image_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.oa.$("Download_as_Image_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.oa.$("TextPredictions_FloodgatePromptTitle",
CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptTitle),this.oa.$("TextPredictions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptQuestion),this.oa.$("TextPredictions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_YesLabel),this.oa.$("TextPredictions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_NoLabel),this.oa.$("TextPredictions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateRatingQuestion),
this.oa.$("TextPredictions_FloodgateRating_1",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_1),this.oa.$("TextPredictions_FloodgateRating_2",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_2),this.oa.$("TextPredictions_FloodgateRating_3",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_3),this.oa.$("TextPredictions_FloodgateRating_4",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_4),this.oa.$("TextPredictions_FloodgateRating_5",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_5),
this.oa.$("TextPredictions_FloodgateQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateQuestion),this.oa.$("SoftwareITDiagrams_Title",CommonUIStrings.l_Visio_SoftwareITDiagrams_Title),this.oa.$("SoftwareITDiagrams_Survey_Question",CommonUIStrings.l_VisioWeb_SoftwareITDiagrams_Survey_Question),this.oa.$("SoftwareITDiagrams_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question1),this.oa.$("SoftwareITDiagrams_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1a),this.oa.$("SoftwareITDiagrams_Rating_Values_2",
CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.oa.$("SoftwareITDiagrams_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.oa.$("SoftwareITDiagrams_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.oa.$("SoftwareITDiagrams_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.oa.$("SofwareITDiagrams_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.oa.$("ExternalContent_FloodgatePromptTitle",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptTitle),
this.oa.$("ExternalContent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptQuestion),this.oa.$("ExternalContent_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_YesLabel),this.oa.$("ExternalContent_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_NoLabel),this.oa.$("ExternalContent_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateRatingQuestion),this.oa.$("ExternalContent_FloodgateRating_1",
CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_1),this.oa.$("ExternalContent_FloodgateRating_2",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_2),this.oa.$("ExternalContent_FloodgateRating_3",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_3),this.oa.$("ExternalContent_FloodgateRating_4",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_4),this.oa.$("ExternalContent_FloodgateRating_5",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_5),this.oa.$("ExternalContent_FloodgateQuestion",
CommonUIStrings.l_WAC_ExternalContent_FloodgateQuestion),this.oa.$("Translator_GreetingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_GreetingQuestion),this.oa.$("Translator_PromptTitle",CommonUIStrings.l_Word_Translator_Floodgate_PromptTitle),this.oa.$("Translator_GreetingAnswer_NotNow",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_NotNow),this.oa.$("Translator_GreetingAnswer_Sure",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_Sure),this.oa.$("Translator_RatingQuestion",
CommonUIStrings.l_Word_Translator_Floodgate_RatingQuestion),this.oa.$("Translator_RatingValue_1",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_1),this.oa.$("Translator_RatingValue_2",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_2),this.oa.$("Translator_RatingValue_3",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_3),this.oa.$("Translator_RatingValue_4",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_4),this.oa.$("Translator_RatingValue_5",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_5),
this.oa.$("Translator_PromptQuestion",CommonUIStrings.l_Word_Translator_Floodgate_PromptQuestion),this.oa.$("TeamsOpen_GreetingQuestion",CommonUIStrings.l_WAC_NPS_Title),this.oa.$("TeamsOpen_PromptTitle",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("TeamsOpen_GreetingAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("TeamsOpen_GreetingAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("TeamsOpen_RatingQuestion_Word",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Word),
this.oa.$("TeamsOpen_RatingQuestion_Excel",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Excel),this.oa.$("TeamsOpen_RatingQuestion_PowerPoint",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_PowerPoint),this.oa.$("TeamsOpen_Rating_Browser",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Browser),this.oa.$("TeamsOpen_Rating_Teams",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Teams),this.oa.$("TeamsOpen_PromptQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.oa.$("LinkedIn_Title",
CommonUIStrings.l_LinkedIn_Title),this.oa.$("LinkedIn_PromptQuestion",CommonUIStrings.l_LinkedIn_PromptQuestion),this.oa.$("LinkedIn_QuestionQuestion",CommonUIStrings.l_LinkedIn_QuestionQuestion),this.oa.$("LinkedIn_Rating_Values_1",CommonUIStrings.l_LinkedIn_Rating_Values_1),this.oa.$("LinkedIn_Rating_Values_2",CommonUIStrings.l_LinkedIn_Rating_Values_2),this.oa.$("LinkedIn_Rating_Values_3",CommonUIStrings.l_LinkedIn_Rating_Values_3),this.oa.$("LinkedIn_Rating_Values_4",CommonUIStrings.l_LinkedIn_Rating_Values_4),
this.oa.$("LinkedIn_Rating_Values_5",CommonUIStrings.l_LinkedIn_Rating_Values_5),this.oa.$("Excel_LinkedIn_RatingQuestion",CommonUIStrings.l_Excel_LinkedIn_RatingQuestion),this.oa.$("VHRestore_Title",CommonUIStrings.l_WAC_VHRestore_PromptTitle),this.oa.$("VHRestore_PromptQuestion",CommonUIStrings.l_WAC_VHRestore_PromptQuestion),this.oa.$("VHRestore_Sure",CommonUIStrings.l_WAC_VHRestore_Sure),this.oa.$("VHRestore_NotNow",CommonUIStrings.l_WAC_VHRestore_NotNow),this.oa.$("VHRestore_SurveyQuestion",
CommonUIStrings.l_WAC_VHRestore_SurveyQuestion),this.oa.$("VHRestore_Answer_Options_1",CommonUIStrings.l_WAC_VHRestore_AnswerOption_1),this.oa.$("VHRestore_Answer_Options_2",CommonUIStrings.l_WAC_VHRestore_AnswerOption_2),this.oa.$("VHRestore_Answer_Options_3",CommonUIStrings.l_WAC_VHRestore_AnswerOption_3),this.oa.$("VHRestore_Answer_Options_4",CommonUIStrings.l_WAC_VHRestore_AnswerOption_4),this.oa.$("VHRestore_WhyQuestion",CommonUIStrings.l_WAC_VHRestore_WhyQuestion),this.oa.$("ShowChanges_Prompt",
CommonUIStrings.l_Excel_ShowChanges_Prompt),this.oa.$("ShowChanges_PromptQuestion",CommonUIStrings.l_Excel_ShowChanges_PromptQuestion),this.oa.$("ShowChanges_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ShowChanges_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ShowChanges_RatingQuestion",CommonUIStrings.l_Excel_ShowChanges_RatingQuestion),this.oa.$("ShowChanges_RatingValue_1",CommonUIStrings.l_Excel_ShowChanges_RatingValue_1),this.oa.$("ShowChanges_RatingValue_2",
CommonUIStrings.l_Excel_ShowChanges_RatingValue_2),this.oa.$("ShowChanges_RatingValue_3",CommonUIStrings.l_Excel_ShowChanges_RatingValue_3),this.oa.$("ShowChanges_RatingValue_4",CommonUIStrings.l_Excel_ShowChanges_RatingValue_4),this.oa.$("ShowChanges_RatingValue_5",CommonUIStrings.l_Excel_ShowChanges_RatingValue_5),this.oa.$("ShowChanges_WhyQuestion",CommonUIStrings.l_Excel_ShowChanges_WhyQuestion),this.oa.$("ModernUxExperiment_FloodgatePromptTitle",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptTitle),
this.oa.$("ModernUxExperiment_FloodgatePromptQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptQuestion),this.oa.$("ModernUxExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_NotNow),this.oa.$("ModernUxExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_Sure),this.oa.$("ModernUxExperiment_FloodgateRatingQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingQuestion),this.oa.$("ModernUxExperiment_FloodgateRatingValue_1",
CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_1),this.oa.$("ModernUxExperiment_FloodgateRatingValue_2",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_2),this.oa.$("ModernUxExperiment_FloodgateRatingValue_3",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_3),this.oa.$("ModernUxExperiment_FloodgateRatingValue_4",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_4),this.oa.$("ModernUxExperiment_FloodgateRatingValue_5",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_5),
this.oa.$("ModernUxExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_HearMoreQuestion),this.oa.$("FileBackedLoopComponents_FloodgatePromptTitle",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_PromptTitle),this.oa.$("FileBackedLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("FileBackedLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FileBackedLoopComponents_FloodgatePromptAnswer_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("FileBackedLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingQuestion),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_1),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_2),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_3),
this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_4),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_5),this.oa.$("FileBackedLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_FloodgateWhyQuestion),this.oa.$("PollLoopComponent_FloodgatePromptTitle",CommonUIStrings.l_PollLoopComponent_Floodgate_PromptTitle),this.oa.$("PollLoopComponent_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("PollLoopComponent_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("PollLoopComponent_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("PollLoopComponent_FloodgateRatingQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingQuestion),this.oa.$("PollLoopComponent_FloodgateRatingValue_1",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_1),this.oa.$("PollLoopComponent_FloodgateRatingValue_2",
CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_2),this.oa.$("PollLoopComponent_FloodgateRatingValue_3",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_3),this.oa.$("PollLoopComponent_FloodgateRatingValue_4",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_4),this.oa.$("PollLoopComponent_FloodgateRatingValue_5",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_5),this.oa.$("PollLoopComponent_FloodgateWhyQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_FloodgateWhyQuestion),
this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptTitle),this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptQuestion),this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_NotNow),this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_Sure),
this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingQuestion),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_1),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_2),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_3),
this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_4),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_5),this.oa.$("TabSwitchTreatmentExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_HearMoreQuestion),this.oa.$("TabSwitchControlExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptTitle),
this.oa.$("TabSwitchControlExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptQuestion),this.oa.$("TabSwitchControlExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_NotNow),this.oa.$("TabSwitchControlExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_Sure),this.oa.$("TabSwitchControlExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingQuestion),
this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_1),this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_2),this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_3),this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_4),
this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_5),this.oa.$("TabSwitchControlExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_HearMoreQuestion),this.oa.$("ShortcutDiscovery_PromptTitle",CommonUIStrings.l_ShortcutDiscovery_PromptTitle),this.oa.$("ShortcutDiscovery_PromptQuestion",CommonUIStrings.l_ShortcutDiscovery_PromptQuestion),this.oa.$("ShortcutDiscovery_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ShortcutDiscovery_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ShortcutDiscovery_RatingQuestion",CommonUIStrings.l_ShortcutDiscovery_RatingQuestion),this.oa.$("ShortcutDiscovery_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.oa.$("ShortcutDiscovery_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.oa.$("ShortcutDiscovery_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.oa.$("ShortcutDiscovery_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.oa.$("ShortcutDiscovery_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.oa.$("ShortcutDiscovery_WhyQuestion",CommonUIStrings.l_ShortcutDiscovery_WhyQuestion),this.oa.$("Ruler_PromptTitle",CommonUIStrings.l_WordRuler_PromptTitle),this.oa.$("Ruler_PromptQuestion",CommonUIStrings.l_WordRuler_PromptQuestion),this.oa.$("Ruler_PromptAnswer_NotNow",CommonUIStrings.l_WordRuler_PromptAnswer_NotNow),
this.oa.$("Ruler_PromptAnswer_Sure",CommonUIStrings.l_WordRuler_PromptAnswer_Sure),this.oa.$("Ruler_RatingQuestion",CommonUIStrings.l_WordRuler_RatingQuestion),this.oa.$("Ruler_RatingValue_1",CommonUIStrings.l_WordRuler_RatingValue_1),this.oa.$("Ruler_RatingValue_2",CommonUIStrings.l_WordRuler_RatingValue_2),this.oa.$("Ruler_RatingValue_3",CommonUIStrings.l_WordRuler_RatingValue_3),this.oa.$("Ruler_RatingValue_4",CommonUIStrings.l_WordRuler_RatingValue_4),this.oa.$("Ruler_RatingValue_5",CommonUIStrings.l_WordRuler_RatingValue_5),
this.oa.$("Ruler_WhyQuestion",CommonUIStrings.l_WordRuler_WhyQuestion),this.oa.$("CustomTabDialog_PromptTitle",CommonUIStrings.l_CustomTabDialog_PromptTitle),this.oa.$("CustomTabDialog_PromptQuestion",CommonUIStrings.l_CustomTabDialog_PromptQuestion),this.oa.$("CustomTabDialog_PromptAnswer_NotNow",CommonUIStrings.l_CustomTabDialog_PromptAnswer_NotNow),this.oa.$("CustomTabDialog_PromptAnswer_Sure",CommonUIStrings.l_CustomTabDialog_PromptAnswer_Sure),this.oa.$("CustomTabDialog_RatingQuestion",CommonUIStrings.l_CustomTabDialog_RatingQuestion),
this.oa.$("CustomTabDialog_RatingValue_1",CommonUIStrings.l_CustomTabDialog_RatingValue_1),this.oa.$("CustomTabDialog_RatingValue_2",CommonUIStrings.l_CustomTabDialog_RatingValue_2),this.oa.$("CustomTabDialog_RatingValue_3",CommonUIStrings.l_CustomTabDialog_RatingValue_3),this.oa.$("CustomTabDialog_RatingValue_4",CommonUIStrings.l_CustomTabDialog_RatingValue_4),this.oa.$("CustomTabDialog_RatingValue_5",CommonUIStrings.l_CustomTabDialog_RatingValue_5),this.oa.$("CustomTabDialog_WhyQuestion",CommonUIStrings.l_CustomTabDialog_WhyQuestion),
this.oa.$("WordStyles_FloodgatePromptTitle",CommonUIStrings.l_WordStyles_FloodgatePromptTitle),this.oa.$("WordStyles_FloodgatePromptQuestion",CommonUIStrings.l_WordStyles_FloodgatePromptQuestion),this.oa.$("WordStyles_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_YesLabel),this.oa.$("WordStyles_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_NoLabel),this.oa.$("WordStyles_FloodgateRatingQuestion",CommonUIStrings.l_WordStyles_FloodgateRatingQuestion),
this.oa.$("WordStyles_FloodgateRating_1",CommonUIStrings.l_WordStyles_FloodgateRating_1),this.oa.$("WordStyles_FloodgateRating_2",CommonUIStrings.l_WordStyles_FloodgateRating_2),this.oa.$("WordStyles_FloodgateRating_3",CommonUIStrings.l_WordStyles_FloodgateRating_3),this.oa.$("WordStyles_FloodgateRating_4",CommonUIStrings.l_WordStyles_FloodgateRating_4),this.oa.$("WordStyles_FloodgateRating_5",CommonUIStrings.l_WordStyles_FloodgateRating_5),this.oa.$("WordStyles_FloodgateWhyQuestion",CommonUIStrings.l_WordStyles_FloodgateWhyQuestion),
this.oa.$("UnsavedChangesHighlight_PromptTitle",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptTitle),this.oa.$("UnsavedChangesHighlight_PromptQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptQuestion),this.oa.$("UnsavedChangesHighlight_Prompt_YesLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_YesLabel),this.oa.$("UnsavedChangesHighlight_Prompt_NoLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_NoLabel),this.oa.$("UnsavedChangesHighlight_RatingQuestion",
CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_RatingQuestion),this.oa.$("UnsavedChangesHighlight_Rating_Yes",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_Yes),this.oa.$("UnsavedChangesHighlight_Rating_No",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_No),this.oa.$("UnsavedChangesHighlight_CommentQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_CommentQuestion),this.oa.$("WordUnifiedRead_FloodgatePromptTitle",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptTitle),
this.oa.$("WordUnifiedRead_FloodgatePromptQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptQuestion),this.oa.$("WordUnifiedRead_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_YesLabel),this.oa.$("WordUnifiedRead_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_NoLabel),this.oa.$("WordUnifiedRead_FloodgateRatingQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateRatingQuestion),this.oa.$("WordUnifiedRead_FloodgateRating_1",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_1),
this.oa.$("WordUnifiedRead_FloodgateRating_2",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_2),this.oa.$("WordUnifiedRead_FloodgateRating_3",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_3),this.oa.$("WordUnifiedRead_FloodgateRating_4",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_4),this.oa.$("WordUnifiedRead_FloodgateRating_5",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_5),this.oa.$("WordUnifiedRead_FloodgateWhyQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateWhyQuestion),
this.oa.$("GrammarSuggestions_FloodgatePromptTitle",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptTitle),this.oa.$("GrammarSuggestions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptQuestion),this.oa.$("GrammarSuggestions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_YesLabel),this.oa.$("GrammarSuggestions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_NoLabel),this.oa.$("GrammarSuggestions_FloodgateRatingQuestion",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRatingQuestion),this.oa.$("GrammarSuggestions_FloodgateRating_1",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_1),this.oa.$("GrammarSuggestions_FloodgateRating_2",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_2),this.oa.$("GrammarSuggestions_FloodgateRating_3",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_3),this.oa.$("GrammarSuggestions_FloodgateRating_4",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_4),
this.oa.$("GrammarSuggestions_FloodgateRating_5",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_5),this.oa.$("GrammarSuggestions_FloodgateQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateQuestion),this.oa.$("WordRemoveSsr_FloodgatePromptTitle",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptTitle),this.oa.$("WordRemoveSsr_FloodgatePromptQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptQuestion),this.oa.$("WordRemoveSsr_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_YesLabel),
this.oa.$("WordRemoveSsr_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_NoLabel),this.oa.$("WordRemoveSsr_FloodgateRatingQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateRatingQuestion),this.oa.$("WordRemoveSsr_FloodgateRating_1",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_1),this.oa.$("WordRemoveSsr_FloodgateRating_2",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_2),this.oa.$("WordRemoveSsr_FloodgateRating_3",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_3),this.oa.$("WordRemoveSsr_FloodgateRating_4",
CommonUIStrings.l_WordRemoveSsr_FloodgateRating_4),this.oa.$("WordRemoveSsr_FloodgateRating_5",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_5),this.oa.$("WordRemoveSsr_FloodgateWhyQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateWhyQuestion),this.oa.$("WordDrawing_FloodgatePromptTitle",CommonUIStrings.l_WordDrawing_FloodgatePromptTitle),this.oa.$("WordDrawing_FloodgatePromptQuestion",CommonUIStrings.l_WordDrawing_FloodgatePromptQuestion),this.oa.$("WordDrawing_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_YesLabel),
this.oa.$("WordDrawing_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_NoLabel),this.oa.$("WordDrawing_FloodgateRatingQuestion",CommonUIStrings.l_WordDrawing_FloodgateRatingQuestion),this.oa.$("WordDrawing_FloodgateRating_1",CommonUIStrings.l_WordDrawing_FloodgateRating_1),this.oa.$("WordDrawing_FloodgateRating_2",CommonUIStrings.l_WordDrawing_FloodgateRating_2),this.oa.$("WordDrawing_FloodgateRating_3",CommonUIStrings.l_WordDrawing_FloodgateRating_3),this.oa.$("WordDrawing_FloodgateRating_4",
CommonUIStrings.l_WordDrawing_FloodgateRating_4),this.oa.$("WordDrawing_FloodgateRating_5",CommonUIStrings.l_WordDrawing_FloodgateRating_5),this.oa.$("WordDrawing_FloodgateWhyQuestion",CommonUIStrings.l_WordDrawing_FloodgateWhyQuestion),this.oa.$("WordPenNSAT_FloodgatePromptTitle",CommonUIStrings.l_WordPenNSAT_FloodgatePromptTitle),this.oa.$("WordPenNSAT_FloodgatePromptQuestion",CommonUIStrings.l_WordPenNSAT_FloodgatePromptQuestion),this.oa.$("WordPenNSAT_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("WordPenNSAT_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordPenNSAT_FloodgateRatingQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateRatingQuestion),this.oa.$("WordPenNSAT_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("WordPenNSAT_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.oa.$("WordPenNSAT_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),
this.oa.$("WordPenNSAT_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.oa.$("WordPenNSAT_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("WordPenNSAT_FloodgateWhyQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateWhyQuestion),this.oa.$("ShyRibbon_FloodgatePromptTitle",CommonUIStrings.l_ShyRibbon_FloodgatePromptTitle),this.oa.$("ShyRibbon_FloodgatePromptQuestion",CommonUIStrings.l_ShyRibbon_FloodgatePromptQuestion),
this.oa.$("ShyRibbon_FloodgatePrompt_YesLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_YesLabel),this.oa.$("ShyRibbon_FloodgatePrompt_NoLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_NoLabel),this.oa.$("ShyRibbon_Floodgate_Question",CommonUIStrings.l_ShyRibbon_Floodgate_Question),this.oa.$("ShyRibbon_Floodgate_Option_1",CommonUIStrings.l_ShyRibbon_Floodgate_Option_1),this.oa.$("ShyRibbon_Floodgate_Option_2",CommonUIStrings.l_ShyRibbon_Floodgate_Option_2),this.oa.$("ShyRibbon_Floodgate_Option_3",
CommonUIStrings.l_ShyRibbon_Floodgate_Option_3),this.oa.$("ShyRibbon_Floodgate_Option_4",CommonUIStrings.l_ShyRibbon_Floodgate_Option_4),this.oa.$("ShyRibbon_Floodgate_Option_5",CommonUIStrings.l_ShyRibbon_Floodgate_Option_5),this.oa.$("ShyRibbon_FloodgateTellusMore",CommonUIStrings.l_ShyRibbon_Floodgate_TellMore),this.oa.$("WordAutoCorrect_FloodgatePromptTitle",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptTitle),this.oa.$("WordAutoCorrect_FloodgatePromptQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptQuestion),
this.oa.$("WordAutoCorrect_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_YesLabel),this.oa.$("WordAutoCorrect_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_NoLabel),this.oa.$("WordAutoCorrect_FloodgateRatingQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateRatingQuestion),this.oa.$("WordAutoCorrect_FloodgateRating_1",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_1),this.oa.$("WordAutoCorrect_FloodgateRating_2",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_2),
this.oa.$("WordAutoCorrect_FloodgateRating_3",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_3),this.oa.$("WordAutoCorrect_FloodgateRating_4",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_4),this.oa.$("WordAutoCorrect_FloodgateRating_5",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_5),this.oa.$("WordAutoCorrect_FloodgateWhyQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateWhyQuestion),this.oa.$("PasswordProtectedDocumentSupport_FloodgatePromptTitle",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptTitle),
this.oa.$("PasswordProtectedDocumentSupport_FloodgatePromptQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptQuestion),this.oa.$("PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel),this.oa.$("PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRatingQuestion",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRatingQuestion),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_1",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_1),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_2",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_2),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_3",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_3),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_4",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_4),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_5",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_5),this.oa.$("PasswordProtectedDocumentSupport_FloodgateWhyQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateWhyQuestion),this.oa.$("WordSimilarity_FloodgatePromptTitle",CommonUIStrings.l_WordSimilarity_FloodgatePromptTitle),this.oa.$("WordSimilarity_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.oa.$("WordSimilarity_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("WordSimilarity_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordSimilarity_FloodgateRatingQuestion",CommonUIStrings.l_WordSimilarity_FloodgateRatingQuestion),this.oa.$("WordSimilarity_FloodgateRating_1",CommonUIStrings.l_WordSimilarity_FloodgateRating_1),this.oa.$("WordSimilarity_FloodgateRating_2",CommonUIStrings.l_WordSimilarity_FloodgateRating_2),this.oa.$("WordSimilarity_FloodgateRating_3",
CommonUIStrings.l_WordSimilarity_FloodgateRating_3),this.oa.$("WordSimilarity_FloodgateRating_4",CommonUIStrings.l_WordSimilarity_FloodgateRating_4),this.oa.$("WordSimilarity_FloodgateRating_5",CommonUIStrings.l_WordSimilarity_FloodgateRating_5),this.oa.$("WordSimilarity_FloodgateWhyQuestion",CommonUIStrings.l_WordSimilarity_FloodgateWhyQuestion),this.oa.$("PremiumPreviewFloodgateTitle",CommonUIStrings.l_PremiumPreview_FeedbackTitle),this.oa.$("PremiumPreviewFloodgatePrompt",CommonUIStrings.l_PremiumPreview_FeedbackPrompt),
this.oa.$("PremiumPreviewFloodgateRatingQuestion",CommonUIStrings.l_PremiumPreview_FeedbackRatingQuestion),this.oa.$("PremiumPreviewFloodgateQuestion",CommonUIStrings.l_PremiumPreview_FeedbackQuestion1),this.oa.$("PremiumPreviewFloodgateMinRating",CommonUIStrings.l_PremiumPreview_FeedbackMinRating),this.oa.$("PremiumPreviewFloodgateMaxRating",CommonUIStrings.l_PremiumPreview_FeedbackMaxRating),this.oa.$("FloodgateNLQSPromptTitle",CommonUIStrings.l_FloodgateNLQSPromptTitle),this.oa.$("FloodgateNLQSPromptSubtitle",
CommonUIStrings.l_FloodgateNLQSPromptSubtitle),this.oa.$("FloodgateNLQSPromptYes",CommonUIStrings.l_FloodgateNLQSPromptYes),this.oa.$("FloodgateNLQSPromptNo",CommonUIStrings.l_FloodgateNLQSPromptNo),this.oa.$("FloodgateNLQSRatingQuestion",CommonUIStrings.l_FloodgateNLQSRatingQuestion),this.oa.$("FloodgateNLQSRating1",CommonUIStrings.l_FloodgateNLQSRating1),this.oa.$("FloodgateNLQSRating2",CommonUIStrings.l_FloodgateNLQSRating2),this.oa.$("FloodgateNLQSRating3",CommonUIStrings.l_FloodgateNLQSRating3),
this.oa.$("FloodgateNLQSRating4",CommonUIStrings.l_FloodgateNLQSRating4),this.oa.$("FloodgateNLQSRating5",CommonUIStrings.l_FloodgateNLQSRating5),this.oa.$("FloodgateNLQSDetailsQuestion",CommonUIStrings.l_FloodgateNLQSDetailsQuestion),this.oa.$("ExcelWebEaseOfUse_Prompt",CommonUIStrings.l_ExcelWeb_EaseOfUse_Prompt),this.oa.$("ExcelWebEaseOfUse_PromptQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_PromptQuestion),this.oa.$("ExcelWebEaseOfUse_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ExcelWebEaseOfUse_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ExcelWebEaseOfUse_RatingQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingQuestion),this.oa.$("ExcelWebEaseOfUse_RatingValue_1",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_1),this.oa.$("ExcelWebEaseOfUse_RatingValue_2",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_2),this.oa.$("ExcelWebEaseOfUse_RatingValue_3",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_3),this.oa.$("ExcelWebEaseOfUse_RatingValue_4",
CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_4),this.oa.$("ExcelWebEaseOfUse_RatingValue_5",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_5),this.oa.$("ExcelWebEaseOfUse_WhyQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_WhyQuestion),this.oa.$("ExcelWebPrintSurvey_Prompt",CommonUIStrings.l_ExcelWeb_PrintSurvey_Prompt),this.oa.$("ExcelWebPrintSurvey_PromptQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_PromptQuestion),this.oa.$("ExcelWebPrintSurvey_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ExcelWebPrintSurvey_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ExcelWebPrintSurvey_RatingQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingQuestion),this.oa.$("ExcelWebPrintSurvey_RatingValue_1",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_1),this.oa.$("ExcelWebPrintSurvey_RatingValue_2",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_2),this.oa.$("ExcelWebPrintSurvey_RatingValue_3",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_3),this.oa.$("ExcelWebPrintSurvey_RatingValue_4",
CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_4),this.oa.$("ExcelWebPrintSurvey_RatingValue_5",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_5),this.oa.$("ExcelWebPrintSurvey_WhyQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_WhyQuestion),this.oa.$("ReactAutoFilter_PromptLine_1",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_1),this.oa.$("ReactAutoFilter_PromptLine_2",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_2),this.oa.$("ReactAutoFilter_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ReactAutoFilter_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ReactAutoFilter_RatingQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_RatingQuestion),this.oa.$("ReactAutoFilter_RatingValue_1",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_1),this.oa.$("ReactAutoFilter_RatingValue_2",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_2),this.oa.$("ReactAutoFilter_RatingValue_3",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_3),this.oa.$("ReactAutoFilter_RatingValue_4",
CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_4),this.oa.$("ReactAutoFilter_RatingValue_5",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_5),this.oa.$("ReactAutoFilter_CommentQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_CommentQuestion),this.oa.$("WordLinksExperience_FloodgatePromptTitle",CommonUIStrings.l_WordLinksExperience_FloodgatePromptTitle),this.oa.$("WordLinksExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordLinksExperience_FloodgatePromptQuestion),this.oa.$("WordLinksExperience_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_YesLabel),this.oa.$("WordLinksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_NoLabel),this.oa.$("WordLinksExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateRatingQuestion),this.oa.$("WordLinksExperience_FloodgateRating_1",CommonUIStrings.l_WordLinksExperience_FloodgateRating_1),this.oa.$("WordLinksExperience_FloodgateRating_2",CommonUIStrings.l_WordLinksExperience_FloodgateRating_2),
this.oa.$("WordLinksExperience_FloodgateRating_3",CommonUIStrings.l_WordLinksExperience_FloodgateRating_3),this.oa.$("WordLinksExperience_FloodgateRating_4",CommonUIStrings.l_WordLinksExperience_FloodgateRating_4),this.oa.$("WordLinksExperience_FloodgateRating_5",CommonUIStrings.l_WordLinksExperience_FloodgateRating_5),this.oa.$("WordLinksExperience_FloodgateWhyQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateWhyQuestion),this.oa.$("OnlineVideoSupport_FloodgatePromptTitle",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptTitle),
this.oa.$("OnlineVideoSupport_FloodgatePromptQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptQuestion),this.oa.$("OnlineVideoSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_YesLabel),this.oa.$("OnlineVideoSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_NoLabel),this.oa.$("OnlineVideoSupport_FloodgateRatingQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateRatingQuestion),this.oa.$("OnlineVideoSupport_FloodgateRating_1",
CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_1),this.oa.$("OnlineVideoSupport_FloodgateRating_2",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_2),this.oa.$("OnlineVideoSupport_FloodgateRating_3",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_3),this.oa.$("OnlineVideoSupport_FloodgateRating_4",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_4),this.oa.$("OnlineVideoSupport_FloodgateRating_5",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_5),this.oa.$("OnlineVideoSupport_FloodgateWhyQuestion",
CommonUIStrings.l_OnlineVideoSupport_FloodgateWhyQuestion),this.oa.$("NavPaneExperience_FloodgatePromptTitle",CommonUIStrings.l_NavPaneExperience_FloodgatePromptTitle),this.oa.$("NavPaneExperience_FloodgatePromptQuestion",CommonUIStrings.l_NavPaneExperience_FloodgatePromptQuestion),this.oa.$("NavPaneExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_YesLabel),this.oa.$("NavPaneExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_NoLabel),
this.oa.$("NavPaneExperience_FloodgateRatingQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateRatingQuestion),this.oa.$("NavPaneExperience_FloodgateRating_1",CommonUIStrings.l_NavPaneExperience_FloodgateRating_1),this.oa.$("NavPaneExperience_FloodgateRating_2",CommonUIStrings.l_NavPaneExperience_FloodgateRating_2),this.oa.$("NavPaneExperience_FloodgateRating_3",CommonUIStrings.l_NavPaneExperience_FloodgateRating_3),this.oa.$("NavPaneExperience_FloodgateRating_4",CommonUIStrings.l_NavPaneExperience_FloodgateRating_4),
this.oa.$("NavPaneExperience_FloodgateRating_5",CommonUIStrings.l_NavPaneExperience_FloodgateRating_5),this.oa.$("NavPaneExperience_FloodgateWhyQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateWhyQuestion),this.oa.$("BookmarksExperience_FloodgatePromptTitle",CommonUIStrings.l_BookmarksExperience_FloodgatePromptTitle),this.oa.$("BookmarksExperience_FloodgatePromptQuestion",CommonUIStrings.l_BookmarksExperience_FloodgatePromptQuestion),this.oa.$("BookmarksExperience_FloodgatePrompt_YesLabel",
CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_YesLabel),this.oa.$("BookmarksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_NoLabel),this.oa.$("BookmarksExperience_FloodgateRatingQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateRatingQuestion),this.oa.$("BookmarksExperience_FloodgateRating_1",CommonUIStrings.l_BookmarksExperience_FloodgateRating_1),this.oa.$("BookmarksExperience_FloodgateRating_2",CommonUIStrings.l_BookmarksExperience_FloodgateRating_2),
this.oa.$("BookmarksExperience_FloodgateRating_3",CommonUIStrings.l_BookmarksExperience_FloodgateRating_3),this.oa.$("BookmarksExperience_FloodgateRating_4",CommonUIStrings.l_BookmarksExperience_FloodgateRating_4),this.oa.$("BookmarksExperience_FloodgateRating_5",CommonUIStrings.l_BookmarksExperience_FloodgateRating_5),this.oa.$("BookmarksExperience_FloodgateWhyQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateWhyQuestion),this.oa.$("WordPictureBorder_FloodgatePromptTitle",CommonUIStrings.l_WordPictureBorder_FloodgatePromptTitle),
this.oa.$("WordPictureBorder_FloodgatePromptQuestion",CommonUIStrings.l_WordPictureBorder_FloodgatePromptQuestion),this.oa.$("WordPictureBorder_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_YesLabel),this.oa.$("WordPictureBorder_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_NoLabel),this.oa.$("WordPictureBorder_FloodgateRatingQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateRatingQuestion),this.oa.$("WordPictureBorder_FloodgateRating_1",
CommonUIStrings.l_WordPictureBorder_FloodgateRating_1),this.oa.$("WordPictureBorder_FloodgateRating_2",CommonUIStrings.l_WordPictureBorder_FloodgateRating_2),this.oa.$("WordPictureBorder_FloodgateRating_3",CommonUIStrings.l_WordPictureBorder_FloodgateRating_3),this.oa.$("WordPictureBorder_FloodgateRating_4",CommonUIStrings.l_WordPictureBorder_FloodgateRating_4),this.oa.$("WordPictureBorder_FloodgateRating_5",CommonUIStrings.l_WordPictureBorder_FloodgateRating_5),this.oa.$("WordPictureBorder_FloodgateWhyQuestion",
CommonUIStrings.l_WordPictureBorder_FloodgateWhyQuestion),this.oa.$("WordComment_FloodgatePromptTitle",CommonUIStrings.l_WordComment_FloodgatePromptTitle),this.oa.$("WordComment_FloodgatePromptQuestion",CommonUIStrings.l_WordComment_FloodgatePromptQuestion),this.oa.$("WordComment_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_YesLabel),this.oa.$("WordComment_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_NoLabel),this.oa.$("WordComment_FloodgateRatingQuestion",
CommonUIStrings.l_WordComment_FloodgateRatingQuestion),this.oa.$("WordComment_FloodgateRating_1",CommonUIStrings.l_WordComment_FloodgateRating_1),this.oa.$("WordComment_FloodgateRating_2",CommonUIStrings.l_WordComment_FloodgateRating_2),this.oa.$("WordComment_FloodgateRating_3",CommonUIStrings.l_WordComment_FloodgateRating_3),this.oa.$("WordComment_FloodgateRating_4",CommonUIStrings.l_WordComment_FloodgateRating_4),this.oa.$("WordComment_FloodgateRating_5",CommonUIStrings.l_WordComment_FloodgateRating_5),
this.oa.$("WordComment_FloodgateWhyQuestion",CommonUIStrings.l_WordComment_FloodgateWhyQuestion),this.oa.$("WordTrackChanges_FloodgatePromptTitle",CommonUIStrings.l_WordTrackChanges_FloodgatePromptTitle),this.oa.$("WordTrackChanges_FloodgatePromptQuestion",CommonUIStrings.l_WordTrackChanges_FloodgatePromptQuestion),this.oa.$("WordTrackChanges_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_YesLabel),this.oa.$("WordTrackChanges_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_NoLabel),
this.oa.$("WordTrackChanges_FloodgateRatingQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateRatingQuestion),this.oa.$("WordTrackChanges_FloodgateRating_1",CommonUIStrings.l_WordTrackChanges_FloodgateRating_1),this.oa.$("WordTrackChanges_FloodgateRating_2",CommonUIStrings.l_WordTrackChanges_FloodgateRating_2),this.oa.$("WordTrackChanges_FloodgateRating_3",CommonUIStrings.l_WordTrackChanges_FloodgateRating_3),this.oa.$("WordTrackChanges_FloodgateRating_4",CommonUIStrings.l_WordTrackChanges_FloodgateRating_4),
this.oa.$("WordTrackChanges_FloodgateRating_5",CommonUIStrings.l_WordTrackChanges_FloodgateRating_5),this.oa.$("WordTrackChanges_FloodgateWhyQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateWhyQuestion),this.oa.$("CollabCornerFloodgateSurveyFileSharedStatus_Prompt_Line_1",CommonUIStrings.l_CollabCornerFloodgateSurveyFileSharedStatus_Prompt_Line_1),this.oa.$("CollabCornerFloodgateSurveyFileSharedStatus_Prompt_Line_2",CommonUIStrings.l_CollabCornerFloodgateSurveyFileSharedStatus_Prompt_Line_2),
this.oa.$("CollabCornerFloodgateSurveyFileSharedStatus_Prompt_Yes_Label",CommonUIStrings.l_CollabCornerFloodgateSurveyFileSharedStatus_Prompt_Yes_Label),this.oa.$("CollabCornerFloodgateSurveyFileSharedStatus_Prompt_No_Label",CommonUIStrings.l_CollabCornerFloodgateSurveyFileSharedStatus_Prompt_No_Label),this.oa.$("CollabCornerFloodgateSurveyFileSharedStatus_Rating_Question",CommonUIStrings.l_CollabCornerFloodgateSurveyFileSharedStatus_Rating_Question),this.oa.$("CollabCornerFloodgateSurveyFileSharedStatus_RatingScale_1",
CommonUIStrings.l_CollabCornerFloodgateSurveyFileSharedStatus_RatingScale_1),this.oa.$("CollabCornerFloodgateSurveyFileSharedStatus_RatingScale_2",CommonUIStrings.l_CollabCornerFloodgateSurveyFileSharedStatus_RatingScale_2),this.oa.$("CollabCornerFloodgateSurveyFileSharedStatus_RatingScale_3",CommonUIStrings.l_CollabCornerFloodgateSurveyFileSharedStatus_RatingScale_3),this.oa.$("CollabCornerFloodgateSurveyFileSharedStatus_Comment_Question",CommonUIStrings.l_CollabCornerFloodgateSurveyFileSharedStatus_Comment_Question),
this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_1),this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_2),this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_YesLabel),this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_NoLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_NoLabel),
this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Question),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_1),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_2),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_3",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_3),
this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_4",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_4),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_5",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_5),this.oa.$("CollabCorner_Survey_DownloadCopies_Comment_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Comment_Question),this.oa.$("CollabCorner_Survey_SharingComplexity_Prompt_Line_1",CommonUIStrings.l_CollabCorner_Survey_SharingComplexity_Prompt_Line_1),
this.oa.$("CollabCorner_Survey_SharingComplexity_Prompt_Line_2",CommonUIStrings.l_CollabCorner_Survey_SharingComplexity_Prompt_Line_2),this.oa.$("CollabCorner_Survey_SharingComplexity_Prompt_YesLabel",CommonUIStrings.l_CollabCorner_Survey_SharingComplexity_Prompt_YesLabel),this.oa.$("CollabCorner_Survey_SharingComplexity_Prompt_NoLabel",CommonUIStrings.l_CollabCorner_Survey_SharingComplexity_Prompt_NoLabel),this.oa.$("CollabCorner_Survey_SharingComplexity_Rating_Question",CommonUIStrings.l_CollabCorner_Survey_SharingComplexity_Rating_Question),
this.oa.$("CollabCorner_Survey_SharingComplexity_Rating_Scale_1",CommonUIStrings.l_CollabCorner_Survey_SharingComplexity_Rating_Scale_1),this.oa.$("CollabCorner_Survey_SharingComplexity_Rating_Scale_2",CommonUIStrings.l_CollabCorner_Survey_SharingComplexity_Rating_Scale_2),this.oa.$("CollabCorner_Survey_SharingComplexity_Comment_Question",CommonUIStrings.l_CollabCorner_Survey_SharingComplexity_Comment_Question),this.oa.$("WordListsExperience_FloodgatePromptTitle",CommonUIStrings.l_WordListsExperience_FloodgatePromptTitle),
this.oa.$("WordListsExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordListsExperience_FloodgatePromptQuestion),this.oa.$("WordListsExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_YesLabel),this.oa.$("WordListsExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_NoLabel),this.oa.$("WordListsExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordListsExperience_FloodgateRatingQuestion),this.oa.$("WordListsExperience_FloodgateRating_1",
CommonUIStrings.l_WordListsExperience_FloodgateRating_1),this.oa.$("WordListsExperience_FloodgateRating_5",CommonUIStrings.l_WordListsExperience_FloodgateRating_5),this.oa.$("WordListsExperience_FloodgateAdditionalThoughts",CommonUIStrings.l_WordListsExperience_FloodgateAdditionalThoughts),this.oa.$("WordChartsSupport_FloodgatePromptTitle",CommonUIStrings.l_WordChartsSupport_FloodgatePromptTitle),this.oa.$("WordChartsSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordChartsSupport_FloodgatePromptQuestion),
this.oa.$("WordChartsSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_YesLabel),this.oa.$("WordChartsSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_NoLabel),this.oa.$("WordChartsSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateRatingQuestion),this.oa.$("WordChartsSupport_FloodgateRating_1",CommonUIStrings.l_WordChartsSupport_FloodgateRating_1),this.oa.$("WordChartsSupport_FloodgateRating_2",CommonUIStrings.l_WordChartsSupport_FloodgateRating_2),
this.oa.$("WordChartsSupport_FloodgateRating_3",CommonUIStrings.l_WordChartsSupport_FloodgateRating_3),this.oa.$("WordChartsSupport_FloodgateRating_4",CommonUIStrings.l_WordChartsSupport_FloodgateRating_4),this.oa.$("WordChartsSupport_FloodgateRating_5",CommonUIStrings.l_WordChartsSupport_FloodgateRating_5),this.oa.$("WordChartsSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateWhyQuestion),this.oa.$("WordTablesSupport_FloodgatePromptTitle",CommonUIStrings.l_WordTablesSupport_FloodgatePromptTitle),
this.oa.$("WordTablesSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordTablesSupport_FloodgatePromptQuestion),this.oa.$("WordTablesSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_YesLabel),this.oa.$("WordTablesSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_NoLabel),this.oa.$("WordTablesSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateRatingQuestion),this.oa.$("WordTablesSupport_FloodgateRating_1",
CommonUIStrings.l_WordTablesSupport_FloodgateRating_1),this.oa.$("WordTablesSupport_FloodgateRating_2",CommonUIStrings.l_WordTablesSupport_FloodgateRating_2),this.oa.$("WordTablesSupport_FloodgateRating_3",CommonUIStrings.l_WordTablesSupport_FloodgateRating_3),this.oa.$("WordTablesSupport_FloodgateRating_4",CommonUIStrings.l_WordTablesSupport_FloodgateRating_4),this.oa.$("WordTablesSupport_FloodgateRating_5",CommonUIStrings.l_WordTablesSupport_FloodgateRating_5),this.oa.$("WordTablesSupport_FloodgateWhyQuestion",
CommonUIStrings.l_WordTablesSupport_FloodgateWhyQuestion),this.oa.$("ModernPresence_PromptLine_1",CommonUIStrings.l_Excel_ModernPresence_PromptLine_1),this.oa.$("ModernPresence_PromptLine_2",CommonUIStrings.l_Excel_ModernPresence_PromptLine_2),this.oa.$("ModernPresence_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ModernPresence_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ModernPresence_RatingQuestion",CommonUIStrings.l_Excel_ModernPresence_RatingQuestion),
this.oa.$("ModernPresence_RatingValue_1",CommonUIStrings.l_Excel_ModernPresence_RatingValue_1),this.oa.$("ModernPresence_RatingValue_2",CommonUIStrings.l_Excel_ModernPresence_RatingValue_2),this.oa.$("ModernPresence_RatingValue_3",CommonUIStrings.l_Excel_ModernPresence_RatingValue_3),this.oa.$("ModernPresence_RatingValue_4",CommonUIStrings.l_Excel_ModernPresence_RatingValue_4),this.oa.$("ModernPresence_RatingValue_5",CommonUIStrings.l_Excel_ModernPresence_RatingValue_5),this.oa.$("ModernPresence_CommentQuestion",
CommonUIStrings.l_Excel_ModernPresence_CommentQuestion),this.oa.$("WordInsertImages_FloodgatePromptTitle",CommonUIStrings.l_WordInsertImages_FloodgatePromptTitle),this.oa.$("WordInsertImages_FloodgatePromptQuestion",CommonUIStrings.l_WordInsertImages_FloodgatePromptQuestion),this.oa.$("WordInsertImages_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_YesLabel),this.oa.$("WordInsertImages_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_NoLabel),
this.oa.$("WordInsertImages_FloodgateRatingQuestion",CommonUIStrings.l_WordInsertImages_FloodgateRatingQuestion),this.oa.$("WordInsertImages_FloodgateRating_1",CommonUIStrings.l_WordInsertImages_FloodgateRating_1),this.oa.$("WordInsertImages_FloodgateRating_2",CommonUIStrings.l_WordInsertImages_FloodgateRating_2),this.oa.$("WordInsertImages_FloodgateRating_3",CommonUIStrings.l_WordInsertImages_FloodgateRating_3),this.oa.$("WordInsertImages_FloodgateRating_4",CommonUIStrings.l_WordInsertImages_FloodgateRating_4),
this.oa.$("WordInsertImages_FloodgateRating_5",CommonUIStrings.l_WordInsertImages_FloodgateRating_5),this.oa.$("WordInsertImages_FloodgateWhyQuestion",CommonUIStrings.l_WordInsertImages_FloodgateWhyQuestion),this.oa.$("FontPicker_FloodgatePromptTitle",CommonUIStrings.l_FontPicker_FloodgatePromptTitle),this.oa.$("FontPicker_FloodgatePromptQuestion",CommonUIStrings.l_FontPicker_FloodgatePromptQuestion),this.oa.$("FontPicker_FloodgatePromptYesLabel",CommonUIStrings.l_FontPicker_FloodgatePromptYesLabel),
this.oa.$("FontPicker_FloodgatePromptNoLabel",CommonUIStrings.l_FontPicker_FloodgatePromptNoLabel),this.oa.$("FontPicker_FloodgateRatingQuestion",CommonUIStrings.l_FontPicker_FloodgateRatingQuestion),this.oa.$("FontPicker_FloodgateRating1",CommonUIStrings.l_FontPicker_FloodgateRating1),this.oa.$("FontPicker_FloodgateRating2",CommonUIStrings.l_FontPicker_FloodgateRating2),this.oa.$("FontPicker_FloodgateRating3",CommonUIStrings.l_FontPicker_FloodgateRating3),this.oa.$("FontPicker_FloodgateRating4",
CommonUIStrings.l_FontPicker_FloodgateRating4),this.oa.$("FontPicker_FloodgateRating5",CommonUIStrings.l_FontPicker_FloodgateRating5),this.oa.$("FontPicker_FloodgateCommentQuestion",CommonUIStrings.l_FontPicker_FloodgateCommentQuestion),this.oa.$("FormulasMenu_PromptLine_1",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_1),this.oa.$("FormulasMenu_PromptLine_2",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_2),this.oa.$("FormulasMenu_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("FormulasMenu_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FormulasMenu_RatingQuestion",CommonUIStrings.l_Excel_FormulasMenu_RatingQuestion),this.oa.$("FormulasMenu_RatingValue_1",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_1),this.oa.$("FormulasMenu_RatingValue_2",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_2),this.oa.$("FormulasMenu_RatingValue_3",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_3),this.oa.$("FormulasMenu_RatingValue_4",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_4),
this.oa.$("FormulasMenu_RatingValue_5",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_5),this.oa.$("FormulasMenu_CommentQuestion",CommonUIStrings.l_Excel_FormulasMenu_CommentQuestion),this.oa.$("WordWebEditorSeen_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.oa.$("WordWebEditorSeen_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("WordWebEditorSeen_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("WordWebEditorSeen_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordWebEditorSeen_FloodgateRatingQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateRatingQuestion),this.oa.$("WordWebEditorSeen_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyNegative),this.oa.$("WordWebEditorSeen_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatNegative),this.oa.$("WordWebEditorSeen_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive),
this.oa.$("WordWebEditorSeen_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatPositive),this.oa.$("WordWebEditorSeen_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyPositive),this.oa.$("WordWebEditorSeen_FloodgateWhyQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateWhyQuestion),this.oa.$("OnenotePerf_FloodgatePromptTitle",lc.Hfj()),this.oa.$("OnenotePerf_FloodgatePromptQuestion",CommonUIStrings.l_OnenotePerf_FloodgatePromptQuestion),this.oa.$("OnenotePerf_FloodgatePrompt_YesLabel",
CommonUIStrings.l_OnenotePerf_FloodgatePrompt_YesLabel),this.oa.$("OnenotePerf_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_NoLabel),this.oa.$("OnenotePerf_FloodgateRatingQuestion",lc.Ifj()),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_1",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_1),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_2",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_2),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_3",
CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_3),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_4",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_4),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_5",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_5),this.oa.$("OnenotePerf_FloodgateWhyQuestion",CommonUIStrings.l_OnenotePerf_FloodgateWhyQuestion),this.oa.$("OnenoteInkSurvey_Prompt",CommonUIStrings.l_OnenoteInkSurvey_Prompt),this.oa.$("OnenoteInkSurvey_PromptQuestion",
CommonUIStrings.l_InkSurvey_PromptQuestion),this.oa.$("OnenoteInkSurvey_Prompt_Sure",CommonUIStrings.l_InkSurvey_Prompt_Sure),this.oa.$("OnenoteInkSurvey_Prompt_NoNow",CommonUIStrings.l_InkSurvey_Prompt_NoNow),this.oa.$("OnenoteInkSurvey_RatingQuestion",CommonUIStrings.l_OnenoteInkSurvey_RatingQuestion),this.oa.$("OnenoteInkSurvey_QuestionChoice_1",CommonUIStrings.l_InkSurvey_QuestionChoice_1),this.oa.$("OnenoteInkSurvey_QuestionChoice_2",CommonUIStrings.l_InkSurvey_QuestionChoice_2),this.oa.$("OnenoteInkSurvey_QuestionChoice_3",
CommonUIStrings.l_InkSurvey_QuestionChoice_3),this.oa.$("OnenoteInkSurvey_QuestionChoice_4",CommonUIStrings.l_InkSurvey_QuestionChoice_4),this.oa.$("OnenoteInkSurvey_QuestionChoice_5",CommonUIStrings.l_InkSurvey_QuestionChoice_5),this.oa.$("OnenoteInkSurvey_WhyQuestion",CommonUIStrings.l_InkSurvey_WhyQuestion),this.oa.$("OnenotePenInkSurvey_Prompt",CommonUIStrings.l_OnenotePenInkSurvey_Prompt),this.oa.$("OnenotePenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),this.oa.$("OnenotePenInkSurvey_Prompt_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("OnenotePenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("OnenotePenInkSurvey_RatingQuestion",CommonUIStrings.l_OnenotePenInkSurvey_RatingQuestion),this.oa.$("OnenotePenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("OnenotePenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.oa.$("OnenotePenInkSurvey_QuestionChoice_3",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.oa.$("OnenotePenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.oa.$("OnenotePenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("OnenotePenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.oa.$("PenInkSurvey_Prompt",CommonUIStrings.l_PenInkSurvey_Prompt),this.oa.$("PenInkSurvey_RatingQuestion",
CommonUIStrings.l_PenInkSurvey_RatingQuestion),this.oa.$("PenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),this.oa.$("PenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("PenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("PenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("PenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.oa.$("PenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.oa.$("PenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.oa.$("PenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("PenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.oa.$("SkittleFloodgateTitle",CommonUIStrings.l_Skittle_FeedbackTitle),this.oa.$("SkittleFloodgatePrompt",
CommonUIStrings.l_Skittle_FeedbackPrompt),this.oa.$("SkittleFloodgateRatingQuestion",CommonUIStrings.l_Skittle_FeedbackRatingQuestion),this.oa.$("SkittleFloodgateQuestion",CommonUIStrings.l_Skittle_FeedbackQuestion),this.oa.$("SkittleFloodgateMinRating",CommonUIStrings.l_Skittle_FeedbackMinRating),this.oa.$("SkittleFloodgateMaxRating",CommonUIStrings.l_Skittle_FeedbackMaxRating),this.oa.$("WordDocumentModes_FloodgatePromptTitle",CommonUIStrings.l_WordDocumentModes_FloodgatePromptTitle),this.oa.$("WordDocumentModes_FloodgatePromptQuestion",
CommonUIStrings.l_WordDocumentModes_FloodgatePromptQuestion),this.oa.$("WordDocumentModes_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_YesLabel),this.oa.$("WordDocumentModes_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_NoLabel),this.oa.$("WordDocumentModes_FloodgateRatingQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateRatingQuestion),this.oa.$("WordDocumentModes_FloodgateRating_1",CommonUIStrings.l_WordDocumentModes_FloodgateRating_1),
this.oa.$("WordDocumentModes_FloodgateRating_5",CommonUIStrings.l_WordDocumentModes_FloodgateRating_5),this.oa.$("WordDocumentModes_FloodgateWhyQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateWhyQuestion),this.oa.$("WordDesignerFloodgateTitle",CommonUIStrings.l_WordDesigner_FeedbackTitle),this.oa.$("WordDesignerFloodgatePrompt",CommonUIStrings.l_WordDesigner_FeedbackPrompt),this.oa.$("WordDesignerFloodgatePromptYesLabel",CommonUIStrings.l_WordDesigner_FloodgatePrompt_YesLabel),this.oa.$("WordDesignerFloodgatePromptNoLabel",
CommonUIStrings.l_WordDesigner_FloodgatePrompt_NoLabel),this.oa.$("WordDesignerFloodgateRatingQuestion",CommonUIStrings.l_WordDesigner_FeedbackRatingQuestion),this.oa.$("WordDesignerFloodgateMinRating",CommonUIStrings.l_WordDesigner_FeedbackMinRating),this.oa.$("WordDesignerFloodgateMaxRating",CommonUIStrings.l_WordDesigner_FeedbackMaxRating),this.oa.$("WordDesignerFloodgateQuestion",CommonUIStrings.l_WordDesigner_FeedbackQuestion1),this.oa.$("WordDesignerT2ISurveyQuestion",CommonUIStrings.l_WordDesigner_T2ISurveyQuestion),
this.oa.$("WordDesignerPQSurveyQuestion",CommonUIStrings.l_WordDesigner_PQSurveyQuestion),this.oa.$("WordDesignerFormattingSuggestionsSurveyQuestion",CommonUIStrings.l_WordDesigner_FormattingSuggestionsSurveyQuestion),this.oa.$("WordDesignerAllContextualSuggestionsFeedbackRatingQuestion",CommonUIStrings.l_WordDesigner_AllContextualSuggestionsFeedbackRatingQuestion),this.oa.$("WordDesignerDesignerPasteFeedbackRatingQuestion",lc.Jfj()),this.oa.$("WordDesignerHideSuggestionsQuestion",CommonUIStrings.l_WordDesigner_HideSuggestionsQuestion),
this.oa.$("WordDesignerHideSuggestionsAnswer1",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_1),this.oa.$("WordDesignerHideSuggestionsAnswer2",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_2),this.oa.$("WordDesignerHideSuggestionsAnswer3",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_3),this.oa.$("WordDesignerHideSuggestionsAnswer4",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_4),this.oa.$("FpsInDocSearch_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptTitle),
this.oa.$("FpsInDocSearch_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptQuestion),this.oa.$("FpsInDocSearch_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("FpsInDocSearch_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FpsInDocSearch_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateRatingQuestion),this.oa.$("FpsInDocSearch_FloodgateRating_1",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_1),
this.oa.$("FpsInDocSearch_FloodgateRating_2",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_2),this.oa.$("FpsInDocSearch_FloodgateRating_3",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_3),this.oa.$("FpsInDocSearch_FloodgateRating_4",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_4),this.oa.$("FpsInDocSearch_FloodgateRating_5",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_5),this.oa.$("FpsInDocSearch_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateWhyQuestion),this.oa.$("FpsInDocQna_FloodgatePromptTitle",
CommonUIStrings.l_FpsInDocQna_FloodgatePromptTitle),this.oa.$("FpsInDocQna_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocQna_FloodgatePromptQuestion),this.oa.$("FpsInDocQna_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("FpsInDocQna_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FpsInDocQna_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateRatingQuestion),this.oa.$("FpsInDocQna_FloodgateRating_1",CommonUIStrings.l_FpsInDocQna_FloodgateRating_1),
this.oa.$("FpsInDocQna_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.oa.$("FpsInDocQna_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.oa.$("FpsInDocQna_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.oa.$("FpsInDocQna_FloodgateRating_5",CommonUIStrings.l_FpsInDocQna_FloodgateRating_5),this.oa.$("FpsInDocQna_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateWhyQuestion),this.oa.$("AtMentionFPS_Title",
CommonUIStrings.l_WAC_AtMentionFPS_Title),this.oa.$("AtMentionFPS_Question",CommonUIStrings.l_WAC_AtMentionFPS_Question),this.oa.$("AtMentionFPS_YesLabel",CommonUIStrings.l_WAC_AtMentionFPS_YesLabel),this.oa.$("AtMentionFPS_NoLabel",CommonUIStrings.l_WAC_AtMentionFPS_NoLabel),this.oa.$("AtMentionFPS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFPS_RatingQuestion),this.oa.$("AtMentionFPS_RatingValue_1",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_1),this.oa.$("AtMentionFPS_RatingValue_2",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_2),
this.oa.$("AtMentionFPS_RatingValue_3",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_3),this.oa.$("AtMentionFPS_RatingValue_4",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_4),this.oa.$("AtMentionFPS_RatingValue_5",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_5),this.oa.$("AtMentionFPS_WhyQuestion",CommonUIStrings.l_WAC_AtMentionFPS_WhyQuestion),this.oa.$("ClientPaginationSurvey_Title",CommonUIStrings.l_WAC_ClientPaginationSurvey_Title),this.oa.$("ClientPaginationSurvey_Question",CommonUIStrings.l_WAC_ClientPaginationSurvey_Question),
this.oa.$("ClientPaginationSurvey_YesLabel",CommonUIStrings.l_WAC_ClientPaginationSurvey_YesLabel),this.oa.$("ClientPaginationSurvey_NoLabel",CommonUIStrings.l_WAC_ClientPaginationSurvey_NoLabel),this.oa.$("ClientPaginationSurvey_RatingQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingQuestion),this.oa.$("ClientPaginationSurvey_RatingValue_1",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_1),this.oa.$("ClientPaginationSurvey_RatingValue_2",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_2),
this.oa.$("ClientPaginationSurvey_RatingValue_3",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_3),this.oa.$("ClientPaginationSurvey_RatingValue_4",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_4),this.oa.$("ClientPaginationSurvey_RatingValue_5",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_5),this.oa.$("ClientPaginationSurvey_WhyQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_WhyQuestion),this.oa.$("CIQAtInvokeFPS_Title",CommonUIStrings.l_WAC_CIQAtInvokeFPS_Title),
this.oa.$("CIQAtInvokeFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("CIQAtInvokeFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("CIQAtInvokeFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("CIQAtInvokeFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_RatingQuestion),this.oa.$("CIQAtInvokeFPS_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.oa.$("CIQAtInvokeFPS_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),
this.oa.$("CIQAtInvokeFPS_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.oa.$("CIQAtInvokeFPS_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.oa.$("CIQAtInvokeFPS_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.oa.$("CIQAtInvokeFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_WhyQuestion),this.oa.$("ConditionalFormatting_PromptLine_1",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_1),this.oa.$("ConditionalFormatting_PromptLine_2",
CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_2),this.oa.$("ConditionalFormatting_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ConditionalFormatting_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ConditionalFormatting_RatingQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_RatingQuestion),this.oa.$("ConditionalFormatting_RatingValue_1",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_1),this.oa.$("ConditionalFormatting_RatingValue_2",
CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_2),this.oa.$("ConditionalFormatting_RatingValue_3",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_3),this.oa.$("ConditionalFormatting_RatingValue_4",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_4),this.oa.$("ConditionalFormatting_RatingValue_5",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_5),this.oa.$("ConditionalFormatting_CommentQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_CommentQuestion),
this.oa.$("InAppNotification_Title",CommonUIStrings.l_WAC_InAppNotification_Title),this.oa.$("InAppNotification_Description",CommonUIStrings.l_WAC_InAppNotification_Description),this.oa.$("InAppNotification_Button1_AddinTab",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinTab),this.oa.$("InAppNotification_Button1_AddinButton",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinButton),this.oa.$("InAppNotification_Button2",CommonUIStrings.l_WAC_InAppNotification_Button2),this.oa.$("BlueDotsFPS_Title",
CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.oa.$("BlueDotsFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("BlueDotsFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("BlueDotsFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("BlueDotsFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_RatingQuestion),this.oa.$("BlueDotsFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.oa.$("BlueDotsFPS_RatingValue_2",
CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.oa.$("BlueDotsFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.oa.$("BlueDotsFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.oa.$("BlueDotsFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.oa.$("BlueDotsFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_WhyQuestion),this.oa.$("WordWebOpeningDocuments_FloodgatePromptTitle",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptTitle),
this.oa.$("WordWebOpeningDocuments_FloodgatePromptQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptQuestion),this.oa.$("WordWebOpeningDocuments_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_YesLabel),this.oa.$("WordWebOpeningDocuments_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_NoLabel),this.oa.$("WordWebOpeningDocuments_FloodgateRatingQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRatingQuestion),
this.oa.$("WordWebOpeningDocuments_FloodgateRating_1",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_1),this.oa.$("WordWebOpeningDocuments_FloodgateRating_2",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_2),this.oa.$("WordWebOpeningDocuments_FloodgateRating_3",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_3),this.oa.$("WordWebOpeningDocuments_FloodgateRating_4",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_4),this.oa.$("WordWebOpeningDocuments_FloodgateRating_5",
CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_5),this.oa.$("WordWebOpeningDocuments_FloodgateTellUsMoreQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateTellUsMore),this.oa.$("WordCommentReaction_FloodgatePromptTitle",CommonUIStrings.l_WordCommentReaction_FloodgatePromptTitle),this.oa.$("WordCommentReaction_FloodgatePromptQuestion",CommonUIStrings.l_WordCommentReaction_FloodgatePromptQuestion),this.oa.$("WordCommentReaction_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_YesLabel),
this.oa.$("WordCommentReaction_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_NoLabel),this.oa.$("WordCommentReaction_FloodgateRatingQuestion",CommonUIStrings.l_WordCommentReaction_FloodgateRatingQuestion),this.oa.$("WordCommentReaction_FloodgateRating_1",CommonUIStrings.l_WordCommentReaction_FloodgateRating_1),this.oa.$("WordCommentReaction_FloodgateRating_2",CommonUIStrings.l_WordCommentReaction_FloodgateRating_2),this.oa.$("WordCommentReaction_FloodgateRating_3",
CommonUIStrings.l_WordCommentReaction_FloodgateRating_3),this.oa.$("WordCommentReaction_FloodgateRating_4",CommonUIStrings.l_WordCommentReaction_FloodgateRating_4),this.oa.$("WordCommentReaction_FloodgateRating_5",CommonUIStrings.l_WordCommentReaction_FloodgateRating_5),this.oa.$("WordCommentReaction_FloodgateWhyQuestion",CommonUIStrings.l_WordCommentReaction_FloodgateWhyQuestion),this.oa.$("GuestCoauthoring_FloodgatePromptTitle",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptTitle),this.oa.$("GuestCoauthoring_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptQuestion),this.oa.$("GuestCoauthoring_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GuestCoauthSurvey_YesLabel),this.oa.$("GuestCoauthoring_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GuestCoauthSurvey_NoLabel),this.oa.$("GuestCoauthoring_FloodgateQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_FloodgateQuestion),this.oa.$("GuestCoauthoring_FloodgateRatingValue_1",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_1),this.oa.$("GuestCoauthoring_FloodgateRatingValue_2",
CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_2),this.oa.$("GuestCoauthoring_FloodgateRatingValue_3",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_3),this.oa.$("GuestCoauthoring_FloodgateRatingValue_4",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_4),this.oa.$("GuestCoauthoring_FloodgateRatingValue_5",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_5),this.oa.$("GuestCoauthoring_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingQuestion),this.oa.$("CtrlClickExperience_FloodgatePromptTitle",
CommonUIStrings.l_CtrlClickExperience_FloodgatePromptTitle),this.oa.$("CtrlClickExperience_FloodgatePromptQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptQuestion),this.oa.$("CtrlClickExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_YesLabel),this.oa.$("CtrlClickExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_NoLabel),this.oa.$("CtrlClickExperience_FloodgateRatingQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateRatingQuestion),
this.oa.$("CtrlClickExperience_FloodgateRating_1",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_1),this.oa.$("CtrlClickExperience_FloodgateRating_2",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_2),this.oa.$("CtrlClickExperience_FloodgateRating_3",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_3),this.oa.$("CtrlClickExperience_FloodgateRating_4",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_4),this.oa.$("CtrlClickExperience_FloodgateRating_5",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_5),
this.oa.$("CtrlClickExperience_FloodgateWhyQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateWhyQuestion),this.oa.$("WordTypingResponsiveness_FloodgatePromptTitle",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptTitle),this.oa.$("WordTypingResponsiveness_FloodgatePromptQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptQuestion),this.oa.$("WordTypingResponsiveness_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_YesLabel),this.oa.$("WordTypingResponsiveness_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_NoLabel),this.oa.$("WordTypingResponsiveness_FloodgateRatingQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRatingQuestion),this.oa.$("WordTypingResponsiveness_FloodgateRating_1",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_1),this.oa.$("WordTypingResponsiveness_FloodgateRating_2",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_2),this.oa.$("WordTypingResponsiveness_FloodgateRating_3",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_3),
this.oa.$("WordTypingResponsiveness_FloodgateRating_4",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_4),this.oa.$("WordTypingResponsiveness_FloodgateRating_5",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_5),this.oa.$("WordTypingResponsiveness_FloodgateWhyQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgateWhyQuestion),this.oa.$("ShareSection_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_PromptLine_1),this.oa.$("ShareSection_PromptLine_2",CommonUIStrings.l_Excel_ShareSection_PromptLine_2),
this.oa.$("ShareSection_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ShareSection_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ShareSection_RatingQuestion",CommonUIStrings.l_Excel_ShareSection_RatingQuestion),this.oa.$("ShareSection_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.oa.$("ShareSection_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.oa.$("ShareSection_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),
this.oa.$("ShareSection_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.oa.$("ShareSection_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.oa.$("ShareSection_CommentQuestion",CommonUIStrings.l_Excel_ShareSection_CommentQuestion),this.oa.$("ShareSection_LinkCreation_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_LinkGeneration_PromptLine_1),this.oa.$("WordUnsavedPrompt_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.oa.$("WordUnsavedPrompt_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("WordUnsavedPrompt_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("WordUnsavedPrompt_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordUnsavedPrompt_FloodgateRatingQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRatingQuestion),this.oa.$("WordUnsavedPrompt_FloodgateRating_1",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_1),this.oa.$("WordUnsavedPrompt_FloodgateRating_2",
CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_2),this.oa.$("WordUnsavedPrompt_FloodgateRating_3",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_3),this.oa.$("WordUnsavedPrompt_FloodgateRating_4",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_4),this.oa.$("WordUnsavedPrompt_FloodgateRating_5",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_5),this.oa.$("WordUnsavedPrompt_FloodgateWhyQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateWhyQuestion),this.oa.$("ExcelLive_PromptLine_1",
CommonUIStrings.l_Excel_ExcelLive_PromptLine_1),this.oa.$("ExcelLive_PromptLine_2",CommonUIStrings.l_Excel_ExcelLive_PromptLine_2),this.oa.$("ExcelLive_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ExcelLive_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ExcelLive_RatingQuestion",CommonUIStrings.l_Excel_ExcelLive_RatingQuestion),this.oa.$("ExcelLive_RatingValue_1",CommonUIStrings.l_Excel_ExcelLive_RatingValue_1),this.oa.$("ExcelLive_RatingValue_2",
CommonUIStrings.l_Excel_ExcelLive_RatingValue_2),this.oa.$("ExcelLive_RatingValue_3",CommonUIStrings.l_Excel_ExcelLive_RatingValue_3),this.oa.$("ExcelLive_RatingValue_4",CommonUIStrings.l_Excel_ExcelLive_RatingValue_4),this.oa.$("ExcelLive_RatingValue_5",CommonUIStrings.l_Excel_ExcelLive_RatingValue_5),this.oa.$("ExcelLive_CommentQuestion",CommonUIStrings.l_Excel_ExcelLive_CommentQuestion),this.oa.$("SmartViewFormatAsTable_Prompt",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Prompt),this.oa.$("SmartViewFormatAsTable_PromptQuestion",
CommonUIStrings.l_Excel_SmartViewFormatAsTable_PromptQuestion),this.oa.$("SmartViewFormatAsTable_Rating_Question",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Rating_Question),this.oa.$("SmartViewFormatAsTable_RatingValue_1",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_1),this.oa.$("SmartViewFormatAsTable_RatingValue_2",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_2),this.oa.$("SmartViewFormatAsTable_RatingValue_3",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_3),
this.oa.$("SmartViewFormatAsTable_RatingValue_4",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_4),this.oa.$("SmartViewFormatAsTable_RatingValue_5",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_5),this.oa.$("SmartViewFormatAsTable_WhyQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_WhyQuestion),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_PromptTitle),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingQuestion),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_1),
this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_2),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_3),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_4",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_4),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_5),
this.oa.$("EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion),this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_PromptTitle),this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingQuestion",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingQuestion),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_1),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_2),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_3",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_3),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_4",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_4),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_5),this.oa.$("EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion),this.oa.$("EaseOfUse_Floodgate_Prompt_Line1",
CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line1),this.oa.$("EaseOfUse_Floodgate_Prompt_Line2",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line2),this.oa.$("EaseOfUse_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Affirmative_Answer),this.oa.$("EaseOfUse_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Negative_Answer),this.oa.$("EaseOfUse_Floodgate_Rating_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Question),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_1",
CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_1),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_2",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_2),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_3",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_3),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_4",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_4),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_5",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_5),this.oa.$("EaseOfUse_Floodgate_Comment_Question",
CommonUIStrings.l_EaseOfUse_Floodgate_Comment_Question),this.oa.$("PerformanceExperience_PromptLine_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("PerformanceExperience_PromptLine_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("PerformanceExperience_RatingQuestion",lc.L0b(0)),this.oa.$("PerformanceExperience_RatingQuestion_OpenFile",lc.L0b(1)),this.oa.$("PerformanceExperience_RatingQuestion_Responsivness",lc.L0b(2)),this.oa.$("PerformanceExperience_RatingQuestion_OpenFile_CurrentSession",
lc.L0b(3)),this.oa.$("PerformanceExperience_RatingQuestion_Responsivness_CurrentSession",lc.L0b(4)),this.oa.$("PerformanceExperience_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.oa.$("PerformanceExperience_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.oa.$("PerformanceExperience_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.oa.$("PerformanceExperience_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.oa.$("PerformanceExperience_RatingValue_5",
CommonUIStrings.l_Excel_Rating_5_Satisfied),this.oa.$("PerformanceExperience_CommentQuestion",CommonUIStrings.l_Excel_PerformanceExperience_CommentQuestion),this.oa.$("CleanData_PromptTitle",CommonUIStrings.l_Excel_CleanData_Survey_PromptTitle),this.oa.$("CleanData_PromptQuestion",CommonUIStrings.l_Excel_CleanData_Survey_PromptQuestion),this.oa.$("CleanData_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("CleanData_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.oa.$("CleanData_RatingQuestion",CommonUIStrings.l_Excel_CleanData_Survey_RatingQuestion),this.oa.$("CleanData_RatingValue_1",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_1),this.oa.$("CleanData_RatingValue_2",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_2),this.oa.$("CleanData_RatingValue_3",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_3),this.oa.$("CleanData_RatingValue_4",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_4),this.oa.$("CleanData_RatingValue_5",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_5),
this.oa.$("CleanData_CommentQuestion",CommonUIStrings.l_Excel_CleanData_Survey_CommentQuestion),this.oa.$("DarkModeSurvey_Title",CommonUIStrings.l_WAC_DarkModeSurvey_Title),this.oa.$("DarkModeSurvey_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("DarkModeSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("DarkModeSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("DarkModeSurvey_RatingQuestion",CommonUIStrings.l_WAC_DarkModeSurvey_RatingQuestion),
this.oa.$("DarkModeSurvey_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("DarkModeSurvey_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.oa.$("DarkModeSurvey_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.oa.$("DarkModeSurvey_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.oa.$("DarkModeSurvey_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),
this.oa.$("DarkModeSurvey_WhyQuestion",CommonUIStrings.l_WAC_GenericSurvey_WhyThatRatingQuestion),this.oa.$("Fluent2Survey_Title",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_1),this.oa.$("Fluent2Survey_Question",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_2),this.oa.$("Fluent2Survey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("Fluent2Survey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("Fluent2Survey_RatingQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question),
this.oa.$("Fluent2Survey_RatingValue_1",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_1),this.oa.$("Fluent2Survey_RatingValue_2",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_2),this.oa.$("Fluent2Survey_RatingValue_3",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_3),this.oa.$("Fluent2Survey_RatingValue_4",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_4),this.oa.$("Fluent2Survey_RatingValue_5",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_5),
this.oa.$("Fluent2Survey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),this.oa.$("Fluent2OptOutSurvey_Title",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_1),this.oa.$("Fluent2OptOutSurvey_Question",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_2),this.oa.$("Fluent2OptOutSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("Fluent2OptOutSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("Fluent2OptOutSurvey_RatingQuestion",
CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question),this.oa.$("Fluent2OptOutSurvey_RatingValue_1",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_1),this.oa.$("Fluent2OptOutSurvey_RatingValue_2",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_2),this.oa.$("Fluent2OptOutSurvey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion)}catch(jb){h.ULS.sendTraceTag(594052319,356,15,"SIFB.InitializeUIStringGetter error "+
(jb?jb.toString():""))}}static yCi(jb){try{return new Promise(Xb=>{window.setTimeout(()=>{Xb(null)},jb)})}catch(Xb){return h.ULS.sendTraceTag(578348238,356,50,"SIFB Info: Floodgate init delay not possible in DelayCustomMs"),Promise.resolve(null)}}static q9f(){return!r.AFrameworkApplication.fa.ka("FloodgateGovernanceServiceIsDisabled")}static l8i(){return r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePrioritySurveyEnabled",!1)}static KNd(jb){const Xb=jb?jb[0]:
null;h.ULS.sendTraceTag(512505556,356,50,"SIFB Info:ConvertAndShowTeachingUx - "+(Xb?Xb.surfaceId:""));if(Xb&&"customsurface"===(Xb&&Xb.surfaceType?Xb.surfaceType.toLocaleLowerCase():null)){const yb=Ka.a.ynj(Xb);if(yb)return h.ULS.sendTraceTag(555071522,356,50,"SIFB Info:Floodgate activation result - "+yb+", "+Xb.surfaceId),null}return fb.KNd(jb)}static R1i(){const jb={};jb.retry=r.AFrameworkApplication.fa.Gc("FloodgateGovernanceServiceRetryCount",0);jb.timeout=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceTimeoutInMs",
1E4);jb.simpleRequestEnabled=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceSimpleRequestEnabled",!1);jb.forceServicelessSurveyDisplay=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceForceServicelessSurveyDisplayEnabled",!1);return jb}static lui(jb){if(!("Unknown"!==jb&&"Automation"!==jb&&r.AFrameworkApplication.fa.ka("FloodgateAuthCallbackIsEnabled")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLocalMessagingEnabled",
!1)))return h.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+jb),null;jb={};jb.getUserPuid=lc.Lej;return jb}static jui(){const jb={},Xb=!r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsDisabled",!1)&&(r.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsEnabled",!1));jb.isEnabled=Xb;return jb}static Lej(){return r.AFrameworkApplication.fa.Ia("Puid")}static Yeg(){return Ka.a.wsa()?
CommonUIStrings.l_WAC_NPS_RatingQuestion_WordForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Word}static Xeg(){return Ka.a.wsa()?CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPointForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPoint}static Weg(){return Ka.a.wsa()&&r.AFrameworkApplication.fa.ka("ExcelNpsForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_ExcelForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Excel}static L0b(jb){if(Ka.a.wsa())switch(jb){case 1:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile;
case 2:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion}switch(jb){case 1:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness;
case 3:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion}}static Gfj(){return Ka.a.wsa()&&r.AFrameworkApplication.fa.ka("NpsOneNoteForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNoteForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNote}static Ifj(){return Ka.a.wsa()?
CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionForTeams:CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestion}static Hfj(){return Ka.a.wsa()?CommonUIStrings.l_OnenotePerf_FloodgatePromptTitleForTeams:CommonUIStrings.l_OnenotePerf_FloodgatePromptTitle}static Jfj(){switch(r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:return CommonUIStrings.l_WordDesigner_FormatWithDesignerFeedbackRatingQuestion;case 2:return CommonUIStrings.l_WordDesigner_MatchDocumentFormattingFeedbackRatingQuestion;
case 3:return CommonUIStrings.l_WordDesigner_UseSmartPasteFeedbackRatingQuestion;default:return""}}}lc.Ybb="SystemInitiatedFeedbackIsEnabled";lc.Wgi="obf-CampaignDefinitions";lc.LTf=100;lc.dCi=8002;Object(J.a)(lc,"SystemInitiatedFeedback",null,[640]);class Mc{constructor(jb){if(!jb)throw Error.argumentNull("SystemInitiatedFeedback is null");this.tuf=jb;this.Pnd={};this.toc={};this.Mnd={}}logActivity(jb,Xb,yb){const mb=new Date;if(!jb||!this.tuf.o5a(jb,lc.Ybb,Xb))return!1;let Ub=null;jb in this.Pnd&&
(Ub=this.Pnd[jb]);const ec=this.qVi(jb),nc=this.pVi(jb);if(this.lJi(Ub,mb,yb))return h.ULS.sendTraceTag(39924675,356,50,"SIFB with time lapse: skipped {0} {1} log(s)",ec,jb),this.tuf.logActivity(jb,Xb),this.Pnd[jb]=mb,this.toc[jb]=0,this.Mnd[jb]=nc+1,!0;this.toc[jb]=ec+1;return!1}lJi(jb,Xb,yb){return jb?Xb.getTime()-jb.getTime()>=1E3*yb:!0}qVi(jb){let Xb=0;jb in this.toc&&(Xb=this.toc[jb]);return Xb}pVi(jb){let Xb=0;jb in this.Mnd&&(Xb=this.Mnd[jb]);return Xb}}Object(J.a)(Mc,"SystemInitiatedFeedbackWithTimeLapse",
null,[639]);var Jc=d(94),rb=d(69);d.d(V,"CustomerFeedbackPackage",function(){return cc});class cc{constructor(){this.EYe=this.Ea=null}get name(){return"Common.App.CustomerFeedback"}Yb(jb){r.AFrameworkApplication.Qg||(h.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),r.AFrameworkApplication.Qg=new A.a);jb.register(W,"Common.App.CustomerFeedback.CustomerFeedbackResourceDownloadManager").as("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager").ma();jb.register(ra,
"Common.App.CustomerFeedback.CustomerFeedbackUiWrapper").as("Common.App.ICustomerFeedbackUiWrapper").ma().na(()=>new ra(Jc.FocusManager.instance(),r.AFrameworkApplication.Qg));jb.register(I,"Common.App.CustomerFeedback.CustomerFeedbackC3FormManager").as("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").ma().na(()=>new I(jb.resolve("Common.App.ICustomerFeedbackUiWrapper"),jb.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),r.AFrameworkApplication.Qg));jb.register(608,
"Common.ICustomerFeedbackActor").ma().na(()=>new E(r.AFrameworkApplication.Va,r.AFrameworkApplication.Ba,jb.Oa("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),r.AFrameworkApplication.fa,r.AFrameworkApplication.Qg));jb.register(lc,"Common.App.CustomerFeedback.SystemInitiatedFeedback").as("Common.ISystemInitiatedFeedback").ma().na(()=>new lc(jb.resolve("Common.App.ICustomerFeedbackUiWrapper")));jb.register(Mc,"Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse").as("Common.ISystemInitiatedFeedbackWithTimeLapse").ma().na(()=>
new Mc(jb.resolve("Common.ISystemInitiatedFeedback")));this.Ea=jb}init(){cc._initialized||(cc.X4b()||(this.EYe=this.Ea.resolve("Common.ICustomerFeedbackActor"),this.EYe.wb(),r.AFrameworkApplication.Ba.updateCommandUI()),this.Ea.Oa("Common.App.IAppSpecificFeedbackData").execute(()=>{this.Ea.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedback");this.Ea.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse")}),cc._initialized=!0)}dispose(){}static X4b(){return!!r.AFrameworkApplication.Ba&&
!!r.AFrameworkApplication.Ba.jb&&3===r.AFrameworkApplication.Ba.jb.vm&&1===r.AFrameworkApplication.Ba.jb.vGa}static main(){let jb=!1;cc.X4b()&&(jb=!0);rb.a.instance.Ec(new cc,0,jb)}}cc._initialized=!1;Object(J.a)(cc,"CustomerFeedbackPackage",null,[2,3])},1104:function(J,V,d){J=d(0);var h=d(13),e=d(33);class m{constructor(){this.classId=0}static q4a(y){try{return e.a(y)}catch(u){}return null}}Object(J.a)(m,"ARoamingAppsResponse",null,[]);class r{constructor(){this.state=this.callback=null;this.v8d=
!1}}Object(J.a)(r,"GetRoamingAppsLauncherContext",null,[]);var v=d(25),A=d(79);d.d(V,"a",function(){return x});class x{constructor(y){this.zpd=!1;this.a6=x.z7a;this.GAd=this.Zxd=0;this.platform=null;this.ASh=y;this.eyf=this.HAd=!1}get kFe(){return this.ASh}get rvl(){return this.kFe&&this.HAd?this.eyf:!1}kki(){v.AFrameworkApplication.P3b&&this.kFe&&!this.HAd&&!this.zpd&&(this.GAd=3,this.zpd=!0,this.kRk(),this.A_f())}kRk(){this.a6=x.z7a;this.Zxd=0}getRoamingAppsLauncher(y,u,H){this.rvl?(y=new r,y.callback=
u,y.state=H,y.v8d=!0,this.F_f(y)):u(!1,"",H)}A_f(){const y=new (d(1082).CheckRoamingRightsRequest);y.RoamingApp=this.GAd;y.BaseDocQuerySignature=v.AFrameworkApplication.$g;y.execute(Object(h.a)(this,this.mki,"checkUserRoamingRightsSucceeded"),Object(h.a)(this,this.lki,"checkUserRoamingRightsFailed"),null)}mki(y){v.AFrameworkApplication.Xg||((y=m.q4a(y.data.je))?this.XIe(y.HasRights):this.XIe(!1))}lki(){if(!v.AFrameworkApplication.Xg)if(this.Zxd>=x.k$j)this.XIe(!1);else{var y=new A.a(2,1,this.a6,Object(h.a)(this,
this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);v.AFrameworkApplication.ve.Hb(y);this.Zxd++;this.a6*=x.$Ee;this.a6>x.sbc&&(this.a6=x.sbc)}}XIe(y){this.eyf=y;this.HAd=!0;this.zpd=!1}retryCheckUserRoamingRights(){this.A_f()}F_f(y){const u=new (d(1083).GetRoamingLauncherRequest);u.RoamingApp=this.GAd;u.BaseDocQuerySignature=v.AFrameworkApplication.$g;u.execute(Object(h.a)(this,this.B9i,"getRoamingAppsLauncherSucceeded"),Object(h.a)(this,this.A9i,"getRoamingAppsLauncherFailed"),y)}B9i(y){if(!v.AFrameworkApplication.Xg){var u=
m.q4a(y.data.je);y=y.data.state;u?(this.platform=u.Platform,y.callback(!0,u.Launcher,y.state)):y.callback(!1,"",y.state)}}A9i(y){if(!v.AFrameworkApplication.Xg){var u=y.data.state;5===y.data.status&&u.v8d?(u.v8d=!1,this.F_f(u)):u.callback(!1,"",u.state)}}static get instance(){return x.Zs||(x.Zs=new x(v.AFrameworkApplication.Q8h))}}x.z7a=1E3;x.$Ee=5;x.sbc=12E5;x.k$j=5;x.Zs=null;Object(J.a)(x,"RoamingAppsManager",null,[])},1105:function(J,V,d){J=d(0);var h=d(13),e=d(931),m=d(66);class r extends e.a{constructor(G,
E,I,Q,D,Y=null){super(G,I,D.RQ,Y);this.zdf=0;this.t$=this.q5i(Q);this.amb=E;this.Mh=D;this.rPe=7;this.Er=this.amb.ownerDocument.createElement("div");this.Er.className="ModalCalloutControlOverlay";this.Er.tabIndex=0;this.amb.insertBefore(this.Er,this.amb.firstChild)}show(){this.yK||(this.Mh.wdb(),this.Mh.dNa(!1),this.Er.style.zIndex=String(this.Mh.hpa),super.show(),this.Ox(),this.zdf=window.setTimeout(Object(h.a)(this,this.dismiss,"dismiss"),1E3*this.rPe))}dismiss(){this.yK&&(this.Mh.LOa(!1),this.ina(),
this.amb&&this.amb.contains(this.Er)&&this.amb.removeChild(this.Er),super.dismiss(),window.clearTimeout(this.zdf))}Ox(){this.Mh.Aga(Object(h.a)(this,this.dismiss,"dismiss"));this.Mh.Ux.pb(m.a.click,this.Er,Object(h.a)(this,this.onClick,"onClick"))}ina(){this.Mh.IWa(Object(h.a)(this,this.dismiss,"dismiss"));this.Mh.Ux.zb(m.a.click,this.Er,Object(h.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}q5i(G){let E=0;switch(G){case 0:E=190;break;case 1:E=250;break;case 2:E=300;break;case 3:E=
360}return E}}Object(J.a)(r,"ModalCallout",e.a,[]);var v=d(374),A=d(390),x=d(150);class y extends r{constructor(G,E,I,Q,D,Y=null){super(G,E,I,Q,D,Y);this.juc=null}show(){if(!this.yK){const G=Object.assign(new A.a,{onShow:()=>{r.prototype.show.call(this)}});x.UISurfaces.pV().then(E=>{const I=E.externalNotification();this.juc=E.addNotification(I,G);return null},E=>{v.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",E);return null})}}dismiss(){this.yK&&this.juc&&(x.UISurfaces.pV().then(G=>
{G.removeNotification(this.juc);return this.juc=null},G=>{v.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null}),super.dismiss())}}Object(J.a)(y,"ReactManagedModalCallout",r,[]);var u=d(25);d.d(V,"a",function(){return H});class H{static LOd(G,E,I,Q,D=null){return u.AFrameworkApplication.Ba.jb.JRa?new y(G,E,I,Q,u.AFrameworkApplication.Ba,D):new r(G,E,I,Q,u.AFrameworkApplication.Ba,D)}}Object(J.a)(H,"ModalCalloutControlFactory",null,[])},1106:function(J,V,d){d.r(V);
J=d(0);var h=d(509),e=d(510);class m{constructor(x){this.PO=this.mXe=h.a.unused;this.Owc=x}get Fob(){return this.mXe}Mte(x,y,u,H){u===this.Owc.element&&(this.mXe=x,this.PO=H+this.Owc.offset)}Cve(){}TJd(x){return this.Fob!==h.a.unused?Object.assign(new e.a,{element:x,offset:this.PO}):null}}Object(J.a)(m,"ChildSelectionHelper",null,[1427]);class r{constructor(x,y){this.txd=!1;this.Owc=y;this._parent=x;this.PO=y.offset}get Fob(){return h.a.unused}Mte(x,y,u,H){y||this.Owc.offset!==x||(this.PO=H,this.txd=
!0)}Cve(x,y){!this.txd&&this.PO>y&&(this.PO-=y-x+1)}TJd(x){return Object.assign(new e.a,{element:this.txd?x:this._parent,offset:this.PO})}}Object(J.a)(r,"ParentSelectionHelper",null,[1427]);var v=d(885);d.d(V,"CombineHelper",function(){return A});class A{constructor(x,y,u){this.J0e=h.a.unused;this.PKb="";this._element=x;this.SQb=y;this.uQb=this.a7f(x,u.start);this.rQb=this.a7f(x,u.end)}a7f(x,y){return y.element===x?new r(x,y):new m(y)}s0h(x){const y=x===this.SQb,u=this._element.childNodes[x],H=this.PKb.length;
this.uQb.Mte(x,y,u,H);this.rQb.Mte(x,y,u,H);this.PKb+=u.nodeValue}end(x,y){this.SQb!==y&&(this.J0e=y,Array.add(x,this))}xni(){var x=this.f8i();this.Cah(this.SQb,x-1);this.Cah(x+1,this.J0e);x=this._element.childNodes[this.SQb];this.PKb!==x.nodeValue&&(x.nodeValue=this.PKb);return this.Ndi(x)}Cah(x,y){if(!(y<x)){this.uQb.Cve(x,y);this.rQb.Cve(x,y);for(let u=x;u<=y;u++)this._element.removeChild(this._element.childNodes[x])}}Ndi(x){return Object.assign(new v.a,{start:this.uQb.TJd(x),end:this.rQb.TJd(x)})}f8i(){return this.uQb.Fob!==
h.a.unused?this.uQb.Fob:this.rQb.Fob!==h.a.unused?this.rQb.Fob:this.SQb}}Object(J.a)(A,"CombineHelper",null,[])},1111:function(J,V,d){J=d(0);var h=d(1153),e=d(374),m=d(25),r=d(79),v=d(67);class A{static Lfj(){if(!A.Boc&&(A.Boc=new v.a,m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.Fu("AggregatorIdDisabledList"))){const u=m.AFrameworkApplication.fa.JB("AggregatorIdDisabledList");for(let H=0;H<u.length;H++)A.Boc.$(u[H],!0)}return A.Boc}}A.Boc=null;Object(J.a)(A,"DisabledAggregatorListStore",
null,[]);var x=d(283);d.d(V,"a",function(){return y});class y{constructor(u,H,G,E,I,Q=!0,D=null){this.w_e=this.zvf=this.laf=!1;this.Md=null;if(!u)throw x.a.argument("taskManagerLazy");if(!I)throw x.a.argument("dataAggregator");this.aVh=u;this.myd=H;this._id=G;this.x5e=6E4*E;this.iqc=I;this.wrf=Q;this.hQb=D;A.Lfj().Kb(this._id.toString())&&(this.w_e=!0)}get taskManager(){return this.Md||(this.Md=this.aVh.value)}track(u,H=null){this.w_e||(this.DKi(),this.BVk(),this.iqc.JSb(u,H))}BVk(){!this.laf&&0<
this.x5e&&(this.laf=!0,this.Xgh())}Xgh(){const u=new r.a(5,1,this.x5e,()=>{this.hXk()},19,this._id.toString());this.taskManager.Hb(u)}hXk(){!this.hQb||this.hQb.UJe()?this.Oed():this.wrf&&this.iqc.reset();this.Xgh()}Oed(){const u=this.iqc.getData();if(u){const H=parseInt(String(u.length));if(isNaN(H)||0<H)this.kih(u),this.wrf&&this.iqc.reset()}}kih(u){e.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:u})}DKi(){this.zvf||(this.myd(()=>{this.Oed()}),this.zvf=!0)}static Xq(u,
H,G,E,I){return new y(new h.a(()=>m.AFrameworkApplication.ve),m.AFrameworkApplication.Aea,u,H,G,E,I)}static kV(u,H,G,E=!0){return y.Xq(u,H,G,E,null)}}Object(J.a)(y,"Aggregator",null,[1296])},113:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(1182);class e{constructor(){this.AZb=this.GIf=this.T6=this.xea=this.vBc=this.$Jc=this.krb=this.xBa=this.J1=this.ADc=this.Xjd=null}Yf(m){this.Xjd=new h.a;this.Xjd.value=m}ofd(){this.ADc=new h.a;this.ADc.value=!0}F4(m){this.$Jc=new h.a;this.$Jc.value=
m}}Object(J.a)(e,"QueryResult",null,[])},1181:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]="safari";e[e.others=5]="others";e[e.unknown=6]="unknown";e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=9]="teamsElectron"})(h||(h={}));Object(J.b)("BrowserCode",h)},1182:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.value=
!1}}Object(J.a)(h,"OutBool",null,[])},1183:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(J.a)(h,"ColorCellProps",null,[])},1184:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(341);class h extends d.a{constructor(){super();this.Style=this.Character=null}get Type(){return 1}}Object(J.a)(h,"CharacterCodeGalleryButtonProps",d.a,[])},1185:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(505);class e{constructor(m){this.Laa=
m}ajc(m){return h.a.then(this.Laa.umb(m,1,"",{"Content-Type":"application/json; charset=utf-8"},0,void 0,void 0,void 0,void 0,void 0,"2"),r=>this.s9i(r))}s9i(m){return m&&m.Qi&&m.Qi.data?m.Qi.data.je:null}}Object(J.a)(e,"SimpleRequestManager",null,[1483])},1186:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(341);class h extends d.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(J.a)(h,"IconGalleryButtonProps",
d.a,[])},1187:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(298);class h{}h.LabelText=d.a.labelText;h.Alt=d.a.alt;h.Image16by16Class=d.a.ntb;h.Image32by32Class=d.a.wCa;h.Image48by48Class=d.a.B4d;h.Visible=d.a.visible;h.HasPopup="HasPopup";Object(J.a)(h,"ButtonCommandProperties",null,[])},1189:function(J,V,d){function h(a,b){if(!a||!b)return[];const c=new Set;a.forEach(f=>{var l;return null===(l=null===f||void 0===f?void 0:f.ote)||void 0===l?void 0:l.forEach(w=>{w&&c.add(w)})});return Array.from(c).map(f=>
b.te(Fa.a.ig(f))).filter(f=>null!==f&&void 0!==f)}d.r(V);var e=d(0),m=d(69),r=d(55),v=d(94),A=d(187),x=d(178),y=d(120),u=d(25),H=d(1054),G=d(35),E=d(154),I=d(34);class Q{constructor(a){this.value=a}}Object(e.a)(Q,"RefTriState",null,[]);var D=d(32);class Y{zCe(){this.UKi();this.brj();this.MOj();this.qWj();I.a.instance.ga(70)&&this.wzk();this.WWk();I.a.instance.ga(71)&&this.sHb();this.wgl();this.yhl();this.jBi();this.wOj();this.$Sk();this.Scl();this.Eil();I.a.instance.ga(79)&&(r.a.ak||this.itj(),this.aRj(),
this.adk(),this.dpl())}UKi(){const a=v.FocusManager.instance().Bc(E.AppFrame.hV);a.bindAction(A.KeyInputManager.La(x.a.Xp,0),D.a.enter);a.bindAction(A.KeyInputManager.La(x.a.Xp,4),D.a.Ggd)}brj(){const a=v.FocusManager.instance().Bc(E.AppFrame.hV);y.AFrame.Uj(a,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_Hyperlink),D.a.insertHyperlink)}itj(){const a=v.FocusManager.instance().Bc(y.AFrame.kj);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.Sea,5),D.a.BE);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.q$,5),D.a.Qy)}wOj(){if(!r.a.Fw){const a=
v.FocusManager.instance().Bc(y.AFrame.kj);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.hoc,A.KeyInputManager.He),D.a.Ixg,Y.zeb("faOpen"))}}MOj(){const a=v.FocusManager.instance().Bc(E.AppFrame.hV);I.a.instance.ga(54)&&y.AFrame.Uj(a,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_CenterJustify),D.a.centerJustify,Y.SI);r.a.ak?(y.AFrame.Uj(a,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_LeftJustify_Mac),D.a.leftJustify,Y.SI),y.AFrame.Uj(a,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_RightJustify_Mac),D.a.rightJustify,
Y.SI)):(y.AFrame.Uj(a,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_LeftJustify),D.a.leftJustify,Y.SI),y.AFrame.Uj(a,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_RightJustify),D.a.rightJustify,Y.SI));I.a.instance.ga(54)&&y.AFrame.Uj(a,A.KeyInputManager.La(x.a.hnd,A.KeyInputManager.He),D.a.fullJustify,Y.SI)}aRj(){var a=v.FocusManager.instance();const b=a.Bc(y.AFrame.kj);a=a.Bc(E.AppFrame.hV);y.AFrame.Uj(b,A.KeyInputManager.La(x.a.Ahb,A.KeyInputManager.He),D.a.TQ,Y.NVf);y.AFrame.Uj(b,A.KeyInputManager.La(x.a.rTe,
A.KeyInputManager.He),D.a.UQ,Y.NVf);r.a.vvb&&a.bindAction(A.KeyInputManager.La(x.a.goc,4|A.KeyInputManager.He),D.a.TQ)}qWj(){const a=v.FocusManager.instance().Bc(y.AFrame.kj);y.AFrame.Uj(a,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_TellMe),G.a.qjd,Y.SI)}adk(){if(I.a.instance.ga(27)||I.a.instance.ga(58)){const a=v.FocusManager.instance().Bc(y.AFrame.kj),b=I.a.instance.ga(58)?D.a.kVk:D.a.save;y.AFrame.Uj(a,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_Save),b);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.CUe,
0),D.a.sync)}}wzk(){const a=v.FocusManager.instance().Bc(E.AppFrame.hV);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||y.AFrame.Uj(a,A.KeyInputManager.La(x.a.eoc,1),D.a.H5c);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.eoc,0),D.a.H5c)}WWk(){this.Rhh(E.AppFrame.hV);this.Rhh(E.AppFrame.SBe)}Rhh(a){var b=v.FocusManager.instance(),c=x.a.q$,f=x.a.Sea;a=b.Bc(a);const l=b.Bc(u.AFrameworkApplication.rdb);a.bindAction(A.KeyInputManager.La(c,
0),D.a.leftArrow);a.bindAction(A.KeyInputManager.La(f,0),D.a.rightArrow);a.bindAction(A.KeyInputManager.La(x.a.OX,0),D.a.upArrow);a.bindAction(A.KeyInputManager.La(x.a.k5,0),D.a.downArrow);a.bindAction(A.KeyInputManager.La(f,4),D.a.QXa);a.bindAction(A.KeyInputManager.La(c,4),D.a.PXa);r.a.ak?(a.bindAction(A.KeyInputManager.La(f,1),D.a.yAa),a.bindAction(A.KeyInputManager.La(c,1),D.a.xAa),a.bindAction(A.KeyInputManager.La(f,5),D.a.YNa),a.bindAction(A.KeyInputManager.La(c,5),D.a.XNa),a.bindAction(A.KeyInputManager.La(f,
8),D.a.rVa),a.bindAction(A.KeyInputManager.La(c,8),D.a.sVa),a.bindAction(A.KeyInputManager.La(f,12),D.a.UOa),a.bindAction(A.KeyInputManager.La(c,12),D.a.VOa)):(a.bindAction(A.KeyInputManager.La(f,A.KeyInputManager.He),D.a.yAa),a.bindAction(A.KeyInputManager.La(c,A.KeyInputManager.He),D.a.xAa),a.bindAction(A.KeyInputManager.La(f,A.KeyInputManager.He|4),D.a.YNa),a.bindAction(A.KeyInputManager.La(c,A.KeyInputManager.He|4),D.a.XNa));a.bindAction(A.KeyInputManager.La(x.a.OX,4),D.a.uGb);a.bindAction(A.KeyInputManager.La(x.a.k5,
4),D.a.Kfb);a.bindAction(A.KeyInputManager.La(x.a.OX,A.KeyInputManager.He),D.a.zWb);a.bindAction(A.KeyInputManager.La(x.a.k5,A.KeyInputManager.He),D.a.wpb);a.bindAction(A.KeyInputManager.La(x.a.OX,A.KeyInputManager.He|4),D.a.c4a);a.bindAction(A.KeyInputManager.La(x.a.k5,A.KeyInputManager.He|4),D.a.WNa);a.bindAction(A.KeyInputManager.La(x.a.dE,0),D.a.sVa);a.bindAction(A.KeyInputManager.La(x.a.dE,4),D.a.VOa);if(I.a.instance.ga(41))a.bindAction(A.KeyInputManager.La(x.a.dE,A.KeyInputManager.He),D.a.h5c),
a.bindAction(A.KeyInputManager.La(x.a.mw,A.KeyInputManager.He),D.a.bse);else if(I.a.instance.ga(17)||I.a.instance.ga(77))a.bindAction(A.KeyInputManager.La(x.a.dE,A.KeyInputManager.He),D.a.icb),a.bindAction(A.KeyInputManager.La(x.a.mw,A.KeyInputManager.He),D.a.hcb);a.bindAction(A.KeyInputManager.La(x.a.dE,A.KeyInputManager.He|4),D.a.V4a);a.bindAction(A.KeyInputManager.La(x.a.mw,0),D.a.rVa);a.bindAction(A.KeyInputManager.La(x.a.mw,4),D.a.UOa);a.bindAction(A.KeyInputManager.La(x.a.mw,A.KeyInputManager.He|
4),D.a.U4a);r.a.ak&&(a.bindAction(A.KeyInputManager.La(x.a.OX,2),D.a.sVa),a.bindAction(A.KeyInputManager.La(x.a.OX,6),D.a.VOa),a.bindAction(A.KeyInputManager.La(x.a.k5,2),D.a.rVa),a.bindAction(A.KeyInputManager.La(x.a.k5,6),D.a.UOa),a.bindAction(A.KeyInputManager.La(x.a.dE,1),D.a.icb),a.bindAction(A.KeyInputManager.La(x.a.mw,1),D.a.hcb),I.a.instance.ga(6)&&(a.bindAction(A.KeyInputManager.La(x.a.OX,5),D.a.c4a),a.bindAction(A.KeyInputManager.La(x.a.k5,5),D.a.WNa)));c=A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_SelectAll);
a.bindAction(c,D.a.Dqa);l.bindAction(c,G.a.IGc);I.a.instance.ga(79)&&(f=b.Bc(y.AFrame.VC),b=b.Bc(y.AFrame.kj),f.bindAction(c,G.a.Tza),b.bindAction(A.KeyInputManager.La(x.a.rZa,A.KeyInputManager.He|4),D.a.yed),I.a.instance.ga(41)&&r.a.ak&&(a.bindAction(A.KeyInputManager.La(x.a.iB,1),D.a.icb),a.bindAction(A.KeyInputManager.La(x.a.hB,1),D.a.hcb)),b.bindAction(A.KeyInputManager.La(x.a.hB,0),D.a.pageDown),b.bindAction(A.KeyInputManager.La(x.a.iB,0),D.a.pageUp),b.bindAction(A.KeyInputManager.La(x.a.hB,
4),D.a.Vjc),b.bindAction(A.KeyInputManager.La(x.a.iB,4),D.a.Igd));I.a.instance.ga(6)&&(a.bindAction(A.KeyInputManager.La(x.a.hB,A.KeyInputManager.He|4),G.a.IGc),a.bindAction(A.KeyInputManager.La(x.a.iB,A.KeyInputManager.He|4),G.a.IGc));r.a.Gj||a.bindAction(A.KeyInputManager.La(x.a.vJa,0),D.a.Y9);a.bindAction(A.KeyInputManager.La(x.a.vna,4),D.a.Hgd);a.bindAction(A.KeyInputManager.La(x.a.vna,4|A.KeyInputManager.He),D.a.Hgd)}sHb(){const a=v.FocusManager.instance().Bc(E.AppFrame.hV);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.dnd,
A.KeyInputManager.He|1),D.a.WHd);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.fnd,A.KeyInputManager.He|1),D.a.XHd);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.wUe,A.KeyInputManager.He|1),D.a.YHd);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.xUe,A.KeyInputManager.He|1),D.a.ZHd);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.yUe,A.KeyInputManager.He|1),D.a.$Hd);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.zUe,A.KeyInputManager.He|1),D.a.aId);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.Bxa,A.KeyInputManager.He|4),D.a.VHd);I.a.instance.ga(61)&&
v.FocusManager.instance().Bc(y.AFrame.kj).bindAction(A.KeyInputManager.La(x.a.knd,A.KeyInputManager.He|4),D.a.m8h)}wgl(){const a=v.FocusManager.instance().Bc(E.AppFrame.hV);a.bindAction(A.KeyInputManager.La(x.a.tq,0),D.a.tab);a.bindAction(A.KeyInputManager.La(x.a.tq,4),D.a.Wjc)}yhl(){if(I.a.instance.ga(30)){const a=v.FocusManager.instance().Bc(E.AppFrame.hV);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.Xp,A.KeyInputManager.He),D.a.LCa)}}Eil(){const a=v.FocusManager.instance(),b=a.Bc(E.AppFrame.hV);a.Bc(y.AFrame.VC);
y.AFrame.Uj(b,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_Bold),D.a.bold,Y.SI);y.AFrame.Uj(b,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_Italic),D.a.setItalic,Y.SI);y.AFrame.Uj(b,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_Underline),D.a.underline,Y.SI);r.a.ak&&(y.AFrame.Uj(b,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_Bold_Mac),D.a.bold,Y.SI),y.AFrame.Uj(b,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_Italic_Mac),D.a.setItalic,Y.SI),y.AFrame.Uj(b,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_Underline_Mac),
D.a.underline,Y.SI));y.AFrame.Uj(b,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_ClearFormatting),D.a.clearFormatting);I.a.instance.ga(54)&&y.AFrame.Uj(b,A.KeyInputManager.La(x.a.PJb,A.KeyInputManager.He|4),D.a.clearFormatting);y.AFrame.Uj(b,A.KeyInputManager.La(x.a.Rhb,A.KeyInputManager.He|1),D.a.T9,Y.zeb("00FFFF"));if(I.a.instance.ga(94)||I.a.instance.ga(96))y.AFrame.Uj(b,A.KeyInputManager.La(x.a.Ahb,A.KeyInputManager.He|4),D.a.XH,Y.SI),y.AFrame.Uj(b,A.KeyInputManager.La(x.a.Cnc,A.KeyInputManager.He),
D.a.XH,Y.SI),y.AFrame.Uj(b,A.KeyInputManager.La(x.a.kmd,A.KeyInputManager.He|4),D.a.gJ,Y.SI),y.AFrame.Uj(b,A.KeyInputManager.La(x.a.Anc,A.KeyInputManager.He),D.a.gJ,Y.SI);u.AFrameworkApplication.fa.ka("PPTOToggleCaseByShiftF3Enabled")&&y.AFrame.Uj(b,A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_ToggleCase),D.a.Yjd);u.AFrameworkApplication.fa.ka("SubSuperscriptShortcutEnabled")&&(y.AFrame.Uj(b,A.KeyInputManager.La(x.a.lmd,A.KeyInputManager.He|4),D.a.superscript,Y.SI),y.AFrame.Uj(b,A.KeyInputManager.La(x.a.omd,
A.KeyInputManager.He|4),D.a.superscript,Y.SI),y.AFrame.Uj(b,A.KeyInputManager.La(x.a.mmd,A.KeyInputManager.He|4),D.a.subscript,Y.SI),y.AFrame.Uj(b,A.KeyInputManager.La(x.a.Bnc,A.KeyInputManager.He|4),D.a.subscript,Y.SI))}dpl(){const a=v.FocusManager.instance().Bc(y.AFrame.VC),b=v.FocusManager.instance().Bc(E.AppFrame.hV);var c=A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_Undo);a.bindAction(c,G.a.Tza);b.bindAction(c,D.a.undo);c=A.KeyInputManager.La(x.a.fH,1);a.bindAction(c,G.a.Tza);r.a.ak||b.bindAction(c,
D.a.undo);c=A.KeyInputManager.Jv(Box4Intl.Box4Strings.l_HK_Redo);a.bindAction(c,G.a.Tza);b.bindAction(c,D.a.redo);c=A.KeyInputManager.La(x.a.fH,5);a.bindAction(c,G.a.Tza);r.a.ak||b.bindAction(c,D.a.redo)}Scl(){const a=v.FocusManager.instance().Bc(E.AppFrame.hV);I.a.instance.ga(54)?(r.a.ak?this.Gpa(a,A.KeyInputManager.La(x.a.fnd,5),"\u20ac"):this.Gpa(a,A.KeyInputManager.La(x.a.Qhb,A.KeyInputManager.He|1),"\u20ac"),this.Gpa(a,A.KeyInputManager.La(x.a.EJa,A.KeyInputManager.He|1),"\u00a9"),this.Gpa(a,
A.KeyInputManager.La(x.a.MJb,A.KeyInputManager.He|1),"\u00ae"),this.Gpa(a,A.KeyInputManager.La(x.a.NJb,A.KeyInputManager.He|1),"\u2122"),this.Gpa(a,A.KeyInputManager.La(x.a.Bnc,A.KeyInputManager.He|1),"\u2014"),this.Gpa(a,A.KeyInputManager.La(x.a.Ahb,A.KeyInputManager.He|1),"\u2026"),this.Gpa(a,A.KeyInputManager.La(x.a.rTe,A.KeyInputManager.He|5),"\u00bf"),this.Gpa(a,A.KeyInputManager.La(x.a.dnd,A.KeyInputManager.He|5),"\u00a1")):I.a.instance.ga(25)&&this.Gpa(a,A.KeyInputManager.La(x.a.Qhb,A.KeyInputManager.He|
1),"\u20ac")}Gpa(a,b,c){y.AFrame.Uj(a,b,D.a.$Qa,Y.Qxj("symbol_"+c))}jBi(){if(u.AFrameworkApplication.WD){var a=v.FocusManager.instance().Bc(y.AFrame.kj);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.AUe,A.KeyInputManager.He|1),G.a.giveFeedback);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.BUe,A.KeyInputManager.He|1),G.a.giveFeedback)}}$Sk(){const a=v.FocusManager.instance().Bc(y.AFrame.kj);r.a.Fw||y.AFrame.Uj(a,A.KeyInputManager.La(x.a.Rhb,1),D.a.activateRibbonTab,Y.zeb("tabHome"));y.AFrame.Uj(a,A.KeyInputManager.La(x.a.Bxa,
1),D.a.activateRibbonTab,Y.zeb("tabInsert"));y.AFrame.Uj(a,A.KeyInputManager.La(x.a.Shb,1),D.a.activateRibbonTab,Y.zeb("tabPageLayout"));y.AFrame.Uj(a,A.KeyInputManager.La(x.a.MJb,1),D.a.activateRibbonTab,Y.zeb("tabReview"));y.AFrame.Uj(a,A.KeyInputManager.La(x.a.EUe,1),D.a.activateRibbonTab,Y.zeb("tabView"))}static get instance(){return Y.Ka||(Y.Ka=new Y)}static NVf(){return new H.DictionaryPropertySet}static SI(){return new Q(2)}static Qxj(a){return()=>{const b={};b.SourceControlId=a;return b}}static zeb(a){return()=>
a}}Y.Ka=null;Object(e.a)(Y,"ShortcutRegistration",null,[]);class M{get name(){return"Box4.Shortcuts"}Yb(){}init(){Y.instance.zCe()}dispose(){}static main(){m.a.instance.Ec(new M)}}Object(e.a)(M,"Box4ShortcutsPackage",null,[2,3]);var N=d(300);class W{it(a,b,c=!1,f=!1,l=!1,w=null){return N.a.it(a,b,c,f,l,w)}pnc(a,b,c){return N.a.pnc(a,b,c)}Lnb(a,b){return N.a.Lnb(a,b)}FY(a,b,c,f,l=!1,w=!1){return N.a.FY(a,b,c,f,l,w)}gNa(a,b=null){return N.a.gNa(a,b)}Qba(){N.a.Qba()}X3a(a,b,c,f=null){return N.a.X3a(a,
b,c,f)}eCa(a,b,c=!1,f=!0){return N.a.eCa(a,b,c,f)}o4b(a,b){return N.a.o4b(a,b)}}Object(e.a)(W,"TextMetricsAdapterProxy",null,[1442]);var K=d(307),ca=d(148);class P{ldj(a){var b=a;for(a=null;!a&&b&&"P"!==b.tagName;)a=K.a.te(b,ca.a.UHb),b=b.parentNode;b=-1;a&&(b=parseInt(a.toString(),10));return b}}Object(e.a)(P,"TextMetricsHelper",null,[509]);class ea{constructor(){this.Ea=null}get name(){return"Box4.TextMetrics"}init(){this.Ea.resolve("Box4.ITextMetricsAdapter")}dispose(){}Yb(a){this.Ea=a;this.Ea.register(1442,
"Box4.ITextMetricsAdapter").ma().na(()=>new W);this.Ea.register(509,"Box4.TextMetricsApi.ITextMetricsHelper").ma().na(()=>new P)}static main(){m.a.instance.Ec(new ea)}}Object(e.a)(ea,"Box4TextMetricsPackage",null,[2,3]);var da=d(327),ia=d(248),C=d(13),oa=d(99),Z=d(374),pa=d(701),ya=d(96),Ja=d(45),Ka=d(1173),ma=d(1169),ra=d(66),Da=d(553),va=d(105),Fa=d(336),ka=d(774),qa=d(267),Ua=d(17),Ya=d(6);class Va{static P_k(a){const b=new pa.a;for(let c of a)b.add(c);return b}static Lah(a,b){const c=new Ua.a;
b=Va.P_k(b);for(let f of a)b.contains(f)||c.add(f);return c}static $Kk(a,b){return Va.Lah(Ya.asEnumerable(a),b).toArray()}static aLk(a,b){return Va.Lah(a,b)}}Object(e.a)(Va,"ExtendedGuidUtils",null,[]);var ua=d(1154),Ca=d(22),Ea=d(162);class wb{}wb.Vhi="ChangeInfo";Object(e.a)(wb,"CatchUpActivityConstants",null,[]);class Oa{}Oa.rCb="\u00a0";Oa.zHf="\ue200";Oa.ukg="\ue201";Oa.RHi=32767;Oa.BGc=3;Oa.yRd=1;Object(e.a)(Oa,"ContentEditableViewConstants",null,[]);var ab=d(536),fb=d(123),db=d(31),gc=d(352),
ob=d(36),Sb=d(39),Jb=d(92),Ab=d(93),lc=d(51),Mc=d(87);class Jc{constructor(a,b,c){this.Qa=b;this.Lb=c}}Object(e.a)(Jc,"ChangeInfo",null,[]);d(597);var rb=d(793);class cc{}Object(e.a)(cc,"InternalLinkConstants",null,[]);class jb extends Sys.EventArgs{constructor(){super();this.F4a=null}}Object(e.a)(jb,"EditEventArgs",Sys.EventArgs,[]);class Xb extends jb{constructor(){super();this.kQj=0;this.Nkl=this.qHc=this.ZOe=this.MQj=this.Psj=this.Mpg=this.i4f=this.FOi=this.XKi=!1}}Object(e.a)(Xb,"ParagraphContentUpdatedEventArgs",
jb,[]);class yb{constructor(a){this.KUc=a}}Object(e.a)(yb,"BlobPresenterArgs",null,[]);var mb=d(30);class Ub{}Ub.C2="TrackedChange";Ub.Tth="TrackChangeTableRowInsertion";Ub.Qth="TrackChangeTableRowDeletion";Ub.zuh="TrackChangeTextInsertion";Ub.xuh="TrackChangeTextDeletion";Ub.psj="TrackChangeImageModified";Ub.nsj="TrackChangeImageInsertion";Ub.jsj="TrackChangeImageDeletion";Ub.ybe="TrackChangeIndirectEffect";Object(e.a)(Ub,"TrackChangeConstants",null,[]);var ec=d(884),nc=d(97);const Lb=a=>!!a.aOa&&
Ya.AT(a.aOa,b=>3===b.type||2===b.type||4===b.type),Zc=(a,b)=>{let c=!1,f=!1,l=null;if(b.aOa)for(let w of b.aOa)1===w.type&&(c=!0),3===w.type&&(f=!0),4===w.type&&w.xe&&w.xe.paragraph&&(l=w);l&&Sys.UI.DomElement.addCssClass(a,nc.a.CAi);f&&Sys.UI.DomElement.addCssClass(a,nc.a.njg);c&&Sys.UI.DomElement.addCssClass(a,nc.a.wAi)},Pb=a=>{const b=[nc.a.aHi,nc.a.bHi,nc.a.$Gi];for(const c of b)Sys.UI.DomElement.removeCssClass(a,c)};var eb=d(346);class $a{constructor(a){this.RLb=this.TQb=this.xYe=null;this.Ei=
a}get paragraphNode(){return this.Ei}get aOa(){return this.xYe}get ngb(){return this.TQb}get M4a(){return this.RLb}get isEmpty(){return(!this.aOa||!this.aOa.count)&&(!this.ngb||!this.ngb.count)&&(!this.M4a||!this.M4a.count)}tjk(){this.ngb&&(this.TQb=new Ua.a);this.M4a&&(this.RLb=new Ua.a)}Xld(a){this.aOa||(this.xYe=new eb.a);this.ngb||(this.TQb=new Ua.a);this.M4a||(this.RLb=new Ua.a);this.aOa.Xld(a,b=>{this.ngb.add(b)},b=>{this.M4a.add(b)})}}Object(e.a)($a,"IntentRenderingState",null,[]);class vb{constructor(a,
b){this.element=a;this.next=b}}Object(e.a)(vb,"ElementStackNode",null,[]);class bc{constructor(a=!1){this._history=new Sys.StringBuilder;this.fya=this.Cu=null;this.qRb=a}MTj(a){if(this.qRb&&a){this._history.append("[Cp "+a.cp+":");if(a.Qh)for(var b=0;b<a.Qh.length;b++)this._history.append(a.Qh.ga(b).Lx+","+a.Qh.ga(b).sda),b!==a.Qh.length-1&&this._history.append("|");if(a.Vj)for(a.Qh&&this._history.append("|"),b=0;b<a.Vj.length;b++)this._history.append(a.Vj.ga(b).Xra?"B":"I"),this._history.append(a.Vj.ga(b).ek?
"S":"E"),this._history.append(a.Vj.ga(b).Qub?"R":"F"),b!==a.Vj.length-1&&this._history.append("|");this._history.append("]\n")}}clear(){if(this.Cu){for(var a=this.Cu;a.next;)a=a.next;a.next=this.fya;this.fya=this.Cu;this.Cu=null;this.qRb&&this._history.append("Clear\n")}}peek(a=""){this.isEmpty()&&Z.ULS.sendTraceTag(50604245,324,15,"_top is null when calling Peek with Label: {0}. History: {1}",a,this._history.toString());this.qRb&&this._history.append(String.format("Peek Label: {0}\n",a));return this.Cu.element}pop(a=
""){this.isEmpty()&&Z.ULS.sendTraceTag(50604246,324,15,"_top is null when calling Pop with label {0}. History: {1}",a,this._history.toString());const b=this.Cu.element;this.Cu.element=null;const c=this.Cu.next;this.Cu.next=this.fya;this.fya=this.Cu;this.Cu=c;this.qRb&&this._history.append(String.format("Pop {0} Label:{1}\n",b?b.className:"Null Element",a));return b}push(a,b=""){if(this.fya){const c=this.fya.next;this.fya.next=this.Cu;this.Cu=this.fya;this.fya=c;this.Cu.element=a}else this.Cu=new vb(a,
this.Cu);this.qRb&&this._history.append(String.format("Push {0} Label:{1}\n",a?a.className:"Null Element",b))}isEmpty(){return!this.Cu}}Object(e.a)(bc,"ElementStack",null,[]);class Cc{constructor(){this.f4b=!1;this.span=null}}Object(e.a)(Cc,"IntelligentPlaceholderRenderingState",null,[]);class Gc{constructor(a,b,c){this.eventName=a;this.Hc=b;this.handler=c}}Object(e.a)(Gc,"ParagraphContentRendererMouseEventRegistration",null,[]);var sd=d(78);class Sd extends Sys.EventArgs{constructor(a,b,c){super();
this.element=a;this.paragraphNode=b;this.cEb=c}}Object(e.a)(Sd,"ParagraphContentRendererEventArgs",Sys.EventArgs,[]);class ie extends Sd{constructor(a,b,c,f,l){super(a,b,c);this.TQb=f.ngb;this.RLb=f.M4a;this.vJh=l}get ngb(){return this.TQb}get M4a(){return this.RLb}get elementType(){return this.vJh}}Object(e.a)(ie,"IntentRangeRenderedEventArgs",Sd,[]);class De extends Sd{constructor(a,b,c,f){super(a,b,c);this.yp=f}}Object(e.a)(De,"SpellingErrorRenderedEventArgs",Sd,[]);class yd{constructor(){this.Ta=
new sd.a}dispose(){this.Ta&&(this.Ta.dispose(),this.Ta=null)}YDk(a,b,c,f){this.Ta&&this.Ta.raiseEvent(yd.kmk,new De(a,b,c,f))}C8g(a,b,c,f,l){this.Ta&&this.Ta.raiseEvent(yd.uik,new ie(a,b,c,f,l))}}yd.kmk="OnSpellingErrorRangeRendered";yd.uik="OnIntentRangeRendered";Object(e.a)(yd,"ParagraphRenderEvents",null,[109]);class ib{constructor(){this.$Lf=null;this.Gig=!1;this.wSg=this.pzf=null}}Object(e.a)(ib,"RenderParagraphContentResults",null,[]);var dc=d(161),Bc=d(67);class Ob{constructor(a,b,c,f,l,w,
F,S,fa,xa,Za,pb,Mb,hc,kc,Ec){this.nya=this.Evd=this.Fud=this.$kb=null;this.Jf=a;this.NO=b;this.Yc=c;this.Yna=f;this.oM=l;this.Av=F;this.Eoa=S;this.dLa=fa;this.gIh=Za;this.wU=pb;this.FRh=Mb;this.JKh=hc;this.OGh=Ec;this.Dxf=new pa.a;this.nxc=kc;this.gkb=!!xa&&xa.XCa(65);this.xxc=this.trc=null;this.MKa=w;this.TMh=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("MinimizeIntelligentPlaceholderWorkIsEnabled");this.$c=xa}get IJf(){return!0}get mtg(){null==this.Fud&&(this.Fud=!!this.$c&&this.$c.isFeatureEnabled(85));
return this.Fud}get xxg(){null==this.Evd&&(this.Evd=!!this.$c&&this.$c.isFeatureEnabled(77));return this.Evd}get gN(){null==this.nya&&(this.nya=!!this.$c&&this.$c.isFeatureEnabled(79));return this.nya}$Ok(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td){this.trc={};this.xxc=new dc.a;const we=db.ParagraphReader.text(a),Pd=new Ua.a;var He=!1;u.AFrameworkApplication.fa&&(He=u.AFrameworkApplication.fa.ka("ElementStackTrackHistoryIsEnabled"));const Pe=new bc(He);Pe.push(c,"RenderParagraphContentStart");
let Df=null,ig=null,Tg=null,Ig=null,Ff=He=null;const nh=new Xb;var Jg=!1;let $h=!1,Li=!1,Aj=!1,Zi=0,Ui=null,Bi=null;const Dk=new Ua.a;this.nxc&&this.nxc.mAl(a,c);const kj=this.dLa.qV(a);this.dLa.U7h(c,a,b,kj,b.Ed);if(this.Eoa.Gw&&b.Al){var rk=this.Jf.Jd;rk&&1===rk.editingView.mode&&(c.style.fontFamily="",c.style.fontSize="")}rk=!a.AV;let ml=!1,nl=!1,Bl=!1,bk=!1,Bj=0,ck=!1,al=!1,Cj=null,oh=0;const bl=new Cc,Ol=Array(a.Ra.length+1);let qm=this.mtg?new Ua.a:null,sk=null,Ek=null;for(;Zi<a.Ra.length;){const Vd=
a.Ra.ga(Zi);var ai=void 0,tg=void 0,gi=!1;Pe.MTj(Vd);({HDc:ai,DDc:tg}=Ob.e7f(Vd));this.mtg&&(!this.TMh||ai.length||tg.length)&&({HDc:ai,DDc:tg,TAi:qm,HFj:gi}=Ob.Vql(Vd.paragraph.Eh,ai,tg,qm),bl.f4b=0<qm.count);bk=0<ai.length||bk;Ol[Zi]=c.childNodes.length;if(0<Vd.cp&&Vd.Cj)break;let yg=Vd.cp;const hi=Zi<a.Ra.length-1?a.Ra.ga(Zi+1).cp:db.ParagraphReader.textLength(a);Zi++;var Tf=!1;0<yg&&Pe.pop("CurrentCpLargerThanZero");Vd.GK&&(Df=null);Vd.Hu&&(Ek=Vd.Hu);Vd.isDictationCorrectionEnd&&(Ek=null);Vd.qX&&
(ig=null);Vd.J2&&(Tg=null);Vd.Ria&&(Ig=null);var wd=void 0,oe=void 0;this.gN?(wd=Vd.bca,oe=Vd.qZ):(wd=!!Vd.jo,oe=!!Vd.fieldRangeEnd);if(!Jg||Vd.blob||Vd.formatting||Vd.hyperlink||Vd.Im||Vd.M2||oe||wd||this.gkb&&(Vd.isTrackChangeInfoEnd||Vd.nN)||Vd.Lv&&!Vd.Lv.isEmpty)Tf=!0,0<yg&&Jg&&Pe.pop("InFormattingSpan");oe&&(Pe.pop("HasFieldEnd"),Jg=!1);Vd.Im&&(ml||(Li=!0),nl=ml=!1);Vd.hyperlink&&(ml&&(Li=!0),ml=!0,nl=Vd.hyperlink.Vra);Vd.Im&&!Li&&(Pe.pop("IsHyperlinkEnd"),Jg=!1);this.$c&&this.$c.isFeatureEnabled(17)&&
(Vd.isChangeEnd&&(ck||Z.ULS.sendTraceTag(36282713,324,15,"Found catch up change end with out change start!"),ck=!1,Bi=null),Vd.changeStart&&(ck&&Z.ULS.sendTraceTag(36282714,324,15,"Found catch up change start with out change end!"),Bi=Vd,ck=!Vd.Cj));if(this.gkb&&(Vd.isTrackChangeInfoEnd&&(Bl||(Aj=!0),Bl=!1,Ui=null),Vd.nN&&(Bl&&(Aj=!0),Ui=Vd,Bl=!Vd.Cj),Vd.isTrackChangeInfoEnd&&!Aj)){for(Jg=0;Jg<Bj;Jg++)Pe.pop("IsTrackChangeInfoEnd");Bj=0;Jg=!1}sk&&sk.tjk();Vd.Lv&&(sk||(sk=new $a(a)),sk.Xld(Vd.Lv));
if(Vd.M2&&!Vd.Cj){He=He||Vd.formatting;oe=this.uRf(Pe.peek("CreateIpFormattingSpan"),He,kj,b,a,Za,fa,Ui);oe=ya.a.k6a(oe);for(let vi of oe)pb=Ob.xga(l,pb,vi);nh.Mpg=!0}Vd.hyperlink&&!Li&&({GDa:pb,uIi:al,returnValue:Ff}=this.TOk(Ff,Vd,Pe,kj,nh,b,a,f,l,w,F,fa,Ui,pb,Za,rk,Jg,al));!this.gkb||Aj||Vd.Cj||(Vd.Vo&&(this.TDe(Vd.Vo,Pe,nh,b,fa),Bj++),Vd.fo&&(this.TDe(Vd.fo,Pe,nh,b,fa),Bj++),Vd.$r&&(this.TDe(Vd.$r,Pe,nh,b,fa),Bj++));wd&&({$Na:He,GDa:pb,returnValue:Ff}=this.POk(Ff,l,a,Vd,He,Pe,kj,nh,b,fa,Za,pb,
Jg,rk,Ui));this.xxg&&this.sLf(a,b,Hc&&Ec);Vd.blob?({GDa:pb,LQj:Cj,KQj:oh,returnValue:$h}=this.HOk(pb,Jg,He,Vd,w,F,rk,Ff,Pe,kj,nh,yg,$h,Ec,b,Dk,Hc,a,Za,l,Mb,hc,S,fa,Pd,Ui,Bi,ai,tg,Cj,oh,sk),Jg=!1,He=Ff=null):(wd=Vd.M2&&!Ja.a.substring(we,yg,hi).length,Tf&&(Tf=Ff,{$Na:He,returnValue:Ff}=this.ROk(He,Vd,kj,Pe,nh,b,a,fa,Ui,Za,wd),Jg=!0,Ff&&Ff.style&&(al&&Tf&&Tf.style&&(Tf.style.fontSize=Ff.style.fontSize,Tf.style.lineHeight=Ff.style.lineHeight),Cj&&Cj.style&&0<oh&&Vd.formatting&&Vd.formatting.cache.Era&&
oh>Vd.formatting.cache.fontSize&&(Cj.style.fontSize=Ff.style.fontSize,Cj.style.lineHeight=Ff.style.lineHeight))),al=!1,Cj=null,oh=0,wd||(Vd.yp&&(Df=Vd.yp),Vd.GE&&(Tg=Vd.GE),Vd.IK&&(Ig=Vd.IK),Vd.$v&&(ig=Vd.$v),Tf=Ja.a.substring(we,yg,hi),gi=this.oPd(Pe.peek("CreateTextOverlaySpan1"),He,a,Df,Tg,Ig,ig,b,Dk,fa,Tf,Hc&&(Mb<=yg&&yg<hc||a.AV),Td,bl,gi,sk,!!Ek,nl),Pe.push(gi,"TextOverlaySpan1"),nh.ZOe=!0,this.pFd(Pe.peek("AddCommentHintCssAndDataToElement"),ai,tg),this.oM&&this.oM.Stb&&Df&&Df.Gh&&(ai=Object(ua.a)(266,
Df.Gh))&&ai.IM&&ai.IM.TraceId&&5===ai.proofingType&&!ai.vCa&&(this.RKk(Pe.peek("RemoveConsistencyCheckCustomData")),tg=this.GYi(Vd.yp,a,Zi),K.a.nv(Pe.peek("errorDetails"),tg,ai.IM.TraceId)),this.wHe(Bi,Pe.peek("SetChangeId"),Vd.cp,hi),Hc&&Mb!==hc&&({GDa:pb,returnValue:yg}=this.Vyk(gi,Pe,He,a,Df,Tg,Ig,ig,nh,b,l,Dk,fa,we,Mb,hc,pb,yg,hi,Td,bl,sk,!!Ek,nl)),ya.a.Zw(Pe.peek("SetElementText"),Ja.a.substring(we,yg,hi)),pb=Ob.xga(l,pb,Pe.peek("AddLeafNodeElement"))))}if(a.DOc!==bk||this.gkb||this.Eoa.EJb)a.DOc=
bk,(f=lc.OutlineElementNavigator.uA(a))&&f.Rba(b.Na,32,!0);({KUc:Ff,GDa:pb,returnValue:Jg}=this.VOk(a,c,He,kj,nh,Ff,b,a,l,fa,Ui,Za,pb,Jg,rk));!bl.f4b&&bl.span&&this.EHd(null,bl.span);rk&&this.OOk(c,Ff,nh,b,a,l,fa,xa,pb,kc,Bi);Ol[Ol.length-1]=c.children.length;this.Prl($h,Dc,b);this.Ksl(nh,Jg,l);this.fkh(b,a,c);let rf;return rf=new ib,rf.$Lf=Pd,rf.Gig=$h,rf.pzf=Ol,rf.wSg=Dk,rf}cEb(a,b,c,f){this.NO.pb(a,b,c,f);return new Gc(a,b,c)}GYi(a,b,c){let f=0;a&&a.Gh&&(f|=16);if(c<b.Ra.length&&b.Ra.ga(c).GK||
c===b.Ra.length)f|=1;switch(f){case 0:return ec.a.Lse;case 16:return ec.a.YUc;case 1:return ec.a.Kdd;case 17:return ec.a.hBc}return""}RKk(a){K.a.ima(a,ec.a.Lse);K.a.ima(a,ec.a.YUc);K.a.ima(a,ec.a.Kdd);K.a.ima(a,ec.a.hBc)}wHe(a,b,c,f){this.$c&&this.$c.isFeatureEnabled(17)&&a&&a.changeStart&&K.a.nv(b,wb.Vhi,new Jc(a.changeStart.id,c,f))}TOk(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc){!Ec||Hc||b.M2||(a=this.YVb(c.peek("CreateFormattingSpan1"),null,f,w,F,pb,kc,Mb),a.className+=" EmptyTextRun",hc=Ob.xga(fa,
hc,a),Dc=l.qHc=!0);b=this.zwi(c.peek("CreateLinkAnchor"),b.hyperlink,w,S,xa,Za,pb);c.push(b,"RenderHyperlink");l.MQj=!0;return{returnValue:a,GDa:hc,uIi:Dc}}TDe(a,b,c,f,l){a=this.Uzi(b.peek("CreateTrackChangeRange"),a,f,l);b.push(a,"RenderTrackChange");c.Nkl=!0}POk(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc){Mb||f.M2||(l=f.formatting||l,hc?(a=this.YVb(w.peek("CreateFormattingSpan2"),l,F,fa,c,xa,Za,kc),a.appendChild(fa.ownerDocument.createTextNode("")),a.className+=" EmptyTextRun",pb=Ob.xga(b,pb,a),S.qHc=
!0):(a=this.hFc(l,F,fa,c,Za,kc),S.i4f=!0));b=this.yvi(w.peek("CreateFieldRangeSpan1"),fa,xa,c);w.push(b,"RenderFieldRange");S.FOi=!0;return{returnValue:a,$Na:l,GDa:pb}}HOk(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig,Ff,nh,Jg,$h,Li){b||(c=f.formatting||c,F&&!f.M2?(S=this.YVb(fa.peek("CreateFormattingSpan4"),c,xa,kc,Dc,Df,Td,Tg),S.appendChild(kc.ownerDocument.createTextNode("")),S.className+=" EmptyTextRun",a=Ob.xga(we,a,S),Za.qHc=!0):S=this.hFc(c,xa,kc,Dc,Td,Tg));1===f.blob.wq&&
(Mb=!0);b=f.blob.e8i(kc);b.Y4f(new yb(S));S=b.element;Sys.UI.DomElement.containsCssClass(S,nc.a.q5b)&&(Jg=S,c&&c.cache.Era&&($h=c.cache.fontSize));Sys.UI.DomElement.addCssClass(S,nc.a.AM);this.Eoa.hHi&&5!==f.blob.wq&&Sys.UI.DomElement.addCssClass(S,nc.a.dHi);this.gkb&&this.UOk(f,kc,S,Tg);this.pFd(S,Ff,nh);Li&&!Li.isEmpty?(Zc(S,Li),this.$kb&&this.$kb.C8g(S,Dc,(Aj,Zi,Ui,Bi)=>{Ec.add(this.cEb(Aj,Zi,Ui,Bi))},Li,1)):Pb(S);this.wHe(Ig,S,f.cp,f.cp+1);fa.peek("blobElt").appendChild(S);Pe(S,!0);ig.add(f.blob);
Hc&&(Pd<=pb&&pb+1<=He||Dc.AV)?(hc&&(Sys.UI.DomElement.containsCssClass(S,nc.a.CPd)||Sys.UI.DomElement.addCssClass(S,nc.a.CPd),u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordTouchImageGrippiesResizedSettings"),u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TouchImageGrippiesResizedIsEnabled")&&this.Jf&&this.Jf.Jd&&Object(Ca.a)(ab.PageView,this.Jf.Jd)&&(c=this.Jf.Jd,pb=u.AFrameworkApplication.Va,c&&3===c.ryg?pb.Ma(D.a.Gvh,2,S):pb.Ma(D.a.Hvh,2,S))),Sys.UI.DomElement.addCssClass(S,
nc.a.C6)):(Sys.UI.DomElement.removeCssClass(S,nc.a.CPd),Sys.UI.DomElement.removeCssClass(S,nc.a.C6));this.xxg||this.sLf(Dc,kc,Hc&&hc);Sys.UI.DomElement.removeCssClass(S,nc.a.yAi);this.$c&&this.$c.isFeatureEnabled(162)&&5===f.blob.wq&&(f=f.blob,f.properties&&f.properties.Sa(ob.a.V1b)&&(f=f.properties.getValue(ob.a.V1b))&&""!==f&&(Ec.add(this.cEb(ra.a.ila,S,l,f)),Ec.add(this.cEb(ra.a.ila,S,w,f))));a=Ob.xga(we,a,S);fa.push(S,"RenderBlob");return{returnValue:Mb,GDa:a,LQj:Jg,KQj:$h}}pFd(a,b,c){if(this.Eoa.EJb||
this.Eoa.WCh)b.length?(Sys.UI.DomElement.addCssClass(a,nc.a.GDc),K.a.nv(a,nc.a.PMd,b)):Sys.UI.DomElement.removeCssClass(a,nc.a.GDc);this.Eoa.WCh&&c.length&&K.a.nv(a,nc.a.LMd,c)}sLf(a,b,c){a=mb.GraphIterator.nb(a);a.af();a.Og(11);if(b=a.currentNode.pc(b.Na))b.htmlElement.style.zIndex=c?"1":""}UOk(a,b,c,f){let l=ya.a.AXi(c,Ob.Ivh);5===a.blob.wq&&f?(l||(l=b.Lo(ma.a.span),l.id=Ob.Ivh,Sys.UI.DomElement.addCssClass(l,Ub.psj),Sys.UI.DomElement.addCssClass(l,Ub.C2),c.appendChild(l)),this.j5f(b,l,f.Vo,Ub.jsj),
this.j5f(b,l,f.fo,Ub.nsj)):l&&c.removeChild(l)}j5f(a,b,c,f){c&&!ya.a.WZb(b,f)&&(a=a.Lo(ma.a.span),a.className=f,a.style.borderBottom="2px solid #000",b.appendChild(a))}ROk(a,b,c,f,l,w,F,S,fa,xa,Za){a=b.formatting||a;b=Za?this.hFc(a,c,w,F,xa,fa):this.YVb(f.peek("CreateFormattingSpan5"),a,c,w,F,S,xa,fa);f.push(b,"RenderFormattingSpan");l.i4f=!0;return{returnValue:b,$Na:a}}Vyk(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df){Dc<kc&&kc<Td&&(Dc=Ja.a.substring(hc,Dc,kc),ya.a.Zw(a,Dc),Hc=
Ob.xga(Za,Hc,a),b.pop("ProcessSelectionBegins"),a=this.oPd(b.peek("CreateTextOverlaySpan2"),c,f,l,w,F,S,xa,pb,Mb,Dc,!0,we,Pd,!1,He,Pe,Df),b.push(a,"TextOverlaySpan2"),Dc=kc,fa.ZOe=!0);Dc<Ec&&Ec<Td&&(hc=Ja.a.substring(hc,Dc,Ec),ya.a.Zw(a,hc),Hc=Ob.xga(Za,Hc,a),b.pop("ProcessSelectionEnds"),a=this.oPd(b.peek("CreateTextOverlaySpan3"),c,f,l,w,F,S,xa,pb,Mb,hc,!1,we,Pd,!1,He,Pe,Df),b.push(a,"TextOverlaySpan3"),Dc=Ec,fa.ZOe=!0);return{returnValue:Dc,GDa:Hc}}VOk(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc){if(0<
a.Ra.length){const Ec=a.Ra.last;let Hc;Hc=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TextRunForHyperlinkInTableCellEnabled");a=mb.GraphIterator.nb(a);!Ec.Im||Hc&&a.oc(16)||(hc=!1,c=null);if(this.gN?Ec.qZ:Ec.fieldRangeEnd)hc=!1,c=null;if(Ec.M2){c||(c=Ec.formatting);w=this.uRf(b,c,f,F,S,pb,xa,Za);b=ya.a.k6a(w);for(let Dc of b)Mb=Ob.xga(fa,Mb,Dc);l.Mpg=!0}else!hc&&kc&&(c||(c=Ec.formatting),w=this.YVb(b,c,f,F,S,xa,pb,Za),w.appendChild(F.ownerDocument.createTextNode("")),w.className+=
" EmptyTextRun",Mb=Ob.xga(fa,Mb,w),l.qHc=!0)}else Z.ULS.sendTraceTag(18482315,324,15,"CharacterProperties has no elements");return{returnValue:hc,KUc:w,GDa:Mb}}OOk(a,b,c,f,l,w,F,S,fa,xa,Za){var pb=Ob.YWi(a,xa);b=this.cRf(b,f,S,pb);Da.a.instance.shipAssertTag(25519712,8,0<l.Ra.length,"Chps should never be empty");S=null;l.Ra&&0<l.Ra.length&&(S=l.Ra.last);this.gkb&&S&&(S.Vo||S.fo||S.$r)&&(b.className+=" "+Ub.C2);let Mb;({HDc:pb,DDc:Mb}=Ob.e7f(S));this.pFd(b,pb,Mb);this.wHe(Za,b,S?S.cp:0,-1);xa&&(b.className+=
" "+gc.a.sQd);this.fkh(f,l,b);a.appendChild(b);F(b);Ob.xga(w,fa,b);c.XKi=!0}fkh(a,b,c){if(a.Al&&this.Yna.o9c&&this.Yna.N7k(c)){if((a=this.Yna.YPa(b))&&0<va.a.count(a))try{c.setAttribute("data-ccp-props",JSON.stringify(a))}catch(f){Z.ULS.sendTraceTag(23639749,307,15,"SetParagraphPropertiesOnHtmlElement for CCP - Cannot serialize object contains circular reference.")}(b=this.Yna.pdj(b))&&0<b.length&&c.setAttribute("data-indent",b)}}Uzi(a,b,c,f){c=c.Lo(ma.a.span);switch(b.changeType){case 2:c.className=
Ub.xuh+" "+Ub.C2;c.style.color="#000";break;case 1:c.className=Ub.zuh+" "+Ub.C2;c.style.color="#000";break;case 3:c.className=Ub.C2}a.appendChild(c);f(c);return c}Prl(a,b,c){a&&!b?c.notify(1):!a&&b&&c.notify(2)}Ksl(a,b,c){a.kQj=c.count;a.Psj=b;this.FRh(a)}zwi(a,b,c,f,l,w,F){c=c.Lo(ma.a.a);c.className=nc.a.Hjg;b.Vra&&b.dkc&&!I.a.instance.ga(61)&&(b.url.endsWith(u.AFrameworkApplication.fa.Ia("UserPrincipalName"))?c.className+=" "+nc.a.EAi:c.className+=" "+nc.a.FAi);this.Av.eoh()&&(c.style["pointer-events"]=
"all");this.Av.Cnh(this.Eoa.cvl,!0)&&this.yLk(c);this.NO.pb(ra.a.ila,c,l,b.url);this.NO.pb(ra.a.jla,c,w);f.add(c);b.url&&Ja.a.C7(b.url)&&!r.a.Ji&&(Ea.d(c,Ka.a.href,b.url),Ea.d(c,Ka.a.target,"_blank"),Ea.d(c,Ka.a.rel,"noreferrer"));a.appendChild(c);F(c);return c}yLk(a){a.style.textDecoration="none";a.style.color="inherit"}YVb(a,b,c,f,l,w,F,S){b=this.hFc(b,c,f,l,F,S);a.appendChild(b);w(b);return b}hFc(a,b,c,f,l,w){if(this.IJf){var F=a?a.Pl.toString():Fa.a.nil.toString();if(F in this.trc)a=this.trc[F];
else{let S=a?a.cache:rb.FormattingCacheManager.QZb(f,Fa.a.nil);a=this.kOd(a,S,b,c,f,l);this.trc[F]=a}b=a.cloneNode();K.a.oEc(a,b)}else F=a?a.cache:rb.FormattingCacheManager.QZb(f,Fa.a.nil),b=this.kOd(a,F,b,c,f,l);this.uFf(b,w);return b}kOd(a,b,c,f,l,w){const F=f.Lo(ma.a.span);b=this.Av.L7f(f,b,l)||b;this.F7h(f,F,b,l);this.J7h(F,b,l,f,w);this.S7h(F,a);this.dLa.V7h(F,l,c,f.Ed,b.fontSize,b.VM);return F}F7h(a,b,c,f){a=this.Av.K7f(a,f,c);for(let l of a.keys)b.setAttribute(l,a.ga(l))}uRf(a,b,c,f,l,w,F,
S){var fa=b?b.cache:rb.FormattingCacheManager.QZb(l,Fa.a.nil);fa=this.OGh(fa,l);b=this.kOd(b,fa,c,f,l,w);this.uFf(b,S);fa.isSuperscript||fa.ZE?(f=f.Lo(ma.a.span),this.qFf(f,fa,!0),b.appendChild(f),ya.a.Zw(f,""),F(f)):ya.a.Zw(b,"");a.appendChild(b);F(b);return b}J7h(a,b,c,f,l){var w=b.As;const F=[];Array.add(F,nc.a.UIa);var S=this.Av.MYd(c,b,this.Eoa.dvl,w);var fa=null;b.g7a&&(fa=b.MQ,fa=fa===Jb.a.auto?"transparent":Jb.a.HH(fa));b.HQa&&(fa=b.highlight,fa=fa===Jb.a.auto?"transparent":Jb.a.HH(fa));c.XTg!==
Jb.a.nil&&(S=Jb.a.HH(c.XTg));l!==Jb.a.nil&&(fa=Jb.a.HH(l));ya.a.$za(a);b.iig&&(a.style.opacity=b.L3f.toString());b.R7a&&(a.title=Box4Intl.Box4Strings.l_DeadWordLink);S?(a.style.color=S,Ea.d(a,Ka.a.xTf,"WindowText"===S?"auto":"none")):Ea.d(a,Ka.a.xTf,"auto");fa?(a.style.backgroundColor=fa,"transparent"!==fa&&Array.add(F,"Highlight")):Sys.UI.DomElement.removeCssClass(a,"Highlight");l=b.fontSize;if(b.isSuperscript||b.ZE)l=Math.floor(l*this.Av.X0d());S=this.Av.d9f(l,c,f.Ed);fa=this.Av.l_b(b);l=this.wU&&
this.wU.cSi?this.wU.GYh(b.VM):this.gIh(fa);this.Eoa.A8d&&l&&da.FontUtils.Yub(fa)&&(l=this.Av.wFf(fa,l));let xa=b.BQa&&b.isBold;void 0===xa&&(xa=!1);let Za=b.d7a&&b.isItalic;void 0===Za&&(Za=!1);l=this.Av.s6g(new ka.a(fa,xa,Za),l,c);!this.sol(fa,b,a.style)&&b.BQa&&(b.isBold?(a.style.fontWeight="bold",r.a.ak&&r.a.Gj&&Array.add(F,"MacChromeBold")):a.style.fontWeight="normal");b.d7a&&(a.style.fontStyle=b.isItalic?"italic":"normal");(b.Ysb||w&&this.Av.Enh()||b.Xsb||b.q1b)&&this.UDe(a,b,c,F);S&&(a.style.fontSize=
S);if(l&&(a.style.fontFamily=l,I.a.instance.ga(118))){Da.a.instance.J(51676058,8,4,"UseQuotesWithFontFamily is Enabled.");c=new Sys.StringBuilder("");w=l.split(",");for(l=0;l<w.length-1;l++)c.append('"'+w[l].trim()+'",');0<w.length&&c.append('"'+w[w.length-1].trim()+'"');a.style.fontFamily=c.toString()}b.CQa&&(1===b.capitalization?a.style.fontVariant="small-caps":2===b.capitalization?a.style.textTransform="uppercase":a.style.fontVariant="normal");if(f=this.Av.I6f(b,f.Ed))a.style.letterSpacing=f;if(b=
this.Av.f$f(b))a.style.fontKerning=b,r.a.uS&&(a.style.fontFeatureSettings="normal"===b?'"kern" 1':'"kern" 0');a.className=F.join(" ")}sol(a,b,c){return I.a.instance.ga(116)&&r.a.ak&&r.a.Gj?"Community Light"===a?(c.fontWeight=b.isBold?"400":"300",!0):"Community Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):"Community Slab Medium"===a?(c.fontWeight=b.isBold?"bold":"500",!0):"Community Slab Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):!1:!1}uFf(a,b){this.Yc.Zf&&b&&!b.Cj&&(b.Vo||b.fo)&&
(a.style.color="#000")}S7h(a,b){if(b=b?this.JKh(b):0){const c=qa.a.re(b);c?(a.setAttribute("xml:lang",c.name),a.setAttribute("lang",c.name)):this.Dxf.contains(b)||(Z.ULS.sendTraceTag(18482318,324,15,"Unknown LCID encountered in file: {0}",b),this.Dxf.add(b))}}UDe(a,b,c,f){c="";const l=b.mD,w=b.YE;b=b.pZ;l&&(c="underline",f[f.length]="Underlined");if(w||b)c=l?c+" line-through":"line-through",f[f.length]="Strikethrough";l||w||b||(c="none");0<c.length&&(a.style.textDecoration=c)}qFf(a,b,c){b.isSuperscript&&
(a.style.verticalAlign="super",a.className+=" Superscript");b.ZE&&(a.style.verticalAlign="sub",a.className+=" Subscript");c&&(a.style.backgroundColor="inherit");(b.isSuperscript||b.ZE)&&Ea.d(a,Ka.a.zTf,(b.fontSize/2).toString())}oPd(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc){const Td=b?b.cache:rb.FormattingCacheManager.QZb(c,Fa.a.nil);Za=!f||Mb||this.ROa(f,Za)?0:f.Gh.proofingType;Mb=!!l;const we=!!w,Pd=!!F;w=this.Av.Xnh(Td,pb,l,w,F);if(hc.f4b||Ec&&Lb(Ec))w=!1;this.IJf?(l=this.sdj(Td,Za,Mb,we,
Pd,pb,w,Hc),this.xxc.Kb(l)?pb=this.xxc.ga(l):(pb=this.ESf(S,Td,Za,Mb,we,Pd,pb,w,Hc),this.xxc.$(l,pb)),S=pb.cloneNode(),K.a.oEc(pb,S)):S=this.ESf(S,Td,Za,Mb,we,Pd,pb,w,Hc);this.O5h(a,S,Td);this.UGd(a,S);this.iDf(S);this.hDf(a,S);this.Yna.kti&&this.P5h(S,b,c);this.$kb&&0!==Za&&this.$kb.YDk(S,c,(He,Pe,Df,ig)=>{fa.add(this.cEb(He,Pe,Df,ig))},f);hc.f4b&&kc&&hc.span&&(this.EHd(null,hc.span),hc.span=null);if((b=hc.f4b?S:null)||hc.span)this.EHd(b,hc.span),hc.span=b,hc.span&&(b=(b=K.a.te(a,ca.a.dVc))?b:-1,
0<b&&(hc.span.style.lineHeight=String.format("{0}px",b+3)));Ec&&!Ec.isEmpty&&(Zc(S,Ec),this.$kb&&this.$kb.C8g(S,c,(He,Pe,Df,ig)=>{fa.add(this.cEb(He,Pe,Df,ig))},Ec,0));Dc&&Sys.UI.DomElement.addCssClass(S,nc.a.DAi);a.appendChild(S);xa(S);return S}ROa(a,b){b=a&&a.Gh&&a.Gh.token?a.Gh.token:b;return 0!==a.Gh.errorType&&!!this.MKa&&this.MKa.contains(b,a.Gh.lcid)}sdj(a,b,c,f,l,w,F,S){b|=0;w&&(b|=16);F&&(b|=32);c&&(b|=64);f&&(b|=128);l&&(b|=256);S&&(b|=2048);a.isSuperscript&&(b|=512);a.ZE&&(b|=1024);return b}ESf(a,
b,c,f,l,w,F,S,fa){a=a.Lo(ma.a.span);const xa=[];if(0!==c){if(!this.Eoa.gyl)switch(c){case 1:xa[xa.length]=nc.a.qFc;break;case 2:xa[xa.length]=nc.a.oFc;break;case 3:xa[xa.length]=nc.a.nFc}b.isSuperscript&&(xa[xa.length]=nc.a.EPd)}else fa&&(xa[xa.length]=nc.a.vAi);F&&(xa[xa.length]=nc.a.C6);f&&(xa[xa.length]=nc.a.zPd);l&&(xa[xa.length]=nc.a.BPd);w&&(xa[xa.length]=nc.a.pFc);a.className=0<xa.length?xa.join(" "):nc.a.wWb;this.qFf(a,b,S);return a}P5h(a,b,c){if(b&&a){if(b=Ab.a.yrb(b))if(b=Mc.StyleReader.BP(b)){a.setAttribute("data-ccp-charstyle",
b);return}(c=db.ParagraphReader.Pd(c)?Mc.StyleReader.iD(c):null)&&(c=Mc.StyleReader.BP(c))&&c!==Mc.StyleReader.AJa&&c!==Mc.StyleReader.$Ch&&a.setAttribute("data-ccp-parastyle",c)}}O5h(a,b,c){(c=this.Av.zdg(c))&&a.style&&a.style.fontSize&&""!==a.style.fontSize&&(a=a.style.fontSize,a=parseFloat(Ja.a.substring(a,0,a.indexOf("px"))),isNaN(a)||(b.style.verticalAlign=a/this.Av.X0d()*c/100+"px"))}UGd(){}iDf(){}hDf(){}yvi(a,b,c,f){b=b.Lo(ma.a.span);b.className=nc.a.xUd;this.nxc&&this.nxc.kBl(f,b);a.appendChild(b);
c(b);return b}cRf(a,b,c,f){b=b.Lo(ma.a.span);b.className=nc.a.RM;a&&(b.style.fontSize=a.style.fontSize,b.style.lineHeight=this.pYd(a),b.style.fontFamily=a.style.fontFamily);a="";for(let l=0;l<f;l++)a+=c;b.innerText=a;return b}pYd(a){return a.style.lineHeight}EHd(a,b){a?(Sys.UI.DomElement.addCssClass(a,"Highlight"),Sys.UI.DomElement.addCssClass(a,nc.a.zAi),b||Sys.UI.DomElement.addCssClass(a,nc.a.APd)):b&&((a=Sys.UI.DomElement.containsCssClass(b,nc.a.APd))&&Sys.UI.DomElement.removeCssClass(b,nc.a.APd),
Sys.UI.DomElement.addCssClass(b,a?nc.a.BAi:nc.a.AAi))}static xga(a,b,c){K.a.nv(c,ca.a.FDa,b);b<a.count?a.$(b,c):a.add(c);return b+1}static e7f(a){let b,c;b=[];c=[];if(a&&a.wg)for(let f=0;f<a.wg.length;f++){const l=a.wg.ga(f);Array.add(l.ek?b:c,l.GH)}return{HDc:b,DDc:c}}static fci(a,b){const c=new Bc.a;for(const l of b){var f=a.te(l);b=f.getValue(Sb.a.hVb);if(f=f.ta(Sb.a.EDc,null)){let w;({value:w}=c.Nf(f)).returnValue||(w=new Ua.a,c.$(f,w));w.add(b)}}return c}static g7f(a,b,c){const f=new Ua.a,l=
Ob.fci(a,b);for(const w of b){const F=a.te(w),S=F.getValue(Sb.a.hVb),fa=F.ta(Sb.a.qri,!1),xa=F.ta(Sb.a.lOf,!1);F.ta(Sb.a.U8d,!1)&&!xa&&(c.add(w),fa||l.Kb(S)||f.add(F.id))}return Va.$Kk(b,f)}static Vql(a,b,c,f){const l=new Ua.a,w=new Ua.a;b=Ob.g7f(a,b,l);a=Ob.g7f(a,c,w);c=new Ua.a;c.addRange(f);c.addRange(l);c=Va.aLk(c,w);return{HDc:b,DDc:a,TAi:c,HFj:0<w.count}}static YWi(a,b){var c=1;if(r.a.XE&&!b){a=ya.a.hKc(a,!1);for(let f of a)"IMG"===f.tagName?c+=3:Sys.UI.DomElement.containsCssClass(f,"PageBreakBlob")&&
(c+=Oa.BGc+Oa.yRd)}return c}}Ob.aSi=.8;Ob.Ivh="TrackChangeImageOverlay";Object(e.a)(Ob,"ParagraphContentRenderer",null,[1398]);var yc=d(74),fc=d(593),Nb=d(1168),lb=d(57);class Qc{constructor(a){this._element=null;this.mi=a;this.Qrc=[]}get ownerDocument(){return this.mi}get element(){return this._element}Bfb(a){this._element=a}iUg(){var a=Sys.EventArgs.Empty;if(this.Qrc)for(let b=0;b<this.Qrc.length;b++)(0,this.Qrc[b])(this,a)}dispose(){this.Qrc=this._element=this.mi=null}}Object(e.a)(Qc,"APresenter",
null,[1491,109]);class Rc extends Qc{constructor(a,b){super(b.htmlElement.ownerDocument);this.kkb=null;this.iPb=a;this.KWh=b}Y4f(a){this.element&&a.KUc===this.kkb||(this.kkb=a.KUc,this.Bfb(this.iPb.cRf(this.kkb,this.KWh.Gd,ca.a.zHc,1)),this.element.className=nc.a.q5b,this.element.style.lineHeight=this.kkb.style.lineHeight,a=""+K.a.te(this.kkb,ca.a.UHb),K.a.nv(this.element,ca.a.UHb,a),a=Nb.a.createElement(this.ownerDocument,ma.a.span),a.innerText=ca.a.Rhi,ya.a.Vt(this.element),this.element.appendChild(a),
a=Nb.a.createElement(this.ownerDocument,ma.a.br),this.element.appendChild(a))}wpg(){}dispose(){super.dispose();this.kkb=null}}Object(e.a)(Rc,"LineBreakPresenter",Qc,[]);class ld{constructor(a){this.iPb=a}create(a){return new Rc(this.iPb,a)}}Object(e.a)(ld,"LineBreakPresenterFactory",null,[1450]);class Dd extends Qc{constructor(a,b){super(a.ownerDocument);this.fEd=b;this.paa=a}Y4f(){this.element||(this.Bfb(this.paa.Lo(ma.a.span)),19===this.fEd.kind||18===this.fEd.kind?Sys.UI.DomElement.addCssClass(this.element,
nc.a.yPd):(Sys.UI.DomElement.addCssClass(this.element,nc.a.xWb),this.element.title=Box4Intl.Box4Strings.l_UnsupportedTooltip),this.element.innerText=this.fEd.w4a,this.iUg())}wpg(){this.Bfb(null);this.iUg()}}Object(e.a)(Dd,"UnsupportedObjectPresenter",Qc,[]);class gd{create(a,b){return new Dd(a,b)}}Object(e.a)(gd,"UnsupportedObjectPresenterFactory",null,[1449]);class be{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,w=!1,F=!1,S=!1){this.Gw=a;this.hHi=b;this.cvl=c;this.dvl=f;this.EJb=l;this.WCh=w;this.A8d=F;
this.gyl=S}}Object(e.a)(be,"ParagraphContentRendererSettings",null,[]);var od=d(109);class $d{constructor(a,b,c){this.vU=a;this.dY=b;this.MLb=c}a6a(a){return a}d9f(a,b,c){return c.fha(a)}I6f(){return null}f$f(){return r.a.Gj&&window.chrome?"none":null}PLf(){return!1}ywh(){return!1}wFf(){return""}gBh(){}JOf(){}boh(a){return a===D.a.underline||a===D.a.Lma||a===D.a.strikethrough||a===D.a.rs||a===D.a.T9}Wze(a,b){this.vU&&this.vU.isEnabled&&this.vU.createFontUrl(a);this.dY&&this.dY.isEnabled&&(b=da.FontUtils.Dmb(b,
a,!1,!1,!0),this.dY.createFontUrl(a));return b}s6g(a,b,c=null){if(!a)return b;b=this.Wze(a.fontName,b);this.MLb&&this.MLb.isEnabled&&(b=da.FontUtils.Dmb(b,a.fontName,!1,!0),this.MLb.vAl(a)||this.MLb.Czl(c),this.MLb.Mzl(a));return b}HRc(){return!1}MYd(a,b,c,f){a=null;!c&&f||!b.w2||(b=b.fontColor,a=b===Jb.a.auto?"WindowText":Jb.a.HH(b));return a}Xnh(a,b,c,f,l){return!b&&!c&&!f&&!l}zdg(){return 0}X0d(){return.8}Cnh(a,b){return a||!b}eoh(){return!1}Enh(){return!1}K7f(){return new Bc.a}L7f(){return null}l_b(a){return od.Font.PBa(a.VM)}}
Object(e.a)($d,"TextRenderingStrategy",null,[1327]);class xf{get name(){return"Box4.ParagraphRenderElements"}Yb(a){a.register(ld,"Box4.LineBreakPresenterFactory").as("Box4.ILineBreakPresenterFactory").ma().na(()=>new ld(a.resolve("Box4.IParagraphContentRenderer")));a.register(gd,"Box4.UnsupportedObjectPresenterFactory").as("Box4.IUnsupportedObjectPresenterFactory").ma();a.register($d,"Box4.TextRenderingStrategy").as("Box4.ITextRenderingStrategy").ma().na(()=>new $d(a.qb("Box4.IFontService"),a.qb("Box4.CustomFontService"),
a.qb("Box4.IEmbeddedFontService")));a.register(be,"Box4.ParagraphContentRendererSettings").ma().na(()=>new be(yc.ListReader.Gw,u.AFrameworkApplication.fa.ka("DragDropSelectionIsEnabled"),I.a.instance.ga(49),I.a.instance.ga(53),u.AFrameworkApplication.fa.ka("WordEditorCommentImprovementIsEnabled"),u.AFrameworkApplication.fa.ka("CommentTextAnchoringUIEnabled"),u.AFrameworkApplication.fa.ka(da.FontUtils.DNf),u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")));a.register(Ob,"Box4.ParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().na(()=>
new Ob(oa.InteractiveViewManager.instance,ia.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.qb("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.Proofing.IIgnoreAllKeywords"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.ParagraphContentRendererSettings"),a.resolve("Box4.ILineSpacingHelper"),a.qb("Box4.IFeatureHelper"),da.FontUtils.eha,a.qb("Box4.IFontSlotProvider"),Object(C.a)(a.resolve("Box4.IEditStateEventManager"),
a.resolve("Box4.IEditStateEventManager").I8g,"raiseParagraphContentUpdatedEvent"),Ab.a.language,a.qb("Box4.ITableOfContentRenderHelper"),fc.a.ZHf))}init(){}dispose(){}static main(){m.a.instance.Ec(new xf)}}Object(e.a)(xf,"Box4ParagraphRenderElementsPackage",null,[2,3]);class Na{constructor(a,b,c,f,l,w,F){this.B9d=a;this.oOj=b;this.CSc=c;this.QIj=f;this.JLj=l;this.Gw=w;this.gMj=b&&F||f}}Object(e.a)(Na,"TableCellViewElementSettings",null,[]);class xb{get name(){return"Box4.TableViewElements"}Yb(a){a.register(Na,
"Box4.TableCellViewElementSettings").ma().na(()=>new Na(u.AFrameworkApplication.fa.ka("OneNoteSpannedTableCellRenderIsEnabled"),I.a.instance.ga(63),I.a.instance.ga(30),I.a.instance.ga(77),I.a.instance.ga(71),yc.ListReader.Gw,u.AFrameworkApplication.fa.ka("WordEditorTableCellWidthIsEnabled")))}init(){}dispose(){}static main(){m.a.instance.Ec(new xb)}}Object(e.a)(xb,"Box4TableViewElementsPackage",null,[2,3]);var sc=d(1153),cd=d(375),Ta=d(1177),Hb=d(217),oc=d(159),Oc=d(177),Yc=d(1110);class Qd{te(a,
b){return K.a.te(a,b)}nv(a,b,c){K.a.nv(a,b,c)}ima(a,b){K.a.ima(a,b)}sHa(a){K.a.sHa(a)}oEc(a,b){K.a.oEc(a,b)}}Object(e.a)(Qd,"CustomDataProxy",null,[1538]);var ce=d(337),id=d(63),gb=d(27);class pc{constructor(){this.Ta=new sd.a}HBk(a){this.Ta.raiseEvent("OnBackspaceDelete",a)}}Object(e.a)(pc,"BackspaceDeleteEventSource",null,[1425,1426]);class zc extends Sys.EventArgs{constructor(a,b){super();this.YL=a;this.HT=b}}zc.eventId="AEV.AVLD";Object(e.a)(zc,"EditingViewOnAfterValidateEventArgs",Sys.EventArgs,
[]);class Ic extends sd.a{constructor(){super()}VBf(a){this.addHandler(zc.eventId,a)}PMk(a){this.removeHandler(zc.eventId,a)}}Ic.Lri="AEV.CR";Object(e.a)(Ic,"ContentEditableViewEventSource",sd.a,[]);var Fc=d(49);class rd{constructor(){this.Avc=null;this.Nh=0}V6i(a){if(!this.Avc){var b=a.Lb?Fc.a.createTextRange(a.node,0,a.Lb):Fc.a.Wj(a.node,a.Lb);this.Avc=fb.HyperlinkReader.HB(b,!1);this.Nh=this.Avc.length-1}for(;0<=this.Nh;)if(b=this.Avc[this.Nh],a.Lb<=b.Qa)--this.Nh;else return b.Lb<=a.Qa?null:b;
return null}}Object(e.a)(rd,"OverlappingHyperlinkHelper",null,[]);class Yd{constructor(a,b,c,f,l){this.BYa=a;this.QC=b;this.Jpa=c;this.b5c=f;this.c5c=l}}Object(e.a)(Yd,"PersistActiveSpanEditState",null,[]);class me{constructor(a,b){this.rg=a;this.Vg=b;this.dvc=[];this.nH=this.mH=-1}aEe(){if(-1!==this.mH&&-1!==this.nH&&this.Vg){this.dvc.reverse();const a=this.dvc.join("");let b,c;this.mH===this.nH?(b=Fc.a.Wj(this.rg,this.mH),c=!!a.length):(b=Fc.a.createTextRange(this.rg,this.mH,this.nH),c=this.nH-
this.mH!==a.length||this.p1d(b)!==a);c&&this.Vg.replaceTextRange(b,a,!0,void 0,D.a.typing)}this.nH=this.mH=-1;Array.clear(this.dvc)}u7h(a,b){this.mH=a.Qa;-1===this.nH&&(this.nH=a.Lb);0<b.length&&Array.add(this.dvc,b)}p1d(a){return db.ParagraphReader.text(a.node).substring(a.Qa,a.Lb)}}Object(e.a)(me,"ReplacementTextRangeBuilder",null,[]);var Db=d(38);class af{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb){this.Ch=a;this.DC=b;this.roa=c;this.Uf=f;this.ld=l;this.Tm=w;this.qd=F;this.ym=fa;this.nd=xa;this.kf=
Za;this.mb=pb;this.Zsc=this.mb.ka("TextLayoutServiceUseResponse");this.iaf=this.mb.ka("TextLayoutServiceEnableActiveContentSpanFix")}inl(){let a,b;a=b=null;if(this.qd&&this.qd.XT){var c=this.ym.getSelection(this.nd.contentWindow);if(c){a=b=c.focusNode;for(c=null;b&&"span"!==(c=b.nodeName.toLowerCase())&&!Sys.UI.DomElement.containsCssClass(b,nc.a.Kda);)b=b.parentNode;"span"!==c&&(b=null);return{returnValue:!!b,G3f:a,H3f:b}}}return{returnValue:!1,G3f:a,H3f:b}}u6i(a){let b=0;for(let c of ya.a.k6a(a))"span"===
c.nodeName.toLowerCase()&&b++;return b}CWk(a){if(!a.parentNode||!a.parentNode.parentNode)return null;for(var b=a.parentNode;!Sys.UI.DomElement.containsCssClass(b,nc.a.Kda)&&!Sys.UI.DomElement.containsCssClass(b,nc.a.O7);){if("font"===b.nodeName.toLowerCase()){a=b.previousSibling;if(!a)break;if("a"===a.nodeName.toLowerCase()){b=null;for(let c of ya.a.k6a(a))"span"===c.nodeName.toLowerCase()&&(b=c);return b}}b=b.parentNode}return null}hZi(a,b,c,f,l){let w=ya.a.Ou(c);const F=ya.a.TWd(c,nc.a.Kda);l=this.u6i(F)+
this.Ch.yi.length-l.Es.length;2>l?f.nextSibling&&"span"!==f.nextSibling.nodeName.toLowerCase()&&"br"!==f.nextSibling.nodeName.toLowerCase()?w=ya.a.Ou(f)+ya.a.Ou(f.nextSibling):"span"!==c.nodeName.toLowerCase()&&c.nextSibling?w=ya.a.Ou(f):"#text"===c.nodeName.toLowerCase()&&c.parentNode!==f&&(w=ya.a.Ou(f)):2===l?f.nextSibling&&"span"===f.nextSibling.nodeName.toLowerCase()&&(w=ya.a.Ou(f)+ya.a.Ou(f.nextSibling)):2<l&&(w=b.innerText,Z.ULS.sendTraceTag(541172697,323,50,"GetCorrectLastActiveSpanTextForCompleteOvertype: SpanCountDiff > 2"));
a.nVb||!b.innerText.endsWith(" ")||w.endsWith(" ")||(w+=b.innerText.substr(b.innerText.trimEnd().length));return w}osk(a,b,c,f,l){const w=new Yd(null,null,!0,null,null);let F=null,S=null;if(1===this.kf.mode||2===this.kf.mode)({G3f:F,H3f:S}=this.inl());let fa=!1,xa=!1;const Za=new rd,pb=new me(a,f),Mb=0<this.Ch.yi.length&&this.Ch.yi[0].nVb;let hc=null;F&&this.mb.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&(hc=this.CWk(F));for(let Ec=this.Ch.yi.length-1;0<=Ec;Ec--){const Hc=this.Ch.yi[Ec],Dc=
Hc.CE;let Td=!1;if(this.iaf&&this.Zsc&&S&&!ya.a.RXb(Dc)){var kc=!1;Mb&&Ec===this.Ch.yi.length-1&&!ya.a.TWd(F,nc.a.RM)?Td=kc=!0:1===this.Ch.yi.length&&(kc=!0);kc&&(Dc.innerText=this.hZi(Hc,Dc,F,S,c),w.Jpa=!1)}w.QC=ya.a.Ou(Dc);this.DC.T5&&this.jJi(w.QC)&&(w.QC=Ja.a.substr(w.QC,0,w.QC.length-1));kc=this.TYi(a,Ec);this.pbk(a,b,Ec,w);xa=!!w.BYa||xa;hc===Dc&&(w.c5c=Dc.innerText+ya.a.Ou(F),F.nodeValue="",w.Jpa=!1,Z.ULS.sendTraceTag(541172698,323,50,"PersistActiveSpanEdits: Moved text from bare node to sibling span"));
w.b5c||(w.b5c=this.IPi(a,kc,Za));const we=!!l&&l.Yri(kc);this.eql(a,b,Dc,Ec,w,Td);we&&0<w.QC.length?(pb.aEe(),this.replaceTextRange(f,w,"",kc),this.P7h(l,we,w,kc)):this.Yoi(Hc,w.QC,kc,pb);fa=Dc===S||fa}pb.aEe();this.Srl(a,w);F&&ya.a.Ou(F)&&!fa&&!xa&&(this.ld.Vb("ValidTextDropped",{["Reason"]:"TextLostDuringOvertype"}),af.ycf||(Z.ULS.sendTraceTag(23909632,323,50,"PersistActiveSpanEdits: browser created new span with text that are is lost during OverType"),af.ycf=!0));return w.Jpa}Yoi(a,b,c,f){if(c.contextId!==
Db.a.Ff&&!a.nVb&&0<=a.O8c){let l=a.O8c,w=a.Awe;a=l!==w?Fc.a.createTextRange(c.node,l,w):Fc.a.Wj(c.node,l);b=b.substring(l-c.Qa,b.length-(c.Lb-w))}else a=c;a.Lb-a.Qa!==b.length||b!==this.p1d(a)?f.u7h(a,b):f.aEe()}jJi(a){return a.charAt(a.length-1)===Oa.rCb||r.a.Xn&&a.charCodeAt(a.length-1)===x.a.tJb}p1d(a){return db.ParagraphReader.text(a.node).substring(a.Qa,a.Lb)}replaceTextRange(a,b,c,f){b.QC!==c&&a&&a.replaceTextRange(f,b.QC,!0,!0)}P7h(a,b,c,f){b&&0<c.QC.length&&(b=Fc.a.createTextRange(f.node,
f.Qa,f.Lb+c.QC.length),a.R7h(b))}Srl(a,b){b.b5c&&(b=fb.HyperlinkReader.HB(b.b5c,!0),1===b.length&&this.Tm&&this.Tm.$3k(a,b[0]))}eql(a,b,c,f,l,w){const F=ya.a.$bg(c);this.Ch.yi[f].nVb&&F?w||this.pij(b,f,l,F):l.BYa&&!Sys.UI.DomElement.containsCssClass(c,nc.a.AM)?(this.ld.Vb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan"}),this.Uf.bc++,l.QC+=l.BYa,l.BYa=null,ya.a.Zw(this.Ch.yi[f].CE,l.QC)):l.c5c?(l.QC=l.c5c,l.c5c=null):this.Zsc&&this.iaf&&(a=db.ParagraphReader.text(a),b=this.Ch.yi[f],
c=b.O8c,w=b.Awe,f+1<this.Ch.yi.length&&!ya.a.RXb(this.Ch.yi[f+1].CE)&&c===w&&0<c&&" "===a.charAt(c-1)&&(l.QC=l.QC.substr(0,c-1)+" "+l.QC.substr(c-1),l.Jpa=!1),b.CE.innerText.endsWith(" ")||" "!==a.charAt(w)||b.WVa+b.lQa!==w+1||(l.QC+=" ",l.Jpa=!1))}pij(a,b,c,f){!b&&c.BYa?(this.ld.Vb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan0"}),this.Uf.bb++,c.QC=c.BYa,ya.a.Zw(this.Ch.yi[b].CE,c.QC),this.qd.nD&&(a=a.lastChild,this.Zsc&&Sys.UI.DomElement.containsCssClass(a,nc.a.O7)&&(a=a.lastChild),
a&&a.parentNode&&a.parentNode.insertBefore(f,a)),c.BYa=null):(this.ld.Vb("ValidTextDropped",{["Reason"]:"EopTextLostDuringOvertype"}),this.Uf.bd++,c.QC="",ya.a.Zw(this.Ch.yi[b].CE,c.QC))}TYi(a,b){b=this.Ch.yi[b];return b.WVa?Fc.a.createTextRange(a,b.lQa,b.lQa+b.WVa):Fc.a.Wj(a,b.lQa)}pbk(a,b,c,f){if(this.Ch.yi[c].lQa+this.Ch.yi[c].WVa===db.ParagraphReader.textLength(a)&&(a=b.lastChild,this.Zsc&&Sys.UI.DomElement.containsCssClass(a,nc.a.O7)&&(a=a.lastChild),c=ya.a.Ou(a),c.length>this.roa.tTd)){this.Uf.ba++;
this.DC.ofb(!1,b,this.Ch);f.BYa=Ja.a.substr(c,0,c.length-this.roa.tTd);b="";for(c=0;c<this.roa.tTd;c++)b+=ca.a.zHc;a.innerText=b;f.Jpa=!1}}IPi(a,b,c){return(b=c.V6i(b))&&af.BAj(b)?Fc.a.Wj(a,b.Qa):null}static BAj(a){return!!a.hyperlink&&a.hyperlink.url===db.ParagraphReader.text(a.paragraph).substring(a.Qa,a.Lb)}}af.ycf=!1;Object(e.a)(af,"ActiveContentSpansPersistanceManager",null,[1424]);class bg{constructor(a){this.es=a}Wek(a){a&&this.es.EX()}}Object(e.a)(bg,"AppFrameResizeEventProcessor",null,[]);
class Qe{constructor(){this.ZRb=new Ua.a}ya(a){this.ZRb.add(a)}Xqa(a){return this.ZRb.count>a?this.ZRb.ga(a):null}get IDa(){return this.ZRb.count}isEmpty(){return!this.ZRb.count}}Object(e.a)(Qe,"AggregatedAutoCorrectActions",null,[633]);var Af=d(227);class tf{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec){this.zQ=this.Tm=this.Urc=this.Qe=null;this.wu=a;this.tJ=b;this.uh=c;this.Mb=f;this.Ch=l;this.bY=w;this.Xo=F;this.Ni=S;this.Mfa=fa;this.es=xa;this.kf=Za;this.bR=pb;this.kk=Mb;this.Rc=hc;this.Yc=
kc;this.Go=Ec}KR(a){this.Qe=a}get sTb(){return this.tJ}get hyperlinkEditor(){return this.Tm||(this.Tm=lb.a.instance.qb("Box4.IHyperlinkEditor"))}get $qj(){return this.Urc||(this.Urc=lb.a.instance.qb("Box4.IHyperlinkActionFactory"))}bzj(a){if(this.wu.instance&&a&&2===this.uh.mode)if(this.Qe.ds(!0),this.Mfa.value.Mv(),a.Dw)this.wu.instance.$yj(a),this.Mfa.value.Mv();else{var b=this.Ni.V6(this.uh.mode,this.Mb.Ci);a.Fjg.innerText=a.Fjg.innerText;this.bR.Zhc();this.Xo.raiseEvent(Af.a.autoCorrect);1===
this.wu.instance.azj(a)&&(this.kf.U9(!0),b>=a.X3&&(b+=a.aVc),this.Ni.bS(b,this.Mb.Ph),this.Qe.ds(!0),this.Mfa.value.Mv(),this.es.EX())}}Wqe(a,b){if(!this.wu.instance||!this.$qj||!this.hyperlinkEditor)return null;this.Qe.ds(!0);a=this.bY.hra(b).Wa;b=a.Qa;if(0>=b||!this.Ch.yi.length)return null;if(a=this.wu.instance.Wqe(a.node,b))this.zQ||(this.zQ=new Qe),this.zQ.ya(a);return a}WFi(a,b){if(2===this.uh.mode&&this.Ch.yi.length){var c=this.Ni.V6(this.uh.mode,this.Mb.Ci);!this.zQ&&this.wu.instance&&(b=
this.bY.hra(b).Wa,0>c||!this.Ch.yi.length||(this.zQ=new Qe,this.zQ=this.wu.instance.LQf(b.node,c,c-this.Ch.yi[0].kBc,this.Ch.yi[0].CE,!this.Ch.yi[0].kBc,a),this.zQ.IDa||(this.zQ=null)))}}gsk(){if(2===this.uh.mode){if(0<this.zQ.IDa){this.Qe.ds(!0);for(var a=0;a<this.zQ.IDa;a++)this.zQ.Xqa(a).WBh();for(a=0;a<this.zQ.IDa;a++)this.bzj(this.zQ.Xqa(a))}this.zQ=null}}}Object(e.a)(tf,"AutocorrectActionExecutor",null,[]);var uf=d(309);class kg{constructor(a,b,c,f,l,w,F,S,fa,xa){this.kWh=w;this.bY=a;this.Zi=
b;this.KC=c;this.ef=f;this.BJ=l;this.IUe=F;this.Yc=S;this.HC=fa;this.Exa=!!xa;this.wu=xa}unl(a,b,c,f,l,w,F){if(!f)return!1;f=this.bY.hra(l);if(!f||!this.ef.Ew(f)||!f.Wa.Ok)return!1;l=f.Wa;if(this.hIj(l)||this.NFj(a,l)||this.p8a(l))return!1;if(gb.App.D$h){if(this.gIj(w))return!1}else if(this.fIj(w))return!1;return this.BJ&&this.BJ.iub(f)||!this.bhi(a,this.Zi,F,ya.a.Ou(c),b)||this.Exa&&!a&&this.wu.instance&&this.wu.instance.rpj()?!1:!0}gIj(a){if(this.IUe&&a&&Sys.UI.DomElement.containsCssClass(a,nc.a.Kda)){const b=
ya.a.rba(a,nc.a.O7);b&&(a=b)}return ya.a.rba(a,kg.WTg)?!0:!1}fIj(a){if(this.IUe&&a&&Sys.UI.DomElement.containsCssClass(a,nc.a.Kda)){const b=ya.a.rba(a,nc.a.O7);b&&(a=b)}return ya.a.rba(a,uf.a.g9a)||ya.a.rba(a,kg.WTg)?!0:!1}p8a(a){return this.HC.p8a(a).returnValue}hIj(a){return this.Zi&&(!this.kWh.fUb(a.node)||I.a.instance.ga(14)&&this.KC.O1g(a.node))?!0:!1}NFj(a,b){return I.a.instance.ga(14)&&this.KC.uGj(b,!a)}bhi(a,b,c,f,l){if(!f||""===f)return!1;var w=this.Yc.Zf&&this.Yc.fy;w=a&&!w?0:1;!a&&1<c&&
Ja.a.Hw(f,c-1)?w=2:c<f.length&&Ja.a.Hw(f,c)&&(w=1);if(a){if(a=c+w,a>=f.length-2||!this.chi(c,f,w))return!1}else{a=c-w;if(b){if(0>a)return!1}else if(0>=a)return!1;if(1===a&&Ja.a.vy(f.charCodeAt(0))&&(f.length===c||Ja.a.vy(f.charCodeAt(c))))return!1}b=N.a.eCa(l,a,!0,!0);return Sys.UI.DomElement.containsCssClass(b,ca.a.xAi)||Sys.UI.DomElement.containsCssClass(b,nc.a.RM)||Sys.UI.DomElement.containsCssClass(b,nc.a.AM)||Sys.UI.DomElement.containsCssClass(b,ca.a.QU)?!1:!0}chi(a,b,c){return Ja.a.vy(b.charCodeAt(a+
c))&&(!a&&b.length===1+c||1===a&&Ja.a.vy(b.charCodeAt(0)))?!1:!0}}kg.WTg="NoteTagContainer";Object(e.a)(kg,"BackspaceInBrowserHandler",null,[]);var Lg=d(1164),$g=d(194);class yf{constructor(a,b,c){this.point=a;this.width=b;this.height=c}}Object(e.a)(yf,"UnroundedRectangle",null,[]);var Kf=d(1022),dd=d(62),lg=d(143);class Wh{constructor(a,b,c,f,l,w,F,S,fa){this.vh=null;this.rea=!1;this.V$=a;this.nd=b;this.hY=c;this.X0=f;this.qd=l;this.Jf=w;this.kf=F;this.Mb=S;this.TO=fa}BTb(a){this.vh=a}EX(){if(2===
this.kf.mode&&this.Mb.Bg){var a=this.Mb.fV,b=this.Mb.Ph;if(a&&b){if(!this.nd.xg&&(u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordBoundsSynchronizerHeaderFooterEarlyReturnSettings"),u.AFrameworkApplication.fa.ka("BoundsSynchronizerHeaderFooterEarlyReturnIsEnabled"))){Z.ULS.sendTraceTag(51667991,317,50,"Null EditingDom in SynchronizeBounds. ViewId: {0}",this.vh.Na);return}this.nd.xg.$se(a);b=this.nd.xg.Ot;var c=this.v8f(a.htmlElement,b.parentNode);if(c&&c.point){var f=c.point;
a=c.width;c=c.height;0>a&&(a=0);var l=Lg.a.create();try{b.style.top=f.y.toString()+"px",b.style.left=f.x.toString()+"px",b.style.width=a.toString()+"px",b.style.height=c.toString()+"px",b.style.paddingRight=""}finally{l&&l.dispose()}this.koh()&&(f=this.nd.Ql(),this.ZNj()?f.style.clip="":(b.style.height=c+100+"px",f.style.clip="rect(0px,"+a+"px,"+c+"px,0px)"));this.V$.instance.psl(b.parentNode,this.Mb.Xaa,!!this.vh&&this.vh.Al&&this.vh.Tqb)}}}}koh(){return this.qd.nD&&!this.qd.Ji&&I.a.instance.ga(30)}eDj(a){return ya.a.rRa(a)}ZNj(){return lg.c(this.vh.ug)}ei(a){return id.a.ei(a)}ith(a){var b=
dd.a.instance.Pa.kb;if(1===this.kf.mode){var c=(b.uf?b.We:b.Wa).node;b=c.pc(this.Jf.Jd.Na);a=c.pc(a);if(b&&a){this.nd.xg.$se(b);a=this.nd.xg.Ot;var f=this.v8f(b.htmlElement,a.parentNode);if(f&&f.point){b=f.point;c=f.width;f=f.height;0>f&&(f=1);0>c&&(c=1);a=a.style;if(this.qd.Ueb)this.X0.ijg();else{const l=b.x+"px";c+="px";f+="px";if(a.left!==l||a.width!==c||a.height!==f)a.left=l,a.width=c,a.height=f}b=b.y+"px";a.top!==b&&(a.top=b)}}}}v8f(a,b){if(!this.eDj(a))return null;var c=this.ei(a),f=this.ei(b);
let l=c.x-f.x;f=c.y-f.y;var w=Lg.a.create();try{l+=b.scrollLeft,f+=b.scrollTop}finally{w&&w.dispose()}b=c.width;c=c.height;this.hY&&this.hY.instance&&this.hY.instance.ftg(a)&&(w=this.hY.instance.Q1,b/=w,c/=w);if(this.TO.Wub(a)){var F=$g.a.Nu(a);F&&(w=parseFloat(F.width),F=parseFloat(F.height),isNaN(w)||isNaN(F)||(b=w,c=F))}0>=b&&(b=a.scrollWidth);0>=c&&(c=a.scrollHeight);if(this.qd.tRa||this.qd.Xn)b+=.001,l+=.001,f+=.001;c+=1.001;return new yf(new Kf.a(l,f),b,c)}}Object(e.a)(Wh,"BoundsSynchronizer",
null,[1422]);var Gd=d(552),Se=d(79);class hj{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.rPh=new Gd.a(RegExp("\r\n","g"),"\n");this.hud=null;this.$vd=0;this.Pzd=!1;this.hsc=!0;this.ld=b;this.Uf=c;this.rtc=a;this.nd=f;this.Do=l;this.qd=w;this.Jf=F;this.Md=S;this.Zi=fa;this.ym=xa;this.dBd=Za;this.Zoa=Mb}get qrg(){null==this.hud&&(this.hud=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CursorPositionFixForIMEInMacIsEnabled"):!1);return this.hud}get fSa(){return this.$vd}get uEk(){return this.Pzd}get gyj(){return this.hsc}xKc(a,
b){var c=this.nd.MBa();if(1===a||0===a)return 0;if(this.qd.XT){var f=this.JBa();if(f){this.Pzd=!this.eTc(f);c=this.ym.hNc(f);var l=this.ym.hdg(f),w=l;u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordCursorPositionFixForIMEInMacSettings");this.qrg&&this.qd.ak&&(f=this.ym.z8f(f),l!==f&&(w=f));return this.Do.q_d(c,b,w,this.Uf,this.ld,this.Zi)}Z.ULS.sendTraceTag(51463631,324,50,"GetCaretPosition could not find IP, rangeObject is null")}else if(this.qd.XE)try{return l=c.selection.createRange(),
w=this.nd.Ql().innerText,b=0,""!==w&&(b=Math.abs(this.ym.moveStart(l.range,-1E5)),l=c.selection.createRange(),f=Math.abs(this.ym.moveEnd(l.range,-1E5)),this.Pzd=b!==f),w=this.rPh.VGa(w),b>=w.length&&(b=w.length-1),b}catch(F){this.ld.Vb("IncorrectIpPosition",{["Reason"]:"OldIeGetCaretPositionException"}),this.Uf.bg++,Z.ULS.sendTraceTag(51463190,324,15,"Incorrect IP position, message: {0}, Exception: {1}",F.message,F.toString())}else Z.ULS.sendTraceTag(51463191,324,15,"GetCaretPosition could not find IP, returned 0");
this.Uf.bh++;return 0}eTc(a){return id.a.eTc(a)}JBa(){return id.a.JBa(this.nd.contentWindow)}o8k(a,b,c,f,l){if(!u.AFrameworkApplication.fa||!u.AFrameworkApplication.fa.ka("TextLayoutServiceEnableSelectionCursorFix")||c!==l+f||a===b.Es.length-1||Sys.UI.DomElement.containsCssClass(b.Es[a+1],nc.a.RM))return!1;a=b.Es[a];b=ya.a.TWd(a,nc.a.O7);if(!b)return!1;b=ya.a.k6a(b).toArray();return b[b.length-1]!==a?!1:!0}bS(a,b){var c=this.nd.contentWindow;this.hsc=!0;this.$vd=a;try{if(this.qd.XT){const w=b.Es;
let F;var f=0;const S=this.ym.getSelection(c);if(S)for(F=0;F<b.Es.length;F++){const fa=b.Es;Z.ULS.shipAssertTag(18437200,315,w===fa);let xa=fa[F],Za=this.Do.VH(xa,this.Uf,this.ld,this.Zi);var l=a<=Za+f;const pb=Sys.UI.DomElement.containsCssClass(xa,nc.a.AM),Mb=Sys.UI.DomElement.containsCssClass(xa,ca.a.QU),hc=this.o8k(F,b,a,f,Za);if(l&&!pb&&!Mb&&!hc){b=F+1;if(a===Za+f&&b<fa.length){const kc=fa[b];!this.Do.VH(kc,this.Uf,this.ld,this.Zi)&&ya.a.RXb(kc)&&(xa=kc,f=a)}a-=f;this.rtc.value.dVb(xa,c);for(c=
xa;c.firstChild;)c=c.firstChild;this.TAj(S,c,a)||(c=this.HKi(c,this.nd.MBa()),this.qrg&&this.qd.ak?2!==this.Jf.editingView.ypb&&this.pZf(c,a,S):this.pZf(c,a,S));break}f+=Za}}else this.qd.XE&&(f=this.dBd.create(this.Jf.Jd),l=this.ym.createRange(this.nd.Ql()),this.ym.collapse(l,!0),this.ym.moveStart(l,a),l.select(),f.dispose())}catch(w){Z.ULS.shipAssertTag(4203852,315,!1)}}HKi(a,b){"SPAN"===a.nodeName&&(b=b.yl.createTextNode(""),a.appendChild(b),a=b);return a}pZf(a,b,c){if(this.Do.Qrg(a)){this.ym.removeAllRanges(c);
var f=this.ym.createRange(a.ownerDocument);this.ym.TFb(f,!0,a,b);this.ym.TFb(f,!1,a,b);try{this.ym.addRange(c,f)}catch(l){this.Uf.bl++,this.ld.Vb("PossibleNoIp",{["Reason"]:"AddRangeException"}),Z.ULS.shipAssertTag(1708946,315,!1)}this.ym.collapse(f,!0)}else Z.ULS.sendTraceTag(541172696,324,50,"EnsureCaretPositionToTextObject: Detached element")}updateCaretPosition(a,b){this.$vd=this.xKc(a,b)}mouseDown(){return this.hsc=!1}OW(){this.hsc=!0;return!1}V6(a,b){this.Zoa&&this.Zoa.dwl(this.fSa,this.xKc(a,
b));return this.fSa}TAj(a,b,c){const f=a.focusNode,l=!!f&&3===f.nodeType,w=a.focusOffset;return a.isCollapsed&&l&&f===b&&w===c}pUf(a,b){const c=new Se.a(0,1,0,()=>{b.bSa(a.mode)&&this.updateCaretPosition(a.mode,b.Ci)},28);this.Md.Hb(c)}}Object(e.a)(hj,"CaretPositionManager",null,[1421]);var cg=d(263);class ed{constructor(){this.FH=cg.a.instance.sXd()}}Object(e.a)(ed,"CevUsageDataTracker",null,[]);class Xg{constructor(a,b){this.Vpc=null;this.nga=0;this.Bg=this.fV=null;this.Xaa=!1;this.kza=a;this.Jf=
b}init(a){this.nga=a}get wpj(){return!!this.Bg&&!!this.Bg.yg(this.nga)}get ZNa(){Z.ULS.shipAssertTag(18437208,315,!!this.Bg);return this.Ph?this.Ph.htmlElement:null}get Ci(){return this.Ph?this.Ph.Ci:null}get Ph(){return this.Vpc}set Ph(a){this.Vpc=a;a=null;this.kza.instance&&(a=this.kza.instance.Wwh());this.Vpc&&a&&a.JBl(this.Vpc.Q1g)}bSa(a){return 1!==a||dd.a.instance.Pa.cca?this.Bg&&this.Ph&&this.fV?(a=this.Jf.Jd)&&db.ParagraphReader.Pd(this.Bg)&&this.Ph===this.Bg.pc(this.nga)&&this.fV===this.Bg.pc(a.Na)?
!0:!1:!1:!0}}Object(e.a)(Xg,"CevViewContentManager",null,[1420]);var Dh=d(1171),Qf=d(366);class Yb{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc){this.Qe=null;this.yJ=a;this.mDd=b;this.ld=c;this.Etd=f;this.Zoa=l;this.dga=w;this.wk=F;this.uh=S;this.Cr=fa;this.kf=xa;this.PKa=Za;this.D$=pb;this.qB=Mb;this.BU=hc;this.Clb=kc}KR(a){this.Qe=a}eNd(a,b,c){if(this.PKa.Osj||this.yJ.g2b||!b)return!1;if(this.mDd.Pmh)return!0;b=this.ld.zp(D.a.typing);b.properties.$(Dh.a.source,"Composition");a=this.Doi(a,c);
b.end();return a}Doi(a,b){this.Etd.correctBadImeState()&&this.Zoa.Whc(D.a.Fol);this.dga.fixupAfterMagnifierDrag();if(this.BU.P8c(a))return!1;this.wk.Uae=(new Date).getTime();if(1===this.uh.mode){let c;({u2:b,iHb:c}=this.BU.Zwh(a,b));if(b)return c}this.Cr.isComposing=!0;this.Clb||this.kf.U9(!0);a.eventName===ra.a.fNd&&this.D$.raiseEvent(Qf.a.POf,a);this.qB.GMa(a);return!1}qVb(a,b,c){this.Clb&&this.Qe&&this.Qe.ds(!0,!0);return this.eNd(a,b,c)}pVb(a,b,c){this.eNd(a,b,c);return this.Cr.isComposing=!1}}
Object(e.a)(Yb,"CompositionEventProcessor",null,[]);class li{constructor(a,b,c){this.eud=!1;this.D$=a;this.Xo=b;this.F5=c}get isComposing(){return this.eud}set isComposing(a){(this.eud=a)?(this.D$.raiseEvent(Qf.a.Eoi),this.Xo.raiseEvent(Af.a.Isj)):(this.D$.raiseEvent(Qf.a.Boi),this.Xo.raiseEvent(Af.a.Gsj))}get tDa(){return!this.isComposing&&!this.F5.zkg}}Object(e.a)(li,"CompositionStateManager",null,[]);var re=d(132),lf=d(90);class Id{constructor(a,b,c){this.vMh=u.AFrameworkApplication.fa.ka("AccessibilityNotificationEnabledViaAriaLiveRegion");
this.sza=this.prd=this.LEd=this.aya=this.Eqd=null;this.imb=a;this.hH=b;this.Jna=c;this.render();this.Jna.o5c&&this.hH.aP(Object(C.a)(this,this.a5c,"modeSwitched"))}a5c(){this.Jna.Lnh&&this.qfd(!0);this.wZf()}get Ot(){return this.LEd}get contentWindow(){return id.a.t7i(this.imb.ownerDocument)}get contentDocument(){return this.imb.ownerDocument}get Axa(){return this.imb}get vn(){return this.prd}get eDh(){return this.sza}get isValid(){return!0}initialize(a,b){this.aya=a;this.aya.tJd=Object(C.a)(this,
this.onBlur,"onBlur");b()}meh(){this.Ot.style.left="0px";this.Ot.style.top="0px"}FJi(){this.aya&&this.aya.xKi(this,this.hH)}fma(){}Ckd(){v.FocusManager.xr(this.contentWindow)}Mwh(){v.FocusManager.lol(this.vn)}get Mfb(){return!id.a.qzj(this.vn)}set Mfb(a){}oHe(a,b,c){this.vn.setAttribute(re.a.ht,a);this.Eqd&&(this.Eqd.innerText=b);this.gjc(c)}gjc(a){a&&this.vn.setAttribute(re.a.ff,a)}qfd(a){if(r.a.rj||a)a=!this.Jna.h7d&&a,this.vn.setAttribute("contenteditable",a?"true":"false"),this.Jna.Lnh?(Sys.UI.DomElement.addCssClass(this.vn,
"WACEditing"),Sys.UI.DomElement.addCssClass(this.vn,E.AppFrame.MXf),Sys.UI.DomElement.addCssClass(this.vn,"EditingSurfaceBody")):(Sys.UI.DomElement.removeCssClass(this.vn,"WACEditing"),Sys.UI.DomElement.removeCssClass(this.vn,E.AppFrame.MXf),Sys.UI.DomElement.removeCssClass(this.vn,"EditingSurfaceBody"))}dispose(){this.Hpl();this.Ot&&(this.Ot.parentNode&&this.Ot.parentNode.removeChild(this.Ot),this.prd=this.LEd=null)}render(){const a=String.format("{0}_EditingElement",this.imb.id),b=String.format("{0}_WrappingDiv",
a);this.LEd=document.createElement("div");this.Ot.id=b;this.Ot.style.height="0px";this.Ot.style.width="0px";this.Ot.style.display="none";gb.App.instance.DRc&&Sys.UI.DomElement.addCssClass(this.Ot,"NoPointer");this.prd=document.createElement("div");this.vn.id=a;this.vn.setAttribute("contenteditable",!this.Jna.h7d);this.vn.setAttribute("spellcheck","false");r.a.Pia&&this.contentDocument.execCommand("AutoUrlDetect",!1,!1);this.oZk();this.wZf();lf.c(this.vn,!0);lf.c(this.Ot,!0);this.sza=document.createElement("div");
this.Ot.appendChild(this.vn);this.imb.appendChild(this.Ot)}wZf(){if(this.vn){const a=String.format("{0}_WACEditing_DescribedByElement",this.imb.id),b=this.Jna.iXh;this.Jna.h7d?this.vn.setAttribute("tabindex","0"):this.vn.removeAttribute("tabindex");if(!this.vMh){const c=I.a.instance.ga(81)?Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage:re.a.kXi();this.Eqd=re.a.cEf(this.Ot,this.vn,a,c);this.oHe(b,c,null)}}}oZk(){r.a.rj?Sys.UI.DomElement.addCssClass(this.vn,"InternetExplorer"):
r.a.ag?Sys.UI.DomElement.addCssClass(this.vn,"FireFox"):r.a.zsa&&Sys.UI.DomElement.addCssClass(this.vn,"Safari");r.a.Ji?Sys.UI.DomElement.addCssClass(this.vn,"iPad"):Sys.UI.DomElement.addCssClass(this.vn,"usehover")}Hpl(){this.aya&&(this.aya.Gpl(this,this.hH),this.aya=null)}onBlur(a){this.aya.SAg(a);this.aya.oHf(a)}zak(){this.Ot.style.width="0px";this.Ot.style.height="0px"}$se(a){a=a.htmlElement;this.Ot.parentNode!==a.parentNode&&a.parentNode&&a.parentNode.insertBefore(this.Ot,a)}dnl(a){if(a&&"DIV"===
a.tagName){var b=a.childNodes;for(let c=0;c<b.length;c++)if("TBODY"===b[c].tagName||"TR"===b[c].tagName){for(b=a.ownerDocument.createElement("TABLE");a.hasChildNodes();)b.appendChild(a.firstChild);ya.a.$za(a);a.appendChild(b);break}}}}Object(e.a)(Id,"ContentEditableDiv",null,[1444,109]);class We{create(a,b,c){return new Id(a,b,c)}}Object(e.a)(We,"ContentEditableDomFactory",null,[1419]);var Wc=d(75);class Xc{constructor(a,b){this.qd=a;Xc.mb=b}ARc(a){return Sys.UI.DomElement.containsCssClass(a,"PageBreakBlob")}mIi(a,
b){a=ya.a.Ou(a);const c=Ja.a.EDa(a,b-1);return(b=a.substr(c+1,b-c-1))&&(Ja.a.C7(b)||Ja.a.h3b(b))?!0:!1}mYd(a,b,c){try{if(3===a.nodeType)return a.nodeValue}catch(l){return b.Vb("FailedToRetrieveText",{["Reason"]:"GetTextCrashed"}),c.o++,""}if("IMG"===a.tagName)return Oa.ukg;if("BR"===a.tagName)return Oa.zHf;if(this.Xsg(a)&&(u.AFrameworkApplication.oN("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),Xc.mb.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return"";
let f="";for(let l=0;l<a.childNodes.length;l++)f+=this.mYd(a.childNodes[l],b,c);return f}Wdg(a,b,c,f){try{if(3===a.nodeType){var l=a.nodeValue;l=a.nodeValue;return l.length}}catch(w){return Z.ULS.sendTraceTag(51463192,324,15,w.message),c.Vb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionRecursiveBadNode"}),b.bs++,-1}if(Xc.tSc(a))return this.U3i(a);if(Sys.UI.DomElement.containsCssClass(a,"LineBreakBlob"))return 1;l=0;"IMG"===a.tagName&&(l=f?l+1:l+3);if(this.Xsg(a)&&(u.AFrameworkApplication.oN("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),
Xc.mb.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return 0;this.ARc(a)&&(l+=Oa.BGc+Oa.yRd);for(let w=0;w<a.childNodes.length;w++){const F=this.Wdg(a.childNodes[w],b,c,f);if(0<=F)l+=F;else return a.innerText.length}return l}Xsg(a){return void 0===a.parentNode||null===a.parentNode?!1:Sys.UI.DomElement.containsCssClass(a.parentNode,"WACImageContainer")&&"SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,"WACAltTextDescribedBy")}dMj(a){return Sys.UI.DomElement.containsCssClass(a,
nc.a.ugl)}U3i(a){return(a=a.querySelector(".RawEquation"))?parseInt(a.getAttribute("data-length")):Wc.AParagraphNode.VY.length}VH(a,b,c,f){try{if(3===a.nodeType){let l=a.nodeValue;l=a.nodeValue;return l.length}}catch(l){return c.Vb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionBadNode"}),b.br++,0}return this.Wdg(a,b,c,f)}G6f(a,b,c,f,l){let w=0;const F=a.Es;for(let S=0;S<F.length;S++){a=F[S];const fa=this.VH(a,f,c,l);if(b<w+fa)return b-=w,c=a.innerText,b>=c.length?0:Ja.a.charCodeAt(c,
b);w+=fa}f.bt++;return 0}q_d(a,b,c,f,l,w){if(void 0===a||null===a)return l.Vb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullElement"}),f.bi++,Z.ULS.sendTraceTag(51463193,324,15,"NoOffsetFromNullElement when trying to get position"),0;if(!b)return Z.ULS.sendTraceTag(18437279,324,15,"GetParagraphCpFromElementOffset found null ParagraphElement when trying to get position"),0;let F=0;if(3===a.nodeType)F=c;else for(var S=0;S<c;S++)F+=this.VH(a.childNodes[S],f,l,w);for(;a!==b;){S=a;a=a.parentNode;
if(!a){Z.ULS.sendTraceTag(51463195,324,15,"GetParagraphCpFromElementOffset found null parent when trying to get position");l.Vb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullParent"});f.bj++;if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordInvalidCaretPositionFixSettings"),u.AFrameworkApplication.fa.ka("InvalidCaretPositionFixIsEnabled")))return 0;break}this.ARc(S)&&(F+=Oa.BGc);let fa=0;for(;fa<a.childNodes.length&&a.childNodes[fa]!==S;)F+=
this.VH(a.childNodes[fa],f,l,w),fa++;if(fa===a.childNodes.length)if(3===S.nodeType)F=c;else return l.Vb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromSelectionNotInDom"}),f.bk++,Z.ULS.sendTraceTag(51463196,324,15,"The current selection is in a non-text node that is not in the editing view's DOM."),0}return F}Qrg(a){return ya.a.RXb(a)}static get instance(){Xc.Ka||(Xc.Ka=new Xc(Ta.a.instance,u.AFrameworkApplication.fa));return Xc.Ka}static tSc(a){return Sys.UI.DomElement.containsCssClass(a,nc.a.O9j)||
Sys.UI.DomElement.containsCssClass(a,nc.a.ZKi)||Sys.UI.DomElement.containsCssClass(a,nc.a.OHi)}}Xc.Ka=null;Xc.mb=null;Object(e.a)(Xc,"ContentEditableViewDomUtils",null,[1406]);class Ld{constructor(a,b){this.ptd=null;this.nd=a;this.wk=b}hld(){return 1<this.i0i()||this.Yhg(this.ptd,this.q8f())}Zhc(){const a=this.q8f();this.ptd=a?a.cloneNode(!0):null}i0i(){if(this.nd){const a=this.nd.Ql();if(a&&a.childNodes)return a.childNodes.length}return 0}q8f(){if(this.nd){const a=this.nd.Ql();if(a)return a.firstChild}return null}Yhg(a,
b){if(!a&&!b)return!1;if(!a||!b)return!0;try{return this.uoj(a,b)}catch(c){return Z.ULS.sendTraceTag(17134560,324,15,"HasDifferentHtmlStructure ex: {0}",c),!0}}uoj(a,b){if(Ja.a.vg(a.nodeName)!==Ja.a.vg(b.nodeName))return!0;if(a.childNodes.length!==b.childNodes.length&&(!r.a.ag||a.childNodes.length!==b.childNodes.length-1||"BR"!==Ja.a.vC(b.childNodes[b.childNodes.length-1].nodeName))){var c=!a.childNodes.length||3===a.childNodes[0].nodeType;for(var f=0;c&&f<b.childNodes.length;f++)c=3===b.childNodes[f].nodeType&&
c;if(c)return!1;c=b.childNodes.length;for(f=0;f<b.childNodes.length;f++)3!==b.childNodes[f].nodeType||b.childNodes[f].nodeValue.length||c--;return c!==a.childNodes.length}for(c=0;c<a.childNodes.length;c++)if((!Xc.tSc(a.childNodes[c])||!Xc.tSc(b.childNodes[c]))&&this.Yhg(a.childNodes[c],b.childNodes[c]))return!0;return!1}PQi(a,b){if(r.a.dI&&I.a.instance.ga(98)){b.Vb("PossiblyIncorrectTypedText",{["Reason"]:"FixEOPSpanforAndroidChrome"});b=ya.a.rba(this.ptd,"EOP");const c=ya.a.rba(a.firstChild,"EOP");
b&&!c&&a.firstChild&&a.firstChild.appendChild(b.cloneNode(!0))}}}Object(e.a)(Ld,"ContentEditableHtmlStructureUtils",null,[]);class Xf{constructor(){this.gPh=u.AFrameworkApplication.fa.ka("MoveToIpModeInReadOnlyView")}get mode(){return u.AFrameworkApplication.Va.mode}get o5c(){return this.gPh}get Lnh(){return this.o5c?!0:1!==u.AFrameworkApplication.Va.mode||gb.App.Oub&&u.AFrameworkApplication.wS}get iXh(){switch(this.mode){case 3:return Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage;
case 2:return Box4Intl.Box4Strings.l_ReviewingSurfaceScreenReaderTitleMessage}return Box4Intl.Box4Strings.l_ReadingSurfaceScreenReaderTitleMessage}get h7d(){return this.o5c?1===u.AFrameworkApplication.Va.mode||gb.App.Oub&&u.AFrameworkApplication.wS:gb.App.Oub&&u.AFrameworkApplication.wS?!(gb.App.hUb||gb.App.h4b):1===u.AFrameworkApplication.Va.mode}get Vgd(){return this.o5c?1===u.AFrameworkApplication.Va.mode||gb.App.Oub&&u.AFrameworkApplication.wS:gb.App.Oub&&u.AFrameworkApplication.wS}}Object(e.a)(Xf,
"ContentEditableModeHelper",null,[1320]);var Le=d(176),md=d(33);class oj{static Jti(a){const b={};for(let c of a)a=0,c in b&&(a=b[c]),b[c]=a+1;return md.c(b)}}Object(e.a)(oj,"CommonActivityAggregationMethods",null,[]);var Ie=d(981),qh=d(993),Od=d(563),ef=d(284),dh=d(264),ad=d(91);class Fg{constructor(){this.tJd=this.SAg=this.oHf=this.YGc=this.dea=this.Rre=this.gcb=this.mFb=this.hXa=this.WGd=this.TPe=this.UPe=this.CB=this.C4a=this.ZC=this.AXb=this.RNd=this.XPd=this.exe=this.DXb=this.VAa=this.WAa=this.Lgb=
this.pVb=this.gNd=this.qVb=this.X8a=this.BDa=this.xz=null;this.E5=this.aod=this.crd=this.WAd=this.Otd=this.nDd=this.Upd=!1}xKi(a,b){if(!this.E5){this.E5=!0;var c=Od.a.instance,f=b.EF,l=b.RQ,w=b.Rgb,F=b.Ux,S=ef.a.instance,fa=b.Hea,xa=dh.a.instance,Za=b.Ejd,pb=b.Bjd;r.a.Ji&&(oc.EventHandlerManager.instance.kJk(this.WGd),this.aod=!0);b.Aga(this.dea);this.rIk(a.vn,f,l,F,w,xa,fa,S,c,Za,pb)}}Gpl(a,b){if(this.E5){var c=Od.a.instance,f=b.EF,l=b.RQ,w=b.Rgb,F=b.Ux,S=ef.a.instance,fa=b.Hea,xa=dh.a.instance,
Za=b.Ejd,pb=b.Bjd;this.aod&&(oc.EventHandlerManager.instance.Kpl(this.WGd),this.aod=!1);b.IWa(this.dea);this.Dpl(a.vn,f,l,F,w,xa,fa,S,c,Za,pb);this.E5=!1}}rIk(a,b,c,f,l,w,F,S,fa,xa,Za){b.gp(a);c.gp(a);f.gp(a);l.gp(a);w.gp(a);ad.a.addHandler(a,ra.a.paste,this.exe);ad.a.addHandler(a,ra.a.cut,this.XPd);ad.a.addHandler(a,ra.a.copy,this.RNd);!Fg.OJj&&r.a.ag&&(ad.a.addHandler(a,ra.a.TRd,this.AXb),this.crd=!0);ad.a.addHandler(a,ra.a.blur,this.tJd);f.pb(ra.a.click,a,this.ZC);2===gb.App.mode?F.TI(a,this.YGc,
!0):F.TI(a,this.YGc);S.pb(a,this.CB);l.pb(ra.a.d5,a,this.UPe);l.pb(ra.a.o0,a,this.TPe);c.pb(ra.a.mouseDown,a,this.gcb,null);c.pb(ra.a.OW,a,this.Rre,null);b.pb(ra.a.ol,a,this.BDa);b.pb(ra.a.zx,a,this.X8a);b.pb(ra.a.Rf,a,this.xz);b.pb(ra.a.bNa,a,this.xz);f.pb(ra.a.doubleClick,a,this.C4a);ad.a.addHandler(a,ra.a.scroll,this.hXa);if(r.a.BNe||r.a.ag)Za.pb(ra.a.OOf,a,this.qVb,this),Za.pb(ra.a.fNd,a,this.gNd,this),Za.pb(ra.a.dNd,a,this.pVb,this),this.Upd=!0;gb.App.CJd&&r.a.Fsh||r.a.Xn?(xa.pb(ra.a.input,a,
this.Lgb,this),this.Otd=!0):r.a.FNe&&(xa.pb(ra.a.UOe,a,this.Lgb,this),this.nDd=!0);fa.pb(ra.a.drop,a,this.WAa);r.a.qsa&&(fa.pb(ra.a.D4a,a,this.VAa),fa.pb(ra.a.qXf,a,this.DXb),this.WAd=!0);fa.pb(ra.a.lFb,a,this.mFb)}Dpl(a,b,c,f,l,w,F,S,fa,xa,Za){ad.a.removeHandler(a,ra.a.paste,this.exe);ad.a.removeHandler(a,ra.a.cut,this.XPd);ad.a.removeHandler(a,ra.a.copy,this.RNd);this.crd&&(ad.a.removeHandler(a,ra.a.TRd,this.AXb),this.crd=!1);ad.a.removeHandler(a,ra.a.blur,this.tJd);f.zb(ra.a.click,a,this.ZC);F.cE(a,
this.YGc);S.zb(a,this.CB);l.zb(ra.a.d5,a,this.UPe);l.zb(ra.a.o0,a,this.TPe);c.zb(ra.a.mouseDown,a,this.gcb);c.zb(ra.a.OW,a,this.Rre);b.zq(a);c.zq(a);f.zq(a);l.zq(a);w.zq(a);b.zb(ra.a.ol,a,this.BDa);b.zb(ra.a.zx,a,this.X8a);b.zb(ra.a.Rf,a,this.xz);b.zb(ra.a.bNa,a,this.xz);f.zb(ra.a.doubleClick,a,this.C4a);ad.a.removeHandler(a,ra.a.scroll,this.hXa);this.Upd&&(Za.zb(ra.a.OOf,a,this.qVb),Za.zb(ra.a.fNd,a,this.gNd),Za.zb(ra.a.dNd,a,this.pVb),this.Upd=!1);this.nDd&&(xa.zb(ra.a.UOe,a,this.Lgb),this.nDd=
!1);this.Otd&&(xa.zb(ra.a.input,a,this.Lgb),this.Otd=!1);fa.zb(ra.a.drop,a,this.WAa);this.WAd&&(fa.zb(ra.a.D4a,a,this.VAa),fa.zb(ra.a.qXf,a,this.DXb),this.WAd=!1);fa.zb(ra.a.lFb,a,this.mFb)}static get OJj(){null==Fg.cvd&&(Fg.cvd=u.AFrameworkApplication.fa.ka("RemoveDomSubtreeModifiedEventHandlerIsEnabled"));return Fg.cvd}}Fg.cvd=null;Object(e.a)(Fg,"ContentEditableSurfaceEventHandlers",null,[]);var Cd=d(59),zg=d(117),Eh=d(813),eh=d(135),Gg=d(272);class vh extends qh.a{constructor(a,b,c,f,l,w,F,S,
fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig,Ff,nh,Jg,$h,Li,Aj,Zi,Ui){super(Zi);this.yvc=null;this.kHc=this.Tqb=this.TWb=this.HT=!1;this.Jf=a;this.Rc=b;this.xk=c;this.Ys=F.create(this);this.Nib=Ig;this.nd=S;this.Jna=Ui;w.ya(D.a.zVf,Db.a.application,Le.ActionManager.Dg);w.ya(D.a.AVf,Db.a.application,Le.ActionManager.Dg);f.execute(Bi=>{Bi.zBi(D.a.typing,Dh.a.f3g);Bi.qHe(D.a.typing,Dh.a.source,oj.Jti)});l&&l.execute(Bi=>{Bi.PAl(Object(C.a)(this,this.hva,"onZoomChanged"))});this.Xo=xa;this.Qna=
Dc;this.vBd=Mb;this.yJ=Za;this.NJ=hc;this.NJ.init(this.Na);this.X0=kc;this.kf=Ec;this.wk=pb;this.Mb=fa;this.Mb.init(this.Na);this.uh=Td;this.S0a=we;this.es=Hc;this.HLa=Pd;this.jH=Df;this.Cr=He;this.qB=ig;this.PKa=Pe;this.BU=Tg;this.VHh=Ff;this.WHh=nh;this.oJh=Jg;this.UHh=$h;this.Gfa=Li;this.THh=Aj;this.Gfa.Z1h(Object(C.a)(this,this.XVg,"onBindEditingDom"));this.Gfa.r2h(Object(C.a)(this,this.e0g,"onUnbindEditingDom"));this.Gfa.H1h(Object(C.a)(this,this.P6g,"pushViewElementValidationStates"));this.Gfa.G1h(Object(C.a)(this,
this.ZXg,"onInteractiveViewOnAfterLoadContent"));this.pXe=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ChromiumEdgeUIPasteForPPTIsEnabled")&&r.a.cRc;this.f0e=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")&&r.a.sS}get Ed(){return this.Gf.Ed}dispose(){this.Gfa.NMk(Object(C.a)(this,this.XVg,"onBindEditingDom"));this.Gfa.ZMk(Object(C.a)(this,this.e0g,"onUnbindEditingDom"));this.Gfa.FMk(Object(C.a)(this,this.P6g,"pushViewElementValidationStates"));
this.Gfa.EMk(Object(C.a)(this,this.ZXg,"onInteractiveViewOnAfterLoadContent"));this.UHh.dispose();super.dispose()}hva(){this.rea=!0}get ownerDocument(){const a=this.nd.MBa();return a?a.yl:null}get container(){return this.BOa}get wNd(){return this.vn}createElement(a){a=this.ownerDocument.createElement(a);this.nd.xg.eDh.appendChild(a);return a}Lo(a){a=Nb.a.createElement(this.ownerDocument,a);this.nd.xg.eDh.appendChild(a);return a}Sza(){throw Error.notImplemented("BindToContainer doesnt mean anything for ContentEditableView yet--we shouldn't be calling it!");
}Nte(){this.Xo.raiseEvent(Af.a.SHi);this.kHc=!0}get BOa(){return this.nd.xg?this.nd.xg.Ot:null}get vn(){return this.nd.Ql()}get mub(){return!0}Hli(){this.X0.YCc()}get mTc(){return this.Cr.tDa}get isComposing(){return this.Cr.isComposing}Wwk(){this.pXe||this.f0e?this.HLa.c5g(!0,""):(this.disable(!1,24),this.qfd(!0),r.a.Fw&&(this.BOa.style.overflow="hidden"),this.BOa.style.width="0px",this.BOa.style.height="0px",this.BOa.style.display="block",this.Xo.raiseEvent(Af.a.jrk),this.X0.YCc(),this.NJ.PHa(this.uh.mode,
this.Mb.Ci,this.Mb.Bg,this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy))}Yhl(){this.pXe||this.f0e?this.HLa.Feh("none"):r.a.Fw&&this.BOa&&(this.BOa.style.overflow="none")}ds(a,b=!1){this.jH.ds(a,b)}EX(){this.es.EX()}get Al(){return!0}exa(a,b){if(1===this.mode&&17!==a.ri){const c=a.currentNode;if(!dd.a.instance.Pa.uG&&!c.Jub(dd.a.instance.Pa.qr)&&6!==a.role)return!1}return super.exa(a,b)}get cI(){let a=super.cI;switch(this.mode){case 2:a|=450;break;case 1:a|=448;break;case 0:a|=511}return a}get ypb(){const a=
u.AFrameworkApplication.fa.ka("EditingViewDelayUpdateFixIsEnabled");return a&&!this.mTc?2:this.root&&this.ownerDocument&&this.isActive&&!this.Qna.K7?a||this.mTc?1:2:3}f4(a){return this.WHh.f4(a)}v9(a){return this.VHh.v9(a)}uPd(){return new Eh.a(this.Na)}Ste(a){!u.AFrameworkApplication.Xg&&0!==this.mode&&this.Gf&&this.Gf.Oo&&(this.aUj(a),this.Rc.G6d())}aUj(a){if(a){var b=a.nA;a=this.B5f(a.qu,!0);b=this.B5f(b,!1);Z.ULS.sendTraceTag(38396191,324,50,"Parent : [{0}] Child : [{1}]",a,b)}}B5f(a,b){let c=
"";a&&(a=a.node)&&(c+="nodeId : "+a.id+"; type : "+a.type+"; ",db.ParagraphReader.Pd(a)&&(c+="paraId : "+db.ParagraphReader.D_b(a)+"; ",c+="hasImage : "+zg.a(a,5)+";"),b&&(b=mb.GraphIterator.nb(a),b.af(),c+="inTable : "+Cd.TableReader.Nr(b)+";"));return c}cve(a){!u.AFrameworkApplication.Xg&&1===this.mode&&a&1&&this.Gf&&this.Gf.Oo&&this.Rc.Mve()}qfd(a){this.nd.wXa(a)}b9a(a,b,c){this.Nib.b9a(a,b,c)}IHc(){this.PKa.IHc()}C2k(){this.vBd.t0f(dd.a.instance.Pa)}Peb(){this.NJ.Peb(this.mode,this.Mb.Ci,this.Mb.Bg,
this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy)}PHa(){this.NJ.PHa(this.mode,this.Mb.Ci,this.Mb.Bg,this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy)}get Bg(){return this.isActive?this.Mb.Bg:null}get mode(){return this.uh.mode}get isActive(){return this.kf.isActive}get kRa(){return this.kf.s_b(this.Mb.Bg)}get s$d(){return this.kf.e$f(this.Mb.Bg)}get Gf(){return this.Jf.Jd}get xwe(){return this.S0a.KPf}get swa(){return this.PKa.swa}set swa(a){this.PKa.swa=a}get rea(){return this.es.rea}set rea(a){this.es.rea=
a}get c8d(){return!0}get QDe(){return 2}get Vgd(){const a=this.xk.value.isEditingAllowed||this.xk.value.uy;return this.Jna.Vgd?a:!0}get SGa(){return this.HLa.SGa}get apb(){return this.wk}get Jol(){return this.qB}get Nri(){return this.Nib}get Fsj(){return this.PKa}get bpk(){return this.BU}v5b(a){return Gg.a.lzg(a,this)}uEb(a){return Gg.a.Gch(a,this)}Phc(a){return Gg.a.Uch(a,this)}vbc(a){return Gg.a.DRg(a,this)}eob(a){return Gg.a.dKf(a,this)}Sic(a){return Gg.a.Nhh(a,this)}hZb(a){return Gg.a.p3f(a,this)}pTb(a){return Gg.a.AGf(a,
this)}aDj(){switch(this.mode){case 2:if(this.Mb.Bg)return this.bDj(this.Mb.Bg)}return!1}bDj(a){a=eh.a.nb(this.Na,a.node);return a.xq&&a.af()?a.cOa.x_(510&~this.cI):!0}XVg(a,b){this.eHf(b.xg)}e0g(){this.nd.Uol()}dvj(a,b,c,f){a=this.THh.create(a,b,this.Jna);b=new Fg;b.YGc=c;this.oJh.ytk(b);a.initialize(b,f);return a}eHf(a){this.nd.sai(a,this)}disable(a,b){this.uh.S9(0,a,b)}wYa(){this.uh.wYa()}suspend(){this.Qna.suspend()}resume(){this.Qna.resume()}P6g(a,b){this.Jf.Jd===b.Gf&&(this.yvc=this.xJa,this.xJa=
new Ie.a(0))}ptk(){const a=this.yvc,b=this.xJa;for(let c=0;c<b.keys.length;++c){const f=b.keys.ga(c);let l;a.$(l=f,a.ga(l)|b.ga(f))}this.xJa=a;this.yvc=null}$Mf(){this.yvc=null}FKe(a){return 1!==this.mode||a.Px||this.Gf.Eb.Pa.uG?!1:!0}pae(a,b){return this.Gf.Eb&&!this.Gf.Eb.Pa.uG&&b?a.Px!==b.O$d:!0}ZXg(a,b){this.Jf.Jd===b.Gf?this.ptk():this.Jf.Jd||this.$Mf()}}Object(e.a)(vh,"ContentEditableView",qh.a,[177,169,109,1418]);class ze{constructor(a,b,c,f,l,w){this.ld=a;this.Uf=b;this.Zi=c;this.Do=f;this.Jf=
l;this.Tq=w}arg(a){return Sys.UI.DomElement.containsCssClass(a,nc.a.wPf)}}Object(e.a)(ze,"ContentEditableViewContentControlHelper",null,[1319]);var sg=d(388),zd=d(127),Hd=d(116),Fh=d(814);class Gh{constructor(a,b,c,f,l){this.nVb=!1;this.Awe=this.O8c=-1;this.CE=a;this.x6d=b;this.kBc=c;this.lQa=f;this.WVa=l}}Object(e.a)(Gh,"ActiveContentSpan",null,[]);class ih{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe){this.tfa=this.ILb=null;this.N7=!1;this.evf=0;this.qqd=Pd;this.Jf=a;
this.ld=b;this.Uf=c;this.Zi=f;this.Rc=l;this.ef=w;this.BJ=F;this.uh=S;this.Mb=fa;this.xk=xa;this.wna=Za;this.kf=pb;this.Md=Mb;this.qd=hc;this.Ni=kc;this.Do=Ec;this.Ch=Hc;this.yJ=Dc;this.nd=Td;this.DC=we;this.fA=Pe}get oba(){return this.tfa||(this.tfa=lb.a.instance.qb("Box4.IFormatPainter"))}tai(a){this.ILb=a}get qrh(){return this.evf}eBi(a,b,c){const f=this.Jf.Jd;if(!f)return!1;f.Lue();if(2!==this.uh.mode)return this.ld.Vb("PossibleFocusWeirdness",{["Reason"]:"ClickOnHiddenEditingFrame"}),this.Uf.be++,
!1;if(this.Zi&&b)return this.ld.Vb("DisallowedClickDuringDictation",{["Reason"]:"CursorPositioningClick"}),this.Uf.bf++,!0;if(3!==a.Qf&&a.Sz===Sys.UI.MouseButton.rightButton&&this.qd.ag)return gb.App.Fb.e$.zQi(a.nc.rawEvent),!0;if(!f)return!1;b=f.Qha(a);if(3===a.Qf){var l=this.Rc.Pa.kb;if(this.ef.Ew(l)){var w=l.Wa.node.yg(f.Na);l=this.fA?this.fA.INa(l.Wa,!0):l.Wa.Qa;w=N.a.FY(l,w,!!l,!1,!1);w=new Sys.UI.Bounds(w.x-7,w.y,14,w.height);if(sg.a.M9c(b,w))return gb.App.Fb.K4(b,3),!0}}if(!c)return!0;this.Ni.pUf(this.uh,
this.Mb);v.FocusManager.ZL()&&(v.FocusManager.instance().vf(f.NH),this.yJ.setFocus(this.uh.mode,this.Mb.Ci,this.Mb.Bg,this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy));(c=lf.a(a.Hc))?(this.ILb.ds(!0),f.f5(a.clientPoint,c,c.gb,f,a.nc.rawEvent.shiftKey,a.LY,a.Qf)):f.f5(b,null,null,f,a.shiftKey,a.LY,a.Qf);this.oba&&this.oba.wK&&this.wna.processAction(D.a.Lha,2);this.ILb.b9a(a.shiftKey,b,a.Qf);f.jue(new Fh.a(a));this.qd.dI&&(a=new Se.a(0,1,0,()=>{this.kf.bIa(!0);this.fixupAfterCursor(5)},
27),this.Md.Hb(a));return!0}XNe(a,b=!1){if(2===this.uh.mode&&this.Mb.Ph){var c=this.nd.xg.Ot;if("0px"!==c.style.height&&"0px"!==c.style.width||!this.qd.l$d){c=this.Rc.Pa.kb;var f=!!this.BJ&&this.BJ.t7a();this.Zi&&a?(this.ld.Vb("MomentaryIncorrectIpPosition",{["Reason"]:"NoSynchronizeCursorDuringDictation"}),this.Uf.bm++):(this.SZk(b||f,this.Mb.Ph.Es,this.Rc.Pa.kb.Wa),f&&this.BJ.oOe(c))}}}SZk(a,b,c){let f=0,l=0;c=c.Qa;let w=!1;for(let F=0;F<b.length;F++){const S=b[F],fa=this.Do.VH(S,this.Uf,this.ld,
this.Zi);if(Sys.UI.DomElement.containsCssClass(S,ca.a.QU))f+=fa;else if(w||(this.evf=f,w=!0),Sys.UI.DomElement.containsCssClass(S,nc.a.AM))c--,f+=fa,l++;else{if(c<=fa){a||this.Ni.bS(f+c,this.Mb.Ph);this.bfd(b,F,f,l,c);break}c-=fa;f+=fa;l+=fa}}}fixupAfterCursor(){if(2===this.uh.mode){var a=this.Ni.V6(this.uh.mode,this.Mb.Ci),b=0,c=0,f=this.Mb.Ph.Es,l;for(l=0;l<f.length;l++){const w=this.Do.VH(f[l],this.Uf,this.ld,this.Zi);let F,S,fa;({E2:F,Kia:fa,Xtb:S}=this.cji(f,l));if(a<=w&&this.cRi(f,l,a,F,fa,
b,c,S))return;a-=w;b+=w;F?c++:S||(c+=w)}this.ld.Vb("ActiveContentSpansOutOfSync",{["Reason"]:"FixupAfterCursorFailed"});this.Uf.bq++}}cRi(a,b,c,f,l,w,F,S){const fa=a[b],xa=this.Do.VH(fa,this.Uf,this.ld,this.Zi);if(f||this.Zi&&l)if(l||!this.N7&&c!==xa){if(this.Uf.bo++,this.Ni.bS(w,this.Mb.Ph),c=this.Do.VH(a[b-1],this.Uf,this.ld,this.Zi),this.bfd(a,b-1,w-c,F-c,c),l)return!0}else this.Uf.bn++,this.Ni.bS(w+xa,this.Mb.Ph),this.bfd(a,b+1,w+xa,F+1,0);else if(!S)return Ja.a.Hw(ya.a.Ou(fa),c)&&(this.Uf.bp++,
this.Ni.bS(w+c+(this.N7?1:-1),this.Mb.Ph)),this.bfd(a,b,w,F,c),!0;return!1}cji(a,b){let c,f;c=Sys.UI.DomElement.containsCssClass(a[b],nc.a.AM);f=Sys.UI.DomElement.containsCssClass(a[b],ca.a.QU);a=Sys.UI.DomElement.containsCssClass(a[b],nc.a.RM);return{E2:c,Kia:a,Xtb:f}}bfd(a,b,c,f,l){const w=this.Mb.fV,F=a[b];Sys.UI.DomElement.containsCssClass(F,nc.a.RM)&&(Z.ULS.shipAssertTag(4318915,315,!1),this.ld.Vb(zd.a.v0,{["Reason"]:Hd.a.d_f}));Sys.UI.DomElement.containsCssClass(F,nc.a.AM)&&(Z.ULS.shipAssertTag(4318916,
315,!1),this.ld.Vb(zd.a.v0,{["Reason"]:Hd.a.iHf}));a=this.dxi(a,b,c,f,l,w);b=a.length!==this.Ch.yi.length;for(c=0;!b&&c<this.Ch.yi.length;)this.Ch.yi[c].CE!==a[c].CE&&(b=!0),this.Ch.yi[c].WVa!==a[c].WVa&&(b=!0),c++;b&&(this.ILb.kRa&&this.ILb.ds(!0),this.Ch.yi=a)}dxi(a,b,c,f,l,w){const F=a[b];var S=this.Do.VH(F,this.Uf,this.ld,this.Zi);const fa=[];let xa=null;b<a.length-1&&l===S&&(xa=a[b+1]);var Za=null;0<b&&!l&&(Za=a[b-1]);a=this.qqd.te(F,ca.a.FDa);a=w.Es[a];Array.add(fa,new Gh(F,a,c,f,S-(this.DC.T5?
1:0)));!xa||Sys.UI.DomElement.containsCssClass(xa,nc.a.RM)||Sys.UI.DomElement.containsCssClass(xa,nc.a.AM)?!Za||Sys.UI.DomElement.containsCssClass(Za,nc.a.RM)||Sys.UI.DomElement.containsCssClass(Za,nc.a.AM)||Sys.UI.DomElement.containsCssClass(Za,ca.a.QU)||(a=this.qqd.te(Za,ca.a.FDa),a=w.Es[a],S=this.Do.VH(Za,this.Uf,this.ld,this.Zi),Array.insert(fa,0,new Gh(Za,a,c-S,f-S,S))):(a=this.qqd.te(xa,ca.a.FDa),a=w.Es[a],Za=this.Do.VH(xa,this.Uf,this.ld,this.Zi),Array.add(fa,new Gh(xa,a,c+S,f+S,Za)));return fa}}
Object(e.a)(ih,"ContentEditableViewCursorManager",null,[1417]);class ah{}Object(e.a)(ah,"ContentEditableViewDebugLogger",null,[]);class Fi{constructor(a,b,c,f,l,w,F){this.roa=a;this.qB=b;this.Ch=c;this.Rqc=f;this.Uf=l;this.D$=w;this.uh=F}dispose(){this.roa.LMf();this.qB.dispose();this.Ch.xMf();this.Rqc.Oed();cg.a.instance.cTj(this.Uf);this.D$.raiseEvent(Qf.a.uUj);this.uh.dispose()}}Object(e.a)(Fi,"ContentEditableViewDisposer",null,[]);class Wi{constructor(){this.xGc=!0}b9a(a,b,c){a&&(this.xGc=!1,
gb.App.Fb.K4(b,c))}}Object(e.a)(Wi,"ContentEditableViewFloatieHandler",null,[1414]);var Mg=d(1068),ee=d(142);class Lf{constructor(a,b,c,f,l,w,F){this.nbf=0;this.nSc=this.g2b=this.O4d=this.S4d=!1;this.nd=a;this.Jf=b;this.BJ=c;this.Zi=f;this.mn=l;this.Sod=w;this.Kd=F}Nai(){this.Zi&&!this.g2b&&100<(new Date).getTime()-this.nbf&&(ee.GrippersManager.instance.E1b=!0,this.nSc=!1)}setFocus(a,b,c,f,l){const w=this.Jf.Jd;this.nbf=(new Date).getTime();this.BJ&&this.BJ.t7a()||(1===a?this.H_k(l):this.Zi&&!this.mn.U4d&&
oc.EventHandlerManager.instance.o_f!==ra.a.click||!this.nd.xg.Mfb||(l=new Mg.a(w),this.nd.xg.Ckd(),this.Zi&&(this.g2b=!0,this.nd.Ql().blur(),this.g2b=!1),this.nd.xg.Mwh(),c&&f&&""!==b.innerText&&b.focus(),this.Sod.G7&&(this.nSc=!0),l&&l.dispose(),this.Sod.rj&&0!==a&&(this.nd.xg.Mfb=!1)))}H_k(a){if(!this.Zi||a){a=null;r.a.rj&&(a=new Mg.a(this.Jf.Jd));this.nd.xg.Mfb&&(this.nd.xg.Ckd(),this.nd.xg.Mwh(),r.a.rj&&(this.nd.xg.Mfb=!1),this.Sod.G7&&this.mn.U4d&&(this.nSc=!0));var b=this.nd.Ql();this.nd.xg.Mfb&&
b.firstChild&&3!==b.firstChild.nodeType&&b.firstChild.focus();a&&a.dispose()}}LJi(a){2!==a&&1!==a||this.nd.xg.Ckd()}z8d(){const a=this.Kd.ye;return!!a&&this.Jf.Jd.NH===a.name}}Object(e.a)(Lf,"ContentEditableViewFocusHelper",null,[1415]);class Vf{constructor(a,b,c){this.Q1b=a;this.Bdb=b;this.Jpa=c}}Object(e.a)(Vf,"GraphUpdateState",null,[]);var fd=d(50),Ee=d(121);class Yf{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig,Ff,nh,Jg,$h){this.Qe=this.pLb=null;this.kk=
Jg;this.Tq=nh;this.nfa=a;this.uh=b;this.ld=c;this.Rc=f;this.BJ=l;this.ef=w;this.kf=F;this.EJ=S;this.Mb=fa;this.wk=xa;this.DC=Za;this.Ch=pb;this.nd=Mb;this.kU=hc;this.bR=kc;this.Qna=Ec;this.bY=Hc;this.dga=Td;this.Ni=we;this.S0a=Pd;this.es=He;this.Uf=Pe;this.F5=Df;this.Md=ig;this.qd=Tg;this.Efa=Ig;this.oFh=Ff;this.Vg=Dc;this.gz=$h}KR(a){this.Qe=a}get YNc(){const a=this.bY.hra(this.kU.N7);return a?a.Wa.Qa:0}get ubi(){return this.YNc}ds(a,b=!1){Z.ULS.shipAssertTag(18437283,315,!!this.Vg);if(this.Qe.kRa||
this.Qe.s$d)if(this.Qe.Jol.typingProcess(),this.Qe.isActive&&2===this.uh.mode&&(this.Qe.kRa||this.Qe.s$d)){var c=this.ld.zp(D.a.ds);this.nfa.sF(()=>{this.Mrl(a,b)},"ContentEditableView:UpdateGraphInternal");c.end()}}T_k(a,b=!1){const c=this.ef.Uy;this.Rc.setSelection(a,void 0,void 0,b);this.ef.Uy=c}Mrl(a,b=!1){Ee.c(36226527,306,100,"UpdateGraphInternalCalled");this.kf.UQk();if(this.Mb.Ph){a=new Vf(!1,a,!1);a.Bdb&&this.Qna.suspend();this.dga.fixupAfterMagnifierDrag();var c=this.EJ.MPa();c.set(this.Mb.Bg.node);
var f=this.kk.ie(b?12:15,D.a.ds);f.fd=this.wk.A1?D.a.Rza:D.a.typing;f.Ry(c);this.DC.z7k(a.Bdb,this.Qe.mTc,this.Ch)&&(this.Uf.v++,this.DC.ofb(!1,this.Mb.Ci,this.Ch));var l=!!this.BJ&&this.BJ.t7a(),w=l?dd.a.instance.Pa.kb:this.Mki();this.psk(a);this.Isl();this.rerenderWhenNeeded(b,a,c);l||this.nRi(b,w);this.Ch.xMf();f.dispose();this.tgl(a);this.es.rea&&(this.es.EX(),this.es.rea=!1);a.Bdb&&this.Qna.resume();this.wk.w4();Ee.c(18437313,306,100,"UpdateGraphInternalExited")}else Z.ULS.shipAssertTag(17884510,
315,!1,"CurrentEditingViewElement is NULL. Bail out updateGraph early!")}tgl(a){a.Q1b||this.kU.XNe(this.wk.Vba,a.Jpa)}rerenderWhenNeeded(a,b,c){!b.Q1b||this.wk.bxg()||a||(this.uh.S9(0,!0,5),b.Bdb&&(this.Qna.resume(),b.Bdb=!1),this.H2b(c.currentNode))}Mki(){this.Ni.updateCaretPosition(this.uh.mode,this.Mb.Ci);this.S0a.BSe();this.bR.PQi(this.nd.Ql(),this.ld);return this.bY.hra(this.kU.N7)}nRi(a,b){const c=this.Tq.textLength(b.Wa.node);b.Wa.Qa>c&&(b=fd.SelectionFactory.Lg(b.Wa.node,c));this.T_k(b,a);
a=!!this.BJ&&this.BJ.iub(b);this.wk.bxg()&&!a&&this.Ni.bS(this.Ni.fSa,this.Mb.Ph)}H2b(a){I.a.instance.ga(70)&&gb.App.SQ.H2b(a)}Isl(){if(I.a.instance.ga(2)){const a=lc.OutlineElementNavigator.uA(this.Qe.Bg);a&&yc.ListReader.vRa(a)}}zQd(){if(this.Qe.kRa||this.Qe.s$d)this.pLb?this.Md.v4(this.pLb,Yf.qUf):(this.pLb=new Se.a(0,1,Yf.qUf,Object(C.a)(this,this.delayUpdateGraphCallback,"delayUpdateGraphCallback"),26),this.Md.Hb(this.pLb))}delayUpdateGraphCallback(){this.pLb=null;this.Mb.bSa(this.uh.mode)&&
this.ds(!0)}aMk(){let a;if(this.wk.A1){var b=this.YNc;a=this.wk.uEc}else if(this.wk.lqa)b=this.YNc,a=b+(this.wk.yjd-ya.a.Ou(this.Mb.ZNa).length);else return;if(b===a)this.ld.Vb("PossibleDropACharDeletion",{["Reason"]:"LostBrowserSelection"});else{Z.ULS.shipAssertTag(18437315,315,b<=a);var c=this.Tq.text(this.Qe.Bg),f="";this.Tq.CPa(this.Qe.Bg,a);if(!b&&a<c.length&&" "===c.charAt(a)||0<b&&a<c.length&&" "===c.charAt(b-1)&&" "===c.charAt(a))a+=1,f+=Oa.rCb;this.Dli(this.Qe.Bg);b=Fc.a.createTextRange(this.Qe.Bg,
b,a);this.Vg.replaceTextRange(b,f,void 0,void 0,D.a.dJd)}}Dli(a){I.a.instance.ga(70)&&this.gz.VCc(a)}psk(a){let b=!0;if(this.F5.zkg)this.F5.ZIi();else{const c=1<this.nd.Ql().childNodes.length;a.Q1b=this.bR.hld();if(a.Q1b||this.wk.lqa||this.wk.A1){a.Q1b&&this.Uf.w++;c&&(this.ld.Vb("PossibleValidTextDropped",{["Reason"]:"ExtraParagraphsFound"}),this.Uf.x++,b=!1);if(this.wk.A1||this.wk.lqa)this.aMk(),this.bR.Zhc(),b=!1;a.Bdb&&(this.ld.Vb("PossibleImeAutoDetermine",{["Reason"]:"StopPreseveringBrowserState"}),
this.Uf.z++,this.Qna.resume(),a.Bdb=!1);this.Ch.Lki(this.Mb.Ph)}}a.Jpa=!0;b&&(a.Jpa=this.oFh.osk(this.Mb.Bg,this.Mb.Ci,this.Mb.Ph,this.Vg,this.Efa.instance))}}Yf.qUf=250;Object(e.a)(Yf,"ContentEditableViewGraphUpdater",null,[]);class ij{constructor(){this.H8k=this.Bsg=!1;this.q2g=null}}Object(e.a)(ij,"OnPastedFloatieStatusChangeEventArgs",null,[]);var Md=d(56);class pj{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig,Ff){this.Qe=null;this.qyg=0;this.xcf=!1;this.Ta=
a;this.uh=b;this.Mb=c;this.Jf=f;this.nd=l;this.jfa=w;this.es=F;this.DC=fa;this.qd=xa;this.Uf=Za;this.Tq=pb;this.Ch=Mb;this.bR=hc;this.oDd=kc;this.roa=Ec;this.yJ=Hc;this.S0a=Dc;this.Rc=Td;this.Zi=we;this.NJ=Pd;this.xk=He;this.wk=Pe;this.Xo=Df;this.EJ=ig;this.mMa=Tg;this.uoa=Ig;this.$c=Ff}KR(a){this.Qe=a}Iek(a){this.Ta.raiseEvent(zc.eventId,new zc(a.YL,this.Qe.HT),this.Qe);if(1===this.uh.mode)return this.Jek(a);if(0===this.uh.mode||!this.rrl(a))return!1;this.DC.MMf();if(this.qrl())return!0;this.jRi();
this.roa.Crh(this.Mb.Ph);this.hRi();!this.xcf&&this.Mb.Ph&&0<this.Mb.Ph.Qid&&(this.xcf=!0,u.AFrameworkApplication.oN("Microsoft.Office.Web.SessionSettings.IWacWordEditorInlineTabsSettings"));this.$c&&this.$c.isFeatureEnabled(84)&&this.Nch(this.Mb.Ph);this.S0a.BSe();this.uoa.BBe(Object.assign(new ij,{H8k:!0}));this.$c&&this.$c.isFeatureEnabled(84)||this.Nch(this.Mb.Ph);return!0}Nch(a){a&&a.Qid&&(this.mMa?this.mMa.XAl(a,!0):Z.ULS.sendTraceTag(23708818,323,10,"TabRenderer is null."))}rrl(a){if(!this.Mb.Bg)return!1;
this.Mb.Ph=this.Mb.Bg.pc(this.Qe.Na);this.Mb.Ph||Z.ULS.sendTraceTag(18437322,324,15,"current editing view element is set to null!");this.Mb.fV=this.Mb.Bg.pc(this.Jf.Jd.Na);if(!this.Mb.fV)return!1;this.nd.xg.$se(this.Mb.fV);const b=this.nd.Ql(),c=this.Mb.ZNa;(b?b.firstChild:null)!==c&&c&&(ya.a.Vt(b),b.appendChild(c));if(!a.YL&&!this.Qe.kHc){this.Qe.HT&&this.jfa.XNe(this.wk.Vba);this.Qe.HT=!1;if(this.es.rea||!a.LGa)this.es.EX(),this.es.rea=!1;return!1}this.Qe.kHc&&(this.Qe.kHc=!1,this.Qe.Tqb=!0);return!0}hRi(){this.es.EX();
if(this.Qe.Tqb){this.yJ.setFocus(this.uh.mode,this.Mb.Ci,this.Mb.Bg,this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy);if(this.qd.ag){const a=this.nd.Ql(),b=a?a.firstChild:null;b&&3===b.nodeType&&(this.Uf.bv++,a.removeChild(b))}this.Qe.Tqb=!1}this.jfa.XNe(this.wk.Vba)}jRi(){if(this.qd.ag){var a=this.nd.Ql();const b=a?a.firstChild:null;b&&"BR"===b.tagName&&(this.Uf.bu++,a.removeChild(b))}this.qd.AHb||(a=this.EJ.Jc(this.Mb.Bg),this.Tq.isEmpty(a)&&!this.Tq.i8d(a)&&this.DC.ofb(!0,this.Mb.Ci,
this.Ch));this.oDd.value.dVb(this.nd.Ql(),this.nd.contentWindow);this.bR.Zhc()}qrl(){var a=this.Mb.fV;const b=this.nd.Ql().style;if(this.Qe.Tqb){if(!a)return!0;a=this.Mb.Ph.htmlElement;this.es.koh()&&(b.position="absolute",b.width="100%");a.style.width="auto";a.style.height="auto"}this.Mb.Xaa=this.KHj();return!1}KHj(){return Md.OutlineElementReader.Vl(lc.OutlineElementNavigator.uA(this.Mb.Bg.node))}Nu(a){return $g.a.Nu(a)}Jek(a){if(!this.Rc.Pa||!this.Rc.Pa.kb)return Z.ULS.sendTraceTag(19711041,324,
15,"Attempt to validate selection with empty selection."),!1;if(!this.Qe.HT&&(!a.YL||gb.App.c7d&&a.LGa))return this.es.rea&&(this.es.ith(this.Qe.Na),this.es.rea=!1),!1;this.Qe.HT=!1;a=(new Date).getTime();const b=this.Rc.ana;!this.Zi&&!b.x9d&&!b.iae&&250<a-this.qyg?this.mUf(null):(this.Xo.raiseEvent(Af.a.Sck),b.c1k(Object(C.a)(this,this.mUf,"delayOnAfterValidateSelection")));return!0}mUf(){1===this.uh.mode&&(this.Rc.Pa.cca&&this.Mb.Bg&&(this.Mb.Ph=this.Mb.Bg.pc(this.Qe.Na),this.Mb.Ph||Z.ULS.sendTraceTag(18437327,
324,15,"current editing view element is set to null!"),this.Mb.fV=this.Mb.Bg.pc(this.Jf.Jd.Na)),this.Rc.Pa.cca&&this.nd.Ql().firstChild!==this.Mb.ZNa&&this.Mb.ZNa&&(ya.a.Vt(this.nd.Ql()),this.nd.Ql().appendChild(this.Mb.ZNa)),this.nd.Ql().firstChild&&(this.Rc.Pa.cca?this.nd.Ql().style.direction=this.Nu(this.nd.Ql().firstChild).direction:Sys.UI.DomElement.containsCssClass(this.nd.Ql().firstChild,"Rtl")?this.nd.Ql().style.direction="rtl":this.nd.Ql().style.direction="ltr",this.Rc.Pa.cca&&this.roa.Crh(this.Mb.Ph),
this.es.ith(this.Qe.Na),this.NJ.Peb(this.uh.mode,this.Mb.Ci,this.Mb.Bg,this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy)),this.qyg=(new Date).getTime(),this.Xo.raiseEvent(Af.a.xQi))}v9(a){const b=this.Iek(a);this.Xo.raiseEvent(!a.YL||gb.App.c7d&&a.LGa?Af.a.$zc:Af.a.P1g);return b}}Object(e.a)(pj,"ContentEditableViewOnAfterValidateHandler",null,[]);class qj{constructor(a,b,c,f,l){this.Qe=null;this.es=a;this.Cr=c;this.nd=f;this.Xo=l}KR(a){this.Qe=a}f4(a){const b=this.Qe.ypb;let c=3===b;c||
2!==b||(this.Qe.root.A4d(510),c=!0,this.es.EX());if(c)return a.cancel=!0,!1;this.Xo.IBk(a);return!1}}Object(e.a)(qj,"ContentEditableViewOnBeforeValidateHandler",null,[]);class jj{constructor(a,b,c,f,l){this.T5=!1;this.Bya=null;this.Xo=a;this.ld=b;this.Uf=c;this.nd=f;this.Rqf=l}MMf(){this.T5=!1}ofb(a,b,c){const f=this.nd.MBa();a&&(this.T5=ya.a.Ou(b)!==ca.a.zHc);if(a&&!this.T5){for(b=this.nd.Ql();b.firstChild;)b=b.firstChild,this.Rqf&&Sys.UI.DomElement.containsCssClass(b,nc.a.UIa)&&Sys.UI.DomElement.addCssClass(b,
nc.a.Ewe);3!==b.nodeType?(this.Bya=f.yl.createTextNode(Oa.rCb),b.appendChild(this.Bya)):(this.Bya=b,this.Bya.nodeValue=Oa.rCb);this.T5=!0;this.Xo.H8g(!0)}if(!a&&this.T5){a=this.Bya;b=null;try{b=this.Bya.parentNode,b||""!==a.nodeValue||(this.Bya=null)}catch(l){this.Uf.i++,this.Bya=null}this.Bya&&b!==f||(this.ld.Vb("PossibleExtraSpace",{["Reason"]:"LostPadding"}),this.Uf.j++,c.yi.length&&(a=this.i2f(c.yi[c.yi.length-1].CE)));if(a&&(a.nodeValue.endsWith(" ")||a.nodeValue.endsWith(Oa.rCb))){if(this.Rqf)for(c=
a;(c=c.parentNode)&&c.tagName&&"P"!==c.tagName.toUpperCase();)if(Sys.UI.DomElement.containsCssClass(c,nc.a.Ewe)){Sys.UI.DomElement.removeCssClass(c,nc.a.Ewe);break}c=a.nodeValue;a.nodeValue=c.substring(0,c.length-1)}this.T5=!1;this.Xo.H8g(!1)}}z7k(a,b,c){return!this.T5||a||(r.a.nD&&!r.a.Gj||r.a.XE)&&!b?!1:c.Azf()}i2f(a){if(a.className===nc.a.RM)return null;var b=a.childNodes?a.childNodes.length:0;if(b)for(--b;0<=b;--b){const c=this.i2f(a.childNodes[b]);if(c)return c}else if("#text"===a.nodeName&&
(b=a.nodeValue,b.endsWith(" ")||b.endsWith(Oa.rCb)))return a;return null}}Object(e.a)(jj,"ContentEditableViewPaddingManager",null,[1413]);class Ag{constructor(a){this.EQd=this.VOe=this.lqa=this.A1=!1;this.QUc=this.yjd=this.uEc=-1;this.jud=!1;this.Uae=0;this.wna=a}get Vba(){return this.jud}set Vba(a){a!==this.jud&&this.wna.processAction(a?D.a.zVf:D.a.AVf,2);this.jud=a}bxg(){return this.VOe||this.lqa||this.A1}w4(){this.EQd=this.VOe=this.lqa=this.A1=!1;this.QUc=this.yjd=this.uEc=-1}}Object(e.a)(Ag,"ContentEditableViewTypingState",
null,[]);class mf{constructor(a,b,c,f,l,w,F){this.Ni=a;this.Uf=b;this.ld=c;this.Do=f;this.kf=l;this.Mb=w;this.Zi=F}hra(a){if(!this.Mb.Ph||1===this.kf.mode&&!this.cca())return null;const b=this.Ni.V6(this.kf.mode,this.Mb.Ci);let c=b,f=0;const l=this.Mb.Ph.Es;let w,F=!1;for(w=0;w<l.length;w++){var S=l[w];if(!this.Do.Qrg(S)){F=!0;continue}const fa=this.Do.VH(S,this.Uf,this.ld,this.Zi),xa=Sys.UI.DomElement.containsCssClass(S,nc.a.AM);S=Sys.UI.DomElement.containsCssClass(S,ca.a.QU);if(c<=fa)return xa?
c=a||c===fa?1:0:S&&(c=0),this.Lg(this.Mb.Bg,f,c);c-=fa;xa?f++:S||(f+=fa)}return F?this.Lg(this.Mb.Bg,0,b):this.Lg(this.Mb.Bg,0,0)}Lg(a,b,c){return fd.SelectionFactory.Lg(a,b+c)}cca(){return dd.a.instance.Pa.cca}}Object(e.a)(mf,"CurrentEditSelectionProvider",null,[1412]);class Ia{constructor(a,b,c){this.UJb=[];this.Jyc=null;this.ld=a;this.yR=b;this.oDd=c}get yi(){return this.UJb}set yi(a){this.UJb=a}Azf(){return this.UJb.length?1<this.UJb.length||1<this.UJb[0].CE.innerText.length:!1}k3f(a,b,c){const f=
K.a.te(a,ca.a.FDa),l=b?a.firstChild:a.lastChild;let w=null;b&&0<f?w=c.Es[f-1]:!b&&f<c.Es.length&&(w=c.Es[f+1]);if(w)for(this.ld.Vb("MomentaryNonLinkFormatting",{["Reason"]:"MoveSafariStrayTextNode"}),this.yR.u++,a.removeChild(l),b?w.appendChild(l):w.insertBefore(l,w.firstChild),a=0;a<this.yi.length;a++);}Lki(a){for(let b=0;b<this.yi.length;b++){const c=this.yi[b].CE;r.a.nD&&0<c.getElementsByTagName("A").length&&(3===c.firstChild.nodeType?this.k3f(c,!0,a):3===c.lastChild.nodeType&&this.k3f(c,!1,a));
ya.a.Zw(c,c.innerText)}}Hck(a){for(let b=0;b<this.yi.length;b++)this.oDd.dVb(this.yi[b].CE,a)}OKk(){for(let a=0;a<this.yi.length;++a){const b=this.yi[a].CE;if(Sys.UI.DomElement.containsCssClass(b,nc.a.qFc)||Sys.UI.DomElement.containsCssClass(b,nc.a.oFc)||Sys.UI.DomElement.containsCssClass(b,nc.a.nFc)||Sys.UI.DomElement.containsCssClass(b,nc.a.pFc)){const c=this.yi[a].WVa;c&&c!==b.innerText.length&&(b.className=nc.a.wWb)}}}l9j(a,b){for(let c=0;c<this.yi.length;c++){const f=this.yi[c],l=a<=f.lQa,w=
f.lQa+f.WVa,F=w<=b;f.O8c=l?f.lQa:a;f.Awe=F?w:b;l&&F&&(f.nVb=!0)}}xMf(){Array.clear(this.yi)}}Object(e.a)(Ia,"CurrentlyActiveContentSpans",null,[1410]);class tb{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td){this.sqd=!1;this.ef=a;this.Rc=b;this.ld=c;this.kf=f;this.Xo=l;this.Jf=w;this.Ch=F;this.Mb=S;this.qd=fa;this.NJ=xa;this.xk=Za;this.Lxa=pb;this.yKb=Mb;this.IIh=hc;this.jk=kc;this.nd=Ec;this.Da=Dc;this.Yc=Td;this.rMh=Hc.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.xNb=Hc.ka("PasteKeepSourceFontSizeFixIsEnabled");
this.Esc=(this.aqf=Hc.ka("ProtectInClient"))||Hc.ka("ProtectedFile");this.BMh=Hc.ka("EnableExtractForProtectedFile");this.gNh=Hc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1);this.bNb=Hc?Hc.ka("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.KNb=Hc?Hc.ka("TextLayoutServiceUseResponse"):!1;this.Srf=this.Rrf=!1}get IY(){return this.Lxa.instance}get P8a(){return this.Yc.Zf&&this.Yc.fy}fgg(a,b,c,f){this.Nwk(a,b,c,f)}Nwk(a,b,c,f){if(this.gNh){if(this.Esc&&!this.BMh){a.preventDefault();
return}}else if(this.aqf){a.preventDefault();return}!b||this.xk.value.isEditingAllowed||this.xk.value.uy&&this.P8a?1!==this.kf.mode||this.sqd||!c||f||(this.IY?b&&!this.ef.sRc(this.Rc.Dj)?(Z.ULS.sendTraceTag(3994324,307,50,"Cut not allowed"),this.ld.Vb(zd.a.qh,{["Reason"]:Hd.a.YPd}),this.yKb.show(),a.preventDefault()):(this.Rc.ana.dWd(),this.sqd=!0,b&&this.Xo.raiseEvent(Af.a.kBi),r.a.psa&&a.rawEvent&&a.rawEvent.currentTarget&&(u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings"),
this.bNb&&this.jk.Scd(a.rawEvent.currentTarget,"data-src","data-srcurl")),this.qd.Gj&&this.rMh&&this.YQi(a),this.xNb&&(this.Rrf=this.TQi(a)),this.KNb&&(this.Srf=this.xLk(a)),a=this.IIh.create(null,Object(C.a)(this,this.kFi,"dispatchCutCopy"),b),a.vl("Browser "+(b?"Cut":"Copied")),a.run()):(Z.ULS.sendTraceTag(3994323,307,50,"Clipboard command not available"),this.Da.uce(b?D.a.cut:D.a.copy),a.preventDefault())):a.preventDefault()}YQi(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=
null;c=this.XWi();({AFc:c}=this.jk.Lml(c));c&&(a.preventDefault(),b.setData("text/html",Ea.c(c)),b.setData("text/plain",c.innerText))}}TQi(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();if(c&&0<c.length)return a=this.jk.YVa(c),this.jk.rUb(a,this.Jf.Jd.Ed,!0)?(b.setData("text/html",a.innerHTML),!0):!1}return this.jk.rUb(a.rawEvent.currentTarget,this.Jf.Jd.Ed,!0)}xLk(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=
b.getData("text/html").toString();a=c&&0<c.length?this.jk.YVa(c):a.rawEvent.currentTarget;if(this.jk.Cld(a,!1))return b.setData("text/html",Ea.c(a)),b.setData("text/plain",a.innerText),!0}return!1}XWi(){if(this.qd.XT){const a=this.nd.MBa();if(a&&a.yl)return a.yl.getSelection()}return null}kFi(a,b){this.sqd=!1;if(this.Jf.Jd.Oo&&1!==u.AFrameworkApplication.Ba.state){if(b){if(this.qd.ag){for(b=0;b<this.Ch.yi.length;b++){const c=this.Ch.yi[b].CE,f=c.getElementsByTagName("BR");for(let l=0;l<f.length;l++)c.removeChild(f[l])}this.NJ.PHa(this.kf.mode,
this.Mb.Ci,this.Mb.Bg,this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy)}this.IY.vbi(a)}else this.IY.tbi(a);r.a.psa&&this.bNb&&this.Jf&&this.jk.Scd(this.Jf.Jd.xg.vn,"data-srcurl","data-src");this.xNb&&this.Rrf&&this.Jf&&this.Jf.Jd&&this.jk.rUb(this.Jf.Jd.xg.vn,this.Jf.Jd.Ed,!1);this.KNb&&this.Srf&&this.Jf&&this.Jf.Jd&&this.jk.Cld(this.Jf.Jd.xg.vn,!0)}}}Object(e.a)(tb,"CutCopyHandler",null,[1411]);class Qb{constructor(a,b,c,f,l,w,F,S){this.qd=a;this.uh=b;this.Cr=c;this.ld=f;this.kf=l;this.Hfa=
w;this.es=F;this.Clb=S}AXb(a,b){this.qd.ag&&2===this.uh.mode&&b&&this.Cr.isComposing&&(a=this.ld.zp(D.a.typing),a.properties.$(Dh.a.source,"DomChange"),this.KGi(),a.end())}KGi(){this.Clb||this.kf.U9(!0);this.Hfa.OAb();this.es.EX()}}Object(e.a)(Qb,"DomChangeEventProcessor",null,[]);class qc{constructor(a,b,c,f){this.Ni=a;this.uh=b;this.Mb=c;this.Jf=f}Fcb(a,b){if(!b)return!1;this.Ni.pUf(this.uh,this.Mb);return this.Jf.Jd?this.Jf.Jd.Fcb(a):!1}}Object(e.a)(qc,"DoubleClickProcessor",null,[]);class Lc{constructor(a,
b,c){this.qd=a;this.njb=b;this.rrd=c}VAa(){this.njb.f4a=!0;return!1}DXb(){return this.njb.f4a=!1}WAa(a){this.njb.f4a=!1;this.rrd.cancelEventAndRestoreEditingSurface(a.nc);return!0}}Object(e.a)(Lc,"DragEventsProcessor",null,[]);class Jd{constructor(a){this.T_e=0;this.nqd=!1;this.qd=a}get f4a(){return this.nqd}set f4a(a){this.nqd=a;window.clearTimeout(this.T_e);this.nqd&&(this.T_e=window.setTimeout(Object(C.a)(this,this.xek,"onAfterDragInactivity"),1E3))}xek(){this.f4a=!1}}Object(e.a)(Jd,"DragStateManager",
null,[]);class le extends jb{constructor(){super();this.zTg=this.gek=0}}Object(e.a)(le,"SetModeEditEventArgs",jb,[]);class je extends jb{constructor(){super();this.updates=null;this.jxa=new Ua.a}}Object(e.a)(je,"BeforeValidateEditEventArgs",jb,[]);class Gf{constructor(){this.RWk=this.LGi=null}}Object(e.a)(Gf,"EditStateFactoryManager",null,[]);class Wf extends jb{constructor(){super();this.charCode=0;this.UGj=this.isComposing=!1}}Object(e.a)(Wf,"KeyDownEditEventArgs",jb,[]);class fh extends jb{constructor(){super();
this.charCode=0;this.isComposing=!1}}Object(e.a)(fh,"KeyPressEditEventArgs",jb,[]);class zh extends jb{constructor(){super();this.Woj=!1}}Object(e.a)(zh,"PaddingChangedEventArgs",jb,[]);class Qg{constructor(a){this.Ta=new sd.a;this.s_a=Object.assign(new Gf,{LGi:()=>a.Ql(),RWk:()=>id.a.JBa(a.contentWindow)})}addHandler(a,b){this.Ta.addHandler(a,b)}removeHandler(a,b){this.Ta.removeHandler(a,b)}raiseEvent(a){this.Ta.raiseEvent(a,Object.assign(new jb,{F4a:this.s_a}))}uDk(a,b){0===a&&0===b||this.Ta.raiseEvent(Af.a.S0k,
Object.assign(new le,{gek:a,zTg:b,F4a:this.s_a}))}IBk(a){this.Ta.raiseEvent(Af.a.V$h,Object.assign(new je,{F4a:this.s_a,updates:a.updates,jxa:a.jxa}))}I8g(a){a.F4a=this.s_a;this.Ta.raiseEvent(Af.a.P1g,a)}ABe(a,b){this.Ta.raiseEvent(Af.a.zx,Object.assign(new fh,{charCode:a.nc.charCode,isComposing:b,F4a:this.s_a}))}yCk(a,b,c){this.Ta.raiseEvent(Af.a.Rf,Object.assign(new Wf,{charCode:a.nc.charCode,isComposing:b,UGj:c,F4a:this.s_a}))}H8g(a){this.Ta.raiseEvent(Af.a.dpk,Object.assign(new zh,{F4a:this.s_a,
Woj:a}))}}Object(e.a)(Qg,"EditStateEventManager",null,[1409]);class Rg{constructor(a){this.jvd=this.osc=!1;this.Lbf=null;this.mYe=0;this.yPc=!1;this.Ta=a;this.b0e=0;this.mwd=2}get mode(){return this.b0e}gfb(a,b){0===a?(0===b&&(b=1),this.Lbf=(new Date).toISOString(),this.mwd=b):this.mwd=0;this.b0e=a}get PUc(){return this.mwd}get xPj(){return this.Lbf}get isActive(){return 0!==this.mode}get Ori(){return this.mYe}bIa(a){this.jvd=a}s_b(a){return this.isActive&&!!a&&this.osc}U9(a){!this.osc&&a&&this.Ta.raiseEvent(Ic.Lri);
this.osc=a;this.tdk(a);a&&(this.mYe=(new Date).getTime())}e$f(a){return this.isActive&&!!a&&this.jvd}tdk(a){a&&ee.GrippersManager.instance.setVisibility(!1)}UQk(){this.jvd=this.osc=!1}}Object(e.a)(Rg,"EditViewStateManager",null,[1408]);var wi=d(886);class Ng{constructor(a,b,c,f,l,w){this.nd=a;this.DC=b;this.Xo=c;this.NJ=f;this.mb=l;this.Jf=w;this.mb&&(this.mb.ka("WordEditorImageOverflowIsEnabled")||this.mb.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&(Ng.eHc=-1*Math.pow(2,31))}YCc(){this.DC.MMf();
ya.a.Vt(this.nd.Ql())}bTd(a){const b=this.nd.Ql();if(2===a){var c=Oa.RHi;a=Ng.QHi;b.style.overflow="visible"}else if(1===a)c=r.a.Ueb?0:Ng.eHc,a="0",b.style.overflow="hidden";else return;const f=this.nd.xg.Ot;f.style.position="absolute";this.mb&&(this.mb.ka("WordEditorImageOverflowIsEnabled")||this.mb.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&0<c?(c=document.createElement("div"),f.style.zIndex=String(c.style.zIndex)):f.style.zIndex=String(c);f.style.display="block";f.style.visibility=
"visible";f.style.maxHeight="none";f.style.maxWidth="";b.style.visibility="visible";f.style.opacity=a}xZf(a){if(this.nd&&this.nd.xg&&this.nd.xg.Ot){var b=this.nd.xg.Ot;b.style.zIndex=String(r.a.Ueb?0:Ng.eHc);r.a.Ueb&&!a&&(b.style.visibility="hidden",this.nd.Ql().style.visibility="hidden")}}Twk(a){this.Xo.raiseEvent(Af.a.izj);this.YCc();this.nd.wXa(!0);this.nd.Ql().style.direction="";this.bTd(a);this.nd.xg.zak()}Pwk(a){this.nd.wXa(!0);this.bTd(a);r.a.Ueb&&this.ijg();r.a.XE&&Sys.UI.DomElement.addCssClass(this.nd.Ql(),
"NonStandardIEClipboard")}Swk(a){this.bTd(a);r.a.XE&&Sys.UI.DomElement.removeCssClass(this.nd.Ql(),"NonStandardIEClipboard")}Rwk(a,b,c,f,l,w,F){this.Xo.raiseEvent(Af.a.endEditing);const S=this.nd.Ql();S&&(ya.a.Vt(S),r.a.IV&&b&&a&&(this.nd.wXa(!0),S.innerText=" ",this.NJ.PHa(c,f,l,w,F)),a||id.a.UMf(S),this.nd.wXa(!1),this.xZf(b))}Qwk(a){this.nd.wXa(!1);r.a.XE&&Sys.UI.DomElement.removeCssClass(this.nd.Ql(),"NonStandardIEClipboard");this.xZf(a);this.Xo.raiseEvent(Af.a.hmi)}Uwk(){const a=Sys.UI.DomElement.getBounds(this.Jf.Jd.$I),
b=this.nd.xg.Ot;Sys.UI.DomElement.getBounds(b).y<a.y&&(b.style.top=Math.max(this.Jf.Jd.scrollTop,wi.a)+"px");b.style.opacity="0";b.style.zIndex=String(Ng.eHc);r.a.rj&&(b.style.visibility="Hidden",this.nd.Ql().style.visibility="Hidden")}ijg(){const a=1E3-this.Jf.Jd.container.getBoundingClientRect().left+this.Jf.Jd.scrollLeft+1,b=this.nd.xg.Ot;b.style.left="-11000px";b.style.paddingRight=a+"px";b.style.width=1E4+a+"px"}}Ng.eHc=-1E3;Ng.QHi="1";Object(e.a)(Ng,"EditingDomDisplayManipulator",null,[]);class Fj{constructor(a){this.GRh=
a}get range(){return this.GRh}select(){this.range.select()}execCommand(a,b,c){return this.range.execCommand(a,b,c)}queryCommandEnabled(a){return this.range.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.range.queryCommandIndeterm(a)}queryCommandState(a){return this.range.queryCommandState(a)}queryCommandSupported(a){return this.range.queryCommandSupported(a)}queryCommandValue(a){return this.range.queryCommandValue(a)}scrollIntoView(a){this.range.scrollIntoView(a)}}Object(e.a)(Fj,"RangeProxy",
null,[1502]);class Hh{constructor(a){this.q1a=a}get selection(){return this.q1a}get type(){return this.selection.type}createRange(){return new Fj(this.selection.createRange())}clear(){this.selection.clear()}empty(){this.selection.empty()}}Object(e.a)(Hh,"SelectionProxy",null,[1493]);class gg{constructor(a){this.dJh=a}get yl(){return this.dJh}get body(){return this.yl.body}get activeElement(){return this.yl.activeElement}get documentElement(){return this.yl.documentElement}get document(){return this.yl.cookie}get selection(){return new Hh(this.yl.selection)}get designMode(){return this.yl.designMode}get doctype(){return this.yl.doctype}get domain(){return this.yl.domain}get hidden(){return this.yl.hidden}get implementation(){return this.yl.implementation}get parentWindow(){return this.yl.parentWindow}get referrer(){return this.yl.referrer}get title(){return this.yl.title}get URL(){return this.yl.URL}get visibilityState(){return this.yl.visibilityState}createAttribute(a){return this.yl.createAttribute(a)}open(){this.yl.open()}close(){this.yl.close()}attachEvent(a,
b){return this.yl.attachEvent(a,b)}detachEvent(a,b){this.yl.detachEvent(a,b)}createAttributeNS(a,b){return this.yl.createAttributeNS(a,b)}createDocumentFragment(){return this.yl.createDocumentFragment()}createElement(a){return this.yl.createElement(a)}createElementNS(a,b){return this.yl.createElementNS(a,b)}createEvent(a){return this.yl.createEvent(a)}createTextNode(a){return this.yl.createTextNode(a)}dispatchEvent(a){return this.yl.dispatchEvent(a)}execCommand(a,b,c){return this.yl.execCommand(a,
b,c)}hasFocus(){return this.yl.hasFocus()}focus(){this.yl.focus()}getElementById(a){return this.yl.getElementById(a)}getElementsByTagName(a){return this.yl.getElementsByTagName(a)}getElementsByTagNameNS(a,b){return this.yl.getElementsByTagNameNS(a,b)}getElementsByName(a){return this.yl.getElementsByName(a)}write(a){this.yl.write(a)}querySelector(a){return this.yl.querySelector(a)}querySelectorAll(a){return this.yl.querySelectorAll(a)}queryCommandEnabled(a){return this.yl.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.yl.queryCommandIndeterm(a)}queryCommandState(a){return this.yl.queryCommandState(a)}queryCommandSupported(a){return this.yl.queryCommandSupported(a)}queryCommandValue(a){return this.yl.queryCommandValue(a)}}
Object(e.a)(gg,"DOMDocumentProxy",null,[1536]);class Og{constructor(){this.u_a=null}get isValid(){return this.xg.isValid}get contentWindow(){return this.xg?this.xg.contentWindow:null}get xg(){return this.u_a}Zgk(a){Gg.a.LQg(a,this.xg.Ot)}Ygk(){Gg.a.ERe(this.xg.Ot)}DZf(){this.xg.FJi()}z7i(a){if(!r.a.ag)return a.innerHTML;this.xg.dnl(a);return a.innerHTML}Uol(){this.xg?(this.Ygk(),this.u_a=null):Z.ULS.sendTraceTag(18437346,323,15,"UnbindFromEditingDom: View not currently bound to Dom.")}sai(a,b){this.u_a=
a;this.Zgk(b)}Ql(){return this.xg?this.xg.vn:null}wXa(a){this.xg&&this.xg.qfd(a)}MBa(){return this.xg?new gg(this.xg.contentDocument):null}}Object(e.a)(Og,"EditingDomManager",null,[1407]);var vg=d(144);class Sg{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td){this.fga=0;this.Qe=null;this.Mb=a;this.kk=b;this.X0=c;this.Xo=f;this.Qna=l;this.Md=w;this.nd=F;this.kf=S;this.yJ=fa;this.xk=xa;this.qd=Za;this.DC=pb;this.Rc=Mb;this.BJ=hc;this.Ch=kc;this.Jf=Ec;this.ef=Hc;this.Yc=Td;this.Gfa=Dc;this.Gfa.y4h(Object(C.a)(this,
this.J_g,"onSynchronizeMode"))}dispose(){this.Gfa.sOk(Object(C.a)(this,this.J_g,"onSynchronizeMode"))}BTb(a){(this.Qe=a)||Z.ULS.sendTraceTag(22122889,323,50,"Bind ContentEditableView resolve failed as null.")}get mode(){return this.kf.mode}endClipboard(){if(1===this.mode){var a=this.kk.ie(2);a.hd(this.Qe.root);this.Qe.detach();this.Mb.Bg&&!this.i7d&&this.Mb.Bg.Rba(this.Jf.Jd.Na,4,!0);this.kf.gfb(0,3);this.Mb.Bg=null;this.Mb.Ph=null;this.Mb.fV=null;this.X0.Qwk(this.Qe.SGa);a.dispose()}}S9(a,b,c){this.Qe.kRa&&
this.Mb.Ph?this.Qe.ds(!1):this.Qe.kRa&&!this.Mb.Ph&&Z.ULS.shipAssertTag(17884511,315,!1,"Content is dirty when CurrentEditingViewElement is still NULL");this.Xo.uDk(this.mode,a);let f=!0;switch(a){case 2:this.endClipboard();this.kf.gfb(a,c);f=this.startEditing(this.dBi);break;case 1:if(this.mode!==a||this.Rc.Pa.qr!==this.fga)this.endEditing(!0),this.kf.gfb(a,c),f=this.Rdl(),this.fga=this.Rc.Pa.qr;break;case 0:this.mode!==a&&(2===this.mode&&ee.GrippersManager.instance.setVisibility(!1),this.endEditing(b),
this.endClipboard(),this.kf.gfb(a,c))}f||this.kf.gfb(0,7)}d_k(){this.kf.gfb(2,0)}get dBi(){return this.Rc.Pa.kb.Wa.node}startEditing(a){if(1===this.Bzf)return!1;this.nd.DZf();this.Qe.swa?this.Qe.ds(!0):(this.Qe.Fsj.FZf(!1),this.kf.s_b(this.Mb.Bg)&&this.Qe.ds(!1));this.Qe.swa=!1;if(this.Mb.Bg===a)return a=mb.GraphIterator.nb(a.node),this.iTd(a),this.Mb.wpj&&(this.qd.Ji&&this.Qe.apb.Vba||this.yJ.setFocus(this.mode,this.Mb.Ci,this.Mb.Bg,this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy)),!0;
const b=this.kk.ie(2,D.a.startEditing);b.hd(a.node);this.Qe.detach();this.Mb.Bg&&this.Mb.Bg.Rba(this.Jf.Jd.Na,4,!0);this.Mb.Bg=a;this.Mb.Bg.Rba(this.Jf.Jd.Na,4,!0);if(this.Yc.Zf){const c=zg.j(this.Mb.Bg,5);for(let f=0;f<c.length;f++)c[f].BWf(this.Qe)}this.Qe.Tqb=!0;this.X0.Twk(this.mode);this.Qe.kA(a.node);this.DC.ofb(!1,this.Mb.Ci,this.Ch);this.kf.U9(!1);this.kf.bIa(!1);a=mb.GraphIterator.nb(this.Mb.Bg.node);this.iTd(a);b.dispose();return!0}endEditing(a){if(2===this.mode&&(this.Qe.IHc(),this.Qe.ds(!0),
!this.i7d)){var b=this.kk.ie(2);b.hd(this.Qe.root);this.Qe.detach();this.Mb.Bg&&this.Jf.Jd&&this.Mb.Bg.Rba(this.Jf.Jd.Na,20,!0);this.kf.gfb(0,4);this.Mb.Bg=null;this.Mb.Ph=null;this.Mb.fV=null;this.X0.Rwk(a,this.Qe.SGa,this.mode,this.Mb.Ci,this.Mb.Bg,this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy);b.dispose()}}Rdl(){if(this.i7d||I.a.instance.ga(11)&&1===this.Bzf)return!1;this.Xo.raiseEvent(Af.a.gmi);this.nd.DZf();const a=this.kk.ie(2);a.hd(this.Rc.Qgb);this.kf.s_b(this.Mb.Bg)&&this.Qe.ds(!1);
this.Qe.detach();this.Mb.Bg=null;this.Mb.Ph=null;this.Mb.fV=null;if(this.Rc.Pa.cca){const b=this.Rc.Pa.kb.Wa.node;this.Qe.kA(b);const c=mb.GraphIterator.nb(b);this.Mb.Bg=b;this.Mb.Xaa=this.SBj(b);this.iTd(c);this.Mb.Bg.Rba(this.Jf.Jd.Na,4,!0)}else this.Qe.kA(this.Rc.Qgb);this.X0.Pwk(this.mode);this.DC.ofb(!1,this.Mb.Ci,this.Ch);a.dispose();return!0}J_g(){this.wYa()}wYa(){if(!this.Qna.K7&&!u.AFrameworkApplication.ve.Ov&&this.Jf.Jd&&this.Jf.Jd.isActive){var a=this.Rc.Pa.kb;a&&this.yJ.z8d()?this.BJ&&
this.BJ.t7a()?this.S9(2,!0,10):this.ef.Ew(a)?gb.App.Fb.Fd.isEditingAllowed||gb.App.Fb.Fd.uy?this.S9(2,!0,0):this.Qe.Vgd?(this.S9(1,!0,0),this.S9(0,!0,15)):this.S9(2,!0,0):this.S9(1,!0,0):this.S9(0,!1,a?9:8)}}get i7d(){return u.AFrameworkApplication.Xg}get Bzf(){return u.AFrameworkApplication.Ba.state}iTd(a){a.af();vg.OutlineNavigator.dFe(a)}SBj(a){return Md.OutlineElementReader.Vl(lc.OutlineElementNavigator.uA(a))}}Object(e.a)(Sg,"EditingModeTransitionManager",null,[1405]);class wh{constructor(a,
b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He){this.Qe=null;this.Md=a;this.kf=b;this.Mb=c;this.MNh=f;this.wk=l;this.LNh=w;this.JNh=F;this.Tpd=S;this.rVh=fa;this.mjb=xa;this.HLa=Za;this.HYe=pb;this.cJh=Mb;this.yJ=hc;this.jfa=kc;this.pRb=Ec;this.hJh=Hc;this.VPh=Dc;this.UFh=Td;this.vOh=we;this.dga=Pd;this.Ni=He}KR(a){this.Qe=a}get zX(){return!this.Md.Ov&&this.kf.isActive&&this.Mb.bSa(this.kf.mode)?!0:!1}ytk(a){a.BDa=b=>this.MNh.BDa(b,this.zX);a.X8a=b=>this.LNh.X8a(b,this.zX);a.xz=b=>this.JNh.xz(b,
this.zX,this.Qe.TWb);a.qVb=b=>this.Tpd.qVb(b,this.zX,this.Qe.TWb);a.gNd=b=>this.Tpd.eNd(b,this.zX,this.Qe.TWb);a.pVb=b=>this.Tpd.pVb(b,this.zX,this.Qe.TWb);a.Lgb=b=>this.rVh.Lgb(b,this.zX&&this.Qe.Vgd);a.WAa=Object(C.a)(this.mjb,this.mjb.WAa,"dropHandler");a.VAa=Object(C.a)(this.mjb,this.mjb.VAa,"dragOverHandler");a.DXb=Object(C.a)(this.mjb,this.mjb.DXb,"dragLeaveHandler");a.exe=b=>{this.HLa.handlePaste(b,this.Qe.root,this.kf.yPc)};a.XPd=b=>{this.HYe.fgg(b,!0,this.zX,this.kf.yPc)};a.RNd=b=>{this.HYe.fgg(b,
!1,this.zX,this.kf.yPc)};a.AXb=b=>{this.cJh.AXb(b,this.zX)};a.oHf=()=>{this.yJ.Nai()};a.ZC=b=>this.jfa.eBi(b,this.wk.Vba,this.zX);a.CB=b=>this.pRb.onContextMenu(b,this.Qe.Bg);a.UPe=Object(C.a)(this.pRb,this.pRb.wdc,"onTouchMove");a.TPe=Object(C.a)(this.pRb,this.pRb.hCb,"onTouchEnd");a.WGd=()=>{this.yJ.LJi(this.kf.mode)};a.C4a=b=>this.hJh.Fcb(b,this.zX);a.hXa=b=>{this.VPh.onScroll(b,this.zX,this.Qe.ownerDocument.documentElement)};a.dea=()=>{this.UFh.Wek(this.zX)};a.SAg=b=>{this.vOh.lostFocus(b,this.zX)};
a.mFb=()=>this.dga.Pmj(this.zX,this.Qe.Bg);a.gcb=b=>this.Ni.mouseDown(b);a.Rre=b=>this.Ni.OW(b)}}Object(e.a)(wh,"EditingSurfaceEventHandlerManager",null,[]);class ci{constructor(a,b,c){this.ld=a;this.Uf=b;this.uh=c}cancelEventAndRestoreEditingSurface(a){this.ld.Vb("DisallowedDragAndDrop",{["Reason"]:"CancelEventAndRestoreEditingSurface"});this.Uf.bx++;ad.a.Wm(a);this.uh.S9(0,!0,6);this.uh.wYa()}}Object(e.a)(ci,"EditingSurfaceEventHandlerUtils",null,[]);class Rh{constructor(){this.dza=0}get K7(){return 0<
this.dza}suspend(){this.dza++}resume(){0<this.dza&&this.dza--}}Object(e.a)(Rh,"EditingSurfaceStateManager",null,[]);class se{constructor(a=30){this.A4c=this.tbc=-1;this.Wgb=Array(a);this.R4c=Array(a-1)}Jvh(){this.sGk();this.xsl()}Oed(){const a=this.eYk();Z.ULS.sendTraceTag(18437392,324,50,"Duration Values: "+a)}sGk(){var a=(new Date).getTime();if(this.tbc<this.Wgb.length-1)this.tbc++;else for(let b=0;b<this.Wgb.length-1;b++)this.Wgb[b]=this.Wgb[b+1];this.Wgb[this.tbc]=a}xsl(){const a=this.tbc+1;for(let b=
2;b<=a;b++)this.zol(b,this.e0i(b))}e0i(a){const b=this.tbc;return this.Wgb[b]-this.Wgb[b-(a-1)]}zol(a,b){a-=2;this.A4c<a?(this.A4c++,this.R4c[this.A4c]=b):b<this.R4c[a]&&(this.R4c[a]=b)}eYk(){const a=this.nPi();return Sys.Serialization.JavaScriptSerializer.serialize(a)}nPi(){const a=Array(this.A4c+1);for(let b=0;b<a.length;b++)a[b]=Math.round(this.R4c[b]/(b+1));return a}}Object(e.a)(se,"EventFrequencyTracker",null,[]);var bf=d(1040),Sh=d(1042);class $c{constructor(a){this.Us=null;this.Zo=0;this.qJ=
a;this.Bj=new Date;this.Ooc=u.AFrameworkApplication.Ba.mode}end(a){this.Zo=a;this.Us=new Date}get startTime(){return this.Bj}get endTime(){return this.Us}get actionId(){return this.qJ}get behavior(){return 2}get bBc(){return this.Ooc}get XI(){return null}get od(){return null}get telemetryData(){return null}get response(){return this.Zo}get pS(){return 1}get $p(){return 30}get Spa(){return null}get Ui(){return!0}}Object(e.a)($c,"TypingActionOperation",null,[1402,306,307]);class Gi{constructor(a,b,
c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc){this.Qe=this.Trc=this.Ojb=null;this.mQh=a;this.uh=b;this.Xo=c;this.Mfa=f;this.X0=l;this.kk=w;this.Mb=F;this.Jf=S;this.Md=fa;this.xk=xa;this.kf=Za;this.Ni=pb;this.Ch=Mb;this.es=hc;this.Hfa=kc;this.bR=Ec;this.Rc=Hc;this.KC=Dc}KR(a){this.Qe=a}get zkg(){return!!this.Ojb}startHybridTransition(){if(this.xk.value.isEditingAllowed||this.xk.value.uy){this.uh.d_k();this.Xo.raiseEvent(Af.a.apk);this.Y_k(D.a.overtype);this.Mfa.value.Mv();this.X0.Swk(this.uh.mode);var a=
this.kk.ie(2);a.hd(this.Qe.root);this.Mb.Bg&&!u.AFrameworkApplication.Xg&&this.Mb.Bg.Rba(this.Jf.Jd.Na,4,!0);a.dispose();this.bR.Zhc();this.kf.bIa(!0);this.Ni.updateCaretPosition(this.uh.mode,this.Mb.Ci);this.mQh.dRi(this.Mb.Ph,this.Mb.Bg,this.Mb.fV);this.Ch.l9j(this.Rc.Pa.kb.Wa.Qa,this.Rc.Pa.kb.Wa.Lb);this.es.EX();this.Hfa.OAb();this.tZh();this.Xo.raiseEvent(Af.a.Zok)}else this.uh.S9(0,!0,12)}ZIi(){this.bR.Zhc();this.Ojb.end(32);bf.a.getInstance().ehc(this.Ojb);Sh.a.getInstance().dhc(this.Ojb);this.Ojb=
null}tZh(){this.Trc||(this.Trc=new Se.a(2,1,20,Object(C.a)(this,this.hybridCleanup,"hybridCleanup"),24),this.Md.Hb(this.Trc))}Y_k(a){this.Ojb=new $c(a)}hybridCleanup(){this.Trc=null;this.Mb.bSa(this.uh.mode)&&this.Qe.ds(!0)}DKe(){if(!this.Rc.Pa.cca)return!1;const a=this.Rc.Pa.kb.Wa,b=fb.HyperlinkReader.HB(a,!1);for(const c of b)if(c.Qa===a.Qa&&c.Lb<=a.Lb)return!1;return this.KC.FKj(a)?!1:!zg.d(a.node,a.Qa)&&!zg.d(a.node,a.Lb-1)&&!a.node.vri}}Object(e.a)(Gi,"HybridTransitionManager",null,[1403]);class Hk{constructor(a,
b,c,f,l){this.Gtd=this.swa=!1;this.Cr=a;this.uh=b;this.nd=c;this.Ch=f;this.Jf=l}get Osj(){return this.Gtd}IHc(){this.FZf(!0)}FZf(a){this.Cr.isComposing&&2===this.uh.mode&&(Z.ULS.sendTraceTag(18437401,323,50,"EnsureImeDetermined"),this.Gtd=!0,this.nd.xg.fma(),this.Ch.Hck(this.nd.contentWindow),this.Gtd=!1,this.Cr.isComposing=!1,a&&this.Jf.Jd.Oo&&(this.Jf.Jd.Cob()&&Z.ULS.sendTraceTag(38602073,323,50,"Selection is reset to view top by EnsureImeDetermined."),this.uh.wYa()))}}Object(e.a)(Hk,"ImeManager",
null,[]);class Gj{constructor(a,b,c,f,l,w,F,S){this.vh=null;this.qd=a;this.nd=b;this.uh=c;this.kk=f;this.ld=l;this.Uf=w;this.ym=S}BTb(a){this.vh=a}get Msj(){if(this.qd.ag){const a=id.a.JBa(this.nd.contentWindow);if(a&&this.ym.hNc(a)===this.nd.Ql())return!0}return!1}correctBadImeState(){if(!this.Msj)return!1;this.ld.Vb("PossibleIncorrectImeBehavior",{["Reason"]:"CorrectBadImeState"});this.Uf.bz++;const a=this.kk.ie(3);a.hd(this.vh.root);this.uh.S9(0,!0,11);this.uh.wYa();a.dispose();return!0}}Object(e.a)(Gj,
"ImeRecoveryUtils",null,[]);class Hj{constructor(a,b,c,f,l,w,F,S,fa){this.Ch=a;this.Uf=b;this.ld=c;this.Zi=f;this.EJ=l;this.Do=w;this.Jf=F;this.Mb=fa}OAb(){for(let a=0;a<this.Ch.yi.length;a++)this.Do.VH(this.Ch.yi[a].CE,this.Uf,this.ld,this.Zi)?Sys.UI.DomElement.removeCssClass(this.Ch.yi[a].x6d,"EmptyTextRun"):Sys.UI.DomElement.addCssClass(this.Ch.yi[a].x6d,"EmptyTextRun"),ya.a.IVb(this.Ch.yi[a].CE,this.Ch.yi[a].x6d)}}Object(e.a)(Hj,"InteractiveViewSynchronizer",null,[]);var wa=d(14),Ma=d(197),hb=
d(235);class ub{constructor(){}}Object(e.a)(ub,"OnBackspaceDeleteEventArgs",null,[]);class na{constructor(a){this.M1f=a}}Object(e.a)(na,"OnDisMissFloatieEventArgs",null,[]);var Pa=d(538),cb=d(98);class R{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig,Ff,nh,Jg,$h,Li,Aj,Zi,Ui,Bi,Dk,kj,rk,ml,nl,Bl,bk,Bj,ck,al){this.ega=null;this.R7e=this.rVe=!1;this.RNb=new wa.ScriptSharpLegacyMap;this.kza=a;this.Zi=b;this.Md=c;this.nd=f;this.ld=l;this.Uf=w;this.Zoa=F;this.dga=S;
this.jfa=fa;this.Mb=xa;this.Ni=Za;this.qd=pb;this.ym=Mb;this.bY=hc;this.ef=kc;this.bR=Ec;this.jH=Hc;this.goa=Dc;this.Rc=Td;this.kf=we;this.Cr=Pd;this.Mfa=He;this.qB=Pe;this.Vg=Df;this.xk=ig;this.NJ=Tg;this.Nib=Ig;this.wk=Ff;this.PKa=nh;this.BU=Jg;this.wGh=$h;this.Clb=Li;this.kk=Aj;this.Da=Zi;this.Yc=Ui;this.Go=Bi;this.PC=Dk;this.VLb=kj;this.TO=rk;this.u1a=ml;this.uoa=nl;this.Xo=Bl;this.vGh=bk;this.Exa=!!Bj;this.wu=Bj;this.mb=ck;this.Tm=al}get Pmc(){return this.kza.instance?this.kza.instance.Wwh():
null}get yQd(){return this.VLb||(this.VLb=lb.a.instance.qb("Common.IEventTimingMeter"))}get oXa(){return this.ega||(this.ega=lb.a.instance.qb("Box4.ISelectionCommands"))}TOj(a,b){let c=this.E2d(a);c||(c=this.bkj(a,b));return c}bkj(a,b){const c=a.nc,f=c.keyCode,l=a.eventName===ra.a.bNa;if(this.Exa&&l&&this.wu.instance&&this.wu.instance.lfk(f===x.a.fH))return ad.a.Wm(c),!0;if(f===x.a.Thb&&c.shiftKey&&c.ctrlKey)return l&&(u.AFrameworkApplication.Va.processAction(D.a.SSf,2),Z.ULS.sendTraceTag(41738320,
323,50,"CtrlShiftV triggered.")),!1;if(l&&c.ctrlKey){if(f===x.a.lmd||f===x.a.omd)return this.wce(D.a.RSf),!1;if(f===x.a.mmd||f===x.a.Bnc)return this.wce(D.a.QSf),!1;if(f===x.a.vUe)return this.wce(D.a.JAi),!1}this.Zi&&(this.Md.oUf(R.Mhl),this.nd.xg.Ckd());if(1===this.kf.mode)return this.Eik(a,b);if(this.Zi&&this.wk.Vba)return this.ld.Vb("DisallowedKeyDownDuringDictation",{["Reason"]:"KeyDownHandler"}),this.Uf.bw++,ad.a.Wm(c),this.Zoa.Whc(D.a.typing),!0;this.dga.fixupAfterMagnifierDrag();this.nd.Ql().scrollTop=
0;this.jfa.N7=!this.Mb.Xaa&&f===x.a.vO||this.Mb.Xaa&&f===x.a.WQ||f===x.a.mw;this.Ni.updateCaretPosition(this.kf.mode,this.Mb.Ci);this.qd.rj&&(c.ctrlKey||c.altKey)&&f!==x.a.qTe&&f!==x.a.mZa&&f!==x.a.sJb&&f!==x.a.gnd&&this.PKa.IHc();return this.akj(a)}akj(a){var b=a.nc.keyCode;const c=b===x.a.ona,f=b===x.a.fH;let l=!1,w=!1,F=!1;switch(b){case x.a.mw:case x.a.dE:F=!0;u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordBrowserHandledNavigationSettings");b=this.mb.ka("BrowserHandledNavigationIsEnabled");
a.nc.altKey||a.nc.ctrlKey||a.nc.shiftKey||this.qd.ak||!b&&this.qd.Gj||(w=!0);break;case x.a.WQ:case x.a.vO:F=!0;this.qd.ak&&this.ym.S$f(a.nc.rawEvent)&&!a.nc.altKey&&!a.nc.shiftKey?w=!0:this.qd.rj&&this.oXa?a.nc.altKey||a.nc.ctrlKey||a.nc.shiftKey||(w=!0):l=!0;this.mb&&this.mb.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&this.kf.bIa(!0);break;case x.a.C0:case x.a.A0:F=!0;this.qd.rj&&this.oXa?w=this.Nij(a):l=!0;this.mb&&this.mb.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&(this.ef.tTc(this.u1a.kb)||
this.ef.HHa(),this.kf.bIa(!0));break;case x.a.ona:case x.a.fH:if(!this.xk.value.isEditingAllowed&&this.xk.value.uy)l=!0;else if(this.Cij(a,c,f))return!0;break;case x.a.SBh:this.ld.Vb("InsertKeyPressed");l=!0;break;default:if(a.nc.keyCode===x.a.gnd||a.nc.keyCode===x.a.pmd||this.qd.hHd)this.Cr.isComposing=!0,this.Clb||this.kf.U9(!0)}(this.wk.A1&&!f||this.wk.lqa&&!c)&&this.jH.ds(!0);2!==this.kf.mode&&(F=w=!1);a.eventName===ra.a.bNa&&this.Xo.yCk(a,this.Cr.isComposing,F);w&&(this.Mfa.value.Mv(),this.qB.GMa(a));
l&&ad.a.Wm(a.nc);return w}E2d(a){return u.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?Pa.a.E2d(a,this.u1a.XYb):!1}Dij(a){const b=this.u1a.XYb;var c=b.node;const f=b.Qa,l=db.ParagraphReader.text(c);let w=!1;if(a){if(f<db.ParagraphReader.textLength(c)){a=this.kk.ie(15);try{a.hd(c),c=f+1,Ja.a.Hw(l,c)&&c++,this.Tm.wBb(b,null),this.Da.processAction(D.a.rightArrow,2)}finally{a&&a.dispose()}w=!0}}else if(0<f){a=this.kk.ie(15);try{a.hd(c),c=f-1,Ja.a.Hw(l,c)&&c--,this.Tm.wBb(b,null),this.Da.processAction(D.a.leftArrow,
2)}finally{a&&a.dispose()}w=!0}return w}L$i(a){return Ab.a.xs(a.Wa).cache.fontSize}Nij(a){var b=!1;if(!(a.nc.altKey||a.nc.ctrlKey||a.nc.shiftKey||(a=zg.f(this.Mb.Bg),Ma.a.any(a,c=>5===c.wq||8===c.wq)))){if(this.nd.xg&&this.TO.Wub(this.nd.xg.vn))return!1;this.qB.mhb&&this.qB.typingProcess();b=this.bY.hra(this.jfa.N7);a=this.ef.Qga(b);a=this.Mb.Xaa?a.x+a.width:a.x;-1===this.ef.Uy?(this.ef.Uy=a,b=!0):b=Math.abs(this.ef.Uy-a)<=this.L$i(b)}return b}Cij(a,b,c){if(!a.nc.altKey&&!a.nc.ctrlKey&&!a.nc.shiftKey&&
(this.Zi&&this.wk.A1&&this.bR.hld()&&this.jH.ds(!1),this.wGh.unl(b,this.Mb.Ph,this.Mb.ZNa,this.Mb.Bg,this.jfa.N7,this.Mb.fV.Ci,this.jH.ubi))){if(this.Yc.Zf&&this.Yc.fy)return(b=this.Dij(b))&&ad.a.Wm(a.nc),b;const f=this.ld.zp(D.a.dJd);this.Pmc&&this.Pmc.ZOj();const l=new ub(a,c,b);this.vGh.HBk(l);(c&&!this.wk.A1||b&&!this.wk.lqa)&&this.jH.ds(!1);I.a.instance.ga(50)&&this.goa.value&&this.goa.value.Nv&&this.Rc.WRb();ya.a.IVb(this.Mb.Ph.Ci,this.Mb.fV.Ci);this.qB.GMa(a);this.ef.HHa();this.kf.U9(!0);this.wk.lqa=
b;this.wk.A1=c;this.wk.A1&&-1===this.wk.uEc?this.wk.uEc=this.jH.YNc:this.wk.lqa&&-1===this.wk.yjd&&(this.wk.yjd=ya.a.Ou(this.Mb.ZNa).length);f.end();return!0}return!1}xz(a,b,c){const f=this.yQd;try{f&&f.keyDownEventHandlerStart(a.nc.rawEvent);0===this.kf.mode&&a.nc.keyCode!==x.a.Xp&&1!==this.Da.mode&&this.vUj(this.kf,a.eventName);if(!b||!this.Vg)return!1;(a.nc.keyCode!==x.a.sJb||this.Nib.xGc)&&this.xk.value.Uq.NM();if(!this.S6k(a)){const F=new na(!0);this.uoa.YBk(F)}if(!this.kf.isActive)return!1;
this.wk.Uae=(new Date).getTime();const l=this.ld.zp(D.a.typing);l.properties.$(Dh.a.source,"KeyDown");l.properties.$(Dh.a.f3g,"KeyDown");const w=this.TOj(a,c);w&&ad.a.Chi(a.nc);l.end();return w}finally{f&&f.keyDownEventHandlerEnd(a.nc.rawEvent)}}S6k(a){switch(a.nc.keyCode){case x.a.Rea:case x.a.RBh:case x.a.k5:case x.a.OX:case x.a.q$:case x.a.Sea:case x.a.pmd:case x.a.qmd:return!0}return!1}vUj(a,b){b={["EventName"]:b};u.AFrameworkApplication.Ba&&(b.Mode=u.AFrameworkApplication.Ba.mode);if(a)if(b.Trigger=
a.PUc,b.TriggeredTime=a.xPj,this.RNb.Kb(a.PUc)){let c,f;(c=this.RNb).$(f=a.PUc,c.ga(f)+1)}else this.RNb.$(a.PUc,1);b.Msg="BadEditSurfaceState";this.rVe?Z.ULS.sendTraceTag(18437408,323,50,"{0}",b):(Z.ULS.shipAssertTag(18437408,323,!1,"{0}",b),u.AFrameworkApplication.Aea(()=>{this.wUj()}));this.rVe=!0}wUj(){if(!this.R7e){var a="";for(let b of this.RNb.keys)a+=" Trigger "+b+" - "+this.RNb.ga(b)+",";Z.ULS.sendTraceTag(50421966,323,10,"Total keyinput lost in UnknownMode:"+a);this.R7e=!0}}Eik(a,b){this.Zi&&
this.NJ.Peb(this.kf.mode,this.Mb.Ci,this.Mb.Bg,this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy);if(this.Yc.Zf&&(A.KeyInputManager.ROc(a.nc)===A.KeyInputManager.La(x.a.EJa,A.KeyInputManager.He)||A.KeyInputManager.ROc(a.nc)===A.KeyInputManager.La(x.a.ioc,A.KeyInputManager.He))&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&(u.AFrameworkApplication.DQ||u.AFrameworkApplication.AL)&&!u.AFrameworkApplication.K4a)return ad.a.Wm(a.nc),
!0;const c=this.u1a.XYb,f=c.node;if(a.nc.keyCode===x.a.Xp){if(hb.EmbeddedFileReader.HIj(f))return ad.a.Wm(a.nc),!0;if(cb.ImageReader.tG(f)||!hb.EmbeddedFileReader.Z7a(f))if(cb.ImageReader.tG(f)||cb.ImageReader.dDa(c))return u.AFrameworkApplication.Va.li(c,D.a.WA,2,!1,null,null),ad.a.Wm(a.nc),!0}switch(a.nc.keyCode){case x.a.gnd:case x.a.pmd:if({u2:a,iHb:b}=this.BU.Zwh(a,b),a)return b}return!1}wce(a){u.AFrameworkApplication.Va.processAction(a,2)}}R.Mhl=2E3;Object(e.a)(R,"KeyDownProcessor",null,[]);
class ta{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc){this.Do=a;this.Mb=b;this.Uf=c;this.ld=f;this.Zi=l;this.DC=w;this.jH=F;this.bR=S;this.uh=fa;this.Ni=xa;this.bY=Za;this.kU=pb;this.ef=Mb;this.wk=hc;this.kf=kc}get Uwe(){return this.Do.VH(this.Mb.Ci,this.Uf,this.ld,this.Zi)-(this.DC.T5?1:0)-this.Do.VH(this.Mb.Ci.lastChild,this.Uf,this.ld,this.Zi)}Byk(a,b){switch(b.keyCode){case x.a.dE:case x.a.WQ:if(this.pqj(a,b))return!0;break;case x.a.mw:case x.a.vO:if(this.VIi(a,b))return!0;break;case x.a.C0:case x.a.A0:if(this.cql(a,
b))return!0;break;case x.a.fH:if(this.E$h())return!0}return!1}E$h(){return this.wk.A1&&this.bR.hld()?(this.jH.ds(!1,!0),!0):!1}cql(a,b){a.qRc=!0;var c=this.Uwe;const f=this.Ni.V6(this.uh.mode,this.Mb.Ci);f>=c&&(this.Ni.bS(c,this.Mb.Ph),a.kb=this.bY.hra(this.kU.N7));if(f===b.GWb)a.h4a=b.keyCode===x.a.OX?1:3;else{if(f<c&&Ja.a.vy(this.Do.G6f(this.Mb.Ph,f-1,this.ld,this.Uf,this.Zi))){c=this.ef.Pqa(a.kb,!1,!1,!1,!0);c=this.ef.Qga(c);var l=a.kb.Wa;a=this.ef.Qga(a.kb);l=Ab.a.xs(l);a.y>c.y&&Math.abs(a.x-
this.ef.Uy)>2*l.cache.fontSize&&this.Ni.bS(f-1,this.Mb.Ph)}this.kf.bIa(!0);this.kU.fixupAfterCursor(b.keyCode===x.a.OX?1:3);this.jH.zQd();return!0}return!1}VIi(a,b){a.qRc=!0;const c=this.Uwe;this.ef.HHa();const f=this.Ni.V6(this.uh.mode,this.Mb.Ci);f>=c&&(this.Ni.bS(c,this.Mb.Ph),a.kb=this.bY.hra(this.kU.N7));if(b.keyCode===x.a.vO&&(b.GWb>=c&&!this.Mb.Xaa||b.GWb===this.kU.qrh&&this.Mb.Xaa))a.h4a=2;else return this.kf.bIa(!0),b.keyCode===x.a.mw&&f<c&&Ja.a.vy(this.Do.G6f(this.Mb.Ph,f-1,this.ld,this.Uf,
this.Zi))&&this.Ni.bS(f-1,this.Mb.Ph),this.kU.fixupAfterCursor(this.Mb.Xaa?4:2),this.jH.zQd(),!0;return!1}pqj(a,b){a.qRc=!0;const c=this.Uwe;this.ef.HHa();if(b.keyCode===x.a.WQ&&(b.GWb===this.kU.qrh&&!this.Mb.Xaa||b.GWb>=c&&this.Mb.Xaa))a.h4a=4;else return this.kf.bIa(!0),this.kU.fixupAfterCursor(this.Mb.Xaa?2:4),this.jH.zQd(),!0;return!1}}Object(e.a)(ta,"KeyEntryProcessor",null,[]);var Ra=d(1160),nb=d(129),Cb=d(41);class mc{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,
Df,ig,Tg,Ig,Ff){this.Lxa=this.Gpf=null;this.qd=a;this.ym=b;this.ld=c;this.dga=f;this.xk=l;this.BU=w;this.F5=F;this.Cr=S;this.kf=fa;this.Rc=xa;this.nd=Za;this.Rqc=pb;this.Ni=Mb;this.cfa=hc;this.Do=kc;this.Mb=Ec;this.jfa=Hc;this.Ch=Dc;this.goa=Td;this.Xo=we;this.qB=Pd;this.D$=He;this.kza=Pe;this.RUh=Df;this.lfa=ig;this.Yc=Tg;this.Go=Ig;this.VLb=Ff}get Pmc(){return this.kza&&this.kza.instance?this.kza.instance.Wwh():null}get P8a(){return this.Yc.Zf&&this.Yc.fy}get IY(){return this.Lxa||(this.Lxa=lb.a.instance.qb("Box4.IClipboardCommands"))}get yQd(){return this.VLb||
(this.VLb=lb.a.instance.qb("Common.IEventTimingMeter"))}X8a(a,b){if(!b)return!1;b=this.yQd;try{b&&b.keyPressedEventHandlerStart(a.nc.rawEvent);if(this.qd.nD&&this.qd.ak&&this.ym.S$f(a.nc.rawEvent))return!1;this.Pmc&&!A.KeyInputManager.$sg(a)&&this.Pmc.ZOj();const c=this.ld.zp(D.a.typing);c.properties.$(Dh.a.source,"KeyPress");const f=this.YOj(a);c.end();return f}finally{b&&b.keyPressedEventHandlerEnd(a.nc.rawEvent)}}wnj(){if((this.RUh||this.P8a)&&this.lfa.w1(this.Rc.Dj,14)){var a=Object(ua.a)(Ra.a,
this.lfa.BZb(this.Rc.Dj,16,!1));if(a&&1<a.length){const b=[],c=this.Rc.Pa.ga(0);a=a.getContext(0).node;for(let f=0;f<c.length;++f){const l=c.ga(f).node;if(!mb.GraphIterator.nb(l).j$(a))break;Array.add(b,c.ga(f))}0<b.length&&this.Rc.setSelection(new nb.Selection(b,!0))}}}ACk(a,b){if(1===this.kf.mode)return!1;this.Xo.ABe(a,this.Cr.isComposing);let c;(c=this.qB).vUc=c.vUc+1;r.a.Xn||gb.App.CJd&&r.a.Fsh||(this.qB.Gnh(this.Cr.tDa)||this.qB.GMa(a),this.kf.U9(!0));this.Cr.isComposing&&I.a.instance.ga(50)&&
this.goa.value&&this.goa.value.Nv&&this.Rc.WRb();this.Ch.Jyc="";0<this.Ch.yi.length&&(this.qd.ag||" "===b)&&(this.Ch.Jyc=ya.a.Ou(this.Ch.yi[0].CE));this.D$.raiseEvent(Qf.a.Jae,a);this.Rqc.Jvh();return!1}XFi(a){let b=!1;this.Cr.tDa&&this.cfa.sTb.instance&&(" "===a&&this.Do.mIi(this.Mb.Ci,this.Ni.V6(this.kf.mode,this.Mb.Ci))&&(b=!!this.cfa.Wqe(this.Cr.tDa,this.jfa.N7)),!b&&this.cfa.sTb.instance.$Mj(a)&&this.cfa.WFi(a,this.jfa.N7))}ckj(a){if(1!==this.kf.mode||(this.qd.rj||this.qd.Xn)&&a.nc.ctrlKey&&
!a.nc.altKey||this.qd.Pia&&a.nc.charCode===x.a.B0)return!1;if(this.BU.N8c(a))return!0;var b=this.BU.hKe();const c=this.BU.U6k();if(b||c||!this.F5.DKe())return b&&!c&&this.Rc.setSelection(fd.SelectionFactory.Lg(this.Rc.Pa.kb.Wa.node,this.Rc.Pa.kb.Wa.Qa)),b=this.$7a(),this.wnj(),this.IY&&(this.IY.x2g(String.fromCharCode(a.nc.charCode),b),this.D$.raiseEvent(Qf.a.Jae,a)),ad.a.Wm(a.nc),!0;if(this.BU.Bwe(a))return!0;if(this.P8a){b=this.Yc.Dnb();try{this.Xo.ABe(a,this.Cr.isComposing),this.qd.Xn&&this.IY?
(this.IY.x2g(String.fromCharCode(a.nc.charCode)),ad.a.Wm(a.nc)):(this.qB.GMa(a),this.kf.U9(!0))}finally{b&&b.dispose()}}else this.F5.startHybridTransition(),this.Xo.ABe(a,this.Cr.isComposing),this.qB.GMa(a),this.kf.U9(!0);this.D$.raiseEvent(Qf.a.Jae,a);this.Rqc.Jvh();return!1}$7a(){if(this.Rc&&this.Rc.Pa&&this.Rc.Pa.kb){const a=this.Rc.Pa.kb;return Cb.SelectionEditor.Bl(a.ga(a.length-1))||a.ga(a.length-1).contextId===Db.a.paragraph}return!1}YOj(a){this.dga.fixupAfterMagnifierDrag();if(!(this.xk.value.isEditingAllowed||
this.xk.value.uy&&this.P8a))return ad.a.Wm(a.nc),!0;if(this.BU.P8c(a))return!1;if(1===this.kf.mode)return this.ckj(a);this.nd.Ql().scrollTop=0;this.qd.ag&&this.kf.s_b(this.Mb.Bg)&&" "===this.Gpf&&this.qB.typingProcess();const b=Ja.a.charAt(Ja.a.fromCharCode(a.nc.charCode),0);this.Gpf=b;this.Cr.isComposing||(A.KeyInputManager.$sg(a)&&(this.Cr.isComposing=!0),this.Ni.uEk&&(this.Cr.isComposing=!0));this.XFi(b);if(this.qd.ag&&!this.qd.ak){const c=a.nc;if(c.ctrlKey&&122===this.ym.F6f(c)||c.ctrlKey&&121===
this.ym.F6f(c))return!0}return this.ACk(a,b)}}Object(e.a)(mc,"KeyPressProcessor",null,[]);class Sc{constructor(a,b){this.Qi=a;this.keyCode=this.Qi.nc.keyCode;this.GWb=b}get Goj(){return!(void 0===this.keyCode||null===this.keyCode)}}Object(e.a)(Sc,"KeyQueueEntry",null,[]);class jd{constructor(a,b,c,f,l,w,F){this.SNb=[];this.ega=null;this.KNh=a;this.kf=b;this.Mb=c;this.ef=f;this.Rc=l;this.jH=w;this.Ni=F}get oXa(){return this.ega||(this.ega=lb.a.instance.qb("Box4.ISelectionCommands"))}Z4g(a){let b=-1;
if(A.KeyInputManager.utg(a.eventName)&&2===this.kf.mode)switch(a.nc.keyCode){case x.a.dE:case x.a.mw:case x.a.WQ:case x.a.vO:case x.a.C0:case x.a.A0:I.a.instance.ga(45)&&this.kf.s_b(this.Mb.Bg)&&this.jH.ds(!1,!1);ee.GrippersManager.instance.PQa();b=this.Ni.V6(this.kf.mode,this.Mb.Ci);break;default:ee.GrippersManager.instance.restoreAfterCursoring()}Array.add(this.SNb,new Sc(a,b))}Cyk(a){for(;0<this.SNb.length;){const b=this.SNb[0];Array.removeAt(this.SNb,0);const c=A.KeyInputManager.utg(b.Qi.eventName);
if(!(c&&(b.Qi.nc.altKey||b.Qi.nc.ctrlKey||b.Qi.nc.shiftKey)||this.SNb.length)){if(c)if(b.Goj){if(this.KNh.Byk(a,b))return!0}else this.ef.HHa();if(this.Xnl(a))return!0}}return!1}Xnl(a){if(5!==a.h4a){if(this.kf.e$f(this.Mb.Bg))if(1===a.h4a||3===a.h4a){const b=this.ef.Uy;this.Rc.setSelection(a.kb);this.ef.Uy=b}else this.Rc.setSelection(a.kb);this.oXa.dbk(a.h4a);if(2!==this.kf.mode)return!0}return!1}}Object(e.a)(jd,"KeyQueueProcessor",null,[]);class Ad{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb){this.ega=
null;this.ld=a;this.NJ=b;this.uh=c;this.Cr=f;this.Mb=l;this.xk=w;this.Hfa=F;this.es=S;this.dtc=fa;this.nd=xa;this.Nib=Za;this.qB=pb}get oXa(){return this.ega||(this.ega=lb.a.instance.qb("Box4.ISelectionCommands"))}BDa(a,b){if(!b)return!1;b=this.ld.zp(D.a.typing);b.properties.$(Dh.a.source,"KeyUp");a=this.aPj(a);b.end();return a}aPj(a){a.nc.keyCode===x.a.sJb&&(this.Nib.xGc=!0);a.nc.ctrlKey&&this.NJ.jVf(this.uh.mode,dd.a.instance.Pa,this.oXa,this.Mb.Ph,this.Mb.Ci,this.Mb.Bg,this.xk.value.isEditingAllowed||
this.xk.value.uy);this.Cr.isComposing&&(this.Hfa.OAb(),this.es.EX());this.qB.Gnh(this.Cr.tDa)&&(this.dtc.Z4g(a),this.qB.mhb=!0,this.qB.typingProcess());this.nd.Ql().scrollTop=0;return!1}}Object(e.a)(Ad,"KeyUpProcessor",null,[]);class ve{constructor(a){this.Kpd=this.uod=this.sJ=null;this.Md=a}get p6(){return this.sJ||(this.sJ=lb.a.instance.resolve("Common.Utils.IAriaNotifier"))}Cdk(a){a&&(this.Kpd=a,this.uod=new Se.a(2,1,500,Object(C.a)(this,this.tryAriaNotifyParagraphLockedTask,"tryAriaNotifyParagraphLockedTask"),
29),this.Md.Hb(this.uod))}tryAriaNotifyParagraphLockedTask(a){this.Kpd&&a&&this.uod===a&&this.p6.sendNotification(String.format(Box4Intl.Box4Strings.l_ScreenReaderBlockEditing,this.Kpd),!0)}}Object(e.a)(ve,"LockedParagraphAriaNotifier",null,[]);class Ae{constructor(a){this.jH=a}lostFocus(a,b){u.AFrameworkApplication.Xg||b&&this.jH.ds(!0,!1)}}Object(e.a)(Ae,"LostFocusEventProcessor",null,[]);class Ue{constructor(a,b,c,f){this.Uf=a;this.uh=b;this.Hfa=c;this.es=f}onScroll(a,b,c){b&&(c.scrollLeft||c.scrollTop)&&
(this.Uf.h++,c.scrollLeft=0,c.scrollTop=0,2===this.uh.mode&&(this.Hfa.OAb(),this.es.EX()))}}Object(e.a)(Ue,"OnScrollProcessor",null,[]);var mg=d(1069);class ki{constructor(a,b,c,f){this.html=a;this.text=b;this.Yil=c;this.ANd=f}dispose(){this.ANd=null}}Object(e.a)(ki,"OriginalElementContent",null,[109]);class di{constructor(a,b,c){this.YOb=[];this.R0e=0;this.ld=a;this.yR=b;this.Do=c}get tTd(){return this.R0e}get X0g(){return this.YOb}LMf(){for(let a=0;a<this.YOb.length;a++)this.YOb[a]&&(this.YOb[a].dispose(),
this.YOb[a]=null)}Crh(a){this.LMf();a=a.Es;for(let c=0;c<a.length;c++){const f=a[c];var b=!1;f.parentNode&&f.parentNode.parentNode&&(b=Sys.UI.DomElement.containsCssClass(f.parentNode.parentNode,nc.a.xUd));if(b||Sys.UI.DomElement.containsCssClass(f,nc.a.AM)||Sys.UI.DomElement.containsCssClass(f,ca.a.QU)||Sys.UI.DomElement.containsCssClass(f,nc.a.RM)){let l=b=null,w=null;1===f.childNodes.length&&3===f.firstChild.nodeType?b=ya.a.Ou(f):(l=this.Do.mYd(f,this.ld,this.yR),w=new mg.a(f));this.X0g[c]=new ki(f.innerHTML,
b,l,w)}Sys.UI.DomElement.containsCssClass(f,nc.a.RM)&&(this.R0e=ya.a.V5a(f))}}}Object(e.a)(di,"OriginalElementContentArray",null,[1394]);class lk{constructor(a,b,c,f,l,w,F){this.Ch=a;this.Uf=l;this.ld=f;this.Zi=F;this.DC=b;this.Rc=c;this.Do=w}dRi(a,b,c){var f=this.Rc.Pa.kb.Wa;const l=f.Qa;f=f.Lb;let w=0,F=0;a=a.Es;Array.clear(this.Ch.yi);for(let Za=0;Za<a.length;Za++){var S=a[Za],fa=this.Do.VH(S,this.Uf,this.ld,this.Zi);if(Sys.UI.DomElement.containsCssClass(S,nc.a.AM))F<l?w+=fa:F<f&&(fa=zg.d(b,F))&&
!fa.Xza&&(fa=K.a.te(S,ca.a.FDa),Array.add(this.Ch.yi,new Gh(S,c.Es[fa],w,F,1))),F++;else if(Sys.UI.DomElement.containsCssClass(S,ca.a.QU))w+=fa;else if(!Sys.UI.DomElement.containsCssClass(S,nc.a.RM)){if(F+fa>=l&&F<=f){let pb=K.a.te(S,ca.a.FDa);var xa=c.Es[pb];Sys.UI.DomElement.removeCssClass(xa,nc.a.C6);Array.add(this.Ch.yi,new Gh(S,xa,w,F,fa-(this.DC.T5?1:0)));for(S=this.Do.VH(xa,this.Uf,this.ld,this.Zi);S<fa&&!(pb+1>=c.Es.length);)xa=c.Es[pb+1],S+=this.Do.VH(xa,this.Uf,this.ld,this.Zi),xa.parentNode.removeChild(xa),
Array.removeAt(c.Es,pb+1)}else if(F>f)break;w+=fa;F+=fa}}}}Object(e.a)(lk,"OvertypeDomPreparer",null,[]);var Rf=d(122),Kd=d(58);class Ql{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec){this.Tyd=!1;this.Lxa=null;this.pOh=a;this.uh=b;this.qd=c;this.Rc=f;this.Zoa=l;this.ef=w;this.xk=F;this.Jf=S;this.Cr=fa;this.F5=xa;this.Zi=Za;this.Mb=pb;this.NJ=Mb;this.qB=hc;this.Yc=kc;this.Go=Ec}get IY(){return this.Lxa||(this.Lxa=lb.a.instance.qb("Box4.IClipboardCommands"))}Qnl(){return 1===this.uh.mode?(this.Tyd&&
this.qd.ag&&this.kJd(),this.Tyd=!1,!0):!1}kJd(){if(this.IY){const a=new H.DictionaryPropertySet;a.setValue(Kd.a.sT,"<span></span>");this.IY.Ipa(null,a,!1)}}Bwe(a){const b=this.Rc.ana;return b.iae||b.x9d?(ad.a.Wm(a.nc),this.Zoa.Whc(D.a.$ok),!0):!1}N8c(a){if(!this.ef.Tra(dd.a.instance.Pa.kb))return!1;ad.a.Wm(a.nc);this.Zoa.Whc(D.a.N8c);return!0}P8c(a){if(!I.a.instance.ga(14))return!1;var b=dd.a.instance.Pa.ga(0);if(!Rf.a.instance.OWk(b))return!1;b=this.ef.ync(dd.a.instance.Pa);this.pOh.Cdk(b);ad.a.Wm(a.nc);
this.Zoa.Whc(2===this.uh.mode?D.a.Gol:D.a.P8c);return!0}Zwh(a,b){let c,f;f=c=!1;if(!this.xk.value.isEditingAllowed)return ad.a.Wm(a.nc),{u2:!0,iHb:!0};if(!b)return{u2:!0,iHb:!0};if(this.N8c(a)||this.Jf.Jd.Eb.Pa.uG&&a.nc.type===ra.a.dNd)return{u2:!0,iHb:f};this.Cr.isComposing=!0;b=this.hKe();if(!b&&this.F5.DKe()){if(this.Bwe(a))return{u2:!0,iHb:f};this.Zi&&this.NJ.Peb(this.uh.mode,this.Mb.Ci,this.Mb.Bg,this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy);this.Yc.Zf&&this.Yc.fy?(ad.a.Wm(a.nc),
f=c=!0):this.F5.startHybridTransition()}else b&&this.Rc.setSelection(fd.SelectionFactory.Lg(dd.a.instance.Pa.kb.Wa.node,dd.a.instance.Pa.kb.Wa.Qa)),this.Rc.ana.mob(),this.Yc.Zf&&this.Yc.fy?(ad.a.Wm(a.nc),f=c=!0):this.qd.ag?(this.Tyd=!0,this.qB.GMa(a),c=!0):(this.kJd(),ad.a.Wm(a.nc));return{u2:c,iHb:f}}hKe(){if(!this.Rc.Pa.cca)return!1;var a=dd.a.instance.Pa.kb.Wa;return a.Qa!==a.Lb-1?!1:(a=zg.d(a.node,a.Qa))&&5===a.wq?!0:!1}U6k(){if(!this.Rc.Pa.cca)return!1;const a=this.Rc.Pa.kb.Wa;return!zg.d(a.node,
a.Lb)||0<a.Qa&&!zg.d(a.node,a.Qa-1)||a.Qa===a.Lb?!1:!0}}Object(e.a)(Ql,"OvertypeUtils",null,[]);class Uj{constructor(a,b,c,f,l,w){this.f_a=null;this.nd=a;this.cIh=b;this.Jf=c;this.uh=f;this.Mb=l;this.Eyd=w}get KPf(){return this.cIh}BSe(){if(2===this.uh.mode&&this.Jf.Jd.Po&&this.Mb.bSa(this.uh.mode)){var a=this.Mb.Ph,b=this.KPf.o_d(a.gb);this.Eyd.Cch(b,this.f_a,a,this.nd.xg.Ot,!1,!0);this.f_a=b}}}Object(e.a)(Uj,"ParagraphOverlayPositioner",null,[]);class fm{constructor(a,b){this.srk=this.location=
null;this.Ru=a;this.isRtl=b}}Object(e.a)(fm,"OnShowFloatieEventArgs",null,[]);class Ij{constructor(){this.type=0;this.payload=this.wwe=null;this.bVc=!1;this.zNa=this.style=this.Xze=null}}Object(e.a)(Ij,"PasteDataContext",null,[]);class Nm{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig){this.Wyd=this.bgf=this.pn=null;this.IBd=Tg;this.Noa=Ig;this.$ff=a.ka("PasteClipboardImageInChromeIsEnabled");this.AQh=a.ka("PasteFromPlainTextKeepEmptyLinesIsEnabled");this.Uzd=
a.ka("ReadImageBlobForIE11UpIsEnabled");this.tHh=a.Gc("ClipboardDataImageBlobLimitaton",10);this.BQb=a.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.puf=a.ka("PasteInBootLoadingUIIsEnabled");this.NBd=a.ka("ParseStyleFromRawHtmlHeadIsEnabled");this.Md=b;this.ld=c;this.kk=f;this.Rc=l;this.uh=w;this.nd=F;this.X0=S;this.Jf=fa;this.qd=xa;this.NJ=Za;this.Mb=pb;this.cfa=Mb;this.xk=hc;this.Lxa=kc;this.jk=Ec;this.HIh=Dc;this.hMa=Td;this.tR=we;this.Da=Pd;this.$ea=He;this.woa=Pe;this.uoa=
Df;this.hza=ig;this.zXe=[Object(C.a)(this,this.bsj,"imageClipboardDataHandler"),Object(C.a)(this,this.Psk,"plainTextClipboardDataHandler"),Object(C.a)(this,this.Qqj,"htmlClipboardDataHandler")]}get IY(){return this.Lxa.instance}get SGa(){return this.Wyd}y7i(a){switch(a){case "image/png":a=1;break;case "text/plain":a=2;break;case "text/html":a=3;break;default:a=0}return a}get ITh(){return this.NBd||this.BQb}gkj(a){const b=new Ij;b.type=this.y7i(a.type);b.payload=a.data;b.bVc=!0;this.Ofh(b)}c5g(a,b){this.Rc.ana.mob();
this.uh.S9(0,!0,13);this.nd.wXa(!0);const c=this.nd.xg.Ot.style;c.display="block";a&&(b=c.overflow,c.overflow="hidden");this.X0.Uwk();this.Jf.Jd.xxa();this.qd.qsa?this.NJ.PHa(this.uh.mode,this.Mb.Ci,this.Mb.Bg,this.Mb.Ph,this.xk.value.isEditingAllowed||this.xk.value.uy):this.X0.YCc();return b}Feh(a){this.nd.xg.Ot.style.overflow=a}handlePaste(a,b,c){if(!c&&!this.SGa&&!this.Md.Ov)if(this.IY||this.puf){this.cfa.zQ&&(this.cfa.zQ=null);this.Wyd=this.kk.ie(3);this.SGa.hd(b);b=new Ij;b.zNa=this.hza.KMe();
b.zNa.vAc("pasteHandler");b.bVc=!1;b.wwe=this.c5g(this.tR.Pgd,b.wwe);if(c=this.jk.tba(a)){this.ITh&&this.Gqk(c,b);for(let f=0;f<this.zXe.length&&this.zXe[f](a,c,b);++f);}this.Noa&&a.preventDefault();u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacLoadingPasteBootUISettings");!this.IY&&this.puf?this.Ofh(b):this.Nfh(b)}else Z.ULS.sendTraceTag(3994320,307,50,"Clipboard command not available"),this.ld.Vb(zd.a.qh,{["Reason"]:Hd.a.rUf}),this.Da.uce(D.a.Ipa),a.preventDefault()}Ofh(a){Z.ULS.sendTraceTag(24492118,
307,50,"Clipboard commands unavailable. Loading Paste dialog is showing.");this.Rma();this.$ea.Ak(6,()=>{this.fFi(a)})}Rma(){this.pn=this.woa();this.pn.Zq=!1;this.pn.vd=5;this.pn.Rma(null,null,null)}fFi(a){this.pn&&(this.pn.close(),this.pn=null);Z.ULS.sendTraceTag(24492119,307,50,"Clipboard commands available. Dismissing progress dialog.");this.Nfh(a)}Nfh(a){a=this.HIh.create(null,Object(C.a)(this,this.kGi,"doPasteOperation"),a);a.vl("Browser Pasted (Editing Surface)");a.run()}bsj(a,b,c){if((this.$ff||
this.Uzd)&&(b=this.jk.CXd(a.rawEvent))&&this.jk.emd(this.nd.Ql())){let f=null;if(({b2b:f}=this.jk.Gkd(b,this.tHh,this.tR.qbc)).returnValue)return c.type=1,c.payload=f,this.Uzd&&this.qd.IV&&a.preventDefault(),!1}return!0}Psk(a,b,c){return this.AQh&&this.jk.sIj(b)&&(a=this.jk.B_d(b))?(c.type=2,c.payload=a,!1):!0}Qqj(a,b,c){return this.IBd&&(a=this.jk.HLc(b))?(c.type=3,c.payload=a,this.NBd&&c.style&&(c.payload+=c.style),!1):!0}kGi(a,b){var c=this.nd.xg.Ot.style;b&&this.tR.Pgd&&"hidden"===c.overflow&&
this.Feh(b.wwe);if(c=this.nd.Ql()){if(this.qd.zsa)for(var f=c.firstChild;f&&1===c.childNodes.length&&lf.a(f);)c=f,f=f.firstChild;if(b&&(this.$ff||this.Uzd)&&1===b.type&&this.jk.emd(c)&&(f=b.payload)){this.bgf=a;this.tR.FVb(f,l=>{this.OWf(this.bgf,l,b)});return}this.OWf(a,this.nd.z7i(c),b)}}gzf(a){a=this.hMa.create(a,Object(C.a)(this,this.iuh,"teardownPaste"),null);a.vl("Aborting Paste in ContentEditableView");a.run()}OWf(a,b,c){this.qd.rj&&(ya.a.Vt(this.nd.Ql()),this.qd.Pia||this.nd.xg.fma());if(this.Noa&&
!c)Z.ULS.sendTraceTag(541172694,307,10,"No pasteDataContext"),this.gzf(a);else{c.bVc&&(b="",1!==c.type&&(b=c.payload));var f=!b&&!c.bVc;this.Noa&&(f=!c.payload&&f);f?(Z.ULS.sendTraceTag(18437454,307,15,""),this.gzf(a)):(c.style&&(b+=c.style),this.nd.wXa(!0),f=new H.DictionaryPropertySet,f.setValue(Kd.a.sT,b),f.setValue(Sb.a.P8d,!0),f.setValue(ob.a.iN,!0),1===c.type&&this.tR.gkc?f.setValue(Kd.a.EPc,b):2===c.type&&c.payload?f.setValue(Kd.a.jdb,c.payload):3===c.type&&c.payload&&(this.Noa?f.setValue(Kd.a.sT,
c.payload):f.setValue(Kd.a.kxe,c.payload)),this.BQb&&c.Xze&&f.setValue(Kd.a.M2g,c.Xze),c.zNa&&f.setValue(Kd.a.zNa,c.zNa),a=this.hMa.create(a,Object(C.a)(this,this.Pgi,"callPasteAction"),f),a.vl("Paste in ContentEditableView"),a.run())}}Pgi(a,b){this.IY.Ipa(a,b,!0);a.Wg(Object(C.a)(this,this.iuh,"teardownPaste"));return!0}iuh(a){this.uh.wYa();this.SGa&&(this.SGa.JT(a),this.SGa.dispose(),this.Wyd=null);a.Wg(Object(C.a)(this,this.Qgi,"callPasteFloatie"));return!0}Qgi(a,b){a=Object(ua.a)(H.DictionaryPropertySet,
b);if(!a||a.ta(Kd.a.jdb,null)||a.ta(Kd.a.EPc,null))return!1;b=new fm(1,u.AFrameworkApplication.isRtl);b.srk=a.ta(Kd.a.sT,null);this.uoa.QDk(b);return!1}Gqk(a,b){if(a=this.jk.p0f(a)){u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordGatherMetadataAboutPastedHTMLContentSettings");if(this.BQb){let c=this.jk.q0f(a);null===c?c="inaccessible":""===c&&(c="unknown");b.Xze=c}this.NBd&&(b.style=this.jk.KMi(a))}}}Object(e.a)(Nm,"PasteHandler",null,[1393]);class jf{constructor(a,b,c,f,
l){this.Udf=new Gd.a(RegExp("\u00a0","g")," ");this.Dwf=new Gd.a(new RegExp("["+Oa.zHf+Oa.ukg+"]","g"),"");this.ld=a;this.Uf=b;this.Ni=c;this.Do=f;this.qd=l}Fki(a,b,c,f,l){if(l){l=!1;for(let fa=0;fa<a.length;++fa){const xa=b.X0g[fa];if(!xa)continue;const Za=a[fa];var w=Za.innerHTML,F=xa.html;if(w.length===F.length||w===F)continue;if(Xc.tSc(Za))continue;l=!0;w=Sys.UI.DomElement.containsCssClass(Za,ca.a.QU);F=Sys.UI.DomElement.containsCssClass(Za,nc.a.AM);const pb=Sys.UI.DomElement.containsCssClass(Za,
nc.a.RM);let Mb=!1,hc=!1;Za.parentNode&&Za.parentNode.parentNode&&Sys.UI.DomElement.containsCssClass(Za.parentNode.parentNode,nc.a.xUd)&&(Mb=Za.parentNode.parentNode.firstChild===Za.parentNode,hc=Za.parentNode.parentNode.lastChild===Za.parentNode);var S=void 0;let kc;xa.text?(S=ya.a.Ou(Za),kc=xa.text):(S=this.Do.mYd(Za,this.ld,this.Uf),kc=xa.Yil);const Ec=this.Udf.VGa(S).indexOf(this.Udf.VGa(kc));if(0<=Ec){const Hc=this.Dwf.VGa(Ja.a.substring(S,0,Ec));S=this.Dwf.VGa(Ja.a.right(S,Ec+kc.length));0<
Hc.length&&((pb||F||Mb)&&0<fa?(this.m5c(a[fa-1],Hc,!0,this.Uf),this.Do.ARc(Za)&&(f-=Oa.BGc)):w&&fa!==a.length-1&&this.m5c(a[fa+1],Hc,!1,this.Uf));0<S.length&&((F||hc||w)&&fa!==a.length-1?(this.m5c(a[fa+1],S,!1,this.Uf),this.Do.ARc(Za)&&(f+=Oa.yRd)):pb&&0<fa&&this.m5c(a[fa-1],S,!0,this.Uf))}else pb&&(this.qd.rj||this.qd.Xn)&&1===kc.length&&!S.length?Z.ULS.sendTraceTag(18437455,315,50,"Possible Ins/Overtype"):pb&&this.qd.ag||Z.ULS.shipAssertTag(18437456,315,!1,"CleanReadOnlyObjects failed."),w=kc?kc.length:
0,F=S.length,F>w&&(f-=F-w);xa.text?ya.a.Zw(Za,xa.text):(this.Do.dMj(Za)||xa.ANd.restore(),xa.ANd=new mg.a(Za))}l&&this.Ni.bS(f,c)}}m5c(a,b,c,f){f.n++;c?ya.a.Zw(a,ya.a.Ou(a)+b):ya.a.Zw(a,b+ya.a.Ou(a))}}Object(e.a)(jf,"ReadOnlyObjectsCleaner",null,[]);class Hf{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we){this.nga=0;this.nd=a;this.vBd=b;this.yJ=c;this.Uf=f;this.ld=l;this.rtc=w;this.Rc=F;this.Ni=S;this.Do=fa;this.qd=xa;this.Ze=Za;this.ef=pb;this.Jf=Mb;this.Zi=hc;this.dBd=kc;this.ym=
Ec;this.Tq=Hc;this.OMh=Dc;this.nKh=we}init(a){this.nga=a}Peb(a,b,c,f,l){if(this.nd.isValid){var w=this.nd.Ql();w&&w.firstChild&&1!==u.AFrameworkApplication.Ba.state&&(this.vBd.t0f(this.Rc.Pa),this.qGe(a,b,c,f,l))}}PHa(a,b,c,f,l){if(this.yJ.z8d()&&(!this.Zi||this.Ze.u6g))if(this.yJ.setFocus(a,b,c,f,l),this.qd.XT){a="Window.getSelection";b=this.nd.Ql();if(this.qd.uS){if("none"===b.style.display){Z.ULS.sendTraceTag(19702473,324,15,"Editing element is not displayed");return}if(!ya.a.asa(this.nd.xg.Axa,
b)){Z.ULS.sendTraceTag(19702474,324,15,"Editing element is not attached to view panel");return}}try{var w=this.ym.getSelection(this.nd.contentWindow);w&&(a="Selection.removeAllRanges",this.ym.removeAllRanges(w),a="Selection.selectAllChildren",this.ym.qWk(w,b))}catch(F){w=ya.a.$bg(b),Z.ULS.sendTraceTag(18437461,324,10,"{{'BrowserAPI':'{0}','HTML':'{1}','Stack':'{2}','Display':{3},'RootElement':{4}}}",a,b?id.a.hSd(b):"",F.stack,b?b.style.display:"",w?w.tagName+","+w.id+","+w.className:"")}}else this.ym.qGe(this.nd.MBa().yl)}qGe(a,
b,c,f,l){const w=this.Rc.Pa.kb;try{if(this.yJ.z8d()&&(!this.Zi||this.Ze.u6g)){var F=w.Wa,S=w.We,fa=this.dBd.create(this.Jf.Jd);this.PHa(a,b,c,f,l);a=null;var xa=this.nd.MBa();if(this.qd.XT){a=this.ym.getSelection(this.nd.contentWindow);if(!a)return;if(this.ym.I8i(a)){var Za=this.ym.getRangeAt(a,0);this.ym.removeAllRanges(a)}else Za=this.ym.createRange(xa.yl)}else if(this.qd.XE)Za=xa.selection.createRange();else return;this.OMh&&this.M0k(Za);(this.ef.Oj(F)||this.ef.Bl(F))&&this.$Qi(F,Za);this.ef.Oj(S)&&
this.aRi(S,Za);this.qd.XT?this.ym.addRange(a,Za):this.qd.XE&&Za.select();fa.dispose()}}catch(pb){F=this.nd.Ql(),Z.ULS.sendTraceTag(18437463,324,10,"{{'Message':'{0}','Stack':'{1}','HTML':'{2}'}}",pb.message,pb.stack,F?id.a.hSd(F):"")}}aRi(a,b){var c=a.node.pc(this.nga).Es;let f=0,l=0,w=0;a=a.Lb;for(var F=!1;f<c.length;){const S=this.Do.VH(c[f],this.Uf,this.ld,this.Zi);if(F)w+=S;else if(Sys.UI.DomElement.containsCssClass(c[f],nc.a.AM))l++;else if(!Sys.UI.DomElement.containsCssClass(c[f],ca.a.QU)){if(a<=
l+S)if(F=a-l,this.qd.XT){c=c[f];this.rtc.value.dVb(c,this.nd.contentWindow);this.zkh(b,c,F,!1);break}else w=S-F,F=!0;l+=S}f++}this.qd.XE&&this.ym.moveEnd(b,-w)}$Qi(a,b){var c=a.node.pc(this.nga).Es;let f=0;var l=0;let w=0,F=a.Qa;for(this.ef.Bl(a)&&(F=this.Tq.textLength(a.node));f<c.length;)if(a=this.Do.VH(c[f],this.Uf,this.ld,this.Zi),Sys.UI.DomElement.containsCssClass(c[f],nc.a.AM))l++,f++,w+=a;else if(Sys.UI.DomElement.containsCssClass(c[f],ca.a.QU))f++,w+=a;else if(this.nKh&&Sys.UI.DomElement.containsCssClass(c[f],
nc.a.ESd))f++,w+=a;else{if(F<=l+a){l=F-l;this.qd.XT?(c=c[f],this.rtc.value.dVb(c,this.nd.contentWindow),this.zkh(b,c,l,!0)):this.ym.moveStart(b,w+l);break}l+=a;w+=a;f++}}zkh(a,b,c,f){b.childNodes.length?(1<b.childNodes.length||b.firstChild&&3!==b.firstChild.nodeType)&&Z.ULS.sendTraceTag(18437465,324,50,"Span is not normalized"):Z.ULS.sendTraceTag(18437464,324,10,"Trying to set selection in an empty span");let l=0,w=null;b=ya.a.hKc(b,!0);for(let F of b)if(3===F.nodeType){b=F.nodeValue.length;if(c<=
l+b){this.ym.TFb(a,f,F,c-l);return}w=F;l+=b}w?(Z.ULS.sendTraceTag(18437467,324,15,"CP ({0}) was greater than length of all text nodes ({1}), setting at end",c,l),this.ym.TFb(a,f,w,c-l)):Z.ULS.sendTraceTag(18437466,324,15,"Span contained no text nodes")}jVf(a,b,c,f,l,w,F){var S=this.Rc.ana;if(S.iae||S.x9d)return!1;var fa=this.nd.Ql();if(!fa.innerHTML.length)return!1;S=!1;if(this.qd.XT)(b=id.a.JBa(this.nd.contentWindow))&&(this.ym.hNc(b)===fa?S=!0:this.Zi&&id.a.xJj(b)&&id.a.wJj(b)&&(S=!0));else if(this.qd.XE){var xa=
this.nd.MBa().selection.createRange();xa=this.ym.v2i(xa.range);xa=xa.replace(Ja.a.vtc,"");fa=fa.innerHTML;fa=fa.replace(Ja.a.vtc,"");if(xa===fa)switch(a){case 2:S=!0;break;case 1:1<b.length||!(this.ef.iu(b.kb.Wa)||this.ef.Bl(b.kb.Wa)||this.ef.iu(b.kb.We)||this.ef.Bl(b.kb.We))||(S=!0)}}if(!S)return!1;this.Uf.by++;this.Zi&&c?c.Dqa():2===a?this.Ni.bS(this.Ni.fSa,f):1===a&&this.Peb(a,l,w,f,F);return!0}M0k(a){a=ya.a.hKc(a.commonAncestorContainer,!0);for(let b of a)b&&(a=ya.a.Rha(b),a.startsWith("OutlineElement")&&
(-1!==a.toLowerCase().indexOf("rtl")?b.style.direction="rtl":b.style.direction="ltr"),a.toLowerCase().startsWith("paragraph")&&b.parentNode&&b.parentNode.tagName.toLowerCase().startsWith("li")&&(b.style.margin=""))}}Object(e.a)(Hf,"SelectContentHelper",null,[]);class rj{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec){this.ega=this.Una=this.Qe=null;this.uh=a;this.Ni=b;this.Uf=Mb;this.Mb=c;this.kf=f;this.nd=l;this.Md=w;this.ym=F;this.Do=S;this.ld=pb;this.Rc=fa;this.Zi=kc;this.NJ=xa;this.kU=Za;
this.xk=hc;this.bR=Ec}get oXa(){return this.ega||(this.ega=lb.a.instance.qb("Box4.ISelectionCommands"))}KR(a){this.Qe=a}Pmj(a,b){if(!a)return!1;var c=this.uh.mode;if(2===c)if(!this.Ni.gyj)this.Uf.b++,this.Ni.bS(this.Ni.fSa,this.Mb.Ph);else if(this.Zi){if(500>(new Date).getTime()-this.kf.Ori)return this.Qe.apb.Vba=!1;a=id.a.JBa(this.nd.contentWindow);if(!a)return!1;if(id.a.eTc(a)){b=this.Ni.xKc(c,this.Mb.Ci);if(this.Ni.fSa===b&&!this.Qe.apb.Vba)return this.Una&&(this.Md.ah(this.Una),this.Md.Hb(this.Una)),
!1;if(this.bR.hld())return this.Uf.c++,this.Qe.apb.Vba=!0,!1;if(this.Qe.apb.Vba)return this.Uf.d++,this.kf.U9(!0),this.Qe.ds(!0),this.Qe.apb.Vba=!1;this.Una||this.Qe.ds(!0);ee.GrippersManager.instance.setVisibility(!1);this.y_k();return!1}if(this.NJ.jVf(c,dd.a.instance.Pa,this.oXa,this.Mb.Ph,this.Mb.Ci,this.Mb.Bg,this.xk.value.isEditingAllowed||this.xk.value.uy))return this.Uf.e++,!1;c=this.Do.q_d(this.ym.hNc(a),this.Mb.Ci,this.ym.hdg(a),this.Uf,this.ld,this.Zi);a=this.Do.q_d(this.ym.C0i(a),this.Mb.Ci,
this.ym.z8f(a),this.Uf,this.ld,this.Zi);if(0>c||a<c||db.ParagraphReader.textLength(b.node)<a)return!1;this.Uf.f++;this.Rc.setSelection(fd.SelectionFactory.PY(b.node,c,a))}return!1}y_k(){this.Una?this.Md.ah(this.Una):this.Una=new Se.a(2,1,1E3,()=>{this.fixupAfterMagnifierDrag()},23);this.Md.Hb(this.Una)}fixupAfterMagnifierDrag(){if(this.Una){this.Una=null;var a=this.uh.mode;2===a&&this.Mb.bSa(a)&&(this.Uf.g++,this.Ni.updateCaretPosition(a,this.Mb.Ci),this.kf.bIa(!0),this.kU.fixupAfterCursor(5),this.Qe.ds(!0),
ee.GrippersManager.instance.Joh())}}}Object(e.a)(rj,"SelectionChangeHandler",null,[1392]);class Om{constructor(a,b){this.nd=a;this.wQb=b}t0f(a){this.pFf(this.nd.Ql(),this.wQb+a.qr,r.a.Abi)}pFf(a,b,c){for(a=a.firstChild;a;a=a.nextSibling)3!==a.nodeType&&(this.GLk(a),Sys.UI.DomElement.addCssClass(a,b),Sys.UI.DomElement.addCssClass(a,c),this.pFf(a,b,c))}GLk(a){var b=a.className;if(b){b=b.split(" ");for(let c=0;c<b.length;c++)b[c].startsWith(this.wQb)&&Sys.UI.DomElement.removeCssClass(a,b[c])}else Z.ULS.sendTraceTag(18437474,
324,50,"Class string for DOMElement is null")}}Object(e.a)(Om,"SequenceCodeHelper",null,[1391]);class gm{constructor(a,b,c,f){this.Uf=f;this.Ni=b;this.ld=c;this.mb=a}Pzk(a,b,c,f){if(a.yi.length){var l=a.yi[0].CE,w=ya.a.Ou(l);if((a=a.Jyc)&&w&&w.length===a.length+1&&w.endsWith(" ")){var F=id.a.wZd(l);F&&((a=K.a.te(l,ca.a.FDa),a=b.Es[a+1],a)?id.a.wZd(a)!==F&&(c=this.Ni.V6(c,f),f=ya.a.Ou(a),this.ld.Vb("MomentaryIncorrectLinkLength",{["Reason"]:"MovedSpaceOutOfLink"}),this.Uf.q++,ya.a.Zw(l,w.substring(0,
w.length-1)),ya.a.Zw(a," "+f),this.Ni.bS(c,b)):this.Uf.p++)}}}Qhi(a,b,c){for(let f=0;f<a.childNodes.length;f++){const l=a.childNodes[f];if(l.parentNode===a)if(this.mb.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&Sys.UI.DomElement.containsCssClass(l,nc.a.O7))for(let w=0;w<l.childNodes.length;w++)this.dLf(l.childNodes[w],w,b,a,c)&&w--;else this.dLf(l,f,b,a,c)&&f--}}dLf(a,b,c,f,l){const w=a.parentNode;f=w===f;if(3===a.nodeType){let F=-1;const S=a.nodeValue;let fa=null,xa="";if(b){const Za=w.childNodes[b-
1];if(lf.a(Za)&&(!f||db.ParagraphReader.Pd(lf.a(Za).gb))){for(fa=Za;fa.lastChild&&1===fa.lastChild.nodeType;)fa=fa.lastChild;xa=fa.innerText+S}}if(!fa&&b!==w.childNodes.length-1&&(b=w.childNodes[b+1],lf.a(b)&&(!f||db.ParagraphReader.Pd(lf.a(b).gb)))){for(fa=b;fa.firstChild&&1===fa.firstChild.nodeType;)fa=fa.firstChild;xa=S+fa.innerText}fa?(F=this.Ni.V6(c,w),this.ld.Vb("MomentaryIncorrectFormatting",{["Reason"]:"MovedSpanlessText"}),this.Uf.r++,ya.a.Zw(fa,xa)):(this.ld.Vb("ValidTextDropped",{["Reason"]:"DroppedSpanlessText"}),
this.Uf.s++);w.removeChild(a);-1!==F&&this.Ni.bS(F,l);return!0}return!1}JKk(a,b,c,f){if(r.a.ag&&a.yi.length){var l=ya.a.Ou(a.yi[0].CE),w=a.Jyc;l&&w&&l.length===w.length+2?this.abh(0,a,b,c,f):2===a.yi.length&&this.abh(1,a,b,c,f)}}abh(a,b,c,f,l){c=this.Ni.V6(c,f);(f=ya.a.Ou(b.yi[a].CE))&&f.endsWith("\u00a0 ")&&(this.Uf.t++,f=f.substr(0,f.lastIndexOf("\u00a0 "))+" ",b.yi[a].CE.innerText=f,(0<a?c-(b.yi[0].kBc+ya.a.Ou(b.yi[0].CE).length):c-b.yi[0].kBc)>f.length&&c--,this.Ni.bS(c,l))}}Object(e.a)(gm,"StrayTextCleanupUtils",
null,[]);class sj{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td){this.tfa=null;this.mDd=a;this.njb=b;this.rrd=c;this.ld=f;this.dga=l;this.uh=w;this.Rc=F;this.F5=S;this.qd=fa;this.kf=xa;this.wk=Za;this.qB=pb;this.Hfa=Mb;this.es=hc;this.BU=kc;this.D$=Ec;this.Mb=Hc;this.mMa=Dc;this.Yc=Td}get oba(){return this.tfa||(this.tfa=lb.a.instance.qb("Box4.IFormatPainter"))}Lgb(a,b){if(!b)return!1;if(this.mDd.Pmh)return a.nc.preventDefault(),!0;if(this.njb.f4a&&this.qd.qsa)return this.njb.f4a=!1,
this.rrd.cancelEventAndRestoreEditingSurface(a.nc),!0;this.oba&&this.oba.wK&&(this.oba.wK=!1);this.Bij(a.nc);b=this.ld.zp(D.a.typing);b.properties.$(Dh.a.source,"TextInput");a=this.Fil(a);b.end();return a}Fil(a){this.dga.fixupAfterMagnifierDrag();if(1===this.uh.mode){if(this.BU.hKe())this.Rc.setSelection(fd.SelectionFactory.Lg(dd.a.instance.Pa.kb.Wa.node,dd.a.instance.Pa.kb.Wa.Qa));else if(this.F5.DKe()){if(this.BU.Bwe(a))return!1;this.F5.startHybridTransition()}this.qd.dI&&this.BU.kJd()}this.D$.raiseEvent(Qf.a.Gil,
a);this.kf.U9(!0);this.wk.VOe=!0;this.qB.GMa(a);this.mMa&&this.mMa.iBl(this.Mb.Ph);this.Hfa.OAb();this.es.EX();return!1}Bij(a){this.qd.ag||"deleteContentBackward"!==a.rawEvent.inputType||(this.wk.EQd=!this.wk.A1,this.wk.EQd&&u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("DeleteFromInputEventIsEnabled")&&(a=sj.dLd.xKc(2,this.Mb.Ci),a<sj.dLd.fSa&&(a=fd.SelectionFactory.PY(this.Mb.Bg,a,sj.dLd.fSa),u.AFrameworkApplication.Va.Ma(D.a.kOa,2,a))))}static get dLd(){return sj.Ni||(sj.Ni=lb.a.instance.resolve("Box4.ICaretPositionManager"))}}
sj.Ni=null;sj.bR=null;sj.jH=null;Object(e.a)(sj,"TextInputEventProcessor",null,[]);class Rl{constructor(a,b,c,f,l,w){this.yJ=a;this.qd=b;this.Ze=c;this.wk=f;this.xk=l;this.Yc=w}get P8a(){return this.Yc.Zf&&this.Yc.fy}get Pmh(){if(this.yJ.g2b||!this.xk.value.isEditingAllowed&&this.xk.value.uy&&!this.P8a)return!0;if(this.qd.G7){var a=this.Ze.nPj;if(0<a){var b=(new Date).getTime();a=b-a;b-=this.wk.Uae;if(500>a&&a<b)return!0}}return!1}}Object(e.a)(Rl,"TextInputHandlerUtils",null,[]);var Dl=d(509),Pm=
d(303);class hl{constructor(a,b,c,f){this.boa=null;this.qd=a;this.yJ=b;this.Jf=c;this.ef=f}onContextMenu(a,b){let c=!1;this.qd.G7&&this.yJ.nSc&&(b=this.ef.opb(this.Jf.Jd,b,this.Jf.Jd.Qha(a),!1),this.ef.Ew(b)&&(c=!0));c?(this.boa=a.clientPoint,a=!0):(this.boa=null,a=this.Jf.Jd.onContextMenu(a));return a}wdc(a){if(this.qd.G7&&this.boa){const b=Pm.a.RPe;if(a.clientPoint.x>this.boa.x+b||a.clientPoint.x<this.boa.x-b||a.clientPoint.y>this.boa.y+b||a.clientPoint.y<this.boa.y-b)this.boa=null}return!1}hCb(a){let b=
!1;this.qd.G7&&this.boa&&(b=this.Jf.Jd.onContextMenu(a),this.boa=null);return b}}Object(e.a)(hl,"TouchEventProcessor",null,[]);class Tk{create(a){return new $c(a)}}Object(e.a)(Tk,"TypingActionOperationFactory",null,[1387]);var de=d(70),Nf=d(245);class vm{constructor(a,b,c,f,l,w){this.qxf=0;this.hbf=Fa.a.nil;this.HNb=this.psc=!1;this.V8e=4===gb.App.mode;this.Ruc=!1;this.UVh=new dc.a;this.UVh.add(0,D.a.kEe);this.Qxc=new dc.a;this.Qxc.add(0,0);this.Pbf=a;this.Mib=b;this.Jf=c;this.Xo=f;this.VVh=l;this.upd=
w;this.Raf=Object(C.a)(this,this.nQk,"reportTypingCharCount");u.AFrameworkApplication.Aea(()=>{this.YVj()});this.upd&&this.PIk();this.OIk();u.AFrameworkApplication.Va&&u.AFrameworkApplication.Va.ra(D.a.kEe,de.a.frame,Le.ActionManager.Dg,96)}PIk(){this.Xo&&this.Xo.addHandler(Af.a.zx,this.Raf)}OIk(){this.Mib&&this.Mib.VBf(Object(C.a)(this,this.Yzc,"afterEditingViewValidateEventHandler"))}Whc(a){this.Pbf.value&&0===this.Pbf.value.mode||(a=new $c(a),a.end(8),bf.a.getInstance().ehc(a),Sh.a.getInstance().dhc(a))}tWg(a,
b){if(!this.V8e&&gb.App.Fb&&2===gb.App.Fb.mode&&b&&b.graphNode&&db.ParagraphReader.Pd(b.graphNode)&&!zg.a(b.graphNode,5)){if(a=b.graphNode.id,a!==this.hbf){if(this.Ruc){var c;(c=this.Qxc).$(0,c.ga(0)+1);u.AFrameworkApplication.Va.processAction(D.a.kEe,2);c="Paragraph rendering is blocked";this.VVh&&(c+=", so graph transaction manager is reset",Nf.GraphTransactionManager.instance.aJe());Z.ULS.sendTraceTag(38547550,323,15,c)}this.hbf=a;this.Ruc=!0}}else this.Ruc=!1}Yzc(a,b){this.V8e||!b.YL&&!b.HT||
(!this.psc&&this.Jf.Jd&&(this.Jf.Jd.h2h(Object(C.a)(this,this.tWg,"onContentEditableViewClick")),this.psc=!0),this.Ruc=!1)}nQk(){this.qxf++}dwl(a,b){a!==b&&(a=String.format("CP changed unexpectedly in browser, expected {0} but was {1}",a,b),Z.ULS.sendTraceTag(18437207,323,15,a))}YVj(){this.HNb||(this.upd&&(Z.ULS.sendTraceTag(38114780,323,50,""+this.qxf),this.JFi(),this.upd=!1),0<this.Qxc.ga(0)&&Z.ULS.sendTraceTag(38536792,323,15,"ParagraphDisappear:{0}",this.Qxc.ga(0)),this.IFi(),this.HNb=!0)}JFi(){this.Xo&&
this.Xo.removeHandler(Af.a.zx,this.Raf)}IFi(){this.Mib&&this.Mib.PMk(Object(C.a)(this,this.Yzc,"afterEditingViewValidateEventHandler"));this.psc&&this.Jf.Jd&&(this.Jf.Jd.TMk(Object(C.a)(this,this.tWg,"onContentEditableViewClick")),this.psc=!1)}}Object(e.a)(vm,"TypingLogger",null,[1318]);const Uk=a=>{u.AFrameworkApplication.fa.ka("TypingSurveyIsEnabled")&&(a.execute(b=>{b.D5b("WordTypingSurveyTrigger",null)}),a.execute(b=>{window.setTimeout(()=>{b.logActivity("WordTypingSurveyTrigger",null)},300)}))};
class El{constructor(a){this.qRc=!1;this.h4a=5;this.rTg=!1;this.xse=!0;this.kb=a}}Object(e.a)(El,"TypingProcessState",null,[]);class Jj{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig,Ff,nh,Jg,$h){this.kga=this.Qe=null;this.mhb=!1;this.Zkd=null;this.vUc=0;this.BMb=a;this.Mb=b;this.Etd=c;this.Ni=f;this.S0a=l;this.Xo=w;this.dtc=F;this.bY=S;this.kU=fa;this.kf=xa;this.goa=Za;this.Rc=pb;this.BJ=Mb;this.Hfa=hc;this.ld=kc;this.Uf=Ec;this.jH=Hc;this.Md=Dc;this.wk=Td;this.Ch=
we;this.DC=Pd;this.roa=He;this.cfa=Pe;this.qd=Df;this.Efa=ig;this.kk=Tg;this.es=Ig;this.NRh=Ff;this.yCd=nh;this.Cr=Jg;this.Yc=$h;this.Saf=0;this.X1e=!1;this.zwj()}KR(a){this.Qe=a}get AYa(){return this.kga||(this.kga=lb.a.instance.qb("Box4.ITextFormattingCommands"))}Iol(){Ee.c(18437507,306,100,"TypingProcessInternalCalled");const a=this.Yc.Dnb();try{this.vUc=0;if(this.Qe.bpk.Qnl()||2!==this.kf.mode||!this.kf.isActive||u.AFrameworkApplication.Xg||!this.Mb.Bg||this.Etd.correctBadImeState())return;this.Ni.updateCaretPosition(this.kf.mode,
this.Mb.Ci);this.S0a.BSe();this.Rki();this.Xo.raiseEvent(Af.a.typingProcess);if(!this.Mb.ZNa||2===gb.App.mode&&this.Cr.isComposing)return;const b=new El(this.bY.hra(this.kU.N7));if(this.dtc.Cyk(b))return;b.qRc||(this.kf.U9(!0),b.rTg=!0);this.Kyk(b);if(!this.Mb.bSa(this.kf.mode))return;const c=this.Mb.fV.gb;this.Yc.Zf&&(c.TAb=this.Rc.Pa.kb.Wa.Qa);b.rTg&&I.a.instance.ga(50)&&this.goa.value&&this.goa.value.Nv&&this.Rc.WRb();if(b.xse){try{this.Hfa.OAb()}catch(f){this.ld.Vb("PossibleEditSurfaceIncorrectSize",
{["Reason"]:"MirrorToPageViewCrash"}),this.Uf.l++,this.jH.ds(!1,!1)}this.es.EX();this.Cr.tDa&&(this.jH.ds(!0,!0),this.mji())}}finally{a&&a.dispose()}Ee.c(18437510,306,100,"TypingProcessInternalExited")}mji(){gb.App.Fb.tpj&&gb.App.Fb.MTk()}GMa(a){this.dtc.Z4g(a);this.mhb||(this.mhb=!0,this.Md.Hb(this.Zkd))}CCi(){if(!this.wk.A1&&!this.wk.lqa)return!1;const a=!this.goa.value||this.goa.value.amIAlone?Jj.Tgj:Jj.Sgj,b=this.BMb();-1===this.wk.QUc&&(this.wk.QUc=b);return b-this.wk.QUc<a?(this.Md.Hb(this.Zkd),
this.mhb=!0):!1}typingProcess(){if(this.mhb&&(this.mhb=!1,this.Saf++,!this.Md.Ov&&this.Mb.bSa(this.kf.mode)&&!(this.BJ&&this.BJ.t7a()||this.CCi()))){var a=this.ld.zp(D.a.typingProcess);this.Iol();a.end();this.X1e||this.Saf!==Jj.Oii||((a=lb.a.instance.Oa("Common.ISystemInitiatedFeedback"))&&Uk(a),this.X1e=!0)}}Rki(){if(this.Cr.tDa){if(this.Ch.Azf())if((this.qd.nD||this.qd.Xn)&&this.DC.T5){const a=this.Ni.V6(this.kf.mode,this.Mb.Ci);this.DC.ofb(!1,this.Mb.Ci,this.Ch);this.Ni.bS(a,this.Mb.Ph)}else this.DC.ofb(!1,
this.Mb.Ci,this.Ch);this.NRh.Fki(this.Mb.Ph.Es,this.roa,this.Mb.Ph,this.Ni.V6(this.kf.mode,this.Mb.Ci),this.Cr.tDa);this.yCd.Qhi(this.Mb.Ci,this.kf.mode,this.Mb.Ph);this.yCd.Pzk(this.Ch,this.Mb.Ph,this.kf.mode,this.Mb.Ci);this.Ch.OKk();this.yCd.JKk(this.Ch,this.kf.mode,this.Mb.Ci,this.Mb.Ph)}}Kyk(a){this.cfa.zQ?(this.cfa.gsk(),a.xse=!1):this.Efa.instance&&this.Efa.instance.w3d()&&!this.qd.AHb&&(this.Cr.tDa&&this.AYa?(this.Q7h(a.kb),a.xse=!1):this.Efa.instance.UWa())}Q7h(a){if(this.AYa&&this.Efa.instance){this.Efa.instance.freeze();
var b=dd.a.instance.Pa.kb,c=this.kk.ie(15);c.hd(this.Mb.Bg.node);a=fd.SelectionFactory.SM(a,b.Wa);this.AYa.JFb(a.Wa,!0);this.Efa.instance.fPe();this.Efa.instance.UWa();this.Mb.Ph&&this.Rc.setSelection(this.bY.hra(this.kU.N7));c.dispose();this.kf.U9(!0);this.jH.ds(!0,!1)}}zwj(){let a=1;r.a.Xn&&(a=u.AFrameworkApplication.fa.Gc("Box4TypingTaskTimeEdge",1));this.Zkd=new Se.a(0,1,a,()=>{this.typingProcess()},25)}dispose(){this.Zkd=null}Gnh(a){return this.qd.G7&&a?this.cfa.zQ||this.vUc>Jj.h$j||this.Efa.instance&&
this.Efa.instance.w3d()||this.DC.T5?!0:!1:!1}}Jj.h$j=7;Jj.Sgj=250;Jj.Tgj=2E3;Jj.Oii=500;Object(e.a)(Jj,"TypingProcessManager",null,[1386,109]);class Kj{constructor(){this.Ta=new sd.a}YBk(a){this.Ta.raiseEvent("OnDismissPasteFloatie",a)}cCk(){this.Ta.raiseEvent("OnExpandMenuPasteFloatie")}BBe(a){this.Ta.raiseEvent("OnPastedContentUpdated",a)}QDk(a){this.Ta.raiseEvent("OnShowPasteFloatie",a)}}Object(e.a)(Kj,"PasteFloatieEventSource",null,[1365,1366,1367]);var Hi=d(852),xi=d(130),ni=d(312),pg=d(391),
ul=d(221),Rn=d(809);class ek{constructor(){this.Ea=null}get name(){return"Box4.ContentEditableView"}Yb(a){this.Ea=a;a.register(Dl.a,"Box4.TextNodeCombiner").as("Box4.ITextNodeCombiner").ma().na(()=>new Dl.a);a.register(We,"Box4.ContentEditableDomFactory").as("Box4.IContentEditableDomFactory").ma().na(()=>new We);a.register(se,"Box4.EventFrequencyTracker").ma().na(()=>new se);a.register(ed,"Box4.CevUsageDataTracker").ma().na(()=>new ed);a.register(Ic,"Box4.ContentEditableViewEventSource").ma().na(()=>
new Ic);a.register(Ia,"Box4.CurrentlyActiveContentSpans").as("Box4.ICurrentlyActiveContentSpans").ma().na(()=>new Ia(cd.a.instance,cg.a.instance.sXd(),a.resolve("Box4.TextNodeCombiner")));a.register(di,"Box4.OriginalElementContentArray").as("Box4.IOriginalElementContentArray").ma().na(()=>new di(cd.a.instance,cg.a.instance.sXd(),Xc.instance,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Og,"Box4.EditingDomManager").as("Box4.IEditingDomManager").ma().na(()=>new Og);a.register(Qg,
"Box4.EditStateEventManager").as("Box4.IEditStateEventManager").ma().na(()=>new Qg(a.resolve("Box4.IEditingDomManager")));a.register(jj,"Box4.ContentEditableViewPaddingManager").as("Box4.IContentEditableViewPaddingManager").ma().na(()=>new jj(a.resolve("Box4.EditStateEventManager"),cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,a.resolve("Box4.EditingDomManager"),a.resolve("Common.IAppSettingsManager").ka("RemovePaddingHighlightEnabled")));a.register(1318,"Box4.ITypingLogger").ma().na(()=>
new vm(a.qe("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ContentEditableViewEventSource"),oa.InteractiveViewManager.instance,a.resolve("Box4.EditStateEventManager"),a.resolve("Common.IAppSettingsManager").ka("QoETypingImprovementIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("QoECharCountIsEnabled")));a.register(hj,"Box4.CaretPositionManager").as("Box4.ICaretPositionManager").ma().na(()=>new hj(a.qe("Box4.ITextNodeCombiner"),cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,
a.resolve("Box4.EditingDomManager"),Xc.instance,Ta.a.instance,oa.InteractiveViewManager.instance,u.AFrameworkApplication.ve,Ta.a.instance.Ji,Hi.a.instance,a.resolve("Common.IScrollLockFactory"),a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Box4.ITypingLogger")));a.register(Lf,"Box4.ContentEditableViewFocusHelper").as("Box4.IContentEditableViewFocusHelper").ma().na(()=>new Lf(a.resolve("Box4.EditingDomManager"),oa.InteractiveViewManager.instance,a.resolve("Box4.IExternalSelectionManager"),
Ta.a.instance.Ji,Hb.a.instance,Ta.a.instance,v.FocusManager.instance()));a.register(jf,"Box4.ReadOnlyObjectsCleaner").ma().na(()=>new jf(cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,a.resolve("Box4.CaretPositionManager"),Xc.instance,Ta.a.instance));a.register(gm,"Box4.StrayTextCleanupUtils").ma().na(()=>new gm(u.AFrameworkApplication.fa,a.resolve("Box4.CaretPositionManager"),cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH));a.register(1319,"Box4.IContentEditableViewContentControlHelper").ma().na(()=>
new ze(cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,Ta.a.instance.Ji,Xc.instance,oa.InteractiveViewManager.instance,a.resolve("Box4.IParagraphReader")));a.register(af,"Box4.ActiveContentSpansPersistanceManager").as("Box4.IActiveContentSpansPersistanceManager").ma().na(()=>new af(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.CevUsageDataTracker").FH,cd.a.instance,a.qb("Box4.IHyperlinkEditor"),
Ta.a.instance,a.resolve("Box4.IContentEditableViewContentControlHelper"),Hi.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Common.IAppSettingsManager")));a.register(Xg,"Box4.CevViewContentManager").as("Box4.ICevViewContentManager").ma().na(()=>new Xg(a.Oa("Common.ITypingSpeedMeterProvider"),oa.InteractiveViewManager.instance));a.register(Ag,"Box4.ContentEditableViewTypingState").ma().na(()=>new Ag(u.AFrameworkApplication.Va));a.register(Ld,"Box4.ContentEditableHtmlStructureUtils").ma().na(()=>
new Ld(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ContentEditableViewTypingState")));a.register(Om,"Box4.SequenceCodeHelper").ma().na(()=>new Om(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IConstantsProvider").nih));a.register(Hf,"Box4.SelectContentHelper").ma().na(()=>new Hf(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.CevUsageDataTracker").FH,cd.a.instance,a.qe("Box4.ITextNodeCombiner"),
dd.a.instance,a.resolve("Box4.ICaretPositionManager"),Xc.instance,Ta.a.instance,oc.EventHandlerManager.instance,ni.a.instance,oa.InteractiveViewManager.instance,Ta.a.instance.Ji,a.resolve("Common.ScrollLockFactory"),Hi.a.instance,a.resolve("Box4.IParagraphReader"),yc.ListReader.Gw,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Common.IAppSettingsManager").ka("FixUpEmptySpanInSelectionBeginIsEnabled")));a.register(Ng,"Box4.EditingDomDisplayManipulator").ma().na(()=>new Ng(a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.SelectContentHelper"),u.AFrameworkApplication.fa,oa.InteractiveViewManager.instance));a.register(Rg,"Box4.EditViewStateManager").as("Box4.IEditViewStateManager").ma().na(()=>new Rg(a.resolve("Box4.ContentEditableViewEventSource")));a.register(Hj,"Box4.InteractiveViewSynchronizer").ma().na(()=>new Hj(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CevUsageDataTracker").FH,cd.a.instance,
Ta.a.instance.Ji,a.resolve("Box4.Graph.IGraphIteratorFactory"),Xc.instance,oa.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager")));a.register(mf,"Box4.CurrentEditSelectionProvider").ma().na(()=>new mf(a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CevUsageDataTracker").FH,cd.a.instance,Xc.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),Ta.a.instance.Ji,a.resolve("Box4.IContentEditableViewContentControlHelper")));
a.register(kg,"Box4.BackspaceInBrowserHandler").ma().na(()=>new kg(a.resolve("Box4.CurrentEditSelectionProvider"),Ta.a.instance.Ji,Rf.a.instance,ni.a.instance,a.resolve("Box4.IExternalSelectionManager"),ul.a.instance,u.AFrameworkApplication.fa.ka("PPTLineBoxEnabled"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IHyperlinkStrategy"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.Oa("Box4.IAutoCorrectScheduler"):null));a.register(lk,"Box4.OvertypeDomPreparer").ma().na(()=>
new lk(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableViewPaddingManager"),dd.a.instance,cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,Xc.instance,Ta.a.instance.Ji,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(tb,"Box4.CutCopyHandler").as("Box4.ICutCopyHandler").ma().na(()=>new tb(ni.a.instance,dd.a.instance,cd.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.EditStateEventManager"),oa.InteractiveViewManager.instance,
a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ICevViewContentManager"),Ta.a.instance,a.resolve("Box4.SelectContentHelper"),new sc.a(()=>gb.App.Fb.Fd),a.Oa("Box4.IClipboardCommands"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IEditingDomManager"),u.AFrameworkApplication.fa,u.AFrameworkApplication.Va,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Kj,"Box4.PasteFloatieEventSource").as("Box4.IPasteFloatieEventSource").as("Box4.IPasteFloatieEventHandler").as("Box4.IPasteFloatieEventNotifier").ma().na(()=>
new Kj);a.register(pc,"Box4.BackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventNotifier").ma().na(()=>new pc);a.register(Wh,"Box4.BoundsSynchronizer").as("Box4.IBoundsSynchronizer").ma().na(()=>new Wh(a.Oa("Box4.IListMarkerUtility"),a.resolve("Box4.IEditingDomManager"),a.Oa("Common.IZoomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),Ta.a.instance,oa.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),
a.resolve("Box4.IRotatingCoordinateConverter")));a.register(Rh,"Box4.EditingSurfaceStateManager").ma().na(()=>new Rh);a.register(Sg,"Box4.EditingModeTransitionManager").as("Box4.IEditingModeTransitionManager").ma().na(()=>new Sg(a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.EditingSurfaceStateManager"),u.AFrameworkApplication.ve,a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),new sc.a(()=>gb.App.Fb.Fd),Ta.a.instance,a.resolve("Box4.IContentEditableViewPaddingManager"),dd.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),oa.InteractiveViewManager.instance,ni.a.instance,a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Uj,"Box4.ParagraphOverlayPositioner").ma().na(()=>
new Uj(a.resolve("Box4.IEditingDomManager"),new Rn.a,oa.InteractiveViewManager.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IParagraphOverlayControlRenderer")));a.register(ah,"Box4.ContentEditableViewDebugLogger").ma().na(()=>new ah);a.register(Gj,"Box4.ImeRecoveryUtils").ma().na(()=>new Gj(Ta.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),
cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,a.resolve("Box4.ContentEditableViewDebugLogger"),Hi.a.instance));a.register(tf,"Box4.AutocorrectActionExecutor").ma().na(()=>new tf(a.Oa("Box4.IAutoCorrectScheduler"),a.Oa("Box4.IAutoCorrectRules"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.CaretPositionManager"),
a.qe("Box4.IUndoManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.Graph.IGraphTransactionFactory"),dd.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(Nm,"Box4.PasteHandler").as("Box4.IPasteHandler").ma().na(()=>new Nm(a.resolve("Common.IAppSettingsManager"),u.AFrameworkApplication.ve,cd.a.instance,
a.resolve("Box4.Graph.IGraphTransactionFactory"),dd.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),oa.InteractiveViewManager.instance,Ta.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.AutocorrectActionExecutor"),new sc.a(()=>gb.App.Fb.Fd),a.Oa("Box4.IClipboardCommands"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IFileReaderHelperFactory"),
a.resolve("Common.IDelayOperationFactory"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.IProcessImageStrategy"),u.AFrameworkApplication.Va,Oc.a.get_instance(),()=>new Yc.a,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry"),gb.App.instance.u3b,gb.App.instance.xGb));a.register(ih,"Box4.ContentEditableViewCursorManager").ma().na(()=>new ih(oa.InteractiveViewManager.instance,cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,Ta.a.instance.Ji,dd.a.instance,
ni.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),new sc.a(()=>gb.App.Fb.Fd),u.AFrameworkApplication.Va,a.resolve("Box4.IEditViewStateManager"),u.AFrameworkApplication.ve,Ta.a.instance,a.resolve("Box4.ICaretPositionManager"),Xc.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),
new Qd,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.qb("Box4.CharacterPointConverter")));a.register(rj,"Box4.SelectionChangeHandler").as("Box4.ISelectionChangeHandler").ma().na(()=>new rj(a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.IEditingDomManager"),u.AFrameworkApplication.ve,Hi.a.instance,Xc.instance,dd.a.instance,a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.ContentEditableViewCursorManager"),cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,new sc.a(()=>gb.App.Fb.Fd),Ta.a.instance.Ji,a.resolve("Box4.ContentEditableHtmlStructureUtils")));a.register(Gi,"Box4.HybridTransitionManager").as("Box4.IHybridTransitionManager").ma().na(()=>new Gi(a.resolve("Box4.OvertypeDomPreparer"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.EditStateEventManager"),a.qe("Box4.IUndoManager"),a.resolve("Box4.EditingDomDisplayManipulator"),
a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.CevViewContentManager"),oa.InteractiveViewManager.instance,u.AFrameworkApplication.ve,new sc.a(()=>gb.App.Fb.Fd),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),dd.a.instance,Rf.a.instance));a.register(li,"Box4.CompositionStateManager").ma().na(()=>
new li(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.HybridTransitionManager")));a.register(Hk,"Box4.ImeManager").ma().na(()=>new Hk(a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),oa.InteractiveViewManager.instance));a.register(Jd,"Box4.DragStateManager").ma().na(()=>new Jd(Ta.a.instance));a.register(hl,"Box4.TouchEventProcessor").ma().na(()=>
new hl(Ta.a.instance,a.resolve("Box4.ContentEditableViewFocusHelper"),oa.InteractiveViewManager.instance,ni.a.instance));a.register(bg,"Box4.AppFrameResizeEventProcessor").ma().na(()=>new bg(a.resolve("Box4.BoundsSynchronizer")));a.register(Ue,"Box4.OnScrollProcessor").ma().na(()=>new Ue(a.resolve("Box4.CevUsageDataTracker").FH,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer")));a.register(ci,"Box4.EditingSurfaceEventHandlerUtils").ma().na(()=>
new ci(cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,a.resolve("Box4.IEditingModeTransitionManager")));a.register(Lc,"Box4.DragEventsProcessor").ma().na(()=>new Lc(Ta.a.instance,a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils")));a.register(qc,"Box4.DoubleClickProcessor").ma().na(()=>new qc(a.resolve("Box4.CaretPositionManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),oa.InteractiveViewManager.instance));a.register(Qb,
"Box4.DomChangeEventProcessor").ma().na(()=>new Qb(Ta.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),cd.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(Rl,"Box4.TextInputHandlerUtils").ma().na(()=>new Rl(a.resolve("Box4.IContentEditableViewFocusHelper"),Ta.a.instance,oc.EventHandlerManager.instance,
a.resolve("Box4.ContentEditableViewTypingState"),new sc.a(()=>gb.App.Fb.Fd),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Yf,"Box4.ContentEditableViewGraphUpdater").ma().na(()=>new Yf(ce.a.instance,a.resolve("Box4.EditingModeTransitionManager"),cd.a.instance,dd.a.instance,a.resolve("Box4.IExternalSelectionManager"),ni.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.Graph.GraphIteratorFactory"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.CharacterPropertiesEditor"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),
a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.CevUsageDataTracker").FH,a.resolve("Box4.HybridTransitionManager"),u.AFrameworkApplication.ve,Ta.a.instance,a.Oa("Box4.IInsertionPointFormatting"),a.resolve("Box4.IActiveContentSpansPersistanceManager"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.Proofing.IModifiedRangeEditor"),a.qb("Box4.CharacterPointConverter"),a.resolve("Box4.ITypingLogger")));a.register(ta,"Box4.KeyEntryProcessor").ma().na(()=>
new ta(Xc.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.CevUsageDataTracker").FH,cd.a.instance,Ta.a.instance.Ji,a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),ni.a.instance,a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.EditViewStateManager")));a.register(jd,"Box4.KeyQueueProcessor").ma().na(()=>new jd(a.resolve("Box4.KeyEntryProcessor"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),ni.a.instance,dd.a.instance,a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ICaretPositionManager")));a.register(Jj,"Box4.TypingProcessManager").as("Box4.ITypingProcessManager").ma().na(()=>new Jj(id.a.pj,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ImeRecoveryUtils"),
a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.EditViewStateManager"),new sc.a(()=>gb.App.Hh),dd.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,a.resolve("Box4.ContentEditableViewGraphUpdater"),
u.AFrameworkApplication.ve,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.AutocorrectActionExecutor"),Ta.a.instance,a.Oa("Box4.IInsertionPointFormatting"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.ReadOnlyObjectsCleaner"),a.resolve("Box4.StrayTextCleanupUtils"),a.resolve("Box4.CompositionStateManager"),
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Ql,"Box4.OvertypeUtils").ma().na(()=>new Ql(new ve(u.AFrameworkApplication.ve),a.resolve("Box4.EditingModeTransitionManager"),Ta.a.instance,dd.a.instance,a.resolve("Box4.ITypingLogger"),ni.a.instance,new sc.a(()=>gb.App.Fb.Fd),oa.InteractiveViewManager.instance,a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.HybridTransitionManager"),Ta.a.instance.Ji,a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(Wi,"Box4.ContentEditableViewFloatieHandler").ma().na(()=>new Wi);a.register(Ad,"Box4.KeyUpProcessor").ma().na(()=>new Ad(cd.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ICevViewContentManager"),new sc.a(()=>gb.App.Fb.Fd),
a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.TypingProcessManager")));const b=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TableEditingSelectIsEnabled");a.register(mc,"Box4.KeyPressProcessor").ma().na(()=>new mc(Ta.a.instance,Hi.a.instance,cd.a.instance,a.resolve("Box4.ISelectionChangeHandler"),new sc.a(()=>
gb.App.Fb.Fd),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.IHybridTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),dd.a.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.AutocorrectActionExecutor"),Xc.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),new sc.a(()=>
gb.App.Hh),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.Oa("Common.ITypingSpeedMeterProvider"),b,xi.ContextSetEditor.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.qb("Common.IEventTimingMeter")));a.register(R,"Box4.KeyDownProcessor").ma().na(()=>new R(a.Oa("Common.ITypingSpeedMeterProvider"),Ta.a.instance.Ji,u.AFrameworkApplication.ve,
a.resolve("Box4.IEditingDomManager"),cd.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,a.resolve("Box4.ITypingLogger"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICaretPositionManager"),Ta.a.instance,Hi.a.instance,a.resolve("Box4.CurrentEditSelectionProvider"),ni.a.instance,a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.ContentEditableViewGraphUpdater"),new sc.a(()=>
gb.App.Hh),dd.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.CompositionStateManager"),a.qe("Box4.IUndoManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CharacterPropertiesEditor"),new sc.a(()=>gb.App.Fb.Fd),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ImeManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.BackspaceInBrowserHandler"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing"),
a.resolve("Box4.Graph.IGraphTransactionFactory"),u.AFrameworkApplication.Va,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.qb("Common.IEventTimingMeter"),a.resolve("Box4.IRotatingCoordinateConverter"),pg.a.instance,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.IBackspaceDeleteEventSource"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?
a.Oa("Box4.IAutoCorrectScheduler"):null,u.AFrameworkApplication.fa,a.qb("Box4.IHyperlinkEditor")));a.register(pj,"Box4.ContentEditableViewOnAfterValidateHandler").ma().na(()=>new pj(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),oa.InteractiveViewManager.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),
a.resolve("Box4.IContentEditableViewPaddingManager"),Ta.a.instance,a.resolve("Box4.CevUsageDataTracker").FH,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.qe("Box4.ITextNodeCombiner"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.ParagraphOverlayPositioner"),dd.a.instance,Ta.a.instance.Ji,a.resolve("Box4.SelectContentHelper"),new sc.a(()=>gb.App.Fb.Fd),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.qb("Box4.ITabRenderer"),a.resolve("Box4.IPasteFloatieEventSource"),a.qb("Box4.IFeatureHelper")));a.register(qj,"Box4.ContentEditableViewOnBeforeValidateHandler").ma().na(()=>new qj(a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditStateEventManager")));
a.register(Yb,"Box4.CompositionEventProcessor").ma().na(()=>new Yb(a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.TextInputHandlerUtils"),cd.a.instance,a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ITypingLogger"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewEventSource"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(sj,"Box4.TextInputEventProcessor").ma().na(()=>new sj(a.resolve("Box4.TextInputHandlerUtils"),a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils"),cd.a.instance,a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.EditingModeTransitionManager"),dd.a.instance,a.resolve("Box4.HybridTransitionManager"),Ta.a.instance,a.resolve("Box4.EditViewStateManager"),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.ICevViewContentManager"),a.qb("Box4.ITabRenderer"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Ae,"Box4.LostFocusEventProcessor").ma().na(()=>new Ae(a.resolve("Box4.ContentEditableViewGraphUpdater")));
a.register(wh,"Box4.EditingSurfaceEventHandlerManager").ma().na(()=>new wh(u.AFrameworkApplication.ve,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.KeyUpProcessor"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.KeyPressProcessor"),a.resolve("Box4.KeyDownProcessor"),a.resolve("Box4.CompositionEventProcessor"),a.resolve("Box4.TextInputEventProcessor"),a.resolve("Box4.DragEventsProcessor"),a.resolve("Box4.PasteHandler"),a.resolve("Box4.CutCopyHandler"),
a.resolve("Box4.DomChangeEventProcessor"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.TouchEventProcessor"),a.resolve("Box4.DoubleClickProcessor"),a.resolve("Box4.OnScrollProcessor"),a.resolve("Box4.AppFrameResizeEventProcessor"),a.resolve("Box4.LostFocusEventProcessor"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.CaretPositionManager")));a.register(Fi,"Box4.ContentEditableViewDisposer").ma().na(()=>new Fi(a.resolve("Box4.IOriginalElementContentArray"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CurrentlyActiveContentSpans"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.CevUsageDataTracker").FH,a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager")));a.register(Tk,"Box4.TypingActionOperationFactory").as("Box4.ITypingActionOperationFactory").ma().na(()=>new Tk);a.register(1320,"Box4.IContentEditableModeHelper").ma().na(()=>new Xf);a.register(vh,"Box4.ContentEditableView").as("Box4.IEditingView").ma().na(()=>
new vh(oa.InteractiveViewManager.instance,dd.a.instance,new sc.a(()=>gb.App.Fb.Fd),a.Oa("Common.IActivityAggregationInfo"),a.Oa("Common.IZoomManager"),u.AFrameworkApplication.Va,a.resolve("Box4.IHtmlViewRootFactory"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.IPasteHandler"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewFloatieHandler"),
a.resolve("Box4.ContentEditableViewOnAfterValidateHandler"),a.resolve("Box4.ContentEditableViewOnBeforeValidateHandler"),a.resolve("Box4.EditingSurfaceEventHandlerManager"),a.resolve("Box4.ContentEditableViewDisposer"),a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.IContentEditableDomFactory"),gb.App.XIa,a.resolve("Box4.IContentEditableModeHelper")))}init(){this.Ea.resolve("Box4.EditingModeTransitionManager").BTb(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.BoundsSynchronizer").BTb(this.Ea.resolve("Box4.ContentEditableView"));
this.Ea.resolve("Box4.ImeRecoveryUtils").BTb(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.AutocorrectActionExecutor").KR(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.ContentEditableViewCursorManager").tai(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.SelectionChangeHandler").KR(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.HybridTransitionManager").KR(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.ContentEditableViewGraphUpdater").KR(this.Ea.resolve("Box4.ContentEditableView"));
this.Ea.resolve("Box4.TypingProcessManager").KR(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.ContentEditableViewOnAfterValidateHandler").KR(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.ContentEditableViewOnBeforeValidateHandler").KR(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.EditingSurfaceEventHandlerManager").KR(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.CompositionEventProcessor").KR(this.Ea.resolve("Box4.ContentEditableView"))}dispose(){}static main(){m.a.instance.Ec(new ek)}}
Object(e.a)(ek,"ContentEditableViewPackage",null,[2,3]);class ln{get name(){return"PowerPointWebEditor.AutoFit"}Yb(){}init(){}dispose(){}static main(){m.a.instance.Ec(new ln)}}Object(e.a)(ln,"PPTWebEditorAutoFitPackage",null,[2,3]);class Fl{constructor(a){this.gx=a}}Object(e.a)(Fl,"DynamicScriptLoaderProvider",null,[1532]);var fk=d(338),Oi=d(231),xh=d(335);const mn=(a,b)=>{var c=u.AFrameworkApplication.fa.Fu("IsServerFlavorDebug")?u.AFrameworkApplication.fa.ka("IsServerFlavorDebug")?"":".min":".min";
c=a.identifier+c+".js";let f="";f=a.isLocalized?f+(u.AFrameworkApplication.lcid+"/"):f+rh(b);return f+c},rh=a=>a&&u.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")&&!u.AFrameworkApplication.fa.ka("AppChromeOverrideIsCombinedBundle")&&!u.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?"exp/":"",aj=(a="anonymous",b="dynamicScriptLoaderDependencies")=>{const c={resolveScript:f=>{var l=fk.AppChromeOverrideUtilities.vtg(c.knownScripts,f.identifier);if(fk.AppChromeOverrideUtilities.isEnabled&&
l){var w=f.isLocalized?fk.AppChromeOverrideUtilities.H$f(u.AFrameworkApplication.lcid):fk.AppChromeOverrideUtilities.ZEb;f.isLocalized||(w+=rh(!0));f=w+f.identifier+fk.AppChromeOverrideUtilities.EUd+".js"}else xh.a.instance.isEnabled?(w=u.AFrameworkApplication.zea,f=mn(f,l),xh.a.instance.isEnabled&&(l=xh.a.instance.XYd(u.AFrameworkApplication.X_+f))&&(w=l+u.AFrameworkApplication.X_),Z.ULS.sendTraceTag(592228695,306,50,"Dynamic loading hashed resource for "+f),f=w+f):u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScriptUrlFromNameNewIsEnabled",
!1)?f.isLocalized?f=u.AFrameworkApplication.Rj(f.identifier,3):(f=rh(l)+f.identifier,l=u.AFrameworkApplication.fa.Fu("IsServerFlavorDebug")?u.AFrameworkApplication.fa.ka("IsServerFlavorDebug")?"":".min":".min",f=u.AFrameworkApplication.Rj(f+l+".js",5)):(w=u.AFrameworkApplication.zea,w=f.isLocalized?w+(u.AFrameworkApplication.lcid+"/"):w+rh(l),l=u.AFrameworkApplication.fa.Fu("IsServerFlavorDebug")?u.AFrameworkApplication.fa.ka("IsServerFlavorDebug")?"":".min":".min",f=w+f.identifier+l+".js");return f},
resolveSriHash:f=>{const l=fk.AppChromeOverrideUtilities.vtg(c.knownScripts,f.identifier);xh.a.instance.isEnabled?(f=mn(f,l),f=xh.a.instance.Cbj(u.AFrameworkApplication.X_+f)):f=null;return f}};c.crossOriginAttributeValue=a;c.knownScripts=window[b];return c};var za=d(26),uk=d(639);class Lj{constructor(){this.qle=this.K3=this.K=null;this.qIg=this.yHg=!1}get name(){return"PowerPointWebEditor.DynamicScriptLoader"}Yb(a){if(!a)throw Error.argumentNull("container");this.K=a;this.K3=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");
this.K.register(Fl,"Common.DynamicScriptLoaderProvider").as("Common.IDynamicScriptLoaderProvider").ma().na(()=>{var b=window.self.EarlyDynamicScriptLoader;if(void 0===b||null===b){b=aj();if(uk.a.PEj){const c=b.resolveScript;b.resolveScript=f=>{let l=uk.a.WQe(f.identifier+(fk.AppChromeOverrideUtilities.isEnabled?fk.AppChromeOverrideUtilities.EUd:".min")+".js");l||(l=c(f));return l}}this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseManagedScriptResourceLoading&&(b.loadScriptHandler=Object(C.a)(this,
this.loadScript,"loadScript"));return new Fl(new dynamicScriptLoader.DynamicScriptLoader(b))}u.AFrameworkApplication.fa.ka("EnableDefaultDSLImpl")||b.FUe&&b.FUe(Object(C.a)(this,this.loadScript,"loadScript"));return new Fl(b)});this.yHg=u.AFrameworkApplication.fa.ka("EarlyLazySprite");this.qIg=u.AFrameworkApplication.fa.ka("RibbonShimmerExperimentEnabled");u.AFrameworkApplication.fa.ka("LoadSLideGridJSEarly")&&Lj.Eic.push("slidegrid");Lj.Eic.push("comment-pane-strings");Lj.Eic.push("sharedcomments");
Lj.Eic.push("floatingcontainermanager")}loadScript(a,b){let c=this.qle;c&&c.isCompleted&&(this.qle=c=null);const f=this.yHg&&Array.contains(Lj.Eic,a),l=u.AFrameworkApplication.fa.ka("BootFilesInDelayScriptFactory")&&Array.contains(Lj.aUk,a)?this.K3.oui(b,Array.contains(Lj.bgh,a),!(this.qIg&&Array.contains(Lj.vUk,a))):this.K3.aPd(b,null,Array.contains(Lj.bgh,a));f||(this.qle=l.R7);return new Promise((w,F)=>{const S=Date.now(),fa=()=>{l.R7.continueWith(xa=>{if(6===xa.status)w(a);else{let Za=String.format("Failed to download the script with identifier: {0} at url: {1}.",
a,b);xa.Ti&&(Za+=" "+xa.Ti.message);F(Error.create(Za))}});za.a.J(540113033,813,50,"LoadScript:: Identifier:{0}, DelayInMs:{1}",a,Date.now()-S);Oi.a.nt(l)};!c||f?fa():c.continueWith(()=>{fa()})})}init(){}dispose(){}}Lj.bgh=["common","powerpoint-ribbon-intl","appChrome"];Lj.Eic="ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");Lj.aUk="common common50 ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");
Lj.vUk=["common","appchrome"];Object(e.a)(Lj,"DynamicScriptLoaderPackage",null,[2,3]);var hm=d(163),Mf=d(95),im=d(626),$b=d(53),Cf;(function(a){a[a.unknown=0]="unknown";a[a.orderlyShutdown=1]="orderlyShutdown";a[a.bootIncomplete=2]="bootIncomplete";a[a.podSessionRefreshed=3]="podSessionRefreshed";a[a.seamlessFailoverManager=4]="seamlessFailoverManager";a[a.inlineDocumentRepair=5]="inlineDocumentRepair"})(Cf||(Cf={}));Object(e.b)("RefreshDocTrigger",Cf);var Kc=d(40),kf=d(85);class Gl extends Sys.EventArgs{constructor(a,
b){super();this.zKj=b}}Object(e.a)(Gl,"FailoverEventArgs",Sys.EventArgs,[]);var Mj=d(239),Zf=d(107);class Hg extends Zf.a{constructor(a){super();this.FailedMachineId=null;this.FailedMachineId=a}Lk(){return 61}}Object(e.a)(Hg,"CheckUnblockUIRequest",Zf.a,[]);var jm=d(851),aa=d(28);class bj{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He){this.hka=!1;this.kua=this.D1c=this.fEa=this.lEa=this.NS=this.nq=null;this.la=a;this.Bb=b;this.H4j=c;this.Df=f;this.sa=l;this.Ga=w;this.gF=F;
this.rXc=kc;this.R$a=Hc;this.Zl=S;this.oXj=fa;this.ua=xa;this.Wb=Za;this.B3=pb;this.ee=Mb;this.Wd=hc;this.hEa=Ec;this.ia=Dc;this.TB=Td;this.lp=we;this.$Ua=Pd;this.Xi=He;this.oZj=this.la.podsFailoverRefreshDocSlideDrawTimeoutInMS;this.W1j=this.la.podsLegacyFailoverRefreshDocSlideDrawTimeoutInMS}wb(){this.ia.ra(aa.a.WDb,$b.a.application,Object(C.a)(this,this.dHk,"refeshDoc"),64)}dHk(a,b,c,f,l){this.bRe(l.failedMachineId,l.isPlanedShutdown,"podSessionId"in l?l.podSessionId:"","isPodSessionRefreshed"in
l&&l.isPodSessionRefreshed?3:"fromSeamlessFailoverManager"in l?4:"fromInlineDocumentRepair"in l?5:0);return 32}get Gi(){return this.Wb.Gi}dBa(a){a.NOc()&&a.dBa()}bRe(a,b,c,f){if(!this.ee.kd.hermesFailOverImprovementIsEnabled||this.R$a())return!1;if(this.hka||this.hEa.yrg)return!0;const l=this.Gi;if(!(l&&l.Ai&&l.Ai.qx&&l.Ai.qx.id!==Fa.a.nil&&l.contentReplicator&&this.ua.presentation&&this.ua.presentation.id.equals(im.a.Jwe)))return!1;5===f&&this.wzf();this.Zl.pause();this.B3.suspend();this.gF.Jd&&
this.gF.Jd.endEditing(!1,14);this.gF.forEach(Object(C.a)(this,this.dBa,"ensureGraphUpdated"));l.uV(!0)&&l.Ama();this.sa.setSelection(null);this.Ga.Bd();this.nq=Kc.a.Nm("RefreshDoc");this.nq.Ya("IsPlanedShutdown",b.toString());this.nq.Ya("PodSessionId",c);this.nq.Ya("RefreshDocTrigger",Cf[f]);za.a.J(512360801,809,50,"DocRefreshHandler::TryRefreshDoc:ActionID:{0}; ActionDetails:{1}",this.nq.actionId,this.nq.dIb());this.NS=a;b?(this.lEa=new Date,this.hEa.yoh(),this.rXc.Hb(this.nOd())):this.E$g();this.TB.y8g(new Gl(b,
!1));this.ua.presentation.JEe();this.Df.blockContent(this.ua.presentation,"RefreshDoc",!0);za.a.J(512360798,822,15,"DocRefreshHandler::TryRefeshDoc, Block Presentation");this.Wd.disabled=!0;return this.hka=this.ee.UPa().O6c=!0}wzf(){this.Zl.isPaused&&(za.a.J(512360797,801,50,"DocRefreshHandler::ActivateReplicationScheduler:  ReplicationScheduler was paused - UnPaused it"),this.Zl.UYa());try{this.Zl.LKf()}catch(a){za.a.J(512360796,801,15,"DocRefreshHandler::ActivateReplicationScheduler CancelBlockedOperation failed. {0}",
a)}}nOd(){return this.fEa=new Mj.a(new Hg(this.NS),Object(C.a)(this,this.fue,"onCheckUnBlockUISuccess"),Object(C.a)(this,this.eue,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}E$g(){this.nq.Ya("FailedMachineId",this.NS);this.D1c=new Date;this.H4j.WDb(this.NS,this.nq,!this.ee.kd.refreshDocSynchronouslyIsEnabled,!1,Object(C.a)(this,this.wGi,"docRefreshSuccessCallback"),Object(C.a)(this,this.vGi,"docRefreshFailedCallback"));this.oXj.bva()}fue(){this.hEa.aPc();this.nq.Ya("DeploymengUIBlockingTime",
(+new Date-+this.lEa).toString());this.nq.Ya("CheckUnblockUISucceeded","True");this.E$g()}eue(a){if(142===a.ServerError.Code)return za.a.J(512360795,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.NS,+new Date-+this.lEa),this.rXc.Hb(this.fEa),!0;this.nq.Ya("DeploymengUIBlockingTime",(+new Date-+this.lEa).toString());this.nq.Ya("CheckUnblockUISucceeded","False");this.hEa.aPc();return this.Bve(a)}wGi(){this.lp.hGd(Object(C.a)(this,this.Ove,
"onSlideDrawComplete"));this.kua&&this.Bb.ah(this.kua);const a=this.nq.jJ("RefreshDocTrigger");this.kua=new Se.a(2,1,a&&1===a.length&&"podSessionRefreshed"===a[0]?this.oZj:this.W1j,Object(C.a)(this,this.onSlideDrawTimeout,"onSlideDrawTimeout"),90,"62");this.Bb.Hb(this.kua);a&&1===a.length&&"inlineDocumentRepair"===a[0]&&this.wzf()}vGi(a){return this.Bve(a)}A9g(){this.nq.Ya("ReStoreStatusAfterRefreshStartTime",Kc.a.Ve(new Date));this.Zl.UYa();this.B3.resume();this.nq.Ya("LoadAndRenderTime",(+new Date-
+this.D1c).toString());this.ee.kd.Obd||this.ee.UPa().Hla();this.nq.Ya("ReStoreStatusAfterRefreshEndTime",Kc.a.Ve(new Date));this.V7c(!0);u.AFrameworkApplication.MWa(kf.a.Fh(180),hm.a.unknown,hm.a.KIb);Mf.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null)}DXg(a){return this.Bve(a)}Ove(){Z.ULS.sendTraceTag(512360794,821,50,"DocRefreshHandler::OnSlideDrawComplete");this.kua&&(this.Bb.ah(this.kua),this.kua=null);this.lp.vcd(Object(C.a)(this,this.Ove,"onSlideDrawComplete"));
this.nq&&(this.nq.Ya("ReStoreStatusAfterRefreshStartTime",Kc.a.Ve(new Date)),this.B3.resume(),this.nq.Ya("SlideDrawResult","True"),this.nq.Dm("SlideDrawCompleteET",new Date),this.Zl.isPaused&&this.Zl.UYa(),this.nq.Ya("LoadAndRenderTime",(+new Date-+this.D1c).toString()),this.ee.kd.Obd||this.ee.UPa().Hla(),this.nq.Ya("ReStoreStatusAfterRefreshEndTime",Kc.a.Ve(new Date)),this.V7c(!0),this.$Ua.M8g(new jm.a("DocRefresh")),this.Xi.Ihb=2,u.AFrameworkApplication.MWa(kf.a.Fh(180),hm.a.unknown,hm.a.KIb),Mf.Health.instance.recordQosError("AppRebooted",
["UnexpectedAppRefresh"],!1,!1,!0,!1,null))}onSlideDrawTimeout(){this.lp.vcd(Object(C.a)(this,this.Ove,"onSlideDrawComplete"));this.kua&&(this.Bb.ah(this.kua),this.kua=null);Z.ULS.sendTraceTag(512360793,821,10,"DocRefreshHandler::OnSlideDrawTimeout");this.nq.Ya("SlideDrawResult","False");this.V7c(!1);this.UPk()}UPk(){this.Wd.disabled=!1;u.AFrameworkApplication.zo(kf.a.Fh(379));Mf.Health.instance.recordQosError("RefreshDocTimeout",["UnexpectedAppRefresh"],!1,!1,!0,!0,null);u.AFrameworkApplication.tu&&
u.AFrameworkApplication.tu.Q6();this.ia.Ma(aa.a.refresh,2,{refreshtrigger:"DocRefreshHandler::ReportErrorAndRefreshPage"})}Bve(a){Z.ULS.sendTraceTag(512360792,821,50,"DocRefreshHandler:OnRefreshFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Oh);this.V7c(!1);return!1}V7c(a){this.hka=!1;this.fEa=this.NS=null;this.D1c=new Date(0);Kc.a.k5b=new Date;this.nq&&
(this.nq.Ya("Result",a?"Success":"Failed"),this.nq.finish(!0),this.nq=null);this.Wd.disabled=!1;this.ee.UPa().O6c=!1;this.Df.mJ(this.ua.presentation)}}Object(e.a)(bj,"DocRefreshHandler",null,[1332]);var tj=d(152);class Vj{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.hka=!1;this.fEa=this.lEa=this.NS=this.nq=null;this.ia=a;this.Yh=b;this.Vh=c;this.Df=f;this.sa=l;this.Ga=w;this.Zl=F;this.ua=S;this.B3=fa;this.hEa=xa;this.Za=Za;this.la=pb;this.R$a=Mb;this.la.hsg&&this.Vh.wB(Object(C.a)(this,this.ZA,
"onSessionEnd"))}wb(){this.ia.ra(aa.a.failover,$b.a.application,Object(C.a)(this,this.fjj,"handleFailover"),64)}ZA(){this.Zl.isPaused||this.Zl.pause()}fjj(a,b,c,f,l){if(1===c||this.R$a()||this.hka||this.hEa.yrg)return 32;this.NS=l;if(!this.NS)return 8;this.nq=Kc.a.Nm("SeamlessFailover");this.Zl.pause();this.B3.suspend();this.sa.setSelection(null);this.Ga.Bd();this.Df.blockContent(this.ua.presentation,"SeamlessFailover",!0);za.a.J(37106114,822,15,"SeamlessFailoverHandler::HandleFailover, Block Presentation");
this.lEa=new Date;this.hEa.yoh();this.Vh.y8g(new Gl(!0,!0));u.AFrameworkApplication.pqb();this.Yh.Syc(this.nOd());this.hka=!0;return 32}nOd(){return this.fEa=new Mj.a(new Hg(this.NS),Object(C.a)(this,this.fue,"onCheckUnBlockUISuccess"),Object(C.a)(this,this.eue,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}fue(){this.hEa.aPc();this.nq.Ya("DeploymengUIBlockingTime",(+new Date-+this.lEa).toString());this.nq.Ya("CheckUnblockUISucceeded","True");this.nq.Ya("FailedMachineId",this.NS);
this.Za.Lqb=this.NS;this.A9g()}eue(a){if(142===a.ServerError.Code)return za.a.J(22315610,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.NS,+new Date-+this.lEa),this.Yh.Syc(this.fEa),!0;this.nq.Ya("DeploymengUIBlockingTime",(+new Date-+this.lEa).toString());this.nq.Ya("CheckUnblockUISucceeded","False");this.hEa.aPc();return this.ihk(a)}A9g(){this.nq.Ya("ReStoreStatusAfterRefresh",Kc.a.Ve(new Date));this.Zl.UYa();this.B3.resume();this.eXg(!0);
u.AFrameworkApplication.MWa(kf.a.Fh(180),hm.a.unknown,hm.a.KIb);Mf.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null)}ihk(a){Z.ULS.sendTraceTag(22315611,821,50,"SeamlessFailoverHandler:OnFailoverFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Oh);this.eXg(!1);a.ServerError=Object.assign(new tj.a,{Code:157,Source:0});
return!1}eXg(a){this.hka=!1;this.fEa=this.NS=null;this.nq&&(this.nq.Ya("Result",a?"Success":"Failed"),this.nq.finish(),this.nq=null);this.Df.mJ(this.ua.presentation)}dispose(){this.la.hsg&&this.Vh.aea(Object(C.a)(this,this.ZA,"onSessionEnd"))}}Object(e.a)(Vj,"SeamlessFailoverHandler",null,[109]);var Xh=d(244),hf=d(102),gk=d(1108),Ii=d(285),nn=d(807),Ji=d(238),Sl=d(611);class wm{constructor(a,b,c,f,l){if(!a)throw Error.argumentNull("actionManager");this.ia=a;this.la=b;this.h8=c;this.QA=f;this.kc=l;
this.L$a=!1}Iu(a,b=!1,...c){this.lXb.apply(this,[kf.a.Fh(a),this.h8.KMc(a),this.h8.w1d(a),this.h8.WZd(a),b].concat(c))}lXb(a,b,c,f,l=!1,...w){if(!Xh.a.zw){var F=2,S=!1;if(a===kf.a.Fh(83))this.la.fLj&&(c=ResourceStrings.l_CannotPasteImageTitle,f=ResourceStrings.l_SuggestionToInsertPicture,F=3);else if(a===kf.a.Fh(8)||a===kf.a.Fh(256)||a===kf.a.Fh(257)||a===kf.a.Fh(291))F=0,S=!0;w&&0<w.length&&(f=String.format.apply(null,[f].concat(w)));this.Ns(new Sl.a(a,c,f,b,F),l,S)}}Ns(a,b=!1,c=!1){let f=a.Jbd;
var l=kf.a.tS(a.Gm)?Ji.a[kf.a.GM(a.Gm)]:"";za.a.J(8959649,801,15,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}; ErrorName: {1}, SuppressErrorReporting: {2}, ShowFeedbackButtonEnabled: {3}, ClientActions - None: {4}, Dismiss: {5}, Close: {6}, OpenInClient: {7}, Refresh: {8}, HideFeedback: {9}, Repair: {10}",a.Gm,l,b,u.AFrameworkApplication.WD,0===f,!!(f&1),!!(f&2),!!(f&4),!!(f&8),!!(f&16),!!(f&64));if(this.p8k(a))za.a.J(23206027,801,50,"ErrorDialog::ShowErrorDialog Skip showing error {0} to users.",
a.Gm);else{l=new hf.StandardDialog;var w=null,F=!1,S=this.kc.ka("UserCanWriteRelative");f&64&&za.a.J(41964865,801,50,"ErrorDialog::ShowErrorDialog. User's Access level:{0}",this.kc.Ia("DocumentPermissions")||"");var fa=!1;f&64&&this.la.pptFileRecoveryEnabled&&(fa=!0);f&64&&!S&&za.a.J(42858654,801,50,"ErrorDialog::ShowErrorDialog. We found a repairable error but user has no permission to write relative, but inline repair is enabled. Will try to repair.");!fa&&f&64&&(c=!1,f=this.Arl(a));S=!!(f&4)&&
!(u.AFrameworkApplication.twh||u.AFrameworkApplication.XP);var xa=!!(f&2)&&u.AFrameworkApplication.Sba;c=c?ResourceStrings.l_OpenInApp:ResourceStrings.L_OpenInPowerPoint;l.Zq=xa||!!(f&1);f&8?(l.vd=0,w=Object(C.a)(this,this.Qbd,"refreshActionHandler"),Array.contains(this.la.hermesRefreshErrorSuppressionList,a.Gm.toString())?l.nO(gk.a.e2(a.title),gk.a.e2(a.message),w):(za.a.J(17687751,801,50,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}.",a.Gm),l.Pe(1,ResourceStrings.L_Refresh),l.Sx(a.Gm,gk.a.e2(a.title),
gk.a.e2(a.message),w,b)),F=this.L$a=!0):fa?(za.a.J(25011905,801,50,"ErrorDialog::ShowErrorDialog. We met an error need to repair. ErrorCode: {0}",a.Gm),this.ia.processAction(aa.a.repair,2)):xa&&S?(l.vd=4,l.Pe(1,c),l.Pe(2,ResourceStrings.L_Close),w=Object(C.a)(this,this.Ynk,"openOrCloseActionHandler"),this.L$a=!0):S?(l.vd=0,l.Pe(1,c),w=Object(C.a)(this,this.H8c,"openInClientActionHandler"),this.L$a=!0):xa?(l.vd=0,l.Pe(1,ResourceStrings.L_Close),w=Object(C.a)(this,this.umi,"closeActionHandler"),this.L$a=
!0):(c=!!(f&1)||0===f,l.Zq=c,l.vd=c?0:5);F||fa||(f&16&&f&32?(b||u.AFrameworkApplication.zo(a.Gm),l.YXa=!1,l.Tw(gk.a.e2(a.title),gk.a.e2(a.message),a.icon,w)):l.Sx(a.Gm,gk.a.e2(a.title),gk.a.e2(a.message),w,b));this.L$a&&this.QA&&this.QA.closeSession(4);this.L$a?Mf.Health.instance.recordQosError(kf.a.y6(a.Gm),["NonDismissibleDialog"],!1,!1,!0,!0,null):Mf.Health.instance.recordQosError(kf.a.y6(a.Gm),["DismissibleDialog"],!1,!1,!0,!1,null)}}get zSc(){return this.L$a}Arl(a){za.a.J(42858658,801,15,"ErrorDialog::UpdateErrorWhenRepairDisabled. We found a repairable error but user has no permission to repair. Falling back to generic error dialog.");
a.message=a.Gm===kf.a.Fh(8)||a.Gm===kf.a.Fh(43)?ResourceStrings.errorMessage_EditSlideCorruption:ResourceStrings.errorMessage_CannotOpenDocument;a.title=ResourceStrings.errorTitle_PowerpointStandard;a.icon=2;return 6}H8c(a,b){za.a.J(20460490,801,50,"Button={0};DontShowAgain={1}",a,b);1===a&&this.k6g()}Ynk(a,b){za.a.J(20460492,801,50,"Button={0};DontShowAgain={1}",a,b);1===a?this.k6g():this.ia.Ma(aa.a.Yqb,2,Ii.c)}umi(a,b){za.a.J(20460494,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.Ma(aa.a.Yqb,
2,Ii.c)}Qbd(a,b){za.a.J(20460496,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.Ma(aa.a.refresh,2,{refreshtrigger:"ErrorDialog::RefreshActionHandler"})}k6g(){(new nn.a(D.a.openInClient)).R6d()}p8k(a){return a.Gm===kf.a.Fh(83)&&(u.AFrameworkApplication.oN("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorCannotPastePictureNotFoundSettings"),this.la.mbl)||a.Gm===kf.a.Fh(56)&&(u.AFrameworkApplication.oN("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorLocalChangeLostCoauthSettings"),this.la.nbl)?
!0:!1}}Object(e.a)(wm,"ErrorDialog",null,[1330]);var Xi=d(279),Xe=d(125),Qm=d(508),Rm=d(967),qd=d(42);class il extends Sys.EventArgs{constructor(){super();this.cAa=this.$C=0;this.message=this.title=null}}Object(e.a)(il,"BeforeHandleErrorEventArgs",Sys.EventArgs,[]);class Sm extends il{constructor(a){super();this.Z4a=null;this.errorCode=a;this.$C=0}}Object(e.a)(Sm,"OnBeforeHandleClientErrorEventArgs",il,[]);class Vk extends il{constructor(){super();this.$C=0}}Object(e.a)(Vk,"OnBeforeHandleServerErrorEventArgs",
il,[]);class L extends Sys.EventArgs{constructor(a,b,c){super();this.LN=a;this.hZj=b;this.oh=c}get podSessionId(){return this.LN}get sIc(){return this.hZj}get errorCode(){return this.oh}}Object(e.a)(L,"PodSessionUnavailableEventArgs",Sys.EventArgs,[]);var ba=d(52);class Sa{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc){this.eje=!1;this.l_j=[8];this.xje={["Generic"]:CommonUIStrings.l_DecryptSkipReasonGeneric,["DecryptionDefered"]:CommonUIStrings.l_DecryptSkipReasonDecryptionDefered,["EncryptedOutsideSharepoint"]:CommonUIStrings.l_DecryptSkipReasonEncryptedOutsideSharepoint,
["UnsupportedMsoDataStore"]:CommonUIStrings.l_DecryptSkipReasonUnsupportedMsoDataStore,["PasswordProtected"]:CommonUIStrings.l_DecryptSkipReasonPasswordProtected,["ContentExpiryLabel"]:CommonUIStrings.l_DecryptSkipReasonContentExpiryLabel,["InvalidLabelOwner"]:CommonUIStrings.l_DecryptSkipReasonInvalidLabelOwner,["DeletedLabel"]:CommonUIStrings.l_DecryptSkipReasonDeletedLabel,["LabelProtectionChanged"]:CommonUIStrings.l_DecryptSkipReasonLabelProtectionChanged,["UnsupportedLabel"]:CommonUIStrings.l_DecryptSkipReasonLabelUnsupportedLabel,
["DoubleKeyDisabled"]:CommonUIStrings.l_DecryptSkipReasonLabelDoubleKeyDisabled};this.disabled=!1;this.h8=a;this.g8=b;this.ql=c;this.RDg=f;this.ia=l;this.Za=w;this.kc=F;this.Rb=S;this.Zyb=fa;this.G0e=!1;this.Zl=xa;this.QA=Za;this.so=Mb;this.sj=hc;this.ee=pb}Mr(a,b,c=null,f=!1){if(this.disabled)return Z.ULS.sendTraceTag(20456412,804,50,"Ignore server error {0}",a?a.Code:315),!0;this.QA.U8j();if(this.QA.I7)return Z.ULS.sendTraceTag(34403099,804,15,"GlobalErrorHandler:HandleServerError - Ignore server error since session is already closed. ErrorCode:{0}",
a?a.Code:315),!0;let l=!1,w=0,F=0,S=null;var fa=null;c&&(fa=new Vk,l=c(fa),w=fa.$C,F=fa.cAa,S=fa.title,fa=fa.message);l||(l=this.Rmj(a,b));l||(b=a?a.Code:315,a=a?a.ExtraErrorParam:null,this.dNi(b)&&(this.G0e=!0,this.Zl.pause()),a?this.Sx.apply(this,[w,b,F,S,fa,f].concat(a)):this.Sx(w,b,F,S,fa,f));return l}Rmj(a,b){if(!a)return!1;Z.ULS.sendTraceTag(20841093,821,15,"{0} - Error Code:{1} Source:{2} ExtraParam:{3}","GlobalErrorHandler:HandleServerErrorInternal",a.Code,a.Source,a.ExtraErrorParam?a.ExtraErrorParam.join(","):
"empty");if(153===a.Code)return Xi.a.instance.XBe(Date.now()),Xi.a.qVc(u.AFrameworkApplication.userSessionId),u.AFrameworkApplication.MWa(kf.a.Fh(153),hm.a.unknown,hm.a.KIb),({vPe:c}=Xi.a.instance.Pwh()).returnValue&&Z.ULS.sendTraceTag(18970263,804,50,"{0} - Data Center Redirect - Time duration from user launch browser to redirection starting {1}","GlobalErrorHandler:HandleServerErrorInternal",(new Date).getTime()-c),a.ExtraErrorParam?this.XGk(a.ExtraErrorParam[0]):Z.ULS.sendTraceTag(593884575,804,
10,"{0} - Data Center Redirect missing RedirectUrl","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(142===a.Code&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length)return(2===a.ExtraErrorParam.length?32===this.ia.Ma(aa.a.failover,2,a.ExtraErrorParam[0]):this.RDg.bRe(a.ExtraErrorParam[0],!0,this.Za.podSessionId||"",1))||this.Sx(0,157,0,null,null),!0;if(274===a.Code)return Z.ULS.sendTraceTag(23667403,804,10,"{0} - Pods session is locked for edit/merge. Local change could be lost","GlobalErrorHandler:HandleServerErrorInternal"),
!0;if(4===a.Code&&this.so.instance&&!Ja.a.Xa(this.Za.MIc))return Z.ULS.sendTraceTag(50422163,801,15,"Triggering rehydration for password files from GlobalErrorHandler"),this.so.instance.lQe(!1,0,a.Code),!0;if(157===a.Code&&2===a.Source&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length){var c=1<a.ExtraErrorParam.length?a.ExtraErrorParam[1]:"";return this.kc.ka(ba.a.pa(685))&&c.toLowerCase()!==this.Za.podSessionId.toLowerCase()?(za.a.J(38098833,801,15,"{0} - Replication cache request boot incomplete failures were ignored, ServerReturnPodSessionSeed: {1}; SessionInfoSeed: {2}.",
"GlobalErrorHandler:HandleServerErrorInternal",c,b),!0):this.kc.ka(ba.a.pa(884))&&this.eje?(za.a.J(40126162,801,15,"{0} - Ignore bootIncomplete error after SaveAndClose( ReleaseLock=true ).","GlobalErrorHandler:HandleServerErrorInternal"),!0):this.RDg.bRe(a.ExtraErrorParam[0],!1,this.Za.podSessionId||"",2)}if(223===a.Code||285===a.Code||362===a.Code||this.kc.ka(ba.a.pa(560))&&229===a.Code||this.kc.ka(ba.a.pa(914))&&this.so.instance&&this.so.instance.KNi(a.Code)){if(b!==this.Za.podSessionId)return za.a.J(25703619,
801,15,"{0} - PodSessionId mismatch, skip failover signal. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Za.podSessionId),!0;if(this.kc.ka(ba.a.pa(914))&&this.so.instance&&this.so.instance.XY)return za.a.J(41763677,801,15,"{0} - SeamlessFailover is ongoing. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Za.podSessionId),!0;za.a.J(36480031,801,15,"{0} - RaisePodSessionUnavailableEvent, serverErrorCode:{1};",
"GlobalErrorHandler:HandleServerErrorInternal",a.Code);this.Zyb.ZCk(new L(this.Za.podSessionId,!!a.ExtraErrorParam&&!!a.ExtraErrorParam.length&&"PodsOrderlyShutdown"===a.ExtraErrorParam[0],a.Code));return!0}if(389===a.Code||292===a.Code&&3===a.Source)return a=this.Rb.notificationBar.NNa(ResourceStrings.L_DeepLinking_BootSlideNotFound,!1),this.kc.ka("IsAutomation")?a.displayTimeoutSeconds=this.kc.Gc("PodDeepLinkingToastMessageDisplayTimeMsForAutomation",a.displayTimeoutSeconds)/1E3:za.a.J(34390043,
804,15,"{0} - Deep link - Slide not found","GlobalErrorHandler:HandleServerErrorInternal"),this.Rb.notificationBar.ai(a),!0;if(238===a.Code&&this.kc.ka(ba.a.pa(561))&&this.so.instance&&this.so.instance.XY)return za.a.J(36517720,801,50,"{0} - SessionBootInProgress during seamless failover, skipped","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(329===a.Code)return za.a.J(37004683,801,15,"{0} - PreconditionFailed error due to host integration ID mismatch, silent fail","GlobalErrorHandler:HandleServerErrorInternal"),
this.Lph(a.Code,null),!0;if(104===a.Code)return b=2===this.sj.Waa,a.Code=b?56:105,za.a.J(37591071,801,15,"{0} - LocalChangeLost seen when user is {1}. Returning {2}.","GlobalErrorHandler:HandleServerErrorInternal",b?"co-authoring":"alone",Ji.a[a.Code]),this.Sx(0,a.Code,0,null,null),!0;if(this.lBj(a.Code)&&2!==this.kc.state)return za.a.J(38082183,801,15,"{0} - Skip check file error if it under retry","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(117===a.Code){if((b=a.ExtraErrorParam)&&2===
b.length&&"GB"===b[1])return this.Sx.apply(this,[0,a.Code,0,null,ResourceStrings.errorMessage_CannotOpenDocumentTooLargeGB,!1].concat(b)),!0}else if(432===a.Code)return this.Sx.apply(this,[1,a.Code,8,null,ResourceStrings.errorMessage_UserNetworkLocationUnauthorized,!1].concat(a.ExtraErrorParam)),!0;return!1}YH(a,b){if(this.disabled)return Z.ULS.sendTraceTag(20456413,804,50,"Ignore client error {0}",a),!0;let c=!1,f=0,l=0,w=null,F=null;var S=null;b&&(S=new Sm(a),c=b(S),f=S.$C,l=S.cAa,w=S.title,F=S.message,
S=S.Z4a);c||(c=!1);c||(S?this.Sx.apply(this,[f,a,l,w,F,!1].concat(S)):this.Sx(f,a,l,w,F));return c}Sx(a,b,c,f,l,w=!1,...F){0===a&&(a=this.h8.T8i(b));0===c&&(c=this.h8.KMc(b));f||(f=this.h8.w1d(b));l||(3===b&&this.kc.ka("DecryptSkipReasonIRMErrorEnabled")?l=this.D_i():(za.a.J(520733894,801,50,"GlobalErrorHandler::ShowError errorCode != ErrorCannotOpenDocumentIRM"),l=this.h8.WZd(b)));const S=()=>{this.L9k.apply(this,[a,b,c,f,l,w].concat(F))};2===this.kc.state?S():this.kc.gf(S)}D_i(){za.a.J(520734802,
801,50,"GlobalErrorHandler::GetDetailedIRMError DecryptSkipReason = "+u.AFrameworkApplication.NWb);return u.AFrameworkApplication.NWb&&this.xje[u.AFrameworkApplication.NWb]?this.xje[u.AFrameworkApplication.NWb]:this.xje.Generic}L9k(a,b,c,f,l,w,...F){if(2===a){let S;(S=this.ql).lXb.apply(S,[b,c,f,l].concat(F))}else 3===a?this.Lph.apply(this,[b].concat(F)):this.tqa.apply(this,[kf.a.Fh(b),c,f,l,w].concat(F))}tqa(a,b,c,f,l,...w){0===b&&(b=this.h8.KMc(kf.a.GM(a)));if(Rm.GraphSpaceRootReplicator.tvg(kf.a.GM(a))&&
w&&0<w.length){this.Za.Ocd=w[0];var F=new Ua.a;for(var S=1;S<w.length;S++)F.add(w[S]);w=F.toArray()}F=Object.assign(new Qm.a,{Type:6,Token:this.ee.kd.Kec,Data:{["Reason"]:"FatalError",["ErrorName"]:kf.a.y6(a)}});qd.a("PPT.BootstrapperMessageNewValues")&&(F.MessageId=Xe.a.mzh,S={Reason:"FatalError"},S.ErrorName=F.Data.ErrorName,F.Values=S);window.parent.postMessage(md.c(F),"*");Z.ULS.sendTraceTag(38125666,804,15,"GlobalErrorHandler:DisplayErrorDialog: {0}",a);let fa;(fa=this.g8).lXb.apply(fa,[a,b,
c,f,l].concat(w))}XGk(a){id.a.openWindow(1,a)}get qia(){return this.eje}set qia(a){this.eje=a;za.a.J(40126173,801,50,"GlobalErrorHandler::IgnoreBootIncompleteFailure is set to {0}",a)}get NSd(){return this.G0e}eGd(){}xGd(){}Lph(a,...b){const c=kf.a.Fh(a);za.a.J(20756238,801,50,"GlobalErrorHandler::SilentFail BSQMErrorCode: {0}; ErrorCode:{1}, ErrorParams:{2}",c,a,b?b.join(","):"");u.AFrameworkApplication.zo(c);Mf.Health.instance.recordQosError(kf.a.y6(c),["SilentFailure"],!1,!0,!0,!1,null)}lBj(a){return 288===
a||300===a||301===a||302===a||303===a?!0:!1}dNi(a){return Array.contains(this.l_j,a)?!0:!1}}Object(e.a)(Sa,"GlobalErrorHandler",null,[1333,1378]);class sb{constructor(a){this.x7b=!1;this.EW=null;this.Hs=a}get yrg(){return this.x7b}yoh(){var a=ResourceStrings.errorTitle_PowerpointEditingStandard,b=ResourceStrings.errorMessage_BlockUIUnderDeployment;this.x7b||(this.EW=new Yc.a,this.EW.vd=5,this.EW.message=gk.a.e2(b),this.EW.Zq=!1,za.a.J(22315662,822,50,"Showing UI blocking dialog to prompt user we are deploying"),
this.EW.Rma(gk.a.e2(a),null,null),this.x7b=!0,this.Hs.jHf(!0))}aPc(){this.x7b&&(this.EW.hide(),this.x7b=!1,this.EW=null,this.Hs.jHf(!1))}}Object(e.a)(sb,"DeployingDialog",null,[1328]);var Tb=d(976),Tc=d(423),Vb=d(632),Ed=d(409),ae=d(164),Rd=d(64),pe=d(879);class ff{constructor(a,b,c,f,l,w,F){this.vca=this.Te=this.Bxb=this.k8b=null;this.fYc=!1;this.vYc=this.g3c=this.cWc=null;this.hka=!1;this.ua=a;this.Wb=b;this.kq=c;this.Ub=f;this.rXc=l;this.gEg=w;this.so=F}get Gi(){return this.Wb.Gi}WDb(a,b,c,f,l,
w){this.hka||(this.hka=!0,this.fYc=c,this.Te=b,this.g3c=l,this.vYc=w,this.so.instance&&this.so.instance.REd("abortedOnRefreshDoc"),this.gEg&&this.gEg(),this.rXc.Hb(this.fyi(a,f)))}fyi(a,b){let c=this.ua.Ca&&!Rd.a.DA(this.ua.Ca.Cb)?this.ua.Ca.Cb:Rd.a.empty;c=b?Rd.a.empty:c;this.Te.Ya("CurrentActiveSlideId",c.toString());this.cWc=Rd.a.DA(c)?Rd.a.empty:c;return new Mj.a(new pe.a(c,a),Object(C.a)(this,this.Chk,"onGetCellSuccess"),Object(C.a)(this,this.DXg,"onGetCellFailed"),Object(C.a)(this,this.qwl,
"validateResponse"))}qwl(a){return!a.ServerError&&0===a.StatusCode&&a&&a.Cells&&a.Cells.length?(a=a.Cells[a.Cells.length-1])&&a.RevisionList?0<a.RevisionList.length:!1:!1}Chk(a){this.Te.Ya("GetCells",a.Oh);a=new Tb.a(null,Object(C.a)(this,this.Wsj,"inboundSetup"),a);a.Ui=!this.fYc;a.vl("RefreshUIOperation");a.run()}DXg(a){this.Te.Ya("GetCells",a.Oh);200!==a.HttpStatusCode&&this.Te.Ya("GetCellsHttpStatusCode",a.HttpStatusCode.toString());if(this.vYc&&this.vYc(a))return!0;a.ServerError=Object.assign(new tj.a,
{Code:294,Source:0});Mf.Health.instance.recordQosError("RefreshDocFailed",["UnexpectedAppRefresh"],!1,!0,!0,!0,null);return!1}Wsj(a,b){(this.vca=this.Wb.Xm)&&this.vca.bM&&this.vca.bM.DVc();this.vca&&this.vca.Po&&(this.vca.bM=new Vb.a(cg.a.instance,"FailoverView"));this.Te.Ya("InboundSetupStartTime",Kc.a.Ve(new Date));const c=b.Cells[b.Cells.length-1],f=this.Gi.Ai.qx.id;c.RevisionList[0].BaseId=ae.a(f);this.Wb.Ca=null;this.k8b=new Tc.a(c,f,!1,new Date,b.Oh,!1,!1,!1);this.Bxb=this.kq.ie(3);this.Bxb.hd(this.ua.presentation);
this.fYc&&this.Bxb.JT(a);a.Wg(Object(C.a)(this,this.sia,"inboundIncrementally"));this.Te.Ya("InboundSetupEndTime",Kc.a.Ve(new Date));return!0}sia(a){this.Te.Ya("InboundIncrementallyStartTime",Kc.a.Ve(new Date));this.Gi.contentReplicator.yCa.sia(this.k8b,new Date);this.k8b.PP&&(this.Bxb.dispose(),a.Wg(Object(C.a)(this,this.FYk,"setActiveSlideAndRender")),this.Bxb=this.k8b=null,this.Te.Ya("InboundIncrementallyEndTime",Kc.a.Ve(new Date)));return!0}FYk(a){this.Te.Ya("SetActiveSlideAndRenderStartTime",
Kc.a.Ve(new Date));a.Wg(Object(C.a)(this,this.wQi,"finishRefreshDoc"));if(Rd.a.empty.equals(this.cWc))return this.Te.Ya("SetActiveSlideAndRenderEndTime",Kc.a.Ve(new Date)),!0;const b=this.Ub.Bk(this.cWc);if(!b)return this.Te.Ya("SetActiveSlideAndRenderEndTime",Kc.a.Ve(new Date)),!0;const c=this.kq.ie(3);try{c.hd(b),this.fYc&&c.JT(a),this.Wb.Ca=b}finally{c&&c.dispose()}this.Te.Ya("SetActiveSlideAndRenderEndTime",Kc.a.Ve(new Date));return!0}wQi(){this.g3c&&this.g3c();this.vca&&this.vca.bM&&(this.vca.bM.DVc(),
this.vca.bM=new Ed.a);this.w4();return!1}w4(){this.hka=!1;this.vYc=this.g3c=this.cWc=this.vca=this.Te=this.Bxb=this.k8b=null}}Object(e.a)(ff,"RefreshDocExecutor",null,[1331]);class eg{WZd(a){switch(a){case 1:a=ResourceStrings.errorMessage_Unknown;break;case 14:a=ResourceStrings.errorMessage_Unknown;break;case 2:a=ResourceStrings.errorMessage_CannotOpenDocumentFileType;break;case 3:a=ResourceStrings.errorMessage_CannotOpenDocumentIRM;break;case 4:a=ResourceStrings.errorMessage_CannotOpenDocumentPassword;
break;case 41:a=ResourceStrings.errorMessage_CannotOpenDocumentGatekeeperFailure;break;case 33:a=ResourceStrings.errorMessage_CannotOpenDocumentMacro;break;case 34:a=ResourceStrings.errorMessage_CannotOpenDocumentFinal;break;case 35:a=ResourceStrings.errorMessage_CannotOpenDocumentSigned;break;case 36:a=ResourceStrings.errorMessage_CannotOpenEmbeddedFonts;break;case 5:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 6:a=ResourceStrings.errorMessage_CannotInstallFonts;break;case 7:a=ResourceStrings.errorMessage_CannotConvertModifyPassword;
break;case 8:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 306:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 9:a=ResourceStrings.errorMessage_CannotComposeSlideUnexpected;break;case 10:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 12:a=ResourceStrings.errorMessage_GenericSlideCorruption;break;case 15:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 16:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 17:a=ResourceStrings.errorMessage_FailedToRenderDocument;
break;case 18:a=ResourceStrings.errorMessage_FailedToRenderSlide;break;case 20:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 21:a=ResourceStrings.errorMessage_InvalidCommand;break;case 22:a=ResourceStrings.errorMessage_DocVersionMismatch;break;case 23:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 58:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 24:a=ResourceStrings.errorMessage_RequiresCheckout;break;case 25:a=ResourceStrings.errorMessage_LockedForOfflineCheckout;
break;case 26:a=ResourceStrings.errorMessage_LockedByAnotherUser;break;case 27:a=ResourceStrings.errorMessage_AccessDenied;break;case 28:a=ResourceStrings.errorMessage_NoLicense;break;case 29:a=ResourceStrings.errorMessage_Unknown;break;case 30:a=ResourceStrings.errorMessage_TextTooBig;break;case 31:a=ResourceStrings.errorMessage_TryAgain;break;case 37:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 32:a=ResourceStrings.errorMessage_Unexpected;break;case 11:a=ResourceStrings.errorMessage_FailedToRetrieveResource;
break;case 13:a=ResourceStrings.errorMessage_FileNotFoundOrPermissionDenied;break;case 38:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 39:a=ResourceStrings.errorMessage_PptEditExistingExclusiveLock;break;case 40:a=ResourceStrings.errorMessage_PptEditCheckedOutByAnother;break;case 42:a=ResourceStrings.errorMessage_EditWorkerTimeout;break;case 43:a=ResourceStrings.errorMessage_EditSlideCorruption;break;case 44:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 45:a=ResourceStrings.errorMessage_ClipartCannotConnect;
break;case 46:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 47:a=ResourceStrings.errorMessage_Unknown;break;case 48:a=ResourceStrings.errorMessage_Unknown;break;case 49:a=ResourceStrings.errorMessage_Unknown;break;case 50:a=ResourceStrings.errorMessage_Unknown;break;case 51:a=ResourceStrings.errorMessage_Unknown;break;case 52:a=ResourceStrings.errorMessage_Unknown;break;case 53:a=ResourceStrings.errorMessage_Unknown;break;case 54:a=ResourceStrings.errorMessage_Unknown;break;case 55:a=
ResourceStrings.errorMessage_CannotOpenODPDocumentPassword;break;case 56:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 57:a=ResourceStrings.errorMessage_NumberOfCoauthorsReachedMax;break;case 59:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 60:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 61:a=ResourceStrings.errorMessage_ImageWrongFormat;break;case 62:a=ResourceStrings.errorMessage_ImageNoAccess;break;case 63:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 64:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 65:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 66:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 67:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 68:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 69:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 70:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 71:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 72:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 73:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 74:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 75:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 76:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 77:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 78:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 79:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 80:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 254:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 255:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 256:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 257:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 258:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 81:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 82:a=ResourceStrings.errorMessage_ClipartCannotDownload;
break;case 83:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 84:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 85:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 86:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 87:a=ResourceStrings.errorMessage_InsertLocalPictureTooLarge;break;case 88:a=ResourceStrings.invalidCanary;break;case 89:a=ResourceStrings.imageUploadRequestError;break;case 90:a=ResourceStrings.invalidImageFileError;break;
case 91:a=ResourceStrings.imageUploadRequestError;break;case 92:a=ResourceStrings.imageUploadRequestError;break;case 93:a=ResourceStrings.imageUploadRequestError;break;case 94:a=ResourceStrings.imageUploadRequestError;break;case 95:a=ResourceStrings.errorMessage_Unknown;break;case 96:a=ResourceStrings.errorMessage_Unknown;break;case 97:a=ResourceStrings.errorMessage_Unknown;break;case 98:a=ResourceStrings.errorMessage_Unknown;break;case 99:a=ResourceStrings.errorMessage_Unknown;break;case 137:a=ResourceStrings.errorMessage_TryAgain;
break;case 100:a=ResourceStrings.errorMessage_Unknown;break;case 101:a=ResourceStrings.errorMessage_Unknown;break;case 102:a=ResourceStrings.errorMessage_Unknown;break;case 103:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 104:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 105:a=ResourceStrings.errorMessage_Unknown;break;case 238:a=ResourceStrings.errorMessage_Unknown;break;case 269:a=ResourceStrings.errorMessage_Unknown;break;case 262:a=ResourceStrings.errorMessage_Unknown;
break;case 288:a=ResourceStrings.errorMessage_Unknown;break;case 268:a=ResourceStrings.errorMessage_Unknown;break;case 315:a=ResourceStrings.errorMessage_Unknown;break;case 237:a=ResourceStrings.errorMessage_Unknown;break;case 228:a=ResourceStrings.errorMessage_Unknown;break;case 233:a=ResourceStrings.errorMessage_Unknown;break;case 231:a=ResourceStrings.errorMessage_Unknown;break;case 230:a=ResourceStrings.errorMessage_Unknown;break;case 426:a=ResourceStrings.errorMessage_Unknown;break;case 19:a=
ResourceStrings.errorMessage_CannotSaveDocument;break;case 106:a=ResourceStrings.errorMessage_FailedToLocalSaveDocument;break;case 107:a=ResourceStrings.errorMessage_NumberOfSessionsPerUserReachedMax;break;case 108:a=ResourceStrings.errorMessage_Unknown;break;case 109:a=ResourceStrings.errorMessage_NullPresentationId;break;case 111:a=ResourceStrings.errorMessage_CannotInsertOnlineVideo;break;case 112:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 143:a=ResourceStrings.errorMessage_InsertOnlinePictureTooLarge;
break;case 113:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 114:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 115:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 116:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 117:a=ResourceStrings.errorMessage_CannotOpenDocumentTooLarge;break;case 118:a=ResourceStrings.errorMessage_StorageOutOfMemory;break;case 141:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 142:a=ResourceStrings.errorMessage_BlockUIUnderDeployment;
break;case 135:a=ResourceStrings.errorMessage_Unknown;break;case 144:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 147:a=ResourceStrings.errorMessage_CannotInsertOnlinePictureNotFound;break;case 148:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 149:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 150:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 151:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 155:a=
ResourceStrings.errorMessage_Unknown;break;case 156:a=ResourceStrings.errorMessage_Unknown;break;case 159:a=ResourceStrings.errorMessage_Unknown;break;case 154:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 157:a=ResourceStrings.errorMessage_TryAgain;break;case 158:a=ResourceStrings.errorMessage_Unknown;break;case 160:a=ResourceStrings.errorMessage_Unknown;break;case 168:a=ResourceStrings.errorMessage_Unknown;break;case 169:a=ResourceStrings.errorMessage_TryAgain;break;case 173:a=
ResourceStrings.errorMessage_TryAgain;break;case 199:a=ResourceStrings.errorMessage_Unknown;break;case 200:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 201:a=ResourceStrings.errorMessage_Unknown;break;case 202:a=ResourceStrings.errorMessage_ClipServicePasteCopyFailed;break;case 203:a=ResourceStrings.errorMessage_Unknown;break;case 204:a=ResourceStrings.errorMessage_Unknown;break;case 205:a=ResourceStrings.errorMessage_Unknown;break;case 206:a=ResourceStrings.errorMessage_Unknown;break;
case 209:a=ResourceStrings.errorMessage_Unexpected;break;case 210:a=ResourceStrings.errorMessage_Unknown;break;case 211:a=ResourceStrings.imageUploadRequestError;break;case 212:a=ResourceStrings.imageUploadTimeoutError;break;case 213:a=ResourceStrings.errorMessage_TryAgain;break;case 214:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 215:a=ResourceStrings.errorMessage_Unknown;break;case 363:a=ResourceStrings.errorMessage_Unknown;break;case 287:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;
break;case 321:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 222:a=ResourceStrings.errorMessage_SlideTooManyShapes;break;case 247:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 275:a=ResourceStrings.errorMessage_DownloadAppSettingsFailed;break;case 244:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 295:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 245:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 246:a=
ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 249:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 250:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 322:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 329:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 243:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 251:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 252:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 242:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 241:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 293:a=ResourceStrings.errorMessage_TryAgain;break;case 294:a=ResourceStrings.errorMessage_TryAgain;break;case 379:a=ResourceStrings.errorMessage_TryAgain;break;case 296:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 297:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 298:a=ResourceStrings.errorMessage_FailedToOpenDocument;
break;case 332:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 354:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 355:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 356:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 357:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 365:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 364:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 358:a=ResourceStrings.errorMessage_FailedToOpenDocument;
break;case 369:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 333:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 299:a=ResourceStrings.imageUploadTimeoutError;break;case 304:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 305:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 308:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 377:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 309:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 325:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 352:a=ResourceStrings.errorMessage_Unknown;break;case 328:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 330:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 331:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 334:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 373:a=ResourceStrings.errorMessage_Unknown;break;case 374:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 384:a=ResourceStrings.errorMessage_ZeroByteFileNotFound;break;case 391:a=ResourceStrings.errorMessage_CannotOpenDocumentWrongPassword;break;case 399:a=ResourceStrings.errorMessage_Unknown;break;case 400:a=ResourceStrings.errorMessage_Unknown;break;case 401:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 402:a=ResourceStrings.errorMessage_CannotInsertStream;
break;case 403:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 404:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 405:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 416:a=ResourceStrings.errorMessage_InsertLocalAudioTooLarge;break;case 418:a=ResourceStrings.errorMessage_InvalidNumberOfAudioFilesError;break;case 417:a=ResourceStrings.errorMessage_InvalidAudioFileError;break;case 422:a=ResourceStrings.errorMessage_EmptyAudioFileError;break;case 419:a=ResourceStrings.errorMessage_AudioUploadRequestError;
break;case 424:a=ResourceStrings.errorMessage_AudioInvalidFileError;break;case 427:a=ResourceStrings.errorMessage_InvalidAudioFileExtension;break;case 433:a=ResourceStrings.errorMessage_Unknown;break;case 434:a=ResourceStrings.errorMessage_Unknown;break;case 435:a=ResourceStrings.errorMessage_Unknown;break;case 440:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 441:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;break;case 442:a=ResourceStrings.errorMessage_UploadedMediaTooLarge;
break;case 443:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;break;case 444:a=ResourceStrings.errorMessage_UploadedMediaNonStandardResponse;break;case 445:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 446:a=ResourceStrings.errorMessage_UploadedMediaInternalError;break;case 447:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;default:a=ResourceStrings.errorMessage_Unknown}return a}w1d(a){switch(a){case 1:a=ResourceStrings.errorTitle_Unknown;
break;case 14:a=ResourceStrings.errorTitle_Unknown;break;case 2:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 3:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 4:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 41:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 33:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 34:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 35:a=ResourceStrings.errorTitle_PowerpointStandard;break;
case 36:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 5:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 6:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 7:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 8:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 306:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 9:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 10:a=ResourceStrings.errorTitle_WacStandard;break;case 12:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 15:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 16:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 17:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 18:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 20:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 21:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 22:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 23:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 58:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 24:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 25:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 26:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 27:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 28:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 29:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 30:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 31:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 37:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 32:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 11:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 13:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 38:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 39:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 40:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 42:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 43:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 44:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 45:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 46:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 47:a=ResourceStrings.errorTitle_Unknown;break;case 48:a=ResourceStrings.errorTitle_Unknown;break;case 49:a=ResourceStrings.errorTitle_Unknown;break;case 50:a=ResourceStrings.errorTitle_Unknown;
break;case 51:a=ResourceStrings.errorTitle_Unknown;break;case 52:a=ResourceStrings.errorTitle_Unknown;break;case 53:a=ResourceStrings.errorTitle_Unknown;break;case 54:a=ResourceStrings.errorTitle_Unknown;break;case 55:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 56:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 57:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 59:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 60:a=ResourceStrings.errorTitle_PasteImageFailed;
break;case 61:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 62:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 63:a=ResourceStrings.errorTitle_WacStandard;break;case 64:a=ResourceStrings.errorTitle_WacStandard;break;case 65:a=ResourceStrings.errorTitle_WacStandard;break;case 66:a=ResourceStrings.errorTitle_WacStandard;break;case 67:a=ResourceStrings.errorTitle_WacStandard;break;case 68:a=ResourceStrings.errorTitle_WacStandard;break;case 69:a=ResourceStrings.errorTitle_WacStandard;
break;case 70:a=ResourceStrings.errorTitle_WacStandard;break;case 71:a=ResourceStrings.errorTitle_WacStandard;break;case 72:a=ResourceStrings.errorTitle_WacStandard;break;case 73:a=ResourceStrings.errorTitle_WacStandard;break;case 74:a=ResourceStrings.errorTitle_WacStandard;break;case 75:a=ResourceStrings.errorTitle_WacStandard;break;case 76:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 77:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 78:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 79:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 80:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 254:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 255:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 256:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 257:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 258:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 81:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 82:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 83:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 84:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 85:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 86:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 87:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 88:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 89:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 90:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 91:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 92:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 93:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 94:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 95:a=ResourceStrings.errorTitle_Unknown;break;case 96:a=ResourceStrings.errorTitle_Unknown;break;case 97:a=ResourceStrings.errorTitle_Unknown;break;case 98:a=ResourceStrings.errorTitle_Unknown;break;case 99:a=ResourceStrings.errorTitle_Unknown;
break;case 137:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 100:a=ResourceStrings.errorTitle_Unknown;break;case 101:a=ResourceStrings.errorTitle_Unknown;break;case 102:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 103:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 104:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 105:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 238:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 269:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 262:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 288:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 268:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 315:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 237:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 228:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 233:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 231:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 230:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 426:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 19:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 106:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 107:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 108:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 109:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 111:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 112:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 143:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 113:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 114:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 115:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 116:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 117:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 118:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 141:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 142:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 135:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 144:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 147:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 148:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 149:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 150:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 151:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 155:a=ResourceStrings.errorTitle_Unknown;break;case 156:a=ResourceStrings.errorTitle_Unknown;break;case 159:a=ResourceStrings.errorTitle_Unknown;break;case 154:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 157:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;
case 158:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 160:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 168:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 169:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 173:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 199:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 200:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 201:a=ResourceStrings.errorTitle_Unknown;
break;case 202:a=ResourceStrings.errorTitle_PasteSlideFailed;break;case 203:a=ResourceStrings.errorTitle_Unknown;break;case 204:a=ResourceStrings.errorTitle_Unknown;break;case 205:a=ResourceStrings.errorTitle_Unknown;break;case 206:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 209:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 210:a=ResourceStrings.errorTitle_Unknown;break;case 211:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 212:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 213:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 214:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 215:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 363:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 287:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 321:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 222:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 247:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 275:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 244:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 295:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 245:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 246:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 249:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 250:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 322:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 329:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 243:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 251:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 252:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 242:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 241:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 293:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 294:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 379:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 296:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 297:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 298:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 332:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 354:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 355:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 356:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 357:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 365:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 364:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 358:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 369:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 333:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 299:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 304:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 305:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 308:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 377:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 309:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 325:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 352:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 328:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 330:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 331:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 334:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 373:a=ResourceStrings.errorTitle_Unknown;break;case 374:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 384:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 391:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 399:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 400:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 401:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 402:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 403:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 404:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 405:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 416:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 418:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 417:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 422:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 419:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 424:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 427:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 433:a=ResourceStrings.errorTitle_Unknown;break;case 434:a=ResourceStrings.errorTitle_Unknown;break;case 435:a=ResourceStrings.errorTitle_Unknown;break;case 440:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 441:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 442:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 443:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 444:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 445:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 446:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 447:a=ResourceStrings.errorTitle_PowerpointStandard;break;default:a=ResourceStrings.errorTitle_Unknown}return a}KMc(a){switch(a){case 2:a=6;break;case 3:a=6;break;case 4:a=6;break;case 41:a=6;break;case 33:a=6;break;case 34:a=6;break;case 35:a=6;break;case 36:a=6;break;case 5:a=6;break;case 6:a=6;break;case 7:a=6;break;case 8:a=116;break;case 306:a=116;break;case 9:a=
6;break;case 10:a=6;break;case 15:a=6;break;case 16:a=8;break;case 17:a=6;break;case 20:a=12;break;case 22:a=8;break;case 23:a=2;break;case 58:a=2;break;case 24:a=2;break;case 25:a=2;break;case 26:a=2;break;case 27:a=2;break;case 28:a=2;break;case 31:a=8;break;case 37:a=2;break;case 32:a=8;break;case 13:a=2;break;case 38:a=2;break;case 39:a=2;break;case 40:a=2;break;case 42:a=6;break;case 43:a=6;break;case 44:a=2;break;case 46:a=49;break;case 55:a=2;break;case 57:a=2;break;case 59:a=2;break;case 60:a=
49;break;case 63:a=6;break;case 64:a=6;break;case 65:a=6;break;case 66:a=6;break;case 67:a=6;break;case 68:a=6;break;case 69:a=6;break;case 70:a=6;break;case 71:a=6;break;case 72:a=6;break;case 73:a=6;break;case 74:a=6;break;case 75:a=6;break;case 76:a=6;break;case 77:a=6;break;case 78:a=6;break;case 79:a=6;break;case 80:a=6;break;case 254:a=6;break;case 255:a=6;break;case 256:a=116;break;case 257:a=116;break;case 258:a=6;break;case 81:a=49;break;case 82:a=49;break;case 83:a=49;break;case 84:a=49;
break;case 85:a=49;break;case 86:a=49;break;case 105:a=8;break;case 238:a=8;break;case 269:a=8;break;case 262:a=8;break;case 288:a=8;break;case 268:a=8;break;case 315:a=8;break;case 237:a=8;break;case 228:a=8;break;case 233:a=8;break;case 231:a=8;break;case 230:a=8;break;case 426:a=8;break;case 19:a=12;break;case 106:a=6;break;case 107:a=2;break;case 117:a=6;break;case 118:a=2;break;case 141:a=6;break;case 142:a=8;break;case 156:a=8;break;case 154:a=6;break;case 157:a=8;break;case 158:a=8;break;case 199:a=
8;break;case 200:a=2;break;case 202:a=49;break;case 212:a=49;break;case 287:a=4;break;case 321:a=4;break;case 222:a=5;break;case 247:a=4;break;case 275:a=8;break;case 244:a=4;break;case 295:a=4;break;case 245:a=4;break;case 246:a=4;break;case 249:a=4;break;case 250:a=4;break;case 322:a=1;break;case 243:a=4;break;case 251:a=4;break;case 252:a=4;break;case 242:a=4;break;case 241:a=8;break;case 293:a=12;break;case 294:a=12;break;case 296:a=6;break;case 333:a=12;break;case 299:a=49;break;case 304:a=6;
break;case 353:a=6;break;case 308:a=12;break;case 377:a=12;break;case 309:a=4;break;case 325:a=6;break;case 352:a=10;break;case 328:a=12;break;case 330:a=4;break;case 331:a=4;break;case 334:a=6;break;case 374:a=6;break;case 384:a=2;break;case 391:a=6;break;case 399:a=8;break;case 400:a=8;break;default:a=0}return a}T8i(a){switch(a){case 5:a=1;break;case 137:a=3;break;case 201:a=3;break;case 203:a=3;break;case 204:a=3;break;case 205:a=3;break;case 209:a=3;break;case 210:a=3;break;case 213:a=3;break;
case 215:a=3;break;case 363:a=3;break;case 329:a=3;break;case 379:a=3;break;case 296:a=1;break;case 297:a=3;break;case 298:a=3;break;case 332:a=3;break;case 354:a=3;break;case 355:a=3;break;case 356:a=3;break;case 357:a=3;break;case 365:a=3;break;case 364:a=3;break;case 358:a=3;break;case 369:a=3;break;case 305:a=3;break;case 307:a=3;break;case 373:a=3;break;case 391:a=1;break;case 433:a=3;break;case 434:a=3;break;case 435:a=3;break;default:a=1}return a}}Object(e.a)(eg,"DefaultErrorMapping",null,
[1329]);var kh=d(691);class Wa{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ErrorHandling"}Yb(a){this.K=a;a.register(1328,"PowerPointWebEditor.ErrorHandling.IDeployingDialog").ma().na(()=>new sb(a.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));a.register(1329,"PowerPointWebEditor.IErrorMapping").ma().na(()=>new eg);a.register(1330,"PowerPointWebEditor.IErrorDialog").ma().na(()=>new wm(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.IErrorMapping"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("Common.IAppSettingsManager")));const b=new sc.a(()=>new kh.a(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").kWb(a.resolve("Box4.IReplicationParameters")),lb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner"),
()=>u.AFrameworkApplication.Xg));a.register(1331,"PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor").ma().na(()=>new ff(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("PowerPointWebEditor.IPresentationReader"),b.value,u.AFrameworkApplication.lZf,this.K.Oa("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(1332,"PowerPointWebEditor.IDocRefreshHandler").ma().na(()=>
new bj(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IErrorHandler"),b.value,a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),()=>u.AFrameworkApplication.Xg,a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.IImageViewManager"),
a.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventNotifier"),a.resolve("PowerPointWebEditor.IZoomContext")));a.register(Vj,"PowerPointWebEditor.SeamlessFailoverHandler").ma().na(()=>new Vj(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>u.AFrameworkApplication.Xg));a.register(1333,"PowerPointWebEditor.IDelayedErrorHandler").ma().na(()=>new Sa(this.K.resolve("PowerPointWebEditor.IErrorMapping"),this.K.resolve("PowerPointWebEditor.IErrorDialog"),
this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.IDocRefreshHandler"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),
this.K.Oa("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")))}init(){this.K.resolve("PowerPointWebEditor.IDelayedErrorHandler");this.K.resolve("PowerPointWebEditor.IDocRefreshHandler").wb();this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").wb()}dispose(){this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").dispose()}static main(){m.a.instance.Ec(new Wa)}}Object(e.a)(Wa,"PPTWebEditorErrorHandlingPackage",null,[2,
3]);var qb=d(1176),dg=d(86),zb=d(37);class km{constructor(){this.font=null;this.SRc=this.isValid=!1}}Object(e.a)(km,"EmbeddedFontClientStatus",null,[]);class Nj{constructor(a,b,c,f,l,w){this.V3c=this.d$a=null;this.Ha=a;this.Cx=b;this.aMg=c.Cd(7);this.qc=f;this.yzb=l;this.Ay=w;this.aMg.yk(Object(C.a)(this,this.Ncb,"onPresentationPropertyChanged"));this.Cx.PCa(()=>{this.gSe(0)})}dispose(){this.aMg.Pm(Object(C.a)(this,this.Ncb,"onPresentationPropertyChanged"))}get isInitialized(){return!!this.d$a}get VBh(){return this.V3c}BXd(a){return this.isInitialized?
this.d$a.Kb(a)?this.d$a.ga(a):null:null}createFontUrl(a){if(this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled)if(za.a.J(41521309,820,50,"CreateFontUrl"),this.isInitialized||this.gSe(2),this.isInitialized){var b=this.Ay.oF(a);if((b=this.BXd(b))&&!b.SRc&&b.isValid){b.font.Name!==a&&za.a.J(41296397,820,15,"Name is not identical");a=da.FontUtils.g_b(a);const c=this.yzb.resolve(dg.a.XRi,Nj.fSi(b.font));Ja.a.Xa(a)||Ja.a.Xa(c)?za.a.J(41296399,820,15,"FontFace name or url is invalid"):(this.Ay.jNa(a,String.format("url('{0}')",
c)),b.SRc=!0)}}else za.a.J(41296401,820,10,"Dictionary is not initialized")}Ncb(a,b){b&&b.node&&b.property&&b.property===zb.a.embeddedFonts&&this.gSe(1)}gSe(a){if(this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled)if(za.a.J(41521314,820,50,"UpdateEmbeddedFontDictionary, reason: {0}",a),a=this.qc.u0i()){this.d$a?za.a.J(41521346,820,50,"Dictionary is updated, count: {0}",a.length):(this.d$a=new Bc.a,za.a.J(41296405,820,15,"Dictionary is initialized, count: {0}",a.length));for(const b of a){if(Ja.a.Xa(b.Name)){za.a.J(41296407,
820,15,"Name is invalid");continue}if(0!==b.Style)continue;a=Nj.mEj(b);const c=this.Ay.oF(b.Name),f=this.BXd(c);f&&(f.isValid===a||f.SRc)||this.d$a.$(c,Object.assign(new km,{font:b,isValid:a,SRc:!1}))}this.V3c=Nj.cAi(this.d$a);this.Ay.xrl(this.V3c);da.FontUtils.SYh(this.V3c,Object(C.a)(this,this.createFontUrl,"createFontUrl"))}else za.a.J(41296403,820,10,"EmbeddedFonts is null")}static fSi(a){return JSON.stringify(a)}static mEj(a){return!Ja.a.Xa(a.Name)&&4>a.Style&&!a.IsRestricted&&(0===a.LoadResult||
270===a.LoadResult)}static cAi(a){const b={};for(let c of a)c.value.isValid&&(a=[],a.push(new qb.a("",0,0,"",[0])),b[c.key]=a);return b}}Object(e.a)(Nj,"EmbeddedFontsManager",null,[1317,109]);class Wj{}Wj.loading="loading";Wj.loaded="loaded";Wj.error="error";Object(e.a)(Wj,"FontFaceStatus",null,[]);class Oj{constructor(){this.n_c=this.xBg=!1;this.yie=null;this.init()}get rwg(){return this.n_c}load(a){return new Promise((b,c)=>{this.n_c&&!Ja.a.Xa(a)||c([]);let f;f=this.xBg&&-1<a.indexOf("'")?String.format('48px "{0}"',
a):String.format("48px '{0}'",a);this.yie.load(f).then(l=>{for(const w of l)Ja.a.Xa(w.family)||w.status===Wj.loaded||za.a.J(40429085,801,15,"Font load status {0}",w.status);l.length||za.a.J(41494563,801,15,"No font resolved");b(l)},l=>{za.a.J(41739607,801,10,"Rejected: {0}",l.toString());c(l)})})}init(){const a=window.document;this.yie=a&&a.fonts?a.fonts:null;this.n_c=!!this.yie;this.xBg=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("AllowSpecialCharacterFontsToRender");za.a.J(41494593,
801,50,"FontFaceSetAPIIsSupported: {0}",this.n_c)}}Object(e.a)(Oj,"FontFaceSetObserver",null,[1315]);class Tl{constructor(a){if(!a)throw Error.argumentNull("fontFaceSetObserver");this.r$a=a}C5d(a){return a?a:{}}v5d(a){return a?a:()=>{}}KCh(a,b,c,f,l,w,F){if(!a)return[];b=this.C5d(b);c=this.v5d(c);f=this.C5d(f);l=this.v5d(l);w=this.C5d(w);F=this.v5d(F);const S=[];for(const fa of a)fa in f?(l(fa),S.push(this.r$a.load(String.format("{0}_MSCustomFont",fa)))):fa in b?(c(fa),S.push(this.r$a.load(String.format("{0}_MSFontService",
fa)))):fa in w&&(F(fa),S.push(this.r$a.load(String.format("{0}_EmbeddedFont",fa))));return S}}Object(e.a)(Tl,"FontsObserver",null,[1316]);class qo{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Fonts"}Yb(a){this.K=a;this.K.register(1315,"PowerPointWebEditor.Fonts.IFontFaceSetObserver").ma().na(()=>new Oj);this.K.register(1316,"PowerPointWebEditor.Fonts.IFontsObserver").ma().na(()=>new Tl(this.K.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver")));this.K.register(1317,"PowerPointWebEditor.Fonts.IEmbeddedFontsManager").ma().na(()=>
new Nj(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PPTe.IResourceViewElementResolver"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager")))}init(){this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager")}dispose(){}static main(){m.a.instance.Ec(new qo)}}Object(e.a)(qo,"PPTWebEditorFontsPackage",
null,[2,3]);var lm=d(419);class Jo{Unh(){return!1}}Object(e.a)(Jo,"DefaultParagraphViewElementSetUpdateStrategy",null,[1379]);var vl=d(232),An=d(1034),uj=d(236);class cf extends vl.a{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){super(a,b,l);this.mtc=null;this.XNb=Jb.a.nil;this.e2e=this.Nsd=!1;this.XX=this.WX=this.Qib=this.Pib=-1;this.ktd=this.sNb=!1;this.Ztc=this.cVc=this.Kyd=this.Vqf=this.Kkb=null;this.Qid=0;this.DWe=this.f_a=this.F4e=null;a.bM.AWa(b);this.pSa=c;this.Lyd=w;this.OKh=F;this.NKh=S;this.wQh=
fa;this.Yc=xa;this.nLh=Za;this.Av=pb;this.ZYa(!0);this.jJe(!0);this.qvd=new sc.a(Object(C.a)(this,this.WDi,"determineIsShapesAndTextboxesEnabled"));this.Es=[];this.HKa=new Ua.a;this.lXe=new Ua.a;this.tcb();this.Qc.Jh&&(b=this.Qc.g7i(this.gb))&&(b.isSelected&&(this.HQ.bBb=!0),b.z7&&(this.sNb=!0),this.HQ.bBb&&(this.Pib=b.gha,this.Qib=b.hha,this.WX=b.MR,this.XX=b.Kpa));a.Po&&(a=Object(ua.a)(176,a))&&a.rEk(this.gb);this.iPb=f;this.Eyd=Mb}get zpk(){return this.iPb}get Vwe(){return this.Lyd}get Och(){return this.Vqf||
(this.Vqf=this.OKh())}get V8c(){if(!this.Kyd){const a=this.NKh();a&&(this.Kyd=a.FBl())}return this.Kyd}get Mf(){return this.Yc}get hZ(){return this.nLh}get pyg(){return this.XNb}set pyg(a){this.XNb=a}get arj(){return this.HKa}get Q1g(){return this.Ci?ya.a.x5f(this.Ci,!1):0}get Ci(){return this.Kkb}get q7a(){return this.F4e}ZYa(a){let b=!1;this.d6k(a)&&(a=this.a4a(),this.lc(a),this.mtc=null,this.XNb=Jb.a.nil,b=!0);this.Mf.Zf&&this.gb.dhb?Sys.UI.DomElement.addCssClass(this.htmlElement,Ub.C2):Sys.UI.DomElement.containsCssClass(this.htmlElement,
Ub.C2)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,Ub.C2),this.htmlElement.removeAttribute("title"));return b}d6k(a){let b=!!this.htmlElement;b=b&&0<this.htmlElement.getElementsByTagName("p").length;return a||!b||!this.Ci||"p"!==Ja.a.vg(this.Ci.tagName)}a4a(){this.Kkb=this.Gd.Lo(ma.a.p);this.Kkb.className="Paragraph";this.F4e=this.Gd.Lo(ma.a.span);this.q7a.className="WACImageGroupContainer";return this.Gd.Al?this.Kkb:this.Myl()}Myl(){const a=this.Gd.Lo(ma.a.div);a.className="ParaWrappingDiv";
a.appendChild(this.Kkb);this.Co(this.Kkb);return a}vT(a){super.vT(a);if(this.gb.JY)return a=this.gb.JY.pc(a.E0).$oc,this.gb.JY=null,new uj.a(a.gla,a.minWidth,a.hla);let b;b=this.DWe;a.yb(88)&&(b=uj.a.max(b,a.xq.sIa),a.yc());return b}eA(a){if(u.AFrameworkApplication.fa.ka("TextLayoutServiceUpdateLayoutLogicEnabled")&&(this.cVc=null,this.Ci)){const b=this.Ci.getElementsByClassName("LineBox");if(b&&0<b.length){this.cVc=Array(b.length);for(let c=0;c<b.length;c++)this.cVc[c]=ya.a.Ou(b[c]).length}}this.ZYa(!1)&&
(a.currentNode.anchor.Mj(this.Na,8),a.parentNode.anchor.Mj(this.Na,8),this.mtc=null);super.eA(a);this.Fxi(a,this.Ci)}Fxi(a,b){var c=this.gb;if(this.Qc.Jh){var f=oa.InteractiveViewManager.instance.Jd;f&&f.Na===this.Qc.Na&&f.editingView.Al&&f.editingView.Bg===this.gb&&2===f.editingView.mode?Sys.UI.DomElement.addCssClass(this.htmlElement,cf.Rig):Sys.UI.DomElement.removeCssClass(this.htmlElement,cf.Rig)}if(c.JY)c=c.JY.pc(a.E0).htmlElement,ya.a.IVb(c,b),b=this.Qc,b.Jh&&b.cI&128&&(this.gb.JY=null);else{a=
this.h7i();f=Mc.StyleReader.y9f(a);Mc.StyleReader.aUc(a)&&f?(Ea.d(b,Ka.a.role,re.a.NFf),Ea.d(b,Ka.a.PFf,f)):(b.removeAttribute(re.a.ff),b.removeAttribute(re.a.kTb));var l="";if(I.a.instance.ga(71)||I.a.instance.ga(77))l=this.HZi(c);f=a=null;var w=db.ParagraphReader.gdg(c,I.a.instance.ga(53),I.a.instance.ga(71),I.a.instance.ga(77),I.a.instance.ga(54));if(this.e2e||l!==this.mtc||this.XNb!==c.Sse){a="WindowText";f="transparent";this.mtc=l;this.e2e=!1;l="";let S=null;"P"!==b.tagName&&w.c7a&&(S=da.FontUtils.eha(w.fontName));
if(w.w2){var F=w.fontColor;F!==Jb.a.auto&&(a=Jb.a.HH(F))}I.a.instance.ga(49)||(w.g7a&&(F=w.MQ,F!==Jb.a.auto&&(f=Jb.a.HH(F))),w.HQa&&(F=w.highlight,F!==Jb.a.auto&&(f=Jb.a.HH(F))));if(F=db.ParagraphReader.language(this.gb))if(F=qa.a.re(F))b.setAttribute("xml:lang",F.name),b.setAttribute("lang",F.name);b.style.fontWeight=w.isBold?"bold":"normal";b.style.fontStyle=w.isItalic?"italic":"normal";b.style.verticalAlign="baseline";w.isSuperscript&&(b.style.verticalAlign="super");w.ZE&&(b.style.verticalAlign=
"sub");w.mD&&(l="underline");if(w.YE||w.pZ)l=0<l.length?l+" line-through":"line-through";b.style.textDecoration=l;b.style.fontFamily=S?S:"'Segoe UI',Tahoma,Verdana,'Sans-Serif'";w.CQa?1===w.capitalization?b.style.fontVariant="small-caps":2===w.capitalization?b.style.textTransform="uppercase":b.style.fontVariant="normal":b.style.textTransform=""}this.XNb=c.Sse;I.a.instance.ga(49)&&(w.g7a&&(l=w.MQ,l!==Jb.a.auto&&(f=Jb.a.HH(l))),w.HQa&&(w=w.highlight,w!==Jb.a.auto&&(f=Jb.a.HH(w))));this.gb.properties.ta(ob.a.Wqg,
!1)?(Sys.UI.DomElement.addCssClass(b,"Conflict"),b.setAttribute(re.a.zpa,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(b,"Conflict"),b.removeAttribute(re.a.zpa),f?(b.style.backgroundColor=f,cf.uBf(f,b)):I.a.instance.ga(49)&&(b.style.backgroundColor="transparent",Sys.UI.DomElement.removeCssClass(b,"Highlight")));c.Sse!==Jb.a.nil?(Sys.UI.DomElement.addCssClass(b,"NoteTagHighlight"),f&&(b.style.borderColor=f,cf.uBf(f,b))):(Sys.UI.DomElement.removeCssClass(b,"NoteTagHighlight"),Sys.UI.DomElement.removeCssClass(b,
"Highlight"));a&&(b.style.color=a);c=Md.OutlineElementReader.Vl(lc.OutlineElementNavigator.uA(this.gb));this.Qc.Al&&(c?Sys.UI.DomElement.addCssClass(b,"Rtl"):Sys.UI.DomElement.removeCssClass(b,"Rtl"));switch(db.ParagraphReader.XM(this.gb)){case 1:b.style.textAlign="left";b.style.Mgb="";break;case 2:b.style.textAlign="center";b.style.Mgb="";break;case 3:b.style.textAlign="right";b.style.Mgb="";break;case 6:b.style.textAlign="justify";b.style.Mgb="auto";break;case 7:b.style.textAlign="justify";b.style.Mgb=
"distribute";break;case 9:case 11:case 10:b.style.textAlign="justify";b.style.Mgb="kashida";break;case 13:b.style.textAlign="justify";b.style.Mgb="inter-cluster";break;default:b.style.textAlign="",b.style.Mgb=""}4===gb.App.mode&&I.a.instance.ga(86)&&r.a.rj&&"right"===b.style.textAlign.toLowerCase()&&(a=b.style.paddingRight.toLowerCase(),""===a||"0px"===a)&&(b.style.paddingRight="1px");I.a.instance.ga(54)&&(Ea.d(b,Ka.a.Uw,this.gb.ta(Sb.a.Ln,0)),Ea.d(b,Ka.a.tpk,this.gb.id.toString()));this.Vwe.ekh(this.gb,
b,c,this.Na)}}h7i(){var a=I.a.instance.ga(71)?(a=Mc.StyleReader.iD(this.gb))?Mc.StyleReader.BP(a):I.a.instance.ga(61)?Mc.StyleReader.AJa:Mc.StyleReader.Yma:Mc.StyleReader.Yma;return a}HZi(a){let b="";var c=Mc.StyleReader.iD(a);c&&(b+=c.id);Mc.StyleReader.Oq&&({tableStyle:a,N3a:c}=Mc.StyleReader.Oq.B6a(a),a&&(b+=a.id),c&&(b+=c.id));return b}Oea(){this.gb.Rba(this.Na,16,!0)}tcb(){this.qvd.value&&this.gb.r7a.tcb()}XL(a){if(!this.kbl()){this.tcb();var b=this.gb;this.mMf();ya.a.Vt(this.Ci);ya.a.Vt(this.q7a);
var c=this.Ci;c.style.minHeight="";this.Es=[];this.Qid=0;var f=new Ua.a,l=0;a&&(l=this.C9h(a,b,f,c,l));if(!this.jbl()){a=!1;var w=this.htmlElement.parentNode,F=this.htmlElement.nextSibling;w&&(this.thc(w,this.htmlElement),a=!0);this.V8c&&this.V8c.YAl();var S=l;l=this.zpk.$Ok(b,this.Gd,c,this.arj,f,Object(C.a)(this,this.MYg,"onOverHyperlink"),Object(C.a)(this,this.IYg,"onOutHyperlink"),Object(C.a)(this,this.GX,"takeOwnershipOfSubtree"),Object(C.a)(this,this.Co,"takeOwnership"),ca.a.zHc,this.pyg,l,
this.Pib,this.Qib,this.sNb,cf.bUc,!!this.HQ&&this.HQ.bBb,this.Nsd,gb.App.SQ.gKe,Md.OutlineElementReader.Vl(lc.OutlineElementNavigator.uA(this.gb)));if(!u.AFrameworkApplication.fa.ka("TextLayoutServiceDataDeletionFixEnabled")||this.Av.PLf(b,f))this.Av.ywh(c,this.Gd,l.pzf,b,S,f,dd.a.instance.Pa?dd.a.instance.Pa.kb:null,this.cVc)||this.Gd.Po||this.Av.gBh(b);this.Es=f.toArray();this.Ztc=l.wSg;this.lXe=l.$Lf;this.Nsd=l.Gig;this.V8c&&this.V8c.TAl(this.Q1g);this.Och&&this.Och.WAl(c);this.Szh();this.ktd=
!0;a&&w.insertBefore(this.htmlElement,F);!this.Qc.Al&&w&&"li"===Ja.a.vg(w.tagName)&&this.I9h(b,w);this.Qc.Al||this.Av.JOf(c)}}}I9h(a,b){if(yc.ListReader.ula){if(b=this.aMc(a)){const c=b.pc(this.Qc.Na);if(c){const f=ya.a.rba(this.htmlElement,"Paragraph");this.gpk(a)?(a=(a=this.W6i(f))?a.nextSibling:null)?f.insertBefore(c.htmlElement,a):f.appendChild(c.htmlElement):ya.a.jFd(f,c.htmlElement);b.anchor.Mj(this.Na,64)}}}else this.pSa.FQf(b,a,this.Na)}W6i(a){for(let b=0;b<a.children.length;b++){const c=
a.children[b];if(Sys.UI.DomElement.containsCssClass(c,"PageBreakBlob"))return c}return null}gpk(a){if(!a)return!1;a=a.Ra;if(!a)return!1;a=a.first;return a?(a=a.blob)?8===a.wq:!1:!1}aMc(a){const b=new mb.GraphIterator;b.set(a);return b.af()?(lc.OutlineElementNavigator.Ke(b),this.Mf.Zf&&!b.$H(4)?b.yb(31):b.yb(4)):null}C9h(a,b,c,f,l){a=eh.a.nb(a.E0,a.currentNode);if(!a.Ii())return l;let w=0,F=!1,S=0,fa=0,xa=0,Za=!1;const pb=db.ParagraphReader.FV(b),Mb=this.qvd.value;do{const hc=a.xq.htmlElement;Sys.UI.DomElement.containsCssClass(hc,
ca.a.QU)?(Mb&&b.r7a.zBl?(Za||(yc.ListReader.Gw&&pb||b.r7a.oBl(this.q7a),f.appendChild(this.q7a)),this.q7a.appendChild(hc)):f.appendChild(hc),K.a.nv(hc,ca.a.FDa,l++),c.add(hc),this.Qc.Jh&&({tak:S,W9j:fa,V9j:xa}=cf.R0k(b,hc,Mb,a,Za,S,fa,xa)),F=Za=!0):f.appendChild(hc)}while(a.oCa());Mb?this.Qc.Al?this.Wrl():(this.Vzh(xa+6,fa+6),w=fa+6):w=fa-S+6;F&&!gb.App.instance.rsj&&this.Qc.Jh&&f.clientHeight<w&&(f.style.minHeight=w+"px");return l}Vzh(a=0,b=0){this.qvd.value&&this.gb.r7a.nBl(this.q7a,a,b)}Dld(){const a=
new eh.a(this.Na);a.set(this.gb);a.af();lc.OutlineElementNavigator.Ke(a);yc.ListReader.Gw&&(this.Vwe.ekh(this.gb,this.Ci,Md.OutlineElementReader.Vl(a.currentNode),this.Na),this.pSa.ssl(a))}Szh(){this.hZ.adc(this.gb,this.Ci)}WDi(){const a=lb.a.instance.qb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(130)}get isSelected(){return super.isSelected}set isSelected(a){super.isSelected=a;a||(this.XX=this.WX=this.Qib=this.Pib=-1)}get gha(){return this.Qc.Al?this.gb.pc(this.Qc.Gf.Na).gha:this.Pib}set gha(a){this.Pib!==
a&&(this.Pib=a,this.Mma(16),this.gb.anchor.Mj(this.Qc.Na,16))}get hha(){return this.Qc.Al?this.gb.pc(this.Qc.Gf.Na).hha:this.Qib}set hha(a){this.Qib!==a&&(this.Qib=a,this.Mma(48),this.gb.anchor.Mj(this.Qc.Na,48))}get MR(){return this.Qc.Al?this.gb.pc(this.Qc.Gf.Na).MR:this.WX}set MR(a){this.WX!==a&&(this.WX=a,this.Mma(16),this.gb.anchor.Mj(this.Qc.Na,16))}get Kpa(){return this.Qc.Al?this.gb.pc(this.Qc.Gf.Na).Kpa:this.XX}set Kpa(a){this.XX!==a&&(this.XX=a,this.Mma(48),this.gb.anchor.Mj(this.Qc.Na,
48))}get z7(){return this.Qc.Al?this.gb.pc(this.Qc.Gf.Na).z7:this.sNb}set z7(a){this.sNb!==a&&(this.sNb=a,this.Mma(16),this.gb.anchor.Mj(this.Qc.Na,16))}get c_f(){return this.Es[this.Es.length-1]}dispose(){this.VKk();super.dispose();this.mMf();for(let a of this.lXe)a.BWf(this.Gd)}VKk(){if(this.f_a&&this.htmlElement)for(let a of this.f_a)a.UKk(this.htmlElement)}xla(){super.xla();this.Nsd&&this.Qc.notify(2)}zld(a){const b=u.AFrameworkApplication.fa.ka("Box4DoNotRenderPresenceOutOfView"),c=this.Qc.xwe.o_d(this.gb);
this.Eyd.Cch(c,this.f_a,this,this.htmlElement,b,this.A7k());this.f_a=c;this.ktd||this.Szh();this.ktd=!1;super.zld(a)}Mma(a){this.wQh.Unh(this.gb)||super.Mma(a)}kbl(){if(this.otg()){const a=this.Qc;if(1!==a.editingView.ypb)return a.HPd=!0}return!1}jbl(){return this.Qc.Al&&Cb.SelectionEditor.Tra(dd.a.instance.Pa.kb)?!0:!1}Wrl(){var a=this.gb.pc(this.Qc.Gf.Na);a&&(a=Sys.UI.DomElement.getBounds(a.q7a),this.Vzh(a.width,a.height))}A7k(){return!this.otg()&&!this.Qc.Al}otg(){if(oa.InteractiveViewManager.instance.Jd!==
this.Qc)return!1;const a=this.Qc.editingView;return a.Bg===this.gb&&2===a.mode}iIj(){const a=this.getBounds(),b=id.a.ei(this.Qc.container);return a.y+a.height>=b.y&&a.y<=b.y+b.height}rre(a){a.Odh(this);0<this.Qid&&a.CQk(this)}get lVa(){return this.Ci}kAh(a){this.DWe=new uj.a(0,a,0)}getBounds(){const a=N.a.Lnb(this.htmlElement.querySelector("p.Paragraph")||this.htmlElement,this.Qc.Jh?this.gb.id.toString():"");this.Vwe.k5h(this.gb,a,Md.OutlineElementReader.Vl(lc.OutlineElementNavigator.uA(this.gb)),
this.Qc.Na);return a}MYg(a){vl.a.I3k(a.Hc,a.wC);if(gb.App.hUb){const b=a.Hc,c=b.querySelector(".NormalTextRun")||b;I.a.instance.ga(8)||a.LY?c.style.cursor="pointer":c.style.cursor="text";Sys.UI.DomElement.addCssClass(b,cf.Qre);An.a.instance().p2h(Object(C.a)(this,this.rue,"onCtrlKeyDown"));An.a.instance().q2h(Object(C.a)(this,this.tue,"onCtrlKeyUp"))}return!0}IYg(a){Sys.UI.DomElement.removeCssClass(a.Hc,cf.Qre);An.a.instance().Lbh(Object(C.a)(this,this.rue,"onCtrlKeyDown"));An.a.instance().Mbh(Object(C.a)(this,
this.tue,"onCtrlKeyUp"));return!0}mMf(){for(let a=0;a<this.HKa.count;a++)gb.App.Fb.RQ.zb(ra.a.ila,this.HKa.ga(a),Object(C.a)(this,this.MYg,"onOverHyperlink")),gb.App.Fb.RQ.zb(ra.a.jla,this.HKa.ga(a),Object(C.a)(this,this.IYg,"onOutHyperlink")),An.a.instance().Lbh(Object(C.a)(this,this.rue,"onCtrlKeyDown")),An.a.instance().Mbh(Object(C.a)(this,this.tue,"onCtrlKeyUp"));this.HKa.clear();if(this.Ztc){for(let a of this.Ztc)gb.App.Fb.RQ.zb(a.eventName,a.Hc,a.handler);this.Ztc=null}}rue(){this.gwa("pointer")}tue(){this.gwa("text")}gwa(a){for(let b=
0;b<this.HKa.count;b++)if(Sys.UI.DomElement.containsCssClass(this.HKa.ga(b),cf.Qre)){const c=this.HKa.ga(b).querySelector(".NormalTextRun");if(c){c.style.cursor=a;break}}}static get bUc(){return!!dd.a.instance.Pa&&!!dd.a.instance.Pa.kb&&dd.a.instance.Pa.kb.bUc}static uBf(a,b){"transparent"!==a?Sys.UI.DomElement.addCssClass(b,"Highlight"):Sys.UI.DomElement.removeCssClass(b,"Highlight")}static R0k(a,b,c,f,l,w,F,S){b=Sys.UI.DomElement.getBounds(b);c&&(a=a.r7a.bAl(f.currentNode),b.x=a.x,b.y=a.y,b.height&&
b.width||(b.height=a.height,b.width=a.width));a=b.y+b.height;if(!l||b.y<w)w=b.y;if(!l||a>F)F=a;b=b.x+b.width;if(!l||b>S)S=b;return{tak:w,W9j:F,V9j:S}}}cf.Rig="HiddenParagraph";cf.Qre="MouseIsOn";Object(e.a)(cf,"ParagraphViewElement",vl.a,[735,1382,435,274,109]);class Tm extends vl.a{constructor(a,b,c,f,l,w){super(a,b);this.Pg=this.Yc=this.V$=this.Lyd=null;yc.ListReader.ula?(this.cWf(),this.jJe(!0),this.V$=c,this.Lyd=l,this.Yc=w,this.Pg=f,this.ZYa(!0)):(this.jJe(!1),a=this.Gd.Lo(ma.a.span),a.className=
"ListGhost",this.lc(a))}ZYa(a){if(yc.ListReader.ula){var b=this.Wag(this.gb);a&&(a=this.JOd(),this.lc(a),(b=Object(ua.a)(cf,b.pc(this.Qc.Na)))&&b.htmlElement&&(b=b.Ci))&&((a=ya.a.WZb(b,Tm.g9a))?b.replaceChild(this.htmlElement,a):ya.a.jFd(b,this.htmlElement))}}get Abe(){return ya.a.WZb(this.htmlElement,Tm.u5b)}eA(){this.ZYa(!1);if(!this.Qc.Al&&yc.ListReader.ula)if(this.Yc.Zf)this.E0k(this.htmlElement,this.Abe,this.gb);else{const a=this.V$.Pvb(this.gb);this.Abe.innerText=a}}XL(a){this.Qc.Al||yc.ListReader.ula&&
a.currentNode.anchor.Mj(this.Na,64)}rre(a){yc.ListReader.ula&&a.Odh(this)}get lVa(){return this.htmlElement}kAh(){}Dld(){this.F0k()}B$f(){return-1}E0k(a,b,c){var f=this.Pg.EZd(c);if(f)if(12!==f.type)Da.a.instance.shipAssertTag(34930713,8,!1,"the node associated with the list is type [{0}]",f.type);else{var l=f.Ra,w=l?l.last.fo:null;l=l?l.last.Vo:null;var F=f.dhb,S=f.oDb,fa=f.Z6();f=!!F&&S.d8f(fa).Sa(Sb.a.listID);F=null;f&&(F=S.Sa(Sb.a.listID)&&fa.Sa(Sb.a.listID)?3:S.Sa(Sb.a.listID)?2:1);S=this.V$.Pvb(c);
c=this.V$.Pvb(c);w=!!w||f&&(1===F||3===F);l=!!l||f&&(2===F||3===F);F=!w&&!l&&""!==S&&S!==c;for(fa=!w&&!l&&!F;b.hasChildNodes();)b.removeChild(b.firstChild);b.innerText="";b.style.color="";b.title="";Sys.UI.DomElement.removeCssClass(b,Ub.ybe);Sys.UI.DomElement.removeCssClass(a,Ub.C2);if(fa)b.innerText=c;else{if(l||F)fa=Nb.a.createElement(b.ownerDocument,ma.a.span),Sys.UI.DomElement.addCssClass(fa,Ub.xuh),fa.innerText=S,b.appendChild(fa);if(w||F)S=Nb.a.createElement(b.ownerDocument,ma.a.span),Sys.UI.DomElement.addCssClass(S,
Ub.zuh),S.innerText=c,b.appendChild(S);w||l?b.style.color="#000":Sys.UI.DomElement.addCssClass(b,Ub.ybe);f&&Sys.UI.DomElement.addCssClass(a,Ub.C2)}}else Da.a.instance.shipAssertTag(34930712,8,!1,"No paragraph is found with a list node")}Wag(a){if(!a)return null;const b=new mb.GraphIterator;b.set(a);b.af();return lc.OutlineElementNavigator.Ke(b)?b.yb(2):null}JOd(){const a=this.Gd.Lo(ma.a.span);Sys.UI.DomElement.addCssClass(a,Tm.g9a);this.UEc(a);return a}UEc(a){const b=Nb.a.createElement(a.ownerDocument,
ma.a.span);Sys.UI.DomElement.addCssClass(b,Tm.u5b);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}F0k(){if(!this.Qc.Al){var a=this.Wag(this.gb),b=a.pc(this.Qc.Na).htmlElement.parentNode;!this.Qc.Al&&b&&"li"===Ja.a.vg(b.tagName)&&this.V$.iAh(b,a,this.Na,this.Abe,!1)}}}Tm.g9a="ListMarkerWrappingSpan";Tm.u5b="ListMarker";Object(e.a)(Tm,"NumberListViewElement",vl.a,[1382,435,274,109]);var $o=d(453),vf=d(1053);class Ve{constructor(a,b){this.offsetWidth=a;this.offsetHeight=
b}}Object(e.a)(Ve,"ListMarkerOffset",null,[]);class pf{constructor(){this.d2j="ListMarkerMeasuringPad";this.j9b=new Ie.a}n4i(a){let b=a.innerHTML;if(!b.length)return new Ve(0,0);var c=null;window.getComputedStyle&&(c=window.getComputedStyle(a,null))&&(b+=["",c.fontFamily,c.fontSize,c.fontStyle,c.fontWeight,c.fontVariant,c.textDecoration].join("_"));this.j9b.Kb(b)||(a=a.cloneNode(!0),c&&(a.style.fontFamily=c.fontFamily,a.style.fontSize=c.fontSize,a.style.fontStyle=c.fontStyle,a.style.fontWeight=c.fontWeight,
a.style.fontVariant=c.fontVariant,a.style.textDecoration=c.textDecoration),vf.a.yTb(),vf.a.w6a(this.d2j).appendChild(a),{width:c,height:a}=id.a.kLc(a),this.j9b.$(b,new Ve(c,a)),vf.a.cYb());return this.j9b.ga(b)}}Object(e.a)(pf,"ListMarkerOffsetCache",null,[1325]);var fe=d(1162),te=d(1179),ne=d(80),Pj=d(252),hk=d(189),xm=d(486);class Pi{constructor(a,b){this.Yc=this.hY=this.FJ=null;this.Pg=a;this.SF=b;this.NF=yc.ListReader.Gw;this.Fw=r.a.Fw||r.a.Xn}get Sf(){return this.Pg}get vL(){return this.SF}get JK(){return this.FJ||
(this.FJ=lb.a.instance.qb("Box4.List.ListSettings"))}get Nha(){return this.hY||(this.hY=lb.a.instance.Oa("Common.IZoomManager"))}set Nha(a){this.hY=a}get Mf(){return this.Yc||(this.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get enabled(){return this.NF}Pvb(a){const b=this.Sf.l6a(a);return b&&b.propertySet.ta(ob.a.fm,null)?1===b.listType?this.wIf(b):0===b.listType?this.BUg(b,a):"":""}rsl(a,b){if(this.enabled&&b&&(this.Sf.Yba(b)||this.Mf.Zf&&63===b.type)&&this.vub(a)){a.style.display=
"block";var c=this.asb(a);this.Hfd(a,b);c&&(a=this.Pvb(b),c.innerText=a)}}FQf(a,b,c){if(this.enabled&&this.vub(a)){var f=this.asb(a);f&&this.iAh(a,b,c,f)}}iAh(a,b,c,f,l=!1){var w=mb.GraphIterator.nb(b);w.af();lc.OutlineElementNavigator.Ke(w);if(yc.ListReader.$j(w)||this.Mf.Zf&&yc.ListReader.p4b(w)){const S=w.currentNode;var F=Md.OutlineElementReader.Vl(S);this.Mf.Zf?this.Sf.NSg(w):this.Sf.kla(w);w=w.currentNode;if(!yc.ListReader.ula){const fa=this.Pvb(w);f.innerText=fa}f.setAttribute(re.a.XJ,re.a.yB);
12!==b.type?xm.a.pSc(b)&&(a=f.parentNode,f.style.height="auto",b=c=0,{width:c,height:b}=this.Orb(f),f.style.height="",c=-1*(Math.ceil(c)+13),f.style.marginLeft=F?"13px":c+"px",f.style.marginRight=F?c+"px":"13px",ya.a.k_k(f,F?"right":"left"),F=0,{height:F}=this.Orb(a.parentNode),f.style.marginTop=Math.max((F-b)/2,0)+"px"):(this.c3k(a,f,b,S,w,c),this.qSe(b,f,c,w,F,l))}}ssl(a){this.enabled&&a&&a.xq&&Md.OutlineElementReader.Vl(a.currentNode)}pSe(a,b,c,f,l=-1){this.enabled&&(db.ParagraphReader.FV(a)||
this.Mf.Zf&&db.ParagraphReader.GEj(a))&&this.gAh(a,b,c,l,null)}psl(a,b,c){if(this.enabled&&this.vub(a)){var f=ya.a.L6f(a,Pi.UHi);if(f&&(f=ya.a.L6f(f,Pi.THi))&&(f=ya.a.W6(f,Pi.Kda))&&f.style&&(r.a.ag||(f.style.marginTop="0px"),(a=ya.a.W6(a,Pi.xpk))&&(a=ya.a.W6(a,Pi.Kda))&&f.className.startsWith(Pi.Kda))){if(this.Mf.Zf){var l=ya.a.zrb(a,Pi.UIa);var w=ya.a.zrb(f,Pi.UIa)}else l=this.tVd(a,Pi.UIa),w=ya.a.W6(f,Pi.UIa);l&&w&&(f.style.marginLeft!==a.style.marginLeft&&(f.style.marginLeft=""===a.style.marginLeft?
"0px":a.style.marginLeft),f.style.marginRight!==a.style.marginRight&&(f.style.marginRight=""===a.style.marginRight?"0px":a.style.marginRight),{a3f:b,P2f:c}=this.eAh(a,f,l,w,b,c),this.B5h(b,c,f))}}}tVd(a,b){return ya.a.W6(a,b)}eAh(a,b,c,f,l,w){var F;""!==a.style.textIndent&&(w&&this.Sf.h9a||""===b.style.textIndent)&&(w=a.style.textIndent,this.Sf.h9a&&(F=this.$Lc(a))&&(w=this.igi(F,w)),b.style.textIndent=w);w=this.Lrb(c);F=this.Lrb(f);Math.floor(F.x)!==Math.floor(w.x)?(a=this.ugi(l,w,F),a=isNaN(a)?
0:a,""!==b.style.textIndent&&(l=b.style.textIndent,w=l.lastIndexOf("px"),0<w&&(l=l.substring(0,w),a+=parseInt(l))),b.style.textIndent=a+"px",w=this.Lrb(c),F=this.Lrb(f)):""===b.style.textIndent&&(b.style.textIndent=a.style.textIndent);return{a3f:w,P2f:F}}ugi(a,b,c){let f=0;10>Math.abs(c.x-b.x)?this.JK.pGj||(f=this.Xag(a,b,c)):f=this.Xag(a,b,c);return f}Xag(a,b,c){return a?c.x-b.x:b.x-c.x}igi(a,b){let c=b,f;({width:f}=this.Orb(a));if(f){var l=a.style.marginLeft,w=a.style.marginRight;const F=l.lastIndexOf("px"),
S=w.lastIndexOf("px");a=c.lastIndexOf("px");0<a&&0<F&&0<S&&(l=this.Zwe(l,F),w=this.Zwe(w,S),(b=this.Zwe(b,a))||l||w)&&(c=b+f+l+w+"px")}return c}Zwe(a,b){a=a.substring(0,b);a=parseFloat(a);return a=isNaN(a)?0:a}B5h(a,b,c){if(r.a.ag){if(.1<Math.abs(a.y-b.y)){let f=parseFloat(c.style.marginTop);f=isNaN(f)?0:f;c.style.marginTop=a.y-b.y+f+"px"}}else c.style.marginTop=a.y-b.y+"px"}B$f(a,b=!1){return(a=this.asb(a))?({width:a}=this.Orb(a),b?a+0:a):0}asb(a){return this.enabled&&this.vub(a)?(a=xm.a.w4i(a))?
this.z$f(a):null:null}Hfd(a,b,c=!1){if(this.enabled&&this.vub(a)){if(this.Mf.Zf){var f="1";var l=this.Sf.AZd(b)}else f=this.m4i(b),l=this.Sf.l6a(b);b=this.t_b(b,l);c?(Ea.d(a,Ka.a.rBi,b),Ea.d(a,Ka.a.role,re.a.VMa),Ea.d(a,Ka.a.qBi,f)):(Ea.d(a,Ka.a.h9h,b),Ea.d(a,Ka.a.role,re.a.VMa),Ea.d(a,Ka.a.PFf,f))}}z$f(a){if(!this.enabled||!a)return null;let b=null;(a=this.$Lc(a))&&(b=ya.a.W6(a,Pi.u5b)||this.UEc(a));return b}vub(a){return!!a&&"li"===Ja.a.vg(a.tagName)}gAh(){}U7f(){return 720}Orb(a){let b,c;({width:b,
height:c}=id.a.kLc(a));this.Nha&&this.Nha.instance&&this.Nha.instance.ftg(a)&&(b/=this.Nha.instance.Q1,c/=this.Nha.instance.Q1);return{width:b,height:c}}Lrb(a){const b=id.a.kLc(a).returnValue;this.Nha&&this.Nha.instance&&this.Nha.instance.ftg(a)&&(b.x/=this.Nha.instance.Q1,b.y/=this.Nha.instance.Q1);return b}Wha(a,b){switch(a.Wha()){case 0:return b+"";case 4:return Ja.a.ZPf(b-1,!0);case 2:return Ja.a.aQf(b,!0);case 3:return Ja.a.ZPf(b-1,!1);case 1:return Ja.a.aQf(b,!1);case 22:return 10>b?"0"+b:b+
"";default:return b+""}}wIf(a){if(1!==a.listType)return"";a=this.w6i(a.listType,a.listStyle);return Pj.a.SHf(a[0])}BUg(a,b){b=this.t_b(b,a);return this.Wha(a,b)+"."}w6i(a,b){return hk.a.bV(a,b).propertySet.ta(ob.a.fm,null)}t_b(a,b){const c=b.wha;return c!==Pj.a.gw?c:this.Agi(a,b)}Agi(a,b){if(b.SV!==Pj.a.gw)return b.SV;if(b.Zz!==Pj.a.gw)return b.Zz;let c=1;const f=new mb.GraphIterator;f.set(a);f.af();for(lc.OutlineElementNavigator.Ke(f);f.pCa();)if(yc.ListReader.$j(f)){const l=this.Sf.rx(f);if(l&&
b&&l.listType===b.listType&&l.listStyle===b.listStyle){if(l.SV!==Pj.a.gw)return c+l.SV;if(l.Zz!==Pj.a.gw)return c+l.Zz;if(a.Sa(Sb.a.listID)&&f.currentNode.Sa(Sb.a.listID)&&f.currentNode.getValue(Sb.a.listID)!==a.getValue(Sb.a.listID))break;c++}}return c}Stl(a,b){gb.App.f9a&&(a.Sa(ob.a.fontColor)&&(b.fontColor=a.getValue(ob.a.fontColor)),a.Sa(ob.a.fontSize)&&(b.fontSize=a.getValue(ob.a.fontSize)),a.Sa(ob.a.font)&&(b.fontName=a.getValue(ob.a.font)),a.Sa(ob.a.bold)&&(b.isBold=a.getValue(ob.a.bold)),
a.Sa(ob.a.italic)&&(b.isItalic=a.getValue(ob.a.italic)),a.Sa(ob.a.superscript)&&(b.isSuperscript=a.getValue(ob.a.superscript)),a.Sa(ob.a.subscript)&&(b.ZE=a.getValue(ob.a.subscript)),a.Sa(ob.a.strikethrough)&&(b.YE=a.getValue(ob.a.strikethrough)),a.Sa(ne.a.rs)&&(b.pZ=a.getValue(ne.a.rs)))}r_d(a,b){a=db.ParagraphReader.gdg(a,I.a.instance.ga(53),I.a.instance.ga(71),I.a.instance.ga(77),I.a.instance.ga(54));this.Stl(b,a);return a}M7f(){return null}hAh(a,b,c,f){const l=c.parentNode;let w=f.ta(ob.a.fontSize,
od.Font.IH);if(a.ZE||a.isSuperscript)Ea.d(c,Ka.a.zTf,(w/2).toString()),w=Math.floor(w*Ob.aSi),l&&(l.style.fontSize=w/2+"pt"),c.style.fontSize=w/2+"pt";else if(yc.ListReader.ula){if(c.style.fontSize=w/2+"pt",!f.Sa(ob.a.fontSize)&&(a=ya.a.zrb(b,"EOP")))c.style.fontSize=a.style.fontSize}else c.style.fontSize=b.style.fontSize}c3k(a,b,c,f,l,w){b&&this.vub(a)&&(b.style.verticalAlign=a.style.verticalAlign,f&&l&&gb.App.f9a&&(w=f.yg(w)))&&(f=this.r_d(c,l,I.a.instance.ga(53),I.a.instance.ga(71),I.a.instance.ga(77),
I.a.instance.ga(54)),f=this.M7f(w.Gd,c)||f,this.l_b(a,b,l),!this.Mf.Zf||""===b.style.color&&!Sys.UI.DomElement.containsCssClass(b,Ub.ybe)?(c="",f.w2&&(w=f.fontColor,w!==Jb.a.auto&&(c=Jb.a.HH(w))),b.style.color=c,c=this.Sf.l6a(l)):c=this.Sf.AZd(l),b.style.fontWeight=f.isBold&&1!==c.listType?"bold":"normal",b.style.fontStyle=f.isItalic&&1!==c.listType?"italic":"normal",f.isSuperscript?b.style.verticalAlign="super":f.ZE&&(b.style.verticalAlign="sub"),this.hAh(f,a,b,l),f.YE||f.pZ)&&(b.style.textDecoration=
0<b.style.textDecoration.length?b.style.textDecoration+" line-through":"line-through")}l_b(a,b){b.style.fontFamily=a.style.fontFamily}$Lc(a){return a?ya.a.WZb(a,uf.a.g9a)||this.JOd(a):null}UEc(a){const b=Nb.a.createElement(a.ownerDocument,ma.a.span);Sys.UI.DomElement.addCssClass(b,Pi.u5b);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}JOd(a){if(!a)return null;const b=Nb.a.createElement(a.ownerDocument,ma.a.span);Sys.UI.DomElement.addCssClass(b,uf.a.g9a);ya.a.jFd(a,b);
this.UEc(b);return b}qSe(a,b,c){this.pSe(a,b.parentNode.parentNode,this.vL.Qrb(a).uJb,this.vL.c6a(a).uJb,c)}}Pi.Kda="Paragraph";Pi.xpk="ParaWrappingDiv";Pi.THi="_EditingElement";Pi.UHi="_EditingElement_WrappingDiv";Pi.UIa="TextRun";Pi.u5b="ListMarker";Object(e.a)(Pi,"AListMarkerUtility",null,[1326]);var Ce=d(65),Wk=d(788);class vk{}vk.UJd=8226;vk.uIf="Arial";vk.UPd=65532;vk.uGa=65533;Object(e.a)(vk,"PptListConstants",null,[]);var nf=d(60),qg=d(225);class ro extends Pi{constructor(a,b,c,f,l,w,F,S,
fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc){super(a,b);this.wWj=[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061];this.Rce=c;this.j9b=f;this.Fa=l;this.fk=w;this.p6j=F;this.Ib=S;this.dC=fa;this.Zh=xa;this.FN=Za;this.JG=pb;this.gF=Mb;this.eBg=hc;this.N8b=kc;this.Iz=Dc;this.sta=Ec;this.M8b=Hc}m4i(a){const b=new mb.GraphIterator;b.set(a);b.af();lc.OutlineElementNavigator.Ke(b);return b.currentNode.ta(Sb.a.listLevel,0)+1+""}gAh(a,b,c,f,l=null){const w=this.Rce.zp(aa.a.qsl);l=new eh.a(f);l.set(a);l.af();
lc.OutlineElementNavigator.Ke(l);if(yc.ListReader.$j(l)){if(!b){this.Rce.Vb(zd.a.qh,{["Reason"]:"ParagraphElementNull"});w.end();return}f=this.z$f(b);if(!f){this.Rce.Vb(zd.a.qh,{["Reason"]:"ListMarkerNotFound"});w.end();return}let F;({width:F}=this.Orb(f));const S=l.xq.Gd.Ed;a=S.kJ(this.vL.d7(a).aM,0);c=S.kJ(fe.a.Qda(c,0),0);this.Iz&&Object(Ca.a)(516,this.gF.Jd)&&(c=0);l=Md.OutlineElementReader.Vl(l.currentNode);this.B0k(b,f,a,c,F,l)}w.end()}Orb(a){a=this.j9b.n4i(a);return{width:a.offsetWidth,height:a.offsetHeight}}$Lc(a){let b=
a;this.N8b&&a&&0<=a.className.indexOf(nc.a.Kda)&&(a=ya.a.rba(a,nc.a.O7))&&(b=a);return super.$Lc(b)}tVd(a,b){return this.N8b?ya.a.W6(a,nc.a.O7)?ya.a.zrb(a,b):ya.a.W6(a,b):super.tVd(a,b)}eAh(a,b,c,f){b.style.textIndent=a.style.textIndent;a=this.Lrb(c);f=this.Lrb(f);return{a3f:a,P2f:f}}Wha(a,b){switch(a.Wha()){case 18:return 21>b?Ja.a.fromCharCode(b-1+9312):b.toString();case 19:return this.FUi(b)}return super.Wha(a,b)}wIf(a){let b="";if(1===a.listType){const c=a.propertySet.ta(ob.a.fm,null);c&&c.length&&
c[0]&&(b=Ja.a.Dv(c[0],4))}b=this.S5h(b?b:"2022",a);if(qd.a("FixEvalSecurityBugForListMarkerUtility")&&String.fromCodePoint)return String.fromCodePoint(String.format("0x{0}",b));za.a.J(520975567,809,15,"Use of Eval in ListMarkerUtility");return Object(te.a)(String.format("'\\u{0}'",b))}BUg(a,b){b=this.t_b(b,a);return this.Wha(a,b)+this.v6i(a)}B0k(a,b,c,f,l,w){f?this.D0k(a,b,f,c,l,w):this.C0k(a,b,l,w)}D0k(a,b,c,f,l,w){const F=Math.max(Math.abs(c),l);a.style.textIndent=0<c?F+"px":Math.max(F-f,0)+"px";
this.Ujh(F-l,-1*F,b,w)}C0k(a,b,c,f){a.style.textIndent=c+"px";this.Ujh(0,-1*c,b,f)}Ujh(a,b,c,f){c.style.marginLeft=f?a+"px":b+"px";c.style.marginRight=f?b+"px":a+"px"}v6i(a){a=a.P7;for(let b=0;b<a.length;b++)if(a[b]===vk.uGa){if(b+2>=a.length)break;return a[b+2]?Ja.a.fromCharCode(a[b+2]):""}return"."}FUi(a){let b="";for(;0<a;)b=Ja.a.fromCharCode(this.wWj[a%10])+b,a=parseInt(String(a/10));return b}S5h(a,b){let c=a;1===b.listType&&b.b7a&&0<=Array.indexOf(ro.XTk,b.font)&&!a.indexOf("0")&&(c="f"+a.substr(1));
return c}r_d(a,b,c,f,l,w){if(!this.eBg)return super.r_d(a,b,c,f,l,w);f=this.Ib.Jc(b);f.oc(11);f.Og(11);l=this.FN.wP(f,this.JG.yba(f));c=new Wk.ParagraphStandardProperties;(w=this.fk.Fia(b))||this.p6j.nBj(b)?(c.fontColor=Jb.a.gOa,c.fontSize=w?nf.a.aUg:db.ParagraphReader.Gha(a,ob.a.fontSize,od.Font.IH)):(b.Sa(ob.a.fontColor)?c.fontColor=b.getValue(ob.a.fontColor):l&&l.Sa(ob.a.fontColor)&&!Ce.isTableCellOrInside(f)?c.fontColor=l.getValue(ob.a.fontColor):c.fontColor=this.Zh.Gha(a,ob.a.fontColor,Jb.a.nil),
f=this.Zh.Gha(a,ob.a.fontSize,od.Font.IH),a=this.Fa.GBa(this.Fa.$m(a)),a*=f,b.Sa(zb.a.Xqb)&&(a*=b.getValue(zb.a.Xqb)),c.fontSize=a);return c}hAh(a,b,c){this.eBg&&(b=this.dC.SH(b))&&a.Era&&(c.style.fontSize=b.Gd.Ed.fha(a.fontSize),c.style.lineHeight="0.1")}b9f(a,b){let c="";const f=this.Sf.l6a(b);1===f.listType&&f.b7a?c=f.font&&-1===f.font.indexOf(",")?da.FontUtils.eha(f.font):f.font:19===f.Wha()||18===f.Wha()&&21>this.t_b(b,f)?c=da.FontUtils.eha("Dengxian"):(b=null,a&&a.parentNode&&a.parentNode.parentNode&&
(b=a.parentNode.parentNode.children[1]),b&&(c=b.style.fontFamily));return c}l_b(a,b,c){a=this.b9f(b,c);b.style.fontFamily=a;b.style.fontFamily||!r.a.Gj&&!r.a.Xn||("Wingdings 3,Sans-Serif"===a?b.style.fontFamily="'Wingdings 3','Sans-Serif'":"Wingdings 2,Sans-Serif"===a&&(b.style.fontFamily="'Wingdings 2','Sans-Serif'"))}qSe(a,b,c,f,l,w=!1){if(this.N8b){if(b=b.parentNode.parentNode)b=0<=b.className.indexOf(nc.a.O7)?b.parentNode:b,this.pSe(a,b,this.vL.Qrb(a).uJb,this.vL.c6a(a).uJb,c)}else super.qSe(a,
b,c,f,l,w)}asb(a){return super.asb(a)}e4i(a,b){return this.t_b(b,a)}Hfd(a,b,c=!1){if(this.sta){const l=this.Ib.Jc(b);l.oc(11);l.Og(11);l.yb(2);if(c){if(b&&b.Sa(zb.a.urg)&&!b.getValue(zb.a.urg)){var f=b.ta(ob.a.fm,null);f&&0<f.length&&a.setAttribute("data-charcodes",f.toString());f=this.asb(a);f=this.b9f(f,b);Ja.a.Xa(f)||a.setAttribute("data-font",f);a.setAttribute("data-buAutoNum",b.ta(zb.a.autonumberBulletType,8))}this.M8b&&l.currentNode.Sa(zb.a.W7d)&&!l.currentNode.getValue(zb.a.W7d)&&a.setAttribute("data-margin",
l.currentNode.ta(Sb.a.Hl,qg.a.leftMargin).toString())}}super.Hfd(a,b,c)}M7f(a,b){return this.Iz&&a&&b&&(Object(Ca.a)(516,a)||Object(Ca.a)(516,this.gF.Jd)&&a.Al)?(a=new Wk.ParagraphStandardProperties,a.fontName=od.Font.VR,a.fontColor=Jb.a.gOa,a.fontSize=nf.a.mcl,a):null}}ro.XTk="Symbol;Wingdings;Wingdings 2;Wingdings 3;Webdings;Wingdings,Sans-Serif".split(";");Object(e.a)(ro,"ListMarkerUtility",Pi,[1241]);class Xk{static SUj(){"GetSpecialIndentWithTabs"in Xk.fgh||(Xk.fgh.GetSpecialIndentWithTabs=!0,
za.a.J(40649491,817,15,"{0}:{1}","GetSpecialIndentWithTabs","Invalid tab size"))}}Xk.fgh={};Object(e.a)(Xk,"SessionLogger",null,[]);class Um{constructor(a,b,c,f,l,w){this.Z_c=a;this.C8=b;this.Zh=c;this.Ib=f;this.FN=l;this.ADg=w}ekh(a,b,c,f=-1){let l=this.ADg;0<=f&&(l=this.g8f(a,f)||l);this.r1k(a,b,c,l);this.s1k(a,b,l,f)}g8f(a,b){let c=null;(a=a.pc(b))&&a.Gd&&(c=a.Gd.Ed);return c}r1k(a,b,c,f){let l=0;this.Zh.FV(a)||(l=f.kJ(this.C8.d7(a).aM,0));c?(b.style.marginLeft="",b.style.marginRight=l+"px"):(b.style.marginLeft=
l+"px",b.style.marginRight="")}s1k(a,b,c,f=-1){var l=this.C8.uLc(a).aM;a.anchor&&this.Zh.FV(a)&&0<=f?this.Z_c.pSe(a,b,fe.a.kJ(l,0),0,f):(f=c.kJ(l,0),l=c.kJ(this.C8.d7(a).aM,0),b.style.textIndent=this.ybj(f,l,this.Lti(a),this.r_i(a),c)+"px")}Lti(a){let b=0;if(void 0!==a&&null!==a&&(a=a.characterData))for(;b<a.length;)if("\t"===a.charAt(b))b++;else break;return b}r_i(a){let b=a.ta(Sb.a.Hpb,Um.MBc);if(!a.Sa(Sb.a.Hpb)){const c=this.Ib.Jc(a);c.set(a);c.oc(11);c.Og(11);(a=this.FN.wP(c,a.ta(Sb.a.listLevel,
qg.a.zCa)))&&(b=a.ta(Sb.a.Hpb,Um.MBc))}return b}ybj(a,b,c,f,l){a=-1*a<b?a:-1*b;if(!c)return a;0>a&&(c--,a=0);0>=f&&(c=0,Xk.SUj());0<c&&(f=l.kJ(f,0),a=(Math.floor((a+b)/f)+c)*f-b);return a}k5h(a,b,c,f=-1){var l=this.ADg;0<=f&&(l=this.g8f(a,f)||l);a=this.C8.uLc(a).aM;l=l.kJ(a,0);0>l&&(c||(b.x+=l),b.width-=l)}}Um.MBc=1440;Object(e.a)(Um,"ParagraphViewIndentationStrategy",null,[1381]);var Xj=d(414),ap=d(627),ym=d(353),If=d(155),Ul=d(224),oi=d(261);class hg{constructor(a,b,c){this.success=a;this.Rok=b;
this.Fxk=c}}Object(e.a)(hg,"AddSpansForThisLinePerTextLayoutPropertyResult",null,[]);var jl=d(794);class wg{constructor(){this.om=new H.DictionaryPropertySet}getValue(a){return this.om.getValue(a)}ta(a,b){return this.om.ta(a,b)}Sa(a){return this.om.Sa(a)}get propertySet(){return this.om.clone()}get VM(){return this.om.ta(ob.a.font,od.Font.VR)}get bU(){return this.om.ta(Sb.a.bU,-1)}get fieldInstruction(){return this.om.ta(Sb.a.fieldInstruction,"")}get Era(){return this.om.Sa(ob.a.fontSize)}get fontSize(){return this.om.ta(ob.a.fontSize,
od.Font.IH)}get w2(){return this.om.Sa(ob.a.fontColor)}get fontColor(){return this.om.ta(ob.a.fontColor,Jb.a.nil)}get iig(){return this.om.Sa(jl.a.aVb)}get L3f(){return this.om.ta(jl.a.aVb,1)}get HQa(){return this.om.Sa(ob.a.highlight)}get highlight(){return this.om.ta(ob.a.highlight,Jb.a.nil)}get g7a(){return this.om.Sa(ne.a.MQ)}get MQ(){return this.om.ta(ne.a.MQ,Jb.a.nil)}get kig(){return this.om.Sa(ob.a.Cs)}get language(){return this.om.ta(ob.a.Cs,0)}get BQa(){return this.om.Sa(ob.a.bold)}get isBold(){return this.om.ta(ob.a.bold,
!1)}get d7a(){return this.om.Sa(ob.a.italic)}get isItalic(){return this.om.ta(ob.a.italic,!1)}get Ysb(){return this.om.Sa(ob.a.underline)}get mD(){return this.om.ta(ob.a.underline,!1)}get POc(){return this.om.Sa(ob.a.kw)}get kw(){return this.om.ta(ob.a.kw,od.Font.fU)}get Xsb(){return this.om.Sa(ob.a.strikethrough)}get YE(){return this.om.ta(ob.a.strikethrough,!1)}get q1b(){return this.om.Sa(ne.a.rs)}get pZ(){return this.om.ta(ne.a.rs,!1)}get isSuperscript(){return this.om.ta(ob.a.superscript,!1)}get ZE(){return this.om.ta(ob.a.subscript,
!1)}get aG(){return this.om.ta(Sb.a.aG,null)}get As(){return this.om.ta(ob.a.As,!1)}get sZ(){return this.om.ta(ob.a.sZ,!1)}get zn(){return this.om.ta(ob.a.zn,!1)}get R7a(){return this.om.ta(Sb.a.R7a,!1)}get DRa(){return this.om.ta(Kd.a.Mua,!1)}get CQa(){return this.om.Sa(ne.a.capitalization)}get capitalization(){return this.om.ta(ne.a.capitalization,0)}get RCa(){return this.om.ta(Sb.a.RCa,!1)}Fp(a,b){b.Sa(a)&&this.om.setValue(a,b.Uh(a))}static qBc(a){const b=new wg;b.om.setValue(ob.a.fontSize,nf.a.jcl);
b.Fp(ob.a.superscript,a.propertySet);b.Fp(ob.a.subscript,a.propertySet);a.As&&b.om.setValue(ob.a.underline,!0);return b}}Object(e.a)(wg,"PptSmartArtFormattingCache",null,[760]);class Ef{constructor(a,b,c,f){this.kai=a;this.nai=b;this.lai=c;this.mai=f}}Object(e.a)(Ef,"SelectionImageProperty",null,[]);var mk=d(147),Fe=d(73);class pi{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg){this.eGg=this.dGg=!1;if(!ig)throw Error.argumentNull("graphTopologyManager");this.gF=
a;this.Fa=b;this.uc=c;this.NXj=f;this.oo=l;this.dC=w;this.i$b=F;this.Fx=S;this.yy=fa;this.mW=xa;this.ua=ig;this.CZc=Za;this.Z0j=pb;this.wke=Mb&&!Td;this.N8b=hc;this.TTa=kc;this.cyb=Ec;this.u8b=Hc;this.U3c=Dc&&!Td;this.Iz=we;this.fka=Pd;this.b_c=He;this.uNb=Pe;this.C1j=Df;this.ua=ig;this.r1j=Tg}a6a(a,b){if(b.ta(zb.a.iDa,!1))return nf.a.aUg;b=this.Fa.GBa(this.Fa.$m(b));return sg.a.ry(b,1)?a:2*Math.round(a*b/2)}wFf(a,b){if(!this.uNb||!a)return b;const c=pi.c9f(a);if(a===c)return b;this.Fx&&this.Fx.gEj?
({qZb:b}=pi.Vkd(a,this.Fx.F4b(a),b)).returnValue||({qZb:b}=pi.Vkd(c,this.Fx.fBj(c),b)):({qZb:b}=pi.Vkd(c,!0,b)).returnValue&&({qZb:b}=pi.Vkd(a,!0,b));return b}U$i(a){if(!this.r1j||Ja.a.Xa(a))return null;const b=this.ua.presentation.XVd;if(!b)return null;for(const c of b)if(c.Font===a)return c.SubstitutedByFont;return null}d9f(a,b,c){return c.fha(this.a6a(a,b))}I6f(a,b){return a.Sa(zb.a.yob)?(a=a.getValue(zb.a.yob)/Xj.a.Rec,b.Sda(a,0)+"px"):null}f$f(a){if(a.Sa(zb.a.yvb)){const b=a.getValue(zb.a.yvb)/
Xj.a.Rec;a=a.fontSize;return 0<b&&a*Xj.a.n7a>=b?"normal":"none"}return null}MYd(a,b,c,f){let l=null;this.CZc?l=Jb.a.HH(0):!c&&f||!b.w2?this.wke&&f&&(l=I.a.instance.ga(119)?b.ta(zb.a.S1b,!1)?this.G9f(a):Jb.a.HH(b.fontColor):this.G9f(a)):(a=b.fontColor,l=a===Jb.a.auto?"WindowText":Jb.a.HH(a));return l}Xnh(a,b,c,f,l){return!b&&!c&&!f&&!l&&(!this.Z0j||a.isSuperscript||a.ZE)}zdg(a){return a.Sa(zb.a.zM)?a.getValue(zb.a.zM)/1E3:0}X0d(){return 2/3}G9f(a){let b=null;var c=Object.assign(new ap.a,{schemeClrField:Object.assign(new ym.a,
{valField:10})});a=Object(ua.a)(131,this.uc.Sg(a));(c=this.NXj.CL(c,a?a.Ye:null))&&(b=If.Box4ColorHelper.dna(c).cU());return b}Cnh(a,b){return this.wke||a||!b}eoh(){return!0}Enh(){return this.wke}gul(a,b,c,f){if(!c||!c.Wa||!f||1>f.length)return b;let l=0,w=0;for(let F=0;F<f.length;F++){if(c.Wa.Qa>=w&&c.Wa.Qa<w+f[F]||c.Wa.Qa===w+f[F]&&f[F]>b.Lines[F]){l=F;break}w+=f[F]}c=0;for(const F of b.Lines)c+=F;a=a.Ra.ga(a.Ra.length-1).cp;a+1!==c&&(b.Lines[l]+=a+1-c);return b}PLf(a,b){a=Object(ua.a)(Wc.AParagraphNode,
a);if(!a||!a.Ra)return!1;let c=0;for(let f of b)if(0>f.className.indexOf("EOP")){if(f.innerText!==a.characterData.substr(c,f.innerText.length))return!1;c+=f.innerText.length}return!0}ywh(a,b,c,f,l,w,F,S){if(!(this.N8b&&a&&c&&c.length&&b))return!1;var fa=this.Fa.$m(f);if(!fa)return!1;fa=this.TTa&&fa.lxb;if(!b.Po&&!fa)return!1;f=Object(ua.a)(Wc.AParagraphNode,f);if(!f||!f.Ra||!fa&&this.i$b.s4a(f))return!1;c=this.nZi(c,f,!b.Po);if(this.MDi(a,c))return!1;if(0<=a.style.textAlign.indexOf("justify")){if(!this.oo||
this.oo.qsa)return!1;Sys.UI.DomElement.addCssClass(a,"JustifyAlign")}else Sys.UI.DomElement.removeCssClass(a,"JustifyAlign");return this.cyb?this.Cml(f,a,b,l,w,F,S):this.Aml(a,b,c)}gBh(a){this.TTa&&a&&(a=this.Fa.$m(a))&&a.lxb&&(za.a.J(587862422,820,50,"UpdateUseTextLayoutService - Fallback to HTML Text Layout for this shape."),a.uhb(!1))}a4i(a,b){const c=mk.a.Bi(a,zb.a.VHb,null);if(!c||!c.Lines)return null;if(!b){if(!a.Ra.length)return za.a.J(556106977,820,50,"GetLineInfoIfValid - CharacterProperties length 0, TextLayout {0}",
c.Lines.length),null;b=0;for(const f of c.Lines)b+=f;if(a.Ra.ga(a.Ra.length-1).cp+1!==b)return null}return c}Aml(a,b,c){if(!c)return!1;const f=new Ua.a;for(const l of c){c=b.Lo(ma.a.span);Sys.UI.DomElement.addCssClass(c,nc.a.O7);f.add(c);let w=!1;for(let F=0;F<l;F++)if(a.firstChild)c.appendChild(a.firstChild);else{za.a.J(37340930,820,10,"Span count not match between paragraph and countOfSpanInLine");w=!0;break}if(w)break}b=Object(ua.a)(735,this.dC.SH(a));if(!b)return za.a.J(37499416,820,10,"Line Box is not added because the ownership of paragraph dom is null"),
!1;for(let l of f)b.Co(l),a.appendChild(l);return!0}Cml(a,b,c,f,l,w,F){if(!b||!c)return!1;let S=mk.a.Bi(a,zb.a.VHb,null);if(!S||!S.Lines||!S.Lines.length)return!1;for(this.C1j&&(S=this.gul(a,S,w,F));l.count>f;)l.removeAt(f);a=new Ua.a;F=w=f=null;for(let fa=0;fa<S.Lines.length;fa++){f=c.Lo(ma.a.span);Sys.UI.DomElement.addCssClass(f,nc.a.O7);a.add(f);const xa=this.b0h(S.Lines[fa],b,f,w,F,l);w=xa.Rok;F=xa.Fxk;this.NVj(fa,S.Lines.length,f.lastChild);if(!xa.success){za.a.J(578425362,820,50,"TryAddLineBoxWithSpanUpdatePerTextLayoutProperty - Number of chars specified by text layout not available in paragraph");
break}}for(this.mzc(w,f,l);b.firstChild;)this.mzc(b.firstChild,f,l);return this.Bml(b,a)}NVj(a,b,c){pi.gGg||(Mf.Health.instance.recordKpiUsage("TextLineBreakWordBreakTelemetry",0,"pptotext",null),pi.gGg=!0);!c||!c.innerText||1>c.innerText.length||(a=a+1===b,b=-1<c.innerText.indexOf(" "),c=" "!==c.innerText.charAt(c.innerText.length-1),!pi.fGg&&!a&&b&&c&&(Mf.Health.instance.recordKpiFailure("TextLineBreakWordBreakTelemetry","TLSWordBreakError",!1,!0,null),pi.fGg=!0))}b0h(a,b,c,f,l,w){let F=!0;for(;0<
a;){if(!(f&&f.innerText.length||b.firstChild)){za.a.J(578425360,820,10,"TryAddLineBoxSpanPerTextLayoutProperty - Number of chars specified not available");F=!1;break}let S;f?(l=S=f,f=null):(S=b.firstChild,l&&!Sys.UI.DomElement.containsCssClass(S,nc.a.RM)&&(l.style.lineHeight=S.style.lineHeight),l=null);const fa=S.innerText.length;a>=fa?(this.mzc(S,c,w),a-=fa):(f=S.cloneNode(!1),this.vdl(S,f,a),this.mzc(S,c,w),a-=S.innerText.length)}return new hg(F,f,l)}vdl(a,b,c){a=a.childNodes;let f=-1;for(let l=
0;l<a.length;l++){const w=a[l];if(c)if(c>=w.innerText.length)c-=w.innerText.length;else{const F=w.cloneNode(!0);F.innerText=w.innerText.substring(c,w.innerText.length+1);b.appendChild(F);w.innerText=w.innerText.substring(0,c);c=0}else{f=l;break}}for(;-1!==f&&f<a.length;)b.appendChild(a[f])}mzc(a,b,c){if(a&&b&&c){b.appendChild(a);a=ya.a.k6a(a);for(let f of a)c.add(f),K.a.nv(f,"leafEltIdx",c.count-1)}}Bml(a,b){const c=Object(ua.a)(735,this.dC.SH(a));if(!c)return za.a.J(578425358,820,10,"Line Box is not added because the ownership of paragraph dom is null"),
!1;for(let f of b)c.Co(f),a.appendChild(f);return!0}nZi(a,b,c){const f=this.Usi(this.a4i(b,c));if(!f||!f.length)return null;c=f.length;const l=Array(c);let w=0,F=1;for(let S=0;S<b.Ra.length;S++)F<c&&b.Ra.ga(S).cp===f[F]&&(l[w]=a[S],w++,F++);l[c-1]=a[a.length-1];if(F!==c)return za.a.J(589891018,820,50,"indexOfLineStartCp and countOfLine( TextLayout property) do not match"),null;a=Array(c);a[0]=l[0];for(b=1;b<c;b++)a[b]=l[b]-l[b-1];return a}Usi(a){a=a?a.Lines:null;if(!a||!a.length)return a;const b=
Array(a.length);b[0]=0;for(let c=1;c<a.length;c++)b[c]=b[c-1]+a[c-1];return b}MDi(a,b){if(!b)return!1;a=a.childNodes;let c=0;for(const f of b){b=!0;for(let l=c;l<f+c&&l<a.length;l++)Sys.UI.DomElement.containsCssClass(a[l],nc.a.AM)||Sys.UI.DomElement.containsCssClass(a[l],nc.a.ESd)||(b=!1);if(b)return!0;c+=f}return!1}K7f(a,b,c){const f=new Bc.a;if(!a||!b||!c)return za.a.J(37606282,826,15,"GetCustomAttributes: htmlViewInstance={0}, paragraphNode={1}, formattingCache={2}.",a?"not null":"null",b?"not null":
"null",c?"not null":"null"),f;this.N5k(a,b)&&(a=null,c.Sa(zb.a.schemeColor)&&(a=c.getValue(zb.a.schemeColor),a=this.m6i(b,a)),Ja.a.Xa(a)||f.$("data-scheme-color",a),this.b_c&&c.Sa(zb.a.tRc)&&(c.getValue(zb.a.tRc)?f.$("data-usefontface","false"):f.$("data-usefontface","true")));return f}m6i(a,b){if(Ja.a.Xa(b))return"";const c=oi.SchemeColor.parse(b);if(c&&c.color&&!c.Dra){a=Object(ua.a)(131,this.uc.Sg(a));a=c.resolve(a?a.Ye:null);if(!a)return"";c.hP=Ul.g(a.aXa);return c.toString()}return b}N5k(a,b){return this.u8b&&
a.Al&&pi.SLj(b)}JOf(a){if(this.U3c){a=a.querySelectorAll("."+pi.DPd);const c=a.length,f=Array(c);for(var b=0;b<c;++b)f[b]=this.gPk(a[b]);for(b=0;b<c;++b)Fe.a.$wj(a[b],f[b].kai,f[b].nai,f[b].lai,f[b].mai)}}ePk(a){return new Ef("linear-gradient(to right, "+Fe.a.vDc+", "+Fe.a.vDc+")",Fe.a.eNe,"0px "+a.style.verticalAlign,Fe.a.kid)}Fzj(a){for(a=a.firstChild;a;){if(!Sys.UI.DomElement.containsCssClass(a,nc.a.C6))return!1;a=a.nextSibling}return!0}fPk(a){let b=Number.MAX_VALUE,c=0,f=0;const l=a.querySelectorAll("span."+
nc.a.C6);for(let w=0;w<l.length;w++){const F=l[w];f+=this.r0i(F);b=Math.min(b,F.offsetLeft);c=Math.max(c,F.offsetLeft+F.offsetWidth)}return new Ef("linear-gradient(to right, "+Fe.a.vDc+", "+Fe.a.vDc+")",0<c-a.offsetLeft?f+"px 100%":Fe.a.eNe,b-a.offsetLeft+"px "+a.style.verticalAlign,Fe.a.kid)}gPk(a){return this.Fzj(a)?this.ePk(a):this.fPk(a)}r0i(a){let b=0;if((a=a.getClientRects())&&0<a.length)for(const c of a)b+=c.width;return b}L7f(a,b,c){return this.Iz&&a&&b&&c&&(Object(Ca.a)(516,a)||Object(Ca.a)(516,
this.gF.Jd)&&a.Al)?wg.qBc(b):null}boh(){return!1}l_b(a){let b=a.ta(zb.a.latinFont,od.Font.VR);b.startsWith("+")&&(b=a.ta(ob.a.font,od.Font.VR));let c=new Ua.a;c.add(b);var f=[zb.a.eastAsianFont,zb.a.complexScriptFont,zb.a.GHb];for(var l of f)a.Sa(l)&&(f=a.getValue(l),!f||f.startsWith("+")||c.contains(f)||c.add(f));if(a=this.U$i(b))l=new Ua.a,l.add(b),qd.a("UseServerFallbackFontFirst")?l.insert(0,a):l.add(a),this.vVj(a,c),c=l;return c.toArray().join(",")}vVj(a,b){this.dGg||da.FontUtils.isMissingFont(b.ga(0))?
this.eGg||b.contains(a)||(za.a.J(523121375,820,15,"Server fallback font mismatches browser fallback(s)."),this.eGg=!0):(za.a.J(523121374,820,15,"Browser-used font available, but server-provided fallback mismatches."),this.dGg=!0)}Wze(a,b){if(a){var c=a.indexOf(",");0<c&&(a=a.substring(0,c))}c=!!this.Fx&&this.Fx.isEnabled;const f=!!this.yy&&this.yy.isEnabled;if(f||c||this.fka)b=da.FontUtils.Dmb(b,a,c,this.fka,f);f&&this.yy.createFontUrl(a);c&&(this.uNb&&a?(c=pi.c9f(a),this.Fx.createFontUrl(a),c&&this.Fx.createFontUrl(c)):
this.Fx.createFontUrl(a));this.fka&&this.mW.createFontUrl(a);return b}s6g(a,b){return a?this.Wze(a.fontName,b):b}HRc(){return this.fka}static tLc(a){if(Ja.a.Xa(a))return null;const b=a.indexOf(",");-1<b&&(a=a.substring(0,b).trim());return a}static c9f(a){if(Ja.a.Xa(a))return null;a=pi.tLc(a);let b=a.toLowerCase();for(;b;){let c=!1;b=b.trim();for(const f of pi.dSi){let l=f;b.endsWith("\u200b")&&(l+="\u200b");b.endsWith(l)&&(c=!0,b=b.substring(0,b.lastIndexOf(l)+1))}if(!c)break}return a.substring(0,
b.length)}static Vkd(a,b,c){return a&&b?(c=da.FontUtils.aZh(pi.tLc(a),c),{returnValue:!0,qZb:c}):{returnValue:!1,qZb:c}}static SLj(a){return a.ta(zb.a.iDa,!1)?!1:!0}}pi.DPd="Selection";pi.PSf="SelectionShadow";pi.dSi=" bold; italic; demibold; extrablack; extrabold; extralight; heavy; light; medium; regular; semibold; thin".split(";");pi.gGg=!1;pi.fGg=!1;Object(e.a)(pi,"TextRenderingStrategy",null,[1327]);class Sn{constructor(){this.dtb=[]}ECe(a){a&&!Array.contains(this.dtb,a)&&(a.hZ=this,Array.add(this.dtb,
a))}adc(a,b){for(let c=0;c<this.dtb.length;c++){const f=this.dtb[c];f.etb&&f.adc(a,b)}}}Object(e.a)(Sn,"AHighlightManager",null,[1324]);class zm extends Sn{constructor(){super();this.jJg=this.R6b=null}get jha(){return this.R6b}get a9a(){return this.jJg}tfd(a){if(a&&((this.R6b=a)&&0===this.R6b.action&&(this.jJg=this.R6b),a.Iba||a.Cdb)){var b=[];for(let c=0;c<this.dtb.length;c++){const f=this.dtb[c];f.etb&&Array.addRange(b,f.fwh(a.Iba,a.Cdb))}}}}Object(e.a)(zm,"HighlightManager",Sn,[]);class gh{constructor(a,
b){this.Gta=a;this.n7b=b;this.Gta.yk(Object(C.a)(this,this.Ah,"onPropertyChanged"))}dispose(){this.Gta.Pm(Object(C.a)(this,this.Ah,"onPropertyChanged"))}Ah(a,b){a=b.node;b.property.id===zb.a.VHb.id&&a.isConnected&&!this.n7b.isComposing&&a.anchor.$q(208)}}Object(e.a)(gh,"ParagraphNodeViewBehavior",null,[109]);class Am{constructor(a){this.n7b=a}Unh(a){if(a=Object(ua.a)(5,a)){if(this.n7b.isComposing){if(!a.NTc)return za.a.J(22586562,822,50,"Skip paragraph view validation because CEV is in IME composing"),
!0;za.a.J(22586564,822,50,"invalidate paragraph view element because text changed in new revision")}a.NTc=!1}return!1}}Object(e.a)(Am,"ParagraphViewElementCEVSetUpdateStrategy",null,[1379]);class Ki{constructor(a){this.S0c=[zb.a.TV,zb.a.Iw,zb.a.gca,zb.a.lja,zb.a.fca,zb.a.kja,Sb.a.Hl,Sb.a.dX,Sb.a.Jn,Sb.a.tCb,Sb.a.listLevel,ob.a.pl,ob.a.qI];this.EQh=a.G9d;this.iSc=a.iSc;this.DQh=a.pptCopyPasteMarginAndIndentationEnabled}get o9c(){return this.EQh}get kti(){return!1}get z2g(){return this.DQh}get Fpk(){return this.S0c}N7k(a){return!!a.tagName&&
"p"===Ja.a.vg(a.tagName)&&Sys.UI.DomElement.containsCssClass(a,nc.a.Kda)}YPa(a){const b={};for(const c of this.S0c)b[c.id.toString()]=a.Uh(c);return b}Jma(a,b){if(b){const c=db.ParagraphReader.FV(a);this.L1k(a,b,this.S0c,this.Cug(a),c);a.setValue(Kd.a.X3b,!0)}}Cug(a){let b=!1;(a=mb.GraphIterator.nb(a).parentNode)&&Md.OutlineElementReader.H7(a)&&(b=yc.ListReader.vRa(a));return b}Z$j(a,b,c,f){this.z2g||(f=!0);if(this.o9c){const l=a.ta(Kd.a.X3b,!1),w=b.ta(Kd.a.X3b,!1),F=l||!f&&!w&&!l?b:a;this.oti(F,
l||!f&&!w&&!l?a:b,this.S0c,this.Cug(F),c)}}pdj(a){return this.z2g&&a?db.ParagraphReader.FV(a)&&a.Sa(zb.a.V7d)&&!a.getValue(zb.a.V7d)&&a.Sa(Sb.a.Jn)?a.getValue(Sb.a.Jn).toString():"":""}L1k(a,b,c,f,l){for(const w of c)this.Snh(w,f,l)||(c=b[w.id.toString()],void 0!==c?a.setValue(w,c):a.removeProperty(w))}oti(a,b,c,f,l){for(const w of c)this.Snh(w,f,l)||(c=b.Uh(w),void 0!==c?a.ke(w,c):a.removeProperty(w))}Snh(a,b,c){return this.iSc&&!b&&c&&(a===Sb.a.Hl||a===Sb.a.Jn)}}Object(e.a)(Ki,"PptFormattingPropertyTransitStrategy",
null,[1380]);class vj{}vj.ryh="UnderlineColor";vj.eld="UnderlinePositionInEm";vj.fld="UnderlineThicknessInEm";vj.xJc="FontSizePx";Object(e.a)(vj,"ParagraphViewElementProperties",null,[]);class Hl extends Ob{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe){super(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec);this.P5b=Hc;this.GIg=Dc;this.NHg=Td&&!Pd;this.U3c=we&&!Pd;this.HIg=He;this.M5j=Pe}UGd(a,b){this.P5b?a.style&&!Ja.a.Xa(a.style.verticalAlign)&&(Ja.a.Xa(b.style.verticalAlign)?
(b.style.verticalAlign=a.style.verticalAlign.startsWith("-")?a.style.verticalAlign.substring(1,a.style.verticalAlign.length):"-"+a.style.verticalAlign,this.u5h(a)):a.style.verticalAlign="",b.style.lineHeight="0px"):super.UGd(a,b)}u5h(a){if(null!==a.style&&!Ja.a.Xa(a.style.verticalAlign)){if(this.GIg&&this.ZEj(a)){const b=a.style.backgroundColor;a.style.backgroundColor=null;Fe.a.bEf(a,String.format("linear-gradient(to right, {0}, {0})",b),Fe.a.eNe,String.format("0px {0}",a.style.verticalAlign),Fe.a.kid)}if(this.U3c||
this.GIg)a.style.verticalAlign.startsWith("-")?a.style.paddingTop=a.style.verticalAlign.substring(1,a.style.verticalAlign.length):a.style.paddingBottom=a.style.verticalAlign}}pYd(a){return this.P5b?"0px":super.pYd(a)}iDf(a){a.style.position=Fe.a.dlc}ZEj(a){return Sys.UI.DomElement.containsCssClass(a,"Highlight")&&null!==a.style&&a.style.backgroundColor!==Fe.a.tni}UDe(a,b,c,f){if(this.NHg&&b.As){if(b.YE||b.pZ)a.style.textDecoration=Fe.a.ufl,f[f.length]="Strikethrough";b.mD&&(f[f.length]="Underlined");
let l,w;this.M5j&&({eld:l,fld:w}=this.qej(b.VM)).returnValue?(K.a.nv(a,vj.ryh,this.pej(c,b)),K.a.nv(a,vj.eld,l),K.a.nv(a,vj.fld,w)):Ja.a.Xa(a.style.textDecoration)?a.style.textDecoration=Fe.a.rsh:a.style.textDecoration+=" "+Fe.a.rsh}else super.UDe(a,b,c,f)}pej(a,b){a=this.Av.MYd(a,b,!1,!0);return String.format("linear-gradient(to right, {0}, {0})",a)}qej(a){return{returnValue:"Calibri"===a,eld:1.1133,fld:.0654}}mBj(a,b){if(!a||!b)return!1;for(a=a.firstChild;a;){if(Sys.UI.DomElement.containsCssClass(a,
nc.a.C6))return!0;a=a.nextSibling}return!1}hDf(a,b){this.U3c&&(Sys.UI.DomElement.containsCssClass(b,nc.a.C6)||this.mBj(a,nc.a.C6)?(Sys.UI.DomElement.addCssClass(a,pi.DPd),this.HIg&&r.a.Gj&&Sys.UI.DomElement.addCssClass(a,pi.PSf)):(Sys.UI.DomElement.removeCssClass(a,pi.DPd),this.HIg&&r.a.Gj&&Sys.UI.DomElement.removeCssClass(a,pi.PSf)));if(this.NHg&&Sys.UI.DomElement.containsCssClass(a.parentNode,nc.a.Hjg)){const c=K.a.te(a,vj.ryh),f=K.a.te(a,vj.fld);let l=K.a.te(a,vj.eld);if(c&&f&&l){if(!Ja.a.Xa(a.style.fontSize)&&
a.style.fontSize.endsWith("px")&&!Ja.a.Xa(b.style.verticalAlign)&&b.style.verticalAlign.endsWith("px")){a=parseFloat(a.style.fontSize);const w=parseFloat(b.style.verticalAlign);isNaN(a)||!a||isNaN(w)||(l-=w/a)}Fe.a.bEf(b,c,String.format("100% {0}em",f),String.format("0% {0}em",l),Fe.a.kid);b.style.textDecoration=Fe.a.vfl}}}}Object(e.a)(Hl,"PptParagraphContentRenderer",Ob,[]);class Bn{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Paragraph"}Yb(a){this.K=a;this.FCe();this.MCe();this.sJk();
this.ICe();this.zJk();this.AJk();this.rJk()}init(){this.K.register(1324,"Box4.Highlight.IHighlightManager").ma().na(()=>new zm);this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393230,new lm.a((a,b)=>new cf(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.PptParagraphContentRenderer"),new gc.a(a,b),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),()=>null,()=>null,a.Al&&u.AFrameworkApplication.fa.ka("SkipUpdateContentEditableViewWhenComposing")?
this.K.resolve("PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy"):this.K.resolve("Box4.DefaultParagraphViewElementSetUpdateStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.Highlight.IHighlightManagerFactory").instance,this.K.resolve("Box4.ITextRenderingStrategy"),this.K.resolve("Box4.IParagraphOverlayControlRenderer"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393234,new lm.a((a,
b)=>new Tm(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)));this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior")}dispose(){this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior").dispose()}FCe(){this.K.register(1325,"PowerPointWebEditor.IListMarkerOffsetCache").ma().na(()=>new pf);this.K.register(1326,"Box4.IListMarkerUtility").ma().na(()=>
new ro(this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphIndentationReader"),cd.a.instance,this.K.resolve("PowerPointWebEditor.IListMarkerOffsetCache"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Graph.ISmartArtReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),
this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderListBulletStyleInBox4Enabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").s8a,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteListMarkerEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteMarginAndIndentationEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled))}MCe(){this.K.register(1327,
"Box4.ITextRenderingStrategy").ma().na(()=>new pi(this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IBox4ColorHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.qb("Box4.CloudFontService"),this.K.qb("Box4.CustomFontService"),this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").Bqg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Xug,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Uug,this.K.resolve("PowerPointWebEditor.IApplicationSettings").s8a,this.K.resolve("PowerPointWebEditor.IApplicationSettings").WHb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Buh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").YSc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Wug,
this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").nEj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Sil,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").kYk))}sJk(){this.K.register(Jo,"Box4.DefaultParagraphViewElementSetUpdateStrategy").ma();this.K.register(Am,"PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy").ma().na(()=>new Am(this.K.resolve("Box4.IEditingView")))}ICe(){this.K.register(Um,"PowerPointWebEditor.ParagraphViewIndentationStrategy").as("Box4.IParagraphViewIndentationStrategy").ma().na(()=>new Um(this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.IParagraphIndentationReader"),
this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),new $o.a))}zJk(){this.K.register(Ki,"PowerPointWebEditor.Paragraph.PptFormattingPropertyTransitStrategy").as("Box4.IFormattingPropertyTransitStrategy").ma().na(()=>new Ki(this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}AJk(){this.K.register(Hl,"PowerPointWebEditor.PptParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().na(()=>
new Hl(oa.InteractiveViewManager.instance,ia.a.instance,this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.IFormattingPropertyTransitStrategy"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.qb("Box4.Proofing.IIgnoreAllKeywords"),this.K.resolve("Box4.ITextRenderingStrategy"),this.K.resolve("Box4.ParagraphContentRendererSettings"),this.K.resolve("Box4.ILineSpacingHelper"),this.K.qb("Box4.IFeatureHelper"),da.FontUtils.xsi,this.K.qb("Box4.IFontSlotProvider"),
Object(C.a)(this.K.resolve("Box4.IEditStateEventManager"),this.K.resolve("Box4.IEditStateEventManager").I8g,"raiseParagraphContentUpdatedEvent"),Ab.a.language,this.K.qb("Box4.ITableOfContentRenderHelper"),fc.a.ZHf,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorDifferentLineHeightEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Xug,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Uug,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Wug,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextSelectionShadowFixIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").A6k))}rJk(){this.K.register(gh,"PowerPointWebEditor.ParagraphNodeViewBehavior").ma().na(()=>new gh(this.K.resolve("Box4.Graph.IGraphInstance").Cd(12),this.K.resolve("Box4.IEditingView")))}static main(){m.a.instance.Ec(new Bn)}}Object(e.a)(Bn,"PPTWebEditorParagraphPackage",null,[2,3]);var xg=d(114),Vm=d(490),Yi=d(610);class wl extends Sys.EventArgs{constructor(a){super();
this.uk=a}}Object(e.a)(wl,"PopSessionClosedEventArgs",Sys.EventArgs,[]);class yi{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td){this.sme=this.Lta=null;this.Ee=a;this.Dz=b;this.Wd=c;this.hc=f;this.la=l;this.Zac=w;this.e1c=F;this.Cx=S;this.Xe=fa;this.H8=xa;this.sa=Za;this.Df=pb;this.ua=Mb;this.ia=hc;this.Bb=kc;this.g8=Ec;this.so=Dc;this.TB=Td;F.uGd(Object(C.a)(this,this.YBb,"onPodSessionUnavailable"));F.Hmb(Object(C.a)(this,this.Cda,"onPodSessionRefreshed"));Hc.xB(Object(C.a)(this,this.eo,
"onSessionRehydrated"));this.hne=new Se.a(4,2,2E3,Object(C.a)(this,this.detectFailoverTimeout,"detectFailoverTimeout"),90,"18")}get isEnabled(){return this.la.zg}get $3b(){return!!this.Lta}M7i(a,b){const c=Kc.a.Nm("GetPodSessionInfo");try{const f=this.Ee.podSessionId,l=xg.a.create().toString(),w=String.format("{0}PodHandler.ashx?action=GetPodSessionInfo",this.la.podsWebServiceBase),F={};F.PodSID=f;F["X-UserSessionId"]=this.Zac();F["X-CorrelationID"]=l;c.Ya("PodSessionId",f);c.Ya("Cid",l);this.Dz.wY(w,
2,null,F,[dg.a.l4],0,S=>{try{if(f!==this.Ee.podSessionId)c.Ya("ExpectedPodSessionId",f),c.Ya("ActualPodSessionId",this.Ee.podSessionId),c.Ya("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{var fa=!0;if(S.data){if(c.Ya("HttpStatus",S.data.tf.toString()),c.Ya("RequestStatus",Vm.a[S.data.status]),S.data.lj){const xa=S.data.lj[dg.a.l4];xa&&"errorCannotFindSession"===xa&&(c.Ya("ErrorCode",xa),fa=!1)}}else c.Ya("HttpStatus","UNKNOWN"),c.Ya("RequestStatus","UNKNOWN");fa?(c.Ya("Result","Succeeded"),
c.finish(),a&&a()):(c.Ya("Result","Failed"),c.finish(!0),b&&b())}}catch(xa){za.a.J(36570845,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",xa),b&&b()}},S=>{try{if(f!==this.Ee.podSessionId)c.Ya("ExpectedPodSessionId",f),c.Ya("ActualPodSessionId",this.Ee.podSessionId),c.Ya("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{if(S.data){if(c.Ya("HttpStatus",S.data.tf.toString()),c.Ya("RequestStatus",Vm.a[S.data.status]),S.data.lj){const fa=S.data.lj[dg.a.l4];fa&&c.Ya("ErrorCode",
fa)}}else c.Ya("HttpStatus","UNKNOWN"),c.Ya("RequestStatus","UNKNOWN");c.Ya("Result","Failed");c.finish(!0);b&&b()}}catch(fa){za.a.J(36570847,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",fa),b&&b()}},null,void 0,void 0,this.la.O7i,this.la.P7i,"GetPodSessionInfo",void 0,!0)}catch(f){za.a.J(36570849,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",f),c.Ya("Result","Failed"),c.finish(!0),b&&b()}}YBb(a,b){a=!1;this.Lta?za.a.J(25306373,801,15,"PodSessionManager::OnPodSessionUnavailable - Already unavailable. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",
this.Ee.presentationId.string,this.Cx.Dia,this.Xe.Yz,this.Ee.uk,this.Ee.podSessionId,!this.hc.An,Kc.a.Ve(this.Lta),!!this.so.instance,b.sIc):(this.Lta=new Date,a=!0,za.a.J(25306375,801,15,"PodSessionManager::OnPodSessionUnavailable - Unavailable is detected. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Ee.presentationId.string,
this.Cx.Dia,this.Xe.Yz,this.Ee.uk,this.Ee.podSessionId,!this.hc.An,Kc.a.Ve(this.Lta),!!this.so.instance,b.sIc));this.g8.instance&&this.g8.instance.zSc?za.a.J(25691170,801,15,"PodSessionManager::OnPodSessionUnavailable - IsNonDismissibleDialogShown is TRUE, ignore Pods unavailable signal. PopSessionId:{0}; PodSessionId:{1}",this.Ee.uk,this.Ee.podSessionId):this.Cx.Dia&&this.la.podsSeamlessFailoverEnabled&&this.so.instance?this.so.instance.lQe(b.sIc,4,b.errorCode):(this.Wd.qia=!1,this.Cx.Dia?this.Xe.Yz?
(a&&this.Bb.Hb(this.hne),this.H8.sMc(this.Ee.presentationId.string,this.Ee.uk,this.Ee.podSessionId,b.sIc,c=>{this.ESk(c,this.Ee.uk)},c=>{this.DSk(c,this.Ee.uk)}),this.sa.setSelection(null),this.Df.blockContent(this.ua.presentation,"OnPodSessionUnavailable",!0),za.a.J(37106128,817,15,"PodSessionManager::OnPodSessionUnavailable, Block Presentation")):this.Gkj():za.a.J(25306377,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since session is not ready. PodSessionId:{0}",this.Ee.podSessionId))}Gkj(){this.sme||
(this.sme=new Date);const a=+new Date-+this.sme;a>this.la.podsNullSrmWaitTimeInMs?(za.a.J(36307157,801,15,"PodSessionManager::OnPodSessionUnavailable - Already wait {0}ms, won't wait anymore. PodSessionId:{1}",a,this.Ee.podSessionId),u.AFrameworkApplication.zo(kf.a.Fh(305)),Mf.Health.instance.recordQosError("ErrorCannotFailoverRehydration",["UnexpectedAppRefresh"],!1,!1,!0,!0,null),this.ia.Ma(aa.a.refresh,2,{refreshtrigger:"PodSessionManager::HandleNullPodFailoverManager"})):za.a.J(36307159,801,15,
"PodSessionManager::OnPodSessionUnavailable - Skip since PodFailoverManager is not ready. MaxWaitTime:{0}ms; ElapsedTime:{1}ms. PodSessionId:{2}",this.la.podsNullSrmWaitTimeInMs,a,this.Ee.podSessionId)}detectFailoverTimeout(){if(this.Lta){var a=+new Date-+this.Lta;a>this.la.podsFailoverBrowserWaitTimeoutInMs&&(this.Bb.ah(this.hne),za.a.J(25546830,801,15,"PodSessionManager::DetectFailoverTimeout - Won't wait for failover any longer. ElapsedTimeInMs:{0}, PodSessionId:{1}, PopSessionId:{2}",a,this.Ee.podSessionId,
this.Ee.uk),a=Object.assign(new tj.a,{Code:293,Source:6}),this.Wd.Mr(a,this.Ee.podSessionId,b=>{b.$C=1;b.cAa=8;return!1}))}}ESk(a,b){a&&(this.Ee.uk!==b?za.a.J(25306381,801,15,"PodSessionManager::RetrievePODSInfoSucceeded - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Ee.uk,b,this.Ee.podSessionId):(b=a.result)?(za.a.J(35128844,817,50,"PodSessionManager::RetrievePODSInfoSucceeded - OldPodSessionId:{0}; NewPodSessionId:{1};",this.Ee.podSessionId,
b.DocumentSessionID),this.Ee.podSessionId!==b.DocumentSessionID&&(a=this.Ee.podSessionId,this.Ee.podSessionId=b.DocumentSessionID,this.e1c.K8g(new Yi.a(a,b.DocumentSessionID)))):za.a.J(25306385,801,10,"Return type: {0}. PodSessionId:{1}, PopSessionId:{2}",a.result?Object.getType(a.result):null,this.Ee.podSessionId,this.Ee.uk))}DSk(a,b){if(this.Ee.uk!==b)za.a.J(25306387,801,15,"PodSessionManager::RetrievePODSInfoFailed - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",
this.Ee.uk,b,this.Ee.podSessionId);else{b=316;var c=-1;a&&a.error&&(b=kf.a.GM(a.error.Gm),c=a.error.Gm);za.a.J(25306389,801,15,"PodSessionManager::RetrievePODSInfoFailed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; ResponseRecievedTime:{4}; BSQMErrorCode:{5}; ServerErrorCode:{6}",this.Ee.presentationId.string,this.Ee.uk,this.Ee.podSessionId,"",Kc.a.Ve(new Date),c,b);c===kf.a.Fh(241)&&(this.Xe.Yz=!1,this.Xe.Qea&&this.TB.CBe(new wl(this.Xe.eca)))}}Cda(a,
b){Kc.a.Ivb=new Date;Kc.a.Mjd=[];this.Ee.podSessionId!==b.QW?za.a.J(25306391,801,15,"PodSessionManager::OnPodSessionRefreshed - PodSessionId should not change when we get the event! ExpectedPodSessionId:{0}; NewPodSessionId:{1}; PopSessionId:{2}",this.Ee.podSessionId,b.QW,this.Ee.uk):(this.Bb.ah(this.hne),za.a.J(25306393,801,15,"PodSessionManager::OnPodSessionRefreshed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; PodsUnavailableStartTime:{4}; PodsRefreshedTime:{5}",
this.Ee.presentationId.string,this.Ee.uk,b.HBb,b.QW,Kc.a.Ve(this.Lta||new Date),Kc.a.Ve(new Date)),this.Wd.qia=!1,this.la.podsSeamlessFailoverEnabled&&this.so.instance?za.a.J(36517715,801,15,"PodSessionManager::OnPodSessionRefreshed - Skip refresh Doc since seamless failover is on."):(a={failedMachineId:null,isPlanedShutdown:!1,isPodSessionRefreshed:!0},a.podSessionId=b.QW,this.ia.Ma(aa.a.WDb,2,a)),this.Lta=null)}eo(){this.Lta=null}}Object(e.a)(yi,"PodSessionManager",null,[1322]);var Vl;(function(a){a[a.active=
0]="active";a[a.passive=1]="passive";a[a.hidden=2]="hidden";a[a.frozen=3]="frozen"})(Vl||(Vl={}));Object(e.b)("AppVisibilityState",Vl);class wj{constructor(){this.IsTabHidden=!1;this.PresentationID=this.PopSessionID=null}}Object(e.a)(wj,"GetHostSessionInfoParams",null,[]);class Qi{constructor(a,b,c,f,l,w,F,S,fa,xa){this.X1c=0;this.YEa=this.lka=this.eoe=null;this.mNg=0;this.Gqe=!1;this.Za=b;this.azb=a;this.Xe=c;this.la=f;this.g8=l;this.NN=w;this.Sca=F;this.hc=S;this.cL=fa;this.Dua=xa;this.Dwb=0;this.Wyb=
this.la.getHostSessionInfoRequestTimeoutInMs;this.D3j=this.la.getHostSessionInfoRequestMaxTimeoutInMs;this.K3j=this.la.getHostSessionInfoPingIntervalForFailedResponseInMs;this.TXj=f.maxPopsRehydrationCount;this.one=this.la.N3g;this.bzb=this.la.podsPopSessionDisconnectedTimeLimitInMS;this.Aja=!1;this.pyb=this.Za.uk;this.SIg="";this.ddd();this.MHa(0,!0)}ddd(){this.X1c=0;this.YEa=new Date}Ngi(a){if(this.Gia&&!u.AFrameworkApplication.Xg&&this.hc.AK){var b=!1;this.Dua&&this.Dua.instance&&(b=2===this.Dua.instance.M2a,
this.Gqe||(this.Gqe=!0,this.Dua.instance.tGd(Object(C.a)(this,this.xCh,"visiblityChanged"))));var c=Object.assign(new wj,{PopSessionID:this.Za.uk,PresentationID:this.Za.presentationId.string,IsTabHidden:b});this.eoe=new Date;b=Math.min(this.Wyb+2E3*this.X1c,this.D3j);var f=va.a.cH("RequestTimeout",b.toString());this.azb.GLc(c,()=>{this.Khk(c.PopSessionID,a)},l=>{this.Jhk(l,c.PopSessionID,a)},null,f,this.la.getHostSessionInfoRequestTimeoutInMs,b+2E3)}else this.hc.AK&&(za.a.J(24655577,801,50,"HostSessionInfoCaller::CallGetHostSessionInfo - Skipped. IsClientActive:{0}; IsShuttingDown:{1}; IsNonDismissibleDialogShown:{2}; AppInReadMode:{3};",
this.Gia,u.AFrameworkApplication.Xg,!!this.g8.instance&&this.g8.instance.zSc,!this.hc.An),this.close(this.Gia?this.hc.AK?"AppShuttingDown":"TransitionedToReadingMode":"ClientDisabled"))}MHa(a,b){this.lka=new Date;this.mNg=window.setTimeout(()=>{this.Ngi(b)},a)}Ytl(a){za.a.J(24655581,801,50,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded - popSessionId:{0}, TimeTakenInMs:{1}",a,+new Date-+this.eoe);this.ddd();this.Dwb=0;this.Xe.bbe=this.YEa;this.Xe.abe=a}Khk(a,b){this.cL.Vhc();this.NN.S0f(a,
"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded")?this.MHa(0,b):(this.Ytl(a),b&&this.MHa(this.la.getHostSessionInfoPingIntervalInMs,!0))}xCh(a,b){za.a.J(592852376,801,50,"HostSessionInfoCaller.VisiblityChanged - Old:{0},  New:{1} ",Vl[b.oldState],Vl[b.newState]);this.MHa(0,!1)}phi(){return this.Sca.$3b||!this.Gia?(za.a.J(36320459,801,15,"HostSessionInfoCaller.CanRehydrateHostSession - Skip POPS Rehydration. IsPodSessionUnavailable:{0}; IsClientActive:{1}; Now:{2}",this.Sca.$3b,this.Gia,Kc.a.Ve(new Date)),
!1):this.Dwb>this.TXj?(za.a.J(36996355,801,10,"HostSessionInfoCaller::CanRehydrateHostSession: Skip POPS rehydration, abort the ping client and raise an ACE error because we exceeded max rehydration threshold. Total number of POPS created so far:{0}; Max Allowed:{1};",this.Dwb,this.la.maxPopsRehydrationCount),this.close("POPSRehydrationThresholdReached"),this.NN.H2d(kf.a.Fh(328),"HostSessionInfoCaller::CanRehydrateHostSession"),!1):!0}$da(a){this.phi()&&(++this.Dwb,this.NN.$da(a),this.ddd())}x7k(a){if(kf.a.tS(a))switch(kf.a.GM(a)){case 326:case 240:case 103:return!0;
case 329:return this.la.iKk}return!1}D0i(a){if(kf.a.tS(a))switch(kf.a.GM(a)){case 326:return 10;case 240:return 1;case 103:return 12;case 329:return 13;default:return 14}else return 14}Jhk(a,b,c){a.lX&&200===a.lX.tf&&this.cL.Vhc();if(this.NN.S0f(b,"HostSessionInfoCaller::OnGetHostSessionInfoFailed"))this.MHa(0,c);else{++this.X1c;var f=+new Date-+this.YEa,l=44,w=-1;a&&a.error&&(l=kf.a.tS(a.error.Gm)?kf.a.GM(a.error.Gm):44,w=a.error.Gm);a=va.a.cH("PopSessionId",b,"ServerErrorCode",l,"BSQMErrorCode",
w,"TimeTakenInMs",+new Date-+this.eoe,"RetryCount",this.X1c,"PopSessionDisconnectedTimeLimitInMS",this.bzb,"PopsIdleTimeLimitInMS",this.one,"Now",Kc.a.Ve(new Date),"CurrentDisconnectedTimeInMs",f,"PopSessionCreatedCount",this.Dwb,"LastPingScheduledTime",Kc.a.Ve(this.lka),"LastSuccessfulEnsureHostSessionId",this.Xe.$ae);b="";try{b=Sys.Serialization.JavaScriptSerializer.serialize(a)}catch(F){za.a.J(36320455,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Exception thrown while serializing the log string:{0};",
F)}za.a.J(24655583,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Ping request failed: "+b);+new Date-+this.lka>this.bzb?this.MHa(0,c):this.x7k(w)?this.$da(this.D0i(w),w):w===kf.a.Fh(370)?f<this.one?this.MHa(this.la.getHostSessionInfoPingIntervalInMs,c):this.$da(11,w):f>=this.bzb?this.$da(3,w):this.MHa(this.K3j,c)}}mce(a){const b=va.a.cH("LastUsedPopSessionId",this.pyb,"LastClientClosedReason",this.SIg,"IsClientActive",this.Gia,"AppInEditingMode",this.hc.An,"PopSessionDisconnectedTimeLimitInMS",
this.bzb,"PopsIdleTimeLimitInMS",this.one,"Now",Kc.a.Ve(new Date),"ConsecutivelyTriggeredPopsRehydrationCount",this.Dwb,"LastPingScheduledTime",Kc.a.Ve(this.lka),"LastSuccessfulEnsureHostSessionId",this.Xe.$ae);let c;try{c=Sys.Serialization.JavaScriptSerializer.serialize(b)}catch(f){za.a.J(51421313,801,15,"HostSessionInfoCaller::LogPopsState - Exception thrown while serializing the log string:{0};",f),c=""}za.a.J(51421315,801,15,"HostSessionInfoCaller::LogPopsState:{0} - {1}",a,c)}pHa(a){za.a.J(36282957,
801,15,"HostSessionInfoCaller.Reboot - Reason:{0}. Restarted on PopSession {1}. LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Za.uk,this.pyb,this.Gia);this.Gia&&this.pyb===this.Za.uk||(this.pyb=this.Za.uk,this.ddd(),this.Aja?(this.Aja=!1,this.MHa(0,!0)):za.a.J(51421318,801,15,"HostSessionInfoCaller.Reboot did not schedule a ping request as the client was not closed previously - Reason:{0}; PopSession:{1}; LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Za.uk,this.pyb,this.Gia))}close(a){this.Aja||
(za.a.J(36536660,801,15,"HostSessionInfoCaller.Close - PopSession:{0}; Now:{1}; Reason:{2};",this.Za.uk,Kc.a.Ve(new Date),a),this.Gqe&&this.Dua&&this.Dua.instance&&this.Dua.instance.LNk(Object(C.a)(this,this.xCh,"visiblityChanged")),this.Aja=!0,this.pyb="",this.SIg=a,window.clearTimeout(this.mNg))}get Gia(){return!this.Aja}}Object(e.a)(Qi,"HostSessionInfoCaller",null,[]);class Il{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb){this.yka=null;this.azb=a;this.Za=b;this.Oc=c;this.Xe=f;this.la=l;this.g8=w;this.NN=
F;this.Sca=S;this.hc=fa;this.cL=Za;this.Dua=pb;this.Oc.vGd(Object(C.a)(this,this.Lcb,"onPopSessionClosed"));this.Oc.wB(Object(C.a)(this,this.Pcb,"onSessionEnded"));this.Xe.Qea&&this.Oc.wGd(Object(C.a)(this,this.LVa,"onPopSessionInitialized"))}rvj(){za.a.J(24655587,801,50,"PopSessionInfoClient::InitializeGetHostSessionInfoClient");this.Xe.Yz?this.wve():this.Xe.Qea||this.Xe.Aec.task.continueWith(()=>{this.wve()})}LVa(){this.wve()}wve(){this.Xe.Qea?!this.yka&&this.Xe.Yz?this.yka=new Qi(this.azb,this.Za,
this.Xe,this.la,this.g8,this.NN,this.Sca,this.hc,this.cL,this.Dua):this.pHa("PopSessionInitialized"):this.Xe.Yz&&(this.glc(),this.yka=new Qi(this.azb,this.Za,this.Xe,this.la,this.g8,this.NN,this.Sca,this.hc,this.cL,this.Dua))}Lcb(){this.close("PopSessionClosed")}Pcb(){this.mce("SessionClosed")}mce(a){this.yka&&this.yka.mce(a)}glc(){this.Xe.Aec.task.continueWith(()=>{this.xve()})}xve(){this.Xe.Yz&&this.pHa("PopSessionInitialized");this.glc()}pHa(a){this.yka&&this.yka.pHa(a)}close(a){this.yka&&this.yka.close(a)}get Gia(){return!!this.yka&&
this.yka.Gia}dispose(){this.Oc.Zbh(Object(C.a)(this,this.Lcb,"onPopSessionClosed"));this.Xe.Qea&&this.Oc.BDe(Object(C.a)(this,this.LVa,"onPopSessionInitialized"))}}Object(e.a)(Il,"PopSessionInfoClient",null,[1323,109]);var on=d(281),Wm=d(218),Ik=d(110),Cn=d(640),Qj=d(359),Yj=d(838),Yk=d(827);const Fq=a=>{if(kf.a.tS(a)){a=kf.a.GM(a);if(Yk.a(a))return 1;switch(a){case 103:case 44:case 370:return 0;case 309:case 311:case 27:case 320:case 244:case 245:case 372:return 1;case 326:return 2;default:return 3}}else switch(a){case kf.a.lBa:case kf.a.iUc:return 0;
default:return 3}};class Jk{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb){this.Za=a;this.Xe=b;this.Wd=c;this.la=f;this.$u=l;this.TB=w;this.G8=F;this.H8=Za;this.hc=pb;this.Sca=fa;this.lKg=this.la.hermesNotRefreshErrorList;this.Wle=this.la.podsMaxRetryTimesForEnsureHostSession;this.TJg=this.la.podsMaxRetryDurationForEnsureHostSessionInMs;this.la.zg&&(S.x4h(Object(C.a)(this,this.umk,"onSyncLoopStatusNotified")),xa.p3h(Object(C.a)(this,this.smk,"onSuccessfulOutbound")),xa.Bga(Object(C.a)(this,this.Wz,"onUnifiedAppStateChanged")));
u.AFrameworkApplication.wz&&xa.Qzc(Object(C.a)(this,this.Hda,"onWopiTokenRefreshed"))}$da(a,b=null,c=null){var f=this.G8.F5a(this.Za.presentationId.string);f=Object.assign(new Cn.a,{ForceCreatePods:!1,DoRehydrate:!0,IsRetrySession:!1,PodSessionID:this.Za.podSessionId,PresentationID:this.Za.presentationId.string,PodEndpointUrl:this.la.podsWebServiceBase,PopSessionID:f,UrlOverrides:this.la.Rda,IsCoauthSession:u.AFrameworkApplication.Qg.IsCoauthSession,IsCreateNewSession:this.la.rS,UseSharedHostFile:this.la.oJb});
this.G8.WBc(f,b,c,a)}Fue(a,b){if(this.T0f(b,"PopSessionManager::OnEnsureHostSessionSucceeded"))this.qah();else{var c=new Date;this.Za.uk=b.aB.PopSessionID;this.Xe.Yz=!0;this.Xe.zec=!0;this.Xe.$ae=b.aB.PopSessionID;this.Xe.dja=c;this.Xe.Qea&&this.TB.$Ck();za.a.J(22934494,801,15,"PopSessionManager::OnEnsureHostSessionSucceeded - OldPopSessionID: {0}, ExpectedPopSessionId: {1}, ExpectedPodSessionId: {2}, CurrentPodSessionId:{3}, Trigger: {4}, Retries: {5}, StartTime: {6}, EndTime: {7}, Duration: {8}ms, ActionId: {9},",
b.CVa,b.aB.PopSessionID,b.aB.PodSessionID,this.Za.podSessionId,Yj.a[b.trigger],b.retryCount,Kc.a.Ve(b.startTime),Kc.a.Ve(c),+c-+b.startTime,b.actionId);b.FL&&b.FL(a)}}PBb(a,b){let c=a.error.Gm;const f=new Date;if(this.T0f(b,"PopSessionManager::OnEnsureHostSessionFailed -"))this.qah();else{if(b.retryCount<this.Wle&&+f-+b.startTime<=this.TJg){if(0===Fq(c)||c===kf.a.Fh(252)){b.retryCount++;a=this.G8.F5a(this.Za.presentationId.string);za.a.J(23349401,801,50,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, Now: {8}, Duration: {9}ms, bSqmErrorCode: {10}, ActionId: {11},",
"PopSessionManager::OnEnsureHostSessionFailed -",b.CVa,b.aB.PopSessionID,b.aB.PodSessionID,this.Za.podSessionId,Yj.a[b.trigger],b.retryCount,Kc.a.Ve(b.startTime),Kc.a.Ve(f),+f-+b.startTime,c,b.actionId);b.aB.PopSessionID=a;b.aB.IsRetrySession=!0;this.G8.hKf(b);return}this.Xe.dja=f;var l="FatalError"}else this.Xe.dja=f,l=b.retryCount>=this.Wle?String.format("Exceeded the limit of {0} times of retrying",this.Wle):String.format("EnsureHostSession duration exceeded the limit of {0}ms. ElapsedTime: {1}ms",
this.TJg,+f-+b.startTime);c===kf.a.lBa&&(c=0===b.trigger?kf.a.Fh(375):kf.a.Fh(309));za.a.J(23667161,801,10,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, EndTime: {8}, Duration: {9}, bSqmErrorCode: {10}, AbortReason: {11}, ActionId:{12},","PopSessionManager::OnEnsureHostSessionFailed -",b.CVa,b.aB.PopSessionID,b.aB.PodSessionID,this.Za.podSessionId,Yj.a[b.trigger],b.retryCount,Kc.a.Ve(b.startTime),
Kc.a.Ve(f),+f-+b.startTime,c,l,b.actionId);b.hy&&b.hy(a)||this.H2d(c,"PopSessionManager::OnEnsureHostSessionFailed -")}}T0f(a,b){return a.aB.PodSessionID!==this.Za.podSessionId?(za.a.J(38670611,801,15,"EnsureHostSession - Ignore response since PodSessionId is changed. CurrentPodsSession:{0}; RequestPodsSession:{1}; functionName:{2} Need to trigger another request immediately.",this.Za.podSessionId,a.aB.PodSessionID,b),!0):!1}qah(){this.Xe.dja=new Date;this.$da(8)}umk(a,b){a=kf.a.Fh(b.fth);za.a.J(24252761,
801,10," {0} - ServerErrorCode:{1}, bSqmErrorCode:{2}, PopSessionId:{3}, PodSessionId:{4}","PopSessionManager::OnSyncLoopStatusNotified",b.fth,a,this.Za.uk,this.Za.podSessionId);this.Xe.Yz=!1;this.Xe.Qea&&this.TB.CBe(new wl(this.Xe.eca));this.H2d(a,"PopSessionManager::OnSyncLoopStatusNotified",b.vMi)}Hda(a,b){try{b.RTc?(za.a.J(594040842,814,50,"PopSessionManager::OnWopiTokenRefreshed Token refresh succeeded."),b.IIj||(this.fob(()=>{},()=>{}),this.$da(9))):za.a.J(594040840,814,15,"PopSessionManager::OnWopiTokenRefreshed Token refresh failed.")}catch(c){za.a.J(594040838,
814,10,"PopSessionManager::OnWopiTokenRefreshed Exception: {0}",c)}}S0f(a,b){return a&&this.Za.uk&&this.Za.uk!==a?(za.a.J(51161217,801,15,"PopSessionManager::FStaleResponse - RequestingFunctionName:{0} - Ignore response since PopSessionId is changed. CurrentPopSessionId:{1}; RequestPopSessionId:{2}; LastAttemptedEnsureHostSessionId:{3};",b,this.Za.uk,a,this.Xe.eca),!0):!1}H2d(a,b,c=null){za.a.J(51212569,801,10,"PopSessionManager::HandlePOPSErrors:{0}; SourceFunction:{1};",a,b);if(!this.ejj(a)){if(u.AFrameworkApplication.wz&&
a===kf.a.Fh(320)){const f=on.a.instance.Aob();if(f){za.a.J(527700099,801,15,"PopSessionManager::HandlePOPSErrors:{0}; SessionExpired fTriggered:{1};",a,f);return}}this.$u.R2d(a,b)||this.BRd(a,b,c)}}fob(a,b,c=!1){za.a.J(51161219,801,15,"PopSessionManager::CallClosePopSession - PopSessionID: {0}, PodSessionId: {1}, PopSessionInitialized: {2}, LastAttemptedEnsureHostSessionId:{3}, PopSessionForceClosed:{4}",this.Za.uk,this.Za.podSessionId,this.Xe.Yz,this.Xe.eca,this.Xe.V9c);if(this.Xe.Yz||!this.Xe.V9c){if(this.hRe(c,
""))a(new Qj.a(null)),za.a.J(50946830,801,50,"sendBeacon request sent Time:{0}",Date.now());else{const f={};f["X-UsePopsRole"]=u.AFrameworkApplication.fa.ka("UsePopsRole").toString();this.H8.hDc(this.Xe.eca,this.Za.podSessionId,this.Za.presentationId.string,u.AFrameworkApplication.fa.appSettings[ba.a.pa(361)],this.Za.D9,c,a,b,null,f)}this.Xe.Yz=!1;this.Xe.V9c=!0;this.TB.CBe(new wl(this.Xe.eca))}}hRe(a,b){if(!r.a.Onb())return!1;try{const c=this.EWi(a,b),f=this.jXd();u.AFrameworkApplication.Be.RHa(f,
c);return!0}catch(c){return za.a.J(50946832,801,10,"Failed to send beacon request for ClosePopWacSession"),!1}}EWi(a,b){const c={};c.popSessionID=this.Xe.eca;c.podSessionID=b.length?b:this.Za.podSessionId;c.presentationID=this.Za.presentationId.string;c.podUrl=u.AFrameworkApplication.fa.appSettings[ba.a.pa(361)];c.podInstance=this.Za.D9;c.fTimeoutOrUserClose=a;return Ik.c(c)}jXd(){var a=u.AFrameworkApplication.fa.Ia(ba.a.pa(368));const b=u.AFrameworkApplication.fa.Ia(ba.a.pa(367));a=new Wm.QueryStringBuilder(a+
b+"/ClosePopWacSession");a.jA(u.AFrameworkApplication.zhb,u.AFrameworkApplication.userSessionId);a.jA(u.AFrameworkApplication.HJd,u.AFrameworkApplication.buildVersion);a.jA("waccluster",this.Za.qk);a.jA("WacUserType",u.AFrameworkApplication.userType);a.jA(u.AFrameworkApplication.Vvb,u.AFrameworkApplication.uVc);a.jA(u.AFrameworkApplication.JU,u.AFrameworkApplication.accessToken);a.jA(u.AFrameworkApplication.saa,u.AFrameworkApplication.Kl.toString());a.jA("X-UsePopsRole",this.Za.vxa.toString());a.jA("X-PopsAffinityRoutingEnabled",
this.Za.nDa.toString());return a.toString()}ejj(a){if(a!==kf.a.Fh(245))return!1;if(this.Xe.jyg>this.Xe.dja&&this.Xe.Yz)return za.a.J(36716887,801,15,"PopSessionManager::HandleFailedToGetPodsLatestBase - Got FailedToGetPodsLatestBase again."),!1;this.Xe.jyg=new Date;this.QLf(0);return!0}QLf(a){const b=this.Za.podSessionId;this.Sca.M7i(()=>{if(b!==this.Za.podSessionId)za.a.J(41760543,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",
b,this.Za.podSessionId);else{var c=kf.a.Fh(245);this.$u.R2d(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")||this.BRd(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")}},()=>{b!==this.Za.podSessionId?za.a.J(41760545,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",b,this.Za.podSessionId):this.Sca.$3b?za.a.J(36721681,801,15,"{0} - Skip. PODS unhealthy already",
"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"):a<this.la.N7i?(za.a.J(36716889,801,15,"{0} - Retry getting PODS health state. CurrentRetryCount:{1}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",a),this.QLf(a+1)):(za.a.J(36716891,801,10,"{0} - PODS is unhealthy. Trigger rehydration.","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"),this.Wd.Mr(Object.assign(new tj.a,{Code:223,Source:6}),b))})}BRd(a,b,c=null){za.a.J(50341070,801,10,
"PopSessionManager::DisplayPOPSErrors:{0}; RequestingFunction:{1};",a,b);const f=kf.a.GM(a);kf.a.tS(a)?(a=Object.assign(new tj.a,{Code:kf.a.GM(a),Source:5,ExtraErrorParam:c}),this.Wd.Mr(a,this.Za.podSessionId,l=>{l.$C=1;Array.contains(this.lKg,Ji.a[f].toUpperCase())||(l.cAa=8);399===f?(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_Unknown):384!==f&&(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_FailedToEnsurePopSession);
return!1})):(b=0,Array.contains(this.lKg,Ji.a[f].toUpperCase())||(b=8),this.Wd.tqa(a,b,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FailedToEnsurePopSession))}smk(){this.Xe.Yz||(za.a.J(36761941,801,15,"PopSessionManager::OnSuccessfulOutbound - PopSession not initialized. OldPopSessionID:{0}, PresentationID Null?:{1}",this.Za.uk,!this.Za.presentationId.string),this.$da(5))}Wz(a,b){qd.a("Pops.CloseSessionDueToReadonly")&&b.S8d&&!this.hc.AK&&this.Xe.Yz&&(za.a.J(556799191,
801,50,"PopSessionManager::OnUnifiedAppStateChanged - Close Pop session due to readonly"),this.fob(()=>{},()=>{}))}}Object(e.a)(Jk,"PopSessionManager",null,[1321]);class Tn{get name(){return"PowerPointWebEditor.PodsPops"}Yb(a){a.register(1321,"PowerPointWebEditor.PodsPopsCore.IPopSessionManager").ma().na(()=>new Jk(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));a.register(1322,"PowerPointWebEditor.PodsPopsCore.IPodSessionManager").ma().na(()=>
new yi(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),u.AFrameworkApplication.Be,a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.ITaskManager"),a.Oa("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.Oa("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier")));a.register(1323,"PowerPointWebEditor.PodsPops.IPopSessionInfoClient").ma().na(()=>
new Il(a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Oa("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.NotificationManager"),
a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.Oa("Common.App.VisibilityManagement.IVisibilityManager")))}init(){}dispose(){}static main(){m.a.instance.Ec(new Tn)}}Object(e.a)(Tn,"PPTWebEditorPodsPopsPackage",null,[2,3]);class bp{constructor(a,b,c,f,l){this.x8=new Ua.a;this.F6b=this.G6b=null;this.YDg=this.m7b=0;this.Aje=this.zje=!1;this.uxb=fe.a.Sda(2,0,!1);this.ZUa=fe.a.Sda(2,1,!1);this.X2c=a;this.Y7b=c;this.Qk=f;this.pq=b;this.OJg=l}get Mc(){return this.Y7b.Mc}NZg(a,b,c,f){if(!b)return!1;
this.zje||(this.m7b=Date.now(),this.zje=!0);b=!1;try{if(this.Qk.IFf(c.shapeNode)){this.x8.clear();this.sgi();const l=this.EYi(c);if(a){const F=this.Qk.qbj(this.Qk.RH(c,a),this.APa(l),this.Mc,this.uxb,this.ZUa);if(F.top||F.bottom||F.left||F.right)b=!0,this.Qk.Kkc(c,F);if(this.OJg){const S=this.Qk.G0i(this.Qk.RH(c,a),l,this.uxb,this.ZUa,f);if(S.top||S.bottom||S.left||S.right)b=!0,this.Qk.Kkc(c,S);const fa=this.Qk.H0i(this.Qk.RH(c,a),l,this.Mc,this.ZUa,f,a);if(fa.top||fa.bottom||fa.left||fa.right)b=
!0,this.Qk.Kkc(c,fa);const xa=this.Qk.R4i(this.Qk.RH(c,a),l,this.Mc,this.ZUa,f,a);if(xa.top||xa.bottom||xa.left||xa.right)b=!0,this.Qk.Kkc(c,xa)}}else b=this.Qk.xcl(c,this.Qk.RH(c,a),this.APa(l),this.Mc,this.uxb,this.ZUa);this.x8.addRange(this.Qk.agi(this.Qk.RH(c,a),this.APa(l),this.Mc));const w=this.Qk.aob(this.Qk.RH(c,a),this.APa(l));if(w.count)this.x8.addRange(w);else if(!b){let F;F=a?this.Qk.wcl(this.Qk.RH(c,!0),this.APa(l),c):this.Qk.vcl(this.Qk.RH(c,!1),this.APa(l),c,this.ZUa,this.uxb);this.x8.addRange(F);
b=!!F&&0<F.count}if(this.OJg)if(a)this.x8.addRange(this.Qk.vKd(this.Qk.RH(c,a),this.Qk.xPa(l),this.Mc,f,a)),this.x8.addRange(this.Qk.n3a(this.Qk.RH(c,a),this.Qk.xPa(l),this.Mc,f,a)),this.x8.addRange(this.Qk.jgi(this.Qk.RH(c,a),this.Qk.xPa(l),f));else{const F=this.Qk.n3a(this.Qk.RH(c,a),this.Qk.xPa(l),this.Mc,f,a);if(F.count)this.x8.addRange(F);else if(!b){const fa=this.Qk.zqh(this.Qk.RH(c,!1),this.APa(l),c,this.Mc,this.ZUa,this.uxb);this.x8.addRange(this.Qk.n3a(this.Qk.RH(c,a),this.Qk.xPa(l),this.Mc,
f,a));b=fa}const S=this.Qk.vKd(this.Qk.RH(c,a),this.Qk.xPa(l),this.Mc,f,a);if(S.count)this.x8.addRange(S);else if(!b){const fa=this.Qk.zqh(this.Qk.RH(c,!1),this.APa(l),c,this.Mc,this.ZUa,this.uxb);this.x8.addRange(this.Qk.vKd(this.Qk.RH(c,a),this.Qk.xPa(l),this.Mc,f,a));b=fa}}this.X2c.zXf(this.x8.toArray());this.X2c.visible=!0}}catch(l){this.Aje||(za.a.J(8959958,815,10,"SmartGuide - moving error {0}",l.toString()),this.Aje=!0)}return b}RZg(a){a&&(this.X2c.visible=!1,this.F6b=this.G6b=null,this.x8.clear(),
this.X2c.zXf([]),this.YDg=Date.now(),this.Aje=this.zje=!1,za.a.J(8959960,815,50,"SmartGuide - moving timespan {0}",(this.YDg-this.m7b).toString()))}sgi(){this.Qk.JUg=this.pq.jn(this.Mc.rT.offsetLeft-this.Mc.Qc.scrollLeft);this.Qk.KUg=this.pq.jn(this.Mc.rT.offsetTop-this.Mc.Qc.scrollTop)}EYi(a){return this.G6b?this.G6b:this.G6b=this.Qk.DYi(this.Qk.Caj(this.Mc,this.Mc.Na),a)}APa(a){return this.F6b?this.F6b:this.F6b=this.Qk.xPa(a)}}Object(e.a)(bp,"SmartGuideManager",null,[1312]);var qi=d(131),ge=d(165),
ri=d(190),ic=d(61),ng=d(153);class vd{constructor(){this.uXc=this.ZDa=null;this.VYc=0;this.e$a=this.tbb=null;this.z7e=!1}get color(){return this.ZDa}set color(a){this.ZDa=a}get dashStyle(){return this.uXc}set dashStyle(a){this.uXc=a}get Z0b(){return this.VYc}set Z0b(a){this.VYc=a}get Kf(){return this.tbb}set Kf(a){this.tbb=a}get Cg(){return this.e$a}set Cg(a){this.e$a=a}get sG(){return this.z7e}set sG(a){this.z7e=a}length(){let a=-1;this.tbb&&this.e$a&&(a=Math.sqrt(Math.pow(this.e$a._x-this.tbb._x,
2)+Math.pow(this.e$a._y-this.tbb._y,2)));return a}reset(){const a=new vd;this.ZDa=a.ZDa;this.uXc=a.uXc;this.VYc=a.VYc;this.tbb=a.tbb;this.e$a=a.e$a}}Object(e.a)(vd,"SmartGuideLine",null,[1447]);class Xm{constructor(a,b,c,f){this.distance=a;this.hJd=b;this.RSd=c;this.direction=f}}Object(e.a)(Xm,"DistancePair",null,[]);class qe{constructor(a,b){this.shape=a;this.tk=b}}Object(e.a)(qe,"LightSet",null,[]);class xl{constructor(a,b,c,f){this.begin=a;this.end=b;this.shape=c;this.distance=f}}Object(e.a)(xl,
"LightSetItem",null,[]);class Zk{constructor(){this.$9a={};this.NIg=[]}ga(a){return this.$9a[a]}$(a,b){a in this.$9a||this.NIg.push(a);return this.$9a[a]=b}get keys(){return this.NIg}}Object(e.a)(Zk,"NumberDictionary",null,[]);class gf{constructor(a,b){this.first=a;this.second=b}}Object(e.a)(gf,"NumberPair",null,[]);var wk=d(646);class Zj{constructor(a,b){this.Koe=[];this.tg=5;this.R2=this.Vv=2;this.EN=4;this.OA=3;this.H0c=this.G0c=0;this.pq=a;this.Szb=b}Caj(a,b){a=mb.GraphIterator.nb(a.gb);const c=
[];for(var f=a.yb(1);f;f=a.xf(1))f=ng.a(f,b),c.push(f);return c}RH(a,b){for(const c of this.Koe)if(c.zF(a))return c.RH(a,b);return null}addHandler(a){this.Koe.push(a)}vcl(a,b,c,f,l){f=this.Ohd(f,Zj.DBc);l=this.Ohd(l,Zj.DBc);for(var w of f){f=a.copy();f.move(0,0-w);f=this.aob(f,b);if(f.count)return this.uIa(c,0,-w),f;f=a.copy();f.move(0,w);f=this.aob(f,b);if(f.count)return this.uIa(c,0,w),f}for(let F of l){w=a.copy();w.move(0-F,0);w=this.aob(w,b);if(w.count)return this.uIa(c,-1*F,0),w;w=a.copy();w.move(F,
0);w=this.aob(w,b);if(w.count)return this.uIa(c,F,0),w}return new Ua.a}Ohd(a,b){const c=new Ua.a;a/=b;let f=0;for(let l=0;l<b;++l)f+=a,c.add(f);return c}wcl(a,b,c){var f=[];for(const l of f)if(f=a.copy(),f.setOffsets(l),f=this.aob(f,b),f.count)return this.Kkc(c,l),f;return new Ua.a}xPa(a){const b=[];for(const c of a)b.push(new wk.a(c.vs()));return b}xcl(a,b,c,f,l,w){const F=new ic.a(Number.MAX_VALUE,Number.MAX_VALUE);let S=Number.MAX_VALUE;var fa=Number.MAX_VALUE;let xa=[];for(const Za of c)xa.push(Za);
this.Szb&&(xa=this.X_h(xa,f));for(const Za of xa)c=this.m5i(b,Za,S),Math.abs(F.y)>Math.abs(c)&&(F.y=c),S=Math.abs(c),c=this.k5i(b,Za,fa),Math.abs(F.x)>Math.abs(c)&&(F.x=c),fa=Math.abs(c);fa=this.g0i(b,S,f);Math.abs(F.y)>Math.abs(fa)&&(F.y=fa);fa=this.f0i(b,S,f);Math.abs(F.x)>Math.abs(fa)&&(F.x=fa);Math.abs(F.x)>l&&(F.x=0);Math.abs(F.y)>w&&(F.y=0);return F.x||F.y?(this.uIa(a,F.x,F.y),!0):!1}X_h(a,b){var c=this.pq.jn(b.oe.width);b=this.pq.jn(b.oe.height);var f=new wk.a(new qi.a(new ic.a(0,0),new ic.a(c,
0),new ic.a(c,b),new ic.a(0,b)));a.push(f);f=new wk.a(new qi.a(new ic.a(0,0),new ic.a(c,0),new ic.a(c,b/2),new ic.a(0,b/2)));a.push(f);c=new wk.a(new qi.a(new ic.a(0,0),new ic.a(c/2,0),new ic.a(c/2,b),new ic.a(0,b)));a.push(c);return a}Kkc(a,b){this.BOc(a,c=>{c.setOffsets(a,b)})}uIa(a,b,c){this.BOc(a,f=>{f.setPosition(a,b,c)})}BOc(a,b){for(const c of this.Koe)if(c.zF(a)){b(c);break}}qbj(a,b,c,f,l){let w=Number.MAX_VALUE,F=Number.MAX_VALUE,S=Number.MAX_VALUE,fa=Number.MAX_VALUE;var xa=[];for(var Za of b)xa.push(Za.copy());
b=this.pq.jn(c.oe.width);c=this.pq.jn(c.oe.height);Za=new wk.a(new qi.a(new ic.a(0,0),new ic.a(b,0),new ic.a(b,c),new ic.a(0,c)));xa.push(Za);this.Szb&&(Za=new wk.a(new qi.a(new ic.a(0,0),new ic.a(b,0),new ic.a(b,c/2),new ic.a(0,c/2))),xa.push(Za),b=new wk.a(new qi.a(new ic.a(0,0),new ic.a(b/2,0),new ic.a(b/2,c),new ic.a(0,c))),xa.push(b));for(const pb of xa)xa=this.zed([pb.Xb-a.ic,pb.ic-a.ic,pb.$f().y-a.ic],l),this.yS(xa,l)&&Math.abs(xa)<Math.abs(w)&&(w=xa),xa=this.zed([pb.Xb-a.Xb,pb.ic-a.Xb,pb.$f().y-
a.Xb],l),this.yS(xa,l)&&Math.abs(xa)<Math.abs(F)&&(F=xa),xa=this.zed([pb.fc-a.fc,pb.$b-a.fc,pb.$f().x-a.fc],f),this.yS(xa,f)&&Math.abs(xa)<Math.abs(S)&&(S=xa),xa=this.zed([pb.fc-a.$b,pb.$b-a.$b,pb.$f().x-a.$b],f),this.yS(xa,f)&&Math.abs(xa)<Math.abs(fa)&&(fa=xa);a=new ri.a;a.top=w===Number.MAX_VALUE?a.top:w;a.bottom=F===Number.MAX_VALUE?a.bottom:F;a.left=S===Number.MAX_VALUE?a.left:S;a.right=fa===Number.MAX_VALUE?a.right:fa;return a}IFf(a){return a.osa||a.sk||a.ll||a.Gq||a.fg}S_i(a,b){return Math.abs(a-
b)}m5i(a,b,c){a=[new gf(a.ic,b.ic),new gf(a.ic,b.Xb),new gf(a.ic,b.$f().y),new gf(a.Xb,b.ic),new gf(a.Xb,b.Xb),new gf(a.Xb,b.$f().y),new gf(a.$f().y,b.ic),new gf(a.$f().y,b.Xb),new gf(a.$f().y,b.$f().y)];return this.fMc(a,c)}k5i(a,b,c){a=[new gf(a.fc,b.fc),new gf(a.fc,b.$b),new gf(a.fc,b.$f().x),new gf(a.$b,b.fc),new gf(a.$b,b.$b),new gf(a.$b,b.$f().x),new gf(a.$f().x,b.fc),new gf(a.$f().x,b.$b),new gf(a.$f().x,b.$f().x)];return this.fMc(a,c)}g0i(a,b,c){c=this.pq.jn(c.oe.height);a=[new gf(a.ic,0),
new gf(a.ic,c),new gf(a.Xb,0),new gf(a.Xb,c),new gf(a.$f().y,0),new gf(a.$f().y,c)];return this.fMc(a,b)}f0i(a,b,c){c=this.pq.jn(c.oe.width);a=[new gf(a.fc,0),new gf(a.fc,c),new gf(a.$b,0),new gf(a.$b,c),new gf(a.$f().x,0),new gf(a.$f().x,c)];return this.fMc(a,b)}fMc(a,b){let c=Number.MAX_VALUE;for(const f of a)a=this.S_i(f.first,f.second),a<b&&(b=a,c=f.second-f.first);return c}yS(a,b){a=Math.abs(a);return.2<a&&a<b}zed(a,b){let c=Number.MAX_VALUE;for(const f of a)this.yS(f,b)&&Math.abs(c)>Math.abs(f)&&
(c=f);return c}DYi(a,b){const c=new Ua.a;for(const f of a)this.IFf(f.shapeNode)&&f.gb!==b.gb&&c.add(f);return c.toArray()}aob(a,b){var c=new Ua.a;c.add(a);var f=new Ua.a;f.add(a);var l=new Ua.a;l.add(a);var w=new Ua.a;w.add(a);for(const F of b)F.Xb<a.ic||F.ic>a.Xb||(F.fc<a.fc&&this.Nyc(c,F,2),F.$b>a.$b&&this.Nyc(f,F,3)),F.$b<a.fc||F.fc>a.$b||(F.ic<a.ic&&this.Nyc(l,F,0),F.Xb>a.Xb&&this.Nyc(w,F,1));a=this.kMc(c,2);f=this.kMc(f,3);b=this.kMc(l,0);c=this.kMc(w,1);w=new Zk;this.VEc(w,a[0]);this.VEc(w,
f[0]);l=new Zk;this.VEc(l,b[0]);this.VEc(l,c[0]);this.OIc(w,a,2);this.OIc(w,f,3);this.OIc(l,b,0);this.OIc(l,c,1);a=new Ua.a;f=new Ua.a;this.zRf(w,a,f);this.zRf(l,a,f);this.pYa(a,1);this.pYa(f,2);a.addRange(f);for(let F of a)this.mv(F);return a}kMc(a,b){const c=new Ua.a;for(let l=0;l<a.count;++l){var f=new xl(this.a_i(a,l,b),this.u_i(a,l,b),null,-1);f=new qe(a.ga(l),[f]);for(let w=l+1;w<a.count;++w){const F=f.tk.length;let S=F;for(let fa=0;fa<F;++fa)if(!f.tk[fa].shape&&-1===f.tk[fa].distance&&f.tk[fa].end>
f.tk[fa].begin){const xa=this.T_i(a,l,w,b);S+=this.syk(a,w,fa,S,l,xa,f,b);S+=this.uyk(a,w,fa,S,l,xa,f,b);S+=this.izk(a,w,fa,S,l,xa,f,b);S+=this.tyk(a,w,fa,l,xa,f,b)}}c.add(f)}return c.toArray()}zRf(a,b,c){for(const l of a.keys){var f=a.ga(l);if(1<f.count){const w=new Ua.a;for(let F of f){f=!1;for(let S of w)if(this.M8h(F,S)){f=!0;w.remove(S);break}f||w.add(F)}for(let F of w)this.ywi(F,b,c)}}}M8h(a,b){return this.DFf(a.hJd,b.hJd)&&this.DFf(a.RSd,b.RSd)}DFf(a,b){return a.fc===b.fc&&a.$b===b.$b&&a.ic===
b.ic&&a.Xb===b.Xb}Nyc(a,b,c){const f=a.count;for(let l=0;l<f;l++){const w=a.ga(l);if(3===c&&(b.fc<a.ga(0).$b?b.$b:b.fc)<(w.fc<a.ga(0).$b?w.$b:w.fc)||2===c&&(b.$b>a.ga(0).fc?b.fc:b.$b)>(w.$b>a.ga(0).fc?w.fc:w.$b)||0===c&&(b.Xb>a.ga(0).ic?b.ic:b.Xb)>(w.Xb>a.ga(0).ic?w.ic:w.Xb)||1===c&&(b.ic<a.ga(0).Xb?b.Xb:b.ic)<(w.ic<a.ga(0).Xb?w.Xb:w.ic)){a.insert(l,b);return}}a.add(b)}VEc(a,b){for(const c of b.tk)0<c.distance&&a.$(Math.round(100*c.distance)/100,new Ua.a)}OIc(a,b,c){const f=new Zk;for(const l of b){for(const w of a.keys)f.$(w,
0);for(const w of l.tk)if(0<w.distance&&w.shape)for(const F of a.keys)if(b=F,this.fu(w.distance,b)){const S=f.ga(F);1>S&&(a.ga(F).add(new Xm(b,l.shape,w.shape,c)),f.$(F,S+1));break}}}a_i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.max(b.ic,a.ic);case 0:case 1:return Math.max(b.fc,a.fc);default:return-1}}u_i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.min(b.Xb,a.Xb);case 0:case 1:return Math.min(b.$b,a.$b);default:return-1}}syk(a,b,c,f,l,w,F,S){const fa=a.ga(b);
l=a.ga(l);switch(S){case 3:case 2:if(fa.Xb>=F.tk[c].begin&&fa.Xb<=F.tk[c].end&&fa.ic<=F.tk[c].begin)return a=new xl(F.tk[c].begin,fa.Xb,a.ga(b),3===S?w-l.$b:l.fc-w),F.tk[f]=a,F.tk[c].begin=fa.Xb,1;break;case 0:case 1:if(fa.$b>=F.tk[c].begin&&fa.$b<=F.tk[c].end&&fa.fc<=F.tk[c].begin)return a=new xl(F.tk[c].begin,fa.$b,a.ga(b),0===S?l.ic-w:w-l.Xb),F.tk[f]=a,F.tk[c].begin=fa.$b,1}return 0}uyk(a,b,c,f,l,w,F,S){const fa=a.ga(b);l=a.ga(l);switch(S){case 3:case 2:if(fa.ic>=F.tk[c].begin&&fa.ic<=F.tk[c].end&&
fa.Xb>=F.tk[c].end)return a=new xl(fa.ic,F.tk[c].end,a.ga(b),3===S?w-l.$b:l.fc-w),F.tk[f]=a,F.tk[c].end=fa.ic,1;break;case 0:case 1:if(fa.fc>=F.tk[c].begin&&fa.fc<=F.tk[c].end&&fa.$b>=F.tk[c].end)return a=new xl(fa.fc,F.tk[c].end,a.ga(b),0===S?l.ic-w:w-l.Xb),F.tk[f]=a,F.tk[c].end=fa.fc,1}return 0}izk(a,b,c,f,l,w,F,S){const fa=a.ga(b);l=a.ga(l);switch(S){case 3:case 2:if(fa.ic>F.tk[c].begin&&fa.ic<F.tk[c].end&&fa.Xb>F.tk[c].begin&&fa.Xb<F.tk[c].end)return a=new xl(fa.ic,fa.Xb,a.ga(b),3===S?w-l.$b:
l.fc-w),F.tk[f]=a,a=new xl(fa.Xb,F.tk[c].end,null,-1),F.tk[++f]=a,F.tk[c].end=fa.ic,2;break;case 0:case 1:if(fa.fc>F.tk[c].begin&&fa.fc<F.tk[c].end&&fa.$b>F.tk[c].begin&&fa.$b<F.tk[c].end)return a=new xl(fa.fc,fa.$b,a.ga(b),0===S?l.ic-w:w-l.Xb),F.tk[f]=a,a=new xl(fa.$b,F.tk[c].end,null,-1),F.tk[++f]=a,F.tk[c].end=fa.fc,2}return 0}tyk(a,b,c,f,l,w,F){const S=a.ga(b);f=a.ga(f);switch(F){case 3:case 2:S.ic<w.tk[c].begin&&S.Xb>w.tk[c].end&&(w.tk[c].shape=a.ga(b),w.tk[c].distance=3===F?l-f.$b:f.fc-l);break;
case 0:case 1:S.fc<w.tk[c].begin&&S.$b>w.tk[c].end&&(w.tk[c].shape=a.ga(b),w.tk[c].distance=0===F?f.ic-l:l-f.Xb)}return 0}T_i(a,b,c,f){let l=-1;c=a.ga(c);a=a.ga(b);switch(f){case 3:c.fc<a.$b&&c.$b>=a.$b&&(l=c.$b);c.fc>=a.$b&&(l=c.fc);break;case 2:c.$b>a.fc&&c.fc<=a.fc&&(l=c.fc);c.$b<=a.fc&&(l=c.$b);break;case 0:c.Xb>a.ic&&c.ic<=a.ic&&(l=c.ic);c.Xb<=a.ic&&(l=c.Xb);break;case 1:c.ic<a.Xb&&c.Xb>=a.Xb&&(l=c.Xb),c.ic>=a.Xb&&(l=c.ic)}return l}ywi(a,b,c){const f=a.hJd;var l=a.RSd;switch(a.direction){case 3:var w=
Math.max(f.Xb,l.Xb),F=new vd;F.Kf=new ic.a(f.$b-this.OA,f.ic);F.Cg=new ic.a(f.$b-this.OA,w+this.tg);b.add(F);F=new vd;F.Kf=new ic.a(f.$b+a.distance-this.OA,l.ic);F.Cg=new ic.a(f.$b+a.distance-this.OA,w+this.tg);b.add(F);b=new vd;b.Kf=new ic.a(f.$b-this.OA,w+this.tg);b.Cg=new ic.a(f.$b+a.distance-this.OA,w+this.tg);c.add(b);break;case 2:w=Math.max(f.Xb,l.Xb);F=new vd;F.Kf=new ic.a(f.fc-a.distance-this.OA,l.ic);F.Cg=new ic.a(f.fc-a.distance-this.OA,w+this.tg);b.add(F);l=new vd;l.Kf=new ic.a(f.fc-this.OA,
f.ic);l.Cg=new ic.a(f.fc-this.OA,w+this.tg);b.add(l);b=new vd;b.Kf=new ic.a(f.fc-a.distance-this.OA,w+this.tg);b.Cg=new ic.a(f.fc-this.OA,w+this.tg);c.add(b);break;case 0:w=Math.max(f.$b,l.$b);F=new vd;F.Kf=new ic.a(f.fc,f.ic-this.Vv);F.Cg=new ic.a(w+this.tg,f.ic-this.Vv);b.add(F);F=new vd;F.Kf=new ic.a(l.fc,f.ic-a.distance-this.Vv);F.Cg=new ic.a(w+this.tg,f.ic-a.distance-this.Vv);b.add(F);b=new vd;b.Kf=new ic.a(w+this.tg,f.ic-this.Vv);b.Cg=new ic.a(w+this.tg,f.ic-a.distance-this.Vv);c.add(b);break;
case 1:w=Math.max(f.$b,l.$b),F=new vd,F.Kf=new ic.a(f.fc,f.Xb-this.Vv),F.Cg=new ic.a(w+this.tg,f.Xb-this.Vv),b.add(F),F=new vd,F.Kf=new ic.a(l.fc,f.Xb+a.distance-this.Vv),F.Cg=new ic.a(w+this.tg,f.Xb+a.distance-this.Vv),b.add(F),b=new vd,b.Kf=new ic.a(w+this.tg,f.Xb-this.Vv),b.Cg=new ic.a(w+this.tg,f.Xb+a.distance-this.Vv),c.add(b)}}jgi(a,b,c){const f=new Ua.a;if(!c)return f;let l=!1;var w=!1;const F=c.equals(ge.a.west)||c.equals(ge.a.nu)||c.equals(ge.a.bH),S=c.equals(ge.a.east)||c.equals(ge.a.JD)||
c.equals(ge.a.YD),fa=c.equals(ge.a.north)||c.equals(ge.a.nu)||c.equals(ge.a.JD);c=c.equals(ge.a.south)||c.equals(ge.a.bH)||c.equals(ge.a.YD);for(const Za of b){if(this.cwg(a,Za,!0,b)&&(F||S)){l=!0;var xa=new vd;xa.Kf=new ic.a(Za.fc,Za.$f()._y);xa.Cg=new ic.a(Za.$b-this.OA,Za.$f()._y);xa.sG=!0;f.add(this.mv(xa))}this.cwg(a,Za,!1,b)&&(fa||c)&&(w=!0,xa=new vd,xa.Kf=new ic.a(Za.$f()._x,Za.ic),xa.Cg=new ic.a(Za.$f()._x,Za.Xb-this.R2),xa.sG=!1,f.add(this.mv(xa)))}l&&(b=new vd,b.Kf=new ic.a(a.fc,a.$f()._y),
b.Cg=new ic.a(a.$b-this.OA,a.$f()._y),b.sG=!0,f.add(this.mv(b)));w&&(w=new vd,w.Kf=new ic.a(a.$f()._x,a.ic),w.Cg=new ic.a(a.$f()._x,a.Xb-this.R2),w.sG=!1,f.add(this.mv(w)));this.pYa(f,2);return f}a4(a,b,c){var f=this.Mba(a,b,!1),l=this.Mba(a,b,!0);if(!f&&!l)return!1;let w=[];if(f){if(a.$b<=b.fc||a.$b<=b.$b){var F;var S=b.ic>a.ic?b.ic:a.ic;var fa=b.Xb<a.Xb?b.Xb:a.Xb;f=F=b.fc;a.$b>b.fc&&(f=F=b.$b);f=new wk.a(new qi.a(new ic.a(f,S),new ic.a(F,S),new ic.a(F,fa),new ic.a(f,fa)));Array.add(w,f)}if(a.fc>=
b.$b||a.fc>=b.fc)S=b.ic>a.ic?b.ic:a.ic,fa=b.Xb<a.Xb?b.Xb:a.Xb,f=F=b.$b,a.fc<b.$b&&(f=F=b.fc),f=new wk.a(new qi.a(new ic.a(f,S),new ic.a(F,S),new ic.a(F,fa),new ic.a(f,fa))),Array.add(w,f)}if(l){if(a.Xb<=b.ic||a.Xb<=b.Xb)l=b.fc>a.fc?b.fc:a.fc,S=b.$b<a.$b?b.$b:a.$b,f=F=b.ic,a.Xb>b.ic&&(f=F=b.Xb),l=new wk.a(new qi.a(new ic.a(l,f),new ic.a(S,f),new ic.a(S,F),new ic.a(l,F))),Array.add(w,l);if(a.ic>=b.Xb||a.ic>=b.ic)l=b.fc>a.fc?b.fc:a.fc,S=b.$b<a.$b?b.$b:a.$b,f=F=b.Xb,a.ic<b.Xb&&(f=F=b.ic),l=new wk.a(new qi.a(new ic.a(l,
f),new ic.a(S,f),new ic.a(S,F),new ic.a(l,F))),Array.add(w,l)}for(const xa of c)this.xig(xa,a)||this.xig(xa,b)||(w=this.msl(a,xa,w));return 0<w.length?!0:!1}msl(a,b,c){let f=[];for(const l of c)c=!0,l.fc===l.$b?(this.Mba(l,b,!1)||(c=!1),a.$b<=l.fc&&b.$b<=a.$b&&(c=!1),a.$b<=l.fc&&b.fc>=l.$b&&(c=!1),a.fc>=l.$b&&b.fc>=a.fc&&(c=!1),a.fc>=l.$b&&b.$b<=l.fc&&(c=!1),c?b.ic<=l.ic&&b.Xb<l.Xb?f=this.dJb(f,!0,!0,!1,l,b):b.Xb>=l.Xb&&b.ic>l.ic?f=this.dJb(f,!0,!1,!1,l,b):b.ic>l.ic&&b.Xb<l.Xb&&(f=this.dJb(f,!0,!1,
!0,l,b)):Array.add(f,l)):l.ic===l.Xb&&(this.Mba(l,b,!0)||(c=!1),a.Xb<=l.ic&&b.Xb<=a.Xb&&(c=!1),a.Xb<=l.ic&&b.ic>=l.Xb&&(c=!1),a.ic>=l.Xb&&b.ic>=a.ic&&(c=!1),a.ic>=l.Xb&&b.Xb<=l.ic&&(c=!1),c?b.fc<=l.fc&&b.$b<l.$b?f=this.dJb(f,!1,!0,!1,l,b):b.$b>=l.$b&&b.fc>l.fc?f=this.dJb(f,!1,!1,!1,l,b):b.fc>l.fc&&b.$b<l.$b&&(f=this.dJb(f,!1,!1,!0,l,b)):Array.add(f,l));return f}dJb(a,b,c,f,l,w){let F,S,fa,xa,Za,pb,Mb;if(c)b?(c=S=l.fc,F=w.Xb,fa=l.Xb):(F=fa=l.ic,c=w.$b,S=l.$b);else if(c||f){if(b?(c=S=xa=pb=l.fc,F=l.ic,
fa=w.ic,Za=w.Xb,Mb=l.Xb):(F=fa=Za=Mb=l.ic,c=l.fc,S=w.fc,xa=w.$b,pb=l.$b),f&&b&&!this.fu(Za,Mb)||f&&!b&&!this.fu(xa,pb))f=new wk.a(new qi.a(new ic.a(xa,Za),new ic.a(pb,Za),new ic.a(pb,Mb),new ic.a(xa,Mb))),Array.add(a,f)}else b?(c=S=l.fc,F=l.ic,fa=w.ic):(F=fa=l.ic,c=l.fc,S=w.fc);if(b&&!this.fu(F,fa)||!b&&!this.fu(c,S))b=new wk.a(new qi.a(new ic.a(c,F),new ic.a(S,F),new ic.a(S,fa),new ic.a(c,fa))),Array.add(a,b);return a}xig(a,b){return a.$b!==b.$b||a.fc!==b.fc||a.ic!==b.ic||a.Xb!==b.Xb?!1:!0}cwg(a,
b,c,f){if(c)return c=this.fu(a.fc,b.fc)&&this.fu(a.$b,b.$b),this.fu(a.$b-a.fc,b.$b-b.fc)&&!c&&this.a4(a,b,f);c=this.fu(a.ic,b.ic)&&this.fu(a.Xb,b.Xb);return this.fu(a.Xb-a.ic,b.Xb-b.ic)&&!c&&this.a4(a,b,f)}G0i(a,b,c,f,l){const w=new ri.a;if(!l)return w;let F=Number.MAX_VALUE,S=Number.MAX_VALUE,fa=Number.MAX_VALUE,xa=Number.MAX_VALUE;const Za=l.equals(ge.a.west)||l.equals(ge.a.nu)||l.equals(ge.a.bH),pb=l.equals(ge.a.east)||l.equals(ge.a.JD)||l.equals(ge.a.YD),Mb=l.equals(ge.a.north)||l.equals(ge.a.nu)||
l.equals(ge.a.JD);l=l.equals(ge.a.south)||l.equals(ge.a.bH)||l.equals(ge.a.YD);const hc=[];for(const kc of b)hc.push(new wk.a(kc.vs()));for(const kc of hc)b=kc.Xb-kc.ic-(a.Xb-a.ic),this.yS(b,f)&&Math.abs(b)<Math.abs(F)&&this.a4(a,kc,hc)&&Mb&&(F=-1*b),this.yS(b,f)&&Math.abs(b)<Math.abs(S)&&this.a4(a,kc,hc)&&l&&(S=b),b=kc.$b-kc.fc-(a.$b-a.fc),this.yS(b,c)&&Math.abs(b)<Math.abs(fa)&&this.a4(a,kc,hc)&&Za&&(fa=-1*b),this.yS(b,c)&&Math.abs(b)<Math.abs(xa)&&this.a4(a,kc,hc)&&pb&&(xa=b);w.top=F===Number.MAX_VALUE?
w.top:F;w.bottom=S===Number.MAX_VALUE?w.bottom:S;w.left=fa===Number.MAX_VALUE?w.left:fa;w.right=xa===Number.MAX_VALUE?w.right:xa;return w}H0i(a,b,c,f,l,w){let F=Number.MAX_VALUE,S=Number.MAX_VALUE,fa=Number.MAX_VALUE,xa=Number.MAX_VALUE,Za=!0,pb=!0,Mb=!0,hc=!0;w&&l&&(Za=l.equals(ge.a.west)||l.equals(ge.a.nu)||l.equals(ge.a.bH),pb=l.equals(ge.a.east)||l.equals(ge.a.JD)||l.equals(ge.a.YD),Mb=l.equals(ge.a.north)||l.equals(ge.a.nu)||l.equals(ge.a.JD),hc=l.equals(ge.a.south)||l.equals(ge.a.bH)||l.equals(ge.a.YD));
l=[];for(var kc of b)l.push(new wk.a(kc.vs()));b=this.pq.jn(c.oe.width);c=this.pq.jn(c.oe.height);for(const Ec of l)Ec.fc>b/2&&Ec.fc<3*b/4&&a.$b<b/2&&pb&&(kc=b/2-a.$b-(Ec.fc-b/2),this.yS(kc,f)&&Math.abs(kc)<Math.abs(xa)&&this.a4(a,Ec,l)&&(xa=kc)),Ec.$b<b/2&&Ec.$b>b/4&&a.fc>b/2&&Za&&(kc=b/2-Ec.$b-(a.fc-b/2),this.yS(kc,f)&&Math.abs(kc)<Math.abs(fa)&&this.a4(a,Ec,l)&&(fa=kc)),Ec.ic>c/2&&Ec.ic<3*c/4&&a.Xb<c/2&&hc&&(kc=c/2-a.Xb-(Ec.ic-c/2),this.yS(kc,f)&&Math.abs(kc)<Math.abs(S)&&this.a4(a,Ec,l)&&(S=kc)),
Ec.Xb<c/2&&Ec.Xb>c/4&&a.ic>c/2&&Mb&&(kc=c/2-Ec.Xb-(a.ic-c/2),this.yS(kc,f)&&Math.abs(kc)<Math.abs(F)&&this.a4(a,Ec,l)&&(F=kc));a=new ri.a;a.top=F===Number.MAX_VALUE?a.top:F;a.bottom=S===Number.MAX_VALUE?a.bottom:S;a.left=fa===Number.MAX_VALUE?a.left:fa;a.right=xa===Number.MAX_VALUE?a.right:xa;return a}zqh(a,b,c,f,l,w){l=this.Ohd(l,Zj.DBc);w=this.Ohd(w,Zj.DBc);for(var F of l){l=a.copy();l.move(0,0-F);if(this.n3a(l,b,f,null,!1).count)return this.uIa(c,0,-F),!0;l=a.copy();l.move(0,F);if(this.n3a(l,b,
f,null,!1).count)return this.uIa(c,0,F),!0}for(let S of w){F=a.copy();F.move(0-S,0);if(this.n3a(F,b,f,null,!1).count)return this.uIa(c,-1*S,0),!0;F=a.copy();F.move(S,0);if(this.n3a(F,b,f,null,!1).count)return this.uIa(c,S,0),!0}return!1}Mba(a,b,c){return c?a.fc>=b.fc&&a.fc<=b.$b||a.$b>=b.fc&&a.$b<=b.$b||b.fc>=a.fc&&b.fc<=a.$b||b.$b>=a.fc&&b.$b<=a.$b:a.ic>=b.ic&&a.ic<=b.Xb||a.Xb>=b.ic&&a.Xb<=b.Xb||b.ic>=a.ic&&b.ic<=a.Xb||b.Xb>=a.ic&&b.Xb<=a.Xb}vKd(a,b,c,f,l){const w=new Ua.a,F=new Ua.a,S=new Ua.a;
let fa=!1,xa=!1,Za=!1,pb=!1,Mb=!0,hc=!0,kc=!0,Ec=!0;l&&f&&(Mb=f.equals(ge.a.west)||f.equals(ge.a.nu)||f.equals(ge.a.bH),hc=f.equals(ge.a.east)||f.equals(ge.a.JD)||f.equals(ge.a.YD),kc=f.equals(ge.a.north)||f.equals(ge.a.nu)||f.equals(ge.a.JD),Ec=f.equals(ge.a.south)||f.equals(ge.a.bH)||f.equals(ge.a.YD));f=this.pq.jn(c.oe.width);c=this.pq.jn(c.oe.height);l=new vd;l.Kf=new ic.a(f/2-this.EN,0-this.Vv);l.Cg=new ic.a(f/2-this.EN,c-this.Vv);const Hc=new vd;Hc.Kf=new ic.a(0-this.EN,c/2-this.Vv);Hc.Cg=new ic.a(f-
this.EN,c/2-this.Vv);Hc.sG=!0;for(const Dc of b)Dc.fc>f/2&&Dc.fc<3*f/4&&a.$b<f/2&&this.a4(a,Dc,b)&&hc&&this.fu(f/2-a.$b,Dc.fc-f/2)&&(fa=!0,0>Dc.ic&&(l.Kf=new ic.a(f/2,Dc.ic)),Dc.Xb>c&&(l.Cg=new ic.a(f/2,Dc.Xb+this.tg)),w.add(this.CMa(Dc,!1,!1)),F.add(this.zMa(Dc,!1,!1,f,c))),Dc.$b<f/2&&Dc.$b>f/4&&a.fc>f/2&&this.a4(a,Dc,b)&&Mb&&this.fu(a.fc-f/2,f/2-Dc.$b)&&(xa=!0,0>Dc.ic&&(l.Kf=new ic.a(f/2,Dc.ic)),Dc.Xb>c&&(l.Cg=new ic.a(f/2,Dc.Xb+this.tg)),w.add(this.CMa(Dc,!1,!0)),F.add(this.zMa(Dc,!1,!0,f,c))),
Dc.ic>c/2&&Dc.ic<3*c/4&&a.Xb<c/2&&this.a4(a,Dc,b)&&Ec&&this.fu(c/2-a.Xb,Dc.ic-c/2)&&(Za=!0,0>Dc.fc&&(Hc.Kf=new ic.a(Dc.fc,c/2)),Dc.$b>f&&(Hc.Cg=new ic.a(Dc.$b+this.tg,c/2)),w.add(this.CMa(Dc,!0,!1)),F.add(this.zMa(Dc,!0,!1,f,c))),Dc.Xb<c/2&&Dc.Xb>c/4&&a.ic>c/2&&this.a4(a,Dc,b)&&kc&&this.fu(a.ic-c/2,c/2-Dc.Xb)&&(pb=!0,0>Dc.fc&&(Hc.Kf=new ic.a(Dc.fc,c/2)),Dc.$b>f&&(Hc.Cg=new ic.a(Dc.$b+this.tg,c/2)),w.add(this.CMa(Dc,!0,!0)),F.add(this.zMa(Dc,!0,!0,f,c)));(fa||xa)&&w.add(this.mv(l));(Za||pb)&&w.add(this.mv(Hc));
Za&&(a.fc<Hc.Kf._x&&(Hc.Kf=new ic.a(a.fc,c/2)),a.$b>Hc.Cg._x&&(Hc.Cg=new ic.a(a.$b,c/2+this.tg)),w.add(this.CMa(a,!0,!0)),F.add(this.zMa(a,!0,!0,f,c)));pb&&(a.fc<Hc.Kf._x&&(Hc.Kf=new ic.a(a.fc,c/2)),a.$b>Hc.Cg._x&&(Hc.Cg=new ic.a(a.$b,c/2+this.tg)),w.add(this.CMa(a,!0,!1)),F.add(this.zMa(a,!0,!1,f,c)));fa&&(a.ic<l.Kf._y&&(l.Kf=new ic.a(f/2,a.ic)),a.Xb>l.Cg._y&&(l.Cg=new ic.a(f/2,a.Xb+this.tg)),w.add(this.CMa(a,!1,!0)),F.add(this.zMa(a,!1,!0,f,c)));xa&&(a.ic<l.Kf._y&&(l.Kf=new ic.a(f/2,a.ic)),a.Xb>
l.Cg._y&&(l.Cg=new ic.a(f/2,a.Xb+this.tg)),w.add(this.CMa(a,!1,!1)),F.add(this.zMa(a,!1,!1,f,c)));this.pYa(w,1);this.pYa(F,2);for(let Dc of w)S.add(Dc);for(let Dc of F)S.add(Dc);return S}CMa(a,b,c){const f=b&&c,l=b&&!c,w=!b&&!c;return!b&&c?(b=new vd,b.Kf=new ic.a(a.$b-this.OA,a.Xb),b.Cg=new ic.a(a.$b-this.OA,a.Xb+this.tg),this.mv(b)):w?(b=new vd,b.Kf=new ic.a(a.fc-this.EN,a.Xb),b.Cg=new ic.a(a.fc-this.EN,a.Xb+this.tg),this.mv(b)):f?(b=new vd,b.Kf=new ic.a(a.$b,a.Xb-this.R2),b.Cg=new ic.a(a.$b+this.tg,
a.Xb-this.R2),this.mv(b)):l?(b=new vd,b.Kf=new ic.a(a.$b,a.ic-this.Vv),b.Cg=new ic.a(a.$b+this.tg,a.ic-this.Vv),this.mv(b)):null}zMa(a,b,c,f,l){const w=b&&c,F=b&&!c,S=!b&&!c;return!b&&c?(l=new vd,l.sG=!0,l.Kf=new ic.a(f/2-this.EN,a.Xb+this.tg),l.Cg=new ic.a(a.$b-this.OA,a.Xb+this.tg),this.mv(l)):S?(l=new vd,l.sG=!0,l.Kf=new ic.a(f/2-this.EN,a.Xb+this.tg),l.Cg=new ic.a(a.fc-this.EN,a.Xb+this.tg),this.mv(l)):w?(f=new vd,f.sG=!0,f.Kf=new ic.a(a.$b+this.tg,l/2-this.Vv),f.Cg=new ic.a(a.$b+this.tg,a.Xb-
this.R2),this.mv(f)):F?(f=new vd,f.sG=!0,f.Kf=new ic.a(a.$b+this.tg,l/2-this.Vv),f.Cg=new ic.a(a.$b+this.tg,a.ic-this.Vv),this.mv(f)):null}R4i(a,b,c,f,l,w){let F=Number.MAX_VALUE,S=Number.MAX_VALUE,fa=Number.MAX_VALUE,xa=Number.MAX_VALUE,Za=!0,pb=!0,Mb=!0,hc=!0;w&&l&&(Za=l.equals(ge.a.west)||l.equals(ge.a.nu)||l.equals(ge.a.bH),pb=l.equals(ge.a.east)||l.equals(ge.a.JD)||l.equals(ge.a.YD),Mb=l.equals(ge.a.north)||l.equals(ge.a.nu)||l.equals(ge.a.JD),hc=l.equals(ge.a.south)||l.equals(ge.a.bH)||l.equals(ge.a.YD));
l=[];for(const kc of b)l.push(new wk.a(kc.vs()));b=this.pq.jn(c.oe.width);c=this.pq.jn(c.oe.height);for(const kc of l)kc.$b>3*b/4&&kc.$b<b&&a.fc<b/4&&0<a.fc&&this.Mba(a,kc,!1)&&Za&&(l=b-kc.$b-a.fc,this.yS(l,f)&&Math.abs(l)<Math.abs(fa)&&(fa=l)),kc.fc<b/4&&0<kc.fc&&a.$b>3*b/4&&a.$b<b&&this.Mba(a,kc,!1)&&pb&&(l=b-a.$b-kc.fc,this.yS(l,f)&&Math.abs(l)<Math.abs(xa)&&(xa=l)),kc.Xb>3*c/4&&kc.Xb<c&&a.ic<c/4&&0<a.ic&&this.Mba(a,kc,!0)&&Mb&&(l=c-kc.Xb-a.ic,this.yS(l,f)&&Math.abs(l)<Math.abs(F)&&(F=l)),kc.ic<
c/4&&0<kc.ic&&a.Xb>3*c/4&&a.Xb<c&&this.Mba(a,kc,!0)&&hc&&(l=c-a.Xb-kc.ic,this.yS(l,f)&&Math.abs(l)<Math.abs(S)&&(S=l));a=new ri.a;a.top=F===Number.MAX_VALUE?a.top:F;a.bottom=S===Number.MAX_VALUE?a.bottom:S;a.left=fa===Number.MAX_VALUE?a.left:fa;a.right=xa===Number.MAX_VALUE?a.right:xa;return a}n3a(a,b,c,f,l){const w=new Ua.a,F=new Ua.a,S=new Ua.a;var fa=!1,xa=!1,Za=!1,pb=!1,Mb=!0;let hc=!0,kc=!0,Ec=!0;l&&f&&(Mb=f.equals(ge.a.west)||f.equals(ge.a.nu)||f.equals(ge.a.bH),hc=f.equals(ge.a.east)||f.equals(ge.a.JD)||
f.equals(ge.a.YD),kc=f.equals(ge.a.north)||f.equals(ge.a.nu)||f.equals(ge.a.JD),Ec=f.equals(ge.a.south)||f.equals(ge.a.bH)||f.equals(ge.a.YD));f=this.pq.jn(c.oe.width);c=this.pq.jn(c.oe.height);for(const Hc of b)Hc.$b>3*f/4&&Hc.$b<f&&a.fc<f/4&&0<a.fc&&this.Mba(a,Hc,!1)&&Mb&&this.fu(a.fc,f-Hc.$b)&&(fa=!0,b=new vd,b.Kf=new ic.a(Hc.$b-this.OA,Hc.Xb),b.Cg=new ic.a(Hc.$b-this.OA,Hc.Xb+this.tg),w.add(this.mv(b)),b=new vd,b.sG=!0,b.Kf=new ic.a(f-this.OA,Hc.Xb+this.tg),b.Cg=new ic.a(Hc.$b-this.OA,Hc.Xb+this.tg),
F.add(this.mv(b))),Hc.fc<f/4&&0<Hc.fc&&a.$b>3*f/4&&a.fc<f&&this.Mba(a,Hc,!1)&&hc&&this.fu(f-a.$b,Hc.fc)&&(xa=!0,b=new vd,b.Kf=new ic.a(Hc.fc-this.EN,Hc.Xb),b.Cg=new ic.a(Hc.fc-this.EN,Hc.Xb+this.tg),w.add(this.mv(b)),b=new vd,b.sG=!0,b.Kf=new ic.a(0-this.EN,Hc.Xb+this.tg),b.Cg=new ic.a(Hc.fc-this.EN,Hc.Xb+this.tg),F.add(this.mv(b))),Hc.Xb>3*c/4&&Hc.Xb<c&&a.ic<c/4&&0<a.ic&&this.Mba(a,Hc,!0)&&kc&&this.fu(a.ic,c-Hc.Xb)&&(Za=!0,b=new vd,b.Kf=new ic.a(Hc.$b,Hc.Xb-this.R2),b.Cg=new ic.a(Hc.$b+this.tg,Hc.Xb-
this.R2),w.add(this.mv(b)),l=new vd,b.sG=!0,l.Kf=new ic.a(Hc.$b+this.tg,Hc.Xb-this.R2),l.Cg=new ic.a(Hc.$b+this.tg,c-this.R2),F.add(this.mv(l))),Hc.ic<c/4&&0<Hc.ic&&a.Xb>3*c/4&&a.Xb<c&&this.Mba(a,Hc,!0)&&Ec&&this.fu(c-a.Xb,Hc.ic)&&(pb=!0,b=new vd,b.Kf=new ic.a(Hc.$b,Hc.ic-this.Vv),b.Cg=new ic.a(Hc.$b+this.tg,Hc.ic-this.Vv),w.add(this.mv(b)),l=new vd,b.sG=!0,l.Kf=new ic.a(Hc.$b+this.tg,0-this.Vv),l.Cg=new ic.a(Hc.$b+this.tg,Hc.ic-this.Vv),F.add(this.mv(l)));Za&&(Za=new vd,Za.Kf=new ic.a(a.$b,a.ic-
this.Vv),Za.Cg=new ic.a(a.$b+this.tg,a.ic-this.Vv),w.add(this.mv(Za)),Mb=new vd,Za.sG=!0,Mb.Kf=new ic.a(a.$b+this.tg,0-this.Vv),Mb.Cg=new ic.a(a.$b+this.tg,a.ic-this.Vv),F.add(this.mv(Mb)));pb&&(pb=new vd,pb.Kf=new ic.a(a.$b,a.Xb-this.R2),pb.Cg=new ic.a(a.$b+this.tg,a.Xb-this.R2),w.add(this.mv(pb)),Za=new vd,pb.sG=!0,Za.Kf=new ic.a(a.$b+this.tg,c-this.R2),Za.Cg=new ic.a(a.$b+this.tg,a.Xb-this.R2),F.add(this.mv(Za)));fa&&(fa=new vd,fa.Kf=new ic.a(a.fc-this.EN,a.Xb),fa.Cg=new ic.a(a.fc-this.EN,a.Xb+
this.tg),w.add(this.mv(fa)),fa=new vd,fa.sG=!0,fa.Kf=new ic.a(0-this.EN,a.Xb+this.tg),fa.Cg=new ic.a(a.fc-this.EN,a.Xb+this.tg),F.add(this.mv(fa)));xa&&(xa=new vd,xa.Kf=new ic.a(a.$b-this.OA,a.Xb),xa.Cg=new ic.a(a.$b-this.OA,a.Xb+this.tg),w.add(this.mv(xa)),xa=new vd,xa.sG=!0,xa.Kf=new ic.a(f-this.OA,a.Xb+this.tg),xa.Cg=new ic.a(a.$b-this.OA,a.Xb+this.tg),F.add(this.mv(xa)));this.pYa(w,1);this.pYa(F,2);for(let Hc of w)S.add(Hc);for(let Hc of F)S.add(Hc);return S}agi(a,b,c){var f=new vd;const l=new vd,
w=new vd,F=new vd,S=new vd,fa=new vd,xa=new Ua.a;xa.add(f);xa.add(l);xa.add(w);xa.add(F);xa.add(S);xa.add(fa);this.pYa(xa,0);this.Iwj(f,l,w,F,S,fa,a);for(const Za of b)this.U1(a.ic,Za.ic,Za.Xb,f,Za),this.U1(a.Xb,Za.ic,Za.Xb,l,Za),this.U1(a.fc,Za.fc,Za.$b,w,Za),this.U1(a.$b,Za.fc,Za.$b,F,Za),this.Szb&&(this.U1(a.ic,Za.$f()._y,null,f,Za),this.U1(a.Xb,Za.$f()._y,null,l,Za),this.U1(a.fc,Za.$f()._x,null,w,Za),this.U1(a.$b,Za.$f()._x,null,F,Za),this.U1(a.$f()._y,Za.ic,null,S,Za),this.U1(a.$f()._y,Za.Xb,
null,S,Za),this.U1(a.$f()._x,Za.fc,null,fa,Za),this.U1(a.$f()._x,Za.$b,null,fa,Za)),this.U1(a.$f()._y,Za.$f()._y,null,S,Za),this.U1(a.$f()._x,Za.$f()._x,null,fa,Za);0<f.length()&&0<l.length()&&(this.Szb?(S.Kf=new ic.a(a.fc-this.tg,a.$f()._y),S.Cg=S.Kf.copy()):S.reset());0<w.length()&&0<F.length()&&(this.Szb?(fa.Kf=new ic.a(a.$f()._x,a.fc-this.EN),fa.Cg=fa.Kf.copy()):fa.reset());if(this.Szb&&c){b=this.pq.jn(c.oe.width);c=this.pq.jn(c.oe.height);if(this.fu(a.ic,c/2)||Math.abs(a.ic)<=Zj.i3a||this.fu(a.ic,
c))f.Kf._x=Math.min(f.Kf._x,-1*this.tg),f.Cg._x=Math.max(f.Cg._x,b+this.tg);if(this.fu(a.Xb,c/2)||Math.abs(a.Xb)<=Zj.i3a||this.fu(a.Xb,c))l.Kf._x=Math.min(l.Kf._x,-1*this.tg),l.Cg._x=Math.max(l.Cg._x,b+this.tg);if(this.fu(a.$f()._y,c/2)||Math.abs(a.$f()._y)<=Zj.i3a||this.fu(a.$f()._y,c))S.Kf._x=Math.min(S.Kf._x,-1*this.tg),S.Cg._x=Math.max(S.Cg._x,b+this.tg);if(this.fu(a.$b,b/2)||Math.abs(a.$b)<=Zj.i3a||this.fu(a.$b,b))F.Kf._y=Math.min(F.Kf._y,-1*this.tg),F.Cg._y=Math.max(F.Cg._y,c+this.tg);if(this.fu(a.fc,
b/2)||Math.abs(a.fc)<=Zj.i3a||this.fu(a.fc,b))w.Kf._y=Math.min(w.Kf._y,-1*this.tg),w.Cg._y=Math.max(w.Cg._y,c+this.tg);if(this.fu(a.$f()._x,b/2)||Math.abs(a.$f()._x)<=Zj.i3a||this.fu(a.$f()._x,b))fa.Kf._y=Math.min(fa.Kf._y,-1*this.tg),fa.Cg._y=Math.max(fa.Cg._y,c+this.tg)}f=new Ua.a;for(let Za of xa)Za.Kf&&0<Za.length()&&(this.e0f(Za,a),f.add(this.mv(Za)));return f}U1(a,b,c,f,l){(this.fu(a,b)||this.fu(a,c))&&this.e0f(f,l)}e0f(a,b){a.sG?(a.Kf._x=Math.min(a.Kf._x,b.fc-this.tg),a.Cg._x=Math.max(a.Cg._x,
b.$b+this.tg)):(a.Kf._y=Math.min(a.Kf._y,b.ic-this.tg),a.Cg._y=Math.max(a.Cg._y,b.Xb+this.tg))}mv(a){let b;(b=a.Kf).x=b.x+this.G0c;let c;(c=a.Kf).y=c.y+this.H0c;let f;(f=a.Cg).x=f.x+this.G0c;let l;(l=a.Cg).y=l.y+this.H0c;return a}fu(a,b){var c=Zj.i3a;return!!a&&!!b&&Math.abs(a-b)<=c}Iwj(a,b,c,f,l,w,F){a.Kf=new ic.a(F.fc-this.tg,F.ic-this.Vv);a.Cg=a.Kf.copy();a.sG=!0;b.Kf=new ic.a(F.fc-this.tg,F.Xb-this.R2);b.Cg=b.Kf.copy();b.sG=!0;c.Kf=new ic.a(F.fc-this.EN,F.ic-this.tg);c.Cg=c.Kf.copy();f.Kf=new ic.a(F.$b-
this.OA,F.ic-this.tg);f.Cg=f.Kf.copy();b=F.$f();l.Kf=new ic.a(a.Kf._x-this.tg,b._y-this.Vv);l.Cg=l.Kf.copy();l.sG=!0;w.Kf=new ic.a(b._x-this.tg,c.Kf._y-this.tg);w.Cg=w.Kf.copy()}pYa(a,b){for(let c of a)0===b?(c.color=Fe.a.sni,c.dashStyle="4,4",c.Z0b=0):1===b?(c.color=Fe.a.rni,c.dashStyle="4,4",c.Z0b=1):2===b&&(c.color=Fe.a.VNf,c.dashStyle="4,4",c.Z0b=2)}get JUg(){return this.G0c}set JUg(a){this.G0c=a}get KUg(){return this.H0c}set KUg(a){this.H0c=a}}Zj.i3a=.4;Zj.DBc=5;Object(e.a)(Zj,"SmartGuideUtility",
null,[1314]);var Ym=d(140),pn=d(205),qn=d(173),Un=d(203);class rn{constructor(a,b,c,f,l){this.Uzb=this.Vzb=this.Ab=null;this.mka=new Sys.UI.Bounds(0,0,0,0);this.gGa=1;this.Sb=!1;this.Hg=a;this.vi=b;this.zd=f;this.Kc=c;this.zd.ESb(Object(C.a)(this,this.onResize,"onResize"));l&&this.zd.HMa(Object(C.a)(this,this.z_,"onActiveSlideDomDisplayed"));this.Vm()}get visible(){return!!this.Ab&&this.Sb}set visible(a){this.Ab||this.Vm();this.Sb!==a&&(this.Ab.Sd(a),this.Sb=a)}zXf(a){this.Uzb&&this.Vzb.za.removeChild(this.Uzb.za);
this.Uzb=new pn.a;let b=0;for(;b<a.length;b++){const c=a[b],f=new qn.a,l=rn.wQj(rn.z9g(ic.a.scale(c.Kf,this.gGa,this.gGa)),rn.z9g(ic.a.scale(c.Cg,this.gGa,this.gGa)));f.Mt(l);f.pv(this.v5f(c.color));f.Kma(c.dashStyle);f.sr(1);this.Uzb.appendChild(f);2===c.Z0b&&this.jHi(l[0],l[1])}this.Vzb.appendChild(this.Uzb)}jHi(a,b){a._y===b._y?a._x<b._x?this.JQf(a,b):this.JQf(b,a):a._y>b._y?this.KQf(a,b):this.KQf(b,a)}JQf(a,b){const c=this.YJf(b._x-a._x);this.xEc([new ic.a(a._x,a._y),new ic.a(a._x+c,a._y-c/2),
new ic.a(a._x+c,a._y+c/2)]);this.xEc([new ic.a(b._x,b._y),new ic.a(b._x-c,b._y-c/2),new ic.a(b._x-c,b._y+c/2)])}KQf(a,b){const c=this.YJf(a._y-b._y);this.xEc([new ic.a(a._x,a._y),new ic.a(a._x-c/2,a._y-c),new ic.a(a._x+c/2,a._y-c)]);this.xEc([new ic.a(b._x,b._y),new ic.a(b._x-c/2,b._y+c),new ic.a(b._x+c/2,b._y+c)])}YJf(a){return Math.min(a,10)/2}xEc(a){const b=new qn.a,c=this.v5f(Fe.a.VNf);b.Mt(a);b.pv(c);b.sr(1);b.xF(c);b.Sd(!0);this.Uzb.appendChild(b)}v5f(a){return this.vi&&this.vi.highContrastColors?
this.vi.highContrastColors.foregroundTextColor:a}Vm(){this.Ab=new Ym.a;this.Ab.gt("SmartGuideView");this.Ab.Uk(0);this.Ab.Sd(!1);this.Hg.za.appendChild(this.Ab.za);this.Vzb=new Un.a;this.Vzb.za.style.overflow="visible";this.Ab.appendChild(this.Vzb);this.Ss(this.Kc.Mc)}onResize(a,b){b&&this.Ss(b.BF)}z_(a,b){b&&this.Ss(b.BF)}Ss(a){this.Ab&&a&&a.oe&&a===this.Kc.Mc&&(this.mka.x!==a.oe.x||this.mka.y!==a.oe.y||this.mka.width!==a.oe.width||this.mka.height!==a.oe.height)&&(this.mka=new Sys.UI.Bounds(a.oe.x,
a.oe.y,a.oe.width,a.oe.height),this.Ab.setPosition(a.oe.x,a.oe.y),this.Vzb.Bh(a.oe.width,a.oe.height),this.Ab.Bh(a.oe.width,a.oe.height))}static wQj(a,b){b._y===a._y||Math.abs(b._y-a._y)%2||(b._y+=1);b._x===a._x||Math.abs(b._x-a._x)%2||(b._x+=1);return[a,b]}static z9g(a){return new ic.a(Math.floor(a.x)+.5,Math.floor(a.y)+.5)}}Object(e.a)(rn,"SmartGuideView",null,[1313]);class Ri{setPosition(a,b,c){a.setPosition(a.x+b,a.y+c,!0)}setOffsets(a,b){a.setOffsets(ri.a.add(a.BVa,b),!0)}RH(a){return new wk.a(a.vs())}zF(a){return!a.shapeNode.qy}}
Object(e.a)(Ri,"DefaultShapeMoveResizeHandler",null,[870]);class cp{constructor(){this.K=null}get name(){return"PowerPointWebEditor.SmartGuide"}Yb(a){this.K=a;this.K.register(1312,"PowerPointWebEditor.ISmartGuideManager").ma().na(()=>new bp(this.K.resolve("PowerPointWebEditor.ISmartGuideView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ISmartGuideUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesMarginCenterEquisizing));
this.K.register(1313,"PowerPointWebEditor.ISmartGuideView").ma().na(()=>new rn(this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").ssa));this.K.register(1314,"PowerPointWebEditor.ISmartGuideUtility").ma().na(()=>new Zj(this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesAlignToSlideAndCenterEdge))}init(){this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new Ri)}dispose(){}static main(){m.a.instance.Ec(new cp)}}Object(e.a)(cp,"PPTWebEditorSmartGuidePackage",null,[2,3]);class Jl{}Jl.Jzg=[D.a.backspace,D.a.vpb,D.a.dK,D.a.yWb,D.a.HAa,D.a.enter,D.a.Ggd,D.a.WA,D.a.tab,D.a.Wjc,D.a.pageDown,D.a.pageUp,D.a.sVa,D.a.ese,D.a.rVa,D.a.dse];Jl.BSj=[D.a.backspace,D.a.vpb,D.a.dK,D.a.yWb,D.a.HAa,
D.a.enter,D.a.Ggd,D.a.WA,D.a.tab,D.a.Wjc,D.a.font,D.a.p4,D.a.KHa,D.a.rr,D.a.dHa,D.a.$Wa,D.a.XH,D.a.gJ,D.a.bold,D.a.setItalic,D.a.underline,D.a.strikethrough,D.a.Ms,D.a.T9,D.a.aAa,D.a.TQ,D.a.UQ,D.a.BE,D.a.Qy,D.a.Xga,D.a.ija,D.a.wma,D.a.wBa,aa.a.Ola,aa.a.Ula,aa.a.Tla,aa.a.Sla,D.a.lOa,D.a.Mra,D.a.Vwa,D.a.Wwa,D.a.Xwa,D.a.MIa,D.a.NIa,D.a.iQc,D.a.jQc,D.a.D7a,D.a.XQa,D.a.G7a,D.a.LCa,D.a.Zaa,aa.a.WCb,D.a.deleteRow,aa.a.g$c,D.a.GAa,aa.a.rye,D.a.insertTable,aa.a.yye,D.a.Mza,D.a.v1,aa.a.yva,aa.a.fWa,aa.a.yfb,
aa.a.IXa,aa.a.mwa,aa.a.JXa,aa.a.Mhd,aa.a.Lhd,D.a.jO,D.a.$Qa,D.a.centerJustify,D.a.leftJustify,D.a.rightJustify,D.a.fullJustify,D.a.oXb,D.a.Y4b,D.a.Gjc,aa.a.$fb,aa.a.agb,aa.a.bgb,aa.a.cgb,D.a.HTb];Jl.MWk=[D.a.leftArrow,D.a.rightArrow,D.a.upArrow,D.a.downArrow,D.a.QXa,D.a.PXa,D.a.yAa,D.a.xAa,D.a.YNa,D.a.XNa,D.a.uGb,D.a.Kfb,D.a.zWb,D.a.wpb,D.a.c4a,D.a.WNa,D.a.sVa,D.a.VOa,D.a.icb,D.a.hcb,D.a.V4a,D.a.rVa,D.a.UOa,D.a.U4a,D.a.Dqa,D.a.Hgd,aa.a.Nic,aa.a.LIb,aa.a.aYa,aa.a.WGb];Object(e.a)(Jl,"ActionIdList",
null,[]);class Je{constructor(){this.ActionTime=this.ActionName=this.ActionId=null}}Object(e.a)(Je,"ActionInformation",null,[]);class Zm{constructor(a,b,c,f,l,w){this.q9a=[];this.W5b=[];this.rI=a;this.Oce=b||[];this.ia=c;this.ia.bma(this);this.Za=f;this.jta=l;this.CG=w}w9(a){this.Znh(a)&&this.Oma(a.actionId)&&(this.q9a.push(a.actionId),this.W5b.push(Date.now()))}u9(a){this.Znh(a)&&this.Oma(a.actionId)&&(this.q9a.pop(),this.W5b.pop())}Oma(a){if(Array.contains(this.Oce,a))return!0;a=this.ia.eS(a);return!!a&&
!(a.flags[32]||a.flags[64])}Znh(a){return 2===a.behavior&&a.Ui?!0:!1}getCommandName(a,b=""){return(a=this.rI?this.rI.x4(a):null)?a:b}x_(a){a&&a.kqa&&za.a.J(23594504,822,50,"ClientRevisionId:{0}, ActionName:{1}, PodSID:{2}, UndoAction:{3}",a.kqa.toString(),this.actionName||(this.jta.fd===D.a.typing||this.jta.fd===D.a.Rza||this.jta.fd===D.a.jOa?"Typing":null)||(this.CG.eRc?"ClosingTextUndoStack":""),this.Za.podSessionId||"",this.rI.x4(this.jta.fd));return!!this.q9a.length}update(a,b){a=new Je;a.ActionId=
this.n$f();a.ActionName=this.o$f();a.ActionTime=this.P3i().toString();mk.a.Ao(b,zb.a.tXh,a);b.setValue(zb.a.k2b,!0);b.setValue(zb.a.Edd,1)}get actionName(){return this.o$f()}get actionId(){return this.n$f()}rZd(){return this.q9a[this.q9a.length-1]}n$f(){return this.q9a.length?this.rZd().toString():null}o$f(){return this.q9a.length?this.getCommandName(this.rZd(),this.rZd().toString()):null}P3i(){return this.W5b.length?this.W5b[this.W5b.length-1]:Number.MAX_VALUE}}Object(e.a)(Zm,"ActionInfoRevisionMetaDataUpdater",
null,[1364,146]);class Ap{constructor(){this.va=new sd.a}r9g(a){this.va.raiseEvent("UCI",a)}M4h(a){this.va.addHandler("UCI",a)}COk(a){this.va.removeHandler("UCI",a)}}Object(e.a)(Ap,"CcpEventSource",null,[1429,1430,1431]);class to{constructor(a,b){this.x6b=this.Wde=this.Vde=null;this.Xde=a;this.eT=b;this.Xde.M4h(Object(C.a)(this,this.eWg,"onCcpPropertyChanged"))}eWg(a,b){this.Vde=b.Dp;this.Wde=b.Yhi;this.x6b=b.Zhi}x_(a){a=this.eT.aCa(a.Uva);!this.x6b&&a.Sa(zb.a.D3a)&&(a.removeProperty(zb.a.EM),a.removeProperty(zb.a.jP),
a.removeProperty(zb.a.D3a));return!!this.x6b}update(a,b){b.setValue(zb.a.EM,this.Vde);b.setValue(zb.a.jP,this.Wde);b.setValue(zb.a.D3a,this.x6b);this.x6b=this.Wde=this.Vde=null}dispose(){this.Xde&&this.Xde.COk(Object(C.a)(this,this.eWg,"onCcpPropertyChanged"))}}Object(e.a)(to,"CcpInfoRevisionMetaDataUpdater",null,[1310,1364,109]);var Vn=d(315);class zi extends Zf.a{constructor(a,b,c,f,l,w,F){super();this.ShapeId=this.Sid=this.Cid=0;this.FetchImageData=!1;this.AuthToken=this.Origin=this.SessionUrl=
null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.FetchImageData=f;this.SessionUrl=l;this.Origin=w;this.AuthToken=F}Lk(){return 108}}Object(e.a)(zi,"AugmentImageRequest",Zf.a,[]);class Ll extends Zf.a{constructor(){super()}Lk(){return 81}}Object(e.a)(Ll,"FlushRequest",Zf.a,[]);class Wl extends Zf.a{constructor(a,b,c,f,l,w){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.DeckSuggestionId=this.SessionId=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.SessionId=
f;this.DeckSuggestionId=l;this.Hints=w}Lk(){return 111}}Object(e.a)(Wl,"GenerateAgendaDeckSuggestionRequest",Zf.a,[]);class Bg extends Zf.a{constructor(a,b,c,f,l){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.OutlineJson=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.OutlineJson=f;this.Hints=l}Lk(){return 110}}Object(e.a)(Bg,"GenerateAgendaSuggestionRequest",Zf.a,[]);class Ko extends Zf.a{constructor(a,b,c,f,l,w,F,S,fa,xa){super();this.ShapeViewHeight=
this.ShapeViewWidth=this.ShapeId=this.Sid=this.Cid=0;this.SubNodeId=null;this.SubNodeHeight=this.SubNodeWidth=0;this.Trigger=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.ShapeViewWidth=f;this.ShapeViewHeight=l;this.SubNodeId=w;this.SubNodeWidth=F;this.SubNodeHeight=S;this.CorrelationId=fa;this.Trigger=xa}Lk(){return 99}}Object(e.a)(Ko,"GenerateIconSuggestionRequest",Zf.a,[]);class xk extends Zf.a{constructor(a,b,c,f){super();this.ImageKey=this.GraphNodeId=null;this.IsGenerateSuggestion=
this.IsSVGBlipFill=!1;this.GraphNodeId=ae.a(a);this.ImageKey=b;this.IsSVGBlipFill=c;this.IsGenerateSuggestion=f}Lk(){return 91}}Object(e.a)(xk,"GenerateImageDescriptionRequest",Zf.a,[]);class Kk extends Zf.a{constructor(a,b,c,f,l,w,F){super();this.Sid=this.Cid=0;this.Hints=this.LastShownCorrelationId=this.Trigger=this.TermCorrelationId=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.CorrelationId=c;this.TermCorrelationId=f;this.Trigger=l;this.LastShownCorrelationId=w;this.Hints=F}Lk(){return 66}}
Object(e.a)(Kk,"GenerateSuggestionRequest",Zf.a,[]);class yl extends Kk{constructor(a,b,c,f,l,w,F,S){super(a,b,f,null,l,w,"");this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=0;this.ShapeId=c;this.ShapeViewWidth=F;this.ShapeViewHeight=S}Lk(){return 83}}Object(e.a)(yl,"GenerateReplaceObjectRequest",Kk,[]);class Wn extends Zf.a{constructor(a,b,c){super();this.m_shapeid=this.m_cid=this.m_slideid=0;this.m_slideid=a;this.m_cid=b;this.m_shapeid=c}Lk(){return 57}}Object(e.a)(Wn,"GetPictureCropInfoRequest",
Zf.a,[]);class zl extends Zf.a{constructor(){super();this.SlideCid=this.SlideSid=this.Scenario=0;this.ShapeIds=null}Lk(){return 109}}Object(e.a)(zl,"ImageTransformRequest",Zf.a,[]);class xj extends Zf.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}Lk(){return 84}}Object(e.a)(xj,"ReportReplaceObjectInfoRequest",Zf.a,[]);class $k extends Zf.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=
b}Lk(){return 67}}Object(e.a)($k,"ReportSuggestionSessionInfoRequest",Zf.a,[]);class yj extends Zf.a{constructor(a,b,c){super();this.SlideId=null;this.ShapeId=0;this.Base64OfSnapshot=null;this.SlideId=a;this.ShapeId=b;this.Base64OfSnapshot=c}Lk(){return 59}}Object(e.a)(yj,"UpdateContentAddinSnapshotInfoRequest",Zf.a,[]);class En{constructor(a,b,c){this.CG=a;this.Wb=b;this.gDg=c}get eRc(){return this.CG.eRc}G3a(a,b=!1){this.CG.G3a(a,b)}forceOutbound(){this.CG.forceOutbound()}lea(a,b,c=!1){this.CG.lea(a,
b,c)}Syc(a){this.CG.Syc(a)}Vrb(a){return this.CG.Vrb(a)}Hb(a){this.CG.Hb(a)}dbg(a,b,c,f=null,l=null,w=!1){a=new Mj.a(new Wn(a,b,c),f,l,F=>0===F.StatusCode);this.CG.lea(a,this.Wb,w)}Oha(a,b,c,f,l,w,F,S=null,fa=null){a=new Mj.a(new Kk(a,b,c,f,l,w,F),S,fa,xa=>0===xa.StatusCode);this.CG.lea(a,this.Wb)}generateImageDescription(a,b,c,f){a=new Mj.a(new xk(a,b,c,f),null,null,l=>0===l.StatusCode);this.CG.lea(a,this.Wb)}qma(a,b,c){a=new Mj.a(new $k(a,b),null,()=>!0,f=>0===f.StatusCode);this.CG.lea(a,this.Wb,
c)}d5f(a,b,c,f,l,w,F,S=null,fa=null){a=new Mj.a(new yl(a,b,c,f,l,null,w,F),S,fa,xa=>0===xa.StatusCode);this.CG.lea(a,this.Wb)}hQk(a,b,c=null,f=null){a=new Mj.a(new xj(a,b),c,f,l=>0===l.StatusCode);this.CG.lea(a,this.Wb)}xUi(a,b,c,f,l,w,F,S,fa=null,xa=null){a=new Mj.a(new Ko(a,b,c,f,l,w,74,74,F,S),fa,xa,Za=>0===Za.StatusCode);this.CG.lea(a,this.Wb)}augmentImage(a,b,c,f,l,w,F,S=null,fa=null){a=new Mj.a(new zi(a,b,c,f,l,w,F),S,fa,xa=>0===xa.StatusCode);this.CG.lea(a,this.Wb)}generateAgendaSuggestion(a,
b,c,f,l,w=null,F=null){a=new Mj.a(new Bg(a,b,c,f,l),w,F,S=>0===S.StatusCode);this.CG.lea(a,this.Wb)}generateAgendaDeckSuggestion(a,b,c,f,l,w,F=null,S=null){a=new Mj.a(new Wl(a,b,c,f,l,w),F,S,fa=>0===fa.StatusCode);this.CG.lea(a,this.Wb)}vzh(a,b,c,f=null,l=null){const w=new Mj.a(new yj(a,b,c),f,l,fa=>0===fa.StatusCode),F=()=>{this.BLi(w)};a=this.CG.Vrb(this.Wb.Bf);const S=new Vn.a;a?a.forceOutbound(()=>{F()},l?()=>{l(S)}:null,null):(za.a.J(20460503,823,10,"Can't find graph space replicator when trying to do outbound"),
l&&l(S))}flush(a=null,b=null){a=new Mj.a(new Ll,a,b,c=>0===c.StatusCode,3);this.CG.Cqa(a)}Cqa(a){this.CG.Cqa(a)}YKc(){return this.Vrb(this.Wb.Bf)}BLi(a){this.gDg.Hb(a);this.gDg.forceOutbound(null,null,null)}}Object(e.a)(En,"OutboundHelper",null,[1307,30,1370]);var Al=d(255),Cg=d(167);class Xn{constructor(a,b,c,f,l){this.bL=[];this.gab=new Al.a;this.t3c=null;this.kBg=[];this.D3=null;this.va=new sd.a;this.sFg=this.Dyb=this.Z2c=!1;this.Ub=a;this.la=b;this.ua=c;this.V4j=l;this.Eta=f;this.y2j=this.la.ksa?
1:4;f.yk(Object(C.a)(this,this.q7c,"onMainMastersLoaded"));this.la.ksa&&f.yk(Object(C.a)(this,this.uYg,"onMasterIdListChanged"))}get M9j(){if(this.la.ksa&&this.ua.Ca){const a=this.ua.Ca.vj;a&&Array.contains(this.bL,a)&&this.$re(a)}return this.bL.slice(0,Math.min(this.y2j,this.bL.length))}DLk(a){Array.remove(this.bL,a)}get Bhl(){return this.t3c}get YN(){return this.gab}get URb(){return this.kBg}get Ysj(){return!this.t3c}get bsk(){return 0<this.bL.length&&(!this.la.QRa||this.Z2c)}get vse(){return this.Dyb}set vse(a){this.Dyb=
a}bel(a){a&&this.bxh(a.vj)}orh(){this.Z2c=!0;this.Ubd(!0);this.SEb()}bxh(a){this.Z2c=!0;a&&(Array.remove(this.bL,a),Array.insert(this.bL,0,a));this.SEb()}JMe(a){this.la.ksa?this.bxh(a):this.orh()}M$f(a){if(!a||!this.gab)return null;a=a.vj;if(!a)return null;let b=null;return({value:b}=this.gab.Nf(a)).returnValue?b:null}uYg(a,b){b.property.id===zb.a.x4c.id&&(za.a.J(38847373,824,50,"MasterIdList update, need load master id list: {0}",this.Dyb),this.Dyb&&(this.Dyb=!1,this.Z2c&&(this.Ubd(!1),this.SEb())),
this.ILf())}q7c(a,b){a=b.property;if(this.la.ksa)if(a.id===zb.a.GAb.id){a=this.Ub.L3i();const f=this.Ub.QH();if(f&&f.length)if(a&&a.length){for(var c=b=0;b<a.length&&c<f.length;){const l=a[b],w=f[c];l.Id<w.Id?(this.zzh(l.Id),b++):w.Id<l.Id?(this.ySe(w.Id),c++):(md.c(l)!==md.c(w)&&this.prl(w.Id),c++,b++)}if(c<f.length)for(;c<f.length;c++)this.ySe(f[c].Id);if(b<a.length)for(;b<a.length;b++)this.zzh(a[b].Id);this.SEb()}else Cg.b(f,null,l=>{this.ySe(l.Id)})}else a.id===zb.a.kX.id&&(za.a.J(38847375,824,
50,"Slide size changed, need to reload the resources."),this.Ubd(!0),this.SEb());else if(a.id===zb.a.GAb.id||a.id===zb.a.kX.id)za.a.J(19240846,824,50,"MainMasters are reloaded, need to reload the resources"),this.Ubd(!0),this.SEb()}ySe(a){this.$re(a)}prl(a){this.$re(a)}$re(a){Array.contains(this.bL,a)&&Array.remove(this.bL,a);Array.insert(this.bL,0,a)}zzh(a){this.gab.remove(a);-1!==Array.indexOf(this.bL,a)&&Array.remove(this.bL,a)}SEb(){this.D3=this.D3||this.V4j(this);this.D3.JE(null,null,null)}Ubd(a){if(this.la.ksa){za.a.J(38847378,
824,50,"RefreshMastersToLoad, need clean cache: {0} ",a);var b=this.Ub.orb();a&&(Array.clear(this.bL),this.clearCache());if(b&&0<b.length)for(const c of b)-1===Array.indexOf(this.bL,c.idField)&&Array.add(this.bL,c.idField);else this.Dyb=!0,(a=this.Ub.UH(0))&&(a=a.vj)&&Array.add(this.bL,a)}else if(a=this.Ub.QH(),Array.clear(this.bL),this.clearCache(),a)for(b of a)this.gab.remove(b.Id),-1===Array.indexOf(this.bL,b.Id)&&Array.add(this.bL,b.Id)}Wik(a){if(a){for(const b of a)b&&(za.a.J(38847381,824,50,
"PresentationResourcesManager::OnMainMasterResoucesLoaded master {0} resources loaded.",b.MasterId),this.gab.$(b.MasterId,b),this.t3c=this.t3c||b.TableStyleGallery,this.la.ksa||Array.remove(this.bL,b.MasterId));this.ILf();this.va.raiseEvent("MainMasterResourcesLoaded")}else za.a.J(19240848,824,10,"PresentationResourcesManager::OnMainMasterResoucesLoaded mainMasterResouces returned is null")}ILf(){!this.sFg&&this.fGf()&&(this.sFg=!0,za.a.J(38892514,824,50,"PresentationResourcesManager::CheckFirstMasterRetrieved first master retrieved."),
qd.a("RaiseFirstMasterRetrievedEvent")&&this.va.raiseEvent("FirstMasterRetrieved"))}lek(a){this.la.powerPointEnableAccCheck&&(a&&a.length?(this.kBg=a,this.va.raiseEvent("AccCheckRuleInfoListLoaded")):za.a.J(19240850,824,10,"PresentationResourcesManager::OnAccRuleInfoListLoaded accRuleInfoList returned is null as acc-checker is enabled"))}fGf(){if(!this.la.ksa)return!0;const a=this.Ub.orb();if(a&&0<a.length)for(const b of this.Ub.orb())if(0<b.layoutCountField&&this.YN.Kb(b.idField)&&this.YN.ga(b.idField).LayoutIcons.length===
b.layoutCountField)return za.a.J(38892545,813,50,"LayoutDialogReady: master ID: {0}, layout count: {1}",b.idField,b.layoutCountField),!0;return!1}Dzc(a){this.va.addHandler("MainMasterResourcesLoaded",a)}pNk(a){this.va.removeHandler("MainMasterResourcesLoaded",a)}C2h(a){this.va.addHandler("FirstMasterRetrieved",a)}Y1h(a){this.va.addHandler("AccCheckRuleInfoListLoaded",a)}MMk(a){this.va.removeHandler("AccCheckRuleInfoListLoaded",a)}clearCache(){this.gab=new Al.a}dispose(){this.Eta.Pm(Object(C.a)(this,
this.q7c,"onMainMastersLoaded"));this.la.ksa&&this.Eta.Pm(Object(C.a)(this,this.uYg,"onMasterIdListChanged"));this.va.dispose();this.D3&&this.D3.dispose()}}Object(e.a)(Xn,"PresentationResourcesManager",null,[1309,109]);var Bp=d(376);class Fn extends Zf.a{constructor(){super();this.MasterIds=null;this.NeedLoadingMasterIdList=this.IncludeTableStyle=!1}Lk(){return 52}static mNd(a,b,c){const f=new Fn;f.MasterIds=a;f.IncludeTableStyle=b;f.NeedLoadingMasterIdList=c;return f}}Object(e.a)(Fn,"GetEditPresResourcesRequest",
Zf.a,[]);class Gn extends Bp.a{constructor(a,b,c,f){super();this.Ewb=0;this.Bab=this.Z2=!1;this.Zl=a;this.oUa=b;this.cL=f;this.enabled=2;this.Zv=c.uvi();this.Zl.register(this)}JE(){this.Zv.uSi();this.Zv.u7a();this.Zl.P9()}forceOutbound(){}mia(){return this.oUa.bsk||this.oUa.vse}JP(){return!1}DQa(){return this.Nd&&2===this.Nd.status?!0:this.Z2||this.Bab?!1:this.mia()&&this.Zv.u1b()}zEb(){if(1===this._state){var a=this.oUa.M9j;this.Nd.$G=Fn.mNd(a,this.oUa.Ysj,this.oUa.vse);for(const b of a)this.oUa.DLk(b);
this.Nd.status=1;this._state=3}else 3===this._state&&this.Nd&&2===this.Nd.status&&(this.Bab?(this._state=4,this.dispose()):(200===this.Nd.oy&&this.cL.Vhc(),this.Zv.pJa(),2!==this.Nd.statusCode?this.UG():this.Nd.pr&&1===this.Nd.pr.length?(a=this.Nd.pr[0],0===a.StatusCode?(this.oUa.Wik(md.a(a.MainMasterResources)),this.oUa.lek(md.a(a.AccRuleInfoList)),this.A_()):this.UG()):this.UG()))}get $aa(){return this.mia()?this.Zv.oeb():super.$aa}dispose(){1===this._state||4===this._state?(this.Z2||this.Zl.unregister(this),
this.Z2=!0):this.Bab=!0}A_(){this.Ewb=0;this._state=1;this.mia()||this.Zv.bYa()}UG(){4<++this.Ewb?(this._state=4,za.a.J(19240853,824,10,"PresentationResourcesReplicator quit after {0} failures",this.Ewb)):(za.a.J(19240855,824,15,"PresentationResourcesReplicator will retry on failure"),this._state=1)}}Object(e.a)(Gn,"PresentationResourcesReplicator",Bp.a,[109]);class kl{constructor(a,b){this.g5j=a;this.eT=b}Pkk(a){if(!a)throw Error.argumentNull("dataStorePusher is null!");const b=a.Uva;let c=null,
f=!1;for(const l of this.g5j)if(l.x_(a)){if(!c&&(c=this.eT.aCa(b),!c)){za.a.J(23594507,817,50,"revisionMetadata is null");return}l.update(a,c);f=!0}f&&this.eT.OFd(b,a,c)}}Object(e.a)(kl,"RevisionMetaDataUpdateListener",null,[1311]);var ik=d(398);class yk{aCa(a){if(!a)return null;const b=a.qK(4);return b&&!b.equals(Fa.a.nil)?a.te(b):new ik.a}MSe(a,b,c,f,l,w,F,S,fa){if(a&&f){a.Kn.apply(a,yk.iUk);a.setValue(zb.a.Kug,b);a.setValue(zb.a.k2b,!0);a.setValue(zb.a.Edd,1);a.setValue(zb.a.sid,f.sid);a.setValue(zb.a.cid,
f.cid);c&&a.setValue(zb.a.iDa,!0);l&&a.setValue(zb.a.shapeId,l.get_shapeId());w&&(a.setValue(zb.a.Jp,!0),a.setValue(zb.a.Gth,w.cellId),a.setValue(zb.a.rowId,w.rowId));if(F&&0<F.length){b=F.length;c=Array(b);f=Array(b);for(l=0;l<b;l++)c[l]=F[l].rowId,f[l]=F[l].cellId;a.setValue(zb.a.Jp,!0);a.setValue(zb.a.Ggb,f);a.setValue(zb.a.Sth,c)}a.setValue(zb.a.cPe,S);a.setValue(zb.a.bPe,fa)}}OFd(a,b,c){if(a&&b&&c){var f=!1;a.te(yk.fea)||(a.OD(c,yk.fea),f=!0);b.npa(c);f&&b.kwa(c.id,4)}}IAh(a,b){if(a){var c=a.Uva,
f=this.aCa(c);f.setValue(zb.a.Edd,b);this.OFd(c,a,f)}}ktl(a){if(a){var b=a.Uva,c=this.aCa(b);c.setValue(zb.a.SSk,0);this.OFd(b,a,c)}}}yk.fea=Fa.a.ig("{B3AB583C-77CD-428D-9371-02C2EA7C058B}{1}");yk.iUk=[zb.a.Kug,zb.a.shapeId,zb.a.Jp,zb.a.iDa,zb.a.Gth,zb.a.rowId,zb.a.Ggb,zb.a.Sth,zb.a.cPe,zb.a.bPe];Object(e.a)(yk,"RevisionMetadataHelper",null,[1428]);var Yn=d(647),Lo=d(829);class Hn extends Zf.a{constructor(a,b,c,f){super();this.ShouldWaitForSave=this.ShouldReleaseLock=!1;this.SessionCloseReason=0;
this.SessionKey=null;this.ShouldReleaseLock=a;this.ShouldWaitForSave=b;this.SessionCloseReason=c;this.SessionKey=f}Lk(){return 32}}Object(e.a)(Hn,"SaveAndCloseRequest",Zf.a,[]);class tn{constructor(a,b,c,f,l,w,F,S,fa){this.Yh=a;this.zoe=b;this.TB=c;this.Za=f;this.la=l;this.QA=w;this.Wd=F;this.hc=S;this.Zl=fa}wSi(a){this.Za.cvb=!0;a=new Hn(!0,!1,a,this.Za.podSessionId);this.Wd.qia=!0;const b=this.Yh.YKc();b&&b.JP()&&this.hc.An?b.v5a(null,null,null,a):this.zoe.U_f(a,null,null)}d2(a=!1,b=!0,c=null,f=
null,l=1){za.a.J(36987935,823,50,"SaveAndCloseHandler::ForceSave Start, fReleaseLock: {0}, fWaitForSave: {1}, fSaveToHost: {2}",a,!0,b);const w=new Hn(a,!0,l,this.Za.podSessionId);if(a&&this.la.markSessionClosingAtForceSave)this.QA.markSessionClosingAtForceSave(l),this.Zl.pause(),this.zoe.v5a(w,F=>{za.a.J(41263715,823,50,"SaveAndCloseHandler::ForceSave Succeeded. Closing session");this.la.b0f?this.QA.closeSession(l):this.TB.Abd(new Yn.a(l));c(F)},()=>{za.a.J(41263745,823,15,"SaveAndCloseHandler::ForceSave Failed.");
this.Zl.UYa();f&&f(null);return!0});else{a=this.Yh.YKc();const F=S=>{this.yhk(w,c,f,fa=>0===fa.StatusCode,S,b,l)};a?a.forceOutbound(()=>{F(!0)},()=>{F(!1)},null):(za.a.J(22410186,823,10,"Can't find graph space replicator when trying to do outbound"),F(!1))}}yhk(a,b,c,f,l,w,F){za.a.J(36987938,823,50,"SaveAndCloseHandler::OnForceSaveOutboundComplete Start, fReleaseLock: {0}, fOutboundSuccess: {1}, fSaveToHost: {2}",a.ShouldReleaseLock,l,w);l&&w||a.ShouldReleaseLock?(a.ShouldReleaseLock&&(this.Wd.qia=
!0),this.zoe.Cqa(a,S=>{a.ShouldReleaseLock&&(this.la.b0f?this.QA.closeSession(F):this.TB.Abd(new Yn.a(F)));b(S)},c,f)):l&&b?b(new Lo.a):!l&&c&&c(new Vn.a)}}Object(e.a)(tn,"SaveAndCloseHandler",null,[1308]);var Cp=d(989),lh=d(108);class un{constructor(a,b,c,f){this.Yh=a;this.mqe=b;this.Cac=c;this.xua=f}x_(a){let b=null,c=!0;if(this.Yh.eRc)b=a.kqa,c=!1;else if(this.mqe.fd===D.a.typing||this.mqe.fd===D.a.Rza||this.mqe.fd===D.a.jOa)b=a.kqa;b&&(this.xua&&this.Yzi(b.toString()),Kc.a.xvb(),this.Cac.Nvh(b,
c),za.a.J(23594510,822,50,"ClientRevisionId:{0}, GenerateTime:{1}",a.kqa.toString(),Kc.a.Ve(new Date)));return!1}update(){}Yzi(a){const b=new Cp.ActionContext(lh.a.ayh,1,null);b.Nj=!0;b.uE=new Date;b.Ya(lh.a.mX,Kc.a.u6a(a).toString());b.ur=!0;Kc.a.Zda(b)}}Object(e.a)(un,"TextEditingRevisionInfoMetaDataUpdater",null,[1364]);class Zn{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Storage"}Yb(a){this.K=a;const b=()=>new kh.a(a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").kWb(a.resolve("Box4.IReplicationParameters")),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>u.AFrameworkApplication.Xg);a.register(1307,"PowerPointWebEditor.Storage.IOutboundHelper").ma().na(()=>new En(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),b()));a.register(1308,"PowerPointWebEditor.Storage.ISaveAndCloseHandler").ma().na(()=>
new tn(a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),a.resolve("PowerPointWebEditor.BootStorage.ISaveAndCloseTaskExecutor"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IReplicationScheduler")));a.register(1309,
"PowerPointWebEditor.IPresentationResourcesManager").ma().na(()=>new Xn(a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").Cd(7),c=>new Gn(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),c,a.resolve("PowerPointWebEditor.IReplicationTimerFactory"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"))));this.pqi()}pqi(){this.K.register(yk,
"PowerPointWebEditor.RevisionMetadataHelper").as("PowerPointWebEditor.IRevisionMetadataHelper").ma();this.K.register(Ap,"PowerPointWebEditor.CcpEventSource").as("PowerPointWebEditor.ICcpEventSource").as("PowerPointWebEditor.ICcpEventNotifier").as("PowerPointWebEditor.ICcpEventHandlers").ma();this.K.register(1310,"PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").ma().na(()=>new to(this.K.resolve("PowerPointWebEditor.ICcpEventHandlers"),this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")));
this.K.register(1311,"PowerPointWebEditor.IRevisionMetaDataUpdateListener").ma().na(()=>new kl([new Zm(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),Jl.Jzg,this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper")),new un(this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),
this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").podThumbnailUpdateTelemetryEnabled),this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater")],this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))}init(){this.K.resolve("PowerPointWebEditor.IRevisionMetaDataUpdateListener")}dispose(){this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").dispose();this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").dispose()}static main(){m.a.instance.Ec(new Zn)}}
Object(e.a)(Zn,"PPTWebEditorStoragePackage",null,[2,3]);class rc{constructor(a,b,c){this.YEh=a;this.tIh=b;this.MSh=c}get LCID(){return this.YEh}get NVk(){return this.MSh}get TSf(){return this.tIh}get I7d(){return!!(this.TSf&rc.qEh)}get e3b(){return!!(this.TSf&rc.rEh)}static TPc(){rc.MFe={["20490"]:new rc(20490,4215112,"Latn"),["8251"]:new rc(8251,4215112,"Latn"),["17418"]:new rc(17418,4215112,"Latn"),["17417"]:new rc(17417,4215112,"Latn"),["8218"]:new rc(8218,4215304,"Cyrl"),["8204"]:new rc(8204,
4215112,"Latn"),["8202"]:new rc(8202,4215112,"Latn"),["8201"]:new rc(8201,4215112,"Latn"),["8193"]:new rc(8193,4493640,"Arab"),["6154"]:new rc(6154,4215112,"Latn"),["7227"]:new rc(7227,4215112,"Latn"),["19466"]:new rc(19466,4215112,"Latn"),["16394"]:new rc(16394,4215112,"Latn"),["16393"]:new rc(16393,4215112,"Latn"),["16385"]:new rc(16385,4493640,"Arab"),["7194"]:new rc(7194,4215048,"Cyrl"),["7180"]:new rc(7180,20808,"Latn"),["7178"]:new rc(7178,4215112,"Latn"),["7177"]:new rc(7177,4215112,"Latn"),
["7169"]:new rc(7169,4493640,"Arab"),["12289"]:new rc(12289,4493640,"Arab"),["6203"]:new rc(6203,4215080,"Latn"),["15372"]:new rc(15372,4215112,"Latn"),["15370"]:new rc(15370,4215112,"Latn"),["15369"]:new rc(15369,4215112,"Latn"),["15361"]:new rc(15361,4493640,"Arab"),["6170"]:new rc(6170,4215304,"Latn"),["6156"]:new rc(6156,4215112,"Latn"),["18442"]:new rc(18442,4215112,"Latn"),["6153"]:new rc(6153,4215112,"Latn"),["6145"]:new rc(6145,4493640,"Arab"),["4155"]:new rc(4155,4215080,"Latn"),["11274"]:new rc(11274,
4215112,"Latn"),["5179"]:new rc(5179,4215112,"Latn"),["14348"]:new rc(14348,4215112,"Latn"),["14346"]:new rc(14346,4215112,"Latn"),["14345"]:new rc(14345,20808,"Latn"),["14337"]:new rc(14337,4493640,"Arab"),["5146"]:new rc(5146,4215048,"Latn"),["5132"]:new rc(5132,4215112,"Latn"),["5130"]:new rc(5130,4215112,"Latn"),["5129"]:new rc(5129,4215112,"Latn"),["5127"]:new rc(5127,4215112,"Latn"),["5124"]:new rc(5124,4281672,"Hant"),["5121"]:new rc(5121,4493640,"Arab"),["31770"]:new rc(31770,4210820,""),
["31748"]:new rc(31748,4277380,""),["10266"]:new rc(10266,4215048,"Cyrl"),["10252"]:new rc(10252,4215112,"Latn"),["10250"]:new rc(10250,4215112,"Latn"),["10249"]:new rc(10249,4215112,"Latn"),["13324"]:new rc(13324,4215112,"Latn"),["13322"]:new rc(13322,4215112,"Latn"),["13321"]:new rc(13321,4215112,"Latn"),["10241"]:new rc(10241,4493640,"Arab"),["13313"]:new rc(13313,4493640,"Arab"),["4122"]:new rc(4122,4215048,"Latn"),["4108"]:new rc(4108,4215112,"Latn"),["4106"]:new rc(4106,4215112,"Latn"),["4105"]:new rc(4105,
4215112,"Latn"),["4103"]:new rc(4103,4215112,"Latn"),["4100"]:new rc(4100,4282696,"Hans"),["3179"]:new rc(3179,4215048,"Latn"),["4097"]:new rc(4097,4493640,"Arab"),["1085"]:new rc(1085,299432,"Hebr"),["1144"]:new rc(1144,4280616,"Yiii"),["21514"]:new rc(21514,4215112,"Latn"),["2145"]:new rc(2145,5132616,"Deva"),["3131"]:new rc(3131,4215112,"Latn"),["2143"]:new rc(2143,4215432,"Latn"),["12314"]:new rc(12314,4215048,"Cyrl"),["1070"]:new rc(1070,4215080,"Latn"),["1130"]:new rc(1130,4215080,"Latn"),["12300"]:new rc(12300,
4215112,"Latn"),["1091"]:new rc(1091,4215080,"Latn"),["12298"]:new rc(12298,4215112,"Latn"),["12297"]:new rc(12297,4215112,"Latn"),["2055"]:new rc(2055,4215112,"Latn"),["2052"]:new rc(2052,4282664,"Hans"),["2115"]:new rc(2115,4215368,"Cyrl"),["9242"]:new rc(9242,4215304,"Latn"),["3098"]:new rc(3098,4215048,"Cyrl"),["2107"]:new rc(2107,4215112,"Latn"),["9228"]:new rc(9228,4215112,"Latn"),["3084"]:new rc(3084,4215112,"Latn"),["9226"]:new rc(9226,4215112,"Latn"),["3082"]:new rc(3082,4215080,"Latn"),
["3081"]:new rc(3081,4215112,"Latn"),["2094"]:new rc(2094,4215080,"Latn"),["3079"]:new rc(3079,4215112,"Latn"),["2092"]:new rc(2092,4215368,"Cyrl"),["1064"]:new rc(1064,4215080,"Cyrl"),["3076"]:new rc(3076,4281640,"Hant"),["2155"]:new rc(2155,4215048,"Latn"),["3073"]:new rc(3073,4493640,"Arab"),["1153"]:new rc(1153,4215080,"Latn"),["1119"]:new rc(1119,299400,"Arab"),["1086"]:new rc(1086,4215080,"Latn"),["2144"]:new rc(2144,938632,"Deva"),["2077"]:new rc(2077,4215112,"Latn"),["1053"]:new rc(1053,4215080,
"Latn"),["2141"]:new rc(2141,4215336,"Latn"),["2074"]:new rc(2074,4215304,"Latn"),["2073"]:new rc(2073,20808,"Cyrl"),["2072"]:new rc(2072,4215112,"Latn"),["2137"]:new rc(2137,4493896,"Arab"),["2070"]:new rc(2070,4215048,"Latn"),["2068"]:new rc(2068,4215048,"Latn"),["2067"]:new rc(2067,4215112,"Latn"),["1073"]:new rc(1073,4215080,"Latn"),["2064"]:new rc(2064,4215112,"Latn"),["2129"]:new rc(2129,414016,"Tibt"),["2128"]:new rc(2128,4608584,"Mong"),["2060"]:new rc(2060,4215112,"Latn"),["1132"]:new rc(1132,
4215080,"Latn"),["1097"]:new rc(1097,5132584,"Taml"),["2057"]:new rc(2057,4215080,"Latn"),["1164"]:new rc(1164,4493608,"Arab"),["106"]:new rc(106,4210820,""),["2118"]:new rc(2118,4493640,"Arab"),["2117"]:new rc(2117,5132584,"Beng"),["2049"]:new rc(2049,4493640,"Arab"),["1156"]:new rc(1156,4215080,"Latn"),["2110"]:new rc(2110,4215112,"Latn"),["1054"]:new rc(1054,4608296,"Thai"),["2108"]:new rc(2108,4215048,"Latn"),["1083"]:new rc(1083,4215080,"Latn"),["136"]:new rc(136,4210820,""),["1114"]:new rc(1114,
4493608,"Syrc"),["1148"]:new rc(1148,4215080,"Latn"),["1145"]:new rc(1145,20776,"Latn"),["11290"]:new rc(11290,4215304,"Latn"),["1075"]:new rc(1075,20776,"Latn"),["1106"]:new rc(1106,4215080,"Latn"),["1140"]:new rc(1140,4215080,"Latn"),["120"]:new rc(120,4276356,""),["1136"]:new rc(1136,4215080,"Latn"),["1066"]:new rc(1066,4215080,"Latn"),["1098"]:new rc(1098,5132584,"Telu"),["1169"]:new rc(1169,4215048,"Latn"),["11276"]:new rc(11276,4215112,"Latn"),["61"]:new rc(61,295044,"Hebr"),["1060"]:new rc(1060,
4215080,"Latn"),["11273"]:new rc(11273,4215112,"Latn"),["1058"]:new rc(1058,4215080,"Cyrl"),["128"]:new rc(128,4489348,""),["1160"]:new rc(1160,4215080,"Latn"),["1159"]:new rc(1159,4215080,"Latn"),["1158"]:new rc(1158,20776,"Latn"),["1157"]:new rc(1157,4215080,"Cyrl"),["11265"]:new rc(11265,4493640,"Arab"),["1155"]:new rc(1155,4215080,"Latn"),["1154"]:new rc(1154,4215080,"Latn"),["1117"]:new rc(1117,4215080,"Cans"),["1152"]:new rc(1152,4493608,"Arab"),["1115"]:new rc(1115,5132584,"Sinh"),["1150"]:new rc(1150,
4215080,"Latn"),["1113"]:new rc(1113,938280,"Deva"),["1112"]:new rc(1112,938280,"Beng"),["51"]:new rc(51,16516,""),["1146"]:new rc(1146,4215080,"Latn"),["1109"]:new rc(1109,5132584,"Mymr"),["115"]:new rc(115,4210820,""),["1143"]:new rc(1143,4215080,"Latn"),["1142"]:new rc(1142,20872,"Latn"),["1141"]:new rc(1141,4215080,"Latn"),["1104"]:new rc(1104,4215080,"Cyrl"),["2058"]:new rc(2058,4215112,"Latn"),["1102"]:new rc(1102,5132584,"Deva"),["1137"]:new rc(1137,20776,"Latn"),["1100"]:new rc(1100,5132584,
"Mlym"),["1135"]:new rc(1135,4215080,"Latn"),["1134"]:new rc(1134,4215080,"Latn"),["1133"]:new rc(1133,4215080,"Cyrl"),["1096"]:new rc(1096,5132584,"Orya"),["1131"]:new rc(1131,4215048,"Latn"),["1094"]:new rc(1094,5132584,"Guru"),["1129"]:new rc(1129,20872,"Latn"),["1128"]:new rc(1128,4215080,"Latn"),["1127"]:new rc(1127,20776,"Latn"),["1126"]:new rc(1126,20776,"Latn"),["1125"]:new rc(1125,4493608,"Thaa"),["1124"]:new rc(1124,4215080,"Latn"),["1123"]:new rc(1123,4493608,"Arab"),["1122"]:new rc(1122,
4215080,"Latn"),["1121"]:new rc(1121,5132584,"Deva"),["1120"]:new rc(1120,299400,"Arab"),["1118"]:new rc(1118,4215080,"Ethi"),["1082"]:new rc(1082,4215080,"Latn"),["1116"]:new rc(1116,4215080,"Cher"),["1080"]:new rc(1080,4215080,"Latn"),["1079"]:new rc(1079,4215080,"Geor"),["1078"]:new rc(1078,4215080,"Latn"),["1077"]:new rc(1077,4215080,"Latn"),["1111"]:new rc(1111,5132584,"Deva"),["1110"]:new rc(1110,4215080,"Latn"),["1074"]:new rc(1074,4215080,"Latn"),["1108"]:new rc(1108,4608296,"Laoo"),["1107"]:new rc(1107,
4608296,"Khmr"),["1071"]:new rc(1071,4215080,"Cyrl"),["1105"]:new rc(1105,4608296,"Tibt"),["1069"]:new rc(1069,4215080,"Latn"),["1103"]:new rc(1103,5132584,"Deva"),["1067"]:new rc(1067,4215080,"Armn"),["1101"]:new rc(1101,5132584,"Beng"),["1065"]:new rc(1065,4493608,"Arab"),["1099"]:new rc(1099,5132584,"Knda"),["1063"]:new rc(1063,4215080,"Latn"),["1062"]:new rc(1062,4215080,"Latn"),["1061"]:new rc(1061,4215080,"Latn"),["1095"]:new rc(1095,5132584,"Gujr"),["1059"]:new rc(1059,4215080,"Cyrl"),["1093"]:new rc(1093,
5132584,"Beng"),["1092"]:new rc(1092,4215080,"Cyrl"),["1056"]:new rc(1056,4493608,"Arab"),["1090"]:new rc(1090,4215080,"Latn"),["1089"]:new rc(1089,4215080,"Latn"),["1088"]:new rc(1088,4215080,"Cyrl"),["1087"]:new rc(1087,4215080,"Cyrl"),["1052"]:new rc(1052,4215080,"Latn"),["1051"]:new rc(1051,4215080,"Latn"),["1050"]:new rc(1050,4215048,"Latn"),["1049"]:new rc(1049,4215080,"Cyrl"),["1048"]:new rc(1048,4215080,"Latn"),["1081"]:new rc(1081,5132584,"Deva"),["1046"]:new rc(1046,4215048,"Latn"),["1045"]:new rc(1045,
4215080,"Latn"),["1044"]:new rc(1044,4215048,"Latn"),["1043"]:new rc(1043,4215080,"Latn"),["1076"]:new rc(1076,4215080,"Latn"),["1041"]:new rc(1041,4280616,"Jpan"),["1040"]:new rc(1040,4215080,"Latn"),["119"]:new rc(119,4210820,""),["1072"]:new rc(1072,4215176,"Latn"),["1037"]:new rc(1037,4493608,"Hebr"),["1036"]:new rc(1036,4215080,"Latn"),["1035"]:new rc(1035,4215080,"Latn"),["1068"]:new rc(1068,4215080,"Latn"),["1033"]:new rc(1033,4215048,"Latn"),["1032"]:new rc(1032,4215080,"Grek"),["1031"]:new rc(1031,
4215080,"Latn"),["1030"]:new rc(1030,4215080,"Latn"),["1029"]:new rc(1029,4215080,"Latn"),["1028"]:new rc(1028,4281672,"Hant"),["1027"]:new rc(1027,4215080,"Latn"),["1026"]:new rc(1026,4215080,"Cyrl"),["140"]:new rc(140,4489348,""),["1057"]:new rc(1057,4215080,"Latn"),["50"]:new rc(50,4210820,""),["1055"]:new rc(1055,4215080,"Latn"),["135"]:new rc(135,4210820,""),["134"]:new rc(134,16516,""),["133"]:new rc(133,4210820,""),["132"]:new rc(132,4210820,""),["131"]:new rc(131,4210820,""),["130"]:new rc(130,
4210820,""),["129"]:new rc(129,4210820,""),["1047"]:new rc(1047,4215080,"Latn"),["126"]:new rc(126,4210820,""),["89"]:new rc(89,5128324,""),["124"]:new rc(124,4210820,""),["1042"]:new rc(1042,4280616,"Hang"),["122"]:new rc(122,4210820,""),["121"]:new rc(121,16516,""),["1039"]:new rc(1039,4215080,"Latn"),["1038"]:new rc(1038,4215080,"Latn"),["118"]:new rc(118,16516,""),["117"]:new rc(117,4210820,""),["116"]:new rc(116,4210820,""),["1034"]:new rc(1034,4219176,"Latn"),["114"]:new rc(114,4210820,""),
["113"]:new rc(113,16516,""),["112"]:new rc(112,4210820,""),["111"]:new rc(111,4210820,""),["110"]:new rc(110,4210820,""),["109"]:new rc(109,4210820,""),["108"]:new rc(108,4210820,""),["107"]:new rc(107,4210820,""),["1025"]:new rc(1025,4493608,"Arab"),["105"]:new rc(105,16516,""),["104"]:new rc(104,4210820,""),["103"]:new rc(103,4210820,""),["102"]:new rc(102,16516,""),["101"]:new rc(101,4489348,""),["100"]:new rc(100,4210820,""),["99"]:new rc(99,4489348,""),["98"]:new rc(98,4210820,""),["97"]:new rc(97,
5128324,""),["96"]:new rc(96,966788,""),["95"]:new rc(95,4505732,""),["94"]:new rc(94,4210820,""),["93"]:new rc(93,4210820,""),["92"]:new rc(92,4210820,""),["91"]:new rc(91,5128324,""),["90"]:new rc(90,4489348,""),["85"]:new rc(85,5128324,""),["88"]:new rc(88,934020,""),["87"]:new rc(87,5128324,""),["86"]:new rc(86,4210820,""),["9275"]:new rc(9275,4215112,"Latn"),["84"]:new rc(84,4604036,""),["83"]:new rc(83,4604036,""),["82"]:new rc(82,4210820,""),["81"]:new rc(81,4604036,""),["80"]:new rc(80,4604036,
""),["79"]:new rc(79,5128324,""),["78"]:new rc(78,5128324,""),["77"]:new rc(77,5128324,""),["76"]:new rc(76,5128324,""),["75"]:new rc(75,5128324,""),["74"]:new rc(74,5128324,""),["73"]:new rc(73,5128324,""),["72"]:new rc(72,4210820,""),["71"]:new rc(71,4210820,""),["70"]:new rc(70,5128324,""),["69"]:new rc(69,5128324,""),["68"]:new rc(68,4210820,""),["67"]:new rc(67,4210820,""),["66"]:new rc(66,4210820,""),["65"]:new rc(65,4210820,""),["64"]:new rc(64,4210820,""),["63"]:new rc(63,4210820,""),["62"]:new rc(62,
4210820,""),["18441"]:new rc(18441,4215112,"Latn"),["59"]:new rc(59,4210820,""),["58"]:new rc(58,4210820,""),["57"]:new rc(57,5128324,""),["56"]:new rc(56,4210820,""),["55"]:new rc(55,4210820,""),["54"]:new rc(54,4210820,""),["53"]:new rc(53,4210820,""),["52"]:new rc(52,4210820,""),["31"]:new rc(31,4210820,""),["47"]:new rc(47,4210820,""),["49"]:new rc(49,4210820,""),["48"]:new rc(48,4210820,""),["44"]:new rc(44,4210820,""),["46"]:new rc(46,4210820,""),["45"]:new rc(45,4210820,""),["41"]:new rc(41,
4489348,""),["43"]:new rc(43,4210820,""),["42"]:new rc(42,4210820,""),["38"]:new rc(38,4210820,""),["40"]:new rc(40,4210820,""),["39"]:new rc(39,4210820,""),["35"]:new rc(35,4210820,""),["37"]:new rc(37,4210820,""),["36"]:new rc(36,4210820,""),["9225"]:new rc(9225,4215112,"Latn"),["34"]:new rc(34,4210820,""),["33"]:new rc(33,4210820,""),["32"]:new rc(32,4489348,""),["29"]:new rc(29,4210820,""),["30"]:new rc(30,4604036,""),["27"]:new rc(27,4210820,""),["28"]:new rc(28,4210820,""),["9217"]:new rc(9217,
4493640,"Arab"),["26"]:new rc(26,4210820,""),["25"]:new rc(25,4210820,""),["24"]:new rc(24,4210820,""),["23"]:new rc(23,4210820,""),["22"]:new rc(22,4210820,""),["21"]:new rc(21,4210820,""),["20"]:new rc(20,4210820,""),["19"]:new rc(19,4210820,"Latn"),["18"]:new rc(18,4276356,""),["17"]:new rc(17,4276356,""),["16"]:new rc(16,4210820,""),["15"]:new rc(15,4210820,""),["14"]:new rc(14,4210820,""),["13"]:new rc(13,4489348,""),["12"]:new rc(12,4210820,""),["11"]:new rc(11,4210820,""),["10"]:new rc(10,
4210820,""),["9"]:new rc(9,4210820,""),["8"]:new rc(8,4210820,""),["7"]:new rc(7,4210820,""),["6"]:new rc(6,4210820,""),["5"]:new rc(5,4210820,""),["4"]:new rc(4,4278404,""),["3"]:new rc(3,4210820,""),["2"]:new rc(2,4210820,""),["1"]:new rc(1,4489348,""),["0"]:new rc(0,1,"")}}static re(a){rc.MFe||rc.TPc();return rc.MFe[a.toString()]}}rc.MFe=null;rc.qEh=262144;rc.rEh=65536;Object(e.a)(rc,"ExtendedCultureInfo",null,[]);class cj{rX(a,b){var c=a.ta(ob.a.Cs,1033);qa.a.re(c)&&(c=rc.re(c))&&(c.e3b?a.setValue(zb.a.eastAsianFont,
b):c.I7d&&a.setValue(zb.a.complexScriptFont,b));a.setValue(zb.a.latinFont,b)}static toi(a,b,c){b.baselineFieldSpecified&&(0>b.baselineField?a.ke(ob.a.subscript,!0):0<b.baselineField?a.ke(ob.a.superscript,!0):(a.ke(ob.a.subscript,!1),a.ke(ob.a.superscript,!1)));b.bFieldSpecified&&a.ke(ob.a.bold,b.bField);b.noProofFieldSpecified&&a.ke(Sb.a.noProof,b.noProofField);b.iFieldSpecified&&a.ke(ob.a.italic,b.iField);b.strikeFieldSpecified&&a.ke(ob.a.strikethrough,b.strikeField);b.uFieldSpecified&&a.ke(ob.a.underline,
b.uField);if(b.langField){var f=qa.a.re(b.langField);f?a.ke(ob.a.Cs,f.LCID):za.a.J(8958996,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.langField)}b.altLangField&&((f=qa.a.re(b.altLangField))?a.ke(zb.a.eAc,f.LCID):za.a.J(8958998,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.altLangField));b.hlinkClickField&&(a.ke(ob.a.As,!0),a.ke(ob.a.sZ,!0));cj.woi(a,b,c)}static QPf(a){a>Xj.a.B4c?a=Xj.a.B4c:a<Xj.a.S4c&&(a=
Xj.a.S4c);return cj.vIi(a)}static woi(a,b,c){b.szFieldSpecified&&a.ke(ob.a.fontSize,cj.QPf(b.szField));(c=If.Box4ColorHelper.FEb(b,c))&&a.setValue(ob.a.fontColor,c.xC);b.latinField&&a.ke(zb.a.latinFont,b.latinField.typefaceField);b.eaField&&a.ke(zb.a.eastAsianFont,b.eaField.typefaceField);b.csField&&a.ke(zb.a.complexScriptFont,b.csField.typefaceField);b.capFieldSpecified&&a.ke(ne.a.capitalization,b.capField);b.symField&&a.ke(zb.a.GHb,b.symField.typefaceField)}static vIi(a){return a/(Xj.a.Rec*Xj.a.n7a)}static vHf(a){return a*
Xj.a.n7a}}Object(e.a)(cj,"FormattingHelper",null,[1305]);class Mo{hYi(a,b,c){let f="";const l=a.ta(Sb.a.BZ,[]);l&&0<=b&&b<l.length&&(a=a.Eh)&&(b=a.te(l[b]))&&b.Sa(zb.a.schemeColor)&&(b=b.getValue(zb.a.schemeColor),(b=oi.SchemeColor.parse(b))?b.Dra?f=Ul.i(b.hP):b.qCe(c)&&(f=Ul.i(b.hP)):za.a.J(38606471,826,50,"schemeClr is null."));return f}iYi(a,b){let c="";(a=a.Bgd)||za.a.J(38088800,826,50,"This shapeNode don't have shapeFont");a&&!a.schemeClrField&&za.a.J(38088802,826,50,"The shapeFont don't have schemeClrField.");
a&&a.schemeClrField&&(14===a.schemeClrField.valField?za.a.J(38549282,826,50,"The color of shapeFont is W"):13===a.schemeClrField.valField?za.a.J(38549312,826,50,"The color of shapeFont is B"):za.a.J(38549314,826,50,"The color of shapeFont is unexpected color"),b=If.Box4ColorHelper.EEb(a,b),b=Ul.g(b.aXa),c=Ul.i(b),"000000"===c?za.a.J(38549316,826,50,"The resolved color of shapeFont is B"):"FFFFFF"===c?za.a.J(38549318,826,50,"The resolved color of shapeFont is W"):za.a.J(38549320,826,50,"The resolved color of shapeFont is unexpected color"));
return c}}Object(e.a)(Mo,"NonTableThemeColorHelper",null,[1306]);class zk{constructor(){this.charsetField=0;this.panoseField=null;this.pitchFamilyField=0;this.typefaceField=null}}Object(e.a)(zk,"CT_TextFont",null,[]);class Ak{constructor(){this.lPa=this.WWa=null}}Object(e.a)(Ak,"ThemeFont",null,[]);class ye{static isThemeFont(a){return ye.yUk.hasOwnProperty(a)}static K1i(a){let b="",c,f;({h5a:c,egb:f}=ye.C1i(a)).returnValue&&(0===c?0===f?b="+Heading":1===f?b="+Heading Asian":2===f&&(b="+Heading CS"):
1===c&&(0===f?b="+Body":1===f?b="+Body Asian":2===f&&(b="+Body CS")));return b}static Ldi(a,b,c){const f=[];if(!c||!c.FontScheme)return f;var l=ye.AZ,w=ye.AZ,F=ye.AZ;({xyg:l,HXf:w,OSf:F}=ye.zBh(l,w,F,a));({xyg:l,HXf:w,OSf:F}=ye.zBh(l,w,F,b));a=c.FontScheme;l!==ye.AZ?(ye.ADb(a,0,l,ye.p4c,f),ye.ADb(a,1,l,ye.Y4c,f)):(l=ye.F6a(a,0,0),b=ye.F6a(a,1,0),ye.Xa(l)||ye.Xa(b)||(f.push(Object.assign(new Ak,{WWa:l,lPa:ye.p4c})),f.push(Object.assign(new Ak,{WWa:b,lPa:ye.Y4c}))));w!==ye.AZ?(ye.ADb(a,0,w,ye.o4c,f),
ye.ADb(a,1,w,ye.X4c,f)):(w=ye.F6a(a,0,1),l=ye.F6a(a,1,1),ye.Xa(w)||ye.Xa(l)||(f.push(Object.assign(new Ak,{WWa:w,lPa:ye.o4c})),f.push(Object.assign(new Ak,{WWa:l,lPa:ye.X4c}))));F!==ye.AZ?(ye.ADb(a,0,F,ye.n4c,f),ye.ADb(a,1,F,ye.W4c,f)):(F=ye.F6a(a,0,2),w=ye.F6a(a,1,2),ye.Xa(F)||ye.Xa(w)||(f.push(Object.assign(new Ak,{WWa:F,lPa:ye.n4c})),f.push(Object.assign(new Ak,{WWa:w,lPa:ye.W4c}))));return f}static Xa(a){return!a||!a.length}static ADb(a,b,c,f,l){a&&c!==ye.AZ&&(c=ye.mej(a,b,c),ye.Xa(c)&&(c=ye.F6a(a,
b,0),ye.Xa(c)&&(c="Arial")),l.push(Object.assign(new Ak,{WWa:c,lPa:f})))}static F6a(a,b,c){let f="";switch(b){case 0:a.majorFontField&&(f=ye.zeg(a.majorFontField,c));break;case 1:a.minorFontField&&(f=ye.zeg(a.minorFontField,c))}return f}static zeg(a,b){let c="";if(a)switch(b){case 0:a.latinField&&(c=a.latinField.typefaceField);break;case 1:a.eaField&&(c=a.eaField.typefaceField);break;case 2:a.csField&&(c=a.csField.typefaceField)}return c}static mej(a,b,c){if(!a||c===ye.AZ)return"";let f="";if(1066===
c)f="Viet";else if(1152===c)f="Uigh";else if(c=rc.re(c))f=c.NVk;return ye.nej(a,b,f)}static nej(a,b,c){let f="";if(a&&c)switch(b){case 0:a.majorFontField&&(f=ye.yeg(a.majorFontField,c));break;case 1:a.minorFontField&&(f=ye.yeg(a.minorFontField,c))}return f}static yeg(a,b){let c="";if(a&&a.fontField&&b){a=a.fontField;for(let f=0;f<a.length;f++){const l=a[f];if(l.scriptField&&l.scriptField.toLowerCase()===b.toLowerCase()){l.typefaceField&&(c=l.typefaceField);break}}}return c}static zBh(a,b,c,f){if(f!==
ye.AZ){const l=rc.re(f);l&&(l.e3b?b===ye.AZ&&(b=f):l.I7d?c===ye.AZ&&(c=f):a===ye.AZ&&(a=f))}return{xyg:a,HXf:b,OSf:c}}static C1i(a){switch(a){case ye.n4c:return{returnValue:!0,h5a:0,egb:2};case ye.o4c:return{returnValue:!0,h5a:0,egb:1};case ye.p4c:return{returnValue:!0,h5a:0,egb:0};case ye.W4c:return{returnValue:!0,h5a:1,egb:2};case ye.X4c:return{returnValue:!0,h5a:1,egb:1};case ye.Y4c:return{returnValue:!0,h5a:1,egb:0}}return{returnValue:!1,h5a:2,egb:0}}static upb(a,b){let c=null;if(0===a)switch(b){case 2:c=
ye.n4c;break;case 1:c=ye.o4c;break;case 0:c=ye.p4c}else if(1===a)switch(b){case 2:c=ye.W4c;break;case 1:c=ye.X4c;break;case 0:c=ye.Y4c}null===c&&(za.a.J(8959518,820,10,"TextFontHelper::CreateTextFont - Invalid text font encountered"),c="");return Object.assign(new zk,{typefaceField:c,charsetField:1})}}ye.n4c="+mj-cs";ye.o4c="+mj-ea";ye.p4c="+mj-lt";ye.W4c="+mn-cs";ye.X4c="+mn-ea";ye.Y4c="+mn-lt";ye.AZ=0;ye.yUk={["+mj-cs"]:"",["+mj-ea"]:"",["+mj-lt"]:"",["+mn-cs"]:"",["+mn-ea"]:"",["+mn-lt"]:""};Object(e.a)(ye,
"TextFontHelper",null,[]);class $n{constructor(a,b,c){this.ua=a;this.uc=b;this.c4j=c}BRk(a,b){let c="";var f=a.ta(ob.a.Cs,ye.AZ),l=a.ta(zb.a.eAc,ye.AZ),w=rc.re(f===ye.AZ?1033:f);if(w){let F="";a.Sa(zb.a.GHb)?F=a.getValue(zb.a.GHb):w.I7d&&a.Sa(zb.a.complexScriptFont)?F=a.getValue(zb.a.complexScriptFont):w.e3b&&a.Sa(zb.a.eastAsianFont)?F=a.getValue(zb.a.eastAsianFont):a.Sa(zb.a.latinFont)&&(F=a.getValue(zb.a.latinFont));if(ye.isThemeFont(F)){w=!1;let S=null;if(this.c4j){if(b=Object(ua.a)(131,this.uc.Sg(b)))S=
b.Ye}else{if(!this.ua.Ca)throw Error.argumentNull("ActiveSlide is null");S=this.ua.Ca.Ye}if(S&&(f=ye.Ldi(f,l,S)))for(l=0;l<f.length;l++)if(F===f[l].lPa){c=f[l].WWa;w=!0;break}w||(c=ye.K1i(F))}else c=F}c&&a.ke(ob.a.font,c)}}Object(e.a)($n,"FontResolver",null,[1304]);class No{constructor(a){this.FZj=a}cti(a,b,c){a(ob.a.Cs);a(zb.a.latinFont);a(zb.a.eastAsianFont);a(zb.a.complexScriptFont);a(zb.a.GHb);a(zb.a.eAc);a(zb.a.Ye);a(zb.a.yob);a(zb.a.yvb);a(zb.a.zM);a(zb.a.schemeColor);a(zb.a.tRc);a(zb.a.qQd);
a(zb.a.nQd);a(zb.a.kQd);a(zb.a.uQd);a(zb.a.S1b);this.FZj.BRk(b(),c)}}Object(e.a)(No,"PptFormattingCacheCopyPropertyStrategy",null,[1363]);class ao{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatting"}Yb(a){this.K=a;a.register(1304,"Box4.IFontResolver").ma().na(()=>new $n(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTableFontWithinMultipleThemesFix));a.register(1305,
"PowerPointWebEditor.IFormattingHelper").ma().na(()=>new cj);a.register(No,"PowerPointWebEditor.PptFormattingCacheCopyPropertyStrategy").as("Box4.IFormattingCacheCopyPropertyStrategy").ma().na(()=>new No(a.resolve("Box4.IFontResolver")));a.register(1306,"PowerPointWebEditor.INonTableThemeColorHelper").ma().na(()=>new Mo)}init(){this.K.resolve("PowerPointWebEditor.IFormattingHelper");this.K.resolve("PowerPointWebEditor.INonTableThemeColorHelper")}dispose(){}static main(){m.a.instance.Ec(new ao)}}Object(e.a)(ao,
"PPTWebEditorTextFormattingPackage",null,[2,3]);class Xl{constructor(a){this.Yc=a;this.hHh=I.a.instance.ga(115)}gug(a){return this.Lsg(a)?!0:this.hHh?1074135161===a.Oe||1074135162===a.Oe:!1}Ksg(a){return this.Lsg(a)||131162===a.Oe||4325465===a.Oe||1179729===a.Oe}Lsg(a){return 131140===a.Oe||this.Yc.Zf&&131120===a.Oe}XWf(a){return va.a.any(a.YI,(b,c)=>!this.Ksg(c)&&!this.gug(c))}}Object(e.a)(Xl,"UndoRevisionValidator",null,[1362]);class In{constructor(){this.$c=lb.a.instance.qb("Box4.IFeatureHelper")}vGb(){return u.AFrameworkApplication.fa.ka("AllowMultiUserUndo")}RXa(){return this.vGb()&&
u.AFrameworkApplication.fa.ka("AllowSmartUndoMerge")}}Object(e.a)(In,"UndoSettingsManager",null,[1361]);var mm=d(331),z=d(988),T=d(198);class ja{Sa(a){return a.Sa(void 0)}Cbg(a,b){return a.ta(b,null)}IMc(a,b){a=(a=a.ta(b,null))?Array.clone(a):[];return new z.a(a)}Fbg(a,b){return a.ta(b,"")}vkh(a,b,c){a.setValue(b,c)}}Object(e.a)(ja,"MergeableObjectUtilities",null,[605]);class Ba{constructor(a,b,c,f,l){this.Pb=a;this.ua=b;this.Fa=c;this.sa=f;this.TZ=l}m6c(a,b,c){if(a)if("PowerPointGroupShapes"===b&&
c)for(a=a.YI,b=[],c=0;c<a.length;++c){var f=a[c];if(f&&393227===f.Oe&&f.Sa(zb.a.j7)){f=(new ja).IMc(f,zb.a.j7);for(var l=0;l<f.length;l++){var w=this.ua.Ca;if(!w)throw Error.argumentNull("ActiveSlide is null");const F=this.TZ.Aba(f.ga(l));w=w.KB(F.get_shapeId());b.push(w)}this.Spj(b)}}else if("PowerPointUngroupShapes"===b&&!c)for(a=a.YI,b=0;b<a.length;++b)if((c=a[b])&&393227===c.Oe&&c.Sa(zb.a.hna))for(c=(new ja).IMc(c,zb.a.hna),f=0;f<c.length;f++){l=this.ua.Ca;if(!l)throw Error.argumentNull("ActiveSlide is null");
w=this.TZ.Aba(c.ga(f));l=l.KB(w.get_shapeId());this.Rpj(l)}}ZOc(a){if(a){const b=a.yg(this.Pb.Na);b.pia();b.fFb=!0;this.sa.I6(a)}else za.a.J(595359873,815,10,"GroupUngroupUndoRedoActionController::HideAndDeselectShape Trying to Hide and Deselect Null shape.")}Spj(a){if(a.length){var b=this.Fa.ys(a[0]);this.ZOc(b);for(const c of a)this.ZOc(c)}}Rpj(a){this.ZOc(a);if(a.Xf){a=this.Fa.my(a);for(const b of a)this.ZOc(b)}}}Object(e.a)(Ba,"GroupUngroupUndoRedoActionController",null,[1300]);class Ga{mWg(){}m6c(){}OVg(){}oVg(){}VTc(){return!1}}
Object(e.a)(Ga,"NoOpTablePartialEditController",null,[1301]);class Fb{constructor(a,b,c,f,l,w){this.yab=null;this.Yh=a;this.Fa=b;this.Cac=c;this.Wb=f;this.sa=l;this.UHg=w}mWg(){this.fae()&&this.VMe()}m6c(a){a&&this.fae()&&(a=this.yab,this.VMe(),this.Brh(a))}OVg(a,b,c,f){this.fae()&&!this.lIj(a,b,c,f)&&this.VMe()}oVg(a,b,c){if(a&&b&&c){this.yab=null;a=this.sa.he();c=new Ie.a;b=b.YI;for(let l=0;l<b.length;++l){var f=b[l];393230===f.Oe&&f.Sa(zb.a.cellId)&&(f=this.Fa.$m(f),Array.contains(a,f)&&c.$(f.get_shapeId(),
f))}0<c.count&&this.Brh(c.values.ga(0))}}lIj(a,b,c,f){let l=!1;b&&this.VTc(a)&&(f=b.qS&&f,l=(c||f)&&b.actionId===a,this.UHg||(l=(b.actionId===a||this.VTc(b.actionId))&&1===this.Cac.Esb(b.P4)||l));return l}VTc(a){let b=a===D.a.Rza||a===D.a.jOa||a===D.a.typing;this.UHg||(b=a===D.a.WA||a===D.a.enter||b);return b}Brh(a){this.yab=a}VMe(){if(this.yab){const a=this.Wb.Gi.Ai.qx.id;0!==this.Cac.Esb(a)&&this.Cac.Nvh(a,!1);this.Yh.G3a(this.yab,!0)}this.yab=null}fae(){return!!this.yab}}Object(e.a)(Fb,"TablePartialEditController",
null,[1301]);var Rb=d(893);class tc{constructor(a,b,c,f){this.gv=a;this.Yh=b;this.B7j=c;this.ia=f;this.wb()}wb(){this.ia.ra(aa.a.Idb,$b.a.application,Object(C.a)(this,this.Idb,"queryIsShapeTextEditHappened"),96)}Idb(a,b,c,f,l){l.bsa=this.bsa(l.Clc,l.pPj);return 32}chj(a,b,c){this.B7j.Vjl(new Rb.a(a,b,c))}bsa(a,b){let c=!1;a&&(c=!this.gv.rSc()&&a.DDa!==b,this.gv.rSc()||a.DDa!==b||za.a.J(21042650,820,15,"{0}ViewElement::EndEditing - IsEditingHappened: false. Find localUndoStack is not empty but lastContentSavedTimeBeforeEnterTextEditing not changed",
Object(Ca.a)(4,a)?"Shape":"Notes"));return c}}Object(e.a)(tc,"PPTUndoActionBehavior",null,[1360]);class Ac extends Sys.EventArgs{constructor(a){super();this.actionId=a}}Object(e.a)(Ac,"OnUndoEventArgs",Sys.EventArgs,[]);var kd=d(708),nd=d(134);class Bd extends kd.a{constructor(a=null,b=null,c=null){super(a,b);this.cxd=c||new ja}rDb(){super.rDb();const a=new z.a,b=new pa.a;b.add(Fa.a.nil);this.Deb.forEach((l,w)=>{b.add(w);a.add(w);return!0});for(this.objects.forEach(l=>{b.add(l);a.add(l);return!0});0<
a.length;){var c=a.ga(0);a.AQd(0);var f=this.objects.ga(c)||this.RY.csb(c);if(f){c=f;f=c.yz();for(let l=0;l<f.length;l++){const w=f[l],F=nd.a.j0b(nd.a.z4f(w));8===F?this.OAf(this.cxd.Cbg(c,w),a,b):9===F&&this.cxd.IMc(c,w).forEach(S=>{this.OAf(S,a,b);return!0})}}else Da.a.instance.shipAssertTag(17409040,2,!1,"Failed to find [revisedObjectId: {0}]",c)}}OAf(a,b,c){c.contains(a)||(c.add(a),this.mug(a)&&(c=this.RY.csb(a),this.nte(c),b.add(a)))}}Object(e.a)(Bd,"ReferenceFollowingRevisionDiffer",kd.a,[]);
class Zd{tyi(a,b){return new Bd(a,b)}}Object(e.a)(Zd,"UndoDifferFactory",null,[1348]);var df=d(283),Ke=d(576);class zf{constructor(a,b,c,f,l,w,F){a||df.a.argument("revisionStore cannot be null","revisionStore");b||df.a.argument("undoRevisionValidator cannot be null","undoRevisionValidator");c||df.a.argument("undoSettingsManager cannot be null","undoSettingsManager");f||df.a.argument("undoDifferFactory cannot be null","undoDifferFactory");l||df.a.argument("revisedObjectSpace cannot be null","revisedObjectSpace");
w||df.a.argument("undoRevisionMergeStrategy cannot be null","undoRevisionMergeStrategy");this.vSh=a;this.Txc=b;this.naa=c;this.$Vh=f;this.aQb=l;this.dWh=w;this.z5e=F}TEc(a,b){const c=this.$Vh.tyi(a,b);c.rDb();const f=new Ke.a;f.PMe(this.aQb,a);c.Deb.forEach((F,S)=>{f.kwa(S,F);return!0});const l=new z.a,w=a.zS<b.zS;c.objects.forEach((F,S)=>{if(this.Txc.gug(S))return!0;if(w&&!this.Txc.Ksg(S)&&!b.tZ(F)&&!a.tZ(F))return l.add(F),!0;f.npa(S);return!0});0<l.length&&Z.ULS.sendTraceTag(22607311,365,100,"Skipping Objects because they're not referenced in base {0} or revised {1}: {2}",
a.id,b.id,l.er());this.z5e&&this.z5e.csl(f);return f.bJc()}uyi(a,b,c,f){b=this.TEc(a,b);if(!b)return null;if(a.id===c.id)return Z.ULS.sendTraceTag(22607312,365,this.naa.RXa()?15:50,"Undo merge attempted with base and current were the same revision. [AllowSmartUndoMerge: {0}]",this.naa.RXa()),b;a=this.TEc(a,c);if(!a)return null;var l=b;this.Txc.XWf(a)?(Z.ULS.sendTraceTag(22607313,365,100,"Merge determined to be necessary for undo."),l=new z.a,l.add(a),a=new z.a,a.add(b),l=this.dWh.aak(f,a,l,c.Cdd).ZN.last()):
Z.ULS.sendTraceTag(22607314,365,this.naa.RXa()?15:50,"Undo merge determined to be not needed because base and current are equivalent. [AllowSmartUndoMerge: {0}]",this.naa.RXa());return this.TEc(c,l)}vyi(a,b,c,f,l){let w=null;f||(this.naa.RXa()||!this.naa.vGb()?w=this.TEc(c,b):(Z.ULS.sendTraceTag(22607315,365,10,"Trying to skip merge when multi user undo is enabled and smart merge is disabled."),f=!0));f&&(w=this.uyi(a,b,c,l));return w&&this.dfl(w)?w:null}dfl(a){return this.Txc.XWf(a)?(this.vSh.rgb(a),
!0):!1}}Object(e.a)(zf,"UndoRevisionManager",null,[1349]);var Sf=d(156);class Lh{constructor(a){this.Pcf=null;this.Ta=new sd.a;this.$hb=null;this.fmb=[];this.eWh=a}dispose(){for(;0<this.fmb.length;)this.wbh(this.fmb[0])}get TJ(){return this.$hb}set TJ(a){this.$hb&&(this.$hb.isActive=!1);if(this.$hb=a)this.$hb.isActive=!0}register(a){if(!this.Rub(a)){const b=this.eWh.Zzi(a);b.ylh(c=>{this.Ta.raiseEvent(Lh.Qmk,new Ac(c))});a.addListener(this);Array.add(this.fmb,b)}}unregister(a){if(a=this.Gsb(a))a===
this.TJ&&(this.TJ=null),this.wbh(a)}setActive(a){this.TJ=this.Gsb(a)}ZCc(){const a=this.Gsb(void 0);a&&(a.vma(void 0),this.ete())}get vV(){return this.ZH?this.TJ.vV:!1}get PPd(){return this.ZH?this.TJ.PPd:null}get oia(){return this.ZH?this.TJ.oia:!1}get fDa(){return this.ZH?this.TJ.fDa():!1}HMe(a,b){this.ZH&&this.TJ.HMe(a,b)}Mv(){this.ZH&&this.TJ.Mv()}mV(){return this.ZH?this.TJ.mV():null}undo(){return this.ZH?this.TJ.undo():!1}redo(){return this.ZH?this.TJ.redo():!1}jVa(a,b,c=!1){this.ZH&&this.TJ.jVa(a,
b,c)&&(this.ete(),this.Pcf&&this.Pcf())}dwe(){this.ZH&&this.TJ.dwe()}wbh(a){a.graphSpace.removeListener(this);a.ylh(null);a.dispose();Array.remove(this.fmb,a)}Rub(a){return!!this.Gsb(a)}get ZH(){return!!this.TJ}Gsb(a){for(let b=0;b<this.fmb.length;b++){const c=this.fmb[b];if(c.kAj(a))return c}return null}ete(){gb.App.Fb.updateCommandUI()}Y6c(a){this.unregister(a)}onBeforeLoadContent(a){const b=this.Gsb(a);if(b)b.onBeforeLoadContent(a)}onAfterLoadContent(a){const b=this.Gsb(a);if(b)b.onAfterLoadContent(a);
this.TJ===b&&(this.TJ.vV||this.TJ.oia)&&this.ete()}onAfterFirstSaveContent(){}}Lh.Qmk="OnUndo";Object(e.a)(Lh,"UndoManager",null,[1358,377,109,1359]);class Mh extends Lh{constructor(a,b,c){super(a);this.ZXj=b;this.b4c=c;this.ZXj.y1h(Object(C.a)(this,this.jhk,"onFailoverSucceeded"));this.b4c.iGd(Object(C.a)(this,this.nik,"onInitialSelectionSet"))}get zva(){return this.TJ}tCj(a){return this.ZH?this.zva.org(a):!1}QLd(){this.ZH&&this.zva.Tki()}aYd(a){return this.ZH?this.zva.aYd(a):null}$Kc(a){return this.ZH?
this.zva.$Kc(a):0}VNe(){this.ZH&&this.zva.VNe()}get vV(){return this.ZH?this.zva.Koj:!1}vma(){this.ZH&&this.zva.vma(!0)}jhk(a,b){b.zKj&&this.vma()}nik(){this.jVa(D.a.VQa,null)}ZRe(a){this.ZH&&this.zva.ZRe(a)}rSc(){return this.ZH?this.zva.rSc():!1}j8a(){return this.ZH?this.zva.j8a():!1}}Object(e.a)(Mh,"PPTUndoManager",Lh,[1357,1358,377,109,1359]);class si{aak(a,b,c,f){return a?a.L4c(b,c,null,f,1,!1,5):null}}Object(e.a)(si,"PPTUndoRevisionMergeStrategy",null,[1356]);var Yh=d(138),Xd=d(46);class Cm{constructor(a,
b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc){this.Mke=!1;this.Hde=a;this.TA=b;this.fOg=c;this.CUa=f;this.NFa=l;this.lbb=w;this.Eac=F;S===Xd.a.oC&&(S=Xd.a.Ep);this.CFg=S;this.sa=fa;this.Ub=xa;this.h_j=Za;this.Wb=pb;this.Ga=Mb;this.ia=hc;this.L8b=kc;this.eac=Ec;this.Pb=Hc}pSk(){this.Qxh();if(this.TA){var a=this.Ub.Bk(this.TA);a&&this.h_j.Ca!==a&&(this.Wb.Ca=a)}if(this.L8b){if(this.CUa&&0<this.CUa.length){a=[];for(const b of this.CUa){let c=this.Ub.Bk(b);c&&a.push(c)}if(0<a.length){let b;(b=this.sa).tX.apply(b,
a)}}this.ia.processAction(aa.a.Meb,2)}}yT(a=!1,b=null){this.pSk();if(this.Mke||this.hqg())return this.Mke=!1,null;b||(b=this.dob());this.setSelection(a,b);return b}dob(){let a=null;if(0<this.lbb.length){const b=this.Ub.Bk(this.TA);if(b){const c=[];for(const f of this.lbb){if(!f)continue;const l=b.jS(f);if(l){const w=l.yg(this.Pb.Na);w&&!w.fFb&&c.push(fd.SelectionFactory.$k(l))}}0<c.length&&(a=new Yh.SelectionCollection(c,c.length-1))}}a||(a=this.Hde.dob(!0));!a&&this.Eac&&(a=this.Eac.f5f());return a}setSelection(a=
!1,b=null){this.Hde.setSelection(a,b);b&&this.Eac&&za.a.J(22546640,816,50,"Selection restore to IP level");b||this.CFg!==Xd.a.sg?this.Ga.vf(this.CFg):(this.sa.Rh(),this.Ga.Bd())}sBc(){return this.Hde.sBc()}Qxh(){this.TA=this.nRe(this.TA,this.fOg);const a=[];let b=0;for(const c of this.CUa)a.push(this.nRe(c,this.NFa[b++]));this.CUa=a}nRe(a,b){let c=a;a&&Rd.a.DA(a)&&(a=this.Ub.f0b(b),a||(b=this.eac.Maj(b),null!=b&&(a=this.Ub.dCa(b))),a&&(c=a.Cb));return c}yol(){this.TA=this.nRe(this.TA,this.fOg);this.L8b&&
this.Qxh();if(this.lbb.length&&Array.contains(this.lbb,0)){Array.clear(this.lbb);var a=this.dob();if(this.sa.vZ(a))for(let b of a)(a=Object(ua.a)(4,b.Wa.node))&&this.lbb.push(a.get_shapeId())}}ztl(){this.Mke=this.hqg()}hqg(){const a=this.Ub.Bk(this.TA);if(!a)return!1;var b=this.Eac?[this.Eac.nNd]:this.lbb;for(const c of b)if((b=a.jS(c))&&b.jp)return!0;return!1}}Object(e.a)(Cm,"PPTUndoSelectionReference",null,[421,1355]);class Dm{constructor(a,b,c,f,l){this.qc=a;this.Hee=b;this.cXc=c;this.Aac=f;this.yac=
l}f5f(){var a=this.qc.Bk(this.Hee);if(!a)return null;a=a.jS(this.cXc);if(!a)return null;a=a.c1d();if(!a)return null;var b=a.ta(ob.a.Uwa,0);const c=a.ta(ob.a.Gea,0);if(!this.Aac||!this.yac||this.Aac.KIa>=b||this.Aac.IIa>=c||this.yac.KIa>=b||this.yac.IIa>=c)return null;b=mb.GraphIterator.nb(a.hf(this.Aac.KIa,this.Aac.IIa));b.oc(14);a=mb.GraphIterator.nb(a.hf(this.yac.KIa,this.yac.IIa));a.oc(14);return fd.SelectionFactory.lWb(b,a)}get nNd(){return this.cXc}}Object(e.a)(Dm,"PPTUndoTableCellSelectionPos",
null,[1389]);class $m{constructor(a,b,c,f,l,w,F,S){this.Ib=a;this.qc=b;this.VN=c;this.UXj=f;this.Hee=l;this.cXc=w;this.o3c=F;this.c7j=S}f5f(){var a=this.qc.Bk(this.ori);if(!a)return null;let b=null;if(10===this.containerType||16===this.containerType)if(b=a.jS(this.nNd),!b)return null;var c=[];switch(this.containerType){case 10:c=this.FWd(b);break;case 16:a=this.Ib.Jc(b);if(!a.Ii()||!a.Ii())return null;if(0>this.KIa||0>this.IIa||this.KIa>=a.currentNode.ta(ob.a.Uwa,0)||this.IIa>=a.currentNode.ta(ob.a.Gea,
0)){this.VN.PSg(a,0,0);c.push(fd.SelectionFactory.oj(a.currentNode,!0));break}this.VN.PSg(a,this.KIa,this.IIa);c=this.FWd(a.currentNode);break;case 60:c=a.TPa();if(!c)return null;c=this.FWd(c);break;default:return null}return 0<c.length?new Yh.SelectionCollection(c,0):null}get nNd(){return this.cXc}FWd(a){const b=[];for(const c of this.Cil){const f=c.MUi(a);f&&b.push(f)}b.length||b.push(fd.SelectionFactory.oj(a,!0));return b}get containerType(){return this.UXj}get ori(){return this.Hee}get IIa(){return this.o3c?
this.o3c.IIa:-1}get KIa(){return this.o3c?this.o3c.KIa:-1}get Cil(){return this.c7j}}Object(e.a)($m,"PPTUndoTextSelectionPos",null,[1389]);class Em{constructor(a,b){this.M6j=a;this.U6j=b}get IIa(){return this.M6j}get KIa(){return this.U6j}}Object(e.a)(Em,"TableCellIndex",null,[]);class zj{constructor(a,b,c,f,l,w){this.Ib=a;this.Zh=b;this.w3j=c;this.XXj=f;this.U_j=l;this.T_j=w}get contextId(){return this.XXj}get paragraphIndex(){return this.w3j}get N2b(){return this.U_j}get M2b(){return this.T_j}MUi(a){a=
this.Ib.Jc(a);if(!a.b2d(this.paragraphIndex)||11!==a.Gp.type||!a.yb(2)||12!==a.Gp.type&&21!==a.Gp.type||this.N2b>this.M2b||-1>this.N2b||this.M2b>this.Zh.textLength(a.currentNode))return null;switch(this.contextId){case Db.a.Ff:return fd.SelectionFactory.PY(a.currentNode,this.N2b,this.M2b);case Db.a.textRange:return fd.SelectionFactory.PY(a.currentNode,this.N2b,this.M2b);case Db.a.endOfParagraph:return fd.SelectionFactory.Taa(a.currentNode);case Db.a.paragraph:return fd.SelectionFactory.Zt(Fc.a.MNa(this.N2b,
this.M2b,!1,a.currentNode))}return null}}Object(e.a)(zj,"TextContextRecord",null,[]);class Fm{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc){this.vXj=a;this.sa=b;this.ZFg=c;this.Wb=f;this.Ib=l;this.Ga=w;this.qc=F;this.Fa=S;this.Zh=fa;this.VN=xa;this.ia=Za;this.L8b=pb;this.eac=Mb;this.Pb=hc}bqa(){const a=this.vXj.bqa();let b=null,c=Fa.a.nil;const f=this.ZFg.Ca;f&&(b=f.Cb,c=f.id);const l=[],w=[];if(this.L8b){var F=this.sa.rf();for(var S of F)l.push(S.Cb),w.push(S.id)}F=[];S=null;f&&(this.sa.rG()&&this.EGk(F),
this.sa.jD()&&(S=this.JGk(b)));return new Cm(a,b,c,l,w,F,S,this.Ga.Vaa,this.sa,this.qc,this.ZFg,this.Wb,this.Ga,this.ia,this.L8b,this.eac,this.Pb)}BSc(a){return 10===a.type||60===a.type||16===a.type}EGk(a){const b=this.sa.he();for(const c of b)a.push(c.get_shapeId())}JGk(a){return this.sa.Pa.kb.hg?this.HGk(a):this.IGk(this.sa.Pa,a)}IGk(a,b){var c=Object(ua.a)(5,a.kb.Wa.node),f=this.Ib.Jc(c);if(f.t0(Object(C.a)(this,this.BSc,"isOEContainerNode")))if(f.yc()&&11===f.currentNode.type){if(f.yc()){c=(c=
this.Fa.f7(c))?c.get_shapeId():0;const l=f.Gp.type;f=16===l?this.g1d(Object(ua.a)(123,f.Gp)):null;const w=a.kb,F=[];this.jEf(w,F);for(let S of a)S!==w&&this.P8h(S,w)&&this.jEf(S,F);return new $m(this.Ib,this.qc,this.VN,l,b,c,f,F)}}else za.a.J(22345955,816,15,"Find text selection but its container is not OutlineElement");return null}HGk(a){var b=this.sa.Pa.ga(0),c=this.sa.Pa.last,f=b.hg;b=16===f.Wa.node.type?this.g1d(Object(ua.a)(123,f.Wa.node)):null;f=c.hg;c=16===f.We.node.type?this.g1d(Object(ua.a)(123,
f.We.node)):null;f=(f=this.Fa.f7(f.Wa.node))?f.get_shapeId():0;return new Dm(this.qc,a,f,b,c)}g1d(a){return a?new Em(a.pi,a.rowIndex):null}jEf(a,b){for(let c of a){if(!Object(Ca.a)(103,c.node))continue;a=this.Ib.Jc(c.node);if(!a.t0(Object(C.a)(this,this.BSc,"isOEContainerNode")))continue;a.yc();const f=a.currentNode;a.yc();a=a.DBa(f);b.push(new zj(this.Ib,this.Zh,a,c.contextId,c.Qa,c.Lb))}}P8h(a,b){a=this.Ib.Jc(a.Wa.node);b=this.Ib.Jc(b.Wa.node);return a.t0(Object(C.a)(this,this.BSc,"isOEContainerNode"))&&
b.t0(Object(C.a)(this,this.BSc,"isOEContainerNode"))&&a.yc()&&11===a.currentNode.type&&b.yc()&&11===b.currentNode.type&&a.yc()&&b.yc()?a.currentNode===b.currentNode:!1}}Object(e.a)(Fm,"PPTUndoSelectionReferenceFactory",null,[399]);class t{constructor(){this.rTa=this.tNg=this.Goe=this.FPg=null;this.c_c=!1;this.sqe=null}kRe(){if(!this.rTa.cub&&this.rTa.j5b)for(const a of this.rTa.j5b)if(a.equals(this.FPg)){this.Goe.yT(!1,this.tNg);za.a.J(22684815,813,50,"Undo/Redo Success, and E2E time is: {0}ms",+new Date-
+this.sqe);this.rTa.Chc(Object(C.a)(this,this.kRe,"trySetSelectionWhenServerUndoRedoFinish"));this.c_c=!0;break}}JJk(a,b,c,f){a&&(this.FPg=b,this.tNg=f,(this.Goe=Object(ua.a)(1355,c))?(this.IRe(),this.sqe=new Date,this.rTa=a,this.rTa.xzc(Object(C.a)(this,this.kRe,"trySetSelectionWhenServerUndoRedoFinish")),this.c_c=!1):za.a.J(21051018,816,15,"The selectionreference is not the type of PPTUndoSelectionReference"))}IRe(){this.rTa&&!this.c_c&&(za.a.J(22684818,813,50,"Undo/Redo Fail, and E2E time is: {0}ms",
+new Date-+this.sqe),this.rTa.Chc(Object(C.a)(this,this.kRe,"trySetSelectionWhenServerUndoRedoFinish")),this.c_c=!0)}}Object(e.a)(t,"PPTUndoSelectionRestoreExecutor",null,[1299]);class X{constructor(){this.D6j=new Ie.a(!1);this.D7j=new Ie.a(!1);this.PJg=new Ie.a(!1);this.init()}init(){this.Ttj()}Ttj(){this.PJg.add(aa.a.LM,!0)}Gti(a){return a&&this.D6j.Kb(a)?!0:!1}Fti(a){return a&&this.D7j.Kb(a)?!1:!0}e7k(a){return a&&this.PJg.Kb(a)?!0:!1}}Object(e.a)(X,"PPTUndoSettings",null,[1354]);class sa{constructor(a){this.Bj=
null;this.ZWe=a}start(a){this.Bj=a}voj(){var a=new Date;return this.ZWe?+a-+this.Bj>this.ZWe:!1}}Object(e.a)(sa,"UndoTimer",null,[1390]);var Qa=d(473),kb=d(512);class Ib{constructor(a){this.J$=this.o1=null;this.oqb=this.Wkc=a}get Wkc(){return this.o1}set Wkc(a){this.o1&&(this.o1.eO&=-2);this.o1=a;this.o1.eO|=1}get oqb(){return this.J$}set oqb(a){this.J$&&(this.J$.eO&=-3);this.J$=a;this.J$.eO|=2}get P4(){return this.o1?this.o1.id:Fa.a.nil}get PSd(){return this.J$?this.J$.id:Fa.a.nil}get YI(){return this.o1?
this.o1.Yyg():[]}combineWithPrevious(){}dispose(){this.o1&&(this.o1.eO&=-2);this.J$&&(this.J$.eO&=-3)}}Object(e.a)(Ib,"Box4UndoRecordData",null,[1401,109]);class Zb{constructor(a,b,c,f,l,w){this.cwa=a;this.Seb=b;this.aWh=c;this.actionId=f;this.qS=l;this.FHa=w}get u0(){return this.aWh}get P4(){return this.u0.P4}dispose(){this.u0&&this.u0.dispose()}}Object(e.a)(Zb,"UndoRecord",null,[109]);class Kb{constructor(){this.$oa=[]}ga(a){return this.$oa[a]}get length(){return this.$oa.length}add(a){this.$oa.push(a)}clear(){for(let a=
0;a<this.$oa.length;a++)this.$oa[a].dispose();Array.clear(this.$oa)}remove(a){const b=Array.remove(this.$oa,a);b&&a.dispose();return b}removeAt(a){0<=a&&a<this.$oa.length&&(this.$oa[a].dispose(),Array.removeAt(this.$oa,a))}}Object(e.a)(Kb,"UndoRecordsArray",null,[]);class Gb{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe){this.A1a=!0;this.V_a=this.y3e=this.Hsc=this.wlb=!1;this.tjb=null;this.Uxd=this.xef=0;this.BEd=null;this.yuf=!0;this.isActive=!1;this.az=a;this.opd=b;this.YNh=
c;this.tsd=f;this.$Wh=l;this.iQh=w;this.kk=F;this.hH=S;this.qrf=fa;this.USh=xa;this.Md=Za;this.TVh=pb;this.cTh=Mb;this.Vpf=hc;this.bWh=Ec;this.xxf=Hc;this.fWh=Dc;this.zxf=Td;this.naa=we;this.Zx=He;this.Jg=new Kb;this.Jr=this.lh=-1;this.T4e=Object(C.a)(this,this.rRf,"createInitialUndoRecord");this.Zvc=kc;this.Zvc.R3h(Object(C.a)(this,this.vbh,"removeUndoRecordForRevision"));this.yuf=Pe}dispose(){this.T4e=null;this.ZCc();this.az=null;this.Zvc.XNk(Object(C.a)(this,this.vbh,"removeUndoRecordForRevision"))}get graphSpace(){return this.az}get Dfc(){return this.YNh.value}kAj(a){return this.az===
a?!0:!1}ZCc(){this.Jg.clear();this.Jr=this.lh=-1;this.A1a=!0}qli(){if(this.lh===this.Jg.length-1)this.ZCc();else{let a=0;for(;a<this.lh;)this.Jg.removeAt(0),a++;this.lh=0;this.Jr=1}}get vV(){return 0<this.lh}get PPd(){return this.vV?this.Jg.ga(this.lh).actionId:null}get QPd(){return 0<=this.lh&&this.lh<this.Jg.length?this.Jg.ga(this.lh).u0:null}HMe(a,b){this.V_a?(this.Ilc(),this.vma()):(this.Vpf&&this.Dfc.suspend(),this.V_a=!0,this.tjb=a,this.xef=b,this.Uxd=0)}Ilc(){this.V_a=!1;this.Vpf&&this.Dfc.resume()}apl(){this.cTh(new Fa.a(this.tjb,
1));this.Ilc()}jVa(a,b,c=!1){if(!this.opd()||a===D.a.VQa&&this.Jg.length)return!1;var f=this.az.uV();if(!f&&a!==D.a.VQa&&!c||!this.az||!this.az.Ai)return!1;f&&(this.y3e||(Z.ULS.sendTraceTag(39102051,305,50,"Real Edit occurred"),this.y3e=!0),this.tsd.execute(w=>{w.sSd()}));if(this.V_a){Z.ULS.sendTraceTag(23171273,365,50,"Incremental action {0} interrupted by user edits. Cancelling action.",this.tjb);this.Ilc();for(c=this.Jg.length-2;0<=c;c--)this.Jg.removeAt(c);this.lh=0;this.Jr=-1}c=this.mV();f=this.iFc(f,
a);this.Qpb();b=this.Ani(a,f,b);const l=this.naa.vGb()&&!this.naa.RXa();a=new Zb(b,c,f,a,this.wlb,l);this.Jg.add(a);this.lh=this.Jg.length-1;return!0}iFc(a,b){return this.bWh(a,b)}Ani(a,b,c){if(0<=this.lh){switch(a){case D.a.Rza:case D.a.jOa:case D.a.typing:this.A1a&&this.Jg.ga(this.lh).actionId===a?(a=this.Jg.ga(this.lh),c=a.cwa,b.combineWithPrevious(a.u0),this.Jg.removeAt(this.lh)):u.AFrameworkApplication.fa.ka("OtelSendTypingUserActionDisabled")||(b=this.TVh.create(a),b.end(32),this.$Wh.ehc(b),
this.iQh.dhc(b))}this.A1a=!0}return c}dwe(){this.fWh(this)}OEi(){this.yuf&&!this.A1a||!this.naa.vGb()||(this.A1a=!1,this.wlb=!0)}u9j(){if(this.naa.RXa())for(let a=0;a<this.Jg.length;a++)this.Jg.ga(a).FHa=!0}Qpb(){if(this.lh<this.Jg.length-1){for(let a=this.Jg.length-1;a>this.lh;a--)this.Jg.removeAt(a);this.Jr=-1}}ctl(){var a=Sf.ObjectSpace.Y6(this.az.Ai);a=new Ib(a);const b=this.mV(),c=this.Jg.ga(this.lh).cwa;a=new Zb(c,b,a,D.a.lld,this.Jg.ga(this.lh).qS,this.Jg.ga(this.lh).FHa);this.Jg.removeAt(this.Jg.length-
1);this.Jg.add(a)}Edb(a,b,c,f){return a.Edb(b,c,f)}Bxe(a,b,c){this.Hsc=!0;a.Ebe();this.Hsc=!1;b.yT(void 0,c)}undo(){if(!this.vV)return!1;this.tsd.execute(xa=>{xa.sSd()});var a=!0;let b=!1;var c=!1;const f=this.kk.ie(7);f.hd(this.az);let l=0,w=!1,F=this.mV(),S=null;const fa=this.xxf(!0);for(this.zxf.start(new Date);this.vV&&a;){const xa=this.Jg.ga(this.lh),Za=this.Jg.ga(this.lh-1);a=xa.qS&&Za.qS;Z.ULS.sendTraceTag(22607296,365,50,"Performing Undo [IsContinuation: {0}], [AppMode: {1}]",a,kb.a[this.Zx]);
this.Jr=this.lh;try{if(b=this.Edb(fa,xa.u0,Za.u0,xa.FHa||Za.FHa))F=this.Jg.ga(this.lh).cwa,S=this.Jg.ga(this.Jr).Seb,this.BEd&&this.BEd(this.Jg.ga(this.lh).actionId)}catch(pb){Z.ULS.sendTraceTag(22607297,365,10,"Undo hit an exception: {0}. Callstack: {1}",pb.message,pb.stack),b=!1,c=!0}l++;b?this.lh--:(Z.ULS.sendTraceTag(22607298,365,15,"Undo failed. [HitException: {0}] [AppMode: {1}]",c,kb.a[this.Zx]),this.qli(),a=!1);if(this.zxf.voj()){w=!0;break}}b&&this.Bxe(fa,F,null,S,!0);f.dispose();this.Mv();
this.V_a&&(this.apl(),this.Qpb());this.hH.updateCommandUI();this.qrf.P9();if(0<this.lh&&w&&this.Jg.ga(this.lh).qS){a=this.lh;for(c=0;0<a&&this.Jg.ga(a).qS;)c++,a--;this.Jg.ga(this.lh).qS=!1;Z.ULS.sendTraceTag(22607299,365,50,"Cascading undos exceed the time limit, [MergesDone: {0}], [MergesToBeDone: {1}].",l,c)}else 1<l&&Z.ULS.sendTraceTag(22607300,365,50,"Cascading undos within the time limit, [MergesDone: {0}]",l);return b}Mv(){this.wlb=this.A1a=!1}get oia(){return 0<this.Jr}redo(){if(!this.oia)return!1;
this.tsd.execute(F=>{F.sSd()});var a=!0;let b=!1,c=!1;const f=this.kk.ie(7);f.hd(this.az);let l=this.mV();const w=this.xxf(!1);for(;this.oia&&a;){a=this.Jg.ga(this.Jr);const F=this.Jg.ga(this.lh);Z.ULS.sendTraceTag(22607301,365,50,"Performing Redo [IsContinuation: {0}] [AppMode: {1}]",this.Jg.ga(this.Jr).qS&&this.Jg.ga(this.lh).qS,kb.a[this.Zx]);try{if(b=this.Edb(w,a.u0,F.u0,a.FHa||F.FHa))l=this.Jg.ga(this.Jr).Seb}catch(S){Z.ULS.sendTraceTag(22607302,365,10,"Redo hit an exception: {0}. Callstack: {1}",
S.message,S.stack),b=!1,c=!0}b?(this.lh=this.Jr,this.Jr<this.Jg.length-1?(this.Jr++,a=this.Jg.ga(this.Jr).qS&&this.Jg.ga(this.lh).qS):(this.Jr=-1,a=!1)):(Z.ULS.sendTraceTag(22607303,365,15,"Redo failed. [HitException: {0}] [AppMode: {1}]",c,kb.a[this.Zx]),this.vma(),a=!1)}b&&this.Bxe(w,l,null,null,!1);f.dispose();this.Mv();this.hH.updateCommandUI();this.qrf.P9();return b}mV(){return this.opd()?this.USh.bqa():null}Tyk(a){return this.V_a&&xg.a.compare(a.fq,this.tjb)?(Z.ULS.sendTraceTag(512362002,365,
50,"Incremental Action in progress"),this.ctl(),this.Uxd=a.n,this.Uxd===this.xef&&(Z.ULS.sendTraceTag(23171274,365,100,"Incremental Action {0} was completed successfully",this.tjb),this.Ilc()),!0):!1}onBeforeLoadContent(){}onAfterLoadContent(a){if(!this.Hsc&&!this.Tyk(a.Ai.qx.id))if(this.V_a&&(Z.ULS.sendTraceTag(23171276,365,50,"Incremental action {0} terminated due to inbound revision with ID {1}",this.tjb,this.az.Ai.qx.id),this.Ilc()),!this.naa.vGb())this.vma();else if(this.oia||this.vV)this.OEi(),
this.u9j()}vma(a=!1){this.ZCc();a?this.rRf(null):(a=new Se.a(2,1,0,this.T4e,50),this.Md.Hb(a))}vbh(a,b){if(b&&(1===(b.eO&1)||2===(b.eO&2))){a=this.oia;const f=this.vV;for(var c=this.Jg.length-1;0<=c;c--){const l=Object(ua.a)(Ib,this.Jg.ga(c).u0);!l||l.Wkc!==b&&l.oqb!==b||(this.Jg.removeAt(c),-1!==this.lh&&this.lh--,-1!==this.Jr&&this.Jr--)}b=this.oia;c=this.vV;!this.isActive||a===b&&f===c||(Z.ULS.sendTraceTag(36218332,365,15,"UndoRedo status is changed by revision removal:{0},{1},{2},{3}.",a,b,f,
c),this.hH.updateCommandUI())}}rRf(){this.opd()&&this.jVa(D.a.VQa,this.mV())}fDa(){return this.Hsc}ylh(a){this.BEd=a}}Object(e.a)(Gb,"UndoStack",null,[1404,109]);var jc=d(775);class vc extends Sys.EventArgs{constructor(a){super();this.state=a}}Object(e.a)(vc,"RevisionStateArgs",Sys.EventArgs,[]);class Nc{constructor(a,b,c,f,l,w){this.cwa=a;this.Seb=b;this.P4=c;this.actionId=f;this.qS=l;this.FHa=w}}Object(e.a)(Nc,"PPTLocalUndoRecord",null,[]);class ud extends Gb{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,
pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig,Ff,nh,Jg,$h,Li,Aj,Zi,Ui){super(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,Ig,Zi,4,Ui);this.q_c=!1;this.f$b=-1;this.aL=[];this.eT=we;this.vne=Pd;this.tne=He;this.Ib=Pe;this.la=Df;this.Yka=ig;this.Ga=Tg;this.qTa=Ff;this.qTa.tCf(Object(C.a)(this,this.bCb,"onRevisionProcessed"));this.Ebb=nh;this.sa=Jg;this.rqe=$h;this.JIg=Li;this.GPg=Aj;this.jKg=Ig.vGb()&&!Ig.RXa()}jVa(a,b,c=!1){let f=!1;b=this.GPg.wtl(b);var l=this.lh;this.vne.e7k(a)?f=this.H9j(a,
b):this.vne.Fti(a)?(f=this.Ogi(a,b,c))&&this.Kml(a):this.vma();b=null;f?(l=this.lh-l,b=this.D0b(this.lh),this.oGk(b,!l),this.j8a()||this.oTd()):this.GPg.kyj();l=null;this.la.designerSendActionDuration&&b&&b.u0&&b.u0.PSd!==Fa.a.nil&&(l=b.u0.PSd);this.tne.chj(a,f,l);return f}iFc(a,b){const c=0<=this.lh?this.Jg.ga(this.lh):null;this.Ebb.OVg(b,c,this.A1a,this.wlb);b=super.iFc(a,b);this.Ebb.oVg(c,b,a);return b}org(a){let b=!1,c=null;a&&this.vV?c=this.Jg.ga(this.lh):!a&&this.oia&&(c=this.Jg.ga(this.Jr));
c&&(b=this.hSc(c.P4));return b&&this.j8a()}Edb(a,b,c,f){let l=!1;if(this.org(a.S8a))(l=super.Edb(a,b,c,f))&&this.B9j(a.hja);else{const w=a.S8a?2:3;l=a.L6g(F=>{this.eT.IAh(F,w)});this.p9j(a.hja);this.qTa.Cbd(new vc(0))}return l}onBeforeLoadContent(a){super.onBeforeLoadContent(a);this.q_c&&this.qTa.Cbd(new vc(2))}onAfterLoadContent(a){super.onAfterLoadContent(a);this.q_c&&(this.qTa.Cbd(new vc(3)),this.q_c=!1)}dispose(){this.qTa.dch(Object(C.a)(this,this.bCb,"onRevisionProcessed"));super.dispose()}Bxe(a,
b,c,f,l){a&&a.hja!=Fa.a.nil&&(this.JIg&&(f&&this.SAh(f),b&&this.SAh(b)),0<this.aL.length&&(f=new Nc(this.mV(),b,a.hja,l?aa.a.Adb:aa.a.zdb,!1,this.jKg),Array.add(this.aL,f)),a.Ebe(),b&&0<this.aL.length?b.yT(void 0,c):(Kc.a.Db&&(Kc.a.Zda(Kc.a.Db),Kc.a.Db.fB(lh.a.mX,Kc.a.u6a(a.hja.toString()).toString())),this.JIg&&(f=Object(ua.a)(137,this.az.contentReplicator))&&b&&this.rqe.JJk(f,a.hja,b,c)))}bCb(a,b){b&&(!(a=b.L9)||2!==a.RevisionSource&&3!==a.RevisionSource||(this.q_c=!0,this.la.trg||(b=2===a.RevisionSource?
Object(ua.a)(1355,this.Jg.ga(0<this.Jr?this.Jr:this.Jg.length-1).cwa):Object(ua.a)(1355,this.Jg.ga(this.lh).Seb))&&b.ztl(),this.bKi(a.ServerUndoStackLength,a.ServerRedoStackLength,a.LastServerUndoFail,a.LastServerRedoFail),this.qTa.Cbd(new vc(1))))}bKi(a,b,c,f){a!==this.lh&&za.a.J(512362001,823,50,"Undo stack length not synced. Server length: {0}, client: {1}",a,this.lh);if(a<this.lh||f){do this.Jg.removeAt(this.lh--);while(this.lh>a);this.Jr=0<this.Jr?this.lh+1:-1;this.rqe.IRe()}if(!(0>this.Jr)&&
(b!==this.Jg.length-this.Jr&&za.a.J(512362E3,823,50,"Redo stack length not synced. Server length: {0}, client: {1}",b,this.Jg.length-this.Jr),b<this.Jg.length-this.Jr||c)){do this.Jg.removeAt(this.Jr);while(this.Jg.length-this.Jr>b);if(!b||this.Jr>=this.Jg.length)this.Jr=-1;this.rqe.IRe()}}SAh(a){(a=Object(ua.a)(1355,a))&&a.yol()}Tki(){if(this.la.wub&&this.aL.length){var a=this.D0b(this.lh);if(a){var b=a.cwa;if(this.hSc(a.P4)){for(let c=this.lh-1;0<c;c--){const f=this.D0b(c);if(!f)break;if(this.hSc(f.P4))b=
f.cwa,this.Jg.removeAt(c),this.lh--;else break}this.Qpb()}else this.Jg.add(a),this.lh++,this.Jr=-1;a.cwa=b;a.qS=!1;this.gdd();this.oTd()}else this.Qpb(),this.gdd()}}VNe(){if(this.la.wub){var a=this.D0b(this.lh);if(a){if(0<(-1===this.f$b?0:this.Jg.length-this.f$b)){for(var b=this.Jg.length-1;b>=this.f$b;b--)this.Jg.removeAt(b);for(b=0;0<=b&&b<this.aL.length;){var c=b;let f=!0;for(;f&&b<this.aL.length;)b<this.aL.length-1?(f=this.aL[b].qS&&this.aL[b+1].qS,b++):(f=!1,b=-1);c=this.aL[c];this.Jg.add(new Zb(c.cwa,
this.aL[0>b?this.aL.length-1:b-1].Seb,a.u0,c.actionId,!1,c.FHa))}this.lh=this.Jg.length-1}this.Jr=-1;this.gdd();this.oTd()}else this.Qpb(),this.gdd()}}get Koj(){if(this.la.wub&&this.j8a()){const a=this.D0b(this.lh);if(!a||0<this.aL.length&&!this.hSc(a.P4))return!1}return this.vV}oTd(){var a=this.la.z$j;if(this.lh>a){var b=0;for(a=this.lh-a-1;0<=a;a--)this.Jg.removeAt(a),b++;this.lh-=b;b=this.Jr-b;this.Jr=0<b?b:-1}}Ogi(a,b,c){const f=0<=this.lh?this.Jg.ga(this.lh):null;this.wlb=!!f&&this.Ebb.VTc(a)&&
f.actionId===a&&this.wlb;return super.jVa(a,b,c)}oGk(a,b){this.la.wub&&a&&(this.j8a()||this.vne.Gti(a.actionId))&&(this.aL.length||(this.f$b=this.lh),b&&Array.removeAt(this.aL,this.aL.length-1),Array.add(this.aL,new Nc(a.cwa,a.Seb,a.P4,a.actionId,a.qS,a.FHa)))}D0b(a){return 0<a&&a<=this.lh?this.Jg.ga(a):null}aYd(a){a=a?this.lh:this.Jr;return 0<=a&&a<this.Jg.length?this.Jg.ga(a).u0:null}$Kc(a){a=a?this.lh:this.Jr;return 0<=a&&a<this.Jg.length?this.Jg.ga(a).actionId:0}gdd(){Array.clear(this.aL);this.f$b=
-1}j8a(){const a=this.Ga.ye;return a?a.name!==Xd.a.sg&&a.name!==Xd.a.Pua&&a.name!==Xd.a.NT&&a.name!==Xd.a.JIa&&a.name!==Xd.a.fO||!this.sa.jD()||this.wBj()?!1:!0:!1}rgb(a){Sf.ObjectSpace.i2(this.graphSpace.Ai,!1).rgb(a)}Kml(a){this.la.wub||this.Jml(a);this.Iml(a)}Jml(a){if(1<=this.lh&&this.cxg(a)){const b=this.lh-1,c=this.Jg.ga(b),f=c.actionId;f!==a&&!this.cxg(f)||1!==this.Yka.Esb(c.P4)||(this.Jg.removeAt(b),this.lh=this.Jg.length-1)}}Iml(a){if(1<=this.lh&&this.$zj(a)){const b=this.lh-1,c=this.Jg.ga(b).actionId;
if(c===a||this.ECj(c))this.Jg.removeAt(b),this.lh=this.Jg.length-1}}cxg(a){return a===D.a.WA||a===D.a.Rza||a===D.a.jOa||a===D.a.typing||a===D.a.enter}ECj(a){return a===aa.a.Kza||a===aa.a.s9c}$zj(a){return a===aa.a.gnb||a===aa.a.t9c||a===aa.a.jec}H9j(a,b){const c=this.iFc(this.az.uV(),a);this.Qpb();a=new Zb(b,null,c,a,!1,this.jKg);this.Jg.add(a);this.lh=this.Jg.length-1;return!0}B9j(a){let b=null;this.sa.Uia()?b=this.sa.ncg():this.sa.jD()&&(b=this.sa.Dq());b&&this.qTa.q9g(new jc.a(b,a))}p9j(a){const b=
this.Ib.Jc(this.graphSpace);b.yb(80);Object(ua.a)(408,b.Gp).isDirty=!0;this.qTa.q9g(new jc.a(b.currentNode,a))}ZRe(a){0>this.lh||(this.Jg.ga(this.lh).Seb=a)}rSc(){return!this.aL.length}hSc(a){for(const b of this.aL)if(b.P4===a)return!0;return!1}wBj(){for(const a of this.sa.he())if(a.getValue(zb.a.clearFormatting))return!0;return!1}}Object(e.a)(ud,"PPTUndoStack",Gb,[]);class Ud{constructor(a){this.C7j=a}Zzi(a){const b=this.C7j.ISf(a);return new ud(a,()=>!!oa.InteractiveViewManager.instance.Jd,new sc.a(()=>
gb.App.SQ),lb.a.instance.Oa("Common.Interface.IEditNotificationManager"),bf.a.getInstance(),Sh.a.getInstance(),lb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),lb.a.instance.resolve("Box4.IAppFrame"),lb.a.instance.resolve("Box4.IReplicationScheduler"),lb.a.instance.resolve("Box4.ISelectionReferenceFactory"),lb.a.instance.resolve("Common.ITaskManager"),lb.a.instance.resolve("Box4.ITypingActionOperationFactory"),()=>{},I.a.instance.ga(70),Qa.a.instance,b.syh,b.tyh,b.xyh,new sa(gb.App.eLf),
lb.a.instance.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),lb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSettings"),lb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),lb.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings"),lb.a.instance.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader"),lb.a.instance.resolve("Common.IFocusManager"),lb.a.instance.resolve("Box4.UndoRedo.IUndoSettingsManager"),
lb.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),lb.a.instance.resolve("PowerPointWebEditor.ITablePartialEditController"),lb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),lb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor"),lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled,lb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater"),
lb.a.instance.qe("Box4.ICoauthCashTelemetry"),Object(qd.a)("SkipEnablingCascadeUndoIfNotCombiningUndoRecords"))}}Object(e.a)(Ud,"PPTUndoStackFactory",null,[1353]);class Ge{constructor(){this.AXc=new sd.a}Vjl(a){this.AXc.raiseEvent("MU",a)}vSb(a){this.AXc.addHandler("MU",a)}pDe(a){this.AXc.removeHandler("MU",a)}dispose(){this.AXc.dispose()}}Object(e.a)(Ge,"UndoEventSource",null,[1350,1351,1352,109]);class ch{constructor(a,b){this.Kbb=0;this.s2c=null;this.Lke=!1;this.gv=a;this.Dk=b;this.Dk.PBf(Object(C.a)(this,
this.NVg,"onBeforeForceOutboundGraphTransactionInitialize"));this.Dk.OBf(Object(C.a)(this,this.V6c,"onForceOutboundGraphTransactionDisposed"))}dispose(){this.Dk.Dbh(Object(C.a)(this,this.NVg,"onBeforeForceOutboundGraphTransactionInitialize"));this.Dk.BMk(Object(C.a)(this,this.V6c,"onForceOutboundGraphTransactionDisposed"))}wtl(a){return 1===this.Kbb&&this.s2c?this.s2c:a}kyj(){1===this.Kbb&&(this.Lke=!0)}NVg(a,b){this.exg(b.transaction.jxa)&&(this.Kbb+=1,1===this.Kbb&&(this.s2c=this.gv.mV()))}V6c(a,
b){this.exg(b.transaction.jxa)&&(1===this.Kbb&&(this.s2c=null,this.Lke||(a=this.gv.mV(),this.gv.ZRe(a)),this.Lke=!1),--this.Kbb)}exg(a){return 8===(a&8)}}Object(e.a)(ch,"UndoSelectionUpdater",null,[1302,109]);var Nh=d(581);class ti{constructor(a,b,c){this.az=a;this.Avd=b;this.XDd=c;this.cY=Sf.ObjectSpace.Y6(this.az.Ai)}Edb(a,b,c){a=this.XDd.vyi(this.Avd?a.Wkc:b.oqb,this.Avd?b.oqb:a.Wkc,this.cY,c,gb.App.WIa);if(b=!!a)this.cY=a;return b}L6g(a){const b=new Ke.a;b.PMe(this.az.Ai,this.cY);a(b);a=b.bJc();
Sf.ObjectSpace.i2(this.az.Ai,!1).rgb(a);this.cY=a;return!!a}Ebe(){const a=new Nh.a(Sf.ObjectSpace.Y6(this.az.Ai),this.cY);this.az.Rvb(a)}get S8a(){return this.Avd}get hja(){return this.cY.id}}Object(e.a)(ti,"Box4UndoRedoPerformer",null,[1400]);class Oh{constructor(a,b){this.syh=c=>{c&&this.az.Ama();c=Sf.ObjectSpace.Y6(this.az.Ai);return new Ib(c)};this.tyh=c=>new ti(this.az,c,this.XDd);this.xyh=c=>{if(c.QPd&&(this.az.uV()&&this.az.Ama(),c.QPd&&(c=c.QPd))){var f=Sf.ObjectSpace.Y6(this.az.Ai);c.oqb=
f}};this.az=a;this.XDd=b}}Object(e.a)(Oh,"Box4UndoStackDataSyncHelper",null,[1384]);class Pf{constructor(a){this.cWh=a}ISf(a){return new Oh(a,this.cWh(a.Ai))}}Object(e.a)(Pf,"Box4UndoStackDataSyncHelperFactory",null,[1345]);class ei{constructor(a,b,c){this.Zab=[];this.pAb=a;this.$1c=b;this.A9b=c}get P4(){return this.$1c}get PSd(){return this.$1c}get YI(){return this.Zab}perform(){try{if(this.pAb){const a=this.pAb.perform();this.pAb=a.undoOperation;this.Zab=h(a.cOc,this.A9b);return a}}catch(a){Z.ULS.sendTraceTag(0,
844,10,"FluidUndoRecordData.tryPerform exception: {0}.",a)}return null}combineWithPrevious(a){a&&a.pAb&&this.pAb.combineWithPrevious(a.pAb)}dispose(){}}Object(e.a)(ei,"FluidUndoRecordData",null,[1401,109]);class Rj{constructor(a,b){this.Z7b=[];this.v$a=a;this.H1j=b}Edb(a){return a?(a=a.perform(),this.$5g(a)):!1}L6g(a){const b=this.v$a.Ai.tGi.HEc();b.start(this.v$a.Ai);a(b);a=b.finish();return this.$5g(a)}Ebe(){this.Z7b.forEach(a=>{this.v$a.Rvb(a)})}get S8a(){return this.H1j}get hja(){return 0<this.Z7b.length?
this.Z7b[this.Z7b.length-1].gja:Fa.a.nil}$5g(a){return a?(a.cOc&&this.Z7b.push(...a.cOc),!0):!1}}Object(e.a)(Rj,"FluidUndoRedoPerformer",null,[1400]);class ok{constructor(a){this.syh=b=>{var c,f;let l=null;b&&(l=this.v$a.Ama());return new ei(null!==(c=null===l||void 0===l?void 0:l.undoOperation)&&void 0!==c?c:null,null!==(f=null===l||void 0===l?void 0:l.revisionId)&&void 0!==f?f:Fa.a.nil,this.v$a.Ai)};this.tyh=b=>new Rj(this.v$a,b);this.xyh=()=>{};this.v$a=a}}Object(e.a)(ok,"FluidUndoStackDataSyncHelper",
null,[1384]);class Si{ISf(a){return new ok(a)}}Object(e.a)(Si,"FluidUndoStackDataSyncHelperFactory",null,[1345]);class Yl{constructor(a){this.eT=a}csl(a){this.eT.IAh(a,1);this.eT.ktl(a)}}Object(e.a)(Yl,"PPTInverseRevisionUpdater",null,[1344]);class Dp{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UndoRedo"}Yb(a){this.K=a;a.register(In,"Box4.UndoRedo.UndoSettingsManager").as("Box4.UndoRedo.IUndoSettingsManager").ma();a.register(Xl,"Box4.UndoRedo.UndoRevisionValidator").as("Box4.UndoRedo.IUndoRevisionValidator").ma().na(()=>
new Xl(a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(399,"Box4.ISelectionReferenceFactory").ma().na(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled?new Fm(mm.SelectionReferenceFactory.instance,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ITableNavigator"),a.resolve("Common.IActionManager"),b.vz,a.resolve("PowerPointWebEditor.ISidUpdater"),a.resolve("PowerPointWebEditor.View.IPPTPageView")):mm.SelectionReferenceFactory.instance});a.register(si,"PowerPointWebEditor.UndoRedo.PPTUndoRevisionMergeStrategy").as("Box4.UndoRedo.IUndoRevisionMergeStrategy").ma();
a.register(X,"PowerPointWebEditor.UndoRedo.PPTUndoSettings").as("PowerPointWebEditor.UndoRedo.IPPTUndoSettings").ma();a.resolve("PowerPointWebEditor.IApplicationSettings").KWb?a.register(Si,"PowerPointWebEditor.UndoRedo.FluidUndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma():a.register(Pf,"Box4.UndoRedo.Box4UndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma().na(()=>new Pf(b=>new zf(Sf.ObjectSpace.i2(b,a.resolve("PowerPointWebEditor.IApplicationSettings").KWb),
a.resolve("Box4.UndoRedo.IUndoRevisionValidator"),a.resolve("Box4.UndoRedo.IUndoSettingsManager"),new Zd,b,a.resolve("Box4.UndoRedo.IUndoRevisionMergeStrategy"),new Yl(a.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))));a.register(Ud,"PowerPointWebEditor.UndoRedo.PPTUndoStackFactory").as("Box4.UndoRedo.IUndoStackFactory").ma().na(()=>new Ud(a.resolve("Box4.UndoRedo.IUndoStackDataSyncHelperFactory")));a.register(tc,"PowerPointWebEditor.UndoRedo.PPTUndoActionBehavior").as("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior").ma().na(()=>
new tc(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.UndoEventSource"),a.resolve("Common.IActionManagerExtended")));a.register(Mh,"PowerPointWebEditor.UndoRedo.PPTUndoManager").as("Box4.UndoRedo.UndoManager").as("Box4.IUndoManager").as("PowerPointWebEditor.UndoRedo.IPPTUndoManager").as("Box4.StorageObjectSpace.IUndoRevisionLoadingState").ma().na(()=>new Mh(a.resolve("Box4.UndoRedo.IUndoStackFactory"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers")));a.register(1299,"PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor").ma().na(()=>new t);a.register(Ge,"PowerPointWebEditor.UndoRedo.UndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventNotifier").as("PowerPointWebEditor.UndoRedo.IUndoEventHandlers").ma();this.xqi(a);this.Bqi(a);a.register(1300,"PowerPointWebEditor.IGroupUngroupUndoRedoActionController").ma().na(()=>
new Ba(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper")))}xqi(a){a.register(1301,"PowerPointWebEditor.ITablePartialEditController").ma().na(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.pMj?new Fb(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),a.resolve("Box4.IWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),b.wub):new Ga})}Bqi(a){a.register(1302,"PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").ma().na(()=>new ch(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")))}init(){const a=this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager");
var b=this.K.resolve("Box4.IPageView");b.ug&&(b=b.ug.lo(),a.register(b),a.setActive(b),a.jVa(D.a.VQa,null))}dispose(){this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager").dispose();this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").dispose()}static main(){m.a.instance.Ec(new Dp)}}Object(e.a)(Dp,"PPTWebEditorUndoRedoPackage",null,[2,3]);class vn{constructor(a=!1,b,c=!1,f=!1,l=!1,w=!1,F=!1){this.zRa=a;this.j9d=c;this.a7a=f;this.g3b=l;this.k3b=w;this.NRc=F}}Object(e.a)(vn,
"DocModeSwitcherData",null,[]);var ep=d(828);class Ep{constructor(a,b,c,f,l){this.Oxb=!1;this.Nne=null;this.oud=this.Dvd=this.Oud=this.Yud=this.Rud=this.lvd=this.Hud=this.ovd=this.mya=this.yud=this.Eud=this.Vud=this.uud=this.Nud=this.M6e=!1;this.hc=a;this.ql=b;this.Oc=c;this.$u=l;this.GHg=f.SEj;this.hta=f.pptOnlineFallbackToReadOnlyAfterBootEnabled;this.d_c=f.ovg;this.I4j=u.AFrameworkApplication.wz;this.reset()}initialize(){this.Oc.Bga(Object(C.a)(this,this.Wz,"onUnifiedAppStateChanged"));this.Oc.JMa(Object(C.a)(this,
this.$cc,"onOutboundReplication"));this.Nne=[Object(C.a)(this,this.Iji,"checkIsInlineRepairedDocument"),Object(C.a)(this,this.Fji,"checkIrmProtection"),Object(C.a)(this,this.jki,"checkUserPermission"),Object(C.a)(this,this.iji,"checkFileFormats"),Object(C.a)(this,this.jji,"checkFileLock"),Object(C.a)(this,this.Qji,"checkPasswordProtection"),Object(C.a)(this,this.lji,"checkFontRestriction"),Object(C.a)(this,this.Jji,"checkIsMarkedFinal"),Object(C.a)(this,this.Kji,"checkIsMarkedReadOnlyRecommended"),
Object(C.a)(this,this.Vji,"checkSessionRestriction"),Object(C.a)(this,this.Uji,"checkSessionAccessTokenExpired"),Object(C.a)(this,this.Oji,"checkNetworkIssueHappened"),Object(C.a)(this,this.Rji,"checkPopsHostIssueHappened"),Object(C.a)(this,this.qki,"checkWopiAccessTokenOutOfRefreshRange"),Object(C.a)(this,this.Hji,"checkIsEmergencyViewMode")];this.Gfh(this.Nne)}dispose(){this.Oc.tEb(Object(C.a)(this,this.Wz,"onUnifiedAppStateChanged"))}reset(){this.oud=this.Eud=this.Dvd=this.Oud=this.Yud=this.Rud=
this.lvd=this.Hud=this.ovd=this.yud=this.Vud=this.mya=this.uud=this.Nud=this.M6e=!1}Wz(a,b){za.a.J(22930964,809,50,"ReadOnlyUIManager::OnUnifiedAppStateChanged");this.reset();b.X7a&&this.hc.An||(this.ql.nWf(),this.Gfh(this.Nne))}$cc(){this.hta&&!this.Oxb&&(this.Oxb=!0);this.hc.AK||za.a.J(38633602,801,15,"Outbound on RO mode")}Gfh(a){if(a)for(const b of a)if(b())break}iji(){if(this.KDj||!this.hc.eg(64)||this.GHg&&!(this.hc.eg(4)&&this.hc.eg(16)&&this.hc.eg(8)))return!0;if(!this.hc.getState(64))return!1;
if(this.GHg&&this.hc.getState(4)&&!this.hc.getState(16)&&!this.hc.getState(8)){var a=u.AFrameworkApplication.Va.Ma(aa.a.PAa,2,Object.assign(new vn,{NRc:!0,a7a:this.hc.getState(1)}));za.a.J(577524062,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatConvertible)"+a.toString());this.ql.OM(10);za.a.J(24142428,809,50,"ReadOnlyUIManager::CheckFileFormats - business bar displayed (FormatConvertible)")}else a=u.AFrameworkApplication.Va.Ma(aa.a.PAa,2,Object.assign(new vn,{k3b:!0,a7a:this.hc.getState(1)})),
za.a.J(578351494,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatNotEditable)"+a.toString());return this.uud=!0}Fji(){return this.RFj||!this.hc.eg(32768)?!0:this.hc.getState(32768)?(this.ql.OM(14),this.Hud=!0,za.a.J(24761164,809,50,"ReadOnlyUIManager::CheckIrmProtection - business bar displayed for FileIrmProtected"),!0):!1}jji(){return this.MDj?!0:this.hc.eg(128)&&this.hc.getState(128)?(this.ql.OM(3),this.mya=!0,za.a.J(24761166,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditCheckedOutByAnother"),
!0):this.hc.eg(256)&&this.hc.getState(256)?(this.ql.OM(4),this.mya=!0,za.a.J(24761168,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for RequiresCheckout"),!0):this.hc.eg(512)&&this.hc.getState(512)?(this.ql.OM(5),this.mya=!0,za.a.J(24761170,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for LockedForOfflineCheckout"),!0):this.hc.eg(1024)&&this.hc.getState(1024)?(this.ql.OM(6),this.mya=!0,za.a.J(24761172,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditLock"),
!0):this.hc.eg(2048)&&this.hc.getState(2048)?(this.ql.OM(7),this.mya=!0,za.a.J(24761174,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditSharedLock"),!0):this.hc.eg(4096)&&this.hc.getState(4096)?(this.ql.OM(8),this.mya=!0,za.a.J(24761176,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for NumberOfCoauthorsReachedMax"),!0):this.hc.eg(8192)&&this.hc.getState(8192)?(this.ql.OM(9),this.mya=!0,za.a.J(24761178,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditExistingExclusiveLock"),
!0):!1}Jji(){if(this.AGj||!this.hc.eg(2)||!this.hc.eg(16))return!0;if(!this.hc.getState(2)&&this.hc.getState(16)){const a=u.AFrameworkApplication.Va.Ma(aa.a.PAa,2,Object.assign(new vn,{zRa:!0,a7a:this.hc.getState(1)}));za.a.J(578351455,809,50,"ReadOnlyUIManager::CheckIsMarkedFinal - Callout display "+a.toString());return this.Nud=!0}return!1}Kji(){if(!this.d_c)return!1;if(this.BGj||!this.hc.eg(2)||!this.hc.eg(524288))return!0;if(!this.hc.getState(2)&&this.hc.getState(524288)){const a=u.AFrameworkApplication.Va.Ma(aa.a.PAa,
2,Object.assign(new vn,{j9d:!0,a7a:this.hc.getState(1)}));za.a.J(578351452,809,50,"ReadOnlyUIManager::CheckIsMarkedReadOnlyRecommended - Callout displayed "+a.toString());return this.Oud=!0}return!1}Qji(){if(this.mIj||!this.hc.eg(2)||!this.hc.eg(32))return!0;if(!this.hc.getState(2)&&this.hc.getState(32)){const a=u.AFrameworkApplication.Va.Ma(aa.a.PAa,2,Object.assign(new vn,{g3b:!0,a7a:this.hc.getState(1)}));za.a.J(578351449,809,50,"ReadOnlyUIManager::CheckPasswordProtection - Callout display "+a.toString());
return this.Vud=!0}return!1}Iji(){return this.wFj||!this.hc.eg(2097152)?!0:this.hc.getState(2097152)?(this.ql.OM(22),this.Eud=!0,za.a.J(42824021,809,50,"ReadOnlyUIManager:: - Inline repaired document business bar displayed"),!0):!1}Hji(){var a=!1;if(this.nDj||!this.hc.eg(4194304))return!0;this.hc.getState(4194304)&&(a="NotAvailable",this.$u&&(a=this.$u.Mrb(),a=ep.a[a]),Mf.Health.instance.recordQosError("EmergencyViewModeEnabledReason"+a,["ViewByDefault"],!0,!0,!1,!1,null),32===u.AFrameworkApplication.Va.processAction(aa.a.mlc,
1)?(a=u.AFrameworkApplication.Va.processAction(aa.a.mlc,2),za.a.J(578351445,809,15,"ReadOnlyUIManager:: EmergencyViewMode Emergency View Mode displayed in Doc Mode Switcher "+a.toString())):(this.ql.OM(23),za.a.J(593295554,809,15,"ReadOnlyUIManager:: EmergencyViewMode business bar displayed")),this.oud=a=!0);return a}lji(){return!this.iEj&&this.hc.eg(2)&&this.hc.eg(8)?!this.hc.getState(2)&&this.hc.getState(8)?(this.ql.OM(12),this.yud=!0,za.a.J(24142434,809,50,"ReadOnlyUIManager::CheckFontRestriction - business bar displayed"),
!0):!1:!0}jki(){if(this.YCj||!this.hc.eg(1))return!0;if(!this.hc.getState(1)){const a=u.AFrameworkApplication.Va.Ma(aa.a.PAa,2,new vn);za.a.J(578351441,809,50,"ReadOnlyUIManager::CheckUserPermission - Callout display "+a.toString());return!0}return!1}Vji(){return this.SKj?!0:this.hc.eg(16384)&&this.hc.getState(16384)?(this.ql.OM(13),this.ovd=!0,za.a.J(24761184,809,50,"ReadOnlyUIManager::CheckSessionRestriction - business bar displayed"),!0):!1}Uji(){return this.QKj?!0:this.hc.eg(65536)&&this.hc.getState(65536)?
(Mf.Health.instance.recordQosError("SessionAccessTokenExpired",["SessionExpired"],!1,!1,!0,!0,null),this.hta?this.ql.CGc(15,this.Oxb):this.ql.OM(15),this.lvd=!0,za.a.J(37066185,809,50,"ReadOnlyUIManager::CheckSessionAccessTokenExpired - business bar displayed"),!0):!1}Rji(){return this.NIj?!0:this.hc.eg(262144)&&this.hc.getState(262144)&&this.hta?(this.ql.CGc(17,this.Oxb),this.Yud=!0,za.a.J(37310543,809,50,"ReadOnlyUIManager::CheckPopsHostIssueHappened - business bar displayed"),!0):!1}qki(){return this.gOj?
!0:this.hc.eg(1048576)&&this.hc.getState(1048576)&&this.hta&&this.I4j?(this.ql.CGc(21,this.Oxb),this.Dvd=!0,za.a.J(39327011,809,50,"ReadOnlyUIManager::CheckWopiAccessTokenOutOfRefreshRange - business bar displayed"),!0):!1}Oji(){return this.WGj?!0:this.hc.eg(131072)&&this.hc.getState(131072)&&this.hta?(this.ql.CGc(16,this.Oxb),this.Rud=!0,za.a.J(37310545,809,50,"ReadOnlyUIManager::CheckNetworkIssueHappened - business bar displayed"),!0):!1}get YCj(){return this.M6e}get AGj(){return this.Nud}get KDj(){return this.uud}get mIj(){return this.Vud}get wFj(){return this.Eud}get iEj(){return this.yud}get MDj(){return this.mya}get SKj(){return this.ovd}get RFj(){return this.Hud}get QKj(){return this.lvd}get WGj(){return this.Rud}get NIj(){return this.Yud}get BGj(){return this.Oud}get gOj(){return this.Dvd}get nDj(){return this.oud}}
Object(e.a)(Ep,"ReadOnlyUIManager",null,[1303,109]);class fp{constructor(){this.y1c=this.K=null}get name(){return"PowerPointWebEditor.UnifiedApp"}Yb(a){this.K=a;this.K.register(1303,"PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager").ma().na(()=>new Ep(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Mia&&
(this.y1c=this.K.resolve("PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager"),this.y1c.initialize())}dispose(){this.y1c&&this.y1c.dispose()}static main(){m.a.instance.Ec(new fp)}}Object(e.a)(fp,"PPTWebEditorUnifiedAppPackage",null,[2,3]);var Ph=d(273);class gp{constructor(a,b,c,f){this.Pb=a;this.Lq=b;this.FD=c;this.kta=f}Tha(){const a=new Ie.a;a.$(0,Object(C.a)(this,this.tableBorderAndResizeHandlesClickHandler,"tableBorderAndResizeHandlesClickHandler"));a.$(1,Object(C.a)(this,this.pptTableColumnHandleClickHandler,
"pptTableColumnHandleClickHandler"));a.$(2,Object(C.a)(this,this.pptTableRowHandleClickHandler,"pptTableRowHandleClickHandler"));a.$(3,Object(C.a)(this,this.backgroundClickHandler,"backgroundClickHandler"));a.$(4,Object(C.a)(this,this.shapeClickHandler,"shapeClickHandler"));return a}tableBorderAndResizeHandlesClickHandler(a){return this.Lq.P2(a.Hc)||this.Lq.TRa(a.Hc)||this.Lq.KTc(a.Hc)?(this.Pb.sqb(),Ph.a.zl(!0)):Ph.a.notHandled}pptTableColumnHandleClickHandler(a){if(this.Lq.vsa(a.Hc)){const b=this.Lq.i1d(a.Hc);
if(!b||!b.pk)return za.a.J(22577752,822,15,"Clicked on a table column handle but failed to get a ShapeViewElement."),Ph.a.zl(!1);b.pk.jp||this.Lq.yDc(a.Hc,a.YT,a.Ri.Qf);return Ph.a.zl(!0)}return Ph.a.notHandled}pptTableRowHandleClickHandler(a){if(this.Lq.I4b(a.Hc)){const b=this.Lq.i1d(a.Hc);if(!b||!b.pk)return za.a.J(41209868,822,15,"Clicked on a table row handle but failed to get a ShapeViewElement."),Ph.a.zl(!1);b.pk.jp||this.Lq.sTk(a.Hc,a.YT,a.Ri.Qf);return Ph.a.zl(!0)}return Ph.a.notHandled}backgroundClickHandler(a){return this.Pb.x4b(a)?
(this.kta.setVisibility(!1),Ph.a.zl(!0)):Ph.a.notHandled}shapeClickHandler(a){let b=Ph.a.notHandled;this.FD.q4b||(b=this.FD.tJe(a));this.FD.q4b=!1;if((a=this.FD.Arb(a))&&!a.mN||a&&a.shapeNode&&a.shapeNode.rd&&a.mN)return Ph.a.zl(!0);this.kta.setVisibility(!1);return b}}Object(e.a)(gp,"ClickHandlers",null,[]);var wn=d(412),Jn=d(417);class Oo{constructor(a,b,c,f,l,w){this.Pb=a;this.sa=b;this.Ga=c;this.ia=f;this.FD=l;this.pne=w}Tha(){const a=new Ie.a;a.$(0,Object(C.a)(this,this.noContextMenuHandler,
"noContextMenuHandler"));a.$(1,Object(C.a)(this,this.slideBackgroundContextMenuHandler,"slideBackgroundContextMenuHandler"));a.$(2,Object(C.a)(this,this.shapeContextMenuHandler,"shapeContextMenuHandler"));return a}noContextMenuHandler(a){return this.Pb.Knh(a)?wn.a.notHandled:wn.a.zl(null)}slideBackgroundContextMenuHandler(a){return this.Pb.x4b(a)?(this.sa.gy(),this.sa.Rh(),this.Ga.Bd(),this.ia.Ma(aa.a.FNd,2,a.Ri),wn.a.zl(null)):wn.a.notHandled}shapeContextMenuHandler(a){var b=this.FD.Arb(a);if(this.h8k(b,
a))b.POa(),this.pne?b.wx||this.ia.Ma(aa.a.cNa,2,new Jn.a(b.shapeNode,!0,a.Ri)):this.ia.Ma(aa.a.cNa,2,new Jn.a(b.shapeNode,!0,a.Ri));else if(this.e8k(b))return this.sa.gy(),(b=this.FD.zaj(b,a))&&this.sa.selectShape(b,!0),this.Ga.Bd(),this.ia.Ma(aa.a.ENd,2,a.Ri),wn.a.zl(null);return wn.a.notHandled}h8k(a,b){return!!a&&!!a.shapeNode&&a.shapeNode.isConnected&&a.shapeNode.Swg&&!a.Ytb(b.Ri)}e8k(a){return!!a||this.sa.rG()||!this.sa.Pa.length}}Object(e.a)(Oo,"ContextMenuClickHandlers",null,[]);class Fp{constructor(a,
b,c,f,l){this.Pb=a;this.Lq=b;this.FD=c;this.ia=f;this.Vxb=l}Tha(){const a=new Ie.a;a.$(0,Object(C.a)(this,this.tableBorderAndHandlesDoubleClickHandler,"tableBorderAndHandlesDoubleClickHandler"));a.$(1,Object(C.a)(this,this.shapeDoubleClickHandler,"shapeDoubleClickHandler"));a.$(2,Object(C.a)(this,this.backgroundDoubleClickHandler,"backgroundDoubleClickHandler"));return a}tableBorderAndHandlesDoubleClickHandler(a){return this.Lq.P2(a.Hc)||this.Lq.TRa(a.Hc)||this.Lq.KTc(a.Hc)?(this.Pb.sqb(),Ph.a.zl(!0)):
this.Lq.vsa(a.Hc)||this.Lq.I4b(a.Hc)?(this.Pb.sqb(),Ph.a.zl(!1)):Ph.a.notHandled}shapeDoubleClickHandler(a){return this.FD.Arb(a)?(this.Pb.sqb(),Ph.a.zl(!1)):Ph.a.notHandled}backgroundDoubleClickHandler(a){return this.Pb.x4b(a)?(this.Pb.sqb(),this.Vxb||this.ia.processAction(aa.a.Ctb,2,{DoubleClickInsert:"true"}),Ph.a.zl(!0)):Ph.a.notHandled}}Object(e.a)(Fp,"DoubleClickHandlers",null,[]);class Po{constructor(a,b,c,f,l){this.FD=a;this.dC=b;this.ia=c;this.Fa=f;this.xN=l}aag(){return Object(C.a)(this,
this.f5c,"mouseUpHandlerFilter")}f5c(a){return a?(a=this.dC.$_d(a.Hc))&&a.gb&&this.Fa.$m(a.gb)&&this.xN.XRa&&this.FD.fKe?(this.ia.processAction(D.a.Lha,2),!0):this.FD.fKe=!1:!1}}Object(e.a)(Po,"MouseInputHandlers",null,[]);var Ml=d(274);class vo{constructor(a,b,c,f){this.FD=a;this.Rb=b;this.f_=c;this.Je=f}Tha(){const a=new Ie.a;a.$(0,Object(C.a)(this,this.backgroundPointerDownHandler,"backgroundPointerDownHandler"));a.$(1,Object(C.a)(this,this.shapePointerDownHandler,"shapePointerDownHandler"));a.$(2,
Object(C.a)(this,this.defaultPointerDownHandler,"defaultPointerDownHandler"));return a}backgroundPointerDownHandler(a){this.fol();return this.FD.OGf(a)}fol(){this.Je.Upg()||Kc.a.dIc("ScrollActiveThumbnailIntoView",aa.a.$Eb,()=>{this.Je.gGe();return 32})}shapePointerDownHandler(a){this.Rb.JV&&this.f_.show(3,-1);const b=this.FD.Arb(a);if(b&&b.shapeNode&&b.shapeNode.fg&&!b.shapeNode.xh)return Ph.a.zl(!1);if((Sys.UI.DomElement.containsCssClass(a.Hc,Ml.a.qwa)||Sys.UI.DomElement.containsCssClass(a.Hc,Ml.a.rGb)||
Sys.UI.DomElement.containsCssClass(a.Hc,Ml.a.zJe)||Sys.UI.DomElement.containsCssClass(a.Hc,Ml.a.fjd)||Sys.UI.DomElement.containsCssClass(a.Hc,Ml.a.Hth)||Sys.UI.DomElement.containsCssClass(a.Hc,Ml.a.Uth))&&b.isSelected&&!b.mN||void 0!==b&&null!==b&&b.shapeNode.hq)return this.FD.q4b=!1,Ph.a.zl(!0);this.FD.q4b=!0;a=this.FD.tJe(a);a.u2&&(this.FD.fKe=!0);return a}defaultPointerDownHandler(){return Ph.a.zl(!0)}}Object(e.a)(vo,"PointerDownHandlers",null,[]);class fi{constructor(a){this.FD=a}Tha(){const a=
new Ie.a;a.$(0,Object(C.a)(this,this.backgroundPointerUpHandler,"backgroundPointerUpHandler"));a.$(1,Object(C.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(1,Object(C.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(2,Object(C.a)(this,this.defaultPointerUpHandler,"defaultPointerUpHandler"));return a}backgroundPointerUpHandler(a){return this.FD.OGf(a)}shapePointerUpHandler(a){const b=this.FD.Arb(a);return b&&b.shapeNode&&b.shapeNode.fg&&!b.shapeNode.xh?Ph.a.zl(!1):
this.FD.tJe(a)}defaultPointerUpHandler(){return Ph.a.zl(!0)}}Object(e.a)(fi,"PointerUpHandlers",null,[]);class Zr extends Sys.EventArgs{constructor(){super()}}Object(e.a)(Zr,"SlideBackgroundClickedEventArgs",Sys.EventArgs,[]);class hp{constructor(a,b,c,f,l,w,F,S){this.Pb=a;this.Lq=b;this.sa=c;this.kta=f;this.Ga=l;this.V3=w;this.Qka=F;this.Fa=S;this.fKe=this.q4b=!1}OGf(a){return this.Pb.x4b(a)?(this.sa.gy(),a=a.Ri,this.V3.f9g(new Zr(!1)),(a.ctrlKey||a.shiftKey)&&a.Sz===Sys.UI.MouseButton.leftButton?
this.sa.fj():this.sa.Rh(),this.kta.setVisibility(!1),this.Ga.Bd(),Ph.a.zl(!0)):Ph.a.notHandled}tJe(a){const b=this.Arb(a);b&&this.sa.gy();const c=Sys.UI.DomElement.containsCssClass(a.Hc,Ml.a.qwa)||Sys.UI.DomElement.containsCssClass(a.Hc,Ml.a.rGb)||Sys.UI.DomElement.containsCssClass(a.Hc,Ml.a.zJe),f=this.Lq.KTc(a.Hc)||this.Lq.P2(a.Hc)||this.Lq.TRa(a.Hc);Kc.a.ik("isEventFromHandlers",c.toString());Kc.a.ik("isEventFromTableHandlers",f.toString());return c&&!f&&b&&b.mN?(this.sa.fj(),this.kta.setVisibility(!1),
this.Ga.Bd(),Ph.a.zl(!0)):f&&b&&!b.mN?(b.JVg(a.Ri),Ph.a.zl(!0)):!b||b.mN&&!this.f7d(a)?Ph.a.notHandled:(b.xlk(a.Ri),Ph.a.zl(!0))}Arb(a){let b=this.Lq.SH(a.Hc);if(!b){var c=a.Hc,f=Ea.a(c,Ka.a.role);f=f?f.toString()===re.a.lTb:!1;if(Sys.UI.DomElement.containsCssClass(c,"ListMarker")||f)for(;!b&&c;){b=this.Lq.SH(c);if(Sys.UI.DomElement.containsCssClass(c,"Outline")&&Sys.UI.DomElement.containsCssClass(c,"OutlineSized"))break;c=c.parentNode}}if(b){c=Object(ua.a)(133,b);if(!c&&(this.Lq.KTc(a.Hc)||this.Lq.P2(a.Hc)||
this.Lq.TRa(a.Hc))&&(c=this.Qka.$Zb(this.Fa.$m(b.gb)),!c))return za.a.J(39322434,822,15,"Clicked on a table resize handle but failed to get its ContainerShapeViewElement."),null;if(c||(c=this.Qka.$Zb(this.Fa.$m(b.gb)))&&c.EA&&!(c.wx||c.jp||c.dae))return c}return null}f7d(a){return a&&a.Hc?a.Hc.id.startsWith(nf.a.gAc):!1}zaj(a,b){return a?this.yaj(a):this.xaj(b.graphNode)}yaj(a){let b=null;a.isSelected&&this.sa.rG()||(b=Object(ua.a)(4,a.gb));return b}xaj(a){let b=null;if(a){const c=mb.GraphIterator.nb(a);
c.oc(10)?(a=Object(ua.a)(4,c.Og(10)),this.sa.PV(a)||(b=a)):za.a.J(22577757,808,15,"Unexpected type of graph node gets clicked, type: {0}, Id {1}",a.type,a.id)}return b}}Object(e.a)(hp,"ViewEventHandlerHelper",null,[1347]);class ui{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ViewEventHandler"}Yb(a){this.K=a;a.register(gp,"PowerPointWebEditor.ViewEventHandler.ClickHandlers").ma().na(()=>new gp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),
a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IGrippersManager")));a.register(Fp,"PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").ma().na(()=>new Fp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Common.IActionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").Etb));a.register(Oo,"PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").ma().na(()=>
new Oo(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptContextMenuCrashFix));a.register(vo,"PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").ma().na(()=>new vo(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),
a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView")));a.register(fi,"PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").ma().na(()=>new fi(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout")));a.register(Po,"PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").ma().na(()=>new Po(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),
a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext")));a.register(hp,"PowerPointWebEditor.ViewEventHandler.ViewEventHandlerHelper").as("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper").ma().na(()=>new hp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("Box4.IGrippersManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.View.IShapeViewHelper"),a.resolve("PowerPointWebEditor.IShapeReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");a.bYh(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ClickHandlers").Tha());a.OYh(this.K.resolve("PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").Tha());a.DYh(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").Tha());
a.o_h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").Tha());a.r_h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").Tha());this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&this.K.resolve("Common.MouseInputManager").pb(ra.a.OW,a.container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").aag())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&
this.K.resolve("Common.MouseInputManager").zb(ra.a.OW,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").aag())}static main(){m.a.instance.Ec(new ui)}}Object(e.a)(ui,"PPTWebEditorViewEventHandlerPackage",null,[2,3]);var Jf=d(82),Zl;(function(a){a[a.notLoaded=1]="notLoaded";a[a.loaded=2]="loaded";a[a.failed=3]="failed"})(Zl||(Zl={}));Object(e.b)("WebSocketCompressionHelperLoadState",Zl);var pk=d(88),$r=d(333),
Gp;(function(a){a[a.connecting=0]="connecting";a[a.open=1]="open";a[a.closing=2]="closing";a[a.closed=3]="closed"})(Gp||(Gp={}));Object(e.b)("WebSocketState",Gp);class hr{constructor(a,b,c,f,l){this.Q9b=this.ul=this.uAb=null;this.tFa=-1;this.aab=this.Eja=0;this.B6b=-1;this.jyb=0;this.kyb=null;this.TSa=0;if(!a)throw Error.argumentNull("webSocketClient");this.jv=a;this.Za=b;this.PG=c;this.Oc=f;a=document.createElement("a");a.href=this.jv.Oxl;a.protocol="http:"===a.protocol?"ws":"wss";qd.a("PodsWebSocketFrontDoor.UseQueryString")?
(a=new Wm.QueryStringBuilder(a.href),qd.a("PodsWebSocketFrontDoor.UseWacClusterQueryString")&&a.nj(dg.a.d2g,b.qk),qd.a("PodsWebSocketFrontDoor.UseUsidQueryString")&&a.nj(dg.a.eqk,u.AFrameworkApplication.userSessionId),a.nj(dg.a.fec,l.toString()),this.uAb=a.toString()):this.uAb=a.href;this.eab=Jf.a.NE(this.uAb);this.sVb(2);this.Kka=this.jv.Neh;this.eee=this.jv.Emi;this.pJe();this.Oc.F2a(Object(C.a)(this,this.Qcb,"onSessionEnding"));this.Oc.xB(Object(C.a)(this,this.eo,"onSessionRehydrated"))}dispose(){this.Oc.DDe(Object(C.a)(this,
this.Qcb,"onSessionEnding"));this.Oc.cea(Object(C.a)(this,this.eo,"onSessionRehydrated"))}sVb(a){this.ul&&this.ul.close();this.ul=new WebSocket(this.uAb,[]);this.ul.onopen=Object(C.a)(this,this.onOpen,"onOpen");this.ul.onerror=Object(C.a)(this,this.onError,"onError");this.ul.onclose=Object(C.a)(this,this.onClose,"onClose");this.ul.onmessage=Object(C.a)(this,this.onMessage,"onMessage");this.TSa=a;za.a.J(556541794,this.jv.YP,50,"WebSocketFetcher::ConnectWebSocket - WebSocket connected WebSocketDomain:{0}, WacCluster:{1}, ConnectionReason:{2}",
this.eab,this.Za.qk,this.TSa)}ping(){if(this.ul)if(1===this.ul.readyState){const a=this.jv.Qxi();this.ul.send(a)}else za.a.J(559284698,this.jv.YP,10,"WebSocketFetcher::Ping. Wrong WebSocket state {0}",this.ul.readyState),this.Tva(4);else za.a.J(559284697,this.jv.YP,50,"WebSocketFetcher::Ping Websocket is unavailable.")}Lmi(){this.ul.close()}onOpen(){za.a.J(591208995,this.jv.YP,50,"WebSocketFetcher::OnOpen WebSocketDomain:{0}, WacCluster:{1}",this.eab,this.Za.qk);this.aic();this.jyb=0;this.kyb=null;
this.jv.ggk()}onError(a){za.a.J(591208993,this.jv.YP,10,"WebSocketFetcher::OnError {0}, WebSocketDomain:{1}, WacCluster:{2}",JSON.stringify(a),this.eab,this.Za.qk)}onClose(a){za.a.J(591208991,this.jv.YP,50,"WebSocketFetcher::OnClose WebSocketDomain:{0}, WacCluster:{1}, EventInfo:{2}, CloseEventCode:{3}, CloseEventReason:{4}",this.eab,this.Za.qk,JSON.stringify(a),a.code,a.reason);this.jyb=a.code;this.kyb=a.reason}onMessage(a){try{a&&a.data&&this.jv.bjk(a)}catch(b){za.a.J(559284699,this.jv.YP,10,"WebSocketFetcher::OnMessage",
b.toString())}}pJe(){this.Q9b=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.B6b),this.ul||(za.a.J(559284700,this.jv.YP,50,"WebSocketFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Tva(1))):this.B6b=window.setTimeout(()=>{this.ul&&(za.a.J(559284701,this.jv.YP,50,"WebSocketFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.jyb=1E3,this.kyb="Lost visibility",this.ul.close(this.jyb,this.kyb),this.ul=null,window.clearTimeout(this.tFa))},
this.eee)};window.self.addEventListener("visibilitychange",this.Q9b)}aic(){this.Eja=0}cHd(){0<this.jv.T4c&&(new Date).getTime()-this.aab>this.jv.T4c&&(this.aic(),za.a.J(559284702,this.jv.YP,50,"WebSocketFetcher::Retry connect to server after long pause."))}UKd(){const a=!!this.PG&&!!this.PG.instance&&!this.PG.instance.I7,b=(new Date).getTime()-this.aab>this.Kka,c=this.Eja<this.jv.jRg,f=!this.ul||3===this.ul.readyState||2===this.ul.readyState,l=a&&b&&c&&f;za.a.J(557181E3,this.jv.YP,50,"WebSocketFetcher::CanRetry: canRetry:{0}, isPodsSessionAlive:{1}, retryTimeReached:{2}, retryAttemptsAvailable:{3}, noWebSocket:{4}",
l,a,b,c,f);return l}uIe(){this.aab=(new Date).getTime();this.Kka=Math.pow(2,this.Eja)*this.jv.Neh;0<this.jv.T4c&&(this.Kka=Math.min(this.Kka,this.jv.T4c));window.setTimeout(()=>{this.Tva(3)},this.Kka)}Tva(a){this.cHd();this.UKd()&&(this.sVb(a),this.uIe(),this.Eja++,a!==this.TSa&&za.a.J(541671620,this.jv.YP,10,"WebSocketFetcher::ReconnectionReasonMismatch ReconnectionReason:{0}, m_reconnectionReason{1}",a,this.TSa),za.a.J(559284703,this.jv.YP,50,"WebSocketFetcher::Retry connect to server. ReconnectionReason:{0}",
this.TSa),this.Eja===this.jv.jRg&&za.a.J(559284704,this.jv.YP,50,"WebSocketFetcher::Max retries reached. ReconnectionReason:{0}",this.TSa))}sendMessage(a,b){if(!this.ul)return za.a.J(559284705,this.jv.YP,50,"WebSocketFetcher::SendMessage Websocket is unavailable. RequestType:{0}, LastCloseCode:{1}, LastCloseReason:{2}",b,this.jyb,this.kyb),1;za.a.J(559284706,this.jv.YP,50,"WebSocketFetcher::SendMessage. WebSocket state {0}, RequestType:{1}, LastCloseCode:{2}, LastCloseReason:{3}",Gp[this.ul.readyState],
b,this.jyb,this.kyb);if(1===this.ul.readyState)return this.ul.send(a),0;this.Tva(5);return 2}i4k(){this.ul.binaryType="arraybuffer"}XBb(){-1!==this.tFa&&window.clearTimeout(this.tFa);this.tFa=window.setTimeout(()=>{this.ping()},this.jv.Lsk)}eli(){this.TSa=0}Qcb(){this.ul&&(za.a.J(557352418,this.jv.YP,50,"WebSocketFetcher::OnSessionEnding: closing due to session ending."),this.ul.close(),this.ul=null)}eo(){this.ul||(za.a.J(557352419,this.jv.YP,50,"WebSocketFetcher::OnSessionRehydrated: reconnecting after session rehydrated."),
this.Tva(6))}}Object(e.a)(hr,"WebSocketFetcher",null,[1383,109]);var $p;(function(a){a[a.none=0]="none";a[a.visibilityRegainedReconnection=1]="visibilityRegainedReconnection";a[a.initialConnection=2]="initialConnection";a[a.timeoutReconnection=3]="timeoutReconnection";a[a.webSocketNotOpenOnPingReconnection=4]="webSocketNotOpenOnPingReconnection";a[a.webSocketNotOpenedReconnection=5]="webSocketNotOpenedReconnection";a[a.sessionRehydrationReconnection=6]="sessionRehydrationReconnection"})($p||($p={}));
Object(e.b)("ConnectionReason",$p);var bo;(function(a){a[a.success=0]="success";a[a.nullWebSocket=1]="nullWebSocket";a[a.webSocketNotOpened=2]="webSocketNotOpened"})(bo||(bo={}));Object(e.b)("SendMessageStatusCode",bo);class as extends Sys.EventArgs{constructor(a,b,c){super();this.response=a;this.$Rk=b;this.PBj=c}}Object(e.a)(as,"WebSocketFrontDoorEventArgs",Sys.EventArgs,[]);var Lk=d(638);class bs{constructor(a,b,c,f,l){this.tm=window.performance.now();this.ioe=new sd.a;this.Mge=this.E7b=!0;this.Aca=
null;this.CAb=1;this.Za=b;this.f0c=a.Mxl;this.fne=a.Nxl;this.K2j=a.Kxl;this.c5j=a.Lxl;this.IXj=a.Ixl;this.lzb=a.Gmd;this.O7j=a.avl;this.Lqe=a.Jxl;this.eab=Jf.a.NE(this.Lqe);this.Fua=new hr(this,b,c,f,new $r.a(a.Rda));this.DEg=a.ODc;if(l)this.Aca=l;else throw Error.argumentNull("dynamicScriptLoader");}dispose(){this.Fua.dispose()}ping(){this.Fua.ping()}dw(a){const b=new Map,c=this.tfj(a);a.smartArtEditOpRequest&&(b.set("requestType",c),b.set("correlationId",a.smartArtEditOpRequest.commonData?a.smartArtEditOpRequest.commonData.correlationId:
null),Mf.Health.instance.recordKpiUsage("DeltaEdit",1,"gc2smartart",b));this.lzb?(a=this.Fua.sendMessage(JSON.stringify(a),c),0!==a&&(b.set("SendMessageStatusCode",bo[a]),Mf.Health.instance.recordKpiFailure("DeltaEdit","SendRequestFailure",!1,!0,Object.assign(new pk.a,{extendedProperties:b})))):Mf.Health.instance.recordKpiFailure("DeltaEdit","WebSocketProtobufBRSDisabled",!0,!0,Object.assign(new pk.a,{extendedProperties:b}))}Q3h(a){this.ioe.addHandler("ResponseReceivedEventId",a)}WNk(a){this.ioe.removeHandler("ResponseReceivedEventId",
a)}ggk(){if(this.lzb){var a=Kc.a.Db?Kc.a.Db.actionId:xg.a.create().toString(),b=u.AFrameworkApplication.userSessionId,c=this.Za.qk;this.Mge=!0;b=Lk.p(a,b,this.Za.podSessionId,c);b=this.Fua.sendMessage(JSON.stringify(b),"validateSession");za.a.J(557175649,839,0===b?50:10,"PodsFrontDoorWebSocket::OnConnectionOpened ValidateSessionRequest correlationId:{0}, SendMessageStatusCode:{1}, WebSocketDomain:{2}, WacCluster:{3}",a,bo[b],this.eab,c)}}bjk(a){if(this.lzb)try{const b=this.FMi(a);if(b.pong)this.XBb(b.pong.pingTimestamp);
else if(b.validateSessionResponse)this.dnk(b.validateSessionResponse);else if(b.compressionHandshakeResponse)this.cgk(b.compressionHandshakeResponse);else{const c=Object.getType(a.data)!==String;this.ioe.raiseEvent("ResponseReceivedEventId",new as(b,this.q9i(a,c),c))}}catch(b){za.a.J(541618382,839,10,"PodsFrontDoorWebSocket Failed to parse WebSocketFrontDoorServiceResponse")}else this.XBb(a.data)}FMi(a){let b=Object.getType(a.data)===String?a.data:null;if(b)return JSON.parse(b);if(2===this.CAb)return a=
new Uint8Array(a.data),b=WebSocketCompressionHelper.WebSocketCompressionHelper.decompressTextWithDeflateRaw(a),JSON.parse(b);za.a.J(541349337,839,10,"PodsFrontDoorWebSocket: ExtractMessageReceive could not decompress data because WebSocketCompressionHelper is not loaded");return JSON.parse("")}q9i(a,b){return b?(new Uint8Array(a.data)).byteLength:a.data.length}dnk(a){if(a.isValid){if(this.DEg){a=Kc.a.Db?Kc.a.Db.actionId:xg.a.create().toString();const b=u.AFrameworkApplication.userSessionId,c=this.Za.podSessionId,
f=this.Za.qk;za.a.J(541161497,839,50,"PodsWebSocketFrontDoor::OnValidateSessionResponse - WebSocketCompressionHelperLoadState:{0}",Zl[this.CAb]);1===this.CAb?this.mSj(a,b,c,f):2===this.CAb&&this.Whh(a,b,c,f)}this.ping()}else za.a.J(556541795,839,10,"PodsWebSocketFrontDoor::OnMessageReceived - Closing WebSocket because session not valid. WebSocketDomain:{0}, WacCluster:{1}",this.eab,this.Za.qk),this.Fua.Lmi()}mSj(a,b,c,f){this.DEg&&this.Aca.loadScript("WebSocketCompressionHelper").then(()=>{this.CAb=
2;this.Whh(a,b,c,f)}).catch(()=>{za.a.J(541710233,839,10,"PodsFrontDoorWebSocket WebSocketCompressionHelper failed to load");this.CAb=3})}Whh(a,b,c,f){a=Lk.a(a,b,c,!0,f);a=this.Fua.sendMessage(JSON.stringify(a),"compressionHandshake");za.a.J(541710232,839,50,"PodsFrontDoorWebSocket WebSocketCompressionHelper loaded and sent compression handshake with status code {0}",a)}cgk(a){a=a.clientReadyForCompression;za.a.J(541710234,839,50,"PodsFrontDoorWebSocket WebSocket compression handshake received with value {0}",
a);a&&this.Fua.i4k()}tfj(a){return a.ping?"ping":a.validateSessionRequest?"validateSession":a.compressionHandshakeRequest?"compressionHandshake":a.smartArtEditOpRequest&&a.smartArtEditOpRequest.editOps&&a.smartArtEditOpRequest.editOps[0].resizeEditOp?"resizeEditOp":"unknown"}XBb(a){this.Fua.XBb(a);Ja.a.Xa(a)?za.a.J(561639837,839,10,"PodsFrontDoorWebSocket::OnPingReply Invalid pingTimestampStr"):(a=parseFloat(a),isNaN(a)?za.a.J(591208987,839,10,"PodsFrontDoorPing::OnMessage Ping response not a number. m_protobufEnabled:{0}",
this.lzb):(a={["PingTime"]:window.performance.now()-this.tm-a,MeasurementType:"Performance.Now"},a.First=this.E7b?1:0,a.WebSocketFrontDoorProtobufEnabled=this.lzb,a.PostConnectionPing=this.Mge,a.ConnectionReason=$p[this.Fua.TSa],this.Fua.eli(),this.Mge=this.E7b=!1,za.a.J(591208985,839,50,va.a.toJSON(a))))}Qxi(){var a=(window.performance.now()-this.tm).toString();if(!this.lzb)return a;a=Lk.q(Lk.l(a),null,null,null,this.Za.qk);return JSON.stringify(a)}get Oxl(){return this.O7j&&!Ja.a.Xa(this.Lqe)?this.Lqe:
u.AFrameworkApplication.fa.appSettings.WebServiceBase+"WebSocketFrontDoorServiceHandler.ashx"}get YP(){return 839}get Lsk(){return this.fne}get jRg(){return this.f0c}get Neh(){return this.c5j}get T4c(){return this.K2j}get Emi(){return this.IXj}}Object(e.a)(bs,"PodsWebSocketFrontDoor",null,[1298,109,1343]);class ir{constructor(){this.K=null}get name(){return"PowerPointWebEditor.WebSocketFrontDoor"}Yb(a){if(!a)throw Error.create("PPTWebEditorWebSocketFrontDoorPackage : container is null");this.K=a;
a.register(1298,"PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").ma().na(()=>{try{return new bs(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.Oa("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("Common.IDynamicScriptLoaderProvider").gx)}catch(b){return za.a.J(591208983,839,10,"exception creating PodsWebSocketFrontDoor: "+b),null}})}init(){}dispose(){this.K.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").dispose()}static main(){m.a.instance.Ec(new ir)}}
Object(e.a)(ir,"PPTWebEditorWebSocketFrontDoorPackage",null,[2,3]);var Qo=d(1102),Ro=d(1111);class jr{constructor(a=null){this.Pn=null;this.reset();this.hQb=a}JSb(a,b){if(!this.hQb||this.hQb.UJe())b in this.Pn||(this.Pn[b]=[]),this.Pn[b].push(a)}getData(){return va.a.count(this.Pn)?this.Pn:null}reset(){this.Pn={}}}Object(e.a)(jr,"NamedValuesAggregator",null,[1496]);class kr{constructor(){this.Pn=new Ua.a}get ZFk(){return this.Pn.count}JSb(a){this.Pn.add(a)}getData(){return this.ZFk?Ya.toArray(this.Pn):
null}reset(){this.Pn=new Ua.a}}Object(e.a)(kr,"BatchDataAggregator",null,[1496]);var Hp;(function(a){a[a.LanguageInfo=0]="LanguageInfo";a[a.FeedbackLoop=1]="FeedbackLoop";a[a.Config=2]="Config"})(Hp||(Hp={}));Object(e.b)("ApiType",Hp);class Ip{constructor(a,b){this.Di=a;this.Czd=b}dw(a,b,c){if(c){a=Hp[a];var f={"Content-Type":"application/json; charset=utf-8"};f["X-StatelessPopsAffinityRoutingEnabled"]=u.AFrameworkApplication.fa.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Di.Jj(this.Czd()+
"&apitype="+a,2,b,f,!1,3,Object(C.a)(this,this.EHa,"requestSucceeded"),Object(C.a)(this,this.CHa,"requestFailed"),c,void 0,void 0,void 0,void 0,"28")}}EHa(a){if(!u.AFrameworkApplication.Xg&&a&&a.data){var b=a.data.state;b&&b.xOc(b,a.data.je)}}CHa(a){!u.AFrameworkApplication.Xg&&a&&a.data&&(a=a.data.state)&&a.iOc(a)}}Object(e.a)(Ip,"EditorServiceRequestManager",null,[1441]);class Kn extends Sys.EventArgs{constructor(a){super();this.nodeId=a}}Object(e.a)(Kn,"ErrorRangesChangedEventArgs",Sys.EventArgs,
[]);var ll=d(271);class wo{constructor(a,b,c){this.begin=a;this.end=b;this.Gh=c}}Object(e.a)(wo,"ErrorRange",null,[294]);class Gq{constructor(a,b){this.nn=a;this.HJh=b}get xe(){return this.nn}get Gh(){return this.HJh}Vd(a){return new Gq(a||this.nn,this.Gh)}}Object(e.a)(Gq,"SpellingErrorObject",null,[149]);class ip{constructor(a,b,c){this.Ta=new sd.a;this.Tq=a;this.jTh=b;this.bNh=c}gAf(a,b){b=this.Cqh(a,b);if(!Ma.a.Xa(b)){for(var c=this.ME(a),f=[],l=0,w=0;l<b.length&&w<c.length;){const F=c[w],S=b[l];
S.end<=F.begin?++l:(F.end>S.begin&&Array.add(f,F),++w)}c=a.uYa();try{const F=a.pha();try{this.Iah(a,f),this.hAf(a,b)}finally{F&&F.dispose()}}finally{c&&c.dispose()}this.T5c(a)}}vHa(a,b,c=!1){if(!Ma.a.Xa(b)){c=c?null:a.uYa();try{const f=a.pha();try{this.Iah(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}this.T5c(a)}}tPk(a,b){const c=a.uYa();try{const f=a.pha();try{this.TLd(a),b=this.Cqh(a,b),Ma.a.Xa(b)||this.hAf(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}}TLd(a){const b=a.uYa();try{const c=
a.pha();try{const f=a.Ra;for(a=0;a<f.length;a++){const l=f.ga(a);l.yp&&(l.yp=null);l.GK=!1}}finally{c&&c.dispose()}}finally{b&&b.dispose()}}ME(a,b=null){const c=[];let f=0,l=null;var w=!1;a=a.Ra;for(let F=0;F<a.length;F++){const S=a.ga(F);if(S.GK){const fa=S.cp;l?(w=new wo(f,fa,l),b&&!b(w)||Array.add(c,w)):w?Z.ULS.sendTraceTag(41300895,324,10,"Encountered CHP SpellingError without ErrorDetails set"):Z.ULS.sendTraceTag(41300896,324,10,"Encountered SpellingErrorEnd without the begin: Begin CP {0}, End CP {1}",
f,fa);w=!1}S.yp&&(w=!0,f=S.cp,l=S.yp.Gh)}return c}IPa(a){if(!a||!Cb.SelectionEditor.Oj(a)&&!Cb.SelectionEditor.Mg(a))return null;const b=a.node;let c=a.Qa,f=a.Lb;a=Cb.SelectionEditor.Mg(a);const l=this.Tq.text(b);for(const w of this.ME(b))if(a){if(w.begin<=c&&w.end>=f)return w}else if(w.begin<=c&&w.end>=c&&Ja.a.Cri(l,w.end,f))return w;return null}Ric(a){if(!this.bNh||!a||!(a.Paa||2===a.length&&Cb.SelectionEditor.Bl(a.We)))return!1;a=this.IPa(a.Wa);if(!a)return!1;if(a=Object(ua.a)(266,a.Gh))if(a.GCh=
!0,a.O8d())return!1;return!a||5!==a.proofingType}Cqh(a,b){if(Ma.a.Xa(b))return b;b=Array.clone(b);for(var c=b.length-1;0<=c;c--){var f=b[c];f&&f.Gh||(Z.ULS.sendTraceTag(41300897,324,15,"Received malformed ErrorRange: {0}. Filtering it out.",f?"Null error details":"Null range"),Array.removeAt(b,c))}if(!b.length)return b;ll.d(b);c=[];this.jTh&&Array.addRange(c,this.Tq.KPa(a));c=ll.a(c);for(f=a=0;f<b.length&&a<c.length;){let l=b[f];const w=c[a];l.begin<w.end&&w.begin<l.end?Array.removeAt(b,f):l.end<
w.end?f++:a++}return b}hAf(a,b){let c=!1;for(const f of b){b=f.Gh;c=1===b.proofingType||c;let l=a.qqb(f.begin);l.yp=new Gq(l,b);l.isFromErrorRangeSplit=!0;l=a.qqb(f.end);l.GK=!0;l.isFromErrorRangeSplit=!0}c&&(a.aub=!1)}Iah(a,b){if(!Ma.a.Xa(b)){a=a.Ra;for(const c of b){b=a.fS(c.begin);const f=a.fS(c.end);b&&b.yp&&f&&f.GK?(b.yp=null,f.GK=!1):(b=String.format("Could not find and remove ErrorRange from CHPs. Cp Begin: {0}, Cp End: {1}",c.begin,c.end),Z.ULS.sendTraceTag(37532355,324,10,b))}}}y2h(a){this.Ta.addHandler("OnErrorRangesChanged",
a)}T5c(a){if(this.Ta.x1b){const b=this.ME(a);this.Ta.raiseEvent("OnErrorRangesChanged",new Kn(a.id.toString(),b))}}}Object(e.a)(ip,"ErrorRangeEditor",null,[1440]);var an=d(209);class lr{constructor(){this.D4e=new an.a}contains(a,b){return a?this.D4e.contains(Ja.a.jvh(a,b)):!1}add(a,b){a&&this.D4e.add(Ja.a.jvh(a,b))}}Object(e.a)(lr,"IgnoreAllKeywords",null,[1293]);var qk=d(210);class bn extends qk.a{constructor(a,b,c){super(b,c);this.RF=a;this.$Ga=this.G9=-1;this.vLd=0;this.textUnit=2}get lcid(){return this.RF}}
Object(e.a)(bn,"ModifiedRange",qk.a,[]);class Be{constructor(a,b,c,f){this.VWh=a;this.KJ=b;this.oM=c;this.Ypf=f}get S$c(){return this.Ypf?this.Ypf.instance:null}BHf(a,b){const c=[];if(Ma.a.Xa(a)||Ma.a.Xa(b))return c;if(1===b.length){b=b[0].lcid;for(var f of a)Array.add(c,new bn(b,f.begin,f.end))}else{a=Array.clone(a);a.reverse();f=0;do{var l=b[f];let w=l.lcid;for(l=l.end;0<a.length&&l>a[a.length-1].begin;){const F=a.pop(),S=F.end,fa=Math.min(S,l);S>l&&a.push(new qk.a(l,S));Array.add(c,new bn(w,F.begin,
fa))}f++}while(0<a.length&&f<b.length);Z.ULS.shipAssertTag(37836432,324,!a.length,"Did not process all modified ranges in the stack")}return c}YLi(a,b,c,f){let l,w;({Are:l,ire:w}=Be.z2f(a,c,b));c=0;let F=a.begin,S=a.end;const fa=this.S$c;let xa=!1;fa?(c=fa.findEndBoundary(b,S-1,w),f||-1!==c||this.Iig(b,a)?c=-1===c?w:c:xa=!0):xa=!0;if(xa)return this.C8f(a,b,this.oM.DUg,l,w);if(!l)for(;" "===b.charAt(l)&&l<b.length;)l++;a=Math.max(fa.findBeginBoundary(b,F,l),l);return qk.a.createTextRange(a,c)}XLi(a,
b,c){return this.Y_f(a,b,c,this.oM.DUg)}WLi(a,b){if(!a||Ma.a.Xa(b))return a;let c=a.begin,f=a.end,l=!1;for(const w of b){if(a.end<=w.begin)break;a.begin>w.begin&&a.begin<w.end&&(c=w.begin,l=!0);a.end>w.begin&&a.end<w.end&&(f=w.end,l=!0)}return l?qk.a.createTextRange(c,f):a}t7k(a,b){if(!a||!b)return!1;const c=a.begin;a=a.end;return!Ja.a.Gub(b.substring(c,a))&&!Ja.a.Bri(b,c,a)}uXi(a,b,c){if(!a||!c||Ma.a.Xa(b))return 0;a=ll.c([a],b);b=0;for(const f of a)b+=this.VWh.Seg(c,f.begin,f.end);return b}VYh(a,
b,c,f){if(a&&b){var l=a.begin,w=a.end,F=this.oM.Odk;if(0>=F)a.G9=l,a.$Ga=w;else if(F=this.Y_f(a,b,f,F)){b=a.lcid;f=F.begin;F=F.end;if(0>f||this.jnh(f,l,b,c))f=l;this.jnh(w,F,b,c)&&(F=w);a.G9=f;a.$Ga=F}else a.G9=l,a.$Ga=w}}Iig(a,b){return this.S$c?-1!==this.S$c.findEndBoundary(a,b.begin,b.end):!1}jnh(a,b,c,f){if(a>=b)return!0;if(1>=f.length)return!1;a=this.BHf([new qk.a(a,b)],f);return 1!==a.length||a[0].lcid!==c}Y_f(a,b,c,f){if(!a||!b||0>f)return null;let l;({Are:c,ire:l}=Be.z2f(a,c,b));return this.C8f(a,
b,f,c,l)}C8f(a,b,c,f,l){return qk.a.createTextRange(this.KJ.UPi(b,c,a.begin,f),this.KJ.BPi(b,c,a.end,l))}static z2f(a,b,c){let f;f=0;c=c.length;if(Ma.a.Xa(b))return{Are:f,ire:c};let l=a.begin;a=a.end;let w=!1,F=!1;for(const S of b)if(!w&&S.end<=l?f=S.end:w=!0,!F&&S.begin>=a&&(c=S.begin,F=!0),w&&F)break;return{Are:f,ire:c}}}Object(e.a)(Be,"ModifiedExpandRangeHelper",null,[1439]);var $l=d(334);class Hq{constructor(a,b){this.Vtd=null;this.rg=a;this.KJ=b;this.VF=db.ParagraphReader.text(this.rg);this.Rpf=
[]}Wej(a,b){return this.FNc(this.KJ.VYb(this.VF,a,b))}FNc(a){return a?this.H1d(a.begin,a.end):null}H1d(a,b){this.Vtd=this.Vtd||this.KJ.gLc(this.rg);return this.KJ.FNc(a,b,this.VF,this.Vtd)}jCa(a,b){(a=this.H1d(a,b))&&Array.add(this.Rpf,a)}J_b(){return Array.clone(this.Rpf)}}Object(e.a)(Hq,"ValidatedRangeContainer",null,[]);class Jp{constructor(a,b,c,f,l,w){this.im=a;this.KJ=b;this.Rc=c;this.oM=f;this.HTh=l;this.qRh=w}Erb(a){return new Hq(a,this.KJ)}X5h(a){const b=a.WQd.currentNode;var c=a.Hqh.currentNode;
const f=a.Y0g;a=this.mra(b);const l=this.Erb(b);c=this.mra(c);for(var w of c)l.jCa(f+w.begin,f+w.end);Array.addRange(a,l.J_b());if(w=l.Wej(f,f))Array.add(a,w),this.bDe(b,w,0);b.w_=a}Y5h(a,b,c){var f=a.w_;if(Ma.a.Xa(f)||f[f.length-1].end<=c)this.VCc(b);else{var l=[],w=this.Erb(a),F=this.Erb(b);for(const S of f)if(f=S.end,f>c){const fa=S.begin;fa<c?(w.jCa(fa,c),F.jCa(0,f-c)):F.jCa(fa-c,f-c)}else Array.add(l,S);c=w.J_b();Array.addRange(c,l);a.w_=c;b.w_=F.J_b();a.kjc();b.kjc()}}q1k(a){db.ParagraphReader.Pd(a)&&
!this.KJ.hRa(a)&&(this.im.TLd(a),this.YDe(a,[new qk.a(0,db.ParagraphReader.textLength(a))]))}ykh(a,b){b&&a&&db.ParagraphReader.Pd(a)&&!this.KJ.hRa(a)&&!a.BB&&this.MRg(a,this.Erb(a).FNc(b),D.a.typing)}Alh(a,b,c){a&&this.ykh(a,this.KJ.VYb(db.ParagraphReader.text(a),b,c))}YDe(a,b){if(db.ParagraphReader.Pd(a))if(Ma.a.Xa(b))this.VCc(a);else{const c=this.Erb(a);for(const f of b)c.jCa(f.begin,f.end);a.w_=c.J_b()}}VCc(a){db.ParagraphReader.Pd(a)&&(a.w_=null)}Tfd(a,b,c=null){if(db.ParagraphReader.Pd(a)&&!a.BB&&
!Ma.a.Xa(b)){ll.d(b);var f=null;if(this.oM.Stb||this.oM.dRa)f=S=>1===S.Gh.proofingType;f=this.im.ME(a,f);for(var l=[],w=0,F=0;F<f.length&&w<b.length;){const S=b[w],fa=f[F];S.end<=fa.begin?w++:(fa.end<=S.begin||fa.begin>=S.begin&&fa.end<=S.end&&(0!==fa.Gh.errorType||fa.begin!==S.begin)&&Array.add(l,fa),F++)}this.im.vHa(a,l);f=this.mra(a);b=ll.b(f,b);c&&(c=ll.c(f,[c]),0<c.length&&(b=ll.e(b,c)));this.YDe(a,b)}}mra(a){return db.ParagraphReader.Pd(a)?a.w_||[]:[]}b8h(a,b,c,f,l=0){const w=a.node;if(db.ParagraphReader.Pd(w)&&
!this.KJ.hRa(w)&&!w.BB){var F=db.ParagraphReader.text(w),S=a.Qa,fa=a.Lb+f;this.HTh?(S=a.Qa+b,fa=a.Lb-c+f):this.qRh&&(b=this.Rc.Dj,0<=f&&b&&Cb.SelectionEditor.Mg(b)&&(b=b.Qa,0<=b&&b<=F.length&&(b=this.KJ.VYb(F,b,b))&&b.begin>=S&&b.end<=fa&&(S=b.begin,fa=b.end)));b=this.Erb(w);c=null;0<=f&&(c=b.H1d(S,fa));c||(c=this.KJ.VYb(F,S,fa));0<=f?this.MRg(w,c,l):this.ysl(w,a.Qa,a.Lb,c,b,f,l)}}MRg(a,b,c){if(b){var f=this.mra(a);Array.add(f,b);a.w_=f;a.kjc();this.bDe(a,b,c)}}ysl(a,b,c,f,l,w,F){const S=this.mra(a),
fa=[];if(S.length)if(S[S.length-1].end<b)if(f)Array.addRange(fa,S);else return;else{for(const xa of S)xa.end<b?Array.add(fa,xa):xa.begin>=c?l.jCa(xa.begin+w,xa.end+w):xa.begin<b?xa.end>c?l.jCa(xa.begin,xa.end+w):l.jCa(xa.begin,b):xa.end>c&&l.jCa(b,xa.end+w);Array.addRange(fa,l.J_b())}f&&(Array.add(fa,f),this.bDe(a,f,F));a.w_=fa;a.kjc();this.im.T5c(a)}bDe(a,b,c){const f=this.im.ME(a,w=>w.begin<=b.end&&w.end>=b.begin);if((c===D.a.dJd||c===D.a.typing||c===D.a.cut||c===D.a.paste)&&1===f.length&&f[0].Gh){c=
f[0].Gh;var l=qa.a.re(c.lcid);l=l?l.name:Jp.pEh;const w=Object(Ca.a)($l.a,c)?c.typeId:Jp.BEh;Z.ULS.sendTraceTag(40486211,375,50,"ManualEdits CritiqueId:{0}, CultureTag:{1}",w,l);c.GCh&&Z.ULS.sendTraceTag(40486212,375,50,"ClickNoAction CritiqueId:{0}, CultureTag:{1}",w,l)}this.im.vHa(a,f)}}Jp.BEh="";Jp.pEh="UNKNOWN";Object(e.a)(Jp,"ModifiedRangeEditor",null,[1437]);class Iq{constructor(a,b,c,f,l,w,F,S,fa,xa,Za=null){this.im=a;this.gz=b;this.yRb=c;this.EJ=f;this.l0a=l;this.rLa=w;this.KJ=F;this.u1a=
S;this.hYe=fa;this.F3e=Za||Iq.TBi;this.rtf=!1;xa.execute(pb=>{this.rtf=!!pb})}uzh(a){if(a&&db.ParagraphReader.Pd(a)&&a.KOc){let b=null;this.hYe.fsa&&(b=c=>!!c.Gh&&1===c.Gh.proofingType);a.aub=Ma.a.Xa(this.gz.mra(a))&&Ma.a.Xa(this.im.ME(a,b))}}v5i(a,b){var c=this.x5i(a,b);if(Ma.a.Xa(c))return[];const f=db.ParagraphReader.text(a).replace("\u00a0"," "),l=this.im.ME(a),w=this.dYk(a,l),F=w&&this.Eti(a),S=this.KJ.R1f(a),fa=ll.e(this.KJ.Q1f(a),S);c=this.P0i(c,b,f,fa,l,w,F);if(Ma.a.Xa(c))return[];b=this.l0a.H3i(a);
c=this.rLa.BHf(c,b);if(Ma.a.Xa(c))return[];this.Lzk(a,f,c);a=this.gz.mra(a);for(const xa of c)this.rLa.VYh(xa,f,b,S),xa.vLd=this.rLa.uXi(xa,a,f),w&&(F||this.rLa.Iig(f,xa))&&(xa.textUnit=4);return c}tPi(a){if(this.F3e()||!a||""===a.ta(ob.a.Vp,""))return null;var b=this.u1a.XYb;if(!b||!Cb.SelectionEditor.Mg(b)||b.node!==a||!this.Loj(a))return null;b=b.Qa;return this.KJ.VYb(db.ParagraphReader.text(a),b,b)}a8h(a,b,c,f,l,w,F=0){this.EJ.Jc(a.node).af()&&(this.gz.b8h(a,b,c,w,F),this.yRb.wul(a,f,l))}Loj(a){const b=
ll.a(this.gz.mra(a));if(!b.length)return!1;a=ll.a(this.im.ME(a));let c=0,f=0;for(;c<a.length&&f<b.length;){const l=b[f],w=a[c];l.begin>=w.begin&&l.end<=w.end?f++:c++}return f!==b.length}x5i(a,b){if(!a||a.H7d)return null;a=this.gz.mra(a);return a.length&&b?ll.b(a,[b]):a}dYk(a,b){return this.rtf&&this.hYe.fsa?a.wNb||!b.length||Ma.a.any(b,c=>!!c.Gh&&2===c.Gh.Bzg):!1}Eti(a){if(!a.wNb||this.F3e())return!0;var b;(b=this.u1a.XYb)&&b.node===a?(a=this.gz.mra(a),b=b.Qa<a[a.length-1].begin):b=!0;return b}P0i(a,
b,c,f,l,w,F){let S=[];for(const fa of a)a=w?this.rLa.YLi(fa,c,f,F):this.rLa.XLi(fa,c,f),(a=this.rLa.WLi(a,l))&&Array.add(S,a);S=ll.a(S);b=ll.f(f,b);return ll.b(S,b)}Lzk(a,b,c){const f=[];for(let l=c.length-1;0<=l;l--){const w=c[l];this.rLa.t7k(w,b)||(Array.removeAt(c,l),Array.add(f,w))}this.gz.Tfd(a,f)}static TBi(){return sg.a.ppj(gb.App.Fb.EF.myg)}}Object(e.a)(Iq,"ParagraphProofingFacade",null,[1438]);var ak=d(1019);class So{constructor(){this.iOc=this.xOc=this.activity=null}endActivity(a){this.activity&&
(this.activity.properties.$("EndReason",a),this.activity.end())}}Object(e.a)(So,"EditorServiceAPIRequest",null,[]);class cs extends So{constructor(){super();this.Ywa=this.request=null}}Object(e.a)(cs,"ProofingConfigV2Request",So,[]);class ds{constructor(a,b,c,f,l){this.Lcid=a;this.AppId=b;this.LanguageId=c;this.LanguageUXId=f;this.Descriptors=l}}Object(e.a)(ds,"ProofingConfigV2RequestObject",null,[]);var Kp;(function(a){a[a.success=0]="success";a[a.partialSuccess=1]="partialSuccess";a[a.error=2]=
"error";a[a.disabled=3]="disabled"})(Kp||(Kp={}));Object(e.b)("ResponseStatus",Kp);var co=d(2);class Jq{constructor(a,b,c,f,l){this.JLb=a;this.ld=b;this.EPb=c;this.oRh=f;this.jyf=u.AFrameworkApplication.lcid;this.afa=gb.App.mode;this.Upc={};this.WOb=new Bc.a;this.iRh=l}init(){this.W9c(this.jyf)}W9c(a){if(!(a.toString()in this.Upc||u.AFrameworkApplication.Xg))try{this.oRh.Lji(a).continueWith(b=>{!b.result||this.WOb.Kb(a.toString())&&this.WOb.ga(a.toString())||this.fXk(a)},3)}catch(b){Z.ULS.sendTraceTag(36782929,
375,10,"PopulateConfigByLanguageId failed with exception: {0}",b)}}fXk(a){var b=new ak.a;const c=qa.a.re(a).name,f=qa.a.re(this.jyf).name;c&&c.length&&f&&f.length&&(b=Object.assign(new cs,{request:new ds(a,this.$Wd(),c,f,this.EPb.descriptors),activity:this.ld.zp(D.a.wQk),Ywa:b,xOc:Object(C.a)(this,this.Cfc,"processSuccessResponse"),iOc:Object(C.a)(this,this.Afc,"processFailResponse")}),this.WOb.$(a.toString(),!0),this.JLb.dw(2,md.c(b.request),b))}Cfc(a,b){if(!a||!a.request)return!1;this.WOb.$(a.request.Lcid.toString(),
!1);if(a.request.Lcid.toString()in this.Upc)return a.endActivity("RequestSucceeded"),!0;let c=null;if(b&&b.length)try{c=md.a(b)}catch(f){Z.ULS.sendTraceTag(36811152,375,10,"Parse failed with exception: {0}",f)}if(!c||1===c.ResponseStatus)return b=c?Kp[c.ResponseStatus]:"EmptyResponse",Z.ULS.sendTraceTag(37343687,375,50,"Failed to get proofing config, language {0}, Reason {1}",a.request.LanguageId,b),a.endActivity(b),!1;a.endActivity("RequestSucceeded");b=c.CritiqueCategoryInfoList;this.iRh.filter(b);
Z.ULS.sendTraceTag(35240099,375,50,"Get proofing config. CritiqueCategoryInfoList is null: {0}, Length of CritiqueCategoryInfoList: {1}, languageId: {2}",!b,b?b.length:0,a.request.LanguageId);this.Upc[a.request.Lcid.toString()]=b;return!0}Afc(a){a&&(a.request&&this.WOb.$(a.request.Lcid.toString(),!1),a.Ywa.Ig(!1),Z.ULS.sendTraceTag(35240128,375,10,"Failed to get proofing config, language {0}",a.request.LanguageId),a.endActivity("RequestFailed"))}request(a){return co.Task.ot(this.Upc[a.toString()])}$Wd(){const a=
kb.a[this.afa];return a.charAt(0).toUpperCase()+a.substr(1)+"_Online"}}Object(e.a)(Jq,"ProofingConfigV2Manager",null,[1297]);class Gm{constructor(){this.Value=this.Name=null}static create(a,b){return Object.assign(new Gm,{Name:a,Value:b})}static B5d(){Object.assign(new Gm,{Name:"IsCompliant",Value:void 0});Object.assign(new Gm,{Name:"LicenseType",Value:"NoLicense"});Object.assign(new Gm,{Name:"IsGoLocal",Value:void 0})}}Object(e.a)(Gm,"Descriptor",null,[]);class aq{constructor(a,b){this.Yxa=[];this.mb=
a;this.q1e=b}get descriptors(){if(!this.Yxa.length)try{this.B5d()}catch(a){const b=String.format("Message: {0}. Stack: {1}",a.message,a.stack);Z.ULS.sendTraceTag(33952285,375,10,b)}return this.Yxa}B5d(){Array.clear(this.Yxa);var a=this.mb.ka("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled").toString();Array.add(this.Yxa,Object.assign(new Gm,{Name:"IsGoLocal",Value:this.mb.ka("IsGoLocalEnvironment").toString()}));Array.add(this.Yxa,Object.assign(new Gm,{Name:"IsCompliant",Value:a}));
if(this.q1e.Aae||this.q1e.dRa)a=this.mb.ka("IsSubscriptionForProofingUser")?"Subscription":"NoLicense",Array.add(this.Yxa,Object.assign(new Gm,{Name:"LicenseType",Value:a}));this.j7h();this.q7h()}q7h(){var a=md.b(this.mb.appSettings.SessionStartInfoJson.toString());var b=a.Host||"";const c=a.Ring||"";a=a.WACDatacenter||"";""!==c&&""!==b&&(b=c+"-"+b,Array.add(this.Yxa,Object.assign(new Gm,{Name:"CustomAudience",Value:b})));""!==a&&Array.add(this.Yxa,Object.assign(new Gm,{Name:"Origin",Value:a}))}j7h(){const a=
this.$Oi(this.mb.Ia("FlightId"));let b;0<a.length&&(b=Ma.a.join(a,";"),Array.add(this.Yxa,Object.assign(new Gm,{Name:"FlightIds",Value:b})),Z.ULS.sendTraceTag(33952287,375,50,"FlightCount: [{0}], flightIds: [{1}]",a.length,b))}$Oi(a){const b=[];if(a&&""!==a){a=a.split(";");for(let c=0;c<a.length;c++)-1<a[c].toLowerCase().indexOf("editorservice")&&Array.add(b,a[c])}return b}}Object(e.a)(aq,"ProofingDescriptors",null,[1292]);class Kq{constructor(a,b){this.dRa=this.Stb=this.uBd=!1;this.ayd=this.$xd=
0;this.tvc=a.ka("ProofingWithEditorServiceIsEnabled");this.aLh=a.ka("GrammarCheckIsEnabled");this.IRa=a.ka("ProofingSettingIsEnabled");this.W9d=a.ka("ProofingSecondaryContextualMenuIsEnabled");this.rsc=a.ka("EditorServiceSuggestionDescriptionsIsEnabled");a.ka("NewProofingExperienceEnabled");this.ZWh=a.ka("WritingStyleIsEnabled");this.$Ih=a.ka("DoNotCheckThisIssueEnabled");this.HMh=a.ka("IgnoreProofingCommandIsEnabled");this.fsa&&(this.uBd=!1,b.execute(()=>{this.uBd=!0}));2===this.Wda?(this.ayd=2,
this.$xd=3):(this.ayd=a.Gc("NumberOfWordsToProofAroundModifiedRanges",1),this.$xd=a.Gc("NumberOfWordsAsContextAroundProofedRanges",0))}get Vsg(){return this.HMh}get fsa(){return 2===this.Wda&&this.aLh}get Aae(){return this.fsa&&this.ZWh}get a8d(){return this.$Ih&&this.W9d&&this.IRa}get MCj(){return this.rsc}get Wda(){return this.tvc?2:0}get Odk(){return this.$xd}get DUg(){return this.ayd}get isLoaded(){return!this.tvc||!this.fsa||this.uBd}}Object(e.a)(Kq,"ProofingFeatureConfiguration",null,[1436]);
class mr extends So{constructor(){super();this.request=null}}Object(e.a)(mr,"ProofingFeedbackLoopRequest",So,[]);class Lp{constructor(a,b,c){this.JLb=a;this.ld=b;this.EPb=c}kXk(a){a.Descriptors=this.EPb.descriptors;a=Object.assign(new mr,{request:a,activity:this.ld.zp(D.a.GXk),xOc:Object(C.a)(this,this.Cfc,"processSuccessResponse"),iOc:Object(C.a)(this,this.Afc,"processFailResponse")});this.JLb.dw(1,md.c(a.request),a)}Cfc(a){if(!a)return!1;a.endActivity("RequestSucceeded");return!0}Afc(a){a&&(Z.ULS.sendTraceTag(38847138,
375,15,"Proofing feedback failed"),a.endActivity("RequestFailed"))}}Object(e.a)(Lp,"ProofingFeedbackLoopManager",null,[1435]);class xo extends So{constructor(){super();this.Ywa=this.request=null}}Object(e.a)(xo,"ProofingLanguageInfoRequest",So,[]);class nr{constructor(a){this.AppId=a}}Object(e.a)(nr,"ProofingLanguageInfoRequestObject",null,[]);class am{constructor(a,b){this.JLb=a;this.ld=b;this.afa=gb.App.mode;this.eoa=new wa.ScriptSharpLegacyMap;this.gfa=null;this.h1a=0}Lji(a){if(this.eoa.Kb(a))return co.Task.ot(!0);
this.eGe();return this.gfa.CWRCo(()=>!!this.gfa.result&&this.gfa.result.Kb(a),3)}Mji(a,b){if(this.eoa.Kb(a))return co.Task.ot(this.Adg(a,b));this.eGe();return this.gfa.CWRCo(()=>this.Adg(a,b),3)}wZi(a){if(0<this.eoa.count)return co.Task.ot(this.z7f(a));this.eGe();return this.gfa.CWRCo(()=>this.z7f(a),3)}qQk(){const a=new ak.a;u.AFrameworkApplication.Xg&&a.Ig(null);const b=Object.assign(new xo,{request:new nr(kb.a[this.afa]+"_Online"),activity:this.ld.zp(D.a.xQk),Ywa:a,xOc:Object(C.a)(this,this.Cfc,
"processSuccessResponse"),iOc:Object(C.a)(this,this.Afc,"processFailResponse")});this.JLb.dw(0,md.c(b.request),b);this.h1a+=1;return a.task}Cfc(a,b){let c=null;if(!a)return!1;try{c=md.a(b)}catch(l){Z.ULS.sendTraceTag(37025730,375,10,"Failed to parse language info response with exception {0}",l)}if(c&&0===c.ResponseStatus&&c.SupportedLanguages&&0<c.SupportedLanguages.length){for(var f of c.SupportedLanguages)(b=qa.a.re(f.LanguageId))&&0!==f.SupportedTextUnit&&this.eoa.$(b.LCID,f);a.Ywa.Ig(this.eoa);
a.endActivity("RequestSucceeded");return!0}a.Ywa.Ig(null);f=c?Kp[c.ResponseStatus]:"EmptyResponse";Z.ULS.sendTraceTag(38847139,375,15,f);a.endActivity(f);return!1}Afc(a){a&&(a.Ywa.Ig(null),Z.ULS.sendTraceTag(38847168,375,15,"RequestFailed"),a.endActivity("RequestFailed"))}Adg(a,b){if(!this.eoa||!this.eoa.Kb(a))return 0;a=this.eoa.ga(a).SupportedTextUnit;return 0!==(b&a)?b:this.U0i(b,a)}U0i(a,b){for(a=b&(a|a-1);a;){b=a&a-1;if(!b)break;a=b}return a}z7f(a){const b=new Ua.a;if(!this.eoa)return b;for(let c of this.eoa)c.value.SupportedCritiqueTag&
a&&b.add(c.key);return b}eGe(){if(!this.gfa||5===this.gfa.status||4===this.gfa.status||6===this.gfa.status&&!this.gfa.result)this.gfa=this.qQk(),Z.ULS.sendTraceTag(38319180,375,1===this.h1a?50:15,"Schedule a new task for LanguageInfo request. IsRetried: {0}, Count: {1}",1!==this.h1a,this.h1a)}}Object(e.a)(am,"ProofingLanguageInfoManager",null,[1434]);class $s{constructor(a,b){this.yNh=a;this.Ukb=b}track(a,b=null){this.yNh&&this.Ukb.track(a(),b)}}Object(e.a)($s,"ProofingMetricsAggregator",null,[1296]);
class bq{EBf(a,b){a&&db.ParagraphReader.Pd(a)&&!Ma.a.Xa(b)&&(ll.d(b),a.NIb=ll.e(a.NIb,b))}wul(a,b,c){if(b){var f=a.Lb;a=a.node.NIb;for(let w=0;w<a.length;w++){var l=a[w];const F=l.begin;l=l.end;0>b?l>c&&(F>=f?a[w]=new qk.a(F+b,l+b):F>=c&&l<=f?(Array.removeAt(a,w),w--):a[w]=new qk.a(F<c?F:c,l<=f?c:l+b)):a[w]=new qk.a(F>f?F+b:F,l>f?l+b:l)}}}}Object(e.a)(bq,"UnsupportedLanguageRangeEditor",null,[1432]);var nu=d(1208),Me=d(461),n=d(243),O=d(443),ha=d(1046),Aa=d(650);class La{constructor(){this.Tx=this.SWa=
null}}Object(e.a)(La,"ClientRequestManagerStateObject",null,[]);class Bb{constructor(a,b){this.request=a;this.response=b}}Object(e.a)(Bb,"SpellCheckRequestResponseTuple",null,[]);class Wb{constructor(){this.OBh=0;this.kTf=this.Lla=this.paragraphNode=this.range=null;this.userAction=0;this.JH=null;this.Wda=0;this.overriddenCritiqueTypeOptions=this.descriptors=null}gtg(){const a=db.ParagraphReader.text(this.paragraphNode);if(!a||!this.Lla)return a===this.Lla;let b=this.range.begin,c=this.range.end;return Ja.a.pId(a.substring(b,
c),this.Lla.substring(b,c))}isValid(){return this.paragraphNode.isConnected&&this.gtg()}}Object(e.a)(Wb,"SpellCheckRequest",null,[]);var uc=d(649),Vc=d(820),bd=d(821);class xd{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd){this.eEd=new pa.a;this.rPb=[];this.Dqc=0;this.Qvc={};this.y$=null;this.hXe=Number.POSITIVE_INFINITY;this.Dpc=0;this.a6=xd.z7a;this.a1a=null;this.hxc=0;this.Olb=[];this.aqc=null;this.cSh=!1;this.UOb=[];this.cAd=[];this.jRh=0;this.nRh=c.ka(xd.szk);this.sRh=c.ka(xd.zzk);
this.kRh=c.appSettings[xd.qzk];this.hRh=c.ka(xd.pzk);this.rRh=c.ka(xd.xzk);this.hH=f;this.afa=gb.App.mode;this.im=a;this.gz=b;this.yRb=xa;this.Di=l;this.POh=c.Gc(xd.vzk,xd.uzk);this.pRh=Mb;this.kk=w;this.ef=F;this.EJ=S;this.KJ=fa;this.Czd=Za;this.rvc=pb;this.Sh=new nu.a;this.mRh=c.ka(xd.rzk);this.qvc=kc;this.tzk=Ec;this.EIc=hc;this.tvc=c.ka(xd.yzk);this.EPb=Hc;this.gRh=Dc;this.Rib=Td;this.$ea=we;this.Md=Pd}get s0g(){return this.UOb}set s0g(a){this.UOb=a}get cKc(){return u.AFrameworkApplication.Xg}get uWb(){return this.Rib.instance}suspend(){this.hxc++}resume(){if(0>=
--this.hxc&&(this.hxc=0,0<this.Olb.length&&!this.aqc)){const a=this.$ea.isCompleted(4)?0:1;this.aqc=new Se.a(a,1,1,Object(C.a)(this,this.$cl,"spellCheckSuspendedNodes"),74);this.Md.Hb(this.aqc)}}$cl(){this.aqc=null;const a=Ma.a.clone(this.Olb);Array.clear(this.Olb);Date.now();let b=null;for(const c of a)b=this.Ixh(c,!0,b);b&&b.dispose();this.cSh||Date.now()}NQ(a,b=!1){(a=this.Ixh(a,b,null))&&a.dispose()}Ixh(a,b,c){switch(this.Xqa(a,b)){case 1:Ma.a.contains(this.Olb,a)||Array.add(this.Olb,a);break;
case 2:c=this.doSpellCheck(a,c);this.executeNextRequest();break;case 3:this.executeNextRequest()}return c}Xqa(a,b){return!a||this.cKc||!this.hH.Fd.isEditingAllowed&&!this.hH.Fd.uy?0:!b&&0<this.hxc||!this.EIc.isLoaded?1:!db.ParagraphReader.Pd(a)||!a.isConnected||a.anchor.iI||a.H7d||a.AV||a.BB?3:this.y$&&Ma.a.any(this.y$,c=>c.paragraphNode===a)?0:Ma.a.any(this.rPb,c=>c.paragraphNode===a)||!this.ef.Rs(this.EJ.Jc(a))?3:2}doSpellCheck(a,b){const c=(xa,Za)=>{this.gz.Tfd(xa,Za)};var f=this.KJ.gLc(a);let l=
0<f.length;b=this.Ize(b,a,f,c);(f=this.qvc.tPi(a))&&this.Exi(a);const w=this.qvc.v5i(a,f),F=db.ParagraphReader.text(a),S=a.wNb,fa=[];for(let xa=w.length-1;0<=xa;xa--){const Za=w[xa];Za.begin!==Za.end&&(this.eEd.contains(Za.lcid)?Array.add(fa,Za):(this.Rti(a,F,f,Za,S),Array.removeAt(w,xa)))}l=0<fa.length||0<w.length||l;b=this.Ize(b,a,fa,Object(C.a)(this.yRb,this.yRb.EBf,"addUnsupportedRanges"));b=this.Ize(b,a,w,c);l&&this.qvc.uzh(a);return b}ie(a){const b=this.kk.ie(7,D.a.JSe);b.hd(a);return b}Ize(a,
b,c,f){Ma.a.Xa(c)||(a=a||this.ie(b),f(b,c));return a}Exi(a){const b=new Se.a(4,1,500,Object(C.a)(this,this.recheckParagraphTask,"recheckParagraphTask"),48);b.customData=a;this.Md.Hb(b)}Uck(a,b){b="b"+b.range.begin+"e"+b.range.end+"i"+b.range.lcid+"l"+b.Lla.length+b.paragraphNode.id;this.Qvc[b]=(this.Qvc[b]||0)+1;this.Dqc=Math.max(this.Qvc[b],this.Dqc);return this.Dqc>xd.$9j?(Z.ULS.sendTraceTag(22390425,324,15,"Infinite proofing loop detected, cleaning paragraph proof state"),this.Dqc=0,this.Qvc={},
this.gz.VCc(a),!1):!0}Rti(a,b,c,f,l){const w=new Wb;w.OBh=u.AFrameworkApplication.lcid;w.Lla=b;w.range=f;w.paragraphNode=a;w.kTf=c;w.userAction=l?1:0;const F=this.EIc.IRa;F&&this.uWb&&(w.overriddenCritiqueTypeOptions=this.uWb.UXd());this.Uck(a,w)&&this.xcj(w.range.lcid,w.range.textUnit).continueWith(S=>{S=S.result;w.Wda=2===this.EIc.Wda?0!==S?2:0:this.jRh;w.range.textUnit=S;w.descriptors=this.EPb.descriptors;this.nJi(w);F&&2===w.Wda&&this.gRh.W9c(w.range.lcid)},8).continueWith(()=>{this.executeNextRequest()})}xcj(a,
b){return 2===this.EIc.Wda?this.tzk.Mji(a,b):co.Task.ot(b)}nJi(a){a.JH=new Date;Array.enqueue(this.rPb,a)}recheckParagraphTask(a){this.NQ(a.customData)}executeNextRequest(){if(!this.cKc&&!this.y$){var a=[];do{if(!this.rPb.length)break;const b=Array.dequeue(this.rPb);b.isValid()&&Array.add(a,b)}while(a.length<this.POh);0>=a.length?(this.y$=null,this.adl()):(this.y$=a,this.y$.sort((b,c)=>+b.JH-+c.JH),a=this.y$[0],this.rvc.track(+new Date-+a.JH,"ProofingRequestInQueue."+uc.a[a.userAction]),this.executeRequest(this.y$))}}adl(){for(var a=
0;a<this.UOb.length;a++)(0,this.UOb[a])();Array.clear(this.UOb);for(a=0;a<this.cAd.length;a++)(0,this.cAd[a])();Array.clear(this.cAd)}executeRequest(a){if(a&&a.length){var b=[];for(let c=0;c<a.length;++c){const f=Aa.a.S$i(this.nRh,a[c],this.afa,this.sRh,this.rRh,this.hRh,this.kRh,this.tvc);Array.add(b,f)}b=Vc.a.ari(b,gb.App.mode);this.Di.Jj(this.Czd(),2,b,{"Content-Type":"application/json; charset=utf-8"},!1,3,Object(C.a)(this,this.Ycl,"spellCheckSucceeded"),Object(C.a)(this,this.Xcl,"spellCheckFailed"),
Object.assign(new La,{SWa:a,Tx:this.Sh.wi("WebServiceCall","Proofing")}),void 0,void 0,void 0,void 0,"29")}}Ycl(a){if(!this.cKc){a=a.data;this.rvc.track(a.state.Tx.vq,"ProofingRequestRoundtrip");var b=this.Sh.wi("DOMUpdate","Proofing");this.Zcl(a);this.rvc.track(b.vq,"UpdateProofingResults")}}Zcl(a){Me.a.mark(7798);this.y$=null;var b=a.state.SWa;if(({group:c}=bd.a.Fwh(a.je)).returnValue){var c=c.Responses;var f=({LSk:b,lYk:c}=this.ocj(b,c)).returnValue;if(0<f.length){const l=this.ie(f[0].request.paragraphNode);
try{for(const w of f){const F=w.request;this.hH.pJi(F.paragraphNode,()=>{this.D9j(w.response,F)})}}finally{l&&l.dispose()}}b.length?(this.gJd(a),this.rze(b),this.OSd()):this.jRk();this.gJd(a);for(const l of c)n.PageStats.pSb(l);this.OSd();this.executeNextRequest()}else this.rze(b);Me.a.mark(7799)}ocj(a,b){let c,f;const l=[];c=[];f=[];for(let w=0;w<a.length;w++){const F=a[w];if(!F.paragraphNode.isConnected)continue;const S=b[w];if(5===S.classId){const fa=S.Fault;if(fa)switch(fa.Type){case 1:Z.ULS.sendTraceTag(22390429,
324,15,"Previous proofing char limit: {0}; char limit returned by server: {1}; proofing word length we tried {2}",this.hXe,fa.Limit,fa.AttemptedValue);this.hXe=fa.Limit;break;default:Z.ULS.sendTraceTag(22390431,324,10,"Unknown limit type violated")}else c.push(F)}else l.push(new Bb(F,S));S.ServerPageStatsTrace&&f.push(S.ServerPageStatsTrace)}return{returnValue:l,LSk:c,lYk:f}}D9j(a,b){const c=b.paragraphNode;if(c.isConnected)if(c.BB)this.executeNextRequest();else{var f=this.ie(c),l=this.pRh.FRk(a);
if(b.gtg()){var w=b.range;const F=[w];l.qdd(a)?(w=ll.a(this.im.ME(c)),1!==b.userAction&&c.D8h()&&this.mRh&&(a=l.K1f(a,b,w)),this.gz.Tfd(c,F,b.kTf),a=l.JMi(a,b,w),this.im.gAf(c,a)):this.Hnj(c,w);this.qvc.uzh(c)}c.kjc();f.dispose();this.NQ(c)}else this.executeNextRequest()}Hnj(a,b){const c=[b];b=b.lcid;this.eEd.contains(b)||(Z.ULS.sendTraceTag(42004739,324,50,"LCID {0} unsupported for proofing",b),this.eEd.add(b));this.gz.Tfd(a,c);this.yRb.EBf(a,c)}Xcl(a){a=a.data;if(!this.cKc){var b=a.state;this.rvc.track(b.Tx.vq,
"ProofingRequestRoundtrip");this.rze(b.SWa);this.gJd(a);this.OSd()}}rze(a){this.y$=a;a=new Se.a(3,1,this.a6,Object(C.a)(this,this.retryCurrentRequest,"retryCurrentRequest"),49);this.Md.Hb(a);++this.Dpc;this.a6*=xd.$Ee;this.a6>xd.sbc&&(this.a6=xd.sbc);4!==this.Dpc||this.Di.hDa||(this.a1a=gb.App.Fb.notificationBar.NNa(Box4Intl.Box4Strings.l_NotificationBarProofingUnavailave,!0),gb.App.Fb.notificationBar.ai(this.a1a),u.AFrameworkApplication.Yi.w7a(xd.oEh,1),Z.ULS.sendTraceTag(7390529,324,15,"Proofing unavailable"),
this.Di.czc(this))}jRk(){this.Dpc&&(this.Dpc=0,this.a6=xd.z7a);this.a1a&&(gb.App.Fb.notificationBar.removeEntry(this.a1a),this.a1a=null,this.Di.pcd(this))}retryCurrentRequest(){this.executeRequest(this.y$)}kBb(){gb.App.Fb.notificationBar.removeEntry(this.a1a);this.a1a=null;this.Di.pcd(this)}ccc(){}get M$d(){return!this.Olb.length&&!this.y$&&!this.rPb.length}gJd(a){n.PageStats.Z2a("SpellCheck",a.wt);(a=a.lj?a.lj[O.a.oAa]:null)&&n.PageStats.s2a(ha.a.Oh,a)}OSd(){n.PageStats.bBa("SpellCheck")}}xd.vzk=
"ProofingRequestsBatched";xd.uzk=1;xd.pzk="ProofingContextualResultsIsEnabled";xd.xzk="ProofingTrackMetricsIsEnabled";xd.szk="ProofingInstrumentedAndContextualIsEnabled";xd.zzk="ProofingWithOneSpellerIsEnabled";xd.qzk="ProofingExperimentId";xd.yzk="ProofingWithEditorServiceIsEnabled";xd.rzk="ProofingFilterSpellCheckResultIsEnabled";xd.oEh=11093;xd.$9j=30;xd.z7a=1E3;xd.$Ee=5;xd.sbc=72E6;Object(e.a)(xd,"ProofingCheckOperator",null,[304,1433]);var xe=d(514);class wf{constructor(a){this.Ukb=a}JMi(a,b,
c){if(this.UEe(a)){const f={};a=this.u0f(b,a,c,f);this.j6h(b,f);return a}b&&this.k6h(b);return[]}j6h(a,b){this.Ukb.track(()=>Object.assign(new xe.a,{E:a.Wda,C:a.range.vLd,F:b}))}k6h(a){this.Ukb.track(()=>Object.assign(new xe.a,{E:a.Wda,C:a.range.vLd}))}Wtg(a,b,c){return!a||Ma.a.all(a,f=>f.begin!==b||f.end!==c)}yxg(a,b,c){return!!a&&Ma.a.any(a,f=>b>=f.begin&&c<=f.end)}}Object(e.a)(wf,"AProofingResultsManager",null,[1448]);var Ze=d(513),Ah;(function(a){a[a.none=0]="none";a[a.spelling=1]="spelling";
a[a.grammatical=2]="grammatical";a[a.advanced=3]="advanced";a[a.informational=4]="informational";a[a.consistency=5]="consistency"})(Ah||(Ah={}));Object(e.b)("ProofingType",Ah);class Bk extends wf{constructor(a,b,c,f=null){super(a);this.mb=f;this.IJh=b;this.oM=c}qdd(a){return a&&63===a.classId?!0:(Z.ULS.sendTraceTag(20993182,375,10,"null response or unexpected response"),!1)}UEe(a){return this.qdd(a)&&!!a.Critiques&&0<a.Critiques.length}u0f(a,b,c,f){const l=[];b=b.Critiques;for(const S of b)if(this.Qoj(b,
S)&&this.P5k(S)){var w=0<=a.range.G9?a.range.G9+S.Start:a.range.begin+S.Start;const fa=w+S.Length;var F=a.Lla.substring(w,fa);const xa=this.IJh.create(S,this.Ukb,this.mb);xa.lcid=a.range.lcid;xa.token=F;xa.originalText=a.Lla;xa.G9=a.range.G9;xa.$Ga=a.range.$Ga;a.range.end>=fa&&(F=new wo(w,fa,xa),Array.add(l,F));this.Wtg(c,w,fa)&&(w=1===xa.proofingType?Ah[xa.proofingType]:xa.typeId,f[w]=w in f?f[w]+1:1)}return l}K1f(a,b,c){if(!this.UEe(a))return a;const f=[];for(const l of a.Critiques){const w=0<=
b.range.G9?b.range.G9+l.Start:b.range.begin+l.Start;this.yxg(c,w,w+l.Length)&&Array.add(f,l)}a.Critiques=f;return a}P5k(a){return 2!==Ze.b(a)||!this.oM.dRa}Qoj(a,b){if(a)for(let c=0;c<a.length;c++)if(b.Start<=a[c].Start+a[c].Length&&b.Start+b.Length>=a[c].Start&&a[c].Priority<b.Priority)return!1;return!0}}Object(e.a)(Bk,"ProofingCheckResultsManager",wf,[]);var Oe=d(48),sh=d(89);class Ck{constructor(a,b,c,f,l,w,F){this.htd=!1;F&&c.aP(Object(C.a)(this,this.AFk,"recheckAllParagraphs"));b.Z0h(Object(C.a)(this,
this.Dek,"onAfterParagraphMerge"));l&&l.Cd(12).l6(Object(C.a)(this,this.Vjk,"onParagraphDisconnected"));this.gz=a;this.DPb=f;this.im=w}Vjk(a,b){db.ParagraphReader.Pd(b.node)&&this.im&&this.im.T5c(b.node)}Dek(a,b){this.gz.X5h(b);this.NQ(b.WQd.currentNode)}H2b(a){this.gz.q1k(a);this.NQ(a)}AFk(a){if(2===a.mode&&(a=this.Odg(a)))for(a=sh.a.pz(a);a.moveNext();)db.ParagraphReader.Pk(a.iterator)&&this.NQ(a.currentNode)}suspend(){this.DPb.suspend()}resume(){this.DPb.resume()}get M$d(){return this.DPb.M$d}get gKe(){return this.htd}set gKe(a){if(this.htd!==
a&&(this.htd=a,a=this.Odg(gb.App.Fb))){var b=new Oe.GraphTransaction(2);try{b.set(a.zk);const c=sh.a.pz(a);for(;c.moveNext();)db.ParagraphReader.Pk(c.iterator)&&c.currentNode.Su(16,!0)}finally{b&&b.dispose()}}}Odg(a){return(a.Fd.isEditingAllowed||a.Fd.uy)&&a.Fd.Xm.Oo?a.Fd.Xm.ug:null}w_h(a){Array.add(this.DPb.s0g,a)}NQ(a){this.DPb.NQ(a,!1)}}Object(e.a)(Ck,"ProofingManager",null,[1295]);var Hm=d(1163),nm=d(648);class yo extends nm.a{constructor(a){super(a);this.YQb=null}get proofingType(){return 1}get suggestions(){return this.YQb?
Array.clone(this.YQb):null}i3k(a){this.YQb=a}eJa(a,b=0){this.Xpf.track(()=>Object.assign(new xe.a,{E:0,T:1,A:a,I:b}))}}Object(e.a)(yo,"OfficeSpellerErrorDetails",nm.a,[]);class eo extends wf{constructor(a){super(a)}qdd(a){return!!a.Errors}UEe(a){return this.qdd(a)&&0<a.Errors.length}u0f(a,b,c,f){let l=0;const w=[],F=b.Errors;for(let xa=0;xa<F.length;xa++){var S=F[xa],fa=Object.assign(new yo(this.Ukb),{token:S.Word,errorType:S.Type,lcid:a.range.lcid});fa.i3k(Hm.a.jCh(b.Suggestions,xa*Hm.a.ayg));const Za=
S.Offset+a.range.begin;S=Za+S.Word.length;fa=new wo(Za,S,fa);Array.add(w,fa);this.Wtg(c,Za,S)&&l++}f.spelling=l;return w}K1f(a,b,c){if(Ma.a.Xa(c)||!a)return a;const f=[],l=[];for(let F=0;F<a.Errors.length;++F){const S=a.Errors[F];var w=S.Offset+b.range.begin;this.yxg(c,w,w+S.Word.length)&&(w=F*Hm.a.ayg,Array.add(f,Hm.a.UOj(a.Suggestions,w)),Array.add(f,Hm.a.jCh(a.Suggestions,w)),Array.add(l,S))}a.Suggestions=f;a.Errors=l;return a}}Object(e.a)(eo,"ProofingResultsManager",wf,[]);class Mp{constructor(a,
b,c){this.svc=new Ie.a;this.RYe=b;a.ka("ProofingWithEditorServiceIsEnabled")&&this.svc.add(63,c.value);this.svc.add(4,this.RYe)}FRk(a){if(this.svc.Kb(a.classId))return this.svc.ga(a.classId);Z.ULS.sendTraceTag(20747157,375,50,"Fallback ProofingResultsManager is resolved for response: {0}",a.classId);return this.RYe}}Object(e.a)(Mp,"ProofingResultsManagerResolver",null,[1294]);class bm{constructor(a=null,b=null){this.PC=this.Yc=null;this.SDd=a;this.TDd=b}get Mf(){!this.Yc&&this.SDd&&this.SDd.instance&&
(this.Yc=this.SDd.instance.instance);return this.Yc}get xmc(){!this.PC&&this.TDd&&this.TDd.instance&&(this.PC=this.TDd.instance.instance);return this.PC}UPi(a,b,c,f){if(!b)return c;" "!==a.charAt(c)&&(c=a.lastIndexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.lastIndexOf(" ",c-1);if(c<=f)break;" "===a.charAt(c+1)&&l--}c=Math.max(c,f);return" "===a.charAt(c)?c+1:c}BPi(a,b,c,f){if(!b)return c;0<c&&" "!==a.charAt(c-1)&&(c=a.indexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.indexOf(" ",c+1);if(-1===c)break;
" "===a.charAt(c-1)&&l--}return c=-1===c?f:Math.min(c,f)}hRa(a){return a.properties.ta(ob.a.hRa,!1)}Q1f(a){a=db.ParagraphReader.text(a);let b;const c=[];for(;b=bm.Urj.exec(a);)Array.add(c,new qk.a(b.index+b[1].length,b.index+b[0].length));return c}R1f(a,b=!0,c=!1){let f=[],l=!1,w=!1,F=!1,S=!1,fa=-1;a=a.Ra;for(let Za=0;Za<a.length;Za++){var xa=a.ga(Za);xa.hyperlink?w=!0:xa.Im&&(w=!1);b&&xa.formatting&&(F=xa.formatting.cache.DRa);if(c&&(xa.GK&&(S=!1),xa.yp)){const pb=Object(ua.a)(266,xa.yp.Gh);pb&&
(S=pb.vCa)}l!==(w||F||S||!!xa.blob)&&(xa=xa.cp,l?Array.add(f,new qk.a(fa,xa)):fa=xa,l=!l)}l&&(b=qk.a.createTextRange(fa,a.last.cp))&&Array.add(f,b);return f}gLc(a,b=!0,c=!1){return ll.e(this.Q1f(a),this.R1f(a,b,c))}VYb(a,b,c){if(b===a.length)for(;0<b&&" "===a.charAt(b-1);)b--;b=a.lastIndexOf(" ",b-1)+1;c=a.indexOf(" ",c);0>c&&(c=a.length);return qk.a.createTextRange(b,c)}FNc(a,b,c,f){if(!c||""===c||0>a||a>=b||b>c.length)return null;f=f||[];a=bm.Z5f(a,b,c);for(var l=0;l<f.length;l++){var w=f[l];if(a<
w.begin)break;a<w.end&&(a=bm.Z5f(w.end,b,c))}b=bm.y8f(b,c);for(l=f.length-1;0<=l;l--){w=f[l];if(b>w.end)break;b>w.begin&&(b=bm.y8f(w.begin,c))}return(a=qk.a.createTextRange(a,b))&&a.ONj()?a:null}static Z5f(a,b,c){for(;a<b&&Ja.a.vy(c.charCodeAt(a));)a++;return a}static y8f(a,b){for(;0<a&&bm.EAj(a,b);)a--;return a}static EAj(a,b){a=b.charAt(a-1).toString();return a===Wc.AParagraphNode.nHc||a===Wc.AParagraphNode.VY}}bm.Urj=RegExp("(^| )(?:[a-z+.-]+://\\S+|[a-z]:[/\\\\]\\S+|\\\\\\\\\\S+|mailto:\\S+)",
"ig");Object(e.a)(bm,"ProofingTextUtility",null,[1346]);class zo{constructor(){this.Ea=null}get name(){return"Box4.Proofing"}Yb(a){this.Ea=a;this.Ea.register(ip,"Box4.Proofing.ErrorRangeEditor").as("Box4.Proofing.IErrorRangeEditor").ma().na(()=>new ip(this.Ea.resolve("Box4.IParagraphReader"),I.a.instance.ga(14),I.a.instance.ga(70)));this.Ea.register(Jp,"Box4.Proofing.ModifiedRangeEditor").as("Box4.Proofing.IModifiedRangeEditor").ma().na(()=>new Jp(this.Ea.resolve("Box4.Proofing.IErrorRangeEditor"),
this.Ea.resolve("Box4.Proofing.IProofingTextUtility"),this.Ea.resolve("Box4.ISelectionManager"),this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa.ka("MinimizeProofedRangesIsEnabled"),u.AFrameworkApplication.fa.ka("ProofingSetCentralWordRangeIsEnabled")));this.Ea.register(bq,"Box4.Proofing.UnsupportedLanguageRangeEditor").as("Box4.Proofing.IUnsupportedLanguageRangeEditor").ma().na(()=>new bq);this.Ea.register(Be,"Box4.Proofing.ModifiedExpandRangeHelper").as("Box4.Proofing.IModifiedExpandRangeHelper").ma().na(()=>
new Be(Qo.a.instance,this.Ea.resolve("Box4.Proofing.IProofingTextUtility"),this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Ea.Oa("Box4.Proofing.IProofingSentenceSeparator")));this.Ea.register(Iq,"Box4.Proofing.ParagraphProofingFacade").as("Box4.Proofing.IParagraphProofingFacade").ma().na(()=>new Iq(this.Ea.resolve("Box4.Proofing.IErrorRangeEditor"),this.Ea.resolve("Box4.Proofing.IModifiedRangeEditor"),this.Ea.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),this.Ea.resolve("Box4.Graph.IGraphIteratorFactory"),
this.Ea.resolve("Box4.ILanguageReader"),this.Ea.resolve("Box4.Proofing.IModifiedExpandRangeHelper"),this.Ea.resolve("Box4.Proofing.IProofingTextUtility"),pg.a.instance,this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Ea.Oa("Box4.Proofing.IProofingSentenceSeparator")));this.Ea.register(bm,"Box4.Proofing.ProofingTextUtility").as("Box4.Proofing.IProofingTextUtility").ma().na(()=>new bm(this.Ea.Oa("Box4.TrackChange.ITrackChangeManagerFactory"),this.Ea.Oa("Box4.TrackChange.ITrackChangeReaderFactory")));
const b=()=>{const c=u.AFrameworkApplication.fa.Ia("ProofingWebServiceBase");return(void 0===c?gb.App.webServiceBase:c)+"proofing.ashx?"+u.AFrameworkApplication.$g};this.Ea.register(Ip,"Box4.Proofing.EditorServiceRequestManager").as("Box4.Proofing.IEditorServiceRequestManager").ma().na(()=>new Ip(u.AFrameworkApplication.Be,b));this.Ea.register(am,"Box4.Proofing.ProofingLanguageInfoManager").as("Box4.Proofing.IProofingLanguageInfoManager").ma().na(()=>new am(this.Ea.resolve("Box4.Proofing.IEditorServiceRequestManager"),
cd.a.instance));this.Ea.register(Lp,"Box4.Proofing.ProofingFeedbackLoopManager").as("Box4.Proofing.IProofingFeedbackLoopManager").ma().na(()=>new Lp(this.Ea.resolve("Box4.Proofing.IEditorServiceRequestManager"),cd.a.instance,this.Ea.resolve("Box4.Proofing.IProofingDescriptors")));this.Ea.register(Kq,"Box4.Proofing.ProofingFeatureConfiguration").as("Box4.Proofing.IProofingFeatureConfiguration").ma().na(()=>new Kq(u.AFrameworkApplication.fa,this.Ea.Oa("Box4.Proofing.IProofingSentenceSeparator")));this.Ea.register(1292,
"Box4.Proofing.IProofingDescriptors").ma().na(()=>new aq(u.AFrameworkApplication.fa,this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.Ea.register(xd,"Box4.Proofing.ProofingCheckOperator").as("Box4.Proofing.IProofingCheckOperator").ma().na(()=>new xd(this.Ea.resolve("Box4.Proofing.IErrorRangeEditor"),this.Ea.resolve("Box4.Proofing.IModifiedRangeEditor"),u.AFrameworkApplication.fa,gb.App.Fb,u.AFrameworkApplication.Be,this.Ea.resolve("Box4.Graph.IGraphTransactionFactory"),ni.a.instance,
this.Ea.resolve("Box4.Graph.IGraphIteratorFactory"),this.Ea.resolve("Box4.Proofing.IProofingTextUtility"),this.Ea.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),b,Ro.a.kV(4,1,new jr),this.Ea.resolve("Box4.Proofing.IProofingResultsManagerResolver"),this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Ea.resolve("Box4.Proofing.IParagraphProofingFacade"),this.Ea.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Ea.resolve("Box4.Proofing.IProofingDescriptors"),this.Ea.resolve("Box4.Proofing.IProofingConfigV2Manager"),
this.Ea.Oa("Box4.Proofing.ICritiqueTypeSettings"),Oc.a.get_instance(),u.AFrameworkApplication.ve));this.Ea.register(eo,"Box4.Proofing.ProofingResultsManager").ma().na(()=>new eo(this.Ea.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>")));this.Ea.register(1293,"Box4.Proofing.IIgnoreAllKeywords").ma().na(()=>new lr);this.Ea.register(Bk,"Box4.Proofing.ProofingCheckResultsManager").ma().na(()=>new Bk(this.Ea.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),
this.Ea.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa));this.Ea.register(1294,"Box4.Proofing.IProofingResultsManagerResolver").ma().na(()=>new Mp(u.AFrameworkApplication.fa,this.Ea.resolve("Box4.Proofing.ProofingResultsManager"),this.Ea.qe("Box4.Proofing.ProofingCheckResultsManager")));this.Ea.register(1295,"Box4.IProofingManager").ma().na(()=>new Ck(this.Ea.resolve("Box4.Proofing.IModifiedRangeEditor"),
this.Ea.resolve("Box4.IParagraphEditor"),this.Ea.resolve("Box4.IAppFrame"),this.Ea.resolve("Box4.Proofing.IProofingCheckOperator"),this.Ea.qb("Box4.INotebookManager").$T,this.Ea.qb("Box4.Proofing.IErrorRangeEditor"),4!==gb.App.mode));this.Ea.register(1296,"Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>").ma().na(()=>new $s(u.AFrameworkApplication.fa.ka("ProofingTrackMetricsIsEnabled"),Ro.a.kV(15,1,new kr)));this.Ea.register(1297,"Box4.Proofing.IProofingConfigV2Manager").ma().na(()=>
new Jq(this.Ea.resolve("Box4.Proofing.IEditorServiceRequestManager"),cd.a.instance,this.Ea.resolve("Box4.Proofing.IProofingDescriptors"),this.Ea.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Ea.resolve("Box4.Proofing.IProofingCritiqueCategoryInfoFilter")))}init(){this.Ea.resolve("Box4.IProofingManager")}dispose(){}static main(){m.a.instance.Ec(new zo)}}Object(e.a)(zo,"Box4ProofingPackage",null,[2,3]);var yh=d(170);class jk{constructor(a){this.tPe=0;this.m7a=this.wDb=this.ogb=null;this.b$=
u.AFrameworkApplication.Ba.aU;this.NP=a;this.NP.Qt(Xe.a.ejh);this.NP.cB(Xe.a.ejh,Object(C.a)(this,this.ykk,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.m7a)return Z.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.m7a;this.ogb=this.b$.wi("ComponentAttach","getCustomAuthConfig");return this.m7a=new Promise((a,b)=>{const c={};let f=!1,l=!1,w=0;this.tPe=window.setInterval(()=>{4>w?(w++,this.NP.sendMessage(Xe.a.getCustomAuthConfig,c)):(window.clearInterval(this.tPe),
f=!0,Z.ULS.sendTraceTag(588087303,344,10,md.c({["error"]:"Request timeout after 4 retries."})),b("Request timeout."))},1E3);this.wDb=(F,S)=>{window.clearInterval(this.tPe);f||l||(l=!0,F?(Z.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),a(F)):(Z.ULS.sendTraceTag(589050654,369,10,md.c({["error"]:S.toString()})),b(S)))};this.NP.sendMessage(Xe.a.getCustomAuthConfig,c)})}ykk(a){try{const b=md.a(a.Values[yh.a.Qfi]);let c=u.AFrameworkApplication.fa.Ia("Application")||"";c=Ja.a.vg(c);
b.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";b.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";this.ogb&&(this.ogb.stop(),this.ogb=null);this.wDb(b,"")}catch(b){Z.ULS.sendTraceTag(589050655,344,10,md.c({["error"]:b.message,["stack"]:b.stack})),
this.wDb(null,b.message)}}}Object(e.a)(jk,"AccountSwitchingManager",null,[1385]);class Ao{get name(){return"Common.App.AccountSwitching"}Yb(a){a.register(jk,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ma().na(()=>new jk(a.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){m.a.instance.Ec(new Ao)}}Object(e.a)(Ao,"AccountSwitchingPackage",null,[2,3]);class Lq{constructor(){this.Ta=new sd.a}yzc(a){this.Ta.addHandler("OnEditHappenedEvent",
a)}dNk(a){this.Ta.removeHandler("OnEditHappenedEvent",a)}ZBk(){this.Ta.raiseEvent("OnEditHappenedEvent")}}Object(e.a)(Lq,"EditNotificationEventSource",null,[]);var qf=d(104);class at{constructor(a,b,c,f,l,w,F=0){this.ord=!1;this.nrd=this.L0a=null;this.dyf=!1;this.Md=b;this.kuc=a;this.GKa=c;this.rfa=f;this.byf=l;this.nJh=w;this.Fqc=0;this.Frc=!1;try{0<F&&(this.Fqc=F,3E5>this.Fqc&&(this.Fqc=3E5),this.Md&&!this.nrd&&(this.nrd=new Se.a(3,2,this.Fqc,Object(C.a)(this,this.TPk,"reportEditDocumentUserActionTelemetryIfNecessary")),
this.Md.Hb(this.nrd)))}catch(S){Z.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+S)}}get qvl(){return this.dyf}sSd(){this.qvl?this.Frc=!0:(this.dyf=!0,Mf.Health.instance.addQosPillar("Save"),Mf.Health.instance.addQosPillar("ContentCreation"),qf.c(G.a.editDocument));this.ord=!0;this.byf&&this.byf.Gzf();this.rfa&&this.rfa.ZBk();u.AFrameworkApplication.Qg&&u.AFrameworkApplication.Qg.j9j();this.nJh&&!this.L0a&&(this.$ic(null),
this.L0a=new Se.a(3,2,this.kuc,Object(C.a)(this,this.$ic,"sendPostMessageIfNecessary"),113),this.Md.Hb(this.L0a))}$ic(){this.ord&&(this.GKa.CWR(()=>this.GKa.result.sendMessage(Xe.a.editNotification,null)),Z.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.ord=!1)}TPk(){try{this.Frc&&(qf.c(G.a.editDocument),this.Frc=!1)}catch(a){this.Frc=!1,Z.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+a)}}}
Object(e.a)(at,"EditNotificationManager",null,[650]);class es{constructor(a,b,c,f,l){this.Osd=this.L0a=null;this.Fjb=this.Lnd=!1;this.Md=b;this.kuc=a;this.GKa=c;this.NO=f;this.myd=l;this.Z$g(null)}Z$g(){const a=document.getElementById(u.AFrameworkApplication.$Sb);!this.Fjb&&this.NO&&a&&(this.NO.pb(ra.a.Is,a,Object(C.a)(this,this.Ore,"mouseActivityHandler"),null),this.Fjb=!0);this.myd(()=>{this.dispose()})}Ore(){this.Fjb&&(this.NO.zb(ra.a.Is,document.getElementById(u.AFrameworkApplication.$Sb),Object(C.a)(this,
this.Ore,"mouseActivityHandler")),this.Fjb=!1);this.Gzf();return!1}Gzf(){this.Lnd=!0;this.Osd||(this.Osd=new Se.a(3,2,this.kuc,Object(C.a)(this,this.Z$g,"registerHandlerTask"),112),this.Md.Hb(this.Osd));this.L0a||(this.$ic(null),this.L0a=new Se.a(3,2,this.kuc,Object(C.a)(this,this.$ic,"sendPostMessageIfNecessary"),111),this.Md.Hb(this.L0a))}$ic(){this.Lnd&&(this.GKa.CWR(()=>this.GKa.result.sendMessage(Xe.a.evl,null)),Z.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),
this.Lnd=!1)}dispose(){this.Fjb&&(this.NO.zb(ra.a.Is,document.getElementById(u.AFrameworkApplication.$Sb),Object(C.a)(this,this.Ore,"mouseActivityHandler")),this.Fjb=!1)}}Object(e.a)(es,"UserActivityHostNotificationManager",null,[649,109]);var Im=d(137),or=d(286);class Np{constructor(){this.Ea=null}get name(){return"Common.App.EditNotification"}init(){u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.gf(Object(C.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){Np.HHi&&0<Np.tSd&&(this.Ea.register(Lq,
"Common.App.HostNotification.EditNotificationEventSource").ma(),this.Ea.register(es,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ma().na(()=>new es(6E4,Im.a.instance,or.a.su(this.Ea.Oa("Postmessage.IHostPostmessenger")),ia.a.instance,u.AFrameworkApplication.Aea)),this.Ea.register(at,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ma().na(()=>new at(Np.tSd,Im.a.instance,
or.a.su(this.Ea.Oa("Postmessage.IHostPostmessenger")),this.Ea.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Ea.qb("Common.Interface.IUserActivityHostNotificationManager"),Np.IHi,Np.FHi)),this.Ea.resolve("Common.Interface.IEditNotificationManager"),Z.ULS.shipAssertTag(38086291,209,0<Np.tSd,"EditNotification Interval is less than or equal to 0."))}Yb(a){this.Ea=a}dispose(){}static get tSd(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||
"300000"):3E5}static get FHi(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get HHi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationIsEnabled")}static get IHi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationPostMessageIsEnabled")}static main(){m.a.instance.Ec(new Np)}}Object(e.a)(Np,"CommonHostNotificationPackage",
null,[2,3]);class cn{}cn.J4c="ReactSharedHeaderMeControlFlexPane";cn.MQa="headerui";cn.yUb="chat_wrapper_pane";Object(e.a)(cn,"ReactSharedHeaderConstants",null,[]);class bt{constructor(a){this.Fpf=0;this.xpd=null;this.KRh=a}get chat(){return window.swc}get isInitialized(){return!!this.chat}get JJe(){return this.KRh.value}wb(){this.isInitialized?this.Wbd():this.lJk(Object(C.a)(this,this.Wbd,"registerActionsInternal"))}Wbd(){Z.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&
(this.chat.getContainerProvider().then(a=>{a.getChatsContainer(Object(C.a)(this,this.Bfk,"onChatContainerReady"))}).catch(a=>{Z.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",a)}),this.chat.getChatsCounter().then(a=>{a.onChatsCountChange(Object(C.a)(this,this.Qii,"chatCountChanged"))}).catch(a=>{Z.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",a)}),this.chat.getKeyboard().then(a=>{a.onKeyDown(Object(C.a)(this,this.Efk,"onChatKeyPress"))}).catch(a=>
{Z.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",a)}))}catch(a){Z.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",a)}}Qii(a){Z.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",a);if(!a)this.JJe.Afk();else if(1===a&&!this.Fpf){const b=document.getElementById(this.xpd?this.xpd:cn.yUb);b?this.JJe.Ffk(b,Object(C.a)(this,this.lll,"transferFocusToChat")):Z.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.Fpf=a}Bfk(a){this.xpd=a}Efk(a){a.ctrlKey&&
"f6"===a.key.toLowerCase()&&this.kll(a.shiftKey)}lJk(a){Od.a.instance.pb(ra.a.ggl,window.self,()=>{a();return!0})}lll(){Z.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(a=>{a.focusConversationInput()}).catch(a=>{Z.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",a)})}catch(a){Z.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",a)}}kll(a){Z.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");
this.JJe.Cfk(a)}}Object(e.a)(bt,"ChatManager",null,[652]);class Lv{constructor(){this.Ta=new sd.a;this.Uwf=!1}q3h(a){this.Ta.addHandler("OnTopRowControlsCreatedEvent",a)}X2h(a){this.Ta.addHandler("OnRenameTextboxStatusChangedEventKey",a)}get Dkl(){return this.Uwf}OCk(){this.Uwf=!1;this.Ta.raiseEvent("OnTopRowControlsDisposingEvent")}Q8g(a){this.Ta.raiseEvent("OnRenameTextboxStatusChangedEventKey",a?"true":"false")}}Object(e.a)(Lv,"HeaderEventSource",null,[]);var ou=d(196);class pu{constructor(a,b,
c,f,l){this.Mxc=null;this.Kd=a;this.C5=b;this.NO=c;this.GVh=f;this.Da=l}Y$g(a,b,c,f=null){const l=this.Kd.Bc(b);l.parent=c;l.HK=!0;f&&l.vaa(f);this.NO.i6(b,a,!1);this.GVh.i6(b,a,!1);b=new ou.DOMFocusListing(()=>a);b.ho(2);b.ho(1);b.ho(8);b.ho(5);b.ho(3);b.ho(6);this.Kd.Sga(()=>a,l,b).CS=!0;b=A.KeyInputManager.La(x.a.tq,0);c=A.KeyInputManager.La(x.a.tq,4);l.Wo(b);l.Wo(c)}onFlexPaneOpen(a){this.Y$g(a,cn.J4c,cn.MQa);this.Kd.vf(cn.J4c);this.C5.q1(cn.J4c)}onFlexPaneClose(){this.C5.ap(cn.J4c);this.Kd.vf(cn.MQa)}Ffk(a,
b){this.Mxc||(this.Mxc=b,this.Y$g(a,cn.yUb,y.AFrame.VC,Object(C.a)(this,this.Dfk,"onChatFocus")));this.Kd.vf(cn.yUb);this.C5.q1(cn.yUb)}Dfk(){this.Mxc&&this.Mxc()}Afk(){this.C5.ap(cn.yUb);this.Kd.EJc(y.AFrame.gV)}Cfk(a){this.Da.processAction(a?G.a.VTd:G.a.$md,2)}}Object(e.a)(pu,"ReactSharedHeaderFocusManager",null,[651]);var Vx=d(515);class Op{constructor(a){this.Da=a}wb(){this.Da.ya(G.a.QJc,de.a.frame,Object(C.a)(this,this.nTg,"navigateToUpsellPage"));this.Da.ya(G.a.aTi,de.a.frame,Object(C.a)(this,
this.launchUpsellExperience,"launchUpsellExperience"));this.Da.ya(G.a.ZPk,de.a.frame,Le.ActionManager.Dg);this.Da.ya(G.a.fdh,de.a.frame,Le.ActionManager.Dg)}nTg(a,b,c,f,l){if(1===c)return 32;a=8;2===c&&(c=this.KXd(l,"experience","gopremiumribbon"),l=Jf.a.oV("2116536"),l=Jf.a.x2a(l,"ocid",Vx.b(u.AFrameworkApplication.Ba.jb.vm,u.AFrameworkApplication.Ba.jb.vGa,c)),id.a.Qm(l,"_blank",void 0,"NavigateToUpsellPage"),a=32,this.Da.processAction(G.a.fdh,2),Z.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));
return a}launchUpsellExperience(a,b,c,f,l){if(1===c)return 32;var w=8;2===c&&(Z.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(w=lb.a.instance.qb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(a=this.KXd(l,"experience","gopremium"),l=this.KXd(l,"dimeCampaignId",null),w.launchUpsellExperience(a,l),w=32):(Z.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),w=this.nTg(a,b,c,f,l)));return w}KXd(a,b,c){a&&a[b]&&(c=Object(ua.a)(String,
a[b]));return c}}Object(e.a)(Op,"UpsellActor",null,[648]);class qu{constructor(){this.Ea=null}get name(){return"Common.App.Header"}init(){lb.a.instance.resolve("Common.App.Header.IUpsellActor").wb();lb.a.instance.resolve("Common.App.Header.IChatManager").wb()}dispose(){}Yb(a){this.Ea=a;this.Ea.register(Lv,"Common.App.Header.HeaderEventSource").ma();this.Ea.register(Op,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ma().na(()=>new Op(u.AFrameworkApplication.Va));this.Ea.register(pu,
"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ma().na(()=>new pu(u.AFrameworkApplication.Ba.vr,u.AFrameworkApplication.Ba.iw,u.AFrameworkApplication.Ba.RQ,u.AFrameworkApplication.Ba.Rgb,u.AFrameworkApplication.Va));this.Ea.register(bt,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ma().na(()=>new bt(this.Ea.qe("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){m.a.instance.Ec(new qu)}}Object(e.a)(qu,
"CommonAppHeaderPackage",null,[2,3]);class Mv{constructor(a,b,c,f=null,l=null){this.oE=a;this.FMb=b;this.CMb=c;this.Gif=f;this.zPb=l}cIc(a){const b=new Sys.StringBuilder(this.oE.ric);b.append("RoamingServiceHandler.ashx?action=");b.append("getFirstRunExperienceSettings");b.append("&");b.append(this.L_d(a));b.append("&");b.append(u.AFrameworkApplication.$g);u.AFrameworkApplication.Be.Jj(b.toString(),1,null,null,!0,2,Object(C.a)(this,this.$Ba,"getRequestSuccessCallback"),Object(C.a)(this,this.aia,"getRequestFailureCallback"),
null)}yqb(a){var b=new Sys.StringBuilder(this.oE.ric);b.append("RoamingServiceHandler.ashx?action=");b.append("saveFirstRunExperienceSettings");b.append("&");b.append(u.AFrameworkApplication.$g);b=b.toString();a=md.c(a);u.AFrameworkApplication.Be.Jj(b,2,a,null,!0,4,Object(C.a)(this,this.Duk,"postRequestSuccessCallback"),Object(C.a)(this,this.E9,"postRequestFailureCallback"),null)}$Ba(a){let b=!1,c=null;try{if(0<a.data.je.length){const f=Object(ua.a)(Object,md.a(a.data.je)),l=f?f[this.oE.pHd]:null;
l&&(c=Object(ua.a)(Object,md.a(l.toString())))}b=!0}catch(f){this.aia(null)}b&&this.FMb&&this.FMb(a.data,c)}aia(a){this.CMb&&this.CMb(a?a.data:null)}Duk(a){this.Gif&&this.Gif(a?a.data:null)}E9(a){this.zPb&&this.zPb(a?a.data:null)}L_d(a){const b=new Sys.StringBuilder("requestedsettings=");for(let c=0;c<a.count;c++)b.append(a.ga(c)),c<a.count-1&&b.append(";");return b.toString()}}Object(e.a)(Mv,"FirstRunExperienceRequestHandler",null,[]);var ru=d(389);class Nv{constructor(){this.lMb=this.irc=this.oE=
null}RKe(a){a?(this.oE=a,this.FGj()&&(Z.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),a=new Ua.a,a.add(this.oE.pHd),this.irc=new Mv(this.oE,Object(C.a)(this,this.$Ba,"getRequestSuccessCallback"),Object(C.a)(this,this.aia,"getRequestFailureCallback"),null,Object(C.a)(this,this.E9,"postRequestFailureCallback")),this.irc.cIc(a)),(this.oE.Pwg||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",
!1))&&this.SKe()):Z.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}FGj(){try{if(this.oE.Pwg)return!0;if(!u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||u.AFrameworkApplication.fa.ka("IsAnonymousUser"))return!1;if(this.oE.CCj||this.oE.rvb||u.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return!0;const a=u.AFrameworkApplication.fa.Ia("FlightId");return-1!==(a?a.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(a){Z.ULS.sendTraceTag(576582624,
306,10,"Error checking setting {0}",a?a.toString():null)}return!1}Bgh(a){const b={},c={};c.FREDisplayedDate=(new Date).toUTCString();c.VersionDisplayed=a;c.RemindMeLater=!1;b[this.oE.pHd]=md.c(c);Z.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.irc&&this.irc.yqb(b)}$Ba(a,b){a=a?+a.Eu-+a.wt:-1;a>this.oE.gfh?Z.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
a,this.oE.gfh):b?this.T8k(b)?(Z.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.oE.VRg),this.SKe()):(this.wRd(!1),Z.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(Z.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.SKe())}aia(a){this.wRd(!1);
Z.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",a?a.tf:-1)}E9(a){Z.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",a?a.tf:-1)}SKe(){this.wRd(!0);var a=lb.a.instance.qb("Common.ISystemInitiatedFeedback");a?this.Eoh(a):(Z.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((a=lb.a.instance.Oa("Common.ISystemInitiatedFeedback"))?a.execute(b=>{this.Eoh(b)}):Z.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}Eoh(a){if(a){var b=this.oE.tRi;b&&(u.AFrameworkApplication.Pj(b),u.AFrameworkApplication.tVc(b));Z.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",b);a.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.lMb=Object(C.a)(this,this.nhk,"onFirstRunExperienceCampaignEvent"),
window.addEventListener("FGWebSurfaceEvent",this.lMb,!0),window.addEventListener("FRELaunchedEvent",this.lMb,!0)):(Z.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.Bgh(this.oE.currentVersion))}else Z.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}nhk(a){if(a){var b=a.detail;a=a.type;var c=this.oE&&this.oE.kKf?this.oE.kKf.split("-")[0]:null;if("FRELaunchedEvent"===a||c&&b&&b.id&&-1!==b.id.indexOf(c))b.success&&(Z.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.Bgh(this.oE.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.lMb,!0),window.removeEventListener("FRELaunchedEvent",this.lMb,!0))}}T8k(a){if("RemindMeLater"in a&&"FREDisplayedDate"in a){if("true"===a.RemindMeLater.toString()&&(+new Date-+new Date(a.FREDisplayedDate.toString()))/36E5>this.oE.VRg)return!0}else if(u.AFrameworkApplication.fa.ka("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in a&&a.VersionDisplayed<this.oE.currentVersion)return Z.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}wRd(a){u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&ru.a.dispatch("FREDecisionEvent",{["show"]:a})}}Object(e.a)(Nv,"FirstRunExperienceLauncher",null,[617]);class su{constructor(){this.Ea=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Yb(a){this.Ea=
a;this.Ea.register(617,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ma().na(()=>new Nv)}init(){}dispose(){}static main(){m.a.instance.Ec(new su)}}Object(e.a)(su,"FirstRunExperienceLauncherPackage",null,[2,3]);class fs{constructor(){this.Ind={}}DXh(a){this.Ind[a.id.toString()]=a}ldk(a){const b=this.Ind;for(let c in b)b[c].notify(a,!1);this.Ind={}}gAk(a,b){b&&this.DXh(b);return this.AZg(a,b)}ASd(a){this.ldk(a)}tYf(a,b){a.notify(b,!0)}}Object(e.a)(fs,"AEventEmitter",null,[646]);
var gs;(function(a){a[a.notStarted=0]="notStarted";a[a.waiting=1]="waiting";a[a.shouldRetry=2]="shouldRetry";a[a.complete=3]="complete"})(gs||(gs={}));Object(e.b)("EventResultState",gs);class hs{constructor(){this._state=0}get state(){return this._state}set state(a){Z.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:gs[this._state],["NewState"]:gs[a]},"ResultType",this.Xbg());this._state=a}}Object(e.a)(hs,"AEventResult",null,[692]);class Wx extends hs{constructor(){super();
this.xCd=this.vPb=null;this.state=0;this.Wtd=this.t5e=!1}get AQ(){return this.vPb}get BIa(){return this.xCd}get fyj(){return this.t5e}Xbg(){return"GetMoreInfo Result"}}Object(e.a)(Wx,"GetMoreInfoResult",hs,[691,692]);var Ov=d(426),Pv=d(516);class jp{constructor(a,b,c,f,l,w,F,S){this.Da=a;this.Di=b;this.hH=c;this.n5=f;this.Md=l;this.BMb=w;this.hLh=F;this.exc=S}YHk(){this.lBb.ya(G.a.lCb,de.a.frame,Object(C.a)(this,this.lCb,"openUrlInNewTab"));this.lBb.ya(G.a.mwe,de.a.frame,Object(C.a)(this,this.mwe,
"openDocumentUrl"));u.AFrameworkApplication.bba?this.lAg():this.lBb.ra(G.a.SGc,de.a.frame,Object(C.a)(this,this.SGc,"documentLoaded"),96)}lCb(a,b,c,f,l){l&&l.MenuItemId&&(Z.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:Pv.a[this.Kua]}),id.a.Qm(l.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}mwe(a,b,c,f,l){if(l&&l.MenuItemId){const w=u.AFrameworkApplication.fa.ka("WacInTabOpenMRUIsEnabledForUiHost"),F=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");
Z.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",w,F);if(w&&F){Z.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:Pv.a[this.Kua]});a=l.MenuItemId.toString();const S={};S[yh.a.SDb]="1";S[yh.a.documentUrl]=a;S[yh.a.reason]=Ov.a.open;Z.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");u.AFrameworkApplication.tV().execute(fa=>{fa.sendMessage(Xe.a.TAa,S)})}else this.lCb(a,
b,c,f,l)}return 32}SGc(){this.lAg();return 32}Dsa(a,b,c=""){if(b&&b.wt){const f=Vm.a[b.status];b=b.wt.getTime();const l=this.LE()-b;Z.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:a,["RequestStatus"]:f,["ElapsedMs"]:l,["StartTime"]:b,["Notes"]:c})}else Z.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:a})}lAg(){var a=u.AFrameworkApplication.fa.ka("QPGVCI"),b=Jf.a.rV(document.URL,"wdNewAndOpenCt",
a);if(b){b=parseInt(b);var c=Jf.a.rV(document.URL,"wdPreviousSession",a);a=Jf.a.rV(document.URL,"wdPreviousCorrelation",a);var f=u.AFrameworkApplication.fa.ka("NAOPLP");if(u.AFrameworkApplication.bba){var l=u.AFrameworkApplication.bba.getTime();!b||b>l?Z.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:b,["DocumentLoadedTime"]:l,["SessionId"]:c,["Correlation"]:a}):Z.ULS.sendTraceTag(5849683,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",
{["ClickToLoadTime"]:l-b,["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}else Z.ULS.sendTraceTag(5849681,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}}get lBb(){return this.Da.value}get dcc(){return this.Di.value}get tTg(){return this.hH.value}get Kua(){return this.n5.value}get x5c(){return this.Md.value}get LE(){return this.BMb}get tda(){return this.hLh.value}get EIa(){return this.exc.value}static get instance(){return jp.Ka||
(jp.Ka=jp.Xq())}static Xq(){return new jp(new sc.a(()=>u.AFrameworkApplication.Va),new sc.a(()=>u.AFrameworkApplication.Be),new sc.a(()=>u.AFrameworkApplication.Ba),new sc.a(()=>u.AFrameworkApplication.Ba.jb.vm),new sc.a(()=>u.AFrameworkApplication.ve),()=>(new Date).getTime(),new sc.a(()=>u.AFrameworkApplication.Ba.jb.tda),new sc.a(()=>u.AFrameworkApplication.EIa))}}jp.Ka=null;Object(e.a)(jp,"NewAndOpenCommonHelpers",null,[645]);class tu{constructor(a,b,c){this.xwc=this.Am=null;this.CAd=0;this.$Sh=
a;this.Md=b;this.cZe=c}V5h(){this.CAd=this.NEb+1}IEe(a){this.Am&&(this.Md.ah(this.Am),this.Am=null);a&&(this.CAd=0)}gel(a){const b=this.Gjl;0<=b?(this.V5h(),this.IEe(!1),this.Am=new Se.a(4,1,b,a,107),this.Md.Hb(this.Am)):(this.IEe(!0),Z.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.cZe}))}get NEb(){return this.CAd}get Gjl(){return this.NEb>=this.sih.length?-1:this.sih[this.NEb]}get sih(){if(!this.xwc){const a=(this.$Sh.value||"0").split(",");this.xwc=[];for(let b=0;b<a.length;b++){const c=
parseInt(a[b]);isNaN(c)?Z.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.cZe,["Entry"]:a[b]}):Array.add(this.xwc,c)}}return this.xwc}}Object(e.a)(tu,"RetryHelper",null,[]);class dn extends fs{constructor(a,b){super();this.Pfa=a;this.$Pb=new tu(b,this.Ibc.x5c,"GetMoreInfo");this.lx=new Wx}H8j(){this.Vqe("Document opened")}Pwi(a){return()=>{this.Vqe(a,!0)}}AZg(a,b=null){Z.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",
{["Trigger"]:a});3===this.lx.state?(b&&this.tYf(b,this.lx),Z.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:a})):this.Vqe(a);return this.lx}Vqe(a,b=!1){this.$Pb.IEe(!b);1===this.lx.state?Z.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:a,["RetryIndex"]:this.$Pb.NEb}):(Z.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:a,["RetryIndex"]:this.$Pb.NEb}),this.lx.state=1,b=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.Ibc.tda,u.AFrameworkApplication.$g),this.Ibc.dcc.wY(b,1,null,null,[dn.qgf,dn.qvf],5,this.Svi(),this.Rvi(a),null))}Svi(){return a=>{var b=!1;let c=!1;var f=!1,l;u.AFrameworkApplication.fa.ka("GetMoreInfoDataFromResponseBody")&&(a.data.je?({Ev:l}=md.d(a.data.je)).returnValue?l?(f=!0,this.lx.xCd=l.StorageServiceDisplayName,this.lx.vPb=dn.rxg(l.PersonalFileStorageUrl)?l.PersonalFileStorageUrl:"",""===this.lx.AQ&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ia("FileSource")&&(this.lx.vPb=
Jf.a.ema(u.AFrameworkApplication.breadcrumbFolderUrl)),b=""===this.lx.AQ&&""!==this.lx.BIa):Z.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):Z.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):Z.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));
f||((l=a.data.lj)?(this.lx.xCd=(l[dn.qvf]||"").toString(),b=(l[dn.qgf]||"").toString(),this.lx.vPb=dn.rxg(b)?b:"",""===this.lx.AQ&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ia("FileSource")?(this.lx.vPb=Jf.a.ema(u.AFrameworkApplication.breadcrumbFolderUrl),b=""===this.lx.AQ&&""!==this.lx.BIa):b=""===b&&""!==this.lx.BIa):(Z.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),c=!0));f=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.$Pb.NEb,c,b,f);this.Ibc.Dsa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",a.data,f);this.Fih(3,b,c)}}Rvi(a){return b=>{this.Ibc.Dsa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",b.data,"Failure");this.Fih(2);this.$Pb.gel(this.Pwi(a))}}Fih(a,b=!1,c=!1){this.lx.state=a;this.lx.t5e=b;this.lx.Wtd=c;this.ASd(this.lx)}get Ibc(){return this.Pfa.value}static get instance(){return dn.Ka||(dn.Ka=dn.Xq())}static Xq(){return new dn(new sc.a(()=>jp.instance),new sc.a(()=>u.AFrameworkApplication.B5i))}static rxg(a){if(!a)return Z.ULS.sendTraceTag(5849624,
202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(Ja.a.vg(a).startsWith("https://"))return!0;Z.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}dn.qgf="PersonalFileStorageUrl";dn.qvf="StorageServiceDisplayName";dn.Ka=null;Object(e.a)(dn,"GetMoreInfoActor",fs,[]);class kp{constructor(a,b,c,f,l){this.JLh=6E4;this.Akg="inactive";this.yzf="active";this.Ifa=!0;this.Md=a;this.KKh=b;this.BMb=c;this.Fxc=f;this.Ta=new sd.a;l&&this.Ydl();this.cbf=this.p$f()}kFd(a){this.Ta.addHandler(this.yzf,
a)}YZh(a){this.Ta.addHandler(this.Akg,a)}Ydl(){const a=new Se.a(5,2,this.JLh,Object(C.a)(this,this.Tsj,"inactiveLoop"),108);this.Usj.Hb(a)}Tsj(){const a=this.p$f(),b=this.LE()-a;b>this.Qjd&&this.Ifa&&(Z.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:b}),this.Ifa=!1,this.Ta.raiseEvent(this.Akg));a-this.cbf>this.Qjd&&(this.Ifa=!0,this.Ta.raiseEvent(this.yzf));this.cbf=a}get Usj(){return this.Md.value}get p$f(){return this.KKh}get LE(){return this.BMb}get Qjd(){return this.Fxc.value}static get instance(){return kp.Ka||
(kp.Ka=kp.Xq())}static Xq(){return new kp(new sc.a(()=>Im.a.instance),()=>u.AFrameworkApplication.ebe.getTime(),()=>(new Date).getTime(),new sc.a(()=>u.AFrameworkApplication.Qjd),!0)}}kp.Ka=null;Object(e.a)(kp,"InactivityManager",null,[]);var ct=d(894);class dt extends hs{constructor(){super();this.hPh=this.Ldf=this.Kdf=null;this.state=this.Qwf=0;this.Wtd=!1}get pse(){return this.Kdf}get USg(){return this.Ldf}get Jjl(){return this.Qwf}Xbg(){return"MruActor Result"}}Object(e.a)(dt,"MruResult",hs,[693,
692]);var Pp=d(180);class et{constructor(a,b,c){this.task=null;this.z7a=a;this.s$j=b;this.taskManager=c;this.retryCount=this.C2b=0;this.xzd=this.e5b=null}vIj(a,b){return a===Pp.a.$Vd||20===b||18===b||3===b}XJj(a){return 3===a||5===a||6===a||7===a||9===a||10===a||11===a||12===a||13===a||14===a||15===a||16===a||23===a||26===a||27===a||28===a}get K$c(){return this.xzd}reset(){this.C2b=this.retryCount=0;this.xzd=this.e5b=null;this.task&&(this.taskManager.ah(this.task),this.task=null)}Kwj(a,b,c,f){this.xzd=
String.format("{0}_{1}",c,f);if(this.retryCount>=this.s$j)return Z.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.vIj(c,f))return Z.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.XJj(f)&&1<=this.C2b)return this.e5b=c,!1;b=Math.max(b,this.z7a*Math.pow(2,this.C2b));if(26===f)b=Math.max(b,3E4);else if(27===f||28===f)b=Math.max(b,6E4);9===f||412===c&&(null==this.e5b||412!==this.e5b)?b=500:this.C2b+=1;this.e5b=c;this.retryCount+=1;this.task&&
this.taskManager.ah(this.task);Z.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",b);this.task=new Se.a(2,1,b,a,107);this.taskManager.Hb(this.task);return!0}}Object(e.a)(et,"RetryManager",null,[]);var Mq=d(214),Pg=d(76);class cq{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(e.a)(cq,"WriteOptions",null,[]);class om extends fs{constructor(a,b,c,f,l,w,F){super();this.Pfa=a;this.oOh=b;this.QLa=new et(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.qF.x5c);this.xMa=new et(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.qF.x5c);this.ORh=c;this.Yyf=f;this.YWh={};this.O5=new dt;this.GKh=l;this.buc="";this.iE=w;this.F0e=F;this.PRh=u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",
25)}get Smd(){return this.YWh}eKk(){this.qF.lBb.ya(G.a.uch,de.a.frame,Object(C.a)(this,this.EOk,"renameMruEntry"))}EOk(){return this.cUe("Rename")}R8j(){this.DQg("File Opened")}S8j(){this.DQg("IntervalUpdate")}DQg(a){Z.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:a});this.cUe(a)}nV(a){(a=Ja.a.nV(a))&&a.startsWith(".")&&(a=a.substring(1,a.length));return a}K5f(){switch(this.qF.Kua){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}Sej(a){var b=this.GKh();if(!b)return null;const c=new cq;c.documentUrl=this.F0e.value?encodeURI(b):b;c.mruItemId=this.buc;c.app=this.K5f();if(b=this.iE())c.folderName=b.breadcrumbFolderName,b=b.nx,c.documentName=Ja.a.jG(b),c.documentExt=this.nV(b);a&&(c.documentName?c.documentName.length?255<=c.documentName.length?a.set("DocumentNameLength","Long"):2084<=c.documentName.length&&a.set("DocumentNameLength","VeryLong"):a.set("DocumentNameLength","0"):a.set("DocumentNameLength",
"Null"));return JSON.stringify(c)}cUe(a,b=!1){if(4===this.qF.Kua&&!u.AFrameworkApplication.RGc)return 2;var c=Mq.a.oz();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"),c.set("MruIdSent",this.buc?"true":"false"),c.set("URLEncoded",this.F0e.value?"true":"false"));Mf.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",c);a=this.Sej(c);if(!a)return b=!u.AFrameworkApplication.Ghb,c&&(c.set("WebEditingIsEnabled",u.AFrameworkApplication.Ghb?"true":"false"),c.set("ProtectedFile",u.AFrameworkApplication.DQ?
"true":"false")),Mf.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",b,!1,Object.assign(new pk.a,{extendedProperties:c})),2;this.xMa&&!b&&this.xMa.reset();c=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.qF.tda,this.Pbe);this.Yyf?this.Smd["X-FileId"]=u.AFrameworkApplication.$g:c+=String.format("&{0}",u.AFrameworkApplication.$g);u.AFrameworkApplication.Zc&&(this.Smd["X-Office-AudienceGroup"]=Object(ua.a)(String,u.AFrameworkApplication.Zc.AudienceGroup)||"");this.Smd["X-Timeout"]=
15E3;return this.qF.dcc.Jj(c,2,a,this.Smd,!0,5,Object(C.a)(this,this.Qyl,"writeMruV2EntryOnServerSuccessCallback"),Object(C.a)(this,this.nAi,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}Qyl(a){this.Kgg(a.data)}Kgg(a){const b=Mq.a.oz();this.xMa&&(b&&this.xMa.K$c&&(b.set("LastError",this.xMa.K$c),b.set("NumRetries",this.xMa.retryCount.toString())),this.xMa.reset());const c=ct.c(a.je);c&&c.diagnostics_data&&(this.buc=c.diagnostics_data.mru_id);a=+a.Eu-+a.wt;b&&
b.set("RequestDuration",a.toString());Mf.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new pk.a,{extendedProperties:b}))}nAi(a){if(a.data.tf===Pp.a.sWb)this.Kgg(a.data);else{var b=a.data.tf===Pp.a.qfc,c=Mq.a.oz();this.ghg(this.xMa,a,this.bAi(),c);c&&(c.set("StatusCode",a.data.tf.toString()),b||this.uFd(a.data,c));Mf.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",a.data.tf),b,!1,Object.assign(new pk.a,{extendedProperties:c}))}}bAi(){return()=>{this.cUe("Retry",
!0)}}H5i(){this.HAb("Polling")}G5i(){this.HAb("Retry",!0)}L8j(){this.HAb("Open")}K8j(){this.HAb("Activity")}J8j(){this.HAb("OpenRecentLinks",!1,!0)}I8j(){this.HAb("ActivityRecentLinks",!1,!0)}HAb(a,b=!1,c=!1){Z.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:a});const f=Mq.a.oz();f&&(f.set("Trigger",a),f.set("IsRetry",b?"true":"false"),c&&f.set("RecentLinks","true"));Mf.Health.instance.recordKpiUsage("GetMru",0,"smartfio",f);this.QLa&&!b&&this.QLa.reset();c?this.kRf(Object(C.a)(this,
this.I5i,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(C.a)(this,this.E5i,"getMruForRecentLinksFromServerFailureCallback"),!0):this.kRf(Object(C.a)(this,this.J5i,"getMruV2FromServerSuccessCallback"),Object(C.a)(this,this.F5i,"getMruFromServerFailureCallback"))}uFd(a,b){a&&a.lj&&(a=a.lj["X-CorrelationId"])&&b.set("ServerCorrelationId",a)}$Tj(a,b){a&&(b&&b.set("RequestDuration",(+a.Eu-+a.wt).toString()),Mf.Health.instance.recordKpiSuccess("GetMru",Object.assign(new pk.a,{extendedProperties:b})))}J5i(a){this.dag(a)}dag(a,
b=!1){var c="";let f=null,l=null,w=null;const F=ct.c(a.data.je);F&&(f=F.places?F.places.items:[],l=F.documents?F.documents.items:[],(w=ct.a(F,b))&&(c=md.c(w)));u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.qDa&&Pg.c()&&!b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(c,!0));c=Mq.a.oz();this.QLa&&(c&&this.QLa.K$c&&(c.set("LastError",this.QLa.K$c),c.set("NumRetries",this.QLa.retryCount.toString())),this.QLa.reset());b&&c&&c.set("RecentLinks","true");w||f||l?(b?this.qF.Dsa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
a.data,"Success"):this.qF.Dsa("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Success"),this.Hld(3,w,f,l),this.$Tj(a.data,c)):(b?this.qF.Dsa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",a.data,"Failure: Invalid JSON"):this.qF.Dsa("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Failure: Invalid JSON"),c&&this.uFd(a.data,c),Mf.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new pk.a,{extendedProperties:c})),this.Hld(3,null,null,null,!0));this.ASd(this.O5)}I5i(a){this.dag(a,
!0)}ghg(a,b,c,f){let l=0,w=0;const F=ct.c(b.data.je);F&&(null!=F.response_code&&(l=F.response_code,f&&f.set("MruResponseCode",l.toString()),9===l&&(this.buc="")),F.error_data&&null!=F.error_data.retry_after_ms&&(w=F.error_data.retry_after_ms,f&&f.set("ExpectedRetryAfter",w.toString())));a&&(b=a.Kwj(c,w,b.data.tf,l),f&&(f.set("CurrentRetryCount",a.retryCount.toString()),f.set("RetryScheduled",b?"true":"false")))}F5i(a){this.cag(a)}cag(a,b=!1){const c=a.data.tf===Pp.a.qfc,f=Mq.a.oz();f&&(f.set("StatusCode",
a.data.tf.toString()),b&&f.set("RecentLinks","true"),c||this.uFd(a.data,f));b?this.qF.Dsa("MruActor.GetMruForRecentLinksFromServerFailureCallback",a.data,"Failure"):this.qF.Dsa("MruActor.GetMruFromServerFailureCallback",a.data,"Failure");this.Hld(2);this.ghg(this.QLa,a,Object(C.a)(this,this.G5i,"getMruFromServerRetryTask"),f);Mf.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",a.data.tf),c,!1,Object.assign(new pk.a,{extendedProperties:f}));this.ASd(this.O5);u.AFrameworkApplication.Ba&&
u.AFrameworkApplication.Ba.jb.qDa&&Pg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),b||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}E5i(a){this.cag(a,!0)}Hld(a,b=null,c=null,f=null,l=!1){if(3!==this.O5.state||3===a)this.O5.Kdf=b,this.O5.Ldf=c,this.O5.hPh=f,this.O5.state=a,this.O5.Wtd=l,this.O5.Qwf=this.qF.LE()}AZg(a,b){Z.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:a,["ResultState"]:this.O5.state});b&&3===this.O5.state&&
this.tYf(b,this.O5);return this.O5}kRf(a,b,c=!1){this.Hld(1);let f;const l={};f=c?String.format(this.qF.tda+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.PRh,"OfficeSuite",this.Pbe,"ClassicMru"):String.format(this.qF.tda+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.K5f(),this.Pbe);this.ORh.value||(f+="&entity=docs");u.AFrameworkApplication.Zc&&(l["X-Office-AudienceGroup"]=Object(ua.a)(String,u.AFrameworkApplication.Zc.AudienceGroup)||"");c&&(l["X-Office-Application"]=
"147");this.Yyf?l["X-FileId"]=u.AFrameworkApplication.$g:f+=String.format("&{0}",u.AFrameworkApplication.$g);this.qF.dcc.Jj(f,1,null,l,!0,5,a,b,null)}get qF(){return this.Pfa.value}get Pbe(){return this.oOh.value}static get instance(){return om.Ka||(om.Ka=om.Xq())}static Xq(){return new om(new sc.a(()=>jp.instance),new sc.a(()=>qa.a.re(u.AFrameworkApplication.lcid).name),new sc.a(()=>u.AFrameworkApplication.Ba.jb.QB),u.AFrameworkApplication.fa.ka("MruWriteFileIdInHeader"),()=>u.AFrameworkApplication.Ba.jb.Maa,
()=>u.AFrameworkApplication.$t,new sc.a(()=>u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled")))}}om.Ka=null;Object(e.a)(om,"MruActor",fs,[]);class Qv{constructor(){this.zRb=this.qqf=this.Ea=null;this.Rn=!1}get name(){return"Common.App.NewAndOpen.Core"}Yb(a){this.Ea=a;a.register(645,"Common.INewAndOpenCommonHelpers").ma().na(()=>jp.instance);a.register(646,"Common.IEventEmitter<Common.IGetMoreInfoResult>").ma().na(()=>dn.instance);a.register(646,"Common.IEventEmitter<Common.IMruResult>").ma().na(()=>
om.instance)}init(){u.AFrameworkApplication.fa.gf(()=>{this.BCa()})}BCa(){this.Ea.resolve("Common.INewAndOpenCommonHelpers");this.Ea.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Ea.resolve("Common.IEventEmitter<Common.IMruResult>");var a=!1;jp.instance.YHk();u.AFrameworkApplication.Lua&&(a=!0);u.AFrameworkApplication.RBe&&(om.instance.L8j(),u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&om.instance.J8j(),0<u.AFrameworkApplication.VSg&&
this.vAf(),this.R4k(),a=!0);u.AFrameworkApplication.EIa&&a&&dn.instance.H8j();u.AFrameworkApplication.zsl&&(a=om.instance,a.eKk(),a.R8j(),Im.a.instance.Hb(this.Asl))}R4k(){kp.instance.kFd(Object(C.a)(om.instance,om.instance.K8j,"makeGetMruRequestActivityTrigger"));u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&kp.instance.kFd(Object(C.a)(om.instance,om.instance.I8j,"makeGetMruForRecentLinksRequestActivityTrigger"));kp.instance.kFd(Object(C.a)(this,
this.vAf,"addGetMruFromServerTask"));kp.instance.YZh(Object(C.a)(this,this.QCi,"deleteGetMruFromServerTask"))}QCi(){Im.a.instance.ah(this.WSg)}vAf(){Im.a.instance.Hb(this.WSg)}get WSg(){return this.qqf||(this.qqf=new Se.a(5,2,u.AFrameworkApplication.VSg,Object(C.a)(om.instance,om.instance.H5i,"getMruFromServerTask"),109))}get Asl(){return this.zRb||(this.zRb=new Se.a(2,2,6E4*u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(C.a)(om.instance,
om.instance.S8j,"makeUpdateMruTask"),197))}dispose(){this.Rn||(this.Rn=!0,this.zRb&&(Im.a.instance.ah(this.zRb),this.zRb=null))}}Object(e.a)(Qv,"CorePackageManager",null,[2,3,109]);var Ai=d(112);class Rv{constructor(a,b,c,f,l,w,F,S,fa,xa){this.YJg=new Ua.a;this.GNg=null;this.Wb=f;this.ua=l;this.Ga=c;this.Msa=F;this.sja=S;this.gF=w;this.sa=b;this.la=fa;this.Hn=a;this.zd=xa;this.la.wKj&&(this.sa&&this.sa.VJ(Object(C.a)(this,this.VG,"onSelectionChanged")),S&&S.gJk(this),this.Hn.vzc(Object(C.a)(this,
this.pT,"onFocusChanged")),this.zd.ECf(Object(C.a)(this,this.ldc,"onShapeViewElementUnlocked")),this.zd.C4h(Object(C.a)(this,this.Y_g,"onThumbnailsSetFakeImage")),this.zd.D4h(Object(C.a)(this,this.Z_g,"onThumbnailsSetFocus")),this.zd.E4h(Object(C.a)(this,this.$_g,"onThumbnailsSetSelected")),this.la.$Rc&&this.Hn.n3h(Object(C.a)(this,this.u_g,"onSlideshowNavigationToolbarClickedHandler")),this.la.zg&&this.Hn.m3h(Object(C.a)(this,this.s_g,"onSlideshowContextMenuFocusedHandler")))}dispose(){this.Hn.ucd(Object(C.a)(this,
this.pT,"onFocusChanged"));this.Hn.sMk(Object(C.a)(this,this.xgk,"onDesignerClickSuggestion"));this.zd.mch(Object(C.a)(this,this.ldc,"onShapeViewElementUnlocked"));this.zd.vOk(Object(C.a)(this,this.Y_g,"onThumbnailsSetFakeImage"));this.zd.wOk(Object(C.a)(this,this.Z_g,"onThumbnailsSetFocus"));this.zd.xOk(Object(C.a)(this,this.$_g,"onThumbnailsSetSelected"));this.la.$Rc&&this.Hn.INk(Object(C.a)(this,this.u_g,"onSlideshowNavigationToolbarClickedHandler"));this.la.zg&&this.Hn.HNk(Object(C.a)(this,this.s_g,
"onSlideshowContextMenuFocusedHandler"))}VG(a,b){if(b&&b.Sk&&this.sa.vZ(b.Sk))try{this.Hmj(b.Sk)}catch(c){a=String.format("AriaManager failed to handle the select changed event. Message: {0}. Stack: {1}",c.message,c.stack),za.a.J(17367906,822,10,a)}}Hmj(a){var b=this.sa.mg();if(1===a.length||1===b.length&&b[0].xh){if(a=this.sa.Dq()){b=new Ua.a;let c=this.Gbg(a,b,Object(C.a)(this,this.jaj,"getShapeName"));c||b.count||(c=this.sja.Acg(a,b));!c&&a.get_smartArtModelId()?c=ResourceStrings.l_AccMessageSmartArtSubIcon:
Ja.a.Xa(c)||(c+=ResourceStrings.L_ShapeSelected);const f=this.sja.saj(a);({SFf:c,mUe:b}=this.fEf(f,c,b));!a.Iv&&a.Bs&&({SFf:c,mUe:b}=this.fEf(this.sja.taj(a,this.GNg),c,b));0<b.count?this.L9g(b):this.Yda(c||"")}}else 1<a.length&&(a=this.sja.L5i(this.sa.he()),this.Yda(a||""))}fEf(a,b,c){a&&(c.count?c.add(document.createTextNode(a)):b=String.format(ResourceStrings.l_ShapeAndPresenceInfo,b,a));return{SFf:b,mUe:c}}pT(a,b){b=b.qBb;if(b===Ai.a.zB||b===Xd.a.sg){a=this.ua.Ca;let c=null;b===Ai.a.zB?c=(a=this.Wb.Zlc.fja)?
String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.n6a()+this.sja.r1d(a)):String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.n6a()):b!==Xd.a.sg||!this.sa.hu()&&this.sa.D2()||(this.gF&&this.gF.value&&(b=this.gF.value.Jd)&&a&&b.Po&&ng.e(a,b.Na),c=this.sja.Taj());this.Yda(c||"")}}setAttribute(a,b,c){a&&re.a.mO(a,b,c)}s4(a){this.YJg.add(a)}Gbg(a,b,c=null){try{if(a&&this.Ga)for(let f of this.YJg)if(f){const l=f(a,this.Ga.ye?this.Ga.ye.name:null,b,c);if(l||b&&0<b.count)return l}}catch(f){a=
String.format("AriaManager failed to get provider message. Message: {0}. Stack: {1}",f.message,f.stack),za.a.J(17662480,822,10,a)}return null}L9g(a){if(this.Msa&&this.Msa.value){const b=this.Msa.value.x4i();if(b&&a&&0<a.count){b.firstChild&&b.removeChild(b.firstChild);const c=document.createElement("p");for(let f of a)c.appendChild(f);b.appendChild(c)}}}O9g(a,b){if(a){const c=new Ua.a;let f=this.Gbg(a,c);f||c.count||(f=this.sja.Acg(a,c));0<c.count?(b&&c.add(document.createTextNode(b)),this.L9g(c)):
(b&&(f+=" "+b),this.Yda(f||""))}}Yda(a){this.Msa&&this.Msa.value&&this.Msa.value.sendNotification(a,!0)}ldc(a,b){b.presenceUser&&b.DKj&&this.Yda(String.format(ResourceStrings.L_EditorLeavingHint,b.presenceUser.userName))}xgk(a,b){this.Yda(this.sja.A_i(b.KWk,b.Kfl))}Y_g(a,b){this.setAttribute(b.b5.image,re.a.ff,re.a.VMa)}Z_g(a,b){b.hasFocus&&b.b5.isSelected&&this.Yda(this.n6a()+this.sja.r1d(b.b5));this.setAttribute(b.b5.YHb,re.a.R2a,b.hasFocus&&b.b5.isSelected?"true":"false")}$_g(a,b){b.b5.isSelected&&
b.hasFocus?this.Yda(this.n6a()+this.sja.r1d(b.b5)):b.b5.isSelected||this.Yda(this.n6a());this.setAttribute(b.b5.YHb,re.a.R2a,b.b5.isSelected?"true":"false")}u_g(a,b){this.Yda(b.text)}jaj(a){this.GNg=a||ResourceStrings.l_Object}s_g(a,b){this.Yda(b.text)}n6a(){let a="";const b=this.sa.rf();b&&1<b.length&&(b.sort((c,f)=>c.Ge-f.Ge),this.lnb(b)&&(a=this.sja.n6a(b[0].Ge+1,b[b.length-1].Ge+1)));return a}lnb(a){if(!a||1>=a.length)return!1;const b=a.length;return a[b-1].Ge-a[0].Ge+1===b?!0:!1}}Object(e.a)(Rv,
"AriaManager",null,[568,109]);var nA=d(895);class Sv{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Aria"}Yb(a){this.K=a;this.K.register(567,"PowerPointWebEditor.IAriaMessageHelper").ma().na(()=>new nA.a(this.K.Oa("PowerpointPresence.IPresenceUserManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.Oa("PowerPointWebEditor.Graph.ICommentReader"),this.K.Oa("PowerPointWebEditor.IAppForOfficeManager"),
this.K.qe("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(568,"PowerPointWebEditor.IAriaManager").ma().na(()=>new Rv(this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.qe("Box4.IInteractiveViewManager"),this.K.qe("Common.Utils.IAriaNotifier"),this.K.resolve("PowerPointWebEditor.IAriaMessageHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IAriaManager").dispose()}static main(){m.a.instance.Ec(new Sv)}}Object(e.a)(Sv,"PptAriaPackage",null,[2,3]);var pr=d(998);class ft{constructor(){this.Priority=0;this.Context=
null;this.Length=this.StartInContext=this.Start=0;this.Metadata=ft.rIi;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}ft.rIi=[];Object(e.a)(ft,"Critique",null,[]);class Tv{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}
Object(e.a)(Tv,"Suggestion",null,[]);class gt{usi(a){if(!a)return null;const b=[];for(const c of a)a=Object.assign(new ft,{TraceId:c.traceId,CategoryTitle:c.categoryTitle,ExplanationTitle:c.explanationTitle||"",ExplanationLabel:c.explanationLabel||"",Explanation:c.explanation||"",TileId:c.tileId,RevisionId:c.revisionId,BucketId:c.bucketId,Status:c.status,Tag:c.tags?this.Osi(c.tags):0,Start:c.start,Length:c.length,Priority:c.priority,TypeId:c.critiqueTypeId}),c.supportedActions&&(a.SupportedActions=
this.tsi(c.supportedActions)),c.suggestions&&(a.Suggestions=this.Nsi(c.suggestions)),b.push(a);return b}Nsi(a){if(!a)return null;const b=[];for(const c of a)(a=this.Lsi(c))&&b.push(a);return b}Lsi(a){if(!a)return null;const b=Object.assign(new Tv,{BucketId:a.bucketId,Description:a.description,NumberOfInstances:a.numberOfInstances,Source:a.source,Text:a.text,Level:this.ssi(a.confidenceLevel)});a.actions&&(b.Action=this.Msi(a.actions));return b}ssi(a){return 1===a?0:2===a?1:2}Msi(a){let b=0;a.autoCorrect&&
(b|=4);a.changeOnce&&(b|=1);a.changeAll&&(b|=2);a.readAloud&&(b|=8);return b}Osi(a){return a.consistency?1:0}tsi(a){let b=0;a.addToDictionary&&(b|=16);a.deleteText&&(b|=1);a.ignore&&(b|=2);a.ignoreAll&&(b|=4);a.ignoreCritiqueType&&(b|=8);a.showDetails&&(b|=32);return b}}Object(e.a)(gt,"CloudALResponseTransformer",null,[802]);var fg=d(81),Xx=d(517);class Uv{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){this.Gta=a;this.kab=b;this.INg=c;this.ua=f;this.Jb=l;this.ia=w;this.uc=S;this.fk=fa;this.Zh=xa;this.Oc=F;
this.Jz=Za;this.Gta.Cza(Object(C.a)(this,this.AGa,"onBeforeParagraphDisconnect"));this.Gta.yk(Object(C.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Oc.O1h(Object(C.a)(this,this.gYg,"onLanguageOnRangeChanged"));this.kab.Cza(Object(C.a)(this,this.QVg,"onBeforeNumberListDisconnect"));this.kab.yk(Object(C.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.INg.ZF(Object(C.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"))}isEnabled(a){const b=
this.ua.Ca;if(!b||!b.isConnected)return!1;const c=Object.assign(new Xx.a,{slideId:b.Cb});this.ia.Ma(aa.a.uWa,2,c);return 0<c.Gkc?(za.a.J(37025884,375,50,"{0}, current slide {1} is locked due to one more people are here. Skipping",a,b.id),!1):!0}initialize(){this.B6d(this.ua.Ca)}dispose(){this.Gta.wHa(Object(C.a)(this,this.AGa,"onBeforeParagraphDisconnect"));this.Gta.Pm(Object(C.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Oc.HMk(Object(C.a)(this,this.gYg,"onLanguageOnRangeChanged"));
this.kab.wHa(Object(C.a)(this,this.QVg,"onBeforeNumberListDisconnect"));this.kab.Pm(Object(C.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.INg.kO(Object(C.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"))}AGa(a,b){this.Hmc(Object(ua.a)(Wc.AParagraphNode,b.node),!1)}onParagraphPropertyChanged(a,b){b.property!==ob.a.Vp&&b.property!==Sb.a.listLevel||this.Hmc(Object(ua.a)(Wc.AParagraphNode,b.node),!1)}gYg(a,b){this.Hmc(b.paragraphNode,!0)}QVg(a,b){b.node&&
Object(Ca.a)(fg.a,b.node)&&this.Hmc(this.Jz.EZd(Object(ua.a)(fg.a,b.node)),!0)}onNumberListPropertyChanged(a,b){b.node&&Object(Ca.a)(fg.a,b.node)&&b.node.isConnected&&b.property===ob.a.fm&&this.Hmc(this.Jz.EZd(Object(ua.a)(fg.a,b.node)),!0)}onShapeChildTopologyChanged(a,b){if(a=Object(ua.a)(4,b.node))a=this.uc.Sg(a),this.B6d(a)}Hmc(a,b){!this.V6k(a)||b&&this.woj(a)||(a=Object(ua.a)(132,this.uc.Sg(a)),this.B6d(a))}B6d(a){if(a&&a.isConnected&&a.isSlideCritiqueReady){var b=this.Jb.ie(7,D.a.JSe);b.lc(a);
a.isSlideCritiqueReady=!1;b.dispose()}}V6k(a){return!!a&&a.isConnected&&this.Zh.Pd(a)&&!this.fk.Fia(a)&&!a.ta(zb.a.vS,!1)}woj(a){a=a.ta(ob.a.Vp,"");return!a||!a.length}}Object(e.a)(Uv,"ConsistencyCheckManager",null,[564,109]);var pm=d(166);class xn{}xn.tGf="AugEditorServiceTileCheckRequest";xn.uGf="AugEditorServiceTileCheckResponse";xn.eIi="EditorServiceTileCheckRequest";xn.BNf="Proofing.ProofingRequest";xn.CNf="Proofing.ProofingResponse";Object(e.a)(xn,"ProofingAugmentationSchemaNames",null,[]);
class Bo{constructor(){this.d=this.p=this.w=null}}Object(e.a)(Bo,"ProofingDashboardTraceMetrics",null,[]);class Mk{}Mk.Nae="bs";Mk.AUc="bd";Mk.DCh="was";Mk.ECh="wad";Mk.VJj="rm";Mk.Jyl="wd";Mk.xxl="ad";Mk.cSk="rs";Object(e.a)(Mk,"TelemetryFieldNames",null,[]);class Nl{}Nl.vjl="tcw";Nl.Njd="tcc";Nl.dyg="bs";Nl.lPj="bd";Nl.cyg="bpc";Nl.NQg="md";Object(e.a)(Nl,"TelemetryValues",null,[]);class Nq{constructor(){this.wn=this.i=null}}Object(e.a)(Nq,"Workflow",null,[]);class Vv{constructor(a,b,c,f,l,w,F,
S,fa,xa,Za,pb){this.ua=a;this.VB=b;this.Lne=c;this.Jb=f;this.UYj=l;this.gMg=w;this.Tca=F;this.Fa=S;this.fk=fa;this.Ha=xa;this.JXj=Za;this.J8=pb}initialize(){this.Tca.execute(a=>{a.addEventHandler(xn.uGf,Object(C.a)(this,this.Ihj,"handleAugResults"));this.Ha.pptAugmentationLoopCloudALEnabled&&a.addEventHandler(xn.CNf,Object(C.a)(this,this.jij,"handleCloudALResults"))})}Ihj(a,b,c,f){za.a.J(36962498,375,50,"Handle WAC AL results");if(b&&f&&b&&f){a=String.format("{0}, MarkStart:{1}",f.Telemetry,(new Date).getTime().toString());
var l=this.Q5f(b.Content);c=this.j0i(f.Payload);if(l&&c){var w=!1;if(this.Ha.pptRegisterSingleProofingWorkflowEnabled||!this.Ha.pptAugmentationLoopCloudALEnabled||this.Ha.pptAugmentationLoopShadowCloudALEnabled)this.OQg(c.Critiques,l),w=!0;l=(new Date).getTime();if(f=this.J8.MQd(f.DashboardTelemetry))try{const F={};F[Mk.cSk]=c.ResponseStatus;F[Mk.VJj]=w;F[Mk.Jyl]=l-f.d[Mk.Nae];F[Mk.xxl]=f.d[Mk.ECh]-f.d[Mk.DCh];f.d=F;f.p=Nl.NQg;this.J8.track(f)}catch(F){za.a.J(37487777,375,15,"trace metrics exception {0}",
F.message)}a=String.format("{0}, MarkDone:{1}",a,l.toString());za.a.J(36702229,375,50,"Marked: {0}, TileID: {1}, critique count: {2}, {3}",w,b.Id,c.Critiques?c.Critiques.length:0,a)}else za.a.J(36577357,375,10,c?"Aug slide is null":"Result is null")}}jij(a,b,c,f){za.a.J(36962502,375,50,"Handle Cloud AL results");c=(new Date).getTime();if(b&&f&&b&&f){f.partialSuccess&&za.a.J(37057568,375,15,"Get partial success response");a=String.format("MarkStart:{0}",c.toString());var l=this.Q5f(b.Content);if(l){var w=
!1;if(this.Ha.pptRegisterSingleProofingWorkflowEnabled||!this.Ha.pptAugmentationLoopShadowCloudALEnabled)w=this.JXj.usi(f.critiques),this.OQg(w,l),w=!0;l=(new Date).getTime();c=Object.assign(new Bo,{w:Object.assign(new Nq,{wn:Nl.Njd,i:b.Id}),p:Nl.NQg,d:{["ms"]:c,["md"]:l,["rm"]:w,["rs"]:f.partialSuccess?1:0}});this.J8.track(c);a=String.format("{0}, MarkDone:{1}",a,l.toString());za.a.J(36783304,375,50,"Marked: {0}, Cloud AL tileID: {1}, critique count: {2}, {3}",w,b.Id,f.critiques?f.critiques.length:
0,a)}else za.a.J(36783302,375,10,"Aug slide is null")}}Q5f(a){let b=null;try{b=md.a(a)}catch(c){return za.a.J(36577355,375,10,"Try parse aug slide failed"),null}return b}j0i(a){let b=null;try{b=md.a(a)}catch(c){return za.a.J(36525519,375,10,"ApplyEditorServiceResults - Try parse aug response failed {0}",c.message),null}if(!b)return za.a.J(38545173,375,15,"ApplyEditorServiceResults - Parsed response is null"),null;if(1!==b.ResponseStatus&&0!==b.ResponseStatus)return za.a.J(36525521,375,15,"ApplyEditorServiceResults - Failed editor service call {0}",
b.ResponseStatus),null;1===b.ResponseStatus&&za.a.J(37057603,375,15,"Get partial success response");return b}OQg(a,b){try{const F=this.ua.Ca;if(!this.n8k(b,F)){var c=this.Vag(a,!1);if(c){var f=this.ua.Ca.Vga,l=new Ua.a,w=this.Jb.ie(7,D.a.JSe);w.lc(F);for(const S of b.drawingElems)if(S.text&&S.text.paragraphs)for(const fa of S.text.paragraphs){const xa=fa.id;l.add(xa);const Za=Object(ua.a)(Wc.AParagraphNode,f.te(Fa.a.ig(xa)));if(Za&&!Za.ta(pm.a.$ba,!1)){if(this.Ha.pptEditorGrammarAndWritingStyleIsEnabled)if(xa in
c){const pb=Array.isArray(c[xa])?c[xa]:null;if(!pb||!pb.length||pb[0].RevisionId!==Za.ta(pm.a.OUc,0).toString())continue;this.w9j(Za,pb,this.Z9i(fa.cfRuns))}else this.ELk(Za);Za.setValue(pm.a.$ba,!0)}}if(this.Ha.pptEditorConsistencyCheckIsEnabled){const S=String.format("Start:{0}",(new Date).getTime().toString());b=0;const fa=F.isSlideCritiqueReady;c=!1;if(!fa){const xa=new Ua.a,Za=this.Vag(a,!0);(c=this.hPi(Za,l,F,xa))&&(b=this.h8h(Za,l,F,xa))}za.a.J(37298713,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",
S,(new Date).getTime().toString(),fa,c,b)}F.setValue(pm.a.bsg,!0);w.dispose()}}}catch(F){za.a.J(36525523,375,10,"MarkEditorServiceResults failed {0}",F.message)}}Z9i(a){const b=new wa.ScriptSharpLegacyMap;if(!a)return b;let c=0;for(const f of a)f.cf&&b.add(c,f.cf.lang),c+=f.len;return b}w9j(a,b,c){var f=this.VB.ME(a,w=>!!w.Gh);const l=[];for(const w of f)1===w.Gh.proofingType&&Array.add(l,w);b=this.gPi(a,b,l);f=this.fPi(b,f);this.VB.vHa(a,f);this.MQg(b,a,c);a.setValue(pm.a.$ba,!0)}ELk(a){const b=
this.VB.ME(a,c=>!!c.Gh&&1!==c.Gh.proofingType);this.VB.vHa(a,b);a.setValue(pm.a.$ba,!0)}h8h(a,b,c,f){const l=c.Vga,w=new Ie.a;let F=0;this.oRk(c);for(let fa in a){var S=a[fa];const xa=Object(ua.a)(Wc.AParagraphNode,l.te(Fa.a.ig(fa)));S=Array.isArray(S)?S:null;if(!(xa&&xa.isConnected&&S&&S.length))continue;const Za=[];for(const pb of S)this.Xqg(pb)&&!f.contains(pb.BucketId)&&Za.push(pb);0<Za.length&&(this.MQg(Za,xa),w.Kb(xa.id.toString())||w.$(xa.id.toString(),xa),F+=Za.length)}if(0<w.count)for(let fa of b)w.Kb(fa)&&
(a=w.ga(fa))&&c.tIa.add(a);c.isSlideCritiqueReady=!0;return F}hPi(a,b,c,f){var l=this.d7i(c);if(b.count!==l.count)return this.zVc(String.format("Topology changed from {0} to {1}",b.count,l.count)),!1;c=c.Vga;for(var w of b){if(!l.contains(w))return this.zVc("ParaId changed"),!1;b=Object(ua.a)(Wc.AParagraphNode,c.te(Fa.a.ig(w)));if(!b||!b.isConnected)return this.zVc("Invalid ParaId"),!1;if(!b.ta(pm.a.$ba,!1))return this.zVc("Para pending proofing"),!1}for(let F in a){w=a[F];l=Object(ua.a)(Wc.AParagraphNode,
c.te(Fa.a.ig(F)));w=Array.isArray(w)?w:null;if(!w||!w.length)continue;b=this.VB.ME(l,fa=>!!fa.Gh&&(1===fa.Gh.proofingType||2===fa.Gh.proofingType||3===fa.Gh.proofingType));const S=this.VB.ME(l,fa=>{fa=Object(ua.a)(266,fa.Gh);return!!fa&&5===fa.proofingType&&fa.vCa});l=this.Lne.gLc(l,!1,!0);for(const fa of w)if(this.Xqg(fa)){if(this.oRc(fa,b)||this.pCj(fa,w))f.add(fa.BucketId),za.a.J(37298716,375,50,"Overlap critique: {0}",fa.BucketId);(this.oRc(fa,l)||this.oRc(fa,S))&&f.add(fa.BucketId)}}return!0}zVc(a){za.a.J(37298718,
375,50,"Skip apply: {0}",a)}gPi(a,b,c){const f=[];for(const l of b){if(this.poj(b,l)||a.characterData.length<l.Start+l.Length||this.oRc(l,c))continue;const w=Ze.b(l);2!==w&&3!==w||f.push(l)}return f}fPi(a,b){const c=[];for(const f of b)this.W6k(a,f)||Array.add(c,f);return c}W6k(a,b){const c=b.Gh.proofingType;if(1===c)return!0;if(2===c||3===c)return!1;if(5===c){for(const f of a)if(this.fTc(f.Start,f.Start+f.Length,b.begin,b.end))return!1;return!0}return!1}oRc(a,b){const c=a.Start;a=a.Start+a.Length;
for(const f of b)if(this.fTc(c,a,f.begin,f.end))return!0;return!1}Vag(a,b){const c={};if(a)for(const f of a)if(0!==f.Priority||b)f.TileId in c?Array.add(c[f.TileId],f):c[f.TileId]=[f];return c}OPa(a,b){let c=0;for(let f of a)if(b>=f.key)c=f.value;else break;return c}MQg(a,b,c=null){if(a&&a.length&&b){var f={},l=[];for(const F of a){var w=F.Start;const S=w+F.Length,fa=b.characterData.substring(w,S);a=this.UYj.create(F,this.gMg);a.token=fa;c&&(a.lcid=this.OPa(c,w));w=new wo(w,S,a);Array.add(l,w);a=
1===a.proofingType?Ah[a.proofingType]:a.typeId;f[a]=a in f?f[a]+1:1}this.VB.gAf(b,l);this.gMg.track(()=>Object.assign(new xe.a,{E:2,C:this.Mti(b.characterData),F:f}))}}poj(a,b){const c=b.Start,f=b.Start+b.Length;for(const l of a)if(this.fTc(c,f,l.Start,l.Start+l.Length)&&Ze.a(l)>Ze.a(b))return!0;return!1}pCj(a,b){const c=a.Start,f=a.Start+a.Length;for(const l of b)if(l!==a&&this.fTc(c,f,l.Start,l.Start+l.Length))return!0;return!1}fTc(a,b,c,f){return a>=c&&a<f||c>=a&&c<b}Mti(a){return Qo.a.instance.Seg(a,
0,a.length-1)}n8k(a,b){return!a||!b||!b.isConnected||a.id!==b.id.toString()}Xqg(a){return!!a&&5===Ze.b(a)}d7i(a){const b=new Ua.a;a=a?a.km():[];for(const c of a)this.fk.Tia(c)||this.Fa.RI(c,f=>{b.add(f.id.toString())});return b}oRk(a){for(let b of a.tIa){const c=b;if(c){const f=this.VB.ME(c,l=>{l=Object(ua.a)(266,l.Gh);return!!l&&5===l.proofingType&&!l.vCa});this.VB.vHa(c,f)}}a.tIa.clear()}}Object(e.a)(Vv,"EditorServiceResultsManager",null,[]);class Wv extends $l.a{constructor(a,b,c,f,l,w=null){super(a,
b,c,f,w);this.AD=l}get proofingType(){const a=super.proofingType;return this.AD.dRa||2!==a?a:1}}Object(e.a)(Wv,"PPTEditorServiceErrorDetails",$l.a,[]);class Yx{constructor(a,b,c){this.g1j=a;this.u4j=b;this.AD=c}create(a,b,c=null){return new Wv(a,b,this.g1j,this.u4j,this.AD,c)}}Object(e.a)(Yx,"PPTEditorServiceErrorDetailsFactory",null,[561]);class Zx{constructor(a){this.Ha=a}filter(a){if(a&&(!this.Ha.pptEditorConsistencyCheckIsEnabled||!this.Ha.pptEditorGrammarAndWritingStyleIsEnabled))for(let c=a.length-
1;0<=c;--c){const f=a[c].CritiqueTypeInfoList;for(let l=f.length-1;0<=l;--l){var b=f[l];b=Ze.c(b.CritiquePriority,b.CritiqueTag);this.Ha.pptEditorConsistencyCheckIsEnabled||5!==b||Array.removeAt(f,l);this.Ha.pptEditorGrammarAndWritingStyleIsEnabled||2!==b&&3!==b||Array.removeAt(f,l)}f.length||Array.removeAt(a,c)}}}Object(e.a)(Zx,"PPTProofingCritiqueCategoryInfoFilter",null,[562]);class Xv extends nm.a{constructor(a,b){super(null);this.Ezd=a;this.errorType=2;this.Bzg=b}get proofingType(){return this.Ezd}get suggestions(){return[]}eJa(){}}
Object(e.a)(Xv,"UnknownErrorDetails",nm.a,[]);class uu{constructor(a,b,c,f,l){this.EWe=this.BWe=null;this.dEd=this.oxd=0;this.jqd=!1;this.Ei=a;this.FPb=b;this.gz=c;this.im=f;this.oM=l;this.bqc=0}j$g(a,b,c){return{B6g:a,bVg:b,aVg:c}}Axh(){}Kbe(a,b,c,f,l,w,F,S){!w&&(c=!!c&&c[a],f=!!f&&f[a],b&&b[a]||c||f)&&(b=this.Ei.Ra.last.cp,w=this.Ei.characterData.length,Array.add(F,new qk.a(b,w)),(c||f)&&Array.add(S,new wo(b,w,new Xv(this.oM.Aae?l?l[a]:0:f?2:1,c?1:2))))}Jsl(a,b){this.gz.YDe(this.Ei,a);b&&this.im.tPk(this.Ei,
b);this.A6g()}A6g(){this.FPb.NQ(this.Ei)}YUk(a,b,c,f){this.zgh(this.bqc,b,c,f);this.UFe(a,this.jqd)}zgh(a,b,c,f){b.add(1===a);c.add(2===a||3===a);f.add(this.oM.Aae?a:0)}UFe(a,b){a.add(b)}VRj(a){let b,c,f,l;b=this.Ei.ta(ob.a.Nua,null);c=this.Ei.ta(ob.a.yIa,null);f=this.Ei.ta(Sb.a.N6a,null);l=this.Ei.ta(Sb.a.kWa,null);this.Ei.aub=this.Ei.ta(ne.a.jcc,!1);({Nua:b,yIa:c,N6a:f,kWa:l}=this.iCh(b,c,f,l,a,"loading"));return{Nua:b,yIa:c,N6a:f,kWa:l}}WFe(a,b,c,f,l){({Nua:a,yIa:b,N6a:c,kWa:f}=this.iCh(a,b,c,
f,l,"saving"));this.lIe(ob.a.Nua,a);this.lIe(ob.a.yIa,b);this.sKe()&&this.lIe(Sb.a.N6a,c);this.f1k(Sb.a.kWa,f);this.Ei.aub?this.Ei.ke(ne.a.jcc,!0):this.Ei.removeProperty(ne.a.jcc)}sKe(){return!0}lIe(a,b){b&&Array.contains(b,!0)?this.Ei.ke(a,b):this.Ei.removeProperty(a)}f1k(a,b){!b||Ma.a.all(b,c=>0===c)?this.Ei.removeProperty(a):this.Ei.ke(a,b)}nmi(a,b){(b=this.Ei.Ra.ga(b).formatting)?(a.formatting=b.Vd(a),I.a.instance.ga(57)&&(this.Ei.vu(),-1!==a.formatting.jg&&this.Ei.wordRunProperties.ztb(b.jg,
64))):(Z.ULS.shipAssertTag(18109325,324,!1,"There is a Chp that has spelling error, but its formatting object is null"),cd.a.instance.Vb("CloneFormattingObjectError",{["Reason"]:"There is a Chp that has spelling error, but its formatting object is null"}))}iCh(a,b,c,f,l,w){const F=cd.a.instance.zp(D.a.pwl);F.properties.$(Dh.a.source,w);let S=!1;a&&a.length!==l&&(Z.ULS.sendTraceTag(18109326,324,10,"NotProofedRuns has inconstant length with expected. Length: [{0}], expected: [{1}], context:[{2}]",a.length,
l,w),S=!0);b&&b.length!==l&&(Z.ULS.sendTraceTag(18109327,324,10,"SpellErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",b.length,l,w),S=!0);this.sKe()&&c&&c.length!==l&&(Z.ULS.sendTraceTag(20784798,324,10,"GrammarErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",c.length,l,w),S=!0);f&&f.length!==l&&(Z.ULS.sendTraceTag(25274201,324,10,"ProofingErrorHints has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",
f.length,l,w),S=!0);if(S)for(f=c=b=null,a=[],w=0;w<l;w++)Array.add(a,!0);F.end();return{returnValue:!S,Nua:a,yIa:b,N6a:c,kWa:f}}E_g(){}Qte(){this.bqc=0;this.BWe=this.Ei.w_||[];this.EWe=this.Ei.NIb||[];this.dEd=this.oxd=0;this.jqd=!1}Tte(a,b){a.yp&&a.yp.Gh?this.bqc=a.yp.Gh.proofingType:a.GK&&(this.bqc=0);a=a.cp;b=b?b.cp:a;this.jqd=({QMe:this.oxd}=this.jrg(a,b,this.BWe,this.oxd)).returnValue||({QMe:this.dEd}=this.jrg(a,b,this.EWe,this.dEd)).returnValue}jrg(a,b,c,f){for(;f<c.length;){const l=c[f];if(l.end<=
a)++f;else return{returnValue:b>l.begin,QMe:f}}return{returnValue:!1,QMe:f}}}Object(e.a)(uu,"ProofingDataHandler",null,[853]);var is=d(502);class Yv extends uu{constructor(a,b,c,f,l,w,F,S,fa){super(a,b,c,f,S);this.EHg=!1;this.s6b=null;this.CI=l;this.ia=w;this.Fa=F;this.uc=fa;this.bXc=null}E_g(){this.CI.eol(this.Ei)}j$g(a,b,c){this.Ei.H7d||(a=!1,c=this.im.ME(this.Ei));this.bXc=this.im.ME(this.Ei,f=>{f=Object(ua.a)(266,f.Gh);return!!f&&5===f.proofingType&&!f.vCa});return{B6g:a,bVg:b,aVg:c}}Axh(a,b,
c,f,l){const w=Object(ua.a)(132,this.uc.Sg(this.Ei));this.Ei&&w&&w.isConnected&&w.isSlideCritiqueReady&&Ja.a.pId(this.Ei.characterData,b)&&this.bXc&&0<this.bXc.length&&(Array.addRange(l,this.bXc),l.sort((F,S)=>F.end-S.end));if(!a&&c&&0<c.length&&Ja.a.pId(this.Ei.characterData,b)&&f&&0<f.length){for(const F of c)this.lvg(F,f)&&!this.lvg(F,l)&&Array.add(l,F);l.sort((F,S)=>F.end-S.end)}}lvg(a,b){a=ll.c([a],b);return!Ma.a.Xa(a)&&Ma.a.any(a,c=>c.begin<c.end)}A6g(){this.CI.nJj(this.Ei)&&this.FPb.NQ(this.Ei)}sKe(){return!1}UFe(a,
b){this.EHg=!0;super.UFe(a,b);b&&(this.Ei.ke(pm.a.$ba,!1),this.Ei.ke(pm.a.OUc,(new Date).getTime()))}zgh(a,b){this.s6b||(this.s6b=this.im.ME(this.Ei));b.add(1===a)}Qte(){super.Qte();this.s6b=null}Kbe(a,b,c,f,l,w,F,S){w||(b=!!b&&b[a],a=!!c&&c[a],c=this.Ei.Ra.ga(this.Ei.Ra.length-1),b?(Array.add(F,new qk.a(c.cp,this.Ei.characterData.length)),this.XUk()):(b=this.eXi(c.cp,this.Ei.characterData.length,this.Ei.characterData,fa=>{fa=fa.Gh.proofingType;return 2===fa||3===fa}))&&0<b.length&&Array.addRange(S,
b),a&&(Array.add(F,new qk.a(c.cp,this.Ei.characterData.length)),Array.add(S,new wo(c.cp,this.Ei.characterData.length,new Xv(1,1)))))}WFe(a,b,c,f,l){this.EHg||this.ipj()||za.a.J.apply(null,[37368030,375,50,"notProofedRuns:{0}, spellErrorRuns:{1}, grammarErrorRuns:{2}",a,b].concat(c));super.WFe(a,b,c,null,l)}ipj(){if(!this.Ei)return za.a.J(37368032,375,10,"ParagraphNode is null"),!1;var a=this.Fa.$m(this.Ei);if(!a)return za.a.J(37368034,375,10,"ShapeNode is null"),!1;a=new is.a(a,gb.App.Bm);this.ia.Ma(aa.a.Idb,
2,a);return a.bsa}XUk(){const a=new Oe.GraphTransaction(4);a.hd(this.Ei);this.Ei.ke(pm.a.$ba,!1);this.Ei.ke(pm.a.OUc,(new Date).getTime());a.dispose()}eXi(a,b,c,f){const l=[];if(this.s6b)for(const w of this.s6b){const F=Object(ua.a)(wo,w);F&&F.Gh&&F.Gh.token===c.substring(F.begin,F.end)&&F.end>a&&F.end<=b&&f(F)&&Array.add(l,F)}return l}}Object(e.a)(Yv,"PPTProofingDataHandler",uu,[]);class Zv{constructor(a,b,c,f,l,w,F,S){this.B3=a;this.O2j=b;this.VB=c;this.CI=f;this.AD=F;this.ia=l;this.uc=S;this.Fa=
w}Bxi(a){return new Yv(a,this.B3,this.O2j,this.VB,this.CI,this.ia,this.Fa,this.AD,this.uc)}}Object(e.a)(Zv,"PPTProofingDataHandlerFactory",null,[565]);class vu{constructor(a,b){this.Tca=a;this.XBg=b}initialize(){this.Tca.execute(a=>{if(this.XBg)for(const b of this.XBg)this.dKk(a,b)})}dKk(a,b){a.registerSimpleRemoteWorkflow(b.HF,b.Cnb,b.dEb,b.Rmb)}}Object(e.a)(vu,"ProofingAugLoopRuntimeManager",null,[]);class $v{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc){this.Fa=a;this.fk=b;this.uc=
c;this.um=f;this.Jb=l;this.Ib=w;this.Dk=F;this.ua=S;this.B3=fa;this.VB=xa;this.Yh=pb;this.Zh=Mb;this.Qka=hc;this.Bb=kc;this.Oc=Ec;this.zd=Hc;this.NLg=Dc;this.VUa=new Ua.a;this.Dk.J4h(Object(C.a)(this,this.f0g,"onUndoRevisionStateChanged"));this.ZS=Za.Cd(12);this.ZS.yk(Object(C.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.kL=Za.Cd(10);this.kL.ZF(Object(C.a)(this,this.$Zg,"onShapeTopologyChanged"));this.b5j=new Se.a(3,1,0,Object(C.a)(this,this.resumeProofingAfterUndo,
"resumeProofingAfterUndo"),90,"14");this.cac=this.REa=!1;this.zd.DR(Object(C.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}dispose(){this.Dk.BOk(Object(C.a)(this,this.f0g,"onUndoRevisionStateChanged"));this.ZS.Pm(Object(C.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.kL.kO(Object(C.a)(this,this.$Zg,"onShapeTopologyChanged"));this.zd.lma(Object(C.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}qjc(a,b){this.Fa.RI(a,c=>{this.hkh(c,b)})}ikh(a,
b){this.fk.pfc(a,c=>{this.hkh(c,b)})}Ysl(a,b){b?this.Fa.RI(a,c=>{c&&this.VB.TLd(c)}):this.Fa.RI(a,c=>{c&&(c.MSb=!0)})}Bxh(a){if(a&&a.isConnected&&!a.jp){var b=this.Jb.ie(4);try{let c=!1;const f=this.Ib.Jc(a);b.lc(f);const l=this.um.aqa(a);for(;l.moveNext();){const w=l.currentNode;this.G7k(w)&&(c=!0,w.S7c(),w.Efc=!0)}c&&this.UQg(a)}finally{b&&b.dispose()}this.Yh.forceOutbound()}}eol(a){if(this.gsa(a)&&a.MSb)if(this.cac&&!this.VUa.contains(a))this.VUa.add(a);else{var b=this.Jb.ie(4);try{b.lc(a),a.S7c(),
a.Efc=!0,this.x9j(a)}finally{b&&b.dispose()}a.MSb=!1}}Q$c(a){this.gsa(a)&&this.Fa.RI(a,b=>{this.B3.NQ(b)})}ozk(a){this.gsa(a)&&this.fk.pfc(a,b=>{this.B3.NQ(b)})}nJj(a){return this.gsa(a)&&(this.pJj(a)||this.oJj(a))}UQg(a){a&&a.isConnected&&this.Fa.rsa(a)&&this.skh(a)}x9j(a){const b=this.Fa.$m(a);this.UQg(b);this.fk.Fia(a)&&(a=this.fk.p6a(a))&&a.isConnected&&this.fk.Tia(a)&&this.skh(a)}f0g(a,b){if(b)switch(b.state){case 0:this.cac=!0;break;case 3:this.cac=!1,this.REa||(this.Bb.Hb(this.b5j),this.REa=
!0)}}G7k(a){return this.gsa(a)?a.ta(ob.a.Nua,null)?!0:a.ta(ob.a.yIa,null)?!0:!1:!1}onParagraphPropertyChanged(a,b){this.cac&&b&&b.node&&(12!==b.node.type||this.VUa.contains(b.node)||this.VUa.add(b.node))}$Zg(a,b){this.cac&&b&&b.node&&(10!==b.node.type||this.VUa.contains(b.node)||this.VUa.add(b.node))}resumeProofingAfterUndo(){this.REa=!1;for(let b of this.VUa)if(this.gsa(b))if(this.Fa.rsa(b)){var a=b;a&&(this.qjc(a,!0),this.Q$c(a))}else this.Zh.Pd(b)&&(a=b)&&(a.MSb=!0,this.B3.NQ(a));this.VUa.clear()}hkh(a,
b){a&&(a.MSb=b&&a.w_&&0<a.w_.length?!0:!1)}pJj(a){if(this.NLg){const b=this.ua.Ca;if(!this.gsa(b))return!1;a=this.Fa.f7(a);return this.uc.Sg(a)===b}return this.Qka.TBj(a)}oJj(a){var b=this.ua.Ca;if(!this.gsa(b))return!1;a=this.fk.p6a(a);b=b.TPa();return this.gsa(a)&&this.gsa(b)&&Fa.a.dP(a.id,b.id)}skh(a){a.setValue(zb.a.R$c,a.ta(zb.a.R$c,0)+1)}gsa(a){return!!a&&a.isConnected}onActiveSlideDomReady(){if(this.NLg){var a=this.ua.Ca;if(a&&(a=a.km())&&0<a.length)for(const b of a)this.Fa.EA(b)&&this.Q$c(b)}}}
Object(e.a)($v,"ProofingBehaviorController",null,[566,109]);class Oq extends Ro.a{constructor(a,b,c,f,l,w=!0,F=!1,S=50){super(a,b,c,f,l,w);this.D1j=F;this.SJg=S}kih(a){a=Array.isArray(a)?a:null;if(!Ma.a.Xa(a))if(a.length<=this.SJg)this.logTrace(a);else{const b=[];for(const c of a)Array.add(b,c),b.length===this.SJg&&(this.logTrace(b),Array.clear(b));0<b.length&&this.logTrace(b)}}logTrace(a){a&&za.a.J(37325012,375,this.D1j?15:50,"{0}",Ik.c(a))}}Object(e.a)(Oq,"DashboardAggregator",Ro.a,[]);class aw{constructor(a){this.J8=
new Oq(new sc.a(()=>u.AFrameworkApplication.ve),u.AFrameworkApplication.Aea,15,a.pptProofingDashboardTraceIntervalInMinutes,new kr,!0,a.pptProofingDashboardTraceAsMonitorableEnabled,a.pptProofingDashboardMaxCountInEachLog)}track(a){this.J8.track(a,"")}MQd(a){let b=null;try{b=md.a(a)}catch(c){za.a.J(37325010,375,15,"Try parse dashboardTelemetry failed")}return b}}Object(e.a)(aw,"ProofingDashboardAggregator",null,[563]);class bw{track(){}MQd(){return null}}Object(e.a)(bw,"ProofingDashboardNonOperationAggregator",
null,[563]);var cw=d(428),ht=d(427);class wu{constructor(a){this.W4j=a}dw(a,b,c){this.W4j(b,c);return!0}}Object(e.a)(wu,"NonOpProofingALRequestManager",null,[644]);class xu{constructor(a,b,c){this.j_=this.GZ=null;this.nqe=a;this.J6b=b.pptEditorConsistencyCheckIsEnabled;this.Mle=b.pptProofingLogWorkflowExceptionEnabled;this.J8=c;this.Kne=new wu(Object(C.a)(this,this.nEe,"requestAL"))}get HF(){return"ProofingTileCheckCloudALWorkflow"}get proto(){return""}get Cnb(){this.GZ||(this.GZ=Object.assign(new ht.a,
{name:"LambdaBefore_ProofingTileCheckCloudAL",inputSchema:cw.a.Hkc,outputSchema:xn.BNf,func:Object(C.a)(this,this.Z8a,"lambdaBeforeFunc")}));return this.GZ}get Rmb(){return null}get dEb(){this.j_||(this.j_=Object.assign(new ht.a,{name:"LambdaRemote_ProofingTileCheckCloudAL",inputSchema:xn.BNf,outputSchema:xn.CNf,func:null}));return this.j_}nEe(a,b){b(a)}Z8a(a,b,c){try{za.a.J(36962511,375,50,"{0}:LambdaBeforeStart",this.HF);const F=Object.assign(new Bo,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new Nq,
{wn:Nl.Njd})});this.J8.track(Object.assign(new Bo,{w:Object.assign(new Nq,{wn:Nl.Njd}),p:Nl.dyg}));let S=String.format("LambdaBeforeStart:{0}",F.d[Mk.Nae].toString());if(a){F.w.i=a.Id;try{var f=md.a(a.Content)}catch(fa){za.a.J(36763234,375,10,"Try parse tile response failed");c(null);return}if(f){var l=f.isSlideCritiqueReady;b=!1;var w=({pDa:b}=this.nqe.Wbl(f)).returnValue;w?b&&(!this.J6b||this.J6b&&l)?(c(null),this.J8.track(Object.assign(new Bo,{w:Object.assign(new Nq,{wn:Nl.Njd}),p:Nl.cyg})),za.a.J(36962520,
375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.HF,a.Id,b,l)):(F.d[Mk.AUc]=(new Date).getTime(),F.p=Nl.lPj,S=String.format("TileId:{0}, {1}, LambdaBeforeDone:{2}",a.Id,S,F.d[Mk.AUc].toString()),this.J8.track(F),za.a.J(36783312,375,50,S),this.Kne.dw(f.id,w,c)):(c(null),za.a.J(36962518,375,50,"{0}:LambdaBeforeDone,RequestNull,{1}",this.HF,a.Id))}else c(null)}else c(null),za.a.J(36962513,375,50,"{0}:LambdaBeforeDone,InputNull",this.HF)}catch(F){a="CloudAL LambdaBefore Exception",
this.Mle&&(a=String.format("CloudAL LambdaBefore Exception Message: {0}, Stack: {1}",F.message,F.stack)),za.a.J(37835201,375,10,a),c(null)}}}Object(e.a)(xu,"ProofingTileCheckCloudALWorkflow",null,[613,614]);class dw{}Object(e.a)(dw,"AugEditorServiceTileCheckRequest",null,[]);class ew{constructor(){this.contextId=this.BUc=null}}Object(e.a)(ew,"RequestStateObject",null,[]);class yu{constructor(a,b,c,f){this.X4j=0;this.j_=this.GZ=null;this.nqe=a;this.GS=b;this.J6b=c.pptEditorConsistencyCheckIsEnabled;
this.Mle=c.pptProofingLogWorkflowExceptionEnabled;this.J8=f;this.Kne=new wu(Object(C.a)(this,this.nEe,"requestAL"))}get HF(){return"ProofingTileCheckWacALWorkflow"}get proto(){return'syntax="proto3";message AugEditorServiceTileCheckRequest { string Topic = 1; string Data = 2; string ContextId = 3; string Telemetry = 4; string DashboardTelemetry = 5; };message AugEditorServiceTileCheckResponse { string  Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; string Telemetry = 6; string DashboardTelemetry = 7; }; '}get Cnb(){this.GZ||
(this.GZ=Object.assign(new ht.a,{name:"LambdaBefore_ProofingTileCheckWacAL",inputSchema:cw.a.Hkc,outputSchema:xn.tGf,func:Object(C.a)(this,this.Z8a,"lambdaBeforeFunc")}));return this.GZ}get Rmb(){return null}get dEb(){this.j_||(this.j_=Object.assign(new ht.a,{name:"LambdaRemote_ProofingTileCheckWacAL",inputSchema:xn.tGf,outputSchema:xn.uGf,func:Object(C.a)(this,this.Oae,"lambdaRemoteFunc")}));return this.j_}nEe(a,b){if(b){var c=this.J8.MQd(a.DashboardTelemetry);c&&(c.d[Mk.DCh]=(new Date).getTime());
var f=String.format("{0}, LambdaRemoteStart:{1}",a.Telemetry,(new Date).getTime());this.GS.execute(l=>{f=String.format("{0}, RequestWacALStart:{1}",f,(new Date).getTime().toString());l.Xhc(a.Topic,a.Data,a.ContextId,w=>{this.EHa(w,f,c)},w=>{this.CHa(w,f)},Object.assign(new ew,{contextId:a.ContextId,BUc:b}))})}}Z8a(a,b,c){try{za.a.J(36962523,375,50,"{0}:LambdaBeforeStart",this.HF);const F=Object.assign(new Bo,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new Nq,{wn:Nl.vjl})});let S=String.format("LambdaBeforeStart:{0}",
F.d[Mk.Nae].toString());this.J8.track(Object.assign(new Bo,{w:F.w,p:Nl.dyg}));if(a){try{var f=md.a(a.Content)}catch(fa){c(null);za.a.J(36525525,375,10,"Try parse tile response failed");return}if(f){var l=f.isSlideCritiqueReady;b=!1;var w=({pDa:b}=this.nqe.Xbl(f,++this.X4j)).returnValue;w?b&&(!this.J6b||this.J6b&&l)?(c(null),this.J8.track(Object.assign(new Bo,{w:F.w,p:Nl.cyg})),za.a.J(36962560,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.HF,a.Id,b,l)):(F.d[Mk.AUc]=
(new Date).getTime(),S=String.format("{0}, LambdaBeforeDone:{1}",S,F.d[Mk.AUc].toString()),c(Object.assign(new dw,{Topic:xn.eIi,Data:md.c(w),ContextId:f.id,Telemetry:S,DashboardTelemetry:Ik.c(F)})),za.a.J(36962562,375,50,"{0}:LambdaBeforeDone,{1}",this.HF,a.Id)):(c(null),za.a.J(36962530,375,50,"{0}:LambdaBeforeDone,RequestNull{1},",this.HF,a.Id))}else c(null)}else c(null),za.a.J(36962525,375,50,"{0}:LambdaBeforeDone,InputNull",this.HF)}catch(F){a="WACAL LambdaBefore Exception",this.Mle&&(a=String.format("WACAL LambdaBefore Exception Message: {0}, Stack: {1}",
F.message,F.stack)),za.a.J(37835210,375,10,a),c(null)}}Oae(a,b,c){za.a.J(36962564,375,50,"{0}:LambdaRemoteStart",this.HF);a?this.Kne.dw(a.ContextId,a,c):(c(null),za.a.J(36962566,375,50,"{0}:LambdaRemoteDone,InputNull",this.HF))}EHa(a,b,c){if(!u.AFrameworkApplication.Xg&&a&&a.data){var f=(new Date).getTime(),l=a.data.state;if(l){try{var w=md.a(a.data.je)}catch(F){l.BUc(null);za.a.J(36525527,375,10,"Try parse aug response failed:{0}",F.message);return}w&&(w.Telemetry=String.format("{0}, LambdaRemoteDoneAndSucceed:{1}",
b,f.toString()),c&&(c.d[Mk.ECh]=f,w.DashboardTelemetry=Ik.c(c)));l.BUc(w);za.a.J(36962571,375,50,"{0}:LambdaRemoteDone,Succeeded",this.HF)}}}CHa(a,b){!u.AFrameworkApplication.Xg&&a&&a.data&&(b=String.format("{0}, LambdaRemoteDoneAndFailed: {1}",b,(new Date).getTime().toString()),za.a.J(36525529,375,10,"Tile check request failed with: {0}, time: {1}",a.data.je,b),(a=a.data.state)&&a.BUc(null))}}Object(e.a)(yu,"ProofingTileCheckWacALWorkflow",null,[613,614]);class dj{constructor(){this.groupType=0}}
Object(e.a)(dj,"AnalyzerData",null,[]);class fo{constructor(){this.nodes=this.metadata=null}}Object(e.a)(fo,"TopologyNode",null,[]);class fw{constructor(){this.TileElements=this.AnalyzerData=this.RevisionId=this.TileId=null}}Object(e.a)(fw,"Content",null,[]);class zu{constructor(){this.value=this.typeName=this.name=this.languageId=this.id=null}}Object(e.a)(zu,"CritiqueTypeOption",null,[]);class Au{constructor(){this.isCompliant=!1;this.licenseType=0}}Object(e.a)(Au,"Descriptors",null,[]);class $x{constructor(){this.AppId=
this.SessionId=null;this.RequestOrderInSession=0;this.OverriddenCritiqueTypeOptions=this.Descriptors=this.Topology=this.Content=this.LanguageUxId=null}}Object(e.a)($x,"EditorServiceTileCheckRequest",null,[]);class lp{constructor(){this.indentationLevel=this.listLevel=this.listType=0;this.listTag=null;this.listElementIndex=this.listNumeration=0}}Object(e.a)(lp,"ListMetadata",null,[]);var it;(function(a){a[a.Undefined=0]="Undefined";a[a.AlphaLcParenBoth=1]="AlphaLcParenBoth";a[a.AlphaUcParenBoth=2]=
"AlphaUcParenBoth";a[a.AlphaLcParenR=3]="AlphaLcParenR";a[a.AlphaUcParenR=4]="AlphaUcParenR";a[a.AlphaLcPeriod=5]="AlphaLcPeriod";a[a.AlphaUcPeriod=6]="AlphaUcPeriod";a[a.ArabicParenBoth=7]="ArabicParenBoth";a[a.ArabicParenR=8]="ArabicParenR";a[a.ArabicPeriod=9]="ArabicPeriod";a[a.ArabicPlain=10]="ArabicPlain";a[a.RomanLcParenBoth=11]="RomanLcParenBoth";a[a.RomanUcParenBoth=12]="RomanUcParenBoth";a[a.RomanLcParenR=13]="RomanLcParenR";a[a.RomanUcParenR=14]="RomanUcParenR";a[a.RomanLcPeriod=15]="RomanLcPeriod";
a[a.RomanUcPeriod=16]="RomanUcPeriod";a[a.CircleNumDbPlain=17]="CircleNumDbPlain";a[a.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain";a[a.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain";a[a.ArabicDbPeriod=20]="ArabicDbPeriod";a[a.ArabicDbPlain=21]="ArabicDbPlain";a[a.Ea1ChsPeriod=22]="Ea1ChsPeriod";a[a.Ea1ChsPlain=23]="Ea1ChsPlain";a[a.Ea1ChtPeriod=24]="Ea1ChtPeriod";a[a.Ea1ChtPlain=25]="Ea1ChtPlain";a[a.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod";a[a.Ea1JpnKorPlain=27]="Ea1JpnKorPlain";a[a.Ea1JpnKorPeriod=
28]="Ea1JpnKorPeriod";a[a.Arabic1Minus=29]="Arabic1Minus";a[a.Arabic2Minus=30]="Arabic2Minus";a[a.Hebrew2Minus=31]="Hebrew2Minus";a[a.ThaiAlphaPeriod=32]="ThaiAlphaPeriod";a[a.ThaiAlphaParenR=33]="ThaiAlphaParenR";a[a.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth";a[a.ThaiNumPeriod=35]="ThaiNumPeriod";a[a.ThaiNumParenR=36]="ThaiNumParenR";a[a.ThaiNumParenBoth=37]="ThaiNumParenBoth";a[a.HindiAlphaPeriod=38]="HindiAlphaPeriod";a[a.HindiNumPeriod=39]="HindiNumPeriod";a[a.HindiNumParenR=40]="HindiNumParenR"})(it||
(it={}));Object(e.b)("ListNumeration",it);var jt;(function(a){a[a.Undefined=0]="Undefined";a[a.Bullet=1]="Bullet";a[a.Numbered=2]="Numbered"})(jt||(jt={}));Object(e.b)("ListType",jt);class gw{constructor(){this.tileContextDictionary=this.readingOrderTopology=this.tiles=this.overriddenCritiqueTypeOptions=this.languageUxId=this.documentSessionId=this.documentId=this.descriptors=null}}Object(e.a)(gw,"ProofingRequest",null,[]);class js{constructor(){this.Id=null;this.Type=0;this.NumberOfChildren=this.Children=
this.AnalyzerData=null;this.AreChildrenOrdered=!1}}Object(e.a)(js,"TopologyNode",null,[]);class hw{constructor(){this.nodes=null}}Object(e.a)(hw,"ReadingOrderTopology",null,[]);class iw{constructor(){this.Length=this.Start=0;this.LanguageId=null;this.DoNotCheck=!1}}Object(e.a)(iw,"Span",null,[]);class Bu{constructor(){this.elements=this.metadata=null;this.subType=0}}Object(e.a)(Bu,"TextTile",null,[]);class Cu{constructor(){this.text=null;this.textUnit=0;this.spans=this.listMetadata=this.languageId=
null;this.isClean=!1}}Object(e.a)(Cu,"TextTileElement",null,[]);class ay{constructor(){this.doNotProcess=!1;this.languageId=null;this.start=this.length=0}}Object(e.a)(ay,"TextTileElementSpan",null,[]);class ks{constructor(){this.analyzerData=null;this.numberOfChildrenOnClient=0}}Object(e.a)(ks,"TileContext",null,[]);class jw{constructor(){this.AnalyzerData=this.Text=null;this.TextUnit=0;this.LanguageId=null;this.IsClean=!1;this.Spans=null}}Object(e.a)(jw,"TileElement",null,[]);class qr{constructor(){this.tileId=
this.revisionId=null;this.tileType=0}}Object(e.a)(qr,"TileMetadata",null,[]);class Du{constructor(a,b,c,f,l,w){this.fMg=a;this.iXc=b;this.eMg=c;this.AD=f;this.Ha=l;this.qc=w;this.zXc=null}get qwg(){return u.AFrameworkApplication.fa.ka("IsSubscriptionForProofingUser")&&this.AD.dRa}get descriptors(){this.zXc||(this.zXc=this.z_i(),za.a.J(37090579,375,50,"Descriptors: {0}",md.c(this.zXc)));return this.zXc}Xbl(a,b){let c;c=!0;var f=qa.a.re(u.AFrameworkApplication.lcid);if(!f)return{returnValue:null,pDa:c};
var l=new js,w=new js;b=Object.assign(new $x,{Descriptors:this.descriptors,AppId:"powerPoint_Online",LanguageUxId:f.name,RequestOrderInSession:b,SessionId:u.AFrameworkApplication.userSessionId,Content:[],Topology:l,OverriddenCritiqueTypeOptions:this.iXc.UXd()});this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled&&(l.Id=xg.a.rWb(u.AFrameworkApplication.fa.Ia("ServerDocId")).toString(),l.Type=4,l.AnalyzerData=null,l.Children=[],l.NumberOfChildren=this.qc.wj(),l.AreChildrenOrdered=!1,w.Id=a.id,
w.Type=3,w.AnalyzerData=null,w.Children=[],w.NumberOfChildren=null,w.AreChildrenOrdered=!0,Array.add(l.Children,w));for(var F of a.drawingElems)if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled&&Array.add(w.Children,this.oll(F)),F.text&&F.text.paragraphs)for(const fa of F.text.paragraphs){if(null===fa.chars||!fa.cfRuns||!fa.cfRuns.length)continue;a=new fw;a.TileId=fa.id;a.TileElements=[];l=new jw;l.Text=fa.chars;l.TextUnit=8;if(fa.pfRuns&&fa.pfRuns.length&&fa.pfRuns[0].pf){f=fa.pfRuns[0].pf;
l.AnalyzerData={};if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==f.listType){l.AnalyzerData.ListLevel=f.lvl;var S=jt[this.DXd(f.listType)];1===f.listType?(l.AnalyzerData.ListType=S,l.AnalyzerData.ListTag=f.listTag):0===f.listType&&(l.AnalyzerData.ListType=S,l.AnalyzerData.ListNumeration=it[this.T6f(f.listNumeration)],l.AnalyzerData.ListElementIndex=f.listElementIndex)}else l.AnalyzerData.IndentLevel=f.lvl;else l.AnalyzerData.ListLevel=f.lvl;l.IsClean=!f.proofingDirty;a.RevisionId=
f.revisionId}c=c&&l.IsClean;S=0;const xa=[];let Za=null;for(const pb of fa.cfRuns)if(pb)if(f=qa.a.re(pb.cf.lang)){this.eMg.W9c(pb.cf.lang);f=Object.assign(new iw,{Start:S,Length:pb.len,LanguageId:f.name,DoNotCheck:pb.cf.noProof});Za||(Za=f.LanguageId);if(Za!==f.LanguageId||pb.cf.noProof)0<=f.Start&&0<f.Length&&f.Start+f.Length<=l.Text.length?xa.push(f):(f.Length||f.Start!==l.Text.length)&&za.a.J(36823815,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",f.Start,f.Length,l.Text.length);
S+=pb.len}else S+=pb.len;!l.IsClean&&0<xa.length&&(l.Spans=Array.clone(xa));l.LanguageId=Za;Ja.a.Xa(l.LanguageId)?za.a.J(38385410,375,15,"Empty LanguageId, span length {0}",xa.length):(a.TileElements.push(l),b.Content.push(a))}for(w=b.Content.length-1;0<=w;w--)F=b.Content[w],F.TileElements.length&&null!==F.TileElements[0].Text||(za.a.J(37091085,375,50,"Empty TileElements or empty text in tile {0}",F.TileId),Array.removeAt(b.Content,w));b.Content.length||za.a.J(37091087,375,50,"Empty tiles");return{returnValue:b,
pDa:c}}oll(a){const b=Object.assign(new js,{Id:a.id,Type:2,AnalyzerData:{},Children:[],NumberOfChildren:a.text.paragraphs.length,AreChildrenOrdered:!0});b.AnalyzerData.GroupType=a.mk.type;for(const c of a.text.paragraphs)a=Object.assign(new js,{Id:c.id,Type:1,NumberOfChildren:null,AreChildrenOrdered:!1}),Array.add(b.Children,a);return b}Wbl(a){let b;b=!0;var c=qa.a.re(u.AFrameworkApplication.lcid);if(!c)return{returnValue:null,pDa:b};var f={};c=Object.assign(new gw,{descriptors:this.WXi(this.descriptors),
languageUxId:c.name,documentSessionId:u.AFrameworkApplication.userSessionId,tiles:[],overriddenCritiqueTypeOptions:this.VXi(this.iXc.UXd()),tileContextDictionary:f,documentId:xg.a.rWb(u.AFrameworkApplication.fa.Ia("ServerDocId")).toString(),readingOrderTopology:Object.assign(new hw,{nodes:[]})});const l=this.Y_h(a,c.readingOrderTopology,f);for(var w of a.drawingElems)if(w.text&&w.text.paragraphs){a=this.pZh(w,l,f);for(const F of w.text.paragraphs)({pDa:b}=this.t0h(c.tiles,F,b)),this.h_h(F,a,f)}for(f=
c.tiles.length-1;0<=f;f--)w=c.tiles[f],w.elements.length&&null!==w.elements[0].text||(za.a.J(37091090,375,50,"Empty TileElements or empty text in tile {0}",w.metadata?w.metadata.tileId:""),Array.removeAt(c.tiles,f));c.tiles.length||za.a.J(37091092,375,50,"Empty tiles");return{returnValue:c,pDa:b}}z_i(){if(!this.fMg.descriptors)return null;const a=Array.clone(this.fMg.descriptors);for(const b of a)if(this.qwg&&"licensetype"===b.Name.toLowerCase())return b.Value="Subscription",a;this.qwg&&Array.add(a,
Object.assign(new Gm,{Name:"LicenseType",Value:"Subscription"}));return a}WXi(a){const b=new Au;for(const c of a)"iscompliant"===c.Name.toLowerCase()&&(b.isCompliant="true"===c.Value.toLowerCase()),"licensetype"===c.Name.toLowerCase()&&(b.licenseType="subscription"===c.Value.toLowerCase()?2:0);return b}DXd(a){switch(a){case 0:return 2;case 1:return 1;default:return 0}}VXi(a){const b=[];for(const c of a)a=Object.assign(new zu,{id:c.Id,languageId:c.LanguageId,value:c.Value}),b.push(a);return b}T6f(a){return a+
1}XXi(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}t0h(a,b,c){if(null===b.chars||!b.cfRuns||!b.cfRuns.length)return{returnValue:null,pDa:c};const f=new Bu;f.metadata=new qr;f.metadata.tileId=b.id;f.metadata.tileType=1;f.elements=[];const l=new Cu;l.text=b.chars;l.textUnit=4;l.listMetadata=new lp;var w=l.isClean=!1;if(b.pfRuns&&b.pfRuns.length&&b.pfRuns[0].pf){w=b.pfRuns[0].pf;if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==
w.listType){l.listMetadata.listLevel=w.lvl;var F=this.DXd(w.listType);1===w.listType?(l.listMetadata.listType=F,l.listMetadata.listTag=w.listTag):0===w.listType&&(l.listMetadata.listType=F,l.listMetadata.listNumeration=this.T6f(w.listNumeration),l.listMetadata.listElementIndex=w.listElementIndex)}else l.listMetadata.indentationLevel=w.lvl;else l.listMetadata.listLevel=b.pfRuns[0].pf.lvl,l.listMetadata.listType=this.DXd(b.pfRuns[0].pf.listType);f.metadata.revisionId=b.pfRuns[0].pf.revisionId;l.isClean=
w=!b.pfRuns[0].pf.proofingDirty;c=c&&w}F=0;const S=[];let fa=null;for(const xa of b.cfRuns)if(xa)if(b=qa.a.re(xa.cf.lang)){this.eMg.W9c(xa.cf.lang);b=Object.assign(new ay,{start:F,length:xa.len,languageId:b.name,doNotProcess:xa.cf.noProof});fa||(fa=b.languageId);if(fa!==b.languageId||xa.cf.noProof)0<=b.start&&0<b.length&&b.start+b.length<=l.text.length?S.push(b):(b.length||b.start!==l.text.length)&&za.a.J(36823817,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",b.start,b.length,
l.text.length);F+=xa.len}else F+=xa.len;!w&&0<S.length&&(l.spans=Array.clone(S));l.languageId=fa;if(Ja.a.Xa(l.languageId))return za.a.J(38385415,375,15,"Empty LanguageId, span length {0}",S.length),{returnValue:null,pDa:c};f.elements.push(l);a.push(f);return{returnValue:f,pDa:c}}Y_h(a,b,c){const f=Object.assign(new fo,{metadata:Object.assign(new qr,{tileId:a.id,tileType:2}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new ks,{analyzerData:new dj,numberOfChildrenOnClient:a.drawingElems.length});
c[a.id]=b;return f}pZh(a,b,c){const f=Object.assign(new fo,{metadata:Object.assign(new qr,{tileId:a.id}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new ks,{analyzerData:Object.assign(new dj,{groupType:this.XXi(a.mk.type)}),numberOfChildrenOnClient:a.text.paragraphs.length});c[a.id]=b;return f}h_h(a,b,c){const f=Object.assign(new fo,{metadata:Object.assign(new qr,{tileId:a.id,tileType:1}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new ks,{numberOfChildrenOnClient:0});c[a.id]=b}}Object(e.a)(Du,
"TileToTileCheckRequestTransformer",null,[612]);class Eu{constructor(){this.AD=this.K=null}get name(){return"PowerPointWebEditor.Proofing"}Yb(a){this.K=a;this.lqi();this.mqi();this.K.register(561,"Box4.Proofing.IEditorServiceErrorDetailsFactory").ma().na(()=>new Yx(u.AFrameworkApplication.fa.ka("ProofingFeedbackLoopIsEnabled"),this.K.resolve("Box4.Proofing.IProofingFeedbackLoopManager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(562,"Box4.Proofing.IProofingCritiqueCategoryInfoFilter").ma().na(()=>
new Zx(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(563,"PowerPointWebEditor.Proofing.IProofingDashboardAggregator").ma().na(()=>this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptProofingDashboardTraceEnabled?new aw(this.K.resolve("PowerPointWebEditor.IApplicationSettings")):new bw);this.K.register(Vv,"PowerPointWebEditor.Proofing.EditorServiceResultsManager").ma().na(()=>new Vv(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Box4.Proofing.IProofingTextUtility"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.K.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator"),this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));this.K.register(564,"PowerPointWebEditor.Proofing.IConsistencyCheckManager").ma().na(()=>new Uv(this.K.resolve("Box4.Graph.IGraphInstance").Cd(12),this.K.resolve("Box4.Graph.IGraphInstance").Cd(22),this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.List.IListReader")));this.K.register(Du,"PowerPointWebEditor.Proofing.TileToTileCheckRequestTransformer").as("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer").ma().na(()=>
new Du(this.K.resolve("Box4.Proofing.IProofingDescriptors"),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(gt,"PowerPointWebEditor.Proofing.CloudALResponseTransformer").as("PowerPointWebEditor.Proofing.ICloudALResponseTransformer").ma().na(()=>
new gt);this.K.register(yu,"PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>new yu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(xu,"PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>
new xu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(vu,"PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").ma().na(()=>{const b=[],c=this.K.resolve("Common.IAppSettingsManager").ka(ba.a.pa(576));this.K.resolve("Common.IAppSettingsManager").ka(ba.a.pa(772))?b.push(c?this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"):
this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")):(b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")),c&&b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));return new vu(this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),b)});this.K.register(pr.a,"Box4.Proofing.CritiqueTypeSettings").as("Box4.Proofing.ICritiqueTypeSettings").ma().na(()=>new pr.a(this.K.resolve("Box4.IRoamingServiceRequestManager"),
u.AFrameworkApplication.fa.Ia("PptRoamingServiceGetActionName"),u.AFrameworkApplication.fa.Ia("PptRoamingServiceSaveActionName")))}init(){this.K.resolve("PowerPointWebEditor.IPPTProofingDataHandlerFactory");const a=this.K.resolve("Common.IAppSettingsManager");a.gf(()=>{this.AD=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.AD.dRa=a.ka(ba.a.pa(810));this.AD.Stb=a.ka(ba.a.pa(809));this.AD.IRa=a.ka(ba.a.pa(299));if(this.AD.dRa||this.AD.Stb)this.K.resolve("Box4.Proofing.IProofingDescriptors").B5d(),
this.K.resolve("PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").initialize(),this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").initialize();this.AD.IRa&&(this.K.resolve("Box4.Proofing.IProofingConfigV2Manager").init(),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings").init());this.AD.Stb&&(this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").initialize())});this.K.resolve("Box4.IProofingManager").suspend()}dispose(){this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController").dispose();
this.AD.Stb&&this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").dispose()}lqi(){this.K.register(565,"PowerPointWebEditor.IPPTProofingDataHandlerFactory").ma().na(()=>new Zv(this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IModifiedRangeEditor"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.ISlideReader")))}mqi(){this.K.register(566,"PowerPointWebEditor.Proofing.IProofingBehaviorController").ma().na(()=>new $v(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.View.IShapeViewHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").TIj))}static main(){m.a.instance.Ec(new Eu)}}Object(e.a)(Eu,"PPTWebEditorProofingPackage",null,[2,3]);class Fu{constructor(a,b,c,f,l,w,F,S,fa,xa){this.zd=a;this.zd.Ozc(Object(C.a)(this,this.T_g,"onTextEditViewClose"));this.zd.DSb(Object(C.a)(this,this.U_g,"onTextEditViewOpen"));this.zd.a4h(Object(C.a)(this,this.VVg,"onBeforeTextEditViewClose"));this.zd.e4h(Object(C.a)(this,
this.V_g,"onTextEditViewUpdate"));this.oee=b;this.Yh=l;this.gv=w;this.CI=c;this.Ebb=f;this.$7b=F;this.n7b=S;this.Z5j=fa;this.PG=xa}get nDc(){return this.oee.instance}dispose(){this.zd.FDe(Object(C.a)(this,this.T_g,"onTextEditViewClose"));this.zd.Gcd(Object(C.a)(this,this.U_g,"onTextEditViewOpen"));this.zd.cOk(Object(C.a)(this,this.VVg,"onBeforeTextEditViewClose"));this.zd.fOk(Object(C.a)(this,this.V_g,"onTextEditViewUpdate"))}V_g(){this.n7b.EX()}U_g(a,b){a=b.$w.shapeNode;this.CI.qjc(a,!1);this.CI.Q$c(a);
this.nDc&&this.nDc.Alk(a)}VVg(a,b){this.$7b.dTd(b.$w.Gd)}T_g(a,b){a=b.$w;const c=b.$w.shapeNode,f=!!c&&c.isConnected;b.bsa?this.PG.instance&&((this.PG.instance.cvb||this.PG.instance.I7)&&2===this.PG.instance.aJ||this.PG.instance.xTc)?za.a.J(38836432,822,15,"ShapeViewElementTextEditHandler::onTextEditViewClose skipped when session is closing reason:{0}, ForceSave:{1}",this.PG.instance.aJ,this.PG.instance.xTc):(f&&c.cgd(),c.rd?(this.CI.Bxh(c),this.Ebb.mWg(),this.gv.VNe()):(this.Yh.G3a(c),this.gv.QLd())):
this.Z5j||this.CI.Bxh(c);this.CI.qjc(b.$w.shapeNode,f&&c.LRc);this.nDc&&!a.jp&&this.nDc.zlk(c)}}Object(e.a)(Fu,"ShapeViewElementTextEditHandler",null,[109]);class kw{constructor(a){this.Oac=null;this.B1j=a;this.reset()}Nvh(a,b){a&&this.Oac.$(a,b)}Esb(a){let b=0;this.Oac.Kb(a)&&(b=this.Oac.ga(a)?1:2);return b}wse(a){return this.B1j?1===this.Esb(a):!1}reset(){const a=this.Oac;this.Oac=new Ie.a(!1);return a}}Object(e.a)(kw,"TextEditingRevisionInfoTracker",null,[610,611]);var kt=d(1025),ke=d(570),lw=
d(406),Zh=d(826),rr=d(314);class by{constructor(){this.typeField=this.startAtField=0}}Object(e.a)(by,"CT_TextAutonumberBullet",null,[]);class dq{constructor(){this.charField=null}}Object(e.a)(dq,"CT_TextCharBullet",null,[]);class Gu{}Object(e.a)(Gu,"CT_TextNoAutofit",null,[]);class mw{}Object(e.a)(mw,"CT_TextNoBullet",null,[]);class ls{constructor(){this.lnSpcReductionField=this.fontScaleField=0}}Object(e.a)(ls,"CT_TextNormalAutofit",null,[]);class sr{constructor(){this.itemField=null}}Object(e.a)(sr,
"CT_TextSpacing",null,[]);class cy{constructor(){this.valField=0}}Object(e.a)(cy,"CT_TextSpacingPercent",null,[]);class ms{constructor(){this.tField=this.rPrField=null}}Object(e.a)(ms,"CT_WebRegularTextRun",null,[]);class dy{constructor(){this.pField=this.lstStyleField=this.bodyPrField=null}}Object(e.a)(dy,"CT_WebTextBody",null,[]);class ey{constructor(){this.lInsField=this.horzOverflowField=this.bInsField=this.anchorField=0;this.normAutofitField=this.noAutofitField=null;this.rotField=this.rInsField=
0;this.spAutoFitField=null;this.spcFirstLastParaField=!1;this.wrapField=this.vertOverflowField=this.vertField=this.tInsField=0}}Object(e.a)(ey,"CT_WebTextBodyProperties",null,[]);class mp{constructor(){this.altLangField=null;this.baselineField=0;this.bFieldSpecified=this.bField=this.baselineFieldSpecified=!1;this.blipFillField=null;this.capField=0;this.capFieldSpecified=!1;this.defsymField=this.deflatinField=this.defeaField=this.defcsField=this.csField=null;this.dirtyField=!1;this.embedImgLocField=
this.effectLstField=this.effectDagField=this.eaField=null;this.errField=!1;this.hlinkMouseOverField=this.hlinkClickField=this.highlightField=this.grpFillField=this.gradFillField=null;this.isDefFontFieldSpecified=this.isDefFontField=this.iFieldSpecified=this.iField=!1;this.kernField=0;this.kernFieldSpecified=!1;this.noFillField=this.lnField=this.latinField=this.langField=null;this.normalizeHFieldSpecified=this.normalizeHField=this.noProofFieldSpecified=this.noProofField=!1;this.pattFillField=null;
this.proofErrField=0;this.rawSolidFillField=null;this.rtlFieldSpecified=this.rtlField=!1;this.solidFillField=null;this.spcField=0;this.spcFieldSpecified=!1;this.stField=0;this.strikeFieldSpecified=this.strikeField=this.stFieldSpecified=!1;this.symField=null;this.szField=0;this.uFieldSpecified=this.uField=this.szFieldSpecified=!1;this.uLnTxField=this.uLnField=this.uFillTxField=this.uFillField=null;this.utField=0;this.utFieldSpecified=!1}}Object(e.a)(mp,"CT_WebTextCharacterProperties",null,[]);class go{constructor(){this.pPrField=
this.itemsField=this.endParaRPrField=null}}Object(e.a)(go,"CT_WebTextParagraph",null,[]);class lt{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.buSzTxField=this.buSzPtsField=this.buSzPctField=this.buNoneField=this.buFontTxField=this.buFontField=this.buClrTxField=this.buClrField=this.buCharField=this.buAutoNumField=null;this.defIndentFieldSpecified=this.defIndentField=!1;this.defIndentValueField=0;this.defListFieldSpecified=this.defListField=this.defIndentValueFieldSpecified=!1;this.defLnSpcField=
null;this.defMarginFieldSpecified=this.defMarginField=!1;this.defMarLValueField=0;this.defMarLValueFieldSpecified=!1;this.defSpcBefField=this.defSpcAftField=this.defRPrField=null;this.defTabSzField=0;this.eaLnBrkFieldSpecified=this.eaLnBrkField=this.defTabSzFieldSpecified=!1;this.fontAlgnField=0;this.hangingPunctFieldSpecified=this.hangingPunctField=this.fontAlgnFieldSpecified=!1;this.indentField=0;this.latinLnBrkFieldSpecified=this.latinLnBrkField=this.indentFieldSpecified=!1;this.lnSpcField=null;
this.lvlField=0;this.lvlFieldSpecified=!1;this.marLField=0;this.marLFieldSpecified=!1;this.marRField=0;this.rtlFieldSpecified=this.rtlField=this.marRFieldSpecified=!1;this.spcBefField=this.spcAftField=null}}Object(e.a)(lt,"CT_WebTextParagraphProperties",null,[]);class Hu{constructor(a,b){this.shapeText=a;this.DJb=b}}Object(e.a)(Hu,"ShapeTextState",null,[]);class nw{constructor(){this.chngTyp=0;this.repChar=this.delChar=this.insChar=this.bodyPrChng=this.paraFrmtChng=this.charFrmtChng=null}}Object(e.a)(nw,
"IncrementalRequestTextOperation",null,[]);class Ti{constructor(a,b){this.len=this.cp=0;this.cp=a;this.len=b}cG(){return this.cp+this.len}contains(a){return this.cp<=a&&a<this.cG()}mva(a){return this.contains(a.cp)||a.contains(this.cp)}OCa(a){const b=Math.max(a.cp,this.cp);return new Ti(b,Math.max(0,Math.min(a.cG(),this.cG())-1-b+1))}static copy(a){return new Ti(a.cp,a.len)}}Object(e.a)(Ti,"TextRange",null,[]);class np{constructor(a){this.rp=a}}Object(e.a)(np,"ChangeState",null,[]);const ow=(a,b)=>
{if(!(a&&b&&a.rPrField&&b.rPrField))return null;let c=!1;const f=new mp;a.rPrField.bField!==b.rPrField.bField&&(c=!0,f.bField=b.rPrField.bField,f.bFieldSpecified=b.rPrField.bFieldSpecified);a.rPrField.iField!==b.rPrField.iField&&(c=!0,f.iField=b.rPrField.iField,f.iFieldSpecified=b.rPrField.iFieldSpecified);a.rPrField.uField!==b.rPrField.uField&&(c=!0,f.uField=b.rPrField.uField,f.uFieldSpecified=b.rPrField.uFieldSpecified);a.rPrField.strikeField!==b.rPrField.strikeField&&(c=!0,f.strikeField=b.rPrField.strikeField,
f.strikeFieldSpecified=b.rPrField.strikeFieldSpecified);a.rPrField.szField!==b.rPrField.szField&&(c=!0,f.szField=b.rPrField.szField,f.szFieldSpecified=b.rPrField.szFieldSpecified);a.rPrField.spcField!==b.rPrField.spcField&&(c=!0,f.spcField=b.rPrField.spcField,f.spcFieldSpecified=b.rPrField.spcFieldSpecified);a.rPrField.kernField!==b.rPrField.kernField&&(c=!0,f.kernField=b.rPrField.kernField,f.kernFieldSpecified=b.rPrField.kernFieldSpecified);a.rPrField.capField!==b.rPrField.capField&&(c=!0,f.capField=
b.rPrField.capField,f.capFieldSpecified=b.rPrField.capFieldSpecified);a.rPrField.baselineField!==b.rPrField.baselineField&&(c=!0,f.baselineField=b.rPrField.baselineField,f.baselineFieldSpecified=b.rPrField.baselineFieldSpecified);!b.rPrField.latinField||a.rPrField.latinField&&a.rPrField.latinField.typefaceField===b.rPrField.latinField.typefaceField||(c=!0,f.latinField=b.rPrField.latinField);!b.rPrField.eaField||a.rPrField.eaField&&a.rPrField.eaField.typefaceField===b.rPrField.eaField.typefaceField||
(c=!0,f.eaField=b.rPrField.eaField);return c?f:null},pw=(a,b)=>{if(!(a&&b&&a.pPrField&&b.pPrField))return null;a=a.pPrField;b=b.pPrField;const c=new lt;let f=!1;eq(a.lnSpcField,b.lnSpcField)&&(c.lnSpcField=b.lnSpcField,f=!0);eq(a.defLnSpcField,b.defLnSpcField)&&(c.defLnSpcField=b.defLnSpcField,f=!0);eq(a.spcBefField,b.spcBefField)&&(c.spcBefField=b.spcBefField,f=!0);eq(a.defSpcBefField,b.defSpcBefField)&&(c.defSpcBefField=b.defSpcBefField,f=!0);eq(a.spcAftField,b.spcAftField)&&(c.spcAftField=b.spcAftField,
f=!0);eq(a.defSpcAftField,b.defSpcAftField)&&(c.defSpcAftField=b.defSpcAftField,f=!0);md.c(a.defRPrField)!==md.c(b.defRPrField)&&(c.defRPrField=b.defRPrField,f=!0);!a.buNoneField!==!b.buNoneField&&(c.buNoneField=b.buNoneField,f=!0);md.c(a.buCharField)!==md.c(b.buCharField)&&(c.buCharField=b.buCharField,f=!0);md.c(a.buAutoNumField)!==md.c(b.buAutoNumField)&&(c.buAutoNumField=b.buAutoNumField,f=!0);md.c(a.buFontField)!==md.c(b.buFontField)&&(c.buFontField=b.buFontField,f=!0);if(a.marLFieldSpecified!==
b.marLFieldSpecified||a.marLField!==b.marLField)c.marLFieldSpecified=b.marLFieldSpecified,c.marLField=b.marLField,f=!0;if(a.defMarLValueFieldSpecified!==b.defMarLValueFieldSpecified||a.defMarLValueField!==b.defMarLValueField)c.defMarLValueFieldSpecified=b.defMarLValueFieldSpecified,c.defMarLValueField=b.defMarLValueField,f=!0;if(a.marRFieldSpecified!==b.marRFieldSpecified||a.marRField!==b.marRField)c.marRFieldSpecified=b.marRFieldSpecified,c.marRField=b.marRField,f=!0;if(a.lvlFieldSpecified!==b.lvlFieldSpecified||
a.lvlField!==b.lvlField)c.lvlFieldSpecified=b.lvlFieldSpecified,c.lvlField=b.lvlField,f=!0;if(a.indentFieldSpecified!==b.indentFieldSpecified||a.indentField!==b.indentField)c.indentFieldSpecified=b.indentFieldSpecified,c.indentField=b.indentField,f=!0;if(a.defIndentFieldSpecified!==b.defIndentFieldSpecified||a.defIndentField!==b.defIndentField)c.defIndentFieldSpecified=b.defIndentFieldSpecified,c.defIndentField=b.defIndentField,f=!0;if(a.algnFieldSpecified!==b.algnFieldSpecified||a.algnField!==b.algnField)c.algnFieldSpecified=
b.algnFieldSpecified,c.algnField=b.algnField,f=!0;if(a.defTabSzFieldSpecified!==b.defTabSzFieldSpecified||a.defTabSzField!==b.defTabSzField)c.defTabSzFieldSpecified=b.defTabSzFieldSpecified,c.defTabSzField=b.defTabSzField,f=!0;if(a.rtlFieldSpecified!==b.rtlFieldSpecified||a.rtlField!==b.rtlField)c.rtlFieldSpecified=b.rtlFieldSpecified,c.rtlField=b.rtlField,f=!0;if(a.defListFieldSpecified!==b.defListFieldSpecified||a.defListField!==b.defListField)c.defListFieldSpecified=b.defListFieldSpecified,c.defListField=
b.defListField,f=!0;if(a.defMarginFieldSpecified!==b.defMarginFieldSpecified||a.defMarginField!==b.defMarginField)c.defMarginFieldSpecified=b.defMarginFieldSpecified,c.defMarginField=b.defMarginField,f=!0;if(a.eaLnBrkFieldSpecified!==b.eaLnBrkFieldSpecified||a.eaLnBrkField!==b.eaLnBrkField)c.eaLnBrkFieldSpecified=b.eaLnBrkFieldSpecified,c.eaLnBrkField=b.eaLnBrkField,f=!0;if(a.fontAlgnFieldSpecified!==b.fontAlgnFieldSpecified||a.fontAlgnField!==b.fontAlgnField)c.fontAlgnFieldSpecified=b.fontAlgnFieldSpecified,
c.fontAlgnField=b.fontAlgnField,f=!0;if(a.latinLnBrkFieldSpecified!==b.latinLnBrkFieldSpecified||a.latinLnBrkField!==b.latinLnBrkField)c.latinLnBrkFieldSpecified=b.latinLnBrkFieldSpecified,c.latinLnBrkField=b.latinLnBrkField,f=!0;return f?c:null},eq=(a,b)=>a||b?a&&b?a.itemField.valField!==b.itemField.valField:!0:!1;class ns{constructor(){this.Gn=this.mFa=null}}Object(e.a)(ns,"TextParaRange",null,[]);class mt{constructor(){this.Gn=this.$Fa=null}}Object(e.a)(mt,"TextRunRange",null,[]);class os{constructor(a,
b,c,f,l,w){this.Yca=this.Fka=null;this.J3=this.tja=0;this.MK=this.W2=null;this.Yta=this.VDa=0;this.XDa=c;this.BFa=f;this.uja=l;this.L8=w;this.Sfd(new Ti(0,a.shapeText.length),new Ti(0,b.shapeText.length))}Sfd(a,b){this.Fka=a;this.Yca=b;for(a=Math.max(0,this.VDa-1);a<this.XDa.length;a++)if(this.XDa[a].Gn.mva(this.Fka)||this.Fka.cG()<=this.XDa[a].Gn.cp){this.VDa=a;break}for(a=Math.max(0,this.Yta-1);a<this.BFa.length;a++)if(this.BFa[a].Gn.mva(this.Yca)||this.Yca.cG()<=this.BFa[a].Gn.cp){this.Yta=a;break}this.MK=
this.W2=null;for(a=Math.max(0,this.tja-1);a<this.uja.length;a++)if(this.uja[a].Gn.mva(this.Fka)||this.Fka.cG()<=this.uja[a].Gn.cp){this.tja=a;break}for(a=Math.max(0,this.J3-1);a<this.L8.length;a++)if(this.L8[a].Gn.mva(this.Yca)||this.Yca.cG()<=this.L8[a].Gn.cp){this.J3=a;break}}$Sf(){return this.VDa>=this.XDa.length?null:Object.assign(new ns,{mFa:this.XDa[this.VDa].mFa,Gn:this.XDa[this.VDa].Gn.OCa(this.Fka)})}aTf(){return this.Yta>=this.BFa.length?null:Object.assign(new ns,{mFa:this.BFa[this.Yta].mFa,
Gn:this.BFa[this.Yta].Gn.OCa(this.Yca)})}bTf(){return this.U7d()&&this.W2?Object.assign(new mt,{$Fa:this.uja[this.tja].$Fa,Gn:this.W2}):null}cTf(){return this.c3b()&&this.MK?Object.assign(new mt,{$Fa:this.L8[this.J3].$Fa,Gn:this.MK}):null}T7d(){return this.lrg()&&this.b3b()}lrg(){return this.VDa>=this.XDa.length?!1:this.XDa[this.VDa].Gn.mva(this.Fka)}b3b(){return this.Yta>=this.BFa.length?!1:this.BFa[this.Yta].Gn.mva(this.Yca)}U7d(){return!this.lrg()||this.tja>=this.uja.length?!1:this.uja[this.tja].Gn.mva(this.XDa[this.VDa].Gn)&&
this.uja[this.tja].Gn.mva(this.Fka)}c3b(){return!this.b3b()||this.J3>=this.L8.length?!1:this.L8[this.J3].Gn.mva(this.BFa[this.Yta].Gn)&&this.L8[this.J3].Gn.mva(this.Yca)}jxh(){this.T7d()&&(this.VDa++,this.Yta++);return this.T7d()}kxh(){this.b3b()&&this.Yta++;return this.b3b()}Jnl(){if(!this.U7d()||!this.c3b())return!1;if(this.W2&&this.MK){this.W2.cG()===this.uja[this.tja].Gn.cG()&&this.tja++;this.MK.cG()===this.L8[this.J3].Gn.cG()&&this.J3++;if(!this.U7d()||!this.c3b())return!1;var a=this.uja[this.tja].Gn.OCa(this.Fka);
this.W2.cp=Math.max(a.cp,this.W2.cG());this.W2.len=a.cG()-this.W2.cp;a=this.L8[this.J3].Gn.OCa(this.Yca);this.MK.cp=Math.max(a.cp,this.MK.cG());this.MK.len=a.cG()-this.MK.cp}else this.W2=this.uja[this.tja].Gn.OCa(this.Fka),this.MK=this.L8[this.J3].Gn.OCa(this.Yca);a=Math.min(this.W2.len,this.MK.len);this.W2.len=a;this.MK.len=a;return 0<a}Knl(){if(!this.c3b())return!1;this.W2||(this.W2=this.uja[this.tja].Gn.OCa(this.Fka));if(this.MK){if(this.MK.cG()===this.L8[this.J3].Gn.cG()&&(this.J3++,!this.c3b()))return!1;
const a=this.L8[this.J3].Gn.OCa(this.Yca);this.MK.cp=Math.max(a.cp,this.MK.cG());this.MK.len=a.cG()-this.MK.cp}else this.MK=this.L8[this.J3].Gn.OCa(this.Yca);return 0<this.MK.len}}Object(e.a)(os,"TextFormatIterator",null,[]);class qw{constructor(){this.txt=this.txtrng=null}}Object(e.a)(qw,"TextModificationData",null,[]);class nt{constructor(a,b){this.textRange=new Ti(a.cp,a.len);this.text=b}}Object(e.a)(nt,"TextModificationInfo",null,[]);class rw{constructor(){this.len=this.cp=0}}Object(e.a)(rw,"TextRangeData",
null,[]);class Jm{constructor(){this.charPrp=this.txtrng=null}}Object(e.a)(Jm,"WebTextCharFormatChange",null,[]);class Co{constructor(){this.paraPrp=this.txtrng=null}}Object(e.a)(Co,"WebTextParaFormatChange",null,[]);class tr{constructor(a,b){this.aCg=this.ZTa=this.syb=this.oka=this.YS=-1;this.Pme=this.Zde=null;this.XSa=new Ti(0,0);this.Gja=new Ti(0,0);this.c_=null;if(!a)throw Error.create("InputBaseTextStateNull");if(!b)throw Error.create("InputRevisedTextStateNull");this.owb=a;this.Yab=b;let c,
f;({AFe:a,Qwe:c}=this.Ydg(a.DJb));1<a.length&&(this.aCg=a[a.length-1].Gn.cG());({AFe:b,Qwe:f}=this.Ydg(b.DJb));this.wN=new os(this.owb,this.Yab,c,f,a,b)}Poi(){this.Goi();this.Hoi();this.Roi();const a=[],b=this.Xoi();b&&a.push(b);a.push.apply(a,this.Noi());a.push.apply(a,this.Moi());a.push.apply(a,this.Ooi());return a}Ydg(a){const b=[],c=[];var f=[];var l=[];let w=0;if(!a.pField)return{AFe:f,Qwe:l};for(const F of a.pField)if(a=new ns,a.mFa=F,a.Gn=new Ti(w,0),f=0,F.itemsField&&F.itemsField.length){for(const S of F.itemsField)S.tField&&
S.tField.length&&(l=new mt,l.Gn=new Ti(w,S.tField.length),l.$Fa=S,w+=S.tField.length,f+=S.tField.length,b.push(l));w+=1;a.Gn.len=f;c.push(a)}return{AFe:b,Qwe:c}}Goi(){this.YS=this.z4c(!0)}Hoi(){this.YS===this.owb.shapeText.length?this.oka=0:(this.oka=this.z4c(!1),this.YS+this.oka>this.owb.shapeText.length?this.oka=this.owb.shapeText.length-this.YS:this.YS+this.oka>this.Yab.shapeText.length&&(this.oka=this.Yab.shapeText.length-this.YS))}Roi(){this.syb=this.owb.shapeText.length-this.YS-this.oka;this.ZTa=
this.Yab.shapeText.length-this.YS-this.oka}Noi(){const a=[];if(!this.YS)return a;this.wN.Sfd(new Ti(0,this.YS),new Ti(0,this.YS));do this.c_=this.Hwh(),0!==this.c_.rp&&a.push(this.BKc(this.c_));while(0!==this.c_.rp);return a}Xoi(){if(!this.syb&&!this.ZTa)return null;this.XSa=new Ti(this.YS,this.syb);this.Gja=new Ti(this.YS,this.ZTa);this.c_=!this.syb&&0<this.ZTa?new np(4):0<this.syb&&!this.ZTa?new np(5):new np(6);return this.BKc(this.c_)}Moi(){const a=[];if(!this.ZTa)return a;const b=new Ti(this.YS-
1,1);b.cp=Math.max(0,b.cp);b.cp=Math.min(b.cp,this.aCg-1);this.wN.Sfd(b,new Ti(this.YS,this.ZTa));do this.c_=this.bnl(),0!==this.c_.rp&&a.push(this.BKc(this.c_));while(0!==this.c_.rp);return a}Ooi(){const a=[];if(!this.oka)return a;this.c_=null;this.wN.Sfd(new Ti(this.YS+this.syb,this.oka),new Ti(this.YS+this.ZTa,this.oka));do this.c_=this.Hwh(),0!==this.c_.rp&&a.push(this.BKc(this.c_));while(0!==this.c_.rp);return a}BKc(a){if(!a)return null;const b=new nw;b.chngTyp=a.rp;switch(a.rp){case 3:b.charFrmtChng=
Object.assign(new Jm,{txtrng:this.Gja,charPrp:this.Zde});break;case 2:b.paraFrmtChng=Object.assign(new Co,{txtrng:this.Gja,paraPrp:this.Pme});break;case 4:b.insChar=tr.YOe(new nt(this.XSa,this.Yab.shapeText.substring(this.Gja.cp,this.Gja.cG())));break;case 5:b.delChar=tr.YOe(new nt(this.XSa,""));break;case 6:b.repChar=tr.YOe(new nt(this.XSa,this.Yab.shapeText.substring(this.Gja.cp,this.Gja.cG())))}return b}z4c(a){const b=this.owb.shapeText,c=this.Yab.shapeText,f=new Ti(0,b.length),l=new Ti(0,c.length);
let w=a?0:b.length-1,F=a?0:c.length-1;for(;f.contains(w)&&l.contains(F)&&b.charAt(w)===c.charAt(F);)w=a?w+1:w-1,F=a?F+1:F-1;return a?w:b.length-w-1}bnl(){do{for(;this.wN.Knl();){var a=this.wN.bTf(),b=this.wN.cTf();if(a&&b){var c=ow(a.$Fa,b.$Fa);this.XSa=Ti.copy(a.Gn);this.Gja=Ti.copy(b.Gn);if(c)return this.Zde=c,new np(3)}}if(this.wN.b3b()&&(a=this.wN.$Sf(),b=this.wN.aTf(),a&&b&&(c=pw(a.mFa,b.mFa),this.XSa=Ti.copy(a.Gn),this.Gja=Ti.copy(b.Gn),c)))return this.Pme=c,this.wN.kxh(),new np(2)}while(this.wN.kxh());
return new np(0)}Hwh(){do{for(;this.wN.Jnl();){var a=this.wN.bTf(),b=this.wN.cTf();if(a&&b){var c=ow(a.$Fa,b.$Fa);this.XSa=Ti.copy(a.Gn);this.Gja=Ti.copy(b.Gn);if(c)return this.Zde=c,new np(3)}}if(this.wN.T7d()&&(a=this.wN.$Sf(),b=this.wN.aTf(),a&&b&&(c=pw(a.mFa,b.mFa),this.XSa=Ti.copy(a.Gn),this.Gja=Ti.copy(b.Gn),c)))return this.Pme=c,this.wN.jxh(),new np(2)}while(this.wN.jxh());return new np(0)}static YOe(a){return Object.assign(new qw,{txt:a.text,txtrng:tr.Til(a.textRange)})}static Til(a){return Object.assign(new rw,
{cp:a.cp,len:a.len})}}Object(e.a)(tr,"IncrementalChangeIterator",null,[]);class sw{constructor(){this.rh=this.bh=this.increq=null}}Object(e.a)(sw,"TextLayoutDeltaClientRequestData",null,[]);class tw{constructor(){this.tb=null;this.h=this.w=0}}Object(e.a)(tw,"TextLayoutFullClientRequest",null,[]);class uw{constructor(){this.corr=this.id=null;this.h={};this.delta=this.full=null}}Object(e.a)(uw,"TextLayoutRequest",null,[]);class Iu{constructor(a,b,c,f,l,w){this.Q9b=this.ul=null;this.E7b=!0;this.tFa=
-1;this.L3j=(new Date).getTime();this.aab=this.Eja=0;this.B6b=-1;this.eee=5E3;const F=document.createElement("a");F.href=a;F.protocol="http:"===F.protocol?"ws":"wss";this.uAb=F.href;this.l3=b;this.sVb();this.IJg=c;this.xKg=f;this.k3j=l;this.fne=w.Oil;this.f0c=w.Nil;this.QMg=w.Kil;this.W1c=w.Jil;this.Kka=this.QMg;this.pJe()}onMessage(a){if(a&&a.data)if(a.data.startsWith("pong"))this.XBb(a.data);else if(a=JSON.parse(a.data)){a.h||(a.h={});a.h.bEnd=(new Date).getTime().toString();try{this.xKg&&this.xKg(a)}catch(b){za.a.J(578828128,
824,50,(this.l3?"Dark Traffic ":"")+"Exception in OnTextLayoutReceived: {0}",b.toString())}if(this.IJg){const b={Caller:"WebSocketTextLayoutFetcher.OnMessage"};b.Telemetry=a.h;b.Response=a.resp;b.First=this.E7b;this.IJg(b)}this.E7b=!1}else za.a.J(592304271,820,50,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnMessage Empty Response")}onClose(a){za.a.J(592840414,820,50,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnClose {0}",JSON.stringify(a))}onError(a){za.a.J(592840412,
820,10,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnError {0}",JSON.stringify(a))}onOpen(){za.a.J(592840410,820,50,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnOpen");this.aic();this.ping();this.k3j()}pJe(){this.Q9b=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.B6b),this.ul||(za.a.J(587522389,820,50,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Tva())):this.B6b=
window.setTimeout(()=>{this.ul&&(za.a.J(587522387,820,50,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.ul.close(),this.ul=null,window.clearTimeout(this.tFa))},this.eee)};window.self.addEventListener("visibilitychange",this.Q9b)}sVb(){this.ul&&this.ul.close();this.ul=new WebSocket(this.uAb,[]);this.ul.onopen=Object(C.a)(this,this.onOpen,"onOpen");this.ul.onerror=Object(C.a)(this,this.onError,"onError");this.ul.onclose=Object(C.a)(this,
this.onClose,"onClose");this.ul.onmessage=Object(C.a)(this,this.onMessage,"onMessage")}aic(){this.Eja=0}cHd(){0<this.W1c&&(new Date).getTime()-this.aab>this.W1c&&(this.aic(),za.a.J(587337758,820,50,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server after long pause."))}UKd(){return(new Date).getTime()-this.aab>this.Kka&&this.Eja<this.f0c&&(!this.ul||3===this.ul.readyState||2===this.ul.readyState)}uIe(){this.aab=(new Date).getTime();this.Kka=Math.pow(2,this.Eja)*this.QMg;
0<this.W1c&&(this.Kka=Math.min(this.Kka,this.W1c));window.setTimeout(()=>{this.Tva()},this.Kka)}Tva(){this.cHd();this.UKd()&&(this.sVb(),this.uIe(),this.Eja++,za.a.J(588071072,820,50,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server."),this.Eja===this.f0c&&za.a.J(588071070,820,50,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Max retries reached."))}fetch(a){this.ul?(za.a.J(587804674,820,50,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch. WebSocket state {0}",
Gp[this.ul.readyState]),1===this.ul.readyState?this.ul.send(md.c(a)):this.Tva()):za.a.J(587522383,820,50,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch Websocket is unavailable.")}ping(){this.ul?1===this.ul.readyState?this.ul.send("ping"+((new Date).getTime()-this.L3j).toString()):(za.a.J(588294232,820,10,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping. Wrong WebSocket state {0}",this.ul.readyState),this.Tva()):za.a.J(587522380,820,50,(this.l3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping Websocket is unavailable.")}XBb(){-1!==
this.tFa&&window.clearTimeout(this.tFa);this.tFa=window.setTimeout(()=>{this.ping()},this.fne)}}Object(e.a)(Iu,"WebSocketTextLayoutFetcher",null,[643]);class ur{constructor(a,b,c,f,l,w,F){this.Ozb=this.mbb=this.qFg=this.pFg=null;this.nextId=1;this.kee=-1;this.jee=0;this.Ihe=!0;if(!a)throw Error.argumentNull("shapeReader");if(!b)throw Error.argumentNull("topologyManager");if(!c)throw Error.argumentNull("clientRequestManager");if(!f)throw Error.argumentNull("walls");if(!l)throw Error.argumentNull("appSettings");
if(!w)throw Error.argumentNull("shapeViewLineBreakTelemetry");this.Fa=a;this.Rp=b;this.oda=f;this.la=l;this.mT=-1;w.execute(S=>{this.mbb=S});this.la.Qil&&(this.pFg=new Iu(this.la.Mil,!1,Object(C.a)(this,this.RUj,"logOnResponseReceived"),Object(C.a)(this,this.Amk,"onTextLayoutReceived"),Object(C.a)(this,this.rWg,"onConnectionOpen"),this.la),this.la.Q4g&&(this.qFg=new Iu(this.la.Lil,!0,Object(C.a)(this,this.QUj,"logOnDarkTrafficResponseReceived"),null,Object(C.a)(this,this.rWg,"onConnectionOpen"),this.la)));
this.Uca=F}yQ(a,b,c){za.a.J(589083531,820,50,"TextLayoutManager::OnTimeout - Fallback to HTML Text Layout for this shape ");if(-1!==this.mT){window.clearTimeout(this.mT);this.mT=-1;var f=this.Rp.presentation;f?(a=Object(ua.a)(132,f.LB(Rd.a.XD(a,b))))?(c=a.jS(c))?c.uhb(!1):za.a.J(589083525,820,50,"TextLayoutManager::OnTimeout, IShapeNode is null"):za.a.J(589083527,820,50,"TextLayoutManager::OnTimeout, ISlide is null"):za.a.J(589083529,820,50,"TextLayoutManager::OnTimeout, IPageManifestNode is null")}}PUj(){this.jee++;
-1===this.kee&&(this.kee=window.setTimeout(Object(C.a)(this,this.Tfk,"onCoauthLogTimer"),3E5))}Tfk(){this.kee=-1;za.a.J(588268935,820,50,"TextLayoutManager::LogOnCoAuth, CoAuthRequestCount {0}",this.jee);this.jee=0}Gcg(a){let b="";a.RI(c=>{(c=Object(ua.a)(Wc.AParagraphNode,c))&&(b+=db.ParagraphReader.text(c)+"\n")});return b.substr(0,b.length-1)}Qoi(a){try{var b=Object,c=b.assign,f=new sw,l=this.Ozb;const xa=[];var w,F=l.DJb.bodyPrField,S=a.DJb.bodyPrField;let Za=!1;F.anchorField!==S.anchorField&&
(Za=!0);F.bInsField!==S.bInsField&&(Za=!0);F.tInsField!==S.tInsField&&(Za=!0);F.lInsField!==S.lInsField&&(Za=!0);F.rInsField!==S.rInsField&&(Za=!0);F.horzOverflowField!==S.horzOverflowField&&(Za=!0);F.vertOverflowField!==S.vertOverflowField&&(Za=!0);md.c(F.normAutofitField)!==md.c(S.normAutofitField)&&(Za=!0);md.c(F.spAutoFitField)!==md.c(S.spAutoFitField)&&(Za=!0);F.rotField!==S.rotField&&(Za=!0);F.spcFirstLastParaField!==S.spcFirstLastParaField&&(Za=!0);F.wrapField!==S.wrapField&&(Za=!0);(w=Za?
S:null)&&xa.push(Object.assign(new nw,{chngTyp:1,bodyPrChng:w}));const pb=new tr(l,a);var fa=xa.concat.apply(xa,pb.Poi());const Mb=c.call(b,f,{increq:fa});za.a.J(574911955,820,50,"TextLayoutManager::FetchLineBreakInfo Incremental request size {0}",md.c(Mb).length);return Mb}catch(xa){za.a.J(574911956,820,10,"TextLayoutManager::Generate Incremental Requests Exception {0}",xa.message)}return null}sUd(a,b){if(this.la.Auh&&a)if(b&&za.a.J(578828109,820,50,"TextLayoutManager::FetchLineBreakInfo, TextLayout- First request for this shape sent on Begin Edit."),
this.oda.Xgi())if(0!==this.oda.bki(a,this.Fa))a.uhb(!1);else{if(!a.lxb)if(b)a.uhb(this.la.WHb);else return;if(!a.FA&&a.zra().length&&(a.SIa||4===a.HR))try{const c=this.N1d(a),f=Object.assign(new uw,{id:this.nextId.toString(),corr:xg.a.create().toString()});if(this.la.Pil)if(!this.Ozb||b||this.Ihe)this.Ozb=new Hu(this.Gcg(a),c),this.Ihe=!1;else{const w=this.Gcg(a),F=new Hu(w,c),S=kt.a.nrb(md.c(this.Ozb.DJb));f.delta=this.Qoi(F);f.delta&&(f.delta.bh=S,f.delta.rh=kt.a.nrb(md.c(F.DJb)));if(f.delta&&!f.delta.increq.length)if(this.la.XOe)f.delta=
null;else return;if(f.delta&&f.delta.increq.length)for(const fa of f.delta.increq)if(fa.repChar){fa.repChar.txtrng.len===this.Ozb.shapeText.length&&(f.delta=null);break}this.Ozb=F}f.delta&&f.delta.increq.length&&!this.la.XOe||(f.full=Object.assign(new tw,{tb:c,w:a.SIa?a.SIa.Right:a.get_widthPersisted(),h:a.SIa?a.SIa.Bottom:a.get_heightPersisted()}));this.nextId+=1;-1!==this.mT&&window.clearTimeout(this.mT);this.mT=window.setTimeout(()=>{this.yQ(a.slideId.sid,a.slideId.cid,a.get_shapeId())},this.la.Ril);
f.h={["bStart"]:(new Date).getTime().toString()};f.h.shapeId=a.get_shapeId();f.h.sid=a.slideId.sid;f.h.cid=a.slideId.cid;f.h.timeoutId=this.mT;f.h.reqHash=kt.a.nrb(md.c(c));f.h.reqSz=md.c(f).length;f.h.firstRequest=b;f.h.deltaCompare=this.la.XOe;const l=a.qdj();b&&l&&(f.h.initialTextLayout=l.toString());this.pFg.fetch(f);this.la.Q4g&&this.qFg.fetch(f)}catch(c){za.a.J(591525650,820,10,"WebSocketTextLayoutFetcher::FetchLineBreakInfo Exception {0}",c.message)}}else this.PUj(),a.uhb(!1)}UPf(a,b){switch(a.listType){case 16:b.buNoneField=
new mw;b.buCharField=null;b.buAutoNumField=null;break;case 0:b.buNoneField=null;b.buCharField=null;b.buAutoNumField=Object.assign(new by,{startAtField:a.Zz});b.buAutoNumField.typeField=8;break;default:b.buNoneField=null,b.buCharField=new dq,b.buCharField.charField="\u2022",b.buAutoNumField=null,b.buFontField=new zk,b.buFontField.typefaceField=a.font}}XPa(a){const b=new cy;b.__type=ur.HQj;b.valField=Math.floor(1E5*a);return b}Dsi(a){const b=new lt;var c=new mb.GraphIterator;c.set(a);c.oc(11);c.Og(11);
a.Sf.rx(c)?this.UPf(a.Sf.rx(c),b):this.UPf(hk.a.bV(16,0),b);c=a.ta(Sb.a.Hl,qg.a.leftMargin);const f=a.ta(Sb.a.dX,qg.a.rightMargin);b.indentField=ke.a.Xkd(a.ta(Sb.a.Jn,qg.a.indent));b.indentFieldSpecified=!0;b.marLField=ke.a.Xkd(c);b.marLFieldSpecified=!0;b.marRField=ke.a.Xkd(f);b.marRFieldSpecified=!0;b.defTabSzField=ke.a.Xkd(a.ta(Sb.a.Hpb,ur.MBc));b.defTabSzFieldSpecified=!0;b.lvlField=a.ta(Sb.a.listLevel,qg.a.zCa);b.lvlFieldSpecified=!0;b.algnField=this.Hil(a.ta(ob.a.pl,1));b.algnFieldSpecified=
!0;2===this.Uca.qV(a).lineSpacing.Of&&(b.lnSpcField=new sr,b.lnSpcField.itemField=this.XPa(this.Uca.qV(a).lineSpacing.value));2===this.Uca.qV(a).beforeSpacing.Of&&(b.spcBefField=new sr,b.spcBefField.itemField=this.XPa(this.Uca.qV(a).beforeSpacing.value));2===this.Uca.qV(a).afterSpacing.Of&&(b.spcAftField=new sr,b.spcAftField.itemField=this.XPa(this.Uca.qV(a).afterSpacing.value));a=lc.OutlineElementNavigator.uA(a);a.properties.Sa(ob.a.bX)&&(b.rtlField=a.Uh(ob.a.bX));return b}Hil(a){switch(a){case 2:return 1;
case 1:return 0;case 3:return 2;case 4:return 3;default:return 0}}N1d(a){try{const b=Object.assign(new dy,{bodyPrField:new ey,pField:[]});b.bodyPrField.noAutofitField=a.r9?new Gu:null;a.Sa(zb.a.z1)&&(b.bodyPrField.normAutofitField=new ls,b.bodyPrField.normAutofitField.fontScaleField=Math.floor(1E5*a.z1));a.Sa(zb.a.Fpa)&&(b.bodyPrField.normAutofitField||(b.bodyPrField.normAutofitField=new ls),b.bodyPrField.normAutofitField.lnSpcReductionField=Math.floor(1E5*a.Fpa));b.bodyPrField.rotField=Math.floor(a.$Oe);
b.bodyPrField.vertField=a.Z4;b.bodyPrField.lInsField=Math.floor(fe.a.aBb(a.Nga));b.bodyPrField.tInsField=Math.floor(fe.a.aBb(a.Pga));b.bodyPrField.rInsField=Math.floor(fe.a.aBb(a.Oga));b.bodyPrField.bInsField=Math.floor(fe.a.aBb(a.Mga));b.bodyPrField.anchorField=a.$ma;b.bodyPrField.wrapField=a.PTc?0:1;this.Fa.RI(a,c=>{if(c=Object(ua.a)(Wc.AParagraphNode,c)){var f=Object.assign(new go,{itemsField:[]});f.pPrField=this.Dsi(c);for(var l=db.ParagraphReader.text(c),w=0;w<c.Ra.length;){const S=new ms;S.__type=
"CT_WebRegularTextRun:#Microsoft.Office.Server.Powerpoint.Interface.Edit";var F=c.Ra.ga(w);const fa=F.cp,xa=w<c.Ra.length-1?c.Ra.ga(w+1).cp:db.ParagraphReader.textLength(c);w++;F.formatting?S.rPrField=this.Zdg(F.formatting.cache):({JUc:F}=lw.c(c.Ra,F.cp),S.rPrField=F?this.Zdg(F.cache):this.tdj(a));S.tField=Ja.a.substring(l,fa,xa);f.itemsField.push(S)}b.pField.push(f)}});return b}catch(b){throw za.a.J(591525648,820,50,"WebSocketTextLayoutFetcher::GetWebTextBody Exception {0}",b.message),Error.create("GetWebTextBodyException");
}}Zdg(a){const b=new mp;b.bField=a.isBold;b.bFieldSpecified=a.BQa;b.iField=a.isItalic;b.iFieldSpecified=a.d7a;b.uField=a.mD;b.uFieldSpecified=a.Ysb;b.strikeFieldSpecified=a.Xsb;b.strikeField=a.YE;b.szField=a.fontSize*Xj.a.Rec*Xj.a.n7a;b.szFieldSpecified=a.Era;b.baselineFieldSpecified=a.Sa(zb.a.zM);b.baselineField=a.getValue(zb.a.zM);b.capFieldSpecified=a.CQa;b.capField=a.capitalization;if(a.kig){const c=qa.a.re(a.language);b.langField=c?c.crb:"en-US"}a.Sa(zb.a.latinFont)&&(b.latinField=Object.assign(new zk,
{typefaceField:a.getValue(zb.a.latinFont)}));a.Sa(zb.a.eastAsianFont)&&(b.eaField=Object.assign(new zk,{typefaceField:a.getValue(zb.a.eastAsianFont)}));a.w2&&(b.rawSolidFillField=Object.assign(new rr.a,{srgbClrField:Object.assign(new Zh.a,{valField:Jb.a.Enb(a.fontColor)})}));a.HQa&&(b.highlightField=Object.assign(new ap.a,{srgbClrField:Object.assign(new Zh.a,{valField:Jb.a.Enb(a.highlight)})}));a.Sa(zb.a.yob)&&(b.spcField=a.getValue(zb.a.yob),b.spcFieldSpecified=!0);a.Sa(zb.a.yvb)&&(b.kernField=a.getValue(zb.a.yvb),
b.kernFieldSpecified=!0);return b}tdj(a){const b=new mp;b.bField=a.isBold;b.bFieldSpecified=!0;b.iField=a.isItalic;b.iFieldSpecified=!0;b.uField=a.mD;b.uFieldSpecified=!0;b.strikeFieldSpecified=!0;b.strikeField=a.YE;b.szField=a.d$*Xj.a.Rec;b.szFieldSpecified=!!b.szField;const c=qa.a.re(a.OPa());b.langField=c?c.crb:"en-US";a.Sa(zb.a.latinFont)&&(b.latinField=Object.assign(new zk,{typefaceField:a.getValue(zb.a.latinFont)}));a.Sa(zb.a.eastAsianFont)&&(b.eaField=Object.assign(new zk,{typefaceField:a.getValue(zb.a.eastAsianFont)}));
b.baselineField=a.zM;b.baselineFieldSpecified=!0;return b}RUj(a){if(a){za.a.J(593892499,820,50,Ik.c(a));var b=new Map;for(let l in a){var c=l,f=a[l];"First"===c&&b.set(c,f.toString());"Telemetry"===c&&b.set(c,JSON.stringify(f))}Mf.Health.instance.recordKpiUsage("TextLayoutServiceResponse",0,"pptotext",b)}else za.a.J(593892501,820,50,"response data null")}QUj(a){a?za.a.J(543307017,820,50,"Dark Traffic"+Ik.c(a)):za.a.J(543307016,820,50,"Dark Traffic response data null")}rWg(){this.Ihe=!0}I7f(a){var b=
this.Rp.presentation;if(!b)throw Error.argumentNull("Presentation is null");const c=this.khb(a,"cid"),f=this.khb(a,"sid");a=this.khb(a,"shapeId");if(!c||!f||!a)return za.a.J(590488262,820,50,"GetCurrentShapeNode - slideId or shapeId is not present in Hints"),null;b=Object(ua.a)(132,b.LB(Rd.a.XD(Number.parseInvariant(f),Number.parseInvariant(c))));return b?b.jS(Number.parseInvariant(a)):(za.a.J(591205730,820,50,"GetCurrentShapeNode - ISlide is null"),null)}Amk(a){if(!a||!a.l||!a.h)if(a&&7===a.resp&&
a.h)za.a.J(562627081,820,50,"OnTextLayoutReceived - State out of sync"),(a=this.I7f(a.h))?this.sUd(a,!0):za.a.J(562627082,820,10,"OnTextLayoutReceived - shapenode null");else{if(za.a.J(591205760,820,50,"OnTextLayoutReceived - Response data layout is null"),a&&!a.l){var b=new Map;b.set("CorrelationId",a.corr);4===a.resp?Mf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceWorkerFailure",!1,!0,Object.assign(new pk.a,{extendedProperties:b})):(b.set("ResponseCode",a.resp.toString()),
Mf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceFailureResponse",!1,!0,Object.assign(new pk.a,{extendedProperties:b})))}}else if(this.la.WHb){b=this.khb(a.h,"timeoutId");var c=this.khb(a.h,"firstRequest");if(b&&-1!==this.mT&&this.mT===Number.parseInvariant(b))window.clearTimeout(this.mT),this.mT=-1;else if(!c||!Boolean.parse(c))return;if(b=this.I7f(a.h)){var f=this.khb(a.h,"initialTextLayout");c&&Boolean.parse(c)?f&&f!==a.l.toString()?(c=new Map,c.set("CorrelationId",
a.corr),c.set("ResponseCode",a.resp.toString()),c.set("InitialTextLayoutValue",f),c.set("ResponseLayout",a.l.toString()),Mf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","ResponseMismatchForFirstShapeRequest",!1,!0,Object.assign(new pk.a,{extendedProperties:c})),za.a.J(587560471,820,50,"Fallback to HTML Text Layout for this shape - different service response on begin edit."),b.uhb(!1)):b.uhb(!0):(f=this.khb(a.h,"reqHash"))?(c=this.N1d(b),kt.a.nrb(md.c(c))!==f?za.a.J(590444128,820,50,
"OnTextLayoutReceived - Response hash doesn't match the current shapetextbody"):(this.mbb&&this.mbb.h1k(f,a.l,b),b.Sld(a.l))):za.a.J(590444130,820,50,"OnTextLayoutReceived - missing request hash")}else za.a.J(591205728,820,50,"OnTextLayoutReceived - IShapeNode is null")}}khb(a,b){return b in a?a[b].toString():null}}ur.HQj="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";ur.MBc=1440;Object(e.a)(ur,"TextLayoutManager",null,[558]);var ps;(function(a){a[a.noWall=0]="noWall";
a[a.coauth=1]="coauth";a[a.lineBreakBlobs=2]="lineBreakBlobs";a[a.table=3]="table";a[a.smartArt=4]="smartArt";a[a.nonRectShape=5]="nonRectShape"})(ps||(ps={}));Object(e.b)("TextLayoutWall",ps);var Ju=d(844);class vw{constructor(a,b){this.Ole=new Ie.a(0);if(!a)throw Error.argumentNull("coauthManager");if(!b)throw Error.argumentNull("applicationSettings");this.SSa=a;this.oda=b.Duh}V4b(a){switch(a){case 1:return!!this.oda.COAUTH;case 2:return!!this.oda.LINEBREAKBLOBS;case 3:return!!this.oda.TABLE;case 4:return!!this.oda.SMARTART;
case 5:return!!this.oda.NONRECTSHAPE}return!1}Xgi(){return!this.V4b(1)||this.SSa.zBa}pki(a,b){return a?this.V4b(2)&&Ju.a.O0f(a,b)?2:this.V4b(3)&&a.rd?3:this.V4b(4)&&a.fg?4:this.V4b(5)&&4!==a.HR?5:0:0}bki(a,b){b=this.pki(a,b);if(!this.Ole.Kb(a.nJa)||this.Ole.ga(a.nJa)!==b){const c=new Map;c.set("ShapeType",a.get_shapeTypeString());c.set("ShapeId",a.nJa.toString());c.set("IsShapeWalled",ps[b]);Mf.Health.instance.recordKpiUsage("TextLayoutServiceBlockedShapes",0,"pptotext",c);0!==b&&(c.set("TextLayoutWall",
ps[b]),Mf.Health.instance.recordKpiFailure("TextLayoutServiceBlockedShapes","TextLayoutClientWall",!1,!0,Object.assign(new pk.a,{extendedProperties:c})))}this.Ole.$(a.nJa,b);return b}}Object(e.a)(vw,"TextLayoutServiceWalls",null,[557]);class ww{constructor(a,b,c,f){this.hv=a;this.Le=b.Na;this.CN=c;this.m0j=f}initialize(){this.hv.HMa(Object(C.a)(this,this.dDf,"adjustShapeViews"))}dispose(){this.hv.oEb(Object(C.a)(this,this.dDf,"adjustShapeViews"))}dDf(a,b){if((a=b.BF)&&a.Ud&&(a=a.Ud.l2(c=>c.isEditable&&
c.UP))&&a.length)for(const c of a)if(a=Object(ua.a)(133,c.yg(this.Le)))a.$Ah(),c.rd&&a.Bn&&a.Btl(),!this.m0j||this.CN&&!b.CTc||a.mN||!a.EA||a.Xsh()}}Object(e.a)(ww,"TextLocalRenderAdjustManager",null,[109]);class ot{constructor(){this.Sac=this.Yyb=null;this.fDg=-1;this.N6b=Date.now()}Khg(){return 0<=this.fDg}}Object(e.a)(ot,"LineBreakComparison",null,[]);class fy{constructor(a){this.DG=new Ie.a;this.WIg=0;this.XIf="TextLayoutServiceAccuracy";this.kPg=a}g1k(a,b){try{if(a&&b){var c=a.hD();a.get_shapeId();
var f=kt.a.nrb(md.c(b.N1d(a)));if(!(0>c.length)){b=[];for(let l=0;l<c.length;l++){const w=mk.a.Bi(c[l],zb.a.VHb,null);w&&(b.push.apply(b,w.Lines),b.push(-1))}if(b.length){if(!this.DG.Kb(f))this.DG.add(f,new ot);else if(this.DG.ga(f).Khg())return;this.DG.ga(f).Yyb=b;this.HOf(f,a)}}}}catch(l){za.a.J(590103813,820,10,l.message)}}h1k(a,b,c){try{if(!this.DG.Kb(a))this.DG.add(a,new ot);else if(this.DG.ga(a).Khg())return;this.DG.ga(a).Sac=b;this.HOf(a,c)}catch(f){za.a.J(590103811,820,10,f.message)}}HOf(a,
b){if(this.DG.ga(a)&&this.DG.ga(a).Yyb&&this.DG.ga(a).Sac){var c=!0;if(this.DG.ga(a).Yyb.length!==this.DG.ga(a).Sac.length)c=!1;else for(var f=0;f<this.DG.ga(a).Yyb.length;f++)if(this.DG.ga(a).Yyb[f]!==this.DG.ga(a).Sac[f]){c=!1;break}za.a.J(590103809,820,50,JSON.stringify({["UniFiedResponseMatchWithLayoutServiceResponse"]:c}));f=new Map;f.set("UniFiedResponseMatchWithLayoutServiceResponse",String.format("{0}",c));b=0<=b.zra().indexOf("\u00a0");f.set("HasNoBreakSpace",b.toString());Mf.Health.instance.recordKpiUsage(this.XIf,
0,"pptotext",f);c||(f.set("UnifiedResponseLineCount",this.DG.ga(a).Yyb.length.toString()),f.set("TextLayoutResponseLineCount",this.DG.ga(a).Sac.length.toString()),Mf.Health.instance.recordKpiFailure(this.XIf,"TextLayoutServiceResponseMismatchWithUnifiedResponse",!1,!0,Object.assign(new pk.a,{extendedProperties:f})));this.DG.ga(a).fDg=Date.now()}this.Cki()}Cki(){const a=Date.now();a-this.WIg<this.kPg||(this.DG.keys.forEach(b=>{a-this.DG.get(b).N6b>this.kPg&&this.DG.remove(b);return!0}),this.WIg=a)}}
Object(e.a)(fy,"ServiceComparisonLineBreakTelemetry",null,[559]);class pt{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextEditing"}Yb(a){this.K=a;this.K.register(kw,"PowerPointWebEditor.TextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoReader").ma().na(()=>new kw(!a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));this.K.register(Fu,"PowerPointWebEditor.ShapeViewElementTextEditHandler").ma().na(()=>
new Fu(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.Oa("PowerpointPresence.ICoauthStateChangesHandler"),a.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),a.resolve("Box4.IEditingView"),a.resolve("PowerPointWebEditor.IApplicationSettings").skipProofingSaveWithNoEditHappened,
a.Oa("PowerPointWebEditor.ISessionLifetimeManager")));this.K.register(ww,"PowerPointWebEditor.TextLocalRenderAdjustManager").ma().na(()=>new ww(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptLayoutThrashingFixEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").Arg));const b=a.resolve("PowerPointWebEditor.IApplicationSettings").Auh;za.a.J(590444175,820,50,"PPTWebEditorTextEditingPackage::Configure TextLayoutEnabled:{0}",
b);b&&(this.K.register(557,"PowerPointWebEditor.ITextLayoutServiceWallManager").ma().na(()=>new vw(a.resolve("PowerPointWebEditor.CoauthManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(558,"PowerPointWebEditor.ITextLayoutManager").ma().na(()=>{try{return new ur(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.AFrameworkApplication.Be,a.resolve("PowerPointWebEditor.ITextLayoutServiceWallManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.Oa("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"))}catch(c){return za.a.J(593892503,820,10,"PPTWebEditorTextEditingPackage::Configure Exception creating TextLayoutManager: "+c),null}}),this.K.resolve("PowerPointWebEditor.ITextLayoutManager"),this.K.register(559,"PowerPointWebEditor.ITextLayoutLineBreakTelemetry").ma().na(()=>new fy(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Iil)),this.K.resolve("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"))}init(){this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker");
this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler");this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").initialize()}dispose(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler").dispose();a.Arg&&this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").dispose()}static main(){m.a.instance.Ec(new pt)}}Object(e.a)(pt,"PPTWebEditorTextEditingPackage",null,[2,3]);class Ku{constructor(){this.capabilities=
2}}Object(e.a)(Ku,"IExternalPeopleAPI",null,[]);class xw{constructor(a,b){this.OperationResult=a;this.Details=b}}Object(e.a)(xw,"ExternalGrantAccessResponse",null,[]);class Lu{constructor(a,b,c,f){this.authorImageURL=this.authorColor=this.authorID=this.authorName=null;this.authorName=a;this.authorID=b;this.authorColor=c;this.authorImageURL=f}}Object(e.a)(Lu,"PersonaIconProperties",null,[]);var qt=d(896),op=d(651),yw=d(519);class Mu extends Ku{constructor(a,b,c,f,l){super();this.CU=a;this.IQh=b;this.X2e=
c;this.HFh=l}Yok(a){this.CU.dwa=a}atMentionsEnabledAsync(){return new Promise((a,b)=>{this.CU.vqg.continueWith(c=>{c.yn||c.Sl?(Z.ULS.sendTraceTag(39068098,380,10,"AtMentionsEnabledAsync failed"),b(op.a.Yt(-2130915318))):a(this.CU.vqg.result)})})}checkUserAccess(a){return new Promise((b,c)=>{const f=this.CU.checkUserAccess([a]);f.continueWith(l=>{l.yn||l.Sl?(Z.ULS.sendTraceTag(36287067,380,10,"PeopleManager CheckUserAccess Failed"),c(op.a.Yt(-2130915318))):b(f.result.Result[0])})})}grantUsersAccess(a){Z.ULS.sendTraceTag(37582727,
380,15,"PeopleManager CheckUserAccessAndGrantPermissions usage");return new Promise((b,c)=>{const f=this.CU.Yza(a);f.continueWith(l=>{if(l.yn||l.Sl)Z.ULS.sendTraceTag(36287068,380,10,"PeopleManager CheckUserAccessAndGrantPermissions Failed"),c(op.a.Yt(-2130915318));else{l=f.result;var w=!l.Canceled;for(var F of l.Result)if(!F.UserCanWrite&&!F.UserCanReview){w=!1;break}F=new xw(w,l);b(F)}})})}getContactsForMentions(a,b,c){return new Promise((f,l)=>{const w=this.CU.getUserContacts(a,b,0,c,"AtMentions");
w.continueWith(F=>{F.yn||F.Sl?(Z.ULS.sendTraceTag(36287069,380,10,"PeopleManager GetUserContacts Failed"),l(op.a.Yt(-2130915318))):f(w.result)})})}getAuthToken(){Z.ULS.sendTraceTag(539100293,380,15,"PeopleManager GetAuthToken usage");return new Promise((a,b)=>{this.X2e.continueWith(c=>{c.yn||c.Sl?(Z.ULS.sendTraceTag(51658781,380,10,"getLokiTokenManagerTask Failed"),b(op.a.Yt(-2130915318))):this.X2e.result.E4i().then(f=>{f.isSuccess&&f.token&&0<f.token.length?(Z.ULS.sendTraceTag(539100294,380,15,"PeopleManager GetAuthToken use AAD token"),
a(f.token)):u.AFrameworkApplication.fa.Ia("LokiUserDataSignature")?(Z.ULS.sendTraceTag(539100295,380,15,"PeopleManager GetAuthToken trying alternateauth token"),this.HFh.execute(l=>{l.VVi().then(w=>{void 0!==w&&null!==w&&0<w.length?(Z.ULS.sendTraceTag(544556298,380,15,"Using LokiUserDataSignature from AlternateAuthHelper"),a(w)):0<u.AFrameworkApplication.fa.Ia("LokiUserDataSignature").length&&(Z.ULS.sendTraceTag(544556299,380,15,"Using boot LokiUserDataSignature since fail to get one from AlternateAuthHelper"),
a(u.AFrameworkApplication.fa.Ia("LokiUserDataSignature")))})})):f.isSuccess?f.token&&f.token.length||(Z.ULS.sendTraceTag(51658783,380,10,"Token is null: {0}",JSON.stringify(f)),b(op.a.Yt(-2130915318))):(Z.ULS.sendTraceTag(51658782,380,10,"GetLokiToken Failed : {0}",JSON.stringify(f)),b(op.a.Yt(-2130915318)))}).catch(f=>{Z.ULS.sendTraceTag(51658784,380,10,"Unexpected exception received from lokiTokenManager: {0}",JSON.stringify(f));b(op.a.Yt(-2130915318))})})})}getPersonaIconPropertiesArray(a){return new Promise(b=>
{const c=[];for(const l of a){let w=null;var f=l;let F=l.Email;F&&""!==F||!l.UserId||""===l.UserId||"AD"!==l.Provider||(F=yw.a.$4a(l.UserId));F&&""!==F&&(w=this.CU.qWb(F,l.Provider,u.AFrameworkApplication.$g,0),f=new qt.a(F,void 0,l.DisplayName));f=this.IQh.iCa(f,2);Array.add(c,new Lu(l.DisplayName,l.UserId,f,w))}b(c)})}}Object(e.a)(Mu,"ExternalPeopleAPI",Ku,[]);class fq{constructor(){this.g2a={};this.fjb={};this.Axd={}}get(a){let b=null;const c=this.normalize(a.DisplayName);a.UserId&&a.UserId in
this.g2a?(b=this.g2a[a.UserId],!c||c in this.fjb||(this.fjb[c]=b)):c&&c in this.fjb&&(b=this.fjb[c],a.UserId&&(c in this.Axd?(delete this.Axd[c],this.g2a[a.UserId]=b):a.UserId in this.g2a||(b=null)));return b}add(a,b){a.UserId&&(this.g2a[a.UserId]=b);const c=this.normalize(a.DisplayName);!c||c in this.fjb||(this.fjb[c]=b,a.UserId||(this.Axd[c]=!0))}$Xi(a){a=Array(a.xDc.length);for(var b=0;b<a.length;b++)a[b]=0;for(const c of va.a.pK(this.g2a))b=this.g2a[c],b.sources.contains(1)&&a[b.SNf]++;return a}normalize(a){return a?
a.toLowerCase():null}}Object(e.a)(fq,"ColorLookupDict",null,[]);class gy{constructor(a,b){this.SNf=a;this.sources=new Ua.a;this.sources.add(b)}a0h(a){this.sources.contains(a)||this.sources.add(a)}}Object(e.a)(gy,"ColorSource",null,[]);class gq{constructor(a){this.NKb=a;this.oEd=new fq;this.ebf=-1;this.QFh=0}iCa(a,b,c=!0){if(!this.NKb||!this.NKb.xDc.length)return Z.ULS.sendTraceTag(37053532,380,10,"Color table is null or empty"),null;if(a.IsAnonymous)a.UserId=a.ClientId||a.UserId||this.WTi();else if(!a.UserId&&
!a.DisplayName)return Z.ULS.sendTraceTag(37009498,380,100,"GetUserColor: Both userId and displayName are null"),null;const f=this.oEd.get(a);if(f)c=f.SNf,f.a0h(b);else{if(!c)return null;c=this.X5i();this.oEd.add(a,new gy(c,b));this.ebf=c}return this.fYi(this.NKb.xDc[c])}X5i(){const a=this.NKb.xDc.length,b=this.oEd.$Xi(this.NKb),c=this.Fkg(this.ebf,a);let f=c,l=!1;for(;f!==c||!l;)if(b[f])(f=this.Fkg(f,a))||(l=!0);else break;l&&Z.ULS.sendTraceTag(37009497,380,50,"GetNextColorIndex: relooped the color table.");
return f}Fkg(a,b){return(a+1)%b}WTi(){return"anonymous"+ ++this.QFh}fYi(a){return 16777215>=a?"#"+Ja.a.Dv((a&255)<<16|a&65280|(a&16711680)>>>16,6):null}}Object(e.a)(gq,"PeopleColorUtils",null,[689]);class rt{constructor(a,b,c,f,l,w){this.wqg=new ak.a;this.Foa=a;this.f2a=b;this.cyf=f;this.mb=c;this.$ea=l;this.gyf=w;this.mb.gf(()=>{this.fullAppSettingsReady()})}fullAppSettingsReady(){const a=u.AFrameworkApplication.yhb||u.AFrameworkApplication.XP,b=this.mb.ka("PeopleEndPointIsEnabled");let c=b&&!a&&
(this.nec||this.xHb&&this.yHb);const f=this.mb.ka("DisableAtmentionsForTeams"),l=this.mb.ka("ConsumerMentionsHostIsEnabled")||this.cyf.Csh;c=c&&l&&this.Ash&&this.zsh&&!f;this.mb.ka("ConsumerMentionsHostIsEnabled")&&(c=c&&this.mb.ka("OneDriveConsumerMentionsIsEnabled"));Z.ULS.sendTraceTag(37083014,380,50,"isAtMentionsEnabled:{0}, PeopleEndPointIsEnabled:{1}, PermissionsPostMessage:{2}, SupportsCheckUserAccess:{3}, SupportsGrantUserAccess:{4}, SupportsAddActivities:{5}, IsAnonymousUser:{6}, SupportsActivitiesNotification:{7}",
c,b,this.nec,this.xHb,this.yHb,this.Ash,a,this.zsh);this.wqg.Ig(c);c&&this.$ea&&this.$ea.Ak(4,Object(C.a)(this,this.bve,"onInteractiveReady"))}bve(){const a=this.mb.Gc("NumberOfContactsToFetchOnBoot",100);0>=a||this.getUserContacts("",a,0,!1,"AtMentions").continueWith(b=>{(b.Sl||b.yn)&&Z.ULS.sendTraceTag(50402056,380,50,"Failed to prefetch contacts on boot")})}get xHb(){return this.f2a.xHb}get lae(){return this.gyf.lae}get yHb(){return this.f2a.yHb}get nec(){return this.f2a.nec}get Ash(){return this.mb.ka("SupportsAddActivities")}get zsh(){return this.mb.ka("SupportsActivitiesNotification")}Yza(a){return this.f2a.Yza(a)}dWb(a,
b){return this.f2a.dWb(a,b)}get vqg(){return this.wqg.task}get dwa(){return this.Foa.dwa}set dwa(a){this.Foa.dwa=a}checkUserAccess(a){Z.ULS.sendTraceTag(37083015,380,50,"CheckUserAccess");return this.f2a.checkUserAccess(a)}grantUserAccess(a,b,c,f,l){return this.f2a.grantUserAccess(a,b,c,f,l)}getUserContacts(a,b,c,f,l){return this.cyf.getUserContacts(a,b,c,f,l)}qWb(a,b,c,f){return this.gyf.qWb(a,b,c,f)}supportsExchangeRestApis(){const a=new ak.a,b=this.Foa.supportsExchangeRestApis();b.continueWith(()=>
{b.Sl||b.yn?a.Ig(!1):a.Ig(!0)});return a.task}}Object(e.a)(rt,"PeopleManager",null,[687,685]);var Do=d(367);class Nu{}Object(e.a)(Nu,"CheckUserAccessRequestItem",null,[]);class Ou extends Do.a{constructor(a,b,c){super(a,b);this.Users=null;this.Users=this.oOd(c)}oOd(a){const b=[];for(const c of a)Array.add(b,Object.assign(new Nu,{Id:c.UserId,Provider:c.Provider}));return b}Lk(){return 1}}Object(e.a)(Ou,"CheckUserAccessRequest",Do.a,[]);class zw extends Do.a{constructor(a,b,c,f,l,w,F){super(a,b);this.Filter=
null;this.Skip=this.Limit=0;this.SearchGal=!1;this.Scenario=null;this.Filter=c;this.Limit=f;this.SearchGal=w;this.Skip=l;this.Scenario=F}Lk(){return 2}}Object(e.a)(zw,"GetUserContactsRequest",Do.a,[]);class Aw extends Do.a{constructor(a,b,c,f,l,w,F){super(a,b);this.Scenario=this.Users=null;this.GrantReviewAccess=this.GrantWriteAccess=this.GrantReadAccess=!1;this.Users=this.oOd(c);this.Scenario=f;this.GrantReadAccess=l;this.GrantWriteAccess=w;this.GrantReviewAccess=F}oOd(a){const b=[];for(const c of a)Array.add(b,
Object.assign(new Nu,{Id:c.UserId,Provider:c.Provider}));return b}Lk(){return 4}}Object(e.a)(Aw,"GrantUserAccessRequest",Do.a,[]);class Bw extends Do.a{constructor(a,b){super(a,b)}Lk(){return 5}}Object(e.a)(Bw,"SupportsExchangeRestApisRequest",Do.a,[]);var vr=d(518);class qs{constructor(a,b,c,f){this.dwa=null;this.fSh=a;this.LZa=b;this.mb=c;this.WZa=f}get yQk(){return this.mb.Gc("GetUserContactsRequestSentTimeoutMs",6E4)}checkUserAccess(a){if(!a||!a.length)return Z.ULS.sendTraceTag(37757202,380,15,
"no user in the request"),a=new ak.a,a.setException(Error.argumentNull("Can't pass empty list to checkUserAccess calls")),a.task;Z.ULS.sendTraceTag(37757203,380,50,"CheckUserAccess: num people:{0}",a.length);const b=new ak.a,c=this.WZa.execute(new Ou(this.LZa(),null,a),(f,l,w)=>this.JGc(f,l,w,"CheckUserAccess"),this.dwa);c.continueWith(()=>{if(c.yn||c.Sl)b.FF(c.Ti);else{var f=this.brk(c.result.Qi);b.Ig(f)}});return b.task}grantUserAccess(a,b,c,f,l){if(!a||!a.length)return Z.ULS.sendTraceTag(37757204,
380,15,"no user in the request"),a=new ak.a,a.Ig(null),a.task;Z.ULS.sendTraceTag(37757205,380,15,"GrantUserAccess: num people:{0}, scenario:{1}, read:{2}, write:{3}, review:{4}",a.length,b,c,f,l);const w=new ak.a,F=this.WZa.execute(new Aw(this.LZa(),null,a,b,c,f,l),(S,fa,xa)=>this.JGc(S,fa,xa,"GrantUserAccess"),this.dwa);F.continueWith(()=>{if(F.yn||F.Sl)Z.ULS.sendTraceTag(37028121,380,15,"GetUserAccess: request failed: {0}",F.Ti),w.FF(F.Ti);else{var S=this.Fqk(F.result.Qi);w.Ig(S)}});return w.task}brk(a){if(!a.data)return Z.ULS.sendTraceTag(24749450,
380,10,"CheckUserAccessResponse: Data is null"),null;if(!a.data.je)return Z.ULS.sendTraceTag(24749451,380,10,"CheckUserAccessResponse: ResponseData is null"),null;a=vr.a.q4a(a.data.je);return a?a.Result?a.Result:(Z.ULS.sendTraceTag(24749453,380,10,"CheckUserAccessResponse: Result field is null."),null):(Z.ULS.sendTraceTag(24749452,380,10,"CheckUserAccessResponse: Failed parsing the response"),null)}Fqk(a){if(!a.data)return Z.ULS.sendTraceTag(33645598,380,10,"GrantUserAccessResponse: Data is null"),
null;if(!a.data.je)return Z.ULS.sendTraceTag(33645599,380,10,"GrantUserAccessResponse: ResponseData is null"),null;a=vr.a.q4a(a.data.je);return a?a.Result?a.Result:(Z.ULS.sendTraceTag(33645601,380,10,"GrantUserAccessResponse: Result field is null."),null):(Z.ULS.sendTraceTag(33645600,380,10,"GrantUserAccessResponse: Failed parsing the response"),null)}getUserContacts(a,b,c,f,l){const w=new ak.a,F=this.WZa.execute(new zw(this.LZa(),null,a,b,c,f,l),(S,fa,xa)=>this.JGc(S,fa,xa,"GetUserContacts"),this.dwa);
F.continueWith(()=>{if(F.yn||F.Sl)w.FF(F.Ti);else{var S=F.result;try{const fa=this.ark(S.Qi);w.Ig(fa.Result)}catch(fa){w.FF(fa)}}});return w.task}ark(a){if(!a.data)throw Error.create("ParseUserContactsFromResponse: Data is null");if(!a.data.je)throw Error.create("ParseUserContactsFromResponse: ResponseData is null");a=vr.a.q4a(a.data.je);if(!a)throw Error.create("ParseUserContactsFromResponse: Failed parsing the response");if(!a.Result)throw Error.create("ParseUserContactsFromResponse: Result field is null.");
return a}supportsExchangeRestApis(){const a=new ak.a,b=this.WZa.execute(new Bw(this.LZa(),null),(c,f,l)=>this.JGc(c,f,l,"SupportsExchangeRestApisRequest"),this.dwa);b.continueWith(()=>{b.yn||b.Sl?(a.FF(b.Ti),Z.ULS.sendTraceTag(50657307,380,50,"SupportsExchangeRestApis: false")):(Z.ULS.sendTraceTag(50657308,380,50,"SupportsExchangeRestApis: true"),a.VL(!0))});return a.task}JGc(a,b,c,f){return this.fSh.umb(a,2,c,b,2,f,null,!1,null,this.yQk)}}Object(e.a)(qs,"PeopleRequestHandler",null,[688]);class hy{constructor(a,
b){this.CU=a;this.Da=b;this.Da.ya(G.a.iki,de.a.frame,Object(C.a)(this,this.dki,"checkUserAccessAction"));this.Da.ya(G.a.Gej,de.a.frame,Object(C.a)(this,this.Fej,"getUserContactsAction"));this.Da.ya(G.a.hki,de.a.frame,Object(C.a)(this,this.fki,"checkUserAccessAndGrantPermissionsAction"));this.Da.ya(G.a.Kej,de.a.frame,Object(C.a)(this,this.Jej,"getUserProfilePictureAction"));this.Da.ya(G.a.Qfl,de.a.frame,Object(C.a)(this,this.Rfl,"supportsExchangeRestApisTestAction"))}Rfl(){this.supportsExchangeRestApis();
return 32}dki(){const a=prompt("Check User Access:Enter user names separated by ;");this.checkUserAccess(a);return 32}Fej(){const a=prompt("Get user contacts:filter;limit;skip;searchGal");this.getUserContacts(a);return 32}fki(){const a=prompt("CheckUserAccessAndGrantPermissions PostMessage: u1;u2;u3");this.Yza(a);return 32}Jej(){const a=prompt("Get user profile picture: userid;provider;dimension (e.g 48, 64, 96)");this.Geg(a);return 32}Mfh(){const a=prompt("What's the operation you want to do:\r\n1) Check User Access \r\n2) Grant user access \r\n3) Check User Access And Grant Permissions \r\n4) GetUserContacts \r\n5) Get User Profile Picture \r\n6) SupportsExchangeRestApis \r\n7) Exit");
try{switch(a){case "1":this.checkUserAccess(prompt("Check User Access: u1;u2;u3"));break;case "2":this.grantUserAccess();break;case "3":this.Yza(prompt("CUAGP: u1;u2;u3"));break;case "4":this.getUserContacts(prompt("Get User Contacts:filter;limit;skip;searchGal"));break;case "5":this.Geg(prompt("Get User profile picture:userid;provider;dimension;"));break;case "6":this.supportsExchangeRestApis();break;case "7":return}}catch(b){alert(b.message)}co.Task.delay(5E3).continueWith(()=>{this.Mfh()})}LTk(){window.setTimeout(Object(C.a)(this,
this.Mfh,"runOperations"),1E4)}supportsExchangeRestApis(){const a=this.CU.supportsExchangeRestApis();a.continueWith(b=>{if(b.Sl)alert("Exception: "+b.Ti.message);else{b=a.result;var c=new hf.StandardDialog;c.vd=0;c.Pe(1,"Close");document.createElement("pre").innerText=b.toString();c.Tw("SupportsExchangeRestApis check returned",b.toString(),3,null)}})}Geg(a){a=a.split(";");const b=a[0],c=a[1];a=a[2];let f;try{f=this.L_i(a)}catch(l){alert("Invalid dimension value");return}lb.a.instance.Oa("Common.App.People.IPeopleManager").execute(l=>
{var w=l.qWb(b,c,u.AFrameworkApplication.$g,f);l=document.createElement("img");l.src=w;w=new hf.StandardDialog;w.vd=0;w.Pe(1,"Close");w.Tw("Profile photo",null,3,null,l)})}L_i(a){if(!a)return 0;switch(a){case "48":return 1;case "64":return 2;case "96":return 3;case "120":return 4;case "240":return 5;case "360":return 6;case "432":return 7;case "504":return 8;case "default":return 0;default:throw Error.argumentOutOfRange("unknown dimension");}}checkUserAccess(a){a=a.split(";");a=this.CU.dWb(a,"O365");
const b=this.CU.checkUserAccess(a);b.continueWith(c=>{if(c.Sl)alert("Exception: "+c.Ti.message);else{var f=b.result;c="";for(var l of f.Result)c+=l.Id+"=>"+(l.UserCanWrite?"Write":"No Write")+"\r\n";l=new hf.StandardDialog;l.vd=0;l.Pe(1,"Close");f=document.createElement("pre");f.innerText=c;l.Tw("Check User Access Results",null,3,null,f)}})}grantUserAccess(){var a=prompt("GRANT_USER_ACCESS\n\nEnter semicolon-separated user names.\n\nInclude CantGrant or NotExist in names to return CannnotGrantPermission and UserDoesNotExist on Blue Chicken.\n");
const b=prompt("Enter scenario (mention or share):"),c=prompt("Enter the list of permissions to grant (e.g. Read Write Review).");a=a.split(";");a=this.CU.dWb(a,"O365");const f=0<=c.toUpperCase().indexOf("READ"),l=0<=c.toUpperCase().indexOf("WRITE"),w=0<=c.toUpperCase().indexOf("REVIEW"),F=this.CU.grantUserAccess(a,b,f,l,w);F.continueWith(S=>{if(S.Sl)alert("Exception: "+S.Ti.message);else{S=F.result;var fa="RESULTS OF GRANT_USER_ACCESS CALL\n==========================\nScenario: "+b+"\nRequested Permissions: "+
(f?"READ":"")+(l?f?" WRITE":"WRITE":"")+(w?f||l?" REVIEW":"REVIEW":"")+"\n==========================\n\n";for(const xa of S.Result)fa+="User: "+xa.Id+"\nMessage: "+xa.Message+"\nStatus Code: "+xa.Status+"\nProvider: "+xa.Provider+"\n\n";alert(fa)}})}getUserContacts(a){var b=a.split(";");a=0<b.length?b[0]:"";var c=2<b.length?b[2]:"0",f=3<b.length?b[3]:"false";b=Number.parseInvariant(1<b.length?b[1]:"10");c=Number.parseInvariant(c);f=Boolean.parse(f);const l=this.CU.getUserContacts(a,b,c,f,"AtMentions");
l.continueWith(w=>{if(w.Sl)alert("Something went wrong"+w.Ti.message);else if(w.yn)alert("Task was canceled");else{var F=l.result;w="";for(var S of F)F="ID => "+S.Id+" \n",F+="Provider => "+S.Provider+" \n",F+="DisplayName => "+S.DisplayName+" \n",F+="GivenName => "+S.GivenName+" \n",F+="Surname => "+S.Surname+" \n",F+="Email => "+S.Email+" \n",F+="Title => "+S.Title+" \n",w+=F+"----------------------\n";S=new hf.StandardDialog;S.vd=0;S.Pe(1,"Close");F=document.createElement("pre");F.innerText=w;
S.Tw("Contacts",null,3,null,F)}})}Yza(a){a=a.split(";");a=this.CU.dWb(a,"O365");const b=this.CU.Yza(a);b.continueWith(c=>{if(c.Sl)alert("Exception: "+c.Ti.message);else{c=b.result;var f="";for(var l of c.Result){var w=[];Array.add(w,l.UserCanRead?"Read YES":"Read NO");Array.add(w,l.UserCanReview?"Review YES":"Review NO");Array.add(w,l.UserCanWrite?"Write YES":"Write NO");w=l.Id+"=>"+w.join(" | ");f+=w+"\r\n"}l=new hf.StandardDialog;l.vd=0;l.Pe(1,"Close");c=f+"\r\nDialog Canceled="+c.Canceled;f=document.createElement("pre");
f.innerText=c;l.Tw("Check User Access And Grant Permissions Post GrantUserAccessPrompt Results",null,3,null,f)}})}}Object(e.a)(hy,"PeopleTestHook",null,[]);var wr=d(216);class pp{constructor(a,b,c){this.Id=a;this.Persons=b;this.UserPermissionsVerified=c}}Object(e.a)(pp,"ShowSharingUiRequestBody",null,[]);class st{constructor(a,b){this.D1a=null;this.Uvc=new ak.a;this.HQb=new pp(this.gxi(),a,b);Z.ULS.sendTraceTag(25036160,380,50,"Creating request with {0} persons and UserPermissionsVerified {1}",this.HQb.Persons?
this.HQb.Persons.length:0,this.HQb.UserPermissionsVerified)}get ZRk(){return this.Uvc.task}get id(){return this.HQb.Id}get payload(){return this.HQb}a2k(a){this.D1a=a;this.Bwl()?this.Uvc.VL(this.D1a):this.Uvc.FF(Error.format("Format of the "+Xe.a.KLd+" body is not valid"))}setException(a){Z.ULS.sendTraceTag(37515586,380,10,"message:{0}",a.message);this.Uvc.FF(a)}gxi(){return st.ALh++}Cwl(a){if(void 0===a.Id)return Z.ULS.sendTraceTag(25036161,380,10,"Persons.Id field is missing from the postmessage showSharingUiResponse of the host"),
!1;if(void 0===a.Provider)return Z.ULS.sendTraceTag(25036162,380,10,"Persons.Provider field is missing from the postmessage showSharingUiResponse of the host"),!1;void 0===a.Reason&&(Z.ULS.sendTraceTag(25036163,380,50,"Persons.Reason field is missing from the postmessage showSharingUiResponse of the host"),a.Reason=null);return void 0===a.Status?(Z.ULS.sendTraceTag(25036164,380,10,"Person.Status field is undefined"),!1):Ja.a.Gub(a.Status)?!0:(Z.ULS.sendTraceTag(25036165,380,10,"Person.Status field is not a number"),
!1)}Bwl(){if(void 0===this.D1a.Persons)return Z.ULS.sendTraceTag(25036166,380,10,"Persons field is missing from the postmessage showSharingUiResponse of the host"),!1;if(!Ma.a.isArray(this.D1a.Persons))return Z.ULS.sendTraceTag(25036167,380,10,"Persons field is not an array"),!1;for(let a=0;a<this.D1a.Persons.length;a++)if(!this.Cwl(this.D1a.Persons[a]))return!1;return void 0===this.D1a.DialogCanceled?(Z.ULS.sendTraceTag(25036168,380,10,"DialogCanceled field is missing from the postmessage showSharingUiResponse of the host"),
!1):void 0===this.id?(Z.ULS.sendTraceTag(25036169,380,10,"Id field is undefined"),!1):Ja.a.Gub(this.id)?!0:(Z.ULS.sendTraceTag(25036170,380,10,"ID field is not a number"),!1)}}st.ALh=0;Object(e.a)(st,"PostmessageRequestState",null,[]);class rs{constructor(a){this.mAd=new wr.a;this.gNb=this.O_a=null;this.R4e=!1;this.GKa=a}wtj(){Z.ULS.sendTraceTag(25036171,380,50,"ShowSharingUiPostMessageHandler.InitAsync");if(this.gNb)return this.gNb.task;this.gNb=new ak.a;this.GKa.continueWith(()=>{Z.ULS.sendTraceTag(25036172,
380,50,"hostPostMessenger Resolved successfully");this.O_a=this.GKa.result;this.o5d();this.gNb.Ig(!0)});return this.gNb.task}o5d(){this.R4e||(Z.ULS.sendTraceTag(25190624,380,50,"InitHostPostmessenger"),this.R4e=!0,this.O_a.Qt(Xe.a.KLd),this.O_a.cB(Xe.a.KLd,Object(C.a)(this,this.gki,"checkUserAccessAndGrantPermissionsPostmessageReceived")))}gki(a){if(a=a.Values)if(void 0===a.Id||null===a.Id)Z.ULS.sendTraceTag(25036176,380,15,"ResponseBodyTask ID is null or undefined",a.Id);else{var b=null;({value:b}=
this.mAd.Nf(a.Id)).returnValue?(Z.ULS.sendTraceTag(25036178,380,50,"Detected ResponseBodyTask for message id {0}",a.Id),b.a2k(a),this.mAd.remove(a.Id)):Z.ULS.sendTraceTag(25036177,380,15,"Response does not match any postmessageRequestState in the queue. ID:{0}",a.Id)}else Z.ULS.sendTraceTag(25036175,380,15,"Postmessage ResponseBodyTask is null")}eki(a,b){const c=new st(a,b);this.wtj().continueWith(()=>{const f=xg.a.create().toString(),l=String.format("PostMessageId:{0}, CorrelationId:{1}",c.id,f);
Z.ULS.sendTraceTag(25036179,380,50,l);this.O_a.sendMessage(Xe.a.Yza,c.payload,f)||c.setException(Error.create("Failed to send the postmessage"));this.mAd.add(c.id,c)});return c.ZRk}}Object(e.a)(rs,"ShowSharingUiPostMessageHandler",null,[]);class tt{}Object(e.a)(tt,"GrantUserAccessResponse",null,[]);var Th=d(83);class Pu extends Sys.EventArgs{constructor(a,b,c,f){super();this.result=b;this.ssk=a;this.QIa=c;this.scenario=f}}Object(e.a)(Pu,"ShareAndNotifyEventArgs",Sys.EventArgs,[]);class ss{static gvi(a){return Th.a.tA(ss.Ym,
CommonUIStrings.l_ShareAndNotifyDialogText,a)}}ss.Ym="<span id='ShareAndNotifyDialogText' class='WACDialogSpan'>{0}</span> <br/> <br/> <span id='ShareAndNotifyDialogListOfUsers' class='WACDialogSpan'>{1}</span>";Object(e.a)(ss,"ShareAndNotifyDialogHtml",null,[]);class Qu extends Th.a{constructor(a,b,c){super();this.oKa=!1;this.Ta=new sd.a;this.KQh=a;this.zWh=Qu.HSi(a);this.nB=b;this.mY=c}g4h(a){this.Ta.addHandler("SNEK",a)}BLe(){this.Wf=ss.gvi(this.zWh);this.vd=8;this.kg="ShareAndNotifyDialog";this.showDialog(CommonUIStrings.l_ShareAndNotifyDialogTitle,
Object(C.a)(this,this.r5k,"shareAndNotifyDialogResultHandler"));this.D4("ShareAndNotifyDialogTextId")}Yua(){}dispose(){this.oKa||(super.dispose(),this.oKa=!0)}r5k(a){this.Ta.raiseEvent("SNEK",new Pu(this.KQh,a,this.nB,this.mY))}static HSi(a){const b=new Sys.StringBuilder;for(const c of a)b.append(0<c.DisplayName.length?c.DisplayName:c.Id),b.append(", ");return b.toString().substring(0,b.toString().length-2)}}Object(e.a)(Qu,"ShareAndNotifyDialog",Th.a,[]);class Ru{constructor(a,b,c){this.Id=a;this.Provider=
b;this.DisplayName=c}}Object(e.a)(Ru,"ShowSharingUiRequestPerson",null,[]);class ts{constructor(a,b,c,f,l,w){this.Foa=a;this.mb=b;this.VTh=c;this.IU=f;this.MGh=l;this.Md=w}get xHb(){return this.mb.ka("SupportsCheckUserAccess")}get yHb(){return this.mb.ka("SupportsGrantUserAccess")}get nec(){return this.mb.ka("PermissionsPostMessage")&&!this.mb.ka("CrossDocumentMessengerDisabled")&&this.MGh()}Yza(a){const b=new ak.a;if(Ma.a.Xa(a))return b.Ig(this.IU.LNa([])),b.task;let c;const f=({dUb:c}=this.IU.pTe(a)).returnValue,
l=ts.Esi(f);0<f.length?this.nec?this.m$k(f,b,c,l):this.xHb&&this.yHb&&this.BLe(l,b,"mention"):b.Ig(this.IU.LNa(a));return b.task}m$k(a,b,c,f){const l=Date.now();Z.ULS.sendTraceTag(37822867,380,15,"ShowHostSharingUi-Usage");const w=this.VTh.eki(f,c);c=new Se.a(4,1,this.mb.Gc("GrantPermissionSharingDialogWatchdogInternal",12E4),Object(C.a)(this,this.checkToMakeSureDialogWasOpened,"checkToMakeSureDialogWasOpened"),100);this.Md.Hb(c);c.customData=w;w.continueWith(F=>{if(F.Sl)Z.ULS.sendTraceTag(36300673,
380,15,"CheckUserAccessAndGrantPermissions via PostMessage failed with exception. {0}",F.Ti?F.Ti.message:"No inner exception"),b.FF(F.Ti);else{F=w.result;this.IU.Iql(F);var S=this.IU.LNa(a);S.Canceled=F.DialogCanceled;b.Ig(S);Z.ULS.sendTraceTag(37791043,380,15,"CheckUserAccessAndGrantPermissions finished in {0}ms",Date.now()-l)}})}checkToMakeSureDialogWasOpened(a){Z.ULS.sendTraceTag(37822868,380,15,"ShowHostSharingUi-WatchDog-Usage");(a=a.customData)?a.yn?Z.ULS.sendTraceTag(37791045,380,10,"Show Sharing UI task is canceled"):
a.Sl?Z.ULS.sendTraceTag(37791046,380,10,"Show Sharing UI task has faulted"):a.isCompleted||Z.ULS.sendTraceTag(37791047,380,10,"We have not got a response from host in long time"):Z.ULS.sendTraceTag(37791044,380,10,"Response of Sharing UI is null")}BLe(a,b,c){a=new Qu(a,b,c);a.g4h(Object(C.a)(this,this.Olk,"onShareAndNotify"));a.BLe()}Olk(a,b){let c;const f=ts.Isi(b.ssk);switch(b.result){case 1:this.grantUserAccess(f,b.scenario,!0,!0,!0).continueWith(l=>{l.Sl?(Z.ULS.sendTraceTag(36300674,380,15,"GrantUserAccess from OnShareAndNotify failed with exception. {0}",
l.Ti?l.Ti.message:"No inner exception"),b.QIa.FF(l.Ti)):(Z.ULS.sendTraceTag(36300675,380,50,"GrantUserAccess from OnShareAndNotify succeeded."),c=this.IU.LNa(f),c.Canceled=!1,b.QIa.Ig(c))});break;default:Z.ULS.sendTraceTag(36300676,380,50,"User cancelled Share and Notify dialog"),c=this.IU.LNa(f),c.Canceled=!0,b.QIa.Ig(c)}}checkUserAccess(a){const b=new ak.a;if(!this.xHb)return Z.ULS.sendTraceTag(36300677,380,15,"Performing a CheckUserAccess call on a host that doesn't support the operation."),b.setException(Error.invalidOperation("CheckUserAccess is not supported on this host")),
b.task;if(!a||!a.length)return b.Ig(this.IU.LNa([])),b.task;let c;const f=({dUb:c}=this.IU.pTe(a)).returnValue;if(c)Z.ULS.sendTraceTag(36300680,380,50,"CheckUserAccess response populated from cache."),b.Ig(this.IU.LNa(a));else{const l=this.Foa.checkUserAccess(f);l.continueWith(()=>{if(l.yn||l.Sl)Z.ULS.sendTraceTag(36300678,380,10,"CheckUserAccess call failed."),b.setException(Error.create("CheckUserAccess Call failed."));else{Z.ULS.sendTraceTag(36300679,380,50,"CheckUserAccess call succeeded.");var w=
l.result;w&&this.IU.Gql(w);w=this.IU.LNa(a);b.Ig(w)}})}return b.task}grantUserAccess(a,b,c,f,l){const w=new ak.a;if(!this.yHb)return Z.ULS.sendTraceTag(36300681,380,15,"Performing a GrantUserAccess call on a host that doesn't support the operation."),w.setException(Error.invalidOperation("GrantUserAccess is not supported on this host")),w.task;if(!a||!a.length)return w.Ig(this.IU.lRf([])),w.task;let F;const S=({dUb:F}=this.IU.pTe(a)).returnValue;if(F)Z.ULS.sendTraceTag(36300684,380,50,"GrantUserAccess response populated from cache."),
w.Ig(this.IU.lRf(a));else{const fa=this.Foa.grantUserAccess(S,b,c,f,l);fa.continueWith(()=>{if(fa.yn||fa.Sl)Z.ULS.sendTraceTag(36300682,380,10,"GrantUserAccess call failed."),w.setException(Error.create("GrantUserAccess Call failed."));else{Z.ULS.sendTraceTag(36300683,380,50,"GrantUserAccess call succeeded.");var xa=fa.result;this.IU.Hql(xa,c,f,l);xa=Object.assign(new tt,{Result:xa});w.Ig(xa)}})}return w.task}dWb(a,b){const c=[];for(const f of a)c.push(new qt.a(f,b));return c}static Esi(a){const b=
[];for(const c of a)a=new Ru(c.UserId,c.Provider,""),b.push(a);return b}static Isi(a){const b=[];for(const c of a)a=new qt.a(c.Id,c.Provider),b.push(a);return b}}Object(e.a)(ts,"UserAccessUtils",null,[685]);class us{constructor(a=null){a&&(this.Id=a.Id,this.Provider=a.Provider,this.Email=a.Email,this.DisplayName=a.DisplayName,this.GivenName=a.GivenName,this.Surname=a.Surname,this.Title=a.Title)}}Object(e.a)(us,"PersonaProperties",null,[]);class Su{constructor(a,b){this.Usf=[];this.epd=[];this.Ubf=
-1;this.mb=a;this.Foa=b}get Csh(){return this.mb.ka("IsContactsResolutionEnabled")}getUserContacts(a,b,c,f,l){Z.ULS.sendTraceTag(37611683,380,15,"GetUserContacts: limit:{0}, searchGal:{1}, scenario:{2}",b,f,l);const w=new Map;w.set("Limit",b.toString());w.set("SearchGal",f.toString());w.set("Scenario",l);Mf.Health.instance.recordKpiUsageForAlertableKpi("PeopleEndPointGetUserContactsBrowser","wackpitesting",w);if(!this.Csh)return Z.ULS.sendTraceTag(39145936,380,10,"Trying to get user contacts when hosts doesn't support it"),
Mf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","TriedToGetUserContactsWhenHostDoesNotSupportIt",!0,!1,null),a=new ak.a,a.FF(Error.invalidOperation("People operations not supported by this host")),a.task;if(0>=b)return Z.ULS.sendTraceTag(39145937,380,10,"Limit should be > 0"),Mf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","LimitShouldBeGreaterThanZero",!1,!0,null),a=new ak.a,a.FF(Error.invalidOperation("Limit should be > 0")),a.task;"Unknown"===
l&&Z.ULS.sendTraceTag(37611712,380,15,"Scenario Name was not specified");if(b<=this.Ubf&&!a&&!f)return a=new ak.a,c=this.epd.slice(0,Math.max(b-1,this.epd.length-1)),c=this.IRg(this.Usf,c),a.Ig(c),a.task;const F=new ak.a;let S;try{S=this.Foa.getUserContacts(a,b,c,f,l)}catch(fa){return F.FF(fa),F.task}if(f||"AtMentions"!==l)return S;S.continueWith(fa=>{if(fa.yn||fa.Sl){fa=fa.yn?"Canceled":fa.Ti.message;Z.ULS.sendTraceTag(39145938,380,10,"Failed to get contacts from host {0}",fa);var xa=new Map;w.set("ErrorMessage",
fa);xa=Object.assign(new pk.a,{extendedProperties:xa});Mf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","FailedToGetContactsFromHost",!1,!0,xa);F.FF(Error.create(fa))}else this.epd=fa=S.result,this.Ubf=b,fa=this.IRg(this.Usf,fa),F.Ig(fa)});return F.task}IRg(a,b){if(!a&&!b)return[];if(!b)return a;if(!a)return b;const c={};a.forEach(f=>{this.zBf(f,c)});b.forEach(f=>{this.zBf(f,c)});a=[];for(let f in c)Array.add(a,c[f]);return a}zBf(a,b){if(a&&(a=new us(a),a.Email&&a.DisplayName&&
a.Id&&a.Provider)){const c=b[this.WRf(a)];c&&(a.Surname||(a.Surname=c.Surname),a.GivenName||(a.Surname=c.GivenName),a.Title||(a.Surname=c.Title));b[this.WRf(a)]=a}}WRf(a){return(a.Email+a.Provider).toLocaleLowerCase()}}Object(e.a)(Su,"UserContactsUtils",null,[684]);class Cw{}Object(e.a)(Cw,"CheckUserAccessResponse",null,[]);class Dw{}Object(e.a)(Dw,"GrantUserAccessResponseItem",null,[]);class Tu{}Object(e.a)(Tu,"UserPermissions",null,[]);class Eo{constructor(){this.fM=new Bc.a;this.xNe=0}pTe(a){let b;
const c=[];if(!a)return Z.ULS.sendTraceTag(36299549,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with null people argument."),{returnValue:c,dUb:!1};if(!a.length)return Z.ULS.sendTraceTag(36299550,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with empty IPerson array."),{returnValue:c,dUb:!1};b=!0;const f={};for(const l of a){a=Eo.lOd(l);if(a in f)continue;f[a]=!0;const w=({value:a}=this.fM.Nf(Eo.lOd(l))).returnValue;w&&(!a||a.UserCanWrite||a.UserCanReview)||
Array.add(c,l);b=b&&w}return{returnValue:c,dUb:b}}Gql(a){if(!a)throw Error.argumentNull("result");for(const b of a){if(void 0===b.Id||null===b.Id||!b.Id.length)throw Error.argument("item.Id");if(void 0===b.Provider||null===b.Provider||!b.Provider.length)throw Error.argument("item.Provider");this.fM.remove(Eo.BEc(b));this.fM.add(Eo.BEc(b),b)}}Hql(a,b,c,f){if(!a)throw Error.argumentNull("result");for(const l of a){if(void 0===l.Id||null===l.Id||!l.Id.length)throw Error.argument("item.Id");if(void 0===
l.Provider||null===l.Provider||!l.Provider.length)throw Error.argument("item.Provider");if(0===l.Status){const w=Eo.mOd(l.Id,l.Provider);({value:a}=this.fM.Nf(w)).returnValue?(a.UserCanRead=b,a.UserCanWrite=c,a.UserCanReview=f):(a=Object.assign(new Tu,{Id:l.Id,Provider:l.Provider,UserCanRead:b,UserCanWrite:c,UserCanReview:f}),this.fM.remove(w),this.fM.add(w,a))}}}Iql(a){if(!a)throw Error.argumentNull("showSharingUiResponse");a=a.Persons;if(!a)throw Error.argumentNull("showSharingUiResponse.Persons");
for(let b=0;b<a.length;b++){const c=new Tu,f=a[b];if(void 0===f.Id||null===f.Id)throw Error.argument("showSharingUiRepsonePerson.Id");void 0===f.Status||null===f.Status?Z.ULS.sendTraceTag(25036183,380,15,"ShowSharingUiResponsePerson.Status is null or undefined"):(c.UserCanRead=f.Status===this.xNe,c.UserCanWrite=f.Status===this.xNe,c.UserCanReview=f.Status===this.xNe,c.Id=f.Id,c.Provider=f.Provider,this.fM.remove(Eo.BEc(c)),this.fM.add(Eo.BEc(c),c))}}Feg(a){const b=[];for(const c of a)a=Eo.lOd(c),
this.fM.Kb(a)&&Array.add(b,this.fM.ga(a));return b}LNa(a){a=this.Feg(a);return Object.assign(new Cw,{Result:a,Canceled:!1})}lRf(a){a=this.Feg(a);const b=[];for(const c of a)b.push(Object.assign(new Dw,{Id:c.Id,Provider:c.Provider,Message:"Success. User already exists in cache with requested permissions.",Status:0}));return Object.assign(new tt,{Result:b,Canceled:!1})}static BEc(a){return Eo.mOd(a.Id,a.Provider)}static lOd(a){return Eo.mOd(a.UserId,a.Provider)}static mOd(a,b){return b+a}}Object(e.a)(Eo,
"UserPermissionsCache",null,[683]);class Ew{constructor(a,b,c,f){this.Foa=a;this.mb=b;this.CWh=c;this.AWh=f}qWb(a,b,c,f){var l=this.Foa.dwa;l=l?String.format("{0}/{1}",l,"people.ashx"):"people.ashx";l=new Wm.QueryStringBuilder(l);l.nj("oid","3");l.nj("bdqs",c);(c=this.wsi(f))&&2<=c.length&&(f=c[1],l.nj("w",c[0]),l.nj("h",f));l.nj("uid",a);l.nj("p",b);l.nj("usid",this.CWh);l.nj("WacUserType",this.AWh);return l.toString()}wsi(a){switch(a){case 1:return["48","48"];case 2:return["64","64"];case 3:return["96",
"96"];case 4:return["120","120"];case 5:return["240","240"];case 6:return["360","360"];case 7:return["432","432"];case 8:return["504","504"];case 0:return[];default:throw Error.argumentOutOfRange("unknown dimension");}}get lae(){return this.mb.ka("IsUserProfilePictureResolutionEnabled")}}Object(e.a)(Ew,"UserProfilePictureUtils",null,[680,681]);var Fw=d(561);class xr{get name(){return"Common.App.People"}Yb(a){a.register(qs,"Common.App.People.PeopleRequestHandler").as("Common.App.People.IPeopleRequestHandler").ma().na(()=>
new qs(u.AFrameworkApplication.Be,()=>u.AFrameworkApplication.$g,u.AFrameworkApplication.fa,new vr.a));a.register(Eo,"Common.App.People.UserPermissionsCache").as("Common.App.People.IUserPermissionsCache").ma();a.register(rs,"Common.App.People.ShowSharingUiPostMessageHandler").ma().na(()=>new rs(or.a.su(a.Oa("Postmessage.IHostPostmessenger"))));a.register(ts,"Common.App.People.UserAccessUtils").as("Common.App.People.IUserAccessUtils").ma().na(()=>new ts(a.resolve("Common.App.People.PeopleRequestHandler"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.ShowSharingUiPostMessageHandler"),a.resolve("Common.App.People.IUserPermissionsCache"),Fw.a,Im.a.instance));a.register(Su,"Common.App.People.UserContactsUtils").as("Common.App.People.IUserContactsUtils").ma().na(()=>new Su(u.AFrameworkApplication.fa,a.resolve("Common.App.People.PeopleRequestHandler")));a.register(Ew,"Common.App.People.UserProfilePictureUtils").as("Common.App.People.IUserProfilePictureUtilsV2").as("Common.App.People.IUserProfilePictureUtils").ma().na(()=>
new Ew(a.resolve("Common.App.People.PeopleRequestHandler"),u.AFrameworkApplication.fa,u.AFrameworkApplication.userSessionId,u.AFrameworkApplication.userType));a.register(gq,"Common.App.People.PeopleColorUtils").as("Common.App.People.IPeopleColorUtils").ma().na(()=>new gq(a.qb("Common.IColorTable")));a.register(rt,"Common.App.People.PeopleManager").as("Common.App.People.IPeopleManager").ma().na(()=>new rt(a.resolve("Common.App.People.PeopleRequestHandler"),a.resolve("Common.App.People.IUserAccessUtils"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.IUserContactsUtils"),Oc.a.get_instance(),a.resolve("Common.App.People.IUserProfilePictureUtilsV2")));a.register(Mu,"Common.App.People.ExternalPeopleAPI").as("Common.App.People.IExternalPeopleAPI").ma().na(()=>new Mu(a.resolve("Common.App.People.IPeopleManager"),a.resolve("Common.App.People.IPeopleColorUtils"),or.a.su(a.Oa("Common.ILokiTokenManager")),u.AFrameworkApplication.fa,a.Oa("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper")))}init(){u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.gf(Object(C.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){const a=lb.a.instance.resolve("Common.App.People.IPeopleManager");lb.a.instance.resolve("Common.App.People.IExternalPeopleAPI");u.AFrameworkApplication.fa.ka("GetUserContactsTestHookIsEnabled")&&(new hy(a,u.AFrameworkApplication.Va)).LTk()}dispose(){}static main(){m.a.instance.Ec(new xr)}}Object(e.a)(xr,"PeoplePackage",null,[2,3]);var hq={};hq.JJb=function(){function a(){return F()&&(kc()||3<=(pb()?Ec("version/"):
0))}function b(){return 0<=window.navigator.userAgent.indexOf("Windows")}function c(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function f(wd){wd=(new RegExp(wd+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var oe=-1;null!=wd&&2<=wd.length&&(oe=parseFloat(wd[1]),isNaN(oe)&&(oe=-1));return oe}function l(){qm||(qm=!0,sk=f("Windows Phone"));return 8<=sk}function w(){return"function"==typeof navigator.msLaunchUri&&!c()&&!hc()&&!S()}function F(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}
function S(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function fa(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function xa(){return fa()?8==window.document.documentMode:!1}function Za(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function pb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Mb(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function hc(){var wd=window.navigator.userAgent.toLowerCase();
return 0<=wd.indexOf("android")&&0<=wd.indexOf("chrome")}function kc(){return 3<=(Za()?Ec("firefox/"):0)}function Ec(wd){var oe=window.navigator.userAgent.toLowerCase(),rf=oe.indexOf(wd);return 0<=rf?parseInt(oe.substring(rf+wd.length,oe.length)):0}function Hc(wd,oe,rf,Vd,yg){if(Vd&&null!=oe)oe();else if(w())navigator.msLaunchUri(wd,oe,rf);else if(!(Mb()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&F())||S())Td(wd,oe,
rf);else if(Mb()&&yg)a:{try{window.open(wd,"_self")}catch(hi){null!=rf&&rf();break a}null!=oe&&oe()}else Dc(wd,oe,rf)}function Dc(wd,oe,rf){var Vd=document.getElementById("OICLinkTag");null==Vd&&(Vd=document.createElement("a"),Vd.id="OICLinkTag",Vd.style.visibility="hidden",Vd.href="",0==(oh.Options&ai.SupportsTopTargetNavigation)||oh.NoBrowserModalDialogs?Vd.target="_blank":Vd.target="_top",document.body.appendChild(Vd),null!=Vd.addEventListener&&Vd.addEventListener("click",function(yg){null!=yg.stopPropagation&&
yg.stopPropagation()},!1));try{Vd.href=wd,Vd.click()}catch(yg){null!=rf&&rf();return}null!=oe&&oe()}function Td(wd,oe,rf){var Vd=document.getElementById("OICFrame");null==Vd&&(Vd=document.createElement("iframe"),Vd.className="ObjectInDialog",Vd.style.visibility="hidden",Vd.src="about:blank",document.body.appendChild(Vd),Vd.id="OICFrame");try{Vd.contentWindow.location.href=wd}catch(yg){null!=rf&&rf();return}null!=oe&&oe()}function we(wd){return 0!=(wd.Options&ai.SkipProtocolHandler)||xa()}function Pd(wd){return wd===
Ek.ReadOnly||wd===Ek.ReadWrite}function He(wd,oe,rf,Vd){var yg;try{var hi=new ActiveXObject("SharePoint.OpenDocuments.4");return(yg=hi.ViewDocument3(window.self,wd,oe,Vd))?(Dk(gi.O14ActiveX),tg.None):tg.Failed}catch(vi){}if(ai.O14Only===(rf&ai.O14Only))return oh.DescriptiveUnattemptedEnums?tg.O14AttemptFailure:tg.Unattempted;try{return hi=new ActiveXObject("SharePoint.OpenDocuments.3"),(yg=hi.ViewDocument3(window.self,wd,oe,Vd))?(Dk(gi.O12ActiveX),tg.None):tg.Failed}catch(vi){}if(ai.O12UpOnly===(rf&
ai.O12UpOnly))return oh.DescriptiveUnattemptedEnums?tg.O12UpOnlyFail:tg.Unattempted;try{return hi=new ActiveXObject("SharePoint.OpenDocuments.2"),(yg=Pd(oe)?hi.ViewDocument2(window.self,wd,Vd):hi.EditDocument2(window.self,wd,Vd))?(Dk(gi.O11ActiveX),tg.None):tg.Failed}catch(vi){}return oh.DescriptiveUnattemptedEnums?tg.ActiveXUnattempted:tg.Unattempted}function Pe(wd,oe,rf,Vd,yg){wd==Tf.Visio&&rf==Ek.ReadWrite&&(rf=Ek.WriteOnly);wd=yg;Vd=Vd||c()&&!l();Vd||(Vd="",Vd=Pd(rf)?Vd+"ofv|ofc|":Vd+"ofe|",wd+=
ig(Vd+"u|"));wd+=ig(oe);oh.NewTelemetryDataIsEnabled&&(oe=-1!==wd.indexOf("?")?"&":"?",oe+=oh.SessionOrigin?"OR="+oh.SessionOrigin+"&":"",oe+=oh.ClickTime?"CT="+oh.ClickTime+"&":"",oe+=oh.CorrelationId?"CID="+oh.CorrelationId:"",oe="?"!=oe?oe:"",oe="&"!=oe.slice(-1)?oe:oe.slice(0,-1),wd+=ig(oe));oe=window.location.href;rf=oe.toLowerCase().indexOf("&wdlor=");-1!=rf?(rf+=7,Vd=oe.indexOf("&",rf),oe=-1==Vd?oe.substr(rf):oe.substring(rf,Vd)):oe=void 0;if(null!=oe&&"undefined"!=typeof oe){rf="";try{rf=
decodeURIComponent(oe)}catch(hi){}0<rf.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(rf)&&(wd=wd+"|f|"+rf)}return wd}function Df(wd,oe,rf,Vd,yg,hi){var vi=Zi(wd);if(null==vi)return kj(oh.DescriptiveUnattemptedEnums?tg.ProtocolHandlerIsNull:tg.Unattempted,oh.Application),!1;wd=Pe(wd,oe,rf,Vd,vi);Hc(wd,Tg,Ig,yg,hi);return!0}function ig(wd){if(F()&&Mb()){var oe="";try{oe=decodeURI(wd)}catch(rf){}if(oe==wd)return encodeURI(wd)}return wd}function Tg(){Dk(gi.ProtocolHandler)}
function Ig(){oh.Options|=ai.SkipProtocolHandler;Bi(oh,Bj,ck)}function Ff(){null!=al&&al(gi.RoamingProtocolHandler)}function nh(){null!=Cj&&Cj(tg.ControlNeeded)}function Jg(){var wd=document.getElementById("npSharePointPlugin");if(null==wd){wd="application/x-sharepoint";F()&&3<=(pb()?Ec("version/"):0)&&$h("application/x-sharepoint-webkit",!0)&&(wd="application/x-sharepoint-webkit");if(!$h(wd,!0))if(F()&&$h("application/officelive",!0))wd="application/officelive";else return null;var oe=document.createElement("object");
oe.id="npSharePointPlugin";oe.type=wd;oe.style.width="0px";oe.style.height="0px";oe.style.setProperty("visibility","hidden","");document.body.appendChild(oe);wd=document.getElementById("npSharePointPlugin")}return wd}function $h(wd,oe){var rf=window.navigator.mimeTypes;if(null==rf)return!1;wd=rf[wd];return!wd||oe&&!wd.enabledPlugin?!1:!0}function Li(wd){try{if(null!=new ActiveXObject(wd))return!0}catch(oe){}return!1}function Aj(wd){switch(wd){case Tf.OneNote:return"OneNote.Notebook";default:return""}}
function Zi(wd){if(wd!=Tf.OneNote&&c()&&!l())return"office:";switch(wd){case Tf.Excel:return"ms-excel:";case Tf.OneNote:return"onenote:";case Tf.PowerPoint:return"ms-powerpoint:";case Tf.Visio:return"ms-visio:";case Tf.Word:return"ms-word:";case Tf.Project:return"ms-project:";case Tf.Publisher:return"ms-publisher:";case Tf.Infopath:return"ms-infopath:";case Tf.Access:return"ms-access:";default:return""}}function Ui(wd){switch(wd){case Tf.Excel:return"root\\office15\\excel.exe";case Tf.PowerPoint:return"root\\office15\\powerpnt.exe";
case Tf.Visio:return"root\\office15\\visio.exe";case Tf.Word:return"root\\office15\\winword.exe";case Tf.Project:return"root\\office15\\winproj.exe";case Tf.Publisher:return"root\\office15\\mspub.exe";case Tf.Infopath:return"root\\office15\\infopath.exe";case Tf.Access:return"root\\office15\\msaccess.exe";default:return null}}function Bi(wd,oe,rf){oh=wd;Bj=oe;ck=rf;if(wd.DocumentUrl){var Vd=rf=oe=wd.DocumentUrl;try{Vd=decodeURIComponent(wd.DocumentUrl)}catch(Fo){}try{rf=encodeURI(wd.DocumentUrl)}catch(Fo){}oe=
oe+""+wd.CorrelationIdForWinClient;Vd+=wd.CorrelationIdForWinClient;rf+=wd.CorrelationIdForWinClient;wd.Mode===Ek.ReadWrite&&ai.CheckoutRequired===(wd.Options&ai.CheckoutRequired)&&(wd.Mode=Ek.ForceCheckout);ai.HostIsEditOnly===(wd.Options&ai.HostIsEditOnly)&&(wd.Mode=Ek.WriteOnly);if(we(wd)?0:F()&&(wd.Application==Tf.OneNote||$h("application/x-sharepoint-protocolhandler",!1)||$h("application/x-sharepoint-webkit-protocolhandler",!1))||w()||hc()||!(a()||kc()||"ActiveXObject"in window&&!c()||Mb())||
15<=rk())Df(wd.Application,wd.EncodeUrl?rf:oe,wd.Mode,wd.Application==Tf.OneNote,wd.SilentExternalHandler,wd.NavigateUsingWindowOpen);else{var yg;if(yg=xa())a:{var hi=wd.EncodeUrl?oe:Vd,vi=wd.Mode,To=Aj(wd.Application);try{yg=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,hi,vi,To);break a}catch(Fo){}yg=!1}if(yg)Dk(gi.O15ActiveX);else{if(a()||kc()){var tk=wd.EncodeUrl?oe:Vd;Vd=wd.Mode;yg=Aj(wd.Application);hi=Jg();if(null==hi)tk=oh.DescriptiveUnattemptedEnums?tg.PluginIsNull:
tg.Unattempted;else{vi=!1;try{vi=hi.ViewDocument3(window.self,tk,Vd,yg)}catch(Fo){}if(!vi)try{vi=Pd(Vd)?hi.ViewDocument2(window.self,tk,yg):hi.EditDocument2(window.self,tk,yg)}catch(Fo){}vi?(Dk(gi.NpapiPlugin),tk=tg.None):tk=tg.Failed}}else{try{tk=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=tk&&tk.SaveSSOCreds()}catch(Fo){}tk=He(wd.EncodeUrl?oe:Vd,wd.Mode,wd.Options,Aj(wd.Application))}if(tk!=tg.None){if(Vd=wd.CouldUseRoamingApps)bl||(bl=!0,Ol=f("Windows NT")),Vd=6.1<=Ol&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&
(fa()||kc()||Mb());if(Vd&&wd.Application!=Tf.OneNote){if(!hq.JJb.pzl()){kj(tg.ControlNeeded,oh.Application);return}if(wd.RoamingAppsLauncher){"undefined"==typeof wd.RoamingAppsLauncher||null==wd.RoamingAppsLauncher?kj(oh.DescriptiveUnattemptedEnums?tg.RoamingLauncherIsNull:tg.Unattempted,oh.Application):"undefined"==typeof wd.RoamingBitsUrl||null==wd.RoamingBitsUrl?hq.JJb.qzl(wd.DocumentUrl,wd.RoamingAppsLauncher,wd.Application,wd.ApplicationParameters,Bj,ck):hq.JJb.zEh(wd.DocumentUrl,wd.RoamingAppsLauncher,
wd.RoamingApplicationExe,wd.ApplicationParameters,wd.RoamingPlatform,wd.RoamingBitsUrl,Bj,ck);return}if(!wd.ContinueIfLauncherIsNull){kj(tg.LauncherNeeded,oh.Application);return}}ai.NoProtocolHandlerFallback==(wd.Options&ai.NoProtocolHandlerFallback)||we(wd)||fa()||F()&&!(oh.DescriptiveUnattemptedEnums?tk>=tg.O14Unattempted&&tk<=tg.DocumentUrlIsNull:tk==tg.Unattempted)?kj(tk,oh.Application):Df(wd.Application,wd.EncodeUrl?rf:oe,wd.Mode,wd.Application==Tf.OneNote,wd.SilentExternalHandler,wd.NavigateUsingWindowOpen)}}}}else kj(oh.DescriptiveUnattemptedEnums?
tg.DocumentUrlIsNull:tg.Unattempted,oh.Application)}function Dk(wd){null!=Bj&&Bj(wd)}function kj(wd,oe){"undefined"==typeof oe&&(oe=null);null!=ck&&ck(wd,oe)}function rk(){var wd=0;if(a()||kc()||Mb()){var oe=Jg();try{null!=oe&&(wd=oe.GetOfficeVersion())}catch(rf){}}else Li("SharePoint.OpenDocuments.5")?wd=15:Li("SharePoint.OpenDocuments.4")?wd=14:Li("SharePoint.OpenDocuments.3")?wd=12:Li("SharePoint.OpenDocuments.2")&&(wd=11);return wd}function ml(){return F()&&($h("application/x-sharepoint",!0)||
$h("application/x-sharepoint-webkit",!0))}var nl="",Bl="",bk="",Bj,ck,al,Cj,oh,bl,Ol,qm,sk,Ek={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},ai={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},tg={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,
ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},gi={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Tf={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Ek,OpenDocumentOptions:ai,OpenDocumentFailureType:tg,OpenDocumentControl:gi,OfficeApplication:Tf,EditDocumentInClient:Bi,
EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=Tf.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=
this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:rk,IsO14MacPluginInstalled:ml,OfferOfficeInDialog:function(){return b()&&11>=rk()},OfferOfficeNoIntrusive:function(){return b()&&15>rk()},OfferMacOffice:function(){return F()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!ml()},InstallRoamingControl:function(){Za()?window.InstallTrigger.install({Office:{URL:Bl}}):Td(bk,null,null)},CanUseRoamingControl:function(){if(w())return!0;if(Mb())return"undefined"!=typeof navigator.plugins.refresh&&
navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Za()){var wd=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(wd);var oe=document.createEvent("Events");oe.initEvent("RoamingOfficeInstalled",!0,!1);wd.dispatchEvent(oe);return!!wd.getAttribute("installed")}if(fa())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(rf){}return!1},InitUrls:function(wd,oe,rf){nl=wd;Bl=rf;bk=oe},LaunchRoamingApps:function(wd,
oe,rf,Vd,yg,hi){hq.JJb.zEh(wd,oe,Ui(rf),Vd,"x86",nl,yg,hi)},LaunchRoamingApps2:function(wd,oe,rf,Vd,yg,hi,vi,To){var tk="";null!=Vd&&(tk+=" "+Vd);null!=wd&&(tk+=' "'+wd+'"');if(w()||Mb())al=vi,Cj=To,vi='office: "'+(hi+'" "')+(rf+'" "ROAMING"'),vi+=' "'+oe+'"',vi+=' "'+yg+'"',vi+=" "+tk,Hc(vi,Ff,nh,!1,!1);else if(Za())wd=document.createElement("RoamingExtensionElement"),wd.setAttribute("cabUrl",hi),wd.setAttribute("app",rf),wd.setAttribute("licensingEntitlements",oe),wd.setAttribute("platform",yg),
wd.setAttribute("args",tk),document.documentElement.appendChild(wd),oe=document.createEvent("Events"),oe.initEvent("RoamingOfficeLaunch",!0,!1),wd.dispatchEvent(oe),null!=vi&&vi(gi.RoamingFFExtension);else if(fa()){if(wd=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=wd)try{wd.HrConfigureSingle(hi,rf,oe,yg,tk),null!=vi&&vi(gi.RoamingActiveX)}catch(Fo){}}else null!=To&&To(tg.Failed)},ShouldShowDialog:function(){return!c()},NavigateToUrlUsingClickingOnATag:Dc,OpenDocumentWithProtocolHandler:Df,
OpenDocumentWithProtocolHandlerNoCallBack:function(wd,oe,rf,Vd){var yg=Zi(wd);if(null==yg)return kj(oh.DescriptiveUnattemptedEnums?tg.ProtocolHandlerNoCallbackIsNull:tg.Unattempted,oh.Application),!1;wd=Pe(wd,oe,rf,Vd,yg);Hc(wd,null,null,!1,!1);return!0}}}();hq.ClientUtils=hq.JJb;class ut{constructor(a,b,c){this.Da=a;this.SMh=b;this.RF=c}wb(){this.Da.ya(G.a.tryMacOffice,de.a.frame,Object(C.a)(this,this.Omk,"onTryMacOffice"));this.Da.ya(G.a.fxh,de.a.frame,Object(C.a)(this,this.c0g,"onTryMacOfficeFromViewer"));
this.Da.ya(G.a.exh,de.a.frame,Object(C.a)(this,this.c0g,"onTryMacOfficeFromViewer"))}Omk(a,b,c,f,l){if(1===c)return 32;l?(a=l.SourceControlId,"btnjTryMacOfficeForWordEditor"===a?id.a.Qm(Jf.a.QBa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===a&&id.a.Qm(Jf.a.QBa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Fyg();return 32}c0g(a,b,c){if(1===c)return 32;switch(a){case G.a.fxh:id.a.Qm(Jf.a.QBa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");
break;case G.a.exh:id.a.Qm(Jf.a.QBa(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Fyg(){id.a.Qm(ut.t8j,"_blank",void 0,"LaunchMacTrialWindow")}get ekc(){return this.SMh&&r.a.ak&&!r.a.R9d&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get unh(){const a=this.ekc;a||u.AFrameworkApplication.Yi.jZk();return a}get j7k(){return this.ekc}static get t8j(){return Jf.a.oV("522401")}}Object(e.a)(ut,"MacOfficeOffer",null,[706]);class vt{constructor(a,b,c){this.Da=a;this.VMh=b;this.rod=null;
(this.byc=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&lb.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(f=>{this.rod=f});this.RF=c}wb(){this.Da.ya(G.a.tryOffice,de.a.frame,Object(C.a)(this,this.Pmk,"onTryOffice"));this.Da.ya(G.a.YQe,de.a.frame,Object(C.a)(this,this.YQe,"tryOfficeThroughTellMe"));this.Da.ya(G.a.nxh,de.a.frame,Object(C.a)(this,this.oxh,"tryOfficeThroughViewer"));
this.Da.ya(G.a.mxh,de.a.frame,Object(C.a)(this,this.oxh,"tryOfficeThroughViewer"))}Pmk(a,b,c,f,l){if(this.byc&&1===c)return this.isFreemiumUpsellEnabled&&this.fkc?32:8;2===c&&(l?(a=l.SourceControlId,"btnjTryOfficeForWordEditor"===a?id.a.Qm(Jf.a.QBa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===a?id.a.Qm(Jf.a.QBa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.ibe()):this.ibe());return 32}YQe(a,b,c,f,l){if(this.byc&&1===c)return this.isFreemiumUpsellEnabled&&
this.fkc?32:8;2===c&&(l?(a=l.SourceControlId,id.a.Qm(Jf.a.oV("862405")+this.k7i(a),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):id.a.Qm(Jf.a.oV("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}oxh(a,b,c){if(this.byc&&1===c)return this.isFreemiumUpsellEnabled&&this.fkc?32:8;if(2===c)switch(a){case G.a.nxh:id.a.Qm(Jf.a.QBa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case G.a.mxh:id.a.Qm(Jf.a.QBa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get LUg(){return this.fkc}get Ydk(){return this.fkc&&
MSOJS.ClientUtils.OfferOfficeInDialog()}get fkc(){return this.VMh&&!r.a.ak}get isFreemiumUpsellEnabled(){let a=!1;this.rod&&(a=this.rod.isFreemiumUpsellEnabled());return a}ibe(a=null){let b=0;a&&(b=a);id.a.Qm(vt.d4i(b),"_blank",void 0,"LaunchOfficeOffer")}k7i(a){let b=0;switch(a){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":b=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":b=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":b=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":b=
4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":b=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":b=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":b=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":b=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":b=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":b=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":b=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":b=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":b=
18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":b=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":b=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":b=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":b=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":b=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":b=29}return 0===b?"":String.format("&pc={0:D}",b)}static d4i(a){if(r.a.Ji)switch(a){case 1:return Jf.a.oV("393806");case 2:return Jf.a.oV("393810");
case 3:return Jf.a.oV("393809");case 5:return Jf.a.oV("393805")}else if(r.a.dI)switch(a){case 1:return Jf.a.oV("521979");case 3:return Jf.a.oV("521980");case 5:return Jf.a.oV("521978");case 2:return Jf.a.oV("522490")}else{if(2===a)return Jf.a.oV("517778");if(1===a)return Jf.a.QBa(30)}return Jf.a.oV("522402")}}Object(e.a)(vt,"OfficeTrialExperience",null,[705]);class vs{Yb(a){a.register(vt,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ma().na(()=>new vt(u.AFrameworkApplication.Va,
u.AFrameworkApplication.w9d,u.AFrameworkApplication.lcid));a.register(ut,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ma().na(()=>new ut(u.AFrameworkApplication.Va,u.AFrameworkApplication.Mtg,u.AFrameworkApplication.lcid))}}Object(e.a)(vs,"OpenInClientConfiguration",null,[3]);var qp=d(169),Ne=d(47);class Uu{constructor(a,b,c){this.vW=this.zt=this.K=null;this.nf=a;this.wI=b;this.Toe=c}qRf(a,b,c){if(!this.nf)return null;if(!this.K){this.K=Ne.a.De();this.K.id=this.wI;this.K.className=
"HTMLSpinnerIndicator";const f=Ne.a.De();f.className="HtmlspinnerOverlay";this.zt=Ne.a.De();this.zt.className="HtmlspinnerInner";const l=Ne.a.tn();l.className="BootSpinner";this.zt.appendChild(l);this.Toe&&(this.vW=Ne.a.tn(),this.vW.id="htmlspinner_label",this.zt.appendChild(this.vW));this.K.appendChild(f);this.K.appendChild(this.zt);this.nf.appendChild(this.K)}this.Toe&&(this.vW.innerText=a||ResourceStrings.l_Loading);this.QGd(b,c);return this.K}YIb(a){this.vW&&(this.vW.innerText=a)}QGd(a,b){this.K.style.left=
Ne.a.Nc(a);this.K.style.top=Ne.a.Nc(b);this.zt.style.bottom=this.Toe?Ne.a.Nc(this.nf.clientHeight/2+16):Ne.a.Nc(this.nf.clientHeight/2+24)}}Object(e.a)(Uu,"HtmlSpinnerIndicator",null,[]);class wt extends Uu{constructor(a,b,c){super(a,b,!1);this.Voe=c}qRf(a,b,c){if(!this.nf)return null;if(!this.K){this.K=Ne.a.De();this.K.id=this.wI;this.K.className="HTMLProgressIndicator";const f=Ne.a.De();f.className="HtmlprogressOverlay";this.zt=Ne.a.De();this.zt.className="HtmlprogressInner";if(this.Voe){const l=
Ne.a.FB();l.src=qp.a.bK(nf.a.Xla);l.width=nf.a.vDb;l.height=nf.a.P$c;this.zt.appendChild(l)}this.vW=Ne.a.tn();this.zt.appendChild(this.vW);this.K.appendChild(f);this.K.appendChild(this.zt);this.nf.appendChild(this.K)}this.vW.innerText=a||ResourceStrings.l_Loading;this.QGd(b,c);return this.K}QGd(a,b){this.K.style.left=Ne.a.Nc(a);this.K.style.top=Ne.a.Nc(b);this.K.style.display=Fe.a.wl;this.zt.style.position=Fe.a.Mwa;a=this.zt.clientWidth;this.zt.style.top=Ne.a.Nc(this.nf.clientHeight/2-this.zt.clientHeight/
2);u.AFrameworkApplication.isRtl?(this.zt.style.right=Ne.a.Nc(this.nf.clientWidth/2-a/2),this.zt.style.direction=Fe.a.oYa):(this.zt.style.left=Ne.a.Nc(this.nf.clientWidth/2-a/2),this.zt.style.direction=Fe.a.nsh);this.K.style.display=Fe.a.og}}Object(e.a)(wt,"HtmlProgressIndicator",Uu,[]);class iy{constructor(a,b){this.FI=this.UN=this.K=null;this.Sb=!0;this.vGg=a;this.rI=b}OGb(a,b,c,f,l){u.AFrameworkApplication.z4b()||(this.K=this.vGg.qRf(a,c,f),b?(this.UN&&(window.clearTimeout(this.UN),this.UN=null),
this.FI&&(window.clearTimeout(this.FI),this.FI=null),this.hLe(l)):this.UN||this.FI||(this.UN=window.setTimeout(()=>{this.ILe(l)},200)))}dPc(){this.UN&&(window.clearTimeout(this.UN),this.UN=null);this.FI&&(window.clearTimeout(this.FI),this.FI=null);this.K&&(this.K.style.display=Fe.a.og,this.K.style.opacity="0")}YIb(a){this.vGg.YIb(a)}hLe(a){this.K&&(this.K.style.opacity="1.0",this.K.style.visibility=Fe.a.Ty,this.Sb&&(this.K.style.display=Fe.a.wl),za.a.J(38340417,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",
this.Imc(a)))}ILe(a){this.UN=null;this.K&&(this.K.style.visibility=Fe.a.Ty,this.Sb&&(this.K.style.display=Fe.a.wl),this.K.style.opacity="0.0",this.FI||(this.FI=window.setTimeout(()=>{this.HLe(a)},1800)))}HLe(a){this.FI=null;this.K&&(this.K.style.opacity="1.0",this.Sb&&(this.K.style.display=Fe.a.wl),za.a.J(38340419,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.Imc(a)))}Imc(a){return a?Object.getType(a)===String?a:Object.getType(a)===Number?this.rI.x4(a):null:null}get visible(){return this.Sb}set visible(a){this.Sb=
a;this.K&&(this.K.style.display=a?Fe.a.wl:Fe.a.og)}}Object(e.a)(iy,"HtmlProgressIndicatorView",null,[609]);class jy{constructor(){this.PresentationID=this.PodSessionID=this.PodEndpointUrl=null}}Object(e.a)(jy,"UploadConvertedFileToHostParams",null,[]);var ky=d(973),rp=d(72);const iq=a=>{for(let b=0;b<a.children.length;b++){const c=a.children[b];c.style.position="relative";c.style.top=(c.parentNode.offsetHeight-c.offsetHeight)/2+"px"}},Vu=a=>a.nc.keyCode===x.a.Xp||a.nc.keyCode===x.a.wO?(a.Hc.click(),
!0):!1,yr=(a,b,c,f,l,w,F)=>{const S=document.createElement("a");S.className="ProtocolLaunchingDialogButtonAnchor";S.className+=" OICDialog";S.id=a;S.setAttribute(re.a.ff,re.a.St);S.style.padding="0";S.style.margin="0";f&&Gw(l,b,c,f,S);a=document.createElement("span");a.className="ProtocolLaunchingDialogButtonLabel";a.innerText=l;S.appendChild(a);S.tabIndex=0;w&&Hb.a.instance.pb(ra.a.click,S,w);F&&A.KeyInputManager.instance.pb(ra.a.ol,S,F);return S},Gw=(a,b,c,f,l)=>{var w=document.createElement("img");
w.alt=a;w.className=rp.getImageClassWithCluster(c,f);w.src=b;w.setAttribute(re.a.ff,re.a.eP);a=document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container";a.appendChild(w);w=document.createElement("span");w.className="ProtocolLaunchingDialogIconContainer";w.appendChild(a);l.appendChild(w)};class xt{static get Wf(){return Th.a.tA(xt.Ym,CommonUIStrings.l_OICLaunchDialogTitle)}}xt.Ym="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(e.a)(xt,"OICLaunchDialogHtml",null,[]);class zr extends Th.a{constructor(a){super();this.vib=this.PZa=null;this.oKa=!1;this.rw=a;this.Wf=xt.Wf;this.vd=5;this.kg="OICLaunchDialog";this.showDialog("",Object(C.a)(this,this.dek,"oicLaunchDialogResultHandler"));this.Njh();this.D4("ProtocolLaunchingDialogTitle");4!==u.AFrameworkApplication.Ba.jb.yqa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.KQ(this.PZa);Z.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Yua(){this.PZa=yr("BtnRichClient",this.rw.Tpb,this.rw.s7a,this.rw.J4d,CommonUIStrings.l_OICLaunchRichClient,Object(C.a)(this,this.EZg,"onRichClientButtonClick"),Vu);document.getElementById("OICLaunchRichClient").appendChild(this.PZa);iq(this.PZa);this.vib=yr("BtnReturn",this.rw.Tpb,this.rw.s7a,this.rw.skg,CommonUIStrings.l_OICReturnToOnlineClient,Object(C.a)(this,this.CZg,"onReturnButtonClick"),
Vu);document.getElementById("OICReturnToApp").appendChild(this.vib);iq(this.vib)}CZg(){this.hide();this.rw.YWa();return!0}EZg(){Z.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();u.AFrameworkApplication.Va.processAction(G.a.yeb,2);return!0}dek(){this.rw.YWa()}dispose(){this.oKa||(this.PZa&&(Hb.a.instance.zb(ra.a.click,this.PZa,Object(C.a)(this,this.EZg,"onRichClientButtonClick")),A.KeyInputManager.instance.zb(ra.a.ol,this.PZa,Vu)),this.vib&&(Hb.a.instance.zb(ra.a.click,
this.vib,Object(C.a)(this,this.CZg,"onReturnButtonClick")),A.KeyInputManager.instance.zb(ra.a.ol,this.vib,Vu)),super.dispose(),this.oKa=!0)}}Object(e.a)(zr,"OICLaunchDialog",Th.a,[]);class mh{static get Wf(){return Th.a.tA(mh.Ym,CommonUIStrings.l_OICDialogTitle)}}mh.Ym="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(e.a)(mh,"ProtocolLaunchingDialogV2Html",null,[]);var k=d(192);class B extends Th.a{constructor(a){super();this.uib=this.Ixa=null;this.oKa=!1;this.VJa=null;this.rw=a;this.Wf=mh.Wf;this.vd=5;this.kg="ProtocolLaunchingDialog";this.hqc="OICRetryDialog";u.AFrameworkApplication.ve.Fra&&u.AFrameworkApplication.ve.XWa();u.AFrameworkApplication.ve.Hb(new Se.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(C.a)(this,this.Ffc,"protocolLaunchingDialogResultHandler"));this.Njh();
this.D4("Issues");this.D3f();Z.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Yua(){const a=document.getElementById("Issues");if(a){Gw("",this.rw.Tpb,this.rw.s7a,this.rw.J4d,a);const b=document.createElement("span");b.className="WACDialogSectionTitle";b.innerText=5===this.rw.y0g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;a.appendChild(b);iq(a);a.style.display="none"}u.AFrameworkApplication.Ba.jb.kfg?
(this.uib=yr("GiveFeedback",this.rw.Tpb,this.rw.s7a,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(C.a)(this,this.W6c,"onGiveFeedbackClick"),Object(C.a)(this,this.HXg,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.uib),iq(this.uib)):document.getElementById("ButtonGiveFeedback").style.display="none";0===u.AFrameworkApplication.Ba.jb.yqa||u.AFrameworkApplication.REi?document.getElementById("ButtonEdit").style.display="none":(this.Ixa=
yr("Edit",this.rw.Tpb,this.rw.s7a,"",2===u.AFrameworkApplication.Ba.jb.vm?4===u.AFrameworkApplication.Ba.jb.yqa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===u.AFrameworkApplication.Ba.jb.yqa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(C.a)(this,this.SWg,"onEditClick"),Object(C.a)(this,this.XWg,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Ixa),iq(this.Ixa));0===u.AFrameworkApplication.Ba.jb.yqa&&
!u.AFrameworkApplication.w9d&&a&&(a.style.display="none")}E3f(){return this.VJa?(this.KQ(this.VJa),!0):!1}D3f(){return this.Ixa?(this.KQ(this.Ixa),!0):!1}XWg(a){return this.Zte(a,0)}HXg(a){return this.Zte(a,2)}BZg(a){return this.Zte(a,1)}Zte(a,b){let c=!1;if(a.nc.keyCode===x.a.Xp||a.nc.keyCode===x.a.wO)a.Hc.click(),c=!0;else if(a.nc.keyCode===Sys.UI.Key.down||a.nc.keyCode===Sys.UI.Key.up)switch(b){case 1:c=this.D3f();break;case 0:c=this.E3f()}return c}SWg(){this.hide();4===u.AFrameworkApplication.Ba.jb.yqa?
(Z.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.rw.YWa()):(Z.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.rw.b1b());return!0}W6c(){Z.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}Y7c(){Z.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";u.AFrameworkApplication.Va.processAction(G.a.yeb,2);return!0}Ffc(){this.rw.YWa()}switchToBackupMode(){var a=document.getElementById("ProtocolLaunchingDialogTitle");
if(a){a.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(a=document.getElementById("Issues"))a.style.display="block";(a=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!a.children.length&&(this.VJa=yr("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(C.a)(this,this.Y7c,"onRetryOICClick"),Object(C.a)(this,this.BZg,"onRetryOICKeyUp")),a.appendChild(this.VJa),iq(this.VJa),this.Ixa||this.E3f())}}dispose(){this.oKa||(this.Ixa&&(Hb.a.instance.zb(ra.a.click,this.Ixa,Object(C.a)(this,
this.SWg,"onEditClick")),A.KeyInputManager.instance.zb(ra.a.ol,this.Ixa,Object(C.a)(this,this.XWg,"onEditKeyUp"))),this.uib&&(Hb.a.instance.zb(ra.a.click,this.uib,Object(C.a)(this,this.W6c,"onGiveFeedbackClick")),A.KeyInputManager.instance.zb(ra.a.ol,this.uib,Object(C.a)(this,this.HXg,"onGiveFeedbackKeyUp"))),this.VJa&&(Hb.a.instance.zb(ra.a.click,this.VJa,Object(C.a)(this,this.Y7c,"onRetryOICClick")),A.KeyInputManager.instance.zb(ra.a.ol,this.VJa,Object(C.a)(this,this.BZg,"onRetryOICKeyUp"))),super.dispose(),
this.oKa=!0)}}Object(e.a)(B,"ProtocolLaunchingDialog",Th.a,[]);class U extends hf.StandardDialog{constructor(a){super();this.rw=a;this.kg="ProtocolLaunchingDialog";u.AFrameworkApplication.ve.Fra&&u.AFrameworkApplication.ve.XWa();u.AFrameworkApplication.Ba.jb.kfg&&this.AFd(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(C.a)(this,this.W6c,"onGiveFeedbackClick"));U.Phg?(this.vd=12,this.Pe(1,CommonUIStrings.l_CloseFile),this.Pe(2,CommonUIStrings.l_OICDialogContinueHere),this.Pe(3,CommonUIStrings.l_OICDialogLaunchAgain)):
(this.vd=4,this.Pe(1,CommonUIStrings.l_OICDialogContinueHere),this.Pe(2,CommonUIStrings.l_OICDialogLaunchAgain));this.NAb(CommonUIStrings.l_OICDialog2ndTitle,5===this.rw.y0g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(C.a)(this,this.Ffc,"protocolLaunchingDialogResultHandler"),null)}W6c(a){Z.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.jXg(a)}Y7c(){Z.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");u.AFrameworkApplication.Va.processAction(G.a.yeb,
2)}Ffc(a){U.Phg?3===a?this.Peh():2===a||0===a?this.continueEditing():1===a&&this.closeDocument():2===a?this.Peh():(1===a||0===a)&&this.continueEditing()}closeDocument(){Z.ULS.sendTraceTag(577783557,211,50,"Closing the document");u.AFrameworkApplication.Va.Ma(G.a.close,2,Ii.a)}Peh(){Z.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(C.a)(this,this.Y7c,"onRetryOICClick"),0)}continueEditing(){4===u.AFrameworkApplication.Ba.jb.yqa||u.AFrameworkApplication.fa.ka("WordConsumptionViewToEditRedirectIsEnabled")&&
1===u.AFrameworkApplication.Ba.mode?(Z.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.rw.YWa()):(Z.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.rw.b1b())}static get Phg(){return u.AFrameworkApplication.fa.ka("OICDialogThreeActions")&&32===u.AFrameworkApplication.Va.processAction(G.a.close,1)}}Object(e.a)(U,"StandardProtocolLaunchingDialog",hf.StandardDialog,[]);var la=d(652);class Ha{}Object(e.a)(Ha,"EditDocumentInClientParams",null,[]);class bb{static JXf(a,
b,c,f,l,w,F=!1,S=!1,fa="",xa=!1,Za=!1,pb=!1,Mb="",hc="",kc="",Ec=!1){const Hc=new Ha;Hc.DocumentUrl=a;Hc.Mode=b;Hc.Options=c;Hc.Application=f;Hc.SilentExternalHandler=F;Hc.EncodeUrl=S;Hc.CorrelationIdForWinClient=fa;Hc.NavigateUsingWindowOpen=xa;Hc.DescriptiveUnattemptedEnums=Za;Hc.NoBrowserModalDialogs=pb;Hc.SessionOrigin=Mb;Hc.CorrelationId=hc;Hc.ClickTime=kc;Hc.NewTelemetryDataIsEnabled=Ec;MSOJS.ClientUtils.EditDocumentInClient(Hc,l,w)}}Object(e.a)(bb,"ClientUtils",null,[]);var Eb=d(555),ac=d(520),
xc=d(139);class Pc{constructor(a){this.Gya=this.BLb=this.IKb=null;this.qMb=!1;this.Pwd=this.Pef=null;this.npc=this.Kna=this.Bwc="";this.application=this.Zx=0;this.Zfl=this.HNe=!1;this.Pul=a&&u.AFrameworkApplication.fa.ka("OICLaunchDialogIsEnabled");u.AFrameworkApplication.Va.eS(G.a.yeb)||u.AFrameworkApplication.Va.ya(G.a.yeb,de.a.frame,Object(C.a)(this,this.ISk,"retryOpenInClientAction"));this.Kph=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("SilentExternalHandler")}get y0g(){return this.Zx}r3k(a,
b="",c=""){this.Kna=c||xg.a.create().toString();this.Bwc=b||Eb.a.qag();this.npc=a}ISk(a,b,c){return b.contextId!==de.a.frame?2:1===c?32:this.yeb()}get options(){let a=0;u.AFrameworkApplication.requiresCheckout&&(a|=1);u.AFrameworkApplication.D0g&&(a|=4);this.Xfl()&&(a|=64);return a}Xfl(){return!(2===this.application&&u.AFrameworkApplication.fa.ka("IsEmbeddedScenario"))}get Tpb(){return u.AFrameworkApplication.Rl}get s7a(){return u.AFrameworkApplication.bN}get skg(){return""}get J4d(){return""}get Yfl(){return u.AFrameworkApplication.fa.ka("OneNoteMobileViewerIsEnabled")}get $il(){return this.Pef||
(this.Pef=lb.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.HNe||this.xLi()}YWa(){this.Zfl||this.Q_f()}pFk(a){return this.Pul&&r.a.Ji?(new zr(this),32):this.Vob(a)}Vob(a){const b=({IYa:a}=this.EPj(a)).returnValue;Z.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===b,a);return b}begin(a,b,c,f,l,w){this.IKb=a;this.BLb=b;this.Gya=w;this.application=c;this.Zx=f;return u.AFrameworkApplication.gXf?(this.Byg(),32):u.AFrameworkApplication.XP&&!u.AFrameworkApplication.pjg?
(u.AFrameworkApplication.oph(),8):this.UGf(l)}get cek(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}yeb(){this.cek&&this.YSj();return this.Vob(this.qMb)}fih(){const a=new ac.a(Xe.a.openInClient);a.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();a.Values[la.a.eTf]=u.AFrameworkApplication.userSessionId;return this.Gya.value.send(a)?32:8}YSj(){Mf.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new pk.a,{inStaging:!0}))}PXk(a){const b=new ac.a(Xe.a.oxl);b.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();b.Values[la.a.eTf]=u.AFrameworkApplication.userSessionId;b.Values[yh.a.nxl]=a;this.Gya.value.send(b)}EPj(a){this.qMb=a;this.PXk(5===this.Zx?Pc.Jnk:Pc.Pnk);return 5===this.Zx?this.DPj():this.FPj()}DPj(){this.Gyg();return{returnValue:32,IYa:"HostEditUrl,"}}FPj(){let a;var b=a="";u.AFrameworkApplication.nBf&&(b="|f|"+u.AFrameworkApplication.userSessionId);
const c=u.AFrameworkApplication.fa.ka("IsAssignmentMode")&&u.AFrameworkApplication.fa.ka("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||u.AFrameworkApplication.Q4b||r.a.yDa,f=u.AFrameworkApplication.fa.ka("UnattemptedEnumIsEnabled"),l=u.AFrameworkApplication.fa.ka("NoBrowserModalDialogs");if(u.AFrameworkApplication.Va.C5c){var w=u.AFrameworkApplication.Va.qNc(3588168074);w&&this.r3k(w.epochClickTime,w.sessionOrigin,w.correlationId);this.pAg()}if(u.AFrameworkApplication.X4g){a+="NewOrder,";
w=8;this.Gya&&this.Gya.value&&this.Gya.value.isEnabled()&&u.AFrameworkApplication.rnc&&(a+="Post,",w=this.fih());if(32===w)return{returnValue:w,IYa:a};Z.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return u.AFrameworkApplication.$t.iva?(Z.ULS.shipAssertTag(5566816,211,!!u.AFrameworkApplication.$t.iva),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Ba.aO(!0,u.AFrameworkApplication.$t.iva),IYa:a}):this.IKb?(Z.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
u.AFrameworkApplication.userSessionId),a+="DocUrl,",bb.JXf(this.IKb,this.Zx,this.options,this.application,Object(C.a)(this,this.WWg,"onEditInClientSuccess"),Object(C.a)(this,this.VWg,"onEditInClientFailure"),this.Kph,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.Bwc,this.Kna,this.npc,u.AFrameworkApplication.Va.C5c),{returnValue:32,IYa:a}):{returnValue:8,IYa:a}}a+="OldOrder,";if(!this.IKb&&u.AFrameworkApplication.$t.iva)return this.Gya&&this.Gya.value&&this.Gya.value.isEnabled()&&
u.AFrameworkApplication.rnc?(a+="Post,",b=this.fih()):(Z.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),b=8),32!==b?(Z.ULS.shipAssertTag(22595484,211,!!u.AFrameworkApplication.$t.iva),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Ba.aO(!0,u.AFrameworkApplication.$t.iva),IYa:a}):{returnValue:b,IYa:a};Z.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",u.AFrameworkApplication.userSessionId);a+="DocUrl,";bb.JXf(this.IKb,
this.Zx,this.options,this.application,Object(C.a)(this,this.WWg,"onEditInClientSuccess"),Object(C.a)(this,this.VWg,"onEditInClientFailure"),this.Kph,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.Bwc,this.Kna,this.npc,u.AFrameworkApplication.Va.C5c);return{returnValue:32,IYa:a}}RPk(a){u.AFrameworkApplication.Yi.setDw(8981,a)}WWg(a){this.RPk(a);Z.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===a&&MSOJS.ClientUtils.ShouldShowDialog()?(this.Yfl||this.Gyg(),this.pAg()):
this.HNe||this.closeApplication()}VWg(a,b=0){Z.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",a,b);if(5===a)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const c=!!this.BLb&&!this.qMb;let f=0;1===a&&(f=2);6<=a&&13>=a&&(f=1,1===b&&(this.HNe=!0));this.$il.Ydk?(Z.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",f),ky.a.instance.rxi(this.qMb?Object(C.a)(this,this.VUg,"oicErrorDialogHandlerCloseForced"):
Object(C.a)(this,this.WUg,"oicErrorDialogHandlerNoCloseForced"),c?Object(C.a)(this,this.iYg,"onLaunchDownload"):null,this.PVf(!1)?Object(C.a)(this,this.erj,"iHaveOfficeButtonHandler"):null,f,b)):(Z.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",f),ky.a.instance.pxi(this.qMb?Object(C.a)(this,this.VUg,"oicErrorDialogHandlerCloseForced"):Object(C.a)(this,this.WUg,"oicErrorDialogHandlerNoCloseForced"),c?Object(C.a)(this,this.iYg,"onLaunchDownload"):null,f))}}pAg(){try{const a=
[Object.assign(new xc.a,{name:"CorrelationId",string:this.Kna}),Object.assign(new xc.a,{name:"SessionOrigin",string:this.Bwc}),Object.assign(new xc.a,{name:"ClickTime",string:this.npc}),Object.assign(new xc.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];qf.a("OpenInClientCompleted",!0,0,a)}catch(a){Z.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+a.toString())}}Gyg(){u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.QB&&u.AFrameworkApplication.fa.ka("StandardProtocolDialogIsEnabled")?
new U(this):new B(this)}VUg(){this.closeApplication()}WUg(){this.YWa()}iYg(){this.Byg()}erj(){return this.PVf(!0)}PVf(a){const b=(r.a.tRa||r.a.Xn)&&!!u.AFrameworkApplication.pGc;b&&a&&(id.a.Qm(u.AFrameworkApplication.pGc,"_blank",void 0,"OpenInClient"),this.closeApplication());return b}}Pc.Pnk="OpenInDesktop";Pc.Jnk="OpenInBrowser";Object(e.a)(Pc,"AOpenInClientOperation",null,[]);class hd extends Pc{constructor(a,b,c=!1){super(c);this.ILh=a;this.HLh=b}get skg(){return this.HLh}get J4d(){return this.ILh}xLi(){u.AFrameworkApplication.Va.Ma(G.a.close,
2,Ii.a)}Q_f(){}UGf(a){return this.pFk(a)}Byg(){Z.ULS.shipAssertTag(5566817,211,!!this.BLb);u.AFrameworkApplication.Sba?u.AFrameworkApplication.Ba.aO(!0,this.BLb):id.a.Qm(this.BLb,void 0,void 0,"LaunchDownload")}b1b(){u.AFrameworkApplication.Ba.jb.b1b()}}Object(e.a)(hd,"OpenInClientOperation",Pc,[]);class he extends hd{constructor(a,b,c,f){super("PowerPoint_32x32x32","EditInPowerPointWebApp_32x32x32");if(!a)throw Error.argumentNull("pathManager");this.tKg=b;this.Qd=a;this.Kp=c;this.ia=f}get Tpb(){return this.Qd.rk(this.s7a+
".png")}get s7a(){return"prt2"}UGf(a){return this.tKg?this.tKg(a):this.Vob(a)}Q_f(){za.a.J(18956686,801,50,"OpenInPowerPointOperation - restarting edit session");this.ia.Ma(aa.a.refresh,2,{refreshtrigger:"OpenInPowerPointOperation::ExecuteRestartApplication"})}Vob(a){this.Kp.Q3b=!0;return super.Vob(a)}}Object(e.a)(he,"OpenInPowerPointOperation",hd,[]);class Re{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He){this.tGg=null;this.CD=w;this.ia=a;this.Ga=b;this.sa=c;this.Qd=f;this.sKg=
new he(this.Qd,Object(C.a)(this,this.cai,"beginSaveBeforeOpenInClient"),pb,a);F.execute(Pe=>{this.tGg=new sc.a(()=>Pe)});this.CYj=l;this.lu=S;this.n8j=fa;this.ua=xa;this.Zb=Za;this.Ha=Mb;this.Za=hc;this.H8=kc;this.Rb=Ec;this.Wd=Hc;this.Zl=Dc;this.$u=Td;this.Kab=we;this.G8=Pd;this.NN=He}wb(){this.ia.ya(aa.a.openInClient,$b.a.application,Object(C.a)(this,this.z0g,"openExternal"));this.ia.ya(G.a.owe,$b.a.application,Object(C.a)(this,this.z0g,"openExternal"));this.ia.ya(aa.a.convertAndEdit,$b.a.application,
Object(C.a)(this,this.psi,"convertBinaryFormat"));this.ia.ya(aa.a.repair,$b.a.application,Object(C.a)(this,this.oPk,"repairCorruptedFile"));this.ia.ya(aa.a.Rhc,$b.a.application,Object(C.a)(this,this.Rhc,"replaceOriginalFile"));this.ia.ya(aa.a.WEb,$b.a.application,Object(C.a)(this,this.WEb,"saveRepairedFile"));this.ia.ya(aa.a.HXb,$b.a.application,Object(C.a)(this,this.HXb,"editAnyway"));this.ia.ya(aa.a.N0b,$b.a.application,Object(C.a)(this,this.N0b,"goToEditMode"));this.ia.$d(aa.a.openInClient,12288)}cai(a){if(this.Zl.isPaused)return this.Ga.Bd(),
this.TFe(a),32;this.sa.Rh();this.Ga.Bd();if(1===this.Rb.mode&&this.Ha.gTc)return this.F2f(a),32;this.CD.d2(a,!0,()=>{this.TFe(a)},()=>{this.TFe(a);return!0},3);this.lu.show(!1,"OpenInClient");return 32}TFe(a){this.lu.hide();this.F2f(a)}F2f(a){Kc.a.Bkd();this.sKg.Vob(a)}z0g(a,b,c){if(b.contextId!==$b.a.application)return 2;b=!(!this.Qd.documentUrl&&!this.CYj.iva&&!u.AFrameworkApplication.rnc);if(1===c)return b?32:8;if(!b)return 8;this.OUj();if(this.Zb.gd(this.n8j.Bf))return 16;a=a===G.a.owe?5:2;1===
this.Rb.mode&&this.Ha.gTc&&(a=1);return this.sKg.begin(this.Qd.documentUrl,u.AFrameworkApplication.uOa,3,a,this.Ha.rHj,this.tGg)}OUj(){try{let a="";const b=this.ua.Lj;b&&(a=b.toString());za.a.J(18956688,801,50,"User clicked OpenInClient. Slide index: {0}. Slide stats:{1}",this.ua.currentSlideIndex,a)}catch(a){za.a.J(18956690,801,10,"Exception caught while logging slide stats for OpenInClient: {0}",a)}}psi(a,b,c){za.a.J(24130758,801,50,"PowerPointAppFrameCommandUIActor - ConvertBinaryFormat");if(b.contextId!==
$b.a.application)return 2;if(1===c)return 32;const f=Object.assign(new jy,{PodEndpointUrl:this.Ha.podsWebServiceBase,PodSessionID:this.Za.podSessionId,PresentationID:this.Za.presentationId.string});this.H8.Yld(f,Object(C.a)(this,this.Ymk,"onUploadConvertedFileToHostSucceeded"),l=>{this.Xmk(l,f.PodSessionID)});this.lu.PLe(!0,ResourceStrings.L_FileConverting,a);return 32}Ymk(a){za.a.J(24130760,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded");this.lu.hide();if(this.Rb)if(a=
a.result,a.EditUrl){var b=!1,c=!1,f=!1;u.AFrameworkApplication.fa&&(b=u.AFrameworkApplication.fa.ka("IsUIEmbedMode"),c=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),f=u.AFrameworkApplication.fa.ka("UiHostSupportsPPTConvertScenarios"));if(b&&c&&f){za.a.J(589312029,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded Sending DocumentRefresh post message.");const l={};l[yh.a.SDb]="1";l[yh.a.documentUrl]=a.EditUrl;l[yh.a.mode]="edit";l[yh.a.reason]=Ov.a.convert;
u.AFrameworkApplication.tV().execute(w=>{w.sendMessage(Xe.a.TAa,l)})}else this.Rb.aO(!0,a.EditUrl)}else za.a.J(24130764,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no EditUrl");else za.a.J(24130762,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no available app frame")}Xmk(a,b){a=kf.a.GM(a.error.Gm);za.a.J(24130766,801,10,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostFailed error: {0}",a);this.lu.hide();a=Object.assign(new tj.a,
{Code:a,Source:5});this.Wd.Mr(a,b,c=>{c.$C=1;c.cAa=6;c.title=ResourceStrings.L_FileConversionTitle;c.message=ResourceStrings.L_FileConversionError;return!1})}oPk(a,b,c){if(b.contextId!==$b.a.application)return 2;if(1===c)return 32;za.a.J(25011969,801,50,"PowerPointAppFrameCommandUIActor - Start to repairCorruptedFile");this.qPk();return 32}qPk(){const a=new Date;za.a.J(42858700,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Starting Document repair. Start-time {0}",a);const b=Kc.a.Nm("PowerPointAppFrameCommandUIActor.InlineDocumentRepair");
this.NN.fob(()=>{za.a.J(50677722,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closed the pop session early that was triggered due to late detection (after open early success) of corruption. To avoid lock mismatch while writing to host for overwrite case is the reason we do proactively.")},()=>{za.a.J(50677724,801,15,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closing the pop session early failed. This might lead to overwrite the file  issues with a lock mismatch error.")});
this.Kab.Xch(b,()=>{za.a.J(42858702,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Successfull,Time-Taken {0}",+new Date-+a);b.finish();this.Nll()},c=>{za.a.J(42858704,801,10,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Failed,Time-Taken {0}, Error: {1}",+new Date-+a,c);b.finish();this.Ryk(c,this.Za.podSessionId);return!0})}Nll(){var a={failedMachineId:null,isPlanedShutdown:!1};a.podSessionId=this.Za.podSessionId;a.fromInlineDocumentRepair=!0;this.$u.FHe();
a=this.ia.Ma(aa.a.WDb,2,a);za.a.J(42858706,801,50,"PowerPointAppFrameCommandUIActor::TriggerDocRefresh: Response-{0}",a)}Ryk(a,b){a=Object.assign(new tj.a,{Code:a,Source:5});this.Wd.Mr(a,b,c=>{c.$C=1;c.cAa=52;c.title=ResourceStrings.l_RepairFailDialogTitle;c.message=ResourceStrings.l_RepairFailedMessage;return!1})}HXb(a,b,c,f,l){if(b.contextId!==$b.a.application)return 2;if(1===c)return 32;za.a.J(38290632,801,50,"PowerPointAppFrameCommandUIActor - EditAnyway");a=this.$u.Mrb();0!==a&&(za.a.J(593268952,
801,15,"PowerPointAppFrameCommandUIActor::EditAnyway - Creating Pop session as emergencyViewModeEnabledReason: {0}",a),this.ZRf());if(20===l)this.$u.orl();else return za.a.J(38290634,801,10,"PowerPointAppFrameCommandUIActor - Unexpected EditAnyway operation"),8;return 32}WEb(a,b,c,f,l){if(b.contextId!==$b.a.application)return za.a.J(42823955,801,15,"PowerPointAppFrameCommandUIActor - SaveRepairedFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return this.ia.processAction(l,
1);za.a.J(42823957,801,50,"PowerPointAppFrameCommandUIActor - SaveRepairedFile - saveAsActionId : {0}",l);this.$cg(1,l);return 32}$cg(a,b){za.a.J(42823959,801,50,"GetSnappedDownloadUrl for saving the repaired file");const c=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.Ha.podsWebServiceBase,this.Za.podSessionId),f={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;const l=new Date;
u.AFrameworkApplication.Be.Jj(c,1,"",f,!1,0,w=>{this.Zhk(w,l,b)},w=>{this.Yhk(w,a,b)},null,null)}Zhk(a,b,c){za.a.J(42823961,801,50,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+b);a=JSON.parse(a.data.je).downloadUrl;Ja.a.Xa(a)?(za.a.J(42823963,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty"),this.Bqh()):(b={SkipSaveToHost:"true"},b.FileDownloadUrl=a,this.ia.Ma(c,2,b))}Yhk(a,b,c){a=a.data?a.data.tf:
-1;a===Pp.a.G$h&&0<b--?(za.a.J(42823965,801,15,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",a),this.$cg(b,c)):(za.a.J(42823967,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : HttpStatus: {0} , SaveAsActionId : {1}",a,c),this.Bqh())}Bqh(){const a=Object.assign(new tj.a,{Code:20,Source:6});this.Wd.Mr(a,this.Za.podSessionId,b=>{b.$C=1;b.cAa=1;b.title=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogTitle;
b.message=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogMessage;return!1})}Rhc(a,b,c){if(b.contextId!==$b.a.application)return za.a.J(50677769,801,15,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return a=u.AFrameworkApplication.fa.Ia("DocumentPermissions")||"",b=this.Za.l1g&&-1<a.indexOf("W"),za.a.J(51127232,801,b?50:15,"PowerPointAppFrameCommandUIActor::ReplaceOriginalFile- InlineRepairedFile case: IsReplaceRepairedEnabled : {0}, Document Permission : {1} ",
this.Za.l1g,a),b?32:8;za.a.J(50677771,801,50,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile");this.Za.uk=this.G8.F5a(this.Za.presentationId.string);a=Object.assign(new Cn.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Za.podSessionId,PresentationID:this.Za.presentationId.string,PodEndpointUrl:this.Ha.podsWebServiceBase,PopSessionID:this.Za.uk,UrlOverrides:this.Ha.Rda,IsCreateNewSession:this.Ha.rS,UseSharedHostFile:this.Ha.oJb});this.G8.WBc(a,()=>{this.dhk()},Object(C.a)(this,
this.PBb,"onEnsureHostSessionFailed"),0,!0);return 32}dhk(){za.a.J(50677773,801,50,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccess");this.$u.TQk();this.Za.iRk();0!==this.$u.Mrb()&&this.$u.GHe(!1)}PBb(){za.a.J(50677775,801,10,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionFailed");this.$u.FHe();0!==this.$u.Mrb()&&this.$u.GHe(!0);return!1}N0b(a,b,c){if(b.contextId!==$b.a.application)return za.a.J(593297441,801,15,"PowerPointAppFrameCommandUIActor - GoToEditMode. Context id don't match with Application. ContextId: {0}",
b.contextId),2;if(1===c)return 32;a=new Date;this.ZRf();za.a.J(593268936,801,15,"PowerPointAppFrameCommandUIActor::GoToEditMode. Time-Taken to create pop session : {0}",+new Date-+a);return 32}ZRf(){this.Za.uk=this.G8.F5a(this.Za.presentationId.string);const a=Object.assign(new Cn.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Za.podSessionId,PresentationID:this.Za.presentationId.string,PodEndpointUrl:this.Ha.podsWebServiceBase,PopSessionID:this.Za.uk,UrlOverrides:this.Ha.Rda,
IsCreateNewSession:this.Ha.rS,UseSharedHostFile:this.Ha.oJb});this.G8.WBc(a,()=>{this.ehk()},null,15,!0);this.$u.GHe(!1)}ehk(){za.a.J(593297435,801,15,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccessForEmergencyViewMode")}}Object(e.a)(Re,"PowerPointAppFrameCommandUIActor",null,[]);var Bf=d(498);class Ih{constructor(a,b,c){this.fCg=a;this.SZ=b;this.mke=c}show(a,b){this.mke?(b=new Bf.a(b),b.message=ResourceStrings.l_Saving,b.Esg=!0,b.MGb=a,this.SZ.lHa(b)):this.PLe(a,ResourceStrings.l_Saving,
b)}PLe(a,b,c){this.mke?(c=new Bf.a(c),c.message=b,c.MGb=a,this.SZ.lHa(c)):this.fCg.OGb(b,a,0,0,c)}hide(){this.mke?this.SZ.lHa(Object.assign(new Bf.a(null),{Dsg:!0})):this.fCg.dPc()}}Object(e.a)(Ih,"SaveBlockingUI",null,[556]);var bh=d(233);class Ni{constructor(a,b,c,f,l,w,F,S,fa){this.g9b=gb.App.Bm;this.vJg=Fa.a.nil;this.Bb=a;this.ua=b;this.Oc=c;this.Dk=f;this.VK=l;this.m2c=w;this.QA=S;this.Hs=F;this.m2j=fa.hVk;this.Z2j=fa.pptNotShowSavingStatusOfProofingOnlyRevision;this.Oc.wB(Object(C.a)(this,this.ZA,
"onSessionEnd"));this.Dk.oGd(Object(C.a)(this,this.PAh,"updateSavingStatus"));this.Dk.tCf(Object(C.a)(this,this.OAh,"updateSavedStatus"));this.Hs.aP(Object(C.a)(this,this.kna,"updateSaveStatusDisplay"));this.H7j=new Se.a(3,1,fa.gVk,Object(C.a)(this,this.updateSaveStatusText,"updateSaveStatusText"),90,"28");this.URa=!1;this.U3j=fa.powerPointTextEditOnlyMode}initialize(){this.kna(this.Hs)}OAh(){this.URa||this.QA.I7||this.QA.Tvg||(this.Bb.Hb(this.H7j),this.URa=!0)}PAh(a,b){this.QA.I7||this.QA.Tvg||(this.Z2j&&
Ni.qJj(b.node)||this.m2c.updateSaveStatusText(!1),this.g9b=new Date,this.vJg=b?b.revisionId:Fa.a.nil)}updateSaveStatusText(){this.URa=!1;const a=!this.VK.DV(this.ua.presentation);this.m2c.updateSaveStatusText(a);a&&(this.gdh(0,0),this.g9b=gb.App.Bm);this.U3j&&Ni.Erl(a)}kna(a){this.m2c.kna(!1,1===a.mode?1:3)}ZA(a,b){this.m2c.updateSaveStatusText(!0);this.gdh(1,b.aJ);this.g9b=gb.App.Bm}gdh(a,b){if(this.g9b!==gb.App.Bm){var c=+new Date-+this.g9b;c>=this.m2j&&(c=String.format("SavingTime {0};Type {1};Revision {2};",
c,a,this.vJg),1===a&&(c+=String.format("CloseReason {0};",b)),za.a.J(21604228,811,50,c))}}dispose(){this.Oc.aea(Object(C.a)(this,this.ZA,"onSessionEnd"));this.Dk.rDe(Object(C.a)(this,this.PAh,"updateSavingStatus"));this.Dk.dch(Object(C.a)(this,this.OAh,"updateSavedStatus"));this.Hs.Q_(Object(C.a)(this,this.kna,"updateSaveStatusDisplay"))}static Erl(a){const b=document.getElementById("TipStatus"),c=document.getElementById("TipStatusIcon"),f=document.getElementById("TipStatusText");b.style.display=
"block";a?(c.setAttribute("class","TipStatusSaved"),f.innerText=ResourceStrings.l_SavedShort):(c.setAttribute("class","TipStatusLoading"),f.innerText=ResourceStrings.l_SavingShort)}static qJj(a){return a.Sa(zb.a.R$c)&&!a.Sa(bh.a.ked)}}Object(e.a)(Ni,"SaveStatusManager",null,[109]);class mi{constructor(){this.K=null;this.Kke=!1}get name(){return"PowerPointWebEditor.Actors"}Yb(a){(new vs).Yb(a);this.K=a;a.register(Re,"PowerPointWebEditor.PowerPointAppFrameCommandUIActor").ma().na(()=>new Re(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPoint.IPathManager"),a.resolve("Common.IDocPropertiesProvider"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.Oa("Postmessage.IHostPostmessenger"),a.resolve("PowerPointWebEditor.ISaveBlockingUI"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager")));a.register(556,"PowerPointWebEditor.ISaveBlockingUI").ma().na(()=>new Ih(new iy(new wt(a.resolve("PowerPointWebEditor.IPaneManager").za,"SaveBlockingUI",!0),a.resolve("PowerPointWebEditor.IActionNameResolver")),a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").jug));a.register(Ni,"PowerPointWebEditor.SaveStatusManager").ma().na(()=>new Ni(a.resolve("Common.ITaskManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){(this.Kke=this.K.resolve("PowerPointWebEditor.IApplicationSettings").VIj)&&
this.K.resolve("PowerPointWebEditor.SaveStatusManager").initialize();this.K.resolve("PowerPointWebEditor.PowerPointAppFrameCommandUIActor").wb();this.K.resolve("Common.IOfficeTrialExperience").wb();this.K.resolve("Common.IMacOfficeOffer").wb()}dispose(){this.Kke&&this.K.resolve("PowerPointWebEditor.SaveStatusManager").dispose()}static main(){m.a.instance.Ec(new mi)}}Object(e.a)(mi,"PowerPointActorsPackage",null,[2,3]);var tl=d(995),jh=d(1059);class um{constructor(){this.wMa=this.AR=this.wya=null;
this.duf=!1;this.TUe=null;this.UUe=this.xOb=0}get messageId(){return this.wya}get values(){return this.AR}get userSessionId(){return this.wMa}get shouldRetry(){return this.duf}get wyc(){return this.TUe}get Gua(){return this.xOb}get nXh(){return this.UUe}static qyi(a,b){var c=Xe.a.JBi;const f=new um;f.wya=a;f.AR={};f.wMa=b;f.duf=!0;f.TUe=c;f.xOb=3;f.UUe=1E3;return f}}Object(e.a)(um,"PostMessageData",null,[]);class so{constructor(a,b,c){this.GCd={};this.mb=a;this.ntd=c;this.dSj();this.CHk(b)}dSj(){if(this.mb.ka("DocRebootIsSupported")||
this.mb.ka("UiHostSupportsDocRebootFeatures"))this.GCd[jh.a.refresh]=()=>this.DXk(Xe.a.TAa)}CHk(a){a.ya(G.a.o8g,de.a.frame,Object(C.a)(this,this.bXk,"sendActionToHostIfSupported"))}bXk(a,b,c,f,l){if(2!==c)return 32;if(!l)return Z.ULS.sendTraceTag(41972610,204,15,"HostActionExecutionManager - No actionData provided"),16;a=l.toLowerCase();return this.GCd[a]?(Z.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",a),this.GCd[a]()):2}DXk(a){const b=um.qyi(a,
u.AFrameworkApplication.userSessionId);this.ntd.execute(c=>{c.postMessage(b)});return 32}}Object(e.a)(so,"HostActionExecutionManager",null,[]);var Dn=d(115),dp=d(710);class Bm extends la.a{constructor(a,b,c,f){super(a,b,c);this.PMb=this.B5=0;this.b4e=!1;this.RMb=0;this.mtd=this.Orc=null;this.c4e=this.d4e=!1;this.Da=f;this._name="HostIntegrationMessenger";this.create()}Dqj(a){const b=a.message,c=a.Ri.origin;u.AFrameworkApplication.wopiHostOriginFromPostMessage||(u.AFrameworkApplication.wopiHostOriginFromPostMessage=
c);switch(b.MessageId){case Xe.a.sJd:case Xe.a.uJd:this.xqj(b);break;case Xe.a.d2d:case Xe.a.e2d:this.Ikd();break;case Xe.a.j4d:this.Fqj(b);break;case Xe.a.U8a:this.BOj(b);break;case Xe.a.ITe:this.U$h(a);break;case Xe.a.MTe:this.npl()}}Nol(a){switch(a.MessageId){case Xe.a.f4d:u.AFrameworkApplication.Va.Ma(G.a.sdd,2,a.Values[yh.a.direction]);break;case Xe.a.htb:Z.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received");u.AFrameworkApplication.Va.Ma(G.a.htb,2,(new Date).getTime());break;case Xe.a.g4d:Z.ULS.sendTraceTag(544221062,
204,50,"We received HostBackButtonPressed message in WAC");break;case Xe.a.h4d:Z.ULS.sendTraceTag(543459140,204,50,"Host_GetClientUrl Recieved");u.AFrameworkApplication.Va.processAction(G.a.MXi,2);break;case Xe.a.L1b:Z.ULS.sendTraceTag(541894173,204,50,"Host_CopyLink Recieved");u.AFrameworkApplication.Va.processAction(G.a.L1b,2);break;case Xe.a.i4d:Z.ULS.sendTraceTag(539760468,204,50,"Host_GetWebUrl Received");u.AFrameworkApplication.Va.processAction(G.a.ufj,2);break;case Xe.a.m4d:Z.ULS.sendTraceTag(537424842,
204,50,"Host_SendChannelId Received")}}Ikd(){v.FocusManager.instance()&&v.FocusManager.instance().ye&&v.FocusManager.instance().ye.name===u.AFrameworkApplication.rdb&&v.FocusManager.instance().n4(v.FocusManager.instance().ye.name)}xqj(a){v.FocusManager.instance().hX(u.AFrameworkApplication.rdb,!1);if(yh.a.Ujc in a.Values){const b={};b[yh.a.Ujc]=a.Values[yh.a.Ujc];Z.ULS.sendTraceTag(38278996,204,50,md.c(b))}}Fqj(a){if(!Jf.a.rV(document.URL,u.AFrameworkApplication.$4c)&&a.Values){var b=0,c=0;try{b=
a.Values[yh.a.Gqj],c=a.Values[yh.a.Hqj],yh.a.ujg in a.Values?this.Orc=a.Values[yh.a.ujg]:yh.a.vjg in a.Values&&(this.Orc=a.Values[yh.a.vjg]),yh.a.wjg in a.Values&&(this.mtd=a.Values[yh.a.wjg])}catch(f){return}this.PMb=b;this.RMb=c;this.B5&&this.bAg()}}BOj(a){Z.ULS.sendTraceTag(37536415,204,50,"JsApiDiagnostics");var b=a.Values[yh.a.Cqj];b&&Xi.a.instance.hGk(b);(b=a.Values[yh.a.hMd])&&Xi.a.instance.VFk(b);(a=a.Values[yh.a.U8a])&&Xi.a.instance.mGk(a)}U$h(a){Z.ULS.sendTraceTag(40433733,338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",
Date.now());u.AFrameworkApplication.r4b=!0;u.AFrameworkApplication.Ba.m0.Ote(a.Ri.nc)}npl(){Z.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now());u.AFrameworkApplication.Ba.m0.lve(null,Sys.EventArgs.Empty)}bAg(){this.bUj();this.cUj();null!=this.Orc&&Xi.a.instance.iGk(this.Orc);null!=this.mtd&&Xi.a.instance.jGk(this.mtd)}bUj(){this.B5&&this.PMb&&!this.b4e&&(this.b4e=!0,this.PMb>this.B5||(u.AFrameworkApplication.Yi.setDw(10324,this.B5-this.PMb),Xi.a.instance.n$g(this.PMb)))}cUj(){this.B5&&
this.RMb&&!this.d4e&&(this.d4e=!0,this.RMb>this.B5||(u.AFrameworkApplication.Yi.setDw(10325,this.B5-this.RMb),Xi.a.instance.OGk(this.RMb)))}PPk(){var a=id.a.Reg();if(a){var b=0;a=a.fetchStart;void 0!==a&&null!==a&&(b=a);0>=b||b>this.B5||u.AFrameworkApplication.Yi.setDw(11045,this.B5-b)}}create(){u.AFrameworkApplication.krg&&this.disable();this.OIa!==dp.a.SSb&&this.Myc(this.OIa);this.Da.ra(G.a.FFi,de.a.frame,Object(C.a)(this,this.KFi,"disposeInstance"),96);this.Qt(Xe.a.sJd);this.Qt(Xe.a.uJd);this.Qt(Xe.a.d2d);
this.Qt(Xe.a.e2d);this.Qt(Xe.a.j4d);this.Qt(Xe.a.l4d);this.Qt(Xe.a.rHd);const a=Object(C.a)(this,this.Dqj,"hostMessageHandler");this.EWa(Xe.a.sJd,a);this.EWa(Xe.a.uJd,a);this.EWa(Xe.a.d2d,a);this.EWa(Xe.a.e2d,a);this.EWa(Xe.a.j4d,a);u.AFrameworkApplication.fa.ka("OneNoteEmbedUnloadIsEnabled")&&(this.Kzf(Xe.a.ITe),this.Kzf(Xe.a.MTe),this.EWa(Xe.a.ITe,a),this.EWa(Xe.a.MTe,a));if(u.AFrameworkApplication.fa.ka("PostMessageEmbedded")||u.AFrameworkApplication.fa.ka("IsJsApi")){this.Qt(Xe.a.htb);const b=
Object(C.a)(this,this.Nol,"uiHostMessageHandler");u.AFrameworkApplication.fa.ka("SupportsAccessibilityLoop")&&(this.Qt(Xe.a.f4d),this.cB(Xe.a.f4d,b));this.cB(Xe.a.htb,b);u.AFrameworkApplication.fa.ka("MobileEmbedViewerIsEnabled")&&(this.Qt(Xe.a.h4d),this.cB(Xe.a.h4d,b),this.Qt(Xe.a.g4d),this.cB(Xe.a.g4d,b),this.Qt(Xe.a.L1b),this.cB(Xe.a.L1b,b),this.Qt(Xe.a.i4d),this.cB(Xe.a.i4d,b));u.AFrameworkApplication.fa.ka("OneNotePageLevelConversationInTeamsIsEnabled")&&(this.Qt(Xe.a.m4d),this.cB(Xe.a.m4d,b))}u.AFrameworkApplication.fa.ka("IsJsApi")&&
(this.Qt(Xe.a.U8a),this.EWa(Xe.a.U8a,a))}KFi(a,b,c){if(2!==c)return 32;Dn.a.Xw(this);return 32}reportDocumentLoadedTime(a){this.c4e||(this.B5=a,this.PPk(),this.OIa!==dp.a.SSb&&this.sendMessage(Xe.a.V6h,{["DocumentLoadedTime"]:a}),this.bAg(),this.c4e=!0)}}Object(e.a)(Bm,"HostIntegrationMessenger",la.a,[672,671,109]);class sn{constructor(){this.Ea=null}get name(){return"Common.App.Postmessengers"}init(){u.AFrameworkApplication.fa.gf(()=>{this.o5d(this.Ea)})}o5d(a){u.AFrameworkApplication.NP=a.resolve("Common.App.Postmessengers.HostIntegrationMessenger");
u.AFrameworkApplication.fa.ka("HostActionExecutionIsEnabled")&&a.resolve("Common.App.HostActionExecutionManager")}dispose(){}Yb(a){this.Ea=a;a.register(Bm,"Common.App.Postmessengers.HostIntegrationMessenger").as("Postmessage.IHostPostmessenger").ma().na(()=>{u.AFrameworkApplication.fa.Uba||Z.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");const b=u.AFrameworkApplication.Rla?u.AFrameworkApplication.Rla:dp.a.SSb;Z.ULS.sendTraceTag(536987587,204,
50,"HostIntegrationMessenger instantiating");return new Bm(window.parent,b,tl.a.instance,u.AFrameworkApplication.Va)});a.register(so,"Common.App.HostActionExecutionManager").ma().na(()=>{u.AFrameworkApplication.fa.Uba||Z.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready");return new so(u.AFrameworkApplication.fa,u.AFrameworkApplication.Va,a.Oa("Postmessage.IHostPostmessenger"))})}}Object(e.a)(sn,"PostmessengersPackage",null,[2,3]);var uo=d(395),
Kl=d(340),nk=d(289),Of=d(220);class Jv extends Of.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(e.a)(Jv,"PersonaButtonProps",Of.a,[]);class Ux{eWb(a,b){if(a&&!(1>a.length)&&b){var c=Object.assign(new nk.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.Dvi(a,c.ControlList);b.push(c)}}Dvi(a,b){const c=Object.assign(new uo.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Kl.a,
{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(b,c);b=Object.assign(new nk.a,{Title:"",ControlList:[]});Array.add(c.Menu.MenuSectionList,b);this.Mxi(a,b.ControlList)}Mxi(a,b){for(let c=0;c<a.length;c++){const f=Object.assign(new Jv,{ExternalId:String.format("CoauthorPersona_{0}",c),Command:"336231556",DisplayName:a[c].userName,LabelText:a[c].userName,ImageBackColor:a[c].color,PersonaId:a[c].email,IsAnonymous:a[c].isAnonymous});Array.add(b,f)}}}
Object(e.a)(Ux,"PresenceContextMenuSectionBuilder",null,[466]);var Kv=d(339);class oA{constructor(a,b,c,f){this.VX=this.Mn=this.Am=this.wf=this.Bna=null;this.Pwc=a;this.TTh=f;this.Pwc.k7d&&(this.Am=new Se.a(3,2,5E3,Object(C.a)(this,this.i$h,"authenticationCheckTask"),2),u.AFrameworkApplication.ve.Hb(this.Am),this.wb(b,c));this.Pwc.g1h(()=>{this.wcc()});this.Pwc.KBf(()=>{this.xcc()})}get businessBar(){return this.Mn||(this.Mn=lb.a.instance.qb("CommonUI.IBusinessBar"))}get DIf(){return this.VX||(this.VX=
lb.a.instance.qb("CommonUI.IBusinessBarEntryFactory"))}wb(a,b){const c=u.AFrameworkApplication.Va;c.ra(G.a.xGf,de.a.frame,a,96);c.ra(G.a.yGf,de.a.frame,b,96);c.ya(G.a.TKf,de.a.frame,Le.ActionManager.Ju);c.ya(G.a.UKf,de.a.frame,Le.ActionManager.Ju);c.ya(G.a.lbe,de.a.frame,Le.ActionManager.Ju)}wcc(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);u.AFrameworkApplication.Va.processAction(G.a.xGf,2)}xcc(){this.$hl();u.AFrameworkApplication.Va.processAction(G.a.yGf,2)}i$h(){this.Pwc.authenticationCheck()}$hl(){this.wf&&
(this.wf.hide(),this.wf.dispose(),this.wf=null);this.Bna&&this.businessBar&&(u.AFrameworkApplication.Xg||this.businessBar.removeEntry(this.Bna),this.Bna.dispose(),this.Bna=null)}showDialog(a){Dn.a.Xw(this.wf);this.wf=new hf.StandardDialog;this.TTh||(this.wf.Zq=!1,this.wf.vd=0);this.wf.Pe(1,CommonUIStrings.l_SignIn);this.wf.nO(CommonUIStrings.l_DefaultDialogTitle,a,Object(C.a)(this,this.R1,"dialogHandler"))}R1(a){1===a?(Kv.a.D9c(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),
u.AFrameworkApplication.Va.processAction(G.a.lbe,2)):(this.f9k(),u.AFrameworkApplication.Va.processAction(G.a.UKf,2))}f9k(){this.businessBar&&this.DIf&&(this.Bna=this.DIf.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.Bna.closeable=!0,this.Bna.addButton(CommonUIStrings.l_SignIn,oA.Wdi,""),this.Bna.G1=Object(C.a)(this,this.Xdi,"businessBarEntryCloseHandler"),this.businessBar.ai(this.Bna,!1))}Xdi(){this.XEi();u.AFrameworkApplication.Va.processAction(G.a.TKf,
2)}XEi(){this.Am&&(u.AFrameworkApplication.ve.ah(this.Am),this.Am=null)}dispose(){this.Am=this.wf=this.Bna=null}static Wdi(){Kv.a.D9c();u.AFrameworkApplication.Va.processAction(G.a.lbe,2)}}Object(e.a)(oA,"SignOutResponseUI",null,[109]);class Ar{get name(){return"Common.App.UI"}Yb(a){a.register(Ux,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ma()}init(){}dispose(){Dn.a.Xw(Ar.iaa);Ar.iaa=null}static main(){m.a.instance.Ec(new Ar)}static puj(a,
b,c){Ar.S8k()&&(Ar.iaa=new oA(Kv.a.instance,a,b,c))}static S8k(){return u.AFrameworkApplication.sTg&&!u.AFrameworkApplication.isEmbedded}}Ar.iaa=null;Object(e.a)(Ar,"CommonAppUIPackage",null,[2,3]);class pA{constructor(a){this.Rya=this.Mya=this.Wya=this.Vya=null;this.B3e=this.qbf=this.LO=this.S$=!1;this.lAd=this.Ibf=null;this.Bbf=0;this.mb=this.Hbf=null;this.rfa=a;this.rJ=3;this.oNb=!0}initialize(a,b,c){this.Vya=this.h0d(a,b);this.Wya=CommonUIStrings.l_SavingStatus;this.Mya=CommonUIStrings.l_ReadOnlyStatus;
this.Rya=CommonUIStrings.l_ReviewModeStatus;this.rfa&&this.rfa.execute(f=>{f.yzc(Object(C.a)(this,this.jnc,"updateToSavingStatus"))});this.LO=!0;this.mb=c;return!0}kna(a,b){this.S$=a;this.rJ=b;this.updateSaveStatusText(this.oNb)}updateSaveStatusText(a){!this.oNb&&a&&(this.Hbf=new Date);this.oNb=a;a=null;3===this.rJ&&(a=this.oNb?this.Vya:this.Wya);this.mFi(a)}h0d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,
b):CommonUIStrings.l_SavedStatus}jnc(){this.updateSaveStatusText(!1)}r5i(){switch(this.rJ){case 1:return this.Mya;case 2:return this.Rya;default:return null}}LCj(a){return this.qbf===this.S$&&this.Bbf===this.rJ&&this.Ibf===a}tRd(a){appChrome.getHeaderApi().then(b=>{b.updateDocumentTitleStatus(this.S$,a,this.r5i(),this.Hbf,this.oNb);this.B3e=!0;return null});this.lAd=null}mFi(a){this.LO&&Pg.c()&&!this.LCj(a)&&(!this.B3e&&this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",
!1)?this.tRd(a):id.a.Ldh()?(this.lAd&&Z.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.lAd=window.requestIdleCallback(()=>{this.tRd(a)})):window.requestAnimationFrame(()=>{this.tRd(a)}),this.qbf=this.S$,this.Ibf=a,this.Bbf=this.rJ)}}Object(e.a)(pA,"ReactSaveStatusUIHandler",null,[670]);class qA{constructor(a,b){this.NP=null;this.Vya=CommonUIStrings.l_SavedStatus;this.Wya=CommonUIStrings.l_SavingStatus;this.Mya=CommonUIStrings.l_ReadOnlyStatus;
this.Rya=CommonUIStrings.l_ReviewModeStatus;this.kya=b;this.rfa=a;this.rJ=3;this.ZLa=!0}VI(){this.rfa&&this.rfa.execute(a=>{a.yzc(Object(C.a)(this,this.jnc,"updateToSavingStatus"))});this.kya.execute(a=>{this.NP=a})}kna(a,b){this.rJ=b;3===b?this.updateSaveStatusText(this.ZLa):2===b?this.iRe(this.Rya):this.iRe(this.Mya)}jnc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.ZLa=a;this.iRe(this.ZLa?this.Vya:this.Wya)}iRe(a){this.NP&&this.NP.sendMessage(Xe.a.Lol,this.gri(a))}gri(a){const b=
{};b.StatusText=a;return b}}Object(e.a)(qA,"SaveStatusPostMessageHandler",null,[670]);var rm=d(262);class rA{constructor(a,b,c,f){this.Rya=this.Mya=this.Wya=this.Vya=null;this.A0a=0;this.UO=this.$Ad=this.FZa=this.mod=this.BDd=null;this.Ze=a;this.$na=b;this.rfa=c;this.Oi=f;this.$6e=!0;this.S$=!1;this.rJ=3;this.ZLa=!0}initialize(a,b){if(!this.Ze)return!1;this.Vya=this.h0d(a,b);this.Wya=CommonUIStrings.l_SavingStatus;this.Mya=CommonUIStrings.l_ReadOnlyStatus;this.Rya=CommonUIStrings.l_ReviewModeStatus;
this.VI();return!0}h0d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}VI(){this.$na&&this.$na.execute(a=>{a.q3h(Object(C.a)(this,this.ySf,"createStatusAndModeElements"));a.X2h(Object(C.a)(this,this.k$k,"showHideSaveStatusElement"));a.Dkl&&this.ySf(null,null)});this.rfa&&this.rfa.execute(a=>{a.yzc(Object(C.a)(this,this.jnc,"updateToSavingStatus"))})}qxa(){this.UO&&
this.Ze&&this.Ze.kld(this.UO)}k$k(a,b){this.kna("true"===b,this.rJ)}kna(a,b){this.S$=a;this.rJ=b;this.mod&&(this.mod.style.display=this.S$||3===this.rJ||!this.BDd?"none":"");this.FZa&&(this.FZa.style.display=this.S$||3===this.rJ?"none":"",this.FZa.innerText=1===this.rJ?this.Mya:this.Rya,this.FZa.title=1===this.rJ?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.$Ad&&(this.$Ad.style.display=this.S$||1===this.rJ||!this.BDd&&!this.FZa?"none":"");this.UO&&(this.UO.style.display=
this.S$||1===this.rJ?"none":"",this.updateSaveStatusText(this.ZLa),this.UO.title=CommonUIStrings.l_SaveStatusTooltip)}ySf(a,b){a=document.getElementById(rm.CuiHelper.Epj);b&&b.Txl||!a||""===this.Vya||""===this.Wya||""===this.Mya||""===this.Rya||(this.BDd=document.getElementById(rm.CuiHelper.GJd),this.mod=rm.CuiHelper.AEc(a,"BreadcrumbAppModeDash","-"),this.FZa=rm.CuiHelper.AEc(a,"BreadcrumbAppModeStatus",1===this.rJ?this.Mya:this.Rya),this.Gzh(this.FZa),this.$Ad=rm.CuiHelper.AEc(a,"BreadcrumbSaveStatusDash",
"-"),this.UO=rm.CuiHelper.AEc(a,"BreadcrumbSaveStatus",this.Vya),this.Gzh(this.UO),this.kna(this.S$,this.rJ))}jnc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.ZLa=a;this.utl(this.ZLa?this.Vya:this.Wya)}utl(a){!this.UO||3!==this.rJ&&2!==this.rJ||(this.$6e&&!this.ZLa?(this.A0a=this.UO.offsetWidth<this.A0a?this.A0a:this.UO.offsetWidth,this.rql(this.Wya),this.$6e=!1):this.UO.innerText=a)}Gzh(a){a.style.direction=this.Oi?"rtl":"ltr";a.style.width="auto";a.style.textAlign=this.Oi?"right":
"left";a.style.display=this.S$?"none":"";a.setAttribute("Unselectable","on")}rql(a){this.UO&&(this.UO.style.width="",this.UO.innerText=a,this.A0a=this.UO.offsetWidth<this.A0a?this.A0a:this.UO.offsetWidth,a=$g.a.Nu(this.UO),this.UO.style.width=this.A0a-ya.a.wL(a.paddingLeft)-ya.a.wL(a.paddingRight)+1+"px")}}Object(e.a)(rA,"SaveStatusUIHandler",null,[670]);class kF{constructor(){this.aBd=this.Szd=this.jQb=this.Ea=null}get name(){return"Common.App.SaveStatus"}Yb(a){this.Ea=a;u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&
u.AFrameworkApplication.LP?this.Ea.register(qA,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new qA(this.Ea.Oa("Common.App.HostNotification.EditNotificationEventSource"),this.Ea.Oa("Postmessage.IHostPostmessenger"))):u.AFrameworkApplication.Ba.jb.ywg||(u.AFrameworkApplication.Ba.jb.kN?this.Ea.register(pA,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new pA(this.Ea.Oa("Common.App.HostNotification.EditNotificationEventSource"))):
this.Ea.register(rA,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new rA(oc.EventHandlerManager.instance,this.Ea.Oa("Common.App.Header.HeaderEventSource"),this.Ea.Oa("Common.App.HostNotification.EditNotificationEventSource"),u.AFrameworkApplication.isRtl)))}init(){u.AFrameworkApplication.fa.gf(Object(C.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){const a=u.AFrameworkApplication.fa,b=!!u.AFrameworkApplication.Ba.jb&&4===u.AFrameworkApplication.Ba.jb.vm;
if(a.ka("WordEditorAutoSaveImprovementIsEnabled")||a.ka("PptEditorSaveStatusInHeaderEnabled")||b&&a.ka("SimplifiedReactRibbonUxIsEnabled")||a.ka("ExcelSaveStatusInHeaderEnabled")||a.ka("VisioSaveStatusInHeaderEnabled"))u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&u.AFrameworkApplication.LP?(this.aBd=this.Ea.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.aBd.VI():u.AFrameworkApplication.Ba.jb.ywg||(u.AFrameworkApplication.Ba.jb.kN?(this.Szd=this.Ea.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&
this.Szd.initialize(a.ka("IsSkyDrive"),a.Ia("HostNameToIncludeInSavedStatus"),u.AFrameworkApplication.fa):(this.jQb=this.Ea.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.jQb.initialize(a.ka("IsSkyDrive"),a.Ia("HostNameToIncludeInSavedStatus")))}dispose(){this.jQb&&this.jQb.qxa()}}Object(e.a)(kF,"PackageManager",null,[2,3]);window.PPTCampaignsObj_FromAppPackage=[{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customervoice",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2022-09-30T00:00:00Z",
GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",
Question:"nps_OneClickPromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_OneClickRating_Values_1","nps_OneClickRating_Values_2","nps_OneClickRating_Values_3","nps_OneClickRating_Values_4","nps_OneClickRating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURFhIWVJFRVVSTDRCSExHUEdXMzQ3OFoyMy4u"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",
LauncherType:"customux",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,
Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",
GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",
YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in PowerPoint Online.",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",LauncherType:"customervoice",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},
Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURDNVQ1BHVkxLUUpKTk80UDZDMk1TMFlPOC4u"}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-09-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",
YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"75fcdcee-a30b-4545-969e-1e24599c8ceb",StartTimeUtc:"2020-09-23T00:00:00Z",EndTimeUtc:"2021-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryRestoreCoauthFailed",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"VHRestore_Title",Question:"VHRestore_PromptQuestion",YesLabel:"VHRestore_Sure",NoLabel:"VHRestore_NotNow"},Rating:{Question:"VHRestore_SurveyQuestion",
RatingValuesAscending:["VHRestore_Answer_Options_1","VHRestore_Answer_Options_2","VHRestore_Answer_Options_3","VHRestore_Answer_Options_4"]},Question:{Question:"VHRestore_WhyQuestion"}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2022-08-26T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},
CooldownPeriod:{Type:0,IntervalSeconds:5184E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with PowerPoint Online?",RatingValuesAscending:["1 - Extremely dissatisfied",
"2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us why you gave this rating"}}}},{CampaignId:"278833a1-5538-4739-8fe7-9a7e23336414",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},
CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TranscriptionUsed",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on live captions & subtitles.",Question:"It will only take a few seconds.",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"How satisfied were you and your audience with the live captions or subtitles experience?",RatingValuesAscending:["1 - Not satisfied",
"nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","5 - Very satisfied"]},Question:{Question:"Please tell us what you liked or didn't like."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,
IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},
Question:{Question:"CatchUpFPS_WhyQuestion"}}}},{CampaignId:"ceef766d-7ae7-4f83-bf61-a2254bb05e45",StartTimeUtc:"2022-02-21T00:00:00Z",EndTimeUtc:"2022-08-21T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,
Sequence:[{Type:0,Activity:"PPTWebCommitNewCommentActivity",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Please tell us about your experience using the Comments feature in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the Comments feature in PowerPoint for the web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},
Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"fbff816d-e00a-4269-89eb-21ed37f0b20d",StartTimeUtc:"2020-06-08T00:00:00Z",EndTimeUtc:"2021-08-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:0,Activity:"UsageForWebAsDefaultFileOpenTeams",
IsAggregate:!0,Count:1},Content:{Prompt:{Title:"TeamsOpen_GreetingQuestion",Question:"TeamsOpen_PromptTitle",YesLabel:"TeamsOpen_GreetingAnswer_Sure",NoLabel:"TeamsOpen_GreetingAnswer_NotNow"},Rating:{Question:"TeamsOpen_RatingQuestion_PowerPoint",RatingValuesAscending:["TeamsOpen_Rating_Browser","TeamsOpen_Rating_Teams"]},Question:{Question:"TeamsOpen_PromptQuestion"}}}},{CampaignId:"e7155ff8-0e35-49c8-ab37-4e230d9548e6",StartTimeUtc:"2020-10-05T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:30,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ConvertWordToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},
Rating:{Question:"How satisfied are you with the experience of converting your document to a presentation?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"826063c4-f637-4317-9dd4-ec099224b8cd",StartTimeUtc:"2021-04-01T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AgendaToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of adding slides automatically?",
RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"f4aa2c06-b017-4702-a6db-83036ab55495",StartTimeUtc:"2021-04-23T00:00:00Z",EndTimeUtc:"2021-10-23T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,
IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitTaskActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Please tell us about your experience using Tasks in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with Tasks in PowerPoint for Web?",RatingValuesAscending:["1 - Extremely dissatisfied",
"2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"0fd1d222-ab1e-49a2-9c18-3cba5d97c7e6",StartTimeUtc:"2021-08-18T18:30:00Z",EndTimeUtc:"2025-06-30T18:30:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,
IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ModernFontPickerExperience",IsAggregate:!0,Count:4},Content:{Prompt:{Title:"FontPicker_FloodgatePromptTitle",Question:"FontPicker_FloodgatePromptQuestion",YesLabel:"FontPicker_FloodgatePromptYesLabel",NoLabel:"FontPicker_FloodgatePromptNoLabel"},Rating:{Question:"FontPicker_FloodgateRatingQuestion",RatingValuesAscending:["FontPicker_FloodgateRating1","FontPicker_FloodgateRating2","FontPicker_FloodgateRating3","FontPicker_FloodgateRating4",
"FontPicker_FloodgateRating5"]},Question:{Question:"FontPicker_FloodgateCommentQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"cs-CZ"},{Type:0,Value:"de-DE"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-ES"},{Type:0,Value:"fr-FR"},{Type:0,Value:"ja-JP"},{Type:0,Value:"nl-NL"},{Type:0,Value:"pl-PL"},{Type:0,Value:"ru-RU"}],Type:1},NominationScheme:{Type:0,
PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},
Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"ar-SA"},{Type:0,Value:"da-DK"},{Type:0,Value:"es-MX"},{Type:0,Value:"fi-FL"},
{Type:0,Value:"he-IL"},{Type:0,Value:"hr-HR"},{Type:0,Value:"it-IT"},{Type:0,Value:"ko-KR"},{Type:0,Value:"nb-NO"},{Type:0,Value:"pt-BR"},{Type:0,Value:"pt-PT"},{Type:0,Value:"sv-SE"},{Type:0,Value:"tr-TR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,
Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},
{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"af-ZA"},{Type:0,Value:"am-ET"},{Type:0,Value:"as-IN"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be-BY"},{Type:0,Value:"bg-BG"},{Type:0,Value:"bn-BD"},{Type:0,Value:"bn-IN"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"ca-ES"},{Type:0,Value:"chr-Cher-US"},{Type:0,Value:"cy-GB"},{Type:0,Value:"el-GR"},{Type:0,
Value:"et-EE"},{Type:0,Value:"eu-ES"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fil-PH"},{Type:0,Value:"fr-CA"},{Type:0,Value:"ga-IE"},{Type:0,Value:"gd-GB"},{Type:0,Value:"gl-ES"},{Type:0,Value:"gu-IN"},{Type:0,Value:"ha-Latn-NG"},{Type:0,Value:"he-IN"},{Type:0,Value:"hu-HU"},{Type:0,Value:"hy-AM"},{Type:0,Value:"id-ID"},{Type:0,Value:"ig-NG"},{Type:0,Value:"is-IS"},{Type:0,Value:"ka-GE"},{Type:0,Value:"kk-KZ"},{Type:0,Value:"km-KH"},{Type:0,Value:"kn-IN"},{Type:0,Value:"kok-IN"},{Type:0,Value:"ku-Arab-IQ"},
{Type:0,Value:"ky-KG"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lo-LA"},{Type:0,Value:"lt-LT"},{Type:0,Value:"lv-LV"},{Type:0,Value:"mi-NZ"},{Type:0,Value:"mk-MK"},{Type:0,Value:"ml-IN"},{Type:0,Value:"mn-MN"},{Type:0,Value:"mr-IN"},{Type:0,Value:"ms-MY"},{Type:0,Value:"mt-MT"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"nso-ZA"},{Type:0,Value:"mso-ZA"},{Type:0,Value:"or-IN"},{Type:0,Value:"pa-IN"},{Type:0,Value:"prs-AF"},{Type:0,Value:"ps-AF"},{Type:0,Value:"quc-Latn-GT"},{Type:0,Value:"quz-PE"},
{Type:0,Value:"ro-RO"},{Type:0,Value:"rw-RW"},{Type:0,Value:"sd-Arab-PK"},{Type:0,Value:"si-LK"},{Type:0,Value:"sk-SK"},{Type:0,Value:"sl-SL"},{Type:0,Value:"sq-AL"},{Type:0,Value:"sr-Cyrl-BA"},{Type:0,Value:"sr-Cyrl-RS"},{Type:0,Value:"sr-Latn-RS"},{Type:0,Value:"sw-KE"},{Type:0,Value:"ta-IN"},{Type:0,Value:"te-IN"},{Type:0,Value:"tg-Cyrl-TJ"},{Type:0,Value:"th-TH"},{Type:0,Value:"ti-ET"},{Type:0,Value:"tk-TM"},{Type:0,Value:"tn-ZA"},{Type:0,Value:"tt-RU"},{Type:0,Value:"ug-CN"},{Type:0,Value:"uk-UA"},
{Type:0,Value:"ur-PK"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"vi-VN"},{Type:0,Value:"wo-SN"},{Type:0,Value:"xh-ZA"},{Type:0,Value:"yo-NG"},{Type:0,Value:"zh-TW"},{Type:0,Value:"zu-ZA"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:5184E3},CooldownPeriod:{Type:0,IntervalSeconds:15552E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,
Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"c551d75c-10b1-4de2-83cc-cce22d7c06bd",
LauncherType:"coachingux",StartTimeUtc:"2021-08-15T00:00:00Z",EndTimeUtc:null,GovernedChannelType:3,Tags:["FirstRunExperienceV2"],PrimaryPriority:5,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:22,
ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowFirstRunExperienceUIV2",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{itemCount:3,surfaceType:"sequence",preFetchDelay:500,preventAutoDismiss:!0,backgroundColor:"#b7472a",buttonHoverColor:"#a92b1a",closeButtonAriaLabel:"Close",position:"left",anchorHint:5,surfaceType1:"teaching",anchorElementSelectors1:"#BreadcrumbSaveStatus #documentTitle #documentTitleContainer #WACRibbon-QATRowCenter #BreadcrumbSaveStatusDash #ResponsiveCenterRegion #AppHeaderPanel div[role='toolbar'] div[class*='cui-topBar1-transistionalHeaderUI'] #o365header #O365_NavHeader".split(" "),
title1:"Never lose your work",description1:"Your file is automatically saved online. Just click the title to rename or change the save location.",illustrationImage1:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yjj0",primaryButtonText1:"Next",delayLoad1:1E3,retryTimes1:3,retryInterval1:500,surfaceType2:"teaching",anchorElementSelectors2:["button[data-unique-id='Share']","button[aria-label='Share']"],title2:"Share and collaborate",description2:"Share your presentation so others can leave comments and feedback, even if they don't have Office themselves.",
illustrationImage2:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yrdA",primaryButtonText2:"Next",surfaceType3:"teaching",anchorElementSelectors3:["button[data-unique-id='Present']","button[aria-label='Present']"],title3:"Start presenting",description3:"When you're ready, click Present to start your slideshow.",illustrationImage3:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4ytEj",primaryButtonText3:"Got it"}}}},{CampaignId:"7f5167e4-54e6-4353-a9d7-686741f379b7",LauncherType:"coachingux",
StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinTab"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,
ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinTab",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin\u200b",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Show add-in",
primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"d7f1cbbb-3631-4cae-bc2d-177774aa1190",LauncherType:"coachingux",StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinButton"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,
Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinButton",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",
userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"cbb7eaa0-6e95-422d-9647-2be7d2737d4a",
LauncherType:"coachingux",StartTimeUtc:"2022-01-20T08:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForContentAddin"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},
SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForContentAddin",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[data-unique-id='Ribbon-InsertAppsForOffice']\", \"button[data-unique-id='Ribbon-InsertAddIns']\", \"button[data-unique-id='Overflow-RibbonOverflowMenu-overflow']\"]",
title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchContentAddin",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"974882c6-f67e-47be-9ba4-4db5c2374610",StartTimeUtc:"2022-04-01T00:00:00Z",EndTimeUtc:"2022-10-01T00:00:00Z",GovernedChannelType:0,
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultipleGuestsCoauthoring",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"GuestCoauthoring_FloodgatePromptTitle",Question:"GuestCoauthoring_FloodgatePromptQuestion",YesLabel:"GuestCoauthoring_FloodgateYesLabel",
NoLabel:"GuestCoauthoring_FloodgateNoLabel"},Rating:{Question:"GuestCoauthoring_FloodgateQuestion",RatingValuesAscending:["GuestCoauthoring_FloodgateRatingValue_1","GuestCoauthoring_FloodgateRatingValue_2","GuestCoauthoring_FloodgateRatingValue_3","GuestCoauthoring_FloodgateRatingValue_4","GuestCoauthoring_FloodgateRatingValue_5"]},Question:{Question:"GuestCoauthoring_FloodgateRatingQuestion"}}}},{CampaignId:"21c77b4d-1446-4cfe-8881-fa67502a0f14",StartTimeUtc:"2022-05-04T00:00:00Z",EndTimeUtc:"2022-11-04T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"CollabCornerSurveyLogDownloadACopyCommandActivity",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"CollabCorner_Survey_DownloadCopies_Prompt_Line_1",Question:"CollabCorner_Survey_DownloadCopies_Prompt_Line_2",YesLabel:"CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
NoLabel:"CollabCorner_Survey_DownloadCopies_Prompt_NoLabel"},Rating:{Question:"CollabCorner_Survey_DownloadCopies_Rating_Question",RatingValuesAscending:["CollabCorner_Survey_DownloadCopies_Rating_Scale_1","CollabCorner_Survey_DownloadCopies_Rating_Scale_2","CollabCorner_Survey_DownloadCopies_Rating_Scale_3","CollabCorner_Survey_DownloadCopies_Rating_Scale_4","CollabCorner_Survey_DownloadCopies_Rating_Scale_5"]},Question:{Question:"CollabCorner_Survey_DownloadCopies_Comment_Question"}}}},{CampaignId:"c35fd8df-7970-4a17-b57d-1bd9ad373550",
StartTimeUtc:"2022-05-04T00:00:00Z",EndTimeUtc:"2022-08-04T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"CollabCornerSurveyLogSharingCommandActivity",IsAggregate:!0,Count:2},Content:{Prompt:{Title:"CollabCorner_Survey_SharingComplexity_Prompt_Line_1",Question:"CollabCorner_Survey_SharingComplexity_Prompt_Line_2",
YesLabel:"CollabCorner_Survey_SharingComplexity_Prompt_YesLabel",NoLabel:"CollabCorner_Survey_SharingComplexity_Prompt_NoLabel"},Rating:{Question:"CollabCorner_Survey_SharingComplexity_Rating_Question",RatingValuesAscending:["CollabCorner_Survey_SharingComplexity_Rating_Scale_1","CollabCorner_Survey_SharingComplexity_Rating_Scale_2"]},Question:{Question:"CollabCorner_Survey_SharingComplexity_Comment_Question"}}}},{CampaignId:"bf20f28c-af0a-4d43-a87b-239b0419c65f",StartTimeUtc:"2022-09-01T00:00:00Z",
EndTimeUtc:"2022-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SimplicityEaseOfUseSurvey",IsAggregate:!0,Count:360},{Type:0,Activity:"SimplicityEaseOfUseSurveyTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"EaseOfUse_Floodgate_Prompt_Line1",
Question:"EaseOfUse_Floodgate_Prompt_Line2",YesLabel:"EaseOfUse_Floodgate_Prompt_Affirmative_Answer",NoLabel:"EaseOfUse_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"EaseOfUse_Floodgate_Rating_Question",RatingValuesAscending:["EaseOfUse_Floodgate_Rating_Scale_1","EaseOfUse_Floodgate_Rating_Scale_2","EaseOfUse_Floodgate_Rating_Scale_3","EaseOfUse_Floodgate_Rating_Scale_4","EaseOfUse_Floodgate_Rating_Scale_5"]},Question:{Question:"EaseOfUse_Floodgate_Comment_Question"}}}},{CampaignId:"6e859e5f-99be-48cd-9a9a-da52d6ff7203",
StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2022-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleEnabledFPS",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Fluent2Survey_Title",Question:"Fluent2Survey_Question",YesLabel:"Fluent2Survey_YesLabel",
NoLabel:"Fluent2Survey_NoLabel"},Rating:{Question:"Fluent2Survey_RatingQuestion",RatingValuesAscending:["Fluent2Survey_RatingValue_1","Fluent2Survey_RatingValue_2","Fluent2Survey_RatingValue_3","Fluent2Survey_RatingValue_4","Fluent2Survey_RatingValue_5"]},Question:{Question:"Fluent2Survey_WhyQuestion"}}}},{CampaignId:"e9434f43-d475-4b79-8213-88636e007433",StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2022-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleOptOutFPS",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"Fluent2OptOutSurvey_Title",Question:"Fluent2OptOutSurvey_Question",YesLabel:"Fluent2OptOutSurvey_YesLabel",NoLabel:"Fluent2OptOutSurvey_NoLabel"},Rating:{Question:"Fluent2OptOutSurvey_RatingQuestion",RatingValuesAscending:["Fluent2OptOutSurvey_RatingValue_1",
"Fluent2OptOutSurvey_RatingValue_2"]},Question:{Question:"Fluent2OptOutSurvey_WhyQuestion"}}}},{CampaignId:"26b1466b-2ac8-4d6f-8ee0-cd06c7594ce5",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"AddPenStrokePPTO",
IsAggregate:!0,Count:10},Content:{Prompt:{Title:"PenInkSurvey_Prompt",Question:"PenInkSurvey_PromptQuestion",YesLabel:"PenInkSurvey_Prompt_Sure",NoLabel:"PenInkSurvey_Prompt_NoNow"},Rating:{Question:"PenInkSurvey_RatingQuestion",RatingValuesAscending:["PenInkSurvey_QuestionChoice_5","PenInkSurvey_QuestionChoice_4","PenInkSurvey_QuestionChoice_3","PenInkSurvey_QuestionChoice_2","PenInkSurvey_QuestionChoice_1"]},Question:{Question:"PenInkSurvey_WhyQuestion"}}}}];var TO=d(653);class lF{G5f(){return null}jXi(){return md.c(window.PPTCampaignsObj_FromAppPackage)}E1d(a){return TO.a.E1d(a,
"PPTUserInitiatedSurveysDictionary_FromAppPackage")}}Object(e.a)(lF,"PowerPointFeedbackAppData",null,[555]);class sA{constructor(){this.Ea=null}Yb(a){this.Ea=a;a.register(555,"Common.App.IAppSpecificFeedbackData").ma().na(()=>new lF)}init(){this.Ea.qb("Common.App.IAppSpecificFeedbackData")}dispose(){}get name(){return"PPTWebEditor.Feedback"}static main(){m.a.instance.Ec(new sA)}}Object(e.a)(sA,"PPTWebEditorFeedbackPackage",null,[2,3]);class tA{get name(){return"Box4.ListEditors"}Yb(){}init(){}dispose(){}static main(){m.a.instance.Ec(new tA)}}
Object(e.a)(tA,"Box4ListEditorsPackage",null,[2,3]);var lj=d(150),ol=d(124);const uA=a=>{a=document.createElement(a);a.setAttribute("unselectable","on");return a};class mF{constructor(a){this.vEd=this.Wsd=!1;this.dKa=null;this.PWe=!1;this.l5=null;this.R$=!1;this.JRh=a;ia.a.instance.pb(ra.a.mouseDown,this.b_b(),Object(C.a)(this,this.igk,"onContextualUIMouseDown"));(a=lb.a.instance.Oa("Common.IActionContextProvider"))&&a.execute(b=>{this.l5=b});u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
u.AFrameworkApplication.Ba.jb.kN?Oc.a.get_instance().Ak(16,()=>{this.eg?this.initializeContextualUI(this.b_b()):Oc.a.get_instance().Ak(7,()=>{this.initializeContextualUI(this.b_b())})}):Oc.a.get_instance().Ak(7,()=>{this.initializeContextualUI(this.b_b())})}get kub(){return this.R$}get eg(){return u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&u.AFrameworkApplication.Ba.jb.kN?Oc.a.get_instance().isCompleted(16)&&Oc.a.get_instance().isCompleted(7):Oc.a.get_instance().isCompleted(7)}hhi(){if(this.PWe)return!0;
try{return Promise.resolve(null),this.PWe=!0}catch(a){return!1}}zRe(a){if(!this.eg||this.vEd)return this.tce("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.hhi())return this.tce("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(u.AFrameworkApplication.QGc)return this.tce("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.vEd=!0;let b=G.a.ze;switch(a){case 1:b=G.a.showContextMenu;break;case 0:b=
G.a.showFloatie;break;case 2:b=G.a.ghd}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.vEd=!1;qf.c(b)},0)});return!1}Peg(a){return lj.UISurfaces.HBa().then(b=>{if(appChrome.api.isSmallDevice()&&b.getBlockedSmallScreenFloatieGroupList){b=b.getBlockedSmallScreenFloatieGroupList();const c=[];for(const f of a)Array.contains(b,f)||c.push(f);return c}return a})}showFloatie(a,b,c,f=null){this.zRe(0)||this.Peg(b).then(l=>{if(0>=l.length)return null;this.mJe(l).then(()=>{const w={};w.target=
a;lj.UISurfaces.HBa().then(F=>{appChrome.api.dispatch(F.showFloatie(w,c,void 0,this.VZd(),f));this.R$=!0;return null})});return null})}showContextMenu(a,b,c=null,f=null){this.zRe(1)||this.toh(a,b,c,f)}toh(a,b,c=null,f=null){this.mJe(null).then(()=>{const l={};l.target=a;f&&(l.directionalHint=f);lj.UISurfaces.HBa().then(w=>{appChrome.api.dispatch(w.showContextMenu(l,b,c,void 0,this.VZd()));return null})})}xwa(a,b,c){this.zRe(2)||this.Peg(b).then(f=>{0>=f.length?this.toh(a,c,null):this.mJe(f).then(()=>
{const l={};l.target=a;const w={};w.target=a;lj.UISurfaces.HBa().then(F=>{appChrome.api.dispatch(F.showContextualUI(l,w,c,void 0,null,this.VZd()));this.R$=!0;return null})});return null})}tce(a){Z.ULS.sendTraceTag(561394519,340,15,a)}qRd(){this.eg&&lj.UISurfaces.isLoaded()&&lj.UISurfaces.HBa().then(a=>{appChrome.api.dispatch(a.hideContextMenu());return null})}NM(){this.eg&&lj.UISurfaces.isLoaded()&&lj.UISurfaces.HBa().then(a=>{this.R$=!1;appChrome.api.dispatch(a.hideFloatie());return null})}kXb(){this.eg&&
lj.UISurfaces.isLoaded()&&lj.UISurfaces.HBa().then(a=>{appChrome.api.dispatch(a.hideContextualUI());this.R$=!1;return null})}initializeContextualUI(a){return lj.UISurfaces.HBa().then(b=>{this.Wsd||(b.initializeContextualUI(a),this.Wsd=!0);return null})}mJe(a){if(!this.Wsd)return this.initializeContextualUI(this.b_b()).then(()=>{this.setActiveFloatieGroups(a);return null});this.setActiveFloatieGroups(a);return Promise.resolve(null)}setActiveFloatieGroups(a){if(a&&a.length){var b=[];b.push(appChrome.actions.setActiveFloatieGroups(a));
appChrome.api.dispatch(b);var c=[];lj.UISurfaces.HBa().then(f=>{c.push.apply(c,this.JRh.PDb.BNc(f.selectors.getFloatieOnlyControlsMap(),9));0<c.length&&appChrome.api.dispatch(c);return null})}}b_b(){if(this.dKa)return this.dKa;this.dKa=uA("div");this.dKa.id="ReactContextualUIDiv";this.dKa.style.position="absolute";this.dKa.style.zIndex="1001";document.body.insertBefore(this.dKa,document.body.firstChild);return this.dKa}igk(a){a.nc&&a.nc.target&&"input"===a.nc.target.tagName.toLowerCase()&&v.FocusManager.instance().pC("ribbon");
return!1}VZd(){return this.l5?this.l5.contentType:"Unknown"}}Object(e.a)(mF,"ReactContextualUILauncher",null,[550]);var $i=d(133);class vA{constructor(a){this.UPb=a}create(a,b){const c=new Sys.StringBuilder;this.jWb(c,a,b);this.FOd(c,a);return c.toString()}Xt(a,b){const c=[];this.jPd(c,a,b);this.GOd(c,a);return c}jWb(a,b,c){switch(b.errorType){case 0:a.append(this.UPb.build());break;case 1:case 2:a.append(this.NJd(b,c))}}jPd(a,b,c){switch(b.errorType){case 0:a.push(this.UPb.kIf());break;case 1:case 2:a.push(this.lci(b,
c))}}FOd(a,b){I.a.instance.ga(92)||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append($i.a("btnIgrnoreSpellingError",(2===b.errorType?D.a.lld:D.a.Mra).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null)),a.append("</Controls></MenuSection>"))}GOd(a,b){if(!I.a.instance.ga(92)){var c=Object.assign(new nk.a,{ControlList:[]});b=2===b.errorType?"UnknownSpellingError":"IgnoreSpellingError";Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:b}));
a.push(c)}}NJd(a,b){a=this.PUi(a.suggestions,b);return 0<a.length?$i.e("msUnknownWord",$i.c(null,a),"Menu16"):$i.e("msUnknownWord",$i.c(null,[$i.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}PUi(a,b){const c=[];if(a){const f=Math.min(b.length,a.length);for(let l=0;l<f;++l)a[l]&&c.push($i.a("btnCorrectWord"+l,b[l].toString(),a[l]))}return c}lci(a,b){const c=Object.assign(new nk.a,{Id:"Suggestions",ControlList:[]});this.OUi(a.suggestions,b,c.ControlList);0>=
c.ControlList.length&&(a=Object.assign(new Of.a,{ExternalId:"NoSuggestions"}),Array.add(c.ControlList,a));return c}OUi(a,b,c){if(a){const f=Math.min(b.length,a.length);for(let l=0;l<f;++l){if(!a[l])continue;const w=Object.assign(new Of.a,{ExternalId:"btnCorrectWord"+l,Command:b[l].toString(),LabelText:a[l]});Array.add(c,w)}}}}Object(e.a)(vA,"DefaultProofingContextMenuCreator",null,[]);class wA{constructor(a,b){this.OYe=a;this.d0e=b;this.kMa=[D.a.Vwa,D.a.Wwa,D.a.Xwa,D.a.MIa,D.a.NIa]}create(a,b){return b?
Object(Ca.a)($l.a,b)?this.d0e.create(a,b,this.kMa):this.OYe.create(b,this.kMa):""}eWb(a,b){return b?Object(Ca.a)($l.a,b)?this.d0e.Xt(a,b,this.kMa):this.OYe.Xt(b,this.kMa):null}}Object(e.a)(wA,"ProofingContextMenuSectionFactory",null,[821]);class nF{build(){const a=[$i.a("btnDeleteRepeatedWord","2023591105",Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return $i.e("msRepeatedWord",$i.c(null,a),"Menu16")}kIf(){const a=Object.assign(new nk.a,{ControlList:[]}),b=Object.assign(new Of.a,{ExternalId:"DeleteRepeatedWord"});
Array.add(a.ControlList,b);return a}}Object(e.a)(nF,"ProofingRepeatedWordSectionBuilder",null,[820]);var xA=d(1076);class Wu{constructor(a,b){this.c_a=a;this.Sm=b}get isVisible(){return this.c_a.kub}get controls(){return null}NM(){this.c_a.NM();return!0}Foh(a,b){this.c_a.showFloatie(Object.assign(new xA.a,{x:a.x,y:a.y}),this.dKc(b),b,null)}sqa(){return this.NM()}dKc(){return[]}}Object(e.a)(Wu,"ReactFloatie",null,[286,287]);class oF{constructor(a){this.Ypc=null;this.c_a=a}dispose(){}sqa(){this.c_a.kXb();
return!0}showContextMenu(a,b){this.J4(a,b.clientPoint,b.Qf)}J4(a,b,c){this.fhd(a,new Sys.UI.Bounds(b.x,b.y,0,0),c);Z.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",a)}fhd(a,b,c,f=null){this.Ypc?this.c_a.xwa(Object.assign(new xA.a,{x:b.x,y:b.y}),this.Ypc.dKc(c),c):this.c_a.showContextMenu(Object.assign(new xA.a,{x:b.x,y:b.y}),c,void 0,f);this.Ypc=null}ghd(a,b,c,f){this.Ypc=Object(ua.a)(Wu,c);f.Y9(a,b);return!0}}Object(e.a)(oF,"ReactContextMenuController",null,[551,109]);
var Br=d(429);class ly{static get Wf(){return Th.a.tA(ly.Ym,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}ly.Ym="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> </table> </div>";
Object(e.a)(ly,"AutoCorrectOptionsDialogHTML",null,[]);class my{static get Wf(){return Th.a.tA(my.Ym,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}my.Ym="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceQuoteWithSmartQuote' >{8}</label> </td> </tr> </table> </div>";
Object(e.a)(my,"AutoCorrectOptionsDialogHTML2",null,[]);class pF extends Th.a{constructor(a,b){super();this.XQ=a;this.l1=b;this.kg="AutoCorrectOptionsDialog"}skc(){Z.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Wf=this.l1?my.Wf:ly.Wf;const a={};a.ReplaceTextAsYouType=this.XQ.keb;a.CapitalizeFirstLetterOfSentences=this.XQ.jCc;a.ReplaceOrdianalsWithSuperscript=this.XQ.Tcd;a.ReplaceHyphensWithDash=this.XQ.Qhc;a.ReplaceFractionsWithFractionCharacter=this.XQ.Rcd;this.l1&&
(a.ReplaceQuoteWithSmartQuote=this.XQ.ZDe);this.qj(Box4Intl.Box4Strings.l_AutoCorrectOptions,Object(C.a)(this,this.eZk,"setAutoCorrectOptionsHandler"),a)}eZk(a,b){I.a.instance.ga(70)&&(1!==a?Z.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):b.ReplaceTextAsYouType!==this.XQ.keb||b.CapitalizeFirstLetterOfSentences!==this.XQ.jCc||b.ReplaceOrdianalsWithSuperscript!==this.XQ.Tcd||b.ReplaceHyphensWithDash!==this.XQ.Qhc||b.ReplaceFractionsWithFractionCharacter!==
this.XQ.Rcd||this.l1&&b.ReplaceQuoteWithSmartQuote!==this.XQ.ZDe?(a={},a.ReplaceTextAsYouType=b.ReplaceTextAsYouType,a.CapitalizeFirstLetterOfSentences=b.CapitalizeFirstLetterOfSentences,a.ReplaceOrdianalsWithSuperscript=b.ReplaceOrdianalsWithSuperscript,a.ReplaceHyphensWithDash=b.ReplaceHyphensWithDash,a.ReplaceFractionsWithFractionCharacter=b.ReplaceFractionsWithFractionCharacter,this.l1&&(a.ReplaceQuoteWithSmartQuote=b.ReplaceQuoteWithSmartQuote),this.XQ.PUk(a),Z.ULS.sendTraceTag(24523524,324,
50,"User close the option dialog and trigger to save the setting: {0}"+{["ReplaceTextAsYouType"]:b.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:b.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:b.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:b.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:b.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.l1,["ReplaceQuoteWithSmartQuote"]:this.l1&&b.ReplaceQuoteWithSmartQuote}),
gb.App.Fb.updateCommandUI(!0)):Z.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes."))}}Object(e.a)(pF,"AutoCorrectOptionsDialog",Th.a,[554]);class ny{static get Wf(){return Th.a.tA(ny.Ym,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}ny.Ym="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(e.a)(ny,"AltTextDialogWithDescriptionHtml",null,[]);class jq extends Th.a{constructor(a=!1){super(!1,!1,a);this.Wf=ny.Wf;this.kg=a?"AltTextDialog":"BaseAltTextDialogWithDescription"}Wti(a){this.qj(CommonUIStrings.l_AlternativeTextDialogTitle,Object(C.a)(this,this.eHd,"altTextDialogHandler"),this.cLc(a));a=document.getElementById(jq.gHd);a.focus();a.select()}Xti(a){a={["id"]:"AltTextDialog",["bodyControls"]:this.cLc(a)};this.qj(CommonUIStrings.l_AlternativeTextDialogTitle,Object(C.a)(this,this.eHd,
"altTextDialogHandler"),a)}cLc(a){const b={};b[jq.gHd]=this.A5f(a);b[jq.dHd]=this.W7f(a)||"";return b}MM(a){return a.Hc.id===jq.dHd?!1:super.MM(a)}}jq.gHd="titleText";jq.dHd="descriptionText";Object(e.a)(jq,"BaseAltTextDialogWithDescription",Th.a,[]);class yt extends jq{constructor(a,b=!1){super(b);this.kg=yt.nrj;b&&u.AFrameworkApplication.fa.ka("ReactAltTextDialogIsEnabled")?this.Xti(a):this.Wti(a)}}yt.nrj="AAltTextDialogWithDescription";Object(e.a)(yt,"AAltTextDialogWithDescription",jq,[]);class qF extends yt{constructor(a,
b,c,f,l){super(a);this.Rlb=this.XKb=null;this.NC=b;this.ifa=c;this.kk=f;this.Yc=l}W7f(a){this.XKb=a.node;this.Rlb=Cd.TableReader.Idg(a);return Cd.TableReader.d1d(this.Rlb)}A5f(a){this.XKb=a.node;this.Rlb=Cd.TableReader.Idg(a);return Cd.TableReader.e1d(this.Rlb)}eHd(a){if(1===a){Cd.TableReader.e1d(this.Rlb);Cd.TableReader.d1d(this.Rlb);this.hide();a=this.kk.ie(15);try{a.hd(this.XKb)}finally{a&&a.dispose()}}I.a.instance.ga(50)&&this.ifa.Nv&&this.ifa.JX.fpa(this.XKb)}}Object(e.a)(qF,"TableAltTextDialog",
yt,[]);class yA{constructor(a,b,c){this.NC=a;this.kk=b;this.Yc=c}create(a){return new qF(a,this.NC,gb.App.Hh,this.kk,this.Yc)}}Object(e.a)(yA,"TableAltTextDialogFactory",null,[]);const UO=()=>{gb.App.z6h=!0;return 32},VO=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,Ru:b}=rF(l)).returnValue)return 16;gb.App.Fb.xwa(a,b);return 32},WO=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,Ru:b}=rF(l)).returnValue)return 16;gb.App.Fb.K4(a,b);return 32},rF=a=>{let b,c;b=null;c=0;if(!a)return{returnValue:!1,
point:b,Ru:c};a=a.split(",");if(3>a.length)return{returnValue:!1,point:b,Ru:c};b=new Sys.UI.Point(parseInt(a[0]),parseInt(a[1]));c=parseInt(a[2]);return{returnValue:!0,point:b,Ru:c}};var XO=d(1077);class sF extends Sys.EventArgs{constructor(a,b,c,f,l,w=0,F=0,S=null){super();this.controlId=a;this.commandId=f;this.time=l;this.commandSurface=w;this.Ru=F;this.contentType=S}}Object(e.a)(sF,"CommandClickEventArgs",Sys.EventArgs,[]);class tF{constructor(a,b){this.P$=a.CZi();this.cLb=a;this.KJa=b}R_f(a,b,
c,f=null,l=null){c&&(this.KJa.$p=c.CommandLocation,this.KJa.pS=c.InvocationMethod,this.KJa.Spa=c.CommandTabName);let w=this.cLb.B8f(parseInt(a),b,c);w.nF&&(w=this.cLb.B8f(w.Cm,b,c));if(void 0!==w.gK&&null!==w.gK)return w.gK;if(w.G3d)l=32;else{var F=null;this.P$&&this.P$.Mye&&(F=this.P$.Mye(w,l));w.MV||w.Y9d?w.Aq?l=16:(l=this.KJa.Ma(w.Cm,w.X9d?2:1,w.od,l),2===l&&(l=32)):w.Aq?l=this.KJa.M$c(null,w.Cm,w.od,S=>{f&&f(S.response)},l):(l=this.KJa.Ma(w.Cm,2,w.od,l),f&&f(l));this.P$&&this.P$.lye&&this.P$.lye(w,
l,F);if(b&&c&&-1!==c.InvocationMethod&&0!==c.InvocationMethod){c=b.LegacyId;if(void 0===c||null===c)c="";F=b.ParentMenuId;void 0!==F&&null!==F||!b.MenuId||(F=b.MenuId);let S=b.SqmControlId;void 0!==S&&null!==S||!b.SourceControlId||(S=b.SourceControlId);(void 0!==S&&null!==S||void 0!==F&&null!==F)&&XO.a.NBk(new sF(S,c,F,a,Date.now()))}}w.MV&&32===l&&this.P$&&this.P$.dTb&&this.P$.dTb(w,b);w.Y9d&&32===l&&this.P$&&this.P$.UHd&&this.P$.UHd(w,b);return 32===l||1===l}k4b(a,b=null){if(u.AFrameworkApplication.Xg||
Im.a.instance.Ov)return!1;const c=parseInt(a);b&&b.UILocation&&(this.KJa.$p=b.UILocation);if(!a||c===Le.ActionManager.VXb)return!0;a=this.cLb.oLc(c,b);a.nF&&(a=this.cLb.oLc(a.Cm,b));if(void 0!==a.gK&&null!==a.gK)return a.gK;c===G.a.w2a&&b&&(a.od=b);return 32===this.KJa.Ma(a.Cm,1,a.od)}clearCache(){this.cLb.clearCache()}}Object(e.a)(tF,"GeneralCuiUser",null,[552,607]);class uF{constructor(a,b,c,f){this.Cwf=a;this.kga=b;this.Loc=c;this.l0a=f}mcg(){let a;a=this.l0a.o8i(this.Cwf);return{returnValue:this.l0a.WLc(this.Cwf),
C6g:a}}Pkh(a,b){if(this.kga){var c=new H.DictionaryPropertySet;this.Loc.execute(f=>{f.eYb(a)});c.setValue(ob.a.Cs,a);c.setValue(I.a.instance.ga(20)?Sb.a.noProof:Kd.a.Mua,b);b=new Oe.GraphTransaction(15);b.set(gb.App.tO.$T);this.kga.KT(c);b.dispose()}}}Object(e.a)(uF,"LanguageEditor",null,[553]);var Di=d(213);class Pq{constructor(a=!1,b=0){this.eod=null;this.Rvd=Pq.adg(qa.a.EZi());this.stc=new wr.a;this.Aoa=[];this.Zkb=new pa.a;this.uqf=a;this.vqf=0>=b?7:b;this.tqf=this.$zd=0;this.w3e=!1;a&&(this.$vj(),
u.AFrameworkApplication.Aea(()=>{this.gVj()}))}get languages(){return this.Rvd}$vj(){for(var a of this.Rvd)this.stc.$(a.LCID,a);a=[];try{var b=Di.a.get("RecentlyUsedLcids");if(b&&""!==b){const f=decodeURIComponent(b).split(",").slice(0,this.vqf);for(const l of f){let w;({value:w}=this.stc.Nf(parseInt(l))).returnValue&&a.push(w)}}}catch(f){Z.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",f.message),Array.clear(a)}if(a.length)for(var c of a)b=
c.LCID,this.Zkb.contains(b)||(this.Aoa.push(c),this.Zkb.add(b));else c=u.AFrameworkApplication.lcid,({value:b}=this.stc.Nf(c)).returnValue&&(this.Aoa.push(b),this.Zkb.add(c));this.Fgh()}Fgh(){const a=Ya.toArray(Ya.select(Ya.asEnumerable(this.Aoa),b=>b.LCID)).join(",");Di.a.LL("RecentlyUsedLcids",a,180)}Rtk(a,b){if(a&&!(0<a.options.length)){var c=-1,f=Pq.adg(this.Aoa);this.uqf&&0<f.length&&(c=Pq.fIf(f),c=Pq.PAf(a,c,b),a.add(Pq.qci(),null));this.eod||(this.eod=Pq.fIf(this.Rvd));b=Pq.PAf(a,this.eod,
b);-1===c&&(c=b);a.selectedIndex=c}}u0k(a,b){if(this.uqf&&({value:c}=this.stc.Nf(a)).returnValue){b=a!==b;if(this.Zkb.contains(a))a=Array.indexOf(this.Aoa,c),0<=a&&(Array.removeAt(this.Aoa,a),this.Aoa.push(c)),b&&this.$zd++;else{this.Zkb.add(a);this.Aoa.push(c);if(this.Aoa.length>this.vqf){var c=this.Aoa.shift();this.Zkb.remove(c.LCID)}b&&this.tqf++}this.Fgh()}}gVj(){const a=this.$zd+this.tqf;!this.w3e&&0<a&&(Z.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.$zd/
a),this.w3e=!0)}static fIf(a){return Ya.toArray(Ya.select(Ya.asEnumerable(a),b=>{const c=document.createElement("OPTION");let f=b.displayName;c.value=b.LCID.toString();c.text=f;return c}))}static qci(){const a=document.createElement("OPTION");a.text="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500";
a.value="-1";a.disabled=!0;return a}static PAf(a,b,c){c=c.toString();let f=-1;for(const l of b)a.add(l,null),l.value===c&&(f=a.options.length-1);return f}static adg(a){a=Array.clone(a);a.sort((b,c)=>b.displayName.localeCompare(c.displayName));return a}}Object(e.a)(Pq,"LanguageListHelper",null,[606]);var zA=d(270);class zt extends zA.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(e.a)(zt,"NumberButtonProps",zA.a,[]);class Cr{static get Pcl(){return Cr.Xuf||(Cr.Xuf=
lb.a.instance.qb("Box4.ISpacingCommands"))}static get ynh(){return!!Cr.Pcl}static wb(){const a=u.AFrameworkApplication.Va;a.ya(D.a.YGa,Db.a.view,Cr.YGa);a.$d(D.a.YGa,1126)}static YGa(a,b,c,f,l){if(1===c||!Cr.ynh)return Cr.ynh?32:8;if(u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.Ip)a=[],a.push(Object.assign(new zt,{ExternalId:"LineSpacing1_00",Number:1,Type:0})),a.push(Object.assign(new zt,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0})),a.push(Object.assign(new zt,{ExternalId:"LineSpacing1_50",
Number:1.5,Type:0})),a.push(Object.assign(new zt,{ExternalId:"LineSpacing2_00",Number:2,Type:0})),a.push(Object.assign(new zt,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0})),a.push(Object.assign(new zt,{ExternalId:"LineSpacing3_00",Number:3,Type:0})),l.MenuItems=$i.d(a);else{a=$i.g("buttonLineSpacing1_00","1.00","2759860553","4080183461",1,0);b=$i.g("buttonLineSpacing1_15","1.15","2759860553","4080183461",1.15,0);c=$i.g("buttonLineSpacing1_50","1.50","2759860553","4080183461",1.5,0);f=$i.g("buttonLineSpacing2_00",
"2.00","2759860553","4080183461",2,0);const w=$i.g("buttonLineSpacing2_50","2.50","2759860553","4080183461",2.5,0),F=$i.g("buttonLineSpacing3_00","3.00","2759860553","4080183461",3,0),S=$i.a("buttonParagraphDialog","2465215107",Box4Intl.Box4Strings.L_LineSpacingOptions);a=$i.c("LineSpacing.Menu.Controls",[a,b,c,f,w,F,S]);a=$i.e("msLineSpacing",a,"Menu");a=$i.f([a]);l.PopulationXML=a}return 32}}Cr.Xuf=null;Object(e.a)(Cr,"LineSpacingRibbonMenu",null,[]);var YO=d(1075),ZO=d(904);const $O=(a,b,c)=>{if(1===
c)return 32;a=gb.App.Fb.notificationBar.NNa("Automation test",!1);a.image=3;gb.App.Fb.notificationBar.ai(a);return 32},bP=(a,b,c,f,l)=>{let w;if(!({HBh:w}=aP(l)).returnValue)return 16;lj.UISurfaces.pV().then(F=>{let S=null;var fa=Object.assign(new YO.a,{label:"OK",onExecute:()=>{S&&F.removeNotification(S)}});fa=Object.assign(new ZO.a,{target:"#"+E.AppFrame.afh,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:fa,useTeachingStyles:w});fa=F.callout(fa);S=F.addNotification(fa);
return null},F=>{Z.ULS.sendTraceTag(541172639,383,15,"Failed to GetNotificationsAPIAsync: {0}",F);return null});return 32},aP=a=>{let b;b=!1;if(!a)return{returnValue:!1,HBh:b};b=Boolean.parse(a);return{returnValue:!0,HBh:b}};class AA{constructor(a){this.hH=a}TIb(a){this.hH&&this.hH.GF(a)}}Object(e.a)(AA,"RibbonButtonUpdater",null,[603]);var vF=d(291);class BA{constructor(){this.x5=this.Ea=null}get name(){return"Box4.UI"}Yb(a){this.Ea=a;a.register(550,"Common.IReactContextualUILauncher").ma().na(()=>
new mF(a.resolve("CommandUI.ReactRibbonRoot"),a.resolve("Common.IExternalUICommandDefinitionMapping")));a.register(551,"Box4.IContextMenuController").ma().na(()=>new oF(a.resolve("Common.IReactContextualUILauncher")));a.register(552,"Box4.IGeneralCuiUser").na(()=>new tF(a.resolve("Box4.UI.CuiActionBridge"),u.AFrameworkApplication.Va)).ma();a.register(yA,"Box4.UI.TableAltTextDialogFactory").ma().na(()=>new yA(a.resolve("Box4.ITableEditor"),new vF.a,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(553,"Box4.UI.ILanguageEditor").na(()=>new uF(dd.a.instance.Dj,a.qb("Box4.ITextFormattingCommands"),a.Oa("Box4.IAutoCorrectRules"),a.resolve("Box4.ILanguageReader")));a.register(554,"Box4.UI.IAutoCorrectOptionsDialog").na(()=>new pF(a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(Pq,"Box4.UI.LanguageListHelper").as("Box4.UI.ILanguageListHelper").ma().na(()=>new Pq(u.AFrameworkApplication.fa.ka("RecentlyUsedLanguagesListIsEnabled")));
a.register(nF,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ma();a.register(vA,"Box4.UI.DefaultProofingContextMenuCreator").ma().na(()=>new vA(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder")));a.register(wA,"Box4.UI.ProofingContextMenuSectionFactory").as("Box4.UI.IProofingContextMenuSectionFactory").ma().na(()=>new wA(a.resolve("Box4.UI.DefaultProofingContextMenuCreator"),a.resolve("Box4.UI.EditorServiceProofingContextMenuCreator")));a.register(AA,
"Box4.RibbonButtonUpdater").as("Common.IRibbonButtonUpdater").ma().na(()=>new AA(this.Ea.resolve("Box4.IAppFrame")))}init(){var a=gb.App.Fb;const b=a.jb;Ar.puj(Object(C.a)(b,b.wcc,"onAuthenticationLost"),Object(C.a)(b,b.xcc,"onAuthenticationRestored"),a.thi);Br.a.wb();a=u.AFrameworkApplication.Va;a.ya(D.a.vxk,Db.a.application,UO);a.ra(D.a.w9k,Db.a.application,VO,96);a.ra(D.a.X9k,Db.a.application,WO,96);a=u.AFrameworkApplication.Va;a.ra(D.a.Kal,Db.a.application,$O,96);a.ra(D.a.m9k,Db.a.application,
bP,96);Cr.wb();this.x5=this.Ea.qb("Box4.IContextMenuController")}dispose(){this.x5&&(this.x5.dispose(),this.x5=null)}static main(){m.a.instance.Ec(new BA,6)}}Object(e.a)(BA,"Box4UIPackage",null,[2,3]);var wF=d(452),cP=d(856),ws=d(199),dP=d(532),Xu=d(362),en=d(308),Vi=d(71);class xF{constructor(a){this.tla=a}}Object(e.a)(xF,"ValidParentData",null,[]);var oy=d(356),eP=d(791),Yu=d(288),yF=d(790),Zu=d(592),sm=d(240),zF=d(342),kq=d(219);class AF{constructor(){this.Jpb=0}}Object(e.a)(AF,"BelowOutlineElementData",
null,[]);var xs=d(407),fP=d(580),gP=d(472);class BF extends xs.a{constructor(a,b,c,f){super(4,f);this.MIh=a;this.qnd=b;this.Lod=c}get YFc(){return this.MIh}get SRb(){return this.qnd}get iJd(){return this.Lod}Hsb(){var a=this.YFc;if(!a)return Z.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const b=[],c=new fP.a(this.YFc.id,this.YFc.Ln,this.SRb?this.SRb.id:null);""!==a.characterData&&a.characterData&&(a=new gP.DeleteTextUpdateHint(this.YFc.id,
0,a.characterData),Array.add(b,a));Array.add(b,c);return b}}Object(e.a)(BF,"DeleteParagraphOperation",xs.a,[]);var hP=d(579),iP=d(471);class CA extends xs.a{constructor(a,b,c,f,l){super(3,l);this.eyd=a;this.fyd=b;this.NOb=f}get wGa(){return this.eyd}get FBb(){return this.fyd}get nGa(){return this.NOb}Hsb(){const a=[];var b=new hP.AddParagraphUpdateHint(this.nGa.id,this.nGa.Ln,this.wGa?this.wGa.id:null);Array.add(a,b);""!==this.nGa.characterData&&this.nGa.characterData&&(b=new iP.a(this.nGa.id,0,this.nGa.characterData),
Array.add(a,b));return a}}Object(e.a)(CA,"InsertNewParagraphOperation",xs.a,[]);var jP=d(578);class CF extends xs.a{constructor(a,b,c,f){super(2,f);this.eyd=a;this.fyd=b;this.aPh=c}get wGa(){return this.eyd}get FBb(){return this.fyd}get RRg(){return this.aPh}Hsb(){const a=[],b=new jP.MergeParagraphUpdateHint(this.wGa.id,this.wGa.Ln,this.wGa.characterData.length,this.FBb.id,this.FBb.Ln,this.RRg.id,this.RRg.Ln);Array.add(a,b);return a}}Object(e.a)(CF,"MergeParagraphOperation",xs.a,[]);var kP=d(577);
class DF extends xs.a{constructor(a,b,c,f,l){super(1,l);this.hyd=a;this.pUh=b;this.qnd=c;this.Lod=f}get xGa(){return this.hyd}get SRb(){return this.qnd}get iJd(){return this.Lod}get odl(){return this.pUh}Hsb(){const a=[],b=new kP.a(this.xGa.id,this.xGa.Ln,this.odl,this.SRb.id,this.SRb.Ln,this.iJd.id,this.iJd.Ln);Array.add(a,b);return a}}Object(e.a)(DF,"SplitParagraphOperation",xs.a,[]);var EF=d(311);class Sj{constructor(a,b,c,f,l,w=null){this.Go=this.Yc=null;this.ix=a;this.Eo=b;this.Pg=c;this.lIh=
f;this.YOh=l;this.Yna=w}oXh(a){I.a.instance.ga(50)&&gb.App.Hh&&gb.App.Hh.Nv&&gb.App.Hh.JX.fpa(a)}jfb(a,b,c){lc.OutlineElementNavigator.ti(a);db.ParagraphReader.Pk(a)?Sj.paragraphEditor.Qu.jfb(a,b,c):Cd.TableReader.Jp(a)&&14===a.ri&&(b=(new Yu.a(1,c)).aM,this.o3k(Object(ua.a)(oy.a,a.currentNode),b));lc.OutlineElementNavigator.Ke(a)}o3k(a,b){a&&Object(Ca.a)(oy.a,a)&&(a.Hl=b)}get Qu(){return Xu.a.hsb}get Mf(){return this.Yc||(this.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get e5(){return this.Go||
(this.Go=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get dr(){return this.Eo.value}get Sf(){return this.Pg.value}get $A(){return this.ix.value}get Vi(){return Rf.a.instance}ROd(){const a=dP.a.instance.createInstance(393229);a.setValue(ob.a.LD,en.a.first);a.setValue(ob.a.pAi,new Date);a.Bld();return a}zxi(){const a=new cP.a;a.setValue(ob.a.LD,en.a.first);return a}kfd(a,b,c){const f=a.Eh;if(f){f.id.equals(Sj.AWe)||(Sj.AWe=f.id,Sj.Xoc={});var l=Sj.Xoc[b];b in Sj.Xoc&&
f.f7a(l.id)&&f.qx&&f.qx.tZ(l.id)||(l=new kq.a,l.setValue(ob.a.author,b),l=f.rHa(l));a.properties.setValue(c,l.id);Sj.Xoc[b]=l}}NFb(a,b){a.properties.setValue(ob.a.lastModifiedTime,b)}RRe(a,b=null){const c=new Oe.GraphTransaction(7);c.hd(a);b||(b=new Date);this.NFb(a,b);this.kfd(a,this.ENc(),ob.a.qTb);""===Md.OutlineElementReader.qKc(a,ob.a.SAc)&&this.kfd(a,this.ENc(),ob.a.SAc);c.dispose()}ENc(){return gb.App.iPe.name}lSd(a,b,c=!1){if(I.a.instance.ga(56))Md.OutlineElementReader.j$d(a)?(a=Md.OutlineElementReader.isRtl(a),
c?this.Vfd(b,a):this.hIa(b,a)):this.WLk(b);else if(I.a.instance.ga(26)||I.a.instance.ga(89))a=Md.OutlineElementReader.isRtl(a),c?this.Vfd(b,a):this.hIa(b,a)}hGb(a,b){var c=new mb.GraphIterator;c.set(a);c.oc(11);c=c.Og(11);Md.OutlineElementReader.Vl(c)!==b&&(this.hIa(c,b),I.a.instance.ga(54)?a.anchor.$q(4):(c=1,b&&(c=3),a.setValue(ob.a.pl,c),a.setValue(ob.a.qI,c)))}hIa(a,b){const c=new Oe.GraphTransaction(7);c.hd(a);this.Vfd(a,b);if(I.a.instance.ga(26)){var f=new mb.GraphIterator;f.set(a);f.yb(2)&&
db.ParagraphReader.Pk(f)&&(f=f.currentNode,b?(f.ke(ne.a.Hbd,!0),Sj.paragraphEditor.KL(f,3)):(f.removeProperty(ne.a.Hbd),Sj.paragraphEditor.KL(f,1)))}f=new mb.GraphIterator;f.set(a);EF.a.instance.yyj(f);if(f.oc(10)){const l=f.Og(10);f.yb(1)===a&&this.$A.hIa(l,b)}c.dispose()}Vfd(a,b){let c=null,f=null;if(this.Mf.Zf&&a.isConnected){c=db.ParagraphReader.AMc(a,!0,!0);f=new Ua.a;for(let l=0;l<c.count;l++)12===c.ga(l).type&&f.add(c.ga(l).Z6())}b?a.properties.setValue(ob.a.bX,!0):I.a.instance.ga(56)?a.properties.setValue(ob.a.bX,
!1):(I.a.instance.ga(26)||I.a.instance.ga(89))&&a.properties.removeProperty(ob.a.bX);if(this.Mf.Zf&&c&&f)if(c.count!==f.count)Z.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",c.count,f.count);else for(a=0;a<c.count;a++)c.ga(a),f.ga(a)}WLk(a){a.properties.removeProperty(ob.a.bX)}Uaa(a,b=null,c=!1){let f=null,l=null;if(!Md.OutlineElementReader.Tg(a))return Z.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),
null;var w=null;let F=null,S=0;b&&(w=b.formatting,F=b.style,S=b.languageId);c||({wGa:f,FBb:l}=this.o5f(a));b=ws.a.instance.createInstance(393230);b.setValue(ob.a.Vp,"");a.hl(b,2);a.Ck(b);Sj.paragraphEditor.uhc(b);Sj.paragraphEditor.D8j(b);Sj.paragraphEditor.eJb(b);this.oXh(b);w&&(b.Ra.first.formatting.Pl=w);S||(S=u.AFrameworkApplication.lcid);a.currentNode.ke(ob.a.Aeb,a.currentNode.ta(ob.a.Aeb,S));I.a.instance.ga(54)&&a.currentNode.setValue(Sb.a.Vdc,0);!I.a.instance.ga(71)||I.a.instance.ga(61)||F||
(w=Mc.StyleReader.rK(b))&&(F=w.mG(Mc.StyleReader.Yma));this.lIh.kMi(a);F&&Sj.qO.V9(F,b,!0);!c&&f&&(c=new CA(f,l,f,new Zu.a(b),b.tOa),a.currentNode.kG().graphTransactionOperations.tY(c));return b}o5f(a){let b;const c=new mb.GraphIterator;c.Pc(a);b=null;c.vsg?c.currentNode.kG().graphTransactionOperations.Lga(6):(lc.OutlineElementNavigator.Jua(c,!0,!1),b=this.BLc(c));c.Pc(a);a=this.$5f(c);return{wGa:b,FBb:a}}$5f(a){const b=new mb.GraphIterator;b.Pc(a);a=null;b.rub||(lc.OutlineElementNavigator.KI(b,!0,
!1),a=this.BLc(b));return a}BLc(a,b=!1){a=lc.OutlineElementNavigator.ti(a,!0);return a?this.s9f(a,b):(Z.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}s9f(a,b=!1){if(12===a.type)return b?new Zu.a(a):new yF.a(a);a.kG().graphTransactionOperations.Lga(5);return new eP.a(a)}lmi(a,b){var c=b.currentNode.clone();a.vK(c,null,1);a.Ck(c);c.JY=b.currentNode;lc.OutlineElementNavigator.ti(b);b.zV&1&&b.currentNode.nZa(null);c=b.currentNode.clone();c.UT=b.currentNode.UT;a.vK(c,
null,2);a.Ck(c);a.oS(1);c.JY=b.currentNode;I.a.instance.ga(55)&&c.setValue(Sb.a.Ln,sg.a.xWa());b.nC(11)}uhc(a){a.yb(2)&&a.Hi()}Ych(a,b){const c=a.currentNode;lc.OutlineElementNavigator.ti(a);const f=a.currentNode;lc.OutlineElementNavigator.Ke(a);b.xA(1);lc.OutlineElementNavigator.ti(b);a.hl(b.currentNode,2);b.Hi();var l=new mb.GraphIterator;l.Pc(b);if(l.yb(1)){const w=new mb.GraphIterator;w.Pc(a);const F=new xF(null);if(!this.Uej(w,l.currentNode,F))return;sm.h(w,null,1,1,l,-1)}b.Hi();l=null;a.RE(1)&&
(l=a.currentNode);for(a.yc();vg.OutlineNavigator.q9(b);)a.vK(b.currentNode,l,1),l=b.currentNode,b.Hi();a.Ck(c);a.Ck(f);a.Hi()}dHb(a,b,c,f,l,w=!1){this.uhc(b);const F=b.ri;var S=a.currentNode;let fa=null;var xa=null;let Za=null,pb=!1;lc.OutlineElementNavigator.ti(a);const Mb=a.ri;if(db.ParagraphReader.Pk(a)){var hc=a.currentNode;(xa=Object(ua.a)(Wc.AParagraphNode,hc))?xa.Ra&&xa.Ra.length||Z.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",xa):Z.ULS.sendTraceTag(38925731,
307,15,"srcParaNode is null");xa=new Zu.a(xa);(pb=c.Qa===db.ParagraphReader.textLength(hc))&&(Za=this.$5f(b));var kc=b.currentNode;fa=this.Uaa(b,void 0,!0);Sj.paragraphEditor.zMe(a,b,c,l,!0,w);I.a.instance.ga(71)&&(f?(l=Mc.StyleReader.iD(hc))&&Sj.qO.V9(l,fa,!0):pb&&(l=Mc.StyleReader.iD(hc))&&((hc=l.ta(ne.a.JTg,null))?(l=Mc.StyleReader.rK(fa).mG(hc),Sj.qO.V9(l,fa,!1)):Sj.qO.V9(l,fa,!0)));this.lSd(S,kc);this.dr.kSd(S,kc)}lc.OutlineElementNavigator.Ke(a);lc.OutlineElementNavigator.Ke(b);S=Md.OutlineElementReader.isEmpty(a,
!0);kc=Md.OutlineElementReader.isEmpty(b,!0);I.a.instance.ga(27)&&S&&!kc&&(b.zV&1&&(S=new zF.a,S.Pc(b),b.currentNode.nZa(S)),this.kfd(b.currentNode,Md.OutlineElementReader.qKc(a.currentNode,ob.a.qTb),ob.a.qTb),this.kfd(b.currentNode,Md.OutlineElementReader.qKc(a.currentNode,ob.a.SAc),ob.a.SAc),this.NFb(b.currentNode,Md.OutlineElementReader.M3i(a.currentNode)));lc.OutlineElementNavigator.ti(a);(S=Object(ua.a)(Wc.AParagraphNode,a.currentNode))?S.Ra&&S.Ra.length||Z.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",
S):Z.ULS.sendTraceTag(38925761,307,15,"srcPara is null");S=new Zu.a(S);lc.OutlineElementNavigator.Ke(a);(a=fa)?a.Ra&&a.Ra.length||Z.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",a):(Z.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),Z.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:pb,["moveText"]:!0,["overrideParagraphStyle"]:f,["sourceOutlineElementContentNodeType"]:Mb,["destinationOutlineElementNodeType"]:F,
["alwaysMoveEopToDestinationPara"]:w}));pb?(c=new CA(xa,Za,S,new Zu.a(a),a.tOa),b.currentNode.kG().graphTransactionOperations.tY(c)):(c=new DF(xa,c.Qa,S,new Zu.a(a),a.tOa),b.currentNode.kG().graphTransactionOperations.tY(c))}nKf(a,b){lc.OutlineElementNavigator.ti(a);let c=db.ParagraphReader.Ir(a.currentNode);const f=a.currentNode;I.a.instance.ga(14)&&(c=b?c&&!this.Vi.Hpk(f):c&&!this.Vi.Bpk(f));lc.OutlineElementNavigator.Ke(a);return c}merge(a,b,c,f,l=null,w=!1,F=!1,S=!1){if(a.currentNode.id===b.currentNode.id)return!1;
let fa,xa;var Za=new mb.GraphIterator;Za.Pc(b);fa=this.BLc(Za);Za.Pc(a);xa=this.BLc(Za,!0);if(!this.nKf(b,!0)||!this.nKf(a,!1))return!1;if(this.Sf.Hfc){var pb=Object(ua.a)(Wc.AParagraphNode,a.currentNode);pb=(c||!pb||!pb.characterData.length)&&!yc.ListReader.$j(a)}else pb=this.YOh.Yul(c,a);S||this.dr.merge(a,b,pb,l);lc.OutlineElementNavigator.ti(a);l=a.currentNode.tOa;lc.OutlineElementNavigator.ti(b);if(db.ParagraphReader.Pk(b)){if(I.a.instance.ga(50)&&gb.App.Hh.Nv){S=b.currentNode;pb=a.currentNode;
const Mb=wF.CoauthLockEditor.getInstance();if(Mb.DGb(this.Vi.YZb(S))||Mb.DGb(this.Vi.YZb(pb)))return b.yc(),a.yc(),!1}S=!1;yc.ListReader.Gw&&(pb=a.parentNode)&&Md.OutlineElementReader.H7(pb)&&(S=yc.ListReader.vRa(pb));I.a.instance.ga(71)&&(pb=(pb=db.ParagraphReader.isEmpty(a)||c)&&!S)&&(pb=Mc.StyleReader.rdg(b))&&Sj.qO.V9(pb,a.currentNode,!0);c&&this.Yna.Z$j(b.currentNode,a.currentNode,S,F);c=Sj.paragraphEditor.merge(a,b,c,f,w);f=Za.currentNode;Za=a.currentNode;a.yc();c&&Md.OutlineElementReader.isEmpty(b,
!0)&&this.NAa(b);a=new CF(xa,fa,new yF.a(f),l);Za.kG().graphTransactionOperations.tY(a);return!0}b.yc();a.yc();return!1}Axj(a){const b=new mb.GraphIterator;b.set(a.node);b.af();lc.OutlineElementNavigator.Ke(b);const c=this.y2b(b),f=this.y2b(b);this.dHb(b,c,a,!1,!0);Md.OutlineElementReader.isEmpty(b,!1)&&(this.dr.hma(b),b.Hi());Md.OutlineElementReader.isEmpty(c,!1)&&!Md.OutlineElementReader.r8a(c)&&(this.dr.hma(c),c.Hi());return f}Oba(a,b,c,f=null,l=!1){if(!this.khi(a))return null;const w=a.currentNode,
F=yc.ListReader.$j(a);b||l||Md.OutlineElementReader.isEmpty(a,!1);l=this.dr.y8k(F);b=b?a.RE(1):a.currentNode;a.yc();c=this.$A.x2b(a,b,c,f);if(!c)return null;this.lSd(w,c);this.dr.kSd(w,c);l&&this.dr.mll(a,w);return c}khi(a){return Md.OutlineElementReader.Tg(a)&&(a=a.parentNode,Vi.OutlineReader.U3b(a)||Md.OutlineElementReader.H7(a)||Md.OutlineElementReader.lsa(a))?!0:!1}SKk(a){const b=new mb.GraphIterator;b.set(a);b.af();b.nC(11);let c,f;({wGa:c,FBb:f}=this.o5f(b));let l=-1;12===a.type&&(l=a.tOa);
b.currentNode.kG().graphTransactionOperations.tY(new BF(this.s9f(a,!0),c,f,l));this.NAa(b)}NAa(a){if(a.$H(1)){const b=new AF,c=new mb.GraphIterator;c.Pc(a);this.HWi(c,b)&&this.Qu.cGc(a,-b.Jpb)}a.Hi();Cd.TableReader.Nr(a)&&this.Auk(a)}f6d(a,b,c){if(!Vi.OutlineReader.xt(a)&&!Md.OutlineElementReader.Tg(a))return null;const f=this.zxi();0<c&&c<en.a.last&&f.setValue(ob.a.LD,Math.min(en.a.nil,c));a.vK(f,b,1);return f}Cxj(a,b){if(!Md.OutlineElementReader.Tg(a)&&!Md.OutlineElementReader.hI(a)||!Vi.OutlineReader.KV(a.parentNode)&&
!Md.OutlineElementReader.H7(a.parentNode))return null;const c=a.currentNode;let f;f=a.currentNode;a.yc();b=this.f6d(a,f,b);a.Ck(c);return b}Auk(a){Md.OutlineElementReader.hI(a)&&(a.$H(1)||a.Hi());this.g3f(a,!1);this.aDf(a)}g3f(a,b){var c,f=null;for(c=a.yb(1);c;){var l=!1;Md.OutlineElementReader.lsa(c)&&!a.$H(1)&&(l=!0);var w=c;c=a.xj(1);if(l)l=new mb.GraphIterator,l.set(w),l.af(),l.Hi();else if(Md.OutlineElementReader.lsa(w)){if(f){l=new mb.GraphIterator;l.set(f);var F=new mb.GraphIterator;F.set(w);
F.af();l.hl(F.currentNode,1);F.Hi();F=Md.OutlineElementReader.j2(w);F===en.a.nil&&(F=1);(F=Math.max(0,Md.OutlineElementReader.j2(w)-F))?w.setValue(ob.a.LD,Math.min(en.a.nil,F)):(l.Ck(w),a.yb(1),sm.e(l),l.yc());b&&this.g3f(l,!0)}}else f=w}b=null;f=en.a.last+1;for(c=a.yb(1);c;c=a.xj(1))if(Md.OutlineElementReader.hI(a))w=Md.OutlineElementReader.j2(c),f>w&&(f=w,b=c);else{a.yc();return}if(b){for(c=a.yb(1);c;c=a.xj(1))c!==b&&a.currentNode.setValue(ob.a.LD,Math.min(en.a.nil,Md.OutlineElementReader.j2(c)-
f));f+=Md.OutlineElementReader.j2(a.currentNode);a.currentNode.setValue(ob.a.LD,Math.min(en.a.nil,f));c=new mb.GraphIterator;c.Pc(a);c.Ck(b);c.yb(1);sm.e(c)}}Uej(a,b,c){var f=Md.OutlineElementReader.j2(a.currentNode);if(1===f)return!0;if(Md.OutlineElementReader.hI(a))return!1;if(!a.X6(1)||this.EHj(a,b))return a.currentNode.setValue(ob.a.LD,Math.min(en.a.nil,1)),!0;if(c.tla&&a.Ck(c.tla)){if(Md.OutlineElementReader.hI(a)&&1===f+Md.OutlineElementReader.j2(a.currentNode))return c.tla=a.xA(1),a.yc(),!0;
a.yc()}if(c.tla&&a.Ck(c.tla)||!c.tla&&a.yb(1)){if(a.currentNode!==b&&a.xf(1)&&Md.OutlineElementReader.hI(a)&&1===f+Md.OutlineElementReader.j2(a.currentNode))return c.tla=null,!0;a.yc()}if(a.EQa(b)&&this.DHj(a,b)){for(c=a.yb(1);c;c=a.xj(1))c!==b&&c.setValue(ob.a.LD,Math.min(en.a.nil,Md.OutlineElementReader.j2(c)+(f-1)));a.currentNode.setValue(ob.a.LD,Math.min(en.a.nil,1));return!0}if(1>f)return f=this.f6d(a,c.tla,1-f),a.Ck(f),c.tla=null,!0;if(1<f){a.currentNode.setValue(ob.a.LD,Math.min(en.a.nil,1));
b=null;let l=a.yb(1);for(;l;){if(Md.OutlineElementReader.hI(a)){l.setValue(ob.a.LD,Math.min(en.a.nil,f-1+Md.OutlineElementReader.j2(l)));l=a.xj(1);continue}b||(b=this.Cxj(a,f-1));const w=l;l=sm.j(a,b,1);l===b&&(l=a.xj(1));c.tla===w&&(c.tla=b,b=null)}return!0}return!1}EHj(a,b){return mb.GraphIterator.jba(()=>{if(1===a.X6(1)){const c=a.yb(1);a.yc();if(c===b)return!0}return!1})}DHj(a,b){return mb.GraphIterator.jba(()=>{let c;for(c=a.yb(1);c;c=a.xj(1))if(c!==b&&!Md.OutlineElementReader.hI(a))return a.yc(),
!1;return!0})}HWi(a,b){b.Jpb=0;do{const c=a.currentNode;if(a.yb(1))b.Jpb-=Md.OutlineElementReader.j2(c);else{if(Vi.OutlineReader.xt(a)||null===a.currentNode)return!1;if(3!==a.role||!a.hia(1))for(;!a.xj(1);)if(b.Jpb+=Md.OutlineElementReader.j2(a.currentNode),Vi.OutlineReader.xt(a)||null===a.currentNode)return!1}}while(Md.OutlineElementReader.hI(a));return!0}y2b(a,b=!1){return this.e6d(a,!1,b)}e6d(a,b,c=!1){const f=new mb.GraphIterator;f.Pc(a);a=new mb.GraphIterator;a.Pc(f);this.Oba(a,b,!1,null,c);
a.currentNode.setValue(ob.a.LD,Math.min(en.a.nil,Md.OutlineElementReader.j2(f.currentNode)));f.yb(1)&&sm.h(a,null,1,1,f,-1);return a}aDf(a){if(Md.OutlineElementReader.GQk(a)){1!==Md.OutlineElementReader.j2(a.currentNode)&&a.currentNode.setValue(ob.a.LD,en.a.first);for(var b=a.yb(1);b;)if(Md.OutlineElementReader.hI(a)){b=new mb.GraphIterator;b.Pc(a);b.yc();const c=new mb.GraphIterator;c.Pc(a);c.yb(1);sm.h(b,a.currentNode,1,1,c,-1);b=a.pOa(1)}else this.aDf(a),b=a.xj(1)}}static get qO(){return Sj.PJ||
(Sj.PJ=lb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static set qO(a){Sj.PJ=a}static get paragraphEditor(){return Sj.tw||(Sj.tw=lb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){Sj.tw=a}}Sj.PJ=null;Sj.tw=null;Sj.AWe=null;Sj.Xoc=null;Object(e.a)(Sj,"OutlineElementEditor",null,[634]);var $u=d(106),Hw=d(399),FF=d(583),lq=d(253);class ho{constructor(a){this.Iff=a}Axi(){const a=ws.a.instance.createInstance(393228);a.setValue(ob.a.LD,en.a.first);a.setValue(ob.a.Pai,0);a.setValue(ob.a.Bx,
Vi.OutlineReader.XTf);(new FF.OutlineIndentInfo(!0)).Jgh(a);return a}zY(a,b,c=null){const f=a.currentNode;if(!a.xA(1))return this.x2b(a,null,b,c);Md.OutlineElementReader.hI(a)&&lc.OutlineElementNavigator.lse(a,!0);return Md.OutlineElementReader.Tg(a)?ho.Lh.Oba(a,!1,b,c):(a.kic(f),null)}jhi(a){return Vi.OutlineReader.D9d(a.currentNode)||Md.OutlineElementReader.Tg(a)||Md.OutlineElementReader.hI(a)||Ce.isTableCell(a)}x2b(a,b=null,c=!1,f=null){if(!this.jhi(a))return null;const l=ho.Lh.ROd();this.j2k(l,
a);a.gQc(l,b,1,this.Iff.a5f());a.Ck(l);c&&(ho.Lh.Uaa(a,f),lc.OutlineElementNavigator.Ke(a));I.a.instance.ga(25)&&ho.Lh.RRe(a.currentNode);return l}j2k(a,b){if(b=this.W9i(b))switch(b.type){case 11:ho.Lh.lSd(b,a,!0);break;case 8:b=ho.hk.isRtl(b),ho.Lh.Vfd(a,b)}}W9i(a){return this.Iff.f0d(a)}n_i(a,b){a=ho.hk.eMc(a);return new Hw.a(a.x+Vi.OutlineReader.LFc*(b?-1:1),a.y+Vi.OutlineReader.eUf)}Nfd(a){if(I.a.instance.ga(17)){var b=new mb.GraphIterator;b.set(a);b.uv();b=this.n_i(b.origin,Vi.OutlineReader.Vl(a));
lq.c(a,b.x,b.y)}}hIa(a,b){I.a.instance.ga(43)&&lg.c(a)||a.setValue(ob.a.qI,b?11:9)}static get hk(){return $u.PageReader.instance}static get Lh(){return ho.xi||(ho.xi=lb.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Lh(a){ho.xi=a}}ho.xi=null;ho.If=null;Object(e.a)(ho,"OutlineEditor",null,[635]);const lP=a=>{a.register(ho,"Box4.OutlineLevelEditors.OutlineEditor").as("Box4.IOutlineEditor").ma().na(()=>new ho(a.resolve("Box4.IOutlineElementNodeIdFactory")));a.register(Sj,"Box4.OutlineLevelEditors.OutlineElementEditor").as("Box4.IOutlineElementEditor").ma().na(()=>
new Sj(a.qe("Box4.IOutlineEditor"),a.qe("Box4.List.IListEditor"),a.qe("Box4.List.IListReader"),a.resolve("Box4.ICreateParagraphStrategy"),a.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),a.resolve("Box4.IFormattingPropertyTransitStrategy")))};class DA{get name(){return"Box4.OutlineLevelEditors"}Yb(a){lP(a)}init(){}dispose(){}static main(){m.a.instance.Ec(new DA)}}Object(e.a)(DA,"Box4OutlineLevelEditorsPackage",null,[2,3]);class EA{get name(){return"Box4.TableEditors"}Yb(){}init(){}dispose(){}static main(){m.a.instance.Ec(new EA)}}
Object(e.a)(EA,"Box4TableEditorsPackage",null,[2,3]);class FA{get name(){return"Box4.TextLevelEditors"}Yb(){}init(){}dispose(){}static main(){m.a.instance.Ec(new FA)}}Object(e.a)(FA,"Box4TextLevelEditorsPackage",null,[2,3]);class Dr{constructor(a,b,c){this.jyd=this.f1a=this.gyd=this.e1a=this.hwd=null;this.sJ=a;this.qJh=b;this.Rc=c;this.init()}init(){this.qJh.pb(Object(C.a)(this,this.Wij,"handleEditingViewUpdatesSafe"));this.e1a=new Ie.a;this.gyd=new Ie.a;this.f1a=new Ie.a;this.jyd=new z.a}DWa(a){this.e1a.add(a.key,
a)}LCe(a){this.f1a.add(a.key,a)}Wij(a){try{this.Vij(a)}catch(b){a=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",b.message,b.stack),Z.ULS.sendTraceTag(5285580,334,10,a)}}Vij(a){let b;({OPd:b}=Dr.snl(this.Rc.Pa.kb)).returnValue&&(a=Dr.VYi(a,this.hwd,b),this.jyk(a,b),this.hwd=b)}jyk(a,b){a=this.GVi(a,b);let c;({notification:c}=Dr.lnl(a)).returnValue&&this.sJ.sendNotification(c,!1)}GVi(a,b){const c=new Ie.a;c.$(1,new z.a);c.$(0,new z.a);a.forEach(f=>
{3===f?(cb.ImageReader.tG(b.node)||this.LQk(b),this.f7i(c,b)):0===f&&this.sZi(c,b);return!0});return c}LQk(a){this.e1a.forEach((b,c)=>{c.reset(a);return!0})}sZi(a,b){let c=new Ie.a;cb.ImageReader.tG(b.node)||(c=this.pZi(b.Qa));this.qZi(a,this.gyd,c,Dr.Lhh(this.hwd,b));this.gyd=c}pZi(a){const b=new Ie.a;this.e1a.forEach((c,f)=>{c=null;({uza:c}=f.Gmc(a)).returnValue&&b.$(f.key,c);return!0});return b}qZi(a,b,c,f){const l=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;b.forEach((w,F)=>{const S=
this.e1a.ga(w).w6||F.title;let fa;({value:fa}=c.Nf(w)).returnValue?f&&fa.kP!==F.kP&&(S&&a.ga(1).add(S),w=this.e1a.ga(w).w6,w=String.format(l,fa.title,w),fa.description&&(w+=", "+fa.description),a.ga(0).add(w)):S&&a.ga(1).add(S);return!0});c.forEach((w,F)=>{b.Kb(w)||(w=this.e1a.ga(w).w6,w=String.format(l,F.title,w),F.description&&(w+=", "+F.description),a.ga(0).add(w));return!0})}f7i(a,b){b=this.Sbj(b.node);b=this.ini(b);this.Tbj(a,this.jyd,b);this.jyd=b}Sbj(a){const b=new mb.GraphIterator;b.set(a);
if(!b.oc(1))return null;const c=new z.a;for(;1!==b.ri;)this.f1a.forEach((f,l)=>{let w;({$ob:w}=l.IQe(b)).returnValue&&c.add(w);return!0}),b.yc();c.reverse();return c}ini(a){a=a.toArray();let b=0;for(;b<a.length-1;){var c=a[b];if(c.F_===a[b+1].F_&&(this.f1a.ga(c.F_),({lni:c}={returnValue:!1,lni:null}).returnValue)){a.splice(b,2,c);continue}b++}return new z.a(a)}Tbj(a,b,c){var f;for(f=0;f<Math.min(c.length,b.length)&&c.ga(f).contentId.equals(b.ga(f).contentId);f++){var l=this.f1a.ga(c.ga(f).F_).WKc(c.ga(f),
b.ga(f));l&&(c.ga(f).description&&(l+=", "+c.ga(f).description),a.ga(0).add(l))}for(l=f;l<c.length;l++){let w=this.f1a.ga(c.ga(l).F_).WKc(c.ga(l),null);w&&(c.ga(l).description&&(w+=", "+c.ga(l).description),a.ga(0).add(w))}for(c=f;c<b.length;c++)(f=this.f1a.ga(b.ga(c).F_).w6)&&a.ga(1).add(f)}static VYi(a,b,c){const f=new z.a;(a=a||Dr.SWk(b,c))?(f.add(3),f.add(0)):Dr.Lhh(b,c)&&f.add(0);return f}static SWk(a,b){return!a||!a.node.id.equals(b.node.id)}static Lhh(a,b){return!a||!a.equals(b)}static snl(a){let b;
b=null;if(!a||!(Cb.SelectionEditor.Ew(a)||(a=Cb.SelectionEditor.xl(a,!0,!1),Cb.SelectionEditor.Ew(a)||a.Wa&&cb.ImageReader.tG(a.Wa.node))))return{returnValue:!1,OPd:b};b=a.Wa;return{returnValue:!!b,OPd:b}}static lnl(a){const b=new z.a;a.ga(1).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,c);b.add(c);return!0});a.ga(0).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,c);b.add(c);return!0});a=b.toArray().join(" ");return{returnValue:0<
b.length,notification:a}}}Object(e.a)(Dr,"AccessibilityContextManager",null,[602]);class Iw{constructor(a,b){this.d$e=!1;this.lQb=null;this.rwc=this.$xc=!1;this.c0e=null;this.Md=a;this.Mib=b}get fpj(){return!!this.lQb}pb(a){this.d$e||(this.Mib.VBf(Object(C.a)(this,this.Yzc,"afterEditingViewValidateEventHandler")),this.d$e=!0);this.c0e=a}Yzc(a,b){(b.YL||b.HT)&&this.udk(b.YL,b.HT)}udk(a,b){this.fpj&&this.Md.ah(this.lQb);this.$xc=this.$xc||a;this.rwc=this.rwc||b;this.lQb=new Se.a(4,1,Iw.pLi,()=>{this.c0e(this.$xc,
this.rwc);this.reset()},126);this.Md.Hb(this.lQb)}reset(){this.lQb=null;this.rwc=this.$xc=!1}}Iw.pLi=100;Object(e.a)(Iw,"EditingViewOnAfterValidateEventsConsolidator",null,[601]);class GA{constructor(){this.Ea=null}get name(){return"Box4.Accessibility"}init(){gb.App.QFf&&this.Ea.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}Yb(a){this.Ea=a;a.register(Iw,"Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator").as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ma().na(()=>
new Iw(u.AFrameworkApplication.ve,a.resolve("Box4.ContentEditableViewEventSource")));a.register(Dr,"Box4.Accessibility.AccessibilityContextManager").as("Box4.Accessibility.IAccessibilityContextManager").ma().na(()=>new Dr(a.resolve("Common.Utils.IAriaNotifier"),a.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),dd.a.instance))}static main(){m.a.instance.Ec(new GA)}}Object(e.a)(GA,"Box4AccessibilityPackage",null,[2,3]);class HA{constructor(a,b){this.Yrf=a;this.l1=b;this.nrf=
this.Yqf=this.Zqf=this.mrf=this.WWe=this.orf=!0}get keb(){return this.orf}get jCc(){return this.WWe}get Tcd(){return this.mrf}get Qhc(){return this.Zqf}get Rcd(){return this.Yqf}get ZDe(){return this.nrf}GJf(a){if(a)for(let c in a){var b=c;const f=Boolean.parse(a[c].toString()||"false");switch(b){case "ReplaceTextAsYouType":this.orf=f;break;case "CapitalizeFirstLetterOfSentences":this.WWe=f;break;case "ReplaceOrdianalsWithSuperscript":this.mrf=f;break;case "ReplaceHyphensWithDash":this.Zqf=f;break;
case "ReplaceFractionsWithFractionCharacter":this.Yqf=f;break;case "ReplaceQuoteWithSmartQuote":this.nrf=this.l1&&f}}}tWi(){this.Yrf.F1d("getAutoCorrectOptionsSettings","ReplaceTextAsYouType CapitalizeFirstLetterOfSentences ReplaceOrdianalsWithSuperscript ReplaceHyphensWithDash ReplaceFractionsWithFractionCharacter ReplaceQuoteWithSmartQuote".split(" ")).continueWith(Object(C.a)(this,this.Nhk,"onGetRequestFinished"),8);Z.ULS.sendTraceTag(24523491,324,50,"Load to get autocorrect options from Roaming Service.")}PUk(a){this.Yrf.tlh("saveAutoCorrectOptionsSettings",
a);Z.ULS.sendTraceTag(24523520,324,50,"Try to save autocorrect options to Roaming Service.");this.GJf(a)}Nhk(a){a.Sl?Z.ULS.sendTraceTag(24523522,324,15,"Fail to get autocorrect options from Roaming Service."):((a=a.result)&&this.GJf(a),Z.ULS.sendTraceTag(24523521,324,50,"Load to get autocorrect options from Roaming Service successfully, isUserSettingsEmpty: {0}",!a||!va.a.count(a)))}}Object(e.a)(HA,"AutoCorrectOptionsInfo",null,[823]);var py=d(222);class ej{static get BGf(){ej.kKb||(ej.kKb=[],ej.LAb(qa.a.re("ar-sa")),
ej.LAb(qa.a.re("de-de")),ej.LAb(qa.a.re("es-es")),ej.vQ(qa.a.re("en-029"),qa.a.re("en-us")),ej.vQ(qa.a.re("en-au"),qa.a.re("en-us")),ej.vQ(qa.a.re("en-bz"),qa.a.re("en-us")),ej.vQ(qa.a.re("en-ca"),qa.a.re("en-us")),ej.vQ(qa.a.re("en-gb"),qa.a.re("en-us")),ej.vQ(qa.a.re("en-id"),qa.a.re("en-us")),ej.vQ(qa.a.re("en-my"),qa.a.re("en-us")),ej.vQ(qa.a.re("en-ph"),qa.a.re("en-us")),ej.vQ(qa.a.re("zh-tw"),qa.a.re("en-us")),ej.LAb(qa.a.re("fr-fr")),ej.vQ(qa.a.re("hr-ba"),qa.a.re("hr-hr")),ej.vQ(qa.a.re("it-ch"),
qa.a.re("it-it")),ej.vQ(qa.a.re("nb-no"),qa.a.re("nn-no")),ej.LAb(qa.a.re("nl-nl")),ej.vQ(qa.a.re("ro-md"),qa.a.re("ro-ro")),ej.vQ(qa.a.re("ru-md"),qa.a.re("ru-ru")),ej.vQ(qa.a.re("sr-latn-ba"),qa.a.re("sr-latn-cs")),ej.vQ(qa.a.re("sr-latn-me"),qa.a.re("sr-latn-cs")),ej.vQ(qa.a.re("sr-latn-rs"),qa.a.re("sr-latn-cs")),ej.LAb(qa.a.re("sr-cyrl-cs")),ej.vQ(qa.a.re("sv-fi"),qa.a.re("sv-se")));return ej.kKb}static LAb(a){ej.kKb[a.languageId]=a.LCID}static vQ(a,b){ej.kKb[a.LCID]=b.LCID}static H8f(a){var b=
qa.a.re(a);if(!b)return 0;b=ej.BGf[b.LCID]||ej.BGf[b.languageId]||0;return b===a?0:b}}ej.kKb=null;Object(e.a)(ej,"AutoCorrectListFallback",null,[]);class io{constructor(a,b,c,f,l){this.X6e=!1;this.Sbf=0;this.CKa=null;this.VSh=!1;this.Mbf=this.Vdf=!0;this.y5e=null;this.qtc=!0;this.Njb=a;this.DKa=b;this.z0a=c;this.M5=f;this.Vg=l;this.aPb=a?a.innerText:db.ParagraphReader.text(b)}get Dw(){throw Error.notImplemented("The inherit class should have the default value.");}set Dw(a){}get aVc(){return this.Sbf}Llh(a){this.Sbf=
a}get kb(){return this.CKa}set kb(a){this.CKa=a}get Fjg(){return this.Njb}get Ofg(){return this.DKa}get mF(){return this.z0a}get X3(){return this.M5}get jBb(){return this.Vdf}set jBb(a){this.Vdf=a}get osg(){return this.X6e}get fxg(){return!1}get Lla(){return this.aPb}invoke(){this.X6e=!0;if(this.Njb&&this.Njb.parentNode&&!this.Dw){var a=this.Njb.innerText;if(this.jBb&&Ja.a.substring(this.aPb,this.z0a,this.M5)!==Ja.a.substring(a,this.z0a,this.M5))return 0;this.x4a(this.Njb);this.Llh(this.Njb.innerText.length-
a.length);return 1}this.qtc||cd.a.instance.Vb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.Mbf)return cd.a.instance.Vb("AbortedAction",{["Reason"]:this.y5e}),0;var b=db.ParagraphReader.text(this.DKa);a=b.length;var c=this.aPb.length,f=Ja.a.substring(this.aPb,this.z0a,this.M5).trimEnd();b=Ja.a.substring(b,this.z0a,this.M5).trimEnd();f===b&&this.M5>c&&(this.M5=c);if(this.jBb&&f!==b)if(c=f.replace(RegExp('"',"g"),""),c===Ja.a.substr(b,0,c.length))this.M5-=2;else return 0;if(I.a.instance.ga(50)&&
gb.App.Hh.Nv&&wF.CoauthLockEditor.getInstance().DGb(io.Vi.YZb(this.DKa)))return 0;c=new Oe.GraphTransaction(15);c.hd(this.DKa);c.fd=this.commandId;this.K6(this.DKa);this.Llh(db.ParagraphReader.textLength(this.DKa)-a);this.CKa&&!this.VSh&&Cb.SelectionEditor.Ew(this.CKa)&&(b=this.CKa.Wa,a=b.Qa,f=b.Lb,b=b.node,b===this.DKa&&this.aVc&&(a>=this.M5&&(a+=this.aVc),f>=this.M5&&(f+=this.aVc),this.CKa=fd.SelectionFactory.PY(b,a,f)));c.dispose();return 2}WBh(){this.qtc=this.NLf()}x4a(){}NLf(){var a=db.ParagraphReader.text(this.DKa);
const b=Ja.a.substring(this.aPb,this.z0a,this.M5).trimEnd();a=Ja.a.substring(a,this.z0a,this.M5).trimEnd();return b===a}static get Vi(){return Rf.a.instance}}Object(e.a)(io,"AutoCorrectAction",null,[662]);class jo extends io{constructor(a,b,c,f,l,w){super(a,b,c,f,w);this.bcf=null;this.$bb=l;this.lU=w}get eVc(){return this.bcf||(this.bcf=lb.a.instance.qb("Box4.List.IListCommands"))}get dr(){return jo.Eo||(jo.Eo=lb.a.instance.resolve("Box4.List.IListEditor"))}get Dw(){return!0}get commandId(){return D.a.TId}set Dw(a){super.Dw=
a}}jo.Eo=null;Object(e.a)(jo,"RegexCorrectAction",io,[]);class Qp extends jo{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w);Qp.UZa=w}get commandId(){return D.a.LId}K6(a){this.eVc&&(a=mb.GraphIterator.nb(a),a.af(),lc.OutlineElementNavigator.Ke(a))}static get characterPropertiesEditor(){return Qp.UZa||(Qp.UZa=lb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Sf(){return Qp.Pg||(Qp.Pg=lb.a.instance.resolve("Box4.List.IListReader"))}static EB(a,b,c,f,l){return new Qp(null,a,b,c,f,l)}static mP(a,
b,c,f,l){return new Qp(a,lf.a(a).gb,b,c,f,l)}}Qp.UZa=null;Qp.Pg=null;Object(e.a)(Qp,"BulletListAction",jo,[]);class Ug extends jo{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w);this.vNb=!1;this.Dw=!a;this.UZa=w;Ug.Wk=new Bc.a}get Dw(){return this.vNb}set Dw(a){this.vNb=a}x4a(a){this.FLd(a.innerText,(b,c,f)=>{a.innerText=Ja.a.substring(a.innerText,0,b)+f+Ja.a.right(a.innerText,c)})}K6(a){this.FLd(db.ParagraphReader.text(a).substring(this.mF,this.X3),(b,c,f)=>{this.UZa.replaceTextRange(Fc.a.createTextRange(a,
this.mF+b,this.mF+c),f,!0,!1)})}FLd(a,b){if(!(2>this.$bb.length)&&this.$bb[1]){var c=this.$bb[1];Ug.Wk.count||this.Z3g();Ug.Wk.Kb(c)&&(a=a.lastIndexOf(c),-1!==a&&b(a,a+c.length,Ug.Wk.ga(c)))}}}Ug.Wk=null;Object(e.a)(Ug,"DictionarySequenceReplacerAction",jo,[]);class Jw extends Ug{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w)}get commandId(){return D.a.rTb}Z3g(){Ug.Wk.$("--","\u2014");Ug.Wk.$(" -- "," \u2013 ");Ug.Wk.$(" - "," \u2013 ");Ug.Wk.$("-- ","\u2014");Ug.Wk.$(" --"," \u2013");Ug.Wk.$(" -"," \u2013")}static EB(a,
b,c,f,l){return new Jw(null,a,b,c,f,l)}static mP(a,b,c,f,l){return new Jw(a,lf.a(a).gb,b,c,f,l)}}Object(e.a)(Jw,"DashAction",Ug,[]);class At extends Ug{constructor(a,b,c,f,l,w,F){super(a,b,c,f,l,w);this.Da=F}get commandId(){return D.a.NId}Z3g(){Ug.Wk.$(":)","\ud83d\ude0a");Ug.Wk.$(":-)","\ud83d\ude0a");Ug.Wk.$(":|","\ud83d\ude10");Ug.Wk.$(":-|","\ud83d\ude10");Ug.Wk.$(":(","\ud83d\ude41");Ug.Wk.$(":-(","\ud83d\ude41");Ug.Wk.$(";)","\ud83d\ude09");Ug.Wk.$(";-)","\ud83d\ude09");Ug.Wk.$(":D","\ud83d\ude00");
Ug.Wk.$(":-D","\ud83d\ude00");Ug.Wk.$(":')","\ud83d\ude02");Ug.Wk.$("=D","\ud83d\ude03");Ug.Wk.$(":>","\ud83d\ude06");Ug.Wk.$(":->","\ud83d\ude06");Ug.Wk.$(":3","\ud83d\ude0a");Ug.Wk.$(":-3","\ud83d\ude0a");Ug.Wk.$("B-)","\ud83d\ude0e");Ug.Wk.$("*-*","\ud83d\ude0d");Ug.Wk.$(":*","\ud83d\ude19");Ug.Wk.$(":-*","\ud83d\ude19");Ug.Wk.$(":X","\ud83d\ude36");Ug.Wk.$(":-X","\ud83d\ude36");Ug.Wk.$(":O","\ud83d\ude2e");Ug.Wk.$(":-O","\ud83d\ude2e");Ug.Wk.$(":#","\ud83e\udd10");Ug.Wk.$(":-#","\ud83e\udd10");
Ug.Wk.$(":P","\ud83d\ude1b");Ug.Wk.$(":-P","\ud83d\ude1b");Ug.Wk.$(";P","\ud83d\ude1c");Ug.Wk.$(";-P","\ud83d\ude1c");Ug.Wk.$(":-/","\ud83d\ude15");Ug.Wk.$("$-$","\ud83e\udd11");Ug.Wk.$(":S","\ud83d\ude16");Ug.Wk.$(":-S","\ud83d\ude16");Ug.Wk.$(":[","\ud83d\ude1f");Ug.Wk.$(":-[","\ud83d\ude1f");Ug.Wk.$(":\u2019(","\ud83d\ude22");Ug.Wk.$(":'(","\ud83d\ude22");Ug.Wk.$("@-@","\ud83d\ude31")}K6(a){this.FLd(db.ParagraphReader.text(a).substring(this.mF,this.X3),(b,c,f)=>{b=Fc.a.createTextRange(a,this.mF+
b,this.mF+c);c={};c.MenuItemId=f;this.Da.li(b,D.a.hxj,2,!1,null,c,null)})}static EB(a,b,c,f,l,w){return new At(null,a,b,c,f,l,w)}static mP(a,b,c,f,l,w){return new At(a,lf.a(a).gb,b,c,f,l,w)}}Object(e.a)(At,"EmojiAction",Ug,[]);class Rp{constructor(a,b,c,f){this.zJ=a;this.Pxc=b;this.Xaf=f;this.hz=c}Aug(){if(!this.hz)return!1;this.zJ=this.zJ.trimStart();return this.zJ===this.hz?!0:!1}lOj(){if(!this.zJ)return!1;const a=this.zJ.lastIndexOf(" ");return-1!==a&&"."===this.zJ.charAt(a-1)&&"."===this.zJ.charAt(a-
3)?!0:!1}kOj(){if(!this.zJ)return!1;const a=this.zJ.lastIndexOf(" ");return-1!==a&&"."===this.zJ.charAt(this.zJ.substring(0,a-1).lastIndexOf(" ")+2)?!0:!1}wHj(){return this.Aug()&&(1===this.hz.length&&"."===this.Pxc||"."===this.zJ.charAt(1))?!0:!1}xHj(){return this.hz?0<="\\/".indexOf(this.Pxc)||3===this.hz.length&&0<="\\/".indexOf(this.hz.charAt(1))?!0:!1:!1}yGj(){return this.hz?0<=this.hz.indexOf("@")?!0:!1:!1}As(){if(!this.hz)return!1;for(const a of Rp.V1d())if(Ja.a.startsWith(this.hz+this.Pxc,
a))return!0;return!1}hGj(){return this.hz?"i"===this.hz&&0<=Rp.quotes.indexOf(this.Pxc)?!0:!1:!1}MBj(){if(!this.zJ)return!1;const a=Ja.a.EDa(this.zJ,this.zJ.length-1);if(-1!==a&&this.zJ.substring(a+1,this.zJ.length)===this.hz){const b=this.zJ.charAt(a-1);if(0<=Rp.cHe.indexOf(b)||0<=Rp.quotes.indexOf(b)&&0<=Rp.cHe.indexOf(this.zJ.charAt(a-2)))return!0}return!1}dji(){return!this.zJ||this.lOj()||this.wHj()||this.xHj()||this.kOj()||this.yGj()||this.As()?!1:this.Aug()||this.hGj()||this.MBj()?!0:!1}static V1d(){return Rp.$bf||
(Rp.$bf="http: https: ftp:// mailto: \\\\ www.".split(" "))}}Rp.cHe=".!?";Rp.quotes="'\"";Rp.$bf=null;Object(e.a)(Rp,"FirstLetterUpperCaseRules",null,[]);class mq{constructor(a){this.hz=a}OSi(){if(!this.hz)return null;for(let a=0;a<mq.bfg().length;a++)if(this.hz===mq.bfg()[a])return mq.Rfj()[a];return null}static bfg(){return mq.t2e||(mq.t2e=["1/2","1/4","3/4"])}static Rfj(){return mq.s2e||(mq.s2e=["\u00bd","\u00bc","\u00be"])}}mq.t2e=null;mq.s2e=null;Object(e.a)(mq,"FractionsCollection",null,[]);
class IA extends io{constructor(a,b,c,f,l,w){super(a,b,c,f,w);this.aLb=l;this.lU=w}get Dw(){return!0}get commandId(){return D.a.OId}x4a(a){a.innerText=Ja.a.substring(a.innerText,0,this.mF)+this.aLb+Ja.a.right(a.innerText,this.X3)}K6(a){this.lU.replaceTextRange(Fc.a.createTextRange(a,this.mF,this.X3),this.aLb,!0,!1)}set Dw(a){super.Dw=a}static EB(a,b,c,f,l){return new IA(null,a,b,c,f,l)}}Object(e.a)(IA,"FractionsReplaceCorrectAction",io,[]);class Bt extends jo{constructor(a,b,c,f,l,w){super(a,b,c,
f,l,w)}get commandId(){return D.a.QId}K6(a){this.eVc&&(a=mb.GraphIterator.nb(a),a.af(),lc.OutlineElementNavigator.Ke(a))}static EB(a,b,c,f,l){return new Bt(null,a,b,c,f,l)}static mP(a,b,c,f,l){return new Bt(a,lf.a(a).gb,b,c,f,l)}}Object(e.a)(Bt,"LetterListAction",jo,[]);class Kw extends jo{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w)}get commandId(){return D.a.tTb}K6(a){this.eVc&&(a=mb.GraphIterator.nb(a),a.af(),lc.OutlineElementNavigator.Ke(a))}static EB(a,b,c,f,l){return new Kw(null,a,b,c,f,l)}static mP(a,
b,c,f,l){return new Kw(a,lf.a(a).gb,b,c,f,l)}}Object(e.a)(Kw,"NumberListAction",jo,[]);class Sp extends io{constructor(a,b,c,f,l){super(a,b,c,f,l);Sp.lU=l}get Dw(){return!0}get commandId(){return D.a.RId}x4a(){}K6(a){const b=Fc.a.createTextRange(a,this.X3-2,this.X3),c=new Oe.GraphTransaction(15);c.hd(a);let f=!1,l=null,w=0;for(;w<a.Ra.length;){var F=a.Ra.ga(w),S=!!F.jo||F.bca;let fa=!!F.fieldRangeEnd||F.qZ;if(F.cp>=b.Qa){F.cp>b.Qa||!F.formatting?l=f?F.formatting:Sp.lU.yea(a,w,b.Qa,l):(l=F.formatting,
fa&&(f=!1),S&&(f=!0));w++;break}F.formatting&&(l=F.formatting);fa&&(f=!1);S&&(f=!0);w++}for(;w<a.Ra.length;){S=a.Ra.ga(w);if(S.cp>=b.Lb){if(S.cp>b.Lb||!S.formatting&&!S.Cj)f||Sp.lU.yea(a,w,b.Lb,l);f||Sp.fh.wX(l,!0);break}S.formatting&&(f||Sp.fh.wX(l,!0),l=S.formatting);F=!!S.jo||S.bca;S=!!S.fieldRangeEnd||S.qZ;F&&(f=!0);!F&&S&&(f=!1);w++}c.dispose()}set Dw(a){super.Dw=a}static get fh(){return Sp.If||(Sp.If=lb.a.instance.resolve("Box4.IFormattingEditor"))}static EB(a,b,c,f){return new Sp(null,a,b,
c,f)}}Sp.lU=null;Sp.If=null;Object(e.a)(Sp,"OrdinalsReplaceCorrectAction",io,[]);class pl extends jo{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w);pl.Ykb||pl.Bel();this.UZa=w}get commandId(){return D.a.SId}K6(a){if(!a.noj){var b=this.CKa.Wa.node===a,c=-1,f=3;this.$bb[2]&&(c=parseInt(this.$bb[2]));this.$bb[1]&&(f=parseInt(this.$bb[1]));if(!(20<c||100<f)){a.kG().graphTransactionOperations.Lga(7);var l=mb.GraphIterator.nb(a);l.af();lc.OutlineElementNavigator.Ke(l);pl.Lh.Oba(l,!1,!1);pl.Lh.Uaa(l);for(let S=
0;S<f;++S){const fa=[];var w=S%pl.Ykb.length,F=0<c?c:pl.Ykb[w].length;for(let xa=0;xa<F;++xa)Array.add(fa,pl.Ykb[w][xa%pl.Ykb[w].length]);w=Fc.a.Wj(l.currentNode,0);F=Ab.a.xs(w);2!==gb.App.mode?pl.fh.AXa(F,1142):pl.fh.gm(F,Sb.a.noProof,!0);this.UZa.replaceTextRange(w,fa.join(" "),!0,!1);S<f-1&&(lc.OutlineElementNavigator.Ke(l),pl.Lh.Oba(l,!1,!1),pl.Lh.Uaa(l))}c=l.currentNode;l=mb.GraphIterator.nb(a);l.af();lc.OutlineElementNavigator.Ke(l);l.Hi();b&&(this.CKa=fd.SelectionFactory.Lg(c,db.ParagraphReader.textLength(c)))}}}static get Lh(){return pl.xi||
(pl.xi=lb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get fh(){return pl.If||(pl.If=lb.a.instance.resolve("Box4.IFormattingEditor"))}static Bel(){pl.Ykb=[["Lorem ipsum dolor sit amet, consectetuer adipiscing elit.","Maecenas porttitor congue massa.","Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna."],["Nunc viverra imperdiet enim.","Fusce est.","Vivamus a tellus."],["Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.",
"Proin pharetra nonummy pede.","Mauris et orci."]]}static EB(a,b,c,f,l){return new pl(null,a,b,c,f,l)}static mP(a,b,c,f,l){return new pl(a,lf.a(a).gb,b,c,f,l)}}pl.Ykb=null;pl.xi=null;pl.If=null;Object(e.a)(pl,"RandAction",jo,[]);class GF{constructor(a,b,c,f){this.pattern=f&8?new RegExp(a,"i"):new RegExp(a);this.Sqj=b;this.Mgj=c;this.flags=f}}Object(e.a)(GF,"RegexAutoCorrectEntry",null,[]);class Lw extends jo{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w)}get commandId(){return D.a.UId}K6(a){this.eVc&&
(a=mb.GraphIterator.nb(a),a.af(),lc.OutlineElementNavigator.Ke(a))}static EB(a,b,c,f,l){return new Lw(null,a,b,c,f,l)}static mP(a,b,c,f,l){return new Lw(a,lf.a(a).gb,b,c,f,l)}}Object(e.a)(Lw,"RomanListAction",jo,[]);class Mw extends io{constructor(a,b,c,f,l,w){super(a,b,c,c+1,w);this.lU=w;this.SVh=f;this.sYe=l;this.jBb=!1}get Dw(){return!1}get commandId(){return D.a.k$h}x4a(a){a.innerText=Ja.a.substring(a.innerText,0,this.mF)+this.sYe+Ja.a.right(a.innerText,this.X3)}K6(a){this.lU.replaceTextRange(Fc.a.createTextRange(a,
this.mF,this.X3),this.SVh,!0,!1);this.lU.replaceTextRange(Fc.a.createTextRange(a,this.mF,this.mF+1),this.sYe,!0,!1)}set Dw(a){super.Dw=a}static EB(a,b,c,f,l,w){if("'"!==c&&'"'!==c)return null;var F=mb.GraphIterator.nb(a);F.af();lc.OutlineElementNavigator.Ke(F);if(Md.OutlineElementReader.Vl(F.currentNode))return null;f=!b||Ja.a.wae(f)||-1!==Array.indexOf(Mw.znk,f);F="'"===c;return new Mw(w,a,b,c+"",f?F?"\u2018":"\u201c":F?"\u2019":"\u201d",l)}}Mw.znk=["[","{","("];Object(e.a)(Mw,"SmartQuoteCorrectAction",
io,[]);class ys extends io{constructor(a,b,c,f,l,w){super(a,b,c,f,w);this.aLb=l;this.lU=w}get Dw(){return ys.vNb}set Dw(a){ys.vNb=a}get commandId(){return D.a.WId}WBh(){this.qtc=this.NLf();this.qtc||(this.Mbf=!1,this.y5e="MatchTextIsNotTheSame")}x4a(a){a.innerText=Ja.a.substring(a.innerText,0,this.mF)+this.aLb+Ja.a.right(a.innerText,this.X3)}K6(a){this.lU.replaceTextRange(Fc.a.createTextRange(a,this.mF,this.X3),this.aLb,!0,!1)}static mP(a,b,c,f,l){const w=lf.a(a);return new ys(a,w?w.gb:null,b,c,f,
l)}static EB(a,b,c,f,l){return new ys(null,a,b,c,f,l)}}ys.vNb=!1;Object(e.a)(ys,"StringReplaceCorrectAction",io,[]);class qy extends io{constructor(a,b,c,f,l,w,F,S){super(a,b,c,f,l);this.lU=l;this.KC=w;this.RMh=F;this.PC=S}get Dw(){return!0}get commandId(){return D.a.YId}x4a(a){let b=Ja.a.substring(a.innerText,this.mF,this.X3);b.charAt(0)!==b.charAt(0).toUpperCase()&&(b=b.charAt(0).toUpperCase()+b.substring(1,b.length));a.innerText=Ja.a.substring(a.innerText,0,this.mF)+b+Ja.a.right(a.innerText,this.X3)}K6(a){const b=
this.mF,c=this.mF+1,f=a.characterData.substring(b,c).charAt(0);Ja.a.jae(f)||(a=Fc.a.createTextRange(a,b,c),this.cCj(a)||this.lU.replaceTextRange(a,f.toUpperCase().toString(),!0,!1))}cCj(a){return this.RMh?!!this.KC&&this.KC.hsa(a):!1}set Dw(a){super.Dw=a}static mP(a,b,c,f){const l=lf.a(a);return new qy(a,l?l.gb:null,b,c,f,null,!1,null)}static EB(a,b,c,f,l,w,F){return new qy(null,a,b,c,f,l,w,F)}}Object(e.a)(qy,"UpperFirstLetterAutoCorrect",io,[]);class Er{constructor(a,b){this.Xaf=b;this.hz=a}gwl(){const a=
Number.parseInvariant(this.hz.substring(0,this.hz.length-2));switch(Number.parseInvariant(this.hz.charAt(this.hz.length-3).toString())){case 1:return 11===a?"th":"st";case 2:return 12===a?"th":"nd";case 3:return 13===a?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}HHj(){var a=qa.a.re(this.Xaf);if(!a||!a.name.toLowerCase().startsWith("en")||!this.hz||2>=this.hz.length)return!1;for(a=0;a<Er.ONc().length;a++)if(this.hz.toLowerCase().endsWith(Er.ONc()[a])){if(RegExp("^\\d+$").test(this.hz.substr(0,
this.hz.length-2))){const b=this.gwl();if(this.hz.toLowerCase().endsWith(Er.ONc()[a])&&b===Er.ONc()[a])return!0}break}return!1}static ONc(){return Er.tff||(Er.tff=["st","nd","rd","th"])}}Er.tff=null;Object(e.a)(Er,"ValidateOrdinalsRule",null,[]);class fn{constructor(a,b,c,f,l,w,F){this.d1a=[];this.nib=[];this.jKb=[];this.Bod=[];this.coa=-1;this.s4e=this.l1=this.Kqc=!1;this.Urc=a;this.Vg=b;this.KC=c;this.Da=f;this.XQ=w;this.PC=F;l?(this.Kqc=l.ka("WordEditorEmoticonAutoCorrectIsEnabled")||l.ka("OneNoteInsertEmojiIsEnabled"),
this.l1=l.ka("ReplaceQuoteWithSmartQuoteIsEnabled"),this.s4e=l.ka("HyperlinkUrlValidationIsEnabled"),Z.ULS.sendTraceTag(23418953,324,50,"{0}",{["WordEditorEmoticonAutoCorrectIsEnabled"]:this.Kqc,["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.l1})):(Z.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.l1=this.Kqc=!1)}X7d(a){return 0<=fn.MId.indexOf(a)}$Mj(a){return 0<=fn.XId.indexOf(a)}Ktg(a){return a.toLowerCase()===a}jae(a){return a.toUpperCase()===
a}e7d(a){return a.toLowerCase()!==a.toUpperCase()}RDj(a,b,c,f){return(new Rp(a,b,c,f)).dji()}DZi(a){do{if(a.getAttribute("xml:lang"))return qa.a.re(a.getAttribute("xml:lang"))||qa.a.J2b;if(a.getAttribute("lang"))return qa.a.re(a.getAttribute("lang"))||qa.a.J2b;a=a.parentNode}while(a&&1===a.nodeType);return qa.a.J2b}ZXd(a){return qa.a.re(Ab.a.language(Ab.a.xs(a)))||qa.a.J2b}XIc(a,b){0>b&&(b=0);let c=-1;const f=fn.MId.length;for(let l=0;l<f;++l){const w=a.lastIndexOf(Ja.a.charAt(fn.MId,l),b);w>c&&(c=
w)}a=Ja.a.EDa(a,b);a>c&&(c=a);return c}zPi(a){for(let b=0;b<a.length;++b)if(this.e7d(Ja.a.charAt(a,b)))return b;return-1}B2f(a,b){if(!a||0>b)return-1;let c=b;c=c?this.XIc(a,c-1):-1;c=c>Ja.a.EDa(a,b-1)?c:Ja.a.EDa(a,b-1);c++;return c}t2f(a,b,c){if(!I.a.instance.ga(70))return null;this.eYb(b);if(!this.nib[b])if(b=ej.H8f(b),0<b){if(this.eYb(b),!this.nib[b])return null}else return null;if(c&&this.jKb[b]&&Array.contains(this.jKb[b],a+c))return null;c=this.nib[b][Ja.a.vg(a)];if("string"!==typeof c||c===
a)return null;if(c){var f=this.zPi(a);if(0>f||this.Ktg(Ja.a.charAt(a,f)))return c;b=!0;for(f+=1;f<a.length;++f){const l=Ja.a.charAt(a,f);b&&!this.jae(l)&&(b=!1)}return b?Ja.a.vC(c):Ja.a.vC(Ja.a.substring(c,0,1))+Ja.a.right(c,1)}return null}HPi(a,b,c,f){Me.a.mark(4666);const l=this.DZi(b).LCID;let w=0,F=a;const S=b.innerText;if(this.n8d(S.substring(S.lastIndexOf(" ",a)+1,a)))return Me.a.mark(4667),null;let fa=null;var xa=!1;do{F=F?this.XIc(S,F-1):-1;if(-1===F&&!c){xa=b;var Za=null;if(!this.X7d(S.charAt(0))){do{for(;xa&&
!xa.previousSibling;)xa=xa.parentNode;xa&&(xa=xa.previousSibling,Za=xa.innerText)}while(xa&&!Za);if(xa&&Za&&!this.X7d(Ja.a.charAt(Za,Za.length-1)))return Me.a.mark(4667),null}xa=!0}Za=Ja.a.substring(S,F+1,a);++w;var pb=this.t2f(Za,l,f.toString());if(pb)fa=ys.mP(b,F+1,a,pb,this.Vg);else for(pb=0;pb<this.d1a.length;++pb){const Mb=this.d1a[pb];if(!(Mb.flags&1&&!(c&&1>F)||Mb.flags&4||Mb.flags&2&&" "!==f)){const hc=Mb.pattern.exec(Za);if(hc){fa=Mb.Sqj(b,F+1,a,hc,this.Vg,this.Da);break}}}}while(!xa&&!fa&&
w<fn.hRg&&0<=F);Me.a.mark(4667);return fa}DPi(a,b,c){const f=a.node;let l=db.ParagraphReader.text(f);0>b&&(b=a.Qa);a=this.ZXd(a).LCID;if(this.n8d(l.substring(Ja.a.EDa(l,b)+1,b)))return null;var w=-1,F=fb.HyperlinkReader.o_b(f);for(var S=0;S<F.length;S++)if(b>F[S].Lb)w=F[S].Lb;else{if(b>F[S].Qa)return null;break}F=null;S=(S=b)?this.XIc(l,S-1):-1;S<w&&(S=w-1);w=Ja.a.substring(l,S+1,b);w=w.trimStart();if(1>S)for(let fa=0;fa<this.d1a.length;++fa){const xa=this.d1a[fa];let Za=l;" "!==c&&(Za=l+c);if(xa.pattern.exec(Za))return null}l=
l.substring(0,b);if(!this.RDj(l,c.toString(),w,a))return null;w.charAt(0).toUpperCase()!==w.charAt(0)&&(F=qy.EB(f,S+1,b,this.Vg,this.KC,I.a.instance.ga(14),this.PC));return F}Y1f(a,b,c){a=fd.SelectionFactory.oj(a,!1);if(!a)return null;a=a.We;return Cb.SelectionEditor.Mg(a)?this.DPi(a,b,c):null}n8d(a){return Ja.a.C7(a)}XUd(a,b,c,f){Me.a.mark(4666);const l=a.node,w=this.ZXd(a).LCID,F=db.ParagraphReader.text(l);0>b&&(b=a.Qa);if(c&&!this.X7d(Ja.a.charAt(F,b))||this.n8d(F.substring(Ja.a.EDa(F,b)+1,b)))return Me.a.mark(4667),
null;a=-1;c=fb.HyperlinkReader.o_b(l);for(var S=0;S<c.length;S++)if(b>c[S].Lb)a=c[S].Lb;else{if(b>c[S].Qa)return null;break}c=0;S=b;let fa=null;do{S=S?this.XIc(F,S-1):-1;S<a&&(S=a-1);const Za=Ja.a.substring(F,S+1,b);++c;var xa=this.t2f(Za,w,null);if(xa)this.XQ.keb&&(fa=ys.EB(l,S+1,b,xa,this.Vg));else for(xa=0;xa<this.d1a.length;++xa){const pb=this.d1a[xa];if(!(pb.flags&1&&!(1>S)||pb.flags&4&&f!==x.a.Xp||pb.flags&2&&f!==x.a.wO)){const Mb=pb.pattern.exec(Za);if(Mb){fa=pb.Mgj(l,S+1,b,Mb,this.Vg,this.Da);
if(fa.commandId!==D.a.rTb&&!this.XQ.keb||fa.commandId===D.a.rTb&&!this.XQ.Qhc)fa=null;break}}}}while(0<=S&&S>=a&&!fa&&c<fn.hRg);Me.a.mark(4667);return fa}X1f(a,b,c){a=fd.SelectionFactory.oj(a,!1);if(!a)return null;a=a.We;return Cb.SelectionEditor.Mg(a)?this.XUd(a,b,!1,c):null}d2f(a,b){a=fd.SelectionFactory.oj(a,!1);if(!a)return null;a=a.We;if(!Cb.SelectionEditor.Mg(a)||fb.HyperlinkReader.Qia(a,!1))return null;var c=db.ParagraphReader.text(a.node);const f=0<b?Ja.a.EDa(c,b-1)+1:Ja.a.EDa(c,c.length-
1)+1;b=0<b?b:c.length;c=Ja.a.substring(c,f,b);return!c||this.s4e&&!fb.HyperlinkReader.rae(c)||!Ja.a.C7(c)&&!Ja.a.h3b(c)||!fn.hyperlinkEditor.KLk(a,f,b)?null:this.Urc.fwi(a.node,f,b)}h2f(a,b){var c=fd.SelectionFactory.oj(a,!1);if(!c)return null;var f=c.We;if(!Cb.SelectionEditor.Mg(f))return null;0>b&&(b=f.Qa);var l=db.ParagraphReader.text(f.node);c=this.B2f(l,b);const w=fn.XId.length;for(let F=0;F<w;++F){const S=l.lastIndexOf(Ja.a.charAt(fn.XId,F),b-1);S>c&&(c=S+1)}l=Ja.a.substring(l,c,b);if(!l)return null;
f=this.ZXd(f).LCID;return(new Er(l,f)).HHj()?Sp.EB(a,c,b,this.Vg):null}W1f(a,b){var c=fd.SelectionFactory.oj(a,!1);if(!c)return null;c=c.We;if(!Cb.SelectionEditor.Mg(c))return null;0>b&&(b=c.Qa);var f=db.ParagraphReader.text(c.node);c=this.B2f(f,b);f=Ja.a.substring(f,c,b);return f?(f=(new mq(f)).OSi())?IA.EB(a,c,b,f,this.Vg):null:null}kQi(a,b,c,f,l){var w=fd.SelectionFactory.oj(a,!1);if(!w)return null;w=w.We;if(c>b||!Cb.SelectionEditor.Mg(w))return null;0>b&&(b=w.Qa);if(0>b)return null;w=db.ParagraphReader.text(w.node);
return Mw.EB(a,c,l,b?w.charAt(b-1):"\x00",this.Vg,f)}Aza(a,b,c,f){Array.add(this.d1a,new GF("^"+a+"$",b,c,f))}vre(a){if(this.nib[this.coa]){const b=this.nib[this.coa];for(let c in a)b[c]=a[c]}else this.nib[this.coa]=a}wre(a){this.jKb[this.coa]?Array.addRange(this.jKb[this.coa],a):this.jKb[this.coa]=a}DEe(){this.coa=-1}VId(){this.HJi(this.coa);this.coa=-1}jRj(a,b){this.Bod[b]||(this.Bod[b]=!0,this.coa=b,b=document.createElement("script"),b.type="text/javascript",b.src=a,b.setAttribute("onload","ResetListLcid();"),
b.setAttribute("onerror","AutoCorrectRulesFallbackLogic();"),document.body.appendChild(b))}HJi(a){a=ej.H8f(a);0<a&&this.eYb(a)}tRj(){I.a.instance.ga(70)&&(this.eYb(1033),this.Aza("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",pl.mP,pl.EB,5),this.Aza("(\\d+)\\.",Kw.mP,Kw.EB,3),this.Aza("(L|l|C|c|D|d|M|m){1}\\.",Bt.mP,Bt.EB,3),this.Aza("^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\\.",Lw.mP,Lw.EB,11),this.Aza("([A-Za-z]){1}\\.",Bt.mP,Bt.EB,3),this.Aza("[\\*|-]",Qp.mP,Qp.EB,3),this.Aza("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",
Jw.mP,Jw.EB,0),this.Kqc&&(this.Aza("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",At.mP,At.EB,0),this.Aza("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",At.mP,At.EB,0)))}eYb(a){this.Bod[a]||this.jRj(py.a.lbi(String.format("Acl/Acl{0}.js",a)),a)}static get hyperlinkEditor(){return fn.Tm||(fn.Tm=lb.a.instance.resolve("Box4.IHyperlinkEditor"))}}fn.MId=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";fn.XId=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";
fn.cHe=".!?";fn.hRg=5;fn.Tm=null;Object(e.a)(fn,"AutoCorrectRules",null,[822]);class JA{constructor(a,b,c,f,l,w){this.foa=this.rE=null;this.tJ=a;this.Rc=b;this.ld=c;this.SVe=f.ka("AutoCorrectFirstLetterUpperCaseEnabled");this.VVe=f.ka("AutoFormatOrdinalNumberAndFractionsEnabled");this.l1=f.ka("ReplaceQuoteWithSmartQuoteIsEnabled");this.daa=l;this.Exa=!!w;this.ls=w;this.TRh=new wr.a;this.Exa&&this.Rc.VJ(Object(C.a)(this,this.dCb,"onSetSelectionFinished"))}Jmc(a,b,c=-1){if(this.daa.keb||this.daa.Qhc)if(b=
this.tJ.d2f(a,c)||this.tJ.X1f(a,c,b))this.rE||(this.rE=new Qe),this.rE.ya(b);this.SVe&&this.daa.jCc&&(b=this.tJ.Y1f(a,c," "))&&(this.rE||(this.rE=new Qe),0<this.rE.IDa&&(this.rE.Xqa(0).Dw=!0,b.jBb=!1),this.rE.ya(b));this.VVe&&(this.daa.Tcd&&4!==gb.App.mode&&(b=this.tJ.h2f(a,c))&&(this.rE||(this.rE=new Qe),this.rE.ya(b),Z.ULS.sendTraceTag(8271383,324,50,"Ordinal number autoformat action is created.")),this.daa.Rcd&&(a=this.tJ.W1f(a,c))&&(this.rE||(this.rE=new Qe),this.rE.ya(a),Z.ULS.sendTraceTag(8271384,
324,50,"Fractions autoformat action is created.")))}LQf(a,b,c,f,l,w){const F=new Qe;if(0<b){if(!this.SVe&&this.daa.keb){var S=this.tJ.HPi(c,f,l,w);S&&F.ya(S)}else{if(this.daa.keb||this.daa.Qhc)if(S=0," "===w&&(S=x.a.wO),S=this.tJ.X1f(a,b,S))S.Dw=!0,F.ya(S);this.daa.jCc&&(S=this.tJ.Y1f(a,b,w))&&(0<F.IDa&&(S.jBb=!1),F.ya(S))}this.VVe&&(this.daa.Tcd&&4!==gb.App.mode&&(S=this.tJ.h2f(a,b))&&(F.ya(S),Z.ULS.sendTraceTag(8704786,324,50,"Ordinal number autoformat action is created.")),this.daa.Rcd&&(S=this.tJ.W1f(a,
b))&&(F.ya(S),Z.ULS.sendTraceTag(8271385,324,50,"Fractions autoformat action is created.")))}0<=b&&("'"===w||'"'===w)&&this.l1&&this.daa.ZDe&&(S=this.tJ.kQi(a,b,c,f,w))&&(F.ya(S),Z.ULS.sendTraceTag(37363807,324,50,"Smart quote action is created."));for(let fa of this.TRh.values)if((S=fa.LQf(a,b,c,f,l,w))&&!S.isEmpty())for(let xa=0;xa<S.IDa;xa++)F.ya(S.Xqa(xa));return F}Wqe(a,b){return this.tJ.d2f(a,b)}Vgh(a){this.rE||(this.rE=new Qe);this.rE.ya(a)}Zyj(a){if(this.rE){var b=!1;for(var c=0;c<this.rE.IDa;c++){var f=
this.rE.Xqa(c);if(!f)return;if(!f.osg){b=!0;break}}if(b){b=this.foa=null;c=new Oe.GraphTransaction(15);c.fd=a;a=!1;for(f=0;f<this.rE.IDa;f++){let l=this.rE.Xqa(f);if(!l)return;if(l.osg)continue;this.Exa&&l.Dw&&l.fxg&&(b=l);a||(a=!0,c.hd(l.Ofg));l.kb=this.Rc.Pa.kb;const w=this.ld.zp(l.commandId);l.invoke();w.end();this.Rc.setSelection(l.kb)}this.rE=null;this.foa=b?b.commandId:null;a&&c.dispose()}}}$yj(a){this.foa=null;const b=new Oe.GraphTransaction(15);b.hd(a.Ofg);b.fd=a.commandId;a.kb=this.Rc.Pa.kb;
const c=this.ld.zp(a.commandId);a.invoke();c.end();this.Rc.setSelection(a.kb);this.Exa&&a.Dw&&a.fxg&&(this.foa=a.commandId);b.dispose()}azj(a){this.foa=null;return a.invoke()}rpj(){return this.Exa&&!!this.foa}lfk(a){if(!this.Exa||!this.foa)return!1;const b=this.foa;this.foa=null;if(!a||!this.ls.vV||this.ls.PPd!==b)return!1;this.ls.undo();return!0}dCb(){this.foa=null}}Object(e.a)(JA,"AutoCorrectScheduler",null,[600]);class Fr extends io{constructor(a,b,c,f,l,w){super(a,b,c,f,l);this.Eif=this.c1=null;
this.lU=l;this.Yc=w}get s7(){return this.c1||(this.c1=lb.a.instance.qb("Box4.IInternalLinkManager"))}get e4g(){return this.Eif||(this.Eif=lb.a.instance.qb("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"))}get Dw(){return!0}get commandId(){return D.a.PId}K6(a){Me.a.mark(7012);const b=new Oe.GraphTransaction(15);b.hd(a);var c=this.mF,f=this.X3,l=db.ParagraphReader.text(a),w=l.substring(c,f);const F=({fcc:S}=Ja.a.aNe(w)).returnValue;w!==F&&(c+=S,f=c+F.length);w=Fc.a.createTextRange(a,c,f);var S=
l.substring(c,f);Fr.EFj(l,c,f)&&(this.lU.replaceTextRange(Fc.a.createTextRange(a,c-1,f+1),S,!0,!1),--c,--f,w=Fc.a.createTextRange(a,c,f),c=fd.SelectionFactory.Lg(a,f),dd.a.instance.setSelection(c));c=fb.HyperlinkReader.bCa(S);Fr.hyperlinkEditor.iha(w,c,!1);l=S="";f=!1;this.s7&&({uah:S,dTi:l}=this.s7.Bwh(c,!0)).returnValue&&(c=S,f=!0,S=fb.HyperlinkReader.HB(w,!1),Fr.hyperlinkEditor.jO(S[0].paragraph,S[0].hyperlink),""!==l&&(this.lU.replaceTextRange(w,l,!0,!1),w=Fc.a.createTextRange(a,this.mF,this.mF+
l.length),a=fd.SelectionFactory.Lg(a,this.mF+this.mF+l.length),dd.a.instance.setSelection(a)),Fr.hyperlinkEditor.iha(w,c,!1));b.dispose();!f&&this.e4g&&this.e4g.KAl(w,c);Me.a.mark(7013)}set Dw(a){super.Dw=a}static get hyperlinkEditor(){return Fr.Tm||(Fr.Tm=lb.a.instance.resolve("Box4.IHyperlinkEditor"))}static EFj(a,b,c){c=c!==a.length&&('"'===a.charAt(c)||"\u201d"===a.charAt(c));return!!b&&('"'===a.charAt(b-1)||"\u201c"===a.charAt(b-1))&&c}}Fr.Tm=null;Object(e.a)(Fr,"HyperlinkAction",io,[]);class KA{constructor(a,
b){this.Vg=a;this.Yc=b}fwi(a,b,c){return new Fr(null,a,b,c,this.Vg,this.Yc)}}Object(e.a)(KA,"Factory",null,[599]);class LA{constructor(){this.Ea=null}get name(){return"Box4.AutoCorrect"}Yb(a){this.Ea=a;a.register(fn,"Box4.AutoCorrect.AutoCorrectRules").as("Box4.IAutoCorrectRules").ma().na(()=>new fn(a.resolve("Box4.IHyperlinkActionFactory"),a.resolve("Box4.ICharacterPropertiesEditor"),Rf.a.instance,u.AFrameworkApplication.Va,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance));
a.register(HA,"Box4.AutoCorrect.AutoCorrectOptionsInfo").as("Box4.IAutoCorrectOptionsInfo").ma().na(()=>new HA(a.resolve("Box4.IRoamingServiceRequestManager"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(JA,"Box4.AutoCorrect.AutoCorrectScheduler").as("Box4.IAutoCorrectScheduler").ma().na(()=>new JA(a.resolve("Box4.IAutoCorrectRules"),dd.a.instance,cd.a.instance,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?
a.resolve("Box4.IUndoManager"):null));a.register(KA,"Box4.AutoCorrect.HyperlinkAction.Factory").as("Box4.IHyperlinkActionFactory").ma().na(()=>new KA(a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance))}init(){this.Ea.resolve("Box4.IAutoCorrectRules").tRj();const a=u.AFrameworkApplication.fa;a.ka("AutoCorrectOptionSettingIsEnabledForWordOnline")&&a.ka("IsRoamingServiceEnabled")&&this.Ea.resolve("Box4.IAutoCorrectOptionsInfo").tWi()}dispose(){}static main(){m.a.instance.Ec(new LA)}}
Object(e.a)(LA,"Box4AutoCorrectPackage",null,[2,3]);class MA{get name(){return"Box4.Clipboard"}init(){}dispose(){}Yb(){}static main(){m.a.instance.Ec(new MA)}}Object(e.a)(MA,"Box4ClipboardPackage",null,[2,3]);var NA=d(571),Nw=d(488),Uo=d(316);class Gr{}Gr.fontSize=0;Gr.bold=!1;Gr.italic=!1;Gr.spacing=0;Object(e.a)(Gr,"DefaultTextCharPropertyBag",null,[]);class OA{constructor(a,b,c,f,l,w,F,S){this.BWc=[ob.a.fontColor,zb.a.Xqb];this.$_c=[ob.a.fm,ob.a.font,zb.a.autonumberBulletType,ob.a.qSa,Kd.a.oSa];
this.$1j=[new Nw.a(zb.a.TV,zb.a.Iw),new Nw.a(zb.a.lja,zb.a.gca),new Nw.a(zb.a.kja,zb.a.fca)];this.gUa=a;this.FN=b;this.i9b=c;this.ij=f;this.CTa=l;this.Q8b=w;this.Ib=F;this.Fa=S}kob(a){return this.TKd(a,-1)}$Bc(a){return this.TKd(a,1)}TKd(a,b){return mb.GraphIterator.jba(()=>this.Q8b?Md.OutlineElementReader.Tg(a)&&!a.o1b(14)&&a.o1b(12)&&!this.sFj(a)&&this.AKf(a,b):yc.ListReader.$j(a)&&this.AKf(a,b))}sFj(a){return(a=this.Fa.$m(a.currentNode))?a.bja:!1}AKf(a,b){return mb.GraphIterator.jba(()=>{const c=
a.currentNode.ta(Sb.a.listLevel,qg.a.zCa)+b;if(0>c||c>=Uo.a.s6||!this.FN.wP(a,c))return!1;this.Q8b||(lc.OutlineElementNavigator.ti(a),lc.OutlineElementNavigator.Ke(a));return!0})}Fdb(a,b){this.d1g(a,b)}cGc(a,b){this.d1g(a,b)}d1g(a,b){if(this.TKd(a,b)&&(this.Q8b||yc.ListReader.$j(a))){var c=a.yb(2);a.yc();(new mb.GraphIterator).Pc(a);const f=a.currentNode.ta(Sb.a.listLevel,qg.a.zCa);(0>f||f>=Uo.a.s6)&&za.a.J(8959444,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} is out of bounds",
f);(0>f+b||f+b>=Uo.a.s6)&&za.a.J(8959447,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} + depth-{1} is out of bounds",f,b);const l=this.FN.wP(a,f),w=this.FN.wP(a,f+b);if(l&&w){a.currentNode.setValue(Sb.a.listLevel,f+b);c.setValue(Sb.a.listLevel,f+b);for(b=0;b<c.Ra.length;b++)c.Ra.ga(b).formatting&&c.Ra.ga(b).formatting.C6d();this.A5h(c,l,w);this.s5h(c,l,w);this.x5h(c,l,w);c=a.yb(4);a.yc();c&&this.m5h(c,l,w)}}}s5h(a,b,c){b=c.ta(ob.a.fontSize,Gr.fontSize)-b.ta(ob.a.fontSize,
Gr.fontSize);a.Sa(ob.a.fontSize)&&a.setValue(ob.a.fontSize,a.getValue(ob.a.fontSize)+b);for(c=0;c<a.Ra.length;++c){const f=a.Ra.ga(c);f||za.a.J(8959450,820,10,"OutlineElementIndentationEditor::AdjustFontSizeBasedOnIndentLevel - paraNode.CharacterProperties[{0}] is null",c);if(f&&f.formatting&&f.formatting.rz&&f.formatting.rz.Sa(ob.a.fontSize)){const l=f.formatting.rz.getValue(ob.a.fontSize);this.ij.rr(f.formatting,l+b)}}this.CTa&&this.CTa.Sa(ob.a.fontSize)&&(a=this.CTa.fontSize(),this.CTa.rr(a+b))}A5h(a,
b,c){if(a.Sa(Sb.a.Hl)){var f=a.getValue(Sb.a.Hl);let l=b.ta(Sb.a.Hl,qg.a.leftMargin),w=c.ta(Sb.a.Hl,qg.a.leftMargin);const F=this.Fa.$m(a);F&&!F.rd&&(l=b.ta(zb.a.QWb,qg.a.leftMargin),w=c.ta(zb.a.QWb,qg.a.leftMargin));f=f+w-l;0>f&&a.setValue(Sb.a.Jn,a.ta(Sb.a.Jn,qg.a.indent)+f);this.gUa.Qu.Ffd(a,1,f)}this.pIc(a,b,Sb.a.Jn)&&this.RPc(a,c,Sb.a.Jn)}x5h(a,b,c){for(const f of this.$1j)this.pIc(a,b,f.first,f.second)&&this.RPc(a,c,f.first,f.second)}m5h(a,b,c){if(this.pIc(a,b,ob.a.fm,ob.a.font)){if(0===this.i9b.bsb(a)&&
a.ta(zb.a.autonumberBulletType,8)!==b.ta(zb.a.autonumberBulletType,8))return;if(c.ta(ob.a.fm,null))this.i9b.LUb(a),a.Kn.apply(a,this.$_c),this.RPc.apply(this,[a,c].concat(this.$_c));else{const f=this.Ib.Jc(a);f.oc(11);f.Hi()}}for(const f of this.BWc)this.pIc(a,b,f)&&(a.removeProperty(f),this.RPc(a,c,f))}pIc(a,b,...c){for(const f of c)if(a.Sa(f)||b.Sa(f))if(!a.Sa(f)||!b.Sa(f)||!NA.APropertySet.nWa(f.type,a.Uh(f),b.Uh(f)))return!1;return!0}RPc(a,b,...c){for(const f of c)b.Sa(f)&&a.ke(f,b.Uh(f))}}Object(e.a)(OA,
"OutlineElementIndentationEditor",null,[829]);var ry=d(151);class sp{constructor(a,b){this.Go=this.Yc=this.Vs=null;this.Eo=b;sp.Pg=a}get dr(){return this.Eo.value}get insertionPointFormatting(){return this.Vs||(this.Vs=lb.a.instance.qb("Box4.IInsertionPointFormatting"))}get Mf(){return this.Yc||(this.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get e5(){return this.Go||(this.Go=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}Q0d(a){const b=
a.node;var c=this.insertionPointFormatting?this.insertionPointFormatting.J6f():null;if(c&&!c.equals(Fa.a.nil)){a=b.Eh;if(!a)return null;c=a.te(c);if(!c||c&&1!==Mc.StyleReader.yra(c))return null}else c=Ab.a.xs(a),c=Ab.a.yrb(c);return c}V9(a,b,c){if(db.ParagraphReader.Pd(b))if(a)if(Mc.StyleReader.cUc(a))if(2!==Mc.StyleReader.yra(a))Z.ULS.shipAssertTag(7467991,324,!1);else{var f=Mc.StyleReader.rK(b);if(f){var l=Mc.StyleReader.BP(a);if(!l)Z.ULS.shipAssertTag(7467993,324,!1);else if(f.mG(l)){l=null;this.Mf.Zf&&
b.Z6();c||(l=this.dr.rFk(l),sp.paragraphEditor.MUb(b,!0));this.gnc(b,f);I.a.instance.ga(61)||(a=f.mG(Mc.StyleReader.BP(a)));b.properties.setValue(ne.a.paragraphStyle,a.id);b.UT=a;for(c=0;c<b.Ra.length;c++)b.Ra.ga(c).formatting&&b.Ra.ga(c).formatting.C6d();sp.GVc.zXb(a)&&(l||(l=new mb.GraphIterator,l.set(b),l.af(),lc.OutlineElementNavigator.Ke(l)),yc.ListReader.$j(l)||(b.Kn(Sb.a.Hl,Sb.a.ova,Sb.a.Jn,Sb.a.NGa,Sb.a.Vdc,Sb.a.G1g),this.FHd(l,a)))}}else Z.ULS.shipAssertTag(7467992,324,!1)}else Z.ULS.shipAssertTag(7467990,
324,!1);else Z.ULS.shipAssertTag(7467989,324,!1);else Z.ULS.shipAssertTag(7467988,324,!1)}FHd(){}WCc(a,b=!1){let c;c=lg.c(a)?lg.d(a)?Mc.StyleReader.rK(a).mG(Mc.StyleReader.nid):Mc.StyleReader.rK(a).mG(Mc.StyleReader.qid):Mc.StyleReader.rK(a).mG(I.a.instance.ga(61)?Mc.StyleReader.AJa:Mc.StyleReader.Yma);this.V9(c,a,b)}KIe(a,b){const c=Mc.StyleReader.rK(b);c&&c.mG(Mc.StyleReader.BP(a))&&(this.gnc(b,c),this.insertionPointFormatting&&(this.insertionPointFormatting.UWa(),this.insertionPointFormatting.nea(a,
b)))}gnc(a,b){return(a=sp.Gl.iBb(a))?b.e3k(a):!1}static get paragraphEditor(){return sp.tw||(sp.tw=lb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){sp.tw=a}static get GVc(){return sp.Pg||(sp.Pg=lb.a.instance.resolve("Box4.List.IListReader"))}static get Gl(){return ry.PageNavigator.instance}}sp.tw=null;sp.Pg=null;Object(e.a)(sp,"StyleEditor",null,[828]);class Qq{static W1d(){return Qq.DWj}static h0f(a){return new Fa.a(a,1)}static bQf(a){a=a.toString();a=a.split("-")[0]+
"-0000-0000-0000-000000000000";return xg.a.ig(a)}}Qq.DWj=[zb.a.pva,zb.a.cellId,zb.a.rowId,zb.a.shapeId];Object(e.a)(Qq,"TransformHelper",null,[]);class PA{constructor(a,b){this.zWc=new sp(a,b);this.Jz=a;this.FN=b.value}Q0d(a){return this.zWc.Q0d(a)}KIe(a,b){this.zWc.KIe(a,b)}V9(a,b){const c=new mb.GraphIterator;c.set(b);c.uv();c.yc();sm.d(a,c.currentNode,[Sb.a.listLevel]);sm.d(a,b,[ob.a.pl,ob.a.qI,Sb.a.Jn,Sb.a.Hl,zb.a.Iw,zb.a.TV,zb.a.lja,zb.a.gca,zb.a.kja,zb.a.fca]);if(this.Jz.zXb(a)&&!yc.ListReader.$j(c)){a=
hk.a.vAa(a,a);const f=hk.a.bV(a.listType,a.listStyle);f.Zz=a.Zz;a.propertySet.Sa(ob.a.fm)&&f.propertySet.setValue(ob.a.fm,a.propertySet.getValue(ob.a.fm));a.propertySet.Sa(ob.a.font)&&f.propertySet.setValue(ob.a.font,a.propertySet.getValue(ob.a.font));a.propertySet.Sa(zb.a.autonumberBulletType)&&f.propertySet.setValue(zb.a.autonumberBulletType,a.propertySet.getValue(zb.a.autonumberBulletType));this.FN.N2a(c,f,!1,!1,0);a=c.yb(4);sm.b(b,a,Qq.W1d());c.yc()}}WCc(a,b=!1){this.zWc.WCc(a,b)}gnc(a,b){return this.zWc.gnc(a,
b)}}Object(e.a)(PA,"StyleEditor",null,[828]);class QA{constructor(a){this.VFg=a;this.VFg.qpa(Object(C.a)(this,this.FVa,"onBeforeValidatePersistence"))}dispose(){this.VFg.Dhc(Object(C.a)(this,this.FVa,"onBeforeValidatePersistence"))}FVa(a,b){10!==b.node.type&&60!==b.node.type||b.node.bAh()}}Object(e.a)(QA,"LockableGraphNodeEditBehavior",null,[109]);class RA{constructor(a){this.zac=a}kMi(a){const b=a.parentNode.getValue(zb.a.shapeId),c=a.parentNode.getValue(zb.a.pva);let f=null,l=null;const w=Object(ua.a)(5,
a.currentNode);w&&w.Nr()&&(f=a.parentNode.getValue(zb.a.rowId),l=a.parentNode.getValue(zb.a.cellId));this.qIe(a.currentNode,b,c,f,l)}qIe(a,b,c,f,l){a.ke(zb.a.shapeId,b);a.ke(zb.a.pva,c);l&&(a.ke(zb.a.rowId,f),a.ke(zb.a.cellId,l))}}Object(e.a)(RA,"PptCreateParagraphStrategy",null,[824]);var mP=d(29);class SA{constructor(a){this.Ow=a;this.Ow.qpa(Object(C.a)(this,this.FVa,"onBeforeValidatePersistence"))}dispose(){this.Ow.Dhc(Object(C.a)(this,this.FVa,"onBeforeValidatePersistence"))}FVa(a,b){Kc.a.Db&&
(a=Kc.a.Db,a.ur&&Kc.a.Zda(Kc.a.Db),b.revisionId&&(b=Kc.a.u6a(b.revisionId.toString()),"ReplicateOutbound"===a.actionName?Z.ULS.sendTraceTag(41714057,305,50,"Refuse to override RevisionId for ReplicateOutbound. RevisionId={0}; StackTrace={1}",b.toString(),mP.Debug.qt()):a.fB(lh.a.mX,b.toString())))}}Object(e.a)(SA,"PresentationNodeEditBehavior",null,[109]);class TA{fjc(a,b,c){let f;({value:f}=a.Nf(b)).returnValue||(f=new Ua.a,a.$(b,f));f.add(c)}Wkd(a,b,c,f){if(a.count)for(let l of a)l&&l!==Fa.a.nil&&
(a=b.rMc(l,Fa.a.nil),a=f.ga(a))&&(b.$(l,a),this.fjc(c,a,l))}Skd(a,b,c){a.Kb(b)&&Fa.a.dP(a.ga(b),c)&&a.remove(b)}}Object(e.a)(TA,"GraphHotColdHelper",null,[598]);var Rq=d(202),sy;(function(a){a[a.presentation=0]="presentation";a[a.slide=1]="slide";a[a.slideChildren=2]="slideChildren";a[a.shapeLevel=3]="shapeLevel"})(sy||(sy={}));Object(e.b)("GraphNodeModificationType",sy);class HF{constructor(a,b,c,f,l,w){this.jUa=a;this.Ska=b;this.Pka=c;this.fT=f;this.jQ=l;this.Yka=w;this.Y9b=Fa.a.nil}zF(a){return!!a&&
(7===a.type||68===a.type)}Lcc(a,b){this.jUa.$(a.id,b);this.Yka.wse(b)?this.Y9b=a.id:this.jQ.fjc(this.fT,b,a.id)}LSe(a){if(this.Y9b&&this.Y9b!==Fa.a.nil){let b;this.jQ.Wkd((b=new Ua.a,b.add(this.Y9b),b),this.jUa,this.fT,a);this.Y9b=Fa.a.nil}}bCb(a,b){this.jQ.Skd(this.jUa,a,b)}Zra(a){return this.jUa.Kb(a.id)}DV(a){return this.Zra(a)||0<this.Ska.count||0<this.Pka.count}}Object(e.a)(HF,"PresentationHotColdHandler",null,[631,596]);class IF extends Sys.EventArgs{constructor(a,b){super();this.revisionId=
a;this.node=b}}Object(e.a)(IF,"RevisionPersistArgs",Sys.EventArgs,[]);var JF=d(877);class KF{constructor(a,b,c,f,l,w,F){this.iua=a;this.Pka=b;this.fT=c;this.jQ=f;this.Yka=l;this.uc=w;this.Fa=F;this.Y0c=new Ua.a;this.sFa=new Ua.a}zF(a){return!!a&&(10===a.type||60===a.type||39===a.type)}Lcc(a,b){let c=a;const f=this.uc.Sg(a);60!==a.type&&39!==a.type&&(c=this.Fa.$m(a));f&&c&&(this.Pka.$(c.id,b),this.iua.$(f.id,b),this.Yka.wse(b)?(this.Y0c.contains(c.id)||this.Y0c.add(c.id),this.sFa.contains(f.id)||this.sFa.add(f.id)):
(this.jQ.fjc(this.fT,b,c.id),this.jQ.fjc(this.fT,b,f.id)))}LSe(a){this.jQ.Wkd(this.Y0c,this.Pka,this.fT,a);this.jQ.Wkd(this.sFa,this.iua,this.fT,a);this.Y0c.clear();this.sFa.clear()}bCb(a,b){this.jQ.Skd(this.Pka,a,b);this.jQ.Skd(this.iua,a,b)}Zra(a){return this.zF(a)&&this.Pka.Kb(a.id)}DV(a){return this.Zra(a)}}Object(e.a)(KF,"ShapeLevelHotColdHandler",null,[631,596]);class LF{constructor(a,b,c,f,l){this.Ska=a;this.iua=b;this.fT=c;this.jQ=f;this.Yka=l;this.sFa=new Ua.a}zF(a){return!!a&&8===a.type}Lcc(a,
b){this.Ska.$(a.id,b);this.Yka.wse(b)&&!this.sFa.contains(a.id)?this.sFa.add(a.id):this.jQ.fjc(this.fT,b,a.id)}LSe(a){this.jQ.Wkd(this.sFa,this.Ska,this.fT,a);this.sFa.clear()}bCb(a,b){this.jQ.Skd(this.Ska,a,b)}Zra(a){return this.Ska.Kb(a.id)}DV(a){return this.Zra(a)||this.pBj(a)}pBj(a){return this.iua.Kb(a.id)}}Object(e.a)(LF,"SlideHotColdHandler",null,[631,596]);class ty{constructor(a,b,c,f,l,w,F,S,fa,xa=null,Za=null,pb=null){this.fl=this.fT=this.Pka=this.iua=this.Ska=this.jUa=null;this.uc=a;this.Fa=
b;this.Oc=c;this.Pr=f;this.jQ=l;this.Ow=w;this.Vme=!1;this.SZ=F;this.ua=S;this.Yka=fa;this.Pr.Mzc(Object(C.a)(this,this.Z7c,"onRevisionProcessedOnServerHandler"));this.Pr.I4h(Object(C.a)(this,this.X6c,"onGraphNodePersistHandler"));this.Ow.qpa(Object(C.a)(this,this.X6c,"onGraphNodePersistHandler"));this.Oc.wB(Object(C.a)(this,this.ZA,"onSessionEnd"));this.Oc.x1h(Object(C.a)(this,this.fXg,"onFailoverHandler"));this.Oc.xB(Object(C.a)(this,this.eo,"onSessionRehydrated"));this.initialize(xa,Za,pb);this.vTa=
new Ie.a}reset(){this.initialize();this.Pr.T8g(new JF.a(null));this.Rxh()}initialize(a=null,b=null,c=null){a||this.Q4i();this.fT=b||new Ie.a;this.fl=c||this.Tha()}fXg(){this.reset()}Z7c(a,b){b&&(a=b.L9)&&this.Hve(a)}X6c(a,b){this.Lcc(b.node,b.revisionId)}Lcc(a,b){if(!this.Vme&&(a.isDirty||10===a.type||60===a.type||39===a.type))for(const c of this.fl)if(c.zF(a)){c.Lcc(a,b);this.Pr.SBk(new IF(b,a));break}}Hve(a){const b=Fa.a.ig(a.Id),c=this.fT.ga(b);if(c&&c.count){for(let f of c)for(const l of this.fl)l.bCb(f,
b);this.fT.remove(b);this.Pr.T8g(new JF.a(a));this.Rxh()}}wHi(){const a={},b=ty.Bwj(a);b(0,this.jUa);b(1,this.Ska);b(2,this.iua);b(3,this.Pka);va.a.isEmpty(a)||za.a.J(21112097,811,50,va.a.toJSON(a))}DV(a){for(const b of this.fl)if(b.zF(a))return b.DV(a);return!1}Zra(a){for(const b of this.fl)if(b.zF(a))return b.Zra(a);return!1}ZAh(a){if(0<a.count)for(const b of this.fl)b.LSe(a)}dispose(){this.Oc.aea(Object(C.a)(this,this.ZA,"onSessionEnd"));this.Oc.xMk(Object(C.a)(this,this.fXg,"onFailoverHandler"));
this.Ow.Dhc(Object(C.a)(this,this.X6c,"onGraphNodePersistHandler"));this.Pr.ech(Object(C.a)(this,this.Z7c,"onRevisionProcessedOnServerHandler"));this.Pr.AOk(Object(C.a)(this,this.X6c,"onGraphNodePersistHandler"));this.Oc.cea(Object(C.a)(this,this.eo,"onSessionRehydrated"));this.vTa&&0<this.vTa.count&&za.a.J(22153251,822,15,String.format("Disposed with {0} listening node",this.vTa.count))}ZA(){this.Vme=!0;this.wHi();this.reset()}eo(){this.ua.presentation.JEe();this.reset();this.Vme=!1;this.SZ.lHa(new Bf.a("SessionRehydrated"))}Tha(){return[new KF(this.iua,
this.Pka,this.fT,this.jQ,this.Yka,this.uc,this.Fa),new LF(this.Ska,this.iua,this.fT,this.jQ,this.Yka),new HF(this.jUa,this.Ska,this.Pka,this.fT,this.jQ,this.Yka)]}Q4i(){this.jUa=new Ie.a;this.Ska=new Ie.a;this.iua=new Ie.a;this.Pka=new Ie.a}pXb(a,b){var c=Object(ua.a)(594,a);c.Hra+=1;({value:c}=this.vTa.Nf(b.id)).returnValue||(c=new Ua.a,this.vTa.add(b.id,c));c.add(a)}Rxh(){if(this.vTa.count&&this.ua.presentation&&this.ua.presentation.Eh){var a=this.ua.presentation.Eh;this.vTa.forEach((b,c)=>{if(!this.Zra(Object(ua.a)(9,
a.te(b)))){for(let f of c)if(c=Object(ua.a)(594,f))--c.Hra,this.Cub(c)&&(this.SZ.lHa(new Bf.a("SessionRehydrated")),this.Xcd(f));this.vTa.remove(b)}return!0})}}Cub(a){return a?!a.Hra&&!a.Kha:!1}Xcd(a){var b=Object(ua.a)(594,a);a&&b&&(b=+new Date-+b.bha,12E4<b&&za.a.J(22153281,822,15,String.format("{0} been blocked {1}",a.type,b)))}static Bwj(a){return(b,c)=>{c=Rq.b(c.values.toArray(),f=>f.toString());c.length&&(a[sy[b]]=c)}}}Object(e.a)(ty,"GraphHotColdManager",null,[595,596,109,597]);class UA{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.GraphEditor"}Yb(a){this.K=a;this.K.register(QA,"PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").ma().na(()=>new QA(this.K.resolve("Box4.Graph.IGraphInstance").tPa));this.K.register(SA,"PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").ma().na(()=>new SA(this.K.resolve("Box4.Graph.IGraphInstance").Cd(7)));this.K.register(OA,"PowerPointWebEditor.OutlineElementIndentationEditor").as("Box4.IOutlineElementIndentationEditor").na(()=>
new OA(this.K.resolve("Box4.IParagraphEditor"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IListInfoHelper"),this.K.resolve("Box4.IFormattingEditor"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").isPromoteDemoteOnParagraphEnabled,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(PA,"PowerPointWebEditor.StyleEditor").as("Box4.Styles.IStyleEditor").ma().na(()=>
new PA(this.K.resolve("Box4.List.IListReader"),this.K.qe("Box4.List.IListEditor")));this.K.register(TA,"PowerPointWebEditor.GraphHotColdHelper").as("PowerPointWebEditor.IGraphHotColdHelper").na(()=>new TA);this.K.register(ty,"PowerPointWebEditor.GraphHotColdManager").as("PowerPointWebEditor.IGraphHotColdManager").as("PowerPointWebEditor.IGraphBlockContentHandler").ma().na(()=>new ty(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdHelper"),a.resolve("Box4.Graph.IGraphInstance").tPa,a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader")));this.K.register(RA,"PowerPointWebEditor.PptCreateParagraphStrategy").as("Box4.ICreateParagraphStrategy").ma().na(()=>new RA(this.K.resolve("Box4.ITableCellReader")))}init(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior");
this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior");this.K.resolve("PowerPointWebEditor.IGraphHotColdManager");this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager").addHandler(this.K.resolve("PowerPointWebEditor.IGraphBlockContentHandler"))}dispose(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").dispose();this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").dispose()}static main(){m.a.instance.Ec(new UA)}}
Object(e.a)(UA,"PPTWebEditorGraphEditorPackage",null,[2,3]);var nP=d(752),uy=d(754),oP=d(753),ko=d(444);const MF=a=>{a.element.style.top=""};var av=d(763);class NF{constructor(a,b,c){this.g6=!1;this.iKa=0;this.kfa=this.zff=null;this.wR=a;this.XUh=b;this.Mn=c;this.IO=a.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.e1=!!u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.rDa)&&!this.Mn.EGc&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");
this.htmlElement.id="WACBusinessBar";r.a.ag&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.IO}get visible(){return this.g6}set_visible(a){if(this.g6!==a)return(this.g6=a)?this.GId():this.cXb(),a}dispose(){this.visible&&this.cXb();ya.a.$za(this.htmlElement);this.wR=this.IO=null}Coh(a,b){const c=a.htmlElement||a.createElement();b===this.htmlElement.childNodes.length?this.htmlElement.appendChild(c):this.htmlElement.insertBefore(c,this.htmlElement.childNodes[b]);
a.teh();this.iKa+=a.htmlElement.clientHeight;var f=this.htmlElement.childNodes,l=a.DDf,w=Object(C.a)(this,this.Hek,"onAfterShowEntry");ko.WacAirSpace.tXa(c,"Shared_BasicClass");var F=new oP.a(c);F.QSb(0,1);const S=new uy.a(c);S.RSb(c.clientTop-30,c.clientTop);l?(ko.WacAirSpace.qVa(F,null,null),ko.WacAirSpace.qVa(S,null,w)):(ko.WacAirSpace.animate(F,null,null),ko.WacAirSpace.animate(S,null,w));for(b+=1;b<f.length;b++)w=f[b],ko.WacAirSpace.tXa(w,"Shared_BasicClass"),F=new uy.a(w),F.RSb(w.clientTop-
c.clientHeight,w.clientTop),l?ko.WacAirSpace.qVa(F,null,null):ko.WacAirSpace.animate(F,null,null);a.K9k();this.set_visible(!0)}Yig(a){const b=a.htmlElement;if(ya.a.rRa(b)){this.iKa-=a.htmlElement.clientHeight;var c=b.parentNode.children;a=a.DDf;var f=Object(C.a)(this,this.Cek,"onAfterHideEntry");ko.WacAirSpace.tXa(b,"Shared_BasicClass");var l=new nP.a(b);l.QSb(1,0);a?ko.WacAirSpace.qVa(l,null,f):ko.WacAirSpace.animate(l,null,f);f=!1;for(l=0;l<c.length;l++){if(f){const w=c[l];ko.WacAirSpace.tXa(w,
"Shared_BasicClass");const F=new uy.a(w);F.RSb(w.clientTop,-b.clientHeight);a?ko.WacAirSpace.qVa(F,null,MF):ko.WacAirSpace.animate(F,null,MF)}f||c[l]!==b||(f=!0)}}}Hek(a){a.element.style.top="";u.AFrameworkApplication.Ba.Mq()}Cek(a){a.element.parentNode.removeChild(a.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);u.AFrameworkApplication.Ba.Mq()}GId(){""===this.wR.style.top.trim()&&(this.wR.style.top=this.wR.offsetTop+"px");this.htmlElement.style.left=this.wR.style.left;this.htmlElement.style.top=
this.wR.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var a=Sys.UI.DomElement.getBounds(this.htmlElement);this.zff=this.wR.style.top;this.iKa=a.height;this.Qld();u.AFrameworkApplication.Ba.Aga(Object(C.a)(this,this.onResize,"onResize"));ad.a.addHandler(this.htmlElement,ra.a.Ded,ad.a.lob);this.kfa=Object(C.a)(this,this.CB,"contextMenuHandler");u.AFrameworkApplication.Ba.e$.pb(this.htmlElement,this.kfa,null);if(v.FocusManager.ZL()){var b=v.FocusManager.instance();
a=b.Bc(av.a.g3a);a.parent=y.AFrame.kj;const c=new ou.DOMFocusListing(()=>this.htmlElement);c.ho(1);c.ho(2);c.ho(8);b.Sga(()=>this.htmlElement,a,c);b=b.AP(av.a.g3a);b.beb();b.CS=!0;b.GNa=!0;const f=u.AFrameworkApplication.Ba.iw;a.u2a(()=>{f.ap(av.a.g3a)});f.kpa(av.a.g3a);(c.Jha||u.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled"))&&f.SJ(av.a.g3a)}}cXb(){this.goh()&&(this.wR.style.top=this.zff);this.htmlElement.style.visibility="hidden";u.AFrameworkApplication.Ba&&(v.FocusManager.ZL()&&v.FocusManager.instance().kEb(av.a.g3a),
this.kfa&&(u.AFrameworkApplication.Ba.e$.zb(this.htmlElement,this.kfa),this.kfa=null));ad.a.removeHandler(this.htmlElement,ra.a.Ded,ad.a.lob)}Qld(){if(this.goh()&&this.visible){var a=this.wR,b=this.iKa+this.XUh;const c=ya.a.wL(a.style.top);ko.WacAirSpace.tXa(a,"Shared_BasicClass");a=new uy.a(a);a.RSb(c,b);ko.WacAirSpace.animate(a,null,null)}}goh(){return!this.e1&&!this.Mn.EGc}onResize(){const a=this.Mn.entries.length,b=Sys.UI.DomElement.getBounds(this.htmlElement).height;let c;for(let f=0;f<a;++f)c=
this.Mn.entries[f],c.htmlElement&&c.teh();this.iKa=Sys.UI.DomElement.getBounds(this.htmlElement).height;b!==this.iKa&&this.Qld()}CB(){return!0}}Object(e.a)(NF,"BusinessBarDom",null,[465,109]);var Ct;(function(a){a[a.none=0]="none";a[a.corruptPage=1]="corruptPage";a[a.currentPageStatus=2]="currentPageStatus";a[a.documentMarkedAsFinal=3]="documentMarkedAsFinal";a[a.documentSigned=4]="documentSigned";a[a.fileAccess=5]="fileAccess";a[a.kickoutWithDataLoss=6]="kickoutWithDataLoss";a[a.lostSession=7]="lostSession";
a[a.malformedHyperlinkUris=8]="malformedHyperlinkUris";a[a.odt=9]="odt";a[a.readonlyRecommended=10]="readonlyRecommended";a[a.saveReplaySuccess=11]="saveReplaySuccess";a[a.saveReplayFailed=12]="saveReplayFailed";a[a.unsupportedObjects=13]="unsupportedObjects";a[a.word11Compat=14]="word11Compat";a[a.unsupportedBrowser=15]="unsupportedBrowser";a[a.applicationNotification=16]="applicationNotification";a[a.skypeDocChatFailed=17]="skypeDocChatFailed";a[a.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";
a[a.sessionExpired=19]="sessionExpired";a[a.irmPolicyDescription=20]="irmPolicyDescription";a[a.policyWarningMessage=21]="policyWarningMessage";a[a.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";a[a.gdprPrivacyNotice=23]="gdprPrivacyNotice";a[a.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";a[a.graphMergePrompt=25]="graphMergePrompt";a[a.readOnlyDocument=26]="readOnlyDocument";a[a.dictationSilence=27]="dictationSilence";a[a.autoSensitivityLabel=28]="autoSensitivityLabel";
a[a.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";a[a.dictationDebugInfo=30]="dictationDebugInfo";a[a.oneNoteCovid19Message=31]="oneNoteCovid19Message";a[a.citationStylePrompt=32]="citationStylePrompt";a[a.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";a[a.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";a[a.oneNotePagePrintReady=35]="oneNotePagePrintReady";a[a.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";a[a.mandatoryLabel=37]="mandatoryLabel";
a[a.policyTip=38]="policyTip";a[a.minorVersionLimit=39]="minorVersionLimit";a[a.testEntry1=40]="testEntry1";a[a.testEntry2=41]="testEntry2";a[a.testEntry3=42]="testEntry3";a[a.testEntry4=43]="testEntry4";a[a.testEntry5=44]="testEntry5";a[a.testEntry6=45]="testEntry6";a[a.testEntry7=46]="testEntry7"})(Ct||(Ct={}));Object(e.b)("BusinessBarId",Ct);class nq{constructor(a,b=0,c=null,f=null){this.V9e=this.B_e=!1;this.Qkb=null;this.FO=[];this.Jxa=f||new NF(a,b,this);this.Wvj(c)}Wvj(a){if(a){this.Qkb={};
a=a.ranking;for(let b=0;b<a.length;b++)this.Qkb[Ct[a[b]]]=b}}dispose(){this.Jxa.dispose();Dn.a.jed(this.FO);this.FO=null}get htmlElement(){return this.Jxa.htmlElement}get visible(){return this.Jxa.visible}get EGc(){return this.B_e}set EGc(a){this.B_e=a}get $9d(){return this.V9e}set $9d(a){this.V9e=a}get entries(){return this.FO}set entries(a){this.FO=a}Tba(a){for(let b=0;b<this.FO.length;b++)if(this.FO[b].id===a)return!0;return!1}ai(a,b=!1,c=null){a.businessBar=this;let f=this.R2i(a.id);b&&!this.Qkb&&
(f=0);f<nq.acb&&(this.Jxa.Coh(a,f),this.FO.length>=nq.acb&&this.Jxa.Yig(this.FO[nq.acb-1]),this.Jxa.Qld());Array.insert(this.FO,f,a);Z.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Ct[a.id],void 0===a.kAa||null===a.kAa?"":a.kAa);a.errorCode&&u.AFrameworkApplication.zo(a.errorCode,c,null,null)}removeEntry(a){const b=Array.indexOf(this.FO,a);-1!==b&&b<nq.acb&&(this.FO.length>nq.acb&&this.Jxa.Coh(this.FO[nq.acb],nq.acb),this.Jxa.Yig(a),this.Jxa.Qld());Array.remove(this.FO,
a);a.businessBar=null;a.dispose()}R2i(a){if(!this.Qkb||0===a)return this.FO.length;a=this.Qkb[Ct[a]];if(void 0===a||null===a)return this.FO.length;for(let b=0;b<this.FO.length;b++)if(a<this.Qkb[Ct[this.FO[b].id]])return b;return this.FO.length}}nq.acb=2;Object(e.a)(nq,"BusinessBar",null,[445,109,446]);class VA{constructor(a){this.xFc=null;this.RUg=a.Ia("OfficeOnlineChromeExtensionId");this.$Ug=a.Ia("ChromeClipboardAccessExtensionId");this.ZAj=a.ka("OfficeOnlineChromeExtensionIsEnabled");this.Rtf=
!this.vHj();this.xFc=this.rwa?this.$Ug:this.RUg}pLc(){return this.xFc}AEe(){this.xFc===this.RUg&&this.Etg&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.xFc=this.$Ug;this.Rtf=!0}get rwa(){return this.Rtf}vHj(){if(this.ZAj&&this.Etg){var a=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(a&&"true"===a)return a=localStorage.getItem("IsCopyPasteSupported"),!!a&&"true"===a}return!1}get Etg(){let a=!1;try{localStorage.setItem("LocalStorageAccessiblityTest",
"LocalStorageAccessiblityTest"),a="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(b){Z.ULS.sendTraceTag(19452045,307,50,b.toString())}return a}}Object(e.a)(VA,"ChromeExtensionHelper",null,[575]);class OF{constructor(a=null,b=null,c=null){this.i$=a||{};this.uwh=b||[];this.vml=c||{}}}Object(e.a)(OF,"RibbonTrimmingProperties",null,[]);var pP=d(449);class PF{create(a,b,c){return new pP.a(a,b,c)}}Object(e.a)(PF,
"Factory",null,[463]);class QF{constructor(){u.AFrameworkApplication.Va.ya(G.a.Cyg,de.a.frame,Object(C.a)(this,this.EEk,"reactFileMenuOpenFromTellMe"))}EEk(a,b,c,f,l){if(1===c||!l)return 32;a=l.SourceControlId;17!==l.UILocation||"New"!==a&&"Open"!==a||(l=[],Pg.d("setFileMenuSelectedPage")&&("New"===a&&u.AFrameworkApplication.Ba?2===u.AFrameworkApplication.Ba.jb.vm?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===
a&&u.AFrameworkApplication.Ba&&(2===u.AFrameworkApplication.Ba.jb.vm?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),l.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(l));return 32}HPj(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}}Object(e.a)(QF,"ReactFileMenu",null,[850]);class RF{createFileMenu(){const a=new QF,b=[];b.push(appChrome.actions.updateFileMenuExpandedValue(!1));
b.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(b);return a}}Object(e.a)(RF,"ReactFileMenuFactory",null,[832]);var Uh=d(523);class SF{constructor(a,b,c,f,l,w,F){this.GEa=!1;this.Fz=null;this.aka=this.k3c=this.OTa=!1;this.Cxb="Edit";this.gNg=!1;this.hc=f;this.ia=a;this.$u=b;this.Rb=l;this.nm=F;this.Rb.aP(Object(C.a)(this,this.a5c,"modeSwitched"));this.Ha=c;this.wb()}wb(){this.ia.ya(aa.a.Lak,de.a.frame,Object(C.a)(this,this.Mak,"modeSwitcherHandler"));this.ia.ya(aa.a.Iid,
de.a.frame,Object(C.a)(this,this.Iid,"switchToDocumentEditMode"));this.ia.ya(aa.a.mlc,de.a.frame,Object(C.a)(this,this.mlc,"switchToEmergencyViewMode"));this.ia.ya(aa.a.Jid,de.a.frame,Object(C.a)(this,this.Jid,"switchToDocumentViewMode"));this.ia.ra(aa.a.L7g,de.a.frame,Object(C.a)(this,this.T6g,"queryDocumentModeSwitchMenuItem"),96);this.ia.ra(aa.a.M7g,de.a.frame,Object(C.a)(this,this.T6g,"queryDocumentModeSwitchMenuItem"),96);this.ia.ya(aa.a.PAa,$b.a.application,Object(C.a)(this,this.PAa,"displayCallout"));
this.ia.ya(G.a.Ssh,de.a.frame,Object(C.a)(this,this.hgl,"switchFromViewModeToEditMode"))}dispose(){this.Rb.Q_(Object(C.a)(this,this.a5c,"modeSwitched"))}Fe(){}Mak(){return 32}Jid(a,b,c){if(1===c||"View"===this.S5a())return 32;this.$u.$sh();this.Ued("View");this.k3c=!0;return 32}Iid(a,b,c){if(u.AFrameworkApplication.SP)return 8;a=this.S5a();if(1===c){if("Edit"===a||this.GEa||this.k3c||this.OTa&&this.hc.getState(1))return 32;Z.ULS.sendTraceTag(572004381,306,10,"ModeSwitcherControlActor:SwitchToDocumentEditMode:: DocModeSwitcher Editing Option Disabled");
return 8}if("Edit"===a)return 32;this.$u.U3k();c=this.OTa?this.ia.Ma(aa.a.HXb,2,20):this.ia.processAction(aa.a.N0b,2);this.GEa=this.OTa=this.k3c=!1;this.Ued("Edit");return c}hgl(a,b,c){if(u.AFrameworkApplication.SP)return 8;a=this.S5a();if(1===c){if("Edit"===a||this.GEa||this.k3c||this.OTa&&this.hc.getState(1))return 32;Z.ULS.sendTraceTag(538469281,306,10,"ModeSwitcherControlActor:SwitchFromViewModeToEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;if(2!==c)return Z.ULS.sendTraceTag(538469282,
306,15,String.format("Unexpected ActionBehavior {0} for switching to edit mode",c)),2;this.ia.Ma(aa.a.refresh,2,{refreshtrigger:"SwitchFromViewModeToEditMode"});return 32}mlc(a,b,c){if(1===c)return 32;this.GEa=!0;return this.initialize()}T6g(a,b,c,f,l){b=this.S5a();l[Uh.a.On]=a===aa.a.L7g&&"Edit"===b||a===aa.a.M7g&&"View"===b?!0:!1;return 32}PAa(a,b,c,f,l){if(!l||!Object(Ca.a)(vn,l))return 8;this.Fz=l;this.initialize();this.nm&&!this.gNg&&"View"===this.Cxb&&(this.nm.rQe(),this.gNg=!0);return this.initialize()}initialize(){if(!Pg.c())return Z.ULS.sendTraceTag(578351571,
306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - AppChrome Actions being Null"),8;this.Cxb=this.Y9f();!this.aka&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.S5a()!==this.Cxb&&Z.ULS.sendTraceTag(527016896,306,50,"ModeSwitcher was initially rendered in the incorrect mode. Expected: {0}, Actual: {1}",this.Cxb,this.S5a());var a=this.Fz?this.Fz.g3b||this.Fz.k3b:!1,b=this.Fz?this.Fz.zRa:this.hc.getState(16);
this.OTa=this.Fz?this.Fz.j9d:this.hc.getState(524288);var c=this.Fz?this.Fz.a7a:this.hc.getState(1);const f=this.GEa||a||this.OTa||b||!c,l={hidden:!1};l.hasEditPermission=c;l.activeMode=this.Cxb;l.isMarkedAsFinal=b;l.isMarkedAsOpenReadOnly=this.OTa;l.isReviewer=!1;l.isServiceDefaultedToView=this.GEa||a;l.forceShowNotificationByExternalTrigger=this.Fz&&this.Fz.NRc?!this.Fz.NRc:f;a&&(a={},c={},c.title=ResourceStrings.L_BizBarTitle_Readonly,this.Fz.g3b?c.text=ResourceStrings.L_BizBarMessage_PasswordProtected:
this.Fz.k3b&&(c.text=ResourceStrings.L_BizBarMessage_FileFormatNotEditable),c.confirmationButtonText=ResourceStrings.L_InsertTableDialogButtonText,c.icon="pptEditorSprite.CancelGlyph_16",c.label=ResourceStrings.L_Close,a.serviceDefaultedToViewCallout=c,l.notificationCalloutProps=a);a=appChrome.actions.updateModeSwitcher(l);if(!a)return Z.ULS.sendTraceTag(578351572,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - Redux Action being Null"),8;Z.ULS.sendTraceTag(573690506,
306,50,"ModeSwitcherControlActor:Initialize:: Dispatching Mode switcher action. ActionDataAvailable:{0}, HasEditPerm: {1}, Mode:{2}, MarkedFinal: {3}, MarkedOpenRO: {4}, EditProtected: {5}, FormatUnsupported: {6}, EmergencyMode: {7}, InReadingMode: {8}",!!this.Fz,l.hasEditPermission,this.Cxb,b,this.OTa,!!this.Fz&&this.Fz.g3b,!!this.Fz&&this.Fz.k3b,this.GEa,this.jqg());b=this.sRd(a);this.aka=!0;return b}sRd(a){if(appChrome.api)return appChrome.api.dispatch(a),32;Z.ULS.sendTraceTag(578351570,306,10,
"ModeSwitcherControlActor:DispatchAction:: Failed to Initialize DocModeSwitcher - PPT App Chrome API being Null");return 8}jqg(){return!!u.AFrameworkApplication.Ba&&1===u.AFrameworkApplication.Ba.mode}Y9f(){return this.Fz?this.GEa||this.Fz.zRa||this.Fz.j9d||this.Fz.g3b||this.Fz.k3b||this.Fz.NRc?"View":this.Fz.a7a?"Edit":"View":this.GEa||this.jqg()?"View":"Edit"}S5a(){if(Pg.c())switch(appChrome.selectors.getModeSwitcherMode()){case null:case "Edit":break;case "View":return"View";default:Z.ULS.sendTraceTag(589325726,
306,15,"ModeSwitcherControlActor:GetCurrentDocumentMode:: ModeSwitcher Actor received an invalid active mode from the control.")}return"Edit"}Ued(a){if(Pg.c()&&this.S5a()!==a){var b={};b.activeMode=a;Z.ULS.sendTraceTag(589325725,306,50,"ModeSwitcherControlActor:SendUpdateModeReduxAction:: ModeSwitcher control switching to mode {0}",a);a=appChrome.actions.updateModeSwitcher(b);this.sRd(a)}}a5c(a){this.aka&&(1===a.mode?this.Ued("View"):2===a.mode&&this.Ued("Edit"))}MOk(){const a={hidden:!1};a.activeMode=
this.Y9f();this.sRd(appChrome.actions.updateModeSwitcher(a))}static get hk(){return $u.PageReader.instance}}Object(e.a)(SF,"ModeSwitcherControlActor",null,[543]);var TF=d(249);class WA{constructor(a,b,c,f){this.lza=this.u1e=this.Fkb=this.h_e=this.mKa=this.tYe=null;this.Exf=!1;this.Mn=a;this.VX=b;this.Da=c;this.mb=f}jsk(){this.zUb();this.AUb();this.cki()}zUb(){const a=gb.App.Fb.Fd.Gi;a&&(this.tYe=this.Rld(this.tYe,1,2===gb.App.Fb.mode&&a.nRc,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get hNj(){if(!gb.App.Xyh)return!1;
r.a.IV&&u.AFrameworkApplication.Pj("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled");return r.a.rj}cki(){this.hNj&&!this.Fkb&&(this.Fkb=this.VX.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.Fkb.id=15,this.Fkb.closeable=!0,this.Fkb.addButton(Box4Intl.Box4Strings.L_DownloadNow,E.AppFrame.$pl,""),qf.a("NewBrowserSuggestionShown"),this.Mn.ai(this.Fkb,!1))}AUb(){let a=null;const b=gb.App.Fb.Fd.taa;if(b){const c=b.Jdc;TF.a.T2b(c)?22===c?a=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:
19===c||20===c?a=r.a.Ji?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===c?a=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===c?a=r.a.Ji?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===c&&(a=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):2!==gb.App.Fb.mode||TF.a.QOc(b.VRb)||gb.App.h4b||(a=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.u1e=this.Rld(this.u1e,5,!!a,a)}V3k(a){!!this.lza===
a||this.Exf||(a?(this.lza=this.VX.create("",Box4Intl.Box4Strings.l_BusinessBarUnsupportedObjectsOnPage,null),this.lza.id=13,this.lza.closeable=!0,this.lza.G1=()=>{this.Exf=!0;this.lza=null},this.Mn.ai(this.lza)):(this.Mn.removeEntry(this.lza),this.lza=null))}Ioh(a,b,c,f){a=this.VX.create(null,a,null);a.closeable=!0;a.id=23;a.image=3;a.KAf(b,()=>{id.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+c)});f&&(a.G1=f);this.Mn.ai(a,!0)}c$k(a,b,c){this.Ioh(a,b,c,null)}A9k(a){a=this.VX.create(null,
a,null);a.closeable=!0;a.id=24;a.image=1;this.Mn.ai(a,!0)}o$k(a){a=this.VX.create(null,a,null);a.closeable=!0;a.id=20;this.Mn.ai(a)}G9k(){var a=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.mKa||(this.mKa=this.VX.create(a,b,null),this.mKa.closeable=!0,this.mKa.id=27,this.Mn.ai(this.mKa))}Wpj(){this.mKa&&(this.mKa=this.Rld(this.mKa,27,!1,""))}NKe(a){this.h_e=this.Rld(this.h_e,30,!0,a)}Rld(a,b,c,f){c?a?a.message=f:(a=this.VX.create("",
f,null),a.id=b,a.closeable=!1,this.Mn.ai(a,!1)):a&&(this.Mn.removeEntry(a),a=null);return a}}Object(e.a)(WA,"BusinessBarController",null,[831]);class XA extends WA{constructor(a,b,c,f,l,w,F,S){super(a,b,f,w);this.Fce=this.kGg=!1;this.u$b=[];this.fwb=0;this.coe=null;this.Ace=c;this.ia=f;this.h8=l;this.Ga=F;this.xD=S.Mia;this.LLg=S.powerPointDragInsertMultipleImageQuantityLimit}initialize(){this.Ace.aP(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched"))}dispose(){this.Ace.Q_(Object(C.a)(this,this.Mx,
"onAppFrameModeSwitched"))}Iu(a,...b){this.lXb.apply(this,[a,this.h8.KMc(a),this.h8.w1d(a),this.h8.WZd(a)].concat(b))}lXb(a,b,c,f){0===a||this.coe||(c=this.VX.create(c,f||"",null),c.closeable=!0,c.errorCode=kf.a.Fh(a),c.G1=Object(C.a)(this,this.bLi,"errorEntryClosedHandler"),a=!!(b&8),b=!!(b&4),a&&c.addButton(ResourceStrings.L_Refresh,Object(C.a)(this,this.Qbd,"refreshActionHandler"),""),b&&(a?c.QFd(ResourceStrings.L_OpenInPowerPoint,Object(C.a)(this,this.H8c,"openInClientActionHandler")):c.addButton(ResourceStrings.L_OpenInPowerPoint,
Object(C.a)(this,this.H8c,"openInClientActionHandler"),"")),this.coe=c,this.eSb(c))}OM(a){var b="";let c="",f=null,l="",w=null;var F=!1;switch(a){case 0:b=ResourceStrings.L_BizBarTitle_MarkedAsFinal;a=ResourceStrings.L_BizBarMessage_MarkedAsFinal;F=!0;break;case 20:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;F=!0;break;case 1:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_EditPermissionDenied;F=!0;break;case 2:b=
ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatNotEditable;F=!0;break;case 3:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditCheckedOutByAnother;F=!0;break;case 4:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_RequiresCheckout;F=!0;break;case 5:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_LockedForOfflineCheckout;F=!0;break;case 6:b=ResourceStrings.L_BizBarTitle_Readonly;
a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditLock;F=!0;break;case 7:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditSharedLock;F=!0;break;case 8:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_NumberOfCoauthorsReachedMax;F=!0;break;case 9:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditExistingExclusiveLock;F=!0;break;case 10:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatConvertible;
c=ResourceStrings.L_BizBarButton_Convert;f=Object(C.a)(this,this.msi,"convertActionHandler");F=!0;break;case 11:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PasswordProtected;F=!0;break;case 12:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FontRestricted;F=!0;break;case 13:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_SessionRestricted;F=!0;break;case 14:b=u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle?
u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle:"";a=u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription?u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription:"";F=!0;break;case 15:b=ResourceStrings.L_BizBarTitle_SessionExpired;a=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;F=!0;break;case 18:b=ResourceStrings.L_BizBarTitle_DragDropNotSupportFormat;a=ResourceStrings.L_BizBarMessage_DragDropNotSupportFormat;F=!1;break;case 19:b=String.format(ResourceStrings.L_BizBarTitle_DragDropMoreFilesThanLimite,
this.LLg);a=String.format(ResourceStrings.L_BizBarMessage_DragDropMoreFilesThanLimite,this.LLg);F=!1;break;case 22:b=ResourceStrings.L_BizBarTitle_Readonly;a=this.i$i();F=!1;a&&(this.fwb=a,a=this.ia.Ma(aa.a.WEb,1,this.fwb),8!==a&&16!==a&&(F=!0,c=ResourceStrings.L_BizBarInlineRepairSaveAsText,f=Object(C.a)(this,this.rPk,"repairSaveCopyHandler")));32===this.ia.processAction(aa.a.Rhc,1)&&(F?(l=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,w=Object(C.a)(this,this.adh,"replaceOriginalFileHandler")):
(F=!0,c=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,f=Object(C.a)(this,this.adh,"replaceOriginalFileHandler")));a=F?ResourceStrings.L_BizBarInlineRepairWithSaveMessage:ResourceStrings.L_BizBarInlineRepairWithoutSaveMessage;F=!0;break;case 23:b=ResourceStrings.L_BizBarTitle_ViewOnly;a=ResourceStrings.L_BizBarEmergencyViewingModeMessage2;c=ResourceStrings.L_BizBarEmergencyViewingModeEditButton;f=Object(C.a)(this,this.Agj,"goToEditModeHandler");F=!0;break;case 24:b=ResourceStrings.L_BizBarTitle_MinorVersionLimitReached;
a=ResourceStrings.L_BizBarInlineMinorVersionLimitReached;c=ResourceStrings.L_LearnMore;f=Object(C.a)(this,this.gok,"openVersioningPageHandler");break;case 25:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_UserNetworkLocationUnauthorized;break;case 26:a=ResourceStrings.L_BizBarMessage_CannotCropCurrentSelection;F=!1;break;default:return}b=this.VX.create(b,a,null);b.image=3;b.closeable=!0;b.G1=F?Object(C.a)(this,this.J9g,"readOnlyInfoEntryClosedHandler"):Object(C.a)(this,
this.Pkg,"infoEntryClosedHandler");f&&b.addButton(c,f,"");w&&b.QFd(l,w);this.eSb(b);F&&Array.add(this.u$b,b)}QAa(a){let b;switch(a){case 22:var c=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;b=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:c=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;b=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}c=this.VX.create(c,b,null);c.id=a;c.image=1;c.closeable=!0;this.eSb(c)}CGc(a,b){let c,f=!1,l=!1,w=!1,
F=!1;switch(a){case 1:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.L_BizBarMessage_EditPermissionDenied;b=1;break;case 0:a=ResourceStrings.L_BizBarTitle_MarkedAsFinal;c=b?ResourceStrings.L_BizBarMessage_MarkedAsFinal_DocIsEdited:ResourceStrings.L_BizBarMessage_MarkedAsFinal;l=b;b=1;break;case 20:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;w=!0;b=3;break;case 16:a=ResourceStrings.L_BizBarTitle_CannotConnectToInternet;c=ResourceStrings.L_BizBarMessage_CannotConnectToInternet;
f=!0;b=1;break;case 17:a=b?ResourceStrings.L_BizBarTitle_ChangesCannotBeSavedInThisFile:ResourceStrings.L_BizBarTitle_Readonly;c=b?ResourceStrings.L_BizBarMessage_ServerError_UserHasEditedDoc_Download:ResourceStrings.L_BizBarMessage_ServerError_UserNotEditedDoc;F=b;b=1;break;case 15:a=ResourceStrings.L_BizBarTitle_SessionExpired;c=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;f=!0;b=1;break;case 21:a=ResourceStrings.L_BizBarTitle_WopiTokenOutOfRefreshRange;c=ResourceStrings.L_BizBarMessage_WopiTokenOutOfRefreshRange;
f=!0;b=1;break;default:return}a=this.VX.create(a,c||"",null);a.closeable=!0;a.G1=Object(C.a)(this,this.J9g,"readOnlyInfoEntryClosedHandler");a.image=b;f?(za.a.J(37520129,801,15,"Refresh button is show"),a.addButton(ResourceStrings.L_Refresh,Object(C.a)(this,this.Qbd,"refreshActionHandler"),"")):l?(za.a.J(37520131,801,15,"SaveACopy button is show"),a.addButton(ResourceStrings.L_BizBarButton_SaveACopy,Object(C.a)(this,this.HUk,"saveAsActionHandler"),"")):F?(za.a.J(39978897,801,15,"DownloadACopy button is show"),
a.addButton(ResourceStrings.L_DownloadCopy,Object(C.a)(this,this.PGi,"downloadACopyActionHandler"),"")):w&&(za.a.J(38290691,801,15,"EditAnyway button is show"),a.addButton(ResourceStrings.l_BizBarButton_EditAnyway,Object(C.a)(this,this.CHi,"editAnywayActionHandler"),""));this.eSb(a);Array.add(this.u$b,a)}Tba(a){return this.Mn.Tba(a)}i$i(){let a=0;if(this.mb.ka("IsUIEmbedMode")||this.mb.ka("DisablePrint")||!this.mb.Ia("DownloadACopyUrl")||"true"===this.mb.Ia("ProtectInClient")||r.a.Ji)return a;let b=
!0;this.mb.ka("SaveToAnotherFolderBrsIsEnabled")&&this.mb.ka("SupportsGetMoreInfoForPersonalStorage")||(b=!1);let c=!0;this.mb.ka("SaveACopyBrsIsEnabled")||(c=!1);let f=!0;this.mb.ka("SaveAsToHostBrsIsEnabled")&&this.mb.ka("UserCanWriteRelative")&&this.mb.ka("SupportsEditing")||(f=!1);a=b?G.a.Jeb:c?G.a.Hic:a;za.a.J(50370196,801,(b||c)&&(b||f)&&(c||f)?15:50,"BusinessBarController::GetSaveAsCommand saveToSharePoint:{0}, saveACopy:{1}, saveAsToHost:{2}, CommandName: {3} ",b,c,f,a);return a}eSb(a){const b=
this.Mn.visible;this.Mn.ai(a);b||this.Ga.Kj(Ai.a.cKd,!0)}Qbd(a){za.a.J(37310492,801,15,"Refresh button is clicked, ErrorCode:{0}",a.errorCode);this.ia.processAction(aa.a.refresh,2)}Pkg(){this.Mn.entries.length||this.Ga.Kj(Ai.a.cKd,!1)}bLi(){this.coe=null;this.Mn.entries.length||this.Ga.Kj(Ai.a.cKd,!1)}J9g(a){Array.remove(this.u$b,a);this.Pkg(a);za.a.J(38290694,801,50,"Read-only info entry is closed")}H8c(){this.ia.Ma(aa.a.openInClient,2,!0)}msi(){this.ia.Ma(aa.a.convertAndEdit,2,!1)}rPk(){u.AFrameworkApplication.AL?
this.yLe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.Ma(aa.a.WEb,2,this.fwb)}adh(){this.ia.processAction(aa.a.Rhc,2)}Agj(){this.ia.processAction(aa.a.N0b,2)}HUk(){za.a.J(37310494,801,15,"SaveACopy button is clicked");u.AFrameworkApplication.AL?this.yLe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.Ma(G.a.Jeb,2,!0)}PGi(){za.a.J(39978903,801,15,"DownloadACopy button is clicked");u.AFrameworkApplication.AL?this.yLe(CommonUIStrings.l_SensitivityDownloadDocumentError):this.ia.Ma(G.a.downloadACopy,
2,!0)}yLe(a){za.a.J(50922395,801,50,"Unable to save/download ppt from business bar as document is protected");const b=new hf.StandardDialog;b.vd=0;b.Sx(kf.a.AGi,gk.a.e2(ResourceStrings.l_GenericDialogTitle),gk.a.e2(a),null)}CHi(){za.a.J(38290697,801,50,"EditAnyway button is clicked");this.ia.Ma(aa.a.HXb,2,20)}gok(){za.a.J(558470216,801,50,"Learn More button is clicked");k.Redirect.showHelp("0f6cd105-974f-44a4-aadb-43ac5bdfd247")}BLd(){if(this.Ace.Z6a&&!this.Fce&&!this.kGg){this.Fce=!0;var a=this.VX.create("",
CommonUIStrings.l_OdfFileCompatWarningBusinessBar,null);a.closeable=!0;a.G1=()=>{this.kGg=!0;this.Fce=!1};a.addButton(CommonUIStrings.l_OdfFileCompatWarningBusinessBarButton,Object(C.a)(this,this.agk,"onCompatWarningButtonClick"),"");this.eSb(a)}}agk(){k.Redirect.showHelp("PPTODF")}nWf(){for(const a of this.u$b)this.Mn.removeEntry(a);Array.clear(this.u$b)}Mx(a){this.xD&&2===a.mode&&this.nWf()}}Object(e.a)(XA,"BusinessBarController",WA,[830,831,109]);class UF{constructor(a,b,c,f){this.OSa=null;this.v3c=
b;this.D4j=c;this.xb=document.createElement("div");this.xb.className="BusinessBarPanel";this.xb.id="BusinessBarPanel";this.b_=f;this.gbc=document.createElement("div");this.gbc.id="BusinessBarPanelWorking";this.xb.insertBefore(this.gbc,this.xb.firstChild);a.execute(l=>{this.OSa=l;this.D4j&&this.OSa&&(this.OSa.EGc=!0);this.gbc.insertBefore(this.OSa.htmlElement,this.gbc.firstChild)});if(this.b_||this.v3c)this.xb.style.position=Fe.a.dlc}dispose(){}layout(a,b){if(!this.OSa||!this.OSa.visible)return this.Pu(),
a;this.wFi(b);if(this.v3c||this.b_)return this.xb.style.height=Ne.a.Nc(this.OSa.htmlElement.offsetHeight),a;b=a.wdl(this.OSa.htmlElement.offsetHeight);Ne.a.b0(this.xb,b);return a}Pu(){"none"!==this.xb.style.display&&(this.xb.style.display="none")}wFi(a){this.xb.style.display.length&&(this.xb.style.display="");a&&(this.xb.style.direction=Fe.a.oYa)}get za(){return this.xb}get Kyl(){return this.gbc}get order(){return 2}}Object(e.a)(UF,"BusinessBarPane",null,[547,454,109]);var Ow=d(559);class Vo{}Vo.Value=
"value";Vo.MinValue="MinValue";Vo.MaxValue="MaxValue";Vo.Text="Text";Object(e.a)(Vo,"SliderCommandProperties",null,[]);var Tp=d(1079);class Hr{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(e.a)(Hr,"CommonOptionalButtonProperties",null,[]);class bv extends Hr{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null}}Object(e.a)(bv,
"OptionalButtonProperties",Hr,[]);class VF extends bv{constructor(){super();this.animateTransition=!1}}Object(e.a)(VF,"AdditionalInkButtonProperties",bv,[]);class vy extends Hr{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(e.a)(vy,"OptionalFlyoutAnchorProperties",Hr,[]);class WF extends vy{constructor(){super();this.animateTransition=!1}}Object(e.a)(WF,
"AdditionalInkFlyoutAnchorProperties",vy,[]);class XF{constructor(){this.selected=!1;this.iconColor=null}}Object(e.a)(XF,"InkControlState",null,[]);class YF{constructor(){this.keytip=this.uCa=this.label=null}}Object(e.a)(YF,"InkFlyoutAnchorResources",null,[]);class zs{constructor(){this.gwb=[]}ya(a){this.gwb.push(a)}commit(){appChrome.api.dispatch(this.gwb);Array.clear(this.gwb)}}Object(e.a)(zs,"AppChromeTransaction",null,[]);class Wd{}Wd.MB="InkPen1";Wd.VE="InkPen2";Wd.UE="InkHighlighter";Wd.zia=
"InkRuler";Wd.C7a="InkColorPicker1";Wd.via="InkColorPicker2";Wd.DCa="InkColorPicker3";Wd.wia="InkColorPickerMRU1";Wd.xia="InkColorPickerMRU2";Wd.ECa="InkColorPickerMRU3";Wd.HCa="InkThicknessSlider1";Wd.ICa="InkThicknessSlider2";Wd.JCa="InkThicknessSlider3";Wd.FCa="InkDrawWithTouch";Wd.p7="InkEraser";Wd.q7="InkLasso";Wd.GCa="InkSelect";Wd.z3f="label";Wd.x3f="iconName";Wd.y3f="keytip";Wd.R5d=4;Object(e.a)(Wd,"InkRibbonManagerConstants",null,[]);class oq{constructor(a,b,c,f){this.bUa=this.dUa=this.cUa=
oq.BBc;this.l7=(l,w,F,S,fa)=>{if(1===F)return this.b$a?8:32;w=this.ota.ga(Wd.zia).selected;this.XLd(l===aa.a.Reb);F=new zs;if(this.TJe(this.L9d(fa)))switch(l){case aa.a.HGe:case aa.a.IGe:case aa.a.FGe:case aa.a.JGe:case aa.a.EGe:case aa.a.GGe:case aa.a.yGe:case aa.a.zGe:case aa.a.AGe:case aa.a.BGe:case aa.a.CGe:case aa.a.DGe:this.dJ(Wd.FCa,!0,!1,F,!1)}switch(l){case aa.a.HGe:this.dJ(Wd.MB,!0,!0,F,!0);this.ia.Ma(aa.a.MB,2,fa);this.KG=Wd.MB;break;case aa.a.BGe:this.dJ(Wd.MB,!0,!0,F,!0);this.dFb(Wd.MB,
this.yTa,Wd.via,[Wd.wia,Wd.xia],"#000000",fa,F);this.ia.Ma(aa.a.wia,2,fa);this.KG=Wd.MB;break;case aa.a.yGe:this.dJ(Wd.MB,!0,!0,F,!0);this.dFb(Wd.MB,this.yTa,Wd.via,[Wd.wia,Wd.xia],"#000000",fa,F);this.ia.Ma(aa.a.C7a,2,fa);this.KG=Wd.MB;break;case aa.a.IGe:this.dJ(Wd.VE,!0,!0,F,!0);this.ia.Ma(aa.a.VE,2,fa);this.KG=Wd.VE;break;case aa.a.CGe:this.dJ(Wd.VE,!0,!0,F,!0);this.dFb(Wd.VE,this.yTa,Wd.via,[Wd.wia,Wd.xia],"#e71224",fa,F);this.ia.Ma(aa.a.xia,2,fa);this.KG=Wd.VE;break;case aa.a.zGe:this.dFb(Wd.VE,
this.yTa,Wd.via,[Wd.wia,Wd.xia],"#e71224",fa,F);this.dJ(Wd.VE,!0,!0,F,!0);this.ia.Ma(aa.a.via,2,fa);this.KG=Wd.VE;break;case aa.a.FGe:this.dJ(Wd.UE,!0,!0,F,!0);this.ia.Ma(aa.a.UE,2,fa);this.KG=Wd.UE;break;case aa.a.DGe:this.dJ(Wd.UE,!0,!0,F,!0);this.dFb(Wd.UE,this.Fxb,Wd.DCa,[Wd.ECa],"#fffc00",fa,F);this.ia.Ma(aa.a.ECa,2,fa);this.KG=Wd.UE;break;case aa.a.AGe:this.dJ(Wd.UE,!0,!0,F,!0);this.dFb(Wd.UE,this.Fxb,Wd.DCa,[Wd.ECa],"#fffc00",fa,F);this.ia.Ma(aa.a.DCa,2,fa);this.KG=Wd.UE;break;case aa.a.EGe:this.dJ(Wd.p7,
!0,!1,F,!1);this.ia.Ma(aa.a.p7,2,fa);break;case aa.a.JGe:this.dJ(Wd.zia,!w,!1,F,!1);this.ia.Ma(aa.a.zia,2,fa);break;case aa.a.GGe:this.dJ(Wd.q7,!0,!1,F,!1);this.ia.Ma(aa.a.q7,2,fa);break;case aa.a.Reb:this.dJ(Wd.GCa,!0,!1,F,!1),this.dJ(Wd.FCa,!1,!1,F,!1),this.ia.processAction(aa.a.GCa,2)}F.commit();this.u1j&&Ow.ShyRibbon.tNa(1,2);return 32};this.ia=a;this.u1j=f;this.ota=new Bc.a;this.bka=new Bc.a;for(const l of oq.N5d){a="";switch(l){case Wd.MB:a="#000000";break;case Wd.VE:a="#E71224";break;case Wd.UE:a=
"#FFFC00"}this.ota.$(l,Object.assign(new XF,{selected:!1,iconColor:a}))}u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb&&u.AFrameworkApplication.Ba.jb.Ip&&this.wb();this.yTa=new Ua.a;this.yTa.add("#FFC114");this.yTa.add("#F6630D");this.yTa.add("#FF0066");this.yTa.add("#5B2D90");this.Fxb=new Ua.a;this.Fxb.add("#00F900");this.Fxb.add("#00FDFF");this.Fxb.add("#FF40FF");this.Fxb.add("#FF8517");this.KG=Wd.MB;b.qGd(Object(C.a)(this,this.pT,"onFocusChanged"));this.b$a=!c||!c.Mc}wb(){this.ia.ra(aa.a.O5d,
Db.a.application,Object(C.a)(this,this.IIi,"enableMRUPenAndDisableDrawWithTouch"),4);this.ia.ra(aa.a.Clg,Db.a.application,Object(C.a)(this,this.imj,"handleRefreshInkUIValues"),4);this.ia.ra(aa.a.bQc,Db.a.application,Object(C.a)(this,this.Kjj,"handleInkSetInkRibbonManagerDisabledState"),4);this.ia.ra(aa.a.HGe,Db.a.application,this.l7,4);this.ia.ra(aa.a.IGe,Db.a.application,this.l7,4);this.ia.ra(aa.a.FGe,Db.a.application,this.l7,4);this.ia.ra(aa.a.JGe,Db.a.application,this.l7,4);this.ia.ra(aa.a.yGe,
Db.a.application,this.l7,4);this.ia.ra(aa.a.zGe,Db.a.application,this.l7,4);this.ia.ra(aa.a.AGe,Db.a.application,this.l7,4);this.ia.ra(aa.a.BGe,Db.a.application,this.l7,4);this.ia.ra(aa.a.CGe,Db.a.application,this.l7,4);this.ia.ra(aa.a.DGe,Db.a.application,this.l7,4);this.ia.ra(aa.a.xhh,Db.a.application,Object(C.a)(this,this.Z2d,"handleThicknessSliderChanged"),4);this.ia.ra(aa.a.yhh,Db.a.application,Object(C.a)(this,this.Z2d,"handleThicknessSliderChanged"),4);this.ia.ra(aa.a.zhh,Db.a.application,
Object(C.a)(this,this.Z2d,"handleThicknessSliderChanged"),4);this.ia.ra(aa.a.whh,Db.a.application,Object(C.a)(this,this.Ijj,"handleInkDrawWithTouchSelected"),4);this.ia.ra(aa.a.EGe,Db.a.application,this.l7,4);this.ia.ra(aa.a.GGe,Db.a.application,this.l7,4);this.ia.ra(aa.a.Reb,Db.a.application,this.l7,4)}Kjj(a,b,c,f,l){if(1===c)return 32;this.b$a=l;return 32}imj(a,b,c){if(1===c)return 32;a=new zs;this.LFb(Wd.HCa,this.cUa,a);this.LFb(Wd.ICa,this.dUa,a);this.LFb(Wd.JCa,this.bUa,a);a.commit();this.bka.count||
this.IRj();return 32}Ijj(a,b,c,f,l){if(1===c)return this.b$a?8:32;a=l&&l.forceDisable?l.forceDisable:!1;this.ota.ga(Wd.FCa).selected||a?this.WVf():(this.XLd(!1),a=new zs,this.dJ(Wd.FCa,!0,!1,a,!1),this.dJ(this.KG,!0,!0,a,!0),a.commit(),this.ia.Ma(aa.a.M5d,2,{enable:!0}));return 32}Z2d(a,b,c,f,l){if(1===c)return 32;b=new zs;this.dJ(Wd.FCa,!0,!1,b,!1);l&&l&&(l[oq.acl]=Vo.Value);switch(a){case aa.a.xhh:this.ia.Ma(aa.a.HCa,2,l);this.cUa=this.D6a(l);this.LFb(Wd.HCa,this.cUa,b);this.KG=Wd.MB;break;case aa.a.yhh:this.ia.Ma(aa.a.ICa,
2,l);this.dUa=this.D6a(l);this.LFb(Wd.ICa,this.dUa,b);this.KG=Wd.VE;break;case aa.a.zhh:this.ia.Ma(aa.a.JCa,2,l),this.bUa=this.D6a(l),this.LFb(Wd.JCa,this.bUa,b),this.KG=Wd.UE}b.commit();return 32}isEnabled(a){return this.ota.ga(a).selected}IIi(a,b,c){if(1===c)return 32;if(!Pg.c())return za.a.J(512493019,801,15,"Ribbon should be initialized when calling EnableMRUPenAndDisableDrawWithTouch."),8;if(!this.bka.count)return 32;this.XLd(!1);this.WVf();this.ota.ga(this.KG).selected=!1;a=new zs;this.dJ(this.KG,
!0,!0,a,!0);this.ia.processAction(aa.a.Blg,2);a.commit();return 32}IRj(){for(const a of oq.N5d)switch(a){case Wd.MB:this.x5b(Wd.MB);break;case Wd.VE:this.x5b(Wd.VE);break;case Wd.UE:this.x5b(Wd.UE);break;case Wd.p7:this.x5b(Wd.p7);break;case Wd.q7:this.x5b(Wd.q7)}}x5b(a){const b=appChrome.selectors.getInkButtonState(a);this.bka.$(a,Object.assign(new YF,{label:Wd.z3f in b?Object(ua.a)(String,b[Wd.z3f]):"",uCa:Wd.x3f in b?Object(ua.a)(String,b[Wd.x3f]):"",keytip:Wd.y3f in b?Object(ua.a)(String,b[Wd.y3f]):
""}))}XLd(a){const b=new zs;for(const c of oq.N5d)if(c!==Wd.zia)switch(this.dJ(c,!1,!1,b,!0),c){case Wd.MB:this.Uob(Wd.MB,b,!0,a);break;case Wd.VE:this.Uob(Wd.VE,b,!0,a);break;case Wd.UE:this.Uob(Wd.UE,b,!0,a);break;case Wd.p7:this.Uob(Wd.p7,b,!0,a);break;case Wd.q7:this.Uob(Wd.q7,b,!0,a)}b.commit()}dBh(a,b,c){c.ya(appChrome.actions.toggleButton(a,b));this.ota.ga(a).selected=b}dJ(a,b,c,f,l){c?b?(b&&!this.ota.ga(a).selected&&this.coi(a,f,l),this.dBh(a,b,f)):this.Uob(a,f,l,a!==Wd.GCa):this.dBh(a,b,
f)}Uob(a,b,c,f){if(this.bka.Kb(a)){var l=this.bka.ga(a).uCa,w=this.bka.ga(a).keytip,F=this.bka.ga(a).label;a=appChrome.api.createInkButtonModel(a,F,Object.assign(new VF,{iconSet:(new Tp.a(l)).iconSet,iconColor:this.ota.ga(a).iconColor,keytip:w,animateTransition:c&&!f}));b.ya(appChrome.actions.addControls([a]))}}coi(a,b,c){if(this.bka.Kb(a)){var f=this.bka.ga(a).uCa,l=this.bka.ga(a).keytip,w=this.bka.ga(a).label;a=appChrome.api.createInkFlyoutAnchorModel(a,w,Object.assign(new WF,{iconSet:(new Tp.a(f)).iconSet,
iconColor:this.ota.ga(a).iconColor,keytip:l,menuModel:appChrome.getInkFlyoutAnchorMenuModel(a),animateTransition:c}));b.ya(appChrome.actions.addControls([a]))}}l0k(a,b,c){c.ya(appChrome.actions.updateIconColor(a,b))}m0k(a,b,c){c.ya(appChrome.actions.populateColorPickerCells(a,b))}LFb(a,b,c){c.ya(appChrome.actions.updateSliderSelectedValue(a,b))}Stk(a,b,c,f){if(a=appChrome.selectors.getColorPickerState(a)){a=this.Dui(Array.isArray(a.colorCells)?a.colorCells:null);for(const l of b)this.m0k(l,this.L4i(a,
c),f)}}M4i(a,b){const c=a.indexOf(b);-1===c?a.removeAt(a.count-1):a.removeAt(c);a.insert(0,b)}Dui(a){const b={};for(const c of a)b[c.id]=c;return b}L4i(a,b){const c=[];for(let f of b)f in a&&Array.add(c,a[f]);return c}L9d(a){return a&&a.InputMethod?a.InputMethod===Wd.R5d:!1}TJe(a){return!a||r.a.Ji||r.a.W2b}v$i(a,b){a&&a.Color&&(b=6===Object(ua.a)(String,a.Color).length?"#"+a.Color:Object(ua.a)(String,a.Color));return b}dFb(a,b,c,f,l,w,F){l=this.v$i(w,l);this.ota.ga(a).iconColor=l;this.l0k(a,l,F);
this.M4i(b,l);this.Stk(c,f,b,F)}WVf(){const a=new zs;this.dJ(Wd.FCa,!1,!1,a,!1);this.ia.Ma(aa.a.M5d,2,{enable:!1});a.commit()}pT(a,b){b.vfc===Xd.a.fO&&b.qBb!==Xd.a.fO&&this.ia.processAction(aa.a.Alg,2);b.vfc!==Xd.a.sg&&b.qBb===Xd.a.sg&&this.ia.processAction(aa.a.Dlg,2)}D6a(a){return a&&a[Vo.Value]?a[Vo.Value]:oq.BBc}}oq.acl="SliderCommandPropertiesValueKey";oq.BBc=3;oq.N5d=[Wd.MB,Wd.VE,Wd.FCa,Wd.p7,Wd.UE,Wd.zia,Wd.q7,Wd.GCa];Object(e.a)(oq,"InkRibbonManager",null,[549]);class ZF{constructor(a){this.bee=
a}get rwa(){return this.bee.rwa}pLc(){return this.bee.pLc()}AEe(){this.bee.AEe()}}Object(e.a)(ZF,"PPTChromeExtensionHelper",null,[542,575]);var Xa=d(522);class Vg{constructor(a,b){this.populateQueryCommandId=null;this.populateOnlyOnce=!1;this.populateQueryCommandId=a;this.populateOnlyOnce=b}}Object(e.a)(Vg,"MenuPopulationProperties",null,[]);class Pw{constructor(){this.Opc={};this.Lpc={};this.Nvf={};this.Mpc={};this.Ksd={};this.Lsd={};this.utd={};this.dYh()}FBa(a){return this.Lpc[a]}tYd(a){return this.Mpc[a]}a2i(a){return this.Ksd[a]}getCommandByExternalUxId(a){return this.Opc[a]}b1d(a){return this.Nvf[a]}E8f(a){if(a in
this.utd)return this.utd[a];Z.ULS.sendTraceTag(39946131,306,15,"ReactCommandDefinitionMapping.GetExternalIconIdByLegacyIconId: can't find mapping for legacy icon {0}",a);return"MissingIcon_20"}$1i(a){return this.Lsd[a]}Jzf(a){this.addCommandToMaps(a)}addCommandToMaps(a){var b=this.Opc[a.externalUxCommand];if(b){delete this.Opc[b.externalUxCommand];const c=this.Lpc[b.commandId];for(let f=0;f<c.length;f++)if(c[f].externalUxCommand===b.externalUxCommand){Array.remove(c,c[f]);break}}this.Opc[a.externalUxCommand]=
a;b=this.Lpc[a.commandId];if(void 0===b||null===b)b=[],this.Lpc[a.commandId]=b;b.push(a);a.legacyControlId&&(this.Mpc[a.legacyControlId]||(this.Mpc[a.legacyControlId]=new Ua.a),this.Mpc[a.legacyControlId].add(a.externalUxCommand))}addTabToMap(a,b){this.Nvf[a]=b}addIconToMap(a,b){this.utd[b]=a}zi(a){if(a.legacyGroupId){var b=this.Ksd[a.legacyGroupId];b||(b=[],this.Ksd[a.legacyGroupId]=b);b.push(a)}a.externalUxGroupId&&(b=this.Lsd[a.externalUxGroupId],b||(b=[],this.Lsd[a.externalUxGroupId]=b),b.push(a))}dYh(){this.addCommandToMaps(Object.assign(new Xa.a("AccessibilityHelp",
"3276527670"),{legacyControlId:"jbtnAccessibilityHelp"}));this.addCommandToMaps(new Xa.a("AlwaysShowRibbon","336231556"));this.addCommandToMaps(new Xa.a("CoauthorsRendered","691867605"));this.addCommandToMaps(Object.assign(new Xa.a("CopyLink","981334692"),{legacyControlId:"CopyLink"}));this.addCommandToMaps(Object.assign(new Xa.a("ShareMenu","336231556"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Xa.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",
queryCommandId:"1059068017"}));this.addCommandToMaps(Object.assign(new Xa.a("CheckAccessibility","2529583086"),{legacyControlId:"btnOpenAccCheckerPane",queryCommandId:"1949220702"}));this.addCommandToMaps(Object.assign(new Xa.a("ContactSupport","2918242107"),{legacyControlId:"btnContactSupport"}));this.addCommandToMaps(Object.assign(new Xa.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"}));this.addCommandToMaps(Object.assign(new Xa.a("DownloadACopy","3555692408"),
{legacyControlId:"jbtnDownloadACopy"}));this.addCommandToMaps(new Xa.a("FileMenuLauncher","1784018444"));this.addCommandToMaps(Object.assign(new Xa.a("GiveFeedback","802602464"),{legacyControlId:"jbtnGiveFeedback"}));this.addCommandToMaps(Object.assign(new Xa.a("Help","1454393937"),{legacyControlId:"jbtnHelp"}));this.addCommandToMaps(new Xa.a("HideRibbon","336231556"));this.addCommandToMaps(new Xa.a("InsertAddIns","1945259303"));this.addCommandToMaps(new Xa.a("InsertComment","2423504651"));this.addCommandToMaps(Object.assign(new Xa.a("InsertComment",
"2423504651"),{legacyControlId:"btnInsertComment"}));this.addCommandToMaps(new Xa.a("ManageAccess","981334692"));this.addCommandToMaps(new Xa.a("MenuClose","336231556"));this.addCommandToMaps(new Xa.a("MenuOpen","336231556"));this.addCommandToMaps(new Xa.a("MenuPopulate","336231556"));this.addCommandToMaps(new Xa.a("MoveToFolder","1182470434"));this.addCommandToMaps(new Xa.a("NavigateToCoauthor","4033456482"));this.addCommandToMaps(new Xa.a("New","1056925771"));this.addCommandToMaps(new Xa.a("NewBrowserSuggestionClicked",
"3734060499"));this.addCommandToMaps(Object.assign(new Xa.a("NewComment","2423504651"),{legacyControlId:"btnNewComment"}));this.addCommandToMaps(Object.assign(new Xa.a("PeopleWell","929022654"),{queryCommandId:"3798167515",populationProps:new Vg("1285265560",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("Privacy","1208554566"),{legacyControlId:"jbtnPrivacy"}));this.addCommandToMaps(Object.assign(new Xa.a("Rename","2382951455"),{legacyControlId:"jbtnRenameDialog"}));this.addCommandToMaps(Object.assign(new Xa.a("SaveAs",
"4246497969"),{legacyControlId:"jbtnSaveACopy"}));this.addCommandToMaps(Object.assign(new Xa.a("SaveAsToHost","2316717900"),{legacyControlId:"jbtnSaveAsToHost"}));this.addCommandToMaps(Object.assign(new Xa.a("SaveToSharePoint","3050207199"),{legacyControlId:"jbtnSaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Xa.a("SearchHelp","2918242107"),{legacyControlId:"btnHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("Share","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Xa.a("ShareTopBar",
"981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartLookUp","1435347209"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Xa.a("TabSwitch","336231556"));this.addCommandToMaps(Object.assign(new Xa.a("TermsOfUse","2349775795"),{legacyControlId:"jbtnTermsOfUse"}));this.addCommandToMaps(Object.assign(new Xa.a("Training","2918242107"),{legacyControlId:"btnShowTraining"}));this.addCommandToMaps(Object.assign(new Xa.a("VersionHistory","3681556347"),
{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Xa.a("WhatsNew","2918242107"),{legacyControlId:"btnWhatsNew"}));this.addCommandToMaps(Object.assign(new Xa.a("Zoom","1738002952"),{legacyControlId:"btnViewZoomDialog"}));this.addCommandToMaps(Object.assign(new Xa.a("ToggleRibbonUXDialog","1342108365"),{legacyControlId:"toggleBtnSimpleRibbon",queryCommandId:"1536028887"}));this.addCommandToMaps(new Xa.a("CommitNewDocumentTitle","1808554760"));this.addCommandToMaps(new Xa.a("RibbonModeToggledToMLR",
"536345575"));this.addCommandToMaps(new Xa.a("RibbonModeToggledToSLR","4031133701"));this.addCommandToMaps(new Xa.a("Workflow","2988588587"));this.addCommandToMaps(new Xa.a("ToggleVNextLook","1650341290"));this.addCommandToMaps(Object.assign(new Xa.a("DefinitionsParameterized","2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(Object.assign(new Xa.a("GetHelpFromTellMe","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("GetHelpFromTellMe1",
"2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("GetHelpFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("GetHelpWithDescriptionFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("GetHelpWithDescriptionFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(new Xa.a("AnswerForSearch","1914896509"));this.addCommandToMaps(new Xa.a("AnswerForSearchSingleLine",
"1914896509"));this.addCommandToMaps(new Xa.a("ReuseFileQuickActionForSearch","1914896509"));this.addCommandToMaps(new Xa.a("PeopleSuggestion1","2133437452"));this.addCommandToMaps(new Xa.a("PeopleSuggestion2","2133437453"));this.addCommandToMaps(new Xa.a("PeopleSuggestion3","2133437454"));this.addCommandToMaps(new Xa.a("FileSuggestion1","2260671807"));this.addCommandToMaps(new Xa.a("FileSuggestion2","2260671810"));this.addCommandToMaps(new Xa.a("FileSuggestion3","2260671809"));this.addCommandToMaps(new Xa.a("FileSuggestion4",
"2260671804"));this.addCommandToMaps(new Xa.a("FileSuggestion5","2260671803"));this.addCommandToMaps(new Xa.a("NotesSuggestion1","1914896509"));this.addCommandToMaps(new Xa.a("NotesSuggestion2","1914896509"));this.addCommandToMaps(new Xa.a("NotesSuggestion3","1914896509"));this.addCommandToMaps(new Xa.a("OnenoteNotesSuggestion1","4083547050"));this.addCommandToMaps(new Xa.a("OnenoteNotesSuggestion2","4083547053"));this.addCommandToMaps(new Xa.a("OnenoteNotesSuggestion3","4083547052"));this.addCommandToMaps(new Xa.a("TellMeFeedback",
"2230755196"));this.addCommandToMaps(new Xa.a("TemplateForSearch","57037313"));this.addCommandToMaps(new Xa.a("AddinSuggestion1","1385019911"));this.addCommandToMaps(new Xa.a("AddinSuggestion2","981735384"));this.addCommandToMaps(new Xa.a("AddinSuggestion3","2547819325"));this.addCommandToMaps(new Xa.a("LaunchAddinDialogFromTellMe","1421877154"));u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.AGb?(this.addCommandToMaps(new Xa.a("FindWithMatchesParameterized","1914896509")),this.addCommandToMaps(new Xa.a("FindParameterized",
"1914896509")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion1","1914896509")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion2","1914896509")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion3","1914896509"))):(this.addCommandToMaps(new Xa.a("FindWithMatchesParameterized","1540292897")),this.addCommandToMaps(new Xa.a("FindParameterized","1540292897")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion1","1540292897")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion2",
"1540292897")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion3","1540292897")));this.addCommandToMaps(new Xa.a("ImageForSearch","1914896509"));this.addCommandToMaps(new Xa.a("LearningForSearch","1006342541"));this.addCommandToMaps(new Xa.a("SmartLookupFromTellMe","1914896509"));this.addCommandToMaps(new Xa.a("SmartLookupFromTellMeQueryTermAtTop","1914896509"));this.addCommandToMaps(new Xa.a("SmartLookupFromTellMeZeroTerm","3359903192"));!u.AFrameworkApplication.NCa||u.AFrameworkApplication.Ewa||
u.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane")||(this.addCommandToMaps(Object.assign(new Xa.a("SmartLookupFromTellMe","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(Object.assign(new Xa.a("SmartLookupFromTellMeQueryTermAtTop","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new Xa.a("AnswerForSearch","3317204163")),this.addCommandToMaps(new Xa.a("AnswerForSearchSingleLine","3317204163")));this.addCommandToMaps(Object.assign(new Xa.a("SynonymsParameterized",
"2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Xa.a("TellMeLogMenuClose","4266170064"));this.addCommandToMaps(new Xa.a("TellMeLogMenuOpen","2480888384"));this.addCommandToMaps(new Xa.a("TellMeMenuItemExecuted","878547493"));this.addCommandToMaps(new Xa.a("TellMeSearchResultChange","2652476189"));this.addCommandToMaps(new Xa.a("TellMeSuggestion_1","1404166600"));this.addCommandToMaps(new Xa.a("TellMeSuggestion_2","1404166600"));this.addCommandToMaps(new Xa.a("TellMeSuggestion_3",
"1404166600"));this.addCommandToMaps(new Xa.a("TellMeSuggestion_4","1404166600"));this.addCommandToMaps(new Xa.a("TellMeSuggestion_5","1404166600"));this.addCommandToMaps(new Xa.a("TryOfficeUpsell","215809929"));this.addCommandToMaps(Object.assign(new Xa.a("TellMeControl","336231556"),{legacyControlId:"TellMeControl"}));this.addCommandToMaps(Object.assign(new Xa.a("DiagnosticsSection","336231556"),{legacyControlId:"AboutInformationMenuSectionDiagnostics"}));this.addCommandToMaps(Object.assign(new Xa.a("FileAboutPage",
"336231556"),{legacyControlId:"faAbout"}));this.addCommandToMaps(Object.assign(new Xa.a("FileHelpPage","336231556"),{legacyControlId:"faHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("FileHomePage","2074131365"),{legacyControlId:"faHome"}));this.addCommandToMaps(Object.assign(new Xa.a("FileInfoPage","336231556"),{legacyControlId:"faInfo"}));this.addCommandToMaps(Object.assign(new Xa.a("FileNewPage","2074131365"),{legacyControlId:"faNew"}));this.addCommandToMaps(Object.assign(new Xa.a("FileOpenPage",
"2799130311"),{legacyControlId:"faOpen"}));this.addCommandToMaps(Object.assign(new Xa.a("FilePrintPage","336231556"),{legacyControlId:"faPrint"}));this.addCommandToMaps(Object.assign(new Xa.a("FileSaveAsPage","336231556"),{legacyControlId:"faSaveAs"}));this.addCommandToMaps(Object.assign(new Xa.a("FileSharePage","336231556"),{legacyControlId:"faShare"}));this.addCommandToMaps(Object.assign(new Xa.a("FileTransformPage","336231556"),{legacyControlId:"faTransform"}));this.addCommandToMaps(new Xa.a("NewDocument",
"1056925771"));this.addCommandToMaps(new Xa.a("OpenUrlInNewTab","1959943459"));this.addCommandToMaps(new Xa.a("OpenDocumentUrl","2155708348"));this.addCommandToMaps(Object.assign(new Xa.a("ReplyWithChanges","1197060601"),{legacyControlId:"jbtnShareRWC"}));this.addCommandToMaps(Object.assign(new Xa.a("ReportAbuse","3237171630"),{legacyControlId:"jbtnReportAbuse"}));this.addCommandToMaps(Object.assign(new Xa.a("ThirdPartyNotices","2220417879"),{legacyControlId:"jbtnThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Xa.a("TrustCenter",
"2583751502"),{legacyControlId:"jbtnTrustCenter"}));this.addCommandToMaps(Object.assign(new Xa.a("TryOfficeForWordEditor","1773624819"),{legacyControlId:"btnjTryMacOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Xa.a("TryMacOfficeForWordEditor","3901198658"),{legacyControlId:"btnjTryOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Xa.a("PreviousVersions","466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Xa.a("FileVersionHistory",
"466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Xa.a("FilePreviousVersions","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Xa.a("HostConversation","710925581"),{legacyControlId:"HostConversation"}));this.addCommandToMaps(Object.assign(new Xa.a("HostClose","3033402446"),{legacyControlId:"HostClose"}));this.addCommandToMaps(Object.assign(new Xa.a("HostDownload","3555692408"),{legacyControlId:"HostDownload"}));this.addCommandToMaps(Object.assign(new Xa.a("HostOpenInBrowser",
"2596942163"),{legacyControlId:"HostOpenInBrowser"}));this.addCommandToMaps(Object.assign(new Xa.a("HostMoreOptions","336231556"),{legacyControlId:"HostMoreOptions"}));this.addCommandToMaps(Object.assign(new Xa.a("Sensitivity","941487903"),{legacyControlId:"flySensitivity",queryCommandId:"3134802707",populationProps:new Vg("1145315516",!0)}));this.addCommandToMaps(Object.assign(new Xa.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830"}));this.addCommandToMaps(new Xa.a("FreemiumUpsellEligible",
"1274543852"));this.addCommandToMaps(new Xa.a("FreemiumUpsellDialogShowUI","4180531998"));this.addCommandToMaps(new Xa.a("ReportFreemiumUpsellEligibleDisplayed","2539564555"));this.addCommandToMaps(new Xa.a("RequestFontInfo","3169500754"));this.addCommandToMaps(new Xa.a("PinOrUnpinFont","1500655301"));this.addCommandToMaps(new Xa.a("FontPickerMenuClose","146595126"));this.addCommandToMaps(new Xa.a("ShowAccessibilitySettingsDialog","2236763780"));this.addCommandToMaps(Object.assign(new Xa.a("ShowZoomDialog",
"1738002952"),{queryCommandId:"433063458",legacyControlId:"buttonShowZoomDialog"}));this.addCommandToMaps(Object.assign(new Xa.a("ZoomToPercentage","3745693956"),{queryCommandId:"2901130581",legacyControlId:"ZoomSlider"}));this.addCommandToMaps(new Xa.a("ZoomToPercentageCompleted","3139946409"));u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&(this.addCommandToMaps(Object.assign(new Xa.a("RecentLinks","2535492938"),
{queryCommandId:"2535492938",populationProps:new Vg("860679239",!1)})),this.addCommandToMaps(Object.assign(new Xa.a("InsertLinkFlyout","1052791248"),{queryCommandId:"1052791248",populationProps:new Vg("276140882",!1)})))}}Object(e.a)(Pw,"ReactCommandDefinitionMapping",null,[1499]);class $f{constructor(a){this.externalUxCommandIds=this.commandId=this.externalUxGroupId=this.legacyGroupId=null;this.legacyGroupId=a}}Object(e.a)($f,"GroupMetadata",null,[]);class YA extends Pw{constructor(a){super();this.$Wj=
"AnimationNone AnimationAppear AnimationFadeIn AnimationFlyIn AnimationSplit AnimationWipe AnimationRandomBars AnimationGrowAndTurn AnimationZoom AnimationBasicZoom AnimationBlinds AnimationBox AnimationCheckerboard AnimationExpand AnimationPeekIn AnimationRiseUp AnimationStretch AnimationStrips AnimationEmphasis_Spin AnimationEmphasis_GrowShrink AnimationEmphasis_Transparency AnimationEmphasis_LineColor AnimationEmphasis_FillColor AnimationEmphasis_FontColor AnimationExit_Disappear AnimationExit_Fade AnimationExit_FlyOut AnimationExit_Split AnimationExit_Wipe AnimationExit_RandomBars AnimationExit_Zoom AnimationExit_BasicZoom AnimationExit_Blinds AnimationExit_Box AnimationExit_Checkerboard AnimationExit_PeekOut AnimationExit_Stretchy AnimationExit_Strips AnimationGalleryNone AnimationGalleryEntrance AnimationGalleryEmphasis AnimationGalleryExit".split(" ");
this.XWj=26;this.WWj="AnimationEffectOptionsDataSpin_Quarter AnimationEffectOptionsDataSpin_Half AnimationEffectOptionsDataSpin_Full AnimationEffectOptionsDataSpin_Two AnimationEffectOptionsDataTransparency_25 AnimationEffectOptionsDataTransparency_50 AnimationEffectOptionsDataTransparency_75 AnimationEffectOptionsDataTransparency_100 AnimationEffectOptionsDataGrowShrink_Tiny AnimationEffectOptionsDataGrowShrink_Smaller AnimationEffectOptionsDataGrowShrink_Larger AnimationEffectOptionsDataGrowShrink_Huge".split(" ");
this.ZWj=31;this.YWj="AnimationEffectOptionsDirectionFromBottom AnimationEffectOptionsDirectionFromBottomLeft AnimationEffectOptionsDirectionFromLeft AnimationEffectOptionsDirectionFromTopLeft AnimationEffectOptionsDirectionFromTop AnimationEffectOptionsDirectionFromTopRight AnimationEffectOptionsDirectionFromRight AnimationEffectOptionsDirectionFromBottomRight AnimationEffectOptionsDirectionToBottom AnimationEffectOptionsDirectionToBottomLeft AnimationEffectOptionsDirectionToLeft AnimationEffectOptionsDirectionToTopLeft AnimationEffectOptionsDirectionToTop AnimationEffectOptionsDirectionToTopRight AnimationEffectOptionsDirectionToRight AnimationEffectOptionsDirectionToBottomRight AnimationEffectOptionsDirectionHorizontal AnimationEffectOptionsDirectionHorizontalIn AnimationEffectOptionsDirectionHorizontalOut AnimationEffectOptionsDirectionVertical AnimationEffectOptionsDirectionVerticalIn AnimationEffectOptionsDirectionVerticalOut AnimationEffectOptionsDirectionLeftDown AnimationEffectOptionsDirectionLeftUp AnimationEffectOptionsDirectionRightDown AnimationEffectOptionsDirectionRightUp AnimationEffectOptionsDirectionIn AnimationEffectOptionsDirectionInBottom AnimationEffectOptionsDirectionInCenter AnimationEffectOptionsDirectionInSlightly AnimationEffectOptionsDirectionOut AnimationEffectOptionsDirectionOutBottom AnimationEffectOptionsDirectionOutCenter AnimationEffectOptionsDirectionOutSlightly AnimationEffectOptionsDirectionFloatUp AnimationEffectOptionsDirectionFloatDown AnimationEffectOptionsDirectionObjectCenter AnimationEffectOptionsDirectionSlideCenter AnimationEffectOptionsDirectionObjectCenterOut AnimationEffectOptionsDirectionSlideCenterOut AnimationEffectOptionsDirectionClockwise AnimationEffectOptionsDirectionCounterClockwise AnimationEffectOptionsDirectionAcross AnimationEffectOptionsDirectionUp AnimationEffectOptionsDirectionDown AnimationEffectOptionsDirectionGrowShrinkHorizontal AnimationEffectOptionsDirectionGrowShrinkVertical AnimationEffectOptionsDirectionGrowShrinkBoth".split(" ");
this.y7j=23;this.x7j="TransitionEffectOptionsTransitionExisting TransitionEffectOptionsTransitionExistingInMenu TransitionEffectOptionsTransitionNone TransitionEffectOptionsTransitionFade TransitionEffectOptionsTransitionFadeSmoothly TransitionEffectOptionsTransitionFadeThroughBlack TransitionEffectOptionsTransitionPush TransitionEffectOptionsTransitionPushFromBottom TransitionEffectOptionsTransitionPushFromLeft TransitionEffectOptionsTransitionPushFromRight TransitionEffectOptionsTransitionPushFromTop TransitionEffectOptionsTransitionCut TransitionEffectOptionsTransitionCutNone TransitionEffectOptionsTransitionCutThroughBlack TransitionEffectOptionsTransitionWipe TransitionEffectOptionsTransitionWipeFromRight TransitionEffectOptionsTransitionWipeFromTop TransitionEffectOptionsTransitionWipeFromLeft TransitionEffectOptionsTransitionWipeFromBottom TransitionEffectOptionsTransitionWipeFromTopRight TransitionEffectOptionsTransitionWipeFromBottomRight TransitionEffectOptionsTransitionWipeFromTopLeft TransitionEffectOptionsTransitionWipeFromBottomLeft TransitionEffectOptionsTransitionMorph TransitionEffectOptionsTransitionMorphByObject TransitionEffectOptionsTransitionMorphByWord TransitionEffectOptionsTransitionMorphByChar TransitionEffectOptionsTransitionSplit TransitionEffectOptionsTransitionSplitVerticalOut TransitionEffectOptionsTransitionSplitHorizontalIn TransitionEffectOptionsTransitionSplitHorizontalOut TransitionEffectOptionsTransitionSplitVerticalIn TransitionEffectOptionsTransitionRandom TransitionEffectOptionsTransitionRandomBars TransitionEffectOptionsTransitionRandomBarsVertical TransitionEffectOptionsTransitionRandomBarsHorizontal TransitionEffectOptionsTransitionShape TransitionEffectOptionsTransitionShapeCircle TransitionEffectOptionsTransitionShapeDiamond TransitionEffectOptionsTransitionShapePlus TransitionEffectOptionsTransitionShapeIn TransitionEffectOptionsTransitionShapeOut TransitionEffectOptionsTransitionCombHorizontal TransitionEffectOptionsTransitionCombVertical TransitionEffectOptionsTransitionWheelClockwise TransitionEffectOptionsTransitionWheelCounterclockwise TransitionEffectOptionsTransitionWheelWedge TransitionEffectOptionsTransitionRevealFromLeft TransitionEffectOptionsTransitionRevealFromRight TransitionEffectOptionsTransitionRevealSmoothlyFromLeft TransitionEffectOptionsTransitionRevealSmoothlyFromRight TransitionEffectOptionsTransitionDissolve TransitionEffectOptionsTransitionBlindsHorizontal TransitionEffectOptionsTransitionBlindsVertical TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionCoverFromBottom TransitionEffectOptionsTransitionCoverFromBottomLeft TransitionEffectOptionsTransitionCoverFromBottomRight TransitionEffectOptionsTransitionCoverFromLeft TransitionEffectOptionsTransitionCoverFromRight TransitionEffectOptionsTransitionCoverFromTop TransitionEffectOptionsTransitionCoverFromTopLeft TransitionEffectOptionsTransitionCoverFromTopRight TransitionEffectOptionsTransitionUncoverFromBottom TransitionEffectOptionsTransitionUncoverFromBottomLeft TransitionEffectOptionsTransitionUncoverFromBottomRight TransitionEffectOptionsTransitionUncoverFromLeft TransitionEffectOptionsTransitionUncoverFromRight TransitionEffectOptionsTransitionUncoverFromTop TransitionEffectOptionsTransitionUncoverFromTopLeft TransitionEffectOptionsTransitionUncoverFromTopRight TransitionEffectOptionsTransitionRippleCenter TransitionEffectOptionsTransitionRippleBottomLeft TransitionEffectOptionsTransitionRippleBottomRight TransitionEffectOptionsTransitionRippleTopRight TransitionEffectOptionsTransitionRippleTopLeft TransitionEffectOptionsTransitionCubeFromBottom TransitionEffectOptionsTransitionCubeFromLeft TransitionEffectOptionsTransitionCubeFromRight TransitionEffectOptionsTransitionCubeFromTop TransitionEffectOptionsTransitionBoxFromBottom TransitionEffectOptionsTransitionBoxFromLeft TransitionEffectOptionsTransitionBoxFromRight TransitionEffectOptionsTransitionBoxFromTop TransitionEffectOptionsTransitionSwitchLeft TransitionEffectOptionsTransitionSwitchRight TransitionEffectOptionsTransitionFallOverLeft TransitionEffectOptionsTransitionFallOverRight TransitionEffectOptionsTransitionDrapeLeft TransitionEffectOptionsTransitionDrapeRight TransitionEffectOptionsTransitionFlipLeft TransitionEffectOptionsTransitionFlipRight TransitionEffectOptionsTransitionWindLeft TransitionEffectOptionsTransitionWindRight TransitionEffectOptionsTransitionPrestige TransitionEffectOptionsTransitionFracture TransitionEffectOptionsTransitionCrush TransitionEffectOptionsTransitionPeelOffLeft TransitionEffectOptionsTransitionPeelOffRight TransitionEffectOptionsTransitionPageCurlSingleLeft TransitionEffectOptionsTransitionPageCurlSingleRight TransitionEffectOptionsTransitionPageCurlDoubleLeft TransitionEffectOptionsTransitionPageCurlDoubleRight TransitionEffectOptionsTransitionAirplaneLeft TransitionEffectOptionsTransitionAirplaneRight TransitionEffectOptionsTransitionOrigamiLeft TransitionEffectOptionsTransitionOrigamiRight TransitionEffectOptionsTransitionCheckerFromLeft TransitionEffectOptionsTransitionCheckerFromTop TransitionEffectOptionsTransitionVortexFromLeft TransitionEffectOptionsTransitionVortexFromTop TransitionEffectOptionsTransitionVortexFromRight TransitionEffectOptionsTransitionVortexFromBottom TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionGlitterHexagonLeft TransitionEffectOptionsTransitionGlitterHexagonTop TransitionEffectOptionsTransitionGlitterHexagonRight TransitionEffectOptionsTransitionGlitterHexagonBottom TransitionEffectOptionsTransitionGlitterDiamondLeft TransitionEffectOptionsTransitionGlitterDiamondTop TransitionEffectOptionsTransitionGlitterDiamondRight TransitionEffectOptionsTransitionGlitterDiamondBottom TransitionEffectOptionsTransitionOrbitFromTop TransitionEffectOptionsTransitionOrbitFromBottom TransitionEffectOptionsTransitionOrbitFromLeft TransitionEffectOptionsTransitionOrbitFromRight TransitionEffectOptionsTransitionRotateFromTop TransitionEffectOptionsTransitionRotateFromBottom TransitionEffectOptionsTransitionRotateFromLeft TransitionEffectOptionsTransitionRotateFromRight TransitionEffectOptionsTransitionConveyorFromRight TransitionEffectOptionsTransitionConveyorFromLeft TransitionEffectOptionsTransitionGalleryIconFromRight TransitionEffectOptionsTransitionGalleryIconFromLeft TransitionEffectOptionsTransitionPanFromBottom TransitionEffectOptionsTransitionPanFromLeft TransitionEffectOptionsTransitionPanFromRight TransitionEffectOptionsTransitionPanFromTop TransitionEffectOptionsTransitionDoorsVertical TransitionEffectOptionsTransitionDoorsHorizontal TransitionEffectOptionsTransitionWindowVertical TransitionEffectOptionsTransitionWindowHorizontal TransitionEffectOptionsTransitionZoomIn TransitionEffectOptionsTransitionZoomOut TransitionEffectOptionsTransitionZoomAndRotate TransitionEffectOptionsTransitionFlyThroughIn TransitionEffectOptionsTransitionFlyThroughOut TransitionEffectOptionsTransitionFlyThroughInWithBounce TransitionEffectOptionsTransitionFlyThroughOutWithBounce".split(" ");
this.H3j="PictureStyles_SimpleFrameWhite_15505 PictureStyles_BeveledMatteWhite_15506 PictureStyles_MetalFrame_15507 PictureStyles_DropShadowRectangle_15508 PictureStyles_ReflectedRoundedRectangle_15509 PictureStyles_SoftEdgeRectangle_15510 PictureStyles_DoubleFrameBlack_15511 PictureStyles_ThickMatteBlack_15512 PictureStyles_SimpleFrameBlack_15513 PictureStyles_BeveledOvalBlack_15514 PictureStyles_CompoundFrameBlack_15515 PictureStyles_ModerateFrameBlack_15516 PictureStyles_CenterShadowRectangle_15517 PictureStyles_RoundedDiagonalCornerWhite_15518 PictureStyles_SnipDiagonalCornerWhite_15519 PictureStyles_ModerateFrameWhite_15520 PictureStyles_RotatedWhite_15521 PictureStyles_PerspectiveShadowWhite_15522 PictureStyles_RelaxedPerspectiveWhite_15523 PictureStyles_SoftEdgeOval_15524 PictureStyles_BevelEdgeRectangle_15525 PictureStyles_BevelPerspective_15526 PictureStyles_ReflectedPerspectiveRight_15527 PictureStyles_BevelPerspectiveLeftWhite_15528 PictureStyles_ReflectedBevelBlack_15529 PictureStyles_ReflectedBevelWhite_15530 PictureStyles_MetalRoundedRectangle_15531 PictureStyles_MetalOval_15532".split(" ");
this.F3j="PictureCrop_ShapeAlternateProcess_126 PictureCrop_ShapeArc_84 PictureCrop_ShapeBentArrow_28 PictureCrop_ShapeBentUpArrow_31 PictureCrop_ShapeBevel_74 PictureCrop_ShapeBlockArc_77 PictureCrop_ShapeCan_7 PictureCrop_ShapeCard_139 PictureCrop_ShapeChevron_38 PictureCrop_ShapeChord_66 PictureCrop_ShapeCircularArrow_45 PictureCrop_ShapeCloud_83 PictureCrop_ShapeCloudCallout_93 PictureCrop_ShapeCollate_143 PictureCrop_ShapeConnector_137 PictureCrop_ShapeCross_72 PictureCrop_ShapeCube_8 PictureCrop_ShapeCurvedArrowConnector_153 PictureCrop_ShapeCurvedConnector_25 PictureCrop_ShapeCurvedDoubleArrowConnector_154 PictureCrop_ShapeCurvedDownArrow_46 PictureCrop_ShapeCurvedDownRibbon_120 PictureCrop_ShapeCurvedLeftArrow_33 PictureCrop_ShapeCurvedRightArrow_32 PictureCrop_ShapeCurvedUpArrow_34 PictureCrop_ShapeCurvedUpRibbon_119 PictureCrop_ShapeData_128 PictureCrop_ShapeDecagon_63 PictureCrop_ShapeDecision_127 PictureCrop_ShapeDelay_148 PictureCrop_ShapeDiagonalStripe_71 PictureCrop_ShapeDiamond_58 PictureCrop_ShapeDirectAccessStorage_151 PictureCrop_ShapeDisplay_152 PictureCrop_ShapeDocument_131 PictureCrop_ShapeDodecagon_64 PictureCrop_ShapeDonut_75 PictureCrop_ShapeDoubleBrace_86 PictureCrop_ShapeDoubleBracket_85 PictureCrop_ShapeDoubleWave_124 PictureCrop_ShapeDownArrow_0 PictureCrop_ShapeDownArrowCallout_40 PictureCrop_ShapeDownRibbon_118 PictureCrop_ShapeElbowArrowConnector_155 PictureCrop_ShapeElbowConnector_26 PictureCrop_ShapeElbowDoubleArrowConnector_156 PictureCrop_ShapeEllipse_9 PictureCrop_ShapeExplosion1_106 PictureCrop_ShapeExplosion2_107 PictureCrop_ShapeExtract_145 PictureCrop_ShapeFoldedCorner_78 PictureCrop_ShapeFrame_68 PictureCrop_ShapeGallery PictureCrop_ShapeHalfFrame_69 PictureCrop_ShapeHeart_18 PictureCrop_ShapeHeptagon_61 PictureCrop_ShapeHexagon_60 PictureCrop_ShapeHorizontalScroll_122 PictureCrop_ShapeInternalStorage_130 PictureCrop_ShapeLeftArrow_1 PictureCrop_ShapeLeftArrowCallout_41 PictureCrop_ShapeLeftBrace_89 PictureCrop_ShapeLeftBracket_87 PictureCrop_ShapeLeftRightArrow_2 PictureCrop_ShapeLeftRightArrowCallout_43 PictureCrop_ShapeLeftRightUpArrow_27 PictureCrop_ShapeLeftUpArrow_30 PictureCrop_ShapeLightningBolt_80 PictureCrop_ShapeLineCallout1_94 PictureCrop_ShapeLShape_70 PictureCrop_ShapeMagneticDisk_150 PictureCrop_ShapeManualInput_135 PictureCrop_ShapeManualOperation_136 PictureCrop_ShapeMathDivide_22 PictureCrop_ShapeMathEqual_23 PictureCrop_ShapeMathMinus_20 PictureCrop_ShapeMathMultiply_21 PictureCrop_ShapeMathNotEqual_24 PictureCrop_ShapeMathPlus_19 PictureCrop_ShapeMerge_146 PictureCrop_ShapeMoon_82 PictureCrop_ShapeMultidocument_132 PictureCrop_ShapeNoSymbol_76 PictureCrop_ShapeNotchedRightArrow_36 PictureCrop_ShapeOctagon_62 PictureCrop_ShapeOffpageConnector_138 PictureCrop_ShapeOr_142 PictureCrop_ShapeOvalCallout_92 PictureCrop_ShapeParallelogram_56 PictureCrop_ShapePentagon_37 PictureCrop_ShapePie_65 PictureCrop_ShapePlaque_73 PictureCrop_ShapePredefinedProcess_129 PictureCrop_ShapePreparation_134 PictureCrop_ShapeProcess_125 PictureCrop_ShapePunchedTape_140 PictureCrop_ShapeQuadArrow_47 PictureCrop_ShapeQuadArrowCallout_44 PictureCrop_ShapeRectangle_10 PictureCrop_ShapeRectangularCallout_91 PictureCrop_ShapeRightArrow_3 PictureCrop_ShapeRightArrowCallout_39 PictureCrop_ShapeRightBrace_90 PictureCrop_ShapeRightBracket_88 PictureCrop_ShapeRightTriangle_55 PictureCrop_ShapeRoundDiagonalCornerRectangle_48 PictureCrop_ShapeRoundedRectangle_11 PictureCrop_ShapeRoundedRectangleCallout_6 PictureCrop_ShapeRoundSameSideCornerRectangle_49 PictureCrop_ShapeRoundSingleCornerRectangle_50 PictureCrop_ShapeSequentialActionStorage PictureCrop_ShapeSequentialActionStorage_149 PictureCrop_ShapeSmileyFace_79 PictureCrop_ShapeSnipDiagonalCornerRectangle_52 PictureCrop_ShapeSnipRoundSingleCornerRectangle_51 PictureCrop_ShapeSnipSameSideCornerRectangle_53 PictureCrop_ShapeSnipSingleCornerRectangle_54 PictureCrop_ShapeSort_144 PictureCrop_ShapeSPentagon_59 PictureCrop_ShapeStar10_112 PictureCrop_ShapeStar12_113 PictureCrop_ShapeStar16_114 PictureCrop_ShapeStar24_115 PictureCrop_ShapeStar32_116 PictureCrop_ShapeStar4_108 PictureCrop_ShapeStar5_15 PictureCrop_ShapeStar6_109 PictureCrop_ShapeStar7_110 PictureCrop_ShapeStar8_111 PictureCrop_ShapeStoredData_147 PictureCrop_ShapeStraightConnector_12 PictureCrop_ShapeStraightConnectorArrow_13 PictureCrop_ShapeStraightConnectorTwoArrow_14 PictureCrop_ShapeStripedRightArrow_35 PictureCrop_ShapeSummingJunction_141 PictureCrop_ShapeSun_81 PictureCrop_ShapeTeardrop_67 PictureCrop_ShapeTerminator_133 PictureCrop_ShapeTrapezoid_57 PictureCrop_ShapeTriangle_17 PictureCrop_ShapeUpArrow_4 PictureCrop_ShapeUpArrowCallout_42 PictureCrop_ShapeUpDownArrow_5 PictureCrop_ShapeUpRibbon_117 PictureCrop_ShapeUTurnArrow_29 PictureCrop_ShapeVerticalScroll_121 PictureCrop_ShapeWave_123".split(" ");
this.HZj=["FormatBackgroundStandardColorsFromCanvas","FormatBackgroundThemeColorsFromCanvas","FormatBackgroundThemeColorsMCUFromCanvas"];this.IZj=["FormatBackgroundStandardColorsFromThumbnailPane","FormatBackgroundThemeColorsFromThumbnailPane","FormatBackgroundThemeColorsMCUFromThumbnailPane"];this.oOg="SmartArtLayouts__orgChart1__hierarchy SmartArtLayouts__hList1__list SmartArtLayouts__vList2__list SmartArtLayouts__hierarchy1__hierarchy SmartArtLayouts__chevron2__process SmartArtLayouts__process3__process SmartArtLayouts__hProcess4__process SmartArtLayouts__process5__process SmartArtLayouts__default__list SmartArtLayouts__chevron1__process SmartArtLayouts__cycle2__cycle SmartArtLayouts__process1__process SmartArtLayouts__pyramid1__pyramid SmartArtLayouts__hProcess11__process SmartArtLayouts__cycle5__cycle SmartArtLayouts__lProcess3__process SmartArtLayouts__bProcess2__process SmartArtLayouts__hChevron3__process SmartArtLayouts__hProcess3__process SmartArtLayouts__hProcess9__process SmartArtLayouts__cycle3__cycle SmartArtLayouts__arrow5__relationship SmartArtLayouts__hProcess7__process SmartArtLayouts__arrow1__relationship SmartArtLayouts__equation1__relationship SmartArtLayouts__lProcess2__list SmartArtLayouts__hierarchy3__hierarchy SmartArtLayouts__hierarchy2__hierarchy SmartArtLayouts__hierarchy5__hierarchy SmartArtLayouts__pyramid3__pyramid SmartArtLayouts__hierarchy6__hierarchy SmartArtLayouts__venn3__relationship SmartArtLayouts__cycle7__cycle SmartArtLayouts__cycle6__cycle SmartArtLayouts__hProcess6__process SmartArtLayouts__lProcess1__process SmartArtLayouts__pyramid2__pyramid SmartArtLayouts__radial2__relationship SmartArtLayouts__bProcess3__process SmartArtLayouts__process4__process SmartArtLayouts__hList9__list SmartArtLayouts__hierarchy4__hierarchy SmartArtLayouts__hList3__list SmartArtLayouts__cycle1__cycle SmartArtLayouts__hList6__list SmartArtLayouts__arrow2__process SmartArtLayouts__vList6__process SmartArtLayouts__bProcess4__process SmartArtLayouts__list1__list SmartArtLayouts__equation2__relationship SmartArtLayouts__process2__process SmartArtLayouts__BasicTimeline__timeline SmartArtLayouts__HexagonTimeline__timeline SmartArtLayouts__RoundedRectangleTimeline__timeline SmartArtLayouts__DropPinTimeline__timeline SmartArtLayouts__HorizontalLabelsTimeline__timeline SmartArtLayouts__HorizontalPathTimeline__timeline SmartArtLayouts__AccentHomeChevronProcess__timeline".split(" ");
this.la=a;this.oFd();this.yYh();this.hYh();this.gYh();this.kYh();this.nYh();this.pYh();this.xYh();this.qYh();this.mYh();this.jYh();this.uYh();this.rYh();this.sYh();this.wYh();this.VFd();this.mZh();this.vYh();this.vZh();this.eYh();this.lYh();this.iYh();this.fYh();this.oYh();this.tYh()}vZh(){this.addIconToMap("CheckMark_20","per_QuickSearchCompletedToday_16x16x32");this.addIconToMap("Info_20","per_Info_16x16x32")}oFd(){this.addCommandToMaps(new Xa.a("AddSection","2203490252"));this.addCommandToMaps(new Xa.a("AlternativeText",
"3296909722"));this.addCommandToMaps(new Xa.a("AlignAnchor","3320425830"));this.addCommandToMaps(Object.assign(new Xa.a("AlwaysUseSubtitles","1906012838"),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:"3244674241"}));this.addCommandToMaps(new Xa.a("ArrangeAnchor","200712034"));this.addCommandToMaps(Object.assign(new Xa.a("AudioSettings","2346722376"),{queryCommandId:"1234363616"}));this.addCommandToMaps(new Xa.a("LivePollTaskPane","3902591294"));this.addCommandToMaps(new Xa.a("ArrangeShapeAnchor",
"200712034"));this.addCommandToMaps(new Xa.a("BeginEditShapeText","3618312345"));this.addCommandToMaps(Object.assign(new Xa.a("Bold","2913964"),{queryCommandId:"2523547740"}));this.addCommandToMaps(Object.assign(new Xa.a("BottomOverlaid","348484772"),{legacyControlId:"PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",queryCommandId:"1824785548"}));this.addCommandToMaps(new Xa.a("BringToFrontFlyout","4230958419"));this.addCommandToMaps(new Xa.a("BringForward","3270113035"));this.addCommandToMaps(new Xa.a("BringToFront",
"2814941514"));this.addCommandToMaps(Object.assign(new Xa.a("BulletLibrary","3627016479"),{legacyControlId:"PptRibbon.Home.Paragraph.BulletGallery",queryCommandId:"2324278473",populationProps:new Vg("1142350707",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",queryCommandId:"1059068017"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseCapitalizeEachWord","1880533947"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Capitalization"}));
this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseLower","768894625"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Lower"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseMenuEnabled","3679012070"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseSentence","2981608035"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.SentenceCase"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseToggle","3502060538"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.ToggleCase"}));
this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseUpper","4291024442"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Upper"}));this.addCommandToMaps(new Xa.a("ChangeLayout","4017322732"));this.addCommandToMaps(Object.assign(new Xa.a("ChangeGraphicContextMenu","1373490814"),{legacyControlId:"PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeGraphicFlyout","1373490814"),{legacyControlId:"PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"}));
this.addCommandToMaps(Object.assign(new Xa.a("ChangePicture","2958402736"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.ChangePicture"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenu","3244031780"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuBing","3565639685"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuM365",
"148018230"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuIcons","1332899609"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuDevice","2958402736"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuOneDrive",
"2057552935"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost",queryCommandId:"3612507612"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuMobileDevice","1101801264"),{legacyControlId:"ChangePictureFromMobileDevice"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyout","3244031780"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutBing","3565639685"),
{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutM365","148018230"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutIcons","1332899609"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutDevice","2958402736"),
{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutOneDrive","2057552935"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost",queryCommandId:"3612507612"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutMobileDevice","1101801264"),{legacyControlId:"ChangePictureFromMobileDevice"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeSmartArtColorAnchor","396312034"),
{populationProps:new Vg("3273638293",!1)}));this.addCommandToMaps(new Xa.a("CheckAccessibility","2295549531"));this.addCommandToMaps(Object.assign(new Xa.a("ClearFormatting","2319895756"),{legacyControlId:"PptRibbon.Home.Font.ClearFormatting"}));this.addCommandToMaps(new Xa.a("ClearTableFormatting","3835123874"));this.addCommandToMaps(Object.assign(new Xa.a("CommentsPane","1991203991"),{queryCommandId:"3845423030"}));this.addCommandToMaps(new Xa.a("CopyHyperlink","3037606367"));this.addCommandToMaps(Object.assign(new Xa.a("ContextMenu",
"1451516907"),{populationProps:new Vg("2071563036",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("SelectionPane","654924585"),{queryCommandId:"2763753566"}));this.addCommandToMaps(Object.assign(new Xa.a("RenderFooterPane","1278690195"),{queryCommandId:"2945242850"}));this.addCommandToMaps(new Xa.a("InsertSlideNumber","150011355"));this.addCommandToMaps(Object.assign(new Xa.a("RenderSelectionPane","654924585"),{queryCommandId:"2763753566"}));this.addCommandToMaps(Object.assign(new Xa.a("CommentsShowMarkUp",
"410757179"),{queryCommandId:"992822777"}));this.addCommandToMaps(Object.assign(new Xa.a("CommentsShowAdvancedMarkUp","1016800201"),{queryCommandId:"775043447"}));this.addCommandToMaps(new Xa.a("Copy","49968134"));this.addCommandToMaps(new Xa.a("CopyInVersionHistory","2758158609"));this.addCommandToMaps(new Xa.a("ClickVersionHistoryRestore","2138207060"));this.addCommandToMaps(new Xa.a("ClickVersionHistorySaveACopy","2623258827"));this.addCommandToMaps(new Xa.a("ClickVersionHistoryDownloadVersion",
"1316171850"));this.addCommandToMaps(new Xa.a("Cut","158451065"));this.addCommandToMaps(new Xa.a("Delete","1680865470"));this.addCommandToMaps(new Xa.a("DeleteAllCommentsInPresentation","1737510757"));this.addCommandToMaps(new Xa.a("DeleteAllCommentsInSlide","469473574"));this.addCommandToMaps(new Xa.a("DeleteAllResolvedComments","2766426586"));this.addCommandToMaps(Object.assign(new Xa.a("DeleteComment","869210402"),{queryCommandId:"2614767758"}));this.addCommandToMaps(new Xa.a("DeleteRepeatedWord",
"2023591105"));this.addCommandToMaps(new Xa.a("DeleteSlide","1235090158"));this.addCommandToMaps(Object.assign(new Xa.a("DesignerHome","3070664289"),{legacyControlId:"PptRibbon.Home.ShowHide.Designer",queryCommandId:"562763405"}));this.addCommandToMaps(Object.assign(new Xa.a("DesignerNew","4250022162"),{legacyControlId:"PptRibbon.Design.ShowHide.Designer.New",queryCommandId:"562763405"}));this.addCommandToMaps(Object.assign(new Xa.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",
populationProps:new Vg("1546254036",!0)}));this.addCommandToMaps(Object.assign(new Xa.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"}));this.addCommandToMaps(new Xa.a("DoNotCheckThisCritiqueType","2157977488"));this.addCommandToMaps(new Xa.a("Duplicate","486800848"));this.addCommandToMaps(new Xa.a("DuplicateSlide","3006547192"));this.addCommandToMaps(new Xa.a("EditHyperlink","2711544537"));this.addCommandToMaps(Object.assign(new Xa.a("EditInApp","3588168074"),{legacyControlId:"btnOpenInClient"}));
this.addCommandToMaps(Object.assign(new Xa.a("EditInAppWithIcon","3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Xa.a("EditorPane","97211136"),{legacyControlId:"PptRibbon.Review.Proofing.EditorPane",queryCommandId:"974334176"}));this.addCommandToMaps(Object.assign(new Xa.a("EditorPaneSplitButton","97211136"),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButton",queryCommandId:"2161272628"}));this.addCommandToMaps(new Xa.a("Find","1891435765"));
this.addCommandToMaps(new Xa.a("FitToWindow","2470172091"));this.addCommandToMaps(Object.assign(new Xa.a("FixIt","3100655080"),{legacyControlId:"FixIt",queryCommandId:"1559931984"}));this.addCommandToMaps(Object.assign(new Xa.a("FontColor","3314514081"),{populationProps:new Vg("3238769791",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("FontPicker","3430668515"),{legacyControlId:"fontPicker",queryCommandId:"3287122076",populationProps:new Vg("1965039802",!0)}));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")?
(this.addCommandToMaps(Object.assign(new Xa.a("FontName","3145621451"),{queryCommandId:"1052225825",populationProps:new Vg("2923358157",!1),commandPreviewId:"539266573",commandRevertId:"1026923615"})),this.addCommandToMaps(Object.assign(new Xa.a("FontSize","2016320825"),{queryCommandId:"3075296939",commandPreviewId:"4169085911",commandRevertId:"200151849"}))):(this.addCommandToMaps(Object.assign(new Xa.a("FontName","3145621451"),{queryCommandId:"1052225825",populationProps:new Vg("2923358157",!1)})),
this.addCommandToMaps(Object.assign(new Xa.a("FontSize","2016320825"),{queryCommandId:"3075296939"})));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundApplyToAll","2080761994"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundPicture","2640793597"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundSolidFill","3049223287"),
{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",populationProps:new Vg("3004618427",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundStandardColors","3049223287"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundThemeColors","3049223287"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundThemeColorsMCU",
"3049223287"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(new Xa.a("FormatBackgroundRecentColors","1912773268"));this.addCommandToMaps(Object.assign(new Xa.a("FormatPainter","3794362040"),{queryCommandId:"3309569663"}));this.addCommandToMaps(Object.assign(new Xa.a("HideProofingErrors","3041519999"),{legacyControlId:"PptRibbon.Review.Proofing.HideProofingErrors",queryCommandId:"3699667717"}));this.addCommandToMaps(Object.assign(new Xa.a("GiveFeedback",
"2918242107"),{legacyControlId:"btnFeedback"}));this.addCommandToMaps(Object.assign(new Xa.a("GrammarOptions","3380187414"),{legacyControlId:"PptRibbon.Review.Proofing.GrammarOptions"}));this.addCommandToMaps(Object.assign(new Xa.a("ProofingOptions","3380187414"),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButtonFallback"}));this.addCommandToMaps(Object.assign(new Xa.a("Grow","3444541960"),{legacyControlId:"PptRibbon.Home.Font.Grow"}));this.addCommandToMaps(Object.assign(new Xa.a("HideSlide",
"3945504187"),{queryCommandId:"3032837727"}));this.la.V3d&&this.addCommandToMaps(new Xa.a("UnhideSlide","1774836750"));this.addCommandToMaps(Object.assign(new Xa.a("Highlight","2904102419"),{legacyControlId:"PptRibbon.Home.Font.FontBackgroundColor"}));this.addCommandToMaps(new Xa.a("HighlighterColor","1784019754"));this.addCommandToMaps(new Xa.a("IgnoreSpellingError","3549510372"));this.addCommandToMaps(new Xa.a("Indent","1288324077"));this.addCommandToMaps(new Xa.a("InsertAddIns","2300394269"));
this.addCommandToMaps(new Xa.a("InsertComment","1221260928"));this.addCommandToMaps(Object.assign(new Xa.a("InsertIcons","3143141002"),{legacyControlId:"InsertIconDialog"}));this.addCommandToMaps(new Xa.a("InsertLink","2711544537"));this.addCommandToMaps(new Xa.a("InsertSocialMediaVideo","1182875165"));this.addCommandToMaps(new Xa.a("InsertLiveFeed","791426823"));this.addCommandToMaps(Object.assign(new Xa.a("InsertOnlineVideo","2948423841"),{legacyControlId:"PptRibbon.InsertTab.Media.OnlineVideo"}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertPicturesFlyout","4210426229"),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertPicturesFlyoutBing","1685987254"),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture.FromSearch"}));var a;this.addCommandToMaps((a=new Xa.a("InsertPicturesFlyoutM365","2691408781"),a.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",a));let b;this.addCommandToMaps((b=new Xa.a("InsertPicturesM365",
"2582565347"),b.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",b));let c;this.addCommandToMaps((c=new Xa.a("InsertPicturesFlyoutDevice","1403967063"),c.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromDevice",c));let f;this.addCommandToMaps((f=new Xa.a("InsertPicturesFlyoutOneDrive","720118144"),f.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromHost",f.queryCommandId="3612507612",f));let l;this.addCommandToMaps((l=new Xa.a("InsertPicturesFlyoutMobileDevice",
"509870209"),l.legacyControlId="InsertPictureFromMobileDevice",l));this.addCommandToMaps(new Xa.a("InsertSlides","2325171983"));let w;this.addCommandToMaps((w=new Xa.a("NewSlideSplit","82992945"),w.populationProps=new Vg("82992945",!1),w));let F;this.addCommandToMaps((F=new Xa.a("InsertSlideSplit","82992945"),F.populationProps=new Vg("82992945",!1),F));this.addCommandToMaps(new Xa.a("NewDefaultSlide","3455582195"));let S;this.addCommandToMaps((S=new Xa.a("ChangeLayoutFlyout","3827850816"),S.populationProps=
new Vg("3827850816",!1),S));this.addCommandToMaps(new Xa.a("InsertTextBox","621502440"));this.addCommandToMaps(new Xa.a("InsertAudio","1970478872"));let fa;this.addCommandToMaps((fa=new Xa.a("InsertFooterFlyout","3104125356"),fa.legacyControlId="PptRibbon.InsertTab.FooterFlyout",fa));let xa;this.addCommandToMaps((xa=new Xa.a("InsertSymbol","3471878106"),xa.populationProps=new Vg("1256496096",!0),xa));this.addCommandToMaps(new Xa.a("InsertTable","975293073"));this.addCommandToMaps(new Xa.a("InvokeFilesSerplet",
"2670256092"));let Za;this.addCommandToMaps((Za=new Xa.a("Italic","2465268493"),Za.queryCommandId="1611154215",Za));this.addCommandToMaps(new Xa.a("LeftToRight","3104595117"));let pb;this.addCommandToMaps((pb=new Xa.a("LineSpacing","2060090051"),pb.legacyControlId="PptRibbon.Home.Paragraph.LineSpacing",pb.populationProps=new Vg("1834449059",!1),pb));let Mb;this.addCommandToMaps((Mb=new Xa.a("LineSpacingButton1_00","2116781230"),Mb.queryCommandId="35350118",Mb.menuItemId="1.00",Mb));let hc;this.addCommandToMaps((hc=
new Xa.a("LineSpacingButton1_50","2116781230"),hc.queryCommandId="35350118",hc.menuItemId="1.50",hc));let kc;this.addCommandToMaps((kc=new Xa.a("LineSpacingButton2_00","2116781230"),kc.queryCommandId="35350118",kc.menuItemId="2.00",kc));let Ec;this.addCommandToMaps((Ec=new Xa.a("LineSpacingButton2_50","2116781230"),Ec.queryCommandId="35350118",Ec.menuItemId="2.50",Ec));let Hc;this.addCommandToMaps((Hc=new Xa.a("LineSpacingButton3_00","2116781230"),Hc.queryCommandId="35350118",Hc.menuItemId="3.00",
Hc));this.addCommandToMaps(new Xa.a("LineSpacingOptionsForParagraphDialog","2465215107"));this.addCommandToMaps(new Xa.a("MarkActivitiesAsRead","4050369966"));let Dc;this.addCommandToMaps((Dc=new Xa.a("ModeSwitcherEditing","3913721881"),Dc.queryCommandId="1628548419",Dc.legacyControlId="ModeSwitcherModeEditing",Dc));let Td;this.addCommandToMaps((Td=new Xa.a("ModeSwitcherViewing","1819007276"),Td.queryCommandId="805191912",Td.legacyControlId="ModeSwitcherModeViewing",Td));this.addCommandToMaps(new Xa.a("ModeSwitcher",
"951953502"));this.addCommandToMaps(new Xa.a("MoreSymbols","3574218963"));let we;this.addCommandToMaps((we=new Xa.a("MoreVariantsAnchor","2759977169"),we.queryCommandId="1425701611",we.populationProps=new Vg("1296027845",!1),we.previewControlIds=["Variant1","Variant2","Variant3","Variant4"],we));this.addCommandToMaps(new Xa.a("MoveEarlier","3807076847"));this.addCommandToMaps(new Xa.a("MoveLater","1987590765"));this.addCommandToMaps(new Xa.a("MoveSectionDown","28073490"));this.addCommandToMaps(new Xa.a("MoveSectionUp",
"1653897933"));let Pd;this.addCommandToMaps((Pd=new Xa.a("NewComment","1221260928"),Pd.queryCommandId="3603834084",Pd));this.addCommandToMaps(new Xa.a("NewSlide","2325171983"));this.addCommandToMaps(new Xa.a("NewSlideWithoutDialog","3455582195"));let He;this.addCommandToMaps((He=new Xa.a("NextComment","1216077466"),He.queryCommandId="960339554",He));this.addCommandToMaps(new Xa.a("NoHighlight","562361573"));let Pe;this.addCommandToMaps((Pe=new Xa.a("Notes","3113372712"),Pe.queryCommandId="850829913",
Pe));let Df;this.addCommandToMaps((Df=new Xa.a("NumberingLibrary","1839018819"),Df.legacyControlId="PptRibbon.Home.Paragraph.NumberedGallery",Df.queryCommandId="3839110149",Df.populationProps=new Vg("579378886",!1),Df));this.addCommandToMaps(new Xa.a("OpenHyperlink","2898648224"));this.addCommandToMaps(new Xa.a("OpenPowerPointLanguageDialog","3274206189"));let ig;this.addCommandToMaps((ig=new Xa.a("OpenSetSlideSizeDialog","2541495854"),ig.queryCommandId="3939319117",ig));this.addCommandToMaps(new Xa.a("OpenVersionHistory",
"3828599598"));this.addCommandToMaps(new Xa.a("Outdent","3770030225"));this.addCommandToMaps(new Xa.a("ParagraphOptions","2465215107"));this.addCommandToMaps(new Xa.a("Paste","3642315978"));if(this.la.v8a){this.addCommandToMaps(new Xa.a("PasteGalleryIcon","3642315978"));this.addCommandToMaps(new Xa.a("PasteKeepingDestinationTheme","4207422373"));this.addCommandToMaps(new Xa.a("PasteKeepingSourceFormatting","2529825506"));let ZA;this.addCommandToMaps((ZA=new Xa.a("PasteTextOnlyGalleryIcon","2061487721"),
ZA.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",ZA));this.la.FRa&&this.addCommandToMaps(new Xa.a("PasteAsImage","1302928870"))}let Tg;this.addCommandToMaps((Tg=new Xa.a("PasteSlideKeepDestinationFromClipService","771058974"),Tg.queryCommandId="565176158",Tg));let Ig;this.addCommandToMaps((Ig=new Xa.a("PasteSlideKeepSourceFromClipService","756680259"),Ig.queryCommandId="565176158",Ig));let Ff;this.addCommandToMaps((Ff=new Xa.a("PasteTextOnly","2061487721"),Ff.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",
Ff));this.addCommandToMaps(new Xa.a("PlayFromBeginning","3477644587"));this.addCommandToMaps(new Xa.a("PlayFromBeginningTopBar","4039328901"));this.addCommandToMaps(new Xa.a("PlayFromCurrentSlide","1989200744"));let nh;this.addCommandToMaps((nh=new Xa.a("PresentLive","1637880125"),nh.legacyControlId="PresentLive",nh));let Jg;this.addCommandToMaps((Jg=new Xa.a("PresentLiveTopBar","1865567899"),Jg.legacyControlId="PresentLiveTopBar",Jg));let $h;this.addCommandToMaps(($h=new Xa.a("PresentLiveSetAccessControlAnyone",
"946150894"),$h.legacyControlId="PresentLiveSetAccessControlAnyone",$h.queryCommandId="677830988",$h));let Li;this.addCommandToMaps((Li=new Xa.a("PresentLiveSetAccessControlOrganization","2341101003"),Li.legacyControlId="PresentLiveSetAccessControlOrganization",Li.queryCommandId="289063903",Li));let Aj;this.addCommandToMaps((Aj=new Xa.a("PresentLiveConsumer","1637880125"),Aj.legacyControlId="PresentLiveConsumer",Aj));let Zi;this.addCommandToMaps((Zi=new Xa.a("PresentLiveEnterprise","1637880125"),
Zi.legacyControlId="PresentLiveEnterprise",Zi));let Ui;this.addCommandToMaps((Ui=new Xa.a("PresentToTeams","455397214"),Ui.legacyControlId="PresentToTeams",Ui));let Bi;this.addCommandToMaps((Bi=new Xa.a("PresentToTeamsTopBar","3640090982"),Bi.legacyControlId="PresentToTeamsTopBar",Bi));let Dk;this.addCommandToMaps((Dk=new Xa.a("PreviousComment","3774691014"),Dk.queryCommandId="1093530254",Dk));this.addCommandToMaps(new Xa.a("ReadingView","3849298593"));let kj;this.addCommandToMaps((kj=new Xa.a("PictureCrop",
"1517579890"),kj.queryCommandId="3115882543",kj));this.addCommandToMaps(new Xa.a("PictureCropAnchor","3997897477"));let rk;this.addCommandToMaps((rk=new Xa.a("PictureCropMoreOptions","1751580504"),rk.queryCommandId="2750148704",rk));this.addCommandToMaps(new Xa.a("Redo","4096109295"));let ml;this.addCommandToMaps((ml=new Xa.a("RehearsalFeedbackSettings","4006743010"),ml.legacyControlId="PptRibbon.View.Coach.Menu.FeedbackSettings",ml.queryCommandId="4191121318",ml));let nl;this.addCommandToMaps((nl=
new Xa.a("RehearsePresentation","1256345977"),nl.legacyControlId="PptRibbon.View.Coach.RehearseWithCoach",nl));let Bl;this.addCommandToMaps((Bl=new Xa.a("RehearsePresentationTopBar","4242063947"),Bl.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachTopBar",Bl));let bk;this.addCommandToMaps((bk=new Xa.a("RehearsePresentationDropDown","2954393506"),bk.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachSplit",bk));this.addCommandToMaps(new Xa.a("RemoveHyperlink","3041840712"));this.addCommandToMaps(new Xa.a("RemoveSection",
"3170937055"));this.addCommandToMaps(new Xa.a("RenameSection","2116436229"));this.addCommandToMaps(new Xa.a("Replace","3610473921"));this.addCommandToMaps(new Xa.a("ResetPicture","2916220093"));this.addCommandToMaps(new Xa.a("ResetPictureAndSize","196543355"));this.addCommandToMaps(new Xa.a("ResetPictureSplitButton","539331929"));this.addCommandToMaps(new Xa.a("RightToLeft","3544607309"));this.addCommandToMaps(new Xa.a("RotateAnchor","508548220"));this.addCommandToMaps(new Xa.a("RotateShapeAnchor",
"1974731707"));let Bj;this.addCommandToMaps((Bj=new Xa.a("RotateLeft","3198368600"),Bj.commandPreviewId="3069929632",Bj.commandRevertId="2958393181",Bj));let ck;this.addCommandToMaps((ck=new Xa.a("RotateRight","4074498273"),ck.commandPreviewId="1789937815",ck.commandRevertId="2958393181",ck));this.addCommandToMaps(new Xa.a("RotateFlipVertical","2497743792"));this.addCommandToMaps(new Xa.a("RotateFlipHorizontal","2421665126"));this.addCommandToMaps(new Xa.a("SelectHyperlink","942179484"));this.addCommandToMaps(new Xa.a("SendBackward",
"565697619"));this.addCommandToMaps(new Xa.a("SendToBack","3409991090"));this.addCommandToMaps(new Xa.a("SendToBackFlyout","380857685"));this.la.QMa&&(this.addCommandToMaps(new Xa.a("SetAnimationDuration","2191769768")),this.addCommandToMaps(new Xa.a("SetAnimationDelay","3045176093")),this.addCommandToMaps(new Xa.a("AnimationStart","3585107924")),a=new Xa.a("AnimationPane","2041032783"),a.queryCommandId="3793934102",this.addCommandToMaps(a));let al;this.addCommandToMaps((al=new Xa.a("SetHeight","2298348760"),
al.queryCommandId="1846108968",al));let Cj;this.addCommandToMaps((Cj=new Xa.a("SetWidth","3074609079"),Cj.queryCommandId="2155304935",Cj));let oh;this.addCommandToMaps((oh=new Xa.a("SetSlideSize","410316994"),oh.legacyControlId="PptRibbon.Design.Customize.SetSlideSizeAnchor",oh));let bl;this.addCommandToMaps((bl=new Xa.a("SetSlideSize4x3","991302939"),bl.queryCommandId="117694331",bl));let Ol;this.addCommandToMaps((Ol=new Xa.a("SetSlideSize16x9","1045213174"),Ol.queryCommandId="3694235222",Ol));let qm;
this.addCommandToMaps((qm=new Xa.a("SetTransitionApplyAll","36898206"),qm.queryCommandId="1981682194",qm));this.addCommandToMaps(Object.assign(new Xa.a("SetTransitionDuration","2632939091"),{queryCommandId:"1116601283"}));this.addCommandToMaps(new Xa.a("ShapeAlignAnchor","3459695103"));this.addCommandToMaps(new Xa.a("ShapeAlignLeft","3305017221"));this.addCommandToMaps(new Xa.a("ShapeAlignRight","1461684922"));this.addCommandToMaps(new Xa.a("ShapeAlignTop","4227848161"));this.addCommandToMaps(new Xa.a("ShapeAlignBottom",
"3217780865"));this.addCommandToMaps(new Xa.a("ShapeAlignCenter","716806441"));this.addCommandToMaps(new Xa.a("ShapeAlignMiddle","3185305339"));this.addCommandToMaps(Object.assign(new Xa.a("ShapeAlignToSlide","3006728226"),{queryCommandId:"3837288634"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeAlignToSelectedObjects","96121440"),{queryCommandId:"4251588920"}));this.addCommandToMaps(new Xa.a("ShareSlide","4016340186"));this.addCommandToMaps(new Xa.a("DistributeShapesVertically","56689666"));
this.addCommandToMaps(Object.assign(new Xa.a("ImmersiveReader","1676602274"),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(Object.assign(new Xa.a("ImmersiveReaderRibbon","4161584078"),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(new Xa.a("DistributeShapesHorizontally","1208810892"));this.addCommandToMaps(new Xa.a("ShareSlide","4016340186"));this.addCommandToMaps(Object.assign(new Xa.a("Shrink","3739304922"),{legacyControlId:"PptRibbon.Home.Font.Shrink"}));this.addCommandToMaps(Object.assign(new Xa.a("ShowCommentsTopBar",
"2281051331"),{legacyControlId:"ShowCommentsTopBar",queryCommandId:"847427893"}));this.addCommandToMaps(Object.assign(new Xa.a("ShowComments","1991203991"),{queryCommandId:"3845423030"}));this.addCommandToMaps(Object.assign(new Xa.a("ShowEditTriPaneView","12696731"),{queryCommandId:"363623614"}));this.addCommandToMaps(Object.assign(new Xa.a("ShowHideChanges","3927853644"),{queryCommandId:"3387413100"}));let sk;this.addCommandToMaps((sk=new Xa.a("ShowHideComments","1991203991"),sk.legacyControlId=
"PptRibbon.View.ShowHide.CommentsSplitButton",sk.queryCommandId="3845423030",sk));let Ek;this.addCommandToMaps((Ek=new Xa.a("ShowHideCommentsInReview","1991203991"),Ek.queryCommandId="3845423030",Ek));let ai;this.addCommandToMaps((ai=new Xa.a("ShowHideRuler","2898025271"),ai.legacyControlId="btnShowHideRuler",ai.queryCommandId="2852668822",ai));this.addCommandToMaps(new Xa.a("ShowRevisionTrackingWithUrlOverrides","3206663165"));let tg;this.addCommandToMaps((tg=new Xa.a("ShowMarkup","410757179"),tg.queryCommandId=
"992822777",tg));let gi;this.addCommandToMaps((gi=new Xa.a("ShowTranslatePane","119484543"),gi.legacyControlId="PptRibbon.Review.Show.Translate",gi));let Tf;this.addCommandToMaps((Tf=new Xa.a("ShowSmartLookupPane","4195071443"),Tf.legacyControlId="PptRibbon.Review.Show.SmartLookup",Tf));this.addCommandToMaps(new Xa.a("SmartLookupContextMenu","2861781337"));this.addCommandToMaps(new Xa.a("SmartLookupSynonyms","720345883"));let wd;this.addCommandToMaps((wd=new Xa.a("ShowSorterView","1659792175"),wd.queryCommandId=
"2246678568",wd));let oe;this.addCommandToMaps((oe=new Xa.a("ShowVersionHistoryDialog","466976539"),oe.legacyControlId="PptJewel.Info.VersionHistory",oe));let rf;this.addCommandToMaps((rf=new Xa.a("SpokenLanguage","1014932740"),rf.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage",rf.queryCommandId="1014932740",rf.populationProps=new Vg("1014932740",!0),rf));this.addCommandToMaps(new Xa.a("StandardFontColorPicker","3314514081"));let Vd;this.addCommandToMaps((Vd=new Xa.a("Strikethrough",
"1470251202"),Vd.legacyControlId="PptRibbon.Home.Font.Strikethrough",Vd.queryCommandId="1885033626",Vd));let yg;this.addCommandToMaps((yg=new Xa.a("SubtitleLanguage","3756604230"),yg.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage",yg.queryCommandId="3756604230",yg.populationProps=new Vg("3756604230",!0),yg));let hi;this.addCommandToMaps((hi=new Xa.a("SubtitleSettingsAnchor","2442582554"),hi.legacyControlId="PptRibbon.View.Subtitles.SubtitleSettings",hi));let vi;this.addCommandToMaps((vi=
new Xa.a("Subscript","2764952028"),vi.legacyControlId="PptRibbon.Home.Font.Subscript",vi.queryCommandId="1002244424",vi));let To;this.addCommandToMaps((To=new Xa.a("Superscript","3148114157"),To.legacyControlId="PptRibbon.Home.Font.Superscript",To.queryCommandId="2241670795",To));this.addCommandToMaps(new Xa.a("TabSwitch","3190032724"));this.addCommandToMaps(new Xa.a("TextAlignmentAnchor","2988805339"));let tk;this.addCommandToMaps((tk=new Xa.a("TextAlignmentCenterJustify","33632174"),tk.queryCommandId=
"2252885982",tk));let Fo;this.addCommandToMaps((Fo=new Xa.a("TextAlignmentFullJustify","1344066782"),Fo.legacyControlId="PptRibbon.Home.Paragraph.FullJustify",Fo.queryCommandId="2466914778",Fo));let Dt;this.addCommandToMaps((Dt=new Xa.a("TextAlignmentLeftJustify","1845468918"),Dt.queryCommandId="712471458",Dt));let Et;this.addCommandToMaps((Et=new Xa.a("TextAlignmentRightJustify","3813372745"),Et.queryCommandId="3610192823",Et));let Ft;this.addCommandToMaps((Ft=new Xa.a("TextAnchoringBottom","4124180856"),
Ft.queryCommandId="4231771752",Ft));let Gt;this.addCommandToMaps((Gt=new Xa.a("TextAnchoringMiddle","1377620466"),Gt.queryCommandId="967867926",Gt));let Ht;this.addCommandToMaps((Ht=new Xa.a("TextAnchoringTop","3318339922"),Ht.queryCommandId="1945464878",Ht));this.addCommandToMaps(new Xa.a("ThemeFontColorPicker","3314514081"));this.addCommandToMaps(new Xa.a("ThemeFontColorPickerMCU","3314514081"));let As;this.addCommandToMaps((As=new Xa.a("TopOverlaid","3728831786"),As.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",
As.queryCommandId="87234146",As));let It;this.addCommandToMaps((It=new Xa.a("Underline","704785013"),It.queryCommandId="451272227",It));this.addCommandToMaps(new Xa.a("Undo","2066390191"));let Jt;this.addCommandToMaps((Jt=new Xa.a("UsePresenterView","1082097282"),Jt.queryCommandId="2289226602",Jt));this.addCommandToMaps(new Xa.a("Zoom","3864281841"));let wy;this.addCommandToMaps((wy=new Xa.a("ToggleUseSubtitles","1906012838"),wy.legacyControlId="PptRibbon.View.Subtitles.UseSubtitles",wy.queryCommandId=
"3244674241",wy));let $A;this.addCommandToMaps(($A=new Xa.a("ToggleShapeAlignToSlide","3006728226"),$A.queryCommandId="3837288634",$A));let aB;this.addCommandToMaps((aB=new Xa.a("ToggleShapeAlignToSelectedObjects","96121440"),aB.queryCommandId="4251588920",aB));let xy;this.addCommandToMaps((xy=new Xa.a("ToggleSubtitlesBottomOverlay","348484772"),xy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",xy.queryCommandId="1824785548",xy));let yy;this.addCommandToMaps((yy=new Xa.a("ToggleSubtitlesTopOverlay",
"3728831786"),yy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",yy.queryCommandId="87234146",yy));let zy;this.addCommandToMaps((zy=new Xa.a("ToggleRehearsalVisionEnabled","2400267914"),zy.legacyControlId="PptRibbon.View.Coach.Menu.Vision",zy.queryCommandId="2360689666",zy));let bB;this.addCommandToMaps((bB=new Xa.a("HostOpenInClient","3588168074"),bB.legacyControlId="HostOpenInClient",bB));let Ay;this.addCommandToMaps((Ay=new Xa.a("ToggleSubtitlesBelowSlide","3783536693"),
Ay.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",Ay.queryCommandId="793233593",Ay));let By;this.addCommandToMaps((By=new Xa.a("ToggleSubtitlesAboveSlide","3886090397"),By.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",By.queryCommandId="3771385025",By));let Cy;this.addCommandToMaps((Cy=new Xa.a("BelowSlide","3783536693"),Cy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",Cy.queryCommandId="793233593",Cy));let Dy;this.addCommandToMaps((Dy=
new Xa.a("AboveSlide","3886090397"),Dy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",Dy.queryCommandId="3771385025",Dy));let cB;this.addCommandToMaps((cB=new Xa.a("PreviousVersions","3681556347"),cB.legacyControlId="PptJewel.Info.FileVersion",cB));this.addCommandToMaps(new Xa.a("Present","149770451"));this.addCommandToMaps(new Xa.a("PresentDropDown","2832668252"))}oYh(){this.addCommandToMaps(Object.assign(new Xa.a("CenterJustify","33632174"),{queryCommandId:"2252885982"}));
this.addCommandToMaps(Object.assign(new Xa.a("FullJustify","1344066782"),{queryCommandId:"2466914778"}));this.addCommandToMaps(Object.assign(new Xa.a("LeftJustify","1845468918"),{queryCommandId:"712471458"}));this.addCommandToMaps(Object.assign(new Xa.a("RightJustify","3813372745"),{queryCommandId:"3610192823"}));this.addCommandToMaps(Object.assign(new Xa.a("TextAnchoringAnchor","4088099806"),{queryCommandId:"4088099806"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignBottom","4124180856"),
{queryCommandId:"4231771752"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignMiddle","1377620466"),{queryCommandId:"967867926"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTop","3318339922"),{queryCommandId:"1945464878"}));this.addCommandToMaps(Object.assign(new Xa.a("UseSubtitles","1906012838"),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:"3244674241"}));this.addCommandToMaps(Object.assign(new Xa.a("SubtitleSettings","2442582554"),{legacyControlId:"PptRibbon.View.Subtitles.SubtitleSettings"}));
this.addCommandToMaps(new Xa.a("NewBringForwardAnchorMLR","200712034"));this.addCommandToMaps(new Xa.a("NewSendBackwardAnchorMLR","200712034"));this.addCommandToMaps(new Xa.a("PowerPointGroupFlyoutAnchorMLR","3206512596"));this.addCommandToMaps(Object.assign(new Xa.a("SetLockAspectRatio","3110635152"),{queryCommandId:"393974196"}));this.addCommandToMaps(Object.assign(new Xa.a("SetTableHeight","2276581567"),{queryCommandId:"2124999663"}));this.addCommandToMaps(Object.assign(new Xa.a("SetTableWidth",
"1330950330"),{queryCommandId:"1194765274"}));this.addCommandToMaps(Object.assign(new Xa.a("SetTableColumnWidth","673579960"),{queryCommandId:"480435988"}));this.addCommandToMaps(Object.assign(new Xa.a("SetTableRowHeight","1676474821"),{queryCommandId:"2851222057"}));this.addCommandToMaps(Object.assign(new Xa.a("UpdatePictureCropWidth","3859579721"),{queryCommandId:"2405860646"}));this.addCommandToMaps(Object.assign(new Xa.a("UpdatePictureCropHeight","2435251774"),{queryCommandId:"520230123"}));this.addCommandToMaps(Object.assign(new Xa.a("UpdatePictureCropLeft",
"436396424"),{queryCommandId:"1395081307"}));this.addCommandToMaps(Object.assign(new Xa.a("UpdatePictureCropTop","1511741212"),{queryCommandId:"4078650667"}));this.addCommandToMaps(Object.assign(new Xa.a("Paste_MLR","3642315978"),{queryCommandId:"616071690"}));this.la.v8a&&(this.addCommandToMaps(new Xa.a("PasteKeepingDestinationThemeMLR","4207422373")),this.addCommandToMaps(new Xa.a("PasteKeepingSourceFormattingMLR","2529825506")),this.la.FRa&&this.addCommandToMaps(new Xa.a("PasteAsImageMLR","1302928870")));
this.addCommandToMaps(Object.assign(new Xa.a("TableCellBottomAnchoringMLR","4124180856"),{queryCommandId:"4231771752"}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellCenterJustifyMLR","33632174"),{queryCommandId:"2252885982"}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellLeftJustifyMLR","1845468918"),{queryCommandId:"712471458"}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellMiddleAnchoringMLR","1377620466"),{queryCommandId:"967867926"}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellRightJustifyMLR",
"3813372745"),{queryCommandId:"3610192823"}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellTopAnchoringMLR","3318339922"),{queryCommandId:"1945464878"}));this.addCommandToMaps(new Xa.a("ParagraphOptionsMLR","2465215107"));this.addCommandToMaps(new Xa.a("Delete_MLR","1680865470"));this.addCommandToMaps(new Xa.a("SmartArtStylesMLR","3002291327"));this.addCommandToMaps(new Xa.a("PictureCropMLR","1775519606"))}VFd(){this.addTabToMap("FormatShape","107954394");this.addTabToMap("FormatPicture",
"4025007766");this.addTabToMap("SmartArtDesign","405308450");this.addTabToMap("Table","4018640415");this.addTabToMap("Graphics","1515418926");this.addTabToMap("Playback","2572738953");this.addTabToMap("AudioFormat","1107276369");this.addTabToMap("Audio","3778566220");this.addTabToMap("AccessibleAuthoring","906344264")}vYh(){this.addCommandToMaps(Object.assign(new Xa.a("PptJewelDownloadACopyAsOdp","1249692773"),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsOdp"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelDownloadACopyAsPdf",
"2439343378"),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsPdf"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelDownloadACopy","3555692408"),{legacyControlId:"PptJewel.DownloadAs.DownloadACopy"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelDownloadAsImages","1191538800"),{legacyControlId:"PptJewel.DownloadAs.DownloadAsImages"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelNew","1784018444"),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelOpen",
"1784018444"),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Xa.a("New","1784018444"),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Xa.a("Open","1784018444"),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelPrintFullSlide","1588554917"),{legacyControlId:"PptJewel.Print.PrintFullSlide"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelPrintHandouts","2255327903"),{legacyControlId:"PptJewel.Print.PrintHandouts"}));
this.addCommandToMaps(Object.assign(new Xa.a("PptJewelPrintNotes","277798930"),{legacyControlId:"PptJewel.Print.PrintNotes"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelPrintToPdf","1588554917"),{legacyControlId:"PptJewel.Print.PrintToPdf"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelRename","2382951455"),{legacyControlId:"PptJewel.Rename.RenameDialog"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelSaveACopy","1924572812"),{legacyControlId:"PptJewel.SaveACopy.SaveACopy"}));
this.addCommandToMaps(Object.assign(new Xa.a("PptJewelSaveAsToHost","3098027807"),{legacyControlId:"PptJewel.SaveACopy.SaveAsToHost"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelSaveToSharePoint","3131236268"),{legacyControlId:"PptJewel.SaveACopy.SaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelTrustCenter","2583751502"),{legacyControlId:"PptJewel.About.TrustCenter"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelVersionHistory","466976539"),{legacyControlId:"PptJewel.Info.VersionHistory"}));
this.addCommandToMaps(Object.assign(new Xa.a("PptJewelPreviousVersions","3681556347"),{legacyControlId:"PptJewel.Info.FileVersion"}))}rYh(){this.addCommandToMaps(Object.assign(new Xa.a("ApplyShapeStyleAnchor","3720025301"),{populationProps:new Vg("3882730173",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyShapeStylePreviewGallery","1963674920"),{queryCommandId:"2375118752",populationProps:new Vg("3882730173",!1),previewControlIds:"ApplyShapeStyle0 ApplyShapeStyle1 ApplyShapeStyle2 ApplyShapeStyle3 ApplyShapeStyle4 ApplyShapeStyle5 ApplyShapeStyle6".split(" ")}));
this.addCommandToMaps(Object.assign(new Xa.a("ApplyGraphicsStyleAnchor","1151870219"),{populationProps:new Vg("4014445414",!1)}));this.addCommandToMaps(new Xa.a("FontRecentColors","1298905754"));this.addCommandToMaps(Object.assign(new Xa.a("GraphicsStylePreviewGallery","2748140308"),{queryCommandId:"1903137544",populationProps:new Vg("4014445414",!1),previewControlIds:"ApplyGraphicsStyle0 ApplyGraphicsStyle1 ApplyGraphicsStyle2 ApplyGraphicsStyle3 ApplyGraphicsStyle4 ApplyGraphicsStyle5 ApplyGraphicsStyle6".split(" ")}));
this.addCommandToMaps(Object.assign(new Xa.a("GraphicsFill","3761243910"),{populationProps:new Vg("2646172177",!1)}));this.addCommandToMaps(new Xa.a("GraphicNoFill","3260600091"));this.addCommandToMaps(new Xa.a("GraphicNoOutline","730443428"));this.addCommandToMaps(Object.assign(new Xa.a("GraphicsOutline","546881287"),{populationProps:new Vg("3094707506",!1)}));this.addCommandToMaps(new Xa.a("MoreFillColors","1532790410"));this.addCommandToMaps(new Xa.a("MoreFontColors","862825906"));this.addCommandToMaps(new Xa.a("MoreFormatBackgroundColors",
"3938657252"));this.addCommandToMaps(new Xa.a("MoreOutlineColors","3472910327"));this.addCommandToMaps(Object.assign(new Xa.a("ShowHideFormatShapePane","3440753649"),{queryCommandId:"1038885196"}));this.addCommandToMaps(Object.assign(new Xa.a("MoreRotationOptions","3440753649"),{queryCommandId:"1038885196"}));this.addCommandToMaps(Object.assign(new Xa.a("PictureBorders","2359362870"),{populationProps:new Vg("3094707506",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeFill","2501194553"),
{populationProps:new Vg("2646172177",!1),commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeFillRecentColors","3745557472"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(new Xa.a("ShapeNoFill","2667121814"));this.addCommandToMaps(new Xa.a("ShapeNoOutline","1732643493"));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutline","2359362870"),{populationProps:new Vg("3094707506",!1)}));this.addCommandToMaps(new Xa.a("ShapeOutlineRecentColors",
"1244537109"));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineDashStyle_1","4208988856"),{menuItemId:"ShapeOutlineDashStyle,1"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineDashStyle_2","4208988856"),{menuItemId:"ShapeOutlineDashStyle,2"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineDashStyle_4","4208988856"),{menuItemId:"ShapeOutlineDashStyle,4"}));this.addCommandToMaps(new Xa.a("ShapeOutlineDashStyleAnchor","1735838055"));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineSketchStyle_1",
"106876572"),{menuItemId:"ShapeOutlineSketchStyle,1"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineSketchStyle_2","106876572"),{menuItemId:"ShapeOutlineSketchStyle,2"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineSketchStyle_3","106876572"),{menuItemId:"ShapeOutlineSketchStyle,3"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineSketchStyle_4","106876572"),{menuItemId:"ShapeOutlineSketchStyle,4"}));this.addCommandToMaps(new Xa.a("ShapeOutlineSketchStyleAnchor",
"1427890675"));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_1","2315200227"),{menuItemId:"ShapeOutlineEndStyle,1"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_2","2315200227"),{menuItemId:"ShapeOutlineEndStyle,2"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_3","2315200227"),{menuItemId:"ShapeOutlineEndStyle,3"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_4","2315200227"),{menuItemId:"ShapeOutlineEndStyle,4"}));
this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_5","2315200227"),{menuItemId:"ShapeOutlineEndStyle,5"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_6","2315200227"),{menuItemId:"ShapeOutlineEndStyle,6"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_7","2315200227"),{menuItemId:"ShapeOutlineEndStyle,7"}));this.addCommandToMaps(new Xa.a("ShapeOutlineEndStyleAnchor","819989304"));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineWidth_1",
"774557385"),{menuItemId:"ShapeOutlineWidth,1"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineWidth_2","774557385"),{menuItemId:"ShapeOutlineWidth,2"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineWidth_3","774557385"),{menuItemId:"ShapeOutlineWidth,3"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineWidth_4","774557385"),{menuItemId:"ShapeOutlineWidth,4"}));this.addCommandToMaps(new Xa.a("ShapeOutlineWidthAnchor","94872576"));this.addCommandToMaps(new Xa.a("StandardGraphicFillColorPicker",
"3761243910"));this.addCommandToMaps(new Xa.a("StandardGraphicOutlineColorPicker","546881287"));this.addCommandToMaps(Object.assign(new Xa.a("StandardShapeFillColorPicker","2501194553"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(new Xa.a("StandardShapeOutlineColorPicker","2359362870"));this.addCommandToMaps(new Xa.a("ThemeGraphicFillColorPicker","3761243910"));this.addCommandToMaps(new Xa.a("ThemeGraphicFillColorPickerMCU","3761243910"));this.addCommandToMaps(new Xa.a("ThemeGraphicOutlineColorPicker",
"546881287"));this.addCommandToMaps(new Xa.a("ThemeGraphicOutlineColorPickerMCU","546881287"));this.addCommandToMaps(Object.assign(new Xa.a("ThemeShapeFillColorPickerMCU","2501194553"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemeShapeFillColorPicker","2501194553"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(new Xa.a("ThemeShapeOutlineColorPicker","2359362870"));this.addCommandToMaps(new Xa.a("ThemeShapeOutlineColorPickerMCU",
"2359362870"))}wYh(){this.addCommandToMaps(Object.assign(new Xa.a("Themes","2963456035"),{queryCommandId:"2203652940",previewControlIds:"ThemesOfficeTheme ThemesAtlas ThemesMadison ThemesIon ThemesOrganic ThemesFrame".split(" ")}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesOfficeTheme","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesAtlas","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesMadison",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesIon","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesOrganic","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesFrame","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesIonBoardroom","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesMesh",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesRetrospect","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesSlice","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesSavon","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesBanded","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesQuotable",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesWoodType","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesBasis","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesIntegral","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesWisp","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesDividend",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesCelestial","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesParallax","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesMetropolitan","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesFacet","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesViewTheme",
"2963456035"),{queryCommandId:"2203652940"}))}yYh(){this.addCommandToMaps(Object.assign(new Xa.a("Transitions","2024601249"),{queryCommandId:"149145197",previewControlIds:"TransitionExisting TransitionNone TransitionMorph TransitionCut TransitionFade TransitionPush TransitionWipe".split(" ")}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionExisting","3752636652"),{legacyControlId:"TransitionExisting",queryCommandId:"3476251476"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionExistingInMenu",
"4036532528"),{legacyControlId:"TransitionExistingInMenu",queryCommandId:"2831233208"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionNone","2024601249"),{legacyControlId:"TransitionNone",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionMorph","2024601249"),{legacyControlId:"TransitionMorph",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCut","2024601249"),{legacyControlId:"TransitionCut",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Xa.a("TransitionFade","2024601249"),{legacyControlId:"TransitionFade",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionPush","2024601249"),{legacyControlId:"TransitionPush",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionWipe","2024601249"),{legacyControlId:"TransitionWipe",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionSplit","2024601249"),{legacyControlId:"TransitionSplit",
queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionRandomBars","2024601249"),{legacyControlId:"TransitionRandomBars",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionShape","2024601249"),{legacyControlId:"TransitionShape",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionComb","2024601249"),{legacyControlId:"TransitionComb",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionBlinds",
"2024601249"),{legacyControlId:"TransitionBlinds",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionBox","2024601249"),{legacyControlId:"TransitionBox",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCover","2024601249"),{legacyControlId:"TransitionCover",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCube","2024601249"),{legacyControlId:"TransitionCube",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCurtains",
"2024601249"),{legacyControlId:"TransitionCurtains",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionDissolve","2024601249"),{legacyControlId:"TransitionDissolve",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionOrbit","2024601249"),{legacyControlId:"TransitionOrbit",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionPageCurl","2024601249"),{legacyControlId:"TransitionPageCurl",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Xa.a("TransitionPeelOff","2024601249"),{legacyControlId:"TransitionPeelOff",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionRandom","2024601249"),{legacyControlId:"TransitionRandom",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionReveal","2024601249"),{legacyControlId:"TransitionReveal",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionRotate","2024601249"),
{legacyControlId:"TransitionRotate",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionUncover","2024601249"),{legacyControlId:"TransitionUncover",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionWheel","2024601249"),{legacyControlId:"TransitionWheel",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionRipple","2024601249"),{legacyControlId:"TransitionRipple",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionBox",
"2024601249"),{legacyControlId:"TransitionBox",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCube","2024601249"),{legacyControlId:"TransitionCube",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionSwitch","2024601249"),{legacyControlId:"TransitionSwitch",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionFallOver","2024601249"),{legacyControlId:"TransitionFallOver",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Xa.a("TransitionDrape","2024601249"),{legacyControlId:"TransitionDrape",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionFlip","2024601249"),{legacyControlId:"TransitionFlip",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionWind","2024601249"),{legacyControlId:"TransitionWind",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionPrestige","2024601249"),
{legacyControlId:"TransitionPrestige",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionFracture","2024601249"),{legacyControlId:"TransitionFracture",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCrush","2024601249"),{legacyControlId:"TransitionCrush",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionAirplane","2024601249"),{legacyControlId:"TransitionAirplane",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Xa.a("TransitionOrigami","2024601249"),{legacyControlId:"TransitionOrigami",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionChecker","2024601249"),{legacyControlId:"TransitionChecker",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionVortex","2024601249"),{legacyControlId:"TransitionVortex",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionGlitter",
"2024601249"),{legacyControlId:"TransitionGlitter",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionPan","2024601249"),{legacyControlId:"TransitionPan",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionGalleryIcon","2024601249"),{legacyControlId:"TransitionGalleryIcon",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionConveyor","2024601249"),{legacyControlId:"TransitionConveyor",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Xa.a("TransitionZoom","2024601249"),{legacyControlId:"TransitionZoom",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionFlyThrough","2024601249"),{legacyControlId:"TransitionFlyThrough",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionWindow","2024601249"),{legacyControlId:"TransitionWindow",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionDoors","2024601249"),
{legacyControlId:"TransitionDoors",queryCommandId:"149145197"}))}hYh(){this.addCommandToMaps(Object.assign(new Xa.a("Animations","2676673376"),{queryCommandId:"1852964326",previewControlIds:["AnimationExisting","AnimationNone","AnimationAppear","AnimationFadeIn","AnimationFlyIn"]}));this.addCommandToMaps(Object.assign(new Xa.a("AnimationExisting","298832323"),{queryCommandId:"1852964326"}));this.addCommandToMaps(Object.assign(new Xa.a("AnimationExistingInMenu","1264919631"),{queryCommandId:"1852964326"}));
for(const a of this.$Wj)this.addCommandToMaps(Object.assign(new Xa.a(a,"2676673376"),{queryCommandId:"1852964326"}))}gYh(){this.addCommandToMaps(Object.assign(new Xa.a("AnimationEffectOptions","1880806010"),{populationProps:new Vg("4148576519",!1)}));for(const a of this.WWj)this.addCommandToMaps(Object.assign(new Xa.a(a,"2949363495"),{queryCommandId:"4132852551",menuItemId:a.slice(this.XWj)}));for(const a of this.YWj)this.addCommandToMaps(Object.assign(new Xa.a(a,"2289594085"),{queryCommandId:"3782857737",
menuItemId:a.slice(this.ZWj)}));this.addCommandToMaps(new Xa.a("AnimationEffectOptionsThemeColorPickerMCU","679168237"));this.addCommandToMaps(new Xa.a("AnimationEffectOptionsThemeColorPicker","679168237"));this.addCommandToMaps(new Xa.a("AnimationEffectOptionsStandardColorPicker","679168237"));this.addCommandToMaps(Object.assign(new Xa.a("AnimationEffectOptionsSequenceAsOneObject","1850236812"),{queryCommandId:"1125291975",menuItemId:"AsOneObject"}));this.addCommandToMaps(Object.assign(new Xa.a("AnimationEffectOptionsSequenceAllAtOnce",
"2048458448"),{queryCommandId:"1125291975",menuItemId:"AllAtOnce"}));this.addCommandToMaps(Object.assign(new Xa.a("AnimationEffectOptionsSequenceByParagraph","3467781846"),{queryCommandId:"1125291975",menuItemId:"ByParagraph"}));this.addCommandToMaps(Object.assign(new Xa.a("AnimationEffectOptionsSequenceOneByOne","1486892994"),{queryCommandId:"1125291975",menuItemId:"OneByOne"}))}kYh(){this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundSolidFillFromCanvas","2710524593"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",
populationProps:new Vg("1073160204",!1)}));for(const a of this.HZj)this.addCommandToMaps(Object.assign(new Xa.a(a,"2710524593"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundSolidFillFromThumbnailPane","2624409683"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",populationProps:new Vg("4086319974",!1)}));for(const a of this.IZj)this.addCommandToMaps(Object.assign(new Xa.a(a,"2624409683"),
{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundApplyToAllFromCanvas","797658758"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundApplyToAllFromThumbnailPane","317738424"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundPictureFromCanvas","1067172319"),
{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundPictureFromThumbnailPane","713045573"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}))}xYh(){this.addCommandToMaps(Object.assign(new Xa.a("TransitionEffectOptions","317477235"),{populationProps:new Vg("1348655508",!1)}));for(const a of this.x7j)this.addCommandToMaps(Object.assign(new Xa.a(a,"961566706"),{queryCommandId:"3535869262",menuItemId:a.slice(this.y7j)}))}qYh(){this.addCommandToMaps(new Xa.a("PictureStyles",
"1158868185"));for(const a of this.H3j){const b=a.split("_")[2];this.addCommandToMaps(Object.assign(new Xa.a(a,"1158868185"),{queryCommandId:"1384172858",menuItemId:b}))}}sYh(){this.addCommandToMaps(new Xa.a("ChangeSmartArtLayoutAnchor","1203133001"));for(const a of this.oOg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Xa.a("Change"+a,"3290078594"),{queryCommandId:"1384172858",menuItemId:b[1]+","+b[2]}))}this.addCommandToMaps(Object.assign(new Xa.a("SmartArtEditText","2301457975"),
{queryCommandId:"2686363697"}));this.addCommandToMaps(new Xa.a("SmartArtDemote","4035125371"));this.addCommandToMaps(new Xa.a("SmartArtPromote","1313422623"));this.addCommandToMaps(new Xa.a("SmartArtResetGraphic","2099122511"));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtReverse","2753397958"),{queryCommandId:"2648853014"}));this.addCommandToMaps(new Xa.a("SmartArtStyles","3002291327"));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__simple1__simple","3002291327"),{queryCommandId:"1384172858",
menuItemId:"simple1,simple"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__simple2__simple","3002291327"),{queryCommandId:"1384172858",menuItemId:"simple2,simple"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__simple3__simple","3002291327"),{queryCommandId:"1384172858",menuItemId:"simple3,simple"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__simple4__simple","3002291327"),{queryCommandId:"1384172858",menuItemId:"simple4,simple"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__simple5__simple",
"3002291327"),{queryCommandId:"1384172858",menuItemId:"simple5,simple"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d1__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d1,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d2__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d2,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d3__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d3,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d4__3D",
"3002291327"),{queryCommandId:"1384172858",menuItemId:"3d4,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d5__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d5,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d6__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d6,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d7__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d7,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d8__3D",
"3002291327"),{queryCommandId:"1384172858",menuItemId:"3d8,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d9__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d9,3D"}))}nYh(){this.addCommandToMaps(new Xa.a("InsertSmartArtAnchor","3732507656"));for(const a of this.oOg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Xa.a(a,"2734600169"),{queryCommandId:"1384172858",menuItemId:b[1]+","+b[2]}))}}pYh(){this.addCommandToMaps(new Xa.a("PictureCropToShapeAnchor",
"1658415763"));for(const a of this.F3j)this.addCommandToMaps(Object.assign(new Xa.a(a,"682334988"),{queryCommandId:"1384172858"}))}mYh(){this.addCommandToMaps(new Xa.a("InsertShapesAll","650246100"));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStraightConnector","2523939501"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStraightConnectorArrow","1750723594"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStraightConnectorTwoArrow",
"3559452754"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeElbowConnector","1025603538"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeElbowArrowConnector","254882197"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeElbowDoubleArrowConnector","3675479226"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCurvedConnector","3570382728"),
{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCurvedArrowConnector","2475247497"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCurvedDoubleArrowConnector","3609233104"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRectangle","645832025"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRoundedRectangle","2299510778"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSnipSingleCornerRectangle","3474758074"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSnipSameSideCornerRectangle","3850613247"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSnipDiagonalCornerRectangle","2293630353"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSnipRoundSingleCornerRectangle","3574790146"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRoundSingleCornerRectangle","2164607454"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRoundSameSideCornerRectangle","2967902753"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRoundDiagonalCornerRectangle","93314647"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeTextBox","621502440"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeEllipse","2935469250"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeTriangle","1504176348"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRightTriangle","2485319550"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeParallelogram","770491129"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeTrapezoid",
"3412378376"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDiamond","3524776812"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSPentagon","2830940407"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeHexagon","656392472"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeHeptagon","1899461382"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeOctagon",
"3089112743"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDecagon","2150987117"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDodecagon","21081030"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapePie","2034251078"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeChord","3297467250"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeTeardrop",
"2496477627"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeFrame","4089189445"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeHalfFrame","529510678"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLShape","2250730235"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDiagonalStripe","3980577126"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCross",
"2988290636"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapePlaque","1062940640"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCan","2289466566"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCube","1564078521"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeBevel","1069783708"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDonut",
"603375116"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeNoSymbol","2566066899"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeBlockArc","2964829157"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeFoldedCorner","3416217987"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSmileyFace","3384731998"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeHeart","3360918184"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLightningBolt","1658476285"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSun","253099274"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeMoon","4091449115"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCloud",
"3297467381"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeArc","3122886792"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDoubleBracket","1269508949"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDoubleBrace","3209338176"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftBracket","961803587"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRightBracket","2545917082"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftBrace","2654567264"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRightBrace","2181960791"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRightArrow","3795105589"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftArrow",
"1270568434"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeUpArrow","2638665078"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDownArrow","671609167"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftRightArrow","954768594"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeUpDownArrow","3735909846"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeQuadArrow","2763384452"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftRightUpArrow","781992111"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeBentArrow","4266113576"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeUTurnArrow","3732223469"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftUpArrow",
"3750115875"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeBentUpArrow","4033796289"),{queryCommandId:"1384172858"}));let a;this.addCommandToMaps((a=new Xa.a("InsertShapeCurvedRightArrow","3819554122"),a.queryCommandId="1384172858",a));let b;this.addCommandToMaps((b=new Xa.a("InsertShapeCurvedLeftArrow","4069343241"),b.queryCommandId="1384172858",b));let c;this.addCommandToMaps((c=new Xa.a("InsertShapeCurvedUpArrow","2185082291"),c.queryCommandId="1384172858",
c));let f;this.addCommandToMaps((f=new Xa.a("InsertShapeCurvedDownArrow","976313414"),f.queryCommandId="1384172858",f));let l;this.addCommandToMaps((l=new Xa.a("InsertShapeStripedRightArrow","1658124824"),l.queryCommandId="1384172858",l));let w;this.addCommandToMaps((w=new Xa.a("InsertShapeNotchedRightArrow","457802308"),w.queryCommandId="1384172858",w));let F;this.addCommandToMaps((F=new Xa.a("InsertShapePentagon","2602819900"),F.queryCommandId="1384172858",F));let S;this.addCommandToMaps((S=new Xa.a("InsertShapeChevron",
"287050691"),S.queryCommandId="1384172858",S));let fa;this.addCommandToMaps((fa=new Xa.a("InsertShapeRightArrowCallout","1246382169"),fa.queryCommandId="1384172858",fa));let xa;this.addCommandToMaps((xa=new Xa.a("InsertShapeDownArrowCallout","3010992915"),xa.queryCommandId="1384172858",xa));let Za;this.addCommandToMaps((Za=new Xa.a("InsertShapeLeftArrowCallout","1220509638"),Za.queryCommandId="1384172858",Za));let pb;this.addCommandToMaps((pb=new Xa.a("InsertShapeUpArrowCallout","287463130"),pb.queryCommandId=
"1384172858",pb));let Mb;this.addCommandToMaps((Mb=new Xa.a("InsertShapeLeftRightArrowCallout","2303744502"),Mb.queryCommandId="1384172858",Mb));let hc;this.addCommandToMaps((hc=new Xa.a("InsertShapeQuadArrowCallout","1929705096"),hc.queryCommandId="1384172858",hc));let kc;this.addCommandToMaps((kc=new Xa.a("InsertShapeCircularArrow","3229643138"),kc.queryCommandId="1384172858",kc));let Ec;this.addCommandToMaps((Ec=new Xa.a("InsertShapeMathPlus","3675536706"),Ec.queryCommandId="1384172858",Ec));let Hc;
this.addCommandToMaps((Hc=new Xa.a("InsertShapeMathMinus","4100001190"),Hc.queryCommandId="1384172858",Hc));let Dc;this.addCommandToMaps((Dc=new Xa.a("InsertShapeMathMultiply","2861422166"),Dc.queryCommandId="1384172858",Dc));let Td;this.addCommandToMaps((Td=new Xa.a("InsertShapeMathDivide","168064503"),Td.queryCommandId="1384172858",Td));let we;this.addCommandToMaps((we=new Xa.a("InsertShapeMathEqual","2402760486"),we.queryCommandId="1384172858",we));let Pd;this.addCommandToMaps((Pd=new Xa.a("InsertShapeMathNotEqual",
"4184383381"),Pd.queryCommandId="1384172858",Pd));let He;this.addCommandToMaps((He=new Xa.a("InsertShapeProcess","1040093007"),He.queryCommandId="1384172858",He));let Pe;this.addCommandToMaps((Pe=new Xa.a("InsertShapeAlternateProcess","2060186255"),Pe.queryCommandId="1384172858",Pe));let Df;this.addCommandToMaps((Df=new Xa.a("InsertShapeDecision","2994325646"),Df.queryCommandId="1384172858",Df));let ig;this.addCommandToMaps((ig=new Xa.a("InsertShapeData","3600704532"),ig.queryCommandId="1384172858",
ig));let Tg;this.addCommandToMaps((Tg=new Xa.a("InsertShapePredefinedProcess","1912938133"),Tg.queryCommandId="1384172858",Tg));let Ig;this.addCommandToMaps((Ig=new Xa.a("InsertShapeInternalStorage","3699646902"),Ig.queryCommandId="1384172858",Ig));let Ff;this.addCommandToMaps((Ff=new Xa.a("InsertShapeDocument","372614031"),Ff.queryCommandId="1384172858",Ff));let nh;this.addCommandToMaps((nh=new Xa.a("InsertShapeMultidocument","3076056292"),nh.queryCommandId="1384172858",nh));let Jg;this.addCommandToMaps((Jg=
new Xa.a("InsertShapeTerminator","3309718409"),Jg.queryCommandId="1384172858",Jg));let $h;this.addCommandToMaps(($h=new Xa.a("InsertShapePreparation","2972619841"),$h.queryCommandId="1384172858",$h));let Li;this.addCommandToMaps((Li=new Xa.a("InsertShapeManualInput","3307458778"),Li.queryCommandId="1384172858",Li));let Aj;this.addCommandToMaps((Aj=new Xa.a("InsertShapeManualOperation","3480100343"),Aj.queryCommandId="1384172858",Aj));let Zi;this.addCommandToMaps((Zi=new Xa.a("InsertShapeConnector",
"2767398707"),Zi.queryCommandId="1384172858",Zi));let Ui;this.addCommandToMaps((Ui=new Xa.a("InsertShapeOffpageConnector","245535631"),Ui.queryCommandId="1384172858",Ui));let Bi;this.addCommandToMaps((Bi=new Xa.a("InsertShapeCard","851618206"),Bi.queryCommandId="1384172858",Bi));let Dk;this.addCommandToMaps((Dk=new Xa.a("InsertShapePunchedTape","2805408817"),Dk.queryCommandId="1384172858",Dk));let kj;this.addCommandToMaps((kj=new Xa.a("InsertShapeSummingJunction","1742457506"),kj.queryCommandId="1384172858",
kj));let rk;this.addCommandToMaps((rk=new Xa.a("InsertShapeOr","3387115369"),rk.queryCommandId="1384172858",rk));let ml;this.addCommandToMaps((ml=new Xa.a("InsertShapeCollate","1523313274"),ml.queryCommandId="1384172858",ml));let nl;this.addCommandToMaps((nl=new Xa.a("InsertShapeSort","240172272"),nl.queryCommandId="1384172858",nl));let Bl;this.addCommandToMaps((Bl=new Xa.a("InsertShapeExtract","2871548753"),Bl.queryCommandId="1384172858",Bl));let bk;this.addCommandToMaps((bk=new Xa.a("InsertShapeMerge",
"331056848"),bk.queryCommandId="1384172858",bk));let Bj;this.addCommandToMaps((Bj=new Xa.a("InsertShapeStoredData","2965521551"),Bj.queryCommandId="1384172858",Bj));let ck;this.addCommandToMaps((ck=new Xa.a("InsertShapeDelay","3728895005"),ck.queryCommandId="1384172858",ck));let al;this.addCommandToMaps((al=new Xa.a("InsertShapeSequentialActionStorage","1187616446"),al.queryCommandId="1384172858",al));let Cj;this.addCommandToMaps((Cj=new Xa.a("InsertShapeMagneticDisk","2595473951"),Cj.queryCommandId=
"1384172858",Cj));let oh;this.addCommandToMaps((oh=new Xa.a("InsertShapeDirectAccessStorage","3522000044"),oh.queryCommandId="1384172858",oh));let bl;this.addCommandToMaps((bl=new Xa.a("InsertShapeDisplay","2830261794"),bl.queryCommandId="1384172858",bl));let Ol;this.addCommandToMaps((Ol=new Xa.a("InsertShapeExplosion1","609854846"),Ol.queryCommandId="1384172858",Ol));let qm;this.addCommandToMaps((qm=new Xa.a("InsertShapeExplosion2","609854843"),qm.queryCommandId="1384172858",qm));let sk;this.addCommandToMaps((sk=
new Xa.a("InsertShapeStar4","1751654576"),sk.queryCommandId="1384172858",sk));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar5","3317738517"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar6","588855162"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar7","2154939103"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar8","3721023044"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar10","579353105"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar12","579353107"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar16","579353103"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar24","2145437042"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar32",
"3711520989"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeUpRibbon","3965372919"),{queryCommandId:"1384172858"}));let Ek;this.addCommandToMaps((Ek=new Xa.a("InsertShapeDownRibbon","1643393380"),Ek.queryCommandId="1384172858",Ek));let ai;this.addCommandToMaps((ai=new Xa.a("InsertShapeCurvedUpRibbon","1364669940"),ai.queryCommandId="1384172858",ai));let tg;this.addCommandToMaps((tg=new Xa.a("InsertShapeCurvedDownRibbon","1056258459"),tg.queryCommandId="1384172858",
tg));let gi;this.addCommandToMaps((gi=new Xa.a("InsertShapeVerticalScroll","1834894867"),gi.queryCommandId="1384172858",gi));let Tf;this.addCommandToMaps((Tf=new Xa.a("InsertShapeHorizontalScroll","2820192427"),Tf.queryCommandId="1384172858",Tf));let wd;this.addCommandToMaps((wd=new Xa.a("InsertShapeWave","3130421197"),wd.queryCommandId="1384172858",wd));let oe;this.addCommandToMaps((oe=new Xa.a("InsertShapeDoubleWave","3519851372"),oe.queryCommandId="1384172858",oe));let rf;this.addCommandToMaps((rf=
new Xa.a("InsertShapeRectangularCallout","1809100996"),rf.queryCommandId="1384172858",rf));let Vd;this.addCommandToMaps((Vd=new Xa.a("InsertShapeRoundedRectangleCallout","238089374"),Vd.queryCommandId="1384172858",Vd));let yg;this.addCommandToMaps((yg=new Xa.a("InsertShapeOvalCallout","4206313904"),yg.queryCommandId="1384172858",yg));let hi;this.addCommandToMaps((hi=new Xa.a("InsertShapeCloudCallout","1032389169"),hi.queryCommandId="1384172858",hi));let vi;this.addCommandToMaps((vi=new Xa.a("InsertShapeLineCallout1BorderAccent",
"3475705525"),vi.queryCommandId="1384172858",vi));let To;this.addCommandToMaps((To=new Xa.a("InsertShapeLineCallout2BorderAccent","1472318264"),To.queryCommandId="1384172858",To));let tk;this.addCommandToMaps((tk=new Xa.a("InsertShapeLineCallout3BorderAccent","1768130487"),tk.queryCommandId="1384172858",tk));let Fo;this.addCommandToMaps((Fo=new Xa.a("InsertShapeLineCallout1Accent","733785093"),Fo.queryCommandId="1384172858",Fo));let Dt;this.addCommandToMaps((Dt=new Xa.a("InsertShapeLineCallout2Accent",
"733609894"),Dt.queryCommandId="1384172858",Dt));let Et;this.addCommandToMaps((Et=new Xa.a("InsertShapeLineCallout3Accent","733857095"),Et.queryCommandId="1384172858",Et));let Ft;this.addCommandToMaps((Ft=new Xa.a("InsertShapeLineCallout1","1956296899"),Ft.queryCommandId="1384172858",Ft));let Gt;this.addCommandToMaps((Gt=new Xa.a("InsertShapeLineCallout2","1956296896"),Gt.queryCommandId="1384172858",Gt));let Ht;this.addCommandToMaps((Ht=new Xa.a("InsertShapeLineCallout3","1956296897"),Ht.queryCommandId=
"1384172858",Ht));let As;this.addCommandToMaps((As=new Xa.a("InsertShapeLineCallout1NoBorder","627424020"),As.queryCommandId="1384172858",As));let It;this.addCommandToMaps((It=new Xa.a("InsertShapeLineCallout2NoBorder","621637973"),It.queryCommandId="1384172858",It));let Jt;this.addCommandToMaps((Jt=new Xa.a("InsertShapeLineCallout3NoBorder","629787286"),Jt.queryCommandId="1384172858",Jt));this.addCommandToMaps(new Xa.a("InsertShapeTextBoxBig","621502440"))}jYh(){this.addCommandToMaps(Object.assign(new Xa.a(Wd.q7,
"2131010772"),{queryCommandId:"2524310320"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.MB,"2959280052"),{queryCommandId:"2162608508"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.VE,"2959280049"),{queryCommandId:"2565893035"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.UE,"2032762671"),{queryCommandId:"103713021"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.zia,"1898254474"),{queryCommandId:"958499386"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.C7a,"3738895990"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Xa.a(Wd.via,"3738895993"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.DCa,"3738895992"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.wia,"657096778"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.xia,"2223180719"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.ECa,"3789264660"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.FCa,
"3496085635"),{queryCommandId:"1964687729"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.p7,"2964465598"),{queryCommandId:"2403188966"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.GCa,"893000638"),{queryCommandId:"2949649726"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.HCa,"186315452"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.ICa,"186315449"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Xa.a(Wd.JCa,"186315450"),{queryCommandId:"1384172858"}))}uYh(){this.addCommandToMaps(Object.assign(new Xa.a("Select",
"1203133001"),{legacyControlId:"idTableSelect"}));this.addCommandToMaps(Object.assign(new Xa.a("SelectTable","2306914518"),{legacyControlId:"btnSelectTable"}));this.addCommandToMaps(Object.assign(new Xa.a("SelectColumn","2341852628"),{legacyControlId:"btnSelectColumn"}));this.addCommandToMaps(Object.assign(new Xa.a("SelectRow","3508003794"),{legacyControlId:"btnSelectRow"}));this.addCommandToMaps(Object.assign(new Xa.a("TableDelete","1203133001"),{legacyControlId:"idTableDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("PowerPointDeleteTableColumn",
"2998998226"),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("PowerPointDeleteTableRow","3269723356"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("DeleteTable","1819681963"),{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertRowAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertRowBelow","3709283166"),{legacyControlId:"btnInsertRowBelow"}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertColumnLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertColumnRight","1735639577"),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(new Xa.a("ApplyTableStyleOptionAnchor","1203133001"));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionHeaderRow","1583455318"),{legacyControlId:"buttonFirstRow",queryCommandId:"1762426222",menuItemId:"buttonFirstRow"}));
this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionFirstColumn","1583455318"),{legacyControlId:"buttonFirstColumn",queryCommandId:"1762426222",menuItemId:"buttonFirstColumn"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionTotalRow","1583455318"),{legacyControlId:"buttonLastRow",queryCommandId:"1762426222",menuItemId:"buttonLastRow"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionLastColumn","1583455318"),{legacyControlId:"buttonLastColumn",
queryCommandId:"1762426222",menuItemId:"buttonLastColumn"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionBandedRows","1583455318"),{legacyControlId:"buttonBandedRow",queryCommandId:"1762426222",menuItemId:"buttonBandedRow"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionBandedColumns","1583455318"),{legacyControlId:"buttonBandedColumn",queryCommandId:"1762426222",menuItemId:"buttonBandedColumn"}));this.addCommandToMaps(Object.assign(new Xa.a("PowerPointCellShadingMenuOpen",
"3704601382"),{legacyControlId:"cellShadingColor",populationProps:new Vg("2450035180",!1),menuItemId:"cellShadingColor"}));this.addCommandToMaps(new Xa.a("StandardCellShadingColorPicker","3704601382"));this.addCommandToMaps(new Xa.a("ThemeCellShadingColorPicker","3704601382"));this.addCommandToMaps(new Xa.a("ThemeCellShadingColorPickerMCU","3704601382"));this.addCommandToMaps(new Xa.a("NoCellShading","2292419401"));this.addCommandToMaps(new Xa.a("CellShadingMoreColors","1736670660"));this.addCommandToMaps(new Xa.a("CellShadingRecentColors",
"4078162917"));this.addCommandToMaps(Object.assign(new Xa.a("SetSizeAnchor","3089059537"),{queryCommandId:"149527692"}));this.addCommandToMaps(Object.assign(new Xa.a("MergeTableCells","93109791"),{legacyControlId:"btnMergeTableCells"}));this.addCommandToMaps(Object.assign(new Xa.a("SplitTableCells","1112879997"),{legacyControlId:"btnSplitTableCells"}));this.addCommandToMaps(new Xa.a("TableAnchor","2806772911"));this.addCommandToMaps(Object.assign(new Xa.a("TableStyles","4171428777"),{legacyControlId:"fsfaMoreTableStyles",
queryCommandId:"2135594455",populationProps:new Vg("3359297384",!1),previewControlIds:"buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" ")}));this.addCommandToMaps(new Xa.a("TableAlignmentAnchor","3250360533"));this.addCommandToMaps(Object.assign(new Xa.a("TableCellBottomAnchoring","4124180856"),{legacyControlId:"btnTableCellBottomAnchoring",queryCommandId:"4231771752"}));
this.addCommandToMaps(Object.assign(new Xa.a("TableCellCenterJustify","33632174"),{legacyControlId:"btnTableCellCenterJustify",queryCommandId:"2252885982"}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellLeftJustify","1845468918"),{legacyControlId:"btnTableCellLeftJustify",queryCommandId:"712471458"}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellMiddleAnchoring","1377620466"),{legacyControlId:"btnTableCellMiddleAnchoring",queryCommandId:"967867926"}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellRightJustify",
"3813372745"),{legacyControlId:"btnTableCellRightJustify",queryCommandId:"3610192823"}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellTopAnchoring","3318339922"),{legacyControlId:"btnTableCellTopAnchoring",queryCommandId:"1945464878"}));this.addCommandToMaps(new Xa.a("TableAlternativeText","3296909722"));this.addCommandToMaps(new Xa.a("DistributeRows","791526052"));this.addCommandToMaps(new Xa.a("DistributeColumns","4255324272"));this.addCommandToMaps(new Xa.a("TableDistribute","1576337241"));
this.addCommandToMaps(Object.assign(new Xa.a("SetCellBorderColor","1742993766"),{populationProps:new Vg("3585221234",!1)}));this.addCommandToMaps(new Xa.a("CellBorderColorPickerMCU","71763897"));this.addCommandToMaps(new Xa.a("CellBorderColorPicker","71763897"));this.addCommandToMaps(new Xa.a("StandardCellBorderColorPicker","71763897"));this.addCommandToMaps(new Xa.a("CellBorderRecentColors","1124206375"));this.addCommandToMaps(new Xa.a("CellBorderMoreColors","1138519801"));this.addCommandToMaps(new Xa.a("TableBorderWidthAnchor",
"1025523929"));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_1","1181009968"),{queryCommandId:"1928723436"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_2","1181009968"),{queryCommandId:"1928723435"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_3","1181009968"),{queryCommandId:"1928723434"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_4","1181009968"),{queryCommandId:"1928723441"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_5",
"1181009968"),{queryCommandId:"1928723440"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_6","1181009968"),{queryCommandId:"1928723439"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_7","1181009968"),{queryCommandId:"1928723438"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_8","1181009968"),{queryCommandId:"1928723429"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_9","1181009968"),{queryCommandId:"1928723428"}));this.addCommandToMaps(new Xa.a("TableBorderTypeAnchor",
"316937739"));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersNoBorder","920953916"),{queryCommandId:"2666589896"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersAllBorders","920953916"),{queryCommandId:"3505971410"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersOutsideBorders","920953916"),{queryCommandId:"259981150"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersInsideBorders","2426125916"),{queryCommandId:"1088761899"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersTopBorder",
"920953916"),{queryCommandId:"2150808318"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersBottomBorder","920953916"),{queryCommandId:"3072152572"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersLeftBorder","920953916"),{queryCommandId:"10301274"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersRightBorder","920953916"),{queryCommandId:"3005649147"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersInsideHorizontalBorder","2595242660"),{queryCommandId:"2049270673"}));
this.addCommandToMaps(Object.assign(new Xa.a("TableBordersInsideVerticalBorder","3890138642"),{queryCommandId:"4266964333"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersDiagonalUpBorder","920953916"),{queryCommandId:"4243465577"}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersDiagonalDownBorder","920953916"),{queryCommandId:"1969875420"}));this.addCommandToMaps(new Xa.a("TableCellMarginAnchor","3624082799"));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableCellMarginNormal",
"929276597"),{queryCommandId:"3122906487"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableCellMarginNone","570150258"),{queryCommandId:"2335710142"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableCellMarginNarrow","2448307869"),{queryCommandId:"1985856563"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableCellMarginWide","1262149989"),{queryCommandId:"2537223195"}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellMarginCustom","3089059537"),{queryCommandId:"149527692"}))}mZh(){this.zi(Object.assign(new $f("ContextualTabs.Tables.Design.Shading"),
{externalUxCommandIds:["PowerPointCellShadingMenuOpen"]}));this.zi(Object.assign(new $f("ContextualTabs.Tables.Design.TableStyleOptions"),{externalUxGroupId:"TableTableStyleOptions"}));this.zi(Object.assign(new $f("ContextualTabs.Tables.Design.TableStyles"),{externalUxGroupId:"TableStyles"}));this.zi(Object.assign(new $f("ContextualTabs.Tables.Layout.Alignment"),{externalUxGroupId:"Alignment"}));this.zi(Object.assign(new $f("ContextualTabs.Tables.Layout.CellSize"),{externalUxCommandIds:["SetSizeAnchor"]}));
this.zi(Object.assign(new $f("ContextualTabs.Tables.Layout.Properties"),{externalUxCommandIds:["AlternativeText"]}));this.zi(Object.assign(new $f("ContextualTabs.Tables.Layout.RowColumn"),{externalUxCommandIds:["TableDelete","InsertRowAbove","InsertRowBelow","InsertColumnLeft","InsertColumnRight"]}));this.zi(Object.assign(new $f("ContextualTabs.Tables.Layout.Table"),{externalUxCommandIds:["Select"]}));this.zi(Object.assign(new $f("ContextualTabs.Tables.Layout.TableSize"),{externalUxGroupId:"TableSize"}));
this.zi(Object.assign(new $f("PptRibbon.Animation.Gallery"),{externalUxGroupId:"AnimationGallery"}));this.zi(Object.assign(new $f("PptRibbon.Animation.Timing"),{externalUxGroupId:"Timing"}));this.zi(Object.assign(new $f("PptRibbon.Design.Customize"),{externalUxGroupId:"Customize"}));this.zi(Object.assign(new $f("PptRibbon.Design.Designer"),{externalUxGroupId:"Designer"}));this.zi(Object.assign(new $f("PptRibbon.Design.Designer.New"),{externalUxGroupId:"DesignerNew"}));this.zi(Object.assign(new $f("PptRibbon.Home.Designer"),
{externalUxGroupId:"DesignerHome"}));this.zi(Object.assign(new $f("PptRibbon.Home.Ideas"),{externalUxGroupId:"Ideas"}));this.zi(Object.assign(new $f("PptRibbon.Design.ThemeVariants"),{externalUxGroupId:"MoreVariants"}));this.zi(Object.assign(new $f("PptRibbon.DrawingFormat.InsertShapes"),{externalUxGroupId:"InsertShapes"}));this.zi(Object.assign(new $f("PptRibbon.DrawingFormat.ShapeStyles"),{externalUxGroupId:"ShapeStyles"}));this.zi(Object.assign(new $f("PptRibbon.Home.ClipboardCutEnabled"),{externalUxCommandIds:["Cut"]}));
this.zi(Object.assign(new $f("PptRibbon.Home.Delete"),{externalUxGroupId:"Delete"}));this.zi(Object.assign(new $f("PptRibbon.Home.Dictation"),{externalUxGroupId:"Dictation"}));this.zi(Object.assign(new $f("PptRibbon.Home.Drawing"),{externalUxGroupId:"Drawing"}));this.zi(Object.assign(new $f("PptRibbon.Home.Editing"),{externalUxGroupId:"Editing"}));this.zi(Object.assign(new $f("PptRibbon.Home.Font"),{externalUxGroupId:"Font"}));this.zi(Object.assign(new $f("PptRibbon.Home.Slides"),{externalUxGroupId:"Slides"}));
this.zi(Object.assign(new $f("PptRibbon.Home.UndoRedo"),{externalUxGroupId:"Undo"}));this.zi(Object.assign(new $f("PptRibbon.InsertTab.AppForOffice"),{externalUxCommandIds:["InsertAddIns"]}));this.zi(Object.assign(new $f("PptRibbon.InsertTab.Comments"),{externalUxCommandIds:["InsertComment"]}));this.zi(Object.assign(new $f("PptRibbon.InsertTab.Illustrations"),{externalUxCommandIds:["InsertShapesAll","InsertIconDialog","InsertSmartArtAnchor"]}));this.zi(Object.assign(new $f("PptRibbon.InsertTab.Images"),
{externalUxCommandIds:["Picture","OnlinePictures"]}));this.zi(Object.assign(new $f("PptRibbon.InsertTab.InsertHyperlink"),{externalUxCommandIds:["InsertLink"]}));this.zi(Object.assign(new $f("PptRibbon.InsertTab.InsertSlides"),{externalUxCommandIds:["InsertSlides"]}));this.zi(Object.assign(new $f("PptRibbon.InsertTab.InsertTables"),{externalUxCommandIds:["TableAnchor"]}));this.zi(Object.assign(new $f("PptRibbon.InsertTab.InvokeFilesSerplet"),{externalUxCommandIds:["InvokeFilesSerplet"]}));this.zi(Object.assign(new $f("PptRibbon.InsertTab.Media"),
{externalUxCommandIds:["InsertOnlineVideo"]}));this.zi(Object.assign(new $f("PptRibbon.InsertTab.Symbols"),{externalUxCommandIds:["InsertSymbol"]}));this.zi(Object.assign(new $f("PptRibbon.InsertTab.Text"),{externalUxCommandIds:["InsertTextBox"]}));this.zi(Object.assign(new $f("PptRibbon.PictureFormat.Adjust"),{externalUxGroupId:"Adjust"}));this.zi(Object.assign(new $f("PptRibbon.PictureFormat.Size"),{externalUxCommandIds:["PictureCropAnchor"]}));this.zi(Object.assign(new $f("PptRibbon.PictureFormat.Style"),
{externalUxGroupId:"PictureStyles"}));this.zi(Object.assign(new $f("PptRibbon.Review.Comments"),{externalUxGroupId:"Comments"}));this.zi(Object.assign(new $f("PptRibbon.Review.Inspect"),{externalUxGroupId:"Accessibility"}));this.zi(Object.assign(new $f("PptRibbon.Review.Translate "),{externalUxGroupId:"Translate"}));this.zi(Object.assign(new $f("PptRibbon.Review.Activity"),{externalUxGroupId:"Activity"}));this.zi(Object.assign(new $f("PptRibbon.SmartArt.CreateGraphic"),{externalUxGroupId:"SmartArtCreateGraphic"}));
this.zi(Object.assign(new $f("PptRibbon.SmartArt.Layouts"),{externalUxGroupId:"SmartArtLayouts"}));this.zi(Object.assign(new $f("PptRibbon.SmartArt.Reset"),{externalUxGroupId:"SmartArtReset"}));this.zi(Object.assign(new $f("PptRibbon.SmartArt.Styles"),{externalUxGroupId:"SmartArtStyles"}));this.zi(Object.assign(new $f("PptRibbon.Transition.AllSlides"),{externalUxGroupId:"TransitionAllSlides"}));this.zi(Object.assign(new $f("PptRibbon.Transition.Gallery"),{externalUxGroupId:"Transitions"}));this.zi(Object.assign(new $f("PptRibbon.Transition.Timing"),
{externalUxGroupId:"TransitionTiming"}));this.zi(Object.assign(new $f("PptRibbon.Review.Proofing"),{externalUxGroupId:"Proofing"}));this.zi(Object.assign(new $f("PptRibbon.View.PresentationViews"),{externalUxCommandIds:["ReadingView"]}));this.zi(Object.assign(new $f("PptRibbon.View.ShowHide"),{externalUxCommandIds:["Notes","ShowHideComments"]}));this.zi(Object.assign(new $f("PptRibbon.View.StartSlideShow"),{externalUxGroupId:"StartSlideShow"}));this.zi(Object.assign(new $f("PptRibbon.View.Zoom"),
{externalUxGroupId:"Zoom"}));this.zi(Object.assign(new $f("PptRibbon.View.Subtitles"),{externalUxGroupId:"Subtitles"}));this.zi(Object.assign(new $f("PptRibbon.Help.GroupHelp"),{externalUxGroupId:"Help"}));this.zi(Object.assign(new $f("PptRibbon.PictureFormat.PictureBorders"),{externalUxGroupId:"PictureBorders"}));this.zi(Object.assign(new $f("PptRibbon.DrawingFormat.NewArrange"),{externalUxGroupId:"Arrange"}));this.zi(Object.assign(new $f("PptRibbon.PictureFormat.NewArrange"),{externalUxGroupId:"Arrange"}));
this.zi(Object.assign(new $f("PptRibbon.Graphics.NewArrange"),{externalUxGroupId:"GraphicsArrange"}));this.zi(Object.assign(new $f("PptRibbon.DrawingFormat.FormatOptions"),{externalUxGroupId:"Properties"}));this.zi(Object.assign(new $f("PptRibbon.PictureFormat.FormatOptions"),{externalUxGroupId:"Size"}));this.zi(Object.assign(new $f("PptRibbon.Graphics.FormatOptions"),{externalUxGroupId:"Properties"}))}eYh(){this.addCommandToMaps(Object.assign(new Xa.a("PptFileMenuEmbed","981175184"),{legacyControlId:"PptJewel.Share.Embed"}));
this.addCommandToMaps(Object.assign(new Xa.a("PptFileMenuShare","981334692"),{legacyControlId:"PptJewel.Share.ShareWithPeople"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileMenuTermsOfUse","2349775795"),{legacyControlId:"PptJewel.About.TermsOfUse"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileMenuThirdPartyNotices","2220417879"),{legacyControlId:"PptJewel.About.ThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileMenuPrivacy","1208554566"),{legacyControlId:"PptJewel.About.Privacy"}));
this.addCommandToMaps(Object.assign(new Xa.a("PptFileAboutPage","336231556"),{legacyControlId:"PptJewel.About"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileHomePage","2074131365"),{legacyControlId:"PptJewel.Home"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileInfoPage","336231556"),{legacyControlId:"PptJewel.Info"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileNewPage","2074131365"),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileOpenPage",
"2799130311"),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFilePrintPage","336231556"),{legacyControlId:"PptJewel.Print"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileSaveAsPage","336231556"),{legacyControlId:"PptJewel.SaveACopy"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileSharePage","336231556"),{legacyControlId:"PptJewel.Share"}))}lYh(){this.addCommandToMaps(new Xa.a("GroupAnchor","3206512596"));this.addCommandToMaps(new Xa.a("GroupShapes",
"1084571292"));this.addCommandToMaps(new Xa.a("UngroupShapes","2681035587"))}iYh(){this.addCommandToMaps(new Xa.a("AudioPlay","354524898"));this.addCommandToMaps(new Xa.a("AudioPause","381759002"));this.addCommandToMaps(Object.assign(new Xa.a("SetAudioOptions","3754409354"),{queryCommandId:"934802286"}));this.addCommandToMaps(Object.assign(new Xa.a("PlayAcrossSlides","2830952303"),{queryCommandId:"4262270261"}));this.addCommandToMaps(Object.assign(new Xa.a("LoopUntilStopped","3632291603"),{queryCommandId:"3552942809"}));
this.addCommandToMaps(Object.assign(new Xa.a("HideDuringShow","3215231982"),{queryCommandId:"532089170"}));this.addCommandToMaps(Object.assign(new Xa.a("RewindAfterPlaying","3190911303"),{queryCommandId:"1283553413"}));this.addCommandToMaps(Object.assign(new Xa.a("PlayInBackground","1867854189"),{queryCommandId:"2980229931"}));this.addCommandToMaps(Object.assign(new Xa.a("NoAudioStyle","215519670"),{queryCommandId:"2550125834"}));this.addCommandToMaps(new Xa.a("SetVolume","489231152"));this.addCommandToMaps(Object.assign(new Xa.a("SetVolumeLow",
"3743080814"),{queryCommandId:"1369975562"}));this.addCommandToMaps(Object.assign(new Xa.a("SetVolumeMedium","3138571443"),{queryCommandId:"2162671853"}));this.addCommandToMaps(Object.assign(new Xa.a("SetVolumeHigh","2824132372"),{queryCommandId:"2284865724"}));this.addCommandToMaps(Object.assign(new Xa.a("SetVolumeMute","2837428403"),{queryCommandId:"2835961045"}));this.addCommandToMaps(Object.assign(new Xa.a("StartAudio","333691564"),{queryCommandId:"646903900"}))}tYh(){this.addCommandToMaps(Object.assign(new Xa.a("GetSlideInformation",
"798637440"),{queryCommandId:"1740197325"}));this.addCommandToMaps(Object.assign(new Xa.a("OpenLanguageDialog","3274206189"),{legacyControlId:"PptEditingStatusBar.LanguageButton",queryCommandId:"2048144900"}));this.addCommandToMaps(Object.assign(new Xa.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830"}));this.addCommandToMaps(Object.assign(new Xa.a("TextForOfficeOnlineInGallatin","798637440"),{legacyControlId:"PptEditingStatusBar.MiddleStatus"}));this.addCommandToMaps(Object.assign(new Xa.a("GetEnvironmentName",
"798637440"),{legacyControlId:"EnvironmentLabel",queryCommandId:"3887408216"}));this.addCommandToMaps(Object.assign(new Xa.a("GetSlideScore","798637440"),{legacyControlId:"SlideScoreLabel",queryCommandId:"1312683093"}));this.addCommandToMaps(Object.assign(new Xa.a("GetCoAuthStatus","798637440"),{legacyControlId:"CoauthStatusLabel",queryCommandId:"587300872"}));this.addCommandToMaps(Object.assign(new Xa.a("GetOfflineStatus","798637440"),{legacyControlId:"PptEditingStatusBar.OfflineModeStatusLabel",
queryCommandId:"225752111"}));this.addCommandToMaps(Object.assign(new Xa.a("ShowAddInCommandsLoadStatusCallout","516359383"),{legacyControlId:"PptEditingStatusBar.AddInCommandsLoadStatus",queryCommandId:"1309495434"}));this.addCommandToMaps(Object.assign(new Xa.a("OpenFeedbackDialog","802602464"),{legacyControlId:"PptEditingStatusBar.GiveFeedback"}));this.addCommandToMaps(Object.assign(new Xa.a("GiveFeedbackPane","2918242107"),{legacyControlId:"PptEditingStatusBar.GiveFeedbackPane"}));this.addCommandToMaps(Object.assign(new Xa.a("ShowHidePerfStats",
"2319158239"),{legacyControlId:"PptEditingStatusBar.PerfStats",queryCommandId:"298865648"}));this.addCommandToMaps(Object.assign(new Xa.a("ShowHideNotes","3113372712"),{legacyControlId:"PptEditingStatusBar.Notes",queryCommandId:"850829913"}));this.addCommandToMaps(Object.assign(new Xa.a("ShowEditTriPaneViewInStatusBar","12696731"),{legacyControlId:"PptEditingStatusBar.Edit",queryCommandId:"363623614"}));this.addCommandToMaps(Object.assign(new Xa.a("ShowSorterViewInStatusBar","1659792175"),{legacyControlId:"PptEditingStatusBar-SlideSorterView",
queryCommandId:"2246678568"}));this.addCommandToMaps(Object.assign(new Xa.a("SwitchToReadingMode","3849298593"),{legacyControlId:"PptEditingStatusBar.Reading"}));this.addCommandToMaps(Object.assign(new Xa.a("StartSlideShowFromCurrentSlide","1989200744"),{legacyControlId:"PptEditingStatusBar.SlideShow"}));this.addCommandToMaps(new Xa.a("ZoomOut","195579685"));this.addCommandToMaps(Object.assign(new Xa.a("OpenZoomConfig","3864281841"),{legacyControlId:"PptEditingStatusBar.ZoomScale",queryCommandId:"1923067973"}));
this.addCommandToMaps(new Xa.a("ZoomIn","3018530951"));this.addCommandToMaps(Object.assign(new Xa.a("ZoomToFit","2470172091"),{legacyControlId:"PptEditingStatusBar.FitToWindow"}))}fYh(){this.addCommandToMaps(new Xa.a("AccessibleAuthoringHelp","378041226"));this.addCommandToMaps(new Xa.a("AddHiddenSlideTitle","4032980552"));this.addCommandToMaps(new Xa.a("AddSlideTitle","2061524948"));this.addCommandToMaps(new Xa.a("EditSlideTitle","1049013003"));this.addCommandToMaps(new Xa.a("InsertCaptions","960930904"));
this.addCommandToMaps(new Xa.a("InsertCaptionsSplitButton","327712988"));this.addCommandToMaps(new Xa.a("LinkText","2488223096"));this.addCommandToMaps(new Xa.a("RemoveAllCaptions","2891615490"));this.addCommandToMaps(new Xa.a("SetAsSlideTitle","2069673123"));this.addCommandToMaps(new Xa.a("SlideTitle","3898323075"))}}Object(e.a)(YA,"PPTWebEditReactCommandDefinitionMapping",Pw,[]);class Ey{}Ey.jth="TabId";Object(e.a)(Ey,"RibbonSQMProperties",null,[]);class dB{constructor(a){this.Da=a;this.Da.ya(G.a.Ycd,
de.a.frame,Object(C.a)(this,this.Ycd,"reportTabSwitch"));this.Da.ya(G.a.Bdh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(G.a.Ddh,de.a.frame,Le.ActionManager.Dg)}Ycd(a,b,c,f,l){this.Da.processAction(this.x9i(l[Ey.jth]),2);return 32}}Object(e.a)(dB,"RibbonSQMInformation",null,[548]);class ph{}ph.Wyc="PptRibbon.AddIns";ph.Dga="PptRibbon.Animation";ph.design="PptRibbon.Design";ph.jGc="PptRibbon.Developer";ph.eOc="PptRibbon.Graphics";ph.help="PptRibbon.Help";ph.home="PptRibbon.Home";ph.insert="PptRibbon.InsertTab";
ph.picture="PptRibbon.PictureFormat";ph.review="PptRibbon.Review";ph.shape="PptRibbon.DrawingFormat";ph.slideShow="PptRibbon.SlideShow";ph.smartArt="PptRibbon.SmartArt";ph.Lth="ContextualTabs.Tables.Design";ph.tableLayout="ContextualTabs.Tables.Layout";ph.JYa="PptRibbon.Transition";ph.view="PptRibbon.View";Object(e.a)(ph,"MLRTabIds",null,[]);class fj{}fj.Wyc="AddIns";fj.Dga="Animations";fj.design="Design";fj.jGc="Developer";fj.draw="Draw";fj.eOc="Graphics";fj.help="Help";fj.home="Home";fj.insert=
"Insert";fj.picture="FormatPicture";fj.review="Review";fj.shape="FormatShape";fj.slideShow="SlideShow";fj.smartArt="SmartArtDesign";fj.table="Table";fj.JYa="Transitions";fj.view="View";Object(e.a)(fj,"SLRTabIds",null,[]);class $F extends dB{constructor(a){super(a)}LJk(){this.Da.ya(G.a.ndh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(aa.a.odh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(aa.a.pdh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(G.a.qdh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(aa.a.sdh,de.a.frame,
Le.ActionManager.Dg);this.Da.ya(G.a.tdh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(G.a.udh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(G.a.vdh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(aa.a.wdh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(G.a.xdh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(aa.a.ydh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(aa.a.zdh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(aa.a.Adh,de.a.frame,Le.ActionManager.Dg);this.Da.ya(aa.a.jEe,de.a.frame,Le.ActionManager.Dg);this.Da.ya(aa.a.Cdh,
de.a.frame,Le.ActionManager.Dg);this.Da.ya(G.a.Edh,de.a.frame,Le.ActionManager.Dg)}x9i(a){let b=G.a.Ddh,c="PptRibbon.Unknown";switch(a){case ph.Wyc:case fj.Wyc:c=ph.Wyc;b=G.a.ndh;break;case ph.Dga:case fj.Dga:c=ph.Dga;b=aa.a.odh;break;case ph.design:case fj.design:c=ph.design;b=aa.a.pdh;break;case ph.jGc:case fj.jGc:c=ph.jGc;b=G.a.qdh;break;case fj.draw:c=a;b=aa.a.rdh;break;case ph.eOc:case fj.eOc:c=ph.eOc;b=aa.a.sdh;break;case ph.help:case fj.help:c=ph.help;b=G.a.tdh;break;case ph.home:case fj.home:c=
ph.home;b=G.a.udh;break;case ph.insert:case fj.insert:c=ph.insert;b=G.a.vdh;break;case ph.picture:case fj.picture:c=ph.picture;b=aa.a.wdh;break;case ph.review:case fj.review:c=ph.review;b=G.a.xdh;break;case ph.shape:case fj.shape:c=ph.shape;b=aa.a.ydh;break;case ph.slideShow:case fj.slideShow:c=ph.slideShow;b=aa.a.zdh;break;case ph.smartArt:case fj.smartArt:c=ph.smartArt;b=aa.a.Adh;break;case ph.Lth:case ph.tableLayout:c=a;b=aa.a.jEe;break;case fj.table:c=ph.Lth;b=aa.a.jEe;break;case ph.JYa:case fj.JYa:c=
ph.JYa;b=aa.a.Cdh;break;case ph.view:case fj.view:c=ph.view,b=G.a.Edh}if(a=Kc.a.Db)a.actionName=c,a.Nj=!0,a.ur=!1;return b}}Object(e.a)($F,"PPTWebEditorRibbonSQMInformation",dB,[]);var Qw=d(899);class eB{constructor(){this.RJb=null}bol(){this.RJb||(this.RJb=lb.a.instance.qb("Common.App.AccountSwitching.IAccountSwitching"))||Z.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}hVi(){this.bol();return this.RJb?this.RJb.getCustomAuthConfig():null}static wCj(){return u.AFrameworkApplication.fa.ka("UiHostSupportsCustomAuthConfig")}}
Object(e.a)(eB,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class fB{constructor(){this.d5b=this.cultureName=null}}Object(e.a)(fB,"HeaderCultureInfo",null,[]);var Fy=d(657);class aG{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(e.a)(aG,"SearchInitializationSettings",null,[]);class bG{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=
this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(e.a)(bG,"DocumentTitleAppProps",null,[]);class cG{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=
null;this.openBreadcrumbsInNewTab=!1}}Object(e.a)(cG,"DocumentTitleCalloutAppProps",null,[]);class dG{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=
this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(e.a)(dG,"HeaderAppProps",null,[]);class eG{constructor(){this.workflowButton=
this.ribbonToggleId=null}}Object(e.a)(eG,"HeaderControls",null,[]);class fG{constructor(){this.command=this.label=null}}Object(e.a)(fG,"WorkflowButtonAppProps",null,[]);var Gy;(function(a){a[a.none=0]="none";a[a.readOnly=1]="readOnly";a[a.insufficientPermission=2]="insufficientPermission";a[a.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";a[a.editorsPresent=4]="editorsPresent";a[a.notSupported=5]="notSupported"})(Gy||(Gy={}));Object(e.b)("RenameDisableReason",Gy);class gG{constructor(a=
""){this.kGe=this.documentTitleAppProps=this.$Te=null;this.wUh=""!==a?a:qp.a.pO}L8i(a){const b=lb.a.instance.qb("Common.IExternalUICommandDefinitionMapping").FBa(a);if(b&&0<b.length)return b[0].externalUxCommand;Z.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",a));return null}R1d(){if(!this.$Te){const a=Qw.a();if(a){const b=this.L8i(a.command);b&&(this.$Te=Object.assign(new fG,{command:b,label:a.label}))}}return this.$Te}dZi(){return Object.assign(new eG,
{workflowButton:this.R1d()})}Vgk(){Oc.a.get_instance().bJ(17)}onMove(){const a={};a.MoveButtonClickedTime=new Date;u.AFrameworkApplication.Va.Ma(G.a.ncb,2,a)}j9i(a){switch(a){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}X_i(){let a=null,b=null;var c=lb.a.instance.qb("Common.IRenameProps");
c?(c=c.Pbg(),0!==c&&(a=this.j9i(c),b=Gy[c])):Z.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new cG,{breadcrumbBrandName:u.AFrameworkApplication.$t.breadcrumbBrandName,breadcrumbBrandUrl:u.AFrameworkApplication.$t.breadcrumbBrandUrl,breadcrumbFolderName:u.AFrameworkApplication.$t.breadcrumbFolderName,breadcrumbFolderUrl:u.AFrameworkApplication.$t.breadcrumbFolderUrl,hideDocumentTitleInput:u.AFrameworkApplication.Ba.jb.Xpj,isVersionHistoryEnabled:this.i8k(),
documentExtension:Ja.a.nV(u.AFrameworkApplication.fileName),isMoveEnabled:32===u.AFrameworkApplication.Va.processAction(G.a.ncb,1),onMove:Object(C.a)(this,this.onMove,"onMove"),message:a,renameDisableReason:b,openBreadcrumbsInNewTab:u.AFrameworkApplication.fa.ka("OpenLinksInNewWindow")})}k8f(){if(!this.documentTitleAppProps){const a=u.AFrameworkApplication.$t.nx;this.documentTitleAppProps=Object.assign(new bG,{documentTitle:u.AFrameworkApplication.RGc?a:Ja.a.jG(a),onFirstRender:Object(C.a)(this,this.Vgk,
"onDocumentTitleFirstRender"),getCalloutAppProps:Object(C.a)(this,this.X_i,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}i8k(){return!!u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.Zvg}t6k(){return!!u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.$Kj}U7k(){const a=!Qw.b()&&!u.AFrameworkApplication.hideHeader&&!u.AFrameworkApplication.Vig&&(u.AFrameworkApplication.fa.ka("SkypeWebControlIsEnabled")||u.AFrameworkApplication.fa.ka("TeamsChatIsEnabled"));
Z.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",a);return a}fsi(a){appChrome.getHeaderApi().then(b=>{b.setNavBarData(a.result);return null});Z.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}XHk(){appChrome.getHeaderApi().then(a=>{const b=lb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");a.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});a.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});a.setHeaderCommandHandler("OnFlexPaneOpen",
c=>{b.onFlexPaneOpen(c)});a.setHeaderCommandHandler("OnFlexPaneClose",c=>{b.onFlexPaneClose(c)});a.setHeaderCommandHandler("SetCookie",c=>Di.a.set(c.cookieName,c.value));a.setHeaderCommandHandler("GetCookie",c=>this.eZi(c));a.setHeaderCommandHandler("QueryWorkflowButtonSettings",Object(C.a)(this,this.R1d,"getWorkflowButtonAppProps"));a.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(C.a)(this,this.k8f,"getDocumentTitleAppProps"));a.setHeaderCommandHandler("OnDocumentTitleReducerReady",
()=>{this.Wgk();return null});Fy.a.oTc()&&a.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(C.a)(this,this.jcg,"getSearchInitializationSettings"))})}Wgk(){lb.a.instance.Oa("Common.App.SaveStatus.ISaveStatusUIHandler").execute(a=>{a.kna(!1,u.AFrameworkApplication.Va.mode)})}eZi(a){a=Di.a.get(a);void 0!==a&&null!==a&&0<a.length&&(a=decodeURIComponent(a));return a}wcj(){return fk.AppChromeOverrideUtilities.isEnabled?fk.AppChromeOverrideUtilities.getPath("suiteux-shell",!1):this.wUh+
u.AFrameworkApplication.X_+"suiteux-shell"}onFirstRender(){lb.a.instance.Oa("Common.App.O365Shell.IO365ShellActor").execute(a=>{a.I5k.continueWith(Object(C.a)(this,this.fsi,"continueShellServiceDataAsync"),3)});Oc.a.get_instance().bJ(15)}onFullyLoaded(){Oc.a.get_instance().bJ(16)}v8i(){a:{try{var a=qa.a.re(u.AFrameworkApplication.lcid);if(a){var b=Object.assign(new fB,{cultureName:a.name,d5b:a.d5b});break a}}catch(c){Z.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+
u.AFrameworkApplication.lcid.toString())}b=Object.assign(new fB,{cultureName:"en-us",d5b:"en"})}a=lb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");b=Object.assign(new dG,{appName:CommonUIStrings.l_AppNameShort,culture:b.cultureName,language:b.d5b,isConsumer:!u.AFrameworkApplication.gmd,showAppLauncher:Qw.e(),showMeControl:Qw.d(),hideUserName:u.AFrameworkApplication.P3d,defaultDocumentTitleToLeft:u.AFrameworkApplication.OTf,assetsContainerOverride:this.wcj(),controls:this.dZi(),
documentTitleAppProps:this.k8f(),showDocumentTitleControl:!0,showWorkflowButton:!!this.R1d(),showChatControl:this.U7k(),showGoPremiumControl:Qw.f(),enableSearchControl:Fy.a.BKj(),onFlexPaneOpen:Object(C.a)(a,a.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(C.a)(a,a.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.t6k(),testTraffic:u.AFrameworkApplication.fa.ka("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(C.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(C.a)(this,
this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:u.AFrameworkApplication.u6k()});!u.AFrameworkApplication.yhb||u.AFrameworkApplication.ULe?(b.userDisplayName=u.AFrameworkApplication.userName,b.emailAddress=u.AFrameworkApplication.fa.Ia("UserPrincipalName"),b.userID=u.AFrameworkApplication.fa.Ia("Puid")||"",b.signOutLink=u.AFrameworkApplication.ULe):u.AFrameworkApplication.signInUrl&&(b.signInLink=u.AFrameworkApplication.signInUrl);Fy.a.oTc()&&(a=this.jcg(),b.loadTellMeResources=a.loadTellMeResources,
b.getTokenRequestDictionary=a.getTokenRequestDictionary,b.enableVanillaSearchBox=u.AFrameworkApplication.fa.ka("VanillaSearchUxInHeaderIsEnabled"),b.userRing=a.userRing);eB.wCj()&&(a=new eB,b.shellAuthProviderConfigPromise=Object(C.a)(a,a.hVi,"getAccountSwitchingConfig"));this.XHk();return b}jcg(){if(!this.kGe){const a=new Fy.a;let b=u.AFrameworkApplication.fa.Ia("Microsoft365Ring");b&&b.length||(b="generalAudience");this.kGe=Object.assign(new aG,{loadTellMeResources:a.eSj(),getTokenRequestDictionary:Object(C.a)(a,
a.Ndj,"getTokenRequestDict"),userRing:b})}return this.kGe}}Object(e.a)(gG,"ReactSharedHeaderPropsHelper",null,[669]);var og=d(332),qP=d(1180),rP=d(1032);d(900);var hG=d(656);const Kt=(a,b)=>{let c=0;for(;b()&&c<a.length;)a[c](),c++},iG=(a,b,c,f)=>{if(a&&a.parentNode&&a.parentNode.parentNode){var l=(l=$g.a.Nu(a))?ya.a.wL(l.paddingLeft)+ya.a.wL(l.paddingRight):0;var w=$g.a.Nu(a.parentNode);w=w?ya.a.wL(w.paddingLeft)+ya.a.wL(w.paddingRight):0;let F=0,S=a;for(;S.nextSibling;)S=S.nextSibling,F+=S.offsetWidth;
l=l+w+F;"auto"!==a.parentNode.style.width&&(a.style.width=a.parentNode.offsetWidth-l+"px");w=f?c:b;c=f?b:c;f=id.a.ei(a.parentNode.parentNode);b=w?id.a.ei(w):new Sys.UI.Bounds(f.x,0,0,0);c=c?id.a.U5a(c):new Sys.UI.Point(f.x+f.width,0);"absolute"===a.parentNode.style.position?b=c.x-(b.x+b.width)-l-1:(f=id.a.ei(a.nextSibling?a.parentNode:a),f=f.x+f.width/2,b=2*Math.min(f-(b.x+b.width),c.x-f)-l-1);a.style.maxWidth=b+"px"}},Hy=a=>{a&&Sq(a)&&(a.style.display="",a._isHidden="0")},cl=a=>{a&&!Sq(a)&&(a.style.display=
"none",a._isHidden="1")},Sq=a=>{if(!a)return!0;a=a._isHidden;return!(void 0===a||null===a||"0"===a)},Bs=(a,b,c)=>{if(a&&!Sq(a)){var f=$g.a.Nu(a);f=ya.a.wL(f.paddingLeft)+ya.a.wL(f.paddingRight);c=a.offsetWidth-c-f;let l=0;for(;b&&b!==a;)(f=$g.a.Nu(b))&&(l+=ya.a.wL(f.paddingLeft)+ya.a.wL(f.paddingRight)),b=b.parentNode;c=Math.max(c,75+l);a.style.width=c+"px"}},Ir=a=>{a&&(a.style.width="auto",a.style.maxWidth="none")},sP=(a,b,c)=>{if(a&&b){let f=0,l=0;({left:f,top:l}=id.a.u8f(b,f,l));b=c?f-a.offsetWidth:
f+b.offsetWidth;a&&(a.style.position="absolute",a.style.left=b+"px")}},pq=(a,b,c)=>!a||!b||Sq(a)||Sq(b)?!1:id.a.Myg(id.a.ei(a),id.a.ei(b),c),Cs=(a,b,c)=>{let f=0;a&&b&&(f=id.a.pbe(id.a.ei(a),id.a.ei(b),c));return f};var Jr=d(349);class Iy{constructor(a,b,c){this.jqb=this.UXb=this.iqb=this.J4a=this.lHc=this.TXb=this.fG=this.SXb=this.GOa=this.tP=this.mHc=this.FOa=this.fba=this.Ku=this.hK=this.aS=this.EOa=this.I4a=this.H4a=this.ZAa=null;this.gR=a;this.KLb=b;this.Oi=c}qVk(a){this.gR=a;this.KLb=null;this.nVd(this.gR);
this.vyh();this.Qgh()}gXa(){this.gR&&this.KLb&&this.KLb.clientHeight&&(this.nVd(this.gR),this.vyh(),this.Qgh(),-1!==this.KLb.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.x2f(this.KLb),this.cpl(),this.uVk()))}nVd(a){if(a)for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c],l=ya.a.Rha(f),w=!!f.id;if(-1!==l.indexOf("cui-QATRowLeft"))this.ZAa=f;else if(-1!==l.indexOf("OfficeOnlineBrandBreadcrumbSeparator"))this.H4a=f;else if(f.id===rm.CuiHelper.EJd)this.I4a=f;else if(f.id===
rm.CuiHelper.J3f)this.EOa=f;else if(f.id===rm.CuiHelper.FJd)this.aS=f;else if(-1!==l.indexOf("cui-QATRowCenter"))this.hK=f;else if(f.id===rm.CuiHelper.GJd)this.Ku=f;else if(-1!==l.indexOf("cui-QATRowRight"))this.fba=f;else{var b;if(b=w)b=f,b=!!b.id&&(b.id.startsWith(rm.CuiHelper.DJe)||b.id.startsWith(rm.CuiHelper.Wcd));b?this.FOa=f:w&&f.id.startsWith(rm.CuiHelper.rbl)?this.mHc=f:-1!==l.indexOf("UsernameNameContainer")?this.tP=f:-1!==l.indexOf("UsernameNameItem")&&(this.GOa=f)}this.nVd(f)}}vyh(){var a=
[this.hK,this.Ku,this.tP],b=[this.H4a,this.I4a,this.EOa,this.aS,this.hK,this.Ku,this.fba,this.FOa,this.mHc,this.tP];for(const c of b)Hy(c);for(const c of a)Ir(c);if(a=this.hK)a.style.position="static",a.style.left="auto"}Qgh(){this.INd()?this.sVk():this.tVk();var a=this.EOa,b=this.aS;a&&b&&(a.style.marginTop=(b.offsetHeight-a.offsetHeight)/2+"px")}sVk(){let a;const b=this.GYd();a=[()=>{Bs(this.aS,this.aS,Cs(this.ZAa,b,this.Oi))},()=>{cl(this.H4a);cl(this.I4a);cl(this.EOa);cl(this.aS)}];Kt(a,()=>pq(this.aS,
b,this.Oi));pq(this.fG,this.hK,this.Oi)&&sP(this.hK,this.fG,this.Oi);this.yeh();a=[()=>{Bs(this.tP,this.GOa,Cs(this.fG,this.fba,this.Oi))},()=>{cl(this.FOa)}];this.zeh();Sq(this.hK)||Sq(this.Ku)||iG(this.Ku,this.fG,this.fba,this.Oi)}tVk(){const a=!!this.aS,b=!!this.Ku;let c=0;if((a||b)&&0<(c=Cs(this.ZAa,this.hK,this.Oi))){let f=a;b&&(!a||this.Ku.offsetWidth>this.aS.offsetWidth)&&(f=!1);Bs(f?this.aS:this.Ku,f?this.aS:this.Ku,f?c:2*c);a&&b&&0<(c=Cs(this.ZAa,this.hK,this.Oi))&&(f=!f,Bs(f?this.aS:this.Ku,
f?this.aS:this.Ku,f?c:2*c))}Kt([()=>{cl(this.H4a);cl(this.I4a);cl(this.EOa);cl(this.aS);Ir(this.Ku)},()=>{Bs(this.Ku,this.Ku,2*Cs(this.ZAa,this.hK,this.Oi))},()=>{cl(this.Ku)}],()=>pq(this.ZAa,this.hK,this.Oi));this.yeh();this.zeh();Sq(this.hK)||Sq(this.Ku)||iG(this.Ku,this.ZAa,this.fba,this.Oi)}yeh(){const a=Sq(this.Ku);Kt([()=>{this.PEe()},()=>{cl(this.FOa);Ir(this.Ku);Ir(this.tP);a||Hy(this.Ku)},()=>{this.PEe()},()=>{cl(this.mHc);Ir(this.Ku);Ir(this.tP);a||Hy(this.Ku)},()=>{this.PEe()}],()=>pq(this.hK,
this.fba,this.Oi))}PEe(){const a=!!this.Ku,b=!!this.tP;let c=0;if((a||b)&&0<(c=Cs(this.hK,this.fba,this.Oi))){const f=!!this.hK&&"absolute"!==this.hK.style.position;let l=a;b&&(!a||this.tP.offsetWidth>this.Ku.offsetWidth)&&(l=!1);Bs(l?this.Ku:this.tP,l?this.Ku:this.GOa,l&&f?2*c:c);a&&b?(0<(c=Cs(this.hK,this.fba,this.Oi))&&(l=!l,Bs(l?this.Ku:this.tP,l?this.Ku:this.GOa,l&&f?2*c:c)),pq(this.hK,this.fba,this.Oi)&&(cl(this.hK),Ir(this.tP))):a&&pq(this.hK,this.fba,this.Oi)&&cl(this.Ku)}}zeh(){const a=()=>
{Bs(this.tP,this.GOa,Cs(this.ZAa,this.fba,this.Oi))};Kt([a,()=>{cl(this.FOa);Ir(this.tP)},a,()=>{cl(this.mHc);Ir(this.tP)},a,()=>{cl(this.tP)}],()=>pq(this.ZAa,this.fba,this.Oi))}INd(){if(!this.fG)return!1;for(let a=0;a<this.fG.childNodes.length;a++)if(-1!==ya.a.Rha(this.fG.childNodes[a]).indexOf("cui-cg"))return!0;return!1}GYd(){if(!this.fG)return null;let a=null;for(let b=this.fG.childNodes.length-1;0<=b;b--){const c=this.fG.childNodes[b];if(-1===ya.a.Rha(c).indexOf("cui-cg"))break;a=c}return a}x2f(a){if(a)for(let b=
0;b<a.childNodes.length;b++){const c=a.childNodes[b],f=ya.a.Rha(c),l=!!c.id;-1!==f.indexOf("cui-jewel-container")?this.SXb=c:-1!==f.indexOf("cui-tts")?this.fG=c:-1!==f.indexOf("cui-TabRowInline")?this.TXb=c:-1!==f.indexOf("cui-separator")?this.lHc=c:l&&c.id.startsWith(rm.CuiHelper.C0g)?this.J4a=c:l&&c.id.startsWith(rm.CuiHelper.s1f)?this.iqb=c:-1!==f.indexOf("cui-TabRowRight")?this.UXb=c:l&&c.id.startsWith(rm.CuiHelper.txe)&&(this.jqb=c);this.x2f(c)}}cpl(){var a=[this.fG,this.TXb,this.lHc,this.J4a,
this.iqb,this.UXb,this.jqb];for(const b of a)Hy(b);this.fGb(0)}uVk(){let a;a=[()=>{cl(this.lHc);cl(this.J4a)},()=>{this.fGb(1)},()=>{this.fGb(2)},()=>{cl(this.TXb);this.fGb(0)}];Kt(a,()=>pq(this.fG,this.TXb,this.Oi));a=[()=>{cl(this.lHc);cl(this.J4a)},()=>{cl(this.iqb)},()=>{cl(this.jqb)},()=>{cl(this.UXb)}];Kt(a,()=>pq(this.TXb,this.UXb,this.Oi)||pq(this.fG,this.UXb,this.Oi));a=[()=>{this.fGb(1)},()=>{this.fGb(2)},()=>{cl(this.fG)}];Kt(a,()=>pq(this.SXb,this.fG,this.Oi))}fGb(a){this.fG&&(this.fG.className=
Iy.vgl[a],this.fG._scaleStep=a)}}Iy.vgl=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(e.a)(Iy,"TopBarScalingManager",null,[]);class jG{constructor(a,b){this.gR=this.iya=null;this._clientId=a;this.yrf=b}LKi(){if(!ol.b(this.gR))return this.gR;this.PJi();this.gR.style.display="block";this.yrf&&this.yrf.Aga(Object(C.a)(this,this.onResize,"onResize"));return this.gR}onResize(){this.gXa()}gXa(){this.kJi()?(document.getElementById("application").style.minWidth="0px",(new Iy(this.gR,null,u.AFrameworkApplication.isRtl)).qVk(this.gR)):
u.AFrameworkApplication.Ba.jb.kN||hG.a.rVk(this.gR,u.AFrameworkApplication.isRtl)}kJi(){return u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("EnhancedMobileViewIsEnabled"):!1}PJi(){if(ol.b(this.iya)){var a;({B1b:a}=Jr.a.AIb(!u.AFrameworkApplication.LP)).returnValue&&(this.iya=uA("div"),this.iya.className=Jr.a.pMi,this.iya.id=rm.CuiHelper.UTd,a.appendChild(this.iya),this.GJi(),u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.LRa&&!u.AFrameworkApplication.LP&&this.JJi(),this.KKi())}}KKi(){ol.b(this.gR)&&
(this.gR=uA("div"),this.gR.className=Jr.a.Ckl,this.gR.style.display="none",this.iya.appendChild(this.gR))}GJi(){Sys.UI.DomElement.addCssClass(this.iya,Jr.a.qMi);if(u.AFrameworkApplication.isRtl){var a=this.iya;if(!ol.b(a)){var b=a.className;if(ol.b(b)||-1===b.indexOf("cui-rtl"))b=b.trim()+" cui-rtl",b=b.trim(),a.className=b}}}JJi(){Sys.UI.DomElement.addCssClass(this.iya,"FlexBoxLayout")}}Object(e.a)(jG,"HeaderSkeleton",null,[]);d(1045);var tP=d(1206),gB=d(1156);class hB{constructor(){this.commandId=
0;this.externalUxCommand=null}}Object(e.a)(hB,"CommandDefinition",null,[]);class kG{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(e.a)(kG,"CommandDefinitionMapping",null,[]);const uP=a=>Object.assign(new kG,{getCommandByExternalUxId:b=>{const c=a.getCommandByExternalUxId(b);return c?Object.assign(new hB,{commandId:parseInt(c.commandId),externalUxCommand:c.externalUxCommand}):Object.assign(new hB,{externalUxCommand:b})},
getDoNothingCommand:()=>parseInt(G.a.ze),addCommandToMaps:Object(C.a)(a,a.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(C.a)(a,a.addIconToMap,"addIconToMap"),addTabToMap:Object(C.a)(a,a.addTabToMap,"addTabToMap")});var lG=d(910);class mG{}Object(e.a)(mG,"RibbonInitState",null,[]);var vP=d(387),nG=d(505);let Ds;class tp{static uml(a){u.AFrameworkApplication.Ba.jb.Vqg||(a.ShowCommentsTopBar=!0);u.AFrameworkApplication.Ba.jb.Kqg||(a.CatchUpWithChanges=!0)}static qwh(a){for(let b of tp.oLh)a[b]=
!0}static tul(a,b){var c=u.AFrameworkApplication.N1b;if(u.AFrameworkApplication.fa.Fu(c)&&u.AFrameworkApplication.fa.Ia(c)){tp.qwh(b);c=u.AFrameworkApplication.fa.JB("HostDefinedUIControls");for(let f=0;f<c.length;f++)tp.uul(a,b,c[f]);tp.pml(b);tp.oml(b)}}static uul(a,b,c){if(c.id in a){a=a[c.id];for(let f of a)1===c.visibility?b[f]=!1:c.visibility||(b[f]=!0)}}static pml(a){a.HostMoreOptions=a.HostOpenInBrowser&&a.HostOpenInClient&&a.HostDownload?!0:!1}static wsa(){const a=u.AFrameworkApplication.fa.Ia(u.AFrameworkApplication.lJ);
return!!a&&"teams"===a.toLowerCase()}static Z7k(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)}static B8k(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsPeripheralOverflowScalingEnabled",!1)}static oml(a){tp.wsa()&&(tp.Z7k()&&(a.HostOpenInClient=!1),tp.B8k()&&(a.HostMoreOptions=
!0))}}tp.oLh=(Ds=new Ua.a,Ds.add("HostOpenInClient"),Ds.add("HostConversation"),Ds.add("HostClose"),Ds.add("HostDownload"),Ds.add("HostOpenInBrowser"),Ds.add("HostMoreOptions"),Ds);Object(e.a)(tp,"CommandTrimmer",null,[]);class oG{constructor(){}flatten(a){const b=[];for(const c of a)b.push.apply(b,c);return b}}Object(e.a)(oG,"ReactAsyncDispatcher",null,[]);class iB{}iB.Odc="PageId";Object(e.a)(iB,"FileMenuSQMProperties",null,[]);class pG{constructor(a,b){this.Zp=null;this.Kvc=!1;this.oLa=0;this.fbf=
"";this.jpd={};this.kxd=a;this.Kd=b;this.eff=Object(C.a)(this,this.kve,"onModalMouseWheel");this.A$e=!!u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.J7;this.e1=!!u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.rDa}SBb(){0<this.oLa?this.oLa++:(this.oLa++,u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(C.a)(this,this.N6g,"pushTransientFocusScope"),
0)}):this.N6g(),this.showModal())}N6g(){this.Kd&&this.Kd.hX(y.AFrame.fO,!0)}fXi(){const a=Pg.f(),b=appChrome.selectors.getShyState();return String.format("{0}{1}",a,this.A$e&&b.isActive&&1===b.state?"_ShyRibbon":"")}Tdj(a){var b=0;if(this.e1){if(this.jpd[a])return this.jpd[a];(b=document.getElementById("BusinessBar"))||Z.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");b=b?b.offsetTop:0;this.jpd[a]=b}return b}showModal(){if(!this.Zp)if(this.Zp=
this.createElement("div"),this.Zp.setAttribute("id","ReactModalDiv"),this.Zp.style.position="absolute",this.Zp.style.bottom="0px",this.Zp.style.left="0px",this.Zp.style.right="0px",this.Zp.style.backgroundColor="white",this.Zp.style.opacity="0.0",this.e1){var a=document.getElementById("regionComposerRoot");a&&a.appendChild(this.Zp)}else this.kxd.appendChild(this.Zp);a=this.fXi();if(a!==this.fbf){const b=this.Tdj(a),c=appChrome.selectors.getShyState();this.A$e&&c.isActive&&1===c.state&&Pg.a("getRibbonHeight")?
this.Zp.style.top=String.format("{0}px",b+appChrome.api.getRibbonHeight(Pg.f())):this.Zp.style.top=String.format("{0}px",b);this.fbf=a}this.Zp.style.display="block";this.Zp.style.visibility="visible";this.Zp.style.zIndex="1000";this.Kvc||(window.addEventListener("wheel",this.eff,!0),this.uSc()?dh.a.instance.pb(ra.a.CQ,this.Zp,Object(C.a)(this,this.v7c,"onModalPointerUp")):dh.a.instance.pb(ra.a.pointerDown,this.Zp,Object(C.a)(this,this.u7c,"onModalPointerDown")),this.Kvc=!0)}Zik(){this.oLa--;0<this.oLa||
(0>this.oLa?this.oLa=0:this.ejg())}lue(){this.oLa=0;this.qRd();this.ejg()}createElement(a){a=document.createElement(a);a.setAttribute("unselectable","on");return a}djg(){this.Kd&&this.Kd.ye&&this.Kd.ye.name===y.AFrame.fO&&!u.AFrameworkApplication.ve.Ov&&this.Kd.n4(y.AFrame.fO,!1);this.Zp&&(this.Zp.style.zIndex="-1",this.Zp.style.visibility="hidden",this.Zp.style.display="none");this.Kvc&&(window.removeEventListener("wheel",this.eff,!0),this.uSc()?dh.a.instance.zb(ra.a.CQ,this.Zp,Object(C.a)(this,
this.v7c,"onModalPointerUp")):dh.a.instance.zb(ra.a.pointerDown,this.Zp,Object(C.a)(this,this.u7c,"onModalPointerDown")),this.Kvc=!1)}ejg(){this.uSc()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.djg()},0)}):this.djg()}u7c(){this.kXb();this.pWf();this.lue();this.YHa();return!0}v7c(){this.kXb();this.pWf();this.lue();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.YHa()},0)});return!0}YHa(){4===u.AFrameworkApplication.Ba.jb.vm&&u.AFrameworkApplication.fa.ka("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?
u.AFrameworkApplication.Ba.YHa():this.Kd.vf(y.AFrame.gV)}kve(a){a.stopPropagation()}kXb(){const a=lb.a.instance.qb("Common.IReactContextualUILauncher");a&&a.kXb()}qRd(){const a=lb.a.instance.qb("Common.IReactContextualUILauncher");a&&a.qRd()}pWf(){u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.qDa&&(this.uSc()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}uSc(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(e.a)(pG,"ReactModalDiv",null,[]);var yn=d(524);class qG{constructor(a,b){this.bUh=a;this.FHh=b}}Object(e.a)(qG,"ReactExecuteCommandContext",null,[]);class cv{}cv.Color="Color";cv.IndexColorSelected="ColorSelected";Object(e.a)(cv,"ColorPickerCommandProperties",null,[]);var lo=d(906);class mo{}mo.SelectedFont="SelectedFont";mo.Formatting="Format";mo.RequestUpdateMru="RequestUpdateMru";mo.FontPickerId="fontPickerId";mo.IsPinned="IsPinned";mo.Trigger="Trigger";Object(e.a)(mo,"FontPickerCommandProperties",
null,[]);class Wo{}Wo.Trigger="FontTrigger";Wo.Name="FontName";Wo.Action="FontAction";Wo.Level="FontLevel";Wo.IsPinned="FontIsPinned";Object(e.a)(Wo,"FontPickerLogProperties",null,[]);class Rw{}Rw.Rows="Rows";Rw.Columns="Columns";Object(e.a)(Rw,"InsertTableCommandProperties",null,[]);class gn{}gn.Alt="Alt";gn.Number="Number";gn.UnitType="UnitType";gn.Text="Text";gn.MaxValue="MaxValue";Object(e.a)(gn,"SpinnerCommandProperties",null,[]);class rG{constructor(a,b,c,f,l,w,F,S,fa,xa=null,Za=null){this.C0a=
null;this.Stf=!1;this.Brd=[];this.Xpc=-1;this.uxc=!1;this.LUh=0;this.QKb=null;this.Hpf=!1;this.QO=a;this.PLa=b;this.csf=Object(ua.a)(1500,a);this.Sm=c;this.Kd=f;l&&(this.C0a=new pG(l,f));this.xSh=w;this.aKh=F;this.qM=xa;this.Da=S;this.o0a={};this.mb=fa;this.JUe=Za;fa&&(fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||fa.ka("EnqueueTasksWhenTaskMgrIsYielding"))&&Xi.a.instance.PDf.CWR(()=>this.Stf=!0);fa&&(a=this.mb.Ia("CommandControlIdPairsForLoggingOverride")||
"")&&0<=a.trim().length&&({Ev:this.QKb}=md.d(a));this.QKb||(this.QKb={})}get Uhh(){return!!window.appChrome&&!!appChrome.selectors}Ygh(){-1!==this.Xpc&&window.clearTimeout(this.Xpc);this.Xpc=window.setTimeout(()=>{for(this.Xpc=-1;0<this.Brd.length;){if(Im.a.instance.Ov){this.Ygh();break}const a=this.Brd.shift();a&&this.executeCommand(a.bUh,a.FHh)}},0)}executeCommand(a,b){if(Im.a.instance.Ov){if(this.Stf){this.Brd.push(new qG(a,b));this.Ygh();return}Z.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
a,b.modelType,va.a.toJSON(b.payload));if(this.mb.ka("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(b){const c=this.Sm.getCommandByExternalUxId(a),f=b.modelType;this.JUe&&this.JUe.iTj(a,b);c?this.zLi(a,c,f,b):this.ALi(a,f,b);this.nji(b);this.T8j(a,b)}}ALi(a,b,c){switch(b){case "GalleryModel":case "PreviewGalleryModel":this.E_f(c,a)}}Msl(a,b,c,f,l){if(c.payload)switch(c.payload.type){case "CoauthorMenuPayload":a.MenuItemId=c.payload.coauthorId;break;case "ButtonPayload":a.MenuItemId=b.menuItemId;
a.CommandValueId=c.payload.commandValueId;this.Mob();break;case "ButtonPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandPreviewId;break;case "ButtonRevertPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandRevertId;break;default:a.MenuItemId=b.menuItemId}else a.MenuItemId=b.menuItemId;a.SourceControlId=f;return l}Nsl(a,b,c){if(b.payload)switch(b.payload.type){case "MenuOpenPayload":a=this.Sm.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;
break;case "MenuClosePayload":a=this.Sm.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":c.CommandId=b.payload.executedControl;c.ControlId=b.payload.executedControl;c.ParentControlId=b.payload.parentControl;c.CloseAllMenus=!0;this.Mob();break;case "TellMeSearchResultChangePayload":c.Value=b.payload.searchText;break;case "SmartLookupPayload":c.CommandValueId=b.payload.selectionContextJson}return a}zLi(a,b,c,f){var l=this.Atk(f,c),w=b.commandId;const F={},
S={};switch(c){case "SplitButtonModel":if(this.e1b(f.payload,Object(C.a)(this,this.Ptl,"updateSplitButtonMenuState"),l))return;F.MenuItemId=b.menuItemId;this.PIe(f,F);break;case "StatefulSplitButtonModel":if(this.e1b(f.payload,Object(C.a)(this,this.Utl,"updateStatefulSplitButtonMenuState"),l))return;c=f.payload.statefulData;l=f.payload.statefulMode;"color"===l?F.Color=c:"icon"===l&&(c=this.Sm.getCommandByExternalUxId(c))&&(F.MenuItemId=c.menuItemId);break;case "FileMenu":F.MenuItemId=b.menuItemId;
F.SourceControlId=a;f.payload&&"FileMenuPageSwitchPayload"===f.payload.type&&this.ijj(w,f.payload,a);break;case "TellMe":w=this.Nsl(w,f,F);F.SourceControlId=a;F.Location=f.payload.location;break;case "ButtonModel":f.payload&&"TabSwitchPayload"===f.payload.type?this.snj(F,f):w=this.Msl(F,b,f,a,w);break;case "CompoundButtonModel":F.MenuItemId=b.menuItemId;F.CommandValueId=f.payload.commandValueId;F.SourceControlId=a;this.PIe(f,F);this.Mob();break;case "ToggleButtonModel":case "InkButtonModel":F.MenuItemId=
b.menuItemId;F.SourceControlId=a;this.PIe(f,F);this.Mob();break;case "FontPickerModel":switch(f.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":w=this.Sm.getCommandByExternalUxId("FontPickerMenuClose").commandId;F[mo.FontPickerId]=f.payload.launcherId;break;case "FontPickerFontSelectedPayload":c=f.payload.font;l=null;"string"===typeof c?(l=da.FontUtils.oF(c),F.CommandValueId=l,l=da.FontUtils.XEc(l)):(c.data?(F.CommandValueId=c.data.fontToApply,F.MenuItemId=c.data.themeIndex,F[mo.Formatting]=
c.data):F.CommandValueId=c.name,l=c);F.SourceControlId=a;F[mo.RequestUpdateMru]=l;S[Wo.Name]=f.payload.nameToLog?f.payload.nameToLog:"string"===typeof c?da.FontUtils.hRc(c)?"*"+c:da.FontUtils.h8d(c)?"[EF]":"[MF]":"";S[Wo.IsPinned]=f.payload.isPinned;S[Wo.Level]=f.payload.level;this.bce();break;case "FontPickerFontInfoRequestedPayload":F.CommandValueId=f.payload.font.name;F[mo.Trigger]=f.payload.trigger;S[Wo.Trigger]=f.payload.trigger;S[Wo.Name]=f.payload.nameToLog;this.bce();break;case "FontPickerFontPinningPayload":c=
f.payload.isPinned;F.CommandValueId=f.payload.fontKey;F[mo.IsPinned]=c;S[Wo.Name]=f.payload.nameToLog;S[Wo.Action]=c?"pin":"unpin";S[Wo.Level]=f.payload.level;this.bce();break;default:return}break;case "ComboBoxModel":var fa=f.payload.type;switch(fa){case "MenuOpenPayload":case "MenuPopulatePayload":this.EGb(f.payload.launcherId,l)&&(w={},w[f.payload.launcherId]=c,this.PLa.xec(w,Pg.g(f.payload)),this.o0a[a]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":c=
f.payload.newValue;if(!c)return;c.value?(F[lo.a.Value]=c.value,F[lo.a.IsFreeForm]=!0):(F[lo.a.Value]=c.text,F.MenuItemId=c.key,F.CommandValueId=c.commandValueId);"ComboBoxPreviewPayload"===fa&&(w=b.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":w=b.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(f.payload.type){case "ZeroTermContextMenuClosePayload":c=va.a.pK(f.payload);for(fa of c)F[fa]=f.payload[fa];break;default:this.e1b(f.payload,Object(C.a)(this,this.Frl,
"updateFlyoutAnchorMenuState"),l),F.launcherId=f.payload.launcherId}break;case "InkFlyoutAnchorModel":this.e1b(f.payload,Object(C.a)(this,this.$rl,"updateInkFlyoutAnchorMenuState"),l);F.launcherId=f.payload.launcherId;break;case "ColorPickerModel":switch(f.payload.type){case "ColorPickerPayload":F[cv.Color]=f.payload.selectedColorId;break;case "ColorPickerPreviewPayload":w=b.commandPreviewId;F[cv.Color]=f.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":w=b.commandRevertId;break;
default:return}break;case "SpinButtonModel":F[gn.Number]=f.payload.value;F[gn.UnitType]=ke.a.GVb(f.payload.unitType.toLowerCase());F[gn.Text]=f.payload.reservedValue;break;case "SliderModel":F[Vo.Value]=f.payload.value;break;case "InsertTableModel":F[Rw.Rows]=f.payload.rows;F[Rw.Columns]=f.payload.columns;break;case "CheckboxModel":F[Uh.a.On]=f.payload.checked;F.MenuItemId=b.menuItemId;break;case "PreviewGalleryModel":if(this.e1b(f.payload,Object(C.a)(this,this.Xsl,"updatePreviewGalleryMenuState"),
l)){F.launcherId=f.payload.launcherId;break}this.E_f(f,a);return;case "DocumentTitleModel":switch(f.payload.type){case "DocumentTitleRenamePayload":F.getNewDocumentTitle=f.payload.getNewDocumentTitle;break;case "MenuOpenPayload":w={};w[f.payload.launcherId]=c;this.PLa.xec(w,Pg.g(f.payload));this.o0a[a]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":F.MenuItemId=f.payload.url;this.NTj(f.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":F.MenuItemId=
f.payload.assetId;F.SourceControlId=a;this.OTj(f.payload.pageId);break;case "CoauthorGallery":F.RenderTime=f.triggerTime;break;case "PeopleWell":F.RenderTime=f.triggerTime;break;case "SyncStatus":F.SourceControlId=a;break;case "InputBoxModel":F.Text=f.payload.newValue;break;case "PersonaButtonModel":F.CommandValueId=f.payload.commandValueId;this.flj(f.payload);break;default:return}w&&!this.isShadowMenuOpen(f.payload)&&(F.CommandValueId||(F.CommandValueId=F.MenuItemId),b.legacyControlId&&(F.LegacyId=
b.legacyControlId),F.SourceControlId||(F.SqmControlId=a),this.mb&&this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&F.launcherId&&(b=this.Sm.getCommandByExternalUxId(F.launcherId))&&(F.launcherCommandId=parseInt(b.commandId)),f.payload&&!ol.b(f.payload.PRIReadinessCheck)&&(F.PRIReadinessCheck=f.payload.PRIReadinessCheck,this.Hpf=!0),f.payload&&!ol.b(f.payload.shouldTakeFocus)&&(F[yn.a.qea]=f.payload.shouldTakeFocus),b=this.BAf(f,F),ol.b(f.triggerTime)||(S.TriggerTime=
f.triggerTime),f.payload&&!ol.b(f.payload.userActionKey)&&(S.userActionKey=f.payload.userActionKey),this.bjh(S,f,a,w),this.csf.executeCommand(w,F,this.getSelectedTabId(),b,!0,()=>{this.zSg(F,a)},S,Pg.g(f.payload)))}bjh(a,b,c,f){this.mb&&this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&c&&f&&(a.ControlId=this.n6i(c,f));this.mb&&this.mb.ka("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&b.payload&&"terminalParentControlId"in b.payload&&
(a.TerminalParentControlId=b.payload.terminalParentControlId)}n6i(a,b){b=parseInt(b);b=Le.ActionManager.EMd(b)||Le.ActionManager.n2a(b)||"";return!ol.b(b)&&b in this.QKb?this.QKb[b]:100<a.length?"":a}bce(){this.qM&&this.qM.execute(a=>{a.Tbe("ModernFontPickerExperience")})}BAf(a,b){let c=2;a.payload&&"inputMethod"in a.payload&&a.payload.inputMethod&&(c=a.payload.inputMethod,b[yn.a.Ru]=c);return c}zSg(a,b){const c=Object(ua.a)(y.AFrame,u.AFrameworkApplication.Ba);if(this.Kd&&this.snh(a)){if(!this.Kd.ye&&
c){let f="null";if(a){const l=a.Value;delete a.Value;f=va.a.toJSON(a);ol.b(l)||(a.Value=l)}Z.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",b,f,c.LHa)}this.Kd.QRi()}(this.Kd&&this.Kd.ye&&this.Kd.ye.name!==y.AFrame.fO&&c&&this.Kd.ye.name!==c.LHa||this.snh(a))&&this.kni(a)}snh(a){return!!a&&!ol.b(a[yn.a.qea])&&a[yn.a.qea]}kni(a){yn.a.Ru in a&&1===a[yn.a.Ru]&&Ow.ShyRibbon.tNa(1,
0)}snj(a,b){this.QO.wec();if(this.xSh&&this.Da){const c={};c[Ey.jth]=b.payload.tabId;this.Da.Ma(G.a.Ycd,2,c,this.qNc(b));ol.b(b.payload.inputMethod)||(this.Da.processAction(G.a.Bdh,2),this.uxc||this.Fal(b.payload.tabId))}b=b.payload.tabId;a.NewContextId=b;a.NewContextCommand=this.Sm.b1d(b);Z.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+b);if(this.qM&&b){const c=b+"TabSwitchActivity";this.qM.execute(f=>{f.Tbe(c)})}}e1b(a,b,c){const f=a.type;return"MenuClosePayload"===f?!0:"MenuOpenPayload"===
f?(b(a,c),!0):!1}flj(a){a=a.type;"MenuOpenPayload"===a?u.AFrameworkApplication.Ish=!0:"MenuClosePayload"===a&&(u.AFrameworkApplication.Ish=!1)}Atk(a,b){if(!a.payload||!a.payload.launcherId||"MenuOpenPayload"!==a.payload.type&&"MenuPopulatePayload"!==a.payload.type)return!1;const c=a.payload.launcherId,f=this.Sm.getCommandByExternalUxId(c);return f&&f.populationProps?((a=this.PLa.bye(f,b,a.payload))&&c in this.o0a&&delete this.o0a[c],a):!1}Frl(a,b){const c=a.launcherId;this.EGb(c,b)&&(b=appChrome.selectors.getFlyoutAnchorMenuItems(c),
this.$Ib(b,c,Pg.g(a)))}$rl(a,b){const c=a.launcherId;this.EGb(c,b)&&(b=Pg.j("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(c):appChrome.selectors.getFlyoutAnchorMenuItems(c),this.$Ib(b,c,Pg.g(a)))}Xsl(a,b){const c=a.launcherId;this.EGb(c,b)&&(b=appChrome.selectors.getPreviewGalleryMenuItems(c),this.$Ib(b,c,Pg.g(a)))}Ptl(a,b){const c=a.launcherId;this.EGb(c,b)&&(b=appChrome.selectors.getSplitButtonMenuItems(c),this.$Ib(b,c,Pg.g(a)))}Utl(a,b){const c=a.launcherId;this.EGb(c,
b)&&(b=appChrome.selectors.getStatefulSplitButtonMenuItems(c),this.$Ib(b,c,Pg.g(a)))}getSelectedTabId(){return this.Uhh?appChrome.selectors.getSelectedTabId():null}$Ib(a,b,c){this.PLa.xec(a,c);this.o0a[b]=new Date}EGb(a,b){let c=!0;a in this.o0a&&(c=this.o0a[a].getTime()<this.QO.LUc.getTime());return c&&!b&&this.Uhh}E_f(a,b){const c={};var f=a.payload.selectedGalleryId;const l=this.Sm.getCommandByExternalUxId(f);if(l){c.SourceControlId=f;c.MenuItemId=l.menuItemId;c.SqmControlId=b;l.legacyControlId&&
(c.LegacyId=l.legacyControlId);a.payload&&!ol.b(a.payload.shouldTakeFocus)&&(c[yn.a.qea]=a.payload.shouldTakeFocus);this.m7i(a.payload,c);(f=this.qNc(a))||(f={});this.bjh(f,a,b,l.commandId);const w=this.BAf(a,c);this.csf.executeCommand(l.commandId,c,this.getSelectedTabId(),w,!0,()=>{this.zSg(c,b)},f,Pg.g(a.payload))}}m7i(a,b){"CharacterGalleryPayload"===a.type&&(b.MenuItemId=a.character)}PIe(a,b){a.payload&&"toggled"in a.payload&&(b[Uh.a.On]=a.payload.toggled)}T8j(a,b){"MenuOpen"===a?!this.C0a||"isShadowRendering"in
b.payload&&b.payload.isShadowRendering||this.C0a.SBb():"MenuClose"===a&&this.C0a&&this.C0a.Zik()}Mob(){this.C0a&&this.C0a.lue()}qNc(a){let b=null;ol.b(a.triggerTime)||(b={},b.TriggerTime=a.triggerTime);return b}ijj(a,b,c){if(this.aKh&&this.Da){const f={};f[iB.Odc]=c;this.Da.Ma(G.a.WPk,2,f)}this.$Ib(b.pageControlIdMap,a,Pg.g(b))}OTj(a){if(this.Da)switch(a){case "FileHomePage":this.Da.processAction(G.a.kQk,2);break;case "FileNewPage":this.Da.processAction(G.a.lQk,2)}}NTj(a){if(this.Da)switch(a){case "FileHomePage":this.Da.processAction(G.a.dQk,
2);break;case "FileOpenPage":this.Da.processAction(G.a.eQk,2)}}isShadowMenuOpen(a){return!!a&&"MenuOpenPayload"===a.type&&a.isShadowRendering}Fal(a){if(u.AFrameworkApplication.fa.ka("TellMeHelpCoachMarkActivityEnabled")&&"Help"===a)this.qM.execute(b=>{b.logActivity("TellMeHelpCoachMarkActivity",null)}),this.uxc=!0;else{if(u.AFrameworkApplication.fa.ka("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.qM.execute(b=>{b.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.LUh)){this.uxc=
!0;return}u.AFrameworkApplication.fa.ka("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.Da.processAction(G.a.Yfb,2)&&(this.uxc=!0)}}nji(a){a&&a.payload&&a.payload.PRIReadinessCheck&&!this.Hpf&&appChrome.PRIToastManager.dismissToast()}}Object(e.a)(rG,"ReactExecuteCommandHandler",null,[]);class sG{constructor(){this.fileMenu=null}get YSe(){return 0}gXa(){}sqa(){return!1}x0(){return!1}get Jhh(){return null}C4(){}N7d(){return!1}dNa(){}LOa(){}refresh(){}get controls(){return null}JDc(){}wec(){}get O9(){return null}set O9(a){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(e.a)(sG,"ReactRibbonExternal",null,[545,1487,1488]);var wP=d(268);class tG{constructor(a,b,c,f){this.Kd=a;this.Da=b;this.Ayf=c;this.klb=f}initialize(){this.Da.ya(G.a.pic,de.a.frame,Object(C.a)(this,this.$eh,"ribbonMoveForwardAction"));this.Da.ya(G.a.oic,de.a.frame,Object(C.a)(this,this.Zeh,"ribbonMoveBackwardAction"));this.Da.ya(G.a.Fdd,de.a.frame,Object(C.a)(this,this.Yeh,"ribbonEscAction"));var a=Jr.a.A5d(this.klb,null,this.Ayf,!1);a.HK=!0;this.RDb(a,G.a.pic,G.a.oic);a.bindAction(A.KeyInputManager.La(x.a.B0,
0),G.a.Fdd);a=this.Kd.Bc(y.AFrame.fO);a.HK=!0;this.RDb(a,G.a.uqa,G.a.uqa);ia.a.instance.pb(ra.a.mouseDown,this.Ayf,Object(C.a)(this,this.Rkk,"onRibbonMouseDown"));a=wP.a.instance;Pg.a("enterKeytipMode")&&a.pjc(this.klb,()=>{appChrome.api.enterKeytipMode(!1)});Pg.a("exitKeytipMode")&&a.Mfd(this.klb,()=>{appChrome.api.exitKeytipMode();Ow.ShyRibbon.tNa(1,0)});u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.J7&&(a=Object(ua.a)(v.FocusManager,this.Kd))&&a.E2h(Object(C.a)(this,this.vhk,"onFocusScopeChanged"))}vhk(a,
b){if((a=Object(ua.a)(y.AFrame,u.AFrameworkApplication.Ba))&&b.HTg&&u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.J7){const c=appChrome.selectors.getShyState();c.isActive&&b.HTg.name===a.LHa&&Ow.ShyRibbon.tNa(c.state,1)}}$eh(){return 4}Zeh(){return 4}Yeh(){Pg.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.J7&&appChrome.selectors.getShyState().isActive&&Ow.ShyRibbon.tNa(1,0),this.Kd.vf(y.AFrame.gV));return 4}RDb(a,b,c){const f=
A.KeyInputManager.La(x.a.tq,0),l=A.KeyInputManager.La(x.a.tq,4);a.Wo(f);a.Wo(l);a.bindAction(f,b);a.bindAction(l,c)}Rkk(a){a.nc&&a.nc.target&&"input"!==a.nc.target.tagName.toLowerCase()&&a.nc.preventDefault();return!1}dispose(){this.Da.gO(G.a.pic,de.a.frame,Object(C.a)(this,this.$eh,"ribbonMoveForwardAction"));this.Da.gO(G.a.oic,de.a.frame,Object(C.a)(this,this.Zeh,"ribbonMoveBackwardAction"));this.Da.gO(G.a.Fdd,de.a.frame,Object(C.a)(this,this.Yeh,"ribbonEscAction"))}}Object(e.a)(tG,"ReactRibbonFocusManager",
null,[109]);class jB{constructor(){this.CommandLocation=0;this.CommandTabName=null;this.InvocationMethod=0}}Object(e.a)(jB,"CommandSqmInfo",null,[]);var Sw=d(341),Tw;(function(a){a[a.UnspecifiedGallery=0]="UnspecifiedGallery";a[a.CharacterCodeGallery=1]="CharacterCodeGallery";a[a.FontStyleGallery=2]="FontStyleGallery";a[a.InkThicknessGallery=3]="InkThicknessGallery";a[a.IconGallery=4]="IconGallery";a[a.ListGallery=5]="ListGallery";a[a.TableStyleGallery=6]="TableStyleGallery";a[a.PageNumberGallery=
7]="PageNumberGallery";a[a.ChangeColorsGallery=8]="ChangeColorsGallery"})(Tw||(Tw={}));Object(e.b)("GalleryType",Tw);class Go{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(e.a)(Go,"CommonGalleryButtonProps",null,[]);class Jy extends Go{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(e.a)(Jy,"AdditionalTableStyleGalleryButtonProps",Go,[]);class uG extends Jy{constructor(){super()}}Object(e.a)(uG,"AdditionalChangeColorsGalleryButtonProps",
Jy,[]);class vG extends Go{constructor(){super();this.character=null}}Object(e.a)(vG,"AdditionalCharacterCodeGalleryButtonProps",Go,[]);class wG extends Go{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(e.a)(wG,"AdditionalFontStyleGalleryButtonProps",Go,[]);class xG{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(e.a)(xG,"AdditionalGalleryProperties",
null,[]);class yG extends Go{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(e.a)(yG,"AdditionalIconButtonProperties",Go,[]);class zG extends Go{constructor(){super();this.styleDisplayName=null}}Object(e.a)(zG,"AdditionalInkThicknessGalleryButtonProps",Go,[]);class AG extends Go{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(e.a)(AG,"AdditionalListGallerButtonProps",
Go,[]);class BG extends Go{constructor(){super();this.text=null}}Object(e.a)(BG,"AdditionalPageNumberGalleryButtonProps",Go,[]);var Ky=d(655),cm=d(907),CG=d(1078);class kB{}kB.Text="Text";Object(e.a)(kB,"TextBoxCommandProperties",null,[]);var tm=d(298);const xP=(a,b)=>{var c=appChrome.selectors.getActiveControlStates();if(c=Object(ua.a)(Object,c[a])){if((a=Object(ua.a)(String,c.value))&&a===b)return!1;a=Object(ua.a)(String,c.selectedKey);if(!b&&!a)return!1;if(a){c=Array.isArray(c.options)?c.options:
null;let f=null;for(let l=0;l<c.length;l++){const w=Object(ua.a)(Object,c[l]);if(Object(ua.a)(String,w.key)===a){f=w;break}}if(f&&Object(ua.a)(String,f.text)===b)return!1}}return!0},EG=(a,b,c,f)=>{if(0<(f&2)){f=[];switch(b){case "ToggleButtonModel":case "InkButtonModel":f.push(Ly(a,c[Uh.a.On]));break;case "CheckboxModel":f.push(appChrome.actions.toggleCheckbox(a,c[Uh.a.On]));break;case "ComboBoxModel":if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||
u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!xP(a,c[lo.a.Value]))break;(b=c[lo.a.Key])?f.push(appChrome.actions.updateComboBoxKey(a,b,c[lo.a.Value])):f.push(appChrome.actions.updateComboBoxValue(a,c[lo.a.Value]));break;case "FontPickerModel":f.push(appChrome.actions.updateFontPickerSelectedFont(a,c[mo.SelectedFont]));break;case "SplitButtonModel":f.push(Ly(a,c[CG.a.On]));break;case "SpinButtonModel":f.push(appChrome.actions.updateSpinButton(a,
c[gn.Number],ke.a.HVb(c[gn.UnitType]),c[gn.Text],c[gn.MaxValue],c[gn.Alt]));break;case "ColorPickerModel":f.push(appChrome.actions.updateColorPickerSelectedColor(a,c[cv.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":f.push(appChrome.actions.updatePageNumberGalleryButtonText(a,c[cm.a.Text]));break;case "CompoundButtonModel":c[Uh.a.Description]&&f.push(appChrome.actions.updateCompoundButtonDescription(a,c[Uh.a.Description]));Uh.a.On in c&&f.push(Ly(a,c[Uh.a.On]));break;case "SliderModel":c.snapToStep?
f.push(appChrome.actions.updateSliderSelectedValue(a,c[Vo.Value])):f.push(appChrome.actions.updateSliderValue(a,c[Vo.Value],c[Vo.MinValue]||0,c[Vo.MaxValue],c[Vo.Text]));break;case "FlyoutAnchorModel":Ky.a.ImageIsVisible in c&&f.push(appChrome.actions.hideFlyoutAnchorIcon(a,!c[Ky.a.ImageIsVisible]));Uh.a.On in c&&f.push(Ly(a,c[Uh.a.On]));break;case "InputBoxModel":f.push(appChrome.actions.updateInputBoxValue(a,c[kB.Text]))}b=f;var l=Object(ua.a)(String,c[tm.a.iconColor]);void 0!==l&&null!==l&&b.push(appChrome.actions.updateIconColor(a,
l));DG(a,c,f);b=f;(l=Object(ua.a)(Object,c[tm.a.IconSet]))&&b.push(appChrome.actions.setControlIconSet(a,l));b=f;l=Object(ua.a)(String,c[tm.a.customTooltip]);void 0!==l&&null!==l&&b.push(appChrome.actions.setControlCustomTooltip(a,l));a=f;(c=Array.isArray(c[tm.a.z$g])?c[tm.a.z$g]:null)&&a.push.apply(a,c);return f}return null},Lt=(a,b)=>appChrome.actions.updateControlEnabledDisabledState(a,b),Ly=(a,b)=>appChrome.actions.toggleButton(a,b),DG=(a,b,c)=>{b=Object(ua.a)(String,b[tm.a.Icon]);void 0!==b&&
null!==b&&c.push(appChrome.actions.setControlIcon(a,b))};class FG{constructor(a,b,c,f){this.Sm=f;this.Ioa=a;this.MJ=b;this.llb=c;this.PNb={}}Ltk(a,b,c,f,l=null){const w=a.ExternalGalleryId||a.ExternalId;var F=a.ExternalId;f.push(w);if(appChrome.selectors.isControlDefined(w))a.GalleryStyle&&Pg.d("setGalleryStyles")&&b.push(appChrome.actions.setGalleryStyles(w,a.GalleryStyle));else{if(4!==a.Type)return;c.push(appChrome.api.createGalleryModel(w,Object.assign(new xG,{columns:a.Width,sections:[appChrome.api.gallerySection([],
F)],styles:a.GalleryStyle,galleryType:"IconGallery"})))}c=0;f=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Pg.d("setGallerySections")&&a.GallerySections&&0<a.GallerySections.length){F=[];const fa=[],xa=[],Za={};for(var S of a.GallerySections){F.push(appChrome.api.gallerySection([],S.SectionId,S.Title));0===c&&S.GalleryButtons&&
0<S.GalleryButtons.length&&(c=S.GalleryButtons[0].Type);f&&this.mbg(S.GalleryButtons,l,Za);const pb=this.DFd(fa,S.GalleryButtons,Za);fa.push.apply(fa,this.I_d(pb,w,S.SectionId,!1,c,l,!0,Za));xa.push.apply(xa,pb)}b.push(appChrome.actions.setGallerySections(w,F));b.push.apply(b,fa);b.push.apply(b,this.UYd(w,Tw[c],xa,null,5===a.Type,!0,null,Za))}else a.GalleryItems&&0<a.GalleryItems.length&&(c=a.GalleryItems[0].Type),S=f?this.mbg(a.GalleryItems,l):null,b.push.apply(b,this.I_d(this.DFd(b,a.GalleryItems,
S),w,F,!1,c,l,!1,S))}h8i(a,b){const c=[];let f=null,l=!1;if(!a)return null;const w=this.Ioa.vec(this.MJ,a.commandId,b);c.push(Lt(a.externalUxCommand,!w));if(a.previewControlIds){const fa=[];for(let xa=0;xa<a.previewControlIds.length;xa++){var F={},S=a.previewControlIds[xa];F.SourceControlId=S;const Za=this.Sm.getCommandByExternalUxId(S);this.EMc(Za||a,F);F[cm.a.On]&&(f=F.SourceControlId,F[cm.a.HighlightOn]&&(l=!0));DG(S,F,c);if(F=Object(ua.a)(Sw.a,F[cm.a.GalleryButtonProps]))fa.push(F),w&&(S=this.Ioa.vec(this.MJ,
F.Command,b),F.IsDisabled=!S)}0<fa.length&&c.push.apply(c,this.I_d(this.DFd(c,fa),a.externalUxCommand,a.externalUxCommand,!0,fa[0].Type));c.push(appChrome.actions.updateGallerySelectedId(a.externalUxCommand,f));l&&(Z.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",f),c.push(appChrome.actions.highlightSelectedFontStyle(f)))}return c}DFd(a,b,c=null){const f=[],l=[];for(let F=0;F<b.length;F++){const S=b[F],fa=ol.a(S.ExternalId)?S.Id:S.ExternalId;f.push(fa);const xa=
c&&c[fa]?c[fa].result:-1;switch(S.Type){case 1:var w=S;l.push(appChrome.api.createCharacterCodeGalleryButtonModel(fa,Object.assign(new vG,{disabled:-1!==xa?1>(xa&1):w.IsDisabled,character:w.Character,style:w.Style,title:w.Alt})));break;case 2:w=S;l.push(appChrome.api.createFontStylesGalleryButtonModel(fa,Object.assign(new wG,{disabled:-1!==xa?1>(xa&1):w.IsDisabled,styleDisplayName:w.LabelText,style:w.Style,title:w.Alt,previewStyleLabel:w.PreviewStyleLabel})));break;case 3:w=S;l.push(appChrome.api.createInkThicknessGalleryButtonModel(fa,
Object.assign(new zG,{disabled:-1!==xa?1>(xa&1):w.IsDisabled,styleDisplayName:w.LabelText,style:w.Style,title:w.Alt})));break;case 4:w=S;l.push(appChrome.api.createIconGalleryButtonModel(fa,Object.assign(new yG,{disabled:-1!==xa?1>(xa&1):w.IsDisabled,icon:[w.Icon],fullIconStyle:w.FullIconStyle,previewIconStyle:w.PreviewIconStyle,largePreviewIconStyle:w.LargePreviewIconStyle,label:w.LabelText,title:w.Alt})));break;case 5:w=S;l.push(appChrome.api.createListGalleryButtonModel(fa,Object.assign(new AG,
{disabled:-1!==xa?1>(xa&1):w.IsDisabled,infoAtLevel:w.LevelInfo,ariaLabel:w.Alt})));break;case 6:w=S;l.push(appChrome.api.createTableStyleGalleryButtonModel(fa,Object.assign(new Jy,{disabled:-1!==xa?1>(xa&1):w.IsDisabled,tableCellStyles:w.TableCellStyles,tableStyles:w.TableStyles,title:w.Alt,columns:w.columns})));break;case 8:w=S;l.push(appChrome.api.createChangeColorsGalleryButtonModel(fa,Object.assign(new uG,{disabled:-1!==xa?1>(xa&1):w.IsDisabled,tableCellStyles:w.TableCellStyles,tableStyles:w.TableStyles,
title:w.Alt})));break;case 7:w=S,l.push(appChrome.api.createPageNumberGalleryButtonModel(fa,Object.assign(new BG,{disabled:-1!==xa?1>(xa&1):w.IsDisabled,text:w.Text,title:w.Alt})))}this.Sm.addCommandToMaps(Object.assign(new Xa.a(fa,S.Command),{queryCommandId:S.QueryCommand,menuItemId:S.MenuItemId}))}a.push(appChrome.actions.addControls(l));return f}I_d(a,b,c,f,l,w=null,F=!1,S=null){const fa=[];f?fa.push(appChrome.actions.populateGalleryItems(b,a)):(this.PNb[b]=!1,F||(f=!0,appChrome.selectors.isControlDefined(b)&&
(f=appChrome.selectors.getGalleryState(b),f=f.disableIndividualButtons?f.disableIndividualButtons:!0),fa.push.apply(fa,this.UYd(b,Tw[l],a,null,5===l,f,w,S))),fa.push(appChrome.actions.updateGallerySectionItems(b,c,a)));return fa}P1i(a){return this.UYd(a.ExternalUxId,a.galleryType,a.items,a.sections,a.isListGallery,a.disableIndividualButtons?a.disableIndividualButtons:!0)}UYd(a,b,c,f,l,w=!0,F=null,S=null){const fa=[];if(a in this.PNb){if(this.PNb[a])return delete this.PNb[a],fa;this.PNb[a]=!0}let xa=
null,Za=-1;if(c)({R4f:Za,returnValue:xa}=this.tAf(b,c,fa,w,F,S));else if(f)for(const pb of f)(c=({R4f:Za}=this.tAf(b,pb.galleryButtons,fa,w,null,S)).returnValue)&&(xa=c);fa.push(appChrome.actions.updateGallerySelectedId(a,xa));w&&fa.push(Lt(a,!1));l&&0<Za&&fa.push(appChrome.actions.updateListGalleryTextDirection(a,2===Za));return fa}lbg(a,b=null){const c={},f={};f.SourceControlId=a;f.Location=b;a=this.Sm.getCommandByExternalUxId(a);if(!a)return c.result=-1,c.props=f,c;a=this.EMc(a,f);c.result=a;c.props=
f;return c}mbg(a,b=null,c=null){c||(c={});for(const f of a)a=ol.a(f.ExternalId)?f.Id:f.ExternalId,c[a]=this.lbg(a,b);return c}tAf(a,b,c,f,l=null,w=null){let F,S=null;F=-1;let fa=!1;for(const Za of b){var xa=this.N1i(a);b=w&&w[Za]&&-1!==w[Za].result?w[Za]:this.lbg(Za,l);const pb=b.result;b=b.props;f&&c.push(Lt(Za,1>(pb&1)));(xa=EG(Za,xa,b,pb))&&c.push.apply(c,xa);b[cm.a.On]&&(S=Za,b[cm.a.HighlightOn]&&b[cm.a.HighlightOn]&&(fa=!0));void 0!==b[tm.a.labelText]&&null!==b[tm.a.labelText]&&(xa=this.Sm.getCommandByExternalUxId(Za),
c.push(appChrome.actions.setControlLabel(xa.externalUxCommand,b[tm.a.labelText])));b[cm.a.IsRtl]&&0>F&&(F=b[cm.a.IsRtl])}fa&&(Z.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",S),c.push(appChrome.actions.highlightSelectedFontStyle(S)));return{returnValue:S,R4f:F}}N1i(a){switch(a){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";
case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}EMc(a,b){b.MenuItemId=a.menuItemId;return this.Ioa.U9c(this.MJ,this.llb,a.commandId,a.queryCommandId,b)}}Object(e.a)(FG,"ReactGalleryPoller",null,[]);var yP=d(573),My=d(771),zP=d(773);class lB extends Of.a{constructor(){super()}get ControlType(){return 3}}
Object(e.a)(lB,"CompoundButtonProps",Of.a,[]);var qq=d(770);class GG{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(e.a)(GG,"PopulateFontPickerDataProps",null,[]);var Kr=d(396);class HG extends Hr{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(e.a)(HG,"OptionalCompoundButtonProperties",Hr,[]);class IG extends bv{constructor(){super();this.styles=
this.secondaryText=null;this.flipIconInRtl=!1}}Object(e.a)(IG,"OptionalPersonaButtonProperties",bv,[]);class Ny extends Hr{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(e.a)(Ny,"OptionalToggleButtonProperties",Hr,[]);var AP=d(909),BP=d(908),Oy=d(468);class JG{constructor(){this.iOf=this.actions=null;this.HCh=!1}}Object(e.a)(JG,"PopulateActions",null,[]);class mB{ldg(a,b){switch(b){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(a);
case "ToggleButtonModel":return this.z8i(a);case "InkButtonModel":return this.y8i(a);case "GalleryModel":return appChrome.selectors.getGalleryState(a);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(a);case "SliderModel":return appChrome.selectors.getSliderState(a)}return{}}z8i(a){const b={};b[Uh.a.On]=appChrome.selectors.getButtonToggleState(a);return b}y8i(a){const b={};b[Uh.a.On]=Pg.j("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(a):appChrome.selectors.getButtonToggleState(a);
return b}}Object(e.a)(mB,"ReactStatePropsSelector",null,[]);class Py{constructor(a,b,c,f,l){this.Ioa=a;this.MJ=b;this.llb=c;this.Sm=f;this.FCd={};this.LRh=new mB;this.c1a=l}Rph(a){const b=a.populationProps.populateQueryCommandId;return a.populationProps.populateOnlyOnce&&b in this.FCd}V8i(a,b,c=null){const f=[],l={};if(!this.Rph(a)){const w=a.populationProps.populateQueryCommandId,F={};F.MenuId=a.externalUxCommand;F.IsShadowMenuOpen=this.isShadowMenuOpen(c);if(0<(this.Ioa.U9c(this.MJ,this.llb,w,w,
F,this.$2i(c))&1))if("FontPickerModel"===b)this.FCd[w]=!0,f.push(Py.T7i(a,F)),l[a.externalUxCommand]="FontPickerModel";else if(F.MenuItems)switch(this.FCd[w]=!0,b){case "ComboBoxModel":f.push(Py.R7i(a,F));l[a.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":f.push.apply(f,this.Beg(a.externalUxCommand,b,F.MenuItems,l,c&&"location"in c?c.location:null))}}return Object.assign(new JG,
{actions:f,iOf:l,HCh:this.isShadowMenuOpen(c)})}Beg(a,b,c,f,l=null){const w=[],F=[],S=[],fa=[];for(let xa=0;xa<c.MenuSectionList.length;xa++){const Za=Object(ua.a)(nk.a,c.MenuSectionList[xa]);if(!Za)continue;let pb=null;const Mb=[];ol.b(Za.Title)||(pb=Za.Title);for(let hc=0;hc<Za.ControlList.length;hc++){const kc=Object(ua.a)(zA.a,Za.ControlList[hc]);if(!kc||kc.ExternalId)f&&this.uYi(kc,f),w.push.apply(w,this.S7i(kc,F,Mb,fa,a,b,l))}c.UpdateDynamically&&S.push(appChrome.api.menuSection(Mb,pb,Za.Lang))}c.UpdateDynamically&&
w.push(appChrome.actions.updateMenu(a,S,c.Title,c.AriaLabel,c.ShouldAutoOpen,c.AriaRoleDescription,c.MenuTargetDescriptor));0<F.length&&w.splice(0,0,appChrome.actions.addControls(F));0<fa.length&&Pg.d("setStatefulSplitButtonMruBypassControls")&&w.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(a,fa));return w}uYi(a,b){switch(a.ControlType){case 1:case 3:b[a.ExternalId]=1===a.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:b[a.ExternalId]="ToggleButtonModel";break;case 6:b[a.ExternalId]=
"CheckboxModel";break;case 7:b[a.ExternalId]="ColorPickerModel";a=Object(ua.a)(My.a,a);a.McuLayout&&(b[a.McuExternalId]="ColorPickerModel");break;case 9:b[a.ExternalId]="FlyoutAnchorModel"}}S7i(a,b,c,f,l,w,F=null){const S=[];switch(a.ControlType){case 1:case 3:f=Object(ua.a)(Of.a,a);this.qtk(f,S,b,c);f.MenuItemsStatefulData&&Pg.d("setStatefulSplitButtonMenuItemsStatefulData")&&S.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(l,f.MenuItemsStatefulData));break;case 2:this.nuk(Object(ua.a)(Oy.a,
a),S,b,c);break;case 6:this.vtk(Object(ua.a)(yP.a,a),S,b,c);break;case 4:this.auk(Object(ua.a)(Jv,a),S,b,c);break;case 7:this.wtk(Object(ua.a)(My.a,a),S,b,c);break;case 9:l=Object(ua.a)(uo.a,a);this.Etk(l,S,b,c);"StatefulSplitButtonModel"===w&&f.push(l.ExternalId);break;case 8:this.c1a.Ltk(Object(ua.a)(qq.a,a),S,b,c,F)}return S}qtk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.Description&&
b.push(appChrome.actions.updateCompoundButtonDescription(a.ExternalId,a.Description)),a.CommandValueId&&b.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,a.CommandValueId)),this.dAc()&&((c=this.jra(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Tp.a(c)).iconSet)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(a.Description||Object(Ca.a)(lB,a)?c.push(appChrome.api.createCompoundButtonModel(a.ExternalId,a.LabelText,
a.Description,Object.assign(new HG,{iconSet:(new Tp.a(this.jra(a))).iconSet,keytip:a.KeyTip,roleInMenu:a.RoleInMenu,ariaDescription:a.AriaDescription,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,Object.assign(new bv,{iconSet:(new Tp.a(this.jra(a))).iconSet,keytip:a.KeyTip,supportsPreview:!!a.CommandPreviewId&&!!a.CommandRevertId,customTooltip:a.LabelText!==a.Alt?a.Alt:null,commandValueId:a.CommandValueId,shouldTakeFocus:a.ShouldTakeFocus}))),
this.Sm.addCommandToMaps(Object.assign(new Xa.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand,commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));a.Lang&&Pg.d("setControlLanguage")&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}vtk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.dAc()&&((c=this.jra(a))&&0<
c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Tp.a(c)).iconSet)),a.IsChecked&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.IsChecked)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Ny,{iconSet:(new Tp.a(this.jra(a))).iconSet,keytip:a.KeyTip,toggled:a.IsChecked,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==
a.Alt?a.Alt:null,toggleUsingIcon:!!a.CheckedImageClass}))),this.Sm.addCommandToMaps(Object.assign(new Xa.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}nuk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.dAc()&&((c=this.jra(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Tp.a(c)).iconSet)),u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&
a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Ny,{iconSet:(new Tp.a(this.jra(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createToggleButtonModel(a.ExternalId,
a.LabelText,Object.assign(new Ny,{iconSet:(new Tp.a(this.jra(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel}))),this.Sm.addCommandToMaps(Object.assign(new Xa.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}auk(a,b,c,f){f.push(a.ExternalId);f=this.E7i(a);appChrome.selectors.isControlDefined(a.ExternalId)?a.LabelText&&b.push(appChrome.actions.setPersonaButtonCoauthor(a.ExternalId,f,a.LabelText)):Pg.a("createPersonaButtonModel")&&
c.push(appChrome.api.createPersonaButtonModel(a.ExternalId,f,a.LabelText,Object.assign(new IG,{role:a.RoleInMenu,fullDescriptionLabel:a.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}Etk(a,b,c,f){f.push(a.ExternalId);if(appChrome.selectors.isControlDefined(a.ExternalId))a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.dAc()&&((c=this.jra(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Tp.a(c)).iconSet)),void 0!==
a.ImageIsVisible&&null!==a.ImageIsVisible&&b.push(appChrome.actions.hideFlyoutAnchorIcon(a.ExternalId,!a.ImageIsVisible)),void 0!==a.Toggled&&null!==a.Toggled&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.Toggled)));else{f=!(void 0===a.ImageIsVisible||null===a.ImageIsVisible)&&!a.ImageIsVisible;const l=!(void 0===a.Toggled||null===a.Toggled)&&a.Toggled;c.push(appChrome.api.createFlyoutAnchorModel(a.ExternalId,a.LabelText,Object.assign(new vy,{iconSet:(new Tp.a(this.jra(a))).iconSet,keytip:a.KeyTip,
hideIcon:f,toggled:l,roleInMenu:a.AriaLabel})));this.Sm.addCommandToMaps(Object.assign(new Xa.a(a.ExternalId,a.Command),{queryCommandId:a.QueryCommand,populationProps:new Vg(a.PopulateQueryCommand,a.PopulateOnlyOnce)}))}a.Menu&&b.push.apply(b,this.Beg(a.ExternalId,"FlyoutAnchorModel",a.Menu,null));a.Lang&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}wtk(a,b,c,f){a.McuLayout&&f.push(a.McuExternalId);f.push(a.ExternalId);f=0;appChrome.selectors.isControlDefined(a.ExternalId)?a.McuLayout&&
(f=this.LRh.ldg(a.ExternalId,"ColorPickerModel").columnCount):(a.McuLayout&&(c.push(appChrome.api.createColorPickerModel(a.McuExternalId,a.Width)),this.Sm.addCommandToMaps(Object.assign(new Xa.a(a.McuExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})),f=a.Width),c.push(appChrome.api.createColorPickerModel(a.ExternalId,a.Width)),this.Sm.addCommandToMaps(Object.assign(new Xa.a(a.ExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));
c=[];const l=[];for(let w=0;w<a.Colors.length;w++){const F=a.Colors[w];w<f?c.push(appChrome.api.colorPickerCell(F.Color,F.DisplayColor,F.Alt)):l.push(appChrome.api.colorPickerCell(F.Color,F.DisplayColor,F.Alt))}0<c.length&&b.push(appChrome.actions.populateColorPickerCells(a.McuExternalId,c));b.push(appChrome.actions.populateColorPickerCells(a.ExternalId,l));a.SelectedColorId&&(0<c.length&&b.push(appChrome.actions.updateColorPickerSelectedColor(a.McuExternalId,a.SelectedColorId)),b.push(appChrome.actions.updateColorPickerSelectedColor(a.ExternalId,
a.SelectedColorId)))}jra(a){return a.Image32by32Class?this.Sm.E8f(a.Image32by32Class):a.Image16by16Class?this.Sm.E8f(a.Image16by16Class):a.ExternalImageId}E7i(a){return a?Object.assign(new BP.a,{displayName:a.DisplayName,personaCoinColor:a.ImageBackColor,isUnauthenticatedSender:a.IsAnonymous,identifiers:Object.assign(new AP.a,{PersonaType:"User",Smtp:a.PersonaId})}):null}$2i(a){let b=2;a&&"inputMethod"in a&&a.inputMethod&&(b=a.inputMethod);return b}isShadowMenuOpen(a){return!!a&&a.isShadowRendering}dAc(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static T7i(a,b){return appChrome.actions.populateFontPickerDataAsync(new Promise((c,f)=>{lb.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(l=>{l.isFeatureEnabled(Kr.a.iSa,!1).then(w=>{let F=b.fonts;w||l.isFreemiumUpsellEnabled()||(F=Ma.a.tna(F,S=>S.fontType!==Kr.a.Rye));w=Object.assign(new GG,{commandId:a.externalUxCommand,fonts:F,isSubscriber:w,mruList:b.mruList,initialPinnedFontKeys:b.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
c(w)}).catch(f)})}))}static R7i(a,b){const c=[];for(let f=0;f<b.MenuItems.MenuSectionList.length;f++){const l=b.MenuItems.MenuSectionList[f];l.Title&&c.push(appChrome.api.comboBoxHeader("Header-"+f.toString(),l.Title));for(let w=0;w<l.ControlList.length;w++){const F=Object(ua.a)(zP.a,l.ControlList[w]);F&&c.push(appChrome.api.comboBoxItem(F.MenuItemId,F.LabelText,F.Styles,F.CommandValueId,F.AriaLabel,F.Data,F.Disabled))}f<b.MenuItems.MenuSectionList.length-1&&c.push(appChrome.api.comboBoxDivider("Divider-"+
f.toString()))}return appChrome.actions.populateComboBoxOptions(a.externalUxCommand,c)}}Object(e.a)(Py,"ReactPopulateQueryCommandPoller",null,[]);class KG{constructor(a,b,c,f,l){this.Sm=c;this.Ioa=a;this.MJ=b;this.llb=f;this.c1a=l}U8i(a,b,c){const f=[];if(this.RBj(b))a=this.Ibj(a,b,c),void 0!==a&&null!==a&&f.push.apply(f,a);else if(a){var l=this.EMc(a,c);tm.a.visible in c&&f.push(appChrome.actions.updateControlHiddenState(a.externalUxCommand,!c[tm.a.visible]));f.push(Lt(a.externalUxCommand,1>(l&1)));
void 0!==c[tm.a.labelText]&&null!==c[tm.a.labelText]&&f.push(appChrome.actions.setControlLabel(a.externalUxCommand,c[tm.a.labelText]));void 0!==b&&null!==b&&(l=EG(a.externalUxCommand,b,c,l),void 0!==l&&null!==l&&f.push.apply(f,l),"PeopleWell"===b&&this.m_h(a.externalUxCommand,c,f))}return f}x0i(a,b,c){const f=[];switch(b){case "FlyoutAnchorModel":var l=appChrome.selectors.getFlyoutAnchorMenuItems(a);break;case "SplitButtonModel":var w=appChrome.selectors.getSplitButtonState(a);if(w=this.Sm.getCommandByExternalUxId(w.command))c=
this.Ioa.vec(this.MJ,w.commandId,c),f.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(a,!c)),f.push(Lt(a,!1));return f;default:return null}b=!1;for(w in l)if(l=this.Sm.getCommandByExternalUxId(w),ol.b(l))b=!0;else if(c.SourceControlId=l.externalUxCommand,this.Ioa.vec(this.MJ,l.commandId,c))return f.push(Lt(a,!1)),f;f.push(Lt(a,!b));return f}Ibj(a,b,c){switch(b){case "PreviewGalleryModel":return this.c1a.h8i(a,c);case "GalleryModel":return this.c1a.P1i(c)}return null}RBj(a){return"GalleryModel"===
a||"PreviewGalleryModel"===a}EMc(a,b){b.MenuItemId=a.menuItemId;return this.Ioa.U9c(this.MJ,this.llb,a.commandId,a.queryCommandId,b)}m_h(a,b,c){const f=b[Ky.a.LabelTextUserGeneratedPlaceholderReplacements];b=b[Ky.a.LabelText];f&&0<f.length&&(b=String.format.apply(null,[b].concat(f)));c.push(this.wej(a,b))}wej(a,b){return appChrome.actions.updatePeopleWell(this.dYi(a),b)}dYi(a){const b=[];var c={};a=this.Sm.getCommandByExternalUxId(a).populationProps.populateQueryCommandId;this.Ioa.U9c(this.MJ,this.llb,
"1285265560",a,c);c=c.MenuItems;if(!c)return b;c=c.MenuSectionList[0];for(a=0;a<c.ControlList.length;a++){const f=c.ControlList[a],l={};l.name=f.Alt;l.id=f.MenuItemId;l.description=f.Description;l.color=f.ImageBackColor;l.joinTime=f.JoinTimeInMS;l.imageUrl=f.ImageUrl;l.activeStatus=f.ActiveStatus;l.isAnonymous=f.IsAnonymous;l.canJump=f.CanJump;l.upn=f.Upn;b.push(l)}return b}}Object(e.a)(KG,"ReactQueryCommandPoller",null,[]);class LG{U9c(a,b,c,f,l,w){let F=0;a&&(this.vec(a,c,l)&&(F|=1),c=new jB,c.CommandLocation=
b,void 0!==w&&null!==w&&(c.InvocationMethod=w),!ol.b(f)&&a.R_f(f,l,c)&&(F|=2));return F}vec(a,b,c=null){return a?a.k4b(b,c):!1}}Object(e.a)(LG,"RootPoller",null,[]);class MG{constructor(a,b,c){this.Sm=a;this.MJ=b;a=new LG;this.uUh=new mB;this.c1a=new FG(a,this.MJ,c,this.Sm);this.mqf=new Py(a,this.MJ,c,this.Sm,this.c1a);this.fqf=new KG(a,this.MJ,this.Sm,c,this.c1a)}ZPa(){const a=[];if(!Pg.c())return a;a.push.apply(a,this.uej());var b=this.P_i();if(0<b.length)a.push.apply(a,b);else if(b=appChrome.selectors.getActiveControlIds(),
Object.keys(b).length){const c=this.Q_i();for(const f of c)a.push(appChrome.actions.updateControlEnabledDisabledState(f,!0)),delete b[f];a.push.apply(a,this.BNc(b))}return a}xec(a,b){Pg.c()&&(a=this.BNc(a,b),appChrome.api.dispatch(a))}bye(a,b,c=null){if(!ol.b(a)&&a.populationProps&&!this.mqf.Rph(a)){a=this.mqf.V8i(a,b,c);if(!a.HCh){let f;(f=a.actions).push.apply(f,this.BNc(a.iOf,Pg.g(c)))}if(0<a.actions.length)return appChrome.api.dispatch(a.actions),!0}return!1}BNc(a,b=0){const c=[],f={};if(Pg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var l of appChrome.selectors.getActiveGroupIds())for(var w of appChrome.selectors.getVisibleControlsInGroup(l))f[w]=!0;for(let F in a)l=F,w=a[F],0===b&&f[l]&&(b=2),c.push.apply(c,this.tej(l,w,b));return c}tej(a,b,c=0){const f=[],l=this.Sm.getCommandByExternalUxId(a);let w={};appChrome.selectors.isControlDefined(a)&&(w=this.uUh.ldg(a,b));w[yn.a.gyh]=c;ol.b(l)?
(w.ExternalUxId=a,(a=this.fqf.x0i(a,b,w))&&0<a.length&&f.push.apply(f,a)):(w.MenuItemId=l.menuItemId,w.SourceControlId=a);f.push.apply(f,this.fqf.U8i(l,b,w));return f}uej(){const a=[],b=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),c=appChrome.selectors.getContextualTabIds();let f=[];b&&(f=appChrome.selectors.getActiveContextualTabIds());
for(let w=0;w<c.length;w++){var l=this.Sm.b1d(c[w]);if(l){l=this.MJ.k4b(l);let F=!0;b&&(F=0<=Array.indexOf(f,c[w]));b&&F===l||a.push(appChrome.actions.activateDeactivateContextualTab(c[w],l))}}return a}P_i(){var a=appChrome.selectors.getSelectedTabId();const b=[],c=this.Sm.b1d(a);c&&(this.MJ.k4b(c)||b.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(a,!0)));return b}Q_i(){var a=appChrome.selectors.getActiveGroupIds();const b=[];for(const c of a)if(a=this.Sm.$1i(c))for(const f of a)this.MJ.k4b(f.commandId)||
((a=f.externalUxCommandIds)||(a=appChrome.selectors.getVisibleControlsInGroup(f.externalUxGroupId)),b.push.apply(b,a));return b}}Object(e.a)(MG,"ReactRibbonRootPoller",null,[1501]);class Uw{constructor(a,b,c=null){this.MJ=this.ZNb=this.PLa=null;this.IRh=b;a.wmb(this);this.O9=c}get LUc(){this.ZNb||(this.ZNb=new Date,this.ZNb.setTime(0));return this.ZNb}set LUc(a){this.ZNb=a}get kTk(){return 2}get O9(){return this.MJ}set O9(a){this.MJ=a}get PDb(){this.PLa||(this.PLa=new MG(this.IRh,this.O9,this.kTk));
return this.PLa}JDc(){const a=document.activeElement;ya.a.isEditable(a)&&a.blur()}executeCommand(a,b,c,f,l,w,F,S=2){ol.b(this.O9)||(l=new jB,l.CommandLocation=S,l.InvocationMethod=f,l.CommandTabName=c,this.v3a(),b[yn.a.gyh]=S,this.O9.R_f(a,b,l,w,F),this.gTj(a,b))}ZPa(){return ol.b(this.O9)?[]:this.PDb.ZPa()}wec(){const a=this.ZPa();0<a.length&&(this.LUc=new Date,appChrome.api.dispatch(a))}aJb(){Pg.c()&&this.PDb.xec({PeopleWell:"PeopleWell"},18)}v3a(){const a=lb.a.instance.qb("Common.ISystemInitiatedFeedback");
a?a.logActivity("SLRCommandUsed","FGSLRUsageEnabled"):Z.ULS.sendTraceTag(561394446,340,50,"ISystemInitiatedFeedback was null")}gTj(a,b){try{const c=lb.a.instance.qb("Common.ISystemInitiatedFeedback");if(c&&b){const f=b.SourceControlId||b.launcherId||b.LegacyId||b.NewContextId;let l=(f?"_"+f:"")+(b.SqmControlId?"_"+b.SqmControlId:"");l=l.length?l:"_"+a;c.Tbe("Ribbon"+l)}}catch(c){Z.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(c?c.toString():""))}}}Object(e.a)(Uw,"ReactRibbonRoot",
null,[1488,1500]);class nB{constructor(){this.Joa=[]}wmb(a){a&&!Array.contains(this.Joa,a)&&Array.add(this.Joa,a)}mbh(a){Array.remove(this.Joa,a)}JDc(){for(const a of this.Joa)a.JDc()}dispose(){this.Joa=null}}Object(e.a)(nB,"RootManagerBase",null,[240,109]);class Lr extends nB{constructor(){super()}static get instance(){return Lr.Ka||Lr.fwj()}static fwj(){Lr.Ka=new Lr;return Lr.Ka}}Lr.Ka=null;Object(e.a)(Lr,"ReactRootManager",nB,[239,240]);class up{constructor(a,b,c,f,l,w,F,S=null,fa=!0,xa=null,Za=
null){this.fMb=this.Vxc=this.Qpd=this.QO=null;this.Ftf=[];this.awc=null;this.l1a=a;this.kxd=b;this.klb=c;this.Kd=f;this.Da=l;this.Sm=w;this.QO=xa?xa:new Uw(Lr.instance,this.Sm);this.j0a=F;this.Vrf=new sG;this.XLa=S;this.OBd=fa;new oG;this.x1e=Za;Oc.a.get_instance().Ak(7,Object(C.a)(this,this.f2k,"setRibbonPostInteractiveReady"));Oc.a.get_instance().Ak(7,Object(C.a)(this,this.nVj,"logRibbonLoadedActivity"));Oc.a.get_instance().Ak(19,Object(C.a)(this,this.WSj,"logAppLoadedActivity"));u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",
!1)&&Oc.a.get_instance().Ak(7,Object(C.a)(this,this.RJk,"registerSubComponentReporting"));Oc.a.get_instance().Ak(7,Object(C.a)(this,this.pBk,"queueSettingsDependentActions"))}initialize(a,b,c=null){this.OBd||this.bJ(5);c?c.then(()=>{this.Hch()}).catch(()=>Z.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):nG.a.Suh(nG.a.Suh(co.Task.WAA(this.tzg(a),this.szg(up.JHh)),()=>this.szg(up.RFh)),()=>this.tzg(b)).continueWith(()=>{this.Hch()},11)}dispose(){this.Wol();this.awc&&
this.awc.dispose();for(const a of this.Ftf)Oc.a.get_instance().Yki(a);u.AFrameworkApplication.Va.gO(G.a.fQk,de.a.frame,Le.ActionManager.Dg)}szg(a){return lb.a.instance.resolve("Common.ISharedDependencyLoader").Tvb(u.AFrameworkApplication.Rj(a,2))}tzg(a){return""===a?co.Task.ot(!0):lb.a.instance.resolve("Common.ISharedDependencyLoader").Tvb(u.AFrameworkApplication.Rj(a,3))}tlg(){(this.XLa||this.j0a)&&appChrome.api.dispatch(this.xeg());this.VIe();Pg.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(u.AFrameworkApplication.zea);
this.QO.wec()}Hch(){this.tlg();this.OBd&&(appChrome.renderAppChrome(this.l1a,Pg.e()),this.bJ(10));this.Pzf();this.pBc();this.OBd&&this.bJ(5);this.ZPc()}ZPc(){this.Kd&&this.Da&&this.klb&&(this.awc=new tG(this.Kd,this.Da,this.l1a,this.klb),this.awc.initialize())}get WSk(){return this.Vrf}setCommandDefinitionMapping(){if(Pg.a("setCommandDefinitionMapping")){const a=uP(this.Sm);appChrome.api.setCommandDefinitionMapping(a)}}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.J7&&
Pg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{0===b&&this.QCb()})}Pzf(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const a=Object(ua.a)(Uw,this.QO);this.Qpd=new rG(this.QO,a.PDb,this.Sm,this.Kd,this.kxd,lb.a.instance.qb("Common.IRibbonSQMInformation"),lb.a.instance.qb("Common.IFileMenuSQMInformation"),u.AFrameworkApplication.Va,u.AFrameworkApplication.fa,lb.a.instance.Oa("Common.ISystemInitiatedFeedback"),null);this.xai();
this.Ohj()}xai(){this.Vxc=appChrome.api.bindCommandHandler((a,b)=>{this.Qpd.executeCommand(a,b)})}Wol(){this.Vxc&&(this.Vxc(),this.Vxc=null)}VIe(){appChrome.api.initializeLogger(new vP.a)}ZPa(){return this.QO?this.QO.ZPa():[]}QCb(){ce.a.instance.sF(()=>{let a=null;ce.a.instance.sF(()=>{a=this.ZPa()},"RB:GA");a&&0<a.length&&(this.QO.LUc=new Date,ce.a.instance.sF(()=>{appChrome.api.dispatch(a)},"RB:DA"));this.fMb&&ce.a.instance.sF(()=>{},"RB:J")},"RB:PFSU")}aJb(){this.QO.aJb()}yXh(a){a=[appChrome.actions.activateDeactivateContextualTab(a,
!0),appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}setCurrentTab(a){a=[appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}xeg(){var a=u.AFrameworkApplication.fa;const b=[];a.ka("EnableTellMeForOneLineRibbonIsEnabled")?a.ka("OcpsIsEnabled")&&lb.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(c=>{c.isFeatureEnabled("ConnectedServices",!0).then(f=>{f&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));
return null})}):b.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));b.push.apply(b,this.I8f());a=new lG.a(this.Sm);this.XLa.i$&&(tp.uml(this.XLa.i$),b.push.apply(b,a.MWd(this.XLa.i$)));if(this.XLa.uwh)for(const c of this.XLa.uwh)b.push(appChrome.actions.updateGallerySectionHiddenState(c.OTi,c.uF,c.wml));b.push.apply(b,a.lVi(this.XLa.vml));return b}I8f(){const a=[];if(this.j0a&&this.j0a.i$){const c=this.j0a.i$;for(let f in c){var b=c[f];const l=this.Sm.tYd(f);if(l)for(let w of l)a.push(appChrome.actions.updateControlHiddenState(w,
b))}}return a}TIb(a){a&&this.QO.PDb.xec(a,0)}bye(a){this.QO.PDb.bye(this.Sm.getCommandByExternalUxId(a),appChrome.selectors.getModelType(a),{inputMethod:0})}X8k(a){Oc.a.get_instance().Ak(5,null).continueWith(()=>{appChrome.api.dispatch(this.Kaj(a))})}nFi(){const a=u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled")?"ShareMenu":"Share",b=u.AFrameworkApplication.fa.appSettings;b&&appChrome.api.dispatch(this.Dtl(a,"Shared"===(b.SharingStatus||"")))}pBk(){u.AFrameworkApplication.fa.gf(()=>{this.nFi()})}Dtl(a,
b){return appChrome.actions.updateSharingStatusIndicator(a,b)}Kaj(a){return appChrome.actions.updateControlHiddenState(a,!1)}Laj(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}bJ(a){Oc.a.get_instance().bJ(a);this.Ftf.push(a)}f2k(){Pg.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new mG,{postRibbonInteractiveReady:!0})))}pBc(){this.j0a&&this.x1e&&(this.fMb=this.x1e.createFileMenu(this.j0a,this.QO.O9),
this.Vrf.fileMenu=this.fMb)}KPj(){this.fMb&&this.fMb.HPj()}Hdd(a,b,c){if(1===c)return 32;this.ujc(!0);this.QCb();u.AFrameworkApplication.Ba.updateCommandUI();return 32}Idd(a,b,c){if(1===c)return 32;this.ujc(!1);this.k2k();this.QCb();u.AFrameworkApplication.Ba.updateCommandUI();return 32}k2k(){Di.a.LL(u.AFrameworkApplication.fa.Ia("IsSimplifiedRibbonOnCookieName"),"true",Di.a.qL)}ujc(a){Di.a.LL(u.AFrameworkApplication.fa.Ia("ReactRibbonMLRPreferenceCookieName"),a.toString(),Di.a.qL)}nVj(){if(u.AFrameworkApplication.Ba&&
u.AFrameworkApplication.Ba.jb.mo){const a=lb.a.instance.Oa("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(a.execute(b=>{b.logActivity("SingleRibbonModeActivity",null)}),u.AFrameworkApplication.oN("d79fg304;61jba833")):"Multiline"===appChrome.selectors.getRibbonMode()&&(a.execute(b=>{b.logActivity("MultiRibbonModeActivity",null)}),u.AFrameworkApplication.oN("69a7h198;dfd7j584"))}}WSj(){const a=Di.a.ABa(u.AFrameworkApplication.fa.Ia("VNextStyleOptOutCookieName"),
!1);window.setTimeout(()=>{const b=lb.a.instance.Oa("Common.ISystemInitiatedFeedback");b&&(u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?(b.execute(c=>{c.logActivity("VNextStylesOn",null)}),b.execute(c=>{c.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):u.AFrameworkApplication.fa.ka("Fluent2StyleFGOnlyIsEnabled")&&a&&b.execute(c=>{c.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}RJk(){Oc.a.get_instance().Ak(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",
!1)});const a=appChrome.api.getRibbonSubComponentMappings();for(let c in a){var b=c;const f=a[c];if(f)for(const l of f)u.AFrameworkApplication.Va.eS(l)?appChrome.api.reportRibbonSubComponentBehaviorMapped(b):u.AFrameworkApplication.Va.b1k(l,this.txi(b));else appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}txi(a){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(a)}}Ohj(){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&Pg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&u.AFrameworkApplication.LCb.aFd){const a=u.AFrameworkApplication.LCb.aFd,b=u.AFrameworkApplication.LCb.zzf;b.payload||(b.payload={});const c=b.payload.launcherId?b.payload.launcherId:a;up.Jdd.Kb(c)?up.Jdd.ga(c)():"StatefulSplitButtonModel"===b.modelType?appChrome.PRIToastManager.dismissToast():(b.payload.PRIReadinessCheck=!0,this.Qpd.executeCommand(a,b))}}}up.JHh="common";up.RFh=
"appChrome";up.Jdd=new tP.a(gB.a.dfg());Object(e.a)(up,"ReactRibbonUser",null,[236,237,109]);class oB{constructor(){this.label=this.value=null}}Object(e.a)(oB,"TextInfoSectionField",null,[]);class NG{constructor(a,b){this.i$=b}}Object(e.a)(NG,"ReactRibbonJewelProperties",null,[]);class pB extends up{constructor(a,b,c,f,l,w,F,S,fa=null,xa=!0,Za=null,pb=null){super(a,b,f,l,w,F,S,fa,xa,Za,pb);this.xrc=null;this.AMb=c;this.AMb.execute(Mb=>{this.xrc=Mb});this.AMb.execute(Mb=>{this.QO.O9=Mb})}ZPa(){return this.xrc?
(this.xrc.clearCache(),super.ZPa()):[]}}Object(e.a)(pB,"ReactRibbonUser",up,[]);var qB=d(871),Qy=d(242),rB=d(361),OG=d(698),sB=d(1074);class Vw{static get Gwg(){return"teams"===(u.AFrameworkApplication.fa.Ia(u.AFrameworkApplication.lJ)||"").toLowerCase()}static get Wmh(){return Vw.Gwg?(za.a.J(576030427,811,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.fPa,u.AFrameworkApplication.ipb),u.AFrameworkApplication.fPa&&u.AFrameworkApplication.ipb):u.AFrameworkApplication.fPa}}
Object(e.a)(Vw,"CopyLinkHelper",null,[]);class tB{constructor(a,b){this.gqe=null;this.la=a;this.F5j=b}dispose(){this.gqe&&(rm.CuiHelper.QFi(this.gqe),this.gqe=null)}Udj(){if(u.AFrameworkApplication.workflowEnabled){let a="";switch(u.AFrameworkApplication.Rnc){case "Assign":a=CommonUIStrings.l_Assign;break;case "Submit":a=CommonUIStrings.l_Submit}if(a.length)return Object.assign(new sB.a,{command:"2988588587",label:a,id:"btnWorkflow"})}return u.AFrameworkApplication.f$d&&u.AFrameworkApplication.LWa||
u.AFrameworkApplication.snc?Object.assign(new sB.a,{command:"1197060601",label:ResourceStrings.L_ReplyWithChanges,id:rm.CuiHelper.Wcd}):u.AFrameworkApplication.fPa?Object.assign(new sB.a,{command:"981334692",label:ResourceStrings.L_Share,image:rm.CuiHelper.s5k,id:rm.CuiHelper.DJe}):null}R7k(){if(Vw.Gwg&&!this.F5j)return!1;const a=this.Udj();return a&&"981334692"===a.command?this.la.cvg||this.la.XIj:!1}V7k(){za.a.J(576030426,820,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.fPa,
u.AFrameworkApplication.ipb);return u.AFrameworkApplication.fPa&&(u.AFrameworkApplication.ipb||u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled"))}}tB.AMb=null;Object(e.a)(tB,"CuiControlUser",null,[109]);class PG extends pB{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td){super(b,a.vha,f,Xd.a.hea,l,w,F,null,xa,!0,null,Mb);this.PCg=this.Z5b=this.cCg=this.exb=this.nm=this.gFa=this.la=this.hh=this.NSa=this.e2c=this.Qd=this.Nee=this.Yie=null;this.pIg=!1;this.D6=0;this.ng=null;this.Pje=this.WZc=
this.t8=!1;this.ku=this.a1c=this.Mab=null;b=new rB.a("ReactRibbonUser::InitPptReactRibbon",!1);try{this.gFa=pb,this.la=Za,this.Nee=new tB(this.la,Ec.ka("ShareMenuIsEnabled")),this.Yie=a,this.Qd=c,this.e2c=fa,this.exb=F,this.NSa=S||new OG.a,this.hh=this.NSa.SOd(2,"ReactRibbonUser"),this.D6=0,this.cCg=xa.i$,this.t8=!!window.performance&&!!window.performance.now,this.nm=hc,this.WZc=kc,this.Mab=Ec,this.Pje=Hc,this.a1c=Dc,this.ku=Td,this.GOk(),Oc.a.get_instance().Ak(10,Object(C.a)(this,this.ovj,"initializeFullPptRibbon"),
11),Oc.a.get_instance().Ak(10,Object(C.a)(this,this.createHeader,"createHeader"),3)}finally{b&&b.dispose()}}slg(){og.a.instance.jc("InitRibbon",(new Date).getTime());za.a.J(40493087,801,50,"Initialize SLR Iteration: {0}; UseNewSlideShowTab: {1}; IsReactMLRRendered: {2}",this.la.cwk?"2":"1",this.la.gwk.toString(),this.la.Pma);this.la.podsRibbonEarlyRendererExposureControl&&!this.la.nUf?PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(Object(C.a)(this,
this.cvj,"initializeEarlyRenderedPptRibbon")):(og.a.instance.jc("RenderRibbonStart",Date.now()),this.y4i(Qy.a(lb.a.instance)).catch(()=>{za.a.J(38290011,801,10,"Failed to load the resources for the Ribbon.")}).then(()=>{og.a.instance.jc("AppChromeReadyTime",Date.now());appChrome.setScriptLoader(Qy.a(lb.a.instance));this.la.aIk&&Pg.a("setCookieWithExpirationCallback")&&Pg.a("setGetCookieValueCallback")&&(appChrome.api.setCookieWithExpirationCallback((a,b)=>Di.a.LL(a,b,Di.a.qL)),appChrome.api.setGetCookieValueCallback(a=>
Di.a.get(a)));appChrome.setAppSettings(u.AFrameworkApplication.fa.appSettings);if(this.la.ka("DynamicBundlesIsEnabled")){const a=u.AFrameworkApplication.zea+"exp/";appResourceLoader.init(qP.a.resolveScript,a);appChrome.api.setWebpackPublicPath(a)}PowerPointWebEditor.AppChromeSettingsLoadedHandler.OnAppChromeSettingsLoaded();this.VIe();qd.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?appChrome.initializeRibbonStore(this.la.Pma):appChrome.initializeRibbonStore();this.tlg();this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PerceivedRibbonInteractiveIsEnabled",
!1)&&1!==u.AFrameworkApplication.Ba.mode&&(this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",!1)?this.aah():this.L5d());this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.gFa&&this.gFa.MOk();appChrome.renderAppChrome(this.l1a,Pg.e());this.la.SAb&&qd.a("ModernRibbonShimmerCGEnabled")&&PowerPointWebEditor.MinimalBoot.SetRealRibbon("ContentEditable");Oc.a.get_instance().bJ(5);Oc.a.get_instance().bJ(10);
qd.a("React.SetRibbonBehaviorAttached")&&Oc.a.get_instance().bJ(6);this.dxh();og.a.instance.jc("Stage1Ribbon",qB.a.lUd&&void 0!==PowerPointWebEditor.FakeRibbon.ShowTime&&null!==PowerPointWebEditor.FakeRibbon.ShowTime?PowerPointWebEditor.FakeRibbon.ShowTime:(new Date).getTime())}))}aah(){Oc.a.get_instance().Ak(4,()=>{Oc.a.get_instance().isCompleted(7)||this.L5d()})}y4i(a){return qd.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?this.la.LEk?a(this.la.Pma?"powerpoint-ribbon-mlr-intl":"powerpoint-ribbon-intl").catch(()=>
{}).then(()=>a("appChrome")):this.la.Pma?a("powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("powerpoint-ribbon-mlr-intl")).catch(()=>{}).then(()=>a("appChrome")):a("powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome")):a("appChrome")}cvj(){void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&og.a.instance.jc("RenderRibbonStart",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime);void 0!==
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&og.a.instance.jc("AppChromeReadyTime",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&og.a.instance.jc("Stage1Ribbon",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive?
(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive(),this.L5d()):this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",!1)&&this.aah();PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData&&this.a1c.Bih(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand,PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData);
void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime?og.a.instance.jc("AppInitStatus_ribbonSkeletonDismissed",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime):this.dxh();for(const a of PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache)4===a.length&&Z.ULS.sendTraceTag(a[0],a[1],a[2],a[3]);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache.length=0;this.VIe();
Oc.a.get_instance().bJ(5);Oc.a.get_instance().bJ(10);qd.a("React.SetRibbonBehaviorAttached")&&Oc.a.get_instance().bJ(6);ru.a.dispatch("RibbonVisible")}ovj(){og.a.instance.jc("InitFullRibbon",(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(a=>{og.a.instance.jc("RibbonLazyPromiseFulfilled",(new Date).getTime());u.AFrameworkApplication.fa.gf(()=>{this.Nee.V7k()?Oc.a.get_instance().Ak(7,()=>{za.a.J(575792772,801,50,"Render CopyLink button on Teams session after the full app settings and Chrome ready!");
appChrome.api.dispatch(this.Laj())}):Oc.a.get_instance().Ak(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl("CopyLink"))})});this.XLa&&a.push.apply(a,this.xeg());if(u.AFrameworkApplication.Ba.jb.J7){const b=[];b.push(document.getElementById("WACDocumentPanel"));a.push(appChrome.actions.setShyState(Object.assign(new rP.a,{shyDismissalRegions:b})))}appChrome.api.dispatch(a);this.WJk();this.AMb.execute(b=>{if(void 0===this.QO.O9||null===this.QO.O9)this.QO.O9=b;this.Pzf()});this.AHk();
this.pBc();this.createFileMenu();this.gFa&&(a=this.gFa.initialize(),za.a.J(578351505,801,50,"Doc Mode Switcher Initialize response: "+a.toString()));this.ZPc();Oc.a.get_instance().bJ(7);og.a.instance.jc("Stage3Ribbon",(new Date).getTime());this.t8&&og.a.instance.jc("RibbonInteractivePerfMark",window.performance.now());this.oVj();this.bLk();this.pvj();ya.a.KH(this.Yie.iG(),"ScrollableRibbon");return null})}oVj(){if(og.a.instance.e7a)za.a.J(589178122,813,15,"Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");
else{var a={};og.a.instance.qn("Stage1Ribbon")&&(a.RibbonDisplayed=og.a.instance.Rg("Stage1Ribbon"));og.a.instance.qn("Stage3Ribbon")&&(a.RibbonInteractive=og.a.instance.Rg("Stage3Ribbon"));og.a.instance.qn("InitRibbon")&&(a.InitRibbon=og.a.instance.Rg("InitRibbon"));og.a.instance.qn("InitFullRibbon")&&(a.InitFullRibbon=og.a.instance.Rg("InitFullRibbon"));og.a.instance.qn("RibbonLazyPromiseFulfilled")&&(a.RibbonLazyPromiseFulfilled=og.a.instance.Rg("RibbonLazyPromiseFulfilled"));og.a.instance.qn("RenderRibbonStart")&&
(a.RenderRibbonStart=og.a.instance.Rg("RenderRibbonStart"));og.a.instance.qn("AppChromeReadyTime")&&(a.AppChromeReadyTime=og.a.instance.Rg("AppChromeReadyTime"));og.a.instance.qn("AppInitStatus_ribbonSkeletonDismissed")&&(a.RibbonSkeletonDismissed=og.a.instance.Rg("AppInitStatus_ribbonSkeletonDismissed"));za.a.J(589178120,809,50,"Ribbon Perf metrics: "+va.a.toJSON(a))}}zUj(){if(og.a.instance.e7a)za.a.J(572667086,813,15,"Lazy Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");
else{var a={};og.a.instance.qn("Stage2Ribbon")&&(a.RibbonEnabled=og.a.instance.Rg("Stage2Ribbon"));og.a.instance.qn("Stage4Ribbon")&&(a.RibbonFull=og.a.instance.Rg("Stage4Ribbon"));za.a.J(572667087,809,50,"Lazy Ribbon Perf metrics: "+va.a.toJSON(a))}}pvj(){appChrome.getExtRibbonInitializationActions().then(a=>{appChrome.api.dispatch(a);og.a.instance.jc("Stage4Ribbon",(new Date).getTime());this.zUj();return null})}QCb(){this.xrc&&Oc.a.get_instance().isCompleted(7)&&(Me.a.mark(4893),super.QCb(),Me.a.mark(4894),
this.pIg||(og.a.instance.jc("Stage2RibbonStart",Date.now()),appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0)),og.a.instance.jc("Stage2Ribbon",Date.now()),this.pIg=!0))}YG(){this.QCb()}selectRibbonTabById(a){this.yXh(a)}get Jhh(){return appChrome.selectors.getSelectedTabId()}iFi(){appChrome.getHeaderApi().then(a=>a.dismissPlaceholder())}createHeader(){const a=(new Date).getTime();u.AFrameworkApplication.fa.gf(()=>{if(!qd.a("PPTOHideLegacySharedHeaderBugFix")||!u.AFrameworkApplication.LP){var b=
(new Date).getTime(),c=this.hh.Ut("createHeader"),f=u.AFrameworkApplication.Ba.jb.kN,l=document.getElementById("HeaderPlaceholder"),w=(new jG(nf.a.JHi,this.Yie)).LKi();if(f)try{za.a.J(591152910,801,50,"Shared Header - Calling RenderSharedHeader");const F=new gG;appChrome.renderSharedHeader(w,F.v8i()).then(()=>{this.QSj(b,a);l&&this.iFi()})}catch(F){za.a.J(591152908,801,10,"Exception while trying to render shared header {0}",F)}else throw za.a.J(529274575,801,10,"Invalid request to render legacy Shared Header."),
Error.invalidOperation("Invalid request to render legacy Shared Header");u.AFrameworkApplication.LP||(w=Jr.a.A5d(E.AppFrame.MQa,null,w,!0),f&&(w.HK=!0,this.RDb(w,G.a.pic,G.a.oic),w.bindAction(A.KeyInputManager.La(x.a.B0,0),G.a.Fdd)));!l&&qB.a.l1f&&PowerPointWebEditor.FakeHeader.RemoveFakeHeader();this.hh.au(c);this.D6|=1;this.Nmc()}})}QSj(a,b){var c=(new Date).getTime();const f={};f.headerCallbackRegistrationTime=b;f.headerCallbackInvokedTime=a;f.headerRenderCompleteTime=c;za.a.J(523532183,809,50,
"Create Header Perf metrics: "+va.a.toJSON(f))}dw(a){this.ng=new XMLHttpRequest;this.ng.open("GET",a,!0);this.ng.send(null)}RDb(a,b,c){const f=A.KeyInputManager.La(x.a.tq,0),l=A.KeyInputManager.La(x.a.tq,4);a.Wo(f);a.Wo(l);a.bindAction(f,b);a.bindAction(l,c)}pBc(){const a=()=>{const b=this.hh.Ut("createJewel");this.j0a=this.Zvj();up.prototype.pBc.call(this);this.hh.au(b);this.D6|=2;this.Nmc()};this.WZc&&this.Mab?this.Mab.Ntb(a):u.AFrameworkApplication.fa.gf(a)}createFileMenu(){const a=(new Date).getTime(),
b=()=>{const c=(new Date).getTime(),f=this.hh.Ut("createFileMenu"),l=[];if(this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var w=[Object.assign(new oB,{label:CommonUIStrings.L_DiagnosticsSessionId,value:u.AFrameworkApplication.userSessionId}),Object.assign(new oB,{label:CommonUIStrings.L_DiagnosticsBuild,value:u.AFrameworkApplication.buildVersion})];l.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",w))}l.push.apply(l,this.I8f());w=document.createElement("div");document.body.appendChild(w);
appChrome.renderFileMenu(w,l);this.PSj(c,a);this.hh.au(f);this.D6|=22;this.Nmc()};this.WZc&&this.Mab?this.Mab.Ntb(b):u.AFrameworkApplication.fa.gf(b)}PSj(a,b){var c=(new Date).getTime();const f={};f.fileMenuCallbackRegistrationTime=b;f.fileMenuCallbackInvokedTime=a;f.fileMenuRenderCompleteTime=c;za.a.J(523532184,809,50,"File Menu Perf metrics: "+va.a.toJSON(f))}AHk(){const a=()=>{const b=this.hh.Ut("refreshRibbon");this.Z5b||(this.Z5b={},tp.qwh(this.Z5b),this.e2c.eBh(this.Z5b),this.PCg=this.tXi(this.cCg,
this.Z5b));const c=new lG.a(this.exb);appChrome.api.dispatch(c.MWd(this.PCg));this.hh.au(b);this.D6|=4;this.Nmc()};this.WZc&&this.Mab?this.Mab.Ntb(a):u.AFrameworkApplication.fa.gf(a)}tXi(a,b){const c={};for(let l in b){var f=b[l];const w=l;f!==a[w]&&(c[w]=f,za.a.J(38318353,801,50,"TrimedId changed after full settings ready, TrimId:{0} PreviousValue:{1} CurrentValue:{2}",w,a[w],f))}return c}Zvj(){const a={};this.e2c.s0k(a);this.e2c.eBh(a);return new NG(null,a,"jewelPPTEditor")}bLk(){qB.a.lUd&&PowerPointWebEditor.FakeRibbon.RemoveFakeRibbon()}sbh(a){Oc.a.get_instance().Ak(7,
()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl(a))})}GOk(){const a=this.la.ka("ShareMenuIsEnabled"),b=a?"ShareTopBar":"Share";u.AFrameworkApplication.ipb?this.sbh(b):u.AFrameworkApplication.fa.gf(()=>{const c=this.hh.Ut("createShareAction"),f=this.Nee.R7k();f?this.X8k(b):(this.sbh(b),this.la.Feb&&this.nm.t9(this.nm.z4,this.nm.Egd));a&&(f?this.la.Feb&&Oc.a.get_instance().Ak(7,()=>{this.nm.Rua(this.nm.z4,this.nm.Egd);this.nm.Qua(this.nm.z4,this.nm.Egd)}):Oc.a.get_instance().Ak(7,
()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShareMenu",!f))}));this.hh.au(c);this.D6|=8;this.Nmc()})}Nmc(){31===this.D6&&(this.NSa.CVc(2),this.D6=0)}L5d(){this.a1c.wai();appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0));Oc.a.get_instance().Ak(7,()=>{this.a1c.Vol();Pg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&this.Pje||appChrome.PRIToastManager.dismissToast()},11)}dxh(){this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.BuildTimeRibbonScalingCombinedIsEnabled",
!1)?this.wAg():appChrome.setOnRibbonInitializationChange((a,b)=>{!a.ribbonVisible&&b.ribbonVisible&&this.wAg()})}wAg(){Oc.a.get_instance().bJ(18);ru.a.dispatch("RibbonVisible")}AQg(){return()=>{this.ku.Dzc(()=>{appChrome.PRIToastManager.dismissToast()})}}WJk(){this.Pje&&(up.Jdd.$("NewDefaultSlide",this.AQg()),up.Jdd.$("ChangeLayoutFlyout",this.AQg()))}}Object(e.a)(PG,"ReactRibbonUser",pB,[544,237,109]);class QG{constructor(a,b,c,f,l,w,F){this.lyb=null;this.Bb=a;this.XKg=b;this.sa=c;this.BD=f;this.xN=
l;this.ia=w;this.qp=F;this.XKg.yk(Object(C.a)(this,this.Xeh,"ribbonChangeTabHandler"))}dispose(){this.XKg.Pm(Object(C.a)(this,this.Xeh,"ribbonChangeTabHandler"))}get oI(){return this.lyb}set oI(a){this.lyb!==a&&a&&(this.lyb=a,this.xN.uZ?this.xN.uZ=!1:this.qp&&this.xN.XRa&&this.ia.processAction(D.a.Mha,2))}Xeh(a,b){b.node.Sa(zb.a.shapeId)&&(a=b.node.getValue(zb.a.shapeId),this.lyb&&this.lyb.id===b.node.id&&a&&(this.Bb.Hb(new Se.a(2,1,0,()=>{const c=this.sa.t$i(this.BD.Jhh,b.node);0<c.length&&this.BD.selectRibbonTabById(c)},
90,"10")),this.lyb=null))}}Object(e.a)(QG,"RibbonChangeManager",null,[546]);class RG{constructor(a,b,c){this.OTi=a;this.uF=b;this.wml=c}}Object(e.a)(RG,"GallerySectionData",null,[]);let uB,vB,Ry,wB,Ww,xB,yB,zB,AB;class dv{constructor(a,b,c,f,l,w){this.la=a;this.J0c=b;this.d0c=c;this.rne=f;this.gxb=l;this.nm=w}ngd(a){this.la.Ttg&&(a["PptRibbon.Home.Drawing.TextBox"]=!0,a["PptRibbon.Home.Drawing.Rectangle"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangle"]=!0,a["PptRibbon.Home.Drawing.Ellipse"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangleCallout"]=
!0,a["PptRibbon.Home.Drawing.Star5"]=!0,a["PptRibbon.Home.Drawing.Triangle"]=!0,a["PptRibbon.Home.Drawing.Can"]=!0,a["PptRibbon.Home.Drawing.Cube"]=!0,a["PptRibbon.Home.Drawing.StraightConnector"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorArrow"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorTwoArrow"]=!0,a["PptRibbon.Home.Drawing.RightArrow"]=!0,a["PptRibbon.Home.Drawing.DownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftArrow"]=!0,a["PptRibbon.Home.Drawing.UpArrow"]=!0,a["PptRibbon.Home.Drawing.UpDownArrow"]=
!0,a["PptRibbon.Home.Drawing.LeftRightArrow"]=!0,a["PptRibbon.Home.Drawing.MoreShapes"]=!0,a["PptRibbon.Home.Font.ChangeCase"]=!this.la.pii,a["PptRibbon.InsertTab.Illustrations.TextBox"]=!0,a["PptRibbon.InsertTab.Illustrations.Rectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Ellipse"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangleCallout"]=!0,a["PptRibbon.InsertTab.Illustrations.Star5"]=!0,a["PptRibbon.InsertTab.Illustrations.Triangle"]=
!0,a["PptRibbon.InsertTab.Illustrations.Can"]=!0,a["PptRibbon.InsertTab.Illustrations.Cube"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnector"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorTwoArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.RightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.DownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpDownArrow"]=
!0,a["PptRibbon.InsertTab.Illustrations.LeftRightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBox"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Rectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Ellipse"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangleCallout"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Star5"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Triangle"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.Can"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Cube"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnector"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorTwoArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.DownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpArrow"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.UpDownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftRightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Duplicate"]=!0);this.la.Ttg||(a["PptRibbon.Home.Drawing.AllShapes"]=!0,a["PptRibbon.InsertTab.Illustrations.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBoxBig"]=!0);this.la.Y$d||(a["PptRibbon.InsertTab.InsertTables"]=
!0);a["ContextualTabs.Tables.Design"]=!0;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!0;a.buttonFirstRow=!0;a.buttonFirstColumn=!0;a.buttonLastRow=!0;a.buttonLastColumn=!0;a.buttonBandedRow=!0;a.buttonBandedColumn=!0;a["ContextualTabs.Tables.Design.TableStyles"]=!0;a.buttonTableStyleRibbon0=!0;a.buttonTableStyleRibbon1=!0;a.buttonTableStyleRibbon2=!0;a.buttonTableStyleRibbon3=!0;a.buttonTableStyleRibbon4=!0;a.buttonTableStyleRibbon5=!0;a.buttonTableStyleRibbon6=!0;a.fsfaMoreTableStyles=!0;
a.fsfaTableStyleTheme=!0;a["ContextualTabs.Tables.Design.Shading"]=!0;a.cellShadingColor=!0;a["ContextualTabs.Tables.Design.TableBorderStyle"]=!0;a["ContextualTabs.Tables.Design.DrawBorders"]=!0;a.TableBorders=!0;a.TableBordersPenColor=!0;a.TableBorderPenWeight=!0;a["ContextualTabs.Tables.Layout"]=!0;a["ContextualTabs.Tables.Layout.Table"]=!0;a.idTableSelect=!0;a.btnSelectTable=!0;a.btnSelectColumn=!0;a.btnSelectRow=!0;a["ContextualTabs.Tables.Layout.RowColumn"]=!0;a.idTableDelete=!0;a.btnTableDelete=
!0;a.btnColumnDelete=!0;a.btnRowDelete=!0;a["ContextualTabs.Tables.Layout.MergeSplit"]=!0;a.btnMergeTableCells=!0;a.btnSplitTableCells=!0;a.btnInsertRowAbove=!0;a.btnInsertRowBelow=!0;a.btnInsertColumnLeft=!0;a.btnInsertColumnRight=!0;a.btnDistributeRows=!0;a.btnDistributeColumns=!0;a["ContextualTabs.Tables.Layout.Alignment"]=!0;a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!0;a.btnTableCellLeftJustify=!0;a.btnTableCellCenterJustify=!0;a.btnTableCellRightJustify=!0;a.btnTableCellTopAnchoring=
!0;a.btnTableCellMiddleAnchoring=!0;a.btnTableCellBottomAnchoring=!0;if(this.la.W$d){if(this.la.X$d||this.la.mvb||this.la.V$d)a["ContextualTabs.Tables.Layout"]=!1;this.la.V$d&&(a["ContextualTabs.Tables.Layout.Alignment"]=!1,a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!1,a.btnTableCellLeftJustify=!1,a.btnTableCellCenterJustify=!1,a.btnTableCellRightJustify=!1,a.btnTableCellTopAnchoring=!1,a.btnTableCellMiddleAnchoring=!1,a.btnTableCellBottomAnchoring=!1);a["ContextualTabs.Tables.Design"]=
!1;this.la.X$d&&(a["ContextualTabs.Tables.Layout.Table"]=!1,a.idTableSelect=!1,a.btnSelectTable=!1,a.btnSelectColumn=!1,a.btnSelectRow=!1);this.la.mvb&&(a["ContextualTabs.Tables.Layout.RowColumn"]=!1,a.idTableDelete=!1,a.btnTableDelete=!1,a.btnColumnDelete=!1,a.btnRowDelete=!1,a.btnInsertRowAbove=!1,a.btnInsertRowBelow=!1,a.btnInsertColumnLeft=!1,a.btnInsertColumnRight=!1);a["ContextualTabs.Tables.Design.Shading"]=!1;a.cellShadingColor=!1;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!1;a.buttonFirstRow=
!1;a.buttonFirstColumn=!1;a.buttonLastRow=!1;a.buttonLastColumn=!1;a.buttonBandedRow=!1;a.buttonBandedColumn=!1;a["ContextualTabs.Tables.Design.TableStyles"]=!1;a.buttonTableStyleRibbon0=!1;a.buttonTableStyleRibbon1=!1;a.buttonTableStyleRibbon2=!1;a.buttonTableStyleRibbon3=!1;a.buttonTableStyleRibbon4=!1;a.buttonTableStyleRibbon5=!1;a.buttonTableStyleRibbon6=!1;a.fsfaMoreTableStyles=!1;this.la.F9&&(a["ContextualTabs.Tables.Design.TableBorderStyle"]=!1,a.TableBorders=!1,this.la.iDb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=
!1,a.TableBorderPenWeight=!1),this.la.tdb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBordersPenColor=!1));this.la.JTc&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnMergeTableCells=!1);this.la.$$d&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnSplitTableCells=!1);this.la.mfc&&(a.btnDistributeRows=!1,a.btnDistributeColumns=!1)}this.la.powerPointFullTextJustifyIsEnabled||(a["PptRibbon.Home.Paragraph.FullJustify"]=!0);this.la.powerPointSmartLookupIsEnabled||(a["PptRibbon.Review.SmartLookup"]=
!0,a["PptRibbon.Review.Show.SmartLookup"]=!0,a["PptRibbon.Review.ShowHide.SmartLookup"]=!0);this.la.powerPointFormatBackgroundEnabled||(a["PptRibbon.Design.Customize.FormatBackgroundAnchor"]=!0);a["PptRibbon.InsertTab.Symbols"]=!u.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled");this.la.Tug||(a["PptRibbon.Home.Font.Shrink"]=!0,a["PptRibbon.Home.Font.Grow"]=!0);this.la.PIj||(a["PptRibbon.Home.Font.Strikethrough"]=!0);this.la.C7d||(a["PptRibbon.InsertTab.Images.Clipart"]=!0);this.swh(a,!0,!0,!0);
this.rwh(a,!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media.OnlineVideo"]=!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media"]=!0);this.la.N4g||(a["PptRibbon.AudioPlayback"]=!0);this.la.gDb||(a["PptRibbon.AudioFormat"]=!0);if(u.AFrameworkApplication.MAa||!this.la.pptEditInsertAppsForOfficeEnabled||this.la.E9d)a["PptRibbon.InsertTab.AppForOffice"]=!0;this.la.eub||(a["PptRibbon.View.Zoom"]=!0);this.la.jGj||(a["PptRibbon.Home.Paragraph.LineSpacing"]=!0);this.la.eqg||
(a["ContextualTabs.Tables.Layout.Properties"]=!0,a["PptRibbon.PictureFormat.Properties"]=!0,a["PptRibbon.DrawingFormat.Properties"]=!0,a["PptRibbon.SmartArt.Properties"]=!0,a["PptRibbon.AudioFormat.Properties"]=!0);var b=[];this.la.gJa&&(b=this.la.gJa.split(","));for(const c of b){const f=c.trim().substring(0,1).toUpperCase()+c.trim().substring(1,c.length);a["Transition"+f]=!0}Array.contains(b,"Wipe")&&Array.contains(b,"Shape")&&Array.contains(b,"Split")&&Array.contains(b,"RandomBars")&&(a.TransitionMore=
!0);this.la.yFf||(a.AnimationMore=!0);this.la.ZMj?a["PptRibbon.Transition.AllSlides"]=!0:a["PptRibbon.Transition.Timing"]=!0;this.la.powerPointEnableAccCheck||(a["PptRibbon.Review"]=!0);this.la.zg&&(a["PptRibbon.View.PresentationViews"]=!0);this.rne?a["PptRibbon.Home.Clipboard.Paste"]=!0:a["PptRibbon.Home.Clipboard.NewPaste"]=!0;this.la.Xtg?a["PptRibbon.Design.OldThemes"]=!0:a["PptRibbon.Design.Themes"]=!0;a["PptRibbon.View.ShowHide.CommentsSplitButton"]=!0;this.la.pptEditorConsistencyCheckIsEnabled||
(a["PptRibbon.Review.Proofing.EditorPane"]=!0);this.la.proofingSettingIsEnabled||(a["PptRibbon.Review.Proofing.GrammarOptions"]=!0);this.la.pptHideProofingErrorIsEnabled||(a["PptRibbon.Review.Proofing.HideProofingErrors"]=!0);this.la.z9d||(a["PptRibbon.Review.Activity"]=!0);a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?a["PptRibbon.Review.Proofing"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=
!0;(b=u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.CHb&&!u.AFrameworkApplication.MAa)||(a["PptRibbon.Help"]=!0);a.btnContactSupport=!(b&&u.AFrameworkApplication.fa.ka("HelpTabContactSupportIsEnabled"));a.btnShowTraining=!(b&&u.AFrameworkApplication.fa.ka("HelpTabShowTrainingIsEnabled"));a.btnWhatsNew=!(b&&u.AFrameworkApplication.fa.ka("HelpTabWhatsNewIsEnabled"));a.btnFeedbackPane=!0;this.la.E7a&&this.la.a6d&&this.la.a6d.length||(a.InsertIconDialog=!0);a["PptRibbon.View.Subtitles.UseSubtitles"]=
!0;a["PptRibbon.View.Subtitles.SubtitleSettings"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!0;a.AlwaysUseSubtitles=!0;a.UseSubtitles=!0;a["PptRibbon.View.Coach"]=
!0;a["PptRibbon.View.Coach.RehearseWithCoach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!0;a["PptRibbon.View.Coach.Menu.Vision"]=!0;a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!0;a["PptRibbon.View.Coach.Menu"]=!0;a["PptRibbon.View.StartSlideShow.PresentLive"]=!0;a.PresentLive=!0;a.PresentLiveConsumer=!0;a.PresentLiveEnterprise=!0;a.PresentLiveTopBar=!0;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CacheDictateVisibility",
!1)||(a["PptRibbon.Home.Dictation"]=!0,a.btnStartDictation=!0);this.gxb&&(a["PptRibbon.Review.Comments.Markers"]=!0);u.AFrameworkApplication.fa.ka("OcpsIsEnabled")&&(a.TellMeControl=!0);a["PptRibbon.Review.Translate"]=!this.la.C3g;a["PptRibbon.Review.Activity.ShowVersionHistory"]=!this.la.wwk;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"]=!this.la.aHa;a["PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"]=!this.la.aHa;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture"]=!this.la.aHa;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture"]=
!this.la.aHa;a["PptRibbon.PictureFormat.Adjust.ChangePicture"]=this.la.aHa;a.FixIt=!this.la.kJc}S3k(a){if(!u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")||u.AFrameworkApplication.CHb||u.AFrameworkApplication.MAa)a.Help=!0;a.Draw=!this.la.zg}jej(){const a=new Ua.a;if(this.la.gJa){var b=this.la.gJa.split(",");for(const c of b)b=c.trim(),"MenuSection"===b.substring(0,11)&&a.add(new RG("TransitionMore","Transition"+b,!0))}return a.toArray()}s0k(a){a["PptJewel.Menu"]=!0;u.AFrameworkApplication.fa.ka("WheresSaveButtonBrsIsEnabled")||
(a["PptJewel.SaveACopy.WheresTheSaveButton"]=!0);this.la.printingEnabled||(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);a["PptJewel.Print.PrintToPdf"]=!0;this.J0c&&this.J0c.LUg||
(a["PptJewel.About.TryOffice"]=!0);this.d0c&&this.d0c.unh||(a["PptJewel.About.TryMacOffice"]=!0);u.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&u.AFrameworkApplication.$t.nx||(a.lblBreadcrumbDocName=!0);u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.CHb&&(a["PptJewel.Help"]=!0)}eBh(a){delete a["PptJewel.Menu"];const b=u.AFrameworkApplication.fa.Ia(u.AFrameworkApplication.lJ);if(b&&"teams"===b.toLowerCase()){a["PptJewel.Share"]=!0;a["PptJewel.Share.Embed"]=
!0;var c=u.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost");const f=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");c&&f||(a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0)}u.AFrameworkApplication.Lua||(a["PptJewel.New"]=!0);u.AFrameworkApplication.RBe||(a["PptJewel.Open"]=!0);u.AFrameworkApplication.WD||(a["PptJewel.Help.GiveFeedback"]=!0,a.btnFeedback=!0,a.btnFeedbackPane=!0);u.AFrameworkApplication.twh&&
(a["PptJewel.Info.OpenInClient"]=!0,a.btnOpenInClient=!0);u.AFrameworkApplication.LWa||(a["PptJewel.Share.ReplyWithChanges"]=!0);u.AFrameworkApplication.LUd||u.AFrameworkApplication.eTe||(a["PptJewel.Info.FileVersion"]=!0);u.AFrameworkApplication.gvb?(a["PptJewel.Info.FileVersion"]=!0,u.AFrameworkApplication.Pj("Microsoft.Office.PPT.Server.Flighting.PPTOneDriveConsumerSharedVersionHistoryIsEnabled"),Z.ULS.sendTraceTag(587487431,832,15,"PPT external version history menu item for OneDriveConsummer trimmed.")):
u.AFrameworkApplication.sae()?this.la.Tsk?(a["PptJewel.Info.VersionHistory"]=!0,Z.ULS.sendTraceTag(587487428,832,15,"PPT shared version history menu item trimmed for internet explorer.")):u.AFrameworkApplication.fa.ka(ba.a.disableAnonymousUserCheckForBlueChickenForVH)?u.AFrameworkApplication.fa.ka("IsAnonymousUserCheckSupportedForVH")&&u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,Z.ULS.sendTraceTag(587487427,832,15,"PPT shared version history menu item due to anonymous user.")):
u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,Z.ULS.sendTraceTag(587487426,832,15,"PPT shared version history menu item due to anonymous user.")):(a["PptJewel.Info.VersionHistory"]=!0,Z.ULS.sendTraceTag(587487429,832,15,"PPT shared version history menu item trimmed."));a["PptJewel.Info.OpenInClient"]&&a["PptJewel.Info.FileVersion"]&&a["PptJewel.Info.VersionHistory"]&&(a["PptJewel.Info"]=!0);u.AFrameworkApplication.fPa||(a["PptJewel.Share.ShareWithPeople"]=
!0);if(u.AFrameworkApplication.DQ||!u.AFrameworkApplication.cTe&&!u.AFrameworkApplication.gtb&&!u.AFrameworkApplication.AUd)a["PptJewel.Share.Embed"]=!0;a["PptJewel.Share.ShareWithPeople"]&&a["PptJewel.Share.Embed"]&&a["PptJewel.Share.ReplyWithChanges"]&&(a["PptJewel.Share"]=!0);u.AFrameworkApplication.rml&&(a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=
!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);u.AFrameworkApplication.fa.ka("DisablePrint")&&(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=
!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);u.AFrameworkApplication.DQ&&(a["PptJewel.Print"]=!0,a["PptJewel.Share"]=!0);u.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")||(a["PptJewel.SaveACopy.SaveACopy"]=!0);u.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&u.AFrameworkApplication.fa.ka("UserCanWriteRelative")&&u.AFrameworkApplication.fa.ka("SupportsEditing")||(a["PptJewel.SaveACopy.SaveAsToHost"]=!0);u.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&u.AFrameworkApplication.fa.ka("SupportsGetMoreInfoForPersonalStorage")||
(a["PptJewel.SaveACopy.SaveToSharePoint"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&(a["PptJewel.SaveACopy"]=!0);this.la.UIj||(a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0);this.la.bvg&&this.la.zg||(a["PptJewel.DownloadAs.DownloadAsImages"]=!0);if(!u.AFrameworkApplication.fa.ka(ba.a.pa(153))||".odp"===u.AFrameworkApplication.fa.appSettings[ba.a.pa(152)].toLowerCase()||u.AFrameworkApplication.DQ)a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=
!0;u.AFrameworkApplication.fa.ka("RenameDialogIsEnabled")&&u.AFrameworkApplication.e4b()&&!u.AFrameworkApplication.DQ||(a["PptJewel.Rename"]=!0);u.AFrameworkApplication.Uhc||(a["PptJewel.Help.ReportAbuse"]=!0);c=!u.AFrameworkApplication.Q4c||!u.AFrameworkApplication.fa.ka(ba.a.pa(1072));u.AFrameworkApplication.qDb||!c||u.AFrameworkApplication.Jlc||this.J0c&&this.J0c.LUg||this.d0c&&this.d0c.unh||u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About"]=!0);u.AFrameworkApplication.qDb||
(a["PptJewel.About.Privacy"]=!0);a["PptJewel.About.TrustCenter"]=c;u.AFrameworkApplication.Jlc||(a["PptJewel.About.TermsOfUse"]=!0);u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About.DiagnosticsSection"]=!0);u.AFrameworkApplication.Sba||(a["PptJewel.SecondaryMenu"]=!0);c=!u.AFrameworkApplication.fa.ka(ba.a.pa(248));a["PptRibbon.Design.Designer.New"]=c;a["PptRibbon.Design.ShowHide.Designer.New"]=c;a["PptRibbon.Home.Designer"]=c;(a["PptRibbon.Home.ShowHide.Designer"]=
c)&&this.nm&&this.nm.t9(this.nm.z4,this.nm.UQd);c=!u.AFrameworkApplication.fa.ka(ba.a.pa(822));a["PptRibbon.Review.SmartLookup"]=c;a["PptRibbon.Review.Show.SmartLookup"]=c;(c=(a["PptRibbon.Review.ShowHide.SmartLookup"]=c)||!dv.YJj())||Z.ULS.sendTraceTag(587487425,1303,15,"ReuseSlides is not trimmed");a["PptRibbon.Home.Slides.InvokeFilesSerplet"]=c;a["PptRibbon.InsertTab.InvokeFilesSerplet"]=c;Z.ULS.sendTraceTag(556877219,352,50,"IsInsertOnlinePictureFromHostSupported: {0}; InsertOnlinePictureFromHostEnabled: {1}; HostSupportsInsertOnlinePictureFromHost: {2}; IsSkyDrive: {3}; AppSupportsInsertOnlinePictureFromHost: {4}; AppSupportsInsertOnlinePictureFromSharePoint: {5}",
u.AFrameworkApplication.A3b(),u.AFrameworkApplication.insertOnlinePictureFromHostEnabled,u.AFrameworkApplication.pPc,u.AFrameworkApplication.gvb,u.AFrameworkApplication.tAc,u.AFrameworkApplication.uAc);u.AFrameworkApplication.fa.ka(ba.a.pa(671))&&this.swh(a,this.la.pptInsertOnlinePictureEnabled,u.AFrameworkApplication.A3b(),this.la.E7a);this.rwh(a,this.la.sQc);u.AFrameworkApplication.fa.ka(ba.a.pa(670))&&(c=!u.AFrameworkApplication.fa.ka(ba.a.pa(124)),a["PptRibbon.InsertTab.Media.OnlineVideo"]=c,
a["PptRibbon.InsertTab.Media"]=!!c);a["PptRibbon.Review.Proofing.EditorPane"]=!u.AFrameworkApplication.fa.ka(ba.a.pa(809));a["PptRibbon.Review.Proofing.GrammarOptions"]=!u.AFrameworkApplication.fa.ka(ba.a.pa(299));a["PptRibbon.Review.Proofing.HideProofingErrors"]=!u.AFrameworkApplication.fa.ka(ba.a.pa(619));a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?(a["PptRibbon.Review.Proofing"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=
!0):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!1):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!1);c=u.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");this.la.cja&&c&&(a["PptRibbon.View.Subtitles.UseSubtitles"]=!1,qd.a("ReactMLRSubtitleSettingsTeamsFix")||(a["PptRibbon.View.Subtitles.SubtitleSettings"]=
!1),a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!1);this.la.O4b&&this.la.qvg&&(a["PptRibbon.View.Coach"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!1,
this.la.pptRehearsalVisionEnabled||this.la.hDb?(a["PptRibbon.View.Coach.Menu"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!1,this.la.pptRehearsalVisionEnabled&&(a["PptRibbon.View.Coach.Menu.Vision"]=!1),this.la.hDb&&(a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!1)):a["PptRibbon.View.Coach.RehearseWithCoach"]=!1);this.la.XMj&&this.la.cja&&c&&(!b||"teams"!==b.toLowerCase())&&(a.AlwaysUseSubtitles=!1,a.UseSubtitles=!1,qd.a("ReactMLRSubtitleSettingsTeamsFix")&&(a["PptRibbon.View.Subtitles.SubtitleSettings"]=
!1));this.la.powerPointLiveBroadcastEnabled&&(a["PptRibbon.View.StartSlideShow.PresentLive"]=!1,a.PresentLive=!1,a.PresentLiveTopBar=!1);u.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&u.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&u.AFrameworkApplication.fa.ka("SupportsPolicies")||(a["PptRibbon.Home.Sensitivity"]=!0,a.flySensitivity=!0,this.nm&&this.nm.t9(this.nm.z4,this.nm.mih));
this.la.dictationIsEnabled&&r.a.Hsh&&u.AFrameworkApplication.fa.ka("UserCanUseDictation")?(a["PptRibbon.Home.Dictation"]=!1,a.btnStartDictation=!1):this.nm&&this.nm.t9(this.nm.z4,this.nm.yVf);a["PptJewel.Open"]&&a["PptJewel.New"]&&(a["PptJewel.Home"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&a["PptJewel.Rename"]&&a["PptJewel.DownloadAs.DownloadACopy"]&&a["PptJewel.DownloadAs.DownloadACopyAsPdf"]&&a["PptJewel.DownloadAs.DownloadACopyAsOdp"]&&
a["PptJewel.DownloadAs.DownloadAsImages"]?a["PptJewel.SaveACopy"]=!0:a["PptJewel.SaveACopy"]&&delete a["PptJewel.SaveACopy"];a["PptRibbon.Review.Translate"]=!this.la.C3g;a.FixIt=!this.la.kJc;u.AFrameworkApplication.fa.Fu("IsPresentToTeamsSupportedHost")&&!u.AFrameworkApplication.fa.ka("IsPresentToTeamsSupportedHost")?(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0):b&&"sharepointcom"!==b&&(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0);u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a.CatchUpWithChanges=
!0);tp.tul(dv.Aqj,a)}swh(a,b,c,f){a["PptRibbon.InsertTab.Images.FlyPicture"]=!1;a["PptRibbon.InsertTab.Images.FlyPicture.FromHost"]=!c;a["PptRibbon.InsertTab.Images.FlyPicture.FromSearch"]=!b;a["PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromDevice"]=!1;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromHost"]=!c;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromSearch"]=!b;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Picture"]=
!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Icon"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost"]=!c;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost"]=
!c;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"]=!f}rwh(a,b){a.InsertPictureFromMobileDevice=!b;a.ChangePictureFromMobileDevice=!b}static YJj(){const a=u.AFrameworkApplication.fa.Ia("SovereignEnvironmentName"),b=u.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");var c=u.AFrameworkApplication.fa.Ia(u.AFrameworkApplication.lJ);c=
!!c&&"teams"===c.toLowerCase();return(!a||!a.length)&&b&&!c}}dv.Aqj={["ellipsisOpenInApp"]:(AB=new Ua.a,AB.add("HostOpenInClient"),AB),["ellipsisOpenInBrowser"]:(zB=new Ua.a,zB.add("HostOpenInBrowser"),zB),["ellipsisDownload"]:(yB=new Ua.a,yB.add("HostDownload"),yB),["conversation"]:(xB=new Ua.a,xB.add("HostConversation"),xB),["close"]:(Ww=new Ua.a,Ww.add("HostClose"),Ww.add("btnjClose"),Ww.add("msJewelSecondary"),Ww),["copyLink"]:(wB=new Ua.a,wB.add("CopyLink"),wB),["share"]:(Ry=new Ua.a,Ry.add("jbtnFileSharing"),
Ry.add("btnFileSharing"),Ry),["docChat"]:(vB=new Ua.a,vB.add("DocChat"),vB),["openInApp"]:(uB=new Ua.a,uB.add("btnOpenInClient"),uB)};Object(e.a)(dv,"RibbonCommandTrimmer",null,[593]);class BB{constructor(){this.gFa=this.ql=this.K=null}get name(){return"PowerPointWebEditor.Ribbon"}Yb(a){this.K=a;a.register(YA,"PowerPointWebEditor.Ribbon.PPTWebEditReactCommandDefinitionMapping").as("Common.IExternalUICommandDefinitionMapping").ma().na(()=>new YA(a.resolve("PowerPointWebEditor.IApplicationSettings")));
a.register(542,"PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").ma().na(()=>new ZF(new VA(u.AFrameworkApplication.fa)));let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").Iub;r.a.Gj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").rwa);var c=this.K.resolve("PowerPointWebEditor.IFileInfo").Oaa;let f=2===c||3===c||0===c;c=1===c;const l=a.resolve("PowerPointWebEditor.IApplicationSettings").Feb?a.resolve("PowerPointWebEditor.IPPTRumTracker"):null;f=f&&
!c;a.register(dv,"PowerPointWebEditor.Ribbon.RibbonCommandTrimmer").ma().na(()=>new dv(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IOfficeTrialExperience"),a.resolve("Common.IMacOfficeOffer"),b,f,l));a.register(543,"PowerPointWebEditor.IModeSwitcherControlActor").ma().na(()=>new SF(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
a.resolve("Box4.IAppFrame"),Oc.a.get_instance(),l));a.register(544,"PowerPointWebEditor.IRibbonUser").ma().na(()=>{const w=a.resolve("PowerPointWebEditor.IApplicationSettings"),F=a.resolve("PowerPointWebEditor.Ribbon.RibbonCommandTrimmer");var S={};F.ngd(S);var fa={};F.S3k(fa);S=new OF(S,F.jej(),fa);fa=new RF;const xa=a.resolve("Common.IAppSettingsManager"),Za=new PG(a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("PowerPointWebEditor.IRibbonPane").za,a.resolve("PowerPoint.IPathManager"),a.Oa("Box4.IGeneralCuiUser"),
a.resolve("Common.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.qb("PowerPointWebEditor.Core.IBundleMetricRecorder"),F,S,w,a.resolve("PowerPointWebEditor.IModeSwitcherControlActor"),fa,l,xa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InvokeFullAppSettingsCallbackImmediately",!1),Object(Ca.a)(106,xa)?xa:null,xa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1),u.AFrameworkApplication.LCb,
a.resolve("PowerPointWebEditor.IPresentationResourcesManager"));w.nUf?this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Mtb(()=>{Za.slg()}):Za.slg();return Za});a.register(545,"Common.IRibbonExternal").ma().na(()=>{const w=a.resolve("PowerPointWebEditor.IRibbonUser");a.resolve("PowerPointWebEditor.IApplicationSettings");return w.WSk});a.register(546,"PowerPointWebEditor.IRibbonChangeManager").ma().na(()=>new QG(a.resolve("Common.ITaskManager"),a.resolve("Box4.Graph.IGraphInstance").Cd(10),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(XA,"PowerPointWebEditor.BusinessBarController").as("PowerPointWebEditor.IBusinessBarController").as("Box4.IBusinessBarController").ma().na(()=>new XA(a.resolve("CommonUI.IBusinessBar"),new PF,a.resolve("PowerPointWebEditor.AppFrame"),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IErrorMapping"),u.AFrameworkApplication.fa,a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(547,"PowerPointWebEditor.IBusinessBarPane").ma().na(()=>new UF(a.Oa("CommonUI.IBusinessBar"),a.resolve("PowerPointWebEditor.IApplicationSettings").zWa,a.resolve("PowerPointWebEditor.IApplicationSettings").Vgc,a.resolve("PowerPointWebEditor.IApplicationSettings").ZDb));a.register(nq,
"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ma().na(()=>new nq(a.resolve("PowerPointWebEditor.IBusinessBarPane").Kyl));a.register(548,"Common.IRibbonSQMInformation").ma().na(()=>{const w=new $F(u.AFrameworkApplication.Va);w.LJk();return w});a.register(549,"PowerPointWebEditor.IInkRibbonManager").ma().na(()=>new oq(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),u.AFrameworkApplication.Ba.jb.J7))}init(){this.gFa=
this.K.resolve("PowerPointWebEditor.IModeSwitcherControlActor");this.K.resolve("PowerPointWebEditor.BusinessBarController").jsk();this.ql=this.K.resolve("PowerPointWebEditor.IBusinessBarController");this.ql.initialize();u.AFrameworkApplication.fa.ka("EarlyInitRibbonUser")?(this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("Common.IRibbonExternal")):this.K.Oa("PowerPointWebEditor.IRibbonUser").execute(()=>{this.K.resolve("Common.IRibbonExternal")});const a=this.K.resolve("PowerPointWebEditor.IBusinessBarPane"),
b=this.K.resolve("PowerPointWebEditor.IPaneManager");var c=document.getElementById("WACDocumentAndTaskPanel");this.K.resolve("PowerPointWebEditor.IApplicationSettings").ZDb?(c=document.getElementById("BusinessBarRegion"),b.EMa(a,c,null)):this.K.resolve("PowerPointWebEditor.IApplicationSettings").zWa&&c?b.EMa(a,this.K.resolve("PowerPointWebEditor.AppFrame").F0,c):b.wM(a);this.K.resolve("CommonUI.IBusinessBar");this.K.resolve("PowerPointWebEditor.IInkRibbonManager")}dispose(){this.ql&&this.ql.dispose();
this.gFa&&this.gFa.dispose()}static main(){m.a.instance.Ec(new BB)}}Object(e.a)(BB,"PPTWebEditorRibbonPackage",null,[2,3]);var Xw=d(658);class SG{get name(){return"Box4.Insights"}init(){}dispose(){}Yb(a){a.register(Xw.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().na(()=>new Xw.a)}}Object(e.a)(SG,"Box4InsightsPackage",null,[2,3]);class CB{constructor(a,b){this.Lxd=0;this.Tfa=new Ua.a;this.Da=a;this.ld=b}get Uc(){return this.ld}get R4d(){return 0<
this.Lxd}w9(a){this.Ztg(a)&&this.Lxd++;this.R4d?this.Uc.enabled=!1:this.Tfa.add(this.Uc.zp(a.actionId))}u9(a){!this.R4d&&0<this.Tfa.count&&(this.Tfa.ga(this.Tfa.count-1),this.MYf(this.Tfa.count-1));this.Ztg(a)&&this.Lxd--;this.R4d||(this.Uc.enabled=!0)}MYf(a){if(0<this.Tfa.count&&0<=a&&a<this.Tfa.count){const b=this.Tfa.ga(a);this.Tfa.removeAt(a);b.end()}}tmi(){let a=this.Tfa.count-1;for(;0<=a;){var b=this.Tfa.ga(a);(b=this.Da.eS(b.activityName))&&b.flags[128]&&this.MYf(a);a--}}Ztg(a){if(2!==a.behavior)return!0;
a=this.Da.eS(a.actionId);return!!a&&a.flags[32]}}Object(e.a)(CB,"ActivityActionListener",null,[146]);var Sy;(function(a){a[a.timeOut=0]="timeOut";a[a.appClose=1]="appClose";a[a.appError=2]="appError"})(Sy||(Sy={}));Object(e.b)("ActivityAutoEndReason",Sy);class DB{constructor(a){this.mga=new Al.a;this.ZJb=a}l$h(){for(let a of this.mga.keys)this.m$h(a)}W3f(a){if(this.ZJb.TAc)for(let b of this.mga.keys){const c=Array.clone(this.mga.ga(b));for(let f=0;f<c.length;f++){const l=c[f];l.aWd();this.c$g(b,a,
l.uniqueID)}}}m$h(a){var b=this.mga.ga(a);b=this.J4i(b);for(let c=0;c<b.length;c++){const f=b[c];f.aWd();this.c$g(a,0,f.uniqueID)}}J4i(a){const b=[];for(let c=0;c<a.length;c++){const f=a[c];(new Date).getTime()-f.startTime>f.gRg&&Array.add(b,f)}return b}c$g(a,b,c){const f={};f.AID=c;f.A=a;f.AE=Sy[b];cd.a.instance.Vb("AutoEnded",f)}I4k(){if(this.ZJb.TAc){var a=new Se.a(2,2,this.ZJb.n$h,Object(C.a)(this,this.l$h,"autoEndLongRunningActivities"),67);u.AFrameworkApplication.ve.Hb(a)}}register(a){if(this.ZJb.TAc){var b=
a.activityName;this.mga.Kb(b)&&this.mga.ga(b)||this.mga.$(b,[]);Array.add(this.mga.ga(b),a)}}unregister(a){if(this.ZJb.TAc){var b=a.activityName;this.mga.Kb(b)&&this.mga.ga(b)&&Array.remove(this.mga.ga(b),a)}}}Object(e.a)(DB,"ActivityAutoEndHelper",null,[727]);class Mt{constructor(a){this.aVe=null;this.Htc=0;this.Ard=this.NF=!1;this.ZDd=0;this.jx=new Bc.a;this.drb=new Bc.a;this.pFh=a}get dFd(){return this.aVe||(this.aVe=this.pFh())}get properties(){return this.jx}get gRg(){return this.Htc}get enabled(){return this.NF}get ended(){return this.Ard}get uniqueID(){return this.ZDd}CQg(){const a=
{};a.ID=this.uniqueID;a.A=this.activityName;a.ST=this.startTime;a.ET=this.endTime;Ya.Ct(this.properties.keys)&&(a.P=Mt.Dbg(this.properties));Ya.Ct(this.drb.keys)&&(a.FP=Mt.Dbg(this.drb));return a}static Dbg(a){const b={};for(let c of a)b[c.key]=c.value;return b}}Object(e.a)(Mt,"AActivity",null,[752,682]);class EB extends Mt{constructor(a,b,c,f,l,w,F,S){super(F);this.Us=0;this.rFh=a;this.LJh=b;this.Zea=c;this.Bj=(new Date).getTime();this.mPh=f;this.Jnd=w;this.Htc=l;this.Jnd.register(this);this.ZDd=
S()}get activityName(){return this.Zea}get startTime(){return this.Bj}get endTime(){return this.Us}VYf(a){this.Us=(new Date).getTime();this.ended?this.qGk():(this.Ard=!0,this.Us=(new Date).getTime(),this.Us<this.Bj&&(Z.ULS.sendTraceTag(8184544,213,50,String.format("EndTime ({0}) is less than StartTime ({1}) for Activity ({2}).",this.Us,this.Bj,this.Zea)),this.Us=this.Bj),this.Jnd.unregister(this),this.mPh&&(!a&&this.dFd&&this.dFd.enabled?this.Cmb():this.mVb()))}end(){this.VYf(!1)}aWd(){this.VYf(!0)}qGk(){const a=
{};a.AN=this.activityName;a.AT=(new Date).getTime();a.AID=this.uniqueID;this.LJh("AlreadyEnded",this.endTime,a)}Cmb(){this.dFd.Cmb()}mVb(){this.rFh(this.CQg())}cancel(){this.ended||(this.Ard=!0,this.Jnd.unregister(this))}}Object(e.a)(EB,"ActivityImpl",Mt,[]);class TG extends Sys.EventArgs{constructor(){super();this.name=this.properties=null}}Object(e.a)(TG,"ActivityRecordedEventArgs",Sys.EventArgs,[]);class Nt{constructor(a,b,c){this.Ta=new sd.a;this.NF=!0;this.settings=a;this.Knd=b;this.Ond=c}get enabled(){return this.NF&&
this.settings.enabled}set enabled(a){this.NF=a}zp(a,b=-1){-1===b&&(b=this.settings.ZBi);return this.Knd(Object(C.a)(this,this.mVb,"completeActivity"),Object(C.a)(this,this.d$g,"recordEventInternal"),a,this.uzj(a.toString()),b)}Vb(a,b=null){this.d$g(a,(new Date).getTime(),b);this.Ta.raiseEvent("HHR",Object.assign(new TG,{name:a,properties:b}))}d$g(a,b,c){this.Xrg(a)&&(a=this.wcg(a,c,b),Z.ULS.sendTraceTag(6068304,213,100,a))}recordError(a,b=null){this.Xrg(a.toString())&&(a=this.wcg(a.toString(),b,(new Date).getTime()),
Z.ULS.sendTraceTag(6415520,213,100,a))}uzj(a){return this.enabled&&!this.vzj(a)}Xrg(a){return this.enabled&&!this.ADj(a)}vzj(a){return this.settings.$Ei.contains(a)}ADj(a){return this.settings.aFi.contains(a)}mVb(a){if(this.Ond.wKf(a.A.toString())){var b=[];Array.add(b,a);a=md.c(b);Z.ULS.sendTraceTag(5894867,213,100,a)}}wcg(a,b,c){const f={};f.ID=Nt.HWd();f.V=a;f.VT=c;b&&(f.P=b);a=[];Array.add(a,f);return md.c(a)}static HWd(){return Nt.hWh++}}Nt.hWh=0;Object(e.a)(Nt,"ActivityManagerImpl",null,[632]);
class Xo{constructor(){this.NF=!1;this.QYe=this.UVe=0;this.TVe=!1;this.x_e=new an.a;this.y_e=new an.a}yYb(a){this.NF=Boolean.parse(a[Xo.uDj]||"false");this.x_e=this.g2g(a[Xo.ZEi]);this.y_e=this.g2g(a[Xo.bFi]);this.yMi(a)}get enabled(){return this.NF}get $Ei(){return this.x_e}get aFi(){return this.y_e}yMi(a){this.TVe=Boolean.parse(a[Xo.qAj]||"false");this.UVe=parseInt(a[Xo.o$h]||"60000");this.QYe=parseInt(a[Xo.$Bi]||"5000")}get n$h(){return this.UVe}get ZBi(){return this.QYe}get TAc(){return this.TVe}g2g(a){const b=
new an.a;for(const c of(a||"").split(","))""!==c&&b.add(c);return b}}Xo.uDj="ActivityLoggingIsEnabled";Xo.ZEi="DisabledClientActivityNames";Xo.bFi="DisabledClientActivityEventNames";Xo.qAj="ActivityAutoEndEnabled";Xo.o$h="ActivityAutoEndTaskInterval";Xo.$Bi="ActivityDefaultMaxDuration";Object(e.a)(Xo,"ActivitySettings",null,[638]);class ev{constructor(a){this.Wqd=new an.a;this.gQb=new Bc.a;this.Dxc=a;this.J4k()}J4k(){this.Dxc.enabled&&(ev.Gwf=new Se.a(2,2,this.Dxc.interval,Object(C.a)(this,this.oGi,
"doThrottle"),65),u.AFrameworkApplication.ve.Hb(ev.Gwf))}oGi(){this.nRk()}nRk(){this.gQb=new Bc.a;this.Wqd=new an.a}wzj(a){return this.Wqd.contains(a)}Hml(a){if(this.gQb.Kb(a)){if(this.gQb.ga(a)>=this.Dxc.T9j)return this.Wqd.add(a),Z.ULS.sendTraceTag(7696902,213,50,"Activity {0} will be throttled due to too much logging.",a),!1;let b;(b=this.gQb).$(a,b.ga(a)+1)}else this.gQb.add(a,1);return!0}wKf(a){return this.Dxc.enabled?!this.wzj(a)&&this.Hml(a):!0}}ev.Gwf=null;Object(e.a)(ev,"ActivityThrottler",
null,[637]);class Mr{constructor(){this.NF=!1;this.w5e=this.Tcf=0}yYb(a){this.NF=Boolean.parse(a[Mr.KSd]||"false");this.Tcf=parseInt(a[Mr.U9j]||"600");this.w5e=parseInt(a[Mr.lyj]||"600000")}get enabled(){return this.NF}get T9j(){return this.Tcf}get interval(){return this.w5e}}Mr.KSd="ActivityThrottlerEnabled";Mr.U9j="ActivityThrottlerMaxActivities";Mr.lyj="ActivityThrottlerInterval";Object(e.a)(Mr,"ActivityThrottlerSettings",null,[636]);class FB{constructor(){this.Ea=null}get name(){return"Common.App.Activities"}init(){this.Iuj()}Iuj(){const a=
this.Ea.resolve("Common.App.Activities.IActivitySettings"),b=u.AFrameworkApplication.fa.appSettings;a.yYb(b);this.Ea.resolve("Common.App.Activities.IActivityThrottlerSettings").yYb(b);if(a.enabled){cd.a.instance=new Nt(this.Ea.resolve("Common.App.Activities.IActivitySettings"),(l,w,F,S,fa)=>new EB(l,w,F,S,fa,this.Ea.resolve("Common.App.Activities.IActivityAutoEndHelper"),()=>this.Ea.qb("Common.App.Activities.IActivityAggregationManager"),Nt.HWd),this.Ea.resolve("Common.App.Activities.IActivityThrottler"));
var c=this.Ea.resolve("Common.App.Activities.ActivityAutoEndHelper"),f=this.Ea.resolve("Common.App.Activities.ActivityActionListener");c.I4k();u.AFrameworkApplication.Aea(()=>{f.tmi();c.W3f(1)});u.AFrameworkApplication.Va.bma(f);u.AFrameworkApplication.uzc((l,w)=>{cd.a.instance.recordError(w.errorCode,{["ErrorCause"]:w.uTd,["ErrorResolution"]:w.vTd});c.W3f(2)})}}dispose(){}Yb(a){this.Ea=a;a.register(Xo,"Common.App.Activities.ActivitySettings").as("Common.App.Activities.IActivitySettings").ma();a.register(DB,
"Common.App.Activities.ActivityAutoEndHelper").as("Common.App.Activities.IActivityAutoEndHelper").ma().na(()=>new DB(a.resolve("Common.App.Activities.IActivitySettings")));a.register(CB,"Common.App.Activities.ActivityActionListener").na(()=>new CB(u.AFrameworkApplication.Va,a.resolve("Common.IActivityManager")));a.register(Mr,"Common.App.Activities.ActivityThrottlerSettings").as("Common.App.Activities.IActivityThrottlerSettings").ma().na(()=>new Mr);a.register(ev,"Common.App.Activities.ActivityThrottler").as("Common.App.Activities.IActivityThrottler").ma().na(()=>
new ev(a.resolve("Common.App.Activities.IActivityThrottlerSettings")))}static main(){m.a.instance.Ec(new FB)}}Object(e.a)(FB,"ActivitiesPackage",null,[2,3]);class UG{constructor(){this.yna=new Bc.a}qHe(a,b){this.yna.$(a,b)}PWd(a){({value:a}=this.yna.Nf(a));return a}}Object(e.a)(UG,"AggregationMethodsForActivityName",null,[]);class GB{constructor(){this.mvc=new Al.a;this.yna=new Al.a}qHe(a,b,c){this.yna.Kb(a)&&this.yna.ga(a)||this.yna.$(a,new UG);this.yna.ga(a).qHe(b,c)}PWd(a,b){return this.yna.Kb(a)&&
this.yna.ga(a)?this.yna.ga(a).PWd(b):null}I_b(a){this.mvc.Kb(a)&&this.mvc.ga(a)||this.mvc.$(a,new an.a);return this.mvc.ga(a)}zBi(a,b){this.I_b(a).add(b)}}Object(e.a)(GB,"ActivityAggregationInfo",null,[732]);class Yw extends Mt{constructor(a,b){super(a);this.ZDd=(this.qFh=b)?b.w1i():Nt.HWd()}get rga(){return this.qFh}get activityName(){return this.rga.name}get startTime(){return this.rga.startTime}get endTime(){return this.rga.endTime}end(){}cancel(){}aWd(){}Jrl(){this.drb.$("AM",this.rga.mode.toString());
this.drb.$("C",this.rga.count.toString());this.drb.$("DA",this.rga.DXf.toFixed(2));this.drb.$("DV",this.rga.xHi.toFixed(2))}K_d(a){return this.rga.K_d(a)}k0d(){return this.rga.k0d()}Cmb(){for(let a of this.rga.sga)a.Cmb()}}Object(e.a)(Yw,"AggregatedActivity",Mt,[]);class VG{constructor(a,b){this.cod=0;this.Zea=a;this.Dxa=b}l6h(a,b){this.cod=b;for(b=0;b<a.count;b++){const c=a.ga(b);this.m6h(c)}}m6h(a){const b=Object(ua.a)(Yw,a);if(b)if(1===this.cod)this.i6h(b);else if(2===this.cod){this.n6h(b);for(let c of this.Dxa.I_b(this.Zea)){const f=
b.rga.sga.ga(0);f.properties.Kb(c)&&a.properties.$(c,f.properties.ga(c))}}}i6h(a){for(let b of this.Dxa.I_b(this.Zea))this.Efh(a,b)}n6h(a){for(let b of a.k0d())this.Efh(a,b)}Efh(a,b){const c=this.Dxa.PWd(this.Zea,b);if(c){const f=a.K_d(b);a.properties.$(b,c(f))}}}Object(e.a)(VG,"PropertyAggregationHelper",null,[]);class HB{constructor(a,b,c,f,l){this.dib=a;this.Dxa=b;this.eYe=l;this.Ond=f;this.RNh=c}get Fzf(){return this.RNh.value}mVb(a){if(Object(Ca.a)(EB,a))a.mVb();else if(Object(Ca.a)(Yw,a)&&this.Ond.wKf(a.activityName.toString())){a=
Object(ua.a)(Yw,a);a.Jrl();a=a.CQg();var b=[];Array.add(b,a);a=md.c(b);Z.ULS.sendTraceTag(6907266,213,50,a)}}JSb(a,b){const c=(new Date).getTime();var f=this.eYe.list.ga(a);const l=({o6h:f}=this.FVi(f)).returnValue;this.eYe.list.$(a,new Ua.a);b&&(f=this.Bti(f,c,this.dib.Afg));0<f.count&&(new VG(a,this.Dxa)).l6h(f,l)}Bti(a,b,c){const f=new Ua.a;for(let l=0;l<a.count;l++){const w=a.ga(l);w.startTime>b-c?w.Cmb():f.add(w)}return f}FVi(a){const b=this.Fzf.bvh(a);a=this.Fzf.Bjl(a);const c=this.p6h(b,a);
return{returnValue:c,o6h:1===c?b:a}}p6h(a,b){return a.count*this.dib.nSg<b.count?1:2}get enabled(){return this.dib.enabled}Cmb(){}}Object(e.a)(HB,"ActivityAggregationManager",null,[731]);class Ho{constructor(a){this.enabled=!1;this.nRg=500;this.TRg=2;this.mjd=6E4;this.nSg=5;this.Afg=3E4;this.yYb(a.appSettings)}yYb(a){this.enabled=Boolean.parse(a[Ho.KSd]||"false");this.nRg=parseInt(a[Ho.i$j]||"500");this.TRg=parseInt(a[Ho.vak]||"2");this.mjd=parseInt(a[Ho.Ohl]||"60000");this.nSg=parseInt(a[Ho.Kak]||
"5");this.Afg=parseInt(a[Ho.Jgj]||"30000")}}Ho.KSd="ActivityAggregationEnabled";Ho.i$j="ActivityAggregationMaxInterval";Ho.vak="ActivityAggregationMinChain";Ho.Ohl="ActivityAggregationTaskInterval";Ho.Kak="ActivityAggregationModeFactor";Ho.Jgj="ActivityAggregationGraceWindow";Object(e.a)(Ho,"ActivityAggregationParams",null,[]);class IB{constructor(a,b){this.Dxa=a;this.bVe=b}bvh(a,b=1){if(!a||!a.count)return a;const c=new Ua.a;var f=null;for(let l=0;l<a.count;l++){const w=a.ga(l);if(!w)continue;const F=
w.activityName;f?f.fOj(w)?f.add(w):(f=f.process(),c.addRange(f),f=this.bVe(F,b),f.add(w)):(f=this.bVe(F,b),f.add(w))}f&&(a=f.process(),c.addRange(a));return c}Bjl(a){if(!a||!a.count)return a;const b={};var c=null;for(let l=0;l<a.count;l++){const w=a.ga(l);if(w){if(!c){c=new Ua.a;var f=this.Dxa.I_b(w.activityName);for(let F of f)c.add(F)}f=this.u8i(w,c);null!==f&&(f in b&&b[f]||(b[f]=new Ua.a),b[f].add(w))}}a=new Ua.a;for(const l of va.a.pK(b))c=this.bvh(b[l],2),a.addRange(c);return a}u8i(a,b){let c=
"";for(let f of b)c+=f,c=a.properties.Kb(f)&&void 0!==a.properties.ga(f)&&null!==a.properties.ga(f)?c+a.properties.ga(f):c+"null";return c}}Object(e.a)(IB,"ActivityAggregationSchemes",null,[729]);class WG{constructor(a,b,c,f,l){this.Us=this.Bj=0;this.dib=c;this.Knd=f;this.Dxa=l;this.name=a;this.Zx=b;this.sga=new Ua.a}get mode(){return this.Zx}get count(){return this.sga.count}get startTime(){return this.Bj}get endTime(){return this.Us}get DXf(){if(!this.count)return 0;let a=0;for(let b of this.sga)a+=
b.endTime-b.startTime;return a/this.count}get xHi(){if(!this.count)return 0;let a=0;const b=this.DXf;for(let c of this.sga){const f=c.endTime-c.startTime;a+=(f-b)*(f-b)}return a/this.count}add(a){this.count?this.Us=a.endTime>this.endTime?a.endTime:this.endTime:(this.Bj=a.startTime,this.Us=a.endTime);this.sga.add(a)}fOj(a){return 0>=this.count?!1:a.startTime-this.endTime<=this.dib.nRg}process(){if(this.count>=this.dib.TRg){const a=new Ua.a,b=this.Knd(this);a.add(b);return a}return this.sga}K_d(a){const b=
new Ua.a;for(let c of this.sga)if(c.properties.Kb(a)){const f=c.properties.ga(a);b.add(f)}else b.add(null);return b}k0d(){const a=this.Dxa.I_b(this.name),b=new an.a;for(let c of this.MVi())a.contains(c)||b.add(c);return b}MVi(){const a=new an.a;if(!this.sga)return a;for(let b of this.sga)for(let c of b.properties.keys)a.add(c);return a}w1i(){return this.sga.ga(0).uniqueID}}Object(e.a)(WG,"ActivityCollection",null,[730]);class JB{constructor(){this.XZa=new Al.a}get list(){return this.XZa}add(a){const b=
a.activityName;if(this.XZa.Kb(b)&&this.XZa.ga(b)){const c=this.Q2i(this.XZa.ga(b),a);this.XZa.ga(b).insert(c,a)}else this.XZa.$(b,new Ua.a),this.XZa.ga(b).add(a)}Q2i(a,b){for(let c=a.count-1;0<=c;c--)if(b.startTime>a.ga(c).startTime)return c+1;return 0}}Object(e.a)(JB,"CompletedActivitiesHelper",null,[728]);class KB{constructor(){this.Ea=null}get name(){return"Common.App.ActivityAggregator"}init(){u.AFrameworkApplication.Aea(()=>{this.Ea.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}Yb(a){this.Ea=
a;const b=f=>new Yw(()=>a.qb("Common.App.Activities.IActivityAggregationManager"),f),c=(f,l)=>new WG(f,l,a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b,a.resolve("Common.IActivityAggregationInfo"));a.register(HB,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ma().na(()=>new HB(a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),a.resolve("Common.IActivityAggregationInfo"),a.qe("Common.App.ActivityAggregator.IActivityAggregationSchemes"),
a.resolve("Common.App.Activities.IActivityThrottler"),a.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));a.register(Ho,"Common.App.ActivityAggregator.ActivityAggregationParams").ma().na(()=>new Ho(u.AFrameworkApplication.fa));a.register(GB,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ma().na(()=>new GB);a.register(IB,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ma().na(()=>
new IB(a.resolve("Common.IActivityAggregationInfo"),c));a.register(JB,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ma().na(()=>new JB)}static main(){m.a.instance.Ec(new KB)}}Object(e.a)(KB,"ActivityAggregatorPackage",null,[2,3]);var XG=d(15);class Tq{constructor(){this.gTk="getAddinShortcutsPreference";this.hTk="saveAddinShortcutsPreference";this.iTk="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.yVi=6E4;this.D5c=this.F6=this.yX=null}Zbg(a){return String.format(this.iTk,u.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||
"",a,u.AFrameworkApplication.$g)}executeRequest(a,b,c,f,l=null){return Tq.Laa.umb(a,b,l,null,2,c,f,!1,null,this.yVi)}saveSetting(a,b,c,f,l){return this.Ggh(a,b,c,null,f,l)}startBatchUpdateScope(){this.D5c=[]}saveShortcutInfoArrayBatch(a,b,c){this.$Uk(c,a,b)}$Uk(a,b,c){const f={action:"",addinId:"",ownerType:0};f.timestamp=(new Date).toUTCString();const l=this.getShortcutInfoArray(b.toString(),c.toString());a?(f.shortcutInfoArray=a,this.rFd(b,c,a)):l&&(f.shortcutInfoArray=l);a={};a[b.toString()]=f;
b=new XG.a(c.toString(),a);this.D5c.push(b)}commitBatchUpdateScope(){return this.okc()?this.bVk().then(()=>{this.Rnb();return Promise.resolve(!0)}):this.dVk().then(()=>{this.Rnb();return Promise.resolve(!0)})}bVk(){return this.getSetting().then(a=>{let b=null;if(a&&!({Ev:b}=md.d(a)).returnValue)return Z.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);b||(b={});for(const c of this.D5c){(a=b[c.key])||(a={});const f=
c.value;for(const l of va.a.pK(f))a[l]=f[l];b[c.key]=a}this.yX=b;try{return localStorage.setItem("AddinShortcutPreferenceData",md.c(b)),Promise.resolve(!0)}catch(c){return Z.ULS.sendTraceTag(522739853,0,10,"SaveSettingToLocalStorageBatch failed",c),Promise.resolve(!1)}})}dVk(){return this.gYk().then(a=>this.ned(a))}gYk(){return this.p0d().then(a=>{let b=null;a&&(({Ev:b}=md.d(a)).returnValue||Z.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));
b||(b={});for(const c of this.D5c){(a=b[c.key])||(a={});const f=c.value;for(const l of va.a.pK(f))a[l]=f[l];b[c.key]=a}this.yX=b;return md.c(b)})}saveShortcutInfoArray(a,b,c){return this.Ggh(0,"","",c,a,b)}Ggh(a,b,c,f,l,w){const F=this.okc(),S={};S.action=c;S.addinId=b;S.ownerType=a;S.timestamp=(new Date).toUTCString();b=this.getShortcutInfoArray(l.toString(),w.toString());0===a&&f?(S.shortcutInfoArray=f,this.rFd(l,w,f)):b&&(S.shortcutInfoArray=b);a={};a[l.toString()]=S;l=new XG.a(w.toString(),a);
return F?this.aVk(l):this.cVk(l)}aVk(a){return this.getSetting().then(b=>{let c=null;if(b&&!({Ev:c}=md.d(b)).returnValue)return Z.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);c||(c={});c[a.key]=a.value;this.yX=c;try{return localStorage.setItem("AddinShortcutPreferenceData",md.c(c)),Promise.resolve(!0)}catch(f){return Z.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",f),Promise.resolve(!1)}})}cVk(a){return this.fYk(a).then(b=>
this.ned(b))}fYk(a){return this.p0d().then(b=>{let c=null;b&&(({Ev:c}=md.d(b)).returnValue||Z.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));c||(c={});c[a.key]=a.value;this.yX=c;return md.c(c)})}saveSettings(a){this.yX=md.a(a);this.Rnb();return this.okc()?this.Hgh(a):this.ned(a)}Hgh(a){try{return localStorage.setItem("AddinShortcutPreferenceData",a),Promise.resolve(!0)}catch(b){return Z.ULS.sendTraceTag(522739858,0,
10,"SaveSettingToLocalStorage failed",b),Promise.resolve(!1)}}ned(a){const b={};b.Wac=a;const c=md.c(b);return new Promise(f=>{try{if(void 0===c||null===c||!c.length||1E6<=c.length)f(!1);else{var l=this.executeRequest(this.Zbg(this.hTk),2,"SaveAddinShortcutsPreferenceRequest","38",c);l.continueWith(()=>{if(l.yn||l.Sl)Z.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),f(!1);else{var w=l.result;void 0!==w.Qi&&null!==w.Qi&&void 0!==w.Qi.data&&null!==w.Qi.data&&w.Qi.data.tf===
Pp.a.Xy?f(!0):f(!1)}})}}catch(w){Z.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",w.toString()),f(!1)}})}getSetting(){const a=this.okc();return this.yX?Promise.resolve(md.c(this.yX)):a?this.baj():this.p0d()}okc(){const a=u.AFrameworkApplication.fa.ka("IsAnonymousUser"),b=u.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled");return a||!b}baj(){try{const a=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(a)}catch(a){return Z.ULS.sendTraceTag(522739861,
0,10,"GetSettingFromLocalStorage failed",a),Promise.resolve("")}}p0d(){return new Promise((a,b)=>{try{const c=this.executeRequest(this.Zbg(this.gTk),1,"GetSettingRequest","37");c.continueWith(()=>{if(c.yn||c.Sl)Z.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let l="";var f=c.result;f&&f.Qi&&f.Qi.data?f.Qi.data.tf!==Pp.a.Xy?Z.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",f.Qi.data.tf):f.Qi.data.je?(f=md.a(f.Qi.data.je),f.Wac&&
(l=f.Wac)):Z.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):Z.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");a(l)}})}catch(c){Z.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",c.toString()),b("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(a){const b=this.okc(),c=this;return this.getSetting().then(f=>{let l=null;f&&(l=md.a(f));if(!l)return Z.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),
Promise.resolve(!0);for(const w of va.a.pK(l)){f=l[w.toString()];for(const F of va.a.pK(f)){const S=f[F];if(S.addinId===a)delete f[F.toString()];else if(0===S.ownerType&&S.shortcutInfoArray){const fa=S.shortcutInfoArray,xa=new Ua.a;for(let Za=0;Za<fa.length;++Za)fa[Za].addinId!==a&&xa.add(fa[Za]);S.shortcutInfoArray=xa.toArray()}}va.a.count(f)||delete f[w]}c.yX=l;c.WKk(a);return b?c.Hgh(md.c(l)):c.ned(md.c(l))})}Rnb(){if(this.yX){this.F6=null;const c=this.yX;for(let f in c){var a=f;const l=c[f];for(let w in l){var b=
w;const F=l[w];F.shortcutInfoArray&&this.rFd(parseInt(b),parseInt(a),F.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(a=>{let b=null;if(a&&!({Ev:b}=md.d(a)).returnValue)return Z.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.yX=b;this.Rnb();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(a,b,c){return this.yX&&(c=this.yX[c])&&(b=c[b])&&
b.addinId===a?b:null}getShortcutInfoArray(a,b){return this.yX&&(b=this.yX[b])&&(a=b[a])&&a.shortcutInfoArray?a.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(a,b,c){this.saveShortcutInfoArrayBatch(parseInt(a),parseInt(b),c)}setShortcutInfoArray(a,b,c){return this.saveShortcutInfoArray(parseInt(a),parseInt(b),c).then(()=>{this.Rnb();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(a,b){if(!this.F6)return Promise.resolve(!0);var c=this.F6[a];if(!c)return Promise.resolve(!0);
var f=c[b];c=f.modifiers;f=f.keyCode;const l=this.getShortcutInfoArray(c.toString(),f.toString());if(!l||!l.length)return Promise.resolve(!0);let w=0;for(const F of l){if(F.addinId===a&&F.action===b)break;++w}if(w>=l.length)return Promise.resolve(!0);l.splice(w,1);return this.saveShortcutInfoArray(c,f,l).then(()=>{this.Rnb();return Promise.resolve(!0)})}rFd(a,b,c){this.F6||(this.F6={});for(const f of c){c=f.addinId;const l=f.action;let w=this.F6[c];w||(w={});const F={};F.modifiers=a;F.keyCode=b;w[l]=
F;this.F6[c]=w}}WKk(a){a in this.F6&&delete this.F6[a]}isActionCustomized(a,b){return this.F6&&(a=this.F6[a])&&a[b]?!!a[b]:!1}getShortcutByCustomizedAction(a,b){return this.F6&&(a=this.F6[a])?a[b]:null}getShortcutsPreferenceMappingTable(){return this.yX}static instance(){Tq.IGd||(Z.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),Tq.IGd=new Tq,Tq.Laa=u.AFrameworkApplication.Be);return Tq.IGd}}Tq.IGd=null;Tq.Laa=null;Object(e.a)(Tq,"AddinShortcutsPreferenceSettingHelper",null,
[]);class YG{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=
this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(e.a)(YG,"BrowserInfo",null,[]);class ZG{constructor(){this.Version=this.Name=null}}Object(e.a)(ZG,"PluginInfo",null,[]);class dk{static qUj(){if(u.AFrameworkApplication.fa.ka("LogBrowserInfoIsEnabled")){var a=dk.RTi();try{const b=JSON.stringify(a);Z.ULS.sendTraceTag(6903563,102,50,b)}catch(b){Z.ULS.sendTraceTag(6903564,102,15,b.message)}}else Z.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static L7i(){const a=
window.navigator.plugins;if(!a||!a.length)return null;const b=[];for(let c=0;c<a.length;c++){const f=a[c].name,l=a[c].version;Array.add(b,Object.assign(new ZG,{Name:f,Version:l}))}return b}static RTi(){const a=new YG,b=new Sys.StringBuilder;dk.vA(c=>{a.DocElemClientHeight=c},()=>document.documentElement.clientHeight,b);dk.vA(c=>{a.DocElemClientWidth=c},()=>document.documentElement.clientWidth,b);dk.vA(c=>{a.DocElemOffsetHeight=c},()=>document.documentElement.offsetHeight,b);dk.vA(c=>{a.DocElemOffsetWidth=
c},()=>document.documentElement.offsetWidth,b);dk.vA(c=>{a.ScreenAvailHeight=c},()=>window.screen.availHeight,b);dk.vA(c=>{a.ScreenAvailWidth=c},()=>window.screen.availWidth,b);dk.vA(c=>{a.ScreenWidth=c},()=>window.screen.width,b);dk.vA(c=>{a.ScreenHeight=c},()=>window.screen.height,b);dk.vA(c=>{a.ScreenLogicalXdpi=c},()=>window.screen.logicalXDPI,b);dk.vA(c=>{a.ScreenLogicalYdpi=c},()=>window.screen.logicalYDPI,b);dk.vA(c=>{a.ScreenDeviceXdpi=c},()=>window.screen.deviceXDPI,b);dk.vA(c=>{a.ScreenDeviceYdpi=
c},()=>window.screen.deviceYDPI,b);dk.vA(c=>{a.WinInnerHeight=c},()=>window.self.innerHeight,b);dk.vA(c=>{a.WinInnerWidth=c},()=>window.self.innerWidth,b);dk.vA(c=>{a.WinOuterHeight=c},()=>window.self.outerHeight,b);dk.vA(c=>{a.WinOuterWidth=c},()=>window.self.outerWidth,b);dk.vA(c=>{a.WinOrientation=c},()=>window.self.orientation,b);dk.vA(c=>{a.WinDevicePixelRatio=c},()=>window.self.devicePixelRatio,b);dk.vA(c=>{a.SupportsTouch=c},()=>r.a.FIa,b);dk.vA(c=>{a.NavAppName=c},()=>window.navigator.appName,
b);dk.vA(c=>{a.NavAppVersion=c},()=>window.navigator.appVersion,b);dk.vA(c=>{a.NavLanguage=c},()=>window.navigator.browserLanguage||window.navigator.language,b);dk.vA(c=>{a.NavUserAgent=c},()=>window.navigator.userAgent,b);dk.vA(c=>{a.NavPlatform=c},()=>window.navigator.platform,b);dk.vA(c=>{a.NavPlugins=c},dk.L7i,b);dk.vA(c=>{a.CalculatedDevicePixelRatio=c},()=>dk.devicePixelRatio,b);a.Error=b.toString();return a}static get devicePixelRatio(){const a=window.devicePixelRatio;return isNaN(a)?window.screen.deviceXDPI/
window.screen.logicalXDPI:a}static vA(a,b,c){try{const f=b();a(f)}catch(f){c.isEmpty()||c.append(" | "),c.append(f.message||"null")}}}Object(e.a)(dk,"BrowserInfoLogger",null,[]);class LB{get name(){return"Common.App.BrowserInfoLogger"}Yb(){}init(){dk.qUj()}dispose(){}static main(){m.a.instance.Ec(new LB)}}Object(e.a)(LB,"BrowserInfoLoggerPackage",null,[2,3]);class MB{get name(){return"Common.App.DialogWithLinkToResource"}Yb(){}init(){}dispose(){}static main(){m.a.instance.Ec(new MB)}}Object(e.a)(MB,
"CommonAppDialogWithLinkToResourcePackage",null,[2,3]);var CP=d(693);class NB{get name(){return"Common.App.EventsCachePackage"}Yb(){}init(){CP.a.instance.init()}dispose(){}static main(){m.a.instance.Ec(new NB)}}Object(e.a)(NB,"EventsCachePackage",null,[2,3]);class OB{constructor(a,b,c){this.C1a=null;this.Md=a;this.Da=b;this.W1e=c.create()}nhc(){this.C1a?Z.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(Z.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),
this.C1a=new Se.a(2,1,3E4,Object(C.a)(this,this.ihd,"showFloatPane"),67),this.Md.Hb(this.C1a))}ihd(){this.C1a=null;Z.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.W1e.display()}Iva(){this.Da.ya(G.a.ihd,de.a.frame,Object(C.a)(this,this.V9k,"showFloatPaneHandler"))}V9k(a,b,c,f,l){return a!==G.a.ihd?2:1===c?32:2===c&&l?(Z.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",l),l?this.nhc():(this.C1a?(Z.ULS.sendTraceTag(23674914,
207,50,"Hide float pane via removing show task!"),this.Md.ah(this.C1a)):(Z.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.W1e.remove(null)),this.C1a=null),32):8}}Object(e.a)(OB,"FloatPaneActor",null,[628]);class $G{constructor(a,b,c,f,l){this.vwd=this.NMb=this.Ovc=this.Oya=this.i1=this.Mxa=this.Uod=this.kY=this.hPb=this.kOb=this.lOb=this.gsd=null;this.Md=b;this.mb=a;this.mn=c;this.Ea=l;this.n5=f}TQf(){this.kY=document.createElement("div");this.kY.className=String.format("{0} {1}",
"WACFloatPane","WACFloatPaneFadeIn");this.kY.style.width=this.i1.width+"px";(this.vwd=this.x6i(this.n5))?(this.Oya=document.createElement("a"),this.Oya.setAttribute(re.a.ff,re.a.eP),this.mn.pb(ra.a.click,this.Oya,Object(C.a)(this,this.nZg,"onRedirectClick")),this.Oya.href=this.vwd,this.Oya.target="_blank",this.Oya.appendChild(this.i1),this.kY.appendChild(this.Oya)):this.kY.appendChild(this.i1);this.Mxa=document.createElement("a");this.Mxa.setAttribute(re.a.ff,re.a.St);this.Mxa.className="StandardButton WACFloatPaneCloseButton";
this.Mxa.title=CommonUIStrings.l_Close;this.Mxa.tabIndex=-1;this.Uod=rp.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Uod.setAttribute(re.a.ff,re.a.eP);this.Mxa.appendChild(this.Uod);this.mn.pb(ra.a.click,this.Mxa,Object(C.a)(this,this.onClose,"onClose"));this.kY.appendChild(this.Mxa);this.hPb.appendChild(this.kY)}rk(a){const b=this.mb.ka("O365PromotionHasStarted");switch(a){case 2:return qp.a.bK(String.format("adppt{0}.png",
b?"sale":""));case 1:return qp.a.bK(String.format("adxls{0}.png",b?"sale":""));case 3:return qp.a.bK(String.format("addoc{0}.png",b?"sale":""))}return null}x6i(a){const b=this.mb.Ia("O365AdPaneRedirectedURL");switch(a){case 1:return String.format(b,"Excel");case 2:return String.format(b,"PowerPoint");case 3:return String.format(b,"Word")}return null}hide(a=null){this.NMb=null;this.kY&&!this.Ovc&&(a?Z.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):Z.ULS.sendTraceTag(23674903,
207,50,"User clicks button to close the float pane."),this.kY.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.kY.style.height="0px",this.Ovc=new Se.a(2,1,1E3,Object(C.a)(this,this.remove,"remove"),67),this.Md.Hb(this.Ovc))}remove(){this.kY&&this.hPb&&(this.Oya&&this.mn.zb(ra.a.click,this.Oya,Object(C.a)(this,this.nZg,"onRedirectClick")),this.mn.zb(ra.a.click,this.Mxa,Object(C.a)(this,this.onClose,"onClose")),this.hPb.removeChild(this.kY),this.kY=null);this.Ovc=null}display(){if(this.gsd=
this.Ea.qb("Common.IFloatPaneContainer"))if(this.hPb=this.gsd.container){var a=this.rk(this.n5);a?(Z.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",a),this.i1=document.createElement("img"),this.i1.className="WACFloatPaneImage",this.lOb=Object(C.a)(this,this.Sik,"onLoadImageFinish"),ad.a.addHandler(this.i1,ra.a.load,this.lOb),this.kOb=Object(C.a)(this,this.Rik,"onLoadImageError"),ad.a.addHandler(this.i1,ra.a.error,this.kOb),this.i1.src=a):Z.ULS.sendTraceTag(23674907,207,
15,"The target image is empty, can't show the float pane.")}else Z.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else Z.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}Sik(){const a=this.mb.Gc("O365AdPaneShowingDuration",60);this.TQf();this.kY.style.display="block";this.kY.style.height=this.i1.height+"px";this.NMb=new Se.a(2,1,1E3*a,Object(C.a)(this,this.hide,"hide"),67);this.Md.Hb(this.NMb);
this.Vah()}Rik(){Z.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.Vah();this.i1=null}Vah(){this.lOb&&this.i1&&ad.a.removeHandler(this.i1,ra.a.load,this.lOb);this.lOb=null;this.kOb&&this.i1&&ad.a.removeHandler(this.i1,ra.a.error,this.kOb);this.kOb=null}nZg(){Z.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.NMb&&this.Md.ah(this.NMb);this.hide();return!0}dispose(){this.hide()}}
Object(e.a)($G,"FloatPane",null,[661]);class PB{constructor(a,b,c,f,l){this.Md=b;this.mb=a;this.mn=c;this.Ea=l;this.n5=f}create(){return new $G(this.mb,this.Md,this.mn,this.n5,this.Ea)}}Object(e.a)(PB,"FloatPaneFactory",null,[627]);class QB{constructor(){this.Ea=null}get name(){return"Common.App.FloatPane"}get zsg(){return u.AFrameworkApplication.fa.ka("O365AdvertisementIsEnabled")&&u.AFrameworkApplication.fa.ka("IsShowAdvertisementPaneEnabled")}init(){this.zsg&&(Z.ULS.sendTraceTag(23674944,207,50,
"Setup task to show the float pane."),this.Ea.resolve("Common.App.FloatPane.IFloatPaneActor").nhc(),Z.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Ea.resolve("Common.App.FloatPane.IFloatPaneActor").Iva())}Yb(a){this.Ea=a;this.zsg&&(this.Ea.register(PB,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").na(()=>new PB(u.AFrameworkApplication.fa,u.AFrameworkApplication.ve,Hb.a.instance,u.AFrameworkApplication.Ba.jb.vm,this.Ea)).ma(),
this.Ea.register(OB,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").na(()=>new OB(u.AFrameworkApplication.ve,u.AFrameworkApplication.Va,this.Ea.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ma())}dispose(){}static main(){m.a.instance.Ec(new QB)}}Object(e.a)(QB,"FloatPanePackage",null,[2,3]);const aH=(a,b)=>{a=Math.atan2(b.y-a.y,b.x-a.x);0>a&&(a+=2*Math.PI);return a};class DP{constructor(a,b,c){this.PO=this.qjb=this.Jlb=null;this.Gxa=this.pqd=this.Fna=0;this.QF=
this.Dsc=this.krc=this.jrc=!1;this.Ctd=this.G4e=this.I4e=0;this.OKa=a;this.Da=b;this.rY=c}Tu(a){return gb.App.Fb.Fd.isEditingAllowed?""!==this.ELc(a.Hc):!1}pu(a){if(!this.Tu(a))return!1;this.Gxa=this.OKa.Wzl();this.Y1k(a);this.Z1k();({M8d:this.Dsc,tae:this.QF}=this.Dkh(this.pqd));this.$1k();this.Jlb=a.QD;this.PO=new Sys.UI.Point(0,0);({width:this.I4e,height:this.G4e}=this.OKa.getDimensions());Z.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}Xv(a){this.qjb=a.QD;this.$fi();var b=
this.PO.x,c=this.PO.y;a=this.I4e;var f=this.G4e,l=this.Dsc,w=this.QF,F=1;(b||c)&&a&&f&&(l&&w?(F=a+b,l=f+c,b=1/a,c=1/f,w=b>c?b:c,1>F?F=1:1920<F&&(F=1920),1>l?l=1:1280<l&&(l=1280),b=F-a,c=l-f,F=Math.abs(b/a)>Math.abs(c/f)?F/a:l/f,F<w&&(F=w)):l?(b=a+b,1>b?b=1:1920<b&&(b=1920),F=b/a):w&&(b=f+c,1>b?b=1:1280<b&&(b=1280),F=b/f));a=F;this.Ctd=a;this.OKa.KBl(this.Ctd,this.Dsc,this.QF);return!0}In(){this.Bh();Z.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}Jt(){this.OKa.ZAl();Z.ULS.sendTraceTag(16802337,
322,50,"Image resize drag canceled")}Z1k(){this.pqd=(Math.floor((this.Gxa+22)/45)%8+this.Fna)%8}Dkh(a){let b,c;if(this.Gxa&&90!==this.Gxa&&180!==this.Gxa&&270!==this.Gxa&&360!==this.Gxa||this.IFj(a))return{M8d:!0,tae:!0};c=b=!1;switch(a){case 1:case 5:c=!0;break;case 3:case 7:b=!0}return{M8d:b,tae:c}}$1k(){this.krc=this.jrc=!1;switch(this.pqd){case 0:this.krc=this.jrc=!0;break;case 1:case 2:this.krc=!0;break;case 7:case 6:this.jrc=!0}}IFj(a){return!(a%2)}ELc(a){var b=a.className;-1===b.indexOf("WACImageResizeHandle")&&
a.parentNode&&(b=a.parentNode.className);a=b.split(" ");for(b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==c)return c}return""}Y1k(a){switch(this.ELc(a.Hc)){case "WACImageResizeHandleNW":this.Fna=0;break;case "WACImageResizeHandleN":this.Fna=1;break;case "WACImageResizeHandleNE":this.Fna=2;break;case "WACImageResizeHandleE":this.Fna=3;break;case "WACImageResizeHandleSE":this.Fna=4;break;case "WACImageResizeHandleS":this.Fna=5;break;case "WACImageResizeHandleSW":this.Fna=
6;break;case "WACImageResizeHandleW":this.Fna=7}}$fi(){var a=1;this.rY.instance&&(a=this.rY.instance.Q1);const b=(this.qjb.x-this.Jlb.x)/a;a=(this.qjb.y-this.Jlb.y)/a;this.PO.x=this.jrc?-b:b;this.PO.y=this.krc?-a:a}Bh(){const a=new H.DictionaryPropertySet;a.setValue(Kd.a.wsj,100*this.Ctd);a.setValue(Kd.a.xsj,!0);if(90===this.Gxa||270===this.Gxa){let b,c;({M8d:b,tae:c}=this.Dkh(this.Fna));a.setValue(Kd.a.mkg,b);a.setValue(Kd.a.nkg,c)}else a.setValue(Kd.a.mkg,this.Dsc),a.setValue(Kd.a.nkg,this.QF);
this.Da.Ma(D.a.usj,2,a)}}Object(e.a)(DP,"ImageResizeDragAdapter",null,[223]);class RB{constructor(a,b){this.Da=a;this.rY=b}}Object(e.a)(RB,"ImageResizeDragAdapterFactory",null,[573]);class bH{constructor(a,b,c,f,l,w){this.mlb=this.ewc=this.Ftd=this.qjb=this.Jlb=this.fwc=null;this.Huc=this.syc=0;this.jx=null;this.Rn=!1;this.Da=a;this.Rc=b;this.Gg=c;this.OKa=f;this.rY=l;this.icf=this.cga=0;this.rlb=w}Tu(a){return gb.App.Fb.Fd.isEditingAllowed&&a?(this.fwc=this.Rc.Dj)?!0:!1:!1}pu(a){if(!this.Tu(a))return!1;
this.fwc=this.Rc.Dj;if(this.jx=cb.ImageReader.SBa(this.fwc))return this.Jlb=this.dra(a),this.Ftd=Sys.UI.DomElement.getBounds(this.rlb),this.syc=0<cb.ImageReader.L9f(this.jx)?cb.ImageReader.L9f(this.jx):0,this.Huc=cb.ImageReader.I2i(this.jx),Z.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0;Z.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties.");return!1}Xv(a){this.qjb=this.dra(a);this.bgi();if(this.OKa)return this.OKa.mtl(this.cga,
this.icf),Z.ULS.sendTraceTag(25179723,322,50,"Image rotate drag move is happening."),!0;Z.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}In(){var a=this.cga;a%=360;0>a&&(a+=360);this.syc=this.cga=a;this.setRotation();Z.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")}Jt(){this.OKa.mtl(this.Huc,0);Z.ULS.sendTraceTag(22052888,322,50,"Image rotate drag event canceled.")}dra(a){return this.Gg.Qha(a)}bgi(){var a=1;this.rY&&this.rY.instance&&
(a=this.rY.instance.Q1);var b=new Sys.UI.Point(this.Ftd.x+this.rlb.clientWidth/2*a,this.Ftd.y+this.rlb.clientHeight/2*a);a=aH(this.Jlb,b);b=aH(this.qjb,b);this.cga=Math.round(ke.a.uT(b-a));0<this.syc&&(this.cga+=this.syc-this.Huc);this.icf=this.cga;this.cga+=this.Huc}setRotation(){const a=new H.DictionaryPropertySet;a.setValue(Kd.a.vsj,0);a.setValue(Kd.a.d2b,this.cga);this.Da.Ma(D.a.imageRotate,2,a)}dispose(){Z.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed.");this.Rn||(this.mlb&&
(this.ewc&&this.mlb.contains(this.ewc)&&(this.mlb.removeChild(this.ewc),this.ewc=null),this.rlb&&this.rlb.contains(this.mlb)&&(this.rlb.removeChild(this.mlb),this.mlb=null)),this.Rn=!0)}}Object(e.a)(bH,"ImageRotateDragAdapter",null,[621,223,109]);class SB{constructor(a,b,c){this.Da=a;this.Rc=b;this.rY=c}create(a,b,c){return new bH(this.Da,this.Rc,a,b,this.rY,c)}}Object(e.a)(SB,"ImageRotateDragAdapterFactory",null,[572]);class TB{constructor(){this.Ea=null}get name(){return"Box4.Images"}Yb(a){this.Ea=
a;this.Ea.register(RB,"Box4.Images.ImageResizeDragAdapterFactory").as("Box4.Images.IImageResizeDragAdapterFactory").ma().na(()=>new RB(u.AFrameworkApplication.Va,lb.a.instance.Oa("Common.IZoomManager")));this.Ea.register(SB,"Box4.Images.ImageRotateDragAdapterFactory").as("Box4.Images.IImageRotateDragAdapterFactory").ma().na(()=>new SB(u.AFrameworkApplication.Va,dd.a.instance,lb.a.instance.Oa("Common.IZoomManager")))}init(){this.Ea.resolve("Box4.Images.IImageRotateDragAdapterFactory")}dispose(){}static main(){m.a.instance.Ec(new TB)}}
Object(e.a)(TB,"Box4ImagesPackage",null,[2,3]);class cH{create(a){return new mg.a(a)}}Object(e.a)(cH,"Factory",null,[581]);var Ty=d(430);class dH{constructor(){this.Ei=null}get key(){return"COMMENTTEXTANCHOR"}get w6(){return Box4Intl.Box4Strings.l_CommentContentTitle}reset(a){this.Ei=Object(ua.a)(Wc.AParagraphNode,a.node)}Gmc(a){a=(a=this.wYi(a))?Object.assign(new Ty.a,{F_:this.key,kP:a}):null;return{returnValue:!!a,uza:a}}wYi(a){if(!this.Ei.Ra)return null;const b=new Ua.a;for(let c=0;c<this.Ei.Ra.length;c++){const f=
this.Ei.Ra.ga(c);if(f.cp>a)break;if(f.wg)for(let l=0;l<f.wg.length;l++){const w=f.wg.ga(l);w.ek?b.add(w.GH.fq.toString()):b.remove(w.GH.fq.toString())}}return 0<b.count?b.ga(0):null}}Object(e.a)(dH,"CommentTextAnchorDetailsProvider",null,[777,403]);class Zw{constructor(){this.Ei=null}get w6(){return null}getTitle(){return null}V7f(){return null}reset(a){this.Ei=a.node}Gmc(a){const b=zg.d(this.Ei,a);a=null;if(!b||b.wq!==this.wq)return{returnValue:!1,uza:a};a=Object.assign(new Ty.a,{F_:this.key,kP:b,
title:this.getTitle(b),description:this.V7f(b)});return{returnValue:!0,uza:a}}}Object(e.a)(Zw,"BlobDetailsProvider",null,[777,403]);class eH extends Zw{constructor(){super()}get key(){return"EQUATION"}get wq(){return 11}get w6(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(e.a)(eH,"EquationDetailsProvider",Zw,[]);class fH{constructor(){this.r4e=null}get key(){return"LINK"}get w6(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(a){this.r4e=fb.HyperlinkReader.o_b(a.node)}Gmc(a){let b;
b=null;for(const c of this.r4e)if(c.Qa<=a&&a<c.Lb)return b=Object.assign(new Ty.a,{F_:this.key,kP:c.hyperlink}),{returnValue:!0,uza:b};return{returnValue:!1,uza:b}}}Object(e.a)(fH,"HyperlinkDetailsProvider",null,[777,403]);class gH extends Zw{constructor(){super()}get key(){return"IMAGE"}get wq(){return 5}get w6(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(a){return cb.ImageReader.JLc(a.properties)}V7f(a){return cb.ImageReader.dZd(a.properties)}}Object(e.a)(gH,"ImageDetailsProvider",
Zw,[]);class Uy{constructor(){this.description=this.contentId=this.kP=this.F_=null}}Object(e.a)(Uy,"StructuralContentDetails",null,[423]);class hH{get key(){return"IMAGENODE"}get w6(){return Box4Intl.Box4Strings.l_ImageContentTitle}IQe(a){let b;b=null;if(!a||!cb.ImageReader.tG(a.currentNode))return{returnValue:!1,$ob:b};b=Object.assign(new Uy,{F_:this.key,contentId:a.currentNode.id,kP:a.currentNode});return{returnValue:!0,$ob:b}}WKc(a,b){a=a.kP;const c=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;
let f="";b&&a.id===b.kP.id||(f=String.format(c,cb.ImageReader.JLc(a.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return f}}Object(e.a)(hH,"ImageNodeDetailsProvider",null,[402,403]);let $w,ax;class Nr{constructor(a,b){this.U0e=null;this.im=b;this.Ezd=a;this.QNb=Nr.keys.ga(a);this.YHh=Nr.Wri.ga(a)}get key(){return this.QNb}get w6(){return this.YHh}reset(a){this.U0e=this.im.ME(a.node)}Gmc(a){var b=Nr.FQi(this.U0e||[],c=>this.oCj(a,c));b=this.Sui(b);return{returnValue:!!b,uza:b}}oCj(a,b){return b.begin<=
a&&a<b.end&&(!b.Gh||this.Ezd===b.Gh.proofingType)}Sui(a){return a?Object.assign(new Ty.a,{F_:this.key,kP:a.Gh,description:this.RXd()}):null}RXd(){return u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static FQi(a,b){for(const c of a)if(b(c))return c;return null}}Nr.keys=(ax=new dc.a,ax.add(1,"SPELLINGERROR"),ax.add(2,"GRAMMATICALERROR"),ax.add(3,"ADVANCEDERROR"),ax);Nr.Wri=($w=new dc.a,
$w.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),$w.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),$w.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),$w);Object(e.a)(Nr,"ProofingDetailsProvider",null,[777,403]);class iH{constructor(){this.tableNode=null;this.oDc=this.Tdd=this.columns=this.rows=0}}Object(e.a)(iH,"TableInfo",null,[]);var Ln=d(145),Fd=d(84),kk=d(126);class jH{get key(){return"TABLE"}get w6(){return Box4Intl.Box4Strings.l_TableContentTitle}IQe(a){var b=
null;if(!Ce.isTableCell(a))return{returnValue:!1,$ob:b};b=new mb.GraphIterator;b.Pc(a);a=new iH;a.Tdd=kk.c(b)+1;a.oDc=Ln.a(b)+1;Fd.returnToContainingTable(b);a.tableNode=b.currentNode;a.columns=Cd.TableReader.ui(a.tableNode);a.rows=Cd.TableReader.Zj(a.tableNode);b=Object.assign(new Uy,{F_:this.key,contentId:a.tableNode.id,kP:a});return{returnValue:!0,$ob:b}}WKc(a,b){a=a.kP;const c=new z.a;b||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,a.columns,a.rows));b&&b.kP.oDc===a.oDc||
c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,a.oDc));b&&b.kP.Tdd===a.Tdd||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,a.Tdd));return c.toArray().join(" ")}}Object(e.a)(jH,"TableDetailsProvider",null,[402,403]);class UB{constructor(a,b){this.DKh=a;this.im=b}BCe(){this.DKh.execute(a=>{a.DWa(new fH);a.DWa(new Nr(1,this.im));a.DWa(new Nr(2,this.im));a.DWa(new Nr(3,this.im));a.DWa(new eH);a.DWa(new gH);a.DWa(new dH);a.LCe(new jH);a.LCe(new hH)})}}
Object(e.a)(UB,"AccessibilityActor",null,[]);class VB{constructor(a,b,c){this.fRb=a;this.ld=b;this.rGh=c}wb(){this.fRb.ra(D.a.xnk,Db.a.view,Object(C.a)(this,this.ynk,"openAutoCorrectOptionsView"),1028)}ynk(a,b,c){if(1===c)return 32;this.rGh().skc();return 32}}Object(e.a)(VB,"AutoCorrectActor",null,[]);class WB{constructor(a){this.XMh=a}YHj(a){if(!a||!a.Kv||1>a.Kv.count)return!1;const b=[nc.a.HAi,nc.a.GAi];return!!this.HKc(a.Kv,1,c=>this.VDc(c,b))}Krg(a){return!a||!a.Kv||1>a.Kv.count?!1:!!this.HKc(a.Kv,
1,b=>this.VDc(b,[nc.a.RM]))}qFj(a){return!a||!a.Kv||1>a.Kv.count?!1:!!this.HKc(a.Kv,2,b=>this.VDc(b,[nc.a.q5b]))}Pk(a){return!a||!a.Kv||1>a.Kv.count?!1:!!this.HKc(a.Kv,1,b=>this.VDc(b,[nc.a.Kda]))}VRc(a){if(!a||!a.Kv)return!1;a=a.Kv;for(let b=0;b<a.count;++b)if(!a.ga(b)||0<a.ga(b).W9h)return!1;return!0}gLi(a,b){return this.Krg(b)||this.qFj(b)?"":a}get OSc(){return this.XMh}HKc(a,b,c){if(a&&0<a.count)for(let f=a.count-1;0<=f;--f){if(c(a.ga(f)))return a.ga(f);if(a.count-f>=b)break}return null}VDc(a,
b){a=a&&a.Bjg?a.Bjg.split(" "):null;if(!a)return!1;for(const c of b)if(0<=Array.indexOf(a,c))return!0;return!1}}Object(e.a)(WB,"Box4PasteStewardUtils",null,[739]);class kH{constructor(){this.NX=0;this.Nvb=Array(9)}}Object(e.a)(kH,"FullListMetadata",null,[]);class Vy{constructor(){this.level=0;this.zJa=null;this.NX=0;this.VNi=this.Gdc=null;this.ICb=!1}}Object(e.a)(Vy,"ListItemMetadata",null,[]);class Ot{constructor(){this.RX=[]}u7f(){const a=new Ot;for(let b=0;b<this.RX.length;b++)a.add(this.ga(b));
return a}get count(){return this.RX.length}ga(a){return this.RX[a]}$(a,b){return this.RX[a]=b}add(a){Array.add(this.RX,a)}clear(){Array.clear(this.RX)}contains(a){return Array.contains(this.RX,a)}indexOf(a){return Array.indexOf(this.RX,a)}insert(a,b){Array.insert(this.RX,a,b)}remove(a){return Array.remove(this.RX,a)}removeAt(a){Array.removeAt(this.RX,a)}removeRange(a,b){for(let c=0;c<b;c++)Array.removeAt(this.RX,a)}reverse(){this.RX.reverse()}sort(){this.RX.sort()}toArray(){return Array.clone(this.RX)}}
Object(e.a)(Ot,"List",null,[]);class lH{constructor(){this.level=0;this.tagName="UL";this.pVa=null;this.ignore=!1;this.occ=0;this.listStyle="BulletListStyle1";this.Q7=new Ot;this.font=this.levelText=""}}Object(e.a)(lH,"ListLevelMetadata",null,[]);class XB{constructor(){this.mzg={};this.wFc=-1}}Object(e.a)(XB,"LevelLists",null,[]);class YB{constructor(a){this.nodes=a;this.O1=0;this.lists={};this.Q7=[];this.Evb=null;this.lha=[];this.lha[0]=new XB}}Object(e.a)(YB,"WordConverterArguments",null,[]);class mH{constructor(){this.y=
this.x=0;this.top=this.left=null}}Object(e.a)(mH,"AbsolutePosition",null,[]);class hn{constructor(a,b,c,f,l){this.cultureName=this.j4=this.Kv=this.qT=null;a&&(this.qT=a);b&&(this.Kv=b);this.j4=c?c:new Ua.a;f&&""!==f&&(this.cultureName=f);this.pga=l}}Object(e.a)(hn,"GlobalAttributesArgs",null,[]);class Pt{constructor(a,b,c="",f=0){this.zv=!1;this.i4e=this.j4e=null;let l=!1;Pt.OEj(a)&&(l=!0,this.j4e=a);Pt.bFj(b)&&(this.i4e=b);this.tLh=c;this.nGh=f;this.zv=l&&this.P1b?!0:!1}get isValid(){return this.zv}get Djg(){return this.j4e}get P1b(){return this.i4e}get Bjg(){return this.tLh}get W9h(){return this.nGh}static OEj(a){return a?
-1===a.indexOf(" ")&&0<a.length:!0}static bFj(a){return a?-1===a.indexOf(" ")&&0<a.length:!1}}Object(e.a)(Pt,"HtmlElementInfo",null,[]);class nH{constructor(a){this.next=null;this.data=a}}Object(e.a)(nH,"StackNode",null,[]);class bx{constructor(){this.Cu=null;this.Hk=0}get count(){return this.Hk}get isEmpty(){return!this.Hk||!this.Cu}push(a){a=new nH(a);a.next=this.Cu;this.Cu=a;this.Hk++}peek(){return this.isEmpty?null:this.Cu.data}pop(){if(this.isEmpty)return null;const a=this.Cu;this.Cu=a.next;
this.Hk--;return a.data}clear(){this.Cu=null;this.Hk=0}toArray(){const a=Array(this.count);let b=this.Cu;for(let c=this.count-1;0<=c&&b;c--)a[c]=b.data,b=b.next;return a}}Object(e.a)(bx,"Stack",null,[]);class Yg{constructor(a){this.uMb=this.yuc=null;this.Gqc=!1;this.Fg=a}get $Na(){return this.uMb.peek()}reset(){this.Fg.reset();this.yuc=new bx;this.uMb=new bx;this.uMb.push(this.Fg.PWb);this.Gqc=!1}i6c(){this.Gqc=!1}mC(a){this.Gqc||(this.yuc.push(null),this.Gqc=!0);this.yuc.push(a)}onClose(){for(;;){const a=
this.yuc.pop();if(!a)break;a()}}sjh(){return!1}xdk(){this.gq(()=>!0)}gq(a){const b=this.$Na.clone();return a(b)?(this.uMb.push(b),this.Fg.Bla(b),this.mC(Object(C.a)(this,this.zhk,"onFormattingEnd")),!0):!1}r2d(a){return a.style?this.gq(b=>this.sjh(b,a))?1:2:2}zhk(){this.uMb.pop();this.Fg.Bla(this.$Na)}D_(){}b6c(){return 2}ute(){return 2}vte(){return 2}wte(){return 2}Dte(){return 3}Gte(){}g6c(){return 2}Jte(){}Kte(){}Lte(){return 2}o6c(){return 2}p6c(){return 2}Wte(){return 2}q6c(){}$te(){return 2}r6c(){return 2}t6c(){return 2}w6c(){return 2}y6c(){return 2}nue(){}oue(){return 2}B6c(){return 2}C6c(){return 2}E6c(){return 2}F6c(){return 2}H6c(){return 2}I6c(){return 2}J6c(){return 2}M6c(){return 2}Hue(){return 2}U6c(){return 2}Nue(){return 2}Oue(){}Pue(){return 2}Z6c(){return 2}$6c(){return 2}a7c(){return 2}b7c(){return 2}c7c(){return 2}d7c(){return 2}Rue(){return 3}e7c(){}Tue(){return 2}f7c(){return 2}Vue(){return 3}g7c(){}Xue(){}h7c(){return 2}dve(){return 3}i7c(){return 2}k7c(){return 2}m7c(){return 2}n7c(){return 2}gve(){}hve(){return 3}r7c(){return 2}SBb(){return 2}jve(){}mve(){return 2}nve(){return 2}ove(){return 3}y7c(){return 2}pve(){return 2}C7c(){return 2}F7c(){return 2}rve(){}R7c(){return 2}zve(){return 2}$7c(){return 2}a8c(){return 2}Kve(){return 3}Lve(){return 2}l8c(){return 2}m8c(){return 2}n8c(){return 2}o8c(){return 2}Rve(){return 3}p8c(){return 2}q8c(){return 2}u8c(){return 2}Uve(){return 2}tdc(){return 2}Wve(){return 2}Xve(){return 2}v8c(){return 2}Yve(){return 2}$ve(){return 3}w8c(){return 2}z8c(){return 2}A8c(){return 2}B8c(){return 2}E8c(){return 2}static qra(a){return a&&
-1!==a.indexOf("px")&&(a=parseInt(Ja.a.substring(a,0,a.indexOf("px"))),!isNaN(a))?a:0}static Raj(a){if(!a||""===a)return-1;const b=Ja.a.vg(a);if(-1!==b.indexOf("pt")){if(a=parseFloat(Ja.a.substring(a,0,b.indexOf("pt"))),!isNaN(a))return a}else if(-1!==b.indexOf("px")&&(a=parseFloat(Ja.a.substring(a,0,b.indexOf("px"))),!isNaN(a)))return 3*a/4;return-1}static obg(a){return a&&""!==a?Yg.qra(a):null}static Nx(a){let b=null,c=null,f=null,l=null;a&&a.Pf&&(b=Yg.ira(a.Pf,"id"),c=Yg.ira(a.Pf,"lang"),f=a.Pf.tagName,
a.y7h&&(l=Object.assign(new mH,{x:Yg.qra(a.Pf.style.left),y:Yg.qra(a.Pf.style.top),left:Yg.obg(a.Pf.style.left),top:Yg.obg(a.Pf.style.top)})),void 0===b&&(b=""),void 0===c&&(c=""));return new hn(new Pt(b,f),a.Kv,null,c,l)}static ira(a,b){return a[b]}}Object(e.a)(Yg,"AHtmlTranslator",null,[795]);class oH extends hn{constructor(a,b,c,f=0,l=0,w=null){super(w?w.qT:null,w?w.Kv:null,w?w.j4:null,w?w.cultureName:null,w?w.pga:null);this.width=f;this.height=l}}Object(e.a)(oH,"AugmentationSemanticArgs",hn,[]);
class pH{constructor(){this.stop=this.color=null}}Object(e.a)(pH,"ColorStopPair",null,[]);class Wy{constructor(a,b){this.value=a;this.eTi=b}get WRc(){return this.eTi}}Object(e.a)(Wy,"ElementValueWrapper",null,[]);class qH extends Wy{constructor(a,b,c){super(a,b);this.svg=c}}Object(e.a)(qH,"DimensionWrapper",Wy,[]);class ZB{constructor(a=0,b=0,c=0,f=0,l="",w="",F="",S="",fa="0pt",xa="0pt",Za="0pt",pb="0pt"){this.borderTopStyle=a;this.borderRightStyle=b;this.borderBottomStyle=c;this.borderLeftStyle=
f;this.borderTopColor=l;this.borderRightColor=w;this.borderBottomColor=F;this.borderLeftColor=S;this.borderTopWidth=fa;this.borderRightWidth=xa;this.borderBottomWidth=Za;this.borderLeftWidth=pb}}Object(e.a)(ZB,"TableCellBorderProperties",null,[]);class $B{constructor(a="",b="",c="",f=""){this.iii=a;this.hii=b;this.fii=c;this.gii=f}}Object(e.a)($B,"TableCellMarginProperties",null,[]);class Kg{static get Cjg(){return Kg.vLh}static get bjd(){return Kg.PUh}static get Uid(){return Kg.NUh}static I1d(a,
b,...c){b=Kg.Jeg(b);let f=!1;b||(b=Kg.$ej.apply(null,[a].concat(c)),f=!!b);return new Wy(b,f)}static Jeg(a){for(const b of a)if(void 0!==b&&null!==b&&""!==b)return b.trim();return null}static $ej(a,...b){for(const c of b)if(b=a.getAttribute(c),void 0!==b&&null!==b&&(b+="",void 0!==b&&null!==b&&""!==b))return b.trim();return null}static G7i(a,b){b=parseFloat(b);if(isNaN(b))return 0;switch(a){case "px":return Math.round(b);case "pt":return Math.round(fe.a.Sda(b,0,!1));case "in":return Math.round(fe.a.jZ(b,
0,!1));case "cm":return Math.round(fe.a.jZ(ke.a.pLf(b),0,!1));case "mm":return Math.round(fe.a.jZ(ke.a.pLf(.1*b),0,!1));default:return b}}static vdd(a,b,...c){a=Kg.I1d.apply(null,[a,b].concat(c));c=0;b=!1;if(a.value){b=a.value.endsWith("%");let f;b?(c="%",f=Ja.a.substring(a.value,0,a.value.length-1)):a.WRc?(c="px",f=a.value):(c=a.value.substr(a.value.length-2),isNaN(parseFloat(c))?f=Ja.a.substring(a.value,0,a.value.length-2):(c="px",f=a.value));c=Kg.G7i(c,f)}return new qH(c,a.WRc,b)}static Qeg(a){return Kg.vdd(a,
[a.style.width],"width","WIDTH","Width")}static d6a(a){return Kg.vdd(a,[a.style.height],"height","HEIGHT","Height")}static QZd(a){return Kg.vdd(a,[a.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static RZd(a){return Kg.vdd(a,[a.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static ffj(a){a=Kg.I1d(a,[a.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return a.value&&a.value in Kg.bjd&&void 0!==Kg.bjd[a.value]&&null!==Kg.bjd[a.value]?Kg.bjd[a.value]:0}static fMj(a){a=
Kg.Jeg([a.style.borderCollapse]);return!!a&&!(void 0===a||null===a)&&("collapse"===a||"COLLAPSE"===a||"Collapse"===a)}static yWi(a){return Kg.I1d(a,[a.style.backgroundColor,a.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static Hsi(a){const b=Ja.a.substring(a,0,1),c=Ja.a.substring(a,1,2);a=Ja.a.substring(a,2,3);return b+b+c+c+a+a}static dha(a){let b="";if(!a||""===a)return b;b=a.trim();if(b.startsWith("rgb")){b=Ja.a.substring(b,b.indexOf("(")+1,b.length-1);a=b.split(",");if(3!==
a.length)return"";b="";for(let f=0;f<a.length;f++){var c=parseInt(a[f]);if(isNaN(c)||0>c||255<c)return"";c=c.toString(16);1===c.length&&(c="0"+c);b+=c}return Ja.a.vC(b)}if(Kg.Cjg[Ja.a.vg(b)])return Kg.Cjg[Ja.a.vg(b)];b.startsWith("#")&&(b=Ja.a.substring(b,1,b.length));if(isNaN(parseInt(b,16)))return"";3===b.length&&(b=Kg.Hsi(b));return 6!==b.length?"":b}static Mqk(a){var b=a.indexOf("mso-tab-count");if(-1===b)return 0;const c=RegExp("([\\d])");let f="";for(b=b+13+1;b<a.length;b++){const l=a.charAt(b).toString();
if(c.test(l))f+=l;else break}a=0;""!==f&&(a=parseInt(f));return a}static hOc(a,b){const c=Kg.yWi(a);c&&""!==c&&b.gq(f=>f.nfd(Kg.dha(c)))}static x6f(a){a=a.style;if(!a)return null;const b=Kg.Uid[a.borderTopStyle],c=Kg.dha(a.borderTopColor),f=a.borderTopWidth,l=Kg.Uid[a.borderRightStyle],w=Kg.dha(a.borderRightColor),F=a.borderRightWidth,S=Kg.Uid[a.borderBottomStyle],fa=Kg.dha(a.borderBottomColor),xa=a.borderBottomWidth,Za=Kg.Uid[a.borderLeftStyle],pb=Kg.dha(a.borderLeftColor);return new ZB(b,l,S,Za,
c,w,fa,pb,f,F,xa,a.borderLeftWidth)}static nXi(a){const b=a.firstChild;return(a=b&&b.className&&-1!==b.className.indexOf("TableCellContent")?a.firstChild.style:a.style)?new $B(a.paddingTop,a.paddingRight,a.paddingBottom,a.paddingLeft):null}}Kg.vLh=va.a.cH("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood",
"DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B",
"darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo",
"4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00",
"limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500",
"orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD",
"slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32");Kg.PUh=va.a.cH("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);Kg.NUh=va.a.cH("",0,"initial",3,"inherit",
11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(e.a)(Kg,"DefaultHtmlTranslatorHelper",null,[]);class rH{constructor(){this.direction=null;this.cVb=new Ot}Zhg(){return!!this.direction&&0<this.direction.length}}Object(e.a)(rH,"LinearGradient",null,[]);class aC{constructor(){this.mRc=!1}}Object(e.a)(aC,"HtmlTranslatorContext",null,[]);class bC{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,w=!1,F=!0,S=!1,fa=!0,xa=!0,Za=!0,pb=!1,Mb=!1,
hc=!1,kc=!1,Ec=!1,Hc=!1,Dc=null,Td=null,we=null,Pd=null,He=null,Pe=null,Df=null){this.mRc=!1;this.CQh=a;this.HQh=b;this.zQh=c;this.GQh=f;this.sTh=l;this.qTh=w;this.lTh=F;this.mTh=S;this.oTh=fa;this.pTh=xa;this.nTh=Za;this.BTh=pb;this.QTh=Mb;this.ATh=hc;this.EUh=kc;this.vTh=Ec;this.SLh=Hc;this.uTh=Dc;this.zTh=Td;this.rTh=He;this.xTh=we;this.tTh=Pd;this.wTh=Pe;this.yTh=Df}get ZVa(){return this.CQh}get Drk(){return this.HQh}get r2g(){return this.zQh}get Crk(){return this.GQh}get cnh(){return this.sTh}get bnh(){return this.qTh}get B6k(){return this.lTh}get C6k(){return this.mTh}get E6k(){return this.oTh}get G6k(){return this.pTh}get D6k(){return this.nTh}get TXa(){return this.vTh}get Rwj(){return this.SLh}get gnh(){return this.BTh}get k8k(){return this.QTh}get O6k(){return this.ATh}get Ofl(){return this.EUh}get dnh(){return this.uTh||
Object(C.a)(this,this.Add,"returnFalse")}get N6k(){return this.zTh||Object(C.a)(this,this.Add,"returnFalse")}get M6k(){return this.xTh||Object(C.a)(this,this.eFe,"returnTrue")}get I6k(){return this.tTh||Object(C.a)(this,this.eFe,"returnTrue")}get H6k(){return this.rTh||Object(C.a)(this,this.Add,"returnFalse")}get L6k(){return this.wTh||Object(C.a)(this,this.eFe,"returnTrue")}get fnh(){return this.yTh||Object(C.a)(this,this.Add,"returnFalse")}eFe(){return!0}Add(){return!1}}Object(e.a)(bC,"HtmlTranslatorSettings",
null,[324]);class sH extends hn{constructor(a,b,c,f,l=null,w=0,F=0,S=null,fa=null){super(l?l.qT:null,l?l.Kv:null,l?l.j4:null,l?l.cultureName:null,l?l.pga:null);this.src=a;this.alt=b;this.width=c;this.height=f;this.maxWidth=w;this.maxHeight=F;this.href=S;this.desc=fa}}Object(e.a)(sH,"ImageSemanticArgs",hn,[]);class tH{constructor(a,b){this.Ncl=a;this.Mcl=b}}Object(e.a)(tH,"IndentationProperties",null,[]);class cx extends hn{constructor(a,b,c,f=0,l=-1,w=!1,F=!1,S="",fa="",xa=null,Za=-1){super(c?c.qT:
null,c?c.Kv:null,c?c.j4:null,c?c.cultureName:null,c?c.pga:null);this.wff=a;this.hOb=0;this.oCd=b;this.lNb=1===b&&-1===l&&!this.y_a;this.wwd=f;this.xwd=l;this.Syd=w;this.y_a=F;this.q0a=S;this.yjb=fa;this.jpc=xa;this.Uoc=Za;this.Xib=-1;this.dyc=!0}get listStyleType(){return this.nGj?this.hOb:this.wff}get nGj(){return 0!==this.hOb}get hel(){return this.oCd}get listLevel(){return this.xwd}set listLevel(a){this.xwd=a}get listId(){return this.wwd}set listId(a){this.wwd=a}get ICb(){return this.Syd}set ICb(a){this.Syd=
a}get Y4a(){return this.y_a}set Y4a(a){this.y_a=a}get levelText(){return this.q0a}set levelText(a){this.q0a=a}get font(){return this.yjb}set font(a){this.yjb=a}get vNa(){return this.jpc}set vNa(a){this.jpc=a}get Pnb(){return this.Uoc}set Pnb(a){this.Uoc=a}get Atg(){return 6<=this.listStyleType}get rAj(){return this.lNb}get VAi(){return this.dyc?this.oCd+this.Xib:this.Xib}clone(){const a=new cx(this.wff,this.oCd,new hn(this.qT,this.Kv,this.j4,this.cultureName,this.pga),this.wwd,this.xwd,this.Syd,this.y_a);
a.hOb=this.hOb;a.lNb=this.lNb;a.Xib=this.Xib;a.dyc=this.dyc;a.q0a=this.q0a;a.yjb=this.yjb;a.jpc=this.jpc;a.Uoc=this.Uoc;return a}W7h(a,b,c){this.hOb=a;0<b?(this.lNb=!1,this.Xib=b,this.dyc=!1):(this.Xib++,this.lNb=!c)}}Object(e.a)(cx,"ListSemanticArgs",hn,[]);class Xy extends hn{constructor(a,b,c,f,l=null,w=0,F=null,S=null,fa=!1,xa=!1,Za=69905,pb=null){super(pb?pb.qT:null,pb?pb.Kv:null,pb?pb.j4:null,pb?pb.cultureName:null,pb?pb.pga:null);this.colSpan=a;this.rowSpan=b;this.width=c;this.fvb=xa;this.height=
f;this.sDa=fa;this.Kjc=l;this.verticalAlignment=w;this.U4=F;this.Yid=S;this.mCc=Za}}Object(e.a)(Xy,"TableCellSemanticArgs",hn,[]);class cC extends hn{constructor(a,b=null){super(b?b.qT:null,b?b.Kv:null,b?b.j4:null,b?b.cultureName:null,b?b.pga:null);this.height=a}}Object(e.a)(cC,"TableRowSemanticArgs",hn,[]);class dC extends hn{constructor(a,b,c,f,l,w,F,S,fa,xa=null,Za=-1,pb=null){super(pb?pb.qT:null,pb?pb.Kv:null,pb?pb.j4:null,pb?pb.cultureName:null,pb?pb.pga:null);this.BNa=null;this.oX=a;this.Rpa=
b;this.width=c;if(l)for(this.BNa=Array(l.length),a=0;a<l.length;++a)this.BNa[a]=l[a];this.Cqg=w;this.cOe=S;this.KAj=F;this.sDa=f;this.f5d=fa;this.osh=xa;this.tableLook=Za}}Object(e.a)(dC,"TableSemanticArgs",hn,[]);let Or;class Fk extends Yg{constructor(a,b=null,c=null,f=null){super(a);this.v0a=null;this.kOh=va.a.cH("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",
9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Ic=b||new bC;this.yu=c||new aC;this.zwd=f}get izg(){return this.kOh}E$f(a,b){var c;if((c=a.style?a.style.listStyleType:"")&&""!==c&&(c=this.izg[Ja.a.vg(c)])||(c=Yg.ira(a,"type"))&&""!==c&&(c=this.izg[c]))return c;if(this.Ic.ZVa&&(c=a.tagName.toLowerCase())&&("ol"===c||"ul"===c)&&(a=a.className)&&""!==a)if("ul"===c)switch(a=Fk.xNc(a,"BulletListStyle"),a){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===
c)switch(a=Fk.xNc(a,"NumberListStyle"),a){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return b}x$f(a){let b=-1,c=a.tagName.toLowerCase();if("ol"===c||"ul"===c){a=ya.a.N8f(a,"li");if(!a)return b;c="li"}if("li"===c){b=(b=this.pKc(a,"data-aria-level",0))?b:-1;if(0<b)return b-1;if(a=ya.a.N8f(a,"p"))return Fk.j4i(a)-1}return b}pKc(a,b,c){a=this.Ic.ZVa?a.getAttribute(b):Yg.ira(a,b);
a=parseInt(a);return isNaN(a)||0>a?c:a}Nik(){this.v0a.pop();this.Fg.Ela()}d1b(a,b){this.gq(l=>l.fIa(0,0));const c=this.E$f(a.Pf,b?6:2);let f=1;b&&(f=this.pKc(a.Pf,"start",1));b=!1;this.Ic.ZVa&&(b=a.Pf.getAttribute("data-pasteFromRc"),(b=!!b&&"true"===b)&&a.Pf.removeAttribute("data-pasteFromRc"),(r.a.uS||r.a.ag)&&Fk.TCc(a.Pf));a=new cx(c,f,Yg.Nx(a),0,-1,b,this.Ic.ZVa);this.v0a.push(a);this.Fg.Gla(a);this.mC(Object(C.a)(this,this.Nik,"onListElementClose"));return 1}reset(){super.reset();this.v0a=new bx}sjh(a,
b){let c=!1;try{var f=b.getAttribute("xml:lang")||Yg.ira(b,"lang")}catch(S){f=null}f&&""!==f&&(c=a.WHe(f)||c);(f=Yg.ira(b,"dir"))&&(c=a.hGb(f)||c);if(f=b.style){if(f.fontWeight){var l=Ja.a.vC(f.fontWeight),w=parseInt(l);isNaN(w)?"BOLD"===l?c=a.cJ(!0)||c:"NORMAL"===l&&(c=a.cJ(!1)||c):c=600<=w?a.cJ(!0)||c:a.cJ(!1)||c}this.Ic.bnh&&f.fontSize&&(l=Yg.Raj(f.fontSize),0<l&&(c=u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PasteKeepSourceFontSizeFixIsEnabled")?a.zFb(Math.floor(2*l))||c:a.Bfd(Math.floor(2*
l))||c));this.Ic.M6k(this.yu)&&(this.Ic.gnh&&b.getAttribute?(l=b.getAttribute("data-indent"))&&0<l.length&&(l=fe.a.kJ(parseInt(l),0)+"px",c=a.igd(l)||c):f.textIndent&&(c=a.igd(f.textIndent)||c));this.Ic.I6k(this.yu)&&f.marginLeft&&(this.Ic.gnh&&b.getAttribute?(l=b.getAttribute("data-margin"))&&0<l.length&&(c=a.ojc(f.marginLeft)||c):"TABLE"!==b.tagName&&(c=a.ojc(f.marginLeft)||c));this.Ic.H6k(this.yu)&&f.lineHeight&&(c=a.c0(f.lineHeight)||c);if(this.Ic.D6k)if(l=f.fontVariantCaps?Ja.a.vg(f.fontVariantCaps):
null,w=f.fontVariant?Ja.a.vg(f.fontVariant):null,"uppercase"===(f.textTransform?Ja.a.vg(f.textTransform):null))c=a.hgd("uppercase")||c;else if("small-caps"===l||w&&0<=w.indexOf("small-caps"))c=a.hgd("small-caps")||c;this.Ic.L6k(this.yu)&&f.textAlign&&(c=a.zfb(Ja.a.vg(f.textAlign))||c);f.fontStyle&&(l=Ja.a.vC(f.fontStyle),"ITALIC"===l||"OBLIQUE"===l?c=a.zXa(!0)||c:"NORMAL"===l&&(c=a.zXa(!1)||c));l=Fk.hdj(b);if(f.textDecoration||l){w=Ja.a.vg(f.textDecoration||"");l=Ja.a.vg(l||"");if(b.parentNode&&b.parentNode.tagName&&
"a"===Ja.a.vg(b.parentNode.tagName)){var F=(b.querySelector(".TextRun")||b).className;F&&-1<F.indexOf("Underlined")&&(c=a.e0(!0)||c)}else if(f.EBl||Fk.mD(w)||Fk.mD(l))c=a.e0(!0)||c;if(f.DBl||Fk.ztg(w)||Fk.ztg(l))c=a.uX(!0)||c}if(f.verticalAlign){l=Ja.a.vC(f.verticalAlign);if("SUB"===l||this.Ic.fnh(this.yu)&&b.className&&-1<b.className.indexOf("Subscript"))c=a.G4(!0)||c;else if("SUPER"===l||this.Ic.fnh(this.yu)&&b.className&&-1<b.className.indexOf("Superscript"))c=a.wX(!0)||c;this.Ic.bnh&&("SUB"===
l||"SUPER"===l)&&b.getAttribute&&(l=parseFloat(b.getAttribute("data-fontsize")),isNaN(l)||(c=a.Bfd(Math.floor(2*l))||c))}this.Ic.G6k&&f.fontFamily&&(this.Ic.O6k&&b.getAttribute?(l=b.getAttribute("data-usefontface"))&&"true"===l&&(c=this.ojh(a,f.fontFamily,c)):c=this.ojh(a,f.fontFamily,c));l=null;this.Ic.E6k&&f.color&&(l=Kg.dha(f.color));w=!!l;this.Ic.N6k(this.yu)&&b.getAttribute&&(l=b.getAttribute("data-scheme-color"),l=null!==l?l:"",w=""!==l||!this.yu.mRc||Fk.CMj(b));w&&(c=a.Ms(l)||c);this.Ic.B6k&&
f.backgroundColor&&(this.Ic.Drk&&b.tagName&&Fk.Hhl.contains(Ja.a.vC(b.tagName))||(c=a.Hma(Kg.dha(f.backgroundColor))||c));if(this.Ic.C6k&&f.backgroundImage&&b.className&&-1<b.className.indexOf("Highlight")&&(f=Fk.afj(f.backgroundImage))&&0<f.cVb.count){l=f.cVb.ga(0).color;w=!0;for(F=0;F<f.cVb.count&&(w=w&&l===f.cVb.ga(F).color,w);F++);w&&(Z.ULS.sendTraceTag(41707206,307,50,"Paste text with highlight"),c=a.Hma(Kg.dha(l))||c)}}this.Ic.dnh(this.yu)&&b.getAttribute&&(f=b.getAttribute("data-ccp-props"))&&
(c=a.Jma(f)||c);if(b.getAttribute){if(f=b.getAttribute("data-ccp-charstyle"))u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Ic.TXa&&(c=a.nea(f)||c);if(b=b.getAttribute("data-ccp-parastyle"))u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Ic.TXa&&(c=a.Pfd(b)||c)}return c}j8k(a){if(this.Ic.k8k)for(a=a.parentNode;a&&a.tagName;){if(a.className&&Object.getType(a.className)===
String&&-1<Ja.a.vC(a.className).indexOf("MSOCOM"))return!0;if("DIV"===Ja.a.vC(a.tagName))break;a=a.parentNode}return!1}ojh(a,b,c){b=Fk.$8f(b);return a.ZHa(b,this.Ic.Ofl)||c}D_(a,b){"\u200b"===a&&(a="\u00a0");b&&b.Pf&&this.j8k(b.Pf)&&(a="");this.Fg.D_(a,Yg.Nx(b))}b6c(a){const b=Yg.ira(a.Pf,"href");return b&&""!==b?(this.Fg.Vua(b,Yg.Nx(a)),this.mC(Object(C.a)(this.Fg,this.Fg.Uua,"onAnchorEnd")),1):2}g6c(){return this.gq(a=>a.cJ(!0))?1:2}o6c(){return this.gq(a=>a.o2d())?1:2}p6c(a){this.Fg.Vz(Yg.Nx(a));
this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}q6c(a){this.Fg.Dla(Yg.Nx(a))}r6c(a){this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}w6c(){return this.gq(a=>a.zXa(!0))?1:2}t6c(a){this.gq(b=>b.zfb("center"));this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}y6c(){return this.gq(a=>a.ZHa("consolas"))?1:2}C6c(){return this.gq(a=>a.uX(!0))?1:2}B6c(a){return this.d1b(a,!1)}E6c(){return this.gq(a=>a.zXa(!0))?
1:2}F6c(a){return this.d1b(a,!1)}H6c(a){var b=a.Pf.getAttribute("data-render-src");const c=a.Pf.getAttribute("data-render-method");if(b&&""!==b&&c&&""!==c){const F=a.Pf.getAttribute("data-render-fallback");let S=0,fa=0;if(a.Pf.currentStyle){var f=a.Pf.currentStyle.width,l=a.Pf.currentStyle.height;f&&-1!==f.indexOf("px")&&(f=parseInt(Ja.a.substring(f,0,f.indexOf("px"))),isNaN(f)||(S=f));l&&-1!==l.indexOf("px")&&(l=parseInt(Ja.a.substring(l,0,l.indexOf("px"))),isNaN(l)||(fa=l))}a=new oH(b,c,F,S,fa,
Yg.Nx(a));this.Fg.OVa(a);return 2}this.Ic.ZVa&&(r.a.uS||r.a.ag)&&(b=a.Pf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),this.Ic.ZVa&&b&&b.length&&Fk.TCc(a.Pf));const w=a.Pf.getAttribute("align");this.gq(F=>F.zfb(w));this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}I6c(a){this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}J6c(a){this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}M6c(){return this.gq(a=>
a.zXa(!0))?1:2}U6c(a){return this.gq(b=>{var c=Fk.$8f(a.Pf.getAttribute("face"));c=b.ZHa(c);b=b.Ms(Kg.dha(a.Pf.getAttribute("color")));return c||b})?1:2}Z6c(a){this.gq(b=>this.Ic.TXa?b.DXa(1):b.EXa(1));this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}$6c(a){this.gq(b=>this.Ic.TXa?b.DXa(2):b.EXa(2));this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}a7c(a){this.gq(b=>this.Ic.TXa?b.DXa(3):b.EXa(3));this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,
this.Fg.Uz,"onParagraphEnd"));return 1}b7c(a){this.gq(b=>this.Ic.TXa?b.DXa(4):b.EXa(4));this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}c7c(a){this.gq(b=>this.Ic.TXa?b.DXa(5):b.EXa(5));this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}d7c(a){this.gq(b=>this.Ic.TXa?b.DXa(6):b.EXa(6));this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}e7c(a){this.Fg.Dla(Yg.Nx(a))}g7c(a){var b=a.Pf;const c=
b.src,f=b.alt,l=b.zAl;let w=0,F=0;b.style&&(w=Yg.qra(b.style.width),F=Yg.qra(b.style.height));w&&F||(w=b.width,F=b.height);let S=b=0;a.Pf.currentStyle&&(w||F||(w=Yg.qra(a.Pf.currentStyle.width),F=Yg.qra(a.Pf.currentStyle.height)),b=Yg.qra(a.Pf.currentStyle.maxWidth),S=Yg.qra(a.Pf.currentStyle.maxHeight));a=new sH(c,f,w,F,Yg.Nx(a),b,S,l);this.Fg.Cla(a)}f7c(){return this.gq(a=>a.zXa(!0))?1:2}h7c(){return this.gq(a=>a.e0(!0))?1:2}i7c(){return this.gq(a=>a.ZHa("consolas"))?1:2}k7c(a){this.Fg.Vz(Yg.Nx(a));
this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}m7c(a){this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}n7c(a){let b;const c=this.E$f(a.Pf,0);let f=this.pKc(a.Pf,"value",0);var l=!1;0<this.v0a.count?b=this.v0a.peek():(b=new cx(2,1,Yg.Nx(a)),f||(f=1));if(this.Ic.ZVa){l=b.listLevel;let fa=b.listId;this.Ic.cnh?(l=this.x$f(a.Pf),l=0>l&&0>b.listLevel&&0<this.v0a.count?b.listLevel=this.v0a.count-1:b.listLevel=0<=l?l:b.listLevel,this.zwd&&this.zwd.b<
l&&(this.zwd.b=l)):0>l&&(l=b.listLevel=this.x$f(a.Pf));1>fa&&(fa=b.listId=this.pKc(a.Pf,"data-listid",0));a.Pf.getAttribute("data-leveltext")&&(b.levelText=a.Pf.getAttribute("data-leveltext"));var w=a.Pf.getAttribute("data-font");w&&(b.font=w);w=!1;u.AFrameworkApplication.fa&&(w=u.AFrameworkApplication.fa.ka("FollowDestinationThemePasteIsEnabled"));if(w){var F=a.Pf.getAttribute("data-charcodes");w=[];if(F&&""!==F)if(-1<F.indexOf(",")){F=F.split(",");for(var S=0;S<F.length;S++)Array.add(w,parseInt(F[S]))}else Array.add(w,
parseInt(F));if(w&&0<w.length){F=Array(w.length);for(S=0;S<w.length;S++)F[S]=w[S];b.vNa=F}(w=a.Pf.getAttribute("data-buAutoNum"))&&0<w.length&&(b.Pnb=parseInt(w))}(l=0<=l&&0<fa)&&Fk.TCc(a.Pf)}b.W7h(c,f,l);this.Fg.Zua(b.clone());this.mC(Object(C.a)(this.Fg,this.Fg.Fla,"onListItemEnd"));return 1}SBb(a){return this.d1b(a,!1)}r7c(a){if(this.gq(b=>b.QFb(!0))){const b=a.Pf.getAttribute("OuterHtml");this.Fg.$ua(b,Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.HGa,"onMathEnd"))}return 1}y7c(a){return this.d1b(a,
!0)}C7c(a){this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}F7c(a){const b=a.Pf.getAttribute("align");this.gq(c=>c.zfb(b));if(this.Ic.ZVa){const c=a.Pf.parentNode;c&&c.tagName.toLowerCase().startsWith("li")&&Fk.TCc(a.Pf,r.a.uS||r.a.ag)}this.Fg.Vz(Yg.Nx(a));this.mC(Object(C.a)(this.Fg,this.Fg.Uz,"onParagraphEnd"));return 1}R7c(){this.gq(a=>a.ZHa("consolas"));this.Fg.NVa();this.mC(Object(C.a)(this.Fg,this.Fg.MVa,"onPreFormattedTextEnd"));return 1}$7c(){return this.gq(a=>
a.uX(!0))?1:2}a8c(){return this.gq(a=>a.ZHa("consolas"))?1:2}l8c(){return this.gq(a=>a.RLe())?1:2}m8c(a){var b=a.Pf.attributes.getNamedItem("style"),c="";b&&b.value&&(c=b.value);b=Kg.Mqk(c);if(0<b&&this.Ic.Rwj){for(c=0;c<b;c++)this.Fg.SVa(Yg.Nx(a));return 3}return 2}n8c(){return this.gq(a=>a.uX(!0))?1:2}o8c(){return this.gq(a=>a.cJ(!0))?1:2}p8c(){return this.gq(a=>a.G4(!0))?1:2}q8c(){return this.gq(a=>a.wX(!0))?1:2}u8c(a){this.gq(Za=>Za.clearFormatting()&&Za.CEe());Kg.hOc(a.Pf,this);const b=Kg.Qeg(a.Pf),
c=Kg.x6f(a.Pf),f=Kg.QZd(a.Pf),l=Kg.RZd(a.Pf),w=!parseInt(Yg.ira(a.Pf,"border")),F=Kg.fMj(a.Pf);let S=-1,fa="";var xa=-1;a.Pf.attributes.hasOwnProperty("style")&&-1!==(xa=a.Pf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?S=parseInt(a.Pf.attributes.getNamedItem("style").value.substr(xa+17)):a.Pf.attributes.hasOwnProperty(Ka.a.cQd.toString())&&(S=parseInt(a.Pf.attributes.getNamedItem(Ka.a.cQd.toString()).value));xa=-1;a.Pf.attributes.hasOwnProperty("class")&&-1!==(xa=a.Pf.attributes.getNamedItem("class").value.indexOf("Mso"))?
fa=a.Pf.attributes.getNamedItem("class").value.substr(xa).split(" ")[0]:a.Pf.attributes.hasOwnProperty(Ka.a.dQd.toString())&&(fa=a.Pf.attributes.getNamedItem(Ka.a.dQd.toString()).value);this.Fg.$W(new dC(0,0,b.value,b.svg,null,w,F,c,new tH(f.value,l.value),fa,S,Yg.Nx(a)));this.mC(Object(C.a)(this.Fg,this.Fg.XW,"onTableEnd"));u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}tdc(a){const b=Kg.d6a(a.Pf),c=Kg.Qeg(a.Pf);if(!c.value&&
c.WRc&&(u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Ic.r2g))return 3;let f=parseInt(Yg.ira(a.Pf,"colSpan"));if(void 0===f||null===f||""===f+"")f=c.value?1:0;let l=parseInt(Yg.ira(a.Pf,"rowSpan"));if(void 0===l||null===l||""===l+"")l=b.value?1:0;let w=!1;a.Pf.attributes.hasOwnProperty("style")&&(w=-1!==a.Pf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==a.Pf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));
!w&&a.Pf.attributes.hasOwnProperty("class")&&(w=-1!==a.Pf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let F=69905;if(a.Pf.attributes.hasOwnProperty(Ka.a.bQd.toString())){var S=parseInt(a.Pf.attributes.getNamedItem(Ka.a.bQd.toString()).value);isNaN(S)||(F=S)}S=Kg.dha(a.Pf.style.backgroundColor);const fa=Kg.ffj(a.Pf);this.gq(pb=>pb.fIa(0,0));Kg.hOc(a.Pf,this);const xa=Kg.x6f(a.Pf),Za=this.Ic.Crk?Kg.nXi(a.Pf):null;a=new Xy(f,l,c.value,b.value,S,fa,xa,Za,c.svg,w,F,Yg.Nx(a));this.Fg.WW(a);
this.mC(Object(C.a)(this.Fg,this.Fg.VW,"onTableCellEnd"));this.xdk();return 1}v8c(a){const b=this.tdc(a);if(3===b)return b;this.gq(c=>{const f=c.cJ(!0);c=c.zfb("center");return f||c});Kg.hOc(a.Pf,this);return 1}w8c(a){Kg.hOc(a.Pf,this);const b=Kg.d6a(a.Pf);if(b.WRc&&!b.value&&(u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Ic.r2g))return 3;this.Fg.ZW(new cC(b.value,Yg.Nx(a)));this.mC(Object(C.a)(this.Fg,this.Fg.YW,"onTableRowEnd"));return 1}z8c(){return this.gq(a=>
a.ZHa("consolas"))?1:2}A8c(){return this.gq(a=>a.e0(!0))?1:2}B8c(a){return this.d1b(a,!1)}E8c(){return this.gq(a=>a.e0(!0))?1:2}static q0i(a){return a?a.split(",")[0]:null}static qml(a){if(!a)return null;a=Ja.a.jDe(a,'"');return a=Ja.a.jDe(a,"'")}static $8f(a){if(!a)return null;a=Fk.q0i(a);return a=Fk.qml(a)}static sBf(a,b){b=b.trim();var c=b.match(RegExp("^-?[0-9]+deg$"));if(c&&0<c.length){if(a.Zhg())return!1;a.direction=b;return!0}if((c=b.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&
0<c.length){if(a.Zhg())return!1;a.direction=b;return!0}var f=(c=b.match(RegExp("^rgb\\(.*\\)")))&&0<c.length?b.indexOf(")")+1:b.indexOf(" ");c=-1===f?b:Kg.dha(b.substr(0,f).trim());if(!c||""===c)return!1;b=-1===f?"":b.substr(f).trim();f=new pH;f.color=c;f.stop=b;a.cVb.add(f);return!0}static afj(a){try{if(!a)return null;a=a.trim();if(!a.startsWith("linear-gradient(")||!a.endsWith(")"))return null;let b=a.substr(16);b=b.substr(0,b.lastIndexOf(")"));const c=new rH;for(;0<b.trim().length;){let f=b.indexOf(",");
const l=b.indexOf("(");if(0<l&&l<f){const w=b.indexOf(")");if(w<l)return null;f=b.indexOf(",",w)}if(-1===f){if(!Fk.sBf(c,b))return null;b=""}else{const w=b.substr(0,f);b=b.substr(f+1);if(!Fk.sBf(c,w))return null}}return c}catch(b){return null}}static xNc(a,b){a=a.split(" ");if(0<a.length)for(let c=0;c<a.length;c++)if(0<=a[c].indexOf(b))return a[c];return""}static TCc(a,b=!1){a&&3!==a.nodeType&&(a.style.margin="",b&&Fk.AMf(a,b))}static AMf(a,b){if(a)for(a=a.firstChild;a;)3!==a.nodeType&&(a.style&&
(a.style.margin=""),b&&Fk.AMf(a,b)),a=a.nextSibling}static j4i(a){if("p"!==a.tagName.toLowerCase())return-1;if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf("mso-list")){a=a.split(";");for(let c=0;c<a.length;c++){var b=a[c].split(":");if(2===b.length&&"mso-list"===b[0].trim()&&(b=b[1].trim().split(" "),3===b.length))return Number.parseInvariant(b[1].substr(5))}}return-1}static CMj(a){return!(void 0===a.className||null===a.className)&&a.className.startsWith("TextRun")}static hdj(a){a=a.style.textDecorationLine;
return void 0===a||null===a?null:a}static ztg(a){return 0<=a.indexOf("line-through")}static mD(a){return 0<=a.indexOf("underline")}}Fk.Hhl=(Or=new Ua.a,Or.add("TABLE"),Or.add("THEAD"),Or.add("TBODY"),Or.add("TFOOT"),Or.add("TR"),Or.add("TH"),Or.add("TD"),Or);Object(e.a)(Fk,"DefaultHtmlTranslator",Yg,[]);var Km=d(306);class Tj{constructor(a=null){this.yR=a||Km.a.Q1d("");this.fuc=Number.parseInvariant((new Date).format("HHmmss"))}get Gb(){return this.yR}process(a,b){if(a&&a.querySelectorAll){const w=
a.querySelectorAll("p");if(w&&0<w.length){for(var c=0,f=!1,l=w[0].parentNode;5>c&&l&&l!==a;){c++;const F=l.id.toLowerCase();if(F&&F.length&&-1!==F.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(l,"WACEditing")&&Sys.UI.DomElement.containsCssClass(l,"EditingSurfaceBody")){f=!0;break}l=l.parentNode}if(f&&l!==a){c=a.firstChild;for(f=!1;0<l.children.length&&l.children[0]!==c;)a.insertBefore(l.children[0],c),f=!0;if(f)for(;c;)l=c.nextSibling,a.removeChild(c),c=l}a=new Tb.a(b,Object(C.a)(this,
this.Bze,"processNodesDiscovery"),new YB(w));a.vl("Word Converter Operation");a.Ui=!b||b.Ui;a.run()}}}Bze(a,b){const c=b.nodes[b.O1];var f=Tj.BZd(c);if(f){let w=f.zJa.replace(RegExp("level[0-9]"),"").trim();w=w&&w.length?w:f.zJa;let F=b.lists[w];F||(F=new kH,F.NX=this.fuc++);let S=F.Nvb[f.level-1];S||(S=new lH,S.level=f.level);var l=c.parentNode;if(l&&"li"===l.tagName.toLowerCase()){if(l=l.parentNode)!(l=l.tagName.toUpperCase())||"OL"!==l&&"UL"!==l||(S.tagName=l)}else S.pVa=Tj.G8f(c,5),S.pVa&&S.pVa.length||
(S.pVa=Tj.Y0d(c,5)),S.ignore=!S.pVa||!S.pVa.length,S.tagName=Tj.qLc(S.pVa);f.NX=F.NX;S.occ++;S.ignore||"li"===c.parentNode.tagName.toLowerCase()||(l=(l=Tj.Y0d(c,5))?l:S.pVa)&&l.length&&(f.VNi=l,(l=Tj.I0k(c,l,S.listStyle,f.level-1))&&l.length&&(S.listStyle=l));b.Q7[b.Q7.length]=f;S.Q7.contains(f)||S.Q7.add(f);if(void 0===F.Nvb[f.level-1]||null===F.Nvb[f.level-1]||F.Nvb[f.level-1]!==S)F.Nvb[f.level-1]=S;b.lists[w]&&b.lists[w]===F||(b.lists[w]=F);b.Evb=c}else if((f=b.Evb)&&Tj.M_b(c)===f&&c.tagName===
f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.O1++;if(b.nodes.length<=b.O1){if(!b.Q7.length)return!1;b.O1=0;a.Wg(Object(C.a)(this,this.Aze,"processNodeConvert"))}return!0}Aze(a,b){a=b.Q7[b.O1];var c=a.Gdc,f=a.zJa.replace(RegExp("level[0-9]"),"").trim();f=f&&f.length?f:a.zJa;f=b.lists[f];var l=f.Nvb[a.level-1],w=c.parentNode.tagName.toLowerCase();
if(!l.ignore&&c.parentNode&&"li"!==w){if(w=Tj.Dwi(c,l)){Tj.HUb(c,5);const F=c.ownerDocument.createElement("LI");F.setAttribute("data-aria-level",String.format("{0}",a.level));for(F.setAttribute("data-listid",String.format("{0}",f.NX));c.firstChild;)F.appendChild(c.firstChild);w.appendChild(F);c.parentNode.removeChild(c);"UL"===l.tagName?this.Gb.b++:this.Gb.c++}}else"li"===w&&(l=l.tagName,c=c.parentNode,a.ICb&&(a=c.parentNode)&&a.tagName.toUpperCase()===l&&a.setAttribute("data-pasteFromRc","true"),
c.setAttribute("data-listid",String.format("{0}",f.NX)),"UL"===l?this.Gb.b++:this.Gb.c++);b.O1++;return b.O1<b.Q7.length}static Dwi(a,b){a=Tj.Awi(a,b.tagName);return Tj.MNd(a,b)}static MNd(a,b){if(b.tagName!==a.tagName){for(b=a.ownerDocument.createElement(b.tagName);a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static Awi(a,b){b=a.ownerDocument.createElement(b?b:"UL");var c=a.getAttribute("start");c&&0<c.length&&(b.setAttribute("start",
c),a.removeAttribute("start"));(c=a.className)&&0<c.length&&(c="OL"===b.tagName?Fk.xNc(c,"NumberListStyle"):Fk.xNc(c,"BulletListStyle"),0<c.length&&(Sys.UI.DomElement.addCssClass(b,c),Sys.UI.DomElement.removeCssClass(a,c)));a.parentNode.insertBefore(b,a);return b}static HUb(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&Tj.HUb(f,b-1);if(Tj.j8d(f)||Tj.v3b(f))a.removeChild(f),c--}}static BZd(a){if(1===a.nodeType){var b=Tj.m0b(a,"mso-list");if(b&&0<b.length)try{var c=
b.split(" ");if(3===c.length){var f=new Vy;f.level=Number.parseInvariant(c[1].substr(5));f.zJa=b;f.Gdc=a;f.ICb=!0;return f}}catch(l){}else if((c=a.parentNode)&&"li"===c.tagName.toLocaleLowerCase()&&(b=c.getAttribute("data-"+re.a.kTb),c=c.getAttribute("data-listid"),b&&c&&0<b.length&&0<c.length))return f=new Vy,f.level=Number.parseInvariant(b),f.zJa=c+" level"+b,f.Gdc=a,f.ICb=!1,f}return null}static I0k(a,b,c,f){if("p"===a.tagName.toLowerCase()&&b&&b.length){if("UL"===Tj.qLc(b))return c=Tj.$Wi(b),
Sys.UI.DomElement.addCssClass(a,c),c;var l;return(l=b.match(RegExp("^[0-9]+")))&&l.length?(c="NumberListStyle1",Sys.UI.DomElement.addCssClass(a,c),a.setAttribute("start",l[0]),c):(l=b.match(RegExp("^[a-zA-Z]+")))&&l.length&&(l=l[0],f=(b=l.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&b.length?Tj.C9i(c,f):1,1!==f&&((c=Tj.fEc(a,l,RegExp("^[ivxlcdm]+"),Ja.a.SPf,"NumberListStyle3"))||(c=Tj.fEc(a,l,RegExp("^[IVXLCDM]+"),Ja.a.SPf,"NumberListStyle5")))||f&&((c=Tj.fEc(a,l,RegExp("^[a-z]+"),Ja.a.RPf,"NumberListStyle2"))||
(c=Tj.fEc(a,l,RegExp("^[A-Z]+"),Ja.a.RPf,"NumberListStyle4"))))?c:"NumberListStyle1"}return null}static $Wi(a){switch(a){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static C9i(a,b){a&&a.length||(a="");switch(a){case "NumberListStyle2":case "NumberListStyle4":a=1;break;case "NumberListStyle3":case "NumberListStyle5":a=0;break;default:a=-1}if(0>a)switch(b%3){case 0:a=0;break;case 1:a=1;break;case 2:a=0;break;default:a=0}return a}static fEc(a,
b,c,f,l){return(b=b.match(c))&&b.length?(f=f(b[0]),f=1>f?1:f,Sys.UI.DomElement.addCssClass(a,l),a.setAttribute("start",f+""),l):null}static qLc(a){return a&&"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static Y0d(a,b){let c=null;var f;let l,w;for(let F=-1;!c&&F<a.childNodes.length;F++){const S=-1===F?a:a.childNodes[F];if(S)if((f=S.innerHTML)&&0<f.length){if(l=f.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=l&&(w=f.indexOf("\x3c!--[endif]--\x3e"),0<=w)){f=f.substring(l,w+14);S.innerHTML=
S.innerHTML.replace(f,"");if(f.length){a=a.ownerDocument.createElement("span");a.innerHTML=f;c=a.innerText.trim();break}c&&c.length||(c="o")}}else 0<=F&&1===S.nodeType&&1<b&&(c=Tj.Y0d(S,b-1))}return c}static G8f(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];Tj.v3b(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o"),l.parentNode.removeChild(l)):1===l.nodeType&&1<b&&(c=Tj.G8f(l,b-1))}return c}static v3b(a){return 1===a.nodeType&&
(a=Tj.m0b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static j8d(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static m0b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static M_b(a){do a=a.previousSibling;while(a&&Tj.i3b(a));return a}static i3b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(Tj.uwd,
""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:Tj.i3b(a.firstChild):!0}}Tj.uwd=RegExp("[\n|\r]","gi");Object(e.a)(Tj,"WacAndRichClientWordConverter",null,[774]);class uH{constructor(){this.NX=0;this.tagName="UL";this.YYb=null;this.ignore=!1;this.occ=0}}Object(e.a)(uH,"ListMetadata",null,[]);class dl{constructor(a=null){this.fuc=1;this.yR=a||Km.a.Q1d("")}get Gb(){return this.yR}process(a,b){a&&a.querySelectorAll&&(a=a.querySelectorAll("p"))&&
0<a.length&&(a=new Tb.a(b,Object(C.a)(this,this.Bze,"processNodesDiscovery"),new YB(a)),a.vl("Word Converter Operation"),a.Ui=!b||b.Ui,a.run())}Bze(a,b){const c=b.nodes[b.O1];var f=dl.BZd(c);if(f){let l=b.lha[f.level-1];l||(l=new XB,b.lha[f.level-1]=l);b.Evb&&dl.M_b(c)!==b.Evb&&dl.RQk(b);let w=l.mzg[f.zJa];if(!w)w=new uH,w.NX=this.fuc++,w.YYb=dl.vYd(c,5),w.ignore=!w.YYb||!w.YYb.length,w.tagName=dl.qLc(w.YYb),l.mzg[f.zJa]=w,b.lists[w.NX.toString()]=w;else if(!w.ignore&&1===w.occ){const F=dl.vYd(c,
5);w.tagName=w.YYb===F?"UL":"OL"}f.NX=w.NX;w.ignore||"OL"===w.tagName&&0<w.occ&&l.wFc!==f.NX?(w.ignore=!0,b.lha[0].wFc=-1,b.lha=b.lha.slice(0,1)):(b.lha.length>f.level&&(b.lha=b.lha.slice(0,f.level)),l.wFc=f.NX,b.Q7[b.Q7.length]=f,w.occ++);b.Evb=c}else if((f=b.Evb)&&dl.M_b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.O1++;
if(b.nodes.length<=b.O1){if(!b.Q7.length)return!1;b.O1=0;a.Wg(Object(C.a)(this,this.Aze,"processNodeConvert"))}return!0}Aze(a,b){var c=b.Q7[b.O1];a=c.Gdc;const f=b.lists[c.NX.toString()];if(!f.ignore&&(c=dl.L6i(a,c,f))){dl.HUb(a,5);const l=a.ownerDocument.createElement("LI");for(;a.firstChild;)l.appendChild(a.firstChild);c.appendChild(l);a.parentNode.removeChild(a);"UL"===f.tagName?this.Gb.b++:this.Gb.c++}b.O1++;return b.O1<b.Q7.length}static L6i(a,b,c){let f=dl.u$g(a,b.level,c);const l=K.a.te(f,
"UniqueListId");if(l&&l!==b.NX||!l&&f.firstChild)a=a.ownerDocument.createElement(c.tagName),f.parentNode.insertBefore(a,f.nextSibling),f=a;K.a.nv(f,"UniqueListId",b.NX);return dl.MNd(f,c)}static MNd(a,b){if(b.tagName!==a.tagName){b=a.ownerDocument.createElement(b.tagName);for(K.a.nv(b,"UniqueListId",K.a.te(a,"UniqueListId"));a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static u$g(a,b,c){let f=null,l;1===b?l=dl.M_b(a):(f=dl.u$g(a,
b-1,null),l=f.lastChild);if(l&&1===l.nodeType){const w=l.tagName.toUpperCase();if("UL"===w||"OL"===w)return l}c=a.ownerDocument.createElement(c?c.tagName:"UL");1===b?a.parentNode.insertBefore(c,a):f.appendChild(c);return c}static HUb(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&dl.HUb(f,b-1);if(dl.j8d(f)||dl.v3b(f))a.removeChild(f),c--}}static BZd(a){if(1===a.nodeType){const b=dl.m0b(a,"mso-list");if(b&&0<b.length)try{const c=b.split(" ");if(3===c.length){const f=
new Vy;f.level=Number.parseInvariant(c[1].substr(5));f.zJa=b;f.Gdc=a;return f}}catch(c){}}return null}static qLc(a){return"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static vYd(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];dl.v3b(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o")):1===l.nodeType&&1<b&&(c=dl.vYd(l,b-1))}return c}static v3b(a){return 1===a.nodeType&&(a=dl.m0b(a,"mso-list"))&&0<a.length&&"ignore"===
a.trim().toLowerCase()?!0:!1}static j8d(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static m0b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static M_b(a){do a=a.previousSibling;while(a&&dl.i3b(a));return a}static i3b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(dl.uwd,""),!a.trim().length):1!==a.nodeType||
a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:dl.i3b(a.firstChild):!0}static RQk(a){for(let b=0;b<a.lha.length;b++){const c=a.lha[b];c&&(c.wFc=-1)}}}dl.uwd=RegExp("[\n|\r]","gi");Object(e.a)(dl,"WordConverter",null,[774]);class eC{constructor(a){this.y_a=a.ka("ExternalPasteImprovementsEnabled")&&a.ka("ListMarkerIsEnabled")}get Y4a(){return this.y_a}create(a=null){return this.y_a?new Tj(a):new dl(a)}}Object(e.a)(eC,"Box4WordConverterFactory",null,[738]);var vH=d(686);class wH{constructor(a,
b,c,f,l){this.O0e=0;this.ld=a;this.qd=b;this.Eib=l;this.oY=c;this.hMa=f}aki(a,b,c){Z.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",b,c,this.qd.ey);a.Ui&&this.qd.Gj&&window.chrome&&Z.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",b);this.oY.iba(!!(b&16));this.hMa.create(a,Object(C.a)(this,this.NTe,"waitingForEnsureAccessOperationResult"),null).vl("ClipboardPreProcess");this.O0e=Date.now()}sRk(){this.oY.reset()}NTe(a){let b=
!0;const c=this.oY.tKi,f=null==this.oY.$Ji;null!=c?(a.h4=c,b=!1):Date.now()-this.O0e>this.Eib&&!f&&(Z.ULS.sendTraceTag(18354843,307,50,null),this.ld.Vb(zd.a.Fha,{["Reason"]:Hd.a.T0g}),b=a.h4=!1);return b}}Object(e.a)(wH,"ClipboardOperationClipboardAccessHelper",null,[584]);class Yy{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc){this.Da=a;this.ld=b;this.Dr=c;this.xi=f;this.Rc=l;this.oY=w;this.Tq=F;this.ef=S;this.Ufa=fa;this.EJ=xa;this.Vfa=Za;this.alb=pb;this.s1a=Mb;this.jk=kc;this.bNb=hc?hc.ka("ImageDataURLSkippedForSafari12IsEnabled"):
!1;this.xNb=hc?hc.ka("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.KNb=hc?hc.ka("TextLayoutServiceUseResponse"):!1}get Lh(){return this.xi}get Uc(){return this.ld}yxl(a){a.CJa();return!0}fQf(a,b){a=b.vw;Z.ULS.shipAssertTag(18130960,307,!!(a&16));if(a&256){r.a.psa&&u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");let c=null;b.Gf&&b.Gf.xg&&(c=b.Gf.xg.vn);let f=!1;this.bNb&&r.a.psa&&this.jk.Scd(c,"data-src","data-srcurl");this.xNb&&(f=this.jk.rUb(b.Gf.xg.vn,
b.Gf.Ed,!0));this.KNb&&this.jk.Cld(c,!1);a=this.oY.copy();this.bNb&&r.a.psa&&this.jk.Scd(c,"data-srcurl","data-src");this.xNb&&f&&this.jk.rUb(b.Gf.xg.vn,b.Gf.Ed,!1);this.KNb&&this.jk.Cld(c,!0);if(!a)return Z.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Uc.Vb(zd.a.d5a,{["Reason"]:Hd.a.aOe}),b.E_&&b.E_.fail("SystemClipboard did not copy",!1),b.failed=!0,!1}return!0}JVb(a,b){const c=b.Gf;Z.ULS.shipAssertTag(18130961,307,!!(b.vw&16));b.hbl?this.Dr.GMf():this.Dr.VNd(c,a);return!0}TFc(a,
b){var c=b.context,f=b.od;const l=b.XI;var w=!1;a=this.Rc.Pa.kb.We;if(this.Tq.Tl(a)||this.ef.Bl(a)){const F=this.EJ.Jc(a.node);let S=F.af();Z.ULS.shipAssertTag(18130962,307,S);this.Ufa.Ke(F);this.Vfa.r8a(F)&&(w=!0)}f=b.vw&64?new H.DictionaryPropertySet:f||new H.DictionaryPropertySet;f.setValue(Kd.a.Upb,!1);c=this.Da.li(c,D.a.dK,2,!0,l,f);8===c&&(Z.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Uc.Vb(zd.a.Fha,{["Reason"]:Hd.a.AUf}),b.E_&&b.E_.fail("DeleteKey failed",!1),b.failed=!0);32===
c&&w&&(b=this.Rc.Pa.kb,this.ef.Ew(b)&&b.Wa.node===a.node&&!this.Tq.textLength(b.Wa.node)&&(b=this.EJ.Jc(b.Wa.node),a=this.ef.Rs(b),Z.ULS.shipAssertTag(18130964,307,a),this.Ufa.Ke(b),this.Vfa.jub(b)||(a=this.alb.create(),a.Pc(b),this.Ufa.Jua(a,!1,!1),w=this.Ufa.ti(a),this.Tq.Pd(w)&&(this.Ufa.Ke(a),this.Lh.merge(a,b,!1,!1),this.Rc.setSelection(this.s1a.Lg(w,this.Tq.textLength(w)))))));return!0}}Object(e.a)(Yy,"ClipboardOperationCutCopy",null,[771]);class xH{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,
hc,kc){this.Da=a;this.ld=b;this.Dr=c;this.oY=w;this.Rc=l;this.xi=f;this.Tq=F;this.ef=S;this.Ufa=fa;this.EJ=xa;this.Vfa=Za;this.alb=pb;this.s1a=Mb;this.mb=hc;this.jk=kc}create(){return new Yy(this.Da,this.ld,this.Dr,this.xi,this.Rc,this.oY,this.Tq,this.ef,this.Ufa,this.EJ,this.Vfa,this.alb,this.s1a,this.mb,this.jk)}}Object(e.a)(xH,"Factory",null,[312]);class yH{Tmh(){return!0}}Object(e.a)(yH,"ClipboardOperationCutStrategy",null,[332]);var Es=d(460),fC=d(1175),gC=d(223);class Yo{constructor(a,b,c,f,
l,w=null,F="",S=!0){this.Nqa=this.Vhd=this.mWa=this.Vcd=null;this.z3b=!1;this.Y4d=null;this.kte=0;this.context=a;this.Gf=a.view;this.vw=b;this.od=l;this.E_=c;this.XI=f;this.gFb=this.failed=!1;this.K8c=null;this.$7a=this.Hub=!1;this.hbl=Yo.BNd(a);this.browserName=F;this.GBh=S;this.tJa=!1;this.KNa=0;this.mMd=Fa.a.create().toString();if(a=Object(Ca.a)(10,l)?l:null){this.mWa=new H.DictionaryPropertySet;this.mWa.px(a);if(a.ta(Kd.a.v9c,!1)){this.Hub=!0;this.$7a=a.ta(Kd.a.$7a,!1);this.K8c=w;for(w=this.Gf.Eb.Dj;w.Cw;)w=
w.getContext(0);if(l=Object(ua.a)(Wc.AParagraphNode,w.node)){c=0;f=db.ParagraphReader.textLength(l);switch(w.contextId){case Db.a.textRange:c=w.Qa;f=w.Lb;break;case Db.a.endOfParagraph:c=f}this.Vcd=Ab.a.k1i(w.node,c);Z.ULS.shipAssertTag(6305503,307,!!this.Vcd);l=fb.HyperlinkReader.o_b(l);for(const fa of l)fa.Lb<=c||fa.Qa>=f||Yo.hyperlinkEditor.jO(w.node,fa.hyperlink)}}this.gFb=a.ta(Kd.a.gFb,!1);this.tJa=a.ta(Kd.a.tJa,!1)}b&64&&(this.gFb=!0)}static get Uc(){return cd.a.instance}static get hyperlinkEditor(){return Yo.Tm||
(Yo.Tm=lb.a.instance.resolve("Box4.IHyperlinkEditor"))}static BNd(a){if(a){if(a.Cw){for(let b=0;b<a.length;b++)if(Yo.BNd(a.getContext(b)))return!0;return!1}if(Object(Ca.a)(gC.a,a))return Yo.BNd(a.HD);if(db.ParagraphReader.Pd(a.node)&&a.node.BB)return!0}return!1}}Yo.Tm=null;Object(e.a)(Yo,"ClipboardActionArguments",null,[]);var fv;(function(a){a[a.paste=1]="paste";a[a.textOnly=2]="textOnly";a[a.overtype=4]="overtype";a[a.copy=16]="copy";a[a.deleteSelection=32]="deleteSelection";a[a.move=64]="move";
a[a.useSystemClipboard=256]="useSystemClipboard";a[a.forceInternalClipboard=512]="forceInternalClipboard";a[a.reformatPastedContent=4096]="reformatPastedContent";a[a.pasteAsPlainText=8192]="pasteAsPlainText";a[a.showPlaceholderGlossary=65536]="showPlaceholderGlossary"})(fv||(fv={}));Object(e.b)("ClipboardActionFlags",fv);const zH=a=>{a=a.Pa.clone();const b=[];for(let c=0;c<a.length;c++)Array.addRange(b,a.ga(c).toArray());return b},AH=a=>{const b={};let c;for(let f=0;f<a.length;f++)c=Object.getType(a[f].node).getName(),
b[c]=b[c]?b[c]+1:1;a="";for(let f in b)a+=b[f]+" "+f+" elements,";return a=a.substring(0,a.length-1)};class BH extends Es.a{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig=!0){super();this.mBd=this.caa=this.u5=this.pB=null;this.init(a);this.vl("ClipboardOperation");this.ACa(fa,b,l,w,F);this.ld=xa;this.ef=Za;this.qd=pb;this.kk=Mb;this.BXe=hc;this.EXe=kc;this.CXe=Ec;this.FXe=Hc;this.ppc=Dc;this.Ipd=Td;this.HKb=S;this.yKb=we;this.hMa=Pd;this.uWh=Ig;this.PC=He;this.Yc=
Pe;this.ls=Df;this.uoa=ig;this.yu=f;this.hza=Tg;F&&Object(Ca.a)(10,F)&&(this.caa=Object(ua.a)(776,F.ta(Kd.a.zNa,null)));this.caa||(this.caa=this.hza.KMe());this.zZa=void 0===c||null===c?"NotAvailable":Object(fC.a)(fv,c);this.caa.m7h(this.zZa.split(", "));a=this.yu;a.view.Jh?(this.Gg=a.view,this.Gg.Eb?(this.vH=0,this.iU=c,this.Tlb=Hc.JCb,!Ig||this.Tlb&&this.Tlb.kb&&this.Tlb.length?(Hc=Cb.SelectionEditor.Ew(this.Tlb.kb),Hc=!(this.iU&16&&Hc),Hc=Td.BBj(c,this.Dj)&&Hc,1!==this.behavior&&Hc||(Hc||this.caa.fail("Clipboard operation disabled for selection",
!0),this.Zo=Hc?32:8,this.sX())):(this.ld.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),this.caa.fail("No selection when one required",!0),this.Zo=8,this.finish())):(this.ld.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),this.caa.fail("No selection manager",!1),this.Zo=8,this.finish())):(this.ld.Vb(zd.a.qh,{["Reason"]:Hd.a.M5c}),this.caa.fail("Not in interactive view",!0),this.Zo=8,this.finish())}get Dj(){this.mBd||(this.mBd=dd.a.Snb(this.Tlb));return this.mBd}O_(){super.O_();this.Tlb=null}run(){0===this.vH&&
this.setup();1===this.vH&&this.process();2===this.vH&&this.teardownSync();3===this.vH&&this.teardownAsync();4===this.vH&&this.finish()}setup(){if(this.iU&256&&this.HKb){this.nz||this.ppc.aki(this,this.iU,this.zZa);this.nz.run();if(this.nz.inProgress)return;const a=this.nz.h4;this.OCc();if(!a){this.caa.fail("No access to system clipboard",!0);this.Zo=8;this.vH=4;this.oTj();return}}else Z.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",this.iU,this.zZa,this.qd.ey);
this.iU&32&&!this.ef.sRc(this.Gg.Eb.Dj)?(Z.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.ld.Vb(zd.a.qh,{["Reason"]:Hd.a.YPd}),this.caa.fail("Cut not allowed",!0),this.yKb.show(),this.Zo=8,this.vH=4):(this.iU&4096&&(this.uoa.BBe(Object.assign(new ij,{Bsg:!0,q2g:this.zZa})),this.ls.undo()),this.Ipd.Xwk(this.iU),this.pB=this.kk.ie(15),this.pB.hd(this.Gg.ug),this.vH=1)}process(){if(!this.nz){Z.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.iU,this.zZa,
this.qd.ey);Z.ULS.shipAssertTag(6305507,307,!this.u5);this.u5=new Yo(this.yu,this.iU,this.caa,this.XI,this.hU,void 0,this.qd.ey,this.uWh);let a;a=this.iU&65536?Object(C.a)(this.BXe,this.BXe.process,"process"):this.iU&64?Object(C.a)(this.EXe,this.EXe.process,"process"):this.iU&1?Object(C.a)(this.FXe,this.FXe.process,"process"):Object(C.a)(this.CXe,this.CXe.process,"process");this.iU&16&&this.Gg.Eb.ana.dWd();this.hMa.create(this,a,this.u5).vl("ClipboardAction")}Z.ULS.shipAssertTag(6305536,307,!!this.nz);
this.nz.run();this.nz.inProgress||(this.OCc(),this.vH=this.Ui?2:3)}teardownSync(){this.u5.Hub&&(this.pB.fd=D.a.typing);this.u5.z3b&&this.pB.r4c(this.u5.Y4d,this.u5.kte);this.pB.dispose();this.Zo=this.u5.failed?8:32;this.vH=4}teardownAsync(){if(this.nz){if(this.nz.run(),this.nz.inProgress)return}else if(this.u5.Hub&&(this.pB.fd=D.a.typing),this.pB.JT(this),this.u5.z3b&&this.pB.r4c(this.u5.Y4d,this.u5.kte),this.pB.dispose(),this.Iyc)return;this.Zo=this.u5.failed?8:32;this.vH=4}finish(){this.uoa.BBe(Object.assign(new ij,
{Bsg:!1}));this.sX();32===this.response?Z.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.iU,this.zZa,this.qd.ey):Z.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.iU,this.zZa,this.qd.ey);this.hza.bBa(this.caa)}oTj(){var a=!!(this.iU&1),b=this.yu.view;if(b){var c=b.Eb;b=this.qd.ey;u.AFrameworkApplication.Va.processAction(D.a.qTf,
2);a?Z.ULS.sendTraceTag(18617483,307,50,"CopyPasteShortcutDialog showed for paste operation in {0}.",b):(Z.ULS.sendTraceTag(18617484,307,50,"CopyPasteShortcutDialog showed for copy operation in {0}.",b),a=zH(c),1===a.length?Z.ULS.sendTraceTag(18425100,307,50,"CopyPasteShortcutDialog showed for copying 1 {0} element in {1}.",Object.getType(a[0].node).getName(),b):(c=AH(a),Z.ULS.sendTraceTag(18425101,307,50,"CopyPasteShortcutDialog showed for copying {0} elements: {1} in {2}.",a.length,c,b)))}}}Object(e.a)(BH,
"ClipboardOperation",Es.a,[]);class CH{constructor(a,b){this.Fpc=null;this.Dr=a;this.nU=b;this.kB=0}process(a,b){this.kB||(this.Fpc=[Object(C.a)(this,this.fti,"copyGlossarySelection"),Object(C.a)(this.nU,this.nU.rrk,"pasteGlossaryPlaceholder")]);let c=!0;this.kB<this.Fpc.length&&(c=this.Fpc[this.kB++](a,b));return c?this.kB<this.Fpc.length:!1}fti(a,b){if(!Object(Ca.a)(10,b.od))return!1;const c=Object(ua.a)(10,b.od);if(!c.Sa(Kd.a.lfg))return!1;const f=c.getValue(Kd.a.lfg),l=b.Gf,w=l.Eb;this.Dr.$ul();
w.Zdd(()=>{w.setSelection(f,void 0,!0);this.Dr.VNd(l,a)},!0);return!0}}Object(e.a)(CH,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[775]);class DH{constructor(a){this.h_a=null;this.ZQ=a;this.kB=-1}process(a,b){-1===this.kB&&(this.lBi(a,b),this.kB=0);let c=!1;this.kB<this.h_a.length&&(c=this.h_a[this.kB++](a,b));return c?this.kB<this.h_a.length:!1}lBi(a,b){r.a.G7||b.vw&512?(this.h_a=[Object(C.a)(this.ZQ,this.ZQ.JVb,"copyInternal")],Z.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):
!a.Ui&&b.vw&256?(this.h_a=[Object(C.a)(this.ZQ,this.ZQ.yxl,"waitBeforeCopy"),Object(C.a)(this.ZQ,this.ZQ.fQf,"copyExternal"),Object(C.a)(this.ZQ,this.ZQ.JVb,"copyInternal")],Z.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.h_a=[Object(C.a)(this.ZQ,this.ZQ.fQf,"copyExternal"),Object(C.a)(this.ZQ,this.ZQ.JVb,"copyInternal")],Z.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
b.vw&32&&(a=Object(C.a)(this.ZQ,this.ZQ.TFc,"deleteForCut"),this.h_a.push(a),Z.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));a=b.browserName;Z.ULS.sendTraceTag(18617485,307,50,"Copy operation in {0}.",a);if(b.Gf)if(b=zH(b.Gf.Eb),1===b.length)Z.ULS.sendTraceTag(18425102,307,50,"Copy 1 {0} element in {1}.",Object.getType(b[0].node).getName(),a);else{const c=AH(b);Z.ULS.sendTraceTag(18425103,307,50,"Copy {0} elements: {1} in {2}.",b.length,
c,a)}}}Object(e.a)(DH,"ClipboardOperationCutCopyProcessor",null,[772]);class EH{constructor(a,b,c,f){this.auc=null;this.Dr=a;this.Rc=b;this.ZQ=c;this.nU=f;this.kB=0}process(a,b){this.kB||(this.auc=[Object(C.a)(this,this.jti,"copyMovedSelection"),Object(C.a)(this.ZQ,this.ZQ.TFc,"deleteForCut"),Object(C.a)(this,this.BSg,"moveIp"),Object(C.a)(this.nU,this.nU.y2g,"pasteInternal"),Object(C.a)(this.nU,this.nU.Rkh,"setSelectionAfterPaste")]);let c=!0;this.kB<this.auc.length&&(c=this.auc[this.kB++](a,b));
return c?this.kB<this.auc.length:!1}jti(a,b){b=b.Gf;this.Dr.Nul();this.Dr.VNd(b,a);return!0}BSg(a,b){b=new nb.Selection([b.od],!0);this.Rc.setSelection(b,a);return!0}}Object(e.a)(EH,"ClipboardOperationMoveProcessor",null,[770]);class FH{constructor(a,b,c,f,l,w){this.Ryd=null;this.vpf=0;this.ld=f;this.qd=b;this.nU=l;this.qtd=c;this.HKb=u.AFrameworkApplication.chd()&&!(r.a.sS&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix"));this.Eib=a.appSettings.ChromeClipboardAccessOperationTimeout;this.kB=
0;this.sHh=w}get JCb(){return this.nU.JCb}process(a,b){if(0===this.kB)return this.zrk(b);if(1===this.kB)return this.prepareForPaste(a,b);if(2===this.kB)return this.kB=3,this.Ryd(a,b);3===this.kB&&this.nU.Rkh(a,b);return!1}zrk(a){this.qd.G7||a.vw&512?(this.Ryd=a.vw&2?Object(C.a)(this.nU,this.nU.paste,"paste"):Object(C.a)(this.nU,this.nU.y2g,"pasteInternal"),this.kB=2):(this.HKb?(this.kB=1,this.vpf=Date.now()):this.kB=2,this.Ryd=Object(C.a)(this.nU,this.nU.paste,"paste"));Z.ULS.sendTraceTag(18617486,
307,50,"Paste operation in {0}.",a.browserName);return!0}prepareForPaste(a,b){a=!0;if(this.qtd.value.$4g())this.kB=2;else{const c=Date.now()-this.vpf;c>this.Eib&&(Z.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",c),this.ld.Vb(zd.a.Fha,{["Reason"]:Hd.a.T0g}),b.E_&&b.E_.fail("Prepare for paste timed out",!1),b.failed=!0,a=!1,this.sHh.sRk())}return a}}Object(e.a)(FH,"ClipboardOperationPasteProcessor",null,[769]);class GH{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc){this.Dr=a;this.Da=
b;this.HKb=c;this.ld=f;this.ef=l;this.qd=w;this.kk=F;this.wHh=S;this.uHh=fa;this.ppc=xa;this.Ipd=Za;this.yKb=pb;this.hMa=Mb;this.PC=hc;this.Yc=kc;this.ls=Ec;this.uoa=Hc;this.hza=Dc}create(a,b,c,f,l,w,F,S,fa=!0){const xa=this.wHh.create(f,Object(ua.a)(10,S));var Za=this.uHh.create();const pb=new CH(this.Dr,xa),Mb=new EH(this.Dr,dd.a.instance,Za,xa);Za=new DH(Za);f=new FH(u.AFrameworkApplication.fa,Ta.a.instance,f,cd.a.instance,xa,this.ppc);return new BH(a,b,c,l,w,F,S,this.HKb,this.Da,this.ld,this.ef,
this.qd,this.kk,pb,Mb,Za,f,this.ppc,this.Ipd,this.yKb,this.hMa,this.PC,this.Yc,this.ls,this.uoa,this.hza,fa)}}Object(e.a)(GH,"Factory",null,[586]);class Zy{constructor(a,b){this.O6a=a.CLc(b);this.bOd=a.tZi(b);this.y3a=a.EKc(b);this.eNa=a.sKc(b)}static kV(a){return Zy.Xq(a)}static Xq(a){return new Zy(cg.a.instance,a)}}Object(e.a)(Zy,"CpUsageHelper",null,[]);var Fs=d(171);class HH{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb){this.ld=a;this.Dr=b;this.oPb=c;this.oaa=f;this.Rc=l;this.Da=w;this.qtd=F;this.wRb=
fa;this.Uyd=S;this.$qd=xa;this.Hpd=Za;this.Yc=pb}get ln(){return this.wRb.value}get o$(){return this.oaa}get Uc(){return this.ld}get JCb(){return this.Uyd.JCb}paste(a,b){const c=this.Yc.Dnb();try{const f=b.Gf;Z.ULS.shipAssertTag(18131010,307,!!(b.vw&1));Object(Ca.a)(10,b.od)&&b.od.setValue(Fs.a.KXb,f.xg.vn.clientWidth);this.Hpd.qol(a,b);let l;if(!({bEc:l}=this.qtd.value.Qwh()).returnValue)return b.E_&&b.E_.fail("HTML import strategy failed",!1),b.failed=!0,!1;this.ln.Mv();let w=!0,F=null;const S=
this.$qd.create(l),fa=b.GBh;f.Eb.Zdd(()=>{fa&&2===this.Da.processAction(D.a.HAa,2)?w=!1:(F=fa?this.Rc.Pa.kb.Wa:b.od,Z.ULS.shipAssertTag(18158338,307,Cb.SelectionEditor.Mg(F)),this.jAg(F,"paste"))},this.Uyd.Jug);if(!w)return!1;f.editingView.disable(!0,25);S.restore();this.oPb.mrk(l,F,a);return!0}finally{c&&c.dispose()}}rrk(a,b){this.ln.Mv();const c=(new vF.a).ie(15);c.hd(this.Dr.gPe);b=Object(ua.a)(10,b.od).getValue(Kd.a.tgj);Z.ULS.shipAssertTag(20492440,307,Cb.SelectionEditor.Mg(b));this.oPb.lpg(b,
a);this.Dr.GMf();c.dispose();return!0}y2g(a){this.ln.Mv();this.Da.processAction(D.a.HAa,2);const b=this.Rc.Pa.kb.Wa;Z.ULS.shipAssertTag(18158339,307,Cb.SelectionEditor.Mg(b));this.jAg(b,"intPaste");this.oPb.lpg(b,a);return!0}jAg(a,b){b=Zy.kV(b);this.o$.aGk(b,a.node,a.Qa);this.o$.pTj(b.bOd);this.o$.cce(b.O6a);this.o$.Xbe(b.y3a);this.o$.Wbe(b.eNa)}Rkh(a,b){if(!b.GBh)return!1;b.vw&64&&this.Dr.Zul();if(!b.Nqa)return Z.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Uc.Vb(zd.a.v0,{["Reason"]:Hd.a.rpg}),
b.E_&&b.E_.fail("No selection after paste",!1),b.failed=!0,!1;this.Uyd.Gul(b);this.ln.Mv();return!1}}Object(e.a)(HH,"ClipboardOperationPaste",null,[768]);class IH{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){this.ld=a;this.Dr=b;this.oPb=c;this.oaa=f;this.Rc=l;this.Da=w;this.wRb=S;this.FQh=F;this.$qd=fa;this.Hpd=xa;this.Yc=Za}create(a,b){b=this.FQh.create(this.Rc,b);return new HH(this.ld,this.Dr,this.oPb,this.oaa,this.Rc,this.Da,a,b,this.wRb,this.$qd,this.Hpd,this.Yc)}}Object(e.a)(IH,"Factory",null,[583]);
class JH{constructor(a,b){this.BUh=a;this.uQh=b}get stylePropertySet(){return this.BUh}get kqk(){return this.uQh}}Object(e.a)(JH,"ParagraphFormatStore",null,[]);class KH{constructor(a,b,c,f){this.Rc=a;this.Tq=b;this.QJ=c;this.nNh=f}qol(a,b){if(b.Hub&&this.nNh){b=a.h4;var c=this.Rc.Pa.kb.Wa.node,f=null;this.Tq.Pd(c)&&(f=this.QJ.iD(c),c=this.Tq.YPa(c),f=new JH(f,c));b=new Yo(b.context,b.vw,b.E_,b.XI,b.od,f);a.h4=b}}}Object(e.a)(KH,"ClipboardOperationPasteOvertypeStrategy",null,[582]);class dx{constructor(a){this.Awd=
null;this.Rc=a;a.Zdd(b=>{this.Awd=b},!1)}get Jug(){return!1}Gul(a){a=this.ISb(a);this.setSelection(this.Rc,a)}ISb(a){let b=a.Nqa;(a.tJa||a.gFb)&&a.Vhd&&(b=fd.SelectionFactory.SM(a.Vhd,b.Wa));return b}setSelection(a,b){a.setSelection(b)}}Object(e.a)(dx,"AClipboardOperationPasteStrategy",null,[794]);class LH extends dx{constructor(a){super(a)}get JCb(){return this.Awd}}Object(e.a)(LH,"ClipboardOperationPasteToLiveSelectionStrategy",dx,[]);class MH extends dx{constructor(a,b){super(a);this.uEd=null;
this.FOb=b;a.Zdd(c=>{this.uEd=c},!0)}get Jug(){return!0}get JCb(){return this.uEd}ISb(a){let b=super.ISb(a);a.od.setValue(Kd.a.Frk,b);return b=this.FOb.$zl(this.Awd.kb,this.uEd.kb,b)}}Object(e.a)(MH,"ClipboardOperationPasteToVirtualSelectionStrategy",dx,[]);class NH{constructor(a){this.FOb=null;this.tEd=a.ka("EnableVirtualSelectionInSelectionManager")}create(a,b){return b&&b.ta(Kd.a.tJa,!1)&&this.tEd?new MH(a,this.dxl):new LH(a)}get dxl(){this.FOb||(this.FOb=lb.a.instance.qb("Box4.Actors.IVirtualSelectionMerger"));
return this.FOb}}Object(e.a)(NH,"ClipboardOperationPasteStrategyFactory",null,[585]);class hC{constructor(a,b,c,f,l,w){this.ld=a;this.Rc=b;this.ifa=c;this.KC=f;this.QMh=l;this.BNh=w}Xwk(a){this.BNh&&(a&1||a&32)&&this.ifa.Nv&&this.Rc.WRb()}BBj(a,b){return this.QMh?a&1&&this.KC.R3a(b)?(this.ld.Vb(zd.a.qh,{["Reason"]:Hd.a.aD}),!1):!0:!0}}Object(e.a)(hC,"ClipboardOperationWordStrategy",null,[]);class OH{constructor(a){this.qIh=a.ka("CssConverterFidelityImprovementIsEnabledIsEnabled")}Ksi(a,b){if(b)if(b=
b.sheet)if(b=b.cssRules){var c=Array.clone(b);u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordCssConverterFidelityImprovementIsEnabledSettings");this.qIh&&c.reverse();var f=b=0,l=0,w=0;for(const S of c){c=S.style;var F=S.selectorText;c=c?c.cssText:null;F=F?F.split(","):null;if(c&&F&&S.type===S.STYLE_RULE){w+=F.length;for(const fa of F){0<=fa.indexOf("#")&&b++;0<=fa.indexOf(".")&&f++;0>fa.indexOf("#")&&0>fa.indexOf(".")&&l++;F=null;try{F=a.querySelectorAll(fa)}catch(xa){Z.ULS.sendTraceTag(41427107,
307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",fa,xa.message)}if(F)for(let xa=0;xa<F.length;xa++)F[xa].setAttribute("style",c+(F[xa].getAttribute("style")||""))}}}Z.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",w,b,f,l)}else this.CAg();else this.CAg()}CAg(){Z.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",
r.a.ey)}}Object(e.a)(OH,"ExternalPasteCssConverter",null,[590]);var $y=d(1182);class ex{constructor(a){this.sU=this.NNb=null;this.cRb=a.currentNode;const b=new mb.GraphIterator;b.Pc(a);this.zyd=new mb.GraphIterator;this.zyd.Pc(a);this.wyd=b.origin;this.Apd=Array(b.depth);this.Dib=Array(b.depth);this.Bpd=Array(b.depth);for(a=b.depth-1;0<=a;--a){const c=b.currentNode;this.Dib[a]=b.role;this.Bpd[a]=c;b.yc();this.Apd[a]=b.EXi(c,this.Dib[a])}}Il(a,b){this.NNb=a;this.sU=b}restore(a){const b=new $y.a,c=
new $y.a;this.Eeh(a,b,c);return c.value}Eeh(a,b,c){b.value=!0;if(this.zyd.isValid)a.Pc(this.zyd),c.value=!1;else{for(let f=this.Bpd.length-1;0<=f;--f){const l=this.Bpd[f];if(l.anchor&&!l.anchor.iI&&(a.set(l),a.j$(this.wyd)||this.wyd.J8d&&a.Nxh())){c.value=this.f0f(a,f+1);return}b.value=!1}a.set(this.wyd);c.value=this.f0f(a,0)}}f0f(a,b){let c=!1,f,l;f=this.Apd[b];l=this.Dib[b];const w=a.X6(l);if(f<w)a.Hp(f,l);else if(c=!0,!a.xA(l))return!0;if(!this.ISg(a,l))return c;for(b+=1;b<this.Apd.length;++b){if(c){if(!a.xA(this.Dib[b]))return!0}else if(!a.yb(this.Dib[b]))return!1;
if(!this.ISg(a,this.Dib[b]))break}return c}ISg(a,b){if(this.NNb&&!this.NNb(a,this.sU)){const c=new mb.GraphIterator;c.Pc(a);let f=!0;do if(!a.xf(b)){f=!1;break}while(!this.NNb(a,this.sU));if(!f){a.Pc(c);do if(!a.RE(b))return a.yc(),!1;while(!this.NNb(a,this.sU))}}return!0}}Object(e.a)(ex,"NodeReference",null,[]);var zn=d(182);class mj{constructor(a,b,c,f){this.alb=this.Xyd=this.$Ja=this.Yc=this.PC=this.Go=this.xvh=this.LQb=this.Eo=this.Pg=this.tw=this.PJ=this.wH=null;this.Qtb=a;this.RVd=this.udb=
null;this.jh=b;this.transaction=c;this.oga=f}get fa(){return u.AFrameworkApplication.fa}get qO(){return this.PJ||(this.PJ=lb.a.instance.resolve("Box4.Styles.IStyleEditor"))}get paragraphEditor(){return this.tw||(this.tw=lb.a.instance.resolve("Box4.IParagraphEditor"))}get OI(){return this.wH||(this.wH=lb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}get $A(){return mj.ix||(mj.ix=lb.a.instance.resolve("Box4.IOutlineEditor"))}get Sf(){return this.Pg||(this.Pg=lb.a.instance.resolve("Box4.List.IListReader"))}get dr(){return this.Eo||
(this.Eo=lb.a.instance.resolve("Box4.List.IListEditor"))}get Fkc(){return this.LQb||(this.LQb=lb.a.instance.qb("Box4.List.ISingleLevelListEditor"))}get e5(){return this.Go||(this.Go=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get xmc(){return this.PC||(this.PC=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}get Mf(){return this.Yc||(this.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get lLd(){return this.$Ja||
(this.$Ja=lb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get u9c(){return this.Xyd||(this.Xyd=lb.a.instance.qb("Box4.IPastedParagraphSpaceHandler"))}set u9c(a){this.Xyd=a}get S2g(){return!1}get enh(){return this.fa.ka("WordEditorAutoResizeImageIsEnabled")}K_f(){}D2g(a){var b=void 0===this.jh.vw||null===this.jh.vw?"not available":Object(fC.a)(fv,this.jh.vw);Z.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.jh.vw,b);Z.ULS.shipAssertTag(6305487,307,Cb.SelectionEditor.Mg(this.Qtb));
if(this.Q5c)return Z.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.jh.Nqa=fd.SelectionFactory.Zt(this.Qtb),a.Wg(Object(C.a)(this,this.$Va,"pasteTeardown")),!0;b=new mb.GraphIterator;b.set(this.Qtb.node);Cb.SelectionEditor.Rs(b);lc.OutlineElementNavigator.Ke(b);this.xvh=b.origin;if(this.S2g)return b.nC(10),this.K_f(b,a),a.Wg(Object(C.a)(this,this.y2k,"setSelectionAfterPastingOutlines")),!0;if(lg.b(b)){if(this.crg)return this.jh.Nqa=this.yrk(this.Qtb,this.uPf),a.Wg(Object(C.a)(this,this.$Va,
"pasteTeardown")),!0;this.Qtb=this.hbk(b).ga(0)}this.tdl(this.Qtb);const c=new zn.a;c.Pc(b);lc.OutlineElementNavigator.KI(c,!1,!1);this.udb=new ex(b);this.RVd=new ex(c);a.Wg(Object(C.a)(this,this.prk,"pasteExecution"));return!0}prk(a){Me.a.mark(5568);this.J_f(a);let b=Object(C.a)(this,this.G$j,"mergeAfterPaste");if(this.Qtg){const c=this.Rnh();c&&(b=Object(C.a)(this,this.$Va,"pasteTeardown"));Z.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",c)}a.Wg(b);return!0}Rnh(){return!1}get Qtg(){return this.fa.ka("PptCcpFix2IsEnabled")}get K6k(){return this.fa.ka("CopyAndPasteOneParagraphIndentationFixIsEnabled")}G$j(a){Me.a.mark(5569);
var b=new mb.GraphIterator;this.udb.restore(b);this.udb=null;var c=new mb.GraphIterator;this.RVd.restore(c);this.RVd=null;Z.ULS.shipAssertTag(6305489,307,Md.OutlineElementReader.Tg(b));Z.ULS.shipAssertTag(6305490,307,Md.OutlineElementReader.Tg(c));lc.OutlineElementNavigator.ti(b);db.ParagraphReader.Pk(b)&&db.ParagraphReader.textLength(b.currentNode);lc.OutlineElementNavigator.Ke(b);lc.OutlineElementNavigator.ti(c);Z.ULS.shipAssertTag(6305491,307,db.ParagraphReader.Pk(c));var f=db.ParagraphReader.textLength(c.currentNode);
lc.OutlineElementNavigator.Ke(c);const l=this.qnh;var w=new zn.a;w.Pc(b);lc.OutlineElementNavigator.KI(w,!1,!1);var F=w.currentNode===c.currentNode;var S=!!this.jh&&!!(this.jh.vw&8192);let fa=!1;!S&&this.jh.od&&Object(Ca.a)(H.DictionaryPropertySet,this.jh.od)&&2===gb.App.mode&&(S=(S=this.jh.od.Uh(Kd.a.jdb))&&""!==S?!0:!1);if(F)w=mb.GraphIterator.nb(b.currentNode),db.ParagraphReader.Ir(lc.OutlineElementNavigator.ti(w))||(b=c),b.currentNode.id!==c.currentNode.id&&(Z.ULS.sendTraceTag(40691869,307,50,
"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",yc.ListReader.$j(b),yc.ListReader.$j(c)),w=mj.Lh.merge(b,c,!0,S),Z.ULS.shipAssertTag(6305492,307,w)),c=b,S=!0;else{var xa=!!(this.jh.vw&4);F=this.Mf.Zf&&this.Mf.fy&&xa&&this.jh.$7a;this.u9c&&this.jh&&2===gb.App.mode&&!xa&&(this.u9c.inj(b,!1),this.u9c.inj(c,!0));lc.OutlineElementNavigator.ti(w);db.ParagraphReader.Pk(w)&&db.ParagraphReader.textLength(w.currentNode);lc.OutlineElementNavigator.Ke(w);this.v8h(w,
b,c);if(this.lLd.mUb||this.K6k)if(xa=new zn.a,xa.Pc(w),lc.OutlineElementNavigator.KI(xa,!1,!1),xa.Gp.id!==c.Gp.id){for(;w.currentNode.id!==c.currentNode.id;)lc.OutlineElementNavigator.ti(w,!1),Fc.a.create(w.currentNode),w.yc(),lc.OutlineElementNavigator.KI(w,!1,!1);w.Pc(b);lc.OutlineElementNavigator.KI(w,!1,!1)}else fa=!0;if(this.jh.Vcd&&(Z.ULS.shipAssertTag(6305493,307,this.jh.Hub),xa=new mb.GraphIterator,xa.Pc(w),xa=lc.OutlineElementNavigator.ti(xa))){var Za=this.jh.Vcd.Vd(xa.Ra.ga(0));xa.Ra.ga(0).formatting=
Za}yc.ListReader.$j(b)?(mj.JK.s4b&&this.Fkc&&this.Fkc.oAl(b),xa=yc.ListReader.$j(w)?this.rnh:!0):Md.OutlineElementReader.isEmpty(b,!0)?(mj.Lh.NAa(b),xa=!1):xa=yc.ListReader.Gw||!yc.ListReader.$j(w);this.jh.Vhd=null;if(this.jh.gFb||this.jh.tJa)this.jh.Vhd=this.Fbj(xa?b.currentNode:w.currentNode,xa);if(xa&&(Za=yc.ListReader.$j(b),Z.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Za,yc.ListReader.$j(c)),mj.Lh.merge(b,w,!0,S,c,void 0,
fa,F),yc.ListReader.$j(b)&&this.Sf.Hfc)){var pb=new zn.a;pb.Pc(b);lc.OutlineElementNavigator.KI(pb,!1,!1);if(pb.Gp.id!==c.Gp.id){var Mb=this.Sf.rx(b);this.Sf.kla(b);const Ec=b.currentNode.ta(Sb.a.listID,0);b.yc();for(Mb.Zz=Pj.a.gw;pb.currentNode.id!==c.currentNode.id;){if(!yc.ListReader.$j(pb))({x7a:Mb}=this.dr.fnb(Mb.propertySet,pb,Mb));else if(Za){var hc=this.Sf.k4i(pb),kc=this.Sf.FZd(b.currentNode,Ec,hc);kc=kc?hk.a.vAa(kc,null):Mb;hc=hk.a.bV(kc.listType,Mb.listStyle,null,0,hc,"","");hc.Wdk=b.currentNode;
this.dr.x1k(hc);this.dr.ZHe(pb,!0)}lc.OutlineElementNavigator.KI(pb,!1,!1)}}}l?(Za=new zn.a,Za.Pc(c),lc.OutlineElementNavigator.Jua(Za,!1,!1),pb=yc.ListReader.$j(Za),Mb=yc.ListReader.$j(c),S=mj.Lh.merge(Za,c,!0,S,void 0,!0,void 0,F),Z.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",pb,Mb,S?"True":"False, will cause IP to reset to zero."),c=S?Za:c):(S=!1,Z.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero."));
this.lLd.mUb&&fa&&(xa?(w=new mb.GraphIterator,w.Pc(b),lc.OutlineElementNavigator.ti(w)):l?(b=new mb.GraphIterator,b.Pc(w),lc.OutlineElementNavigator.ti(b)):(b=new mb.GraphIterator,b.Pc(w),b=lc.OutlineElementNavigator.ti(b),Fc.a.create(b)))}Z.ULS.shipAssertTag(6305494,307,c.isValid);b=lc.OutlineElementNavigator.ti(c);f=S?db.ParagraphReader.textLength(b)-f:0;w=!1;Object(Ca.a)(10,this.jh.od)&&(w=this.jh.od.ta(Kd.a.fSc,!1));w&&I.a.instance.ga(11)?this.jh.Nqa=fd.SelectionFactory.PY(b,f-1,f):this.jh.Nqa=
fd.SelectionFactory.Lg(b,f);I.a.instance.ga(71)&&this.jh&&this.jh.Hub&&db.ParagraphReader.Pd(b)&&this.jh.K8c&&((f=this.jh.K8c.stylePropertySet)&&this.qO.V9(f,b,!0),(f=this.jh.K8c.kqk)&&this.paragraphEditor.cFf(b,f));a.Wg(Object(C.a)(this,this.$Va,"pasteTeardown"));return!0}v8h(a,b,c){var f=!1;this.Mf.Zf&&this.Mf.fy&&(f=!0);if(f){for(;a.currentNode!==c.currentNode;){lc.OutlineElementNavigator.ti(a,!1);f=this.xmc.kdl(Fc.a.create(a.currentNode));f.Aeg();for(let l=0;l<f.length;l++){let w;const F=({$wg:w}=
f.getContext(l)).returnValue;w&&mj.hyperlinkEditor.wBb(F,1)}a.yc();lc.OutlineElementNavigator.KI(a,!1,!1)}a.Pc(b);lc.OutlineElementNavigator.KI(a,!1,!1)}}Fbj(a,b){a=mb.GraphIterator.nb(a);lc.OutlineElementNavigator.ti(a);return db.ParagraphReader.Pd(a.currentNode)?(b=b?db.ParagraphReader.textLength(a.currentNode):0,fd.SelectionFactory.Lg(a.currentNode,b)):Cd.TableReader.M8a(a.currentNode)?fd.SelectionFactory.$k(a.currentNode):null}y2k(a){const b=mb.GraphIterator.nb(this.xvh);b.xA(1);this.jh.Nqa=fd.SelectionFactory.oj(b.currentNode,
!1);a.Wg(Object(C.a)(this,this.$Va,"pasteTeardown"));return!0}$Va(){var a=void 0===this.jh.vw||null===this.jh.vw?"not available":Object(fC.a)(fv,this.jh.vw);Z.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.jh.vw,a);Z.ULS.shipAssertTag(6305497,307,!!this.jh.Nqa);this.transaction.dispose();a=this.oga.UJ;if(!a.Jh||!a.editingView.Al)return!1;a.editingView.Yhl();return!1}$5k(a,b){const c=new mb.GraphIterator;c.Pc(a);a=lc.OutlineElementNavigator.ti(c);b=db.ParagraphReader.Pd(a)&&b===db.ParagraphReader.textLength(a);
Z.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",b);return b}tdl(a){Z.ULS.shipAssertTag(6305498,307,Cb.SelectionEditor.Mg(a));const b=mb.GraphIterator.nb(a.node);var c=b.af();lc.OutlineElementNavigator.Ke(b);Z.ULS.sendTraceTag(40425481,307,50,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:c,["ipContextNodeType"]:a.node.type});c=mj.Lh.y2b(b,!0);const f=this.$5k(b,a.Qa);mj.Lh.dHb(b,c,a,!1,!1,f)}yrk(a,b){Z.ULS.shipAssertTag(6305500,307,a.contextId===Db.a.Ff);
const c=a.node;b=b.replace(Ja.a.vtc," ");mj.characterPropertiesEditor.replaceTextRange(a,b);return fd.SelectionFactory.Lg(c,a.Qa+b.length)}hbk(a){a.uv();mj.Gl.JHa(a);const b=mj.hk.Lag(a),c=this.OI.cWb(a);b?lq.c(a.currentNode,b+1,b+2):this.$A.Nfd(c,gb.App.Fb.Fd.Xm.J0b());this.$A.x2b(a,null,!0);return fd.SelectionFactory.oj(a.currentNode,!0)}static get Gl(){return ry.PageNavigator.instance}static get characterPropertiesEditor(){return mj.Vg||(mj.Vg=lb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hyperlinkEditor(){return mj.Tm||
(mj.Tm=lb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get hk(){return $u.PageReader.instance}static get Lh(){return mj.xi||(mj.xi=lb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get JK(){return mj.FJ||(mj.FJ=lb.a.instance.qb("Box4.List.ListSettings"))}static get pe(){return mj.$c||(mj.$c=lb.a.instance.qb("Box4.IFeatureHelper"))}}mj.ix=null;mj.$c=null;mj.xi=null;mj.Vg=null;mj.Tm=null;mj.FJ=null;Object(e.a)(mj,"APasteExecutionManager",null,[]);var EP=d(1181);class PH{constructor(){this.vw=
0;this.KVb=6;this.uWd=this.tWd=this.n4f=this.sWd=this.rWd=this.qWd=this.pWd=!1;this.Yze=null;this.m4f=this.B5a=this.vZb=this.l4f=this.p4f=!1;this.L2g=this.HCb=0;this.rwe=this.platform=null;this.Q_a={}}get rMe(){if(this.uWd)return"Word Online";if(this.sWd)return"Google Docs";if(this.tWd||this.qWd||this.rWd)return"PowerPoint Online";if(this.pWd)return"Excel Online";switch(this.Yze){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}fUj(){Z.ULS.sendTraceTag(51406241,
307,50,JSON.stringify(this.Ici()))}gUj(){const a=this.Q_a;for(let c in a){var b=c;const f=a[c];f&&(f.SourceApp=this.rMe,f.Browser=EP.a[this.HCb],f.TagName=b,f.OperationId=this.rwe,Z.ULS.sendTraceTag(51406242,307,50,JSON.stringify(f)))}}dtj(a,b){a&&a.length&&b&&b.length&&(a=a.toLowerCase(),b=b.toLowerCase(),a in this.Q_a||(this.Q_a[a]={}),this.Q_a[a][b]=this.Zbj(a,b)+1)}Zbj(a,b){if(!(a&&a.length&&b&&b.length&&this.Q_a&&a in this.Q_a))return 0;a=a.toLowerCase();b=b.toLowerCase();return(a=this.Q_a[a])&&
b in a?a[b]:0}Ici(){const a={};a.ActionIdFlags=this.vw;a.FoundDataCcpTimestampAttribute=this.pWd;a.FoundDataClipserviceCcpidAttribute=this.qWd;a.FoundDataShapeIdsAttribute=this.rWd;a.FoundGoogleDocsInternalGuidId=this.sWd;a.FoundOneNoteOnlineSequenceClass=this.n4f;a.FoundPowerPointOnlineSequenceClass=this.tWd;a.FoundWordOnlineSequenceClass=this.uWd;a.ProgId=this.Yze;a.SourceApp=this.rMe;a.FoundText=this.p4f;a.FoundEquation=this.l4f;a.FoundList=this.vZb;a.FoundTable=this.B5a;a.FoundImage=this.m4f;
a.CopySourceBrowser=this.KVb;a.PasteBrowser=this.HCb;a.IsSameBrowserPaste=this.nKj(this.KVb,this.HCb);a.IsCrossBrowserPaste=this.rCj(this.KVb,this.HCb);a.IsUncategorizedBrowserPaste=this.dNj(this.KVb,this.HCb);a.Platform=this.platform;a.PastedHtmlLength=this.L2g;a.OperationId=this.rwe;return a}nKj(a,b){return 5===a||6===a?!1:a===b}rCj(a,b){return 6===a?!1:a!==b}dNj(a,b){return 5===a&&5===b}}Object(e.a)(PH,"HtmlContentMetadata",null,[]);class az{constructor(a,b,c=!1){this.Pf=a;this.Kv=b;this.y7h=c}}
Object(e.a)(az,"TagEventParam",null,[]);class iC{constructor(a,b=null){this.xqc=this.cqf=this.VDd=this.xyf=null;this.Lc=a;this.yR=b||Km.a.F9f("");this.X3k()}get Gb(){return this.yR}Idk(a,b,c){this.VDd[b]?this.pUg():(this.Gb.e++,(b=this.xqc[b])&&b(new az(a,c,!1)),this.Gb.b++)}pUg(){this.Gb.d++}Bdk(){this.Gb.c++}vdk(a,b,c){if(this.VDd[b])this.pUg();else{if(b=this.xqc[b])return this.Gb.b++,b(new az(a,c,!1));this.Gb.f++}return 2}X3k(){this.xyf=va.a.cH("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,
"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.VDd=va.a.cH("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this.cqf=va.a.cH("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);let a=this.Lc,b=
this.Lc,c=this.Lc,f=this.Lc,l=this.Lc,w=this.Lc,F=this.Lc,S=this.Lc,fa=this.Lc,xa=this.Lc,Za=this.Lc,pb=this.Lc,Mb=this.Lc,hc=this.Lc,kc=this.Lc,Ec=this.Lc,Hc=this.Lc,Dc=this.Lc,Td=this.Lc,we=this.Lc;this.xqc=va.a.cH("A",Object(C.a)(this.Lc,this.Lc.b6c,"onAOpen"),"ABBR",Object(C.a)(this.Lc,this.Lc.ute,"onAbbrOpen"),"ACRONYM",Object(C.a)(this.Lc,this.Lc.vte,"onAcronymOpen"),"ADDRESS",Object(C.a)(this.Lc,this.Lc.wte,"onAddressOpen"),"APPLET",Object(C.a)(this.Lc,this.Lc.Dte,"onAppletOpen"),"AREA",Object(C.a)(this.Lc,
this.Lc.Gte,"onAreaTag"),"B",Object(C.a)(this.Lc,this.Lc.g6c,"onBOpen"),"BASE",Object(C.a)(this.Lc,this.Lc.Jte,"onBaseTag"),"BASEFONT",Object(C.a)(this.Lc,this.Lc.Kte,"onBasefontTag"),"BDO",Object(C.a)(this.Lc,this.Lc.Lte,"onBdoOpen"),"BIG",Object(C.a)(this.Lc,this.Lc.o6c,"onBigOpen"),"BLOCKQUOTE",Object(C.a)(this.Lc,this.Lc.p6c,"onBlockquoteOpen"),"BODY",Object(C.a)(this.Lc,this.Lc.Wte,"onBodyOpen"),"BR",Object(C.a)(this.Lc,this.Lc.q6c,"onBrTag"),"BUTTON",Object(C.a)(this.Lc,this.Lc.$te,"onButtonOpen"),
"CAPTION",Object(C.a)(this.Lc,this.Lc.r6c,"onCaptionOpen"),"CENTER",Object(C.a)(this.Lc,this.Lc.t6c,"onCenterOpen"),"CITE",Object(C.a)(this.Lc,this.Lc.w6c,"onCiteOpen"),"CODE",Object(C.a)(this.Lc,this.Lc.y6c,"onCodeOpen"),"COL",Object(C.a)(this.Lc,this.Lc.nue,"onColTag"),"COLGROUP",Object(C.a)(this.Lc,this.Lc.oue,"onColgroupOpen"),"DD",Object(C.a)(this.Lc,this.Lc.B6c,"onDdOpen"),"DEL",Object(C.a)(this.Lc,this.Lc.C6c,"onDelOpen"),"DFN",Object(C.a)(this.Lc,this.Lc.E6c,"onDfnOpen"),"DIR",Object(C.a)(this.Lc,
this.Lc.F6c,"onDirOpen"),"DIV",Object(C.a)(this.Lc,this.Lc.H6c,"onDivOpen"),"DL",Object(C.a)(this.Lc,this.Lc.I6c,"onDlOpen"),"DT",Object(C.a)(this.Lc,this.Lc.J6c,"onDtOpen"),"EM",Object(C.a)(this.Lc,this.Lc.M6c,"onEmOpen"),"FIELDSET",Object(C.a)(this.Lc,this.Lc.Hue,"onFieldsetOpen"),"FONT",Object(C.a)(this.Lc,this.Lc.U6c,"onFontOpen"),"FORM",Object(C.a)(this.Lc,this.Lc.Nue,"onFormOpen"),"FRAME",Object(C.a)(this.Lc,this.Lc.Oue,"onFrameTag"),"FRAMESET",Object(C.a)(this.Lc,this.Lc.Pue,"onFramesetOpen"),
"H1",Object(C.a)(this.Lc,this.Lc.Z6c,"onH1Open"),"H2",Object(C.a)(this.Lc,this.Lc.$6c,"onH2Open"),"H3",Object(C.a)(this.Lc,this.Lc.a7c,"onH3Open"),"H4",Object(C.a)(this.Lc,this.Lc.b7c,"onH4Open"),"H5",Object(C.a)(this.Lc,this.Lc.c7c,"onH5Open"),"H6",Object(C.a)(this.Lc,this.Lc.d7c,"onH6Open"),"HEAD",Object(C.a)(this.Lc,this.Lc.Rue,"onHeadOpen"),"HR",Object(C.a)(this.Lc,this.Lc.e7c,"onHrTag"),"HTML",Object(C.a)(this.Lc,this.Lc.Tue,"onHtmlOpen"),"I",Object(C.a)(this.Lc,this.Lc.f7c,"onIOpen"),"IFRAME",
Object(C.a)(this.Lc,this.Lc.Vue,"onIframeOpen"),"IMG",Object(C.a)(this.Lc,this.Lc.g7c,"onImgTag"),"INPUT",Object(C.a)(this.Lc,this.Lc.Xue,"onInputTag"),"INS",Object(C.a)(this.Lc,this.Lc.h7c,"onInsOpen"),"ISINDEX",Object(C.a)(this.Lc,this.Lc.dve,"onIsindexOpen"),"KBD",Object(C.a)(this.Lc,this.Lc.i7c,"onKbdOpen"),"LABEL",Object(C.a)(this.Lc,this.Lc.k7c,"onLabelOpen"),"LEGEND",Object(C.a)(this.Lc,this.Lc.m7c,"onLegendOpen"),"LI",Object(C.a)(this.Lc,this.Lc.n7c,"onLiOpen"),"LINK",Object(C.a)(this.Lc,
this.Lc.gve,"onLinkTag"),"MAP",Object(C.a)(this.Lc,this.Lc.hve,"onMapOpen"),"MATH",Object(C.a)(this.Lc,this.Lc.r7c,"onMathOpen"),"MENU",Object(C.a)(this.Lc,this.Lc.SBb,"onMenuOpen"),"META",Object(C.a)(this.Lc,this.Lc.jve,"onMetaTag"),"NOFRAMES",Object(C.a)(this.Lc,this.Lc.mve,"onNoframesOpen"),"NOSCRIPT",Object(C.a)(this.Lc,this.Lc.nve,"onNoscriptOpen"),"OBJECT",Object(C.a)(this.Lc,this.Lc.ove,"onObjectOpen"),"OL",Object(C.a)(this.Lc,this.Lc.y7c,"onOlOpen"),"OPTGROUP",Object(C.a)(this.Lc,this.Lc.pve,
"onOptgroupOpen"),"OPTION",Object(C.a)(this.Lc,this.Lc.C7c,"onOptionOpen"),"P",Object(C.a)(this.Lc,this.Lc.F7c,"onPOpen"),"PARAM",Object(C.a)(this.Lc,this.Lc.rve,"onParamTag"),"PRE",Object(C.a)(this.Lc,this.Lc.R7c,"onPreOpen"),"Q",Object(C.a)(this.Lc,this.Lc.zve,"onQOpen"),"S",Object(C.a)(this.Lc,this.Lc.$7c,"onSOpen"),"SAMP",Object(C.a)(this.Lc,this.Lc.a8c,"onSampOpen"),"SCRIPT",Object(C.a)(this.Lc,this.Lc.Kve,"onScriptOpen"),"SELECT",Object(C.a)(this.Lc,this.Lc.Lve,"onSelectOpen"),"SMALL",Object(C.a)(a,
a.l8c,"onSmallOpen"),"SPAN",Object(C.a)(b,b.m8c,"onSpanOpen"),"STRIKE",Object(C.a)(c,c.n8c,"onStrikeOpen"),"STRONG",Object(C.a)(f,f.o8c,"onStrongOpen"),"STYLE",Object(C.a)(l,l.Rve,"onStyleOpen"),"SUB",Object(C.a)(w,w.p8c,"onSubOpen"),"SUP",Object(C.a)(F,F.q8c,"onSupOpen"),"TABLE",Object(C.a)(S,S.u8c,"onTableOpen"),"TBODY",Object(C.a)(fa,fa.Uve,"onTbodyOpen"),"TD",Object(C.a)(xa,xa.tdc,"onTdOpen"),"TEXTAREA",Object(C.a)(Za,Za.Wve,"onTextareaOpen"),"TFOOT",Object(C.a)(pb,pb.Xve,"onTfootOpen"),"TH",
Object(C.a)(Mb,Mb.v8c,"onThOpen"),"THEAD",Object(C.a)(hc,hc.Yve,"onTheadOpen"),"TITLE",Object(C.a)(kc,kc.$ve,"onTitleOpen"),"TR",Object(C.a)(Ec,Ec.w8c,"onTrOpen"),"TT",Object(C.a)(Hc,Hc.z8c,"onTtOpen"),"U",Object(C.a)(Dc,Dc.A8c,"onUOpen"),"UL",Object(C.a)(Td,Td.B8c,"onUlOpen"),"VAR",Object(C.a)(we,we.E8c,"onVarOpen"))}}Object(e.a)(iC,"AHtmlProcessor",null,[]);class jC{constructor(a,b){this.childNodes=a.childNodes;this.Kv=b;this.FPd=0;this.pRc=!1}}Object(e.a)(jC,"HtmlProcessorArguments",null,[]);class Uq extends iC{constructor(a,
b=null){super(a,b);this.Wud=null}get qIj(){null==this.Wud&&(this.Wud=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.Wud}process(a,b=null){a&&(this.Lc.reset(),this.W5g(new jC(a,new Ot),b))}W5g(a,b){a.childNodes.length&&(a=new Tb.a(b,Object(C.a)(this,this.fyk,"processChild"),a),a.vl("HTML Processing Operation"),b||(a.Ui=!0),a.run())}fyk(a,b){const c=b.childNodes[b.FPd];if(3===c.nodeType)return this.Lc.i6c(),this.Lc.D_(c.nodeValue,
new az(c,b.Kv.u7f())),Uq.HIb(b);if(1!==c.nodeType)return Uq.HIb(b);if(!b.pRc){const l=Ja.a.vC(c.tagName);if(!Uq.joj(c))if(this.cqf[l])this.Bdk();else{Uq.h9j(c);this.Lc.i6c();var f=c.id;const w=c.tagName,F=b.Kv.u7f(),S=c.getAttribute?c.getAttribute("class"):null;f=new Pt(f,w,S?S:"",c.attributes?c.attributes.length:0);f.isValid&&F.add(f);if(this.xyf[l])return this.Idk(c,l,F),Uq.HIb(b);f=!1;switch(this.vdk(c,l,F)){case 1:f=!0;break;case 3:return Uq.HIb(b)}switch(this.Lc.r2d(c)){case 1:f=!0}b.pRc=f;this.W5g(new jC(c,
F),a);if(!a.Ui)return!0}}if(b.pRc){if(this.qIj&&!this.xqc[Ja.a.vC(c.tagName)])return Uq.HIb(b);this.Lc.onClose()}return Uq.HIb(b)}static h9j(a){3!==a.nodeType&&K.a.nv(a,"alreadyPasted",!0)}static joj(a){return 3!==a.nodeType&&K.a.te(a,"alreadyPasted")}static HIb(a){a.FPd++;a.pRc=!1;return a.FPd<a.childNodes.length}}Object(e.a)(Uq,"HtmlProcessor",iC,[]);var Pr=d(912);class QH{constructor(a,b=null,c=null,f=null){this.Yd=a;this.yR=b||Km.a.E9f(r.a.e3a,"");this.Yp=c;this.Ooa=f?f.ka("ParseStyleForHtmlTagEventIsEnabled"):
!1}get Gb(){return this.yR}get rn(){return this.Yp}Cf(a){return a?a+1:1}reset(){this.Yd.reset()}i6c(){this.Yd.i6c()}r2d(a){if(a&&this.rn&&(a.getAttribute&&(a.getAttribute(Pr.a.vTf)&&(this.rn.pWd=!0),a.getAttribute(Pr.a.wTf)&&(this.rn.qWd=!0),a.getAttribute(Pr.a.ATf)&&(this.rn.rWd=!0)),a.id&&a.id.startsWith&&a.id.startsWith(Pr.a.zfg)&&(this.rn.sWd=!0),a.className&&a.className.split))for(const b of a.className.split(" ")){b.startsWith(Pr.a.q0g)&&(this.rn.n4f=!0);b.startsWith(Pr.a.t4g)&&(this.rn.tWd=
!0);b.startsWith(Pr.a.XCh)&&(this.rn.uWd=!0);if(b.startsWith(r.a.GTb)&&b.length===r.a.GTb.length+1){const c=parseInt(Ja.a.substring(b,b.length-1,b.length));isNaN(c)||(this.rn.KVb=c)}if(b===Pr.a.eTg||b===Pr.a.fTg)this.rn.vZb=!0}return this.Yd.r2d(a)}onClose(){this.Yd.onClose()}D_(a,b){this.rn&&(this.rn.p4f=!0);this.Gb.d=this.Cf(this.Gb.d);this.Ooa&&this.rva(b);this.Yd.D_(a,b)}b6c(a){this.Gb.e=this.Cf(this.Gb.e);this.Ooa&&this.rva(a);return this.Yd.b6c(a)}ute(a){this.Gb.f=this.Cf(this.Gb.f);return this.Yd.ute(a)}vte(a){this.Gb.g=
this.Cf(this.Gb.g);return this.Yd.vte(a)}wte(a){this.Gb.h=this.Cf(this.Gb.h);return this.Yd.wte(a)}Dte(a){this.Gb.i=this.Cf(this.Gb.i);return this.Yd.Dte(a)}Gte(a){this.Gb.j=this.Cf(this.Gb.j);this.Yd.Gte(a)}g6c(a){this.Gb.k=this.Cf(this.Gb.k);return this.Yd.g6c(a)}Jte(a){this.Gb.l=this.Cf(this.Gb.l);this.Yd.Jte(a)}Kte(a){this.Gb.m=this.Cf(this.Gb.m);this.Yd.Kte(a)}Lte(a){this.Gb.n=this.Cf(this.Gb.n);return this.Yd.Lte(a)}o6c(a){this.Gb.o=this.Cf(this.Gb.o);return this.Yd.o6c(a)}p6c(a){this.Gb.p=
this.Cf(this.Gb.p);return this.Yd.p6c(a)}Wte(a){this.Gb.q=this.Cf(this.Gb.q);return this.Yd.Wte(a)}q6c(a){this.Gb.r=this.Cf(this.Gb.r);this.Yd.q6c(a)}$te(a){this.Gb.s=this.Cf(this.Gb.s);return this.Yd.$te(a)}r6c(a){this.Gb.t=this.Cf(this.Gb.t);return this.Yd.r6c(a)}t6c(a){this.Gb.u=this.Cf(this.Gb.u);return this.Yd.t6c(a)}w6c(a){this.Gb.v=this.Cf(this.Gb.v);return this.Yd.w6c(a)}y6c(a){this.Gb.w=this.Cf(this.Gb.w);return this.Yd.y6c(a)}nue(a){this.Gb.x=this.Cf(this.Gb.x);this.Yd.nue(a)}oue(a){this.Gb.y=
this.Cf(this.Gb.y);return this.Yd.oue(a)}B6c(a){this.Gb.z=this.Cf(this.Gb.z);return this.Yd.B6c(a)}C6c(a){this.Gb.ba=this.Cf(this.Gb.ba);return this.Yd.C6c(a)}E6c(a){this.Gb.bb=this.Cf(this.Gb.bb);return this.Yd.E6c(a)}F6c(a){this.Gb.bc=this.Cf(this.Gb.bc);return this.Yd.F6c(a)}H6c(a){this.Gb.bd=this.Cf(this.Gb.bd);return this.Yd.H6c(a)}I6c(a){this.Gb.be=this.Cf(this.Gb.be);return this.Yd.I6c(a)}J6c(a){this.Gb.bf=this.Cf(this.Gb.bf);return this.Yd.J6c(a)}M6c(a){this.Gb.bg=this.Cf(this.Gb.bg);return this.Yd.M6c(a)}Hue(a){this.Gb.bh=
this.Cf(this.Gb.bh);return this.Yd.Hue(a)}U6c(a){this.Gb.bi=this.Cf(this.Gb.bi);return this.Yd.U6c(a)}Nue(a){this.Gb.bj=this.Cf(this.Gb.bj);return this.Yd.Nue(a)}Oue(a){this.Gb.bk=this.Cf(this.Gb.bk);this.Yd.Oue(a)}Pue(a){this.Gb.bl=this.Cf(this.Gb.bl);return this.Yd.Pue(a)}Z6c(a){this.Gb.bm=this.Cf(this.Gb.bm);return this.Yd.Z6c(a)}$6c(a){this.Gb.bm=this.Cf(this.Gb.bm);return this.Yd.$6c(a)}a7c(a){this.Gb.bm=this.Cf(this.Gb.bm);return this.Yd.a7c(a)}b7c(a){this.Gb.bm=this.Cf(this.Gb.bm);return this.Yd.b7c(a)}c7c(a){this.Gb.bm=
this.Cf(this.Gb.bm);return this.Yd.c7c(a)}d7c(a){this.Gb.bm=this.Cf(this.Gb.bm);return this.Yd.d7c(a)}Rue(a){this.Gb.bn=this.Cf(this.Gb.bn);return this.Yd.Rue(a)}e7c(a){this.Gb.bo=this.Cf(this.Gb.bo);this.Yd.e7c(a)}Tue(a){this.Gb.bp=this.Cf(this.Gb.bp);return this.Yd.Tue(a)}f7c(a){this.Gb.bq=this.Cf(this.Gb.bq);return this.Yd.f7c(a)}Vue(a){this.Gb.br=this.Cf(this.Gb.br);return this.Yd.Vue(a)}g7c(a){this.rn&&(this.rn.m4f=!0);this.Ooa&&this.rva(a);this.Gb.bs=this.Cf(this.Gb.bs);this.Yd.g7c(a)}Xue(a){this.Gb.bt=
this.Cf(this.Gb.bt);this.Yd.Xue(a)}h7c(a){this.Gb.bu=this.Cf(this.Gb.bu);return this.Yd.h7c(a)}dve(a){this.Gb.bv=this.Cf(this.Gb.bv);return this.Yd.dve(a)}i7c(a){this.Gb.bw=this.Cf(this.Gb.bw);return this.Yd.i7c(a)}k7c(a){this.Gb.bx=this.Cf(this.Gb.bx);return this.Yd.k7c(a)}m7c(a){this.Gb.by=this.Cf(this.Gb.by);return this.Yd.m7c(a)}n7c(a){this.rn&&(this.rn.vZb=!0);this.Gb.bz=this.Cf(this.Gb.bz);this.Ooa&&this.rva(a);return this.Yd.n7c(a)}gve(a){this.Gb.ca=this.Cf(this.Gb.ca);this.Yd.gve(a)}hve(a){this.Gb.cb=
this.Cf(this.Gb.cb);return this.Yd.hve(a)}r7c(a){this.rn&&(this.rn.l4f=!0);this.Gb.cc=this.Cf(this.Gb.cc);return this.Yd.r7c(a)}SBb(a){this.Gb.cd=this.Cf(this.Gb.cd);return this.Yd.SBb(a)}jve(a){this.Gb.ce=this.Cf(this.Gb.ce);this.Yd.jve(a)}mve(a){this.Gb.cf=this.Cf(this.Gb.cf);return this.Yd.mve(a)}nve(a){this.Gb.cg=this.Cf(this.Gb.cg);return this.Yd.nve(a)}ove(a){this.Gb.ch=this.Cf(this.Gb.ch);return this.Yd.ove(a)}y7c(a){this.rn&&(this.rn.vZb=!0);this.Gb.ci=this.Cf(this.Gb.ci);this.Ooa&&this.rva(a);
return this.Yd.y7c(a)}pve(a){this.Gb.cj=this.Cf(this.Gb.cj);return this.Yd.pve(a)}C7c(a){this.Gb.ck=this.Cf(this.Gb.ck);return this.Yd.C7c(a)}F7c(a){this.Gb.cl=this.Cf(this.Gb.cl);this.Ooa&&this.rva(a);return this.Yd.F7c(a)}rve(a){this.Gb.cm=this.Cf(this.Gb.cm);this.Yd.rve(a)}R7c(a){this.Gb.cn=this.Cf(this.Gb.cn);return this.Yd.R7c(a)}zve(a){this.Gb.co=this.Cf(this.Gb.co);return this.Yd.zve(a)}$7c(a){this.Gb.cp=this.Cf(this.Gb.cp);return this.Yd.$7c(a)}a8c(a){this.Gb.cq=this.Cf(this.Gb.cq);return this.Yd.a8c(a)}Kve(a){this.Gb.cr=
this.Cf(this.Gb.cr);return this.Yd.Kve(a)}Lve(a){this.Gb.cs=this.Cf(this.Gb.cs);return this.Yd.Lve(a)}l8c(a){this.Gb.ct=this.Cf(this.Gb.ct);return this.Yd.l8c(a)}m8c(a){this.Gb.cu=this.Cf(this.Gb.cu);this.Ooa&&this.rva(a);return this.Yd.m8c(a)}n8c(a){this.Gb.cv=this.Cf(this.Gb.cv);return this.Yd.n8c(a)}o8c(a){this.Gb.cw=this.Cf(this.Gb.cw);return this.Yd.o8c(a)}Rve(a){this.Gb.cx=this.Cf(this.Gb.cx);return this.Yd.Rve(a)}p8c(a){this.Gb.cy=this.Cf(this.Gb.cy);return this.Yd.p8c(a)}q8c(a){this.Gb.cz=
this.Cf(this.Gb.cz);return this.Yd.q8c(a)}u8c(a){this.rn&&(this.rn.B5a=!0);this.Gb.da=this.Cf(this.Gb.da);this.Ooa&&this.rva(a);return this.Yd.u8c(a)}Uve(a){this.rn&&(this.rn.B5a=!0);this.Gb.db=this.Cf(this.Gb.db);this.Ooa&&this.rva(a);return this.Yd.Uve(a)}tdc(a){this.rn&&(this.rn.B5a=!0);this.Gb.dc=this.Cf(this.Gb.dc);this.Ooa&&this.rva(a);return this.Yd.tdc(a)}Wve(a){this.Gb.dd=this.Cf(this.Gb.dd);return this.Yd.Wve(a)}Xve(a){this.Gb.de=this.Cf(this.Gb.de);return this.Yd.Xve(a)}v8c(a){this.rn&&
(this.rn.B5a=!0);this.Gb.df=this.Cf(this.Gb.df);return this.Yd.v8c(a)}Yve(a){this.rn&&(this.rn.B5a=!0);this.Gb.dg=this.Cf(this.Gb.dg);return this.Yd.Yve(a)}$ve(a){this.Gb.dh=this.Cf(this.Gb.dh);return this.Yd.$ve(a)}w8c(a){this.rn&&(this.rn.B5a=!0);this.Gb.di=this.Cf(this.Gb.di);return this.Yd.w8c(a)}z8c(a){this.Gb.dj=this.Cf(this.Gb.dj);return this.Yd.z8c(a)}A8c(a){this.Gb.dk=this.Cf(this.Gb.dk);return this.Yd.A8c(a)}B8c(a){this.rn&&(this.rn.vZb=!0);this.Gb.dl=this.Cf(this.Gb.dl);return this.Yd.B8c(a)}E8c(a){this.Gb.dm=
this.Cf(this.Gb.dm);return this.Yd.E8c(a)}rva(a){if((a=a.Pf)&&a.style&&this.rn){var b=a.style;if(b)for(const c of b)c&&0<c.length&&this.rn.dtj(a.tagName,c)}}}Object(e.a)(QH,"HtmlEventUsageCollector",null,[795]);class RH{constructor(a,b=null,c=null){this.Yd=a;this.yR=b||Km.a.tcg("");this.UUh=c||Km.a.ucg("")}get Gb(){return this.yR}get lOe(){return this.UUh}$W(a){this.lOe.b++;this.Yd.$W(a)}XW(){this.Yd.XW()}ZW(a){this.lOe.c++;this.Yd.ZW(a)}YW(){this.Yd.YW()}WW(a){this.lOe.d++;this.Yd.WW(a)}VW(){this.Yd.VW()}reset(){this.Yd.reset()}get PWb(){return this.Yd.PWb}D_(a,
b){this.Gb.b++;this.Yd.D_(a,b)}Dla(a){this.Gb.c++;this.Yd.Dla(a)}SVa(a){this.Gb.b++;this.Yd.SVa(a)}Cla(a){this.Gb.d++;this.Yd.Cla(a)}Bla(a){this.Gb.f++;this.Yd.Bla(a)}Vua(a,b){this.Gb.g++;this.Yd.Vua(a,b)}Uua(){this.Yd.Uua()}Vz(a){this.Gb.h++;this.Yd.Vz(a)}Uz(){this.Yd.Uz()}NVa(){this.Yd.NVa()}MVa(){this.Yd.MVa()}$ua(a,b){this.Gb.i++;this.Yd.$ua(a,b)}HGa(){this.Yd.HGa()}Gla(a){this.Gb.j++;this.Yd.Gla(a)}Ela(){this.Yd.Ela()}Zua(a){this.Gb.k++;this.Yd.Zua(a)}Fla(){this.Yd.Fla()}OVa(a){this.Gb.l++;this.Yd.OVa(a)}}
Object(e.a)(RH,"SemanticEventUsageCollector",null,[679,406]);class kC{constructor(a){this.sh=a}reset(){this.sh.reset()}get PWb(){return this.sh.PWb}D_(a,b){this.sh.D_(a,b)}Dla(a){this.sh.Dla(a)}SVa(a){this.sh.SVa(a)}Cla(a){this.sh.Cla(a)}Bla(a){this.sh.Bla(a)}Vua(a,b){this.sh.Vua(a,b)}Uua(){this.sh.Uua()}Vz(a){this.sh.Vz(a)}Uz(){this.sh.Uz()}NVa(){this.sh.NVa()}MVa(){this.sh.MVa()}Gla(a){this.sh.Gla(a)}Ela(){this.sh.Ela()}Zua(a){this.sh.Zua(a)}Fla(){this.sh.Fla()}OVa(a){this.sh.OVa(a)}$W(a){this.sh.$W(a)}XW(){this.sh.XW()}ZW(a){this.sh.ZW(a)}YW(){this.sh.YW()}WW(a){this.sh.WW(a)}VW(){this.sh.VW()}$ua(a,
b){this.sh.$ua(a,b)}HGa(){this.sh.HGa()}}Object(e.a)(kC,"AHtmlNormalizer",null,[679,406]);class lC extends kC{constructor(a){super(a);this.lC=!1}D_(a,b){this.lC?this.tF.DE(()=>{this.Uze(a,b)}):this.Uze(a,b)}Uze(a,b){this.sh.D_(a,b)}Dla(a){this.lC?this.tF.DE(()=>{this.uze(a)}):this.uze(a)}uze(a){this.sh.Dla(a)}Cla(a){this.lC?this.tF.DE(()=>{this.Bfc(a)}):this.Bfc(a)}Bfc(a){this.sh.Cla(a)}Bla(a){this.lC?this.tF.DE(()=>{this.sze(a)}):this.sze(a)}sze(a){this.sh.Bla(a)}Vua(a,b){this.lC?this.tF.DE(()=>
{this.oze(a,b)}):this.oze(a,b)}oze(a,b){this.sh.Vua(a,b)}Uua(){this.lC?this.tF.DE(Object(C.a)(this,this.nze,"processAnchorEnd")):this.nze()}nze(){this.sh.Uua()}Vz(a){this.lC?this.tF.DE(()=>{this.Eze(a)}):this.Eze(a)}Eze(a){this.sh.Vz(a)}Uz(){this.lC?this.tF.DE(Object(C.a)(this,this.Dze,"processParagraphEnd")):this.Dze()}Dze(){this.sh.Uz()}NVa(){this.lC?this.tF.DE(Object(C.a)(this,this.Gze,"processPreFormattedTextStart")):this.Gze()}Gze(){this.sh.NVa()}MVa(){this.lC?this.tF.DE(Object(C.a)(this,this.Fze,
"processPreFormattedTextEnd")):this.Fze()}Fze(){this.sh.MVa()}Gla(a){this.lC?this.tF.DE(()=>{this.yze(a)}):this.yze(a)}yze(a){this.sh.Gla(a)}Ela(){this.lC?this.tF.DE(Object(C.a)(this,this.vze,"processListEnd")):this.vze()}vze(){this.sh.Ela()}Zua(a){this.lC?this.tF.DE(()=>{this.xze(a)}):this.xze(a)}xze(a){this.sh.Zua(a)}Fla(){this.lC?this.tF.DE(Object(C.a)(this,this.wze,"processListItemEnd")):this.wze()}wze(){this.sh.Fla()}$W(a){this.lC?this.tF.DE(()=>{this.Tze(a)}):this.Tze(a)}Tze(a){this.sh.$W(a)}XW(){this.lC?
this.tF.DE(Object(C.a)(this,this.Qze,"processTableEnd")):this.Qze()}Qze(){this.sh.XW()}ZW(a){this.lC?this.tF.DE(()=>{this.Sze(a)}):this.Sze(a)}Sze(a){this.sh.ZW(a)}YW(){this.lC?this.tF.DE(Object(C.a)(this,this.Rze,"processTableRowEnd")):this.Rze()}Rze(){this.sh.YW()}WW(a){this.lC?this.tF.DE(()=>{this.Pze(a)}):this.Pze(a)}Pze(a){this.sh.WW(a)}VW(){this.lC?this.tF.DE(Object(C.a)(this,this.Oze,"processTableCellEnd")):this.Oze()}Oze(){this.sh.VW()}$ua(a,b){this.lC?this.tF.DE(()=>{this.zze(a,b)}):this.zze(a,
b)}zze(a,b){this.sh.$ua(a,b)}HGa(){this.lC?this.tF.DE(Object(C.a)(this,this.h6g,"processMathEnd")):this.h6g()}h6g(){this.sh.HGa()}}Object(e.a)(lC,"AQueuingHtmlNormalizer",kC,[]);class SH{constructor(a){this.next=null;this.data=a}}Object(e.a)(SH,"QueueNode",null,[]);class mC{constructor(){this.E_a=this.KZa=null;this.Hk=0}get count(){return this.Hk}get isEmpty(){return!this.Hk||!this.KZa||!this.E_a}enqueue(a){a=new SH(a);this.isEmpty?this.E_a=this.KZa=a:this.KZa=this.KZa.next=a;this.Hk++}back(){return this.isEmpty?
null:this.KZa.data}dequeue(){if(this.isEmpty)return null;const a=this.E_a;this.E_a=a.next;this.Hk--;this.E_a||(this.KZa=null);return a.data}clear(){this.E_a=this.KZa=null;this.Hk=0}toArray(){const a=Array(this.count);let b=this.E_a;for(let c=0;c<this.count&&b;c++)a[c]=b.data,b=b.next;return a}}Object(e.a)(mC,"Queue",null,[]);class fx{constructor(){this.Ozd=new mC}DE(a){this.Ozd.enqueue(a)}flush(a=!1){for(a&&this.rfd();!this.Ozd.isEmpty;)this.Ozd.dequeue()();a&&this.edd()}rfd(){}edd(){}}Object(e.a)(fx,
"QueuedEventManager",null,[]);class bz extends fx{constructor(a){super();this.id=void 0;this.KPd=null;this.lSc=!1;this.Zdc="";this.kSc=this.$Sc=!1;this.IPd=this.zpb=null;this.bcc=0;this.D3b=this.P4b=this.hae=!1;this.table=null;this.zse=0;this.OO=a}get OSb(){return!!this.table}rfd(){this.OO.mCb.push(this.OO.currentState);this.OO.currentState=this}edd(){this.OO.currentState=this.OO.mCb.pop()}}bz.nextId=void 0;Object(e.a)(bz,"ContentState",fx,[]);class TH{constructor(a,b,c){this.colSpan=a.colSpan;this.rowSpan=
a.rowSpan;this.width=a.width;this.height=a.height;this.sDa=a.sDa;this.Kjc=a.Kjc;this.verticalAlignment=a.verticalAlignment;this.U4=a.U4;this.Yid=a.Yid;this.fvb=a.fvb;this.mCc=a.mCc;this.contents=c;this.rgj=b}}Object(e.a)(TH,"TableCell",null,[]);class UH extends fx{constructor(a,b){super();this.OO=a;this.Tvf=new Ot;this.LF=new Ot;this.dxd=[];this.gwc=[];this.Nna=-1;this.Qxa=0;this.oMh=b.Cqg;this.nMh=b.KAj;this.MUh=b.cOe;this.k2a=b.width;this.f$e=b.sDa;this.ZKh=new hn(new Pt(b.qT.Djg,b.qT.P1b),b.Kv,
b.j4,b.cultureName,b.pga);this.OLh=b.f5d;this.pxc=b.osh;this.SUh=b.tableLook}get sh(){return this.OO.sh}fxk(a){this.Nna++;this.Tvf.add(a);this.gwc[this.Nna]=a.height;this.Qxa=0}get RAi(){for(;this.Qxa>=this.LF.count;)this.LF.add(Array(this.Nna+1));return this.LF.ga(this.Qxa)}mFd(a,b,c,f,l,w,F){if(0>this.Nna)return!1;for(;this.dxd[this.Qxa]>=this.Nna;)this.Qxa++;a=new TH(a,new hn(b,c,f,l,w),F);this.RAi[this.Nna]=a;if(1<a.rowSpan)for(b=this.Nna+a.rowSpan-1,f=this.Qxa,c=this.Qxa+a.colSpan-1;f<=c;f++)this.dxd[f]>=
b||(this.dxd[f]=b);this.Qxa+=a.colSpan;this.gwc[this.Nna]<a.height&&(this.gwc[this.Nna]=a.height);return!0}rfd(){this.OO.currentState.table=this}edd(){this.OO.currentState.table=null}w3f(){this.flush(!0);const a=this.Nna+1;var b=Array(a);for(var c=0;c<a;c++)b[c]=Array(this.LF.count);c=!0;var f=0;for(var l=0;l<this.LF.count;l++){var w=this.LF.ga(l),F=!0;for(var S=0;S<a;S++){var fa=w[S];fa&&(F=!1,b[S][l+f]=new Xy(fa.colSpan,fa.rowSpan,fa.width,fa.height,void 0,void 0,void 0,void 0,fa.sDa,fa.fvb))}F?
(this.LF.removeAt(l),l--,++f):c=!1}if(!c){(b=this.f$e?this.OO.eKf(b,this.k2a/100):this.OO.eKf(b))&&b.length!==this.LF.count&&(b=null);this.OO.cBa(!0);this.OO.gDc();this.sh.$W(new dC(a,this.LF.count,this.k2a,this.f$e,b,this.oMh,this.nMh,this.MUh,this.OLh,this.pxc,this.SUh,this.ZKh));for(b=0;b<a;b++){c=this.Tvf.ga(b);this.sh.ZW(new cC(this.gwc[b],new hn(c.qT,c.Kv,c.j4,c.cultureName,c.pga)));for(c=0;c<this.LF.count;c++){f=this.LF.ga(c)[b];var xa=!!this.pxc&&""!==this.pxc&&"Custom"!==this.pxc;l=f?f.colSpan:
0;w=f?f.rowSpan:0;F=f?f.width:0;S=f?f.height:0;fa=f?f.mCc:0;const Za=f?f.sDa:!1,pb=f&&(65536&fa||!xa)?f.Kjc:"",Mb=f?f.verticalAlignment:0,hc=f?f.fvb:!1;xa=f?this.OO.q6i(f.U4,c,b,this.LF,xa,f.mCc):new ZB;const kc=f?f.Yid:new $B,Ec=f?f.rgj:null;this.sh.WW(new Xy(l,w,F,S,pb,Mb,xa,kc,Za,hc,fa,new hn(Ec?Ec.qT:null,Ec?Ec.Kv:null,Ec?Ec.j4:null,Ec?Ec.cultureName:null,Ec?Ec.pga:null)));f&&!f.fvb&&(f.contents.rfd(),f.contents.flush(),this.OO.cBa(!1),this.OO.gDc(),f.contents.edd());this.sh.VW()}this.sh.YW()}this.sh.XW();
this.OO.currentState.D3b=!1;this.OO.JZf(!1)}}}Object(e.a)(UH,"NormalizedTable",fx,[]);class nC{constructor(a=!1,b=!1){this.LMh=a;this.AH=b}get xFj(){return this.LMh}get PT(){return this.AH}}Object(e.a)(nC,"HtmlNormalizerSettings",null,[323]);class Qr extends lC{constructor(a,b=null){super(a);this.currentState=null;this.mCb=new bx;this.Mjb=b||new nC}reset(){super.reset();this.currentState=new bz(this);this.mCb.clear();this.lC=!1}get tF(){return this.currentState&&this.currentState.OSb?this.currentState.table:
this.currentState}NHc(a=!1){this.currentState.lSc||(this.gDc(),this.sh.Vz(this.currentState.KPd),this.currentState.lSc=!0,this.currentState.D3b=!1);a||!this.currentState.zpb||this.currentState.kSc||(this.sh.Vua(this.currentState.zpb,this.currentState.IPd),this.currentState.kSc=!0)}jYb(){this.currentState.kSc&&(this.sh.Uua(),this.currentState.kSc=!1)}uKi(){this.currentState.lSc&&(this.sh.Uz(),this.currentState.lSc=!1,this.currentState.Zdc="")}JZf(a){this.currentState.P4b&&(this.currentState.D3b?a||
(this.sh.Vz(null),this.sh.Uz(),this.sh.Fla(),this.currentState.P4b=!1):(this.sh.Fla(),this.currentState.P4b=!1,this.currentState.D3b=!0))}cBa(a){this.jYb();this.uKi();this.JZf(a)}Xnk(a){this.sh.Gla(new cx(2,1,a));this.currentState.bcc++;this.currentState.hae=!0}gDc(){!this.currentState.P4b&&this.currentState.hae&&(this.sh.Ela(),this.currentState.bcc--,this.currentState.hae=!1)}Uze(a,b){a=this.Ock(a);if(""!==a)if(this.NHc(),this.currentState.$Sc)this.Vze(a,b);else{a=a.split(Qr.Dfi);for(let c=0;c<a.length-
1;c++)this.Vze(a[c],b),this.sh.SVa(b);this.Vze(a[a.length-1],b)}}zze(a,b){""!==a&&(this.NHc(),this.sh.$ua(a,b))}uze(a){this.Mjb.PT||this.jYb();this.NHc(!0);this.sh.Dla(a)}sze(a){this.currentState.OSb||this.sh.Bla(a)}Bfc(a){this.currentState.zpb&&(a.href=this.currentState.zpb);super.Bfc(a)}oze(a,b){this.jYb();this.currentState.zpb=a;this.currentState.IPd=b}nze(){this.jYb();this.currentState.zpb=null;this.currentState.IPd=null}Eze(a){this.currentState.KPd=a;this.cBa(!0)}Dze(){this.currentState.KPd=
null;this.cBa(!0)}Gze(){this.currentState.$Sc=!0}Fze(){this.currentState.$Sc=!1}yze(a){this.cBa(!1);this.gDc();this.sh.Gla(a);this.currentState.bcc++}vze(){this.cBa(!1);this.sh.Ela();this.currentState.bcc--}xze(a){this.cBa(!1);this.currentState.bcc||this.Xnk(a);this.sh.Zua(a);this.currentState.P4b=!0;this.currentState.D3b=!0}wze(){this.cBa(!1)}$W(a){this.currentState.OSb||(this.lC=!0,this.currentState.table=new UH(this,a))}Tze(){}XW(){if(this.currentState.table){var a=this.currentState.table;this.currentState.table=
null;this.mCb.isEmpty?(this.lC=!1,a.w3f()):this.tF.DE(Object(C.a)(a,a.w3f,"flushTable"))}}Qze(){}ZW(a){this.currentState.OSb&&this.currentState.table.fxk(a)}Sze(){}YW(){}Rze(){}WW(a){let b=!1;if(this.currentState.OSb){const c=new bz(this);this.currentState.table.mFd(a,new Pt(a.qT.Djg,a.qT.P1b),a.Kv,a.j4,a.cultureName,a.pga,c)?(this.mCb.push(this.currentState),this.currentState=c):b=!0}else b=!0;b&&this.currentState.zse++}Pze(){}VW(){0<this.currentState.zse?this.currentState.zse--:this.currentState=
this.mCb.pop()}Oze(){}eKf(a,b=1){if(!a)return null;const c=a.length;if(!c)return null;const f=a[0].length;for(var l=1;l<c;l++)if(a[l].length!==f)return null;l=Array(f+1);l[0]=0;const w=Array(f+1);for(var F=0;F<w.length;F++)w[F]=!1;F=new Ua.a;for(let fa=0;fa<f;fa++){for(var S=0;S<c;S++)if(a[S][fa]&&0<a[S][fa].width){const xa=Math.min(fa+a[S][fa].colSpan,f);l[xa]=l[fa]+a[S][fa].width*(a[S][fa].sDa?b:1);w[xa]=!0}if(w[fa+1]){S=l[fa+1]-l[fa];if(0>=S)return null;F.add(S)}else l[fa+1]=l[fa]}return F.toArray()}F9j(a,
b){1&b||(a.borderTopStyle=12);16&b||(a.borderRightStyle=12);256&b||(a.borderBottomStyle=12);4096&b||(a.borderLeftStyle=12);return a}q6i(a,b,c,f,l,w){if(!a)return null;l&&(a=this.F9j(a,w));if(0>c||0>b||b>f.count-1)return a;0<=b-1&&c<=f.ga(b-1).length-1&&1===a.borderLeftStyle&&(l=f.ga(b-1)[c])&&1!==l.U4.borderRightStyle&&(a.borderLeftStyle=l.U4.borderRightStyle,a.borderLeftColor=l.U4.borderRightColor,a.borderLeftWidth=l.U4.borderRightWidth);0<=c-1&&c<=f.ga(b).length-1&&1===a.borderTopStyle&&(b=f.ga(b)[c-
1])&&1!==b.U4.borderBottomStyle&&(a.borderTopStyle=b.U4.borderBottomStyle,a.borderTopColor=b.U4.borderBottomColor,a.borderTopWidth=b.U4.borderBottomWidth);return a}Ock(a){this.currentState.$Sc||(a=this.Mjb.xFj?a.replace(Qr.Yqj," "):a.replace(Qr.Xqj," "));a.startsWith(" ")&&(this.currentState.Zdc.endsWith(" ")||""===this.currentState.Zdc)&&(a=Ja.a.substring(a,1,a.length));return a}Vze(a,b){""!==a&&(this.sh.D_(a,b),this.currentState.Zdc+=a)}}Qr.Xqj=RegExp("[ \t\f\u200b\r\n]+","g");Qr.Yqj=RegExp("[ \f\u200b\r\n]+",
"g");Qr.Dfi="\t";Object(e.a)(Qr,"DefaultHtmlNormalizer",lC,[]);class VH extends Qr{constructor(a,b,c){super(a,c);this.L3e=!1;this.T_a=b}Bfc(a){this.T_a.G9c&&(u.AFrameworkApplication.XP?this.L3e||(a=new hf.StandardDialog,a.vd=0,a.Pe(1,CommonUIStrings.l_DialogClose),a.Tw(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.L3e=!0):this.T_a.o$j?this.T_a.qRg=!0:a.src&&""!==a.src?Jf.a.hS(a.src)===Jf.a.hS(window.location.href)?u.AFrameworkApplication.Va.processAction(D.a.Q2g,
2):a.src.startsWith("data:")&&19922944<a.src.length?u.AFrameworkApplication.Va.processAction(D.a.O2g,2):a.src.startsWith("webkit-fake-url")?u.AFrameworkApplication.Va.processAction(D.a.N2g,2):(I.a.instance.ga(1)?this.cBa(!1):I.a.instance.ga(11)&&(this.jYb(),this.NHc(!0)),this.sh.Cla(a)):u.AFrameworkApplication.Va.processAction(D.a.P2g,2))}}Object(e.a)(VH,"Box4HtmlNormalizer",Qr,[]);class WH{constructor(a,b,c,f,l,w,F,S,fa,xa){this.htmlProcessor=a;this.I4d=b;this.VCh=c;this.MSi=f;this.ZWk=l;this.$Wk=
w;this.rPc=F;this.Rqj=S;this.Tqj=fa;this.dRj=xa}}Object(e.a)(WH,"ExecutePasteArguments",null,[]);class XH extends mj{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){super(b,c,f,Za);this.G5=null;this.Zfa=a;this.Pod=l;this.Dtd=w;this.VCd=F;this.FEd=S;this.TMb=fa;this.Mjb=Mb;this.mb=xa;this.l4e=Object.assign(new aC,{mRc:2===this.jh.KNa||3===this.jh.KNa});this.Prd=pb;this.BQb=xa.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.iTh=xa.ka("ParseStyleFromRawHtmlHeadIsEnabled")}get Q5c(){return!1}get crg(){return!Ja.a.vil(Ja.a.vtc,
this.Zfa.innerText)}get uPf(){return this.Zfa.innerText}J_f(a){this.G5=new mb.GraphIterator;this.udb.restore(this.G5);Z.ULS.shipAssertTag(6305550,307,Md.OutlineElementReader.Tg(this.G5));this.jh.E_&&this.jh.E_.vAc("external");var b=this.jh.vw&8192?1:0,c=this.Dtd.value.create(b,this.G5);const f=this.VCd.value.create(b,this.G5),l=Km.a.Q1d(u.AFrameworkApplication.userSessionId),w=Km.a.RYd(r.a.e3a,this.jh.mMd),F=Km.a.tcg(u.AFrameworkApplication.userSessionId),S=Km.a.ucg(u.AFrameworkApplication.userSessionId),
fa=this.BQb?this.wvj():null,xa=Km.a.E9f(r.a.e3a,this.jh.mMd),Za=Km.a.F9f(u.AFrameworkApplication.userSessionId),pb=this.TMb.cnh?Km.a.v4i(u.AFrameworkApplication.userSessionId):null;b=this.Pod.value.create(b,this.G5,c,f,null,w);b=new RH(b,F,S);b=new VH(b,c,this.Mjb);b=new Fk(b,this.TMb,this.l4e,pb);b=new QH(b,xa,fa,this.mb);b=new Uq(b,Za);c=new WH(b,c,l,w,F,S,fa,xa,Za,pb);c=new Tb.a(a,Object(C.a)(this,this.hxk,"preprocessStyle"),c);c.vl("paste and request pictures");c.Ui=!a||a.Ui;c.run()}hxk(a){if(this.iTh){const b=
this.Zfa.getElementsByTagName("style");if(b&&0<b.length){Z.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let c=0;c<b.length;c++)this.Prd.Ksi(this.Zfa,b[c]),b[c]&&(b[c].parentNode.removeChild(b[c]),c--)}}a.Wg(Object(C.a)(this,this.ati,"convertWordListHtml"));return!0}ati(a,b){this.FEd.value.create(b.VCh).process(this.Zfa,a);a.Wg(Object(C.a)(this,this.vyk,"processHtml"));return!0}vyk(a,b){b.htmlProcessor.process(this.Zfa,a);b=b.I4d&&
b.I4d.G9c?Object(C.a)(this,this.cdd,"requestImages"):Object(C.a)(this,this.YYf,"endPasteOperation");a.Wg(b);return!0}cdd(a,b){if(b=b.I4d){let c=!1,f=!1,l=!1,w=!1,F=-1;const S=new H.DictionaryPropertySet,fa=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(Ca.a)(10,this.jh.od)){c=this.jh.od.ta(Sb.a.P8d,!1);const xa=this.jh.od.ta(Kd.a.sT,"");l=this.jh.od.ta(Kd.a.fSc,!1);w=this.jh.od.ta(ob.a.iN,!1);fa.test(xa)&&(f=!0);this.enh&&(F=this.jh.od.ta(Fs.a.KXb,-1))}else this.jh.vw&256&&this.Zfa&&
(c=!0,fa.test(this.Zfa.innerHTML)&&(f=!0));S.setValue(Sb.a.P8d,c);S.setValue(Kd.a.mNj,f);S.setValue(Kd.a.fSc,l);S.setValue(Fs.a.KXb,F);S.setValue(ob.a.iN,w);b.xUg&&(this.jh.z3b=!0,this.jh.Y4d=b.hGc,this.jh.kte=b.xUg,u.AFrameworkApplication.Va.processAction(D.a.cdd,2))}a.Wg(Object(C.a)(this,this.YYf,"endPasteOperation"));return!0}YYf(a,b){Km.a.gWj(b.VCh);Km.a.iUj(b.Tqj);Km.a.tVj(b.ZWk);Km.a.uVj(b.$Wk);Km.a.BUj(b.dRj);a="Others";b.rPc&&(b.rPc.fUj(),b.rPc.gUj(),a=b.rPc.rMe);Km.a.hUj(b.Rqj,a);Km.a.XTj(b.MSi,
a);return!1}wvj(){const a=new PH;a.HCb=r.a.e3a;this.jh&&(a.vw=this.jh.vw,a.rwe=this.jh.mMd,this.jh.od&&(a.Yze=this.jh.od.ta(Kd.a.M2g,"")));this.Zfa&&this.Zfa.innerHTML&&(a.L2g=this.Zfa.innerHTML.length);u.AFrameworkApplication.Zc&&(a.platform=u.AFrameworkApplication.Zc.Platform);return a}get rnh(){return!0}get qnh(){Z.ULS.shipAssertTag(6305551,307,!!this.G5);if(this.TMb.dnh(this.l4e)){let a=!1;Md.OutlineElementReader.Tg(this.G5)&&(this.G5.P0b(),a=!0);const b=db.ParagraphReader.Pk(this.G5)&&!this.G5.currentNode.ta(Kd.a.Vrg,
!1);a&&this.G5.yc();return b}return db.ParagraphReader.Pk(this.G5)}}Object(e.a)(XH,"ExternalPasteExecutionManager",mj,[]);class YH{constructor(a,b,c,f,l,w,F,S){this.Pod=a;this.Dtd=b;this.VCd=c;this.FEd=f;this.TMb=l;this.mb=w;this.Prd=F;this.Mjb=S}create(a,b,c,f){return new XH(a,b,c,f,this.Pod,this.Dtd,this.VCd,this.FEd,this.TMb,this.mb,gb.App.Fb.Fd,this.Prd,this.Mjb)}}Object(e.a)(YH,"Factory",null,[587]);class cz{constructor(a){this.Bia=a.h3i();this.O6a=a.CLc("intCopy");this.Y8c=a.u_d("intCopy");
this.y3a=a.EKc("intCopy");this.eNa=a.sKc("intCopy")}static kV(){return cz.Xq()}static Xq(){return new cz(cg.a.instance)}}Object(e.a)(cz,"InternalCopyUsageHelper",null,[]);class gx{constructor(a,b,c){this.uM=cz.kV();this.ICc=null;this.Mgd=this.bmd=!1;this.p1e=null;this.source=a;this.target=b;this.Swe=c}get j5(){return this.uM}get jK(){return this.p1e}set jK(a){this.p1e=a}}Object(e.a)(gx,"InternalCopyArguments",null,[]);class ZH extends gx{constructor(a,b,c,f){super(a,b,{});this.iFb=[];for(a=0;a<c.length;a++)Array.addRange(this.iFb,
c.ga(a).toArray());this.Wpa=0;this.Rgj=f}}Object(e.a)(ZH,"BasicInternalCopyArguments",gx,[]);class $H extends Sys.EventArgs{constructor(a){super();this.jK=a}}Object(e.a)($H,"BeforePasteArguments",Sys.EventArgs,[]);class dz extends gx{constructor(a,b){super(a.source,a.target,a.Swe);this.jh=a;this.insertAfter=b}get j5(){return this.jh.j5}get jK(){return this.jh.jK}set jK(a){this.jh.jK=a}}Object(e.a)(dz,"CoreInternalCopyArguments",gx,[]);class ez{constructor(a,b,c,f,l=null){this.source=a;this.target=
b;this.insertAfter=c;this.M8c=f;this.jK=l||{}}}Object(e.a)(ez,"CoreInternalPasteArguments",null,[]);class aI{constructor(a,b,c,f,l,w,F,S,fa){this.JHb=a;this.source=b;this.target=c;this.M8c=f;this.rowIndex=l;this.$ga=w;this.A2g=S;this.Gf=fa}}Object(e.a)(aI,"CoreInternalTablePasteArguments",null,[]);class fz extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.operation=a;this.clone=f;this.jK=l}}Object(e.a)(fz,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var Vq=d(201);class ii{static Qq(){ii.QEb=
new dc.a;ii.QEb.$(88,!0);ii.QEb.$(4,!0)}static Wqa(a,b,c){const f=[];if(I.a.instance.ga(104)&&a.nl&&fd.SelectionFactory.lMj(a))a=mb.GraphIterator.nb(a.kb.hg.Wa.node),a.oc(14),c=Fc.a.create(a.origin),c=ii.LAc(c,!0,!0,null),a.set(c),Cb.SelectionEditor.Rs(a),ii.rPa(a,f);else for(let xa=0;xa<a.length&&!(c&&0<f.length);++xa){var l=a.ga(xa),w=ii.wLc(l,!0),F=ii.wLc(l,!1);if(!w||!F)continue;if(w===F&&w.contextId===Db.a.Ff){l=mb.GraphIterator.nb(w.node);l.oc(11)&&ii.rPa(l,f);continue}var S=void 0;S=l=null;
var fa=-1;let Za;if(w.node===F.node)Za=w.node,F=F.node;else{S=ii.w5f(w.node);l=ii.w5f(F.node);for(fa=0;fa<S.length&&fa<l.length&&S[fa]===l[fa];++fa);S=S[fa-1];--fa;Za=ii.LAc(w,!0,!1,S);F=ii.LAc(F,!1,!0,S)}if(Za===F)l=Za===w.node?w:Fc.a.create(Za),l=ii.LAc(l,!0,!0,null),w=new zn.a,w.set(l),Cb.SelectionEditor.Rs(w),ii.rPa(w,f);else{w=new zn.a;w.set(Za);Cb.SelectionEditor.Rs(w);Za===S&&w.Ii();for(ii.rPa(w,f);w.parentNode!==S;){for(;w.fp();)ii.rPa(w,f);w.yc()}if(F===S)for(;w.fp();)ii.rPa(w,f);else{w.fp();
for(S=fa+1;S<l.length;++S){for(;w.currentNode!==l[S];)ii.rPa(w,f),w.fp();if(F===l[S])break;w.Ii()}ii.rPa(w,f)}}}if(0>=f.length)return null;if(b)for(b=new mb.GraphIterator,a=0;a<f.length;++a)b.set(f[a].node),lc.OutlineElementNavigator.ti(b),f[a]=Fc.a.create(b.currentNode);return Ra.a.VNa(f)}static wLc(a,b){if(b)for(b=0;b<a.length;++b){if(a.ga(b).Ok)return a.ga(b);if(a.ga(b).Cw){var c=a.ga(b);for(var f=0;f<c.length;++f)if(c.getContext(f).Ok)return c.getContext(f)}}else for(b=a.length-1;0<=b;--b){if(a.ga(b).Ok)return a.ga(b);
if(a.ga(b).Cw)for(c=a.ga(b),f=c.length-1;0<=f;--f)if(c.getContext(f).Ok)return c.getContext(f)}return null}static rPa(a,b){ii.Fug(a)?ii.oPi(a,b):ii.QEb.Kb(a.role)||(a=a.lw(11),!a||b.length&&b[b.length-1].node===a||Array.add(b,Fc.a.create(a)))}static w5f(a){const b=[],c=new mb.GraphIterator;c.set(a);Cb.SelectionEditor.Rs(c);for(Array.add(b,a);c.yc();)Array.add(b,c.currentNode);b.reverse();return b}static LAc(a,b,c,f){let l=a.node;if(Cb.SelectionEditor.Oj(a)&&(b&&0<a.Qa||c&&a.Lb<db.ParagraphReader.textLength(l))||
Cb.SelectionEditor.Bl(a)&&b&&0<db.ParagraphReader.textLength(l))return l;a=new zn.a;a.set(l);for(Cb.SelectionEditor.Rs(a);!a.Fq;){l=a.currentNode;if(f===l||b&&!ii.UDj(a)||c&&!ii.aGj(a))return l;a.yc()}return a.currentNode}static aGj(a){let b=!0;if(a.fp())for(b=!1;ii.QEb.Kb(a.role)||I.a.instance.ga(77)&&16===a.ri&&Ce.isGhostCell(a);)if(!a.fp()){b=!0;break}return b}static UDj(a){const b=a.currentNode;let c=!0;if(a.pCa())for(c=!1;ii.QEb.Kb(a.role);)if(!a.pCa()){c=!0;break}a.yc();a.Ck(b);return c}static oPi(a,
b){a=sh.a.Gu(a);for(a.Il(ii.ePi,null);a.moveNext();)Md.OutlineElementReader.H7(a.currentNode)&&Array.add(b,Fc.a.create(a.currentNode))}static ePi(a){return ii.Fug(a)}static Fug(a){return a.Fq||1===a.role||27===a.role}}ii.QEb=null;Object(e.a)(ii,"OutlineElementGeneralizer",null,[]);ii.Qq();class bI{constructor(){this.controlCell=this.Jo=null;this.colSpan=this.rowSpan=0;this.response=2}}Object(e.a)(bI,"ComplexCellData",null,[]);var hx=d(172);class oC{constructor(a){this.zm=a;a.GSj()}dispose(){this.zm.spl()}static nb(a){return new oC(a.zk)}}
Object(e.a)(oC,"TempGraphAlgorithmLock",null,[109]);class Bh{constructor(a,b,c){this.E_e=this.wH=null;this.Suc=[];this.mqc=[];this.jxc=[];this.OKb={};this.iyd={};this.lod={};this.NC=null;this.P1a=Bh.Sdj(a);this.P1a.K9j();this.lVh=oC.nb(this.P1a);Bh.Wib=this;this.X5=1;this.Bqd=b;this.k_a=c}get rq(){return this.NC||(this.NC=lb.a.instance.resolve("Box4.ITableEditor"))}get OI(){return this.wH||(this.wH=lb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}normalize(){if(!(0<--this.X5)){var a=new Oe.GraphTransaction(7);
a.hd(this.P1a);this.Kzk();this.I$j();this.OQi();I.a.instance.ga(63)&&this.Nki();this.QQi();a.dispose();this.D1()}}k3k(a){this.E_e=a}QQi(){var a=mb.GraphIterator.nb(this.P1a);if(!a.rCa()){const b=this.OI.cWb(a);Bh.$A.zY(a,!0);a=gb.App.Fb.Fd.Xm;a.Po&&Bh.$A.Nfd(b,a.J0b())}}cancel(){if(!(0<--this.X5)){var a=hx.a.pz(this.P1a);for(a.Il(Bh.OWe,null);a.moveNext();)a.iterator.Fq||a.iterator.PX(16,!1);this.D1()}}D1(){this.P1a.tpl();this.lVh.dispose();Bh.Wib=null}ena(a){a.Ok?(Bh.gNj(a)&&Array.add(this.Suc,a.node),
this.Mvh(a.node)):a.Cw&&this.Rkl(a)}Rkl(a){for(let b=0;b<a.length;++b)this.ena(a.getContext(b))}Mvh(a){a.anchor.oS(16)}I$j(){for(let b=0;b<this.Suc.length;++b){var a=this.Suc[b];if(!a.anchor||a.anchor.iI)continue;const c=new mb.GraphIterator;c.set(a);if(!Cb.SelectionEditor.Rs(c))continue;lc.OutlineElementNavigator.Ke(c);if(this.k_a.ehi(c)){Bh.Lh.NAa(c);continue}a=new zn.a;a.Pc(c);if(!lc.OutlineElementNavigator.KI(a,!1,!1))continue;if(36===a.role)continue;lc.OutlineElementNavigator.ti(a);if(a.currentNode.AV)continue;
if(Cd.TableReader.Jp(a))continue;lc.OutlineElementNavigator.Ke(a);const f=new mb.GraphIterator;f.Pc(a);f.yc();Bh.Lh.merge(c,a,!1,!1);Md.OutlineElementReader.hI(f)&&!f.rCa()&&a.Hi()}Array.clear(this.Suc)}Nki(){for(let a=0;a<this.jxc.length;++a){const b=this.jxc[a];if(!b.anchor||b.anchor.iI)continue;if(Ce.isGhostCellNode(b))continue;const c=new mb.GraphIterator;c.set(b);c.xA(1);c.yb(2);Cd.TableReader.Jp(c)&&(c.yc(),Bh.Lh.Oba(c,!1,!0,null))}Array.clear(this.jxc)}kYi(a){const b=a.id.toString();if(this.OKb[b])return this.OKb[b];
const c=Array(Cd.TableReader.ui(a));for(let f=0;f<Cd.TableReader.ui(a);++f)c[f]=0;this.OKb[b]=c;this.iyd[b]=Cd.TableReader.Zj(a);return c}Kzk(){const a=hx.a.pz(this.P1a);a.Il(Bh.OWe,null);var b=a.moveNext();const c=new mb.GraphIterator;let f=0;for(;b;)if(a.iterator.Fq)this.Aki(a.iterator),b=a.moveNext();else if(this.k_a.kIj(a.iterator)&&Array.add(this.mqc,a.iterator.currentNode),I.a.instance.ga(63)&&Ce.isTableCell(a.iterator)&&Array.add(this.jxc,a.iterator.currentNode),Bh.lhi(a.iterator))switch(a.iterator.ri){case 16:b=
Fd.getContainingTable(a.iterator);if(this.Bqd&&!Cd.TableReader.gu(b)&&!Ce.isGhostCell(a.iterator)){b=this.kYi(b);var l=Ln.a(a.iterator);++b[l]}b=a.moveNext();break;case 15:b=Fd.getContainingTable(a.iterator);this.Bqd&&!Cd.TableReader.gu(b)?(this.lod[b.id.toString()]=!0,c.Pc(a.iterator),b=a.moveNext(),this.rq.UFc(c)):b=a.moveNext();break;case 14:a.iterator.currentNode!==this.E_e?(a.moveNext(),c.Pc(a.iterator),b=a.moveNext(),Bh.Lh.NAa(c)):(a.iterator.PX(16,!1),b=a.moveNext());break;case 23:c.Pc(a.iterator);
b=a.moveNext();c.Hi();break;case 11:f++;lg.b(a.iterator)?(a.iterator.PX(16,!1),b=a.moveNext()):(c.Pc(a.iterator),yc.ListReader.$j(c)&&!this.k_a.eKe(c,f)&&Bh.dr.hma(c),c.$H(2)?this.k_a.X6k(c,f)?b=a.moveNext():(c.Pc(a.iterator),b=a.moveNext(),Bh.Lh.NAa(c)):(b=a.moveNext(),Bh.Lh.NAa(c)));break;case 12:b=a.moveNext();break;default:b=a.moveNext()}else{l=!0;if(Cd.TableReader.Jp(a.iterator)&&this.Bqd){var w=a.currentNode;let F=w.id.toString();const S=this.OKb[F];let fa=!1;if(S){const xa=this.iyd[F];for(w=
Cd.TableReader.ui(w)-1;0<=w;--w)S[w]===xa&&(this.rq.SFc(a.iterator,w),fa=!0)}Cd.TableReader.ui(a.iterator.currentNode)?I.a.instance.ga(30)&&(fa||this.lod[F])&&Cd.TableReader.D$d(a.iterator.currentNode)&&(c.Pc(a.iterator),Fd.moveToFirstRow(c),Fd.moveToFirstColumn(c),b=a.moveNext(),Bh.Lh.Ych(a.iterator,c)):(a.moveNext(),c.Pc(a.iterator),b=a.moveNext(),c.Hi(),l=!1)}l&&(a.iterator.PX(16,!1),b=a.moveNext())}this.OKb={};this.iyd={};this.lod={}}Aki(a){if(a.Ii()){do a.PX(16,!1);while(a.oCa())}}OQi(){for(let b=
0;b<this.mqc.length;++b){var a=this.mqc[b];if(a.anchor&&!a.anchor.iI){const c=new mb.GraphIterator;c.set(a);vg.OutlineNavigator.q9(c)||(c.currentNode.setValue(ob.a.LD,en.a.first),I.a.instance.ga(41)&&10===c.ri&&(a=Bh.Lh.f6d(c,null,1),c.Ck(a)),Bh.$A.zY(c,!0))}}Array.clear(this.mqc)}static get dr(){return Bh.Eo||(Bh.Eo=lb.a.instance.resolve("Box4.List.IListEditor"))}static get $A(){return Bh.ix||(Bh.ix=lb.a.instance.resolve("Box4.IOutlineEditor"))}static get Lh(){return Bh.xi||(Bh.xi=lb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get eH(){return ul.a.instance}static get Vi(){return Rf.a.instance}static nMc(a,
b){Bh.Wib?Bh.Wib.X5++:Bh.Wib=new Bh(a,b,lb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"));return Bh.Wib}static Sdj(a){a=mb.GraphIterator.nb(a);Cb.SelectionEditor.Rs(a);a.OEb(b=>b.M4b);return a.currentNode}static gNj(a){let b=!1;Cb.SelectionEditor.Bl(a)&&(b=!I.a.instance.ga(14)||!Bh.Vi.IRc(a));!b&&db.ParagraphReader.Tl(a)&&(b=!I.a.instance.ga(14)||!Bh.Vi.JSc(a)&&!a.node.ta(Sb.a.C8a,!1));return b}static lhi(a){switch(a.ri){case 12:return a.currentNode.ZBc}if(!a.Ii())return Bh.eH.ixg(a)?
Bh.eH.JKd(a.currentNode):!0;let b=!0;do{switch(a.role){case 2:case 1:case 3:case 86:case 87:a.zV&16||16===a.ri&&Ce.isGhostCell(a)||(b=!1)}a.PX(16,!0)}while(a.oCa());b&&Bh.eH.ixg(a)&&(b=Bh.eH.JKd(a.currentNode));return b}static dhi(a){return a.Fq||!!(a.zV&16)}}Bh.OWe=Bh.dhi;Bh.Wib=null;Bh.Ta=new sd.a;Bh.ix=null;Bh.Eo=null;Bh.xi=null;Object(e.a)(Bh,"GraphStructureNormalizer",null,[]);class Qt{constructor(){this.TGb=this.Jo=this.kC=null;this.wcb=0;this.response=2}}Object(e.a)(Qt,"TableGeneralizeData",
null,[]);class Vh{static get Ml(){return xi.ContextSetEditor.instance}static m4(a,b,c,f,l,w,F){let S=!1;w&&w[Vh.wJb]&&w[Vh.wJb]&&(S=!0);if(!b.view.Jh)return 2;const fa=b.view;var xa=fa.Eb;if(1===c){if(!xa||!xa.Pa.kb)return 8;b=0===F?b.HD:Vh.Ml.BZb(b.HD,F,!0);return u.AFrameworkApplication.Va.li(b,a,c,!0,f,l)}w&&w[Vh.rna]&&Me.a.mark(w[Vh.rna]);const Za=mm.SelectionReferenceFactory.instance.bqa(),pb=xa.Pa.kb.Wa;xa=new Oe.GraphTransaction(15);xa.hd(pb.node);xa.fwa();b=0===F?b.HD:Vh.Ml.BZb(b.HD,F);a=
u.AFrameworkApplication.Va.li(b,a,c,!0,f,l);32===a&&Za.yT(S);v.FocusManager.instance().vf(fa.NH);xa.dispose();gb.App.Fb.updateCommandUI();w&&w[Vh.qna]&&Me.a.mark(w[Vh.qna]);return a}static ldb(a,b,c,f,l,w){var F=dd.a.instance;let S,fa=!1;w&&w[Vh.wJb]&&w[Vh.wJb]&&(fa=!0);if(1===c)return F&&F.Pa.kb?(S=ii.Wqa(F.Pa,!1,!0))?u.AFrameworkApplication.Va.li(S,a,c,!0,f,l):8:8;w&&w[Vh.rna]&&Me.a.mark(w[Vh.rna]);const xa=mm.SelectionReferenceFactory.instance.bqa(),Za=F.Pa.kb.Wa;S=ii.Wqa(F.Pa,!1);if(!S)return 8;
F=new Oe.GraphTransaction(15);F.hd(Za.node);F.fwa();a=u.AFrameworkApplication.Va.li(S,a,c,!0,f,l);32===a&&xa.yT(fa);(b=b.view)&&v.FocusManager.instance().vf(b.NH);F.dispose();gb.App.Fb.updateCommandUI();w&&w[Vh.qna]&&Me.a.mark(w[Vh.qna]);return a}}Vh.rna="PerfMarkStart";Vh.qna="PerfMarkEnd";Vh.wJb="CollapseIp";Object(e.a)(Vh,"ViewActionHandler",null,[]);var cI=d(548);class dI{constructor(){this.controlCell=null;this.ONf=this.sfh=0;this.Q2f=this.R2f=null}}Object(e.a)(dI,"MergedCellInfo",null,[]);var ix=
d(310),eI=d(659),FP=d(705),Mn=d(351);class gv extends uj.a{constructor(a){super(0,0,0);this.v6=a;this.aKa=Array(a)}nYi(a){return this.aKa[a]}Xih(a,b){this.aKa[a]=b}copy(){const a=new gv(this.v6);for(let b=0;b<this.v6;++b)a.aKa[b]=this.aKa[b];return a}Q$j(){let a=Mn.a.Fgb;for(let b=0;b<this.v6;++b)a+=this.aKa[b]+1;return a}static vni(a,b){const c=new gv(a.v6);for(let f=0;f<c.v6;f++)c.aKa[f]=Math.max(a.aKa[f],b.aKa[f]);return c}}Object(e.a)(gv,"TableRowViewSizeConstraints",uj.a,[]);class Rt extends vl.a{constructor(a,
b,c,f,l,w=null){super(a,b,c);this.JZa=null;this.aqd=0;this.ipc=-1;this.$c=f;this.Yc=l;this.lc(this.Gd.Lo(ma.a.tr));this.htmlElement.className="TableRow";Ea.d(this.htmlElement,Ka.a.role,"row");this.Mch();this.S_e=w}eA(){this.gb.T1g=[];this.htmlElement.style.height=this.qfh;this.Mch()}Mch(){this.$c&&this.$c.XCa(65)&&(this.gb.AVb?Sys.UI.DomElement.addCssClass(this.htmlElement,Ub.C2):Sys.UI.DomElement.removeCssClass(this.htmlElement,Ub.C2))}xZk(a){const b=this.ipc!==a;this.ipc=a;return b}otl(){this.htmlElement.style.height=
this.rfh+"px"}get rfh(){let a=0>=this.ipc?Rt.gSg:this.ipc;this.gb.Sa(Sb.a.Nt)&&(a=Math.max(a,this.Gd.Ed.Ie(this.gb.getValue(Sb.a.Nt),1)));return a}get qfh(){return this.gb.Sa(Sb.a.Nt)?this.Gd.Ed.Ie(this.gb.getValue(Sb.a.Nt),1)+"px":"auto"}vT(a){super.vT(a);var b=Cd.TableReader.ui(Fd.getContainingTable(a));let c=0;b=new gv(b);if(a.yb(1)){do b.Xih(c,a.xq.sIa.total),c++;while(a.xj(1))}return b}XL(a){super.XL(a);this.HQ.nT(this.htmlElement)}get author(){return this.JZa}SRe(a){let b=!0;if(this.Qc.Po&&
this.Qc.oAj){a=sh.a.Gu(a);for(var c={};a.moveNext();){if(!Md.OutlineElementReader.Tg(a.iterator)||Md.OutlineElementReader.C3d(a.iterator))continue;const f=Md.OutlineElementReader.qKc(a.currentNode,ob.a.qTb);f&&(c[f]="")}a=va.a.join(c,Box4Intl.Box4Strings.l_UserInitialsDelimeter,"");c=Sys.UI.DomElement.getBounds(this.htmlElement);0<c.height&&(this.JZa=a,this.aqd=c.height,b=!1)}b&&(this.JZa="",this.aqd=-1)}get yNd(){return this.aqd}LOk(){this.S_e&&this.S_e.HBl(this)}}Rt.gSg=20;Object(e.a)(Rt,"TableRowViewElement",
vl.a,[467]);class Ch{constructor(a,b){Ch.ix=a;Ch.xi=b}lRk(a){const b=a.ejd.currentNode;this.Krl(b);let c=this.Hti(b);var f=this.Scj(b,c);let l=f.length;a.ZFc=this.aQi(f);a.XFc=this.sPi(f);f=a.ZFc.toArray().length;const w=a.XFc.toArray().length;if(0<f||0<w)l-=f,c-=w,this.Ztl(a);this.SFb(Object(ua.a)(fg.a,b),l);this.DFb(Object(ua.a)(fg.a,b),c);this.PQk(a)}sPi(a){const b=new Ua.a;for(let c=0;c<a[0].length;c++){let f=!0;for(let l=0;l<a.length;l++)if(1===a[l][c]){f=!1;break}f&&b.add(c)}return b}aQi(a){const b=
new Ua.a;for(let c=0;c<a.length;c++){let f=!0;for(let l=0;l<a[c].length;l++)if(1===a[c][l]){f=!1;break}f&&b.add(c)}return b}Hti(a){let b=0;a=mb.GraphIterator.nb(a);Fd.moveToFirstRow(Object(ua.a)(mb.GraphIterator,a));Fd.moveToFirstColumn(Object(ua.a)(mb.GraphIterator,a));let c=Object(ua.a)(124,a.Gp),f=!1;for(;c;)!c.isGhostCell||Ce.isSkippedCell(Object(ua.a)(fg.a,c))?(b+=c.Y6a?c.colSpan:1,f=!0):f||b++,c=Object(ua.a)(124,Fd.moveToNextColumn(Object(ua.a)(mb.GraphIterator,a)));return b}Ztl(a){const b=
mb.GraphIterator.nb(a.ejd.Gp);let c=0;Fd.moveToFirstRow(Object(ua.a)(mb.GraphIterator,b));var f=b.Gp;const l=fe.a.yf(Rt.gSg,1);for(;f;){for(;a.ZFc.contains(c);)c++;var w=1,F=a.Mkc?a.Mkc.rowIndex:0,S=a.Iqh[F+c];for(S<l&&(S=l);a.ZFc.contains(c+w);){var fa=a.Iqh[F+c+w];fa<l&&(fa=l);S+=fa;w++}f.setValue(Sb.a.Nt,S);f=w-1;w=0;Fd.moveToFirstColumn(Object(ua.a)(mb.GraphIterator,b));for(F=Object(ua.a)(124,b.Gp);F;){S=F.Y6a?F.colSpan:1;if(!F.isGhostCell||1<S){0<f&&(F.rowSpan-=f,1>F.rowSpan&&(F.rowSpan=1));
fa=0;for(let xa=1;xa<S;xa++)a.XFc.contains(w+xa)&&fa++;0<fa&&(F.colSpan-=fa,1>F.colSpan&&(F.colSpan=1))}w+=S;F=Object(ua.a)(124,Fd.moveToNextColumn(Object(ua.a)(mb.GraphIterator,b)))}c++;Fd.moveToFirstColumn(Object(ua.a)(mb.GraphIterator,b));b.yc();f=Fd.moveToNextRow(Object(ua.a)(mb.GraphIterator,b))}}Krl(a){const b=new Ua.a;a=mb.GraphIterator.nb(a);Fd.moveToFirstRow(Object(ua.a)(mb.GraphIterator,a));for(var c=a.Gp;c;){c=!1;let l=0;Fd.moveToFirstColumn(Object(ua.a)(mb.GraphIterator,a));for(var f=
Object(ua.a)(ix.TableCellNode,a.currentNode);f;){if(f.isGhostCell)f.Y6a?(c=!0,b.contains(l)||(f.isGhostCell=!1,f.SLd())):Ce.isSkippedCell(Object(ua.a)(fg.a,f))||b.contains(l)&&(c||I.a.instance.ga(77))||(f.isGhostCell=!1,f.SLd());else{c=!0;f=f.Y6a?f.colSpan:1;for(let w=0;w<f;w++)b.contains(l+w)||b.add(l+w)}l++;f=Object(ua.a)(ix.TableCellNode,Fd.moveToNextColumn(Object(ua.a)(mb.GraphIterator,a)))}Fd.moveToFirstColumn(Object(ua.a)(mb.GraphIterator,a));a.yc();c=Fd.moveToNextRow(Object(ua.a)(mb.GraphIterator,
a))}}Scj(a,b){const c=[];let f=0;a=mb.GraphIterator.nb(a);Fd.moveToFirstRow(Object(ua.a)(mb.GraphIterator,a));for(var l=a.Gp;l;){l=0;Fd.moveToFirstColumn(Object(ua.a)(mb.GraphIterator,a));for(var w=Object(ua.a)(124,a.Gp);w;){if(!w.isGhostCell||Ce.isSkippedCell(Object(ua.a)(fg.a,w))){const F=w.Y6a?w.colSpan:1;for(w=w.x3d?w.rowSpan:1;f<c.length&&2===c[f][l];)l++,(l%=b)||f++;for(let S=0;S<w;S++){const fa=f+S;fa===c.length&&Array.add(c,Array(b));for(let xa=0;xa<F;xa++)c[fa][l+xa]=0<S||0<xa?2:1}l+=F}w=
Object(ua.a)(124,Fd.moveToNextColumn(Object(ua.a)(mb.GraphIterator,a)))}Fd.moveToFirstColumn(Object(ua.a)(mb.GraphIterator,a));a.yc();l=Fd.moveToNextRow(Object(ua.a)(mb.GraphIterator,a));f++}return c}PQk(a){if(Cd.TableReader.Jp(a.ejd)&&a.Mkc&&a.Gqh){var b=Object(ua.a)(126,a.ejd.Gp),c=a.Gqh,f=Array(b.v6),l=a.Mkc.$ga;for(let w=0;w<f.length;w++)for(f[w]=c[l],l++;a.XFc.contains(l-a.Mkc.$ga);)f[w]+=c[l],l++;b.DNa=f}}sxa(a){if(I.a.instance.ga(77)||I.a.instance.ga(63))Fd.forEachCellInTable(a,b=>{b.currentNode.kGa=
null;return!0}),Fd.forEachCellInTable(a,b=>{const c=b.currentNode;if(!c.isGhostCell){const f=c.rowSpan,l=c.colSpan;1<f||1<l?this.Vwi(b,f,l):c.yEe()}return!0})}Vwi(a,b,c){const f=a.currentNode,l=new mb.GraphIterator;l.Pc(a);Fd.forEachCell(l,b,c,(w,F,S)=>{const fa=w.currentNode;if(fa!==f){fa.isGhostCell=!0;let Za=!1;var xa=!0;const pb=Ch.pe;pb&&(Za=pb.isFeatureEnabled(136),pb.m9a(136));do{w.yb(1);if(Object(Ca.a)(cI.a,w.currentNode)){if((xa=xa&&Md.OutlineElementReader.isEmpty(w,!1))||!Za)xa=mb.GraphIterator.nb(w.Gp),
xa.oc(16),xa=!xa.xf(1);xa||a.hl(w.currentNode,1);w.Hi()}xa=!1}while(Za&&w.$H(1))}fa.kGa=Object.assign(new dI,{controlCell:f,sfh:F,ONf:S});1!==F||S||(f.kGa.Q2f=fa);F||1!==S||(f.kGa.R2f=fa);fa.yEe();S||(fa.colSpan=c)});f.rowSpan=b;f.colSpan=c}V5d(a){const b=new mb.GraphIterator;b.Pc(a);Fd.returnToContainingRow(b);var c=b.currentNode;b.yb(1);const f=new mb.GraphIterator;f.Pc(a);Fd.returnToContainingTable(f);a=f.currentNode;this.sxa(f);const l=ws.a.instance.createInstance(393251);this.z2b(f,l,c,c,!1);
f.Ck(l);c=Cd.TableReader.ui(a);for(let w=0;w<c;++w){const F=b.currentNode,S=this.fqa();this.gSb(f,S,F,!1,!0);if(!S.isGhostCell)if(F.isGhostCell){let fa;(fa=F.kGa.controlCell).rowSpan=fa.rowSpan+1}else F.rowSpan=2;b.xf(1)}this.SFb(a,Cd.TableReader.Zj(a)+1);Fd.returnToContainingTable(f);this.sxa(f);return l}U5d(a){const b=mb.GraphIterator.nb(a.yBh());let c=Cd.TableReader.ui(b.currentNode);a=Ln.a(a);const f=a+1;this.sxa(b);b.yb(1);do{const w=b.Hp(a,1);b.yc();const F=this.fqa();this.r2b(b,F,w,!1,!1);
if(!F.isGhostCell)if(w.isGhostCell){var l=void 0;(l=w.kGa.controlCell).colSpan=l.colSpan+1}else w.colSpan=2}while(b.xj(1));this.sxa(b);(l=b.currentNode.ta(ob.a.ru,null))&&(l=Ma.a.clone(l));this.DFb(b.currentNode,++c);l&&(Array.insert(l,f,l[a]),b.currentNode.setValue(ob.a.ru,l));this.Occ(b.currentNode,f,!1,1,null)}ncd(a,b){Cd.TableReader.gu(a.currentNode)&&I.a.instance.ga(63)&&this.Fah(a,c=>this.i2i(c,b),(c,f)=>{c.ke(Sb.a.Nt,f)},Sb.a.complexTable)}Qjj(a,b,c,f){let l=b;const w=b.kGa;I.a.instance.ga(77)&&
(a.isGhostCell=!1);if(w)if(Ch.pMc(w,!f))a.isGhostCell=!0;else{const F=Ch.xrb(w.controlCell,f);!b.isGhostCell&&c||!c&&Ch.pMc(w,f)===F-1?(l=w.controlCell,!f&&l.x3d&&(a.rowSpan=l.rowSpan)):(a.isGhostCell=!0,Ch.bfb(w.controlCell,f,F+1));f&&l.Y6a&&(a.colSpan=l.colSpan)}return l}zij(a,b,c){var f=a.kGa;if(f)if(a.isGhostCell)this.ujj(f,b);else if(f=Ch.xrb(a,b),1<f){const l=Ch.xrb(a,!b),w=new mb.GraphIterator;w.set(a);w.oc(14);a=new mb.GraphIterator;a.Pc(w);const F=b?Fd.moveToNextRow(a):a.xf(1);Ch.bfb(F,b,
f-1);Ch.bfb(F,!b,l);c(a,w)}}ujj(a,b){Ch.pMc(a,!b)||Ch.bfb(a.controlCell,b,Ch.xrb(a.controlCell,b)-1)}ZIb(a,b){let c=!1;Fd.forEachCellInTable(a,f=>Ce.isGhostCell(f)?(c=!0,!1):!0);a.currentNode.ke(b,c)}Fah(a,b,c,f){var l=Cd.TableReader.Zj(a.currentNode);const w=Cd.TableReader.ui(a.currentNode);if(l&&w){var F=!1,S=!1,fa=Array(l);Fd.forEachCellInTable(a,(hc,kc,Ec)=>{Ec||(fa[kc]=Array(w));hc=hc.currentNode;hc.isGhostCell?Ce.isSkippedCell(hc)?fa[kc][Ec]=2:fa[kc][Ec]=1:fa[kc][Ec]=0;return!0});var xa=Array(l),
Za=Array(l);for(var pb=0;pb<l;pb++){var Mb=!!pb;let hc=!0;for(let kc=0;kc<w;kc++)if(fa[pb][kc])1===fa[pb][kc]?hc=!1:pb&&2===fa[pb-1][kc]||(Mb=!1);else{hc=Mb=!1;break}xa[pb]=Mb;Za[pb]=hc}for(--l;0<=l;l--)Za[l]?(a.Hp(l,1),this.UFc(a),Array.removeAt(fa,l),F=!0):xa[l]&&b&&(a.Hp(l,1),F=a.H_b(1),pb=b(a.currentNode),Mb=b(F),c(F,pb+Mb),this.UFc(a),Array.removeAt(fa,l),F=!0);l=fa.length;if(0<l){xa=Array(w);Za=Array(w);for(b=0;b<w;b++){c=!!b;pb=!0;for(Mb=0;Mb<l;Mb++)if(fa[Mb][b])1===fa[Mb][b]?pb=!1:b&&2===
fa[Mb][b-1]||(c=!1);else{pb=c=!1;break}xa[b]=c;Za[b]=pb}b=a.currentNode.ta(ob.a.ru,null);c=!1;if(b)for(c=!0,b=Array.clone(b),l=0;l<b.length;l++)if(!b[l]){c=!1;break}for(l=w-1;0<=l;l--)Za[l]?(b&&Array.removeAt(b,l),this.SFc(a,l),S=!0):xa[l]&&c&&(b[l-1]+=b[l],Array.removeAt(b,l),this.SFc(a,l),S=!0);S&&b&&a.currentNode.setValue(ob.a.ru,b)}(F||S)&&this.ZIb(a,f)}}i2i(a,b){let c=kk.b(a);c||(a=a.pc(b))&&(c=ke.a.XG(a.htmlElement.offsetHeight));return c}SFb(a,b){Cd.TableReader.Zj(a)!==b&&a.properties.setValue(ob.a.Uwa,
b)}DFb(a,b){const c=Cd.TableReader.ui(a);c!==b&&(b&&c&&a.properties.Kn(ob.a.ru,ob.a.xYa),a.properties.setValue(ob.a.Gea,b))}B6(a,b,c,f=null,l=!1,w=!1){a=this.BSf(a);I.a.instance.ga(71);this.D2f(a,b,c,f,l,w);I.a.instance.ga(71);return a}BSf(a){I.a.instance.ga(63)&&Cd.TableReader.Nr(a)&&Fd.getContainingTable(a);const b=ws.a.instance.createInstance(393250);a.hl(b,2);a.Ck(b);return b}RGk(a,b,c,f,l){a=this.BSf(a);I.a.instance.ga(71);this.D2f(a,b,c,f,!1,l);Z.ULS.sendTraceTag(50373653,324,50,String.format("Table pasted: TableId={0}, RowCount={1}, ColumnCount={2}",
a.id.toString(),b,c));return a}D2f(a,b,c,f=null,l=!1,w=!1){const F=mb.GraphIterator.nb(a);this.hSf(F,b,c,f,l);this.SFb(a,b);this.DFb(a,c);I.a.instance.ga(63);a.setValue(ob.a.Egb,!w)}hSf(a,b,c,f=null,l=!1){for(var w=0;w<b;++w){var F=new FP.a;a.hl(F,1);I.a.instance.ga(55)&&F.setValue(Sb.a.Ln,sg.a.xWa())}b=null;w=!0;a.yb(1);do for(F=0;F<c;++F){const S=this.fqa();a.hl(S,1);({khh:b,isFirst:w}=this.C2f(a,S,l,f,b,w));Fd.returnToContainingRow(a)}while(a.xj(1))}C2f(a,b,c,f,l,w){a.Ck(b);l&&c?Ch.xi.lmi(a,l):
(Ch.ix.zY(a,!0,f),!w&&c&&(l=new mb.GraphIterator,l.Pc(a)),w=!1);return{khh:l,isFirst:w}}k6d(a,b,c,f){const l=new mb.GraphIterator;l.Pc(a);var w=l.currentNode;l.yb(1);let F=kk.c(a);if(b)var S=a.RE(1);else S=a.currentNode,F++;const fa=a.yc();I.a.instance.ga(63);this.sxa(a);let xa=null,Za=null;for(var pb=0;pb<c;++pb){var Mb=ws.a.instance.createInstance(393251);Za||(Za=Mb);xa=Mb;this.z2b(a,Mb,S,w,b)}w=Cd.TableReader.ui(a.currentNode);S=!0;do{S?(a.Ck(xa),S=!1):a.xf(1);for(pb=0;pb<w;++pb){Mb=this.fqa();
const hc=this.gSb(a,Mb,l.currentNode,b,!0);this.gEf(a,Mb,f(hc));l.xf(1)}l.hia(1)}while(a.currentNode!==Za);this.SFb(fa,Cd.TableReader.Zj(fa)+c);this.Zue(fa,b,F,c)}UFc(a){const b=kk.c(a);var c=b+1;a.yc();I.a.instance.ga(63);this.sxa(a);for(--c;c>=b;--c){a.Hp(c,1);let f=a.yb(1);for(;f;)this.bue(f,!0),f=a.xj(1);a.Hi()}this.SFb(a.currentNode,Cd.TableReader.Zj(a.currentNode)-1);this.wue(a,b,1)}Slg(a,b,c,f,l){I.a.instance.ga(63);this.sxa(a);let w=Cd.TableReader.ui(a.currentNode);-1===b&&(b=w);const F=c?
b:b-1;a.yb(1);do{const S=a.Hp(F,1);a.yc();for(let fa=0;fa<f;++fa){const xa=this.fqa(),Za=this.r2b(a,xa,S,c,!1);this.gEf(a,xa,l(Za))}}while(a.xj(1));this.DFk(a,w+f,f,b,c);this.Occ(a.currentNode,b,c,f,l)}DFk(a,b,c,f,l){let w=a.currentNode.ta(ob.a.xYa,null),F=a.currentNode.ta(ob.a.ru,null);w&&(w=Ma.a.clone(w));F&&(F=Ma.a.clone(F));this.DFb(a.currentNode,b);if(I.a.instance.ga(30)&&w){const S=Array(b);let fa=0;for(;fa<f;++fa)S[fa]=w[fa];for(;fa<f+c;++fa)S[fa]=!1;for(;fa<b;++fa)S[fa]=w[fa-c];a.currentNode.setValue(ob.a.xYa,
S)}F&&(b=this.tDf(a,F,b,f,l,c),a.currentNode.setValue(ob.a.ru,b))}tDf(a,b,c,f,l,w){a=Array(c);let F=l=0;for(;l<f;++l)a[l]=b[l],F+=a[l];for(;l<c;++l)a[l]=0>l-w?b[0]:b[l-w],F+=a[l];if(I.a.instance.ga(63)&&0<F)for(b=0/F,l=0;l<c;++l)a[l]=Math.max(fe.a.yf(Mn.a.$id,0),a[l]*b);return a}Occ(){}Zue(){}z2b(a,b,c){a.gQc(b,c,1,Ch.F_a?Ch.F_a():null)}r2b(a,b,c,f){a.Ck(c);f=f?a.H_b(1):c;a.yc();a.gQc(b,f,1,Ch.F_a?Ch.F_a():null);return c}gSb(a,b,c){a.Uzf(b,1,Ch.F_a?Ch.F_a():null);return c}gEf(a,b,c){Ce.isGhostCellNode(b)||
(a.Ck(b),Ch.ix.zY(a,!0,c),Fd.returnToContainingRow(a))}SFc(a,b){I.a.instance.ga(63);this.sxa(a);let c=Cd.TableReader.ui(a.currentNode);-1===b&&(b=c-1);a.yb(1);do for(let f=b+1-1;f>=b;--f)a.Hp(f,1),this.bue(a.currentNode,!1),a.Hi();while(a.xj(1));this.CFk(a,c-1,b);this.vue(a,b,1)}CFk(a,b,c){var f=a.currentNode.ta(ob.a.xYa,null);let l=a.currentNode.ta(ob.a.ru,null);f&&(f=Ma.a.clone(f));l&&(l=Ma.a.clone(l));this.DFb(a.currentNode,b);if(f){var w=Array(b);let F=0;for(;F<c;++F)w[F]=f[F];for(;F<b;++F)w[F]=
f[F+1];a.currentNode.setValue(ob.a.xYa,w)}if(l){f=Array(b);for(w=0;w<c;++w)f[w]=l[w];for(;w<b;++w)f[w]=l[w+1];a.currentNode.setValue(ob.a.ru,f)}}mVa(){}bue(){}wue(){}vue(){}MCi(a){const b=Ln.a(a);a.yc();a.yc();this.SFc(a,b)}fqa(){const a=ws.a.instance.createInstance(393252);a.setValue(ob.a.LD,en.a.first);(new FF.OutlineIndentInfo(!0)).Jgh(a);return a}KL(a,b){a.setValue(ob.a.pl,b);a.setValue(ob.a.qI,b)}CMf(){}vXa(a,b,c){const f=Cd.TableReader.ui(a);let l=a.ta(ob.a.xYa,null);l=l?Ma.a.clone(l):Array(f);
let w=a.ta(ob.a.ru,null);w=w?Ma.a.clone(w):Array(f);l[b]=!0;w[b]=c;a.setValue(ob.a.ru,w);a.setValue(ob.a.xYa,l)}static get fh(){return Ch.If||(Ch.If=lb.a.instance.resolve("Box4.IFormattingEditor"))}static get pe(){return Ch.$c||(Ch.$c=lb.a.instance.qb("Box4.IFeatureHelper"))}static Nag(a,b=!0){const c=new eI.a;if(a){let f=null;a=fd.SelectionFactory.oj(a,b);if(!a)Z.ULS.sendTraceTag(19244694,315,10,"Unexpected null selection.");else for(b=0;b<a.length;b++)if(Ab.a.hPf(a.ga(b))){f=a.ga(b);break}f&&(a=
Ab.a.xs(f),a.cache.As&&(a=a.Vd(null),Ch.fh.WI(a)),c.formatting=a.Pl,c.languageId=Ab.a.language(a),I.a.instance.ga(71)&&(c.style=Mc.StyleReader.iD(f.node)))}return c}static bfb(a,b,c){b?a.rowSpan=c:a.colSpan=c}static xrb(a,b){return b?a.rowSpan:a.colSpan}static pMc(a,b){return b?a.sfh:a.ONf}static l1i(a,b){return b?a.R2f:a.Q2f}static dli(a,b,c){let f=a.ta(ob.a.ru,null);f=f?Ma.a.clone(f):Array(c);f[b]=0;a.setValue(ob.a.ru,f)}}Ch.If=null;Ch.$c=null;Ch.ix=null;Ch.xi=null;Ch.F_a=null;Object(e.a)(Ch,"TableEditor",
null,[448]);class Wq{constructor(a){this.Aib=this.PO=0;Cb.SelectionEditor.Ew(a)||(a=Cb.SelectionEditor.xl(a,!0,!1));a=a.Wa;const b=new mb.GraphIterator;b.set(a.node);Cb.SelectionEditor.Rs(b);Cb.SelectionEditor.Mg(a)&&(this.PO=a.Qa,this.Aib=a.MR);Cb.SelectionEditor.v7(a)&&b.Og(12);this.nef=new ex(b)}restore(){var a=new mb.GraphIterator;this.nef.Il(Object(C.a)(this,this.FWk,"selectableFilter"),null);var b=new $y.a;const c=new $y.a;this.nef.Eeh(a,c,b);if(db.ParagraphReader.Ir(a.currentNode)){if(!c.value&&
b.value)return fd.SelectionFactory.oj(a.currentNode,!1);b=Fc.a.Wj(a.currentNode,this.PO);-1!==this.Aib&&(a=db.ParagraphReader.CPa(a.currentNode,this.PO),0<this.Aib&&this.Aib<=a&&(b.MR=this.Aib,b.Kpa=this.Aib));return fd.SelectionFactory.Zt(b)}return a.currentNode.GA?Cb.SelectionEditor.xl(fd.SelectionFactory.$k(a.currentNode),!b.value,!1):(a=Cb.SelectionEditor.Hha(a,!b.value))?db.ParagraphReader.Ir(a)?fd.SelectionFactory.Lg(a,b.value?db.ParagraphReader.textLength(a):0):fd.SelectionFactory.$k(a):null}FWk(a){return a.currentNode.uDa||
a.currentNode.jI}}Object(e.a)(Wq,"IpReference",null,[]);class fI{constructor(){this.tableNode=null;this.columns=this.rows=0;this.aKj=!1}}Object(e.a)(fI,"TableActionData",null,[]);var GP=d(181);class Gs{constructor(){this.uZb=!1}}Object(e.a)(Gs,"TrackChangeDeletionActionData",null,[]);class wc{static get Caa(){return wc.wu||(wc.wu=lb.a.instance.qb("Box4.IAutoCorrectScheduler"))}static get vL(){return wc.SF||(wc.SF=lb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get ygl(){return wc.Ovf||
(wc.Ovf=lb.a.instance.qb("Box4.UI.TableAltTextDialogFactory"))}static get WCi(){return wc.ZYe||(wc.ZYe=lb.a.instance.resolve("Box4.Actors.IDeleteTableSegmentStrategy"))}static Eq(){return wc.jm||(wc.jm=lb.a.instance.Oa("Box4.IExternalSelectionManager"))}static get esb(){return wc.H_a||(wc.H_a=a=>Ch.Nag(a))}static set esb(a){wc.H_a=a}static get S_d(){return wc.Csd||(wc.Csd=wc.c9i)}static set S_d(a){wc.Csd=a}static get P_d(){return wc.zsd||(wc.zsd=wc.X8i)}static set P_d(a){wc.zsd=a}static get Q_d(){return wc.Asd||
(wc.Asd=wc.Z8i)}static set Q_d(a){wc.Asd=a}static get R_d(){return wc.Bsd||(wc.Bsd=wc.a9i)}static set R_d(a){wc.Bsd=a}static get T_d(){return wc.Dsd||(wc.Dsd=wc.e9i)}static set T_d(a){wc.Dsd=a}static get c2d(){return wc.Fsd||(wc.Fsd=wc.Igj)}static set c2d(a){wc.Fsd=a}static get d0d(){return wc.Esd||(wc.Esd=wc.Q9i)}static set d0d(a){wc.Esd=a}static get Xub(){return wc.fvd||(wc.fvd=wc.gKj)}static set Xub(a){wc.fvd=a}static get pe(){return wc.$c||(wc.$c=lb.a.instance.qb("Box4.IFeatureHelper"))}static get fh(){return wc.If||
(wc.If=lb.a.instance.resolve("Box4.IFormattingEditor"))}static get Mf(){return wc.Yc||(wc.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get e5(){return wc.Go||(wc.Go=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get lLd(){return wc.$Ja||(wc.$Ja=lb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}static get eH(){return ul.a.instance}static get Vi(){return Rf.a.instance}static get Sf(){return wc.Pg||(wc.Pg=
lb.a.instance.resolve("Box4.List.IListReader"))}static get dr(){return wc.Eo||(wc.Eo=lb.a.instance.resolve("Box4.List.IListEditor"))}static get Lh(){return wc.xi||(wc.xi=lb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Ml(){return wc.lfa||(wc.lfa=xi.ContextSetEditor.instance)}static set Ml(a){wc.lfa=a}static get Uc(){return cd.a.instance}static get rq(){return wc.NC||(wc.NC=lb.a.instance.resolve("Box4.ITableEditor"))}static get Uu(){null==wc.hA&&(wc.hA=u.AFrameworkApplication.fa.ka("UnblockComplexTableIsEnabled")&&
!I.a.instance.ga(30));return wc.hA}static wb(a){const b=w=>ii.Wqa(w.Pa,!1),c=(w,F,S,fa,xa)=>{const Za=gb.App.VIa.WQf(b);xa[wc.WSf]={};return Za(w,F,S,fa,xa)};wc.Huj();const f=u.AFrameworkApplication.Va;a=a.XQf();f.ya(D.a.B6,Db.a.view,wc.Kzi);f.ya(D.a.B6,Db.a.Ff,wc.B6);f.$d(D.a.B6,1028);f.ya(D.a.LCa,Db.a.view,wc.j6d);f.ya(D.a.LCa,Db.a.tableRow,wc.insertRow);f.$d(D.a.LCa,1028);f.ya(D.a.G7a,Db.a.view,wc.j6d);f.ya(D.a.G7a,Db.a.tableRow,wc.insertRow);f.$d(D.a.G7a,1028);f.ya(D.a.XQa,Db.a.view,wc.s2b);f.ya(D.a.XQa,
Db.a.tableCell,wc.S5d);f.$d(D.a.XQa,4);f.ya(D.a.jQc,Db.a.view,wc.s2b);f.$d(D.a.jQc,4);f.ya(D.a.D7a,Db.a.view,wc.s2b);f.ya(D.a.D7a,Db.a.tableCell,wc.S5d);f.$d(D.a.D7a,4);f.ya(D.a.iQc,Db.a.view,wc.s2b);f.$d(D.a.iQc,4);f.ya(D.a.GAa,Db.a.view,wc.JUf);f.ya(D.a.GAa,Db.a.tableCell,wc.GAa);f.$d(D.a.GAa,4);f.ya(D.a.deleteRow,Db.a.view,wc.JUf);f.ya(D.a.deleteRow,Db.a.tableRow,wc.deleteRow);f.$d(D.a.deleteRow,1028);f.ya(D.a.Zaa,Db.a.view,wc.XCi);f.ya(D.a.Zaa,Db.a.table,wc.Zaa);f.$d(D.a.Zaa,1028);f.ya(D.a.J3a,
Db.a.table,wc.J3a);f.ya(D.a.J3a,Db.a.view,a);f.$d(D.a.J3a,4);f.ya(D.a.insertTable,Db.a.view,wc.Uxj);f.ya(D.a.insertTable,Db.a.Ff,wc.insertTable);f.$d(D.a.insertTable,1036);f.ya(D.a.mVa,Db.a.view,wc.L$j);f.ya(D.a.mVa,Db.a.tableCell,wc.mVa);f.$d(D.a.mVa,4);f.ya(D.a.eHb,Db.a.view,wc.pdl);f.ya(D.a.eHb,Db.a.tableCell,wc.eHb);f.$d(D.a.eHb,4);f.ra(D.a.aBk,Db.a.view,Br.a.J_,96);f.ra(D.a.cBk,Db.a.view,Br.a.J_,96);f.ya(D.a.hhl,Db.a.view,Br.a.oG);f.ya(D.a.vhl,Db.a.view,Br.a.oG);f.ya(D.a.xQc,Db.a.view,wc.xQc);
f.$d(D.a.xQc,1124);f.ya(D.a.dHc,Db.a.view,wc.dHc);f.$d(D.a.dHc,100);f.ya(D.a.Oic,Db.a.view,wc.Oic);f.ya(D.a.Bed,Db.a.view,wc.AWk);f.ya(D.a.tGe,Db.a.view,wc.tGe);f.ya(D.a.sGe,Db.a.view,wc.sGe);f.ya(D.a.lmc,Db.a.view,a);f.ya(D.a.lmc,Db.a.table,wc.lmc);f.$d(D.a.lmc,4);f.ya(D.a.Kfc,Db.a.view,a);f.ya(D.a.Kfc,Db.a.table,wc.Kfc);f.$d(D.a.Kfc,96);I.a.instance.ga(30)&&(f.ya(D.a.dYa,Db.a.view,wc.s2b),f.ya(D.a.dYa,Db.a.Ff,wc.S5d),f.$d(D.a.dYa,4),f.ya(D.a.Okc,Db.a.Ff,wc.insertRow),f.ya(D.a.Okc,Db.a.view,wc.j6d),
f.$d(D.a.Okc,4));f.ya(D.a.KDb,Db.a.view,wc.KDb);I.a.instance.ga(63)?f.$d(D.a.KDb,96):f.$d(D.a.KDb,1124);a=[D.a.Uxg,D.a.Sxg,D.a.Wxg,D.a.Txg,D.a.Xxg,D.a.Vxg,D.a.Rxg,D.a.sUc,D.a.rUc,D.a.tUc,D.a.pUc,D.a.oUc,D.a.qUc,D.a.lUc,D.a.kUc,D.a.mUc];for(var l of a)f.ya(l,Db.a.view,wc.Pha),f.ya(l,Db.a.tableCell,wc.n8h),f.$d(l,4);l=[D.a.DAe,D.a.CAe,D.a.EAe,D.a.AAe,D.a.zAe,D.a.BAe,D.a.xAe,D.a.wAe,D.a.yAe];for(const w of l)f.ya(w,Db.a.view,c),f.ya(w,Db.a.paragraph,wc.Yzk),f.$d(w,68)}static Huj(){wc.yC.$(D.a.Xxg,wc.yC.$(D.a.sUc,
wc.yC.$(D.a.rUc,wc.yC.$(D.a.tUc,wc.yC.$(D.a.DAe,wc.yC.$(D.a.CAe,wc.yC.$(D.a.EAe,wc.wvh)))))));wc.yC.$(D.a.Vxg,wc.yC.$(D.a.pUc,wc.yC.$(D.a.oUc,wc.yC.$(D.a.qUc,wc.yC.$(D.a.AAe,wc.yC.$(D.a.zAe,wc.yC.$(D.a.BAe,wc.sak)))))));wc.yC.$(D.a.Rxg,wc.yC.$(D.a.lUc,wc.yC.$(D.a.kUc,wc.yC.$(D.a.mUc,wc.yC.$(D.a.xAe,wc.yC.$(D.a.wAe,wc.yC.$(D.a.yAe,wc.ebi)))))));wc.jB.$(D.a.Uxg,wc.jB.$(D.a.sUc,wc.jB.$(D.a.pUc,wc.jB.$(D.a.lUc,wc.jB.$(D.a.DAe,wc.jB.$(D.a.AAe,wc.jB.$(D.a.xAe,1)))))));wc.jB.$(D.a.Sxg,wc.jB.$(D.a.rUc,wc.jB.$(D.a.oUc,
wc.jB.$(D.a.kUc,wc.jB.$(D.a.CAe,wc.jB.$(D.a.zAe,wc.jB.$(D.a.wAe,2)))))));wc.jB.$(D.a.Wxg,wc.jB.$(D.a.tUc,wc.jB.$(D.a.qUc,wc.jB.$(D.a.mUc,wc.jB.$(D.a.EAe,wc.jB.$(D.a.BAe,wc.jB.$(D.a.yAe,3)))))));wc.jB.$(D.a.Txg,6)}static dHc(a,b,c){if(1===c)return 32;if(!b.view.Jh)return 2;a=b.view;if(!a.Eb)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.sla}),8;a=a.Eb.Dj;a=wc.Ml.w1(a,14);if(!a)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.Iqa}),8;wc.ygl.create(a);return 32}static Oic(a,b,c){Me.a.mark(5756);if(!b.view.Jh)return 2;
const f=b.view;if(!f.Eb)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.sla}),8;a=f.Eb.Dj;a=wc.Ml.w1(a,14);if(!a)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.Iqa}),8;if(2===c){let l=null;b=a.node;c=Cd.TableReader.gu(b);const w=wc.Uu;if(!I.a.instance.ga(104)||c&&!w)l=fd.SelectionFactory.$k(a.node);else if(I.a.instance.ga(77))c=fd.SelectionFactory.fFc(b,w),f.Eb.UFb(c,null);else{a=mb.GraphIterator.nb(b);a.yb(1);for(b=[Vq.TableNodeContext.create(a.currentNode)];a.xf(1);)c&&kk.h(a)||Array.add(b,Vq.TableNodeContext.create(a.currentNode));
l=new nb.Selection(b,!0)}l&&(c=new Tb.a(null,F=>{f.Eb.setSelection(l,F);return!1},null),c.vl("SelectTable"),c.run())}Me.a.mark(5757);return 32}static AWk(a,b,c){Me.a.mark(5752);if(!b.view.Jh)return 2;a=b.view;if(!a.Eb)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.sla}),8;b=a.Eb.Pa;if(!b)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),2;b=wc.T_d(b);if(32!==b.response)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.Iqa}),b.response;if(2===c){var f=b.kC;b=c=f[0].node;var l=mb.GraphIterator.nb(c);l.oc(14);
let S=null;var w=Fd.getContainingTable(l);w=Cd.TableReader.gu(w);var F=wc.Uu;F=I.a.instance.ga(104)&&(!w||F);const fa=[];for(let xa=0;xa<f.length;++xa){const Za=l.currentNode===f[xa].node;if(Za||w&&kk.d(l))b=l.currentNode,!F||w&&kk.h(l)||Array.add(fa,Vq.TableNodeContext.create(l.currentNode)),Fd.moveToNextRow(l),Za||--xa}f=a.Eb.Pa.kb;l=null;F?I.a.instance.ga(77)?(l=new mb.GraphIterator,F=new mb.GraphIterator,f.uf?(l.set(c),F.set(b)):(l.set(b),F.set(c)),l.oc(14),Fd.moveToFirstColumn(l),F.oc(14),Fd.moveToLastColumn(F),
l=w?fd.SelectionFactory.lWb(l,F):fd.SelectionFactory.zSf(l,F)):S=new nb.Selection(fa,I.a.instance.ga(63)||f.uf):S=fd.SelectionFactory.lSf(c,b);S&&(l=new Yh.SelectionCollection([S],0));a.Eb.UFb(l,null)}Me.a.mark(5753);return 32}static tGe(a,b,c){Me.a.mark(5754);if(!b.view.Jh)return 2;a=b.view;if(!a.Eb)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.sla}),8;b=a.Eb.Pa;if(!b)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),2;b=wc.R_d(b);if(32!==b.response)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.Iqa}),
b.response;if(2===c){c=[];var f=b.kC,l=new mb.GraphIterator;l.set(f[0].node);l.oc(14);b=Fd.getContainingTable(l);var w=Number.MAX_VALUE,F=0;if(f.length===Cd.TableReader.ui(Fd.getContainingTable(l)))F=null,I.a.instance.ga(104)&&(F=fd.SelectionFactory.fFc(b,wc.Uu))?c=F.toArray():(F=fd.SelectionFactory.$k(b),Array.add(c,F)),w=0,F=Cd.TableReader.ui(b)-1;else{for(l=0;l<f.length;++l){var S=mb.GraphIterator.nb(f[l].node);S.oc(14);S=Ln.a(S);w=Math.min(w,S);F=Math.max(F,S)}f=mb.GraphIterator.nb(b);Fd.moveToFirstRow(f);
Fd.moveToColumnByIndex(f,w);l=new mb.GraphIterator;l.Pc(f);Fd.moveToColumnByIndex(l,F);var fa;S=b.hp();S=I.a.instance.ga(104)&&(!S||wc.Uu);do(fa=S?fd.SelectionFactory.dFc(f,l,!0,!0):fd.SelectionFactory.lSf(f.currentNode,l.currentNode))&&Array.add(c,fa),fa=!Fd.moveToNextRow(f),Fd.moveToNextRow(l);while(!fa)}f=mb.GraphIterator.nb(b);Fd.moveToCell(f,0,w);w=Cd.TableReader.Zj(b);b=mb.GraphIterator.nb(b);Fd.moveToCell(b,w-1,F);c=new Yh.SelectionCollection(c,c.length-1,0,f,b);a.Eb.UFb(c,null)}Me.a.mark(5751);
return 32}static sGe(a,b,c){Me.a.mark(5750);if(!b.view.Jh)return 2;a=b.view;if(!a.Eb)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.sla}),8;b=a.Eb.Dj;if(!b)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),2;var f=wc.Ml.lA(b);b={};for(var l=0;l<f.length;++l)if(f[l].Ok){var w=mb.GraphIterator.nb(f[l].node);w.af();if(!Ce.isTableCellOrInside(w))return 8;Fd.returnToCell(w);b[w.currentNode.id.toString()]=w}if(2===c){if(I.a.instance.ga(104)){c=a.Eb.Pa;if(c.kb.hg)return Me.a.mark(5751),32;f=c.kb;w=f.uf?f.Wa:
f.We;l=f.uf?f.We:f.Wa;c=new mb.GraphIterator;c.set(w.node);c.af();w=new mb.GraphIterator;w.set(l.node);w.af();l=null;if((l=Fd.returnToLowestCommonTable(c,w))&&!l.hp()){var F=Cb.SelectionEditor.xl(f,!0,!1);F=Vq.TableNodeContext.create(c.currentNode,F.Wa);F=fd.SelectionFactory.hWb(fd.SelectionFactory.Zt(F));a.Eb.UD(F);Me.a.mark(5751);return 32}}c=[];for(F in b)f=fd.SelectionFactory.$k(b[F].currentNode),Array.add(c,f);0<c.length&&(F=new Yh.SelectionCollection(c,c.length-1),a.Eb.UFb(F,null))}Me.a.mark(5751);
return 32}static Gcj(){return u.AFrameworkApplication.fa.ka("WacTableCellAlignmentIsEnabled")}static n8h(a,b,c,f,l){f=wc.s6h();if(1===c)return f?32:8;if(!(l&&f&&b&&b.node))return 2;b=b.node;if(Ce.isGhostCellNode(b))return 32;wc.yC.Kb(a)&&(c=wc.yC.ga(a),b.ke(Sb.a.eOe,c));wc.jB.Kb(a)&&(a=wc.jB.ga(a),wc.UEf(b,a));return 32}static UEf(a,b){if(!Ce.isGhostCellNode(a)&&(a=mb.GraphIterator.nb(a),vg.OutlineNavigator.q9(a))){do if(a.yb(2)){const c=a.currentNode;12===c.type?c.ke(ob.a.pl,b):14===c.type?Cd.TableReader.c4f(c,
f=>{wc.UEf(f,b)}):Z.ULS.sendTraceTag(8439839,324,50,"Unsupported node type for justification set:{0}",GP.a[c.type]);a.yc()}while(a.fp())}}static Yzk(a,b,c,f,l){if(!l)return 2;if(1===c)return 32;c=l[wc.WSf];if(wc.lNd in c&&!c[wc.lNd])return 32;f=wc.jB.ga(a);a=wc.yC.ga(a);if(!b||!b.node)return 2;var w=b.node;b=db.ParagraphReader.XM(w);w=mb.GraphIterator.nb(w);w.oc(16);w.Og(16);w=w.currentNode.ta(Sb.a.eOe,wc.wvh);c[wc.lNd]=l[Uh.a.On]=f===b&&a===w;return 32}static XCi(a,b,c,f,l){if(!b.view.Jh)return 2;
a=b.view;if(!a.Eb)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.sla}),8;let w=a.Eb.Dj;w=wc.Ml.w1(w,14);if(!w)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.Iqa}),8;if(1===c)return u.AFrameworkApplication.Va.li(w,D.a.Zaa,c,!0,f,l);Me.a.mark(7117);const F=new Wq(Cb.SelectionEditor.xl(fd.SelectionFactory.Zt(w),!0,!1)),S=new Oe.GraphTransaction(15);try{S.hd(b.view.ug);const fa=Bh.nMc(w.node,!0);fa.ena(w);const xa=Object(ua.a)(Gs,l)||new Gs;let Za=u.AFrameworkApplication.Va.li(w,D.a.Zaa,c,!0,f,wc.Mf.Zf?xa:l);const pb=
!wc.Mf.Zf||!wc.Mf.fy||xa.uZb;32===Za&&2===c&&pb?(fa.normalize(),a.Eb.setSelection(F.restore()),v.FocusManager.instance().vf(a.NH)):fa.cancel()}finally{S&&S.dispose()}Me.a.mark(7118);return 32}static Kzi(a,b,c,f,l){Me.a.mark(4943);let w=null;2===c&&(w=new Oe.GraphTransaction(15),w.hd(b.view.ug));a=u.AFrameworkApplication.Va.li(b.HD,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Jh)return 2;b=b.view;c=b.Eb.Dj;c=wc.Ml.w1(c,16);f=new mb.GraphIterator;f.set(c.node);f.oc(14);Fd.moveToNextOrPreviousCell(f,!1);
b.Eb.setSelection(fd.SelectionFactory.oj(f.currentNode,!0))}w&&w.dispose();Me.a.mark(4944);return a}static s2b(a,b,c,f){if(!b.view.Jh)return 2;var l=b.view;if(!l.Eb||!l.Eb.Pa.kb)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),8;Me.a.mark(4945);var w=l.Eb.Dj;if(!w)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),8;l=a===D.a.XQa||a===D.a.dYa;var F=wc.Ml.lA(w);if(!F||0>=F.length)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),8;F=F[0].node;if(!F)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),
8;l=Cd.TableReader.Vl(F)?a===D.a.iQc||l:a===D.a.jQc||l;const S=wc.P_d(w,l);if(32!==S.response)return S.response;w=S.Jo;F=Cd.TableReader.gu(w);const fa=a;let xa;xa=l?Object(ua.a)(209,S.kC[S.kC.length-1]):Object(ua.a)(209,S.kC[0]);a!==D.a.dYa&&(a=l?D.a.XQa:D.a.D7a);l=null;2===c&&(l=new Oe.GraphTransaction(15),l.hd(b.view.ug));a=u.AFrameworkApplication.Va.li(xa,a,c,!0,f,S.wcb);l&&l.dispose();2===c&&Z.ULS.sendTraceTag(9011547,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, ColumnCount={6}",
fa,D.a.uz(fa)||"Unknown",I.a.instance.ga(77),F,a,w.id.toString(),Cd.TableReader.ui(w)));Me.a.mark(4946);return a}static j6d(a,b,c,f){if(!b.view.Jh)return 2;const l=a===D.a.Okc,w=a===D.a.G7a;Me.a.mark(4947);var F=b.view;if(!F.Eb)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.sla}),8;const S=F.Eb.Dj;if(!S)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),8;F=wc.S_d(S,w);if(32!==F.response)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.Iqa}),F.response;const fa=Cd.TableReader.gu(F.Jo);let xa=null;2===c&&(xa=
new Oe.GraphTransaction(15),xa.hd(b.view.ug));b=w?Object(ua.a)(209,F.kC[0]):Object(ua.a)(209,F.kC[F.kC.length-1]);f=u.AFrameworkApplication.Va.li(l?S:b,a,c,!1,f,F.wcb);xa&&xa.dispose();2===c&&Z.ULS.sendTraceTag(9011548,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, RowCount={6}",a,D.a.uz(a)||"Unknown",I.a.instance.ga(77),fa,f,F.Jo.id.toString(),Cd.TableReader.Zj(F.Jo)));Me.a.mark(4948);return f}static JSg(a){for(Fd.moveToFirstColumn(a);Ce.isGhostCell(a)&&
Fd.moveToPreviousRow(a););}static rbk(a){for(Fd.moveToFirstRow(a);Ce.isGhostCell(a)&&Fd.moveToPreviousColumn(a););}static L$j(a,b,c,f){if(I.a.instance.ga(30)||!b.view.Jh)return 2;const l=b.view;if(!l.Eb||!l.Eb.Pa.kb)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),8;const w=wc.Z4i(l.Eb.Dj);if(32!==w.response)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.Iqa}),w.response;let F=null,S=null;2===c&&(F=new Wq(l.Eb.Pa.kb),F.restore(),S=new Oe.GraphTransaction(15),S.hd(b.view.ug));a=u.AFrameworkApplication.Va.li(Fc.a.create(w.controlCell),
a,c,!1,f,w);2===c&&32===a&&(b=mb.GraphIterator.nb(w.Jo),b.af()&&wc.rq.ncd(b,l.Na),F&&(l.Eb.setSelection(fd.SelectionFactory.oj(w.controlCell,!0)),v.FocusManager.instance().vf(l.NH)));S&&S.dispose();2===c&&Z.ULS.sendTraceTag(38397411,324,50,String.format("Merge Cells command run. Response={0}",a));return a}static Z4i(a){const b=new bI;b.Jo=null;b.controlCell=null;if(!a)return b.response=8,b;var c=wc.Ml.lA(a);if(1>=c.length)return b.response=2,b;const f=new Ua.a;a={};for(let S=0;S<c.length;++S)if(c[S].Ok){const fa=
mb.GraphIterator.nb(c[S].node);fa.af();if(!Ce.isTableCellOrInside(fa))return b.response=8,b;var l=Object(ua.a)(Wc.AParagraphNode,fa.currentNode);if(l&&!l.ta(Sb.a.G8d,!0))return b.response=8,b;Fd.returnToCell(fa);l=fa.currentNode;if(!f.contains(l.id.toString())){f.add(l.id.toString());var w=Fd.getContainingTable(fa),F=Fd.getContainingTableRow(fa).id.toString();if(b.Jo)if(b.Jo!==w)if(fa.yQa(b.Jo))continue;else if(mb.GraphIterator.nb(b.Jo).j$(w))a={},b.Jo=w,b.controlCell=l,a[F]=l.colSpan;else return b.response=
8,b;else a[F]=F in a?a[F]+l.colSpan:l.colSpan;else a={},b.Jo=w,b.controlCell=l,a[F]=l.colSpan;for(w=1;w<l.rowSpan;w++)Fd.moveToNextRow(fa),F=Fd.getContainingTableRow(fa).id.toString(),a[F]=F in a?a[F]+l.colSpan:l.colSpan}}if(!b.controlCell)return b.response=2,b;c=Object.keys(a);b.rowSpan=c.length;b.colSpan=a[c[0]];for(const S of c)if(b.colSpan!==a[S])return b.response=2,b;b.response=32;return b}static pdl(a,b,c,f,l){if(I.a.instance.ga(30)||!b.view.Jh)return 2;const w=b.view;if(!w.Eb||!w.Eb.Pa.kb)return wc.Uc.Vb(zd.a.qh,
{["Reason"]:Hd.a.noSelection}),8;if(Cb.SelectionEditor.Ew(w.Eb.Pa.kb))var F=w.Eb.Pa.kb.Wa.node;else{F=w.Eb.Dj;if(!F)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.Iqa}),8;F=wc.Ml.lA(F);if(1!==F.length||!Object(Ca.a)(Fc.a,F[0]))return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.mPf}),8;F=F[0].node}F=mb.GraphIterator.nb(F);F.af();if(!Ce.isInTableCell(F))return 2;Fd.returnToContainingCell(F);F=F.currentNode;let S=null,fa=null;2===c&&(S=new Wq(w.Eb.Pa.kb),S.restore(),fa=new Oe.GraphTransaction(15),fa.hd(b.view.ug));
b=Fc.a.create(F);a=u.AFrameworkApplication.Va.li(b,a,c,!1,f,l);2===c&&32===a&&S&&(w.Eb.setSelection(fd.SelectionFactory.oj(F,!0)),v.FocusManager.instance().vf(w.NH));fa&&fa.dispose();2===c&&Z.ULS.sendTraceTag(38397440,324,50,String.format("Split Cells command run. Response={0}",a));return a}static JUf(a,b,c,f,l){if(!b.view.Jh)return 2;const w=a===D.a.deleteRow;w?Me.a.mark(4951):Me.a.mark(4949);const F=b.view;if(!F.Eb||!F.Eb.Pa.kb)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),8;var S=F.Eb.Dj;
const fa=wc.d0d(S,w,F.Eb);if(32!==fa.response)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.Iqa}),fa.response;const xa=Cd.TableReader.gu(fa.Jo);var Za=null,pb=null,Mb=null;let hc=!1;var kc=!1;2===c&&(Za=new Wq(F.Eb.Pa.kb),kc=Za.restore(),Mb=mb.GraphIterator.nb(kc.Wa.node),Mb.oc(14),Fd.returnToContainingCell(Mb),kc=Ce.isLastCellInRow(Mb),Fd.returnToContainingRow(Mb),hc=kk.j(Mb),pb=Bh.nMc(b.view.ug,!0),xa&&(S=wc.WCi.w_f(S)),pb.ena(S),Mb=new Oe.GraphTransaction(15),Mb.hd(b.view.ug));b=Object(ua.a)(Gs,l)||
new Gs;f=u.AFrameworkApplication.Va.li(Ra.a.VNa(fa.kC),a,c,!1,f,wc.Mf.Zf&&w?b:l);S=!wc.Mf.Zf||!wc.Mf.fy||!w||b.uZb;b=l=!1;if(2===c&&32===f&&S){let Ec=mb.GraphIterator.nb(fa.Jo);Ec.af()&&wc.rq.ncd(Ec,F.Na)}2===c&&32===f&&I.a.instance.ga(30)&&Cd.TableReader.D$d(fa.Jo)&&S&&mb.GraphIterator.nb(fa.Jo).af()&&(Za=w?new Wq(fd.SelectionFactory.oj(fa.Jo,!hc)):new Wq(fd.SelectionFactory.oj(fa.Jo,!kc)),F.Eb.setSelection(Cb.SelectionEditor.xl(fd.SelectionFactory.$k(fa.Jo),!1,!1)),u.AFrameworkApplication.Va.processAction(D.a.J3a,
2),b=l=!0);if(32===f&&2===c&&S){if(!l&&0>=Cd.TableReader.ui(fa.Jo)||0>=Cd.TableReader.Zj(fa.Jo))l=!0;pb.normalize();if(Za){Za=Za.restore();if(l)Za=b&&!w?fd.SelectionFactory.oj(Za.Wa.node,!kc):fd.SelectionFactory.oj(Za.Wa.node,!0);else if(pb=mb.GraphIterator.nb(Za.Wa.node),pb.oc(14),w)Fd.returnToContainingRow(pb),hc&&!I.a.instance.ga(77)?(pb.af(),lc.OutlineElementNavigator.Ke(pb),wc.Lh.Oba(pb,!1,!0)):wc.JSg(pb),Za=fd.SelectionFactory.oj(pb.currentNode,!0);else if(Fd.returnToCell(pb),kc&&I.a.instance.ga(30))Fd.moveToLastRow(pb),
Za=fd.SelectionFactory.oj(pb.currentNode,!1);else if(I.a.instance.ga(63)||I.a.instance.ga(77))wc.rbk(pb),Za=fd.SelectionFactory.oj(pb.currentNode,!0);F.Eb.setSelection(Za);v.FocusManager.instance().vf(F.NH)}}else pb&&pb.cancel();Mb&&Mb.dispose();2===c&&Z.ULS.sendTraceTag(9011549,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}",a,D.a.uz(a)||"Unknown",I.a.instance.ga(77),xa,f,fa.Jo.id.toString()));w?Me.a.mark(4952):Me.a.mark(4950);return f}static Igj(a,
b){Fd.moveToFirstRow(a);const c=Object(ua.a)(ix.TableCellNode,a.currentNode).colSpan;if(b)for(b=0;b<c;b++)Fd.moveToNextColumn(a);else Fd.moveToPreviousColumn(a)}static c9i(a){return wc.CZb(a,!1,!0)}static X8i(a){return wc.CZb(a,!0,!0)}static Z8i(a,b){let c=Ln.a(a);b&&(c+=a.currentNode.colSpan-1);return c}static a9i(a){a=dd.a.Snb(a);return wc.CZb(a,!0,I.a.instance.ga(104)&&wc.Uu)}static e9i(a){a=dd.a.Snb(a);return wc.CZb(a,!1,I.a.instance.ga(104)&&wc.Uu)}static Q9i(a,b){return wc.CZb(a,!b,!0)}static CZb(a,
b,c){const f=new Qt;f.Jo=null;if(!a)return f.response=8,f;var l={};let w=[],F=!1;a=wc.Ml.lA(a);1===a.length&&(F=!0);for(let Za=0;Za<a.length;++Za)if(a[Za].Ok){const pb=[];let Mb=mb.GraphIterator.nb(a[Za].node);Mb.af();if(!Ce.isTableCellOrInside(Mb))return f.response=8,f;if(b)Fd.returnToCell(Mb),c&&1<Ce.getColSpan(Mb.currentNode)?Ce.foreachMergedCells(Mb.currentNode,hc=>{hc=mb.GraphIterator.nb(hc);hc.af();Fd.moveToFirstRow(hc);Array.add(pb,hc)},2):Array.add(pb,Mb),Fd.moveToFirstRow(Mb);else{Ce.isTableCell(Mb)||
Fd.returnToCell(Mb);var S=Mb.currentNode.rowSpan;Fd.returnToContainingRow(Mb);if(1<S)for(var fa=1;fa<S;fa++){var xa=mb.GraphIterator.nb(Mb.currentNode);xa.af();Array.add(pb,xa);Fd.moveToNextRow(Mb)}Array.add(pb,Mb)}for(S=0;S<pb.length;++S)if(Mb=pb[S],fa=Fd.getContainingTable(Mb),xa=Mb.currentNode.id.toString(),!l[xa])if(l[xa]=!0,f.Jo)if(f.Jo!==fa)if(Mb.yQa(f.Jo))wc.S4f(Mb,f.Jo,b),xa=Mb.currentNode.id.toString(),l[xa]||(l[xa]=!0,Array.add(w,Mb));else if(l[xa]=!1,mb.GraphIterator.nb(f.Jo).j$(fa)){const hc=
[];for(let kc=0;kc<w.length;kc++){const Ec=w[kc];wc.S4f(Ec,fa,b);xa=Ec.currentNode.id.toString();l[xa]||(l[xa]=!0,Array.add(hc,Ec))}xa=Mb.currentNode.id.toString();l[xa]||(l[xa]=!0,Array.add(hc,Mb));f.Jo=fa;Array.clear(w);w=hc}else return f.response=8,f;else Array.add(w,Mb);else f.Jo=fa,Array.add(w,Mb);Array.clear(pb)}if(!w.length)return f.response=8,f;f.TGb=w[0].currentNode;b=[];for(l=0;l<w.length;l++){a=w[l];if(!c&&Cd.TableReader.oub(a))return f.response=8,f;Array.add(b,Fc.a.create(a.currentNode))}f.wcb=
F?1:b.length;f.kC=b;f.response=32;return f}static S4f(a,b,c){do c?Fd.returnToContainingCell(a):Fd.returnToContainingRow(a);while(Fd.getContainingTable(a)!==b);c&&Fd.moveToFirstRow(a)}static xQc(a,b,c,f,l){return 1===c?(a=b.HD)&&Cb.SelectionEditor.Mg(a)?u.AFrameworkApplication.Va.li(a,D.a.insertTable,c,!0,f,l):2:32}static Uxj(a,b,c,f,l){f.qP=0;f.G6=0;let w=-1,F=null,S=null,fa=null;if(!b.view.Jh)return 2;const xa=b.view;if(!xa.Eb)return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.sla}),8;Me.a.mark(4941);if(2===
c){const Za=xa.Eb.Dj;Za.Ok&&(fa=new Oe.GraphTransaction(15),S=EF.a.instance.gej(Za.node),fa.Ry(S),F=new mb.GraphIterator,F.Pc(S),F.yc(),w=F.DBa(S.currentNode))}a=u.AFrameworkApplication.Va.li(b.HD,a,c,!0,f,l);32===a&&2===c&&(S.isValid?(lc.OutlineElementNavigator.KI(S,!1,!1),lc.OutlineElementNavigator.ti(S),c=fd.SelectionFactory.oj(S.currentNode,!0)):(F.b2d(w),lc.OutlineElementNavigator.ti(F),c=fd.SelectionFactory.oj(F.currentNode,!0)),xa.Eb.setSelection(c),v.FocusManager.instance().vf(xa.NH));fa&&
fa.dispose();Me.a.mark(4942);return a}static KDb(a,b){if(!b.view.Jh)return 8;a=b.view;if(!a.Eb)return 8;a=wc.Ml.lA(a.Eb.Dj);if(0>=a.length)return 8;b=new mb.GraphIterator;for(let c=0;c<a.length;++c)if(b.set(a[c].node),b.af(),!Cd.TableReader.Nr(b))return 8;return 32}static B6(a,b,c){var f=b.contextId===Db.a.Ff;let l=null,w=null;if(f){l=b;if(fb.HyperlinkReader.Qia(l,!0))return wc.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.iPf}),8;w=new mb.GraphIterator;w.set(l.node);Cb.SelectionEditor.Rs(w);lg.b(w)&&(wc.Uc.Vb(zd.a.yo,
{["Reason"]:Hd.a.sNd}),f=!1);!l.Qa&&w.vsg&&(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.tpg}),f=!1)}if(1===c||!f)return f?32:8;Me.a.mark(4929);b=new Oe.GraphTransaction(7);b.Ry(w);lc.OutlineElementNavigator.Ke(w);c=w.currentNode;wc.Lh.Oba(w,!1,!1);f=wc.rq.B6(w,1,2);const F=new mb.GraphIterator;F.set(c);F.af();Fd.moveToCellContent(w,0,1);wc.Lh.dHb(F,w,l,!0,!0);Fd.returnToContainingTable(w);Fd.moveToCellContent(w,0,0);w.Hi();sm.i(F,w,null,F.role);wc.dr.N2a(F,null);Fd.returnToContainingTable(w);lc.OutlineElementNavigator.Ke(w);
F.yb(1)&&sm.h(w,null,1,1,F,-1);wc.Caa&&wc.Caa.Jmc(c,x.a.tq);b.dispose();Z.ULS.sendTraceTag(42505434,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,D.a.uz(a)||"Unknown",I.a.instance.ga(77),f.id.toString()));Me.a.mark(4930);return 32}static S5d(a,b,c,f,l){u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?Z.ULS.sendTraceTag(541172701,324,50,"PPTO TestEcsFeature Client Flight Enabled. Box4."):Z.ULS.sendTraceTag(541172702,
324,50,"PPTO TestEcsFeature Client Flight Disabled. Box4.");var w=Cb.SelectionEditor.Mg(b)&&a===D.a.dYa||b.contextId===Db.a.tableCell;f=null;if(w&&(f=new mb.GraphIterator,f.set(b.node),f.oc(14),Ce.isTableCellOrInside(f)||(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.zVb}),w=!1),w&&!wc.Xub(f,a)&&(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.yVb}),w=!1),w)){Fd.returnToContainingCell(f);var F=I.a.instance.ga(63)?63:255;if(Cd.TableReader.ui(Fd.getContainingTable(f))>=F)return wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.iRg}),8}if(1===
c||!w)return w?32:8;Me.a.mark(4931);c=a!==D.a.D7a;w=new Oe.GraphTransaction(15);w.Ry(f);b.node.kG().graphTransactionOperations.Lga(2);F=new mb.GraphIterator;F.set(f.currentNode);F.oc(15);Fd.returnToContainingTable(f);let S=wc.Q_d(F,c);c&&S++;wc.rq.Slg(f,S,!c,l?l:1,wc.esb);f.set(b.node);f.oc(16);a===D.a.dYa?(Fd.moveToNextColumn(F),vg.OutlineNavigator.q9(F),lc.OutlineElementNavigator.Ke(f),wc.Lh.uhc(F),wc.Lh.dHb(f,F,b,!0,!0),wc.Caa&&wc.Caa.Jmc(f.currentNode,x.a.tq)):(a=gb.App.Fb.Fd,b=mb.GraphIterator.nb(b.node),
b.af(),wc.c2d(b,c),a.Xm.Eb.setSelection(fd.SelectionFactory.oj(b.currentNode,!0)));w.dispose();Me.a.mark(4932);return 32}static gKj(a){return!(I.a.instance.ga(14)&&Cd.TableReader.rFj(a))&&!(I.a.instance.ga(30)&&Cd.TableReader.oub(a))}static insertRow(a,b,c,f,l){const w=a===D.a.Okc;f=a===D.a.G7a;var F=b.node;const S=new mb.GraphIterator;S.set(F);S.af();let fa=!0;kk.m(F)||Cd.TableReader.Nr(S)||(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.RRd}),fa=!1);fa&&!wc.Xub(S,a)&&(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.yVb}),
fa=!1);if(1===c||!fa)return fa?32:8;Me.a.mark(4933);a=new Oe.GraphTransaction(15);a.Ry(S);b.node.kG().graphTransactionOperations.Lga(2);w?(l=new mb.GraphIterator,l.Pc(S),lc.OutlineElementNavigator.Ke(l),Fd.returnToContainingRow(S),wc.rq.k6d(S,f,1,wc.esb),Fd.moveToFirstColumn(S),vg.OutlineNavigator.q9(S),wc.Lh.dHb(l,S,b,!1,!0),Fd.returnToContainingRow(S),wc.Caa&&wc.Caa.Jmc(l.currentNode,x.a.tq)):wc.rq.k6d(S,f,l?l:1,wc.esb);b=gb.App.Fb.Fd;F=mb.GraphIterator.nb(F);F.oc(14);kk.l(F)||Fd.returnToContainingRow(F);
f?Fd.moveToPreviousRow(F):Fd.moveToNextRow(F);wc.JSg(F);b.Xm.Eb.setSelection(fd.SelectionFactory.oj(F.currentNode,!0));a.dispose();Me.a.mark(4934);return 32}static Pha(a,b,c,f,l){b=Vh.m4(a,b,c,f,l,{},16);2===c&&wc.Oma(a)&&Z.ULS.sendTraceTag(8791561,324,50,String.format("ActionId={0}, ActionName={1}, Response={2}",a,D.a.uz(a)||"Unknown",b));return b}static Oma(a){return a===D.a.sUc||a===D.a.rUc||a===D.a.tUc||a===D.a.pUc||a===D.a.oUc||a===D.a.qUc||a===D.a.lUc||a===D.a.kUc||a===D.a.mUc}static GAa(a,
b,c){const f=new mb.GraphIterator;let l=b.isValid;l&&(f.set(b.node),f.af()||(wc.Uc.Vb(zd.a.v0,{["Reason"]:Hd.a.zIc}),l=!1),Ce.isTableCellNode(b.node)||(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.zVb}),l=!1));l&&!wc.Xub(f,a)&&(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.yVb}),l=!1);if(l&&!wc.eH.iId()){a=new mb.GraphIterator;a.Pc(f);do if(!wc.eH.fUb(a.currentNode)){wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aEc});l=!1;break}while(Fd.moveToNextRow(a))}if(l&&(a=new mb.GraphIterator,a.Pc(f),1!==c&&I.a.instance.ga(50)&&gb.App.Hh.Nv)){do for(b=
sh.a.pz(a.currentNode);b.moveNext();){const w=b.currentNode;db.ParagraphReader.Pd(w)&&gb.App.Hh.JX.fpa(w)}while(Fd.moveToNextRow(a))}if(1===c)return l?32:8;if(l){Me.a.mark(4935);c=new Oe.GraphTransaction(7);try{c.Ry(f),wc.rq.MCi(f)}finally{c&&c.dispose()}Me.a.mark(4936);return 32}return 2}static mVa(a,b,c,f,l){a=new mb.GraphIterator;if(f=b.isValid){a.set(b.node);a.af()||(wc.Uc.Vb(zd.a.v0,{["Reason"]:Hd.a.zIc}),f=!1);Ce.isTableCellNode(b.node)||(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.zVb}),f=!1);if(f&&
!wc.eH.iId()){b=new mb.GraphIterator;b.Pc(a);var w=new mb.GraphIterator;w.Pc(a);for(var F=0;F<l.rowSpan;F++){for(var S=0;S<l.colSpan;S++){if(!wc.eH.fUb(b.currentNode)){wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aEc});f=!1;break}b.xf(1)}if(!f)break;Fd.moveToNextRow(w);b.Pc(w)}}if(f&&1!==c&&I.a.instance.ga(50)&&gb.App.Hh.Nv)for(b=new mb.GraphIterator,b.Pc(a),w=new mb.GraphIterator,w.Pc(a),F=0;F<l.rowSpan;F++){for(S=0;S<l.colSpan;S++)gb.App.Hh.JX.fpa(b.currentNode),b.xf(1);if(!f)break;Fd.moveToNextRow(w);b.Pc(w)}}if(1===
c)return f?32:8;if(f){c=new Oe.GraphTransaction(7);try{c.Ry(a),wc.rq.mVa(a,l.rowSpan,l.colSpan)}finally{c&&c.dispose()}return 32}return 2}static eHb(a,b,c){a=new mb.GraphIterator;let f=b.isValid;f&&(a.set(b.node),a.af()||(wc.Uc.Vb(zd.a.v0,{["Reason"]:Hd.a.zIc}),f=!1),Ce.isTableCellNode(b.node)||(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.zVb}),f=!1),f&&1!==c&&I.a.instance.ga(50)&&gb.App.Hh.Nv&&(b=new mb.GraphIterator,b.Pc(a),gb.App.Hh.JX.fpa(b.currentNode)));if(1===c)return f?32:8;if(f){c=new Oe.GraphTransaction(7);
try{c.Ry(a)}finally{c&&c.dispose()}return 32}return 2}static Zaa(a,b,c,f,l){b=b.node;f=!0;Cd.TableReader.M8a(b)||(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.ZDc}),f=!1);wc.eH.fUb(b)||(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aEc}),f=!1);f&&(I.a.instance.ga(14)||I.a.instance.ga(63))&&wc.Vi.Z$d(b)&&(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),f=!1);if(1===c)return f?32:8;if(f){if(I.a.instance.ga(50)&&gb.App.Hh.Nv)for(c=sh.a.pz(b);c.moveNext();)f=c.currentNode,12===f.type&&gb.App.Hh.JX.fpa(f);l=Object(ua.a)(Gs,l);c=new Oe.GraphTransaction(7);
c.hd(b);f=new mb.GraphIterator;f.set(b);f.af();f.yc();wc.Lh.NAa(f);c.dispose();l&&(l.uZb=!0);Z.ULS.sendTraceTag(42505435,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,D.a.uz(a)||"Unknown",I.a.instance.ga(77),b.id.toString()));return 32}return 2}static deleteRow(a,b,c,f,l){b=b.node;if(!wc.eH.fUb(b))return 8;f=new mb.GraphIterator;f.set(b);f.af();let w=kk.m(b);w||wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.pPf});w&&!wc.Xub(f,a)&&(wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.yVb}),w=
!1);if(1===c)return w?32:8;if(w){if(I.a.instance.ga(50)&&!gb.App.Hh.amIAlone)for(a=sh.a.pz(b);a.moveNext();)c=a.currentNode,12===c.type&&gb.App.Hh.JX.fpa(c);Me.a.mark(4937);l=Object(ua.a)(Gs,l);a=new Oe.GraphTransaction(7);a.hd(b);wc.rq.UFc(f);a.dispose();l&&(l.uZb=!0);Me.a.mark(4938);return 32}return 2}static J3a(a,b,c){let f=!1;a=null;b.Ok&&(a=new mb.GraphIterator,a.set(b.node),(f=Cd.TableReader.Jp(a)&&Cd.TableReader.D$d(a.currentNode))?a.af():wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.oPf}));return 1===
c?f?32:8:f?(Me.a.mark(4939),b=new mb.GraphIterator,b.Pc(a),Fd.moveToCell(b,0,0),lc.OutlineElementNavigator.Ke(a),c=new Oe.GraphTransaction(7),c.Ry(b),wc.Lh.Ych(a,b),c.dispose(),Me.a.mark(4940),32):2}static insertTable(a,b,c,f,l){if(!b.Ok||!Cb.SelectionEditor.Mg(b))return 2;if(I.a.instance.ga(14)&&wc.Vi.hsa(b))return wc.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),2;if(wc.Eq()&&wc.Eq().instance&&wc.Eq().instance.EV(b))return 2;var w=new mb.GraphIterator;w.set(b.node);Cb.SelectionEditor.Rs(w);if(lg.b(w))return wc.Uc.Vb(zd.a.yo,
{["Reason"]:Hd.a.sNd}),2;if(1===c)return 32;c=1;w=2;l&&(c=l.rows,w=l.columns);f.qP=w;f.G6=c;if(Cb.SelectionEditor.Mg(b)){f=new Oe.GraphTransaction(7);Me.a.mark(4927);f.hd(b.node);b.node.kG().graphTransactionOperations.Lga(2);const S=new eI.a;I.a.instance.ga(50)&&gb.App.Hh.Nv&&gb.App.Hh.JX.fpa(b.node);var F=Ab.a.xs(b);I.a.instance.ga(49)&&(F.cache.As&&(F=F.Vd(null),wc.fh.WI(F)),S.formatting=F.Pl);S.languageId=Ab.a.language(F);I.a.instance.ga(71)&&(S.style=Mc.StyleReader.iD(b.node),wc.Sf.zXb(S.style)&&
(F=Mc.StyleReader.rK(b.node)))&&(S.style=F.mG(Mc.StyleReader.AJa));I.a.instance.ga(54)?(F=mb.GraphIterator.nb(b.node),F.oc(11),wc.vL.d7(F.currentNode)):new Yu.a(1,-1);b=wc.Lh.Axj(b);F=l&&l.aKj?wc.rq.B6(b,c,w,S):wc.rq.B6(b,c,w,S,!0);l&&(l.tableNode=F);lc.OutlineElementNavigator.Ke(b);I.a.instance.ga(56)&&S.style&&!Md.OutlineElementReader.j$d(b.currentNode)&&S.style.ta(ob.a.bX,!1)&&wc.Lh.hIa(b.currentNode,!0);wc.dr.N2a(b,null,!0,!1,-1);Md.OutlineElementReader.r8a(b)&&wc.Lh.Oba(b,!1,!0,S);f.dispose();
Z.ULS.sendTraceTag(42505436,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}, RowCount={4}, ColumnCount={5}",a,D.a.uz(a)||"Unknown",I.a.instance.ga(77),F.id.toString(),c,w));Me.a.mark(4928);u.AFrameworkApplication.oN("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorGridTableDefaultStyleSettings");return 32}return 2}static lmc(a,b,c){if(1===c)return 32;Me.a.mark(5748);a=b.node;b=new Oe.GraphTransaction(15);b.hd(a);a.setValue(ob.a.Egb,!a.ta(ob.a.Egb,!0));b.dispose();
Me.a.mark(5749);return 32}static Kfc(a,b,c,f,l){l.setValue(ob.a.Egb,!b.node.ta(ob.a.Egb,!0));return 32}}wc.wvh="top";wc.sak="center";wc.ebi="bottom";wc.WSf="__cumulative__";wc.lNd="__consistent__";wc.jB=new Al.a;wc.yC=new Al.a;wc.xi=null;wc.wu=null;wc.SF=null;wc.Ovf=null;wc.ZYe=null;wc.hA=null;wc.jm=null;wc.H_a=null;wc.s6h=wc.Gcj;wc.Csd=null;wc.zsd=null;wc.Asd=null;wc.Bsd=null;wc.Dsd=null;wc.Fsd=null;wc.Esd=null;wc.fvd=null;wc.$c=null;wc.If=null;wc.Yc=null;wc.Go=null;wc.$Ja=null;wc.Pg=null;wc.Eo=
null;wc.lfa=null;wc.NC=null;Object(e.a)(wc,"TableActor",null,[]);var gI=d(304),HP=d(802),hI=d(859),IP=d(393),JP=d(787);class iI{constructor(a,b,c,f){this.ZFc=this.XFc=null;this.Mkc=a;this.ejd=b;this.Gqh=c;this.Iqh=f}}Object(e.a)(iI,"TableSimplificationInformation",null,[]);var hv=d(408),KP=d(445),St=d(251),rq=d(211);class Jh{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc){this.Pg=this.H_a=this.uM=this.$o=null;this.Jxd=!1;this.EPh=w;this.SF=F;this.Pjb=a;this.NC=b;this.ix=c;this.xi=f;this.Eo=l;this.mb=
S;this.kk=xa;this.nEd=fa.create(2097162);this.ACe(this.nEd);this.U_e=fa.create(2097162);this.ACe(this.U_e);this.tyf=fa.create(2097162);this.ACe(this.tyf);this.R0=this.nEd;this.TCd=Za;this.PC=pb;this.Yc=Mb;this.wQb=hc;this.YSh=hc.substr(0,3);this.Yna=kc}get Sf(){return this.Pg||(this.Pg=lb.a.instance.resolve("Box4.List.IListReader"))}get qr(){return this.$o?this.$o.qr:0}get P3a(){return this.$o.kb.P3a}get Aha(){return this.$o.kb.Aha}get gPe(){return this.R0}get rNd(){return this.$o.uG&&!this.Jxd}Elh(){this.Jxd=
!0}get t0g(){return!this.$o.uG}get o$(){return cg.a.instance}get pIj(){return this.mb.ka("InternalPasteTableWithReplacingCellIsEnabled")&&I.a.instance.ga(63)||I.a.instance.ga(77)}ACe(a){var b=new KP.a(-1);this.EPh.$T.wmb(b);const c=new mb.GraphIterator;c.set(b);b=this.kk.ie(3);b.Ry(c);c.hl(a,80);b.dispose()}VNd(a,b=null){a=a.Eb;this.$o=a.Pa.clone();this.Jxd=!1;a=mb.GraphIterator.nb(a.Qgb);const c=mb.GraphIterator.nb(this.R0),f=this.kk.ie(3);f.Ry(c);a.yb(82);do a.currentNode.nZa(null);while(a.xj(82));
a=new Tb.a(b,Object(C.a)(this,this.tli,"clearInternalClipboard"),new ZH(a,c,this.$o,f));a.vl("InternalCopy");a.Ui=!b||b.Ui;a.run()}tli(a,b){Me.a.mark(5566);b=b.target;if(b.Ii())return b.Hi(),!0;a.Wg(Object(C.a)(this,this.$Hc,"executeCopy"));return!0}$Hc(a,b){b=new dz(b,null);b=new Tb.a(a,Object(C.a)(this,this.MVb,"coreCopySetup"),b);b.vl("ExecuteCoreCopyToInternalClipboard");b.run();a.Wg(Object(C.a)(this,this.tml,"trimNewText"));return!0}MVb(a,b){if(!b.source.Ii())return b.jh&&(b.jh.ICc=null),Z.ULS.shipAssertTag(6305560,
307,!1),!1;a.Wg(Object(C.a)(this,this.pQf,"coreCopyIteration"));return!0}pQf(a,b){const c=b.insertAfter,f=b.source,l=b.target,w=f.currentNode;var F=this.t0g;if(!w.M9d)return a.Wg(Object(C.a)(this,this.qEc,"coreCopyIncrement")),!0;b.jh.Mgd&&(b.Mgd=!0);if(!b.Mgd&&(w.tYb()&&b.j5.Bia.c++,w.tYb()||F&&!w.Jub(this.qr)))return a.Wg(Object(C.a)(this,this.qEc,"coreCopyIncrement")),!0;if(!b.Mgd&&F&&!w.Px)return f.rCa()&&(b.bmd=!0,b=new Tb.a(a,Object(C.a)(this,this.MVb,"coreCopySetup"),new dz(b,c)),b.vl("RecursiveCoreCopyToInternalClipboard"),
b.run()),a.Wg(Object(C.a)(this,this.qEc,"coreCopyIncrement")),!0;F=l.currentNode.lo().Ai;F=sm.a(w,F,!0);this.o$.ahc(b.j5.O6a,F);l.vK(F,c,18===f.parentNode.type?1:f.role);l.Ck(F);b.insertAfter=F;db.ParagraphReader.Pd(F)&&(this.myk(a,Object(C.a)(this,this.MVb,"coreCopySetup"),w,F,b),this.lyk(w,F));this.VZf(w,F);f.rCa()&&(Z.ULS.shipAssertTag(6305562,307,!b.bmd),b=new Tb.a(a,Object(C.a)(this,this.MVb,"coreCopySetup"),new dz(b,null)),b.vl("RecursiveCoreCopyToInternalClipboard"),b.run());a.Wg(Object(C.a)(this,
this.tti,"coreCopyIterationPostProcessing"));return!0}tti(a,b){var c=b.source;const f=b.target;var l=f.currentNode,w=c.currentNode;db.ParagraphReader.Pk(f)&&(b.Swe[w.id.toString()]=l);if(I.a.instance.ga(54)&&db.ParagraphReader.Pd(l)){if(0<db.ParagraphReader.Cdg(w))if(0<this.SF.c6a(w).aM)w.setValue(Sb.a.Vdc,0);else{var F=this.SF.Qrb(w).aM;Jh.paragraphEditor.Qu.ifb(l,F)}if(!this.O7a&&this.Yna.o9c){c.yc();if(!Cd.TableReader.Nr(f)&&c.rub&&!this.Aha)for(var S of this.Yna.Fpk)l.removeProperty(S);c.Ck(w)}}if(I.a.instance.ga(57)&&
db.ParagraphReader.Pd(l)){F=[];S=[];for(let fa=0;fa<l.wordRunProperties.length;fa++)l.wordRunProperties.pX.$(fa,gI.CharacterPropertiesEditor.vda),l.wordRunProperties.Jda.$(fa,gI.CharacterPropertiesEditor.uda),F[fa]=!0,S[fa]=!1;l.ke(Sb.a.F5c,F);Z.ULS.shipAssertTag(6305563,307,F.length===l.wordRunProperties.length);Z.ULS.shipAssertTag(6305564,307,I.a.instance.ga(50));Z.ULS.shipAssertTag(6305565,307,!!gb.App.Hh);I.a.instance.ga(50)&&gb.App.Hh.Nv&&(l.ke(Fs.a.$v,S),Z.ULS.shipAssertTag(6305566,307,S.length===
l.wordRunProperties.length));(this.Yc.Zf&&this.Yc.fy||I.a.instance.ga(45)&&gb.App.WC.oIb)&&l.setValue(Sb.a.L3b,!0);I.a.instance.ga(14)&&l.Kn(Sb.a.wUd,Sb.a.upk,Sb.a.wpk);I.a.instance.ga(45)&&db.ParagraphReader.Pd(l)&&l.Kn(Sb.a.C8a)}this.r0g(f)&&(F=f.currentNode.kG(),l=cb.ImageReader.CMc(f.currentNode.properties,F.Ai,!1),F=cb.ImageReader.CMc(f.currentNode.properties,F.Ai,!0),S=null,hb.EmbeddedFileReader.FRc(f)&&(S=hb.EmbeddedFileReader.lLc(f.currentNode)),this.yUd(l,w),this.yUd(F,w),this.yUd(S,w));
this.t0g&&(this.UZf(f),Cd.TableReader.Jp(f)&&(w=this.$o.dV(),w.moveNext(),(w=Ce.getCellLocation(c,w.current.node))||(w=new JP.a(0,0)),c=new iI(w,f,Cd.TableReader.oYi(c),Cd.TableReader.N9i(c)),this.NC.lRk(c)));Md.OutlineElementReader.Tg(f)&&!f.$H(2)&&(this.xi.Uaa(f),f.yc());f.yc();b.jh&&(b.jh.ICc=b.insertAfter);a.Wg(Object(C.a)(this,this.qEc,"coreCopyIncrement"));return!0}qEc(a,b){b.bmd&&(b.insertAfter=b.ICc,b.bmd=!1);if(!b.source.oCa()){b.jh&&(b.jh.ICc=b.insertAfter);const c=b.source;11!==c.ri||c.mMc(-1)||
this.Hyk(a,c.currentNode,b.target.currentNode,b);return!1}a.Wg(Object(C.a)(this,this.pQf,"coreCopyIteration"));return!0}lyk(a,b){a=zg.f(a);zg.f(b);for(b=0;b<a.length;b++)Object(C.a)(this,this.MVb,"coreCopySetup")}tml(a,b){if(b.Wpa>=b.iFb.length)return a.Wg(Object(C.a)(this,this.sti,"copyTeardown")),!0;a=b.iFb[b.Wpa];var c=a.node,f=a.Qa,l=a.Lb;if(!Cb.SelectionEditor.iu(a))if(!b.Wpa&&Cb.SelectionEditor.Bl(a))l=f=db.ParagraphReader.textLength(c);else if(db.ParagraphReader.Tl(a))f=0,l=db.ParagraphReader.textLength(c);
else if(Cb.SelectionEditor.v7(a)){Z.ULS.shipAssertTag(6305568,307,!b.Wpa);var w=mb.GraphIterator.nb(c);f=w.oc(12);Z.ULS.shipAssertTag(6305569,307,f);c=w.origin;l=f=db.ParagraphReader.textLength(c)}else{if(Vi.OutlineReader.S3b(a))for(a=hx.a.pz(a.node);a.moveNext();)w=a.currentNode,db.ParagraphReader.Pd(w)&&Array.add(b.iFb,Fc.a.createTextRange(w,0,db.ParagraphReader.textLength(w)));b.Wpa++;return!0}w=b.Swe[c.id.toString()];Z.ULS.shipAssertTag(6305570,307,!!w);if(!w)return Z.ULS.sendTraceTag(21041548,
307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:b.Wpa,["SelectedContextsLength"]:b.iFb.length,["SelectedNodeType"]:c.type,["ContextId"]:a.contextId}),b.Wpa++,!0;c=zg.f(w);let F,S=!1;for(F=c.length-1;0<=F;F--)if(!c[F].YBc)if(4===c[F].wq)c[F].xe.blob=null,c[F].xe.blob=new hv.a(c[F].xe,hv.a.MFc),b.j5.Bia.e++;else{c[F].xe.blob=null;if(I.a.instance.ga(57)&&-1!==c[F].jg){var fa=c[F].xe.formatting,xa=void 0,Za=void 0;fa&&-1===fa.jg?(Za=c[F].jg+1,xa=c[F].s9-1,fa.jg=c[F].jg):(xa=c[F].s9,Za=c[F].jg);
for(fa=0;fa<xa;fa++)w.wordRunProperties.removeAt(Za,16);0<xa&&(S=!0)}xa="";St.f(c[F])?(xa=" ",b.j5.Bia.f++):St.g(c[F])&&(Za=St.b(c[F]))&&(xa=St.a(Za),b.j5.Bia.g++);Za=c[F].xe.cp;Za>=f&&Za<l&&(Jh.characterPropertiesEditor.replaceTextRange(Fc.a.createTextRange(w,Za,Za+1),xa),l=l-1+xa.length,b.j5.Bia.i++)}S&&w.vu();this.LLk(w);c=db.ParagraphReader.textLength(w);l<c&&Jh.characterPropertiesEditor.replaceTextRange(Fc.a.createTextRange(w,l,c),"");0<f&&Jh.characterPropertiesEditor.replaceTextRange(Fc.a.createTextRange(w,
0,f),"");f=0;l=mb.GraphIterator.nb(w);for(l.yb(6);!l.Fq;)c=l.currentNode,l.xj(6),cb.ImageReader.tG(c)?cb.ImageReader.g$d(c)?(Jh.paragraphEditor.MPf(c,Fc.a.Wj(w,f)),f++,b.j5.Bia.d++):(c=mb.GraphIterator.nb(c),c.oc(12),c.Hi(),b.j5.Bia.h++):Z.ULS.shipAssertTag(6305571,307,!1);!db.ParagraphReader.textLength(w)&&b.Wpa===b.iFb.length-1&&Cb.SelectionEditor.iu(a)&&(a=mb.GraphIterator.nb(w),a.oc(25)&&(lc.OutlineElementNavigator.Ke(a),this.xi.NAa(a),b.Wpa&&(this.$o.kb.Aha=!0)));this.o$.AWa(b.j5.Y8c,b.j5.y3a,
b.j5.eNa,w);b.Wpa++;return!0}LLk(a){const b=I.a.instance.ga(14),c=!this.Yc.Zf&&I.a.instance.ga(45),f=Jh.gN,l=a.Ra;if(I.a.instance.ga(57)&&l&&(b||c)){var w=new Ua.a,F=new Ua.a;for(let fa=0;fa<l.length;fa++){const xa=l.ga(fa);if(b){xa.al&&w.add(xa);if(f){if(xa.Qh){for(var S=0;S<xa.Qh.length;S++)F.add(xa.Qh.ga(S).jg);xa.Qh=null}}else xa.fieldRangeEnd&&(F.add(xa.fieldRangeEnd.jg),xa.fieldRangeEnd=null),xa.jo&&(F.add(xa.jo.jg),xa.jo=null);if(xa.Vj){for(S=0;S<xa.Vj.length;S++)F.add(xa.Vj.ga(S).jg);xa.Vj=
null}}if(c){if(gb.App.WC.oIb){xa.formatting&&Jh.fh.WI(xa.formatting);if(xa.hyperlink){for(S=0;S<xa.hyperlink.s9;S++)F.add(xa.hyperlink.jg+S);xa.hyperlink=null}xa.Im=!1}xa.trackedChange=null;xa.lI=!1}}a.tHa(!0,F);for(let fa of w)fa.al=null;c&&1<l.length&&(a=l.first,a.trackedChange=new HP.a(a),l.last.lI=!0)}}sti(a,b){this.R0.nZa(null);b.Rgj.dispose();Me.a.mark(5567);this.Ick();this.uM=b.j5;this.Qzg("Copy");this.CBj&&Z.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get CBj(){return!mb.GraphIterator.nb(this.R0).Ii()}$ul(){this.R0=
this.tyf}Zul(){this.R0=this.nEd}Nul(){this.R0=this.U_e}GMf(){const a=mb.GraphIterator.nb(this.R0);for(;a.Ii();)a.Hi()}Qzg(a){const b=this.uM.Bia.b;a+="-"+b;this.uM.Bia.b=a;this.uM.O6a.b=a;this.uM.Y8c.b=a;this.uM.y3a.b=a;this.uM.eNa.b=a;this.o$.sUj(this.uM.Bia);this.o$.cce(this.uM.O6a);this.o$.qAg(this.uM.Y8c);this.o$.Xbe(this.uM.y3a);this.o$.Wbe(this.uM.eNa);this.uM.Bia.b=b;this.uM.O6a.b=b;this.uM.Y8c.b=b;this.uM.y3a.b=b;this.uM.eNa.b=b}v2g(a,b,c,f,l=null,w=null){this.Qzg("Paste");b=mb.GraphIterator.nb(b);
const F=mb.GraphIterator.nb(this.R0);var S=null;l&&(S=new Hw.a(Vi.OutlineReader.LFc,Vi.OutlineReader.eUf),S=l.equals(new Hw.a(-1,-1))?new Hw.a(0,0):l.WT(S));if(this.DQc())if(F.Ii(),cb.ImageReader.tG(F.currentNode))l=F.currentNode,F.yc(),F.vK(this.xi.ROd(),null,1),F.Ii(),F.vK(l,null,2),F.yc(),F.Ck(l),F.Hi(),this.Pjb.rhk(),this.Elh();else if(hb.EmbeddedFileReader.e8a(F.currentNode)){l=F.currentNode;F.yc();F.vK(this.xi.ROd(),null,1);F.Ii();var fa=this.xi.Uaa(F);fa=Fc.a.Wj(fa,0);Jh.characterPropertiesEditor.replaceTextRange(fa,
"<<"+hb.EmbeddedFileReader.mLc(l)+">>");F.yc();F.yc();F.Ck(l);F.Hi();this.Elh()}this.pIj&&this.Zwg(F,b)?(F.currentNode.nZa(null),Z.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.xPk(w,F,b,S,a),Z.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended.")):(Me.a.mark(5564),F.currentNode.nZa(null),a={},a[Jh.ssj]=f,yc.ListReader.vRa(c)&&this.Sf.Hfc&&(a[hI.a.jpg]=!0),c=new ez(F,b,c,S,a),f=new Tb.a(w,Object(C.a)(this,this.NVb,"corePasteSetup"),
c),f.vl("ExecuteCorePasteFromInternalClipboard"),f.Ui=!w||w.Ui,this.byk(c),f.run())}Bwg(a){if(a&&a.isValid){const b=mb.GraphIterator.nb(this.R0);return this.Zwg(b,a)}return!1}Zwg(a,b){if(Ce.isTableCellOrInside(b)&&1===a.N5a()){a.yb(1);if(Md.OutlineElementReader.Tg(a)){lc.OutlineElementNavigator.ti(a);if(Cd.TableReader.Jp(a)){Cd.TableReader.gu(a.currentNode)&&Z.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(b.oc(14)&&!Cd.TableReader.gu(Fd.getContainingTable(b)))return Z.ULS.sendTraceTag(19269659,
307,50,"Target table is not a complex table."),!0;Z.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table.");if(this.O7a)return!0}lc.OutlineElementNavigator.Ke(a)}a.yc()}return!1}xPk(a,b,c,f,l){c.oc(14);const w=kk.c(c),F=Ln.a(c);c.Og(14);var S=Cd.TableReader.Zj(c.currentNode);const fa=Cd.TableReader.ui(c.currentNode),xa=Cd.TableReader.Zj(b.currentNode),Za=Cd.TableReader.ui(b.currentNode);Z.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};",
S,fa,xa,Za);this.H_a=wc.esb;if(this.iMj(w+xa,F+Za)){var pb=w+xa-S;0<pb&&(Fd.moveToLastRow(c),Z.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+pb),this.NC.k6d(c,!1,pb,this.H_a),Z.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),c.Og(14));pb=F+Za-fa;if(0<pb){Z.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+pb);try{this.NC.Slg(c,fa,!1,pb,this.H_a)}catch(Mb){throw Z.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",Mb.toString()),Mb;}Z.ULS.sendTraceTag(8716377,
307,50,"Completed inserting columns.")}S=this.sXi(S,fa,xa,Za,w,F);Z.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");a=new Tb.a(this.O7a?a:null,Object(C.a)(this,this.Erk,"pasteTableOperationRun"),new aI(null,b,c,f,w,F,S,null,l));a.vl("ExecuteCorePasteTableInTable");a.Ui=!1;a.run()}}iMj(a,b){if(!this.$tg)return!0;const c={};a>Jh.GBc&&(c.rowCount=a,c.c_maxTableRowColCount=Jh.GBc);b>Jh.GBc&&(c.columnCount=b,c.c_maxTableRowColCount=Jh.GBc);const f=a*b;f>Jh.oJf&&(c.rowCount=a,c.columnCount=
b,c.cellsCount=f,c.c_maxTableCellCount=Jh.oJf);0<rq.a(c).length&&Z.ULS.sendTraceTag(39716808,307,10,"IsTableDimensionValid: {0}",c);return!rq.a(c).length}Erk(a,b){if(b.JHb){if(b.JHb.inProgress)return!0;Ce.isTableCell(b.source)||b.source.Og(16);this.$tg&&Ce.isFirstCellInTable(b.source)&&this.ISb(b.Gf,b.target.currentNode);if(Ce.isLastCellInTable(b.source))return this.Kck(Fd.getContainingTable(b.target)),Z.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"),!1;Ce.isTableCell(b.target)||
b.target.Og(16);const c=!this.O7a;Ce.isLastCellInRow(b.source)?(Fd.moveToNextRow(b.target),Fd.moveToColumnByIndex(b.target,b.$ga),Z.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")):Fd.moveToNextOrPreviousCell(b.target,!1,c);Fd.moveToNextOrPreviousCell(b.source,!1,c)}else Cd.TableReader.Jp(b.target)||b.target.Og(14),Cd.TableReader.Jp(b.source)||b.source.Og(14),Fd.moveToCell(b.target,b.rowIndex,b.$ga),Fd.moveToCell(b.source,0,0);for(;b.target.Ii();)b.target.Hi();b.JHb=new Tb.a(a,
b.A2g?b.A2g:Object(C.a)(this,this.NVb,"corePasteSetup"),new ez(b.source,b.target,null,b.M8c));b.JHb.vl("ExecuteCorePasteCellContentInCell");b.JHb.Ui=!1;b.JHb.run();return!0}Ick(){if(this.O7a){for(var a=mb.GraphIterator.nb(this.gPe),b=a.currentNode;14!==a.ri;)if(b=a.Ii(),!b){Z.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.UTg(b)}}Kck(a){this.O7a&&this.UTg(a)}Njl(a){const b=mb.GraphIterator.nb(a);this.ix.x2b(b,null,
!0);a.isGhostCell=!1;a.rowSpan=1;a.colSpan=1}UTg(a){if(a&&14===a.type){Z.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var b={},c=Cd.TableReader.Zj(a),f=Cd.TableReader.ui(a),l=mb.GraphIterator.nb(a);Fd.forEachCellInTable(l,(w,F,S)=>{const fa={};w=w.currentNode;if(16===w.type)if(w.isGhostCell)Jh.NOf(F,S)in b||(this.Njl(w),fa.IsGhostCell="->false");else{I.a.instance.ga(77);Jh.iHk(a,w,F,S,c,(Za,pb,Mb)=>{fa.rowSpan=String.format("{0}:{1}->{2}",Za,pb,Mb)});Jh.hHk(a,w,S,F,f,(Za,
pb,Mb)=>{fa.colSpan=String.format("{0}:{1}->{2}",Za,pb,Mb)});const xa=String.format("{0},{1}-{2},{3}",F,S,F+w.rowSpan,S+w.colSpan);for(let Za=0;Za<w.rowSpan;Za++)for(let pb=0;pb<w.colSpan;pb++)if(Za||pb)b[Jh.NOf(F+Za,S+pb)]=xa}if(0<rq.a(fa).length){if(void 0===fa.IsGhostCell||null===fa.IsGhostCell){if(void 0===fa.rowSpan||null===fa.rowSpan)fa.rowSpan=w.rowSpan;if(void 0===fa.colSpan||null===fa.colSpan)fa.colSpan=w.colSpan}Z.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",F,S,fa)}return!0});
Jh.sHi(b)}}get $tg(){return I.a.instance.ga(77)}get O7a(){return!!this.mb&&this.mb.ka("ComplexTableCellPasteWithFormattingIsEnabled")}ISb(a,b){a?(b=mb.GraphIterator.nb(b),b.xA(1)?(b=b.yb(2))?(b=fd.SelectionFactory.Lg(b,0),a.Eb.setSelection(b)):Z.ULS.sendTraceTag(38843739,307,50,"AdjustSelectionAfterPaste: no child paragraph node was found."):Z.ULS.sendTraceTag(38843740,307,50,"AdjustSelectionAfterPaste: no child OE node was found.")):Z.ULS.sendTraceTag(38843738,307,50,"AdjustSelectionAfterPaste: interactiveView is null, abort.")}sXi(a,
b,c,f,l,w){const F=[];for(let S=0;S<Math.max(l+c,a);S++){let fa=0,xa=w+f;for(S<l?fa=b:S>=l&&S<Math.min(l+c,a)?fa=w:S>=l+c&&S<a?fa=b:xa=Math.max(w+f,b);fa<xa;fa++)Array.add(F,Array(2)),F[F.length-1][0]=S,F[F.length-1][1]=fa}return F}NVb(a,b){if(!b.source.Ii())return a.Wg(Object(C.a)(this,this.$Va,"pasteTeardown")),!0;a.Wg(Object(C.a)(this,this.qQf,"corePasteIteration"));return!0}GPk(a,b){if(this.O7a)if(!b||!a)Z.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:a,["table"]:b});
else if(16===b.currentNode.type&&16===a.parentNode.type){b=b.currentNode;a=a.parentNode;var c={};b.isGhostCell!==a.isGhostCell&&(b.isGhostCell=a.isGhostCell,c.IsGhostCell=b.isGhostCell);b.isSkippedCell!==a.isSkippedCell&&(b.isSkippedCell=a.isSkippedCell,c.IsSkippedCell=b.isSkippedCell);b.Nfb!==a.Nfb&&(b.Nfb=a.Nfb,c.ShouldRenderCell=b.Nfb);b.colSpan!==a.colSpan&&(c.ColSpan=String.format("{0}<={1}.",b.colSpan,a.colSpan),b.colSpan=a.colSpan);b.rowSpan!==a.rowSpan&&(c.RowSpan=String.format("{0}<={1}.",
b.rowSpan,a.rowSpan),b.rowSpan=a.rowSpan);rq.a(c)}}qQf(a,b){const c=b.source,f=b.target,l=c.currentNode;if(!l.M9d||!l.iob)return a.Wg(Object(C.a)(this,this.rEc,"corePasteIncrement")),!0;if(this.Yc.Zf&&Md.OutlineElementReader.Tg(c)){if(!lc.OutlineElementNavigator.ti(c).iob)return lc.OutlineElementNavigator.Ke(c),a.Wg(Object(C.a)(this,this.rEc,"corePasteIncrement")),!0;lc.OutlineElementNavigator.Ke(c)}Z.ULS.shipAssertTag(6305608,307,!l.tYb());var w=f.currentNode.lo().Ai;w=sm.a(l,w,!0);w.Bcb();this.GPk(c,
f);f.vK(w,b.insertAfter,c.role);f.Ck(w);b.insertAfter=w;I.a.instance.ga(50)&&gb.App.Hh.Nv&&gb.App.Hh.JX.fpa(w);this.VZf(l,w);b=new Tb.a(a,Object(C.a)(this,this.NVb,"corePasteSetup"),new ez(c,f,null,b.M8c,b.jK));b.vl("RecursiveCorePasteOperation");b.run();a.Wg(Object(C.a)(this,this.yti,"corePasteIterationPostProcessing"));return!0}Nyk(a,b,c){b=zg.f(b);c=zg.f(c);for(let f=b.length-1;0<=f;f--)b[f].Ute(c[f],a,Object(C.a)(this,this.NVb,"corePasteSetup"))}yUd(a,b){a&&(Z.ULS.shipAssertTag(6305610,307,a.Sa(bh.a.Hdc)),
a.Sa(bh.a.Hdc)||a.setValue(bh.a.Hdc,a.ta(bh.a.FUg,"")),b=(b=IP.SectionNavigator.kcg(b))?b.fileId:gb.App.Fb.Fd.taa?gb.App.Fb.Fd.taa.fileId:null,!a.Sa(bh.a.fileId)&&b&&a.setValue(bh.a.fileId,b))}zUd(a){a&&this.Pjb.W0k()}yti(a,b){const c=b.target,f=c.currentNode,l=b.source.currentNode;db.ParagraphReader.Pd(f)&&(this.Oyk(a,Object(C.a)(this,this.NVb,"corePasteSetup"),l,f,b),this.Nyk(a,l,f));f.qVg();b.jK[hI.a.jpg]&&22===f.type&&f.setValue(Sb.a.listID,Number.MAX_VALUE);if(I.a.instance.ga(11)&&db.ParagraphReader.Pd(f)){var w=
zg.j(f,5);if(0<w.length){for(var F of w)!F.properties.Sa(Sb.a.w3g)&&F.properties.Sa(Sb.a.v3g)&&(w=F.properties.getValue(Sb.a.v3g),F.properties.setValue(Sb.a.w3g,w)),cb.ImageReader.e$d(F.properties)||this.Pjb.pVk();f.lo().contentReplicator.forceOutbound(null,null,null)}}I.a.instance.ga(25)&&Md.OutlineElementReader.Tg(c)&&this.xi.RRe(c.currentNode);I.a.instance.ga(10)&&Vi.OutlineReader.ESc(f)&&(F=lq.b(f),b=b.M8c,lq.c(f,F.x+b.x,F.y+b.y));if(this.r0g(c)){b=c.currentNode.kG();F=cb.ImageReader.CMc(c.currentNode.properties,
b.Ai,!1);w=cb.ImageReader.CMc(c.currentNode.properties,b.Ai,!0);let S=null;hb.EmbeddedFileReader.FRc(c)&&(S=hb.EmbeddedFileReader.lLc(c.currentNode));this.zUd(F);this.zUd(w);this.zUd(S);if(F||w||S)b.AHj=!0,b.BHj=!0}I.a.instance.ga(24)&&hb.EmbeddedFileReader.FRc(c)&&(b=c.currentNode,hb.EmbeddedFileReader.ZDj(c)?(c.yc(),F=this.ix.Axi(),F.setValue(ob.a.qI,Jh.hk.isRtl(b)?11:9),w=lq.b(f),lq.c(F,w.x,w.y),c.vK(F,b,1),c.Ck(b),c.jWf(),this.ix.zY(c,!1)):c.Hi(),F=this.xi.Uaa(c),F=Fc.a.Wj(F,0),Jh.characterPropertiesEditor.replaceTextRange(F,
"<<"+hb.EmbeddedFileReader.mLc(b)+">>"));this.UZf(c);this.$tl(l,f);c.yc();a.Wg(Object(C.a)(this,this.rEc,"corePasteIncrement"));return!0}r0g(a){return I.a.instance.ga(1)&&cb.ImageReader.w3b(a)||I.a.instance.ga(24)&&hb.EmbeddedFileReader.FRc(a)}$tl(a,b){if(this.Yc.Zf&&Cd.TableReader.M8a(a)){let c=0;const f=Cd.TableReader.Zj(a);for(let l of Cd.TableReader.OMc(a,0,f-1))l.ymc&&c++;a=this.kk.ie(4);a.hd(b);b.properties.setValue(ob.a.Uwa,f-c);a.dispose()}}rEc(a,b){if(!b.source.oCa())return a.Wg(Object(C.a)(this,
this.$Va,"pasteTeardown")),!0;a.Wg(Object(C.a)(this,this.qQf,"corePasteIteration"));return!0}$Va(){Me.a.mark(5565);return!1}Q5c(){return!mb.GraphIterator.nb(this.R0).Ii()}DQc(){return this.rNd?1===mb.GraphIterator.nb(this.R0).N5a():!1}hyj(){const a=mb.GraphIterator.nb(this.R0);this.DQc()&&a.Ii();return 1===a.N5a()&&(a.Ii(),Md.OutlineElementReader.Tg(a)&&1===a.N5a()&&a.yb(2))?db.ParagraphReader.Pk(a)&&!Jh.eH.qPf(a):!1}QXi(){const a=mb.GraphIterator.nb(this.R0);this.DQc()&&a.Ii();a.Ii();a.Ii();Z.ULS.shipAssertTag(6305614,
307,db.ParagraphReader.Pk(a));return db.ParagraphReader.text(a.currentNode)}w7f(a){try{return this.gZi(a)}catch(b){return Z.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",b.message),0}}gZi(a){let b=0;if(a&&(b=this.fZi(a),0===b&&a.childNodes))for(let c=0;c<a.childNodes.length&&(b=this.w7f(a.childNodes[c]),0===b);c++);return b}fZi(a){if(1===a.nodeType&&a.getAttribute){a=(a.getAttribute("class")||"").split(" ");for(const b of a)if(b.startsWith(this.YSh))return b.startsWith(this.wQb)?
this.qr&&b===this.wQb+this.qr?3:2:1}return 0}myk(a,b,c,f,l){l.jK||(l.jK={});Jh.Ta.raiseEvent("OnParagraphCopy",new fz(a,b,c,f,l.jK))}Hyk(a,b,c,f){f.jK||(f.jK={});Jh.Ta.raiseEvent("OnCopyComplete",new fz(a,null,b,c,f.jK))}byk(a){a.jK||(a.jK={});Jh.Ta.raiseEvent("BeforePaste",new $H(a.jK))}Oyk(a,b,c,f,l){Jh.Ta.raiseEvent("OnParagraphPaste",new fz(a,b,c,f,l.jK))}UZf(a){Ce.isTableCell(a)&&(a.yb(1)||this.ix.zY(a,!0),a.yc())}VZf(a,b){this.TCd.isTableCellNode(b)&&(b.width=a.width)}static get fh(){return Jh.If||
(Jh.If=lb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Jh.Vg||(Jh.Vg=lb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Jh.tw||(Jh.tw=lb.a.instance.resolve("Box4.IParagraphEditor"))}static get gN(){const a=lb.a.instance.qb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(79)}static get eH(){return ul.a.instance}static get hk(){return $u.PageReader.instance}static sHi(a){const b={};for(const c of rq.a(a)){const f=
a[c];b[f]=f in b?String.format("{0}|{1}",b[f],c):c}1<=rq.a(b).length&&Z.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",b)}static hHk(a,b,c,f,l,w){b.colSpan>l-c&&(w&&w("A",b.colSpan,l-c),b.colSpan=l-c);a=Jh.Val(a,b,f,c);b.colSpan!==a&&(w&&w("B",b.colSpan,a),b.colSpan=a)}static iHk(a,b,c,f,l,w){b.rowSpan>l-c&&(w&&w("A",b.rowSpan,l-c),b.rowSpan=l-c);a=Jh.Wal(a,b,c,f);b.rowSpan!==a&&(w&&w("B",b.rowSpan,a),b.rowSpan=a)}static Val(a,b,c,f){return Jh.Eph(a,b.colSpan,(l,w)=>{Fd.moveToCell(l,
c,f+w)})}static Wal(a,b,c,f){return Jh.Eph(a,b.rowSpan,(l,w)=>{Fd.moveToCell(l,c+w,f)})}static Eph(a,b,c){if(14!==a.type)throw Error.argument("tableNode is not a Table.");if(!c)throw Error.argumentNull("MoveToCellAction");for(let l=1;l<b;l++){var f=mb.GraphIterator.nb(a);c(f,l);f=f.currentNode;if(!f||16!==f.type||!f.isGhostCell)return l}return b}static NOf(a,b){return a+","+b}}Jh.Ta=new sd.a;Jh.If=null;Jh.Vg=null;Jh.tw=null;Jh.GBc=50;Jh.oJf=1225;Jh.ssj="PasteConstrainingWidth";Object(e.a)(Jh,"InternalClipboard",
null,[]);class jI extends mj{constructor(a,b,c,f,l,w){super(a,b,c,l);this.Dr=f;this.pwd=w}get F6k(){return u.AFrameworkApplication.fa.ka("AutoResizeDragDropImageIsEnabled")}get kh(){return this.pwd.value}get Q5c(){return this.Dr.Q5c()}get S2g(){const a=this.Dr;return a.rNd&&!a.DQc()}K_f(a,b){Z.ULS.shipAssertTag(6305616,307,Vi.OutlineReader.xt(a));const c=lq.b(a.currentNode);if(Vi.OutlineReader.isEmpty(a)){var f=Fc.a.create(a.currentNode);a.nC(8);u.AFrameworkApplication.Va.li(f,D.a.dK,2,!0,null,null)}else a.nC(8);
(f=a.xA(1))&&a.yc();this.Dr.v2g(this.jh.Gf,a.currentNode,f,-1,c,b)}get crg(){return this.Dr.hyj()}get uPf(){return this.Dr.QXi()}J_f(a){const b=new mb.GraphIterator;this.udb.restore(b);Z.ULS.shipAssertTag(6305618,307,Md.OutlineElementReader.Tg(b));this.jh.E_&&this.jh.E_.vAc("internal");let c=-1;if(this.enh&&Object(Ca.a)(10,this.jh.od))c=this.jh.od.ta(Fs.a.KXb,-1);else if(this.F6k){const f=this.WZi(b.currentNode);c=f?f.clientWidth:c}this.Dr.v2g(this.jh.Gf,b.parentNode,b.currentNode,c,null,a);this.Qtg&&
(this.udb.restore(b),Md.OutlineElementReader.Tg(b)&&this.Dr.Bwg(b)&&(a=lc.OutlineElementNavigator.ti(b)))&&(this.jh.Nqa=fd.SelectionFactory.Lg(a,0))}WZi(a){return a?(a=a?a.pc(this.kh.Na):null)?a.htmlElement:null:null}Rnh(){const a=new mb.GraphIterator;this.udb.restore(a);return this.Dr.Bwg(a)}get rnh(){return yc.ListReader.Gw}get qnh(){return!this.Dr.Aha&&!this.Dr.rNd}}Object(e.a)(jI,"InternalPasteExecutionManager",mj,[]);class kI{constructor(a,b){this.Dr=a;this.pwd=b}create(a,b,c){return new jI(a,
b,c,this.Dr,gb.App.Fb.Fd,this.pwd)}}Object(e.a)(kI,"Factory",null,[588]);var gz;(function(a){a[a.unknown=0]="unknown";a[a.differentBox4App=1]="differentBox4App";a[a.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";a[a.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(gz||(gz={}));Object(e.b)("CopySource",gz);class Rr{constructor(a,b,c){this.Dr=a;this.u5e=b;this.NJh=c}mrk(a,b,c){Z.ULS.shipAssertTag(6305620,307,!!a);Z.ULS.shipAssertTag(6305621,307,Cb.SelectionEditor.Mg(b));Z.ULS.shipAssertTag(6305622,
307,!!c);Z.ULS.shipAssertTag(6305623,307,Object(Ca.a)(Yo,c.h4));const f=c.h4;f.KNa=this.Dr.w7f(a);this.rUj(a,f);const l=this.W8d(a,b,f);if(l||this.WJe(a,b,f)){var w=new Oe.GraphTransaction(7);w.hd(b.node);b.node.kG().graphTransactionOperations.Lga(8);l?(Z.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",f.vw,f.browserName),a=this.u5e.create(b,f,w)):(Z.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",f.vw,f.KNa,f.browserName),Rr.kUj(a),a=
this.NJh.create(a,b,f,w));c=new Tb.a(c,Object(C.a)(a,a.D2g,"pasteSetup"),null);c.vl("Paste");c.run()}else f.Nqa=fd.SelectionFactory.Zt(b)}W8d(a,b,c){return!this.Iug(c)&&3===c.KNa}WJe(){return!0}Iug(a){return 1===(a.vw&8192?1:0)}lpg(a,b){Z.ULS.shipAssertTag(6305624,307,Cb.SelectionEditor.Mg(a));Z.ULS.shipAssertTag(6305625,307,!!b);Z.ULS.shipAssertTag(6305626,307,Object(Ca.a)(Yo,b.h4));const c=new Oe.GraphTransaction(7);c.hd(a.node);a=this.u5e.create(a,b.h4,c);b=new Tb.a(b,Object(C.a)(a,a.D2g,"pasteSetup"),
null);b.vl("InternalPasteAtIp");b.run()}rUj(a,b){if(a){let c=!1,f=!1;a.innerHTML&&0<=a.innerHTML.indexOf("mso-tab-count")?f=!0:a.innerText&&0<=a.innerText.indexOf("\t")&&(c=!0);if(c||f)u.AFrameworkApplication.oN("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),Z.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",gz[b.KNa],c,f)}}static kUj(a){a&&Rr.QWh.test(a.innerText)&&Z.ULS.sendTraceTag(6350173,
307,50,"External paste operation starts on WebUrl")}}Rr.QWh=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(e.a)(Rr,"PasteCoordinator",null,[]);class pC{constructor(a,b){this.jk=a;this.w5=b}}Object(e.a)(pC,"PasteFloatieFeatureSetBuilder",null,[]);class no{constructor(a,b){this.tLb=a;this.rHh=b}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get j4f(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get DFc(){return CommonUIStrings.l_ClipboardCut}get Rqe(){return CommonUIStrings.l_ClipboardCut_Mac}get pEc(){return CommonUIStrings.l_ClipboardCopy}get Qqe(){return CommonUIStrings.l_ClipboardCopy_Mac}get RGa(){return CommonUIStrings.l_ClipboardPaste}get Sqe(){return CommonUIStrings.l_ClipboardPaste_Mac}get uva(){return CommonUIStrings.l_ClipboardPasteText}get Tqe(){return CommonUIStrings.l_ClipboardPasteText_Mac}get lMd(){return this.rHh}get kNf(){return CommonUIStrings.l_ClipboardExtensionLink}get yNa(){return CommonUIStrings.l_ClipboardExtensionSuggestion}l0f(){Z.ULS.sendTraceTag(8716421,
307,50,null);id.a.Qm(this.lMd,"_blank",void 0,"ClipboardAccessExtensionLink")}V_(a,b){let c=r.a.ak;u.AFrameworkApplication.fa.ka("CcpFixIPadShortcutStringsIsEnabled")&&(c=r.a.Ji||c);return c?String.format(b,"\u2318"):a}dispose(){this.tLb=null}PBe(a){this.iQf(a)}pQj(a){this.iQf(a)}iQf(a){this.tLb&&this.tLb(a)}}no.id="CopyPasteShortcutDialog";no.yuh="CopyPasteText";Object(e.a)(no,"ACopyPasteShortcutDialog",null,[109]);class lI extends no{constructor(a,b,c){super(a,b);a=document.createElement("span");
a.className="WACCopyPasteShortcutDialogTextPanel";b=document.createElement("span");b.id=no.yuh;var f=document.createElement("span");f.innerText=this.j4f;var l=document.createElement("span");l.className="UIFontBold";l.innerText=this.V_(this.DFc,this.Rqe);const w=document.createElement("span");w.className="UIFontBold";w.innerText=this.V_(this.pEc,this.Qqe);const F=document.createElement("span");F.className="UIFontBold";F.innerText=this.V_(this.RGa,this.Sqe);b.appendChild(f);b.appendChild(document.createElement("br"));
b.appendChild(l);b.appendChild(w);b.appendChild(F);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(r.a.Gj||r.a.ag)&&(c=document.createElement("span"),c.className="UIFontBold",c.innerText=this.V_(this.uva,this.Tqe),b.appendChild(c));a.appendChild(b);this.lMd?(Z.ULS.sendTraceTag(8716420,307,50,null),c=document.createElement("span"),b=document.createElement("a"),b.href="#",b.innerText=this.kNf,ad.a.addHandler(b,"click",Object(C.a)(this,this.l0f,"extensionLinkHandler")),c.appendChild(b),l=this.yNa.indexOf("{0}"),
-1!==l&&(f=this.yNa.substring(l+3,this.yNa.length),l=document.createTextNode(this.yNa.substring(0,l)),f=document.createTextNode(f),c.insertBefore(l,b),c.appendChild(f)),a.appendChild(document.createElement("br")),a.appendChild(c)):Z.ULS.sendTraceTag(8716422,307,50,null);c=new hf.StandardDialog;c.vd=0;c.kg=no.id;c.Tw(this.titleText,null,0,Object(C.a)(this,this.pQj,"legacyCopyPasteShortcutDialogHandler"),a);c.D4(no.yuh)}}Object(e.a)(lI,"CopyPasteShortcutDialog",no,[]);class mI extends no{constructor(a,
b){super(a,b);b={};a=this.dyj;b.extensionStartText=this.oMi;b.extensionLink=null;b.extensionEndText=null;b.shortcutsMessageText=this.M5k;b.cutText=this.V_(this.DFc,this.Rqe);b.copyText=this.V_(this.pEc,this.Qqe);b.pasteText=this.V_(this.RGa,this.Sqe);4!==u.AFrameworkApplication.Ba.jb.vm&&(b.pasteTextOnly=this.V_(this.uva,this.Tqe));b={["id"]:"CopyPasteInstallDialog",["bodyControls"]:b};const c=new Th.a(!1,!1,!0);c.kg="CopyPasteInstallDialog";c.vd=0;c.Pe(1,this.cyj);c.hwa(1);c.qj(a,Object(C.a)(this,
this.PBe,"reactCopyPasteShortcutDialogHandler"),b)}get M5k(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get cyj(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get dyj(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get oMi(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}}Object(e.a)(mI,"ReactCopyPasteInstallDialog",no,[]);class nI extends no{constructor(a){super(a,null);this.Kyg="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";
var b={};a=this.wck;var c="";let f="";this.messageText&&(c=this.messageText.split(" {")[0],f=this.messageText.split("} ")[1]);b.startText=c;b.endText=f;b.cutText=this.oBi;b.copyText=this.iti;b.pasteText=this.urk;b.cutShortcutText=this.V_(this.pBi,this.s8j);b.copyShortcutText=this.V_(this.qti,this.r8j);b.pasteShortcutText=this.V_(this.Ark,this.u8j);b.imageSrc=qp.a.bK("NoClipboardAccessDialogImage.svg");b.imageAltText=this.xCa;b.primaryButtonLabel=this.pDb;this.Kyg&&(Z.ULS.sendTraceTag(527986756,307,
50,"Learn more link is available"),b.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.hSa,["onExecute"]:()=>{this.mQj()}});b={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:b};c=new Th.a(!1,!1,!0);c.vd=0;c.kg="CopyPasteNoClipboardAccessDialog";c.qj(a,Object(C.a)(this,this.PBe,"reactCopyPasteShortcutDialogHandler"),b)}get wck(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get hSa(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get xCa(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get pDb(){return CommonUIStrings.l_DialogOk}get oBi(){return CommonUIStrings.l_CutString}get pBi(){return CommonUIStrings.l_CutShortcut}get s8j(){return CommonUIStrings.l_CutShortcut_Mac}get iti(){return CommonUIStrings.l_CopyString}get qti(){return CommonUIStrings.l_CopyShortcut}get r8j(){return CommonUIStrings.l_CopyShortcut_Mac}get urk(){return CommonUIStrings.l_PasteString}get Ark(){return CommonUIStrings.l_PasteShortcut}get u8j(){return CommonUIStrings.l_PasteShortcut_Mac}mQj(){Z.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");id.a.Qm(this.Kyg,"_blank",void 0,"learnMoreLink")}}Object(e.a)(nI,"ReactCopyPasteNoClipboardAccessDialog",no,[]);class oI extends no{constructor(a,b,c){super(a,b);a={};a.forwardElementText=this.j4f;a.cutText=this.V_(this.DFc,this.Rqe);a.copyText=this.V_(this.pEc,this.Qqe);a.pasteText=this.V_(this.RGa,this.Sqe);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(r.a.Gj||r.a.ag)&&(a.pasteTextOnly=this.V_(this.uva,this.Tqe));this.lMd?(Z.ULS.sendTraceTag(40726914,307,50,
null),a.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.kNf,["onExecute"]:f=>{this.l0f(f)}},c=this.yNa.indexOf("{0}"),-1!==c&&(a.suggestionPrefixElement=this.yNa.substring(0,c),a.suggestionSuffixElement=this.yNa.substring(c+3,this.yNa.length))):Z.ULS.sendTraceTag(40726915,307,50,null);c={["id"]:no.id,["bodyControls"]:a};a=new Th.a(!1,!1,!0);a.vd=0;a.kg=no.id;a.qj(this.titleText,Object(C.a)(this,this.PBe,"reactCopyPasteShortcutDialogHandler"),c)}}Object(e.a)(oI,"ReactCopyPasteShortcutDialog",
no,[]);class sq{constructor(){this.doa=!!u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.QB}mpb(a,b,c=!1,f=!1){Z.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.doa,c));f?new nI(a):this.doa?c?new mI(a,b):new oI(a,b,u.AFrameworkApplication.fa):new lI(a,b,u.AFrameworkApplication.fa)}static get instance(){return sq.Ka||(sq.Ka=new sq)}}sq.Ka=null;Object(e.a)(sq,"CopyPasteShortcutDialogFactory",null,[447]);class pI{constructor(a,b,c,f,l,
w,F){this.H7e=this.sCd=!1;this.$Qb=a;this.Jf=b;this.oga=c;this.Kd=f;this.nd=l;this.kf=w;this.qd=F}get TL(){return this.$Qb}get bDa(){return this.H7e}set bDa(a){this.H7e=a;this.kf.yPc=a}iba(a){this.TL.iba(a);a||this.RIa(!0)}x3a(a){this.TL.x3a(a)}get tKi(){return this.TL.y4}get $Ji(){return this.TL.yx}prepareForPaste(a){this.bDa=!0;this.TL.prepareForPaste(a,!1,this.pOe)}tba(a,b){this.TL.tba(a,!1,b)}reset(){this.bDa=!1}paste(){var a=this.Jf.Jd;a&&this.Kd.vf(a.NH);var b=this.oga.UJ;if(!b.Jh||!b.editingView.Al)return null;
a=b.editingView;let c=this.nd.Ql();this.bDa=!0;b.xxa();b=null;try{a.Wwk(),b=c=this.TL.Q4a(this.pOe,c)}catch(f){Z.ULS.shipAssertTag(6305672,307,!1),this.a1b(!0)}this.bDa=!1;return b}copy(){var a=this.Jf.Jd;a&&this.Kd.vf(a.NH);a=this.oga.UJ;if(!a.Jh||1!==a.editingView.mode)return!1;this.bDa=!0;let b;try{this.TL.aIc(this.pOe),b=!0}catch(c){Z.ULS.shipAssertTag(6305673,307,r.a.ag),Z.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",r.a.ey),b=!1}this.bDa=
!1;return b?!0:!1}RIa(a){if(this.sCd)return!0;var b=this.oga.UJ;if(!b.Jh||!b.editingView.Al)return!1;const c=b.editingView;b=this.nd.Ql();this.bDa=!0;const f=new mg.a(b);let l=!1;try{l=this.TL.RIa(b,()=>{c.Hli()},()=>{c.PHa()})}catch(w){Z.ULS.shipAssertTag(6305674,307,!r.a.rj)}f.restore();this.bDa=!1;l?this.sCd=!0:(Z.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",r.a.ey),r.a.rj||this.a1b(a));return l}a1b(){this.sCd=!1;if(u.AFrameworkApplication.wacCopyPasteShortcutDialogIsEnabled)sq.instance.mpb(null,
null);else{const a=new hf.StandardDialog;a.vd=0;a.nO(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get pOe(){const a=this.nd.MBa();return a?a.yl:null}}Object(e.a)(pI,"SystemClipboard",null,[578]);class qC{constructor(a){this.Ohb=2147483647;this.JKb=null;this.tm=0;this.cIg=!0;this.Rdf=window.navigator.clipboard;this.Sdf=window.navigator.permissions;this.tR=a}getData(a,b){Z.ULS.sendTraceTag(538240020,307,50,"GetData: Started");try{if(this.JKb){var c=this.RXi(this.JKb,
a);c?this.JKb[0].getType(c).then(f=>{"image/png"===c?this.tR.FVb([f],l=>{this.Wue(l,b,c)}):f.text().then(l=>{l="text/html"===c?this.RQi(l):l;Z.ULS.sendTraceTag(528859362,307,50,"GetData: Retrieved data with type: {0} and size: {1}",c,l.length);b(a,l)}).catch(()=>{this.WV(!1,"getDataFailed");b(a,null)})}).catch(()=>{this.WV(!1,"getDataFailed");b(a,null)}):(this.WV(!1,"unSupportedType"),b(a,null))}else this.WV(!1,"invalidClipboardItems"),b(a,null)}catch(f){this.WV(!1,"getDataFailed"),b(a,null)}}RXi(a,
b){let c=null;a&&0<a.length&&(a=a[0].types,b?c=Array.contains(a,b)?b:null:Array.contains(a,"text/html")?c="text/html":Array.contains(a,"image/png")?c="image/png":Array.contains(a,"text/plain")&&(c="text/plain"));return c}Wue(a,b,c){a&&this.tR.gkc&&(a=String.format('<img src="{0}">',a));Z.ULS.sendTraceTag(528818690,307,50,"OnImageConverted: Retrieved data with type: {0} and size: {1}",c,a.length);b("image/png",a)}RQi(a){return this.trim(a,"\n")}trim(a,b){if(!a)return null;let c=0;for(;c<a.length&&
a.charAt(c)===b;)c++;let f=a.length-1;for(;f>c&&a.charAt(f)===b;)f--;return a.substr(c,f-c+1)}XQe(a,b,c){this.JKb=b;a(c)}Nkd(a){try{this.JKb=null,this.Rdf.read().then(b=>{let c;this.tm&&(c=Date.now()-this.tm,Z.ULS.sendTraceTag(526952409,307,50,"Time taken to read data: {0}",c));this.WV(!0,"none");this.XQe(a,b,!0)},()=>{this.WV(!1,"clipboardReadFailed");this.XQe(a,null,!1)}).catch(()=>{this.WV(!1,"clipboardReadFailed");this.XQe(a,null,!1)})}catch(b){this.WV(!1,"clipboardReadNotSupported"),a(!1)}}SLf(a,
b){this.cIg=a?!0:!1;if(this.Rdf)if(this.Sdf)try{this.Sdf.query({name:"clipboard-read"}).then(c=>{c?(c=c.state,"granted"===c?(this.tm=Date.now(),this.Nkd(b)):"prompt"===c&&a?this.Nkd(b):(this.WV(!1,"permissionDenied"),b(!1))):(this.WV(!1,"invalidPermissionStatus"),b(!1))},()=>{this.WV(!1,"permissionQueryFailed");a?this.Nkd(b):b(!1)}).catch(()=>{this.WV(!1,"permissionQueryFailed");b(!1)})}catch(c){this.WV(!1,"permissionQueryNotSupported"),b(!1)}else this.WV(!1,"navigatorPermissionNotSupported"),a&&
this.Nkd(b);else this.WV(!1,"navigatorClipboardNotSupported"),b(!1)}WV(a,b){const c={};c.AsyncAPISuccess=a.toString();c.IsPasteEvent=this.cIg;"none"!==b&&(c.AsyncAPIFailureReason=b);Z.ULS.sendTraceTag(522814493,307,50,JSON.stringify(c))}}Object(e.a)(qC,"AsyncClipboardAPI",null,[]);class hz{constructor(){this.pptObjectData=this.pptObjectMetaData=this.pptSlide=this.text=this.html=this.img=null;this.isImageAvailable=!1}}Object(e.a)(hz,"ExtensionClipboardData",null,[]);class qI{constructor(a,b,c,f){this.f1=
this.jz=this.Abf=this.Hna=null;this.lpc=a.ka("ChromeClipboardAccessExtensionSuggestionIsEnabled");a.ka("ChromeClipboardAccessRichFormatContentIsEnabled");a.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.$Kh=a.Ia("ChromeClipboardAccessExtensionLink");this.uKa=b;this.jk=c;this.JPh=a.Ia("ChromeClipboardAccessExtensionId");this.tR=f;this.L0=new qC(this.tR);this.XLb=null;this.N5e=l=>!!l.tagName&&"a"===l.tagName.toLowerCase()}iba(a){a?this.jz=!0:(this.f1=this.jz=null,chrome.runtime&&chrome.runtime.sendMessage?
(this.XLb=this.uKa.pLc(),this.uKa.rwa?this.HLf(!0,null):(this.jz=!0,Z.ULS.sendTraceTag(19256732,307,50,Fa.a.create().toString()))):this.L0?this.Bob(!0,null):(this.hye(),this.jz=!1))}x3a(a){this.f1=this.jz=null;chrome.runtime&&chrome.runtime.sendMessage?(this.XLb=this.uKa.pLc(),this.uKa.rwa?this.HLf(!1,a):(this.jz=!0,Z.ULS.sendTraceTag(19256732,307,50,Fa.a.create().toString()),a(this.y4))):this.L0?this.Bob(!1,a):(this.jz=!1,a(this.y4))}get y4(){return this.jz}get yx(){return this.f1}RIa(){return!0}aIc(a){Z.ULS.sendTraceTag(24402115,
307,50,"Execute chrome copy");id.a.P4a(a,"copy")||Z.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)))}Q4a(a,b){this.Hna&&(a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.Hna,b=a.body,this.Hna=null);return b}N7f(a,b){const c=Fa.a.create();this.Abf=c;this.uKa.rwa?Z.ULS.sendTraceTag(7377737,307,50,c.toString()):Z.ULS.sendTraceTag(19256735,307,50,c.toString());const f={};f.command=b;chrome.runtime&&
chrome.runtime.sendMessage?chrome.runtime.sendMessage(this.XLb,f,l=>{c.equals(this.Abf)?this.Hna=l:Z.ULS.sendTraceTag(7385868,307,50,null);Z.ULS.sendTraceTag(7377738,307,50,c.toString());chrome.runtime.lastError&&(this.oHi(),this.uKa.rwa?Z.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):Z.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));a(l)}):(Z.ULS.sendTraceTag(526951574,307,10,"ChromeApi.RuntimeSendMessage not supported"),a(null))}prepareForPaste(a,b){const c=
()=>{a(!1)},f=(l,w)=>{this.Hna=w;a(!0)};null!=this.yx&&this.yx?this.L0.getData(b?"image/png":null,f):this.N7f(c,"paste")}tba(a,b,c){a=(f,l)=>{const w=new hz;"image/png"==f?w.img=l:w.html=l;c(w)};null!=this.yx&&this.yx?this.L0.getData(b?"image/png":null,a):this.N7f(c,"getClipboardData")}hye(){Z.ULS.sendTraceTag(8716423,307,50,null);sq.instance.mpb(Object(C.a)(this,this.suk,"popupInstallDialogHandler"),this.lpc?this.$Kh+this.XLb:null)}suk(a){1===a?Z.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",
this.lpc)):0===a&&Z.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.lpc))}puk(){Z.ULS.sendTraceTag(527966608,307,50,null);sq.instance.mpb(Object(C.a)(this,this.quk,"popupClipboardAccessDialogHandler"),null,!1,!0)}quk(){Z.ULS.sendTraceTag(527966609,307,50,String.format("ClipboardAccessDialog OK Clicked",this.lpc))}oHi(){this.uKa.AEe();this.hye()}iih(a,b){const c={command:"test",object:"ping"};chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(a,c,b):(Z.ULS.sendTraceTag(526951575,
307,10,"ChromeApi.RuntimeSendMessage not supported"),b(null))}Bob(a,b){Z.ULS.sendTraceTag(538478226,307,50,"CheckAsyncClipboardApiSupport");this.L0.SLf(a,c=>{this.f1=c;this.jz=this.yx;a&&this.F9k();b&&b(this.y4)})}F9k(){null==this.yx||this.yx||this.puk()}HLf(a,b){const c=Fa.a.create();Z.ULS.sendTraceTag(7726105,307,50,c.toString());this.iih(this.XLb,f=>{Z.ULS.sendTraceTag(7726106,307,50,c.toString());f&&"ping"===f?this.jz=!0:(f?"ping"!==f&&Z.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",
f,chrome.runtime.lastError?chrome.runtime.lastError.message:null):Z.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.L0?this.Bob(a,b):(a&&this.hye(),this.jz=!1));b&&b(this.y4)})}fAg(a,b){const c={};c.OfficeOnlineExtensionInstallationStatus=a;c.OfficeClipboardExtensionInstallationStatus=b;Z.ULS.sendTraceTag(51144839,307,50,JSON.stringify(c))}GTj(){if(chrome.runtime&&chrome.runtime.sendMessage){var a=!this.uKa.rwa;
this.iih(this.JPh,b=>{this.fAg(a,!!b)})}else this.fAg(!1,!1)}}Object(e.a)(qI,"ChromeSystemClipboardAccessManager",null,[577]);class rI{constructor(a,b,c,f){this.f1=this.jz=this.zxc=this.Hna=this.L0=null;this.qd=a;this.mb=b;this.iWe=!this.mb.ka("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.mb.ka("BlockCopyCutOnFirefoxIsEnabled");this.tR=c;this.Zff=this.mb.ka("PasteAsOptionsEnabled");this.jk=f;this.Wwd=b.Gc("ClipboardDataImageBlobLimitaton",10);r.a.CNe||(this.L0=new qC(this.tR))}iba(a){this.iWe&&
a&&this.qd.ag?(sq.instance.mpb(null,null),this.jz=!1):(this.jz=!0,this.f1=!1,this.L0&&(this.f1=this.jz=null,this.Bob(!0,null)))}x3a(a){this.iWe&&this.qd.ag&&(this.jz=!1,a(this.y4));this.jz=!0;this.f1=!1;this.L0?(this.f1=this.jz=null,this.Bob(!1,a)):a(this.y4)}Bob(a,b){Z.ULS.sendTraceTag(537522710,307,50,"CheckAsyncClipboardApiSupport");this.L0.SLf(a,c=>{this.f1=c;this.jz=this.yx;a&&this.a9k();b&&b(this.y4)})}a9k(){null==this.yx||this.yx||this.ouk()}ouk(){sq.instance.mpb(null,null)}get y4(){return this.jz}get yx(){return this.f1}aIc(a){id.a.P4a(a,
"copy")}Q4a(a,b){if(this.Hna&&null!=this.yx&&this.yx)return a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.Hna,b=a.body,this.Hna=null,b;const c=Date.now(),f=id.a.P4a(a,"paste");this.Zff&&b&&""===b.innerHTML&&(this.NXi(a),b.innerHTML=this.zxc?this.zxc:"",this.zxc="");Z.ULS.sendTraceTag(526960448,307,50,"ExecutePasteCommand: time taken: {0}, result: {1}",Date.now()-c,f);return b}NXi(a){const b=c=>{if(c){c=c.clipboardData;const f=this.jk.HLc(c);this.zxc=f&&""!==f?f:this.jk.B_d(c)}};
window.addEventListener("paste",b,!1);id.a.P4a(a,"paste");window.removeEventListener("paste",b,!1)}prepareForPaste(a,b){const c=(f,l)=>{this.Hna=l;a(!0)};null!=this.yx&&this.yx?this.L0.getData(b?"image/png":null,c):a(!1)}tba(a,b,c){if(c)if(this.Zff){const f=(l,w)=>{const F=new hz;"image/png"==l?F.img=w:F.html=w;c(F)};null!=this.yx&&this.yx?this.L0.getData(null,f):r.a.CNe&&this.OXi(a,b,c)}else c(null);else Z.ULS.sendTraceTag(540553601,307,10,"GetClipboardData: null callback")}OXi(a,b,c){Z.ULS.sendTraceTag(524834396,
307,50,"GetClipboardDataViaExecCommand: called");a=a.contentWindow.document;ya.a.Vt(a.body);try{const f=l=>{const w=new hz;l=l.clipboardData;if(b){var F=null;({b2b:F}=this.jk.Gkd(l,this.Wwd,this.tR.qbc));F&&0<F.length&&(w.isImageAvailable=!0)}else F=this.jk.getData(l,"ppt/slides"),w.pptSlide=F,F&&""!==F||(l=(F=this.jk.HLc(l))&&""!==F?F:this.jk.B_d(l),w.html=l);c(w)};a.addEventListener("paste",f,!1);id.a.P4a(a,"paste");a.removeEventListener("paste",f,!1)}catch(f){Z.ULS.sendTraceTag(524834397,307,10,
"GetClipboardDataViaExecCommand: failed to extract the data using exec command with exception : {0}",f)}}RIa(a,b,c){if(this.qd.sS&&!this.mb.ka("ElectronClipboardAccessFix"))return this.jz=!1;b();c();a=this.Q4a(a.ownerDocument,a);b=a.innerHTML;a.innerHTML=xg.a.create().toString();c();a=this.Q4a(a.ownerDocument,a);a=b===a.innerHTML;this.L0?a&&(this.jz=!0):this.jz=a;return a}}Object(e.a)(rI,"DefaultSystemClipboardAccessManager",null,[577]);class sI{constructor(a,b,c,f){this.f1=this.jz=this.xU=this.Okb=
this.V5=this.Eya=this.opc=null;this.jk=b;this.tR=c;this.Wwd=a.Gc("ClipboardDataImageBlobLimitaton",10);this.uMh=a.ka("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.lJh=f;this.CTh=a.ka("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}iba(a){this.CTh&&a&&(this.jz=!0);this.f1=!1}x3a(a){a(!0)}get y4(){return this.jz}get yx(){return this.f1}aIc(a){a&&id.a.P4a(a,ra.a.copy)}Q4a(a,b){this.Eya&&(b=this.Eya,this.Eya=null);return b}tba(a,b,c){c?c(null):Z.ULS.sendTraceTag(540553600,307,10,"GetClipboardData null callback")}prepareForPaste(a,
b,c=null){if(a&&c){this.opc=a;this.Okb=c;$addHandler(this.Okb,ra.a.paste,Object(C.a)(this,this.ZYg,"onPasteEvent"));this.xU=this.V5=null;this.uMh&&this.lJh.lYb();if(this.Okd(this.Okb)){if(this.xU&&0<this.xU.length&&(!this.V5||this.jk.emd(this.V5))){this.tR.FVb(this.xU,Object(C.a)(this,this.Wue,"onImageConverted"));this.Eya&&!this.Eya.hasChildNodes()&&Z.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.V5&&this.V5.innerHTML&&((this.Eya=this.Ejg(this.V5.innerHTML))&&
!this.Eya.hasChildNodes()&&Z.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),ya.a.Vt(this.V5))}this.G2f()}else a&&a(!1)}RIa(a){return this.jz=a=this.Okd(a.ownerDocument)}ZYg(a){try{a&&a.rawEvent&&((this.V5=a.rawEvent.target)&&this.V5.id&&-1<this.V5.id.indexOf("Paste")?(Z.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.V5.id),this.V5=null):this.xU=this.D2i(a.rawEvent))}catch(b){Z.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+
b.toString())}}Wue(a){a&&(this.tR.gkc&&(a=String.format('<img src="{0}">',a)),this.Eya=this.Ejg(a));this.G2f()}G2f(){this.Okb&&($removeHandler(this.Okb,ra.a.paste,Object(C.a)(this,this.ZYg,"onPasteEvent")),this.Okb=null);this.opc&&(this.opc(!1),this.opc=null)}D2i(a){let b=null;(a=this.jk.CXd(a))&&({b2b:b}=this.jk.Gkd(a,this.Wwd,this.tR.qbc));return b}Okd(a){return id.a.P4a(a,ra.a.paste)}Ejg(a){const b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=a;return b.body}}Object(e.a)(sI,
"EdgeSystemClipboardAccessManager",null,[577]);class tI{constructor(a,b,c,f){this.mb=a;this.oHh=b;this.jk=c;this.qd=f}create(){var a=null;a=this.qd.sS&&this.mb.ka("ElectronClipboardAccessFix"),u.AFrameworkApplication.chd()&&this.qd.Gj&&window.chrome&&!a?(Z.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),a=new qI(this.mb,this.oHh,this.jk,lb.a.instance.resolve("Box4.IProcessImageStrategy")),this.mb.ka("LogChromeExtensionInstallationStatusIsEnabled")&&a.GTj()):this.mb.ka("EdgeContextMenuPasteFixIsEnabled")&&
this.qd.Xn?(Z.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),a=new sI(this.mb,lb.a.instance.resolve("Box4.IClipboardDataHelper"),lb.a.instance.resolve("Box4.IProcessImageStrategy"),lb.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(Z.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),a=new rI(this.qd,this.mb,lb.a.instance.resolve("Box4.IProcessImageStrategy"),this.jk));return a}}Object(e.a)(tI,"SystemClipboardAccessManagerFactory",
null,[576]);class uI{w_f(a){return a}}Object(e.a)(uI,"DeleteTableSegmentStrategy",null,[333]);var LP=d(1165),MP=d(624);class tq{constructor(a,b){this.Ik=new H.DictionaryPropertySet;this.Aud=!1;this.kga=this.Yfa=this.$Za=null;this.wU=a;this.sKh=b}get AYa(){return this.kga||(this.kga=lb.a.instance.qb("Box4.ITextFormattingCommands"))}get fh(){return tq.If||(tq.If=lb.a.instance.resolve("Box4.IFormattingEditor"))}UWa(){this.Aud||(this.Ik.TCe(),this.$Za=null,this.uLk())}pti(a){a=Ab.a.xs(a);if(!a.cache.As){var b=
a.rz;if(b){var c=new H.DictionaryPropertySet;c.px(b);c.px(this.Ik);c.Sa(ne.a.C1)&&(this.$Za=a.paragraph.Eh);this.Ik=c}}}Sa(a){return this.Ik.Sa(a)}w3d(){return 0<this.Ik.P0}get K7a(){return this.Ik}freeze(){this.Aud=!0}fPe(){this.Aud=!1}TH(a,b){return this.K7a.ta(a,b)}rr(a){this.Ik.setValue(ob.a.fontSize,this.fh.uVb(a));this.LQ()}fontSize(){return this.Ik.ta(ob.a.fontSize,od.Font.IH)}Afd(a){this.Ik.setValue(ob.a.font,a);this.sKh.Afd(this.Ik,a);this.wU&&this.wU.enabled&&(Ee.c(40506690,306,50,"InsertionPointFomatting: Set font slot values"),
this.wU.mBl(this.Ik,a));this.LQ()}jIa(a){this.Ik.setValue(Sb.a.bU,a);this.wU&&this.wU.enabled&&(Ee.c(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.wU.qBl(this.Ik,a));this.LQ()}Ms(a){a=MP.a.instance.CMd(dd.a.instance.Pa.kb.Wa.node,a);this.Ik.setValue(ob.a.fontColor,a);this.LQ()}YU(){this.Ik.setValue(ob.a.fontColor,Jb.a.auto);this.LQ()}fontColor(){return this.Ik.ta(ob.a.fontColor,Jb.a.nil)}Hma(a){this.Ik.setValue(ob.a.highlight,parseInt(a,16));this.LQ()}KUb(){this.Ik.setValue(ob.a.highlight,
Jb.a.auto);this.LQ()}isBold(){return this.Ik.ta(ob.a.bold,!1)}cJ(a){this.Ik.setValue(ob.a.bold,a);this.LQ()}isItalic(){return this.Ik.ta(ob.a.italic,!1)}setItalic(a){this.Ik.setValue(ob.a.italic,a);this.LQ()}mD(){return this.Ik.ta(ob.a.underline,!1)}e0(a){this.Ik.setValue(ob.a.underline,a);this.Ik.setValue(ob.a.kw,a?od.Font.gld:od.Font.fU);this.LQ()}kw(){return this.Ik.ta(ob.a.kw,od.Font.fU)}Lma(a){a<od.Font.gld||a>od.Font.fU||(this.Ik.setValue(ob.a.underline,a!==od.Font.fU),this.Ik.setValue(ob.a.kw,
a),this.LQ())}isSuperscript(){return this.Ik.ta(ob.a.superscript,!1)}wX(a){this.Ik.setValue(ob.a.superscript,a);a&&this.isSuperscript()&&this.Ik.setValue(ob.a.subscript,!1);this.LQ()}ZE(){return this.Ik.ta(ob.a.subscript,!1)}G4(a){this.Ik.setValue(ob.a.subscript,a);a&&this.ZE()&&this.Ik.setValue(ob.a.superscript,!1);this.LQ()}YE(){return this.Ik.ta(ob.a.strikethrough,!1)}uX(a){this.Ik.setValue(ob.a.strikethrough,a);this.LQ()}pZ(){return this.Ik.ta(ne.a.rs,!1)}ffb(a){this.Ik.setValue(ne.a.rs,a);this.LQ()}J6f(){return this.Ik.ta(ne.a.C1,
null)}nea(a,b){this.Ik.TCe();this.Ik.setValue(ne.a.C1,a.id);this.$Za=b.Eh;this.LQ()}KT(a){let b=ob.a.Cs;if(I.a.instance.ga(13)){const c=LP.a.n5b(a);switch(c){case 1:b=Sb.a.Avb;break;case 2:b=Sb.a.Bvb}this.Ik.setValue(Sb.a.languageHint,c)}this.Ik.setValue(b,a);this.LQ()}language(){let a=ob.a.Cs;if(I.a.instance.ga(13))switch(this.Ik.ta(Sb.a.languageHint,0)){case 1:a=Sb.a.Avb;break;case 2:a=Sb.a.Bvb}return this.Ik.ta(a,0)}Y0k(a){this.Ik.setValue(tq.Mse,a);this.LQ()}DRa(){return this.Ik.ta(tq.Mse,!1)}iHj(){return this.Ik.Sa(tq.Mse)}ZFj(){return I.a.instance.ga(13)?
this.Ik.Sa(ob.a.Cs)||this.Ik.Sa(Sb.a.Avb)||this.Ik.Sa(Sb.a.Bvb):this.Ik.Sa(ob.a.Cs)}LQ(){if(r.a.AHb){var a=dd.a.instance.Pa.kb.Wa,b=a.node;if(b===this.Yfa)this.Yfa.Su(16,!0);else{this.Yfa=b;b=this.Yfa.uYa();try{this.Yfa.qqb(a.Qa).M2=!0}finally{b&&b.dispose()}}}}uLk(){if(r.a.AHb&&this.Yfa){var a=0,b=this.Yfa.uYa();try{for(let c=this.Yfa.Ra.length-1;0<=c;c--){const f=this.Yfa.Ra.ga(c);f.M2&&(f.M2=!1,a++,f.isEmpty&&this.Yfa.Ra.removeAt(c))}}finally{b&&b.dispose()}this.Yfa=null}}Yri(a){if(a.Qa!==a.Lb)return!1;
a=a.node.Ra.fS(a.Qa);return!!a&&a.M2}R7h(a){if(this.AYa){this.freeze();var b=new Oe.GraphTransaction(7);b.hd(a.node);this.AYa.JFb(a);this.fPe();this.UWa();b.dispose()}}W_b(a){const b=db.ParagraphReader.text(a.node);return a.Qa&&a.Qa!==b.length&&!Ja.a.vy(b.charCodeAt(a.Qa))&&Qo.a.instance.ALc(b,a.Qa-1)!==a.Qa&&Cb.SelectionEditor.bvb(a)?(a=Cb.SelectionEditor.TOa(a,!1))?1<a.length||Cb.SelectionEditor.Oj(a.Wa)?a:null:null:null}static get Mse(){return I.a.instance.ga(20)?Sb.a.noProof:Kd.a.Mua}}tq.If=null;
Object(e.a)(tq,"InsertionPointFormatting",null,[321]);class vI{constructor(a){this.Da=a}get Ho(){return this.Da}numbering(a,b,c){const f=new H.DictionaryPropertySet;f.setValue(Kd.a.aF,a);f.setValue(Kd.a.mja,b);f.setValue(Kd.a.oSa,c);return 32===this.Ho.Ma(D.a.UQ,2,f)}}Object(e.a)(vI,"ListCommands",null,[589]);class rC{constructor(a){this.ef=a}u3a(a){a=Object(ua.a)(gC.a,a);return!!a&&!!a.view&&a.view.Jh}Y5g(){return!0}Cze(){return!0}Z5g(){}Nqh(a){if(a.Fq)return!0;a=a.role;return 1===a||2===a||3===
a||4===a||5===a}r8i(a){if(!a||!this.ef)return a;const b=new zn.a;b.set(a);if(this.ef.Rs(b)){for(;!b.Fq;)b.yc();return b.currentNode}return a}}Object(e.a)(rC,"SimpleProofingWholeDocumentCallBacks",null,[792]);class wI{constructor(a){this.value=a}}Object(e.a)(wI,"RefBool",null,[]);class iz{constructor(){this.VHc=this.pBb=null;this.qyh=new wI(!1)}}Object(e.a)(iz,"FindNextErrorOperationParam",null,[]);class xI extends rC{constructor(a,b){super(b);this.im=a}Y5g(a,b){return!this.Qbe(a.node,a.Qa,b)}Cze(a,
b){return!this.Qbe(a,0,b)}Z5g(a,b){this.Qbe(a.node,0,b);Object(ua.a)(iz,b)}Qbe(a,b,c){c=Object(ua.a)(iz,c);if(db.ParagraphReader.Pd(a)&&!a.AV)if(Ab.a.xs(Fc.a.Wj(a,b)).cache.DRa)c.qyh.value=!0;else{const f=u.AFrameworkApplication.fa.ka("SkipIgnoredProofingErrorsFromRibbon"),l=this.im.ME(a);for(let w=0;w<l.length;w++){const F=l[w],S=f&&F.Gh.O8d();if(F.begin>=b&&!S)return c.pBb=F,c.VHc=a,!0}}return!1}}Object(e.a)(xI,"FindNextErrorCallbackSteps",rC,[]);class yI extends Es.a{constructor(a,b,c,f,l,w,F,
S,fa,xa,Za){super();this.Vkb=this.Fi=this.Sxa=null;this.init(a);this.vl(Za);this.ACa(S,b,f,l,w);this.hU=w;this.yu=c;this.Rc=fa;this.ef=xa;this.xoa=F;this.vH=0}run(){this.u3a();0===this.vH&&this.qJe();1===this.vH&&this.Mze();2===this.vH&&this.vOe();3===this.vH&&this.pVd()}u3a(){this.Rc.Pa&&this.Rc.Pa.kb?1===this.behavior&&(this.xoa.u3a(this.yu)?this.Zo=32:this.Zo=2,this.vH=3):(Z.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.Zo=2,this.vH=3)}qJe(){this.jdi();this.Hci();this.vH=
1}Mze(){this.nz||new Tb.a(this,Object(C.a)(this,this.nyk,"processCurrentNodeAtBegin"),this.hU);do if(this.nz.run(),this.nz.inProgress&&!this.Ui)return;while(this.nz.inProgress);this.OCc();this.vH=2}vOe(){this.Zo=32;this.vH=3}pVd(){this.sX()}nyk(a,b){b=this.xoa.Y5g(this.Sxa,b);a.Wg(Object(C.a)(this,this.nTi,"fromHereToEnd"));return b}nTi(a,b){if(this.Fi.moveNext())return a=this.Fi.currentNode,12!==a.type||a===this.Sxa.node?!0:this.xoa.Cze(a,b);this.Bdi();a.Wg(Object(C.a)(this,this.xTi,"fromStartToHere"));
return!0}xTi(a,b){if(this.Fi.moveNext()){const c=this.Fi.currentNode;return 12!==c.type?!0:c===this.Sxa.node?(a.Wg(Object(C.a)(this,this.oyk,"processCurrentNodeAtEnd")),!0):this.xoa.Cze(c,b)}return!1}oyk(a,b){this.xoa.Z5g(this.Sxa,b);return!1}jdi(){let a=this.Rc.Pa.kb;if(a=this.ef.xl(a,!0,!1))this.Sxa=a.Wa;this.Sxa&&this.Sxa.node&&(this.Vkb=this.xoa.r8i(this.Sxa.node))}Hci(){if(!this.Vkb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new zn.a;a.set(this.Sxa.node);a.oc(this.Vkb.type);
this.Fi=hx.a.N1(a,this.Vkb);this.Fi.Il(Object(C.a)(this.xoa,this.xoa.Nqh,"spellErrorFilter"),null)}Bdi(){if(!this.Vkb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new zn.a;a.set(this.Vkb);this.Fi=hx.a.Gu(a);this.Fi.Il(Object(C.a)(this.xoa,this.xoa.Nqh,"spellErrorFilter"),null)}}Object(e.a)(yI,"ProofingWholeDocumentOperation",Es.a,[]);class sC{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc){this.Da=b;this.im=a;this.ONh=c;this.Vg=f;this.kk=l;this.Rc=w;this.jm=F;this.ef=S;this.r1a=
fa;this.KC=xa;this.ld=Za;this.Msc=Mb.W9d;this.Upf=hc;this.zO=kc;this.loc=new dc.a;this.loc.$(1,D.a.Oqh);this.loc.$(2,D.a.Bfg);this.loc.$(3,D.a.bsh);this.Mvc=new dc.a;this.Mvc.$(1,D.a.Pqh);this.Mvc.$(2,D.a.Cfg);this.Mvc.$(3,D.a.csh)}wb(){const a=this.Da,b=Object(C.a)(this,this.Ati,"correctError"),c=Object(C.a)(this,this.hni,"collapseIp");a.ra(D.a.Snk,Db.a.view,Object(C.a)(this,this.Tnk,"openLanguageDialogView"),1028);a.ya(D.a.lOa,Db.a.Ff,Object(C.a)(this,this.lOa,"deleteRepeatedWord"));a.ya(D.a.Mra,
Db.a.Ff,Object(C.a)(this,this.Mra,"ignoreSpellingError"));a.ya(D.a.Vwa,Db.a.Ff,b);a.ya(D.a.Wwa,Db.a.Ff,b);a.ya(D.a.Xwa,Db.a.Ff,b);a.ya(D.a.MIa,Db.a.Ff,b);a.ya(D.a.NIa,Db.a.Ff,b);a.ya(D.a.lOa,Db.a.view,c);a.ya(D.a.Mra,Db.a.view,c);a.ya(D.a.Vwa,Db.a.view,c);a.ya(D.a.Wwa,Db.a.view,c);a.ya(D.a.Xwa,Db.a.view,c);a.ya(D.a.MIa,Db.a.view,c);a.ya(D.a.NIa,Db.a.view,c);a.$d(D.a.lOa,1028);a.$d(D.a.Mra,1028);a.$d(D.a.Vwa,1028);a.$d(D.a.Wwa,1028);a.$d(D.a.Xwa,1028);a.$d(D.a.MIa,1028);a.$d(D.a.NIa,1028);a.ya(D.a.jjd,
de.a.frame,Le.ActionManager.Dg);this.Msc&&a.ra(D.a.fye,Db.a.view,Object(C.a)(this,this.fye,"populateProofingSecondaryMenu"),1124);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||a.ra(D.a.H5c,Db.a.view,Object(C.a)(this,this.QPi,"findNextProofingError"),1028);this.fJk([D.a.bdl,D.a.Oqh,D.a.Pqh,D.a.Kgj,D.a.Bfg,D.a.Cfg,D.a.ofl,D.a.bsh,D.a.csh])}fJk(a){for(let b=0;b<a.length;b++)this.Da.ra(a[b],Db.a.view,Le.ActionManager.Ju,1028)}hni(a,
b,c,f,l){b=this.Rc.Pa.kb;if(!b)return this.ld.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),2;b=this.ef.xl(b,!0,!1);return this.Da.li(b.Wa,a,c,!1,f,l)}Tnk(a,b,c){if(1===c)return this.Da.processAction(D.a.KT,1);this.ONh().skc();return 32}RQe(a){return a?a.Gh?!1:(Z.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.ld.Vb(zd.a.d5a,{["Reason"]:"ErrorRangeMissingErrorDetails"}),Me.a.mark(4671),!0):(Z.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),
this.ld.Vb(zd.a.d5a,{["Reason"]:"RequestedErrorRangeNotFound"}),Me.a.mark(4671),!0)}lOa(a,b,c){if(1===c)return 32;Me.a.mark(4670);c=this.im.IPa(b);if(this.RQe(c))return 8;b=b.node;const f=this.kk.ie(15);let l=c.begin;" "===db.ParagraphReader.text(b).charAt(l-1)&&l--;f.hd(b);const w=this.Vg.replaceTextRange(Fc.a.createTextRange(b,0<c.begin?c.begin-1:0,c.end),"",!0,!1);this.Rc.setSelection(fd.SelectionFactory.Lg(b,w+l));f.dispose();c.Gh.eJa(a);Me.a.mark(4671);return 32}hVj(a){let b;({value:b}=this.Mvc.Nf(a.Gh.proofingType,
0)).returnValue&&this.Da.processAction(b,2)}Mra(a,b,c){if(1===c)return 32;Z.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");Me.a.mark(4670);c=this.im.IPa(b);if(this.RQe(c))return 8;b=b.node;const f=this.kk.ie(15);f.hd(b);this.im.vHa(b,[c],!0);b.setValue(ob.a.kPf,!0);f.dispose();c.Gh.eJa(a,1);Me.a.mark(4671);Z.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.hVj(c);return 32}kZi(a){switch(a){case D.a.Vwa:return 0;case D.a.Wwa:return 1;case D.a.Xwa:return 2;
case D.a.MIa:return 3;case D.a.NIa:return 4;default:return-1}}HSj(a){let b;({value:b}=this.loc.Nf(a.Gh.proofingType,0)).returnValue&&this.Da.processAction(b,2)}Ati(a,b,c){var f=!0;this.zO.ga(14)&&(f=!this.KC.hsa(b));this.jm&&this.jm.instance&&this.jm.instance.EV(b)&&(f=!1);if(1===c||!f)return f?32:8;this.Da.processAction(D.a.jjd,2);Me.a.mark(4670);f=this.kZi(a);if(0>f)return 8;c=this.im.IPa(b);if(this.RQe(c))return 8;b=b.node;var l=c.Gh.suggestions;if(!l)return this.ld.Vb(zd.a.d5a,{["Reason"]:"NoSuggestionsFound"}),
Me.a.mark(4671),8;f=f<l.length?l[f]:null;if(!f)return this.ld.Vb(zd.a.d5a,{["Reason"]:"RequestedSuggestionIsNull"}),Me.a.mark(4671),8;this.zO.ga(50)&&gb.App.Hh.Nv&&gb.App.Hh.JX.fpa(b);f=f.replace("  "," \u00a0");l=this.kk.ie(15);l.hd(b);const w=this.Vg.replaceTextRange(Fc.a.createTextRange(b,c.begin,c.end),f,!0,!1,D.a.jjd);this.Rc.setSelection(fd.SelectionFactory.Lg(b,c.begin+f.length+w));l.dispose();c.Gh.eJa(a);Me.a.mark(4671);this.HSj(c);return 32}VVk(a,b,c,f){a.awa();(a=c.pc(a.Na))?(f=N.a.it(a,
u.AFrameworkApplication.isRtl?f.begin:f.end),this.r1a.Y9(new Sys.UI.Point(f.x,f.y+f.height),b)):Z.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}QPi(a,b,c,f,l){if(!b.view.Jh)return 2;const w=b.view;if(!this.Rc.Pa.kb)return this.ld.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),2;if(1===c)return 32;const F=new iz,S=new xI(this.im,this.ef);b=new yI(null,a,b,c,f,F,S,this.Da,this.Rc,this.ef,null);b.Ui=!0;b.run();if(b.isCompleted&&F.pBb){if(b=fd.SelectionFactory.Lg(F.VHc,F.pBb.begin),
b=fd.SelectionFactory.SM(b,Fc.a.Wj(F.VHc,F.pBb.end)),!this.Upf.instance||!this.Upf.instance.LAl(F.pBb,b,w)){this.Rc.setSelection(b);let fa=0;l&&(fa=l.Ru);w.Tgd=!1;Im.a.instance.Hb(new Se.a(1,1,1,()=>{this.VVk(w,fa,F.VHc,F.pBb)}))}}else{const fa=new hf.StandardDialog;fa.vd=0;gb.App.SQ.M$d?fa.Wfb(CommonUIStrings.l_DefaultDialogTitle,F.qyh.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(fa.Wfb(CommonUIStrings.l_DefaultDialogTitle,
Box4Intl.Box4Strings.l_ProofingInProgress,null),gb.App.SQ.w_h(()=>{fa.QV&&(fa.hide(),this.Da.processAction(a,2))}))}return 32}fye(){return 32}}Object(e.a)(sC,"ProofingActor",null,[]);var zI=d(702),NP=d(1055);class Zg{static bgj(){Zg.SL||(Zg.SL=Array(Zg.sfl),Zg.SL[0]=ob.a.fontColor,Zg.SL[1]=ne.a.MQ,Zg.SL[2]=ob.a.Cs,Zg.SL[3]=ob.a.underline,Zg.SL[4]=ob.a.kw,Zg.SL[5]=ne.a.rs,Zg.SL[6]=ob.a.font,Zg.SL[7]=ob.a.fontSize,Zg.SL[8]=ob.a.superscript,Zg.SL[9]=ob.a.subscript,Zg.SL[10]=ob.a.zn,Zg.SL[11]=Sb.a.noProof,
Zg.SL[12]=Kd.a.Mua,Zg.SL[13]=ne.a.capitalization,Zg.SL[14]=ob.a.bold,Zg.SL[15]=ob.a.italic,Zg.SL[16]=ob.a.underline);return Zg.SL}static $fj(){Zg.jC||(Zg.jC=Array(Zg.Cpk),Zg.jC[0]=Sb.a.Jn,Zg.jC[1]=Sb.a.NGa,Zg.jC[2]=Sb.a.Hl,Zg.jC[3]=Sb.a.ova,Zg.jC[4]=Sb.a.dX,Zg.jC[5]=Sb.a.bdb,Zg.jC[6]=Sb.a.tCb,Zg.jC[7]=Sb.a.adb,Zg.jC[8]=ne.a.DCb,Zg.jC[9]=ne.a.CCb,Zg.jC[10]=Sb.a.zCb,Zg.jC[11]=Sb.a.wCb,Zg.jC[12]=Sb.a.kSa,Zg.jC[13]=Sb.a.Iw,Zg.jC[14]=Sb.a.edb,Zg.jC[15]=Sb.a.ddb,Zg.jC[16]=Sb.a.Udc,Zg.jC[17]=Sb.a.Tdc,Zg.jC[18]=
ob.a.pl,Zg.jC[19]=ob.a.qI,Zg.jC[20]=ne.a.Hbd,Zg.jC[21]=ob.a.bX);return Zg.jC}}Zg.sfl=17;Zg.Cpk=22;Zg.SL=null;Zg.jC=null;Object(e.a)(Zg,"StyleConstants",null,[]);class Xq{static get Ezk(){return Xq.BO||(Xq.BO=new NP.a)}static q$d(a,b){if(!a||!a.node||!b)return!1;const c=Ab.a.xs(a);if(Xq.Gsg(c?c.rz:null,b,Zg.bgj()))return Z.ULS.sendTraceTag(51218398,324,50,"Difference in formatting attributes b/w text selection and style"),!0;a=a.node.Z6();return Xq.Gsg(a,b,Zg.$fj())?(Z.ULS.sendTraceTag(51218399,324,
50,"Difference in paragraph attributes b/w text selection and style"),!0):!1}static Gsg(a,b,c){let f=!1;if(a)for(const l of c)f=(a.Sa(l)?b.Sa(l)?!Xq.Ezk.compare(a,b,l):!0:!1)||f;return f}}Xq.BO=null;Object(e.a)(Xq,"StyleUtils",null,[]);class tC{constructor(a,b,c,f,l,w,F,S,fa,xa){this.f0a=this.sHb=null;this.Vg=a;this.PJ=b;this.QJ=c;this.If=f;this.lfa=l;this.Vs=w;this.KC=F;this.ld=S;this.oMa=fa;this.IWh=xa}get characterPropertiesEditor(){return this.Vg}get qO(){return this.PJ}get R4(){return this.QJ}get Ml(){return this.lfa}get insertionPointFormatting(){return this.Vs}get fh(){return this.If}get Vi(){return this.KC}get Uc(){return this.ld}get SOe(){return this.oMa}get Hnc(){return this.IWh}get pRa(){null==
this.f0a&&(u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),this.f0a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HighlightStyleWhenDifferentFromSelectionIsEnabled"):!1);return this.f0a}wb(){const a=u.AFrameworkApplication.Va,b=gb.App.VIa.GEc(12);I.a.instance.ga(61)&&(a.ya(D.a.P2a,Db.a.textRange,Object(C.a)(this,this.k8h,"applyStyleToTextRange")),a.ya(D.a.ygc,Db.a.textRange,Object(C.a)(this,this.VAk,"queryStyleTextRange")),
a.ya(D.a.P2a,Db.a.Ff,Object(C.a)(this,this.i8h,"applyStyleToIp")),a.ya(D.a.ygc,Db.a.Ff,Object(C.a)(this,this.TAk,"queryStyleIp")));a.ya(D.a.P2a,Db.a.paragraph,Object(C.a)(this,this.j8h,"applyStyleToParagraph"));a.ya(D.a.P2a,Db.a.view,Object(C.a)(this,this.l8h,"applyStyleView"));a.$d(D.a.P2a,1036);a.ya(D.a.ygc,Db.a.view,Object(C.a)(this,this.WAk,"queryStyleView"));a.ya(D.a.ygc,Db.a.paragraph,Object(C.a)(this,this.UAk,"queryStyleParagraph"));a.$d(D.a.ygc,99|(I.a.instance.ga(7)?0:4));a.ya(D.a.Eec,Db.a.view,
b);a.ya(D.a.Eec,Db.a.paragraph,Object(C.a)(this,this.Eec,"populateMenuMoreStyles"));a.$d(D.a.Eec,1127);a.ra(D.a.VHd,Db.a.view,Object(C.a)(this,this.wpa,"applyStyleShortcut"),4);a.ra(D.a.WHd,Db.a.view,Object(C.a)(this,this.wpa,"applyStyleShortcut"),4);a.ra(D.a.XHd,Db.a.view,Object(C.a)(this,this.wpa,"applyStyleShortcut"),4);a.ra(D.a.YHd,Db.a.view,Object(C.a)(this,this.wpa,"applyStyleShortcut"),4);a.ra(D.a.ZHd,Db.a.view,Object(C.a)(this,this.wpa,"applyStyleShortcut"),4);a.ra(D.a.$Hd,Db.a.view,Object(C.a)(this,
this.wpa,"applyStyleShortcut"),4);a.ra(D.a.aId,Db.a.view,Object(C.a)(this,this.wpa,"applyStyleShortcut"),4);a.ra(D.a.mFf,Db.a.view,Object(C.a)(this,this.wpa,"applyStyleShortcut"),4);a.ra(D.a.nFf,Db.a.view,Object(C.a)(this,this.wpa,"applyStyleShortcut"),4);a.ra(D.a.oFf,Db.a.view,Object(C.a)(this,this.wpa,"applyStyleShortcut"),4);this.sHb=Array(10);this.R4.JIe(this.sHb)}Ybj(a){switch(a){case D.a.VHd:return 0;case D.a.WHd:return 1;case D.a.XHd:return 2;case D.a.YHd:return 3;case D.a.ZHd:return 4;case D.a.$Hd:return 5;
case D.a.aId:return 6;case D.a.mFf:return 7;case D.a.nFf:return 8;case D.a.oFf:return 9;default:return-1}}wpa(a,b,c,f){a=this.Ybj(a);return 0>a||a>this.sHb.length?2:(a=this.sHb[a])?u.AFrameworkApplication.Va.li(b,D.a.P2a,c,!0,f,a):2}Eec(a,b,c,f,l){a=!0;b.contextId!==Db.a.paragraph&&b.contextId!==Db.a.textRange&&b.contextId!==Db.a.Ff&&(a=!1);if(1===c||!a)return a?32:8;if(2===c&&!l)return 8;b=this.R4.rK(b.node);c=I.a.instance.ga(61);u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.Ip&&(l.MenuItems=
zI.StylePreviewGenerator.Z$f(b,c));l.PopulationXML=zI.StylePreviewGenerator.DUi(b,c);return 32}UAk(a,b,c,f,l){a=!0;b.contextId!==Db.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;a=this.R4.iD(c);if(!a||!l)return Z.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",l,c,a),8;l.oNe.px(a);this.pRa&&(l.L8d=Xq.q$d(b,a));return 32}j8h(a,b,c,f,l){if(b.contextId!==Db.a.paragraph)return 8;if(I.a.instance.ga(14)&&this.Vi.mDa(b))return this.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),
8;if(1===c)return 32;a=b.node;if(!l)return 8;b=this.T0d(l,a);if(!b)return this.Uc.Vb(zd.a.v0,{["Reason"]:Hd.a.FYb}),8;if(2!==this.R4.yra(b))return 2;c=new Oe.GraphTransaction(15);c.hd(a);this.insertionPointFormatting.UWa();this.qO.V9(b,a,!1);c.dispose();l=Ja.a.BM(l);f.qP=l>>>16^l&65535;return 32}VAk(a,b,c,f,l){a=!0;b.contextId!==Db.a.textRange&&(a=!1);if(1===c&&!a)return 2;c=b.node;a=Ab.a.xs(b);a=Ab.a.yrb(a);if(this.pRa){if(!l||!c)return Z.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",
l,c),8;a=a||this.R4.iD(c);if(!a)return Z.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;l.L8d=Xq.q$d(b,a)}else{if(!a)return 2;if(!l)return 8}l.oNe.px(a);return 32}k8h(a,b,c,f,l){if(b.contextId!==Db.a.textRange||!I.a.instance.ga(61))return 8;if(this.Vi.mDa(b))return this.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),8;if(1===c)return 32;a=b.node;if(!l)return 8;const w=this.T0d(l,b.node);if(!w)return this.Uc.Vb(zd.a.v0,{["Reason"]:Hd.a.FYb}),8;if(1!==this.R4.yra(w))return 2;
c=this.R4.rK(a);if(!c)return this.Uc.Vb(zd.a.v0,{["Reason"]:Hd.a.e1f}),8;if(!c.mG(this.R4.BP(w)))return this.Uc.Vb(zd.a.v0,{["Reason"]:Hd.a.FYb}),8;const F=new Oe.GraphTransaction(7);try{F.hd(a),this.qO.gnc(a,c),this.SOe.yAc(b,S=>{this.fh.Zza(S);this.fh.nea(S,w)})}finally{F&&F.dispose()}b=Ja.a.BM(l);f.qP=b>>>16^b&65535;return 32}TAk(a,b,c,f,l){a=!0;b.contextId!==Db.a.Ff&&(a=!1);if(1===c&&!a)return 2;c=this.qO.Q0d(b);a=b.node;if(this.pRa){if(!l||!a)return Z.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",
l,a),8;c=c||this.R4.iD(a);if(!c)return Z.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;l.L8d=Xq.q$d(b,c)}else{if(!c)return 2;if(!l)return 8}l.oNe.px(c);return 32}i8h(a,b,c,f,l){if(b.contextId!==Db.a.Ff||!I.a.instance.ga(61))return 8;if(this.Vi.mDa(b))return this.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),8;if(1===c)return 32;c=b.node;if(!l)return 8;const w=this.T0d(l,b.node);if(!w)return this.Uc.Vb(zd.a.v0,{["Reason"]:Hd.a.FYb}),8;const F=this.R4.yra(w);if(1!==F&&2!==
F)return 2;(b=this.insertionPointFormatting.W_b(b))?(c=dd.a.QNa(b),a=u.AFrameworkApplication.Va.li(c,a,2,!1,f,l)):(a=new Oe.GraphTransaction(7),a.hd(c),this.qO.KIe(w,c),a.dispose(),a=32);l=Ja.a.BM(l);f.qP=l>>>16^l&65535;return a}WAk(a,b,c,f,l){if(I.a.instance.ga(61)){const w=this.Hnc.m4(a,b,c,f,l,null,0);if(2!==w)return w}return this.Hnc.m4(a,b,c,f,l,null,12)}l8h(a,b,c,f,l){const w={};w[this.Hnc.rna]=6168;w[this.Hnc.qna]=6169;let F=12;if(I.a.instance.ga(61)){if(!b.view.Jh)return 2;var S=b.view.Eb,
fa=S?S.Dj:null;if(!fa)return this.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),8;if(I.a.instance.ga(11)&&this.Ml.Vpa(cb.ImageReader.Vtb,fa))return this.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.xVb}),8;if(I.a.instance.ga(14)&&this.Vi.lRc(fa))return this.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.aD}),8;fa=this.R4.Csb();if(l&&fa){var xa=fa.mG(l);xa&&(fa=this.R4.xZd(xa,fa),xa=this.R4.yra(xa),fa&&(S=S.Pa.ga(0),S.Paa&&S.Wa.contextId===Db.a.textRange||2===S.length&&S.Wa.contextId===Db.a.textRange&&S.We.contextId===Db.a.endOfParagraph)&&
(xa=1,l=fa.getValue(ne.a.ECb)),1===xa?F=0:3===xa&&(F=14))}}return this.Hnc.m4(a,b,c,f,l,w,F)}T0d(a,b){if(a&&b&&db.ParagraphReader.Pd(b))b=this.R4.rK(b);else return null;return b.mG(a)}}Object(e.a)(tC,"StyleActor",null,[]);const AI=a=>a.contextId===Db.a.DVd;class rg{static get Ml(){return xi.ContextSetEditor.instance}static get Vi(){return Rf.a.instance}static get Uc(){return cd.a.instance}static get pe(){return rg.$c||(rg.$c=lb.a.instance.resolve("Box4.IFeatureHelper"))}static Eq(){return rg.jm||
(rg.jm=lb.a.instance.Oa("Box4.IExternalSelectionManager"))}static get vL(){return rg.SF||(rg.SF=lb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static b4b(a){return u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===D.a.dHa||a===D.a.$Wa||a===D.a.p4||a===D.a.KHa)}static n6(a,b,c,f,l){var w=!0;if(!b.view.Jh)return 2;var F=b.view,S=F.Eb;S&&S.Pa.kb||(rg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),w=!1);if(I.a.instance.ga(11)&&(rg.Ml.Vpa(cb.ImageReader.x3b,F.Eb.Dj)&&(rg.Uc.Vb(zd.a.qh,
{["Reason"]:Hd.a.qNd}),w=!1),rg.Ml.Vpa(cb.ImageReader.Vtb,F.Eb.Dj)))return rg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.xVb}),8;I.a.instance.ga(14)&&rg.Vi.lRc(F.Eb.Dj)&&(rg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.aD}),w=!1);rg.Ml.Vpa(cb.ImageReader.x8d,F.Eb.Dj)&&(rg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.fPf}),w=!1);rg.Ml.Vpa(St.c,F.Eb.Dj)&&(rg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.gPf}),w=!1);rg.Ml.Vpa(AI,F.Eb.Dj)&&(rg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.ePf}),w=!1);rg.Eq()&&rg.Eq().instance&&rg.Eq().instance.EV(F.Eb.Dj)&&(rg.Uc.Vb(zd.a.qh,
{["Reason"]:Hd.a.externalSelection}),w=!1);a!==D.a.c0||I.a.instance.ga(54)||I.a.instance.ga(84)||(w=!1);var fa=null;S&&S.Pa.kb&&(fa=S.Pa.kb);a===D.a.Tcl&&fa&&fa.Paa&&db.ParagraphReader.FV(fa.Wa.node)&&!yc.ListReader.Gw&&(w=!1);if(1===c||!w||!fa)return w?32:8;w=a===D.a.ija||a===D.a.Xga||a===D.a.wma||a===D.a.wBa;F=a===D.a.mzk||a===D.a.$Ci||a===D.a.Oah;const xa=a===D.a.wfb||a===D.a.xfb||a===D.a.c0,Za=new Oe.GraphTransaction(15);Za.hd(fa.Wa.node);fa=new Ua.a;let pb=!1;if(w||F||xa)Me.a.mark(7121),b=rg.Ml.UTi(b.HD);
else{Me.a.mark(7119);b=ii.Wqa(S.Pa,!0);if(!b)return rg.Uc.Vb(zd.a.Fha,{["Reason"]:Hd.a.yIc}),Za.dispose(),8;S=a===D.a.ftj||a===D.a.gtj;b.Cw&&S&&(pb=rg.Noj(fa,b))}b.Cw&&1<b.length&&rg.Ooj(b)&&(l||(l={}),l.InContextSet=!0);u.AFrameworkApplication.Va.li(b,a,c,!0,f,l);pb&&rg.Jck(fa,b,l);Za.dispose();gb.App.Fb.updateCommandUI();w||F||xa?Me.a.mark(7122):Me.a.mark(7120);return 32}static Noj(a,b){if(!b.Cw)return!1;let c=!1,f=!1;for(let w=0;w<b.length;w++)if(b.getContext(w).Ok){var l=b.getContext(w).node;
if(l)if(l=rg.vL.Wrb(l),2===l.specialIndentType)c=!0,a.add(w);else if(1===l.specialIndentType||0===l.specialIndentType)f=!0}return f&&c}static Jck(a,b,c){if(b.Cw)for(let l=0;l<a.count;l++){var f=b.getContext(a.ga(l));if(!f.Ok)continue;f=f.node;const w=rg.vL.Wrb(f);2!==w.specialIndentType||sg.a.ry(c.value,w.cN)||f.setValue(Sb.a.Hl,w.cN-w.cHb)}}static x6k(a,b){let c=!0;b.contextId!==Db.a.paragraph?c=!1:I.a.instance.ga(14)&&rg.Vi.mDa(b)?(rg.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),c=!1):rg.Eq()&&rg.Eq().instance&&
rg.Eq().instance.EV(b)&&(rg.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.externalSelection}),c=!1);return{returnValue:1!==a&&c,vE:c?32:8}}static Ymh(a,b){let c=!0;b.contextId!==Db.a.image&&b.contextId!==Db.a.embeddedFile&&(c=!1);I.a.instance.ga(11)&&(c=!1);return{returnValue:1!==a&&c,vE:c?32:8}}static Ooj(a){if(!a.Cw)return!1;let b=1;for(let f=0;f<a.length;f++)if(a.getContext(f).Ok){var c=a.getContext(f).node;if(c)if(c=db.ParagraphReader.XM(c),!f)b=c;else if(c!==b)return!0}return!1}}rg.$c=null;rg.jm=null;rg.SF=
null;Object(e.a)(rg,"FormattingActionHelper",null,[]);class Hs extends Es.a{constructor(a,b,c,f,l,w,F,S){super();this.gtf=this.pB=null;this.init(a);this.vl("FormattingViewOperation");this.ACa(u.AFrameworkApplication.Va,b,f,l,w);this.yu=c;this.HJa=0;this.Ap=!0;this.lKh=F;this.jm=S}get Eqa(){return this.jm.instance}run(){const a=this.yu.view;var b=null;a.Jh&&(b=a.Eb);if(b){var c=b.Pa.kb;!c||I.a.instance.ga(14)&&Hs.Vi.v$d(c)?(Hs.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.aD}),this.Ap=!1):this.Eqa&&this.Eqa.iub(c)&&
(Hs.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.externalSelection}),this.Ap=!1)}else Hs.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.sla}),this.Ap=!1;1!==this.behavior&&this.Ap||(this.Ap&&(c=b.Pa.kb,1===b.Pa.length&&1===c.length&&Cb.SelectionEditor.Oj(c.Wa)&&zg.b(c.Wa)&&(Hs.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.XDc}),this.Ap=!1)),(c=this.Ap)&&this.actionId===D.a.KT&&((c=Ya.AT(b.Pa.kb,Ab.a.hPf))||Hs.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.QRd})),this.Zo=c?32:8,this.HJa=3);0===this.HJa&&(Me.a.mark(5730),this.gtf=mm.SelectionReferenceFactory.instance.bqa(),
c=b.Pa.kb.Wa,this.pB=new Oe.GraphTransaction(15),this.pB.hd(c.node),this.HJa=1);if(1===this.HJa){this.nz||this.efb(this.yu.HD);if(1===this.Wla())return;this.HJa=2}if(2===this.HJa){if(this.actionId===D.a.KT)if(b=b.Dj,b.Cw)for(c=0;c<b.length;c++){let f=b.getContext(c);this.Jxh(f)}else this.Jxh(b);b=this.actionId===D.a.T9||this.actionId===D.a.aAa||this.actionId===D.a.clearFormatting||this.actionId===D.a.YU;rg.b4b(this.actionId)||this.gtf.yT(b);(b=Object(ua.a)(736,this.od))&&!b.qea||v.FocusManager.instance().vf(a.NH);
this.pB.dispose();this.pB=null;rg.b4b(this.actionId)||gb.App.Fb.updateCommandUI();Me.a.mark(5731);this.HJa=3;this.Zo=32}3===this.HJa&&(this.lKh.process(this.actionId,this.yu,this.behavior,this.response),this.sX())}Jxh(a){(Cb.SelectionEditor.iu(a)||Cb.SelectionEditor.Bl(a))&&gb.App.SQ.NQ(a.node)}static get Vi(){return Rf.a.instance}static get Uc(){return cd.a.instance}}Object(e.a)(Hs,"FormattingViewOperation",Es.a,[]);var OP=d(475),PP=d(401);class pd{constructor(a,b,c,f,l){this.pya=new wa.ScriptSharpLegacyMap;
this.T3k=w=>{w=fb.HyperlinkReader.w2i(w,this.HC);for(let F of w)(w=F.paragraph)&&w.Ra&&(w=w.Ra.fS(F.Qa))&&w.formatting&&pd.fh.ueh(w.formatting)};this.xKh=a;this.Q0e=b;this.Av=c;this.HC=f;if(!l)throw Error.argumentNull("interactiveViewManager");pd.Jf=l;this.Wjb=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("FontPreviewEnabled")}wb(){const a=u.AFrameworkApplication.Va,b=Object(C.a)(this,this.sAk,"queryNonParagraphFormatting");I.a.instance.ga(105)&&(pd.pe?pd.pe.XCa(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"))?
(a.ya(D.a.font,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.rr,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.XH,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.gJ,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.Ms,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.YU,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.T9,Db.a.endOfParagraph,
Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.aAa,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.bold,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.setItalic,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.underline,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.Lma,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.superscript,Db.a.endOfParagraph,
Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.subscript,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.strikethrough,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.rs,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.KT,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP")),a.ya(D.a.clearFormatting,Db.a.endOfParagraph,Object(C.a)(this,this.cP,"applyFormattingEOP"))):gb.App.f9a&&(a.ya(D.a.font,
Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP")),a.ya(D.a.rr,Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP")),a.ya(D.a.Ms,Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP")),a.ya(D.a.YU,Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP")),yc.ListReader.Gw&&(a.ya(D.a.bold,Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP")),a.ya(D.a.setItalic,Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP")),
a.ya(D.a.superscript,Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP")),a.ya(D.a.subscript,Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP")),a.ya(D.a.strikethrough,Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP")),a.ya(D.a.rs,Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP"))),I.a.instance.ga(94)||I.a.instance.ga(96))&&(a.ya(D.a.XH,Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP")),a.ya(D.a.gJ,
Db.a.endOfParagraph,Object(C.a)(this,this.Aaa,"applyListFormattingEOP")));const c=gb.App.VIa.WQf(f=>ii.Wqa(f.Pa,!0));a.ra(D.a.Yjd,Db.a.textRange,Object(C.a)(this,this.Yjd,"toggleChangeCase"),1028);I.a.instance.ga(77)||a.ya(D.a.Cva,Db.a.table,Object(C.a)(this,this.bBk,"queryTableFormatting"));a.ya(D.a.EDb,Db.a.view,Object(C.a)(this,this.S6g,"queryCharacterFormatting"));a.ya(D.a.tAe,Db.a.view,Object(C.a)(this,this.S6g,"queryCharacterFormatting"));a.ya(D.a.Cva,Db.a.view,c);a.ya(D.a.Cva,Db.a.paragraph,
Object(C.a)(this,this.Cva,"queryParagraphFormatting"));a.ya(D.a.Cva,Db.a.image,Object(C.a)(this,this.lAk,"queryImageFormatting"));a.ya(D.a.Cva,Db.a.unsupportedObject,b);a.$d(D.a.EDb,99|(I.a.instance.ga(7)?0:1028));a.$d(D.a.tAe,1127);a.$d(D.a.Cva,97|(I.a.instance.ga(7)?0:1028));u.AFrameworkApplication.fa.ka("RulerEnabled")&&(a.ya(D.a.GDb,Db.a.view,c),a.ya(D.a.GDb,Db.a.paragraph,Object(C.a)(this,this.GDb,"queryParagraphIndentation")),a.$d(D.a.GDb,97|(I.a.instance.ga(7)?0:1028)));this.sB(a,D.a.font);
this.sB(a,D.a.rr);this.Wjb&&(this.sB(a,D.a.dHa),this.sB(a,D.a.$Wa),this.sB(a,D.a.p4),this.sB(a,D.a.KHa));if(I.a.instance.ga(94)||I.a.instance.ga(96))this.sB(a,D.a.XH),this.sB(a,D.a.gJ);a.vza(D.a.N3f,Db.a.view,Object(C.a)(this,this.CHd,"applyCharacterFormattingViewAsync"));a.$d(D.a.N3f,1092);this.sB(a,D.a.Ms);this.sB(a,D.a.YU);this.sB(a,D.a.T9);this.sB(a,D.a.rCc);this.sB(a,D.a.pUb);this.sB(a,D.a.qUb);this.sB(a,D.a.vob);this.sB(a,D.a.sCc);this.sB(a,D.a.aAa);this.sB(a,D.a.bold);a.Xeb(D.a.bold,Object(C.a)(this,
this.D5a,"generateActionArguments"));this.sB(a,D.a.setItalic);a.Xeb(D.a.setItalic,Object(C.a)(this,this.D5a,"generateActionArguments"));this.sB(a,D.a.underline);a.Xeb(D.a.underline,Object(C.a)(this,this.D5a,"generateActionArguments"));this.sB(a,D.a.Lma);this.sB(a,D.a.superscript);a.Xeb(D.a.superscript,Object(C.a)(this,this.D5a,"generateActionArguments"));this.sB(a,D.a.subscript);a.Xeb(D.a.subscript,Object(C.a)(this,this.D5a,"generateActionArguments"));this.sB(a,D.a.strikethrough);a.Xeb(D.a.strikethrough,
Object(C.a)(this,this.D5a,"generateActionArguments"));this.sB(a,D.a.rs);a.Xeb(D.a.rs,Object(C.a)(this,this.D5a,"generateActionArguments"));a.ra(D.a.K7a,Db.a.textRange,Object(C.a)(this,this.xAc,"applyCharacterFormatting"),96);a.vza(D.a.KT,Db.a.view,Object(C.a)(this,this.CHd,"applyCharacterFormattingViewAsync"));a.ya(D.a.KT,Db.a.paragraph,Object(C.a)(this,this.IHd,"applyParagraphFormatting"));a.ya(D.a.KT,Db.a.textRange,Object(C.a)(this,this.xAc,"applyCharacterFormatting"));a.ya(D.a.KT,Db.a.Ff,Object(C.a)(this,
this.DHd,"applyFormattingIp"));a.ya(D.a.clearFormatting,Db.a.view,Object(C.a)(this,this.pli,"clearFormattingView"));a.ya(D.a.clearFormatting,Db.a.paragraph,Object(C.a)(this,this.oli,"clearFormattingParagraph"));a.ya(D.a.clearFormatting,Db.a.textRange,Object(C.a)(this,this.xAc,"applyCharacterFormatting"));a.ya(D.a.clearFormatting,Db.a.Ff,Object(C.a)(this,this.DHd,"applyFormattingIp"));a.$d(D.a.clearFormatting,1028);a.ya(D.a.A3a,Db.a.textRange,Object(C.a)(this,this.A3a,"clearFormattingParagraphLevel"));
a.ya(D.a.A3a,Db.a.Ff,Object(C.a)(this,this.A3a,"clearFormattingParagraphLevel"));a.ya(D.a.WLd,Db.a.view,Object(C.a)(this,this.WLd,"clearFormattingMultiParagraphLevel"));a.ya(D.a.iIa,Db.a.view,rg.n6);a.ya(D.a.iIa,Db.a.paragraph,Object(C.a)(this,this.IHd,"applyParagraphFormatting"));a.ya(D.a.iIa,Db.a.image,Object(C.a)(this,this.rFf,"applyTextDirectionToImage"));a.ya(D.a.iIa,Db.a.unsupportedObject,Object(C.a)(this,this.sFf,"applyTextDirectionToNonParagraph"));a.$d(D.a.iIa,1028);a.ya(D.a.KXa,Db.a.view,
rg.n6);a.ya(D.a.KXa,Db.a.paragraph,Object(C.a)(this,this.IHd,"applyParagraphFormatting"));a.ya(D.a.KXa,Db.a.image,Object(C.a)(this,this.rFf,"applyTextDirectionToImage"));a.ya(D.a.KXa,Db.a.unsupportedObject,Object(C.a)(this,this.sFf,"applyTextDirectionToNonParagraph"));a.$d(D.a.KXa,1028)}sB(a,b){a.vza(b,Db.a.view,Object(C.a)(this,this.CHd,"applyCharacterFormattingViewAsync"));a.ya(b,Db.a.textRange,Object(C.a)(this,this.xAc,"applyCharacterFormatting"));a.ya(b,Db.a.Ff,Object(C.a)(this,this.DHd,"applyFormattingIp"));
a.$d(b,1028)}D5a(){return new Q(2)}Yjd(a,b,c){if(1===c)return 32;a=b.node.characterData.substr(b.Qa,b.Lb-b.Qa);return pd.S$d(a,0,a.length)?this.qCc(b,D.a.pUb):pd.KLj(a)?this.qCc(b,D.a.vob):this.qCc(b,D.a.qUb)}S6g(a,b,c,f,l){f=!0;b.contextId!==Db.a.view&&(f=!1);if(1===c&&!f)return 8;if(a===D.a.tAe)a=l.formatting,l=l.BBl;else{if(!b.view||!b.view.Jh)return 2;b=b.view;if(!b.Eb||!b.Eb.Pa.kb)return 8;a=l;l=b.Eb.Pa}this.Joi(l,a);return 32}Joi(a,b){for(let l of a){a=l.nl;for(let w of l){let F=null;if(w.contextId===
Db.a.textRange){if(zg.b(w))continue;F=[];var c=w.node.Ra;if(c){var f=c.length-1;const S=w.Qa,fa=w.Lb;let xa=!1;for(let Za=0;Za<f;Za++){const pb=c.ga(Za).cp,Mb=c.ga(Za+1).cp;if(c.ga(Za).formatting&&Math.max(pb,S)<Math.min(Mb,fa))xa=!0,Array.add(F,c.ga(Za).formatting);else if(xa)break}c.ga(f).formatting&&w.Lb>c.ga(f).cp&&Array.add(F,c.ga(f).formatting)}}else if(w.contextId===Db.a.paragraph){if(F=[],c=w.node.Ra)for(f=0;f<c.length;f++)c.ga(f).formatting&&Array.add(F,c.ga(f).formatting)}else if(w.contextId===
Db.a.endOfParagraph)F=[Ab.a.xs(w)];else if(w.contextId===Db.a.Ff){this.Szk(w,b);return}if(F&&0<F.length)for(const S of F)if(Ab.a.rld(b,S.cache,w,a))return}}}Szk(a,b){var c=Ab.a.xs(a);if(c){c=c.cache;var f=pd.insertionPointFormatting.TH(ob.a.bold,c.isBold);b.bold=f?1:0;f=pd.insertionPointFormatting.TH(ob.a.italic,c.isItalic);b.italic=f?1:0;f=pd.insertionPointFormatting.TH(ob.a.underline,c.mD);b.underline=f?1:0;b.kw=pd.insertionPointFormatting.TH(ob.a.kw,c.kw);f=pd.insertionPointFormatting.TH(ob.a.superscript,
c.isSuperscript);b.superscript=f?1:0;f=pd.insertionPointFormatting.TH(ob.a.subscript,c.ZE);b.subscript=f?1:0;f=pd.insertionPointFormatting.TH(ob.a.strikethrough,c.YE);b.strikethrough=f?1:0;f=pd.insertionPointFormatting.TH(ne.a.rs,c.pZ);b.rs=f?1:0;b.fontName=od.Font.PBa(pd.insertionPointFormatting.TH(ob.a.font,c.VM));b.bna=c.bU;b.fontSize=this.Av.a6a(pd.insertionPointFormatting.TH(ob.a.fontSize,c.fontSize),a.node);b.fontColor=pd.insertionPointFormatting.TH(ob.a.fontColor,c.fontColor);b.highlight=pd.insertionPointFormatting.TH(ob.a.highlight,
c.highlight)}}CHd(a,b,c,f,l,w){return new Hs(a,b,c,f,l,w,this.xKh,pd.Eq())}xAc(a,b,c,f,l){f=!0;let w=b;b.contextId!==Db.a.textRange&&b.contextId!==Db.a.Ff?f=!1:(I.a.instance.ga(14)&&pd.Vi.hsa(w)&&(pd.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),f=!1),pd.Eq()&&pd.Eq().instance&&pd.Eq().instance.EV(w)&&(f=!1),f&&Cb.SelectionEditor.Oj(b)&&zg.b(w)&&(pd.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.XDc}),f=!1));if(1===c||!f)return f?32:8;if(b.contextId===Db.a.Ff)return 2;this.Av.boh(a)&&(b=Cb.SelectionEditor.xIb(w),Cb.SelectionEditor.Mg(b)||
(w=b));b=w.node;rg.b4b(a)&&(b.Zma=!0);a==D.a.Ms&&I.a.instance.ga(119)&&u.AFrameworkApplication.fa.isChangeGateEnabled("HyperlinkPartialColorSupported")&&this.T3k(w);pd.SOe.yAc(w,F=>{this.Uih(F,a,l,w.Lb)});rg.b4b(a)&&(b.Zma=!1);this.iBj(a)&&this.qCc(w,a);return 32}zMc(a){if(!this.Wjb||!a||!a.paragraph)return null;const b=pd.Jf.Jd;if(!b)return null;a=Object(ua.a)(435,a.paragraph.yg(b.Na));return a?(a=Object(ua.a)(735,a))?a:null:null}MOc(a){return this.Wjb&&!!a&&!!a.Ci}njh(a,b,c){if(a&&a.od){var f=b.cache,
l=a.od,w=-1;if("string"===typeof l)this.Wjb&&c===D.a.p4&&this.m3a(b,f.VM,ob.a.font),a=l;else if(this.Wjb&&c===D.a.p4&&(this.m3a(b,f.VM,ob.a.font),this.m3a(b,f.bU,Sb.a.bU)),a=l.fontName,w=l.bna,od.Font.BRa()){this.Wjb&&c===D.a.p4&&(this.m3a(b,f.isBold,ob.a.bold),this.m3a(b,f.isItalic,ob.a.italic));const F=1===l.bold;l=1===l.italic;if(F||l)pd.fh.cJ(b,F),pd.fh.setItalic(b,l)}a=a.substr(0,31);pd.fh.rX(b,a);I.a.instance.ga(53)&&(c===D.a.p4&&this.m3a(b,f.bU,Sb.a.bU),pd.fh.jIa(b,w))}}m3a(a,b,c){this.pya.Kb(a.xe.cp)||
this.pya.$(a.xe.cp,new wa.ScriptSharpLegacyMap);this.pya.ga(a.xe.cp).Kb(c)||this.pya.ga(a.xe.cp).$(c,b)}RZb(a,b){if(!this.pya.Kb(a.xe.cp))return null;const c=this.pya.ga(a.xe.cp).ga(b);this.pya.ga(a.xe.cp).remove(b);this.pya.ga(a.xe.cp).count||this.pya.remove(a.xe.cp);return c}Uih(a,b,c,f){var l=a.cache,w=Object(ua.a)(736,c);switch(b){case D.a.bold:2===c.value&&(c.value=l.isBold?0:1);pd.fh.cJ(a,1===c.value);break;case D.a.setItalic:2===c.value&&(c.value=l.isItalic?0:1);pd.fh.setItalic(a,1===c.value);
break;case D.a.underline:2===c.value&&(c.value=l.mD?0:1);pd.fh.e0(a,1===c.value);break;case D.a.Lma:pd.fh.Lma(a,c);break;case D.a.superscript:2===c.value&&(c.value=l.isSuperscript?0:1);pd.fh.wX(a,1===c.value);break;case D.a.subscript:2===c.value&&(c.value=l.ZE?0:1);pd.fh.G4(a,1===c.value);break;case D.a.strikethrough:2===c.value&&(c.value=l.YE?0:1);pd.fh.uX(a,1===c.value);break;case D.a.rs:2===c.value&&(c.value=l.pZ?0:1);pd.fh.ffb(a,1===c.value);break;case D.a.font:this.njh(w,a,D.a.font);break;case D.a.p4:c=
this.zMc(a);this.MOc(c)&&(this.njh(w,a,D.a.p4),c.XL(null));break;case D.a.KHa:c=this.zMc(a);this.MOc(c)&&(w=this.RZb(a,ob.a.font))&&(f=this.RZb(a,ob.a.bold),l=this.RZb(a,ob.a.italic),f&&pd.fh.cJ(a,f),l&&pd.fh.setItalic(a,l),w=w.substr(0,31),pd.fh.rX(a,w),f=this.RZb(a,Sb.a.bU),I.a.instance.ga(53)&&f&&pd.fh.jIa(a,f),c.XL(null));break;case D.a.Ms:pd.fh.Ms(a,c,null);break;case D.a.YU:pd.fh.YU(a);break;case D.a.T9:pd.fh.Hma(a,c);break;case D.a.aAa:pd.fh.KUb(a);break;case D.a.rr:pd.fh.rr(a,w.od);break;
case D.a.dHa:c=this.zMc(a);this.MOc(c)&&(this.m3a(a,l.fontSize,ob.a.fontSize),pd.fh.rr(a,w.od),c.XL(null));break;case D.a.$Wa:c=this.zMc(a);this.MOc(c)&&(f=this.RZb(a,ob.a.fontSize))&&(pd.fh.rr(a,f),c.XL(null));break;case D.a.XH:pd.fh.gOc(a);break;case D.a.gJ:pd.fh.xhd(a);break;case D.a.KT:l=I.a.instance.ga(20)?Sb.a.noProof:Kd.a.Mua;l=c.ta(l,!1);pd.fh.mjc(a,c.getValue(ob.a.Cs),f,l);break;case D.a.K7a:pd.fh.JFb(a);break;case D.a.clearFormatting:pd.fh.Zza(a);break;case D.a.pUb:case D.a.qUb:case D.a.rCc:case D.a.vob:case D.a.sCc:l.CQa&&
2===l.capitalization&&pd.fh.RLd(a)}}A3a(a,b,c){a=!0;b.contextId!==Db.a.textRange&&b.contextId!==Db.a.Ff?a=!1:(I.a.instance.ga(14)&&pd.Vi.hsa(b)&&(pd.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),a=!1),a&&Cb.SelectionEditor.Oj(b)&&zg.b(b)&&(pd.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.XDc}),a=!1));if(1===c||!a)return a?32:8;pd.paragraphEditor.MUb(b.node,!1);return 32}WLd(a,b,c,f,l){a={};a[Vh.rna]=6168;a[Vh.qna]=6169;const w=b.view;var F=null;w.Po&&(F=w);var S=!0;let fa=32;F&&(F=F.Eb.Pa.kb)&&I.a.instance.ga(14)&&(pd.Vi.v$d(F)?
(pd.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.aD}),fa=8,S=!1):1===c&&(fa=32,S=!1));S&&I.a.instance.ga(54)&&(S=new Oe.GraphTransaction(1===c?3:15),S.hd(w.root),fa=Vh.m4(D.a.A3a,b,c,f,l,a,12),S.dispose());return fa}DHd(a,b,c,f,l){var w=!0,F=32;b.contextId!==Db.a.Ff?w=!1:I.a.instance.ga(14)&&pd.Vi.hsa(b)&&(pd.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),w=!1);if(1===c||!w)return w?32:8;c=b.node;w=null;if(I.a.instance.ga(54)&&I.a.instance.ga(61)&&a===D.a.clearFormatting){pd.dr.Job(c);pd.paragraphEditor.bNf(c);const S=Mc.StyleReader.rK(c).mG(Mc.StyleReader.AJa);
pd.qO.V9(S,c,!0)}if(a!==D.a.clearFormatting||I.a.instance.ga(49))w=pd.insertionPointFormatting.W_b(b);if(w)F=dd.a.QNa(w),F=u.AFrameworkApplication.Va.li(F,a,2,!1,f,l);else switch(f=Object(ua.a)(736,l),b=Ab.a.xs(b).cache,a){case D.a.font:f&&f.od&&(l=f.od,f=-1,"string"===typeof l?b=l:(b=l.fontName,f=l.bna),pd.insertionPointFormatting.Afd(b),I.a.instance.ga(53)&&pd.insertionPointFormatting.jIa(f));break;case D.a.Ms:pd.insertionPointFormatting.Ms(l);break;case D.a.YU:pd.insertionPointFormatting.YU();
break;case D.a.T9:pd.insertionPointFormatting.Hma(l);break;case D.a.aAa:pd.insertionPointFormatting.KUb();break;case D.a.rr:pd.insertionPointFormatting.rr(f.od);break;case D.a.XH:l=pd.insertionPointFormatting.TH(ob.a.fontSize,b.fontSize);pd.insertionPointFormatting.rr(pd.fh.XH(l));break;case D.a.gJ:l=pd.insertionPointFormatting.TH(ob.a.fontSize,b.fontSize);pd.insertionPointFormatting.rr(pd.fh.gJ(l));break;case D.a.bold:pd.insertionPointFormatting.cJ(!pd.insertionPointFormatting.TH(ob.a.bold,b.isBold));
break;case D.a.setItalic:pd.insertionPointFormatting.setItalic(!pd.insertionPointFormatting.TH(ob.a.italic,b.isItalic));break;case D.a.underline:pd.insertionPointFormatting.e0(!pd.insertionPointFormatting.TH(ob.a.underline,b.mD));break;case D.a.Lma:pd.insertionPointFormatting.Lma(l);break;case D.a.superscript:pd.insertionPointFormatting.wX(!pd.insertionPointFormatting.TH(ob.a.superscript,b.isSuperscript));break;case D.a.subscript:pd.insertionPointFormatting.G4(!pd.insertionPointFormatting.TH(ob.a.subscript,
b.ZE));break;case D.a.strikethrough:pd.insertionPointFormatting.uX(!pd.insertionPointFormatting.TH(ob.a.strikethrough,b.YE));break;case D.a.rs:pd.insertionPointFormatting.ffb(!pd.insertionPointFormatting.TH(ne.a.rs,b.pZ));break;case D.a.clearFormatting:pd.insertionPointFormatting.UWa();I.a.instance.ga(54)||(pd.dr.Job(c),pd.paragraphEditor.MUb(c,!0),I.a.instance.ga(71)&&pd.qO.WCc(c));break;case D.a.KT:l.Sa(ob.a.Cs)&&pd.insertionPointFormatting.KT(l.getValue(ob.a.Cs)),b=I.a.instance.ga(20)?Sb.a.noProof:
Kd.a.Mua,l.Sa(b)&&(l=l.getValue(b),pd.insertionPointFormatting.Y0k(l))}rg.b4b(a)||gb.App.Fb.updateCommandUI();return F}RLk(a,b){D.a.clearFormatting===b&&lc.OutlineElementNavigator.uA(a).properties.removeProperty(ob.a.bX)}cP(a,b,c,f,l){f=pd.Uc.zp(D.a.n_k);var w=!0;b.contextId!==Db.a.endOfParagraph&&(w=!1);if(1===c||!w)return w?32:8;c=b.node;b=mb.GraphIterator.nb(b.node);b.af();w=b.hia(4);if((b=!!w&&pd.Sf.Yba(w))&&!gb.App.f9a)return 8;const F=!db.ParagraphReader.textLength(c);f.properties.$("Action",
a.toString());f.properties.$("ListContext",b.toString());f.properties.$("IsEmptyParagraph",F.toString());Z.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",a,b,F);this.Q0e.Gsh(b)?this.fAh(a,l,w):(b=c.Ra.last,this.RLk(c,a),w=b.formatting,c=pd.characterPropertiesEditor.cTd(c),this.Q0e.kug(w)&&(c.Vd(c.xe),this.Uih(c,a,l,b.cp)));f.end();return 32}fAh(a,b,c){const f=Object(ua.a)(736,b);switch(a){case D.a.Ms:pd.hca.Ms(c,b);break;case D.a.rr:pd.hca.rr(c,f.od);
break;case D.a.YU:pd.hca.YU(c);break;case D.a.XH:pd.hca.XH(c);break;case D.a.gJ:pd.hca.gJ(c);break;case D.a.font:pd.hca.K_k(c,f.od);break;case D.a.bold:a=this.GEb(b,ob.a.bold,c);pd.hca.cJ(c,a);break;case D.a.setItalic:a=this.GEb(b,ob.a.italic,c);pd.hca.setItalic(c,a);break;case D.a.subscript:a=this.GEb(b,ob.a.subscript,c);pd.hca.G4(c,a);break;case D.a.superscript:a=this.GEb(b,ob.a.superscript,c);pd.hca.wX(c,a);break;case D.a.strikethrough:a=this.GEb(b,ob.a.strikethrough,c);pd.hca.uX(c,a);break;case D.a.rs:a=
this.GEb(b,ne.a.rs,c),pd.hca.ffb(c,a)}}GEb(a,b,c){2===a.value&&(a.value=c?c.ta(b,!1)?0:1:0);return 1===a.value}Aaa(a,b,c,f,l){f=!0;const w=mb.GraphIterator.nb(b.node);w.af();b.contextId===Db.a.endOfParagraph&&w.hia(4)||(pd.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.Bbe}),f=!1);b=w.currentNode;if(!pd.Sf.Yba(b))return 8;if(1===c||!f)return f?32:8;this.fAh(a,l,b);return 32}Cva(a,b,c,f,l){a=!0;b.contextId!==Db.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;-1!==l.pl?l.pl!==db.ParagraphReader.XM(c)&&(l.pl=0):
l.pl=db.ParagraphReader.XM(c);I.a.instance.ga(54)&&(I.a.instance.ga(59)||I.a.instance.ga(34))&&(a=pd.vL.Wrb(c),l.AA?(!l.lAl&&this.Poj(l.AA,a)&&2===l.AA.specialIndentType&&(l.AA.specialIndentType=0),l.AA.NPc===a.NPc&&sg.a.ry(l.AA.cN,a.cN)||(l.AA.cN=Number.MAX_VALUE),l.AA.PPc===a.PPc&&sg.a.ry(l.AA.vtb,a.vtb)||(l.AA.vtb=Number.MAX_VALUE)):l.AA=a,b=pd.Ml.nGf(b.HD),void 0!==b&&null!==b&&(b=b.node,void 0!==b&&null!==b&&(b=OP.WordSectionNavigator.instance.sse(b),void 0!==b&&null!==b&&(b=pd.WTe.pra(b)-(pd.WTe.QZd(b)+
pd.WTe.RZd(b)+gb.App.hyl),a.OPc=b-a.cN,a.MPc=b-a.vtb,l.AA.MPc=Math.min(l.AA.MPc,a.MPc),l.AA.OPc=Math.min(l.AA.OPc,a.OPc)))));if(I.a.instance.ga(54)&&I.a.instance.ga(59)||I.a.instance.ga(84))b=pd.GQj.qV(c),l.spacing?(l.spacing.beforeSpacing=pd.VCf(b.beforeSpacing,l.spacing.beforeSpacing),l.spacing.afterSpacing=pd.VCf(b.afterSpacing,l.spacing.afterSpacing),l.spacing.lineSpacing.Of===b.lineSpacing.Of&&sg.a.ry(l.spacing.lineSpacing.value,b.lineSpacing.value)||(l.spacing.lineSpacing.Of=0,l.spacing.lineSpacing.value=
0)):l.spacing=b;b=new mb.GraphIterator;b.set(c);b.oc(11);if(c=b.Og(11))l.isRtl=Md.OutlineElementReader.Vl(c);c=pd.Sf.rx(b);b=16;void 0!==c&&null!==c&&(b=c.listType);l.listType=pd.FZi(l.listType,b);l.AS=16===l.listType?null:c;return 32}Poj(a,b){return this.GFf(a,b)||this.GFf(b,a)}GFf(a,b){return(1===a.specialIndentType||0===a.specialIndentType)&&2===b.specialIndentType}sAk(a,b,c,f,l){a=lc.OutlineElementNavigator.uA(b.node);l.isRtl=Md.OutlineElementReader.Vl(a);return 32}sFf(a,b,c){if(a===D.a.KXa)a=
!0;else if(a===D.a.iIa)a=!1;else return 2;a&&this.pce(b);if(1===c)return 32;b=lc.OutlineElementNavigator.uA(b.node);pd.Lh.hIa(b,a);return 32}lAk(a,b,c,f,l){a=b.node;b=lc.OutlineElementNavigator.uA(a);l.isRtl=Md.OutlineElementReader.isRtl(b);l.pl=cb.ImageReader.XM(a);return 32}bBk(a,b,c,f,l){a=b.node;b=lc.OutlineElementNavigator.uA(a);l.isRtl=Md.OutlineElementReader.isRtl(b);l.pl=Cd.TableReader.XM(a);if(-1===l.pl||0===l.pl)l.pl=l.isRtl?3:1;return 32}rFf(a,b,c){if(!({vE:c}=rg.Ymh(c,b)).returnValue)return c;
c=b.node;switch(a){case D.a.iIa:case D.a.KXa:c=lc.OutlineElementNavigator.uA(c);let f=!0;a===D.a.iIa&&(f=!1);pd.Lh.hIa(c,f);f&&this.pce(b)}return 32}IHd(a,b,c,f,l){let w;if(!({vE:w}=rg.x6k(c,b)).returnValue)return w;const F=b.node;switch(a){case D.a.iIa:pd.Lh.hGb(F,!1);break;case D.a.KXa:this.pce(b);pd.Lh.hGb(F,!0);break;case D.a.KT:w=u.AFrameworkApplication.Va.li(b.HD,a,c,!0,f,l),32===w&&db.ParagraphReader.Tl(b)&&pd.Dfc&&pd.Dfc.NQ(F)}return 32}pli(a,b,c,f,l){const w={};w[Vh.rna]=6168;w[Vh.qna]=6169;
var F=b.view;const S=new Oe.GraphTransaction(1===c?3:15);S.hd(F.root);let fa=Vh.m4(a,b,c,f,l,w,0),xa=null;F.Po&&(xa=F);F=!0;let Za=null;xa&&(Za=xa.Eb.Pa.kb)&&I.a.instance.ga(14)&&(pd.Vi.v$d(Za)?(pd.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.aD}),fa=8,F=!1):1===c&&(fa=32,F=!1));F&&this.OLj(Za)&&(fa=I.a.instance.ga(54)?Vh.m4(D.a.A3a,b,c,f,l,w,12):Vh.m4(a,b,c,f,l,w,12));S.dispose();return fa}oli(a,b,c){a=!0;b.contextId!==Db.a.paragraph&&b.contextId!==Db.a.Ff?a=!1:I.a.instance.ga(14)&&pd.Vi.mDa(b)&&(pd.Uc.Vb(zd.a.yo,
{["Reason"]:Hd.a.aD}),a=!1);if(1===c||!a)return a?32:8;b=b.node;c=new Oe.GraphTransaction(15);c.hd(b);pd.dr.Job(b);pd.paragraphEditor.MUb(b,!0);pd.qO.WCc(b);c.dispose();return 2}GDb(a,b,c,f,l){a=b.contextId===Db.a.paragraph;if(1===c&&!a)return 8;l.AA||(b=b.node,c=pd.vL.Wrb(b),l.AA=c,c=new mb.GraphIterator,c.set(b),c.oc(11),b=c.Og(11),l.isRtl=b?Md.OutlineElementReader.Vl(b):!1);return 32}OLj(a){return!a||Cb.SelectionEditor.Ew(a)||1===a.length&&Cb.SelectionEditor.Oj(a.Wa)&&!Cb.SelectionEditor.fub(a.Wa)?
!1:!0}pce(a){pd.qsf.Kb(a.contextId)||(Z.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",a.contextId),pd.qsf.$(a.contextId,!0))}iBj(a){return a===D.a.rCc||a===D.a.pUb||a===D.a.qUb||a===D.a.vob||a===D.a.sCc}qCc(a,b){const c=a.node;b=pd.Bil(c.characterData.substr(a.Qa,a.Lb-a.Qa),b);c.characterData=c.characterData.substr(0,a.Qa)+b+c.characterData.substr(a.Lb);return 32}static get fh(){return pd.If||(pd.If=lb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return pd.Vg||
(pd.Vg=lb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return pd.tw||(pd.tw=lb.a.instance.resolve("Box4.IParagraphEditor"))}static get GQj(){return pd.dLa||(pd.dLa=lb.a.instance.resolve("Box4.ILineSpacingHelper"))}static get qO(){return pd.PJ||(pd.PJ=lb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get Lh(){return pd.xi||(pd.xi=lb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get insertionPointFormatting(){return pd.Vs||(pd.Vs=lb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get hca(){return pd.qkb||
(pd.qkb=lb.a.instance.resolve("Box4.List.IListFormattingEditor"))}static get vL(){return pd.SF||(pd.SF=lb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static Eq(){return pd.jm||(pd.jm=lb.a.instance.Oa("Box4.IExternalSelectionManager"))}static get Ml(){return xi.ContextSetEditor.instance}static get Vi(){return Rf.a.instance}static get Uc(){return cd.a.instance}static get pe(){return pd.$c||(pd.$c=lb.a.instance.qb("Box4.IFeatureHelper"))}static get Dfc(){return gb.App.SQ}static get Mf(){return pd.Yc||
(pd.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get e5(){return pd.Go||(pd.Go=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get SOe(){return pd.oMa||(pd.oMa=lb.a.instance.resolve("Box4.TextFormattingHelper"))}static get Sf(){return pd.Pg||(pd.Pg=lb.a.instance.resolve("Box4.List.IListReader"))}static get dr(){return pd.Eo||(pd.Eo=lb.a.instance.resolve("Box4.List.IListEditor"))}static get WTe(){return PP.a.instance}static FZi(a,
b){return 42===a?b:a!==b||16===a?16:a}static VCf(a,b){a.erg||(b.erg?b=a:b.Of===a.Of&&sg.a.ry(b.value,a.value)||(b.value=-1));return b}static Bil(a,b){switch(b){case D.a.pUb:return a.toLowerCase();case D.a.qUb:return a.toUpperCase();case D.a.rCc:case D.a.vob:return pd.Kii(a,b===D.a.vob);case D.a.sCc:return pd.jkl(a);default:return a}}static jkl(a){let b="";for(let c=0;c<a.length;c++)b=a.charAt(c)===a.charAt(c).toUpperCase()?b+a.charAt(c).toLowerCase():b+a.charAt(c).toUpperCase();return b}static Kii(a,
b){let c,f,l=!0,w=a.length,F=0,S=pd.S$d(a,F,w);for(;0<w;){f=c=!1;var fa=w;let Za;var xa=void 0;for(xa=0;0<fa&&pd.rki(a.charAt(F+xa));xa++,fa--)f=pd.uTc(a.charAt(F+xa));for(Za=xa;0<fa&&!(c=pd.uTc(a.charAt(F+xa)))&&" "!==a.charAt(F+xa)&&"/"!==a.charAt(F+xa);xa++,fa--);fa=xa-Za;if(0>=fa)break;F+=Za;xa=a.substr(F,fa);xa=xa===xa.toUpperCase();if(S||!xa)a=l||f||b?a.substr(0,F)+a.charAt(F).toUpperCase()+a.substr(F+1,fa-1).toLowerCase()+a.substr(F+fa):a.substr(0,F)+a.substr(F,fa).toLowerCase()+a.substr(F+
fa);w-=fa+Za;F+=fa;if(l=c)F++,w--,S=pd.S$d(a,F,w)}return a}static S$d(a,b,c){for(;0<c&&!pd.uTc(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toUpperCase())return!1;b++;c--}return!0}static KLj(a){for(var b=0;b<a.length&&!pd.uTc(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toLowerCase())return!1;b++}return!0}static uTc(a){return"."===a||"!"===a||"?"===a?!0:!1}static rki(a){return-1==="0123456789".indexOf(a)&&a.toUpperCase()===a.toLowerCase()}}pd.If=null;pd.xi=null;pd.qsf=new Al.a;pd.Jf=null;pd.dLa=null;
pd.Vg=null;pd.tw=null;pd.PJ=null;pd.Vs=null;pd.qkb=null;pd.SF=null;pd.jm=null;pd.$c=null;pd.Yc=null;pd.Go=null;pd.oMa=null;pd.Pg=null;pd.Eo=null;Object(e.a)(pd,"TextFormattingActor",null,[]);class BI{constructor(a){this.Da=a}get Ho(){return this.Da}JFb(a,b=!1){this.Ho.li(a,D.a.K7a,2,!0,null,b)}KT(a){this.Ho.Ma(D.a.KT,2,a)}}Object(e.a)(BI,"TextFormattingCommands",null,[592]);class Tt{get rna(){return Vh.rna}get qna(){return Vh.qna}get wJb(){return Vh.wJb}m4(a,b,c,f,l,w,F){return Vh.m4(a,b,c,f,l,w,
F)}ldb(a,b,c,f,l,w){return Vh.ldb(a,b,c,f,l,w)}static get instance(){Tt.Ka||(Tt.Ka=new Tt);return Tt.Ka}}Tt.Ka=null;Object(e.a)(Tt,"ViewActionHandlerProxy",null,[734]);class CI{constructor(a){this.Da=a}get Ho(){return this.Da}dbk(a){if(4===a)a=D.a.leftArrow;else if(2===a)a=D.a.rightArrow;else if(1===a)a=D.a.upArrow;else if(3===a)a=D.a.downArrow;else return;this.Ho.processAction(a,2)}Dqa(){this.Ho.processAction(D.a.Dqa,2)}}Object(e.a)(CI,"SelectionCommands",null,[591]);class DI{Lg(a,b){return fd.SelectionFactory.Lg(a,
b)}SM(a,b){return fd.SelectionFactory.SM(a,b)}Zt(a,b=!0){return fd.SelectionFactory.Zt(a,b)}PY(a,b,c){return fd.SelectionFactory.PY(a,b,c)}$k(a){return fd.SelectionFactory.$k(a)}BIb(a,b,c=!1){return fd.SelectionFactory.BIb(a,b,c)}}Object(e.a)(DI,"SelectionFactoryProxy",null,[579]);var QP=d(858),jx=d(246),jz=d(970);class EI extends jz.a{constructor(a,b,c,f,l,w,F=null,S=null){super(a,w,F,S);this.Qn=this.tw=this.c1=null;this.Xna=!1;this.C_a=u.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");
this.G0a=0;this.ZCd=new Ua.a;Ee.a(8128527,307,Md.OutlineElementReader.Tg(a));this.sE=b;this.sE.Gnb(this);this.Ktd=c;this.Eo=f;this.Pg=l;this.tsk=S;this.Yyd=yc.ListReader.$j(this.vb)}get s7(){return this.c1||(this.c1=lb.a.instance.qb("Box4.IInternalLinkManager"))}get paragraphEditor(){return this.tw||(this.tw=lb.a.instance.resolve("Box4.IParagraphEditor"))}get $Na(){return null}get S3a(){return this.Yyd&&!this.sE.Yaa}get g4a(){return 0<this.G0a}get Qu(){return this.Ktd}get dr(){return this.Eo}get Sf(){return this.Pg}get iBc(){return this.tsk}D_(a,
b){if(!this.UX.QQe(b)){Ee.a(8701077,307,db.ParagraphReader.Pk(this.vb));var c=this.vb.currentNode,f=Fc.a.PNa(c);this.C_a&&this.Qn.A5a&&(c=c.Ra.last,this.Xna&&(c.formatting=this.Qn.A5a.Vd(c),this.Xna=!1),a=this.UX.I2d(a,b),this.UX.Jma(this.vb.currentNode,this.Qn.Lda,b));this.characterPropertiesEditor.replaceTextRange(f,a)}}Dla(){Ee.a(8701078,307,db.ParagraphReader.Pk(this.vb));const a=Fc.a.PNa(this.vb.currentNode);this.characterPropertiesEditor.eQc(a,b=>new hv.a(b,hv.a.MFc),Wc.AParagraphNode.VY)}SVa(){}Bla(){this.C_a&&
(this.Xna=!0)}Vua(){Ee.a(8701079,307,db.ParagraphReader.Pk(this.vb))}Uua(){Ee.a(8701080,307,db.ParagraphReader.Pk(this.vb))}Vz(a){this.sE.Yaa||(this.C_a?(this.vHd(a),this.Qn.zkd(this.vb.currentNode),a&&"P"===a.qT.P1b&&this.iBc.fIa(this.vb.currentNode,this.Qn.W8c),this.UX.Jma(this.vb.currentNode,this.Qn.Lda,a)):this.Z$h(a))}Uz(){this.sE.Yaa||this.V1()}$ua(){}HGa(){}Gla(){Ee.a(8701081,307,Md.OutlineElementReader.Tg(this.vb)||Vi.OutlineReader.xt(this.vb)||db.ParagraphReader.Pk(this.vb)&&this.sE.Yaa);
let a=!1;this.g4a||(a=this.S3a||!0);a||(this.xL+=1);this.G0a++}Ela(){this.G0a--;let a=!1;this.g4a||(a=this.S3a||!0);a||--this.xL}Zua(a){Ee.a(8701082,307,Md.OutlineElementReader.Tg(this.vb)||Vi.OutlineReader.xt(this.vb)||db.ParagraphReader.Pk(this.vb)&&this.sE.Yaa);Ee.a(8701083,307,0!==a.listStyleType)}Fla(){Ee.a(8701084,307,Md.OutlineElementReader.Tg(this.vb)||db.ParagraphReader.Pk(this.vb)&&this.sE.Yaa);this.sE.Yaa||Ee.a(8701085,307,this.vb.$H(2))}$W(a){this.sE.$W(a)}XW(){this.sE.XW()}mkd(a){this.ZCd.add(a)}ZW(a){this.sE.ZW(a)}YW(){this.sE.YW()}WW(a){this.sE.WW(a)}VW(){this.sE.VW()}Z$h(a){this.$Ab(!1);
(new mb.GraphIterator).Pc(this.vb);a=jz.a.Lh.Uaa(this.vb,this.QPa(a));Ee.a(8128534,307,a===this.vb.currentNode);Ee.a(8128535,307,db.ParagraphReader.Pd(a))}V1(){Ee.a(8128536,307,db.ParagraphReader.Pk(this.vb));lc.OutlineElementNavigator.Ke(this.vb)}reset(){this.C_a&&(super.reset(),this.Qn=this.gYd(!0))}vHd(a){this.$Ab(!1);(new mb.GraphIterator).Pc(this.vb);a=jz.a.Lh.Uaa(this.vb,this.QPa(a));Ee.a(36577367,307,a===this.vb.currentNode);Ee.a(36577368,307,db.ParagraphReader.Pd(a));-1!==this.Qn.pD&&this.paragraphEditor.KL(a,
this.Qn.pD);this.Qn.lineSpacing&&this.iBc.c0(a,this.Qn.lineSpacing);this.Qn.wea&&this.iBc.Ykh(a,this.Qn.wea);this.Qn.ZUc&&this.iBc.Pjh(a,this.Qn.ZUc);this.Xna=!0;this.Qn.paragraph=a}static NNd(a,b){let c=0;switch(b){case 3:c=ke.a.Ora(a);break;case 7:c=fe.a.Qda(a,0);break;case 1:c=ke.a.iLd(a);break;case 5:c=ke.a.Ora(ke.a.S9c(a));break;default:Z.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",a,b)}return c}}Object(e.a)(EI,"TextOnlyBox4PasteSteward",
jz.a,[]);class uC{constructor(a,b,c,f){this.cPb=a;this.Eo=b;this.Pg=c;this.UX=f}create(a,b,c,f,l=null,w=null){return 1===a?new EI(b,f,this.cPb,this.Eo,this.Pg,l,w,this.UX):new jx.Box4PasteSteward(b,c,f,this.cPb,this.Eo,this.Pg,l,w,this.UX)}}Object(e.a)(uC,"Box4PasteStewardFactory",null,[630]);class Dg{static get Pqj(){return Dg.uLh}static get Vqj(){return Dg.xLh}static get Uqj(){return Dg.wLh}static Eyk(a,b){const c=a.currentNode;Fd.forEachCell(a,b.rowSpan,b.colSpan,(f,l,w)=>{const F=f.currentNode;
F!==c&&(F.isGhostCell=!0,Dg.dVf(f),!w&&1<=b.colSpan&&(F.colSpan=b.colSpan),Dg.ujh(f,b.U4,l,w,b.rowSpan,b.colSpan))})}static Yyk(a,b){Fd.forEachCell(a,b.rowSpan,b.colSpan,c=>{Dg.g8h(c);Dg.dVf(c)})}static g8h(a){a=a.currentNode;a.isGhostCell=!0;a.isSkippedCell=!0;a.Nfb=!0}static dVf(a){a&&(a.yb(1),Object(Ca.a)(cI.a,a.currentNode)&&a.Hi())}static y8h(a,b,c){0<b&&(a=Object(ua.a)(ix.TableCellNode,a.currentNode))&&(a.width=c?b:fe.a.yf(b,0))}static O7h(a,b,c){if(a=Object(ua.a)(oy.a,a.currentNode))0<b&&(a.Hl=
fe.a.Qda(b,0)),0<c&&(a.dX=fe.a.Qda(c,0))}static vFf(a,b){void 0!==b&&null!==b&&a.currentNode.properties.setValue(Sb.a.eOe,Dg.Vqj[b+""])}static hFf(a,b){void 0!==b&&null!==b&&""!==b&&a.currentNode.properties.setValue(ob.a.oCc,parseInt(jx.Box4PasteSteward.U3a(b),16))}static Bej(a){const b=new mb.GraphIterator;b.Pc(a);return(a=vg.OutlineNavigator.Bdd(b))&&Vi.OutlineReader.xt(b)?a.Uh(Sb.a.Ida)-a.Uh(Sb.a.marginLeft)-a.Uh(Sb.a.marginRight):0}static PJj(a){return!(void 0===a||null===a||1===a)}static mZk(a,
b,c,f,l){if(void 0===b||null===b||""!==b){switch(b){case "thin":b=ke.a.R9c(.25);break;case "initial":case "medium":b=ke.a.R9c(.5);break;case "thick":b=ke.a.R9c(1);break;default:b=Dg.Nbj(b,c,f)}l.currentNode.properties.setValue(a,b)}}static vHe(a,b,c){void 0!==b&&null!==b&&0!==b&&c.currentNode.properties.setValue(a,Dg.Uqj[b+""])}static lZk(a,b,c){void 0!==b&&null!==b&&""!==b&&c.currentNode.properties.setValue(a,parseInt(jx.Box4PasteSteward.U3a(b),16))}static Nbj(a,b,c){let f=0;const l=({Of:a}=jx.Box4PasteSteward.e9c(a)).returnValue;
switch(a){case 5:f=ke.a.R9c(l);break;case 1:f=ke.a.nii(l);break;case 3:f=ke.a.Dkg(l);break;case 7:f=fe.a.Nsk(l,c)}if(6===b||7===b||10===b)f/=3;return Math.round(f)}static Obj(a,b){let c=0;const f=({Of:a}=jx.Box4PasteSteward.e9c(a)).returnValue;switch(a){case 5:c=ke.a.XG(f);break;case 1:c=ke.a.oii(f);break;case 3:c=ke.a.xV(f);break;case 7:c=fe.a.yf(f,b)}return c}static lfd(a,b,c,f,l,w,F){if(l&&(!F||16===l.ri||F||14!==l.ri)&&12!==c){if(F)switch(f){case 7:f=Sb.a.zth;var S=Sb.a.Bth;var fa=Sb.a.Ath;var xa=
0;break;case 6:f=Sb.a.wth;S=Sb.a.yth;fa=Sb.a.xth;xa=1;break;case 0:f=Sb.a.qth;S=Sb.a.sth;fa=Sb.a.rth;xa=0;break;case 5:f=Sb.a.tth;S=Sb.a.vth;fa=Sb.a.uth;xa=1;break;default:return}else switch(f){case 7:f=Sb.a.chl;S=Sb.a.ehl;fa=Sb.a.dhl;xa=0;break;case 6:f=Sb.a.$gl;S=Sb.a.bhl;fa=Sb.a.ahl;xa=1;break;case 0:f=Sb.a.Ugl;S=Sb.a.Wgl;fa=Sb.a.Vgl;xa=0;break;case 5:f=Sb.a.Xgl;S=Sb.a.Zgl;fa=Sb.a.Ygl;xa=1;break;default:return}void 0!==l.currentNode&&null!==l.currentNode&&(Dg.PJj(c)?(Dg.lZk(f,a,l),Dg.vHe(S,c,l),
Dg.mZk(fa,b,c,xa,l)):w||F||l.currentNode.properties.setValue(S,"nil"))}}static ujh(a,b,c,f,l,w){f||(Dg.aFf(b,a,!1,!1),Dg.LHd(b,a,!0,!1));f===w-1&&Dg.LHd(b,a,!0,!1);c||Dg.tFf(b,a,!0,!1);c===l-1&&Dg.SEf(b,a,!0,!1)}static QEf(a,b,c,f){a&&(Dg.tFf(a,b,c,f),Dg.LHd(a,b,c,f),Dg.SEf(a,b,c,f),Dg.aFf(a,b,c,f))}static tFf(a,b,c,f){Dg.lfd(a.borderTopColor,a.borderTopWidth,a.borderTopStyle,7,b,c,f)}static LHd(a,b,c,f){Dg.lfd(a.borderRightColor,a.borderRightWidth,a.borderRightStyle,6,b,c,f)}static SEf(a,b,c,f){Dg.lfd(a.borderBottomColor,
a.borderBottomWidth,a.borderBottomStyle,0,b,c,f)}static aFf(a,b,c,f){Dg.lfd(a.borderLeftColor,a.borderLeftWidth,a.borderLeftStyle,5,b,c,f)}static mfd(a,b,c){if(c&&16===c.ri&&""!==a){switch(b){case 3:b=Sb.a.LHb;var f=0;break;case 2:b=Sb.a.KHb;f=1;break;case 0:b=Sb.a.HHb;f=0;break;case 1:b=Sb.a.IHb;f=1;break;default:return}(a=Dg.Obj(a,f))&&c.currentNode.properties.setValue(b,a)}}static z7h(a,b){b&&(Dg.t8h(b,a),Dg.c8h(b,a),Dg.A7h(b,a),Dg.T7h(b,a))}static t8h(a,b){Dg.mfd(a.iii,3,b)}static c8h(a,b){Dg.mfd(a.hii,
2,b)}static A7h(a,b){Dg.mfd(a.fii,0,b)}static T7h(a,b){Dg.mfd(a.gii,1,b)}}Dg.Vbk=8;Dg.nCi="Table Grid";Dg.uLh=va.a.cH("MsoNormalTable","Normal Table","MsoTableGrid",Dg.nCi,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2",
"Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5",
"Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2",
"Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5",
"Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6",
"MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1",
"List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3",
"MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4",
"MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3",
"MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5",
"List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6",
"List Table 7 Colorful Accent 6");Dg.xLh=va.a.cH("0","center","1","top","2","center","3","bottom");Dg.wLh=va.a.cH("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(e.a)(Dg,"Box4TableStewardHelper",null,[]);class kx{constructor(a,b,c,f=!1,l=!1,w=!1){this.vv=null;this.H0a=0;this.vb=a;this.dr=b;this.rq=c;this.Qlb=f;this.nPb=l;this.Vyd=w}Gnb(a){this.vv=a}get Yaa(){return 0<this.H0a}$W(a){Ee.a(7869459,
307,!!this.vv);Ee.a(7869460,307,Md.OutlineElementReader.Tg(this.vb)||Vi.OutlineReader.xt(this.vb));Ee.c(38563978,307,50,"Table pasting started");this.vv.$Ab(!0);const b=new mb.GraphIterator;b.Pc(this.vb);Object(ua.a)(String,Dg.Pqj[a.osh]);const c=this.rq.RGk(this.vb,a.oX,a.Rpa,this.vv.QPa(a),a.Cqg);if(this.Qlb&&(Ee.c(23938568,307,50,a.BNa?"Table-widths exist":"Table-widths missing, table may be invalid"),a.cOe&&Dg.QEf(a.cOe,this.vb,!1,!0),Dg.O7h(this.vb,a.f5d.Ncl,a.f5d.Mcl),a.BNa)){var f=0;const S=
Array(a.BNa.length);var l=0;a.sDa&&I.a.instance.ga(63)&&(l=(l=ke.a.Wxh(Dg.Bej(this.vb)))?l:1);for(var w=0;w<a.BNa.length;w++)S[w]=0<l?l/100*a.BNa[w]:fe.a.yf(a.BNa[w],0),f+=S[w];l=c.getValue(ob.a.ru);var F=new mb.GraphIterator;F.Pc(this.vb);a=0;if(Ce.isInTableCell(F)){if(l=Fd.returnToContainingCell(F))a=l.width;w=Ln.a(F);F=Fd.returnToContainingTable(F);if(-1!==w&&w<=F.DNa.length){let fa=0;for(let xa=w;xa<w+l.colSpan&&xa<F.DNa.length;xa++)fa+=F.DNa[xa];a=Math.min(a,fa);a===fa&&(a-=fe.a.yf(Dg.Vbk,0))}}else if(l)for(w=
0;w<l.length;w++)a+=l[w];if(0<a&&f>a&&f)for(f=a/f,a=0;a<S.length;a++)S[a]*=f;c.setValue(ob.a.ru,S)}this.vv.BAc(b,!1);this.H0a++;I.a.instance.ga(63)&&yc.ListReader.$j(b)&&this.vv.mkd(b.currentNode);Ee.a(7869461,307,Cd.TableReader.Jp(this.vb))}XW(){Ee.a(7869462,307,!!this.vv);Ee.a(7869463,307,kk.l(this.vb));Ee.c(38563979,307,50,"Table pasting finished");lc.OutlineElementNavigator.Ke(this.vb);this.H0a--}ZW(a){Ee.a(7869464,307,!!this.vv);Cd.TableReader.Jp(this.vb)?Fd.moveToFirstRow(this.vb):kk.l(this.vb)&&
Fd.moveToNextRow(this.vb);this.Qlb&&a.height&&this.vb.currentNode.setValue(Sb.a.Nt,fe.a.yf(a.height,1));Ee.a(7869465,307,kk.l(this.vb))}YW(){Ee.a(7869466,307,!!this.vv);Ee.a(7869467,307,Ce.isTableCell(this.vb));Fd.returnToContainingRow(this.vb)}WW(a){Ee.a(7869468,307,!!this.vv);Ee.a(7869469,307,!this.vv.xL);kk.l(this.vb)?Fd.moveToFirstColumn(this.vb):Ce.isTableCell(this.vb)?Fd.moveToNextColumn(this.vb):Ee.a(7869471,307,!1);u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings");
if(this.nPb){if(!this.vb.currentNode)return;var b=Object(ua.a)(ix.TableCellNode,this.vb.currentNode);Ee.a(50689760,307,!b&&16!==this.vb.currentNode.type||!!b&&16===this.vb.currentNode.type);if(!b)return;let c=new mb.GraphIterator;c.Pc(this.vb);if(!a.colSpan||!a.rowSpan)return;if(a.fvb){Dg.Yyk(c,a);return}if(1<a.colSpan||1<a.rowSpan){const f=Fd.returnToContainingTable(c);if(!f)return;f.setValue(Sb.a.complexTable,!0);c.Pc(this.vb);Dg.Eyk(c,a);b.rowSpan=a.rowSpan;b.colSpan=a.colSpan}}this.Qlb&&(Dg.hFf(this.vb,
a.Kjc),Dg.vFf(this.vb,a.verticalAlignment),this.Vyd&&Dg.z7h(this.vb,a.Yid));this.nPb&&Dg.QEf(a.U4,this.vb,!a.colSpan&&!a.rowSpan,!1);this.Qlb&&(this.nPb||(b=new mb.GraphIterator,b.Pc(this.vb),Fd.forEachCell(b,a.rowSpan,a.colSpan,(c,f,l)=>{Dg.hFf(c,a.Kjc);Dg.vFf(c,a.verticalAlignment);Dg.ujh(c,a.U4,f,l,a.rowSpan,a.colSpan)})),Dg.y8h(this.vb,a.width,a.sDa));Ee.a(7869472,307,Vi.OutlineReader.xt(this.vb))}VW(){Ee.a(7869473,307,!!this.vv);Ee.a(7869474,307,Md.OutlineElementReader.Tg(this.vb)||Ce.isTableCell(this.vb));
Fd.returnToCell(this.vb);Ee.a(7869475,307,0>=this.vv.xL);this.vv.$Ld()}static get Lh(){return kx.xi||(kx.xi=lb.a.instance.resolve("Box4.IOutlineElementEditor"))}}kx.xi=null;Object(e.a)(kx,"Box4TableSteward",null,[405,406]);class Ut{constructor(a,b,c){this.vv=null;this.H0a=0;this.vb=a;this.dr=b;this.rq=c}Gnb(a){this.vv=a}get Yaa(){return 0<this.H0a}$W(){this.Yaa&&(Ee.a(8787101,307,db.ParagraphReader.Pk(this.vb)),lc.OutlineElementNavigator.Ke(this.vb));Ee.a(8701086,307,!!this.vv);Ee.a(8701087,307,Md.OutlineElementReader.Tg(this.vb)||
Vi.OutlineReader.xt(this.vb));this.H0a++}XW(){Ee.a(8701088,307,!!this.vv);lc.OutlineElementNavigator.Ke(this.vb);this.H0a--;if(this.Yaa){this.vv.$Ab(!0);const a=Ut.Lh.Uaa(this.vb);Ee.a(8787102,307,a===this.vb.currentNode);Ee.a(8787103,307,db.ParagraphReader.Pk(this.vb))}}ZW(a){Ee.a(8701089,307,!!this.vv);this.vv.$Ab(!0);const b=new mb.GraphIterator;b.Pc(this.vb);this.vv.BAc(b,!1);I.a.instance.ga(63)&&yc.ListReader.$j(b)&&this.vv.mkd(b.currentNode);a=Ut.Lh.Uaa(this.vb,this.vv.QPa(a));Ee.a(8701090,
307,a===this.vb.currentNode);Ee.a(8701091,307,db.ParagraphReader.Pk(this.vb))}YW(){Ee.a(8701120,307,!!this.vv);Ee.a(8701121,307,db.ParagraphReader.Pk(this.vb));lc.OutlineElementNavigator.Ke(this.vb)}WW(){Ee.a(8701122,307,!!this.vv);Ee.a(8701123,307,db.ParagraphReader.Pk(this.vb));Ee.a(8701124,307,!this.vv.xL);var a=this.vb.currentNode;db.ParagraphReader.textLength(a)&&(a=Fc.a.PNa(a),this.vv.characterPropertiesEditor.replaceTextRange(a,", "))}VW(){Ee.a(8701125,307,!!this.vv);Ee.a(8701126,307,db.ParagraphReader.Pk(this.vb));
Ee.a(8701127,307,0>=this.vv.xL);this.vv.$Ld()}static get Lh(){return Ut.xi||(Ut.xi=lb.a.instance.resolve("Box4.IOutlineElementEditor"))}}Ut.xi=null;Object(e.a)(Ut,"TextOnlyBox4TableSteward",null,[405,406]);class vC{constructor(a,b,c=!1,f=!1,l=!1){this.Eo=a;this.NC=b;this.Qlb=c;this.nPb=f;this.Vyd=l}create(a,b){return 1===a?new Ut(b,this.Eo,this.NC):new kx(b,this.Eo,this.NC,this.Qlb,this.nPb,this.Vyd)}}Object(e.a)(vC,"Box4TableStewardFactory",null,[384]);class FI{create(){return new zn.a}}Object(e.a)(FI,
"Factory",null,[580]);class GI{Yb(a){a.register(uC,"Box4.Actors.Box4PasteStewardFactory").as("Box4.Actors.IBox4PasteStewardFactory").ma().na(()=>new uC(Xu.a.hsb,a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.Actors.IBox4PasteStewardBridge")));a.register(WB,"Box4.Actors.Box4PasteStewardUtils").as("Box4.Actors.IBox4PasteStewardUtils").ma().na(()=>new WB(u.AFrameworkApplication.fa.ka("WacPasteBrAsNewParagraphIsEnabled")));a.register(vH.ClipboardActor,"Box4.Actors.ClipboardActor").ma().na(()=>
new vH.ClipboardActor(a.qe("Box4.Actors.IClipboardOperationFactory"),a.resolve("Box4.Actors.ISystemClipboard"),cd.a.instance,a.resolve("Box4.IClipboardDataHelper"),dd.a.instance,u.AFrameworkApplication.Va,a.resolve("Box4.IUndoManager"),u.AFrameworkApplication.fa));a.register(575,"Common.App.ChromeExtensionHelper.IChromeExtensionHelper").ma().na(()=>new VA(u.AFrameworkApplication.fa));a.register(576,"Box4.Clipboard.ISystemClipboardAccessManagerFactory").ma().na(()=>new tI(u.AFrameworkApplication.fa,
a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Box4.IClipboardDataHelper"),Ta.a.instance));a.register(577,"Box4.Clipboard.ISystemClipboardAccessManager").ma().na(()=>a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create());a.register(578,"Box4.Actors.ISystemClipboard").ma().na(()=>new pI(a.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),oa.InteractiveViewManager.instance,gb.App.Fb.Fd,v.FocusManager.instance(),a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.IEditViewStateManager"),Ta.a.instance));a.register(332,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().na(()=>new yH);a.register(333,"Box4.Actors.IDeleteTableSegmentStrategy").ma().na(()=>new uI);a.register(579,"Box4.ISelectionFactory").ma().na(()=>new DI);a.register(580,"Box4.IRenderOrderGraphIteratorFactory").ma().na(()=>new FI);a.register(581,"Common.IDomElementContentStateFactory").ma().na(()=>new cH);a.register(582,"Box4.Actors.IClipboardOperationPasteOvertypeStrategy").ma().na(()=>
new KH(dd.a.instance,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Styles.IStyleReader"),I.a.instance.ga(71)));a.register(pC,"Box4.Actors.PasteFloatieFeatureSetBuilder").ma().na(()=>new pC(a.resolve("Box4.IClipboardDataHelper"),gb.App.WC.PR));a.register(583,"Box4.Actors.IClipboardOperationPasteFactory").ma().na(()=>new IH(cd.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.PasteCoordinator"),cg.a.instance,dd.a.instance,u.AFrameworkApplication.Va,a.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),
a.qe("Box4.IUndoManager"),a.resolve("Common.IDomElementContentStateFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(312,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().na(()=>new xH(u.AFrameworkApplication.Va,cd.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),dd.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),
ni.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper")));a.register(584,"Box4.Actors.IClipboardOperationClipboardAccessHelper").ma().na(()=>new wH(cd.a.instance,Ta.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Common.ISimpleOperationFactory"),
u.AFrameworkApplication.fa.appSettings.ChromeClipboardAccessOperationTimeout));a.register(585,"Box4.Actors.IClipboardOperationPasteStrategyFactory").ma().na(()=>new NH(u.AFrameworkApplication.fa));a.register(586,"Box4.Actors.IClipboardOperationFactory").ma().na(()=>new GH(a.resolve("Box4.Actors.InternalClipboard"),u.AFrameworkApplication.Va,u.AFrameworkApplication.chd()&&!(r.a.sS&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")),cd.a.instance,ni.a.instance,Ta.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),
a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.Actors.ClipboardOperationWordStrategy"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IUndoManager"),a.resolve("Box4.IPasteFloatieEventSource"),
a.resolve("Common.Utils.Telemetry.ITelemetry")));a.register(587,"Box4.Actors.IExternalPasteExecutionManagerFactory").ma().na(()=>new YH(a.qe("Box4.Actors.IBox4PasteStewardFactory"),a.qe("Box4.Actors.IBox4ImageStewardFactory"),a.qe("Box4.Actors.IBox4TableStewardFactory"),a.qe("Box4.Actors.IBox4WordConverterFactory"),a.resolve("HtmlImport.IHtmlTranslatorSettings"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.IExternalPasteCssConverter"),a.resolve("HtmlImport.IHtmlNormalizerSettings")));
a.register(Jh,"Box4.Actors.InternalClipboard").ma().na(()=>new Jh(a.resolve("Box4.Images.IImageEditor"),a.resolve("Box4.ITableEditor"),a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.List.IListEditor"),gb.App.tO,a.resolve("Box4.IParagraphIndentationReader"),u.AFrameworkApplication.fa,a.resolve("Box4.Graph.IGraphNodeFactory"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IConstantsProvider").nih,a.resolve("Box4.IFormattingPropertyTransitStrategy")));a.register(588,"Box4.Actors.IInternalPasteExecutionManagerFactory").ma().na(()=>new kI(a.resolve("Box4.Actors.InternalClipboard"),new sc.a(()=>gb.App.Fb.Fd.Xm)));a.register(589,"Box4.List.IListCommands").ma().na(()=>new vI(u.AFrameworkApplication.Va));a.register(Rr,"Box4.Actors.PasteCoordinator").ma().na(()=>new Rr(a.resolve("Box4.Actors.InternalClipboard"),
a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory")));I.a.instance.ga(78)||a.register(vC,"Box4.Actors.Box4TableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().na(()=>new vC(lb.a.instance.resolve("Box4.List.IListEditor"),lb.a.instance.resolve("Box4.ITableEditor"),a.resolve("Common.IAppSettingsManager").ka("TablePasteRefactoringAndFixesIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("PasteComplexTablesIsEnabled"),
a.resolve("Common.IAppSettingsManager").ka("PasteTableCellMarginImprovementsIsEnabled")));a.register(hC,"Box4.Actors.ClipboardOperationWordStrategy").ma().na(()=>new hC(cd.a.instance,dd.a.instance,gb.App.Hh,Rf.a.instance,I.a.instance.ga(14),I.a.instance.ga(50)));a.register(eC,"Box4.Actors.Box4WordConverterFactory").as("Box4.Actors.IBox4WordConverterFactory").ma().na(()=>new eC(u.AFrameworkApplication.fa));a.register(590,"Box4.Actors.IExternalPasteCssConverter").ma().na(()=>new OH(u.AFrameworkApplication.fa));
a.register(591,"Box4.ISelectionCommands").ma().na(()=>new CI(u.AFrameworkApplication.Va));a.register(592,"Box4.ITextFormattingCommands").ma().na(()=>new BI(u.AFrameworkApplication.Va));a.register(UB,"Box4.Actors.AccessibilityActor").ma().na(()=>new UB(a.Oa("Box4.Accessibility.IAccessibilityContextManager"),a.resolve("Box4.Proofing.IErrorRangeEditor")));a.register(tq,"Box4.Actors.InsertionPointFormatting").as("Box4.IInsertionPointFormatting").ma().na(()=>new tq(a.qb("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy")));
a.register(sC,"Box4.Actors.ProofingActor").ma().na(()=>new sC(lb.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),u.AFrameworkApplication.Va,()=>lb.a.instance.resolve("Box4.UI.ILanguageDialog"),lb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),lb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),dd.a.instance,lb.a.instance.Oa("Box4.IExternalSelectionManager"),ni.a.instance,lb.a.instance.resolve("Box4.ISelectionContextMenuProvider"),Rf.a.instance,cd.a.instance,lb.a.instance.resolve("Box4.IContextMenuController"),
lb.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),lb.a.instance.Oa("Box4.Actors.IProofingErrorPresenter"),I.a.instance));a.register(tC,"Box4.Actors.StyleActor").ma().na(()=>new tC(lb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),lb.a.instance.resolve("Box4.Styles.IStyleEditor"),QP.a.instance,lb.a.instance.resolve("Box4.IFormattingEditor"),xi.ContextSetEditor.instance,lb.a.instance.resolve("Box4.IInsertionPointFormatting"),Rf.a.instance,cd.a.instance,lb.a.instance.resolve("Box4.TextFormattingHelper"),
Tt.instance));a.register(pd,"Box4.Actors.TextFormattingActor").ma().na(()=>new pd(a.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),a.resolve("Box4.Actors.IEopFormattingStrategy"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.IHyperlinkStrategy"),oa.InteractiveViewManager.instance));a.register(VB,"Box4.Actors.AutoCorrectActor").ma().na(()=>new VB(u.AFrameworkApplication.Va,cd.a.instance,()=>lb.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog")))}}Object(e.a)(GI,
"Box4ActorsComponentConfiguration",null,[3]);const SP=(a,b,c)=>gb.App.jRd?8:2===c?(a=new hf.StandardDialog,a.vd=4,a.hwa(1),a.Pe(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.Pe(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),a.dal(RP),32):2,RP=a=>{1===a&&u.AFrameworkApplication.Va.processAction(D.a.ZRd,2)},HI=(a,b,c)=>{if(gb.App.jRd)return 8;if(1===c)return b.node.Sa(ob.a.embeddedFileContainer)?32:2;if(2===c&&(b.contextId===Db.a.view&&b.view.Eb&&(b=b.view.Eb.Dj),hb.EmbeddedFileReader.kDj(b))){a=
hb.EmbeddedFileReader.CYd(b.node);Di.a.m4k();try{TP(a)}catch(f){Z.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",f)}}return 32},TP=a=>{if(1!==gb.App.mode||!u.AFrameworkApplication.fa.ka("OneNoteSaveFileThroughRequest")||u.AFrameworkApplication.fa.ka("IsTeamsSession")&&r.a.sS)window.open(a);else{var b=(new Wm.QueryStringBuilder(a)).j7i(),c=new XMLHttpRequest;c.onloadstart=()=>{c.responseType="blob"};c.open("GET",a,!0);c.onload=()=>{try{const F=c.response;let S=b;S||(S="GetImage",
F.type&&-1!=F.type.indexOf("image/")&&"bmp gif ico jpeg png svg tiff webp".split(" ").forEach(fa=>{-1!=F.type.indexOf(fa)&&(S="GetImage."+fa)}));S=decodeURIComponent(escape(S));if(r.a.uS)"undefined"!==typeof navigator.msSaveBlob?navigator.msSaveBlob(F,S):window.open(a);else{var f=window.URL||window.webkitURL,l=f.createObjectURL(F),w=document.createElement("a");w.href=l;w.download=S;document.body.appendChild(w);w.click();setTimeout(()=>{document.body.removeChild(w);f.revokeObjectURL(l)},0)}}catch(F){window.open(a)}};
c.send()}};var UP=d(544),uq=d(1183),iv;(function(a){a[a.automatic=1]="automatic";a[a.clear=2]="clear";a[a.themeColors=3]="themeColors";a[a.standardColors=4]="standardColors";a[a.recentColors=5]="recentColors"})(iv||(iv={}));Object(e.b)("ColorMenuControls",iv);class lx{constructor(a){this.COb=this.DOb=null;this.zpc={};this.h1=a}F2b(){this.COb=this.DOb=null}V4f(a,b){if(this.COb)return this.COb;if(!a)return null;const c=Object.assign(new Kl.a,{Id:String.format("menu{0}Color",this.h1),ExternalId:String.format("{0}Color",
this.h1)});c.MenuSectionList=[];Array.add(c.MenuSectionList,this.SXh());Array.add(c.MenuSectionList,this.aYh());Array.add(c.MenuSectionList,this.u0h(a,b));Array.add(c.MenuSectionList,this.d0h());return this.COb=c}Eui(a,b){if(this.DOb)return this.DOb;a=this.V4f(a,b);return this.DOb=$i.l(a)}$yc(a,b){iv[a]in this.zpc||(this.zpc[iv[a]]=b)}y0h(a){a.Szf(Object(C.a)(this,this.F2b,"invalidateMenu"),1)}SXh(){if(!({actionId:b}=this.Dkd(1)).returnValue)return null;const a=Object.assign(new nk.a,{Id:String.format("{0}Color",
this.h1),ControlsId:String.format("{0}.Color.Menu.Controls",this.h1),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new Of.a,{Command:b.toString(),LabelText:Ja.a.le(Box4Intl.Box4Strings.L_Automatic),Image16by16:u.AFrameworkApplication.Rl,Image16by16Class:rp.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});Array.add(a.ControlList,b);return a}aYh(){if(!({actionId:b}=this.Dkd(2)).returnValue)return null;const a=Object.assign(new nk.a,{Id:String.format("{0}Color",
this.h1),ControlsId:String.format("{0}.Color.Menu.Controls",this.h1),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new Of.a,{Command:b.toString(),LabelText:Ja.a.le(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:u.AFrameworkApplication.Rl,Image16by16Class:rp.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});Array.add(a.ControlList,b);return a}u0h(a,b){if(!({actionId:f}=this.Dkd(3)).returnValue)return null;const c=Object.assign(new nk.a,{Id:"Colors",
ControlsId:String.format("{0}.Color.Menu.Controls",this.h1),ControlList:[]});var f=Object.assign(new My.a,{Id:String.format("Theme{0}ColorPicker",this.h1),ExternalId:String.format("Theme{0}ColorPicker",this.h1),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.h1),McuLayout:!0,Command:f.toString(),Width:10});f.Colors=lx.xdj(a,b);Array.add(c.ControlList,f);return c}d0h(){if(!({actionId:b}=this.Dkd(4)).returnValue)return null;const a=Object.assign(new nk.a,{Id:String.format("{0}Colors",this.h1),
ControlsId:String.format("{0}.Color.Menu.Controls",this.h1),Title:Ja.a.le(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var b=Object.assign(new My.a,{Id:String.format("Standard{0}ColorPicker",this.h1),ExternalId:String.format("Standard{0}ColorPicker",this.h1),Command:b.toString(),Width:10,Colors:[]});b.Colors=lx.Ebj();Array.add(a.ControlList,b);return a}Dkd(a){a=iv[a];return a in this.zpc?{returnValue:!0,actionId:this.zpc[a]}:{returnValue:!1,actionId:0}}static Ebj(){const a=[];a.push(Object.assign(new uq.a,
{Color:"0000C0",Alt:Ja.a.le(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));a.push(Object.assign(new uq.a,{Color:"0000FF",Alt:Ja.a.le(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));a.push(Object.assign(new uq.a,{Color:"00C0FF",Alt:Ja.a.le(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));a.push(Object.assign(new uq.a,{Color:"00FFFF",Alt:Ja.a.le(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));a.push(Object.assign(new uq.a,{Color:"50D092",
Alt:Ja.a.le(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));a.push(Object.assign(new uq.a,{Color:"50B000",Alt:Ja.a.le(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));a.push(Object.assign(new uq.a,{Color:"F0B000",Alt:Ja.a.le(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));a.push(Object.assign(new uq.a,{Color:"C07000",Alt:Ja.a.le(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));a.push(Object.assign(new uq.a,{Color:"602000",
Alt:Ja.a.le(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));a.push(Object.assign(new uq.a,{Color:"A03070",Alt:Ja.a.le(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return a}static xdj(a,b){const c=a.properties.ta(Sb.a.themeColors,null);a=a.properties.getValue(Sb.a.Ruh).split(" ");const f=Array(10);f[0]=Box4Intl.Box4Strings.l_ThemeLabel1;f[1]=Box4Intl.Box4Strings.l_ThemeLabel2;f[2]=Box4Intl.Box4Strings.l_ThemeLabel3;f[3]=Box4Intl.Box4Strings.l_ThemeLabel4;f[4]=
Box4Intl.Box4Strings.l_ThemeLabel5;f[5]=Box4Intl.Box4Strings.l_ThemeLabel6;f[6]=Box4Intl.Box4Strings.l_ThemeLabel7;f[7]=Box4Intl.Box4Strings.l_ThemeLabel8;f[8]=Box4Intl.Box4Strings.l_ThemeLabel9;f[9]=Box4Intl.Box4Strings.l_ThemeLabel10;const l=[];for(let S=0;6>S;S++)for(let fa=0;10>fa;fa++){var w=10*S+fa,F=c[w];w=w+1<<24;F=F&4278190080|(F&255)<<16|F&65280|(F&16711680)>>>16;const xa=lx.zkl(f,S,fa,b[a[fa]],c[fa]);l.push(Object.assign(new uq.a,{Color:Ja.a.Dv(w,8),DisplayColor:"#"+Ja.a.Dv(F,6),Alt:Ja.a.le(xa)}))}return l}static zkl(a,
b,c,f,l){if(b){var w=l&255,F=(l&65280)>>>8;l=(l&16711680)>>>16;w=Math.floor((Math.min(Math.min(w,F),l)+Math.max(Math.max(w,F),l))/2);--b;w?255===w?(w=!0,b=[242,217,191,166,127][b]):204<w?(w=!1,b=[229,191,127,64,25][b]):51>w?(w=!0,b=[25,64,127,191,229][b]):(F=[51,102,153],l=[191,127],b=(w=b<F.length)?F[b]:l[b-F.length]):(w=!1,b=[127,166,191,217,242][b]);b=255-b;return String.format(w?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,f,a[c],Math.round(100*
b/255))}return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,f,a[c])}}Object(e.a)(lx,"ColorMenu",null,[626]);class Yq{constructor(a){this.ypc=null;this.WOh=a}get M3f(){this.ypc||(this.ypc=new lx(Yq.pni),this.Gvj(this.ypc));return this.ypc}Gvj(a){a.$yc(1,D.a.YU);a.$yc(3,D.a.Ms);a.$yc(4,D.a.Ms);a.$yc(5,D.a.Ms);a.y0h(this.WOh)}wb(){const a=u.AFrameworkApplication.Va;a.ya(D.a.RCb,Db.a.view,Object(C.a)(this,this.RCb,"populateFontColor"));a.$d(D.a.RCb,1127)}RCb(a,b,c,f,l){if(1===c)return 32;
if(2===c&&!l)return 8;a=Yq.hk.X6i(b);if(u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.Ip){b=this.M3f.V4f(a,gb.App.TNf);if(!b)return 8;l.MenuItems=b}a=this.M3f.Eui(a,gb.App.TNf);if(!a)return 8;l.PopulationXML=a;return 32}static D1i(){return new Yq(UP.a.instance)}static get instance(){return Yq.Zs||(Yq.Zs=Yq.D1i())}static get hk(){return $u.PageReader.instance}}Yq.pni="Font";Yq.Zs=null;Object(e.a)(Yq,"FontColorActor",null,[]);class $e{constructor(a){this.vfa=this.Go=this.c1=null;this.qNb=
!1;this.Gg=oa.InteractiveViewManager.instance.Jd;this.Fj=a;$e.CR&&Cb.SelectionEditor.Oj(a)&&(a=Cb.SelectionEditor.Cmc(this.Fj),Cb.SelectionEditor.Oj(a)?this.Fj=a:Z.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));a=Cb.SelectionEditor.xIb(this.Fj);Cb.SelectionEditor.Oj(a)&&(this.Fj=a)}get s7(){return this.c1||(this.c1=lb.a.instance.qb("Box4.IInternalLinkManager"))}get e5(){return this.Go||(this.Go=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get Rlg(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}Z_f(a,
b,c){if(b!==this.Fj.Lb||a!==this.Fj.Qa)a=fd.SelectionFactory.PY(c,a,b),this.Gg.Eb.setSelection(a),this.Fj=Cb.SelectionEditor.xIb(a.Wa.clone())}$7f(a){let b,c,f,l;l=fb.HyperlinkReader.V_b(this.Fj);c=this.Fj.Qa;f=this.Fj.Lb;b="";if(!l.length)return this.vfa=a.substring(this.Fj.Qa,this.Fj.Lb),{returnValue:!0,Ied:b,fIc:c,gIc:f,vPc:l};if(l[0].hyperlink){let w,F=0,S=Math.max(0,a.length-1),fa=0;for(let xa=0;xa<l.length;xa++)l[xa].Qa>=F&&({Qa:w,Lb:F}=$e.ut.cZ(this.Fj,l[xa]),S=Math.min(w,S),fa=Math.max(F,
fa));c=Math.min(S,c);f=Math.max(fa,f);this.vfa=a.substring(c,f);c===S&&(b=l[0].hyperlink.url);return{returnValue:!0,Ied:b,fIc:c,gIc:f,vPc:l}}return{returnValue:!1,Ied:b,fIc:c,gIc:f,vPc:l}}lQc(a,b){if(this.Gg.Oo){var c=$e.Kra?fb.HyperlinkReader.V_b(this.Fj):fb.HyperlinkReader.HB(this.Fj,!0);var f=this.Gg.Eb.Pa.kb;if(f){f=f.Wa;db.ParagraphReader.Tl(f)&&(f=Fc.a.createTextRange(f.node,0,db.ParagraphReader.textLength(f.node)));if($e.CR&&Cb.SelectionEditor.Oj(f)){var l=Cb.SelectionEditor.Cmc(f);Cb.SelectionEditor.Oj(l)?
f=l:Z.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}l=Cb.SelectionEditor.xIb(f);Cb.SelectionEditor.Oj(l)&&(f=l);0===a||I.a.instance.ga(22)&&32!==u.AFrameworkApplication.Va.li(f,D.a.insertHyperlink,1,!0,null,null)||this.LFj(c)||!this.Fj.equals(f)?this.Gg.PQ():(Me.a.mark(5562),I.a.instance.ga(50)&&gb.App.Hh&&gb.App.Hh.Nv&&this.Gg.Eb.WRb(),a=new Oe.GraphTransaction(15),a.hd(this.Fj.node),this.Fj.node.kG().graphTransactionOperations.Lga(4),
f=b.txtDisplay,b=b.txtLink.trim(),this.insertLink(f,b,c),a.dispose(),Me.a.mark(5563),this.D1())}else Z.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}LFj(a){return $e.Kra?!1:1<a.length||1===a.length&&(a[0].Qa>this.Fj.Qa||a[0].Lb<this.Fj.Lb)}insertLink(a,b,c){var f=null;a||(a=b);if(b&&(!c.length||b!==c[0].hyperlink.url)){b=fb.HyperlinkReader.bCa(b);var l="";this.s7&&({uah:l}=this.s7.Bwh(b,!1)).returnValue&&(b=l)}this.qNb||(a=$e.hyperlinkEditor.CPk(a));
if((!c.length||$e.Kra)&&b)(f=0<c.length)&&$e.ut.hEb(this.Fj,c),c=!0,$e.WFj&&(c=db.ParagraphReader.text(this.Fj.node).substring(this.Fj.Qa,this.Fj.Lb)!==a),c&&$e.characterPropertiesEditor.replaceTextRange(this.Fj,a,!0),c=Fc.a.createTextRange(this.Fj.node,this.Fj.Qa,this.Fj.Qa+a.length),$e.hyperlinkEditor.iha(c,b,f,!1),f=fd.SelectionFactory.Lg(this.Fj.node,this.Fj.Qa+a.length);else if(0<c.length){l=c[0];let w;const F=({Qa:c,Lb:w}=$e.ut.cZ(this.Fj,l)).returnValue;if(b)if(l.hyperlink.GQa){if(b!==l.hyperlink.url)if($e.Mf.nIb){let S=
Fc.a.createTextRange(this.Fj.node,c,c+a.length);$e.hyperlinkEditor.GHi(S,l.hyperlink,b)}else $e.ut.Uzh(b,F);a!==this.vfa&&($e.ut.tse()&&$e.ut.hEb(this.Fj,F),$e.characterPropertiesEditor.replaceTextRange(Fc.a.createTextRange(this.Fj.node,c,w),a,!0),f=Fc.a.createTextRange(this.Fj.node,c,c+a.length),$e.ut.tse()&&$e.hyperlinkEditor.iha(f,b,!1),f=fd.SelectionFactory.Lg(this.Fj.node,c+a.length))}else $e.ut.hEb(this.Fj,F),$e.characterPropertiesEditor.replaceTextRange(Fc.a.createTextRange(this.Fj.node,c,
w),a,!0),f=Fc.a.createTextRange(this.Fj.node,c,c+a.length),$e.hyperlinkEditor.iha(f,b,!1),f=fd.SelectionFactory.Lg(this.Fj.node,c+a.length);else $e.hyperlinkEditor.jO(l.paragraph,l.hyperlink)}f&&this.Gg.Eb.setSelection(f)}static get hyperlinkEditor(){return $e.Tm||($e.Tm=lb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return $e.Vg||($e.Vg=lb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Mf(){return $e.Yc||($e.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get ut(){return $e.HC||
($e.HC=lb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Kra(){null==$e.vZa&&($e.vZa=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return $e.vZa}static get WFj(){null==$e.Iud&&($e.Iud=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("KeepHyperlinkFormatFixIsEnabled"):!1);return $e.Iud}static get i8a(){null==$e.g0a&&($e.g0a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return $e.g0a}static get CR(){null==
$e.dM&&($e.dM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return $e.dM}}$e.Tm=null;$e.Vg=null;$e.Yc=null;$e.HC=null;$e.vZa=null;$e.Iud=null;$e.g0a=null;$e.dM=null;$e.source="Source";$e.hOf="CommandingInterface";$e.w4a="DisplayText";$e.url="Url";$e.id="InsertLinkDialog";Object(e.a)($e,"AInsertLinkDialog",null,[109]);class mx{static get Wf(){return Th.a.tA(mx.Ym,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}
mx.Ym="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(e.a)(mx,"InsertLinkDialogHtml",null,[]);class II extends $e{constructor(a,b){super(a,b);this.wf=
new Th.a;this.wf.kg=$e.id;var c=this.vfa="";const f=db.ParagraphReader.text(this.Fj.node);let l=this.Fj.Qa,w=this.Fj.Lb,F;$e.Kra?{Ied:c,fIc:l,gIc:w,vPc:F}=this.$7f(f):(F=fb.HyperlinkReader.HB(this.Fj,!0),1===F.length&&F[0].Qa<=this.Fj.Qa&&F[0].Lb>=this.Fj.Lb&&F[0].hyperlink?(this.vfa=$e.ut.ILc(a,F[0],f),c=F[0].hyperlink.url):F.length||(this.vfa=f.substring(this.Fj.Qa,this.Fj.Lb)));(b=Object(ua.a)(Object,b))&&(b[$e.source]&&b[$e.source]===$e.hOf||b[$e.url]&&b[$e.w4a])?this.insertLink(b[$e.w4a],b[$e.url],
F):($e.Kra&&F[0]&&this.Z_f(l,w,F[0].paragraph),this.wf.Wf=mx.Wf,""===c.trim()&&this.wf.Pe(1,this.Rlg),c={["txtLink"]:c,["txtDisplay"]:this.vfa},this.wf.mGc=Object(C.a)(this,this.MM,"dialogDefaultEnterKeyHandler"),this.wf.lGc=Object(C.a)(this,this.MM,"dialogDefaultEnterKeyHandler"),this.wf.qj(this.titleText,Object(C.a)(this,this.lQc,"insertLinkDialogHandler"),c),$e.i8a&&(c=document.getElementById("txtLink"),ad.a.addHandler(c,ra.a.input,Object(C.a)(this,this.GGa,"onLinkChanged")),ad.a.addHandler(c,
ra.a.change,Object(C.a)(this,this.GGa,"onLinkChanged"))),document.getElementById("txtLink").focus(),$e.CR?0<zg.h(Fc.a.MNa(l,w,!1,this.Fj.node)).length&&(this.qNb=!0,document.getElementById("txtDisplay").disabled=!0):1>=F.length&&$e.ut.oNd(a,F[0],1===F.length)&&(this.qNb=!0,document.getElementById("txtDisplay").disabled=!0))}GGa(){if(this.wf){const a=document.getElementById("txtLink");this.wf.rC(1,!a||!a.value.length||fb.HyperlinkReader.rae(a.value))}}MM(a){return this.wf?$e.i8a?this.wf.j6f(this.wf.cjb)?
this.wf.MM(a):!1:this.wf.MM(a):!1}D1(){if($e.i8a){const a=document.getElementById("txtLink");a&&(ad.a.removeHandler(a,ra.a.change,Object(C.a)(this,this.GGa,"onLinkChanged")),ad.a.removeHandler(a,ra.a.input,Object(C.a)(this,this.GGa,"onLinkChanged")))}this.wf&&(this.wf=null)}}Object(e.a)(II,"InsertLinkDialog",$e,[]);class JI extends $e{constructor(a,b,c){super(a,b);const f=new Th.a(!1,!1,!0),l={};l.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;l.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
l.textDisplayInitialFocus=c;c=this.vfa="";const w=db.ParagraphReader.text(this.Fj.node);let F=this.Fj.Qa,S=this.Fj.Lb,fa;$e.Kra?{Ied:c,fIc:F,gIc:S,vPc:fa}=this.$7f(w):(fa=fb.HyperlinkReader.HB(this.Fj,!0),1===fa.length&&fa[0].Qa<=this.Fj.Qa&&fa[0].Lb>=this.Fj.Lb&&fa[0].hyperlink?(this.vfa=$e.ut.ILc(a,fa[0],w),c=fa[0].hyperlink.url):fa.length||(this.vfa=w.substring(this.Fj.Qa,this.Fj.Lb)));(b=Object(ua.a)(Object,b))&&(b[$e.source]&&b[$e.source]===$e.hOf||b[$e.url]&&b[$e.w4a])?this.insertLink(b[$e.w4a],
b[$e.url],fa):($e.Kra&&fa[0]&&this.Z_f(F,S,fa[0].paragraph),b=CommonUIStrings.l_DialogOk,""===c.trim()&&(b=this.Rlg),f.Pe(1,b),l.txtLink=c,l.txtDisplay=this.vfa,$e.CR?0<zg.h(Fc.a.MNa(F,S,!1,this.Fj.node)).length&&(this.qNb=!0,l.textDisplayDisabled=!0):1>=fa.length&&$e.ut.oNd(a,fa[0],1===fa.length)&&(this.qNb=!0,l.textDisplayDisabled=!0),a={["id"]:$e.id,["bodyControls"]:l},f.qj(this.titleText,Object(C.a)(this,this.lQc,"insertLinkDialogHandler"),a))}D1(){}}Object(e.a)(JI,"ReactInsertLinkDialog",$e,
[]);class Vt{constructor(){this.doa=!!u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.QB}tRf(a,b,c){this.doa?new JI(a,b,c):new II(a,b)}static get instance(){return Vt.Ka||(Vt.Ka=new Vt)}}Vt.Ka=null;Object(e.a)(Vt,"InsertLinkDialogFactory",null,[750]);class Nk extends Th.a{constructor(a){super();this.OJ=a;this.Gg=oa.InteractiveViewManager.instance.Jd;this.q1a=this.Gg.Eb.Pa.kb;this.rVd=a[0].Qa;this.Tae=a[a.length-1].Lb;this.kg="InsertMultiParagraphLinkDialog";a=this.Brl();this.showDialog("",
a)}showDialog(a,b){Z.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.Wf=mx.Wf;""===b.trim()&&this.Pe(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);a={["txtLink"]:b,["txtDisplay"]:a};this.qj(Box4Intl.Box4Strings.l_InsertLinkTitle,Object(C.a)(this,this.lQc,"insertLinkDialogHandler"),a);document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;Nk.i8a&&(a=document.getElementById("txtLink"),ad.a.addHandler(a,ra.a.input,Object(C.a)(this,
this.GGa,"onLinkChanged")),ad.a.addHandler(a,ra.a.change,Object(C.a)(this,this.GGa,"onLinkChanged")))}hide(){if(Nk.i8a){const a=document.getElementById("txtLink");a&&(ad.a.removeHandler(a,ra.a.change,Object(C.a)(this,this.GGa,"onLinkChanged")),ad.a.removeHandler(a,ra.a.input,Object(C.a)(this,this.GGa,"onLinkChanged")))}super.hide()}GGa(){const a=document.getElementById("txtLink");this.rC(1,!a||!a.value.length||fb.HyperlinkReader.rae(a.value))}MM(a){return Nk.i8a?this.j6f(this.cjb)?super.MM(a):!1:
super.MM(a)}Brl(){let a;let b;a="";const c=this.OJ.length,f=fb.HyperlinkReader.HB(this.OJ[0],!1);0<f.length&&({Qa:l,Lb:b}=Nk.ut.cZ(this.OJ[0],f[0]),l<=this.OJ[0].Qa&&(a=f[0].hyperlink.url),this.rVd=Math.min(this.rVd,l));var l=fb.HyperlinkReader.HB(this.OJ[c-1],!1);0<l.length&&({Qa:l,Lb:b}=Nk.ut.cZ(this.OJ[c-1],l[l.length-1]),this.Tae=Math.max(this.Tae,b));this.Rml(this.rVd,this.Tae);return a}Rml(a,b){const c=this.OJ.length;if(a!==this.OJ[0].Qa||b!==this.OJ[c-1].Lb){a=Fc.a.Wj(this.OJ[0].node,a);a=
fd.SelectionFactory.Zt(a);b=Fc.a.Wj(this.OJ[c-1].node,b);b=fd.SelectionFactory.SM(a,b);a=this.Xdg(b.Wa.clone());const f=this.Xdg(b.We.clone());a&&f&&(this.OJ[0]=a,this.OJ[c-1]=f,this.Gg.Eb.setSelection(b),this.q1a=b)}}lQc(a,b){if(this.Gg.Oo){var c=this.Gg.Eb.Pa.kb;if(c)if(c.equals(this.q1a)&&0!==a){a=new Oe.GraphTransaction(15);a.hd(this.OJ[0].node);for(c=0;c<this.OJ.length;c++)this.OJ[c].node.kG().graphTransactionOperations.Lga(4);b=b.txtLink.trim();this.ICi();this.mxj(b);this.hide();a.dispose()}else this.Gg.PQ()}}mxj(a){if(a){a=
fb.HyperlinkReader.bCa(a);for(let c=0;c<this.OJ.length;c++){var b=this.OJ[c];if(Nk.CR&&Cb.SelectionEditor.Oj(b)&&(b=Cb.SelectionEditor.Cmc(b),!Cb.SelectionEditor.Oj(b)))continue;b=Fc.a.createTextRange(this.OJ[c].node,b.Qa,b.Lb);Nk.hyperlinkEditor.iha(b,a,!1)}}}Xdg(a){return db.ParagraphReader.Tl(a)&&!Cb.SelectionEditor.BV(a)&&db.ParagraphReader.textLength(a.node)?Fc.a.createTextRange(a.node,0,db.ParagraphReader.textLength(a.node)):Cb.SelectionEditor.Oj(a)?a:null}ICi(){let a=!1;for(const b of this.OJ){const c=
fb.HyperlinkReader.HB(b,!1);c&&(a=Nk.ut.hEb(b,c)||a)}}static get ut(){return Nk.HC||(Nk.HC=lb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Mf(){return Nk.Yc||(Nk.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hyperlinkEditor(){return Nk.Tm||(Nk.Tm=lb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get CR(){null==Nk.dM&&(Nk.dM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Nk.dM}static get i8a(){null==
Nk.g0a&&(Nk.g0a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return Nk.g0a}}Nk.HC=null;Nk.Yc=null;Nk.Tm=null;Nk.dM=null;Nk.g0a=null;Object(e.a)(Nk,"InsertMultiParagraphLinkDialog",Th.a,[]);class ue{static get Vi(){return Rf.a.instance}static get hyperlinkEditor(){return ue.Tm||(ue.Tm=lb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get ut(){return ue.HC||(ue.HC=lb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static Eq(){return ue.jm||(ue.jm=
lb.a.instance.Oa("Box4.IExternalSelectionManager"))}static get Mf(){return ue.Yc||(ue.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get xmc(){return ue.PC||(ue.PC=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get xJb(){null==ue.ond&&(ue.ond=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("ViewAndOpenImageHyperlinksIsEnabled"):!1);return ue.ond}static get Kra(){null==ue.vZa&&(ue.vZa=u.AFrameworkApplication.fa?
u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return ue.vZa}static get Wbc(){null==ue.wZa&&(ue.wZa=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return ue.wZa}static get CR(){null==ue.dM&&(ue.dM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return ue.dM}static wb(){const a=u.AFrameworkApplication.Va;a.ya(D.a.insertHyperlink,Db.a.view,ue.itb);a.ya(D.a.insertHyperlink,
Db.a.Ff,ue.insertLink);a.ya(D.a.insertHyperlink,Db.a.textRange,ue.insertLink);a.$d(D.a.insertHyperlink,1028);a.ya(D.a.jO,Db.a.view,ue.itb);a.ya(D.a.jO,Db.a.Ff,ue.$ah);a.ya(D.a.jO,Db.a.textRange,ue.$ah);a.$d(D.a.jO,1028);a.ya(D.a.xGe,Db.a.view,ue.itb);a.ya(D.a.xGe,Db.a.Ff,ue.Bhh);a.ya(D.a.xGe,Db.a.textRange,ue.Bhh);a.ya(D.a.VVa,Db.a.view,ue.itb);a.ya(D.a.VVa,Db.a.Ff,ue.S0g);a.ya(D.a.VVa,Db.a.textRange,ue.S0g);a.ya(D.a.VVa,Db.a.image,ue.nwe);a.ya(D.a.VVa,Db.a.gZb,ue.nwe);a.ya(D.a.U1b,Db.a.view,ue.itb);
a.ya(D.a.U1b,Db.a.Ff,ue.linkText);a.ya(D.a.U1b,Db.a.textRange,ue.linkText);a.$d(D.a.U1b,1028);ue.xJb&&a.ya(D.a.VVa,Db.a.anchoredObject,ue.nwe);a.ya(D.a.SNd,Db.a.view,ue.itb)}static itb(a,b,c,f,l){if(ue.Wbc)return ue.crj(a,b,c,f,l);if(!b.view.Jh)return 2;var w=b.view.Eb;if(!w||!w.Pa||!w.Pa.length)return 8;var F=w.Pa.kb;let S=F.Wa.clone();if(2===F.length){if(F=F.ga(1),!Cb.SelectionEditor.Oj(S)||!Cb.SelectionEditor.Bl(F)||S.node!==F.node)return 8}else if(2<F.length)return 8;if(w.Pa.uG)return 8;db.ParagraphReader.Tl(S)&&
!Cb.SelectionEditor.BV(S)&&(w=S.node,S=Fc.a.createTextRange(w,0,db.ParagraphReader.textLength(w)));return a===D.a.SNd?ue.gQf(b,S,c,f,l):u.AFrameworkApplication.Va.li(S,a,c,!0,f,l)}static crj(a,b,c,f,l){if(!b.view.Jh)return 2;var w=b.view.Eb;if(!w||!w.Pa||!w.Pa.length||w.Pa.uG)return 8;var F=w.Pa.kb;if(w=ue.u4b(F))F=ue.o1d(F.Wa.clone(),!0);else{let S=F.ga(0).clone(),fa=1;for(;fa<F.length&&(!db.ParagraphReader.textLength(S.node)||Cb.SelectionEditor.Bl(S)||ue.CR&&zg.m(S));)S=F.ga(fa).clone(),fa++;F=
ue.o1d(S,!1)}return ue.CR&&Cb.SelectionEditor.Oj(F)&&zg.m(F)||!Cb.SelectionEditor.Oj(F)&&!w?8:a===D.a.SNd?ue.gQf(b,F,c,f,l):u.AFrameworkApplication.Va.li(F,a,c,!0,f,l)}static u4b(a){if(1===a.length)return!0;if(2===a.length){const b=a.Wa.clone();a=a.ga(1);return Cb.SelectionEditor.Oj(b)&&Cb.SelectionEditor.Bl(a)&&b.node===a.node?!0:!1}return!1}static MOf(a){let b;b=null;const c=[];for(let f=0;f<a.length;f++){const l=ue.o1d(a.ga(f).clone(),!1);if(Cb.SelectionEditor.Oj(l))ue.CR&&zg.m(l)||Array.add(c,
l);else if(!Cb.SelectionEditor.Bl(l)&&!db.ParagraphReader.Tl(l))return{returnValue:!1,HNd:b}}b=Ma.a.eIb(c);return{returnValue:!ue.CR||0<b.length?!0:!1,HNd:b}}static Wlg(a,b,c,f){if(ue.Wbc)return ue.rxj(a,b,c,f);if(!ue.RKd()||!ue.cCc(a)||dd.a.instance.Pa.uG)return 8;if(ue.xJb&&Cb.SelectionEditor.dDa(a))return 2;let l;if(!({hyperlink:l}=ue.aSa(a,!0)).returnValue||ue.WDc())return 8;if(1===b)return 32;if(!l&&Cb.SelectionEditor.Mg(a)&&Cb.SelectionEditor.bvb(a)&&(b=Cb.SelectionEditor.TOa(a,!1))&&(dd.a.instance.setSelection(b),
a=b.Wa,ue.WDc()))return 8;Vt.instance.tRf(a,c,f);return 32}static rxj(a,b,c,f){var l=dd.a.instance.Pa.kb;const w=ue.u4b(l);if(w)a=[a];else if(!({HNd:a}=ue.MOf(l)).returnValue)return 8;if(!ue.RKd())return 8;for(l=0;l<a.length;l++)if(!ue.cCc(a[l]))return 8;if(dd.a.instance.Pa.uG)return 8;l=Array(a.length);let F=null;for(let S=0;S<a.length;S++)if(l[S]=a[S],!({hyperlink:F}=ue.aSa(l[S],!0)).returnValue||ue.WDc())return 8;if(f&&!ue.PNj(l[0]))return 8;if(1===b)return 32;if(!F&&1===l.length&&w&&Cb.SelectionEditor.Mg(l[0])&&
Cb.SelectionEditor.bvb(l[0])&&(b=Cb.SelectionEditor.TOa(l[0],!1))&&(dd.a.instance.setSelection(b),l[0]=b.Wa,ue.WDc()))return 8;w?Vt.instance.tRf(l[0],c,f):new Nk(l,c);return 32}static insertLink(a,b,c,f,l){return ue.Wlg(b,c,l,!1)}static linkText(a,b,c,f,l){return ue.Wlg(b,c,l,!0)}static $ah(a,b,c){if(ue.Wbc)return ue.zLk(a,b,c);if(!ue.cCc(b)||ue.xJb&&Cb.SelectionEditor.dDa(b))return 2;let f;if(!({hyperlink:f}=ue.aSa(b,!1)).returnValue)return 2;if(2===c){c=new Oe.GraphTransaction(15);try{c.fd=a,c.hd(f.paragraph),
ue.Kra?ue.qbh(b):ue.ut.jO(b,f)}finally{c&&c.dispose()}}return 32}static zLk(a,b,c){var f=dd.a.instance.Pa.kb;if(ue.u4b(f))b=[b];else if(!({HNd:b}=ue.MOf(f)).returnValue)return 8;if(!ue.RKd())return 8;for(f=0;f<b.length;f++)if(!ue.cCc(b[f]))return 8;if(1===c&&!ue.aSa(b[0],!1).returnValue)return 2;if(2===c){for(c=0;c<b.length;c++)if(!ue.aSa(b[c],!0).returnValue)return 2;c=new Oe.GraphTransaction(15);try{let l=b[0];c.fd=a;c.hd(l.node);for(a=0;a<b.length;a++)ue.qbh(b[a])}finally{c&&c.dispose()}}return 32}static qbh(a){const b=
fb.HyperlinkReader.V_b(a);let c=0;for(let f=0;f<b.length;f++)if(b[f].Qa>=c){const l=({Lb:c}=ue.ut.cZ(a,b[f])).returnValue;ue.ut.hEb(a,l)}}static Bhh(a,b,c){if(ue.xJb&&cb.ImageReader.Wtb(b)||!({hyperlink:a}=ue.aSa(b,!1)).returnValue)return 2;2===c&&({Qa:b,Lb:c}=ue.ut.cZ(b,a),dd.a.instance.setSelection(fd.SelectionFactory.PY(a.paragraph,b,c)));return 32}static S0g(a,b,c){let f;if(ue.xJb&&({hyperlink:f}=ue.DNj(b)).returnValue)Z.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");
else if(!({hyperlink:f}=ue.aSa(b,!1)).returnValue)return 2;2===c&&gb.App.oZb(f.hyperlink.url);return 32}static nwe(a,b,c){a=cb.ImageReader.cZ(b.node);if(!a)return 2;2===c&&gb.App.oZb(a);return 32}static gQf(a,b,c,f,l){if(ue.xJb&&cb.ImageReader.Wtb(b))return 2;const w=oa.InteractiveViewManager.instance.editingView;if(!w.Al)return 2;let F;if(!({hyperlink:F}=ue.aSa(b,!1)).returnValue)return 2;if(1===c)return 32;({Qa:b,Lb:c}=ue.ut.cZ(b,F));dd.a.instance.setSelection(fd.SelectionFactory.PY(F.paragraph,
b,c));var S=w.ownerDocument;c=w.vn;b=new mg.a(c);ya.a.Vt(c);S=S.createElement("span");c.appendChild(S);S.innerText=F.hyperlink.url;w.PHa();w.C2k();a=u.AFrameworkApplication.Va.li(a,D.a.copy,2,!0,f,l);b.restore();return a}static aSa(a,b){let c;c=null;if(Cb.SelectionEditor.Oj(a)){var f=zg.h(a);const l=Ma.a.all(f,w=>6===w.wq);if(0<f.length&&(!ue.CR||!l))return{returnValue:!1,hyperlink:c}}if(ue.Kra)return ue.zNj(a,b);f=fb.HyperlinkReader.HB(a,!0);return 1===f.length&&f[0].Qa<=a.Qa&&f[0].Lb>=a.Lb&&f[0].hyperlink?
(c=f[0],{returnValue:!0,hyperlink:c}):{returnValue:!f.length&&b,hyperlink:c}}static DNj(a){let b;b=null;return cb.ImageReader.Wtb(a)&&(b=fb.HyperlinkReader.KLc(a))?{returnValue:!0,hyperlink:b}:{returnValue:!1,hyperlink:b}}static zNj(a,b){let c;c=null;const f=fb.HyperlinkReader.V_b(a);return f.length?f[0].hyperlink?(c=f[0],a.Qa<f[0].Qa?{returnValue:b,hyperlink:c}:{returnValue:!0,hyperlink:c}):{returnValue:!1,hyperlink:c}:{returnValue:b,hyperlink:c}}static PNj(a){if(Cb.SelectionEditor.Oj(a)){var b=
zg.h(a),c=Ma.a.all(b,f=>6===f.wq);if(0<b.length&&!c)return!1}b=fb.HyperlinkReader.HB(a,!0);if(!(1===b.length&&b[0].Qa<=a.Qa&&b[0].Lb>=a.Lb&&b[0].hyperlink))return!1;c=db.ParagraphReader.text(a.node);a=ue.ut.ILc(a,b[0],c);return!(0<=a.indexOf("\r")||0<=a.indexOf("\n")||0<=a.indexOf("\x0B")||0<=a.indexOf("\ufffc"))}static WDc(){if(ue.Mf.Zf)for(let a=0;a<null.count;++a)if(2===null.ga(a).Fzl.changeType)return!0;return!1}static RKd(){return ue.Mf.Zf?!0:!I.a.instance.ga(45)||!gb.App.WC.oIb}static cCc(a){return I.a.instance.ga(14)&&
ue.Vi.R3a(a)||ue.Eq()&&ue.Eq().instance&&ue.Eq().instance.EV(a)?!1:!0}static o1d(a,b){return db.ParagraphReader.Tl(a)&&!Cb.SelectionEditor.BV(a)&&(db.ParagraphReader.textLength(a.node)||b)?Fc.a.createTextRange(a.node,0,db.ParagraphReader.textLength(a.node)):a}}ue.Tm=null;ue.HC=null;ue.jm=null;ue.Yc=null;ue.PC=null;ue.ond=null;ue.vZa=null;ue.wZa=null;ue.dM=null;Object(e.a)(ue,"HyperlinkActor",null,[]);class Eg{static get Qu(){return Xu.a.hsb}static get Ml(){return xi.ContextSetEditor.instance}static get Vi(){return Rf.a.instance}static get Uc(){return cd.a.instance}static Eq(){return Eg.jm||
(Eg.jm=lb.a.instance.Oa("Box4.IExternalSelectionManager"))}static get paragraphEditor(){return Eg.tw||(Eg.tw=lb.a.instance.resolve("Box4.IParagraphEditor"))}static get k4(){return Eg.Tq||(Eg.Tq=lb.a.instance.resolve("Box4.IParagraphReader"))}static get vL(){return Eg.SF||(Eg.SF=lb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get Dpk(){return Eg.paragraphEditor.Qu}static get Sf(){return Eg.Pg||(Eg.Pg=lb.a.instance.resolve("Box4.List.IListReader"))}static wb(){const a=u.AFrameworkApplication.Va;
a.ya(D.a.Qy,Db.a.view,Eg.fFf);a.ya(D.a.Qy,Db.a.outlineElement,Eg.eFf);a.$d(D.a.Qy,1028);a.ya(D.a.BE,Db.a.view,Eg.fFf);a.ya(D.a.BE,Db.a.outlineElement,Eg.eFf);a.$d(D.a.BE,1028)}static fFf(a,b,c,f,l){var w=b.view;if(!w.Jh)return 2;const F=w.Eb;if(!F)return Eg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.sla}),8;var S=F.Dj;if(!S)return Eg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.noSelection}),8;if(I.a.instance.ga(62)&&1===c)return 32;if(I.a.instance.ga(11)&&Eg.Ml.Vpa(Eg.iHd,S))return Eg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.xVb}),
8;if(I.a.instance.ga(14)&&Eg.Vi.lRc(S))return Eg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.aD}),8;if(Eg.Eq()&&Eg.Eq().instance&&Eg.Eq().instance.EV(S))return Eg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.externalSelection}),8;S={};S[Vh.rna]=5794;S[Vh.qna]=5795;let fa=2;if(u.AFrameworkApplication.fa.ka("Box4PartialPromoteDemoteIsEnabled")){w=Eg.BKf(a===D.a.Qy,b,!0);if(1===c)return w?32:8;w&&(fa=Vh.ldb(a,b,c,f,l,S))}else fa=Vh.ldb(a,b,1,f,l,S),1!==c&&32===fa?(w.Eb.Mve(),w=new Oe.GraphTransaction(15),w.hd(b.view.ug),fa=Eg.BKf(a===
D.a.Qy,b,!1)?Vh.ldb(a,b,c,f,l,S):8,w.dispose()):1!==c&&8===fa&&(w.Eb.Mve(),Eg.noi(a,b,F));return fa}static BKf(a,b,c){b=b.view.Eb;if(!b||!b.Pa.kb)return Eg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.M5c}),!1;if(b.Pa.uG)return Eg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.nPf}),!1;b=ii.Wqa(b.Pa,!1);if(!b)return Eg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.yIc}),!1;let f=!1;for(let l=0;l<b.length;l++){const w=b.getContext(l),F=new mb.GraphIterator;F.set(w.node);Cb.SelectionEditor.Rs(F);if(!Md.OutlineElementReader.Tg(F))if(c)continue;
else return Eg.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.cba}),!1;if(a?!Eg.Qu.kob(F):!Eg.Qu.$Bc(F))if(c)continue;else return Eg.Uc.Vb(zd.a.uXb,{["Reason"]:Hd.a.YKf}),!1;f=!0}return c?f:!0}static eFf(a,b,c,f,l){if(b.contextId!==Db.a.outlineElement)return 2;if(I.a.instance.ga(14))if(f=b.clone().vMe(),Cd.TableReader.Cwg(f)){if(Eg.Vi.Dwg(f))return Eg.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),8}else if(Eg.Vi.mDa(f))return Eg.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),2;f=new mb.GraphIterator;f.set(b.node);Cb.SelectionEditor.Rs(f);
if(!Md.OutlineElementReader.Tg(f))return 2;switch(a){case D.a.Qy:b=Eg.Qu.kob(f);break;case D.a.BE:b=Eg.Qu.$Bc(f);break;default:return 2}if(1===c||!b)return b?32:8;c=0;a===D.a.BE&&l&&l.ta(Kd.a.CGf,!1)&&(c|=2);switch(a){case D.a.Qy:Eg.Qu.Fdb(f,-1,c);break;case D.a.BE:Eg.Qu.cGc(f,1)}return 32}static noi(a,b,c){const f=new Oe.GraphTransaction(15);try{f.hd(b.view.ug);b=!0;var l=ii.Wqa(c.Pa,!1);for(let w=0;w<l.length;w++){const F=l.getContext(w);let S=new mb.GraphIterator;S.set(F.node);Cb.SelectionEditor.Rs(S);
if(!Md.OutlineElementReader.Tg(S))b=!1;else if(a===D.a.Qy?Eg.Qu.kob(S):Eg.Qu.$Bc(S))switch(b=!1,a){case D.a.Qy:Eg.Qu.Fdb(S,-1,0);break;case D.a.BE:Eg.Qu.cGc(S,1)}}if(b){const w=c.Pa.kb;for(c=0;c<w.length;c++){const F=w.ga(c);if(F.Ok){const S=Eg.vL.Wrb(F.node),fa=S.cHb;if(a===D.a.Qy?S.cN>fa:S.cN<18*fa){let xa=new mb.GraphIterator;xa.set(F.node);l=fa;l=a===D.a.Qy?S.cN>=2.5*fa?S.cN-2*fa:fa:S.cN<16*fa?S.cN+2*fa:18*fa;Eg.Dpk.jfb(xa,1,l)}}}}}finally{f&&f.dispose()}}}Eg.jm=null;Eg.tw=null;Eg.Tq=null;Eg.SF=
null;Eg.Pg=null;Eg.iHd=cb.ImageReader.Vtb;Object(e.a)(Eg,"IndentationActor",null,[]);class ag{static get G4d(){return ag.Pjb||(ag.Pjb=lb.a.instance.resolve("Box4.Images.IImageEditor"))}static get paragraphEditor(){return ag.tw||(ag.tw=lb.a.instance.resolve("Box4.IParagraphEditor"))}static get rq(){return ag.NC||(ag.NC=lb.a.instance.resolve("Box4.ITableEditor"))}static get Vi(){return Rf.a.instance}static get Uc(){return cd.a.instance}static Eq(){return ag.jm||(ag.jm=lb.a.instance.Oa("Box4.IExternalSelectionManager"))}static wb(){const a=
u.AFrameworkApplication.Va;I.a.instance.ga(77)||(a.ya(D.a.leftJustify,Db.a.table,ag.bId),a.ya(D.a.centerJustify,Db.a.table,ag.bId),a.ya(D.a.rightJustify,Db.a.table,ag.bId));a.ya(D.a.leftJustify,Db.a.view,rg.n6);a.ya(D.a.leftJustify,Db.a.paragraph,ag.Gga);a.ya(D.a.leftJustify,Db.a.image,ag.Lza);a.ya(D.a.leftJustify,Db.a.embeddedFile,ag.Lza);a.$d(D.a.leftJustify,1028);a.ya(D.a.centerJustify,Db.a.view,rg.n6);a.ya(D.a.centerJustify,Db.a.paragraph,ag.Gga);a.ya(D.a.centerJustify,Db.a.image,ag.Lza);a.ya(D.a.centerJustify,
Db.a.embeddedFile,ag.Lza);a.$d(D.a.centerJustify,1028);a.ya(D.a.rightJustify,Db.a.view,rg.n6);a.ya(D.a.rightJustify,Db.a.paragraph,ag.Gga);a.ya(D.a.rightJustify,Db.a.image,ag.Lza);a.ya(D.a.rightJustify,Db.a.embeddedFile,ag.Lza);a.$d(D.a.rightJustify,1028);I.a.instance.ga(54)&&(a.ya(D.a.fullJustify,Db.a.view,rg.n6),a.ya(D.a.fullJustify,Db.a.paragraph,ag.Gga),a.$d(D.a.fullJustify,1028),a.ya(D.a.oXb,Db.a.view,rg.n6),a.ya(D.a.oXb,Db.a.paragraph,ag.Gga),a.$d(D.a.oXb,1028),a.ya(D.a.Y4b,Db.a.view,rg.n6),
a.ya(D.a.Y4b,Db.a.paragraph,ag.Gga),a.$d(D.a.Y4b,1028),a.ya(D.a.Gjc,Db.a.view,rg.n6),a.ya(D.a.Gjc,Db.a.paragraph,ag.Gga),a.$d(D.a.Gjc,1028));a.ya(D.a.ija,Db.a.view,rg.n6);a.ya(D.a.ija,Db.a.paragraph,ag.Gga);a.ya(D.a.ija,Db.a.image,ag.Lza);a.$d(D.a.ija,1028);a.ya(D.a.Xga,Db.a.view,rg.n6);a.ya(D.a.Xga,Db.a.paragraph,ag.Gga);a.ya(D.a.Xga,Db.a.image,ag.Lza);a.$d(D.a.Xga,1028);a.ya(D.a.wma,Db.a.view,rg.n6);a.ya(D.a.wma,Db.a.paragraph,ag.Gga);a.ya(D.a.wma,Db.a.image,ag.Lza);a.$d(D.a.wma,1028);I.a.instance.ga(54)&&
(a.ya(D.a.wBa,Db.a.view,rg.n6),a.ya(D.a.wBa,Db.a.paragraph,ag.Gga),a.$d(D.a.wBa,1028))}static bId(a,b,c){let f=!0;if(!b)return 8;Cd.TableReader.Cwg(b)?I.a.instance.ga(14)&&ag.Vi.Dwg(b)?(ag.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),f=!1):ag.Eq()&&ag.Eq().instance&&ag.Eq().instance.EV(b)&&(ag.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.externalSelection}),f=!1):(ag.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.RRd}),f=!1);if(1===c||!f)return f?32:8;b=b.node;switch(a){case D.a.leftJustify:ag.rq.KL(b,1);break;case D.a.centerJustify:ag.rq.KL(b,
2);break;case D.a.rightJustify:ag.rq.KL(b,3)}return 32}static Lza(a,b,c){if(!({vE:c}=rg.Ymh(c,b)).returnValue)return c;b=b.node;switch(a){case D.a.leftJustify:case D.a.ija:ag.G4d.KL(b,1);break;case D.a.centerJustify:case D.a.Xga:ag.G4d.KL(b,2);break;case D.a.rightJustify:case D.a.wma:ag.G4d.KL(b,3)}return 32}static Gga(a,b,c,f,l){f=!0;b.contextId!==Db.a.paragraph?f=!1:I.a.instance.ga(14)&&ag.Vi.mDa(b)?(ag.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.aD}),f=!1):ag.Eq()&&ag.Eq().instance&&ag.Eq().instance.EV(b)&&
(ag.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.externalSelection}),f=!1);if(1===c||!f)return f?32:8;b=b.node;c=db.ParagraphReader.XM(b);switch(a){case D.a.leftJustify:case D.a.ija:ag.paragraphEditor.KL(b,1===c&&ag.QTc(l)?6:1);break;case D.a.centerJustify:case D.a.Xga:ag.paragraphEditor.KL(b,2===c&&ag.QTc(l)?1:2);break;case D.a.rightJustify:case D.a.wma:ag.paragraphEditor.KL(b,3===c&&ag.QTc(l)?1:3);break;case D.a.fullJustify:case D.a.wBa:ag.paragraphEditor.KL(b,6===c&&ag.QTc(l)?1:6);break;case D.a.Y4b:ag.paragraphEditor.KL(b,
11);break;case D.a.oXb:ag.paragraphEditor.KL(b,7);break;case D.a.Gjc:ag.paragraphEditor.KL(b,13)}return 32}static QTc(a){let b=!1;null!==a&&Object.getType(a)===Object&&a.hasOwnProperty("InContextSet")&&(b=a.InContextSet);return!b&&I.a.instance.ga(110)}}ag.Pjb=null;ag.NC=null;ag.tw=null;ag.jm=null;Object(e.a)(ag,"JustificationActor",null,[]);class Wt{wb(){const a=u.AFrameworkApplication.Va;a.ya(D.a.activateRibbonTab,Db.a.view,Object(C.a)(this,this.activateRibbonTab,"activateRibbonTab"));a.$d(D.a.activateRibbonTab,
5);a.ya(D.a.Ixg,Db.a.view,Object(C.a)(this,this.LPj,"launchJewelOpenMenuShortcut"))}activateRibbonTab(){return 32}LPj(){u.AFrameworkApplication.oN("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");gb.App.WC.PR.Hxg();return 32}static get instance(){return Wt.Ka||(Wt.Ka=Wt.IB())}static IB(){return new Wt}}Wt.Ka=null;Object(e.a)(Wt,"RibbonActor",null,[]);class Nn{constructor(a,b,c){this.Xwf=!1;this.Da=a;this.mb=b;this.Erc=c}wb(){this.Da.ra(G.a.UL,Db.a.view,Object(C.a)(this,this.Lkl,
"touchStartHandler"),4);this.Da&&this.mb&&(this.mb.ka("TouchImageGrippiesResizedIsEnabled")&&(this.Da.ra(D.a.Gvh,Db.a.view,Object(C.a)(this,this.zyk,"processImageOnTouchSelection"),4),this.Da.ra(D.a.Hvh,Db.a.view,Object(C.a)(this,this.yyk,"processImageOnClickSelection"),4)),this.mb.ka("HideGrippersWhenPinchingIsEnabled")&&(this.Da.ra(G.a.jel,Db.a.application,Object(C.a)(this,this.$yk,"processStartPinchToZoom"),4),this.Da.ra(G.a.bJi,Db.a.application,Object(C.a)(this,this.ryk,"processEndPinchToZoom"),
4)))}Lkl(a,b,c){if(2!==c)return 2;this.Xwf||(this.Xwf=!0);u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");r.a.Gj&&u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordForceSelectionIntoTopWhenTouchSettings");return 32}zyk(a,b,c,f,l){if(2!==c)return 2;this.e6g(l,!0);return 32}yyk(a,b,c,f,l){if(2!==c)return 2;this.e6g(l,!1);return 32}e6g(a,
b){if(a)for(a=a.firstChild;a;){if("SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,Nn.ysj)){for(a=a.firstChild;a;)this.w5h(a,b),a=a.nextSibling;break}a=a.nextSibling}}w5h(a,b){if(Sys.UI.DomElement.containsCssClass(a,Nn.lkg)){b&&!Sys.UI.DomElement.containsCssClass(a,Nn.FPc)?Sys.UI.DomElement.addCssClass(a,Nn.FPc):!b&&Sys.UI.DomElement.containsCssClass(a,Nn.FPc)&&Sys.UI.DomElement.removeCssClass(a,Nn.FPc);const c="WACImageResizeHandleTouch"+this.c2i(a);b&&!Sys.UI.DomElement.containsCssClass(a,
c)?Sys.UI.DomElement.addCssClass(a,c):!b&&Sys.UI.DomElement.containsCssClass(a,c)&&Sys.UI.DomElement.removeCssClass(a,c)}}ELc(a){a=a.className.split(" ");for(let b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&c!==Nn.lkg)return c}return""}c2i(a){a=this.ELc(a);return""!==a?Ja.a.substring(a,20,a.length):""}$yk(a,b,c){if(2!==c)return 2;if(!this.Erc)return 8;this.Erc.aqj();return 32}ryk(a,b,c){if(2!==c)return 2;if(!this.Erc)return 8;this.Erc.kSk();return 32}static bej(){return new Nn(u.AFrameworkApplication.Va,
u.AFrameworkApplication.fa,ee.GrippersManager.instance)}static get instance(){return Nn.Zs||(Nn.Zs=Nn.bej())}}Nn.lkg="WACImageResizeHandles";Nn.FPc="WACImageResizeHandlesTouch";Nn.ysj="WACImgSelection";Nn.Zs=null;Object(e.a)(Nn,"TouchInputActor",null,[]);class Zq{constructor(a){this.ls=null;this.pY=a}get ln(){return this.ls||(this.ls=this.pY())}wb(){const a=u.AFrameworkApplication.Va,b=Object(C.a)(this,this.undoRedo,"undoRedo");a.ra(D.a.undo,Db.a.view,b,1028);a.ra(D.a.redo,Db.a.view,b,1028)}undoRedo(a,
b,c,f,l){b=b.view;if(!b.Jh)return Zq.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.M5c}),8;f=a===D.a.undo?this.ln.vV:this.ln.oia;if(1===c)return f?32:8;if(!f)return Z.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",a===D.a.undo?"undo":"redo"),Zq.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.$ol}),2;c=new Oe.GraphTransaction(3);c.hd(b.ug);c.Zeb();a=a===D.a.undo?this.ln.undo():this.ln.redo();c.dispose();l&&ee.GrippersManager.instance.gZa(l.Ru);if(a)return 32;Zq.Uc.Vb(zd.a.uXb,{["Reason"]:Hd.a.NTg});return 8}static get instance(){return Zq.Ka||
(Zq.Ka=Zq.IB())}static IB(){const a=lb.a.instance;return new Zq(()=>a.resolve("Box4.IUndoManager"),a.qe("Box4.ICoauthCashTelemetry"))}static get Uc(){return cd.a.instance}}Zq.Ka=null;Object(e.a)(Zq,"UndoActor",null,[]);class wC{constructor(){this.Ea=null}get name(){return"Box4.Actors"}Yb(a){this.Ea=a;(new GI).Yb(a)}init(){this.Ea.resolve("Box4.Actors.ClipboardActor").wb();u.AFrameworkApplication.Va.ya(D.a.TGi,Db.a.embeddedFile,SP);u.AFrameworkApplication.Va.ya(D.a.ZRd,Db.a.embeddedFile,HI);u.AFrameworkApplication.Va.ya(D.a.ZRd,
Db.a.fZb,HI);Yq.instance.wb();ue.wb();Eg.wb();ag.wb();Nn.instance.wb();this.Ea.resolve("Box4.ISelectAllHandlers").wb();I.a.instance.ga(70)&&this.Ea.resolve("Box4.Actors.ProofingActor").wb();Wt.instance.wb();const a=this.Ea.qb("Box4.IFeatureHelper");a?a.Ngj.continueWith(()=>{this.fah()}):this.fah();wc.wb(gb.App.VIa);this.Ea.resolve("Box4.Actors.TextFormattingActor").wb();Zq.instance.wb();this.Ea.resolve("Box4.Actors.AccessibilityActor").BCe();this.Ea.resolve("Box4.IClipboardCommands");gb.App.Fb.updateCommandUI()}fah(){I.a.instance.ga(71)&&
this.Ea.resolve("Box4.Actors.StyleActor").wb()}dispose(){}static main(){m.a.instance.Ec(new wC)}}Object(e.a)(wC,"Box4ActorsPackage",null,[2,3]);class Lm{constructor(a,b){this.P5=this.eOh=null;this.gOh=a;this.yjb=b}get J$c(){return this.levelText}get p5b(){return this.eOh}get levelText(){return this.gOh}get listStyle(){return 6}get pD(){return"left"}get lla(){return this.P5}get font(){return this.yjb}}Object(e.a)(Lm,"ListMarkerBullet",null,[624]);class sf{static get dr(){return sf.Eo||(sf.Eo=lb.a.instance.resolve("Box4.List.IListEditor"))}static get Sf(){return sf.Pg||
(sf.Pg=lb.a.instance.resolve("Box4.List.IListReader"))}static get insertionPointFormatting(){return sf.Vs||(sf.Vs=lb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Eq(){return sf.jm||(sf.jm=lb.a.instance.Oa("Box4.IExternalSelectionManager"))}static get Ml(){return xi.ContextSetEditor.instance}static get Vi(){return Rf.a.instance}static get Uc(){return cd.a.instance}static get JK(){return sf.FJ||(sf.FJ=lb.a.instance.qb("Box4.List.ListSettings"))}static get Fkc(){return sf.LQb||(sf.LQb=
lb.a.instance.qb("Box4.List.ISingleLevelListEditor"))}static wb(){const a=u.AFrameworkApplication.Va;a.ya(D.a.TQ,Db.a.view,sf.cTb);a.ya(D.a.TQ,Db.a.outlineElement,sf.fnb);a.$d(D.a.TQ,1036);a.ya(D.a.UQ,Db.a.view,sf.cTb);a.ya(D.a.UQ,Db.a.outlineElement,sf.fnb);a.$d(D.a.UQ,1036);sf.Sf.h9a&&(a.ya(D.a.vVa,Db.a.view,sf.cTb),a.ya(D.a.vVa,Db.a.outlineElement,sf.fnb),a.$d(D.a.vVa,1036));a.ya(D.a.bFf,Db.a.view,Le.ActionManager.Dg);a.ya(D.a.HMf,Db.a.view,Le.ActionManager.Dg);a.ya(D.a.joinList,Db.a.view,Le.ActionManager.Dg);
a.ya(D.a.BHd,Db.a.view,Le.ActionManager.Dg);a.ya(D.a.HHd,Db.a.view,Le.ActionManager.Dg);a.ya(D.a.Qsh,Db.a.view,Le.ActionManager.Dg);a.ya(D.a.Rsh,Db.a.view,Le.ActionManager.Dg);a.ya(D.a.wRe,Db.a.view,Le.ActionManager.Dg)}static cTb(a,b,c,f,l){if(!b.view.Jh)return 2;const w=sf.Uc.zp(D.a.cTb);f.qP=42;f.G6=42;const F={};F[Vh.rna]=5796;F[Vh.qna]=5797;var S=b.view;if(I.a.instance.ga(11)){if(sf.Ml.Vpa(sf.$rj,S.Eb.Dj))return sf.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.qNd}),w.end(),8;if(sf.Ml.Vpa(sf.iHd,S.Eb.Dj))return sf.Uc.Vb(zd.a.qh,
{["Reason"]:Hd.a.xVb}),w.end(),8}if(I.a.instance.ga(14)&&sf.Vi.lRc(S.Eb.Dj))return sf.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.aD}),w.end(),8;if(sf.Eq()&&sf.Eq().instance&&sf.Eq().instance.EV(b))return sf.Uc.Vb(zd.a.qh,{["Reason"]:Hd.a.externalSelection}),w.end(),8;if(1===c)return w.end(),32;l||(l=new H.DictionaryPropertySet);let fa=null;var xa=2;if(2===c){fa=new Oe.GraphTransaction(15);fa.hd(b.view.ug);sf.G4b=!1;const pb=ii.Wqa(S.Eb.Pa,!1);if(!pb)return fa.dispose(),sf.Uc.Vb(zd.a.Fha,{["Reason"]:Hd.a.yIc}),
w.end(),8;u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");1<pb.length&&l.setValue(Kd.a.gTg,null);const Mb=l.ta(Kd.a.BS,-1),hc=l.ta(Kd.a.aF,-1);sf.JK.s4b&&sf.Fkc&&sf.Fkc.Gzl(pb);if(sf.Sf.Psh){var Za=sf.Y5k(Mb,hc,pb);Za&&(l.setValue(Kd.a.aF,16),l.setValue(Kd.a.mja,0));if(!Cb.SelectionEditor.Mg(S.Eb.Dj)&&!Za&&a!==D.a.vVa&&0<pb.length&&Mb){S=new mb.GraphIterator;Za=Array(pb.length);for(let kc=0;kc<pb.length;kc++)S.set(pb.getContext(kc).node),
Za[kc]=sf.Sf.rx(S);sf.X5k(Za,l)&&(xa=new H.DictionaryPropertySet,xa.setValue(Kd.a.aF,16),xa.setValue(Kd.a.mja,0),xa=Vh.m4(a,b,c,f,xa,F,11),u.AFrameworkApplication.Va.processAction(D.a.Rsh,2),Z.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),sf.G4b=!0)}}S=new mb.GraphIterator;S.set(pb.getContext(0).node);S=sf.Sf.rx(S);sf.AUj(Mb,hc,S,pb.length)}I.a.instance.ga(63)||I.a.instance.ga(77)?xa=Vh.m4(a,b,c,f,l,F,11):I.a.instance.ga(30)&&(xa=Vh.ldb(a,b,c,f,l,F));32===xa&&
l.ta(Kd.a.CGf,!1)&&(I.a.instance.ga(62)?xa=Vh.m4(D.a.BE,b,c,f,l,F,11):I.a.instance.ga(29)?xa=Vh.ldb(D.a.BE,b,c,f,l,F):I.a.instance.ga(76));fa&&fa.dispose();w.end();return xa}static X5k(a,b){let c=null;var f=!1;for(let l=a.length-1;0<=l&&(c?(f=a[l],f=-1!==b.ta(Kd.a.BS,-3)?f?c.listType!==f.listType||c.listStyle!==f.listStyle:!0:f?c.listType!==f.listType:!0):c=a[l],!f);l--);return c&&(a=!1,f||(a=b.ta(Kd.a.BS,-3),a=b.ta(Kd.a.aF,42)!==c.listType||0<a),f||a)?!0:!1}static AUj(a,b,c,f){0>=f||sf.G4b||(a?c?
(c=c.listType,-1===a&&b===c?(u.AFrameworkApplication.Va.processAction(D.a.wRe,2),Z.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<a&&(0===b||1===b)&&(u.AFrameworkApplication.Va.processAction(0===b?D.a.HHd:D.a.BHd,2),Z.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet"))):(u.AFrameworkApplication.Va.processAction(0===b?D.a.HHd:D.a.BHd,2),Z.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",0===b?
"Numbering":"Bullet")):(u.AFrameworkApplication.Va.processAction(D.a.wRe,2),Z.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static Y5k(a,b,c){if(-1!==a&&a||!c.length)return!1;a=new mb.GraphIterator;let f=null;for(let l=c.length-1;0<=l&&!(a.set(c.getContext(l).node),f=sf.Sf.rx(a));l--);return f&&b===f.listType?!0:!1}static fnb(a,b,c,f,l){if(b.contextId!==Db.a.outlineElement)return 2;if(I.a.instance.ga(14)){var w=b.clone().vMe();if(sf.Vi.mDa(w))return sf.Uc.Vb(zd.a.yo,
{["Reason"]:Hd.a.aD}),2}const F=new mb.GraphIterator;F.set(b.node);Cb.SelectionEditor.Rs(F);if(!Md.OutlineElementReader.Tg(F))return 2;if(1===c)switch(a){case D.a.TQ:return 32;case D.a.UQ:return 32;case D.a.vVa:return 32;default:return 2}w=sf.Sf.rx(F);let S=l;if(!S)return 8;!yc.ListReader.Gw&&a===D.a.UQ&&F.pCa()&&(F.$H(4)||S.setValue(Kd.a.oSa,1),F.fp());sf.Sf.h9a?(a===D.a.UQ||a===D.a.TQ?(S=sf.dr.XZf(a,S),b=hk.a.bV(S.getValue(Kd.a.aF),S.getValue(Kd.a.mja))):b=a===D.a.vVa?hk.a.bV(0,1):null,sf.ZP(a,
S),sf.H0k(b,S)):(S=sf.dr.XZf(a,S),b=hk.a.bV(S.getValue(Kd.a.aF),S.getValue(Kd.a.mja)));yc.ListReader.Gw||(b.Zz=S.ta(ob.a.qSa,Pj.a.gw));sf.M1k(S,F);if(!({x7a:b}=sf.dr.fnb(S,F,b,!1)).returnValue)return sf.Uc.Vb(zd.a.yo,{["Reason"]:Hd.a.Bbe}),2;2===c&&(u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),a=l.ta(Kd.a.aF,-1),b&&-1!==a&&((l=l.ta(Sb.a.CZ,"Invalid MultiLevel Type"),w)?0!==b.listType&&1!==b.listType||sf.G4b||(u.AFrameworkApplication.Va.processAction(D.a.Qsh,
2),Z.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",a?"Bullet":"Numbering",l)):16===b.listType?(u.AFrameworkApplication.Va.processAction(D.a.HMf,2),Z.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",a?"Bullet":"Numbering",l)):0!==b.listType&&1!==b.listType||sf.G4b||(u.AFrameworkApplication.Va.processAction(D.a.bFf,2),Z.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",a?"Bullet":"Numbering",l))),l=v.FocusManager.instance(),
l.ye.name===E.AppFrame.Gdd&&l.pC(y.AFrame.gV));f.qP=b.listType;f.G6=b.listStyle;return 32}static M1k(a,b){var c=new mb.GraphIterator;c.Pc(b);(b=c.yb(2))&&db.ParagraphReader.Pd(b)&&(c=dd.a.instance.Pa.kb)&&c.Wa&&c.Wa.node===b&&Cb.SelectionEditor.tTc(c)&&(sf.L_k(a),sf.J_k(a))}static H0k(a,b){b.Sa(Sb.a.CZ)&&a.G0k(b.getValue(Sb.a.CZ));a.BS=b.ta(Kd.a.BS,-1);a.P$d?(b=sf.l4i(a,b),sf.J1k(a,b)):sf.YZk(a)}static YZk(a){if(a.DSc)a.GOc&&-1===a.BS||(a.levelText="%1.",a.propertySet.Sa(ob.a.fm)||a.cIa(0,1));else if(1===
a.listType)a.GOc&&-1===a.BS||(a.font=Pj.a.MBi,a.levelText=Pj.a.defaultBullet,a.propertySet.Sa(ob.a.fm)||a.cIa(1,6));else return;a.pD="left"}static J1k(a,b){1===a.CZ?sf.U0k(a,b):sf.X_k(a,b)}static U0k(a,b){a.lla=b.lla}static X_k(a,b){a.levelText=b.levelText;a.DSc?a.cIa(0,b.listStyle):(a.font=b.font,a.cIa(1,1));a.pD=b.pD}static l4i(a,b){let c=null;2===a.CZ?c=a.DSc?lb.a.instance.qb("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):lb.a.instance.qb("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===
a.CZ&&(c=lb.a.instance.qb("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let f=c.dzg.value;a=a.BS+"";a in f||(f=c.WQj);return a in f||!b.Sa(ob.a.font)?f[a]:new Lm(Ja.a.fromCharCode(parseInt(a)),b.ta(ob.a.font,""))}static J_k(a){sf.insertionPointFormatting.Sa(ob.a.fontColor)&&a.setValue(ob.a.fontColor,sf.insertionPointFormatting.fontColor())}static L_k(a){sf.insertionPointFormatting.Sa(ob.a.fontSize)&&a.setValue(ob.a.fontSize,sf.insertionPointFormatting.fontSize())}static ZP(a,b){Z.ULS.sendTraceTag(22923024,
324,50,"{ListType:%1, ListStyleId:%2}",a===D.a.TQ?0:a===D.a.UQ?1:a===D.a.vVa?2:-1,b.ta(Kd.a.BS,-1))}}sf.$rj=cb.ImageReader.x3b;sf.iHd=cb.ImageReader.Vtb;sf.Eo=null;sf.Pg=null;sf.Vs=null;sf.jm=null;sf.FJ=null;sf.LQb=null;sf.G4b=!1;Object(e.a)(sf,"ListActor",null,[]);var KI=d(1157);class Xt{constructor(){this.hOh=new sc.a(Object(C.a)(this,this.IOd,"createListMarkerDictionary"));this.iOh={}}get dzg(){return this.hOh}get WQj(){return this.iOh}}Object(e.a)(Xt,"AListMarkerGalleryLoader",null,[625]);var LI=
d(1184);class kz extends Sw.a{constructor(){super();this.LevelInfo=null}get Type(){return 5}}Object(e.a)(kz,"ListGalleryButtonProps",Sw.a,[]);class Is{constructor(a,b,c,f){this.gOb=null;this.vIf="BulletLibraryGallery";this.Qdk="NumberingLibraryGallery";this.Cbk="MultilevelGallery";this.w0a=a;this.jOh=b;switch(a){case 0:this.gOb="BulletStyle";break;case 1:this.gOb="NumberingStyle";break;case 2:this.gOb="MultilevelStyle";break;default:this.gOb="BulletStyle"}this.kNh=f}get XQj(){return this.jOh}LAf(a){let b;
var c=1;switch(this.w0a){case 0:var f=Box4Intl.Box4Strings.L_BulletsLibraryTitle;var l=b="BulletsLibrary";break;case 1:f=Box4Intl.Box4Strings.L_NumberingLibraryTitle;b="NumberingLibrary";c=5;l="NumberingLibrary";break;case 2:f=Box4Intl.Box4Strings.L_ListLibraryTitle;b="MultilevelLibrary";c=5;l="Multilevel";break;default:f=Box4Intl.Box4Strings.L_BulletsLibraryTitle,l=b="BulletsLibrary"}f=Object.assign(new nk.a,{Id:String.format("msListMarkersPosition{0}",b),Title:f,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",
ControlList:[]});var w=0===this.w0a?"Size40by40":"Size48by48";c=Object.assign(new qq.a,{Id:String.format("galleryListMarkersPosition{0}",b),ExternalId:l,ExternalGalleryId:this.TYd(this.w0a),Type:c,Width:6,ElementDimensions:w,GalleryItems:[]});l=this.XQj.dzg.value;w=rq.a(l);const F=Math.min(18,w.length);for(let S=0;S<F;S++){const fa=l[w[S]];this.kNh&&a&&((1===this.w0a||2===this.w0a)&&!fa.p5b||0===this.w0a&&fa.levelText===Box4Intl.Box4Strings.L_ListStyleNone)||c.GalleryItems.push(this.SYd(this.gOb+
b+"_"+S,fa,this.w0a))}Array.add(f.ControlList,c);return f}TYd(a){switch(a){case 0:return this.vIf;case 1:return this.Qdk;case 2:return this.Cbk;default:return this.vIf}}e9f(a){const b={},c=da.FontUtils.eha(a.font);b.fontFamily=da.FontUtils.Dmb(c,a.font,!0,!1,!1);return b}SYd(a,b,c){var f="";let l=!1;0===c&&b.levelText!==Box4Intl.Box4Strings.L_ListStyleNone&&(f=Ja.a.Dv(b.levelText.charCodeAt(0),4),f=Is.iAj(b.font)&&!f.indexOf("f")?" 0x0"+f.substr(1):" 0x"+f,f=b.font+f,l=!0);let w,F;switch(c){case 0:c=
D.a.TQ;w=D.a.l7g;F=Object.assign(new LI.a,{Character:b.levelText,Style:this.e9f(b)});break;case 1:c=D.a.UQ;w=D.a.pAk;F=Object.assign(new kz,{LevelInfo:b.p5b});break;case 2:c=D.a.vVa;w=D.a.oAk;F=Object.assign(new kz,{LevelInfo:b.p5b});b.lla&&(f=b.lla.description,l=!0);break;default:c=D.a.TQ,w=D.a.l7g,F=Object.assign(new LI.a,{Character:b.levelText,Style:this.e9f(b)})}F.Id=a;F.Command=c.toString();F.QueryCommand=w.toString();F.Alt=f;F.InnerHTML=Ja.a.le(this.UQj(b));F.ShouldSetTitle=l.toString();return F}UQj(a){return String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',
this.DZd(a),this.CZd(a))}DZd(a){const b=new Sys.StringBuilder;b.append("position: relative; ");if(a.J$c===Box4Intl.Box4Strings.L_ListStyleNone&&a.font===Is.ppg)b.append("font-size: 12pt; "),b.append("top: 22%;");else{b.append("font-family: ");const c=da.FontUtils.eha(a.font);b.append(da.FontUtils.Dmb(c,a.font,!0,!1,!1));b.append("; ");b.append("font-size: 24pt;")}return b.toString()}CZd(a){return a.J$c}static iAj(a){for(let b=0;b<Is.YFf.length;b++)if(a===Is.YFf[b])return!0;return!1}}Is.ppg="EXYdHRyjlYTe8nDSGfyW";
Is.YFf=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];Object(e.a)(Is,"ListMarkerGalleryUtility",null,[]);class xC extends Xt{constructor(){super();new KI.a(gB.a.rt())}IOd(){const a={};a["0"]=new Lm(Box4Intl.Box4Strings.L_ListStyleNone,Is.ppg);a["1"]=new Lm(String.fromCharCode(61623),"Symbol");a["2"]=new Lm(String.fromCharCode(111),"Courier New");a["3"]=new Lm(String.fromCharCode(61607),"Wingdings");a["4"]=new Lm(String.fromCharCode(9643),"Courier New");a["5"]=new Lm(String.fromCharCode(61611),
"Wingdings");a["6"]=new Lm(String.fromCharCode(61614),"Symbol");a["7"]=new Lm(String.fromCharCode(61483),"Symbol");a["8"]=new Lm(String.fromCharCode(61485),"Symbol");a["9"]=new Lm(String.fromCharCode(9830),"Courier New");a["10"]=new Lm(String.fromCharCode(61664),"Symbol");a["11"]=new Lm(String.fromCharCode(61558),"Wingdings");a["12"]=new Lm(String.fromCharCode(61656),"Wingdings");a["13"]=new Lm(String.fromCharCode(61514),"Wingdings");a["14"]=new Lm(String.fromCharCode(61516),"Wingdings");a["15"]=
new Lm(String.fromCharCode(61692),"Wingdings");a["16"]=new Lm(String.fromCharCode(61691),"Wingdings");a["17"]=new Lm(String.fromCharCode(61553),"Wingdings");return a}}Object(e.a)(xC,"ListMarkerBulletLoader",Xt,[]);class Ok{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(e.a)(Ok,"InfoAtLevel",null,[]);class Yt{constructor(a){this.P5=a}get font(){return"Calibri"}get listStyle(){return 42}get pD(){return"left"}get lla(){return this.P5}get J$c(){return this.P5?this.xxk():this.zxk()}get p5b(){return this.P5?
this.yxk():null}get levelText(){return""}p1i(a){switch(a){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}xxk(){let a="";for(let b=0;3>b;b++)a+=this.ZBa(b);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Yt.XXd(),a)}yxk(){const a=[];for(let b=0;3>b;b++)a.push(Object.assign(new Ok,{textAtLevel:this.tbg(b),styleAtLevel:this.$bj(b)}));return a}zxk(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
Yt.YXd(),Box4Intl.Box4Strings.L_ListStyleNone)}tbg(a){a=this.P5.Pyg[a];for(let b=0;9>b;b++)a=Ja.a.replaceAll(a,"%"+(b+1),this.p1i(this.P5.gVc[b]));return a}$bj(a){const b={};b.fontFamily=6===this.P5.gVc[a]?this.P5.K3f[a]:this.font;return b}ZBa(a){const b=this.tbg(a),c=new Sys.StringBuilder;6===this.P5.gVc[a]&&c.append(String.format("font-family:{0};",this.P5.K3f[a]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
a,c.toString(),b)}static XXd(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static YXd(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(e.a)(Yt,"ListMarkerMultilevel",null,[624]);class lz{constructor(a,b,c,f,l){this.Pyg=a;this.gVc=b;this.IOj=f;this.K3f=c;this.description=l}}Object(e.a)(lz,"MultilevelDefInfo",null,[]);class MI{$ui(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelNumericalStyle;
let b="";const c=Array(9),f=Array(9),l=Array(9),w=Array(9);for(let F=0;9>F;F++)b+="%"+(F+1)+".",c[F]=b,f[F]=1,l[F]="left";return new lz(c,f,w,l,a)}mxi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelAlphanumericalStyle;const b=Array(9),c=Array(9);for(let f=0;9>f;f++)b[f]=2===f%3?"right":"left";return new lz("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3],c,b,a)}pui(){var a=[61558,61656,61607,61623,9830,61656,61607,61623,9830],b=Box4Intl.Box4Strings.L_MultilevelListLabelBulletedStyle;
const c=Array(9),f=Array(9),l=Array(9);for(let w=0;9>w;w++)l[w]=String.fromCharCode(a[w]),c[w]=6,f[w]="left";return new lz(l,c,"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";"),f,b)}}Object(e.a)(MI,"MultilevelDefInfoAdaptor",null,[]);class yC extends Xt{constructor(){super()}IOd(){const a=new MI,b={};b["0"]=new Yt(null);b["1"]=new Yt(a.$ui());b["2"]=new Yt(a.mxi());b["3"]=new Yt(a.pui());return b}}Object(e.a)(yC,"ListMarkerMultilevelLoader",Xt,[]);
class jn{constructor(a,b){this.P5=null;this.q0a=a;this.wtc=b}get font(){return"Calibri"}get listStyle(){return this.wtc}get pD(){switch(this.wtc){case 3:case 5:return"right";default:return"left"}}get lla(){return this.P5}get J$c(){switch(this.wtc){case 1:return this.eHa("1","2","3");case 2:return this.eHa("a","b","c");case 3:return this.eHa("i","ii","iii");case 4:return this.eHa("A","B","C");case 5:return this.eHa("I","II","III");case 0:return this.Axk();default:return this.eHa("1","2","3")}}get p5b(){const a=
[],b={};b.fontFamily=da.FontUtils.eha(this.font);switch(this.wtc){case 1:return a.push(Object.assign(new Ok,{textAtLevel:this.YM("1"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("2"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("3"),styleAtLevel:b})),a;case 2:return a.push(Object.assign(new Ok,{textAtLevel:this.YM("a"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("b"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("c"),
styleAtLevel:b})),a;case 3:return a.push(Object.assign(new Ok,{textAtLevel:this.YM("i"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("ii"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("iii"),styleAtLevel:b})),a;case 4:return a.push(Object.assign(new Ok,{textAtLevel:this.YM("A"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("B"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("C"),styleAtLevel:b})),a;case 5:return a.push(Object.assign(new Ok,
{textAtLevel:this.YM("I"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("II"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("III"),styleAtLevel:b})),a;case 0:return null;default:return a.push(Object.assign(new Ok,{textAtLevel:this.YM("1"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("2"),styleAtLevel:b})),a.push(Object.assign(new Ok,{textAtLevel:this.YM("3"),styleAtLevel:b})),a}}get levelText(){return this.q0a}eHa(a,b,c){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',
jn.XXd(),this.ZBa(a),this.ZBa(b),this.ZBa(c))}Axk(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',jn.YXd(),Box4Intl.Box4Strings.L_ListStyleNone)}ZBa(a){a=this.YM(a);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}YM(a){return Ja.a.replaceAll(this.q0a,"%1",a)}static XXd(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static YXd(){const a=
new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(e.a)(jn,"ListMarkerNumbering",null,[624]);class zC extends Xt{constructor(){super();new KI.a(gB.a.rt())}IOd(){const a={};a["0"]=new jn(Box4Intl.Box4Strings.L_ListStyleNone,0);a["1"]=new jn("%1.",5);a["2"]=new jn("%1.",4);a["3"]=new jn("%1.",1);a["4"]=new jn("%1.",2);a["5"]=new jn("%1.",3);a["6"]=new jn("%1)",5);a["7"]=new jn("%1)",4);a["8"]=new jn("%1)",1);a["9"]=new jn("%1)",
2);a["10"]=new jn("%1)",3);a["11"]=new jn("(%1)",5);a["12"]=new jn("(%1)",4);a["13"]=new jn("(%1)",1);a["14"]=new jn("(%1)",2);a["15"]=new jn("(%1)",3);return a}}Object(e.a)(zC,"ListMarkerNumberingLoader",Xt,[]);class AC{constructor(){this.Ea=null}get name(){return"Box4.ListMarker"}init(){sf.wb()}dispose(){}Yb(a){this.Ea=a;this.Ea.register(xC,"Box4.ListMarkerGallery.ListMarkerBulletLoader").ma().na(()=>new xC);this.Ea.register(zC,"Box4.ListMarkerGallery.ListMarkerNumberingLoader").ma().na(()=>new zC);
this.Ea.register(yC,"Box4.ListMarkerGallery.ListMarkerMultilevelLoader").ma().na(()=>new yC)}static main(){m.a.instance.Ec(new AC)}}Object(e.a)(AC,"Box4ListMarkerPackage",null,[2,3]);class BC{constructor(a){this.god=a}Grg(a){if(!this.god)return!0;a=Jf.a.FLc(a);if(!a)return!1;a=a.toLowerCase();for(let b=0;b<this.god.length;b++)if(a.endsWith(this.god[b]))return!0;return!1}}Object(e.a)(BC,"DomainAllowListManager",null,[]);class NI{constructor(a,b){this.VPd=null;this.ADd=a;this.url=b}get $Se(){return Jf.a.ema(this.url)}get eB(){return this.ADd}CPe(){const a=
{},b=this.eB;a.a=this.$Se;a.b=this.round(b.navigationStart);a.c=this.round(b.unloadEventStart);a.d=this.round(b.unloadEventEnd);a.e=this.round(b.redirectStart);a.f=this.round(b.redirectEnd);a.g=this.round(b.fetchStart);a.h=this.round(b.domainLookupStart);a.i=this.round(b.domainLookupEnd);a.j=this.round(b.connectStart);a.k=this.round(b.connectEnd);a.l=void 0!==b.secureConnectionStart&&null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.m=this.round(b.requestStart);a.n=this.round(b.responseStart);
a.o=this.round(b.responseEnd);a.q=this.round(b.domInteractive);a.r=this.round(b.domContentLoadedEventStart);a.s=this.round(b.domContentLoadedEventEnd);a.t=this.round(b.domComplete);a.u=this.round(b.loadEventStart);a.v=this.round(b.loadEventEnd);a.w=this.VPd;return a}round(a){return Math.round(1E3*a)/1E3}}Object(e.a)(NI,"PerformanceTimingEntry",null,[]);const OI=(a,b)=>{const c={};let f=null;switch(a){case 0:f="ResourceTiming";a=b.a;null!=a&&(c.Url=a);a=b.b;null!=a&&(c.InitiatorType=a);a=null==b.c?
null:b.c.toString();null!=a&&(c.RedirectStart=a);a=null==b.d?null:b.d.toString();null!=a&&(c.RedirectEnd=a);a=null==b.e?null:b.e.toString();null!=a&&(c.FetchStart=a);a=null==b.f?null:b.f.toString();null!=a&&(c.DomainLookupStart=a);a=null==b.g?null:b.g.toString();null!=a&&(c.DomainLookupEnd=a);a=null==b.h?null:b.h.toString();null!=a&&(c.ConnectStart=a);a=null==b.i?null:b.i.toString();null!=a&&(c.ConnectEnd=a);a=null==b.j?null:b.j.toString();null!=a&&(c.SecureConnectionStart=a);a=null==b.k?null:b.k.toString();
null!=a&&(c.RequestStart=a);a=null==b.l?null:b.l.toString();null!=a&&(c.ResponseStart=a);a=null==b.m?null:b.m.toString();null!=a&&(c.ResponseEnd=a);a=b.n;null!=a&&(c.CustomText=a);a=null==b.o?null:b.o.toString();null!=a&&(c.DecodedBodySize=a);a=null==b.p?null:b.p.toString();null!=a&&(c.EncodedBodySize=a);b=null==b.q?null:b.q.toString();null!=b&&(c.TransferSize=b);break;case 1:f="PerformanceTiming",a=b.a,null!=a&&(c.Url=a),a=null==b.b?null:b.b.toString(),null!=a&&(c.NavigationStart=a),a=null==b.c?
null:b.c.toString(),null!=a&&(c.UnloadEventStart=a),a=null==b.d?null:b.d.toString(),null!=a&&(c.UnloadEventEnd=a),a=null==b.e?null:b.e.toString(),null!=a&&(c.RedirectStart=a),a=null==b.f?null:b.f.toString(),null!=a&&(c.RedirectEnd=a),a=null==b.g?null:b.g.toString(),null!=a&&(c.FetchStart=a),a=null==b.h?null:b.h.toString(),null!=a&&(c.DomainLookupStart=a),a=null==b.i?null:b.i.toString(),null!=a&&(c.DomainLookupEnd=a),a=null==b.j?null:b.j.toString(),null!=a&&(c.ConnectStart=a),a=null==b.k?null:b.k.toString(),
null!=a&&(c.ConnectEnd=a),a=null==b.l?null:b.l.toString(),null!=a&&(c.SecureConnectionStart=a),a=null==b.m?null:b.m.toString(),null!=a&&(c.RequestStart=a),a=null==b.n?null:b.n.toString(),null!=a&&(c.ResponseStart=a),a=null==b.o?null:b.o.toString(),null!=a&&(c.ResponseEnd=a),a=null==b.p?null:b.p.toString(),null!=a&&(c.DomLoading=a),a=null==b.q?null:b.q.toString(),null!=a&&(c.DomInteractive=a),a=null==b.r?null:b.r.toString(),null!=a&&(c.DomContentLoadedEventStart=a),a=null==b.s?null:b.s.toString(),
null!=a&&(c.DomContentLoadedEventEnd=a),a=null==b.t?null:b.t.toString(),null!=a&&(c.DomComplete=a),a=null==b.u?null:b.u.toString(),null!=a&&(c.LoadEventStart=a),a=null==b.v?null:b.v.toString(),null!=a&&(c.LoadEventEnd=a),b=b.w,null!=b&&(c.CustomText=b)}c.Table=f;return Sys.Serialization.JavaScriptSerializer.serialize(c)};var Qh=d(282);class Sr{constructor(a,b=null,c=null){this.oi=a;this.ZSe=this;this.HKh=b||(()=>window.location.href);this.drd=new BC(c)}run(){if(Sr.Uza(window.performance))try{const l=
this.HKh();if(Sr.JVh.exec(l)&&this.drd.Grg(l)){var a=new NI(window.performance.timing,l);Xi.a.instance.SFk(a.eB.fetchStart);Xi.a.instance.UFk(a.eB.navigationStart);Xi.a.instance.kVa(Qh.a.QSi,"connectStart","requestStart");Xi.a.instance.kVa(Qh.a.WSi,"requestStart","responseStart");Xi.a.instance.kVa(Qh.a.YSi,"responseStart","responseEnd");this.ZSe.k9a(1,a.CPe());this.oi.jc(Qh.a.tBa,a.eB.fetchStart);this.oi.jc(Qh.a.USi,a.eB.domainLookupStart);this.oi.jc(Qh.a.q4f,a.eB.domainLookupEnd);this.oi.jc(Qh.a.SSi,
a.eB.connectStart);this.oi.jc(Qh.a.ZSi,a.eB.secureConnectionStart);this.oi.jc(Qh.a.RSi,a.eB.connectEnd);this.oi.jc(Qh.a.s4f,a.eB.requestStart);this.oi.jc(Qh.a.OJc,a.eB.responseStart);this.oi.jc(Qh.a.r4f,a.eB.responseEnd-a.eB.responseStart);this.oi.jc(Qh.a.XSi,a.eB.responseStart-a.eB.requestStart);var b=0,c=0,f=0;({transferSize:b,MSd:c,fQd:f}=this.Mnl(l)).returnValue&&(this.oi.jc(Qh.a.$Si,b),this.oi.jc(Qh.a.TSi,f),this.oi.jc(Qh.a.VSi,c));this.oi.jc(Qh.a.xZb,a.eB.navigationStart)}}catch(l){Z.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",l)}}Mnl(a){let b,c,f;f=c=b=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:b,MSd:c,fQd:f};a=window.performance.getEntriesByName(a,"navigation");if(void 0===a||null===a||1!==a.length)return{returnValue:!1,transferSize:b,MSd:c,fQd:f};a=a[0];var l=a.transferSize;void 0!==b&&null!==b&&(b=l);l=a.decodedBodySize;void 0!==l&&null!==l&&(f=l);a=a.encodedBodySize;void 0!==
a&&null!==a&&(c=a);return{returnValue:!0,transferSize:b,MSd:c,fQd:f}}k9a(a,b){Z.ULS.sendTraceTag(4551815,306,50,OI(a,b))}static get instance(){return Sr.Ka||(Sr.Ka=new Sr(og.a.instance,null,u.AFrameworkApplication.fa.ka("PerfTimingLoggerFilterDomainsIsEnabled")?u.AFrameworkApplication.fa.JB("ResourceLoggerDomainAllowList"):null))}static Uza(a){return!(void 0===a||null===a)&&!(void 0===a.timing||null===a.timing)}}Sr.Ka=null;Sr.JVh=RegExp("^https?://.*","i");Object(e.a)(Sr,"PerformanceTimingLogger",
null,[623]);class Js{constructor(a,b){this.VPd=null;this.ADd=a;this.behavior=b;this.url=this.eB.name}get $Se(){return 2===this.behavior?this.url:Jf.a.ema(this.url)}get eB(){return this.ADd}CPe(){const a={},b=this.eB;a.a=this.$Se;a.b=b.initiatorType;a.c=this.round(b.redirectStart);a.d=this.round(b.redirectEnd);a.e=this.round(b.fetchStart);a.f=this.round(b.domainLookupStart);a.g=this.round(b.domainLookupEnd);a.h=this.round(b.connectStart);a.i=this.round(b.connectEnd);a.j=void 0!==b.secureConnectionStart&&
null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.k=this.round(b.requestStart);a.l=this.round(b.responseStart);a.m=this.round(b.responseEnd);a.o=this.round(Js.qsb(b,"decodedBodySize"));a.p=this.round(Js.qsb(b,"encodedBodySize"));a.q=this.round(Js.qsb(b,"transferSize"));a.n=this.VPd;return a}round(a){return Math.round(1E3*a)/1E3}static qsb(a,b){return a[b]}}Object(e.a)(Js,"ResourceTimingEntry",null,[658]);class PI{constructor(a,b=null,c=100){this.AVe=a;this.Wwc=b;this.bKb={};this.WGh=
c}Dml(a){var b=a.name.toLowerCase();const c=Jf.a.p_d(b);this.XRk(c,b)&&(c in this.bKb?Z.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.IMj(a),b.encodedsize=Js.qsb(a,"encodedBodySize"),b.decodedsize=Js.qsb(a,"decodedBodySize"),this.bKb[c]=b))}XRk(a,b){if(this.AVe)return Array.contains(this.AVe,a);if(this.Wwc)for(a=Jf.a.NE(b),b=0;b<this.Wwc.length;b++)if(this.Wwc[b]&&a.endsWith(this.Wwc[b]))return!0;
return!1}IMj(a){try{const b=Js.qsb(a,"transferSize");if(void 0!==b&&null!==b)return!b;Z.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return a.responseEnd-a.fetchStart<this.WGh}catch(b){Z.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",b.message)}return!1}GGk(){if(va.a.Xa(this.bKb))Z.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var a=u.AFrameworkApplication.dS?u.AFrameworkApplication.dS.split(";"):[],b=Object.assign(new pk.a,{extendedProperties:Mq.a.oz()});b.extendedProperties.set("Flights",md.c(a));this.xUj(b,this.bKb,Mf.Health.instance)}}xUj(a,b,c){if(b){var f=0,l=0,w=0,F=0,S=0,fa=0,xa=0,Za=0,pb=0,Mb=0,hc=0;for(let Ec in b){var kc=b[Ec];try{const Hc=Object(ua.a)(Object,kc);if(!Hc)continue;const Dc=Hc.iscached?Boolean.parse(Hc.iscached.toString()):!1,Td=Hc.fetchstart?this.parseFloat(Hc.fetchstart.toString()):0,we=
(Hc.responseend?this.parseFloat(Hc.responseend.toString()):0)-Td,Pd=Hc.encodedsize?this.parseFloat(Hc.encodedsize.toString()):0,He=Hc.decodedsize?this.parseFloat(Hc.decodedsize.toString()):0;f+=we;F+=Pd;xa+=He;Mb++;Dc?(w+=we,fa+=Pd,pb+=He,hc++):(l+=we,S+=Pd,Za+=He)}catch(Hc){Z.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Hc.message)}}a.extendedProperties.set("StaticResources",md.c(b));a.extendedProperties.set("TotalResourceDownloadLatency",
f.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",l.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",w.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",F.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",S.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",fa.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",xa.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",
Za.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",pb.toString());a.extendedProperties.set("TotalNumberOfResourcesDownloaded",Mb.toString());a.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",hc.toString());c.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);c.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",a)}}parseFloat(a){if(!a)return 0;a=parseFloat(a);return isNaN(a)?0:a}}Object(e.a)(PI,
"AppStaticResourceManager",null,[]);class QI extends Sys.EventArgs{constructor(a){super();this.entries=a}}Object(e.a)(QI,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class jv{constructor(a,b,c=null,f=null,l=100){this.xvd=!1;this.Am=null;this.dLb=0;this.Ta=new sd.a;this.fKb=null;this.Ifa=!1;this.Pwf=0;this.Md=a;this.NYe=0;this.ZSe=this;this.drd=new BC(c);this.MC=b;f&&(this.fKb=new PI(null,f,l))}get OHf(){try{return!(void 0===this.MC||null===this.MC)&&!(void 0===this.MC.getEntriesByType||null===this.MC.getEntriesByType)}catch(a){return Z.ULS.sendTraceTag(50873240,
306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",a),!1}}get KBi(){return this.NYe}get isActive(){return this.Ifa}get uPe(){return this.Pwf}NBf(a){this.Ta.addHandler(jv.qTd,a)}Cbh(a){this.Ta.removeHandler(jv.qTd,a)}Yb(a,b){const c=this.uPe!==a;this.Pwf=a;this.isActive&&this.Md&&c&&(this.ah(),this.Hb());this.NYe=b}activate(){!this.isActive&&this.OHf&&(this.Hb(),this.Ifa=!0)}deactivate(a){this.isActive&&(this.ah(),a&&this.flush(),this.Ifa=!1)}flush(){if(this.isActive&&
this.OHf)try{var a=window.performance.getEntriesByType("resource");0<a.length-this.dLb&&Z.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",a.length-this.dLb);const b=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);b&&(window.performance.clearResourceTimings(),this.dLb=0);const c=[];for(let f=this.dLb;f<a.length;f++)this.drd.Grg(a[f].name)&&(this.fKb&&this.fKb.Dml(a[f]),c.push(new Js(a[f],
this.KBi)));b||(this.dLb=a.length);this.Ta.raiseEvent(jv.qTd,new QI(c));for(a=0;a<c.length;a++)0!==c[a].behavior&&2!==c[a].behavior||this.ZSe.k9a(0,c[a].CPe());0<c.length&&Z.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",c.length)}catch(b){Z.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",b)}}k9a(a,b){Z.ULS.sendTraceTag(4310804,306,50,OI(a,b))}NFk(){this.fKb.GGk()}Hb(){this.Md&&0<this.uPe&&
(this.Am=new Se.a(3,2,1E3*this.uPe,()=>{this.flush()},5),this.Md.Hb(this.Am),this.xvd=!0)}ah(){this.xvd&&(this.Md.ah(this.Am),this.Am=null,this.xvd=!1)}}jv.qTd="EntriesAvailable";Object(e.a)(jv,"ResourceTimingLogger",null,[574,623]);class CC{constructor(){this.Ea=null}get name(){return"Common.ResourceTiming"}init(){this.Ea.resolve("Common.NetworkTiming.IResourceTimingLogger");Sr.instance.run()}dispose(){}Yb(a){this.Ea=a;let b=null;if(u.AFrameworkApplication.fa.ka("ResourceLoggerFilterDomainsIsEnabled"))try{b=
u.AFrameworkApplication.fa.JB("ResourceLoggerDomainAllowList")}catch(l){Z.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const c=[];c.push(Jf.a.NE(qp.a.pO).toLowerCase());c.push(Jf.a.NE(qp.a.tGb).toLowerCase());const f=u.AFrameworkApplication.fa.Gc("AppStaticResourceMonitorCacheThresholdInMs",100);a.register(574,"Common.NetworkTiming.IResourceTimingLogger").ma().na(()=>new jv(u.AFrameworkApplication.ve,window.performance,b,c,f))}static main(){m.a.instance.Ec(new CC)}}
Object(e.a)(CC,"ResourceTimingPackage",null,[2,3]);class kv{}kv.visible="visible";kv.hidden="hidden";Object(e.a)(kv,"PlatformVisibilityState",null,[]);var mz=d(193);class RI extends Sys.EventArgs{constructor(a,b){super();this.ncf={};this.MPh=a;this.uPh=b}get oldState(){return this.MPh}get newState(){return this.uPh}meb(a,b){this.ncf[a]=b}toString(){return md.c(this.ncf)}}Object(e.a)(RI,"VisibilityStateChangeEventArgs",Sys.EventArgs,[]);class DC{constructor(a,b,c,f){this.Nwf=this.uMa=null;this.Wtf=
!0;this.Ta=new sd.a;this.Md=a;this.ysd=b;this.XYe=c;this.NWh=f;this.S9e=!1;u.AFrameworkApplication.fa&&(this.S9e=u.AFrameworkApplication.fa.ka("WordPriorityTaskLoggingOnComingOutOfFrozenIsEnabled"),this.Wtf=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListenToResumeEvents",!0));this.CVe=0;this.Lwf=new Date;this.ysd()===kv.hidden&&this.CQf();$addHandler(window,"focus",Object(C.a)(this,this.aZg,"onPlatformFocusHandler"));$addHandler(window,"blur",Object(C.a)(this,this.N7c,
"onPlatformBlurHandler"));$addHandler(document,"freeze",Object(C.a)(this,this.bZg,"onPlatformFreezeHandler"));$addHandler(document,"visibilitychange",Object(C.a)(this,this.cZg,"onPlatformVisibilityChangeHandler"));this.Wtf&&($addHandler(document,"pageshow",Object(C.a)(this,this.N7c,"onPlatformBlurHandler")),$addHandler(document,"resume",Object(C.a)(this,this.N7c,"onPlatformBlurHandler")))}get M2a(){return this.CVe}get isVisible(){return 2!==this.M2a}tGd(a){this.Ta.addHandler("VST",a)}LNk(a){this.Ta.removeHandler("VST",
a)}N7c(a){this.sIb(a.type,this.K1d())}aZg(a){this.sIb(a.type,0)}bZg(a){3!==this.M2a&&(this.YMf(),this.sIb(a.type,2),this.sIb(a.type,3),u.AFrameworkApplication.Qg.E9j())}K1d(){return this.ysd()===kv.hidden?2:document.hasFocus()?0:1}sIb(a,b){const c=this.M2a;this.CVe=b;if(c!==this.M2a){3===c&&this.S9e&&this.DVk();const f=new Date,l=new RI(c,this.M2a);l.meb("FromState",Vl[c]);l.meb("ToState",Vl[b]);l.meb("OriginatingEvent",a);l.meb("TimeInState",(+f-+this.Lwf).toString());this.Lwf=f;this.NWh.FAg(l);
this.Ta.raiseEvent("VST",l)}}cZg(a){this.ysd()===kv.hidden?this.uMa?this.Md.v4(this.uMa,this.XYe):this.CQf():(this.YMf(),this.sIb(a?a.type:"",this.K1d()))}dispose(){$removeHandler(window,"focus",Object(C.a)(this,this.aZg,"onPlatformFocusHandler"));$removeHandler(window,"blur",Object(C.a)(this,this.N7c,"onPlatformBlurHandler"));$removeHandler(document,"freeze",Object(C.a)(this,this.bZg,"onPlatformFreezeHandler"));$removeHandler(document,"visibilitychange",Object(C.a)(this,this.cZg,"onPlatformVisibilityChangeHandler"))}YMf(){this.uMa&&
(this.Md.ah(this.uMa),this.uMa=null)}CQf(){this.uMa=new Se.a(4,1,this.XYe,Object(C.a)(this,this.Snj,"handleVisibilityUpdate"),157);this.Md.Hb(this.uMa)}Snj(){this.uMa=null;this.sIb("TaskItem",this.K1d())}SVj(a){Z.ULS.sendTraceTag(557977793,324,50,"Time to execute task with Priority {0}:{1} Emergency View State: {2}",a.NAg,+new Date-+this.Nwf,mz.SessionStatusManager.instance.nia)}DVk(){this.Nwf=new Date;this.Md.Hb(this.mWb(0,"Realtime"));this.Md.Hb(this.mWb(1,"AboveNormal"));this.Md.Hb(this.mWb(2,
"Normal"));this.Md.Hb(this.mWb(3,"Background"));this.Md.Hb(this.mWb(4,"Low"))}mWb(a,b){return new Se.a(a,1,0,Object(C.a)(this,this.SVj,"logTimeToExecuteTask"),0,b)}}Object(e.a)(DC,"VisibilityManager",null,[751,109]);class VP{FAg(){}}Object(e.a)(VP,"NullVisibilityManagerTelemetry",null,[622]);class nz{constructor(){this.Ta=new sd.a}FAg(a){Z.ULS.sendTraceTag(590901976,324,50,a.toString())}static create(){return new nz}}Object(e.a)(nz,"VisibilityManagerTelemetry",null,[622]);class EC{constructor(){this.Ea=
null}get name(){return"Common.App.VisibilityManager"}init(){this.Ea.resolve("Common.App.VisibilityManagement.IVisibilityManager")}dispose(){const a=this.Ea.qb("Common.App.VisibilityManagement.VisibilityManager");a&&a.dispose()}Yb(a){this.Ea=a;this.Ea.register(nz,"Common.App.VisibilityManagement.VisibilityManagerTelemetry").as("Common.App.VisibilityManagement.IVisibilityManagerTelemetry").na(()=>nz.create()).ma();this.Ea.register(DC,"Common.App.VisibilityManagement.VisibilityManager").as("Common.App.VisibilityManagement.IVisibilityManager").na(()=>
new DC(u.AFrameworkApplication.ve,()=>window.document.visibilityState,6E4*u.AFrameworkApplication.fa.Gc("VisibilityManagerDelayTransitionToHiddenInMin",1),this.Ea.resolve("Common.App.VisibilityManagement.VisibilityManagerTelemetry"))).ma()}static main(){m.a.instance.Ec(new EC)}}Object(e.a)(EC,"VisibilityManagerPackage",null,[2,3]);var WP=d(1172);class SI{constructor(a,b){this.KXc=new Ie.a;this.NXc=new Ie.a;this.dzb=b;this.cTa=a}gp(a){!a||this.KXc.Kb(a.id)||this.NXc.Kb(a.id)||this.cTa.gp(a)}U$g(a){this.nIk(a)}V$g(a){this.pIk(a)}nIk(a){var b=
null;this.dzb&&a&&(this.gp(a),b=b||Object(C.a)(this,this.Cue,"onDragOver"),this.KXc.$(a.id,b),this.cTa.pb(ra.a.drop,a,b))}pIk(a){var b=null;this.dzb&&a&&(this.gp(a),b=b||Object(C.a)(this,this.Due,"onDrop"),this.NXc.$(a.id,b),this.cTa.pb(ra.a.D4a,a,b))}zb(a){this.dzb&&a&&(this.cTa.zq(a),this.KXc.ga(a.id)&&this.cTa.zb(ra.a.D4a,a,this.KXc.ga(a.id)),this.NXc.ga(a.id)&&this.cTa.zb(ra.a.drop,a,this.NXc.ga(a.id)))}drj(){this.cTa&&this.cTa.dispose()}Due(a){a=a.nc;a.preventDefault();a.stopPropagation();return!0}Cue(a){a=
a.nc;a.preventDefault();a.stopPropagation();return!0}}Object(e.a)(SI,"PPTDragDropInputHelper",null,[541]);class FC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.DragDrop"}Yb(a){if(!a)throw Error.argumentNull("container");this.K=a;this.K.register(541,"PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").ma().na(()=>new SI(WP.a.instance,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointDragInsertImageIsEnabled))}init(){const a=this.K.resolve("PowerPointWebEditor.AppFrame").wHd;
a?(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").U$g(a),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").V$g(a)):(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").U$g(this.K.resolve("PowerPointWebEditor.AppFrame").F0),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").V$g(this.K.resolve("PowerPointWebEditor.AppFrame").F0))}dispose(){this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").zb(this.K.resolve("PowerPointWebEditor.AppFrame").wHd);
this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").drj()}static main(){m.a.instance.Ec(new FC)}}Object(e.a)(FC,"PPTWebEditorDragDropPackage",null,[2,3]);class TI{constructor(a){this.cRh=a}UJe(){return Math.random()<this.cRh}}Object(e.a)(TI,"RandomSampler",null,[1503]);class UI{constructor(a){this.wMb=null;this.LTh=a}JSb(a,b){if("ForceSample"===b||this.LTh())this.wMb||(this.wMb=[]),Array.add(this.wMb,a)}getData(){return this.wMb}reset(){this.wMb=null}}Object(e.a)(UI,"SampleDataAggregator",
null,[1496]);var VI=d(525);class WI{constructor(){this.metadata=null;this.duration=this.ths=this.timeStamp=0;this.isCoauth=null}}Object(e.a)(WI,"PPTEventTimingData",null,[]);class vq{constructor(){this.Mne=!1;this.w8={};this.B4j=a=>{window.requestAnimationFrame(a)};this.cxb=[];this.w8.ArrowDown=!0;this.w8.ArrowLeft=!0;this.w8.ArrowRight=!0;this.w8.ArrowUp=!0;this.w8.Backspace=!0;this.w8.Delete=!0;this.w8.End=!0;this.w8.Enter=!0;this.w8.Home=!0;this.w8.PageDown=!0;this.w8.PageUp=!0;this.w8.Tab=!0}ckc(a){return a.ctrlKey&&
"Control"!==a.key||a.altKey&&"Alt"!==a.key||a.key in this.w8}Sci(a){const b={};b.key=this.ckc(a)?a.key:" "===a.key?"Space":"Char";b.alt=(void 0===a.altKey||null===a.altKey?!1:a.altKey).toString();b.ctrl=a.ctrlKey.toString();b.shift=a.shiftKey.toString();return b}Arh(a){const b=new WI;b.metadata=this.Sci(a);b.ths=window.performance.now()-a.timeStamp;b.timeStamp=a.timeStamp;b.isCoauth=vq.ANa?(!vq.ANa.amIAlone).toString():"null";this.cxb.push(b);this.DJk()}Rrh(a){if(this.cxb.length)for(const b of this.cxb)if(b.timeStamp===
a.timeStamp){b.duration=window.performance.now()-a.timeStamp-b.ths;break}}DJk(){this.Mne||(this.B4j(()=>{this.Mne=!1;window.dispatchEvent(VI.a.instance.create(ra.a.YGd,this.cxb.slice(0,this.cxb.length)));this.cxb=[]}),this.Mne=!0)}keyPressedEventHandlerStart(a){vq.KRc(a)&&!this.ckc(a)&&this.Arh(a)}keyPressedEventHandlerEnd(a){vq.KRc(a)&&!this.ckc(a)&&this.Rrh(a)}keyDownEventHandlerStart(a){vq.KRc(a)&&this.ckc(a)&&this.Arh(a)}keyDownEventHandlerEnd(a){vq.KRc(a)&&this.ckc(a)&&this.Rrh(a)}static get ANa(){return vq.JNf||
(vq.JNf=lb.a.instance.qb("PowerPointWebEditor.ICoauthStateGetter"))}static KRc(a){return!!a&&a.timeStamp<window.performance.now()}}vq.JNf=null;Object(e.a)(vq,"PPTEventTimingMeter",null,[539]);class Tr{constructor(){this.W7b=[];this.yyb=this.E_c=this.dFa=this.N1c=null;this.M1c=0;this.m_c=!1}start(a){if(!this.m_c){Array.clear(this.W7b);for(let b=0;b<Tr.wZb.length;++b)this.W7b.push(0);this.N1c=window.setInterval(Object(C.a)(this,this.hdh,"reportMeasuredFrames"),1E3*a);this.M1c=window.performance.now();
this.wSe(null);$addHandler(window,"visibilitychange",Object(C.a)(this,this.wSe,"updateMeasureCurrentFrameLoop"));this.m_c=!0}}stop(){this.m_c&&($removeHandler(window,"visibilitychange",Object(C.a)(this,this.wSe,"updateMeasureCurrentFrameLoop")),null!=this.N1c&&(window.clearInterval(this.N1c),this.N1c=null),null!=this.dFa&&(window.cancelAnimationFrame(this.dFa),this.dFa=null),this.hdh(),this.m_c=!1)}hdh(){if(null!=this.yyb){var a={};for(var b=0;b<Tr.wZb.length;++b)a[Tr.wZb[b].toString()]=this.W7b[b],
this.W7b[b]=0;b=window.performance.now();var c={};c.intervalStart=this.M1c;c.duration=b-this.M1c;c.maxFrameLengthMs=this.yyb;c.frameData=a;window.dispatchEvent(VI.a.instance.create(ra.a.iEe,c));this.yyb=null;this.M1c=b}}wSe(){Tr.aIj&&null==this.dFa?(this.E_c=null,this.dFa=window.requestAnimationFrame(Object(C.a)(this,this.BRg,"measureCurrentFrame"))):null!=this.dFa&&(window.cancelAnimationFrame(this.dFa),this.dFa=null)}BRg(a){if(null!=this.E_c){const b=a-this.E_c;if(null==this.yyb||this.yyb<b)this.yyb=
b;for(let c=0;c<Tr.wZb.length;++c)if(b<Tr.wZb[c]){++this.W7b[c];break}}this.E_c=a;this.dFa=window.requestAnimationFrame(Object(C.a)(this,this.BRg,"measureCurrentFrame"))}static get aIj(){return"visible"===window.document.visibilityState}}Tr.wZb=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Object(e.a)(Tr,"PPTFrameTimingMeter",null,[540]);class GC{constructor(){this.B$b=this.b6b=null;this.KHg=this.DHg=!1}Yb(a){window.performance&&window.performance.now&&window.requestAnimationFrame&&
(u.AFrameworkApplication.fa.ka("PodEventTimingMeterIsEnabled")&&!r.a.rj&&(a.register(539,"Common.IEventTimingMeter").ma().na(()=>new vq),this.DHg=!0),a.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterIsEnabled&&(a.register(540,"Common.IFrameTimingMeter").ma().na(()=>new Tr),this.KHg=!0))}get name(){return"PowerPointWebEditor.EventTimingMeter"}init(){if(this.DHg){var a=new TI(u.AFrameworkApplication.fa.Gc("PodEventTimingMeterEventSamplingPercent",0)/100);a=new UI(Object(C.a)(a,
a.UJe,"shouldBeInSample"));const b=Ro.a.kV(16,1,a);this.b6b=c=>{if(c&&(c=c.rawEvent.detail))for(const f of c)b.track(f,"EventTimingData")};ad.a.addHandler(window.self,ra.a.YGd,this.b6b)}this.KHg&&(this.B$b=b=>{b&&(b=b.rawEvent)&&za.a.J(39706653,306,50,md.c(b.detail))},ad.a.addHandler(window.self,ra.a.iEe,this.B$b))}dispose(){this.b6b&&(ad.a.removeHandler(window.self,ra.a.YGd,this.b6b),this.b6b=null);this.B$b&&(ad.a.removeHandler(window.self,ra.a.iEe,this.B$b),this.B$b=null)}static main(){m.a.instance.Ec(new GC)}}
Object(e.a)(GC,"PPTEventTimingMeterPackage",null,[2,3]);var HC=d(446);class XI{constructor(a){this.gdf=new Ie.a(null);this.iKh=a}ga(a){let b;({value:b}=this.gdf.Nf(a)).returnValue||(b=this.iKh(a),this.gdf.$(a,b));return b}}Object(e.a)(XI,"MemoizedLookup",null,[1527]);var XP=d(819),YP=d(694);class IC{constructor(a){this.erk=0;this.ZN=a}}Object(e.a)(IC,"GraphMergerResponse",null,[]);var ZP=d(313);class JC extends Zf.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=
this.BaseRevisions=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Reason=this.Source=0}Lk(){return 33}static construct(a,b,c,f,l,w,F,S,fa){const xa=new JC;xa.BaseRevisions=a;xa.TheirRevisions=b;xa.YourRevisions=c;xa.IgnoreConflictsInLastServerRevision=f;xa.MergeHint=l;xa.ObjectSpaceId=w?ae.a(w):null;xa.RequestId=F?ae.a(F):null;xa.Source=S;xa.Reason=fa;return xa}}Object(e.a)(JC,"CreateGraphMergeReplayRequest",Zf.a,[]);d(812);class oz{Sa(a){return a.Sa(void 0)}Cbg(a,
b){return a.ta(b,null)}IMc(a,b){a=(a=a.ta(b,null))?Array.clone(a):[];return new z.a(a)}Fbg(a,b){return a.ta(b,"")}vkh(a,b,c){a.setValue(b,c)}}Object(e.a)(oz,"MergeableObjectUtilities",null,[605]);class $P{constructor(a,b=null,c=null){this.cxd=b||new oz;c||Object(C.a)(this,this.iGi,"doParagraphMergeNoOP")}iGi(a,b){return{dBl:a,cBl:b}}}Object(e.a)($P,"GraphMergeSelectionRecordUpdater",null,[]);class YI{constructor(){this.source=0;this.ou=this.FJb=this.YIa=null;this.zbc=0;this.zPc=!1;this.SMe=0}}Object(e.a)(YI,
"InputState",null,[]);class ZI{constructor(){this.timeout=this.succeeded=this.crash=!1;this.ZN=null}}Object(e.a)(ZI,"OutputState",null,[]);class $I{constructor(){this.XJc=this.Zgd=this.mkc=!1;this.DYa=this.ipl=this.dOi=this.yre=this.yyh=this.q1f=this.RGf=this.KDc=null}}Object(e.a)($I,"RuntimeState",null,[]);class aJ{constructor(){this.input=new YI;this.runtime=new $I;this.output=new ZI}}Object(e.a)(aJ,"MergeState",null,[]);var Uc=d(1057);class nx{constructor(a,b,c){this.uRh=a;this.NPh=b;this.vPh=
c;this.kud=new sc.a(Object(C.a)(this,this.uji,"checkIfDifferent"))}get zDb(){return this.uRh}get oldValue(){return this.NPh}get newValue(){return this.vPh}get u7(){return!!this.newValue&&!this.oldValue}get isDeleted(){return!this.newValue&&!!this.oldValue}get U7a(){return this.u7||this.isDeleted||this.kud.value}uji(){return this.u7||this.isDeleted?!0:!Uc.a.LFf(this.zDb,this.oldValue,this.newValue)}}Object(e.a)(nx,"PropertyDiff",null,[]);class ox{constructor(a,b){this.KPh=a;this.sPh=b;this.kud=new sc.a(()=>
this.zRc(null));this.wRh=new sc.a(Object(C.a)(this,this.mLi,"evaluatePropertyDiffs"))}get GBb(){return this.KPh}get c4(){return this.sPh}get u7(){return!!this.c4&&!this.GBb}get isDeleted(){return!this.c4&&!!this.GBb}get U7a(){return this.u7||this.isDeleted||this.kud.value}get lWa(){return this.wRh.value}zRc(a){let b=!1;this.lWa.forEach((c,f)=>{b=f.U7a&&(!a||7!==a.ga(c));return!b});return b}mLi(){const a=new Ie.a;var b=this.c4,c=this.GBb;if(this.u7){c=b.yz();for(var f=0;f<c.length;f++){var l=c[f];
a.$(Uc.a.rb(l),new nx(l,null,b.lra(l)))}}else if(this.isDeleted)for(b=c.yz(),f=0;f<b.length;f++)l=b[f],a.$(Uc.a.rb(l),new nx(l,c.lra(l),null));else{f=c.yz();for(l=0;l<f.length;l++){var w=f[l];a.$(Uc.a.rb(w),new nx(w,c.lra(w),b.Sa(w)?b.lra(w):null))}f=b.yz();for(l=0;l<f.length;l++)w=f[l],c.Sa(w)||a.$(Uc.a.rb(w),new nx(w,null,b.lra(w)))}return a}}Object(e.a)(ox,"MergeableObjectDiff",null,[]);class px{constructor(a,b){this.Z3=b?a.F3a():a;this.Kxc=new pa.a}K3k(a){this.Kxc=a}PRg(a){(new ox(this.Z3,a)).lWa.forEach((b,
c)=>{c.U7a&&!this.Kxc.contains(b)&&(this.Kxc.add(b),c.isDeleted?(c=this.Z3,c.Sa(Uc.a.Uqa(b))&&c.removeProperty(Uc.a.Uqa(b))):this.Z3.dIa(Uc.a.Uqa(b),c.newValue));return!0})}}Object(e.a)(px,"PartialMergeResult",null,[]);class bJ extends Zf.a{constructor(){super();this.Location=null}Lk(){return 34}static construct(a){const b=new bJ;b.Location=a;return b}}Object(e.a)(bJ,"PlayGraphMergeReplayRequest",Zf.a,[]);class lv{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){this.Bde=new XP.a;this.f5j=a;this.C2j=b;this.aUa=
c(this.x_b());this.d_j=f;this.e_j=l;this.Z1c=w;this.i0c=F;this.MFg=S;this.a_j=Za;this.b_j=fa;this.c_j=xa}oK(){return(new Date).getTime()}sgb(a,...b){return String.format.apply(null,[a].concat(b))}ljl(a){throw df.a.invalidOperation(a);}N0i(a){return String.format("Name: {0}, Message: {1}, Stack: {2}",a.name,a.message,a.stack)}Hkj(a,b,c,f){f.$(a,new px(b,!1));Z.ULS.sendTraceTag(19019783,808,50,"Merging Object: [Id: {0}] [ClassId: {1}]. Object wasn't in base revision, but was in conflict and favored.",
a,c.Oe);return!0}jtl(a,b){const c=new ik.a;c.id=im.a.fea;c.dIa(zb.a.Edd,5===b?2:4);a.dBf(c);a.Ujd().kwa(c.id,4)}dXk(a){var b=!a.output.succeeded&&(this.b_j||a.output.crash),c=!!a.input.YIa&&0<a.input.YIa.length;if(c=this.c_j&&c&&(this.a_j||b)){b=c?Fa.a.create():Fa.a.nil;c=c?String.format(" [Merge Request Id: {0}]",b):"";lv.FUj(a,c);var f,l;({L$h:w,fjl:f,azl:l}=this.Lyi(a,Object(C.a)(this,this.nSf,"createSerializedRevisionFrom")));c=lv.U1i(a);b=JC.construct(w._list,f._list,l._list,a.input.zPc,a.input.zbc,
a.input.ou,b,a.input.source,c);var w=a.output.ZN;3===c&&0<w.length&&(b.MergedRevision=this.nSf(a.output.ZN.last()));a=new ZP.a;a.$G=b;a.status=1;b=this.Bde.MZb(0,null);b.tY(a);b.OAa()}}nSf(a){const b=a.TU,c=gb.App.Fb.Fd.Gi;return new YP.a(a,b,c.Ai,null,c.phc,c.contextId,b?b.id:Fa.a.nil,this.Z1c,!1,!0)}L4c(a,b,c,f,l,w,F){c=this.Wwi(a,b,f,l,w,F);f=0;const S=c.runtime.Zgd;try{if(S){const fa=a.length?a.getItemAt(a.length-1):null,xa=b.length?b.getItemAt(b.length-1):null;Z.ULS.sendTraceTag(18641173,808,
50,"MergeChanges: Begin.  [TheirChanges - Length:{0} Last:{1} Base:{2}] [YourChanges - Length:{3} Last:{4} Base:{5}] [MergeHint: {6}] [IgnoreConflictsInLastServerRevision: {7}] [MaxMergeTimeInMs: {8}] [FullPropertyLoggingIsEnabled: {9}] [Source: {10}]",a.length,fa?fa.id:Fa.a.nil,fa?fa.TU?fa.TU.id:Fa.a.nil:Fa.a.nil,b.length,xa?xa.id:Fa.a.nil,xa?xa.TU?xa.TU.id:Fa.a.nil:Fa.a.nil,l,w,this.i0c,this.MFg,F)}for(a=!0;f<this.aUa.length&&a;f++)a=(0,this.aUa[f])(c);return new IC(c.output.ZN)}catch(fa){const xa=
!c.output.timeout;c.output.crash=xa;const Za=String.format("Merge {0}!  Failing the merge.  [{1}] [Will continue: {2}]",xa?"Crashed":"Timed Out",this.N0i(fa),!!c.output.ZN);xa?Z.ULS.sendTraceTag(18613134,808,10,"MergeChanges Crash. [Error: {0}]",Za):Z.ULS.sendTraceTag(18613136,808,15,"MergeChanges Timeout. [Error: {0}]",Za);if(c.output.ZN)return new IC(c.output.ZN);throw fa;}finally{c.output.succeeded?S&&Z.ULS.sendTraceTag(18613138,808,50,this.h_b(c,f,"Succeeded")):c.output.timeout?Z.ULS.sendTraceTag(18641178,
808,15,this.h_b(c,f,"Timeout")):c.output.crash?c.output.ZN?Z.ULS.sendTraceTag(18613142,808,15,this.h_b(c,f,"Crash - Rejection")):Z.ULS.sendTraceTag(18613144,808,15,this.h_b(c,f,"Crash - Failed")):S&&Z.ULS.sendTraceTag(18613140,808,50,this.h_b(c,f,"Rejection")),this.dXk(c)}}h_b(a,b,c){const f=a.output.ZN,l=f&&f.length?f.getItemAt(f.length-1):null;return this.sgb("MergeChanges: End. {0}. [ElapsedTime: {1}ms] [Function: {2}] [MergedRevisions - Length:{3} Last:{4} Base:{5}] [Source: {6}]",c,this.oK()-
a.input.SMe,b,f?f.length:0,l?l.id:Fa.a.nil,l?l.TU?l.TU.id:Fa.a.nil:Fa.a.nil,a.input.source)}Wwi(a,b,c,f,l,w){const F=new aJ,S=F.input;S.YIa=a;S.FJb=b;S.ou=c;S.zbc=f;S.zPc=l;S.SMe=this.oK();S.source=w;a=F.runtime;a.XJc=this.MFg;a.mkc=!0;a.Zgd=!0;let fa="";a.DYa=xa=>{if(this.i0c){var Za=this.oK()-S.SMe,pb=Za>this.i0c;fa+=this.sgb(" ({0}: {1})",xa,Za);pb&&(F.output.timeout=!0,xa=this.sgb("Exceeded [MaxMergeTimeInMs: {0}] when we reached [Details: {1}] [Elapsed Time: {2}] [Timeline:{3}]",this.i0c,xa,
Za,fa),this.ljl(xa))}};return F}x_b(){return[Object(C.a)(this,this.uok,"otherAuthorsHaveChangesToMerge"),Object(C.a)(this,this.AFj,"isInputValid"),Object(C.a)(this,this.Ovj,"initializeOutputMergeState"),Object(C.a)(this,this.hwj,"initializeRuntimeMergeState"),Object(C.a)(this,this.Nnl,"tryObjectMerge"),Object(C.a)(this,this.SZh,"addMergeResultsToOutput")]}uok(a){const b=a.input.YIa;a=a.output;return b?b.length?!0:(Z.ULS.sendTraceTag(18613150,808,100,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),
a.ZN=b,a.succeeded=!0,!1):(Z.ULS.sendTraceTag(18613148,808,100,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),a.ZN=b,a.succeeded=!0,!1)}AFj(a){var b=a.input;const c=b.YIa,f=b.FJb,l=b.ou,w=b.zbc;b=b.zPc;a=a.output;if(!f||!f.length)return a.ZN=c,!1;let F=!0;if(2!==w&&1!==w)return a.ZN=c,!1;l&&l!==Fa.a.nil||(F=!1);c.length<(b?2:1)&&(Z.ULS.sendTraceTag(18613155,808,100,"OtherAuthorsHaveChangesToMerge: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",
b),F=!1);F||(a.ZN=2===w?c:f);return F}hwj(a){var b=a.input,c=b.YIa,f=b.FJb;const l=b.zbc;let w,F;({ejl:w,$yl:F,KDc:b}=this.O3i(a,c,f,b.zPc));if(!b)return Z.ULS.sendTraceTag(18613185,808,15,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",w.id,F.id),this.vAg(w,c.length,"TheirChanges"),this.vAg(F,f.length,"YourChanges"),a.output.ZN=2===l?c:f,!1;a.runtime.KDc=b;({gpl:c,bOi:f}=this.cEi(l,w,F));({hpl:b,cOi:c,M$h:f}=lv.w5i(a,c,f,b));a.runtime.RGf=f;
a.runtime.yyh=b;a.runtime.q1f=c;a.runtime.yre=new Ie.a;return!0}vAg(a,b,c){const f=new z.a;for(;a;)f.add(a),a=a.TU;const l=new Sys.StringBuilder;l.append(this.sgb("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",c,b,f.length));let w=f.length,F=0;f.forEach(S=>({Ljg:w,MAg:F}=this.T_h(l,S,f,w,F)).returnValue);Z.ULS.sendTraceTag(18613187,808,50,l.toString())}T_h(a,b,c,f,l){a.append(this.sgb(" [{0} {1} {2}]",f,b.Zia?"S":"B",b.id));f--;l++;return 50<l&&c.length!==l?(a.append(" ...Truncated."),{returnValue:!1,
Ljg:f,MAg:l}):{returnValue:!0,Ljg:f,MAg:l}}O3i(a,b,c,f){b=b.getItemAt(b.length-1-(f?1:0));c=c.getItemAt(c.length-1);f=b.PKc(c);a.runtime.DYa("GetCommonBase");return{ejl:b,$yl:c,KDc:f}}cEi(a,b,c){2===a?(a=b,b=c):a=c;return{gpl:b,bOi:a}}Ovj(a){const b=a.input,c=b.YIa,f=b.FJb;a.output.ZN=(2===b.zbc?c:f).X4k();a.runtime.DYa("InitializeOutputMergeState");return!0}SZh(a){var b=a.input.ou;const c=a.runtime.yre,f=a.output.ZN;b=this.Xwi(a,f.getItemAt(f.length-1),b,Fa.a.create());this.VOi(a,b,c);this.jtl(b,
a.input.source);f.add(b);return a.output.succeeded=!0}Xwi(a,b,c,f){a.runtime.Zgd&&Z.ULS.sendTraceTag(18613189,808,50,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",c,f);a=this.f5j(f);a.aai(b,c);return a}VOi(a,b,c){a.runtime.Zgd&&Z.ULS.sendTraceTag(18613191,808,50,"FillRevision: Adding {0} objects to merged revision.",c.count);c.forEach((f,l)=>{im.a.fea.equals(f)||b.dBf(l.Z3);return!0})}Nnl(a){const b=a.runtime,c=b.RGf,f=b.yyh,l=b.q1f,w=b.yre;let F=!0;
const S=a.runtime.mkc;let fa=0,xa=0,Za=0;f.forEach((pb,Mb)=>{S&&Z.ULS.sendTraceTag(18613193,808,100,"Merging Object: [Id: {0}] [ClassId: {1}]",pb,Mb.Oe);xa++;50===xa&&(fa++,a.runtime.DYa(this.sgb("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}]",fa,Za)),xa=0);if(lv.ibl(Mb.Oe))return!0;var hc=l.get(pb);if(!hc)return w.Kb(pb)?w.ga(pb).PRg(Mb):w.$(pb,new px(Mb,!1)),!0;if(!c.ga(pb))return F=this.Hkj(pb,hc,Mb,w);const kc=w.rMc(pb,new px(c.ga(pb),!0));({n9:hc,returnValue:F}=this.e_j.merge(a,this.d_j,this.C2j,
kc,hc,Mb));Za++;F&&(a.runtime.DYa(this.sgb("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}]",pb,Mb.Oe,Za,fa)),hc&&(w.Kb(hc.Z3.id)?w.ga(hc.Z3.id).PRg(hc.Z3):w.$(hc.Z3.id,hc)));return F});S&&Z.ULS.sendTraceTag(18613199,808,100,"TryObjectMerge: Merged {0} objects. {1} were complex merges.",f.count,Za);return F}Lyi(a,b){const c=new z.a,f=new z.a,l=new z.a;var w=a.runtime.KDc;const F=w?w.id:Fa.a.nil;this.Dbe(w).forEach(S=>{c.add(b(S));return!0});w=a.input.YIa.getItemAt(a.input.YIa.length-
1);this.Dbe(w,F).forEach(S=>{f.add(b(S));return!0});a=a.input.FJb.getItemAt(a.input.FJb.length-1);this.Dbe(a,F).forEach(S=>{l.add(b(S));return!0});return{L$h:c,fjl:f,azl:l}}Dbe(a,b=null){const c=new z.a;b||(b=Fa.a.nil);for(;a&&!b.equals(a.id);)c.add(a),a=a.TU;c.reverse();return c}wb(){}get delayedMergeOperation(){return null}set delayedMergeOperation(a){}static FUj(a,b){Z.ULS.sendTraceTag(18613146,808,50,"Sending merge backup. [Crash: {0}] [Timeout: {1}] {2}",a.output.crash,a.output.timeout,b)}static U1i(a){return a.output.crash?
2:a.output.succeeded?3:1}static w5i(a,b,c,f){let l;({result:l}=b.N4c(f));a.runtime.DYa("GetUnfavoredChanges");let w;new Ie.a;({result:w}=c.N4c(f));5===a.input.source&&(a.runtime.dOi=HC.a.Obg(c.Ujd()),a.runtime.ipl=HC.a.Obg(b.Ujd()));b=w;a.runtime.DYa("GetFavoredChanges");f=new XI(Object(C.a)(f,f.csb,"getMergeableObject"));a.runtime.DYa("GetModifiedObjects");return{hpl:l,cOi:b,M$h:f}}static ibl(a){switch(a){case 1074135137:case 1074135138:case 1074135140:return!0}return!1}}Object(e.a)(lv,"GraphMerger",
null,[835,538]);class cJ{get FAa(){return 8}get oHa(){return[]}get BJa(){return[Uc.a.rb(zb.a.PL),Uc.a.rb(zb.a.Dlc)]}get uJa(){return[]}get xNa(){return[Uc.a.rb(ob.a.rA)]}get eOa(){return[]}zF(a){return 1074135126===a.Oe}OYa(){return!0}get EAa(){return[Uc.a.rb(zb.a.cid),Uc.a.rb(zb.a.sid)]}get UXa(){return!0}}Object(e.a)(cJ,"CommentContentNodeComplexMerge",null,[604]);class dJ{get FAa(){return 8}get oHa(){return[]}get BJa(){return[Uc.a.rb(zb.a.Tob),Uc.a.rb(zb.a.SMd),Uc.a.rb(zb.a.Rob),Uc.a.rb(zb.a.iVb),
Uc.a.rb(zb.a.Yye),Uc.a.rb(zb.a.Xye),Uc.a.rb(zb.a.PL),Uc.a.rb(zb.a.Dlc),Uc.a.rb(zb.a.gMd)]}get uJa(){return[Uc.a.rb(zb.a.Tpa),Uc.a.rb(zb.a.iAa),Uc.a.rb(zb.a.IMd),Uc.a.rb(zb.a.jVb),Uc.a.rb(zb.a.BDc)]}get xNa(){return[]}get eOa(){return[]}zF(a){return 1074135127===a.Oe}OYa(){return!0}get EAa(){return[Uc.a.rb(zb.a.cid),Uc.a.rb(zb.a.sid),Uc.a.rb(zb.a.commentId),Uc.a.rb(zb.a.qva),Uc.a.rb(Sb.a.JMd),Uc.a.rb(zb.a.KMd),Uc.a.rb(zb.a.jVb),Uc.a.rb(zb.a.BDc)]}get UXa(){return!0}}Object(e.a)(dJ,"CommentNodeComplexMerge",
null,[604]);class eJ{constructor(a){this.F2c=a}get FAa(){return 8}get oHa(){return[]}get BJa(){return this.F2c.BJa}get uJa(){return[]}get xNa(){return[Uc.a.rb(ob.a.rA)]}get eOa(){return[]}zF(a){return 393326===a.Oe}OYa(){return!0}get EAa(){const a=new Ua.a;Rq.a(a,this.F2c.oHa);Rq.a(a,this.F2c.EAa);Rq.a(a,this.F2c.uJa);Rq.a(a,[Uc.a.rb(zb.a.Fub),Uc.a.rb(zb.a.P5c)]);return a.toArray()}get UXa(){return!0}}Object(e.a)(eJ,"NotesContentNodeComplexMerge",null,[604]);class fJ{get FAa(){return 8}get oHa(){return[Uc.a.rb(zb.a.yGi),
Uc.a.rb(zb.a.sGi),Uc.a.rb(zb.a.i2b),Uc.a.rb(zb.a.F5k)]}get BJa(){return[Uc.a.rb(zb.a.Tmb),Uc.a.rb(zb.a.Umb),Uc.a.rb(zb.a.dnb),Uc.a.rb(zb.a.enb),Uc.a.rb(zb.a.KAa),Uc.a.rb(zb.a.nse),Uc.a.rb(zb.a.Tre),Uc.a.rb(zb.a.ose),Uc.a.rb(zb.a.vEb),Uc.a.rb(zb.a.yEb),Uc.a.rb(zb.a.ptb),Uc.a.rb(zb.a.Kpb),Uc.a.rb(zb.a.PCb)]}get uJa(){return[]}get xNa(){return[Uc.a.rb(ob.a.bpb),Uc.a.rb(Sb.a.appsNode)]}get eOa(){return[]}zF(a){return 393271===a.Oe}get EAa(){return[Uc.a.rb(zb.a.presentationId),Uc.a.rb(zb.a.slideWidth),
Uc.a.rb(zb.a.slideHeight),Uc.a.rb(zb.a.kX),Uc.a.rb(zb.a.I9),Uc.a.rb(zb.a.Z6a),Uc.a.rb(zb.a.GAb),Uc.a.rb(zb.a.l9),Uc.a.rb(zb.a.xBb),Uc.a.rb(zb.a.xda),Uc.a.rb(zb.a.embeddedFonts),Uc.a.rb(zb.a.cHa)]}get UXa(){return!0}OYa(){return!0}}Object(e.a)(fJ,"PresentationNodeComplexMerge",null,[604]);class gJ{get FAa(){return 8}get oHa(){return[Uc.a.rb(zb.a.nHa),Uc.a.rb(zb.a.mic)]}get BJa(){return[Uc.a.rb(ob.a.font),Uc.a.rb(zb.a.zA),Uc.a.rb(zb.a.iCc),Uc.a.rb(zb.a.ndb),Uc.a.rb(zb.a.PL),Uc.a.rb(zb.a.hYa),Uc.a.rb(zb.a.Om),
Uc.a.rb(zb.a.aWa),Uc.a.rb(zb.a.rtb),Uc.a.rb(zb.a.ria),Uc.a.rb(zb.a.XXa),Uc.a.rb(zb.a.U_),Uc.a.rb(zb.a.pna),Uc.a.rb(zb.a.dXb),Uc.a.rb(zb.a.arb),Uc.a.rb(zb.a.GHa),Uc.a.rb(zb.a.Dwa),Uc.a.rb(zb.a.Tma),Uc.a.rb(zb.a.Cwa),Uc.a.rb(zb.a.mediaType),Uc.a.rb(zb.a.ndb),Uc.a.rb(zb.a.pvb),Uc.a.rb(zb.a.e1g),Uc.a.rb(zb.a.g1g),Uc.a.rb(zb.a.Hfb),Uc.a.rb(zb.a.NXa),Uc.a.rb(zb.a.emh),Uc.a.rb(zb.a.Dgd),Uc.a.rb(ob.a.pl),Uc.a.rb(ob.a.qI),Uc.a.rb(zb.a.vuh),Uc.a.rb(zb.a.wuh),Uc.a.rb(zb.a.RHb),Uc.a.rb(zb.a.TIa),Uc.a.rb(zb.a.d$),
Uc.a.rb(zb.a.Qlc),Uc.a.rb(zb.a.nCb),Uc.a.rb(zb.a.outlineWidth),Uc.a.rb(bh.a.ked),Uc.a.rb(zb.a.R$c),Uc.a.rb(pm.a.V2b),Uc.a.rb(zb.a.EM),Uc.a.rb(zb.a.jP),Uc.a.rb(zb.a.Dlc),Uc.a.rb(zb.a.ZGb),Uc.a.rb(zb.a.$Xa),Uc.a.rb(zb.a.yob),Uc.a.rb(zb.a.yvb),Uc.a.rb(zb.a.zM),Uc.a.rb(zb.a.rqh),Uc.a.rb(zb.a.stb)]}get uJa(){return[Uc.a.rb(zb.a.alt),Uc.a.rb(zb.a.altTitle),Uc.a.rb(zb.a.r9),Uc.a.rb(zb.a.isHorizontallyFlipped),Uc.a.rb(zb.a.isVerticallyFlipped),Uc.a.rb(zb.a.yia),Uc.a.rb(zb.a.shapeType),Uc.a.rb(zb.a.SHb),Uc.a.rb(zb.a.rotation),
Uc.a.rb(zb.a.uic),Uc.a.rb(zb.a.eba),Uc.a.rb(zb.a.dba),Uc.a.rb(ob.a.Bx),Uc.a.rb(ob.a.qD),Uc.a.rb(ob.a.My),Uc.a.rb(ob.a.Ny),Uc.a.rb(zb.a.widthPersisted),Uc.a.rb(zb.a.heightPersisted),Uc.a.rb(zb.a.xPersisted),Uc.a.rb(zb.a.yPersisted),Uc.a.rb(zb.a.z1),Uc.a.rb(zb.a.QQ),Uc.a.rb(zb.a.Nga),Uc.a.rb(zb.a.Mga),Uc.a.rb(zb.a.Pga),Uc.a.rb(zb.a.Oga),Uc.a.rb(zb.a.hMe),Uc.a.rb(zb.a.Agd),Uc.a.rb(zb.a.gea),Uc.a.rb(zb.a.Cgd),Uc.a.rb(zb.a.Asa),Uc.a.rb(zb.a.Xzc)]}get xNa(){return[Uc.a.rb(ob.a.rA)]}get eOa(){return[]}zF(a){return 1074135132===
a.Oe}OYa(){return!0}get EAa(){return[Uc.a.rb(zb.a.cid),Uc.a.rb(zb.a.sid),Uc.a.rb(zb.a.shapeId),Uc.a.rb(zb.a.CRa),Uc.a.rb(zb.a.Xcb),Uc.a.rb(zb.a.qGa),Uc.a.rb(zb.a.qCj),Uc.a.rb(zb.a.DK),Uc.a.rb(zb.a.isResizable),Uc.a.rb(zb.a.isEditable),Uc.a.rb(zb.a.xDa),Uc.a.rb(zb.a.eI),Uc.a.rb(zb.a.zj),Uc.a.rb(zb.a.BT),Uc.a.rb(zb.a.yOa),Uc.a.rb(zb.a.zOa),Uc.a.rb(zb.a.X6a),Uc.a.rb(zb.a.v4b),Uc.a.rb(zb.a.hasText),Uc.a.rb(zb.a.nZ),Uc.a.rb(zb.a.Gq),Uc.a.rb(zb.a.isConnected),Uc.a.rb(zb.a.Xf),Uc.a.rb(zb.a.cDa),Uc.a.rb(zb.a.ar),
Uc.a.rb(zb.a.ty),Uc.a.rb(zb.a.hq),Uc.a.rb(zb.a.Zba),Uc.a.rb(zb.a.ll),Uc.a.rb(zb.a.vS),Uc.a.rb(zb.a.sk),Uc.a.rb(zb.a.fg),Uc.a.rb(zb.a.wZ),Uc.a.rb(zb.a.Jp),Uc.a.rb(zb.a.xx),Uc.a.rb(zb.a.Fpa),Uc.a.rb(zb.a.eAc),Uc.a.rb(zb.a.zob),Uc.a.rb(ob.a.iN),Uc.a.rb(Sb.a.BZ),Uc.a.rb(zb.a.i2b),Uc.a.rb(zb.a.SXf),Uc.a.rb(zb.a.uSd),Uc.a.rb(zb.a.iPk),Uc.a.rb(zb.a.Kcd),Uc.a.rb(zb.a.mh),Uc.a.rb(zb.a.K5c),Uc.a.rb(zb.a.m3d),Uc.a.rb(zb.a.c3d),Uc.a.rb(zb.a.HR),Uc.a.rb(zb.a.Wra),Uc.a.rb(zb.a.CTb),Uc.a.rb(zb.a.UP),Uc.a.rb(zb.a.MIb),
Uc.a.rb(zb.a.embeddedFonts),Uc.a.rb(zb.a.UCa),Uc.a.rb(zb.a.Plc),Uc.a.rb(zb.a.fDh),Uc.a.rb(zb.a.z6g),Uc.a.rb(zb.a.VUc),Uc.a.rb(zb.a.Bgd),Uc.a.rb(zb.a.wda),Uc.a.rb(zb.a.nma),Uc.a.rb(zb.a.t7),Uc.a.rb(zb.a.sBb),Uc.a.rb(zb.a.tBb),Uc.a.rb(zb.a.uBb),Uc.a.rb(zb.a.rla),Uc.a.rb(zb.a.F2)]}get UXa(){return!0}}Object(e.a)(gJ,"ShapeNodeComplexMerge",null,[604]);class qx{constructor(a,b){this.O5j=a;this.y6j=b}get FAa(){return this.y6j}get oHa(){return[]}get BJa(){return[]}get uJa(){return[]}get xNa(){return[]}get eOa(){return[]}zF(a){return this.O5j(a)}OYa(){return!1}get EAa(){return[]}get UXa(){return!1}}
Object(e.a)(qx,"SimpleStrategyComplexMerge",null,[604]);class hJ{get FAa(){return 8}get oHa(){return[]}get BJa(){return[Uc.a.rb(zb.a.backgroundColor),Uc.a.rb(zb.a.wqa),Uc.a.rb(zb.a.jPe),Uc.a.rb(zb.a.r$),Uc.a.rb(zb.a.Vla),Uc.a.rb(zb.a.J9),Uc.a.rb(zb.a.IL),Uc.a.rb(zb.a.Jza),Uc.a.rb(zb.a.EM),Uc.a.rb(zb.a.jP),Uc.a.rb(zb.a.PL),Uc.a.rb(zb.a.Gwa)]}get uJa(){return[Uc.a.rb(zb.a.JYa),Uc.a.rb(zb.a.vj),Uc.a.rb(zb.a.Tn),Uc.a.rb(zb.a.Ye),Uc.a.rb(zb.a.Dga),Uc.a.rb(zb.a.WJc),Uc.a.rb(zb.a.FDf)]}get xNa(){return[Uc.a.rb(ob.a.rA),
Uc.a.rb(zb.a.notesContentNode),Uc.a.rb(Sb.a.commentContentNode)]}get eOa(){return[]}zF(a){return 393227===a.Oe}OYa(){return!0}get EAa(){return[Uc.a.rb(zb.a.cid),Uc.a.rb(zb.a.sid),Uc.a.rb(zb.a.BY),Uc.a.rb(zb.a.Uph),Uc.a.rb(ob.a.zn),Uc.a.rb(zb.a.YRa),Uc.a.rb(zb.a.Hba),Uc.a.rb(zb.a.zQa),Uc.a.rb(zb.a.i7a),Uc.a.rb(zb.a.title),Uc.a.rb(zb.a.kX),Uc.a.rb(zb.a.I9),Uc.a.rb(zb.a.i2b),Uc.a.rb(zb.a.h7a),Uc.a.rb(zb.a.$6a),Uc.a.rb(zb.a.mh),Uc.a.rb(zb.a.nma)]}get UXa(){return!0}}Object(e.a)(hJ,"SlideNodeComplexMerge",
null,[604]);class iJ{constructor(a,b){this.mEg=a;this.nYj=b}ga(a){return this.mEg.rMc(a,this.nYj)}get yTd(){return this.mEg}}Object(e.a)(iJ,"PropertyMergeStrategies",null,[]);const KC=(a,b,c,f,l)=>{if(b){f=f||new oz;if(!a){a=b=b.F3a();const w=a.yz();for(let F=0;F<w.length;F++){const S=w[F];if(nd.a.z4f(S)===nd.a.string){const fa=f.Fbg(a,S);f.vkh(a,S,fa?"Redacted: "+fa.length:"null")}}}Z.ULS.sendTraceTag(18613206,l,50,c,b.Tjd())}else Z.ULS.sendTraceTag(18613204,l,10,c,"{0}: Node was null.",c)};class jJ{constructor(a,
b,c){this.SCg=new pa.a;this.k0c=a;this.Cta=b;this.aUa=c(this.x_b());this.B2j=new sc.a(Object(C.a)(this,this.yTd,"evalPropertyMergeStrategies"))}HTj(a){if(!a.FCh){a.FCh=!0;var b=a.O4c.runtime.XJc,c=a.iak;KC(b,a.Y2a.value.GBb,"Base",c,808);KC(b,a.Y2a.value.c4,"Favored",c,808);KC(b,a.uTb.value.c4,"Conflict",c,808)}}Inl(a,b,c,f){this.tSa(a,c);const l=a.n9;if(2===f||7===f||a.Bbc.contains(c))return!0;if(5===f)return!1;if(4===f||3===f){if(({value:w}=a.Y2a.value.lWa.Nf(c)).returnValue&&w.U7a)return 4!==f;
f=0}if(0===f){if(!b.isDeleted)return l.dIa(Uc.a.Uqa(c),b.newValue),!0;f=6}if(8===f){let F=a.QDc.value;b=!0;if(({value:w}=F.lWa.Nf(c)).returnValue&&F.U7a){var w=this.k0c.T$i(a.O4c.input.source,w);void 0!==w&&null!==w?l.dIa(Uc.a.Uqa(c),w):(b=!1,f=6)}if(b)return!0}return 9===f&&(b=!0,({value:w}=a.QDc.value.lWa.Nf(c)).returnValue&&(w=this.k0c.Eeg(a.O4c.input.source,w),void 0!==w&&null!==w?l.dIa(Uc.a.Uqa(c),w):(b=!1,f=6)),b)?!0:6===f?(l.removeProperty(Uc.a.Uqa(c)),!0):1===f?this.Cta.OYa(a,c):!1}hVa(a){return a}x_b(){return[Object(C.a)(this,
this.Rnl,"tryPreProcessFavoredRevision"),Object(C.a)(this,this.omi,"cloneObjectAndRemoveNeededProperties"),Object(C.a)(this,this.Hnl,"tryMergeNodeInternal")]}get U$c(){return this.B2j.value}Gnl(a){const b=a.Y2a.value;Z.ULS.sendTraceTag(18659235,808,100,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",b.c4.id,b.c4.Oe);for(let c=0;c<this.aUa.length;c++)if(!(0,this.aUa[c])(a))return Z.ULS.sendTraceTag(18659265,808,50,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",
b.c4.id,b.c4.Oe,c),this.HTj(a),a.n9=null,!1;Z.ULS.sendTraceTag(18659267,808,100,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",b.c4.id,b.c4.Oe);return!0}Rnl(a){const b=a.Y2a.value;if(!b.U7a)return!0;const c=this.U$c;let f=!0;b.lWa.forEach((l,w)=>{if(!w.U7a||a.Bbc.contains(l))return!0;w=c.ga(l);if(5===w)return Z.ULS.sendTraceTag(18659269,808,50,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",
b.GBb.Oe,l,w),f=!1;6===w&&a.bAe.add(l);return!0});return f}omi(a){a.n9=a.Y2a.value.c4.F3a();const b=a.bAe,c=a.n9;b&&b.forEach(f=>{c.removeProperty(Uc.a.Uqa(f));return!0});return!0}Hnl(a){const b=a.uTb.value,c=b.GBb.Oe,f=this.U$c;let l=!0;b.lWa.forEach((w,F)=>{if(this.Cta.UXa&&!this.U$c.yTd.Kb(w)){var S=String.format("prop id: {0} is missed in merge handlers for class {1}, please add it",w,c);Z.ULS.sendTraceTag(18970259,808,50,S)}S=f.ga(w);l=this.Inl(a,F,w,S);l||(a.n9=null,Z.ULS.sendTraceTag(18659271,
808,50,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",c,w,S));return l});return l}B2i(){return[Uc.a.rb(ob.a.eZf),Uc.a.rb(ob.a.lastModifiedTime),Uc.a.rb(ob.a.LD),Uc.a.rb(ob.a.Aeb),Uc.a.rb(ob.a.Weh),Uc.a.rb(ne.a.jcc),Uc.a.rb(Sb.a.$oi),Uc.a.rb(Sb.a.RXf),Uc.a.rb(Fs.a.$v)]}yTd(){var a=this.B2i(),b=this.Cta.oHa,c=this.Cta.BJa,f=this.Cta.uJa,l=this.Cta.eOa,w=this.Cta.xNa;const F=this.Cta.EAa,S=new Ie.a(0);for(let fa=0;fa<a.length;fa++)S.$(a[fa],this.hVa(7));for(a=0;a<
b.length;a++)S.$(b[a],this.hVa(8));for(b=0;b<c.length;b++)S.$(c[b],this.hVa(7));for(c=0;c<f.length;c++)S.$(f[c],this.hVa(9));for(f=0;f<l.length;f++)S.$(l[f],this.hVa(1));for(l=0;l<w.length;l++)S.$(w[l],this.hVa(9)),this.SCg.add(w[l]);for(w=0;w<F.length;w++)S.$(F[w],this.hVa(this.Cta.FAa));return new iJ(S,this.hVa(this.Cta.FAa))}tSa(a,b){this.SCg.contains(b)&&(a=a.n9,Z.ULS.sendTraceTag(18956752,808,50,"Merge child nodes for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}] []",a.id,a.Oe,b))}}Object(e.a)(jJ,
"GraphNodeComplexMerge",null,[851]);class kJ{constructor(a,b){this.fl=a;this.fZc=b;this.SXj=this.Wvi()}Wvi(){const a=[];this.fl.forEach(b=>{a.push(new jJ(this.fZc,b,c=>c))});return a}Vvi(a){for(let b=0;b<this.fl.length;b++)if(this.fl[b].zF(a))return this.SXj[b];return null}}Object(e.a)(kJ,"GraphNodeComplexMergeFactory",null,[536]);class lJ{T$i(a,b){this.hCh(a);return 5===a?b.newValue:b.oldValue}Eeg(a,b){this.hCh(a);return 5===a?b.oldValue:b.newValue}hCh(a){1!==a&&5!==a&&Z.ULS.sendTraceTag(18613264,
808,15,"Unexpected merge source: {0}",a)}}Object(e.a)(lJ,"GraphNodeComplexMergeHelper",null,[834]);class mJ{constructor(a,b,c,f,l,w){this.bAe=this.Bbc=null;this.E4b=this.FCh=!1;this.n9=null;this.mkc=a.runtime.mkc;this.O4c=a;this.iak=b;this.Y2a=c;this.uTb=f;this.QDc=l;this.Ifg=w}}Object(e.a)(mJ,"GraphNodeComplexMergeState",null,[]);class nJ{constructor(a){this.aUa=a(this.x_b())}x_b(){return[Object(C.a)(this,this.abl,"simpleMerge"),Object(C.a)(this,this.qoi,"complexMerge")]}S4k(a,b,c,f,l,w){a=new mJ(a,
c,new sc.a(()=>new ox(f.Z3,l)),new sc.a(()=>new ox(f.Z3,w)),new sc.a(()=>new ox(w,l)),b.Vvi(l));a.Bbc=f.Kxc;a.bAe=new z.a;return a}merge(a,b,c,f,l,w){a=this.S4k(a,b,c,f,l,w);b=!0;for(c=0;c<this.aUa.length&&b;c++)b=(0,this.aUa[c])(a);(b=a.E4b&&a.n9?new px(a.n9,!1):null)&&b.K3k(a.Bbc);return{returnValue:a.E4b,n9:b}}abl(a){var b=a.Ifg.U$c;return a.uTb.value.zRc(b)&&a.QDc.value.zRc(b)?a.Y2a.value.zRc(b)?!0:(b=a.uTb.value.c4,a.E4b=!0,a.n9=b.F3a(),!1):(a.E4b=!0,!1)}qoi(a){const b=a.uTb.value.c4;a.mkc&&
Z.ULS.sendTraceTag(18613266,808,100,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",b.id,b.Oe);const c=a.Ifg.Gnl(a);a.E4b=c;Z.ULS.sendTraceTag(18613268,808,c?100:50,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",c?"Succeeded":"Failed",b.id,b.Oe,!!a.n9);return c}}Object(e.a)(nJ,"GraphNodeMerge",null,[537]);class Zt{constructor(a){this.k0c=a}aGi(a){const b=a.QDc.value,c=a.n9;a=a.O4c.input.source;for(const l of Zt.hed)if(({value:f}=b.lWa.Nf(l)).returnValue){var f=
this.k0c.Eeg(a,f);void 0!==f&&null!==f?c.dIa(Uc.a.Uqa(l),f):c.removeProperty(Uc.a.Uqa(l))}}get oHa(){return[Uc.a.rb(zb.a.vS),Uc.a.rb(zb.a.V7d),Uc.a.rb(zb.a.W7d),Uc.a.rb(zb.a.u7d)]}get BJa(){return[]}get uJa(){return[]}get xNa(){return[]}get eOa(){return Zt.hed}get EAa(){return[]}get UXa(){return!1}get FAa(){return 9}zF(a){return 393230===a.Oe}OYa(a,b){return 0<=Array.indexOf(Zt.hed,b)?(this.aGi(a),Zt.hed.forEach(c=>{a.Bbc.add(c)}),!0):!1}}Zt.hed=[Uc.a.rb(ob.a.Vp),Uc.a.rb(ob.a.Ngb),Uc.a.rb(ob.a.Rlc),
Uc.a.rb(ob.a.yIa),Uc.a.rb(ob.a.Nua),Uc.a.rb(Sb.a.kWa)];Object(e.a)(Zt,"ParagraphNodeComplexMerge",null,[604]);class LC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphMerge"}Yb(a){this.K=a;a.register(lJ,"PowerPointWebEditor.GraphMerge.GraphNodeComplexMergeHelper").as("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper").ma();const b=[393229,393234,1074135136,131073,1179649,393252,393250,393251];a.register(536,"PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory").ma().na(()=>
{const c=new gJ;return new kJ([new fJ,new hJ,c,new Zt(a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper")),new cJ,new dJ,new eJ(c),new qx(f=>Array.contains(b,f.Oe),9),new qx(f=>131140===f.Oe,6),new qx(f=>131164===f.Oe,8),new qx(()=>!0,5)],a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper"))});a.register(oz,"PowerPointWebEditor.GraphMerge.MergeableObjectUtilities").as("Box4.StorageObjectSpace.IMergeableObjectUtilities").ma();a.register(537,"PowerPointWebEditor.GraphMerge.IGraphNodeMerge").ma().na(()=>
new nJ(c=>c));a.register(538,"Box4.IBrowserGraphMerger").ma().na(()=>new lv(c=>new HC.a(c),a.resolve("Box4.StorageObjectSpace.IMergeableObjectUtilities"),c=>c,a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory"),a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeMerge"),(c,f,l)=>new kd.a(c,f,l),a.resolve("PowerPointWebEditor.IApplicationSettings").ZNc,a.resolve("PowerPointWebEditor.IApplicationSettings").Jsg,a.resolve("PowerPointWebEditor.IApplicationSettings").FEj,a.resolve("PowerPointWebEditor.IApplicationSettings").DEj,
a.resolve("PowerPointWebEditor.IApplicationSettings").EEj))}init(){const a=this.K.resolve("Box4.IBrowserGraphMerger");gb.App.WIa.yai(a)}dispose(){}static main(){m.a.instance.Ec(new LC)}}Object(e.a)(LC,"PPTWebEditorGraphMergePackage",null,[2,3]);class oJ{constructor(a,b){this.fl=a;this.rQ=b}vUi(a){let b=null,c=null;if(a&&a.rootNode)for(const f of this.fl)if(f.sAj(a)){c=f;const l=this.rQ.wi("UserAction",f.name);b=f.sUi(a);l.stop();break}b||za.a.J(21860568,307,15,"{0} processed {1} but did not generate any HTML",
c?c.name:"NoHandler",a&&a.rootNode?a.rootNode.type:0);return b}uUi(a){if(!a||1>a.length)return null;const b=document.createElement("div");for(const c of a)(a=this.vUi(c))&&b.appendChild(a);return b}}Object(e.a)(oJ,"HtmlExportProcessor",null,[533]);class MC{constructor(){this.dwc=null}get rootNode(){return this.dwc}clone(){return Object.assign(new MC,{dwc:this.rootNode})}}Object(e.a)(MC,"HtmlExportContext",null,[]);class pJ{tUi(a,b){const c=[];for(const f of a)b&&!b(f)||c.push(Object.assign(new MC,
{dwc:f}));return c}}Object(e.a)(pJ,"HtmlExportUtils",null,[535]);class qJ{constructor(a){this.Afe=null;this.kq=a}get rHi(){return this.Afe=this.Afe||document.createElement("div")}wUi(a,b){if(!a||!a.rootNode||!b)return null;b.Sza(this.rHi);const c=this.kq.ie(3);try{c.hd(a.rootNode),c.lIa(b.Na),b.kA(a.rootNode),b.xxa()}finally{c&&c.dispose()}a=b.d0f;b.detach();return a}}Object(e.a)(qJ,"HtmlGenerator",null,[534]);class NC{constructor(a,b,c){this.r_j=a;this.s_j=b;this.Ib=c}get name(){return"PPTTableHtmlExportHandler"}sAj(a){return 14===
a.rootNode.type?!0:10===a.rootNode.type?(a=Object(ua.a)(4,a.rootNode),!!a&&a.rd):!1}sUi(a){return this.s_j.wUi(this.Pcj(a),this.r_j)}Pcj(a){if(10===a.rootNode.type){const b=a.clone();a=this.Ib.Jc(a.rootNode);a.yb(1);b.dwc=a.yb(2);return b}return a}}Object(e.a)(NC,"PPTTableHtmlExportHandler",null,[571]);class OC extends Gg.a{constructor(a,b){super(new $o.a,a,b)}get d0f(){return this.Luh}}Object(e.a)(OC,"AHtmlExportView",Gg.a,[619,177,169,109]);class PC{}PC.hMi="ExportedPPTTable";Object(e.a)(PC,"HtmlExportConstants",
null,[]);class QC extends OC{constructor(a,b){super(a,b)}get d0f(){const a=this.Luh.getElementsByTagName("table");return 0<a.length?(Sys.UI.DomElement.addCssClass(a[0],PC.hMi),a[0]):null}get Al(){return!0}get cI(){return 480}}Object(e.a)(QC,"PPTTableHtmlExportView",OC,[]);class RC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.HtmlExport"}Yb(a){this.K=a;this.K.register(533,"PowerPointWebEditor.HtmlExport.IHtmlExportProcessor").ma().na(()=>new oJ([this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler")],
this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));this.K.register(534,"PowerPointWebEditor.HtmlExport.IHtmlGenerator").ma().na(()=>new qJ(this.K.resolve("Box4.Graph.IGraphTransactionFactory")));this.K.register(535,"PowerPointWebEditor.HtmlExport.IHtmlExportUtils").ma().na(()=>new pJ);this.eqi()}init(){}dispose(){}eqi(){this.K.register(QC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView").ma().na(()=>new QC(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("Box4.IViewManager")));
this.K.register(NC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler").ma().na(()=>new NC(this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView"),this.K.resolve("PowerPointWebEditor.HtmlExport.IHtmlGenerator"),this.K.resolve("Box4.Graph.IGraphIteratorFactory")))}static main(){m.a.instance.Ec(new RC)}}Object(e.a)(RC,"HtmlExportPackage",null,[2,3]);class pz extends Th.a{constructor(a,b){super();this.Zpc=0;this.Qvd=null;this.Ym="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' for='LanguageList' >{0}</label> </div> <div class='LanguagesListDiv' id='LanguageListDiv'> <select class='UIFont WACDialogList' id='LanguageList' size='11'> </select> <label id='SpellingLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogCheckBoxDiv' id='DoNotCheckSpellingBlock'> <input type='checkbox' id='DoNotCheckSpelling' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='DoNotCheckSpelling' >{2}</label> </div>";
this.$af=a;this.Zaf=b;this.kg="LanguageDialog"}skc(){this.Wf=this.BWd();this.Zpc=({C6g:a}=this.$af.mcg()).returnValue;var a={["LanguageList"]:10,["DoNotCheckSpelling"]:!a};this.qj(Box4Intl.Box4Strings.l_Language,Object(C.a)(this,this.w0k,"setLanguageHandler"),a);this.Qvd=document.getElementById("LanguageList");this.Zaf.Rtk(this.Qvd,this.Zpc)}BWd(){return Th.a.tA(this.Ym,Box4Intl.Box4Strings.l_MarkSelectedText,Box4Intl.Box4Strings.l_SpellingWillUseLanguage,Box4Intl.Box4Strings.l_DoNotCheckSpelling)}w0k(a,
b){if(I.a.instance.ga(70)){var c=cd.a.instance.zp(D.a.v0k);1!==a?c.properties.$("canceled","true"):(a=b.DoNotCheckSpelling,0<=b.LanguageList&&(b=parseInt(this.Qvd.value),this.$af.Pkh(b,a),c.properties.$("PreviousLCID",this.Zpc.toString()),c.properties.$("ChangedLCID",b.toString()),c.properties.$("NoProof",a.toString()),this.Zaf.u0k(b,this.Zpc)),gb.App.Fb.updateCommandUI(!0));c.end()}}}Object(e.a)(pz,"LanguageDialog",Th.a,[838]);class rJ{constructor(){this.uOj=["version","xmlns","xmlns:xlink","style"]}sanitize(a){try{const b=
{};b.inputString=a;b.unsupportedContentCallback=Object(C.a)(this,this.DOj,"jsanityUnsupportedCallBack");return jSanity.sanitize(b)}catch(b){za.a.J(38398044,815,10,"Unexpected exception when converting svg: {0}, stack: {1}",b.message,b.stack)}return null}BUk(a){var b=this.sanitize(a);let c=null;if(b&&b.innerHTML&&b.innerHTML.startsWith("<svg")){c=b.innerHTML;if(0<a.indexOf("viewBox")&&0>c.indexOf("viewBox"))if((b=a.match(RegExp('viewBox="[^"]*')))&&1===b.length&&b[0])c=c.replace("<svg",String.format('<svg {0}"',
b[0]));else return null;if(0<a.replace(" ","").indexOf('xmlns="http://www.w3.org/'))c=0<c.indexOf("xmlns=")?c:c.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else return null}return c}DOj(a,b){b=b.toLowerCase();for(const c of this.uOj)if(b===c)return;za.a.J(38398046,822,50,"JSanity unsupported callback unsupportContentName: {0}, unsupportContentValue:{1} ",a,b)}}Object(e.a)(rJ,"JSanityHelper",null,[531]);class SC extends pz{constructor(a,
b,c){super(a,c);this.qZj=b}BWd(){return this.qZj.dRa?Th.a.tA(this.Ym,Box4Intl.Box4Strings.l_MarkSelectedText,ResourceStrings.l_LanguageDialogDescription,ResourceStrings.l_DoNotCheckSpellingOrGrammar):super.BWd()}}Object(e.a)(SC,"PPTLanguageDialog",pz,[]);class sJ{constructor(a,b,c,f){this.B5j=a;this.mYj=b;this.P1j=c;this.AD=f}getInstance(a){return new SC((a?this.B5j:this.mYj)(),this.AD,this.P1j)}}Object(e.a)(sJ,"PPTLanguageDialogFactory",null,[529]);var Gk=d(111);class tJ{constructor(){this.NNe="rect,circle,ellipse,line,polyline,polygon,path";
this.Hid=[];this.Dea=[[],[1,3],[4,3],[4,3,1,3],[8,3,1,3],[8,3],[8,3,1,3,1,3],[3,1],[1,1],[3,1,1,1],[3,1,1,1,1,1]];this.Qxe=96}Aol(a,b=null){try{const c=this.g0d(a);if(!c)return null;const f=b?Jb.a.HH(b.xC):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const w=c[b];w.setAttribute(Gk.a.MUd,f);w.setAttribute(Gk.a.J1f,l)}return a}catch(c){return za.a.J(38536015,815,10,"TryUpdateSVGDomelementFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,
c.stack),null}}Sxh(a,b=null){try{const c=this.g0d(a);if(!c)return null;const f=b?Jb.a.HH(b.xC):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const w=c[b];w.setAttribute(Gk.a.jid,f);w.setAttribute(Gk.a.Zrh,l)}return a}catch(c){return za.a.J(38536017,815,10,"TryUpdateSVGDomelementLineFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}Bol(a,b){try{const f=this.g0d(a);if(!f)return null;var c=this.b$i(b);let l="";for(const w of c)l+=
w+" ";for(c=0;c<f.length;++c){if(!f[c])continue;const w=f[c];w.setAttribute(Gk.a.Yrh,l);w.setAttribute(Gk.a.cNe,"miter");w.setAttribute(Gk.a.nfl,"4");switch(b){case 8:w.setAttribute(Gk.a.bNe,"round");break;case 2:case 0:w.setAttribute(Gk.a.bNe,"butt");break;default:w.setAttribute(Gk.a.bNe,"round")}}return a}catch(f){return za.a.J(38536019,815,10,"TryUpdateSVGDomelementLineDashIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",f.message,f.stack),null}}Txh(a,b,c,f){try{if(!a)return null;
this.clh(c,b*this.Qxe*f/ke.a.$Aa,a);return a}catch(l){return za.a.J(38536021,815,10,"TryUpdateSVGDomelementLineWidthIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",l.message,l.stack),null}}d$i(){if(!this.Hid||1>this.Hid.length)this.Hid=this.NNe.split(",");return this.Hid}g0d(a){if(!a)return null;a=a.querySelectorAll(this.NNe);return 1>a.length?null:a}clh(a,b,c){if(c){var f=c.getAttribute(Gk.a.qIb)?c.getAttribute(Gk.a.qIb).toString():"";1<f.length?(f=f.substring(f.indexOf("(")+
1,f.indexOf(")")),f=f.split(","),6===f.length?(f=Math.sqrt(Math.abs(parseFloat(f[0])*parseFloat(f[3]))+Math.abs(parseFloat(f[1])*parseFloat(f[2]))),f*=a):f=a):f=a;a=c.tagName.toLowerCase();for(var l of this.d$i())if(l===a){c.setAttribute(Gk.a.dNe,(b/f).toString());break}if(c.children&&0<c.children.length)for(l=0;l<c.children.length;++l)this.clh(f,b,c.children[l])}}b$i(a){switch(a){case 0:return this.Dea[0];case 1:return this.Dea[1];case 2:return this.Dea[2];case 3:return this.Dea[3];case 4:return this.Dea[4];
case 5:return this.Dea[5];case 6:return this.Dea[6];case 7:return this.Dea[7];case 8:return this.Dea[8];case 9:return this.Dea[9];case 10:return this.Dea[10];default:return za.a.J(38536023,815,15,"GetSVGDashArray: unsupport ST_PresetLineDashVal."),this.Dea[0]}}}Object(e.a)(tJ,"SVGIconLocalEditor",null,[532]);class uJ{constructor(a,b){this.DNg=b;this.Wd=a}kI(a,b){if(!a)return!1;const c=a.l2(f=>!f.ll).length;return!this.j6k(a.hXb,c+b)}fJ(a){const b=a.Ge+1;this.Wd.YH(222,c=>{c.$C=1;c.Z4a=[b.toString(),
this.DNg.toString()];return!1})}j6k(a,b){if(!a&&b<this.DNg)return!1;za.a.J(22410754,822,50,"Can not edit. Shape count:{0}.",b);return!0}}Object(e.a)(uJ,"ShapeCountValidator",null,[530]);class TC{constructor(a,b,c,f,l,w){this.V1j=a;this.Ga=b;this.jPg=c;this.Jb=f;this.CI=l;this.Fa=w}get Eb(){return this.V1j.value}mcg(){let a,b=0;a=!0;const c=this.Eb.he();1===c.length&&c[0].cTc&&(b=this.Fa.OPa(c[0]),a=!this.Fa.d_d(c[0]));return{returnValue:b,C6g:a}}Pkh(a,b){const c=this.Eb.he();if(1===c.length&&c[0].cTc&&
this.jPg){var f=new H.DictionaryPropertySet;f.setValue(ob.a.Cs,a);f.setValue(Kd.a.Mua,b);a=this.Jb.xd(15);try{a.lc(c[0]);c[0].Tqa();const l=Object(ua.a)(4,c[0]);l&&this.CI&&this.CI.Ysl(l,b);this.jPg.KT(f);this.Ga.Bd()}finally{a&&a.dispose()}}}}Object(e.a)(TC,"ShapeLanguageEditor",null,[553]);class UC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeEdit"}Yb(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.IApplicationContext");this.K.register(pz,"Box4.UI.LanguageDialog").as("Box4.UI.ILanguageDialog").na(()=>
new SC(this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("Box4.UI.ILanguageListHelper")));this.K.register(529,"PowerPointWebEditor.IPPTLanguageDialogFactory").ma().na(()=>new sJ(()=>this.K.resolve("PowerPointWebEditor.ShapeLanguageEditor"),()=>this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.UI.ILanguageListHelper"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(TC,"PowerPointWebEditor.ShapeLanguageEditor").ma().na(()=>
new TC(this.K.qe("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.qb("Box4.ITextFormattingCommands"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(530,"PowerPointWebEditor.ShapeEdit.IShapeCountValidator").ma().na(()=>new uJ(lb.a.instance.resolve("PowerPointWebEditor.IErrorHandler"),b.kd.powerPointEditServerEditableShapeCountThreshold));
this.K.register(531,"PowerPointWebEditor.IJSanityHelper").ma().na(()=>new rJ);this.K.register(532,"PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor").ma().na(()=>new tJ)}init(){this.K.resolve("PowerPointWebEditor.IJSanityHelper")}dispose(){}static main(){m.a.instance.Ec(new UC)}}Object(e.a)(UC,"PPTWebEditorShapeEditPackage",null,[2,3]);class Ks{static get aZ(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?
"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static requestFullscreen(a){a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.requestFullscreen?a.requestFullscreen():Z.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():
document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():Z.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get o3b(){return document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.fullscreenEnabled}static get B7(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(e.a)(Ks,
"FullscreenUtils",null,[]);class vJ{get aZ(){return Ks.aZ}requestFullscreen(a){Ks.requestFullscreen(a)}exitFullscreen(){Ks.exitFullscreen()}get o3b(){return Ks.o3b}get B7(){return Ks.B7}get uKf(){return this.o3b&&!r.a.Fw}}Object(e.a)(vJ,"FullscreenUtilsProxy",null,[521]);class wJ{Y2i(a){return inkButton.InkButtonManagerFactory.createInkButtonManager(a)}}Object(e.a)(wJ,"InkButtonHelper",null,[526]);class xJ{constructor(){this.menuDefinition=null;this.autoOpenMenu=!1;this.menuHostId=null;this.autoOpenMenu=
!1;this.menuHostId="SlideshowToolbarCalloutMenuContainer"}}Object(e.a)(xJ,"FlyoutMenuExtraProps",null,[]);class rx{}rx.Cei="_136_16_N_20";rx.Dei="none";Object(e.a)(rx,"InkButtonConstants",null,[]);class qz{constructor(){this.menuDefinition=this.controlInMenuRendererFunction=this.menuHostId=this.selectedColor=this.selectedItem=this.icon=null}static create(){return{}}}Object(e.a)(qz,"InkButtonProps",null,[]);class VC{constructor(){this.onInkMenuActivity=null}}Object(e.a)(VC,"IInkButtonSettings",null,
[]);class yJ extends VC{constructor(){super()}}Object(e.a)(yJ,"InkButtonSettings",VC,[]);class zJ{constructor(){this.color=this.item=null}}Object(e.a)(zJ,"InkManagerActivity",null,[]);class rz{constructor(){this.Ske=!1;this.cpe=this.Bpe=0;this.pfe=""}get O2(){return this.Ske}set O2(a){this.Ske=a}get startingSlideIndex(){return this.Bpe}set startingSlideIndex(a){this.Bpe=a}get uea(){return this.cpe}set uea(a){this.cpe=a}get bWf(){return this.pfe}set bWf(a){this.pfe=a}get fKk(){const a={};a.IsStartRehearsal=
this.Ske;a.StartingSlideIndex=this.Bpe;a.SlideCount=this.cpe;a.DisabledRehearsalRealtimeFeaturesStr=this.pfe;return JSON.stringify(a)}}Object(e.a)(rz,"RehearsalContext",null,[524]);class sz extends Th.a{constructor(a,b,c){super(!1,!0);this.$sa=0;this.Kme=50001;this.Ua=a;this.Qd=b;this.uo=new rz;this.Za=c;this.Ua.xY(Object(C.a)(this,this.Gda,"onSlideshowExitHandler"));this.Ua.C2a(Object(C.a)(this,this.Bda,"onGetCurrentPositionHandler"));this.Ua.getCurrentPosition();this.QEa=!1}dispose(){super.dispose();
this.QEa||this.Ua.restoreFocus()}Vw(){super.Vw();document.getElementById("WACDialogOverlay").style.zIndex=String(this.Kme);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideshowSubtitleProactiveDialogContainer")}AF(){super.AF();var a=document.getElementById(this.ki("WACDialogPanel"));a.style.minWidth=Ne.a.Nc(300);a.style.width=Ne.a.Nc(300);a=document.getElementById(this.ki("WACDialogButtonPanel"));var b=document.getElementById(this.ki("WACDialogActionButton"));
a&&b&&a.removeChild(b);if(a=document.getElementById(this.ki("WACDialogCancelButton")))a.style.color="#ffffff",a.style.font="12pt",a.style.background="#A92B1A",a.innerText="Got it";if(a=document.getElementById(this.ki("WACDialogPanel"))){b=Ne.a.De();b.style.position="absolute";b.style.bottom="20px";b.style.left="20px";const c=Ne.a.Raa();c.setAttribute("href","https://support.office.com/en-ie/article/present-with-real-time-automatic-captions-or-subtitles-in-powerpoint-68d20e49-aec3-456a-939d-34a79e8ddd5f#OfficeVersion=Online");
c.setAttribute("target","_blank");c.innerText="More Tips";b.appendChild(c);a.appendChild(b)}}open(){za.a.J(41522263,830,50,"SlideshowSubtitleProactiveDialog: Open");var a=this.Qd.rk("SubtitleProactive_clearly.png");const b=this.Qd.rk("SubtitleProactive_network.png"),c=this.Qd.rk("SubtitleProactive_noNoise.png");this.Wf="<div id='subtitleDlg'><div id='captions' class='SubtitleProactiveCaptions'><label id='captionID'></label></div><div id='sectiontitle' class='SubtitleProactiveSectionTitle '><span id='sectiontitle1'><label id='str1ID'></label></span></br><span id='sectiontitle2'><label id='str2ID'></label></span></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
a+"' style='width: 190px; height: 125px;'/><span id='block1_1' class='SubtitleProactiveBlockTitle'><label id='speakStr1ID'></label></span></br></br><span id='block1_2'><label id='speakStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+c+"' style='width: 190px; height: 125px;'/><span id='block2_1' class='SubtitleProactiveBlockTitle'><label id='noiseStr1ID'></label></span></br><span id='block2_2'><label id='noiseStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
b+"' style='width: 190px; height: 125px;'/><span id='block3_1' class='SubtitleProactiveBlockTitle'><label id='networkStr1ID'></label></span></br></br><span id='block3_2'><label id='networkStr2ID'></label></span></br></br></br></div></div>";a={["captionID"]:ResourceStrings.L_SubtitleProactive_Caption,["str1ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle1,["str2ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle2,["speakStr1ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr1,["speakStr2ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr2,
["noiseStr1ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr1,["noiseStr2ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr2,["networkStr1ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr1,["networkStr2ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr2};this.qj("",Object(C.a)(this,this.Ada,"onClickHandler"),a);this.Ua.setVisibility(!0)}q6(){super.q6()}pqa(){super.pqa()}feb(){}Bda(a,b){this.Ua.GWa(Object(C.a)(this,this.Bda,"onGetCurrentPositionHandler"));this.$sa=b.slideIndex+1;this.open()}Gda(){this.QEa=
!0;this.Ua.R_(Object(C.a)(this,this.Gda,"onSlideshowExitHandler"));this.Ua.GWa(Object(C.a)(this,this.Bda,"onGetCurrentPositionHandler"));this.hide()}Ada(a){0===a&&(a=Date.now(),this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,3,a,this.uo))}static zyg(a,b,c){new sz(a,b,c)}}Object(e.a)(sz,"SlideshowSubtitleProactiveDialog",Th.a,[]);var th=d(661);class AJ{constructor(){this.buttonIdDictionary=null}}Object(e.a)(AJ,"SlideshowToolbarSettings",
null,[]);class sx extends Sys.EventArgs{constructor(a){super();this.text=a}}Object(e.a)(sx,"ReadOutEventArgs",Sys.EventArgs,[]);class WC{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){this.Exb=this.uo=this.Cc=this.sca=this.fe=this.HYc=this.rpe=this.Wi=null;this.hT=this.BUa=this.DUa=this.txb=this.tTa=this.Sie=0;this.ZK=!1;this.qie=!0;this.NZc=this.kQ=this.dqe=this.Sde=!1;this.Ua=c;this.nf=F;this.At=S;this.Za=xa;this.ia=a;this.Ha=b;this.Fqe=l;this.Nb=w;this.K_j=lb.a.instance.Oa("PowerPointWebEditor.IInkButtonHelper");
this.Qd=f;this.Or=Za}init(a,b){za.a.J(50907138,830,50,"ReactSlideshowToolbar.Init");this.qie=!0;this.Sde=!1;var c={};c[th.a.MicButton]=this.Ha.isMicButtonInSlideShowToolbarEnabled;c[th.a.PrevButton]=!0;c[th.a.NextButton]=!0;c[th.a.GridButton]=!0;c[th.a.InkButton]=!0;c[th.a.SubtitlesButton]=!0;c[th.a.LiveButton]=!0;c[th.a.MoreButton]=!0;c[th.a.ExitButton]=!0;c[th.a.CoachButton]=this.Ha.isCoachButtonInSlideShowToolbarEnabled;this.rpe=new AJ;this.rpe.buttonIdDictionary=c;if(!document.getElementById("slideshow-toolbar")){this.fe=
document.createElement("div");this.fe.id="slideshow-toolbar";this.fe.className="ReactSlideshowToolbar";this.Ha.pptEditorVoiceUXEnabled&&(this.HYc=document.getElementById("slideshowfooterContainerElement"),this.fe.className="ReactSlideshowToolbarWithFooter");c=document.createElement("div");c.id="slideshow-toolbar-accessibility";c.style.position="absolute";c.style.left="0px";c.style.top="auto";c.style.width="0px";c.style.height="0px";c.style.overflow="hidden";c.setAttribute("aria-label",ResourceStrings.l_SlideShowToolbar);
this.Ha.pptEditorVoiceUXEnabled?this.HYc.appendChild(this.fe):this.nf.appendChild(this.fe);this.Wi=slideshowToolbar.SlideshowToolbarFactory.createToolbar(this.rpe,this.fe);if(!this.Wi){za.a.J(50907140,830,10,"ReactSlideshowToolbar.Init m_slideshowToolbarManager is null.");const f=kf.a.Fh(359);u.AFrameworkApplication.zo(f);Mf.Health.instance.recordQosError(kf.a.y6(f),["SlideShowACE"],!1,!0,!0,!1,null)}this.Wi.renderToolbar();this.fe.appendChild(c);this.fe.tabIndex=0}this.sca||(this.sca=document.createElement("div"),
this.sca.id="SlideshowToolbarCalloutMenuContainer",this.sca.className="SlideshowToolbarCalloutMenuContainer",this.At()&&(this.sca.style.direction=Fe.a.oYa),this.nf.appendChild(this.sca));this.Cc=a;this.uo=b;this.Wi.registerButtonCallback(th.a.MicButton,()=>{this.gjk()});this.Wi.registerButtonCallback(th.a.CoachButton,()=>{this.Rfk()});this.Cc.Ih||this.Nb&&this.Nb.instance&&this.Nb.instance.Cq?(this.kQ=!0,this.Wi.setToolbarButtonToggleState(th.a.MicButton,this.kQ),this.Wi.showToolbarButton(th.a.MicButton)):
(this.kQ=!1,this.Wi.setToolbarButtonToggleState(th.a.MicButton,this.kQ),this.Wi.hideToolbarButton(th.a.MicButton));this.Wi.registerButtonCallback(th.a.PrevButton,f=>{this.ZBb(f)});this.Wi.registerButtonCallback(th.a.NextButton,f=>{this.UBb(f)});this.Wi.registerButtonCallback(th.a.GridButton,f=>{this.RBb(f)});this.Wi.showToolbarButton(th.a.GridButton);this.Cc.Eqb&&!this.uo.O2&&(this.Wi.registerButtonCallback(th.a.SubtitlesButton,f=>{this.x8c(f)}),this.Wi.setToolbarButtonToggleState(th.a.SubtitlesButton,
this.Cc.Ih),this.Wi.showToolbarButton(th.a.SubtitlesButton));this.Wi.registerButtonCallback(th.a.ExitButton,f=>{this.QBb(f)});this.Ha.isInkingInSlideShowEnabled&&this.Ha.isInkUIInSlideShowEnabled&&(a=qz.create(),a.icon=rx.Cei,a.selectedColor=rx.Dei,this.Wi.updateElementProps(th.a.InkButton,a),this.Wi.registerButtonCallback(th.a.InkButton,()=>{this.Ptj()}),this.Wi.showToolbarButton(th.a.InkButton));this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&!this.uo.O2&&(this.Wi.registerButtonCallback(th.a.LiveButton,
()=>{this.Pik()}),this.Wi.updateFlyoutButtonCallback(th.a.LiveButton,this.Nb.instance.Cq),this.Wi.setToolbarButtonToggleState(th.a.LiveButton,this.Nb.instance.Cq),this.Wi.showToolbarButton(th.a.LiveButton),this.Nb.instance.mCf(Object(C.a)(this,this.Ucc,"onLiveSessionStarted")),this.Nb.instance.kCf(Object(C.a)(this,this.Tcc,"onLiveSessionEnded")),this.Nb.instance.iCf(Object(C.a)(this,this.Scc,"onLiveRelaunchPausedSession")),this.Nb.instance.l2h(Object(C.a)(this,this.nYg,"onLiveCalloutMenuDefintionChanged")));
this.RIb();this.Zqb();this.Ua.xY(Object(C.a)(this,this.zla,"onExitHandler"));this.Ua.xSb(Object(C.a)(this,this.Ccb,"onBrowserEventHandler"));this.Ua.Emb(Object(C.a)(this,this.Xua,"onGetCurrentSlideDimensionsHandler"));this.Ua.Gmb(Object(C.a)(this,this.gva,"onSpecialKeyHandler"));this.Ua.ySb(Object(C.a)(this,this.Dcb,"onContextMenuHandler"));this.Ua.zSb(Object(C.a)(this,this.N6c,"onEnterEndOfShowHandler"));this.Ua.ASb(Object(C.a)(this,this.l7c,"onLeaveEndOfShowHandler"));ad.a.addHandler(this.fe,ra.a.Is,
Object(C.a)(this,this.Jcb,"onMouseOverHandler"));ad.a.addHandler(this.fe,ra.a.Wv,Object(C.a)(this,this.Wcc,"onMouseOutHandler"));ad.a.addHandler(this.sca,ra.a.click,Object(C.a)(this,this.Ada,"onClickHandler"));ad.a.addHandler(this.fe,ra.a.Rf,Object(C.a)(this,this.FGa,"onKeyDownHandler"))}H$k(){window.clearTimeout(this.Sie);this.Sie=window.setTimeout(Object(C.a)(this,this.cqj,"hideMouse"),3E3);this.Ua.L4(!0)}cqj(){this.ZK||(window.clearTimeout(this.Sie),this.Ua.L4(!1))}rC(a,b){b?this.Wi.showToolbarButton(a):
this.Wi.hideToolbarButton(a)}setToolbarButtonToggleState(a,b){this.Wi.setToolbarButtonToggleState(a,b)}show(){if(this.At()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.DUa+this.hT-16-this.Wi.getToolbarWidth()).toString()+"px";a.style.left=b}}this.Wi.showToolbar();this.Wi.enterFocusTrapZone();window.clearTimeout(this.tTa);window.clearTimeout(this.txb);this.qie?(this.tTa=window.setTimeout(Object(C.a)(this,this.hide,"hide"),2E3),this.qie=!1,this.Sde=!0):this.tTa=window.setTimeout(Object(C.a)(this,
this.hide,"hide"),3E3);this.Ua.L4(!0)}Aph(){if(this.At()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.DUa+this.hT-16-this.Wi.getToolbarWidth()).toString()+"px";a.style.left=b}}this.Wi.showToolbar();this.Wi.enterFocusTrapZone();window.clearTimeout(this.tTa);window.clearTimeout(this.txb);this.txb=window.setTimeout(Object(C.a)(this,this.hide,"hide"),1E4)}hide(){if(!this.ZK){const a=document.getElementById("slideshow-toolbar");a&&!this.Wi.isAnyToolbarElementFocused()&&document.activeElement===
a&&this.PYa(ResourceStrings.l_SlideShowToolbarDismissed);window.clearTimeout(this.tTa);window.clearTimeout(this.txb);this.Wi.hideToolbar();this.Ua.L4(!1);this.fe.style.display===Fe.a.og&&this.Ua.restoreFocus()}}Zqb(){this.ZK||(this.Sde&&this.PYa(ResourceStrings.l_SlideShowToolbarDismissed),window.clearTimeout(this.tTa),window.clearTimeout(this.txb),this.Wi.forceHideToolbar(),this.Ua.L4(!1),this.fe.style.display===Fe.a.og&&this.Ua.restoreFocus())}remove(){this.Wi.closeToolbar();this.sca.style.visibility=
Fe.a.Qs;this.NZc=!1;this.Ua.R_(Object(C.a)(this,this.zla,"onExitHandler"));this.Ua.xcd(Object(C.a)(this,this.Ccb,"onBrowserEventHandler"));this.Ua.Ehc(Object(C.a)(this,this.Xua,"onGetCurrentSlideDimensionsHandler"));this.Ua.Ghc(Object(C.a)(this,this.gva,"onSpecialKeyHandler"));this.Ua.ycd(Object(C.a)(this,this.Dcb,"onContextMenuHandler"));this.Ua.zcd(Object(C.a)(this,this.N6c,"onEnterEndOfShowHandler"));this.Ua.Acd(Object(C.a)(this,this.l7c,"onLeaveEndOfShowHandler"));ad.a.removeHandler(this.fe,ra.a.Is,
Object(C.a)(this,this.Jcb,"onMouseOverHandler"));ad.a.removeHandler(this.fe,ra.a.Wv,Object(C.a)(this,this.Wcc,"onMouseOutHandler"));ad.a.removeHandler(this.sca,ra.a.click,Object(C.a)(this,this.Ada,"onClickHandler"));ad.a.removeHandler(this.fe,ra.a.Rf,Object(C.a)(this,this.FGa,"onKeyDownHandler"));this.fe&&(this.nf.contains(this.fe)||this.HYc&&this.HYc.contains(this.fe))&&(this.ZK=!1);this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&(this.Nb.instance.Wbh(Object(C.a)(this,this.Ucc,"onLiveSessionStarted")),
this.Nb.instance.Vbh(Object(C.a)(this,this.Tcc,"onLiveSessionEnded")),this.Nb.instance.Tbh(Object(C.a)(this,this.Scc,"onLiveRelaunchPausedSession")),this.Nb.instance.WMk(Object(C.a)(this,this.nYg,"onLiveCalloutMenuDefintionChanged")))}zla(){this.remove()}PYa(a){Ja.a.Xa(a)?za.a.J(593048583,830,15,"ReactSlideshowToolbar::TryRaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.Fqe.j9g(new sx(a))}Xua(a,b){try{this.DUa=b.Yph;this.BUa=b.Vph;this.hT=b.slideWidth;if("NaN"===this.DUa.toString()||
"NaN"===this.BUa.toString()){za.a.J(51263183,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler slide dimension info is null.");const c=kf.a.Fh(359);u.AFrameworkApplication.zo(c);Mf.Health.instance.recordQosError(kf.a.y6(c),["SlideShowACE"],!1,!0,!0,!1,null)}else{const c=this.Nb.instance&&this.Nb.instance.Cq&&!this.NZc?26:0;if(this.Ha.pptEditorVoiceUXEnabled){const f=document.getElementById("slideshowfooterContainerElement");if(f){let l;l=this.At()?(this.DUa+this.hT-16-this.Wi.getToolbarWidth()).toString()+
"px":(this.DUa+2).toString()+"px";f.style.left=l;if(this.Cc.Ih&&"AboveSlide"===this.Cc.tv)f.style.bottom="0px";else{const F=ya.a.INc();a=0;const S=document.getElementById("AppHeaderPanel");S&&(a=S.clientHeight);f.style.bottom=this.Or.B7?(F-this.BUa-c).toString()+"px":(F-this.BUa-a-c).toString()+"px"}f.style.top="auto";const w=document.getElementById("ReactToolbarInnerContainer");w&&(w.style.position="relative")}}else{const f=document.getElementById("slideshow-toolbar");if(f){let l;l=this.At()?(this.DUa+
this.hT-16-this.Wi.getToolbarWidth()).toString()+"px":(this.DUa+2).toString()+"px";f.style.left=l;const w=this.Nb.instance&&this.Nb.instance.Cq?(this.BUa+c).toString()+"px":this.BUa.toString()+"px";"AboveSlide"===this.Cc.tv?(f.style.bottom="0px",f.style.top="auto"):(f.style.top=w,f.style.bottom="auto");f.style.top=w}}}this.show()}catch(c){za.a.J(51263185,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler: Exception thrown when trying to access the OnGetCurrentSlideDimensionsEventArgs, exception: {0}",
c)}}N6c(){this.NZc=!0}l7c(){this.NZc=!1}FGa(a){this.Wi.isAnyCalloutMenuOpen()||(this.ZK=!1);try{this.fe.style.display===Fe.a.wl&&(a.keyCode===x.a.Shb||a.keyCode===x.a.iB||a.keyCode===x.a.C0?this.Ua.prev():a.keyCode===x.a.Bxa||a.keyCode===x.a.hB||a.keyCode===x.a.A0?this.Ua.next():a.keyCode===x.a.WQ?this.At()?this.Ua.next():this.Ua.prev():a.keyCode===x.a.vO?this.At()?this.Ua.prev():this.Ua.next():a.keyCode===x.a.vJa?(this.dqe=!0,this.Zqb()):a.shiftKey&&a.keyCode===x.a.vna||a.keyCode===x.a.NJb?this.Zqb():
this.Ua.bjc(a))}catch(b){za.a.J(51646617,822,10,"ReactSlideshowToolbar.OnKeyDownHandler Exception in KeyDownHandler : {0}.",b)}}gva(a,b){this.Wi.isAnyCalloutMenuOpen()||(this.ZK=!1);if(b.key===x.a.NJb||b.shiftKey&&b.key===x.a.vna)a="off",this.fe.style.display===Fe.a.og?(this.Aph(),a="on"):this.Zqb(),za.a.J(51467931,830,50,"ReactSlideshowToolbar.OnSpecialKeyHandler: T key pressed, turned slideshow toolbar {0}",a)}Dcb(){if(this.dqe)this.dqe=!1;else{var a="off";this.fe.style.display===Fe.a.og?(this.Aph(),
a="on"):this.Wi.isAnyCalloutMenuOpen()||this.Zqb();za.a.J(51467933,830,50,"ReactSlideshowToolbar.OnContextMenuHandler: ContextMenu event received, turned slideshow toolbar {0}",a)}}Ccb(a,b){this.H$k();b.clientY<this.BUa+8+20&&b.clientY>this.BUa-20-8&&this.show()}Jcb(a){(a=a.target)&&this.fe.contains(a)&&(this.ZK=!0)}Wcc(a){a.target&&(this.Wi.isAnyCalloutMenuOpen()?this.sca.style.visibility=Fe.a.Ty:(this.ZK=!1,this.show()));this.Wi.isAnyCalloutMenuOpen()||this.Wi.enterFocusTrapZone()}Ada(a){this.ZK=
!1;window.clearTimeout(this.tTa);window.clearTimeout(this.txb);this.sca.style.visibility=Fe.a.Qs;this.tTa=window.setTimeout(Object(C.a)(this,this.hide,"hide"),3E3);"SlideshowToolbarCalloutMenuContainer"===a.target.id&&this.Wi.enterFocusTrapZone()}ZBb(){za.a.J(50907142,830,50,"ReactSlideshowToolbar.OnPrevClickHandler");this.Ua.prev()}UBb(){za.a.J(50907144,830,50,"ReactSlideshowToolbar.OnNextClickHandler");this.Ua.next()}QBb(){za.a.J(50907146,830,50,"ReactSlideshowToolbar.OnExitClickHandler");this.Wi.closeToolbar();
this.Ua.exit()}JPe(a){const b=!!this.Nb&&!!this.Nb.instance&&this.Nb.instance.Cq;var c=this.Cc.B0f&&5!==a&&!b;5!==a&&(this.Cc.Ih&&(Di.a.LL("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Di.a.qL)||za.a.J(591275969,822,10,"ReactSlideshowToolbar::ToggleTranscriber - Failed to set cookie for discoverability opt out to true")),this.Cc.Ih=!this.Cc.Ih);this.Wi.setToolbarButtonToggleState(th.a.SubtitlesButton,this.Cc.Ih);za.a.J(50907148,830,50,"ReactSlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Cc.Ih);this.Cc.Ih&&c&&sz.zyg(this.Ua,this.Qd,this.Za);c||(c=Date.now(),b?this.kQ||this.Nb.instance.Iqb()?this.Ua.toggleTranscriberUIVisibility(null):(this.Nb.instance.Ggg(),this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,a,c,this.uo)):this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,a,c,this.uo));this.kQ=this.Cc.Ih||b;this.Fld();this.RIb()}Fld(){this.Wi.setToolbarButtonToggleState(th.a.MicButton,
this.kQ);this.kQ?this.Wi.showToolbarButton(th.a.MicButton):this.Wi.hideToolbarButton(th.a.MicButton)}RIb(){const a=this.Cc.Ih,b=!!this.Nb&&!!this.Nb.instance&&this.Nb.instance.Cq,c=this.uo.O2,f=32!==this.ia.processAction(aa.a.cma,1);a||b||c||f?this.Wi.hideToolbarButton(th.a.CoachButton):this.Wi.showToolbarButton(th.a.CoachButton)}gjk(){za.a.J(595358498,830,50,"ReactSlideshowToolbar.OnMicToggleHandler");this.kQ=!this.kQ;this.Wi.setToolbarButtonToggleState(th.a.MicButton,this.kQ);this.Ua.setMicrophoneState(!this.kQ);
if(this.Nb&&this.Nb.instance&&this.Nb.instance.Cq&&this.kQ&&!this.Nb.instance.Iqb()){this.Nb.instance.Ggg();const a=this.Cc.Ih;this.Nb.instance.lba=!this.Cc.Ih;this.Cc.Ih=!0;this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,5,Date.now(),this.uo);this.Cc.Ih=a}}Rfk(){za.a.J(592236617,830,50,"ReactSlideshowToolbar.OnCoachClickHandler");32===this.ia.Ma(aa.a.cma,2,{entryPoint:2})?this.Ha.pptEditorRehearsalSpeechClientEnabled||(this.uo.O2=
!0):za.a.J(592236615,830,10,"ReactSlideshowToolbar.OnCoachClickHandler - Failed to start Rehearsal Session")}x8c(){za.a.J(50907150,830,50,"ReactSlideshowToolbar.OnTranscribeHandler");this.JPe(3)}RBb(){za.a.J(595206154,830,50,"ReactSlideshowToolbar.OnGridViewClickHandler");this.ia.Ma(aa.a.JGb,2,null)}Pik(){this.Nb&&this.Nb.instance&&(za.a.J(51131733,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Nb.instance.Cq),this.Nb.instance.Cq||(this.Nb.instance.Skc(3,u.AFrameworkApplication.userSessionId,
this.Ha.podsWebServiceBase,this.Za.podSessionId,u.AFrameworkApplication.$g),this.Nb.instance.lba=!this.Cc.Ih,this.Cc.Eqb&&!this.Cc.Ih&&(za.a.J(51131735,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Cc.Ih=!0,this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,5,Date.now(),this.uo),this.Cc.Ih=!1,this.kQ=!0,this.Fld()),this.ZK=!1,this.Wi.setToolbarButtonToggleState(th.a.LiveButton,!0)));this.RIb()}qIc(){return!!this.Nb&&
!!this.Nb.instance&&this.Nb.instance.E0f}Ucc(){this.Wi.setToolbarButtonToggleState(th.a.LiveButton,!0);this.Eld(!1,!1);this.kQ=!0;this.Fld();this.RIb();this.hTg()}Tcc(){this.Wi.setToolbarButtonToggleState(th.a.LiveButton,!1);this.Eld(!1,!0);this.Nb&&this.Nb.instance&&this.Nb.instance.lba&&!this.Cc.Ih&&(za.a.J(51229522,830,50,"Stopping subtitle for stopping live session."),this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,5,Date.now(),
this.uo));this.Nb.instance.lba=!1;this.Cc.Ih||(this.kQ=!1,this.Fld());this.RIb()}Scc(){this.Nb&&this.Nb.instance&&(this.ZK=!0,this.show(),this.sca.style.visibility=Fe.a.Ty,this.Eld(!0,!1),this.hTg());this.RIb()}hTg(){this.Ha.v$c&&!this.Nb.instance.Iqb()&&(this.kQ=!1,this.Wi.setToolbarButtonToggleState(th.a.MicButton,this.kQ),this.Cc.Ih=!1,this.Wi.setToolbarButtonToggleState(th.a.SubtitlesButton,this.Cc.Ih))}nYg(){this.Eld(!1,!1)}Eld(a,b){if(this.Nb&&this.Nb.instance){const c=new xJ;c.menuDefinition=
b?null:this.Nb.instance.getCalloutMenuDefinition();c.autoOpenMenu=a;this.Wi.updateElementProps(th.a.LiveButton,c);this.Wi.updateFlyoutButtonCallback(th.a.LiveButton,!b)}}Ptj(){this.K_j.execute(Object(C.a)(this,this.Otj,"initInkButton"));const a=new zJ;a.item="Init";this.Ua.Jec(a);this.Wi.registerButtonCallback(th.a.InkButton,()=>{})}Otj(a){const b=new yJ;b.onInkMenuActivity=c=>{this.pik(c)};this.Exb=a.Y2i(b);a=qz.create();a.icon=this.Exb.getIcon();a.menuDefinition=this.Exb.getControlsInMenu();a.menuHostId=
"SlideshowToolbarCalloutMenuContainer";this.Wi.updateElementProps(th.a.InkButton,a)}pik(a){this.Ua.Jec(a);a=qz.create();a.selectedColor=this.Exb.getSelectedColor();a.icon=this.Exb.getIcon();a.menuDefinition=this.Exb.getControlsInMenu();this.Wi.updateElementProps(th.a.InkButton,a);qd.a("DismissToolbarOnSelection")&&this.Zqb()}}Object(e.a)(WC,"ReactSlideshowToolbar",null,[839,840]);class XC{constructor(a,b){this.$h=a;this.T7b=document.createElement("div");this.T7b.id="slideshowfooterContainerElement";
this.T7b.className="slideshowFooterContainer";this.ia=b}init(){za.a.J(595198370,830,50,"SlideShowFooterContainer.Init");this.$h&&this.$h.appendChild(this.T7b)}remove(){this.$h&&this.$h.contains(this.T7b)&&this.$h.removeChild(this.T7b)}wb(){this.ia.ya(aa.a.Hoh,$b.a.application,Object(C.a)(this,this.a$k,"showFooterElements"));this.ia.ya(aa.a.$ig,$b.a.application,Object(C.a)(this,this.Zpj,"hideFooterElements"))}a$k(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display=
"flex");return 32}Zpj(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display=Fe.a.og);return 32}}Object(e.a)(XC,"SlideShowFooterContainer",null,[880]);var YC=d(280),BJ=d(630),aQ=d(985),CJ=d(684);class mv{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.va=new sd.a;this.AAb=this.cQg=this.p6b=null;this.Nbb=!1;this.cMb="";this.Tka=void 0===this.Tka||null===this.Tka||0===this.Tka?2:this.Tka;this.nf=a;this.la=b;this.Cc=c;this.iQg=f;this.Aca=F;this.SXc=l;this.Vh=
w;this.gk=fa;this.Nb=xa;this.wG=pb;this.Qd=Mb;this.Ua=new CJ.SlideshowFrame(this.iQg,this.nf,this.la,this.Cc,this.Nb,this.wG,this.gk,this.Aca);this.r4();this.NVc=this.Ua;this.Or=Za;this.Za=S;u.AFrameworkApplication.fa.ka("PptModernSlideShowForceEnabled")?(a={},a.loadScriptStart=Date.now(),this.wzg(a)):u.AFrameworkApplication.fa.gf(Object(C.a)(this,this.Fl,"onFullAppSettingsReady"));this.LN=this.Za.podSessionId;this.SXc&&this.SXc.execute(hc=>{hc.yzc(Object(C.a)(this,this.UWg,"onEditHappened"))});this.Vh&&
(this.Vh.P1h(Object(C.a)(this,this.hYg,"onLastMergeEditUTCChangedHandler")),this.Vh.H3h(Object(C.a)(this,this.mZg,"onRealTimeEditHandler")))}get GYb(){return this.cMb}Fl(){try{if(u.AFrameworkApplication.fa.ka("PptModernSlideShowEnabled"))if(Ja.a.Xa(this.la.sec))this.Nwa("NullPodsFileGetUrl"),za.a.J(594583686,830,15,"SlideShowSwitcher::OnFullAppSettingsReady PodsFileGetUrl is null or empty");else{var a=!1,b=!1;this.AVc({["Type"]:"StartCheckBrowser"});var c={},f=mv.WAj(c);a=this.iQg.PHf()&&this.la.NRa&&
f&&mv.VAj();b=this.la.NRa&&u.AFrameworkApplication.fa.ka("PptModernSlideShowSvgEnabled")&&mv.UAj();var l=JSON.parse(u.AFrameworkApplication.fa.Ia("Settings")),w=!!l.slideshowcore&&!!l.slideshowcore.forceSvg&&"true"===l.slideshowcore.forceSvg.toString().toLowerCase();this.Nbb=!a&&b||w;this.AVc({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:a||b,["IsModernWebGLSupportedBrowser"]:a,["IsModernSupportedBrowser"]:b,["IsBrowserShapeBuilderCompatible"]:f,["log"]:c,["useSvg"]:this.Nbb});a||b?(a={},a.loadScriptStart=
Date.now(),this.wzg(a)):this.cMb="UnsupportedBrowser"}else this.cMb="ModernSlideShowDisabled"}catch(F){this.Nwa("FailedOnFullAppSettingsReady"),za.a.J(594583682,830,10,"SlideShowSwitcher::OnFullAppSettingsReady exception in OnFullAppSettingsReady: {0}",F)}}wzg(a){var b=YC.a.create(u.AFrameworkApplication.Rj("powerpoint-slideshow-strings",3));Oi.a.nt(b);b=new Ua.a;b.add(this.Aca.loadScript("SlideShowCore"));b.add(this.Aca.loadScript("PodsProxy"));b.add(this.Aca.loadScript("PPTSpeechClient"));Promise.all(b.toArray()).catch(c=>
{this.Nwa("FailedDownloadingResources");za.a.J(594583646,830,10,"SlideShowSwitcher::LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",c)}).then(()=>this.Xlk(a)).catch(c=>{this.Nwa("FailedLoadingResources");za.a.J(594583644,830,10,"SlideShowSwitcher::LoadSlideShowResources Failed to initialize SlideShowCore: {0}",c)})}UWg(){2===this.Tka&&(za.a.J(594583640,830,50,"SlideShowSwitcher::OnEditHappened Disabling ModernSlideShow due to Edit"),this.Nwa("OnEditHappened"),this.SXc&&
this.SXc.execute(a=>{a.dNk(Object(C.a)(this,this.UWg,"onEditHappened"))}))}hYg(){2===this.Tka&&(za.a.J(594355520,830,50,"SlideShowSwitcher::OnLastMergeEditUTCChangedHandler Disabling ModernSlideShow due to Merge"),this.Nwa("OnMergeHappened"),this.Vh&&this.Vh.IMk(Object(C.a)(this,this.hYg,"onLastMergeEditUTCChangedHandler")))}mZg(){2===this.Tka&&(za.a.J(593094466,830,50,"SlideShowSwitcher::OnRealTimeEditHandler Disabling ModernSlideShow due to real time edit"),this.Nwa("OnRealTimeEditHappened"),this.Vh&&
this.Vh.TNk(Object(C.a)(this,this.mZg,"onRealTimeEditHandler")))}Nwa(a){2===this.Tka&&(this.AVc({["Type"]:"Fallback",["Reason"]:a}),this.Ua.aja()?this.Ua.xY(Object(C.a)(this,this.Tsh,"switchOnExitHandler")):(za.a.J(593610787,830,50,"SlideShowSwitcher::SwitchToLegacySlideShow Disabling ModernSlideShow since SlideShow not visible"),this.Ua=this.NVc),this.cMb=a);this.Tka=1}quj(){this.cMb=""}Tsh(){za.a.J(593610785,830,50,"SlideShowSwitcher::SwitchOnExitHandler Disabling ModernSlideShow onExit");this.Ua=
this.NVc;this.Ua.R_(Object(C.a)(this,this.Tsh,"switchOnExitHandler"))}Xlk(a){a.loadScriptEnd=Date.now();try{const b={Type:"LoadedJS"};va.a.forEach(a,(c,f)=>{b[c]=f},null);this.AVc(b);2===this.Tka&&(this.Ua.aja()?this.Ua.xY(Object(C.a)(this,this.Ysh,"switchToModernOnExitHandler")):this.Zkg())}catch(b){this.Nwa("FailedOnSlideShowCoreScriptLoaded"),za.a.J(594583630,830,10,"SlideShowSwitcher: Exception while trying to Switch Frame and Preload Shaders: {0}",b)}return null}Zkg(){this.NVc=this.Ua;const a=
new aQ.SlideShowCoreFrame(this.nf,this.la,this.Cc,this.Aca,this.gk,this.Nb,Object(C.a)(this,this.Nwa,"switchToLegacySlideShow"),this.Or,this.wG,Object(C.a)(this,this.quj,"initSlideShowCoreSucceedCallback"),this.Nbb,this.Qd);this.Ua=a;za.a.J(594583634,830,50,"SlideShowSwitcher:InitModernSlideShow Preloading Shaders");a.preloadShaders();this.r4();this.Ua.init(this.p6b,this.cQg,this.AAb,this.LN)}Ysh(){2===this.Tka&&(za.a.J(593376791,830,50,"SlideShowSwitcher:SwitchToModernOnExitHandler Switching from Legacy to ModernSlideShow"),
this.Zkg(),this.Ua.R_(Object(C.a)(this,this.Ysh,"switchToModernOnExitHandler")))}AVc(a){za.a.J(594583632,830,15,JSON.stringify(a))}init(a,b,c,f){this.p6b=a;this.cQg=b;this.AAb=c;this.LN=f;this.NVc.init(a,b,c,f);this.Ua.init(a,b,c,f)}gHb(a,b,c,f,l,w,F,S,fa){this.Ua.gHb(a,b,c,f,l,w,F,S,fa)}prev(){this.Ua.prev()}next(){this.Ua.next()}show(){this.Ua.show()}aja(){return this.Ua.aja()}ivb(){return this.Ua.ivb()}Zgb(a){this.Ua.Zgb(a)}exit(){this.Ua.exit()}irb(){this.Ua.irb()}transcribe(a,b,c,f,l,w,F){this.Ua.transcribe(a,
b,c,f,l,w,F)}setMicrophoneState(a){this.Ua.setMicrophoneState(a)}HYa(a,b=""){this.Ua.HYa(a,b)}toggleTranscriberUIVisibility(a){this.Ua.toggleTranscriberUIVisibility(a)}omc(){this.Ua.omc()}restoreFocus(){this.Ua.restoreFocus()}pausePresentation(){this.Ua.pausePresentation()}getCurrentPosition(){this.Ua.getCurrentPosition()}getCurrentPositionWithTimeLines(){this.Ua.getCurrentPositionWithTimeLines()}getCurrentSlideDimensions(){this.Ua.getCurrentSlideDimensions()}Cra(a){this.Ua.Cra(a)}VNc(a,b){this.Ua.VNc(a,
b)}refreshPodSession(a,b){this.Ua.refreshPodSession(a,b)}setVisibility(a){this.Ua.setVisibility(a)}L4(a){this.Ua.L4(a)}setOsfLocalStorage(){this.Ua.setOsfLocalStorage()}Jec(a){this.Ua.Jec(a)}bjc(a){this.Ua.bjc(a)}Sed(){this.Ua.Sed()}r4(){this.Ua.Fmb((a,b)=>{this.va.raiseEvent("OnSlideshowReady",b)});this.Ua.xSb((a,b)=>{this.va.raiseEvent("OnBrowserEvent",b)});this.Ua.Azc((a,b)=>{this.va.raiseEvent("OnFullscreenClick",b)});this.Ua.ySb((a,b)=>{this.va.raiseEvent("OnSlideshowContextMenu",b)});this.Ua.xY((a,
b)=>{this.va.raiseEvent("OnExit",b)});this.Ua.zzc((a,b)=>{this.va.raiseEvent("OnSlideshowError",b)});this.Ua.Emb((a,b)=>{this.va.raiseEvent("OnGetCurrentSlideDimensions",b)});this.Ua.C2a((a,b)=>{this.va.raiseEvent("OnGetCurrentPosition",b)});this.Ua.Gmb((a,b)=>{this.va.raiseEvent("OnSpecialKey",b)});this.Ua.Jzc((a,b)=>{this.va.raiseEvent("OnVisibilityChangeEventId",b)});this.Ua.BSb((a,b)=>{this.va.raiseEvent("OnPodSessionExpired",b)});this.Ua.Czc((a,b)=>{this.va.raiseEvent("OnLogEndOfTranscriptionSession",
b)});this.Ua.rpa((a,b)=>{this.va.raiseEvent("OnPositionChangeEventId",b)});this.Ua.Bzc((a,b)=>{this.va.raiseEvent("OnLiveSubtitlesDockedViewEventId",b)});this.Ua.zSb((a,b)=>{this.va.raiseEvent("OnEnterEndOfShowEventId",b)});this.Ua.ASb((a,b)=>{this.va.raiseEvent("OnLeaveEndOfShowEventId",b)});this.Ua.Fzc((a,b)=>{this.va.raiseEvent("OnSubtitleUpdatedEventId",b)});this.Ua.Hzc((a,b)=>{this.va.raiseEvent("OnTranscriberStartedEventId",b)});this.Ua.Lzc((a,b)=>{this.va.raiseEvent("RecordQosErrorEventId",
b)})}Fmb(a){this.va.addHandler("OnSlideshowReady",a)}Fhc(a){this.va.removeHandler("OnSlideshowReady",a)}xSb(a){this.va.addHandler("OnBrowserEvent",a)}xcd(a){this.va.removeHandler("OnBrowserEvent",a)}Azc(a){this.va.addHandler("OnFullscreenClick",a)}tDe(a){this.va.removeHandler("OnFullscreenClick",a)}ySb(a){this.va.addHandler("OnSlideshowContextMenu",a)}ycd(a){this.va.removeHandler("OnSlideshowContextMenu",a)}xY(a){this.va.addHandler("OnExit",a)}R_(a){this.va.removeHandler("OnExit",a)}zzc(a){this.va.addHandler("OnSlideshowError",
a)}sDe(a){this.va.removeHandler("OnSlideshowError",a)}Emb(a){this.va.addHandler("OnGetCurrentSlideDimensions",a)}Ehc(a){this.va.removeHandler("OnGetCurrentSlideDimensions",a)}C2a(a){this.va.addHandler("OnGetCurrentPosition",a)}GWa(a){this.va.removeHandler("OnGetCurrentPosition",a)}Gmb(a){this.va.addHandler("OnSpecialKey",a)}Ghc(a){this.va.removeHandler("OnSpecialKey",a)}Jzc(a){this.va.addHandler("OnVisibilityChangeEventId",a)}Ecd(a){this.va.removeHandler("OnVisibilityChangeEventId",a)}BSb(a){this.va.addHandler("OnPodSessionExpired",
a)}Bcd(a){this.va.removeHandler("OnPodSessionExpired",a)}Czc(a){this.va.addHandler("OnLogEndOfTranscriptionSession",a)}wDe(a){this.va.removeHandler("OnLogEndOfTranscriptionSession",a)}rpa(a){this.va.addHandler("OnPositionChangeEventId",a)}JWa(a){this.va.removeHandler("OnPositionChangeEventId",a)}Bzc(a){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",a)}vDe(a){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",a)}zSb(a){this.va.addHandler("OnEnterEndOfShowEventId",a)}zcd(a){this.va.removeHandler("OnEnterEndOfShowEventId",
a)}ASb(a){this.va.addHandler("OnLeaveEndOfShowEventId",a)}Acd(a){this.va.removeHandler("OnLeaveEndOfShowEventId",a)}Fzc(a){this.va.addHandler("OnSubtitleUpdatedEventId",a)}yDe(a){this.va.removeHandler("OnSubtitleUpdatedEventId",a)}Hzc(a){this.va.addHandler("OnTranscriberStartedEventId",a)}ADe(a){this.va.removeHandler("OnTranscriberStartedEventId",a)}Lzc(a){this.va.addHandler("RecordQosErrorEventId",a)}CDe(a){this.va.addHandler("RecordQosErrorEventId",a)}static VAj(){const a=u.AFrameworkApplication.fa.Ia("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";"),
b=md.b(u.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());za.a.J(520656851,830,50,"SlideShowSwitcher:IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return za.a.J(520733276,830,50,"IsBrowserModernWebGLCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}static UAj(){const a=
u.AFrameworkApplication.fa.Ia("PptModernSlideShowBlockListForBrowserVersion").split(";"),b=md.b(u.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());za.a.J(520656850,830,50,"SlideShowSwitcher:IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return za.a.J(520733275,830,50,"IsBrowserModernCompatible Name {0}, Version {1}",
b.Browser,b.BrowserMajorVersion),!1;return!0}static WAj(a){return BJ.a(a)}}Object(e.a)(mv,"SlideShowSwitcher",null,[525,841]);class DJ{constructor(){this.hostElement=null;this.baseZIndex=0}}Object(e.a)(DJ,"IVoiceActorSettings",null,[]);class EJ{constructor(){this.bbc=this.$h=this.Ubb=null}init(){za.a.J(595198290,830,50,"SlideShowVoiceNotification.Init");this.Ubb=document.createElement("div");this.Ubb.id="voiceNotificationContainerElement";this.Ubb.className="voiceNotificationContainer";(this.$h=document.getElementById("slideshowfooterContainerElement"))&&
this.$h.insertBefore(this.Ubb,this.$h.firstChild);const a=new DJ;a.baseZIndex=50002;a.hostElement=this.Ubb;this.bbc=voiceUI.VoiceActorFactory.CREATE_VOICE_ACTOR(a)}remove(){this.$h&&this.$h.contains(this.Ubb)&&this.$h.removeChild(this.Ubb)}show(a,b){this.bbc&&this.bbc.showNotification(a,b)}hide(){this.bbc&&this.bbc.hideNotification()}}Object(e.a)(EJ,"SlideShowVoiceNotification",null,[527]);class ZC extends Th.a{constructor(a,b){super(!1,!0);this.fac=null;this.Y9a=this.$sa=0;this.Kme=50001;this.fyb=
null;this.Ua=a;this.c3j=b;this.Ua.xY(Object(C.a)(this,this.Gda,"onSlideshowExitHandler"));this.Ua.C2a(Object(C.a)(this,this.Bda,"onGetCurrentPositionHandler"));this.Ua.getCurrentPosition();this.QEa=!1}get Ehd(){if(void 0===this.fac||null===this.fac)this.fac=document.getElementById("GotoDlgInput");return this.fac}Wvl(){if(!RegExp("^[0-9]+$").test(this.Ehd.value))return this.Ehd.value=this.$sa.toString(),!1;this.Y9a=Number.parseInvariant(this.Ehd.value);this.Y9a=Math.min(this.Y9a,this.c3j);this.Y9a=
Math.max(this.Y9a,1);return!0}dispose(){super.dispose();this.fac=null;this.QEa||this.Ua.restoreFocus()}Vw(){super.Vw();document.getElementById("WACDialogOverlay").style.zIndex=String(this.Kme);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideShowGoToDialogContainer")}AF(){super.AF();const a=document.getElementById(this.ki("WACDialogPanel"));a.style.minWidth=Ne.a.Nc(300);a.style.width=Ne.a.Nc(300)}open(){za.a.J(24133980,830,50,"SlideshowGoToDialog: Open");
this.Wf="<div id='GotoDlgLabelHolder'><label id='GotoDlgLabel'></label></div><input id='GotoDlgInput' type='text'/>";const a={["GotoDlgLabel"]:ResourceStrings.l_GotoSlideLabel,["GotoDlgInput"]:this.$sa.toString()};this.qj(ResourceStrings.L_GoTo,Object(C.a)(this,this.Ada,"onClickHandler"),a);this.Ua.setVisibility(!0);this.Ehd.focus()}q6(){super.q6();this.fyb=Object(C.a)(this,this.FGa,"onKeyDownHandler");u.AFrameworkApplication.Ba.EF.Zbd(ra.a.Rf,window.document,this.fyb,null)}pqa(){super.pqa();void 0!==
this.fyb&&null!==this.fyb&&u.AFrameworkApplication.Ba.EF.HRe(ra.a.Rf,window.document,this.fyb);this.fyb=null}feb(){}Bda(a,b){this.Ua.GWa(Object(C.a)(this,this.Bda,"onGetCurrentPositionHandler"));this.$sa=b.slideIndex+1;this.open()}Gda(){this.QEa=!0;this.Ua.R_(Object(C.a)(this,this.Gda,"onSlideshowExitHandler"));this.Ua.GWa(Object(C.a)(this,this.Bda,"onGetCurrentPositionHandler"));this.hide()}FGa(a){a=a.nc.keyCode;return a===x.a.Xp?(this.Wvl()&&(this.Cra(this.Y9a),this.hide()),!0):a===x.a.OJb||a===
x.a.Ahb||a===x.a.TBh||a===x.a.kmd?!0:!1}Ada(a){1===a&&this.Cra(this.Y9a)}Cra(a){this.Ua.Cra(a-1)}static OPj(a,b){1>=b||void 0!==Xh.a.zw&&null!==Xh.a.zw||new ZC(a,b)}}Object(e.a)(ZC,"SlideshowGoToDialog",Th.a,[]);class $C{constructor(a,b,c,f,l,w,F,S,fa){this.s3=this.K=null;this.Jxb=!1;this.d3=[];this.dTa=this.vD=this.X7b=null;this.Ua=a;this.Ub=b;this.pta=c;this.ia=f;this.Ue=l;this.nf=w;this.At=F;this.Or=S;this.Nb=fa}init(){this.K||(this.K=document.createElement("div"),this.K.id="SlideshowContextMenuContainer",
this.K.className="SlideshowContextMenuContainer");this.s3=document.createElement("div");this.s3.className="SlideshowContextMenu cui-menu";this.s3.tabIndex=0;const a=document.createElement("ul");a.className="SlideshowContextMenuList cui-menusection-items";const b=this.At();let c=this.cK(ResourceStrings.L_Next,Object(C.a)(this,this.UBb,"onNextClickHandler"),b);Array.add(this.d3,c);a.appendChild(c);c=this.cK(ResourceStrings.L_Previous,Object(C.a)(this,this.ZBb,"onPrevClickHandler"),b);Array.add(this.d3,
c);a.appendChild(c);c=this.cK(ResourceStrings.l_GotoCell,Object(C.a)(this,this.$hk,"onGoToClickHandler"),b);Array.add(this.d3,c);a.appendChild(c);c=this.cK(ResourceStrings.L_GridView_SeeAllSlides,Object(C.a)(this,this.RBb,"onGridViewClickHandler"),b);Array.add(this.d3,c);a.appendChild(c);this.Or.uKf&&(this.X7b=this.cK(this.Or.B7?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen,Object(C.a)(this,this.EGa,"onFullscreenClickHandler"),b),Array.add(this.d3,this.X7b),a.appendChild(this.X7b),
this.Or.aZ&&!this.vD&&(this.vD=Object(C.a)(this,this.Kcc,"onFullscreenChangeHandler"),$addHandler(this.nf,this.Or.aZ,this.vD)));c=this.cK(ResourceStrings.L_EndShow,Object(C.a)(this,this.QBb,"onExitClickHandler"),b);Array.add(this.d3,c);a.appendChild(c);this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&(this.dTa=this.cK(ResourceStrings.l_EndLivePresentation,Object(C.a)(this,this.bhk,"onEndLivePresentationClickHandler"),b),Array.add(this.d3,this.dTa));this.s3.appendChild(a);this.K.appendChild(this.s3);
this.nf.appendChild(this.K);this.pta.addHandler(this.K,ra.a.click,Object(C.a)(this,this.Ada,"onClickHandler"));this.pta.addHandler(this.K,ra.a.contextMenu,Object(C.a)(this,this.LXg,"onHostContextMenuHandler"));this.pta.addHandler(this.s3,ra.a.Is,Object(C.a)(this,this.Jcb,"onMouseOverHandler"));this.Ua.ySb(Object(C.a)(this,this.Dcb,"onContextMenuHandler"));this.Ua.xY(Object(C.a)(this,this.zla,"onExitHandler"))}show(){if(this.Nb&&this.Nb.instance&&this.Nb.instance.Cq&&this.dTa&&!this.dTa.parentNode){const a=
this.s3.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].appendChild(this.dTa)}this.Jxb||(this.pta.addHandler(window.document,ra.a.Rf,Object(C.a)(this,this.FGa,"onKeyDownHandler")),this.pta.addHandler(window.document,ra.a.ol,Object(C.a)(this,this.Rcc,"onKeyUpHandler")),this.Jxb=!0);this.K.style.visibility=Fe.a.Ty}hide(){this.pta.removeHandler(window.document,ra.a.Rf,Object(C.a)(this,this.FGa,"onKeyDownHandler"));this.pta.removeHandler(window.document,ra.a.ol,
Object(C.a)(this,this.Rcc,"onKeyUpHandler"));this.Jxb=!1;this.K.style.visibility=Fe.a.Qs;if(this.dTa&&this.dTa.parentNode){const a=this.s3.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].removeChild(this.dTa)}}remove(){this.K&&(this.pta.removeHandler(this.K,ra.a.click,Object(C.a)(this,this.Ada,"onClickHandler")),this.pta.removeHandler(this.K,ra.a.contextMenu,Object(C.a)(this,this.LXg,"onHostContextMenuHandler")),this.nf.contains(this.K)&&this.nf.removeChild(this.K));
this.K=null;Array.clear(this.d3)}zla(){this.Ua.R_(Object(C.a)(this,this.zla,"onExitHandler"));this.Ua.ycd(Object(C.a)(this,this.Dcb,"onContextMenuHandler"));this.X7b&&($removeHandler(this.nf,this.Or.aZ,this.vD),this.vD=null);this.remove()}Ada(a){"SlideshowContextMenuContainer"===a.target.id&&(this.hide(),this.Ua.restoreFocus())}Dcb(a,b){this.w0g(b.clientX,b.clientY)}LXg(a){this.w0g(a.clientX,a.clientY)}Jcb(a){(a=a.target)&&"li"===a.tagName.toLowerCase()&&(this.YCe(document.activeElement),this.KQ(a))}FGa(a){const b=
a.keyCode,c=a.shiftKey;b===x.a.tq||b===x.a.k5?this.jTg(!!(1^c)):b===x.a.OX&&this.jTg(!!(0^c));a.preventDefault()}Rcc(a){var b=a.keyCode;b===x.a.Xp||b===x.a.wO?(b=document.activeElement,Array.contains(this.d3,b)&&b.click()):b===x.a.B0&&this.Ua.exit();a.preventDefault()}w0g(a,b){this.setPosition(a,b);this.nli();this.show();this.s3.focus();this.Ue.i9g(new sx(ResourceStrings.L_ControlMenu))}setPosition(a,b){if(this.s3){var c=this.s3.offsetWidth,f=this.s3.offsetHeight,l=this.K.clientHeight;a+c>this.K.clientWidth&&
(a-=c);b+f>l&&(b-=f);this.s3.style.top=Ne.a.Nc(b);this.s3.style.left=Ne.a.Nc(a)}}cK(a,b,c){const f=document.createElement("li");f.className="SlideshowContextMenuItem cui-ctl-mediumlabel";f.innerText=a;f.style.direction=c?"rtl":"ltr";f.tabIndex=1;this.pta.addHandler(f,ra.a.click,b);return f}ZBb(){za.a.J(24133957,830,50,"SlideshowContextMenu.OnPrevClickHandler");this.Ua.prev();this.hide();this.Ua.restoreFocus()}UBb(){za.a.J(24133959,830,50,"SlideshowContextMenu.OnNextClickHandler");this.Ua.next();this.hide();
this.Ua.restoreFocus()}$hk(){za.a.J(24133961,830,50,"SlideshowContextMenu.OnGoToClickHandler");this.hide();ZC.OPj(this.Ua,this.Ub.wj())}RBb(){za.a.J(50602842,830,50,"SlideshowContextMenu.OnGridViewClickHandler");this.hide();this.ia.Ma(aa.a.JGb,2,null)}EGa(){za.a.J(40935580,830,50,"SlideshowContextMenu.OnFullscreenClickHandler");this.Ua.omc();this.hide();this.Ua.restoreFocus()}Kcc(){this.X7b.innerText=this.Or.B7?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen}QBb(){za.a.J(24133963,
830,50,"SlideshowContextMenu.OnExitClickHandler");this.hide();this.Ua.exit()}bhk(){za.a.J(50619421,830,50,"SlideshowContextMenu.OnEndLivePresentationClickHandler");this.hide();this.Ua.restoreFocus();this.Nb&&this.Nb.instance&&this.Nb.instance.Cq&&this.Nb.instance.showEndSessionDialog(()=>{this.Nb.instance.aYb(4)},()=>{})}jTg(a){const b=document.activeElement,c=Array.indexOf(this.d3,b);a=this.d3[((-1===c?a?0:-1:a?c+1:c-1)+this.d3.length)%this.d3.length];void 0!==a&&null!==a&&(this.YCe(b),this.KQ(a))}nli(){this.d3.forEach(a=>
{this.YCe(a)})}KQ(a){void 0!==a&&null!==a&&(Sys.UI.DomElement.addCssClass(a,"SlideshowContextMenuItemFocus"),a.focus(),this.Ue.i9g(new sx(a.innerText)))}YCe(a){void 0!==a&&null!==a&&Sys.UI.DomElement.removeCssClass(a,"SlideshowContextMenuItemFocus")}}Object(e.a)($C,"SlideshowContextMenu",null,[840]);var tx=d(257);class FJ{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we){this.va=new sd.a;this.vD=null;this.ppe=this.qpe=this.V2c=this.jac=-1;this.uCg=this.wCg=this.vCg=this.hyb=null;this.X5b=
"";this.d4c=this.$2c=-1;this.rJg=new Date(0);this.eJg="";this.UDg=null;this.yFg=this.x$a=this.Whe=this.Vje=!1;this.wFa=this.uo=this.Cc=null;this.U6b=-1;this.gFg=!1;this.Or=a;this.Ua=b;this.Eca=c;this.Ub=fa;this.la=F;this.YXj=f;this.Yh=l;this.Dz=w;this.Hs=S;this.Za=xa;this.Ey=Za;this.Wd=pb;this.hua=Mb;this.Oc=hc;this.j4c=kc;this.tua=Ec;this.It=this.Hs.iG();this.xOg=this.la.pptEditorHermesSlideShowStartTimeout;this.Jqe=this.la.slideShowWaitForRehydrationTimeoutInMs;this.Oc.wB(Object(C.a)(this,this.ZA,
"onSessionEnd"));this.Ey.uGd(Object(C.a)(this,this.YBb,"onPodSessionUnavailable"));this.Oc.xB(Object(C.a)(this,this.eo,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&(this.Ey.Hmb(Object(C.a)(this,this.Cda,"onPodSessionRefreshed")),this.Ey.pCf(Object(C.a)(this,this.P7c,"onPodSessionRefreshedFromBrowser")));this.ia=Hc;this.Nb=Dc;this.T2c=Td;this.gk=we;a=document.createElement("div");a.id="HiddenFocusTrapAnchor";u.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")||
u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?a.style.position="absolute":a.style.position="position: absolute";a.style.left="-10000px";a.style.top="auto";a.style.width="1px";a.style.height="1px";a.style.overflow="hidden";a.tabIndex=-1;this.It.insertBefore(a,this.It.firstChild)}dispose(){this.Oc.aea(Object(C.a)(this,this.ZA,"onSessionEnd"));this.Ey.PNk(Object(C.a)(this,this.YBb,"onPodSessionUnavailable"));this.Oc.cea(Object(C.a)(this,this.eo,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&
(this.Ey.ieb(Object(C.a)(this,this.Cda,"onPodSessionRefreshed")),this.Ey.Ybh(Object(C.a)(this,this.P7c,"onPodSessionRefreshedFromBrowser")))}ruj(a,b,c,f){this.UDg=b;this.Ua.init(a,b,c,this.Za.podSessionId);this.Cc=f;this.uo=new rz}y4b(){return!Ja.a.Xa(this.X5b)}get W3d(){return this.x$a}set W3d(a){this.x$a=a}Sia(){return!!this.Ua&&this.Ua.ivb()}gHb(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){Mf.Health.instance.addQosPillar("Present");this.y4b()&&za.a.J(37558114,830,15,"SlideshowManager:StartFrom starting a new SlideShow while one is already running");
u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&(this.wFa=lb.a.instance.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager"))&&this.wFa.T$a&&(this.U6b=b,this.ia.processAction(aa.a.shd,2,null),this.wFa.R2h(Object(C.a)(this,this.mkk,"onPresenterViewSyncMessageReceivedHandler")));c&&this.Sia()&&u.AFrameworkApplication.fa.ka("PptModernSlideShowDisabledForCoach")&&Object(ua.a)(mv,this.Ua).Nwa("StartFromCoach");const hc=c;this.la.pptEditorRehearsalSpeechClientEnabled&&(c=!1);this.jac=
xa;this.V2c=Date.now();const kc=document.createElement("div");kc.id="startingSlideshowHiddenDiv";kc.style.position="position: absolute";kc.style.left="-10000px";kc.style.top="auto";kc.style.width="1px";kc.style.height="1px";kc.style.overflow="hidden";kc.tabIndex=-1;kc.setAttribute("aria-live","assertive");this.It.insertBefore(kc,this.It.firstChild);kc.innerText=ResourceStrings.l_StartingSlideShow;const Ec=S+xa.toString();this.X5b=Ec;this.hua&&this.hua.Ajc(!0);this.la.mLj&&this.j4c&&this.j4c.Ajc(!0);
this.uo&&(this.uo.O2=c,this.uo.startingSlideIndex=b,this.uo.uea=this.Ub.wj(),this.uo.bWf=this.la.gKk);this.la.pptEditorVoiceUXEnabled&&this.T2c&&this.T2c.init();this.la.pptEditorVoiceUXEnabled&&this.gk&&this.gk.execute(Dc=>{Dc.init()});this.Eca.execute(Dc=>{Dc.init(this.Cc,this.uo)});this.vCg=this.It.style.top;this.It.style.top=Ne.a.Nc(0);this.la.GRa&&(this.wCg=this.It.style.width,this.uCg=this.It.style.height,this.It.style.width="100%",this.It.style.height="100%");this.Ua.show();this.Dyg();this.la.cqh&&
Jr.a.AIb(!1);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.wFa&&this.wFa.T$a&&this.Ua.rpa(Object(C.a)(this,this.h8c,"onSlideChangedHandler"));this.Ua.xY(Object(C.a)(this,this.zla,"onExitHandler"));this.Ua.Azc(Object(C.a)(this,this.EGa,"onFullscreenClickHandler"));this.Ua.Fmb(Object(C.a)(this,this.w_g,"onSlideshowReadyHandler"));this.Ua.zzc(Object(C.a)(this,this.P6c,"onErrorHandler"));this.Ua.Gmb(Object(C.a)(this,this.gva,"onSpecialKeyHandler"));this.Ua.BSb(Object(C.a)(this,this.O7c,
"onPodSessionExpiredHandler"));this.Ua.Czc(Object(C.a)(this,this.p7c,"onLogEndOfTranscriptionSessionHandler"));this.Ua.Bzc(Object(C.a)(this,this.o7c,"onLiveSubtitlesDockedViewHandler"));this.Ua.Lzc(Object(C.a)(this,this.chc,"recordQosErrorHandler"));this.la.allowDisablingSlideShowButtonDueToRehydration||(this.Ey.Hmb(Object(C.a)(this,this.Cda,"onPodSessionRefreshed")),this.Ey.pCf(Object(C.a)(this,this.P7c,"onPodSessionRefreshedFromBrowser")));this.M2h(Object(C.a)(this,this.j7c,"onKeydownHandler"));
c=Date.now();let Hc=!this.la.Qug||Za;Hc||(Hc=this.Yh.YKc().JP());this.gFg=Hc;xa=Date.now();za.a.J(38285335,830,50,"SlideshowManager: Outbound decision time in {0} ms, fWaitForForceOutbound is {1}, fFailOverInProgress is {2}.",xa-c,Hc?"True":"False",Za?"True":"False");this.qpe=Date.now();this.Yh.YKc().forceOutbound(()=>{za.a.J(23667358,830,50,"SlideshowManager: Will notify Replication Cache to flush unsaved revisions.");this.Yh.flush(()=>{this.ppe=Date.now();za.a.J(23667360,830,50,"SlideshowManager: Finished flushing in {0} ms.",
this.ppe-this.qpe);this.X5b===Ec&&Hc&&(Za&&pb&&(za.a.J(38311374,830,50,"SlideshowManager: Refreshing the pod sessionId."),l=pb.qk,w=pb.podSessionId),this.mrh(a,b,f,l,w,F,S,fa,Mb,hc),za.a.J(38285339,830,50,"SlideshowManager: Launched slideshow after ForceOutbound response."))},Dc=>{za.a.J(23667362,830,10,"SlideshowManager: Failed to make Replication Cache flush unsaved revisions. {0}",Dc.ServerError);return!1})},(Dc,Td)=>{za.a.J(23667392,830,10,"SlideshowManager: Failed to force outbound. {0}",Td)},
null);this.X5b!==Ec||Hc||(this.mrh(a,b,f,l,w,F,S,fa,Mb,hc),za.a.J(38285343,830,50,"SlideshowManager: Launched slideshow without waiting for ForceOutbound."))}mrh(a,b,c,f,l,w,F,S,fa,xa=!1){const Za=xg.a.create().toString();this.la.Ssg&&this.Vrk(c,l,F,Za);let pb="";Object(Ca.a)(841,this.Ua)&&(pb=Object(ua.a)(841,this.Ua).GYb);const Mb={};Mb.SlideShowKind=this.Sia()?"Modern":"Legacy";Mb.IsFrameNull=this.Ua?"false":"true";Mb.slideshowClickTimeMs=this.jac;void 0!==window.performance.timing&&null!==window.performance.timing&&
(Mb.slideshowClickTimePerformanceAPI=this.jac-window.performance.timing.navigationStart);Mb.FallbackReason=pb;za.a.J(590976135,830,15,JSON.stringify(Mb));this.Ua.gHb(a,b,f,l,w,F,S,Za,this.jac);0<this.xOg&&(this.$2c=window.setTimeout(Object(C.a)(this,this.mmk,"onStartSlideshowTimeoutHandler"),this.xOg));this.Nb&&this.Nb.instance&&this.Nb.instance.k8c(a,b,c,f,l,w,F,u.AFrameworkApplication.$g,fa);this.Cc&&this.Cc.fVk();xa&&(this.Cc.Ih=!1);qd.a("PresenterCoachTabFix")&&this.Ua.Sed()}gva(a,b){if(b.key===
x.a.B0)za.a.J(39174995,830,50,"SlideshowManager.OnSpecialKeyHandler Esc key"),this.Eca.execute(c=>{c.remove()}),this.Ua.exit();else if(b.key===x.a.LJb)this.ia.Ma(aa.a.$jd,2,null);else if(b.key===x.a.hnd&&this.la.cja&&this.Cc&&this.Cc.iBa&&this.uo&&this.Ub&&!this.uo.O2&&this.la.UMj&&this.Cc.D0f)try{this.Cc.Ih&&(Di.a.LL("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Di.a.qL)||za.a.J(591275920,822,10,"SlideShowManager::OnSpecialKeyHandler - Failed to set cookie for discoverability opt out to true"));
this.Cc.Ih=!this.Cc.Ih;za.a.J(40469001,830,50,"SlideshowManager.OnSpecialKeyHandler m_subtitleContext FUseSubtitles is changed to: {0}",this.Cc.Ih);const c=document.getElementById("buttonSubtitle");if(c){const l=c.getElementsByTagName("span")[0].getElementsByTagName("img")[0];l&&(l.className=this.Cc.Ih?"prt2_SubtitleSlideShowToggleHover_40x40x32":"prt2_SubtitleSlideShowToggleOff_40x40x32")}const f=!!this.Nb&&!!this.Nb.instance&&this.Nb.instance.Cq;if(f)this.Ua.toggleTranscriberUIVisibility(null);
else{let l=Date.now();this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,4,l,this.uo)}this.Eca.execute(l=>{l.setToolbarButtonToggleState(th.a.SubtitlesButton,this.Cc.Ih);l.rC(th.a.CoachButton,!this.Cc.Ih&&!f)})}catch(c){za.a.J(40469003,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the J key: {0}",c)}else if(b.key===x.a.goc&&this.Nb&&this.Nb.instance&&this.Nb.instance.iBa&&this.Nb.instance.TMi&&this.uo&&
!this.uo.O2)try{if(this.Nb.instance.Cq)this.Nb.instance.showWelcomeScreen();else{this.Nb.instance.lba=!this.Cc.Ih;if(this.Cc.Eqb&&!this.Cc.Ih){this.Cc.Ih=!0;let c=Date.now();this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,5,c,this.uo);this.Cc.Ih=!1}this.Nb.instance.Skc(4,u.AFrameworkApplication.userSessionId,this.la.podsWebServiceBase,this.Za.podSessionId,u.AFrameworkApplication.$g)}}catch(c){za.a.J(42819932,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the L key: {0}",
c)}}mkk(a,b){b&&(a=b.slideIndex,a!==this.U6b&&(this.U6b=a,this.Ua.Cra(a)))}UVa(){za.a.J(38412615,830,50,"OnVisibilityChangeHandler: Full screen exited due to tab visibility change.");this.Vje=!0}Vrk(a,b,c,f){za.a.J(23667394,830,50,"SlideshowManager.PauseResumeMerge. correlationId: {0}",f);a=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked={2}",a,b,!0);b={WaitForSessionTimeoutMs:"0"};b["X-UserSessionId"]=c;b["X-CorrelationID"]=f;b["X-WacCluster"]=this.UDg;this.Dz.Jj(a,2,
null,b,!1,2,()=>{za.a.J(23667396,830,50,"SlideshowManager.PauseResumeMerge: Pause/resume merge succeeded. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},()=>{za.a.J(23667398,830,10,"SlideshowManager.PauseResumeMerge: Pause/resume merge failed. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},null,void 0,void 0,void 0,void 0,tx.a("14"))}xY(a){this.va.addHandler("OnExitSlideshow",a)}R_(a){this.va.removeHandler("OnExitSlideshow",a)}rpa(a){this.va.addHandler("OnPositionChangeEventId",
a)}JWa(a){this.va.removeHandler("OnPositionChangeEventId",a)}M2h(a){this.hyb||(this.hyb=a,ad.a.addHandler(window.document.body,"keydown",this.hyb))}uDe(){this.hyb&&(ad.a.removeHandler(window.document.body,"keydown",this.hyb),this.hyb=null)}Kcc(){if(this.Or.B7)za.a.J(39203606,830,50,"SlideshowManager.OnFullscreenChangeHandler still in full screen");else{this.sMf();this.Ua.Ecd(Object(C.a)(this,this.UVa,"onVisibilityChangeHandler"));za.a.J(23954831,830,50,"SlideshowManager.OnFullscreenChangeHandler: Leaving full screen mode.");
var a=u.AFrameworkApplication.fa.Ia(u.AFrameworkApplication.lJ);a=!!a&&"teams"===a.toLowerCase();this.Vje||this.Whe||!document.hasFocus()||a||(za.a.J(39203609,830,50,"SlideshowManager.OnFullscreenChangeHandler: Exiting SlideshowFrame"),this.Eca.execute(b=>{b.remove()}),this.Ua.exit());this.Vje=!1}this.Whe=!1}h8c(a,b){b&&this.U6b!==b.slideIndex&&(this.U6b=b.slideIndex,this.wFa.OXk(b))}zla(a,b){za.a.J(39203611,830,50,"SlideshowManager.OnExitHandler Exiting SlideShow.");this.WMf();var c=["WACInnerFrame",
"WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var f of c)(c=document.getElementById(f))&&Sys.UI.DomElement.removeCssClass(c,"SlideShowAXItemNavigationFocusTrap");this.X5b="";this.hua&&this.hua.Ajc(!1);this.j4c&&this.j4c.Ajc(!1);this.Cc&&this.Cc.qSk();this.Ua.R_(Object(C.a)(this,this.zla,"onExitHandler"));this.Ua.tDe(Object(C.a)(this,this.EGa,"onFullscreenClickHandler"));this.Ua.Fhc(Object(C.a)(this,this.w_g,"onSlideshowReadyHandler"));this.Ua.sDe(Object(C.a)(this,
this.P6c,"onErrorHandler"));this.Ua.Ghc(Object(C.a)(this,this.gva,"onSpecialKeyHandler"));this.Ua.Ecd(Object(C.a)(this,this.UVa,"onVisibilityChangeHandler"));this.Ua.Bcd(Object(C.a)(this,this.O7c,"onPodSessionExpiredHandler"));this.Ua.wDe(Object(C.a)(this,this.p7c,"onLogEndOfTranscriptionSessionHandler"));this.Ua.vDe(Object(C.a)(this,this.o7c,"onLiveSubtitlesDockedViewHandler"));this.Ua.CDe(Object(C.a)(this,this.chc,"recordQosErrorHandler"));this.uDe(Object(C.a)(this,this.j7c,"onKeydownHandler"));
(f=document.getElementById("startingSlideshowHiddenDiv"))&&f.parentNode.removeChild(f);this.la.allowDisablingSlideShowButtonDueToRehydration||(this.Ey.ieb(Object(C.a)(this,this.Cda,"onPodSessionRefreshed")),this.Ey.Ybh(Object(C.a)(this,this.P7c,"onPodSessionRefreshedFromBrowser")));this.la.cqh&&(Jr.a.AIb(!0),this.Or.B7||hG.a.gXa(u.AFrameworkApplication.isRtl));this.sMf();Ks.exitFullscreen();this.It.style.top=this.vCg;this.la.GRa&&(this.It.style.width=this.wCg,this.It.style.height=this.uCg);this.Hs.Mq();
this.va.raiseEvent("OnExitSlideshow",b,a);this.Nb&&this.Nb.instance&&this.Nb.instance.Ylk();this.uo&&this.uo.O2&&b.summary&&this.ia.Ma(aa.a.rIa,2,b.summary);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.wFa&&this.wFa.T$a&&this.ia.processAction(aa.a.jDc,2,null);this.uo&&(this.uo.O2=!1);this.la.pptEditorVoiceUXEnabled&&this.gk&&this.gk.instance&&this.gk.instance.remove();this.la.pptEditorVoiceUXEnabled&&this.T2c&&this.T2c.remove();this.Ell()}Ell(){u.AFrameworkApplication.fa.ka(ba.a.pa(798))&&
lb.a.instance.Oa("Common.ISystemInitiatedFeedback").execute(a=>{window.setTimeout(()=>{za.a.J(593592415,830,15,"Trigger NPS after slideshow");a.logActivity("AppUsageTimeSatisfiedNPS",null)},1E3)})}EGa(){this.Whe=!0;this.Or.B7?Ks.exitFullscreen():this.Dyg()}Dyg(){this.Or.o3b&&(this.Or.aZ&&!this.vD&&(this.vD=Object(C.a)(this,this.Kcc,"onFullscreenChangeHandler"),$addHandler(this.It,this.Or.aZ,this.vD)),this.Or.requestFullscreen(this.It),this.Ua.Jzc(Object(C.a)(this,this.UVa,"onVisibilityChangeHandler")))}w_g(){this.WMf();
var a=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var b of a)(a=document.getElementById(b))&&Sys.UI.DomElement.addCssClass(a,"SlideShowAXItemNavigationFocusTrap");if(-1!==this.V2c){b=Date.now();za.a.J(23098073,830,15,"slideshow ready in {0} ms",b-this.V2c);a={};a.SlideshowClickTimeMs=this.jac;a.SlideshowStartTimeMs=this.V2c;a.SlideshowStartFlushTimeMs=this.qpe;a.SlideshowFinishFlushTimeMs=this.ppe;a.SlideShowFinishedTimeMs=b;
a.NoBlockingOutBoundSetting=this.la.Qug;a.NoBlockingOutBound=!this.gFg;za.a.J(24252813,830,50,JSON.stringify(a));this.Eca.execute(()=>{this.la.M3b&&this.Ua.getCurrentSlideDimensions()});!this.la.zg||!this.la.M4g&&this.la.M3b||this.YXj.init(this.Cc,this.uo);b=!!this.Nb&&!!this.Nb.instance&&this.Nb.instance.Wq&&this.Nb.instance.hBa;a=!!this.Nb&&!!this.Nb.instance&&(this.Nb.instance.$Oa||this.Nb.instance.Cq);if((this.la.cja||this.la.O4b)&&this.Cc&&this.uo&&this.Ub&&(this.Cc.Ih||this.uo.O2||b||a)&&this.Cc.D0f){const c=
Date.now();let f=2;u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.Ip&&(f=1);const l=this.Cc.Ih;b||a?(this.Cc.Ih||(f=5),this.Nb.instance.lba=!this.Cc.Ih,this.Cc.Ih=!0):this.Nb&&this.Nb.instance&&(this.Nb.instance.lba=!1);this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,f,c,this.uo);this.Cc.Ih=l}b&&(this.Nb.instance.hBa=!1);this.uDe(Object(C.a)(this,this.j7c,"onKeydownHandler"));this.Ua.L4(!1);this.Ua.setOsfLocalStorage()}}j7c(a){27===
a.keyCode&&(za.a.J(23954834,830,50,"SlideshowManager.OnKeydownHandler: Esc"),this.uDe(Object(C.a)(this,this.j7c,"onKeydownHandler")),this.Eca.execute(b=>{b.remove()}),this.Ua.exit())}p7c(a,b){a={};try{const c=va.a.pK(b.Yw);for(const f of c)try{a[f]=b.Yw[f]}catch(l){za.a.J(40388162,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when adding transcription session telemetry value for key: {0}, exception: {1}",f,l)}}catch(c){za.a.J(40388166,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when logging transcription telemetry. Exception: {0}",
c)}za.a.J(40388168,830,50,JSON.stringify(a));try{!(this.uo&&this.uo.O2||!this.la.jwk||this.yFg)&&a.WebSocketConnectionDurationMS&&6E4<parseInt(a.WebSocketConnectionDurationMS.toString())&&(za.a.J(41711008,830,50,"Floodgate survey triggered for transcription."),this.yFg=!0,this.tua.continueWith(()=>{this.tua.result.logActivity("TranscriptionUsed","PPTTranscriptionFloodgateSurveyEnabled")}))}catch(c){za.a.J(41711010,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
c)}}o7c(a,b){this.la.M3b||((a=document.getElementById("slideshow-toolbar"))?b.B4b?"BelowSlide"===b.tv?(a.style.bottom="15%",a.style.left="8%"):"AboveSlide"===b.tv?(a.style.bottom="6px",a.style.left="8%"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):za.a.J(41714783,830,10,"SlideshowManager.OnLiveSubtitlesDockedViewHandler: Can't find pptViewerAnchor-Met or slideshow-toolbar"))}O7c(a,b){za.a.J(39174999,830,50,"SlideshowManager.OnPodSessionExpiredHandler ErrorCode: {0}, Reason: {1}, request PodSessionId: {2}",
b.code,b.reason,b.podSessionId);if(b.podSessionId!==this.Za.podSessionId)za.a.J(39175001,830,15,"SlideshowManager.OnPodSessionExpiredHandler: Failing request PODS ID and m_sessionInfoOwner PODS ID do not match, so will return. m_sessionInfoOwner has a newer PODS ID: {0}, and this failing request is coming from an old PODS ID: {1}.",this.Za.podSessionId,b.podSessionId);else{if((a=this.la.slideShowErrorsThatTriggerRehydration)&&0<a.length&&a[0]){var c=new Date(this.rJg.getTime()+1E3*this.la.slideShowMinimumTimeBetweenRehydrationAttemptsInSec);
const f=new Date,l=f>c;za.a.J(38834827,830,50,"SlideshowManager.OnPodSessionExpiredHandler: currentTime: {0} time after which rehydration is allowed: {1} canTriggerRehydration: {2}",f,c,l);if(l)for(c=0;c<a.length;c++){if(a[c]===b.code.toString()&&(za.a.J(38552588,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Error from Slideshow: {0}",b.code),this.Wd.Mr(Object.assign(new tj.a,{Code:223,Source:4}),b.podSessionId),0<this.Jqe)){za.a.J(38834830,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Triggered rehydration and will wait for {0} ms before calling the timeout handler.",
this.Jqe);this.rJg=new Date;this.eJg=b.podSessionId;this.d4c=window.setTimeout(Object(C.a)(this,this.kKk,"rehydrationTimeout"),this.Jqe);return}}else if(this.eJg===b.podSessionId){za.a.J(39383380,830,50,"SlideshowManager.OnPodSessionExpiredHandler: A request to rehydrate the session based on the pod session id: {0} has already been sent. Wait for rehydration to complete.",b.podSessionId);return}}u.AFrameworkApplication.zo(kf.a.Fh(359));Mf.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],
!1,!1,!0,!1,null);this.la.podExitSlideshowOnError&&(za.a.J(39175006,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.Eca.execute(f=>{f.remove()}),this.Ua.exit())}}P6c(a,b){a=String.format("Category: {0}, Code: {1}, SessionId: {2}, CorrelationId: {3}, Message: {4}, ExtraInfo: {5}, IsApiError: {6}",b.category,b.code,b.sessionId,b.correlationId,b.message,b.iy,b.Wzj.toString());za.a.J(23368026,830,10,"SlideshowManager.OnErrorHandler: Error from Slideshow: {0}",
a);u.AFrameworkApplication.zo(kf.a.Fh(359));Mf.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!0,!0,!0,null);this.la.podExitSlideshowOnError&&(za.a.J(39175009,830,10,"SlideshowManager.OnErrorHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.Eca.execute(c=>{c.remove()}),this.Ua.exit())}sMf(){this.vD&&(za.a.J(39203651,830,50,"SlideshowManager.CleanupFullscreenChangeHandler"),$removeHandler(this.It,this.Or.aZ,this.vD),this.vD=null)}mmk(){za.a.J(24761154,830,
15,"SlideshowManager.OnStartSlideshowTimeoutHandler");u.AFrameworkApplication.zo(kf.a.Fh(360));Mf.Health.instance.recordQosError("SlideShowTimeout",["SlideShowACE"],!1,!0,!0,!0,null);this.Eca.execute(a=>{a.remove()});this.Ua.exit()}kKk(){za.a.J(38834833,830,15,"SlideshowManager.RehydrationTimeout");u.AFrameworkApplication.zo(kf.a.Fh(371));Mf.Health.instance.recordQosError("SlideShowWaitForRehydrationTimedOut",["SlideShowACE"],!1,!0,!0,!0,null);this.Eca.execute(a=>{a.remove()});this.Ua.exit()}chc(a,
b){a=0<b.durationMs?Object.assign(new pk.a,{durationMs:b.durationMs}):null;Mf.Health.instance.recordQosError(b.errorName,[b.vetoName],b.isIntentional,b.isInternal,b.alertOnPillar,b.isSessionEndingError,a)}Cda(a,b){za.a.J(38900815,830,50,"SlideshowManager.OnPodSessionRefreshed: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration);this.x$a=!1;this.aNf();this.y4b()||this.Sia()?(za.a.J(25703582,830,15,"SlideshowManager.OnPodSessionRefreshed: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",
b.QW,this.Za.qk),this.Ua.refreshPodSession(b.QW,this.Za.qk)):za.a.J(25306694,830,50,"SlideshowManager.OnPodSessionRefreshed: Skip updating due to not active.")}P7c(a,b){za.a.J(38900819,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration);this.x$a=!1;this.aNf();this.y4b()||this.Sia()?(za.a.J(38630942,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",
b.QW,this.Za.qk),this.Ua.refreshPodSession(b.QW,this.Za.qk)):za.a.J(38630940,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Skip updating due to not active.")}eo(){this.x$a=!1;za.a.J(38900823,830,50,"SlideshowManager.OnSessionRehydrated: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}ZA(){this.x$a=!0;za.a.J(38900825,830,50,"SlideshowManager.OnSessionEnd: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration)}YBb(){this.x$a=!0;za.a.J(38900827,830,50,"SlideshowManager.OnPodSessionUnavailable: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}WMf(){-1!==this.$2c&&(window.clearTimeout(this.$2c),this.$2c=-1)}aNf(){-1!==this.d4c&&(window.clearTimeout(this.d4c),this.d4c=-1)}}Object(e.a)(FJ,"SlideshowManager",null,[528]);class aD{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){this.yta=
this.a8b=this.ybb=this.dxb=this.h$a=this.eTa=this.Fyb=this.izb=this.uo=this.Cc=this.fe=null;this.c8b=0;this.ZK=!1;this.vD=null;this.Ua=c;this.Qd=f;this.Fqe=l;this.nf=F;this.At=S;this.Za=xa;this.Or=Za;this.ia=a;this.Ha=b;this.Ile=null;this.Q3j=fa;this.Nb=w}init(a,b){this.fe=document.createElement("div");this.fe.id="slideshow-toolbar";this.fe.className="SlideshowToolbar";this.nf.appendChild(this.fe);this.Cc=a;this.uo=b;this.At()?(this.izb=this.$pa("buttonPrevSlide","navigationButton navigationButtonRtl",
"SlideShowNextServer",ResourceStrings.L_Next),this.Fyb=this.$pa("buttonNextSlide","navigationButton navigationButtonRtl","SlideShowPrevServer",ResourceStrings.L_Previous)):(this.izb=this.$pa("buttonPrevSlide","navigationButton navigationButtonLtr","SlideShowPrevServer",ResourceStrings.L_Previous),this.Fyb=this.$pa("buttonNextSlide","navigationButton navigationButtonLtr","SlideShowNextServer",ResourceStrings.L_Next));this.fe.appendChild(this.izb);this.fe.appendChild(this.Fyb);ad.a.addHandler(this.izb,
ra.a.click,Object(C.a)(this,this.ZBb,"onPrevClickHandler"));ad.a.addHandler(this.Fyb,ra.a.click,Object(C.a)(this,this.UBb,"onNextClickHandler"));this.a8b=this.$pa("buttonEnterGridView","navigationButton navigationButtonLtr","GridView",ResourceStrings.L_GridView_SeeAllSlides);this.fe.appendChild(this.a8b);ad.a.addHandler(this.a8b,ra.a.click,Object(C.a)(this,this.RBb,"onGridViewClickHandler"));this.h$a=this.eTa=null;this.Or.uKf&&(this.eTa=this.$pa("buttonEnterFullscreen","navigationButton navigationButtonLtr",
"SlideShowFullscreen",ResourceStrings.L_EnterFullscreen),this.h$a=this.$pa("buttonExitFullscreen","navigationButton navigationButtonLtr","SlideShowBackToWindow",ResourceStrings.L_ExitFullscreen),a=this.Or.B7,this.eTa.style.display=a?Fe.a.og:Fe.a.wl,this.h$a.style.display=a?Fe.a.wl:Fe.a.og,this.fe.appendChild(this.eTa),this.fe.appendChild(this.h$a),ad.a.addHandler(this.eTa,ra.a.click,Object(C.a)(this,this.EGa,"onFullscreenClickHandler")),ad.a.addHandler(this.h$a,ra.a.click,Object(C.a)(this,this.EGa,
"onFullscreenClickHandler")),this.Or.aZ&&!this.vD&&(this.vD=Object(C.a)(this,this.Kcc,"onFullscreenChangeHandler"),$addHandler(this.nf,this.Or.aZ,this.vD)));this.ybb=null;this.Cc.Eqb&&!this.uo.O2&&(this.ybb=this.$pa("buttonSubtitle","navigationButton navigationButtonLtr","SubtitleSlideShowToggleOff",ResourceStrings.L_UseSubtitles),this.fe.appendChild(this.ybb),ad.a.addHandler(this.ybb,ra.a.click,Object(C.a)(this,this.x8c,"onTranscribeHandler")));this.dxb=this.$pa("buttonExitSlideShow","navigationButton navigationButtonLtr",
"ExitSlideShowServer",ResourceStrings.L_EndShow);this.fe.appendChild(this.dxb);ad.a.addHandler(this.dxb,ra.a.click,Object(C.a)(this,this.QBb,"onExitClickHandler"));this.yta=null;this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&!this.uo.O2&&(this.Nb.instance.mCf(Object(C.a)(this,this.Ucc,"onLiveSessionStarted")),this.Nb.instance.kCf(Object(C.a)(this,this.Tcc,"onLiveSessionEnded")),this.Nb.instance.k2h(Object(C.a)(this,this.mYg,"onLiveCalloutDismissed")),this.Nb.instance.iCf(Object(C.a)(this,this.Scc,
"onLiveRelaunchPausedSession")),this.Nb.instance.a5a?this.ARf():this.Nb.instance.a3h(Object(C.a)(this,this.oYg,"onLivePresenterResourcesLoaded")));this.ZK=!1;this.hide();this.Ua.xY(Object(C.a)(this,this.zla,"onExitHandler"));this.Ua.xSb(Object(C.a)(this,this.Ccb,"onBrowserEventHandler"));ad.a.addHandler(this.fe,ra.a.Is,Object(C.a)(this,this.Jcb,"onMouseOverHandler"));ad.a.addHandler(this.fe,ra.a.Wv,Object(C.a)(this,this.Wcc,"onMouseOutHandler"))}show(){this.fe.style.display=Fe.a.wl;window.clearTimeout(this.c8b);
this.c8b=window.setTimeout(Object(C.a)(this,this.hide,"hide"),3E3);this.Ua.L4(!0)}hide(){this.ZK||(window.clearTimeout(this.c8b),this.fe.style.display=Fe.a.og,this.Ua.L4(!1))}remove(){this.fe&&this.nf.contains(this.fe)&&(this.nf.removeChild(this.fe),this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&(this.Nb.instance.Wbh(Object(C.a)(this,this.Ucc,"onLiveSessionStarted")),this.Nb.instance.Vbh(Object(C.a)(this,this.Tcc,"onLiveSessionEnded")),this.Nb.instance.VMk(Object(C.a)(this,this.mYg,"onLiveCalloutDismissed")),
this.Nb.instance.zNk(Object(C.a)(this,this.oYg,"onLivePresenterResourcesLoaded")),this.Nb.instance.Tbh(Object(C.a)(this,this.Scc,"onLiveRelaunchPausedSession"))),this.ZK=!1)}rC(){}setToolbarButtonToggleState(){}zla(){this.Ua.R_(Object(C.a)(this,this.zla,"onExitHandler"));this.Ua.xcd(Object(C.a)(this,this.Ccb,"onBrowserEventHandler"));ad.a.removeHandler(this.fe,ra.a.Is,Object(C.a)(this,this.Jcb,"onMouseOverHandler"));ad.a.removeHandler(this.fe,ra.a.Wv,Object(C.a)(this,this.Wcc,"onMouseOutHandler"));
ad.a.removeHandler(this.izb,ra.a.click,Object(C.a)(this,this.ZBb,"onPrevClickHandler"));ad.a.removeHandler(this.Fyb,ra.a.click,Object(C.a)(this,this.UBb,"onNextClickHandler"));ad.a.removeHandler(this.dxb,ra.a.click,Object(C.a)(this,this.QBb,"onExitClickHandler"));this.yta&&ad.a.removeHandler(this.yta,ra.a.click,Object(C.a)(this,this.lYg,"onLiveBroadcastHandler"));this.ybb&&ad.a.removeHandler(this.ybb,ra.a.click,Object(C.a)(this,this.x8c,"onTranscribeHandler"));this.eTa&&(ad.a.removeHandler(this.eTa,
ra.a.click,Object(C.a)(this,this.EGa,"onFullscreenClickHandler")),ad.a.removeHandler(this.h$a,ra.a.click,Object(C.a)(this,this.EGa,"onFullscreenClickHandler")),$removeHandler(this.nf,this.Or.aZ,this.vD),this.vD=null);this.a8b&&ad.a.removeHandler(this.a8b,ra.a.click,Object(C.a)(this,this.RBb,"onGridViewClickHandler"));this.remove()}Ccb(){this.show()}Kcc(){const a=this.Or.B7;this.eTa.style.display=a?Fe.a.og:Fe.a.wl;this.h$a.style.display=a?Fe.a.wl:Fe.a.og}Jcb(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?
a.className.startsWith("prt2_SubtitleSlideShowToggleOff_40x40x32")&&(a.className=a.className.replace("Off_40x40x32","Hover_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle_40x40x32")&&(a.className=a.className.replace("_40x40x32","Hover_40x40x32")):a.className=a.className.replace("_40x40x32","Hvr_40x40x32"),this.ZK=!0}Wcc(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?!this.Cc.Ih&&a.className.startsWith("prt2_SubtitleSlideShowToggleHover_40x40x32")&&
(a.className=a.className.replace("Hover_40x40x32","Off_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?this.Nb&&!this.Nb.instance.Cq&&a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggleHover_40x40x32")&&(a.className=a.className.replace("Hover_40x40x32","_40x40x32")):a.className=a.className.replace("Hvr_40x40x32","_40x40x32"),this.qIc()||(this.ZK=!1);this.qIc()||this.Ua.restoreFocus()}ZBb(){za.a.J(23954837,830,50,"SlideshowToolbar.OnPrevClickHandler");this.PYa(this.izb.title);
this.Ua.prev();this.Ua.restoreFocus()}UBb(){za.a.J(23954839,830,50,"SlideshowToolbar.OnNextClickHandler");this.PYa(this.Fyb.title);this.Ua.next();this.Ua.restoreFocus()}QBb(){za.a.J(23954841,830,50,"SlideshowToolbar.OnExitClickHandler");this.PYa(this.dxb.title);this.Ua.exit()}EGa(){za.a.J(40449118,830,50,"SlideshowToolbar.OnFullscreenClickHandler");this.Ua.omc()}lYg(){this.Nb&&this.Nb.instance&&(this.PYa(this.yta.title),za.a.J(41231116,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Nb.instance.Cq),
this.Nb.instance.Cq?(this.Ua.pausePresentation(),this.Nb.instance.showCallout(this.yta)):(this.Nb.instance.Skc(3,u.AFrameworkApplication.userSessionId,this.Q3j,this.Za.podSessionId,u.AFrameworkApplication.$g),this.Nb.instance.lba=!this.Cc.Ih,this.Cc.Eqb&&!this.Cc.Ih&&(za.a.J(41682897,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Cc.Ih=!0,this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,5,Date.now(),
this.uo),this.Cc.Ih=!1)),this.sSe())}JPe(a,b){this.PYa(this.ybb.title);const c=!!this.Nb&&!!this.Nb.instance&&this.Nb.instance.Cq,f=this.Cc.B0f&&5!==a&&!c;5!==a&&(this.Cc.Ih=!this.Cc.Ih);za.a.J(39682065,830,50,"SlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",this.Cc.Ih);b&&(this.Cc.Ih?(b.className="prt2_SubtitleSlideShowToggleHover_40x40x32",f&&sz.zyg(this.Ua,this.Qd,this.Za)):b.className="prt2_SubtitleSlideShowToggleOff_40x40x32");f||(b=Date.now(),c?this.Ua.toggleTranscriberUIVisibility(null):
this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,a,b,this.uo))}x8c(a){this.JPe(3,a.target)}RBb(){za.a.J(595204312,830,50,"SlideshowToolbar.OnGridViewClickHandler");this.ia.Ma(aa.a.JGb,2,null)}ARf(){this.yta||(this.yta=this.$pa("buttonLiveBroadcast","navigationButton navigationButtonLtr","PresentLiveSlideshowToolbarToggle",ResourceStrings.L_UseLiveBroadcast),this.fe.insertBefore(this.yta,this.dxb),ad.a.addHandler(this.yta,ra.a.click,
Object(C.a)(this,this.lYg,"onLiveBroadcastHandler")))}$pa(a,b,c,f){const l=document.createElement("div");l.id=a;l.className=b;if("buttonSubtitle"===a)return a=rp.createClusteredImageFromCluster(40,40,"SubtitleSlideShowToggle"+(this.Cc.Ih?"Hover_40x40x32":"Off_40x40x32"),"prt2",this.Qd.rk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,l;if("buttonLiveBroadcast"===a)return a=rp.createClusteredImageFromCluster(40,40,"PresentLiveSlideshowToolbarToggle"+(this.Nb&&this.Nb.instance&&this.Nb.instance.Cq?
"Hover_40x40x32":"_40x40x32"),"prt2",this.Qd.rk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,1===a.children.length&&(this.Ile=a.children[0]),l;a=rp.createClusteredImageFromCluster(40,40,c+"_40x40x32","prt2",this.Qd.rk("prt2.png"),null,null,!0,null);l.appendChild(a);l.title=f;return l}PYa(a){Ja.a.Xa(a)?za.a.J(23396621,830,15,"SlideshowToolbar::RaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.Fqe.j9g(new sx(a))}qIc(){return!!this.Nb&&!!this.Nb.instance&&this.Nb.instance.E0f}sSe(){this.Nb&&
this.Nb.instance&&this.Ile&&(this.Ile.className="prt2_PresentLiveSlideshowToolbarToggle"+(this.Nb.instance.Cq?"Hover_40x40x32":"_40x40x32"))}oYg(){this.ARf()}Ucc(){this.sSe()}Tcc(){this.Nb&&this.Nb.instance&&this.Nb.instance.lba&&!this.Cc.Ih&&(za.a.J(41682899,830,50,"Stopping subtitle for stopping live session."),this.Ua.transcribe(u.AFrameworkApplication.userSessionId,this.Za.podSessionId,this.Za.qk,u.AFrameworkApplication.$g,5,Date.now(),this.uo));this.Nb.instance.lba=!1;this.sSe()}Scc(){this.Nb&&
this.Nb.instance&&(this.ZK=!0,this.show(),this.Ua.pausePresentation(),this.Nb.instance.showCallout(this.yta))}mYg(){this.ZK=this.qIc();this.ZK||(window.clearTimeout(this.c8b),this.c8b=window.setTimeout(Object(C.a)(this,this.hide,"hide"),3E3))}}Object(e.a)(aD,"SlideshowToolbar",null,[839,840]);class $t{constructor(a){this.vxb=this.a9=this.vAb=null;this.Hpe="BelowSlide";this.j$a=this.GEg=!1;this.J7b=!0;this.uYc=-1;this.eFg=this.v7b=this.The=!1;this.Ine=this.Ipe=this.Kpe=this.Jpe=null;this.la=a;u.AFrameworkApplication.fa.gf(Object(C.a)(this,
this.Fl,"onFullAppSettingsReady"));a=md.b(u.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());this.VBg=a.Ring||"Unknown";this.p6b=u.AFrameworkApplication.buildVersion||"Unknown";this.EJg=this.la.XGa||"Unknown";this.eQg=a.Host||"Unknown";this.dQg=a.WACDatacenter||"Unknown";this.sOg=this.q_i();this.Pac=this.t_i();this.APg=this.GNc();this.kxb=$t.fTe;switch(this.la.fll){case "ByUIHostName":a=u.AFrameworkApplication.fa.Ia(u.AFrameworkApplication.lJ);this.j$a=!(!a||"teams"!==a.toLowerCase());
break;case "ByAppIsEmmbeded":this.j$a=u.AFrameworkApplication.isEmbedded;break;default:this.j$a=u.AFrameworkApplication.fa.ka("IsUIEmbedMode")}za.a.J(40977669,822,50,"Initialized SubtitleContext with cookie: {0}, default position:{1}",this.kxb,this.Hpe)}Fl(){this.vAb=this.getUserId();this.a9=u.AFrameworkApplication.fa.Ia("TenantId");this.vxb=this.la.hostAuthType||u.AFrameworkApplication.fa.Ia("HostAuthType")||"Unknown"}getUserId(){let a=u.AFrameworkApplication.fa.Ia("PptEditingUserId");Ja.a.Xa(a)&&
(a=u.AFrameworkApplication.fa.Ia("LoggableUserId"),za.a.J(593793674,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",Ja.a.Xa(a)));return a}get AYb(){return this.GEg}set AYb(a){za.a.J(40407360,830,50,"SubtitleContext: Update FEnabledInBaseDoc to {0}",a);this.GEg=a}get Ih(){return this.la.cja&&this.AYb&&this.kxb&&!this.j$a}set Ih(a){this.kxb!==a&&(this.kxb=a,$t.fTe=this.kxb)}get zYb(){return this.la.cja&&this.v7b}set zYb(a){this.v7b!==a&&(this.v7b=a)}get Y0f(){return this.eFg}get D0f(){return!this.j$a}get Kqb(){return this.The}set Kqb(a){this.The!==
a&&(this.The=a)}get Eqb(){return this.la.cja&&this.AYb&&this.la.RMj&&!this.j$a}get B0f(){const a=Di.a.get("PPTLiveSubtitleEnabled");return this.la.cja&&this.la.WMj&&Ja.a.Xa(a)&&!this.j$a}get ANe(){if(!this.Ipe){const b=new Ua.a;var a=this.la.B4g;if(!Ja.a.Xa(a)){a=a.split(",");for(const c of a)c.endsWith("*")||b.add(c)}this.Ipe=$t.yDf(b)}return this.Ipe}get zNe(){if(!this.Ine){const b=new Ua.a;var a=this.la.B4g;if(!Ja.a.Xa(a)){a=a.split(",");for(const c of a)c.endsWith("*")&&b.add(c.replace("*"," ").trim())}this.Ine=
$t.yDf(b)}return this.Ine}get wHb(){this.Jpe||(this.Jpe=Ja.a.Xa(this.la.C4g)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(this.la.C4g,!0));return this.Jpe}get qMe(){this.Kpe||(this.Kpe=$t.A6h(this.wHb));return this.Kpe}fVk(){this.uYc=this.kxb?1:0}qSk(){-1!==this.uYc&&(this.Ih=1===this.uYc?!0:!1,this.uYc=-1)}q_i(){try{const a=qa.a.re(u.AFrameworkApplication.lcid);if(!a)return za.a.J(41158484,822,15,"SubtitleContext::GetDefaultSpeechLanguage Getting the culture info returned null. Language lcid: {0}: ",
u.AFrameworkApplication.lcid),"en-us";const b=a.name.toLowerCase();for(let c of this.ANe)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;for(let c of this.zNe)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;this.v7b=!0;return"en-us"}catch(a){za.a.J(41158486,822,10,"SubtitleContext::GetDefaultSpeechLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",u.AFrameworkApplication.lcid,a)}this.v7b=!0;return"en-us"}t_i(){try{const a=qa.a.re(u.AFrameworkApplication.lcid);
if(!a||Ja.a.Xa(a.name))return za.a.J(41158488,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the culture info or culture info name returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),"en";const b=a.name.toLowerCase();if(!Ja.a.Xa(b)&&this.wHb[b])return b;const c=qa.a.re(a.languageId);if(!c||Ja.a.Xa(c.name))return za.a.J(41158490,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the two-letter culture info returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),
"en";let f=c.name.toLowerCase();this.wHb[f]||(za.a.J(41972259,822,15,"SubtitleContext::GetDefaultTranslationLanguage No matching default language was found for the user's locale. Will default to English. User's culture info name: {0} User's culture info two letter name: {1} Language lcid: {2}: ",b,f,u.AFrameworkApplication.lcid),f="en");return f}catch(a){za.a.J(41158492,822,10,"SubtitleContext::GetDefaultTranslationLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",
u.AFrameworkApplication.lcid,a)}return"en"}GNc(){try{if(Ja.a.Xa(this.Pac))return za.a.J(41972290,822,10,"SubtitleContext::GetValueForTranslationLanguage m_translationLanguages is null. Language lcid: {0}",u.AFrameworkApplication.lcid),"en-us";const a=this.wHb[this.Pac.toLowerCase()];if(!Ja.a.Xa(a))return a}catch(a){za.a.J(41972292,822,10,"SubtitleContext::GetValueForTranslationLanguage Exception thrown when trying to get the value for key: {0} language lcid: {1}, exception: {2}.",this.Pac,u.AFrameworkApplication.lcid,
a)}return"en-us"}UXi(a){if(Ja.a.Xa(a))return za.a.J(595140824,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var b=a.split("-");if(!b.length)return za.a.J(595140822,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",a),null;b=b[0];const c=this.wHb;var f=this.qMe;for(let l of f)if(f=c[l.toLowerCase()],f.startsWith(b))return f;za.a.J(595140820,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",
a);return null}get Uma(){return this.sOg}set Uma(a){this.sOg=a;this.eFg=!0}get userId(){return this.vAb}set userId(a){this.vAb=a}get locale(){return this.EJg}set locale(a){this.EJg=a}get audienceGroup(){return this.VBg}set audienceGroup(a){this.VBg=a}get buildVersion(){return this.p6b}set buildVersion(a){this.p6b=a}get identityProvider(){return this.vxb}set identityProvider(a){this.vxb=a}get wacHost(){return this.eQg}set wacHost(a){this.eQg=a}get wacDatacenter(){return this.dQg}set wacDatacenter(a){this.dQg=
a}get tenantId(){return this.a9}set tenantId(a){this.a9=a}get kxa(){return this.Pac}set kxa(a){this.Pac=a}get ehb(){return this.APg}set ehb(a){this.APg=a}get tv(){return this.Hpe}set tv(a){this.Hpe=a}get Dfl(){const a={};a.UserId=this.userId;a.TenantId=this.tenantId;a.AudienceGroup=this.audienceGroup;a.BuildVersion=this.buildVersion;a.IdentityProvider=this.identityProvider;a.Locale=this.locale;a.WacHost=this.wacHost;a.WacDatacenter=this.wacDatacenter;a.SubtitlesPosition=this.tv;a.SpeechLanguage=this.Uma;
a.TranslationLanguages=this.ehb;a.FUseSubtitles=this.Ih;return JSON.stringify(a)}get iBa(){return this.J7b}set iBa(a){this.J7b=a}get $Mi(){return 0<=this.la.pptEditorTranscribeRTLTranslationLanguages.indexOf(this.kxa)}static get fTe(){const a=Di.a.get("PPTLiveSubtitleEnabled");return a?"true"===a.toLowerCase():!1}static set fTe(a){Di.a.LL("PPTLiveSubtitleEnabled",a.toString(),Di.a.qL)||za.a.J(40977672,822,10,"Failed to set cookie for use live subtitle to {0}",a.toString())}static yDf(a){const b={},
c=new Ua.a;for(let f of a)try{const l=qa.a.re(f).displayName;c.add(l);b[l]=f}catch(l){za.a.J(40423770,822,10,"SubtitleContext::AlphabetizeSpokenLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",f,l)}c.Sc((f,l)=>f.localeCompare(l));a=new Ua.a;for(let f of c)f&&0<f.length&&a.add(b[f]);return a}static A6h(a){const b=va.a.pK(a);a={};const c=new Ua.a;for(var f of b)try{const l=qa.a.re(f).displayName;Ja.a.Xa(l)?za.a.J(41972252,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Couldn't get display name for language code: {0}, language lcid: {1}.",
f,u.AFrameworkApplication.lcid):(c.add(l),a[l]=f)}catch(l){za.a.J(40423772,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",f,l)}c.Sc((l,w)=>l.localeCompare(w));f=new Ua.a;for(let l of c)l&&0<l.length&&f.add(a[l]);return f}}Object(e.a)($t,"SubtitleContext",null,[523]);const HJ=()=>{var a=window.navigator.userAgent.toLowerCase();(a=-1!==a.indexOf("windows nt 6.3")&&-1!==a.indexOf("rv:11.0"))||(a=window.navigator.userAgent.toLowerCase(),
-1!==a.indexOf("windows")?(a=GJ(a,"msie (\\d+)"),a=!isNaN(a)&&10>=a):a=!1);a||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("iphone")||-1!==a.indexOf("ipad")||-1!==a.indexOf("ipod")?(a=GJ(a,"os (\\d+)_"),a=!isNaN(a)&&9>=a):a=!1);if(a||-1!==window.navigator.userAgent.indexOf("Windows NT 6.3; ARM"))return!1;try{const b=document.createElement("canvas");if(window.self.WebGLRenderingContext&&(b.getContext("webgl")||b.getContext("experimental-webgl")))return!0}catch(b){}return!1},GJ=(a,b)=>
(a=(new RegExp(b)).exec(a))&&2<=a.length?parseInt(a[1]):Number.NaN;class IJ{constructor(a){this.oo=a}PHf(){return HJ()}Mbi(){let a=!1;const b=this.PHf();if(b&&!this.oo.lN(1))try{const c=document.createElement("canvas"),f=c.getContext("2d");if(f){const l=new Image;l.src="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";f.drawImage(l,0,0,10,10);c.toDataURL("image/png");a=!0}}catch(c){}za.a.J(33595541,830,50,"IsRenderingSVGInWebGLSupported - {0}",{["Browser"]:this.oo.ey,
["SupportWebGL"]:b,["SupportSVGInWebGL"]:a});return a}}Object(e.a)(IJ,"WebGLHelperProxy",null,[522]);class bD{constructor(){this.la=this.xb=this.K=null}get name(){return"PowerPointWebEditor.SlideShow"}Yb(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.xb=b.iG();this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.register(521,"PowerPointWebEditor.IFullscreenHelper").ma().na(()=>new vJ);this.K.register(522,"PowerPointWebEditor.IWebGLHelper").ma().na(()=>
new IJ(this.K.resolve("Common.IBrowserUtils")));this.K.register(523,"PowerPointWebEditor.ISubtitleContext").ma().na(()=>new $t(this.la));this.K.register(524,"PowerPointWebEditor.IRehearsalContext").ma().na(()=>new rz);u.AFrameworkApplication.fa.ka("PptModernSlideShowUseSlideShowSwitcher")?this.K.register(525,"PowerPointWebEditor.ISlideshowFrame").ma().na(()=>new mv(this.xb,this.la,this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.resolve("PowerPointWebEditor.IWebGLHelper"),this.K.Oa("Common.App.HostNotification.EditNotificationEventSource"),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("Common.IDynamicScriptLoaderProvider").gx,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.Oa("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.Oa("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.resolve("PowerPoint.IPathManager"))):this.K.register(525,"PowerPointWebEditor.ISlideshowFrame").ma().na(()=>
new CJ.SlideshowFrame(this.K.resolve("PowerPointWebEditor.IWebGLHelper"),this.xb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.Oa("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.Oa("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("Common.IDynamicScriptLoaderProvider").gx));this.K.register(XC,"PowerPointWebEditor.SlideShowFooterContainer").na(()=>new XC(this.xb,
u.AFrameworkApplication.Va));this.K.resolve("PowerPointWebEditor.SlideShowFooterContainer").wb();let c;if(!this.la.M3b||this.la.M4g)this.K.register(aD,"PowerPointWebEditor.SlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().na(()=>new aD(u.AFrameworkApplication.Va,this.la,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Oa("PowerPointLive.ILivePresenter"),this.xb,()=>
u.AFrameworkApplication.isRtl,this.la.podsWebServiceBase,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"))),this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");else{a=Qy.a(this.K);const w=new Ua.a;w.add(a("slideshowToolbar"));this.la.Svk&&w.add(a("uiFabricLazy"));Promise.all(w.toArray()).catch(S=>za.a.J(50907106,830,10,"Failed to load the resources for the slideshowToolbar feature: {0}",S)).then(()=>this.fmk()).catch(S=>za.a.J(50907136,
830,10,"Failed to load the React slideshowToolbar: {0}",S));this.la.isInkUIInSlideShowEnabled&&(a("inkButton").catch(S=>za.a.J(51218050,830,10,"Failed to load the resources for the ink button feature: {0}",S)).then(()=>this.qik()).catch(S=>za.a.J(51218052,830,10,"Failed to load the React ink button: {0}",S)),this.K.register(526,"PowerPointWebEditor.IInkButtonHelper").ma().na(()=>new wJ));if(this.la.pptEditorVoiceUXEnabled){let S=this;a("voiceUI").catch(fa=>za.a.J(595198419,830,10,"Failed to load the resources for the voice UI feature: {0}",
fa)).then(()=>S.gmk()).catch(fa=>za.a.J(595198417,830,10,"Failed to load the voice UI script: {0}",fa));this.K.register(527,"PowerPointWebEditor.ISlideShowVoiceNotification").ma().na(()=>new EJ)}const F=this;this.K.register(WC,"PowerPointWebEditor.ReactSlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().na(()=>new WC(u.AFrameworkApplication.Va,F.la,F.K.resolve("PowerPointWebEditor.ISlideshowFrame"),F.K.resolve("PowerPoint.IPathManager"),F.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
F.K.Oa("PowerPointLive.ILivePresenter"),F.xb,()=>u.AFrameworkApplication.isRtl,F.la.podsWebServiceBase,F.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),F.K.resolve("PowerPointWebEditor.IFullscreenHelper")))}c=this.K.Oa("PowerPointWebEditor.ISlideshowToolbar");const f=this;this.K.register($C,"PowerPointWebEditor.SlideshowContextMenu").na(()=>new $C(f.K.resolve("PowerPointWebEditor.ISlideshowFrame"),f.K.resolve("PowerPointWebEditor.IPresentationReader"),f.K.resolve("PowerPointWebEditor.IInputHandlerManager"),
u.AFrameworkApplication.Va,f.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),f.xb,()=>u.AFrameworkApplication.isRtl,f.K.resolve("PowerPointWebEditor.IFullscreenHelper"),f.K.Oa("PowerPointLive.ILivePresenter")));const l=this;this.K.register(528,"PowerPointWebEditor.ISlideshowManager").ma().na(()=>new FJ(l.K.resolve("PowerPointWebEditor.IFullscreenHelper"),l.K.resolve("PowerPointWebEditor.ISlideshowFrame"),c,l.K.resolve("PowerPointWebEditor.SlideshowContextMenu"),l.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
u.AFrameworkApplication.Be,l.la,b,l.K.resolve("PowerPointWebEditor.IPresentationReader"),l.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),l.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),l.K.resolve("PowerPointWebEditor.IErrorHandler"),lb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),l.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),l.K.resolve("PowerPointWebEditor.IZoomContentFetcher"),or.a.su(lb.a.instance.Oa("Common.ISystemInitiatedFeedback")),u.AFrameworkApplication.Va,
lb.a.instance.Oa("PowerPointLive.ILivePresenter"),l.K.resolve("PowerPointWebEditor.SlideShowFooterContainer"),l.K.Oa("PowerPointWebEditor.ISlideShowVoiceNotification")))}init(){this.K.resolve("Common.IAppSettingsManager").gf(Object(C.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){Oc.a.get_instance().Ak(10,null).continueWith(()=>{if(!this.la.rS&&this.la.I4g&&this.la.kxk)try{or.a.su(lb.a.instance.Oa("Common.ISystemInitiatedFeedback")).continueWith(a=>{a.result.logActivity("HasPresentButtonSeen","PresentTeachingUIEnabled")}),
za.a.J(576583516,830,50,"Present Teaching UI triggered")}catch(a){za.a.J(576583517,830,10,"Exception thrown when trying to trigger Present teaching UI. Exception: {0}",a)}})}fmk(){this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");return null}qik(){this.K.resolve("PowerPointWebEditor.IInkButtonHelper");return null}gmk(){this.K.resolve("PowerPointWebEditor.ISlideShowVoiceNotification");return null}dispose(){}static main(){m.a.instance.Ec(new bD)}}Object(e.a)(bD,"PPTWebEditorSlideShowPackage",
null,[2,3]);var bQ=d(755);class JJ{constructor(){this.h7b=null}B9k(a,b){lj.UISurfaces.pV().then(c=>{this.h7b=a.qFi(c,a.Gxi(b),b,this.h7b)});za.a.J(527303443,843,50,"{0} Toast is displayed",Object.getType(a).toString())}XKk(a){lj.UISurfaces.pV().then(b=>{this.h7b=a.MKk(b,this.h7b)});za.a.J(523871965,843,50,"{0} Toast is removed",this.h7b)}}Object(e.a)(JJ,"DeferredNotificationCalloutVisibilityManager",null,[]);var KJ=d(986);const cQ=a=>{const b={featureArea:"Partial Presentation"};b.sourceContext=a;
a={};a.telemetryGroup=b;return a},dQ=(a,b,c,f)=>{const l=new hf.StandardDialog;l.vd=0;if(u.AFrameworkApplication.WD){const w=cQ(b);l.AFd(ResourceStrings.L_GiveFeedback,void 0,void 0,w)}l.Tw(c,f,0,a?w=>{1===w?(za.a.J(526989467,830,50,"User selected Present Anyway in {0}",b),a()):za.a.J(526989468,830,50,"User selected Cancel in {0}",b)}:null)};class cD{constructor(a,b,c,f,l,w,F){this.c8={};this.jua=new Ie.a;this.q1c=this.Jne=null;this.g0c=this.Tle=0;this.IEg=!1;this.lZj=qd.a("PartialDoc.SkipCheckGraphForPresentationDeferred");
this.z2c={};if(!F)throw Error.argumentNull("coreEventSource");this.kL=a;this.jq=c;this.kL.yk(Object(C.a)(this,this.UZg,"onShapeNodePropertyChanged"));this.kL.zga(Object(C.a)(this,this.jdc,"onShapeNodeLoaded"));this.kL.yga(Object(C.a)(this,this.TZg,"onShapeNodeConnected"));this.CDg=new JJ;this.ph=l;b.eGd(Object(C.a)(this,this.kue,"onClientError"));b.xGd(Object(C.a)(this,this.Nve,"onServerError"));u.AFrameworkApplication.uzc(Object(C.a)(this,this.Gue,"onErrorDialogDisplayed"));this.rfe=f;this.Sja=w;
this.Vh=F;this.Vh.xB(Object(C.a)(this,this.JZg,"onSessionRehydratedHandler"))}ABf(a,b){this.jua.Kb(a)||this.jua.$(a,new pa.a);const c=this.jua.ga(a);c.add(b);this.jua.$(a,c)}Pah(a,b){if(this.jua.Kb(a)){var c=this.jua.ga(a);c.remove(b);this.jua.$(a,c);this.k3d(a)||this.jua.remove(a);rq.a(this.c8).length||za.a.J(520927263,843,50,"DeferredContentManager::RemoveFromSlideDeferredInfo - no more deferred content in document")}else za.a.J(524321747,843,15,"DeferredContentManager::RemoveFromSlideDeferredInfo - no deferred content on slideId:{0} shapeNodeId:{1}",
a,b)}k3d(a){return this.jua.Kb(a)&&0<this.jua.ga(a).count}FLf(a){if(a.slideId&&a.slideId.sid&&a.vVc){var b=a.vVc;a.F2?(this.IEg||(this.IEg=!0,za.a.J(555836314,843,50,"DeferredContentManager - deferred content detected: FForceShowDeferralUI: {0}",this.Sja)),b in this.c8||(this.c8[b]=new Date),this.ABf(a.slideId.sid.toString(),b)):b in this.c8&&(delete this.c8[b],this.Pah(a.slideId.sid.toString(),b),za.a.J(520927262,843,15,"DeferredContentManager - Rehydration scenario, Node already in deferred list on load/connect."))}}jdc(a,
b){(a=Object(ua.a)(4,b.node))?this.FLf(a):za.a.J(557126034,843,10,"IDeferrable object is null")}TZg(a,b){(a=Object(ua.a)(4,b.node))?this.FLf(a):za.a.J(557126035,843,10,"IDeferrable object is null")}UZg(a,b){var c=Object(ua.a)(4,b.node);if(!c)za.a.J(557126873,843,10,"IDeferrable object is null");else if((b.property===zb.a.F2||this.Sja&&c.vVc in this.c8&&!c.F2)&&c.slideId)if(b=c.vVc,a=c.slideId.sid.toString(),c.F2)b in this.c8?za.a.J(557164308,843,15,"ShapeNode is already deferred:{0}, FForceShowDeferralUI: {1}",
b,this.Sja):(za.a.J(527720478,843,50,"ShapeNode is deferred:{0}, FForceShowDeferralUI: {1}",b,this.Sja),this.c8[b]=new Date,this.ABf(a,b));else{if(c=this.c8[b])c=(new Date).getTime()-c.getTime(),za.a.J(557164309,843,50,"ShapeNode:{0}, DeferredDurationMS:{1}, FForceShowDeferralUI:{2}",b,c,this.Sja),delete this.c8[b],this.Pah(a,b),this.g0c=c>this.g0c?c:this.g0c;this.rfe&&!this.hasDeferredContent()&&(za.a.J(520471008,843,50,"All deferred blobs loaded"),this.opa("AllDeferredBlobsLoaded","true"),this.q1c&&
(za.a.J(520471007,843,50,"Previously called user requested actions triggered"),this.opa("PreviouslyDeferredActionsTriggeredOnBlobsLoad","true"),this.q1c(),this.CDg.XKk(this.Jne),this.Jne=this.q1c=null))}}JZg(){za.a.J(520722338,843,50,"Session rehydrated with {0} currently deferred blobs",rq.a(this.c8).length)}KKe(a,b,c){this.rfe?(this.Jne=b,this.q1c=c,this.CDg.B9k(b,this.ph)):(c=Object(Ca.a)(KJ.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle:ResourceStrings.l_DeferredContentWaitDialogTitle,
b=Object(Ca.a)(KJ.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogMessage:ResourceStrings.l_DeferredContentWaitDialogMessage,dQ(null,a.toString(),c,b));za.a.J(526989469,801,100,"ShowDeferredContentWaitUI shown for :{0}",a)}opa(a,b){this.z2c[a]&&za.a.J(522269249,843,15,"DeferredContentManager - This action has been requested before. Key: {0}, Value: {1}",a,this.z2c[a]);this.z2c[a]=b}kue(a,b){this.recordError("ClientError",b)}Nve(a,b){this.recordError("ServerError",b)}Gue(a,b){(a=Object(ua.a)(bQ.a,
b))&&this.recordError("Crash",a.errorCode)}recordError(a,b){this.hasDeferredContent()&&za.a.J(556364418,843,15,"DeferredContentManager - Error while there is deferred content: ErrorType:{0}, ErrorInfo:{1}, FForceShowDeferralUI:{2}",a,b,this.Sja)}dispose(){this.kL.Pm(Object(C.a)(this,this.UZg,"onShapeNodePropertyChanged"));this.kL.HWa(Object(C.a)(this,this.jdc,"onShapeNodeLoaded"));this.kL.mma(Object(C.a)(this,this.TZg,"onShapeNodeConnected"));this.Vh.cea(Object(C.a)(this,this.JZg,"onSessionRehydratedHandler"));
this.log()}hasDeferredContent(){const a=rq.a(this.c8),b=(!this.lZj||this.Sja)&&0<a.length||0<this.jq.m4a;if(b){const c={};c.DeferredNodeCount=a.length.toString();c.DeferredBlobCount=this.jq.m4a.toString();c.FForceShowDeferralUI=this.Sja.toString();za.a.J(521175389,843,50,JSON.stringify(c));this.Tle=Math.max(this.jq.m4a,this.Tle)}return b}roj(a){return Ma.a.any(a,b=>b.hasDeferredContent)?(za.a.J(556312344,843,50,"{0} DeferredSlideCount: {1}, FForceShowDeferralUI: {2}","CutCopySlides",a.length,this.Sja),
!0):!1}j3d(a,b){return Ma.a.any(a,c=>c.F2)?(za.a.J(556312348,843,50,"{0} DeferredShapeCount: {1}, FForceShowDeferralUI: {2}",b,a.length,this.Sja),!0):!1}log(){const a=rq.a(this.c8),b={};b.MaxDeferredTime=this.g0c.toString();b.DeferredCountOnClose=a.length.toString();b.MaxNumberOfDeferredBlobs=this.Tle.toString();b.FForceShowDeferralUI=this.Sja.toString();za.a.J(556364419,843,15,"SessionLogs: {0}, PersistedLogs: {1}",JSON.stringify(b),JSON.stringify(this.z2c))}}Object(e.a)(cD,"DeferredContentManager",
null,[570]);class dD{constructor(){this.Sv=this.K=null}get name(){return"PowerPointWebEditor.PartialDoc"}Yb(a){this.K=a;this.K.register(cD,"PowerPointWebEditor.DeferredContentManager").as("PowerPointWebEditor.IDeferredContentManager").ma().na(()=>new cD(this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),this.K.resolve("Common.IF6Manager"),
0<this.K.resolve("Common.IAppSettingsManager").Gc("ForceShowDeferralUIMS",0),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource")))}init(){this.Sv=this.K.resolve("PowerPointWebEditor.IDeferredContentManager")}dispose(){this.Sv&&this.Sv.dispose()}static main(){m.a.instance.Ec(new dD)}}Object(e.a)(dD,"PPTWebEditorPartialDocPackage",null,[2,3]);class nv{constructor(a,b){this.shapeNode=a;this.position=b}}Object(e.a)(nv,"MoveShapeData",null,[]);class LJ{constructor(a,b){this.IN=null;this.Ro=a;this.ia=
b}start(){this.IN=[];for(let a=0;a<this.Ro.length;++a)Array.add(this.IN,new ic.a(this.Ro[a].x,this.Ro[a].y)),this.Ro[a].cD(!1)}LKd(a,b){if(1!==a||this.Ro.length!==b.length)return!1;for(a=0;a<b.length;a++)if(!this.gDj(b[a]))return!1;return!0}gDj(a){for(let b=0;b<this.Ro.length;b++)if(a.gb.equals(this.Ro[b].gb))return!0;return!1}perform(a){for(let c=0;c<this.Ro.length;c++){var b=new ic.a(this.Ro[c].x,this.Ro[c].y);b=ic.a.add(b,a);this.Ro[c].setPosition(b.x,b.y,!0)}}end(){this.IN&&za.a.J(17597603,815,
50,"ShapeKeyboardDragManager::ShapeMoveAction - moving {0} shapes by ( {1}, {2} )",this.Ro.length,this.Ro[0].x-this.IN[0].x,this.Ro[0].y-this.IN[0].y);const a=[];for(let b=0;b<this.Ro.length;++b){const c=this.Ro[b].GKc();Array.add(a,new nv(this.Ro[b].shapeNode,c));this.Ro[b].qz(!1)}this.ia.Ma(aa.a.lGa,2,a)}}Object(e.a)(LJ,"ShapeMoveAction",null,[916]);class tz{constructor(a,b,c=null,f=null){this.g0=a;this.U_=b;this.BXb=c;this.xSg=f}}Object(e.a)(tz,"ResizeShapeData",null,[]);class MJ{constructor(a,
b){this.RDa=this.wwb=this.Ape=null;this.kF=a;this.ia=b}start(){this.Ape=[];this.wwb=[];this.RDa=[];for(const c of this.kF){c.CK=!0;c.cD(!1);Array.add(this.Ape,c.BVa);Array.add(this.wwb,new ri.a);var a=c.trb(),b=ic.a.Nl(a.Yj(ge.a.nu),a.Yj(ge.a.JD));a=ic.a.Nl(a.Yj(ge.a.nu),a.Yj(ge.a.bH));Array.add(this.RDa,a?b/a:1);c.shapeNode.Xf&&c.shapeNode.isEditable&&(b=c,b.Kk&&(b.Kk.visible=!0))}}LKd(a,b){if(2!==a)return!1;for(a=0;a<b.length;a++)if(b[a].kl||!b[a].gb.equals(this.kF[a].gb))return!1;return!0}perform(a,
b){for(let f=0;f<this.kF.length;f++){var c=a;let l=b;({deltaX:c,deltaY:l}=this.hrl(c,l,f));let w;(w=this.wwb[f]).right=w.right+c;let F;(F=this.wwb[f]).bottom=F.bottom+l;this.kF[f].setOffsets(ri.a.add(this.Ape[f],this.wwb[f]),!0);this.kF[f].shapeNode.Xf&&this.kF[f].shapeNode.isEditable&&(c=this.kF[f],c.M3d(),c.hPc())}}hrl(a,b,c){if(!this.kF[c].shapeNode.isAspectRatioLocked)return{deltaX:a,deltaY:b};b?a=b*this.RDa[c]:b=a/this.RDa[c];return{deltaX:a,deltaY:b}}end(){const a=[];for(let b=0;b<this.kF.length;b++)this.kF[b].kl||
(this.kF[b].shapeNode.Xf&&this.kF[b].shapeNode.isEditable||(this.kF[b].CK=!1),this.kF[b].qz(!1),Array.add(a,new tz(this.kF[b].shapeNode,this.wwb[b])));this.ia.Ma(aa.a.reb,2,a);this.kF=null}}Object(e.a)(MJ,"ShapeResizeAction",null,[916]);class vp{constructor(a,b){this.shapeNode=a;this.jUf=b%vp.Adc}}vp.Adc=360;Object(e.a)(vp,"ShapeRotateData",null,[]);class NJ{constructor(a,b){this.OCg=null;this.Nce=0;this.Rd=a;this.ia=b}start(){this.Rd.cD(!1);this.OCg=this.Rd.trb().$f()}LKd(a,b){return 3===a&&!this.Rd.kl&&
this.Rd.gb.equals(b[0].gb)}perform(a){this.Nce=(this.Rd.rotation+a)%vp.Adc;this.Rd.setRotation(this.Nce,this.OCg)}end(){if(!this.Rd.kl){this.Rd.qz(!1);var a=new vp(this.Rd.shapeNode,this.Nce);this.ia.Ma(aa.a.sic,2,a)}}}Object(e.a)(NJ,"ShapeRotateAction",null,[916]);class wp{constructor(a){this.aGa=this.$P=null;this.ia=a}inc(){this.aGa&&Kc.a.Hob(this.aGa);this.aGa=Kc.a.W9(Object(C.a)(this,this.LYf,"endAction"),wp.Ffi)}VSd(a,b){this.$P&&!this.$P.LKd(a,b)&&(this.$P.end(),this.$P=null);if(!this.$P){this.$P=
this.iVi(a,b);if(!this.$P)throw Error.invalidOperation("Could not create keyboard action");this.$P.start()}this.inc();return this.$P}LYf(){this.$P&&(this.$P.end(),this.$P=null);this.aGa=null}move(a,b){a=this.VSd(1,a);b=this.QVf(b);a.perform(b)}resize(a,b){a=this.VSd(2,a);b=this.QVf(b);a.perform(b.x,b.y)}rotate(a,b,c){a=this.VSd(3,a);c=c?wp.wfi:wp.vfi;a.perform(b?c:-1*c)}QVf(a){let b=0,c=0;a.equals(ge.a.north)?c=-1*wp.HBc:a.equals(ge.a.east)?b=wp.HBc:a.equals(ge.a.south)?c=wp.HBc:a.equals(ge.a.west)&&
(b=-1*wp.HBc);return new ic.a(b,c)}iVi(a,b){return b?1===a?new LJ(b,this.ia):2===a?new MJ(b,this.ia):3===a&&(1<b.length&&za.a.J(17651872,815,15,"ShapeKeyboardDragManager::GetActionForType - Currently we don't support multi-shapes rotation, will only rotate the first shape by keyboard."),3===a)?new NJ(b[0],this.ia):null:null}}wp.Ffi=1E3;wp.HBc=1;wp.vfi=15;wp.wfi=1;Object(e.a)(wp,"ShapeKeyboardDragManager",null,[885]);var ug=d(157),Ls=d(534);const On=a=>{a&&Kc.a.Db&&(Kc.a.Db.Rfg=a.Xf,Kc.a.Db.ush=a.xh)};
var wq=d(241),OJ=d(492),ux=d(296);class eD{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we){if(!Ec)throw Error.argumentNull("ISessionInfoOwner is null");if(!Hc)throw Error.argumentNull("IPPTUnitConversion is null");if(!Dc)throw Error.argumentNull("IZoomContext is null");kc||za.a.J(560321568,815,10,"ShapeManipulationActor constructor null WebSocketFrontDoor");this.ia=a;this.Df=b;this.Rp=c;this.Ga=f;this.ob=l;this.E2c=w;this.Jb=F;this.Pb=S;this.Fa=fa;this.Ue=xa;this.Pr=Mb;this.Iz=Za;
this.j5j=pb;this.Ha=hc;this.c9b=new wa.ScriptSharpLegacyMap;this.dVa=kc;this.Za=Ec;this.Qj=Hc;this.Xi=Dc;this.vi=Td;this.ita=we}wb(){this.ia.ra(aa.a.B3a,$b.a.application,Object(C.a)(this,this.Eij,"handleDeleteSelectedShapes"),4);this.ia.ra(aa.a.XWb,$b.a.application,Object(C.a)(this,this.Fij,"handleDeleteShapes"),4);this.ia.ra(aa.a.lGa,$b.a.application,Object(C.a)(this,this.xkj,"handleMoveShapes"),4);this.ia.ra(aa.a.reb,$b.a.application,Object(C.a)(this,this.wmj,"handleResizeShapes"),4);this.ia.ra(aa.a.sic,
$b.a.application,Object(C.a)(this,this.S2d,"handleRotateShape"),4);this.ia.ra(aa.a.mTk,$b.a.application,Object(C.a)(this,this.ihg,"handleRotateShapeAnchor"),4);this.ia.ra(aa.a.nTk,$b.a.application,Object(C.a)(this,this.ihg,"handleRotateShapeAnchor"),4);this.ia.ra(aa.a.iea,$b.a.application,Object(C.a)(this,this.jhg,"handleRotateShapeByDirection"),4);this.ia.ra(aa.a.nfh,$b.a.application,Object(C.a)(this,this.jhg,"handleRotateShapeByDirection"),4);qd.a("FlipInMultiSelectEnabledV2")?(this.ia.ra(aa.a.Pdd,
$b.a.application,Object(C.a)(this,this.tgg,"handleFlipShape"),4),this.ia.ra(aa.a.Odd,$b.a.application,Object(C.a)(this,this.tgg,"handleFlipShape"),4)):(this.ia.ra(aa.a.Pdd,$b.a.application,Object(C.a)(this,this.ugg,"handleFlipShapeForSingleSelection"),4),this.ia.ra(aa.a.Odd,$b.a.application,Object(C.a)(this,this.ugg,"handleFlipShapeForSingleSelection"),4));this.ia.ra(aa.a.L3a,$b.a.application,Object(C.a)(this,this.mij,"handleCommitKeyboardShapeManipulation"),4);this.ia.ra(aa.a.Nbc,Db.a.view,Object(C.a)(this,
this.lOc,"handleMoveShapesKeyboard"),4);this.ia.ra(aa.a.Obc,Db.a.view,Object(C.a)(this,this.lOc,"handleMoveShapesKeyboard"),4);this.ia.ra(aa.a.Pbc,Db.a.view,Object(C.a)(this,this.lOc,"handleMoveShapesKeyboard"),4);this.ia.ra(aa.a.Qbc,Db.a.view,Object(C.a)(this,this.lOc,"handleMoveShapesKeyboard"),4);this.ia.ra(aa.a.cic,Db.a.view,Object(C.a)(this,this.tOc,"handleResizeShapesKeyboard"),4);this.ia.ra(aa.a.dic,Db.a.view,Object(C.a)(this,this.tOc,"handleResizeShapesKeyboard"),4);this.ia.ra(aa.a.eic,Db.a.view,
Object(C.a)(this,this.tOc,"handleResizeShapesKeyboard"),4);this.ia.ra(aa.a.fic,Db.a.view,Object(C.a)(this,this.tOc,"handleResizeShapesKeyboard"),4);this.ia.ra(aa.a.nFe,Db.a.view,Object(C.a)(this,this.uOc,"handleRotateShapeKeyboard"),4);this.ia.ra(aa.a.Rdd,Db.a.view,Object(C.a)(this,this.uOc,"handleRotateShapeKeyboard"),4);this.ia.ra(aa.a.Qdd,Db.a.view,Object(C.a)(this,this.uOc,"handleRotateShapeKeyboard"),4);this.ia.ra(aa.a.tic,Db.a.view,Object(C.a)(this,this.uOc,"handleRotateShapeKeyboard"),4);this.ia.ra(aa.a.RAe,
$b.a.application,Object(C.a)(this,this.D2d,"handleIsDirectManipulationEnabled"),97);this.ia.ra(aa.a.s5g,$b.a.application,Object(C.a)(this,this.Ygg,"handlePreviewRotate"),4);this.ia.ra(aa.a.t5g,$b.a.application,Object(C.a)(this,this.Ygg,"handlePreviewRotate"),4);this.ia.ra(aa.a.NSk,$b.a.application,Object(C.a)(this,this.zmj,"handleRevertPreviewRotate"),4)}Fe(){const a=this.Ga.Bc(Xd.a.sg);a.bindAction(A.KeyInputManager.La(x.a.k5,4),aa.a.cic);a.bindAction(A.KeyInputManager.La(x.a.q$,4),aa.a.dic);a.bindAction(A.KeyInputManager.La(x.a.Sea,
4),aa.a.eic);a.bindAction(A.KeyInputManager.La(x.a.OX,4),aa.a.fic);a.bindAction(A.KeyInputManager.La(x.a.q$,5),aa.a.Qdd);a.bindAction(A.KeyInputManager.La(x.a.Sea,5),aa.a.tic);a.bindAction(A.KeyInputManager.La(x.a.q$,1),aa.a.nFe);a.bindAction(A.KeyInputManager.La(x.a.Sea,1),aa.a.Rdd);a.bindAction(A.KeyInputManager.La(x.a.ona,0),aa.a.B3a);a.bindAction(A.KeyInputManager.La(x.a.fH,0),aa.a.B3a);this.Ga.Bc(Xd.a.kj).bindAction(A.KeyInputManager.La(x.a.q$,1),G.a.ze)}xkj(a,b,c,f,l){if(!l||!Object(Ca.a)(Array,
l)||1>l.length)return 8;for(const F of l)if(b=F.shapeNode,this.OOa(b),b.get_smartArtModelId()&&(b=this.Fa.Lr(b)),!this.xKf(b)||this.Df.gd(F.shapeNode))return 16;if(1===c)return 32;if(Kc.a.Db){Kc.a.Db.Nj=!0;for(var w of l)if((c=w.shapeNode)&&(c.Xf||c.xh)){On(c);break}}w=this.Jb.xd(15,void 0,()=>{this.ob.fj();this.Ga.Bd()});try{w.lc(l[0].shapeNode);w.fd=a;const F=this.Pb.Ed;for(const S of l){const fa=new ic.a(F.yf(S.position.x,0),F.yf(S.position.y,1));lq.c(S.shapeNode.get_smartArtModelId()?this.Fa.Lr(S.shapeNode):
S.shapeNode,fa.x,fa.y)}}finally{w&&w.dispose()}return 32}wmj(a,b,c,f,l){if(!l||!Object(Ca.a)(Array,l)||1>l.length)return 8;for(b=0;b<l.length;b++){if(!this.jUb(l[b].g0))return za.a.J(17622101,815,15,"ShapeManipulationActor::ResizeShapes - Try to execute HandleResizeShapes when {0} shape is not resizable.",l[b].g0.get_shapeId()),16;if(this.Df.gd(l[b].g0))return 16}if(1===c)return 32;if(Kc.a.Db){Kc.a.Db.Nj=!0;for(var w of l)if((c=w.g0)&&(c.Xf||c.xh)){On(c);break}}w=this.Jb.xd(15,void 0,()=>{this.ob.fj();
const F=this.Ga.ye;!F||F.name!==Xd.a.sg&&F.name!==Xd.a.oC||this.Ga.Bd()});try{for(w.lc(l[0].g0),w.fd=a,a=0;a<l.length;a++)l[a].g0.dmh=l[a].U_}finally{w&&w.dispose()}if(this.ob.FK()&&(a=this.ob.wra(),(a=this.Nk(a))&&Object(Ca.a)(Ls.a,a.Kk)&&Object(ua.a)(Ls.a,a.Kk).clearChildSelection(),this.dVa&&this.Ha.gcl))for(const F of l)this.LXk(F);return 32}LXk(a){const b=a.g0;if(b&&b.fg&&!b.xh){var c=Kc.a.Db?Kc.a.Db.actionId:xg.a.create().toString(),f=u.AFrameworkApplication.userSessionId,l=this.Za.podSessionId,
w=this.$bl,F=this.Zfb,S=F/w,fa=fe.a.eX(this.Qj.IQ(a.U_.left,S),0),xa=fe.a.eX(this.Qj.IQ(a.U_.top,S),1),Za=fe.a.eX(this.Qj.IQ(a.U_.right,S),0);a=fe.a.eX(this.Qj.IQ(a.U_.bottom,S),1);S=Math.abs(b.get_widthPersisted()+Za-fa);var pb=Math.abs(b.get_heightPersisted()+a-xa);Za=Lk.o(b.slideCid,b.slideSid);a=Lk.b(b.get_shapeId(),null);var Mb=Lk.f(Za,a);fa=Lk.m((b.get_xPersisted()+fa).toString(),(b.get_yPersisted()+xa).toString());fa=Lk.n(S,pb,fa);fa=Lk.c(Mb,fa);xa=null;this.vi&&this.vi.highContrastColors&&
(xa=Lk.k(Lk.j(this.vi.highContrastColors.foregroundTextColor),Lk.j(this.vi.highContrastColors.backgroundColor),Lk.j(this.vi.highContrastColors.linkColor)));f=Lk.d(Za,a,1,b.mh,0,0,c,f,this.vi.isInHighContrastMode,xa,this.Ha.cih&&this.ita?this.ita.x3i():null);l=Lk.e(f,[],l);l.editOps.push(fa);l=Lk.q(null,l,null,null,this.Za.qk);f=Kc.a.KX();Kc.a.Db&&f&&(Kc.a.Db.Ya("editOpCorrelationId",c),Kc.a.Db.Ya("editOpRequestStartTick",f.toString()));this.dVa.dw(l);za.a.J(561292930,815,50,"ShapeManipulationActor::HandleResizeShapes Sent SmartArtEditOpRequest; correlationId:{0}, slideSid:{1}, slideCid:{2}, shapeId:{3}, slideZoomFactor:{4}, slideImageZoom:{5}, SendKnownGlyphsForSmartArtResizeEditOp:{6}",
c,b.slideSid,b.slideCid,b.get_shapeId(),w,F,this.Ha.cih)}}get $bl(){let a=this.Xi.YF;this.Rp&&this.Rp.Ca&&this.Rp.Ca.ow&&null!=this.Rp.Ca.ow.zr&&(a=this.Rp.Ca.ow.zr);a||(za.a.J(561292931,815,15,"ShapeManipulationActor.SlideZoomFactor: zero slideZoomFactor"),a=1);return a}get Zfb(){let a=1;if(this.Rp&&this.Rp.Ca){const b=Object(ua.a)(316,this.Rp.Ca.yg(this.Pb.Na));b?a=b.wV:za.a.J(561292932,815,15,"ShapeManipulationActor.SlideImageZoom: no active ISlideViewElement; imageZoom:{0}",a)}else za.a.J(561292933,
815,15,"ShapeManipulationActor.SlideImageZoom: no active slide; imageZoom:{0}",a);a||(za.a.J(561292934,815,15,"ShapeManipulationActor.SlideImageZoom: zero imageZoom"),a=1);return a}jhg(a,b,c,f,l){return 1===c?32:ug.a("Rotate",a,()=>{za.a.J(50598791,822,50,"ShapeManipulationActor::HandleRotateShapeByDirection, Rotate operation performed");const w=this.ob.mg();if(!w)return za.a.J(50598793,822,10,"ShapeManipulationActor::HandleRotateShapeByDirection, selected nodes: null"),16;this.j5j&&1===w.length&&
this.OOa(w[0]);switch(a){case aa.a.iea:za.a.J(50598795,822,50,"ShapeManipulationActor::RotateLeft: Rotate Left is selected");for(const F of w)l=new vp(F,Math.round(F.get_shapeRotation()+270)),this.S2d(a,b,c,f,l);break;case aa.a.nfh:za.a.J(50598797,822,50,"ShapeManipulationActor::RotateRight: Rotate Right is selected");for(const F of w)l=new vp(F,Math.round(F.get_shapeRotation()+90)),this.S2d(a,b,c,f,l);break;default:return 8}return 32})}S2d(a,b,c,f,l){if(!l||!Object(Ca.a)(vp,l))return 8;b=l.shapeNode;
f=this.kUb(b);if(1===c)return f?32:8;if(!f||this.Df.gd(b))return 16;Kc.a.Db&&(Kc.a.Db.Nj=!0,b&&(b.Xf||b.xh)&&On(b));c=this.Jb.xd(15,void 0,()=>{this.ob.fj();const w=this.Ga.ye;!w||w.name!==Xd.a.sg&&w.name!==Xd.a.oC||this.Ga.Bd()});try{c.lc(b),c.fd=a,b.set_shapeRotation(l.jUf)}finally{c&&c.dispose()}return 32}ihg(){const a=this.ob.mg();return 0<a.length&&this.fKj(a)?32:8}Ygg(a,b,c){return this.Ha.nfc?1===c?32:ug.a("HandlePreviewRotate:",a,()=>{var f=this.ob.mg();for(const l of f){if(!l){za.a.J(562317533,
822,50,"HandlePreviewRotate, shape with shape id : {0} is null",l.get_shapeId());continue}if(l.rd)continue;this.c9b.Kb(l.get_shapeId())?this.c9b.$(l.get_shapeId(),l.get_shapeRotation()):this.c9b.add(l.get_shapeId(),l.get_shapeRotation());f=this.Nk(l);if(!f){za.a.J(562317534,822,50,"HandlePreviewRotate, shapeViewElement with shape id : {0} is null",l.get_shapeId());continue}const w=f.trb().$f();switch(a){case aa.a.s5g:f.setRotation((l.get_shapeRotation()+270)%vp.Adc,w);break;case aa.a.t5g:f.setRotation((l.get_shapeRotation()+
90)%vp.Adc,w)}}return 32}):2}zmj(a,b,c){if(!this.Ha.nfc)return 2;if(1===c)return 32;a=this.ob.mg();for(const f of a)if(!f)za.a.J(562317535,822,50,"HandleRevertPreviewRotate, shape with shape id : {0} is null",f.get_shapeId());else if(!f.rd)if(a=this.Nk(f))if(b=a.trb().$f(),this.c9b.Kb(f.get_shapeId()))a.setRotation(this.c9b.ga(f.get_shapeId()),b);else return za.a.J(562626886,815,10,"HandleRevertPreviewRotate: Revert Preview operation on the shape failed with id : {0}",f.get_shapeId()),8;else za.a.J(562317536,
822,50,"HandleRevertPreviewRotate, shapeViewElement with shape id : {0} is null",f.get_shapeId());return 32}Eij(a,b,c,f,l){b=this.ob.mg();if(1===b.length&&this.ob.jD())return 16;f=1===b.length&&!!b[0]&&b[0].L7a();f=0<b.length&&!f;if(1===c)return f?32:8;if(!f)return 16;if(Kc.a.Db){Kc.a.Db.actionName="ClearPlaceholders";Kc.a.Db.Nj=!0;for(const w of b)if(w.Xf||w.xh){On(w);break}}if(this.ob.FK()&&qd.a("EnableSmartArtSubShapeDeletion")&&this.z2d(b[0],a,l))return 32;c=null;if(l=this.Fa.Z5a(b))qd.a("SmartArtSubNodeEditing")?
c=this.Fa.Lr(l):(this.ob.Ucd(l),b=this.ob.mg());return this.XWb(a,b,this.ob.ny(),c)?32:16}Fij(a,b,c,f,l){if(!l)return 1===c?8:16;b=this.Rp.presentation;if(!b)throw Error.argumentNull("Presentation is null");l=Array.isArray(l.shapeNodes)?l.shapeNodes:null;if(!l)return 1===c?8:16;if(1===c)return 32;Kc.a.Db&&(Kc.a.Db.actionName="DeleteShapes",Kc.a.Db.Nj=!0);return l.length&&this.XWb(a,l,Object(ua.a)(132,b.LB(l[0].slideId)))?32:16}XWb(a,b,c,f=null){if(!c||!b.length||this.Df.OB(b))return!1;let l=!1;for(var w of b)if(w.UCa){l=
!0;break}w=this.Jb.xd(15,void 0,()=>{this.ob.Rh()});try{f?w.hd(f):w.hd(c);w.fd=a;w.iy[wq.a.Rsb]=l;for(const F of b)if(F&&F.xh){const S=this.Fa.ys(F);if(S){const fa=ng.c(S,this.Pb.Na);fa&&(fa.Kk.visible=!1)}}f?f.ubh(b):c.xT(b)}finally{w&&w.dispose()}for(const F of b)this.Pr.a9g(new OJ.a(F));return!0}ugg(a,b,c){b=this.ob.mg();const f=0<b.length?b[0]:null,l=1===b.length&&this.PKd(f);if(1===c)return l?32:8;if(!l||this.Df.gd(f))return 16;this.OOa(f);for(const w of b)if(w.Xf||w.xh){On(w);break}return ug.a("Rotate",
a,()=>{let w,F;switch(a){case aa.a.Odd:F=f.get_isVerticallyFlipped();w=!f.get_isHorizontallyFlipped();break;case aa.a.Pdd:F=!f.get_isVerticallyFlipped();w=f.get_isHorizontallyFlipped();break;default:return 8}const S=this.Jb.xd(15,void 0,()=>{this.ob.fj();this.Ga.Bd()});try{S.lc(f),S.fd=a,f.set_isVerticallyFlipped(F),f.set_isHorizontallyFlipped(w)}finally{S&&S.dispose()}return 32})}tgg(a,b,c){const f=this.ob.mg();b=!0;if(!f||f&&!f.length)b=!1;for(const F of f)if(b=this.PKd(F),!b)break;if(1===c)return b?
32:8;if(!b)return za.a.J(537499273,815,10,"ShapeManipulationActor:: HandleFlipShape shape horizontal flip change with no rotateable shape selected"),16;for(const F of f){if(this.Df.gd(F))return 16;this.OOa(F)}for(const F of f)if(F.Xf||F.xh){On(F);break}const l=a===aa.a.Odd,w=a===aa.a.Pdd;return l||w?ug.a("Rotate",a,()=>{const F=Array(f.length),S=Array(f.length);for(var fa=0;fa<f.length;fa++)S[fa]=!!(w^f[fa].get_isVerticallyFlipped()),F[fa]=!!(l^f[fa].get_isHorizontallyFlipped());fa=this.Jb.xd(15,
void 0,()=>{this.ob.fj();this.Ga.Bd()});try{fa.lc(f[0]);fa.fd=a;for(let xa=0;xa<f.length;xa++)f[xa].set_isVerticallyFlipped(S[xa]),f[xa].set_isHorizontallyFlipped(F[xa])}finally{fa&&fa.dispose()}return 32}):(za.a.J(538589339,815,10,"ShapeManipulationActor:: HandleFlipShape Invalid request"),8)}mij(){this.E2c.LYf();return 32}lOc(a,b,c){const f=ng.b(b);if(!f)return 16;b=this.ob.mg();if(!b.length)return 16;let l=!0;const w=[];for(const F of b)if(F.get_smartArtModelId()){w.push(this.Fa.Lr(F));break}else w.push(F);
for(const F of w)if(!this.xKf(F)){l=!1;break}if(1===c)return l?32:8;if(!l)return 16;c=ng.d(w,f.Na);if(this.Df.OB(b))return 16;switch(a){case aa.a.Nbc:a=ge.a.south;break;case aa.a.Obc:a=ge.a.west;break;case aa.a.Pbc:a=ge.a.east;break;case aa.a.Qbc:a=ge.a.north;break;default:return 8}this.E2c.move(c,a);this.Iz&&this.ob.FK()&&(a=this.ob.wra(),this.Ue.Qdb(new ux.a(a)));Kc.a.Db&&(Kc.a.Db.Nj=!0,Kc.a.Db.uE=new Date);return 32}tOc(a,b,c){const f=ng.b(b);b=this.ob.mg();const l=[];for(var w of b){if(w.get_smartArtModelId()){this.ob.Ucd(w);
Array.add(l,this.Fa.Lr(w));break}!w.isResizable||w.eI||w.rd||Array.add(l,w)}w=ng.d(l,f.Na);if(1===c)return 0<l.length?32:8;if(0>=b.length||this.Df.OB(l))return 16;switch(a){case aa.a.cic:a=ge.a.south;break;case aa.a.dic:a=ge.a.west;break;case aa.a.eic:a=ge.a.east;break;case aa.a.fic:a=ge.a.north;break;default:return 8}this.E2c.resize(w,a);this.Iz&&this.ob.FK()&&(a=this.ob.wra(),this.Ue.Qdb(new ux.a(a)));Kc.a.Db&&(Kc.a.Db.Nj=!0,Kc.a.Db.uE=new Date);return 32}uOc(a,b,c){var f=this.ob.mg();const l=0<
f.length?f[0]:null,w=1===f.length&&this.kUb(l);if(1===c)return w?32:8;if(!w||this.Df.gd(l))return 16;b=ng.b(b);f=ng.d(f,b.Na);c=a===aa.a.Rdd||a===aa.a.tic;a=a===aa.a.Qdd||a===aa.a.tic;0<f.length&&f[0].shapeNode.Xf&&f[0].shapeNode.isEditable&&(b=f[0].shapeNode.yg(b.Na))&&b.hPc();this.E2c.rotate(f,c,a);Kc.a.Db&&(Kc.a.Db.Nj=!0,Kc.a.Db.uE=new Date);return 32}D2d(a,b,c,f,l){return l&&Object(Ca.a)(9,l)?this.Df.gd(l)?16:32:8}fKj(a){for(const b of a)if(!this.kUb(b)&&!this.PKd(b))return!1;return!0}xKf(a){return!!a&&
a.gI&&a.GA&&!a.eI}jUb(a){return!!a&&a.isResizable&&a.GA&&!a.eI}kUb(a){return!!a&&a.DK&&!a.eI}PKd(a){return!!a&&a.YDj&&!a.eI}Nk(a){return a?Object(ua.a)(133,a.pc(this.Pb.Na)):null}OOa(a){a&&a.qy&&(a=this.Nk(a))&&a.Z_(!1)}z2d(a,b,c){return(a=this.Nk(a))&&Object(Ca.a)(Ls.a,a.Kk)&&(a=Object(ua.a)(Ls.a,a.Kk))?a.A9c(aa.a.uz(b),c):!1}}Object(e.a)(eD,"ShapeManipulationActor",null,[]);var ov=d(410),Ei=d(68);class fD extends ov.DragSelectionDragAdapter{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){super(a,b,
c);this.sa=f;this.Ga=l;this.la=S;this.Fa=w;this.c8j=F;this.dC=fa;this.Ib=xa;this.Lp=Za;this.Vca=pb;this.wc=Mb;this.apc=this.bpc=null}get QBc(){return this.bpc}get PBc(){return this.apc}pu(a){for(var b=this.PQe(),c=a.Hc,f=c,l=this.dC.SH(f);!l&&f;){l=this.dC.SH(f);if(Sys.UI.DomElement.containsCssClass(f,"Outline")&&Sys.UI.DomElement.containsCssClass(f,"OutlineSized"))break;f=f.parentNode}l||za.a.J(39175171,820,15,"The element doesn't have a owner and it's parent don't have owner className: "+c.className+
" tagName: "+c.tagName);if(!b||!l)return!1;b=b.node;l=l.gb;c=this.Ib.Jc(l);if(b===l||c.af()&&c.lZa()===b){l=super.pu(a);if(!l)return l;this.Fa.I2(b)&&(c=this.wc.ZM(Object(ua.a)(4,b)))&&c.hp()&&(c=this.Vca.YUd(a.clientPoint,c,null,null))&&(f=c.pc(this.Gf.Na),this.Gf.f5(a.clientPoint,f,c,this.Gf,a.shiftKey));null!==this.Lp&&(a=this.Fa.rd(b),this.Lp.gwa(Ei.a.Q4),a&&(this.bpc=this.Vca.JZd(b),this.apc=this.Vca.G$f(b)));return l}return!1}Jt(a){super.Jt(a);this.AZf();null!==this.Lp&&this.Lp.Nva();this.QBc&&
(this.bpc=null);this.PBc&&(this.apc=null)}In(a){super.In(a);this.AZf();null!==this.Lp&&this.Lp.Nva();this.QBc&&(this.bpc=null);this.PBc&&(this.apc=null)}vBb(a,b,c){({yr:b,graphNode:c}=super.vBb(a,b,c));if(this.la.Lvg&&(a=this.PQe())){const f=this.HYi(c);f&&f===a||(c=a,b=c.pc(this.Gf.Na))}return{yr:b,graphNode:c}}Lmc(a){let b=super.Lmc(a);if(!b&&this.la.Lvg){let c=this.PQe();if(c&&this.Fa.rd(c.node)){const f=this.sa.Mo();this.Vca.dRc(a.clientPoint,f)&&(c=this.Vca.YUd(a.clientPoint,f,this.QBc,this.PBc))}c&&
(b=c.pc(this.Gf.Na))}return b}HYi(a){return a?this.Fa.$m(a):null}PQe(){const a=this.c8j.pcg(this.Gf.Na);return!a||a.uG?null:this.sa.Dq()}AZf(){(this.sa.rG()||this.sa.hu())&&this.Ga.Bd()}}Object(e.a)(fD,"PPTDragSelectionDragAdapter",ov.DragSelectionDragAdapter,[884,223]);class PJ{constructor(a,b,c){this.Le=a;this.d8=b;this.wc=c}dRc(a,b){if(!a||!b)return!1;b=b.pc(this.Le);return b?(b=id.a.ei(b.htmlElement))?!!a&&!!b&&a.x>=b.x&&a.y>=b.y&&a.x<=b.x+b.width&&a.y<=b.y+b.height:!1:!1}YUd(a,b,c=null,f=null){return(a=
this.f2f(a,b,c,f))?a.ly():null}f2f(a,b,c=null,f=null){if(!a||!b)return null;c&&f||(f=this.G$f(b),c=this.JZd(b));if(!(c&&f&&c.length&&f.length))return null;var l=b.pc(this.Le);if(!l)return null;var w=id.a.ei(l.htmlElement);if(!w)return null;l=a.x-w.x;w=a.y-w.y;var F=0;for(a=0;a<c.length&&!(F+=c[a],F>=w);a++);for(F=w=0;F<f.length&&!(w+=f[F],w>=l);F++);a=Math.min(a,c.length-1);F=Math.min(F,f.length-1);return 0>a||a>=c.length||0>F||F>=f.length?null:b.hf(a,F)}JZd(a){if(a){a=this.wc.fia(a);if(!a||!a.length)return null;
const c=a.length,f=Array(c);for(let l=0;l<c;l++){var b=a[l].pc(this.Le);if(!b)return null;b=id.a.ei(b.htmlElement);f[l]=b.height}return f}return null}G$f(a){if(a){a=Ln.b(Object(ua.a)(fg.a,a));if(!a||!a.length)return null;const b=a.length,c=Array(b);for(let f=0;f<b;f++)c[f]=this.d8.Ie(a[f],0);return c}return null}}Object(e.a)(PJ,"PptTableDragSelectionHelper",null,[520]);var Ur=d(635),uz=d(328);class QJ{constructor(a,b,c,f,l,w,F){this.xa=this.lm=null;if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("activeSlideViewManager");if(!f)throw Error.argumentNull("pageView");if(!l)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!w)throw Error.argumentNull("insertShapeOverlayViewElement");if(!F)throw Error.argumentNull("graphTopologyManager");this.ia=a;this.Kc=b;this.Qj=c;this.Pb=f;this.Gxb=l;this.eka=w;this.ua=F}Tu(a){try{return a?a.Sz===Sys.UI.MouseButton.rightButton?!1:2===this.Gxb.Rng?!0:!1:(za.a.J(520680921,822,10,"Event argument is null in isDragPossible for shapes"),
!1)}catch(b){throw za.a.J(520680920,822,10,"Exception {0} occured in isDragPossible for shapes",b),b;}}pu(a){try{if(!a)return za.a.J(520680919,822,10,"Event argument is null in OnDragStart for shapes"),!1;if(!this.Tu(a))return!1;this.eka.Tk(Ei.a.kHb);this.lm=Ur.a(a.clientPoint,this.Kc.Mc);const b=new ri.a;b.left=this.lm.x;b.top=this.lm.y;b.bottom=this.lm.y+5;b.right=this.lm.x+5;a={};a.offsets=b;a.insertShapeActionId=this.eka.uQc;a.insertLocalShape=!0;this.ia.Ma(aa.a.vQc,2,a);this.xa=a.node;return!0}catch(b){throw za.a.J(520680918,
822,10,"Exception {0} occured in OnDragStart for shapes",b),b;}}Xv(a){try{if(!a)return za.a.J(520680917,822,10,"Event argument is null in OnDragMove for shapes"),!1;if(!this.Pb.isActive)return!1;const b=Ur.a(a.clientPoint,this.Kc.Mc),c=Ur.b(this.Vjd(Math.min(this.lm.y,b.y)-this.lm.y),this.Vjd(Math.max(this.lm.y,b.y)-this.lm.y-5),this.Vjd(Math.min(this.lm.x,b.x)-this.lm.x),this.Vjd(Math.max(this.lm.x,b.x)-this.lm.x-5));Object(ua.a)(uz.a,this.xa.pc(0)).setOffsets(c,!0);return!0}catch(b){throw za.a.J(520680916,
822,10,"Exception {0} occured in OnDragMove for shapes",b),b;}}In(a){try{if(a)if(this.lm){var b=Ur.a(a.clientPoint,this.Kc.Mc),c=Ur.b(Math.min(this.lm.y,b.y),Math.max(this.lm.y,b.y),Math.min(this.lm.x,b.x),Math.max(this.lm.x,b.x));a={};a.offsets=c;a.insertShapeActionId=this.eka.uQc;a.insertLocalShape=!1;this.BUf();this.ia.Ma(aa.a.vQc,2,a);this.ZJ()}else za.a.J(520680914,822,10,"m_dragBeginPosition should not be null in OnDragEnd for shapes");else za.a.J(520680915,822,10,"Event argument is null in OnDragEnd for shapes")}catch(f){throw za.a.J(520680913,
822,10,"Exception {0} occured in OnDragEnd for shapes",f),f;}}Jt(){this.ZJ()}dispose(){this.ZJ()}Vjd(a){return this.Qj.OL(a,this.Kc.Mc.wV)}ZJ(){this.lm=null;this.xa&&(this.BUf(),this.Gxb.svh(0),this.xa=null)}BUf(){this.ua.Ca.xT([this.xa])}}Object(e.a)(QJ,"ShapeDrawDragAdapter",null,[223,109]);class vx{constructor(a,b){this.$Dg=null;this.Vwb=-1;this.Ume=a;this.bZj=b}pu(a){return this.RWg(a)?(this.Ume.w9c(),!0):!1}Xv(a){if(!a)return!1;this.bZj?(this.$Dg=a,this.zVk()):this.Bue(a);return!0}In(a){this.zwh()&&
this.rXf(0);this.OWg(a);this.Ume.jic()}Jt(){this.zwh();this.MWg();this.Ume.jic()}zVk(){-1===this.Vwb&&(this.Vwb=window.requestAnimationFrame(Object(C.a)(this,this.rXf,"dragMoveTask")))}zwh(){return-1!==this.Vwb?(window.cancelAnimationFrame(this.Vwb),this.Vwb=-1,!0):!1}rXf(){this.Bue(this.$Dg);this.Vwb=-1}}Object(e.a)(vx,"ShapeDragAdapter",null,[223]);class RJ extends vx{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc){super(hc,Ec);this.m7b=0;this.j7b=this.Ro=this.IN=this.XDg=null;this.PEa=
!1;this.Pb=a;this.ia=b;this.LZ=c;this.pq=f;this.gv=l;this.XB=w;this.ob=F;this.uD=S;this.dC=fa;this.Fa=xa;this.wc=Za;this.Ue=pb;this.kac=Mb;this.Lp=kc;this.Iz=Hc;this.qp=Dc}Tu(a){return this.fI(a).returnValue}fI(a){let b;var c=[];b=!1;if(!a||a.Sz!==Sys.UI.MouseButton.leftButton||this.XB.uZ)return{returnValue:!1,Kbc:c,Z4b:b};const f=Object(ua.a)(317,this.dC.SH(a.Hc));if(!f||!f.e8d(a.Hc))return{returnValue:!1,Kbc:c,Z4b:b};if((b=f.isSelected)||f.shapeNode.xh){c=[];a=Object(ua.a)(133,this.dC.SH(a.Hc));
a.shapeNode.Xf&&this.ob.NUf(a.shapeNode);a=this.ob.mg();for(const l of a)if(l.get_smartArtModelId()){c.push(this.Fa.Lr(l));break}else c.push(l);c=ng.d(c,this.Pb.Na);for(const l of c)if(!this.Rrg(l))return{returnValue:!1,Kbc:c,Z4b:b}}else{if(!this.Rrg(f))return{returnValue:!1,Kbc:c,Z4b:b};Array.add(c,f)}return{returnValue:!0,Kbc:c,Z4b:b}}Rrg(a){return a&&a.gb&&a.gb.gI&&a.gb.GA&&!a.shapeNode.eI&&32===this.ia.Ma(aa.a.RAe,1,a.gb)?!0:!1}RWg(a){var b;let c;if(!({Kbc:b,Z4b:c}=this.fI(a)).returnValue)return!1;
this.ia.processAction(aa.a.L3a,2);this.XDg=ic.a.qPa(a.clientPoint);this.j7b=Object(ua.a)(317,this.dC.SH(a.Hc));null!==this.LZ&&this.LZ.Tk(3);if(!this.j7b||!b||!b.length)return!1;null!==this.Lp&&this.Lp.gwa(Ei.a.Kwa);this.j7b.shapeNode.qy||(this.ob.fj(),this.uD.Bd());for(a=0;a<b.length;++a)this.azc(b[a]);c||(this.ob.setSelection(fd.SelectionFactory.$k(this.Ro[0].gb)),this.gv.Mv());for(b=0;b<this.Ro.length;++b)this.Ro[b].cD(!0);this.PEa=1<this.Ro.length?!1:!0;this.m7b=Date.now();this.Iz&&this.ob.FK()&&
this.Ue.LBe();this.qp&&this.ia.processAction(D.a.Mha,2);return!0}azc(a){this.Ro||(this.Ro=[]);this.IN||(this.IN=[]);Array.add(this.Ro,a);Array.add(this.IN,new ic.a(a.x,a.y))}Bue(a){if(a){var b=this.jMc(ic.a.qPa(a.clientPoint),this.XDg);a=null;var c=this.PEa&&!this.j7b.shapeNode.qy;for(let f=0;f<this.Ro.length;++f)a=ic.a.add(this.IN[f],b),this.Ro[f].setPosition(a.x,a.y,!c);b=this.kac.NZg(!1,this.PEa,this.Ro[0],null);c&&!b&&a&&this.Ro[0].setPosition(a.x,a.y,!0)}}jMc(a,b){a=ic.a.WT(a,b);return new ic.a(this.pq.jn(a.x),
this.pq.jn(a.y))}OWg(a){const b=[];for(var c=0;c<this.Ro.length;++c){var f=this.Ro[c].GKc();Array.add(b,new nv(this.Ro[c].shapeNode,f));this.Ro[c].qz(!1);if(f=this.wc.ZM(this.Ro[c].shapeNode))f=f.hp(),za.a.J(41007125,815,50,"Drag to move table, isComplexTable:{0}",f)}this.j7b.shapeNode.qy||(c={},a&&a.nc&&a.nc.rawEvent&&(c[lh.a.gBa]=a.nc.rawEvent.timeStamp),this.ia.Ma(aa.a.lGa,2,b,c));1===b.length&&(za.a.J(17876371,815,50,"ShapeMoveDragAdapter - moving shape {0} - timespan by {1}",this.Ro[0].shapeNode?
this.Ro[0].shapeNode.er:"",(Date.now()-this.m7b).toString()),this.Iz&&this.ob.FK()&&(a=this.ob.wra(),this.Ue.Qdb(new ux.a(a))));this.S1()}MWg(){if(this.Ro){for(let a=0;a<this.Ro.length;++a)this.Ro[a].setPosition(this.IN[a].x,this.IN[a].y,!0),this.Ro[a].qz(!0);this.S1()}}S1(){this.kac.RZg(this.PEa);null!==this.LZ&&this.LZ.S_();this.Pb.PQ();this.IN=this.Ro=null;null!==this.Lp&&this.Lp.Nva()}}Object(e.a)(RJ,"ShapeMoveDragAdapter",vx,[]);class gD{constructor(a){this.DXc=this.WZ=this.u_=this.J9b=this.g_=
null;this.Rd=a}i1k(a,b,c,f,l){this.g_=a;this.J9b=b;this.u_=c;this.WZ=f;this.DXc=l}}Object(e.a)(gD,"ResizeShapesCalculationData",null,[]);var hD=d(612);class Pk{static zKd(a,b,c,f,l){return f?Pk.XJf(a,c):Pk.rgi(a,b,c,l)}static XJf(a,b){const c=new ri.a;if(a.equals(ge.a.nu)||a.Bub(ge.a.nu))c.left=b.x,c.top=b.y;else if(a.equals(ge.a.YD)||a.Bub(ge.a.YD))c.right=b.x,c.bottom=b.y;return c}static rgi(a,b,c,f){b=a.a3b()?Pk.hgi(a,b,c,f):Pk.tgi(a,b,c);c=new ri.a;if(a.Bub(ge.a.north)||a.equals(ge.a.north))c.top=
-1*b.y;if(a.Bub(ge.a.east)||a.equals(ge.a.east))c.right=b.x;if(a.Bub(ge.a.south)||a.equals(ge.a.south))c.bottom=b.y;if(a.Bub(ge.a.west)||a.equals(ge.a.west))c.left=-1*b.x;return c}static hgi(a,b,c,f){var l=b.Yj(a),w=b.Yj(a.n5a()),F=b.Yj(a.uRi());a=b.Yj(a.vRi());var S=new ic.a(l._x+c.x,l._y+c.y);const fa=hD.b(w,F,S);b=hD.b(w,a,S);c=Pk.HLd(w,F,fa);l=Pk.HLd(w,a,b);b=ic.a.Nl(b,S);S=ic.a.Nl(fa,S);F=ic.a.Nl(w,F);w=ic.a.Nl(w,a);f?(w||(za.a.J(8959632,822,10,"ResizeHelper - shape has height 0"),w=1),F||(za.a.J(8959634,
822,10,"ResizeHelper - shape has width 0"),F=1),f=F/w,!S||b/S>f?(b<Pk.B1&&(b=Pk.B1),S=b/f,S<Pk.B1&&(S=Pk.B1,b=S*f)):(S<Pk.B1&&(S=Pk.B1),b=S*f,b<Pk.B1&&(b=Pk.B1,S=b/f))):(b<Pk.B1&&(b=Pk.B1),S<Pk.B1&&(S=Pk.B1));return new ic.a(b*c-F,S*l-w)}static tgi(a,b,c){var f=a.lMc();a=a.dsb();f=b.Yj(f);var l=b.Yj(a);b=b.Yj(a.n5a());a=ic.a.m6a(f,l);a.pL(c.x,c.y);c=hD.b(b,f,a);a=ic.a.Nl(b,c);l=ic.a.Nl(f,b);a<Pk.B1&&(a=Pk.B1);f=a*Pk.HLd(b,f,c)-l;return new ic.a(f,f)}static HLd(a,b,c){return b._x!==a._x?0>(c._x-a._x)/
(b._x-a._x)?-1:1:0>(c._y-a._y)/(b._y-a._y)?-1:1}}Pk.B1=6;Object(e.a)(Pk,"ResizeHelper",null,[]);class Ms extends vx{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec){super(Za,hc);this.vja=this.d_=this.WEa=this.zde=this.Ade=this.Rd=this.kF=null;this.PEa=!1;this.oQ=this.gQ=null;this.Pb=a;this.ia=b;this.XB=c;this.wUa=f;this.uD=l;this.dC=w;this.Qj=F;this.Ue=S;this.Fa=fa;this.kac=xa;this.Iz=kc;this.Lp=pb;this.we=Mb;this.qp=Ec}Tu(a){if(!a||a.Sz===Sys.UI.MouseButton.rightButton)return!1;this.oQ=[];this.Rd=
Object(ua.a)(133,this.dC.SH(a.Hc));if(!this.Rd||!this.Rd.TE(a.Hc))return!1;a=this.Rd.shapeNode;if(!a||!a.isResizable||this.XB.uZ)return!1;this.kF=[];if(a.ty)Array.add(this.kF,this.Rd);else{var b=this.wUa.he();(b=this.Fa.Z5a(b))&&this.wUa.Ucd(b);a.Xf&&this.wUa.NUf(a);b=this.wUa.mg();this.kF=ng.d(b,this.Pb.Na)}if(this.Fa.I2(this.Rd.shapeNode))Array.add(this.oQ,new gD(this.Rd));else for(const c of this.kF){if(!this.VKj(c))return this.oQ=null,!1;c.shapeNode.isResizable&&!c.shapeNode.rd&&Array.add(this.oQ,
new gD(c))}return!0}VKj(a){return 32!==this.ia.Ma(aa.a.RAe,1,a.gb)||this.XB.uZ||!a.KP?!1:!0}RWg(a){if(!a||!this.Tu(a))return!1;this.wUa.fj();this.uD.Bd();this.ia.processAction(aa.a.L3a,2);this.vja=this.Rd.OZb();if(!this.Rd.TE(a.Hc))return!1;null!==this.Lp&&this.Lp.gwa(Ei.a.kHb);this.gQ=this.Abg(this.Rd.TE(a.Hc),this.Rd,this.vja,!1);this.WEa=this.Ypa(a.clientPoint);({width:this.Ade,height:this.zde}=this.gKf(this.vja,this.Rd.shapeNode.wZ));this.d_=new ic.a(0,0);for(const c of this.oQ){var b=c.Rd.OZb();
a=c.Rd;let f,l;({width:f,height:l}=this.gKf(b,this.Rd.shapeNode.wZ));const w=this.Abg(this.gQ,a,b,!0);c.i1k(b,a.BVa,f,l,w);a.CK=!0;a.cD(!0);b=ng.c(a.shapeNode,this.Pb.Na);a.shapeNode.Xf&&b.Kk&&(b.Kk.visible=!0)}this.PEa=this.Fa.I2(this.Rd.shapeNode)?!0:1<this.kF.length?!1:!0;this.Iz&&this.wUa.FK()&&this.Ue.LBe();this.qp&&this.ia.processAction(D.a.Mha,2);return!0}Bue(a){if(a){var b=this.Ypa(a.clientPoint),c=ic.a.WT(b,this.WEa);this.d_=ic.a.add(this.d_,this.Bbg(c,this.vja,!1));var f=null;c=this.PEa&&
!this.Rd.shapeNode.qy;for(const l of this.oQ){let w=new ic.a(l.u_/this.Ade*this.d_.x,l.WZ/this.zde*this.d_.y);new ri.a;if(l.Rd.shapeNode.ty){this.Rd.shapeNode.ty&&(w=this.d_);if(!l.DXc)continue;f=Pk.XJf(l.DXc,w)}else f=Pk.zKd(l.DXc,l.g_,this.Bbg(w,l.g_,!0),l.Rd.shapeNode.ty,l.Rd.shapeNode.isAspectRatioLocked||a.shiftKey);f=ri.a.add(l.J9b,this.n3f(f,l.g_));l.Rd.setOffsets(f,!c);l.Rd.shapeNode.Xf&&l.Rd.shapeNode.isEditable&&l.Rd.M3d()}this.WEa=b;a=this.kac.NZg(!0,this.PEa,this.Rd,this.gQ);c&&!a&&f&&
this.Rd.setOffsets(f,!0)}}n3f(a,b){if(this.Fa.I2(this.Rd.shapeNode))return a;const c=new ri.a;c.left=b.QRc?a.right:a.left;c.right=b.QRc?a.left:a.right;c.top=b.d8a?a.bottom:a.top;c.bottom=b.d8a?a.top:a.bottom;return c}OWg(a){const b=[];for(var c=0;c<this.oQ.length;c++){let f=ri.a.WT(this.oQ[c].Rd.BVa,this.oQ[c].J9b);f=this.n3f(f,this.oQ[c].g_);Array.add(b,new tz(this.oQ[c].Rd.shapeNode,f,this.gQ,this.d_));this.oQ[c].Rd.shapeNode.Xf&&this.oQ[c].Rd.shapeNode.isEditable||(this.oQ[c].Rd.CK=!1);this.oQ[c].Rd.qz(!1)}this.Rd.shapeNode.qy?
gb.App.Fb.updateCommandUI():(c={},a&&a.nc&&a.nc.rawEvent&&(c[lh.a.gBa]=a.nc.rawEvent.timeStamp),this.Fa.I2(this.Rd.shapeNode)?(this.Rd.POa(),this.ia.Ma(aa.a.seh,2,b,c)):this.ia.Ma(aa.a.reb,2,b,c));this.Iz&&this.wUa.FK()&&(a=this.wUa.wra(),this.Ue.Qdb(new ux.a(a)));this.ZJ()}MWg(){if(this.oQ){for(const a of this.oQ)a.Rd.setOffsets(a.J9b,!0),a.Rd.CK=!1,a.Rd.qz(!0);this.ZJ()}}ZJ(){this.kac.RZg(this.PEa);this.vja=this.zde=this.Ade=this.Rd=this.kF=this.oQ=this.gQ=this.d_=this.WEa=null;null!==this.Lp&&
this.Lp.Nva()}gKf(a,b){let c;var f=b?this.pXd(a):a;c=ic.a.Nl(f.ga(0),f.ga(1));f=ic.a.Nl(f.ga(0),f.ga(3));b||(a=ke.a.uT(ic.a.WJ(a.ga(0),a.ga(1))),Math.floor((a+45)/90)%2&&(a=f,f=c,c=a),c||(za.a.J(17622149,822,10,"ShapeResizeDragAdapter - shape {0} has width 0",this.Rd.shapeNode.er),c=1),f||(za.a.J(17622151,822,10,"ShapeResizeDragAdapter - shape {0} has height 0",this.Rd.shapeNode.er),f=1));return{width:c,height:f}}Abg(a,b,c,f){if(b.shapeNode.ty){if(this.Rd.shapeNode.ty)return a;if(a.equals(ge.a.JD)||
a.equals(ge.a.bH))return null;if(a.equals(ge.a.nu)||a.equals(ge.a.YD))return c.ga(0).x>c.ga(1).x?a.n5a():a;if(b.shapeNode.wZ){f=ke.a.uT(ic.a.WJ(c.ga(0),c.ga(1)));if(a.equals(ge.a.north)||a.equals(ge.a.south))return Math.abs(f-90)<Ms.r9b||Math.abs(f-270)<Ms.r9b?c.ga(0).y<c.ga(1).y?a:a.n5a():null;if(a.equals(ge.a.east)||a.equals(ge.a.west))if(Math.abs(f-180)<Ms.r9b||360-f<Ms.r9b||f<Ms.r9b)return c.ga(0).x<c.ga(1).x?a:a.n5a()}return null}c=ic.a.WJ(c.ga(0),c.ga(1));c=Math.floor((c+Math.PI/4)/(Math.PI/
2));for(b=0;b<c;b++)a=f?a.lMc().lMc():a.dsb().dsb();return a}Bbg(a,b,c){if(this.Rd.shapeNode.ty||this.Fa.I2(this.Rd.shapeNode))return a;var f=ic.a.WJ(b.ga(0),b.ga(1));const l=Math.floor((f+Math.PI/4)/(Math.PI/2))%4;f=b.ga(3-l);b=b.ga(3>l?2-l:3);f=ic.a.WJ(f,b);return c?new ic.a(Math.cos(f)*a.x-Math.sin(f)*a.y,Math.sin(f)*a.x+Math.cos(f)*a.y):new ic.a(Math.cos(f)*a.x+Math.sin(f)*a.y,Math.cos(f)*a.y-Math.sin(f)*a.x)}Ypa(a){var b=this.Rd.E1(this.Qj.jn(a.x)),c=this.Rd.E1(this.Qj.jn(a.y));if(this.Fa.I2(this.Rd.shapeNode)){c=
this.gQ;this.gQ.a3b()||(c=c.dsb());b=this.we.ei(this.Rd.aNa);b.x+=nf.a.vgd;b.y+=nf.a.vgd;b.width-=2*nf.a.vgd;b.height-=2*nf.a.vgd;var f=qi.a.qba(b);b=f.Yj(c);f=f.Yj(c.n5a());c=b.y<=f.y?Math.min(a.y,f.y):Math.max(a.y,f.y);b=this.Rd.E1(this.Qj.jn(b.x<=f.x?Math.min(a.x,f.x):Math.max(a.x,f.x)));c=this.Rd.E1(this.Qj.jn(c))}return new ic.a(b,c)}pXd(a){const b=ic.a.m6a(a.ga(0),a.ga(3));a=ic.a.m6a(a.ga(1),a.ga(2));return new qi.a(new ic.a(b.x,b.y),new ic.a(a.x,b.y),new ic.a(a.x,a.y),new ic.a(b.x,a.y))}}Ms.r9b=
3;Object(e.a)(Ms,"ShapeResizeDragAdapter",vx,[]);var SJ=d(188);class vz{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.lle=this.Hme=null;this.I9b=0;this.qoe=this.W$b=null;this.yXc=0;this.rKg=8;this.jMg=4;this.VWj="AngleUIRendered";this.LG=this.Rd=null;this.Pb=a;this.ia=b;this.XB=f;this.LZ=c;this.sa=l;this.uD=w;this.dC=F;this.Qj=S;this.uc=fa;this.Qd=xa;this.Lp=Za;this.qp=pb;this.BEa=Mb}Tu(a){if(!a||a.Sz!==Sys.UI.MouseButton.leftButton||this.XB.uZ)return!1;this.Rd=Object(ua.a)(133,this.dC.SH(a.Hc));
return this.Rd&&this.Rd.i$d(a.Hc)?(this.LG=this.Rd.shapeNode)&&this.LG.DK&&this.Rd.KP?!0:!1:!1}pu(a){if(!a||!this.Tu(a))return!1;this.sa.fj();this.uD.Bd();this.ia.processAction(aa.a.L3a,2);null!==this.Lp&&this.Lp.gwa(Ne.a.oP(this.Qd.rk("rotatehandlecursor.cur"),Ei.a.esh));this.I9b=this.LG.get_shapeRotation();this.W$b=this.Rd.OZb().$f();this.qoe=this.Rd.trb().$f();this.Hme=this.Ypa(a.clientPoint);this.Rd.Xia=!0;this.BEa&&this.vIe(!0);this.Rd.cD(!0);this.qp&&this.ia.processAction(D.a.Mha,2);return!0}Xv(a){if(!a)return!1;
this.lle=this.Ypa(a.clientPoint);if(!this.lle)return!1;this.yXc=ke.a.uT(ic.a.WJ(this.lle,this.W$b))-ke.a.uT(ic.a.WJ(this.Hme,this.W$b));let b=this.I9b+this.yXc;this.BEa&&(b=this.Aqh(b));this.Rd.setRotation(Math.round(b),this.qoe);this.BEa&&(a=this.Ypa(a.clientPoint,!1),this.ltl(a,Math.round(b)));return!0}Aqh(a){return this.iai(a)?10*Math.round(a/10):a}iai(a){0>a&&(a=(a+360)%360);return(a+this.jMg/2)%90<=this.jMg?!0:!1}ltl(a,b){var c=this.uc.Sg(this.Rd.gb);c=ng.e(c,this.Pb.Na);c.vic.tC(2);c.vic.setPosition(a.x+
this.rKg,a.y+this.rKg);c.vic.za.style.position="absolute";0>b&&(b+=360);c.vic.za.innerText=(b%360).toString()+"\u00b0"}vIe(a){const b=this.uc.Sg(this.Rd.gb);ng.e(b,this.Pb.Na).vic.Sd(a)}In(a){this.BEa&&this.vIe(!1);this.Rd.Xia=!1;this.Rd.qz(!1);var b=this.I9b+this.yXc;this.BEa&&(b=this.Aqh(b));b=new vp(this.LG,Math.round(b));const c={};a&&a.nc&&a.nc.rawEvent&&(c[lh.a.gBa]=a.nc.rawEvent.timeStamp);this.BEa&&(c[this.VWj]=1);this.ia.Ma(aa.a.sic,2,b,c);this.S1()}Jt(){this.W$b&&(this.Rd.setRotation(this.I9b,
this.qoe),this.BEa&&this.vIe(!1),this.Rd.Xia=!1,this.Rd.qz(!0),this.S1())}Ypa(a,b=!0){var c=this.uc.Sg(this.Rd.gb);return(c=ng.e(c,this.Pb.Na).qC)?(a=ic.a.qPa(SJ.a.FPa(a,c)),b?new ic.a(this.Rd.E1(this.Qj.jn(a.x)),this.Rd.E1(this.Qj.jn(a.y))):a):null}S1(){null!==this.LZ&&this.LZ.S_();null!==this.Lp&&this.Lp.Nva();this.Pb.PQ();this.Hme=null;this.I9b=0;this.W$b=null;this.yXc=0;this.Rd=this.LG=null}static getInstance(a){return vz.IB(a)}static IB(a){return new vz(a,lb.a.instance.resolve("Common.IActionManagerExtended"),
lb.a.instance.resolve("Common.ICursorPinningTool"),lb.a.instance.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),lb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),lb.a.instance.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),lb.a.instance.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),lb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),lb.a.instance.resolve("PowerPointWebEditor.ISlideReader"),lb.a.instance.resolve("PowerPoint.IPathManager"),
lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?lb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").Lye)}}Object(e.a)(vz,"ShapeRotateDragAdapter",null,[223]);var iD=d(318);class TJ{constructor(a,b,c,f,l){this.lm=this.lr=null;if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("pageView");if(!f)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!l)throw Error.argumentNull("insertShapeOverlayViewElement");this.ia=a;this.Kc=b;this.Pb=c;this.Gxb=f;this.eka=l}mKi(){if(this.lr)return this.lr;this.lr=new Ym.a;this.lr.gt("MarqueeDiv");this.lr.Uk(0);this.lr.za.style.borderStyle="solid";this.lr.za.style.borderWidth="thin";this.lr.za.style.borderColor="black";this.lr.za.style.opacity=
"0.5";this.lr.Sd(!1);return this.lr}Pxh(a,b){this.lr&&this.lr.Bh(a,b)}Oxh(a,b){this.lr&&this.lr.setPosition(a,b)}ZJ(){this.lm=null;this.lr&&(this.lr.Sd(!1),this.lr.aq())}FId(a){const b=this.Kc.Mc;if(!b||!b.oe||!b.oe.za)return za.a.J(524941122,822,10,"Unable to attach marquee element to the slide view element"),!1;b.oe.za.appendChild(a.za);a.tC(2+iD.a.w$);a.Sd(!0);return!0}Tu(a){try{return a?a.Sz===Sys.UI.MouseButton.rightButton?!1:1===this.Gxb.Rng?!0:!1:(za.a.J(524932310,822,10,"Event argument is null in isDragPossible"),
!1)}catch(b){throw za.a.J(524932311,822,10,"Exception {0} occured in isDragPossible",b),b;}}pu(a){try{if(!a)return za.a.J(524932312,822,10,"Event argument is null in OnDragStart"),!1;if(!this.Tu(a))return!1;this.lm=Ur.a(a.clientPoint,this.Kc.Mc);const b=this.mKi();if(!this.FId(b))return!1;this.Oxh(this.lm.x,this.lm.y);this.Pxh(0,0);return!0}catch(b){throw za.a.J(524932313,822,10,"Exception {0} occured in OnDragStart",b),b;}}Xv(a){try{if(!a)return za.a.J(524932314,822,10,"Event argument is null in OnDragMove"),
!1;if(!this.Pb.isActive)return!1;const b=Ur.a(a.clientPoint,this.Kc.Mc),c=Math.min(this.lm.x,b.x),f=Math.min(this.lm.y,b.y),l=Math.max(this.lm.x,b.x),w=Math.max(this.lm.y,b.y);this.Oxh(c,f);this.Pxh(l-c,w-f);return!0}catch(b){throw za.a.J(524932315,822,10,"Exception {0} occured in OnDragMove",b),b;}}In(a){try{if(a)if(this.lm){var b=Ur.a(a.clientPoint,this.Kc.Mc),c=Ur.b(Math.min(this.lm.y,b.y),Math.max(this.lm.y,b.y),Math.min(this.lm.x,b.x),Math.max(this.lm.x,b.x));this.ia.Ma(aa.a.A2b,2,c);qd.a("TelemetryForClickAndDragOperation")&&
za.a.J(522846412,822,50,"TextboxDrawDragAdapter::OnDragEnd");this.ZJ()}else za.a.J(524941123,822,10,"m_dragBeginPosition should not be null in OnDragEnd");else za.a.J(524932316,822,10,"Event argument is null in OnDragEnd")}catch(f){throw za.a.J(524932317,822,10,"Exception {0} occured in OnDragEnd",f),f;}}Jt(){this.ZJ()}dispose(){this.ZJ();this.lr=null}}Object(e.a)(TJ,"TextboxDrawDragAdapter",null,[223,109]);class Ns{constructor(a,b,c){this.O0c=0;this.IN=null;this.R5b=!1;this.Ame=this.LXc=null;this.Jyb=
new ic.a(0,0);this.Nka=1;this.Xi=a;this.Kc=b;this.WYj=c;this.WYj.DR(Object(C.a)(this,this.RVa,"onSlideNavigation"))}job(a){return a?!0:!1}RVa(){this.Nka=1;this.Jyb=new ic.a(0,0);this.setTransform(new ic.a(0,0))}zub(a){if(!a)return!1;a=this.teg(a.nc);return!!a&&1<a.length}awe(a){if(!a)return!1;this.O0c=this.Xi.DT;if(!this.zub(a))return!1;this.IN=this.DMc(a.nc);return!1}wdc(a){if(!a)return!1;this.zub(a)?(a=this.DMc(a.nc),this.IN||(this.IN=a),this.Vmd(this.Ggi(this.IN,a))):this.Jmk(a);return!0}Jmk(a){a&&
(a=this.DMc(a.nc),this.R5b?(a=this.QJf(this.LXc,a),this.setTransform(a)):(this.R5b=!0,this.LXc=a))}In(a){if(this.R5b&&a){a=this.DMc(a.nc);var b=this.QJf(this.LXc,a);a=b.x+this.Jyb.x;b=b.y+this.Jyb.y;this.R5b=!1;this.Jyb=new ic.a(a,b)}}QJf(a,b){return!a||1>a.length||!b||1>b.length?new ic.a(0,0):new ic.a(b[0].x-a[0].x,b[0].y-a[0].y)}setTransform(a){if(this.Kc&&this.Kc.Mc&&this.Kc.Mc.rT){var b=this.Kc.Mc.rT;this.Ame||(this.Ame=b.style.cssText);b.style.cssText=this.Ame+"  width:100%;height:100%; transform:translate("+
(a.x+this.Jyb.x+"px,"+(a.y+this.Jyb.y)+"px) scale("+this.Nka+","+this.Nka+")")}}m2k(){this.setTransform(new ic.a(0,0))}hCb(a){if(!a)return!1;this.In(a);this.Hkl();return!1}Vmd(a){this.O0c&&(a*=this.O0c,a<Ns.XRg?a=Ns.XRg:a>Ns.tRg&&(a=Ns.tRg),this.Xi.Lia=!1,this.Nka=this.Xi.DT=a,this.m2k())}PJf(a){if(!a||1>=a.length)return-1;const b=a.length;return Math.sqrt(Math.pow(a[0].x-a[b-1].x,2)+Math.pow(a[0].y-a[b-1].y,2))}Ggi(a,b){a=this.PJf(a);b=this.PJf(b);return-1!==a&&-1!==b&&a?b/a:0}teg(a){let b=null;
if(!a)return null;a=a.rawEvent?a.rawEvent:a;a.touches&&(b=a.touches,!b.length&&a.changedTouches&&(b=a.changedTouches));return b}DMc(a){let b=null;a=this.teg(a);if(!a)return b;b=[];for(const c of a)Array.add(b,new ic.a(c.screenX,c.screenY));return b}Hkl(){this.O0c=0;this.IN=null;this.R5b=!1;this.LXc=null}}Ns.XRg=1;Ns.tRg=5;Object(e.a)(Ns,"ZoomSettingTouchAdapter",null,[882]);var eQ=d(411);class UJ{constructor(a,b,c,f,l,w){this.Rle=!1;this.lm=null;this.Nke=!1;this.Pb=a;this.V3=b;this.ob=c;this.Kc=f;
this.Ga=l;this.ua=w;this.lr=new Ym.a;this.lr.gt("Marquee");this.lr.Uk(0);this.lr.za.style.backgroundColor="darkgrey";this.lr.za.style.opacity="0.5";this.lr.Sd(!1)}FId(){this.lr&&(this.Kc.Mc.oe.za.appendChild(this.lr.za),this.Rle=!0)}ZJ(){this.lm=null;this.lr&&(this.lr.Sd(!1),this.lr.aq(),this.Rle=!1);this.Nke=!1}Tu(a){if(!a||a.Sz===Sys.UI.MouseButton.rightButton)return!1;a=new eQ.a(a,this.Pb);return this.Pb.x4b(a)}pu(a){if(!a||!this.Pb.isActive||!this.Tu(a))return!1;this.V3.f9g(new Zr(!0));a.ctrlKey||
a.shiftKey?za.a.J(8959586,816,50,"MarqueeSelectDragAdapter used: Ctrl {0}, Shift {1}",a.ctrlKey,a.shiftKey):this.ob.Rh();this.Ga.Bd();this.Nke=a.shiftKey?!0:!1;this.lm=this.Ypa(a.clientPoint);this.Rle||this.FId();this.lr.setPosition(this.lm.x,this.lm.y);this.lr.Bh(0,0);this.lr.tC(1+iD.a.w$);this.lr.Sd(!0);return!0}Xv(a){if(!a||!this.Pb.isActive)return!1;var b=this.Ypa(a.clientPoint);a=Math.min(this.lm.x,b.x);const c=Math.min(this.lm.y,b.y),f=Math.max(this.lm.x,b.x);b=Math.max(this.lm.y,b.y);this.lr.setPosition(a,
c);this.lr.Bh(f-a,b-c);return!0}In(a){if(a){var b=this.Ypa(a.clientPoint);a=Math.min(this.lm.x,b.x);var c=Math.min(this.lm.y,b.y),f=Math.max(this.lm.x,b.x);b=Math.max(this.lm.y,b.y);var l=this.ua.Ca,w=l?l.km():[];l=[];var F=[],S=this.ob.he();for(const fa of w)(w=Object(ua.a)(133,fa.pc(this.Pb.Na)))&&w.KP&&(w.jp?w.tkc():(w=w.L1d(!1),w.fc>=a&&w.ic>=c&&w.$b<=f&&w.Xb<=b&&(this.Nke?Array.contains(S,fa)?F.push(fa):l.push(fa):Array.contains(S,fa)||l.push(fa))));0<l.length&&this.ob.mXa(l,!1);0<F.length&&
this.ob.aXb(F);this.ZJ()}}Jt(){this.lm&&this.ZJ()}Ypa(a){const b=this.Kc.Mc.qC;return b?ic.a.qPa(SJ.a.FPa(a,b)):ic.a.qPa(a)}dispose(){this.lm&&this.ZJ();this.lr=null}}Object(e.a)(UJ,"MarqueeSelectDragAdapter",null,[223,109]);class VJ{constructor(a){this.iW=null;this.nci(a);this.i3d=!1}nci(a){null!==a&&(this.iW=Ne.a.De(),this.iW.style.position=Ei.a.absolute,this.iW.style.top="0px",this.iW.style.left="0px",a.appendChild(this.iW))}gwa(a){null!==a&&null!==this.iW&&null!==this.iW.parentNode&&(this.iW.style.cursor=
a,this.iW.style.zIndex=String(Ei.a.bzl),this.iW.style.height="100%",this.iW.style.width="100%",this.i3d=!0)}Nva(){if(null!==this.iW||this.i3d)this.iW.style.height="0px",this.iW.style.width="0px",this.iW.style.cursor=Ei.a.esh,this.iW.style.zIndex="-1",this.i3d=!1}}Object(e.a)(VJ,"CursorContainerManager",null,[519]);class jD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeManipulation"}Yb(a){this.K=a;a.register(519,"PowerPointWebEditor.ShapeManipulation.ICursorContainerManager").ma().na(()=>
new VJ(a.resolve("PowerPointWebEditor.AppFrame").F0));a.register(eD,"PowerPointWebEditor.ShapeManipulationActor").ma().na(()=>new eD(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),new wp(a.resolve("Common.IActionManagerExtended")),a.resolve("Common.Transaction.ITransactionFactory"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").oFe,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),
a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Common.Utils.IHighContrastDetector"),a.resolve("Gc2.IGlyphStore")));a.register(fD,"PowerPointWebEditor.ShapeManipulation.PPTDragSelectionDragAdapter").as("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter").ma().na(()=>new fD(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IActivityManager"),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeReader"),oa.InteractiveViewManager.instance,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader")));a.register(520,"PowerPointWebEditor.IPptTableDragSelectionHelper").ma().na(()=>new PJ(a.resolve("Box4.IPageView").Na,a.resolve("Box4.IPageView").Ed,a.resolve("PowerPointWebEditor.Graph.ITableReader")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTextEditOnlyMode||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled||
this.Htj();this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled&&this.yuj();this.vtj()}yuj(){const a=this.K.resolve("PowerPointWebEditor.IZoomContext");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").mIk(new Ns(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}Htj(){var a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const b=this.K.resolve("Common.IActionManagerExtended");
var c=this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext");const f=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),l=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?null:this.K.resolve("Common.CursorManager"),w=this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),F=this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),S=this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),fa=this.K.resolve("PowerPointWebEditor.ISlideReader"),
xa=this.K.resolve("PowerPointWebEditor.IShapeReader"),Za=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),pb=this.K.resolve("PowerPointWebEditor.ISmartGuideManager"),Mb=this.K.resolve("PowerPointWebEditor.Core.IPauseTheWorldManager"),hc=this.K.resolve("PowerPoint.IPathManager"),kc=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Ec=!!window.requestAnimationFrame&&
!!window.cancelAnimationFrame;this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").aEb(2,this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").aEb(1,new RJ(a,b,l,S,this.K.resolve("Box4.IUndoManager"),c,f,w,F,xa,this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),Za,pb,Mb,kc,Ec,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),
new Ms(a,b,c,f,w,F,S,Za,xa,pb,Mb,kc,this.K.resolve("PowerPoint.IBrowserHelperManager"),Ec,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),new vz(a,b,l,c,f,w,F,S,fa,hc,kc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Lye),new UJ(a,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),
f,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));this.K.resolve("PowerPointWebEditor.IApplicationSettings").l6d&&(c=new QJ(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")),this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").X$g(c));this.K.resolve("PowerPointWebEditor.IApplicationSettings").Etb&&(a=new TJ(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement")),this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").X$g(a));za.a.J(22126852,
813,50,"Shape manipulation drag adapter init complete")}vtj(){const a=this.K.resolve("PowerPointWebEditor.ShapeManipulationActor");a.Fe();a.wb()}dispose(){}static main(){m.a.instance.Ec(new jD)}}Object(e.a)(jD,"PPTWebEditorShapeManipulationPackage",null,[2,3]);var fQ=d(1104),wx=d(1159),$q=d(118);class xx{constructor(a,b,c,f,l,w,F,S){this.ule=null;this.ile=new Date;this.$P=a;this.E2j=b;this.r7j=c;this.BXj=f;this.s2j=l;this.hFa=w;F.Hb(new Se.a(S,2,this.BXj,Object(C.a)(this,this.WLf,"checkTask"),90,
"61"))}WLf(){this.Unl()}Unl(){var a=new Date;const b=+new Date-+this.ule>this.r7j;if(!(this.ile<this.ule)||b){if(+a-+this.ile<this.E2j)return;this.$P()}a=+new Date-+a;a>this.s2j&&za.a.J(8958035,813,10,"PrefetchManager::PrefetchThrottler::TryPrefetchIfAppropriate() took too long to check  prefetch: {0}ms for {1}",a,this.hFa)}ojd(){this.ule=new Date}ljd(){this.ile=new Date}}Object(e.a)(xx,"PrefetchThrottler",null,[]);class Up{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc){this.ied=250;this.j8b=
this.L6b=null;this.OHg=this.rHg=!1;this.rzb=[];this.bfi=5;this.mJf=10;this.szb=[];this.cfi=5;this.iUa=!1;this.MPg=this.pN=this.aWc=null;this.r_c=!1;this.Ane=[];this.Wb=a;this.ua=b;this.FG=c;this.sj=f;this.pee=l;this.Ay=Hc;this.$ka=w;this.Ha=F;this.Bb=S;this.uc=fa;this.Xu=xa;this.lL=Za;this.zd=pb;this.d6j=Mb;this.Oc=hc;this.Dk=kc;this.Cx=Ec;this.R5j=this.Ha.eJj;this.j4j=u.AFrameworkApplication.fa.ka("PrefetchThrottlerNormalPriorityEnabled");this.g4j=u.AFrameworkApplication.fa.ka("PrefetchLookaheadSlideEnabled");
!r.a.Ji||this.Ha.fJj?this.setEnabled(this.Ha.YBj,this.Ha.lFj):this.setEnabled(!1,!1);this.i4j=this.Ha.prefetchSlideForwardMax;this.h4j=this.Ha.prefetchSlideBackwardMax;this.vYj=u.AFrameworkApplication.fa.ka("PodDisableAlwaysPrefetchSlidesInVisibleRange");this.pUk=u.AFrameworkApplication.fa.Gc("SlidePrefetchLookaheadCount",0);this.OG=!1;this.Oc.wB(Object(C.a)(this,this.tL,"onSessionClosed"));this.Oc.G2a(Object(C.a)(this,this.Fda,"onSessionRehydrating"));this.Oc.xB(Object(C.a)(this,this.eo,"onSessionRehydrated"));
u.AFrameworkApplication.fa.ka("SlidePrefetchThrottlerMinDelayReduced")&&(this.ied=125);this.Cx&&this.Cx.PCa(()=>{this.lel()})}lel(){this.MPg=new Se.a(2,1,this.ied,Object(C.a)(this,this.updateSlidePrefetchRange,"updateSlidePrefetchRange"),90,"59");this.r_c=!1;const a=this.j4j?2:3;this.L6b=new xx(Object(C.a)(this,this.Snl,"tryPrefetchContentModel"),this.ied,Up.qUk,Up.kgh,Up.egh,"content model",this.Bb,a);this.zd.Kmb(Object(C.a)(this,this.Vcb,"onVisibleThumbnailsChanged"));this.Dk.xM(Object(C.a)(this,
this.hC,"onActiveSlideChanged"));this.j8b=new xx(Object(C.a)(this,this.Vnl,"tryPrefetchImages"),this.ied,Up.oUk,Up.kgh,Up.egh,"image",this.Bb,3);this.lL&&(this.lL.zga(Object(C.a)(this,this.Azg,"loadedHandler")),this.lL.yk(Object(C.a)(this,this.E6g,"propertyChangedHandler")))}get Bf(){this.aWc&&this.aWc.isConnected||(this.aWc=this.Wb.Bf);return this.aWc}get Ca(){this.pN||(this.pN=this.ua.Ca);return this.pN}setEnabled(a,b){this.rHg=a;this.OHg=b}f6c(){this.rzb=[];this.szb=[];this.iUa=!1}dispose(){this.zd.sch(Object(C.a)(this,
this.Vcb,"onVisibleThumbnailsChanged"));this.Dk.H9(Object(C.a)(this,this.hC,"onActiveSlideChanged"));this.Oc.aea(Object(C.a)(this,this.tL,"onSessionClosed"));this.Oc.EDe(Object(C.a)(this,this.Fda,"onSessionRehydrating"));this.Oc.cea(Object(C.a)(this,this.eo,"onSessionRehydrated"));this.lL&&(this.lL.HWa(Object(C.a)(this,this.Azg,"loadedHandler")),this.lL.Pm(Object(C.a)(this,this.E6g,"propertyChangedHandler")))}tL(){this.OG=!0}Fda(){this.f6c()}eo(){this.OG=!1}Snl(){this.rHg&&this.znh()&&this.Gwk()}Gwk(){var a=
this.G1d();const b=this.iUa?null:Rq.b(a,c=>c?c.Cb:null);(a=this.p3g(0,a))?(a=a.Cb,this.L6b&&this.L6b.ojd(),this.Xu.prefetchSlide(a,b,()=>{this.iUa=!0}),this.Nzk(a)):this.iUa||this.Xu.prefetchSlide(Rd.a.empty,b,()=>{this.iUa=!0})}hC(){this.pN=null;this.iUa=!1}Vcb(){this.jml();this.iUa=!1}Azg(a,b){(a=Object(ua.a)(132,b.node))&&a.NB&&this.Ecc(a)}E6g(a,b){a=b.property;b.node&&a===zb.a.cid&&(this.iUa=!1)}Ecc(a){if(a.isConnected){var b=Object(ua.a)(132,a);b&&(b.oDa=!0,this.Bb.Hb(new Se.a(2,1,0,Object(C.a)(this.j8b,
this.j8b.WLf,"checkTask"),90,"60")),u.AFrameworkApplication.fa.ka("PPTOTextPreloadServiceFonts")&&(Array.clear(this.Ane),this.XFd(b.U2f),this.XFd(b.Tuh),this.XFd(b.Cyh),b=new Se.a(3,1,0,Object(C.a)(this,this.Tnl,"tryPrefetchFonts"),90,"114"),b.customData=this.Ane,this.Bb.Hb(b)))}this.L6b&&(this.L6b.ljd(),this.rzb=[]);a.ZIa=!0;this.$ka.LYa()}Nzk(a){this.rzb.length>=this.mJf&&(this.rzb=[]);Array.add(this.rzb,a)}XFd(a){if(!Ja.a.Xa(a)){a=a.split(",");for(const b of a)this.Ane.push(b)}}p3g(a,b=null){const c=
this.Ca;if(!c||!c.isConnected)return null;b||(b=this.G1d());return this.a6i(c,a,b)}a6i(a,b,c){for(const f of c)if(f)if(c=f.Cb,this.jpj(c))za.a.J(553648658,813,50,"PrefetchManager::PickBestSlide() prefetching content model for slide={0} and fetchType={1} failed many times",c,b);else if(this.p7k(f,b)){const l=a.Cb;a=this.uc.d0b(a);const w=this.uc.d0b(f);za.a.J(41710016,813,50,"PrefetchManager::PickBestSlide() prefetching {0} at {1} with offset {2} from currentSlide {3} at {4} for fetchType={5}",c,w,
w-a,l,a,b);return f}return null}jpj(a){let b=0;for(const c of this.rzb)a.equals(c)&&(b+=1);if(b>=this.bfi)return!0;b=0;for(const c of this.szb)a.equals(c)&&(b+=1);return b>=this.cfi}p7k(a,b){if(!a)return!1;var c=a.Cb;if(Rd.a.DA(c))return!1;const f=!!a&&a.NB;if(0===b)return!f;if(!f||!a.oDa)return!1;b=a.TQa(new $q.a(a.Up,a.Gk));if(null===b)return za.a.J(8958031,813,50,"PrefetchManager::ShouldPrefetchSlide() null images for {0}",c),!1;for(const l of b)if({data:c}=this.FG.DPc.udd(l),!c)return!0;return a.oDa=
!1}Vnl(){if(this.OHg&&this.znh()){const b=this.p3g(1);if(b){var a=b.Cb;this.j8b.ojd();this.uOi(b);this.Ozk(a)}}}Tnl(a){a=Array.isArray(a.customData)?a.customData:null;for(const b of a)this.Ay.VGi(b)}znh(){return this.OG||!this.R5j&&2===this.sj.Waa||!this.Bf||this.pee.Zra(this.Bf)||!this.Ca||this.Ca.BK?!1:!0}Ozk(a){this.szb.length>=this.mJf&&(this.szb=[]);Array.add(this.szb,a)}uOi(a){if(a){var b=a.TQa(new $q.a(a.Up,a.Gk));b&&0<b.length?this.FG.Oqb(b,!0,()=>{this.j8b.ljd();this.szb=[];a.oDa=!1},u.AFrameworkApplication.fa.ka("FetchSlideImageBatchInRealTimeEnabled")):
a.oDa=!1}}jml(){this.r_c||(this.Bb.Hb(this.MPg),this.r_c=!0)}updateSlidePrefetchRange(){this.r_c=!1;this.Xu.syncCurrentSlideIdAndPrefetchRange(this.Ca,null,this.$ka.sna,null)}Vej(){return Rq.b(this.G1d(),a=>a?a.Cb:null)}G1d(){const a=[];var b=this.Ca;if(!b||!b.isConnected)return a;b=this.uc.d0b(b);var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");c=c.slides||[];const f=c.length,l=[];if(!this.vYj)for(var w of this.$ka.sna.n7)w!==b&&w<f&&(Array.add(a,c[w]),l[w]=!0);if(this.g4j&&
!l.length)for(w=1;w<=this.pUk;w++){const F=this.$ka.sna.lastIndex+w;F!==b&&F<f&&(Array.add(a,c[F]),l[F]=!0)}if(0<=b){b=this.d6j.Mcg(b,c.length,this.i4j,this.h4j);for(const F of b)if(void 0===l[F]||null===l[F])l[F]=!0,Array.add(a,c[F])}return a}}Up.kgh=1E3;Up.qUk=2E3;Up.oUk=6E4;Up.egh=500;Object(e.a)(Up,"PrefetchManager",null,[515,109]);class kD{constructor(a,b,c,f){this.Yh=b;this.CD=c;this.sa=f;this.Oc=a;this.Oc.F2a(Object(C.a)(this,this.Qcb,"onSessionEnding"))}Qcb(a,b){if(this.sa.jD()){a=this.sa.he();
if(!a.length){const c=this.sa.ncg();c&&a.push(c)}for(const c of a)this.Yh.G3a(c)}this.CD.wSi(b.aJ)}dispose(){this.Oc.DDe(Object(C.a)(this,this.Qcb,"onSessionEnding"))}}Object(e.a)(kD,"SessionCleanupHandler",null,[109]);var WJ=d(424),gQ=d(926);class lD{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.nvd=this.Rsc=this.Zoe=!1;if(!b)throw Error.argumentNull("taskManager");if(!c)throw Error.argumentNull("context");this.Ha=a;this.ANg=a.sessionTimeoutInMs;this.Bb=b;this.Ez=c;this.sa=f;this.oTa=l;this.TB=
w;this.Wd=F;this.ua=S;this.Zb=fa;this.Zl=xa;this.BNg=Za;this.so=pb;this.bDg=Mb;this.P$b=0}get uba(){return this.oTa.instance}get I7(){return u.AFrameworkApplication.Xg}get Tvg(){return 1===this.P$b}get cvb(){return this.Rsc}get xTc(){return this.nvd}get aJ(){return this.P$b}set aJ(a){this.P$b=a}get DKf(){return this.Ha.podsSeamlessFailoverEnabled&&!!this.so.instance}start(){if(!this.I7){var a=new Se.a(4,2,3E4,Object(C.a)(this,this.EQg,"manageLifetime$p"),90,"56");this.Bb.Hb(a)}}U8j(){this.EQg(null)}EQg(){if(!this.Zoe){var a=
+new Date-+Kc.a.h5b;a>this.ANg&&this.eMi(a);u.AFrameworkApplication.wz&&u.AFrameworkApplication.fa.ka("WOPITokenRefreshStopWhenOutOfRangeIsEnabled")&&a>=this.Ha.wopiTokenRefreshMaxDurationInMs&&this.TB.sEk()}}eMi(a){this.I7||(this.xNf(2),this.DKf?this.bDg.instance&&this.bDg.instance.W6a&&(za.a.J(512360777,805,15,"SessionLifetimeManager::ExpireSession - ShowCustomizedTimeoutMessageForCommentDraft"),Mf.Health.instance.recordQosError("TimeoutDialogForCommentDraft",["SessionExpired"],!0,!0,!1,!0,null),
this.BNg.Ial()):this.BNg.Hal(),this.TB.rDk(),za.a.J(512360776,801,15,"SessionLifetimeManager::ExpireSession - Session has expired after idle {0}, timeout {1}. CanRehydrate:{2}; ValidFailoverInstance:{3}; SeamlessFailoverEnabled:{4};",a,this.ANg,this.DKf,!!this.so.instance,this.Ha.podsSeamlessFailoverEnabled))}closeSession(a=1){this.xNf(a)}xNf(a){0===a&&za.a.J(512360775,801,50,"SessionCloseReason should not be unknown!");if(!this.I7)try{this.Rsc=!0,za.a.J(512360774,801,15,"SessionLifetimeManager::CloseSession() - closing session, reason:{0}",
WJ.a[a]),this.P$b=a,this.sa.setSelection(null),u.AFrameworkApplication.Xg=!0,this.Ez.UPa().O6c=!0,this.Wd.disabled=!0,Xh.a.zw&&4!==a&&Xh.a.zw.hide(),this.TB.vBe(new gQ.a(a)),this.uba&&0<this.uba.mBa.count&&this.uba.qhc(this.Ez.aQa().presentationId,"instanceId",!0,!1),this.Ha.podsSeamlessFailoverEnabled&&this.so.instance&&(1===a?this.so.instance.REd("abortedOnExitApp"):this.so.instance.REd("SessionClose_"+a)),this.Bb.stop(),this.Zl.isPaused||this.Zl.pause(),4!==a&&2!==a&&this.Zb.blockContent(this.ua.presentation,
"CloseSession",!0),this.TB.Abd(new Yn.a(a))}finally{this.nvd=this.Rsc=!1}}obl(){this.Zoe=!0}BSk(){this.Zoe=!1}markSessionClosingAtForceSave(a){za.a.J(512360773,801,15,"SessionLifetimeManager::MarkSessionClosingAtForceSave reason:{0}",WJ.a[a]);this.nvd=this.Rsc=!0;this.P$b=a}}Object(e.a)(lD,"SessionLifetimeManager",null,[1272]);var Uf=d(413);class XJ{constructor(){this.trigger=null;this.h$=this.lgb=this.sYa=0;this.XNd={}}}Object(e.a)(XJ,"SuggestionsInfo",null,[]);class YJ{constructor(){this.SessionID=
this.SerializedUser=this.BaseDocQueryStringWithoutVersion=null}}Object(e.a)(YJ,"StartRtcConnectionRequest",null,[]);class ZJ{constructor(){this.SessionID=null}}Object(e.a)(ZJ,"StopRtcConnectionRequest",null,[]);var hQ=d(305);class $J{constructor(a,b){this.slideId=a;this.bI=hQ.a.QEc(b)}}Object(e.a)($J,"ThumbnailImageId",null,[]);var Os=d(354);const aK=a=>{var b=null;return(a=a.match(RegExp("/Thumb\\[(\\d+),(\\d+)\\]/ID\\[(\\d+),(\\d+)\\]")))&&5===a.length?(b=new Os.a,b.Sid=Number.parseInvariant(a[3]),
b.Cid=Number.parseInvariant(a[4]),b=new Rd.a(b),{returnValue:!0,slideId:b}):{returnValue:!1,slideId:b}},bK=a=>{let b,c,f;var l;let w,F;b=null;f=c=0;w=l=null;F=-1;return(a=a.match(RegExp("/IncSuggestion/(.*),(\\d+),(\\d+),(\\d+),(\\d+),(.*),(\\d+)")))&&8===a.length?(b=a[1],c=Number.parseInvariant(a[2]),f=Number.parseInvariant(a[3]),l=Object.assign(new Os.a,{Sid:Number.parseInvariant(a[4]),Cid:Number.parseInvariant(a[5])}),l=new Rd.a(l),w=a[6],F=Number.parseInvariant(a[7]),{returnValue:!0,correlationID:b,
DX:c,h$:f,slideID:l,trigger:w,lgb:F}):{returnValue:!1,correlationID:b,DX:c,h$:f,slideID:l,trigger:w,lgb:F}},iQ=a=>{const b=new Ua.a;try{const c=md.a(a);for(const f of c.SlideSuggestions)b.add(f.Index)}catch(c){za.a.J(42342594,829,10,"ContentKeyHelper:TryGetSuggestionIndexesListFromValue - parsing suggestionResults failed.")}return b};var wz;(function(a){a[a.none=0]="none";a[a.alone=1]="alone";a[a.coauthoring=2]="coauthoring"})(wz||(wz={}));Object(e.b)("CoauthorStatus",wz);class cK extends Sys.EventArgs{constructor(a){super();
this.Fga=a}}Object(e.a)(cK,"AppliedPolicyIdEventArgs",Sys.EventArgs,[]);class dK extends Sys.EventArgs{constructor(a){super();this.NIc=a}}Object(e.a)(dK,"FileRevisionHistoryEventArgs",Sys.EventArgs,[]);class eK extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.aOc=a;this.CIc=b;this.BEj=c;this.confidence=f;this.imageDescription=l}}Object(e.a)(eK,"ImageDescriptionReadyEventArgs",Sys.EventArgs,[]);class fK extends Sys.EventArgs{constructor(a){super();this.G3b=a}}Object(e.a)(fK,"IsManuallyAppliedEventArgs",
Sys.EventArgs,[]);class gK extends Sys.EventArgs{constructor(){super()}}Object(e.a)(gK,"CommentsChangedEventArgs",Sys.EventArgs,[]);class hK extends Sys.EventArgs{constructor(a){super();this.gVd=a}}Object(e.a)(hK,"FindRtcSessionEventArgs",Sys.EventArgs,[]);class iK extends Sys.EventArgs{constructor(){super()}}Object(e.a)(iK,"LastMergeEditUTCChangedEventArgs",Sys.EventArgs,[]);class jK extends Sys.EventArgs{constructor(){super()}}Object(e.a)(jK,"RealTimeEditEventArgs",Sys.EventArgs,[]);class mD extends Sys.EventArgs{constructor(a,
b=null){super();this.F6j=a;this.ZYj=b}get fth(){return this.F6j}get vMi(){return this.ZYj}}Object(e.a)(mD,"SyncLoopStatusNotifiedEventArgs",Sys.EventArgs,[]);class kK extends Sys.EventArgs{constructor(a){super();this.oxk=a}}Object(e.a)(kK,"PresentationLastModifiedTimeReceivedEventArgs",Sys.EventArgs,[]);var lK=d(855);class mK extends Sys.EventArgs{constructor(a){super();this.slideId=a}}Object(e.a)(mK,"DesignerSuggestionCoauthModifiedEventArgs",Sys.EventArgs,[]);class xz extends Sys.EventArgs{constructor(a,
b,c,f,l,w,F){super();this.X4d=!1;this.hlc=null;this.correlationId=a;this.sYa=b;this.h$=c;this.trigger=l;this.slideId=w;this.SAa=F;this.AIa=f}}Object(e.a)(xz,"DesignerSuggestionsUpdatedEventArgs",Sys.EventArgs,[]);class yx extends Sys.EventArgs{constructor(a,b,c){super();this.correlationId=a;this.slideId=b;this.SAa=c}}Object(e.a)(yx,"FixItSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class nK extends Sys.EventArgs{constructor(a,b,c,f){super();this.slideId=a;this.BX=c;this.shapeId=b;this.SAa=f}}Object(e.a)(nK,
"IconSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class oK extends Sys.EventArgs{constructor(a,b,c,f,l,w){super();this.correlationId=a;this.dca=b;this.slideId=c;this.shapeId=f;this.AHa=l;this.SAa=w}}Object(e.a)(oK,"ReplaceObjectUpdatedEventArgs",Sys.EventArgs,[]);class nD{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig){this.Sge=this.Lge=!1;this.YIg=null;this.kKg={};this.$ka=b;this.ql=ig;this.jq=l;this.dXc=w;this.Wb=S;this.ua=fa;this.Xu=xa;this.k1c=Za;this.Wd=pb;this.TB=
Mb;this.Ue=hc;this.hXc=kc;this.Tv=Ec;this.Za=a;this.NN=Hc;this.Zyb=Dc;this.Oc=Td;this.GXc=c;this.Ha=we;this.yt=Pd;this.Bb=He;this.$u=Pe;this.hc=Df;this.YHg=this.Ha.zg&&this.Ha.pptNoRtcConnectWhenReadOnlyEnabled;this.Oc.F2a(Object(C.a)(this,this.ZA,"onSessionEnd"));this.Oc.wB(Object(C.a)(this,this.FVd,"flushOnSessionEnd"));this.GXc.gCf(Object(C.a)(this,this.EYg,"onNormalChannelDocNotifyClientItemsUpdated"));f&&f.gCf(Object(C.a)(this,this.EYg,"onNormalChannelDocNotifyClientItemsUpdated"));this.Ha.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&
this.Oc.xB(Object(C.a)(this,this.z9,"onPodSessionRehydrated"));this.YHg&&this.Oc.Bga(Object(C.a)(this,this.Wz,"onUnifiedAppStateChanged"))}EYg(a,b){this.Rgk(b,this.dXc)}WRe(a,b){const c=[];for(const f of a.items)({slideId:a}=aK(f.Key)).returnValue&&(a=Uf.a.B0b(a.sid,a.cid),b.YLc(a)<f.TimeStamp&&(a=Sys.Serialization.JavaScriptSerializer.deserialize(f.Value),Array.add(c,new lK.a(a,f.TimeStamp))));c.forEach(f=>{const l=f.eqb.Id;b.WRe(Uf.a.B0b(l.Sid,l.Cid),f.R9)})}Rgk(a,b){let c=!1;const f=[],l=[],w=
new XJ;for(const Dc of a.items){const Td=new Date,we=this.yt.aDa;var F=void 0,S=void 0,fa=void 0,xa=void 0,Za=void 0,pb=void 0;if(Dc.Key===Uf.a.j5g)b.YLc(Uf.a.j5g)>Dc.TimeStamp||(za.a.J(8958410,813,50,"Need to reload the whole presentation."),c=!0);else if(({slideId:S}=aK(Dc.Key)).returnValue)S=Uf.a.B0b(S.sid,S.cid),b.YLc(S)>=Dc.TimeStamp||(S=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),Array.add(f,new lK.a(S,0<S.SnapshotTimeStamp?S.SnapshotTimeStamp:Dc.TimeStamp)));else if(Dc.Key.startsWith(Uf.a.ZXf))S=
Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),this.jq.lAh(S),za.a.J(8958412,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Notify clientID to websession; clientId: {0};",S);else if(Dc.Key===Uf.a.iIi)S=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),za.a.J(40383177,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - EditorTable; LastRequestCorrelationID:{0}; TimeStamp:{1}; EditorsCount:{2};",Dc.LastRequestCorrelationID,Dc.TimeStamp,S.length),
this.jq.Fzh(S);else if(Dc.Key===Uf.a.Rmi)S=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),za.a.J(40383179,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - CoauthStatus; LastRequestCorrelationID:{0}; TimeStamp:{1}; NewStatus:{2};",Dc.LastRequestCorrelationID,Dc.TimeStamp,wz[S]),this.jq.Zmc(S);else if(Dc.Key===Uf.a.Xri)za.a.J(39913162,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - Content update; LastEditorID:{0}; LastRequestCorrelationID:{1}; TimeStamp:{2}; RevisionId:{3}; IsFromRealTimeChannel:{4}",
Dc.LastEditorID,Dc.LastRequestCorrelationID,Dc.TimeStamp,Dc.Value,!1),this.TB.TBk(),this.Xu.JE(this.Wb.Gi);else{var Mb;if(Mb=Dc.Key.startsWith(Uf.a.RUf)){a:{Mb=void 0;S=Dc.Value;try{const Pd=S?S.split(","):[];if(3!==Pd.length){Mb=Rd.a.XD(0,0);za.a.J(23089477,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Coauth modified value member is not expected; value:{0}.",S);var hc={returnValue:!1,slideId:Mb};break a}const He=Number.parseInvariant(Pd[0]),Pe=Number.parseInvariant(Pd[1]),
Df=Pd[2];Mb=Rd.a.XD(Number.parseInvariant(Pd[0]),Number.parseInvariant(Pd[1]));za.a.J(23089479,823,50,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Sid:{0}, Cid:{1}, modified Guid:{2}.",He,Pe,Df)}catch(Pd){za.a.J(23089481,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Cannot get slide id from coauth modified key. Value:{0}, exception log:{0}.",S,Pd.toString());Mb=Rd.a.XD(0,0);hc={returnValue:!1,slideId:Mb};break a}hc={returnValue:!0,slideId:Mb}}Mb=({slideId:S}=
hc).returnValue}if(Mb)za.a.J(23089437,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Coauth Modified notification returned, slide id:{0}",Dc.Value),this.Ue.XBk(new mK(S));else{if(Mb=Dc.Key.startsWith(Uf.a.ysh)){{var kc=void 0;let Pd;S=null;F=0;kc=Pd=null;(Mb=Dc.Key.match(RegExp("/Suggestion\\[(.*),(\\d+)]/ID\\[(\\d+),(\\d+),(.*),(.*)]")))&&7===Mb.length?(S=Mb[1],F=Number.parseInvariant(Mb[2]),kc=Object.assign(new Os.a,{Sid:Number.parseInvariant(Mb[3]),Cid:Number.parseInvariant(Mb[4])}),
Pd=new Rd.a(kc),kc=Mb[6],F={returnValue:!0,correlationID:S,DX:F,slideID:Pd,trigger:kc}):F={returnValue:!1,correlationID:S,DX:F,slideID:Pd,trigger:kc}}Mb=({correlationID:F,DX:w.sYa,slideID:S,trigger:w.trigger}=F).returnValue}if(Mb)za.a.J(21266881,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer suggestion notification returned, CorrelationId:{0}",F),S=new xz(F,w.sYa,w.sYa,0,w.trigger,S,Dc.Value),S.hlc=new Ua.a,this.Nze(S);else if(this.Ha.designerIncrementalRenderEnabled&&Dc.Key.startsWith(Uf.a.Z4d)&&
({correlationID:F,DX:w.sYa,h$:w.h$,slideID:S,trigger:w.trigger,lgb:w.lgb}=bK(Dc.Key)).returnValue)za.a.J(41460361,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer incremental suggestion notification returned, CorrelationId: {0}; startIdx: {1}; Suggestions in notification: {2}; Expected total: {3}",F,w.lgb,w.sYa,w.h$),S=new xz(F,w.sYa,w.h$,w.lgb,w.trigger,S,Dc.Value),F in w.XNd||(w.XNd[F]=this.rcj(F,a.items)),S.hlc=w.XNd[F],S.X4d=!0,this.Nze(S);else{if(Mb=Dc.Key.startsWith(Uf.a.d3f))S=
F=null,(Mb=Dc.Key.match(RegExp("/FixItSuggestion\\[(.*)]/ID\\[(\\d+),(\\d+),(.*)]")))&&5===Mb.length?(F=Mb[1],S=Object.assign(new Os.a,{Sid:Number.parseInvariant(Mb[2]),Cid:Number.parseInvariant(Mb[3])}),S=new Rd.a(S),F={returnValue:!0,correlationID:F,slideID:S}):F={returnValue:!1,correlationID:F,slideID:S},Mb=({correlationID:F,slideID:S}=F).returnValue;if(Mb)za.a.J(578937882,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - FixIt suggestion notification returned, CorrelationId:{0}",
F),this.Nze(new yx(F,S,Dc.Value));else{if(Mb=Dc.Key.startsWith(Uf.a.apg))pb=null,fa=0,Mb=null,F=S=0,(xa=Dc.Key.match(RegExp("/Intelligence\\[(.*),(\\d+),(\\d+),(\\d+),(\\d+),(\\d+)]")))&&7===xa.length?(pb=xa[1],fa=Number.parseInvariant(xa[2]),F=Object.assign(new Os.a,{Sid:Number.parseInvariant(xa[3]),Cid:Number.parseInvariant(xa[4])}),Mb=new Rd.a(F),S=Number.parseInvariant(xa[5]),F=Number.parseInvariant(xa[6]),fa={returnValue:!0,correlationID:pb,dca:fa,slideID:Mb,shapeId:S,AHa:F}):fa={returnValue:!1,
correlationID:pb,dca:fa,slideID:Mb,shapeId:S,AHa:F},Mb=({correlationID:F,dca:fa,slideID:S,shapeId:xa,AHa:pb}=fa).returnValue;if(Mb)za.a.J(25011784,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - ReplaceObject notification returned, CorrelationId:{0}",F),this.Ue.iDk(new oK(F,fa,S,xa,pb,Dc.Value));else if(Dc.Key===Uf.a.Tyl)this.Wnj();else if(Dc.Key===Uf.a.j1f&&this.YIg!==Dc.Value)this.gjj(Dc);else if(Dc.Key===Uf.a.gth)!Ja.a.Xa(Dc.Value)&&Ja.a.Gub(Dc.Value)?(S=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),
za.a.J(23606223,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; PopSessionID:{1}; PodSessionID:{2}",S,this.Za.uk,this.Za.podSessionId),240===S?this.NN.$da(1):(432!==S||this.Sge||this.yWf(),this.Zyb.k9g(new mD(S)))):(S=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),za.a.J(594031708,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; HasExtraErrorParams:{1}; PopSessionID:{2}; PodSessionID:{3}",
S.Code,!!S.ExtraErrorParam,this.Za.uk,this.Za.podSessionId),240===S.Code?this.NN.$da(1):(432!==S.Code||this.Sge||this.yWf(),this.Zyb.k9g(new mD(S.Code,S.ExtraErrorParam))));else if(Dc.Key===Uf.a.wyg)this.dkj(Dc);else if(Dc.Key===Uf.a.Lqj)za.a.J(22917834,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Host Session Failover notification received oldsessionId:{0};",this.Za.uk),this.NN.$da(1);else if(Dc.Key===Uf.a.pxk)S=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),this.Wb.Bf.Wye=
S,this.Tv.bDk(new kK(S));else if(Dc.Key.startsWith(Uf.a.yOf)){za.a.J(38602590,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Comment has been createed or updated with key: {0}",Dc.Key);a:{S=Dc.Key;try{const Pd=S.match(RegExp("\\d+","g"));if(Pd&&0<Pd.length&&!(Pd.length%2)){Mb=[];for(kc=0;kc<Pd.length;kc+=2)Mb.push(Object.assign(new Os.a,{Sid:Number.parseInvariant(Pd[kc]),Cid:Number.parseInvariant(Pd[kc+1])}));var Ec=Mb;break a}}catch(Pd){za.a.J(25011930,805,10,"ContentKeyHelper::TryGetSlideIdsFromCommentPrefixKey - Cannot get slide id array from key. Key:{0}, Exception:{1}",
S,Pd)}Ec=null}(S=Ec)&&0<S.length&&this.TB.OBk(new gK(S))}else if(Dc.Key.startsWith(Uf.a.jkg))this.Ejj(Dc);else if(Dc.Key===Uf.a.H1f)this.hXc.eCk(new dK(Dc.Value));else{if(Mb=Dc.Key.startsWith(Uf.a.Njg)){a:{Za=Dc.Key;Mb=null;S=0;xa="";try{const Pd=Za.match(RegExp("/IconSuggestion\\[(\\d+),(\\d+),(\\d+),{(.*)}]"));if(Pd&&5===Pd.length){const He=Object.assign(new Os.a,{Sid:Number.parseInvariant(Pd[1]),Cid:Number.parseInvariant(Pd[2])});Mb=new Rd.a(He);S=Number.parseInvariant(Pd[3]);xa=Pd[4];var Hc={returnValue:!0,
slideID:Mb,shapeId:S,nodeId:xa};break a}}catch(Pd){za.a.J(38279246,823,10,"ContentKeyHelper::TryGetIconSuggestionInfoFromServiceKey - Cannot get IconSuggestionInfo from key. Value:{0}, exception log:{0}.",Za,Pd.toString())}Hc={returnValue:!1,slideID:Mb,shapeId:S,nodeId:xa}}Mb=({slideID:S,shapeId:xa,nodeId:Za}=Hc).returnValue}if(Mb)za.a.J(38102290,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IconSuggestion notification returned."),this.Ue.pCk(new nK(S,xa,Za,Dc.Value));else if(Dc.Key===
Uf.a.bQi)this.Zyb.fCk(new hK(Dc.Value));else{if(Mb=Dc.Key.startsWith(Uf.a.Yuh))Mb=null,(S=Dc.Key.match(RegExp("/ThumbImgId\\[(\\d+),(\\d+)\\]")))&&3===S.length?(Mb=new Os.a,Mb.Sid=Number.parseInvariant(S[1]),Mb.Cid=Number.parseInvariant(S[2]),Mb=new Rd.a(Mb),S={returnValue:!0,slideId:Mb}):S={returnValue:!1,slideId:Mb},Mb=({slideId:S}=S).returnValue;if(Mb)S=new $J(S,Dc.Value),S.bI&&l.push(S);else if(Dc.Key===Uf.a.uGi)this.$u.eSe(parseInt(Dc.Value));else if(Dc.Key===Uf.a.OEf)this.hXc.FBk(new cK(Dc.Value));
else if(Dc.Key===Uf.a.Otg)this.hXc.xCk(new fK("true"===Dc.Value.toLowerCase()));else if(Dc.Key===Uf.a.ATk)this.jq.vfh=Dc.Value,this.jq.gZg();else if(Dc.Key===Uf.a.yTk)try{this.jq.Lgd=Boolean.parse(Dc.Value)}catch(Pd){za.a.J(578856836,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",Pd)}else if(Dc.Key===Uf.a.oyg)S=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),za.a.J(594355552,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - LastMergeEditUTC updated: {0}",
S.toString()),this.TB.CCk(new iK(S));else if(Dc.Key===Uf.a.Q9g)S=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),za.a.J(593094492,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated- Raising a RealTimeChannelEditEvent. UTC Time: {0}",S.toString()),this.TB.dDk(new jK(S));else if(Dc.Key===Uf.a.Qsj)try{this.jq.K7d=Boolean.parse(Dc.Value),za.a.J(577827018,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IsConnectedToOCS: {0}",this.jq.K7d)}catch(Pd){za.a.J(577827016,
817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",Pd)}else if(Dc.Key===Uf.a.Jqj)this.jq.Bec=Dc.Value,za.a.J(556799195,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - PopsHostProtocol: {0}",this.jq.Bec);else if(Dc.Key===Uf.a.czl)za.a.J(575714116,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received ZeroByteFileEnsuredOnHost notification"),this.jq.uDh=!0;else if(Dc.Key===Uf.a.ESj)za.a.J(575714117,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockId: {0}",
Dc.Value),this.jq.Q2=Dc.Value;else if(Dc.Key===Uf.a.FSj)za.a.J(560818076,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockIsCoauthorable: {0}",Dc.Value),this.jq.Fzg=Boolean.parse(Dc.Value);else if(Dc.Key===Uf.a.iUf)try{this.jq.m4a=Number.parseInvariant(Dc.Value),za.a.J(562562498,843,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - DeferredBlobCount: {0}",this.jq.m4a)}catch(Pd){za.a.J(562562499,843,15,"Can't parse the notification message: {0}",Pd)}else if(Dc.Key===
Uf.a.wDf){let Pd;try{Pd=Boolean.parse(Dc.Value),this.jq.minorVersionLimitReached=Pd}catch(He){Pd=this.jq.minorVersionLimitReached=!1}Pd&&!this.Lge&&(this.AFi(),this.Lge=!0);za.a.J(558470218,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received AllowSaveAtMinorVersionLimit: {0}, m_fIsMinorVersionLimitReachedDisplayed: {1}",Dc.Value,this.Lge)}else za.a.J(22929492,817,50,"Notification key ignored {0}",Dc.Key)}}}}}}za.a.J(22929483,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated docItem.Key:{0}, ProcessNotificationStart:{1}, ProcessNotificationDuration:{2}",
Dc.Key,Kc.a.Ve(Td),(+new Date-+Td).toString());we&&!this.yt.aDa&&za.a.J(39917696,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Dragging is stopped while processing docItem.Key:{0}",Dc.Key)}this.Yql(c,f,b,l)}rcj(a,b){const c=new Ua.a;b=Cg.e(b,f=>f.Key.startsWith(Uf.a.Z4d));for(const f of b){let l,w,F;({correlationID:l,DX:w,lgb:F}=bK(f.Key)).returnValue&&l===a&&(1===w?c.add(F):1<w&&c.addRange(iQ(f.Value)))}return c}AFi(){this.ql.OM(24);za.a.J(558453728,809,50,"CoauthNotificationManager::DisplayVersionLimitHitInfo reached - business bar for MinorVersionLimit")}yWf(){this.Sge=
!0;this.ql.OM(25);za.a.J(553916428,809,15,"CoauthNotificationManager::DisplayNetworkLocationUnauthorizedInfo reached - business bar for UserNetworkLocationUnauthorized Shown")}Nze(a){let b;b=Object(Ca.a)(yx,a)?()=>{this.Ue.raiseFixItSuggestionUpdatedEvent(Object(ua.a)(yx,a))}:()=>{this.Ue.raiseDesignerSuggestionsUpdatedEvent(Object(ua.a)(xz,a))};if(this.yt.aDa&&this.Ha.processSuggestionNotificationInTaskIfInDragIsEnabled){const c=new Se.a(2,1,0,()=>{b()},90,Object(Ca.a)(yx,a)?"114":"92");this.Bb.Hb(c)}else b()}Yql(a,
b,c,f){a&&(this.$ka.khj(),this.k1c.instance&&this.k1c.instance.f6c());b.forEach(l=>{const w=l.eqb.Id;c.WRe(Uf.a.B0b(w.Sid,w.Cid),l.R9)});this.$ka.hjj(b,f)}Wnj(){za.a.J(19145504,817,10,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Document was already opened by antoher DC.");this.Wb.Gi&&this.Wb.Gi.contentReplicator&&(this.Wb.Gi.contentReplicator.enabled=0);this.Wd.YH(158,a=>{a.$C=1;return!1})}gjj(a){za.a.J(22086613,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Failover notification received");
this.TB.dCk(new Gl(!1,!0));let b=null;this.k1c.instance&&(b=this.k1c.instance.Vej());this.Xu.syncCurrentSlideIdAndPrefetchRange(this.ua.Ca,b,null,null);this.YIg=a.Value}dkj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);if(this.Za.podSessionId!==a)if(this.Ha.ignorePodSessionRefreshedFromPops)za.a.J(41501833,817,50,"CoauthNotificationManager::HandleLatestPodSessionNotification - Ignore Pop rehydrated Pod session");else{const b=this.Za.podSessionId;this.Za.podSessionId=a;this.Zyb.K8g(new Yi.a(b,
a))}else za.a.J(25306245,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Same PodSessionId:{0}",a)}Ejj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);try{if(a){const b=a.split(";",6);a=!0;for(let c=0;5>c;c++)if(!b[c]){a=!1;break}if(6>b.length||!a)za.a.J(25798599,817,15,"Invalid format of image description notification");else{const c=Fa.a.ig(b[1]),f=Boolean.parse(b[2]),l=Boolean.parse(b[3]);this.hXc.qCk(new eK(c,f,l,parseFloat(b[4]),b[5]))}}else za.a.J(25798597,817,
15,"Response data is null")}catch(b){za.a.J(25798601,817,15,"Can't parse the notification message: {0}",b)}}IRi(){let a=0;const b=[],c=(new Date).getTime(),f=this.kKg;for(let w in f){var l=w;0<c-f[w]&&(a++,delete this.kKg[l])}(0<a||0<b.length)&&za.a.J(38938465,817,50,"FlushDocNotifyTelemetry - normal channel only:{0}, normal channel delay:{1}",a,Ma.a.join(b,","))}FVd(){this.IRi()}wrh(){if(this.YHg&&!this.hc.AK)za.a.J(41501460,801,50,"StartServerRtcConnection: Do not start server RTC in readonly mode");
else{var a=lb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=xg.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StartRtcConnection&source=Browser",this.Ha.podsWebServiceBase),f=Object.assign(new YJ,{BaseDocQueryStringWithoutVersion:u.AFrameworkApplication.$g,SerializedUser:this.Ha.serializedBaseUser,SessionID:a}),l={};l.PodSID=a;l["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;l["X-CorrelationID"]=b;a=md.c(f);u.AFrameworkApplication.Be.wY(c,2,
a,l,[dg.a.l4],0,w=>{this.AAg(50,String.format("EnqueueTime:{0}; InvokedTime:{1}; CompletedTime: {2}; ResponseData:{3}",w.data.JH,w.data.wt,w.data.Eu,w.data.je))},w=>{const F=lb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");this.AAg(10,F.Vha(w))},null,void 0,void 0,void 0,void 0,tx.a("3"))}}Prh(){var a=lb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const b=xg.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StopRtcConnection",this.Ha.podsWebServiceBase),
f={};f.PodSID=a;f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;a=Object.assign(new ZJ,{SessionID:a});a=md.c(a);u.AFrameworkApplication.Be.wY(c,2,a,f,[dg.a.l4],0,()=>{za.a.J(38904456,801,50,"StopServerRtcConnection - request succeeded")},l=>{const w=lb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");za.a.J(38904458,801,10,"StopServerRtcConnection -  Failed with status code: {0}",w.Vha(l))},null,void 0,void 0,void 0,void 0,tx.a("9"))}AAg(a,b){za.a.J(39134672,
801,a,"StartServerRtcResult: {0}",b)}z9(){this.wrh()}Wz(a,b){b.S8d&&!this.hc.AK&&(za.a.J(41501463,801,50,"OnUnifiedAppStateChanged: Disconnect from server RTC in readonly mode"),this.Prh())}ZA(){this.Prh()}}Object(e.a)(nD,"CoauthNotificationManager",null,[]);class pK{constructor(a,b){this.BHh=a;this.NXe=b}get coauthoringStartTime(){return this.BHh}get KNf(){return this.NXe}EZk(a){this.NXe=a}}Object(e.a)(pK,"CoauthoringDurationRecord",null,[]);var jQ=d(924);class qK extends Sys.EventArgs{constructor(a,
b,c=!1){super();this.XFf=a;this.Lyg=b;this.SDj=c}}Object(e.a)(qK,"EditorTableChangedEventArgs",Sys.EventArgs,[]);class yz{constructor(a,b,c){this.bla=this.iab=null;this.I9a=[];this.XCg=new ak.a;this.fKg=new ak.a;this.ime=null;this.BEg=!1;this.ame=0;this.QEg=this.jYc=!1;this.f1c="";this.vfh=null;this.minorVersionLimitReached=this.uDh=this.Sug=this.Lgd=this.X0f=!1;this.Kle=null;this.Fzg=!1;this.m4a=0;this.aTc=!1;this.YDa=a;this.Oc=b;this.nXc=0;this.c$a=[];this.Oc.vGd(Object(C.a)(this,this.Lcb,"onPopSessionClosed"));
this.U1j=c}get gC(){return this.iab}set gC(a){this.iab!==a&&(this.iab&&0<this.iab.length&&2===this.nXc&&za.a.J(19163158,804,10,String.format("MyEditorID is changed from {0} to {1}",this.iab,a)),this.iab=a)}get userName(){return this.bla}get K7d(){return this.jYc}set K7d(a){(this.jYc=a)&&!this.QEg&&Mf.Health.instance&&(this.QEg=!0,Mf.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.jYc.toString()))}get Bec(){return this.f1c}set Bec(a){a!==this.f1c&&(this.f1c=a,za.a.J(556799194,804,50,
"CoauthStateCache - PopsHostProtocol:{0}",this.f1c))}get Q2(){return this.Kle}set Q2(a){this.Kle=a;(a=this.U1j.value.instance)?(a.yMd=this.Kle,za.a.J(545338634,804,50,"CoauthStateCache::LockId - renameProps.CoauthLockId: {0}",a.yMd)):za.a.J(545338635,804,50,"CoauthStateCache::LockId - renameProps == null");this.YDa.FCk()}get UY(){const a=[];Array.addRange(a,this.c$a);return a}get mvl(){return this.UY.length?this.UY.length:1}get amIAlone(){return 2!==this.Waa}get Nv(){return this.Fzg}get Waa(){return this.nXc}set Waa(a){this.nXc!==
a&&(za.a.J(8958419,804,50,"Coauth State Changing to: {0}",1===a?"alone":"coauthoring"),this.nXc=a)}get gAa(){return this.XCg.task}get d5c(){return this.fKg.task}get gJc(){return this.ime}set gJc(a){this.ime||(this.ime=a,this.fKg.Ig(a.getTime()))}Fzh(a){let b;({AId:a,leaving:b}=this.vrl(a)).returnValue&&(a=new qK(a,b,!this.aTc),this.eGk(),this.YDa.$Bk(a))}eGk(){const a=[],b=this.UY;for(const c of b)Array.add(a,c.ID)}Zmc(a){const b=this.Waa;2===a&&(this.gJc=new Date);0!==b||this.BEg||(za.a.J(50440395,
804,50,"Set coauthoring start point: {0}",1===a?"alone":"coauthoring"),this.BEg=!0,this.XCg.Ig(1===a?1:0));this.Waa=a;b!==this.Waa&&(this.YDa.MBk(new jQ.a(this.Waa)),this.Nql(this.Waa))}Nql(a){var b=new Date;2===a?(b=new pK(b,new Date(9999,12,31)),Array.add(this.I9a,b)):(a=this.I9a.length,0<a&&this.I9a[a-1].EZk(b))}lAh(a){this.gC=a;za.a.J(23437834,814,50,"App::UpdateMyEditorID; MyClientId: {0}; EditorTableCount: {1}",this.gC,this.UY.length);this.YDa.LBk()}lhb(a){let b;a&&(a=a.toLowerCase());b=null;
for(let c=0;c<this.c$a.length;c++){const f=this.c$a[c];if(a===f.ID){b=f;break}}return{returnValue:!!b,editor:b}}vrl(a){let b,c;const f=[];b=[];c=[];let l=!1;const w=a?a.length:0;for(let F=0;F<w;F++){const S=a[F];S&&S.ID&&(S.ID=S.ID.toLowerCase());let fa;({editor:fa}=this.lhb(S.ID)).returnValue?(l=l||!yz.lIi(S,fa),Array.remove(this.c$a,fa)):(S.ID!==this.iab?Array.add(b,S):this.bla=S.Name,l=!0);Array.add(f,S)}Array.addRange(c,this.c$a);l=l||0<c.length;this.c$a=f;this.ame=Math.max(this.ame,this.c$a.length);
Mf.Health.instance&&Mf.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.ame.toString());return{returnValue:l,AId:b,leaving:c}}IKc(a,b){let c=0;const f=this.I9a.length;if(0<f&&a<this.I9a[f-1].KNf){a=a.getTime();b=b.getTime();for(let l=0;l<f;++l){const w=Math.max(this.I9a[l].coauthoringStartTime.getTime(),a),F=Math.min(this.I9a[l].KNf.getTime(),b);w<F&&(c+=F-w)}}return c}gZg(){this.Sug=!0;this.YDa.aDk()}Lcb(){this.Bec=""}static lIi(a,b){return a.EmailAddress===b.EmailAddress&&a.ColorIndex===
b.ColorIndex&&a.Name===b.Name&&a.ID===b.ID&&a.SIPAddress===b.SIPAddress}}Object(e.a)(yz,"CoauthStateCache",null,[907,908]);var au=d(422);class ql{constructor(){this.KeyRoot=null;this.TimeStamp=0}}Object(e.a)(ql,"KeyRootSubscription",null,[]);class pv{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.va=new sd.a;this.Iac=au.a.empty;this.Vr=[];this.mta=[];this.SEg=this.zge=!1;this.GXc=a;this.iZc=b;this.Xe=c;this.AWc=xa.zbi;this.$ka=f;this.dXc=l;this.sj=w;this.i8j=F.yOd(1E3,Object(C.a)(this,this.SKi,
"ensureVisibleThumbnailsSubscriptionImpl"));this.Oc=S;this.zd=fa;this.Za=xa;Za.iFd(this);this.G4j=pb;this.R8b=Mb;this.OG=!1;this.G4j&&this.Oc.d2h(Object(C.a)(this,this.gfk,"onBackendChanged"));this.Oc.wB(Object(C.a)(this,this.tL,"onSessionClosed"));this.Oc.xB(Object(C.a)(this,this.eo,"onSessionRehydrated"))}Hla(){this.OG=!1;this.dXc.reset();this.zlg()}zlg(){Array.clear(this.Vr);this.Iac=au.a.empty;this.Ijd=this.$ka.sna;this.zd.Kmb(()=>{this.Ijd=this.$ka.sna});const a=new ql;a.KeyRoot=Uf.a.e6f(this.AWc);
a.TimeStamp=0;this.Vr.push(a);var b=new ql;b.KeyRoot=Uf.a.i5g;b.TimeStamp=0;this.Vr.push(b);b=new ql;b.KeyRoot=Uf.a.Qmi;this.Vr.push(b);var c=new ql;c.KeyRoot=Uf.a.ysh;this.Vr.push(c);c=new ql;c.KeyRoot=Uf.a.Z4d;this.Vr.push(c);c=new ql;c.KeyRoot=Uf.a.apg;this.Vr.push(c);c=new ql;c.KeyRoot=Uf.a.RUf;this.Vr.push(c);c=new ql;c.KeyRoot=Uf.a.j1f;this.Vr.push(c);c=new ql;c.KeyRoot=Uf.a.gth;this.Vr.push(c);const f=new ql;f.KeyRoot=Uf.a.wyg;this.Vr.push(f);const l=new ql;l.KeyRoot=Uf.a.Nqj;this.Vr.push(l);
var w=new ql;w.KeyRoot=Uf.a.yOf;this.Vr.push(w);w=new ql;w.KeyRoot=Uf.a.jkg;this.Vr.push(w);w=Object.assign(new ql,{KeyRoot:Uf.a.H1f,TimeStamp:0});this.Vr.push(w);w=new ql;w.KeyRoot=Uf.a.Njg;this.Vr.push(w);this.R8b&&(w=new ql,w.KeyRoot=Uf.a.Yuh,this.Vr.push(w));w=new ql;w.KeyRoot=Uf.a.OEf;this.Vr.push(w);w=new ql;w.KeyRoot=Uf.a.Otg;this.Vr.push(w);w=new ql;w.KeyRoot=Uf.a.oyg;this.Vr.push(w);w=new ql;w.KeyRoot=Uf.a.Q9g;this.Vr.push(w);w=new ql;w.KeyRoot=Uf.a.d3f;this.Vr.push(w);w=new ql;w.KeyRoot=
Uf.a.wDf;this.Vr.push(w);const F=new ql;F.KeyRoot=Uf.a.iUf;this.Vr.push(F);this.GXc.Cjc(this.Vr);this.iZc&&(Array.clear(this.mta),this.mta.push(b),this.mta.push(a),this.mta.push(c),this.mta.push(f),this.mta.push(l),this.mta.push(w),this.Xe.Yz?(this.iZc.Cjc(this.mta),this.zge=!0):this.Xe.Qea?(this.Oc.wGd(Object(C.a)(this,this.LVa,"onPopSessionInitialized")),this.SEg=!0):this.Xe.Aec.task.continueWith(()=>{this.Xe.Yz&&this.iZc.Cjc(this.mta)}))}LVa(){this.zge||(this.iZc.Cjc(this.mta),this.zge=!0)}get Ijd(){return this.Iac}set Ijd(a){au.a.equals(this.Iac,
a)||(au.a.equals(a,au.a.empty)?this.Iac=au.a.empty:this.Iac=au.a.yZb(a.ZY,a.lastIndex),this.i8j.perform())}gfk(a,b){this.OG||(a=b.ook)&&0<a.length&&(za.a.J(23437836,817,50,"CoauthManager::OnBackendChanged - Backend machine id changed from {0} to {1}",a,this.Za.VAc),this.Hla())}tL(){this.OG=!0}eo(){this.Hla()}SKi(){const a=this.Vr;var b=this.dXc;const c=[];var f=null;for(const w of this.Ijd.n7){var l=Uf.a.Hdj(w);f&&f.KeyRoot!==l&&(c.push(f),f=null);f||(f=new ql,f.KeyRoot=l,f.TimeStamp=Number.MAX_VALUE);
if(l=this.$ka.Asb(w))l=b.YLc(Uf.a.B0b(l.sid,l.cid)),f.TimeStamp>l&&(f.TimeStamp=l)}f&&c.push(f);Cg.d(a,Object(C.a)(this,this.yNi,"fNeedResetBrowserKeySubscription"),w=>{w.TimeStamp=0},1);b=Cg.e(a,w=>w.KeyRoot.startsWith(Uf.a.$uh));f=Cg.a(c,b,pv.Kae);Cg.a(b,f,pv.Kae);if(b.length||c.length)Cg.a(a,b,pv.Kae),Array.addRange(a,c),this.GXc.Cjc(a)}yNi(a){return a.KeyRoot.startsWith(Uf.a.e6f(this.AWc))&&!this.sj.gC?(za.a.J(8958421,817,50,"CoauthSubscriptionManager::ResetBrowserKeyIfNeeded; Resetting timestamp of BrowserID Key subscription as clientId has not been received"),
!0):!1}dispose(){this.Oc.aea(Object(C.a)(this,this.tL,"onSessionClosed"));this.Oc.cea(Object(C.a)(this,this.eo,"onSessionRehydrated"));this.SEg&&this.Oc.BDe(Object(C.a)(this,this.LVa,"onPopSessionInitialized"))}static Kae(a,b){return a.KeyRoot===b.KeyRoot}}Object(e.a)(pv,"CoauthSubscriptionManager",null,[906,109,436]);class rK extends Sys.EventArgs{constructor(){super();this.items=null}}Object(e.a)(rK,"ItemsModifiedEventArgs",Sys.EventArgs,[]);class sK{constructor(a,b,c,f,l,w){this.id=xg.a.create();
this.OWc=a;this.Te=b;this.Za=c;this.Ha=l;this.Wd=f;this.HW=w}qmj(a,b){this.HW&&!this.OWc.LV&&this.HW.iGc(a.lX);a&&a.telemetry&&0<a.telemetry.length&&this.Te.nVa(a.telemetry);Kc.a.EE(this.Te,()=>{this.OWc.zZg(this.id,a.result,a.lX,b)})}pmj(a,b,c){if(!this.OWc.LV&&(this.HW&&this.HW.iGc(a.lX),a&&a.error&&this.Ha.pptFailoverInLongPollingFailHandlerEnabled&&a.error.Gm===kf.a.Fh(223))){za.a.J(35497247,801,15,"LongPollingResponseHandler::HandleRequestFailedEventHandler. The server is unable to find PodSessionId:{0}.",
this.Za.podSessionId||"NULL");this.Wd.Mr(Object.assign(new tj.a,{Code:223,Source:6}),c);return}Kc.a.EE(this.Te,()=>{this.OWc.zZg(this.id,null,a.lX,b)})}}Object(e.a)(sK,"LongPollingResponseHandler",null,[]);var kQ=d(854);class oD{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){this.YEa=this.UEa=null;this.hJg=xg.a.nil;this.Xzb=this.jTa=0;this.EDg=[10,100,1E3,1E4];this.VTa=null;this.wW=[];this.a3=Za?"GetPopWacUpdates":"GetUpdates";this.p_=a;this.Za=c;this.Xe=f;this.Oc=l;this.g8=w;this.Wd=F;this.hc=S;this.HW=fa;
this.Oc.wB(Object(C.a)(this,this.tL,"onSessionClosed"));this.Oc.G2a(Object(C.a)(this,this.Fda,"onSessionRehydrating"));this.Oc.xB(Object(C.a)(this,this.eo,"onSessionRehydrated"));this.Xe.Qea&&Za&&(this.Oc.wGd(Object(C.a)(this,this.LVa,"onPopSessionInitialized")),this.Oc.vGd(Object(C.a)(this,this.Lcb,"onPopSessionClosed")));this.$pe=a.yjl;this.S0j=a.SHj;this.bzb=a.N3g;this.gyb=[];b.UPa().iFd(this);this.F7j=xa;this.$Mh=Za;this.Aja=!1;this.Wyb=Za?3E4:6E4}tL(){this.close("SessionClosed")}Fda(){this.VTa&&
this.VTa.Akd()}eo(){this.pHa("SessionRehydrated")}zZg(a,b,c,f){this.UEa=null;const l=+new Date-+this.YEa;if(this.Aja)za.a.J(512360732,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since DocNotifyClient is closed.",this.a3);else if(a.equals(this.hJg))if(this.p_.clientIgnoreClosePopsErrorCodeEnable&&this.LV&&this.Aja)za.a.J(512360730,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since pops is closing.",this.a3);else if(a=this.Xe.eca,f&&f.length&&a!==
f)za.a.J(512360729,801,15,"DocNotifyClient.PerformCall - {0} - Ignore {1} response since PopSessionId is changed. CurrentPopSession:{2}; LastAttemptedEnsureHostSessionId:{3}; RequestPopSession:{4}; RetryAttempts:{5}. Triggering another request in {6}ms.",this.a3,b?"Success":"Failure",this.Za.uk,this.Xe.eca,f,this.Xzb,this.$pe),this.Xzb++,this.Q0f(l,this.Xzb)||this.Jic(this.$pe);else if(this.Xzb=0,b){this.YEa=new Date;this.jTa=0;this.Xe.bbe=this.YEa;this.Xe.abe=f;za.a.J(512360727,801,50,"DocNotifyClient.OnResponseReceived - {0} - Success response. TimeSinceLastServerConnected:{1}, Now:{2}, PopSessionID:{3}",
this.a3,l,Kc.a.Ve(new Date),this.LV?this.Za.uk:"Not Applicable");c=0;f={};for(const w of b.Items)w.TimeStamp>c&&(c=w.TimeStamp),f[w.LastRequestCorrelationID]=w.LastRequestCorrelationID in f?String.format("{0},{1}",f[w.LastRequestCorrelationID].toString(),w.Key):w.Key,Cg.d(this.gyb,F=>w.Key.startsWith(F.KeyRoot),F=>{w.TimeStamp>F.TimeStamp&&(F.TimeStamp=w.TimeStamp)},1);this.Jic(this.$pe);0<Object.keys(f).length&&Kc.a.ik("RequestCorrelationIDsAndKeyRoots",Ik.c(f));c=new Date;Kc.a.EE(Kc.a.Db,()=>{const w=
Object.assign(new rK,{items:b.Items});for(const F of this.wW)try{F(this,w)}catch(S){za.a.J(512360726,801,15,"DocNotifyClient::OnResponseReceived - {0} - Unhandled exception notifying clients {1}, {2}",this.a3,S.toString(),S.stack)}});Kc.a.ik("ProcessItemStartTime",Kc.a.Ve(c));Kc.a.ik("ProcessItemDurationInMS",(+new Date-+c).toString());Kc.a.Db.finish()}else za.a.J(512360728,801,15,"DocNotifyClient.PerformCall - {0} - NULL response, TimeSinceLastServerConnected:{1}, RequestStatus:{2}, HttpStatusCode:{3}, PodSessionId:{4}, PopSessionId:{5}",
this.a3,l,c?c.status:3,c?c.tf:-1,this.Za.podSessionId,this.LV?this.Za.uk:"Not Applicable"),this.Q0f(l,this.jTa)||(f=3<=this.jTa?this.EDg[3]:this.EDg[this.jTa],this.jTa++,this.Jic(f),Kc.a.ik("FailureCountSinceLastSuccess",this.jTa.toString()),Kc.a.ik("NextDelayInMS",f.toString()),c&&(Kc.a.ik("RequestStatus",Vm.a[c.status]),Kc.a.ik("HttpStatus",c.tf.toString()),Kc.a.ik("Duration",(+c.Eu-+c.wt).toString())),Kc.a.Db.finish());else za.a.J(512360731,801,50,"DocNotifyClient.PerformCall - {0} - requestID not matched.",
this.a3)}Q0f(a,b){return this.LV&&(a>=this.bzb||b>this.p_.getHostSessionInfoMaxRetryCount)?(za.a.J(512360725,801,15,"DocNotifyClient.PerformCall - {0} - Failed enough times, for a time long enough. FailureCount:{1}, PopSessionId:{2}, PopSessionInitialized:{3}",this.a3,b,this.Za.uk,this.Xe.Yz),!0):!1}close(a){za.a.J(512360724,801,50,"DocNotifyClient.Close - {0} - Reason: {1}",this.a3,a);this.Aja=!0;this.VTa&&this.VTa.Akd()}Jic(a){const b=Kc.a.Nm(this.a3,2);b.Ya("DelayInMS",a.toString());this.S0j?Kc.a.W9(()=>
{Kc.a.EE(b,Object(C.a)(this,this.h3g,"performCall"))},a,0):window.setTimeout(()=>{Kc.a.EE(b,Object(C.a)(this,this.h3g,"performCall"))},a)}h3g(){if(!this.enabled||u.AFrameworkApplication.Xg||this.UEa&&+new Date-+this.UEa<this.Wyb||this.LV&&!this.hc.AK||this.g8.zSc)za.a.J(512360723,801,50,"DocNotifyClient.PerformCall - {0} - Skipped. Enabled:{1}, IsShuttingDown:{2}, LastCallStartTime:{3}, Now:{4}, PerformCallExpireTimeInMs:{5}, IsNonDismissibleDialogShown:{6}, AppInReadMode:{7}, AppInReadModeAndCanNotEditAnyway:{8}",
this.a3,this.enabled,u.AFrameworkApplication.Xg,this.UEa?Kc.a.Ve(this.UEa):"null",Kc.a.Ve(new Date),this.Wyb,this.g8.zSc,!this.hc.An,!this.hc.AK);else{var a=xg.a.create().toString();za.a.J(512360722,801,50,"DocNotifyClient.PerformCall - {0} - Executed, LastCallStartTime:{1}, Now:{2}, PerformCallExpireTimeInMs:{3}, PopSessionId:{4}, CorrelationId:{5}",this.a3,this.UEa?Kc.a.Ve(this.UEa):"null",Kc.a.Ve(new Date),this.Wyb,this.LV?this.Za.uk:"Not Applicable",a);if(!this.LV){var b=Cg.e(this.gyb,w=>w.KeyRoot===
Uf.a.i5g);b&&b.length&&za.a.J(512360721,801,50,"Getupdates. CurrentTimestamp:{0}",b[0].TimeStamp)}this.UEa=new Date;b=Kc.a.Db;var c=new sK(this,b,this.Za,this.Wd,this.p_,this.LV?null:this.HW);this.hJg=c.id;this.VTa=new kQ.a;var f=this.LV?this.Za.uk:"",l=this.LV?"":this.Za.podSessionId;b.Ya(lh.a.jpb,a);this.F7j(f,this.Za.presentationId.string,this.gyb,w=>{c.qmj(w,f)},w=>{c.pmj(w,f,l)},this.VTa,{["X-CorrelationId"]:a},null,this.Wyb)}}get enabled(){return 0<this.gyb.length&&!this.Aja}get LV(){return this.$Mh}glc(){this.Xe.Qea||
this.Xe.Aec.task.continueWith(()=>{this.xve()})}LVa(){this.pHa("PopSessionInitialized")}Lcb(){this.close("PopsUninitialized")}xve(){this.Xe.Yz?this.pHa("PopSessionInitialized"):this.close("PopsUninitialized");this.glc()}Cjc(a){a||(a=[]);za.a.J(512360719,801,50,"DocNotifyClient.SetSubscriptions - {0} - {1} subscriptions.",this.a3,a.length);for(const b of a);this.gyb=a;this.YEa=new Date;this.Xzb=this.jTa=0;this.LV&&!this.Xe.Qea&&this.glc();this.Jic(0)}gCf(a){Array.add(this.wW,a)}Hla(){this.pHa("AppListener:OnReboot")}pHa(a){za.a.J(512360718,
801,50,"DocNotifyClient.Reboot - {0} - Reason: {1}, PopSession: {2}",this.a3,a,this.LV?this.Za.uk:"Not Applicable");this.LV&&"PopSessionInitialized"===a&&this.rRk();this.Aja=!1;this.UEa=null;this.YEa=new Date;this.Xzb=this.jTa=0;this.VTa&&this.VTa.Akd();this.Jic(0)}rRk(){for(const a of this.gyb)a.TimeStamp=0}dispose(){this.Oc.aea(Object(C.a)(this,this.tL,"onSessionClosed"));this.Oc.EDe(Object(C.a)(this,this.Fda,"onSessionRehydrating"));this.Oc.cea(Object(C.a)(this,this.eo,"onSessionRehydrated"));
this.LV&&this.Xe.Qea&&(this.Oc.Zbh(Object(C.a)(this,this.Lcb,"onPopSessionClosed")),this.Oc.BDe(Object(C.a)(this,this.LVa,"onPopSessionInitialized")))}}Object(e.a)(oD,"DocNotifyClient",null,[500,109,501,436]);class pD{constructor(){this.NUc=0}}Object(e.a)(pD,"TimeStampData",null,[]);class tK{constructor(){this.cEa={}}reset(){this.cEa={}}copy(a){this.reset();a=a.cEa;for(let f in a){var b=f,c=a[f];const l=new pD;l.NUc=c.NUc;this.cEa[b]=l}}WRe(a,b){var c=a in this.cEa?this.cEa[a]:new pD;this.cEa[a]=
c;c=this.cEa;for(let l in c){var f=c[l];l.startsWith(a)&&(f.NUc=b)}}YLc(a){return a in this.cEa?this.cEa[a].NUc:0}}Object(e.a)(tK,"HermesContentTimeStampManager",null,[502]);var zx=d(364);class Ax{constructor(a,b,c,f=null){this.a9d=a;this.qda=b;this.Lbc=c;this.Ca=f}}Object(e.a)(Ax,"SlideMoveData",null,[]);var lQ=d(633),Dj=d(363);class uK{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc){this.k7b=this.dta=null;this.MS=0;this.dF=null;this.Eie=0;this.PWc=null;this.oje=this.z_c=this.XGg=this.ZGg=0;this.pN=
this.NFa=this.lW=null;this.Oka=this.H_c=0;this.Sp=a;this.Ga=b;this.ia=c;this.Wb=f;this.ua=l;this.yt=w;this.qc=F;this.hc=S;this.At=fa;this.h_=this.Sp.cX;this.O$a=xa;this.sa=Za;this.kq=pb;this.Op=Mb;this.Gsa=hc}Kuj(){this.MS=-1;this.dta=document.createElement("div");this.dta.style.visibility=Fe.a.Qs;this.dta.className=Dj.a.fHi;this.h_.appendChild(this.dta);this.Eie=this.Oka=this.H_c=0;if(this.Gsa){this.k7b=document.createElement("div");this.k7b.className=Dj.a.ngj;const a=document.createElement("span");
a.className=Dj.a.ogj;this.k7b.appendChild(a)}}dispose(){this.h_.removeChild(this.dta);this.yt.cE(this.h_,this);this.dta=this.dF=null}Tu(a){return a?this.fI(a).returnValue:!1}fI(a){var b=null;if(3===a.Qf||a.Sz!==Sys.UI.MouseButton.leftButton||!this.h_.contains(a.Hc)||!this.hc.An)return{returnValue:!1,aqb:b,A2:null};var c=a.clientPoint.y-this.PPe+this.h_.scrollTop;b=a.clientPoint.x-this.h_.offsetLeft;this.At&&(b-=this.h_.offsetWidth-this.h_.clientWidth);b=this.Fdj(b,c);if(!b||!b.GV)return{returnValue:!1,
aqb:b,A2:null};if(this.Gsa){a=this.sa.rf();if(1>a.length)return{returnValue:!1,aqb:b,A2:null};for(var f of a)if(f.zK||32!==this.ia.Ma(aa.a.WAe,1,f.Cb))return{returnValue:!1,aqb:b,A2:null};f=this.Sp.n0-this.sa.rf().length+1;this.XGg=Math.min(this.t6f(c),f);this.ZGg=Math.min(b.slideIndex,f-1)}else if(c=b.slideId,Rd.a.DA(c)||32!==this.ia.Ma(aa.a.WAe,1,c))return{returnValue:!1,aqb:b,A2:null};return{returnValue:!0,aqb:b,A2:null}}pu(a){if(!a)return!1;this.dta||this.Kuj();this.PWc=lQ.a(0,0);if(!({aqb:this.lW,
A2:F}=this.fI(a)).returnValue)return!1;if(this.Op){var b=!1,c=this.lW.slideId,f=this.sa.rf();for(var l of f)if(l.Cb.equals(c)){b=!0;break}if(b){if(this.pN=this.ua.Ca,1<f.length&&!this.Gsa)return!1}else this.sa.Rh(),this.pN=this.lW.Ud,this.sa.tX(this.lW.Ud)}if(this.Gsa){this.bBh();var w=this.lW.c2b;var F=w.cloneNode(!0);b=F.getElementsByTagName("img")[0];this.wjh(b,Dj.a.Y1d,Dj.a.X1d,Dj.a.S2f,Dj.a.S2f);F.className=Dj.a.jfg;c=this.sa.rf();f=1;if(1<c.length){for(l=0;l<c.length;l++)if(this.lW.slideIndex!==
c[l].slideIndex){f++;w=this.Sp.s2(c[l].slideIndex).c2b;w=(w=w.getElementsByTagName("img"))&&0<w.length?w[0].cloneNode(!0):b.cloneNode(!0);const S=Dj.a.X1d*f;this.wjh(w,Dj.a.Y1d-f,Dj.a.X1d-1,S,S);F.appendChild(w);if(3===f)break}F.appendChild(this.k7b);this.k7b.firstChild.innerText=this.sa.rf().length.toString()}this.dF?this.Sp.cX.replaceChild(F,this.dF):this.Sp.cX.appendChild(F);this.dF=F}else b=this.lW.c2b,this.dF?(b=this.dF.getElementsByTagName("img"),F=F.cloneNode(!0),F.style.zIndex=String(Dj.a.Y1d),
this.dF.replaceChild(F,b[0]),this.dF.style.zIndex=String(Dj.a.lgj)):(this.dF=b.cloneNode(!0),this.Sp.cX.appendChild(this.dF),this.dF.className=Dj.a.jfg);this.Eie=parseInt($g.a.Nu(this.dF).height);Ne.a.Gma(this.dF,Dj.a.F1g+Dj.a.b1g+Dj.a.Klg,this.At);this.dF.style.visibility=Fe.a.Ty;this.dF.style.cursor=Fe.a.$kc;u.AFrameworkApplication.Pj("Microsoft.Office.Server.Powerpoint.Web.IPptSlideReorderingImprovementSettings");za.a.J(24784910,819,50,"PPT drag slide start.");this.Xv(a);return!0}bBh(){this.z_c=
this.XGg;this.oje=this.ZGg;let a=0;for(let b=0;b<this.Sp.n0;b++){const c=this.Sp.s2(b);c.isSelected?c.Wld(-2):(a===this.lW.slideIndex&&(a+=1),c.Wld(a),a++)}}wjh(a,b,c,f,l){a.className=Dj.a.kgj;a.style.zIndex=String(b);a.style.borderWidth=c.toString()+"px";a.style.top=f.toString()+"px";a.style.left=l.toString()+"px"}Xv(a){if(!a)return!1;var b=a.clientPoint,c=b.y-this.PPe+this.h_.scrollTop,f=this.Eie/2;if(this.O$a){if(r.a.uS&&!a.nc.rawEvent.buttons)return za.a.J(25216769,819,50,"PPT cancel drag slide in IE/Edge because release mouse button outside of the browser window."),
!1;this.dF.style.top=Math.min(c-f,this.Gsa?zx.a.c5+(this.Sp.n0-this.sa.rf().length)*this.Sp.RAa:zx.a.c5+this.Sp.n0*this.Sp.RAa)+"px"}else{a=this.K0b(this.Sp.n0)+this.Sp.RAa/2;if(this.ANi(b.x)||c>a)return this.akh(),!0;this.dF.style.top=c-f+"px"}this.vjh(!0);this.Yii(b.y);this.b_k(Math.min(this.t6f(c),this.Gsa?this.Sp.n0-this.sa.rf().length+1:this.Sp.n0));this.dta.style.visibility=this.WSc(b)&&!this.Gsa?Fe.a.Ty:Fe.a.Qs;if(this.Gsa&&0<=this.MS)if(this.WSc(b)){this.dF.style.visibility=Fe.a.Ty;if(this.z_c===
this.MS)return!0;b=this.z_c<this.MS?0>this.MS-1?0:this.MS-1:0>this.MS?0:this.MS;c=0;for(f=0;f<this.Sp.n0;f++)a=this.Sp.s2(f),a.isSelected||(c<b?a.Wld(c):a.Wld(c+1),c++);this.z_c=this.MS;this.oje=b}else this.bBh(),this.dF.style.visibility=Fe.a.Qs;return!0}In(a){if(!this.ua.presentation)throw Error.argumentNull("Presentation is null");var b=a.clientPoint;if(this.Gsa){if(a=this.sa.rf(),0<a.length&&0<=this.MS&&this.WSc(b)){b=[];for(const c of a)c&&b.push(Object(ua.a)(131,c));this.sjl(b,this.ebj(this.oje));
za.a.J(33621251,819,50,"PPT drag slide succeed.")}}else 0<=this.MS&&this.lW&&this.WSc(b)&&this.lW.slideIndex!==this.MS&&this.lW.slideIndex+1!==this.MS&&(this.njl(this.lW.slideIndex,this.MS),za.a.J(24784912,819,50,"PPT drag slide succeed."));this.ZJ()}ebj(a){let b=0;for(let c=0;c<this.Sp.n0;c++)if(!this.Sp.s2(c).isSelected&&(b++,a===b))return c+1;return 0}WSc(a){a=a.x>=this.h_.offsetLeft&&a.x<=this.h_.offsetLeft+this.h_.offsetWidth;return!this.O$a||a}Jt(){this.ZJ()}Fdj(a,b){if(!this.Sp.RAa)return null;
var c=Math.floor((b-zx.a.c5)/this.Sp.RAa);if(0<=c&&c<=this.Sp.n0-1){c=this.Sp.s2(c);if(!c)return null;const f=c.YHb;a=this.At?a-parseInt(f.style.right.replace("px","")):a-parseInt(f.style.left.replace("px",""));b-=parseInt(f.style.top.replace("px",""));if(0<=a&&0<=b&&a<=f.clientWidth&&b<=f.clientHeight)return c}return null}ANi(a){return this.At?this.PWc.width-Dj.a.sXf>a||this.PWc.width<a:0>a||Dj.a.sXf<a}Yii(a){const b=a-this.PPe,c=this.PWc.height;if(Dj.a.FGf>b)this.Oka=-Dj.a.EGf;else if(Dj.a.HGf>
b)this.Oka=-Dj.a.GGf;else if(Dj.a.JGf>b)this.Oka=-Dj.a.IGf;else if(c-Dj.a.FGf<a)this.Oka=Dj.a.EGf;else if(c-Dj.a.HGf<a)this.Oka=Dj.a.GGf;else if(c-Dj.a.JGf<a)this.Oka=Dj.a.IGf;else{this.Oka=0;return}this.g3g()}g3g(){if(0!==this.Oka){const a=this.H_c,b=(new Date).getTime();0<a&&(this.h_.scrollTop=Math.max(0,this.h_.scrollTop+Math.floor((b-a)*this.Oka/1E3)));this.H_c=b;window.setTimeout(Object(C.a)(this,this.g3g,"performAutoScrolling"),Dj.a.s$h)}else this.H_c=0}K0b(a){return this.Sp.RAa*a+zx.a.c5*(this.O$a?
.75:1)}t6f(a){a+=this.Sp.RAa/2;a-=zx.a.c5;a=Math.floor(a/this.Sp.RAa);return this.O$a?Math.max(0,a):a}b_k(a){this.MS!==a&&(this.MS=a,0>this.MS||(this.dta.style.top=Ne.a.Nc(this.K0b(a))))}akh(){this.vjh(!1)}vjh(a){this.dF.style.cursor=a?Fe.a.$kc:Fe.a.qfl}njl(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");if((this.NFa=Ma.a.clone(this.ua.presentation.NL))&&!(b>this.NFa.length||a>=this.NFa.length)){var f=null;a=c.D0d(a);b&&(f=c.D0d(b-1));b=new Ax(!1,[a],f);this.ia.Ma(aa.a.Rbc,
2,b)}}sjl(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");!(this.NFa=Ma.a.clone(this.ua.presentation.NL))||b>this.NFa.length||!this.MGj(a,b)||(b=b?c.D0d(b-1):null,a=new Ax(!1,a,b,this.pN),this.ia.Ma(aa.a.Rbc,2,a))}MGj(a,b){const c=Object.assign(new Ua.a,{});for(var f=0;f<a.length;f++)c.add(a[f].slideIndex);c.Sc((l,w)=>l-w);a=c.count;for(f=0;f<a-1;f++)if(1!==c.ga(f+1)-c.ga(f))return!0;return c.ga(0)<=b&&c.ga(a-1)+1>=b?!1:!0}ZJ(){this.fql();this.akh();this.dF.style.visibility=
Fe.a.Qs;this.dF.style.top="0px";this.dF.style.cursor=Fe.a.cA;this.dta.style.visibility=Fe.a.Qs;if(this.Gsa){const a=this.kq.ie(3);try{const b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a.hd(b);a.lIa(this.Sp.Na);const c=b.slides||[];for(const f of c){const l=Object(ua.a)(132,f);l&&l.anchor.Mj(this.Sp.Na,16)}}finally{a&&a.dispose()}this.Sp.Meb()}this.Oka=0;this.lW&&(this.lW=null);this.Ga.ye&&this.Ga.ye.name===Xd.a.ZD||this.Ga.vf(Xd.a.ZD)}fql(){this.Op?this.pN&&(this.Wb.Ca=
this.qc.Bk(this.pN.Cb)):this.lW&&(this.Wb.Ca=this.lW.Ud)}get PPe(){let a=this.h_,b=0;for(;a;)b+=a.offsetTop,a=a.offsetParent;return b}}Object(e.a)(uK,"ThumbnailNavPaneDragAdapter",null,[510,223,109]);class qD{}qD.sXh=[aa.a.print,aa.a.find,aa.a.u4,aa.a.E4a,aa.a.q$c,aa.a.p$c,aa.a.bringForward,aa.a.bringToFront,aa.a.sendBackward,aa.a.sendToBack,aa.a.aha,aa.a.Jjd,aa.a.Kjd,aa.a.FYa,aa.a.EYa,aa.a.Ugb,aa.a.Tgb,aa.a.aYa,aa.a.WGb,aa.a.LIb,aa.a.Nic,aa.a.sea,aa.a.h0,aa.a.H7a,aa.a.$fb,aa.a.agb,aa.a.bgb,aa.a.cgb,
aa.a.cic,aa.a.dic,aa.a.eic,aa.a.fic,aa.a.Qdd,aa.a.tic,aa.a.nFe,aa.a.Rdd,aa.a.B3a,aa.a.y5a,aa.a.Lha,aa.a.FXa,aa.a.GXa,aa.a.HXa,aa.a.Pjc,aa.a.sGb,aa.a.WFb,aa.a.pGb,aa.a.vfb,aa.a.Ifb,aa.a.LM,aa.a.YR,aa.a.pla,aa.a.mcb,aa.a.jcb,aa.a.lcb,aa.a.kcb,aa.a.Adb,aa.a.zdb,aa.a.pck,aa.a.Dxk,aa.a.eni,aa.a.fni,aa.a.Wre,aa.a.Xre,aa.a.Yre,aa.a.Zre,aa.a.Ank,aa.a.Lni,aa.a.deleteComment,aa.a.ytb,aa.a.kQc,aa.a.LPk,aa.a.qck,aa.a.Exk,aa.a.bmc,aa.a.Wlc,aa.a.Ylc,aa.a.Xlc,aa.a.amc,aa.a.$lc];Object(e.a)(qD,"ActionHandledList",
null,[]);class Ps{constructor(a,b,c,f){this.q_=new Al.a;this.Loe=new Al.a;this.ia=a;this.Ha=b;this.sa=c;this.ph=f;this.muj();this.nuj()}Mjj(a,b,c=null){this.Ha.remapShapeEditCommandEnabled&&((this.sa.rG()||this.sa.hu())&&this.q_.Kb(a)?a=this.q_.ga(a):this.sa.jD()&&this.Loe.Kb(a)&&(a=this.Loe.ga(a)));if(this.Ha.podsTableRTTEnabled&&this.Ha.podsTableCellLockEnabled&&Array.contains(Ps.bUk,a)&&(this.sa.E7()||this.sa.wGj()))return 32;if(!Array.contains(qD.sXh,a))return this.ia.Ma(a,2,b,c);const f=this.ia.$p,
l=this.ia.pS;let w=this.ia.Ma(a,1,b);32===w&&(this.Ha.pptDragCancelFix&&(this.ia.$p=f,this.ia.pS=l),w=this.ia.Ma(a,2,b,c));return w}y6k(a){return this.ph.Aqb!==a&&this.ph.Bqb!==a}Rqb(a,b,c){return b&&b.name===Xd.a.sg&&!this.sa.hu()&&1===this.sa.he().length&&this.sa.jD()&&this.y6k(c)?a.Rqb(a.Bc(b.parent),c):a.Rqb(b,c)}muj(){this.q_.$(D.a.upArrow,aa.a.cgb);this.q_.$(D.a.downArrow,aa.a.$fb);this.q_.$(D.a.leftArrow,aa.a.agb);this.q_.$(D.a.rightArrow,aa.a.bgb);this.q_.$(D.a.uGb,aa.a.fic);this.q_.$(D.a.Kfb,
aa.a.cic);this.q_.$(D.a.PXa,aa.a.dic);this.q_.$(D.a.QXa,aa.a.eic);this.q_.$(D.a.Dqa,aa.a.Nic);this.q_.$(D.a.sVa,aa.a.Ugb);this.q_.$(D.a.rVa,aa.a.Tgb);this.q_.$(aa.a.aha,aa.a.wTb);for(const a of Ps.tUk)this.q_.$(a,G.a.ze)}nuj(){for(const a of Ps.uUk)this.Loe.$(a,G.a.ze)}}Ps.tUk=[D.a.xAa,D.a.yAa,D.a.zWb,D.a.wpb,D.a.XNa,D.a.YNa,D.a.c4a,D.a.WNa,D.a.icb,D.a.VOa,D.a.V4a,D.a.hcb,D.a.UOa,D.a.U4a];Ps.uUk=[aa.a.E4a,aa.a.y5a,aa.a.Lha,aa.a.LIb];Ps.bUk=[D.a.backspace,D.a.dK,aa.a.B3a];Object(e.a)(Ps,"ProcessInputStrategy",
null,[507]);class vK{get xDc(){return[361033,9175267,13924352,749464,2893476,15559503,11745730,8880899,3750201,748043,12084359,1837941,7632250,9195008,3036814,8288617,9967496,7363328]}}Object(e.a)(vK,"PPTColorTable",null,[499]);var mQ=d(925);class wK{constructor(){this.j2c={}}lYd(a){return a&&a in this.j2c?this.j2c[a]:null}iIf(a,b){a&&b&&a!==b&&(a in this.j2c||(this.j2c[a]=b))}}Object(e.a)(wK,"PresenceEmailConverter",null,[905]);class rD{constructor(){this.epe=new sd.a}Bbd(a){this.epe.raiseEvent("SPC",
a)}H2a(a){this.epe.addHandler("SPC",a)}GDe(a){this.epe.removeHandler("SPC",a)}}Object(e.a)(rD,"PresenceEventSource",null,[902,903,904]);var Bx;(function(a){a[a.appInitInteractivityReady=0]="appInitInteractivityReady";a[a.appInitChromeReady=1]="appInitChromeReady";a[a.B2I=2]="B2I";a[a.fHasTabSwitch=3]="fHasTabSwitch";a[a.presentationIdReady=4]="presentationIdReady";a[a.earlyDownloadEditorTableCount=5]="earlyDownloadEditorTableCount";a[a.earlyDownloadEditorTable=6]="earlyDownloadEditorTable";a[a.firstCoauthoringStatus=
7]="firstCoauthoringStatus";a[a.presenceJsLoadStart=8]="presenceJsLoadStart";a[a.peoplesWellPackageRegister=9]="peoplesWellPackageRegister";a[a.peoplesWellPackageConfig=10]="peoplesWellPackageConfig";a[a.peoplesWellInit=11]="peoplesWellInit";a[a.peoplesWellInited=12]="peoplesWellInited";a[a.peopleWellPageHiddenDuration=13]="peopleWellPageHiddenDuration";a[a.peoplesWellControlViewRefresh=14]="peoplesWellControlViewRefresh";a[a.peoplesWellUpdateTriggered=15]="peoplesWellUpdateTriggered";a[a.peoplesWellUpdateTriggeredAfterChromeReady=
16]="peoplesWellUpdateTriggeredAfterChromeReady";a[a.peoplesWellDisplayed=17]="peoplesWellDisplayed";a[a.jquerySignalRLoadStart=18]="jquerySignalRLoadStart";a[a.jquerySignalRLoadEnd=19]="jquerySignalRLoadEnd";a[a.presence1JsLoadStart=20]="presence1JsLoadStart";a[a.presencePackageRegister=21]="presencePackageRegister";a[a.presencePackageConfigure=22]="presencePackageConfigure";a[a.presencePackageInitInternalStart=23]="presencePackageInitInternalStart";a[a.presencePackageInit=24]="presencePackageInit";
a[a.presencePackageInited=25]="presencePackageInited";a[a.usedEarlyFindSessionResult=26]="usedEarlyFindSessionResult";a[a.startRTCConnection=27]="startRTCConnection";a[a.rtcConnected=28]="rtcConnected";a[a.rehydrationCount=29]="rehydrationCount";a[a.presenceCount=30]="presenceCount";a[a.presenceDisplayed=31]="presenceDisplayed";a[a.presencePageHiddenDuration=32]="presencePageHiddenDuration";a[a.presenceUpdateNotificationReceived=33]="presenceUpdateNotificationReceived";a[a.presenceUpdateProcessed=
34]="presenceUpdateProcessed";a[a.presenceFirstMessageSent=35]="presenceFirstMessageSent";a[a.coauthoringStartTime=36]="coauthoringStartTime";a[a.isSecondUser=37]="isSecondUser";a[a.getFirstPresenceStateUserCount=38]="getFirstPresenceStateUserCount";a[a.receivedCompletePeristentState=39]="receivedCompletePeristentState";a[a.networkConnectivityLoss=40]="networkConnectivityLoss"})(Bx||(Bx={}));Object(e.b)("EntryName",Bx);class xK{constructor(a,b,c,f){this.so=null;this.Cne=this.$0c=0;this.Tke=this.qHg=
this.gke=this.f_c=!1;this.fde=this.gde=this.Rie=this.wde=this.nie=0;this.SWc=this.yge=null;this.p1c=new ak.a;this.lMg=new ak.a;this.vLg=new ak.a;this.lhe=this.qhe=!1;this.P9b=a;this.goe=b;this.sj=c;f.execute(l=>{this.so=l});this.GW={};co.Task.WAA(this.sj.gAa,this.p1c.task,this.lMg.task).continueWith(()=>{try{this.Wih(),this.FHc(this.GW),0<va.a.count(this.GW)&&Z.ULS.sendTraceTag(51242144,814,15,va.a.toJSON(this.GW)),this.qhe=!0}catch(l){Z.ULS.sendTraceTag(51242145,814,10,l.toString())}});co.Task.WAA(this.sj.gAa,
this.vLg.task).continueWith(()=>{try{this.Wih(),this.FHc(this.GW),0<va.a.count(this.GW)&&Z.ULS.sendTraceTag(594879178,814,15,va.a.toJSON(this.GW)),this.lhe=!0}catch(l){Z.ULS.sendTraceTag(594879177,814,10,l.toString())}});this.CXc={};this.uie={}}aKi(a){this.Yyc(a,8,"g_hermesPresenceJS");this.Yyc(a,20,"g_hermesPresence1JS");this.Yyc(a,18,"g_JquerySignalRMergeJS");this.Yyc(a,19,"g_JquerySignalRMergeJSEnd")}Yyc(a,b,c){b=Bx[b];b in a||(c=this.o3i(c),0<c&&this.uga(a,b,c))}o3i(a){a=window[a];return void 0===
a||null===a?-1:a.getTime()}dispose(){this.u3f();this.LRi();this.nyh();this.GW=this.uie=this.CXc=null}kKi(){this.jpa(25)}jKi(){this.jpa(12)}XUj(){this.jpa(15);0<this.appInitChromeReady&&this.jpa(16)}eKi(a){try{this.$0c||(this.$0c=a,this.ai(17,this.$0c),this.ai(13,this.A9f(this.B2I,this.$0c)),this.vLg.VL(!0))}catch(b){Z.ULS.sendTraceTag(594879176,814,10,b.toString())}}ATj(a,b){this.ai(6,a);this.ai(5,b)}fKi(){this.Cne||(this.Cne=Date.now(),this.ai(31,this.Cne),this.u3f())}gKi(){this.jpa(28)}hKi(){this.jpa(27)}iKi(){this.jpa(40)}qqk(a){const b=
[];for(let f in a){var c=a[f];c&&Array.add(b,c.Presence)}return b}lKi(a){a&&(a=this.qqk(a),this.ai(38,a.length),this.ai(37,0<a.length),this.jpa(39));this.lMg.Ig(!0)}RTj(a){try{this.p1c.task.isCompleted||va.a.Xa(a)||(this.jpa(34),this.p1c.VL(!0))}catch(b){Z.ULS.sendTraceTag(51242146,814,10,b.toString())}}STj(a){if(!(va.a.Xa(a)||"presenceUpdateNotificationReceived"in this.GW)){var b=Date.now();this.ai(33,b);this.Rie=this.A9f(this.B2I,b);this.ai(32,this.Rie);this.ai(30,va.a.count(a));this.so&&this.ai(29,
this.so.i1f)}}FNi(){return!this.p1c.task.isCompleted&&(!this.so||!this.so.i1f)&&!this.Rie}QTj(){this.jpa(35);this.sj.gJc&&this.ai(36,this.sj.gJc.getTime())}zKi(){this.goe&&!this.f_c&&(this.f_c=!0,this.goe.NBf(Object(C.a)(this,this.fdc,"onResourceTimingEntriesAvailable")))}fdc(a,b){try{a={};for(let c=0;c<b.entries.length;c++){const f=b.entries[c],l=Jf.a.ema(f.url);!this.gke&&l.endsWith("rtc2/signalr/negotiate")?(this.gke=!0,this.pzc(a,"Negotiate",f.eB)):l.endsWith("rtc2/signalr/connect")?(this.qHg=
!0,this.pzc(a,"Connect",f.eB)):!this.Tke&&l.endsWith("rtc2/signalr/start")?(this.Tke=!0,this.pzc(a,"Start",f.eB)):l.endsWith("rtc2/findsession")&&(this.pzc(a,this.nie.toString()+"_FindSession",f.eB),this.nie++)}if(this.gke||this.qHg||this.Tke||0<this.nie)this.nyh(),this.t3f(a)}catch(c){Z.ULS.sendTraceTag(51242147,814,10,c.toString())}}pzc(a,b,c){this.uga(a,b+"FS",c.fetchStart);this.uga(a,b+"RS",c.responseStart);this.uga(a,b+"RE",c.responseEnd)}nyh(){this.f_c&&(this.f_c=!1,this.goe.Cbh(Object(C.a)(this,
this.fdc,"onResourceTimingEntriesAvailable")))}jpa(a){this.ai(a,Date.now())}ai(a,b){this.TYh(Bx[a],b)}TYh(a,b){this.uga(this.CXc,a,b);this.uga(this.GW,a,b)}uga(a,b,c){b in a||(a[b]=c)}FHc(a){this.aKi(a);this.uga(a,"B2I",this.B2I);null!=this.fHasTabSwitch&&this.uga(a,"fHasTabSwitch",this.fHasTabSwitch);null!=this.SWc&&this.uga(a,"firstCoauthoringStatus",this.SWc);this.appInitInteractivityReady&&this.uga(a,"appInitInteractivityReady",this.appInitInteractivityReady);this.appInitChromeReady&&this.uga(a,
"appInitChromeReady",this.appInitChromeReady)}Wih(){null==this.SWc&&(this.SWc=this.sj.gAa.result)}u3f(){this.t3f({})}t3f(a){try{this.FHc(this.CXc),va.a.forEach(this.CXc,(b,c)=>{b in this.uie||(this.uie[b]=c,a[b]=c)},null),0<va.a.count(a)&&Z.ULS.sendTraceTag(41239941,828,50,va.a.toJSON(a))}catch(b){Z.ULS.sendTraceTag(51242176,814,10,b.toString())}}LRi(){Z.ULS.sendTraceTag(51242177,814,100,"FlushRecords: m_fPresenceUpdateLogged={0}, m_fPeoplesWellDisplayed={1}",this.qhe,this.lhe);if(!this.qhe||!this.lhe)try{this.FHc(this.GW),
0<va.a.count(this.GW)&&Z.ULS.sendTraceTag(51242178,814,50,va.a.toJSON(this.GW))}catch(a){Z.ULS.sendTraceTag(51242179,814,10,a.toString())}}get B2I(){!this.wde&&og.a.instance.qn(Qh.a.contentEditable)&&(this.wde=og.a.instance.Rg(Qh.a.contentEditable));return this.wde}get appInitInteractivityReady(){!this.gde&&og.a.instance.qn("AppInitStatus_interactivityReady")&&(this.gde=og.a.instance.Rg("AppInitStatus_interactivityReady"));return this.gde}get appInitChromeReady(){!this.fde&&og.a.instance.qn("AppInitStatus_chromeReady")&&
(this.fde=og.a.instance.Rg("AppInitStatus_chromeReady"));return this.fde}get fHasTabSwitch(){null==this.yge&&og.a.instance.qn(Qh.a.Bmd)&&(this.yge=og.a.instance.Rg(Qh.a.Bmd));return this.yge}A9f(a,b){return this.P9b?this.P9b.Sag(new Date(a),new Date(b)):-1}}Object(e.a)(xK,"PresencePerfLogger",null,[504,109]);class yK{constructor(a,b,c){this.cNg=this.p7b=this.VXc=this.bla=null;this.Wfe=!1;this.voe=null;this.hi=a;this.p_=b;this.jq=c}ENc(){this.rqb();return this.bla}k0i(){this.rqb();return this.VXc}getFindSessionResponse(){return this.hi?
this.hi.FindSessionResponse:null}w8f(){this.rqb();return this.p7b}V9i(){this.rqb();return this.cNg}T9i(){this.rqb();return this.voe}Lgd(){this.rqb();return this.Wfe}VUj(){if(this.hi){const a=!!this.hi.PresenceException,b=!isNaN(this.hi.PresenceDownloadEditorTableHttpStatus)&&200!==this.hi.PresenceDownloadEditorTableHttpStatus||!isNaN(this.hi.PresenceFindSessionHttpStatus)&&200!==this.hi.PresenceFindSessionHttpStatus,c={};c.EarlyFindSessionEnabled=this.p_.presenceEarlyFindSessionEnabled;c.EditorCount=
this.VXc?this.VXc.length:0;c.ShouldConnectToRtcByDefault=this.Wfe;c.EditorTableHttpStatus=this.hi.PresenceDownloadEditorTableHttpStatus;c.FindSessionHttpStatus=this.hi.PresenceFindSessionHttpStatus;c.CachedException=this.hi.PresenceException;c.IsFindSessionResponseEmpty=!this.hi.FindSessionResponse;c.IsEditorTableResponseEmpty=!this.hi.CoauthHandlerResponse;c.RtcBootTokenContainsValue=!!this.voe;za.a.J(41501202,804,a||b?15:50,va.a.toJSON(c))}}rqb(){if(this.hi&&!this.bla)try{if(this.hi.CoauthHandlerResponse){const a=
Sys.Serialization.JavaScriptSerializer.deserialize(this.hi.CoauthHandlerResponse);this.VXc=a.EditorTable;this.bla=a.UserName;this.p7b=a.Email;this.cNg=a.RtcEndpointUrl;this.Wfe=a.FConnectByDefault;this.voe=a.RtcBootToken;this.jq.gZg()}}catch(a){za.a.J(41501204,804,10,"PresencePrepCacheParser - caught exception when parse cache: "+a)}}}Object(e.a)(yK,"PresencePrepCacheParser",null,[513]);class sD{constructor(a,b,c,f=5E3){if(!a)throw Error.create("RTCParams : ClientId is null");this.clientId=a;this.userSessionId=
u.AFrameworkApplication.userSessionId;this.Xdd=u.AFrameworkApplication.Xdd;this.Laa=u.AFrameworkApplication.Be;this.hw=b;this.uih=c;this.ufh=f}}Object(e.a)(sD,"RtcParams",null,[]);class zK{constructor(a,b,c){this.BWj=a;this.soe=b;this.KVc=c}lli(a,b,c){ya.a.Vt(a);ya.a.Vt(b);ya.a.Vt(c)}RGd(a,b,c,f){return f=!a&&0>b?f+Math.abs(b):this.BWj?(c-b)/4:(c-b)/2}SGd(a,b,c){if(!this.KVc||!b)return c;if(0<=b.className.indexOf(nc.a.RM))if(b.previousSibling)b=b.previousSibling;else return c;const f=this.gNc(b,ca.a.dVc),
l=this.gNc(b,ca.a.xJc);if(isNaN(f)||!f||isNaN(l)||!l||f>=l)return c;const w=new Sys.UI.Bounds(c.x,c.y,c.width,c.height);if(f>=.9*l)return c=(l-f)/2,w.y+=c,w.height-=2*c,w;a=this.Oaj(b,a);if(isNaN(a)||!a)return c;c=(a-f)/2;w.y+=c;w.height-=2*c;return w}vbj(a,b){if(!this.KVc)return 0;a=this.gNc(a,ca.a.dVc);b=Math.ceil((a-b)/2);if(isNaN(b)||0>b)b=0;return b}Oaj(a,b){let c=Object(ua.a)(901,b);b||(c=Object(ua.a)(901,this.soe.R_b(a)));if(c&&this.soe.FBj(c))return this.gNc(a,ca.a.xJc);b=0;const f=a.getClientRects();
f&&0<f.length&&(b=f[0],b=new Sys.UI.Bounds(Math.floor(b.left),Math.floor(b.top),Math.floor(b.width),Math.floor(b.height)),b=this.soe.Jea(b,c,()=>a.offsetWidth/a.offsetHeight).height);return b}gNc(a,b){let c=a;for(a=null;!a&&c&&"P"!==c.tagName;)a=K.a.te(c,b),c=0<=c.className.indexOf(nc.a.q5b)?c.previousSibling:c.parentNode;b=0;a&&(b=parseInt(a.toString(),10));return b}}Object(e.a)(zK,"PptMeasureBoundsUsingSpansStrategy",null,[508]);class tD{constructor(){this.TFa=null}get qbc(){return this.TFa?this.TFa.qbc:
0}get gkc(){return this.TFa?this.TFa.gkc:!1}get Pgd(){return this.TFa?this.TFa.Pgd:!1}FVb(a,b){b&&(this.TFa?this.TFa.FVb(a,b):b(null))}vai(a){this.TFa=a}}Object(e.a)(tD,"PPTProcessImageStrategyProxy",null,[900,389]);class uD{constructor(a,b){this.rQh=a;this.Nff=b}get hpk(){return this.rQh}get Iwe(){return this.Nff}p1k(a){this.Nff=a}}Object(e.a)(uD,"PageHiddenRecord",null,[]);class AK{constructor(){this.vka=[];za.a.J(24440908,801,50,"Init PageHiddenMeter");if(this.qke=window.document.hidden){const a=
new uD(new Date,new Date(9999,12,31));this.vka.push(a)}lb.a.instance.qb("Common.ITaskManager").Hb(new Se.a(4,2,9E5,Object(C.a)(this,this.maintainPageHiddenRecords,"maintainPageHiddenRecords"),90,"2"));$addHandler(window,"visibilitychange",Object(C.a)(this,this.onVisibilityChange,"onVisibilityChange"))}Sag(a,b){const c=this.vka.length;let f=0;if(0<c&&a<this.vka[c-1].Iwe){a=a.getTime();b=b.getTime();for(let l=0;l<c;++l){const w=Math.max(this.vka[l].hpk.getTime(),a),F=Math.min(this.vka[l].Iwe.getTime(),
b);w<F&&(f+=F-w)}}return f}onVisibilityChange(){za.a.J(24440910,801,50,"Page hidden: {0}",window.document.hidden);this.wGk()}wGk(){var a=window.document.hidden,b=new Date;this.qke!==a&&((this.qke=a)?(b=new uD(b,new Date(9999,12,31)),this.vka.push(b)):(a=this.vka.length,0<a&&this.vka[a-1].p1k(b)))}maintainPageHiddenRecords(){const a=new Date;for(;0<this.vka.length&&9E5<+a-+this.vka[0].Iwe;)Array.removeAt(this.vka,0)}}Object(e.a)(AK,"PageHiddenMeter",null,[498]);class vD{x4(a){let b=aa.a.uz(a);return b||
(b=D.a.uz(a))?b:(b=G.a.uz(a))?b:""}}Object(e.a)(vD,"ActionNameResolver",null,[899]);class wD{constructor(){this.va=new sd.a}LBk(){this.va.raiseEvent("CIU",Sys.EventArgs.Empty)}MBk(a){this.va.raiseEvent("CSC",a)}$Bk(a){this.va.raiseEvent("ETC",a)}p9g(a){this.va.raiseEvent("TLSC",a)}aEk(a){this.va.raiseEvent("TCVEL",a)}aDk(){this.va.raiseEvent("PRTCC",null)}FCk(){this.va.raiseEvent("LCK",null)}fGd(a){this.va.addHandler("CSC",a)}nDe(a){this.va.removeHandler("CSC",a)}gGd(a){this.va.addHandler("ETC",a)}Bbh(a){this.va.removeHandler("ETC",
a)}G4h(a){this.va.addHandler("TLSC",a)}zOk(a){this.va.removeHandler("TLSC",a)}z4h(a){this.va.addHandler("TCVEL",a)}A3h(a){this.va.addHandler("PRTCC",a)}$bh(a){this.va.removeHandler("PRTCC",a)}R1h(a){this.va.addHandler("LCK",a)}}Object(e.a)(wD,"CoauthEventSource",null,[896,897,898]);class xD{constructor(){this.va=new sd.a}RDk(){var a=new Sys.EventArgs;this.va.raiseEvent("OnShowHideAltTextPane",a)}qCk(a){this.va.raiseEvent("OnImageDescriptionReady",a)}eCk(a){this.va.raiseEvent("FRHRE",a)}FBk(a){this.va.raiseEvent("APIRE",
a)}xCk(a){this.va.raiseEvent("IMARE",a)}k3h(a){this.va.addHandler("OnShowHideAltTextPane",a)}FNk(a){this.va.removeHandler("OnShowHideAltTextPane",a)}I2h(a){this.va.addHandler("OnImageDescriptionReady",a)}lNk(a){this.va.removeHandler("OnImageDescriptionReady",a)}B2h(a){this.va.addHandler("FRHRE",a)}gNk(a){this.va.removeHandler("FRHRE",a)}b2h(a){this.va.addHandler("APIRE",a)}QMk(a){this.va.removeHandler("APIRE",a)}L2h(a){this.va.addHandler("IMARE",a)}nNk(a){this.va.removeHandler("IMARE",a)}}Object(e.a)(xD,
"CoreExtEventSource",null,[893,894,895]);var BK=d(991);class yD extends BK.a{constructor(a,b,c,f,l,w,F){super(f,c,a,w,F);this.CWc=new Ie.a(0);this.NSa=b;this.Lle=l}buj(a,b){let c;(c=this.CWc).$(b,c.ga(b)+1);this.gZf(a.name,Object(C.a)(this,this.blg,"initPackageCallback"),a)}cuj(a,b){let c;(c=this.CWc).$(b,c.ga(b)+1);this.hZf(a.name,Object(C.a)(this,this.blg,"initPackageCallback"),1,a)}blg(a){a.auj()}loh(a,b){return!!a&&!!b&&a.context.AIf!==b.context.AIf}Jue(a,b){if(b>=this.Lle){const c=new Sys.StringBuilder;
for(let f=0;f<a.length;++f)0<f&&c.append(","),c.append(String.format('{{"N":"{0}","D":{1}}}',a[f].name,sg.a.nX(a[f].duration,0)));Z.ULS.sendTraceTag(39966927,813,50,"{0}:{1}",c.toString(),sg.a.nX(b,0))}}onIdle(a){const b=[];this.CWc.forEach((c,f)=>{0<f&&(b.push(c),this.CWc.$(c,0),this.NSa.CVc(c));return!0});Z.ULS.sendTraceTag(39966928,813,50,"[{0}]:{1}",b.join(","),sg.a.nX(a,0))}}Object(e.a)(yD,"DelayLoadedPackageInitializer",BK.a,[]);class Cx{constructor(a,b,c,f,l,w,F,S,fa){this.Yoe=this.Xoe=null;
this.Ha=a;this.zG=b;this.jq=c;this.sj=f;this.ia=l;this.sI=w;this.Rb=F;this.Qd=fa;this.V5j=S;this.zG.gGd(Object(C.a)(this,this.iYf,"editorTableUpdate"))}dispose(){this.zG.Bbh(Object(C.a)(this,this.iYf,"editorTableUpdate"))}iYf(){const a=this.sj.UY;this.KZf();this.jq.aTc&&(za.a.J(23437899,814,50,"App::EditorTableUpdate; Refresh Peoples well; MyClientId: {0}; new editor table count: {1}",this.sj.gC,a.length),this.ia.processAction(G.a.H3a,2))}KZf(){if(!this.jq.aTc&&this.sj.gC){za.a.J(23437903,814,50,
"App::EnsurePresence; Presence not loaded yet. Ensure presence on editor table update");try{if(!this.Rb)throw Error.create("Presence is being loaded before the app frame");this.Pll()}catch(a){za.a.J(23437906,814,10,"App : EnsurePresence; Exception loading presence: {0}",a)}}}Pll(){za.a.J(41207492,814,50,"App::EnsurePresence: trigger download js");if(this.Ha.Vmc)lb.a.instance.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Bha("pptedit.presence",null,()=>d.e(11).then(d.bind(null,1199)));
else{const a=wx.a.create("pptedit.presence",this.Yxi(),()=>d.e(11).then(d.bind(null,1199)));Oi.a.nt(a)}}Yxi(){this.TLe.yM((a,b)=>{this.V5j.zTc=b.succeeded});return[this.TLe]}get Zal(){this.Yoe||(this.Yoe=this.R$f());return this.Yoe}get TLe(){this.Xoe||(this.Xoe=this.Vyi());return this.Xoe}Vyi(){return this.c5i()}c5i(){return YC.a.create(this.R$f(),null,null,gb.App.awg)}R$f(){return this.Ha.podsUseVersionLessJqueryAndSignalR?this.Qd.efj("jquery.signalr.merge.1.1"+Cx.kKd):u.AFrameworkApplication.Rj("jquery.signalr.merge.1.1",
2)}}Cx.kKd=".min.js";Object(e.a)(Cx,"PresenceLoader",null,[]);class CK{constructor(a,b,c,f,l,w,F,S,fa){this.DEa=this.EEa=!1;this.Lja=this.Bja=null;this.Ha=a;this.Cx=b;this.mW=c;this.Fa=f;this.r$a=l;this.zie=w;this.Bb=F;this.Fx=S;this.yy=fa;this.s8=this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled&&!!window.self.Promise&&this.r$a.rwg}acd(a){if(this.s8&&a&&!a.kl&&a.Pub)if(a.gae)a.gae=!1;else if(this.Fa.GRc(a.shapeNode)){var b=this.Fa.ANc(a.shapeNode);b.length&&(this.yy&&this.yy.isEnabled||this.yy&&this.yy.isEnabled?
(this.Bja=this.Lja=null,this.DEa=this.EEa=!1,this.yy&&this.yy.isEnabled&&this.yy.WR&&(this.yy.I7a(c=>{za.a.J(51217114,801,50,"CustomFontListDownloadAndParseCompleted");this.Lja=c;this.LGc(a,b)}),this.yy.WR.J7a(()=>{za.a.J(51217116,801,15,"CustomFontWebRequestFailed");this.EEa=!0;this.LGc(a,b)})),this.Fx&&this.Fx.isEnabled&&this.Fx.WR&&(this.Fx.I7a(c=>{za.a.J(41521282,801,50,"CloudFontListDownloadAndParseCompleted");this.Bja=c;this.LGc(a,b)}),this.Fx.WR.J7a(()=>{za.a.J(41494535,801,15,"CloudFontWebRequestFailed");
this.DEa=!0;this.LGc(a,b)}))):this.xxh(a,b,null,null))}}VCa(a){return a?!0:!1}LGc(a,b){(this.VCa(this.Bja)&&this.VCa(this.Lja)||this.VCa(this.Bja)&&this.EEa||this.DEa&&this.VCa(this.Lja)||this.DEa&&this.EEa)&&this.xxh(a,b,this.Bja,this.Lja)}xxh(a,b,c,f){a&&!a.kl&&b&&b.length&&(za.a.J(41521286,801,50,"TryRemoveFidelityViewOnEmbeddedFontsLoaded"),Promise.all(this.zie.KCh(b,c,Object(C.a)(this.Fx,this.Fx.createFontUrl,"createFontUrl"),f,Object(C.a)(this.yy,this.yy.createFontUrl,"createFontUrl"),this.mW.VBh,
Object(C.a)(this.mW,this.mW.createFontUrl,"createFontUrl"))).then(()=>{za.a.J(41521288,801,50,"WebFontsLoadCompleted");this.Cx.PCa(()=>{this.Bb.Hb(new Se.a(2,1,0,()=>{a&&!a.kl&&(za.a.J(41494539,801,50,"TriggerDrawByRemoveFidelityViewOnEmbeddedFontsLoaded"),a.POa(),a.gae=!0,a.$D())},90,"109"))})},l=>{za.a.J(41494541,801,10,"WebFontsLoad failed: {0}",l.toString());a&&!a.kl&&a.shapeNode&&(a.shapeNode.JQa=!0)}))}}Object(e.a)(CK,"RemoveShapeFidelityViewForEmbeddedFontController",null,[512]);class DK{constructor(a,
b,c,f,l,w,F,S,fa){this.DEa=this.EEa=!1;this.Lja=this.Bja=null;this.wka=new Ua.a;this.Lsa=a;this.lp=b;this.mW=c;this.Fa=f;this.r$a=l;this.zie=w;this.Bb=F;this.Fx=S;this.yy=fa}dLk(a){window.self.Promise&&this.r$a.rwg?this.Bb.Hb(new Se.a(2,1,0,()=>{try{this.removeFidelityViewOnWebFontsLoaded(a)}catch(b){za.a.J(40429063,801,10,"RemoveFidelityViewOnWebFontsLoaded exception {0}",b),this.wIb(a)}},90,"102")):this.wIb(a)}wIb(a){if(a&&a.length){for(var b of a)b.kl||(b.Pub=!0,b.$D()),this.lp.lkh();b=0;og.a.instance.qn(Qh.a.lP)&&
(b=(new Date).getTime()-og.a.instance.Rg(Qh.a.lP));za.a.J(560837531,801,50,"RemoveFidelityView - MissingFonts: {0}, Total Duration Since Viewable : {1}",this.wka.count,b);if(0<this.wka.count){const c=new Map;c.set("PendingFontsCount",this.wka.count.toString());c.set("FidelityViewDuration",b.toString());Mf.Health.instance.recordQosError("RemoveFidelityViewWithMissingFonts",["MissingFont"],!1,!1,!0,!1,Object.assign(new pk.a,{extendedProperties:c}))}a.length=0;za.a.J(40429065,801,50,"shapeViewElementsDuringBoot draw done")}}removeFidelityViewOnWebFontsLoaded(a){za.a.J(40429067,
801,50,"RemoveFidelityViewOnWebFontsLoadedAndBootComplete");for(var b of a)!b.kl&&b.EA&&b.POa();b=new Date;for(const c of a)if(!c.kl){const f=this.Fa.H6a(c.shapeNode);for(const l of f)this.wka.contains(l)||this.wka.add(l)}za.a.J(40429069,801,50,"GetUnsupportedFontsDuration: {0}",+new Date-+b);if(this.wka.count){if(!this.yy||!this.yy.isEnabled)if(!qd.a("EnableRemoveFidelityCloudServiceCheck")||!this.Fx||!this.Fx.isEnabled){this.Nah(a,this.wka,null,null);return}this.Bja=this.Lja=null;this.DEa=this.EEa=
!1;this.yy&&this.yy.isEnabled&&(this.yy.I7a(c=>{za.a.J(51217157,801,50,"CustomFontListDownloadAndParseCompleted");this.Lja=c;this.MGc(a,this.wka)}),this.yy.WR&&this.yy.WR.J7a(()=>{za.a.J(51217159,801,50,"CustomFontWebRequestFailed");this.EEa=!0;this.MGc(a,this.wka)}));this.Fx&&this.Fx.isEnabled&&(this.Fx.I7a(c=>{za.a.J(40429075,801,50,"CloudFontListDownloadAndParseCompleted");this.Bja=c;this.MGc(a,this.wka)}),this.Fx.WR&&this.Fx.WR.J7a(()=>{za.a.J(40429083,801,50,"CloudFontWebRequestFailed");this.DEa=
!0;this.MGc(a,this.wka)}))}else za.a.J(40429071,801,50,"No unsupported fonts"),this.wIb(a)}VCa(a){return a?!0:!1}MGc(a,b){(this.VCa(this.Bja)&&this.VCa(this.Lja)||this.VCa(this.Bja)&&(this.EEa||qd.a("FidelityCustomServiceDisableCheck")&&!this.yy.isEnabled)||this.DEa&&this.VCa(this.Lja)||this.DEa&&this.EEa)&&this.Nah(a,b,this.Bja,this.Lja)}Nah(a,b,c,f){b&&b.count?(za.a.J(41521300,801,50,"RemoveFidelityViewOnWebFontsLoadedInternal"),Promise.all(this.zie.KCh(b.toArray(),c,Object(C.a)(this.Fx,this.Fx.createFontUrl,
"createFontUrl"),f,Object(C.a)(this.yy,this.yy.createFontUrl,"createFontUrl"),this.mW.VBh,Object(C.a)(this.mW,this.mW.createFontUrl,"createFontUrl"))).then(l=>{za.a.J(40429079,801,50,"WebFontsLoadCompleted");if(l)for(let w=0;w<l.length;w++)if(l[w])for(let F=0;F<l[w].length;F++)if(l[w][F]){za.a.J(40429081,801,50,"Status {0}",l[w][F].status);const S=l[w][F].family;Ja.a.Xa(S)||l[w][F].status!==Wj.loaded||-1===S.lastIndexOf("_")||b.remove(S.substring(0,S.lastIndexOf("_")))}this.wIb(a)},l=>{za.a.J(41521304,
801,10,"WebFontsLoad failed: {0}",l.toString());this.Bb.Hb(new Se.a(2,1,this.Lsa.pptWaitForWebFontsLoadingTimeoutMs,()=>{za.a.J(40429073,801,50,"Check removing Fidelity View");this.wIb(a)},90,"103"))})):this.wIb(a)}}Object(e.a)(DK,"RemoveShapeFidelityViewOnBootController",null,[511]);class EK{constructor(a){this.ia=a}Hal(){this.xph(ResourceStrings.l_SessionTimeoutErrorMessage)}Ial(){this.xph(ResourceStrings.l_SessionTimeoutErrorMessageForCommentDraft)}xph(a){const b=new hf.StandardDialog;b.vd=4;b.kg=
"PPTTimeoutDialog";b.Pe(1,ResourceStrings.L_Refresh);b.Pe(2,ResourceStrings.L_Close);b.nO(ResourceStrings.l_GenericDialogTitle,a,Object(C.a)(this,this.BYk,"sessionTimeoutDialogHandler"))}BYk(a,b){1===a?(za.a.J(24261827,801,50,"Button={0};DontShowAgain={1}",a,b),this.v7k()?(za.a.J(24655755,801,50,"Session Token is expired or about to expire, refresh the page."),this.ia.processAction(aa.a.refreshPage,2)):this.ia.Ma(aa.a.refresh,2,{refreshtrigger:"SessionTimeoutIndicator::SessionTimeoutDialogHandler"})):
(za.a.J(24261829,801,50,"Button={0};DontShowAgain={1}",a,b),this.ia.processAction(aa.a.Yqb,2))}v7k(){const a=u.AFrameworkApplication.Kl,b=u.AFrameworkApplication.qga;return 0<a&&(new Date).getTime()>=a-1E3*b}}Object(e.a)(EK,"SessionTimeoutIndicator",null,[505]);class FK{constructor(){this.l_c=!1;this.rLg=[]}get zTc(){return this.l_c}set zTc(a){if(!this.l_c&&(this.l_c=a)){for(const b of this.rLg)b();Array.clear(this.rLg)}}}Object(e.a)(FK,"SignalRLoadCompletedListener",null,[506]);class zz{constructor(a,
b,c,f,l,w){this.iOg=this.BIg=!1;this.gda=this.ipe=null;this.uKg=this.Rke=!1;this.jOg=this.kOg=this.ZKg=this.$Kg=0;this.ia=a;this.oYj=b;this.pp=f;this.vpe=w;this.Xc=l;this.Xc.RBf(Object(C.a)(this,this.Mik,"onLazySorterViewActorActionRegistrationHandler"))}wb(){this.ia.ya(aa.a.ZXa,Db.a.application,Object(C.a)(this,this.xal,"showStatusBarSorterView"));this.ia.ya(aa.a.kDc,Db.a.application,Object(C.a)(this,this.Jmi,"closeStatusBarSorterView"))}xal(a,b,c,f,l){if(2!==c)return 32;if(this.Rke)return this.vpe.instance.ZXa(a,
b,c,f,l);this.Xc.RBf(Object(C.a)(this,this.Fqh,"sorterViewEventHandler"));this.ZRj();this.BIg||(this.Jbe(),this.uKg=!0);return 32}Jmi(a,b,c,f,l){if(2!==c)return 32;this.Xc.JMk(Object(C.a)(this,this.Fqh,"sorterViewEventHandler"));(this.gda=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.gda);return this.Rke?this.vpe.instance.kDc(a,b,c,f,l):32}Jbe(){this.iOg||(this.iOg=!0,this.ipe=this.YRj(),this.ipe.yM(Object(C.a)(this,this.$lk,
"onSlideSorterGridLoaded")),Oi.a.nt(this.ipe),this.$Kg=Date.now())}$lk(){this.BIg=!0;this.pp&&this.pp.L_("SlideSoterGridDownloadFinished");this.ZKg=Date.now();const a=og.a.instance;a&&(a.jc("SlideSorterOnDemandLoad",this.uKg),a.jc("SlideSorterPkgST",this.$Kg),a.jc("SlideSorterPkgET",this.ZKg))}ZRj(){this.ia.processAction(aa.a.XUb,2);this.gda=Ne.a.De();this.gda.id="SlideSorterViewLoadingElementId";this.gda.className="sorterview-ui-loading-element-class";const a=Ne.a.De();a.className="sorterview-ui-loading-textmessage-class";
a.innerText=ResourceStrings.l_SorterViewLoadingTextMessage;const b=Ne.a.De();b.className="sorterview-ui-loading-spinner-class";const c=Ne.a.De();c.className="sorterview-ui-loading-spinner-inner-class";b.appendChild(c);this.gda.appendChild(b);this.gda.appendChild(a);document.getElementById("WACDocumentPanel").appendChild(this.gda);this.kOg=Date.now()}Fqh(){(this.gda=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.gda);this.jOg=
Date.now();this.vpe.instance.ZXa(aa.a.ZXa,null,2,null,null);const a=og.a.instance;a&&(a.jc("SlideSorterLoadingExpST",this.kOg),a.jc("SlideSorterLoadingExpET",this.jOg))}Mik(){this.Rke=!0}YRj(){var a=u.AFrameworkApplication.Rj("slidegrid"+zz.kKd,5);a=this.oYj.gWb(a);return wx.a.create("pptedit.sorterGrid",[a],()=>d.e(14).then(d.bind(null,1201)))}dispose(){}}zz.kKd=".min.js";Object(e.a)(zz,"SorterViewActorMain",null,[109,514]);class qv{constructor(a){this.ief=a}onBlur(a,b){this.fce("OnBlur",a,b);(a=
oa.InteractiveViewManager.instance.Jd)&&v.FocusManager.ZL()&&a.endEditing(!1,20)}setFocus(a,b){this.fce("SetFocus",a,b);const c=this.ief();c&&!c.isActive&&(a.name!==E.AppFrame.Ipj&&a.name!==E.AppFrame.kSi||b.name!==y.AFrame.gV||(c.Tgd=!1),c.RKi())}onFocus(a,b){this.fce("OnFocus",a,b);if(v.FocusManager.ZL()&&(b=this.ief())&&b.isActive){var c=!!b.editingView;a=a?a.name:"";r.a.Ji&&(a.startsWith(Xh.a.fXb)&&(ee.GrippersManager.instance.E1b=!0),a.startsWith(Xh.a.fXb)||a===y.AFrame.fcb||a===y.AFrame.bth)&&
(c=!1);c&&this.QKi(b,a)}}QKi(a,b){const c=a.editingView,f=v.FocusManager.instance();f.S4d=!0;a.PQ();1===c.mode&&3!==u.AFrameworkApplication.Va.mode&&b===y.AFrame.fcb&&(a.Eb.ana.dWd(),c.Peb());f.S4d=!1}fce(a,b,c){a=String.format("InteractiveViewFocusScopeActions.{0} called. (Scope is moving from '{1}' to '{2}')",a,b?b.name:null,c?c.name:null);Im.a.instance.Ov&&Z.ULS.sendTraceTag(38293642,321,15,String.format("{0} {1}","Handling focus/blur events while TaskManager.Instance.IsYielding!",a))}static YOf(a){const b=
new qv(()=>a),c=a.NH,f=v.FocusManager.instance();f.Bc(c).wza(Object(C.a)(b,b.onBlur,"onBlur"));f.Bc(c).xaa(Object(C.a)(b,b.setFocus,"setFocus"));f.Bc(c).vaa(Object(C.a)(b,b.onFocus,"onFocus"))}}Object(e.a)(qv,"InteractiveViewFocusScopeActions",null,[]);class zD extends qv{constructor(a){super(()=>a);this.Pb=a}npk(){this.Pb.isActive||this.Pb.vKi()}static Nqi(a,b){const c=new zD(a);a=a.NH;b.Bc(a).wza(Object(C.a)(c,c.onBlur,"onBlur"));b.Bc(a).xaa(Object(C.a)(c,c.npk,"pageViewSetFocus"));b.Bc(a).vaa(Object(C.a)(c,
c.onFocus,"onFocus"))}}Object(e.a)(zD,"PageViewInteractiveViewFocusScopeActions",qv,[]);class Az{constructor(){this.Ha=this.K=null;this.oIg=!1}get name(){return"PowerPointWebEditor.CoreExt"}Yb(a){this.K=a;this.Ha=a.resolve("PowerPointWebEditor.IApplicationSettings");this.Ha.Ypg&&a.register(498,"PowerPointWebEditor.IPageHiddenMeter").ma().na(()=>new AK);Az.jqi(this.K);a.register(wD,"PowerPointWebEditor.CoreExt.CoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventNotifier").as("PowerPointWebEditor.CoreExt.ICoauthEventHandler").ma().na(()=>
new wD);a.register(xD,"PowerPointWebEditor.CoreExt.CoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier").as("PowerPointWebEditor.CoreExt.ICoreExtEventHandler").ma().na(()=>new xD);a.register(499,"Common.IColorTable").ma().na(()=>new vK);a.register(yz,"PowerPointWebEditor.CoauthStateCache").as("PowerPointWebEditor.ICoauthStateGetter").as("PowerPointWebEditor.ICoauthStateSetter").ma().na(()=>new yz(a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),new sc.a(()=>lb.a.instance.Oa("Common.IRenameProps"))));a.register(500,"PowerPointWebEditor.IDocNotifyClient").ma().na(()=>new oD(this.Ha,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Ha.zg?a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"):null,(b,c,f,l,w,F)=>{a.resolve("PowerPointWebEditor.IPPTWebService").B1d(c,f,l,w,F)},!1));a.register(501,"PowerPointWebEditor.IPodsDocNotifyClient").ma().na(()=>new oD(this.Ha,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"),(b,c,f,l,w,F,S,fa,xa)=>{a.resolve("PowerPointWebEditor.IPopWebService").FMc(b,c,f,l,w,F,S,fa,xa)},!0));a.register(502,"PowerPointWebEditor.IContentTimeStampManager").ma().na(()=>new tK);a.register(pv,"PowerPointWebEditor.CoauthSubscriptionManager").as("PowerPointWebEditor.ICoauthSubscriptionManager").ma().na(()=>new pv(a.resolve("PowerPointWebEditor.IDocNotifyClient"),
this.Ha.zg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.NotificationManager"),this.Ha.Obd,this.Ha.podsPushThumbnailImageIds));a.register(nD,"PowerPointWebEditor.CoauthNotificationManager").ma().na(()=>new nD(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IDocNotifyClient"),this.Ha.zg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),
a.resolve("PowerPointWebEditor.ICoauthSubscriptionManager"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.Oa("PowerPointWebEditor.IPrefetchManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.Ha,a.resolve("Common.DragInputManager"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IBusinessBarController")));a.register(Cx,"PowerPointWebEditor.PresenceLoader").ma().na(()=>new Cx(this.Ha,
a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IPPTApp"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener"),a.resolve("PowerPoint.IPathManager")));a.register(wK,"PowerpointPresence.PresenceEmailConverter").as("PowerpointPresence.IPresenceEmailConverter").ma();
a.register(503,"PowerpointPresence.IPresenceColorProvider").ma().na(()=>new mQ.a(a.resolve("Common.App.People.IPeopleColorUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").gvg,a.resolve("PowerPointWebEditor.IApplicationSettings").podsDefaultToRtcForPresenceEnabled));a.register(504,"PowerpointPresence.IPresencePerfLogger").ma().na(()=>new xK(a.qb("PowerPointWebEditor.IPageHiddenMeter"),a.resolve("PowerPointWebEditor.IApplicationSettings").podsLogRealTimeChannelResourceTiming?a.resolve("Common.NetworkTiming.IResourceTimingLogger"):
null,a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.Oa("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(sD,"PowerpointPresence.RtcParams").ma().na(()=>new sD(a.resolve("PowerPointWebEditor.ICoauthStateGetter").gC,a.resolve("PowerPointWebEditor.IApplicationContext").ndg(),a.Oa("Common.ISessionExpirationManager"),a.resolve("Common.IAppSettingsManager").Gc("RTCReconnectionSlowDurationMilliseconds",5E3)));a.register(505,"PowerPointWebEditor.ISessionTimeoutIndicator").ma().na(()=>
new EK(a.resolve("Common.IActionManager")));a.register(506,"PowerPointWebEditor.ISignalRLoadCompletedListener").ma().na(()=>new FK);a.register(lD,"PowerPointWebEditor.SessionLifetimeManager").as("PowerPointWebEditor.ISessionLifetimeManager").ma().na(()=>new lD(this.Ha,a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.Oa("PowerPointWebEditor.IGetDocumentCopyHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.ISessionTimeoutIndicator"),a.Oa("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.Oa("PowerPointWebEditor.ICommentSessionManager")));a.register(kD,"PowerPointWebEditor.SessionCleanupHandler").ma().na(()=>new kD(a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(507,"Common.IProcessInputStrategy").ma().na(()=>new Ps(a.resolve("Common.IActionManager"),this.Ha,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Common.IF6Manager")));a.register(rD,"PowerpointPresence.PresenceEventSource").as("PowerpointPresence.IPresenceEventSource").as("PowerpointPresence.IPresenceEventNotifier").as("PowerpointPresence.IPresenceEventHandlers").ma().na(()=>
new rD);a.register(508,"Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy").ma().na(()=>new zK(this.Ha.pptEditorDifferentLineHeightEnabled,a.resolve("Box4.IRotatingCoordinateConverter"),this.Ha.Vug));a.register(509,"Box4.TextMetricsApi.ITextMetricsHelper").ma().na(()=>new P);a.register(510,"PowerPointWebEditor.IThumbnailNavPaneDragAdapter").ma().na(()=>new uK(a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.DragInputManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),u.AFrameworkApplication.isRtl,this.Ha.evg,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.Ha.vz,this.Ha.U9d));a.register(511,"PowerPointWebEditor.IRemoveShapeFidelityViewOnBootController").ma().na(()=>
new DK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(512,"PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController").ma().na(()=>
new CK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(vD,"PowerPointWebEditor.ActionNameResolver").as("PowerPointWebEditor.IActionNameResolver").ma().na(()=>
new vD);a.register(tD,"PowerPointWebEditor.PPTProcessImageStrategyProxy").as("PowerPointWebEditor.IPPTProcessImageStrategy").as("Box4.IProcessImageStrategy").ma().na(()=>new tD);a.register(yD,"PowerPointWebEditor.DelayLoadedPackageInitializer").ma().na(()=>{let b=2;const c=lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptDelayLoadedPackageInitializerTaskPriority;0<=c&&6>c?b=c:za.a.J(512360583,809,50,"Invalid delay loaded initializer task priority:{0}",c);return new yD(lb.a.instance.resolve("Common.ITaskManager"),
lb.a.instance.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),lb.a.instance.resolve("PowerPointWebEditor.Core.IPerformanceHelper"),lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").delayLoadedPackageInitTimeSliceInMs,lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorCPUMeterProfilingLogThresholdInMS,b,94)});a.register(513,"PowerpointPresence.IPresencePrepCacheParser").ma().na(()=>new yK(window.self,a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.ICoauthStateSetter")));a.register(514,"PowerPointWebEditor.ISorterViewActorMain").na(()=>new zz(u.AFrameworkApplication.Va,a.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),a.resolve("PowerPointWebEditor.IPPTApp").Pxg,a.resolve("PowerPointWebEditor.ISessionState"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Oa("PowerPointWebEditor.ISorterViewActorLazy"))).ma();a.resolve("PowerPointWebEditor.ISorterViewActorMain")}init(){var a=window.g_hermesExtJS;
void 0!==a&&null!==a&&og.a.instance.jc("FirstExtJsExecTime",a);a=new rB.a("CoreExtPackage::Init");try{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Dia&&this.YVg();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").PCa(()=>{this.K.resolve("Common.ITaskManager").Hb(new Se.a(0,1,0,Object(C.a)(this,this.tfk,"onBootComplete_DelayExecuted"),90,"21"))});this.Ha.Ypg&&this.K.resolve("PowerPointWebEditor.IPageHiddenMeter");this.K.resolve("Common.IProcessInputStrategy");this.K.resolve("PowerPointWebEditor.SessionCleanupHandler");
this.K.resolve("PowerPointWebEditor.Graph.GraphNodeDelayConnectValidator").disable();this.K.resolve("Box4.IEditingView");const b=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");zD.Nqi(b,this.K.resolve("Common.IFocusManager"));b.qvi(this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.IThumbnailNavPaneDragAdapter");this.K.resolve("PowerPointWebEditor.DelayLoadedPackageInitializer");this.K.resolve("PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController");
this.K.resolve("PowerPointWebEditor.IPPTApp").qgk()}finally{a&&a.dispose()}}dispose(){this.K.resolve("PowerPointWebEditor.IPrefetchManager").dispose();this.K.resolve("PowerPointWebEditor.SessionCleanupHandler").dispose();this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").dispose();this.K.resolve("PowerPointWebEditor.IDocNotifyClient").dispose();this.K.resolve("PowerPointWebEditor.IPodsDocNotifyClient").dispose();this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").dispose()}YVg(){const a=
new rB.a("App::DelayLoadRibbon");try{this.K.resolve("PowerPointWebEditor.IRibbonUser")}finally{a&&a.dispose()}this.oIg=!0;this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").aFb(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ca)}Vpj(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableRibbon&&(document.getElementById("PptEditingRibbon").parentNode.style.display="none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableTitleBar&&(document.getElementById("AppHeaderPanel").style.display=
"none",document.getElementById("AppHeaderPanel").style.visibility="hidden");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableStatusBar&&(document.getElementById("WACStatusBarContainer").style.display="none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableNotes&&(document.getElementById("EditingNotesPanel").parentNode.style.display="none")}H7h(){"bottom"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").thumbnailPos&&(this.uHd("WACDocumentPanelContent",
"Horizontal"),this.uHd("EditingThumbnailsPanel","Horizontal"),this.uHd("EditingThumbnailsPanel","EditingThumbnailsPanelShadow"))}uHd(a,b){let c=document.getElementById(a).getAttribute("class").toString();c+=" "+b;document.getElementById(a).setAttribute("class",c)}H6d(){const a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ca;if(a){const b=new Oe.GraphTransaction(2);try{b.hd(a),a.Pba(16)}finally{b&&b.dispose()}}}y5b(a,b){const c=this.K.resolve("PowerPointWebEditor.ISessionState");
a.yM(()=>{c&&c.L_(b+"DownloadFinished")});Oi.a.nt(a)}pRj(){if(this.Ha.Vmc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Bha("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1195)));else{const a=wx.a.create("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1195)));this.y5b(a,"comment")}}oRj(){if(this.Ha.Vmc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Bha("pptedit.chronosslim",null,()=>d.e(5).then(d.bind(null,1192)));else{const a=wx.a.create("pptedit.chronosslim",
null,()=>d.e(5).then(d.bind(null,1192)));this.y5b(a,"chronosslim")}}tfk(){this.K.resolve("PowerPointWebEditor.IPrefetchManager");this.oIg||this.YVg();this.Vpj();this.H7h();const a=this.K.resolve("PowerPointWebEditor.ISessionState");if(this.Ha.separateDownloadSignalREnabled)if(this.Ha.Umc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Bha(this.K.resolve("PowerPointWebEditor.PresenceLoader").Zal,(f,l)=>{gb.App.awg()&&(this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener").zTc=
l.succeeded)},null);else{const f=this.K.resolve("PowerPointWebEditor.PresenceLoader").TLe;f.yM((l,w)=>{this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener").zTc=w.succeeded});Oi.a.nt(f)}const b=()=>{za.a.J(512360582,809,50,"Start to download chronos.js file");this.pRj();this.oRj();this.Ha.fqh||this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").Jbe()},c=()=>{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Kpg(()=>{b()})};(new $r.a(this.Ha.Rda)).jKj?this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader").vzg().continueWith(()=>
{this.H6d()}).continueWith(()=>{c()}):c();this.K.resolve("PowerPointWebEditor.ISessionTimeUpdater").sQe();this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager").start();a&&a.L_("ChronosStartDownloadTime");try{if(this.Ha.wacAirSpaceResourceLink){const f=qp.a.lVb("wacairspaceanimationlibrary.js"),l=YC.a.create(f,null,null);Oi.a.nt(l)}}catch(f){za.a.J(512360581,814,10,"App : OnBootComplete; Exception loading wacAirSpace Resource: {0}",f)}this.Ha.zg&&this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").rvj();
u.AFrameworkApplication.fa.gf(()=>{fQ.a.instance.kki()});MSOJS.ClientUtils.InitUrls(u.AFrameworkApplication.eTk,u.AFrameworkApplication.cTk,u.AFrameworkApplication.dTk)}static main(){u.AFrameworkApplication.Xg&&r.a.ag?za.a.J(512360580,809,15,"Firefox attempts to load core ext package when App is disposing"):m.a.instance.Ec(new Az)}static jqi(a){a.register(515,"PowerPointWebEditor.IPrefetchManager").ma().na(()=>new Up(a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.Image.IImageManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.resolve("Box4.Graph.IGraphInstance").Cd(8),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.ISlideCacheStrategy"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IFontUtilsManager")))}}Object(e.a)(Az,"CoreExtPackage",null,[2,3]);class GK{constructor(){this.wXc=this.nf=this.jd=this.xb=null;this.va=new sd.a;this.Sb=!1}init(a,b){this.nf=a;this.jd=b;this.XC()}dispose(){this.xb&&(this.visible=!1,this.jd.zb(ra.a.click,
this.xb,Object(C.a)(this,this.zGa,"onBackgroundClick")),this.nf&&this.xb&&(this.nf.removeChild(this.xb),this.xb=null),this.va&&(this.va.dispose(),this.va=null))}XC(){this.xb=document.createElement("div");this.xb.className="EditingNotesDefaultView";u.AFrameworkApplication.isRtl&&(this.xb.style.direction=Fe.a.oYa);this.nf.appendChild(this.xb);this.wXc=document.createElement("p");this.wXc.className="EditingNotesDefaultViewContent";this.wXc.innerText=ResourceStrings.l_ClickToAddNotes;this.xb.appendChild(this.wXc);
this.jd.pb(ra.a.click,this.xb,Object(C.a)(this,this.zGa,"onBackgroundClick"))}zGa(a){this.va.raiseEvent("OnBackgroundClick",a);return!0}YBf(a){this.va.addHandler("OnBackgroundClick",a)}onResize(){}get visible(){return this.Sb}set visible(a){this.Sb=a;this.xb.style.display=a?Ei.a.block:Ei.a.none}get za(){return this.xb}}Object(e.a)(GK,"NotesPromptView",null,[890,891,109]);class HK{constructor(a){this.z1c=this.nf=this.xb=null;this.rZc=this.Sb=!1;this.i1j=a}init(a,b){b.Eub&&(this.nf=a,this.xb=document.createElement("div"),
this.xb.className="EditingNotesReadOnlyView",this.i1j&&(this.xb.style.direction=Fe.a.oYa),this.nf.appendChild(this.xb),this.z1c=document.createElement("div"),this.z1c.className="EditingNotesReadOnlyViewContent",a={},a.inputString=b.P5c,b=jSanity.sanitize(a),this.z1c.appendChild(b),this.xb.appendChild(this.z1c),this.rZc=!0)}dispose(){this.rZc&&(this.visible=!1,this.nf&&this.xb&&(this.nf.removeChild(this.xb),this.xb=null),this.rZc=!1)}get visible(){return this.Sb}set visible(a){this.rZc&&(this.Sb=a,
this.xb.style.display=a?Ei.a.block:Ei.a.none)}get za(){return this.xb}}Object(e.a)(HK,"NotesReadOnlyView",null,[889,109]);var Bz=d(485),AD=d(629);class ar extends Bz.a{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we){super(a,b);this.Gyb=this.gg=this.nh=this.jab=null;this.GTa=!1;this.vta=gb.App.Bm;this.iFa=Object(ua.a)(385,b);this.xb=this.Gd.container;this.lc(this.xb);this.jd=c;this.Ga=f;this.Uab=l;this.ozb=xa;this.fk=w;this.Yh=F;this.gv=S;this.CI=fa;this.ob=Za;this.o9a=pb;this.r8=
Object(ua.a)(315,a);this.$7b=Mb;this.hc=hc;this.tne=kc;this.Mta=Ec;this.JI=Hc;this.Qd=Dc;this.S3j=Td;this.qp=we;this.LYc=this.Qd.rk("formatpaintertext.cur");this.qp&&this.JI.CGd(Object(C.a)(this,this.vdc,"onTextFPActiveChanged"));this.nh||this.XC()}dispose(){this.jd.zb(ra.a.click,this.xb.parentNode,Object(C.a)(this,this.zGa,"onBackgroundClick"));this.qp&&this.JI.HDe(Object(C.a)(this,this.vdc,"onTextFPActiveChanged"));this.Uab&&(this.Uab.dispose(),this.Uab=null);this.ozb&&(this.ozb.dispose(),this.ozb=
null);super.dispose()}eA(a){super.eA(a);this.VRe()}Oea(a){this.dD(this.gg,a,-1)}i5(){this.qhd()}XC(){this.S3j&&(this.Gyb=this.Gd.createElement("div"),this.Gyb.className="NotesResizeHandle",lf.c(this.Gyb,!0),Sys.UI.DomElement.addCssClass(this.Gyb,"NotesResizeHandle"),this.htmlElement.appendChild(this.Gyb),this.Co(this.Gyb));this.jab=this.Gd.createElement("div");this.jab.className="NotesContentContainer";this.jab.id="NotesContentContainer";this.Co(this.jab);this.htmlElement.appendChild(this.jab);this.nh=
this.Gd.createElement("div");Sys.UI.DomElement.addCssClass(this.nh,"NotesView");Sys.UI.DomElement.addCssClass(this.nh,"NotesEditViewVisible");this.jab.appendChild(this.nh);this.Co(this.nh);this.gg=this.Gd.createElement("div");Sys.UI.DomElement.addCssClass(this.gg,"NotesViewContent");this.nh.appendChild(this.gg);this.Co(this.gg);u.AFrameworkApplication.isRtl&&(this.nh.style.direction=Fe.a.oYa);this.jd.pb(ra.a.click,this.xb.parentNode,Object(C.a)(this,this.zGa,"onBackgroundClick"));this.Uab.init(this.xb.parentNode,
this.jd);this.ozb.init(this.xb.parentNode,this.iFa);this.qhd();this.Uab.YBf(Object(C.a)(this,this.ugk,"onDefaultViewClick"))}qhd(){if(this.iFa.Eub)this.oIa(!1),this.wLe(!1),this.eal();else{var a=this.fk.t9d(this.iFa);a=this.GTa||!a;this.oIa(a);this.wLe(!a);this.qp&&this.SD(ar.Cca)}}vdc(a,b){ar.Cca=b.NJc;this.SD(ar.Cca)}SD(a){const b=this.xb.querySelectorAll(".OutlineElement, .EditingSurfaceBody");if(2===a)for(this.xb.style.cursor=Ne.a.oP(this.LYc,Ei.a.cA),this.gg.style.cursor=Ne.a.oP(this.LYc,Ei.a.cA),
a=0;a<b.length;a++)if(b[a].style.cursor!==Ne.a.oP(this.LYc,Ei.a.cA))b[a].style.cursor=Ne.a.oP(this.LYc,Ei.a.Q4);else break;else for(this.xb.style.cursor=Ei.a.cA,this.gg.style.cursor=Ei.a.cA,a=0;a<b.length;a++)b[a].style.cursor=Ei.a.Q4}VRe(){this.htmlElement.style.zIndex="0";const a=this.fk.WPa(this.iFa,this.Gd.Ed),b=this.fk.q_b(this.iFa,this.Gd.Ed);var c=a.width-b[1]-b[3];0>c&&(b[1]+=c/2,b[3]+=c/2);c=a.height-b[0]-b[2];0>c&&(b[1]+=c/2,b[3]+=c/2);ar.mIe(this.nh,b);ar.mIe(this.Uab.za,b);ar.mIe(this.ozb.za,
b);this.Mta.qfb(new ic.a(a.x,a.y),u.AFrameworkApplication.isRtl,this.nh,!0)}Ycb(){this.GTa=!0;this.nT();this.startEditing()}Zcb(){this.GTa=!1;this.nT();this.endEditing()}sK(){return this.GTa}startEditing(){this.Oua.Eub?this.ob.fj():(this.qhd(),this.dug()||(this.vta=this.Oua.DDa,this.CI.ikh(this.iFa,!1),this.CI.ozk(this.iFa)))}endEditing(){if(!this.Oua.Eub&&(this.o9a.setVisibility(!1),this.qhd(),!this.dug())){this.bUg.endEditing(!0,14);this.$7b.dTd(this.r8);var a=this.tne.bsa(this.Oua,this.vta),b=
!!this.Oua&&this.Oua.isConnected;a&&(b&&this.Oua.cgd(),this.Yh.G3a(this.Oua),this.gv.QLd());this.CI.ikh(this.iFa,b&&this.Oua.LRc)}}ugk(a,b){this.zGa(b)}zGa(){this.Ga.Kj(Ai.a.VU,!0);this.oIa(!0);this.wLe(!1);this.bUg.PQ();this.LLe();this.vta=this.Oua.DDa;return!0}dug(){return!this.hc.An}get za(){return this.htmlElement}get Oua(){return this.iFa}get bUg(){return this.Qc}LLe(){this.n$(!0)}eal(){this.ozb.visible=!0}wLe(a){this.Uab.visible=a}oIa(a){AD.b(a,this.jab,"NotesContentContainerHidden","NotesContentContainerVisible")}n$(a){AD.b(a,
this.nh,"NotesEditViewHidden","NotesEditViewVisible")}static mIe(a,b){a&&(a.style.paddingTop=Ne.a.Nc(b[0]),a.style.paddingRight=Ne.a.Nc(b[1]),a.style.paddingBottom=Ne.a.Nc(b[2]),a.style.paddingLeft=Ne.a.Nc(b[3]))}static nHj(a){return a?Sys.UI.DomElement.containsCssClass(a,"NotesResizeHandle"):!1}}ar.Cca=0;Object(e.a)(ar,"NotesViewElement",Bz.a,[892,212]);var Vr=d(371),nQ=d(600),oQ=d(815),IK=d(483),Cz=d(482);class JK extends Cz.a{constructor(a,b){super(a,b);this.zca=[];this.l7b=0}aEb(a,...b){Array.addRange(this.zca,
b);this.l7b=a}lhc(){if(this.zca)for(const a of this.zca)this.kt.khc(this.container,a,this.l7b);this.kt.TI(this.container,this.T1)}Wmc(){this.kt.cE(this.container,this.T1);for(const a of this.zca)this.kt.cE(this.container,a)}}Object(e.a)(JK,"NotesViewDomManager",Cz.a,[]);var Dz=d(542);class KK extends Dz.ViewSelectionChangedHandler{constructor(a,b){super(a);this.sa=b}spb(){return[Object(C.a)(this,this.hdc,"onSetup"),Object(C.a)(this,this.Fcc,"onEnsurePageViewElementsCreated"),Object(C.a)(this,this.Gcc,
"onEnsureSelectedContentViewElementsCreated"),Object(C.a)(this,this.Vcc,"onMainLoop"),Object(C.a)(this,this.vjk,"onNotesContentSelect"),Object(C.a)(this,this.Bcc,"onCommit"),Object(C.a)(this,this.udc,"onTearDown")]}vjk(a,b){this.pea(b);a=Object(ua.a)(385,this.vh.ug);if(!a)return!0;a=Object(ua.a)(892,a.pc(this.vh.Na));if(!a)return!0;this.sa.Uia()?a.sK()||a.Ycb():a.sK()&&a.Zcb();return!0}}Object(e.a)(KK,"NotesViewSelectionChangedHandler",Dz.ViewSelectionChangedHandler,[]);class BD extends ov.DragSelectionDragAdapter{constructor(a,
b,c,f,l,w){super(a,b,c);this.Lp=f;this.Jce=w;this.fk=l}pu(a){if(this.Jce){var b=this.Lmc(a);const c=b?b.gb:null;if(c){const f=this.fk.Tia(c)?Object(ua.a)(385,c):this.fk.p6a(c);if(f&&this.fk.t9d(f))return!1}if(a.ctrlKey&&b&&c&&(b=this.Gf.QYa(a.clientPoint,b,c,this.Gf,!1))&&fb.HyperlinkReader.Qia(b,!0))return!1}a=super.pu(a);null!==this.Lp&&a&&this.Lp.gwa(Ei.a.Q4);return a}Jt(a){super.Jt(a);null!==this.Lp&&this.Lp.Nva()}In(a){super.In(a);null!==this.Lp&&this.Lp.Nva()}fI(a){return this.Gf.isActive?super.fI(a):
!1}static r_b(a){return new BD(a,lb.a.instance.resolve("Common.IActionManagerExtended"),lb.a.instance.resolve("Common.IActivityManager"),lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?lb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,lb.a.instance.resolve("PowerPointWebEditor.Graph.INotesReader"),lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix)}}Object(e.a)(BD,
"NotesDragSelectionDragAdapter",ov.DragSelectionDragAdapter,[]);var Ez=d(226);class CD{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){this.NKg=this.C9b=this.SDg=this.zme=this.XEa=0;this.Q8=this.g7b=this.B0c=null;this.u6b=this.zCg=this.j0c=0;this.vfe=!1;this.r8=a;this.LZ=b;this.Qj=c;this.Rb=f;this.Kz=l;this.Hg=w;this.qc=F;this.Kc=S;this.Jb=fa;xa.JMa(Object(C.a)(this,this.$cc,"onOutboundReplication"));this.ia=Za}Tu(a){return a&&a.Sz!==Sys.UI.MouseButton.rightButton?ar.nHj(a.Hc):!1}pu(a){if(!this.Tu(a))return!1;
this.vfe=!0;this.B0c=this.Kz.za;if(!this.B0c)return!1;this.Q8=this.Kc.Mc;if(this.Q8&&(this.g7b=this.Hg.za))this.SDg=this.g7b.clientHeight;else return!1;this.j0c=Math.floor(.75*(this.B0c.clientHeight+this.g7b.clientHeight));this.zme=this.B0c.clientHeight;this.C9b=this.XEa=a.clientPoint.y;this.NKg=this.Q8.wV;this.LZ.Tk(7);this.r8.endEditing(!0,14);return!0}Xv(a){if(!a)return!1;this.XEa=a.clientPoint.y;a=this.ZJf(this.XEa);this.Kz.xda=a;this.Rb.Mq();a=this.SDg+this.zme-a;this.g7b.style.height=a+"px";
this.Q8.o1k(a-1);this.Q8.t3k(this.NKg);return!0}In(a){this.LZ.S_();this.r8.PQ();this.u6b=this.ZJf(a?a.clientPoint.y:this.XEa);this.ia.Ma(aa.a.hIe,2,this.u6b)}Jt(){this.vfe&&(this.vfe=!1,this.In(null))}$cc(){this.u6b!==this.zCg&&2===gb.App.Fb.mode&&(this.zCg=this.u6b,this.Cok(this.u6b))}Cok(a){const b=this.qc.un,c=this.Jb.xd(4);try{c.lc(b),b.xBb=4320,b.xda=this.ngi(a)}finally{c&&c.dispose()}}ZJf(a){a=this.zme+this.Qj.jn(this.C9b-a);0<this.j0c&&a>this.j0c?a=this.j0c:a<Ez.a.AOa&&a>nf.a.cHc?a=Ez.a.AOa:
a<nf.a.cHc&&(a=nf.a.NXf);return a}ngi(a){return this.Qj.Rxe(a,1)}static r_b(a){return new CD(a,lb.a.instance.resolve("Common.CursorManager"),lb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),lb.a.instance.resolve("Box4.IAppFrame"),lb.a.instance.resolve("PowerPointWebEditor.INotesPane"),lb.a.instance.resolve("PowerPointWebEditor.ISlidePane"),lb.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),lb.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),lb.a.instance.resolve("Common.Transaction.ITransactionFactory"),
lb.a.instance.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),lb.a.instance.resolve("Common.IActionManagerExtended"))}}Object(e.a)(CD,"NotesResizeDragAdapter",null,[223]);class LK extends Vr.a{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc){super(Ai.a.VU,a,b,c,f,l,F,S,pb);this.lke=!1;this.Tbb=w;this.hc=fa;this.Xh=xa;this.xN=Za;this.Jce=Mb;this.qp=hc}get sHd(){return u.AFrameworkApplication.fa}kA(a,b=null){this.qp&&this.Xh.pb(ra.a.OW,this.container,Object(C.a)(this,this.f5c,"mouseUpHandlerFilter"));
super.kA(a,b);(a=Object(ua.a)(385,a))&&a.Eub&&this.xg&&this.xg.vn&&this.xg.vn.setAttribute("aria-readonly","true")}detach(){this.qp&&this.Oo&&this.Xh.zb(ra.a.OW,this.container,Object(C.a)(this,this.f5c,"mouseUpHandlerFilter"));super.detach()}KTb(a,b){return new JK(a,b)}Nba(a){a=super.Nba(a);a.T1=BD.r_b(this);a.aEb(1,CD.r_b(this));return a}ava(a){this.ltc=a.Qf;if(!this.Xgc||this.isActive||!this.Jce||(a.nc.type===ra.a.mouseDown||a.nc.type===ra.a.hNa)&&a.Sz!==Sys.UI.MouseButton.leftButton)return!1;var b=
a.Hc;if(b&&Sys.UI.DomElement.containsCssClass(b,"NotesResizeHandle"))return!1;let c=!1;Vr.a.x6&&(c=Vr.a.x6.sqa());gb.App.WC.PR&&gb.App.WC.PR.iFe(f=>{f&&(c=!0)});b=!qd.a("DeprecateIE.NotesView")&&c&&r.a.IV;a=new nQ.a(a,this,!0,b);this.Pyk(a);return!1}Pyk(a){this.Sye();this.E4(r.a.ag||r.a.tRa);this.ep.raiseEvent(Vr.a.CQc,new oQ.a(a.graphNode));this.CJc(a.graphNode);this.wTe();const b=[Object(C.a)(this,this.Qse,"noneClickHandler"),Object(C.a)(this,this.gdk,"notesSnapToContentClickHandler"),Object(C.a)(this,
this.bdk,"notesDefaultClickHandler")];for(const c of b)if(c(a).u2){this.lke=!0;break}}f5c(){return this.lke&&this.xN.XRa?(this.Da.processAction(D.a.Lha,2),!0):this.lke=!1}bdk(a){const b=Vr.a.Uc.zp(D.a.Lob);b.properties.$(Dh.a.source,"DefaultClickHandler");this.f5(a.YT,a.yr,a.graphNode,a.Qc,a.Ri.shiftKey,a.Ri.ctrlKey,a.Ri.Qf);b.end();a.$qb&&this.E4(!0);this.editingView.b9a(a.Ri.shiftKey,a.YT,a.Ri.Qf);return Ph.a.zl(!0)}gdk(a){if(!a.yr){const b=a.yr,c=a.graphNode,f=Vr.a.Uc.zp(D.a.Lob);f.properties.$(Dh.a.source,
"SnapToContentClickHandler");this.f5(a.YT,b,c,this,a.Ri.shiftKey,a.Ri.ctrlKey,a.Ri.Qf);f.end();a.$qb&&this.E4(!0);this.editingView.b9a(a.Ri.shiftKey,a.YT,a.Ri.Qf);return Ph.a.zl(!0)}return Ph.a.notHandled}wla(){super.wla();this.xg&&this.xg.vn&&(this.sHd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.xg.gjc(re.a.KAc):this.xg.oHe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,"",re.a.KAc),this.xg.vn.setAttribute(re.a.ht,ResourceStrings.l_NotesPane))}Gid(){this.mE.Jd===this&&
this.suspend()}rdd(){this.mE.Jd===this&&this.resume()}XMc(){return new KK(this,lb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"))}FKc(){return[Object(C.a)(this,this.Qse,"noneClickHandler"),Object(C.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(C.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(C.a)(this,this.defaultClickHandler,"defaultClickHandler")]}iLc(){return[Object(C.a)(this,this.Qse,"noneClickHandler"),Object(C.a)(this,this.defaultDoubleClickHandler,
"defaultDoubleClickHandler")]}Qse(a){return this.Fub(a)||this.oHj()?Ph.a.zl(!0):Ph.a.notHandled}XKc(){return[Object(C.a)(this,this.noContextMenuHandler,"noContextMenuHandler"),Object(C.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(C.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}xwa(a){this.Fub(a)||super.xwa(a)}noContextMenuHandler(a){return this.Fub(a)?wn.a.zl(null):wn.a.notHandled}Fub(a){return!!a&&!!a.graphNode&&
60===a.graphNode.type&&a.graphNode.Eub}oHj(){return!this.hc.An}x6a(){return IK.a.Fre}get cI(){return super.cI|96}get Xjc(){return!0}Tea(a,b,c=null){this.Tbb.x_(this)&&super.Tea(a,b,c)}}Object(e.a)(LK,"NotesView",Vr.a,[518,886,177,169,109,315,377,378,379,380]);var MK=d(484),Fz=d(207);class DD{constructor(a,b,c,f){this.nKg=null;this.t3=a;this.ua=b;this.Hn=c;this.Gie=f}Ivj(){this.nKg=new MK.a(Fz.App.p2a.edk,"EditingNotesPanel","EditingNotesPanel InteractiveView");this.t3.Sza(this.nKg.Axa);qv.YOf(this.t3);
this.hGf(this.ua.Ca);this.Hn.e1h(Object(C.a)(this,this.HVg,"onAttachNotesView"))}HVg(a,b){this.sKi();this.hGf(b.Ud)}hGf(a){this.ua.presentation&&a&&a.isConnected&&(a=this.Gie.O8f(a,27),this.t3.kA(a))}sKi(){this.t3.Oo&&(this.t3.editingView.disable(!0,14),this.t3.detach())}dispose(){this.Hn.lMk(Object(C.a)(this,this.HVg,"onAttachNotesView"))}}Object(e.a)(DD,"NotesViewHelper",null,[109]);class ED{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Notes"}Yb(a){this.K=a;this.K.register(518,
"PowerPointWebEditor.INotesView").ma().na(()=>new LK(this.K.resolve("Box4.IWorkspace"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),this.K.Oa("Box4.ITextMetricsAdapter"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));this.K.register(DD,"PowerPointWebEditor.Notes.NotesViewHelper").ma().na(()=>new DD(this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphNodeHelper")))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393326,new lm.a((a,b)=>Object(Ca.a)(518,a)?new ar(a,b,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),new GK,this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),new HK(u.AFrameworkApplication.isRtl),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),this.K.resolve("PowerPointWebEditor.ViewCore.IPPTPositionEditor"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").o4g,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled):null));this.K.resolve("Box4.IEditingView");this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").Ivj()}dispose(){this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").dispose()}static main(){m.a.instance.Ec(new ED)}}Object(e.a)(ED,"PPTWebEditorNotesPackage",null,[2,3]);class FD extends ov.DragSelectionDragAdapter{constructor(a,
b,c,f){super(a,b,c);this.Lp=f}pu(a){a=super.pu(a);null!==this.Lp&&a&&this.Lp.gwa(Ei.a.Q4);return a}Jt(a){super.Jt(a);null!==this.Lp&&this.Lp.Nva()}In(a){super.In(a);null!==this.Lp&&this.Lp.Nva()}fI(a){return this.Gf.isActive?super.fI(a):!1}static r_b(a){return new FD(a,lb.a.instance.resolve("Common.IActionManagerExtended"),lb.a.instance.resolve("Common.IActivityManager"),lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?lb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null)}}Object(e.a)(FD,"SmartArtTextViewDragSelectionDragAdapter",ov.DragSelectionDragAdapter,[]);class NK extends Cz.a{constructor(a,b){super(a,b);this.zca=[];this.l7b=0}aEb(a,...b){Array.addRange(this.zca,b);this.l7b=a}lhc(){if(this.zca)for(const a of this.zca)this.kt.khc(this.container,a,this.l7b);this.kt.TI(this.container,this.T1)}Wmc(){this.kt.cE(this.container,this.T1);for(const a of this.zca)this.kt.cE(this.container,a)}}Object(e.a)(NK,"SmartArtTextViewDomManager",Cz.a,[]);class OK extends Dz.ViewSelectionChangedHandler{constructor(a,
b,c,f){super(a);this.sa=b;this.Le=c;this.RN=f}spb(){return[Object(C.a)(this,this.hdc,"onSetup"),Object(C.a)(this,this.Fcc,"onEnsurePageViewElementsCreated"),Object(C.a)(this,this.Gcc,"onEnsureSelectedContentViewElementsCreated"),Object(C.a)(this,this.Vcc,"onMainLoop"),Object(C.a)(this,this.imk,"onSmartArtContentSelect"),Object(C.a)(this,this.Bcc,"onCommit"),Object(C.a)(this,this.udc,"onTearDown")]}imk(a,b){this.pea(b);b=Object(ua.a)(4,this.vh.ug);if(!b)return!1;a=Object(ua.a)(888,b.pc(this.vh.Na));
b=Object(ua.a)(133,b.pc(this.Le));if(!a)return!1;this.sa.RRa()?a.sK()||(a.Ycb(),this.RN.Uo(!0),b&&b.Ycb()):a.sK()&&(a.Zcb(),this.RN.Uo(!1),b&&b.Zcb());return!0}}Object(e.a)(OK,"SmartArtTextViewSelectionChangedHandler",Dz.ViewSelectionChangedHandler,[]);class PK extends Vr.a{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc){super(Xd.a.NT,a,c,f,l,F,fa,xa,Za);this.Tbb=S;this.sa=b;this.kq=w;this.Le=pb;this.RN=Mb;this.Ga=hc;this.Ed.gTe=!0;this.Ed.hWd=!1}get sHd(){return u.AFrameworkApplication.fa}KTb(a,b){return new NK(a,
b)}Nba(a){a=super.Nba(a);a.T1=FD.r_b(this);return a}wla(){super.wla();this.xg&&this.xg.vn&&(this.sHd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.xg.gjc(re.a.KAc):this.xg.oHe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage,re.a.KAc),this.xg.vn.setAttribute(re.a.ht,ResourceStrings.l_SmartArtTextPane))}Gid(){this.mE.Jd===this&&this.suspend()}rdd(){this.mE.Jd===this&&this.resume()}XMc(){return new OK(this,
lb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Le,this.RN)}Cob(){this.mE.Jd===this&&this.sa.ELd();return!1}FKc(){return[Object(C.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(C.a)(this,this.floatieClickHandler,"floatieClickHandler"),Object(C.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(C.a)(this,this.defaultClickHandler,"defaultClickHandler")]}iLc(){return[Object(C.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}XKc(){return[Object(C.a)(this,
this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(C.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}onClick(a){a=super.onClick(a);this.Ga.Kj(Xd.a.NT,!0);return a}x6a(){return IK.a.Fre}get cI(){let a=super.cI;return a=qd.a("SmartArt.ListensToRenderOverlayInvalidations")?a|64:a|96}get Xjc(){return!0}Tea(a,b,c=null){this.Tbb.x_(this)&&super.Tea(a,b,c)}B2k(a){const b=this.kq.ie(2);try{b.hd(a);let c=null;c=fd.SelectionFactory.oj(a,
!0);this.setSelection(c)}finally{b&&b.dispose()}}}Object(e.a)(PK,"SmartArtTextView",Vr.a,[516,886,177,169,109,315,377,378,379,380]);class QK extends Bz.a{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){super(a,b);this.gg=this.nh=null;this.GTa=!1;this.vta=gb.App.Bm;this.W2c=b;this.xb=this.Gd.container;this.lc(this.xb);this.jd=c;this.Ga=f;this.ia=l;this.Yh=w;this.gv=F;this.CI=S;this.o9a=fa;this.r8=a;this.$7b=xa;this.zd=Za;this.XC()}dispose(){this.jd.zb(ra.a.click,this.xb.parentNode,Object(C.a)(this,this.zGa,
"onBackgroundClick"));this.zd.qOk(Object(C.a)(this,this.A_g,"onSmartArtTextPaneWidthChanged"));super.dispose()}eA(a){super.eA(a)}Oea(a){this.dD(this.gg,a,-1)}i5(){this.oIa(!0)}XC(){this.nh=this.Gd.createElement("div");Sys.UI.DomElement.addCssClass(this.nh,"SmartArtTextView");Sys.UI.DomElement.addCssClass(this.nh,"SmartArtTextViewVisible");this.htmlElement.appendChild(this.nh);this.Co(this.nh);this.gg=this.Gd.createElement("div");Sys.UI.DomElement.addCssClass(this.gg,"SmartArtTextViewContent");this.gg.style.width=
Ne.a.Nc(nf.a.YGb-2*nf.a.fgb-2*nf.a.jMe-nf.a.sqh);this.nh.appendChild(this.gg);this.Co(this.gg);u.AFrameworkApplication.isRtl&&(this.nh.style.direction=Fe.a.oYa);this.oIa(!0);this.jd.pb(ra.a.click,this.xb.parentNode,Object(C.a)(this,this.zGa,"onBackgroundClick"));this.zd.t4h(Object(C.a)(this,this.A_g,"onSmartArtTextPaneWidthChanged"))}Ycb(){this.GTa=!0;this.nT();this.startEditing()}Zcb(){this.GTa=!1;this.nT();this.endEditing()}sK(){return this.GTa}startEditing(){this.oIa(!0);this.vta=this.cYa.DDa;
this.CI.qjc(this.W2c,!1);this.CI.Q$c(this.W2c)}endEditing(){this.o9a.setVisibility(!1);this.oIa(!0);this.uqh.endEditing(!0,14);this.$7b.dTd(this.r8);const a=new is.a(this.cYa,this.vta);this.ia.Ma(aa.a.Idb,2,a);const b=!!this.cYa&&this.cYa.isConnected;a.bsa&&(b&&this.cYa.cgd(),this.Yh.G3a(this.cYa),this.gv.QLd());this.CI.qjc(this.W2c,b&&this.cYa.LRc)}zGa(){this.Ga.Kj(Xd.a.NT,!0);this.uqh.PQ();this.oIa(!0);this.vta=this.cYa.DDa;return!0}get za(){return this.htmlElement}get cYa(){return this.W2c}get uqh(){return this.Qc}oIa(a){AD.b(a,
this.nh,"SmartArtTextViewHidden","SmartArtTextViewVisible")}A_g(a,b){this.gg.style.width=Ne.a.Nc(Ne.a.Zm(b.width))}}Object(e.a)(QK,"SmartArtTextViewElement",Bz.a,[888,212]);class RK{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb){this.pOg=this.z9a=null;this.RN=a;this.U8=b;this.zd=c;this.Ga=f;this.gv=l;this.kL=w;this.sa=F;this.Pb=Object(ua.a)(315,S);this.Hn=fa;this.ph=xa;this.hc=Za;this.ZZ=pb}lwj(){this.pOg=new MK.a(this.RN.PXf,"SmartArtTextViewContainer","SmartArtTextViewContainer InteractiveView EditMode");
this.U8.Sza(this.pOg.Axa);qv.YOf(this.U8);this.zd.k4h(Object(C.a)(this,this.h_g,"onSingleSmartArtShapeViewElementSelected"));this.zd.l4h(Object(C.a)(this,this.i_g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.zd.s4h(Object(C.a)(this,this.z_g,"onSmartArtShapeViewElementDeselected"));this.zd.ESb(Object(C.a)(this,this.i8c,"onSlideHtmlUpdated"));this.zd.m1h(Object(C.a)(this,this.y_g,"onSmartArtCommentsVisibilityChanged"));this.kL.l6(Object(C.a)(this,this.idc,"onShapeDisconneted"));
this.Hn.qGd(Object(C.a)(this,this.pT,"onFocusChanged"));this.Hn.vzc(Object(C.a)(this,this.pT,"onFocusChanged"));this.Pb.KMa((a,b)=>{this.i8c(a,b)})}tsa(){return!this.hc.An}FLe(a){if(this.ZZ){if(this.tsa()||a.rla)return}else if(this.tsa())return;a&&a.fg&&!a.get_smartArtModelId()&&a.isConnected?(za.a.J(38618783,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is SmartArt"),a.gMe||(this.z9a!==a&&(this.z9a=a,this.lTd(),this.iGf(a)),this.RN.HSe(a),this.RN.Uo(!0))):za.a.J(38618785,822,50,
"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is not SmartArt or not connected")}tal(a){this.tsa()||(a&&a.fg&&!a.get_smartArtModelId()&&a.isConnected?(za.a.J(38618787,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is SmartArt"),a.gMe||(this.z9a!==a&&(this.z9a=a,this.lTd(),this.iGf(a)),this.Ga.Kj(Xd.a.NT,!0),this.gv.Mv(),this.U8.B2k(a),this.RN.HSe(a),this.RN.Uo(!0))):za.a.J(38618817,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is not SmartArt or not connected"))}rWf(){this.RN.isVisible&&
(za.a.J(38618819,822,50,"SmartArtTextViewHelper::DismissSmartArtTextPane"),this.RN.Uo(!1))}h_g(a,b){this.tsa()||this.FLe(b.shapeNode)}i_g(a,b){this.tsa()||this.tal(b.shapeNode)}z_g(){this.tsa()||this.rWf()}i8c(){if(!this.tsa()&&this.sa.FK()){const a=this.sa.wra();za.a.J(38618821,822,50,"SmartArtTextViewHelper::OnSlideHtmlUpdated");a&&this.RN.HSe(a)}}pT(a,b){this.tsa()||(a=b.qBb,a===Xd.a.NT?this.ph.SJ(Xd.a.NT):this.ph.l3b(a)&&this.ph.ap(Xd.a.NT))}iGf(a){a&&a.isConnected&&this.U8.kA(a)}lTd(){this.U8.Oo&&
(this.U8.editingView.disable(!0,14),this.U8.detach())}idc(a,b){this.tsa()||b.node!==this.z9a||(this.z9a=null,this.lTd(),this.RN.Uo(!1))}y_g(a,b){this.tsa()||((a=b.d5k)?a.fg&&this.FLe(a):(a=this.sa.wra())?this.z9a!==a&&this.FLe(a):this.rWf())}dispose(){this.zd.iOk(Object(C.a)(this,this.h_g,"onSingleSmartArtShapeViewElementSelected"));this.zd.jOk(Object(C.a)(this,this.i_g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.zd.pOk(Object(C.a)(this,this.z_g,"onSmartArtShapeViewElementDeselected"));
this.zd.qMk(Object(C.a)(this,this.y_g,"onSmartArtCommentsVisibilityChanged"));this.kL.xHa(Object(C.a)(this,this.idc,"onShapeDisconneted"));this.Hn.Xbh(Object(C.a)(this,this.pT,"onFocusChanged"));this.Hn.ucd(Object(C.a)(this,this.pT,"onFocusChanged"));this.zd.qch(Object(C.a)(this,this.i8c,"onSlideHtmlUpdated"));this.Pb.Ihc((a,b)=>{this.i8c(a,b)})}}Object(e.a)(RK,"SmartArtTextViewHelper",null,[517,109]);class GD{constructor(){this.K=null;this.Iz=!1}get name(){return"PowerPointWebEditor.SmartArt"}Yb(a){this.K=
a;this.K.register(516,"PowerPointWebEditor.ISmartArtTextView").ma().na(()=>new PK(this.K.resolve("Box4.IWorkspace"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),
this.K.Oa("Box4.ITextMetricsAdapter"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.register(517,"PowerPointWebEditor.ISmartArtTextViewHelper").ma().na(()=>new RK(this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").kia))}init(){const a=this.K.resolve("Common.IAppSettingsManager");
a.gf(()=>{if(this.Iz=a.ka(ba.a.pa(341)))this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(1074135132,new lm.a((b,c)=>Object(Ca.a)(516,b)?(c=Object(ua.a)(4,c))&&c.fg?new QK(b,c,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),
this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")):null:null)),this.K.resolve("Box4.IEditingView"),this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").lwj()})}dispose(){this.Iz&&(this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").dispose(),this.K.resolve("PowerPointWebEditor.ISmartArtTextView").dispose())}static main(){m.a.instance.Ec(new GD)}}Object(e.a)(GD,
"PPTWebEditorSmartArtPackage",null,[2,3]);class SK{constructor(){this.lvl9pPrField=this.lvl8pPrField=this.lvl7pPrField=this.lvl6pPrField=this.lvl5pPrField=this.lvl4pPrField=this.lvl3pPrField=this.lvl2pPrField=this.lvl1pPrField=this.defPPrField=null}}Object(e.a)(SK,"CT_WebTextListStyle",null,[]);var Gz=d(495),Mi=d(237);class rv{constructor(a,b,c,f){this.type=a;this.stops=b;this.angle=c;this.Rrk=f}cU(){const a=Rq.b(this.stops,b=>b.cU()).join(",");if(0===this.type)return String.format("linear-gradient({0}deg, {1})",
this.angle,a);if(1===this.type||2===this.type)return String.format("radial-gradient(circle at {0}, {1})",this.Rrk.cU(),a);za.a.J(18392962,822,15,String.format("Unexpected gradient type encountered: {0}.",this.type));return Mi.Color.auto.cU()}static createLinearGradient(a,b){return new rv(0,a,b,null)}static Ixi(a,b){return new rv(1,a,0,b)}}Object(e.a)(rv,"GradientFill",null,[]);class HD{constructor(a,b){this.left=a;this.top=b}cU(){return String.format("{0}% {1}%",this.left,this.top)}}Object(e.a)(HD,
"GradientPathCenter",null,[]);class TK{constructor(a,b){this.color=a;this.position=b}cU(){return String.format("{0} {1}%",this.color.cU(),this.position)}}Object(e.a)(TK,"GradientStop",null,[]);const Hz=a=>{a=Ik.a(a);return!a||!a.blipFillField&&!a.gradFillField&&!a.grpFillField&&!a.noFillField&&!a.pattFillField&&!a.solidFillField},Dx=a=>{If.Box4ColorHelper.IOa(a)},pQ=(a,b)=>{if(!a)return null;var c=a.gsLstField;if(c){var f=new Ua.a;for(const l of c)c=If.Box4ColorHelper.kIc(l),If.Box4ColorHelper.D7d(c)?
za.a.J(18397184,822,15,"Encountered invalid gradient stop color."):f.add(new TK(If.Box4ColorHelper.CL(c,b),l.posField/1E3));b=f.toArray()}else b=null;if(a.linField)return f=90,a.linField.angFieldSpecified&&(f=(a.linField.angField/6E4+90)%360),rv.createLinearGradient(b,f);if(a.pathField)return f=new HD(50,50),a.pathField.fillToRectField&&(f=new HD(a.pathField.fillToRectField.lField/1E3,a.pathField.fillToRectField.tField/1E3)),rv.Ixi(b,f);za.a.J(18397154,822,50,"Gradient fill's linField and pathField are both null");
return rv.createLinearGradient(b,90)},UK=a=>{if(!a)return null;a=Ik.a(a);return Object.assign(new Gz.a,{blipFillField:a.blipFillField||null,gradFillField:a.gradFillField||null,grpFillField:a.grpFillField||null,noFillField:a.noFillField||null,pattFillField:a.pattFillField||null,solidFillField:a.solidFillField||null})};class VK{constructor(a){this.xja=a}v1(a,b){const c=a.tableStyle;if(c){var f=a.tableLook,l=!!(f&32)&&!!c.firstRowField,w=!!(f&64)&&!!c.lastRowField,F=!!(f&128)&&!!c.firstColField,S=!!(f&
256)&&!!c.lastColField,fa=l&&F&&!!c.nwCellField,xa=l&&S&&!!c.neCellField,Za=w&&F&&!!c.swCellField,pb=w&&S&&!!c.seCellField,Mb=!!(f&512)&&!!c.band1HField,hc=!!(f&512)&&!!c.band2HField,kc=!!(f&1024)&&!!c.band1VField;f=!!(f&1024)&&!!c.band2VField;var Ec=!b.ge,Hc=b.Tf===a.oX,Dc=!b.ae;a=b.Lf===a.Rpa;var Td=1===b.ge%2===l;b=1===b.ae%2===F;var we=!(l&&Ec)&&!(w&&Hc),Pd=!(F&&Dc)&&!(S&&a);c.wholeTblField&&this.apply(c.wholeTblField);we&&(Mb&&Td||hc&&!Td)&&(Td?this.apply(c.band1HField):this.apply(c.band2HField));
Pd&&(kc&&b||f&&!b)&&(b?this.apply(c.band1VField):this.apply(c.band2VField));a&&S&&this.apply(c.lastColField);Dc&&F&&this.apply(c.firstColField);Hc&&w&&(this.apply(c.lastRowField),a&&pb&&this.apply(c.seCellField),Dc&&Za&&this.apply(c.swCellField));Ec&&l&&(this.apply(c.firstRowField),a&&xa&&this.apply(c.neCellField),Dc&&fa&&this.apply(c.nwCellField))}}apply(a){if(a.tcTxStyleField){var b=a.tcTxStyleField;a=Ik.a(b);If.Box4ColorHelper.D7d(a)||(If.Box4ColorHelper.IOa(this.xja),this.xja.solidFillField=new rr.a,
If.Box4ColorHelper.M7h(this.xja.solidFillField,a));a=b.bField;var c=b.iField;if(b.fontRefField){b=b.fontRefField.idxField;var f=this.xja;0===b||1===b?(f.latinField=ye.upb(b,0),f.eaField=ye.upb(b,1),f.csField=ye.upb(b,2)):za.a.J(8959121,820,10,"StyleResolverHelper::ResolveToThemeFont - Invalid font collection index encountered")}else b.fontField&&(b=b.fontField,null!==b.latinField&&(this.xja.latinField=b.latinField),null!==b.eaField&&(this.xja.eaField=b.eaField),null!==b.csField&&(this.xja.csField=
b.csField));if(0===a||1===a)this.xja.bFieldSpecified=!0,this.xja.bField=0===a;if(0===c||1===c)this.xja.iFieldSpecified=!0,this.xja.iField=0===c}}}Object(e.a)(VK,"CellTextStylePartApplier",null,[]);class Qs{constructor(a){this.lPg=a}get value(){return this.lPg.valField/1E5}set value(a){this.lPg.valField=Math.floor(1E5*a)}get type(){return Qs.bUb}}Qs.bUb="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(e.a)(Qs,"LineSpacingPercent",null,[461,462]);class br{constructor(a){this.mPg=
a}get value(){return this.mPg.valField/100}set value(a){this.mPg.valField=Math.floor(100*a)}get type(){return br.bUb}}br.bUb="CT_TextSpacingPoint:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(e.a)(br,"LineSpacingPoint",null,[461,462]);class qQ{constructor(){this.valField=0}}Object(e.a)(qQ,"CT_TextSpacingPoint",null,[]);class Rs{constructor(a){this.aee=a}get lineSpacing(){return this.aee}get value(){return this.aee.value}set value(a){this.aee.value=a}static aWb(a){if(a.__type===Qs.bUb)return new Rs(new Qs(a));
if(a.__type===br.bUb)return new Rs(new br(a));za.a.J(8958300,820,10,"Unsupported line spacing format {0}",a.__type);return null}}Object(e.a)(Rs,"LineSpacingWrapper",null,[]);const WK=(a,b)=>{switch(b){case 0:return a.defPPrField;case 1:return a.lvl1pPrField;case 2:return a.lvl2pPrField;case 3:return a.lvl3pPrField;case 4:return a.lvl4pPrField;case 5:return a.lvl5pPrField;case 6:return a.lvl6pPrField;case 7:return a.lvl7pPrField;case 8:return a.lvl8pPrField;case 9:return a.lvl9pPrField;default:return null}},
XK=(a,b)=>{b.baselineFieldSpecified&&(a.baselineFieldSpecified=!0,a.baselineField=b.baselineField);b.bFieldSpecified&&(a.bFieldSpecified=!0,a.bField=b.bField);b.capFieldSpecified&&(a.capFieldSpecified=!0,a.capField=b.capField);b.iFieldSpecified&&(a.iFieldSpecified=!0,a.iField=b.iField);b.noProofFieldSpecified&&(a.noProofFieldSpecified=!0,a.noProofField=b.noProofField);b.rtlFieldSpecified&&(a.rtlFieldSpecified=!0,a.rtlField=b.rtlField);b.strikeFieldSpecified&&(a.strikeFieldSpecified=!0,a.strikeField=
b.strikeField);b.szFieldSpecified&&(a.szFieldSpecified=!0,a.szField=b.szField);b.uFieldSpecified&&(a.uFieldSpecified=!0,a.uField=b.uField);b.altLangField&&(a.altLangField=b.altLangField);b.blipFillField&&(a.blipFillField=b.blipFillField);b.csField&&(a.csField=b.csField);a.dirtyField=b.dirtyField;b.eaField&&(a.eaField=b.eaField);a.errField=b.errField;b.gradFillField&&(a.gradFillField=b.gradFillField);b.grpFillField&&(a.grpFillField=b.grpFillField);b.highlightField&&(a.highlightField=b.highlightField);
b.hlinkClickField&&(a.hlinkClickField=b.hlinkClickField);b.hlinkMouseOverField&&(a.hlinkMouseOverField=b.hlinkMouseOverField);b.langField&&(a.langField=b.langField);b.latinField&&(a.latinField=b.latinField);b.noFillField&&(a.noFillField=b.noFillField);b.pattFillField&&(a.pattFillField=b.pattFillField);b.solidFillField&&(a.solidFillField=b.solidFillField);b.symField&&(a.symField=b.symField)},rQ=a=>{switch(a){case 1:return 2;case 2:return 3;case 3:return 6;case 4:return 10;case 5:return 7;case 6:return 13;
default:return 1}};class Ex{constructor(){this.xob=Array(Ex.Cvh);this.Pwe=Array(Ex.Cvh)}}Ex.Cvh=9;Object(e.a)(Ex,"TextListStyleCache",null,[]);class YK{constructor(){this.restartInfo=this.nextNumber=1;this.listStyle=this.nextListId=0;this.autonumberBulletType=8}}Object(e.a)(YK,"NumberingData",null,[]);class sv{}sv.UJd="\u2022";sv.Sdi="p";sv.Tdi="n";Object(e.a)(sv,"ListFormats",null,[]);class ZK{constructor(a,b,c,f){this.RPg=this.SPg=gb.App.Bm;this.yCg=null;this.uc=a;this.fk=b;this.eL=c;this.Jz=f}get caches(){return this.yCg||
(this.yCg={})}z6f(a,b,c){const f=c-1;let l=a.BZ;var w;const F=!!l&&!Fa.a.nil.equals(l[f]);if(F&&(w=this.caches[l[f].toString()]))return w=w.clone(),b=Fa.a.create(),a.Eh.OD(w,b),w;if(!F)if(l)l=Array.clone(l);else for(l=Array(9),w=0;w<l.length;w++)l[w]=Fa.a.nil;const S=F?l[f]:Fa.a.create();w=this.soi(a,b,c);l[f]=S;this.caches[S.toString()]=w;F||(a.BZ=l);a.Eh.OD(w,S);F&&(w=w.clone(),a.Eh.OD(w,Fa.a.create()));return w}soi(a,b,c){const f=T.a.instance.createInstance(131073);if(b){var l=b.o6f(a.rowIndex,
a.pi,a.rowSpan,a.colSpan);b=(b=(b=a.listStyle)?WK(b,c):null)||new lt;if(l){var w=c-1;c=l.xob[w];w=l.Pwe[w];if(c||w){l=b.defRPrField||new mp;if(w){const F=md.a(md.c(w));w=F;b.algnFieldSpecified&&(w.algnFieldSpecified=!0,w.algnField=b.algnField);b.indentFieldSpecified&&(w.indentFieldSpecified=!0,w.indentField=b.indentField);b.lvlFieldSpecified&&(w.lvlFieldSpecified=!0,w.lvlField=b.lvlField);b.marLFieldSpecified&&(w.marLFieldSpecified=!0,w.marLField=b.marLField);b.marRFieldSpecified&&(w.marRFieldSpecified=
!0,w.marRField=b.marRField);b.rtlFieldSpecified&&(w.rtlFieldSpecified=!0,w.rtlField=b.rtlField);b.buAutoNumField&&(w.buAutoNumField=b.buAutoNumField);b.buCharField&&(w.buCharField=b.buCharField);b.buClrField&&(w.buClrField=b.buClrField);b.buClrTxField&&(w.buClrTxField=b.buClrTxField);b.buFontField&&(w.buFontField=b.buFontField);b.buFontTxField&&(w.buFontTxField=b.buFontTxField);b.buNoneField&&(w.buNoneField=b.buNoneField);b.buSzPctField&&(w.buSzPctField=b.buSzPctField);b.buSzPtsField&&(w.buSzPtsField=
b.buSzPtsField);b.buSzTxField&&(w.buSzTxField=b.buSzTxField);b.defRPrField&&(w.defRPrField=b.defRPrField);b.lnSpcField&&(w.lnSpcField=b.lnSpcField);b.spcAftField&&(w.spcAftField=b.spcAftField);b.spcBefField&&(w.spcBefField=b.spcBefField);b=F}c&&(c=md.a(md.c(c)),XK(c,l),b.defRPrField=c)}}a=Object(ua.a)(131,this.uc.Sg(a));this.Aoi(f,b,a?a.Ye:null)}f.ke(zb.a.k2b,!0);return f}Aoi(a,b,c){this.zoi(a,b);if(b){if(b.algnFieldSpecified){var f=rQ(b.algnField);a.setValue(ob.a.pl,f);a.setValue(ob.a.qI,f)}b.marLFieldSpecified&&
a.ke(Sb.a.Hl,ke.a.lqb(b.marLField));b.marRFieldSpecified&&a.ke(Sb.a.dX,ke.a.lqb(b.marRField));b.indentFieldSpecified&&a.ke(Sb.a.Jn,ke.a.lqb(b.indentField));b.defTabSzFieldSpecified&&a.setValue(Sb.a.Hpb,ke.a.lqb(b.defTabSzField));b.spcAftField&&(f=Rs.aWb(b.spcAftField.itemField),Object(Ca.a)(Qs,f.lineSpacing)?a.setValue(zb.a.kja,2):Object(Ca.a)(br,f.lineSpacing)&&a.setValue(zb.a.kja,4),a.setValue(zb.a.fca,f.value));b.spcBefField&&(f=Rs.aWb(b.spcBefField.itemField),Object(Ca.a)(Qs,f.lineSpacing)?a.setValue(zb.a.lja,
2):Object(Ca.a)(br,f.lineSpacing)&&a.setValue(zb.a.lja,4),a.setValue(zb.a.gca,f.value));b.lnSpcField&&(f=Rs.aWb(b.lnSpcField.itemField),Object(Ca.a)(Qs,f.lineSpacing)?a.setValue(zb.a.TV,2):Object(Ca.a)(br,f.lineSpacing)&&a.setValue(zb.a.TV,4),a.setValue(zb.a.Iw,f.value))}else za.a.J(8959502,820,10,"TextPropertyHelper::ComposeParagraphProperties - ParagraphProperties is null");b.defRPrField&&cj.toi(a,b.defRPrField,c)}NQk(a){if(a=a.BZ)for(let b=0;b<a.length;b++){const c=a[b];c&&!Fa.a.nil.equals(c)&&
delete this.caches[c.toString()]}}zoi(a,b){var c=this.rx(b);a.px(c.propertySet);b.marLFieldSpecified&&a.setValue(Sb.a.Hl,ke.a.lqb(b.marLField));b.indentFieldSpecified&&a.setValue(Sb.a.Jn,ke.a.lqb(b.indentField));b.defRPrField&&b.defRPrField.szFieldSpecified&&a.setValue(ob.a.fontSize,cj.QPf(b.defRPrField.szField));b.spcAftField&&(c=Rs.aWb(b.spcAftField.itemField),Object(Ca.a)(br,c.lineSpacing)&&(a.setValue(zb.a.kja,4),a.setValue(zb.a.fca,c.value)));b.spcBefField&&(b=Rs.aWb(b.spcBefField.itemField),
Object(Ca.a)(br,b.lineSpacing)&&(a.setValue(zb.a.lja,4),a.setValue(zb.a.gca,b.value)))}rx(a){let b;({zce:b,tWj:c}=this.GZd(a));var c=hk.a.bV(b,c);0===b&&(c.Zz=c.SV=a.buAutoNumField.startAtField);return c}GZd(a){let b,c;b=16;c=1;if(a)if(a.buCharField)switch(b=1,a.buCharField.charField){case sv.Sdi:case sv.Tdi:c=3}else if(a.buAutoNumField)switch(b=0,a.buAutoNumField.typeField){case 9:case 8:case 6:case 7:c=1;break;case 4:case 0:case 2:c=2;break;case 14:case 10:case 12:c=3;break;case 5:case 1:case 3:c=
4;break;case 15:case 11:case 13:c=5}return{zce:b,tWj:c}}validate(a){if(Object(ua.a)(fg.a,a)&&(this.fk.Tia(a)||Vi.OutlineReader.KV(a))&&a.isConnected){this.SPg=new Date;var b=Array(Uo.a.s6);for(var c=0;c<Uo.a.s6;++c)b[c]=new YK;c=-1;var f=0,l=!1;a=sh.a.pz(a);for(a.Il(Object(C.a)(this,this.ZQj,"listOEFilter"),null);a.moveNext();){16===a.iterator.currentNode.type&&(c=-1,f=0,l=!1,this.GQc(b,0),this.F6d(b,0,0));if(11!==a.iterator.currentNode.type)continue;const w=a.iterator,F=this.yba(w);let S=b[F].nextListId,
fa=null;if(yc.ListReader.$j(w)){this.Jz.kla(w);fa=this.Jz.zZd(w);const xa=this.wWi(w);w.yc();if(!fa){cd.a.instance.Vb("PossibleIncorrectListNumbering",{["Reason"]:"ListInfoNotFound"});continue}if(0===fa.listType){if(fa.Zz!==Pj.a.gw&&b[F].restartInfo!==fa.Zz||fa.listStyle!==b[F].listStyle||xa!==b[F].autonumberBulletType)l=!0,b[F].restartInfo=b[F].nextNumber=fa.Zz===Pj.a.gw?1:fa.Zz,S=b[F].nextListId=0,b[F].listStyle=fa.listStyle,b[F].autonumberBulletType=xa;fa.SV=b[F].nextNumber;c!==F||l?(fa.wha=b[F].nextNumber,
l=!1):fa.wha=Pj.a.gw;this.eL.isEmpty(w,!1)?l=!0:b[F].nextNumber++}else 1!==fa.listType&&cd.a.instance.Vb("PossibleUnexpectedListAlteration",{["Reason"]:"UnknownListType"});S||(S=b[F].nextListId=++f);w.currentNode.listID=S}c=F;fa?(0===fa.listType?this.GQc(b,F+1):this.GQc(b,F),this.F6d(b,F+1,S)):(this.GQc(b,F),this.F6d(b,F,0))}this.RPg=new Date;za.a.J(22344988,820,50,"ListCore::Validate {0}",+this.RPg-+this.SPg)}}yba(a){this.eL.Tg(a)||cd.a.instance.Vb("PossibleListLevelIncorrect",{["Reason"]:Hd.a.cba});
return a.currentNode.ta(Sb.a.listLevel,qg.a.zCa)}f4i(a){this.eL.Tg(a)||cd.a.instance.Vb("PossibleLossOfAccessibilityInfoForList",{["Reason"]:Hd.a.cba});return a.currentNode.listID}ZQj(a){return this.eL.Tg(a)||Cd.TableReader.Jp(a)||kk.l(a)||Ce.isTableCell(a)}GQc(a,b){for(;b<Uo.a.s6;++b)a[b].nextNumber=a[b].restartInfo=1}F6d(a,b,c){for(;b<Uo.a.s6;++b)a[b].nextListId=c}wWi(a){return a.currentNode.ta(zb.a.autonumberBulletType,8)}}Object(e.a)(ZK,"ListCore",null,[494]);class Vp{constructor(a,b,c=null){this.Sf=
a;this.xi=b;this.Xs=null;this.qkb=c}get y7k(){return!1}rFk(a){return a}OFb(a){let b,c,f;b=yc.ListReader.Y4a;c=a.propertySet.ta(Sb.a.listID,0);f=a.propertySet.ta(Sb.a.listLevel,-1);if(I.a.instance.ga(85)||b&&0<c&&0<=f)this.Xs=a;else{let l=1;const w=a.listStyle;b&&42!==w&&0<w&&(l=w);this.Xs=hk.a.bV(a.listType,l,null,c,f,void 0,"")}}x1k(a){a&&(this.Xs=a)}kSd(){}createList(a){const b=cd.a.instance.zp(D.a.createList);Md.OutlineElementReader.Tg(a)||cd.a.instance.Vb("PossiblyIncorrectListCreation",{["Reason"]:Hd.a.cba});
yc.ListReader.$j(a)&&cd.a.instance.Vb("PossiblyIncorrectListCreation",{["Reason"]:Hd.a.wri});const c=this.Gwi();a.hl(c,4);a.Ck(c);b.end();return c}Gwi(){return ws.a.instance.createInstance(393234)}hma(a){const b=cd.a.instance.zp(D.a.hma);Md.OutlineElementReader.Tg(a)||cd.a.instance.Vb("PossiblyIncorrectListRemoval",{["Reason"]:Hd.a.cba});yc.ListReader.$j(a)&&this.FLk(a);b.end()}FLk(a){this.Sf.kla(a);a.Hi()}fnb(a,b,c,f=!1){const l=cd.a.instance.zp(D.a.B7h);if(!this.pKf(b,c))return{returnValue:!1,x7a:c};
this.Fkh(a,c,f);f=a.Sa(Kd.a.gTg);var w=a.ta(Kd.a.Jqg,!1);let F=!1;1===c.CZ&&c.P$d&&!c.BS&&(F=!0);const S=c.propertySet.ta(Sb.a.t5b,null);S&&S===Box4Intl.Box4Strings.L_ListStyleNone&&(1===c.listType?F=c.P$d&&!c.BS:0===c.listType&&(F=0===c.listStyle));w?F&&(c.cIa(16,0),a.setValue(Kd.a.aF,16),a.setValue(Kd.a.mja,0)):(w=this.Sf.rx(b),this.Ynh(c,w,f,F,a)&&(l.properties.$("ToggledOff","true"),c.cIa(16,0),this.J0k(a)),0===c.listType&&a.Sa(Kd.a.oSa)&&(c.Zz=a.getValue(Kd.a.oSa),a.removeProperty(Kd.a.oSa)));
if(f&&(l.properties.$("MultipleOESelection","true"),({x7a:c}=this.Pnh(b,c)).returnValue))return l.end(),{returnValue:!1,x7a:c};this.h5h(b,c,a);a.setValue(Kd.a.Jqg,!0);l.end();return{returnValue:!0,x7a:c}}Ynh(a,b,c,f){if(f)return!0;if(b){f=a.listType===b.listType;const l=0===a.listStyle&&a.Zz===Pj.a.gw;a=a.listStyle===b.listStyle&&a.Zz===b.Zz;this.Sf.h9a&&(a=a&&!c);return f&&(l||a)}return!1}J0k(a){a.setValue(Kd.a.aF,16);a.setValue(Kd.a.mja,0)}Fkh(){}pKf(){return!0}Pnh(a,b){return{returnValue:16!==
b.listType&&Md.OutlineElementReader.isEmpty(a,!0),x7a:b}}Job(a){const b=cd.a.instance.zp(D.a.Job);db.ParagraphReader.Pd(a)||cd.a.instance.Vb("ClearingListFromNonParagraph",{["Reason"]:Hd.a.QRd});const c=new mb.GraphIterator;c.set(a);c.af();c.nC(12);lc.OutlineElementNavigator.Ke(c);this.N2a(c,null);b.end()}FHd(){}merge(a,b,c){const f=cd.a.instance.zp(D.a.YQj);Md.OutlineElementReader.Tg(b)||cd.a.instance.Vb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Md.OutlineElementReader.Tg(a)||cd.a.instance.Vb("PossibleIncorrectMergeOfOEs",
{["Reason"]:"DestIsNotOE"});if(yc.ListReader.$j(b)){f.properties.$("UseSourceListWithNonlistDestination",c.toString());let l;l=yc.ListReader.Y4a;c&&this.y7k&&yc.ListReader.$j(a)&&this.hma(a);if(!yc.ListReader.$j(a)||c&&l)c&&(u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),c=this.yZd(b),this.Sf.Psh&&c.propertySet.ke(ob.a.qSa,Pj.a.gw),1===c.CZ&&c.XLf(),this.N2a(a,c),f.properties.$("MoveListInfoFromSrcToDestOE","true")),u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");
Vp.JK.dTc&&this.Shi(b,a);this.hma(b);f.properties.$("RemoveListFromSrcOE","true")}f.end();return!0}Shi(a,b){a=db.ParagraphReader.Rrb(a.currentNode);b=this.Sf.C$f(b);this.Ifd(b,a,null)}yZd(a){return this.Sf.rx(a)}Ifd(a,b,c){if(a){b=Fc.a.create(b);b=Ab.a.xs(b);this.CXa(a,ob.a.fontColor,c,b);this.CXa(a,ob.a.fontSize,c,b);if(this.qkb){let f,l;({value:f}=this.getPropertyValue(ob.a.font,c,b,"")).returnValue&&this.qkb.rX(a,f);({value:l}=this.getPropertyValue(Sb.a.bU,c,b,-1)).returnValue&&this.qkb.jIa(a,
l)}else this.CXa(a,ob.a.font,c,b),this.CXa(a,Sb.a.bU,c,b);u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");Vp.JK.dTc&&(this.CXa(a,ob.a.bold,c,b),this.CXa(a,ob.a.italic,c,b),this.CXa(a,ob.a.superscript,c,b),this.CXa(a,ob.a.subscript,c,b))}}tkh(){}CXa(a,b,c,f){c&&c.Sa(b)?a.setValue(b,c.getValue(b)):f&&f.cache&&(c=f.cache,c.Sa(b)&&a.setValue(b,c.getValue(b)))}getPropertyValue(a,b,c,f){if(b&&b.Sa(a))return f=b.getValue(a),{returnValue:!0,
value:f};if(!c||!c.cache)return{returnValue:!1,value:f};b=c.cache;return b.Sa(a)?(f=b.getValue(a),{returnValue:!0,value:f}):{returnValue:!1,value:f}}XZf(a,b){b.Sa(Kd.a.aF)||(a===D.a.TQ?b.setValue(Kd.a.aF,1):a===D.a.UQ&&b.setValue(Kd.a.aF,0));b.Sa(Kd.a.mja)||b.setValue(Kd.a.mja,0);return b}tTb(a,b,c,f,l,w,F){a=cd.a.instance.zp(D.a.tTb);const S=this.Sf.rx(b);c=hk.a.bV(0,c);c.Zz=f;c.ZMa=w;S&&c.qig(S)&&c.Zz===S.SV||(f=new Oe.GraphTransaction(15),f.Ry(b),F.numbering(c.listType,c.listStyle,c.Zz)&&Vp.characterPropertiesEditor.replaceTextRange(l,
""),f.dispose());a.end()}static get characterPropertiesEditor(){return Vp.Vg||(Vp.Vg=lb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get JK(){return Vp.FJ||(Vp.FJ=lb.a.instance.qb("Box4.List.ListSettings"))}}Vp.Vg=null;Vp.FJ=null;Object(e.a)(Vp,"ListEditor",null,[493]);class Pn{}Pn.$qe=80640;Pn.are=0;Pn.b5d=80640;Pn.c5d=-80640;Object(e.a)(Pn,"ParagraphConstants",null,[]);var Pl=d(183);class $K extends Vp{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc){super(a,b);this.BWc=[ob.a.fm,
ob.a.font];this.$_c=[ob.a.fm,ob.a.font,ob.a.fontColor,zb.a.autonumberBulletType,zb.a.Xqb];this.wab=c;this.i9b=f;this.oke=l.vug;this.eL=w;this.fk=F;this.JG=fa;this.Rz=xa;this.ij=Za;this.gUa=pb;this.aIg=l.G9d;this.a_c=l.xug;this.WK=Mb;this.Ib=hc;this.Fa=kc;this.sta=l.pptCopyPasteListMarkerEnabled;this.M8b=l.pptCopyPasteMarginAndIndentationEnabled;this.hIg=l.pptCopyPasteTextWithSpacingFromExternal}OFb(a){super.OFb(a);this.a_c&&this.nEc(a.propertySet,this.Xs.propertySet)}ZHe(a){if(this.oke&&this.Xs&&
this.Xs.propertySet){const b=this.Xs.propertySet.ta(Sb.a.listLevel,-1);-1!==b&&this.$He(a,b)}this.sta&&this.Xs&&(this.Xs.erb=!0);this.hIg&&this.gkh(a);this.GHd(a,this.Xs);this.Xs=null}Tjh(a,b,c){b=this.xi.y2b(a);this.xi.dHb(a,b,c,!1,!0)}pKf(a,b){if(!a||!b)return!1;if(a.yb(4)){var c=this.Sf.zZd(a);this.wab.Ke(a);if(c&&c.listType===b.listType&&(1===b.listType||0===b.listType))return!0}c=a.yb(2);const f=c.ta(Sb.a.Jn,qg.a.indent),l=c.ta(Sb.a.Hl,qg.a.leftMargin);this.wab.Ke(a);a=f;let w=l;({indent:a,margin:w}=
this.wKd(cj.vHf(db.ParagraphReader.Gha(c,ob.a.fontSize,0)),b.listType,f,l,a,w));return!!(this.zGj(w)&this.uFj(a))}P9f(a,b,c,f){if(!a)return za.a.J(40648981,820,15,"ListEditor::GetIndentationFromListStyle - paragraphNode is null"),{qbe:c,a5d:f};b&&(c=b.ta(zb.a.QWb,qg.a.leftMargin),f=b.ta(zb.a.pQd,qg.a.indent),(a=this.Fa.$m(a))&&a.rd&&(c=b.ta(Sb.a.Hl,qg.a.leftMargin),f=b.ta(Sb.a.Jn,qg.a.indent)));return{qbe:c,a5d:f}}NJf(a,b,c,f){if(!a||!this.eL.Tg(b))return za.a.J(40648983,820,15,"ListEditor::CalculateDefaultMarginAndIndent - paragraphNode is null or iterator is not outline element "),
{RUd:c,QUd:f};var l=this.wP(b,this.JG.yba(b));if(l){const w=a.ta(Sb.a.Hl,qg.a.leftMargin),F=a.ta(Sb.a.Jn,qg.a.indent);c=w;f=F;let S=qg.a.leftMargin,fa=qg.a.indent;({qbe:S,a5d:fa}=this.P9f(a,l,S,fa));l=hk.a.vAa(l,null).listType;const xa=w+(0<=F?0:F),Za=S+(0<=fa?0:fa),pb=b.yb(4);let Mb=16;pb&&(Mb=this.i9b.bsb(pb),b.yc());fa&&xa===Za&&l===Mb?(c=S,f=fa):({indent:f,margin:c}=this.wKd(this.a6a(a),Mb,F,w,f,c),c=Math.max(Math.min(c,Pn.$qe),Pn.are),f=Math.max(Math.min(f,Pn.b5d),Pn.c5d))}return{RUd:c,QUd:f}}m_i(a,
b){if(!a||!this.eL.Tg(b))return za.a.J(40648985,820,15,"ListEditor::GetDefaultMargin - paragraphNode is null or iterator is not outline element "),qg.a.leftMargin;let c=qg.a.leftMargin,f=qg.a.indent;({RUd:c,QUd:f}=this.NJf(a,b,c,f));0<c&&za.a.J(41018258,820,50,"Get defaultMargin from liststyle");return c}i_i(a,b){if(!a||!this.eL.Tg(b))return za.a.J(40648987,820,15,"ListEditor::GetDefaultIndent - paragraphNode is null or iterator is not outline element "),qg.a.indent;let c=qg.a.leftMargin,f=qg.a.indent;
({RUd:c,QUd:f}=this.NJf(a,b,c,f));0<f&&za.a.J(41018261,820,50,"Get defaultIndent from liststyle");return f}Pnh(a,b){return{returnValue:!1,x7a:b}}Ynh(a,b,c,f,l){return f?!0:!b||l&&l.Sa(ob.a.fm)?!1:a.listType===b.listType}zGj(a){return a<Pn.$qe&&a>=Pn.are}uFj(a){return a<Pn.b5d&&a>=Pn.c5d}y8k(a){return a}kSd(a,b){a.Sa(Sb.a.listLevel)&&b.ke(Sb.a.listLevel,a.Uh(Sb.a.listLevel))}s4i(a,b){return Object(Ca.a)(Pl.TableCellNode,a)?this.JG.z6f(a,this.Rz.oNc(a),b):this.i6i(a,b)}i6i(a,b){--b;const c=a.ta(Sb.a.BZ,
[]);return 0>b||b>=c.length?(za.a.J(22344994,820,10,"ListEditor::DictionaryPropertySet - Level is out of bounds {0}",b),cd.a.instance.Vb("PossibleLossOfListStyle",{["Reason"]:"ListLevelOutOfBounds"}),null):a.Eh.te(c[b])}Ifd(){}$He(a,b){if(this.eL.Tg(a)&&0<=b&&b<Uo.a.s6){const c=a.currentNode,f=a.yb(2);c&&c.setValue(Sb.a.listLevel,b);f&&(f.setValue(Sb.a.listLevel,b),a.yc())}}Z0k(a,b){if(this.eL.Tg(a)&&b&&b.propertySet){var c=a.yb(4);c&&(b.Tsb&&b.P7&&(this.a_c?(this.nEc(b.propertySet,c),this.sta&&b.propertySet.Sa(zb.a.autonumberBulletType)&&
c.setValue(zb.a.autonumberBulletType,b.propertySet.getValue(zb.a.autonumberBulletType))):c.setValue(ob.a.fm,b.P7)),a.yc())}}tkh(a){if(this.eL.Tg(a)){if(this.oke&&this.Xs&&this.Xs.propertySet){const b=this.Xs.propertySet.ta(Sb.a.listLevel,-1);-1!==b&&this.$He(a,b);this.Z0k(a,this.Xs)}this.M8b&&this.A0k(a);this.sta&&(this.Xs&&this.Xs.propertySet?this.xEj(this.Xs)||(za.a.J(41219862,820,50,"Copied from external, such as website."),this.aIe(a)):(za.a.J(41219860,820,50,"Copied from external, such as win32 ppt."),
this.aIe(a)));this.hIg&&this.gkh(a);this.Xs=null}else za.a.J(22345027,820,10,"ListEditorCssVersion::SetProperPendingListInfoAfterPaste - input GraphIterator is not outline element ")}gkh(a){const b=this.JG.yba(a),c=this.wP(a,b),f=a.yb(2);c&&f&&0<=b&&b<Uo.a.s6&&(this.Xs&&this.Xs.propertySet&&this.Xs.propertySet.Sa(zb.a.Iw)||(za.a.J(41018265,820,50,"Get master defined line-spacing "),f.setValue(zb.a.Iw,c.ta(zb.a.WBi,qg.a.lineSpacing)),f.setValue(zb.a.TV,c.ta(zb.a.XBi,2))),this.Xs&&this.Xs.propertySet&&
this.Xs.propertySet.Sa(zb.a.gca)||(za.a.J(41018267,820,50,"Get master defined line-spacing before"),f.setValue(zb.a.gca,c.ta(zb.a.kCi,qg.a.Tyg)),f.setValue(zb.a.lja,c.ta(zb.a.lCi,4))),this.Xs&&this.Xs.propertySet&&this.Xs.propertySet.Sa(zb.a.fca)||(za.a.J(41018269,820,50,"Get master defined line-spacing after"),f.setValue(zb.a.fca,c.ta(zb.a.iCi,qg.a.Syg)),f.setValue(zb.a.kja,c.ta(zb.a.jCi,4))));a.yc()}xEj(a){if(a.propertySet.Sa(ob.a.fm)){const b=a.propertySet.getValue(ob.a.fm).length;if(1===b&&a.propertySet.Sa(ob.a.font)||
3===b&&a.propertySet.Sa(zb.a.autonumberBulletType))return!0}return!1}A0k(a){var b=this.JG.yba(a);const c=this.wP(a,b),f=a.yb(2);c&&f&&0<=b&&b<Uo.a.s6&&(this.Xs&&this.Xs.propertySet&&this.Xs.propertySet.Sa(Sb.a.Hl)||(za.a.J(41018271,820,50,"Get master defined indent-left."),c.Sa(zb.a.QWb)&&f.setValue(Sb.a.Hl,c.getValue(zb.a.QWb)),(b=this.Fa.$m(f))&&b.rd&&f.setValue(Sb.a.Hl,c.ta(Sb.a.Hl,qg.a.leftMargin))),this.Xs&&this.Xs.propertySet&&this.Xs.propertySet.Sa(Sb.a.Jn)||(za.a.J(41018273,820,50,"Get master defined firstline indent."),
c.Sa(zb.a.pQd)&&f.setValue(Sb.a.Jn,c.getValue(zb.a.pQd)),(b=this.Fa.$m(f))&&b.rd&&f.setValue(Sb.a.Jn,c.ta(Sb.a.Jn,qg.a.leftMargin))));a.yc()}aIe(a){const b=this.JG.yba(a),c=this.wP(a,b),f=a.yb(4);c&&f&&0<=b&&b<Uo.a.s6&&(za.a.J(41018275,820,50,"Get master defined list marker"),c.Sa(ob.a.fm)?(f.setValue(ob.a.fm,c.getValue(ob.a.fm)),c.Sa(ob.a.font)?f.setValue(ob.a.font,c.getValue(ob.a.font)):c.Sa(zb.a.autonumberBulletType)&&f.setValue(zb.a.autonumberBulletType,c.getValue(zb.a.autonumberBulletType))):
(f.setValue(ob.a.font,vk.uIf),f.setValue(ob.a.fm,[vk.UJd])));a.yc()}oSc(a){if(!a)return!1;let b=16;({zce:b}=this.JG.GZd(a));return 16!==b}Job(){za.a.J(22345030,820,10,"ListEditor::ClearListFromParagraph - Ppt doesn't implement ClearFormatting command");cd.a.instance.Vb("FormattingNotCleared",{["Reason"]:Hd.a.npg})}IKk(a){if(this.eL.Tg(a)){var b=a.yb(4);b&&(1===this.i9b.bsb(b)&&b.removeProperty(zb.a.autonumberBulletType),a.yc())}}v1k(a){this.eL.Tg(a)&&(a=a.currentNode)&&a.setValue(zb.a.JHj,!0)}merge(a,
b,c,f){const l=this.JG.yba(b),w=this.wP(a,this.JG.yba(a)),F=this.wP(b,l);w&&a&&(a.yb(2),a.currentNode&&(a.currentNode.Sa(Sb.a.Hl)&&w.Sa(Sb.a.Hl)&&!NA.APropertySet.nWa(Sb.a.Hl.type,a.currentNode.Uh(Sb.a.Hl),w.Uh(Sb.a.Hl))&&w.ke(Sb.a.Hl,a.currentNode.Uh(Sb.a.Hl)),a.currentNode.Sa(Sb.a.Jn)&&w.Sa(Sb.a.Jn)&&!NA.APropertySet.nWa(Sb.a.Jn.type,a.currentNode.Uh(Sb.a.Jn),w.Uh(Sb.a.Jn))&&w.ke(Sb.a.Jn,a.currentNode.Uh(Sb.a.Jn))),a.yc());super.merge(a,b,c);c&&this.oke&&(this.$He(a,l),this.v1k(a),this.IKk(a));
this.t5h(b,F,w);if(f&&(a.yb(2),c=a.currentNode.ta(zb.a.nHa,""),a.yc(),c.length))for(a=this.Ib.WYd(b);a.xf(1)&&a.currentNode!==f.currentNode;)a.yb(2),a.currentNode.setValue(zb.a.nHa,c),a.yc();return!0}h5h(a,b,c){const f=Kc.a.Db;f&&(f.Nj=!0);this.GHd(a,b,c)}mll(a,b){var c=mb.GraphIterator.nb(b);this.Sf.kla(c);b=c.currentNode;c.yc();c=this.createList(a);a.yc();c.V3a(b,zb.a.shapeId,zb.a.pva)}N2a(a,b){this.GHd(a,b)}$Cf(a,b,c){this.eL.Tg(a)||cd.a.instance.Vb("PossibleIndentNotAdjusted",{["Reason"]:Hd.a.cba});
const f=a.yb(2),l=f.ta(Sb.a.Jn,qg.a.indent),w=f.ta(Sb.a.Hl,qg.a.leftMargin);this.wab.Ke(a);if(16===b)this.gUa.Qu.ifb(f,0),0>l&&(cd.a.instance.Vb("UnexpectedlyChangingLeftIdent",{["Reason"]:"NegativeLeftIndent"}),this.xi.jfb(a,1,Math.max(w+l,0)));else{var F=this.wP(a,this.JG.yba(a));F||(F=new H.DictionaryPropertySet,za.a.J(22345036,820,50,"listStyle is null"));var S=qg.a.indent;let fa=qg.a.leftMargin;c?{qbe:fa,a5d:S}=this.P9f(f,F,fa,S):(S=F.ta(Sb.a.Jn,qg.a.indent),fa=F.ta(Sb.a.Hl,qg.a.leftMargin));
F=hk.a.vAa(F,null).listType;const xa=fa+(0<=S?0:S);S&&w+(0<=l?0:l)===xa&&F===b?(this.gUa.Qu.ifb(f,S),this.xi.jfb(a,1,fa)):(S=l,F=w,{indent:S,margin:F}=this.wKd(this.a6a(f),b,l,w,S,F),0<this.JG.yba(a)&&c&&(F+=fa),F=Math.max(Math.min(F,Pn.$qe),Pn.are),S=Math.max(Math.min(S,Pn.b5d),Pn.c5d),this.gUa.Qu.ifb(f,S),this.xi.jfb(a,1,F))}}a6a(a){if(!a)return 0;a=this.fk.Fia(a)?this.fk.idj(this.fk.p6a(a)):db.ParagraphReader.Gha(a,ob.a.fontSize,0);return cj.vHf(a)}wKd(a,b,c,f,l,w){let F=(b=1===b)?.3125:.375;0<
a&&(F=12>=a?b?.1875:.25:12<a&&18>=a?b?.3125:.375:18<a&&25>=a?b?.375:.5:25<a&&35>=a?b?.5:.5625:35<a&&44>=a?b?.625:.8125:44<a&&56>=a?b?.75:1:56<a&&72>=a?b?.9375:1.25:b?1.25:1.5);a=-1*ke.a.Ora(F);0>=c&&a<c?(w=a-c,l=c+w,w=f-w):0<c&&(l=a,w=f-a);return{indent:l,margin:w}}t5h(a,b,c){if(b&&c){lc.OutlineElementNavigator.ti(a);var f=a.Gp;if(db.ParagraphReader.Pk(a)){b=b.ta(ob.a.fontSize,Gr.fontSize);c=c.ta(ob.a.fontSize,Gr.fontSize);for(let l=0;l<f.Ra.length;++l){const w=f.Ra.ga(l);w&&w.formatting&&w.formatting.rz&&
w.formatting.rz.Sa(ob.a.fontSize)&&w.formatting.rz.getValue(ob.a.fontSize)===b&&this.ij.rr(w.formatting,c)}}lc.OutlineElementNavigator.Ke(a)}}yZd(a){if(this.sta){if(a=this.Sf.rx(a))a.erb=!0;return a}return super.yZd(a)}GHd(a,b,c=null){if(this.eL.Tg(a)){this.z5h(b,c,a);var f=a.yb(4);if(!f||b&&16!==b.listType)if(b&&0!==b.listStyle){f?hk.a.vAa(f,f).LUb():f=this.createList(a);a.yc();const l=a.yb(2);a.yc();this.aIg&&l.ta(Kd.a.X3b,!1)||this.sta&&b.erb?f.V3a(b.propertySet,zb.a.shapeId,zb.a.pva,Sb.a.listLevel,
ob.a.fm,Kd.a.aF):f.V3a(b.propertySet,zb.a.shapeId,zb.a.pva,Sb.a.listLevel,zb.a.iDa);c&&c.Sa(zb.a.autonumberBulletType)&&f.setValue(zb.a.autonumberBulletType,c.getValue(zb.a.autonumberBulletType));this.sta&&b.erb&&b.Tsb&&(3===b.P7.length&&b.propertySet.Sa(zb.a.autonumberBulletType)?(f.setValue(ob.a.fm,b.P7),c=b.propertySet.getValue(zb.a.autonumberBulletType),f.setValue(zb.a.autonumberBulletType,c),za.a.J(41018308,826,50,"Support CCP customized number list")):1===b.P7.length&&b.b7a?(f.setValue(ob.a.fm,
b.P7),f.setValue(ob.a.font,b.font),za.a.J(41018310,826,50,"Support CCP customized bullet")):(za.a.J(41219875,826,50,"Set list use dst master liststyle."),this.aIe(a)))}else return;else a.Hi();b&&b.v4f||(this.aIg?(f=this.Sf.rx(a),this.$Cf(a,f?f.listType:16,b?b.erb:!1)):this.$Cf(a,b?b.listType:16,b?b.erb:!1))}else za.a.J(22345041,820,10,"ListEditor::ApplyListInfoInternal - iterator is not outline element "),cd.a.instance.Vb("FailedToApplyListProperties",{["Reason"]:Hd.a.cba})}z5h(a,b,c){b&&a&&(1===
a.listType||0===a.listType)&&(this.WK.px(b,a.propertySet,this.BWc),c=this.wP(c,this.JG.yba(c))||new H.DictionaryPropertySet,1===a.listType&&(a.propertySet.setValue(Kd.a.mja,6),b.Sa(ob.a.fm)||(a.propertySet.setValue(ob.a.font,vk.uIf),a.propertySet.setValue(ob.a.fm,[vk.UJd]),c.Sa(ob.a.fm)&&(b=c.getValue(ob.a.fm)[0],b!==vk.UPd&&b!==vk.uGa&&this.WK.px(c,a.propertySet,this.BWc)))))}wP(a,b){this.eL.Tg(a)||cd.a.instance.Vb("PossibleLossOfListStyle",{["Reason"]:Hd.a.cba});a=this.gdj(a);return a?this.s4i(a,
1+b):(za.a.J(22345045,820,10,"ListEditor::DictionaryPropertySet - Outline is null"),cd.a.instance.Vb("PossibleLossOfListStyle",{["Reason"]:Hd.a.dPf}),null)}gdj(a){a=mb.GraphIterator.gG(a);a.t0(Vi.OutlineReader.U3b);const b=a.lw(16);return b?b:a.lZa()}bsb(a){({zce:a}=this.JG.GZd(a));return a}Fkh(a,b,c){c||0!==b.listType||(b.Zz=a.ta(ob.a.qSa,Pj.a.gw))}nEc(a,b){this.WK.nti(a,b,this.$_c)}}Object(e.a)($K,"ListEditor",Vp,[492,493]);class Ss{constructor(a,b){this.PTb=a;this.Tnb=b}}Object(e.a)(Ss,"BulletMarker",
null,[]);class Io{constructor(a,b){this.xIf=a;this.EUg=b}}Object(e.a)(Io,"ListMarkerPreview",null,[]);class Ts{constructor(a,b,c){this.uUg=a;this.AUg=b;this.$Id=c}}Object(e.a)(Ts,"NumberingMarker",null,[]);class aL{constructor(a,b){this.Ib=a;this.iAb=b;this.a2j=new sc.a(Object(C.a)(this,this.Bwi,"createListBulletDictionary"));this.f2j=new sc.a(Object(C.a)(this,this.Hwi,"createListNumberingDictionary"));this.e2j=new sc.a(Object(C.a)(this,this.Fwi,"createListMarkerPreviewDictionary"));this.c2j=new sc.a(Object(C.a)(this,
this.Ewi,"createListMarkerAltTextDictionary"))}Bwi(){const a=new Ie.a;a.$(3,new Ss(8226,"Arial"));a.$(4,new Ss(111,"Courier New"));a.$(5,new Ss(167,"Wingdings"));a.$(6,new Ss(113,"Wingdings"));a.$(7,new Ss(118,"Wingdings"));a.$(8,new Ss(216,"Wingdings"));a.$(9,new Ss(252,"Wingdings"));return a}Hwi(){const a=new Ie.a;a.$(11,new Ts(0,".",8));a.$(12,new Ts(0,")",7));a.$(13,new Ts(1,".",15));a.$(14,new Ts(3,".",5));a.$(15,new Ts(4,")",2));a.$(16,new Ts(4,".",4));a.$(17,new Ts(2,".",14));return a}Fwi(){const a=
new Ie.a;qd.a("FixEvalSecurityBugForListMarker")?(a.$(1,new Io("\u2022",["1.","2.","3."])),a.$(2,new Io("o",["1)","2)","3)"])),a.$(3,new Io("\uf0a7",["I.","II.","III."])),a.$(4,new Io("\uf071",["A.","B.","C."])),a.$(5,new Io("\uf076",["a)","b)","c)"])),a.$(6,new Io("\uf0d8",["a.","b.","c."])),a.$(7,new Io("\uf0fc",["i.","ii.","iii."]))):(a.$(1,new Io(Object(te.a)("'\\u2022'"),["1.","2.","3."])),a.$(2,new Io(Object(te.a)("'\\u006F'"),["1)","2)","3)"])),a.$(3,new Io(Object(te.a)("'\\uF0A7'"),["I.",
"II.","III."])),a.$(4,new Io(Object(te.a)("'\\uF071'"),["A.","B.","C."])),a.$(5,new Io(Object(te.a)("'\\uF076'"),["a)","b)","c)"])),a.$(6,new Io(Object(te.a)("'\\uF0D8'"),["a.","b.","c."])),a.$(7,new Io(Object(te.a)("'\\uF0FC'"),["i.","ii.","iii."])));return a}Ewi(){const a=new Ie.a;a.$(3,ResourceStrings.l_ListMarkerAltText_Bullet_1);a.$(4,ResourceStrings.l_ListMarkerAltText_Bullet_2);a.$(5,ResourceStrings.l_ListMarkerAltText_Bullet_3);a.$(6,ResourceStrings.l_ListMarkerAltText_Bullet_4);a.$(7,ResourceStrings.l_ListMarkerAltText_Bullet_5);
a.$(8,ResourceStrings.l_ListMarkerAltText_Bullet_6);a.$(9,ResourceStrings.l_ListMarkerAltText_Bullet_7);a.$(11,ResourceStrings.l_ListMarkerAltText_Numbered_1);a.$(12,ResourceStrings.l_ListMarkerAltText_Numbered_2);a.$(13,ResourceStrings.l_ListMarkerAltText_Numbered_3);a.$(14,ResourceStrings.l_ListMarkerAltText_Numbered_4);a.$(15,ResourceStrings.l_ListMarkerAltText_Numbered_5);a.$(16,ResourceStrings.l_ListMarkerAltText_Numbered_6);a.$(17,ResourceStrings.l_ListMarkerAltText_Numbered_7);return a}get nSa(){return this.a2j.value}get Y5c(){return this.f2j.value}get fVc(){return this.e2j.value}get azg(){return this.c2j.value}zFf(a,
b){const c=this.Ib.Jc(a);c.set(a);for(a=c.yb(1);a;){var f=c.yb(4);if(f){if(1===b){if(1!==f.ta(Kd.a.aF,16))return!1}else if(2===b){if(0!==f.ta(Kd.a.aF,16))return!1}else if(a=f.ta(ob.a.fm,null),this.iAb.UQc(b)){f=f.ta(ob.a.font,"");const l=this.nSa.ga(b);if(!a||1!==a.length||l.PTb!==a[0]||l.Tnb!==f)return!1}else if(this.iAb.VQc(b)){if(f=this.Y5c.ga(b),!a||3!==a.length||f.uUg!==a[1]||f.AUg!==Ja.a.fromCharCode(a[2]))return!1}else return!1;c.yc()}else if(0!==b)return!1;a=c.xf(1)}return!0}UQc(a){return this.iAb.UQc(a)}VQc(a){return this.iAb.VQc(a)}w0b(a){return this.iAb.w0b(a)}sNc(a){return this.iAb.sNc(a)}}
Object(e.a)(aL,"PptListMarkersLoader",null,[496,495]);class bL{Yul(a,b){if(!a)return!1;b.yb(2);a=b.currentNode.ta(Kd.a.X3b,!1);b.yc();return!a}}Object(e.a)(bL,"PptMergeListEditorInOutlineElementStrategy",null,[497]);class Iz{constructor(){this.Rdi=[0,3,4,5,6,7,8,9];this.Pdk=[0,11,12,13,14,15,16,17]}UQc(a){return 3<=a&&9>=a}VQc(a){return 11<=a&&17>=a}w0b(a){return Iz.Udg(a,this.Rdi,1)}sNc(a){return Iz.Udg(a,this.Pdk,2)}static Udg(a,b,c){return 0<=a&&a<b.length?b[a]:c}}Object(e.a)(Iz,"TextBulletTypeHelper",
null,[495]);class ID{get name(){return"PowerPointWebEditor.ListEditor"}Yb(a){a.register(492,"PowerPointWebEditor.IPptListEditor").ma().na(()=>new $K(a.resolve("Box4.List.IListReader"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.IOutlineElementNavigator"),a.resolve("PowerPointWebEditor.IListInfoHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("PowerPointWebEditor.ListReader"),
a.resolve("PowerPointWebEditor.IPptListCore"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IGraphUtils"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(493,"Box4.List.IListEditor").ma().na(()=>a.resolve("PowerPointWebEditor.IPptListEditor"));a.register(494,"PowerPointWebEditor.IPptListCore").ma().na(()=>new ZK(a.resolve("PowerPointWebEditor.ISlideReader"),
a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.ListReader")));a.register(495,"PowerPointWebEditor.ITextBulletTypeHelper").ma().na(()=>new Iz);a.register(496,"PowerPointWebEditor.IPptListMarkersLoader").ma().na(()=>new aL(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.ITextBulletTypeHelper")));a.register(497,"Box4.IMergeListEditorInOutlineElementStrategy").ma().na(()=>new bL)}init(){}dispose(){}static main(){m.a.instance.Ec(new ID)}}
Object(e.a)(ID,"PPTWebEditorListEditorPackage",null,[2,3]);var sQ=d(860);class cL{Zj(a){return Cd.TableReader.Zj(a)}ui(a){return Cd.TableReader.ui(a)}OMc(a,b,c){return Cd.TableReader.OMc(a,b,c)}gu(a){return Cd.TableReader.gu(a)}M8a(a){return Cd.TableReader.M8a(a)}Nr(a){return Cd.TableReader.Nr(a)}XM(a){return Cd.TableReader.XM(a)}}Object(e.a)(cL,"TableReaderProxy",null,[1290]);class dL{xtg(){return kk.j(void 0)}O9i(a){return kk.c(a)}}Object(e.a)(dL,"TableRowReaderProxy",null,[1289]);class eL extends vl.a{constructor(a,
b,c,f,l){super(a,b);this.FNh=l;this.QJ=f;a=l&&this.gb.ta(Sb.a.skippedCell,!1);b=this.Gd.Lo(ma.a.td);this.lc(b);a?this.htmlElement.className="SkippedGhostCell":(this.htmlElement.className=this.QJ.Oq?"GhostWithBorder":"Ghost",this.htmlElement.title=Box4Intl.Box4Strings.l_GhostCellTooltip);this.htmlElement.innerText="\u00a0";this.cWf()}vT(){return uj.a.hcc}eA(){this.FNh&&this.gb.ta(Sb.a.skippedCell,!1)&&this.N2k()}N2k(){this.QJ.Oq&&(this.htmlElement.style.borderTop="",this.htmlElement.style.borderLeft=
"",this.htmlElement.style.borderBottom="",this.htmlElement.style.borderRight="")}}Object(e.a)(eL,"GhostTableCellViewElement",vl.a,[1342,435,274,109]);class fL{constructor(a,b,c){this.TCd=a;this.QJ=b;this.djb=c}create(a,b){return Ce.isGhostCellNode(b.node)?Ce.shouldRenderGhostCellNode(b.node)?new eL(a,b,this.TCd,this.QJ,I.a.instance.ga(63),I.a.instance.ga(77)):null:this.djb.create(a,b)}}Object(e.a)(fL,"GhostTableCellViewElementFactory",null,[887]);class gL{constructor(a,b,c){this.wc=a;this.Vca=b;this.MLg=
c;this.cF=null;this.qxb=this.rxb=-1}n3k(a,b=null){this.p3k(a);this.cF&&this.Q_k(b)}Ili(){this.cF=null;this.qxb=this.rxb=-1}R6f(a,b,c){if(!a||!this.cF)return{row:b,column:c};var f=this.Vca.f2f(a,this.cF,this.MLg.QBc,this.MLg.PBc);if(!f)return{row:b,column:c};let l=f.rowIndex;f=f.pi;l===b||this.Vca.dRc(a,this.cF)||(l=b);var w=0,F=this.wc.ui(this.cF)-1;let S=0,fa=this.wc.Zj(this.cF)-1;this.Vca.dRc(a,this.cF)&&b>=S&&b<=fa&&c>=w&&c<=F&&(a=(w=(w=this.cF.hf(b,c))?w.ly():null)?w.rowSpan:0,F=w?w.colSpan:0,
w=c,F=c+F-1,S=b,fa=b+a-1);l>=S&&l<=fa&&f>=w&&f<=F&&(b=l,c=f);return{row:b,column:c}}Rbk(a){a=this.Hdg(a);return!!a&&14===a.type&&a.hp()}F5h(a,b,c,f,l,w){if(!this.cF||!a||14!==a.type||this.cF!==a||!b)return{E4f:c,t4f:f,kvh:l,ivh:w};this.cF.hf(c,f).isControllingCell&&({rowIndex:c,$ga:f}=this.L1i(c,f));if(this.cF.hf(l,w).isControllingCell||!this.Vca.dRc(b,this.cF))({row:l,column:w}=this.R6f(b,l,w));za.a.J(41209862,816,50,"Drag to select table cells in complex table.");return{E4f:c,t4f:f,kvh:l,ivh:w}}p3k(a){(a=
this.Hdg(a))&&14===a.type&&(this.cF=a)}Hdg(a){return 1074135132===a.Oe&&a.rd?this.wc.ZM(a):this.wc.s0b(a)}Q_k(a){this.cF&&a&&({row:this.rxb,column:this.qxb}=this.R6f(a,this.rxb,this.qxb))}L1i(a,b){if(!this.cF)return{rowIndex:a,$ga:b};let c=null;0<=a&&a<this.wc.Zj(this.cF)&&0<=b&&b<this.wc.ui(this.cF)&&(c=this.cF.hf(a,b));this.vEj(c)&&(a=this.rxb,b=this.qxb);return{rowIndex:a,$ga:b}}vEj(a){if(!this.cF)return!1;let b=0;var c=this.wc.ui(this.cF)-1;let f=0;var l=this.wc.Zj(this.cF)-1;if(a){l=a.rowIndex;
c=a.pi;const w=a.rowSpan;a=a.colSpan;b=c;c=c+a-1;f=l;l=l+w-1}return this.rxb>=f&&this.rxb<=l&&this.qxb>=b&&this.qxb<=c}}Object(e.a)(gL,"PptTableDragSelectionCellExtendStrategy",null,[479]);var hL=d(810),kn=d(234);class iL{constructor(){this.XOc=this.colSpan=this.Udd=0}}Object(e.a)(iL,"HeightInfo",null,[]);class jL{constructor(){this.rNa=null;this.rowSpan=this.height=this.width=this.top=this.offsetTop=this.left=0;this.Qhg=this.wig=this.btg=this.dtg=this.ctg=!1}}Object(e.a)(jL,"TableCellInfo",null,
[]);class kL{constructor(){this.fHh=[]}get cells(){return this.fHh}mFd(a){this.cells.push(a)}}Object(e.a)(kL,"TableRowInfo",null,[]);class lL{constructor(){this.rNa=null;this.height=this.width=this.left=this.top=this.offsetTop=0;this.psg=this.wtg=this.usg=!1}}Object(e.a)(lL,"UpdateInfo",null,[]);var tQ=d(1026),mL=d(546);class tv extends mL.a{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc){super(a,b,pb);this.WKa=!1;this.$_a=this.isf=this.KAd=this.Z_a=this.$Da=null;this.jxd=0;this.mii=1;this.kii=16;
this.bii=256;this.eii=4096;this.lii=65536;this.ksc=this.Gsc=this.Qsc=this.$sc=!1;this.nWe=this.Twf=this.bwc=this.utc=this.ffa=0;this.jfe=this.kfe=null;this.OUh=Object(ua.a)(124,b);this.V$=c;this.kaa=hc;this.$c=Za;this.GU=Mb;this.QJ=xa;this.lxc=S;this.Vfa=fa;this.Ufa=F;this.Tq=w;this.LZc=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PPTOTableCellDiagonalBordersEnabled");a=this.Gd.Lo(ma.a.td);this.lc(a);this.YX=this.Gd.Lo(ma.a.div);a.appendChild(this.YX);this.YX.className="TableCellContent";
this.Co(this.YX)}TZb(){return this.YX.offsetHeight+this.YX.offsetTop}enc(a,b,c,f){a=this.WKa?a:a+c;this.$Da||(this.$Da=this.DEc());this.$Da.style.left=a-2.5+"px";this.$Da.style.top=b+"px";this.$Da.style.height=f+"px"}eSf(){const a=this.Gd.Lo(ma.a.div);lf.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);return a}DEc(){const a=this.eSf();a.className="TableColumnResizeHandle";return a}$Od(){const a=this.Gd.Lo(ma.a.div);lf.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);
a.className=uf.a.oKk;return a}Pql(a,b,c,f){f?(a=this.WKa?a:a+b,this.Z_a||(this.Z_a=this.Fui()),b=this.Z_a.style,b.top=c+"px",b.left=a+"px"):this.Z_a&&(this.uMf(this.Z_a,!1),this.Z_a=null);return this.Z_a}Fui(){const a=this.$Od(),b=this.Gd.Lo(ma.a.div);lf.c(b,!0);b.className=uf.a.P5d;a.appendChild(b);return a}ntl(a,b,c,f){this.AKi();const l=this.KAd.style;l.top=c+"px";l.left=f+"px";c=this.isf.style;c.marginTop=b-2.5+"px";c.width=a+"px"}AKi(){if(!this.KAd){const a=this.$Od(),b=this.Gd.Lo(ma.a.div);
lf.c(b,!0);b.className=uf.a.Hlg;a.appendChild(b);this.KAd=a;this.isf=b}}ttl(a,b,c){c?(this.$_a||(this.$_a=this.yyi()),c=this.$_a.style,c.top=a+b-10+"px",this.WKa?c.right="-15px":c.left="-15px"):this.$_a&&(this.uMf(this.$_a,!0),this.$_a=null);return this.$_a}yyi(){const a=this.$Od(),b=this.Gd.Lo(ma.a.div);lf.c(b,!0);b.className=uf.a.Q5d;a.appendChild(b);return a}Hah(a){(a=this.htmlElement.querySelector("."+a))&&this.htmlElement.removeChild(a.parentNode)}uMf(a,b){b?kn.a.Uki(a):kn.a.Pki(a);this.htmlElement.removeChild(a)}itg(a){a=
a?D.a.LCa:u.AFrameworkApplication.isRtl?D.a.D7a:D.a.XQa;return 8!==u.AFrameworkApplication.Va.li(Fc.a.create(this.gb),a,1,!0,new tQ.a,null)}vT(a){super.vT(a);const b=super.vT(a);this.jxd=this.Jcj(a);if(this.kaa.Gw&&!this.Qc.Al){var c=eh.a.nb(a.E0,a.currentNode);c.af();this.Ufa.Ke(c);a=this.lxc.getContainingTable(a);this.Vfa.Tg(c)&&a&&!this.Tq.lAa(a)&&(c=c.xq)&&c.htmlElement&&this.V$.FQf(c.htmlElement,a,this.Na)}return new uj.a(b.gla+this.utc+Mn.a.Fgb,Math.max(b.minWidth,this.jxd),b.hla+this.bwc+Mn.a.Fgb)}Jcj(a){return Cd.TableReader.oub(a)?
(a=this.kaa.B9d?this.gb.ta(ne.a.fLd,1):1,a*Mn.a.dOe+(a-1)*(this.utc+this.bwc+Mn.a.Fgb)):Mn.a.dOe}i5(a){this.YX.style.paddingLeft=a.gla-Mn.a.Fgb+"px";this.YX.style.paddingRight=a.hla-Mn.a.Fgb+"px";this.kaa.CSc&&this.kaa.B9d&&(this.YX.style.minWidth=this.jxd+"px")}Oea(a){this.dD(this.YX,a,1)}eA(){this.qzh();this.Tih();var a=mb.GraphIterator.nb(this.gb);a.oc(14);const b=Fd.getContainingTable(a),c=Ce.isFirstCellInColumn(a);a=Ce.isFirstCellInRow(a);let f="";c&&tv.Fwg(b,32)&&(f="columnheader");a&&!c&&tv.Fwg(b,
128)&&(f="rowheader");""!==f?Ea.d(this.htmlElement,Ka.a.role,f):this.htmlElement.removeAttribute(re.a.ff);this.$c&&this.$c.XCa(65)&&(this.gb.AVb?Sys.UI.DomElement.addCssClass(this.htmlElement,Ub.C2):Sys.UI.DomElement.removeCssClass(this.htmlElement,Ub.C2));this.QJ.Oq&&(this.htmlElement.style.border="",this.MQk(),this.vZk(b),this.htmlElement.style.verticalAlign=this.QJ.Oq.pXi(this.gb));this.i2k();this.kaa.CSc&&this.kaa.B9d&&(this.gb.Sa(ne.a.nLf)?this.Kkh():this.htmlElement.removeAttribute("rowspan"),
this.gb.Sa(ne.a.fLd)?this.Yih():this.htmlElement.removeAttribute("colspan"));this.Qc.Al&&this.kaa.gMj&&(this.htmlElement.style.width=this.Gd.Ed.Ie(this.OUh.width,0)+"px")}i2k(){if(this.kaa.QIj||this.kaa.oOj)this.gb.x3d?this.Kkh():this.htmlElement.removeAttribute("rowspan"),this.gb.Y6a?this.Yih():this.htmlElement.removeAttribute("colspan")}qzh(){let a=null;if(this.$c&&this.$c.XCa(65)){var b=mb.GraphIterator.nb(this.gb);b.oc(15);b=b.lw(15);if(b.ymc){Sys.UI.DomElement.addCssClass(this.htmlElement,Ub.Qth);
return}if(b.nkd){Sys.UI.DomElement.addCssClass(this.htmlElement,Ub.Tth);return}}this.gb.Sa(ob.a.oCc)?(a=Jb.a.HH(this.gb.ta(ob.a.oCc,Jb.a.nil)),this.ffa|=this.lii):this.kaa.JLj&&this.QJ.Oq&&(a=this.QJ.Oq.E6f(this.gb));a=a||"transparent";this.htmlElement.style.backgroundColor=a;"transparent"!==a&&4.5>Jb.a.gYi(a)?this.htmlElement.className="LowContrastShading":this.htmlElement.className=this.htmlElement.className.replace("LowContrastShading","");this.$c&&this.$c.XCa(65)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,
Ub.Qth),Sys.UI.DomElement.removeCssClass(this.htmlElement,Ub.Tth))}Kkh(){Ea.d(this.htmlElement,Ka.a.rowSpan,this.kaa.CSc?this.gb.ta(ne.a.nLf,1):this.gb.rowSpan)}Yih(){Ea.d(this.htmlElement,Ka.a.colSpan,this.kaa.CSc?this.gb.ta(ne.a.fLd,1):this.gb.colSpan)}MQk(){this.ksc=this.Qsc=this.Gsc=this.$sc=!1}vZk(a){this.QJ.Oq&&(this.q0k(),this.htmlElement.style.border="0px none",this.AFb(this.gb,a,7),this.AFb(this.gb,a,5),this.AFb(this.gb,a,0),this.AFb(this.gb,a,6),this.LZc&&(this.AFb(this.gb,a,2),this.AFb(this.gb,
a,1)),Ea.d(this.htmlElement,Ka.a.bQd,this.ffa),this.SOk())}Tih(){var a=new mb.GraphIterator;a.set(this.gb);a.oc(14);a.Og(14);a=a.currentNode;this.utc=Mn.a.nNc(this.gb,a,Sb.a.IHb,this.QJ.Oq,Sb.a.Dhl,0);this.bwc=Mn.a.nNc(this.gb,a,Sb.a.KHb,this.QJ.Oq,Sb.a.Ehl,0);this.Twf=Mn.a.nNc(this.gb,a,Sb.a.LHb,this.QJ.Oq,Sb.a.Fhl,1);this.nWe=Mn.a.nNc(this.gb,a,Sb.a.HHb,this.QJ.Oq,Sb.a.zhl,1);this.YX.style.paddingLeft=this.utc+"px";this.YX.style.paddingRight=this.bwc+"px";this.YX.style.paddingTop=this.Twf+"px";
this.YX.style.paddingBottom=this.nWe+"px"}q0k(){var a=mb.GraphIterator.nb(this.gb);a.oc(14);a=this.lxc.getContainingTable(a);this.WKa=Cd.TableReader.Vl(a)}AFb(a,b,c){this.GU&&this.GU.hBj(b);a=this.QJ.Oq.n0i(a,c);b=a.dbi;const f=a.Xgj;if(""!==b)switch(""!==f&&Sys.UI.DomElement.addCssClass(this.htmlElement,f),c){case 7:this.htmlElement.style.borderTop=b;this.cSc(b)&&(this.$sc=!0);a.qGc&&(this.ffa|=this.mii);break;case 5:this.Oih(5,b);this.cSc(b)&&(this.Gsc=!0);a.qGc&&(this.ffa|=this.eii);break;case 0:this.htmlElement.style.borderBottom=
b;this.cSc(b)&&(this.ksc=!0);a.qGc&&(this.ffa|=this.bii);break;case 6:this.Oih(6,b);this.cSc(b)&&(this.Qsc=!0);a.qGc&&(this.ffa|=this.kii);break;case 2:this.kfe=b;break;case 1:this.jfe=b}}cSc(a){return!a||a.startsWith("0px none")?!1:!0}Oih(a,b){if(5===a&&!this.WKa||6===a&&this.WKa)this.htmlElement.style.borderLeft=b;if(5===a&&this.WKa||6===a&&!this.WKa)this.htmlElement.style.borderRight=b}SOk(){if(this.Y7k()){var a=mb.GraphIterator.nb(this.gb);if(a.oc(14)){var b=Ce.isFirstCellInRow(a),c=Ce.isLastCellInRow(a);
this.$sc||(this.htmlElement.style.borderTop="solid 1px #c8cacc",this.$sc=!0);this.ksc||(this.htmlElement.style.borderBottom="solid 1px #c8cacc",this.ksc=!0);b=b?"solid 1px #c8cacc":"dashed 1px #c8cacc";c=c?"solid 1px #c8cacc":"dashed 1px #c8cacc";a=a.lw(14);a=!Cd.TableReader.Vl(a);this.Gsc||(this.htmlElement.style.borderLeft=a?b:c,this.Gsc=!0);this.Qsc||(this.htmlElement.style.borderRight=a?c:b,this.Qsc=!0)}}}Y7k(){const a=this.Qc;return a.Jh&&a.features.f8k?!0:!1}get cha(){return this.YX}XL(a){super.XL(a);
this.nT()}nT(){if(!this.Gd.Al&&this.GA){const a=Object(ua.a)(441,this.HQ);a&&a.SQg(this.YX)}}get Qob(){return this.$Da}static Fwg(a,b){return null!==a&&a.Sa(Sb.a.tableLook)?!!(a.properties.getValue(Sb.a.tableLook)&b):!1}}Object(e.a)(tv,"TableCellViewElement",mL.a,[460,435,274,109]);class dm extends vl.a{constructor(a,b,c,f=null){super(a,b);this.aR=null;this.Soc=!0;this.hm=[];this.xu=[];this.Yxc=this.OF=null;this.PXe=this.hsf=0;dm.pSa=c;this.GU=f;b=this.Gd.Lo(ma.a.div);b.className="TableContainer";
this.Ij=this.Gd.Lo(ma.a.table);b.appendChild(this.Ij);this.Ij.className="Table";Sys.UI.DomElement.addCssClass(this.Ij,dm.Rid);this.qyf=a;this.fza=this.Gd.Lo(ma.a.div);this.fza.id=Fa.a.create().toString();this.fza.className=dm.ihl;this.fza.setAttribute(re.a.XJ,re.a.yB);b.insertBefore(this.fza,this.Ij);lf.c(this.fza,!0);a.Al&&Ea.d(this.Ij,Ka.a.border,this.gb.ta(ob.a.Egb,!0)?"1":"0");this.lc(b);a.Al||(this.aR=this.Gd.Lo(ma.a.Zmi),this.Ij.appendChild(this.aR));this.xR=this.Gd.Lo(ma.a.Vhl);this.Ij.appendChild(this.xR);
this.Co(this.Ij)}get l0(){return this.xR}get table(){return this.Ij}get zDc(){return this.aR}eA(a){this.Ij.style.borderCollapse="collapse";if(Mc.StyleReader.Oq)Sys.UI.DomElement.removeCssClass(this.Ij,dm.Rid),Sys.UI.DomElement.removeCssClass(this.Ij,dm.gOe);else{var b=this.gb.ta(ob.a.Egb,!0);b&&!this.Soc?(Sys.UI.DomElement.removeCssClass(this.Ij,dm.gOe),Sys.UI.DomElement.addCssClass(this.Ij,dm.Rid),this.Soc=!0):!b&&this.Soc&&(Sys.UI.DomElement.removeCssClass(this.Ij,dm.Rid),Sys.UI.DomElement.addCssClass(this.Ij,
dm.gOe),this.Soc=!1)}I.a.instance.ga(71)&&Mc.StyleReader.Oq&&(Ea.d(this.Ij,Ka.a.dQd,"Custom"),Ea.d(this.Ij,Ka.a.cQd,0));var c=this.aR?Cd.TableReader.ui(this.gb):0;b=this.aR?c-this.aR.childNodes.length:0;for(var f=0;f<b;++f){var l=this.Gd.Lo(ma.a.col);this.aR.appendChild(l)}for(f=0;f>b;--f)this.aR.removeChild(this.aR.firstChild);f=Ln.b(this.gb);var w=0;this.GU&&(w=this.GU.W_d(this.gb));l=Array(c);var F=!0;b=0;for(var S=0;S<c;++S){let fa=this.e7(S);0<=f[S]?(l[S]=Math.max(fa,this.Gd.Ed.Ie(f[S],0)-w),
this.aR.childNodes[S].style.width=l[S]+"px",b+=l[S]):(l[S]=-1,F=!1,this.aR.childNodes[S].style.width="",b+=fa)}if(I.a.instance.ga(63)||I.a.instance.ga(77))F?Sys.UI.DomElement.addCssClass(this.Ij,dm.cDh):Sys.UI.DomElement.removeCssClass(this.Ij,dm.cDh);if(this.hm.length===c)for(w=this.CKc(),F=0;F<c;++F)S=this.e7(F),this.hm[F].childNodes[w].style.width=0<=f[F]?Math.max(S,l[F])+"px":S+"px";c=Cd.TableReader.Vl(this.gb);if(this.gb.Sa(ob.a.pl))switch(Cd.TableReader.XM(this.gb)){case 1:this.Ij.style.marginLeft=
"";this.Ij.style.marginRight="auto";break;case 2:this.Ij.style.marginLeft="auto";this.Ij.style.marginRight="auto";break;case 3:this.Ij.style.marginLeft="auto";this.Ij.style.marginRight="";break;case 14:this.Ij.style.marginLeft=c?"auto":"";this.Ij.style.marginRight=c?"":"auto";break;case 15:this.Ij.style.marginLeft=c?"":"auto";this.Ij.style.marginRight=c?"auto":"";break;default:this.Ij.style.marginLeft="",this.Ij.style.marginRight=""}else this.Ij.style.marginLeft="",this.Ij.style.marginRight="",I.a.instance.ga(63)&&
this.gb.Sa(Sb.a.Hl)&&(f=({Of:a}=Cd.TableReader.Uha(a)).returnValue,a=(new Yu.a(a,f)).uJb+"px",c?this.Ij.style.marginRight=a:this.Ij.style.marginLeft=a);(I.a.instance.ga(71)||I.a.instance.ga(77))&&this.l3k(Mc.StyleReader.Oq,this.gb,this.Ij);this.gb.properties.ta(ob.a.Wqg,!1)?(Sys.UI.DomElement.addCssClass(this.Ij,dm.WOf),Ea.d(this.Ij,Ka.a.e9h,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(this.Ij,dm.WOf),this.Ij.removeAttribute(re.a.zpa));(a=Cd.TableReader.e1d(this.gb))&&this.Ij.setAttribute("title",
a);(a=Cd.TableReader.d1d(this.gb))?this.qyf.Al&&1===this.qyf.mode?this.Ij.removeAttribute(re.a.zpa):(this.fza.innerText=a,this.Ij.setAttribute(re.a.zpa,this.fza.id)):(this.fza.innerText="",this.Ij.removeAttribute(re.a.zpa));Ta.a.instance.Gj&&!I.a.instance.ga(30)&&(this.Ij.style.width="0px");I.a.instance.ga(30)&&(this.Ij.style.minWidth=b+"px");this.zZk();this.q3k()}zZk(){if(this.GU){const a=this.GU.NAl(this.gb);""!==a&&(this.Ij.style["border-spacing"]=a);this.x7d&&(this.Ij.style.borderCollapse="separate")}}get x7d(){return!!this.GU&&
this.GU.hBj(this.gb)}wXd(a){return this.GU?this.GU.dAl(this.gb,a):0}q3k(){this.Ij.style.borderTop="";this.Ij.style.borderBottom="";this.Ij.style.borderLeft="";this.Ij.style.borderRight=""}e7(a){return(Mc.StyleReader.Oq?Mc.StyleReader.Oq.e7(this.gb,a):Mn.a.$id)+(this.GU?this.GU.W_d(this.gb):0)}l3k(a,b,c){a&&(c.style.background=a.Qcj(b))}Oea(a){this.dD(this.htmlElement,a,88);1<this.htmlElement.children.length&&this.htmlElement.firstChild===this.Ij&&(this.thc(this.htmlElement,this.Ij),this.htmlElement.appendChild(this.Ij));
this.dD(this.xR,a,1);let b=!1;this.xR.firstChild!==this.OF&&(this.OF=this.xR.firstChild,b=!0);I.a.instance.ga(30)&&Cd.TableReader.gu(a.currentNode)||!this.aR||(u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")?(a=!1,(this.hm&&this.hm.length?this.hm[0].parentNode:null)!==(this.OF?this.OF.firstChild:null)&&(a=!0),this.zch(b||a)):this.JOk(b),kn.a.Uu||this.ODe(b))}CKc(){let a=1;(I.a.instance.ga(63)||I.a.instance.ga(30))&&Cd.TableReader.gu(this.gb)&&(a=0);return a}dispose(){I.a.instance.ga(50)&&
gb.App.Hh&&gb.App.Hh.Nv&&this.Dah();this.xu=this.hm=this.Ij=this.xR=this.aR=this.fza=this.OF=null;super.dispose()}vT(a){var b=Ln.b(this.gb),c=null;if(a.yb(1)){do{var f=a.xq.sIa;c=c?gv.vni(c,f):f.copy()}while(a.xj(1))}c||(c=new gv(b.length));for(f=0;f<b.length;f++)-1<b[f]&&c.Xih(f,Math.max(c.nYi(f),this.Gd.Ed.Ie(b[f],0)));b=Mn.a.Fgb;c=new uj.a(b,Math.max(0,c.Q$j()-2*b),b);b=new mb.GraphIterator;b.set(this.gb);f=!1;b.oc(16)&&(f=!0);c=f?new uj.a(0,c.total,0):new uj.a(c.gla,c.minWidth,c.hla);a.yb(88)&&
(c=uj.a.max(c,a.xq.sIa),a.yc());return c}zyj(){this.Dah();this.hm=[];this.xu=[]}Dah(){if(this.xu)for(var a=0;a<this.xu.length;++a)K.a.sHa(this.xu[a]),ya.a.hO(this.xu[a]);if(this.hm)for(a=0;a<this.hm.length;++a)K.a.sHa(this.hm[a]),this.xu&&this.xu[a]&&this.xu[a].parentNode&&ya.a.hO(this.hm[a])}zch(a){if(this.hm&&this.OF&&this.OF.firstChild){var b=r.a.Fw||r.a.Xn?"":" 16 20",c=String.format("url('{0}'){1}, pointer",py.a.box4Image("ColumnSelect.cur"),b);b=Ln.b(this.gb);var f=b.length,l=this.OF.firstChild;
if(a){a=Math.min(f,this.hm.length);for(var w=0;w<a;w++)l.insertBefore(this.hm[w],l.firstChild)}if(f>this.hm.length)for(a=this.hm.length;a<f;a++){w=this.Gd.createElement("div");w.className="TableColumnHandleAnchor";lf.c(w,!0);Array.add(this.hm,w);var F=this.Gd.createElement("div");F.className=kn.a.fOe;F.style.cursor=c;w.appendChild(F);F=this.Gd.createElement("div");F.className="TableColumnWidthSpacer";w.appendChild(F);l.insertBefore(this.hm[a],l.firstChild)}if(f<this.hm.length){for(c=f;c<this.hm.length;c++)K.a.sHa(this.hm[c]),
ya.a.hO(this.hm[c]);c=[];for(l=0;l<f;l++)Array.add(c,this.hm[l]);this.hm=c}c=this.CKc();l=0;for(a=0;a<f;a++)w=this.e7(a),w=Math.max(w,this.Gd.Ed.Ie(b[a],0)),this.hm[a].childNodes[c].style.width=w+"px",this.hm[a].style.left=l+"px",this.hm[a].setAttribute("ColumnIndex",a.toString()),l+=w}}JOk(a){var b=r.a.Fw||r.a.Xn?"":" 16 20";b=String.format("url('{0}'){1}, pointer",py.a.box4Image("ColumnSelect.cur"),b);if(a){a=this.OF.firstChild;var c=Math.min(this.OF.childNodes.length,this.hm.length);for(var f=
0;f<c;++f)a.insertBefore(this.hm[f],a.firstChild),a=a.nextSibling}a=this.OF.childNodes.length;if(a>this.hm.length){c=this.OF.firstChild;for(f=0;f<this.hm.length;++f)c.insertBefore(this.hm[f],c.firstChild),c=c.nextSibling;for(f=this.hm.length;f<a;++f){const w=this.Gd.createElement("div");w.className="TableColumnHandleAnchor";lf.c(w,!0);Array.add(this.hm,w);var l=this.Gd.createElement("div");l.className=kn.a.fOe;l.style.cursor=b;w.appendChild(l);l=this.Gd.createElement("div");l.className="TableColumnWidthSpacer";
w.appendChild(l);c.insertBefore(w,c.firstChild);c=c.nextSibling}}else if(a<this.hm.length){for(b=a;b<this.hm.length;++b)K.a.sHa(this.hm[b]),ya.a.hO(this.hm[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.hm[c]);this.hm=b;b=this.OF.firstChild;for(a=0;a<this.hm.length;++a)b.insertBefore(this.hm[a],b.firstChild),b=b.nextSibling}b=this.CKc();a=Ln.b(this.gb);for(c=0;c<this.hm.length;++c)f=this.e7(c),this.hm[c].childNodes[b].style.width=0<=a[c]?Math.max(f,this.Gd.Ed.Ie(a[c],0))+"px":f+"px"}ODe(a){if(!this.xu.length){a=
this.Gd.createElement("div");a.innerText="\u00a0";a.className="TableLastResizeAnchor";var b=this.Gd.createElement("div");b.className=kn.a.djd+" Last";a.appendChild(b);Array.add(this.xu,a);lf.c(a,!0);a=!0}if(a){a=Math.min(this.xu.length,this.OF.childNodes.length);for(b=1;b<a;++b){var c=this.OF.childNodes[b];c.insertBefore(this.xu[b],c.firstChild)}(a=this.OF.lastChild)?a.insertBefore(this.xu[0],a.firstChild):Z.ULS.sendTraceTag(38285521,324,15,"Table first row has no child")}a=this.OF.childNodes.length;
if(a>this.xu.length){for(b=1;b<this.xu.length;++b)c=this.OF.childNodes[b],c.insertBefore(this.xu[b],c.firstChild);for(b=this.xu.length;b<a;++b){c=this.Gd.createElement("div");c.className=kn.a.djd;lf.c(c,!0);Array.add(this.xu,c);let f=this.OF.childNodes[b];f.insertBefore(c,f.firstChild)}a=this.OF.lastChild;a.insertBefore(this.xu[0],a.firstChild)}else if(a<this.xu.length){for(b=a;b<this.xu.length;++b)K.a.sHa(this.xu[b]),ya.a.hO(this.xu[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.xu[c]);this.xu=b;for(a=
1;a<this.xu.length;++a)b=this.OF.childNodes[a],b.insertBefore(this.xu[a],b.firstChild);(a=this.OF.lastChild)?a.insertBefore(this.xu[0],a.firstChild):Z.ULS.sendTraceTag(38285522,324,15,"Table first row has no child")}}uGe(a,b){let c=-1;if(Cd.TableReader.Vl(this.gb))if(b<=Sys.UI.DomElement.getLocation(this.xR.firstChild.lastChild).x)c=this.xR.firstChild.childNodes.length-1;else for(var f=0;f<this.xR.firstChild.childNodes.length;++f){var l=Sys.UI.DomElement.getLocation(this.xR.firstChild.childNodes[f]);
if(b>=l.x){c=f;break}}else if(b<=Sys.UI.DomElement.getLocation(this.xR.firstChild.firstChild).x)c=0;else for(f=this.xR.firstChild.childNodes.length-1;0<=f;--f)if(l=Sys.UI.DomElement.getLocation(this.xR.firstChild.childNodes[f]),b>=l.x){c=f;break}c<a&&(b=c,c=a,a=b);f=[];l=mb.GraphIterator.nb(this.gb);const w=new mb.GraphIterator;b=new Oe.GraphTransaction(2);b.Ry(l);Fd.moveToFirstRow(l);Fd.moveToColumnByIndex(l,a);w.Pc(l);Fd.moveToColumnByIndex(w,c);do(a=fd.SelectionFactory.dFc(l,w))&&Array.add(f,a),
Fd.moveToNextRow(w);while(Fd.moveToNextRow(l));a=new Yh.SelectionCollection(f,f.length-1,0);this.Qc.Eb.UD(a);b.dispose()}Ejc(a,b){const c=this.CKc();this.hm&&a<this.hm.length&&this.hm[a]&&(this.hm[a].childNodes[c].style.width=Math.max(this.e7(a),b)+"px");this.aR.childNodes[a].style.width=Math.max(1,b)+"px"}IZi(a){return this.xR.firstChild.childNodes[a]?this.xR.firstChild.childNodes[a].offsetWidth:(Z.ULS.sendTraceTag(36726402,341,10,"Column {0} does not exist in first row of table. Table Rows: {1} | First row view cells {2}",
a,this.xR.childNodes.length,this.xR.firstChild.childNodes.length),0)}JKc(a){a=parseInt(this.aR.childNodes[a].style.width);return isNaN(a)?Mn.a.dOe:a}i5(a){super.i5(a);I.a.instance.ga(63)&&this.ptl();this.VSe()}VSe(){this.Yxc||(this.Yxc=new Se.a(3,1,0,Object(C.a)(this,this.updateTableDOMElements,"updateTableDOMElements"),119),u.AFrameworkApplication.ve.Hb(this.Yxc))}updateTableDOMElements(){this.Yxc=null;this.l0&&(I.a.instance.ga(63)?this.hzk(this.mFk()):kn.a.Uu&&this.Jze(this.Z_d()),u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")&&
this.zch(!1))}zld(){this.bPk()}qXi(a){return a.offsetWidth+this.wXd(0)/2}Z_d(){const a=this.dQa(),b=a.length,c=[];let f=0,l=!1;const w=Cd.TableReader.gu(this.gb);for(let S=0;S<b;S++){const fa=a[S];if(w){let Za;({Wdd:Za}=this.Hkd(fa)).returnValue&&(l=kk.f(Za.gb))}const xa=fa.childNodes;for(let Za=0;Za<xa.length;Za++){var F=xa[Za];if(void 0!==F.colSpan&&null!==F.colSpan&&void 0!==F.rowSpan&&null!==F.rowSpan){let pb;({hLd:pb}=this.GQe(F)).returnValue&&(F=Object.assign(new lL,{rNa:pb,left:F.offsetLeft,
top:this.x7d?fa.offsetTop:f,width:this.qXi(F),height:F.offsetHeight,usg:!S,wtg:S+F.rowSpan===b,psg:!l&&!Za}),c.push(F))}}f+=fa.offsetHeight}return c}ptl(){if(this.l0){var a=new mb.GraphIterator;a.set(this.gb);if(Cd.TableReader.rPf(a)&&this.aR){a=this.aR.childNodes.length;var b=Array(a),c=[],f=this.dQa(),l=f.length,w=0;for(let F=0;F<l;F++){let S=0;const fa=f[F],xa=fa.childNodes;let Za=0;for(let pb=0;pb<a;pb++){let Mb;if(b[pb]){let hc;(hc=b[pb]).XOc=hc.XOc-w;let kc;(kc=b[pb]).Udd=kc.Udd-1;Mb=b[pb].colSpan;
1===b[pb].Udd&&(S=Math.max(S,b[pb].XOc),b[pb]=null)}else{const hc=xa[Za];Za++;if(!hc)continue;let kc=0,Ec;({hLd:Ec}=this.GQe(hc)).returnValue&&(kc=Ec.TZb());Mb=hc.colSpan;1<hc.rowSpan?b[pb]=Object.assign(new iL,{colSpan:hc.colSpan,XOc:kc,Udd:hc.rowSpan}):S=Math.max(S,kc)}pb+=Mb-1}({Wdd:w}=this.Hkd(fa)).returnValue?(w.xZk(S)&&c.push(w),w=w.rfh):w=0}for(const F of c)F.otl()}}}bPk(){const a=this.dQa();if(gb.App.instance.DRc&&a.length&&!(a.length<=this.hsf&&a[0].childNodes.length===this.PXe)){this.hsf=
a.length;this.PXe=a[0].childNodes.length;var b;for(let c=0;c<a.length;c++)!ya.a.rba(a[c].firstChild,"DragHandle")&&({Wdd:b}=this.Hkd(a[c])).returnValue&&b.LOk()}}Nqg(a,b){b=a.querySelector("."+b);return!!b&&b.parentNode.parentNode===a}Jze(a){if(a)for(const b of a)b.rNa.enc(b.left,b.top,b.width,b.height,b.usg,b.wtg,b.psg)}dQa(){return this.l0.children}GQe(a){let b;b=null;a&&(a=lf.a(a),b=Object(ua.a)(tv,a));return{returnValue:!!b,hLd:b}}Hkd(a){let b;b=null;a&&(a=lf.a(a),b=Object(ua.a)(Rt,a));return{returnValue:!!b,
Wdd:b}}mFk(){let a=0;const b=Cd.TableReader.gu(this.gb),c=this.x7d,f=this.dQa(),l=[];let w=!1;for(let S=0,fa=f.length;S<fa;S++){const xa=f[S];if(!xa)continue;if(b){let hc;({Wdd:hc}=this.Hkd(xa)).returnValue&&(w=kk.f(hc.gb))}const Za=new kL,pb=!S,Mb=xa.childNodes;for(let hc=0,kc=Mb.length;hc<kc;hc++){var F=Mb[hc];let Ec;if(({hLd:Ec}=this.GQe(F)).returnValue){const Hc=F.offsetTop,Dc=F.rowSpan,Td=!hc;F=Object.assign(new jL,{rNa:Ec,left:F.offsetLeft,offsetTop:Hc,top:c?Hc:a,width:F.offsetWidth,height:F.offsetHeight,
rowSpan:Dc,ctg:pb,dtg:S+Dc===fa,btg:!w&&Td,wig:!Td&&this.Nqg(F,uf.a.Q5d),Qhg:!pb&&this.Nqg(F,uf.a.P5d)});Za.mFd(F)}}a+=xa.offsetHeight;l.push(Za)}return l}hzk(a){if(a.length){var b=this.wXd(1)/2,c=this.wXd(0)/2,f=a[0].cells[0].rNa,l=f.itg(!1);f=f.itg(!0);var w=[];for(var F of a[0].cells){var S=F.rNa.Pql(F.left,F.width+c,F.offsetTop,l);S&&w.push(S)}kn.a.VHk(w);l=[];for(F=0;F<a.length;F++)w=a[F].cells[0],(S=w.rNa.ttl(w.height+b,w.offsetTop,f))&&l.push(S),1<w.rowSpan&&(F+=w.rowSpan-1);kn.a.MJk(l);for(const fa of a)for(const xa of fa.cells)a=
xa.rNa,f=xa.width,l=xa.height,a.ntl(f,l+b,xa.offsetTop,xa.left),a.enc(xa.left,xa.top,f+c,l,xa.ctg,xa.dtg,xa.btg),xa.wig&&a.Hah(uf.a.Q5d),xa.Qhg&&a.Hah(uf.a.P5d)}}}dm.Rid="Border";dm.gOe="NoBorder";dm.WOf="Conflict";dm.cDh="TableWordWrap";dm.ihl="WACAltTextDescribedBy";dm.pSa=null;Object(e.a)(dm,"TableViewElement",vl.a,[1279,435,274,109]);class uv extends Rt{constructor(a,b,c){super(a,b,c,null,null)}gGb(a){this.htmlElement.style.height=a+"px"}get qfh(){return this.Gd.Ed.Ie(this.gb.ta(zb.a.Nt,0),1)+
"px"}static Neg(a){a=lf.a(a);let b=null;a&&(b=Object(ua.a)(uv,a));return b}}Object(e.a)(uv,"TableRowViewElement",Rt,[]);class Fx{constructor(a,b,c=!1){this.dbi=a;this.Xgj=b;this.qGc=c}}Object(e.a)(Fx,"TableBorderProperty",null,[]);var rl=d(494);class Wp{constructor(a,b,c,f,l){this.d8=a;this.uc=c;this.Ib=b;this.fAb=f;this.H0j=l}W7i(a){switch(a){case 0:a=Sb.a.HHb;break;case 1:a=Sb.a.IHb;break;case 2:a=Sb.a.KHb;break;case 3:a=Sb.a.LHb;break;default:a=null}return{returnValue:!!a,e9j:a}}ara(a,b){let c=
0;if(!a)return c;let f;({e9j:f}=this.W7i(b)).returnValue&&(c=3===b||0===b?a.ta(f,.1):a.ta(f,Wp.rvk));return c}VJf(a){return.0555555555555556+this.ara(a,1)+this.ara(a,2)}xKd(a,b){const c=Cd.TableReader.Zj(a);if(0>b||b>=c)return.0555555555555556;a=this.Ib.Jc(a).Hp(b,1);return this.SBc(a)}SBc(a){let b=.0555555555555556;a=this.Ib.Jc(a);a.yb(1);do{const c=a.currentNode;b=Math.max(b,.0555555555555556+this.ara(c,0)+this.ara(c,3))}while(a.xf(1));return b}bob(a,b){var c=Cd.TableReader.ui(a);if(0>b||b>=c)return.0555555555555556;
c=.0555555555555556;a=this.Ib.Jc(a);a.yb(1);do{const f=a.Hp(b,1);c=Math.max(c,this.VJf(f));a.yc()}while(a.xf(1));return c}DYd(a){return a&&a.tblBgField&&a.tblBgField.fillField&&(a.tblBgField.fillField.solidFillField||a.tblBgField.fillField.gradFillField)?a.tblBgField.fillField:rl.a.Gpb}f1d(a,b){let c=b;if(this.H0j&&b&&b.cellShading){let f;({jja:f}=this.LQe(a,b.cellShading)).returnValue&&(b=Object(ua.a)(131,this.uc.Sg(b)),c=this.fAb.xeh(a,b?b.Ye:null,f))}return c}NZb(a,b){let c=rl.a.Fpb,f;({d3a:f}=
Wp.$Pa(b)).returnValue&&(a=this.f1d(b,a),a.Sa(f)&&(c=a.getValue(f)));return c}AWd(a,b,c){if(c&&c.xC===Jb.a.auto)return Gk.a.none;a=this.XZi(a);b=this.oXd(b);c=c.cU();return String.format("{0} {1}px {2}",a,b,c)}oXd(a){a=this.d8.Ie(a,0);r.a.zsa&&0<a&&1>a&&(a=1);return a}Anb(a,b,c=!1){let f=Jb.a.gOa.cU();if(a.solidFillField){var l=If.Box4ColorHelper.CL(If.Box4ColorHelper.Fwa(a.solidFillField),b);c&&(l.r=l.g=l.b=255);f=l.cU()}else if(a.gradFillField){a=pQ(a.gradFillField,b);if(c)for(l of a.stops)l.color.r=
l.color.g=l.color.b=255;f=a.cU()}return f}xgj(a){const b=a.currentNode.pi;a.yc();const c=a.RE(1);a.Hp(b,1);return c?a.currentNode:null}Cgj(a){return a.RE(1)}LQe(a,b){switch(a){case 7:a=b.lnTField;break;case 0:a=b.lnBField;break;case 5:a=b.lnLField;break;case 6:a=b.lnRField;break;default:a=null}return{returnValue:!!a,jja:a}}XZi(a){switch(a){case 2:case 3:case 4:case 5:case 6:case 7:case 9:case 10:return"dashed";case 1:case 8:return"dotted";default:return"solid"}}static $Pa(a){let b,c;switch(a){case 7:a=
zb.a.Swa;b=zb.a.Bgb;c=zb.a.Ggl;break;case 0:a=zb.a.Eea;b=zb.a.Pwa;c=zb.a.Bgl;break;case 5:a=zb.a.Rwa;b=zb.a.Agb;c=zb.a.Egl;break;case 6:a=zb.a.Fea;b=zb.a.Qwa;c=zb.a.Fgl;break;case 2:a=zb.a.Dgb;b=zb.a.zgb;c=zb.a.Dgl;break;case 1:a=zb.a.Cgb;b=zb.a.ygb;c=zb.a.Cgl;break;default:c=b=a=null}return{returnValue:!!a,d3a:a,c3a:b,Inb:c}}}Wp.rvk=.2;Object(e.a)(Wp,"TableStyleReaderHelper",null,[440]);class JD{constructor(a,b,c=-1){this.vua=a;this.KCg=b;this.TGg=c}}Object(e.a)(JD,"TableStyle",null,[]);var cr=d(319);
class Jz{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He){this.vua=new Ie.a;this.r3c=new Ie.a;this.q3c=new Ie.a;this.m3c=new Ie.a;this.mOe=[];this.Ib=a;this.JG=c;this.uc=b;this.Fk=f;this.d8=l;this.jda=w;this.ZFa=F;this.qc=S;this.Mpe=fa;this.W6j=xa;this.R6j=Za;this.J6j=pb;this.wc=Mb;this.uua=hc;this.lF=kc;this.oo=Ec;this.Hn=Hc;this.CZc=Dc;this.y1j=Td;this.Zxb=we;this.NEa=Pd;this.RTa=He;this.ZFa.yga(Object(C.a)(this,this.t8c,"onTableConnectedOrDisconnected"));this.ZFa.l6(Object(C.a)(this,
this.t8c,"onTableConnectedOrDisconnected"));this.ZFa.yk(Object(C.a)(this,this.P_g,"onTablePropertyChanged"));this.Hn.Q2h(Object(C.a)(this,this.SYg,"onPageViewBeforeValidate"))}dispose(){this.ZFa.mma(Object(C.a)(this,this.t8c,"onTableConnectedOrDisconnected"));this.ZFa.xHa(Object(C.a)(this,this.t8c,"onTableConnectedOrDisconnected"));this.ZFa.Pm(Object(C.a)(this,this.P_g,"onTablePropertyChanged"));this.Hn.rNk(Object(C.a)(this,this.SYg,"onPageViewBeforeValidate"))}D6f(a){if(!a||!a.length)return null;
const b=this.AKc(Object(ua.a)(fg.a,a[0]));if(!b)return null;for(let c=1;c<a.length;c++){const f=this.AKc(Object(ua.a)(fg.a,a[c]));if(!f||f.xC!==b.xC)return null}return b}R0d(a){let b=null;if(a=this.t0b(a))b=new kq.a,b.ke(zb.a.tableStyle,new JD(a,Number.MAX_VALUE));return b}oNc(a){if(14!==a.type){a=this.Ib.Jc(a);a.oc(14);var b=a.Og(14)}else b=a;a=b.id;this.q3c.Kb(a)||(b=this.S0d(b),this.q3c.$(a,this.R6j(b)));return this.q3c.ga(a)}t4i(a){return(a=this.qc.I0d(Object(ua.a)(131,this.uc.Sg(a))))?a.TableListStyle:
null}S0d(a){const b=Object(ua.a)(131,this.uc.Sg(a));return this.Mpe(()=>a.oX,()=>a.v6,()=>a.tableLook,()=>this.t4i(a),()=>b?b.Ye:null,()=>this.t0b(a))}t8c(a,b){this.Bpg(b.node)}P_g(a,b){a=b.property;b=b.node;if(a===zb.a.LIa||a===zb.a.tlc||a===ob.a.Uwa||a===ob.a.Gea||a===ob.a.rA){if(a===ob.a.Uwa||a===ob.a.rA)b.ulc=!1;a!==zb.a.LIa&&a!==zb.a.tlc||this.Bpg(b);this.E2b(b)}}G9j(a){Array.contains(this.mOe,a)||(this.E2b(a),this.mOe.push(a))}SYg(){Array.clear(this.mOe)}Nyj(a){this.m3c.remove(a.id)}Bpg(a){a=
a.id;this.vua.remove(a);this.r3c.remove(a);this.q3c.remove(a)}mNc(a){const b=a.id;this.m3c.Kb(b)||this.m3c.$(b,this.J6j(this.S0d(a)));return this.m3c.ga(b)}t0b(a){const b=a.id;if(this.vua.Kb(b))return this.vua.ga(b);var c=a.ta(zb.a.LIa,null);if(!c)return null;let f=null;const l=Qq.h0f(c);l&&a.Eh&&(f=a.Eh.te(l));a=null;if(f)a=mk.a.BPa(f,zb.a.tableStyle);else if(c=this.jda.Jdg("{"+c.toString()+"}"))a=c.vua;a&&this.vua.$(b,a);return a}OZd(a){return a.tableLook}e7(a,b){a=this.Fk.bob(a,b);return this.d8.Ie(a,
0)}pXi(a){if(a.Sa(zb.a.QQ))switch(a.ta(zb.a.QQ,0)){case 2:return"bottom";case 1:return"middle"}return"top"}E6f(a){var b=null;if(!a)return null;if(a.cellShading){var c=UK(a.cellShading);Hz(c)||(b=c)}b||(b=this.Bra(a,zb.a.cellShading,rl.a.Gpb));c=Object(ua.a)(131,this.uc.Sg(a));b=this.Fk.Anb(b,c?c.Ye:null,this.CZc);a.rowIndex||1!==a.pi||za.a.J(9242778,822,50,"CellId={0} BGCss={1}",a.id.toString(),b);return b}AKc(a){var b=null;let c=null;if(!a)return null;if(a.cellShading){const f=UK(a.cellShading);
Hz(f)||(b=f)}b||(b=this.Bra(a,zb.a.cellShading,rl.a.Gpb));a=(a=Object(ua.a)(131,this.uc.Sg(a)))?a.Ye:null;(b=b.solidFillField)&&(c=If.Box4ColorHelper.EBa(b,a));return c}B6a(a){var b=null;var c=Object(ua.a)(5,a);c&&(a=c.ta(Sb.a.listLevel,qg.a.zCa),c=this.Ib.Jc(c),c.oc(7)&&Cd.TableReader.Nr(c)&&(c=Object(ua.a)(Pl.TableCellNode,c.Og(16))))&&(this.b5g(c),b=1+a,b=this.JG.z6f(c,this.oNc(c),b));return{tableStyle:b,N3a:null}}Qcj(a){let b=mk.a.Bi(a,zb.a.cellShading,rl.a.Gpb);if(Hz(b)){const c=this.t0b(a);
c&&(b=this.Fk.DYd(c))}a=Object(ua.a)(131,this.uc.Sg(a));return this.Fk.Anb(b,a?a.Ye:null)}b_i(a){return!qd.a("PPTOEnableTableDiagonalBorders")||2!==a&&1!==a?rl.a.Fpb:rl.a.PBi}n0i(a,b){if(this.y1j&&this.oo.uS&&!this.LAj(a,b))return new Fx("","");var c=Object(ua.a)(123,a);if(({d3a:w,c3a:F,Inb:S}=Wp.$Pa(b)).returnValue)if(this.RTa&&qd.a("TableBordersLocalRenderingFix")){var f=this.Bra(c,w,this.b_i(b),!0);var l=this.Bra(c,S,rl.a.Epb,!0);var w=c.ta(w,f);f={};if(qd.a("FixClearTableBorder")){let fa=this.Ib.Jc(c);
fa.oc(14);if(fa.Og(14).Sa(zb.a.LIa)){f.Color="##T,0,0,0";f=If.Box4ColorHelper.q0(f);f=this.Bra(c,F,f,!0);var F=mk.a.Bi(c,F,f);F=If.Box4ColorHelper.Fwa(F);a=this.uc.Sg(a);a=(a=If.Box4ColorHelper.CL(F,a?a.Ye:null))?If.Box4ColorHelper.dna(a):null}else f.Color="#000000",a=If.Box4ColorHelper.q0(f),a=If.Box4ColorHelper.Vqa(a)}else f.Color="##T,0,0,0",f=If.Box4ColorHelper.q0(f),f=this.Bra(c,F,f,!0),F=mk.a.Bi(c,F,f),F=If.Box4ColorHelper.Fwa(F),a=this.uc.Sg(a),a=(a=If.Box4ColorHelper.CL(F,a?a.Ye:null))?If.Box4ColorHelper.dna(a):
null;l=c.ta(S,l)}else l=this.Fk.f1d(b,c),w=l.Sa(w)?l.getValue(w):this.Bra(c,w,rl.a.Fpb,!0),a=this.w6f(l,c,F),l=l.Sa(S)?l.getValue(S):this.Bra(c,S,rl.a.Epb,!0);else w=rl.a.Fpb,a=rl.a.KFc,l=rl.a.Epb;5!==b||a.xC===Jb.a.auto||c.rowIndex||1!==c.pi||za.a.J(9242780,822,50,"CellId={0} BGR={1} Alpha={2}",c.id.toString(),a.xC,a.alpha);var S=!1;a.xC!==Jb.a.auto||7!==b&&5!==b||(f=this.Ib.Jc(c),f.oc(14),7===b?(F=zb.a.Pwa,f=this.Fk.xgj(f)):(F=zb.a.Qwa,f=this.Fk.Cgj(f)),f&&(c=this.Fk.f1d(b,c),this.w6f(c,f,F).xC===
Jb.a.auto&&(l=rl.a.Epb,w=rl.a.Wgj,a=rl.a.Vgj,S=!0)));c=this.Fk.AWd(l,w,a);return S&&7===b?new Fx(c,"Top"):S&&5===b?new Fx(c,"Left"):new Fx(c,"")}jLc(a,b){switch(b){case 7:b=zb.a.Swa;break;case 6:b=zb.a.Fea;break;case 0:b=zb.a.Eea;break;case 5:b=zb.a.Rwa;break;default:b=null}const c=this.Bra(a,b,rl.a.Fpb,!0);return a.ta(b,c)}LAj(a,b){if(!a||a.isGhostCell||2===b||1===b)return!0;const c=this.Ib.Jc(a);if(!c.oc(14))return!0;var f=c.lw(14);if(!f.hp())return!0;const l=a.rowSpan,w=a.colSpan;if(1===l&&1===
w)return!0;f=this.wc.Ncj(f);const F=new cr.a;F.ge=this.uua.O9i(c);F.Tf=F.ge+l;F.ae=this.lF.KKc(Object(ua.a)(123,a));F.Lf=F.ae+w;switch(b){default:za.a.J(560562957,822,15," Unknown position type: {0} ",b);break;case 5:if(!F.ae||1===l)break;if(4!==(f.Kr(F.ge,F.ae-1)&4)||8!==(f.Kr(F.Tf-1,F.ae-1)&8))break;for(a=F.ge+1;a<F.Tf;++a)if(4===(f.Kr(a,F.ae-1)&4))return!1;break;case 6:if(F.Lf===f.xQ||1===l)break;if(4!==(f.Kr(F.ge,F.Lf)&4)||8!==(f.Kr(F.Tf-1,F.Lf)&8))break;for(a=F.ge+1;a<F.Tf;++a)if(4===(f.Kr(a,
F.Lf)&4))return!1;break;case 7:if(!F.ge||1===w)break;if(1!==(f.Kr(F.ge-1,F.ae)&1)||2!==(f.Kr(F.ge-1,F.Lf-1)&2))break;for(a=F.ae+1;a<F.Lf;++a)if(1===(f.Kr(F.ge-1,a)&1))return!1;break;case 0:if(F.Tf!==f.dO&&1!==w&&1===(f.Kr(F.Tf,F.ae)&1)&&2===(f.Kr(F.Tf,F.Lf-1)&2))for(a=F.ae+1;a<F.Lf;++a)if(1===(f.Kr(F.Tf,a)&1))return!1}return!0}w6f(a,b,c){if(this.RTa){const f=If.Box4ColorHelper.q0({Color:"##T,0,0,0"});a=mk.a.Bi(a,c,f);a=If.Box4ColorHelper.Fwa(a);b=this.uc.Sg(b);b=(b=If.Box4ColorHelper.CL(a,b?b.Ye:
null))?If.Box4ColorHelper.dna(b):null}else a.Sa(c)?(b=a.Uh(c),b=Object(Ca.a)(Jb.a,b)?b:new Jb.a(a.getValue(c))):b=this.Bra(b,c,rl.a.KFc,!0);this.CZc&&(b=new Jb.a(0,b.alpha));return b}E2b(a){const b=this.NEa?this.Ib.IZd(a):this.Ib.Jc(a);let c=Object(ua.a)(156,b.Ii());for(a=Object(ua.a)(182,a);c;)c.Sdd=!1,c=Object(ua.a)(156,b.fp());this.Nyj(a);this.NEa?this.wyj(a):a.Pba(4)}wyj(a){if(a&&a.isConnected)for(a=this.Ib.IZd(a),a=sh.a.Gu(a);a.moveNext();)a.currentNode.anchor.$q(4)}Dxl(a){a&&(this.oNc(a),this.t0b(a),
this.mNc(a))}Bra(a,b,c,f=!1){if(!a)return c;var l=this.Ib.Jc(a);l.oc(14);l=l.Og(14);var w=l.id;if(this.Zxb&&f){if(!l.Sa(zb.a.LIa))return c;w=a.rowIndex;a=a.pi;return(a=this.mNc(l).QWi(l,w,a))&&a.Sa(b)?a.Uh(b):c}this.b5g(a);f=a.UT;if(!f){if(!l.Sa(zb.a.LIa))return c;f=a.rowIndex;let F=a.pi;const S=a.rowSpan,fa=a.colSpan;this.r3c.Kb(w)||this.r3c.$(w,this.W6j(this.S0d(l)));f=this.r3c.ga(w).tXd(f,F,S,fa);a.UT=f}return f&&f.Sa(b)?f.Uh(b):c}Zfi(a){const b=this.Ib.MPa();b.set(a);let c=0,f=Object(ua.a)(156,
b.yb(1));for(;f;)f.rowIndex=c,c++,f=Object(ua.a)(156,b.fp());a.ulc=!0}exk(a){let b=0;const c=a.rowIndex,f=this.Ib.MPa();f.set(a);let l=Object(ua.a)(123,f.yb(1));for(;l;)l.rowIndex=c,l.pi=b,l.UT=null,this.JG.NQk(l),l.qZf(),l=Object(ua.a)(123,f.fp()),b++;a.Sdd=!0}b5g(a){var b=this.Ib.Jc(a);b.oc(14);a=Object(ua.a)(156,b.Og(15));(b=Object(ua.a)(182,b.Og(14)))&&!b.ulc&&this.Zfi(b);a&&!a.Sdd&&this.exk(a)}}Object(e.a)(Jz,"TableStyleReader",null,[1283,1284,1285]);class Cl extends dm{constructor(a,b,c,f,l,
w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc){super(a,b,c);this.y_c=this.Qz=this.Hzb=this.Wsa=this.yG=null;this.vac=l;this.Fk=w;this.oo=F;this.we=S;this.m_=[];this.qc=f;this.Jab=pb;this.hc=Mb;this.uc=hc;this.Xi=kc;this.ayb=xa.pptIsTableColumnRowResizeHandleRenderedByCSSEnabled;this.Kje=xa.pptComplexTableLayoutSyncEnabled;this.ZZ=xa.kia;this.PLg=Za;this.wc=Ec;this.Ib=Hc;this.Vke=xa.F9;this.p_c=xa.Pth;if(Dc)this.Qz=Dc;else throw Error.argumentNull("slideDimensionsHelper");if(this.Qc.Po){if(this.yG=fa?fa(a):
null)this.yG.lyh(),this.pk&&this.pk.IT&&(this.yG.zai(this,this.pk.IT,this.table),this.yG.Rx(!this.hc.An));qd.a("DeprecateIE.TableViewElement.ctor")||!this.oo.m8a&&!this.oo.o8a||(this.htmlElement.style.backgroundColor="rgba(0,0,0,0)")}this.pk&&(this.pk.x2h(Object(C.a)(this,this.PZg,"onShapeEnterTextEditing")),this.pk.xCf(Object(C.a)(this,this.YZg,"onShapeSelectionChanged")),this.pk.z2h(Object(C.a)(this,this.QZg,"onShapeExitTextEditing")),this.pk.$1h(Object(C.a)(this,this.mVg,"onAfterDraw")),this.pk.G3h(Object(C.a)(this,
this.kZg,"onReadModeChanged")),this.pk.v2h(Object(C.a)(this,this.JWg,"onDisplayOnActiveSlide")))}get uki(){return this.yG}JWg(){this.$Ne()}get pk(){if(this.Wsa)return this.Wsa;if(this.Qc.Po){const a=eh.a.nb(this.Qc.Na,this.gb);a.af();a.ZWa();this.Wsa=Object(ua.a)(133,a.cOa)}return this.Wsa}C_d(){if(!this.p_c)return 1;var a=this.uc.Sg(this.gb);if(!a)return 1;var b=a.pc(this.Na);if(!b)return 1;b=b.Naa?b.Naa.za.style.visibility===Ei.a.visible:!1;var c=new $q.a(a.Up,a.Gk);if(!this.Qz)return 1;({FQ:b}=
this.Qz.c0b(c,b));c=this.Xi.YF;a=this.qc.dNc(a)*c;return b/a}Pgh(a){if(1!==a&&this.p_c){var b=this.wc.fia(this.gb);for(var c of b)b=this.Gd.Ed.Ie(c.ta(zb.a.Nt,0),1)*a,c.pc(this.Na).htmlElement.style.height=b+"px";c=Ln.b(this.gb);for(b=0;b<c.length;b++){const f=this.Gd.Ed.Ie(c[b],0)*a;this.zDc.childNodes[b].style.width=f+"px"}}}eA(a){super.eA(a);this.Pgh(this.C_d());this.qvh(this.Jab.bub?!!this.pk&&this.pk.sK()&&(this.pk.EA||this.pk.Bn):!!this.pk&&this.pk.Bn)}vT(){const a=this.vac,b=Ln.b(this.gb),
c=Cd.TableReader.ui(this.gb);let f=0;for(let l=0;l<c;l++)f+=Math.max(a.e7(this.gb,l),this.Gd.Ed.Ie(b[l],0));return new uj.a(0,f,0)}i5(a){super.i5(a);if(this.Qc.Po&&(a=this.PLg.ZMc(this.gb,this.Na))&&0!==a.IQc){const b=this.gb;if(b.jN)return;this.Kje?a.dAh(b):a.IQc&2?a.dAh(b):a.ksl(b,c=>{c&&this.$Ne()})}this.$Ne()}$Ne(){this.yG&&this.pk&&this.pk.Bn&&this.ZNe()}jlh(a,b){Object(ua.a)(Jz,Mc.StyleReader.Oq);if(1!==b)for(var c=0;c<this.l0.childNodes.length;c++){var f=this.l0.childNodes[c];if(!f||"TR"!==
f.tagName.toUpperCase())continue;const w=f.offsetHeight*b;var l=this.Fk.xKd(this.gb,c);l=this.Gd.Ed.Ie(l,1);f.style.height=(w<l?0:w)+"px"}if(1!==a)for(b=0;b<this.zDc.childNodes.length;b++)c=Ne.a.Zm(this.zDc.childNodes[b].style.width),f=this.Fk.bob(this.gb,b),f=this.Gd.Ed.Ie(f,0),this.Ejc(b,Math.max(c*a,f))}G9i(a){a>this.l0.childNodes.length&&Error.argumentOutOfRange("rowIdx");const b=this.l0.childNodes[a];b&&"TR"===b.tagName.toUpperCase()||Error.invalidOperation(String.format("Child node '{0}' is not a table row",
a));return Ne.a.Zm(b.style.height)}p0b(){return qi.a.qba(this.we.ei(this.table))}get dGj(){const a=this.PLg.ZMc(this.gb,this.Na);return!a||0===a.IQc}ccg(){const a=[0];for(let b=1;b<=this.l0.childNodes.length;++b)a[b]=a[b-1]+this.l0.childNodes[b-1].offsetHeight;return a}W6f(){const a=[0];for(let b=1;b<=this.zDc.childNodes.length;++b)a[b]=a[b-1]+this.JKc(b-1);return a}ODe(a){if(14!==this.gb.type)za.a.J(8959130,808,10,"The source node of the table view element is not a table node but {0}",this.gb.type);
else if(this.gb.ta(zb.a.complexTable,!0))za.a.J(8959135,808,50,"Disable column resizing for table with merged cells");else{super.ODe(a);a=new mb.GraphIterator;a.set(this.gb);Fd.moveToFirstRow(a);Fd.moveToFirstColumn(a);let b=1;const c=this.Gd.Ed.Ie(this.Fk.NZb(a.currentNode,6),0);for(;!Ce.isLastCellInRow(a);){Fd.moveToNextColumn(a);const f=this.xu[b++],l=Ne.a.Nc(-1*c);Cd.TableReader.Vl(this.gb)?f.style.marginRight=l:f.style.marginLeft=l}this.xu.length!==b&&za.a.J(8959133,808,10,"Table has inconsistent column resize handles: {0} handles, {1} columns",
this.xu.length,b)}}Oea(a){super.Oea(a);this.Qc.Al||this.dPk();this.gb.ta(zb.a.complexTable,!0)||kn.a.Uu||this.cPk()}dispose(){super.dispose();this.yG&&(this.yG.dispose(),this.yG=null);this.pk&&(this.pk.eNk(Object(C.a)(this,this.PZg,"onShapeEnterTextEditing")),this.pk.gch(Object(C.a)(this,this.YZg,"onShapeSelectionChanged")),this.pk.fNk(Object(C.a)(this,this.QZg,"onShapeExitTextEditing")),this.pk.OMk(Object(C.a)(this,this.mVg,"onAfterDraw")),this.pk.SNk(Object(C.a)(this,this.kZg,"onReadModeChanged")),
this.pk.bNk(Object(C.a)(this,this.JWg,"onDisplayOnActiveSlide")));this.Wsa=null}mVg(){this.pk.mN&&this.ZNe(!0)}rii(){if(this.Vke){var a=this.gb,b=a.r0b();if(a.ulc)for(const c of b){a=c;if(!a)continue;a=a.pc(this.Na);if(!a)continue;b=this.vac.jLc(c,7);const f=this.vac.jLc(c,6),l=this.vac.jLc(c,0),w=this.vac.jLc(c,5);0===b&&a.Vbd("Top");0===f&&a.Vbd("Right");0===l&&a.Vbd("Bottom");0===w&&a.Vbd("Left")}}}YZg(a,b){this.qvh(b.isSelected);a=this.table;this.rii();b.isSelected?Sys.UI.DomElement.containsCssClass(a,
"Selected_Table")||Sys.UI.DomElement.addCssClass(a,"Selected_Table"):Sys.UI.DomElement.containsCssClass(a,"Selected_Table")&&Sys.UI.DomElement.removeCssClass(a,"Selected_Table")}kZg(a,b){this.yG&&this.yG.Rx(b.CJj)}qvh(a){if(this.yG)if(this.ZZ){const b=this.Ib.Jc(this.gb);b.af();b.ZWa().getValue(zb.a.isResizable)?this.yG.visible=a:this.yG.visible=!1}else this.yG.visible=a;this.pk&&this.pk.Jd&&this.pk.shapeNode&&this.pk.shapeNode.UP&&(this.pk.Jd.visible=a)}cPk(){if(!this.m_.length){var a=this.TNa();
Sys.UI.DomElement.addCssClass(a,"First");this.m_.push(a);a=this.Ayi();Sys.UI.DomElement.addCssClass(Cl.v9f(a),"Last");this.m_.push(a)}var b=this.dQa();a=b.length;var c=a+1-this.m_.length;if(!(0>=a)){if(0<c)for(var f=0;f<c;f++){let l=this.TNa();this.m_.splice(this.m_.length-1,0,l)}if(0>c){for(f=0;f<c;f++)this.gEb(this.m_[f+1]);this.m_.splice(1,c)}for(c=0;c<a;c++)f=b[c].firstChild,f.insertBefore(this.m_[c],f.firstChild);b=b[a-1].firstChild;b.insertBefore(this.m_[a],b.firstChild);this.v5h()}}v5h(){const a=
new mb.GraphIterator;a.set(this.gb);Fd.moveToFirstRow(a);Fd.moveToFirstColumn(a);let b=1;for(;b<this.m_.length;){var c=this.Gd.Ed.Ie(this.Fk.NZb(a.currentNode,5),0),f=this.Gd.Ed.Ie(this.Fk.NZb(a.currentNode,0),1);let l=this.m_[b];Cl.qMj(l)&&(l=Cl.v9f(l));c=Ne.a.Nc(-1*c);f=Ne.a.Nc(-1*f-(b===this.m_.length-1?4:0));Cd.TableReader.Vl(this.gb)?l.style.marginRight=c:l.style.marginLeft=c;l.style.marginTop=f;Fd.moveToNextRow(a);b++}}dPk(){if(!this.Hzb){const a=String.format("url('{0}'), pointer",py.a.box4Image("RowSelect.cur"));
this.Hzb=this.Gd.createElement("div");this.Hzb.className=Ml.a.xhl;lf.c(this.Hzb,!0);const b=this.Gd.createElement("div");b.className=Ml.a.hOe;b.style.cursor=a;this.Hzb.appendChild(b);this.table.appendChild(this.Hzb)}}I9i(){return this.dQa()}TNa(){const a=this.Gd.createElement("div");a.className="TableRowResizeHandle";a.style.width="100%";lf.c(a,!0);return a}Ayi(){const a=this.Gd.createElement("div");a.className="TableRowResizeAnchor";const b=this.TNa();a.appendChild(b);lf.c(a,!0);return a}gEb(a){K.a.sHa(a);
ya.a.hO(a)}Fcj(a){var b=this.uc.Sg(this.gb);let c=this.Xi.YF;b&&b.ow&&null!=b.ow.zr&&(c=b.ow.zr);b=this.qc.dNc(this.uc.Sg(this.gb))*c;a=a.copy();a.move(-a.fc,-a.ic);a.scale(1/b,1/b);return a}PZg(){this.table.clientWidth&&this.ZNe(!0);!this.Jab.bub&&this.yG&&(this.yG.visible=!0,this.pk&&this.pk.Jd&&(this.pk.Jd.visible=!0));this.pk&&this.pk.sK()&&!Sys.UI.DomElement.containsCssClass(this.table,"Selected_Table")&&Sys.UI.DomElement.addCssClass(this.table,"Selected_Table")}QZg(){this.yG&&(this.yG.visible=
!1);this.pk&&this.pk.Jd&&(this.pk.Jd.visible=!1)}ZNe(a=!1){var b=this.p0b();let c=ri.a.Umd;this.y_c&&(c=qi.a.A_b(b,this.y_c));const f=ic.a.dUe;a=!!this.pk&&(!this.y_c||!f.equals(ic.a.dUe)||!c.equals(ri.a.Umd)||a);this.y_c=b;if(a&&(a=this.pk.MRe,b=qi.a.A_b(this.Fcj(b),a),this.pk.setOffsets(b,!0),!qd.a("DeprecateIE.TableViewElement.SynchronizeViews")&&this.oo.m8a&&0<this.l0.childNodes.length))for(b=this.l0.childNodes[0].offsetWidth,a=0;a<this.m_.length;a++)this.m_[a].style.width=b+"px";this.yG&&this.yG.xm();
this.ayb||this.VSe()}Z_d(){return this.ayb?null:super.Z_d()}Jze(a){if(this.ayb){var b=this.wc.Zj(this.gb);a=Object(ua.a)(mb.GraphIterator,this.Ib.Jc(this.gb));Fd.forEachCellInTable(a,(c,f,l)=>{c=c.currentNode;const w=c.pc(this.Na);w&&w.enc(0,0,0,0,!f,f+c.rowSpan===b,!l);return!0})}else super.Jze(a)}P5i(a){let b=-1;var c=Cd.TableReader.ui(this.gb),f=Ln.b(this.gb);const l=Array(c);for(let w=0;w<c;w++)l[w]=Math.floor(this.Gd.Ed.Ie(f[w],0));if(Cd.TableReader.Vl(this.gb))if(a<=Sys.UI.DomElement.getLocation(this.l0.firstChild.lastChild).x)b=
c-1;else{a-=Sys.UI.DomElement.getLocation(this.l0.firstChild.lastChild).x;for(--c;0<=c;c--)if(a>=l[c])a-=l[c];else{b=c;break}-1===b&&(b=0)}else if(a<=Sys.UI.DomElement.getLocation(this.l0.firstChild.firstChild).x)b=0;else{a-=Sys.UI.DomElement.getLocation(this.l0.firstChild.firstChild).x;for(f=0;f<c;f++)if(a>=l[f])a-=l[f];else{b=f;break}-1===b&&(b=c-1)}return b}Ghh(a,b,c=!0){const f=mb.GraphIterator.nb(this.gb),l=new mb.GraphIterator,w=new Oe.GraphTransaction(2);w.Ry(f);Fd.moveToFirstRow(f);c?(Fd.moveToRowByIndex(f,
a),Fd.moveToFirstColumn(f)):Fd.moveToColumnByIndex(f,a);l.Pc(f);c?(Fd.moveToRowByIndex(l,b),Fd.moveToLastColumn(l)):(Fd.moveToColumnByIndex(l,b),Fd.moveToLastRow(l));a=fd.SelectionFactory.lWb(f,l);this.Qc.Eb.UD(a);w.dispose()}static K9i(a){return Cl.L9i(a,kn.a.Uu)}static L9i(a,b){return b?Cl.J9i(a):Cl.M9i(a)}static M9i(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){Cl.s8d(a)||Cl.c9d(a)||(b=b.previousSibling);break}b=b.parentNode}return uv.Neg(b)}static J9i(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){if(Cl.c9d(a)){if((a=
a.parentNode)&&void 0!==a.rowSpan&&null!==a.rowSpan){a=a.rowSpan;for(let c=1;c<a&&b;c++)b=b.nextSibling}}else Cl.s8d(a)||(b=b.previousSibling);break}b=b.parentNode}return b?uv.Neg(b):null}static P2(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnResizeHandle")}static TRa(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeHandle")}static qMj(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeAnchor")}static vsa(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnHandle")}static I4b(a){return Sys.UI.DomElement.containsCssClass(a,
Ml.a.hOe)}static Mcj(a){for(;a;){if("TABLE"===a.nodeName.toUpperCase())return a;a=a.parentNode}return null}static s8d(a){return Sys.UI.DomElement.containsCssClass(a,"First")}static c9d(a){return Sys.UI.DomElement.containsCssClass(a,"Last")}static qsg(a){return Sys.UI.DomElement.containsCssClass(a,"FirstLeft")}static v9f(a){return a.firstChild}}Object(e.a)(Cl,"TableViewElement",dm,[1277,1278,1279,435,274,109]);class nL extends hL.a{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){super(a,b);this.VIf="ShowDashedLine";
this.tka=this.Xd=this.Rd=this.JKg=this.DKg=this.RKg=this.vab=this.Gme=this.Fme=this.fe=this.LKg=null;this.GMg=this.FMg=this.I3=this.G3=this.Wab=this.Zca=0;this.X8=c;this.N$a=f;this.Xr=l;this.wc=w;this.sa=F;this.Rz=S;this.ia=fa;this.qp=Za;this.H8b=this.Nje=!1;this.z1j=xa}get MEe(){this.RLf();return this.fe.offsetLeft}set MEe(a){this.RLf();this.fe.style.left=Ne.a.Nc(a)}get zoom(){return 1}pu(a){const b=super.pu(a);if(b&&this.pM){this.sKd(a.Hc);Sys.UI.DomElement.addCssClass(this.fe,this.VIf);if(this.Q$=
Cl.qsg(a.Hc))this.ni=0,this.pE=this.Zk.JKc(this.ni);this.Rd=this.Zk.pk;this.Xd=this.wc.s0b(this.Rd.gb);this.H8b=!1;this.RJe()&&this.mYi(a)}else b&&!this.pM&&(a=a.Hc,Cl.vsa(a)&&(za.a.J(41546708,816,50,"Drag from table column handle"),this.ni=parseInt(a.parentNode.getAttribute("columnindex").toString())));b&&this.qp&&this.ia.processAction(D.a.Mha,2);return b}Xv(a){this.pM?(a=this.WJf(a.clientPoint.x),this.MEe=this.LKg+(a-this.pE)*(this.Q$?-1:1)):(a=this.Zk.P5i(a.clientPoint.x),this.Zk.Ghh(this.ni,a,
!1));return!0}In(a){if(this.pM){const f=this.X8.wi("UserAction","PPTColumnResize");a&&za.a.J(8959051,822,50,String.format("Start Column resize for table: {0}, IsComplex: {1}",this.Zk.gb.ta(zb.a.UAb,""),this.Zk.gb.hp()));const l=new Oe.GraphTransaction(15);l.hd(this.Zk.gb);const w=this.Zk.gb.ta(ob.a.ru,null);var b=this.WJf(a.clientPoint.x),c=this.Zk.Gd.Ed;const F=c.yf(b,0);(this.Q$||this.ni===this.LF-1)&&this.Xr.vXa(this.Zk.gb,this.ni,F);if(this.Q$&&b!==this.pE&&(b=this.pE-b)){this.Rd.setPosition(this.Rd.x+
b,this.Rd.y,!0);b=c.yf(this.Rd.x,0);c=c.yf(this.Rd.y,1);const S=this.Zk.pk.shapeNode;S.My=b;S.Ny=c}!this.Q$&&this.ni<this.LF-1&&this.LIe(F,w);this.vmc();l.dispose();gb.App.Fb.updateCommandUI();this.end();this.Xd?this.Xr.CWa(this.Xd):za.a.J(560047247,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");f&&f.stop();a&&za.a.J(8959053,822,50,String.format("End Column resize for table: {0}, IsComplex: {1}, IsFirstColumnLeftResizeHandle: {2}",this.Zk.gb.ta(zb.a.UAb,""),this.Zk.gb.hp(),
this.Q$))}else a&&gb.App.Fb.K4(a.clientPoint,a.Qf),super.In(a)}Jt(a){super.Jt(a);this.pM&&this.vmc()}Edg(){return null}RLf(){if(!this.fe)throw Error.argumentNull("m_element","Try to use the resize handle before it is initialized");if(!kn.a.P2(this.fe))throw Error.invalidOperation("Element is not the table column resize handle");}sKd(a){this.fe=a;this.LKg=this.MEe;this.Fme=this.fe.style.marginLeft;this.Gme=this.fe.style.marginRight;this.vab=this.fe.style.height;this.RKg=this.fe.style.top;this.DKg=
this.fe.style.bottom;this.JKg=this.fe.style.left;this.fe.style.marginLeft=this.fe.style.marginRight="auto";this.fe.style.top="0";this.fe.style.height="auto";this.fe.style.bottom="0";this.N$a&&(a=kn.a.u0b(a))&&(this.fe.style.top=-a.offsetTop+"px",this.fe.style.bottom=-(this.Zk.getBounds().height-a.offsetTop-a.offsetHeight)+"px")}vmc(){this.fe&&(Sys.UI.DomElement.removeCssClass(this.fe,this.VIf),this.fe.style.marginLeft=this.Fme,this.fe.style.marginRight=this.Gme,this.Fme=this.Gme="auto",this.fe.style.left=
this.z1j?this.JKg:"auto",this.fe.style.top=this.RKg,this.fe.style.height=this.vab,this.fe.style.bottom=this.DKg,this.fe=null)}mYi(a){this.H8b=this.Nje=!1;a=a.Hc;if(kn.a.P2(a)){var b=null,c=null;({d9a:b,Beb:c}=this.lYi(a,b,c)).returnValue&&this.WYi(b,c)&&this.Y_d()&&this.Xd&&(a=this.wc.ui(this.Xd),b=this.wc.Zj(this.Xd),0<=this.Zca&&this.Zca<b&&0<=this.Wab&&this.Wab<b&&0<=this.G3&&this.G3<a&&0<=this.I3&&this.I3<a&&(this.H8b=!0))}}lYi(a,b,c){if(!kn.a.P2(a)||!this.Xd)return{returnValue:!1,d9a:b,Beb:c};
var f=kn.a.u0b(a);f=lf.a(f);this.tka=Object(ua.a)(Pl.TableCellNode,f.gb);if(!this.tka)return{returnValue:!1,d9a:b,Beb:c};f=this.XLc(this.tka);if(0>f||f>=this.wc.ui(this.Xd))return{returnValue:!1,d9a:b,Beb:c};const l=this.tka.rowIndex;if(0>l||l>=this.wc.Zj(this.Xd))return{returnValue:!1,d9a:b,Beb:c};if(Cl.qsg(a))return{returnValue:!1,d9a:null,Beb:c};b=this.Xd.hf(l,f);if(f===this.wc.ui(this.Xd)-1)return{returnValue:!1,d9a:b,Beb:null};c=this.Xd.hf(l,f+1);return{returnValue:!0,d9a:b,Beb:c}}WYi(a,b){if(!this.Xd||
!a||!b)return!1;this.Zca=a.rowIndex;if(0>this.Zca||this.Zca>=this.wc.Zj(this.Xd))return!1;this.Wab=this.Zca;this.G3=this.c_b(a);if(0>this.G3||this.G3>=this.wc.ui(this.Xd))return!1;this.I3=this.XLc(b);if(0>this.I3||this.I3>=this.wc.ui(this.Xd))return!1;var c=this.cVi(a,b);a=c?this.GWi(a,b):!1;if(c=c&&a)this.Nje=this.SCj(b.pi);return c}SCj(a){let b=!0;if(0<this.Zca)for(var c=this.Zca-1;0<=c;){var f=this.Xd.hf(c,a);if(f&&!f.isGhostCell){b=!1;break}--c}if(this.Wab<this.Xd.oX-1)for(c=this.Zca+1;c<=this.Xd.oX-
1;){if((f=this.Xd.hf(c,a))&&!f.isGhostCell){b=!1;break}c+=1}return b}Y_d(){if(!this.Xd)return!1;const a=this.wc.ui(this.Xd);if(0>this.G3||this.G3>=a||0>this.I3||this.I3>=a||0>this.ni||this.ni>=a||0>this.ni+1||this.ni+1>=a)return!1;this.FMg=this.O1d(this.Xd,this.G3,this.ni)-this.XZd(this.Xd,this.G3);this.GMg=this.O1d(this.Xd,this.I3,this.ni+1)-this.XZd(this.Xd,this.I3);return!0}O1d(a,b,c){if(b>c)return this.O1d(a,c,b);if(!a||0>b||b>=this.wc.ui(a)||0>c||c>=this.wc.ui(a))return-1;a=a.FXd;let f=0;for(;b<=
c;b++)f+=a[b];return Math.floor(this.Zk.Gd.Ed.Ie(f,0))}XZd(a,b){return Mc.StyleReader.Oq?Mc.StyleReader.Oq.e7(a,b):Mn.a.$id}VBa(a,b){return this.Zk.Gd.Ed.yf(this.XZd(a,b),0)}cVi(a,b){if(!a||!b)return!1;a=a.VZb();const c=b.pi;for(b=b.VZb();b&&(!b.isGhostCell||this.c_b(b)===c);)this.Zca--,this.G3=Math.max(this.G3,this.c_b(a)),this.I3=Math.min(this.I3,this.XLc(b)),a=a.VZb(),b=b.VZb();return!0}GWi(a,b){if(!a||!b)return!1;a=a.yKc();const c=b.pi;for(b=b.yKc();b&&(!a.isGhostCell||this.c_b(b)===c);)this.Wab++,
this.G3=Math.max(this.G3,this.c_b(a)),this.I3=Math.min(this.I3,this.XLc(b)),a=a.yKc(),b=b.yKc();return!0}c_b(a){return a?(a=a.ly())?a.pi:-1:-1}XLc(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.ly());a=null;b&&(a=b.nZd(2));return a?a.pi:-1}WJf(a){this.RJe()&&this.H8b?(a=this.Zk.gb.hKj?Math.floor((this.S5-a)/this.zoom)+this.pE:Math.floor((a-this.S5)/this.zoom)+this.pE,a=Math.min(a,this.pE+this.GMg),a=Math.max(a,this.pE-this.FMg)):a=this.yKd(a);return a}LIe(a,b){if(this.RJe()&&this.H8b){if(!this.sa.rG()){var c=
fd.SelectionFactory.Lg(Object(ua.a)(fg.a,this.tka.ZYb),0);this.sa.setSelection(c)}let f=c=-1,l=-1;({nXf:c,HWf:f,IWf:l}=this.b0i(a-b[this.ni],b,c,f,l));this.Nje&&(c===this.ni&&Math.abs(f)>=this.VBa(this.Xd,c)||c===this.ni+1&&c<this.wc.ui(this.Xd)-1&&Math.abs(l)>=this.VBa(this.Xd,c+1)||c===this.ni+1&&c===this.wc.ui(this.Xd)-1)?(za.a.J(40137283,815,50,"DragAcrossColumn: scenario-1, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ni.toString(),
c.toString(),f.toString(),l.toString()),a=b[this.ni]+b[this.ni+1],c===this.ni?(f=Math.max(f,this.VBa(this.Xd,c)),l=a-f):c===this.ni+1&&(l=Math.max(l,this.VBa(this.Xd,c)),f=a-l),this.Xr.vXa(this.Xd,this.ni,f),this.Xr.vXa(this.Xd,this.ni+1,l)):(c>this.G3&&Math.abs(f)<this.VBa(this.Xd,c)?(za.a.J(40137285,815,50,"DragAcrossColumn: scenario-2, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ni.toString(),c.toString(),f.toString(),l.toString()),
this.dcb(c,this.ni+1)):c<this.I3&&Math.abs(l)<this.VBa(this.Xd,c+1)?(za.a.J(40137287,815,50,"DragAcrossColumn: scenario-3, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ni.toString(),c.toString(),f.toString(),l.toString()),this.dcb(c+1,this.ni+1)):(za.a.J(40137289,815,50,"DragAcrossColumn: scenario-4, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ni.toString(),
c.toString(),f.toString(),l.toString()),this.idl(c,f,l)),this.Xr.kDe(this.Xd),a=mb.GraphIterator.nb(this.Xd),this.Xr.URe(a),this.Xd.Pba(511),this.Rz.E2b(this.Xd))}else this.Xr.vXa(this.Xd,this.ni,a),this.Xr.vXa(this.Xd,this.ni+1,b[this.ni]+b[this.ni+1]-a)}b0i(a,b,c,f,l){if(!a)return c=this.ni,f=b[this.ni],{nXf:c,HWf:f,IWf:0};f=0;if(0<a){for(c=this.ni;f<=a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=this.ni+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{nXf:c,HWf:f,IWf:l}}dcb(a,b){if(b!==a){var c=this.YYi(b-
1);for(let f=this.Zca;f<=this.Wab;f++){const l=this.Xd.hf(f,b),w=this.Xd.hf(f,a);this.Vre(c[f],l,w)}}}Vre(a,b,c){if(c.isGhostCell){var f=b.rowSpan,l=a.colSpan+c.pi-b.pi,w=a.colSpan+b.colSpan-l;sm.c(Object(ua.a)(fg.a,b),Object(ua.a)(fg.a,c),this.Xr.gLd);sm.c(Object(ua.a)(fg.a,b),Object(ua.a)(fg.a,c),[zb.a.nHa]);var F=mb.GraphIterator.nb(c);F.af();var S=new mb.GraphIterator;S.set(Object(ua.a)(fg.a,b));S.yb(1)&&sm.h(F,null,1,1,S,-1);c.isGhostCell=b.isGhostCell;this.xVd(F);b.Kn(zb.a.rowSpan,zb.a.colSpan);
b.isGhostCell=!0;c.isGhostCell||(c.colSpan=w,c.rowSpan=f);a.rowIndex===c.rowIndex&&(a.colSpan=l)}}xVd(a){const b=a.currentNode.getValue(zb.a.rowId),c=a.currentNode.getValue(zb.a.cellId);for(a=sh.a.Gu(a);a.moveNext();){const f=a.currentNode.ta(zb.a.cellId,null);a.currentNode.ta(zb.a.rowId,null)&&a.currentNode.setValue(zb.a.rowId,b);f&&a.currentNode.setValue(zb.a.cellId,c)}}idl(a,b,c){var f=mb.GraphIterator.nb(this.Xd);Fd.moveToFirstRow(f);f.Hp(a,1);this.Xr.U5d(f);if(f=this.Xd.ta(ob.a.ru,null))f=Ma.a.clone(f),
b<this.VBa(this.Xd,a)?(b=this.VBa(this.Xd,a),c=f[a]-b):(c=Math.max(c,this.VBa(this.Xd,a+1)),b=f[a]-c),f[a]=b,f[a+1]=c,this.Xd.setValue(ob.a.ru,f);b=this.ni+1;a+=1;a<=b&&(b+=1);this.dcb(a,b)}YYi(a){const b=Array(this.wc.Zj(this.Xd));for(let c=this.Zca;c<=this.Wab;c++){const f=this.Xd.hf(c,a);b[c]=f.ly()}return b}RJe(){return!!this.Xd&&this.Xd.hp()&&!this.Q$&&this.ni<this.LF-1}}Object(e.a)(nL,"PowerPointColumnDragAdapter",hL.a,[]);class KD{constructor(a,b){this.Sw=this.R3=null;this.C9b=this.pab=0;this.xzb=
!1;this.r8=a;this.LZ=b}Tu(a){if(3===a.Qf)return!1;a=a.Hc;return Cl.TRa(a)||Cl.I4b(a)}Jt(){if(this.xzb){const a=new Oe.GraphTransaction(3);a.hd(this.R3.gb);this.R3.source.Su(4,!0);a.dispose()}this.end()}end(){this.r8.PQ()}dispose(){this.R3=null}}Object(e.a)(KD,"CommonRowHandleDragAdapter",null,[223,109]);class oL extends KD{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc){super(a,b);this.cke=this.Qxb=!1;this.GKg=this.XEa=0;this.tka=this.Xd=this.Rd=this.Wta=this.KKg=this.IKg=this.EKg=this.HKg=this.FKg=
null;this.QKg=this.Le=this.EMg=this.DMg=this.F3=this.E3=this.AFa=this.k_=this.Nz=0;this.X8=f;this.pq=c;this.Fk=l;this.N$a=w;this.Xr=F;this.wc=S;this.sa=fa;this.Rz=xa;this.N6j=Za;this.ia=Mb;this.qp=hc;this.PUa=null;this.I8b=this.MZc=this.zZc=!1;this.Lq=pb}pu(a){if(!this.Tu(a))return!1;const b=a.Hc;if(Cl.I4b(b)){za.a.J(41546714,816,50,"drag from table row handle");this.xzb=!1;var c=Cl.Mcj(b);if(!c)return!1;this.Xd=lf.a(c).gb;this.Sw=this.Xd.pc(this.Le);if(!this.Sw)return za.a.J(559723159,816,10,"OnDragStart : m_tableViewElement is null"),
!1;this.QKg=this.Lq.a_d(this.Sw,a.clientPoint);this.LZ.H9c(b);return!0}this.R3=Cl.K9i(b);if(!this.R3)return!1;c=Object(ua.a)(156,this.R3.gb);this.Le=this.R3.Na;this.Xd=c?c.getContainingTable():null;if(!this.Xd)return!1;this.Sw=this.Xd.pc(this.Le);this.PUa=this.N6j.JZd(this.Xd);if(!this.Sw||!this.PUa)return!1;this.Qxb=Cl.s8d(b);this.cke=Cl.c9d(b);this.pab=this.R3.htmlElement.offsetHeight;this.C9b=this.XEa=a.clientPoint.y;this.LZ.Tk(21);this.r8.endEditing(!0,14);this.Rd=this.Sw.pk;this.MZc=this.zZc=
this.I8b=!1;this.xzb=!0;this.SJe()&&this.S9i(b);this.sKd(b);this.qp&&this.ia.processAction(D.a.Mha,2);return!0}Xv(a){this.xzb?(this.XEa=a.clientPoint.y,a=(this.$Jf(this.XEa)-this.pab)*(this.Qxb?-1:1)+this.GKg,this.Wta.style.top=a+"px"):(a=this.Lq.a_d(this.Sw,a.clientPoint),this.Sw.Ghh(this.QKg,a));return!0}In(a){let b=null;a&&(b=this.X8.wi("UserAction","PPTRowResize"),za.a.J(8959056,822,50,String.format("Start Row resize for table: {0}, IsComplex: {1}",this.Sw.gb.ta(zb.a.UAb,""),this.Sw.gb.hp())));
if(this.xzb){var c=this.$Jf(a?a.clientPoint.y:this.XEa),f=new Oe.GraphTransaction(15);if(this.SJe()&&this.I8b&&this.MZc)Me.a.mark(11077),f.hd(this.Xd),this.LIe(c);else{this.R3.gGb(c);var l=this.R3.htmlElement.offsetHeight;Me.a.mark(11077);var w=this.R3.gb;f.hd(w);c=this.r8.Ed;w.setValue(zb.a.Nt,c.yf(l,1));this.Qxb&&l!==this.pab&&(l=this.pab-l)&&(this.Rd.setPosition(this.Rd.x,this.Rd.y+l,!0),l=c.yf(this.Rd.x,0),c=c.yf(this.Rd.y,1),w=this.Sw.pk.shapeNode,w.My=l,w.Ny=c)}this.vmc();f.dispose();gb.App.Fb.updateCommandUI();
Me.a.mark(11078);this.end();this.Xd?this.Xr.CWa(this.Xd):za.a.J(560047246,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");b&&b.stop();a&&za.a.J(8959058,822,50,String.format("End Row resize for table: {0}, IsComplex: {1}",this.Sw.gb.ta(zb.a.UAb,""),this.Sw.gb.hp()))}else a&&gb.App.Fb.K4(a.clientPoint,a.Qf),this.LZ.S_()}Jt(a){a.tQe?(super.Jt(a),this.xzb&&this.vmc()):this.In(null)}end(){this.LZ.S_();super.end()}$Jf(a){a=this.pab+this.pq.jn(a-this.C9b)*(this.Qxb?-1:1);if(this.SJe()&&
this.I8b&&this.MZc)a=Math.min(a,this.pab+this.EMg),a=Math.max(a,this.pab-this.DMg);else{var b=this.Fk.SBc(this.R3.gb);b=this.R3.Gd.Ed.Ie(b,1);a=Math.max(b,a)}return a}sKd(a){this.Wta=a;Sys.UI.DomElement.addCssClass(this.Wta,"ShowDashedLine");this.GKg=a.offsetTop;this.KKg=a.style.marginTop;this.IKg=a.style.width;this.FKg=a.style.left;this.HKg=a.style.top;this.EKg=a.style.bottom;a.style.marginTop="auto";a.style.width="auto";a.style.right=a.style.left="0";a.style.bottom="auto";if(this.N$a){const b=kn.a.u0b(a);
b&&(a.style.left=-b.offsetLeft+"px",a.style.right=-(this.R3.getBounds().width-b.offsetLeft-b.offsetWidth)+"px")}}vmc(){Sys.UI.DomElement.removeCssClass(this.Wta,"ShowDashedLine");this.Wta.style.marginTop=this.KKg;this.Wta.style.width=this.IKg;this.Wta.style.left=this.FKg;this.Wta.style.right="auto";this.Wta.style.top=this.HKg;this.Wta.style.bottom=this.EKg}S9i(a){this.I8b=this.zZc=!1;if(this.Xd&&Cl.TRa(a)){var b=null,c=null;({m2a:b,b3a:c}=this.R9i(a,b,c)).returnValue&&this.XYi(b,c)&&this.Y_d()&&(a=
this.wc.ui(this.Xd),b=this.wc.Zj(this.Xd),0<=this.k_&&this.k_<a&&0<=this.AFa&&this.AFa<a&&0<=this.E3&&this.E3<b&&0<=this.F3&&this.F3<b&&(this.I8b=!0),this.MZc=0<this.k_||this.AFa<a-1?!0:!1)}}R9i(a,b,c){if(!Cl.TRa(a)||!this.Xd)return{returnValue:!1,m2a:b,b3a:c};a=kn.a.u0b(a);a=lf.a(a);this.tka=Object(ua.a)(Pl.TableCellNode,a.gb);if(!this.tka)return{returnValue:!1,m2a:b,b3a:c};a=this.Nz=this.tka.rowIndex-1;if(0>a||a>=this.wc.Zj(this.Xd))return{returnValue:!1,m2a:b,b3a:c};const f=this.tka.pi;if(0>f||
f>=this.wc.ui(this.Xd))return{returnValue:!1,m2a:b,b3a:c};if(this.Qxb)return{returnValue:!1,m2a:null,b3a:c};b=this.Xd.hf(a,f);if(this.cke)return{returnValue:!1,m2a:b,b3a:null};c=this.Xd.hf(a+1,f);return{returnValue:!0,m2a:b,b3a:c}}XYi(a,b){if(!this.Xd||!a||!b)return!1;this.k_=a.pi;if(0>this.k_||this.k_>=this.wc.ui(this.Xd))return!1;this.AFa=this.k_;var c=a.ly();this.E3=c?c.rowIndex:-1;if(0>this.E3||this.E3>=this.wc.Zj(this.Xd))return!1;this.F3=this.oZd(b);if(0>this.F3||this.F3>=this.wc.Zj(this.Xd))return!1;
a=(c=this.S3i(a,b))?this.z9i(a,b):!1;if(a=c&&a)this.zZc=this.TCj(b.rowIndex);return a}Y_d(){if(!this.Xd)return!1;const a=this.wc.Zj(this.Xd);if(0>this.E3||this.E3>=a||0>this.F3||this.F3>=a)return!1;this.DMg=this.ZYd(this.Xd,this.E3,this.Nz)-this.PPa(this.Xd,this.E3);this.EMg=this.ZYd(this.Xd,this.F3,this.Nz+1)-this.PPa(this.Xd,this.F3);return!0}S3i(a,b){if(!a||!b)return!1;a=a.M5a();const c=b.rowIndex;for(b=b.M5a();b&&a;){var f=b.ly();if(b.isGhostCell&&f&&f.rowIndex!==c)break;this.k_--;if(f=a.ly())this.E3=
Math.max(this.E3,f.rowIndex);this.F3=Math.min(this.F3,this.oZd(b));a=a.M5a();b=b.M5a()}return!0}z9i(a,b){if(!a||!b)return!1;a=a.bZ();const c=b.rowIndex;for(b=b.bZ();b&&(!b.isGhostCell||b.ly().rowIndex===c);)this.AFa++,this.E3=Math.max(this.E3,a.ly().rowIndex),this.F3=Math.min(this.F3,this.oZd(b)),a=a.bZ(),b=b.bZ();return!0}TCj(a){let b=!0,c;if(0<this.k_)for((c=this.Xd.hf(a,this.k_))&&(c=c.M5a());c;){if(!c.isGhostCell){b=!1;break}c=c.M5a()}if(this.AFa<this.Xd.v6-1)for((c=this.Xd.hf(a,this.AFa))&&(c=
c.bZ());c;){if(!c.isGhostCell){b=!1;break}c=c.bZ()}return b}oZd(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.ly());return b&&(b=b.nZd(1))?b.rowIndex:-1}ZYd(a,b,c){if(b>c)return this.ZYd(a,c,b);if(!a||0>b||b>=this.wc.Zj(a)||0>c||c>=this.wc.Zj(a))return-1;for(a=0;b<=c;b++)a+=this.PUa[b];return Math.floor(a)}PPa(a,b){a=this.Fk.xKd(a,b);return Math.floor(this.r8.Ed.Ie(a,1))}LIe(a){if(!this.sa.rG()){var b=this.tka.VZb().ly().ZYb;b=fd.SelectionFactory.Lg(Object(ua.a)(fg.a,b),0);this.sa.setSelection(b)}let c=
b=-1;var f=-1;({oXf:b,FWf:c,GWf:f}=this.c0i(a-this.PUa[this.Nz],this.PUa,b,c,f));if(this.zZc&&(b===this.Nz&&Math.abs(c)>=this.PPa(this.Xd,this.Nz)||b===this.Nz+1&&b<this.wc.Zj(this.Xd)&&Math.abs(f)>=this.PPa(this.Xd,this.Nz+1)||b===this.Nz+1&&b===this.wc.Zj(this.Xd)-1)){za.a.J(40379993,815,50,"DragAcrossRow: scenario-1, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.Nz.toString(),b.toString(),c.toString(),f.toString());f=mb.GraphIterator.nb(this.Xd);
this.Vbc(f,this.Nz);a=f.currentNode;var l=this.PUa[this.Nz];const F=a.pc(this.Le);Fd.moveToNextRow(f);f=f.currentNode;var w=this.PUa[this.Nz+1];const S=f.pc(this.Le);w=l+w;l=this.r8.Ed;b===this.Nz+1&&(c+=this.PUa[this.Nz]);F.gGb(Math.floor(c));b=F.htmlElement.offsetHeight;a.setValue(zb.a.Nt,l.yf(b,1));b=w-b;b=Math.max(b,this.PPa(this.Xd,this.Nz+1));S.gGb(Math.floor(b));f.setValue(zb.a.Nt,l.yf(S.htmlElement.offsetHeight,1))}else b>this.E3&&Math.abs(c)<this.PPa(this.Xd,b)?(za.a.J(40379995,815,50,"DragAcrossRow: scenario-2, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",
this.Nz.toString(),b.toString(),c.toString(),f.toString()),this.dcb(b,this.Nz+1)):b<this.F3&&Math.abs(f)<this.PPa(this.Xd,b+1)?(za.a.J(40379997,815,50,"DragAcrossRow: scenario-3, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.Nz.toString(),b.toString(),c.toString(),f.toString()),this.dcb(b+1,this.Nz+1)):(za.a.J(40379999,815,50,"DragAcrossRow: scenario-4, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",
this.Nz.toString(),b.toString(),c.toString(),f.toString()),this.jdl(b,c,f)),this.Xr.kDe(this.Xd),b=mb.GraphIterator.nb(this.Xd),this.Xr.URe(b),this.Xd.Pba(511),this.Rz.E2b(this.Xd)}c0i(a,b,c,f,l){if(!a)return c=this.Nz,f=b[this.Nz],{oXf:c,FWf:f,GWf:0};f=0;if(0<a){for(c=this.Nz;f<a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=this.Nz+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{oXf:c,FWf:f,GWf:l}}dcb(a,b){if(b!==a){var c=this.ZYi(b-1);b=this.Xd.hf(b,this.k_);a=this.Xd.hf(a,this.k_);for(let f=this.k_;f<=this.AFa;f++)this.Vre(c[f],
b,a),b=b.bZ(),a=a.bZ()}}Vre(a,b,c){if(c.isGhostCell){var f=b.colSpan,l=a.rowSpan+c.rowIndex-b.rowIndex,w=a.rowSpan+b.rowSpan-l;sm.c(Object(ua.a)(fg.a,b),Object(ua.a)(fg.a,c),this.Xr.gLd);sm.c(Object(ua.a)(fg.a,b),Object(ua.a)(fg.a,c),[zb.a.nHa]);var F=mb.GraphIterator.nb(c);F.af();var S=new mb.GraphIterator;S.set(Object(ua.a)(fg.a,b));S.yb(1)&&sm.h(F,null,1,1,S,-1);c.isGhostCell=b.isGhostCell;this.xVd(F);b.Kn(zb.a.rowSpan,zb.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=f,c.rowSpan=w);a.pi===
F.Gp.pi&&(a.rowSpan=l)}}xVd(a){const b=a.currentNode.getValue(zb.a.rowId),c=a.currentNode.getValue(zb.a.cellId);for(a=sh.a.Gu(a);a.moveNext();){const f=a.currentNode.ta(zb.a.cellId,null);a.currentNode.ta(zb.a.rowId,null)&&a.currentNode.setValue(zb.a.rowId,b);f&&a.currentNode.setValue(zb.a.cellId,c)}}jdl(a,b,c){var f=mb.GraphIterator.nb(this.Xd);this.Vbc(f,a);const l=f.currentNode;f=this.Xr.V5d(f);const w=this.r8.Ed,F=l.pc(this.Le);F.gGb(Math.floor(b));l.setValue(zb.a.Nt,w.yf(F.htmlElement.offsetHeight,
1));c=Math.max(c,this.PPa(this.Xd,a+1));f.setValue(zb.a.Nt,w.yf(Math.floor(c),1));b=this.Nz+1;a+=1;a<=b&&(b+=1);this.dcb(a,b)}Vbc(a,b){if(!(14!==a.ri||0>b||b>=this.wc.Zj(a.currentNode)))for(Fd.moveToFirstRow(a);0<b--;)Fd.moveToNextRow(a)}ZYi(a){a=this.Xd.hf(a,this.k_);const b=Array(this.wc.ui(this.Xd));for(let c=this.k_;c<=this.AFa;c++)b[c]=a.ly(),a=a.bZ();return b}SJe(){return!!this.Xd&&this.Xd.hp()&&!this.Qxb&&!this.cke}}Object(e.a)(oL,"PowerpointRowHandleDragAdapter",KD,[]);class LD{constructor(a,
b,c,f){this.Ib=b;this.VN=c;this.Rz=f;this.zEa=a;this.zEa.yk(Object(C.a)(this,this.Ah,"onPropertyChanged"))}Ah(a,b){a=b.property;(b=Object(ua.a)(123,b.node))&&(a===zb.a.colSpan||a===zb.a.rowSpan)&&(b=b.getContainingTable())&&(this.Rz.G9j(b),b.FX=null)}dispose(){this.zEa.Pm(Object(C.a)(this,this.Ah,"onPropertyChanged"))}}Object(e.a)(LD,"TableCellNodeBehavior",null,[109]);class pL extends gc.a{constructor(a,b){super(a,b,"TableCellSelected")}SQg(a){this.selected&&!Sys.UI.DomElement.containsCssClass(a,
this.nXa)?Sys.UI.DomElement.addCssClass(a,this.nXa):!this.selected&&Sys.UI.DomElement.containsCssClass(a,this.nXa)&&Sys.UI.DomElement.removeCssClass(a,this.nXa)}}Object(e.a)(pL,"TableCellSelectionBehavior",gc.a,[441,404]);class qL extends Sys.EventArgs{constructor(a){super();this.QUh=a}get tableCellNode(){return this.ghl.tableCellNode}get ghl(){return this.QUh}}Object(e.a)(qL,"TableCellViewElementLockedEventArgs",Sys.EventArgs,[]);class MD extends Sys.EventArgs{constructor(a){super();this.bBi=a}}
Object(e.a)(MD,"TypingLockStatusChangedEventArgs",Sys.EventArgs,[]);var Xp=d(206);class Us extends tv{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc){super(a,b,f,l,lb.a.instance.resolve("Box4.ITableCellReader"),lb.a.instance.resolve("Box4.IParagraphReader"),lb.a.instance.resolve("Box4.IOutlineElementNavigator"),lb.a.instance.resolve("Box4.ITableNavigator"),lb.a.instance.resolve("Box4.IOutlineElementReader"),lb.a.instance.resolve("Box4.Styles.IStyleReader"),lb.a.instance.qb("Box4.IFeatureHelper"),
new pL(a,b),lb.a.instance.qb("Box4.Styles.ITableCellspacingReader"),lb.a.instance.resolve("Box4.TableCellViewElementSettings"));this.Ele=this.Fle=this.i3c=this.n3c=this.dAb=this.zh=this.Cbb=this.vN=this.DN=this.l_=null;this.gka=!1;this.Ija=null;this.ej=Object(ua.a)(123,b);this.Fa=c;this.Rz=w;this.Fk=F;this.Xc=S;this.YDa=fa;this.wc=xa;this.N$a=Za;this.ayb=pb;this.ZZ=Mb;this.o_c=hc;this.x8b=qd.a("PPTOEnableTableDiagonalBorders");this.sa=kc;this.Wsa=this.p7f();(this.N$a||this.ayb)&&Sys.UI.DomElement.addCssClass(this.htmlElement,
"TableCellRelativePosition")}i5(){}eA(a){super.eA(a);this.N$a&&!this.Gd.Al&&this.wZk()}CBa(a,b){return a&&a.length&&"none"!==a&&b&&b.length&&b.endsWith("px")?parseFloat(b.substr(0,b.length-2)):0}Gug(){const a=this.sa.NVi(),b=this.ej.getContainingTable();return b?Array.contains(a,b):!1}vHk(a){switch(a){case "Top":this.zh.style.top="-0.5px";this.zh.style.borderTopWidth="1px";break;case "Right":this.zh.style.right="-0.5px";this.zh.style.borderRightWidth="1px";break;case "Bottom":this.zh.style.bottom=
"-0.5px";this.zh.style.borderBottomWidth="1px";break;case "Left":this.zh.style.left="-0.5px",this.zh.style.borderLeftWidth="1px"}}uHk(a){switch(a){case "Top":this.zh.style.top="0px";this.zh.style.borderTopWidth="0px";break;case "Right":this.zh.style.right="0px";this.zh.style.borderRightWidth="0px";break;case "Bottom":this.zh.style.bottom="0px";this.zh.style.borderBottomWidth="0px";break;case "Left":this.zh.style.left="0px",this.zh.style.borderLeftWidth="0px"}}Vbd(a){this.zh&&(this.Gug()?this.vHk(a):
this.uHk(a))}uZk(a,b,c){const f=!qd.a("TableBorderOutsideBorderHalfClippingDisabled");this.mTd();var l=mb.GraphIterator.nb(this.gb);l.oc(14);var w=l.Og(14);l=this.wc.Zj(w);w=this.wc.ui(w);c=c?c.cU():"";switch(a){case "Top":b=this.Gd.Ed.Ie(b,1);!this.ej.rowIndex&&f?(this.zh.style.top="0px",this.zh.style.borderTopWidth=b/2+"px"):(this.zh.style.top=-b/2+"px",this.zh.style.borderTopWidth=b+"px");this.zh.style.borderTopColor=c;break;case "Bottom":b=this.Gd.Ed.Ie(b,1);this.ej.rowIndex+this.ej.rowSpan===
l&&f?(this.zh.style.bottom="0px",this.zh.style.borderBottomWidth=b/2+"px"):(this.zh.style.bottom=-b/2+"px",this.zh.style.borderBottomWidth=b+"px");this.zh.style.borderBottomColor=c;break;case "Left":b=this.Gd.Ed.Ie(b,0);!this.ej.pi&&f?(this.zh.style.left="0px",this.zh.style.borderLeftWidth=b/2+"px"):(this.zh.style.left=-b/2+"px",this.zh.style.borderLeftWidth=b+"px");this.zh.style.borderLeftColor=c;break;case "Right":b=this.Gd.Ed.Ie(b,0);this.ej.pi+this.ej.colSpan===w&&f?(this.zh.style.right="0px",
this.zh.style.borderRightWidth=b/2+"px"):(this.zh.style.right=-b/2+"px",this.zh.style.borderRightWidth=b+"px");this.zh.style.borderRightColor=c;break;case "DiagonalUp":this.x8b&&(b=this.Gd.Ed.Ie(b,0),this.yXf(a,b,c));break;case "DiagonalDown":this.x8b&&(b=this.Gd.Ed.Ie(b,0),this.xXf(a,b,c))}this.Blh()}yXf(a,b,c){this.sZf();this.Fle||(this.Fle=this.ZQf());this.hjh(this.Fle,a,b,c)}xXf(a,b,c){this.sZf();this.Ele||(this.Ele=this.ZQf());this.hjh(this.Ele,a,b,c)}ZQf(){const a=new qn.a;this.n3c.appendChild(a.za);
this.Co(a.za);return a}hjh(a,b,c,f){b=this.Yui(b);a.$_(b);a.pv(f);a.sr(c)}Yui(a){switch(a){case "DiagonalUp":return String.format("M 0 {0} L {1} 0",this.vXd(),this.xXd());case "DiagonalDown":return String.format("M 0 0 L {0} {1}",this.xXd(),this.vXd())}za.a.J(571479943,822,10,"CreateDAttrib : Unknown borderType "+a);return null}sZf(){this.mTd();this.dAb||(this.dAb=this.Gd.Lo(ma.a.div),this.dAb.className="PPTTableDiagonalBorder",this.Cbb.appendChild(this.dAb),this.Co(this.dAb));this.i3c||(this.i3c=
new Un.a,this.n3c=this.i3c.za,this.dAb.appendChild(this.n3c),this.Co(this.n3c));this.i3c.pwa(String.format("0 0 {0} {1}",this.xXd(),this.vXd()))}mTd(){this.Cbb||(this.Cbb=this.Gd.Lo(ma.a.div),this.Cbb.className="PPTTableBorderContainer",this.htmlElement.insertBefore(this.Cbb,this.htmlElement.firstChild),this.Co(this.Cbb));this.zh||(this.zh=this.Gd.Lo(ma.a.div),this.zh.className="PPTTableBorder",this.Cbb.appendChild(this.zh),this.Co(this.zh))}Blh(){this.o_c&&qd.a("MergeDifferentBordersFixEnabled")?
this.zh.style.zIndex=this.lvb(this.ej)?"1":(this.iRa(this.ej.Swa)||this.iRa(this.ej.Eea))&&(this.iRa(this.ej.Rwa)||this.iRa(this.ej.Fea))?"3":"2":this.zh.style.zIndex=(this.iRa(this.ej.Swa)||this.iRa(this.ej.Eea))&&(this.iRa(this.ej.Rwa)||this.iRa(this.ej.Fea))?"1":"0"}lvb(a){return 1<a.rowSpan||1<a.colSpan}GCj(a){return"DiagonalUp"===a||"DiagonalDown"===a}WHa(a,b,c,f){const l=this.o_c&&qd.a("MergeDifferentBordersFixEnabled")&&this.lvb(this.ej);this.o_c&&!this.GCj(a)&&this.Gug()&&0===b&&(b=1,c="rgb(255, 255, 255)");
switch(a){case "Top":l&&!this.Vzj()&&(b=0);this.zh.style.borderTopWidth=b+"px";this.zh.style.borderTopColor=c;this.zh.style.borderTopStyle=f;this.zh.style.top=-b/2+"px";break;case "Right":l&&!this.Uzj()&&(b=0);this.zh.style.borderRightWidth=b+"px";this.zh.style.borderRightColor=c;this.zh.style.borderRightStyle=f;this.zh.style.right=-b/2+"px";break;case "Bottom":l&&!this.Pzj()&&(b=0);this.zh.style.borderBottomWidth=b+"px";this.zh.style.borderBottomColor=c;this.zh.style.borderBottomStyle=f;this.zh.style.bottom=
-b/2+"px";break;case "Left":l&&!this.Rzj()&&(b=0);this.zh.style.borderLeftWidth=b+"px";this.zh.style.borderLeftColor=c;this.zh.style.borderLeftStyle=f;this.zh.style.left=-b/2+"px";break;case "DiagonalUp":this.x8b&&this.yXf(a,b,c);break;case "DiagonalDown":this.x8b&&this.xXf(a,b,c)}}xXd(){var a=0;for(let b=0;b<this.ej.colSpan;b++)a+=this.ej.getContainingTable().FXd[this.ej.pi+b];a=this.Gd.Ed.Ie(a,0);return Math.round(100*a)/100}vXd(){var a=this.wc.OMc(this.ej.getContainingTable(),this.ej.rowIndex,
this.ej.rowIndex+this.ej.rowSpan-1);let b=0;for(let c of a)Object(Ca.a)(156,c)?b+=c.ta(zb.a.Nt,0):za.a.J(571479944,822,15,String.format("GetCellHeight : node {0} is not of the type ITableRowNode",c));this.ej.marginTop+this.ej.marginBottom>b&&za.a.J(559724693,822,15,String.format("GetCellHeight :: degenerate case : cell height : {0} is less than sum of margins top : {1}  and bottom : {2} ",b,this.ej.marginTop,this.ej.marginBottom));b=Math.max(b,this.ej.marginTop+this.ej.marginBottom);a=this.Gd.Ed.Ie(b,
1);return Math.round(100*a)/100}Vzj(){if(!this.ej.rowIndex)return!0;const a=this.ej.getContainingTable();if(!a)return!0;const b=this.ej.rowIndex-1;var c=this.ej.pi;const f=c+this.ej.colSpan-1;for(;c<=f;c++){const l=a.hf(b,c);if(l&&(l.isGhostCell||this.lvb(l)))return!0}return!1}Rzj(){if(!this.ej.pi)return!0;const a=this.ej.getContainingTable();if(!a)return!0;const b=this.ej.pi-1;var c=this.ej.rowIndex;const f=c+this.ej.rowSpan-1;for(;c<=f;c++){const l=a.hf(c,b);if(l&&(l.isGhostCell||this.lvb(l)))return!0}return!1}Uzj(){const a=
this.ej.getContainingTable();if(!a||this.ej.pi+this.ej.colSpan===this.wc.ui(a))return!0;const b=this.ej.pi+this.ej.colSpan;var c=this.ej.rowIndex;const f=c+this.ej.rowSpan-1;for(;c<=f;c++){const l=a.hf(c,b);if(l&&(l.isGhostCell||this.lvb(l)))return!0}return!1}Pzj(){const a=this.ej.getContainingTable();if(!a||this.ej.rowIndex+this.ej.rowSpan===this.wc.Zj(a))return!0;const b=this.ej.rowIndex+this.ej.rowSpan;var c=this.ej.pi;const f=c+this.ej.colSpan-1;for(;c<=f;c++){const l=a.hf(b,c);if(l&&(l.isGhostCell||
this.lvb(l)))return!0}return!1}wZk(){var a=!qd.a("TableBorderOutsideBorderHalfClippingDisabled");this.mTd();if(a){a=mb.GraphIterator.nb(this.gb);a.oc(14);var b=a.Og(14);a=this.wc.Zj(b);b=this.wc.ui(b);var c=this.CBa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth);this.WHa("Left",c,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle);this.ej.pi?this.zh.style.left=-c/2+"px":(this.zh.style.left="0px",this.zh.style.borderLeftWidth=c/2+"px");c=this.CBa(this.htmlElement.style.borderRight,
this.htmlElement.style.borderRightWidth);this.WHa("Right",c,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle);this.ej.pi+this.ej.colSpan===b?(this.zh.style.right="0px",this.zh.style.borderRightWidth=c/2+"px"):this.zh.style.right=-c/2+"px";b=this.CBa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth);this.WHa("Top",b,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle);this.ej.rowIndex?this.zh.style.top=-b/2+"px":(this.zh.style.top=
"0px",this.zh.style.borderTopWidth=b/2+"px");b=this.CBa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth);this.WHa("Bottom",b,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.ej.rowIndex+this.ej.rowSpan===a?(this.zh.style.bottom="0px",this.zh.style.borderBottomWidth=b/2+"px"):this.zh.style.bottom=-b/2+"px"}else a=this.CBa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth),this.WHa("Left",a,this.htmlElement.style.borderLeftColor,
this.htmlElement.style.borderLeftStyle),a=this.CBa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth),this.WHa("Right",a,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle),a=this.CBa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth),this.WHa("Top",a,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle),a=this.CBa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth),this.WHa("Bottom",
a,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.wXf();this.o_c&&this.Blh();this.htmlElement.style.border=""}wXf(){this.x8b&&(this.kfe&&this.gjh("DiagonalUp",this.kfe),this.jfe&&this.gjh("DiagonalDown",this.jfe))}iRa(a){return!!a}gjh(a,b){const c=b.split(" ");if(3!==c.length)za.a.J(570832849,822,10,String.format("SetDiagonalBorderProps : split of string [ {0} ] has greater or less than 3 sub-parts",b));else{var f=c[0];b=this.CBa(b,c[1]);this.WHa(a,b,c[2],f)}}enc(a,
b,c,f,l,w,F){if(!this.ZZ||this.Fa.$m(this.ej).getValue(zb.a.isResizable))this.ayb?this.htl(l,w,F):this.gtl(a,b,c,f,l,w,F)}htl(a,b,c){this.$Da||(this.$Da=this.DEc(),this.Co(this.$Da));this.l_||(this.l_=this.TNa(),this.Co(this.l_));a?Sys.UI.DomElement.addCssClass(this.l_,"First"):Sys.UI.DomElement.removeCssClass(this.l_,"First");b^!!this.DN&&(b?(this.DN=this.TNa(),this.Co(this.DN)):(this.gEb(this.DN),this.DN=null));this.DN&&Sys.UI.DomElement.addCssClass(this.DN,"Last");c^!!this.vN&&(c?(this.vN=this.DEc(),
this.Co(this.vN)):(this.gEb(this.vN),this.vN=null));this.vN&&Sys.UI.DomElement.addCssClass(this.vN,"FirstLeft")}gtl(a,b,c,f,l,w,F){super.enc(a,b,c,f,l,w,F);this.Qob&&this.Co(this.Qob);this.l_||(this.l_=this.TNa(),this.Co(this.l_));this.l_.style.left=a+"px";this.l_.style.top=b+"px";this.l_.style.width=c+"px";l?Sys.UI.DomElement.addCssClass(this.l_,"First"):Sys.UI.DomElement.removeCssClass(this.l_,"First");w^!!this.DN&&(w?(this.DN=this.TNa(),this.Co(this.DN)):(this.gEb(this.DN),this.DN=null));this.DN&&
(this.DN.style.bottom="0",this.DN.style.left=a+"px",this.DN.style.width=c+"px",Sys.UI.DomElement.addCssClass(this.DN,"Last"));F^!!this.vN&&(F?(this.vN=this.DEc(),this.Co(this.vN)):(this.gEb(this.vN),this.vN=null));this.vN&&(this.vN.style.left="0",this.vN.style.top=b+"px",this.vN.style.height=f+"px",Sys.UI.DomElement.addCssClass(this.vN,"FirstLeft"));this.N$a&&(this.l_.style.left="0",this.l_.style.top="0",this.Qob&&(this.Qob.style.left=c+"px",this.Qob.style.top="0",this.Qob.style.height=f+"px"),this.DN&&
(this.DN.style.left="0"),this.vN&&(this.vN.style.top="0"))}Tih(){var a=this.Gd.Ed,b=a.Ie(this.Fk.ara(this.gb,3),1);this.cha.style.paddingTop=b+"px";b=a.Ie(this.Fk.ara(this.gb,0),1);this.cha.style.paddingBottom=b+"px";b=a.Ie(this.Fk.ara(this.gb,1),0);this.cha.style.paddingLeft=b+"px";a=a.Ie(this.Fk.ara(this.gb,2),0);this.cha.style.paddingRight=a+"px"}yZk(a,b){const c=this.Gd.Ed;switch(b){case aa.a.slc:a=c.jZ(a.marginTop,1);this.cha.style.paddingTop=a+"px";break;case aa.a.plc:a=c.jZ(a.marginBottom,
1);this.cha.style.paddingBottom=a+"px";break;case aa.a.qlc:a=c.jZ(a.marginLeft,0);this.cha.style.paddingLeft=a+"px";break;case aa.a.rlc:a=c.jZ(a.marginRight,0),this.cha.style.paddingRight=a+"px"}}vT(){var a=this.Fk.ara(this.gb,1),b=this.Fk.ara(this.gb,2);const c=this.Fk.NZb(this.gb,5),f=this.Fk.NZb(this.gb,6);var l=this.Gd.Ed;a=l.Ie(a+c,0);b=l.Ie(b+f,0);l=l.Ie(this.Fk.VJf(this.gb),0);return new uj.a(a,l,b)}qzh(){this.htmlElement.style.background=this.Rz.E6f(this.gb)}nT(){if(!this.zh)super.nT();else if(!this.Gd.Al&&
this.GA){const a=Object(ua.a)(441,this.HQ);a&&a.SQg(this.zh)}}TNa(){const a=this.eSf();a.className="TableRowResizeHandle";return a}gEb(a){K.a.sHa(a);ya.a.hO(a)}get tableCellNode(){return this.ej}get nVc(){return this.Ija}get pk(){this.Wsa||(this.Wsa=this.p7f());return this.Wsa}set pk(a){this.Wsa=a}get jp(){return this.gka}mGb(a){this.gka=a;this.tableCellNode.Ztb=a}lock(a){this.jp&&this.Ija===a||(this.pk.Kid(),this.Ija=a,this.mGb(!0),this.Xc.ND(new Xp.a(7)),this.YDa.p9g(new MD(a)),this.YDa.aEk(new qL(this)))}unlock(){this.jp&&
(this.Ija=null,this.mGb(!1),this.Xc.ND(new Xp.a(7)),this.YDa.p9g(new MD(null)))}p7f(){let a=null;const b=this.Fa.$m(this.ej);b&&(a=Object(ua.a)(133,b.yg(this.Na)));return a}}Object(e.a)(Us,"TableCellViewElement",tv,[442,435,274,109]);var Kz=d(295),uQ=d(496);class em extends Ch{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){super(a,b);Ch.F_a=()=>Qq.h0f(xg.a.create());this.Fk=c;this.um=f;this.lF=w;this.uua=l;this.wc=F;this.Q3=S;this.OUa=fa;this.Zxb=xa;this.Le=Za;this.LZc=qd.a("PPTOEnableTableDiagonalBorders")}CMf(a,
b){Ch.dli(a,b,Cd.TableReader.ui(a))}hSf(a,b,c,f=null,l=!1){const w=a.parentNode.getValue(zb.a.shapeId);a.currentNode.setValue(zb.a.shapeId,w);for(var F=0;F<b;++F){var S=new uQ.a;a.hl(S,1);S.setValue(zb.a.shapeId,w);S.setValue(zb.a.rowId,xg.a.create())}b=null;F=!0;a.yb(1);do{S=a.currentNode.getValue(zb.a.rowId);for(let fa=0;fa<c;++fa){const xa=this.fqa();a.hl(xa,1);xa.setValue(zb.a.shapeId,w);xa.setValue(zb.a.rowId,S);xa.setValue(zb.a.cellId,xg.a.create());({khh:b,isFirst:F}=this.C2f(a,xa,l,f,b,F));
Fd.returnToContainingRow(a)}}while(a.xj(1))}CWa(a){if(this.LZc&&a&&(a=this.wc.PE(a)))for(const b of a)b&&!b.isGhostCell&&(a=Object(ua.a)(Us,b.pc(this.Le)))&&a.wXf()}NEe(a,b,c,f,l){var w=this.lF.LKc(a);for(var F=0;F<w.length;F++){const S=this.Fk.bob(a,F);w[F]=Math.max(S,w[F]*b)}a.setValue(ob.a.ru,w);if(1!==c)for((new mb.GraphIterator).set(a),b=a?a.firstRow:null,c=0;b;){w=l.yf(f.G9i(c),1);F=this.Fk.xKd(a,c);w<=F&&(w=0);b.setValue(zb.a.Nt,w);if(b.xtg())break;else b=b.pGa;c++}this.CWa(a)}tZk(a,b){a=this.wc.PE(a);
for(let c=0;c<a.length;c++){const f=a[c].cellShading;f.anchorField=b;a[c].cellShading=f;a[c].$ma=b}}sZk(a,b){for(let f=0;f<a.length;f++){const l=a.ga(f);for(let w=0;w<l.length;w++){var c=l.ga(w).iterator;c.oc(16);c.Og(16);c=c.Gp;const F=c.cellShading;F.anchorField=b;c.cellShading=F;c.$ma=b}}}z2b(a,b,c,f,l){super.z2b(a,b,c,f,l);c=[];Array.add(c,zb.a.Nt);sm.b(f,b,c);c=a.currentNode.getValue(zb.a.shapeId);const w=a.Gp.getValue(zb.a.sid);a=a.Gp.getValue(zb.a.cid);const F=Qq.bQf(xg.a.create());b.setValue(zb.a.sid,
w);b.setValue(zb.a.cid,a);b.setValue(zb.a.shapeId,c);b.setValue(zb.a.rowId,F);this.qtl(f,b,l)}r2b(a,b,c,f,l){super.r2b(a,b,c,f,l);return this.s6c(a.currentNode,b,c,f,!1,!1)}gSb(a,b,c,f,l){super.gSb(a,b,c,f,l);return this.s6c(a.currentNode,b,c,f,l,!1)}get gLd(){if(!em.Q9){em.Q9=[];let a,b,c;for(const f of em.xWc)if(this.LZc||2!==f&&1!==f)({d3a:b,c3a:a,Inb:c}=Wp.$Pa(f)),Array.add(em.Q9,b),Array.add(em.Q9,a),Array.add(em.Q9,c);Array.add(em.Q9,ob.a.LD);Array.add(em.Q9,zb.a.cellShading);Array.add(em.Q9,
Sb.a.IHb);Array.add(em.Q9,Sb.a.KHb);Array.add(em.Q9,Sb.a.LHb);Array.add(em.Q9,Sb.a.HHb);Array.add(em.Q9,zb.a.QQ)}return em.Q9}s6c(a,b,c,f,l,w){c=w?this.Pjj(b,c,l):this.Qjj(b,c,f,l);sm.c(c,b,this.gLd);f=a.getValue(zb.a.sid);w=a.getValue(zb.a.cid);const F=a.getValue(zb.a.shapeId),S=c.getValue(zb.a.cellId);a=a.getValue(zb.a.rowId);b.setValue(zb.a.sid,f);b.setValue(zb.a.cid,w);b.setValue(zb.a.shapeId,F);b.setValue(zb.a.rowId,a);l?b.setValue(zb.a.cellId,S):b.setValue(zb.a.cellId,b.id.fq);return c}tDf(a,
b,c,f,l,w){a=a.currentNode;const F=Array(c);let S=0,fa=0,xa=0;for(;S<f;S++)F[S]=b[S],fa+=F[S];for(l=l?b[f]:b[f-1];S<f+w;S++)F[S]=l,xa+=F[S];for(;S<c;S++)F[S]=b[S-w],fa+=F[S];b=fa/(xa+fa);for(S=0;S<c;S++)F[S]=Math.max(F[S]*b,this.Fk.bob(a,S));return F}Occ(a,b,c,f,l){super.Occ(a,b,c,f,l);var w=a.getValue(zb.a.Ggb);l=Array(w.length+f);let F=0;for(;F<b;F++)l[F]=w[F];for(;F<b+f;F++)l[F]=em.exi();for(;F<l.length;F++)l[F]=w[F-f];a.setValue(zb.a.Ggb,l);w=c?l[b+f]:l[b-1];a=Object(ua.a)(Kz.TableNode,a);this.Oql(a,
w,l.slice(b,f+b),b,c);if(this.Zxb)for(l=this.OUa.create(a),f=b+f,w=(!c||!b)&&b<this.wc.ui(a)-1,b+=c?1:0,f+=c?1:0,c=b;c<f;c++)this.Q3.zVd(a,l,c,0,this.wc.Zj(a),w)}Zue(a,b,c,f){super.Zue(a,b,c,f);if(this.Zxb){a=Object(ua.a)(182,a);const l=this.OUa.create(a);f=c+f;const w=(!b||!c)&&c<this.wc.Zj(a)-1;c+=b?1:0;f+=b?1:0;for(b=c;b<f;b++)this.Q3.yVd(a,l,b,0,this.wc.ui(a),w)}}wue(a,b,c){super.wue(a,b,c);this.ZIb(a,zb.a.complexTable);this.Zxb&&(a=Object(ua.a)(182,a.currentNode),c=this.OUa.create(a),this.Q3.yVd(a,
c,b,0,this.wc.ui(a),!0))}vue(a,b,c){super.vue(a,b,c);const f=a.currentNode.getValue(zb.a.Ggb),l=Array(f.length-c);let w=0;for(;w<b;w++)l[w]=f[w];for(;w<l.length;w++)l[w]=f[w+c];a.currentNode.setValue(zb.a.Ggb,l);this.ZIb(a,zb.a.complexTable);this.Zxb&&(a=Object(ua.a)(182,a.currentNode),c=this.OUa.create(a),this.Q3.zVd(a,c,b,0,this.wc.Zj(a),!0))}qtl(a,b,c){a=a.getValue(zb.a.rowId);b.setValue(zb.a.$Gk,a);b.setValue(zb.a.insertBefore,c)}Oql(a,b,c,f,l){a=a.firstRow;do for(let w=0;w<c.length;++w){const F=
mb.GraphIterator.nb(a),S=F.Hp(f+w,1);S.setValue(zb.a.ZGk,b);S.setValue(zb.a.insertBefore,l);S.setValue(zb.a.cellId,c[w]);em.wkh(F,zb.a.cellId,c[w])}while(a=a.pGa)}fqa(){const a=super.fqa();a.isGhostCell=!0;a.rowSpan=1;a.colSpan=1;return a}bue(a,b){this.zij(a,b,c=>{c.currentNode.isGhostCell=!1;Ch.ix.x2b(c,null,!0);const f=c.currentNode.getValue(zb.a.rowId),l=c.currentNode.getValue(zb.a.cellId);for(c=sh.a.Gu(c);c.moveNext();){const w=c.currentNode.ta(zb.a.cellId,null);c.currentNode.ta(zb.a.rowId,null)&&
c.currentNode.setValue(zb.a.rowId,f);w&&c.currentNode.setValue(zb.a.cellId,l)}})}ncd(a){Cd.TableReader.gu(a.currentNode)&&this.Fah(a,b=>b.Uh(zb.a.Nt),(b,c)=>{b.ke(zb.a.Nt,c)},zb.a.complexTable)}kDe(a){a&&(a=mb.GraphIterator.nb(a),this.ncd(a,0))}mwa(a,b){if(a)for(a=this.um.aqa(a),a.Il(c=>15===c.ri,null);a.moveNext();){const c=Object(ua.a)(156,a.iterator.currentNode),f=this.uua.d6a(c);c.setValue(zb.a.Nt,f*b)}}JXa(a,b){if(a&&14===a.type){const c=this.lF.LKc(a);for(let f=0;f<c.length;f++){const l=this.Fk.bob(a,
f);c[f]=Math.max(l,c[f]*b)}a.setValue(ob.a.ru,c)}}glh(a,b){if(a&&0<a.length)for(const c of a)c.setValue(zb.a.Nt,ke.a.xV(b))}flh(a,b,c){if(a&&b&&0<b.length){const f=this.lF.LKc(a);for(let l=0;l<b.length;l++)f[b[l]]=ke.a.xV(c);a.setValue(ob.a.ru,f)}}V5d(a){const b=new mb.GraphIterator;b.Pc(a);var c=b.currentNode;b.yb(1);const f=a.yc();this.sxa(a);const l=ws.a.instance.createInstance(393251);this.z2b(a,l,c,c,!1);a.Ck(l);c=this.wc.ui(f);for(let w=0;w<c;++w){const F=this.fqa();super.gSb(a,F,b.currentNode,
!1,!0);this.s6c(l,F,b.currentNode,!1,!0,!0);b.xf(1)}this.SFb(f,this.wc.Zj(f)+1);return a.currentNode}U5d(a){const b=mb.GraphIterator.nb(a.yBh());let c=this.wc.ui(b.currentNode);var f=this.lF.KKc(Object(ua.a)(123,a.currentNode));a=f+1;this.sxa(b);b.yb(1);do{const l=b.Hp(f,1);b.yc();const w=this.fqa();super.r2b(b,w,l,!1,!1);this.s6c(b.currentNode,w,l,!1,!1,!0)}while(b.xj(1));(f=b.currentNode.ta(ob.a.ru,null))&&(f=Ma.a.clone(f));this.DFb(b.currentNode,++c);f&&(Array.insert(f,a,0),b.currentNode.setValue(ob.a.ru,
f));this.Occ(b.currentNode,a,!1,1,null)}URe(a){this.ZIb(a,zb.a.complexTable)}Pjj(a,b,c){let f=b;const l=b.kGa;if(l)if(b.isGhostCell)Ch.pMc(l,!c)||Ch.bfb(l.controlCell,c,Ch.xrb(l.controlCell,c)+1);else{let w=Ch.xrb(b,c);1<w&&(f=Ch.l1i(l,!c));Ch.bfb(b,c,w+1)}else Ch.bfb(b,c,2);a.isGhostCell=!0;return f}static wkh(a,b,c){a.currentNode.ke(b,c);let f=a.Ii();if(f){for(;f;)em.wkh(a,b,c),f=a.fp();a.yc()}}static exi(){return Qq.bQf(xg.a.create())}}em.Q9=null;em.xWc=[5,6,7,0,2,1];Object(e.a)(em,"TableEditor",
Ch,[1286]);const rL=(a,b,c,f,l)=>{const w=l.oX,F=l.Rpa;var S=l.tableLook;const fa=0<(S&32);l=0<(S&128);const xa=0<(S&64),Za=0<(S&256),pb=fa?1:0,Mb=l?1:0;S=a?a===w-c?xa?3:(a-pb)%2+pb:(a-pb)%2+pb:0;w-c||(S=fa?0:xa?3:(a-pb)%2+pb);a=b?b===F-f?Za?3:(b-Mb)%2+Mb:(b-Mb)%2+Mb:0;F-f||(a=l?0:Za?3:(b-Mb)%2+Mb);return{JJf:S,HJf:a}};class ND{constructor(a){this.s_=a;this.a0c=Array(4);for(a=0;4>a;a++)this.a0c[a]=Array(4)}o6f(a,b,c,f){let l,w;({JJf:l,HJf:w}=rL(a,b,c,f,this.s_));if(!this.a0c[l][w]){c=Object.assign(new cr.a,
{ae:b,Lf:b+f,ge:a,Tf:a+c});a=this.a0c[l];b=w;f=this.s_;var F=f.tableStyle,S=new mp;S.latinField=ye.upb(1,0);S.eaField=ye.upb(1,1);S.csField=ye.upb(1,2);S.solidFillField=Object.assign(new rr.a,{schemeClrField:Object.assign(new ym.a,{valField:1})});F&&(new VK(S)).v1(f,c);c=S;F=f.cRj;f=new Ex;F=F||new SK;for(S=1;9>=S;S++){var fa=WK(F,S);const xa=S-1;f.Pwe[xa]=fa?md.a(md.c(fa)):new lt;fa=f.Pwe[xa].defRPrField;f.xob[xa]=fa?md.a(md.c(fa)):new mp}for(F=1;9>=F;F++)XK(f.xob[F-1],c);a[b]=f}return this.a0c[l][w]}R7f(a,
b,c,f,l){let w=Jb.a.gOa;a&&(b=this.o6f(b,c,f,l))&&b.xob&&0<b.xob.length&&(b=b.xob[0])&&(w=If.Box4ColorHelper.FEb(b,a));return w}}Object(e.a)(ND,"TableListStyleCache",null,[418]);class OD{constructor(a,b,c,f){this.zEa=a;this.POg=b;this.zEa.yk(Object(C.a)(this,this.Ah,"onPropertyChanged"));this.zEa.yga(Object(C.a)(this,this.onConnected,"onConnected"));this.Le=c;this.Wje=f}onConnected(a,b){a=Object(ua.a)(182,b.node);this.POg.lBh(a)}Ah(a,b){a=b.property;b=Object(ua.a)(182,b.node);a===ob.a.ru?this.POg.lBh(b):
a===ob.a.Uwa||a===ob.a.Gea||a===ob.a.rA?b.FX=null:!this.Wje||a!==zb.a.CRa&&a!==zb.a.isResizable&&a!==zb.a.DK||b.pc(this.Le).VSe()}dispose(){this.zEa.Pm(Object(C.a)(this,this.Ah,"onPropertyChanged"));this.zEa.mma(Object(C.a)(this,this.onConnected,"onConnected"))}}Object(e.a)(OD,"TableNodeBehavior",null,[109]);var vQ=d(184);class vv{constructor(a,b,c,f,l,w,F,S){this.g_=this.gQ=this.en=this.WEa=this.d_=this.p3c=this.pEa=null;this.vab=this.N0c=0;this.MKg=this.J9b=this.Rd=this.Sw=null;this.xN=a;this.ia=
c;this.pq=f;this.Xr=l;this.dC=w;this.X8=b;this.Lp=F;this.qp=S}ZJ(){this.g_=this.gQ=this.en=this.d_=this.WEa=null;null!==this.Lp&&this.Lp.Nva()}Tu(a){if(!a||a.Sz===Sys.UI.MouseButton.rightButton||this.xN.uZ)return!1;this.Rd=(this.Sw=Object(ua.a)(1278,this.dC.SH(a.Hc)))?this.Sw.pk:null;if(!this.Rd)return!1;this.pEa=this.Sw.uki;if(!this.pEa)return!1;this.gQ=this.pEa.Wjg(a.Hc);if(!this.gQ)return!1;this.qp&&this.ia.processAction(D.a.Mha,2);return!0}pu(a){if(!a||!this.Tu(a))return!1;this.p3c=this.Sw=this.dC.SH(this.pEa.za);
if(!this.Sw)return za.a.J(8959070,808,10,"The draggable chrome should be owned by Box4 TableViewElement"),!1;this.ia.processAction(aa.a.L3a,2);this.pEa.cD(!0);this.Rd.cD(!0);null!==this.Lp&&this.Lp.gwa(Ei.a.kHb);this.g_=this.p3c.p0b();this.N0c=this.pq.jn(ic.a.Nl(this.g_.ga(0),this.g_.ga(1)));this.vab=this.pq.jn(ic.a.Nl(this.g_.ga(0),this.g_.ga(3)));this.WEa=this.$Pf(a.clientPoint);this.d_=new ic.a(0,0);this.en=new ri.a;this.MKg=new ic.a(this.Rd.x+this.N0c,this.Rd.y+this.vab);return!0}Xv(a){if(!a)return!1;
a=this.$Pf(a.clientPoint);var b=ic.a.WT(a,this.WEa);this.d_=ic.a.add(this.d_,b);b=Pk.zKd(this.gQ,this.g_,this.d_,!1,!1);this.en=Object.assign(new ri.a,{bottom:this.pq.jn(b.bottom),left:this.pq.jn(b.left),right:this.pq.jn(b.right),top:this.pq.jn(b.top)});let c;({oDh:b,sDh:c}=this.aKf());const f=new vQ.a;f.waa(b,c);f.vB(this.en.left,this.en.top);this.pEa.Nq(f);this.WEa=a;return!0}In(a){let b=null;a&&(b=this.X8.wi("UserAction","PPTTableResize"),za.a.J(19142416,822,50,String.format("Start Table resize for table: {0}, IsComplex: {1}",
this.Sw.gb.ta(zb.a.UAb,""),Cd.TableReader.gu(this.Sw.gb))));this.pEa.qz(!1);({oDh:l,sDh:w}=this.aKf());this.Sw.jlh(l,w);this.YNe();const c=new Oe.GraphTransaction(15);c.hd(this.Sw.gb);var f=this.Sw.Gd.Ed;this.Xr.NEe(Object(ua.a)(Kz.TableNode,this.Sw.gb),l,w,this.p3c,f);if(vv.QCa(this.gQ)||vv.QCa(this.gQ,!0)){var l=this.Sw.pk.shapeNode;var w=f.yf(this.Rd.x,0);f=f.yf(this.Rd.y,1);l.My=w;l.Ny=f}this.Rd.qz(!1);c.dispose();this.ZJ();gb.App.Fb.updateCommandUI();b&&b.stop();a&&za.a.J(8959107,822,50,String.format("End Table resize for table: {0}, IsComplex: {1}",
this.Sw.gb.ta(zb.a.UAb,""),Cd.TableReader.gu(this.Sw.gb)))}YNe(){var a=vv.QCa(this.gQ),b=vv.QCa(this.gQ,!0);if(a||b){b=this.p3c.p0b();a=this.pq.jn(b.$b-b.fc);b=this.pq.jn(b.Xb-b.ic);const c=this.MKg;c._x+=this.en.right;c._y+=this.en.bottom;this.Rd.setPosition(c.x-a,c.y-b,!0)}}Jt(){this.d_&&(this.pEa.qz(!0),this.pEa.Nq(null),this.Rd.qz(!0),this.ZJ())}aKf(){return{oDh:this.N0c?1+(this.en.right-this.en.left)/this.N0c:1,sDh:this.vab?1+(this.en.bottom-this.en.top)/this.vab:1}}$Pf(a){a=ic.a.qPa(a);var b=
this.gQ;this.gQ.a3b()||(b=b.dsb());const c=this.g_.Yj(b);b=this.g_.Yj(b.n5a());return a=new ic.a(c.x<=b.x?Math.min(a.x,b.x):Math.max(a.x,b.x),c.y<=b.y?Math.min(a.y,b.y):Math.max(a.y,b.y))}static QCa(a,b=!1){return a.equals(ge.a.nu)?!0:b?a.equals(ge.a.north)||a.equals(ge.a.JD):a.equals(ge.a.west)||a.equals(ge.a.bH)}}Object(e.a)(vv,"TableResizeDragAdapter",null,[223]);class PD{constructor(a,b){this.s_=a;this.fAb=b;this.hi=Array(4);for(a=0;4>a;a++)this.hi[a]=Array(4);this.Mqe=Array(16)}tXd(a,b,c,f){let l,
w;({JJf:l,HJf:w}=rL(a,b,c,f,this.s_));this.hi[l][w]||(this.hi[l][w]=this.fAb.ARk(this.s_,a,b,c,f));c=this.hi[l][w].clone();if(a=this.vfj(a,b))for(const F of a.yz())c.Sa(F)||c.ke(F,a.Uh(F));return c}clear(){for(let a=0;4>a;a++)this.hi[a]=Array(4);this.Mqe=Array(16)}vfj(a,b){var c=a===this.s_.oX-1;const f=b===this.s_.Rpa-1;let l=0;a||(l|=8);!b&&(l|=4);c&&(l|=2);f&&(l|=1);(c=this.Mqe[l])||(this.Mqe[l]=c=this.fAb.SRk(this.s_,a,b));return c}}Object(e.a)(PD,"TableStyleCache",null,[417]);class sL{constructor(a){this.RTa=
a}ARk(a,b,c,f,l){const w=a.oX;var F=a.Rpa,S=a.tableLook;const fa=a.tableStyle;a=a.Ye;const xa=new kq.a,Za=0<(S&32),pb=0<(S&128),Mb=!b&&Za,hc=!c&&pb;f=b===w-f&&0<(S&64);l=c===F-l&&0<(S&256);F=!(S&512)&&!Mb&&!f;S=!(S&1024)&&!hc&&!l;this.TRk(fa.wholeTblField,xa);F&&this.Sva((Za?1!==(b&1):b&1)?fa.band2HField:fa.band1HField,a,xa);S&&this.Sva((pb?1!==(c&1):c&1)?fa.band2VField:fa.band1VField,a,xa);l&&this.Sva(fa.lastColField,a,xa);hc&&this.Sva(fa.firstColField,a,xa);f&&(this.Sva(fa.lastRowField,a,xa),l&&
this.Sva(fa.seCellField,a,xa),hc&&this.Sva(fa.swCellField,a,xa));Mb&&(this.Sva(fa.firstRowField,a,xa),l&&this.Sva(fa.neCellField,a,xa),hc&&this.Sva(fa.nwCellField,a,xa));return xa}SRk(a,b,c){var f=a.oX;const l=a.Rpa;var w=a.tableStyle;a=a.Ye;const F=new kq.a;if(w&&0<=b&&b<f&&0<=c&&c<l){const S=!c;f=b===f-1;c=c===l-1;(w=w.wholeTblField)&&w.tcStyleField&&(w=w.tcStyleField.tcBdrField)&&(this.VWa(7,b?w.insideHField:w.topField,a,F),this.VWa(0,f?w.bottomField:w.insideHField,a,F),this.VWa(5,S?w.leftField:
w.insideVField,a,F),this.VWa(6,c?w.rightField:w.insideVField,a,F))}return F}xeh(a,b,c){const f=new kq.a;this.veh(a,c,b,f);return f}TRk(a,b){a&&a.tcStyleField&&a.tcStyleField.fillField&&b.ke(zb.a.cellShading,a.tcStyleField.fillField)}Sva(a,b,c){a&&a.tcStyleField&&(a.tcStyleField.fillField&&c.ke(zb.a.cellShading,a.tcStyleField.fillField),a=a.tcStyleField.tcBdrField)&&(this.VWa(7,a.topField,b,c),this.VWa(0,a.bottomField,b,c),this.VWa(5,a.leftField,b,c),this.VWa(6,a.rightField,b,c))}VWa(a,b,c,f){b&&b.itemField&&
this.veh(a,b.itemField,c,f)}veh(a,b,c,f){let l;({d3a:l,c3a:a}=Wp.$Pa(a));b.wFieldSpecified&&f.ke(l,ke.a.FSd(b.wField));if(b.solidFillField)if(this.RTa)f.ke(a,b.solidFillField);else{if(b=If.Box4ColorHelper.EEb(b.solidFillField,c))b=If.Box4ColorHelper.dna(b),f.ke(a,b)}else b.noFillField&&(this.RTa&&qd.a("TableBordersLocalRenderingFix")?(b=If.Box4ColorHelper.q0({Color:"##T,0,0,0"}),f.ke(a,b),f.ke(l,0)):f.ke(a,Jb.a.gOa))}}Object(e.a)(sL,"TableStyleResolver",null,[484]);var tL=d(317),QD=d(191);class Gx{constructor(a,
b,c,f=null){this.Eua=!1;this.JA=this.Fn=this.xb=this.UCg=this.YPg=null;this.$B=[];this.El=this.HG=!1;this.n_=null;this.ro=this.H$a=!1;this.Ga=b;this.kLg=a;this.jd=f;this.QS=(this.GZc=c)?10:6;this.Foe=c?2:nf.a.VD}get visible(){return this.Eua}set visible(a){this.Eua!==a&&(this.Eua=a,this.Gkh())}get za(){return this.xb.viewport.za}zai(a,b,c){this.YPg=a;this.UCg=c;this.Vm();this.jd.pb(ra.a.click,this.za,Object(C.a)(this,this.oUg,"notifySelectShapeByClick"));b.appendChild(this.xb.viewport);this.YPg.GX(this.za,
!0);this.H$a=!0;this.setZIndex(2+iD.a.w$+1)}lyh(){this.H$a&&this.xb&&this.jd.zb(ra.a.click,this.za,Object(C.a)(this,this.oUg,"notifySelectShapeByClick"));this.H$a=!1}setZIndex(a){this.H$a&&this.xb.tC(a)}Vm(){this.xb||(this.xb=new QD.a,this.Fn=new qn.a,this.Fn.xF(Gk.a.none),this.Fn.pv(nf.a.f0),this.Fn.sr(nf.a.VD),this.xb.Tk(Ei.a.cA),this.xb.appendChild(this.Fn),this.JA=new pn.a,this.iWb(this.JA),this.xb.appendChild(this.JA),this.xb.Sd(!1),this.xb.viewport.za.setAttribute(Gk.a.NCb,Gk.a.none))}xm(){if(this.H$a){var a=
this.O$i(this.UCg);this.HG?(this.n_&&this.n_.Fm(a),this.Fn.Mt(a.points)):(a=a.points,this.Fn.Mt(a),a=new qi.a(a[0],a[1],a[2],a[3]));this.fX(a);this.xb.xm()}}iWb(a){for(let f=0;8>f;++f){var b="selectionHandle"+f;const l=new pn.a;l.za.id=b;if(r.a.FIa){var c=new tL.a;c.za.id=b;c.za.setAttribute("class",Ml.a.fjd);c.setVisibility(!1);c.setPosition(-10,-10);c.Bh(20,20);l.appendChild(c)}c=new tL.a;c.za.id=b;c.za.setAttribute("class",Ml.a.fjd);b=this.QS/2*-1;c.setPosition(b,b);c.Bh(this.QS,this.QS);this.GZc&&
c.Jkh(this.QS/2,this.QS/2);c.xF("white");c.pv(nf.a.f0);c.sr(this.Foe);c.blh();l.appendChild(c);l.Uk(1);this.$B[f]=l;a.appendChild(l)}}fX(a){for(let b=0;8>b;++b){const c=this.$B[b];c.Tk(Gx.Dic[b]);this.$Ha(c,a.Yj(new ge.a(b)))}}O$i(a){return new qi.a(new ic.a(0,0),new ic.a(a.offsetWidth,0),new ic.a(a.offsetWidth,a.offsetHeight),new ic.a(0,a.offsetHeight))}wF(a){this.ro||((this.HG=a)?(this.Fn.xF(nf.a.tXf),this.Fn.pv(nf.a.f0),this.Fn.sr(nf.a.VD),this.JA.Sd(!1),this.kLg.endEditing(!0,14)):(this.Fn.xF(Gk.a.none),
this.Fn.pv(nf.a.f0),this.Fn.sr(nf.a.VD),this.JA.Sd(!0),this.Ga.vf(Xd.a.sg),this.kLg.PQ()))}dispose(){this.El||(this.lyh(),this.Fn=this.xb=null,Array.clear(this.$B),this.JA=null,this.H$a=!1,this.El=!0)}Wjg(a){if(!this.H$a)return null;for(let b=0;8>b;++b)if(this.$B[b].za.id===a.id)return new ge.a(b);return null}$Ha(a,b){a.setPosition(b.x,b.y)}oUg(a){return this.Wjg(a.Hc)?!0:!1}Hza(a,b){return[new ic.a(a[0]._x-b,a[0]._y-b),new ic.a(a[1]._x+b,a[1]._y-b),new ic.a(a[2]._x+b,a[2]._y+b),new ic.a(a[3]._x-
b,a[3]._y+b)]}cD(a){this.wF(!0,a)}qz(){this.wF(!1)}Nq(a){this.n_&&this.n_.clear();this.n_=a;this.xm()}Rx(a){this.ro=a;this.Gkh()}Gkh(){this.xb&&this.xb.Sd(!this.ro&&this.Eua)}static UVb(a){return new Gx(a,lb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptChangeResizeHandleEnabled,u.AFrameworkApplication.Ba.Ux)}}Gx.Dic=[Ei.a.iNe,Ei.a.hNe,Ei.a.gNe,Ei.a.fNe,Ei.a.jNe,Ei.a.kNe,Ei.a.lNe,Ei.a.mNe];Object(e.a)(Gx,"DraggablePandoraChromeView",
null,[1281]);class uL{}Object(e.a)(uL,"TableStyleCategoryInfo",null,[]);class of{static FKi(){if(of.Ug)return of.Ug;of.Ug=new Bc.a;of.Ug.$("No Style, No Grid",ResourceStrings.l_TableThemedStyle1);of.Ug.$("Themed Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,1));of.Ug.$("Themed Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,2));of.Ug.$("Themed Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,1,3));of.Ug.$("Themed Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,4));of.Ug.$("Themed Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,5));of.Ug.$("Themed Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,6));of.Ug.$("No Style, Table Grid",ResourceStrings.l_TableThemedStyle2);of.Ug.$("Themed Style 2 - Accent 1",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,1));of.Ug.$("Themed Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,2));of.Ug.$("Themed Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,3));of.Ug.$("Themed Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,4));of.Ug.$("Themed Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,2,5));of.Ug.$("Themed Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,6));of.Ug.$("Light Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,1));of.Ug.$("Light Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,1));of.Ug.$("Light Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
1,2));of.Ug.$("Light Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,3));of.Ug.$("Light Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,4));of.Ug.$("Light Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,5));of.Ug.$("Light Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,6));of.Ug.$("Light Style 2",
String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,2));of.Ug.$("Light Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,1));of.Ug.$("Light Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,2));of.Ug.$("Light Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,3));of.Ug.$("Light Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleLight,2,4));of.Ug.$("Light Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,5));of.Ug.$("Light Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,6));of.Ug.$("Light Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,3));of.Ug.$("Light Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
3,1));of.Ug.$("Light Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,2));of.Ug.$("Light Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,3));of.Ug.$("Light Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,4));of.Ug.$("Light Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,5));of.Ug.$("Light Style 3 - Accent 6",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,6));of.Ug.$("Medium Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,1));of.Ug.$("Medium Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,1));of.Ug.$("Medium Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,2));of.Ug.$("Medium Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,1,3));of.Ug.$("Medium Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,4));of.Ug.$("Medium Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,5));of.Ug.$("Medium Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,6));of.Ug.$("Medium Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,
2));of.Ug.$("Medium Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,1));of.Ug.$("Medium Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,2));of.Ug.$("Medium Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,3));of.Ug.$("Medium Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,4));of.Ug.$("Medium Style 2 - Accent 5",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,5));of.Ug.$("Medium Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,6));of.Ug.$("Medium Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,3));of.Ug.$("Medium Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,1));of.Ug.$("Medium Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,3,2));of.Ug.$("Medium Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,3));of.Ug.$("Medium Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,4));of.Ug.$("Medium Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,5));of.Ug.$("Medium Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
3,6));of.Ug.$("Medium Style 4",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,4));of.Ug.$("Medium Style 4 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,1));of.Ug.$("Medium Style 4 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,2));of.Ug.$("Medium Style 4 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,3));of.Ug.$("Medium Style 4 - Accent 4",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,4));of.Ug.$("Medium Style 4 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,5));of.Ug.$("Medium Style 4 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,6));of.Ug.$("Dark Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));of.Ug.$("Dark Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleDark,1,1));of.Ug.$("Dark Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,2));of.Ug.$("Dark Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,3));of.Ug.$("Dark Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,4));of.Ug.$("Dark Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,
1,5));of.Ug.$("Dark Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,6));of.Ug.$("Dark Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));of.Ug.$("Dark Style 2 - Accent 1/Accent 2",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,1,2));of.Ug.$("Dark Style 2 - Accent 3/Accent 4",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,
2,2,3));of.Ug.$("Dark Style 2 - Accent 5/Accent 6",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,4,5));return of.Ug}static Kdg(a){const b=of.FKi();return b.Kb(a)?b.ga(a):a}}of.Ug=null;Object(e.a)(of,"TableStyleNameReader",null,[]);class vL{constructor(a){this.AEg=!1;this.vwb=[];this.$ie=new Ie.a(0);this.Qde=[];this.IMg=a}oZf(){this.AEg||(this.AEg=this.rtk())}rtk(){const a=this.IMg.instance?this.IMg.instance.Bhl:null;if(a&&a.tblStyleCategoriesField){let b=
0;this.vwb=[];this.$ie=new Ie.a(0);this.Qde=[];for(let c=0;c<a.tblStyleCategoriesField.length;c++){const f=a.tblStyleCategoriesField[c];if(f.tblStylesField&&0<f.tblStylesField.length){Array.add(this.Qde,Object.assign(new uL,{id:f.idField,begin:b,end:b+f.tblStylesField.length-1}));for(let l=0;l<f.tblStylesField.length;l++){const w=f.tblStylesField[l],F=new H.DictionaryPropertySet,S=new JD(w,f.idField,l);F.ke(zb.a.tableStyle,S);this.vwb.push(F);this.$ie.$(w.styleIdField.toLowerCase(),b++)}}}return!0}return!1}SWd(){return this.vwb}Bsb(a){return 0<=
a&&a<this.vwb.length?this.vwb[a]:null}Ubj(a,b){let c=null;for(const f of this.Qde)if(f.id===a){c=f;break}return c&&(a=c.begin+b,a<=c.end)?this.Bsb(a):null}ccj(a){return this.l0b(a).vua.styleIdField}dcj(a){return(a=this.l0b(a).vua.styleNameField)?qd.a("TableStyleNameLocalization")?of.Kdg(a):a:""}Xbj(a){return this.l0b(a).KCg}l0b(a){return a.Uh(zb.a.tableStyle)}Jdg(a){return(a=this.Ucj(a))?a.Uh(zb.a.tableStyle):null}Ucj(a){this.oZf();return this.vwb[this.$ie.ga(a.toLowerCase())]}}Object(e.a)(vL,"TableStyleGalleryManager",
null,[485]);class wL{constructor(a,b,c,f,l){this.KK=0;f||(f=Object.assign(new cr.a,{ge:0,Tf:c.dO,ae:0,Lf:c.xQ}));this.Yde=a;this.I6j=b;this.Wka=c;this.yD=f;this.Cz=new cr.a;this.ON=this.KK=-1;this.AYc=l}get wvg(){return-1===this.ON||-1===this.KK}moveNext(){this.wvg&&(this.ON=this.yD.ge,this.Cz.Lf=this.yD.ae);for(;;){this.KK=this.Cz.Lf;if(this.KK>=this.yD.Lf&&(this.KK=this.yD.ae,++this.ON>=this.yD.Tf))return this.reset(),!1;this.Cz=this.Yde.MH(this.Wka,this.ON,this.KK);if(this.ON===this.yD.ge||this.ON===
this.Cz.ge)if(!this.AYc||this.AYc.SEd(this))return!0}}mbk(){this.wvg&&(this.KK=this.yD.ae,this.Cz.Tf=this.yD.ge);for(;;){this.ON=this.Cz.Tf;if(this.ON>=this.yD.Tf&&(this.ON=this.yD.ge,++this.KK>=this.yD.Lf)){this.reset();break}this.Cz=this.Yde.MH(this.Wka,this.ON,this.KK);if(this.KK===this.yD.ae||this.KK===this.Cz.ae)if(!this.AYc||this.AYc.SEd(this))break}}moveTo(a,b){this.Cz=this.Yde.MH(this.Wka,a,b);if(!this.Cz.fNi(this.yD))return this.reset(),!1;this.ON=Math.min(Math.max(a,this.yD.ge),this.yD.Tf-
1);this.KK=Math.min(Math.max(b,this.yD.ae),this.yD.Lf-1);return!0}reset(){this.ON=this.KK=-1}SZb(){return this.I6j.hf(this.Cz.ge,this.Cz.ae)}}Object(e.a)(wL,"CellIterator",null,[1340]);class xL{constructor(a){this.oq=a}eBa(a,b,c,f=null){return new wL(this.oq,a,b,c,f)}}Object(e.a)(xL,"CellIteratorFactory",null,[480]);class RD{constructor(a,b,c){this.oq=b;this.Wka=c;this.WB=this.oq.hIc(this.Wka,a.yD);this.T7=Array(this.WB.xQ*(this.WB.dO+1));this.ON=this.WB.ge;this.J9a=this.WB.ae;this.Awb=this.WB.ae-
1;this.rp=0;this.y5d(a)}y5d(a){const b=a.yD;for(;a.moveNext();){const f=a.Cz;for(let l=f.ae;l<f.Lf;l++){var c=this.BBa(f.ge,l);this.T7[c]=0!==this.T7[c]?2:l<b.ae&&f.ge>b.ge?16:l>=b.Lf&&f.ge>b.ge?64:1;c=this.BBa(f.Tf,l);this.T7[c]=0!==this.T7[c]?2:l<b.ae&&f.Tf<b.Tf?16:l>=b.Lf&&f.Tf<b.Tf?64:4}}}BBa(a,b){return this.WB.xQ*(a-this.WB.ge)+(b-this.WB.ae)}moveNext(){this.J9a=this.Awb;do{this.J9a++;this.J9a>=this.WB.Lf&&(this.ON++,this.J9a=this.WB.ae);if(this.ON>this.WB.Tf)return!1;this.rp=this.T7[this.BBa(this.ON,
this.J9a)]}while(0===this.rp);for(this.Awb=this.J9a;this.Awb+1<this.WB.Lf&&this.T7[this.BBa(this.ON,this.Awb+1)]===this.rp;)this.Awb++;return!0}eYi(){return this.Awb+1}static G7d(a){return!!(a&87)}}Object(e.a)(RD,"HorizontalTableBorderIterator",null,[1338,616]);class yL{constructor(a){this.oq=a}bwi(a,b){return new RD(a,this.oq,b)}}Object(e.a)(yL,"HorizontalTableBorderIteratorFactory",null,[481]);var Lz;(function(a){a[a.none=0]="none";a[a.firstLayout=1]="firstLayout";a[a.paragraphPropertyChange=2]=
"paragraphPropertyChange";a[a.cellChildTopoChange=3]="cellChildTopoChange";a[a.rowPropertyChange=4]="rowPropertyChange";a[a.cellPropertyChange=5]="cellPropertyChange";a[a.panelLayoutChange=6]="panelLayoutChange";a[a.tablePropertyChange=7]="tablePropertyChange";a[a.tableNodeConnected=8]="tableNodeConnected";a[a.tableViewElementDisconnected=9]="tableViewElementDisconnected";a[a.tableComplexityChange=10]="tableComplexityChange";a[a.slideInvalidateRenderSize=11]="slideInvalidateRenderSize"})(Lz||(Lz=
{}));Object(e.b)("LayoutInvalidateTrigger",Lz);class zL{constructor(){this.$ga=this.yJd=this.umc=this.yNd=0}get rowSpan(){return this.yJd-this.umc}toString(){return String.format("C[{0}][{1}]",this.umc,this.$ga)}}Object(e.a)(zL,"CellInfo",null,[]);class dr{constructor(){this.WQc=!1;this.Vc=this.oLf=this.telemetry=null;this.c9a=this.jkc=!1;this.hjd=null;this.xRg=0;this.tableNode=this.mbe=this.Hwa=null;this.eUd=!1}}Object(e.a)(dr,"LayoutContext",null,[]);class AL{constructor(){this.Sph=this.Cmd=0}}
Object(e.a)(AL,"LayoutTelemtry",null,[]);class SD{constructor(){this.offset=this.Ebc=this.index=0}toString(){return String.format("Index {0}, H {1}, O {2}",this.index,this.Ebc,this.offset)}}Object(e.a)(SD,"RowSeamInfo",null,[]);class uh{constructor(a,b,c,f,l,w,F){this.ZB=null;this.Ixb=[];this.GFa=[];this.rW=0;this.El=this.P_c=!1;this.Eab=null;this.XZc=!1;this.S_c=0;this.Te=null;this.eC=a;this.Bb=f;this.zac=l;this.Fk=w;this.Ib=c;this.JW=F;this.D2b(1)}xyj(a,b){if(!this.P_c&&!this.XZc)try{2!==this.rW&&
(1===this.rW?this.Ixb[0]!==a&&this.D2b(b):(this.Ixb[this.Ixb.length]=a,this.rW=1,this.S_c=b))}catch(c){this.D2b(0),za.a.J(36439750,808,10,"PPTTableLayoutService::InvalidateCell failed {0}",c.toString())}}D2b(a){this.XZc||2===this.rW||this.P_c||(this.rW=2,this.Ixb=[],this.S_c=a)}u3d(){return 0!==this.rW&&!this.P_c}get IQc(){return this.rW}dAh(a){this.u3d()&&(a=Object.assign(new dr,{tableNode:a}),this.layout(a))}ksl(a,b){this.u3d()?this.Eab||(this.Eab=new Se.a(3,1,0,Object(C.a)(this,this.ksk,"performLayout"),
90,"9"),this.Eab.customData=Object.assign(new dr,{tableNode:a,WQc:!0,mbe:b}),this.Bb.Hb(this.Eab)):b&&b(!1)}ksk(a){this.layout(Object(ua.a)(dr,a.customData))}layout(a){this.XZc=!0;const b=new Tb.a(null,Object(C.a)(this,this.Cvj,"initializeLayoutState"),a);b.Ui=!a.WQc;b.run()}Cvj(a,b){b=Object(ua.a)(dr,b);try{this.cKi();b.Vc=this.Te;b.telemetry=new AL;this.mwl();if(!this.u3d())return a.Wg(Object(C.a)(this,this.Zwa,"tearDownLayout")),!0;this.rW=0;if(!b.tableNode.isConnected)return a.Wg(Object(C.a)(this,
this.Zwa,"tearDownLayout")),!0;const c=Object(ua.a)(1278,b.tableNode.pc(this.eC));if(!c)return a.Wg(Object(C.a)(this,this.Zwa,"tearDownLayout")),!0;b.hjd=c;b.Vc.Ya(uh.y9h,b.WQc.toString());b.tableNode.hp()?(b.Vc.Ya(uh.Iyg,Lz[this.S_c]),a.Wg(Object(C.a)(this,this.dxk,"prepareTableMetrics"))):(b.Vc.Ya(uh.Iyg,"tableComplexityChange"),b.jkc=!0,b.c9a=!0,a.Wg(Object(C.a)(this,this.Zwa,"tearDownLayout")))}catch(c){b.Vc.Ya(uh.m5b,c.message),a.Wg(Object(C.a)(this,this.Zwa,"tearDownLayout"))}return!0}dxk(a,
b){b=Object(ua.a)(dr,b);try{b.Hwa=new Date,this.JW.e5g(b.tableNode,this.eC),b.Vc.Ya(uh.Zwk,(+new Date-+b.Hwa).toString()),b.Vc.Ya(uh.pak,this.JW.ACj.toString()),a.Wg(Object(C.a)(this,this.VPj,"layoutBaselineTable"))}catch(c){b.Vc.Ya(uh.m5b,c.message),a.Wg(Object(C.a)(this,this.Zwa,"tearDownLayout"))}return!0}VPj(a,b){b=Object(ua.a)(dr,b);try{b.Hwa=new Date;b.eUd=!0;b.xRg=uh.y$j;this.ZB=[];this.ZB[this.ZB.length]=Object.assign(new SD,{index:0,Ebc:0,offset:0});const c=new eh.a(this.eC);c.set(b.tableNode);
if(!c.yb(1))throw Error.invalidOperation(uh.k1f);const f=b.tableNode;let l=c.currentNode,w=l,F=0,S=0,fa=0;for(;l;){15===l.type&&(w=l,fa=F=0,l=c.yb(1));const xa=l;if(!xa)throw za.a.J(588862351,808,10,"PPTTableLayoutService::LayoutBaselineTable Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");if(1===xa.rowSpan){const Za=Object(ua.a)(Us,l.pc(this.eC));F=Math.max(F,this.JW.TZb(f,Za.cha,S,fa))}l=c.xj(1);fa++;if(!l){const Za=Object.assign(new SD,{index:this.ZB.length});let pb=w.ta(zb.a.Nt,
0);pb=Math.max(pb,this.Fk.SBc(w));let Mb=b.hjd.Gd.Ed.Ie(pb,1);Mb=Math.max(Mb,F);Za.offset=Mb+this.ZB[Za.index-1].offset;Za.Ebc=Mb;this.ZB[this.ZB.length]=Za;l=c.xf(1);S++}}a.Wg(Object(C.a)(this,this.$Pj,"layoutRowSeams"));b.Vc.Ya(uh.YPj,(+new Date-+b.Hwa).toString())}catch(c){b.Vc.Ya(uh.m5b,c.message),b.jkc=!0,a.Wg(Object(C.a)(this,this.Zwa,"tearDownLayout"))}return!0}$Pj(a,b){b=Object(ua.a)(dr,b);try{if(1===this.ZB.length)throw Error.create(uh.SNi);let c=b.oLf;if(!c){b.Hwa=new Date;c=new eh.a(this.eC);
c.set(b.tableNode);if(!c.yb(1))throw Error.invalidOperation(uh.k1f);b.oLf=c}const f=b.tableNode;let l=c.currentNode,w=0,F=0,S=0;for(;l&&w<b.xRg;){15===l.type&&(l=c.yb(1),F=0);const fa=l;if(!fa)throw za.a.J(588862349,808,10,"PPTTableLayoutService::LayoutRowSeams Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");w++;b.telemetry.Cmd++;1===fa.rowSpan||Vi.OutlineReader.isEmpty(c)?b.telemetry.Sph++:this.bQj(this.uui(f,fa,S,F),b.Vc);l=c.xj(1);F++;l||(l=c.xf(1),S++)}l||(this.qgl(),
a.Wg(Object(C.a)(this,this.oRi,"fixupTableMinRowHeight")),b.Vc.Ya(uh.aQj,(+new Date-+b.Hwa).toString()))}catch(c){b.Vc.Ya(uh.m5b,c.message),b.jkc=!0,a.Wg(Object(C.a)(this,this.Zwa,"tearDownLayout"))}return!0}oRi(a,b){b=Object(ua.a)(dr,b);try{const l=b.hjd;b.Hwa=new Date;const w=[];var c=new eh.a(this.eC);c.set(b.tableNode);for(var f=c.yb(1);f;)w[w.length]=c.xq,f=c.xj(1);if(this.GFa.length===w.length){c=[];for(f=0;f<w.length;++f)c[f]=0,1<Math.abs(this.GFa[f]-w[f].htmlElement.offsetHeight)&&(c[f]=this.GFa[f]);
for(f=0;f<c.length;++f)0<c[f]&&w[f].gGb(c[f]*l.C_d())}else throw Error.invalidOperation(String.format("RowMisMatch{0},{1}",this.GFa.length,w.length));a.Wg(Object(C.a)(this,this.Zwa,"tearDownLayout"));b.Vc.Ya(uh.kRi,(+new Date-+b.Hwa).toString());b.c9a=!0}catch(l){b.Vc.Ya(uh.m5b,l.message),b.jkc=!0,a.Wg(Object(C.a)(this,this.Zwa,"tearDownLayout"))}return!0}Zwa(a,b){a=Object(ua.a)(dr,b);a.Hwa=new Date;a.jkc?(this.nSk(a.Vc,a.tableNode,a.hjd),a.eUd=!0):a.Vc&&(a.Vc.Ya(uh.dQj,a.telemetry.Cmd.toString()),
a.Vc.Ya(uh.cQj,a.telemetry.Sph.toString()));this.Eab&&!a.WQc&&this.Bb.ah(this.Eab);this.XZc=!1;this.Eab=null;this.S_c=0;a.Vc&&(a.Vc.Ya(uh.c9a,a.c9a.toString()),!a.c9a&&a.Vc&&a.Vc.Ya(uh.tableLayout,this.JW.jSd(a.tableNode)),a.Vc.Ya(uh.Zhl,(+new Date-+a.Hwa).toString()),a.Vc.finish());a.c9a||(this.P_c=!0);this.ZB=null;this.Ixb=[];this.Te=null;this.JW.reset();a.mbe&&a.mbe(a.eUd);return!1}nSk(a,b,c){if(b.isConnected)try{const f=new eh.a(this.eC);f.set(b);let l=f.yb(1);for(;l;){const w=Object(ua.a)(uv,
f.cOa);if(!w)throw Error.argument("tableRowViewElement");let F=c.Gd.Ed.Ie(l.ta(zb.a.Nt,0),1);const S=c.C_d();F*=S;w.gGb(F);l=f.xj(1)}}catch(f){a&&a.Ya(uh.mSk,f.message)}}bQj(a,b){if(!a)throw Error.create(uh.RNi);var c=this.ZB[a.umc];const f=this.ZB[a.yJd];c=Math.max(this.l5i(c,f),a.yNd)-(f.offset-c.offset);if(!(0>=c)&&(this.H5h(f.index,c),f.offset<=this.ZB[f.index-1].offset)){b.Ya(uh.dii,a.toString());for(a=0;a<=f.index;++a)b.Ya(uh.WVk,this.ZB[a].toString());throw Error.create(uh.TNi);}}qgl(){if(this.ZB){this.GFa=
[];for(let a=1;a<this.ZB.length;++a)this.GFa[this.GFa.length]=this.ZB[a].offset-this.ZB[a-1].offset}else this.GFa=null}H5h(a,b){if(b)for(var c=a,f=0;c<this.ZB.length;){b=c===a?b:b+this.ZB[c].Ebc-this.ZB[c].offset+f;if(0>=b)break;f=this.ZB[c].offset;this.ZB[c].offset+=b;c++}}l5i(a,b){if(a.index>=b.index)return 0;let c=0;for(a=a.index;a<b.index;)c+=this.ZB[a+1].Ebc,a++;return c}uui(a,b,c,f){if(!b||!b.isConnected)return null;const l=Object(ua.a)(Us,b.pc(this.eC)),w=this.Ib.Jc(b);w.oc(14);a=Object.assign(new zL,
{yNd:this.JW.TZb(a,l.cha,c,f),umc:kk.c(w),$ga:f});a.yJd=a.umc+b.rowSpan;return a}dispose(){this.El||(this.Ixb=this.ZB=this.GFa=null,this.rW=0,this.El=!0)}mwl(){if(this.El)throw Error.invalidOperation("table layout service is already disposed");}cKi(){this.Te||(this.Te=Kc.a.Nm("TableLayout"))}get Na(){return this.eC}}uh.y$j=25;uh.m5b="FailureReason";uh.mSk="RestoreFailureReason";uh.tableLayout="Layout";uh.WVk="SI";uh.dii="CI";uh.y9h="FAsync";uh.dQj="CellVisited";uh.cQj="CellSkipped";uh.c9a="Succeeded";
uh.YPj="LETD";uh.aQj="LRST";uh.kRi="FMTR";uh.Zhl="TDLD";uh.Zwk="PM";uh.Iyg="Trigger";uh.pak="MC";uh.RNi="CellDisconnected";uh.SNi="ChildOfTableNotLoaded";uh.TNi="SeamPositionInvariant";uh.k1f="NoRowViewElement";Object(e.a)(uh,"PPTTableLayoutService",null,[1339,109]);class BL{constructor(a,b,c,f,l){this.Ib=a;this.Bb=b;this.zac=c;this.Fk=f;this.JW=l}create(a,b){return new uh(a,b,this.Ib,this.Bb,this.zac,this.Fk,this.JW)}}Object(e.a)(BL,"PPTTableLayoutServiceFactory",null,[487]);class CL{constructor(a,
b,c,f,l,w,F,S,fa){this.d4j=a;this.oo=b;this.Ib=c;this.QUa=f;this.SOg=l;this.Dbb=w;this.T9b=F;this.hv=S;this.BZc=!0;this.Kje=fa;this.xta=new Bc.a;this.oo.nD&&!this.oo.Gj&&(this.BZc=!1);this.BZc&&(this.QUa.nGd(Object(C.a)(this,this.TVg,"onBeforeTableViewElementDisconnected")),this.QUa.yga(Object(C.a)(this,this.M_g,"onTableNodeConnected")),this.QUa.yk(Object(C.a)(this,this.O_g,"onTableNodePropertyChanged")),this.QUa.l6(Object(C.a)(this,this.N_g,"onTableNodeDisconnected")),this.SOg.yk(Object(C.a)(this,
this.Q_g,"onTableRowNodePropertyChanged")),this.Dbb.yk(Object(C.a)(this,this.r8c,"onTableCellNodePropertyChanged")),this.Dbb.ZF(Object(C.a)(this,this.L_g,"onTableCellNodeChildTopoChanged")),this.T9b.yk(Object(C.a)(this,this.VYg,"onParagraphNodePropertyChanged")),this.hv.p4h(Object(C.a)(this,this.l_g,"onSlideInvalidateRenderSize")))}ZMc(a,b){if(!this.BZc)return null;var c=a.id.toString();this.xta.Kb(c)||this.xta.$(c,new wr.a);c=this.xta.ga(c);var f=a.hp();f=this.Kje?f&&Cd.TableReader.rPf(Object(ua.a)(mb.GraphIterator,
this.Ib.Jc(a))):f;if(c.Kb(b))return b=c.ga(b),f||0!==b.IQc||(this.Zah(a),b=null),b;if(f)c.$(b,this.d4j.create(b,a.id));else return null;return c.ga(b)}Ktb(a,b,c){a.hp()?this.qpg(a.id.toString(),b,c):10===c&&this.qpg(a.id.toString(),b,c)}qpg(a,b,c){if(this.xta.Kb(a))for(let f of this.xta.ga(a).values)b?f.xyj(b,c):f.D2b(c)}A6d(a,b,c){a.isConnected&&(a=this.Ib.Jc(a),a.oc(14)&&this.Ktb(a.lw(14),b,c))}pyj(a){a.isConnected&&(a=this.Ib.Jc(a),a.oc(14)&&this.Ktb(a.lw(14),a.lw(16),2))}TVg(a,b){b.yr.Qc.Po&&
this.Ktb(b.yr.gb,null,9)}M_g(a,b){this.Ktb(b.node,null,8);a=Object(ua.a)(Kz.TableNode,b.node);a=!!a&&a.hp();za.a.J(41007133,808,50,"Render table, isComplexTable: {0}",a)}N_g(a,b){this.Zah(b.node)}Zah(a){a=a.id.toString();if(this.xta.Kb(a)){const b=this.xta.ga(a);for(let c of b.values)c&&c.dispose();this.xta.remove(a)}}O_g(a,b){a=b.property;b.node.isConnected&&(a===ob.a.ru||a===ob.a.Gea||a===ob.a.rA||a===zb.a.Ggb||a===zb.a.cid||a===zb.a.LIa||a===zb.a.tlc?this.Ktb(b.node,null,7):a===zb.a.complexTable&&
this.Ktb(b.node,null,10))}Q_g(a,b){a=b.property;b.node.isConnected&&a===zb.a.Nt&&this.A6d(b.node,null,4)}r8c(a,b){a=b.property;!b.node.isConnected||a!==zb.a.rowSpan&&a!==zb.a.colSpan||this.A6d(b.node,null,5)}L_g(a,b){b.node.isConnected&&1===b.GY&&this.A6d(b.node,b.node,3)}VYg(a,b){a=Object(ua.a)(5,b.node);b=b.property;a&&a.isConnected&&a.Sa(zb.a.cellId)&&!a.Efc&&(b===ob.a.Vp||b===ob.a.Ngb)&&this.pyj(a)}l_g(){for(let a of this.xta.keys)for(let b of this.xta.ga(a).values)b.D2b(11)}dispose(){this.BZc&&
(this.QUa.qDe(Object(C.a)(this,this.TVg,"onBeforeTableViewElementDisconnected")),this.QUa.mma(Object(C.a)(this,this.M_g,"onTableNodeConnected")),this.QUa.Pm(Object(C.a)(this,this.O_g,"onTableNodePropertyChanged")),this.QUa.xHa(Object(C.a)(this,this.N_g,"onTableNodeDisconnected")),this.SOg.Pm(Object(C.a)(this,this.Q_g,"onTableRowNodePropertyChanged")),this.Dbb.Pm(Object(C.a)(this,this.r8c,"onTableCellNodePropertyChanged")),this.Dbb.kO(Object(C.a)(this,this.L_g,"onTableCellNodeChildTopoChanged")),this.T9b.Pm(Object(C.a)(this,
this.VYg,"onParagraphNodePropertyChanged")),this.hv.mOk(Object(C.a)(this,this.l_g,"onSlideInvalidateRenderSize")))}}Object(e.a)(CL,"PPTTableLayoutServiceManager",null,[488,109]);class TD{constructor(a,b,c){this.oq=b;this.Wka=c;this.WB=this.oq.hIc(this.Wka,a.yD);this.T7=Array(this.WB.dO*(this.WB.xQ+1));this.KK=this.WB.ae;this.dbb=this.WB.ge;this.Gzb=this.WB.ge-1;this.rp=0;this.y5d(a)}y5d(a){const b=a.yD;for(;a.moveNext();){const f=a.Cz;for(let l=f.ge;l<f.Tf;l++){var c=this.BBa(l,f.ae);this.T7[c]=0!==
this.T7[c]?32:l<b.ge&&f.ae>b.ae?1:l>=b.Tf&&f.ae>b.ae?4:16;c=this.BBa(l,f.Lf);this.T7[c]=0!==this.T7[c]?32:l<b.ge&&f.Lf<b.Lf?1:l>=b.Tf&&f.Lf<b.Lf?4:64}}}BBa(a,b){return this.WB.dO*(b-this.WB.ae)+(a-this.WB.ge)}moveNext(){this.dbb=this.Gzb;do{this.dbb++;this.dbb>=this.WB.Tf&&(this.KK++,this.dbb=this.WB.ge);if(this.KK>this.WB.Lf)return!1;this.rp=this.T7[this.BBa(this.dbb,this.KK)]}while(0===this.rp);for(this.Gzb=this.dbb;this.Gzb+1<this.WB.Tf&&this.T7[this.BBa(this.Gzb+1,this.KK)]===this.rp;)this.Gzb++;
return!0}P9i(){return this.Gzb+1}static G7d(a){return!!(a&117)}}Object(e.a)(TD,"VerticalTableBorderIterator",null,[615,616]);class sl{constructor(a,b,c,f,l,w,F){this.Fk=a;this.oq=b;this.Ib=c;this.Rz=f;this.uca=l;this.n_j=w;this.V7j=F}Kql(a,b,c){const f=b.getContainingTable();f&&(this.Nml(b,f,a,c.Lf,c.ge),this.Mml(b,f,a,c.Tf,c.ae))}yVd(a,b,c,f,l,w){if(c&&c!==b.dO)for(;f<l;f++)if(9===(b.Kr(c-1,f)&9)&&5===(b.Kr(c,f)&5)){var F=this.oq.MH(b,c-1,f),S=this.oq.MH(b,c,f);F=a.hf(F.ge,F.ae);S=a.hf(S.ge,S.ae);
w?this.hpb(S,F,7,0):this.hpb(F,S,0,7)}}vHe(a,b,c,f,l){l=this.uca.eBa(a,b,c,l);c=f.RWi();if(TD.G7d(c)){let w=this.V7j.eAi(l,b);for(;w.moveNext();)0!==(c&w.rp)&&this.YIe(a,b,w.KK,w.dbb,w.P9i(),f.Bsb(w.rp),!0)}if(RD.G7d(c))for(l=this.n_j.bwi(l,b);l.moveNext();)0!==(c&l.rp)&&this.THe(a,b,l.ON,l.J9a,l.eYi(),f.Bsb(l.rp),!0)}YIe(a,b,c,f,l,w,F=!1){let S=this.Rz.mNc(a),fa=null;0<c&&(fa=a.hf(f,c-1));let xa=null;for(c<b.xQ&&(xa=a.hf(f,c));f<l;){if(fa){if(6===(b.Kr(f,c-1)&6)){var Za=this.oq.MH(b,f,c-1),pb=a.hf(Za.ge,
Za.ae);F&&S?S=this.BFb(S,pb,Za.ge,Za.ae,6,w):sl.Djc(6,pb,w)}f+1<l&&(fa=a.hf(f+1,c-1))}xa&&(5===(b.Kr(f,c)&5)&&(Za=this.oq.MH(b,f,c),pb=a.hf(Za.ge,Za.ae),F&&S?S=this.BFb(S,pb,Za.ge,Za.ae,5,w):sl.Djc(5,pb,w)),f+1<l&&(xa=a.hf(f+1,c)));f+=1}}zVd(a,b,c,f,l,w){if(c&&c!==b.xQ)for(;f<l;f++)if(6===(b.Kr(f,c-1)&6)&&5===(b.Kr(f,c)&5)){var F=this.oq.MH(b,f,c-1),S=this.oq.MH(b,f,c);F=a.hf(F.ge,F.ae);S=a.hf(S.ge,S.ae);w?this.hpb(S,F,5,6):this.hpb(F,S,6,5)}}THe(a,b,c,f,l,w,F=!1){let S=this.Rz.mNc(a),fa=null;0<c&&
(fa=a.hf(c-1,f));let xa=null;for(c<b.dO&&(xa=a.hf(c,f));f<l;){if(fa){if(9===(b.Kr(c-1,f)&9)){var Za=this.oq.MH(b,c-1,f),pb=a.hf(Za.ge,Za.ae);F&&S?S=this.BFb(S,pb,Za.ge,Za.ae,0,w):sl.Djc(0,pb,w)}f+1<l&&(fa=a.hf(c-1,f))}xa&&(5===(b.Kr(c,f)&5)&&(Za=this.oq.MH(b,c,f),pb=a.hf(Za.ge,Za.ae),F&&S?S=this.BFb(S,pb,Za.ge,Za.ae,7,w):sl.Djc(7,pb,w)),f+1<l&&(xa=a.hf(c,f)));f+=1}}Kwh(a,b,c,f){var l=null;if(!({ge:f}=sl.Xwh(b,c,f)).returnValue)return{returnValue:!1,jja:l};l=6;0<c&&sl.lub(b,f,c-1)?(b=this.oq.MH(b,
f,c-1),a=this.Ib.Jc(a.hf(b.ge,b.ae))):(l=5,b=this.oq.MH(b,f,c),a=this.Ib.Jc(a.hf(b.ge,b.ae)));l=this.t$f(a,l);return{returnValue:!0,jja:l}}Gwh(a,b,c,f){var l=null;if(!({ae:f}=sl.Rwh(b,c,f)).returnValue)return{returnValue:!1,jja:l};l=0;0<c&&sl.T8a(b,f,c-1)?(b=this.oq.MH(b,c-1,f),a=this.Ib.Jc(a.hf(b.ge,b.ae))):(l=7,b=this.oq.MH(b,c,f),a=this.Ib.Jc(a.hf(b.ge,b.ae)));l=this.t$f(a,l);return{returnValue:!0,jja:l}}BFb(a,b,c,f,l,w){const F=b.rowSpan;b=b.colSpan;for(let S=c;S<c+F;S++)for(let fa=f;fa<f+b;fa++)a.BFb(S,
fa,l,w);return a}t$f(a,b){a=a.Gp;if(!a||!a.cellShading)return null;let c=null;({jja:c}=this.Fk.LQe(b,a.cellShading));return c}hpb(a,b,c,f){if(a!==b&&!a.id.equals(b.id)){var l=null;b.cellShading&&(l=mk.a.BPa(b,zb.a.cellShading));l&&({jja:b}=this.Fk.LQe(f,l),sl.Djc(c,a,b))}}Nml(a,b,c,f,l){let w;({ge:w}=sl.Xwh(c,f,l)).returnValue&&(l=6,0<f&&sl.lub(c,w,f-1)?c=this.oq.MH(c,w,f-1):(l=5,c=this.oq.MH(c,w,f)),b=b.hf(c.ge,c.ae),this.hpb(a,b,6,l))}Mml(a,b,c,f,l){let w;({ae:w}=sl.Rwh(c,f,l)).returnValue&&(l=
0,0<f&&sl.T8a(c,w,f-1)?c=this.oq.MH(c,f-1,w):(l=7,c=this.oq.MH(c,f,w)),b=b.hf(c.ge,c.ae),this.hpb(a,b,0,l))}static Djc(a,b,c){let f=null;b.cellShading&&(f=b.cellShading);if(f){switch(a){case 7:f.lnTField=c;break;case 0:f.lnBField=c;break;case 5:f.lnLField=c;break;case 6:f.lnRField=c}b.cellShading=f}}static Xwh(a,b,c){let f,l;f=c;l=c+1;if(!sl.T8a(a,b,c))return{returnValue:!1,ge:f,Tf:l};for(;0<f&&!(0<b&&sl.lub(a,f,b-1))&&!(b<a.xQ&&sl.lub(a,f,b));f--);for(;l<a.dO&&!(0<b&&sl.lub(a,l,b-1))&&!(b<a.xQ&&
sl.lub(a,l,b));l++);return{returnValue:!0,ge:f,Tf:l}}static Rwh(a,b,c){let f;f=c;for(c+=1;0<f&&!(0<b&&sl.T8a(a,f,b-1))&&!(b<a.dO&&sl.T8a(a,f,b));f--);for(;c<a.xQ&&!(0<b&&sl.T8a(a,c,b-1))&&!(b<a.dO&&sl.T8a(a,c,b));c++);return{returnValue:!0,ae:f,Lf:c}}static T8a(a,b,c){return 0<b&&!(a.Kr(c,b-1)&2)||b<a.xQ&&!(a.Kr(c,b)&1)?!1:!0}static lub(a,b,c){return 0<b&&!(a.Kr(b-1,c)&8)||b<a.dO&&!(a.Kr(b,c)&4)?!1:!0}}Object(e.a)(sl,"TableBorderEditor",null,[1275,1276]);class DL{constructor(a,b,c,f){this.Ode=!1;
this.s_=a;this.K6j=b;this.fAb=c;this.Vke=f;this.hi=Array(this.s_.oX);for(a=0;a<this.s_.oX;a++)for(this.hi[a]=Array(this.s_.Rpa),b=0;b<this.s_.Rpa;b++)this.hi[a][b]=new kq.a}QWi(a,b,c){this.Ode||(this.K6j.KRk(a,this.s_),this.Ode=!0);if(qd.a("BugFixCacheInvalidIndex")){if(this.hi&&0<=b&&b<this.hi.length&&this.hi[b]&&0<=c&&c<this.hi[b].length)return this.hi[b][c];a=String.format("GetBorderStylePropertySet : Illegal cache access m_cache : {0} ,  row : {1}, col : {2} ",this.hi,b,c);this.hi&&(a+=String.format(" m_cache.Length : {0} ",
this.hi.length),a=this.hi[b]?a+String.format(" m_cache[ row ].Length : {0} ",this.hi[b].length):a+" m_cache[ row ] is null ");za.a.J(559724692,822,15,a);return null}return this.hi[b][c]}BFb(a,b,c,f){var l=this.fAb.xeh(c,this.s_.Ye,f);a=this.hi[a][b];for(var w of l.yz())a.ke(w,l.Uh(w));this.Vke&&qd.a("TableBordersLocalRenderingFix")&&({d3a:l,c3a:c,Inb:w}=Wp.$Pa(c),f.wFieldSpecified&&(f.noFillField?a.ke(l,0):a.ke(l,ke.a.FSd(f.wField))),f.solidFillField&&a.ke(c,f.solidFillField),f.prstDashField&&a.ke(w,
f.prstDashField))}dispose(){this.hi=null;this.Ode=!1}}Object(e.a)(DL,"TableBorderStyleCache",null,[1274,109]);class UD{constructor(a){this.Rme=a?1:0}SEd(a){const b=a.Cz;a=a.yD;return b.ae%2===this.Rme&&a.Dqb(b)}}Object(e.a)(UD,"BandedColumnFilter",null,[1341]);class VD{constructor(a){this.Rme=a?1:0}SEd(a){const b=a.Cz;a=a.yD;return b.ge%2===this.Rme&&a.Dqb(b)}}Object(e.a)(VD,"BandedRowFilter",null,[1341]);class EL{constructor(){this.diagBL2TR=this.right=this.insideVer=this.left=this.diagTL2BR=this.bottom=
this.insideHor=this.top=null}RWi(){let a=0;this.top&&(a|=1);this.insideHor&&(a|=2);this.bottom&&(a|=4);this.diagTL2BR&&(a|=8);this.left&&(a|=16);this.insideVer&&(a|=32);this.right&&(a|=64);this.diagBL2TR&&(a|=128);return a}Bsb(a){switch(a){case 1:return this.top;case 2:return this.insideHor;case 4:return this.bottom;case 8:return this.diagTL2BR;case 16:return this.left;case 32:return this.insideVer;case 64:return this.right;case 128:return this.diagBL2TR;default:return null}}}Object(e.a)(EL,"TableBorderSet",
null,[]);class FL{constructor(a,b){this.Q3=a;this.P6j=b}KRk(a,b){const c=b.oX,f=b.Rpa;var l=b.tableLook;b=b.tableStyle;const w=this.P6j.create(a),F=!!(l&32)&&!!b.firstRowField,S=!!(l&64)&&!!b.lastRowField,fa=!!(l&128)&&!!b.firstColField,xa=!!(l&256)&&!!b.lastColField,Za=F&&fa&&!!b.nwCellField,pb=F&&xa&&!!b.neCellField,Mb=S&&fa&&!!b.swCellField,hc=S&&xa&&!!b.seCellField;var kc=!(l&512)&&!!b.band1HField,Ec=!(l&512)&&!!b.band2HField,Hc=!(l&1024)&&!!b.band1VField;const Dc=!(l&1024)&&!!b.band2VField;l=
new cr.a;b.wholeTblField&&(l.ge=0,l.Tf=c,l.ae=0,l.Lf=f,this.apply(a,w,b.wholeTblField,l));l.ge=F?1:0;l.Tf=c-(S?1:0);l.ae=0;l.Lf=f;kc&&(kc=new VD(F),this.apply(a,w,b.band1HField,l,kc));Ec&&(Ec=new VD(!F),this.apply(a,w,b.band2HField,l,Ec));l.ge=0;l.Tf=c;l.ae=fa?1:0;l.Lf=f-(xa?1:0);Hc&&(Hc=new UD(fa),this.apply(a,w,b.band1VField,l,Hc));Dc&&(Hc=new UD(!Dc),this.apply(a,w,b.band2VField,l,Hc));xa&&(l.ge=0,l.Tf=c,l.ae=f-1,l.Lf=f,this.apply(a,w,b.lastColField,l));fa&&(l.ge=0,l.Tf=c,l.ae=0,l.Lf=1,this.apply(a,
w,b.firstColField,l));S&&(l.ge=c-1,l.Tf=c,l.ae=0,l.Lf=f,this.apply(a,w,b.lastRowField,l),hc&&(l.ae=f-1,l.Lf=f,this.apply(a,w,b.seCellField,l)),Mb&&(l.ae=0,l.Lf=1,this.apply(a,w,b.swCellField,l)));F&&(l.ge=0,l.Tf=1,l.ae=0,l.Lf=f,this.apply(a,w,b.firstRowField,l),pb&&(l.ae=f-1,l.Lf=f,this.apply(a,w,b.neCellField,l)),Za&&(l.ae=0,l.Lf=1,this.apply(a,w,b.nwCellField,l)))}apply(a,b,c,f,l=null){if(!f.YOa()&&c&&c.tcStyleField&&(c=c.tcStyleField.tcBdrField)){const w=new EL;c.topField&&c.topField.itemField&&
(w.top=c.topField.itemField);c.bottomField&&c.bottomField.itemField&&(w.bottom=c.bottomField.itemField);c.insideHField&&c.insideHField.itemField&&(w.insideHor=c.insideHField.itemField);c.leftField&&c.leftField.itemField&&(w.left=c.leftField.itemField);c.rightField&&c.rightField.itemField&&(w.right=c.rightField.itemField);c.insideVField&&c.insideVField.itemField&&(w.insideVer=c.insideVField.itemField);this.Q3.vHe(a,b,f,w,l)}}}Object(e.a)(FL,"TableBorderStyleResolver",null,[483]);class wv{constructor(a,
b,c,f){this.VN=a;this.Ib=b;this.uua=c;this.lF=f}Khi(a,b){const c=new cr.a;if(a.YOa())return c;const f=wv.q2f(b,a,a.ge,!0),l=wv.q2f(b,a,a.Tf-1,!1),w=wv.S1f(b,a,a.ae,!0);a=wv.S1f(b,a,a.Lf-1,!1);c.ge=f;c.Tf=l+1;c.ae=w;c.Lf=a+1;return c}gBj(a,b){for(var c=a.ge;c<a.Tf;++c)if(!(b.Kr(c,a.ae)&1&&b.Kr(c,a.Lf-1)&2))return!1;for(c=a.ae;c<a.Lf;++c)if(!(b.Kr(a.ge,c)&4&&b.Kr(a.Tf-1,c)&8))return!1;return!0}B6f(a){let b;b=null;const c=new cr.a;if(!(a&&a.nl&&a.kb&&a.V4))return{returnValue:c,tableNode:b};var f=a.ga(0).hg.Wa,
l=Object(ua.a)(Pl.TableCellNode,f.node);l&&(b=l.getContainingTable());if(!l||!b)return{returnValue:c,tableNode:b};f=l.rowIndex;l=l.pi;var w=Object(ua.a)(Pl.TableCellNode,a.ga(0).hg.We.node);var F=0;w&&(F=w.pi+1);if(b.hp()&&1!==a.length){F=Object(ua.a)(Pl.TableCellNode,a.jYa.currentNode);f=Object(ua.a)(Pl.TableCellNode,a.yha.currentNode);if(!F||!f)return{returnValue:c,tableNode:b};l=F.rowIndex;a=F.pi;w=f.rowIndex;F=f.pi;f=Math.min(l,w);w=Math.max(l,w)+1;l=Math.min(a,F);F=Math.max(F,a)+1}else w=f+a.length;
c.ge=f;c.Tf=w;c.ae=l;c.Lf=F;return{returnValue:c,tableNode:b}}MH(a,b,c){b=Object.assign(new cr.a,{ge:b,Tf:b+1,ae:c,Lf:c+1});return this.hIc(a,b)}hIc(a,b){const c=new cr.a;let f=b.ge,l=b.Tf-1;for(var w=b.ae;w<b.Lf;w++){for(var F=b.ge;0<F&&!(a.Kr(F,w)&4);F--);F<f&&(f=F);F=b.Tf-1;for(var S=a.dO-1;F<S&&!(a.Kr(F,w)&8);F++);F>l&&(l=F)}w=b.ae;F=b.Lf-1;for(S=b.ge;S<b.Tf;S++){let fa=b.ae;for(;0<fa&&!(a.Kr(S,fa)&1);fa--);fa<w&&(w=fa);fa=b.Lf-1;for(const xa=a.xQ-1;fa<xa&&!(a.Kr(S,fa)&2);fa++);fa>F&&(F=fa)}c.ge=
f;c.ae=w;c.Lf=F+1;c.Tf=l+1;return c}static q2f(a,b,c,f){if(f)for(;0<c;c--)for(f=b.ae;f<b.Lf;++f){if(a.Kr(c,f)&4)return c}else for(f=a.dO-1;c<f;c++)for(let l=b.ae;l<b.Lf;++l)if(a.Kr(c,l)&8)return c;return c}static S1f(a,b,c,f){if(f)for(;0<c;c--)for(f=b.ge;f<b.Tf;++f){if(a.Kr(f,c)&1)return c}else for(f=a.xQ-1;c<f;++c)for(let l=b.ge;l<b.Tf;++l)if(a.Kr(l,c)&2)return c;return c}}Object(e.a)(wv,"TableCellSelectionHelper",null,[478]);class GL{constructor(a,b,c){this.dQ=null;this.Z2=!1;if(!a||!a.isConnected||
14!==a.type)throw Error.argument("tableNode");this.Xd=a;this.wc=b;this.JW=c;this.rW=3}uTe(){try{var a=mb.GraphIterator.nb(this.Xd);Fd.forEachCellInTable(a,(b,c,f)=>{var l=Object(ua.a)(123,b.currentNode);if(l&&!l.isGhostCell){b=l.rowSpan+c;l=l.colSpan+f;for(let w=c;w<b;++w)for(let F=f;F<l;++F)w===c&&(this.dQ[w][F]|=4),w===b-1&&(this.dQ[w][F]|=8),F===f&&(this.dQ[w][F]|=1),F===l-1&&(this.dQ[w][F]|=2)}return!0})}catch(b){a=this.JW.jSd(this.Xd),za.a.J(38043909,822,15,"TableLayoutInfo:{0}, Message:{1}",
a,b.message)}}validate(){if(this.Z2)throw Error.invalidOperation("cache disposed");if(0!==this.rW){if(3===(this.rW&3)){const a=this.wc.Zj(this.Xd),b=this.wc.ui(this.Xd);this.dQ=Array(a);for(let c=0;c<a;++c){this.dQ[c]=Array(b);for(let f=0;f<b;++f)this.dQ[c][f]=0}}1===(this.rW&1)&&this.uTe();this.rW=0}}Kr(a,b){try{this.validate();var c=this.dQ[a][b]}catch(f){c=this.JW.jSd(this.Xd),za.a.J(38043911,822,15,"NumRows:{0} NumCols:{1} Row:{2} Col:{3}, TableLayoutInfo:{4}, Message:{5}",this.dO,this.xQ,a,b,
c,f.message),c=0}return c}cRa(a){this.rW|=a}dispose(){this.Z2=!0;this.dQ=null}get dO(){this.validate();return this.dQ?this.dQ.length:0}get xQ(){this.validate();return this.dQ&&this.dQ.length?this.dQ[0].length:0}}Object(e.a)(GL,"TableInfoCache",null,[1337,109]);class HL{constructor(a,b){this.wc=a;this.JW=b}create(a){return new GL(a,this.wc,this.JW)}}Object(e.a)(HL,"TableInfoCacheFactory",null,[489]);class Mz{constructor(a,b,c,f,l,w){this.k5j=a;this.MXj=b;this.S6j=c;this.g2j=f;this.i7j=l;this.X6j=w}get oX(){return this.k5j()}get Rpa(){return this.MXj()}get tableLook(){return this.S6j()}get cRj(){return this.g2j()}get Ye(){return this.i7j()}get tableStyle(){return this.X6j()}static CSf(a,
b,c,f,l,w){return new Mz(a,b,c,f,l,w)}}Object(e.a)(Mz,"TableListStyleParams",null,[387]);class IL{constructor(a){this.dla=null;this.TZc=!1;this.Lpe=this.zwb=null;this.Ib=a}get ACj(){return!!this.zwb}e5g(a,b){this.Lpe=a.id.toString();this.TZc=!this.Ib.T1i(a).currentNode.pc(b).HSc();this.zwb=null;this.TZc&&(a=a.pc(b),this.qKi(),ya.a.IVb(a.htmlElement,this.dla),this.zwb=this.mQi(this.dla))}TZb(a,b,c,f){if(a.id.toString()!==this.Lpe)throw Error.argument("table","Wrong table metrics");if(this.TZc){if(!this.zwb)throw Error.invalidOperation("m_clonedTableNode is null");
a=this.zwb.rows[c].cells[f];c=a.lastChild;c.className!==b.className&&(Z.ULS.sendTraceTag(587465758,808,10,"Cell content DOM structure changed, last child {0}",c.className),c=ya.a.rba(a,b.className));if(!c)throw Error.invalidOperation("No content");b=c}return b.offsetHeight}reset(){ya.a.rRa(this.dla)&&this.dla.parentNode.removeChild(this.dla);this.zwb=this.dla=null;this.TZc=!1;this.Lpe=null}jSd(a){const b=new Sys.StringBuilder;try{b.append(String.format("Row:{0},Col:{1},",a.properties.ta(ob.a.Uwa,
0),a.properties.ta(ob.a.Gea,0)));const c=this.Ib.Jc(a);Fd.forEachCellInTable(c,(f,l,w)=>{var F=f.currentNode;f=F.rowSpan;F=F.colSpan;(1<f||1<F)&&b.append(String.format("C[{0}][{1}]:{2}|{3},",l,w,f,F));return!0});return b.toString()}catch(c){return b.append(c.message),b.toString()}}qKi(){this.dla||(this.dla=document.createElement("div"),this.dla.className="TableMetricsWorkingDiv",document.body.appendChild(this.dla));ya.a.$za(this.dla)}mQi(a){for(a=a.firstChild;a;){if("table"===a.nodeName.toLowerCase())return a;
a=a.nextSibling}return null}}Object(e.a)(IL,"TableMetrics",null,[486]);class JL{constructor(a){this.Rz=a}LRk(a,b,c){return b&&a&&c&&(a=this.Rz.oNc(a).R7f(c,b.rowIndex,b.pi,b.rowSpan,b.colSpan))&&a!==Jb.a.auto?a.xC:-1}}Object(e.a)(JL,"TableThemeColorHelper",null,[490]);class KL{constructor(a){this.oq=a}eAi(a,b){return new TD(a,this.oq,b)}}Object(e.a)(KL,"VerticalTableBorderIteratorFactory",null,[482]);class WD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Table"}Yb(a){this.K=a;this.K.register(478,
"PowerPointWebEditor.ITableCellSelectionHelper").ma().na(()=>new wv(this.K.resolve("Box4.ITableNavigator"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader")));a.register(479,"Box4.ITableDragSelectionCellExtendStrategy").ma().na(()=>new gL(this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter")));
this.K.register(sl,"PowerPointWebEditor.TableBorderEditor").as("PowerPointWebEditor.ITableBorderEditor").as("PowerPointWebEditor.ITableBorderHelper").ma().na(()=>new sl(this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("PowerPointWebEditor.IHorizontalTableBorderIteratorFactory"),
this.K.resolve("PowerPointWebEditor.IVerticalTableBorderIteratorFactory")));this.K.register(480,"PowerPointWebEditor.ICellIteratorFactory").ma().na(()=>new xL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(481,"PowerPointWebEditor.IHorizontalTableBorderIteratorFactory").ma().na(()=>new yL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(482,"PowerPointWebEditor.IVerticalTableBorderIteratorFactory").ma().na(()=>new KL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));
this.K.register(483,"PowerPointWebEditor.ITableBorderStyleResolver").ma().na(()=>new FL(this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory")));this.K.register(em,"PowerPointWebEditor.TableEditor").as("PowerPointWebEditor.ITableEditor").as("Box4.ITableEditor").ma().na(()=>new em(this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("Box4.IOutlineElementEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
this.K.resolve("PowerPointWebEditor.Graph.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("Box4.IPageView").Na));this.K.register(OD,"PowerPointWebEditor.TableNodeBehavior").ma().na(()=>new OD(this.K.resolve("Box4.Graph.IGraphInstance").Cd(14),
this.K.resolve("Box4.ITableNodeBehaviorHelper"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IApplicationSettings").l2d));this.K.register(440,"PowerPointWebEditor.ITableStyleReaderHelper").ma().na(()=>new Wp(this.K.resolve("Box4.IPageView").Ed,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.ITableStyleResolver"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").JTc));this.K.register(Jz,
"PowerPointWebEditor.TableStyleReader").as("Box4.Styles.ITableStyleReader").as("PowerPointWebEditor.IPPTTableStyleReader").as("PowerPointWebEditor.ITableStyleCacheHelper").ma().na(()=>new Jz(this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Box4.IPageView").Ed,this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),
this.K.resolve("Box4.Graph.IGraphInstance").Cd(14),this.K.resolve("PowerPointWebEditor.IPresentationReader"),Mz.CSf,b=>new PD(b,a.resolve("PowerPointWebEditor.ITableStyleResolver")),b=>new ND(b),b=>new DL(b,a.resolve("PowerPointWebEditor.ITableBorderStyleResolver"),a.resolve("PowerPointWebEditor.ITableStyleResolver"),a.resolve("PowerPointWebEditor.IApplicationSettings").F9),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),
this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Bqg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").eMj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNewResolveTableBorderStyleEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderNonActiveTableAsyncEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").F9));this.K.register(484,
"PowerPointWebEditor.ITableStyleResolver").ma().na(()=>new sL(this.K.resolve("PowerPointWebEditor.IApplicationSettings").F9));this.K.register(485,"PowerPointWebEditor.ITableStyleGalleryManager").ma().na(()=>new vL(this.K.Oa("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(486,"PowerPointWebEditor.ITableMetrics").ma().na(()=>new IL(this.K.resolve("Box4.Graph.IGraphIteratorFactory")));this.K.register(487,"PowerPointWebEditor.IPPTTableLayoutServiceFactory").ma().na(()=>new BL(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(488,"PowerPointWebEditor.IPPTTableLayoutServiceManager").ma().na(()=>new CL(this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceFactory"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(14),this.K.resolve("Box4.Graph.IGraphInstance").Cd(15),
this.K.resolve("Box4.Graph.IGraphInstance").Cd(16),this.K.resolve("Box4.Graph.IGraphInstance").Cd(12),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptComplexTableLayoutSyncEnabled));this.K.register(LD,"PowerPointWebEditor.TableCellNodeBehavior").ma().na(()=>new LD(this.K.resolve("Box4.Graph.IGraphInstance").Cd(16),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")));
this.K.register(cL,"Box4.TableReaderProxy").as("Box4.ITableReader").ma();this.K.register(dL,"Box4.TableRowReaderProxy").as("Box4.ITableRowReader").ma();this.K.register(sQ.a,"Box4.TableCellReaderProxy").as("Box4.ITableCellReader").ma();this.K.register(489,"PowerPointWebEditor.ITableInfoCacheFactory").ma().na(()=>new HL(this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(490,"PowerPointWebEditor.ITableThemeColorHelper").ma().na(()=>new JL(this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")))}init(){const a=
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,b=this.K.resolve("Common.IActionManagerExtended");this.K.resolve("PowerPointWebEditor.ITableThemeColorHelper");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").aEb(1,new vv(this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,a),new oL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),b,a),new nL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),
this.K.resolve("Common.CursorManager"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),b,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,
a));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393250,new lm.a((c,f)=>new Cl(c,f,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPoint.IBrowserHelperManager"),l=>Gx.UVb(l),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager"),this.K.resolve("PowerPointWebEditor.Core.IPkgLoadStatusContext"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IZoomContext"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393251,
new lm.a((c,f)=>new uv(c,f,new gc.a(c,f,gc.a.whl))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393252,new fL(this.K.resolve("Box4.ITableCellReader"),this.K.resolve("Box4.Styles.IStyleReader"),new lm.a((c,f)=>new Us(c,f,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").kia,this.K.resolve("PowerPointWebEditor.IApplicationSettings").F9,this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))));
Mc.StyleReader.Oq=this.K.resolve("Box4.Styles.ITableStyleReader");this.K.resolve("PowerPointWebEditor.TableNodeBehavior");this.K.resolve("PowerPointWebEditor.TableCellNodeBehavior");this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager")}dispose(){this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager").dispose()}static main(){m.a.instance.Ec(new WD)}}Object(e.a)(WD,"PPTWebEditorTablePackage",null,[2,3]);var wQ=d(1185),Kh=d(113);class LL{constructor(){this.podsUrl=this.fileUrl=
null}}Object(e.a)(LL,"IFileInfo",null,[]);class ML extends Sys.EventArgs{constructor(a){super();this.slideIndex=a.SlideIndex}}Object(e.a)(ML,"OnPresenterViewSyncMessageEventArgs",Sys.EventArgs,[]);class NL{constructor(){this.messageType=0;this.data=this.sender=null}}Object(e.a)(NL,"IPresentationMessage",null,[]);class OL{constructor(){this.useDefaultResourceProvider=this.thumbnailsEnabled=!1;this.presenterWindowWidth=this.presenterWindowHeight=0}}Object(e.a)(OL,"IPresenterViewSettings",null,[]);class PL{constructor(){this.uiHost=
this.userSessionId=null}}Object(e.a)(PL,"ISessionInfo",null,[]);var xQ=d(431);class QL{constructor(a,b,c){this.kW="";this.e8=null;this.T$a=!1;this.hzb=null;this.va=new sd.a;this.ia=a;this.la=b;this.Xc=c;this.Vwk()}wb(){this.ia.ra(aa.a.Qgc,$b.a.application,Object(C.a)(this,this.Qgc,"queryUsePresenterView"),96);this.ia.ya(aa.a.DBh,$b.a.application,Object(C.a)(this,this.mkl,"toggleUsePresenterView"));this.ia.ya(aa.a.shd,Db.a.application,Object(C.a)(this,this.shd,"showPresenterView"));this.ia.ya(aa.a.jDc,
$b.a.application,Object(C.a)(this,this.jDc,"closePresenterView"));this.T$a=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")}Qgc(a,b,c,f,l){(a=Object(ua.a)(Kh.a,l))&&a.Yf(this.T$a);return 32}mkl(a,b,c){if(1===c&&!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return za.a.J(593789320,830,10,"PresenterViewManager: presenter view is not enabled but ToggleUsePresenterView is triggered."),8;2===c&&(this.T$a=!this.T$a,this.Xc.ND(new Xp.a(1)));return 32}shd(a,b,c){try{if(!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return za.a.J(593823009,
822,10,"PresenterViewManager: ShowPresenterView triggered but feature is disabled by BRS."),2;if(2===c&&0<this.kW.length){if(!this.hzb){const f=this.la.podsWebServiceBase,l=String.format("{0}presenter.aspx",f),w=new LL;w.fileUrl=this.kW;w.podsUrl=f;const F=new PL;F.userSessionId=u.AFrameworkApplication.userSessionId;F.uiHost="UnifiedApp";const S=new OL;S.presenterWindowWidth=1024;S.presenterWindowHeight=576;this.hzb=new PresenterView.PresentationProxy(2,l,w,F,S)}this.hzb.startPresentation();this.hzb.subscribe(Object(C.a)(this,
this.jkk,"onPresentationChannelMessageHandler"))}return 32}catch(f){return za.a.J(593823007,822,10,"PresenterViewManager: Failed to handle ShowPresenterView: {0}",f),16}}jDc(a,b,c){2===c&&(za.a.J(593622084,822,50,"PresenterViewManager: ClosePresenterView called"),this.hzb.terminatePresentation());return 32}R2h(a){this.va.addHandler("OnPresenterViewSyncMessageReceived",a)}OXk(a){a=this.p9h(a);this.hzb.sendMessage(a)}p9h(a){const b=new NL;b.sender="slideshow";b.messageType=1;b.data=JSON.stringify({["slideLocation"]:{["slideId"]:{["sid"]:a.slideId,
["cid"]:0},["slideIndex"]:a.slideIndex},["timelineMappings"]:a.imc});return b}jkk(a){try{if(!a||0>=a.length)za.a.J(593055880,830,15,"No message");else{var b=JSON.parse(a),c=b.sender;if(c&&"slideshow"!==c)switch(b.messageType||za.a.J(593055878,830,15,"No message"),b.messageType){case 1:const l=b.data;if(l&&!(0>=l.length)){var f=JSON.parse(l).slideLocation.slideIndex;this.va.raiseEvent("OnPresenterViewSyncMessageReceived",new ML({["SlideIndex"]:f}))}}}}catch(l){za.a.J(593055876,830,10,"Exception: {0}",
l)}}Vwk(){var a=lb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;a=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",b,a);b=new wQ.a(u.AFrameworkApplication.Be);this.e8=xQ.b(b.ajc(a));this.e8.then(c=>{try{const f=JSON.parse(c),l=f.downloadUrl;Ja.a.Xa(l)?za.a.J(594031826,822,10,"PresenterViewManager: GetSnappedDownloadLink returned a bad response: {0}",f):this.kW=
l}catch(f){za.a.J(594031824,822,10,"PresenterViewManager: Failed to retreive document download URL: {0}",f)}return null})}}Object(e.a)(QL,"PresenterViewManager",null,[491]);class XD{constructor(){this.xb=this.la=this.K=null;this.jIg=!1}get name(){return"PowerPointWebEditor.PresenterView"}Yb(a){this.K=a;this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.xb=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").iG()}init(){u.AFrameworkApplication.fa.gf(Object(C.a)(this,this.Fl,
"onFullAppSettingsReady"))}Fl(){try{(this.jIg=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))&&this.K.resolve("Common.IDynamicScriptLoaderProvider").gx.loadScript("presenterView").catch(a=>za.a.J(594031833,830,10,"Failed to load presenterView js: {0}",a)).then(()=>this.lkk()).catch(a=>za.a.J(594031831,830,10,"Failure in OnPresenterScriptLoaded: {0}",a))}catch(a){Z.ULS.sendTraceTag(594031830,811,10,"PPTWebEditorPresenterViewPackage: exception in OnFullAppSettingsReady: {0}",a)}}lkk(){this.VVb();
return null}VVb(){const a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",u.AFrameworkApplication.fa.Ia("PPTPresenterViewCssUrl"));this.xb.appendChild(a);this.K.register(491,"PowerPointWebEditor.PresenterView.IPresenterViewManager").na(()=>new QL(u.AFrameworkApplication.Va,this.la,this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.K.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager").wb()}dispose(){}static main(){m.a.instance.Ec(new XD)}}
Object(e.a)(XD,"PPTWebEditorPresenterViewPackage",null,[2,3]);class RL{constructor(a){this.uca=a}Fzi(a,b,c){if(c.YOa())return null;a=this.uca.eBa(a,b,c);for(b=Array(b.dO);a.moveNext();){c=a.SZb();var f=a.Cz;b[f.ge]||(b[f.ge]=[]);f=b[f.ge];f[f.length]=Vq.TableNodeContext.create(c)}a=[];for(c=0;c<b.length;++c)b[c]&&(a[a.length]=new nb.Selection(b[c],!0));return new Yh.SelectionCollection(a,a.length-1,0)}}Object(e.a)(RL,"PPTSelectionFactory",null,[476]);class SL{constructor(a,b,c,f){this.Dke=this.Wka=
this.Tde=null;this.TUh=a;this.eHh=b;this.oq=c;this.OUa=f}get jii(){return this.eHh}get pob(){this.Tde||(this.Tde=this.oq.Khi(this.jii,this.FX));return this.Tde}get tableNode(){return this.TUh}get FX(){this.Wka||(this.Wka=this.OUa.create(this.tableNode));return this.Wka}get LJj(){this.Dke||(this.Dke=this.oq.gBj(this.pob,this.FX));return this.Dke}}Object(e.a)(SL,"TableCellSelectionInfo",null,[]);class TL{constructor(a,b){this.OUa=a;this.oq=b}create(a,b){return new SL(b,a,this.oq,this.OUa)}}Object(e.a)(TL,
"TableCellSelectionInfoFactory",null,[474]);var yQ=d(972);class UL{constructor(a,b,c,f,l,w,F){this.LOg=a;this.oq=b;this.dEa=c;this.Ib=f;this.uua=l;this.lF=w;this.VN=F}q0b(a){let b=null;const c=new Date,f=({tableNode:a}=this.oq.B6f(a)).returnValue,l=!f.YOa();l&&(b=this.LOg.create(f,a),Kc.a.Db&&Kc.a.Db.Ya("CellRange",f.toString()));za.a.J(36558723,808,l?50:10,"Table cell selection range {0}, took {1}",f.toString(),+new Date-+c);return b}Naj(a){if(!a)return null;var b=this.dEa.lA(a);let c=a=null;for(let l=
0;l<b.length;++l)if(b[l].Ok){var f=Object(ua.a)(5,b[l].node);if(f){f=f.nK();if(!f)return null;if(!a)a=f,c=a.id.toString();else if(c!==f.id.toString())return null}}if(!a)return null;b=Object.assign(new cr.a,{ge:a.rowIndex,ae:a.pi});b.Tf=b.ge+1;b.Lf=b.ae+1;return this.LOg.create(b,a.getContainingTable())}}Object(e.a)(UL,"TableSelectionAdapter",null,[475]);class YD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableMergeSplit"}Yb(a){this.K=a;this.K.register(474,"PowerPointWebEditor.ITableCellSelectionInfoFactory").ma().na(()=>
new TL(this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(475,"PowerPointWebEditor.ITableSelectionAdapter").ma().na(()=>new UL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionInfoFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),
this.K.resolve("Box4.ITableNavigator")));this.K.register(476,"PowerPointWebEditor.ISelectionFactory").ma().na(()=>new RL(this.K.resolve("PowerPointWebEditor.ICellIteratorFactory")));this.K.register(477,"PowerPointWebEditor.ITableMergeSplitEditor").ma().na(()=>new yQ.TableMergeSplitEditor(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableBorderHelper"),
this.K.resolve("PowerPointWebEditor.IGraphUtils"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ISelectionManager"),this.K.resolve("PowerPointWebEditor.ISelectionFactory")))}init(){}dispose(){}static main(){m.a.instance.Ec(new YD)}}
Object(e.a)(YD,"PPTWebEditorTableMergeSplitPackage",null,[2,3]);class el{constructor(a,b,c,f,l,w,F,S){this.Slb=a;this.YCd=b;this.Da=c;this.WCd=f;this.kk=l;this.Vs=w;this.Yc=F;this.sNh=S}wb(){this.Wbd(gb.App.VIa.XQf())}Wbd(a){this.Da.ya(D.a.Mgc,Db.a.view,a);this.Da.ya(D.a.Mgc,Db.a.table,Object(C.a)(this,this.Mgc,"queryTableStyle"));this.Da.$d(D.a.Mgc,103);this.Da.ya(D.a.v1,Db.a.view,Object(C.a)(this,this.jOe,"tableStyleGenericViewActionHandler"));this.Da.ya(D.a.v1,Db.a.table,Object(C.a)(this,this.v1,
"applyTableStyle"));this.Da.$d(D.a.v1,6);this.Da.ya(D.a.P2a,Db.a.table,Object(C.a)(this,this.v1,"applyTableStyle"));this.Da.ya(D.a.Mza,Db.a.view,Object(C.a)(this,this.jOe,"tableStyleGenericViewActionHandler"));this.Da.ya(D.a.Mza,Db.a.table,Object(C.a)(this,this.Mza,"applyTableStyleOption"));this.Da.$d(D.a.Mza,14);this.Da.ya(D.a.Ngc,Db.a.view,a);this.Da.ya(D.a.Ngc,Db.a.table,Object(C.a)(this,this.Ngc,"queryTableStyleOption"));this.Da.$d(D.a.Ngc,103);this.Da.ya(D.a.Fec,Db.a.view,a);this.Da.ya(D.a.Fec,
Db.a.table,Object(C.a)(this,this.Fec,"populateMenuMoreTableStyles"));this.Da.$d(D.a.Fec,102);this.Da.ya(D.a.Kob,Db.a.view,Object(C.a)(this,this.jOe,"tableStyleGenericViewActionHandler"));this.Da.ya(D.a.Kob,Db.a.table,Object(C.a)(this,this.Kob,"clearTableFormatting"));this.Da.$d(D.a.Kob,4)}Mgc(a,b,c,f,l){if(!({vE:a}=this.Zjc(b,c,l,!0,!0)).returnValue)return a;this.YCd.Mvi(l,b.node);return 32}Ngc(a,b,c,f,l){return this.yhg(b,c,f,l,!0)}Fec(a,b,c,f,l){if(!({vE:a}=this.Zjc(b,c,l,!1,!0)).returnValue)return a;
this.YCd.Twi(l,b.node);Z.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32}v1(a,b,c,f,l){if(!({vE:c}=this.Zjc(b,c,l,!1,!0)).returnValue)return c;const w=b.node;let F=null;(F=a===D.a.v1?this.YCd.gjd(l[Uh.a.SourceControlId],w):null)?(this.xxe(w,()=>{this.WCd.d3k(F,w)}),c=32):c=8;a===D.a.v1&&32===c&&Z.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");Z.ULS.shipAssertTag(541172699,324,32===c);return c}Mza(a,b,c,f,l){return this.yhg(b,c,f,l,!1)}yhg(a,b,c,f,l){if(!({vE:b}=this.Zjc(a,
b,f,l,!0)).returnValue)return b;a=a.node;b=this.Slb.OZd(a);const w=f[Uh.a.On],F=el.Ocj(u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.Ip?f.MenuItemId:f[Uh.a.SourceControlId]);l?f[Uh.a.On]=el.Q7k(b,F):(this.o8h(b,F,w,a),c.qP=F,c.G6=w?0:1,Z.ULS.shipAssertTag(541172700,324,0!==F));return 32}jOe(a,b,c,f,l){return Vh.m4(a,b,c,f,l,{},14)}xxe(a,b){const c=this.kk.ie(15);try{c.hd(a),this.Vs.UWa(),b()}finally{c&&c.dispose()}}Zjc(a,b,c,f,l){return this.rMj(a,b,c,f,l)?{returnValue:f||2===b,vE:32}:
{returnValue:!1,vE:8}}rMj(a,b,c,f,l){if(a.contextId!==Db.a.table)return!1;if(f||2===b)if(l&&!c||!Object(Ca.a)(oy.a,a.node)||this.sNh(a.node))return!1;return!0}o8h(a,b,c,f){const l=(512===b||1024===b?!c:c)?a|b:a&~b;l!==a&&this.xxe(f,()=>{this.WCd.K0k(l,f)})}Kob(a,b,c,f,l){if(!({vE:a}=this.Zjc(b,c,l,!1,!1)).returnValue)return a;const w=b.node;this.xxe(w,()=>{this.WCd.Kli(w)});return 32}static Qq(){el.jMa[el.IQi]=32;el.jMa[el.DQi]=128;el.jMa[el.wPj]=64;el.jMa[el.oPj]=256;el.jMa[el.J$h]=512;el.jMa[el.I$h]=
1024}static Q7k(a,b){a=!!(a&b);if(512===b||1024===b)a=!a;return a}static Ocj(a){let b=0;a in el.jMa&&(b=el.jMa[a]);return b}}el.IQi="buttonFirstRow";el.DQi="buttonFirstColumn";el.wPj="buttonLastRow";el.oPj="buttonLastColumn";el.J$h="buttonBandedRow";el.I$h="buttonBandedColumn";el.jMa={};Object(e.a)(el,"TableStyleActor",null,[]);el.Qq();class xp{constructor(a){this.jda=a}d3k(a,b){a=this.jda.l0b(a);xp.DMf(b);b.setValue(zb.a.LIa,xg.a.ig(a.vua.styleIdField))}K0k(a,b){b.setValue(zb.a.tlc,a)}Kli(a){xp.DMf(a);
a.removeProperty(zb.a.LIa)}static DMf(a){if(a=Object(ua.a)(Kz.TableNode,a)){a=a.r0b();for(const c of a){if(c.cellShading){var b=Ik.b(c.cellShading);b?(a=b,Dx(a),a&&(a.cell3DField=null,a.extLstField=null,a.lnBField=null,a.lnBlToTrField=null,a.lnLField=null,a.lnRField=null,a.lnTField=null,a.lnTlToBrField=null),c.cellShading=b):za.a.J(22078240,822,15,"Encountered null cell shading.")}for(const f of xp.cbi){let l;({d3a:b,c3a:a,Inb:l}=Wp.$Pa(f));c.removeProperty(a);c.removeProperty(b);c.removeProperty(l)}xp.ili(Object(ua.a)(fg.a,
c))}}else za.a.J(587531030,822,10,"Casting of GraphNode to ITableNode is null")}static ili(a){const b=new zF.a;b.set(a);for(a=b.yb(1);a;){for(a=b.yb(2);a;)12===a.type&&xp.jli(a),a=b.xj(2);a=b.xj(1)}}static jli(a){if(a.Ra&&0<a.Ra.length)for(let b=0;b<a.Ra.length;b++)a.Ra.ga(b)&&xp.kli(a.Ra.ga(b))}static kli(a){if(a=a.formatting){const f=a.paragraph.Eh;if(f){var b=a.rz,c=!1;if(b){for(let l=0;l<xp.NFe.length;l++)b.Sa(xp.NFe[l])&&(c||(c=!0,b=b.clone()),b.removeProperty(xp.NFe[l]));c&&(b=f.rHa(b),a.Pl=
b.id)}}}}}xp.NFe=[ob.a.font,zb.a.latinFont,zb.a.eastAsianFont,zb.a.complexScriptFont,zb.a.GHb,ob.a.fontColor,ob.a.bold,ob.a.italic,zb.a.schemeColor];xp.cbi=[5,6,7,0];Object(e.a)(xp,"PPTTableStyleEditor",null,[569]);class ZD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableStyleEditor"}Yb(a){this.K=a}init(){(new el(this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("Box4.TableEditors.ITableStyleRibbonControls"),this.K.resolve("Common.IActionManagerExtended"),new xp(this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager")),
this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,()=>!1)).wb()}dispose(){}static main(){m.a.instance.Ec(new ZD)}}Object(e.a)(ZD,"PPTWebEditorTableStyleEditorPackage",null,[2,3]);class $D{constructor(a,b,c){this.lqe=0;this.Oie=!1;this.Dk=a;this.Ow=b;this.sa=c;this.Dk.PBf(Object(C.a)(this,this.VGf,"beforeForceOutboundGraphTransactionInitialize"));this.Dk.IMa(Object(C.a)(this,
this.Pfg,"graphTransactionDisposed"));this.Ow.qpa(Object(C.a)(this,this.FVa,"onBeforeValidatePersistence"))}dispose(){this.Dk.Dbh(Object(C.a)(this,this.VGf,"beforeForceOutboundGraphTransactionInitialize"));this.Dk.heb(Object(C.a)(this,this.Pfg,"graphTransactionDisposed"));this.Ow.Dhc(Object(C.a)(this,this.FVa,"onBeforeValidatePersistence"))}VGf(){this.lqe++}FVa(){0<this.lqe&&(this.Oie=!0)}Pfg(){if(!(0<--this.lqe)&&this.Oie){this.Oie=!1;var a=Kc.a.Db;if(a){const b=this.sa.he();let c=0;for(const f of b)f.EK&&
c++;a.Ya("ShapeCount",b.length.toString());a.Ya("SupportSVGCount",c.toString())}}}}Object(e.a)($D,"SVGShapeTelemetry",null,[109]);class aE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Telemetry"}Yb(a){this.K=a;this.K.register($D,"PowerPointWebEditor.Telemetry.SVGShapeTelemetry").ma().na(()=>new $D(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))}init(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry")}dispose(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry").dispose()}static main(){m.a.instance.Ec(new aE)}}
Object(e.a)(aE,"PPTWebEditorTelemetryPackage",null,[2,3]);class Nz{}Nz.D6g="faProofing";Object(e.a)(Nz,"ContextMenuControlId",null,[]);class bE{constructor(a,b,c,f,l,w,F){this.oM=b;this.UPb=a;this.rsc=b.MCj;this.Msc=b.W9d;this.GMh=w;this.Zrc=f;this.$rc=l;this.MKa=c;this.HO=F;this.IKa=new dc.a;this.IKa.$(1,"SpellingIssue_16x16x32");this.IKa.$(2,"GrammarIssue_16x16x32");this.IKa.$(3,"WritingIssue_16x16x32");this.IKa.$(4,null);this.IKa.$(0,null)}create(a,b,c){b=Object(ua.a)($l.a,b);if(!b)return Z.ULS.sendTraceTag(25007833,
375,15,"Expect EditorServiceErrorDetails."),"";const f=new Sys.StringBuilder;a=this.i$f(a);this.jWb(f,b,c,a);this.FOd(f,b);this.$xi(f,b,a);return f.toString()}Xt(a,b,c){b=Object(ua.a)($l.a,b);if(!b)return Z.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];const f=[];a=this.i$f(a);this.jPd(f,b,c,a);this.GOd(f,b);this.ayi(f,b,a);return f}jWb(a,b,c,f=null){0===b.errorType?a.append(this.UPb.build()):1===b.errorType&&(this.ROa(b)||a.append(this.NJd(b,c,f)))}jPd(a,b,c,f=null){0===
b.errorType?a.push(this.UPb.kIf()):1===b.errorType&&(this.ROa(b)||a.push(this.kci(b,c,f)))}FOd(a,b){if(!I.a.instance.ga(92)){const c=new Sys.StringBuilder;this.mph(b)?c.append($i.a("btnIgnoreAllSpellingError",(2===b.errorType?D.a.lld:D.a.x4d).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.ROa(b)||c.append($i.a("btnIgrnoreSpellingError",this.K9f(b.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.qph(b)&&(this.oM.a8d&&c.append($i.a("btnDoNotCheckForThisIssue",
"2157977488",Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),c.append($i.a("btnGrammarOptions","3380187414",Ja.a.le(Box4Intl.Box4Strings.l_GrammarOptions),null)));c.isEmpty()||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(c.toString()),a.append("</Controls></MenuSection>"))}}GOd(a,b){if(!I.a.instance.ga(92)){const f=Object.assign(new nk.a,{ControlList:[]});if(this.mph(b)){var c=Object.assign(new Of.a,{ExternalId:2===b.errorType?"UnknownAllSpellingError":
"IgnoreAllSpellingError"});Array.add(f.ControlList,c)}else this.ROa(b)||(c=Object.assign(new Of.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.K9f(b.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),Array.add(f.ControlList,c));this.qph(b)&&(this.oM.a8d&&(b=Object.assign(new Of.a,{ExternalId:"DoNotCheckForThisIssue",Command:"2157977488",LabelText:Box4Intl.Box4Strings.l_DoNotCheckForThisIssue}),Array.add(f.ControlList,b)),b=Object.assign(new Of.a,{ExternalId:"GrammerSettingsContext",
Command:"3380187414",LabelText:Box4Intl.Box4Strings.l_GrammarOptions}),Array.add(f.ControlList,b));a.push(f)}}i$f(a){if(!this.HO)return null;a=this.HO.language(this.HO.xs(a.Wa));return qa.a.re(a).name}K9f(a){return 2===a?D.a.lld:this.oM.Vsg?D.a.BPc:D.a.Mra}$xi(a,b,c=null){if(this.YJe(b)){var f=Ja.a.le(b.IM.CategoryTitle);f=$i.j(Nz.D6g,G.a.Ymb,this.IKa.ga(b.proofingType),""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[a.toString()],this.Zrc,this.$rc);f=$i.c("cgProofingOuter",[f]);
a.clear();a.append($i.e("msProofingOuter",f,"Menu16",void 0,void 0,c,"ariaLabelledById"));Z.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}ayi(a,b,c=null){if(this.YJe(b)){var f=Ja.a.le(b.IM.CategoryTitle);c=Object.assign(new uo.a,{ExternalId:String.format("{0}_{1}",Nz.D6g,b.proofingType),Command:"798637440",Image16by16Class:this.IKa.ga(b.proofingType),LabelText:""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:c,
Menu:Object.assign(new Kl.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.nWi(b),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});Array.addRange(c.Menu.MenuSectionList,a);Array.clear(a);f=Object.assign(new nk.a,{ControlList:[]});Array.add(f.ControlList,c);a.push(f);Z.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}NJd(a,b,c=null){const f=this.B0i(a);
var l=[];let w=!1;var F=a.IM.Suggestions;if(F)if(F=F.slice(0,Math.min(3,F.length)),this.rsc&&(w=!Ma.a.any(F,S=>!S||!S.Description)),1===F.length&&0===F[0].Action)b=Ja.a.le(F[0].Text),l.push($i.a("btnCorrectWord0","3587447601",b,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,f,b)));else{let S=0,fa=null;w&&(fa="font-weight: bold;");for(const xa of F){if(!xa)continue;F=null;let Za="",pb=Ja.a.le(xa.Text);w&&(F=this.i6f(xa.Description),
Za=this.h6f(xa.Description));l.push($i.a("btnCorrectWord"+S,b[S].toString(),pb,null,null,null,null,null,fa,null,F,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,f,pb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.YPf(a.token)),"ariaDescribedById",Za));S++}}b="Menu16";0<l.length?w&&(b="Menu16DescriptionEnabled"):l=[$i.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,
null)];return $i.e("msUnknownWord",$i.c(null,l),b,f,this.X4i(a),c,"ariaLabelledById")}kci(a,b,c=null){var f=1!==a.proofingType&&0!==a.proofingType?a.IM.ExplanationTitle:"";f=Object.assign(new nk.a,{Title:f,Lang:c,ControlList:[]});let l=!1;var w=a.IM.Suggestions;if(w)if(w=w.slice(0,Math.min(3,w.length)),this.rsc&&(l=!Ma.a.any(w,F=>!F||!F.Description)),1===w.length&&0===w[0].Action)a=w[0],a=Object.assign(new Of.a,{ExternalId:"NoSuggestion",Command:"3587447601",LabelText:a.Text}),Array.add(f.ControlList,
a);else{let F=0;for(const S of w){if(!S)continue;w=null;let fa="";l&&(w=this.i6f(S.Description),fa=this.h6f(S.Description));if(F>=b.length)break;w?(w=Object.assign(new lB,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",F,a.proofingType),Command:b[F].toString(),LabelText:S.Text,Description:w,Lang:c,AriaDescription:fa}),Array.add(f.ControlList,w)):(w=Object.assign(new Of.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",F,a.proofingType),Command:b[F].toString(),
LabelText:S.Text,Lang:c,RoleInMenu:"menuitem"}),Array.add(f.ControlList,w));F++}}0>=f.ControlList.length&&Array.add(f.ControlList,Object.assign(new Of.a,{ExternalId:"btnNoSuggestions",Command:"3587447601",LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return f}B0i(a){return Ja.a.le(1!==a.proofingType&&0!==a.proofingType?a.IM.ExplanationTitle:"")}X4i(a){return this.YJe(a)?null:this.IKa.ga(a.proofingType)}YJe(a){return this.Msc&&2!==a.errorType&&(1!==a.errorType||!this.ROa(a))}mph(a){return this.GMh&&
0!==a.errorType&&1===a.proofingType&&!this.ROa(a)}nWi(a){return 1===a.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.YPf(a.token)):""}qph(a){return this.oM.IRa&&this.Msc&&1===a.errorType&&(2===a.proofingType||3===a.proofingType)}ROa(a){return 0!==a.errorType&&!!this.MKa&&this.MKa.contains(a.token,a.lcid)}i6f(a){return""===a?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):a}h6f(a){return""!==a?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,
a):""}YPf(a){let b="";if(a){let c;for(c=0;c<a.length-1;c++)b=b+a.charAt(c)+",";b+=a.charAt(c)}return b}}Object(e.a)(bE,"EditorServiceProofingContextMenuCreator",null,[]);class xq{Y9(a,b){this.shi&&this.x9k(a,b,xq.HRg,xq.kb)}x9k(a,b,c,f){switch(c){case 1:case 6:case 2:case 3:case 4:case 5:xq.MHi.show(f,a,b)}}FRg(){switch(xq.HRg){case 5:case 1:return!0;default:return!1}}get shi(){return 1!==gb.App.Fb.state}static get MHi(){return xq.$_e||(xq.$_e=lb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static Y4i(a){if(!a)return 0;
if(2===gb.App.Fb.mode)if(I.a.instance.ga(17)&&1===a.length&&Vi.OutlineReader.S3b(a.Wa)&&gb.App.Fb.Fd.Xm&&gb.App.Fb.Fd.Xm.Po){if(a=mb.GraphIterator.nb(a.Wa.node),a.uv(),!lg.b(a))return 5}else{const b=a.Wa.node;let c=mb.GraphIterator.nb(b);c.uv();return St.e(c.currentNode)?2:u.AFrameworkApplication.yhb||!hb.EmbeddedFileReader.Z7a(b)||hb.EmbeddedFileReader.L2(b)?a.Wa.contextId===Db.a.iFrame||AI(a.Wa)?6:1:3}else return 4;return 0}static get kb(){return dd.a.instance.Pa.kb}static get HRg(){return xq.Y4i(xq.kb)}}
xq.$_e=null;Object(e.a)(xq,"SelectionContextMenuProvider",null,[199]);class VL{constructor(a){this.la=a}HVd(a,b,c,f,l){const w=c?u.AFrameworkApplication.Rl:"";c=c?rp.getImageClass(c):"";return String.format('<FlyoutAnchor Id="{0}" Command="{1}" Image16by16="{2}" \r\n              Image16by16Class="{3}" LabelText="{4}"> {5} </FlyoutAnchor>',a,b,w,c,Ja.a.le(f),l)}menu(a,b){return String.format('<Menu Id="{0}"> {1} </Menu>',a,b)}menuSection(a,b){return String.format('<MenuSection Id="{0}" DisplayMode="Menu16"><Controls> {1} </Controls></MenuSection>',
a,b)}mzi(){let a=ResourceStrings.l_ContextMenuSmartLookup;var b=(new Xw.a).getSelectedText();b=(b=b.neighborhood.substr(b.mentionStart,b.mentionLength))?b.trim():null;let c=20;b&&0<b.length&&(b.length>c&&(c=Ja.a.Hw(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b);b&&0<b.length&&(a=String.format(ResourceStrings.l_ContextMenuTextSmartLookup,b));return a}Bji(){var a=(new Xw.a).getSelectedText();a=a.neighborhood.substr(a.mentionStart,a.mentionLength);return!(a&&0<a.trim().length)}Czi(){let a=ResourceStrings.l_SynonymsSerpletContextMenu;
var b=(new Xw.a).getSelectedText();b=b.neighborhood.substr(b.mentionStart,b.mentionLength);if(!b)return a;b=b.trim();let c=14;0<b.length&&(b.length>c&&(c=Ja.a.Hw(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b,a=String.format(ResourceStrings.l_ContextMenuTextSynonyms,b));return a}}Object(e.a)(VL,"ContextMenuHelper",null,[205]);class Hx extends Wu{constructor(a,b,c,f){super(a,c);this.ZCg=b;this.WSa=f}dKc(a){let b=null,c=!1;var f=dd.a.instance.Pa.kb;f=lb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu").g3d(f,
a);switch(this.WSa){case 7:b=["Picture","Comment"];c=!0;break;case 15:case 6:case 10:case 5:b=["Shape","Comment"];c=!0;break;case 8:b=["SmartArtStylesOptions","Comment"];c=!0;break;case 13:case 11:b=["SVG","Comment"];c=!0;break;default:const l=!!this.ZCg&&this.ZCg.yvg("1898844988"),w=lb.a.instance.resolve("Box4.ISelectionContextMenuProvider").FRg(),F=u.AFrameworkApplication.fa.ka("PPTOTableCellBordersEnabled");l?b=F?3===a&&f?"Paste FontFormatting Table TableStyle Comment ContextMenu".split(" "):["FontFormatting",
"Table","TableStyle","Comment"]:3===a&&f?["Paste","FontFormatting","Table","Comment","ContextMenu"]:["FontFormatting","Table","Comment"]:w&&(b=3===a&&f?["Paste","FontFormatting","Comment","ContextMenu"]:["FontFormatting","Comment"])}3===a&&f&&c&&b.push("ContextMenu");return b}static fvj(a,b,c,f){a.uai(()=>Hx.$qi(b,c,f))}static $qi(a,b,c){return new Hx(a,b,c,0)}}Object(e.a)(Hx,"PowerPointReactFloatie",Wu,[]);class XL{constructor(a,b){this.aEg=b;this.Iee=a}dispose(){}YG(){}gFi(){this.Iee.sqa()}J4(a,
b,c,f){this.aEg.ajh(f);this.Iee.J4(a,b,c)}y9k(a,b,c,f){14===f?this.J4(a,b,c,f):(this.aEg.ajh(f),a=new Hx(lb.a.instance.qb("Common.IReactContextualUILauncher"),gb.App.WC.PR,lb.a.instance.qb("Common.IExternalUICommandDefinitionMapping"),f),this.Iee.ghd(b,c,a,lb.a.instance.qb("Box4.ISelectionContextMenuProvider")))}}Object(e.a)(XL,"ReactContextMenuUser",null,[203]);class YL{constructor(){this.whitelistedControlIds=this.i$=this.GF=null;this.$Nj=!1;this.B_k=this.Wma=this.Irh=null}}Object(e.a)(YL,"ReactStatusBarInitOptions",
null,[]);class ZL{constructor(){this.whitelistedControlIds=null}}Object(e.a)(ZL,"StatusBarProps",null,[]);class Ix{constructor(a,b){this.Tzd=!1;this.nqf=null;this.d2a=b.GF;this.lvf=b.Irh;Oc.a.get_instance().Ak(7,()=>{window.setTimeout(()=>{ce.a.instance.sF(()=>{lj.UISurfaces.Jbj().then(c=>{const f=Object.assign(new ZL,{whitelistedControlIds:b.whitelistedControlIds});c.initializeNewStatusBar(a,f,this.lvf);this.nqf=c;this.Tzd=!0;window.setTimeout(()=>{ce.a.instance.sF(()=>{const l=[];if(b.i$){const w=
b.i$;for(let F in w)l.push(appChrome.actions.updateControlHiddenState(F,w[F]));appChrome.api.dispatch(l)}this.YG()},"RSB:I2")},0);return null}).catch(()=>{Z.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(b.Wma&&a){Ix.z3e||(u.AFrameworkApplication.Va.ya(G.a.Krh,de.a.frame,Object(C.a)(this,this.Lrh,"statusBarTabAction")),u.AFrameworkApplication.Va.ya(G.a.Jrh,de.a.frame,Object(C.a)(this,this.Lrh,"statusBarTabAction")),Ix.z3e=!0);const c=Jr.a.A5d(b.Wma,
b.B_k,a,!1);c.HK=!0;this.RDb(c,G.a.Krh,G.a.Jrh)}},0)})}YG(){this.Tzd&&this.d2a&&window.setTimeout(()=>{this.d2a(this.nqf.selectors.getStatusBarControlsMap(this.lvf),7)},0)}C4(a,b){this.Tzd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(a,b))},0)}RDb(a,b,c){const f=A.KeyInputManager.La(x.a.tq,0),l=A.KeyInputManager.La(x.a.tq,4);a.Wo(f);a.Wo(l);a.bindAction(f,b);a.bindAction(l,c)}Lrh(){return 4}}Ix.z3e=!1;Object(e.a)(Ix,"ReactStatusBar",null,[]);class cE{constructor(a,
b,c,f,l,w,F,S,fa){this.t$b=null;this.kc=S;this.sac=a;this.la=b;this.nm=l;this.E4j=w;this.w6j=F;this.NSa=f||new OG.a;this.hh=this.NSa.SOd(3,"StatusBarUser");a=()=>{this.qdi();this.NSa.CVc(3)};fa&&Object(Ca.a)(106,this.kc)?this.kc.Ntb(a):this.kc.gf(a);this.fLg=c;this.fLg.ZF(Object(C.a)(this,this.rdc,"onSlidesTopologyChanged"))}dispose(){this.fLg.kO(Object(C.a)(this,this.rdc,"onSlidesTopologyChanged"))}qdi(){const a=this.hh.Ut("createStatusBar"),b=new YL;b.i$=this.Q8i();b.$Nj=!1;b.GF=Object(C.a)(this,
this.Vtl,"updateStatusBarControls");b.Irh="PptEditingStatusBar";qd.a("ReactStatusBarRTLSupport")&&u.AFrameworkApplication.isRtl&&this.sac&&(this.sac.style.direction="rtl");this.t$b=new Ix(this.sac,b);this.hh.au(a)}YG(){this.t$b&&this.t$b.YG()}C4(a,b){this.t$b&&this.t$b.C4(this.rsb(a),!b)}rsb(a){const b=this.E4j.tYd(a);return b&&0<b.count?b.ga(0):a}rdc(a,b){2===b.GY&&this.YG()}Vtl(a){gb.App.Fb&&gb.App.Fb.GF(a)}Q8i(){const a=this.w6j.iej(),b={};for(const c of Object.keys(a))b[this.rsb(c)]=a[c];u.AFrameworkApplication.fa.ka("FeedbackPaneExperienceIsEnabled")&&
u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(b[this.rsb("PptEditingStatusBar.GiveFeedbackPane")]=!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.rsb("PptEditingStatusBar.GiveFeedback")]=!0):(b[this.rsb("PptEditingStatusBar.GiveFeedback")]=!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.rsb("PptEditingStatusBar.GiveFeedbackPane")]=!0);return b}}cE.AMb=null;Object(e.a)(cE,"ReactStatusBarUser",null,[237,202]);class $L{constructor(a){this.la=a}iej(){const a={};this.la.eub||(a["PptEditingStatusBar.ZoomScale"]=
!0,a["PptEditingStatusBar.FitToWindow"]=!0);this.la.xDb||(a["PptEditingStatusBar.LanguageButton"]=!0);this.la.Sra||(a["PptEditingStatusBar.AddInCommandsLoadStatus"]=!0);this.la.officeOnlineInGallatinTextVisible||(a["PptEditingStatusBar.MiddleStatus"]=!0);this.la.qoh||(a["PptEditingStatusBar.PerfStats"]=!0);this.la.zg&&(a["PptEditingStatusBar.Reading"]=!0);u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")||(a["PptEditingStatusBar-SlideSorterView"]=!0);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")||
(a["PptEditingStatusBar-PresenterView"]=!0);return a}}Object(e.a)($L,"StatusBarUserHelper",null,[201]);class dE{constructor(){this.esf=null}get kfh(){return this.esf||(this.esf=lb.a.instance.qb("Common.IRootManager"))}wb(){}Fe(){}Hxg(){}lTk(){this.kfh&&this.kfh.JDc()}}Object(e.a)(dE,"ABox4BridgeCommandUi",null,[204,109]);class aM extends dE{constructor(a,b,c,f){super();this.mDg=a;this.BD=b;this.ia=c;this.I$b=f}GF(a){Object(ua.a)(236,this.BD).TIb(a)}x0(a){return 32===this.ia.Ma(aa.a.x0,2,a)}ktk(){this.mDg.clearCache();
this.BD.YG()}aJb(){this.BD.aJb()}iFe(a){a?a(this.I$b.sqa()):this.I$b.sqa()}yvg(a){return this.mDg.k4b(a)}Hxg(){const a=Object(ua.a)(236,this.BD);a&&a.KPj()}dispose(){}}Object(e.a)(aM,"Box4BridgeCommandUi",dE,[]);var eE=d(1186);class er{static get x6(){return er.x5||(er.x5=lb.a.instance.resolve("Box4.IContextMenuController"))}static showContextMenu(a,b){er.x6.showContextMenu(a,b)}static J4(a,b,c){er.x6.J4(a,b,c)}static fhd(a,b,c,f=null){er.x6.fhd(a,b,c,f)}}er.x5=null;Object(e.a)(er,"BaseContextMenu",
null,[]);class yp extends Pw{constructor(){super();this.oFd();this.VFd()}oFd(){this.addCommandToMaps(Object.assign(new Xa.a("AlignCenter","4284004393"),{legacyControlId:"CenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignLeft","2539120357"),{legacyControlId:"LeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignRight","393413924"),{legacyControlId:"RightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopLeft",
"428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopCenter","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopRight","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenterLeft","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",
queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenter","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenterRight","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomLeft","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));
this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomCenter","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomRight","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopLeft_MLR","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopCenter_MLR",
"1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopRight_MLR","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenterLeft_MLR","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenter_MLR","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",
queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenterRight_MLR","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomLeft_MLR","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomCenter_MLR","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));
this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomRight_MLR","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyStyle","1040747875"),{queryCommandId:"3123760305",populationProps:new Vg("681481568",!1),previewControlIds:["buttonStyle0","buttonStyle1","buttonStyle2","buttonStyle3","buttonStyle4"]}));this.addCommandToMaps(Object.assign(new Xa.a("AutoCorrectOptions","880879461"),{legacyControlId:"fseaOpenAutoCorrectOptionsDialog"}));
this.addCommandToMaps(Object.assign(new Xa.a("AutomaticFontColor","3491966299"),{legacyControlId:"fontColor"}));this.addCommandToMaps(Object.assign(new Xa.a("Bold","4143129361"),{legacyControlId:"fsbcBold",queryCommandId:"1465813983"}));this.addCommandToMaps(Object.assign(new Xa.a("BulletLibrary","3552651681"),{queryCommandId:"3827179399",populationProps:new Vg("2466004410",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("BulletNone","3552651681"),{queryCommandId:"990335323",menuItemId:"BulletStyleBulletsLibrary_0"}));
this.addCommandToMaps(Object.assign(new Xa.a("CellShading","2765388691"),{legacyControlId:"cellShadingColor",populationProps:new Vg("462656847",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("ClearFormatting","2319895756"),{legacyControlId:"fseaClearFormatting"}));this.addCommandToMaps(Object.assign(new Xa.a("ClearShadingColor","3275596206"),{legacyControlId:"clear"}));this.addCommandToMaps(new Xa.a("ClearStyleFormatting","2319895756"));this.addCommandToMaps(Object.assign(new Xa.a("ClearTableFormatting",
"3835123874"),{legacyControlId:"fseaClearTableFormatting"}));this.addCommandToMaps(Object.assign(new Xa.a(yp.eti,"3383614517"),{legacyControlId:"fseaCopy"}));this.addCommandToMaps(Object.assign(new Xa.a(yp.nBi,"2309168610"),{legacyControlId:"fseaCut"}));this.addCommandToMaps(Object.assign(new Xa.a("DecreaseIndent","3376107472"),{legacyControlId:"fseaOutdent",queryCommandId:"1599543798"}));this.addCommandToMaps(Object.assign(new Xa.a("DeleteColumn","2983091615"),{legacyControlId:"btnColumnDelete"}));
this.addCommandToMaps(Object.assign(new Xa.a("DeleteRow","1368263559"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("DeleteTable","1819681963"),{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",populationProps:new Vg("1546254036",!0)}));this.addCommandToMaps(Object.assign(new Xa.a("DictationFloatieToggle","1394650145"),{legacyControlId:"btnDictationFloatieToggle",
queryCommandId:"2417470717"}));this.addCommandToMaps(Object.assign(new Xa.a("DictationSettingsLanguages","3662249320"),{queryCommandId:"569982264",populationProps:new Vg("3836866597",!0)}));this.addCommandToMaps(new Xa.a("DictationSettingsHelp","3819824931"));this.addCommandToMaps(new Xa.a("DictationSettingsHelpShowCommands","2729830074"));this.addCommandToMaps(Object.assign(new Xa.a("DictationSettingsAutoPunctuation","992784617"),{queryCommandId:"1118940415"}));this.addCommandToMaps(Object.assign(new Xa.a("EditInApp",
"3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Xa.a("EditingView","329275380"),{legacyControlId:"btnEditOnWeb",queryCommandId:"214409533"}));this.addCommandToMaps(Object.assign(new Xa.a("EditTableAltText","868579142"),{legacyControlId:"btnTableAltText"}));this.addCommandToMaps(Object.assign(new Xa.a("FlipHorizontal","2545543284"),{legacyControlId:"buttonFlipHorizontal",menuItemId:"buttonFlipHorizontal"}));this.addCommandToMaps(Object.assign(new Xa.a("FlipVertical",
"2545543284"),{legacyControlId:"buttonFlipVertical",menuItemId:"buttonFlipVertical"}));this.addCommandToMaps(Object.assign(new Xa.a("FontColor","1970784898"),{legacyControlId:"fontColor",populationProps:new Vg("2077552168",!1)}));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Xa.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new Vg("179506844",!1),commandPreviewId:"2655634065",commandRevertId:"1138852411"})),
this.addCommandToMaps(Object.assign(new Xa.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462",commandPreviewId:"1666858098",commandRevertId:"1250696292"}))):(this.addCommandToMaps(Object.assign(new Xa.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new Vg("179506844",!1)})),this.addCommandToMaps(Object.assign(new Xa.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462"})));this.addCommandToMaps(Object.assign(new Xa.a("FormatPainter",
"2458503775"),{legacyControlId:"fseaFormatPainter",queryCommandId:"2544399836"}));this.addCommandToMaps(Object.assign(new Xa.a("GrammarSettings","3380187414"),{legacyControlId:"btnGrammarSettings"}));this.addCommandToMaps(Object.assign(new Xa.a("GrowFontSize","286819199"),{legacyControlId:"fseaGrowFontSize"}));this.addCommandToMaps(Object.assign(new Xa.a("Highlighter","1784019754"),{legacyControlId:"fontBackgroundColor"}));this.addCommandToMaps(new Xa.a("HighlighterColor","1784019754"));this.addCommandToMaps(Object.assign(new Xa.a("ImmersiveReader",
"1925081555"),{legacyControlId:"btnImmersiveMode"}));this.addCommandToMaps(Object.assign(new Xa.a("IncreaseIndent","4073520836"),{legacyControlId:"fseaIndent",queryCommandId:"2667230914"}));this.addCommandToMaps(Object.assign(new Xa.a("IndentFirstLine","682091331"),{legacyControlId:"buttonSpecialIndentFirstLine",queryCommandId:"1728659747"}));this.addCommandToMaps(Object.assign(new Xa.a("IndentHanging","4114875119"),{legacyControlId:"buttonSpecialIndentHanging",queryCommandId:"4115573199"}));this.addCommandToMaps(Object.assign(new Xa.a("IndentLeft",
"3058254979"),{legacyControlId:"spnIndentBefore",queryCommandId:"2987841675"}));this.addCommandToMaps(Object.assign(new Xa.a("IndentNone","3839386673"),{legacyControlId:"buttonSpecialIndentNone",queryCommandId:"738769293"}));this.addCommandToMaps(Object.assign(new Xa.a("IndentRight","1217598046"),{legacyControlId:"spnIndentAfter",queryCommandId:"3085515826"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertBelow",
"3709283166"),{legacyControlId:"btnInsertRowBelow"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertCameraPicture","2935789186"),{legacyControlId:"fseaInsertCameraPicture"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertEmoji","2994090608"),{legacyControlId:"flyInsertEmojis",queryCommandId:"35811376",populationProps:new Vg("1124716226",!0)}));this.addCommandToMaps(Object.assign(new Xa.a("InsertLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertRight",
"1735639577"),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertLink","2711544537"),{legacyControlId:"fseaInsertHyperlink"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertPicture","2670646631"),{legacyControlId:"fseaInsertPicture"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertOnlinePicture","1685987254"),{legacyControlId:"fseaFlyInsertOnlinePictureFromSearch"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertPictureFromHost","720118144"),
{legacyControlId:"fseaFlyInsertOnlinePictureFromHost",queryCommandId:"3612507612"}));let a;this.addCommandToMaps((a=new Xa.a("InsertSymbol","3471878106"),a.legacyControlId="flyInsertSymbols",a.populationProps=new Vg("1256496096",!0),a));let b;this.addCommandToMaps((b=new Xa.a("InsertTable","975293073"),b.legacyControlId="flyInsertTable",b));let c;this.addCommandToMaps((c=new Xa.a("Italic","3569444222"),c.legacyControlId="fsbcItalic",c.queryCommandId="4231335074",c));let f;this.addCommandToMaps((f=
new Xa.a("Justify","1733835213"),f.legacyControlId="FullJustify",f.queryCommandId="1257252315",f));let l;this.addCommandToMaps((l=new Xa.a("LeftToRightTextDirection","927903232"),l.legacyControlId="TextDirLTR",l.queryCommandId="1154761034",l));let w;this.addCommandToMaps((w=new Xa.a("LineSpacing","2222099814"),w.legacyControlId="flyLineSpacing",w.populationProps=new Vg("2818132660",!0),w));let F;this.addCommandToMaps((F=new Xa.a("LineSpacingOptions","2465215107"),F.legacyControlId="grpParagraphDialogLauncherButton",
F));let S;this.addCommandToMaps((S=new Xa.a("LockAspectRatio","3369422509"),S.legacyControlId="toggleBtnLockAspectRatio",S.queryCommandId="4201275867",S));let fa;this.addCommandToMaps((fa=new Xa.a("Margins","1451516907"),fa.legacyControlId="flyMargins",fa));let xa;this.addCommandToMaps((xa=new Xa.a("MergeCells","4127468093"),xa.legacyControlId="btnMergeTableCells",xa));this.addCommandToMaps(new Xa.a("MoreEmojis","1145444901"));this.addCommandToMaps(new Xa.a("MoreStyles","3340688468"));let Za;this.addCommandToMaps((Za=
new Xa.a("MoreSymbols","3574218963"),Za.legacyControlId="btnMoreSymbols",Za));let pb;this.addCommandToMaps((pb=new Xa.a("MultilevelStyle1","3062940477"),pb.queryCommandId="1240192421",pb.menuItemId="MultilevelStyleMultilevelLibrary_1",pb));let Mb;this.addCommandToMaps((Mb=new Xa.a("MultilevelStyle2","3062940477"),Mb.queryCommandId="1240192421",Mb.menuItemId="MultilevelStyleMultilevelLibrary_2",Mb));let hc;this.addCommandToMaps((hc=new Xa.a("MultilevelStyle3","3062940477"),hc.queryCommandId="1240192421",
hc.menuItemId="MultilevelStyleMultilevelLibrary_3",hc));let kc;this.addCommandToMaps((kc=new Xa.a("NoHighlight","562361573"),kc.legacyControlId="noFontBackgroundColor",kc));let Ec;this.addCommandToMaps((Ec=new Xa.a("NumberingLibrary","2213049770"),Ec.queryCommandId="3488367157",Ec.populationProps=new Vg("3149136033",!1),Ec));let Hc;this.addCommandToMaps((Hc=new Xa.a("Orientation","1451516907"),Hc.legacyControlId="flyOrientation",Hc));let Dc;this.addCommandToMaps((Dc=new Xa.a("ParagraphOptions","2465215107"),
Dc.legacyControlId="grpLayoutParagraphDialogLauncherButton",Dc));this.addCommandToMaps(new Xa.a(yp.qrk,"237279923"));let Td;this.addCommandToMaps((Td=new Xa.a(yp.lrk,"1656143904"),Td.legacyControlId="fseaNewPaste",Td));this.addCommandToMaps(new Xa.a(yp.krk,"1656143904"));let we;this.addCommandToMaps((we=new Xa.a("PageSize","1451516907"),we.legacyControlId="flySize",we));this.addCommandToMaps(new Xa.a("Photos","2670646631"));let Pd;this.addCommandToMaps((Pd=new Xa.a("PictureAbsoluteHeight","2808088361"),
Pd.legacyControlId="spnAbsoluteHeight",Pd.queryCommandId="2181343285",Pd));let He;this.addCommandToMaps((He=new Xa.a("PictureAbsoluteWidth","3108736954"),He.legacyControlId="spnAbsoluteWidth",He.queryCommandId="1960824158",He));this.addCommandToMaps(new Xa.a("Print","1588554917"));let Pe;this.addCommandToMaps((Pe=new Xa.a("PrintToWeb","1997662572"),Pe.legacyControlId="jbtnDigitalPrint",Pe));let Df;this.addCommandToMaps((Df=new Xa.a("ReadingView","3849298593"),Df.legacyControlId="btnReadingMode",Df));
let ig;this.addCommandToMaps((ig=new Xa.a("Redo","4183277502"),ig.legacyControlId="btnRedo",ig));let Tg;this.addCommandToMaps((Tg=new Xa.a("ResetPicture","2916220093"),Tg.legacyControlId="btnResetPicture",Tg));let Ig;this.addCommandToMaps((Ig=new Xa.a("RightToLeftTextDirection","2632572640"),Ig.legacyControlId="TextDirRTL",Ig.queryCommandId="1154760330",Ig));let Ff;this.addCommandToMaps((Ff=new Xa.a("RotatePictureMenu","2545543284"),Ff.legacyControlId="flyRotate",Ff));let nh;this.addCommandToMaps((nh=
new Xa.a("RotateLeft90","2545543284"),nh.legacyControlId="buttonRotateLeft90",nh.menuItemId="buttonRotateLeft90",nh));let Jg;this.addCommandToMaps((Jg=new Xa.a("RotateRight90","2545543284"),Jg.legacyControlId="buttonRotateRight90",Jg.menuItemId="buttonRotateRight90",Jg));let $h;this.addCommandToMaps(($h=new Xa.a("SelectCell","111222446"),$h.legacyControlId="btnSelectCell",$h));let Li;this.addCommandToMaps((Li=new Xa.a("SelectColumn","2341852628"),Li.legacyControlId="btnSelectColumn",Li));let Aj;this.addCommandToMaps((Aj=
new Xa.a("SelectRow","3508003794"),Aj.legacyControlId="btnSelectRow",Aj));let Zi;this.addCommandToMaps((Zi=new Xa.a("SelectTable","2306914518"),Zi.legacyControlId="btnSelectTable",Zi));let Ui;this.addCommandToMaps((Ui=new Xa.a("ShrinkFontSize","3575191971"),Ui.legacyControlId="fseaShrinkFontSize",Ui));let Bi;this.addCommandToMaps((Bi=new Xa.a("SetProofingLanguage","510284732"),Bi.legacyControlId="fseaOpenLanguageDialog",Bi));let Dk;this.addCommandToMaps((Dk=new Xa.a("SpacingAfter","2322582597"),Dk.legacyControlId=
"spnSpacingAfter",Dk.queryCommandId="2340669283",Dk));let kj;this.addCommandToMaps((kj=new Xa.a("SpacingBefore","1804274502"),kj.legacyControlId="spnSpacingBefore",kj.queryCommandId="26138520",kj));let rk;this.addCommandToMaps((rk=new Xa.a("SpecialIndent","2798144440"),rk.legacyControlId="flySpecialIndent",rk));let ml;this.addCommandToMaps((ml=new Xa.a("Spelling","2646312425"),ml.legacyControlId="fseaNextSpellingError",ml));let nl;this.addCommandToMaps((nl=new Xa.a("StandardShadingColorPicker","2765388691"),
nl.legacyControlId="cellShadingColorTable",nl));this.addCommandToMaps(new Xa.a("StandardFontColorPicker","1970784898"));this.addCommandToMaps(new Xa.a("RecentFontColorPicker","1970784898"));let Bl;this.addCommandToMaps((Bl=new Xa.a("Strikethrough","4169095173"),Bl.legacyControlId="fsbcStrikethrough",Bl.queryCommandId="2742230607",Bl));let bk;this.addCommandToMaps((bk=new Xa.a("StyleOptionsBandedColumns","1583455318"),bk.legacyControlId="buttonBandedColumn",bk.queryCommandId="1762426222",bk.menuItemId=
"buttonBandedColumn",bk));let Bj;this.addCommandToMaps((Bj=new Xa.a("StyleOptionsBandedRows","1583455318"),Bj.legacyControlId="buttonBandedRow",Bj.queryCommandId="1762426222",Bj.menuItemId="buttonBandedRow",Bj));let ck;this.addCommandToMaps((ck=new Xa.a("StyleOptionsFirstColumn","1583455318"),ck.legacyControlId="buttonFirstColumn",ck.queryCommandId="1762426222",ck.menuItemId="buttonFirstColumn",ck));let al;this.addCommandToMaps((al=new Xa.a("StyleOptionsHeaderRow","1583455318"),al.legacyControlId=
"buttonFirstRow",al.queryCommandId="1762426222",al.menuItemId="buttonFirstRow",al));let Cj;this.addCommandToMaps((Cj=new Xa.a("StyleOptionsLastColumn","1583455318"),Cj.legacyControlId="buttonLastColumn",Cj.queryCommandId="1762426222",Cj.menuItemId="buttonLastColumn",Cj));let oh;this.addCommandToMaps((oh=new Xa.a("StyleOptionsTotalRow","1583455318"),oh.legacyControlId="buttonLastRow",oh.queryCommandId="1762426222",oh.menuItemId="buttonLastRow",oh));let bl;this.addCommandToMaps((bl=new Xa.a("Subscript",
"1455408143"),bl.legacyControlId="fsbcSubscript",bl.queryCommandId="3960255053",bl));let Ol;this.addCommandToMaps((Ol=new Xa.a("Superscript","1107614"),Ol.legacyControlId="fsbcSuperscript",Ol.queryCommandId="692901994",Ol));let qm;this.addCommandToMaps((qm=new Xa.a("Table","28738965"),qm.legacyControlId="flyInsertTable",qm));let sk;this.addCommandToMaps((sk=new Xa.a("TableStyles","4171428777"),sk.queryCommandId="2135594455",sk.populationProps=new Vg("3359297384",!1),sk.previewControlIds="buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" "),
sk));this.addCommandToMaps(Object.assign(new Xa.a("TextAlignmentAnchor",null),{legacyControlId:"legacyTextAlignmentAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("TextAlignmentCenterJustify","4284004393"),{legacyControlId:"legacyTextAlignmentCenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Xa.a("TextAlignmentFullJustify","1733835213"),{legacyControlId:"legacyTextAlignmentFullJustify",queryCommandId:"1257252315"}));this.addCommandToMaps(Object.assign(new Xa.a("TextAlignmentLeftJustify",
"2539120357"),{legacyControlId:"legacyTextAlignmentLeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new Xa.a("TextAlignmentRightJustify","393413924"),{legacyControlId:"legacyTextAlignmentRightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(new Xa.a("ThemeShadingColorPicker","2765388691"));this.addCommandToMaps(new Xa.a("ThemeShadingColorPickerMCU","2765388691"));this.addCommandToMaps(new Xa.a("ThemeFontColorPicker","1970784898"));this.addCommandToMaps(new Xa.a("ThemeFontColorPickerMCU",
"1970784898"));this.addCommandToMaps(new Xa.a("ToggleChangeCase","1208649786"));this.addCommandToMaps(Object.assign(new Xa.a("Underline","1863297734"),{legacyControlId:"fsbcUnderline",queryCommandId:"2302164066"}));this.addCommandToMaps(Object.assign(new Xa.a("Undo","2792113512"),{legacyControlId:"btnUndo"}));this.addCommandToMaps(new Xa.a("OpenInClientUpsell","3588168074"));this.addCommandToMaps(Object.assign(new Xa.a("SelectAll","344786228"),{legacyControlId:"SelectAllButton"}));this.addCommandToMaps(Object.assign(new Xa.a("EditInClient",
"3588168074"),{legacyControlId:"btnjEditInClient"}));this.addCommandToMaps(Object.assign(new Xa.a("OpenInClient","3588168074"),{legacyControlId:"btnjOpenInClient"}));let Ek;this.addCommandToMaps((Ek=new Xa.a("PrintDocument","1588554917"),Ek.legacyControlId="jbtnDirectPrint",Ek));let ai;this.addCommandToMaps((ai=new Xa.a("PrintToPdf","1588554917"),ai.legacyControlId="jbtnPrintToPdf",ai));let tg;this.addCommandToMaps((tg=new Xa.a("ProtectDocument","1642700244"),tg.legacyControlId="btnProtectDocument",
tg.queryCommandId="3993403020",tg));let gi;this.addCommandToMaps((gi=new Xa.a("TransformToWebPage","1997662572"),gi.legacyControlId="jbtnTransformToWeb",gi));let Tf;this.addCommandToMaps((Tf=new Xa.a("OpenInClientWithIcon","3588168074"),Tf.legacyControlId="btnOpenInClient",Tf));let wd;this.addCommandToMaps((wd=new Xa.a("BulletLibrary_MLR","3552651681"),wd.queryCommandId="3827179399",wd.populationProps=new Vg("2466004410",!1),wd));let oe;this.addCommandToMaps((oe=new Xa.a("InsertPicture_MLR","2670646631"),
oe.legacyControlId="fseaInsertPicture",oe));let rf;this.addCommandToMaps((rf=new Xa.a("NumberingLibrary_MLR","2213049770"),rf.queryCommandId="3488367157",rf.populationProps=new Vg("3149136033",!1),rf));let Vd;this.addCommandToMaps((Vd=new Xa.a("PasteStandalone","237279923"),Vd.legacyControlId="fseaPaste",Vd));let yg;this.addCommandToMaps((yg=new Xa.a("Clipboard_MLR","237279923"),yg.legacyControlId="fseaNewPaste",yg));let hi;this.addCommandToMaps((hi=new Xa.a("InsertOnlinePictureStandalone","1685987254"),
hi.legacyControlId="fseaInsertOnlinePicture",hi));let vi;this.addCommandToMaps((vi=new Xa.a("InsertPictureFromHostStandalone","720118144"),vi.legacyControlId="fseaInsertOnlinePictureFromHost",vi.queryCommandId="3612507612",vi))}VFd(){this.addTabToMap("Picture","3523575366");this.addTabToMap("Table","1898844988")}}yp.nBi="Cut";yp.eti="Copy";yp.qrk="Paste";yp.lrk="PasteAsTextOnly";yp.krk="PasteAsTextOnlyContextMenu";Object(e.a)(yp,"Box4ReactCommandDefinitionMapping",Pw,[]);class nj extends er{constructor(a,
b,c){super();this.Tpf=b;this.im=c;this.wb(a)}wb(a){a.ra(D.a.cye,Db.a.application,Object(C.a)(this,this.O3g,"populateContextMenu"),96);a.ra(D.a.T3g,Db.a.application,Object(C.a)(this,this.O3g,"populateContextMenu"),96)}show(a,b,c){let f=null,l=new Sys.UI.Bounds(0,0,0,0);const w=this.q8i(a);if(w&&(a=a.Wa.node)&&(a=a.pc(oa.InteractiveViewManager.instance.Jd.Na))){l=N.a.it(a,w.end);if(u.AFrameworkApplication.isRtl&&l.x>b.x||!u.AFrameworkApplication.isRtl&&l.x+l.width<b.x||l.y+l.height<b.y)l=N.a.it(a,w.end-
1);b.x=l.x+(u.AFrameworkApplication.isRtl?0:l.width);b.y=l.y+l.height;f=6}er.fhd("mnuSpellingError",new Sys.UI.Bounds(b.x,b.y,l.width,l.height),c,f)}O3g(a,b,c,f,l){if(1===c)return 32;a=l.Ru;l=l.od;b=Object.assign(new Kl.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.Uwi(b,a);l.MenuItems=b;return 32}g3d(a,b){return this.sph(a)||nj.ALf(D.a.mVa)||nj.ALf(D.a.eHb)||this.Cal(a,b)||this.p9k(a,b)||nj.z$k()||nj.Woh(a).returnValue}sph(a){return 2===gb.App.Fb.mode&&this.vSc(a)}jWb(a,
b,c,f=null){if(this.sph(a)){c=this.p8i(a);var l=qa.a.re(c.lcid);l=l?l.name:"UNKNOWN";var w=Object(Ca.a)($l.a,c)?c.typeId:"";Z.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",c.errorType,c.proofingType,w,l);f?(a=this.Tpf.eWb(a,c))&&f.push.apply(f,a):b.append(this.Tpf.create(a,c))}}p8i(a){return this.im.IPa(a.Wa).Gh}vSc(a){return this.im.Ric(a)}c8f(){return null}q8i(a){return this.vSc(a)?this.im.IPa(a.Wa):(a=this.c8f(a))?new qk.a(a.HM,a.Lb):null}Cal(a,
b){if(2!==gb.App.Fb.mode||!a||!nj.yHj&&this.Dal(a,b))return!1;a=Ra.a.VNa(a.toArray());return!!nj.Ml.w1(a,14)}Dal(a,b){return 2===b||3===b&&!this.vSc(a)}p9k(a,b){return 3!==b||this.vSc(a)}static get Sf(){return nj.Pg||(nj.Pg=lb.a.instance.resolve("Box4.List.IListReader"))}static get Ml(){return xi.ContextSetEditor.instance}static get yHj(){return 1===gb.App.mode}static get dFj(){null==nj.Cud&&(nj.Cud=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkContextMenuOnEOPFixIsEnabled"):
!1);return nj.Cud}static get Wbc(){null==nj.wZa&&(nj.wZa=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return nj.wZa}static get CR(){null==nj.dM&&(nj.dM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return nj.dM}static ALf(a){return 32===u.AFrameworkApplication.Va.processAction(a,1)}static z$k(){return 2===gb.App.Fb.mode&&!!gb.App.WC.PR&&gb.App.WC.PR.yvg("510284732")}static Woh(a){let b,
c;b=c=!1;if(!a)return{returnValue:!1,IQa:b,R1b:c};if(nj.Wbc)return nj.n$k(a);if(!(a.Paa||nj.dFj&&2===a.length&&a.We.contextId===Db.a.endOfParagraph))return{returnValue:!1,IQa:b,R1b:c};a=a.Wa.clone();b=32===u.AFrameworkApplication.Va.li(a,D.a.VVa,1,!0,null,null);c=32===u.AFrameworkApplication.Va.li(a,D.a.insertHyperlink,1,!0,null,null);return{returnValue:b||c,IQa:b,R1b:c}}static n$k(a){let b;let c;var f=a.Wa.clone();c=nj.CR&&zg.m(f);b=!c&&32===u.AFrameworkApplication.Va.li(f,D.a.VVa,1,!0,null,null);
if(a.Paa||2===a.length&&a.We.contextId===Db.a.endOfParagraph)f=!c&&32===u.AFrameworkApplication.Va.li(f,D.a.insertHyperlink,1,!0,null,null);else{f=!0;const l=a.length;for(let w=0;w<l;w++){const F=a.ga(w).clone();if(F.contextId===Db.a.paragraph||F.contextId===Db.a.textRange)(c=nj.CR&&zg.m(F))||(f=32===u.AFrameworkApplication.Va.li(F,D.a.insertHyperlink,1,!0,null,null)&&f);else if(F.contextId!==Db.a.endOfParagraph)return f=b=!1,{returnValue:!1,IQa:b,R1b:f}}}return{returnValue:b||f,IQa:b,R1b:f}}static hwi(a,
b){let c=!1,f=!1;({IQa:c,R1b:f}=nj.Woh(a)).returnValue&&(c?f?b.push(nj.UZd(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):b.push(nj.UZd(["OpenHyperlink"])):f&&b.push(nj.UZd(["InsertLink"])))}static UZd(a){const b=Object.assign(new nk.a,{ControlList:[]});for(const c of a)Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:c}));return b}}nj.Cud=null;nj.Pg=null;nj.wZa=null;nj.dM=null;Object(e.a)(nj,"AEditSurfaceContextMenu",er,[]);class Oz extends nj{constructor(a,
b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){super(a,c,b,void 0,Mb);this.WSa=0;this.Jee=f;this.sa=l;this.AD=w;this.dEa=F;this.la=S;this.w4j=this.la.xDb;this.PGg=this.la.f2b;this.NOg=this.la.JTc;this.TOg=this.la.$$d;this.L$b=this.la.Eeb;this.FFg=this.la.ASi;this.xYj=this.la.mfc;this.rne=Mb;this.VB=b;this.YLg=fa;this.zD=xa;this.kc=Za;this.Ub=pb}Uwi(a,b){const c=[];switch(this.WSa){case 4:this.ipa(c,!0);this.JAf(c);this.dZh(c);this.wZh(c);this.L$b&&this.H_h(c);this.lSb(c);this.FMa(c);break;case 7:case 8:case 13:case 15:case 11:case 14:case 16:this.ipa(c,
!1);this.SFd(c,this.WSa);this.lSb(c);this.FMa(c);this.qpb(c);break;case 6:case 5:this.ipa(c,!1);this.SFd(c,this.WSa);this.la.xDb&&this.la.cmh&&this.HAf(c);this.FMa(c);this.qpb(c);break;case 2:this.ipa(c,!0);this.lzc(c,!0);break;case 1:this.ipa(c,!1);this.lzc(c,!1);this.JAf(c);this.eZh(c);this.yAf(c);Vw.Wmh&&this.rBf(c);this.lSb(c);this.FMa(c);this.qpb(c);break;case 3:this.UXh(c);this.qpb(c);break;case 19:this.$_h(c);this.lzc(c,!1);this.yAf(c);Vw.Wmh&&this.rBf(c);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&
this.kBf(c);this.lSb(c);break;case 21:this.M0h(c);break;case 20:this.ipa(c,!0);this.lzc(c,!0);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&this.kBf(c);this.lSb(c);break;case 9:this.ipa(c,!1);this.FMa(c);break;case 22:this.ipa(c,!1);this.SFd(c,this.WSa);this.FMa(c);break;case 10:this.ipa(c,!1);this.VZh(c);this.FMa(c);this.qpb(c);break;case 17:this.QZh(c);break;case 18:this.RZh(c);break;case 0:if(this.Ub.wj()){var f=oa.InteractiveViewManager.instance.Jd.Eb.Pa.kb;this.jWb(f,null,
b,c);this.ipa(c,!1,this.rne);this.la.powerPointSmartLookupIsEnabled&&(this.Z_h(c),this.l0h(c));3===b&&this.HGj(f)&&this.IYh(c);this.k_h(c);nj.hwi(f,c);this.Hzi(f,c);this.Gzi(f,c);this.w4j&&this.HAf(c);this.Oui(c);this.FMa(c);this.qpb(c)}}for(const l of c)Array.add(a.MenuSectionList,l);this.WSa=0}ajh(a){this.WSa=a}Xt(){return Object.assign(new nk.a,{ControlList:[]})}Bal(a){if(!this.NOg&&!this.TOg||2!==gb.App.Fb.mode)return!1;a=Ra.a.VNa(a.toArray());return!!this.dEa.w1(a,14)}Aal(a){if(!a||!this.xYj||
2!==gb.App.Fb.mode)return!1;a=Ra.a.VNa(a.toArray());return!!this.dEa.w1(a,14)}ipa(a,b,c=!1){const f=this.Xt();b||(Array.add(f.ControlList,Object.assign(new Of.a,{ExternalId:"Cut"})),Array.add(f.ControlList,Object.assign(new Of.a,{ExternalId:"Copy"})));this.VAf(a,f,c)}VAf(a,b,c){if(this.la.v8a){c=Object.assign(new nk.a,{DisplayMode:"Size24by24",ControlList:[],Title:ResourceStrings.L_PasteOptions,ShowMenuSectionTitleIcon:!1,ShowMenuSectionTitleBackground:!1,MenuSectionTitleFocusable:!1});var f=Object.assign(new qq.a,
{Id:"PasteOptions",ExternalId:"PasteOptionsSection",ExternalGalleryId:"PasteOptionsGallery",Type:4,Width:5,ElementDimensions:"Size24by24",GalleryItems:[]});Array.add(c.ControlList,f);for(let l=1;5>=l;l++)(4!==l||this.la.FRa)&&f.GalleryItems.push(this.aKc(l));a.push(b);a.push(c)}else Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"Paste"})),c&&Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"PasteTextOnly"})),a.push(b)}aKc(a){const b={root:{width:"24px",height:"24px"}};let c,
f,l;switch(a){case 1:l="ContextMenu.Paste";a="Paste_20";c="3642315978";f=ResourceStrings.L_Paste;break;case 2:l="ContextMenu.PasteKeepingDestinationTheme";a="Pastedestinationtheme_20";c="4207422373";f=ResourceStrings.L_PasteWithDestinationTheme;break;case 3:l="ContextMenu.PasteKeepingSourceFormatting";a="Pastesourceformatting_20";c="2529825506";f=ResourceStrings.l_PasteWithSourceTheme;break;case 4:l="ContextMenu.PasteAsImage";a="Pasteaspicture_20";c="1302928870";f=ResourceStrings.l_PasteAsImage;break;
case 5:l="ContextMenu.PasteTextOnly";a="PasteTextOnly_20";c="2061487721";f=ResourceStrings.L_PasteTextOnly;break;default:l="ContextMenu.Paste",a="Paste_20",c="3642315978",f=ResourceStrings.L_Paste}return Object.assign(new eE.a,{Id:l,Icon:a,Alt:f,PreviewIconStyle:b,FullIconStyle:b,Command:c})}M0h(a){const b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"CopyInVersionHistory"}));a.push(b)}$_h(a){const b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"Cut"}));
Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"Copy"}));this.VAf(a,b,!1)}lzc(a,b){const c=this.Xt();Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"NewSlideWithoutDialog"}));b||(Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"DuplicateSlide"})),Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"DeleteSlide"})));a.push(c)}dZh(a){if(this.FFg){const b=this.Xt();b.ControlList.push(Object.assign(new Of.a,{ExternalId:"FormatBackgroundFromCanvas"}));a.push(b)}}eZh(a){if(this.FFg){const b=
this.Xt();b.ControlList.push(Object.assign(new Of.a,{ExternalId:"FormatBackgroundFromThumbnailPane"}));a.push(b)}}UXh(a){const b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"Paste"}));Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}yAf(a){const b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"HideSlide"}));this.la.V3d&&Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"UnhideSlide"}));a.push(b)}rBf(a){const b=
this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"ShareSlide"}));a.push(b)}RZh(a){const b=this.j7f();a.push(b)}kBf(a){const b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"AddSection"}));a.push(b)}SFd(a,b){const c=this.Xt();7===b?(this.la.aHa?Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"ChangePictureContextMenu"})):Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"ChangePicture"})),this.la.qRa&&Array.add(c.ControlList,Object.assign(new Of.a,
{ExternalId:"AlternativeText"}))):13===b?this.la.aHa&&Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"ChangeGraphicContextMenu"})):8===b?Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"SmartArtEditText"})):14!==b&&15!==b&&16!==b&&22!==b&&Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"BeginEditShapeText"}));22!==b&&(this.xAf(c),this.la.kJc&&this.pAf(c));this.eAf(c);this.FHf(c);this.jih(c);a.push(c)}JAf(a){const b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,
{ExternalId:this.la.yWa?"ChangeLayoutFlyout":"ChangeLayout"}));a.push(b)}HAf(a){const b=this.Xt();this.PGg&&Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"ImmersiveReader"}));Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"OpenPowerPointLanguageDialog"}));a.push(b)}lSb(a){if(this.PGg){var b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"ImmersiveReader"}));a.push(b)}}jih(a){Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"SendToBackFlyout"}))}FHf(a){Array.add(a.ControlList,
Object.assign(new Of.a,{ExternalId:"BringToFrontFlyout"}))}xAf(a){Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"GroupAnchor"}))}eAf(a){Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"ShowHideFormatShapePane"}))}pAf(a){Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"FixIt"}))}VZh(a){const b=this.Xt();this.xAf(b);this.la.kJc&&this.pAf(b);this.eAf(b);this.FHf(b);this.jih(b);a.push(b)}FMa(a){const b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"InsertComment"}));
a.push(b)}wZh(a){const b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"DesignerHome"}));a.push(b)}H_h(a){const b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"ShowHideRuler"}));a.push(b)}qwi(){const a=this.Jee.mzi();return Object.assign(new Of.a,{ExternalId:"SmartLookupContextMenu",LabelText:a})}Z_h(a){const b=this.Xt();Array.add(b.ControlList,this.qwi());a.push(b)}l0h(a){if(!this.Jee.Bji()){var b=this.Jee.Czi();if(b){var c=this.Xt();Array.add(c.ControlList,
Object.assign(new Of.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}));a.push(c)}}}k_h(a){const b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"ParagraphOptions"}));a.push(b)}IYh(a){const b=this.Xt();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"Delete"}));a.push(b)}Oui(a){var b=lb.a.instance.qb("PowerPointWebEditor.IContextMenuExtensibilityHandler");b&&(b=b.iUi())&&a.push(b)}Hzi(a,b){a&&this.Bal(a)&&(a=this.Xt(),this.NOg&&Array.add(a.ControlList,Object.assign(new Of.a,
{ExternalId:"MergeTableCells"})),this.TOg&&Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"SplitTableCells"})),b.push(a))}Gzi(a,b){this.Aal(a)&&(a=this.Xt(),Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"SetSizeAnchor"})),Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"TableDistribute"})),b.push(a))}HGj(a){return this.VB.Ric(a)}QZh(a){const b=this.j7f();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}j7f(){const a=
this.Xt();Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"RenameSection"}));Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"RemoveSection"}));Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"MoveSectionUp"}));Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"MoveSectionDown"}));return a}qpb(a){this.YLg&&this.YLg.eWb(this.HZb(),a)}HZb(){return this.zD.instance?this.zD.instance.HZb():[]}}Object(e.a)(Oz,"EditSurfaceContextMenu",nj,[]);class bM{constructor(a,
b,c,f,l,w,F,S,fa,xa){this.Q$b=null;this.Fzb=0;this.SN=b;this.BD=c;this.Fja=f;this.Bb=w;this.dYj=F;this.ia=fa;this.Xc=S;this.Xc.o1h(Object(C.a)(this,this.cWg,"onCUIStatusChanged"));this.Xc.vzc(Object(C.a)(this,this.pT,"onFocusChanged"));this.Xc.qGd(Object(C.a)(this,this.e8c,"onSetFocus"));this.I$b=xa}get inKeytipMode(){return appChrome.api.inKeytipMode()}dispose(){this.Xc.rMk(Object(C.a)(this,this.cWg,"onCUIStatusChanged"));this.Xc.ucd(Object(C.a)(this,this.pT,"onFocusChanged"));this.Xc.Xbh(Object(C.a)(this,
this.e8c,"onSetFocus"))}initialize(){this.wb();this.YG()}pT(){}e8c(a,b){b.qBb!==Xd.a.hea||b.vfc===y.AFrame.fcb||b.vfc.endsWith("/modal")||appChrome.api.enterKeytipMode()}bml(a){this.Fzb|=a;this.Q$b||(this.Q$b=new Se.a(0,1,0,Object(C.a)(this,this.D3k,"setTimeOutWithCurrentActionContext"),90,"11"),this.Q$b.customData=new Date,this.Bb.Hb(this.Q$b))}wb(){this.ia.ra(aa.a.x0,$b.a.application,Object(C.a)(this,this.Kkj,"handleOpenMenu"),64)}Kkj(a,b,c,f,l){return this.x0(l)?32:8}D3k(a){Kc.a.vLi(Object(C.a)(this,
this.YG,"poll"),Object(ua.a)(Date,a.customData));this.Q$b=null}cWg(a,b){this.bml(b.Jel)}YG(){this.dYj.clearCache();0!==(this.Fzb&1)&&this.BD.YG();0!==(this.Fzb&2)&&this.SN.YG();0!==(this.Fzb&4)&&this.Fja.YG();this.Fzb=0}x0(a){return this.I$b.x0(a)}}Object(e.a)(bM,"CUIManager",null,[200,109]);var fE=d(1187),gE=d(1158),zQ=d(1027),hE=d(1048);class Vs{constructor(){this.italic=0;this.gUc=!1;this.underline=0;this.fU=this.dld=!1;this.superscript=0;this.Aid=!1;this.subscript=0;this.wid=!1;this.strikethrough=
0;this.iid=!1;this.rs=0;this.WGc=!1;this.fontName=null;this.pZb=this.Gjd=this.wJc=this.vJc=!1;this.highlight=0;this.lPc=!1;this.bold=this.italic=this.underline=this.strikethrough=this.rs=this.superscript=this.subscript=2;this.fontColor=this.highlight=this.fontSize=-1;this.kw=od.Font.uyj;this.bna=-1;this.vJd=this.gUc=this.dld=this.fU=this.Aid=this.wid=this.iid=this.WGc=this.vJc=this.wJc=this.Gjd=this.pZb=this.lPc=!1}}Object(e.a)(Vs,"FormattingData",null,[]);var iE=d(806),AQ=d(772);class Qk{constructor(){this.Cm=
this.Wcb=0;this.od=null;this.nF=!1;this.gK=null}}Object(e.a)(Qk,"CuiEnabledInfo",null,[]);class Wg{constructor(){this.Cm=this.Wcb=0;this.od=null;this.nF=this.X9d=this.Y9d=this.MV=this.Aq=this.G3d=!1;this.gK=null}}Object(e.a)(Wg,"CuiExecuteInfo",null,[]);class BQ{constructor(){this.oNe=new kq.a;this.L8d=!1}}Object(e.a)(BQ,"TextRangeStyleData",null,[]);class jg{constructor(){this.hb=new Ie.a;this.Wc=new Ie.a;this.q2e=new Vs;this.Rff=new iE.a;this.Ssd=this.Rsd=!1}initialize(){jg.cth=jg.kPd();this.hb.$(D.a.undo,
jg.q2b);this.hb.$(D.a.redo,jg.q2b);this.hb.$(D.a.H5c,jg.q2b);this.hb.$(D.a.T3g,jg.Jkl);this.hb.$(D.a.openInClient,jg.Lnk);this.hb.$(G.a.close,jg.Bmi);this.hb.$(D.a.dK,jg.FEi);this.hb.$(D.a.font,jg.TVd);this.hb.$(D.a.rr,Object(C.a)(this,this.IWd,"genericFontSizeExecuteBridge"));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(this.hb.$(D.a.p4,jg.TVd),this.hb.$(D.a.KHa,jg.TVd),this.hb.$(D.a.dHa,Object(C.a)(this,this.IWd,"genericFontSizeExecuteBridge")),this.hb.$(D.a.$Wa,Object(C.a)(this,this.MSk,
"revertPreviewFontSizeExecuteBridge")));this.hb.$(D.a.bold,jg.brb);this.hb.$(D.a.setItalic,jg.brb);this.hb.$(D.a.underline,jg.brb);this.hb.$(D.a.strikethrough,jg.brb);this.hb.$(D.a.superscript,jg.brb);this.hb.$(D.a.subscript,jg.brb);this.hb.$(D.a.Jfc,Object(C.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(D.a.Ofc,Object(C.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(D.a.Pgc,Object(C.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(D.a.xgc,Object(C.a)(this,this.Bva,
"queryFormattingExecuteBridge"));this.hb.$(D.a.zgc,Object(C.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(D.a.bBe,Object(C.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(D.a.Fgc,Object(C.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(D.a.had,Object(C.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(D.a.Mfc,Object(C.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(D.a.rAe,Object(C.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(D.a.sAe,
Object(C.a)(this,this.hAk,"queryFormatPainterExecuteBridge"));this.hb.$(D.a.Qfc,Object(C.a)(this,this.uad,"queryParaFormattingExecuteBridge"));this.hb.$(D.a.pgc,Object(C.a)(this,this.uad,"queryParaFormattingExecuteBridge"));this.hb.$(D.a.Lfc,Object(C.a)(this,this.uad,"queryParaFormattingExecuteBridge"));this.hb.$(D.a.Nfc,Object(C.a)(this,this.uad,"queryParaFormattingExecuteBridge"));this.hb.$(D.a.BE,jg.y_f);this.hb.$(D.a.Qy,jg.y_f);this.hb.$(G.a.BMd,jg.DDb);this.hb.$(D.a.kbe,jg.q2b);this.Wc.$(D.a.RCb,
jg.oGc);this.Wc.$(D.a.SCb,jg.oGc);this.Wc.$(D.a.Cec,jg.oGc);this.Wc.$(D.a.Y9c,jg.oGc);this.Wc.$(D.a.Jfc,jg.Lva);this.Wc.$(D.a.Ofc,jg.Lva);this.Wc.$(D.a.Pgc,jg.Lva);this.Wc.$(D.a.xgc,jg.Lva);this.Wc.$(D.a.zgc,jg.Lva);this.Wc.$(D.a.bBe,jg.Lva);this.Wc.$(D.a.Fgc,jg.Lva);this.Wc.$(D.a.had,jg.Lva);this.Wc.$(D.a.Mfc,jg.Lva);this.Wc.$(D.a.rAe,jg.Lva);this.Wc.$(D.a.Qfc,jg.icd);this.Wc.$(D.a.Lfc,jg.icd);this.Wc.$(D.a.pgc,jg.icd);this.Wc.$(D.a.Nfc,jg.icd);this.hb.$(D.a.cOf,Object(C.a)(this,this.kxj,"insertHyperLinkBridge"));
this.hb.$(D.a.GMd,Object(C.a)(this,this.bOf,"commandingInputMethodExecuteBridge"));this.hb.$(D.a.gOf,Object(C.a)(this,this.bOf,"commandingInputMethodExecuteBridge"));this.hb.$(D.a.dOf,Object(C.a)(this,this.vxj,"insertOnLinePictureExecuteBridge"));this.hb.$(D.a.eOf,Object(C.a)(this,this.Pxj,"insertSymbolBridge"));this.hb.$(D.a.fOf,Object(C.a)(this,this.Jni,"commandingInsertTableExecuteBridge"));this.hb.$(D.a.Kni,Object(C.a)(this,this.Hbk,"navToPageExecuteBridge"));this.hb.$(D.a.aOf,jg.$Nf);this.hb.$(D.a.FMd,
jg.$Nf);u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")&&this.Wc.$(G.a.ved,jg.aWk)}clearCache(){this.q2e=new Vs;this.Rff=new iE.a;this.Ssd=this.Rsd=!1}B8f(a,b,c){const f=this.hb.ga(a);f?c=f(a,b,c):(c=new Wg,c.od=b);c.Wcb=a;c.Cm||(c.Cm=jg.Y8j(a));Pg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.FlagExclusivelyMappedCommands")&&this.Cni(a,b)&&(c.od||(c.od={}),"object"===typeof c.od&&(c.od.MappedCommand=!0));return c}oLc(a,b=
null){const c=this.Wc.ga(a);b=c?c(a,b):new Qk;b.Wcb=a;b.Cm||(b.Cm=a);return b}Bva(){const a=new Wg;a.G3d=this.Ssd;this.Ssd=!0;a.Cm=D.a.EDb;a.od=this.q2e;a.MV=!0;return a}uad(){const a=new Wg;a.G3d=this.Rsd;this.Rsd=!0;a.Cm=D.a.Cva;a.od=this.Rff;a.X9d=!0;a.MV=!0;return a}IWd(a,b){const c=new Wg;c.Aq=!0;let f=0;({number:f}=Ja.a.Nqk(b.CommandValueId||b.Value,u.AFrameworkApplication.numberFormat));if(isNaN(f))return gb.App.Fb.updateCommandUI(),c.gK=!1,c;a===D.a.dHa&&(b[yn.a.qea]=!1);c.od=jg.cOd(Math.floor(2*
f),b);return c}MSk(a,b){a=new Wg;a.Aq=!0;b[yn.a.qea]=!1;a.od=jg.cOd(0,b);return a}bOf(a){var b={Visible:!0};a===D.a.GMd?(b.LabelText="Undo",b.SourceControlId="btnUndo"):(b.LabelText="Redo",b.SourceControlId="btnRedo");a=new gE.a(b,2);b=new Wg;b.od=a;return b}vxj(a,b){a=new Wg;const c=new H.DictionaryPropertySet;b=b.Value?b.Value:null;if(!b||""===b)return null;b=String.format("<img src={0}>",b);c.setValue(Kd.a.sT,b);a.od=c;return a}kxj(a,b){a=new Wg;b.Source="CommandingInterface";a.od=b;return a}Jni(a,
b){a=new Wg;a.Aq=!0;const c=new fI;c.rows=b.Row;c.columns=b.Col;a.od=c;return a}Pxj(a,b){a=new Wg;a.Aq=!0;b=b.Value;a.od=new H.DictionaryPropertySet;const c=this.lNc(b),f={};f.SourceControlId="symbol_"+b+"_"+c;f.InnerHtml=String.format('<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>',c);a.od=f;return a}Hbk(a,b){a=new Wg;a.od=b.Value?b.Value:"";return a}hAk(){const a=new Wg;a.od=lb.a.instance.qb("Box4.IFormatPainter");a.MV=!0;return a}lNc(a){return jg.cth[a.toString()]}Cni(a,
b){a=b&&b.launcherCommandId?b.launcherCommandId:a;b=!!this.Wc.ga(a)||!!this.hb.ga(a);return!u.AFrameworkApplication.Va.eS(a)&&b}static kPd(){return{0:"\u2022",1:"\u20ac",2:"\u00a3",3:"\u00a5",4:"\u00a9",5:"\u00ae",6:"\u2122",7:"\u00b1",8:"\u2260",9:"\u2264",10:"\u2265",11:"\u00f7",12:"\u00d7",13:"\u221e",14:"\u00b5",15:"\u03b1",16:"\u03b2",17:"\u03c0",18:"\u03a9",19:"\u03a3",20:"\u00b0",21:"\u0394",22:"\u263a",23:"\u2665",24:"\u20b9"}}static dTb(a,b){var c=Object(ua.a)(Vs,a.od),f=Object(ua.a)(iE.a,
a.od);let l=!0;switch(a.Wcb){default:l=!1;break;case D.a.R6g:b[Uh.a.On]=!0;break;case D.a.Jfc:b[Uh.a.On]=1===c.bold;break;case D.a.Ofc:b[Uh.a.On]=1===c.italic;break;case D.a.Pgc:b[Uh.a.On]=1===c.underline;break;case D.a.bBe:b[CG.a.On]=1===c.subscript;break;case D.a.zgc:b[Uh.a.On]=1===c.subscript;break;case D.a.Fgc:b[Uh.a.On]=1===c.superscript;break;case D.a.xgc:b[Uh.a.On]=1===c.strikethrough||1===c.rs;break;case D.a.had:b[lo.a.IsFreeForm]=!0;b[lo.a.Value]=void 0!==c.fontName&&null!==c.fontName?Ab.a.e8f(c.fontName,
c.bna):"";break;case D.a.Mfc:a="";-1!==c.fontSize&&(a=Ja.a.IJc(c.fontSize/2,0,u.AFrameworkApplication.numberFormat));b[lo.a.IsFreeForm]=!0;b[lo.a.Value]=a;break;case D.a.rAe:if(void 0!==c.fontName&&null!==c.fontName){if(a=1===c.bold,f=1===c.italic,a=da.FontUtils.iAk(c.fontName,a,f,a&&f?Box4Intl.Box4Strings.L_FontNameBoldItalic:a?Box4Intl.Box4Strings.L_FontNameBold:f?Box4Intl.Box4Strings.L_FontNameItalic:"{0}"),void 0===c.fontName||null===c.fontName)a=Ab.a.e8f(c.fontName,c.bna),a=appChrome.api.selectedFont(a,
c.fontName)}else a=appChrome.api.selectedFont("");void 0!==a.isMissingFont&&null!==a.isMissingFont||void 0===a.name||null===a.name||""===a.name||(a.isMissingFont=da.FontUtils.isMissingFont(void 0!==a.key&&null!==a.key&&""!==a.key?a.key:a.name));b[mo.SelectedFont]=a;break;case D.a.Qfc:b[Uh.a.On]=1===f.pl;break;case D.a.Lfc:b[Uh.a.On]=2===f.pl;break;case D.a.pgc:b[Uh.a.On]=3===f.pl;break;case D.a.Nfc:b[Uh.a.On]=6===f.pl;break;case D.a.sAe:if(c=Object(ua.a)(270,a.od))b[Uh.a.On]=c.wK;case G.a.BMd:}return l}static y_f(){return new Wg}static DDb(a,
b){a=new Wg;a.od=b;a.MV=!0;return a}static q2b(a,b,c){a=new gE.a(b,c.InvocationMethod);b=new Wg;b.od=a;return b}static Jkl(a,b){a=new gE.a(b,3);b=new Wg;b.od=a;return b}static Lnk(a,b,c){a=new Wg;zQ.a.Ezg(c.CommandLocation)||26===c.CommandLocation||(a.od=!1);return a}static mAe(){const a=new Wg;a.od=new H.DictionaryPropertySet;a.MV=!0;return a}static FEi(){const a=new Wg;a.od=new H.DictionaryPropertySet;return a}static Bmi(){const a=new Wg;a.od=Ii.b;return a}static oGc(){const a=new Qk;a.od=new H.DictionaryPropertySet;
return a}static aWk(a,b=null){a=new Qk;a.od=b;return a}static brb(){const a=new Wg;a.od=new Q(2);a.Aq=!0;return a}static icd(){const a=new Qk;a.Cm=D.a.Cva;return a}static Lva(){const a=new Qk;a.Cm=D.a.EDb;return a}static TVd(a,b){const c=new Wg;c.Aq=!0;var f=b.CommandValueId?b.CommandValueId:b.Value;c.od=f;if(od.Font.BRa()){const w=new Vs;var l=b.MenuItemId;l&&(w.bna=od.Font.ydj(l));(l=Object(ua.a)(AQ.a,b[mo.Formatting]))&&(l.isBold||l.isItalic)&&(w.bold=l.isBold?1:0,w.italic=l.isItalic?1:0);w.fontName=
f;c.od=w}jg.WTj(b);(a=u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===D.a.p4||a===D.a.KHa))&&(b[yn.a.qea]=!1);c.od=jg.cOd(c.od,b);a||(da.FontUtils.bzc(f),f=b[mo.RequestUpdateMru],void 0!==f&&null!==f&&appChrome.api.dispatch(appChrome.actions.addFontToMru(b.SourceControlId,f)));return c}static WTj(a){void 0!==a[lo.a.IsFreeForm]&&null!==a[lo.a.IsFreeForm]&&a[lo.a.IsFreeForm]?Z.ULS.sendTraceTag(51390360,324,50,"Font applied is not a valid menu item"):void 0!==a.MenuItemId&&null!==a.MenuItemId&&
Z.ULS.sendTraceTag(51390361,324,50,String.format("Font applied is in MenuItemID:{0}",a.MenuItemId))}static $Nf(a,b){a=new Wg;b=b.Color?b.Color:null;if(!b||6!==b.length)return null;a.od=jg.U3a(b);a.Aq=!0;return a}static U3a(a){return 6!==a.length?null:a.substring(4,6)+a.substring(2,4)+a.substring(0,2)}static Y8j(a){switch(a){case D.a.GMd:return D.a.undo;case D.a.gOf:return D.a.redo;case D.a.fOf:return D.a.insertTable;case D.a.dOf:return D.a.Ipa;case D.a.eOf:return D.a.$Qa;case D.a.cOf:return D.a.insertHyperlink;
case D.a.aOf:return D.a.Ms;case D.a.FMd:return D.a.T9;default:return a}}static cOd(a,b){const c=new hE.a(a);return u.AFrameworkApplication.Ba.jb.Ip?new hE.a(a,b[yn.a.qea]):c}}jg.cth={};Object(e.a)(jg,"CuiActionBridge",null,[]);class cM{constructor(){this.UHd=this.dTb=this.lye=this.Mye=null}}Object(e.a)(cM,"GeneralCuiUserHooks",null,[]);var CQ=d(493);class xv{constructor(){this.OT=this.tWa=null;this.menuItemId=0}}Object(e.a)(xv,"QueryData",null,[]);let Ye;class td extends jg{constructor(a,b,c,f,l,
w,F,S){super();this.la=a;this.sa=b;this.EWj=c;this.ezb=f;this.wc=l;this.Ub=w;this.Pb=F;this.zTa=S}initialize(){super.initialize();this.gwj();this.ywj();this.zvj();this.kwj();this.Puj();this.vwj();this.Rvj();this.Suj();this.qvj();this.$uj()}oLc(a,b=null){if(u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")){const c=this.Wc.ga(a);b=c?c(a,b):new Qk;b.Wcb=a;b.Cm||(b.Cm=a);b&&this.Pb&&1===this.Pb.Aw&&!td.E7d(a)&&(b.gK=!1);return b}(b=super.oLc(a))&&this.Pb&&1===this.Pb.Aw&&
!td.E7d(a)&&(b.gK=!1);return b}gwj(){this.la.Feb&&(this.Wc.$(aa.a.mDb,Object(C.a)(this,this.dma,"remapRumTrackerEnabledBridge")),this.Wc.$(aa.a.sfc,Object(C.a)(this,this.dma,"remapRumTrackerEnabledBridge")),this.Wc.$(G.a.mmc,Object(C.a)(this,this.dma,"remapRumTrackerEnabledBridge")),this.Wc.$(aa.a.lhd,Object(C.a)(this,this.dma,"remapRumTrackerEnabledBridge")),this.Wc.$(D.a.nmc,Object(C.a)(this,this.dma,"remapRumTrackerEnabledBridge")),this.Wc.$(G.a.gPa,Object(C.a)(this,this.dma,"remapRumTrackerEnabledBridge")));
this.la.yic&&(this.Wc.$(aa.a.VXa,Object(C.a)(this,this.dma,"remapRumTrackerEnabledBridge")),this.Wc.$(aa.a.Tfb,Object(C.a)(this,this.dma,"remapRumTrackerEnabledBridge")),this.Wc.$(aa.a.ZXa,Object(C.a)(this,this.dma,"remapRumTrackerEnabledBridge")),this.Wc.$(aa.a.mYa,Object(C.a)(this,this.dma,"remapRumTrackerEnabledBridge")),this.Wc.$(aa.a.eUe,Object(C.a)(this,this.dma,"remapRumTrackerEnabledBridge")))}ywj(){this.hb.$(aa.a.Vfc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.agc,Object(C.a)(this,
this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.lgc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.Xfc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.bgc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.egc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.$fc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.igc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.hgc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));
this.hb.$(aa.a.ggc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.Yfc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.Zfc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.Wfc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.dgc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.hHa,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.Jdb,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.IDb,
Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.HDb,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.r7g,td.jf);this.hb.$(aa.a.fgc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.cgc,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.LAe,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.KAe,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.Kdb,Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.hb.$(aa.a.Ldb,
Object(C.a)(this,this.PD,"remapTextQueryExecute"));this.Wc.$(aa.a.Vfc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.agc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.lgc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.Xfc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.bgc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.egc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.$fc,Object(C.a)(this,
this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.igc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.hgc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.ggc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.Yfc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.Zfc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.Wfc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.dgc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));
this.Wc.$(aa.a.hHa,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.Jdb,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.IDb,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.HDb,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.fgc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.cgc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.LAe,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.KAe,
Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.Kdb,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.Ldb,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.hb.$(aa.a.Lec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Sec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.jfc,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.VCb,Object(C.a)(this,this.nUc,"justifyExecuteBridge"));this.hb.$(aa.a.bDb,Object(C.a)(this,this.nUc,
"justifyExecuteBridge"));this.hb.$(aa.a.eDb,Object(C.a)(this,this.nUc,"justifyExecuteBridge"));this.hb.$(aa.a.$Cb,Object(C.a)(this,this.nUc,"justifyExecuteBridge"));this.hb.$(aa.a.YCb,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Yec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.afc,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.ZCb,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Zec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.bfc,
Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.fDb,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.aDb,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Ula,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Tla,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Sla,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.dfc,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Uec,Object(C.a)(this,this.Ks,"remapTextExecute"));
this.hb.$(aa.a.Vec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Wec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Xec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.m$c,td.bzg);this.hb.$(aa.a.n$c,td.bzg);this.hb.$(aa.a.xva,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.eWa,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.oGb,Object(C.a)(this,this.czg,"listMarkerGalleryShapeExecuteBridge"));this.hb.$(aa.a.XFb,Object(C.a)(this,this.czg,
"listMarkerGalleryShapeExecuteBridge"));this.hb.$(aa.a.e$c,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.f$c,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.XCb,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Qec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Mec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.Pec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.$ec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.r$c,
Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.cfc,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.insertHyperlink,Object(C.a)(this,this.uKk,"remapInsertHyperlinkExecute"));this.hb.$(aa.a.Tec,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.cDb,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.efc,Object(C.a)(this,this.Ks,"remapTextExecute"));this.hb.$(aa.a.ffc,Object(C.a)(this,this.Ks,"remapTextExecute"));this.Wc.$(aa.a.Lec,Object(C.a)(this,this.Zr,
"remapTextEnabled"));this.Wc.$(aa.a.Sec,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.jfc,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.VCb,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.bDb,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.eDb,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.$Cb,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.YCb,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.Yec,Object(C.a)(this,
this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.afc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.ZCb,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.Zec,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.bfc,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));this.Wc.$(aa.a.fDb,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.aDb,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Ula,Object(C.a)(this,this.Zr,"remapTextEnabled"));
this.Wc.$(aa.a.Tla,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Sla,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.dfc,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Uec,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Vec,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Wec,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Xec,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.xva,Object(C.a)(this,this.Zr,"remapTextEnabled"));
this.Wc.$(aa.a.eWa,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.e$c,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.f$c,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.XCb,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Qec,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Mec,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Pec,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.$ec,Object(C.a)(this,this.Zr,"remapTextEnabled"));
this.Wc.$(aa.a.r$c,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.cfc,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Tec,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.cDb,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.insertHyperlink,Object(C.a)(this,this.tKk,"remapInsertHyperlinkEnabled"));this.Wc.$(aa.a.Kdb,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Ldb,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.efc,Object(C.a)(this,
this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.ffc,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Kdb,Object(C.a)(this,this.Zr,"remapTextEnabled"));this.Wc.$(aa.a.Ldb,Object(C.a)(this,this.Zr,"remapTextEnabled"))}zvj(){this.hb.$(aa.a.e7g,Object(C.a)(this,this.Hdb,"queryInkControlToggledExecuteBridge"));this.hb.$(aa.a.Z6g,Object(C.a)(this,this.Hdb,"queryInkControlToggledExecuteBridge"));this.hb.$(aa.a.b7g,Object(C.a)(this,this.Hdb,"queryInkControlToggledExecuteBridge"));this.hb.$(aa.a.$6g,
Object(C.a)(this,this.Hdb,"queryInkControlToggledExecuteBridge"));this.hb.$(aa.a.c7g,Object(C.a)(this,this.Hdb,"queryInkControlToggledExecuteBridge"));this.hb.$(aa.a.d7g,Object(C.a)(this,this.Hdb,"queryInkControlToggledExecuteBridge"));this.hb.$(aa.a.a7g,Object(C.a)(this,this.Hdb,"queryInkControlToggledExecuteBridge"))}kwj(){this.hb.$(aa.a.rgc,td.jf);this.hb.$(aa.a.sgc,td.jf);this.hb.$(aa.a.ugc,td.jf);this.hb.$(aa.a.Qad,td.jf);this.hb.$(aa.a.Pad,td.jf);this.hb.$(aa.a.Rad,td.jf);this.hb.$(aa.a.Sad,
td.jf);this.hb.$(aa.a.Uad,td.jf);this.hb.$(aa.a.Oad,td.jf);this.hb.$(aa.a.Wad,td.jf);this.hb.$(aa.a.Tad,td.jf);this.hb.$(aa.a.abd,td.jf);this.hb.$(aa.a.$ad,td.jf);this.hb.$(aa.a.Zad,td.jf);this.hb.$(aa.a.Odb,td.jf);this.hb.$(aa.a.Pdb,td.jf);this.hb.$(aa.a.rWa,Object(C.a)(this,this.mad,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(aa.a.sWa,Object(C.a)(this,this.mad,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(aa.a.Nad,td.jf);this.hb.$(aa.a.Mad,td.jf);this.hb.$(aa.a.tgc,td.jf);this.hb.$(aa.a.Xad,
td.jf);this.hb.$(aa.a.Yad,td.jf);this.Wc.$(aa.a.tfb,td.bB);this.Wc.$(aa.a.ufb,td.bB);this.Wc.$(aa.a.VFb,td.bB);this.Wc.$(aa.a.Ffb,td.bB);this.Wc.$(aa.a.qGb,td.bB);this.Wc.$(aa.a.wJe,td.bB);this.hb.$(aa.a.tfb,Object(C.a)(this,this.YRi,"fontNameExecuteBridge"));this.hb.$(aa.a.ufb,Object(C.a)(this,this.IWd,"genericFontSizeExecuteBridge"));this.hb.$(aa.a.VFb,td.UNe);this.hb.$(aa.a.Ffb,td.UNe);this.hb.$(aa.a.qGb,td.UNe);this.Wc.$(aa.a.iFf,td.OXa);this.Wc.$(aa.a.jFf,td.OXa);this.Wc.$(aa.a.THd,td.OXa);this.Wc.$(aa.a.PHd,
td.OXa);this.Wc.$(aa.a.SHd,td.OXa);this.Wc.$(aa.a.QHd,td.OXa);this.Wc.$(aa.a.kFf,td.OXa);this.Wc.$(aa.a.$Ef,td.OXa);this.hb.$(aa.a.Zfd,td.Uyg);this.hb.$(aa.a.qWa,td.j7g);this.hb.$(aa.a.Vad,td.j7g);this.hb.$(aa.a.Ola,td.Uyg)}Puj(){this.hb.$(aa.a.Xda,Object(C.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(aa.a.Fva,Object(C.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(aa.a.kHa,Object(C.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(aa.a.Ogc,
Object(C.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(aa.a.ODb,Object(C.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(aa.a.nBe,Object(C.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(aa.a.jHa,td.K_);this.hb.$(aa.a.nwa,Object(C.a)(this,this.vkd,"transitionExecuteBridge"));this.hb.$(aa.a.jGb,Object(C.a)(this,this.vkd,"transitionExecuteBridge"));this.Wc.$(aa.a.nwa,td.bB);this.Wc.$(aa.a.owa,td.bB);this.Wc.$(aa.a.kIa,td.bB);this.Wc.$(aa.a.SIe,
td.bB);this.Wc.$(aa.a.kGb,td.bB);this.hb.$(aa.a.$$c,Object(C.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(aa.a.Y$c,Object(C.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(aa.a.Z$c,Object(C.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(aa.a.cad,Object(C.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(aa.a.IL,Object(C.a)(this,this.vkd,"transitionExecuteBridge"));this.hb.$(aa.a.ffd,Object(C.a)(this,this.vkd,
"transitionExecuteBridge"));this.Wc.$(aa.a.IL,td.bB);this.Wc.$(aa.a.efd,td.bB);this.Wc.$(aa.a.ffd,td.bB);this.Wc.$(aa.a.sHe,td.bB);this.Wc.$(aa.a.ifd,td.bB);this.Wc.$(aa.a.gfd,td.bB);this.Wc.$(aa.a.hfd,td.bB);this.Wc.$(aa.a.Gih,td.bB);this.Wc.$(aa.a.Hih,td.bB);this.Wc.$(aa.a.Iih,td.bB);this.Wc.$(aa.a.Jih,td.bB)}vwj(){this.hb.$(D.a.KDb,jg.mAe);this.hb.$(aa.a.y7g,jg.mAe);this.hb.$(aa.a.Kgc,td.K_);this.hb.$(aa.a.Lgc,td.K_);this.hb.$(aa.a.ebd,td.K_);this.hb.$(aa.a.iBe,td.K_);this.hb.$(aa.a.Hgc,td.K_);
this.hb.$(aa.a.Igc,td.K_);this.hb.$(aa.a.Jgc,td.K_);this.hb.$(aa.a.Ggc,td.K_);this.hb.$(aa.a.g$c,Object(C.a)(this,this.hcd,"remapTableExecute"));this.hb.$(D.a.Zaa,Object(C.a)(this,this.hcd,"remapTableExecute"));this.hb.$(D.a.Oic,Object(C.a)(this,this.hcd,"remapTableExecute"));this.hb.$(D.a.insertTable,Object(C.a)(this,this.hcd,"remapTableExecute"));this.Wc.$(D.a.insertTable,Object(C.a)(this,this.Eji,"checkInsertTableRibbonEnabledBridge"));this.Wc.$(D.a.Zaa,Object(C.a)(this,this.Eob,"checkWholeTableLockEnabledBridge"));
this.Wc.$(D.a.v1,Object(C.a)(this,this.Eob,"checkWholeTableLockEnabledBridge"));this.Wc.$(D.a.Mza,Object(C.a)(this,this.Eob,"checkWholeTableLockEnabledBridge"));this.Wc.$(aa.a.n4g,Object(C.a)(this,this.Eob,"checkWholeTableLockEnabledBridge"));this.Wc.$(aa.a.yva,Object(C.a)(this,this.Eob,"checkWholeTableLockEnabledBridge"));this.Wc.$(aa.a.fWa,Object(C.a)(this,this.Eob,"checkWholeTableLockEnabledBridge"));this.hb.$(D.a.v1,Object(C.a)(this,this.wNa,"checkSelectionBeforeExecute"));this.hb.$(D.a.Mza,Object(C.a)(this,
this.wNa,"checkSelectionBeforeExecute"));this.hb.$(D.a.Kob,Object(C.a)(this,this.wNa,"checkSelectionBeforeExecute"));this.hb.$(aa.a.ifc,Object(C.a)(this,this.wNa,"checkSelectionBeforeExecute"));this.hb.$(aa.a.hfc,Object(C.a)(this,this.wNa,"checkSelectionBeforeExecute"));this.hb.$(aa.a.gfc,Object(C.a)(this,this.wNa,"checkSelectionBeforeExecute"));this.hb.$(aa.a.yva,Object(C.a)(this,this.wNa,"checkSelectionBeforeExecute"));this.hb.$(aa.a.fWa,Object(C.a)(this,this.wNa,"checkSelectionBeforeExecute"));
this.hb.$(aa.a.$7g,td.jf);this.hb.$(aa.a.a8g,td.jf);this.hb.$(aa.a.b8g,td.jf);this.hb.$(aa.a.c8g,td.jf);this.hb.$(aa.a.d8g,td.jf);this.hb.$(aa.a.e8g,td.jf);this.hb.$(aa.a.f8g,td.jf);this.hb.$(aa.a.g8g,td.jf);this.hb.$(aa.a.h8g,td.jf);this.hb.$(aa.a.O7g,td.jf);this.hb.$(aa.a.P7g,td.jf);this.hb.$(aa.a.Q7g,td.jf);this.hb.$(aa.a.R7g,td.jf);this.hb.$(aa.a.S7g,td.jf);this.hb.$(aa.a.T7g,td.jf);this.hb.$(aa.a.U7g,td.jf);this.hb.$(aa.a.V7g,td.jf);this.hb.$(aa.a.W7g,td.jf);this.hb.$(aa.a.X7g,td.jf);this.hb.$(aa.a.Y7g,
td.jf);this.hb.$(aa.a.Z7g,td.jf);this.hb.$(aa.a.gBe,td.jf);this.hb.$(aa.a.fBe,td.jf);this.hb.$(aa.a.eBe,td.jf);this.hb.$(aa.a.hBe,td.jf)}Rvj(){this.Wc.$(aa.a.NAe,td.bB);this.hb.$(aa.a.NAe,td.jf);this.Wc.$(aa.a.Vog,td.sKk);this.hb.$(aa.a.ZQa,Object(C.a)(this,this.i9c,"parseSmartArtParametersBridge"));this.hb.$(aa.a.vUb,Object(C.a)(this,this.i9c,"parseSmartArtParametersBridge"));this.hb.$(aa.a.wCc,Object(C.a)(this,this.i9c,"parseSmartArtParametersBridge"));this.hb.$(aa.a.xCc,Object(C.a)(this,this.i9c,
"parseSmartArtParametersBridge"));this.Wc.$(aa.a.nAe,td.bB);this.hb.$(aa.a.nAe,td.jf);this.hb.$(aa.a.sNa,Object(C.a)(this,this.Fii,"changePictureStyleExecuteBridge"));this.hb.$(aa.a.bbd,td.jf);this.hb.$(aa.a.Rfc,td.K_);this.hb.$(aa.a.Tfc,td.K_);this.hb.$(aa.a.Sfc,td.K_);this.hb.$(aa.a.zad,td.K_)}Suj(){this.hb.$(aa.a.s7g,jg.mAe);this.hb.$(aa.a.dad,td.jf);this.hb.$(aa.a.Bad,td.jf);this.hb.$(aa.a.sad,td.jf);this.hb.$(aa.a.Jad,td.jf);this.hb.$(aa.a.Kad,td.jf);this.hb.$(aa.a.Iad,td.jf);this.hb.$(aa.a.Lad,
td.jf);this.hb.$(aa.a.dbd,td.jf);this.hb.$(aa.a.Aad,td.jf);this.hb.$(aa.a.pad,td.jf);this.hb.$(aa.a.kad,td.jf);this.hb.$(aa.a.Fad,td.jf)}qvj(){this.hb.$(aa.a.fad,td.jf);this.hb.$(aa.a.tad,td.jf);this.hb.$(aa.a.jgc,Object(C.a)(this,this.mad,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(aa.a.kgc,Object(C.a)(this,this.mad,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(aa.a.NDb,td.jf);this.hb.$(aa.a.MDb,td.jf);this.hb.$(aa.a.LDb,td.jf);this.hb.$(aa.a.XAe,td.jf);this.hb.$(aa.a.$Ak,td.jf);this.hb.$(aa.a.gbd,
td.Cad);this.hb.$(aa.a.fbd,td.Cad);this.hb.$(aa.a.SAe,td.Cad);this.hb.$(aa.a.uAe,td.Cad);this.la.yic?this.hb.$(aa.a.JDb,Object(C.a)(this,this.vKk,"remapRumTrackerExecuteQueryBridge")):this.hb.$(aa.a.JDb,jg.DDb);this.hb.$(aa.a.Pfc,td.jf);this.hb.$(aa.a.Gad,jg.DDb);this.hb.$(aa.a.m7g,td.jf);this.hb.$(aa.a.xad,td.jf);this.hb.$(aa.a.gad,td.jf);this.hb.$(aa.a.ogc,td.jf);this.hb.$(aa.a.cbd,td.jf);this.hb.$(aa.a.l8g,jg.DDb);this.hb.$(aa.a.$Ae,td.jf);this.hb.$(aa.a.ZAe,td.jf);this.hb.$(aa.a.F7g,td.jf);this.hb.$(aa.a.Agc,
td.jf);this.hb.$(aa.a.Dgc,td.jf);this.hb.$(aa.a.Egc,td.jf);this.hb.$(aa.a.Cgc,td.jf);this.hb.$(aa.a.Bgc,td.jf);this.hb.$(aa.a.mgc,td.jf);this.hb.$(aa.a.vgc,td.jf);this.hb.$(aa.a.ngc,td.jf);this.hb.$(G.a.Ifc,jg.DDb);this.Wc.$(aa.a.Nwe,td.bB);this.hb.$(aa.a.r3a,td.Ihd);this.hb.$(aa.a.uNa,td.Ihd);this.hb.$(aa.a.fTb,td.Ihd);this.hb.$(aa.a.zAc,td.Ihd);this.Wc.$(aa.a.g4f,td.xSi);this.hb.$(aa.a.VAe,td.rAk);this.Wc.$(aa.a.JAe,td.bB);this.hb.$(aa.a.JAe,td.jf);this.Wc.$(aa.a.y5a,Object(C.a)(this,this.Yv,"remapTextQueryEnabled"));
this.hb.$(aa.a.iHa,jg.DDb);this.hb.$(aa.a.B7g,td.jf);this.hb.$(aa.a.TAe,td.jf);this.hb.$(aa.a.t7g,td.jf);this.hb.$(aa.a.u7g,td.jf);this.hb.$(aa.a.Qgc,td.jf);this.hb.$(aa.a.W6g,td.jf);this.hb.$(D.a.cye,jg.q2b);this.hb.$(D.a.cut,Object(C.a)(this,this.CFc,"cutCopyPasteExecuteBridge"));this.hb.$(D.a.copy,Object(C.a)(this,this.CFc,"cutCopyPasteExecuteBridge"));this.hb.$(D.a.paste,Object(C.a)(this,this.CFc,"cutCopyPasteExecuteBridge"));this.hb.$(D.a.uva,Object(C.a)(this,this.CFc,"cutCopyPasteExecuteBridge"));
this.hb.$(D.a.openInClient,Object(C.a)(this,this.Rnk,"openInPowerPointExecuteBridge"));this.hb.$(D.a.lad,td.jf);this.hb.$(aa.a.nad,td.jf);this.hb.$(aa.a.s$c,Object(C.a)(this,this.xah,"remapUndoRedoExecute"));this.hb.$(aa.a.o$c,Object(C.a)(this,this.xah,"remapUndoRedoExecute"));this.hb.$(aa.a.Oec,Object(C.a)(this,this.gcd,"remapCutCopyPasteExecute"));this.hb.$(aa.a.Nec,Object(C.a)(this,this.gcd,"remapCutCopyPasteExecute"));this.hb.$(aa.a.dDb,Object(C.a)(this,this.gcd,"remapCutCopyPasteExecute"));this.hb.$(aa.a.l$c,
Object(C.a)(this,this.gcd,"remapCutCopyPasteExecute"));this.Wc.$(aa.a.s$c,Object(C.a)(this,this.wah,"remapUndoRedoEnabled"));this.Wc.$(aa.a.o$c,Object(C.a)(this,this.wah,"remapUndoRedoEnabled"));this.Wc.$(aa.a.Oec,Object(C.a)(this,this.$db,"remapCutCopyPasteEnabled"));this.Wc.$(aa.a.Nec,Object(C.a)(this,this.$db,"remapCutCopyPasteEnabled"));this.Wc.$(aa.a.dDb,Object(C.a)(this,this.$db,"remapCutCopyPasteEnabled"));this.Wc.$(aa.a.l$c,Object(C.a)(this,this.$db,"remapCutCopyPasteEnabled"));this.Wc.$(D.a.cut,
Object(C.a)(this,this.$db,"remapCutCopyPasteEnabled"));this.Wc.$(D.a.paste,Object(C.a)(this,this.$db,"remapCutCopyPasteEnabled"));this.Wc.$(D.a.uva,Object(C.a)(this,this.$db,"remapCutCopyPasteEnabled"));this.hb.$(D.a.T9,td.cGf);this.hb.$(D.a.Ms,td.cGf);this.hb.$(D.a.TQ,Object(C.a)(this,this.kzg,"listsExecuteBridge"));this.hb.$(D.a.UQ,Object(C.a)(this,this.kzg,"listsExecuteBridge"));this.hb.$(aa.a.KGb,td.h$k);this.hb.$(aa.a.BDb,td.K_);this.hb.$(aa.a.CDb,td.K_);this.hb.$(aa.a.Had,td.jf);this.hb.$(aa.a.iad,
td.jf);this.hb.$(aa.a.jad,td.jf);this.hb.$(aa.a.Ead,td.jf);this.la.QMa&&this.hb.$(aa.a.bad,td.jf)}$uj(){this.Wc.$(aa.a.Exj,Object(C.a)(this,this.vXb,"doPresentationCheckEnableRemap"));this.Wc.$(aa.a.Dii,Object(C.a)(this,this.vXb,"doPresentationCheckEnableRemap"));this.Wc.$(aa.a.uii,Object(C.a)(this,this.vXb,"doPresentationCheckEnableRemap"));this.Wc.$(aa.a.Kxj,Object(C.a)(this,this.vXb,"doPresentationCheckEnableRemap"));this.Wc.$(aa.a.Txj,Object(C.a)(this,this.vXb,"doPresentationCheckEnableRemap"))}vXb(a){const b=
new Qk;this.Pb&&1===this.Pb.Aw&&!td.E7d(a)?b.gK=!1:(b.nF=!0,b.Cm=aa.a.Vpb);return b}CZi(){const a=new cM;a.dTb=td.Juk;a.UHd=td.Kuk;a.Mye=Object(C.a)(this,this.nvk,"powerPointPreExecCommand");a.lye=null;return a}nvk(a,b){var c=this.sa.he();c=1===c.length&&c[0].rd&&this.sa.rG()&&!c[0].UP;switch(a.Cm){case D.a.font:case D.a.p4:case D.a.KHa:case D.a.bold:case D.a.setItalic:case D.a.underline:case D.a.strikethrough:case D.a.Ms:case D.a.T9:case D.a.aAa:case D.a.XH:case D.a.gJ:case D.a.dHa:case D.a.$Wa:case D.a.BE:case D.a.Qy:case D.a.TQ:case D.a.UQ:case D.a.Xga:case D.a.ija:case D.a.wma:case D.a.wBa:case aa.a.Ola:case aa.a.Ula:case aa.a.Tla:case aa.a.Sla:case D.a.lOa:case D.a.Mra:case D.a.Vwa:case D.a.Wwa:case D.a.Xwa:case D.a.MIa:case D.a.NIa:case D.a.Mza:case D.a.v1:case aa.a.yva:case aa.a.fWa:case aa.a.yfb:case aa.a.IXa:case aa.a.mwa:case aa.a.JXa:case aa.a.Mhd:case aa.a.Lhd:b||
(b={}),b[lh.a.Fyc]=!(this.sa.RRa()||c),b[lh.a.uzf]=!!this.sa.eia()}return null}czg(a,b,c){const f=new Wg;b=b.MenuItemId;f.od=this.Zqe(b,a);b&&za.a.J(512493027,820,50,"ListGallery Set on Shape from {0}",c.CommandLocation);return f}Zqe(a,b){a=a?parseInt(a):-1;switch(b){case aa.a.oGb:case D.a.TQ:case aa.a.jgc:case aa.a.rWa:return this.ezb.w0b(a);case aa.a.XFb:case D.a.UQ:case aa.a.kgc:case aa.a.sWa:return this.ezb.sNc(a);default:return 18}}YRi(a,b){a=new Wg;a.od=b.CommandValueId;return a}mad(a,b){const c=
new Wg,f=new xv;f.tWa=new Kh.a;f.menuItemId=this.Zqe(b.MenuItemId,a);c.od=f;c.MV=!0;return c}Eva(a,b){a=new Wg;const c={};c.queryResult=new Kh.a;const f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.od=c;a.MV=!0;return a}vkd(a,b){a=new Wg;const c={},f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.od=c;return a}Fii(a,b){a=new Wg;a.od=parseFloat(b[b.MenuItemId?
"MenuItemId":"SourceControlId"]);return a}Hdb(a){const b=new Wg,c={},f=new Kh.a;switch(a){case aa.a.e7g:f.Yf(this.zTa.isEnabled(Wd.GCa));break;case aa.a.Z6g:f.Yf(this.zTa.isEnabled(Wd.FCa));break;case aa.a.b7g:f.Yf(this.zTa.isEnabled(Wd.q7));break;case aa.a.$6g:f.Yf(this.zTa.isEnabled(Wd.p7));break;case aa.a.c7g:f.Yf(this.zTa.isEnabled(Wd.MB));break;case aa.a.d7g:f.Yf(this.zTa.isEnabled(Wd.VE));break;case aa.a.a7g:f.Yf(this.zTa.isEnabled(Wd.UE));break;case aa.a.mAk:f.Yf(this.zTa.isEnabled(Wd.zia))}c.queryResult=
f;b.od=c;b.MV=!0;return b}kzg(a,b,c){const f=new Wg;f.od=new H.DictionaryPropertySet;b=b.MenuItemId;this.osl(f.od,a,this.Zqe(b,a));b&&za.a.J(512493026,820,50,"ListGallery Set in Box4 View from {0}",c.CommandLocation);return f}Eji(){return Object.assign(new Qk,{od:new Kh.a,gK:!!this.EWj.Ca})}Eob(){const a=new Qk,b=this.sa.Mo();if(!b)return a;this.wc.g7d(b)&&(a.nF=!1,a.gK=!1,a.Cm=Le.ActionManager.VXb);return a}osl(a,b,c){let f=14,l=0;0===c?(f=16,l=0):b===D.a.TQ?(l=f=1,this.ezb.UQc(c)&&(b=this.ezb.nSa.ga(c),
a.setValue(ob.a.fm,[b.PTb]),a.setValue(ob.a.font,b.Tnb))):b===D.a.UQ&&(f=0,l=1,a.setValue(ob.a.qSa,1),a.setValue(zb.a.autonumberBulletType,8),this.ezb.VQc(c)&&(b=this.ezb.Y5c.ga(c),a.setValue(zb.a.autonumberBulletType,b.$Id),a.setValue(ob.a.fm,[65533,b.uUg,Ja.a.charCodeAt(b.AUg,0)])));a.setValue(Kd.a.aF,f);a.setValue(Kd.a.mja,l)}Rkd(a){let b;if(this.pnh()||this.sa.eia()){if(({ue:b}=td.Lkd(a,this.sa.jD())).returnValue)return{returnValue:!0,b4:b}}else if(this.c7k()&&({ue:b}=td.hxh(a)).returnValue)return{returnValue:!0,
b4:b};return{returnValue:!1,b4:0}}dRe(a){let b;b=0;a===aa.a.s$c?b=aa.a.Adb:a===aa.a.o$c&&(b=aa.a.zdb);return{returnValue:!!b,b4:b}}cRe(a){let b;b=0;this.pnh()?a===aa.a.Oec?b=D.a.cut:a===aa.a.Nec?b=D.a.copy:a===aa.a.dDb?b=D.a.paste:a===aa.a.l$c&&(b=D.a.uva):(a===aa.a.Oec&&(b=aa.a.Dpb),a===aa.a.Nec?b=aa.a.LVb:a===aa.a.dDb&&(b=aa.a.hec));return{returnValue:!!b,b4:b}}vxh(a){switch(a){case D.a.Zaa:return a=aa.a.WCb,{returnValue:!0,ue:a};case D.a.Oic:return a=aa.a.yye,{returnValue:!0,ue:a};case D.a.insertTable:return a=
aa.a.r4g,{returnValue:!0,ue:a}}a=Le.ActionManager.e4;return{returnValue:!1,ue:a}}Ks(a){let b=new Wg;if(({result:b}=this.Ttb(a)).returnValue)return b;({b4:a}=this.Rkd(a)).returnValue&&(b.nF=!0,b.Cm=a);return b}Lmh(a){switch(a){case aa.a.ZCb:case aa.a.Zec:case aa.a.bfc:case aa.a.aDb:case aa.a.fDb:case aa.a.cDb:if(this.sa.Uia()||this.sa.FK())return Object.assign(new Qk,{nF:!1,gK:!1});break;case aa.a.IDb:case aa.a.HDb:case aa.a.Yec:case aa.a.afc:case aa.a.YCb:if(this.sa.Uia())return Object.assign(new Qk,
{nF:!1,gK:!1});break;case aa.a.eWa:case aa.a.xva:case aa.a.w4g:case aa.a.VCb:case aa.a.bDb:case aa.a.eDb:case aa.a.$Cb:case aa.a.$ec:case aa.a.Pec:if(this.sa.FK())return Object.assign(new Qk,{nF:!1,gK:!1});break;case aa.a.cfc:case aa.a.r$c:if(this.sa.FK()){var b=this.sa.Pa.kb;if(b)for(let c of b)if(c&&c.node&&(b=c.node.ta(Sb.a.listLevel,0),a===aa.a.cfc&&!b||Uo.a.ssg(c.node)))return Object.assign(new Qk,{nF:!1,gK:!1})}}return null}Zr(a){let b;new Qk;if(({result:b}=this.a7d(a)).returnValue)return this.Kfd(b,
a);b=this.Lmh(a);if(!b){let c;b=new Qk;({b4:c}=this.Rkd(a)).returnValue&&(b.nF=!0,b.Cm=c)}return this.Kfd(b,a)}dma(a,b=null){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new Qk,{Wcb:a,Cm:aa.a.vFe,od:c})}vKk(a,b){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new Wg,{Cm:aa.a.vFe,od:c,MV:!0})}PD(a){let b=new Wg;if(({result:b}=this.Ttb(a)).returnValue)return b;({b4:a}=this.Rkd(a)).returnValue?(b.nF=!0,b.Cm=a):(b.od=new Kh.a,b.MV=!0);return b}Yv(a){let b;new Qk;
if(({result:b}=this.a7d(a)).returnValue)return this.Kfd(b,a);b=this.Lmh(a);if(!b){let c;b=new Qk;({b4:c}=this.Rkd(a)).returnValue?(b.nF=!0,b.Cm=c):b.od=new Kh.a}return this.Kfd(b,a)}xah(a){const b=new Wg;({b4:a}=this.dRe(a)).returnValue&&(b.nF=!0,b.Cm=a);return b}wah(a){const b=new Qk;({b4:a}=this.dRe(a)).returnValue&&(b.nF=!0,b.Cm=a);return b}tKk(){const a=new Qk;a.nF=!0;a.Cm=aa.a.tye;return a}uKk(){const a=new Wg;a.nF=!0;a.Cm=aa.a.tye;return a}gcd(a){let b=new Wg;if(({result:b}=this.Ttb(a)).returnValue)return b;
({b4:a}=this.cRe(a)).returnValue&&(b.nF=!0,b.Cm=a);return b}hcd(a){let b=new Wg;if(({result:b}=this.Ttb(a)).returnValue)return b;({ue:a}=this.vxh(a)).returnValue&&(b.nF=!0,b.Cm=a);return b}wNa(a,b){let c=new Wg;if(({result:c}=this.Ttb(a)).returnValue)return c;if(this.sa.hu())return c.nF=!0,c.Cm=Le.ActionManager.VXb,c;c.Cm=a;c.od=b;return c}$db(a){let b=new Qk;if(!this.Ub.wj())return b.gK=!1,b;if(({result:b}=this.a7d(a)).returnValue)return b;({b4:a}=this.cRe(a)).returnValue&&(b.nF=!0,b.Cm=a);return b}pnh(){return this.sa.jD()}c7k(){return this.sa.rG()}i9c(a,
b){const c=new Wg;if(!b)throw Error.argumentNull();b=b[b.MenuItemId?"MenuItemId":"SourceControlId"].split(",");b=Object.assign(new CQ.a,{Uri:b[0],Category:b[1]});const f=b.Uri;a!==aa.a.ZQa&&a!==aa.a.wCc||za.a.J(512493024,801,50,(a===aa.a.ZQa?"InsertSmartArt: ":"ChangeSmartArtLayout: ")+"{0}",f);c.od=b;return c}nUc(a,b,c){return this.Ks(a,b,c)}CFc(a){let b=new Wg;if(({result:b}=this.Ttb(a)).returnValue)return b;b.Aq=this.la.bRc||this.la.Mrg&&this.la.XCj&&r.a.Xn;return b}Rnk(a,b,c){a=new Wg;za.a.J(512493023,
801,50,"CuiActionBridge::OpenInPowerPointExecuteBridge - Open In PowerPoint from {0}",c.CommandLocation);return a}Ttb(a){let b;b=new Wg;return this.Qpg(a)?(b.nF=!1,b.gK=!1,b.Cm=Le.ActionManager.VXb,{returnValue:!0,result:b}):{returnValue:!1,result:b}}a7d(a){let b;b=new Qk;return this.Qpg(a)?(b.nF=!1,b.gK=!1,b.Cm=Le.ActionManager.VXb,{returnValue:!0,result:b}):{returnValue:!1,result:b}}Qpg(a){return this.nzj(a)}nzj(a){return this.la.podsTableCellLockEnabled&&this.la.podsTableRTTEnabled&&td.yei.contains(a)?
this.sa.E7()?!0:!1:!1}Kfd(a,b){if(qd.a("SetMappedCommandActionData")){let c=0;if(({ue:c}=td.Lkd(b,this.sa.jD())).returnValue||({ue:c}=td.hxh(b)).returnValue||({b4:c}=this.dRe(b)).returnValue||({b4:c}=this.cRe(b)).returnValue||({ue:c}=this.vxh(b)).returnValue)a.od||(a.od={}),a.od.MappedCommand=c}return a}static E7d(a){const b=td.ubj();let c=!1;for(const f of b)if(f===a){c=!0;break}return c}static ubj(){td.nac||(td.nac=[aa.a.s$c,aa.a.o$c,aa.a.dDb,aa.a.fdb,aa.a.gdb,aa.a.Nec,aa.a.deleteObject,aa.a.CXf,
aa.a.Vpb,aa.a.oGa,aa.a.gPc,aa.a.zyh,aa.a.YR,aa.a.r3a,aa.a.qad,aa.a.uNa,aa.a.GIe,aa.a.FIe,aa.a.N0g,aa.a.Gec,aa.a.Ogc,aa.a.jHa,aa.a.ODb,aa.a.Xda,aa.a.Fva,aa.a.nwa,aa.a.jGb,aa.a.kGb,aa.a.owa,aa.a.Xkc,aa.a.mYa,aa.a.hIb,aa.a.Agc,aa.a.nDb,aa.a.tfc,aa.a.G$c,aa.a.ngc,aa.a.ydb,aa.a.mgc,aa.a.vgc,aa.a.K7g,aa.a.Z9c,aa.a.$9c,aa.a.ekd,aa.a.Dgc,aa.a.fkd,aa.a.Egc,aa.a.dkd,aa.a.Cgc,aa.a.ckd,aa.a.Bgc,aa.a.pmc,aa.a.ogc,aa.a.cma,aa.a.dcd,aa.a.Qgc,aa.a.DBh,aa.a.xkg,G.a.Ymb,G.a.ead,aa.a.openInClient,G.a.yph,G.a.Cdc,G.a.yfc,
G.a.wkc,G.a.xkc,aa.a.Tfb,aa.a.ZXa,aa.a.M0g,aa.a.Pfc,aa.a.Iid,aa.a.Jid,D.a.cye,aa.a.ztk,aa.a.pla,aa.a.g4f,aa.a.YR,aa.a.LM,aa.a.JDe,aa.a.pbh,aa.a.FSg,aa.a.ESg,aa.a.NSe,aa.a.ymb,aa.a.immersiveReader,D.a.copy,D.a.paste,aa.a.Dpb,aa.a.LVb,aa.a.hec,aa.a.Adb,aa.a.zdb,aa.a.hmh,G.a.gPa,G.a.renameFile,aa.a.mDb,aa.a.g5g,aa.a.K9c,aa.a.H$c,aa.a.ecd]);td.nac.push(aa.a.egd);if(u.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")){const a=[aa.a.Y3g,aa.a.rad,aa.a.wQc];let b;(b=td.nac).push.apply(b,a)}return td.nac}static Kuk(a,
b){const c=a.Wcb;let f=!0,l=null;if(null===a||null===a.od)return!1;a=a.od;null!==a.queryResult&&(l=a.queryResult);if(null!==l&&null!==l.xea)switch(c){case aa.a.jHa:case aa.a.Kgc:case aa.a.Lgc:case aa.a.ebd:case aa.a.iBe:case aa.a.Hgc:case aa.a.Igc:case aa.a.Jgc:case aa.a.Ggc:case aa.a.Rfc:case aa.a.Tfc:case aa.a.Sfc:case aa.a.zad:case aa.a.BDb:case aa.a.CDb:a=parseFloat(l.xea);0<a||c===aa.a.jHa||c===aa.a.Rfc||c===aa.a.Tfc||c===aa.a.Sfc||c===aa.a.zad||c===aa.a.BDb||c===aa.a.CDb||0<=a&&(c===aa.a.Hgc||
c===aa.a.Igc||c===aa.a.Jgc||c===aa.a.Ggc)?(b[gn.Text]=l.xea,b[gn.Number]=a):(b[gn.Text]="",b[gn.Number]=Number.NaN);b[gn.UnitType]=c===aa.a.jHa?8:3;break;default:f=!1}return f}static Juk(a,b){if(jg.dTb(a,b))return!0;if(!a||!a.od)return!1;var c=null;Object(Ca.a)(Kh.a,a.od)?c=a.od:Object(Ca.a)(xv,a.od)?(c=a.od,b.SourceControlId=c.OT,c=c.tWa):Object(Ca.a)(Object,a.od)&&(a=a.od,a.queryResult&&(c=a.queryResult));c&&(b[Uh.a.On]=c.Xjd?c.Xjd.value:!1,c.ADc&&(b[lo.a.IsFreeForm]=c.ADc.value),c.xBa&&(b[cm.a.InnerHTML]=
c.xBa),c.krb&&(b[cm.a.Alt]=c.krb),c.$Jc&&(b[cm.a.On]=c.$Jc.value),void 0!==c.J1&&null!==c.J1&&(b[lo.a.Value]=c.J1),void 0!==c.vBc&&null!==c.vBc&&(b[fE.a.LabelText]=c.vBc),c.T6&&(b[cm.a.GalleryButtonProps]=c.T6),c.GIf&&(b[fE.a.Image32by32Class]=c.GIf),void 0!==c.AZb&&null!==c.AZb&&(b[tm.a.labelText]=c.AZb));return!0}static bB(){const a=new Qk;a.od=new Kh.a;return a}static jf(){const a=new Wg;a.od=new Kh.a;a.MV=!0;return a}static bzg(a,b,c){za.a.J(512493021,820,50,"ListGallery Dropdown from {0}",c.CommandLocation);
a=new Wg;a.od=b;return a}static UNe(a,b){a=new Wg;a.od=b.Color;return a}static cGf(a,b){a=new Wg;a.od=b.Color;a.Aq=!0;return a}static h$k(){const a=new Wg;a.od={InvokeSource:0,ShowRevisionTrackingStatus:1};return a}static Cad(a,b){a=new Wg;const c=new xv;c.tWa=new Kh.a;c.OT=b.SourceControlId;a.od=c;a.MV=!0;return a}static Ihd(a,b){a=new Wg;a.od=b.SourceControlId;return a}static K_(){const a=new Wg,b={},c=new Kh.a;b.queryResult=c;a.od=b;a.Y9d=!0;return a}static OXa(a){const b=new Qk;switch(a){case aa.a.iFf:b.Cm=
aa.a.eTb;break;case aa.a.jFf:b.Cm=aa.a.jnb;break;case aa.a.THd:b.Cm=aa.a.EAc;break;case aa.a.PHd:b.Cm=aa.a.CAc;break;case aa.a.SHd:b.Cm=aa.a.RHd;break;case aa.a.QHd:b.Cm=aa.a.DAc;break;case aa.a.kFf:b.Cm=aa.a.fTb;break;case aa.a.$Ef:b.Cm=aa.a.zAc}return b}static xSi(){const a=new Qk;a.Cm=aa.a.x5a;return a}static rAk(){const a=new Wg,b={},c=new Kh.a;c.Yf(!1);b.queryResult=c;a.od=b;a.MV=!0;return a}static Lkd(a,b){switch(a){case aa.a.Lec:return a=D.a.bold,{returnValue:!0,ue:a};case aa.a.VCb:return a=
D.a.Xga,{returnValue:!0,ue:a};case aa.a.YCb:return a=D.a.font,{returnValue:!0,ue:a};case aa.a.Yec:return a=D.a.p4,{returnValue:!0,ue:a};case aa.a.afc:return a=D.a.KHa,{returnValue:!0,ue:a};case aa.a.XCb:return a=D.a.Ms,{returnValue:!0,ue:a};case aa.a.Qec:return a=D.a.T9,{returnValue:!0,ue:a};case aa.a.Mec:return a=D.a.aAa,{returnValue:!0,ue:a};case aa.a.Sec:return a=D.a.setItalic,{returnValue:!0,ue:a};case aa.a.bDb:return a=D.a.ija,{returnValue:!0,ue:a};case aa.a.Uec:return a=aa.a.Nwe,{returnValue:!0,
ue:a};case aa.a.Vec:return a=D.a.SCb,{returnValue:!0,ue:a};case aa.a.ZCb:return a=D.a.rr,{returnValue:!0,ue:a};case aa.a.Zec:return a=D.a.dHa,{returnValue:!0,ue:a};case aa.a.bfc:return a=D.a.$Wa,{returnValue:!0,ue:a};case aa.a.fDb:return a=D.a.gJ,{returnValue:!0,ue:a};case aa.a.aDb:return a=D.a.XH,{returnValue:!0,ue:a};case aa.a.dfc:return a=D.a.strikethrough,{returnValue:!0,ue:a};case aa.a.Wec:return a=aa.a.E1g,{returnValue:!0,ue:a};case aa.a.Xec:return a=aa.a.YGa,{returnValue:!0,ue:a};case aa.a.eDb:return a=
D.a.wma,{returnValue:!0,ue:a};case aa.a.$Cb:return a=D.a.wBa,{returnValue:!0,ue:a};case aa.a.jfc:return a=D.a.underline,{returnValue:!0,ue:a};case aa.a.$ec:return a=D.a.Qy,{returnValue:!0,ue:a};case aa.a.Pec:return a=D.a.BE,{returnValue:!0,ue:a};case aa.a.cfc:return a=D.a.Qy,{returnValue:!0,ue:a};case aa.a.r$c:return a=D.a.BE,{returnValue:!0,ue:a};case aa.a.xva:return a=D.a.TQ,{returnValue:!0,ue:a};case aa.a.eWa:return a=D.a.UQ,{returnValue:!0,ue:a};case aa.a.Tec:return a=aa.a.Ola,{returnValue:!0,
ue:a};case aa.a.cDb:return a=aa.a.tbe,{returnValue:!0,ue:a};case aa.a.y5a:return a=D.a.JJc,{returnValue:!0,ue:a};case aa.a.efc:return a=D.a.subscript,{returnValue:!0,ue:a};case aa.a.ffc:return a=D.a.superscript,{returnValue:!0,ue:a}}return b?td.Fnl(a):td.gxh(a)}static hxh(a){switch(a){case aa.a.Lec:return a=aa.a.FXa,{returnValue:!0,ue:a};case aa.a.VCb:return a=aa.a.pGb,{returnValue:!0,ue:a};case aa.a.YCb:return a=aa.a.tfb,{returnValue:!0,ue:a};case aa.a.ZCb:return a=aa.a.ufb,{returnValue:!0,ue:a};
case aa.a.Sec:return a=aa.a.GXa,{returnValue:!0,ue:a};case aa.a.bDb:return a=aa.a.vfb,{returnValue:!0,ue:a};case aa.a.eDb:return a=aa.a.Ifb,{returnValue:!0,ue:a};case aa.a.$Cb:return a=aa.a.WFb,{returnValue:!0,ue:a};case aa.a.jfc:return a=aa.a.HXa,{returnValue:!0,ue:a};case aa.a.xva:return a=aa.a.oGb,{returnValue:!0,ue:a};case aa.a.e$c:return a=aa.a.Ojc,{returnValue:!0,ue:a};case aa.a.f$c:return a=aa.a.zgd,{returnValue:!0,ue:a};case aa.a.XCb:return a=aa.a.VFb,{returnValue:!0,ue:a};case aa.a.Qec:return a=
aa.a.Ffb,{returnValue:!0,ue:a};case aa.a.Mec:return a=aa.a.qGb,{returnValue:!0,ue:a};case aa.a.eWa:return a=aa.a.XFb,{returnValue:!0,ue:a};case aa.a.Vec:return a=aa.a.wJe,{returnValue:!0,ue:a};case aa.a.fDb:return a=aa.a.sGb,{returnValue:!0,ue:a};case aa.a.aDb:return a=aa.a.Pjc,{returnValue:!0,ue:a};case aa.a.dfc:return a=aa.a.YFb,{returnValue:!0,ue:a};case aa.a.Ula:return a=aa.a.bgd,{returnValue:!0,ue:a};case aa.a.Tla:return a=aa.a.agd,{returnValue:!0,ue:a};case aa.a.Sla:return a=aa.a.$fd,{returnValue:!0,
ue:a};case aa.a.Wec:case aa.a.Uec:return td.Lkd(a,!0);case aa.a.Xec:return td.Lkd(a,!0);case aa.a.Tec:return a=aa.a.Zfd,{returnValue:!0,ue:a};case aa.a.cDb:return a=aa.a.uJe,{returnValue:!0,ue:a};case aa.a.efc:return a=aa.a.Sjc,{returnValue:!0,ue:a};case aa.a.ffc:return a=aa.a.Tjc,{returnValue:!0,ue:a}}return td.gxh(a)}static Fnl(a){switch(a){case aa.a.Vfc:return a=D.a.Jfc,{returnValue:!0,ue:a};case aa.a.Xfc:return a=D.a.Lfc,{returnValue:!0,ue:a};case aa.a.agc:return a=D.a.Ofc,{returnValue:!0,ue:a};
case aa.a.IDb:return a=G.a.Ymb,{returnValue:!0,ue:a};case aa.a.HDb:return a=G.a.Ymb,{returnValue:!0,ue:a};case aa.a.Yfc:return a=D.a.had,{returnValue:!0,ue:a};case aa.a.Zfc:return a=D.a.Mfc,{returnValue:!0,ue:a};case aa.a.bgc:return a=D.a.Qfc,{returnValue:!0,ue:a};case aa.a.egc:return a=D.a.pgc,{returnValue:!0,ue:a};case aa.a.$fc:return a=D.a.Nfc,{returnValue:!0,ue:a};case aa.a.igc:return a=aa.a.NDb,{returnValue:!0,ue:a};case aa.a.hgc:return a=aa.a.MDb,{returnValue:!0,ue:a};case aa.a.ggc:return a=
aa.a.LDb,{returnValue:!0,ue:a};case aa.a.lgc:return a=D.a.Pgc,{returnValue:!0,ue:a};case aa.a.Wfc:return a=aa.a.fad,{returnValue:!0,ue:a};case aa.a.dgc:return a=aa.a.tad,{returnValue:!0,ue:a};case aa.a.hHa:return a=aa.a.jgc,{returnValue:!0,ue:a};case aa.a.Jdb:return a=aa.a.kgc,{returnValue:!0,ue:a};case aa.a.fgc:return a=D.a.xgc,{returnValue:!0,ue:a};case aa.a.cgc:return a=aa.a.qWa,{returnValue:!0,ue:a};case aa.a.Kdb:return a=D.a.zgc,{returnValue:!0,ue:a};case aa.a.Ldb:return a=D.a.Fgc,{returnValue:!0,
ue:a}}a=Le.ActionManager.e4;return{returnValue:!1,ue:a}}static gxh(a){switch(a){case aa.a.Vfc:return a=aa.a.rgc,{returnValue:!0,ue:a};case aa.a.Xfc:return a=aa.a.Oad,{returnValue:!0,ue:a};case aa.a.agc:return a=aa.a.sgc,{returnValue:!0,ue:a};case aa.a.Yfc:return a=aa.a.Rad,{returnValue:!0,ue:a};case aa.a.Zfc:return a=aa.a.Sad,{returnValue:!0,ue:a};case aa.a.bgc:return a=aa.a.Uad,{returnValue:!0,ue:a};case aa.a.egc:return a=aa.a.Wad,{returnValue:!0,ue:a};case aa.a.$fc:return a=aa.a.Tad,{returnValue:!0,
ue:a};case aa.a.igc:return a=aa.a.abd,{returnValue:!0,ue:a};case aa.a.hgc:return a=aa.a.$ad,{returnValue:!0,ue:a};case aa.a.ggc:return a=aa.a.Zad,{returnValue:!0,ue:a};case aa.a.lgc:return a=aa.a.ugc,{returnValue:!0,ue:a};case aa.a.Wfc:return a=aa.a.Odb,{returnValue:!0,ue:a};case aa.a.IDb:return a=aa.a.Qad,{returnValue:!0,ue:a};case aa.a.HDb:return a=aa.a.Pad,{returnValue:!0,ue:a};case aa.a.dgc:return a=aa.a.Pdb,{returnValue:!0,ue:a};case aa.a.hHa:return a=aa.a.rWa,{returnValue:!0,ue:a};case aa.a.Jdb:return a=
aa.a.sWa,{returnValue:!0,ue:a};case aa.a.fgc:return a=aa.a.tgc,{returnValue:!0,ue:a};case aa.a.cgc:return a=aa.a.Vad,{returnValue:!0,ue:a};case aa.a.Kdb:return a=aa.a.Xad,{returnValue:!0,ue:a};case aa.a.Ldb:return a=aa.a.Yad,{returnValue:!0,ue:a}}a=Le.ActionManager.e4;return{returnValue:!1,ue:a}}static sKk(a){const b=new Qk;switch(a){case aa.a.Vog:b.Cm=aa.a.ZQa}return b}static Uyg(a,b){a=new Wg;if(!b)throw Error.argumentNull();a.od=td.u$f(b.MenuItemId);return a}static j7g(a,b){a=new Wg;const c={},
f=new Kh.a;f.Yf(!1);c.queryResult=f;c.MenuItemId=td.u$f(b.MenuItemId);c.LineSpacingValue=-1;c.LineSpacingUnit=0;a.od=c;a.MV=!0;a.X9d=!0;return a}static u$f(a){return parseFloat(a)}}td.nac=null;td.yei=(Ye=new Ua.a,Ye.add(D.a.cut),Ye.add(D.a.paste),Ye.add(D.a.uva),Ye.add(D.a.Zaa),Ye.add(D.a.T9),Ye.add(D.a.FMd),Ye.add(D.a.aAa),Ye.add(D.a.p4),Ye.add(D.a.KHa),Ye.add(D.a.dHa),Ye.add(D.a.$Wa),Ye.add(aa.a.Vfc),Ye.add(aa.a.agc),Ye.add(aa.a.lgc),Ye.add(aa.a.Xfc),Ye.add(aa.a.bgc),Ye.add(aa.a.egc),Ye.add(aa.a.$fc),
Ye.add(aa.a.igc),Ye.add(aa.a.hgc),Ye.add(aa.a.ggc),Ye.add(aa.a.Yfc),Ye.add(aa.a.Zfc),Ye.add(aa.a.Wfc),Ye.add(aa.a.dgc),Ye.add(aa.a.hHa),Ye.add(aa.a.Jdb),Ye.add(aa.a.IDb),Ye.add(aa.a.HDb),Ye.add(aa.a.fgc),Ye.add(aa.a.cgc),Ye.add(aa.a.Kdb),Ye.add(aa.a.Ldb),Ye.add(aa.a.v7g),Ye.add(aa.a.x7g),Ye.add(aa.a.w7g),Ye.add(aa.a.LAe),Ye.add(aa.a.KAe),Ye.add(aa.a.Lec),Ye.add(aa.a.Sec),Ye.add(aa.a.jfc),Ye.add(aa.a.VCb),Ye.add(aa.a.bDb),Ye.add(aa.a.eDb),Ye.add(aa.a.$Cb),Ye.add(aa.a.Qec),Ye.add(aa.a.Mec),Ye.add(aa.a.YCb),
Ye.add(aa.a.Yec),Ye.add(aa.a.afc),Ye.add(aa.a.ZCb),Ye.add(aa.a.Zec),Ye.add(aa.a.bfc),Ye.add(aa.a.fDb),Ye.add(aa.a.aDb),Ye.add(aa.a.Ula),Ye.add(aa.a.Tla),Ye.add(aa.a.Sla),Ye.add(aa.a.dfc),Ye.add(aa.a.Uec),Ye.add(aa.a.Vec),Ye.add(aa.a.Wec),Ye.add(aa.a.Xec),Ye.add(aa.a.m$c),Ye.add(aa.a.n$c),Ye.add(aa.a.xva),Ye.add(aa.a.eWa),Ye.add(aa.a.oGb),Ye.add(aa.a.Ffb),Ye.add(aa.a.qGb),Ye.add(aa.a.XFb),Ye.add(aa.a.e$c),Ye.add(aa.a.f$c),Ye.add(aa.a.XCb),Ye.add(aa.a.Pec),Ye.add(aa.a.$ec),Ye.add(aa.a.insertHyperlink),
Ye.add(aa.a.Tec),Ye.add(aa.a.cDb),Ye.add(aa.a.efc),Ye.add(aa.a.ffc),Ye.add(aa.a.Oec),Ye.add(aa.a.dDb),Ye.add(aa.a.l$c),Ye.add(aa.a.WCb),Ye.add(aa.a.rye),Ye.add(aa.a.g$c),Ye.add(aa.a.ifc),Ye.add(aa.a.hfc),Ye.add(aa.a.gfc),Ye);Object(e.a)(td,"CuiActionBridge",jg,[]);class jE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UI"}Yb(a){this.K=a;this.K.register(199,"Box4.ISelectionContextMenuProvider").ma().na(()=>new xq);let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").Iub;
r.a.Gj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").rwa);this.K.register(Oz,"PowerPointWebEditor.EditSurfaceContextMenu").as("Box4.UI.AEditSurfaceContextMenu").ma().na(()=>new Oz(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.UI.IProofingContextMenuSectionFactory"),this.K.resolve("PowerPointWebEditor.IContextMenuHelper"),this.K.resolve("Box4.ISelectionManager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),
this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),this.K.Oa("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),b));a.register(200,"PowerPointWebEditor.ICUIManager").ma().na(()=>new bM(a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),
a.resolve("PowerPointWebEditor.IContextMenuUser"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.CuiActionBridge"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IRibbonExternal")));a.register(td,"PowerPointWebEditor.CuiActionBridge").as("Box4.UI.CuiActionBridge").ma().na(()=>new td(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IInkRibbonManager")));const c=this.K.resolve("PowerPointWebEditor.IApplicationSettings").yic;this.K.register(201,"PowerPointWebEditor.IStatusBarUserHelper").ma().na(()=>new $L(a.resolve("PowerPointWebEditor.IApplicationSettings")));
a.register(202,"PowerPointWebEditor.IStatusBarUser").ma().na(()=>new cE(a.resolve("PowerPointWebEditor.IStatusBarPane").za,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.Graph.IGraphInstance").Cd(7),a.qb("PowerPointWebEditor.Core.IBundleMetricRecorder"),c?this.K.resolve("PowerPointWebEditor.IPPTRumTracker"):null,a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("PowerPointWebEditor.IStatusBarUserHelper"),a.resolve("Common.IAppSettingsManager"),a.resolve("Common.IAppSettingsManager").getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.BuildStatusOnFullAppSettingsReadyImmediately",
!1)));a.register(Uw,"CommandUI.ReactRibbonRoot").ma().na(()=>new Uw(Lr.instance,a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("Box4.IGeneralCuiUser")));a.register(203,"PowerPointWebEditor.IContextMenuUser").ma().na(()=>new XL(a.resolve("Box4.IContextMenuController"),Object(ua.a)(Oz,a.resolve("Box4.UI.AEditSurfaceContextMenu"))));a.register(204,"Box4.IBox4BridgeCommandUi").ma().na(()=>new aM(a.resolve("Box4.IGeneralCuiUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("Common.IActionManager"),
a.resolve("Common.IRibbonExternal")));this.K.register(205,"PowerPointWebEditor.IContextMenuHelper").ma().na(()=>new VL(a.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(bE,"Box4.UI.EditorServiceProofingContextMenuCreator").ma().na(()=>new bE(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),a.qb("Box4.Proofing.IIgnoreAllKeywords"),"pegal",a.resolve("PowerPoint.IPathManager").rk("pegal.png"),!1,a.resolve("Box4.IFormattingReader")))}init(){this.K.resolve("PowerPointWebEditor.ActionCommandsRumTrackerReporter");
this.K.resolve("PowerPointWebEditor.CuiActionBridge").initialize();this.K.resolve("PowerPointWebEditor.ICUIManager").initialize();this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").rai(this.K.resolve("Box4.IBox4BridgeCommandUi"))}dispose(){this.K.resolve("PowerPointWebEditor.ICUIManager").dispose();this.K.resolve("PowerPointWebEditor.IStatusBarUser").dispose();this.K.resolve("PowerPointWebEditor.IContextMenuUser").dispose()}static main(){m.a.instance.Ec(new jE)}}Object(e.a)(jE,"PPTWebEditorUIPackage",
null,[2,3]);class dM{constructor(a){this.GHh="FontPicker";this.Jud=null;this.K0=a;this.Vqc=this.K0.Xdb(Kr.a.iSa,Object(C.a)(this,this.Mqb,"featureStateChangeCallback"));this.K0.isFeatureEnabled(Kr.a.iSa,!1).then(b=>{this.Jud=b})}get isLicensed(){return this.Jud}Mqb(a){this.Jud=a.isEnabled;a=appChrome.actions.updateFontPickerLicenseState(this.GHh,a.isEnabled);appChrome.api.dispatch(a)}dispose(){this.K0.fEb(Kr.a.iSa,this.Vqc)}}Object(e.a)(dM,"ModernFontPickerFeatureHelper",null,[194,109]);class Pz{constructor(a){this.uFa=
null;a?Object.getType(a)===String?this.uFa=Pz.deserialize(a):this.uFa=a:(Z.ULS.sendTraceTag(543475146,3021,10,"Failed to populate pinned fonts."),this.uFa=[]);this.FEa=!1}get isDirty(){return this.FEa}get I9c(){return Array.clone(this.uFa)}$Yh(a){Array.contains(this.uFa,a)||(Array.add(this.uFa,a),this.FEa=!0)}gLk(a){Array.contains(this.uFa,a)&&(Array.remove(this.uFa,a),this.FEa=!0)}serialize(){return JSON.stringify(this.uFa)}SQk(){this.FEa=!1}static deserialize(a){try{return JSON.parse(a)}catch(b){return Z.ULS.sendTraceTag(543475147,
3021,10,"Deserialize failed: {0}",b.toString()),[]}}}Object(e.a)(Pz,"PinnedFontStore",null,[]);class eM{constructor(a,b,c,f){this.ia=a;this.la=c;this.ZMg=b;this.Bb=f;this.z3=null}initialize(){this.ia.ya(G.a.qec,de.a.frame,Object(C.a)(this,this.qec,"pinOrUnpinFont"));this.ia.ra(G.a.P3f,de.a.frame,Object(C.a)(this,this.CXg,"onFontPickerMenuClose"),96);this.ZMg.F1d("getPPTPinnedFontsSettings").continueWith(Object(C.a)(this,this.Skk,"onRoamingSettingLoaded"))}cKj(a){return a.yn?!1:a.Sl?(Z.ULS.sendTraceTag(543273993,
3021,10,"Load setting failed with exception {0}",a.Ti),!1):!0}Skk(a){this.cKj(a)?this.z3=new Pz(a.result||this.qbg()):this.z3=new Pz(this.qbg());this.O6g()}O6g(){appChrome.api.dispatch(appChrome.actions.updatePinnedFonts("FontPicker",this.I9c))}get I9c(){return this.z3?this.z3.I9c:[]}qbg(){return this.la.Ia("RecommendedFonts")}qec(a,b,c,f,l){if(!this.z3)return Z.ULS.sendTraceTag(543475150,3021,50,"Roaming setting is not available yet"),64;(a=l.CommandValueId)&&(l.IsPinned?this.z3.$Yh(a):this.z3.gLk(a));
return 32}CXg(){if(!this.z3||!this.z3.isDirty)return 32;const a=Se.a.ZEc(10,Object(C.a)(this,this.updatePinnedFonts,"updatePinnedFonts"));this.Bb.Hb(a);return 32}updatePinnedFonts(){this.z3&&(this.O6g(),this.Egh(),this.z3.SQk())}Egh(){if(this.z3&&this.z3.isDirty){var a=this.z3.serialize();this.ZMg.a4k(a)}}dispose(){this.Egh();this.ia.gO(G.a.qec,de.a.frame,Object(C.a)(this,this.qec,"pinOrUnpinFont"));this.ia.gO(G.a.P3f,de.a.frame,Object(C.a)(this,this.CXg,"onFontPickerMenuClose"))}}Object(e.a)(eM,
"FontPinningHandler",null,[195,109]);class yq{static get sCb(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}yq.rBa="fontInfoTaskPane";yq.cMi="modernfontpicker";Object(e.a)(yq,"FontInfoPaneConstants",null,[]);class fM{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(e.a)(fM,"FontInfoTaskPaneProps",null,[]);var bu=d(634);class Qz{constructor(a,b,c,f=null){this.Y1a=
this.uU=this.Vqc=null;this._state=this.lkb=0;this.QNh=a;this.K0=b;this.zGh=c;this.Kd=f}get Ho(){return this.QNh.value}initialize(){this.Ho.ya(G.a.pEe,de.a.frame,Object(C.a)(this,this.pEe,"requestFontInfo"));this.Vqc=this.K0.Xdb(Kr.a.iSa,Object(C.a)(this,this.Mqb,"featureStateChangeCallback"));this.Dfb()}kn(a=!1){const b=lj.UISurfaces.du(),c=this.K0.isFeatureEnabled(Kr.a.iSa,!1),f=[];f.push(b);f.push(c);Promise.all(f).then(l=>{l[0].showTaskPane(yq.rBa,this.gqa(l[1]));a&&this.xr()})}yAh(a){lj.UISurfaces.du().then(b=>
{b.updateTaskPane(yq.rBa,this.gqa(a));return null})}Mqb(a){this.yAh(a.isEnabled)}pEe(a,b,c,f,l){this.uU=l.CommandValueId;this.Y1a=l.Trigger;this.lkb=l.InputMethod;this.kn(2===this._state&&1===this.lkb);return 32}gqa(a){const b=new fM;b.onUpsellButtonClicked=Object(C.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");b.fontName=this.uU;b.isLicensed=a;b.trigger=this.Y1a;b.helpArticleUrl=this.cri();b.paneId=yq.rBa;a=this.wuj();a.contentProps=b;return a}wuj(){return Object.assign(new bu.a,{title:yq.sCb,
hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(C.a)(this,this.onOpen,"onOpen"),onClose:Object(C.a)(this,this.onClose,"onClose"),onShow:Object(C.a)(this,this.onShow,"onShow"),onHide:Object(C.a)(this,this.onHide,"onHide")})}Dfb(){if(this.Kd){var a=this.Kd.Bc(yq.rBa);a.parent=y.AFrame.kj;a.HK=!0}}onOpen(){this._state=2;this.xr()}onShow(a){0!==this._state&&(this._state=2,1===a&&(this.lkb=a),this.xr())}onClose(){this.lkb=this._state=
0;this.blur()}onHide(){this._state=1;this.lkb=0}xr(){this.Kd&&1===this.lkb&&this.Kd.vf(yq.rBa)}blur(){this.Kd&&this.Kd.ye&&this.Kd.ye.name===yq.rBa&&this.Kd.vf(this.Kd.H6)}onUpsellButtonClicked(){this.K0.launchUpsellExperience(yq.cMi)}dispose(){this.K0.fEb(Kr.a.iSa,this.Vqc)}cri(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.zGh,this.j2i(),"PPWAENDUSER",u.AFrameworkApplication.lcid)}j2i(){switch(this.Y1a){case "missing":return"hlpFontInfoMissingFont";
case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Qz.Xbi(this.uU)}static Xbi(a){let b="hlpFontInfo";for(let c=0;c<a.length;++c){const f=Ja.a.charAt(a,c);if(255<a.charCodeAt(c)||Ja.a.dqg(f))b+=f}return b}}Object(e.a)(Qz,"FontInfoPane",null,[196,109]);class gM extends Qz{constructor(a,b,c,f){super(a,b,c.Ia("FontInfoHelpBaseUrl"),f);this.la=c}Mqb(a){this.yAh(a.isEnabled)}}Object(e.a)(gM,"PPTFontInfoPane",
Qz,[]);class kE{constructor(){this.q0c=this.R7b=this.S7b=this.K=null}get name(){return"PowerPointWebEditor.ModernFontPicker"}Yb(a){this.K=a;this.K.register(194,"Common.ModernFontPicker.IModernFontPickerFeatureHelper").ma().na(()=>new dM(this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(195,"Box4.IFontPinningStore").ma().na(()=>new eM(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IRoamingServiceRequestManager"),this.K.resolve("Common.IAppSettingsManager"),
this.K.resolve("Common.ITaskManager")));this.K.register(196,"Common.ModernFontPicker.IFontInfoPane").ma().na(()=>new gM(new sc.a(()=>u.AFrameworkApplication.Va),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.IFocusManager")))}init(){const a=this.K.resolve("Common.IAppSettingsManager");a.gf(()=>{this.K.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{a.ka("PPTOModernFontPickerIsEnabled")&&
(this.q0c=this.K.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper"),this.R7b=this.K.resolve("Common.ModernFontPicker.IFontInfoPane"),this.R7b.initialize(),b.isFeatureEnabled(Kr.a.iSa,!1).then(c=>{!u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&c&&(this.S7b=this.K.resolve("Box4.IFontPinningStore"),this.S7b.initialize())}),gb.App.Fb.updateCommandUI())})})}dispose(){this.R7b&&(this.R7b.dispose(),this.R7b=null);this.S7b&&(this.S7b.dispose(),this.S7b=null);this.q0c&&(this.q0c.dispose(),
this.q0c=null)}static main(){m.a.instance.Ec(new kE)}}Object(e.a)(kE,"PPTModernFontPickerPackage",null,[2,3]);var lE=d(1036);class hM{constructor(a){this.X8=a;this.xbb=this.X8.KAb("UserAction","ImageProcessor");this.qXj=67}pzg(a,b){if(b)if(a&&this.cNj){let c=new Image;c.onload=()=>{b(c);URL.revokeObjectURL(c.src);c=null};(a=URL.createObjectURL(a))?c.src=a:b(null)}else b(null)}Dph(a,b,c){c-=this.qXj;if(0>=c||!a)return null;let f=a.width,l=a.height;if(0>=f||0>=l)return null;let w=null,F=1,S=0;try{const fa=
Math.ceil(1.37*b);if(c<=fa){const xa=Math.sqrt(c/(1.3*fa));f=Math.floor(a.width*xa);l=Math.floor(a.height*xa)}if(w=this.RWf(a,f,l))if(S=w.length,w.length>=c){const xa=this.Lcg(a.width,a.height);xa*Math.floor(a.width)*xa*Math.floor(a.height)>=f*l?w=null:(F++,(w=this.Ual(a))&&w.length>=c&&(w=null))}}catch(fa){w=null,Z.ULS.sendTraceTag(20841025,826,15,"ShrinkImageBySize failed. Error message: "+fa.message+", Call stack: "+fa.stack)}a=String.format("ShrinkImageBySize: BlobSize={0},numTry={1},Base64AfterFirstShrink={2},FinalBase64Length={3}",
b,F,S,w?w.length:0);Z.ULS.sendTraceTag(20841026,826,50,a);return w}Ual(a){let b=null;if(a){let c=a.width,f=a.height;const l=this.Lcg(c,f);c=Math.floor(c*l);f=Math.floor(f*l);try{b=this.RWf(a,c,f)}catch(w){Z.ULS.sendTraceTag(20841027,826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+w.message+", Call stack: "+w.stack)}}return b}RWf(a,b,c){if(0>=b||0>=c)return null;let f;this.xbb.start();var l=document.createElement("canvas");l.width=b;l.height=c;var w=l.getContext("2d");f=this.xbb.vq;w.drawImage(a,
0,0,b,c);w=this.xbb.vq-f;l=l.toDataURL("image/png");a=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",a.width,a.height,b,c,f,w,this.xbb.vq-(f+w));Z.ULS.sendTraceTag(20841028,813,50,a);return l}Lcg(a,b){return 0>=a||0>=b?0:1280<a||1280<b?Math.min(1280/a,1280/b):1}get cNj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}get URL(){return window.URL||window.webkitURL}}Object(e.a)(hM,"ImageProcessor",null,[352]);class mE{constructor(a,
b,c,f,l){this.Da=a;this.LGh=b;this.KGh=c;this.tWe=f;this.BQh=l}get Ho(){return this.Da}vbi(a){this.Ho.M$c(a,this.LGh,null,null)}tbi(a){this.Ho.M$c(a,this.KGh,null,null)}Ipa(a,b,c){c?this.Ho.M$c(a,this.tWe,b,null):this.Ho.Ma(this.tWe,2,b)}x2g(a,b=!1){const c=new H.DictionaryPropertySet;c.setValue(Kd.a.sT,a);c.setValue(Kd.a.v9c,!0);c.setValue(Kd.a.$7a,b);this.Ho.Ma(this.BQh,2,c)}}Object(e.a)(mE,"ClipboardCommands",null,[322]);class nE{lYb(){}}Object(e.a)(nE,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",
null,[473]);class zq{constructor(a,b,c,f,l,w){this.KC=a;this.Vg=b;this.wu=c;this.jm=f;this.Go=l;this.Yc=w}qxj(a,b){a=b.view;b=b.HD;if(!b||I.a.instance.ga(14)&&!this.KC.Trg(b,!0)||this.jm&&this.jm.instance&&this.jm.instance.EV(b))return 2;var c=zq.PT?!zq.ut.Qia(b):!0;this.wu&&c&&this.wu.Jmc(b.node,x.a.Xp,b.Qa);this.Vg.eQc(b,l=>new hv.a(l,hv.a.MFc),Wc.AParagraphNode.VY);if(this.Yc.Zf&&this.Yc.fy){c=new Oe.GraphTransaction(15);try{c.hd(b.node)}finally{c&&c.dispose()}}var f=b.node;c=b.Lb+1;" "===db.ParagraphReader.text(f).charAt(c)&&
(f=Fc.a.createTextRange(f,c,c+1),this.Vg.replaceTextRange(f,"\u00a0"));b=Fc.a.Wj(b.node,c);a.Eb.setSelection(fd.SelectionFactory.Zt(b));return 32}static get ut(){return zq.HC||(zq.HC=lb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get PT(){null==zq.AH&&(zq.AH=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return zq.AH}}zq.HC=null;zq.AH=null;Object(e.a)(zq,"InsertLineBreakStrategy",null,[]);class Qn{static get Lh(){return Qn.xi||(Qn.xi=
lb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Ml(){return xi.ContextSetEditor.instance}static get e5(){return Qn.Go||(Qn.Go=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Mf(){return Qn.Yc||(Qn.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static Bxj(a,b,c,f,l){if(l&&l.Sa(Kd.a.targetObject)){var w=b.view.ug.Eh.te(l.getValue(Kd.a.targetObject));w=Fc.a.create(w)}else w=Qn.Ml.w1(b.HD,11);if(!w)return 8;a=
u.AFrameworkApplication.Va.li(w,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Jh)return 2;b=b.view;f=b.Eb.Dj;if(f=Qn.Ml.w1(f,11)){c=new zn.a;c.set(f.node);c.af();if(l&&l.Sa(Kd.a.targetObject))for(l=l.Uh(Kd.a.targetObject);!c.currentNode.id.equals(l)&&c.yc()&&(lc.OutlineElementNavigator.Ke(c),11===c.ri););lc.OutlineElementNavigator.Jua(c,!1,!1);l=Cb.SelectionEditor.Hha(c,!0);l=db.ParagraphReader.Ir(l)?fd.SelectionFactory.Lg(l,0):fd.SelectionFactory.$k(l);b.Eb.setSelection(l)}}return a}static e6d(a,b,c,
f,l){a=a===D.a.w2b;b=b.node;if(l&&l.Sa(Kd.a.targetObject)&&!b.id.equals(l.Uh(Kd.a.targetObject)))return 2;if(1===c)return 32;c=new mb.GraphIterator;c.set(b);c.oc(10);Qn.Lh.Oba(c,a,!0);Qn.Mf.Zf&&Qn.Mf.fy&&lc.OutlineElementNavigator.ti(c);return 32}}Qn.xi=null;Qn.Go=null;Qn.Yc=null;Object(e.a)(Qn,"InsertOutlineElementStrategy",null,[]);var DQ=d(403);class Rz{constructor(a,b,c,f,l,w,F,S){this.wu=b;this.EJh=a;this.Vs=l;this.Eo=f;this.xi=c;this.KC=w;this.Rc=F;this.s1a=S}gck(a,b,c,f,l){if(!b.view.Jh)return 2;
b=b.view;let w=null;b.Po&&(w=b);const F=b.Eb.Dj;let S=!0,fa=!1,xa=null;if(!F)return 2;const Za=new Oe.GraphTransaction(15);Za.hd(b.ug);let pb=null;2===c&&(pb=new zn.a,pb.set(F.node),pb.af(),xa=new ex(pb),2===gb.App.mode&&Cb.SelectionEditor.Mg(F)&&(pb.nC(11)&&yc.ListReader.$j(pb)&&Md.OutlineElementReader.isEmpty(pb,!1)&&(S=!1),S&&gb.App.Hh.Nv&&Md.OutlineElementReader.PB(pb,F,!1)&&!Md.OutlineElementReader.PB(pb,F,!0)&&(S=!1)),lc.OutlineElementNavigator.Ke(pb),Md.OutlineElementReader.isEmpty(pb,!1)&&
(DQ.a.LHj(pb)&&(S=!1),1===gb.App.mode&&yc.ListReader.$j(pb)&&(fa=!0)));a=u.AFrameworkApplication.Va.li(F,a,c,!1,f,l);S&&32===a&&2===c&&(fa||lc.OutlineElementNavigator.mGa(pb,!1,!Cb.SelectionEditor.Mg(F),!1),fa&&xa&&xa.restore(pb),I.a.instance.ga(101)&&this.Vs.freeze(),b.Eb.setSelection(fd.SelectionFactory.oj(pb.currentNode,!0)),I.a.instance.ga(101)&&this.Vs.fPe(),this.EJh.ln.Mv());w&&(S||w.awa());ee.GrippersManager.instance.gZa(1);Za.dispose();return a}WA(a,b,c){a=!1;if(cb.ImageReader.dDa(b)||cb.ImageReader.Vtb(b))b=
this.Bsi(b),a=!0;const f=b;b=Cb.SelectionEditor.Mg(b);if(1===c)return 32;const l=f.node,w=new mb.GraphIterator;w.set(l);w.af();lc.OutlineElementNavigator.Ke(w);c=new Oe.GraphTransaction(15);c.Ry(w);b?(b=!0,I.a.instance.ga(101)&&db.ParagraphReader.Pd(l)&&f.Qa===db.ParagraphReader.textLength(l)&&zg.n(f)&&9===db.ParagraphReader.vMc(l)&&this.Vs.pti(f),1===gb.App.mode&&Md.OutlineElementReader.isEmpty(w,!1)&&yc.ListReader.$j(w)&&(b=!1),this.Eo.Tjh(w,b,f,l),this.wu&&this.wu.Jmc(l,x.a.Xp,f.Qa),a&&(lc.OutlineElementNavigator.KI(w,
!1,!1),a=w.yb(2),(a=this.s1a.Lg(a,0))&&this.Rc.setSelection(a))):this.xi.Oba(w,!0,!0);c.dispose();gb.App.Fb&&gb.App.Fb.updateCommandUI();return 32}Bsi(a){if(cb.ImageReader.dDa(a))var b=Fc.a.Wj(a.node,a.Qa);else{b=db.ParagraphReader.lAa(a.node);var c=b.properties.Uh(Sb.a.pX);a=a.node.properties.getValue(Sb.a.runId);c=Rz.rZi(a,c,b.Ra);b=Fc.a.Wj(b,c)}return b}static cQi(a,b){let c=0;for(;c<b.length&&!(a<b[c]);)c++;return c}static rZi(a,b,c){let f=0;a=Rz.cQi(a,b);let l=0;if(a===b.length)l=c.length-1;
else for(;l<c.length;){b=c.ga(l);if(b.formatting&&b.formatting.jg===a)break;l++}l<c.length&&(f=c.ga(l).cp);return f}}Object(e.a)(Rz,"NewLineStrategy",null,[]);class cu{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.ls=null;this.pY=a;this.Nqc=w;this.euc=new Rz(this,b,c,f,l,F,xa,Za);this.Y4e=new zq(F,S,b,fa,pb,Mb)}get ln(){return this.ls||(this.ls=this.pY())}wb(){const a=u.AFrameworkApplication.Va,b=Object(C.a)(this.euc,this.euc.WA,"newLine");a.ra(D.a.enter,Db.a.view,Object(C.a)(this.Nqc.value,this.Nqc.value.WKi,
"enterView"),1124);a.ra(D.a.Ggd,Db.a.view,Object(C.a)(this.Nqc.value,this.Nqc.value.K5k,"shiftEnterView"),1124);a.ya(D.a.WA,Db.a.view,Object(C.a)(this.euc,this.euc.gck,"newLineView"));a.ya(D.a.WA,Db.a.Ff,b);a.ya(D.a.WA,Db.a.image,b);a.ya(D.a.WA,Db.a.textRange,b);a.ya(D.a.WA,Db.a.anchoredObject,b);a.ya(D.a.WA,Db.a.embeddedFile,b);a.ya(D.a.WA,Db.a.ink,b);a.ya(D.a.WA,Db.a.paragraph,b);a.ya(D.a.WA,Db.a.iFrame,b);a.ya(D.a.WA,Db.a.unsupportedObject,b);a.$d(D.a.WA,1124);a.ra(D.a.u2b,Db.a.view,Object(C.a)(this.Y4e,
this.Y4e.qxj,"insertLineBreakView"),1028);a.ya(D.a.w2b,Db.a.view,Qn.Bxj);a.ya(D.a.w2b,Db.a.outlineElement,Qn.e6d);a.$d(D.a.w2b,1092)}static get instance(){return cu.Ka||(cu.Ka=cu.IB())}static IB(){return new cu(()=>lb.a.instance.resolve("Box4.IUndoManager"),lb.a.instance.qb("Box4.IAutoCorrectScheduler"),lb.a.instance.resolve("Box4.IOutlineElementEditor"),lb.a.instance.resolve("Box4.List.IListEditor"),lb.a.instance.resolve("Box4.IInsertionPointFormatting"),lb.a.instance.qe("Box4.Actors.IEnterViewStrategy"),
Rf.a.instance,lb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),lb.a.instance.Oa("Box4.IExternalSelectionManager"),dd.a.instance,lb.a.instance.resolve("Box4.ISelectionFactory"),lb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}}cu.Ka=null;Object(e.a)(cu,"EnterActor",null,[]);class iM{Gsh(a){return a}kug(){return!0}}Object(e.a)(iM,"EopFormattingStrategy",null,[328]);var jM=d(149);class oE{constructor(a,
b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.FLa=this.lPb=this.Bib=null;this.gCd=0;this.$td=!1;this.Ta=new sd.a;this.sMb=null;this.PJ=a;this.Vs=b;this.If=c;this.tw=f;this.Tq=l;this.Eo=w;this.Pg=F;this.Vg=S;this.KC=fa;this.$c=xa;this.Yc=Za;this.Go=pb;this.oMa=Mb}get $Ii(){return I.a.instance.ga(105)?this.$c?this.$c.isFeatureEnabled(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"):!1}get pba(){return this.sMb||(this.sMb=lb.a.instance.resolve("Box4.IFormatPainterStrategy"))}get wK(){return this.$td}set wK(a){this.$td!==
a&&(this.$td=a,this.Ta.raiseEvent("FormatPainterBrushActiveStatusChanged"))}j1h(a){this.Ta.addHandler("FormatPainterBrushActiveStatusChanged",a)}r3g(a){const b=a.Wa;Z.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",b.contextId);this.reset();var c=b.node;a=this.Utg(a);if(this.pba.xnh(b.contextId,a))try{this.FLa=this.Tq.YPa(c)}catch(f){throw Z.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",f.message),f;}this.lPb=Mc.StyleReader.iD(c);c=Ab.a.xs(b);c.rz&&(this.Bib=
Object(ua.a)(kq.a,c.rz.clone()));this.gCd=a?Db.a.paragraph:b.contextId;this.pba.ZCf(b.node,this.FLa,this.Bib)}WEf(a){const b=I.a.instance.ga(14),c=this.Utg(a);for(let S=0;S<a.length;S++){var f=a.ga(S);if(f.Ok){var l=void 0;if(f.contextId===Db.a.Ff||f.contextId===Db.a.textRange)l=b&&this.KC.hsa(f);else if(f.contextId===Db.a.paragraph)l=b&&this.KC.JSc(f);else if(f.contextId===Db.a.endOfParagraph)l=b&&this.KC.IRc(f);else{Z.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",f.contextId);
continue}Z.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",f.contextId);if(l)Z.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{l=Object(ua.a)(Wc.AParagraphNode,f.node);var w=!1;l&&(w=f.contextId===Db.a.textRange&&!!l&&!f.Qa&&f.Lb===this.Tq.textLength(l));if(w=this.pba.Omh(this.gCd,f.contextId,c,w))try{db.ParagraphReader.Pd(l)?(this.lPb&&this.PJ.V9(this.lPb,l,!0),this.tw.cFf(l,this.FLa)):Z.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",
f.node.type)}catch(fa){throw Z.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",fa.message),fa;}var F=f;f.contextId===Db.a.paragraph?F=Fc.a.createTextRange(l,0,db.ParagraphReader.textLength(l)):f.contextId===Db.a.Ff&&(F=this.Vs.W_b(f),F=dd.a.QNa(F));if(F&&F.contextId===Db.a.textRange)try{this.L7h(F,this.Bib,w?null:this.lPb)}catch(fa){throw Z.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",fa.message),fa;}if(f.contextId===Db.a.paragraph||f.contextId===
Db.a.endOfParagraph){w=new mb.GraphIterator;w.set(l);w.af();w.Og(11);F=yc.ListReader.$j(w);const fa=!db.ParagraphReader.textLength(l);Z.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",F,fa);F?(this.Pg.kla(w),f=w.currentNode,this.Pg.Yba(f)&&this.Eo.Ifd(f,l,this.Bib)):this.$Ii&&this.K7h(f,this.Bib)}}}else Z.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",f.contextId)}}K7h(a,b){b&&(a=this.Vg.cTd(a.node),a.Vd(a.xe),this.XEf(a,
b,null))}L7h(a,b,c){if(b||c)0<zg.h(a).length&&Z.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.oMa.yAc(a,f=>{this.XEf(f,b,c)})}XEf(a,b,c){this.If.Zza(a);a.rz&&a.rz.removeProperty(ob.a.highlight);this.If.NCc(a);this.px(a,c);this.px(a,b)}px(a,b){if(b){var c=a.paragraph.Eh;if(c){var f=a.rz;f=f?Object(ua.a)(jM.a,f.clone()):kq.a.jAa(1179725);for(const w of b.yz())if(w!==Sb.a.aG&&w!==Sb.a.fieldInstruction&&w!==ob.a.As&&w!==ob.a.sZ&&w!==Sb.a.R7a&&w!==ob.a.Cs&&w!==Sb.a.languageHint&&
w!==Sb.a.noProof){if(w===ne.a.C1){var l=b.ta(ne.a.C1,Fa.a.nil);if(l!==Fa.a.nil&&(l=Object(ua.a)(kq.a,c.te(l)),l=Mc.StyleReader.kNc(l),l===Box4Intl.Box4Strings.L_StyleWordHyperlink)){l=Mc.StyleReader.rK(a.paragraph).Wbj(l);f.px(l);continue}}f.setValue(w,b.Uh(w))}f.G8a?b=c.rHa(f):(c.OD(f),b=f);a.Pl=b.id}}}Utg(a){return!a.Paa&&a.We.contextId!==Db.a.endOfParagraph}reset(){this.FLa=this.lPb=this.Bib=null;this.gCd=Db.a.none}}Object(e.a)(oE,"FormatPainter",null,[270]);class Sz{constructor(a){this.Sk=this.transaction=
null;this.Gf=a;this.dpb=this.Wp=0}}Object(e.a)(Sz,"SelectAllArguments",null,[]);class Wr{constructor(a,b,c,f,l){this.qQh=a;this.Mfa=b;this.kk=c;this.qud=f;this.LNb=l}get Gwe(){return this.qQh}get ln(){return this.Mfa.value}get lWk(){return this.qud?this.LNb?Object(C.a)(this,this.ZLi,"expandSelectionOneNote"):Object(C.a)(this,this.$Li,"expandSelectionWord"):Object(C.a)(this,this.rhh,"selectAllInOutline")}get shh(){return this.LNb?Object(C.a)(this,this.yed,"selectAllOutlines"):null}wb(){const a=u.AFrameworkApplication.Va;
this.shh&&a.ra(D.a.yed,Db.a.view,this.shh,2);a.ya(D.a.Y9,de.a.frame,Wr.soh);a.ya(D.a.Hgd,de.a.frame,Wr.soh);a.ra(D.a.Dqa,Db.a.view,this.lWk,2);a.ra(D.a.D6h,Db.a.view,y.AFrame.ze,100);a.ra(D.a.cse,Db.a.view,Wr.cse,4)}ZLi(a,b,c){return this.Dqa(b,c,null)}Dqa(a,b,c){if(1===b)return 32;if(!a.view.Jh)return 2;b=a.view;if(!b.Eb)return 8;const f=b.Eb.Pa;if(!f||!f.length)return 8;Me.a.mark(5798);gb.App.Fb.Fd.isEditingAllowed||gb.App.Fb.Fd.uy?a=Cb.SelectionEditor.c_d(f):(v.FocusManager.instance().pC(y.AFrame.gV),
a=fd.SelectionFactory.rGe(b.ug));if(!a)return 8;this.qud&&!f.hqa&&Z.ULS.sendTraceTag(39098305,324,50,"Progress selection start");c&&this.Gwe.t8a(Cb.SelectionEditor.H7f(a))?c=c(b):(c=new Sz(b),c.Sk=a,c=new Tb.a(null,Object(C.a)(this,this.tDb,"processSetSelection"),c),c.vl("ExpandSelection"),c.run());return c.inProgress?1:32}$Li(a,b,c,f,l){return b.view.Po?this.Dqa(b,c,Object(C.a)(this,this.rrh,"startOperationOfSelectAllInOutline")):this.rhh(a,b,c,f,l)}tDb(a,b){return 0===b.Wp?(b.transaction=this.kk.ie(2),
b.transaction.hd(b.Gf.ug),b.Wp=1,!0):1===b.Wp?(b.Gf.Eb.UFb(b.Sk,a),b.Wp=2,!0):2===b.Wp?(b.Gf.Eb.Pa.hqa=b.Sk.hqa,this.ln.Mv(),b.transaction.JT(a),b.Wp=3,b.transaction.dispose(),Me.a.mark(5799),!0):!1}rhh(a,b,c){if(1===c)return 32;if(!b.view.Jh)return 2;a=b.view;return a.Eb&&a.Eb.Pa&&a.Eb.Pa.kb?this.rrh(a).inProgress?1:32:8}rrh(a){u.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.qud&&a.Po&&Z.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");
a=new Tb.a(null,Object(C.a)(this,this.Uyk,"processSelectAllInOutline"),new Sz(a));a.vl("SelectAllInOutline");a.run();return a}Uyk(a,b){if(0===b.Wp)return b.Sk=fd.SelectionFactory.mWk(b.Gf.Eb.Pa.kb),b.transaction=this.kk.ie(2),b.transaction.hd(b.Gf.ug),b.Wp=1,!0;if(1===b.Wp){if(!b.dpb)return I.a.instance.ga(77)&&I.a.instance.ga(104)&&b.Sk.nl?(b.Gf.Eb.UFb(b.Sk,a),b.dpb=b.Sk.length):(b.Gf.Eb.setSelection(b.Sk.ga(0),a),++b.dpb),!0;if(b.dpb<b.Sk.length)return b.Gf.Eb.mBf(b.Sk.ga(b.dpb),a),++b.dpb,!0;b.Wp=
2}return 2===b.Wp?(b.Gf.Eb.Pa.hqa=b.Sk.hqa,this.ln.Mv(),b.transaction.JT(a),b.Wp=3,b.transaction.dispose(),!0):!1}yed(a,b,c){if(1===c)return 32;if(!b.view.Jh)return 2;b=b.view;a=fd.SelectionFactory.rGe(b.ug);if(!a)return 8;b=new Sz(b);b.Sk=a;a=new Tb.a(null,Object(C.a)(this,this.tDb,"processSetSelection"),b);a.vl("ExpandSelection");a.run();return a.inProgress?1:32}static get Teb(){return Wr.r1a||(Wr.r1a=lb.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static cse(a,b,c){if(1===c)return 32;
if(!b.view.Jh)return 8;a=b.view;b=fd.SelectionFactory.oj(a.root.graphNode,!0);if(!b)return 8;a.Eb.setSelection(b);return 32}static soh(){if(!I.a.instance.ga(75))return 2;var a=gb.App.Fb.Fd.UJ;if(!a.Jh)return 2;if(a.Jh&&1!==gb.App.Fb.state){Me.a.mark(4668);var b=a.Eb.Pa.kb;if(!b&&u.AFrameworkApplication.fa.ka("ContextMenuOnSelectionFixIsEnabled"))return 2;b=Cb.SelectionEditor.Qga(b);let c=b.x,f=b.y+b.height;if(!a.container)return 8;a=Sys.UI.DomElement.getBounds(a.container);if(b.y<a.y||b.y>a.y+a.height||
b.x<a.x||b.x>a.x+a.width)c=a.x,f=a.y;Wr.Teb.Y9(new Sys.UI.Point(c,f),1);Me.a.mark(4669)}return 32}}Wr.r1a=null;Object(e.a)(Wr,"SelectAllHandlers",null,[329]);class kM extends hf.StandardDialog{constructor(a,b,c=null){super();this.vd=1;b?(b=CommonUIStrings.l_GoToClassicRibbonDialogMesage,this.AFd(CommonUIStrings.l_ToggleRibbonUXDialogTellUsWhy,c)):b=CommonUIStrings.l_GoToSingleLineRibbonDialogMessage;this.NAb(CommonUIStrings.l_ToggleRibbonUXDialogTitle,b,null,null,a,null)}}Object(e.a)(kM,"ToggleRibbonUXDialog",
hf.StandardDialog,[]);const GQ=()=>{const a=u.AFrameworkApplication.Va;a.ra(G.a.IAk,de.a.frame,EQ,101);a.ya(G.a.fkl,de.a.frame,FQ)},FQ=(a,b,c)=>{if(1===c)return 32;if(b.contextId!==de.a.frame)return 2;Z.ULS.sendTraceTag(25523336,340,50,"User opened the toggle Ribbon UX dialog from the {0}",u.AFrameworkApplication.Ba.jb.Ip?"Single Line Ribbon":"Classic Ribbon");new kM(f=>{1===f&&u.AFrameworkApplication.Va.processAction(G.a.vvh,2)},u.AFrameworkApplication.Ba.jb.Ip);return 32},EQ=(a,b,c,f,l)=>{l[Uh.a.On]=
u.AFrameworkApplication.Ba.jb.Ip;return 32};class pE{constructor(a){this.If=a}QHe(a,b){this.If.rX(a,b.cache.VM);this.If.rr(a,b.cache.fontSize)}CHe(){}vZd(){return null}qV(){return null}hQa(){return null}d7(){return null}Qnh(){return!1}}Object(e.a)(pE,"FormattingStewardBridge",null,[318]);var lM=d(1006),HQ=d(934);class mM{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){if(a)if(b)if(c)if(f)if(l)if(w)if(F){if(!S)throw Error.argumentNull("errorHandler");if(!fa)throw Error.argumentNull("sessionInfo");}else throw Error.argumentNull("graphActionBlockingManager");
else throw Error.argumentNull("graphTopologyManager");else throw Error.argumentNull("graphOperationEventSource");else throw Error.argumentNull("pptWorkspace");else throw Error.argumentNull("transactionFactory");else throw Error.argumentNull("pptSelectionManager");else throw Error.argumentNull("actionManager");this.ia=a;this.ob=b;this.Jb=c;this.DW=f;this.Pr=l;this.ua=w;this.Zb=F;this.Wd=S;this.Ee=fa;this.mBg=xa;this.WPg=Za}wb(){this.ia.ra(aa.a.PYh,$b.a.application,Object(C.a)(this,this.dhj,"handleAddEditOrSetAsSlideTitle"),
4);this.ia.ra(aa.a.editSlideTitle,$b.a.application,Object(C.a)(this,this.mgg,"handleEditSlideTitle"),4);this.ia.ra(aa.a.addSlideTitle,$b.a.application,Object(C.a)(this,this.Ufg,"handleAddSlideTitle"),4);this.ia.ra(aa.a.rZh,$b.a.application,Object(C.a)(this,this.fhj,"handleAddHiddenSlideTitle"),4);this.ia.ra(aa.a.setAsSlideTitle,$b.a.application,Object(C.a)(this,this.nhg,"handleSetAsSlideTitle"),4);this.ia.ra(aa.a.Ruk,$b.a.application,Object(C.a)(this,this.Ajj,"handleHyperlinkText"),4);this.ia.ya(aa.a.jXh,
$b.a.application,Object(C.a)(this,this.bhj,"handleAccessibleAuthoringHelp"));this.ia.ra(aa.a.bxj,Db.a.application,Object(C.a)(this,this.Bhg,"handleUploadCaptionsDialog"),4);this.ia.ra(aa.a.cxj,Db.a.application,Object(C.a)(this,this.Bhg,"handleUploadCaptionsDialog"),4);this.ia.ra(aa.a.DKk,$b.a.application,Object(C.a)(this,this.jmj,"handleRemoveAllCaptions"),4)}Fe(){}gCa(){const a=this.ob.ny();return a?a.gCa():null}onShapeSelected(a,b){this.Pr.lch(Object(C.a)(this,this.onShapeSelected,"onShapeSelected"));
b.shapeNode.bja?32!==this.ia.processAction(aa.a.wTb,2)&&za.a.J(544736535,822,10,"Not able to begin edit shape text on title placeholder"):za.a.J(544736536,822,10,"After selecting title placeholder, the selected shape is not the title placeholder")}uhh(){const a=this.gCa();return a?(this.Pr.BCf(Object(C.a)(this,this.onShapeSelected,"onShapeSelected")),this.ob.selectShape(a,!0),!0):!1}Org(){const a=this.ob.rf();return!!a&&1===a.length&&!!this.gCa()}Xpg(){for(const a of this.ob.rf())if(a&&!a.gCa())return!0;
return!1}Uvg(){var a=this.ob.he();if(1!==a.length)return!1;a=a[0];return!a.bja&&!a.Xf&&!a.xh&&!a.fg&&a.hasText&&0<a.textLength()}dhj(a,b,c,f,l){if(1===c)return 32;var w=this.gCa();const F=this.ob.he(),S=1===F.length?F[0]:null;0<F.length&&S!==w?this.Uvg()?(w=3,a=this.nhg(a,b,c,f,l)):(w=4,a=32):this.Org()?(w=1,a=this.mgg(a,b,c,f,l)):this.Xpg()?(w=2,a=this.Ufg(a,b,c,f,l)):(za.a.J(544736541,822,10,"SlideTitle performed no action since none were enabled"),w=5,a=8);qf.a("AddEditOrSetAsSlideTitle",32===
a,void 0,[Object.assign(new xc.a,{name:"SubAction",int64:w})]);return a}mgg(a,b,c){return 1===c?this.Org()?32:2:this.uhh()?32:8}Vfg(a,b,c){if(1===b)return this.Xpg()?32:2;b=new Date;const f=this.Jb.xd(15,void 0,void 0,()=>{const l=this.ob.rf();if(l&&1===l.length){const w=new Date;let F=0;F=window.setInterval(()=>{this.uhh()?window.clearInterval(F):2E3<+new Date-+w&&(za.a.J(544736542,822,50,"AddSlideTitle or AddHiddenSlideTitle couldn't find title placeholder {0}ms after executing",2E3),window.clearInterval(F))},
100)}});try{za.a.J(544736543,822,50,"HandleAddSlideTitle called with isOffSlideTitle {0}",c);f.lc(this.DW.Bf);f.fd=a;for(const l of this.ob.rf())l&&!l.gCa()&&(l.jDa=c)}finally{f&&f.dispose()}a=new Date;za.a.J(544736544,822,50,"HandleAddSlideTitle completed with isOffSlideTitle {0}",c);if(c=Kc.a.Db)c.Dm("AddSlideTitleStart",b),c.Dm("AddSlideTitleEnd",a),c.Nj=!1,c.ur=!0,Kc.a.Zda(c);return 32}Ufg(a,b,c){return this.Vfg(a,c,!1)}fhj(a,b,c){return this.Vfg(a,c,!0)}nhg(a,b,c){if(1===c)return this.Uvg()?
32:2;c=this.ob.ny();const f=this.ob.he();if(1!==f.length)return za.a.J(544736545,822,10,"SetAsSlideTitle should only be enabled with 1 shape selected"),8;b=new Date;const l=this.Jb.xd(15);try{za.a.J(544736547,822,50,"HandleSetAsSlideTitle called for SlideId.Cid {0} with shapeId {1}",c.Cb.cid,f[0].get_shapeId()),l.lc(c),l.fd=a,c.mIa=f[0].get_shapeId()}finally{l&&l.dispose()}a=new Date;za.a.J(544736576,822,50,"HandleSetAsSlideTitle completed for SlideId.Cid {0} with shapeId {1}",c.Cb.cid,f[0].get_shapeId());
if(c=Kc.a.Db)c.Dm("SetAsSlideTitleStart",b),c.Dm("SetAsSlideTitleEnd",a),c.Nj=!1,c.ur=!0,Kc.a.Zda(c);32!==this.ia.processAction(aa.a.wTb,2)&&za.a.J(544736546,822,10,"Not able to begin edit shape text after Set as Slide Title");return 32}Ajj(a,b,c){return this.ob.w7()?this.ia.processAction(D.a.U1b,c):this.ia.processAction(aa.a.fAc,c)}bhj(a,b,c){if(1===c)return 32;a={};this.mBg&&(a.query="AssetID="+this.mBg);b={};b.ZT=ResourceStrings.L_Help;b.assetId="FA000000012";b.bO=a;return this.ia.Ma(aa.a.pIa,
2,b)}DFj(){if(!this.WPg)return!1;const a=this.ob.he();return 1!==a.length?!1:a[0].WP}Bhg(a,b,c){b=this.ua.Ca;if(!b||this.Zb.gd(b))return 8;if(1===c)return this.DFj()?32:2;c=Kc.a.Nm("Captions::Insert");try{return HQ.a.MLe(".vtt",lM.b,()=>lM.a(a,Object(C.a)(this,this.dxj,"insertCaptionsSuccessAfterUpload"),"captions",this.Ee),"captions",this.ua.presentation,this.Zb,this.Wd,c),c&&c.Ya("CaptionsDialogInitialized","true"),32}catch(f){za.a.J(521434636,818,10,"Error while rendering new captions selection dialog.")}c&&
(c.Ya("CaptionsDialogInitialized","false"),c.finish(),c=null);return 8}dxj(a,b,c,f,l,w){f.fN(c)&&za.a.J(521434635,822,15,"Captions::InsertCaptionsSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+c.bha);f.mJ(c);l&&l.Ya("CaptionsUploadToRC","true");if((c=this.ua.Ca)&&c.isConnected){var F=w.files[0].name;f=w="";var S=F.split(".");2<=S.length&&(f=S[S.length-2]);qa.a.re(f)||(w=F.lastIndexOf("."),w=0<=w?F.substring(0,w):F,f="");F=this.ob.he();if(1===F.length){F=F[0];
S=this.Jb.xd(15);try{S.lc(c),S.fd=a,l&&l.Ya("InsertCaptionsInProgress","true"),F.sob=b,F.qob=w,F.rob=f}finally{S&&S.dispose()}l&&(l.Ya("InsertCaptionsSuccessful","true"),l.finish())}}}MJj(){if(!this.WPg)return!1;const a=this.ob.he();return 1!==a.length?!1:a[0].WP}jmj(a,b,c){if(1===c)return this.MJj()?32:2;b=this.ob.he();if(1!==b.length)return 16;c=b[0];b=new Date;const f=this.Jb.xd(15);try{za.a.J(521434634,822,50,"RemoveAllCaptions started"),f.lc(this.DW.Bf),f.fd=a,c.Tub=!0}finally{f&&f.dispose()}a=
new Date;za.a.J(521434633,822,50,"RemoveAllCaptions completed");if(c=Kc.a.Db)c.Dm("RemoveAllCaptionsStart",b),c.Dm("RemoveAllCaptionsEnd",a),c.Nj=!1,c.ur=!0,Kc.a.Zda(c);return 32}}Object(e.a)(mM,"AccessibleAuthoringActor",null,[234]);var IQ=d(141),JQ=d(168),KQ=d(179);class nM{constructor(a,b,c,f){this.yZc=!1;this.b8="";this.Nxb=!1;this.zUa=null;this.eXc=-1;this.Txb=!1;this.pja=[];this.kc=b;this.la=c;this.T3c=f;a&&this.kc.gf(()=>{a.VJ(Object(C.a)(this,this.nlk,"onSelectionChangeFinished"))})}wb(){}Fe(){}S_b(a,
b,c){const f=[];for(const l of a)f.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:b,["controlId"]:l},c));return f}HMc(a){const b=[];for(let c=0;4>c;c++){const f={["type"]:"DropPreviewItemFromGallery",["controlId"]:a};let l=null;2>c&&(l=0);b.push(appChrome.actions.addScalingStepInTab("Home",f,l))}b.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:"GalleryToFlyout",["controlId"]:a},null));return b}hcg(a){const b=[];let c=!1;if(a){switch(this.b8){case "FormatPicture":Array.addRange(b,
this.HMc("PictureStyles"));c=!0;break;case "Table":this.Txb||Array.addRange(b,this.HMc("TableStyles"));c=!0;break;case "SmartArtDesign":Array.addRange(b,this.HMc("ChangeSmartArtLayoutAnchor"));c=!0;break;case "Graphics":Array.addRange(b,this.HMc("GraphicsStylePreviewGallery"));c=!0;break;case "Audio":c=!0;break;case "FormatShape":Array.addRange(b,this.S_b(["InsertShapeTextBoxBig","AlternativeText"],"DropLabel",0)),Array.addRange(b,this.S_b(["InsertShapeTextBoxBig","AlternativeText"],"MoveToOverflow",
0)),Array.addRange(b,this.S_b(["SetWidth","SetHeight"],"MoveToOverflow",null))}c&&(a=null,this.Txb&&(a=0),Array.addRange(b,this.S_b(this.zUa,"DropLabel",a)),a=this.zUa.slice(0,this.zUa.length).reverse(),Array.addRange(b,this.S_b(a,"MoveToOverflow",null)))}else for(const f of this.zUa)b.push(appChrome.actions.removeControlScalingStepsFromTab(f,"Home"));return b}TXd(a){const b={};for(const c of a)try{b[c]=appChrome.selectors.getModelType(c)}catch(f){return this.LDa("Error","GetModelType failed for "+
c),null}return b}fYd(a){switch(a){case "FormatPicture":case "SmartArtDesign":case "Audio":case "Graphics":return["Font","Paragraph","Drawing"]}return[]}SIb(a){this.T3c&&(a=this.TXd(a))&&this.T3c(a)}jql(a){if(a.length){if(this.T3c){var b=this.TXd(a);if(!b)return;var c=this.fYd(this.b8);if(0<c.length&&!this.Nxb){for(var f of c)this.pja.push(appChrome.actions.updateGroupHiddenState(f,!0));this.Nxb=!0}else if(this.Nxb&&!c.length){c=[];f=this.fYd("FormatPicture");for(var l of f)this.pja.push(appChrome.actions.updateGroupHiddenState(l,
!1)),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup(l));if(l=this.TXd(c))for(let w in l)b[w]=l[w];this.Nxb=!1}this.T3c(b)}this.zUa=a;b=[];for(const w of a)appChrome.selectors.isControlDisabled(w)&&b.push(w);0<b.length&&this.LDa("Disabled",b.join(","));0<this.zUa.length&&(this.pja.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),this.pja.push(appChrome.actions.updateControlsInGroup("Adaptive",this.zUa)),Array.addRange(this.pja,this.hcg(!0)),this.yZc=!0)}}ceh(a){""!==this.b8&&
this.b8!==a&&Array.addRange(this.pja,this.hcg(!1))}PRe(a,b){if(a||this.yZc)if(this.pja.push(appChrome.actions.updateGroupHiddenState("Adaptive",!a)),this.yZc=a,b=this.fYd(b),a&&0<b.length||this.Nxb){for(var c of b)this.pja.push(appChrome.actions.updateGroupHiddenState(c,a));a||(c=appChrome.selectors.getVisibleControlsInGroup("Font"),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup("Paragraph")),this.SIb(c));this.Nxb=a}}tWf(){0<this.pja.length&&(appChrome.api.dispatch(this.pja),this.pja=
[])}Sji(a,b){if(0>Array.indexOf(a,b)||"SmartArtDesign"===b&&(this.SIb(["SmartArtEditText"]),appChrome.selectors.getButtonToggleState("SmartArtEditText")))return!1;a=!1;if("Table"===b&&pg.a.instance.kb){const c=!pg.a.instance.kb.nl&&!pg.a.instance.kb.LTc;if(a=(""===this.b8||this.b8===b)&&c!==this.Txb)this.Txb=c}a?this.ceh("TableCellEdit"):this.ceh(b);this.b8=b;return!0}tWk(){const a="Table FormatPicture SmartArtDesign Audio Graphics FormatShape".split(" ");let b=!1;const c=appChrome.selectors.getActiveContextualTabIds();
for(const f of a)if(this.Sji(c,f)){b=!0;break}return b?this.b8:""}mWi(){switch(this.b8){case "FormatPicture":return"ChangePictureFlyout ChangePicture ResetPicture PictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");case "Table":return this.Txb?["Select","TableDelete","TableInsert","TableAlignmentAnchor"]:"Select TableDelete TableInsert MergeTableCells SplitTableCells SetSizeAnchor TableDistribute TableAlignmentAnchor TableCellMarginAnchor ApplyTableStyleOptionAnchor TableStyles PowerPointCellShadingMenuOpen TableAlternativeText TableBordersMenuOpen TableBorderWidthAnchor SetCellBorderColor".split(" ");
case "SmartArtDesign":return"SmartArtEditText SmartArtPromote SmartArtDemote SmartArtReverse ChangeSmartArtLayoutAnchor ChangeSmartArtColorAnchor SmartArtStyles SmartArtResetGraphic AlternativeText SetWidth SetHeight".split(" ");case "FormatShape":return["SetWidth","SetHeight","InsertShapeTextBoxBig","AlternativeText"];case "Audio":return"AudioPlay AudioPause SetVolume StartAudio SetAudioOptions PlayInBackground NoAudioStyle ChangePictureFlyout ChangePicture ResetPicture AudioPictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");
case "Graphics":return"GraphicsStylePreviewGallery ChangeGraphicFlyout GraphicsFill GraphicsOutline AlternativeText ArrangeAnchor SetWidth SetHeight".split(" ")}return[]}nlk(a,b){if(!this.la.Pma&&"Home"===appChrome.selectors.getSelectedTabId()&&b.Sk&&b.Sk.kb&&b.Sk.length){var c=()=>{const f=this.b8;""===this.tWk()?this.PRe(!1,f):this.Txb||""===f||f!==this.b8?this.jql(this.mWi()):this.yZc||(this.SIb(this.zUa),this.PRe(!0,this.b8));this.tWf()};-1!==this.eXc&&window.clearTimeout(this.eXc);this.eXc=window.setTimeout(()=>
{this.eXc=-1;let f=!1;try{window.self.requestIdleCallback(c)}catch(l){f=!0}f&&window.self.requestAnimationFrame(c)},250)}else this.PRe(!1,this.b8),this.tWf()}LDa(a,b){a={["Time"]:window.performance.now(),["Event"]:a,["Message"]:b,["Scenario"]:"AdaptiveTabGroup"};IQ.a.sendActivityEvent(Object.assign(new KQ.a,{name:"Office.TellMe.TellMeWAC.Events",dataFields:JQ.a.bD(a),durationMs:window.performance.now()}))}}Object(e.a)(nM,"AdaptiveTabGroupUpdaterActor",null,[234]);class oM extends yt{constructor(a,
b){super(a);this.HVh=b;this.yu=a}A5f(a){return(a=this.iS(a))?a.get_altTitle():""}W7f(a){return(a=this.iS(a))?a.get_alt():""}eHd(a,b){if(1===a)if(this.hide(),a=this.iS(this.yu)){const c=this.HVh.ie(15);c.lc(a);a.$Xa=!1;a.set_altTitle(b[jq.gHd]);a.set_alt(b[jq.dHd]);c.dispose()}else za.a.J(17876899,822,10,"Try to set alternative text on a null shape.")}iS(a){let b;return(a=(a=ng.b(a))?a.Eb:null)&&(b=a.he())&&1===b.length?b[0]:null}}Object(e.a)(oM,"ShapeAltTextDialog",yt,[]);class pM{constructor(a,b,
c,f,l,w){this.Jb=l;this.ia=a;this.la=b;this.ob=f;this.O9a=c;this.Zb=w}wb(){this.la.eqg&&this.ia.ra(aa.a.fAc,Db.a.view,Object(C.a)(this,this.B6h,"altTextDispatcher"),4)}Fe(){}UVi(a){new oM(a,this.Jb)}B6h(a,b,c){if(a!==aa.a.fAc)return 16;a=this.ob.he();if(!a||1!==a.length||this.Zb.gd(a[0]))return za.a.J(17876881,822,50,"No or multiple shapes selected or the selected shape is blocked. Disable the alternative text button."),16;if(1===c)return 32;za.a.J(17876883,822,50,"Begin setting the alternative text for shape.");
a[0].sk&&!a[0].get_isSVGBlipFilled()&&this.la.qRa?this.O9a.RDk():this.UVi(b);return 32}}Object(e.a)(pM,"AltTextActor",null,[234]);class qM{constructor(a,b,c,f,l,w,F,S){this.rD=null;this.ia=a;this.ob=b;this.Ga=c;this.Jb=f;this.A9a=l;this.rta=w;this.Xc=F;this.hc=S;this.A9a&&this.A9a.execute(fa=>{this.rD=fa})}wb(){this.ia.ra(aa.a.IId,$b.a.application,Object(C.a)(this,this.Hhj,"handleAudioPlay"),96);this.ia.ra(aa.a.PAc,$b.a.application,Object(C.a)(this,this.Ghj,"handleAudioPause"),96);this.ia.ra(aa.a.sGf,
$b.a.application,Object(C.a)(this,this.$9h,"audioPlayPauseCommandHandler"),96);this.ia.ra(aa.a.cZk,$b.a.application,Object(C.a)(this,this.h1b,"handleSetAudioOptions"),96);this.ia.ra(aa.a.dad,$b.a.application,Object(C.a)(this,this.dad,"queryAudioOptions"),96);this.ia.ra(aa.a.playAcrossSlides,$b.a.application,Object(C.a)(this,this.h1b,"handleSetAudioOptions"),96);this.ia.ra(aa.a.Aad,$b.a.application,Object(C.a)(this,this.Aad,"queryPlayAcrossSlides"),96);this.ia.ra(aa.a.loopUntilStopped,$b.a.application,
Object(C.a)(this,this.h1b,"handleSetAudioOptions"),96);this.ia.ra(aa.a.pad,$b.a.application,Object(C.a)(this,this.pad,"queryLoopUntilStopped"),96);this.ia.ra(aa.a.hideDuringShow,$b.a.application,Object(C.a)(this,this.h1b,"handleSetAudioOptions"),96);this.ia.ra(aa.a.kad,$b.a.application,Object(C.a)(this,this.kad,"queryHideDuringShow"),96);this.ia.ra(aa.a.rewindAfterPlaying,$b.a.application,Object(C.a)(this,this.h1b,"handleSetAudioOptions"),96);this.ia.ra(aa.a.Fad,$b.a.application,Object(C.a)(this,
this.Fad,"queryRewindAfterPlaying"),96);this.ia.ya(aa.a.playInBackground,$b.a.application,Object(C.a)(this,this.ohg,"handleSetAudioStyles"));this.ia.ya(aa.a.noAudioStyle,$b.a.application,Object(C.a)(this,this.ohg,"handleSetAudioStyles"));this.ia.ra(aa.a.Bad,$b.a.application,Object(C.a)(this,this.Bad,"queryPlayInBackground"),96);this.ia.ra(aa.a.sad,$b.a.application,Object(C.a)(this,this.sad,"queryNoAudioStyle"),96);this.ia.ra(aa.a.setVolume,$b.a.application,Object(C.a)(this,this.i1b,"handleSetVolume"),
96);this.ia.ra(aa.a.eJe,$b.a.application,Object(C.a)(this,this.i1b,"handleSetVolume"),96);this.ia.ra(aa.a.Jad,$b.a.application,Object(C.a)(this,this.Jad,"querySetVolumeLow"),96);this.ia.ra(aa.a.fJe,$b.a.application,Object(C.a)(this,this.i1b,"handleSetVolume"),96);this.ia.ra(aa.a.Kad,$b.a.application,Object(C.a)(this,this.Kad,"querySetVolumeMedium"),96);this.ia.ra(aa.a.dJe,$b.a.application,Object(C.a)(this,this.i1b,"handleSetVolume"),96);this.ia.ra(aa.a.Iad,$b.a.application,Object(C.a)(this,this.Iad,
"querySetVolumeHigh"),96);this.ia.ra(aa.a.gJe,$b.a.application,Object(C.a)(this,this.i1b,"handleSetVolume"),96);this.ia.ra(aa.a.Lad,$b.a.application,Object(C.a)(this,this.Lad,"querySetVolumeMute"),96);this.ia.ra(aa.a.Mdl,$b.a.application,Object(C.a)(this,this.lnj,"handleStartAudio"),96);this.ia.ra(aa.a.dbd,$b.a.application,Object(C.a)(this,this.dbd,"queryStartAudio"),96)}Fe(){}Hhj(a,b,c,f,l){b=this.ob.he();if(1<b.length||!this.rD)return 16;const w=this.rD.OH(b[0]);if(!w||!w.isPlayerReady())return 16;
if(1===c)return 32;let F=!1;l&&(F=!!l.ActionFromPlayer);return ug.b("AudioPlaybackOptionsActor::HandleAudioPlay ActionFromPlayer",F.toString(),a,()=>{w&&!F&&w.startPlaying();const S=[appChrome.actions.updateControlHiddenState("AudioPlay",!0),appChrome.actions.updateControlEnabledDisabledState("AudioPause",!1),appChrome.actions.updateControlHiddenState("AudioPause",!1)];appChrome.api.dispatch(S);return 32})}Ghj(a,b,c,f,l){const w=this.ob.he();if(1<w.length||!this.rD)return 16;if(1===c)return 32;let F=
!1;l&&(F=!!l.ActionFromPlayer);return ug.b("AudioPlaybackOptionsActor::HandleAudioPause ActionFromPlayer",F.toString(),a,()=>{var S=this.rD.OH(w[0]);S&&!F&&S.pause();S=[appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPause",!0)];appChrome.api.dispatch(S);return 32})}$9h(){var a=this.ob.cNc();if(!a||!this.rD)return 2;(a=this.rD.OH(a))&&!a.isPlayerFocused()&&(a.isAudioPlaying()?
this.ia.processAction(aa.a.PAc,2):this.ia.processAction(aa.a.IId,2));return 32}h1b(a,b,c,f,l){if(1===c)return 32;if(!l)return za.a.J(587531100,822,10,"AudioPlaybackOptionsActor::HandleSetAudioOptions actionData is null"),8;const w=l.On;return ug.b("AudioPlaybackOptionsActor::HandleSetAudioOptions audioOption: ",l.SqmControlId,a,()=>{const F=this.ob.mg();if(F&&0<F.length){const S=this.Jb.xd(15,void 0,()=>{this.ob.fj();this.Ga.Bd()});try{S.lc(F[0]);for(const fa of F){if(!fa||!fa.media)continue;const xa=
fa.media;switch(a){case aa.a.playAcrossSlides:xa.plyAcrssSldsField=w;break;case aa.a.loopUntilStopped:xa.repeatField=w;break;case aa.a.hideDuringShow:xa.hideDrngShwField=w;break;case aa.a.rewindAfterPlaying:xa.rewindField=w}fa.media=xa;if(this.rta&&this.rD&&(a===aa.a.loopUntilStopped||a===aa.a.rewindAfterPlaying)){const Za=this.rD.OH(fa);Za&&(a===aa.a.loopUntilStopped?Za.setRepeat(xa.repeatField):a===aa.a.rewindAfterPlaying&&Za.setRewind(xa.rewindField))}}}finally{S&&S.dispose()}}return 32})}ohg(a,
b,c,f,l){return 1===c?32:l?ug.b("AudioPlaybackOptionsActor::HandleSetAudioStyles",l.SourceControlId,a,()=>{const w=this.ob.mg();if(w&&0<w.length){const F=this.Jb.xd(15,void 0,()=>{this.ob.fj();this.Ga.Bd()});try{F.lc(w[0]);for(const S of w){if(!S||!S.media||S.xh)continue;const fa=S.media;switch(a){case aa.a.playInBackground:fa.plyAcrssSldsField=!0;fa.repeatField=!0;fa.hideDrngShwField=!0;fa.strtField=0;break;case aa.a.noAudioStyle:fa.plyAcrssSldsField=!1,fa.repeatField=!1,fa.hideDrngShwField=!1,fa.strtField=
2}S.media=fa}}finally{F&&F.dispose()}}return 32}):(za.a.J(570783881,822,10,"AudioPlaybackOptionsActor::HandleSetAudioStyles actionData is null"),8)}lnj(a,b,c,f,l){if(1===c)return 32;if(!l)return za.a.J(587531098,822,10,"AudioPlaybackOptionsActor::HandleStartAudio actionData is null"),8;const w=l.CommandValueId;return ug.b("AudioPlaybackOptionsActor::HandleStartAudio Start Option: ",w,a,()=>{if(!w||""===w.trim())return 32;const F=this.ob.mg();if(F&&0<F.length){const S=this.Jb.xd(15,void 0,()=>{this.ob.fj();
this.Ga.Bd()});try{S.lc(F[0]);for(const fa of F){if(!fa||!fa.media||fa.xh)continue;const xa=fa.media;xa.strtField="Automatically"===w?0:2;fa.media=xa}}finally{S&&S.dispose()}}return 32})}Bad(a,b,c,f,l){return this.Dva(l,1)}sad(a,b,c,f,l){return this.Dva(l,0)}i1b(a,b,c,f,l){return 1===c?32:l?ug.b("AudioPlaybackOptionsActor::HandleSetVolume Volume: ",l.SourceControlId,a,()=>{const w=this.ob.mg();if(w&&0<w.length){const F=this.Jb.xd(15,void 0,()=>{this.ob.fj();this.Ga.Bd()});try{F.lc(w[0]);for(const S of w){if(!S||
!S.media)continue;const fa=S.media;switch(a){case aa.a.gJe:fa.mteField=!0;break;case aa.a.eJe:fa.vlmField=.2;fa.mteField=!1;break;case aa.a.fJe:fa.vlmField=.5;fa.mteField=!1;break;case aa.a.dJe:fa.vlmField=.8,fa.mteField=!1}this.hc.AK&&(S.media=fa);const xa=l.ActionFromPlayer;if(this.rta&&this.rD&&!xa){const Za=this.rD.OH(S);Za&&(Za.setMute(fa.mteField),Za.setVolume(fa.vlmField))}}}finally{F&&F.dispose()}}return 32}):(za.a.J(577644177,822,10,"AudioPlaybackOptionsActor::HandleSetVolume actionData is null"),
8)}Jad(a,b,c,f,l){return this.Dva(l,2)}Kad(a,b,c,f,l){return this.Dva(l,3)}Iad(a,b,c,f,l){return this.Dva(l,4)}Lad(a,b,c,f,l){return this.Dva(l,5)}dbd(a,b,c,f,l){if(a=Object(ua.a)(Kh.a,l))c=this.ob.mg(),b=this.Oug(c,2),c=this.Oug(c,0),b?(a.J1=ResourceStrings.L_AudioStartWhenClickedOn,a.ofd()):c&&(a.J1=ResourceStrings.L_AudioStartAutomatically,a.ofd());return 32}dad(){this.B$d()&&gb.App.Fb.GF({PlayAcrossSlides:"CheckboxModel",LoopUntilStopped:"CheckboxModel",RewindAfterPlaying:"CheckboxModel",HideDuringShow:"CheckboxModel"});
return 32}Aad(a,b,c,f,l){return this.Dva(l,6)}pad(a,b,c,f,l){return this.Dva(l,7)}kad(a,b,c,f,l){return this.Dva(l,9)}Fad(a,b,c,f,l){return this.Dva(l,8)}KIi(a){return a.media.plyAcrssSldsField&&a.media.repeatField&&!a.media.strtField}JIi(a){return!a.media.plyAcrssSldsField&&!a.media.repeatField&&!!a.media.strtField}Oug(a,b){if(a&&0<a.length){for(const c of a)if(!c||!c.media||c.media.strtField!==b)return!1;return!0}return!1}Dva(a,b){if(a=Object(ua.a)(Kh.a,a)){const c=this.ob.mg();if(c&&0<c.length){let f=
!1;for(const l of c)if(l&&l.media){switch(b){case 0:f=this.JIi(l);break;case 1:f=this.KIi(l);break;case 5:f=l.media.mteField;break;case 2:f=!l.media.mteField&&.2>=l.media.vlmField;break;case 3:f=!l.media.mteField&&.2<l.media.vlmField&&.8>l.media.vlmField;break;case 4:f=!l.media.mteField&&.8<=l.media.vlmField;break;case 6:f=l.media.plyAcrssSldsField;break;case 7:f=l.media.repeatField;break;case 8:f=l.media.rewindField;break;case 9:f=l.media.hideDrngShwField;break;default:f=!1}if(!f)break}a.Yf(f)}}return 32}B$d(){return!!u.AFrameworkApplication.Ba&&
u.AFrameworkApplication.Ba.jb.Ip}}Object(e.a)(qM,"AudioPlaybackOptionsActor",null,[234]);class rM{constructor(){this.type="AudioSettingsTaskPaneProps";this.hiddenSettings=this.onSubtitleLanguageUpdated=this.onSpokenLanguageUpdated=this.onSpeakersUpdated=this.onMicrophoneUpdated=this.availableSubtitleLanguages=this.availableSpokenLanguages=this.deviceSpeakers=this.deviceMicrophones=null;this.disableDeviceDropdown=!0;this.showDeviceErrorMessage=!1}}Object(e.a)(rM,"AudioSettingsTaskPaneProps",null,[]);
class du{constructor(){this.text=this.key=null;this.itemType=0;this.selected=!1}}Object(e.a)(du,"DropdownOption",null,[]);class sM{constructor(a,b,c,f,l){this.jL=null;this.LEa=this.Sb=!1;a.loadScript("audio-settings-strings").then(()=>{this.LEa=!0;za.a.J(592447300,833,50,"audio-settings-strings loaded successfully")}).catch(w=>{za.a.J(592447298,833,10,"Failed to load audio-settings-strings "+w.toString())});this.ia=b;this.uD=f;this.Cc=c;this.wG=l}wb(){this.ia.ya(aa.a.UKe,$b.a.application,Object(C.a)(this,
this.UKe,"showHideAudioSettingsPane"));this.ia.ra(aa.a.vgc,$b.a.application,Object(C.a)(this,this.vgc,"queryShowHideAudioSettingsPane"),96)}Fe(){}UKe(a,b,c){return b.contextId===$b.a.application&&this.LEa?1===c?32:ug.a("AudioSettingsPaneToggle",a,()=>{(this.Sb=!this.Sb)?(this.kn(),this.wG.f1h(Object(C.a)(this,this.IVg,"onAudioDevicesChanged")),za.a.J(592447296,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane show")):(this.wG.mMk(Object(C.a)(this,this.IVg,"onAudioDevicesChanged")),this.aK(),
za.a.J(592447266,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane close"));return 32}):2}vgc(a,b,c,f,l){if(!Object(Ca.a)(Kh.a,l))return 8;l.Yf(this.Sb);return 32}kn(a=!1){a||this.OE();const b=Object.assign(new bu.a,{title:ResourceStrings.L_AudioSettings,hideHeader:!1,width:320,location:2,contentProps:this.jL,onOpen:()=>{},onClose:()=>{this.Sb=!1},isModernPane:!0}),c=document.getElementById("AudioSettingsPaneFocus-panel");this.uD.o7(Xd.a.YMa,Xd.a.kj,c,()=>{this.$z(!0)},()=>{this.$z(!1)});
lj.UISurfaces.du().then(f=>{a?this.Sb&&f.updateTaskPane(Xd.a.YMa,b):f.showTaskPane(Xd.a.YMa,b);return null}).catch(f=>{za.a.J(592447264,833,10,"AudioSettingsPaneActor::ShowPane exception: {0}",f.toString())})}aK(){lj.UISurfaces.du().then(a=>{a.hideTaskPane(Xd.a.YMa,2);return null}).catch(a=>{za.a.J(592447262,833,10,"AudioSettingsPaneActor::ClosePane exception: {0}",a.toString())})}OE(){this.jL=Object.assign(new rM,{deviceMicrophones:[],deviceSpeakers:[],availableSpokenLanguages:this.Bbj(),availableSubtitleLanguages:this.lcj(),
onMicrophoneUpdated:Object(C.a)(this,this.wsl,"updateMicrophone"),onSpeakersUpdated:Object(C.a)(this,this.Ntl,"updateSpeaker"),onSpokenLanguageUpdated:Object(C.a)(this,this.Qtl,"updateSpokenLanguage"),onSubtitleLanguageUpdated:Object(C.a)(this,this.Xtl,"updateSubtitleLanguage"),hiddenSettings:["Speaker"],disableDeviceDropdown:!0,showDeviceErrorMessage:!1});this.wG.enumerateDevices(Object(C.a)(this,this.Hcc,"onEnumerateDevicesSuccess"),Object(C.a)(this,this.JVa,"onDevicesFailure"),Object(C.a)(this,
this.TVa,"onUnsupported"))}$z(a){const b=document.getElementById("TaskPaneCloseBtnAudioSettingsPaneFocus");a&&b&&b.focus()}Hcc(a){if(0!==a.length)if(Ja.a.Xa(a[0].label))this.wG.requestPermission(Object(C.a)(this,this.Mkk,"onRequestPermissionSuccess"),Object(C.a)(this,this.JVa,"onDevicesFailure"),Object(C.a)(this,this.TVa,"onUnsupported")),za.a.J(592447260,833,50,"AudioSettingsPaneActor::OnEnumerateDevicesSuccess requesting device permission");else{var b=new Ua.a,c=new Ua.a;for(const f of a)Ja.a.Xa(f.deviceId)||
(a=Object.assign(new du,{key:f.deviceId,text:Ja.a.Xa(f.label)?f.deviceId:f.label}),"audiooutput"===f.kind?c.add(a):"audioinput"===f.kind&&b.add(a));0<b.count&&(b.ga(0).selected=!0);0<c.count&&(c.ga(0).selected=!0);this.jL.deviceMicrophones=b.toArray();this.jL.deviceSpeakers=c.toArray();this.jL.disableDeviceDropdown=!1;this.jL.showDeviceErrorMessage=!1;this.kn(!0)}}Mkk(){this.wG.enumerateDevices(Object(C.a)(this,this.Hcc,"onEnumerateDevicesSuccess"),Object(C.a)(this,this.JVa,"onDevicesFailure"),Object(C.a)(this,
this.TVa,"onUnsupported"));za.a.J(592447258,833,50,"AudioSettingsPaneActor::OnRequestPermissionSuccess successfully received permissions")}JVa(a){this.jL.disableDeviceDropdown=!0;this.jL.showDeviceErrorMessage=!0;this.kn(!0);za.a.J(592447256,833,10,"AudioSettingsPaneActor::OnDevicesFailure unable to get devices. Error: {0}",a.toString())}TVa(){this.jL.disableDeviceDropdown=!0;this.kn(!0);za.a.J(592447254,833,10,"AudioSettingsPaneActor::OnDevicesUnsupported mediaDevices API not available for browser: {0}",
r.a.ey)}wsl(a){this.wG.microphoneDeviceId=a.key;za.a.J(592447252,833,50,"AudioSettingsPaneActor::UpdateMicrophone user updated microphone")}Ntl(){za.a.J(592447250,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated speaker")}IVg(a,b){b.D$j&&this.wG.enumerateDevices(Object(C.a)(this,this.Hcc,"onEnumerateDevicesSuccess"),Object(C.a)(this,this.JVa,"onDevicesFailure"),Object(C.a)(this,this.TVa,"onUnsupported"))}Bbj(){const a=new Ua.a;for(let b of this.Cc.ANe)a.add(Object.assign(new du,{key:b,text:qa.a.re(b).displayName,
selected:this.Cc.Uma.toLowerCase()===b.toLowerCase()}));a.add(Object.assign(new du,{key:"seperator",text:"-",itemType:1}));a.add(Object.assign(new du,{key:"header",text:ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle,itemType:2}));for(let b of this.Cc.zNe)a.add(Object.assign(new du,{key:b,text:qa.a.re(b).displayName,selected:this.Cc.Uma.toLowerCase()===b.toLowerCase()}));return a.toArray()}lcj(){const a=new Ua.a;for(let b of this.Cc.qMe)a.add(Object.assign(new du,{key:b,text:qa.a.re(b).displayName,
selected:this.Cc.kxa.toLowerCase()===b.toLowerCase()}));return a.toArray()}Qtl(a){this.Cc.Uma=a.key;za.a.J(592447248,833,50,"AudioSettingsPaneActor::UpdateSpokenLanguage user updated spoken language")}Xtl(a){this.Cc.kxa=a.key;this.Cc.ehb=this.Cc.GNc();za.a.J(592447246,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated subtitle language")}}Object(e.a)(sM,"AudioSettingsPaneActor",null,[234]);class tM{constructor(){this.type="CaptionDiscoverabilityTaskPaneProps";this.podiumPresentationImageUrl=
null;this.enableDoNotShowAgain=!1;this.onLaunchSlideShowButtonClicked=this.onDismissButtonClicked=this.onTurnOnButtonClicked=null}}Object(e.a)(tM,"CaptionDiscoverabilityTaskPaneProps",null,[]);class yv{constructor(a,b,c,f,l,w,F,S,fa,xa){this.EIg=!1;a.loadScript("powerpoint-discoverability-strings").then(()=>{this.EIg=!0;za.a.J(591971352,801,50,"powerpoint-discoverability-strings is loaded successfully")}).catch(Za=>{za.a.J(591971350,801,10,"Failed to load powerpoint-discoverability-strings "+Za.toString())});
this.ia=b;this.Xc=c;this.qc=f;this.Qd=l;this.uD=w;this.Cc=F;this.wG=S;this.Q1j=xa;this.o6j=fa;this.SNg=Di.a.get("PPTCaptionDiscoverabilityLastShownTime")?!0:!1;this.B8b=!1;this.Xc.Imb(Object(C.a)(this,this.fva,"onRibbonTabSwitched"))}dispose(){this.Xc.Hhc(Object(C.a)(this,this.fva,"onRibbonTabSwitched"))}wb(){this.ia.ya(aa.a.pkc,$b.a.application,Object(C.a)(this,this.pkc,"showCaptionDiscoverabilityPane"))}Fe(){}pkc(a,b,c){if(b.contextId!==$b.a.application||!this.EIg)return 2;if(1===c)return 32;if(yv.R8d||
yv.HRd||!this.wNi()||!this.vNi())return 8;this.B8b||this.Xii(a);return 32}Xii(a){ug.a("CaptionDiscoverabilityPaneActor::CheckAudioAndShowPane",a,()=>{this.B8b=!0;this.wG.enumerateDevices(Object(C.a)(this,this.dfk,"onAudioInputAvailable"),Object(C.a)(this,this.JVa,"onDevicesFailure"),Object(C.a)(this,this.TVa,"onUnsupported"));return 32})}dfk(a){if(a.length){for(const b of a)if("audioinput"===b.kind&&!this.o6j.aja()){yv.R8d=!0;this.kn();break}this.B8b=!1}}JVa(a){this.B8b=!1;za.a.J(591538019,822,10,
"CaptionDiscoverabilityPaneActor::OnDevicesFailure exception: {0}",a.toString())}TVa(){this.B8b=!1;za.a.J(591538017,822,15,"CaptionDiscoverabilityPaneActor::OnUnsupported mediaDevices API not available for browser: {0}",r.a.ey)}kn(){const a=this.OE(),b=Object.assign(new bu.a,{title:ResourceStrings.l_CaptionDiscoverabilityPane,hideHeader:!1,width:320,location:2,contentProps:a,onOpen:()=>{za.a.J(591538015,822,50,"CaptionDiscoverabilityPaneActor::ShowPane")},onClose:()=>{za.a.J(591738121,822,50,"CaptionDiscoverabilityPaneActor::ClosePane")},
isModernPane:!0});this.uD.o7(Xd.a.q3a,Xd.a.kj,null,()=>{},()=>{});lj.UISurfaces.du().then(c=>{c.showTaskPane(Xd.a.q3a,b);return null}).catch(c=>{za.a.J(591971348,822,10,"CaptionDiscoverabilityPaneActor::ShowPane exception: {0}",c.toString())})}Pu(){lj.UISurfaces.du().then(a=>{a.hideTaskPane(Xd.a.q3a,2);return null}).catch(a=>{za.a.J(591971346,822,10,"CaptionDiscoverabilityPaneActor::HidePane exception: {0}",a.toString())})}OE(){return Object.assign(new tM,{podiumPresentationImageUrl:this.Qd.rk("CaptionDiscoverabilityPromptViewImage.png"),
enableDoNotShowAgain:this.SNg,onTurnOnButtonClicked:Object(C.a)(this,this.onTurnOnButtonClicked,"onTurnOnButtonClicked"),onDismissButtonClicked:Object(C.a)(this,this.onDismissButtonClicked,"onDismissButtonClicked"),onLaunchSlideShowButtonClicked:Object(C.a)(this,this.onLaunchSlideShowButtonClicked,"onLaunchSlideShowButtonClicked")})}onTurnOnButtonClicked(){ug.a("CaptionDiscoverabilityPaneTurnOn",aa.a.hIb,()=>{let a=8;this.Cc.Ih||(a=this.ia.Ma(aa.a.hIb,2,{}));this.Q1j&&8!==a||this.Pu();return a})}onDismissButtonClicked(){this.SNg&&
(yv.HRd=!0,za.a.J(591738117,822,50,"CaptionDiscoverabilityPaneActor::DoNotShowAgain"));this.Pu()}onLaunchSlideShowButtonClicked(){ug.a("CaptionDiscoverabilityPaneLaunchSlideshow",aa.a.Xkc,()=>{this.Pu();return this.ia.processAction(aa.a.Xkc,2)})}fva(a,b){2!==b.Ru&&3!==b.Ru&&4!==b.Ru||!b.ola||"SlideShow"!==b.ola||ug.a("OnRibbonTabSwitched",aa.a.pkc,()=>this.ia.processAction(aa.a.pkc,2))}vNi(){let a=0,b=!1,c=!1;for(var f of this.qc.jKc()){if(f.zn){b=!0;break}if(f.zQa&&(a+=f.sP.length,4<=a))break;if(f.i7a){c=
!0;break}}f=c||b||4<=a;za.a.J(591738113,822,50,"CaptionDiscoverabilityPaneActor::FMeetsIntentToPresent - Result: {0}; Animation Count: {1}; Hidden slide: {2}, Transition: {3}",f.toString(),a.toString(),b.toString(),c.toString());return f}wNi(){return!this.Cc.Ih&&this.eNi()}eNi(){const a=qa.a.re(u.AFrameworkApplication.lcid);return!a||Ja.a.Xa(a.name)?!1:a.name.toLowerCase()===this.Cc.Uma}static get R8d(){var a=Di.a.get("PPTCaptionDiscoverabilityLastShownTime");if(!a)return!1;const b=new Date;a=new Date(decodeURIComponent(a));
return 14>(+b-+a)/864E5}static set R8d(a){Di.a.LL("PPTCaptionDiscoverabilityLastShownTime",(new Date).toUTCString(),Di.a.qL)||za.a.J(591971344,822,10,"Failed to set cookie for discoverability last shown time to {0}",a.toString())}static get HRd(){const a=Di.a.get("PPTCaptionDiscoverabiltyDoNotShowAgain");return a?"true"===a.toLowerCase():!1}static set HRd(a){Di.a.LL("PPTCaptionDiscoverabiltyDoNotShowAgain",a.toString(),Di.a.qL)||za.a.J(591971342,822,10,"Failed to set cookie for discoverability opt out to {0}",
a.toString())}}Object(e.a)(yv,"CaptionDiscoverabilityPaneActor",null,[234]);var uM=d(712);class Ws{constructor(a,b){this.id=a;this.version=b}}Object(e.a)(Ws,"PackageAccessKey",null,[]);const zv=a=>a?md.c({["I"]:a.id,["V"]:a.version}):null;var zp=d(320);class Jx{constructor(a,b){this.Wt=a;this.Tb=b}}Object(e.a)(Jx,"ClipServiceCopyParams",null,[]);class Kx extends Jx{constructor(a,b,c){super(a,b);this.X9=c}}Object(e.a)(Kx,"ClipServiceShapeCopyParams",Jx,[]);class Tz extends Jx{constructor(a,b,c){super(a,
b);this.$ph=c}}Object(e.a)(Tz,"ClipServiceSlideCopyParams",Jx,[]);var qE=d(696),rE=d(435);class Lx{constructor(a,b,c){this.ia=a;this.Ga=b;this.pFa=c}uP(a){a=Lx.j_b(a);return this.pFa.R2b(this.Ga)&&!!a&&!!a.src}paste(a){u.AFrameworkApplication.XP?rE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.ia.Ma(aa.a.iec,2,a)}static j_b(a){if(!a||!a.Om)return za.a.J(558445148,826,15,"ImagePasteHandler: User attempted to paste null content."),null;a=a.Om.getElementsByTagName(Ne.a.Lba);
if(!a.length)return null;a=a[0];return a.src?a:null}}Object(e.a)(Lx,"ImagePasteHandler",null,[422]);var Mm=d(432);class sE{constructor(){this.v5g=this.SRd=null}}Object(e.a)(sE,"PasteSlideAsImageData",null,[]);class tE{constructor(){this.pastedContent=this.sva=null}}Object(e.a)(tE,"PasteSlideAsImageFromRibbonData",null,[]);class Uz extends Sys.EventArgs{constructor(){super()}}Object(e.a)(Uz,"SlidesChangedArgs",Sys.EventArgs,[]);class uE extends Sys.EventArgs{constructor(a,b,c){super();this.Dp=a;this.Yhi=
b;this.Zhi=c}}Object(e.a)(uE,"UpdateCcpInfoEventArgs",Sys.EventArgs,[]);class vM{constructor(){this.ShapeId=this.Cid=this.Sid=0}}Object(e.a)(vM,"CopiedShape",null,[]);class wM{constructor(){this.Cid=this.Sid=0}}Object(e.a)(wM,"CopiedSlide",null,[]);class vE extends Zf.a{constructor(){super();this.Shapes=this.Slides=this.Location=this.CcpId=null;this.MultiSlideCopy=!1;this.PackageAccessKey=this.CcpCorrelation=null}Lk(){return 65}}Object(e.a)(vE,"CopyRequest",Zf.a,[]);class Mx{constructor(a,b,c,f,l,
w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig,Ff){this.mle=this.Dta=null;this.ia=a;this.IS=f;this.Ga=l;this.Zb=w;this.ua=F;this.Jb=S;this.VK=Dc;this.Yh=fa;this.Wb=xa;this.Kw=Za;this.eEa=pb;this.Pb=Mb;this.gl=hc;this.la=b;this.sa=kc;this.MCg=Ec;this.nLg=Td;this.Je=Hc;this.Ub=we;this.C3j=Pd;this.mr=He;this.Tme=this.la.fvg;this.noe=this.la.dfh;this.KZc=c;this.Pr=Pe;this.zc=Df;this.NG=ig;this.Uv=Tg;this.oLg=Ig;this.cQ=Ff;if(!this.NG)throw za.a.J(541405712,826,10,"ClipServiceActor pastemanager is null"),
Error.argumentNull("ClipServiceActor pastemanager is null");}wb(){this.ia.ra(aa.a.mQf,$b.a.application,Object(C.a)(this,this.uij,"handleCopySlidesToClipService"),0);this.ia.ra(aa.a.s9c,$b.a.application,Object(C.a)(this,this.L2d,"handlePasteSlidesFromClipService"),4);this.ia.ra(aa.a.t9c,$b.a.application,Object(C.a)(this,this.$kj,"handlePasteSlideKeepingDestinationThemeFromFloatie"),4);this.ia.ra(aa.a.jec,$b.a.application,Object(C.a)(this,this.alj,"handlePasteSlideKeepingSourceFormattingFromFloatie"),
4);this.ia.ra(aa.a.xAk,$b.a.application,Object(C.a)(this,this.wad,"queryPasteOptions"),97);this.ia.ra(aa.a.lQf,$b.a.application,Object(C.a)(this,this.tij,"handleCopyShapesToClipService"),0);this.ia.ra(aa.a.F2g,$b.a.application,Object(C.a)(this,this.Xkj,"handlePasteShapesFromClipService"),4);this.ia.ra(aa.a.H2g,$b.a.application,Object(C.a)(this,this.K2d,"handlePasteSlideFromDesktop"),4);this.ia.ra(aa.a.r9c,$b.a.application,Object(C.a)(this,this.Ykj,"handlePasteSlideAsImage"),4);this.ia.ra(aa.a.G2g,
$b.a.application,Object(C.a)(this,this.Zkj,"handlePasteSlideAsImageFromRibbon"),4);this.ia.ra(aa.a.rTf,$b.a.application,Object(C.a)(this,this.vij,"handleCutShapes"),4);this.ia.ra(aa.a.JTd,$b.a.application,Object(C.a)(this,this.JTd,"expandPasteFloatieMenu"),96);this.ia.ra(aa.a.sTf,Db.a.application,Object(C.a)(this,this.wij,"handleCutSlides"),4);this.ia.ra(aa.a.K2g,Db.a.application,Object(C.a)(this,this.Qkj,"handlePasteCancelledByUser"),2048)}Fe(){}Zkj(a,b,c,f,l){za.a.J(540160320,826,50,"HandlePasteSlideAsImageFromRibbon called");
a=Object(ua.a)(tE,l);if(!a||!a.sva)return za.a.J(540645338,826,10,"HandlePasteSlideAsImageFromRibbon pasteSlideAsImageFromRibbonData is invalid"),8;if(1===c)return 32;c=a.sva.Tb;b=this.zc.oO(2,1,"HandlePasteSlideAsImageFromRibbon");this.zc.ai("PasteSlideAsImageFromRibbon",c,b);a.sva.Tb=b;this.NG.paste(a.sva,a.pastedContent,!0);return 32}Ykj(a,b,c,f,l){a=Object(ua.a)(sE,l);if(!a||!a.SRd)return za.a.J(541405760,826,10,"HandlePasteSlideAsImage PasteSlideAsImageData is null"),8;if(1===c)return 32;this.NG.r9c(a.SRd,
a.v5g);return 32}JTd(a,b,c){if(1===c)return 32;this.nLg.cCk();return 32}wad(a,b,c,f,l){if(!this.mr||!this.mr.hdb)return 8;a=this.mr.hdb.aA;l.SourceControlId&&("PasteSlideKeepDestinationFromClipService"===l.SourceControlId?l[Uh.a.On]=null!=a&&!a:"PasteSlideKeepSourceFromClipService"===l.SourceControlId&&(l[Uh.a.On]=null!=a&&a));return 32}alj(a,b,c,f){if(1===c)return 32;const l=this.mr.hdb;if(!l)return 8;const w=l.Wt,F=l.yL;if(!w&&!F)return 8;if(null!=l.aA&&l.aA)return 32;l.Tb=this.zc.oO(2,2,"HandlePasteSlideKeepingSourceFormattingFromFloatie");
l.aA=!0;const S=this.Ub.UH(this.mr.dxe);za.a.J(51175429,307,50,"HandlePasteSlideKeepingSourceFormattingFromFloatie - KeepSource set to true");if(F)return F.skipUndo=!0,F.selectionSlide=S,this.K2d(a,b,c,f,l);w.skipUndo=!0;w.selectionSlide=S;return this.L2d(a,b,c,f,l)}$kj(a,b,c,f){if(1===c)return 32;const l=this.mr.hdb;if(!l)return 8;const w=l.Wt,F=l.yL;if(!w&&!F)return 8;if(null!=l.aA&&!l.aA)return 32;l.Tb=this.zc.oO(2,2,"HandlePasteSlideKeepingDestinationThemeFromFloatie");l.aA=!1;const S=this.Ub.UH(this.mr.dxe);
za.a.J(51175431,307,50,"HandlePasteSlideKeepingDestinationThemeFromFloatie - KeepSource set to false");if(F)return F.skipUndo=!0,F.selectionSlide=S,this.K2d(a,b,c,f,l);w.skipUndo=!0;w.selectionSlide=S;return this.L2d(a,b,c,f,l)}tij(a,b,c,f,l){a=Object(ua.a)(Kx,l);if(!a)return za.a.J(21287178,307,50,"ClipServiceCopyParams are null."),8;b=a.Wt;c=a.X9;if(!b||!c||!c.length)return za.a.J(21287180,307,50,"Copied shapes are empty."),this.zc.Eg(!1,a.Tb,23),8;if(this.Zb.lRa())return this.zc.Eg(!1,a.Tb,2),
16;if(Ma.a.any(c,F=>F.F2))return za.a.J(556119936,826,15,"HandleCopyShapesToClipService: deferred content detected."),8;f=[];for(var w of c)f.push(Object.assign(new vM,{Sid:w.slideSid,Cid:w.slideCid,ShapeId:w.get_shapeId()}));w=Object.assign(new vE,{CcpId:b.Dp,Location:b.location,Shapes:f,CcpCorrelation:a.Tb,PackageAccessKey:zv(new Ws(a.Wt.Py,b.version))});this.$Hc(w,2,a.Tb);return 32}Xkj(a,b,c,f,l){b=Object(ua.a)(Mm.a,l);if(!b)return 8;3!==b.Wt.dataType?this.zc.dB(2,b.Tb):(this.zc.dB(7,b.Tb),this.zc.ew(5,
b.Tb));c=b.Wt;if(!c)return this.zc.Eg(!1,b.Tb,16),za.a.J(21287182,307,50,"HandlePasteShapesFromClipService: Cross-session pasted shapes are empty."),8;3!==b.Wt.dataType&&this.zc.ew(qE.ClipboardHelper.Qqg(c)?2:3,b.Tb);f=this.ua.Ca;if(!f||!f.isConnected)return this.zc.Eg(!1,b.Tb,3),za.a.J(25261661,307,50,"HandlePasteShapesFromClipService: targetSlide: {0}.",f?"not null":"null"),16;if(this.Zb.gd(f))return this.zc.Eg(!1,b.Tb,3),za.a.J(25261663,307,50,"HandlePasteShapesFromClipService: failed since the targetSlide is blocked."),
2;if(!this.gl.kI(f,c.objectCount))return this.zc.Eg(!1,b.Tb,8),za.a.J(25261665,307,50,"HandlePasteShapesFromClipService: failed since there are too many shapes on the target slide."),this.gl.fJ(f),16;this.lFd(c.Dp,b.Tb);Kc.a.pxa("PasteShapesFromClipService",!0);Kc.a.uO(!1,!1);this.mle&&this.mle===c.Dp||(this.Dta=new Ie.a(0));f.EM=c.Dp;f.jP=c.location;f.F1=c.eE;f.HY=Mx.xPe(c.Fqa);f.Py=zv(new Ws(c.Py,c.version));l=null;this.zc.j4b(b.Tb)&&(l=Lx.j_b(b));if(this.noe&&3===b.Wt.dataType)try{let w=0;this.Dta&&
this.Dta.Kb(f.Cb)&&(w=this.Dta.ga(f.Cb));this.Zb.nJd(f,a,w);za.a.J(544047372,307,50,"HandlePasteShapesFromClipService: shimmer view successful")}catch(w){za.a.J(544047373,307,10,"HandlePasteShapesFromClipService: failed to show shimmer view")}this.eEa.tAi(f,c,this.Dta,a,b.Tb,l);this.mle=c.Dp;this.zc.Eg(!0,b.Tb);return 32}vij(a,b,c,f,l){if(this.Zb.lRa())return 16;if(1===c)return 32;Kc.a.uO(!0,!0);const w=this.sa.mg();b=this.sa.ny();var F=f=c=null;let S=[];l=Object(ua.a)(Kx,l);if(!l)return 8;if(l.Wt){var fa=
l.Wt;S=l.X9;if(!S||!S.length)return 8;c=fa.Dp;F=fa.version;f=fa.location;F=zv(new Ws(fa.Py,F))}else for(fa of w)fa.HTc&&S.push(fa);for(var xa of S)if(xa.Xf||xa.xh){On(xa);break}xa=this.Jb.xd(15,void 0,()=>{this.sa.Rh()});try{xa.lc(b),xa.fd=a,this.MCg.r9g(new uE(c,f,F)),b.Tb=l.Tb,b.xT(S)}finally{xa&&xa.dispose()}for(const Za of S)this.Pr.a9g(new OJ.a(Za));this.IS.Sae=c;return 32}wij(a,b,c,f,l){b=this.sa.rf();if(!b||!b.length||!this.ua.Ca)return 16;for(var w of b)if(!w||this.Zb.gd(w)||!w.isConnected)return 16;
if(1===c)return 32;Kc.a.Db&&(Kc.a.Db.actionName="CutSlide",Kc.a.Db.ur=!1,Kc.a.Db.Nj=!0,Kc.a.Db.uE=new Date,Kc.a.Db.Ya("SlideCount",b.length.toString()));f=w=c=null;var F=[];l=Object(ua.a)(Tz,l);if(!l)return 8;if(l.Wt){f=l.Wt;F=l.$ph;if(!F||!F.length)return 8;c=f.Dp;F=f.version;w=f.location;f=zv(new Ws(f.Py,F))}F=this.Wb.Bf;if(!F)return 16;const S=this.Jb.xd(15,void 0,()=>{this.sa.Rh()});try{this.MCg.r9g(new uE(c,w,f));S.lc(F);for(const fa of b)fa&&!fa.Cb.equals(this.ua.Ca.Cb)&&F.LM(fa);F.LM(this.ua.Ca);
S.fd=a;F.Tb=l.Tb}finally{S&&S.dispose()}this.la.unblockContentWhenDeletingSlideEnabled||this.Zb.xw(F,a);this.Pr?this.Pr.JBe(new Uz(b)):za.a.J(538187015,826,10,"HandleCutSlides: graphOperationEventNotifier is null for raising event.");this.IS.Sae=c;return 32}$Hc(a,b){this.IS.ifk(a);var c=[String.format("{0}={1}","CcpId",a.CcpId),String.format("{0}={1}",zp.a.type,uM.a(b))];Kc.a.ik("CcpId",a.CcpId);c=new Mj.a(a,()=>{this.pgk(a)},f=>this.ogk(f,a,b),f=>0===f.StatusCode,void 0,c);za.a.J(557061472,307,50,
String.format("Created task: {0} for ccpid: {1}",c.id,a.CcpId));this.Yh.Hb(c)}pgk(a){this.IS.lVg(!0,a)}ogk(a,b,c){za.a.J(20760082,307,10,String.format("Failed to copy {0} for ccpid: {1} with statuscode: {2}.",uM.a(c),b.CcpId,a.StatusCode));this.IS.lVg(!1,b);return!0}lFd(a,b){const c=Kc.a.Db;c&&(c.Ya("CcpId",a),this.zc.ai("CcpId",a,b))}uij(a,b,c,f,l){a=Object(ua.a)(Tz,l);if(!a||!a.Wt)return za.a.J(34481160,307,50,"HandleCopySlidesToClipService: either copyParams '{0}' or copyParams.ClipServiceObject is null.",
a?"not null":"null"),8;za.a.J(556861641,307,50,"HandleCopySlidesToClipService: executing for ccpid: {0}",a.Wt.Dp);b=a.$ph;if(!b||!b.length||0>=Cg.e(b,w=>Object(Ca.a)(132,w)).length)return za.a.J(34481162,307,50,"HandleCopySlidesToClipService: no slide is copied"),8;if(Ma.a.any(b,w=>w.hasDeferredContent))return za.a.J(556312350,826,15,"HandleCopySlidesToClipService: trying to copy slides with deferred content to clipboard service"),8;b=Object.assign(new vE,{CcpId:a.Wt.Dp,Location:a.Wt.location,MultiSlideCopy:!0,
Slides:Cg.c(b,w=>Object.assign(new wM,{Sid:w.sid,Cid:w.cid})),CcpCorrelation:a.Tb,PackageAccessKey:zv(new Ws(a.Wt.Py,a.Wt.version))});this.$Hc(b,1,a.Tb);return 32}K2d(a,b,c,f,l){if(1===c)return 32;b=Object(ua.a)(Mm.a,l);if(!b)return za.a.J(541385500,826,10,"HandlePasteSlideFromDesktop: PasteParams is null."),8;c=b.yL;if(!c||Ja.a.Xa(c.ccpid)||Ja.a.Xa(c.data))return za.a.J(541385501,826,10,String.format("HandlePasteSlideFromDesktop: Invalid pickling data ccpid: {0}",c?c.ccpid:"null")),this.zc.Eg(!1,
b.Tb,28),8;Kc.a.pxa("PasteSlideFromDesktop",!0);this.lFd(c.ccpid,b.Tb);this.zc.ew(12,b.Tb);f={};f.CcpCorrId=b.Tb;return this.Vgg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.aA?b.aA:!this.la.iKe,c.ccpid,null,null,u.AFrameworkApplication.userSessionId,0,f,c.data,c.isDataCompressed)}L2d(a,b,c,f,l){if(1===c)return 32;b=Object(ua.a)(Mm.a,l);if(!b)return za.a.J(51520671,307,10,"HandlePasteSlidesFromClipService: PasteParams is null."),8;Kc.a.pxa("PasteSlidesFromClipService",!0);c=b.Wt;if(!c)return this.zc.Eg(!1,
b.Tb,16),za.a.J(34481166,307,10,"HandlePasteSlidesFromClipService: Cross-session pasted slides are empty."),8;this.zc.ew(qE.ClipboardHelper.Qqg(c)?2:3,b.Tb);this.lFd(c.Dp,b.Tb);f=this.Kw.S7d(c);return!this.la.$ug&&f?(this.zc.Eg(!1,b.Tb,17),za.a.J(34481168,307,10,"HandlePasteSlidesFromClipService: Don't support cross-dc paste slide: {0}",c),16):this.Vgg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.aA?b.aA:!this.la.iKe,c.Dp,c.location,c.eE,c.Py,c.version,c.Fqa,null,!1)}Vgg(a,b,c,f,l,w,F,S,
fa,xa,Za,pb,Mb,hc){this.zc.dB(19,a.Tb);const kc=this.ua.presentation;if(!kc)return this.zc.Eg(!1,a.Tb,3),za.a.J(34481164,307,10,"HandlePasteSlide: Failed because presentation node is null"),16;if(this.Zb.gd(kc))return this.zc.Eg(!1,a.Tb,3),za.a.J(36782915,307,10,"HandlePasteSlide: Can't continue because the presentation was being blocked."),2;var Ec=this.ua.Ca;if(Ec&&!Ec.isConnected)return this.zc.Eg(!1,a.Tb,3),za.a.J(34481170,307,10,"HandlePasteSlide: Failed since the selected slide is disconnected."),
16;za.a.J(36995168,307,50,String.format("HandlePasteSlide skipUndo: {0} and keepSource value is: {1}",c.toString(),w.toString()));this.Tme&&!this.Kw.zqg(a)&&this.C3j.O_h();this.mr.FUc=Date.now();this.VK.DV(this.Ub.un)&&za.a.J(36995170,307,50,"cross session paste slide happened before last action server result is not returned");Kc.a.uO(!1,!1);let Hc;var Dc=null;Ec=this.la.Fhd&&!Ja.a.Xa(Mb)&&1!==this.Pb.Aw;if(c)Dc=f,Hc=null;else{Dc=this.ua.presentation;if(!Dc)throw Error.argumentNull("Presentation is null");
Hc=Array.isArray(Dc.uSf(l,a.Tb,Ec))?Dc.uSf(l,a.Tb,Ec):null;f=Dc=this.w7i();this.mr.position=null;this.mr.dxe=Dc?Dc.slideIndex:0}l=null;c||(l=()=>{let Td;(Td=this.sa).tX.apply(Td,Hc)});l=this.Jb.xd(15,void 0,()=>{this.Ga.vf(Xd.a.ZD)},l);try{if(l.lc(kc),l.fd=c?kc.V8a?aa.a.jec:aa.a.t9c:b,Ec?(kc.Yra=!0,this.Uv.init(F)):(kc.EM=F,kc.V8a=w,kc.bxe=Dc?Dc.Cb:null,kc.jP=S,kc.F1=fa,kc.HY=Mx.xPe(pb),kc.skipUndo=c,kc.Py=zv(new Ws(xa,Za)),kc.Kub=null==hc?!1:hc,kc.kec=Mb,kc.Tb=a.Tb),!c){S=Dc;for(fa=0;fa<Hc.length;fa++)kc.Dtb(Hc[fa],
S,null),S=Hc[fa],Ec&&(Hc[fa].Yra=!0,this.Uv.iia.add(Hc[fa].id));this.Wb.Ca=Hc[Hc.length-1];this.Je.tqb=!0}}finally{l&&l.dispose()}Ec?(this.Uv.hzh(!0),this.Zb.blockContent(kc,b)):this.Zb.xw(kc,b);this.mr.hdb=a;this.mr.Rfb=!0;this.mr.TGa=null;this.Je.tqb=!0;this.mr.BWb=this.Ub.un.NL;Ec&&(this.zc.ai("DisplayNewPasteProgressUX","true",a.Tb),this.vBi(Mb,u.AFrameworkApplication.userSessionId,Dc,c,w,F,pb,hc,a.Tb));this.zc.Eg(!0,a.Tb);return 32}vBi(a,b,c,f,l,w,F,S,fa){const xa=this.zc.oO(2,0,"DataUploadInit");
this.zc.ew(13,xa);this.zc.dB(19,xa);this.zc.ai("DataUploadInitOldCcpCorrId",fa,xa);this.Uv.Jql(xa);const Za=(new Date).getTime();this.oLg.yel(a,b,w,()=>{const pb=(new Date).getTime()-Za;za.a.J(526999571,826,50,"DataUploadInit: Upload pasted data successful for ccpid: {0} time: {1}",w,pb);this.zc.ai("DataUploadTime",pb.toString(),xa);this.uBi(xa,b,c,f,l,w,F,S)},pb=>{za.a.J(527049345,826,10,"DataUploadInit: Upload pasted data failed for ccpid: {0}, error:{1} time: {2}",w,Ji.a[pb.error.Code],(new Date).getTime()-
Za);this.xij();this.zc.Eg(!1,xa,30)})}uBi(a,b,c,f,l,w,F,S){const fa=this.ua.presentation;if(fa){this.Uv.qdk();Kc.a.uO(!1,!1);za.a.J(526989261,307,50,"DataUploadFinish: FakeSlideIds: {0}",this.Uv.iia.toArray().join(",").toString());var xa=this.Jb.xd(15);try{xa.lc(fa),xa.fd=aa.a.jec,fa.bxe=c?c.Cb:null,fa.EUb=b,fa.lec=this.Uv.iia.toArray().join(",").toString(),fa.EM=w,fa.HY=Mx.xPe(F),fa.skipUndo=f,fa.Kub=null==S?!1:S,fa.V8a=l,fa.Tb=a}finally{xa&&xa.dispose()}this.zc.Eg(!0,a)}else za.a.J(527235026,307,
10,"DataUploadFinish: Failed because presentation node is null")}Qkj(a,b,c,f,l){if(1===c)return 32;if(!(l&&"UploadId"in l&&"CcpCorrId"in l))return za.a.J(524883089,307,10,"HandlePasteCancelledByUser: actionDataDictionary invalid {0}",l),8;a=l.UploadId;l=l.CcpCorrId;za.a.J(526952347,307,50,"HandlePasteCancelledByUser: uploadId: {0}",a);this.oLg.Ihi(a);this.zc.Eg(!1,l,31);return 32}xij(){this.Uv.PKf(!0);this.cQ.wwa(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,
!1,null,!1,null,0,0,null,null,!0,20)}Ecl(a){a.sort((b,c)=>c.slideIndex-b.slideIndex)}w7i(){const a=this.sa.rf();return 0<a.length&&(this.Ecl(a),a[0])?a[0]:this.ua.Ca}static xPe(a){return JSON.stringify(a)}}Object(e.a)(Mx,"ClipServiceActor",null,[234]);class wE{constructor(){this.actionId=0;this.context=null;this.behavior=0;this.od=this.XI=null}}Object(e.a)(wE,"AActionArgs",null,[]);class xE extends wE{constructor(){super()}}Object(e.a)(xE,"ActionArgs$2",wE,[]);class yE extends xE{constructor(){super()}}
Object(e.a)(yE,"ActionArgs$1",xE,[]);var Aq=d(455),eu=d(373);class Xs{constructor(a,b=!1){this.frg=!0;this.Tb=null;this.dataType=0;this.tNi=a;this.$ra=b}}Object(e.a)(Xs,"CutCopyParams",null,[]);var Av=d(434),xM=d(526);class Vz{constructor(a,b,c,f){this.ia=a;this.Z1j=f;this.pFa=c;this.Ga=b}uP(a){return this.pFa.R2b(this.Ga)&&!!Vz.T8f(a)}paste(a){this.Z1j?rE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):(za.a.J(17310402,826,50,"TablePasteHandler: Execute command to paste table from clipboard."),
this.ia.Ma(aa.a.tva,2,a))}static T8f(a){return a&&a.Om?(a=a.Om.getElementsByTagName(Ne.a.OHb))&&a.length?a[0]:null:null}}Object(e.a)(Vz,"TablePasteHandler",null,[422]);class fl{static get dA(){return lb.a.instance.qb("PowerPointWebEditor.ISystemClipboard")}}Object(e.a)(fl,"SystemClipboardFactory",null,[]);class yM{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig){this.Dta=this.A_c=null;this.hEg=0;if(!Ig)throw Error.argumentNull("DeferredContentManager");this.ia=
a;this.Ga=b;this.sa=c;this.gh=Mb;this.Zb=xa;this.Mja=Za;this.NG=pb;this.Wb=f;this.Rp=l;this.Sv=Ig;this.Jb=w;this.Gz=F;this.lq=fa;this.eEa=hc;this.Ub=kc;this.rm=Ec;this.Pb=Hc;this.JDg=Dc;this.G9a=Td;this.gl=we;this.eW=Pd;this.wac=He;this.BTa=Pe;this.Bb=Df;this.q8=ig;this.zc=Tg;this.la=S}wb(){this.la.bRc?(this.ia.ra(aa.a.Dpb,$b.a.application,Object(C.a)(this,this.igg,"handleCutCopyToSystemClipboardAsync"),4),this.ia.ra(aa.a.LVb,$b.a.application,Object(C.a)(this,this.igg,"handleCutCopyToSystemClipboardAsync"),
0),this.ia.ra(aa.a.hec,$b.a.application,Object(C.a)(this,this.oOc,"handlePasteFromSystemClipboardAsync"),4),this.la.v8a&&(this.ia.ra(aa.a.fdb,$b.a.application,Object(C.a)(this,this.oOc,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(aa.a.gdb,$b.a.application,Object(C.a)(this,this.oOc,"handlePasteFromSystemClipboardAsync"),4),this.la.FRa&&this.ia.ra(aa.a.GCb,$b.a.application,Object(C.a)(this,this.oOc,"handlePasteFromSystemClipboardAsync"),4))):(this.ia.ra(aa.a.Dpb,$b.a.application,Object(C.a)(this,
this.hgg,"handleCutCopyToSystemClipboard"),4),this.ia.ra(aa.a.LVb,$b.a.application,Object(C.a)(this,this.hgg,"handleCutCopyToSystemClipboard"),0),this.ia.ra(aa.a.hec,$b.a.application,Object(C.a)(this,this.nOc,"handlePasteFromSystemClipboard"),4),this.la.v8a&&(this.ia.ra(aa.a.fdb,$b.a.application,Object(C.a)(this,this.nOc,"handlePasteFromSystemClipboard"),4),this.ia.ra(aa.a.gdb,$b.a.application,Object(C.a)(this,this.nOc,"handlePasteFromSystemClipboard"),4),this.la.FRa&&this.ia.ra(aa.a.GCb,$b.a.application,
Object(C.a)(this,this.nOc,"handlePasteFromSystemClipboard"),4)));this.ia.ra(aa.a.kQf,$b.a.application,Object(C.a)(this,this.sij,"handleCopyShapes"),0);this.ia.ra(aa.a.p9c,Db.a.application,Object(C.a)(this,this.Wkj,"handlePasteShapes"),4);this.ia.ra(aa.a.iec,$b.a.application,Object(C.a)(this,this.Vkj,"handlePastePicture"),4);this.ia.ra(aa.a.tva,Db.a.application,Object(C.a)(this,this.clj,"handlePasteTable"),4);this.ia.ra(aa.a.q9c,$b.a.application,Object(C.a)(this,this.blj,"handlePasteSlides"),4);this.ia.ra(aa.a.hxe,
$b.a.application,Object(C.a)(this,this.dlj,"handlePasteTextIntoNewShape"),4);this.ia.KU(aa.a.m4g,$b.a.application,Object(C.a)(this,this.Qhj,"handleBrowserCut"),4);this.ia.KU(aa.a.oye,$b.a.application,Object(C.a)(this,this.Phj,"handleBrowserCopy"),0);this.ia.KU(aa.a.d$c,$b.a.application,Object(C.a)(this,this.Rhj,"handleBrowserPaste"),4);this.ia.KU(aa.a.u4g,$b.a.application,Object(C.a)(this,this.Tkj,"handlePasteGivenText"),4);this.ia.ra(aa.a.s2g,$b.a.application,Object(C.a)(this,this.Skj,"handlePasteContentFromPandora"),
4);this.ia.ra(aa.a.QGa,Db.a.application,Object(C.a)(this,this.handlePasteHtml,"handlePasteHtml"),4);this.ia.ra(aa.a.n9c,Db.a.application,Object(C.a)(this,this.Ukj,"handlePasteHtmlAsync"),4);this.ia.ra(aa.a.UNd,de.a.frame,Object(C.a)(this,this.Rkj,"handlePasteChartAsImage"),4);this.ia.ya(aa.a.ZPd,de.a.frame,Object(C.a)(this,this.ggg,"handleCutCopyThroughShortcuts"));this.ia.ya(aa.a.oQf,de.a.frame,Object(C.a)(this,this.ggg,"handleCutCopyThroughShortcuts"));this.ia.ra(aa.a.J2g,de.a.frame,Object(C.a)(this,
this.elj,"handlePasteThroughShortcuts"),4)}Fe(){if(qd.a("ShortcutsFixInMac")&&r.a.n4b){const a=[this.Ga.Bc(Ai.a.zB),this.Ga.Bc(Xd.a.sg)];for(const b of a)b.bindAction(A.KeyInputManager.La(x.a.EJa,A.KeyInputManager.He),aa.a.oQf),b.bindAction(A.KeyInputManager.La(x.a.Thb,A.KeyInputManager.He),aa.a.J2g)}}ggg(a){a=aa.a.ZPd===a;const b=this.zc.oO(a?1:0,0,a?"OnBrowserCut":"OnBrowserCopy");this.Mja.vqa(Object.assign(new Xs(!1,a),{Tb:b}));return 32}elj(){const a=this.zc.oO(2,0,"OnBrowserPaste");this.NG.paste(Object.assign(new Mm.a(!0),
{Tb:a}),null,!1);return 32}igg(a,b,c,f){let l,w;if(!({vE:l,BFc:w}=this.IPf(c,a)).returnValue)return l;if(!fl.dA)return this.zc.Eg(!1,w.Tb,1),8;this.iba(a,b,c,f,!0,w.Tb);return 32}oOc(a,b,c,f){if(1===c)return this.sa.gRa()?2:a===aa.a.fdb?2:a===aa.a.gdb?this.Yjc(!1):a===aa.a.GCb?this.Yjc(!0):32;const l=this.zc.oO(2,1,"HandlePasteFromSystemClipboardAsync");if(this.sa.E7())return this.zc.Eg(!1,l,3),16;if(!fl.dA)return this.zc.Eg(!1,l,1),8;this.iba(a,b,c,f,!1,l);Kc.a.uO(!0,!1);return 32}Yjc(a){let b=!1;
if(this.la.v8a){za.a.J(525091170,826,50,"ShouldEnablePasteAsOptions called");if(this.sa.w7())return za.a.J(524167374,826,15,"ShouldEnablePasteAsOptions: inside textbox hence disabled"),2;a=this.la.FRa&&a;b=this.NG.Tii(a)}return b?32:2}KWf(a,b){a===aa.a.Dpb?this.Mja.vqa(Object.assign(new Xs(!1,!0),{Tb:b})):a===aa.a.LVb?this.Mja.vqa(Object.assign(new Xs(!1),{Tb:b})):a===aa.a.hec?this.NG.paste(Object.assign(new Mm.a(!1),{Tb:b}),null,!1):a===aa.a.fdb?this.NG.paste(Object.assign(new Mm.a(!1),{Tb:b,aA:!1}),
null,!1):a===aa.a.gdb?this.NG.paste(Object.assign(new Mm.a(!1),{Tb:b,aA:!0}),null,!1):a===aa.a.GCb?this.NG.paste(Object.assign(new Mm.a(!1),{Tb:b,b5a:!0}),null,!1):(za.a.J(19423880,826,50,"Only Copy or Paste command are accepted."),this.zc.Eg(!1,b,5))}iba(a,b,c,f,l,w){fl.dA.iba(l);l=fl.dA.y4;null!=l&&l?this.KWf(a,w):(a=new Tb.a(null,Object(C.a)(this,this.NTe,"waitingForEnsureAccessOperationResult"),Object.assign(new yE,{actionId:a,context:b,behavior:c,XI:f,od:w})),a.vl("ClipboardPreProcess"),this.hEg=
Date.now(),a.run())}NTe(a,b){a=!0;let c=!1;const f=b.od.toString(),l=fl.dA.y4,w=fl.dA.yx;null!=l?(a=!1,l?this.KWf(b.actionId,f):c=!0):Date.now()-this.hEg>this.la.gMf&&null!=w&&(za.a.J(8955333,826,15,"Timeout while trying to execute SystemClipboardAccessManager.EnsureSystemClipboardAccess method."),a=!1,c=!0);c&&this.zc.Eg(!1,f,29);return a}hgg(a,b,c){if(!({vE:a,BFc:b}=this.IPf(c,a)).returnValue)return a;this.Mja.vqa(b);return 32}IPf(a,b){let c;c=32;const f=aa.a.Dpb===b;b=new Xs(!1,f);const l=!!this.Mja&&
this.Mja.uP(b);if(1===a)return c=this.sa.gRa()?2:l?32:16,{returnValue:!1,vE:c,BFc:b};a=this.zc.oO(f?1:0,1,"HandleCutCopyToSystemClipboard");this.zc.ew(1,a);b.Tb=a;return!l||this.Zb.lRa()?(this.zc.Eg(!1,a,2),{returnValue:!1,vE:16,BFc:b}):{returnValue:!0,vE:c,BFc:b}}nOc(a,b,c){if(1===c)return this.sa.gRa()?2:a===aa.a.fdb?this.Yjc(!1):a===aa.a.gdb?this.Yjc(!1):a===aa.a.GCb?this.Yjc(!0):32;b=this.zc.oO(2,1,"HandlePasteFromSystemClipboard");c=this.Rp.Ca;if(!c||this.Zb.gd(c)||this.sa.E7())return this.zc.Eg(!1,
b,3),16;c=null;let f=!1;a===aa.a.fdb?c=!1:a===aa.a.gdb?c=!0:a===aa.a.GCb&&this.la.FRa&&(f=!0);this.NG.paste(Object.assign(new Mm.a(!1),{Tb:b,aA:c,b5a:f}),null,!1);return 32}sij(a,b,c){if(this.Zb.lRa())return 16;if(1===c)return 32;a=this.sa.mg();for(const f of a)if(f.Xf||f.xh){On(f);break}this.isl(a);return 32}isl(a){if(!a||!a.length)this.Dta=this.A_c=null;else if(!this.A_c||!this.S8h(this.A_c,a)){const b=[];for(const c of a)b.push(c);this.Dta=new Ie.a(0);this.Dta.$(b[0].slideId,1);this.A_c=b}}S8h(a,
b){if(a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}naj(a,b,c,f){let l;l=b?b.fsb(110,75):this.Ub.rra(c.clientWidth,c.clientHeight);a=this.rm.TOd(a.Cb.cid,a.Cb.sid,!0,l._x,l._y,c.width,c.height,a.Mu()+1,c.src,c.alt&&c.alt.length?c.alt:"image",f);b&&(a.Haa=b.id);return a}Vkj(a,b,c,f,l){b=this.Rp.Ca;if(!b)return za.a.J(557090397,826,50,"Active Slide is null"),8;if(1===c)return this.Zb.gd(b)?16:32;if(!l)return 16;this.zc.dB(5,l.Tb);if(!this.gl.kI(b,1))return this.zc.Eg(!1,
l.Tb,8),this.gl.fJ(b),16;Kc.a.pxa("PastePicture",!1);f=Lx.j_b(l);if(!f||!f.src)return this.zc.Eg(!1,l.Tb,10),8;if((c=b.g2(this.sa.he()))&&this.Zb.gd(c))return this.zc.Eg(!1,l.Tb,3),16;const w=this.naj(b,c,f,l.Tb);f=this.Jb.xd(15,void 0,()=>{this.sa.gy();this.Ga.Bd()},()=>{this.sa.selectShape(w,!0)});try{f.lc(b),f.fd=a,f.iy[wq.a.s1b]=!0,c&&b.xT([c]),b.uB(w)}finally{f&&f.dispose()}this.zc.Eg(!0,l.Tb);return 32}LWi(){if(!this.Rp.Ca)return null;const a=this.Rp.Ca.km();for(const b of a)if(b.bCc)return b;
return null}clj(a,b,c,f,l){b=this.Rp.Ca;if(!b)return za.a.J(557090398,826,50,"Active Slide is null"),8;if(1===c)return b&&!this.Zb.gd(b)?32:16;if(!l)return 8;this.zc.dB(6,l.Tb);if(!this.gl.kI(b,1))return this.gl.fJ(b),this.zc.Eg(!1,l.Tb,8),16;const w=this.LWi();if(w){if(this.Zb.gd(w))return this.zc.Eg(!1,l.Tb,3),16;if(w.eI)return za.a.J(8955339,826,50,"Unable to block placeholder because the shape {0} is changing ShapeIds",w.id),this.zc.Eg(!1,l.Tb,3),32}f=Vz.T8f(l);if(!(f&&f.innerHTML&&f.rows&&f.rows.length&&
f.getElementsByTagName(Ne.a.ajd).length))return this.zc.Eg(!1,l.Tb,24),8;c=document.createElement("div");if(!c)return this.zc.Eg(!1,l.Tb,24),8;c.appendChild(f.cloneNode(!0));c=c.innerHTML;if(!c||0>=c.length)return this.zc.Eg(!1,l.Tb,24),8;za.a.J(8955341,826,50,"Paste table with {0} rows, table length {1}",f.rows.length,c.length);var F=this.$9f();f=F.x-55;F=F.y-37.5;if(w){b=this.Jb.xd(15,void 0,()=>{this.sa.gy();this.sa.Rh();this.Ga.Bd()},()=>{this.sa.selectShape(w,!0)});try{b.lc(w),b.fd=a,b.iy[wq.a.t1b]=
!0,w.Tb=l.Tb,w.aWa=c}finally{b&&b.dispose()}this.Zb.xw(w,a)}else c=b.Hxi(f,F,b.Mu()+1,c,l.Tb),c.Tb=l.Tb,this.Gz.X1([Object(ua.a)(4,c)],Object(ua.a)(132,b),a);this.zc.Eg(!0,l.Tb);return 32}Ukj(a,b,c,f,l){if(1===c)return 32;b=l?Object(ua.a)(xM.a,l):null;if(!b)return za.a.J(38858975,826,50,"Html paste context should not be null."),8;c=this.Rp.Ca;if(!c)return za.a.J(557090399,826,50,"Active Slide is null"),8;if(!c||this.Zb.gd(c))return this.zc.Eg(!1,b.Tb,3),16;Kc.a.pxa("PasteHtmlAsync",!0);za.a.J(38858974,
826,50,"Paste html start");return this.PWf(b,c,a)}handlePasteHtml(a,b,c,f,l){if(1===c)return this.sa.gRa()?2:32;const w=l?Object(ua.a)(xM.a,l):null;if(!w)return za.a.J(19202713,826,50,"Html paste context should not be null"),8;b=this.Rp.Ca;if(!b)return za.a.J(557090400,826,50,"Active Slide is null"),8;if(!b||this.Zb.gd(b))return this.zc.Eg(!1,w.Tb,3),16;za.a.J(17310102,826,50,"Paste html start");Kc.a.uO(!1,!1);Kc.a.pxa("PasteHtml",!0);Kc.a.ik(lh.a.vrk,"Image:"+w.Jba.length.toString()+",Table:"+w.Igb.length.toString()+
",Text:"+(w.IX?w.IX.length.toString():"0"));f=this.sa.he();a=Aq.a.aeh(0<w.Jba.length?!0:!1,!1,0<w.Igb.length?!0:!1,!1,this.la.lxa,a);if(w.hkc)return za.a.J(19202715,826,50,"Will replace text"),this.zc.dB(1,w.Tb),a=this.lGi(w,f[0],a),16!==a?this.zc.Eg(!0,w.Tb):this.zc.Eg(!1,w.Tb,15),a;za.a.J(19202717,826,50,"Will paste html into new shapes");if(w.QSc){if(this.la.Yug){const F=Kc.a.Db;this.Bb.Hb(new Se.a(2,1,0,()=>{Kc.a.EE(F,()=>{this.ia.Ma(aa.a.n9c,c,w)})},90,"66"));return 64}return this.PWf(w,b,a)}return this.jGi(w,
b,f,a)}lGi(a,b,c){if(this.Zb.gd(b))return 16;if(a.IX&&0<a.IX.length){za.a.J(19202719,826,50,String.format("ReplaceText: {0}",this.eEa.AKd([b])));if(this.Twg(a.IX))return 16;this.Zb.xw(b,c);const f=this.Jb.xd(15);try{b.Tb=a.Tb,f.lc(b),f.fd=c,b.Shc=a.IX,Object(Ca.a)(450,f)&&b.id&&(Object(ua.a)(450,f).iy[wq.a.R2g]=b.id.toString())}finally{f&&f.dispose()}}return 32}jGi(a,b,c,f){const l=[],w=b.Mu();var F=this.$9f(),S=F.x,fa=F.y;F=0;for(var xa=0;xa<a.Igb.length;++xa)F=this.rm.UOd(!0,b.cid,b.sid,!1,S,fa,
110,75,w+1,a.Igb[xa],a.Tb),l.push(F),F=6;S=a.Jba;fa=1===S.length?0:Aq.a.t6;for(xa=0;xa<S.length;xa++){const Za=this.rm.TOd(b.cid,b.sid,!1,fa,fa,S[xa].width,S[xa].height,w+1,S[xa].src,S[xa].alt,a.Tb);l.push(Za);fa+=Aq.a.t6;F=0===F?5:20}if(a.IX&&0<a.IX.length)if(za.a.J(19202721,826,50,String.format("PasteTextIntoNewTextbox: {0}",this.eEa.AKd(c))),!this.Twg(a.IX))c=this.rm.VOd(b.cid,b.sid,w+1,a.IX,a.Tb),l.push(c),F=0===F?1:20;else if(!l.length)return this.zc.dB(1,a.Tb),this.zc.Eg(!1,a.Tb,7),16;this.zc.dB(F,
a.Tb);if(0<l.length){if(!this.gl.kI(b,l.length))return this.gl.fJ(b),this.zc.Eg(!1,a.Tb,8),16;1===l.length&&a&&this.la.insertVideoWithPasteEnabled?(c=a.IX,this.q8.txg(c)?(this.zc.dB(8,a.Tb),za.a.J(38560067,826,50,String.format("[Insert Online Video]: Inserting online video by paste!")),this.Gz.X1(l,b,f),this.q8.Cnl(c,Object(C.a)(this,this.Rwl,"videoInsertionFail"))):(this.Gz.X1(l,b,f),this.Zb.xw(b,f))):(this.Gz.X1(l,b,f),this.Zb.xw(b,f));this.zc.Eg(!0,a.Tb)}else this.zc.Eg(!1,a.Tb,9);return 32}Rwl(){za.a.J(38560071,
826,50,String.format("[Insert Online Video] Failed to insert online video by paste!"))}PWf(a,b,c){this.zc.dB(5,a.Tb);if(Ma.a.Xa(a.Jba))return this.zc.Eg(!1,a.Tb,10),16;if(!b)return 16;var f=Object(ua.a)(316,b.pc(this.Pb.Na));if(!f)return this.zc.Eg(!1,a.Tb,3),8;var l=Kc.a.Db;l&&(l.actionName="SinglePicturePaste",l.ur=!0,l.Nj=!0,l.Ya("PreloadImageDuration",a.gxe.toString()));l=a.Jba[0];const w=b.g2(this.sa.he());var F=b.Mu();let S,fa;({vUd:fa,uC:S}=this.BTa.hNd(w,l.width,l.height));F=this.rm.TOd(b.cid,
b.sid,!1,S.x,S.y,fa.width,fa.height,F+1,l.src,l.alt,a.Tb);Kc.a.ik("ImageSrcSize",l.src.length.toString());f=this.BTa.zJd(this.Pb.Ed,fa,S,f.wV);F.BT=f;w&&(F.Haa=w.id);F.isResizable=!0;F.K3b=!0;F.DK=!0;F.qGa=!0;F.kca=l.src;this.Gz.X1([F],b,c,null,w);this.zc.Eg(!0,a.Tb);return 32}Twg(a){return 65535<a.length?(za.a.J(20471842,826,50,"Exceed text size limit: {0}",a.length),!0):!1}Wkj(a,b,c,f,l){b=this.Rp.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(1===c)return 32;c=Object(ua.a)(Mm.a,
l);if(!c)return 8;f=c.yV;if(Ma.a.Xa(f))return this.zc.Eg(!1,c.Tb,11),8;this.zc.dB(2,c.Tb);this.zc.ew(2,c.Tb);l=this.Rp.Ca;if(!l||this.Zb.gd(l))return this.zc.Eg(!1,c.Tb,3),16;Kc.a.pxa("PasteShape",!1);if(!this.gl.kI(l,f.length))return this.gl.fJ(l),this.zc.Eg(!1,c.Tb,8),16;za.a.J(8955349,826,50,"Start Handle paste shapes");var w=Rq.b(f,fa=>fa.shapeNode);this.Sv.j3d(w,"HandlePasteShapes");for(var F of f){if(!F||!F.shapeNode.isConnected)return za.a.J(18686421,826,50,"Paste deleted shapes"),this.JDg.Ckc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,
String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),this.zc.Eg(!1,c.Tb,12),16;if(this.Zb.fN(F.shapeNode))return this.zc.Eg(!1,c.Tb,3),16;if(!F.shapeNode.get_shapeId())return this.zc.Eg(!1,c.Tb,12),16}F=[];for(w=0;w<f.length;w++)F.push(f[w].shapeNode);for(var S of F)if(S.Xf||S.xh){On(S);break}S=Object(ua.a)(132,b.LB(f[0].shapeNode.slideId));this.eEa.E2g(S,l,F,this.Dta,a,c.Tb);za.a.J(8955351,826,50,({contentType:a}=this.eEa.BKd(F)).returnValue);this.zc.dB(a,c.Tb);Kc.a.uO(!0,!0);
this.zc.Eg(!0,c.Tb);return 32}Rkj(a,b,c,f,l){(a=Object(ua.a)(Mm.a,l))&&this.NG.nrk(a.Tb);return 32}blj(a,b,c,f,l){if(1===c)return 32;b=Object(ua.a)(Mm.a,l);if(!b)return 8;this.zc.dB(19,b.Tb);this.zc.ew(2,b.Tb);if(Ma.a.Xa(b.yV))return this.zc.Eg(!1,b.Tb,11),8;Kc.a.pxa("PasteSlide",!0);if(c=Array.isArray(b.yV)?b.yV:null){let F=0;c.forEach(S=>{S.Ud&&S.Ud.hasDeferredContent&&F++});0<F&&za.a.J(556312349,843,50,"HandlePasteSlides total: {0}, deferredSlideCount: {1}",c.length,F)}c=[];for(var w of b.yV){f=
Object(ua.a)(Av.a,w);if(!f)return this.zc.Eg(!1,b.Tb,11),8;f=f.Ud;if(!f||!f.isConnected)return za.a.J(33863424,826,50,"Paste deleted slide"),this.JDg.Ckc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),b.v0g&&(this.lq.yq=null),this.zc.Eg(!1,b.Tb,13),16;if(this.Zb.gd(f))return this.zc.Eg(!1,b.Tb,3),16;Array.add(c,f)}w=Array.clone(this.sa.rf());w.sort((F,S)=>F.Ge-S.Ge);w=w[w.length-1];if(!w)return za.a.J(33863425,826,50,"Paste slides with no slide selected"),
this.zc.Eg(!1,b.Tb,13),8;Kc.a.ik("SlideCount",c.length.toString());w=this.Gz.D_f(c,a,w,b.Tb,!1);c=!0;for(const F of w)if(!F.OV){c=!1;break}c||this.Zb.xw(this.Wb.Bf,a);Kc.a.uO(!0,!0);this.zc.Eg(!0,b.Tb);return 32}jKe(){return this.sa.hu()||this.sa.rG()}d7k(){if(this.sa.hu())return!0;if(this.sa.rG()){const a=this.sa.he();return 1!==a.length||!a[0].isEditable}return!1}Qhj(a,b,c,f,l,w){const F=this.zc.oO(1,0,"HandleBrowserCut");this.zc.dB(1,F);this.jKe()?(a=this.G9a(a,this.ia,b,c,f,l,w,this.zc,F),a.M3a(16)):
(Kc.a.uO(!0,!0),this.zc.mbc(F),a=this.G9a(a,this.ia,D.a.HTb,c,f,l,w,this.zc,F),a.SPc());return a}Phj(a,b,c,f,l,w){const F=this.zc.oO(0,0,"HandleBrowserCopy");this.zc.dB(1,F);this.jKe()?(a=this.G9a(a,this.ia,b,c,f,l,w,this.zc,F),2===f&&this.Mja.vqa(Object.assign(new Xs(!0),{frg:!1,Tb:F})),a.M3a(32)):(this.zc.mbc(F),a=this.G9a(a,this.ia,D.a.jBc,c,f,l,w,this.zc,F),a.SPc());return a}Rhj(a,b,c,f,l,w){const F=this.zc.oO(2,0,"HandleBrowserPaste"),S=this.jKe();a=this.G9a(a,this.ia,S?b:D.a.Ipa,c,f,l,w,this.zc,
F);w=Object(ua.a)(10,w);Kc.a.uO(!0,!1);if(this.sa.E7())return a.M3a(16),this.zc.Eg(!1,F,3),a;w&&w.Sa(Kd.a.sT)?2===f&&this.Okd(w,F)?a.M3a(32):S?(2===f&&this.NG.paste(Object.assign(new Mm.a(!0),{Hug:!1}),w.getValue(Kd.a.sT),!1),a.M3a(32)):a.SPc():(za.a.J(20486024,826,50,"Invalid action data for browser paste, expect PastedHtmlContent"),a.M3a(16),this.zc.Eg(!1,F,14));return a}Tkj(a,b,c,f,l,w){Kc.a.pxa("PasteGivenText",!1);this.d7k()?(a=this.G9a(a,this.ia,b,c,f,l,w,this.zc,""),a.M3a(16)):(Kc.a.uO(!0,
!0),a=this.G9a(a,this.ia,D.a.m9c,c,f,l,w,this.zc,""),a.SPc());return a}dlj(a,b,c,f,l){if(1===c)return 32;if((b=this.sa.he())&&0<b.length)return za.a.J(8955354,826,50,"HandlePasteTextIntoNewShape: do not paste text into a new textbox since a shape is selected. {0}",this.eEa.AKd(b)),16;za.a.J(8955356,826,50,"HandlePasteTextIntoNewShape: a. Paste text as new shape.");if(!(l&&l.Om&&l.Om.innerHTML&&l.Om.innerHTML.length))return za.a.J(558445149,826,50,"HandlePasteTextIntoNewShape: a. User attempted to paste null content."),
8;Kc.a.pxa("PasteTextIntoNewShape",!0);b=this.Rp.Ca;if(!b)return za.a.J(8955357,826,50,"insert shape with no slide selected"),16;if(!this.gl.kI(b,1))return this.gl.fJ(b),16;l=this.rm.VOd(b.cid,b.sid,b.Mu()+1,l.Om.innerHTML,l.Tb);this.Gz.X1([l],b,a);return 32}$9f(){const a=this.Ub.Gv();return new ic.a(Math.floor(a.width/2),Math.floor(a.height/2))}Skj(a,b,c,f,l){if(1===c)return 32;a="";l&&(a=l.getAttribute(eu.a.jLf).toString());this.zc.qvb(a)||(a=this.zc.oO(2,1,"HandlePasteContentFromPandora"));b=this.ia.processAction(aa.a.aha,
2);if(32!==b)return this.zc.Eg(!1,a,15),za.a.J(17310111,826,50,"Exit from box4 failed."),b;a=Object.assign(new Mm.a(!0),{Tb:a});this.eW.CEj(l)?a.Om=l:(Ne.a.SCc(this.gh),this.gh.contentWindow.document.body.appendChild(l));this.NG.paste(a,null,!1);za.a.J(17310113,826,50,null);return 32}Okd(a,b){if(a){if(this.la.t7d){const c=a.ta(Kd.a.EPc,"");if(c.startsWith("data:image/"))return this.zc.dB(5,b),this.NG.fxe(c,b)}a=a.getValue(Kd.a.sT);Ja.a.Xa(a)||(a=this.eW.YVa(a),this.zc.s3k(a,b))}return!1}}Object(e.a)(yM,
"ClipboardActor",null,[234]);var Bq=d(1085);class zM{constructor(a,b,c){this.ia=a;this.jq=b;this.la=c;this.wb()}wb(){this.ia.ra(aa.a.Uzk,de.a.frame,Object(C.a)(this,this.Zmc,"updateCoauthStatus"),96)}Fe(){}Zmc(a,b,c,f,l){if(1===c)return 32;a=this.jq.Bec;Ja.a.Xa(a)&&(a="NotConnected");this.jq.m4a&&(a=String.format("{0} ~:{1}",a,this.jq.m4a));l[Bq.a.Value]=a;l[tm.a.labelText]=a;l[Bq.a.Visible]=!0;return 32}}Object(e.a)(zM,"CoauthActor",null,[234]);var fu=d(256),Rk=d(379);class AM{constructor(a,b,c,
f){this.KEa=!1;a("powerpoint-editor-intl").then(()=>{za.a.J(51519637,801,50,"Icons and strings script is loaded successfully");a("colorPickerManager").then(()=>{za.a.J(51519639,801,50,"Color Picker Manager script is loaded successfully");this.KEa=!0}).catch(l=>{za.a.J(51519641,801,10,"Failed to load colorpickerManager "+l.toString())})}).catch(l=>{za.a.J(51519643,801,10,"Failed to load powerpoint-editor-intl "+l.toString())});this.ia=b;this.Ga=c;this.Wb=f}wb(){this.ia.ya(aa.a.renderColorPicker,$b.a.application,
Object(C.a)(this,this.renderColorPicker,"renderColorPicker"));this.ia.ya(aa.a.zza,$b.a.application,Object(C.a)(this,this.zza,"addRecentColor"))}Fe(){}renderColorPicker(a,b,c,f,l){if(1===c)return this.KEa?32:8;a=!1;b=l.currentColor;c=l.handleCommand;l.hideAlphaSlider&&(a=!0);this.IOk(b,c,a);return 32}zza(a,b,c,f,l){if(a=fu.a.parse(l.Color)){b=this.Wb.Bf;if(!b)return za.a.J(595186576,822,10,"AddRecentColor: pagemanifestnode is null"),8;b.ke(zb.a.gBi,a.RGBColor);b.ke(zb.a.I1,JSON.stringify(Rk.g(b.I1,
a.RGBColor)))}else return za.a.J(595186574,822,10,"AddRecentColor: failed to parse colorinfo, colorInfo is null"),8;return 32}IOk(a,b,c){let f="#000000",l=100;a&&(f=Jb.a.HH(a.xC),l=100*a.alpha);a=document.getElementById("colorPickerDiv");a||(a=document.createElement("div"),a.id="colorPickerDiv",document.getElementById("WACInnerFrame").appendChild(a),this.Ga.WPc(Xd.a.bVb,Xd.a.kj,a));const w=colorPickerManager.FactoryGlobal.getColorPickerManagerInstance();if(w)if(w.addEventListener("onColorChange",
fa=>{const xa={};xa.Color=fa;xa.sourceControlId="CustomColors";let Za=8;ug.a("ColorPicker_ColorApplied",b,()=>Za=this.ia.Ma(b,2,xa));32===Za?za.a.J(595186570,822,50,"RenderColorPickerDialog: Color applied successfully from color picker dialog through {0} command.",b):za.a.J(595186568,822,50,"RenderColorPickerDialog: Color not applied successfully from color picker dialog through {0} command.",b);this.Ga.Kj(Xd.a.bVb,!1)}),w.addEventListener("onCancel",()=>{this.Ga.Kj(Xd.a.bVb,!1)}),ug.a("ColorPicker_DialogInvocation",
b,()=>{w.render("colorPickerDiv",f,l,c);return 32}),za.a.J(595186566,822,50,"RenderColorPickerDialog: Color Picker Dialog invoked through {0} command.",b),this.Ga.Kj(Xd.a.bVb,!0),a=this.Ga.Bc(Xd.a.bVb)){a.HK=!0;var F=A.KeyInputManager.La(x.a.tq,0),S=A.KeyInputManager.La(x.a.tq,4);a.Wo(F);a.Wo(S);a.bindAction(F,G.a.uqa);a.bindAction(S,G.a.uqa)}else za.a.J(595186564,822,10,"RenderColorPickerDialog: colorPickerScope is null");else za.a.J(595186572,822,10,"RenderColorPickerDialog: colorPickerManagerInstace is null")}}
Object(e.a)(AM,"ColorPickerActor",null,[234]);var LQ=d(1003);class BM{constructor(a,b,c,f,l,w,F,S,fa,xa,Za=!1){this.ia=a;this.$6b=b;this.uN=c;this.Zka=l.Zlc;this.Fja=f;this.ua=w;this.Fa=F;this.sa=S;this.Ga=fa;this.f_=xa;this.h0j=Za}wb(){this.ia.ya(aa.a.cEc,$b.a.application,Object(C.a)(this,this.Anj,"handleThumbnailPanelContextMenu"));this.ia.ya(aa.a.GNd,$b.a.application,Object(C.a)(this,this.gnj,"handleSorterViewThumbnailContextMenu"));this.ia.ya(aa.a.DPf,$b.a.application,Object(C.a)(this,this.fnj,
"handleSorterViewBlankSpaceMenu"));this.ia.ya(aa.a.DNd,$b.a.application,Object(C.a)(this,this.Fmj,"handleSectionContextMenu"));this.ia.ya(aa.a.FNd,Db.a.view,Object(C.a)(this,this.anj,"handleSlidePanelContextMenu"));this.ia.ya(aa.a.ENd,Db.a.view,Object(C.a)(this,this.Akj,"handleMultiSelectShapeContextMenu"));this.ia.ya(aa.a.GPf,$b.a.application,Object(C.a)(this,this.Rnj,"handleVersionHistoryThumbnailContextMenu"));this.ia.$d(aa.a.cEc,2048)}Fe(){this.h0j&&r.a.Gj&&(this.Ga.Bc(E.AppFrame.hV).bindAction(A.KeyInputManager.La(x.a.vJa,
0),D.a.Y9),this.Ga.Bc(E.AppFrame.SBe).bindAction(A.KeyInputManager.La(x.a.vJa,0),D.a.Y9))}Anj(a,b,c,f,l){if(1===c)return 32;if(this.ia.JV)return this.f_.show(1,-1),32;this.$6b.u5a();if(l.Hc&&Sys.UI.DomElement.containsCssClass(l.Hc,ef.a.Iza))return 16;if(this.uN.oZ||!l.Hc)return 32;2===l.Qf||3===l.Qf?(a=l.clientPoint.y-Fe.a.G6i(this.Zka.cX)+this.Zka.cX.scrollTop,a=this.Zka.N0f(a),b=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y)):(a=0>this.Zka.selectedIndex?2:1,b=Sys.UI.DomElement.getLocation(this.Zka.cX),
b=new Sys.UI.Point(b.x+nf.a.Xpa,b.y+nf.a.Xpa));this.Fja.value.J4(nf.a.xqa,b,l.Qf,a);return 32}Rnj(a,b,c,f,l){if(1===c)return 32;if(l.Hc&&Sys.UI.DomElement.containsCssClass(l.Hc,ef.a.Iza))return 16;if(!l.Hc)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);this.Fja.value.J4(nf.a.xqa,a,l.Qf,21);return 32}fnj(a,b,c,f,l){if(1===c)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);this.Fja.value.J4(nf.a.xqa,a,l.Qf,20);return 32}gnj(a,b,c,f,l){if(1===c)return 32;if(l.Hc&&Sys.UI.DomElement.containsCssClass(l.Hc,
ef.a.Iza))return 16;if(this.uN.oZ||!l.Hc)return 32;if(2===l.Qf||3===l.Qf||1===l.Qf)a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y),this.Fja.value.J4(nf.a.xqa,a,l.Qf,19);return 32}Fmj(a,b,c,f,l){if(1===c)return 32;u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&(a=l.contextMenuArgs,b=new Sys.UI.Point(a.clientPoint.x,a.clientPoint.y),l.isEmptySection?this.Fja.value.J4(nf.a.xqa,b,a.Qf,17):this.Fja.value.J4(nf.a.xqa,b,a.Qf,18));return 32}anj(a,b,c,f,l){if(1===c)return 32;this.$6b.u5a();
if(l.Hc&&Sys.UI.DomElement.containsCssClass(l.Hc,ef.a.Iza))return 16;if(this.uN.oZ||!l.Hc)return 32;if(2===l.Qf||3===l.Qf)a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{a=ng.b(b);a=ng.e(this.ua.Ca,a.Na);if(!a)return 16;a=Sys.UI.DomElement.getLocation(a.qC);a=new Sys.UI.Point(a.x+nf.a.Xpa,a.y+nf.a.Xpa)}this.Fja.value.J4(nf.a.xqa,a,l.Qf,4);return 32}Akj(a,b,c,f,l){if(1===c||l.Hc&&Sys.UI.DomElement.containsCssClass(l.Hc,nf.a.M6h))return 32;this.$6b.u5a();if(l.Hc&&Sys.UI.DomElement.containsCssClass(l.Hc,
ef.a.Iza))return 16;if(this.uN.oZ||!l.Hc)return 32;b=ng.b(b);var w;if(!(b&&b.Eb&&(w=this.sa.mg())&&w.length))return 16;a=this.h6i(w);if(2===l.Qf||3===l.Qf)w=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{w=ng.c(w[0],b.Na);if(!w||!w.za)return 16;w=id.a.ei(w.za.za);b=id.a.ei(b.container);c=w.x+nf.a.Xpa<b.x?b.x:w.x+nf.a.Xpa;w=w.y+nf.a.Xpa<b.y?b.y:w.y+nf.a.Xpa;c=c>b.x+b.width?b.x+b.width:c;w=w>b.y+b.height?b.y+b.height:w;w=new Sys.UI.Point(c,w)}1===l.Qf||4===a?this.Fja.value.J4(nf.a.xqa,w,l.Qf,
a):this.Fja.value.y9k(nf.a.xqa,w,l.Qf,a);return 32}h6i(a){let b=a[0];b.get_smartArtModelId()&&(b=this.Fa.Lr(b));return 1<a.length?this.Fa.cAc(a)?11:10:b.ty||!b.xDa||b.Xf?5:b.get_isSVGBlipFilled()?13:b.sk||1===b.mediaType?7:b.fg?8:b.xx?6:b.ar?22:b.Gq?9:b.rd?14:b.hq?15:b.t7?16:0}}Object(e.a)(BM,"ContextMenuActor",null,[234]);class CM{constructor(a,b,c,f,l,w,F){this.ia=a;this.sa=b;this.Fa=c;this.p9a=f;this.Y0j=l;this.Dje=w;this.US=F}wb(){this.ia.ra(aa.a.Fsk,$b.a.application,Object(C.a)(this,this.Gsk,
"pictureToolsTabViewHandler"),4);this.ia.ra(aa.a.lHi,$b.a.application,Object(C.a)(this,this.mHi,"drawingToolsTabViewHandler"),4);this.ia.ra(aa.a.a$h,$b.a.application,Object(C.a)(this,this.b$h,"audioPlaybackToolsTabViewHandler"),4);this.ia.ra(aa.a.Y9h,$b.a.application,Object(C.a)(this,this.Z9h,"audioFormatToolsTabViewHandler"),4);this.ia.ra(aa.a.c$h,$b.a.application,Object(C.a)(this,this.d$h,"audioSettingsTabViewHandler"),4);this.ia.ra(aa.a.kAk,$b.a.application,Object(C.a)(this,this.Ugj,"graphicsTabViewHandler"),
100);this.ia.ra(aa.a.y7g,$b.a.application,Object(C.a)(this,this.Ghl,"tableTabViewHandler"),100);this.ia.ra(aa.a.s7g,$b.a.application,Object(C.a)(this,this.X9h,"audioContextualGroupHandler"),100);this.ia.ra(aa.a.ozf,$b.a.application,Object(C.a)(this,this.lXh,"accessibleAuthoringViewHandler"),4)}Fe(){}Gsk(){return this.IEj()?32:this.Nug(this.sa.mg())?32:8}mHi(){const a=this.sa.mg();return a&&a.length?1===a.length?this.Fsg(a)?32:16:this.t6h(a)||this.mAj(a)&&this.Fsg(a)?32:this.Vmb(a)||this.DGj(a)?16:
32:16}b$h(){return this.Dje?this.ZRc()?32:this.Vmb(this.sa.mg())?32:8:2}Z9h(){return this.US?this.ZRc()?32:this.Vmb(this.sa.mg())?32:8:2}d$h(){return this.US&&this.Dje?this.ZRc()?32:this.Vmb(this.sa.mg())?32:8:2}Ugj(){return this.Y0j?this.JEj()?32:this.Fa.Msh(this.sa.mg())?32:16:2}Ghl(){const a=this.sa.he();return a&&1===a.length&&a[0].rd?32:8}X9h(){return this.US||this.Dje?this.ZRc()?32:this.Vmb(this.sa.mg())?32:8:2}lXh(){return this.p9a&&this.p9a.isVisible?32:2}DGj(a){if(!a)return!1;let b=!0;for(const c of a){if(c.hq||
1===c.mediaType)return!0;c.sk||(b=!1)}return b}t6h(a){if(!a)return!1;for(const b of a)if(!b.hq)return!1;return!0}Nug(a){if(!a)return!1;let b=!1;for(const c of a)if(c)if(c.sk&&!c.get_isSVGBlipFilled())b=!0;else if(c.hq)return!1;return b}Vmb(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1!==b.mediaType)return!1;return!0}mAj(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1===b.mediaType)return!0;return!1}Fsg(a){if(!a)return!1;for(const b of a)if(b&&(b.esa||b.t7))return!0;return!1}IEj(){return this.K8d(this.sa.mg())&&
this.Nug(this.sa.iO(this.sa.he()))}JEj(){return this.K8d(this.sa.mg())&&this.kKj(this.sa.iO(this.sa.he()))}ZRc(){return this.K8d(this.sa.mg())&&this.Vmb(this.sa.iO(this.sa.he()))}kKj(a){if(!a)return!1;for(const b of a)if(b&&b.xh&&b.get_isSVGBlipFilled())return!0;return!1}K8d(a){if(!a)return!1;for(const b of a)if(b&&b.Xf)return!0;return!1}}Object(e.a)(CM,"ContextualTabsActor",null,[234]);class DM{constructor(a,b,c,f){this.moe=null;this.ia=a;this.ua=b;this.Jb=c;this.vEg=f;this.vEg.yk(Object(C.a)(this,
this.DZg,"onRichApiResponseReceived"))}wb(){this.ia.ra(aa.a.ETd,Db.a.application,Object(C.a)(this,this.cjj,"handleExecuteAddinBatchOperation"),4)}Fe(){}dispose(){this.vEg.Pm(Object(C.a)(this,this.DZg,"onRichApiResponseReceived"))}DZg(a,b){this.moe&&(a=Object(ua.a)(449,b.node))&&a.QEe&&this.moe(a.QEe)}cjj(a,b,c,f,l){b=this.ua.presentation;if(1===c)return b?32:8;if(!b)return za.a.J(590995482,802,10,"HandleExecuteAddinBatchOperation with null IPageManifestNode."),16;if(!l)return za.a.J(590995480,802,
10,"HandleExecuteAddinBatchOperation with null action data."),16;this.moe=l.promiseToResolve;c=this.Jb.xd(15,void 0,void 0,void 0,!0);try{c.lc(b),c.fd=a,b.MFd(l.requestBody)}finally{c&&c.dispose()}return 32}}Object(e.a)(DM,"ExtensibilityActor",null,[234]);var Nx;(function(a){a[a.height=0]="height";a[a.width=1]="width";a[a.rotation=2]="rotation";a[a.leftMargin=3]="leftMargin";a[a.rightMargin=4]="rightMargin";a[a.topMargin=5]="topMargin";a[a.bottomMargin=6]="bottomMargin"})(Nx||(Nx={}));Object(e.b)("FormatPaneProperty",
Nx);class Wz{constructor(a,b){this.g0=a;this.m9=b}}Object(e.a)(Wz,"MarginShapeData",null,[]);class zE{constructor(){this.type="FormatShapeTaskPaneProps";this.onToggleAspectRatio=this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.rotation=this.width=this.height=this.numberFormatInfo=null;this.isMarginFieldEnabled=this.isAspectRatioFeatureEnabled=this.isAspectRatioDisabled=this.isAspectRatioLocked=!1;this.emptyValueFields=this.disabled=0}}Object(e.a)(zE,"FormatShapeTaskPaneProps",
null,[]);class EM{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc){this.aGa=this.bbb=this.xW=this.Vta=null;this.kJg=0;this.Sb=!1;this.vUa=null;this.CEa=this.qta=!1;this.L0j=!0;this.ob=b;this.Rb=c;this.ia=f;this.Ga=l;this.oxb=w;this.yh=F;this.zd=S;this.Xc=fa;this.Pb=xa;this.MDa=Za;this.Wb=pb;this.yh.xM(Object(C.a)(this,this.Wua,"onChangeRenderFormatShapePane"));this.yh.IMa(Object(C.a)(this,this.Wua,"onChangeRenderFormatShapePane"));this.Xc.E2a(Object(C.a)(this,this.Wua,"onChangeRenderFormatShapePane"));
this.zd.LMa(Object(C.a)(this,this.Wua,"onChangeRenderFormatShapePane"));this.Rb.aP(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched"));this.jHg=hc;this.$Xc=kc;this.Fa=Mb;this.ZZ=Ec;this.lp=Hc;qd.a("FixHeightAndWidthButtonValues")&&this.lp&&this.lp.hGd(Object(C.a)(this,this.Wua,"onChangeRenderFormatShapePane"))}dispose(){this.yh.H9(Object(C.a)(this,this.Wua,"onChangeRenderFormatShapePane"));this.yh.heb(Object(C.a)(this,this.Wua,"onChangeRenderFormatShapePane"));this.Xc.rEb(Object(C.a)(this,this.Wua,
"onChangeRenderFormatShapePane"));this.zd.sEb(Object(C.a)(this,this.Wua,"onChangeRenderFormatShapePane"));this.Rb.Q_(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched"));qd.a("FixHeightAndWidthButtonValues")&&this.lp.vcd(Object(C.a)(this,this.Wua,"onChangeRenderFormatShapePane"))}wb(){this.ia.ra(aa.a.WKe,$b.a.application,Object(C.a)(this,this.WKe,"showHideFormatShapePane"),4);this.ia.ra(aa.a.mHe,$b.a.application,Object(C.a)(this,this.mHe,"setAbsoluteHeight"),4);this.ia.ra(aa.a.xMe,$b.a.application,
Object(C.a)(this,this.xMe,"spinAbsoluteHeight"),4);this.ia.ra(aa.a.BDb,$b.a.application,Object(C.a)(this,this.BDb,"queryAbsoluteHeight"),100);this.ia.ra(aa.a.nHe,$b.a.application,Object(C.a)(this,this.nHe,"setAbsoluteWidth"),4);this.ia.ra(aa.a.yMe,$b.a.application,Object(C.a)(this,this.yMe,"spinAbsoluteWidth"),4);this.ia.ra(aa.a.CDb,$b.a.application,Object(C.a)(this,this.CDb,"queryAbsoluteWidth"),100);this.ia.ra(aa.a.iad,$b.a.application,Object(C.a)(this,this.iad,"queryFormatShapePane"),96)}Fe(){}Wua(){this.Sb&&
this.kn(!0)}Mx(a){1===a.mode&&this.Sb&&(this.Sb=!1,this.Pu(),this.Ga.Kj(Xd.a.$Y,this.Sb))}rEj(a){return this.Wb.isEditingAllowed&&this.L0j&&!this.mKe(a)}iad(a,b,c,f,l){(a=Object(ua.a)(Kh.a,l))&&a.Yf(this.Sb);return 32}WKe(a,b,c){b=this.ob.mg();return 1===c?b.length&&this.rEj(b)?32:8:ug.b("FormatShapePaneActor::ShowHideFormatShapePane PaneOpen:",this.Sb.toString(),a,()=>{(this.Sb=!this.Sb)?this.kn():this.Pu();return 32})}mHe(a,b,c,f,l){b=this.ob.mg();return 1===c?this.Umh(b)?8:32:ug.a("FormatShapePaneActor::SetAbsoluteHeight",
a,()=>{if(!l)return za.a.J(592318472,822,10,"FormatShapePaneActor::SetAbsoluteHeight actionData == null"),8;const w=l.Number;void 0===w||null===w||isNaN(w)||this.cva(w,0);return 32})}xMe(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.cva(0,0),this.O2a());return 32}BDb(a,b,c,f,l){if(!l)return za.a.J(592318470,822,10,"FormatShapePaneActor::QueryAbsoluteHeight actionData is null"),8;if(a=l.queryResult)b=this.OE(),a.xea=b.height.toFixed(2).toString()+'"',1===(b.emptyValueFields&1)&&(a.xea="");return 32}nHe(a,
b,c,f,l){b=this.ob.mg();return 1===c?this.Umh(b)?8:32:ug.a("FormatShapePaneActor::SetAbsoluteWidth",a,()=>{if(!l)return za.a.J(592318468,822,10,"FormatShapePaneActor::SetAbsoluteWidth actionData == null"),8;const w=l.Number;void 0===w||null===w||isNaN(w)||this.cva(w,1);return 32})}yMe(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.cva(0,1),this.O2a());return 32}CDb(a,b,c,f,l){if(!l)return za.a.J(592318466,822,10,"FormatShapePaneActor::QueryAbsoluteWidth actionData is null"),8;if(a=l.queryResult)b=this.OE(),
a.xea=b.width.toFixed(2).toString()+'"',2===(b.emptyValueFields&2)&&(a.xea="");return 32}kn(a=!1){const b=this.OE(),c=Object.assign(new bu.a,{title:ResourceStrings.l_FormatOptions,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Sb=!1},isModernPane:!0});lj.UISurfaces.du().then(f=>{a?f.updateTaskPane(Xd.a.$Y,c):f.showTaskPane(Xd.a.$Y,c);return null})}Pu(){lj.UISurfaces.du().then(a=>{a.hideTaskPane(Xd.a.$Y,2);return null})}OE(){const a=this.ob.mg();var b=[];for(var c of a)c.Xf?
b=Array.isArray(b.concat.apply(b,this.Fa.my(c)))?b.concat.apply(b,this.Fa.my(c)):null:b.push(c);if(!(c=this.Nk(a[0]))||this.mKe(a))return this.CEa=!0,this.rjh(0,0,0,0,0,0,0,127,127);var f=this.getBounds(a[0]),l=c.ud;c=this.$Yd(f);c=this.gEc(c,1,l);f=this.P1d(f);f=this.gEc(f,0,l);this.CEa=0===c||0===f?!0:!1;l=Math.round(a[0].get_shapeRotation());b=this.Nk(b[0]);let w=0,F=0,S=0,fa=0;b&&(w=b.UQa[0],F=b.UQa[1],S=b.UQa[2],fa=b.UQa[3]);c=this.rjh(c,f,l,w,F,S,fa,this.R_i(a),0);this.atl(a,c);return c}R_i(a){let b=
[];for(var c of a)c.Xf?b=Array.isArray(b.concat.apply(b,this.Fa.my(c)))?b.concat.apply(b,this.Fa.my(c)):null:b.push(c);c=0;for(let f=0;f<a.length;f++)this.kUb(a[f])||(c|=4),this.ZZ&&!this.jUb(a[f])&&(c|=1,c|=2);for(a=0;a<b.length;a++)if(!b[a].ovb){c|=120;break}return c}kUb(a){return!!a&&a.DK&&!a.eI}jUb(a){return!!a&&a.isResizable&&!a.eI}Umh(a){if(0>=a.length)return!0;let b=!1;if(this.ZZ){b=!0;for(let c=0;c<a.length;c++)if(a[c]&&this.jUb(a[c])){b=!1;break}}return b||this.mKe(a)}mKe(a){if(!a.length)return!0;
let b=!1;for(let c=0;c<a.length;c++)if(a[c]&&a[c].rd){b=!0;break}return b}atl(a,b){if(this.$Xc){var c=[];for(var f of a)f.Xf?c=Array.isArray(c.concat.apply(c,this.Fa.my(f)))?c.concat.apply(c,this.Fa.my(f)):null:c.push(f);var l=f=!0,w=!0,F=!0;if(2<=c.length)for(var S=1;S<c.length;S++){var fa=c[S];if(!fa)continue;if(!this.getBounds(fa))continue;fa=this.Nk(fa);let xa=0,Za=0,pb=0,Mb=0;fa&&(xa=fa.UQa[0],Za=fa.UQa[1],pb=fa.UQa[2],Mb=fa.UQa[3]);f&&b.leftMargin!==xa&&(b.leftMargin=0,b.emptyValueFields|=8,
f=!1);l&&b.rightMargin!==Za&&(b.rightMargin=0,b.emptyValueFields|=16,l=!1);w&&b.topMargin!==pb&&(b.topMargin=0,b.emptyValueFields|=32,w=!1);F&&b.bottomMargin!==Mb&&(b.bottomMargin=0,b.emptyValueFields|=64,F=!1);if(!(f||l||w||F))break}}if(!(2>a.length))for(l=f=c=!0,w=1;w<a.length;w++)if(F=a[w])if(S=this.getBounds(F))if(fa=this.Nk(F).ud,F=this.$Yd(S),F=this.gEc(F,1,fa),S=this.P1d(S),S=this.gEc(S,0,fa),fa=a[w].get_shapeRotation(),c&&b.height.toFixed(2).localeCompare(F.toFixed(2))&&(b.height=0,b.emptyValueFields|=
1,c=!1),f&&b.width.toFixed(2).localeCompare(S.toFixed(2))&&(b.width=0,b.emptyValueFields|=2,f=!1),l&&b.rotation!==fa&&(b.rotation=0,b.emptyValueFields|=4,l=!1),!(c||f||l))break}N_k(a,b,c,f,l,w,F,S,fa){const xa=new zE,Za=Object(ua.a)(Object,Pg.e().numberFormatInfo);xa.numberFormatInfo=Za;xa.height=a;xa.width=b;xa.rotation=c;xa.leftMargin=f;xa.rightMargin=l;xa.topMargin=w;xa.bottomMargin=F;xa.disabled=S;xa.onChange=Object(C.a)(this,this.cva,"onPropertyChange");xa.emptyValueFields=fa;xa.isAspectRatioLocked=
this.qta;xa.isAspectRatioDisabled=this.CEa;xa.onToggleAspectRatio=Object(C.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");xa.isAspectRatioFeatureEnabled=this.jHg;xa.isMarginFieldEnabled=this.$Xc;return xa}O_k(a,b,c,f,l){const w=new zE,F=Object(ua.a)(Object,Pg.e().numberFormatInfo);w.numberFormatInfo=F;w.height=a;w.width=b;w.rotation=c;w.disabled=f;w.onChange=Object(C.a)(this,this.cva,"onPropertyChange");w.emptyValueFields=l;w.isAspectRatioLocked=this.qta;w.isAspectRatioDisabled=this.CEa;
w.onToggleAspectRatio=Object(C.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");w.isAspectRatioFeatureEnabled=this.jHg;return w}rjh(a,b,c,f,l,w,F,S,fa){return this.$Xc?this.N_k(a,b,c,f,l,w,F,S,fa):this.O_k(a,b,c,S,fa)}cva(a,b){const c=this.ob.mg();this.kJg!==b&&(this.O2a(),this.kJg=b);switch(b){case 0:case 1:this.resize(a,c,b);break;case 3:case 4:case 5:case 6:this.wii(a,c,b);break;case 2:this.rotate(a,c)}}onToggleAspectRatio(a){this.qta=a}OJf(a,b,c,f){a/=b;return c?Math.round(c/a):Math.round(f*
a)}wii(a,b,c){let f=[];for(const w of b)w.Xf?f=Array.isArray(f.concat.apply(f,this.Fa.my(w)))?f.concat.apply(f,this.Fa.my(w)):null:f.push(w);this.vUa=b=f;let l=!0;this.xW||(this.xW=[],l=!1);ug.b("FormatShapePaneActor::ChangeMargin Property:",Nx[c]+"; AspectRatioLocked: "+(!this.CEa&&this.qta),aa.a.Fjc,()=>{for(let w=0;w<b.length;w++){const F=b[w],S=this.Nk(F);if(!S)continue;l||this.xW.push(new Wz(F,new ri.a));this.xW.length===w&&this.xW.push(new Wz(F,new ri.a));this.xW[w]||(this.xW[w]=new Wz(F,new ri.a));
const fa=this.xW[w];fa.m9.left=F.Nga;fa.m9.right=F.Oga;fa.m9.top=F.Pga;fa.m9.bottom=F.Mga;3===c&&(this.xW[w].m9.left=a);4===c&&(this.xW[w].m9.right=a);5===c&&(this.xW[w].m9.top=a);6===c&&(this.xW[w].m9.bottom=a);S.txa(this.xW[w].m9)}return 32});this.inc()}resize(a,b,c){this.vUa=b;let f=!0;const l=[],w=[];this.Vta||(this.Vta=[],f=!1);0===a&&(this.CEa=!0);ug.b("FormatShapePaneActor::Resize Property:",Nx[c]+"; AspectRatioLocked: "+(!this.CEa&&this.qta),aa.a.reb,()=>{for(let xa=0;xa<b.length;xa++){var F=
b[xa];const Za=this.Nk(F);if(this.ZZ){if(!Za||!this.jUb(F))continue}else if(!Za)continue;var S=this.getBounds(F),fa=this.$Yd(S);S=this.P1d(S);f||(Array.add(this.Vta,new tz(F,new ri.a)),Za.CK=!0,Za.cD(!1));Array.add(l,Za.BVa);Array.add(w,new ri.a);Za.shapeNode.Xf&&Za.shapeNode.isEditable&&Za.Kk&&(Za.Kk.visible=!0);F=Za.ud;if(0===c){F=this.TPf(a,1,F);F=Math.round(F-fa);w[xa].bottom=F;let pb;(pb=this.Vta[xa].U_).bottom=pb.bottom+F;if(!this.CEa&&this.qta){fa=this.OJf(S,fa,0,F);w[xa].right=fa;let Mb;(Mb=
this.Vta[xa].U_).right=Mb.right+fa}}else{F=this.TPf(a,0,F);F=Math.round(F-S);w[xa].right=F;let pb;(pb=this.Vta[xa].U_).right=pb.right+F;if(!this.CEa&&this.qta){fa=this.OJf(S,fa,F,0);w[xa].bottom=fa;let Mb;(Mb=this.Vta[xa].U_).bottom=Mb.bottom+fa}}Za.setOffsets(ri.a.add(l[xa],w[xa]),!0);Za.shapeNode.Xf&&Za.shapeNode.isEditable&&(Za.M3d(),Za.hPc())}return 32});this.inc()}rotate(a,b){this.vUa=b;let c=!0;a=Math.round(a);this.bbb||(this.bbb=[],c=!1);ug.a("FormatShapePaneActor::Rotate",aa.a.sic,()=>{for(let f=
0;f<b.length;f++){const l=b[f],w=this.Nk(l);if(!w)continue;const F=w.trb().$f(),S=a%vp.Adc;c||(w.cD(!1),Array.add(this.bbb,new vp(l,S)));this.bbb[f].jUf=S;w.setRotation(S,F)}return 32});this.inc()}Nk(a){return a?Object(ua.a)(uz.a,a.yg(this.Pb.Na)):(za.a.J(592318464,822,10,"shapeNode == null"),null)}getBounds(a){var b=this.Nk(a);if(!b)return za.a.J(592316642,822,10,"shapeViewElement == null"),null;b=b.OZb();a.wZ&&(b=this.pXd(b));return b}TPf(a,b,c){return this.MDa.OL(this.Pb.Ed.jZ(a,b),c)}gEc(a,b,
c){a=this.Pb.Ed.yf(this.MDa.IQ(a,c),b);return ke.a.kv(a)}$Yd(a){a=ic.a.Nl(a.Yj(ge.a.nu),a.Yj(ge.a.bH));return 1>=a?0:a}P1d(a){a=ic.a.Nl(a.Yj(ge.a.nu),a.Yj(ge.a.JD));return 1>=a?0:a}O2a(){this.$Xc&&this.xW&&(this.ia.Ma(aa.a.Fjc,2,this.xW),this.xW=null);if(this.Vta){for(var a=0;a<this.vUa.length;a++){var b=this.Nk(this.vUa[a]);b&&!b.kl&&(b.shapeNode.Xf&&b.shapeNode.isEditable||(b.CK=!1),b.qz(!1))}this.ia.Ma(aa.a.reb,2,this.Vta);this.Vta=null}if(this.bbb){for(a=0;a<this.vUa.length;a++)(b=this.Nk(this.vUa[a]))&&
!b.kl&&(b.qz(!1),this.ia.Ma(aa.a.sic,2,this.bbb[a]));this.bbb=null}this.aGa=this.vUa=null}inc(){this.aGa&&Kc.a.Hob(this.aGa);this.aGa=Kc.a.W9(Object(C.a)(this,this.O2a,"applyPendingChangesToServerIfRequired"),1E3)}pXd(a){const b=ic.a.m6a(a.ga(0),a.ga(3));a=ic.a.m6a(a.ga(1),a.ga(2));return new qi.a(new ic.a(b.x,b.y),new ic.a(a.x,b.y),new ic.a(a.x,a.y),new ic.a(b.x,a.y))}}Object(e.a)(EM,"FormatShapePaneActor",null,[109,234]);class Xz{constructor(a,b,c,f,l,w,F){this.type="FormatTableTaskPaneProps";this.onChange=
this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.tableWidth=this.tableHeight=this.cellWidth=this.cellHeight=this.numberFormatInfo=null;this.isAspectRatioLocked=!1;this.onToggleAspectRatio=null;this.disabled=!1;this.emptyValueFields=0;const S=Object(ua.a)(Object,Pg.e().numberFormatInfo);if(!S)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=S;this.cellHeight=b;this.cellWidth=c;this.tableHeight=f;this.tableWidth=l;this.leftMargin=a.leftMargin;this.rightMargin=
a.rightMargin;this.topMargin=a.topMargin;this.bottomMargin=a.bottomMargin;this.disabled=w;this.emptyValueFields=F}}Object(e.a)(Xz,"FormatTableTaskPaneProps",null,[]);class FM{constructor(){this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=0;this.m5g=this.p5g=this.o5g=this.n5g=-1}}Object(e.a)(FM,"Margins",null,[]);class GM{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc){this.qta=this.Sb=!1;this.Oei=320;this.N$b=!1;if(!a)throw Error.argumentNull("pptSelectionManager");if(!b)throw Error.argumentNull("appFrame");
if(!c)throw Error.argumentNull("actionManager");if(!f)throw Error.argumentNull("focusManager");if(!l)throw Error.argumentNull("formatTablePane");if(!w)throw Error.argumentNull("graphOperationEventHandler");if(!F)throw Error.argumentNull("viewElementEventHandlers");if(!S)throw Error.argumentNull("viewEventSource");if(!fa)throw Error.argumentNull("pageView");if(!xa)throw Error.argumentNull("unitConversion");if(!Za)throw Error.argumentNull("workspace");if(!Mb)throw Error.argumentNull("tableReader");
if(!hc)throw Error.argumentNull("rowReader");if(!kc)throw Error.argumentNull("columnReader");if(!pb)throw Error.argumentNull("dynamicScriptLoader");pb.loadScript("powerpoint-editor-intl").then(()=>{this.N$b=!0}).catch(Ec=>{za.a.J(528053592,801,10,"Failed to load powerpoint-editor-intl "+Ec.toString())});this.ob=a;this.Rb=b;this.ia=c;this.Ga=f;this.yh=w;this.zd=F;this.Xc=S;this.yh.xM(Object(C.a)(this,this.GVa,"onChangeRenderFormatTablePane"));this.yh.IMa(Object(C.a)(this,this.GVa,"onChangeRenderFormatTablePane"));
this.Xc.E2a(Object(C.a)(this,this.GVa,"onChangeRenderFormatTablePane"));this.zd.LMa(Object(C.a)(this,this.GVa,"onChangeRenderFormatTablePane"));this.Rb.aP(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched"));this.lF=kc;this.uua=hc;this.wc=Mb}dispose(){this.yh.H9(Object(C.a)(this,this.GVa,"onChangeRenderFormatTablePane"));this.yh.heb(Object(C.a)(this,this.GVa,"onChangeRenderFormatTablePane"));this.Xc.rEb(Object(C.a)(this,this.GVa,"onChangeRenderFormatTablePane"));this.zd.sEb(Object(C.a)(this,this.GVa,
"onChangeRenderFormatTablePane"));this.Rb.Q_(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched"))}wb(){this.ia.ra(aa.a.bLe,$b.a.application,Object(C.a)(this,this.bLe,"showHideReactFormatTablePane"),4);this.ia.ra(aa.a.Ead,$b.a.application,Object(C.a)(this,this.Ead,"queryReactFormatTablePane"),96)}Fe(){}GVa(){this.Sb&&this.kn(!0)}Mx(a){1===a.mode&&this.Sb&&(this.Sb=!1,this.Pu(),this.Ga.Kj(Xd.a.JIa,this.Sb))}Ead(a,b,c,f,l){(a=Object(ua.a)(Kh.a,l))&&a.Yf(this.Sb);return 32}bLe(a,b,c){if(!this.N$b)return 8;
b=this.ob.mg();if(1===c)return b.length?32:8;this.Sb=!this.Sb;return ug.b("FormatTablePaneActor::ShowHideFormatTablePane PaneOpen: ",this.Sb.toString(),a,()=>{this.Sb?this.kn():this.Pu();return 32})}kn(a=!1){const b=this.OE(),c=Object.assign(new bu.a,{title:ResourceStrings.L_FormatTable,hideHeader:!1,width:this.Oei,location:2,contentProps:b,onOpen:()=>{za.a.J(538306245,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now visible")},onClose:()=>{this.Sb=!1;za.a.J(538306246,833,50,
"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now hidden")},isModernPane:!0});lj.UISurfaces.du().then(f=>{a?f.updateTaskPane(Xd.a.JIa,c):f.showTaskPane(Xd.a.JIa,c);return null}).catch(f=>{za.a.J(538306247,822,10,"FormatTablePaneActor::ShowPane, Failed to show format table pane. Exception: "+f.toString())})}Pu(){lj.UISurfaces.du().then(a=>{a.hideTaskPane(Xd.a.JIa,2);return null}).catch(a=>{za.a.J(538306248,822,10,"FormatTablePaneActor::HidePane, Failed to hide format table pane. Exception: "+
a.toString())})}OE(){var a=this.ob.Mo();const b=new FM;if(!a)return a=new Xz(b,0,0,0,0,!0,255),this.OHe(a);let c=0,f=0;({cellHeight:c,cellWidth:f}=this.x8i(a,c,f));const l=ke.a.kv(this.wc.j1d(a)),w=ke.a.kv(this.wc.l1d(a));let F=this.ob.jy();F&&F.length||(F=this.wc.PE(a));if(!F||!F.length)return a=new Xz(b,c,f,l,w,!0,255),this.OHe(a);this.w8i(F,b);a=new Xz(b,c,f,l,w,!1,0);this.OHe(a);this.$sl(a);return a}OHe(a){a.onChange=Object(C.a)(this,this.cva,"onPropertyChange");a.isAspectRatioLocked=this.qta;
a.onToggleAspectRatio=Object(C.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");return a}x8i(a,b,c){let f=this.ob.UMc(),l=this.ob.wsb();f&&f.length||(f=this.wc.fia(a));l&&l.length||(l=this.Dsb(a));f.length&&(b=ke.a.kv(this.uua.i7f(f)));l.length&&(c=ke.a.kv(this.lF.k7f(a,l)));return{cellHeight:b,cellWidth:c}}w8i(a,b){let c=!0,f=!0,l=!0,w=!0;for(const F of a)F&&!F.isGhostCell&&({$Qc:c,nCc:b.leftMargin,I$c:b.n5g}=this.old(c,b.leftMargin,F.marginLeft,b.n5g),{$Qc:f,nCc:b.rightMargin,I$c:b.o5g}=
this.old(f,b.rightMargin,F.marginRight,b.o5g),{$Qc:l,nCc:b.topMargin,I$c:b.p5g}=this.old(l,b.topMargin,F.marginTop,b.p5g),{$Qc:w,nCc:b.bottomMargin,I$c:b.m5g}=this.old(w,b.bottomMargin,F.marginBottom,b.m5g))}old(a,b,c,f){a&&(b=ke.a.kv(c),0<=f&&f!==b&&(b=-1,a=!1),f=b);return{$Qc:a,nCc:b,I$c:f}}$sl(a){0>a.cellHeight&&(a.emptyValueFields|=1);0>a.cellWidth&&(a.emptyValueFields|=2);0>a.leftMargin&&(a.emptyValueFields|=16);0>a.rightMargin&&(a.emptyValueFields|=32);0>a.topMargin&&(a.emptyValueFields|=64);
0>a.bottomMargin&&(a.emptyValueFields|=128)}cva(a,b){const c={};c.Number=a;switch(b){case 0:this.ia.Ma(aa.a.yfb,2,c);break;case 1:this.ia.Ma(aa.a.IXa,2,c);break;case 2:this.ia.Ma(aa.a.mwa,2,c);break;case 3:this.ia.Ma(aa.a.JXa,2,c);break;case 4:this.ia.Ma(aa.a.qlc,2,c);break;case 5:this.ia.Ma(aa.a.rlc,2,c);break;case 6:this.ia.Ma(aa.a.slc,2,c);break;case 7:this.ia.Ma(aa.a.plc,2,c)}}onToggleAspectRatio(a){this.qta=a;this.ia.Ma(aa.a.Jfd,2,null)}Dsb(a){let b=null;a&&14===a.type&&(b=this.wc.h1d(a.firstRow));
return b}}Object(e.a)(GM,"FormatTablePaneActor",null,[109,234]);class Yz{constructor(a,b,c){this.sa=a;this.Pb=b;this.Fa=c}process(a,b,c,f){2===c&&32===f&&b.contextId===Db.a.view&&Array.contains(Yz.jUk,a)&&(a=this.sa.he(),0<a.length&&0<this.Fa.textLength(a[0])&&this.Zii(a[0]))}Zii(a){if(!a.r9){var b=fd.SelectionFactory.$k(a);b=Cb.SelectionEditor.SYb(b);var c=Cb.SelectionEditor.RYb(b,!1);b=fd.SelectionFactory.SM(b,c.Wa,!1);if((c=this.sa.Pa)&&c.kb&&c.kb.contains(b)&&2===a.Sy){var f=Object(ua.a)(133,
a.pc(this.Pb.Na));if(f){b=a.Sy;c=a.i0;var l=a.j0;a.Sy=1;a.i0=1;a.j0=0;f=f.kZf();f.dHf();f.jGf();f.xxa();f.z0f()&&(a.Sy=b,a.i0=c,a.j0=l);f.detach();f.ARe()}}}}}Yz.jUk=[D.a.rr,D.a.XH,D.a.gJ];Object(e.a)(Yz,"FormattingViewOperationFinishedStageProcessor",null,[354]);var MQ=d(607);class HM extends Sys.EventArgs{constructor(a){super();this.section=a}}Object(e.a)(HM,"SectionNodeChangedArgs",Sys.EventArgs,[]);class IM{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.eQ=null;this.Et=a;this.Jb=b;this.Wb=c;
this.sa=f;this.Ga=l;this.la=S;this.Op=this.la.vz;this.Je=F;this.MEa=this.la.U9d;this.Ub=w;this.I1j=this.la.R4b;this.Zb=fa;this.Tv=xa;this.ua=Za;this.Pb=pb;Mb.execute(hc=>{this.eQ=hc})}JLi(a,b,c){if(a&&a.length){for(var f of a)if(!f||Rd.a.DA(f.Cb))return;f=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Pb&&1===this.Pb.Aw;var l=this.Jb.xd(15,void 0,()=>{this.Ga.vf(Ai.a.zB);this.sa.Rh()});try{l.lc(this.Et),this.MEa?this.Et.ise(a,b,c,f):this.Et.hse(a[0],b,c,f)}finally{l&&l.dispose()}}}H_f(a,
b){var c=this.Ub.un;if(c&&c.xp)if(b&&!a||!b&&a===c.xp.length-1)za.a.J(50856009,822,50,"ExecuteMoveSectionGraphTransaction: User has attempted to move a section out of range.");else{var f=c.xp,l=Date.now(),w=this.Jb.xd(15,void 0,()=>{},()=>{});try{w.lc(this.Et);const F=f[a],S=b?f[a-1]:f[a+1];c.setValue(zb.a.ubk,F);c.setValue(zb.a.$ak,S);if(F&&S){let fa=-1,xa=-1;for(let Za=0;Za<f.length&&!(F===f[Za]&&(fa=Za),S===f[Za]&&(xa=Za),0<=fa&&0<=xa);Za++);Array.removeAt(f,fa);Array.insert(f,xa,F);c.anchor?c.anchor.xgb(f,
34,!1):za.a.J(50856011,822,10,"ExecuteMoveSectionGraphTransaction: Presentation node should have valid anchor.")}}finally{w&&w.dispose()}this.ua.qA=b?0<=a-1?a-1:0:a+1;c=Date.now();za.a.J(50954449,822,50,"ExecuteMoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, isMoveUp: {4}",a,l,c,c-l,b);this.Tv?this.Tv.FBe():za.a.J(51172825,822,10,"ExecuteMoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else za.a.J(50856007,
808,10,"ExecuteMoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}uLi(a,b){if(a){var c=this.Ub.un;if(c){var f=c.xp;f&&f.length||za.a.J(50676770,822,50,"ExecuteAddSectionGraphTransaction: User has added first section.");c=Date.now();var l=this.Jb.xd(15,void 0,()=>{},()=>{});try{l.lc(this.Et);l.fd=b;const w=f&&f.length?this.Je.r2(a.Cb):0;this.Et.ymb(a,w)}finally{l&&l.dispose()}this.Zb.xw(this.Et,b);b=Date.now();za.a.J(50954454,822,50,"ExecuteAddSectionGraphTransaction: selectedSlideIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}",
a.slideIndex,c,b,b-c);this.Tv?this.Tv.FBe():za.a.J(51172831,822,10,"ExecuteAddSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else za.a.J(50676768,808,10,"ExecuteAddSectionGraphTransaction: pageManifest is null.")}else za.a.J(50676766,808,10,"ExecuteAddSectionGraphTransaction: selectedSlideNode is null.")}ULi(a){var b=this.Ub.un;if(b&&b.xp){var c=b.xp;if(!a||a.sectionIndex>=c.length)za.a.J(50647325,808,10,"ExecuteUpdateSectionGraphTransaction: invalid .");else{var f=
b.lcg(a.sectionIndex);c=null;f&&(c=Object(ua.a)(MQ.a,b.q$i(f.uF)));b=Date.now();f=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()},()=>{});try{f.lc(c),c.title=a.Ful}finally{f&&f.dispose()}c=Date.now();za.a.J(50954458,822,50,"ExecuteUpdateSectionGraphTransaction: updateSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, ",a.sectionIndex,b,c,c-b)}}else za.a.J(50647323,808,10,"ExecuteUpdateSectionGraphTransaction: pageManifest or SectionNodes are null.")}NLi(a,
b){const c=this.Ub.un;if(c&&c.xp){var f=c.xp,l=this.ua.taa,w=Date.now(),F=f.length,S=this.Jb.xd(15,void 0,()=>{},()=>{});try{S.lc(this.Et);S.fd=b;if(a){const fa=this.Ub.vsb(a-1);let xa=l.bA;if(fa&&xa){const Za=fa.bA?fa.bA:[];for(let pb=0;pb<xa.length;pb++)Array.insert(Za,Za.length,xa[pb]);xa=[];fa.bA=Za}}Array.removeAt(f,a);c.FUf(l)}finally{S&&S.dispose()}this.ua.qA=0<=a-1?a-1:0;this.Zb.xw(this.Et,b);b=Date.now();za.a.J(50954461,822,50,"ExecuteRemoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, initialSectionArrayLength: {4}, finialSectionArrayLength: {5}",
a,w,b,b-w,F,f.length);this.Tv?this.Tv.oDk(new HM(l)):za.a.J(51172866,822,10,"ExecuteRemoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else za.a.J(50689950,808,10,"ExecuteRemoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}eIc(a,b,c,f){if(!b||!this.I1j&&!c)return null;let l=null;const w=this.Jb.xd(15,void 0,()=>{qd.a("FixDocumentFocusIssue")||this.Ga.Bd();this.sa.Rh()},()=>{1!==this.Pb.Aw&&(qd.a("FixDocumentFocusIssue")?this.Ga.vf(this.Ga.ye.name):
this.Ga.vf(Ai.a.zB))});try{const F=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Pb&&1===this.Pb.Aw;let S;S=qd.a("SlideSorterInsertionAfterFirstSlide")?!!this.Pb&&1===this.Pb.Aw&&-1===this.Wb.MCb:!!this.Pb&&1===this.Pb.Aw&&!this.Wb.MCb;const fa=this.ua.taa;if(F&&fa&&(!fa.NL||!fa.NL.length)||S)S&&(this.Wb.MCb=-1),a=null;w.lc(this.Wb.Bf);w.fd=f;l=Object(ua.a)(132,this.Et.ezc(a,fa,b,c,F));this.Op&&this.sa.tX(l);this.Wb.Ca=l;this.Wb.Bf.removeProperty(zb.a.cxe)}finally{w&&w.dispose()}return l}ILi(a,
b,c,f,l){if(5!==f)throw Error.invalidOperation();const w=Object(ua.a)(132,this.Et.hPd(a,b,c));if(!w)return za.a.J(51676491,822,10,"CreateSlideNodeForInsertion returned null"),null;b=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Pb&&1===this.Pb.Aw;c=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()},()=>{this.Op&&this.sa.tX(w);this.Ga.vf(Ai.a.zB)});try{c.lc(this.Wb.Bf),c.fd=l,this.Et.Dtb(w,a,null,b),this.Wb.Ca=w}finally{c&&c.dispose()}return w}ELi(a,b){var c=null;if(!a)throw Error.argumentNull("srcSlideNode");
c||(c=a);const f=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Pb&&1===this.Pb.Aw;let l=null;const w=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()},()=>{1!==this.Pb.Aw&&this.Ga.vf(Ai.a.zB)});try{w.lc(this.Wb.Bf),w.fd=b,l=Object(ua.a)(132,this.Et.YR(Object(ua.a)(131,a),Object(ua.a)(131,c),f,!0)),this.eQ&&this.eQ.nVf([l]),this.Op&&this.sa.tX(l),this.Wb.Ca=l}finally{w&&w.dispose()}return l}D_f(a,b,c,f,l){if(!a||!a.length)throw Error.argumentNull("srcSlideNodes");const w=[];a=Array.clone(a);
a.sort((fa,xa)=>xa.Ge-fa.Ge);c||(c=a[0]);const F=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Pb&&1===this.Pb.Aw,S=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()},()=>{1!==this.Pb.Aw&&this.Ga.vf(Ai.a.zB)});try{S.lc(this.Wb.Bf);S.fd=b;for(b=0;b<a.length;b++){if(!a[b])continue;const xa=Object(ua.a)(132,this.Et.YR(Object(ua.a)(131,a[b]),Object(ua.a)(131,c),F,l));Ja.a.Xa(f)||(xa.Tb=f);Array.add(w,xa)}0<w.length&&this.eQ&&this.eQ.nVf(w);let fa;(fa=this.sa).tX.apply(fa,w);this.Wb.Ca=
w[w.length-1];this.Je.tqb=!0}finally{S&&S.dispose()}return w}X1(a,b,c,f=null,l=null,w=!0){if(!a)throw Error.argumentNull("shapeNodes");if(!a.length)throw Error.argumentOutOfRange("shapeNodes.Length",a.length);if(!b)throw Error.argumentNull("slideNode");if(f&&a.length!==f.length)throw Error.invalidOperation();let F=null;w&&1!==this.Pb.Aw&&(F=()=>{this.sa.mXa(a,!0)});w=this.Jb.xd(15,void 0,()=>{this.sa.gy();this.sa.Rh();this.Ga.Bd()},F);try{w.lc(b);w.fd=c;this.F0h(w,a);const S=new Sys.StringBuilder;
for(c=0;c<a.length;c++){const fa=f?f[c]:null;a[c]&&(b.uB(a[c],fa),a[c].id&&S.append(a[c].id.toString()+";"))}w.iy[wq.a.R2g]=S.toString();l&&b.xT([l])}finally{w&&w.dispose()}}F0h(a,b){if(1!==b.length||!b[0].rd&&Ja.a.Xa(b[0].aWa))for(const c of b){if(c.w8a||c.sk)a.iy[wq.a.s1b]=!0;if(c.hq||2===c.mediaType||1===c.mediaType)a.iy[wq.a.JOc]=!0;c.Gq&&(a.iy[wq.a.IOc]=!0)}else a.iy[wq.a.t1b]=!0}S4a(a,b){if(!(1>b.length)){var c=this.Jb.xd(15);try{c.lc(b[0]);const f=this.sa.iO(Array.isArray(b)?b:null);for(const l of f)a(l)}finally{c&&
c.dispose()}}}Cha(a,b){this.S4a(c=>{(c=Object(ua.a)(4,c))&&a(c)},b)}}Object(e.a)(IM,"GraphTransactionHelperProxy",null,[319]);var Zz=d(293),oo=d(294);class JM{constructor(a,b,c,f){this.Aic=a;this.Bic=b;this.yUc=c;this.zUc=f}ASe(a,b,c,f){a<this.Aic&&(this.Aic=a);b<this.Bic&&(this.Bic=b);a+c>this.yUc&&(this.yUc=a+c);b+f>this.zUc&&(this.zUc=b+f)}}Object(e.a)(JM,"GroupShapeOffset",null,[]);class KM{constructor(a,b,c,f,l,w,F,S,fa,xa){this.ia=a;this.Jb=b;this.sa=c;this.Fa=f;this.ua=l;this.rm=w;this.Pb=
F;this.Qj=S;this.uI=fa;this.la=xa}wb(){this.ia.ra(aa.a.q4g,$b.a.application,Object(C.a)(this,this.wjj,"handleGroupShapes"),4);this.ia.ra(aa.a.x4g,$b.a.application,Object(C.a)(this,this.Fnj,"handleUngroupShapes"),4);this.ia.ra(aa.a.Quk,$b.a.application,Object(C.a)(this,this.vjj,"handleGroupFlyoutAnchor"),4)}Fe(){const a=this.uI.Wn.Bc(Xd.a.sg);a.bindAction(A.KeyInputManager.La(x.a.LJb,A.KeyInputManager.He),aa.a.q4g);a.bindAction(A.KeyInputManager.La(x.a.LJb,A.KeyInputManager.He|4),aa.a.x4g)}tKf(a){let b=
1<a.length&&!a[0].xh&&!a[1].xh;if(b)for(const c of a)if(this.la.kia){if(c.tBb||c.ll||c.rd){b=!1;break}}else if(c.ll||c.rd){b=!1;break}return b}p6i(a){a=a.get_shapeRotation()%180;0<=a&&45>a?a=0:45<=a&&135>a?a=90:135<=a&&180>a&&(a=0);return a}wjj(a,b,c){const f=this.sa.he();return this.tKf(f)?1===c?32:ug.a("GroupOperations_GroupShapes",a,()=>{const l=[];for(var w of f)l.push(w.id);w=Object(ua.a)(132,this.ua.Ca);if(!w)throw Error.argumentNull("ActiveSlide is null");const F=w.Mu(),S=new JM(w.Up,w.Gk,
0,0);var fa=0;let xa=fa=0;for(var Za of f)(fa=this.p6i(Za),Za.ty)?(fa=Za.My,xa=Za.Ny,S.ASe(fa,xa,Za.eba,Za.dba)):fa?90===fa&&(fa=Za.My+Za.Bx/2-Za.qD/2,xa=Za.Ny+Za.qD/2-Za.Bx/2,S.ASe(fa,xa,Za.qD,Za.Bx)):(fa=Za.My,xa=Za.Ny,S.ASe(fa,xa,Za.Bx,Za.qD));const pb=this.rm.b4a(!1,w.Cb.cid,w.Cb.sid,0,10,S.Aic,S.Bic,S.yUc-S.Aic,S.zUc-S.Bic,F+1);za.a.J(595359714,822,50,"GroupUngroupShapesActor::HandleGroupShapes : Group Action performed on {0}",f.length);this.Gxj(pb,w.Cb,S.yUc-S.Aic,S.zUc-S.Bic);w.uB(pb);Za=this.Jb.xd(15,
void 0,void 0,()=>{this.sa.selectShape(pb,!0)});try{Za.lc(w),Za.fd=a,1<l.length&&(w.j7=l)}finally{Za&&Za.dispose()}return 32}):8}IKf(a){for(const b of a)if(this.la.kia){if(b.Xf&&!b.uBb)return!0}else if(b.Xf)return!0;return!1}Fnj(a,b,c){const f=this.sa.he();return this.IKf(f)?1===c?32:ug.a("GroupOperations_UngroupShapes",a,()=>{const l=[];var w=[];for(const S of f)if(S.Xf){l.push(S.id);const fa=this.Fa.my(S);for(const xa of fa)w.push(xa);this.sa.I6(S)}for(var F of w)w=ng.c(F,this.Pb.Na),this.sa.I6(F),
w.pia(),w.fFb=!0;F=this.ua.Ca;za.a.J(595359712,822,50,"GroupUngroupShapesActor::HandleUngroupShapes : Ungroup Action performed on {0}",f.length);w=this.Jb.xd(15);try{w.lc(F),w.fd=a,F.hna=l}finally{w&&w.dispose()}return 32}):8}vjj(a,b,c){b=this.sa.he();a=this.tKf(b);b=this.IKf(b);return 1===c?a||b?32:8:32}Gxj(a,b,c,f){var l=Object(ua.a)(316,Object(ua.a)(132,this.ua.Ca).yg(this.Pb.Na));const w=this.Pb.Ed,F=Math.round(this.Qj.OL(w.Ie(c,0),l.wV));l=Math.round(this.Qj.OL(w.Ie(f,1),l.wV));a.setValue(ob.a.Bx,
c);a.setValue(ob.a.qD,f);a.setValue(zb.a.widthPersisted,c);a.setValue(zb.a.heightPersisted,f);a.isEditable=!0;a.Xf=!0;a.setValue(zb.a.HR,4);a.setValue(zb.a.Kcd,!0);a.eba=fe.a.WGa(F,0);a.dba=fe.a.WGa(l,1);a.setValue(zb.a.yOa,0);a.setValue(zb.a.zOa,0);a.setValue(zb.a.CRa,!0);a.setValue(zb.a.isResizable,!0);a.setValue(zb.a.DK,!0);a.iN=!0;a.wRa=!0;a.DK=!0;a.isResizable=!0;a.QL=Rd.a.XD(b.sid,b.cid);a.igb=a.get_shapeId();a.setValue(zb.a.Wra,!0);b=Object.assign(new Zz.a,{TopLeft:Object.assign(new oo.a,{X:0,
Y:0}),TopRight:Object.assign(new oo.a,{X:F,Y:0}),BottomLeft:Object.assign(new oo.a,{X:0,Y:l}),BottomRight:Object.assign(new oo.a,{X:F,Y:l})});a.BT=b;this.Fa.EK(a)&&Kc.a.Db&&(Kc.a.Db.Nj=!0)}}Object(e.a)(KM,"GroupUngroupShapesActor",null,[234]);class LM{constructor(){this.isFooterInsert=this.omitOnTitle=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.isSlideNumInsert=!1}}Object(e.a)(LM,"FooterPaneInfo",null,[]);var MM=d(606);class AE{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=
0;this.IsToggled=this.IsSlideNumInsert=this.IsOmitOnTitlePh=this.IsFooterInsert=!1;this.SFooterName=null}}Object(e.a)(AE,"PresFooterInfo",null,[]);var NM=d(631);class OM{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.Yja=null;a("powerpoint-editor-intl").then(()=>{za.a.J(594321887,801,50,"Icons and strings script is loaded successfully");a("headerFooterManager").then(()=>{za.a.J(594321885,801,50,"Header Footer Pane Manager script is loaded successfully");this.Yja=headerFooterManager.FactoryGlobal.getHeaderFooterManagerInstance();
this.QIk()}).catch(hc=>{za.a.J(594321883,801,10,"Failed to load headerfooter pane manager "+hc.toString())})}).catch(hc=>{za.a.J(594321881,801,10,"Failed to load powerpoint-editor-intl "+hc.toString())});this.ob=b;this.Rb=c;this.ia=f;this.Wb=l;this.ua=w;this.Ga=F;this.Wu=S;this.yh=fa;this.zd=xa;this.Xc=Za;this.Jb=pb;this.yh.xM(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.yh.Jmb(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.yh.IMa(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));
this.Xc.E2a(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.zd.LMa(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.Rb.aP(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched"));this.By=null;this.Byb=!1;this.Qzb=Mb}dispose(){this.yh.H9(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.yh.Hcd(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.yh.heb(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.Xc.rEb(Object(C.a)(this,this.LI,
"onChangeRenderHeaderFooterPane"));this.zd.sEb(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.Rb.Q_(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched"))}Fe(){}wb(){this.ia.ra(aa.a.Atb,$b.a.application,Object(C.a)(this,this.Atb,"insertFooterFlyoutMenu"),4);this.ia.ra(aa.a.h0,$b.a.application,Object(C.a)(this,this.h0,"showHideHeaderFooterPane"),4);this.ia.ra(aa.a.H7a,$b.a.application,Object(C.a)(this,this.H7a,"insertSlideNumber"),4);this.ia.ra(aa.a.jad,$b.a.application,Object(C.a)(this,
this.jad,"queryHeaderFooterPane"),96)}jad(a,b,c,f,l){(a=Object(ua.a)(Kh.a,l))&&a.Yf(this.Wu.isVisible);return 32}Atb(){return this.Yja&&this.Wb&&this.ua.Ca&&this.Wb.isEditingAllowed?32:8}h0(a,b,c){if(1===c)return this.Wu&&this.ua.Ca?32:8;if(!this.Wu)return 8;this.By=null;this.Wu.isVisible=!this.Wu.isVisible;this.Wu.isVisible?(ug.a("FooterPaneOpen",a,()=>{this.Lhc();return 32}),this.Qzb||(this.Ga.Kj(Xd.a.tK,!0),this.Yja.focus())):this.Ga.Kj(Xd.a.tK,!1);return 32}H7a(a,b,c,f,l){return 1===c?this.ua.Ca?
32:8:ug.a("FooterPaneInsertSldNumber",a,()=>{const w=this.Dec();this.fnc(w.OmitOnTitlePh,w.IsFooterInsert,w.SFooterName,!0);return this.h0(a,b,c,f,l)})}Mx(a){1===a.mode&&this.Wu&&this.Wu.isVisible&&(this.By=null,this.Wu.isVisible=!1,this.Ga.Kj(Xd.a.tK,!1))}x_d(a){const b=new Ua.a;a=a.hD();for(const c of a)(a=db.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}Dec(){const a=new MM.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ca;if(!b)return a;
if((b=b.km(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.ll&&(5===c.zj?a.IsSlideNumInsert=!0:6===c.zj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.FA?this.x_d(c):"",0<b.length?a.SFooterName=b:za.a.J(594321879,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Wb.Bf.yGa;return a}isMultipleSlidesSelected(){const a=this.ob.rf();return a&&1<a.length?!0:!1}Lhc(){if(this.Wu.isVisible)if(this.ua.Ca){var a=this.Dec(),b=this.isMultipleSlidesSelected();if(!this.By||a.IsFooterInsert!==this.By.IsFooterInsert||
a.IsSlideNumInsert!==this.By.IsSlideNumInsert||a.OmitOnTitlePh!==this.By.OmitOnTitlePh||a.SFooterName.localeCompare(this.By.SFooterName)||b!==this.Byb){this.By=a;this.Byb=b;var c=new LM;c.isFooterInsert=a.IsFooterInsert;c.isSlideNumInsert=a.IsSlideNumInsert;c.sFooterName=a.SFooterName;c.omitOnTitle=a.OmitOnTitlePh;c.isMultipleSlidesSelected=b;this.Yja.renderHeaderFooterTaskPane(NM.a.s4d,c)}}else this.Wu.isVisible=!1,this.By=null}LI(){this.Lhc()}QIk(){this.Yja.addCloseHeaderFooterPaneEventListener(()=>
{this.Wu.isVisible=!1;this.By=null});this.Yja.addFocusHeaderFooterPaneListener(()=>{this.Ga.Kj(Xd.a.tK,!0)});this.Yja.addUpdateHeaderFooterListener((a,b,c,f,l)=>{this.kSe(a,b,c,f,l)});this.Yja.addUpdateMultiSlideHeaderFooterListener((a,b,c,f)=>{this.xSe(a,b,c,f)})}kSe(a,b,c,f,l){this.ua.Ca&&(l?this.ISe(a,b,c,f):this.fnc(a,b,c,f))}xSe(a,b,c,f){this.ua.Ca&&ug.a("FooterPaneMultiSlide",aa.a.h0,()=>{const l=this.Jb.xd(15,void 0,()=>{this.ob.fj()});try{l.lc(this.ua.Ca);const w=this.ob.rf();if(w&&1<w.length){for(const F of w){const S=
F.R6;S.IsSlideNumInsert=f;S.IsFooterInsert=b;S.OmitOnTitlePh=a;S.SFooterName=c;S.IsToggled=!S.IsToggled;F.R6=S}this.Wb.Bf.yGa=a}}finally{l&&l.dispose()}return 32})}fnc(a,b,c,f){let l="FooterPaneSingleSlide";const w=this.ua.Ca,F=w.R6;if(a||b||f)F.OmitOnTitlePh!==a?l+="_OPH":F.IsSlideNumInsert!==f?l+="_ISN":F.IsFooterInsert!==b&&(l+="_IFT");ug.a(l,aa.a.h0,()=>{const S=this.Jb.xd(15,void 0,()=>{this.ob.fj()});try{S.lc(this.ua.Ca),F.IsSlideNumInsert=f,F.IsFooterInsert=b,F.OmitOnTitlePh=a,F.SFooterName=
c,F.IsToggled=!F.IsToggled,this.Wb.Bf.yGa=a,w.R6=F}finally{S&&S.dispose()}return 32})}ISe(a,b,c,f){ug.a("FooterPaneAllSlides",aa.a.h0,()=>{const l=this.Jb.xd(15,void 0,()=>{this.ob.fj()});try{const w=this.Wb.Bf;l.lc(w);let F=w.cHa;F||(F=new AE);const S=this.ua.Ca;F.ActiveSlideCid=S.cid;F.ActiveSlideSid=S.sid;F.IsSlideNumInsert=f;F.IsFooterInsert=b;F.IsOmitOnTitlePh=a;F.SFooterName=c;F.IsToggled=!F.IsToggled;w.yGa=a;w.cHa=F}finally{l&&l.dispose()}return 32})}}Object(e.a)(OM,"HeaderFooterPaneActor",
null,[234]);class PM{constructor(){this.isFooterInsert=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.omitOnTitle=this.isSlideNumInsert=!1}}Object(e.a)(PM,"FooterPaneInfo",null,[]);class QM{constructor(){this.type="HeaderFooterContentProps";this.onFocusPane=this.onUpdateMultiSlideHeaderFooter=this.onUpdateHeaderFooter=this.activeSlideFooterInfo=null}}Object(e.a)(QM,"HeaderFooterContentProps",null,[]);class RM{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.eZc=!1;Mb?this.eZc=!0:a("powerpoint-editor-intl").then(()=>
{za.a.J(590210325,801,50,"Icons and strings script is loaded successfully");a("powerpoint-ribbon-intl").then(()=>{za.a.J(590210323,801,50,"Ribbon script is loaded successfully");a("taskPanes").then(()=>{za.a.J(590210321,801,50,"Header Footer Pane script is loaded successfully");this.eZc=!0}).catch(()=>{za.a.J(590210319,801,10,"Failed to load Header Footer Pane script")})}).catch(()=>{za.a.J(590210317,801,10,"Failed to load Ribbon script")})}).catch(hc=>{za.a.J(590210315,801,10,"Failed to load powerpoint-editor-intl "+
hc.toString())});this.ob=b;this.Rb=c;this.ia=f;this.Wb=l;this.ua=w;this.Wu=S;this.yh=fa;this.zd=xa;this.Xc=Za;this.Jb=pb;this.yh.xM(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.yh.Jmb(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.yh.IMa(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.Xc.E2a(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.zd.LMa(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.Rb.aP(Object(C.a)(this,
this.Mx,"onAppFrameModeSwitched"));this.By=null;this.Byb=!1;this.Qzb=Mb}dispose(){this.yh.H9(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.yh.Hcd(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.yh.heb(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.Xc.rEb(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.zd.sEb(Object(C.a)(this,this.LI,"onChangeRenderHeaderFooterPane"));this.Rb.Q_(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched"))}Fe(){}wb(){this.ia.ra(aa.a.Atb,
$b.a.application,Object(C.a)(this,this.Atb,"insertFooterFlyoutMenu"),4);this.ia.ra(aa.a.h0,$b.a.application,Object(C.a)(this,this.h0,"showHideHeaderFooterPane"),4);this.ia.ra(aa.a.H7a,$b.a.application,Object(C.a)(this,this.H7a,"insertSlideNumber"),4)}Atb(){return this.Wb&&this.ua.Ca&&this.Wb.isEditingAllowed?32:8}h0(a,b,c){if(1===c)return this.eZc?32:8;if(!this.Wu)return 8;this.By=null;this.Wu.isVisible=!this.Wu.isVisible;this.Wu.isVisible?ug.a("WACFooterPaneOpen:: IsTabbedPaneEnabled: "+this.Qzb.toString(),
a,()=>{this.Lhc();return 32}):this.Pu();return 32}Mx(a){1===a.mode&&this.Wu&&this.Wu.isVisible&&(this.By=null,this.Wu.isVisible=!1,this.Pu())}kn(a=!1){const b=this.OE(),c=Object.assign(new bu.a,{title:ResourceStrings.l_InsertFooter,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Wu.isVisible=!1},isModernPane:!0});this.Qzb?lj.UISurfaces.du().then(f=>{a?f.updateTaskPane(Xd.a.tK,c):f.showTaskPane(Xd.a.tK,c);return null}):(this.Wu.isVisible=!0,taskPanes.taskPane.renderTaskPane(NM.a.s4d,
c))}Pu(){this.Qzb&&lj.UISurfaces.du().then(a=>{a.hideTaskPane(Xd.a.tK,2);return null})}OE(){const a=new PM;a.isFooterInsert=this.By.IsFooterInsert;a.sFooterName=this.By.SFooterName;a.isSlideNumInsert=this.By.IsSlideNumInsert;a.omitOnTitle=this.By.OmitOnTitlePh;a.isMultipleSlidesSelected=this.Byb;const b=new QM;b.activeSlideFooterInfo=a;b.onUpdateHeaderFooter=Object(C.a)(this,this.kSe,"updateFooterInfo");b.onUpdateMultiSlideHeaderFooter=Object(C.a)(this,this.xSe,"updateMultiSlidesFooterInfo");return b}H7a(a,
b,c,f,l){return 1===c?this.eZc?32:8:ug.a("WACFooterPaneInsertSldNumber:: IsTabbedPaneEnabled: "+this.Qzb.toString(),a,()=>{const w=this.Dec();this.fnc(w.OmitOnTitlePh,w.IsFooterInsert,w.SFooterName,!0);return this.h0(a,b,c,f,l)})}x_d(a){const b=new Ua.a;a=a.hD();for(const c of a)(a=db.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}Dec(){const a=new MM.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ca;if(!b)return a;if((b=b.km(!0))&&0<b.length)for(const c of b)!c.isLocal&&
c.ll&&(5===c.zj?a.IsSlideNumInsert=!0:6===c.zj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.FA?this.x_d(c):"",0<b.length?a.SFooterName=b:za.a.J(590210313,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Wb.Bf.yGa;return a}isMultipleSlidesSelected(){const a=this.ob.rf();return a&&1<a.length?!0:!1}Lhc(a=!1){if(this.Wu.isVisible)if(this.ua.Ca){var b=this.Dec(),c=this.isMultipleSlidesSelected();if(!this.By||b.IsFooterInsert!==this.By.IsFooterInsert||b.IsSlideNumInsert!==this.By.IsSlideNumInsert||b.OmitOnTitlePh!==
this.By.OmitOnTitlePh||b.SFooterName.localeCompare(this.By.SFooterName)||c!==this.Byb)this.By=b,this.Byb=c,this.kn(a)}else this.Wu.isVisible=!1,this.By=null}LI(){this.Lhc(!0)}kSe(a,b,c,f,l){this.ua.Ca&&(f?this.ISe(a,b,l,c):this.fnc(a,b,l,c))}xSe(a,b,c,f){this.ua.Ca&&ug.a("FooterPaneMultiSlide",aa.a.h0,()=>{const l=this.Jb.xd(15,void 0,()=>{this.ob.fj()});try{l.lc(this.ua.Ca);const w=this.ob.rf();if(w&&1<w.length){for(const F of w){const S=F.R6;S.IsSlideNumInsert=c;S.IsFooterInsert=b;S.OmitOnTitlePh=
a;S.SFooterName=f;S.IsToggled=!S.IsToggled;F.R6=S}this.Wb.Bf.yGa=a}}finally{l&&l.dispose()}return 32})}fnc(a,b,c,f){let l="FooterPaneSingleSlide";const w=this.ua.Ca,F=w.R6;if(a||b||f)F.OmitOnTitlePh!==a?l+="_OPH":F.IsSlideNumInsert!==f?l+="_ISN":F.IsFooterInsert!==b&&(l+="_IFT");ug.a(l,aa.a.h0,()=>{const S=this.Jb.xd(15,void 0,()=>{this.ob.fj()});try{S.lc(this.ua.Ca),F.IsSlideNumInsert=f,F.IsFooterInsert=b,F.OmitOnTitlePh=a,F.SFooterName=c,F.IsToggled=!F.IsToggled,this.Wb.Bf.yGa=a,w.R6=F}finally{S&&
S.dispose()}return 32})}ISe(a,b,c,f){ug.a("FooterPaneAllSlides",aa.a.h0,()=>{const l=this.Jb.xd(15,void 0,()=>{this.ob.fj()});try{const w=this.Wb.Bf;l.lc(w);let F=w.cHa;F||(F=new AE);const S=this.ua.Ca;F.ActiveSlideCid=S.cid;F.ActiveSlideSid=S.sid;F.IsSlideNumInsert=f;F.IsFooterInsert=b;F.IsOmitOnTitlePh=a;F.SFooterName=c;F.IsToggled=!F.IsToggled;w.yGa=a;w.cHa=F}finally{l&&l.dispose()}return 32})}}Object(e.a)(RM,"HeaderFooterPaneWacActor",null,[234]);class SM{constructor(a,b,c,f,l){this.fv=a;this.ia=
b;this.Wb=c;this.ua=f;this.Zb=l}wb(){this.ia.ra(aa.a.kQc,Db.a.application,Object(C.a)(this,this.Rjj,"handleInsertContentFromStream"),4)}Fe(){}Rjj(a,b,c,f,l){b=this.ua.Ca;if(this.Zb.gd(b))return 16;if(1===c)return 32;Kc.a.ik("SlideCount","1");this.fv.ILi(b,l.streamUrl,l.formatType,l.objectType,a).OV||this.Zb.xw(this.Wb.Bf,a);return 32}}Object(e.a)(SM,"InsertContentFromStreamActor",null,[234]);class TM{constructor(a,b){this.Qj=a;this.Ub=b}zJd(a,b,c,f){const l=F=>this.Qj.OL(a.Ie(fe.a.yf(F,0),0),f),w=
Math.round(l(c.x+b.width))-Math.round(l(c.x));b=Math.round(l(c.y+b.height))-Math.round(l(c.y));return Object.assign(new Zz.a,{TopLeft:Object.assign(new oo.a,{X:0,Y:0}),TopRight:Object.assign(new oo.a,{X:w,Y:0}),BottomLeft:Object.assign(new oo.a,{X:0,Y:b}),BottomRight:Object.assign(new oo.a,{X:w,Y:b})})}hNd(a,b,c){var f=a?a.I3d:9;const l=fe.a.Ie(a?a.RTe:6,0,!1);f=fe.a.Ie(f,1,!1);b=this.Uoi(l,f,b,c);a=a?a.fsb(b.width,b.height,!0):this.Ub.rra(b.width,b.height);return{vUd:b,uC:a}}Uoi(a,b,c,f){let l=0,
w=0;0<c&&0<f&&(a=Math.min(1*a/c,1*b/f,1),l=Math.max(c*a,1),w=Math.max(f*a,1));return new $q.a(l,w)}}Object(e.a)(TM,"InsertImageHelper",null,[359]);class Nd{constructor(a,b,c,f){this.iYa=a;this.shapeType=b;this.height=c;this.width=f}}Object(e.a)(Nd,"AutoShapeProps",null,[]);class gu{static ePd(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc){w=pb.b4a(!1,a.cid,a.sid,0,b.shapeType,w,F,S,fa,xa+1);w.setValue(zb.a.HR,b.iYa);({gmh:f,Zlh:hc}=l.Bcg(f,b,c,kc,Mb,hc));Mb=Mb.Ed;w.setValue(ob.a.Bx,Mb.yf(kc.IQ(f,c),0));w.setValue(ob.a.qD,
Mb.yf(kc.IQ(hc,c),1));w.setValue(zb.a.widthPersisted,w.Bx);w.setValue(zb.a.heightPersisted,w.qD);w.setValue(zb.a.Kcd,!0);w.eba=fe.a.WGa(f,0);w.dba=fe.a.WGa(hc,1);w.setValue(zb.a.yOa,0);w.setValue(zb.a.zOa,0);w.setValue(zb.a.CRa,!0);w.setValue(zb.a.isResizable,!0);w.setValue(zb.a.DK,!0);w.iN=!0;w.wRa=!0;kc=(Mb=95===b.iYa||97===b.iYa)||Array.contains(gu.Ryg,b.iYa);w.DK=!Mb;w.isResizable=!0;w.setValue(zb.a.ty,Mb);w.setValue(zb.a.wZ,95===b.iYa);w.QL=Rd.a.XD(a.sid,a.cid);w.igb=w.get_shapeId();w.setValue(zb.a.Wra,
!0);a=l.MQf(f,hc,c);w.BT=a;(Za.EK(w)||Za.Oia(w))&&Kc.a.Db&&(Kc.a.Db.Nj=!0);kc?l.Rjh(w):l.bkh(w);return w}}gu.Ryg=[88,93,94,89,90,91,92];Object(e.a)(gu,"InsertContentShapeNodeFactory",null,[]);class UM{Bcg(a,b,c,f){b=a.right-a.left;let l=a.bottom-a.top;b=Math.max(b,1);l=Math.max(l,1);qd.a("FixInkDotInsertionAtHighZooms")?(a=f.OL(b,c),c=f.OL(l,c)):(a=Math.round(f.OL(b,c)),c=Math.round(f.OL(l,c)));return{gmh:a,Zlh:c}}MQf(a,b,c){return Object.assign(new Zz.a,{TopLeft:Object.assign(new oo.a,{X:0,Y:0}),
TopRight:Object.assign(new oo.a,{X:a*c,Y:0}),BottomLeft:Object.assign(new oo.a,{X:0,Y:b*c}),BottomRight:Object.assign(new oo.a,{X:a*c,Y:b*c})})}Rjh(){}bkh(){}}Object(e.a)(UM,"InsertInkActorHelper",null,[459]);var NQ=d(497);class $z{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.p8=Mb;this.fv=a;this.ia=b;this.ua=c;this.Zb=f;this.Pb=l;this.Ix=S;this.rm=fa;this.gl=xa;this.Fa=Za;this.Qj=pb}dispose(){}wb(){this.ia.ra(aa.a.Vlg,Db.a.application,Object(C.a)(this,this.Sjj,"handleInsertInk"),4)}Fe(){}Sjj(a,
b,c,f,l){if(!l)return 16;b=l.Ud;if(!b)return za.a.J(595080221,822,15,"HandleInsertInk was called with invalid slideNode!"),8;f=b.Cb;if(Rd.a.DA(f)||this.Zb.gd(b))return 16;if(1===c)return 32;c=this.LZb(a);if(!c)return 8;if(!this.gl.kI(b,1))return this.gl.fJ(b),16;var w=l.pxj;if(!w)return za.a.J(595153805,822,15,"HandleInsertInk was called with invalid actionData!"),8;if(!w.count)return za.a.J(595153803,822,15,"HandleInsertInk was called with 0 ink objects!"),8;l=new Ua.a;for(let Za of w){w=Za.gbi;
if(!w)return 16;var F=b.ow;F=F&&null!=F.zr?F.zr:1;w.right=w.left+(w.right-w.left)/(1/F);w.bottom=w.top+(w.bottom-w.top)/(1/F);var S=w.right-w.left,fa=w.bottom-w.top;S=Math.max(S,1);fa=Math.max(fa,1);var xa=this.Pb.Ed;S=fe.a.yf(S,0);fa=fe.a.yf(fa,1);const pb=xa.yf(w.left,0);xa=xa.yf(w.top,1);const Mb=b.Mu();w=gu.ePd(f,c,F,w,new UM,pb,xa,S,fa,Mb,this.Fa,this.rm,this.Pb,this.ua,this.Qj);w.setValue(zb.a.yia,Za.json);w.setValue(zb.a.cDa,!0);Kc.a.Db&&(Kc.a.Db.actionName=$z.fOc);w.EH=new NQ.a([Za.stroke],
Za.json,!1);l.add(w)}this.fv.X1(l.toArray(),b,a,void 0,void 0,!1);for(let Za of l)this.p8.registerInkWithStrokeCollection(Za.EH.Iwa,Za.id);this.Ix.oI=l.ga(l.count-1);return 32}LZb(){return new Nd(4,10,1,1)}}$z.fOc="InsertInk";Object(e.a)($z,"InsertInkActor",null,[234,109]);class VM{constructor(a,b,c,f,l,w,F,S,fa,xa,Za){this.Bj=null;this.IZc=!1;this.Pb=a;this.rm=b;this.Ga=c;this.ua=f;this.Ub=l;this.sa=F;this.Ix=S;this.gl=fa;this.Jb=xa;this.Zb=Za;this.la=w;this.Mul=w.insertOnlineVideoUrlPatterns;this.Qdh=
w.insertOnlineVideoEndpoint;this.Dz=u.AFrameworkApplication.Be;this.Ijl=3E4}get startTime(){return this.Bj}MMi(a){if(!a)return null;const b=a.trim();this.gFj(b)&&(za.a.J(38322700,352,50,"[Insert Online Video] Used iframe instead of url"),a=this.NMi(b));return a}txg(a){if(!a)return!1;a=a.trim();for(const b of this.Mul)if((new RegExp(b)).test(a))return!0;return!1}VNj(a){if(!a)return!1;a=a.trim();a=Jf.a.NE(a).toLowerCase();return!this.la.c8a&&"shorts.flipgrid.com"===a||"flipgrid.com"===a||"www.flipgrid.com"===
a||!this.la.kvb&&("embed.ted.com"===a||"www.ted.com"===a||"ted.com"===a)?!1:!0}Cnl(a,b){this.requestVideoData(a,c=>{this.Wog(c)},b)}requestVideoData(a,b,c){this.IZc?za.a.J(38901280,352,15,"[Insert Online Video] Multiple videos at the same time!"):(this.IZc=!0,c=c||Object(C.a)(this,this.hGi,"doNothingCallback"),this.Bj=new Date,a=Ja.a.Me(a),a=this.Qdh+(0<this.Qdh.indexOf("?")?"&":"?")+"url="+a,this.Dz.Jj(a,1,null,null,!1,2,f=>{b(f);this.IZc=!1},f=>{c(f);this.IZc=!1},null,void 0,void 0,void 0,this.Ijl,
tx.a("1")))}Wog(a){var b=+new Date-+this.startTime;za.a.J(38322702,352,50,"[Insert Online Video] Success!!! Hubble call completed in {0}ms",b);Kc.a.ik("HubbleCallDuration",b.toString());if((b=this.ua.Ca)&&!this.Zb.gd(b)&&this.gl.kI(b,1))try{const S=b.g2(this.sa.he());if(!S||!this.Zb.gd(S)){var c=this.y6a(b,S),f=JSON.parse(a.data.je),l=f.width,w=f.height;c.kIe(f.embed_url,f.thumbnail_url,f.title,f.description,0<l?l:0,0<w?w:0);var F=this.Jb.xd(15,void 0,()=>{this.sa.gy();this.sa.Rh();this.Ga.Bd()},
()=>{this.sa.selectShape(c,!0)});try{F.hd(b),this.la.Kll&&(F.fd=aa.a.KCa,F.iy[wq.a.YAa]=wq.a.online),S&&b.xT([S]),b.uB(c)}finally{F&&F.dispose()}this.Zb.xw(b,"InsertOnlineVideo");this.Ix.oI=c;za.a.J(38322704,352,50,"[Insert Online Video] Video inserted")}}catch(S){za.a.J(38322706,352,10,"[Insert Online Video] Exception after successful Hubble callback: Exception = [{0}], stack = {1}.",S.message,S.stack)}else this.gl.fJ(b)}hGi(){}y6a(a,b){if(!a)return null;var c=a.Cb;a=a.Mu();let f;const l=nf.a.p9,
w=nf.a.o9;f=b?b.fsb(nf.a.p9,nf.a.o9):this.Ub.rra(nf.a.p9,nf.a.o9);const F=b?0:0*Aq.a.t6;c=this.rm.eqa(!0,c.cid,c.sid,0,f.x+F,f.y+F,l,w,a+1,!0);b&&(c.Haa=b.id);return c}NMi(a){if(!a)return null;a=RegExp("src\\s*=\\s*['\"][^'\"]*").exec(a);if(!a||1!==a.length)return za.a.J(38322708,352,10,"[Insert Online Video] iframe error"),null;a=a[0];let b=a.indexOf('"');-1===b&&(b=a.indexOf("'"));return a=a.substr(b+1)}gFj(a){return a?RegExp(".*iframe.*").test(a):!1}m8f(a){if(!a)return"NA";let b=a.indexOf(".com/");
if(-1===b)return"NA";if(a.startsWith("https://"))a=a.substring(8,b);else if(a.startsWith("http://"))a=a.substring(7,b);else return"NA";b=a.lastIndexOf(".");return-1===b?a:a.substr(b+1)}}Object(e.a)(VM,"InsertOnlineVideoDialogHelper",null,[320]);class BE{constructor(){this.limField=0;this.limFieldSpecified=!1}}Object(e.a)(BE,"CT_LineJoinMiterProperties",null,[]);class aA{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.bevelField=null;this.capField=0;this.capFieldSpecified=!1;this.cmpdField=
0;this.cmpdFieldSpecified=!1;this.tailEndField=this.solidFillField=this.roundField=this.prstDashField=this.pattFillField=this.noFillField=this.miterField=this.headEndField=this.gradFillField=this.extLstField=this.custDashField=null;this.wField=0;this.wFieldSpecified=!1}}Object(e.a)(aA,"CT_LineProperties",null,[]);class WM{constructor(){this.valField=0}}Object(e.a)(WM,"CT_PositiveFixedPercentage",null,[]);class bA{constructor(){this.valField=0;this.valFieldSpecified=!1}}Object(e.a)(bA,"CT_PresetLineDashProperties",
null,[]);class CE{Bcg(a,b,c,f,l,w){a=Object(ua.a)(316,w.Ca.yg(l.Na));c=l.Ed;l=Math.round(f.OL(c.Ie(b.width*ke.a.$N,0),a.wV));b=Math.round(f.OL(c.Ie(b.height*ke.a.$N,1),a.wV));return{gmh:l,Zlh:b}}MQf(a,b){return Object.assign(new Zz.a,{TopLeft:Object.assign(new oo.a,{X:0,Y:0}),TopRight:Object.assign(new oo.a,{X:a,Y:0}),BottomLeft:Object.assign(new oo.a,{X:0,Y:b}),BottomRight:Object.assign(new oo.a,{X:a,Y:b})})}Rjh(a){a.lineStyle=Object.assign(new aA,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,
cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new BE,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new bA,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new rr.a,{schemeClrField:Object.assign(new ym.a,{valField:4})}),wField:6350,wFieldSpecified:!0})}bkh(a){a.fill=Object.assign(new Gz.a,{solidFillField:Object.assign(new rr.a,{schemeClrField:Object.assign(new ym.a,{valField:4})})});a.lineStyle=Object.assign(new aA,{algnField:0,algnFieldSpecified:!0,capField:2,
capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new BE,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new bA,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new rr.a,{schemeClrField:this.Eyi(Object.assign(new WM,{valField:5E4}))}),wField:12700,wFieldSpecified:!0})}Eyi(a){const b={itemsElementNameField:[26]};b.itemsField=[a];b.valField=4;return b}}Object(e.a)(CE,"InsertShapeActorHelper",null,[459]);class Ej{constructor(a,b,c,f,l,w,F,
S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig){this.r0c=this.hab=0;if(!Dc)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!Pd)throw Error.argumentNull("appFrame");if(!He)throw Error.argumentNull("viewEventNotifier");this.fv=a;this.ia=b;this.Ga=c;this.sa=f;this.Hja=0;this.ua=fa;this.Zb=l;this.Pb=w;this.eEa=F;this.Ix=Za;this.WLg=S;this.yh=xa;this.Et=fa.presentation;this.rm=pb;this.gl=Mb;this.D0j=hc;this.Nzb=kc;this.Fa=Ec;this.Qj=Hc;this.Gxb=Dc;this.eka=Td;this.Vxb=we;this.Rb=
Pd;this.Ue=He;this.$je=Pe;this.pee=Df;this.FNg=ig;this.yh.xM(Object(C.a)(this,this.RVa,"onSlideNavigation"));this.WLg.yk(Object(C.a)(this,this.Ncb,"onPresentationPropertyChanged"));this.Vxb&&(this.Rb.aP(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched")),this.Ue.Imb(Object(C.a)(this,this.fva,"onRibbonTabSwitched")),this.Ue.u1h(Object(C.a)(this,this.bXg,"onEscapeKeyPressed")));this.$je&&(Ej.O5c.push(aa.a.s6d),Ej.O5c.push(aa.a.q6d));this.TJf()}dispose(){this.WLg.Pm(Object(C.a)(this,this.Ncb,"onPresentationPropertyChanged"));
this.yh.H9(Object(C.a)(this,this.RVa,"onSlideNavigation"));this.Vxb&&(this.Rb.Q_(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched")),this.Ue.Hhc(Object(C.a)(this,this.fva,"onRibbonTabSwitched")),this.Ue.uMk(Object(C.a)(this,this.bXg,"onEscapeKeyPressed")))}wb(){for(const a of Ej.Dil)this.ia.ra(a,Db.a.application,Object(C.a)(this,this.Dgg,"handleInsertShape"),4);for(const a of Ej.N5c)this.ia.ra(a,Db.a.application,Object(C.a)(this,this.Dgg,"handleInsertShape"),4);this.ia.ra(aa.a.vQc,Db.a.application,
Object(C.a)(this,this.Ujj,"handleInsertShapeAtSpecifiedLocation"),4);this.ia.ra(aa.a.A2b,Db.a.application,Object(C.a)(this,this.Vjj,"handleInsertShapeTextBoxAtSpecifiedLocation"),4);this.ia.ra(aa.a.Ehi,Db.a.application,Object(C.a)(this,this.agg,"handleCancelInsertShape"),4);this.ia.ra(aa.a.OKf,Db.a.application,Object(C.a)(this,this.agg,"handleCancelInsertShape"),4);this.ia.ra(aa.a.E4a,Db.a.application,Object(C.a)(this,this.Rij,"handleDuplicateShape"),4)}Fe(){this.Ga.Bc(Xd.a.sg).bindAction(A.KeyInputManager.La(x.a.FJa,
A.KeyInputManager.He),aa.a.E4a);this.Ga.Bc(Xd.a.QM).bindAction(A.KeyInputManager.La(x.a.FJa,A.KeyInputManager.He),aa.a.E4a)}TJf(){if(this.Et){var a=Math.min(this.Et.Zbl,this.Et.Dbl);a=Math.max(a-50,0);this.hab=Math.floor(a/(2*Aq.a.t6))-1;this.hab=Math.max(this.hab,0);this.r0c=-1*this.hab}else this.hab=1,this.r0c=-1}Ncb(a,b){b.property!==zb.a.slideWidth&&b.property!==zb.a.slideHeight||this.TJf()}RVa(){this.Hja=0;this.Vxb&&this.cxa(0)}Mx(a){1===a.mode&&this.cxa(0)}fva(){this.cxa(0)}bXg(){this.cxa(0)}cxa(a){1===
a&&this.Ga.Bd();this.Gxb.svh(a)}Dgg(a,b,c,f,l){b=this.ua.Ca;if(!b)return 16;f=b.Cb;if(Rd.a.DA(f)||this.Zb.gd(b))return 16;if(1===c)return 32;c=this.LZb(a);if(!c)return 8;if(!this.gl.kI(b,1))return this.gl.fJ(b),16;const w=this.D0j&&this.Nzb.hN;var F=b.Ye.HasDefaultShape,S=b.Ye.HasDefaultLine,fa=95===c.iYa||97===c.iYa||Array.contains(gu.Ryg,c.iYa);S=S&&fa;F=F&&!fa;if(this.Vxb||this.$je){fa=!1;l&&(yn.a.Ru in l?l=l[yn.a.Ru]:(za.a.J(523903317,829,15,"actionData {0} does not contain the InputMethod",l),
l=0),fa=!Array.contains(Ej.Wck,l));if(fa){if(a===aa.a.Ctb)return this.cxa(1),32;if(this.$je&&w&&!Array.contains(Ej.O5c,a)&&!F&&!S){this.cxa(2);if(null==this.eka.instance)throw Error.argumentNull("insertShapeOverlayViewElement");this.eka.instance.uQc=a;return 32}}this.cxa(0)}let xa,Za;var pb=this.Et.slideWidth,Mb=this.Et.slideHeight;fa=new ic.a((pb-c.width*ke.a.$N)/2,(Mb-c.height*ke.a.$N)/2);l=fa.x+fe.a.yf(this.Hja*Aq.a.t6,0);Za=fa.y+fe.a.yf(this.Hja*Aq.a.t6,1);w?(fa=c.width*ke.a.$N,xa=c.height*ke.a.$N):
(fa=fe.a.yf(Ej.sJf,0),xa=fe.a.yf(Ej.rJf,1),l=pb/2-fe.a.yf(Ej.sJf/2-this.Hja*Aq.a.t6,0),Za=Mb/2-fe.a.yf(Ej.rJf/2-this.Hja*Aq.a.t6,1));this.Hja++;this.Hja>this.hab&&(this.Hja=this.r0c);pb=b.Mu();Mb=Object(ua.a)(316,this.ua.Ca.yg(this.Pb.Na));Kc.a.Db&&(S||F)&&Kc.a.Db.Ya(lh.a.GYb,S?"HasDefaultLine":"HasDefaultShape");!w||a===aa.a.Ctb||Array.contains(Ej.O5c,a)||F||S?f=this.rm.b4a(!1,f.cid,f.sid,0,c.shapeType,l,Za,fa,xa,pb+1):(f=gu.ePd(f,c,Mb.wV,null,new CE,l,Za,fa,xa,pb,this.Fa,this.rm,this.Pb,this.ua,
this.Qj),Kc.a.Db&&(Kc.a.Db.actionName=Ej.fOc));qd.a("MoveCursorToTextboxAfterKeyboardInsert")&&a===aa.a.Ctb&&(this.IAf(),this.Y$a=f);f.isEditable=!Array.contains(Ej.N5c,a);this.fv.X1([f],b,a);this.Ix.oI=f;this.oQe();return 32}IAf(){this.bke||(this.FNg.qpa(this.Cgh.bind(this)),this.yh.Mzc(this.ySg.bind(this)),this.bke=!0)}vLk(){this.bke&&(this.FNg.Dhc(this.Cgh.bind(this)),this.yh.ech(this.ySg.bind(this)),this.bke=!1)}Cgh(a,b){a=b.node;null!=a&&a==this.Y$a&&(this.Y$a=a,this.cJg=b.revisionId.toString())}ySg(a,
b){b.L9&&b.L9.Id&&this.cJg==b.L9.Id&&(null==this.Y$a||this.pee.Zra(this.Y$a)||setTimeout(()=>{this.ia.Ma(aa.a.cNa,2,new Jn.a(this.Y$a,!0,null));this.vLk();this.cJg=this.Y$a=null},0))}Vjj(a,b,c,f,l){if(1===c)return 2;this.cxa(0);b=this.ua.Ca;if(!b)return 16;c=b.Cb;if(Rd.a.DA(c)||this.Zb.gd(b))return 16;f=this.LZb(a);if(!f)return 16;if(!this.gl.kI(b,1))return this.gl.fJ(b),16;this.Hja++;this.Hja>this.hab&&(this.Hja=this.r0c);if(!(l&&l.left&&l.right&&l.bottom&&l.top))return za.a.J(524910939,829,10,"Invalid offsets : {0}",
l),16;const w=this.ua.Ca.ow.zr;let F=fe.a.yf(this.Qj.OL(l.right-l.left,w),0),S=fe.a.yf(this.Qj.OL(l.bottom-l.top,w),1);S||F||(F=fe.a.yf(Ej.Fei,0),S=fe.a.yf(Ej.Eei,1));F=F?F:fe.a.yf(Ej.ffi,0);S=S?S:fe.a.yf(Ej.efi,1);const fa=fe.a.yf(this.Qj.OL(l.left,w),0);l=fe.a.yf(this.Qj.OL(l.top,w),1);l=this.rm.b4a(!1,c.cid,c.sid,0,f.shapeType,fa,l,F,S,b.Mu()+1);if(!l)return za.a.J(524931852,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;qd.a("MoveCursorToTextboxAfterInsert")&&this.IAf();
l.isEditable=!Array.contains(Ej.N5c,a);this.Y$a=l;this.fv.X1([l],b,a);this.Ix.oI=l;this.oQe();za.a.J(512357315,829,50,"Successfully inserted the textbox at specified location");return 32}Ujj(a,b,c,f,l){if(1===c)return 2;this.cxa(0);b=this.ua.Ca;if(!b)return 16;c=b.Cb;if(Rd.a.DA(c)||this.Zb.gd(b))return 16;f=this.LZb(l.insertShapeActionId);if(!f)return 16;if(!this.gl.kI(b,1))return this.gl.fJ(b),16;var w=l.offsets;if(!(w&&w.left&&w.right&&w.bottom&&w.top))return za.a.J(520680924,829,10,"Invalid offsets : {0}",
w),16;const F=this.ua.Ca.yg(this.Pb.Na);let S=this.Pb.Ed.yf(w.right-w.left,0),fa=this.Pb.Ed.yf(w.bottom-w.top,1);fa||S||(S=f.width*ke.a.$N,fa=f.height*ke.a.$N);const xa=this.Pb.Ed.yf(w.left,0);w=this.Pb.Ed.yf(w.top,1);f.height=fa/ke.a.$N;f.width=S/ke.a.$N;const Za=b.Mu();c=gu.ePd(c,f,F.wV,null,new CE,xa,w,S,fa,Za,this.Fa,this.rm,this.Pb,this.ua,this.Qj);Kc.a.Db&&(Kc.a.Db.actionName=Ej.fOc);if(!c)return za.a.J(520663301,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;c.isEditable=
!Array.contains(Ej.N5c,a);l.insertLocalShape?b.uB(c,null):(this.fv.X1([c],b,a),this.Ix.oI=c,this.oQe());l.node=c;za.a.J(512357314,829,50,"Successfully inserted the shape at specified location");return 32}agg(a,b,c){if(1===c)return 32;this.cxa(0);return 32}LZb(a){switch(a){case aa.a.Ctb:return new Nd(34,16,.5,3);case aa.a.A2b:return new Nd(34,16,.5,3);case aa.a.Pmg:return new Nd(34,9,1,1);case aa.a.Nog:return new Nd(2,17,1,1.16);case aa.a.hog:return new Nd(3,55,1,1);case aa.a.Sng:return new Nd(6,56,
1,1.33);case aa.a.Mog:return new Nd(7,57,1.33,1);case aa.a.Cmg:return new Nd(5,58,1,1);case aa.a.oog:return new Nd(9,59,1,1.05);case aa.a.Ymg:return new Nd(10,60,1,1.16);case aa.a.Xmg:return new Nd(11,61,1,1);case aa.a.Nng:return new Nd(12,62,1,1);case aa.a.ymg:return new Nd(13,63,1,1);case aa.a.Gmg:return new Nd(14,64,1,1);case aa.a.Ung:return new Nd(39,65,1,1);case aa.a.jmg:return new Nd(87,66,1,1);case aa.a.Kog:return new Nd(35,67,1,1);case aa.a.Umg:return new Nd(83,68,1,1);case aa.a.Vmg:return new Nd(84,
69,1,1);case aa.a.bng:return new Nd(85,70,1,1);case aa.a.Bmg:return new Nd(86,71,1,1);case aa.a.pmg:return new Nd(130,72,1,1);case aa.a.Vng:return new Nd(33,73,1,1);case aa.a.fmg:return new Nd(73,7,1.33,1);case aa.a.qmg:return new Nd(72,8,1.33,1.33);case aa.a.dmg:return new Nd(82,74,1.14,1.14);case aa.a.Hmg:return new Nd(41,75,1,1);case aa.a.Lng:return new Nd(42,76,1,1);case aa.a.emg:return new Nd(40,77,1,1);case aa.a.Tmg:return new Nd(81,78,1,1);case aa.a.qog:return new Nd(78,79,1,1);case aa.a.Wmg:return new Nd(75,
18,1,1);case aa.a.kng:return new Nd(74,80,1,1);case aa.a.Jog:return new Nd(76,81,1,1);case aa.a.Jng:return new Nd(77,82,1,.5);case aa.a.lmg:return new Nd(120,83,1,1);case aa.a.amg:return new Nd(88,84,1,1);case aa.a.Kmg:return new Nd(93,85,1,1);case aa.a.Jmg:return new Nd(94,86,1,1.17);case aa.a.fng:return new Nd(89,87,1,.08);case aa.a.gog:return new Nd(90,88,1,.08);case aa.a.eng:return new Nd(91,89,1,.17);case aa.a.fog:return new Nd(92,90,1,.17);case aa.a.Hng:return new Nd(175,19,1,1);case aa.a.Eng:return new Nd(176,
20,1,1);case aa.a.Fng:return new Nd(177,21,1,1);case aa.a.Cng:return new Nd(178,22,1,1);case aa.a.Dng:return new Nd(179,23,1,1);case aa.a.Gng:return new Nd(180,24,1,1);case aa.a.s6d:return new Nd(95,12,1,1);case aa.a.t6d:return new Nd(95,13,1,1);case aa.a.u6d:return new Nd(95,14,1,1);case aa.a.q6d:return new Nd(97,26,1,1);case aa.a.p6d:return new Nd(97,155,1,1);case aa.a.r6d:return new Nd(97,156,1,1);case aa.a.n6d:return new Nd(101,25,1,1);case aa.a.m6d:return new Nd(101,153,1,1);case aa.a.o6d:return new Nd(101,
154,1,1);case aa.a.Mmg:return new Nd(46,0,1.07,.53);case aa.a.cng:return new Nd(44,1,.53,1.07);case aa.a.gng:return new Nd(50,2,.53,1.33);case aa.a.dog:return new Nd(43,3,.53,1.07);case aa.a.Pog:return new Nd(45,4,1.07,.53);case aa.a.Rog:return new Nd(51,5,1.33,.53);case aa.a.ing:return new Nd(53,27,.93,1.33);case aa.a.bmg:return new Nd(62,28,.95,.89);case aa.a.Oog:return new Nd(63,29,.96,.97);case aa.a.jng:return new Nd(52,30,.93,.93);case aa.a.cmg:return new Nd(49,31,.8,.93);case aa.a.umg:return new Nd(67,
32,1.33,.8);case aa.a.tmg:return new Nd(68,33,1.33,.8);case aa.a.vmg:return new Nd(69,34,.8,1.33);case aa.a.rmg:return new Nd(70,46,.8,1.33);case aa.a.Hog:return new Nd(47,35,.53,1.07);case aa.a.Mng:return new Nd(48,36,.53,1.07);case aa.a.Tng:return new Nd(36,37,.53,1.07);case aa.a.hmg:return new Nd(37,38,.53,.53);case aa.a.eog:return new Nd(56,39,1,1);case aa.a.Nmg:return new Nd(58,40,1,1);case aa.a.dng:return new Nd(55,41,1,1);case aa.a.Qog:return new Nd(57,42,1,1);case aa.a.hng:return new Nd(59,
43,.63,1.33);case aa.a.aog:return new Nd(61,44,1.33,1.33);case aa.a.kmg:return new Nd(64,45,1.07,1.07);case aa.a.$ng:return new Nd(54,47,1.33,1.33);case aa.a.bog:return new Nd(4,10,1,1);case aa.a.mog:return new Nd(25,11,1,1);case aa.a.iog:return new Nd(28,48,1,1);case aa.a.jog:return new Nd(27,49,1,1);case aa.a.kog:return new Nd(26,50,1,1);case aa.a.sog:return new Nd(29,51,1,1);case aa.a.rog:return new Nd(32,52,1,1);case aa.a.tog:return new Nd(31,53,1,1);case aa.a.uog:return new Nd(30,54,1,1);case aa.a.cog:return new Nd(116,
91,.67,1);case aa.a.nog:return new Nd(117,6,.67,1);case aa.a.Qng:return new Nd(118,92,.67,1);case aa.a.mmg:return new Nd(119,93,.67,1);case aa.a.lng:return new Nd(104,94,.67,1);case aa.a.png:return new Nd(105,95,.67,1);case aa.a.vng:return new Nd(106,96,.67,1);case aa.a.mng:return new Nd(107,97,.67,1);case aa.a.qng:return new Nd(108,98,.67,1);case aa.a.wng:return new Nd(109,99,.67,1);case aa.a.nng:return new Nd(110,100,.67,1);case aa.a.tng:return new Nd(111,101,.67,1);case aa.a.xng:return new Nd(112,
102,.67,1);case aa.a.ong:return new Nd(113,103,.67,1);case aa.a.ung:return new Nd(114,104,.67,1);case aa.a.yng:return new Nd(115,105,.67,1);case aa.a.Qmg:return new Nd(79,106,1,1);case aa.a.Rmg:return new Nd(80,107,1,1);case aa.a.Bog:return new Nd(15,108,1,1);case aa.a.Cog:return new Nd(16,15,1,1);case aa.a.Dog:return new Nd(17,109,1,1);case aa.a.Eog:return new Nd(18,110,1,1);case aa.a.Fog:return new Nd(19,111,1,1);case aa.a.wog:return new Nd(20,112,1,1);case aa.a.xog:return new Nd(21,113,1,1);case aa.a.yog:return new Nd(22,
114,1,1);case aa.a.zog:return new Nd(23,115,1,1);case aa.a.Aog:return new Nd(24,116,1,1);case aa.a.Sog:return new Nd(122,117,.67,1.33);case aa.a.Omg:return new Nd(121,118,.67,1.33);case aa.a.wmg:return new Nd(124,119,.83,1.33);case aa.a.smg:return new Nd(123,120,.83,1.33);case aa.a.Tog:return new Nd(126,121,1.25,1.13);case aa.a.Zmg:return new Nd(127,122,1.13,1.25);case aa.a.Uog:return new Nd(128,123,1,1);case aa.a.Lmg:return new Nd(129,124,1,1);case aa.a.Yng:return new Nd(131,125,.67,1);case aa.a.$lg:return new Nd(158,
126,.67,1);case aa.a.zmg:return new Nd(132,127,.67,1);case aa.a.xmg:return new Nd(133,128,.67,1);case aa.a.Wng:return new Nd(134,129,.67,1);case aa.a.$mg:return new Nd(135,130,.67,.67);case aa.a.Fmg:return new Nd(136,131,.67,1);case aa.a.Kng:return new Nd(137,132,.83,1.16);case aa.a.Log:return new Nd(138,133,.33,1);case aa.a.Xng:return new Nd(139,134,.67,1.16);case aa.a.Ang:return new Nd(140,135,.5,1);case aa.a.Bng:return new Nd(141,136,.67,1);case aa.a.omg:return new Nd(142,137,.5,.5);case aa.a.Ong:return new Nd(159,
138,.67,.67);case aa.a.gmg:return new Nd(143,139,.88,1);case aa.a.Zng:return new Nd(144,140,.88,1);case aa.a.Iog:return new Nd(145,141,.67,.67);case aa.a.Png:return new Nd(146,142,.67,.67);case aa.a.nmg:return new Nd(147,143,1,.5);case aa.a.vog:return new Nd(148,144,1,.5);case aa.a.Smg:return new Nd(149,145,.75,.75);case aa.a.Ing:return new Nd(150,146,.75,.75);case aa.a.Gog:return new Nd(152,147,.67,1);case aa.a.Amg:return new Nd(157,148,.67,.67);case aa.a.pog:return new Nd(153,149,.67,.67);case aa.a.zng:return new Nd(154,
150,.67,1);case aa.a.Dmg:return new Nd(155,151,.75,1);case aa.a.Emg:return new Nd(156,152,.67,1);default:return null}}Rij(a,b,c){b=this.sa.mg();if(!(b&&0<b.length&&Aq.a.HWk(b)))return 16;if(1===c)return 32;c=this.ua.Ca;if(!c)return 16;if(!this.gl.kI(c,b.length))return this.gl.fJ(c),16;if(this.Zb.gd(c))return 16;this.eEa.E2g(c,c,b,null,a);return 32}oQe(){try{const a=lb.a.instance.Oa("Common.ISystemInitiatedFeedback");a&&a.execute(b=>{b.logActivity("InsertShapeActivity",null)})}catch(a){za.a.J(573649485,
829,10,"Exception thrown while triggering InsertShapeActivity. Exception: {0}",a)}}}Ej.sJf=110;Ej.rJf=75;Ej.Fei=19;Ej.Eei=38;Ej.ffi=4;Ej.efi=4;Ej.fOc="InsertShape";Ej.Dil=[aa.a.Hng,aa.a.Eng,aa.a.Fng,aa.a.Cng,aa.a.Dng,aa.a.Gng,aa.a.Ctb,aa.a.Pmg,aa.a.Nog,aa.a.hog,aa.a.Sng,aa.a.Mog,aa.a.Cmg,aa.a.oog,aa.a.Ymg,aa.a.Xmg,aa.a.Nng,aa.a.ymg,aa.a.Gmg,aa.a.Ung,aa.a.jmg,aa.a.Kog,aa.a.Umg,aa.a.Vmg,aa.a.bng,aa.a.Bmg,aa.a.pmg,aa.a.Vng,aa.a.fmg,aa.a.qmg,aa.a.dmg,aa.a.Hmg,aa.a.Lng,aa.a.emg,aa.a.Tmg,aa.a.qog,aa.a.Wmg,
aa.a.kng,aa.a.Jog,aa.a.Jng,aa.a.lmg,aa.a.amg,aa.a.Kmg,aa.a.Jmg,aa.a.fng,aa.a.gog,aa.a.eng,aa.a.fog,aa.a.bog,aa.a.mog,aa.a.iog,aa.a.jog,aa.a.kog,aa.a.sog,aa.a.rog,aa.a.tog,aa.a.uog,aa.a.cog,aa.a.nog,aa.a.Qng,aa.a.mmg,aa.a.lng,aa.a.png,aa.a.vng,aa.a.mng,aa.a.qng,aa.a.wng,aa.a.ong,aa.a.ung,aa.a.yng,aa.a.nng,aa.a.tng,aa.a.xng,aa.a.Qmg,aa.a.Rmg,aa.a.Bog,aa.a.Cog,aa.a.Dog,aa.a.Eog,aa.a.Fog,aa.a.wog,aa.a.xog,aa.a.yog,aa.a.zog,aa.a.Aog,aa.a.Sog,aa.a.Omg,aa.a.wmg,aa.a.smg,aa.a.Tog,aa.a.Zmg,aa.a.Uog,aa.a.Lmg,
aa.a.Yng,aa.a.$lg,aa.a.zmg,aa.a.xmg,aa.a.Wng,aa.a.$mg,aa.a.Fmg,aa.a.Kng,aa.a.Log,aa.a.Xng,aa.a.Ang,aa.a.Bng,aa.a.omg,aa.a.Ong,aa.a.gmg,aa.a.Zng,aa.a.Iog,aa.a.Png,aa.a.nmg,aa.a.vog,aa.a.Smg,aa.a.Ing,aa.a.Gog,aa.a.Amg,aa.a.pog,aa.a.zng,aa.a.Dmg,aa.a.Emg,aa.a.dog,aa.a.Mmg,aa.a.cng,aa.a.Pog,aa.a.Rog,aa.a.gng,aa.a.ing,aa.a.bmg,aa.a.Oog,aa.a.jng,aa.a.cmg,aa.a.umg,aa.a.tmg,aa.a.rmg,aa.a.vmg,aa.a.Hog,aa.a.Mng,aa.a.Tng,aa.a.hmg,aa.a.eog,aa.a.Nmg,aa.a.dng,aa.a.Qog,aa.a.hng,aa.a.aog,aa.a.kmg,aa.a.$ng];Ej.N5c=
[aa.a.s6d,aa.a.t6d,aa.a.u6d,aa.a.n6d,aa.a.m6d,aa.a.o6d,aa.a.q6d,aa.a.p6d,aa.a.r6d];Ej.O5c=[aa.a.t6d,aa.a.u6d,aa.a.n6d,aa.a.m6d,aa.a.o6d,aa.a.p6d,aa.a.r6d];Ej.Wck=[1,5];Object(e.a)(Ej,"InsertShapeActor",null,[234,109]);class XM{constructor(){this.type="LivePollTaskPaneProps";this.formsUrl=this.onCloseButtonClicked=null}}Object(e.a)(XM,"LivePollTaskPaneProps",null,[]);class YM{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.jL=null;this.LEa=this.Sb=!1;a.loadScript("powerpoint-live-strings").then(()=>
{this.LEa=!0;za.a.J(577889825,833,50,"powerpoint-live-strings loaded successfully")}).catch(hc=>{za.a.J(577889823,833,10,"Failed to load powerpoint-live-strings "+hc.toString())});if(!b)throw Error.argumentNull("formsDesignPageUrl LivePollPaneActor is null");if(!c)throw Error.argumentNull("formsResultsPageUrl for LivePollPaneActor is null");if(!f)throw Error.argumentNull("actionManager for LivePollPaneActor is null");if(!l)throw Error.argumentNull("actionBlockingManager for LivePollPaneActor is null");
if(!w)throw Error.argumentNull("focusManager for LivePollPaneActor is null");if(!F)throw Error.argumentNull("shapeReader for LivePollPaneActor is null");if(!S)throw Error.argumentNull("shapeEditor for LivePollPaneActor is null");if(!fa)throw Error.argumentNull("transactionFactory for LivePollPaneActor is null");if(!xa)throw Error.argumentNull("graphTopologyManager for LivePollPaneActor is null");if(!Za)throw Error.argumentNull("selectionManager for LivePollPaneActor is null");if(!pb)throw Error.argumentNull("shapeCountValidator for LivePollPaneActor is null");
if(!Mb)throw Error.argumentNull("ribbonChangeManager for LivePollPaneActor is null");this.LZj=b;this.MZj=c;this.ia=f;this.ua=xa;this.Df=l;this.sa=Za;this.Ga=w;this.Fa=F;this.rm=S;this.Jb=fa;this.gl=pb;this.Ix=Mb;this.hLg=Object(C.a)(this,this.Qhl,"taskPaneMessageHandler")}wb(){this.ia.ya(aa.a.YKe,$b.a.application,Object(C.a)(this,this.YKe,"showHideLivePollPane"))}Fe(){}YKe(a,b,c){return b.contextId===$b.a.application&&this.LEa?1===c?32:ug.a("LivePollPaneToggle",a,()=>{(this.Sb=!this.Sb)?(this.kn(),
za.a.J(577889821,833,50,"LivePollPaneActor::ShowHideLivePollPane show")):(this.aK(),za.a.J(577889819,833,50,"LivePollPanePaneActor::ShowHideLivePollPanePane close"));return 32}):2}kn(){this.OE();const a=Object.assign(new bu.a,{title:ResourceStrings.L_LivePollTaskPane,hideHeader:!1,width:320,location:2,contentProps:this.jL,onOpen:()=>{},onClose:()=>{this.Sb=!1},isModernPane:!0});lj.UISurfaces.du().then(b=>{b.showTaskPane("LivePollTaskPaneProps",a);window.addEventListener("message",this.hLg,!1);return null}).catch(b=>
{za.a.J(577889817,833,10,"LivePollPaneActor::ShowPane exception: {0}",b.toString())})}aK(){lj.UISurfaces.du().then(a=>{a.hideTaskPane("LivePollTaskPaneProps",2);window.removeEventListener("message",this.hLg);return null}).catch(a=>{za.a.J(577889815,833,10,"LivePollPaneActor::ClosePane exception: {0}",a.toString())})}OE(){this.jL=Object.assign(new XM,{onCloseButtonClicked:Object(C.a)(this,this.onCloseButtonClicked,"onCloseButtonClicked"),formsUrl:this.I1i()})}I1i(){return String.format("{0}{1}{2}",
this.LZj,"&auth_upn=",u.AFrameworkApplication.fa.Ia("UserPrincipalName"))}onCloseButtonClicked(){this.aK()}Qhl(a){if("data"in a){var b;({Ev:b}=md.d(a.data)).returnValue&&b&&"type"in b&&"PollCreated"===b.type&&"payload"in b&&(a=b.payload,"formId"in a&&(a=String.format("{0}{1}{2}{3}{4}",this.MZj,"?Id=",a.formId,"&auth_pvr=OrgId&auth_upn=",u.AFrameworkApplication.fa.Ia("UserPrincipalName")),this.Tjj(a)))}}Tjj(a){const b=this.ua.Ca;if(b&&!this.Df.gd(b))if(this.gl.kI(b,1)){var c=b.Cb;b.nxi(c.sid,c.cid,
a,b.Mu());b.g2(this.sa.he())}else this.gl.fJ(b)}}Object(e.a)(YM,"LivePollPaneActor",null,[234]);var OQ=d(664);class Ox{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb){this.Kz=f;this.t3=l;this.ia=a;this.Zb=b;this.Ga=c;this.uI=S;this.Wb=w;this.ua=F;this.Kc=fa;this.Rb=xa;this.hua=Za;this.Pb=pb}wb(){this.ia.ya(aa.a.VXa,$b.a.application,Object(C.a)(this,this.VXa,"showHideNotes"));this.ia.ra(aa.a.m7g,$b.a.application,Object(C.a)(this,this.tAk,"queryNotesPaneState"),96);this.ia.ra(aa.a.q$c,$b.a.application,Object(C.a)(this,
this.y1g,"pageScrollNotesPane"),64);this.ia.ra(aa.a.p$c,$b.a.application,Object(C.a)(this,this.y1g,"pageScrollNotesPane"),64);this.ia.ya(aa.a.hIe,$b.a.application,Object(C.a)(this,this.fdk,"notesResize"))}Fe(){const a=this.Ga.Bc(Ai.a.VU);a.bindAction(A.KeyInputManager.La(x.a.iB,0),aa.a.q$c);a.bindAction(A.KeyInputManager.La(x.a.hB,0),aa.a.p$c)}VXa(a,b,c,f,l){if(this.Pb&&0!==this.Pb.Aw)return 2;a=this.Wb.Bf;if(!this.ua.Ca||!a||this.Zb.fN(a))return 16;if(1===c)return 32;l&&Object(Ca.a)(OQ.a,l)?l.kkc?
this.Kz.sLe():this.Kz.dqj():(this.Kz.Gmk(),this.Kz.hTb()&&this.t3.Oo?this.Ga.Kj(Ai.a.VU,!0):this.Ga.Kj(Ai.a.VU,!1));this.uI.oQa();return 32}tAk(a,b,c,f,l){if(!l||!Object(Ca.a)(Kh.a,l))return 8;l.Yf(this.Kz.hTb());return 32}y1g(a,b,c){return 1===c?32:this.Kz?(a===aa.a.p$c?this.Kz.za.scrollTop+=Ox.AJf:a===aa.a.q$c&&(this.Kz.za.scrollTop-=Ox.AJf),32):8}fdk(a,b,c,f,l){za.a.J(37524685,822,50,"Notes Resize Begin");if(!this.Kz||!l||"number"!==typeof l)return za.a.J(37524687,822,50,"Notes Resize Fail"),8;
this.Kz.xda=l;this.Kc.Mc.Vkh(1);this.Rb.Mq();this.hua.swl();za.a.J(37524689,822,50,"Notes Resize Success, Notes status:{0}, Notes Height:{1}",this.Kz.ddk?"On":"Off",this.Kz.xda);return 32}}Ox.AJf=80;Object(e.a)(Ox,"NotesActor",null,[234]);class ZM{constructor(a,b,c,f){this.ia=a;this.B9b=b;this.la=c;this.pJg=0;this.SN=f}Fe(){}wb(){this.ia.ra(aa.a.uAk,de.a.frame,Object(C.a)(this,this.vAk,"queryOfflineStatusHandler"),2144)}vAk(a,b,c,f,l){if(1===c)return 32;switch(this.B9b.status){case 0:1===this.pJg&&
(l[Bq.a.Value]=CommonUIStrings.L_Connected,l[tm.a.labelText]=CommonUIStrings.L_Connected,l[Bq.a.Visible]=!0,this.hideIcon(),Im.a.instance.Hb(new Se.a(2,1,this.la.offlineLabelTimeoutInMs,()=>{this.p$k();this.SN.C4("GetOfflineStatus",!1);this.SN.YG()},90,"108")));break;case 2:l[Bq.a.Value]=CommonUIStrings.L_Disconnected;l[tm.a.labelText]=CommonUIStrings.L_Disconnected;l[Bq.a.Visible]=!0;break;case 1:l[Bq.a.Value]=CommonUIStrings.L_Reconnecting,l[tm.a.labelText]=CommonUIStrings.L_Reconnecting,l[Bq.a.Visible]=
!0}this.pJg=this.B9b.status;return 32}hideIcon(){this.Cjh(Ei.a.hidden)}p$k(){this.Cjh(Ei.a.visible)}Cjh(a){const b=document.querySelector("[data-icon-name='SBVBASecurity_16']");b&&(b.style.visibility=a)}}Object(e.a)(ZM,"OfflineStatusLabelActor",null,[234]);class $M{constructor(a,b,c,f,l,w,F,S){this.tIg=!1;this.afe=null;this.ia=a;this.Df=b;this.uI=c;this.Ga=c.Wn;this.Jb=f;this.sa=l;this.Fa=w;this.Rp=F;this.TZ=S}wb(){this.ia.ra(aa.a.bringForward,$b.a.application,Object(C.a)(this,this.mOc,"handleOrganizeAction"),
4);this.ia.ra(aa.a.bringToFront,$b.a.application,Object(C.a)(this,this.mOc,"handleOrganizeAction"),4);this.ia.ra(aa.a.sendBackward,$b.a.application,Object(C.a)(this,this.mOc,"handleOrganizeAction"),4);this.ia.ra(aa.a.sendToBack,$b.a.application,Object(C.a)(this,this.mOc,"handleOrganizeAction"),4);this.ia.ra(aa.a.qbi,$b.a.application,Object(C.a)(this,this.vgg,"handleFrontBackFlyout"),4);this.ia.ra(aa.a.VXk,$b.a.application,Object(C.a)(this,this.vgg,"handleFrontBackFlyout"),4);u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&qd.a("DelayRegisterArrangeShapesAction")?this.afe=()=>{this.ia.ra(aa.a.VFf,$b.a.application,Object(C.a)(this,this.Rgg,"handleOrganizeShapeAnchor"),4)}:this.ia.ra(aa.a.VFf,$b.a.application,Object(C.a)(this,this.Rgg,"handleOrganizeShapeAnchor"),4)}Fe(){const a=this.uI.Wn.Bc(Xd.a.sg);a.bindAction(A.KeyInputManager.La(x.a.Cnc,A.KeyInputManager.He),aa.a.bringForward);a.bindAction(A.KeyInputManager.La(x.a.Cnc,A.KeyInputManager.He|4),aa.a.bringToFront);a.bindAction(A.KeyInputManager.La(x.a.Anc,A.KeyInputManager.He),
aa.a.sendBackward);a.bindAction(A.KeyInputManager.La(x.a.Anc,A.KeyInputManager.He|4),aa.a.sendToBack)}vgg(a,b,c){return 1===c?this.sa.D2()?32:8:32}Rgg(){return this.tIg?32:this.sa.D2()?32:16}mOc(a,b,c){b=this.Rp.presentation;if(!b)throw Error.argumentNull("Presentation is null");let f=this.sa.mg();var l=this.Fa.Z5a(f);l&&(this.sa.Ucd(l),f=this.sa.mg());if(!this.sa.D2()||this.Df.OB(f))return 16;if(1===c)return 32;switch(a){case aa.a.bringForward:c=1;break;case aa.a.bringToFront:c=0;break;case aa.a.sendBackward:c=
3;break;case aa.a.sendToBack:c=2;break;default:return 8}Kc.a.Db&&(Kc.a.Db.ur=!1,Kc.a.Db.Nj=!0);1===f.length?za.a.J(17598029,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing only one shape."):1<f.length&&za.a.J(17598031,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing {0} shapes.",f.length);l=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{l.lc(f[0]);l.fd=a;const w=Object(ua.a)(132,b.LB(f[0].slideId));this.nok(w,f,c)}finally{l&&l.dispose()}return 32}nbk(a,b){const c=
this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{const f=this.Rp.Ca,l=f.KB(a),w=f.KB(b);c.lc(l);this.obk(f,l.id,w.id)}finally{c&&c.dispose()}}A2k(){this.tIg=!0;qd.a("DelayRegisterArrangeShapesAction")&&this.afe&&this.afe()}nok(a,b,c){a&&b&&0<b.length&&za.a.J(51164099,815,50,"OrganizeShapes has invalid params");let f=Ma.a.clone(a.getValue(ob.a.rA));const l=[];let w=null;Ma.a.tna(b,F=>!F.xh).length||(w=this.Fa.ys(b[0]))&&(f=Ma.a.clone(w.getValue(ob.a.rA)));for(const F of b)l.push(F.id);a.BYb(c,
f,l)&&(w&&w.anchor?w.anchor.xgb(f,1,!1):a.anchor?a.anchor.xgb(f,1,!1):za.a.J(51164101,815,50,"slideNode/groupNode should have valid anchor"))}mok(a,b,c){var f=this.sa.he(),l=this.p0i(f,b);a.reverse();b=new Ua.a;f=[];let w=-1,F=!1;for(let fa=0;fa<a.length;fa++){let xa=!1;for(var S of l)if(S.equals(a[fa])){b.add(S);xa=F=!0;break}xa||f.push(a[fa]);c.equals(a[fa])&&(w=fa)}if(F)if(-1===w)za.a.J(593514880,815,10,"Invalid param endShapeId"),F=!1;else{c=0;S=a.length;for(l=0;c<w;)a[c++]=f[l++];for(let fa of b)a[c++]=
fa;for(;c<S;)a[c++]=f[l++]}a.reverse();return F}p0i(a,b){let c=[],f=!1;for(const l of a)l.id.equals(b)&&(f=!0),c.push(l.id);f||(c=[],c.push(b));return c}obk(a,b,c){if(a){var f=Ma.a.clone(a.getValue(ob.a.rA));var l=this.TZ.Aba(b);var w=this.TZ.Aba(c);l=this.Fa.ys(l);w=this.Fa.ys(w);l?w===l&&(f=Ma.a.clone(l.getValue(ob.a.rA))):w&&(c=w.id);this.mok(f,b,c)&&(za.a.J(51385985,815,50,"ReorderShapeInSelectionPane : Reorder shape"),l?l.anchor?l.anchor.xgb(f,1,!1):za.a.J(594023564,815,10,"shapeNode should have valid anchor"):
a.anchor?a.anchor.xgb(f,1,!1):za.a.J(51385987,815,10,"slideNode should have valid anchor"))}else za.a.J(51385955,815,10,"MoveShapeOnTopOfShape has invalid params")}}Object(e.a)($M,"OrganizeShapesActor",null,[234]);class aN extends Es.a{constructor(a,b,c,f,l,w,F,S,fa){super();this.Y2c=0;this.Te=f;this.zc=S;this.LCg=fa;this.init(a);this.vl("PPTClipboardActionOperation");(a=Object(ua.a)(10,F))||(a=new H.DictionaryPropertySet);a.setValue(pm.a.Tb,fa);this.ACa(b,c,l,w,a)}SPc(){this.efb(this.Te)}M3a(a){this.Zo=
a;this.Y2c=1}run(){if(0===this.Y2c){if(1===this.Wla())return;this.Y2c=1}1===this.Y2c&&this.sX();this.zc.QAj(this.LCg)&&this.zc.Eg(!0,this.LCg)}}Object(e.a)(aN,"PPTClipboardActionOperation",Es.a,[438,306,307]);var bN=d(358),DE=d(527);class hu{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig,Ff,nh){this.ia=a;this.sa=b;this.Ga=c;this.Jz=f;this.cab=l;this.Jb=w;this.XFg=F;this.Ib=S;this.Rca=fa;this.Myb=xa;this.Fa=Za;this.dEa=pb;this.$K=Mb;this.b1j=hc;this.Q8b=kc;this.YCg=
Ec;this.iIg=Hc;this.wc=Dc;this.qp=Td;this.Xr=we;this.bQ=Pd;this.Rb=He;this.Wb=Pe;this.xN=Df;this.CTa=ig;this.eT=Tg;if(qd.a("RulerIndentBugFix")){if(!Ig)throw Error.argumentNull("paragraphIndentationReader");if(!Ff)throw Error.argumentNull("paragraphEditor");}this.C8=Ig;this.gUa=Ff;this.L$b=nh}wb(){this.ia.ra(aa.a.Nwe,$b.a.application,Object(C.a)(this,this.llj,"handlePopulateFontColorDropdown"),101);this.ia.ra(aa.a.E1g,$b.a.application,Object(C.a)(this,this.nlj,"handlePopulateFontSizeDropdown"),100);
this.ia.ra(aa.a.aha,$b.a.application,Object(C.a)(this,this.oij,"handleCommitShapeText"),4);this.ia.ra(aa.a.fad,$b.a.application,Object(C.a)(this,this.k7g,"queryListCommonLevel"),96);this.ia.ra(aa.a.tad,$b.a.application,Object(C.a)(this,this.k7g,"queryListCommonLevel"),96);this.ia.ra(aa.a.jgc,$b.a.application,Object(C.a)(this,this.j8g,"queryTextListMarkerGallery"),96);this.ia.ra(aa.a.kgc,$b.a.application,Object(C.a)(this,this.j8g,"queryTextListMarkerGallery"),96);this.ia.ra(aa.a.m$c,$b.a.application,
Object(C.a)(this,this.Xgg,"handlePopulateListMarkerDropdown"),100);this.ia.ra(aa.a.n$c,$b.a.application,Object(C.a)(this,this.Xgg,"handlePopulateListMarkerDropdown"),100);this.ia.ra(aa.a.tbe,Db.a.view,Object(C.a)(this,this.hkj,"handleLineSpacingMenuOpen"),68);this.ia.ra(aa.a.Yak,$b.a.application,Object(C.a)(this,this.pkj,"handleMoreFontColors"),96);this.ia.ra(aa.a.j$c,$b.a.application,Object(C.a)(this,this.qkj,"handleMoreFontColorsResponse"),96);this.ia.ya(aa.a.qWa,Db.a.paragraph,Object(C.a)(this,
this.qWa,"queryLineSpacing"));this.ia.ya(aa.a.qWa,Db.a.view,this.Rca);this.ia.$d(aa.a.qWa,96);this.ia.ya(aa.a.Ola,Db.a.paragraph,Object(C.a)(this,this.c0,"setLineSpacing"));this.ia.ya(aa.a.Ola,Db.a.view,this.Rca);this.ia.$d(aa.a.Ola,68);this.ia.ya(aa.a.YGa,$b.a.application,Object(C.a)(this,this.YGa,"populateLineSpacingFlyout"));this.ia.ya(aa.a.D1g,$b.a.application,Object(C.a)(this,this.Nkj,"handlePandoraEscapeKeyPressed"));this.ia.ya(aa.a.xfb,Db.a.paragraph,Object(C.a)(this,this.lFf,"applySpacingToParagraph"));
this.ia.ya(aa.a.xfb,Db.a.view,this.Rca);this.ia.$d(aa.a.xfb,4);this.ia.ya(aa.a.wfb,Db.a.paragraph,Object(C.a)(this,this.lFf,"applySpacingToParagraph"));this.ia.ya(aa.a.wfb,Db.a.view,this.Rca);this.ia.$d(aa.a.wfb,4);this.ia.ya(aa.a.tia,Db.a.paragraph,Object(C.a)(this,this.inb,"applyIndentationToParagraph"));this.ia.ya(aa.a.tia,Db.a.view,this.Rca);this.ia.$d(aa.a.tia,4);this.ia.ya(aa.a.$Fb,Db.a.paragraph,Object(C.a)(this,this.inb,"applyIndentationToParagraph"));this.ia.ya(aa.a.$Fb,Db.a.view,this.Rca);
this.ia.$d(aa.a.$Fb,4);this.ia.ya(aa.a.bGb,Db.a.paragraph,Object(C.a)(this,this.inb,"applyIndentationToParagraph"));this.ia.ya(aa.a.bGb,Db.a.view,this.Rca);this.ia.$d(aa.a.bGb,4);this.ia.ya(aa.a.dGb,Db.a.paragraph,Object(C.a)(this,this.inb,"applyIndentationToParagraph"));this.ia.ya(aa.a.dGb,Db.a.view,this.Rca);this.ia.$d(aa.a.dGb,4);this.L$b&&(this.ia.ya(aa.a.aGb,Db.a.paragraph,Object(C.a)(this,this.inb,"applyIndentationToParagraph")),this.ia.ya(aa.a.aGb,Db.a.view,this.Rca),this.ia.$d(aa.a.aGb,4),
this.ia.ya(aa.a.cGb,Db.a.paragraph,Object(C.a)(this,this.inb,"applyIndentationToParagraph")),this.ia.ya(aa.a.cGb,Db.a.view,this.Rca),this.ia.$d(aa.a.cGb,4));this.ia.ra(aa.a.Huk,$b.a.application,Object(C.a)(this,this.ulj,"handlePowerPointTextAlignmentAnchor"),4);this.ia.ra(aa.a.w4g,$b.a.application,Object(C.a)(this,this.vlj,"handlePowerPointTextAnchoringAnchor"),4);this.ia.ya(aa.a.Ula,Db.a.view,this.Myb);this.ia.ya(aa.a.Tla,Db.a.view,this.Myb);this.ia.ya(aa.a.Sla,Db.a.view,this.Myb);this.ia.ya(aa.a.Ula,
Db.a.outline,Object(C.a)(this,this.P2d,"handlePowerPointTextAnchoring"));this.ia.ya(aa.a.Tla,Db.a.outline,Object(C.a)(this,this.P2d,"handlePowerPointTextAnchoring"));this.ia.ya(aa.a.Sla,Db.a.outline,Object(C.a)(this,this.P2d,"handlePowerPointTextAnchoring"));this.ia.$d(aa.a.Ula,4);this.ia.$d(aa.a.Tla,4);this.ia.$d(aa.a.Sla,4);this.ia.ya(aa.a.NDb,Db.a.view,this.Myb);this.ia.ya(aa.a.NDb,Db.a.outline,Object(C.a)(this,this.jBe,"queryTextAnchoring"));this.ia.$d(aa.a.NDb,96);this.ia.ya(aa.a.MDb,Db.a.view,
this.Myb);this.ia.ya(aa.a.MDb,Db.a.outline,Object(C.a)(this,this.jBe,"queryTextAnchoring"));this.ia.$d(aa.a.MDb,96);this.ia.ya(aa.a.LDb,Db.a.view,this.Myb);this.ia.ya(aa.a.LDb,Db.a.outline,Object(C.a)(this,this.jBe,"queryTextAnchoring"));this.ia.$d(aa.a.LDb,96);this.qp&&(this.ia.ra(D.a.JJc,Db.a.view,Object(C.a)(this,this.pjj,"handleFormatPainterPick"),4),this.ia.ra(aa.a.nWd,Db.a.view,Object(C.a)(this,this.rhj,"handleApplyFormatToText"),4),this.ia.ra(D.a.Mha,Db.a.view,Object(C.a)(this,this.ojj,"handleFormatPainterCancel"),
4),this.bQ.j1h(()=>{this.xN.XRa=this.bQ.wK;this.Rb.updateCommandUI()}))}Fe(){var a=this.Ga.Bc(Xd.a.QM);const b=this.Ga.Bc(Ai.a.VU),c=this.Ga.Bc(Xd.a.NT),f=A.KeyInputManager.La(x.a.B0,0);a.bindAction(A.KeyInputManager.La(x.a.aoc,0),aa.a.aha);a.bindAction(f,aa.a.D1g);c.bindAction(f,aa.a.aha);b.bindAction(A.KeyInputManager.La(x.a.jnd,2),G.a.ze);a.bindAction(A.KeyInputManager.La(x.a.jnd,2),G.a.ze);this.Q8b&&(a.bindAction(A.KeyInputManager.La(x.a.Sea,5),aa.a.BE),a.bindAction(A.KeyInputManager.La(x.a.q$,
5),aa.a.Qy));this.qp&&(a=this.Ga.Bc(Ai.a.zB),a.Wo(f),a.bindAction(f,D.a.Mha))}pjj(a,b,c){a=this.sa.Dq();b=!1;let f=null,l=this.sa.Pa.kb;const w=!!this.sa.Pa&&this.sa.Pa.nl;w&&(l=this.sa.Pa.ga(0));l&&(f=l.Wa);if(f){switch(f.contextId){case Db.a.textRange:case Db.a.paragraph:case Db.a.endOfParagraph:case Db.a.Ff:b=!0}b&&Cb.SelectionEditor.Oj(f)&&zg.b(f)&&(b=!1);f.contextId===Db.a.outline&&a.rd&&(b=!0);a&&!a.Esh&&(b=!1)}if(1===c||!b)return b?32:8;6!==this.ia.$p?(this.bQ.wK?za.a.J(40703699,820,50,"User deactivated the Format Painter button"):
(za.a.J(40703697,820,50,"User activated the Format Painter button"),this.q3g(l,w,a)),this.bQ.wK=!this.bQ.wK):(za.a.J(40703701,820,50,"User picked format from keyboard shortcut"),this.q3g(l,w,a));return 32}q3g(a,b,c){this.bQ.r3g(a);var f=a.Wa;const l=Object(ua.a)(Wc.AParagraphNode,f.node);var w=Object(ua.a)(437,this.Rb.Fd);let F=null;if(l&&w&&(F=w.Gi)){w=this.Jb.ie(4);const fa=F.Ai;w.lc(F);var S=this.Ib.Jc(l);S.oc(8);const xa=this.wc.Nr(S);let Za=f.Qa,pb=f.Lb-f.Qa;a=!a.Paa&&a.We.contextId!==Db.a.endOfParagraph;
b?(Za=0,pb=db.ParagraphReader.textLength(l)+1):({selectionStart:Za,Ohh:pb}=this.bKf(f,l,S,Za,pb,null,!1),a&&f.contextId===Db.a.textRange&&pb++);b=this.eT.aCa(fa);f=null;xa&&(S.Og(16),f=Object(ua.a)(123,S.currentNode));S.nC(8);S=Object(ua.a)(132,S.currentNode);this.eT.MSe(b,!0,l.ta(zb.a.iDa,!1),S,c,f,null,Za,pb);(c=fa.Gfc(b))&&F.Rvb(c);w.dispose()}}bKf(a,b,c,f,l,w,F){switch(a.contextId){case Db.a.Ff:l=null;F&&(l=this.CTa.W_b(a))?(l=l.Wa,f=l.Qa,l=l.Lb-l.Qa):(f=0<f?f-1:0,l=1);break;case Db.a.paragraph:f=
0;l=db.ParagraphReader.textLength(b)+1;break;case Db.a.endOfParagraph:f=db.ParagraphReader.textLength(b),l=1}for(c.nC(11);c.pCa();)c.yb(2),(a=Object(ua.a)(Wc.AParagraphNode,c.currentNode))&&(f+=db.ParagraphReader.textLength(a)+1),c.nC(11);if(F)for(c=1;c<w.length;c++)if((F=Object(ua.a)(Fc.a,w.ga(c)))&&db.ParagraphReader.Pd(F.node))switch(F.contextId){case Db.a.textRange:l+=F.Lb-F.Qa;break;case Db.a.Ff:l+=1;break;case Db.a.paragraph:l+=db.ParagraphReader.textLength(F.node)+1;break;case Db.a.endOfParagraph:l+=
1}return{selectionStart:f,Ohh:l}}rhj(a){if(6===this.ia.$p||this.bQ.wK){za.a.J(40703703,820,50,"User applied the Format Painter from command location: {0}",this.ia.$p);const F=this.sa.Dq();if(F&&!hu.ZKj(F))return 2;var b=this.sa.Pa.kb;if(b&&b.Wa){var c=b.Wa;const S=Object(ua.a)(Wc.AParagraphNode,c.node);var f=Object(ua.a)(437,this.Rb.Fd),l=null;if(S&&f&&(l=f.Gi)){f=this.Jb.ie(15);f.lc(l);f.fd=a;const fa=this.sa.Pa.nl;a=S.ta(zb.a.iDa,!1);if(fa)for(var w of this.sa.Pa)this.bQ.WEf(w);else this.bQ.WEf(b);
Kc.a.Db&&(Kc.a.Db.Nj=!1,Kc.a.Db.actionName="FormatPainterApplyToText",Kc.a.Db.uE=new Date);const xa=this.Ib.Jc(S);xa.oc(8);w=c.Qa;let Za=c.Lb-c.Qa;fa?w=Za=-1:{selectionStart:w,Ohh:Za}=this.bKf(c,S,xa,w,Za,b,!0);xa.Og(8);b=Object(ua.a)(132,xa.currentNode);c=this.sa.jy();l=this.eT.aCa(l.Ai);this.eT.MSe(l,!1,a,b,F,null,c,w,Za);6!==this.ia.$p&&(this.bQ.wK=!1);f.dispose()}}}return 32}Nkj(a,b,c,f,l){this.qp&&this.ia.Ma(D.a.Mha,c,l);qd.a("PandoraEscapeKeyPressed")&&this.ia.Ma(aa.a.aha,c,l);return 32}ojj(){this.xN.XRa&&
(this.bQ.wK=!1);return 32}ulj(){return this.EYf()}vlj(){return this.EYf()}P2d(a,b,c){let f=!1;b=this.XFg.oaj(b);var l=this.sa.Mo();if(b&&b.ovb||l)f=!0;if(!f)return 16;if(1===c)return 32;switch(a){case aa.a.Ula:c=0;break;case aa.a.Tla:c=1;break;case aa.a.Sla:c=2;break;default:return 8}if(l)this.sa.rG()?this.Xr.tZk(l,c):(b=this.Jb.ie(15),b.lc(l),b.fd=a,this.Xr.sZk(this.sa.Pa,c),b.dispose());else{l=this.Jb.ie(15);try{l.lc(b),l.fd=a,b.setValue(zb.a.QQ,c)}finally{l&&l.dispose()}}return 32}jBe(a,b,c,f,
l){c=!1;b=this.XFg.r9f(b);f=this.sa.Pa;let w=0;const F=this.sa.Mo();if(b.Sa(zb.a.QQ)||F){switch(a){case aa.a.NDb:c=F?({lva:w}=this.wc.Fkd(f)).returnValue&&0===w:0===b.getValue(zb.a.QQ);break;case aa.a.MDb:c=F?({lva:w}=this.wc.Fkd(f)).returnValue&&1===w:1===b.getValue(zb.a.QQ);break;case aa.a.LDb:c=F?({lva:w}=this.wc.Fkd(f)).returnValue&&2===w:2===b.getValue(zb.a.QQ)}l.Yf(c);return 32}return 8}k7g(a,b,c,f,l){if(this.sa.hu())return l.Yf(!1),32;b=this.dEa.lA(this.sa.Dj);c=!0;for(const w of b)if((b=w.Ok?
w.node:null)?(c=this.Ib.Jc(b),c.set(b),c.oc(11),c.Og(11),c=(b=this.Jz.rx(c))?a===aa.a.fad?1===b.listType:a===aa.a.tad?0===b.listType:!1:!1):c=!1,!c)break;l.Yf(c);return 32}j8g(a,b,c,f,l){b=l.tWa;l=l.menuItemId;if(this.sa.hu())return b.Yf(!1),32;f=this.dEa.lA(this.sa.Dj);c=!0;for(const F of f){if(f=F.Ok?F.node:null){var w=this.Ib.Jc(f);w.set(f);w.oc(11);w.Og(11);if(f=this.Jz.rx(w)){if(0===l){c=!1;break}a===aa.a.jgc?(c=this.$K.nSa.ga(l).PTb,w=this.$K.nSa.ga(l).Tnb,c=f.Tsb&&0<f.P7.length&&f.P7[0]===
c&&f.b7a&&f.font===w):a===aa.a.kgc?(c=this.$K.Y5c.ga(l).$Id,c=!!f.propertySet&&f.propertySet.Sa(zb.a.autonumberBulletType)&&f.propertySet.getValue(zb.a.autonumberBulletType)===c):c=!1}else 0!==l&&(c=!1)}if(!c)break}b.Yf(c);return 32}nlj(a,b,c,f,l){if(1===c)return 32;l.PopulationXML=String.format("<Menu Id='menuFontSize'>\r\n               <MenuSection Id='fontSizes'>\r\n                    <Controls Id='ctrlFontSizes'>\r\n                        <Button MenuItemId='8'  Id='8'  Command='{0}' LabelText='8'/>\r\n                        <Button MenuItemId='9'  Id='9'  Command='{0}' LabelText='9'/>\r\n                        <Button MenuItemId='10' Id='10' Command='{0}' LabelText='10'/>\r\n                        <Button MenuItemId='10.5' Id='10.5' Command='{0}' LabelText='10.5'/>\r\n                        <Button MenuItemId='11' Id='11' Command='{0}' LabelText='11'/>\r\n                        <Button MenuItemId='12' Id='12' Command='{0}' LabelText='12'/>\r\n                        <Button MenuItemId='14' Id='14' Command='{0}' LabelText='14'/>\r\n                        <Button MenuItemId='16' Id='16' Command='{0}' LabelText='16'/>\r\n                        <Button MenuItemId='18' Id='18' Command='{0}' LabelText='18'/>\r\n                        <Button MenuItemId='20' Id='20' Command='{0}' LabelText='20'/>\r\n                        <Button MenuItemId='24' Id='24' Command='{0}' LabelText='24'/>\r\n                        <Button MenuItemId='28' Id='28' Command='{0}' LabelText='28'/>\r\n                        <Button MenuItemId='32' Id='32' Command='{0}' LabelText='32'/>\r\n                        <Button MenuItemId='36' Id='36' Command='{0}' LabelText='36'/>\r\n                        <Button MenuItemId='40' Id='40' Command='{0}' LabelText='40'/>\r\n                        <Button MenuItemId='44' Id='44' Command='{0}' LabelText='44'/>\r\n                        <Button MenuItemId='48' Id='48' Command='{0}' LabelText='48'/>\r\n                        <Button MenuItemId='54' Id='54' Command='{0}' LabelText='54'/>\r\n                        <Button MenuItemId='60' Id='60' Command='{0}' LabelText='60'/>\r\n                        <Button MenuItemId='66' Id='66' Command='{0}' LabelText='66'/>\r\n                        <Button MenuItemId='72' Id='72' Command='{0}' LabelText='72'/>\r\n                        <Button MenuItemId='80' Id='80' Command='{0}' LabelText='80'/>\r\n                        <Button MenuItemId='88' Id='88' Command='{0}' LabelText='88'/>\r\n                        <Button MenuItemId='96' Id='96' Command='{0}' LabelText='96'/>\r\n                     </Controls>\r\n               </MenuSection>\r\n            </Menu>",
"2016320825");return 32}pkj(a,b,c,f,l){if(1===c)return this.ia.Ma(aa.a.renderColorPicker,1,l);u.AFrameworkApplication.Va.Ma(D.a.EDb,2,l);a=new Jb.a(l&&0<=l.fontColor&&16777215>=l.fontColor?l.fontColor:0);b={};b.currentColor=a;b.handleCommand=aa.a.j$c;b.hideAlphaSlider=!0;return this.ia.Ma(aa.a.renderColorPicker,2,b)}qkj(a,b,c,f,l){if(1===c)return this.ia.Ma(aa.a.Ms,c,l);if(!l)return za.a.J(595186523,820,10,"HandleMoreFontColorsResponse: actionData is null"),16;if(a=fu.a.parse(l.Color))return a=this.ia.Ma(aa.a.Ms,
c,"@"+a.RGBColor),32===a&&this.ia.Ma(aa.a.zza,c,l),a;za.a.J(595186521,820,10,"HandleMoreFontColorsResponse: failed to parse colorinfo, colorInfo is null");return 8}llj(a,b,c,f,l){if(1===c)return 32;a=(a=this.sa.ny())?a.Ye:null;b=aa.a.XCb;var w=aa.a.j$c;c=this.Wb.Bf.I1;if(!l.MenuId||0>Ja.a.vg(l.MenuId).indexOf("floatie")){f=b.toString();w=w.toString();b=Object.assign(new Kl.a,{Id:"menuFontColor",MenuSectionList:[]});const F=qd.a("ColorPickerHighlighterFix")?DE.a.themeColors:"Colors";Array.add(b.MenuSectionList,
Rk.e(a,F,"Font.Color.Menu.Controls","fontColor","ThemeFontColorPicker",f,0,!this.iIg));Array.add(b.MenuSectionList,Rk.d("fontColor","Font.Color.Menu.Controls","fontColor","StandardFontColorPicker",f,!0));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",!1)),Array.add(b.MenuSectionList,Rk.c(c,"Recent Colors","Font.Color.Menu.Controls","recentColor","FontRecentColors",w,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",
!0));Array.add(b.MenuSectionList,Rk.a("More Font Color","Font.Color.Menu.Controls","862825906",ResourceStrings.l_MoreFontColors,"Color.Menu.MoreFontColors","MoreFontColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFontColorsKeytip));if(qd.a("ColorPickerHighlighterFix")&&(c=new Vs,32===u.AFrameworkApplication.Va.Ma(D.a.EDb,2,c)&&c&&!c.pZb))if(c=c.fontColor,-1===c)Rk.h(b,null,a);else if(c=Ul.i(c)||"",c=fu.a.parse(c))c=If.Box4ColorHelper.EBa(c.cJa(),a),Rk.h(b,c,a);l.MenuItems=b}else a=
this.YCg.$6f(a,!this.iIg),l.PopulationXML=a.Qdi(b,c,aa.a.j$c);return 32}oij(a,b,c){if(!this.sa.jD())return 16;if(1===c)return 32;a=this.sa.he();if(!a||1!==a.length)return 16;this.sa.selectShape(a[0],!0);this.Ga.Bd();return 32}hkj(){return 32}YGa(a,b,c,f,l){if(1===c)return 32;a=new Kl.a;a.MenuSectionList=[];b=Object.assign(new nk.a,{ControlList:[]});for(c=0;5>c;++c)f=Object.assign(new Oy.a,{Id:"buttonLineSpacing"+hu.ube[c].replace(".","_"),LabelText:hu.ube[c].substring(0,3),ExternalId:"LineSpacingButton"+
hu.ube[c].replace(".","_")}),Array.add(b.ControlList,f);Array.add(a.MenuSectionList,b);l.MenuItems=a;return 32}Xgg(a,b,c,f,l){if(1===c)return 32;a=a===aa.a.m$c?1:a===aa.a.n$c?0:14;Kc.a.Db&&(1===a?Kc.a.Db.actionName="PowerPointPopulateListMarkerBulletsDropDown":0===a&&(Kc.a.Db.actionName="PowerPointPopulateListMarkerNumberingsDropDown"));!l.MenuId||0>Ja.a.vg(l.MenuId).indexOf("floatie")?l.MenuItems=this.uoi(a):l.PopulationXML=this.voi(a);return 32}qWa(a,b,c,f,l){var w=l.MenuItemId;a=l.queryResult;
c=l.LineSpacingValue;f=l.LineSpacingUnit;let F=!1;b=this.cab.qV(b.node);w=sg.a.ry(b.lineSpacing.value,w)&&2===b.lineSpacing.Of;if(-1===c)f=b.lineSpacing.Of,c=b.lineSpacing.value;else if(c!==b.lineSpacing.value||f!==b.lineSpacing.Of)c=f=0;0!==f&&(F=w);a.Yf(F);l.LineSpacingUnit=f;l.LineSpacingValue=c;return 32}c0(a,b,c,f,l){if(1===c)return 32;if(void 0===l||null===l)return za.a.J(8955530,820,10,"PandoraActor::SetLineSpacing - Null action data passed. "),8;c=this.Jb.ie(15);b=b.node;c.lc(b);c.fd=a;b.setValue(zb.a.TV,
2);a=l;this.b1j&&(a+=this.Fa.cXd(this.Fa.$m(b)));b.setValue(zb.a.Iw,a);c.dispose();return 32}lFf(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;c=new bN.a(l.Of,l.value);l=c.Of;c=c.value;switch(a){case aa.a.xfb:b.setValue(zb.a.gca,c);b.setValue(zb.a.lja,l);break;case aa.a.wfb:b.setValue(zb.a.fca,c),b.setValue(zb.a.kja,l)}return 32}inb(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;l=(new Yu.a(l.Of,l.value)).aM;c=this.C8.d7(b).aM;f=this.C8.hQa(b);switch(a){case aa.a.tia:b.setValue(Sb.a.Hl,l);break;
case aa.a.$Fb:b.setValue(Sb.a.Jn,l);break;case aa.a.bGb:b.setValue(Sb.a.Jn,-l);break;case aa.a.dGb:b.setValue(Sb.a.Jn,0);break;case aa.a.aGb:this.L$b&&b.setValue(Sb.a.Jn,l-c);break;case aa.a.cGb:this.L$b&&(this.gUa.Qu.ifb(b,(1===f.specialIndentType?c+f.aM:c-f.aM)-l),this.gUa.Qu.Ffd(b,1,l))}return 32}voi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="menuListMarkersDropDown">');b.append('<MenuSection Id="msListMarkersPosition" ShowMenuSectionSeparator="false" DispalyMode="Menu16">');b.append('<Gallery Id="galleryListMarkersPosition" Width="3" ElementDimensions="Size48by48">');
let c,f,l;switch(a){case 1:c="BulletsLibrary_";f=aa.a.xva;l=aa.a.hHa;break;case 0:c="NumberingLibrary_";f=aa.a.eWa;l=aa.a.Jdb;break;default:c="BulletsLibrary_",f=aa.a.xva,l=aa.a.hHa}for(let w=0;8>w;++w)b.append(String.format('<GalleryButton Id="{0}" Command="{1}" QueryCommand="{2}" InnerHTML="{3}" Alt="{4}" MenuItemId="{5}" ShouldSetTitle="true" />',c+w,f,l,Ja.a.le(String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',this.DZd(a,w),this.CZd(a,w))),this.y$f(a,w),w));b.append("</Gallery>");
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}uoi(a){const b=Object.assign(new Kl.a,{Id:"menuListMarkersDropDown",MenuSectionList:[]});Array.add(b.MenuSectionList,this.LAf(a));return b}LAf(a){var b="",c="";let f="",l=aa.a.xva,w=aa.a.hHa;switch(a){case 1:b="Bullets Library";f="BulletsLibrary_";l=aa.a.xva;w=aa.a.hHa;c="BulletLibrarySection";break;case 0:b="Numbering Library",f="NumberingLibrary_",l=aa.a.eWa,w=aa.a.Jdb,c="NumberingLibrarySection"}b=Object.assign(new nk.a,{Id:"msListMarkersPosition",
Title:b,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]});c=Object.assign(new qq.a,{Id:"galleryListMarkersPosition",ExternalId:c,ExternalGalleryId:this.TYd(a),Type:5,Width:3,ElementDimensions:"Size48by48",GalleryItems:[]});for(let F=0;8>F;++F)c.GalleryItems.push(this.SYd(a,F,f+F,l.toString(),w.toString(),this.y$f(a,F)));Array.add(b.ControlList,c);return b}TYd(a){switch(a){case 1:return"BulletLibraryGallery";case 0:return"NumberingLibraryGallery";default:return""}}SYd(a,b,c,f,l,w){a=
Object.assign(new kz,{LevelInfo:this.V3i(a,b)});a.Id=c;a.Command=f;a.QueryCommand=l;a.Alt=w;a.ShouldSetTitle="true";a.MenuItemId=b.toString();return a}V3i(a,b){const c=[],f={};f.fontFamily=da.FontUtils.eha("Calibri");if(!b)return Object.assign(new Ok,{textAtLevel:Box4Intl.Box4Strings.L_ListStyleNone,styleAtLevel:f});f.fontFamily=da.FontUtils.eha(this.A$f(a,b));1===a?(a=this.$K.fVc.ga(b).xIf,c.push(Object.assign(new Ok,{textAtLevel:a,styleAtLevel:f})),c.push(Object.assign(new Ok,{textAtLevel:a,styleAtLevel:f})),
c.push(Object.assign(new Ok,{textAtLevel:a,styleAtLevel:f}))):0===a&&(a=this.$K.fVc.ga(b).EUg,c.push(Object.assign(new Ok,{textAtLevel:a[0],styleAtLevel:f})),c.push(Object.assign(new Ok,{textAtLevel:a[1],styleAtLevel:f})),c.push(Object.assign(new Ok,{textAtLevel:a[2],styleAtLevel:f})));return c}y$f(a,b){return 1===a?this.$K.azg.ga(this.$K.w0b(b)):0===a?this.$K.azg.ga(this.$K.sNc(b)):""}CZd(a,b){return b?1===a?(a=this.$K.fVc.ga(b).xIf,this.eHa([a,a,a])):0===a?(a=this.$K.fVc.ga(b).EUg,this.eHa(a)):
"":Box4Intl.Box4Strings.L_ListStyleNone}eHa(a){return a&&3===a.length?String.format('<DIV class="ListNumberPreview" style="padding-left: 2pt; font-size: 9pt; ">{0}{1}{2}</DIV>',this.ZBa(a[0]),this.ZBa(a[1]),this.ZBa(a[2])):""}ZBa(a){return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}DZd(a,b){const c=new Sys.StringBuilder;c.append("position: relative; ");b?(c.append("font-family: "),c.append(da.FontUtils.eha(this.A$f(a,
b))),c.append("; "),c.append("font-size: 24pt;")):(c.append("font-size: 12pt; "),c.append("top: 22%;"));c.append("color: black;");return c.toString()}A$f(a,b){return 1===a?this.$K.nSa.ga(this.$K.w0b(b)).Tnb:0===a?"Calibri":""}EYf(){let a=16;if(this.sa.E7())return 16;const b=this.sa.Dq(),c=this.sa.Mo();if(b&&b.ovb||c)a=32;return a}static ZKj(a){return!!a&&(a.Dsh||a.rd)}}hu.ube=["1.00","1.50","2.00","2.50","3.00"];Object(e.a)(hu,"PandoraActor",null,[234]);var PQ=d(729);class iu{constructor(a,b){this.otd=
this.O_a=null;this.Da=a;this.kya=b;if(this.Hie=u.AFrameworkApplication.fa.ka("HandleRaceConditionInHostManagerInit"))this.otd=PQ.a.create();this.qM=lb.a.instance.Oa("Common.ISystemInitiatedFeedback")}get NP(){return this.O_a}wb(){this.Da.ra(G.a.close,de.a.frame,Object(C.a)(this,this.closeDocument,"closeDocument"),2176);this.Da.ra(G.a.JYb,de.a.frame,Object(C.a)(this,this.JYb,"fileProperties"),128);this.Da.ya(G.a.gPa,de.a.frame,Object(C.a)(this,this.gPa,"fileSharing"));this.Da.ra(G.a.copyAndEdit,de.a.frame,
Object(C.a)(this,this.copyAndEdit,"copyAndEdit"),128);this.Da.ra(G.a.BEb,de.a.frame,Object(C.a)(this,this.BEb,"replyWithChanges"),128);this.Da.ra(G.a.QKe,de.a.frame,Object(C.a)(this,this.SOi,"fileVersion"),128);this.Da.ya(G.a.downloadACopy,de.a.frame,Object(C.a)(this,this.downloadACopy,"downloadACopy"));this.Da.ya(G.a.QGi,de.a.frame,Le.ActionManager.Dg);this.Da.ra(G.a.fEe,de.a.frame,Object(C.a)(this,this.fEe,"reportAbuseLink"),128);this.Da.ra(G.a.zhd,de.a.frame,Object(C.a)(this,this.Dkc,"signInInternal"),
128);this.Da.ya(G.a.workflow,de.a.frame,Object(C.a)(this,this.workflow,"workflow"));u.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&this.Da.ra(G.a.ead,de.a.frame,Object(C.a)(this,this.ead,"queryBreadcrumbDocName"),96);this.Da.ra(G.a.jAe,de.a.frame,Object(C.a)(this,this.jAe,"queryCopyAndEditButton"),96);u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this.Da.ra(G.a.gAe,de.a.frame,Object(C.a)(this,this.gAe,"queryBuildVersion"),2144),this.Da.ra(G.a.QAe,
de.a.frame,Object(C.a)(this,this.QAe,"querySessionId"),2144));this.Da.ya(G.a.DVb,de.a.frame,Object(C.a)(this,this.DVb,"conversation"));this.kya.execute(Object(C.a)(this,this.Mcc,"onHostPostmessengerCreated"));Z.ULS.sendTraceTag(536987588,306,50,"WebAppFrameCommandUIActor-RegisterActions done.")}Mcc(a){this.O_a=a;this.Hie&&(this.otd.instance=a);Z.ULS.sendTraceTag(536987589,306,this.NP?50:10,String.format("OnHostPostmessengerCreated - Setting OnHostPostmessengerCreated as null value = {0}",!this.NP))}yVj(){u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateSharingComplexity",
!1)&&this.qM&&this.qM.execute(a=>{a.logActivity("CollabCornerSurveyLogSharingCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})}closeDocument(a,b,c,f,l){a=2===c;c=Ii.h;l&&(c=l);return b&&a&&!this.aBc(c)?8:this.Ami(a,c)}aBc(){return!0}Ami(a,b){if(u.AFrameworkApplication.Ba.jb.VJe("3033402446"))return Z.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),this.Dma(a,Xe.a.A1f,!0,{});if(u.AFrameworkApplication.Uhc&&
b&&b===Ii.f)return Z.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),u.AFrameworkApplication.Ba.aO(a,u.AFrameworkApplication.Uhc);if(u.AFrameworkApplication.isEmbedded)return a&&Z.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(u.AFrameworkApplication.ANf){if(!a)return 32;Z.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");try{return window.top.close(),32}catch(l){return Z.ULS.sendTraceTag(6070360,
306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",l),8}}let c=u.AFrameworkApplication.lDc;if(!c)return a&&Z.ULS.sendTraceTag(6070361,306,50,"CloseDocumentInternal - no closeUrl found"),8;b||(b=Ii.h);if(b===Ii.c||b===Ii.h)return u.AFrameworkApplication.Ba.aO(a,c);let f;if(u.AFrameworkApplication.LWa)return a&&Z.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),f=b===Ii.d||b===Ii.b?this.Dma(a,Xe.a.BEb,u.AFrameworkApplication.snc,{["event_source"]:b}):
2,32!==f?(c=b?Jf.a.aj(u.AFrameworkApplication.LWa,Ii.e,b):u.AFrameworkApplication.LWa,u.AFrameworkApplication.Ba.aO(a,c)):f;a&&Z.ULS.sendTraceTag(6070363,306,50,"CloseDocumentInternal - Using FileClose postmessage");f=b===Ii.b?this.Dma(a,Xe.a.A1f,u.AFrameworkApplication.bTe,null):2;return 32!==f?u.AFrameworkApplication.Ba.aO(a,c):f}Dkc(a,b,c,f,l){a=this.Dma(2===c,Xe.a.zhd,!0,l);8===a&&(window.top.location=u.AFrameworkApplication.signInUrl,a=32);return a}JYb(a,b,c){a=this.Dma(2===c,Xe.a.JYb,u.AFrameworkApplication.xBh,
null);return 32!==a?u.AFrameworkApplication.Ba.aO(2===c,u.AFrameworkApplication.F1f):a}gPa(a,b,c,f,l){if(1===c)return mz.SessionStatusManager.instance.nia?8:32;a=G.a.u5k;b=xg.a.create().toString();f={};f.event_source=l;f[yh.a.Ujc]=b;var w=l?l.nav:null;w&&(f[yh.a.x5k]=w);l&&"CopyLink"===l.SourceControlId&&(l.mode="copy",a=G.a.t5k);l&&"ManageAccess"===l.SourceControlId&&(l.mode="manageAccess",a=G.a.v5k);l&&"ShareTopBar"===l.SourceControlId&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",
!1)&&iu.ep.raiseEvent(iu.gji);(w=l?l.mode:null)&&(f[yh.a.w5k]=w);if(2===c){const F={};F[yh.a.Ujc]=b;w&&(F.mode=w);Z.ULS.sendTraceTag(38278995,306,50,md.c(F));this.yVj()}b=this.Dma(2===c,Xe.a.H5k,u.AFrameworkApplication.dTe,f);if(32!==b){if(u.AFrameworkApplication.KYb)return l=l?Jf.a.aj(u.AFrameworkApplication.KYb,Ii.e,l):u.AFrameworkApplication.KYb,u.AFrameworkApplication.Ba.aO(2===c,l,!0);Z.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",
{["Result"]:b})}qf.c(a);return b}DVb(a,b,c){return this.Dma(2===c,Xe.a.DVb,!0,{})}workflow(a,b,c){a=this.Dma(2===c,Xe.a.workflow,u.AFrameworkApplication.jTe,{["WorkflowType"]:u.AFrameworkApplication.Rnc});if(32!==a){if(u.AFrameworkApplication.Qmd)return u.AFrameworkApplication.Ba.aO(2===c,u.AFrameworkApplication.Qmd,!0);Z.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",{["Result"]:a})}return a}fEe(a,b,c){a=2===c;return b&&a&&!this.aBc(Ii.f)?8:u.AFrameworkApplication.Ba.aO(a,
u.AFrameworkApplication.Uhc)}copyAndEdit(a,b,c){a={};2===c&&(a=u.AFrameworkApplication.Ba.jb.v7f());a=this.Dma(2===c,Xe.a.copyAndEdit,u.AFrameworkApplication.wBh,a);return 32!==a?u.AFrameworkApplication.Ba.aO(2===c,u.AFrameworkApplication.QNd,u.AFrameworkApplication.hideHeader):a}downloadACopy(a,b,c){return 1===c?u.AFrameworkApplication.AL||u.AFrameworkApplication.SP||mz.SessionStatusManager.instance.nia?8:32:u.AFrameworkApplication.Ba.aO(2===c,u.AFrameworkApplication.uOa,!0)}BEb(a,b,c){a=2===c;if(b&&
a&&!this.aBc(Ii.d))return 8;b=this.Dma(a,Xe.a.BEb,u.AFrameworkApplication.snc,{["event_source"]:Ii.d});return 32!==b?(b=Jf.a.aj(u.AFrameworkApplication.LWa,Ii.e,Ii.d),u.AFrameworkApplication.Ba.aO(a,b)):b}SOi(a,b,c){a=this.Dma(2===c,Xe.a.TOi,u.AFrameworkApplication.eTe,null);return 32!==a?u.AFrameworkApplication.Ba.aO(2===c,u.AFrameworkApplication.LUd):a}ead(a,b,c,f,l){if(2===c){if(!l)return 8;l.Value=Ja.a.jG(u.AFrameworkApplication.$t.nx)}return 32}gAe(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=
u.AFrameworkApplication.instance.eEi}return 32}QAe(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=u.AFrameworkApplication.instance.fEi}return 32}Dma(a,b,c,f){return this.Hie?this.FXk(a,b,c,f):c?a?this.NP.sendMessage(b,f)?32:8:32:2}FXk(a,b,c,f){return c?a?this.NP?this.NP.sendMessage(b,f)?32:8:(Z.ULS.sendTraceTag(528234241,306,15,"SendPostmessage called when HostPostmessenger was not initialized yet.Queueing the request."),this.otd.execute(()=>{Z.ULS.sendTraceTag(528234242,306,50,"HostPostmessenger now available. Executing the request.");
this.NP.sendMessage(b,f)}),32):32:2}jAe(a,b,c,f,l){if(2===c){if(!l)return 8;u.AFrameworkApplication.fa.ka("IsEditAndReplyFlow")&&(l.LabelText=CommonUIStrings.l_EditAndReply)}return 32}}iu.ep=new sd.a;iu.gji="CheckEditorSuggestions";Object(e.a)(iu,"WebAppFrameCommandUIActor",null,[]);class cN extends iu{constructor(a,b,c,f,l,w,F){super(a,b);this.lu=c;this.CD=f;this.sa=l;this.Ha=w;this.Za=F}wb(){super.wb();this.Ha.pptEnablePreviousVersionsOptionForOneDriveConsumer&&this.Da.ya(aa.a.v4g,de.a.frame,Object(C.a)(this,
this.Hye,"pptoShowFileVersion"))}Hye(a,b,c){return 1===c&&this.Za.Wba?2:this.Da.processAction(G.a.QKe,c)}workflow(a,b,c,f,l){if(1===c)return 32;this.sa.Rh();this.lu.PLe(!0,ResourceStrings.l_Loading,a);za.a.J(20187205,801,50,"PPT save and launch workflow");this.CD.d2(!1,!0,()=>{this.Sgi(l)},Object(C.a)(this,this.Yva,"saveFailureCallback"));return 32}aBc(a){return a!==Ii.a||u.AFrameworkApplication.isEmbedded||u.AFrameworkApplication.ANf||u.AFrameworkApplication.lDc||this.sHj()?!0:(za.a.J(37007442,306,
15,"PptWebAppFrameCommandUIActor::BeforeCloseDocument - CloseUrl is null, fallback to RefreshPage"),this.Da.Ma(aa.a.refresh,2,{refreshtrigger:"PptWebAppFrameCommandUIActor::BeforeCloseDocument"}),!1)}sHj(){var a=u.AFrameworkApplication.fa.Ia(u.AFrameworkApplication.lJ);a=u.AFrameworkApplication.R8a&&!!a&&"teams"===a.toLowerCase();return qd.a("ReactDialogsProtocolLaunchingTeamsFix")&&this.Ha.ISd&&a&&u.AFrameworkApplication.Ba.jb.VJe("3033402446")}Sgi(a){this.lu.hide();super.workflow(0,null,2,null,
a)}Yva(){this.lu.hide();return!1}}Object(e.a)(cN,"PptWebAppFrameCommandUIActor",iu,[]);class dN{constructor(a,b,c){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("focusManager");if(!c)throw Error.argumentNull("presentationReader");this.ia=a;this.Ga=b;this.qc=c}wb(){this.ia.ra(aa.a.Qcd,$b.a.application,Object(C.a)(this,this.Qcd,"replaceFonts"),4)}Fe(){const a=[this.Ga.Bc(Ai.a.zB),this.Ga.Bc(Ai.a.VU),this.Ga.Bc(Xd.a.sg),this.Ga.Bc(Xd.a.QM)];for(const b of a)b.bindAction(A.KeyInputManager.La(x.a.MJb,
A.KeyInputManager.He),aa.a.Qcd)}Qcd(a,b,c){return b.contextId!==$b.a.application?2:1===c?this.qc.wj()?32:8:32}}Object(e.a)(dN,"ReplaceFontsActor",null,[]);var eN=d(1035);class fN extends Sys.EventArgs{constructor(a,b,c){super();this.ZUg=a;this.ola=b;this.Ru=c}}Object(e.a)(fN,"RibbonTabSwitchedEventArgs",Sys.EventArgs,[]);class gN{constructor(a,b,c,f,l,w,F,S){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("frameContext");if(!c)throw Error.argumentNull("ribbonUser");
if(!f)throw Error.argumentNull("focusManager");if(!F)throw Error.argumentNull("ribbonExternal");this.Ga=f;this.ia=a;this.uI=b;this.BD=c;this.lDg=l;this.Ue=w;this.I$b=F;this.UWj=S}wb(){this.ia.ya(G.a.jFe,de.a.frame,Object(C.a)(this,this.Qkk,"onRibbonFocus"));this.ia.ra(G.a.YSk,de.a.frame,Object(C.a)(this,this.Bmj,"handleRibbonStateChanged"),64);this.ia.ya(G.a.bkd,$b.a.application,Object(C.a)(this,this.bkd,"toggleRibbonState"));this.ia.ya(G.a.aTk,Db.a.view,Object(C.a)(this,this.Cmj,"handleRibbonTabSwitched"));
this.ia.ya(G.a.Hdd,Db.a.view,Object(C.a)(this,this.Hdd,"ribbonModeToggledToMLR"));this.ia.ya(G.a.Idd,Db.a.view,Object(C.a)(this,this.Idd,"ribbonModeToggledToSLR"));Oc.a.get_instance().Ak(7,Object(C.a)(this,this.registerOnShyRibbonStateChange,"registerOnShyRibbonStateChange"))}Fe(){const a=v.FocusManager.instance().Bc(Ai.a.RIf);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.boc,A.KeyInputManager.He),G.a.bkd);y.AFrame.Uj(a,A.KeyInputManager.La(r.a.ak?x.a.Rea:x.a.qmd,1),G.a.jFe);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.Ahb,
r.a.ak?2:1),G.a.jFe);this.UWj&&(this.uI.W8a.Zbd(ra.a.ol,window.document,Object(C.a)(this,this.Srj,"ignoreAltKeyUpOnDocument")),lE.a.instance().hCf(Object(C.a)(this,this.Bjk,"onOnlyAltKeyPressed")))}Hdd(a,b,c){try{if(1===c)return 32;qd.a("ReactMLRReuseSLRCookieForMLR")?this.Mkh(!1):this.ujc(!0);za.a.J(587532289,822,50,"[ReactRibbon] - Ribbon mode toggled to MLR");this.uI.oQa()}catch(f){za.a.J(587532259,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to MLR",f)}return 32}Idd(a,b,c){try{if(1===
c)return 32;qd.a("ReactMLRReuseSLRCookieForMLR")||this.ujc(!1);this.Mkh(!0);za.a.J(587532257,822,50,"[ReactRibbon] - Ribbon mode toggled to SLR");this.uI.oQa()}catch(f){za.a.J(587532255,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to SLR",f)}return 32}Mkh(a){Di.a.LL(u.AFrameworkApplication.fa.Ia("IsSimplifiedRibbonOnCookieName"),a.toString(),Di.a.qL)}ujc(a){Di.a.LL(u.AFrameworkApplication.fa.Ia("ReactRibbonMLRPreferenceCookieName"),a.toString(),Di.a.qL)}Bmj(a,b,c){if(1===c)return 32;this.uI.oQa();
return 32}bkd(){return 32}Cmj(a,b,c,f,l){if(!l)return 8;l&&l.NewContextId!==l.OldContextId&&(a=0,l&&l[yn.a.Ru]&&(a=l[yn.a.Ru]),this.Ue.mDk(new fN(l.OldContextId,l.NewContextId,a)));this.Ga.ye&&2===l[yn.a.Ru]&&this.Ga.ye.name===Xd.a.hea&&(b=b.view)&&!Ja.a.Xa(b.NH)&&this.Ga.vf(b.NH);return 32}Bjk(){eN.a.instance.keyCode===x.a.mZa&&(appChrome.api.inKeytipMode()?appChrome.api.exitKeytipMode():appChrome.api.enterKeytipMode(),this.hhg())}Srj(a){return a.nc.keyCode===x.a.mZa}hhg(){if(document.activeElement&&
document.activeElement.id!==nf.a.TUb)return this.Ga.tvh(!this.lDg.inKeytipMode,!1),32;this.Ga.ye&&this.Ga.tvh(this.Ga.ye.name===Xd.a.hea||this.lDg.inKeytipMode,!0);return 32}Qkk(a,b,c){return 1===c?32:this.hhg()}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.mo&&Pg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{if(3===a&&3!==b||0===a&&3===b)za.a.J(555861645,822,50,"[ReactRibbon] - Ribbon shy mode toggled. Relayout the app."),
this.uI.oQa()})}}Object(e.a)(gN,"RibbonStateActor",null,[234]);class cA{constructor(a,b){this.sectionIndex=a;this.slideIndex=b}}Object(e.a)(cA,"SelectSectionAndSlidesData",null,[]);class hN{constructor(a,b,c,f,l){this.uUa=null;this.ia=a;this.Gz=b;this.ua=c;this.l$b=f;this.Tv=l;this.l$b.ZF(Object(C.a)(this,this.YA,"onChildTopologyChanged"));this.ua.presentation&&(this.uUa=this.ua.presentation.xp)}wb(){this.ia.ra(aa.a.pbh,Db.a.application,Object(C.a)(this,this.lmj,"handleRemoveSection"),4);this.ia.ra(aa.a.FSg,
Db.a.application,Object(C.a)(this,this.vkj,"handleMoveSectionUp"),4);this.ia.ra(aa.a.ESg,Db.a.application,Object(C.a)(this,this.ukj,"handleMoveSectionDown"),4);this.ia.ra(aa.a.NSe,Db.a.application,Object(C.a)(this,this.Lnj,"handleUpdateSectionTitle"),4);this.ia.ra(aa.a.ymb,Db.a.application,Object(C.a)(this,this.hhj,"handleAddSection"),4)}Fe(){}Lnj(a,b,c,f,l){if(1===c)return(a=this.ua.presentation)&&a.xp&&a.xp.length?32:8;if(!l)return za.a.J(50647327,822,10,"HandleUpdateSectionTitle with null action data."),
8;this.Gz.ULi(l);return 32}lmj(a,b,c){b=this.ua.qA;const f=this.ua.taa;if(1===c){const l=this.ua.presentation;if(!l||!l.xp||!l.xp.length)return 8;if(!b&&1<l.xp.length)return f&&!f.NL.length?32:8}if(2===c){za.a.J(50652321,822,50,"HandleRemoveSection called.");try{f&&this.Gz.NLi(b,a),this.uUa=this.ua.presentation.xp,this.ia.Ma(aa.a.Ced,2,new cA(this.ua.qA,this.ua.Ca.slideIndex))}catch(l){za.a.J(50689955,822,10,"SectionActor: Exception in HandleRemoveSection: {0}.",l)}}return 32}vkj(a,b,c){a=this.ua.qA;
if(1===c)return c=this.ua.presentation,!c||!c.xp||!c.xp.length||0>=a?8:32;if(2===c){za.a.J(50652323,822,50,"HandleMoveSectionUp called.");try{-1!==a&&(this.Gz.H_f(a,!0),this.ia.Ma(aa.a.Ced,2,new cA(this.ua.qA,this.ua.Ca.slideIndex)))}catch(f){za.a.J(50856024,822,10,"SectionActor: Exception in HandleMoveSectionUp: {0}.",f)}}return 32}ukj(a,b,c){a=this.ua.qA;if(1===c)return(c=this.ua.presentation)&&c.xp&&c.xp.length&&a!==c.xp.length-1&&-1!==a?32:8;if(2===c){za.a.J(50652353,822,50,"HandleMoveSectionDown called.");
try{-1!==a&&(this.Gz.H_f(a,!1),this.ia.Ma(aa.a.Ced,2,new cA(this.ua.qA,this.ua.Ca.slideIndex)))}catch(f){za.a.J(50856027,822,10,"SectionActor: Exception in HandleMoveSectionDown: {0}.",f)}}return 32}hhj(a,b,c){if(2===c){b=-1;c=this.ua.qA;za.a.J(50676807,822,50,"HandleAddSection called.");try{this.Gz.uLi(this.ua.Ca,a),b=this.ua.qA}catch(f){za.a.J(50676809,822,10,"SectionActor: Exception in HandleAddSection: {0}.",f)}-1!==b&&b!==c&&this.ia.processAction(aa.a.qQe,2)}return 32}YA(a,b){try{if(34===b.GY&&
!b.node.isDirty){const c=this.uUa?Array.clone(this.uUa):null;this.uUa=Array.clone(this.ua.presentation.xp);if(!c&&this.uUa||c.length<this.uUa.length)2===this.uUa.length&&-1===this.ua.qA&&(this.ua.qA=1),this.Tv?this.Tv.FBe():za.a.J(51172877,822,10,"SectionActor: graphOperationEventNotifier is null for raising event."),this.ia.processAction(aa.a.qQe,2)}}catch(c){za.a.J(51144129,822,10,"SectionActor: Exception in OnChildTopologyChanged: {0}.",c)}}dispose(){this.l$b.kO(Object(C.a)(this,this.YA,"onChildTopologyChanged"))}}
Object(e.a)(hN,"SectionActor",null,[234]);var iN=d(617);class jN{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td){if(!Dc)throw Error.argumentNull("viewEventNotifier");this.ia=a;this.Df=b;this.Ga=c;this.uN=f;this.Wb=l;this.ua=w;this.ob=F;this.XB=S;this.Ub=fa;this.ISa=xa;this.Je=Za;this.Op=pb;this.V3=Mb;this.Fa=hc;this.KA=kc;this.j9=Ec;this.rta=Hc;this.Ue=Dc;this.Z_j=Td}wb(){this.ia.ya(aa.a.Jjd,$b.a.application,Object(C.a)(this,this.eFb,"selectNextSlideHandler"));this.ia.ya(aa.a.Kjd,$b.a.application,
Object(C.a)(this,this.eFb,"selectNextSlideHandler"));this.ia.ya(aa.a.FYa,$b.a.application,Object(C.a)(this,this.eFb,"selectNextSlideHandler"));this.ia.ya(aa.a.EYa,$b.a.application,Object(C.a)(this,this.eFb,"selectNextSlideHandler"));this.ia.ya(aa.a.Ugb,$b.a.application,Object(C.a)(this,this.eFb,"selectNextSlideHandler"));this.ia.ya(aa.a.Tgb,$b.a.application,Object(C.a)(this,this.eFb,"selectNextSlideHandler"));this.Op&&(this.ia.ya(aa.a.bmc,$b.a.application,Object(C.a)(this,this.Msb,"handleKeyboardMultiSelectSlides")),
this.ia.ya(aa.a.Wlc,$b.a.application,Object(C.a)(this,this.Msb,"handleKeyboardMultiSelectSlides")),this.ia.ya(aa.a.Ylc,$b.a.application,Object(C.a)(this,this.Msb,"handleKeyboardMultiSelectSlides")),this.ia.ya(aa.a.Xlc,$b.a.application,Object(C.a)(this,this.Msb,"handleKeyboardMultiSelectSlides")),this.ia.ya(aa.a.amc,$b.a.application,Object(C.a)(this,this.Msb,"handleKeyboardMultiSelectSlides")),this.ia.ya(aa.a.$lc,$b.a.application,Object(C.a)(this,this.Msb,"handleKeyboardMultiSelectSlides")),this.ia.ya(aa.a.thh,
$b.a.application,Object(C.a)(this,this.oWk,"selectAllSlidesHandler")),this.ia.ya(aa.a.Meb,$b.a.application,Object(C.a)(this,this.Emj,"handleScrollSelectedThumbnailsIntoView")));this.ia.ya(aa.a.$Eb,$b.a.application,Object(C.a)(this,this.Dmj,"handleScrollActiveThumbnailIntoViewSlim"));this.ia.ya(aa.a.aYa,$b.a.application,Object(C.a)(this,this.Dhh,"selectNextShapeHandler"));this.ia.ya(aa.a.WGb,$b.a.application,Object(C.a)(this,this.Dhh,"selectNextShapeHandler"));this.ia.ya(aa.a.LIb,$b.a.application,
Object(C.a)(this,this.Xpl,"unselectShapesHandler"));this.ia.ya(aa.a.Nic,$b.a.application,Object(C.a)(this,this.nWk,"selectAllShapesHandler"));this.ia.ya(aa.a.Ylh,$b.a.application,Object(C.a)(this,this.b5k,"shapeEscapeKeyPressedHandler"));this.ia.ya(aa.a.$fb,$b.a.application,Object(C.a)(this,this.wOc,"handleSlideScopeArrowKeyboard"));this.ia.ya(aa.a.agb,$b.a.application,Object(C.a)(this,this.wOc,"handleSlideScopeArrowKeyboard"));this.ia.ya(aa.a.bgb,$b.a.application,Object(C.a)(this,this.wOc,"handleSlideScopeArrowKeyboard"));
this.ia.ya(aa.a.cgb,$b.a.application,Object(C.a)(this,this.wOc,"handleSlideScopeArrowKeyboard"));this.ia.ya(aa.a.Jqh,$b.a.application,Object(C.a)(this,this.hnj,"handleSpaceKeyPressed"));this.ia.ya(aa.a.y3g,$b.a.application,Object(C.a)(this,this.Ssk,"playVideoCommandHandler"))}Fe(){var a=this.Ga.Bc(Ai.a.zB);const b=this.Ga.Bc(Xd.a.sg),c=this.Ga.Bc(Xd.a.QM);a.bindAction(A.KeyInputManager.La(x.a.tq,0),aa.a.Jjd);a.bindAction(A.KeyInputManager.La(x.a.tq,4),aa.a.Kjd);a.bindAction(A.KeyInputManager.La(x.a.iB,
0),aa.a.FYa);a.bindAction(A.KeyInputManager.La(x.a.C0,0),aa.a.FYa);a.bindAction(A.KeyInputManager.La(x.a.hB,0),aa.a.EYa);a.bindAction(A.KeyInputManager.La(x.a.A0,0),aa.a.EYa);a.bindAction(A.KeyInputManager.La(x.a.dE,0),aa.a.Ugb);a.bindAction(A.KeyInputManager.La(x.a.mw,0),aa.a.Tgb);this.Op&&(a.bindAction(A.KeyInputManager.La(x.a.C0,4),aa.a.bmc),a.bindAction(A.KeyInputManager.La(x.a.A0,4),aa.a.Wlc),a.bindAction(A.KeyInputManager.La(x.a.dE,4),aa.a.Ylc),a.bindAction(A.KeyInputManager.La(x.a.mw,4),aa.a.Xlc),
a.bindAction(A.KeyInputManager.La(x.a.iB,4),aa.a.amc),a.bindAction(A.KeyInputManager.La(x.a.hB,4),aa.a.$lc),a.bindAction(A.KeyInputManager.La(x.a.rZa,2),aa.a.thh));b.bindAction(A.KeyInputManager.La(x.a.iB,0),aa.a.FYa);b.bindAction(A.KeyInputManager.La(x.a.hB,0),aa.a.EYa);b.bindAction(A.KeyInputManager.La(x.a.dE,0),aa.a.Ugb);b.bindAction(A.KeyInputManager.La(x.a.mw,0),aa.a.Tgb);b.bindAction(A.KeyInputManager.La(x.a.tq,0),aa.a.aYa);b.bindAction(A.KeyInputManager.La(x.a.tq,4),aa.a.WGb);b.bindAction(A.KeyInputManager.La(x.a.B0,
0),aa.a.Ylh);b.bindAction(A.KeyInputManager.La(x.a.rZa,2),aa.a.Nic);b.bindAction(A.KeyInputManager.La(x.a.k5,0),aa.a.$fb);b.bindAction(A.KeyInputManager.La(x.a.q$,0),aa.a.agb);b.bindAction(A.KeyInputManager.La(x.a.Sea,0),aa.a.bgb);b.bindAction(A.KeyInputManager.La(x.a.OX,0),aa.a.cgb);a=A.KeyInputManager.La(x.a.iB,0);c.Wo(a);c.bindAction(a,aa.a.FYa);a=A.KeyInputManager.La(x.a.hB,0);c.Wo(a);c.bindAction(a,aa.a.EYa);b.bindAction(A.KeyInputManager.La(x.a.wO,0),aa.a.Jqh)}eFb(a,b,c){if(this.uN.oZ||this.Df.gd(this.Wb.Bf))return 16;
if(1===c)return 32;if(!this.Wb.Bf||!this.ua.Ca)return 16;32===this.ia.processAction(aa.a.Tbc,1)&&this.ia.processAction(aa.a.Sbc,2);b=this.g6i(this.ua.Ca,a);if(b===this.ua.Ca.Ge)return 32;if(this.KA&&a!==aa.a.Ugb&&a!==aa.a.Tgb&&(a=this.Je.s2(b),!a||!a.GV))return 16;this.Ga.Vaa===Xd.a.sg&&this.Ga.Bd();return this.Je.rda(b)}g6i(a,b){a=a.Ge;const c=this.Ub.wj();switch(b){case aa.a.EYa:a=Math.min(a+1,c-1);break;case aa.a.Jjd:a=a+1>c-1?0:a+1;break;case aa.a.FYa:a=Math.max(a-1,0);break;case aa.a.Kjd:a=0>
a-1?c-1:a-1;break;case aa.a.Ugb:a=0;break;case aa.a.Tgb:a=c-1}return a}Msb(a,b,c){if(this.uN.oZ||this.Df.gd(this.Wb.Bf)||!this.Wb.Bf||!this.ua.Ca)return 16;if(1===c)return 32;32===this.ia.processAction(aa.a.Tbc,1)&&this.ia.processAction(aa.a.Sbc,2);if(1>=this.Ub.wj())return 32;za.a.J(34395531,816,50,"Selected multiple Slides by Shift+Up/Down, Shift+Home/End and Shift+PageUp/PageDown");switch(a){case aa.a.bmc:case aa.a.Wlc:case aa.a.Ylc:case aa.a.Xlc:this.Jnj(a);break;case aa.a.amc:case aa.a.$lc:this.Mkj(a);
break;default:return za.a.J(25751680,816,50,"SelectionActor::HandleKeyboardMultiSelectSlides does not recognize this action"),8}return 32}hbj(a,b){const c=[];var f=this.Ub.wj();for(b=b>f-1?f-1:b;a<=b;a++)(f=this.Ub.UH(a))&&c.push(f);return c}Jnj(a){if(!this.ua.Ca)throw Error.argumentNull("ActiveSlide is null");const b=this.ob.rf();b.sort((Za,pb)=>Za.Ge-pb.Ge);const c=b[0].Ge,f=b[b.length-1].Ge,l=this.ua.Ca.Ge,w=this.Ub.wj();var F=[];let S=l,fa=l,xa=l;F=!0;switch(a){case aa.a.bmc:1===b.length?xa=S=
0<=l-1?l-1:l:l===c?fa=0<=f-1?f-1:f:c?xa=S=c-1:F=!1;break;case aa.a.Wlc:1===b.length?xa=fa=l<w-1?l+1:l:l===c&&f<w-1?xa=fa=f+1:l===c&&f===w-1?F=!1:S=c+1;break;case aa.a.Ylc:S=0;break;case aa.a.Xlc:fa=w-1}if(this.KA&&xa!==l&&(a=this.Je.s2(xa),!a||!a.GV))return;if(F){F=this.hbj(S,fa);let Za;(Za=this.ob).tX.apply(Za,F);this.Je.OHa(S===l?fa:S)}}Mkj(a){const b=this.ob.rf();b.sort((fa,xa)=>fa.Ge-xa.Ge);const c=b[0].Ge,f=b[b.length-1].Ge,l=this.ua.Ca;if(!l)throw Error.argumentNull("ActiveSlide is null");const w=
l.Ge,F=this.Ub.wj();let S=null;if(!(1>=F)){switch(a){case aa.a.amc:if(!w)break;(S=this.Ub.UH(w-1))&&1<b.length&&w===f&&this.lnb(b)&&this.ob.Ahc(l);break;case aa.a.$lc:w!==F-1&&(S=this.Ub.UH(w+1))&&1<b.length&&w===c&&this.lnb(b)&&this.ob.Ahc(l)}if(S){if(this.KA&&(a=S.yg(this.Je.Na),!a||!a.GV))return;this.Wb.Ca=S;this.ob.z2a(S);this.Je.OHa(S.Ge)}}}lnb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].Ge-a[b].Ge)return!1;return!0}Emj(a,b,c){if(!this.Wb.Bf||!this.ua.Ca||
this.Df.gd(this.Wb.Bf))return 16;2===c&&this.Je.Meb();return 32}Dmj(a,b,c){if(!this.Wb.Bf||!this.ua.Ca||this.Df.gd(this.Wb.Bf))return 16;2===c&&this.Je.gGe();return 32}wOc(a,b,c){return this.ob.D2()?this.wkj(a,c):this.Kmj(a,c)}Kmj(a,b){if(this.Op&&1!==this.ob.rf().length)return 8;let c;switch(a){case aa.a.$fb:case aa.a.bgb:a=aa.a.EYa;c="ThumbnailPageDownNavigation";break;case aa.a.cgb:case aa.a.agb:a=aa.a.FYa;c="ThumbnailPageUpNavigation";break;default:return za.a.J(8955553,816,50,"SelectionActor::HandleSelectSlideKeyboard does not recognize this action"),
8}Kc.a.Db&&(Kc.a.Db.actionName=c,Kc.a.Db.Nj=!1,Kc.a.Db.ur=!0);return this.ia.processAction(a,b)}wkj(a,b){switch(a){case aa.a.$fb:a=aa.a.Nbc;break;case aa.a.agb:a=aa.a.Obc;break;case aa.a.bgb:a=aa.a.Pbc;break;case aa.a.cgb:a=aa.a.Qbc;break;default:return za.a.J(8955555,816,50,"SelectionActor::HandleMoveShapeKeyboard does not recognize this action"),8}return this.ia.processAction(a,b)}Dhh(a,b,c,f,l){if(this.uN.oZ)return 16;if(1===c)return 32;b=this.ua.Ca;if(!b)return 16;c=b.km();if(!c||!c.length)return 16;
this.Bd();f=this.ob.mg();if(this.ob.jFb){if(c=this.ob.jFb.yg(this.Wb.UJ.Na))c.S3d(),c.Aih(!1);f.length||f.push(this.ob.jFb);this.ob.jFb=null}f&&this.qIa(f,!1);c=null;a===aa.a.aYa?c=l?l:b.o6a(f,!1,0):a===aa.a.WGb&&(c=b.o6a(f,!0,0));if(!c)return Z.ULS.sendTraceTag(587563472,816,10,"SelectionActor.SelectNextShapeHandler: failed to find next shape to select"),16;if(this.Z_j){l=Object(ua.a)(uz.a,c.yg(this.Wb.UJ.Na));if(c.eDa&&l&&a===aa.a.WGb){const w=document.getElementById(iN.a.zwe+l.B2);if(w&&document.activeElement!==
w)return l.qIa(),w.focus(),32}if(f.length&&(l=f[0],f=Object(ua.a)(uz.a,l.yg(this.Wb.UJ.Na)),l.eDa&&f&&a===aa.a.aYa&&(a=document.getElementById(iN.a.zwe+f.B2))&&document.activeElement!==a))return a.focus(),32}return this.q6g(c,b)}nWk(a,b,c){if(this.uN.oZ)return 16;if(1===c)return 32;a=this.ua.Ca;if(!a)return 16;b=a.km();if(!b.length)return 16;a=[];for(const f of b)(b=Object(ua.a)(133,f.yg(this.Wb.UJ.Na)))&&b.jp?b.qIa():(b&&b.shapeNode&&b.shapeNode.qy&&b.Z_(!1),a.push(f));this.ob.mXa(a,!0);this.V3.PDk();
this.qIa(a,!0);this.Bd();return 32}oWk(a,b,c){if(1===c)return 32;a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");a=a.slides||[];if(!a.length)return 16;za.a.J(34358608,816,50,"Selected All Slides");let f;(f=this.ob).tX.apply(f,a);this.Je.OHa(this.Ub.wj()-1);return 32}b5k(a,b,c){if(1===c)return 32;this.ia.processAction(aa.a.O5d,2);this.ia.processAction(aa.a.LIb,2);qd.a("RaiseEscapeKeyPressedEvent")&&this.Ue.aCk();return 32}Xpl(a,b,c){if(!this.ob.rG())return 16;if(1===c)return 32;
this.XB.nNa();a=this.ob.he();if(b=this.Fa.Z5a(a))return a=this.Fa.Lr(b),this.q6g(a,this.ua.Ca);this.qIa(a,!1);this.ob.Rh();this.Bd();return 32}hnj(){this.ia.processAction(aa.a.y3g,2);this.rta&&this.ia.processAction(aa.a.sGf,2);return 32}Ssk(){if(!this.ob.E8h()&&!this.ob.F8h())return 2;const a=this.ob.he();if(1<a.length)return 2;for(let b=0;b<a.length;b++){const c=this.j9.kQa(a[b]);c&&c.startPlaying()}return 32}q6g(a,b){const c=a.yg(this.Wb.UJ.Na);if(c){if(c.jp)return this.ob.Rh(),c.qIa(),c.Aih(!0),
c.KQ(),b=null,c.nVc?b=String.format(ResourceStrings.L_CannotEditHint,c.nVc.userName):za.a.J(19140689,828,10,"Shape is locked but the LockOwner is null. Shape: {0}.",c.shapeNode?c.shapeNode.get_shapeId().toString():""),this.ISa.O9g(a,b),this.ob.jFb=a,32}else return Z.ULS.sendTraceTag(587563469,816,10,"SelectionActor.SelectNextShapeHandler: ShapeViewElement of next shape is null"),8;this.ob.selectShape(a,!0);(a=b.yg(this.Wb.UJ.Na))&&a.awa();c&&(c.qIa(),c.KQ());return 32}Bd(){this.Wb.UJ.Po||this.Ga.Bd()}qIa(a,
b){for(const c of a)(a=c.yg(this.Wb.UJ.Na))&&(b?a.qIa():a.S3d())}}Object(e.a)(jN,"SelectionActor",null,[234]);class dA{constructor(){this.isHiddenShape=!1;this.shapeName=null;this.shapeId=0;this.key=null;this.isFocussedShape=!1;this.children=null}}Object(e.a)(dA,"SelectionPaneShapeNode",null,[]);var QQ=d(867);class kN{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc){this.t9b=this.qQ=null;a("powerpoint-editor-intl").then(()=>{za.a.J(51389792,801,50,"Icons and strings script is loaded successfully");
a("selectionPaneManager").then(()=>{za.a.J(51389794,801,50,"selection Pane Manager script is loaded successfully");this.qQ=selectionPaneManager.FactoryGlobal.getSelectionPaneManagerInstance();this.OJk();fa.A2k()}).catch(Dc=>{za.a.J(51204893,801,10,"Failed to load selectionPaneManager "+Dc.toString())})}).catch(Dc=>{za.a.J(51389825,801,10,"Failed to load powerpoint-editor-intl "+Dc.toString())});this.ob=b;this.Rb=c;this.ia=f;this.ua=l;this.Ga=w;this.Pz=F;this.NNg=S;this.p3j=fa;this.yh=xa;this.zd=Za;
this.Xc=pb;this.X8=Mb;this.uI=hc;this.Fa=kc;this.eC=Ec;this.Jb=Hc;this.WAg=!1;this.yh.xM(Object(C.a)(this,this.HVa,"onChangeRenderSelectionPane"));this.yh.IMa(Object(C.a)(this,this.HVa,"onChangeRenderSelectionPane"));this.Xc.E2a(Object(C.a)(this,this.HVa,"onChangeRenderSelectionPane"));this.zd.LMa(Object(C.a)(this,this.HVa,"onChangeRenderSelectionPane"));this.Rb.aP(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched"));this.ASa=!1;this.dMg=null}dispose(){this.yh.H9(Object(C.a)(this,this.HVa,"onChangeRenderSelectionPane"));
this.yh.heb(Object(C.a)(this,this.HVa,"onChangeRenderSelectionPane"));this.Xc.rEb(Object(C.a)(this,this.HVa,"onChangeRenderSelectionPane"));this.zd.sEb(Object(C.a)(this,this.HVa,"onChangeRenderSelectionPane"));this.Rb.Q_(Object(C.a)(this,this.Mx,"onAppFrameModeSwitched"))}Fe(){const a=this.Ga.Bc(Xd.a.RD);a.bindAction(A.KeyInputManager.La(x.a.sZa,6),aa.a.Tic);a.bindAction(A.KeyInputManager.La(x.a.H0,6),aa.a.FTb)}Tic(a){return ug.a("SelectionPaneBringBackward",a,()=>{this.ASa=!0;this.ia.processAction(aa.a.sendBackward,
2);za.a.J(595187077,822,50,"SelectionPane SendBackwardSelectionPane action is generated");return 32})}FTb(a){return ug.a("SelectionPaneBringForward",a,()=>{this.ASa=!0;this.ia.processAction(aa.a.bringForward,2);za.a.J(595187075,822,50,"SelectionPane BringForwardSelectionPane action is generated");return 32})}wb(){this.ia.ra(aa.a.sea,$b.a.application,Object(C.a)(this,this.sea,"showHideSelectionPane"),4);this.ia.ra(aa.a.Had,$b.a.application,Object(C.a)(this,this.Had,"querySelectionPane"),96);this.ia.ya(aa.a.Tic,
$b.a.application,Object(C.a)(this,this.Tic,"sendBackwardSelectionPane"));this.ia.ya(aa.a.FTb,$b.a.application,Object(C.a)(this,this.FTb,"bringForwardSelectionPane"))}Had(a,b,c,f,l){(a=Object(ua.a)(Kh.a,l))&&a.Yf(this.Pz.isVisible);return 32}sea(a,b,c){return 1===c?this.qQ&&this.ua.Ca?32:8:ug.a("SelectionPaneOpen",a,()=>{this.Pz.isVisible=!this.Pz.isVisible;this.Lch();this.Pz.isVisible?(this.uI.notesPane&&this.uI.notesPane.hTb()&&this.Ga.Bd(),this.Ga.Kj(Xd.a.RD,!0),this.qQ.focusShowAllButton()):this.Ga.Kj(Xd.a.RD,
!1);return 32})}Mx(a){1===a.mode&&this.Pz&&this.Pz.isVisible&&(this.Pz.isVisible=!1,this.Ga.Kj(Xd.a.RD,!1))}jri(){const a={};this.t9b=new wa.ScriptSharpLegacyMap;var b=this.ua.Ca,c=b?b.km(!0):null;b=this.ob.mg();const f=new Ua.a;let l=0;if(c){c.reverse();for(const F of c)if(!F.isLocal)if(c=this.rcg(F,b),F.Xf){if(l++,c=this.Fa.my(F)){c.reverse();for(const S of c){c=this.rcg(S,b);let fa=null;for(const xa of S.yA){var w=void 0;xa.ShapeId.toString()in a?(w=Object(ua.a)(dA,a[xa.ShapeId.toString()]),this.t9b.ga(xa.ShapeId).push(S.get_shapeId())):
(w=[S.get_shapeId()],this.t9b.add(xa.ShapeId,w),w=this.N$i(xa,b),a[xa.ShapeId.toString()]=w,fa?fa.children.push(w):f.add(w));fa=w}fa.children.push(c)}}}else f.add(c)}0<l&&!this.WAg&&(za.a.J(592992416,822,50,"SelectionPane Group count:{0}",l),this.WAg=!0);return f}rcg(a,b){const c=new dA;c.shapeId=a.get_shapeId();c.key=a.get_shapeId().toString();c.shapeName=a.shapeName;c.isHiddenShape=a.isHiddenShape;c.isFocussedShape=Array.contains(b,a);c.children=[];return c}N$i(a,b){const c=new dA;c.shapeId=a.ShapeId;
c.shapeName=a.ShapeName;c.isHiddenShape=a.IsHidden;c.isFocussedShape=!1;const f=this.ua.Ca;if(!f)throw Error.argumentNull("ActiveSlide is null");if(a=f.KB(a.ShapeId))c.isFocussedShape=Array.contains(b,a),c.shapeName=a.shapeName,c.isHiddenShape=a.isHiddenShape;c.children=[];return c}Lch(){if(!this.ua.Ca)this.Pz.isVisible=!1;else if(this.Pz.isVisible){var a=this.jri();if(this.HFf(a?a.toArray():null,this.dMg)){this.dMg=a?a.toArray():null;var b=this.X8.wi("UserAction","SelectionPane Rendering started");
this.qQ.renderSelectionPane(QQ.a.Phh,a.toArray());a=b.vq.toString();b.stop();za.a.J(594023552,822,50,"SelectionPane Rendering Completed. Time(in ms) : {0}",a)}else za.a.J(588854720,822,50,"SelectionPane Rendering not required.")}}HFf(a,b){if(!a&&b||a&&!b)return!0;if(!a&&!b||!a.length&&!b.length)return!1;if(a.length!==b.length)return!0;for(let c=0;c<a.length;c++){const f=a[c],l=b[c];if(f||l)if(!f&&l||f&&!l||f.shapeId!==l.shapeId||f.key!==l.key||f.shapeName!==l.shapeName||f.isHiddenShape!==l.isHiddenShape||
f.isFocussedShape!==l.isFocussedShape||this.HFf(f.children,l.children))return!0}return!1}HVa(){this.Lch();this.ASa&&(this.Pz.isVisible?this.Ga.Kj(Xd.a.RD,!0):this.Ga.Kj(Xd.a.RD,!1));this.ASa=!1}ZKe(a,b,c){let f;const l=c.yA.length,w=[];f=!1;for(let F=0;F<l;F++){const S=c.yA[F];S.ShapeId===a&&(2===b?(S.IsHidden=!S.IsHidden,f=S.IsHidden):0===b?f=S.IsHidden=!0:1===b&&(f=S.IsHidden=!1));w.push(S)}return{returnValue:w,VGj:f}}xii(a){var b=this.ua.Ca;if(!b)throw Error.argumentNull("ActiveSlide is null");
var c=this.t9b.ga(a);if(!c||1>=c.length)za.a.J(593000325,801,10,"There should be atleast 2 child shapes in the nested group");else{var f=b.KB(c[0]);if(f){var l=!1;a=({VGj:l}=this.ZKe(a,2,f)).returnValue;for(const w of c){const F=(c=b.KB(w))?Object(ua.a)(133,c.pc(this.eC)):null;F&&(l?(F.pia(),this.ob.PV(c)&&this.ob.I6(c)):!l&&F.lJa())}b=this.Jb.xd(15);try{b.lc(f),f.yA=a}finally{b&&b.dispose()}}else za.a.J(593000323,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}Noh(a){const b=
this.ua.Ca;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=b.km(!0),f=[];for(const l of c)if(l.Xf){const w=this.Fa.my(l);f=f.concat.apply(f,w)}if((c=c.concat.apply(c,f))&&c.length){a&&(this.ob.fj(),this.ob.aXb(c));for(const l of c)!a&&l.isHiddenShape?Object(ua.a)(133,l.pc(this.eC)).lJa():a&&!l.isHiddenShape&&Object(ua.a)(133,l.pc(this.eC)).pia();f=this.Jb.xd(15);try{f.lc(b);for(const l of c)!a&&l.isHiddenShape?l.isHiddenShape=!1:a&&!l.isHiddenShape&&(l.isHiddenShape=!0);for(let l of this.t9b)if(!b.KB(l.key)){const w=
l.value;if(!w||1>=w.length){za.a.J(593000321,801,10,"There should be atleast 2 child shapes in the nested group");continue}const F=b.KB(w[0]);F?(c=[],a?{returnValue:c}=this.ZKe(l.key,0,F):{returnValue:c}=this.ZKe(l.key,1,F),F.yA=c):za.a.J(593000291,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}finally{f&&f.dispose()}}}OJk(){this.qQ.addCloseSelectionPaneEventListener(()=>{za.a.J(51220828,822,50,"SelectionPane AddCloseSelectionPaneEventListener event is generated");
this.Pz.isVisible=!1});this.qQ.addFocusSelectionPaneListener(()=>{za.a.J(51220830,822,50,"SelectionPane AddFocusSelectionPaneListener event is generated");this.Ga.Kj(Xd.a.RD,!0)});this.qQ.addSelectShapeEventListener(a=>{za.a.J(51220832,822,50,"SelectionPane AddSelectShapeEventListener event is generated");const b=this.ua.Ca;if(!b)throw Error.argumentNull("ActiveSlide is null");(a=b.KB(a))&&(a.isHiddenShape||this.ob.selectShape(a,!0))});this.qQ.addSelectMultipleShapesEventListener(a=>{za.a.J(593608914,
822,50,"SelectionPane AddSelectMultipleShapesEventListener event is generated");const b=this.ua.Ca;if(!b)throw Error.argumentNull("ActiveSlide is null");ug.a("SelectionPaneMultiSelect",aa.a.sea,()=>{if(!a.length){var c=this.ob.he();this.ob.aXb(c)}c=0;for(const f of a){const l=b.KB(f);l&&!l.isHiddenShape&&(c?this.ob.selectShape(l,!1):(this.ob.selectShape(l,!0),c++))}return 32})});this.qQ.addToggleVisibilityListener(a=>{za.a.J(51220834,822,50,"SelectionPane ToggleShapeVisibility event is generated");
var b=this.ua.Ca;if(!b)throw Error.argumentNull("ActiveSlide is null");const c=b.KB(a);b="";if(!c||c.xh||c.Xf)b="Group";ug.b("SelectionPaneToggleVisibilty",b,aa.a.sea,()=>{c?this.NNg.hkl(a):this.xii(a);return 32})});this.qQ.addShapeRenameListener((a,b)=>{za.a.J(51220864,822,50,"SelectionPane AddShapeRenameListener event is generated");var c=this.ua.Ca;if(!c)throw Error.argumentNull("ActiveSlide is null");c=c.KB(a);let f="";if(!c||c.xh||c.Xf)f="Group";ug.b("SelectionPaneRename",f,aa.a.sea,()=>{this.NNg.H2k(a,
b);return 32})});this.qQ.addShapeReorderListener((a,b)=>{za.a.J(51220866,822,50,"SelectionPane AddShapeReorderListener event is generated");var c=this.ua.Ca;if(!c)throw Error.argumentNull("ActiveSlide is null");const f=c.KB(a);let l="";if(!f||f.xh||f.Xf)l="Group";else if(c=c.KB(b),!c||c.xh||c.Xf)l="Group";ug.b("SelectionPaneReorder",l,aa.a.sea,()=>{this.p3j.nbk(a,b);return 32})});this.qQ.addShowAllButtonEventListener(()=>{this.ASa=!0;za.a.J(51220868,822,50,"SelectionPane ShowOrHideAllShapes event is generated");
ug.a("SelectionPaneShowAll",aa.a.sea,()=>{this.Noh(!1);return 32})});this.qQ.addHideAllButtonEventListener(()=>{this.ASa=!0;za.a.J(51220870,822,50,"SelectionPane AddHideAllButtonEventListener event is generated");ug.a("SelectionPaneHideAll",aa.a.sea,()=>{this.Noh(!0);return 32})});this.qQ.addBringForwardButtonEventListener(()=>{this.ASa=!0;za.a.J(51505300,822,50,"SelectionPane AddBringForwardButtonEventListener event is generated");ug.a("SelectionPaneBringForward",aa.a.sea,()=>{this.ia.processAction(aa.a.bringForward,
2);return 32})});this.qQ.addBringBackwardButtonEventListener(()=>{this.ASa=!0;za.a.J(51505302,822,50,"SelectionPane AddBringBackwardButtonEventListener event is generated");ug.a("SelectionPaneBringBackward",aa.a.sea,()=>{this.ia.processAction(aa.a.sendBackward,2);return 32})});za.a.J(51220872,822,50,"SelectionPane RegisterSelectionPaneEventListeners is finished")}}Object(e.a)(kN,"SelectionPaneActor",null,[234]);class lN{constructor(a,b,c,f){this.oca=!1;this.h9b="ShapeAlignToSelectedObjects";this.ia=
a;this.Pb=c;this.ob=b;this.ZZ=f}wb(){za.a.J(50630811,822,50,"ShapeAlignmentActor::RegisterActions() - OptIn: True");this.ia.ra(aa.a.r6h,$b.a.application,Object(C.a)(this,this.xQa,"handleShapesAlignment"),4);this.ia.ra(aa.a.Y4k,$b.a.application,Object(C.a)(this,this.xQa,"handleShapesAlignment"),4);this.ia.ra(aa.a.rJe,$b.a.application,Object(C.a)(this,this.xQa,"handleShapesAlignment"),4);this.ia.ra(aa.a.ugd,$b.a.application,Object(C.a)(this,this.xQa,"handleShapesAlignment"),4);this.ia.ra(aa.a.sJe,$b.a.application,
Object(C.a)(this,this.xQa,"handleShapesAlignment"),4);this.ia.ra(aa.a.rgd,$b.a.application,Object(C.a)(this,this.xQa,"handleShapesAlignment"),4);this.ia.ra(aa.a.sgd,$b.a.application,Object(C.a)(this,this.xQa,"handleShapesAlignment"),4);this.ia.ra(aa.a.tgd,$b.a.application,Object(C.a)(this,this.xQa,"handleShapesAlignment"),4);this.ia.ra(aa.a.qOa,$b.a.application,Object(C.a)(this,this.qhg,"handleShapesDistribution"),4);this.ia.ra(aa.a.GGc,$b.a.application,Object(C.a)(this,this.qhg,"handleShapesDistribution"),
4);this.ia.ra(aa.a.Nad,$b.a.application,Object(C.a)(this,this.Nad,"queryShapeAlignToSlide"),96);this.ia.ya(aa.a.HPe,$b.a.application,Object(C.a)(this,this.HPe,"toggleShapeAlignToSlide"));this.ia.ra(aa.a.Mad,$b.a.application,Object(C.a)(this,this.Mad,"queryShapeAlignToSelectedObjects"),96);this.ia.ya(aa.a.GPe,$b.a.application,Object(C.a)(this,this.GPe,"toggleShapeAlignToSelectedObjects"))}Fe(){}B$d(){return u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.Ip?!0:!1}xQa(a,b,c){if(this.ZZ){b=
this.ob.he();for(const l of b)if(!l.getValue(zb.a.CRa))return 16}const f=this.ob.mg();return f?1===c?f.length?32:8:ug.a("Align",a,()=>{za.a.J(50598728,822,50,"ShapeAlignmentActor::HandleShapesAlignment, Align operation performed");const l=[],w=1===f.length||this.oca?this.o2f(a):this.n2f(a,f);if(null===w)return za.a.J(50598730,822,10,"ShapeAlignmentActor::HandleShapesAlignment, error in finding reference point"),16;for(const F of f)l.push(new nv(F,this.D5i(a,F,w)));if(!l[0].shapeNode.xh)for(const F of l)this.Nk(F.shapeNode).setPosition(F.position.x,
F.position.y,!0);this.ia.Ma(aa.a.lGa,2,l);return 32}):(za.a.J(50598726,822,10,"ShapeAlignmentActor::HandleShapesAlignment, selected nodes: null"),16)}Nad(a,b,c,f,l){if(!l||!Object(Ca.a)(Kh.a,l))return za.a.J(50598732,822,10,"ShapeAlignmentActor::QueryShapeAlignToSlide Invalid actionData"),8;l.Yf(this.oca);za.a.J(50598734,822,50,"ShapeAlignmentActor::QueryShapeAlignToSlide: Align to Slide button is selected");return 32}HPe(a,b,c,f,l){a=this.ob.mg();if(1===c)return 2>a.length&&(this.oca=!0,this.h9b=
"ShapeAlignToSlide",za.a.J(50598736,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide single shape selected, enable Align to slide button")),32;if(!l||"object"!==typeof l)return za.a.J(50598738,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSlide requires actionData"),8;this.dzh(l)&&(this.oca=!0,za.a.J(50598740,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide: Align to slide is enabled"));return 32}Mad(a,b,c,f,l){if(!l||!Object(Ca.a)(Kh.a,l))return za.a.J(50598742,822,10,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects Invalid actionData"),
8;l.Yf(!this.oca);za.a.J(50598744,822,50,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects: Align Selected Objects button is enabled");return 32}GPe(a,b,c,f,l){a=this.ob.mg();if(1===c)return 1<a.length?32:8;if(!l||"object"!==typeof l)return za.a.J(50598746,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects requires actionData"),8;this.dzh(l)&&(this.oca=!1,za.a.J(50598748,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects: Align Selected Objects is enabled"));return 32}D5i(a,
b,c){let f=null;var l=this.Nk(b);b=l.GKc();l=l.vs();switch(a){case aa.a.rJe:za.a.J(50598750,822,50,"ShapeAlignmentActor::ShapeAlignLeft: Align Left is selected ");f=new ic.a(b.x-l.fc+c,b.y);break;case aa.a.ugd:za.a.J(50598752,822,50,"ShapeAlignmentActor::ShapeAlignRight: Align Right is selected");f=new ic.a(b.x+(c-l.$b),b.y);break;case aa.a.sJe:za.a.J(50598754,822,50,"ShapeAlignmentActor::ShapeAlignTop: Align Top is selected");f=new ic.a(b.x,b.y-l.ic+c);break;case aa.a.rgd:za.a.J(50598784,822,50,
"ShapeAlignmentActor::ShapeAlignBottom: Align Bottom is selected");f=new ic.a(b.x,b.y+(c-l.Xb));break;case aa.a.sgd:za.a.J(50598786,822,50,"ShapeAlignmentActor::ShapeAlignCenter: Align Center is selected");f=new ic.a(b.x+(c-l.$f().x),b.y);break;case aa.a.tgd:za.a.J(50598788,822,50,"ShapeAlignmentActor::ShapeAlignMiddle: Align Middle is selected"),f=new ic.a(b.x,b.y+(c-l.$f().y))}return f}qhg(a,b,c){const f=this.ob.mg();return f?1===c?!f.length||2===f.length&&!this.oca?8:32:ug.a("Align",a,()=>{za.a.J(50902275,
822,50,"ShapeAlignmentActor::HandleShapesDistribution, Distribute operation performed");this.pMe(f,a,0,f.length-1);var l=1===f.length||2===f.length||this.oca?this.o2f(a):this.n2f(a,f);if(null===l)return za.a.J(527013341,815,10,"ShapeAlignmentActor::HandleShapesDistribution, error in finding reference point"),16;var w=l-this.Bgi(a,f);l=this.lgi(f,w);w=this.pgi(a,f,w,l);this.VFi(a,f,f.length-1,l,w);return 32}):(za.a.J(50902273,822,10,"ShapeAlignmentActor::HandleShapesDistribution, selected nodes: null"),
16)}Bgi(a,b){return a===aa.a.qOa?this.Cgi(b):this.Dgi(b)}Cgi(a){let b=0;for(const c of a)a=this.Nk(c),b+=a.vs().Xb-a.vs().ic;return b}Dgi(a){let b=0;for(const c of a)a=this.Nk(c),b+=a.vs().$b-a.vs().fc;return b}pgi(a,b,c,f){if(1===b.length||this.oca)return 0<c?f:0;b=this.Nk(b[0]);return a===aa.a.qOa?b.vs().Xb+f:b.vs().$b+f}lgi(a,b){return(1===a.length||this.oca)&&0<b?1*b/(a.length+1):1*b/(a.length-1)}VFi(a,b,c,f,l){var w=0;const F=[];1<b.length&&!this.oca?(za.a.J(50902277,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Selected Objects"),
w++,c--):za.a.J(50902279,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Slide");for(a===aa.a.qOa?za.a.J(50902281,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Vertically"):za.a.J(50902283,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Horizontally");w<=c;w++){const fa=b[w];if(!fa)continue;let xa=this.Nk(fa);if(xa){var S=xa.GKc();a===aa.a.qOa?(S=new ic.a(S.x,l),F.push(new nv(fa,S)),l+=xa.vs().Xb-xa.vs().ic+f):(S=new ic.a(l,S.y),F.push(new nv(fa,S)),l+=xa.vs().$b-
xa.vs().fc+f)}}if(F[0]&&!F[0].shapeNode.xh)for(const fa of F)this.Nk(fa.shapeNode).setPosition(fa.position.x,fa.position.y,!0);this.ia.Ma(aa.a.lGa,2,F)}o2f(a){const b=Object(ua.a)(316,this.ob.ny().pc(this.Pb.Na));if(!b)return za.a.J(51500956,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide,Error in finding reference point: SlideViewElement is NULL, ActionID: {0}",a),null;switch(a){case aa.a.ugd:case aa.a.GGc:return b.qC.clientWidth;case aa.a.rgd:case aa.a.qOa:return b.qC.clientHeight;
case aa.a.sgd:return b.qC.clientWidth/2;case aa.a.tgd:return b.qC.clientHeight/2;default:return za.a.J(51500958,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide, Error in finding reference point, ActionID: {0}",a),0}}n2f(a,b){switch(a){case aa.a.rJe:var c=Number.MAX_VALUE;for(const w of b)b=this.Nk(w),c=Math.min(b.vs().fc,c);return c;case aa.a.ugd:c=-Number.MAX_VALUE;for(const w of b)b=this.Nk(w),c=Math.max(b.vs().$b,c);return c;case aa.a.sJe:c=Number.MAX_VALUE;for(const w of b)b=this.Nk(w),
c=Math.min(b.vs().ic,c);return c;case aa.a.rgd:c=-Number.MAX_VALUE;for(const w of b)b=this.Nk(w),c=Math.max(b.vs().Xb,c);return c;case aa.a.sgd:var f=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(c of b)b=this.Nk(c),f=Math.min(b.vs().fc,f),l=Math.max(b.vs().$b,l);return f+(l-f)/2;case aa.a.tgd:c=Number.MAX_VALUE;l=-Number.MAX_VALUE;for(f of b)b=this.Nk(f),c=Math.min(b.vs().ic,c),l=Math.max(b.vs().Xb,l);return c+(l-c)/2;case aa.a.qOa:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(l of b)b=this.Nk(l),c=Math.min(c,
b.vs().ic),f=Math.max(b.vs().Xb,f);return f-c;case aa.a.GGc:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(const w of b)b=this.Nk(w),c=Math.min(c,b.vs().fc),f=Math.max(b.vs().$b,f);return f-c;default:return za.a.J(51500960,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSelectedObjects, Error in finding reference point, ActionID: {0}, No of selectedNodes: {1}",a,b.length),null}}pMe(a,b,c,f){if(!(c>=f)){var l=this.grk(a,b,c,f);this.pMe(a,b,c,l-1);this.pMe(a,b,l+1,f)}}grk(a,b,c,f){if(b===aa.a.qOa)return this.irk(a,
c,f);if(b===aa.a.GGc)return this.hrk(a,c,f);za.a.J(50902285,822,10,"ShapeAlignmentActor::SortSelectedShapes:PartitionSelectedNodesList, actionId not supported");return-1}irk(a,b,c){var f=this.Nk(a[c]).vs().$f().y;let l=b-1;for(;b<=c-1;b++)if(this.Nk(a[b]).vs().$f().y<f){l++;const w=a[l];a[l]=a[b];a[b]=w}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}hrk(a,b,c){var f=this.Nk(a[c]).vs().$f().x;let l=b-1;for(;b<=c-1;b++)if(this.Nk(a[b]).vs().$f().x<f){l++;const w=a[l];a[l]=a[b];a[b]=w}f=a[l+1];a[l+1]=a[c];a[c]=
f;return l+1}dzh(a){const b=a.SourceControlId;return a[Uh.a.On]&&this.h9b!==b?(this.oca="ShapeAlignToSelectedObjects"===this.h9b,this.B$d()&&(a={},a[b]="ToggleButtonModel",a[this.h9b]="ToggleButtonModel",gb.App.Fb.GF(a)),this.h9b=b,!0):!1}Nk(a){return a?Object(ua.a)(133,a.pc(this.Pb.Na)):null}}Object(e.a)(lN,"ShapeAlignmentActor",null,[234]);class Px{}Object(e.a)(Px,"CT_NoFillProperties",null,[]);class eA{constructor(a,b){this.qil=a;this.Clc=b}}Object(e.a)(eA,"FormatPainterData",null,[]);var mN=d(713);
class bi{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He){this.dgl="data:image/svg+xml;charset=utf8,";this.Qxe=96;this.ia=a;this.sa=F;this.Qd=f;this.Jb=c;this.Ga=b;this.XB=l;this.Zb=w;this.Tie=fa;this.tI=S;this.cle=Za;this.FIg=(a=!Dc||!Dc.isInHighContrastMode)&&Hc.o7d;this.sW=Hc.powerPointGraphicToolTabIsEnabled;this.Jke=a&&Hc.svgIconLocalEditingIsEnabled;this.Abb=xa;this.eC=He;this.Fa=pb;this.bQ=Mb;this.eT=hc;this.Wb=kc;this.ua=Ec;this.wc=Td;this.qp=Hc.pptTextFormatPainterIsEnabled;
this.GFg=Hc.formatPainterApplyRemappedIsEnabled;this.yIg=Hc.ATc;this.S$a=Hc.vwk;this.US=Hc.gDb;this.la=Hc;this.Xi=we;this.b9b=new wa.ScriptSharpLegacyMap;this.Rz=Pd}wb(){this.ia.ra(aa.a.duk,$b.a.application,Object(C.a)(this,this.plj,"handlePopulateShapeFillMenu"),96);this.ia.ra(aa.a.tSg,$b.a.application,Object(C.a)(this,this.okj,"handleMoreFillColors"),96);this.ia.ra(aa.a.uSg,$b.a.application,Object(C.a)(this,this.tkj,"handleMoreOutlineColors"),96);this.ia.ra(aa.a.eTb,$b.a.application,Object(C.a)(this,
this.Yfg,"handleApplyShapeFillColor"),4);this.ia.ra(aa.a.NHd,$b.a.application,Object(C.a)(this,this.yhj,"handleApplyShapeFillCustomColor"),4);this.ia.ra(aa.a.YEf,$b.a.application,Object(C.a)(this,this.Yfg,"handleApplyShapeFillColor"),4);this.ia.ra(aa.a.gDe,$b.a.application,Object(C.a)(this,this.ahg,"handleRemoveShapeFill"),4);this.ia.ra(aa.a.Rah,$b.a.application,Object(C.a)(this,this.ahg,"handleRemoveShapeFill"),4);this.ia.ra(aa.a.euk,$b.a.application,Object(C.a)(this,this.qlj,"handlePopulateShapeOutlineMenu"),
96);this.ia.ra(aa.a.jnb,$b.a.application,Object(C.a)(this,this.Zfg,"handleApplyShapeOutlineColor"),4);this.ia.ra(aa.a.OHd,$b.a.application,Object(C.a)(this,this.zhj,"handleApplyShapeOutlineCustomColor"),4);this.ia.ra(aa.a.ZEf,$b.a.application,Object(C.a)(this,this.Zfg,"handleApplyShapeOutlineColor"),4);this.ia.ra(aa.a.EAc,$b.a.application,Object(C.a)(this,this.Dhj,"handleApplyShapeOutlineWidth"),4);this.ia.ra(aa.a.CAc,$b.a.application,Object(C.a)(this,this.Ahj,"handleApplyShapeOutlineDashStyle"),
4);this.yIg&&this.ia.ra(aa.a.RHd,$b.a.application,Object(C.a)(this,this.Chj,"handleApplyShapeOutlineSketchStyle"),4);this.ia.ra(aa.a.DAc,$b.a.application,Object(C.a)(this,this.Bhj,"handleApplyShapeOutlineEndStyle"),4);this.ia.ra(aa.a.hDe,$b.a.application,Object(C.a)(this,this.bhg,"handleRemoveShapeOutline"),4);this.ia.ra(aa.a.Sah,$b.a.application,Object(C.a)(this,this.bhg,"handleRemoveShapeOutline"),4);this.ia.ra(aa.a.y5a,$b.a.application,Object(C.a)(this,this.Bnj,"handleToggleFormatPainterActive"),
4);this.ia.ra(aa.a.Lha,$b.a.application,Object(C.a)(this,this.phj,"handleApplyFormat"),4);this.ia.ra(aa.a.mWd,$b.a.application,Object(C.a)(this,this.qhj,"handleApplyFormatToShape"),5);this.ia.ra(aa.a.JAe,$b.a.application,Object(C.a)(this,this.Flj,"handleQueryFormatPainter"),97);this.ia.ra(aa.a.Bxk,$b.a.application,Object(C.a)(this,this.wlj,"handlePreviewShapeFillColor"),4);this.ia.ra(aa.a.OSk,$b.a.application,Object(C.a)(this,this.Amj,"handleRevertPreviewShapeFillColor"),4)}Fe(){const a=this.Ga.Bc(Xd.a.sg);
a.bindAction(A.KeyInputManager.La(x.a.EJa,6),aa.a.y5a);const b=this.Ga.Bc(Xd.a.QM);let c=A.KeyInputManager.La(x.a.EJa,6);b.Wo(c);this.qp?b.bindAction(c,D.a.JJc):b.bindAction(c,aa.a.y5a);za.a.J(50344146,815,50,"formatPainterApplyRemapped: {0}",this.GFg);this.GFg||(c=A.KeyInputManager.La(x.a.Thb,6),a.bindAction(c,aa.a.Lha),b.Wo(c),this.qp?b.bindAction(c,aa.a.nWd):b.bindAction(c,aa.a.Lha))}Trb(a,b){const c=[];if(a)for(const f of a)(f.esa||b&&f.get_isSVGBlipFilled()||f.sk||this.US&&1===f.mediaType)&&
Array.add(c,f);return c}b6a(a,b){const c=[];if(a)for(const f of a)(f.esa&&!f.ty||b&&f.get_isSVGBlipFilled()||this.S$a&&f.rd)&&Array.add(c,f);return c}plj(a,b,c,f,l){if(!this.sa.D2()||this.Zb.OB(this.sa.he()))return 16;if(1===c)return 32;if(!l)return 8;b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a=b.I1;b=(c=this.sa.Dq())?b.LB(c.slideId):null;if(!b)return 16;var w=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");c=w?aa.a.YEf:aa.a.eTb;f=w?aa.a.Rah:aa.a.gDe;const F=aa.a.tSg;
if(l.MenuId&&"fill"===l.MenuId){var S=new mN.a(b.Ye);w=new Sys.StringBuilder;w.append(String.format(bi.qJf,"PptRibbon.Drawing.ShapeFill"));if(!b.Ye)return 8;w.append(S.S1d(c,a,aa.a.NHd));w.append(bi.yJf);w.append(String.format(bi.wJf,f,u.AFrameworkApplication.Rl,ResourceStrings.L_RemoveShapeFill,CommonUIStrings.l_RemoveShapeFillKeytip));w.append(bi.xJf);w.append(bi.ifi);w.append(String.format(bi.gfi,F,u.AFrameworkApplication.Rl,ResourceStrings.L_MoreFillColors,CommonUIStrings.l_MoreFillColorsKeytip));
w.append(bi.hfi);w.append(bi.pJf);l.PopulationXML=w.toString()}else{S=Object.assign(new Kl.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});const fa=w?"StandardGraphicFillColorPicker":"StandardShapeFillColorPicker",xa=w?"GraphicNoFill":"ShapeNoFill";Array.add(S.MenuSectionList,Rk.f(b.Ye,DE.a.themeColors,"Color.Menu.Controls","themeColor",w?"ThemeGraphicFillColorPicker":"ThemeShapeFillColorPicker",c.toString(),1));Array.add(S.MenuSectionList,Rk.d("Standard Colors","Color.Menu.Controls","standardColor",
fa,c.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!1)),Array.add(S.MenuSectionList,Rk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeFillRecentColors","3745557472",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!0));Array.add(S.MenuSectionList,Rk.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor",xa,
"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));Array.add(S.MenuSectionList,Rk.a("More Fill Color","Color.Menu.Controls",F.toString(),ResourceStrings.L_MoreFillColors,"Color.Menu.MoreFillColor","MoreFillColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreFillColorsKeytip));qd.a("ColorPickerHighlighterFix")&&(a=this.z$i(b.Ye),Rk.h(S,a,b.Ye));l.MenuItems=S}return 32}qlj(a,b,c,f,l){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.sa.D2()||
this.Zb.OB(this.sa.he()))return 16;if(1===c)return 32;if(!l)return 8;c=(c=this.sa.Dq())?a.LB(c.slideId):null;if(!c||!c.Ye)return 8;a=a.I1;var w=this.Qd.rk("pegal.png"),F=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");b=F?aa.a.ZEf:aa.a.jnb;f=F?aa.a.Sah:aa.a.hDe;const S=aa.a.uSg;if(l.MenuId&&"outline"===l.MenuId){var fa=new Sys.StringBuilder;fa.append(String.format(bi.qJf,"PptRibbon.Drawing.ShapeOutline"));c=new mN.a(c.Ye);fa.append(c.S1d(b,a,aa.a.OHd));fa.append(bi.yJf);fa.append(String.format(bi.wJf,
f,u.AFrameworkApplication.Rl,ResourceStrings.L_RemoveShapeOutline,CommonUIStrings.l_RemoveShapeOutlineKeytip));fa.append(bi.xJf);fa.append(bi.lfi);fa.append(String.format(bi.jfi,S,u.AFrameworkApplication.Rl,ResourceStrings.L_MoreOutlineColors,CommonUIStrings.l_MoreOutlineColorsKeytip));fa.append(bi.kfi);c=this.sa.he();a=bi.c$i(c,this.sW);if(!a||!a.length||c&&c.length!==a.length)fa.append('<MenuSection Id="OutlineEffects"><Controls Id="OutlineControls">'),fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineWeightAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineWidth_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineWeight">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineWeight" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineWeight.Controls">\r\n                         <Button\r\n                            Id="OutlineWidthPresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
aa.a.THd,aa.a.EAc,u.AFrameworkApplication.Rl,ResourceStrings.L_ApplyShapeOutlineWidth,ResourceStrings.L_ApplyShapeOutlineWidth_1,ResourceStrings.L_ApplyShapeOutlineWidth_2,ResourceStrings.L_ApplyShapeOutlineWidth_3,ResourceStrings.L_ApplyShapeOutlineWidth_4,w,CommonUIStrings.l_ApplyShapeOutlineWidthKeytip)),fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineDashesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_DashStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{8}">\r\n                   <Menu Id="MenuOutlineDashStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineDashStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineDashStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
aa.a.PHd,aa.a.CAc,u.AFrameworkApplication.Rl,ResourceStrings.L_ApplyShapeOutlineDashStyle,ResourceStrings.L_ApplyShapeOutlineDashStyle_1,ResourceStrings.L_ApplyShapeOutlineDashStyle_2,ResourceStrings.L_ApplyShapeOutlineDashStyle_3,w,CommonUIStrings.l_PPTApplyShapeOutlineDashStyleKeytip)),this.yIg&&fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineSketchesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineSketchy_16x16x32"\r\n                   LabelText="{3}">\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineSketchStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineSketchStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineSketchStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchNone_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleCurve_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleWave_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchIntenseWave_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
aa.a.SHd,aa.a.RHd,u.AFrameworkApplication.Rl,ResourceStrings.l_ApplyShapeOutlineSketchStyle,ResourceStrings.l_ApplyShapeOutlineSketchStyle_1,ResourceStrings.l_ApplyShapeOutlineSketchStyle_2,ResourceStrings.l_ApplyShapeOutlineSketchStyle_3,ResourceStrings.l_ApplyShapeOutlineSketchStyle_4,w,CommonUIStrings.l_PPTApplyShapeOutlineSketchStyleKeytip)),fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineArrowsAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_ArrowStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{12}">\r\n                   <Menu Id="MenuOutlineEndStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineEndStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineEndStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,5"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle5_16x16x32"\r\n                            LabelText="{8}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,6"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle6_16x16x32"\r\n                            LabelText="{9}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,7"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle7_16x16x32"\r\n                            LabelText="{10}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
aa.a.QHd,aa.a.DAc,u.AFrameworkApplication.Rl,ResourceStrings.L_ApplyShapeOutlineEndStyle,ResourceStrings.L_ApplyShapeOutlineEndStyle_1,ResourceStrings.L_ApplyShapeOutlineEndStyle_2,ResourceStrings.L_ApplyShapeOutlineEndStyle_3,ResourceStrings.L_ApplyShapeOutlineEndStyle_4,ResourceStrings.L_ApplyShapeOutlineEndStyle_5,ResourceStrings.L_ApplyShapeOutlineEndStyle_6,ResourceStrings.L_ApplyShapeOutlineEndStyle_7,w,CommonUIStrings.l_ApplyShapeOutlineEndStyleKeytip)),fa.append("</Controls></MenuSection>");
fa.append(bi.pJf);l.PopulationXML=fa.toString()}else{w=F?"ThemeGraphicOutlineColorPicker":"ThemeShapeOutlineColorPicker";fa=F?"StandardGraphicOutlineColorPicker":"StandardShapeOutlineColorPicker";const xa=F?"GraphicNoOutline":"ShapeNoOutline";F=Object.assign(new Kl.a,{Id:"PptRibbon.Drawing.ShapeOutline",MenuSectionList:[]});Array.add(F.MenuSectionList,Rk.f(c.Ye,"Theme Colors","Color.Menu.Controls","themeColor",w,b.toString(),1));Array.add(F.MenuSectionList,Rk.d("Standard Colors","standardColor","Standard Colors",
fa,b.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!1)),Array.add(F.MenuSectionList,Rk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeOutlineRecentColors","1244537109",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!0));Array.add(F.MenuSectionList,Rk.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeOutline,"Color.Menu.RemoveColor",
xa,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeOutlineKeytip));Array.add(F.MenuSectionList,Rk.a("More Outline Color","Color.Menu.Controls",S.toString(),ResourceStrings.L_MoreOutlineColors,"Color.Menu.MoreOutlineColor","MoreOutlineColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreOutlineColorsKeytip));qd.a("ColorPickerHighlighterFix")&&(a=this.y$i(c.Ye),Rk.h(F,a,c.Ye));l.MenuItems=F}return 32}wlj(a,b,c,f,l){if(!l)return za.a.J(562422216,815,10,"HandlePreviewShapeFillColor: action data cannot be null."),
8;if(!this.la.lfc)return 2;b=this.sa.mg();const w=this.b6a(b,this.sW);return w&&w.length?this.S$a&&1===w.length&&w[0].rd?(za.a.J(562422218,815,50,"HandlePreviewShapeFillColor: Preview for table shapes to be handled separately."),32):ug.a("HandlePreviewShapeFillColor:",a,()=>{const F=this.sa.iO(w),S=this.tI.q0(l),fa=Object.assign(new Gz.a,{});fa.solidFillField=S;for(const xa of F)xa?xa.rd||(this.b9b.Kb(xa.get_shapeId())?this.b9b.$(xa.get_shapeId(),xa.fill):this.b9b.add(xa.get_shapeId(),xa.fill),xa.fill=
fa,xa.gea=null):za.a.J(562317520,822,50,"HandlePreviewShapeFillColor, shape with shape id : {0} is null",xa.get_shapeId());return 32}):(za.a.J(562422217,815,50,"HandlePreviewShapeFillColor: No shape is selected to show preview color."),16)}Amj(a,b,c,f,l){if(!l)return za.a.J(562422219,815,10,"HandleRevertPreviewShapeFillColor: action data cannot be null."),8;if(!this.la.lfc)return 2;a=this.sa.mg();a=this.b6a(a,this.sW);if(!a||!a.length)return za.a.J(562422220,815,50,"HandleRevertPreviewShapeFillColor: No shape is selected to show preview color."),
16;if(this.S$a&&1===a.length&&a[0].rd)return za.a.J(562422221,815,50,"HandleRevertPreviewShapeFillColor: Preview for table shapes to be handled separately."),32;a=this.sa.iO(a);for(const w of a)if(!w)za.a.J(562317521,822,50,"HandleRevertPreviewShapeFillColor, shape with shape id : {0} is null",w.get_shapeId());else if(!w.rd)if(this.b9b.Kb(w.get_shapeId()))w.fill=this.b9b.ga(w.get_shapeId()),w.gea=null;else return za.a.J(562422222,815,10,"HandleRevertPreviewShapeFillColor: last applied shape fill color cannot be empty."),
8;return 32}Yfg(a,b,c,f,l){var w=this.ua.presentation;if(!w)throw Error.argumentNull("Presentation is null");f=this.sa.mg();b=this.b6a(f,this.sW);const F={type:"ColorPickerPayload",color:""};l&&(F.color=l.Color);if(!(b&&0<b.length||this.sa.FK()&&this.gwg(f[0],a,F))||this.Zb.OB(b))return 16;const S=this.sa.Dq();w=S?w.LB(S.slideId):null;if(!w||!w.Ye||!w.Ye.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;if(this.S$a&&1===b.length&&b[0].rd)return za.a.J(595173911,815,50,"HandleApplyShapeFillColor: send PowerPointCellShadingColor"),
this.ia.Ma(aa.a.yva,c,l);c=bi.gec(l);if(!c)return 8;1<f.length?za.a.J(17598038,815,50,"HandleApplyShapeFillColor: Apply shape fill color on {0} selected shapes.",f.length):za.a.J(17598040,815,50,"HandleApplyShapeFillColor: Apply shape fill color on one selected shape.");for(var fa of f)if(fa.Xf||fa.xh){On(fa);break}if(this.sa.FK()&&this.gwg(f[0],a,F)&&this.z2d(f[0],a,F))return 32;fa=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{fa.lc(b[0]);fa.fd=a;const xa=this.tI.q0(l),Za=this.sa.iO(b);
for(const pb of Za)if(pb.rd){if(!this.S$a)continue;za.a.J(595173907,815,50,"HandleApplyShapeFillColor: Process table");const Mb=this.wc.ZM(pb);if(!Mb){za.a.J(587531084,815,10,"HandleApplyShapeFillColor: Table Node from shape is null");continue}const hc=Mb.r0b();for(const kc of hc){const Ec=kc.cellShading;Dx(Ec);Ec.solidFillField=xa;kc.cellShading=Ec}}else{const Mb=this.RZf(pb);Mb&&(this.tI.IOa(Mb),Mb.solidFillField=xa,pb.fill=Mb,pb.gea=null,this.NAh(pb,Mb));pb.NXa=JSON.stringify(c);this.xFb(pb)}}finally{fa&&
fa.dispose()}return 32}okj(a,b,c,f,l){if(1===c)return this.ia.Ma(aa.a.renderColorPicker,1,l);a=this.x$i();b={};b.currentColor=a;b.handleCommand=aa.a.NHd;return this.ia.Ma(aa.a.renderColorPicker,2,b)}yhj(a,b,c,f,l){if(1===c)return this.ia.Ma(aa.a.eTb,c,l);if(!l)return za.a.J(595186513,815,10,"HandleApplyShapeFillCustomColor: actionData is null"),16;a=this.ia.Ma(aa.a.eTb,c,l);32===a&&this.ia.Ma(aa.a.zza,c,l);return a}tkj(a,b,c,f,l){a=this.sa.mg();a=qd.a("FixColorPickerPictureBorderColor")?this.Trb(a,
this.sW):this.b6a(a,this.sW);a=this.sa.iO(a);if(1===c)return this.ia.Ma(aa.a.renderColorPicker,1,l);c=null;1===a.length&&a[0].Asa&&(c=If.Box4ColorHelper.Vqa(a[0].Asa));l={};l.currentColor=c;l.handleCommand=aa.a.OHd;return this.ia.Ma(aa.a.renderColorPicker,2,l)}ahg(a,b,c,f,l){f=this.sa.mg();b=this.b6a(f,this.sW);const w=!!b&&0<b.length;if(this.Zb.OB(b))return 16;if(1===c)return w?32:8;if(!w)return 16;1<f.length?za.a.J(17598042,815,50,"HandleRemoveShapeFill: Remove shape fill on {0} selected shapes.",
f.length):za.a.J(17598044,815,50,"HandleRemoveShapeFill: Remove shape fill on one selected shape.");if(this.S$a&&1===b.length&&b[0].rd)return za.a.J(595173902,815,50,"HandleRemoveShapeFill: send PowerPointRemoveCellShading"),this.ia.Ma(aa.a.fWa,c,l);c=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{c.lc(b[0]);c.fd=a;const F=this.sa.iO(b);for(const S of F)if(S.rd){if(!this.S$a)continue;za.a.J(595173900,815,50,"HandleRemoveShapeFill: Process table");const fa=this.wc.ZM(S);if(!fa){za.a.J(587531077,
815,10,"HandleRemoveShapeFill: Table Node from shape is null");continue}const xa=fa.r0b();for(const Za of xa){const pb=Za.cellShading;Dx(pb);pb.noFillField=new Px;Za.cellShading=pb}}else{const fa=this.RZf(S);fa&&(this.tI.IOa(fa),fa.noFillField=new Px,S.fill=fa,S.gea=null,this.NAh(S,fa));S.eLk();this.xFb(S)}}finally{c&&c.dispose()}return 32}Zfg(a,b,c,f,l){var w=this.ua.presentation;if(!w)throw Error.argumentNull("Presentation is null");f=this.sa.mg();b=this.Trb(f,this.sW);if(!(b&&0<b.length)||this.Zb.OB(b))return 16;
const F=this.sa.Dq();w=F?w.LB(F.slideId):null;if(!w||!w.Ye||!w.Ye.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;c=bi.gec(l);if(!c)return 8;1<f.length?za.a.J(17598047,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on {0} selected shapes.",f.length):za.a.J(17598049,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on one selected shape.");for(var S of f)if(S.Xf||S.xh){On(S);break}S=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{S.lc(b[0]);
S.fd=a;const fa=this.sa.iO(b);for(const xa of fa){const Za=this.kTd(xa);if(Za){this.tI.IOa(Za);const pb=this.tI.q0(l);Za.solidFillField=pb;xa.lineStyle=Za;xa.Asa=null;this.Mld(xa,Za)}xa.Hfb=JSON.stringify(c);this.xFb(xa)}}finally{S&&S.dispose()}return 32}zhj(a,b,c,f,l){if(1===c)return this.ia.Ma(aa.a.jnb,c,l);if(!l)return za.a.J(595186505,815,10,"HandleApplyShapeOutlineCustomColor: actionData is null"),16;a=this.ia.Ma(aa.a.jnb,c,l);32===a&&this.ia.Ma(aa.a.zza,c,l);return a}Dhj(a,b,c,f,l){f=this.sa.mg();
b=this.Trb(f,this.sW);if(!(b&&0<b.length)||this.Zb.OB(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.yNc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(c>=bi.ngh.length||0>c)return 8;1<f.length?za.a.J(17598081,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on {0} selected shapes.",f.length):za.a.J(17598083,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on one selected shape.");l=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{l.lc(b[0]);
l.fd=a;const w=this.sa.iO(b);for(const F of w){const S=this.kTd(F);S&&(S.wField=bi.AUk[c],S.wFieldSpecified=!0,this.Mld(F,S),this.IZf(S),F.lineStyle=S);F.outlineWidth=bi.ngh[c];this.xFb(F)}}finally{l&&l.dispose()}return 32}xFb(a){this.Fa.EK(a)&&Kc.a.Db&&(Kc.a.Db.Nj=!0)}RZf(a){if(!this.FIg)return null;let b=a.fill;b||!a.EK&&!a.get_isSVGBlipFilled()||(b=new Gz.a);return b}kTd(a){var b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(!this.FIg)return null;let c=a.lineStyle;
if(this.Jke&&a.lTc()&&c&&c.wFieldSpecified){b=Object(ua.a)(132,b.LB(a.slideId));var f=this.Xi.YF;b&&b.ow&&null!=b.ow.zr&&(f=b.ow.zr);b=c.wField/f;f=this.Z_b(a);if(!f||!f.aNa||!f.UAc)return c.wField=b,c;var l;(l=f.Kk&&f.Kk.vG&&f.Kk.vG.yK()&&1===f.Kk.vG.za.childNodes.length?f.Kk.vG.za.childNodes[0].getAttribute("width"):f.aNa.getAttribute("width"))&&!Ja.a.Xa(l.toString())&&(l=parseFloat(l.toString()),isNaN(l)||(f=Math.sqrt(l*l/(f.w$h*f.UAc)),1E-6<f&&(b/=f)));c.wField=b}c||!a.EK&&!a.get_isSVGBlipFilled()||
(c=new aA);return c}IZf(a){if(a.noFillField||Hz(a))a.noFillField=null,a.solidFillField=Object.assign(new rr.a,{schemeClrField:Object.assign(new ym.a,{valField:1})})}Ahj(a,b,c,f,l){f=this.sa.mg();b=this.Trb(f,this.sW);if(!(b&&0<b.length)||this.Zb.OB(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.yNc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return 8;1<f.length?za.a.J(17598087,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on {0} selected shapes.",
f.length):za.a.J(17598089,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on one selected shape.");l=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{l.lc(b[0]);l.fd=a;const w=this.sa.iO(b);for(const F of w){const S=this.kTd(F);S&&(S.prstDashField=S.prstDashField||new bA,S.prstDashField.valField=this.g8i(c),S.prstDashField.valFieldSpecified=!0,S.custDashField=null,this.Mld(F,S),this.IZf(S),F.lineStyle=S);F.nCb=c;this.xFb(F)}}finally{l&&l.dispose()}return 32}g8i(a){switch(a){case 0:return 0;
case 1:return 8;case 3:return 2;default:return 0}}Bhj(a,b,c,f,l){f=this.sa.mg();b=bi.b4i(f);if(!(b&&0<b.length)||this.Zb.OB(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.yNc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);l=parseInt(c)-1;if(0>l||l>=bi.agh.length)return 8;c=bi.agh[l];l=bi.wUk[l];1<f.length?za.a.J(17598093,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on {0} selected shapes.",f.length):za.a.J(17598095,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on one selected shapes.");
f=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{f.lc(b[0]);f.fd=a;const w=this.sa.iO(Array.isArray(b)?b:null);for(const F of w)F.I2k(c,l)}finally{f&&f.dispose()}return 32}bhg(a,b,c){const f=this.sa.mg();b=this.Trb(f,this.sW);if(!(b&&0<b.length)||this.Zb.OB(b))return 16;if(1===c)return 32;1<f.length?za.a.J(17598097,815,50,"HandleRemoveShapeOutline: Remove shape outline on {0} selected shapes.",f.length):za.a.J(17598099,815,50,"HandleRemoveShapeOutline: Remove shape outline on one selected shape.");
c=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{c.lc(b[0]);c.fd=a;const l=this.sa.iO(b);for(const w of l){const F=w.lineStyle;F&&(this.tI.IOa(F),F.noFillField=new Px,w.lineStyle=F,w.Asa=null,this.Mld(w,F));w.JLk();this.xFb(w)}}finally{c&&c.dispose()}return 32}Chj(a,b,c,f,l){f=this.sa.mg();b=this.Trb(f,this.sW);if(!(b&&0<b.length)||bi.IWk(f))return 8;if(this.Zb.OB(b))return 16;if(1===c)return 32;if(!l)return za.a.J(51516692,815,50,"HandleApplyShapeOutlineSketchStyle requires actionData"),
8;c=this.yNc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return za.a.J(51516694,815,50,"Invalid outline sketch style ",c),8;1<f.length?za.a.J(51516697,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on {0} selected shapes.",f.length):za.a.J(51516699,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on one selected shape.");l=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{l.lc(b[0]);l.fd=a;for(const w of b)w.Kdc=c,w.setValue(zb.a.v4b,
!0)}finally{l&&l.dispose()}return 32}Bnj(a,b,c){b=this.sa.mg();a=this.sa.Dq();if(!(this.XB.isActive||1===b.length&&a&&a.Esh||this.qp&&this.sa.Uia()))return 16;if(1===c)return 32;if(this.Zb.gd(a))return 16;c=32;if(this.XB.isActive)this.XB.nNa();else if(this.qp)if(this.bQ.wK)this.bQ.wK=!1;else{b=this.sa.Pa.kb;var f=null;if(b&&(f=b.Wa)&&(f.contextId===Db.a.Ff||f.contextId===Db.a.textRange||f.contextId===Db.a.endOfParagraph||f.contextId===Db.a.paragraph))c=this.ia.processAction(D.a.JJc,2);else if(a.rd&&
this.sa.vZ(this.sa.Pa)){if(b=a.c1d())if(b=b.hf(0,0)){b.M_k(this.bQ);var l=b.ZYb;f=-1;l&&(f=db.ParagraphReader.textLength(Object(ua.a)(fg.a,l))+1);if(l=this.Wb.Gi){const w=this.Jb.ie(4),F=l.Ai;w.lc(l);const S=this.eT.aCa(F),fa=Object(ua.a)(132,this.Tie.Scg(b));this.eT.MSe(S,!0,!1,fa,a,b,null,0,f);(a=F.Gfc(S))&&l.Rvb(a);w.dispose()}}}else this.XB.u3g(a)}else this.XB.u3g(a);gb.App.Fb.updateCommandUI();return c}phj(a,b,c){return this.qp&&(a=this.sa.Pa.kb)&&(a=a.Wa)&&(a.contextId===Db.a.Ff||a.contextId===
Db.a.textRange||a.contextId===Db.a.endOfParagraph||a.contextId===Db.a.paragraph)?(this.XB.nNa(),this.ia.processAction(aa.a.nWd,2)):(a=this.sa.Dq())?this.ia.Ma(aa.a.mWd,c,new eA(this.XB.pil,a)):16}qhj(a,b,c,f,l){if(!l||!Object(Ca.a)(eA,l))return za.a.J(18368204,822,10,"Invalid ActionData. Type: {0}",l?Object.getType(l).getName():"null"),8;if(this.qp&&this.bQ.wK)return this.bQ.wK=!1,16;b=l.Clc;if(!(this.XB.isActive&&b&&b.Dsh))return this.XB.nNa(),16;if(this.Zb.gd(b))return 16;if(1===c)return 32;Kc.a.Db&&
(Kc.a.Db.Nj=!1,Kc.a.Db.actionName="FormatPainterApplyToShape",Kc.a.Db.ur=!0);c=this.Jb.xd(15,void 0,()=>{this.sa.fj();this.Ga.Bd()});try{c.lc(l.Clc),c.fd=a,l.Clc.arb=l.qil.id}finally{c&&c.dispose()}this.XB.nNa();return 32}Flj(a,b,c,f,l){if(!l||!Object(Ca.a)(Kh.a,l))return 8;l.Yf(this.XB.isActive||(this.qp?this.bQ.wK:!1));return 32}jAk(a,b,c){return(a=this.Z_b(a))&&Object(Ca.a)(Ls.a,a.Kk)&&(a=Object(ua.a)(Ls.a,a.Kk))?a.iAe(aa.a.uz(b),c):!1}z2d(a,b,c){return(a=this.Z_b(a))&&Object(Ca.a)(Ls.a,a.Kk)&&
(a=Object(ua.a)(Ls.a,a.Kk))?a.A9c(aa.a.uz(b),c):!1}yNc(a){return a.split(",")[1]}NAh(a,b){if(this.Jke&&a.lTc()){var c=this.Z_b(a),f=this.XPf(c,a);a=b.noFillField?null:this.CL(b,a);f=this.Abb.Aol(f,a);this.eEf(c,f)}}Mld(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(this.Jke&&a.lTc()){var f=this.Z_b(a),l=this.XPf(f,a);if(null!==l){if(b.noFillField)l=this.Abb.Sxh(l);else{if(b.wFieldSpecified){var w=Object(ua.a)(132,c.LB(a.slideId)),F=this.Xi.YF;w&&w.ow&&null!=
w.ow.zr&&(F=w.ow.zr);l=this.Abb.Txh(l,b.wField,f.ud,F)}b.prstDashField&&b.prstDashField.valFieldSpecified&&(l=this.Abb.Bol(l,b.prstDashField.valField));if(b.solidFillField){b=this.CL(b,a);l=this.Abb.Sxh(l,b);if(!l)return;b=l.querySelectorAll(this.Abb.NNe);w=!0;for(F=0;F<b.length;++F){const S=b[F].getAttribute("stroke-width");if(S&&!Ja.a.Xa(S.toString())){w=!1;break}}w&&(a=Object(ua.a)(132,c.LB(a.slideId)),c=this.Xi.YF,a&&a.ow&&null!=a.ow.zr&&(c=a.ow.zr),l=this.Abb.Txh(l,ke.a.Xxe/this.Qxe,f.ud,c))}}this.eEf(f,
l)}}}CL(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");b=c.LB(b.slideId);return this.tI.FEb(a,b.Ye)}eEf(a,b){if(b&&a&&a.Kk){a.Kk.CY.Sd(!1);var c=a.Kk.vG.za.childNodes;for(let f=0;f<c.length;++f)a.Kk.vG.za.removeChild(c[f]);a.Kk.vG.za.appendChild(b);(b=a.aNa.getAttribute("transform"))&&a.Kk.vG.za.setAttribute("transform",b.toString());a.Kk.vG.Sd(!0);Kc.a.Db&&(Kc.a.Db.Nj=!0,Kc.a.Db.uE=new Date)}}gwg(a,b,c){return qd.a("EnableSmartArtFillColor")&&this.jAk(a,
b,c)}x$i(){var a=this.sa.mg();a=this.b6a(a,this.sW);var b=this.sa.iO(a),c=null;a=null;qd.a("FixColorPickerSelectedColor")&&(a=this.ua.Ca);if(1===b.length){if(b[0].gea)c=If.Box4ColorHelper.Vqa(b[0].gea);else if(b[0].rd&&qd.a("FixColorPickerSelectedColor")){const f=this.sa.jy();if(!f||!f.length){if(b=this.sa.Mo())b=b.hf(0,0),c=If.Box4ColorHelper.EBa(b.cellShading.solidFillField,a.Ye);return c}c=f[0];c=c.cellShading&&c.cellShading.solidFillField&&a?If.Box4ColorHelper.EBa(c.cellShading.solidFillField,
a.Ye):this.Rz.AKc(Object(ua.a)(fg.a,c))}!c&&qd.a("FixColorPickerSelectedColor")&&b[0].fill&&b[0].fill.solidFillField&&(c=If.Box4ColorHelper.EBa(b[0].fill.solidFillField,a.Ye))}return c}hkl(a){var b=this.ua.Ca;if(!b)throw Error.argumentNull("ActiveSlide is null");b=b.KB(a).isHiddenShape;this.K2k(a,b)}gkl(a,b){a.isHiddenShape=!b;const c=Object(ua.a)(133,a.pc(this.eC));b?c.lJa():(c.pia(),this.sa.PV(a)&&this.sa.I6(a))}K2k(a,b){const c=this.Jb.xd(15,void 0,()=>{this.sa.fj()});try{const f=this.ua.Ca;if(!f)throw Error.argumentNull("ActiveSlide is null");
const l=f.KB(a);c.lc(l);this.gkl(l,b)}finally{c&&c.dispose()}}H2k(a,b){const c=this.Jb.xd(15,void 0,()=>{this.sa.fj()});try{const f=this.ua.Ca;if(!f)throw Error.argumentNull("ActiveSlide is null");const l=f.KB(a);c.lc(l);l.shapeName=b}finally{c&&c.dispose()}}w$i(){var a=this.sa.mg();a=this.b6a(a,this.sW);return this.sa.iO(a)}z$i(a){const b=this.w$i();return b&&1===b.length?b[0].rd?this.Rz.D6f(this.sa.jy()):b[0].fill&&b[0].fill.solidFillField?If.Box4ColorHelper.EBa(b[0].fill.solidFillField,a):null:
null}y$i(a){const b=this.sa.mg();return b&&1===b.length&&b[0].lineStyle&&b[0].lineStyle.solidFillField?If.Box4ColorHelper.EBa(b[0].lineStyle.solidFillField,a):null}Z_b(a){return a?Object(ua.a)(133,a.pc(this.eC)):null}XPf(a,b){try{if(!(a&&a.aNa&&a.Kk&&a.Kk.vG))return null;if(a.Kk.vG.yK()){if(!a.Kk.vG.za)return null;const l=a.Kk.vG.za.childNodes;for(a=0;a<l.length;++a)if("svg"===l[a].tagName.toLowerCase())return l[a];return null}if(!a.aNa.getAttribute(Gk.a.GPc))return null;let c=a.aNa.getAttribute(Gk.a.GPc).toString();
if(!c.toLowerCase().startsWith(this.dgl))return null;c=decodeURIComponent(c.substr(c.indexOf(",")+1));const f=this.cle.sanitize(c);return f&&1===f.children.length?f.children[0]:(b.LQa=!0,null)}catch(c){return za.a.J(38535950,815,10,"ConvertSourceToDOMElement Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}static c$i(a,b){const c=[];if(a)for(const f of a)b&&f.get_isSVGBlipFilled()&&Array.add(c,f);return c}static b4i(a){if(!a)return null;const b=[];for(const c of a)c.ty&&
Array.add(b,c);return b}static IWk(a){let b;for(let c=0;c<a.length;c++){if(!a[c])return!0;b=a[c].shapeType;if(127===b||121===b||124===b)return!0}return!1}static gec(a){return fu.a.parse(a.Color)}}bi.ngh=[.5,1,2.25,4.5];bi.AUk=[6350,12700,28575,57150];bi.agh=[0,0,2,2,0,1,1];bi.wUk=[0,2,0,2,1,0,1];bi.qJf='<Menu Id="{0}">';bi.yJf='<MenuSection Id="Remove Color"><Controls Id="Color.Menu.Controls">';bi.wJf='<Button Id="Color.Menu.RemoveColor" Command="{0}" Image16by16="{1}" Image16by16Class="per_AppointmentColor0_16x16x32" LabelText="{2}" Keytip="{3}" />';
bi.xJf="</Controls> </MenuSection>";bi.ifi='<MenuSection Id="More Fill Colors"><Controls Id="Color.Menu.Controls">';bi.gfi='<Button Id="Color.Menu.MoreFillColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';bi.hfi="</Controls> </MenuSection>";bi.lfi='<MenuSection Id="More Outline Colors"><Controls Id="Color.Menu.Controls">';bi.jfi='<Button Id="Color.Menu.MoreOutlineColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';
bi.kfi="</Controls> </MenuSection>";bi.pJf="</Menu>";Object(e.a)(bi,"ShapesFormatActor",null,[234]);class ji{constructor(a,b,c){this.D2c=Array(ji.WU);this.Y_c=Array(ji.WU);this.Lce=Array(ji.WU);if(!a)throw Error.argumentNull("mainMasterResources");if(!b)throw Error.argumentNull("theme");if(!c)throw Error.argumentNull("resourceViewElementResolver");this.xI=a;this.em=b;this.a4c=c;this.Rta={}}dispose(){Array.clear(this.D2c);Array.clear(this.Y_c);this.em=this.xI=null;const a=va.a.pK(this.Rta);a.length&&
appChrome.api.unregisterIcons(a);this.Rta=null}get vj(){return this.xI.MasterId}M_d(a,b,c){const f=Object.assign(new Kl.a,{Id:"PptRibbon.DrawingFormat.StylesMenu",MenuSectionList:[]});var l=Object.assign(new nk.a,{Id:"MenuSectionShapeStyles",ControlsId:"MenuSectionShapeStyles.Controls",Title:"Quick Styles",DisplayMode:"Size48by48",ControlList:[]});Array.add(f.MenuSectionList,l);var w=c?"GraphicsStyleSection":"ApplyShapeStyleSection",F=c?"GraphicsStyleGallery":"ApplyShapeStyleGallery";w=Object.assign(new qq.a,
{Id:"ControlsShapeStyles",ExternalId:w,ExternalGalleryId:F,Type:4,Width:ji.WU,ElementDimensions:"Size48by48",GalleryItems:[]});Array.add(l.ControlList,w);l=ji.WU*(a?ji.QIf:ji.UIf);c&&(l=ji.WU*ji.TIf);for(F=0;F<l;++F){const S=c?"ApplyGraphicsStyle"+F:"ApplyShapeStyle"+F;Array.add(w.GalleryItems,c?this.GWd(S,F,a,b,!0):this.GWd(S,F,a,b,!1))}return f}GWd(a,b,c,f,l){if(l){var w=this.xI?this.xI.SVGStyles[b]:null;c="SVGStyle";w=w?w.ToolTip:""}else w=this.xI?this.xI.ShapeStyles[b]:null,c=c?"LineStyle":"ShapeStyle",
w=w?this.y0d(w.StyleId):"";return Object.assign(new eE.a,{Id:a,ExternalId:a,Icon:ji.L_b(c,f,b),PreviewIconStyle:ji.i8i(),Command:l?"2748140308":"1963674920",QueryCommand:l?"1903137544":"2375118752",Alt:w})}$bd(a){this.addIconToMap(this.xI.ShapeStyles,"ShapeStyle");this.addIconToMap(this.xI.LineStyles,"LineStyle");a&&this.addIconToMap(this.xI.SVGStyles,"SVGStyle");appChrome.api.registerIconProvider(()=>this.Rta)}eaj(a){if(a<ji.WU&&this.D2c[a])return this.D2c[a];if(a>=this.xI.ShapeStyles.length)return"";
var b=this.xI.ShapeStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.y0d(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.nYd(this.a4c.resolve(dg.a.cqb,b.Icon.ImgId)),
l,f);a<ji.WU&&(this.D2c[a]=b);return b}a$i(a){if(a<ji.WU&&this.Lce[a])return this.Lce[a];if(a>=this.xI.SVGStyles.length)return"";var b=this.xI.SVGStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.dcg(b.StyleId);b=
String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.nYd(this.a4c.resolve(dg.a.cqb,b.Icon.ImgId)),l,f);a<ji.WU&&(this.Lce[a]=b);return b}$3i(a){if(a<ji.WU&&this.Y_c[a])return this.Y_c[a];if(a>=this.xI.LineStyles.length)return"";var b=this.xI.LineStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",
-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.v$f(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.nYd(this.a4c.resolve(dg.a.cqb,b.Icon.ImgId)),l,f);a<ji.WU&&(this.Y_c[a]=b);return b}y0d(a){let b=null;switch(parseInt(String(a/ji.WU))){case 0:b=ResourceStrings.l_ShapeStyleColoredOutline;break;case 1:b=ResourceStrings.l_ShapeStyleColoredFill;break;case 2:b=ResourceStrings.l_ShapeStyleLightOutlineColoredFill;break;case 3:b=ResourceStrings.l_ShapeStyleSubtleEffect;
break;case 4:b=ResourceStrings.l_ShapeStyleModerateEffect;break;case 5:b=ResourceStrings.l_ShapeStyleIntenseEffect}let c;({color:a,Ouh:c}=this.Y6f(a));return String.format(b,a.toString(),c)}dcg(a){return(a=this.xI?this.xI.SVGStyles[a]:null)?a.ToolTip:""}v$f(a){let b=null;switch(parseInt(String(a/ji.WU))){case 0:b=ResourceStrings.l_LineStyleSubtleEffect;break;case 1:b=ResourceStrings.l_LineStyleModerateEffect;break;case 2:b=ResourceStrings.l_LineStyleIntenseEffect}let c;({color:a,Ouh:c}=this.Y6f(a));
return String.format(b,a.toString(),c)}nYd(a){return null===a?"":Ja.a.O1b(a)}addIconToMap(a,b){for(let f=0;f<a.length;++f){var c=a[f];const l=ji.L_b(b,this.vj,f),w={},F={};F.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top);F.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left);F.position="absolute";w.root=F;c=appChrome.buildImageIconFromUrl(this.a4c.resolve(dg.a.cqb,c.Icon.ImgId),w);this.Rta[l]=c}}Y6f(a){let b,c;c=b=null;a%=ji.WU;switch(a){case 0:b=Mi.Color.Mi(this.em.Dark1);c=String.format(ResourceStrings.l_DarkFormat,
1);break;case 1:b=Mi.Color.Mi(this.em.Accent1);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 2:b=Mi.Color.Mi(this.em.Accent2);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 3:b=Mi.Color.Mi(this.em.Accent3);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 4:b=Mi.Color.Mi(this.em.Accent4);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 5:b=Mi.Color.Mi(this.em.Accent5);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 6:b=Mi.Color.Mi(this.em.Accent6),
c=String.format(ResourceStrings.L_AccentFormat,a)}return{color:b,Ouh:c}}static get Cai(){return ji.$Tk}static get Aai(){return ji.YTk}static get Bai(){return ji.ZTk}static i8i(){const a={},b=28/48,c=(28-28*b)/2,f={};f.width=String.format("{0}px",28);f.height=String.format("{0}px",28);f.transform=String.format("matrix({0},0,0,{1},-{2},-{3})",b,b,c,c);a.root=f;return a}static kXd(a,b){const c=new Sys.StringBuilder;c.append('<Menu Id="PptRibbon.DrawingFormat.StylesMenu">');c.append('<MenuSection Id="MenuSectionShapeStyles"><Gallery Id="ControlsShapeStyles" ElementDimensions="Size48by48" Width="7">');
a*=ji.WU;for(let f=0;f<a;++f)c.append(String.format('<GalleryButton Id="Style{0}" ElementDimensions="Size48by48" Command="{1}" QueryCommand="{2}" Alt="" InnerHTML=""/>',f,b?aa.a.zAc:aa.a.fTb,b?aa.a.uAe:aa.a.SAe));c.append("</Gallery> </MenuSection>");c.append("</Menu>");return c.toString()}static L_b(a,b,c){return String.format("{0}_{1}_{2}",a,b,c)}}ji.WU=7;ji.UIf=6;ji.TIf=4;ji.QIf=3;ji.$Tk=ji.kXd(ji.UIf,!1);ji.ZTk=ji.kXd(ji.QIf,!1);ji.YTk=ji.kXd(ji.TIf,!0);Object(e.a)(ji,"StyleGalleryBuilder",null,
[109]);class nN{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb){this.aAb="";this.sxb=[];this.ia=a;this.Rp=b;this.Df=c;this.Ga=l;this.Jb=f;this.ku=w;this.yzb=F;this.sa=S;this.Fa=fa;this.Za=xa;this.sW=Za;pb.xB(Object(C.a)(this,this.eo,"onSessionRehydrated"));this.Za.lCf(Object(C.a)(this,this.d8c,"onSessionInfoChanged"))}wb(){this.ia.ra(aa.a.SAe,$b.a.application,Object(C.a)(this,this.Ilj,"handleQueryShapesStyle"),97);this.ia.ra(aa.a.fuk,$b.a.application,Object(C.a)(this,this.rlj,"handlePopulateShapesStyles"),
96);this.ia.ra(aa.a.fTb,$b.a.application,Object(C.a)(this,this.Ehj,"handleApplyShapesStyle"),4);this.ia.ra(aa.a.uAe,$b.a.application,Object(C.a)(this,this.Glj,"handleQueryGraphicsStyle"),97);this.ia.ra(aa.a.Mtk,$b.a.application,Object(C.a)(this,this.olj,"handlePopulateGraphicsStyles"),96);this.ia.ra(aa.a.zAc,$b.a.application,Object(C.a)(this,this.shj,"handleApplyGraphicsStyle"),4)}Fe(){}Glj(a,b,c,f,l){return this.N_f(l,!0)}Ilj(a,b,c,f,l){return this.N_f(l,!1)}N_f(a,b){var c=this.Rp.presentation;if(!c)throw Error.argumentNull("Presentation is null");
if(!a||!Object(Ca.a)(xv,a))return 8;var f=a.OT.startsWith("Style")?"Style":b?"ApplyGraphicsStyle":"ApplyShapeStyle";f=parseInt(a.OT.substr(f.length));if(isNaN(f)||0>f)return za.a.J(17598104,822,10,"ExecuteQuery{0}Style: Invalid style id recieved from the gallery",b?"Graphics":"Shapes"),8;var l=this.sa.mg();if(!l||!l.length)return 16;const w=a.tWa;if(!w)return 8;var F=c.LB(l[0].slideId);if(!F)return 16;c=F.vj;F=this.o9f(F);a.OT.startsWith(b?"ApplyGraphicsStyle":"ApplyShapeStyle")?(this.aAb=(l=this.LSb(l))?
"SGT_Line":"SGT_Shape",w.T6=F?F.GWd(a.OT,f,l,c,b?!0:!1):null):F?(this.LSb(l)?(this.aAb="SGT_Line",w.xBa=F.$3i(f),w.krb=F.v$f(f)):b?(this.aAb="SGT_SVG",w.xBa=F.a$i(f),w.krb=F.dcg(f)):(this.aAb="SGT_Shape",w.xBa=F.eaj(f),w.krb=F.y0d(f)),w.F4(!1)):(w.xBa="",w.krb="");return 32}olj(a,b,c,f,l){return this.L_f(c,l,!0)}rlj(a,b,c,f,l){return this.sa.gRa()?8:this.L_f(c,l,!1)}L_f(a,b,c){var f=this.Rp.presentation;if(!f)throw Error.argumentNull("Presentation is null");if(1===a)return 32;if(!b)return za.a.J(17598107,
822,10,"ExecutePopulate{0}Styles - Invalid action data",c?"Graphics":"Shapes"),8;a=this.sa.mg();f=a[0]?f.LB(a[0].slideId):null;const l=this.o9f(f);if(b.MenuId&&"style"===b.MenuId)this.LSb(a)?b.PopulationXML=ji.Bai:b.PopulationXML=c?ji.Aai:ji.Cai;else{this.aAb=(a=this.LSb(a))?"SGT_Line":"SGT_Shape";if(!f)return 16;b.MenuItems=l?l.M_d(a,f.vj,c?!0:!1):null}return 32}shj(a,b,c,f,l){return this.Fa.Msh(this.sa.mg())?this.$fg(a,c,l,!0):16}Ehj(a,b,c,f,l){return this.g5k(this.sa.mg())?this.$fg(a,c,l,!1):16}$fg(a,
b,c,f){var l=this.Rp.presentation;if(!l)throw Error.argumentNull("Presentation is null");const w=this.sa.mg();if(!w||!w.length||this.Df.OB(w))return 16;l=l.LB(w[0].slideId);var F=this.ku.M$f(l);if(!F)return this.ku.bel(l),za.a.J(17598111,822,15,"HandleApply{0}Style - MainMasterResources are missing",f?"Graphics":"Shapes"),8;if(1===b)return 32;if(!c)return za.a.J(17598109,822,10,"HandleApply{0}Style - Invalid action data",f?"Graphics":"Shapes"),8;b=this.LSb(w)?F.LineStyles.length:F.ShapeStyles.length;
F=c.startsWith("Style")?"Style":f?"ApplyGraphicsStyle":"ApplyShapeStyle";c=parseInt(c.substr(F.length));if(isNaN(c)||0>c||c>=b)return za.a.J(17598113,822,10,"HandleApply{0}Style - Invalid style id recieved from gallery",f?"Graphics":"Shapes"),16;1===w.length?za.a.J(17598115,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on only one {1}.",f?"Graphics":"Shapes",f?"SVG":"Shape"):1<w.length&&za.a.J(17598145,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on {1} {2}.",f?"Graphics":
"Shapes",w.length,f?"SVGs":"Shapes");f=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.fj()});try{f.lc(Object(ua.a)(132,l));f.fd=a;const S=this.sa.iO(Array.isArray(w)?w:null);for(const fa of S)fa&&fa.J2k(c,this.aAb)}finally{f&&f.dispose()}return 32}d8c(){for(const a of this.sxb)a.dispose();Array.clear(this.sxb)}o9f(a){const b=this.ku.M$f(a);if(!b||!a)return za.a.J(36811143,815,15,"ShapesStyleActor::GetGalleryBuilderForCurrentSlide: MainMasterResource is null now!"),null;for(const c of this.sxb)if(c.vj===
a.vj)return c;a=new ji(b,a.Ye,this.yzb);Array.add(this.sxb,a);a.$bd(this.sW);return a}g5k(a){if(!a||!a.length||this.Fa.cAc(a))return!1;for(const b of a)if(b.esa)return!0;return!1}LSb(a){if(!a)return!1;for(const b of a)if(!b.ty)return!1;return!0}eo(){this.Hla()}Hla(){this.ku.clearCache();for(const a of this.sxb)a.dispose();Array.clear(this.sxb)}}Object(e.a)(nN,"ShapesStyleActor",null,[234,436]);class Bv{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.Lw=this.tm=-1;this.fv=a;this.ia=b;this.Ga=c;this.Df=
f;this.Ay=l;this.sa=w;this.ij=F;this.Fa=S;this.e0j=fa;this.j0j=xa;this.fka=Za;this.wc=pb;this.la=Mb}get Eb(){return this.sa}wb(){this.ia.ra(aa.a.FXa,$b.a.application,Object(C.a)(this,this.nQa,"handleFontFormatAction"),4);this.ia.ra(aa.a.GXa,$b.a.application,Object(C.a)(this,this.nQa,"handleFontFormatAction"),4);this.ia.ra(aa.a.HXa,$b.a.application,Object(C.a)(this,this.nQa,"handleFontFormatAction"),4);this.ia.ra(aa.a.Pjc,$b.a.application,Object(C.a)(this,this.nQa,"handleFontFormatAction"),4);this.ia.ra(aa.a.sGb,
$b.a.application,Object(C.a)(this,this.nQa,"handleFontFormatAction"),4);this.ia.ra(aa.a.YFb,$b.a.application,Object(C.a)(this,this.nQa,"handleFontFormatAction"),4);this.ia.ra(aa.a.VFb,$b.a.application,Object(C.a)(this,this.c1b,"handleFont"),5);this.ia.ra(aa.a.tfb,$b.a.application,Object(C.a)(this,this.c1b,"handleFont"),5);this.ia.ra(aa.a.ufb,$b.a.application,Object(C.a)(this,this.c1b,"handleFont"),5);this.ia.ra(aa.a.wJe,$b.a.application,Object(C.a)(this,this.mlj,"handlePopulateFontNameDropdown"),
97);this.ia.ra(aa.a.Ffb,$b.a.application,Object(C.a)(this,this.c1b,"handleFont"),4);this.ia.ra(aa.a.qGb,$b.a.application,Object(C.a)(this,this.c1b,"handleFont"),4);this.ia.ra(aa.a.Tjc,$b.a.application,Object(C.a)(this,this.nQa,"handleFontFormatAction"),4);this.ia.ra(aa.a.Sjc,$b.a.application,Object(C.a)(this,this.nQa,"handleFontFormatAction"),4);this.ia.ra(aa.a.rgc,$b.a.application,Object(C.a)(this,this.Osb,"handleQueryFontToggleButton"),97);this.ia.ra(aa.a.sgc,$b.a.application,Object(C.a)(this,this.Osb,
"handleQueryFontToggleButton"),97);this.ia.ra(aa.a.ugc,$b.a.application,Object(C.a)(this,this.Osb,"handleQueryFontToggleButton"),97);this.ia.ra(aa.a.tgc,$b.a.application,Object(C.a)(this,this.Osb,"handleQueryFontToggleButton"),97);this.ia.ra(aa.a.Qad,$b.a.application,Object(C.a)(this,this.pOc,"handleQueryFont"),100);this.ia.ra(aa.a.Pad,$b.a.application,Object(C.a)(this,this.pOc,"handleQueryFont"),100);this.ia.ra(aa.a.Rad,$b.a.application,Object(C.a)(this,this.pOc,"handleQueryFont"),97);this.ia.ra(aa.a.Sad,
$b.a.application,Object(C.a)(this,this.pOc,"handleQueryFont"),97);this.ia.ra(aa.a.Yad,$b.a.application,Object(C.a)(this,this.Osb,"handleQueryFontToggleButton"),97);this.ia.ra(aa.a.Xad,$b.a.application,Object(C.a)(this,this.Osb,"handleQueryFontToggleButton"),97)}Fe(){const a=this.Ga.Bc(Xd.a.sg);a.bindAction(A.KeyInputManager.Jv(ResourceStrings.l_HK_Bold),aa.a.FXa);a.bindAction(A.KeyInputManager.Jv(ResourceStrings.l_HK_Italic),aa.a.GXa);a.bindAction(A.KeyInputManager.Jv(ResourceStrings.l_HK_Underline),
aa.a.HXa);a.bindAction(A.KeyInputManager.La(x.a.Ahb,A.KeyInputManager.He|4),aa.a.Pjc);a.bindAction(A.KeyInputManager.La(x.a.kmd,A.KeyInputManager.He|4),aa.a.sGb)}pOc(a,b,c,f,l){c=this.Eb.mg();if(!c||1>c.length)return 16;f=this.Fa.eZ(c);var w=this.Eb.eia();if(1>f.length&&!w)return 16;b=null;this.tm=Date.now();w&&(b=this.wc.o7f(w,new Vs),this.Lw=Date.now(),za.a.J(39981317,815,50,"Query table shape font timespan by {0}",(this.Lw-this.tm).toString()));c=w?[c[0]]:f;for(const F of c){switch(a){case aa.a.Qad:case aa.a.Pad:break;
case aa.a.Rad:c=this.Ay.u_b(F.rd&&b?b.fontName:F.THb);if(l.J1&&l.J1!==c){l.J1="";break}l.J1=c;l.ofd();break;case aa.a.Sad:c="";F.rd&&b?-1!==b.fontSize&&(c=Ja.a.IJc(b.fontSize/2,0,u.AFrameworkApplication.numberFormat)):c=F.d$?Bv.m7f(F).toString():"";f=parseFloat(c);if(!isNaN(f)&&(w=l.J1)&&w!==c){w=Math.min(f,parseFloat(w)).toString()+"+";l.J1=w;break}l.J1=c;l.ofd();break;default:return za.a.J(17602432,820,10,"Unexpected actionId for HandleQueryFont"),8}if(l&&l.J1&&!l.J1.length)break}return 32}Osb(a,
b,c,f,l){b=this.Eb.mg();if(!b||1>b.length)return 16;b=this.Fa.eZ(b);c=this.Eb.eia();if(1>b.length&&!c)return 16;a=c?this.dBk(c,a,new Vs):this.z7g(b,a);l.Yf("select"===a);return"disable"!==a?32:8}c1b(a,b,c,f,l){b=this.Eb.mg();if(!b||1>b.length)return 16;const w=this.Eb.eia();f=this.Fa.eZ(b);if(1>f.length&&!w||this.Df.OB(f)||this.Df.OB([w]))return 16;if(1===c)return 32;this.Eb.fj();this.Ga.Bd();switch(a){case aa.a.VFb:const S=this.ura(l,!0);if(!S)return 8;1<b.length?za.a.J(17602434,815,50,"Set {0} shapes font color.",
b.length):za.a.J(17602436,815,50,"Set one shape font color.");for(const pb of b)if(pb.Xf||pb.xh){On(pb);break}this.fv.Cha(pb=>{pb.TIa=S},f);break;case aa.a.Ffb:case aa.a.qGb:let fa;if(a===aa.a.Ffb){if(fa=this.ura(l,!1),!fa)return 8}else fa="";1<b.length?za.a.J(36755676,815,50,"Set {0} shapes highlight.",b.length):za.a.J(36755678,815,50,"Set one shape highlight.");this.fv.Cha(pb=>{pb.highlight=fa},f);break;case aa.a.tfb:if(!l)return 8;const xa=this.Ay.u_b(l);if(xa.length){1<b.length?za.a.J(17602438,
815,50,"Set {0} shapes font name.",b.length):za.a.J(17602440,815,50,"Set one shape font name.");var F=null;for(const pb of b)if(pb.Xf||pb.xh)On(pb),pb.Xf&&(F=pb);if(1>this.Y$f(f,a,xa).length)return 16;this.fv.Cha(pb=>{pb.THb=xa},f);F&&(F.THb=xa);this.Ay.bzc(l)}break;case aa.a.ufb:l=Object(ua.a)(hE.a,l);if(!l||!l.od)return 8;const Za=this.ij.uVb(l.od);if(isNaN(Za))return 8;1<b.length?za.a.J(17602442,815,50,"Set {0} shapes font size.",b.length):za.a.J(17602444,815,50,"Set one shape font size.");l=null;
for(F of b)if(F.Xf||F.xh)On(F),F.Xf&&(l=F);if(1>this.Y$f(f,a,Za*Xj.a.n7a).length)return 16;this.fv.Cha(pb=>{pb.llh(Za)},f);l&&l.llh(Za);break;default:return za.a.J(17602445,820,10,"Unexpected actionId for HandleFont"),8}return 32}nQa(a,b,c){b=this.Eb.mg();if(!b||1>b.length)return 16;const f=this.Eb.eia(),l=this.Fa.eZ(b);if(1>l.length&&!f||this.Df.OB(l)||this.Df.OB([f]))return 16;if(1===c)return 32;const w="select"!==this.z7g(this.Fa.eZ(b),a);this.Eb.fj();this.Ga.Bd();switch(a){case aa.a.FXa:1<b.length?
za.a.J(17602447,815,50,"Set {0} shapes bold.",b.length):za.a.J(17602449,815,50,"Set one shape bold.");this.fv.Cha(S=>{S.isBold=w},l);break;case aa.a.GXa:1<b.length?za.a.J(17602451,815,50,"Set {0} shapes italic.",b.length):za.a.J(17602453,815,50,"Set one shape italic.");this.fv.Cha(S=>{S.isItalic=w},l);break;case aa.a.HXa:1<b.length?za.a.J(17602455,815,50,"Set {0} shapes underline.",b.length):za.a.J(17602457,815,50,"Set one shape underline.");this.fv.Cha(S=>{S.mD=w},l);break;case aa.a.YFb:1<b.length?
za.a.J(17602459,815,50,"Set {0} shapes strikethrough.",b.length):za.a.J(17602461,815,50,"Set one shape strikethrough.");this.fv.Cha(S=>{S.YE=w},l);break;case aa.a.Pjc:case aa.a.sGb:const F=a===aa.a.sGb?!1:!0;1<b.length?za.a.J(17602463,815,50,"Step {0} shapes font size.",b.length):za.a.J(17602465,815,50,"Step one shape font size.");this.fv.Cha(S=>{S.pvb=F},l);break;case aa.a.Tjc:1<b.length?za.a.J(36712597,815,50,"Step {0} shapes superscript.",b.length):za.a.J(36712599,815,50,"Step one shape superscript.");
this.fv.Cha(S=>{S.zM=w?3E4:0},l);break;case aa.a.Sjc:1<b.length?za.a.J(36712601,815,50,"Step {0} shapes subscript.",b.length):za.a.J(36712603,815,50,"Step one shape subscript.");this.fv.Cha(S=>{S.zM=w?-25E3:0},l);break;default:return 8}return 32}mlj(a,b,c,f,l){if(1===c)return 32;od.Font.E5d(b);l.MenuItems=da.FontUtils.Z4f(Bv.Ygd,Bv.LJc,this.e0j,this.fka,this.j0j);return 32}z7g(a,b){let c="select";for(const f of a){switch(b){case aa.a.rgc:case aa.a.FXa:c=f.isBold?"select":"normal";break;case aa.a.sgc:case aa.a.GXa:c=
f.isItalic?"select":"normal";break;case aa.a.ugc:case aa.a.HXa:c=f.mD?"select":"normal";break;case aa.a.tgc:case aa.a.YFb:c=f.YE?"select":"normal";break;case aa.a.Yad:case aa.a.Tjc:c=0<f.zM?"select":"normal";break;case aa.a.Xad:case aa.a.Sjc:c=0>f.zM?"select":"normal";break;default:return"disable"}if("select"!==c)break}return c}dBk(a,b,c){this.tm=Date.now();c=this.wc.o7f(a,c);switch(b){case aa.a.rgc:a=1===c.bold?"select":"normal";break;case aa.a.sgc:a=1===c.italic?"select":"normal";break;case aa.a.ugc:a=
1===c.underline?"select":"normal";break;case aa.a.tgc:a=1===c.strikethrough?"select":"normal";break;default:return"disable"}this.Lw=Date.now();za.a.J(39981341,815,50,"Query table shape font state timespan by {0}",(this.Lw-this.tm).toString());return a}Y$f(a,b,c){const f=[];for(const l of a)switch(b){case aa.a.FXa:l.isBold!==c&&Array.add(f,l);break;case aa.a.GXa:l.isItalic!==c&&Array.add(f,l);break;case aa.a.HXa:l.mD!==c&&Array.add(f,l);break;case aa.a.YFb:l.YE!==c&&Array.add(f,l);break;case aa.a.tfb:l.THb!==
c&&Array.add(f,l);break;case aa.a.ufb:Bv.m7f(l)!==c&&Array.add(f,l);break;case aa.a.Tjc:0<l.zM!==c&&Array.add(f,l);break;case aa.a.Sjc:0>l.zM!==c&&Array.add(f,l);break;default:za.a.J(17602467,820,10,"ShapesTextFontActor::GetModifiedShapeMonikers unsupported action Id: {0}.",b)}return f}ura(a,b){if(b)return b=oi.SchemeColor.parse(a),b&&b.Dra?Ul.i(Ul.g(b.hP)):(za.a.J(17602498,820,10,"Font color '{0}' is incorrect",a),null);b=fu.a.parse(a);return b&&b.RGBColor?b.RGBColor:(za.a.J(37861518,820,10,"Color '{0}' is incorrect",
a),null)}static LJc(a,b){return b}static Ygd(){return!1}static m7f(a){const b=a.z1;return sg.a.ry(b,1)?a.d$:Math.round(a.d$)*b}}Object(e.a)(Bv,"ShapesTextFontActor",null,[234]);class oN{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc){this.Lw=this.tm=-1;this.fv=a;this.ia=b;this.Ga=c;this.Df=f;this.sa=l;this.Fa=w;this.cab=F;this.$K=S;this.Ib=fa;this.Jb=xa;this.LVc=Za;this.wc=pb;this.Jz=Mb;this.la=hc}get Eb(){return this.sa}wb(){this.ia.ra(aa.a.oGb,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),
4);this.ia.ra(aa.a.XFb,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),4);this.ia.ra(aa.a.vfb,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),4);this.ia.ra(aa.a.pGb,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),4);this.ia.ra(aa.a.Ifb,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),4);this.ia.ra(aa.a.WFb,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),4);this.ia.ra(aa.a.Ojc,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),
4);this.ia.ra(aa.a.zgd,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),4);this.ia.ra(aa.a.bgd,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),4);this.ia.ra(aa.a.agd,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),4);this.ia.ra(aa.a.$fd,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),4);this.ia.ra(aa.a.Zfd,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),4);this.ia.ra(aa.a.uJe,$b.a.application,Object(C.a)(this,this.Zgg,
"handleQueryLineSpacing"),4);this.ia.ra(aa.a.Fjc,$b.a.application,Object(C.a)(this,this.k7,"handleFormatAction"),4);this.ia.ra(aa.a.Odb,$b.a.application,Object(C.a)(this,this.pQa,"handleQueryToggleButton"),97);this.ia.ra(aa.a.Pdb,$b.a.application,Object(C.a)(this,this.pQa,"handleQueryToggleButton"),97);this.ia.ra(aa.a.rWa,$b.a.application,Object(C.a)(this,this.pQa,"handleQueryToggleButton"),97);this.ia.ra(aa.a.sWa,$b.a.application,Object(C.a)(this,this.pQa,"handleQueryToggleButton"),97);this.ia.ra(aa.a.Uad,
$b.a.application,Object(C.a)(this,this.pQa,"handleQueryToggleButton"),97);this.ia.ra(aa.a.Oad,$b.a.application,Object(C.a)(this,this.pQa,"handleQueryToggleButton"),97);this.ia.ra(aa.a.Wad,$b.a.application,Object(C.a)(this,this.pQa,"handleQueryToggleButton"),97);this.ia.ra(aa.a.Tad,$b.a.application,Object(C.a)(this,this.pQa,"handleQueryToggleButton"),97);this.ia.ra(aa.a.abd,$b.a.application,Object(C.a)(this,this.Q2d,"handleQueryTextAnchoring"),97);this.ia.ra(aa.a.$ad,$b.a.application,Object(C.a)(this,
this.Q2d,"handleQueryTextAnchoring"),97);this.ia.ra(aa.a.Zad,$b.a.application,Object(C.a)(this,this.Q2d,"handleQueryTextAnchoring"),97);this.ia.ra(aa.a.Vad,$b.a.application,Object(C.a)(this,this.Zgg,"handleQueryLineSpacing"),97)}Fe(){const a=this.Ga.Bc(Xd.a.sg);a.bindAction(A.KeyInputManager.Jv(ResourceStrings.l_HK_FullJustify),aa.a.WFb);a.bindAction(A.KeyInputManager.Jv(ResourceStrings.l_HK_CenterJustify),aa.a.pGb);r.a.ak?(a.bindAction(A.KeyInputManager.Jv(ResourceStrings.l_HK_LeftJustify_Mac),aa.a.vfb),
a.bindAction(A.KeyInputManager.Jv(ResourceStrings.l_HK_RightJustify_Mac),aa.a.Ifb)):(a.bindAction(A.KeyInputManager.Jv(ResourceStrings.l_HK_LeftJustify),aa.a.vfb),a.bindAction(A.KeyInputManager.Jv(ResourceStrings.l_HK_RightJustify),aa.a.Ifb))}pQa(a,b,c,f,l){const w=this.Eb.mg();if(!w||1>w.length)return 16;b=this.Eb.eia();const F=this.Fa.eZ(w);if(1>F.length&&!b)return 16;f=c=null;let S=a===aa.a.Odb?1:a===aa.a.Pdb?2:18;Object(Ca.a)(Kh.a,l)?f=l:Object(Ca.a)(xv,l)&&(f=l.tWa,S=l.menuItemId);l=b?[w[0]]:
F;this.tm=Date.now();for(const fa of l){switch(a){case aa.a.Odb:c=fa.rd?this.k1d(S,a):this.v0d(S,fa,a);break;case aa.a.Pdb:c=fa.rd?this.k1d(S,a):this.v0d(S,fa,a);break;case aa.a.rWa:case aa.a.sWa:c=fa.rd?this.k1d(S,a):this.v0d(S,fa,a);break;case aa.a.Uad:c=fa.rd?1===this.wc.QKc(b)?"select":"normal":1===fa.pl?"select":"normal";break;case aa.a.Oad:c=fa.rd?2===this.wc.QKc(b)?"select":"normal":2===fa.pl?"select":"normal";break;case aa.a.Wad:c=fa.rd?3===this.wc.QKc(b)?"select":"normal":3===fa.pl?"select":
"normal";break;case aa.a.Tad:c=fa.rd?6===this.wc.QKc(b)?"select":"normal":4===fa.pl?"select":"normal";break;default:c="disable"}if("normal"===c)break}f.Yf("select"===c);this.Lw=Date.now();b&&za.a.J(39981346,815,50,"Query table shape timespan by {0}",(this.Lw-this.tm).toString());return"disable"!==c?32:8}v0d(a,b,c){return c===aa.a.rWa||c===aa.a.Odb||c===aa.a.sWa||c===aa.a.Pdb?this.$K.zFf(b,a)?"select":"normal":"normal"}k1d(a,b){var c=!0,f=this.Eb.eia();f=fd.SelectionFactory.NEc(Object(ua.a)(fg.a,f));
for(const l of f){if(c=l.Ok?l.node:null)if(f=this.Ib.Jc(c),f.set(c),f.oc(11),f.Og(11),c=this.Jz.rx(f)){if(0===a){c=!1;break}if(b===aa.a.Odb)c=1===c.listType;else if(b===aa.a.Pdb)c=0===c.listType;else if(b===aa.a.rWa){f=this.$K.nSa.ga(a).PTb;const w=this.$K.nSa.ga(a).Tnb;c=c.Tsb&&0<c.P7.length&&c.P7[0]===f&&c.b7a&&c.font===w}else b===aa.a.sWa?(f=this.$K.Y5c.ga(a).$Id,c=!!c.propertySet&&c.propertySet.Sa(zb.a.autonumberBulletType)&&c.propertySet.getValue(zb.a.autonumberBulletType)===f):c=!1}else c=0===
a?b===aa.a.rWa||b===aa.a.sWa?!0:!1:!1;else c=!1;if(!c)break}return c?"select":"normal"}k7(a,b,c,f,l){f=this.Eb.mg();if(!f||1>f.length)return 16;b=this.Fa.eZ(f);const w=this.Eb.eia(),F=!!w&&(a===aa.a.Ojc||a===aa.a.zgd);if(!b.length&&!w||F||this.Df.OB(b)||this.Df.OB([w]))return 16;if(1===c)return 32;this.Eb.fj();a!==aa.a.Fjc&&this.Ga.Bd();switch(a){case aa.a.oGb:case aa.a.XFb:if(Object.getType(l)!==Number)return 8;this.G2k(f,b,l);break;case aa.a.vfb:case aa.a.pGb:case aa.a.Ifb:case aa.a.WFb:var S=this.MUf(b);
this.E2k(b,a,l);S&&this.sa.selectShape(S,!1);Kc.a.uO(!0,!1);break;case aa.a.Ojc:case aa.a.zgd:l=[];const fa=a===aa.a.Ojc?1:2;for(S of b)Array.add(l,S);1<f.length?za.a.J(17602509,815,50,"Set {0} shapes text direction.",f.length):za.a.J(17602511,815,50,"Set one shape text direction.");this.fv.S4a(Za=>{if(Za=Object(ua.a)(4,Za))Za.SHb=fa},l);break;case aa.a.Fjc:if(!l||!Object(Ca.a)(Array,l)||1>l.length)return 8;Kc.a.Db&&(Kc.a.Db.Nj=!0);b=this.Jb.xd(15);try{for(b.lc(l[0].g0),b.fd=a,a=0;a<l.length;a++)l[a].g0.Nga=
l[a].m9.left,l[a].g0.Oga=l[a].m9.right,l[a].g0.Pga=l[a].m9.top,l[a].g0.Mga=l[a].m9.bottom}finally{b&&b.dispose()}Kc.a.uO(!0,!1);break;case aa.a.bgd:case aa.a.agd:case aa.a.$fd:l=[];let xa=1;switch(a){case aa.a.bgd:xa=0;break;case aa.a.agd:xa=1;break;case aa.a.$fd:xa=2}for(const Za of b)Array.add(l,Za);za.a.J(17653768,815,50,"Set text anchoring, shape count: {0}.",f.length);this.fv.S4a(Za=>{if(Za=Object(ua.a)(4,Za))Za.$ma=xa},l);Kc.a.uO(!0,!1);break;case aa.a.Zfd:if(!l||Object.getType(l)!==Number)return 8;
S=this.MUf(b);this.F2k(b,l,a);S&&this.sa.selectShape(S,!1);Kc.a.uO(!0,!1);break;default:return 8}return 32}Q2d(a,b,c,f,l){b=this.Eb.mg();if(!b||1>b.length)return 16;b=this.Eb.IYd(b);f=b.ovb;c=0;const w=this.Eb.eia();if(!f&&!w)return 16;switch(a){case aa.a.abd:a=w?({lva:c}=this.wc.HQe(w)).returnValue&&0===c?"select":"normal":0===b.$ma?"select":"normal";break;case aa.a.$ad:a=w?({lva:c}=this.wc.HQe(w)).returnValue&&1===c?"select":"normal":1===b.$ma?"select":"normal";break;case aa.a.Zad:a=w?({lva:c}=
this.wc.HQe(w)).returnValue&&2===c?"select":"normal":2===b.$ma?"select":"normal";break;default:a="disable"}l.Yf("select"===a);return"disable"!==a?32:8}Zgg(a,b,c,f,l){c=this.Eb.mg();if(!c||1>c.length)return 16;b=this.Eb.eia();c=this.Fa.eZ(c);if(!c.length&&!b)return 16;this.tm=Date.now();switch(a){case aa.a.uJe:break;case aa.a.Vad:a=new bN.a;a.Of=2;a.value=l.MenuItemId;f=!0;b&&(f=this.x8k(b,l),this.Lw=Date.now(),za.a.J(39981381,815,50,"Query table shape timespan by {0}",(this.Lw-this.tm).toString()));
for(const w of c){b=this.Fa.u0d(w);if(!b||!this.cab.FFf(b,a)){f=!1;break}this.LVc&&2===b.Of&&(b.value=Math.max(0,b.value-this.Fa.cXd(w)))}l.queryResult.Yf(f);break;default:return 8}return 32}F2k(a,b,c){const f=this.Jb.xd(15);try{f.lc(a[0]);f.fd=c;for(const l of a)l.Tqa();this.ia.Ma(aa.a.Ola,2,b)}finally{f&&f.dispose()}}E2k(a,b,c){const f=[];let l=0,w=0;switch(b){case aa.a.vfb:l=1;w=D.a.ija;break;case aa.a.pGb:l=2;w=D.a.Xga;break;case aa.a.Ifb:l=3;w=D.a.wma;break;case aa.a.WFb:l=4,w=D.a.wBa}a=this.sa.iO(a);
for(const F of a)F.pl!==l&&Array.add(f,F);if(w&&f.length){for(const F of a)if(F.Xf||F.xh){On(F);break}a=this.Jb.xd(15);try{a.lc(f[0]);for(const F of f)F.Tqa(),F.u3k(l);this.ia.Ma(w,2,c)}finally{a&&a.dispose()}}}G2k(a,b,c){const f=[];let l=1===c||2===c;for(const F of b)this.$K.zFf(F,c)||(l=!1,Array.add(f,F));1<a.length?za.a.J(23674979,815,50,"ListGallery enabled, set {0} shapes bullet.",a.length):za.a.J(23675009,815,50,"ListGallery enabled, set one shape bullet.");for(const F of a)if(F.Xf||F.xh){On(F);
break}a=l?b:f;2!==c||l||(a=b,c=11);if(l||0===c)c=18;const w=this.$K.nSa.ga(c);0<a.length&&this.fv.S4a(F=>{F.setValue(zb.a.RHb,c);w&&(F.setValue(zb.a.wuh,w.Tnb),F.setValue(zb.a.vuh,w.PTb))},a)}x8k(a,b){let c=!1;const f=b.MenuItemId;let l=b.LineSpacingValue;b=b.LineSpacingUnit;a=fd.SelectionFactory.NEc(Object(ua.a)(fg.a,a));for(const w of a){if(a=w.Ok?w.node:null){a=this.cab.qV(a);const F=sg.a.ry(a.lineSpacing.value,f)&&2===a.lineSpacing.Of;if(-1===l)b=a.lineSpacing.Of,l=a.lineSpacing.value;else if(l!==
a.lineSpacing.value||b!==a.lineSpacing.Of)l=b=0,c=!1;0!==b&&(c=F)}if(!c)break}return c}MUf(a){return 0<a.length&&a[0].xh&&(a=this.Fa.ys(a[0]))?(this.sa.I6(a),a):null}}Object(e.a)(oN,"ShapesTextParagraphActor",null,[234]);var RQ=d(665);class pN{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.ia=a;this.Df=b;this.Jb=c;this.Gz=f;this.Ga=l;this.sa=w;this.Wb=F;this.ua=S;this.Ub=fa;this.Ha=xa;this.Tv=Za;this.Pb=pb;if(!Mb)throw Error.argumentNull("GraphOperationEventHandler is null");this.yh=Mb}wb(){this.ia.ra(aa.a.deleteObject,
Db.a.application,Object(C.a)(this,this.yij,"handleDelete"),4);this.Ha.podsEnableSlideScoreCard&&this.ia.ra(aa.a.JAk,de.a.frame,Object(C.a)(this,this.Itl,"updateSlideScore"),96);this.ia.ra(aa.a.CXf,$b.a.application,Object(C.a)(this,this.Qij,"handleDuplicate"),4);this.ia.ra(aa.a.nAf,$b.a.application,Object(C.a)(this,this.ehj,"handleAddFirstSlide"),4);this.Ha.ZIj?(this.ia.ra(aa.a.LM,Db.a.application,Object(C.a)(this,this.Hij,"handleDeleteSlides"),4),this.ia.ra(aa.a.YR,$b.a.application,Object(C.a)(this,
this.Tij,"handleDuplicateSlides"),4),this.Ha.V3d?(this.ia.ra(aa.a.gPc,$b.a.application,Object(C.a)(this,this.zjj,"handleHideSlides"),4),this.ia.ra(aa.a.zyh,$b.a.application,Object(C.a)(this,this.Gnj,"handleUnhideSlides"),4),this.yh.Jmb(Object(C.a)(this,this.bcl,"slidesSelectionChangedHandler"))):this.ia.ra(aa.a.gPc,$b.a.application,Object(C.a)(this,this.A2d,"handleHideSlidesOld"),4),this.ia.ra(aa.a.XAe,Db.a.application,Object(C.a)(this,this.Llj,"handleQuerySlidesHidden"),96)):(this.ia.ra(aa.a.LM,
Db.a.application,Object(C.a)(this,this.Gij,"handleDeleteSlide"),4),this.ia.ra(aa.a.YR,$b.a.application,Object(C.a)(this,this.Sij,"handleDuplicateSlide"),4),this.ia.ra(aa.a.gPc,$b.a.application,Object(C.a)(this,this.yjj,"handleHideSlide"),4),this.ia.ra(aa.a.XAe,Db.a.application,Object(C.a)(this,this.Klj,"handleQuerySlideHidden"),96));this.ia.ra(aa.a.DQd,Db.a.application,Object(C.a)(this,this.Aij,"handleDeleteFakeSlides"),2048);this.ia.ra(aa.a.yMf,Db.a.application,Object(C.a)(this,this.fij,"handleClearAndResizeSlideCanvas"),
2048);this.ia.ya(aa.a.hmh,$b.a.application,Object(C.a)(this,this.Wmj,"handleShareSlide"));this.ia.ra(aa.a.WAe,Db.a.application,Object(C.a)(this,this.D2d,"handleIsDirectManipulationEnabled"),97)}Fe(){const a=this.Ga.Bc(Ai.a.zB);a.bindAction(A.KeyInputManager.La(x.a.ona,0),aa.a.LM);a.bindAction(A.KeyInputManager.La(x.a.fH,0),aa.a.LM);a.bindAction(A.KeyInputManager.La(x.a.FJa,A.KeyInputManager.He),aa.a.YR)}yij(a,b,c,f,l){if(this.Ga.ye)if(this.Ga.Vaa===Ai.a.zB||1===this.Pb.Aw)a=aa.a.LM;else if(this.Ga.Vaa===
Xd.a.sg)a=aa.a.B3a;else return 8;else return 8;return this.ia.Ma(a,c,l)}Gij(a,b,c){b=this.ua.Ca;if(!b||this.Df.gd(b)||this.Ha.vz&&1!==this.sa.rf().length)return 16;if(1===c)return 32;if(!b.isConnected)return 16;Kc.a.Db&&(Kc.a.Db.actionName="DeleteSlide",Kc.a.Db.ur=!1,Kc.a.Db.Nj=!0,Kc.a.Db.Ya("SlideCount","1"));c=this.Wb.Bf;if(!c)return 16;const f=this.Jb.xd(15,void 0,()=>{this.sa.Rh()});try{f.lc(c),f.fd=a,c.LM(b)}finally{f&&f.dispose()}this.Df.xw(c,a);a=[];a.push(b);this.Tv?this.Tv.JBe(new Uz(a)):
za.a.J(51172880,822,10,"HandleDeleteSlide: graphOperationEventNotifier is null for raising event.");return 32}fij(a,b,c){a=this.Ub.UH(this.ua.EUc?this.ua.EUc.slideIndex:0);if(!a)return za.a.J(526952344,822,50,"HandleClearAndResizeSlideCanvas: slideNode null"),8;a=Object(ua.a)(316,a.pc(this.Pb.Na));if(!a)return za.a.J(526952345,822,50,"HandleClearAndResizeSlideCanvas: slideViewElement null"),16;if(1===c)return 32;za.a.J(526952006,822,50,"HandleClearAndResizeSlideCanvas: updating slideViewElement");
a.nIe(!1);a.updateOffSlideView(0,!0);return 32}Aij(a,b,c){b=[];for(const f of this.Ub.jKc())f.zK&&Array.add(b,f);if(!b.length||!this.ua.Ca)return za.a.J(526952346,822,50,"HandleDeleteFakeSlides: empty fake slides"),8;if(1===c)return 32;za.a.J(526952007,822,50,"HandleDeleteFakeSlides: deleting fake slides");return this.IUf(b,"DeleteFakeSlide",a)}Hij(a,b,c){b=this.sa.rf();if(!b||!b.length||!this.ua.Ca)return 16;for(const f of b)if(!f||this.Df.gd(f))return 16;if(1===c)return 32;for(const f of b)if(!f.isConnected)return 16;
return this.IUf(b,"DeleteSlide",a)}IUf(a,b,c){Kc.a.Db&&(Kc.a.Db.actionName=b,Kc.a.Db.ur=!1,Kc.a.Db.Nj=!0,Kc.a.Db.Ya("SlideCount",a.length.toString()));1<a.length?za.a.J(33633429,822,50,"HandleDeleteSlides: Selected slidenodes: {0}",a.length):za.a.J(33633431,822,50,"HandleDeleteSlides: Selected one slidenode.");b=this.Wb.Bf;if(!b)return 16;this.VCi(b,a,c,()=>{this.sa.Rh()});return 32}VCi(a,b,c,f){f=this.Jb.xd(15,void 0,f);try{f.lc(a);for(const l of b)l&&!l.Cb.equals(this.ua.Ca.Cb)&&a.LM(l);a.LM(this.ua.Ca);
f.fd=c}finally{f&&f.dispose()}this.Ha.unblockContentWhenDeletingSlideEnabled||this.Df.xw(a,c);this.Tv?this.Tv.JBe(new Uz(b)):za.a.J(51172884,822,10,"HandleDeleteSlides: graphOperationEventNotifier is null for raising event.")}Klj(a,b,c,f,l){a=this.ua.Ca;if(!a)return 16;l.Yf(a.zn);return 32}Llj(a,b,c,f,l){a=this.sa.rf();if(!a||!a.length)return 16;a=this.kId(a);l.Yf(a);return 32}Wmj(a,b,c,f,l){a=this.ua.Ca;if(!a||this.Df.gd(a)||1!==this.sa.rf().length)return 16;if(1===c)return 32;Kc.a.Db&&(Kc.a.Db.ur=
!1,Kc.a.Db.Ya("SlideCount","1"));c=a.Cb;if(!c)return 16;c=JSON.stringify({["sId"]:c.sid,["cId"]:c.cid});l.nav=RQ.a(c);l.mode="copy";za.a.J(41776982,822,50,"HandleShareSlide: nav:{0}",c);this.ia.Ma(G.a.gPa,2,l);return 32}yjj(a,b,c){b=this.ua.Ca;if(!b||this.Df.gd(b)||this.Ha.vz&&1!==this.sa.rf().length)return 16;if(1===c)return 32;Kc.a.Db&&(Kc.a.Db.ur=!1,Kc.a.Db.Ya("SlideCount","1"));c=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()},()=>{1!==this.Pb.Aw&&this.Ga.vf(Ai.a.zB)});try{c.lc(b),c.fd=a,
b.zn=!b.zn}finally{c&&c.dispose()}return 32}A2d(a,b,c){b=this.sa.rf();if(!b||!b.length)return 16;for(var f of b)if(!f||this.Df.gd(f))return 8;if(1===c)return 32;za.a.J(536990858,822,50,"HandleHideSlidesOld: Selected slidenodes: {0}",b.length);Kc.a.Db&&(Kc.a.Db.ur=!1,Kc.a.Db.Ya("SlideCount",b.length.toString()));c=!this.kId(b);f=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()},()=>{1!==this.Pb.Aw&&this.Ga.vf(Ai.a.zB)});try{f.lc(this.Wb.Bf);f.fd=a;for(const l of b)l.zn=c}finally{f&&f.dispose()}return 32}zjj(a,
b,c,f,l){const w=this.sa.rf();if(!w||!w.length)return 16;for(const F of w)if(!F||this.Df.gd(F))return 8;if(this.kId(w))return this.zOc(),32;this.A2d(a,b,c,f,l);this.zOc();return 32}Gnj(a,b,c,f,l){const w=this.sa.rf();if(!w||!w.length)return 16;for(const F of w)if(!F||this.Df.gd(F))return 8;if(1===c)return 32;this.A2d(a,b,c,f,l);this.zOc();return 32}zOc(){var a=this.sa.rf();if(a&&a.length){for(var b of a)if(!b||this.Df.gd(b))return;if(Pg.c()){b=!0;for(const c of a)if(!c.zn){b=!1;break}a=[appChrome.actions.updateControlHiddenState("HideSlide",
b),appChrome.actions.updateControlHiddenState("UnhideSlide",!b)];appChrome.api.dispatch(a)}else za.a.J(528052947,822,50,"HandleToggleHiddenBehavior: appChrome not defined")}}bcl(){this.zOc()}Itl(a,b,c,f,l){if(1===c)return 32;this.ua.Ca&&(a="Slide Complex: "+this.ua.Ca.ta(zb.a.nma,0).toString(),l[Bq.a.Value]=a,l[tm.a.labelText]=a,l[Bq.a.Visible]=!0);return 32}Qij(a,b,c,f,l){if(this.Ga.ye)if(this.Ga.Vaa===Ai.a.zB)a=aa.a.YR;else if(this.Ga.Vaa===Xd.a.sg)a=aa.a.E4a;else return 8;else return 8;return this.ia.Ma(a,
c,l)}Sij(a,b,c){b=this.ua.Ca;if(!b||this.Df.gd(b)||this.Ha.vz&&1!==this.sa.rf().length)return 16;if(1===c)return 32;Kc.a.ik("SlideCount","1");this.Gz.ELi(b,a).OV||this.Df.xw(this.Wb.Bf,a);return 32}Tij(a,b,c){b=this.sa.rf();if(!b||!b.length)return 16;for(var f of b)if(!f||this.Df.gd(f))return 16;if(1===c)return 32;1<b.length?za.a.J(33633437,822,50,"HandleDuplicateSlides: Selected slidenodes: {0}",b.length):za.a.J(33633439,822,50,"HandleDuplicateSlides: Selected one slidenode.");Kc.a.ik("SlideCount",
b.length.toString());c=this.Gz.D_f(b,a,null,null,!0);f=!0;for(const l of c)if(!l.OV){f=!1;break}f||this.Df.xw(this.Wb.Bf,a);return 32}ehj(){try{za.a.J(51409747,801,50,"SlideActor: HandleAddFirstSlide called.");const a=this.Ub.QH();a&&0<a.length&&this.Gz.eIc(null,a[0].Id,this.Ha.R4b?0:a[0].ContentMasters[0].Id,aa.a.nBb);return 32}catch(a){return za.a.J(51409749,801,10,"Exception in HandleAddFirstSlide: {0}.",a),8}}D2d(a,b,c,f,l){return l&&Object(Ca.a)(Rd.a,l)?this.Df.gd(this.Ub.Bk(l))?16:32:8}kId(a){for(const b of a)if(!b.zn)return!1;
return!0}}Object(e.a)(pN,"SlideActor",null,[234]);class qN{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(e.a)(qN,"GallerySectionProps",null,[]);const EE=()=>{appChrome.PRIToastManager.dismissToast()};class FE{constructor(a,b,c){this.slideId=a;this.x8j=b;this.Pri=c}}Object(e.a)(FE,"NewSlideWithLayoutData",null,[]);class gj{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc){this.wta=0;this.lZc={};this.rNg=this.sNg=0;this.ia=a;this.Zb=b;this.Ga=c;this.o0j=gj.WCj(f);
this.sa=l;this.Jb=w;this.Gz=F;this.Wb=S;this.ua=fa;this.Ub=xa;this.lfe=Za;this.ku=pb;this.ku.Dzc(Object(C.a)(this,this.B0g,"openIgnoredDialog"));this.Ha=Mb;this.yzb=hc;this.Rta={}}wb(){this.Ha.YIj?this.ia.ra(aa.a.Lpa,$b.a.application,Object(C.a)(this,this.uhg,"handleSlidesChangeLayout"),4):this.ia.ra(aa.a.Lpa,$b.a.application,Object(C.a)(this,this.Yhj,"handleChangeLayout"),4);this.ia.ra(aa.a.oGa,$b.a.application,Object(C.a)(this,this.Mgg,"handleNewSlideWithLayoutOptions"),4);this.ia.ra(aa.a.pla,$b.a.application,
Object(C.a)(this,this.Lgg,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(aa.a.nBb,$b.a.application,Object(C.a)(this,this.Lgg,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(aa.a.B5c,$b.a.application,Object(C.a)(this,this.Fkj,"handleNewSlideWithLayout"),4);this.ia.ra(aa.a.Y3g,$b.a.application,Object(C.a)(this,this.Mgg,"handleNewSlideWithLayoutOptions"),4);this.ia.ra(aa.a.wQc,$b.a.application,Object(C.a)(this,this.hmj,"handleReactInsertSlideWithLayout"),4);this.ia.ra(aa.a.utk,$b.a.application,Object(C.a)(this,
this.uhg,"handleSlidesChangeLayout"),4);this.ia.ra(aa.a.tLd,$b.a.application,Object(C.a)(this,this.gmj,"handleReactChangeSlideLayout"),4);this.ia.ra(aa.a.rad,$b.a.application,Object(C.a)(this,this.rad,"queryNewSlideLayout"),4);this.ia.ra(aa.a.hAe,$b.a.application,Object(C.a)(this,this.hAe,"queryChangeSlideLayout"),4)}Fe(){const a=this.Ga.Bc(Ai.a.zB),b=this.Ga.Bc(Ai.a.VU),c=this.Ga.Bc(Xd.a.sg),f=this.Ga.Bc(Xd.a.QM);a.bindAction(A.KeyInputManager.La(x.a.Xp,0),aa.a.pla);a.bindAction(A.KeyInputManager.La(x.a.Xea,
A.KeyInputManager.He),aa.a.pla);c.bindAction(A.KeyInputManager.La(x.a.Xea,A.KeyInputManager.He),aa.a.pla);b.bindAction(A.KeyInputManager.La(x.a.Xea,A.KeyInputManager.He),aa.a.pla);f.bindAction(A.KeyInputManager.La(x.a.Xea,A.KeyInputManager.He),aa.a.pla)}lkc(){return this.o0j||this.Ub.l3d()}Yhj(a,b,c){const f=this.ua.Ca;if(!f||this.Zb.gd(f)||this.Ha.vz&&1!==this.sa.rf().length)return 16;a=f.vj;if(!a)return 8;b=this.Ub.QH();if(!this.Ha.QRa){if(!b)return za.a.J(18462277,822,10,"SlideLayoutActor::HandleChangeLayout fails to get mainMasters"),
8;if(!this.Bhb(b,a))return 8}if(1===c)return 32;if((!this.Ha.QRa||b&&this.Bhb(b,a))&&this.ku.YN.Kb(a)&&this.nbe()){this.wta=0;c=f.Tn;if(!c)return za.a.J(18462275,822,10,"SlideLayoutActor::HandleChangeLayout fails to get contentMasterId"),8;this.lfe.sOd(0,this.Ub.Gv(),b,this.ku.YN,a,Object(C.a)(this,this.tLd,"changeSlideLayout"),this.lkc(),u.AFrameworkApplication.isRtl).phd(c)}else za.a.J(18462273,822,50,"SlideLayoutActor::HandleChangeLayout does not have MainMasterResources ready yet"),this.ku.JMe(a),
this.wta=aa.a.Lpa;return 32}uhg(a,b,c,f,l){b=this.sa.rf();if(!b||!b.length)return 8;f=0;const w=[],F=this.Ub.QH();if(!F)return za.a.J(25786449,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get mainMasters"),8;for(var S of b){if(this.Zb.gd(S)||!S)return 16;f=S.vj;if(!f)return za.a.J(546137667,822,50,"SlideLayoutActor::HandleSlidesChangeLayout MainmasterId is 0"),8;w.push(f);if(!this.Ha.QRa&&!this.Bhb(F,f))return za.a.J(546137668,822,50,"SlideLayoutActor::HandleSlidesChangeLayout fails to validate masters"),
8}if(1===c&&!this.Ha.yWa)return 32;for(const fa of w)if(this.Ha.QRa&&!this.Bhb(F,f)||!this.ku.YN.Kb(fa)){za.a.J(25786453,822,50,"SlideLayoutActor::HandleSlidesChangeLayout does not have MainMasterResources ready yet");this.ku.JMe(f);if(this.Ha.yWa)return this.$2d(a,c,()=>{this.ku.Dzc(EE)},l);this.wta=aa.a.Lpa;return 32}S=this.wta=0;for(const fa of b)if(S=fa.Tn,!S)return za.a.J(25786455,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get contentMasterId"),8;1<b.length?za.a.J(33633477,822,
50,"HandleSlidesChangeLayout: Selected slidenodes: {0}",b.length):za.a.J(33633479,822,50,"HandleSlidesChangeLayout: Selected one slidenode.");1<b.length&&(S=0);if(!this.nbe())return za.a.J(546137669,822,50,"HandleSlidesChangeLayout: Layout masters not ready yet "),qd.a("RaiseFirstMasterRetrievedEvent")?this.$2d(a,c,()=>{this.ku.C2h(EE)},l):8;if(this.Ha.yWa){if(1===c)return 32;if(!l)return 8;this.rNg=S;this.X3g(l,F,f,!0)}else this.lfe.sOd(0,this.Ub.Gv(),F,this.ku.YN,f,Object(C.a)(this,this.tLf,"changeSlidesLayout"),
this.lkc(),u.AFrameworkApplication.isRtl).phd(S);return 32}tLd(a,b){const c=this.ua.Ca;if(c){var f=()=>{this.Ga.Bd();this.sa.Rh()},l=()=>{this.Ga.vf(Ai.a.zB)};a=parseInt(a);b=parseInt(b);if(a!==c.vj||b!==c.Tn){const w=Kc.a.Db;Kc.a.Tkd("ChangeSlideLayout");Kc.a.Db&&(Kc.a.Db.ur=!0,Kc.a.Db.Ya("SlideCount","1"));f=this.Jb.xd(15,void 0,f,l);try{f.lc(c),f.fd=aa.a.Lpa,c.vj=a,c.Tn=b}finally{f&&f.dispose()}this.Zb.xw(c,"ChangeSlideLayout");Kc.a.Db=w}}}tLf(a,b){const c=this.sa.rf();if(c&&c.length){a=parseInt(a);
b=parseInt(b);var f=Kc.a.Db;Kc.a.Tkd("ChangeSlidesLayout");Kc.a.Db.ur=!0;var l=[];for(var w of c)a===w.vj&&b===w.Tn||l.push(w);if(l.length){Kc.a.ik("SlideCount",l.length.toString());w=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()},()=>{this.Ga.vf(Ai.a.zB)});try{w.lc(this.ua.Ca);w.fd=aa.a.Lpa;for(const F of l)F.vj=a,F.Tn=b}finally{w&&w.dispose()}for(const F of c)this.Zb.xw(F,"ChangeSlidesLayout");Kc.a.Db=f}}}gmj(a,b,c,f,l){if(1===c)return 32;if(!l)return 8;try{let w,F;if(!({masterId:w,layoutId:F}=
this.$Qe(l.SourceControlId)).returnValue)return 8;za.a.J(557322908,822,50,"SlideLayoutActor:: React Change Layout Dropdown invoked command to Change Layout.");this.tLf(w,F)}catch(w){return za.a.J(559281303,822,10,"SlideLayoutActor:: react change slide layout failed with Exception {0} ",w),8}return 32}Mgg(a,b,c,f,l){f=this.Wb.Bf;if((b=this.ua.Ca)&&this.Zb.gd(b)||this.Zb.gd(f))return za.a.J(546137670,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutOptions Graph node blocked"),16;f=this.Ub.QH();if(!f||
!f.length)return za.a.J(18462285,822,10,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to get mainMasters"),8;let w=0;if(b){if(w=b.vj,!w)return za.a.J(546137671,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog MainMasterId is 0"),8}else w=f[0].Id;let F=0;({vj:w,Tn:F}=this.bLc(f,b));if(!this.Ha.QRa&&!this.Bhb(f,w))return za.a.J(546137672,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to validate mainMasters"),8;if(1===c){if(!this.Ub.wj())return 8;if(!this.Ha.yWa)return 32}if(this.Ha.QRa&&
!this.Bhb(f,w)||!this.ku.YN.Kb(w)||!this.nbe()){za.a.J(18462283,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog does not have MainMasterResources ready yet");this.ku.JMe(w);if(this.Ha.yWa)return this.$2d(a,c,()=>{this.ku.Dzc(EE)},l);this.wta=aa.a.oGa}else if(this.wta=0,this.Ha.yWa){if(1===c)return 32;if(!l)return 8;this.sNg=F;this.X3g(l,f,w,!1)}else this.lfe.sOd(1,this.Ub.Gv(),f,this.ku.YN,w,Object(C.a)(this,this.wQc,"insertSlideWithLayout"),this.lkc(),u.AFrameworkApplication.isRtl).phd(F);
return 32}X3g(a,b,c,f){a.MenuId&&"style"===a.MenuId||(a.MenuItems=qd.a("ReactSlideLayoutSectionsAPIEnabled")?this.M_d(b,c,f):this.N8i(b,c,f));za.a.J(557322909,822,50,"SlideLayoutActor:: React Slide Layout DropDown Invoked. Type : IsChangeLayout : {0}  ",f)}i0d(){const a=this.Ub.Gv();if(!a||!a.width||!a.height)return za.a.J(557601737,822,15,"SlideLayoutActor:: Slide size is null or 0"),new $q.a(gj.kJf,gj.Vei);const b=gj.kJf;return new $q.a(b,a.height/a.width*b)}p9f(){const a={},b={},c=this.i0d();b.root=
this.wyi(c.width+gj.uJf,c.height+gj.uJf+gj.Nei+gj.afi);b.flexContainer={flexDirection:"column"};b.label={"margin-top":"5px","max-width":"100px","font-size":"10px"};a.galleryButtonInExpanded=b;return a}wyi(a,b){const c={};c.width=a;c.height=b;c.backgroundColor="transparent";return c}N8i(a,b,c){this.$bd();const f=Object.assign(new Kl.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});let l=0,w=!1;const F=a.length;if(!F||1===F&&a&&a[0]&&!a[0].InContent)return f;
for(var S=0;S<F;S++)a[S].Id===b&&(l=S,w=!0);w&&(b=this.Q$f(a[l],b,c,l),Array.add(f.MenuSectionList,b));for(b=0;b<F;b++)w&&b===l||(S=this.Q$f(a[b],a[b].Id,c,b),Array.add(f.MenuSectionList,S));return f}Q$f(a,b,c,f){const l=Object.assign(new nk.a,{ControlList:[],Title:a.Name});if(!(a.InContent&&this.ku.YN&&this.ku.YN.Kb(a.Id)))return l;var w=this.p9f(),F=c?"ChangeLayout":"NewSlide",S=c?"ChangeLayoutControls":"NewSlideLayoutControls";gj.Q3c++;f=qd.a("ReactSlideLayoutUniqueIdFix")?f.toString():b.toString()+
"_"+gj.Q3c.toString();w=Object.assign(new qq.a,{Id:S,ExternalId:F+"_"+f,Type:4,Title:a.Name,GalleryStyle:w,Width:3,GalleryItems:[]});a=a.ContentMasters;if(!a)return l;F=a.length;for(S=0;S<F;S++)f=a[S],!f||!this.lkc()&&this.Ub.W7a(f)||Array.add(w.GalleryItems,this.aKc(f,b,c));Array.add(l.ControlList,w);return l}sli(){try{const a=[],b=this.Rta;for(let c in b)a.push(c);this.Rta={};this.lZc={};appChrome.api.unregisterIcons(a)}catch(a){za.a.J(557601738,822,15,"SlideLayoutActor::Failed to unregister icons for react new slide layout {0}",
a)}}$bd(){this.sli();try{const a=this.Ub.QH();if(a){for(let b=0;b<a.length;b++){const c=a[b];c&&this.ku.YN&&this.ku.YN.count&&this.ku.YN.Kb(c.Id)&&this.addIconToMap(this.ku.YN.ga(c.Id).LayoutIcons,c.Id)}appChrome.api.registerIconProvider(()=>this.Rta)}}catch(a){za.a.J(559281304,822,15,"SlideLayoutActor::Failed to register icons for react new slide layout {0}",a)}}L_b(a,b){a=String.format("{0}_{1}_{2}",gj.jrj,a,b);a in this.lZc||(gj.Q3c++,this.lZc[a]=a+"_"+gj.Q3c.toString());return this.lZc[a]}addIconToMap(a,
b){if(this.ua.Ca&&a)for(let f=0;f<a.length;++f){var c=a[f];if(!c)continue;const l=this.L_b(b,c.LayoutId),w={},F={};c.Icon&&c.Icon.Clip&&c.Icon.Clip.Bounds&&(F.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top),u.AFrameworkApplication.isRtl&&qd.a("ReactSlideLayoutRTLFix")?F.right=String.format("-{0}px",c.Icon.Clip.Bounds.Left):F.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left));F.position="absolute";const S={},fa={},xa=this.i0d();fa.height=xa.height.toString()+"px";fa.width=xa.width.toString()+
"px";fa.position="relative";fa.overflow="hidden";fa.display="inline-block";S.root=fa;w.root=F;this.yzb&&c.Icon&&(c=appChrome.buildLayoutImageIconFromUrlWithStyles(this.yzb.resolve(dg.a.cqb,c.Icon.ImgId),w,S),this.Rta[l]=c)}}M_d(a,b,c){this.$bd();const f=Object.assign(new Kl.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});var l=Object.assign(new nk.a,{Id:c?"ChangeLayoutMenuSection":"NewSlideLayoutMenuSection",ControlsId:c?"ChangeLayoutMenuSection.Controls":
"NewSlideLayoutMenuSection.Controls",ControlList:[]});Array.add(f.MenuSectionList,l);var w=this.p9f();w=Object.assign(new qq.a,{Id:c?"ChangeLayoutControls":"NewSlideLayoutControls",ExternalId:c?"ChangeLayoutSection":"NewSlideSection",ExternalGalleryId:c?"ChangeLayoutGallery":"NewSlideGallery",GalleryStyle:w,Width:3,Type:4,GallerySections:[]});Array.add(l.ControlList,w);l=0;let F=!1;const S=a.length;za.a.J(546137673,822,50,"React Slide layout: Count of main masters :{0}",S);if(!S||1===S&&a&&a[0]&&
!a[0].InContent)return za.a.J(546137674,822,10,"React Slide layout rendered empty as main masters not loaded; Type: IsChangelayout:{0} cMainMasters: {1} InContent: {2} ",c,S,1===S&&!!a&&!!a[0]&&a[0].InContent),f;for(var fa=0;fa<S;fa++)a[fa].Id===b&&(l=fa,F=!0);F&&(b=this.V3g(a[l],b,c),w.GallerySections.push(b));for(b=0;b<S;b++)F&&b===l||(fa=this.V3g(a[b],a[b].Id,c),w.GallerySections.push(fa));return f}V3g(a,b,c){const f=Object.assign(new qN,{SectionId:b.toString(),Title:a.Name,GalleryButtons:[]});
if(!(a.InContent&&this.ku.YN&&this.ku.YN.Kb(a.Id)))return za.a.J(546137675,822,50,"React Slide layout: Gallery section rendered empty as main masters not loaded;Type: IsChangelayout:{0} , mainMaster.InContent: {1} , presentatonresourcemanager contains main master : {2} ",c,a.InContent,!!this.ku.YN&&this.ku.YN.Kb(a.Id)),f;a=a.ContentMasters;if(!a)return za.a.J(546137676,822,50,"React Slide layout: Gallery section rendered empty as content master is null ;Type: IsChangelayout:{0} ",c),f;const l=a.length;
for(let w=0;w<l;w++){const F=a[w];!F||!this.lkc()&&this.Ub.W7a(F)||Array.add(f.GalleryButtons,this.aKc(F,b,c))}return f}IBa(a,b,c){return qd.a(gj.rLf)?(c?"ChangeLayoutButton_":"NewSlideLayoutButton_")+a+"_"+b:a+"_"+b}aKc(a,b,c){const f=a.Id,l=this.IBa(b.toString(),f.toString(),c),w={},F={},S=this.i0d();F.width=S.width.toString()+"px";F.height=S.height.toString()+"px";qd.a("ReactNewSlideLayoutIconBorderFix")||(F.border="#858585 1px solid");w.root=F;return Object.assign(new eE.a,{Id:l,ExternalId:l,
Icon:this.L_b(b,f),Command:c?"3430900587":"1579226270",QueryCommand:qd.a("NewSlideLayoutShowCurrentLayout")?c?"630989293":"2230133927":null,LabelText:a.Name,FullIconStyle:w,Alt:a.Name})}Lgg(a,b,c){if(this.Zb.fN(this.Wb.Bf))return 16;b=this.Ub.QH();if(!b)return 8;let f=null;if(this.Ha.vz){var l=this.sa.rf();1<=l.length&&(l.sort((F,S)=>F.Ge-S.Ge),a!==aa.a.nBb&&(f=l[l.length-1]))}else a!==aa.a.nBb&&(f=this.ua.Ca);if(this.Zb.gd(f))return 16;let w;({vj:l,Tn:w}=this.bLc(b,this.ua.Ca));if(!this.Bhb(b,l))return 8;
if(1===c)return 32;c=this.Gz.eIc(Object(ua.a)(132,f),l,w,a);this.EAf(l,w);c.OV||this.Zb.xw(c,a);return 32}Fkj(a,b,c,f,l){if(this.Zb.fN(this.Wb.Bf))return 16;if(1===c)return 32;if(!l)return 8;c=l.slideId;b=l.x8j;l=l.Pri;f=null;this.Ha.vz?(c=this.sa.rf(),1<=c.length&&(c.sort((w,F)=>w.Ge-F.Ge),f=c[c.length-1])):f=this.Ub.Bk(c);c=this.Gz.eIc(f,b,l,a);this.EAf(b,l);c.OV||this.Zb.xw(c,a);return 32}dispose(){this.ku.pNk(Object(C.a)(this,this.B0g,"openIgnoredDialog"));this.Rta=null}wQc(a,b){const c=this.ua.Ca;
let f=Rd.a.empty;c&&(f=c.Cb);const l=this.Ub.QH();l&&("0"===a||"0"===b?{vj:a,Tn:b}=this.bLc(l,c):(a=parseInt(a),b=parseInt(b)),this.ia.Ma(aa.a.B5c,2,new FE(f,a,b)))}hmj(a,b,c,f,l){if(1===c)return 32;if(!l||!({masterId:c,layoutId:b}=this.$Qe(l.SourceControlId)).returnValue)return 8;f=this.ua.Ca;a=Rd.a.empty;f&&(a=f.Cb);l=this.Ub.QH();if(!l)return 8;"0"===c||"0"===b?{vj:c,Tn:b}=this.bLc(l,f):(c=parseInt(c),b=parseInt(b));za.a.J(557322910,822,50,"SlideLayoutActor:: React New Slide Dropdown invoked command to insert new slide.");
return this.ia.Ma(aa.a.B5c,2,new FE(a,c,b))}bLc(a,b){let c,f;f=c=0;if(!this.YMi(a))return{vj:c,Tn:f};if(b){c=b.vj;if(!c)return{vj:c,Tn:f};if(!this.Ha.R4b||this.uNi(c)){f=b.Tn;if(!f)return{vj:c,Tn:f};if(b.YRa)for(b=0;b<a.length;b++)if(a[b].Id===c&&1<a[b].ContentMasters.length){f=a[b].ContentMasters[1].Id;break}}}else c=a[0].Id,f=this.Ha.R4b?0:a[0].ContentMasters[0].Id;return{vj:c,Tn:f}}M_f(a,b,c){if(1===a)return 32;if(!({layoutId:a}=this.$Qe(b.SourceControlId)).returnValue)return 8;a&&"0"!==a&&(b[cm.a.On]=
a===(c?this.rNg.toString():this.sNg.toString()));return 32}rad(a,b,c,f,l){return this.M_f(c,l,!1)}hAe(a,b,c,f,l){return this.M_f(c,l,!0)}$Qe(a){let b,c;c=b=null;if(!a)return za.a.J(557188739,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};a=a.split("_");const f=qd.a(gj.rLf),l=f?1:0,w=f?2:1;if(!a||a.length!==(f?3:2))return za.a.J(557188740,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,
masterId:b,layoutId:c};b=a[l];c=a[w];return{returnValue:!0,masterId:b,layoutId:c}}YMi(a){if(0===a.length)return!1;for(let b=0;b<a.length;++b)if(0!==a[b].ContentMasters.length)return!0;return!1}B0g(){this.wta&&(za.a.J(18462289,822,50,"SlideLayoutActor::OpenIgnoredDialog is auto-opening dialog {0}",this.wta===aa.a.Lpa?"ChangeLayout":"NewSlide"),this.ia.processAction(this.wta,2));this.wta=0}Bhb(a,b){for(let c=0;c<a.length;c++)if(a[c].Id===b)return!0;return!1}EAf(a,b){Kc.a.ik("MainMasterId",a.toString());
Kc.a.ik("ContentMasterId",b.toString());const c=this.Ub.QH(),f=new Sys.StringBuilder;if(c){for(let l=0;l<c.length;l++)f.appendLine(String.format("MainMasterId={0}, ContentMasterCount={1}; ",c[l].Id,c[l].ContentMasters.length));za.a.J(23134938,813,50,"Insert slide with layout: MainMasterCount={0}. {1}. SelectedMainMasterId={2}, SelectedContentMasterId={3}",c.length,f,a,b)}}nbe(){return this.ku.fGf()}uNi(a){if(0===a)return!1;const b=this.Ub.orb();if(b&&0<b.length)for(const c of b)if(c.idField===a&&
0<c.layoutCountField)return!0;return!1}$2d(a,b,c,f){this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)?1===b?a=32:2===b?(b={},f=!!f&&f.IsShadowMenuOpen,b.payload={["isShadowRendering"]:f},u.AFrameworkApplication.LCb.handleCommand(Le.ActionManager.n2a(a),b),f||c(),a=2):a=8:a=8;return a}static WCj(a){return a===gj.Yei||a===gj.Zei||a===gj.Wei||a===gj.$ei||a===gj.Xei}}gj.Yei=1041;gj.Zei=1042;gj.Wei=2052;gj.$ei=1028;gj.Xei=3076;gj.jrj="LayoutIcon";gj.rLf="ReactSlideLayoutButtonIdChange";
gj.kJf=145;gj.Vei=82;gj.uJf=24;gj.Nei=14;gj.afi=5;gj.Q3c=1;Object(e.a)(gj,"SlideLayoutActor",null,[234,109]);class rN{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.iF=this.E8=this.Fab=this.F8=null;this.ia=a;this.uN=b;this.Ga=c;this.Zb=f;this.Gz=l;this.Wb=w;this.ua=F;this.qc=S;this.Je=fa;this.bfe=xa(500,Object(C.a)(this,this.B9c,"performKeyboardThumbnailReorder"));this.sa=Za;this.Op=pb;this.MEa=Mb}wb(){this.ia.ra(aa.a.Rbc,Db.a.application,Object(C.a)(this,this.ykj,"handleMoveSlide"),4);this.ia.ra(aa.a.GSg,
Db.a.application,Object(C.a)(this,this.zkj,"handleMoveSlideById"),4);this.ia.ra(aa.a.mcb,$b.a.application,Object(C.a)(this,this.sOc,"handleReorderSlide"),4);this.ia.ra(aa.a.jcb,$b.a.application,Object(C.a)(this,this.sOc,"handleReorderSlide"),4);this.ia.ra(aa.a.lcb,$b.a.application,Object(C.a)(this,this.sOc,"handleReorderSlide"),4);this.ia.ra(aa.a.kcb,$b.a.application,Object(C.a)(this,this.sOc,"handleReorderSlide"),4);this.ia.ra(aa.a.Sbc,$b.a.application,Object(C.a)(this,this.nij,"handleCommitPendingMoveSlideData"),
4);this.ia.ra(aa.a.Tbc,$b.a.application,Object(C.a)(this,this.Clj,"handleQueryCommitMoveSlideDataEnabled"),100)}Fe(){const a=this.Ga.Bc(Ai.a.zB);a.bindAction(A.KeyInputManager.La(x.a.C0,A.KeyInputManager.He),aa.a.mcb);a.bindAction(A.KeyInputManager.La(x.a.A0,A.KeyInputManager.He),aa.a.jcb);a.bindAction(A.KeyInputManager.La(x.a.C0,A.KeyInputManager.He|4),aa.a.lcb);a.bindAction(A.KeyInputManager.La(x.a.A0,A.KeyInputManager.He|4),aa.a.kcb)}zkj(a,b,c,f,l){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");
if(!this.MEa&&(this.Op&&1<this.sa.rf().length||this.Zb.lRa()))return 16;if(1===c)return 32;if(!l)return za.a.J(50348433,822,10,"HandleMoveSlideById with no null action data."),8;b=l.qda;c=[];for(var w of b)(b=a.LB(w))?c.push(b):za.a.J(50348435,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",w.sid,w.cid);w=l.Ca?a.LB(l.Ca):null;b=a.LB(l.Lbc);f=null;0<=l.sectionIndex&&(f=a.lcg(l.sectionIndex));return this.Jgg(c,b,w,f,l.a9d)}ykj(a,b,c,f,l){return!this.MEa&&(this.Op&&1<this.sa.rf().length||
this.Zb.lRa())?16:1===c?32:l?this.Jgg(l.qda,l.Lbc,l.Ca,null,l.a9d):8}Jgg(a,b,c,f,l){if(this.MEa)for(var w of a)if(!w||this.Zb.gd(this.qc.Bk(w.Cb)))return 16;w=[];for(var F of a){if(!F)continue;const S=this.qc.Bk(F.Cb);S?w.push(S):za.a.J(591737178,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",F.Cb.sid,F.Cb.cid)}if(F=Kc.a.Db)F.Nj=!0,F.uE||(F.uE=new Date),w&&F.Ya("SlideCount",a.length.toString());F=null;l||(this.MEa?c&&(F=c):a&&0<a.length&&(F=a[0]),F&&!this.Wb.Ca.Cb.equals(F.Cb)&&
(this.Wb.Ca=this.qc.Bk(F.Cb)));a=b?this.qc.Bk(b.Cb):null;this.Gz.JLi(w,a,f);return 32}sOc(a,b,c){if(this.uN.oZ||!this.ua.Ca||this.Zb.gd(this.Wb.Bf)||!this.MEa&&this.Op&&1<this.sa.rf().length)return 16;if(1===c)return 32;if(this.MEa){b=this.sa.rf();if(!b||!b.length)return 16;this.tjl(b,a)}else this.ojl(this.ua.Ca,a);return 32}nij(a,b,c){if(this.Zb.gd(this.Wb.Bf)||!this.OLf())return 16;if(1===c)return 32;this.B9c();return 32}Clj(){return this.F8?32:16}lnb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=
0;b<a.length-1;b++)if(1!==a[b+1].slideIndex-a[b].slideIndex)return!1;return!0}ojl(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.Je.n0;if(!(1>=f)){var l=!1;this.Fab||(this.Fab=a,this.iF=c.slides||[],l=!0);a=-1;for(c=0;c<f;c++)if(this.iF[c]&&this.Fab.Cb.equals(this.iF[c].Cb)){a=c;break}if((b!==aa.a.mcb&&b!==aa.a.lcb||a)&&(b!==aa.a.jcb&&b!==aa.a.kcb||a!==f-1)){switch(b){case aa.a.mcb:b=a-1;break;case aa.a.jcb:b=a+1;break;case aa.a.lcb:b=0;break;case aa.a.kcb:b=
f-1;break;default:return}Array.removeAt(this.iF,a);Array.insert(this.iF,b,this.Fab);for(l=0;l<f;l++)this.iF[l]?this.iF[l].Ge=l:za.a.J(576758465,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",l,f);this.Je.OHa(b);f=new Ax(!0,[this.Fab],0<b?this.iF[b-1]:null);this.lGf(f)}else l&&(this.iF=this.Fab=null)}}tjl(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.Je.n0;if(!(1>=f)&&(a.sort((w,F)=>w.slideIndex-F.slideIndex),
this.lnb(a))){var l=!1;this.E8||(this.E8=a,this.iF=c.slides||[],l=!0);a=this.eNc(this.E8[0],this.iF);c=this.eNc(this.E8[this.E8.length-1],this.iF);if((b!==aa.a.mcb&&b!==aa.a.lcb||a)&&(b!==aa.a.jcb&&b!==aa.a.kcb||c!==f-1)){l=null;switch(b){case aa.a.mcb:l=0<=a-2?this.iF[a-2]:null;b=a-1;break;case aa.a.jcb:b=a+this.E8.length<f?a+this.E8.length:f-1;l=this.iF[b];break;case aa.a.lcb:l=null;b=0;break;case aa.a.kcb:l=this.iF[f-1];b=f-1;break;default:return}for(a=this.E8.length-1;0<=a;a--)this.N5h(this.E8[a],
l);for(a=0;a<f;a++)this.iF[a]?this.iF[a].Ge=a:za.a.J(576758466,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",a,f);this.Je.OHa(b);f=new Ax(!0,this.E8,l);this.lGf(f)}else l&&(this.iF=this.E8=null)}}N5h(a,b){const c=this.eNc(a,this.iF);Array.removeAt(this.iF,c);b=this.eNc(b,this.iF)+1;Array.insert(this.iF,b,a)}eNc(a,b){if(a&&b)for(let c=0;c<b.length;c++)if(a.Cb.equals(b[c].Cb))return c;return-1}V8h(a,b){if(!a||!b)return a!==b?!1:!0;if(a.length!==b.length)return!1;
for(const c of a){a=!1;for(const f of b)if(c&&f&&c.Cb.equals(f.Cb)){a=!0;break}if(!a)return!1}return!0}lGf(a){if(!a)throw Error.argumentNull("moveData");this.MEa?this.V8h(this.E8,a.qda)||this.B9c():this.F8&&this.F8.qda&&a.qda&&this.F8.qda[0]&&a.qda[0]&&!this.F8.qda[0].Cb.equals(a.qda[0].Cb)&&this.B9c();this.F8=a;this.bfe.perform()}B9c(){if(this.OLf()){var a=this.F8;this.E8=this.Fab=this.F8=null;Array.clear(this.iF);this.ia.Ma(aa.a.Rbc,2,a)}}OLf(){const a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");
if(!this.F8)return!1;let b=!0,c=!this.F8.Lbc;for(let f=0;f<this.F8.qda.length;f++)b=!!a.LB(this.F8.qda[f].Cb)&&b;c||(c=!!a.LB(this.F8.Lbc.Cb));return b&&c}}Object(e.a)(rN,"SlideMoveActor",null,[234]);class Qx extends Sw.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(e.a)(Qx,"TableGalleryButtonProps",Sw.a,[]);class sN extends Qx{constructor(){super()}get Type(){return 8}}Object(e.a)(sN,"ChangeColorsGalleryButtonProps",Qx,[]);class tN{constructor(){this.hasMath=
this.fReverseEnabled=this.fReverseChecked=!1;this.SemanticNodes=null;this.SmartArtLayout=0}}Object(e.a)(tN,"SmartArtInfo",null,[]);var Ys=d(487);class Ci{constructor(a,b,c){this.wI=a;this.A3j=b;this.a5j=c}get id(){return this.wI}get parameter(){return this.A3j}get Beh(){return this.a5j}}Object(e.a)(Ci,"SmartArtColorInfo",null,[]);class uN{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb){this.Qp=[];this.ia=a;this.Zb=b;this.ob=c;this.Jb=f;this.Ga=l;this.ua=w;this.Ix=F;this.Ub=S;this.Pb=xa;this.gl=Za;this.Fa=
pb;this.iuk()}wb(){this.ia.ra(aa.a.ZQa,Db.a.view,Object(C.a)(this,this.Wjj,"handleInsertSmartArt"),4);this.ia.ra(aa.a.pcl,Db.a.application,Object(C.a)(this,this.enj,"handleSmartArtToolsTabViewHandler"),4);this.ia.ra(aa.a.wCc,Db.a.application,Object(C.a)(this,this.cij,"handleChangeSmartArtLayout"),4);this.ia.ra(aa.a.huk,Db.a.application,Object(C.a)(this,this.slj,"handlePopulateSmartArtColorStyles"),96);this.ia.ra(aa.a.vUb,Db.a.application,Object(C.a)(this,this.aij,"handleChangeSmartArtColor"),4);this.ia.ra(aa.a.Jii,
Db.a.application,Object(C.a)(this,this.bij,"handleChangeSmartArtColorAnchor"),4);this.ia.ra(aa.a.xCc,Db.a.application,Object(C.a)(this,this.dij,"handleChangeSmartArtStyle"),4);this.ia.ra(aa.a.GHa,Db.a.application,Object(C.a)(this,this.umj,"handleResetSmartArt"),4);this.ia.ra(aa.a.Reh,Db.a.application,Object(C.a)(this,this.ymj,"handleReverseSmartArt"),4);this.ia.ra(aa.a.NAe,Db.a.application,Object(C.a)(this,this.Hlj,"handleQueryReverseSmartArt"),97);this.ia.ra(aa.a.LHi,Db.a.application,Object(C.a)(this,
this.Uij,"handleEditSmartArtText"),4);this.ia.ra(aa.a.nAe,Db.a.application,Object(C.a)(this,this.Dlj,"handleQueryEditSmartArtText"),96)}Fe(){}Wjj(a,b,c,f,l){b=this.ua.Ca;if(!b||this.Zb.gd(b))return 16;if(1===c)return 32;this.h9c(l,a);if(!l)return 8;if((c=b.g2(this.ob.he()))&&this.Zb.gd(c))return 16;if(!this.gl.kI(b,1))return this.gl.fJ(b),16;const w=this.mbj(b,c,l);l=this.Jb.xd(15,void 0,()=>{this.ob.gy();this.ob.Rh();this.Ga.Bd()},()=>{this.ob.selectShape(Object(ua.a)(4,w),!0)});try{l.lc(b),l.fd=
a,c&&b.xT([c]),b.uB(Object(ua.a)(4,w))}finally{l&&l.dispose()}this.Ix.oI=Object(ua.a)(4,w);return 32}enj(){return Object(ua.a)(427,this.oxa())?32:16}cij(a,b,c,f,l){b=this.oxa();if(!b||this.Zb.gd(b))return 16;if(1===c)return 32;c=this.ob.he();for(var w of c){if(w.fg){b=w;break}if(w.get_smartArtModelId()){b=this.Fa.Lr(w);this.ob.I6(w);this.ob.selectShape(b,!1);break}}this.h9c(l,a);w=this.Jb.xd(15,void 0,()=>{this.ob.fj();this.Ga.Bd()});try{w.lc(b),w.fd=a,Object(ua.a)(427,b).ensureModelData().get_elementCollection().documentElement.Tma=
l}finally{w&&w.dispose()}return 32}slj(a,b,c,f,l){if(!this.oxa())return 16;a=this.ob.ny();if(!a)return 16;if(1===c)return 32;if(!l)return 8;l.MenuId&&"color"===l.MenuId?l.PopulationXML=this.zdi(a):l.MenuItems=this.pdi(a);return 32}aij(a,b,c,f,l){b=this.oxa();if(!b||this.Zb.gd(b))return 16;if(1===c)return 32;this.h9c(l,a);c=this.Jb.xd(15,void 0,()=>{this.ob.fj();this.Ga.Bd()});try{c.lc(b),c.fd=a,Object(ua.a)(427,b).ensureModelData().get_elementCollection().documentElement.Cwa=l}finally{c&&c.dispose()}return 32}bij(){return this.oxa()?
32:16}dij(a,b,c,f,l){b=this.oxa();if(!b||this.Zb.gd(b))return 16;if(1===c)return 32;this.h9c(l,a);c=this.Jb.xd(15,void 0,()=>{this.ob.fj();this.Ga.Bd()});try{c.lc(b),c.fd=a,Object(ua.a)(427,b).ensureModelData().get_elementCollection().documentElement.Dwa=l}finally{c&&c.dispose()}return 32}umj(a,b,c){b=Object(ua.a)(427,this.oxa());if(!b||this.Zb.gd(Object(ua.a)(4,b)))return 16;if(1===c)return 32;c=this.Jb.xd(15,void 0,()=>{this.ob.fj();this.Ga.Bd()});try{c.lc(b),c.fd=a,b.GHa=!0}finally{c&&c.dispose()}return 32}ymj(a,
b,c){b=this.oxa();if(!b||!b.I$d||this.Zb.gd(b))return 16;if(1===c)return 32;c=new tN;c.fReverseEnabled=b.I$d;c.fReverseChecked=!b.H$d;const f=this.Jb.xd(15,void 0,()=>{this.ob.fj();this.Ga.Bd()});try{f.lc(b),f.fd=a,Object(ua.a)(427,b).ensureModelData().get_elementCollection().documentElement.smartArtInfo=c}finally{f&&f.dispose()}return 32}Hlj(a,b,c,f,l){a=this.oxa();a=!!a&&a.H$d;if(!Object(Ca.a)(Kh.a,l))return 8;l.Yf(a);return 32}Uij(a,b,c){a=this.oxa();if(!a||this.Zb.gd(a))return 16;if(1===c)return 32;
this.ia.Ma(aa.a.cNa,2,new Jn.a(a,!0,null));return 32}Dlj(a,b,c,f,l){a=this.ob.jD();if(!Object(Ca.a)(Kh.a,l))return 8;l.Yf(a);return 32}mbj(a,b,c){if(!a)return null;const f=a.Mu();let l;l=b?b.fsb(nf.a.p9,nf.a.o9):this.Ub.rra(nf.a.p9,nf.a.o9);return a.iPd(!0,0,b,c,l.x,l.y,nf.a.p9,nf.a.o9,f+1)}oxa(){const a=this.ob.he();for(const b of a){if(b.fg)return b;if(b.get_smartArtModelId())return this.Fa.Lr(b)}return null}iuk(){Array.add(this.Qp,new Ci(0,"accent0_1,mainScheme",ResourceStrings.L_SmartArtDark1Outline));
Array.add(this.Qp,new Ci(1,"accent0_2,mainScheme",ResourceStrings.L_SmartArtDark2Outline));Array.add(this.Qp,new Ci(2,"accent0_3,mainScheme",ResourceStrings.L_SmartArtDark2Fill));Array.add(this.Qp,new Ci(3,"colorful1,colorful",ResourceStrings.L_SmartArtColorful1));Array.add(this.Qp,new Ci(4,"colorful2,colorful",ResourceStrings.L_SmartArtColorful2));Array.add(this.Qp,new Ci(5,"colorful3,colorful",ResourceStrings.L_SmartArtColorful3));Array.add(this.Qp,new Ci(6,"colorful4,colorful",ResourceStrings.L_SmartArtColorful4));
Array.add(this.Qp,new Ci(7,"colorful5,colorful",ResourceStrings.L_SmartArtColorful5));Array.add(this.Qp,new Ci(8,"accent1_1,accent1",ResourceStrings.L_SmartArtColoredOutline1));Array.add(this.Qp,new Ci(9,"accent1_2,accent1",ResourceStrings.L_SmartArtColoredFill1));Array.add(this.Qp,new Ci(10,"accent1_3,accent1",ResourceStrings.L_SmartArtGradientRange1));Array.add(this.Qp,new Ci(11,"accent1_4,accent1",ResourceStrings.L_SmartArtGradientLoop1));Array.add(this.Qp,new Ci(12,"accent1_5,accent1",ResourceStrings.L_SmartArtTransparentGradientRange1));
Array.add(this.Qp,new Ci(13,"accent2_1,accent2",ResourceStrings.L_SmartArtColoredOutline2));Array.add(this.Qp,new Ci(14,"accent2_2,accent2",ResourceStrings.L_SmartArtColoredFill2));Array.add(this.Qp,new Ci(15,"accent2_3,accent2",ResourceStrings.L_SmartArtGradientRange2));Array.add(this.Qp,new Ci(16,"accent2_4,accent2",ResourceStrings.L_SmartArtGradientLoop2));Array.add(this.Qp,new Ci(17,"accent2_5,accent2",ResourceStrings.L_SmartArtTransparentGradientRange2));Array.add(this.Qp,new Ci(18,"accent3_1,accent3",
ResourceStrings.L_SmartArtColoredOutline3));Array.add(this.Qp,new Ci(19,"accent3_2,accent3",ResourceStrings.L_SmartArtColoredFill3));Array.add(this.Qp,new Ci(20,"accent3_3,accent3",ResourceStrings.L_SmartArtGradientRange3));Array.add(this.Qp,new Ci(21,"accent3_4,accent3",ResourceStrings.L_SmartArtGradientLoop3));Array.add(this.Qp,new Ci(22,"accent3_5,accent3",ResourceStrings.L_SmartArtTransparentGradientRange3));Array.add(this.Qp,new Ci(23,"accent4_1,accent4",ResourceStrings.L_SmartArtColoredOutline4));
Array.add(this.Qp,new Ci(24,"accent4_2,accent4",ResourceStrings.L_SmartArtColoredFill4));Array.add(this.Qp,new Ci(25,"accent4_3,accent4",ResourceStrings.L_SmartArtGradientRange4));Array.add(this.Qp,new Ci(26,"accent4_4,accent4",ResourceStrings.L_SmartArtGradientLoop4));Array.add(this.Qp,new Ci(27,"accent4_5,accent4",ResourceStrings.L_SmartArtTransparentGradientRange4));Array.add(this.Qp,new Ci(28,"accent5_1,accent5",ResourceStrings.L_SmartArtColoredOutline5));Array.add(this.Qp,new Ci(29,"accent5_2,accent5",
ResourceStrings.L_SmartArtColoredFill5));Array.add(this.Qp,new Ci(30,"accent5_3,accent5",ResourceStrings.L_SmartArtGradientRange5));Array.add(this.Qp,new Ci(31,"accent5_4,accent5",ResourceStrings.L_SmartArtGradientLoop5));Array.add(this.Qp,new Ci(32,"accent5_5,accent5",ResourceStrings.L_SmartArtTransparentGradientRange5));Array.add(this.Qp,new Ci(33,"accent6_1,accent6",ResourceStrings.L_SmartArtColoredOutline6));Array.add(this.Qp,new Ci(34,"accent6_2,accent6",ResourceStrings.L_SmartArtColoredFill6));
Array.add(this.Qp,new Ci(35,"accent6_3,accent6",ResourceStrings.L_SmartArtGradientRange6));Array.add(this.Qp,new Ci(36,"accent6_4,accent6",ResourceStrings.L_SmartArtGradientLoop6));Array.add(this.Qp,new Ci(37,"accent6_5,accent6",ResourceStrings.L_SmartArtTransparentGradientRange6))}pdi(a){const b=Object.assign(new Kl.a,{Id:"ControlsChangeSmartArtColor",MenuSectionList:[]}),c=Object.assign(new nk.a,{Id:"MenuSectionChangeSmartArtColor",ControlList:[]});Array.add(b.MenuSectionList,c);const f=Mi.Color.Mi(a.Ye.Light1),
l=Mi.Color.Mi(a.Ye.Dark1),w=Mi.Color.Mi(a.Ye.Light2),F=Mi.Color.Mi(a.Ye.Dark2),S=Array(6);S[0]=Mi.Color.Mi(a.Ye.Accent1);S[1]=Mi.Color.Mi(a.Ye.Accent2);S[2]=Mi.Color.Mi(a.Ye.Accent3);S[3]=Mi.Color.Mi(a.Ye.Accent4);S[4]=Mi.Color.Mi(a.Ye.Accent5);S[5]=Mi.Color.Mi(a.Ye.Accent6);a=0;Array.add(c.ControlList,({Y1b:a}=this.idi(a,f,l,w,F)).returnValue);Array.add(c.ControlList,({Y1b:a}=this.eci(a,f,S)).returnValue);Array.addRange(c.ControlList,({Y1b:a}=this.Rbi(a,f,S)).returnValue);return b}idi(a,b,c,f,l){const w=
Object.assign(new qq.a,{Id:"PrimaryThemeColorsGallery",ExternalId:"ChangeSmartArtColorGalleryPrimary",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_PrimaryThemeColors,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(w.GalleryItems,this.kbc(b,c,a++));Array.add(w.GalleryItems,this.kbc(b,l,a++));Array.add(w.GalleryItems,this.kbc(l,f,a++));return{returnValue:w,Y1b:a}}eci(a,b,c){const f=Object.assign(new qq.a,{Id:"ColorfulGallery",ExternalId:"ChangeSmartArtColorGalleryColorful",
ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_Colorful,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(f.GalleryItems,this.t4c(c[1],c[2],c[3],c[4],c[5],c[1],b,a++));for(let l=1;5>l;l++)Array.add(f.GalleryItems,this.Yqe(c[l],c[l+1],b,a++));return{returnValue:f,Y1b:a}}Rbi(a,b,c){const f=[];for(let F=0;6>F;F++){const S=Object.assign(new qq.a,{Id:"ColorfulGallery"+(F+1),ExternalId:"ChangeSmartArtColorGalleryAccent"+(F+1),ExternalGalleryId:"ChangeSmartArtColorGallery",
Title:String.format(ResourceStrings.L_AccentFormat,F+1),Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});var l=new Mi.Color;l.r=l.g=l.b=255;var w=new Mi.Color;l=Mi.Color.EY(c[F],l,.5);w=Mi.Color.EY(c[F],w,.25);Array.add(S.GalleryItems,this.kbc(b,c[F],a++));Array.add(S.GalleryItems,this.kbc(c[F],b,a++));Array.add(S.GalleryItems,this.Yqe(c[F],l,b,a++));Array.add(S.GalleryItems,this.N8j(w,c[F],l,b,a++));Array.add(S.GalleryItems,this.Yqe(c[F],l,b,a++));Array.add(f,S)}return{returnValue:f,
Y1b:a}}kbc(a,b,c){return this.t4c(a,a,a,a,a,a,b,c)}Yqe(a,b,c,f){const l=Ys.a.EY(a,b,2/6),w=Ys.a.EY(a,b,.5),F=Ys.a.EY(a,b,4/6),S=Ys.a.EY(a,b,5/6);return this.t4c(a,l,w,F,S,b,c,f)}N8j(a,b,c,f,l){const w=Mi.Color.EY(b,c,.5);return this.t4c(a,b,w,c,w,b,f,l)}t4c(a,b,c,f,l,w,F,S){S=this.Ycg(S);const fa="ChangeSmartArtColor__"+S.parameter.replace(",","__");return Object.assign(new sN,{Id:fa,ExternalId:fa,MenuItemId:S.parameter,Command:"367274693",QueryCommand:"1384172858",Alt:S.Beh,TableCellStyles:[this.IAb(a,
F),this.IAb(b,F),this.IAb(c,F),this.IAb(f,F),this.IAb(l,F),this.IAb(w,F)]})}IAb(a,b){const c={};c.backgroundColor=this.WNf(a);c.border=String.format("1px solid {0}",this.WNf(b));return c}WNf(a){return String.format("rgb( {0:d},{1:d},{2:d} )",a.r,a.g,a.b)}zdi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="ControlsChangeSmartArtColor">');const c=new Mi.Color;c.r=c.g=c.b=255;const f=new Mi.Color,l=Mi.Color.Mi(a.Ye.Light1);var w=Mi.Color.Mi(a.Ye.Dark1),F=Mi.Color.Mi(a.Ye.Light2),S=Mi.Color.Mi(a.Ye.Dark2);
const fa=Array(6);fa[0]=Mi.Color.Mi(a.Ye.Accent1);fa[1]=Mi.Color.Mi(a.Ye.Accent2);fa[2]=Mi.Color.Mi(a.Ye.Accent3);fa[3]=Mi.Color.Mi(a.Ye.Accent4);fa[4]=Mi.Color.Mi(a.Ye.Accent5);fa[5]=Mi.Color.Mi(a.Ye.Accent6);a=0;b.append(String.format('<MenuSection Id="PrimaryThemeColors" Title="{0}">',ResourceStrings.L_PrimaryThemeColors));b.append('<Gallery Id="PrimaryThemeColorsGallery" ElementDimensions="Size64by48" Width="5">');this.jbc(b,l,w,a++);this.jbc(b,l,S,a++);this.jbc(b,S,F,a++);b.append("</Gallery>");
b.append("</MenuSection>");b.append(String.format('<MenuSection Id="Colorful" Title="{0}">',ResourceStrings.L_Colorful));b.append('<Gallery Id="ColorfulGallery" ElementDimensions="Size64by48" Width="5">');this.q4c(b,fa[1],fa[2],fa[3],fa[4],fa[5],fa[1],l,a++);for(w=1;5>w;w++)this.Uqe(b,fa[w],fa[w+1],l,a++);b.append("</Gallery>");b.append("</MenuSection>");for(w=0;6>w;w++)F=String.format(ResourceStrings.L_AccentFormat,w+1),b.append(String.format('<MenuSection Id="Accent{0}" Title="{1}">',w+1,F)),b.append(String.format('<Gallery Id="ColorfulGallery{0}" ElementDimensions="Size64by48" Width="5">',
w+1)),F=Mi.Color.EY(fa[w],c,.5),S=Mi.Color.EY(fa[w],f,.25),this.jbc(b,l,fa[w],a++),this.jbc(b,fa[w],l,a++),this.Uqe(b,fa[w],F,l,a++),this.G8j(b,S,fa[w],F,l,a++),this.Uqe(b,fa[w],F,l,a++),b.append("</Gallery>"),b.append("</MenuSection>");b.append("</Menu>");return b.toString()}jbc(a,b,c,f){this.q4c(a,b,b,b,b,b,b,c,f)}Uqe(a,b,c,f,l){const w=Ys.a.EY(b,c,2/6),F=Ys.a.EY(b,c,.5),S=Ys.a.EY(b,c,4/6),fa=Ys.a.EY(b,c,5/6);this.q4c(a,b,w,F,S,fa,c,f,l)}G8j(a,b,c,f,l,w){const F=Mi.Color.EY(c,f,.5);this.q4c(a,b,
c,F,f,F,c,l,w)}q4c(a,b,c,f,l,w,F,S,fa){fa=this.Ycg(fa);a.append('<GalleryButton Id="');a.append(fa.parameter);a.append('" Command="');a.append(aa.a.vUb.toString());a.append('" QueryCommand="');a.append(aa.a.VAe.toString());a.append('" InnerHTML="');a.append("&lt;div style=&quot;width:64px;height:48px;position:relative;font-size:1px;&quot;&gt;");this.JAb(a,b,S,8,-1);this.JAb(a,c,S,34,-1);this.JAb(a,f,S,8,16);this.JAb(a,l,S,34,16);this.JAb(a,w,S,8,33);this.JAb(a,F,S,34,33);a.append("&lt;/div&gt;");
a.append('" Alt="');a.append(fa.Beh);a.append('"/>')}h9c(a,b){a.Uri=b===aa.a.vUb?"urn:microsoft.com/office/officeart/2005/8/colors/"+a.Uri:b===aa.a.xCc?"3d8"===a.Uri?"urn:microsoft.com/office/officeart/2009/2/quickstyle/3d8":"urn:microsoft.com/office/officeart/2005/8/quickstyle/"+a.Uri:"timeline"===a.Category?"BasicTimeline"===a.Uri||"HexagonTimeline"===a.Uri||"RoundedRectangleTimeline"===a.Uri||"AccentHomeChevronProcess"===a.Uri?"urn:microsoft.com/office/officeart/2016/7/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2017/3/layout/"+
a.Uri:"urn:microsoft.com/office/officeart/2005/8/layout/"+a.Uri}Ycg(a){let b;for(let c=0;c<this.Qp.length;c++)if(b=this.Qp[c],b.id===a)return b;return new Ci(-1,"","")}JAb(a,b,c,f,l){a.append("&lt;div style=&quot;");b.cUd()||(b=String.format("rgb( {0:d},{1:d},{2:d} )",b.r,b.g,b.b),a.append("background-color:"),a.append(b),a.append(";"));a.append("left:");a.append(f.toString());a.append("px;top:");a.append(l.toString());a.append("px;width:22px;height:14px;position:absolute;");c.cUd()||(c=String.format("rgb( {0:d},{1:d},{2:d} )",
c.r,c.g,c.b),a.append("border:solid 1px "),a.append(c),a.append(";"));a.append("&quot;&gt;&lt;/div&gt;")}}Object(e.a)(uN,"SmartArtActor",null,[234]);class Rx{constructor(a,b,c,f){this.spe="BottomOverlaid";this.ia=a;this.Cc=f;this.qc=b;this.Xc=c;this.tpe="productionSpokenLanguages_"+this.Cc.Uma;this.upe="productionSubtitleLanguages_"+this.Cc.kxa}wb(){za.a.J(38937795,822,50,"SubtitleActor::RegisterActions - OptIn: True, FUseSubtitles:{0}",this.Cc.Ih);this.ia.ra(aa.a.Agc,$b.a.application,Object(C.a)(this,
this.Agc,"querySubtitleIsEnabled"),96);this.ia.ya(aa.a.hIb,$b.a.application,Object(C.a)(this,this.hIb,"toggleUseSubtitles"));this.ia.ra(aa.a.K7g,$b.a.application,Object(C.a)(this,this.XAk,"querySubtitleSettingsIsEnabled"),96);this.ia.ra(aa.a.$9c,$b.a.application,Object(C.a)(this,this.$9c,"populateTranscriptionSubtitleLanguage"),96);this.ia.ra(aa.a.Z9c,$b.a.application,Object(C.a)(this,this.Z9c,"populateTranscriptionSpokenLanguage"),96);this.ia.ya(aa.a.kkl,$b.a.application,Object(C.a)(this,this.Cnj,
"handleToggleTranscriptionSpokenLanguage"));this.ia.ya(aa.a.lkl,$b.a.application,Object(C.a)(this,this.Dnj,"handleToggleTranscriptionSubtitleLanguage"));this.ia.ra(aa.a.lBe,$b.a.application,Object(C.a)(this,this.lBe,"queryToggleTranscriptionSpokenLanguage"),96);this.ia.ra(aa.a.mBe,$b.a.application,Object(C.a)(this,this.mBe,"queryToggleTranscriptionSubtitleLanguage"),96);this.ia.ra(aa.a.Dgc,$b.a.application,Object(C.a)(this,this.Dgc,"querySubtitlesBottomOverlay"),96);this.ia.ya(aa.a.ekd,$b.a.application,
Object(C.a)(this,this.ekd,"toggleSubtitlesBottomOverlay"));this.ia.ra(aa.a.Egc,$b.a.application,Object(C.a)(this,this.Egc,"querySubtitlesTopOverlay"),96);this.ia.ya(aa.a.fkd,$b.a.application,Object(C.a)(this,this.fkd,"toggleSubtitlesTopOverlay"));this.ia.ra(aa.a.Cgc,$b.a.application,Object(C.a)(this,this.Cgc,"querySubtitlesBelowSlide"),96);this.ia.ya(aa.a.dkd,$b.a.application,Object(C.a)(this,this.dkd,"toggleSubtitlesBelowSlide"));this.ia.ra(aa.a.Bgc,$b.a.application,Object(C.a)(this,this.Bgc,"querySubtitlesAboveSlide"),
96);this.ia.ya(aa.a.ckd,$b.a.application,Object(C.a)(this,this.ckd,"toggleSubtitlesAboveSlide"))}Fe(){}Agc(a,b,c,f,l){if(!l||!Object(Ca.a)(Kh.a,l))return 8;l.Yf(this.Cc.Ih);return 32}XAk(a,b,c,f,l){return 1===c?this.qc.wj()?32:8:l&&"object"===typeof l?this.Cc&&this.Cc.AYb?32:(za.a.J(40407312,822,10,"QuerySubtitleSettingsIsEnabled requires valid subtitleContext"),8):(za.a.J(40407310,822,10,"QuerySubtitleSettingsIsEnabled requires actionData"),8)}Dgc(a,b,c,f,l){if(!l||!Object(Ca.a)(Kh.a,l))return za.a.J(40158160,
822,10,"SubtitleActor::QuerySubtitlesBottomOverlay requires actionData"),8;l.Yf("BottomOverlay"===this.Cc.tv);za.a.J(40158162,822,50,"SubtitleActor::QuerySubtitlesBottomOverlay: subtitles position is {0}",this.Cc.tv);return 32}Egc(a,b,c,f,l){if(!l||!Object(Ca.a)(Kh.a,l))return 8;l.Yf("TopOverlay"===this.Cc.tv);za.a.J(40158165,822,50,"SubtitleActor::QuerySubtitlesTopOverlay: subtitles position is {0}",this.Cc.tv);return 32}Cgc(a,b,c,f,l){try{l&&l.Yf("BelowSlide"===this.Cc.tv)}catch(w){za.a.J(41714628,
822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",w)}return 32}Bgc(a,b,c,f,l){try{l&&l.Yf("AboveSlide"===this.Cc.tv)}catch(w){za.a.J(41714630,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",w)}return 32}hIb(a,b,c,f,l){if(1===c)return this.qc.wj()?32:8;if(!l||"object"!==typeof l)return 8;this.Cc.Ih&&(Di.a.LL("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Di.a.qL)||za.a.J(591276032,822,10,"SubtitleActor::ToggleUseSubtitles - Failed to set cookie for discoverability opt out to true"));this.Cc.Ih=
!this.Cc.Ih;za.a.J(38937799,822,50,"SubtitleActor::HandleToggleUseSubtitles: Changed UseSubtitles status to:{0}",this.Cc.Ih);gb.App.Fb.GF({AlwaysUseSubtitles:"SplitButtonModel",UseSubtitles:"CheckboxModel"});return 32}$9c(a,b,c,f,l){try{if(1===c)return 32;if(!l)return za.a.J(40155341,822,10,"PopulateTranscriptionSubtitleLanguage requires actionData"),8;this.W3g(l,!1)}catch(w){za.a.J(40155345,822,10,"Exception in PopulateTranscriptionSubtitleLanguage: {0}.",w)}return 32}Z9c(a,b,c,f,l){try{if(1===c)return 32;
if(!l)return za.a.J(40155347,822,10,"PopulateTranscriptionSpokenLanguage requires actionData"),8;this.W3g(l,!0)}catch(w){za.a.J(40155353,822,10,"Exception in PopulateTranscriptionSpokenLanguage: {0}.",w)}return 32}Dnj(a,b,c,f,l){try{if(l){this.Cc.kxa=l.MenuItemId;this.Cc.ehb=this.Cc.GNc();const w=l.SourceControlId;this.upe!==w&&(a={},a[w]="ToggleButtonModel",a[this.upe]="ToggleButtonModel",gb.App.Fb.GF(a),this.upe=w)}}catch(w){za.a.J(40155355,822,10,"Exception in HandleToggleTranscriptionSubtitleLanguage: {0}.",
w)}return 32}mBe(a,b,c,f,l){try{l&&(l[Uh.a.On]=l.MenuItemId.toLowerCase()===this.Cc.kxa.toLowerCase())}catch(w){za.a.J(40155357,822,10,"Exception in QueryToggleTranscriptionSubtitleLanguage: {0}.",w)}return 32}Cnj(a,b,c,f,l){try{if(l){this.Cc.Uma=l.MenuItemId;const w=l.SourceControlId;this.tpe!==w&&(a={},a[w]="ToggleButtonModel",a[this.tpe]="ToggleButtonModel",gb.App.Fb.GF(a),this.tpe=w)}}catch(w){za.a.J(40155359,822,10,"Exception in HandleToggleTranscriptionSpokenLanguage: {0}.",w)}return 32}lBe(a,
b,c,f,l){try{l&&(l[Uh.a.On]=l.MenuItemId.toLowerCase()===this.Cc.Uma.toLowerCase())}catch(w){za.a.J(40155361,822,10,"Exception in QueryToggleTranscriptionSpokenLanguage: {0}.",w)}return 32}ekd(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return za.a.J(40158178,822,10,"SubtitleActor::ToggleSubtitlesBottomOverlay requires actionData"),8;l[Uh.a.On]&&(this.Cc.tv="BottomOverlay",za.a.J(40158208,822,50,"SubtitleActor::ToggleSubtitlesBottomOverlay: Bottom overlay is enabled"));this.Pld(l.SourceControlId);
return 32}fkd(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return za.a.J(41714646,822,10,"SubtitleActor::ToggleSubtitlesTopOverlay requires actionData"),8;l[Uh.a.On]&&(this.Cc.tv="TopOverlay",za.a.J(40158211,822,50,"SubtitleActor::ToggleSubtitlesTopOverlay: Top overlay is enabled"));this.Pld(l.SourceControlId);return 32}dkd(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return za.a.J(41714649,822,10,"SubtitleActor::ToggleSubtitlesBelowSlide requires actionData"),8;l[Uh.a.On]&&
(this.Cc.tv="BelowSlide",za.a.J(41714651,822,50,"SubtitleActor::ToggleSubtitlesBelowSlide: Below Slide is enabled"));this.Pld(l.SourceControlId);return 32}ckd(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return za.a.J(41714653,822,10,"SubtitleActor::ToggleSubtitlesAboveSlide requires actionData"),8;l[Uh.a.On]&&(this.Cc.tv="AboveSlide",za.a.J(41714655,822,50,"SubtitleActor::ToggleSubtitlesAboveSlide: Above Slide is enabled"));this.Pld(l.SourceControlId);return 32}W3g(a,b){a.MenuItems=Object.assign(new Kl.a,
{Id:b?"SpokenLanguageList":"SubtitleLanguageList",MenuSectionList:[],UpdateDynamically:!0});b?((b=this.Cc.ANe)&&0<b.count&&(b=Rx.wSf(b,"productionSpokenLanguages",""),Array.add(a.MenuItems.MenuSectionList,b)),(b=this.Cc.zNe)&&0<b.count&&(b=Rx.wSf(b,"previewSpokenLanguages",ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle),Array.add(a.MenuItems.MenuSectionList,b))):(b=this.Cc.wHb)&&0<va.a.count(b)&&(b=Rx.xzi(this.Cc.qMe),Array.add(a.MenuItems.MenuSectionList,b));a.PopulationXML=$i.l(a.MenuItems)}Pld(a){if(this.spe!==
a){const b={};b[a]="ToggleButtonModel";b[this.spe]="ToggleButtonModel";gb.App.Fb.GF(b);this.spe=a;this.Xc.ND(new Xp.a(1))}}static wSf(a,b,c){c=Object.assign(new nk.a,{DisplayMode:"Menu",Title:c,Id:b,ControlsId:"ctr"+b,ControlList:[]});for(let f of a)try{const l=f.toLowerCase(),w=Object.assign(new Oy.a,{Id:b+"_"+l,ExternalId:b+"_"+l,LabelText:qa.a.re(f).displayName,Command:"892576938",MenuItemId:l,QueryCommand:"1887433262",Visible:!0,AriaLabel:re.a.onb});Array.add(c.ControlList,w)}catch(l){za.a.J(40171739,
822,10,"SubtitleActor::CreateSpokenLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",f,l)}return c}static xzi(a){const b=Object.assign(new nk.a,{DisplayMode:"Menu",Title:"",Id:"productionSubtitleLanguages",ControlsId:"ctrproductionSubtitleLanguages",ControlList:[]});for(let c of a)try{const f=Object.assign(new Oy.a,{Id:"productionSubtitleLanguages_"+c,ExternalId:"productionSubtitleLanguages_"+c,LabelText:qa.a.re(c).displayName,Command:"2717950896",MenuItemId:c,QueryCommand:"4282741576",
Visible:!0,AriaLabel:re.a.onb});Array.add(b.ControlList,f)}catch(f){za.a.J(40171741,822,10,"SubtitleActor::CreateSubtitleLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",c,f)}return b}}Object(e.a)(Rx,"SubtitleActor",null,[234]);var SQ=d(394);class po{constructor(a){this.ix=this.ls=this.wu=this.tJ=this.wH=null;this.pY=a}get sTb(){return this.tJ||(this.tJ=lb.a.instance.qb("Box4.IAutoCorrectRules"))}get Caa(){return this.wu||(this.wu=lb.a.instance.qb("Box4.IAutoCorrectScheduler"))}get OI(){return this.wH||
(this.wH=lb.a.instance.qb("Box4.Pages.IPageContentEditor"))}get $A(){return this.ix||(this.ix=lb.a.instance.qb("Box4.IOutlineEditor"))}get ln(){return this.ls||(this.ls=this.pY())}Lvb(a,b,c){if(this.$A&&po.fh){var f=xi.ContextSetEditor.mZd(b);a=f.node;Cb.SelectionEditor.Bl(f)&&(f=Fc.a.Wj(a,db.ParagraphReader.textLength(a)));var l=Ab.a.language(Ab.a.xs(f));f=mb.GraphIterator.nb(c.ug);po.Gl.JHa(f);var w=a=null;if(f)for(let F=f.yb(1);F&&!w;F=f.xj(1))Vi.OutlineReader.KV(F)&&(w=F);if(f&&!w){if(!this.OI||
!this.$A)return;a=new Oe.GraphTransaction(7);a.Ry(f);w=this.OI.cWb(f);this.$A.Nfd(w,c.J0b());this.$A.zY(f,!0);l&&(lc.OutlineElementNavigator.ti(f),f=Fc.a.Wj(f.currentNode,0),po.fh.AXa(Ab.a.xs(f),l))}l=fd.SelectionFactory.oj(w,!0);c.Eb.setSelection(l);Cb.SelectionEditor.Mg(b)&&(c=mb.GraphIterator.nb(b.node),c.uv(),vg.OutlineNavigator.Bdd(c),this.sTb&&this.Caa&&Vi.OutlineReader.PB(c,b,!0)&&(b=this.sTb.XUd(b,-1,!1,x.a.tq))&&this.Caa.Vgh(b));this.ln&&this.ln.Mv();a&&a.dispose()}}pTd(a,b,c){a=mb.GraphIterator.nb(c.ug);
a=SQ.a(a);a=fd.SelectionFactory.oj(a,!1);c.Eb.setSelection(a)}static get fh(){return po.If||(po.If=lb.a.instance.qb("Box4.IFormattingEditor"))}static get instance(){return po.Ka||(po.Ka=po.IB())}static IB(){return new po(()=>lb.a.instance.qb("Box4.IUndoManager"))}static get Gl(){return ry.PageNavigator.instance}}po.Ka=null;po.If=null;Object(e.a)(po,"TitleViewEditor",null,[]);class ju{constructor(a,b,c,f=null,l=null,w,F,S=null,fa=null){this.ls=null;this.fyf=!1;this.pY=a;this.QCd=b;this.jm=c;this.tJ=
f;this.wu=l;this.$c=S;this.kk=fa}get ln(){return this.ls||(this.ls=this.pY())}wb(){const a=u.AFrameworkApplication.Va,b=Object(C.a)(this,this.xgl,"tabView");a.ra(D.a.tab,Db.a.view,b,1124);a.ra(D.a.Wjc,Db.a.view,b,1124);a.ya(D.a.Jlg,Db.a.view,Le.ActionManager.Dg)}xgl(a,b,c,f,l){if(1===c)return 32;const w=a===D.a.Wjc;if(!b.view.Jh)return 2;const F=b.view,S=F.Eb;var fa=S.Dj;if(!fa||I.a.instance.ga(14)&&ju.Vi.R3a(fa))return 2;if(this.jm&&this.jm.instance&&this.jm.instance.EV(fa))return 4;var xa=null,
Za=Le.ActionManager.e4,pb=!1,Mb=Cb.SelectionEditor.Mg(fa);if(fa.Cw){if(S.Pa.uG&&(Za=fa.getContext(0),xa=new mb.GraphIterator,xa.set(Za.node),xa.uv(),Za=w?D.a.MGe:D.a.Aed),Za=this.QCd.Pxk(Za,w?D.a.Qy:D.a.BE),Za===Le.ActionManager.e4){var hc=ju.Ml.w1(fa,16);if(hc)w&&(Za=D.a.v5c),xa=new mb.GraphIterator,xa.set(hc.node),xa.af();else{if(I.a.instance.ga(77))return 2;if(ju.fCj(fa)){if(w)return 2;Za=D.a.Lvb}else Za=w?D.a.Qy:D.a.BE}}}else if(fa.Ok)xa=new mb.GraphIterator,xa.set(fa.node),Cb.SelectionEditor.Rs(xa),
Vi.OutlineReader.Via(fa)?Za=w?D.a.MGe:D.a.Aed:(Za=w?this.QCd.Qgj(xa,fa,Za):this.QCd.Pgj(xa,fa,Za),Md.OutlineElementReader.Tg(xa)&&fa.contextId===Db.a.Ff&&(pb=Md.OutlineElementReader.PB(xa,fa,!1)),hc=yc.ListReader.$j(xa)&&pb,Za!==Le.ActionManager.e4||Ce.isTableCellOrInside(xa)||hc||(this.fyf||(Z.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.fyf=!0),u.AFrameworkApplication.Va.processAction(D.a.Jlg,2),u.AFrameworkApplication.oN("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),
this.$c&&this.$c.isFeatureEnabled(84)&&this.$c.isFeatureEnabled(83)));else return 2;if(!w&&Za===Le.ActionManager.e4&&Ce.isTableCellOrInside(xa))if(Fd.returnToCell(xa),Ce.isLastCellInTable(xa)||Cd.TableReader.oub(xa)&&Ce.isLastCellInTableIgnoringGhostCells(xa)){if(Za=this.$Ed(xa,fa),!Za)return 2}else Za=D.a.kTg;if(Za===Le.ActionManager.e4)return 2;switch(Za){case D.a.Lvb:po.instance.Lvb(a,fa,b.view);fa=32;break;case D.a.pTd:po.instance.pTd(a,fa,b.view);fa=32;break;case D.a.kTg:case D.a.v5c:pb=Za===
D.a.v5c;Mb&&this.tJ&&this.wu&&(Mb=this.tJ.XUd(fa,-1,!0,x.a.tq))&&this.wu.Vgh(Mb);fa=32;Fd.returnToCell(xa);Fd.moveToNextOrPreviousCell(xa,pb)&&(Mb=!0,pb=!1,Vi.OutlineReader.HOc(xa)||(vg.OutlineNavigator.kse(xa,!1),lc.OutlineElementNavigator.ti(xa),db.ParagraphReader.Ir(xa.currentNode)&&(Mb=!1,db.ParagraphReader.textLength(xa.currentNode)||(pb=!0)),pb||Fd.returnToCell(xa)),pb?xa=fd.SelectionFactory.Lg(xa.currentNode,0):(xa=fd.SelectionFactory.$k(xa.currentNode),!Mb&&Cb.SelectionEditor.Bl(xa.We)&&(Mb=
xa.toArray(),Array.removeAt(Mb,Mb.length-1),xa=new nb.Selection(Mb,xa.uf))),S.setSelection(xa));break;case D.a.MGe:case D.a.Aed:Za===D.a.Aed?vg.OutlineNavigator.OSg(xa,!1):vg.OutlineNavigator.OSg(xa,!0);S.setSelection(fd.SelectionFactory.$k(xa.currentNode));fa=32;break;case D.a.dYa:fa=u.AFrameworkApplication.Va.li(b,Za,c,!0,f,l);1===gb.App.mode&&Fd.moveToNextOrPreviousCell(xa,!1)&&(Fd.returnToCell(xa),xa=fd.SelectionFactory.oj(xa.currentNode,!0),Cb.SelectionEditor.Bl(xa.We)&&(Mb=xa.toArray(),Array.removeAt(Mb,
Mb.length-1),xa=new nb.Selection(Mb,xa.uf)),S.setSelection(xa));break;default:if(fa=u.AFrameworkApplication.Va.li(b,Za,c,!0,f,l),!pb&&Mb&&(Za===D.a.Qy||Za===D.a.BE)){const kc=Cb.SelectionEditor.Qga(S.Pa.kb).y;gb.App.GHk(()=>{this.lbk(S,F,kc)})}}32===fa&&b.view.Jh&&this.ln.Mv();return fa}lbk(a,b,c){if(a&&b){var f=a.Pa.kb;Cb.SelectionEditor.Qga(f).y<c?(b=Cb.SelectionEditor.OYb(b,f,!1),b=Cb.SelectionEditor.Oqa(b,!1,!1,!1,!0)):b=Cb.SelectionEditor.YIc(b,f,!1);a.setSelection(b)}}$Ed(){return D.a.LCa}BSg(a,
b,c){if(a&&b){var f=a.Pa.kb;Cb.SelectionEditor.Qga(f).y<c?(b=Cb.SelectionEditor.OYb(b,f,!1),b=Cb.SelectionEditor.Oqa(b,!1,!1,!1,!0)):b=Cb.SelectionEditor.Oqa(f,!1,!1,!1,!0);a.setSelection(b)}}static get Vi(){return Rf.a.instance}static get Ml(){return xi.ContextSetEditor.instance}static fCj(a){a=ju.Ml.w1(a,10);return!!a&&lg.a(a)}}Object(e.a)(ju,"TabActor",null,[]);class vN extends ju{constructor(a,b,c,f){super(a,b,c);this.la=f}$Ed(a,b){return this.la.mvb?super.$Ed(a,b):0}}Object(e.a)(vN,"Box4TabActor",
ju,[]);class wN{constructor(a,b,c,f){this.H6j=new vN(a,b,c,f)}wb(){this.H6j.wb()}Fe(){}}Object(e.a)(wN,"TabActor",null,[234]);class xN{constructor(a,b,c){this.SGg=b;this.sa=a;this.dEa=c}Pxk(a,b){const c=this.sa.Dj;return c&&this.dEa.w1(c,16)?a:this.aKe(b)?b:G.a.ze}Qgj(a,b,c){(c=Object(ua.a)(5,b.node))&&c.Nr()?c=D.a.v5c:(lc.OutlineElementNavigator.Ke(a),c=(Cb.SelectionEditor.Oj(b)||Cb.SelectionEditor.Mg(b)&&Md.OutlineElementReader.PB(a,b,!1))&&this.SGg.kob(a)&&this.aKe(D.a.Qy)?D.a.Qy:G.a.ze,za.a.J(8955994,
820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanPromote actionToTake={0}",c===D.a.Qy?"Promote":"DoNothing"));return c}Pgj(a,b,c){const f=Object(ua.a)(5,a.Gp);if(f&&f.Nr())return c;lc.OutlineElementNavigator.Ke(a);c=(Cb.SelectionEditor.Oj(b)||Cb.SelectionEditor.Mg(b)&&Md.OutlineElementReader.PB(a,b,!1))&&this.SGg.$Bc(a)&&this.aKe(D.a.BE)?D.a.BE:G.a.ze;za.a.J(8955996,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanDemote actionToTake={0}",c===D.a.Qy?"Demote":"DoNothing");return c}aKe(a){var b=
this.sa.Pa.kb;let c=!1;if(b)for(let f of b)if(f&&f.node)if(db.ParagraphReader.FV(f.node)){if(b=f.node.ta(Sb.a.listLevel,0),a===D.a.BE&&b>=Uo.a.s6-1||a===D.a.Qy&&!b||this.sa.FK()&&Uo.a.ssg(f.node)){c=!0;break}}else{c=!0;break}return!c}}Object(e.a)(xN,"TabActorPromoteDemoteStrategy",null,[426]);var yN=d(384),TQ=d(835),zN=d(933);class Cv extends Th.a{constructor(a,b,c,f,l,w,F,S,fa){super(void 0,void 0,!0);this.cta=null;this.uYj=b;this.bKg=f;this.$Jg=l;this.XJg=w;this.RJg=F;this.zDg=S;this.yDg=fa;this.yua=
a;this.D9a=c}hhd(){this.kg=this.uYj;const a={};a.bodyControls=this.lXd();this.qj(this.yua,Object(C.a)(this,this.cRd,"dialogResultHandler"),a)}cRd(a,b){1===a&&this.D9a(parseInt(this.dQa(b)),parseInt(this.pYi(b)));this.dispose()}lXd(){this.cta=Cv.hYd();const a={};this.qqi(a);this.tpi(a);return a}qqi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.bKg,this.XJg),c=[zN.a("None",0,this.bKg,this.XJg,1)];a.rowsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogRowSpinner",
["label"]:ResourceStrings.l_InsertTableDialogRowLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.zDg,["validUnits"]:c,["numberFormatInfo"]:this.cta,["validReservedValues"]:[""]}}tpi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.$Jg,this.RJg),c=[zN.a("None",0,this.$Jg,this.RJg,1)];a.columnsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogColumnSpinner",["label"]:ResourceStrings.l_InsertTableDialogColumnLabelText,["customTooltip"]:b,
["unitType"]:"None",["value"]:this.yDg,["validUnits"]:c,["numberFormatInfo"]:this.cta,["validReservedValues"]:[""]}}dQa(a){return a.rows&&""!==a.rows.toString()?a.rows.toString():this.zDg.toString()}pYi(a){return a.columns&&""!==a.columns.toString()?a.columns.toString():this.yDg.toString()}static hYd(){return{["negativeSign"]:"-",["numberDecimalDigits"]:0,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}}Object(e.a)(Cv,"AReactTableSizeDialog",
Th.a,[]);class AN extends Cv{constructor(a){super(ResourceStrings.L_InsertTableDialogTitleText,"InsertTableDialog",a,1,1,35,35,2,5)}}Object(e.a)(AN,"ReactInsertTableDialog",Cv,[]);class BN extends Cv{constructor(a,b,c){super(ResourceStrings.L_SplitTableCells,"SplitTableCellsDialog",a,1,1,b,c,1,Math.min(2,c))}}Object(e.a)(BN,"ReactSplitTableCellsDialog",Cv,[]);var Dv=d(608),CN=d(928);class ku{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig){this.ESa={};this.m9b=
!1;this.j1c=null;this.lz=[0,.25,.5,.75,1,1.5,2.25,3,4.5,6];this.WE=new wa.ScriptSharpLegacyMap;this.Wb=hc;this.ua=kc;this.Ib=b;this.ia=a;this.Df=c;this.sa=Ec;this.Ga=f;this.Jz=l;this.Fa=w;this.Xr=Za;this.rm=xa;this.Ha=pb;this.Jb=Mb;this.lF=fa;this.uua=S;this.wc=F;this.gl=Hc;this.eAb=Dc;this.OOg=Td;this.uca=we;this.Pb=Pd;this.MDa=He;this.Ix=Pe;this.JW=Df;this.QHg=ig;this.QG=1;this.Rw=If.Box4ColorHelper.q0({Color:"##T,1,0,0"});this.BD=Tg;this.Rz=Ig}wb(){this.ESa["465284484"]=0;this.ESa["212166888"]=
1;this.ESa["530759702"]=2;this.ESa["1915511548"]=0;this.ESa["2003354004"]=1;this.ESa["2257534378"]=2;wc.d0d=Object(C.a)(this,this.c0d,"getRowOrColumnsForDelete");wc.S_d=Object(C.a)(this,this.b9i,"getRefRowWhenInsertRow");wc.P_d=Object(C.a)(this,this.W8i,"getRefCellWhenInsertColumn");wc.Q_d=Object(C.a)(this,this.Y8i,"getRefColumnFromRefCell");wc.R_d=Object(C.a)(this,this.$8i,"getRefColumnsWhenSelectColumn");wc.T_d=Object(C.a)(this,this.d9i,"getRefRowsWhenSelectRow");wc.c2d=Object(C.a)(this,this.Hgj,
"gotoFocusCellAfterInsertColumn");wc.esb=Object(C.a)(this,this.gag,"getNewOutlineElementInfoFromCell");wc.Xub=a=>this.Ha.Uu||!Cd.TableReader.oub(a);this.ia.ra(aa.a.WCb,$b.a.application,Object(C.a)(this,this.Iij,"handleDeleteTable"),4);this.ia.ra(aa.a.g$c,Db.a.view,Object(C.a)(this,this.Kij,"handleDeleteTableRow"),4);this.ia.ra(aa.a.rye,Db.a.view,Object(C.a)(this,this.Jij,"handleDeleteTableColumn"),4);this.ia.ra(aa.a.yye,$b.a.application,Object(C.a)(this,this.Lmj,"handleSelectTable"),4);this.ia.ra(aa.a.h$c,
$b.a.application,Object(C.a)(this,this.Xjj,"handleInsertTable"),4);this.ia.ra(aa.a.uye,$b.a.application,Object(C.a)(this,this.Yjj,"handleInsertTableDialog"),4);this.ia.ra(aa.a.r4g,$b.a.application,Object(C.a)(this,this.Zjj,"handleInsertTableFromRibbon"),4);this.ia.ra(aa.a.svk,$b.a.application,Br.a.oG,4);this.ia.ra(aa.a.tvk,$b.a.application,Br.a.oG,4);this.ia.ra(aa.a.AAk,$b.a.application,Br.a.J_,96);this.ia.ra(aa.a.BAk,$b.a.application,Br.a.J_,96);this.ia.ra(aa.a.x7g,Db.a.view,Object(C.a)(this,this.dBe,
"queryTableCellAnchoring"),96);this.ia.ra(aa.a.w7g,Db.a.view,Object(C.a)(this,this.dBe,"queryTableCellAnchoring"),96);this.ia.ra(aa.a.v7g,Db.a.view,Object(C.a)(this,this.dBe,"queryTableCellAnchoring"),96);this.ia.ya(aa.a.ifc,Db.a.view,wc.Pha);this.ia.ya(aa.a.hfc,Db.a.view,wc.Pha);this.ia.ya(aa.a.gfc,Db.a.view,wc.Pha);this.ia.ya(aa.a.ifc,Db.a.tableCell,Object(C.a)(this,this.Y2d,"handleTableCellAnchoring"));this.ia.ya(aa.a.hfc,Db.a.tableCell,Object(C.a)(this,this.Y2d,"handleTableCellAnchoring"));this.ia.ya(aa.a.gfc,
Db.a.tableCell,Object(C.a)(this,this.Y2d,"handleTableCellAnchoring"));this.ia.$d(aa.a.ifc,4);this.ia.$d(aa.a.hfc,4);this.ia.$d(aa.a.gfc,4);this.ia.ya(aa.a.n4g,Db.a.view,Object(C.a)(this,this.Vhj,"handleCellShadingMenuOpen"));this.ia.ra(aa.a.mvk,Db.a.view,Object(C.a)(this,this.hlj,"handlePopulateCellShadingColor"),96);this.ia.ya(aa.a.yva,Db.a.view,wc.Pha);this.ia.ya(aa.a.yva,Db.a.tableCell,Object(C.a)(this,this.Thj,"handleCellShadingColor"));this.ia.ya(aa.a.lvk,Db.a.view,Object(C.a)(this,this.nkj,
"handleMoreCellShadingColor"));this.ia.ya(aa.a.pye,Db.a.view,wc.Pha);this.ia.ya(aa.a.pye,Db.a.tableCell,Object(C.a)(this,this.Uhj,"handleCellShadingCustomColor"));this.ia.ya(aa.a.fWa,Db.a.view,wc.Pha);this.ia.ya(aa.a.fWa,Db.a.tableCell,Object(C.a)(this,this.kmj,"handleRemoveCellShading"));this.ia.$d(aa.a.yva,4);this.ia.$d(aa.a.fWa,4);this.ia.ra(aa.a.nad,Db.a.application,Object(C.a)(this,this.nad,"queryLockAspectRatio"),96);this.ia.ra(aa.a.Jfd,Db.a.application,Object(C.a)(this,this.Jfd,"setLockAspectRatio"),
4);this.ia.ra(aa.a.Lgc,Db.a.view,Object(C.a)(this,this.Lgc,"queryTableRowHeight"),96);this.ia.ra(aa.a.Kgc,Db.a.view,Object(C.a)(this,this.Kgc,"queryTableColumnWidth"),96);this.ia.ra(aa.a.yfb,Db.a.view,Object(C.a)(this,this.yfb,"setTableRowHeight"),4);this.ia.ra(aa.a.IXa,Db.a.view,Object(C.a)(this,this.IXa,"setTableColumnWidth"),4);this.ia.ra(aa.a.Mhd,Db.a.view,Object(C.a)(this,this.yfb,"setTableRowHeight"),4);this.ia.ra(aa.a.Lhd,Db.a.view,Object(C.a)(this,this.IXa,"setTableColumnWidth"),4);this.ia.ra(aa.a.seh,
$b.a.application,Object(C.a)(this,this.vmj,"handleResizeFallbackTable"),4);this.ia.ra(aa.a.ebd,Db.a.view,Object(C.a)(this,this.i8g,"queryTableSize"),96);this.ia.ra(aa.a.iBe,Db.a.view,Object(C.a)(this,this.i8g,"queryTableSize"),96);this.ia.ra(aa.a.mwa,Db.a.view,Object(C.a)(this,this.hlh,"setTableSize"),4);this.ia.ra(aa.a.JXa,Db.a.view,Object(C.a)(this,this.hlh,"setTableSize"),4);this.ia.ra(aa.a.mergeTableCells,Db.a.view,Object(C.a)(this,this.lkj,"handleMergeTableCells"),4);this.ia.ra(aa.a.splitTableCells,
Db.a.view,Object(C.a)(this,this.knj,"handleSplitTableCells"),4);this.ia.ra(aa.a.UFi,Db.a.view,Object(C.a)(this,this.kgg,"handleDistributeRows"),4);this.ia.ra(aa.a.TFi,Db.a.view,Object(C.a)(this,this.Mij,"handleDistributeColumns"),4);this.ia.ra(aa.a.jhl,Db.a.view,Object(C.a)(this,this.kgg,"handleDistributeRows"),4);this.ia.ra(aa.a.ttk,Db.a.view,Object(C.a)(this,this.glj,"handlePopulateCellBorderColorMenu"),96);this.ia.ra(aa.a.Luk,Db.a.view,Object(C.a)(this,this.Shj,"handleCellBorderRecentColor"),96);
this.ia.ra(aa.a.Xak,Db.a.view,Object(C.a)(this,this.mkj,"handleMoreCellBorderColors"),96);this.ia.ra(aa.a.Sgl,Db.a.view,Object(C.a)(this,this.vnj,"handleTableBorderWidthAnchor"),4);this.ia.ra(aa.a.Tgl,Db.a.view,Object(C.a)(this,this.Nmj,"handleSelectTableBorderWidth"),4);this.ia.ra(aa.a.Agl,Db.a.view,Object(C.a)(this,this.tnj,"handleTableBorderColorAnchor"),4);this.ia.ra(aa.a.Tid,Db.a.view,Object(C.a)(this,this.Mmj,"handleSelectTableBorderColor"),4);this.ia.ra(aa.a.Qgl,Db.a.view,Object(C.a)(this,
this.unj,"handleTableBorderTypeAnchor"),4);this.ia.ra(aa.a.Rgl,Db.a.view,Object(C.a)(this,this.vOc,"handleSelectTableBorderType"),4);this.ia.ra(aa.a.Lgl,Db.a.view,Object(C.a)(this,this.Imj,"handleSelectInsideTableBorderType"),4);this.ia.ra(aa.a.Kgl,Db.a.view,Object(C.a)(this,this.lhg,"handleSelectInsideHorizontalTableBorderType"),4);this.ia.ra(aa.a.Pgl,Db.a.view,Object(C.a)(this,this.mhg,"handleSelectInsideVerticalTableBorderType"),4);this.ia.ra(aa.a.$7g,Db.a.view,Object(C.a)(this,this.Ylj,"handleQueryTableBorderWidth_1"),
96);this.ia.ra(aa.a.a8g,Db.a.view,Object(C.a)(this,this.Zlj,"handleQueryTableBorderWidth_2"),96);this.ia.ra(aa.a.b8g,Db.a.view,Object(C.a)(this,this.$lj,"handleQueryTableBorderWidth_3"),96);this.ia.ra(aa.a.c8g,Db.a.view,Object(C.a)(this,this.amj,"handleQueryTableBorderWidth_4"),96);this.ia.ra(aa.a.d8g,Db.a.view,Object(C.a)(this,this.bmj,"handleQueryTableBorderWidth_5"),96);this.ia.ra(aa.a.e8g,Db.a.view,Object(C.a)(this,this.cmj,"handleQueryTableBorderWidth_6"),96);this.ia.ra(aa.a.f8g,Db.a.view,Object(C.a)(this,
this.dmj,"handleQueryTableBorderWidth_7"),96);this.ia.ra(aa.a.g8g,Db.a.view,Object(C.a)(this,this.emj,"handleQueryTableBorderWidth_8"),96);this.ia.ra(aa.a.h8g,Db.a.view,Object(C.a)(this,this.fmj,"handleQueryTableBorderWidth_9"),96);this.ia.ra(aa.a.V7g,Db.a.view,Object(C.a)(this,this.Tlj,"handleQueryTableBorderType_LeftBorder"),96);this.ia.ra(aa.a.Y7g,Db.a.view,Object(C.a)(this,this.Wlj,"handleQueryTableBorderType_RightBorder"),96);this.ia.ra(aa.a.Z7g,Db.a.view,Object(C.a)(this,this.Xlj,"handleQueryTableBorderType_TopBorder"),
96);this.ia.ra(aa.a.P7g,Db.a.view,Object(C.a)(this,this.Nlj,"handleQueryTableBorderType_BottomBorder"),96);this.ia.ra(aa.a.R7g,Db.a.view,Object(C.a)(this,this.Plj,"handleQueryTableBorderType_DiagonalUpBorder"),96);this.ia.ra(aa.a.Q7g,Db.a.view,Object(C.a)(this,this.Olj,"handleQueryTableBorderType_DiagonalDownBorder"),96);this.ia.ra(aa.a.T7g,Db.a.view,Object(C.a)(this,this.Rlj,"handleQueryTableBorderType_InsideHorizontalBorder"),96);this.ia.ra(aa.a.U7g,Db.a.view,Object(C.a)(this,this.Slj,"handleQueryTableBorderType_InsideVerticalBorder"),
96);this.ia.ra(aa.a.S7g,Db.a.view,Object(C.a)(this,this.Qlj,"handleQueryTableBorderType_InsideBorder"),96);this.ia.ra(aa.a.X7g,Db.a.view,Object(C.a)(this,this.Vlj,"handleQueryTableBorderType_OutsideBorder"),96);this.ia.ra(aa.a.O7g,Db.a.view,Object(C.a)(this,this.Mlj,"handleQueryTableBorderType_AllBorder"),96);this.ia.ra(aa.a.W7g,Db.a.view,Object(C.a)(this,this.Ulj,"handleQueryTableBorderType_NoBorder"),96)}Fe(){}xpa(a){return a.hp()?qd.a("TableBordersComplexTableFixEnabled"):!0}I4(){var a=!1;this.ua.Ca&&
(a=this.sa.Dq(),a=!!a&&a.rd);return a}Vhj(){return this.I4()?32:8}hlj(a,b,c,f,l){if(!this.I4())return 16;if(1===c)return 32;if(!l)return 8;a=this.ua.Ca;if(!a)throw Error.argumentNull("ActiveSlide is null");c=this.Wb.Bf.I1;b=Object.assign(new Kl.a,{Id:"PptRibbon.TableDesign.Shading",MenuSectionList:[]});Array.add(b.MenuSectionList,Rk.f(a.Ye,DE.a.themeColors,"Color.Menu.Controls","themeColor","ThemeCellShadingColorPicker","3704601382",1));Array.add(b.MenuSectionList,Rk.d("Standard Colors","Color.Menu.Controls",
"standardColor","StandardCellShadingColorPicker","3704601382",!1));Array.add(b.MenuSectionList,Rk.b("Remove Color","Color.Menu.Controls","2292419401",ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor","ShapeNoFill","per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!1)),Array.add(b.MenuSectionList,Rk.c(c,"Recent Colors","Color.Menu.Controls","recentColor","CellShadingRecentColors",
"4078162917",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!0));qd.a("ColorPickerHighlighterFix")&&(c=this.Rz.D6f(this.sa.jy()),Rk.h(b,c,a.Ye));l.MenuItems=b;return 32}nkj(a,b,c,f,l){if(!this.I4())return za.a.J(595186461,822,10,"HandleMoreCellShadingColor: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.Ma(aa.a.renderColorPicker,1,l);a=this.u$i();b={};b.currentColor=a;b.handleCommand=aa.a.pye;return this.ia.Ma(aa.a.renderColorPicker,
2,b)}Uhj(a,b,c,f,l){if(1===c)return this.ia.Ma(aa.a.yva,c,l);if(!l)return za.a.J(595186459,822,10,"HandleCellShadingCustomColor: actionData is null"),16;a=this.ia.Ma(aa.a.yva,c,l);32===a&&this.ia.Ma(aa.a.zza,c,l);return a}Thj(a,b,c,f,l){if(!this.I4())return 16;if(1===c)return 32;if(!l)return 8;b=b.node;l=If.Box4ColorHelper.q0(l);if(!l)return 8;c=this.Jb.ie(15);c.lc(b);c.fd=a;a=b.cellShading;Dx(a);a.solidFillField=l;b.cellShading=a;c.dispose();za.a.J(573437397,822,15,String.format("HandleCellShadingColor: EntryPoint:{0} ",
yN.a[this.ia.$p]));return 32}kmj(a,b,c){if(!this.I4())return 16;if(1===c)return 32;b=b.node;c=this.Jb.ie(15);c.lc(b);c.fd=a;a=mk.a.Bi(b,zb.a.cellShading,new TQ.a);Dx(a);a.noFillField=new Px;b.cellShading=a;c.dispose();return 32}vnj(){const a=this.sa.Mo();return a&&this.I4()&&this.Ha.iDb&&this.xpa(a)?32:8}Nmj(a,b,c,f,l){a=this.sa.Mo();if(!(a&&this.I4()&&this.xpa(a)&&this.Ha.iDb))return 16;if(1===c)return 32;if(!l)return 8;switch(l.SourceControlId){case "TableBorderWidth_1":this.QG=this.lz[1];break;
case "TableBorderWidth_2":this.QG=this.lz[2];break;case "TableBorderWidth_3":this.QG=this.lz[3];break;case "TableBorderWidth_4":this.QG=this.lz[4];break;case "TableBorderWidth_5":this.QG=this.lz[5];break;case "TableBorderWidth_6":this.QG=this.lz[6];break;case "TableBorderWidth_7":this.QG=this.lz[7];break;case "TableBorderWidth_8":this.QG=this.lz[8];break;case "TableBorderWidth_9":this.QG=this.lz[9]}this.BD.YG();return 32}gHa(a,b){return(a=Object(ua.a)(Kh.a,a))?(this.QG===b?a.Yf(!0):a.Yf(!1),32):8}Ylj(a,
b,c,f,l){return this.gHa(l,this.lz[1])}Zlj(a,b,c,f,l){return this.gHa(l,this.lz[2])}$lj(a,b,c,f,l){return this.gHa(l,this.lz[3])}amj(a,b,c,f,l){return this.gHa(l,this.lz[4])}bmj(a,b,c,f,l){return this.gHa(l,this.lz[5])}cmj(a,b,c,f,l){return this.gHa(l,this.lz[6])}dmj(a,b,c,f,l){return this.gHa(l,this.lz[7])}emj(a,b,c,f,l){return this.gHa(l,this.lz[8])}fmj(a,b,c,f,l){return this.gHa(l,this.lz[9])}tnj(){const a=this.sa.Mo();return a&&this.I4()&&this.Ha.tdb&&this.xpa(a)?32:8}Mmj(a,b,c,f,l){a=this.sa.Mo();
if(!(a&&this.I4()&&this.xpa(a)&&this.Ha.tdb))return 16;if(1===c)return 32;if(!l)return 8;this.Rw=If.Box4ColorHelper.q0(l);this.BD.YG();return 32}glj(a,b,c,f,l){a=this.sa.Mo();if(!(a&&this.I4()&&this.xpa(a)))return 16;if(1===c)return 32;if(!l)return 8;c=this.ua.Ca;if(!c)throw Error.argumentNull("ActiveSlide is null");a=this.Wb.Bf.I1;b=Object.assign(new Kl.a,{Id:"PptRibbon.TableDesign.CellBorderColors",MenuSectionList:[]});Array.add(b.MenuSectionList,Rk.f(c.Ye,"Theme Colors","Color.Menu.Controls","themeColor",
"CellBorderColorPicker","71763897",1));Array.add(b.MenuSectionList,Rk.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellBorderColorPicker","71763897",!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!1)),Array.add(b.MenuSectionList,Rk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","CellBorderRecentColors","1124206375",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",
!0));l.MenuItems=b;return 32}Shj(a,b,c,f,l){if(1===c)return this.ia.Ma(aa.a.Tid,c,l);if(!l)return za.a.J(578069207,822,10,"HandleCellBorderRecentColor: actionData is null"),16;a=this.ia.Ma(aa.a.Tid,c,l);32===a&&this.ia.Ma(aa.a.zza,c,l);return a}mkj(a,b,c,f,l){a=this.sa.Mo();if(!(a&&this.I4()&&this.Ha.tdb&&this.xpa(a)))return za.a.J(579137993,822,10,"HandleMoreCellBorderColors: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.Ma(aa.a.renderColorPicker,1,l);c=null;b.Ok&&(b=b.node)&&
b.cellShading&&b.cellShading.solidFillField&&(c=If.Box4ColorHelper.Vqa(b.cellShading.solidFillField));b={};b.currentColor=c;b.handleCommand=aa.a.Tid;return this.ia.Ma(aa.a.renderColorPicker,2,b)}unj(){const a=this.sa.Mo();return a&&this.I4()&&this.Ha.F9&&this.xpa(a)?32:8}Imj(a,b,c,f,l){if(2===c)return this.vOc(a,b,c,f,l);const w=this.lhg(a,b,c,f,l);a=this.mhg(a,b,c,f,l);return 32===w||32===a?32:8}lhg(a,b,c,f,l){if(2===c)return this.vOc(a,b,c,f,l);c=this.sa.Mo();a=!!c&&this.I4()&&this.Ha.F9&&this.xpa(c);
if(!a)return 8;if(this.sa.hu())return 16;b=this.sa.jy();if(!b)return 16;b.length||(b=this.wc.PE(c));if(!b||!b.length)return 16;a=!1;c=b[0].rowIndex;for(const w of b)if(c!==w.rowIndex){a=!0;break}return a?32:8}mhg(a,b,c,f,l){if(2===c)return this.vOc(a,b,c,f,l);c=this.sa.Mo();a=!!c&&this.I4()&&this.Ha.F9&&this.xpa(c);if(!a)return 8;if(this.sa.hu())return 16;b=this.sa.jy();if(!b)return 16;b.length||(b=this.wc.PE(c));if(!b||!b.length)return 16;a=!1;c=b[0].pi;for(const w of b)if(c!==w.pi){a=!0;break}return a?
32:8}vOc(a,b,c,f,l){if(this.sa.hu())return 16;const w=this.sa.Mo();if(!w)return 16;if(1===c)return this.xpa(w)?32:8;if(!l)return za.a.J(579739904,822,10,"HandleSelectTableBorderType: actionData is null"),16;let F=this.sa.jy();if(!F)return 16;F.length||(F=this.nBa(this.wc.PE(w)));if(!F||!F.length)return za.a.J(579739874,822,10,"HandleSelectTableBorderType: unable to get valid cellNodes"),16;b=this.QG;let S=ke.a.XG(b),fa=this.Rw;const xa=l.SourceControlId;if(!xa||!fa)return za.a.J(579137989,822,10,
String.format("HandleSelectTableBorderType: Invalid Table Border params recorded.")),8;this.WE.Kb(xa)&&this.WE.ga(xa)&&(S=b=0,fa=fu.a.parse("000000").cJa());return ku.HLi(a,xa,b.toString(),this.Rsi(fa),yN.a[this.ia.$p],()=>{const Za=this.Jb.ie(15);Za.lc(w);Za.fd=a;switch(xa){case "TableBordersTopBorder":this.wQa(w,F,S,fa,!1,!1);break;case "TableBordersBottomBorder":this.rQa(w,F,S,fa,!1,!1);break;case "TableBordersLeftBorder":this.uQa(w,F,S,fa,!1,!1);break;case "TableBordersRightBorder":this.vQa(w,
F,S,fa,!1,!1);break;case "TableBordersInsideHorizontalBorder":this.sQa(w,F,S,fa,!1,!1,!1);break;case "TableBordersInsideVerticalBorder":this.tQa(w,F,S,fa,!1,!1,!1);break;case "TableBordersInsideBorders":this.sQa(w,F,S,fa,!1,!1,!1);this.tQa(w,F,S,fa,!1,!1,!1);break;case "TableBordersOutsideBorders":this.wQa(w,F,S,fa,!1,!1);this.rQa(w,F,S,fa,!1,!1);this.uQa(w,F,S,fa,!1,!1);this.vQa(w,F,S,fa,!1,!1);break;case "TableBordersNoBorder":S=0;fa=fu.a.parse("000000").cJa();this.wQa(w,F,S,fa,!1,!0);this.rQa(w,
F,S,fa,!1,!0);this.uQa(w,F,S,fa,!1,!0);this.vQa(w,F,S,fa,!1,!0);this.sQa(w,F,S,fa,!1,!1,!1);this.tQa(w,F,S,fa,!1,!1,!1);this.Ha.Jye&&(this.Xfg(F,S,fa),this.Wfg(F,S,fa));break;case "TableBordersAllBorders":this.wQa(w,F,S,fa,!1,!1);this.rQa(w,F,S,fa,!1,!1);this.uQa(w,F,S,fa,!1,!1);this.vQa(w,F,S,fa,!1,!1);this.sQa(w,F,S,fa,!1,!1,!1);this.tQa(w,F,S,fa,!1,!1,!1);break;case "TableBordersDiagonalUpBorder":this.Xfg(F,S,fa);break;case "TableBordersDiagonalDownBorder":this.Wfg(F,S,fa);break;default:za.a.J(579739871,
822,10,String.format("HandleSelectTableBorderType: Invalid Table borderType : {0} with actionId : {1} ",xa,a))}Za.dispose();return 32})}nBa(a){const b=[];for(const c of a)c.isGhostCell||b.push(c);return b}Tlj(a,b,c,f,l){a=this.sa.Mo();if(!a)return 16;b=this.sa.jy();if(!b)return 16;b.length||(b=this.nBa(this.wc.PE(a)));if(!b||!b.length)return za.a.J(578401676,822,10,"HandleQueryTableBorderType_LeftBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Kh.a,l);c=ke.a.XG(this.QG);return l?(this.uQa(a,
b,c,this.Rw,!0,!1)?(this.WE.$("TableBordersLeftBorder",!0),l.Yf(!0)):(this.WE.$("TableBordersLeftBorder",!1),l.Yf(!1)),32):8}Wlj(a,b,c,f,l){a=this.sa.Mo();if(!a)return 16;b=this.sa.jy();if(!b)return 16;b.length||(b=this.nBa(this.wc.PE(a)));if(!b||!b.length)return za.a.J(578401674,822,10,"HandleQueryTableBorderType_RightBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Kh.a,l);c=ke.a.XG(this.QG);return l?(this.vQa(a,b,c,this.Rw,!0,!1)?(this.WE.$("TableBordersRightBorder",!0),l.Yf(!0)):(this.WE.$("TableBordersRightBorder",
!1),l.Yf(!1)),32):8}Xlj(a,b,c,f,l){a=this.sa.Mo();if(!a)return 16;b=this.sa.jy();if(!b)return 16;b.length||(b=this.nBa(this.wc.PE(a)));if(!b||!b.length)return za.a.J(578401672,822,10,"HandleQueryTableBorderType_TopBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Kh.a,l);c=ke.a.XG(this.QG);return l?(this.wQa(a,b,c,this.Rw,!0,!1)?(this.WE.$("TableBordersTopBorder",!0),l.Yf(!0)):(this.WE.$("TableBordersTopBorder",!1),l.Yf(!1)),32):8}Nlj(a,b,c,f,l){a=this.sa.Mo();if(!a)return 16;b=this.sa.jy();
if(!b)return 16;b.length||(b=this.nBa(this.wc.PE(a)));if(!b||!b.length)return za.a.J(578401670,822,10,"HandleQueryTableBorderType_BottomBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Kh.a,l);c=ke.a.XG(this.QG);return l?(this.rQa(a,b,c,this.Rw,!0,!1)?(this.WE.$("TableBordersBottomBorder",!0),l.Yf(!0)):(this.WE.$("TableBordersBottomBorder",!1),l.Yf(!1)),32):8}Rlj(a,b,c,f,l){a=this.sa.Mo();if(!a)return 16;b=this.sa.jy();if(!b)return 16;b.length||(b=this.wc.PE(a));if(!b||!b.length)return za.a.J(578401668,
822,10,"HandleQueryTableBorderType_InsideHorizontalBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Kh.a,l);c=ke.a.XG(this.QG);return l?(this.sQa(a,b,c,this.Rw,!0,!1,!1)?(this.WE.$("TableBordersInsideHorizontalBorder",!0),l.Yf(!0)):(this.WE.$("TableBordersInsideHorizontalBorder",!1),l.Yf(!1)),32):8}Slj(a,b,c,f,l){a=this.sa.Mo();if(!a)return 16;b=this.sa.jy();if(!b)return 16;b.length||(b=this.wc.PE(a));if(!b||!b.length)return za.a.J(578401666,822,10,"HandleQueryTableBorderType_InsideVerticalBorder: unable to get valid cellNodes"),
16;l=Object(ua.a)(Kh.a,l);c=ke.a.XG(this.QG);return l?(this.tQa(a,b,c,this.Rw,!0,!1,!1)?(this.WE.$("TableBordersInsideVerticalBorder",!0),l.Yf(!0)):(this.WE.$("TableBordersInsideVerticalBorder",!1),l.Yf(!1)),32):8}Plj(a,b,c,f,l){return this.$gg(l,"TableBordersDiagonalUpBorder")}Olj(a,b,c,f,l){return this.$gg(l,"TableBordersDiagonalDownBorder")}$gg(a,b){if(!this.Ha.Jye)return 8;const c=this.sa.Mo();if(!c||!a)return 16;var f=this.sa.jy();if(!f)return 16;f.length||(f=this.nBa(this.wc.PE(c)));if(!f||
!f.length)return za.a.J(573933138,822,10,String.format("HandleQueryTableBorderType: unable to get valid cellNodes, borderType : {0} ",b)),16;a=Object(ua.a)(Kh.a,a);if(null===a)return 8;f=this.JAj(b,f,ke.a.XG(this.QG));this.WE.$(b,f);a.Yf(f);return 32}JAj(a,b,c){switch(a){case "TableBordersDiagonalUpBorder":return this.Crg(b,c,this.Rw,!1);case "TableBordersDiagonalDownBorder":return this.Brg(b,c,this.Rw,!1);default:return za.a.J(573933139,822,10,String.format("IsBorderApplied: Invalid Table borderType : {0} ",
a)),!1}}Qlj(a,b,c,f,l){a=this.sa.Mo();if(!a)return 16;b=this.sa.jy();if(!b)return 16;b.length||(b=this.wc.PE(a));if(!b||!b.length)return za.a.J(578401664,822,10,"HandleQueryTableBorderType_InsideBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Kh.a,l);c=ke.a.XG(this.QG);return l?(1<b.length&&this.tQa(a,b,c,this.Rw,!0,!1,!0)&&this.sQa(a,b,c,this.Rw,!0,!1,!0)?(this.WE.$("TableBordersInsideBorders",!0),l.Yf(!0)):(this.WE.$("TableBordersInsideBorders",!1),l.Yf(!1)),32):8}Vlj(a,b,c,f,l){a=this.sa.Mo();
if(!a)return 16;b=this.sa.jy();if(!b)return 16;b.length||(b=this.nBa(this.wc.PE(a)));if(!b||!b.length)return za.a.J(578401634,822,10,"HandleQueryTableBorderType_OutsideBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Kh.a,l);c=ke.a.XG(this.QG);return l?(this.wQa(a,b,c,this.Rw,!0,!1)&&this.vQa(a,b,c,this.Rw,!0,!1)&&this.rQa(a,b,c,this.Rw,!0,!1)&&this.uQa(a,b,c,this.Rw,!0,!1)?(this.WE.$("TableBordersOutsideBorders",!0),l.Yf(!0)):(this.WE.$("TableBordersOutsideBorders",!1),l.Yf(!1)),32):8}Mlj(a,
b,c,f,l){a=this.sa.Mo();if(!a)return 16;b=this.sa.jy();if(!b)return 16;b.length||(b=this.nBa(this.wc.PE(a)));if(!b||!b.length)return za.a.J(578401632,822,10,"HandleQueryTableBorderType_AllBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Kh.a,l);c=ke.a.XG(this.QG);return l?(this.wQa(a,b,c,this.Rw,!0,!1)&&this.vQa(a,b,c,this.Rw,!0,!1)&&this.rQa(a,b,c,this.Rw,!0,!1)&&this.uQa(a,b,c,this.Rw,!0,!1)&&this.sQa(a,b,c,this.Rw,!0,!1,!0)&&this.tQa(a,b,c,this.Rw,!0,!1,!0)?(this.WE.$("TableBordersAllBorders",
!0),l.Yf(!0)):(this.WE.$("TableBordersAllBorders",!1),l.Yf(!1)),32):8}Ulj(a,b,c,f,l){a=this.sa.Mo();if(!a)return 16;b=this.sa.jy();if(!b)return 16;b.length||(b=this.nBa(this.wc.PE(a)));if(!b||!b.length)return za.a.J(578401630,822,10,"HandleQueryTableBorderType_NoBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Kh.a,l);c=ke.a.XG(this.QG);return l?(f=!0,this.Ha.Jye&&(f=this.Crg(b,c,this.Rw,!0)&&this.Brg(b,c,this.Rw,!0)),f&&this.wQa(a,b,c,this.Rw,!0,!0)&&this.vQa(a,b,c,this.Rw,!0,!0)&&this.rQa(a,
b,c,this.Rw,!0,!0)&&this.uQa(a,b,c,this.Rw,!0,!0)&&this.sQa(a,b,c,this.Rw,!0,!0,!0)&&this.tQa(a,b,c,this.Rw,!0,!0,!0)?(this.WE.$("TableBordersNoBorder",!0),l.Yf(!0)):(this.WE.$("TableBordersNoBorder",!1),l.Yf(!1)),32):8}sCa(a,b){if(!a)return!1;const c=If.Box4ColorHelper.Fwa(a),f=If.Box4ColorHelper.Fwa(b);a=If.Box4ColorHelper.Vqa(a);b=If.Box4ColorHelper.Vqa(b);return c.schemeClrField&&f.schemeClrField&&!a&&!b&&c.schemeClrField.valField===f.schemeClrField.valField?!0:a&&b?a.alpha===b.alpha&&a.xC===
b.xC:!1}Rsi(a){a=If.Box4ColorHelper.Fwa(a);const b=this.ua.Ca;return(a=If.Box4ColorHelper.CL(a,b?b.Ye:null))&&If.Box4ColorHelper.dna(a)?If.Box4ColorHelper.dna(a).cU():null}bqb(a,b,c,f){if(a=Object(ua.a)(Us,a.pc(this.Pb.Na))){f=If.Box4ColorHelper.Fwa(f);var l=this.ua.Ca;f=(f=If.Box4ColorHelper.CL(f,l?l.Ye:null))?If.Box4ColorHelper.dna(f):null;a.uZk(b,c,f)}}Du(a,b,c,f){if(a)switch(b){case "Top":a.Swa=c;a.Bgb=f;this.bqb(a,"Top",c,f);break;case "Right":a.Fea=c;a.Qwa=f;this.bqb(a,"Right",c,f);break;case "Bottom":a.Eea=
c;a.Pwa=f;this.bqb(a,"Bottom",c,f);break;case "Left":a.Rwa=c;a.Agb=f;this.bqb(a,"Left",c,f);break;case "DiagonalUp":a.Dgb=c;a.zgb=f;this.bqb(a,"DiagonalUp",c,f);break;case "DiagonalDown":a.Cgb=c,a.ygb=f,this.bqb(a,"DiagonalDown",c,f)}}wQa(a,b,c,f,l,w){const F=new wa.ScriptSharpLegacyMap;let S=Number.MAX_VALUE,fa=-1;for(const xa of b)b=xa.pi,S=Math.min(S,b),fa=Math.max(fa,b),F.Kb(b)?F.$(b,Math.min(F.ga(b),xa.rowIndex)):F.$(b,xa.rowIndex);if(l)return this.PMj(a,c,f,S,fa,F,w);this.Fhj(a,c,f,S,fa,F);
return!0}Fhj(a,b,c,f,l,w){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const S=a.hf(w.ga(f),f);this.Du(S,"Top",b,c);let fa=f;const xa=f+S.colSpan;for(;fa<xa;){var F=a.hf(w.ga(f)-1,fa);F?F.isGhostCell?(F=F.ly(),F.pi<f?fa+=1:(this.Du(F,"Bottom",b,c),fa+=F.colSpan)):(this.Du(F,"Bottom",b,c),fa+=F.colSpan):fa+=1}f+=S.colSpan}else for(;f<=l;++f)this.Du(a.hf(w.ga(f),f),"Top",b,c),this.Du(a.hf(w.ga(f)-1,f),"Bottom",b,c)}PMj(a,b,c,f,l,w,F){for(;f<=l;){const S=a.hf(w.ga(f),f),fa=S.Bgb,xa=ke.a.rL(S.Swa),
Za=ke.a.rL(b);if(F){if(xa!==this.lz[0])return!1}else if(xa!==Za||!this.sCa(fa,c))return!1;f+=S.colSpan}return!0}rQa(a,b,c,f,l,w){const F=new wa.ScriptSharpLegacyMap;let S=Number.MAX_VALUE,fa=-1;for(const xa of b)b=xa.pi,S=Math.min(S,b),fa=Math.max(fa,b),F.Kb(b)?F.$(b,Math.max(F.ga(b),xa.rowIndex)):F.$(b,xa.rowIndex);if(l)return this.MAj(a,c,f,S,fa,F,w);this.ohj(a,c,f,S,fa,F);return!0}ohj(a,b,c,f,l,w){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const S=a.hf(w.ga(f),f);this.Du(S,"Bottom",
b,c);let fa=f;const xa=f+S.colSpan;for(;fa<xa;){var F=a.hf(w.ga(f)+S.rowSpan,fa);F?F.isGhostCell?(F=F.ly(),F.pi<f?fa+=1:(this.Du(F,"Top",b,c),fa+=F.colSpan)):(this.Du(F,"Top",b,c),fa+=F.colSpan):fa+=1}f+=S.colSpan}else for(;f<=l;++f)this.Du(a.hf(w.ga(f),f),"Bottom",b,c),this.Du(a.hf(w.ga(f)+1,f),"Top",b,c)}MAj(a,b,c,f,l,w,F){for(;f<=l;){const S=a.hf(w.ga(f),f),fa=S.Pwa,xa=ke.a.rL(S.Eea),Za=ke.a.rL(b);if(F){if(xa!==this.lz[0])return!1}else if(xa!==Za||!this.sCa(fa,c))return!1;f+=S.colSpan}return!0}uQa(a,
b,c,f,l,w){const F=new wa.ScriptSharpLegacyMap;let S=Number.MAX_VALUE,fa=-1;for(const xa of b)b=xa.rowIndex,S=Math.min(S,b),fa=Math.max(fa,b),F.Kb(b)?F.$(b,Math.min(F.ga(b),xa.pi)):F.$(b,xa.pi);if(l)return this.fGj(a,c,f,S,fa,F,w);this.vhj(a,c,f,S,fa,F);return!0}vhj(a,b,c,f,l,w){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const S=a.hf(f,w.ga(f));this.Du(S,"Left",b,c);let fa=f;const xa=f+S.rowSpan;for(;fa<xa;){var F=a.hf(fa,w.ga(f)-1);F?F.isGhostCell?(F=F.ly(),F.rowIndex<f?fa+=1:(this.Du(F,
"Right",b,c),fa+=F.rowSpan)):(this.Du(F,"Right",b,c),fa+=F.rowSpan):fa+=1}f+=S.rowSpan}else for(;f<=l;++f)this.Du(a.hf(f,w.ga(f)),"Left",b,c),this.Du(a.hf(f,w.ga(f)-1),"Right",b,c)}fGj(a,b,c,f,l,w,F){for(;f<=l;){const S=a.hf(f,w.ga(f)),fa=S.Agb,xa=ke.a.rL(S.Rwa),Za=ke.a.rL(b);if(F){if(xa!==this.lz[0])return!1}else if(xa!==Za||!this.sCa(fa,c))return!1;f+=S.rowSpan}return!0}vQa(a,b,c,f,l,w){const F=new wa.ScriptSharpLegacyMap;let S=Number.MAX_VALUE,fa=-1;for(const xa of b)b=xa.rowIndex,S=Math.min(S,
b),fa=Math.max(fa,b),F.Kb(b)?F.$(b,Math.max(F.ga(b),xa.pi)):F.$(b,xa.pi);if(l)return this.bKj(a,c,f,S,fa,F,w);this.whj(a,c,f,S,fa,F);return!0}whj(a,b,c,f,l,w){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const S=a.hf(f,w.ga(f));this.Du(S,"Right",b,c);let fa=f;const xa=f+S.rowSpan;for(;fa<xa;){var F=a.hf(fa,w.ga(f)+S.colSpan);F?F.isGhostCell?(F=F.ly(),F.rowIndex<f?fa+=1:(this.Du(F,"Left",b,c),fa+=F.rowSpan)):(this.Du(F,"Left",b,c),fa+=F.rowSpan):fa+=1}f+=S.rowSpan}else for(;f<=l;++f)this.Du(a.hf(f,
w.ga(f)),"Right",b,c),this.Du(a.hf(f,w.ga(f)+1),"Left",b,c)}bKj(a,b,c,f,l,w,F){for(;f<=l;){const S=a.hf(f,w.ga(f)),fa=S.Qwa,xa=ke.a.rL(S.Fea),Za=ke.a.rL(b);if(F){if(xa!==this.lz[0])return!1}else if(xa!==Za||!this.sCa(fa,c))return!1;f+=S.rowSpan}return!0}tQa(a,b,c,f,l,w,F){b=this.sa.wsb();if(!b)return!1;b.length||(b=this.wc.PE(a));if(!b||!b.length)return za.a.J(575473443,822,10,"HandleSelectionInsideVerticalBorders: unable to get valid cellNodes"),!1;const S=new wa.ScriptSharpLegacyMap,fa=new wa.ScriptSharpLegacyMap;
let xa=Number.MAX_VALUE,Za=-1;for(const pb of b)b=pb.rowIndex,xa=Math.min(xa,b),Za=Math.max(Za,b),S.Kb(b)?S.$(b,Math.min(S.ga(b),pb.pi)):S.$(b,pb.pi),fa.Kb(b)?fa.$(b,Math.max(fa.ga(b),pb.pi)):fa.$(b,pb.pi);if(l)return this.GFj(a,c,f,xa,Za,S,fa,w,F);this.uhj(a,c,f,xa,Za,S,fa);return!0}uhj(a,b,c,f,l,w,F){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(w.Kb(f)&&F.Kb(f))for(var S=w.ga(f),fa=F.ga(f);S<fa;){const Za=a.hf(f,S);if(!Za.isGhostCell&&Za.pi+Za.colSpan<=fa){this.Du(Za,"Right",
b,c);let pb=f;const Mb=f+Za.rowSpan;for(;pb<Mb;){var xa=a.hf(pb,S+Za.colSpan);xa?xa.isGhostCell?(xa=xa.ly(),xa.rowIndex<f?pb+=1:(this.Du(xa,"Left",b,c),pb+=xa.rowSpan)):(this.Du(xa,"Left",b,c),pb+=xa.rowSpan):pb+=1}}S+=Za.colSpan}}else for(;f<=l;++f)for(S=w.ga(f),fa=F.ga(f);S<fa;++S)this.Du(a.hf(f,S),"Right",b,c),this.Du(a.hf(f,S+1),"Left",b,c)}GFj(a,b,c,f,l,w,F,S,fa){if(qd.a("TableBordersComplexTableFixEnabled")){for(var xa=!1;f<=l;f++)if(w.Kb(f)&&F.Kb(f))for(var Za=w.ga(f),pb=F.ga(f);Za<pb;){var Mb=
a.hf(f,Za);if(!Mb.isGhostCell&&Mb.pi+Mb.colSpan<=pb){var hc=Mb.Qwa;let kc=ke.a.rL(Mb.Fea),Ec=ke.a.rL(b);xa=!0;if(S){if(kc!==this.lz[0])return!1}else if(kc!==Ec||!this.sCa(hc,c))return!1}Za+=Mb.colSpan}return xa?!0:fa}for(xa=f;xa<=l;++xa){pb=w.ga(xa);f=F.ga(xa);if(pb===f)return fa?!0:!1;for(;pb<f;++pb)if(Mb=a.hf(xa,pb),Za=Mb.Qwa,Mb=ke.a.rL(Mb.Fea),hc=ke.a.rL(b),S){if(Mb!==this.lz[0])return!1}else if(Mb!==hc||!this.sCa(Za,c))return!1}return!0}sQa(a,b,c,f,l,w,F){b=this.sa.wsb();if(!b)return!1;b.length||
(b=this.wc.PE(a));if(!b||!b.length)return za.a.J(575473472,822,10,"HandleSelectionInsideHorizontalBorders: unable to get valid cellNodes"),!1;const S=new wa.ScriptSharpLegacyMap,fa=new wa.ScriptSharpLegacyMap;let xa=Number.MAX_VALUE,Za=-1;for(const pb of b)b=pb.pi,xa=Math.min(xa,b),Za=Math.max(Za,b),S.Kb(b)?S.$(b,Math.min(S.ga(b),pb.rowIndex)):S.$(b,pb.rowIndex),fa.Kb(b)?fa.$(b,Math.max(fa.ga(b),pb.rowIndex)):fa.$(b,pb.rowIndex);if(l)return this.FFj(a,c,f,xa,Za,S,fa,w,F);this.thj(a,c,f,xa,Za,S,fa);
return!0}thj(a,b,c,f,l,w,F){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(w.Kb(f)&&F.Kb(f))for(var S=w.ga(f),fa=F.ga(f);S<fa;){const Za=a.hf(S,f);if(!Za.isGhostCell&&Za.rowIndex+Za.rowSpan<=fa){this.Du(Za,"Bottom",b,c);let pb=f;const Mb=f+Za.colSpan;for(;pb<Mb;){var xa=a.hf(S+Za.rowSpan,pb);xa?xa.isGhostCell?(xa=xa.ly(),xa.pi<f?pb+=1:(this.Du(xa,"Top",b,c),pb+=xa.colSpan)):(this.Du(xa,"Top",b,c),pb+=xa.colSpan):pb+=1}}S+=Za.rowSpan}}else for(;f<=l;++f)for(S=w.ga(f),fa=F.ga(f);S<
fa;++S)this.Du(a.hf(S,f),"Bottom",b,c),this.Du(a.hf(S+1,f),"Top",b,c)}FFj(a,b,c,f,l,w,F,S,fa){if(qd.a("TableBordersComplexTableFixEnabled")){for(var xa=!1;f<=l;f++)if(w.Kb(f)&&F.Kb(f))for(var Za=w.ga(f),pb=F.ga(f);Za<pb;){var Mb=a.hf(Za,f);if(!Mb.isGhostCell&&Mb.rowIndex+Mb.rowSpan<=pb){var hc=Mb.Pwa;let kc=ke.a.rL(Mb.Eea),Ec=ke.a.rL(b);xa=!0;if(S){if(kc!==this.lz[0])return!1}else if(kc!==Ec||!this.sCa(hc,c))return!1}Za+=Mb.rowSpan}return xa?!0:fa}for(xa=f;xa<=l;++xa){pb=w.ga(xa);f=F.ga(xa);if(pb===
f)return fa?!0:!1;for(;pb<f;++pb)if(Mb=a.hf(pb,xa),Za=Mb.Pwa,Mb=ke.a.rL(Mb.Eea),hc=ke.a.rL(b),S){if(Mb!==this.lz[0])return!1}else if(Mb!==hc||!this.sCa(Za,c))return!1}return!0}Xfg(a,b,c){for(const f of a)this.Du(f,"DiagonalUp",b,c)}Crg(a,b,c,f){for(const l of a)if(!this.Hvg(ke.a.rL(l.Dgb),ke.a.rL(b),l.zgb,c,f))return!1;return!0}Wfg(a,b,c){for(const f of a)this.Du(f,"DiagonalDown",b,c)}Brg(a,b,c,f){for(const l of a)if(!this.Hvg(ke.a.rL(l.Cgb),ke.a.rL(b),l.ygb,c,f))return!1;return!0}Hvg(a,b,c,f,l){if(l){if(a!==
this.lz[0])return!1}else if(a!==b||!this.sCa(c,f))return!1;return!0}dBe(a,b,c,f,l){if(!l)return 8;if(1===c)return 32;l[Uh.a.On]=!1;a=this.ESa[a.toString()];if(!this.sa||!this.sa.Pa.kb||this.sa.E7())return 16;b=0;({lva:b}=this.wc.Fkd(this.sa.Pa)).returnValue&&b===a&&(l[Uh.a.On]=!0);return 32}sjc(a,b){a=a.queryResult;null!==a&&(a.xea=parseFloat(b.toFixed(2)).toString())}nad(a,b,c,f,l){if(!l)return 16;l.Yf(this.m9b);return 32}Jfd(a,b,c){if(1===c)return 32;2===c&&(this.m9b=!this.m9b);gb.App.Fb.GF({SetLockAspectRatio:"CheckboxModel"});
return 32}i8g(a,b,c,f,l){if(!l)return 16;b=this.sa.Mo();if(!b)return 8;a=a===aa.a.ebd?this.wc.j1d(b):this.wc.l1d(b);this.sjc(l,ke.a.kv(a));return 32}hlh(a,b,c,f,l){const w=this.sa.Mo();return a!==aa.a.mwa&&a!==aa.a.JXa||!w?16:1===c?32:ug.a(String.format("{0}::Entry point:{1}",aa.a.uz(a),this.ia.$p),a,()=>{if(!l)return za.a.J(538306209,822,10,"TableActor::SetTableSize actionData == null"),8;var F=ke.a.xV(l.Number);var S=a===aa.a.mwa?this.wc.j1d(w):this.wc.l1d(w);if(F<Dv.a.V4c||S<Dv.a.V4c)return 16;
F/=S;S=this.Jb.ie(15);try{S.lc(w),S.fd=a,a===aa.a.mwa?(this.Xr.mwa(w,F),this.m9b&&this.Xr.JXa(w,F)):(this.Xr.JXa(w,F),this.m9b&&this.Xr.mwa(w,F)),this.Xr.CWa(w)}finally{S&&S.dispose()}return 32})}Lgc(a,b,c,f,l){a=this.sa.Mo();if(!a)return 16;b=this.sa.UMc();if(!b)return 16;b.length||(b=this.wc.fia(a));if(!b.length)return 16;a=this.uua.i7f(b);this.sjc(l,ke.a.kv(a));return 32}yfb(a,b,c,f,l){const w=this.sa.Mo();return w?1===c?32:ug.a(String.format("SetTableRowHeight::Entry point:{0}",this.ia.$p),a,
()=>{if(null===l)return za.a.J(538306211,822,10,"TableActor::SetTableRowHeight actionData == null"),16;let F=this.sa.UMc();if(!F)return za.a.J(538306240,822,10,"TableActor::SetTableRowHeight, selected table row nodes == null"),16;F.length||(F=this.wc.fia(w));if(!F.length)return 16;let S=Dv.a.eSg;a!==aa.a.Mhd&&(S=l.Number);const fa=this.Jb.ie(15);try{fa.lc(w),fa.fd=a,this.Xr.glh(F,S)}finally{fa&&fa.dispose()}this.Xr.CWa(w);return 32}):16}Kgc(a,b,c,f,l){a=this.sa.Mo();if(!a)return 16;b=this.sa.wsb();
if(!b)return 16;b.length||(b=this.Dsb(a));if(!b.length)return 16;a=this.lF.k7f(a,b);this.sjc(l,ke.a.kv(a));return 32}IXa(a,b,c,f,l){const w=this.sa.Mo();return w?1===c?32:ug.a(String.format("SetTableColumnWidth::Entry point:{0}",this.ia.$p),a,()=>{if(null===l)return za.a.J(538306242,822,10,"TableActor::SetTableColumnWidth actionData == null"),16;var F=this.sa.wsb();if(!F)return za.a.J(538306243,822,10,"TableActor::SetTableColumnWidth, selected column node == null"),16;F.length||(F=this.Dsb(w));if(!F.length)return 16;
let S=Dv.a.dSg;a!==aa.a.Lhd&&(S=l.Number);F=this.lF.JXd(F);const fa=this.Jb.ie(15);try{fa.lc(w),fa.fd=a,this.Xr.flh(w,F,S)}finally{fa&&fa.dispose()}this.Xr.CWa(w);return 32}):16}kgg(a,b,c,f,l){const w=this.sa.Mo();return w?1===c?qd.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:w.hp()?8:32:ug.a("HandleDistributeRows:Entry point:"+this.ia.$p,a,()=>{if(2===c){if(null===l)return 16;let fa=this.sa.UMc();if(!fa)return 16;var F=this.sa.jy();if(!F)return 16;fa.length&&1!==F.length||(fa=this.wc.fia(w));
if(!fa)return 16;if(!fa.length)return za.a.J(587559625,822,50,"HandleDistributeRows: unable to get valid tableRowNodes"),16;F=0;for(var S of fa)S&&(F+=this.uua.d6a(S));S=this.j5i(fa,w);const xa=fa.length;F=F<xa*S?S:F/xa;S=this.Jb.ie(15);try{S.lc(w),S.fd=a,this.Xr.glh(fa,ke.a.kv(F))}finally{S&&S.dispose()}za.a.J(587559623,822,50,"HandleDistributeRows: Table Rows Distributed with height: {0}, from Entry Point: {1}",ke.a.kv(F),this.ia.$p);this.Xr.CWa(w)}return 32}):16}j5i(a,b){let c=ke.a.xV(Dv.a.eSg);
for(const l of a){a=this.wc.A6a(l);for(const w of a)if(w&&(a=w.ZYb)&&(a=db.ParagraphReader.text(a))&&0<a.length){var f=w.rowIndex;const F=w.pi;if(a=Object(ua.a)(Us,w.pc(this.Pb.Na)))this.JW.e5g(b,this.Pb.Na),f=this.JW.TZb(b,a.cha,f,F),a=a.Gd.Ed.yf(f,1),qd.a("DistributeRowsAndColumnsComplexTableFixEnabled")&&1<w.rowSpan&&(a/=w.rowSpan),c=Math.max(c,a)}}return c}Mij(a,b,c,f,l){const w=this.sa.Mo();return w?1===c?qd.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:w.hp()?8:32:ug.a("HandleDistributeColumns:Entry point:"+
this.ia.$p,a,()=>{if(2===c){if(null===l)return 16;var F=this.sa.wsb();F.length||(F=this.Dsb(w));if(!F)return 16;var S=this.sa.jy();if(!S)return 16;F.length&&1!==S.length||(F=this.Dsb(w));if(!F.length)return za.a.J(579405138,822,50,"HandleDistributeColumns: unable to get valid tableColumnNodes"),16;S=0;F=this.lF.JXd(F);if(!F)return za.a.J(587559617,822,50,"HandleDistributeColumns: table columnIndex array is null"),16;var fa=w.FXd;if(!fa)return za.a.J(587559587,822,50,"HandleDistributeColumns: table columnWidths array is null"),
16;for(let xa=0;xa<F.length;xa++)S+=fa[F[xa]];S/=F.length;if(ke.a.kv(S)<Dv.a.dSg)return 16;fa=this.Jb.ie(15);try{fa.lc(w),fa.fd=a,this.Xr.flh(w,F,ke.a.kv(S))}finally{fa&&fa.dispose()}za.a.J(587559585,822,50,"HandleDistributeColumns: Table Columns Distributed with width: {0}, from Entry Point: {1}",ke.a.kv(S),this.ia.$p);this.Xr.CWa(w)}return 32}):16}Y2d(a,b,c,f,l){if(!this.Ha.V$d||this.sa.E7())return 16;if(1===c)return 32;if(!l)return 8;c=this.ESa[a.toString()];b=b.node;f=this.Jb.ie(15);f.lc(b);f.fd=
a;a=b.cellShading;a.anchorField=c;b.cellShading=a;b.$ma=c;f.dispose();return 32}Xjj(a,b,c,f,l){b=this.ua.Ca;if(!b||this.Df.gd(b))return 16;if(!this.gl.kI(b,1))return this.gl.fJ(b),16;c=l.Rows;f=l.Columns;l=l.From;var w=b.Cb;w=b.B6(w.sid,w.cid,0,c,f,b.Mu());var F=b.g2(this.sa.he());if(F){if(this.Df.gd(F)||this.Fa.eI(F))return 16;this.rm.rZk(w,F.id);this.Df.xw(F,a)}F=this.Jb.xd(15,void 0,()=>{this.sa.gy();this.sa.Rh();this.Ga.Bd()});try{F.lc(b),F.fd=a,b.uB(w)}finally{F&&F.dispose()}this.sa.selectShape(w,
!0);za.a.J(19142344,822,50,"Insert {0}x{1} table from {2}",f,c,l);this.Ix.oI=w;return 32}Yjj(){(new AN((a,b)=>{const c={};c.Rows=a;c.Columns=b;c.From="Placeholder";this.ia.Ma(aa.a.h$c,2,c)})).hhd();return 32}Zjj(a,b,c,f,l){l.From="Ribbon";return this.ia.Ma(aa.a.h$c,c,l)}Iij(a,b,c){b=this.ua.Ca;if(!b||this.sa.E7())return 16;const f=this.sa.Dq();if(!f||!f.rd||this.Df.gd(f))return 16;if(1===c)return 32;Kc.a.uO(!0,!0);c=this.Jb.xd(15,void 0,()=>{this.sa.setSelection(null);this.Ga.Bd()});try{c.lc(b),c.fd=
a,this.rm.lWf(f)}finally{c&&c.dispose()}this.Df.xw(b,a);return 32}Kij(a,b,c,f,l){if(this.sa.hu())return 16;a=this.c0d(this.sa.Dj,!0,this.sa);return this.Tzj(a)?16:32!==a.response?8:a.kC&&a.kC.length===Cd.TableReader.Zj(a.Jo)?this.ia.processAction(aa.a.WCb,c):this.ia.li(b,D.a.deleteRow,c,!1,f,l)}Jij(a,b,c,f,l){if(this.sa.hu())return 16;a=this.c0d(this.sa.Dj,!1,this.sa);return this.Szj(a)?16:32!==a.response?8:a.kC&&a.kC.length===Cd.TableReader.ui(a.Jo)?this.ia.processAction(aa.a.WCb,c):this.ia.li(b,
D.a.GAa,c,!1,f,l)}Lmj(a,b,c,f,l){return 1===c?32:this.ia.li(b,aa.a.aha,c,!1,f,l)}lkj(a,b,c){if(this.sa.hu()||this.sa.E7()||!this.Ha.JTc)return 16;b=this.sa.Pa;if(!b||!b.nl||1===b.length&&1===b.ga(0).length)return 16;b=this.eAb.q0b(b);if(!b)return za.a.J(36721626,822,50,"Unable to get cell selection info"),8;if(!b.LJj)return 16;if(1===c)return 32;Kc.a.Db&&(Kc.a.Db.Nj=!0,Kc.a.Db.uE=new Date);za.a.J(36721628,822,50,"Perform table merge cells");const f=b.tableNode;c=this.Jb.ie(15);c.lc(f);c.fd=a;a=this.OOg.merge(f,
b.pob,b.FX);a=Vq.TableNodeContext.create(a);a=fd.SelectionFactory.hWb(fd.SelectionFactory.Zt(a));this.sa.UD(a);c.dispose();za.a.J(36721630,822,50,"Table merge cells succeeded");return 32}knj(a,b,c){if(this.sa.hu()||this.sa.E7()||!this.Ha.$$d)return 16;var f=null;f=this.sa.Pa.nl?this.eAb.q0b(this.sa.Pa):this.eAb.Naj(b.view.Eb.Dj);if(!f)return 16;const l=f.tableNode.yg(this.Pb.Na);if(l&&!l.dGj)return za.a.J(37005126,822,50,"Suspend split cells as table layout service is running"),16;const w=Object(ua.a)(182,
f.tableNode);if(this.wc.g7d(w))return 16;const F=f.pob;if(!({rows:b,cols:a}=this.nnl(w,F)).returnValue)return 8;if(1===c)return 1<b||1<a?32:16;const S=f.FX,fa=new Date;({rows:c,cols:f}=this.KXi(w,S,F,l));const xa=Kc.a.Db;xa&&(xa.Ya("GetClientSplitLimit",(+new Date-+fa).toString()),xa.ur=!1);(new BN((Za,pb)=>{this.OOg.ldl(w,F,Za,pb,S,l,this.Pb.Ed,Object(C.a)(this,this.gag,"getNewOutlineElementInfoFromCell"),()=>{})},Math.min(b,c),Math.min(a,f))).hhd();return 32}vmj(a,b,c,f,l){if(!l||!Object(Ca.a)(Array,
l))return 8;if(1!==l.length)return za.a.J(40665353,822,50,"Fallback table resize fail: reiszeShapeData length is {0}.",l.length),8;if(this.Df.gd(l[0].g0))return 16;b=l[0].g0;if(!(b&&b.isConnected&&b.isResizable&&b.rd)||b.eI)return za.a.J(40665355,822,50,"Fallback table resize: try to resize shape {0} which is not resizeable",b.get_shapeId()),16;f=Object(ua.a)(133,b.pc(this.Pb.Na));if(!f)return za.a.J(40665357,822,50,"Fallback table resize fail: shape {0} has no shapeviewelement",b.get_shapeId()),
8;const w=this.wc.ZM(b);if(!w)return za.a.J(40665359,822,50,"Fallback table resize fail: shape {0} has no table node",b.get_shapeId()),8;const F=w.pc(this.Pb.Na);if(!F)return za.a.J(40665361,822,50,"Fallback table resize fail: fallback table shape {0} has no tableviewelement and no rendered",b.get_shapeId()),8;if(!l[0].BXb)return f&&f.setOffsets(new ri.a,!0),za.a.J(40665363,822,50,"Fallback table resize fail: resizeShapeData no drag direction"),8;if(1===c)return 32;let S=c=1;try{f.Kk.Rgh.Yob.length||
(this.j1c=new ri.a);f.setOffsets(new ri.a,!0);var fa=F.p0b();const xa=this.MDa.jn(fa.$b-fa.fc),Za=this.MDa.jn(fa.Xb-fa.ic),pb=new ic.a(f.x+xa,f.y+Za),Mb=new ic.a(f.mea(l[0].xSg.x),f.mea(l[0].xSg.y)),hc=Pk.zKd(l[0].BXb,fa,Mb,!1,!1);c=xa?1+(hc.right-hc.left)/xa:1;S=Za?1+(hc.bottom-hc.top)/Za:1;F.jlh(c,S);const kc=F.p0b();let Ec=qi.a.A_b(kc,fa);Ec.Ej(1/f.ud);this.j1c&&(Ec=ri.a.add(Ec,this.j1c));f.setOffsets(Ec,!0);this.j1c=Ec;l[0].U_.Ej(f.ud);this.YNe(l[0].BXb,f,kc,pb,l[0].U_)}catch(xa){return za.a.J(40665365,
822,50,"Fallback table resize fail: ",xa.toString()),8}fa=this.Jb.ie(15);fa.lc(w);fa.fd=a;a=F.Gd.Ed;this.Xr.NEe(w,c,S,F,a);if(ku.QCa(l[0].BXb)||ku.QCa(l[0].BXb,!0))l=a.yf(f.x,0),a=a.yf(f.y,1),b.My=l,b.Ny=a;fa.dispose();return 32}nnl(a,b){let c,f;c=f=1;try{return c=Math.max(1,Math.floor((35-this.wc.Zj(a))/b.dO)+1),f=Math.max(1,Math.floor((35-this.wc.ui(a))/b.xQ)+1),{returnValue:!0,rows:c,cols:f}}catch(l){za.a.J(37304271,822,10,"Failed to get server split limits, Exception: {0}",l.toString())}return{returnValue:!1,
rows:c,cols:f}}KXi(a,b,c,f){a=this.uca.eBa(a,b,c);b=f.ccg();f=f.W6f();let l=c=Number.MAX_VALUE;for(;a.moveNext();){const w=a.Cz;l=Math.min(l,b[w.Tf]-b[w.ge]);c=Math.min(c,f[w.Lf]-f[w.ae])}return{rows:Math.max(1,Math.floor(l/CN.a)),cols:Math.max(1,Math.floor(c/CN.a))}}gag(a){const b=Ch.Nag(a,!1);b.style||(b.style=new kq.a);a=Object(ua.a)(mb.GraphIterator,this.Ib.Jc(a));a.uv();if(a.xA(1)){if(yc.ListReader.$j(a)){const f=this.Jz.rx(a),l=hk.a.bV(f.listType,f.listStyle);0===l.listType&&(l.Zz=l.SV=f.Zz);
f.propertySet.Sa(ob.a.fm)&&l.propertySet.setValue(ob.a.fm,f.propertySet.getValue(ob.a.fm));f.propertySet.Sa(ob.a.font)&&l.propertySet.setValue(ob.a.font,f.propertySet.getValue(ob.a.font));f.propertySet.Sa(zb.a.autonumberBulletType)&&l.propertySet.setValue(zb.a.autonumberBulletType,f.propertySet.getValue(zb.a.autonumberBulletType));b.style.px(l.propertySet)}var c;(c=b.style).V3a.apply(c,[a.currentNode].concat(Qq.W1d()));if(c=a.xA(2)){let f;(f=b.style).V3a.apply(f,[c].concat(Qq.W1d()));a.yc()}}return b}b9i(a,
b){const c=new Qt;c.response=8;if(!a)return c;let f=null;var l=null,w=!1;const F=xi.ContextSetEditor.instance.lA(a);a=[];for(var S=0;S<F.length;++S)if(F[S].Ok){var fa=Object(ua.a)(5,F[S].node);if(!fa||!fa.Nr())return c;fa=fa.nK();f||(f=fa.SKc());l?l!==fa&&(w=!0):l=fa}if(!f)return c;S=f.getContainingTable();if(!S)return c;if(w){b=new Ua.a;if(this.QHg){l=this.eAb.q0b(this.sa.Pa).pob;if(l.YOa())return c;for(w=l.ge;w<l.Tf;w++)b.add(w);za.a.J(41550553,822,50,"Insert {0} rows",b.count)}else if(b=this.CYi(F),
1!==b.count)return c;l=S.H9i(b.ga(0));for(w=0;w<b.count;w++)Array.add(a,Fc.a.create(Object(ua.a)(fg.a,l))),l=l.pGa}else{if(!b)for(b=l.rowSpan;0<--b;)f=f.pGa;Array.add(a,Fc.a.create(Object(ua.a)(fg.a,f)))}c.kC=a;c.TGb=Object(ua.a)(fg.a,f);c.Jo=Object(ua.a)(fg.a,S);c.wcb=a.length;if(this.Ha.Uu||!Cd.TableReader.gu(c.Jo))c.response=32;return c}W8i(a,b){const c=new Qt;c.response=8;if(!a)return c;var f=null,l=null,w=xi.ContextSetEditor.instance.lA(a);let F=!1;a=[];for(let fa=0;fa<w.length;++fa)if(w[fa].Ok){var S=
Object(ua.a)(5,w[fa].node);if(!S||!S.Nr())return c;S=S.nK();f||(f=S.q7f());l?l!==S&&(F=!0):l=S}if(!l)return c;f=f.getContainingTable();if(!f)return c;if(F){b=new Ua.a;if(this.QHg){l=this.eAb.q0b(this.sa.Pa).pob;if(l.YOa())return c;for(w=l.ae;w<l.Lf;w++)b.add(w);za.a.J(41550555,822,50,"Insert {0} columns",b.count)}else if(b=this.AYi(w),1!==b.count)return c;l=f.hf(0,b.ga(0));for(w=0;w<b.count;w++)Array.add(a,Fc.a.create(Object(ua.a)(fg.a,l))),l=l.bZ()}else b&&(l=f.hf(0,l.pi+l.colSpan-1)),Array.add(a,
Fc.a.create(Object(ua.a)(fg.a,l)));c.kC=a;c.TGb=Object(ua.a)(fg.a,l);c.Jo=Object(ua.a)(fg.a,f);c.wcb=a.length;if(this.Ha.Uu||!f.hp())c.response=32;return c}CYi(a){const b=new Ua.a,c=new wa.ScriptSharpLegacyMap;let f=0;for(let F=0;F<a.length;++F)if(a[F].Ok){var l=Object(ua.a)(5,a[F].node);if(l&&l.Nr()){f++;var w=l.nK();l=w.rowIndex;for(w=l+w.rowSpan;l<w;l++)if(c.Kb(l)){let S;c.$(S=l,c.ga(S)+1)}else c.add(l,1)}}for(let F of c.keys)c.ga(F)===f&&b.add(F);return b}AYi(a){const b=new Ua.a,c=new wa.ScriptSharpLegacyMap;
let f=0;for(let F=0;F<a.length;++F)if(a[F].Ok){var l=Object(ua.a)(5,a[F].node);if(l&&l.Nr()){f++;var w=l.nK();l=w.pi;for(w=l+w.colSpan;l<w;l++)if(c.Kb(l)){let S;c.$(S=l,c.ga(S)+1)}else c.add(l,1)}}for(let F of c.keys)c.ga(F)===f&&b.add(F);return b}Y8i(a){return Ln.a(a)}$8i(a){const b=new Qt;b.response=8;if(!a)return b;if(a.nl){var c=a.jYa;a=a.yha;if(!c||!a)return b;c=Object(ua.a)(123,c.currentNode);a=Object(ua.a)(123,a.currentNode);if(!c||!a)return b;var f=c.pi;a=a.pi;if(f>a){var l=f;f=a;a=l}}else{c=
dd.a.Snb(a);c=xi.ContextSetEditor.instance.lA(c);if(!c||1>c.length||!c[0].Ok)return b;c=Object(ua.a)(5,c[0].node);if(!c||!c.Nr())return b;c=c.nK();a=f=c.pi}l=this.wc.s0b(c);if(!l||14!==l.type||0>f||0>a)return b;const w=[];let F=l.hf(0,f);if(!F)return b;for(;f<=a;)Array.add(w,Fc.a.create(Object(ua.a)(fg.a,F))),F=F.bZ(),f++;b.kC=w;b.TGb=Object(ua.a)(fg.a,c);b.Jo=Object(ua.a)(fg.a,l);b.wcb=w.length;if(this.Ha.Uu||!l.hp())b.response=32;return b}d9i(a){const b=new Qt;b.response=8;if(!a)return b;if(a.nl){var c=
a.jYa;a=a.yha;if(!c||!a)return b;var f=kk.c(c);a=kk.c(a);c=Object(ua.a)(Pl.TableCellNode,c.currentNode);if(f>a){var l=f;f=a;a=l}}else{a=dd.a.Snb(a);a=xi.ContextSetEditor.instance.lA(a);if(!a||1>a.length||!a[0].Ok)return b;a=Object(ua.a)(5,a[0].node);if(!a||!a.Nr())return b;c=a.nK();a=f=c.rowIndex}if(!c)throw za.a.J(590956237,822,10,"TypeCasting to ITableCellNode failed"),Error.argumentNull("TypeCasting to ITableCellNode failed");l=c.getContainingTable();if(!l||14!==l.type||0>f||0>a)return b;const w=
[];let F=l.hf(f,0).SKc();for(;f<=a;)Array.add(w,Fc.a.create(Object(ua.a)(fg.a,F))),F=F.pGa,f++;b.kC=w;b.TGb=Object(ua.a)(fg.a,c);b.Jo=Object(ua.a)(fg.a,l);b.wcb=w.length;if(this.Ha.Uu||!Cd.TableReader.gu(b.Jo))b.response=32;return b}Hgj(a,b){if(a=Object(ua.a)(Pl.TableCellNode,a.currentNode)){if(b)for(b=a.colSpan;0<b--;)a=a.bZ();else a=a.M5a();a&&(b=a.getContainingTable().firstRow,a=a.getContainingTable().hf(b.rowIndex,a.pi),a=a.ly(),mb.GraphIterator.nb(Object(ua.a)(fg.a,a)))}}c0d(a,b,c){const f=new Qt;
f.response=8;if(!a||!c||!c.Pa)return f;const l=[],w=[];c=c.Pa;if(c.nl){if(c=this.eAb.q0b(c))if(a=c.pob,c=c.tableNode.firstRow,b)for(b=0;b<=a.Zae;b++){var F=c.rowIndex;F>=a.V2f&&F<=a.Zae&&l.push(c);c=c.pGa}else for(b=c.N2f,c=0;c<=a.Rae;c++)F=b.pi,F>=a.O2f&&F<=a.Rae&&w.push(b),b=b.bZ()}else for(a=xi.ContextSetEditor.instance.lA(a),c=0;c<a.length;++c)if(a[c].Ok){F=Object(ua.a)(5,a[c].node);if(!F||!F.Nr())return f;var S=F.nK();if(b)for(F=S.rowSpan,S=S.SKc();0<F--;)Array.contains(l,S)||l.push(S),S=S.pGa;
else for(F=S.colSpan,S=S.q7f();0<F--;)Array.contains(w,S)||w.push(S),S=S.bZ()}if(!l.length&&!w.length)return f;b=[];for(a=0;a<l.length;a++)Array.add(b,Fc.a.create(Object(ua.a)(fg.a,l[a])));for(a=0;a<w.length;a++)Array.add(b,Fc.a.create(Object(ua.a)(fg.a,w[a])));f.kC=b;f.TGb=0<l.length?Object(ua.a)(fg.a,l[0]):Object(ua.a)(fg.a,w[0]);f.Jo=0<l.length?Object(ua.a)(fg.a,l[0].getContainingTable()):Object(ua.a)(fg.a,w[0].getContainingTable());if(this.Ha.Uu||!Object(ua.a)(182,f.Jo).hp())f.response=32;return f}Tzj(a){if(!a.kC)return!1;
for(let c=0;c<a.kC.length;c++){var b=Object(ua.a)(Fc.a,a.kC[c]);if(b&&(b=Object(ua.a)(156,b.node))){b=this.wc.A6a(b);for(const f of b)if(f&&f.Ztb)return!0}}return!1}Szj(a){if(!a.kC)return!1;var b=Object(ua.a)(182,a.Jo);if(!b)return!1;var c=Object(ua.a)(Fc.a,a.kC[0]);if(!c)return!1;c=Object(ua.a)(123,c.node);if(!c)return!1;c=Object(ua.a)(mb.GraphIterator,this.Ib.Jc(c));c.oc(14);b=this.wc.Zj(b);a=a.kC.length;const f=new mb.GraphIterator;f.Pc(c);for(let l=0;l<b;l++){for(let w=0;w<a;w++){const F=Object(ua.a)(123,
c.currentNode);if(F&&F.Ztb)return!0;c.xf(1)}Fd.moveToNextRow(f);c.Pc(f)}return!1}Dsb(a){let b=null;a&&14===a.type&&(b=this.wc.h1d(a.firstRow));return b}YNe(a,b,c,f,l){var w=ku.QCa(a);a=ku.QCa(a,!0);if(w||a)w=this.MDa.jn(c.$b-c.fc),c=this.MDa.jn(c.Xb-c.ic),f._x+=this.MDa.jn(l.right),f._y+=this.MDa.jn(l.bottom),b.setPosition(f.x-w,f.y-c,!0)}u$i(){var a=null;const b=this.ua.Ca;var c=this.sa.jy();if(qd.a("FixColorPickerSelectedColor")){if(!c||!c.length){if(c=this.sa.Mo())a=c.hf(0,0),a=If.Box4ColorHelper.EBa(a.cellShading.solidFillField,
b.Ye);return a}(c=c[0])&&(a=c.cellShading&&c.cellShading.solidFillField?If.Box4ColorHelper.EBa(c.cellShading.solidFillField,b.Ye):this.Rz.AKc(Object(ua.a)(fg.a,c)))}return a}static HLi(a,b,c,f,l,w){const F=Kc.a.Nm("HandleSelectTableBorderType");F.Ya("CommandId",a.toString());F.Ya("BorderType",b);F.Ya("BorderWidth",c);F.Ya("BorderColor",f);F.Ya("CommandLocation",l);try{return w()}finally{F.finish(!0)}}static QCa(a,b=!1){return a.equals(ge.a.nu)?!0:b?a.equals(ge.a.north)||a.equals(ge.a.JD):a.equals(ge.a.west)||
a.equals(ge.a.bH)}}Object(e.a)(ku,"TableActor",null,[234]);class Ev{constructor(){this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0}}Object(e.a)(Ev,"TableCellMargin",null,[]);class Fv{constructor(a,b,c,f,l,w,F,S){this.YFa=null;this.x_c=0;this.dzl=ke.a.S9c(2);this.WTf=Object.assign(new Ev,{marginTop:.05,marginBottom:.05,marginLeft:.1,marginRight:.1});this.VTf=Object.assign(new Ev,{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0});this.UTf=Object.assign(new Ev,{marginTop:.05,
marginBottom:.05,marginLeft:.05,marginRight:.05});this.fUf=Object.assign(new Ev,{marginTop:.15,marginBottom:.15,marginLeft:.15,marginRight:.15});this.Iyh=Object.assign(new Ev,{marginTop:-1,marginBottom:-1,marginLeft:-1,marginRight:-1});if(a)if(b)if(c)if(f)if(l)if(w){if(!F)throw za.a.J(571076832,822,50,"Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null");if(!S)throw za.a.J(571076833,
822,50,"Table Cell Margin Actor constructor argument:pageView cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:pageView cannot be null");}else throw za.a.J(573933332,822,50,"Table Cell Margin Actor constructor argument:tableReader cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:tableReader cannot be null");else throw za.a.J(574484871,822,50,"Table Cell Margin Actor constructor argument:selectionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:selectionManager cannot be null");
else throw za.a.J(574484870,822,50,"Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null");else throw za.a.J(574484869,822,50,"Table Cell Margin Actor constructor argument:transactionFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:transactionFactory cannot be null");else throw za.a.J(574484868,822,50,"Table Cell Margin Actor constructor argument:applicationSettings cannot be null"),
Error.argumentNull("Table Cell Margin Actor constructor argument:applicationSettings cannot be null");else throw za.a.J(574484867,822,50,"Table Cell Margin Actor constructor argument:actionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:actionManager cannot be null");this.ia=a;this.Ha=b;this.Jb=c;this.ua=f;this.sa=l;this.wc=w;this.fYj=F.yOd(50,Object(C.a)(this,this.O2a,"applyPendingChangesToServerIfRequired"));this.Pb=S}wb(){this.ia.ra(aa.a.Eth,Db.a.view,
Object(C.a)(this,this.j1b,"handleTableCellMargins"),4);this.ia.ra(aa.a.Xid,Db.a.tableCell,Object(C.a)(this,this.j1b,"handleTableCellMargins"),4);this.ia.ra(aa.a.gBe,$b.a.application,Object(C.a)(this,this.rOc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(aa.a.Wid,Db.a.tableCell,Object(C.a)(this,this.j1b,"handleTableCellMargins"),4);this.ia.ra(aa.a.fBe,$b.a.application,Object(C.a)(this,this.rOc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(aa.a.Vid,Db.a.tableCell,Object(C.a)(this,this.j1b,
"handleTableCellMargins"),4);this.ia.ra(aa.a.eBe,$b.a.application,Object(C.a)(this,this.rOc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(aa.a.Zid,Db.a.tableCell,Object(C.a)(this,this.j1b,"handleTableCellMargins"),4);this.ia.ra(aa.a.hBe,$b.a.application,Object(C.a)(this,this.rOc,"handleQueryTableCellDefaultMargins"),96);this.ia.ya(aa.a.Xid,Db.a.view,wc.Pha);this.ia.ya(aa.a.Wid,Db.a.view,wc.Pha);this.ia.ya(aa.a.Vid,Db.a.view,wc.Pha);this.ia.ya(aa.a.Zid,Db.a.view,wc.Pha);this.ia.ra(aa.a.qlc,
Db.a.view,Object(C.a)(this,this.yOc,"handleTableCellCustomMargins"),4);this.ia.ra(aa.a.Hgc,Db.a.view,Object(C.a)(this,this.qOc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(aa.a.rlc,Db.a.view,Object(C.a)(this,this.yOc,"handleTableCellCustomMargins"),4);this.ia.ra(aa.a.Igc,Db.a.view,Object(C.a)(this,this.qOc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(aa.a.slc,Db.a.view,Object(C.a)(this,this.yOc,"handleTableCellCustomMargins"),4);this.ia.ra(aa.a.Jgc,Db.a.view,Object(C.a)(this,this.qOc,
"handleQueryTableCellCustomMargins"),96);this.ia.ra(aa.a.plc,Db.a.view,Object(C.a)(this,this.yOc,"handleTableCellCustomMargins"),4);this.ia.ra(aa.a.Ggc,Db.a.view,Object(C.a)(this,this.qOc,"handleQueryTableCellCustomMargins"),96)}Fe(){}j1b(a,b,c,f,l){return this.Zmh(a)?1===c?32:ug.a("HandleTableCellMargins:Entry point:"+this.ia.$p,a,()=>{if(!l)return za.a.J(574633615,822,50,"HandleTableCellMargins: actionData cannot be null"),16;if(!b||!b.node)return za.a.J(574633616,822,50,"HandleTableCellMargins: Either node context is null or unable to extract Table cell node from context"),
16;const w=b.node,F=this.zMi(a);if(!F)return za.a.J(574633617,822,50,"HandleTableCellMargins: unable to get Table cell margins"),16;const S=this.Jb.ie(15);S.lc(w);S.fd=a;this.VEf(w,F);S.dispose();za.a.J(573854363,822,50,"HandleTableCellMargins: EntryPoint={1} ActionId={2}",this.ia.$p,a);return 32}):(za.a.J(574633614,822,50,"HandleTableCellMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}rOc(a,b,c,f,l){if(!this.Ha.MHb)return 8;b=Object(ua.a)(Kh.a,l);if(!b)return 16;f=this.sa.Mo();if(!f)return za.a.J(574128351,
822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid tableNode"),16;c=this.sa.jy();if(!c)return 16;c.length||(c=this.wc.PE(f));if(!c||!c.length)return za.a.J(574128352,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid cellNodes"),16;f=!1;switch(a){case aa.a.gBe:f=this.OKc(c,this.WTf);break;case aa.a.fBe:f=this.OKc(c,this.VTf);break;case aa.a.eBe:f=this.OKc(c,this.UTf);break;case aa.a.hBe:f=this.OKc(c,this.fUf)}b.Yf(f);return 32}OKc(a,b){for(const c of a)if(c&&!c.isGhostCell&&
(ke.a.kv(c.marginTop)!==b.marginTop||ke.a.kv(c.marginBottom)!==b.marginBottom||ke.a.kv(c.marginLeft)!==b.marginLeft||ke.a.kv(c.marginRight)!==b.marginRight))return!1;return!0}zMi(a){let b=Ik.b(this.Iyh);switch(a){case aa.a.Xid:b=this.WTf;break;case aa.a.Wid:b=this.VTf;break;case aa.a.Vid:b=this.UTf;break;case aa.a.Zid:b=this.fUf}return b}VEf(a,b){0<=b.marginLeft&&(a.marginLeft=ke.a.xV(b.marginLeft));0<=b.marginRight&&(a.marginRight=ke.a.xV(b.marginRight));0<=b.marginTop&&(a.marginTop=ke.a.xV(b.marginTop));
0<=b.marginBottom&&(a.marginBottom=ke.a.xV(b.marginBottom))}M5h(a,b){b=Math.max(ke.a.xV(this.dzl+b.marginLeft+b.marginRight),a);sg.a.ry(b,a)||(a={},a.Number=ke.a.kv(b),this.ia.Ma(aa.a.IXa,2,a))}Zmh(a){if(!this.ua.Ca)return!1;const b=this.sa.Dq();return!!b&&b.rd&&(this.Ha.MHb&&Array.contains(Fv.VTk,a)||this.Ha.Hgb&&Array.contains(Fv.fUk,a))}qOc(a,b,c,f,l){if(!this.Ha.Hgb)return 8;b=this.sa.Mo();if(!b)return za.a.J(572383943,822,50,"HandleQueryTableCellCustomMargins: unable to get valid tableNode"),
16;c=this.sa.jy();if(!c)return za.a.J(572383514,822,50,"HandleQueryTableCellCustomMargins: unable to get selected table cells"),16;c.length||(c=this.wc.PE(b));if(!c||!c.length)return za.a.J(572383944,822,50,"HandleQueryTableCellCustomMargins: unable to get valid cellNodes"),16;b=this.E$i(c,a);this.sjc(l,ke.a.kv(b));za.a.J(572383945,822,50,"HandleQueryTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.$p,a);return 32}E$i(a,b){let c=-1,f=-1;for(const l of a)if(l&&!l.isGhostCell){switch(b){case aa.a.Hgc:c=
l.marginLeft;break;case aa.a.Igc:c=l.marginRight;break;case aa.a.Jgc:c=l.marginTop;break;case aa.a.Ggc:c=l.marginBottom}if(0<=f&&f!==c)return-1;f=c}return c}sjc(a,b){a=a.queryResult;null!==a&&(a.xea=parseFloat(b.toFixed(2)).toString())}yOc(a,b,c,f,l){return this.Zmh(a)?1===c?32:ug.a("HandleTableCellCustomMargins:Entry point:"+this.ia.$p,a,()=>{if(!l)return za.a.J(571786112,822,50,"HandleTableCellCustomMargins: actionData cannot be null"),16;const w=this.sa.Mo();if(!w)return za.a.J(571786113,822,50,
"HandleTableCellCustomMargins: unable to get valid tableNode"),16;let F=this.sa.jy();if(!F)return za.a.J(571786114,822,50,"HandleTableCellCustomMargins: unable to get selected table cells"),16;F.length||(F=this.wc.PE(w));this.rgk(a,F,l);za.a.J(571786116,822,50,"HandleTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.$p,a);return 32}):(za.a.J(571786083,822,50,"HandleTableCellCustomMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}rgk(a,b,c){this.x_c!==a&&(this.O2a(),this.x_c=
a);this.YFa||(this.YFa=[]);ug.a("OnCustomMarginChange:Entry point:"+this.ia.$p,a,()=>{for(let l=0;l<b.length;l++){var f=b[l];if(!f||!f||f.isGhostCell)continue;const w=Object(ua.a)(Us,f.pc(this.Pb.Na));if(w){this.YFa[l]||(this.YFa[l]=new Nw.a(f,this.Hcj(f)));f=this.YFa[l];switch(a){case aa.a.qlc:f.second.marginLeft=c.Number;break;case aa.a.rlc:f.second.marginRight=c.Number;break;case aa.a.slc:f.second.marginTop=c.Number;break;case aa.a.plc:f.second.marginBottom=c.Number}w.yZk(f.second,a)}}return 32});
this.fYj.perform()}O2a(){this.Ha.Hgb&&this.YFa&&this.YFa.length&&(ug.a("ApplyPendingChangesToServerIfRequired:Entry point:"+this.ia.$p,this.x_c,()=>{const a=this.Jb.ie(15);try{a.fd=this.x_c;let b=null;for(const c of this.YFa)b||(b=c.first.getContainingTable(),a.lc(b)),this.VEf(c.first,c.second),this.M5h(c.first.width,c.second);a.dispose()}finally{a&&a.dispose()}return 32}),this.YFa=null)}Hcj(a){const b=Ik.b(this.Iyh);b.marginLeft=ke.a.kv(a.marginLeft);b.marginRight=ke.a.kv(a.marginRight);b.marginTop=
ke.a.kv(a.marginTop);b.marginBottom=ke.a.kv(a.marginBottom);return b}}Fv.VTk=[aa.a.Eth,aa.a.Xid,aa.a.Wid,aa.a.Vid,aa.a.Zid];Fv.fUk=[aa.a.qlc,aa.a.rlc,aa.a.slc,aa.a.plc];Object(e.a)(Fv,"TableCellMarginActor",null,[234]);class Cq{constructor(a,b,c,f,l,w,F,S){this.em=this.tac=null;this.MOg=0;this.aZc=!1;this.Hle=this.Fpe=this.gPg=this.ZBg=this.fPg=this.YBg=null;this.Rz=a;this.Fk=b;this.Tie=c;this.jda=f;this.Mpe=l;this.V6j=w;this.Q6j=F;this.RTa=S}Chl(a,b){const c=new Sys.StringBuilder('<div class="PreviewStyleContainer" aria-hidden="true" style="display:table-cell; text-align:center; vertical-align:middle;">');
this.G5d(a,b);try{c.append(String.format('<table class="TableStylePreview" style="background:{0}">',this.Fk.Anb(this.Fk.DYd(this.tac),this.em)));for(a=0;5>a;a++){c.append("<tr>");for(b=0;5>b;b++){const f=this.Fpe.tXd(a,b,1,1),l=this.Z8f(this.Hle,this.em,a,b),w=this.Fk.Anb(f.Sa(zb.a.cellShading)?f.Uh(zb.a.cellShading):rl.a.Gpb,this.em),F=new Sys.StringBuilder;for(let S=0;S<Cq.m6b.length;S++){let fa=null,xa=null;({c3a:fa,Inb:xa}=Wp.$Pa(Cq.xWc[S]));const Za=f.ta(fa,rl.a.KFc),pb=f.ta(xa,rl.a.Epb);F.append(Cq.m6b[S]);
if(Za.xC===Jb.a.auto){const Mb=this.Fk.oXd(.0277777777777778);F.append(String.format("inset {0}px transparent",Mb))}else F.append(this.Fk.AWd(pb,.0277777777777778,Za));F.append(";")}c.append(String.format('<td style="color: {0}; background-color: {1}; {2}">',l,w,F));c.append("<div>&#x2014;</div>");c.append("</td>")}c.append("</tr>")}c.append("</table></div>")}finally{this.aZc&&this.Heh()}return c.toString()}oXi(a,b){const c=[];this.G5d(a,b);try{for(a=0;5>a;a++)for(b=0;5>b;b++){const f={},l=this.Fpe.tXd(a,
b,1,1),w=this.Z8f(this.Hle,this.em,a,b);f.color=w;const F=this.Fk.Anb(l.Sa(zb.a.cellShading)?l.Uh(zb.a.cellShading):rl.a.Gpb,this.em);f["background-color"]=F;f.overflow="visible";for(let S=0;S<Cq.m6b.length;S++){let fa=null,xa=null,Za=null;({d3a:fa,c3a:xa,Inb:Za}=Wp.$Pa(Cq.xWc[S]));let pb;if(this.RTa){const Hc=If.Box4ColorHelper.q0({Color:"##T,0,0,0"}),Dc=mk.a.Bi(l,xa,Hc),Td=If.Box4ColorHelper.Fwa(Dc),we=If.Box4ColorHelper.CL(Td,this.em);pb=we?If.Box4ColorHelper.dna(we):null}else pb=l.ta(xa,rl.a.KFc);
const Mb=l.ta(Za,rl.a.Epb),hc=Cq.m6b[S].substring(0,Cq.m6b[S].length-1),kc=l.ta(fa,rl.a.Fpb),Ec=this.RTa&&qd.a("TableBordersLocalRenderingFix");if(Ec&&!kc||!Ec&&pb.xC===Jb.a.auto){const Hc=this.Fk.oXd(.0277777777777778);f[hc]=String.format("inset {0}px transparent",Hc)}else f[hc]=this.Fk.AWd(Mb,.0277777777777778,pb)}c.push(f)}}finally{this.aZc&&this.Heh()}return c}pNc(a,b){this.G5d(a,b);a={};a.background=this.Fk.Anb(this.Fk.DYd(this.tac),this.em);return a}G5d(a,b){this.tac=this.jda.l0b(a).vua;this.MOg=
this.Rz.OZd(b);this.em=this.Tie.Scg(b).Ye;this.aZc=this.qpj(this.tac);this.YBg=this.em.PresetSchemeColorMapping.Background1;this.fPg=this.em.PresetSchemeColorMapping.Text1;this.ZBg=this.em.PresetSchemeColorMapping.Background2;this.gPg=this.em.PresetSchemeColorMapping.Text2;this.aZc&&(this.em.PresetSchemeColorMapping.Background1=this.em.PresetSchemeColorMapping.Light1,this.em.PresetSchemeColorMapping.Text1=this.em.PresetSchemeColorMapping.Dark1,this.em.PresetSchemeColorMapping.Background2=this.em.PresetSchemeColorMapping.Light2,
this.em.PresetSchemeColorMapping.Text2=this.em.PresetSchemeColorMapping.Dark2);a=this.Mpe(()=>5,()=>5,()=>this.MOg,()=>null,()=>this.em,()=>this.tac);this.Fpe=this.V6j(a);this.Hle=this.Q6j(a)}Heh(){this.em.PresetSchemeColorMapping.Background1=this.YBg;this.em.PresetSchemeColorMapping.Text1=this.fPg;this.em.PresetSchemeColorMapping.Background2=this.ZBg;this.em.PresetSchemeColorMapping.Text2=this.gPg}qpj(a){if(a.tblBgField&&a.tblBgField.fillField)return!1;if(!a.wholeTblField||!a.wholeTblField.tcStyleField)return!0;
a=a.wholeTblField.tcStyleField.fillField;return!a||a.noFillField?!0:!1}Z8f(a,b,c,f){let l="black";a&&(l=a.R7f(b,c,f,1,1).cU());return l}}Cq.m6b=["border-top:","border-left:","border-bottom:","border-right:"];Cq.xWc=[7,5,0,6];Object(e.a)(Cq,"TableStylePreviewGenerator",null,[350]);class GE extends Qx{constructor(){super()}get Type(){return 6}}Object(e.a)(GE,"TableStyleGalleryButtonProps",Qx,[]);class HE{}HE.Rck=2147483647;Object(e.a)(HE,"TableStyleUtil",null,[]);class Zo{constructor(a,b,c,f,l){this.cMd=
"Clear";this.X4a=null;this.Slb=a;this.c3e=c;this.d3e=f;this.SKh=l;this.XCd=b;this.bN=u.AFrameworkApplication.bN;this.Rl=u.AFrameworkApplication.Rl}gYb(){}hZh(a,b){this.gYb();const c=this.SWd(),f=c.length;if(!(0>=f)){var l=HE.Rck,w=null;for(let xa=0;xa<f;xa++){var F=c[xa],S=this.SKh(F);l!==S&&(l=Object.assign(new nk.a,{Id:"msMoreTableStyles"+S,Title:this.Tcj(S),ControlList:[]}),w=Object.assign(new qq.a,{Type:6,Id:"galleryMoreTableStyles"+S,ExternalGalleryId:"TableStylesGallery",Width:Zo.ssh,ElementDimensions:"Size64by48",
GalleryItems:[]}),u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.Ip&&this.X4a&&(w.ExternalId=this.X4a[S.toString()]),Array.add(l.ControlList,w),Array.add(b.MenuSectionList,l),l=S);var fa=this.d3e(F);F=Zo.iOe+xa;S=!!u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.Ip;fa=Object.assign(new GE,{Id:F,ExternalId:F,Command:"4171428777",QueryCommand:"2135594455",LabelText:fa?Ja.a.le(fa):"",Alt:S?fa:null,VerticalCenterAlign:"true"});S&&(fa.TableCellStyles=this.Gdg(F,a),fa.TableStyles=this.pNc(F,
a));w&&w.GalleryItems.push(fa)}}}fZh(a){const b=Object.assign(new nk.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),c=Object.assign(new Of.a,{Id:"fseaClearTableFormatting",Command:"3835123874",LabelText:Ja.a.le(this.cMd),Alt:Ja.a.le(this.cMd),Image16by16:this.Rl,Image16by16Class:rp.getImageClassWithCluster(this.bN,Zo.Jli),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});Array.add(b.ControlList,c);Array.add(a.MenuSectionList,b)}Mvi(a,
b){this.gYb();const c=a[Uh.a.SourceControlId],f=this.gjd(c,b);if(f){var l=this.Slb.R0d(b);l=l?this.c3e(l):null;var w=this.d3e(f),F=this.c3e(f);a[cm.a.Alt]=w;a[cm.a.On]=F===l;u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.Ip?(b=Object.assign(new GE,{Id:c,ExternalId:c,Command:"4171428777",QueryCommand:"2135594455",TableCellStyles:this.Gdg(c,b),TableStyles:this.pNc(c,b),Alt:w}),a[cm.a.GalleryButtonProps]=b):(b=this.XCd.Chl(f,b),a[cm.a.InnerHTML]=b)}else a[cm.a.InnerHTML]=null,a[cm.a.Alt]=
null,a[cm.a.On]=!1,a[cm.a.GalleryButtonProps]=null}Gdg(a,b){this.gYb();return(a=this.gjd(a,b))?this.XCd.oXi(a,b):null}pNc(a,b){this.gYb();return(a=this.gjd(a,b))?this.XCd.pNc(a,b):null}Twi(a,b){u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.Ip?a.MenuItems=this.$$f(b):a.PopulationXML=$i.l(this.$$f(b))}$$f(a){const b=Object.assign(new Kl.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.hZh(a,b);this.fZh(b);return b}gjd(a,b){return a?a.startsWith(Zo.iOe)?this.ecj(parseInt(a.substr(Zo.iOe.length))):
this.HRk(parseInt(a.substr(Zo.Ahl.length)),b):null}}Zo.iOe="buttonTableStyleMenu";Zo.Ahl="buttonTableStyleRibbon";Zo.ssh=7;Zo.Jli="ClearTableStyle_16x16x32";Object(e.a)(Zo,"ATableStyleRibbonControl",null,[351]);class DN extends Zo{constructor(a,b,c,f,l){super(a,l,Object(C.a)(f,f.ccj,"getStyleIdFromStyleContainer"),Object(C.a)(f,f.dcj,"getStyleNameFromStyleContainer"),Object(C.a)(f,f.Xbj,"getStyleCatogeryFromStyleContainer"));this.Rz=a;this.jda=f;this.cMd=ResourceStrings.L_ClearTableStyle;this.bN=
nf.a.y9c;this.Rl=c.rk(nf.a.oxe);this.Dtk()}Tcj(a){switch(a){case 1:return ResourceStrings.L_Themed;case 2:return ResourceStrings.L_Light;case 3:return ResourceStrings.L_Medium;case 4:return ResourceStrings.L_Dark;case 5:return ResourceStrings.L_Customize;default:return ResourceStrings.L_Customize}}HRk(a,b){let c=null;(b=this.Rz.t0b(b))&&(c=this.jda.Jdg(b.styleIdField));return c?this.jda.Ubj(c.KCg,c.TGg-c.TGg%Zo.ssh+a):this.jda.Bsb(a)}SWd(){return this.jda.SWd()}ecj(a){return this.jda.Bsb(a)}gYb(){this.jda.oZf()}Dtk(){this.X4a=
{};this.X4a["1"]="TableStylesBestMatch";this.X4a["2"]="TableStylesLight";this.X4a["3"]="TableStylesMedium";this.X4a["4"]="TableStylesDark"}}Object(e.a)(DN,"TableStyleRibbonControls",Zo,[]);class EN{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc){this.rD=this.SUa=null;this.ia=a;this.Df=b;this.Ha=c;this.Ga=f;this.sa=l;this.gv=w;this.Zd=F;this.e6b=S;this.Pb=fa;this.Fa=xa;this.Ue=Za;this.Vca=Mb;this.wc=hc;this.hda=kc;this.dVa=Hc;this.Iz=pb;Ec.execute(Td=>{this.SUa=Td});this.Ha.gP&&Dc.execute(Td=>
{this.rD=Td})}get Ce(){return this.Zd.instance}get zE(){return this.e6b.value}wb(){this.ia.ra(aa.a.YGf,$b.a.application,Object(C.a)(this,this.Khj,"handleBeginEditShapeTextByF2"),4);this.ia.ra(aa.a.wTb,$b.a.application,Object(C.a)(this,this.Jhj,"handleBeginEditShapeText"),4);this.ia.ra(aa.a.cNa,Db.a.view,Object(C.a)(this,this.Lhj,"handleBeginEditShapeTextForShapeMoniker"),5)}Fe(){const a=this.Ga.Bc(Xd.a.sg),b=this.Ga.Bc(Ai.a.VU);a.bindAction(A.KeyInputManager.La(x.a.aoc,0),aa.a.YGf);a.bindAction(A.KeyInputManager.La(x.a.Xp,
0),aa.a.wTb);b.bindAction(A.KeyInputManager.La(x.a.aoc,0),aa.a.Y$h)}Jhj(a,b,c){if(this.hda&&this.hda.isVisible())return za.a.J(40735957,820,50,"The slideless pane is shown, hide and replace it with new slide on default master by VK_Enter."),this.hda.hide(2,!0),32;if(1===c&&this.sa.gRa())return 2;a=this.sa.Dq();if(!a)return 16;b=Object(ua.a)(4,a.u1i(qd.a("EnableRetrieveFirstIcon")));if(a.get_smartArtModelId())a=this.Fa.Lr(a);else{if(a.fg&&b)return this.ia.Ma(aa.a.aYa,c,b);if(a.Xf){var f=this.Fa.my(a);
if(0<f.length)return this.ia.Ma(aa.a.aYa,c,f[0])}else if(this.Ha.gP&&1===a.mediaType&&!a.xh&&this.rD)return(f=this.rD.OH(a))&&f.setFocusOnPlayer(),32}return this.ia.Ma(aa.a.cNa,c,new Jn.a(a,!1))}Khj(a,b,c){a=this.sa.Dq();if(!a)return 16;a.get_smartArtModelId()&&(a=this.Fa.Lr(a));return this.ia.Ma(aa.a.cNa,c,new Jn.a(a,!1))}Lhj(a,b,c,f,l){if(!l||!Object(Ca.a)(Jn.a,l))return za.a.J(8956046,820,10,"Invalid ActionData"),8;a=l.shapeNode;if(!a||!(a.isEditable&&!a.wda||a.ar)||this.Df.gd(a))return 16;if(1===
c)return 32;a.rd&&(c=this.wc.ZM(a),c=!!c&&c.hp(),za.a.J(41007122,820,50,"Entering table edit mode, isComplexTable:{0}",c),this.ia.processAction(aa.a.L3a,2));if(a.ar){if(this.zE&&this.Ce)return l=this.zE.M1(a),this.Ce.notifyAgave(l.id,11),32;za.a.J(18989144,820,10,"AppForOffice package should have already been loaded.");return 8}c=a.yg(this.Pb.Na);if(!c)return 16;this.SUa&&this.SUa.sUd(a,!0);this.dVa&&this.Ha.$Xk&&this.dVa.ping();Kc.a.Db&&(Kc.a.Db.actionName="BeginEditShapeText",(a.Xf||a.xh)&&On(a));
if(this.Iz&&a.fg&&c.sK())Kc.a.ik(lh.a.Fyc,"false"),this.Ue.HBe(new ux.a(a));else{this.Ga.vf(Xd.a.sg,l.z6k);this.gv.Mv();c.LLe();if(a.rd&&l.$Cc&&(c=this.wc.ZM(a))&&c.hp())return(a=this.Vca.YUd(l.$Cc.clientPoint,c,null,null))?(c=a.pc(this.Pb.Na),this.Pb.f5(l.$Cc.clientPoint,c,a,this.Pb,!1,!1,0),32):8;a.xh&&(c=this.Fa.ys(a))&&(c=c.yg(this.Pb.Na))&&c.Jd&&c.Jd.KFb(!0);this.Pb.EWk(a,l.$Cc)}return 32}}Object(e.a)(EN,"TextEditorLaunchingActor",null,[234]);class IE{constructor(a,b,c,f,l,w,F,S){this.ia=a;this.Ga=
b;this.Fa=c;this.fv=f;this.Df=l;this.sa=w;this.CTa=F;this.Zh=S}wb(){this.ia.ya(aa.a.qii,$b.a.application,Object(C.a)(this,this.Whj,"handleChangeCaseMenu"));this.ia.ya(aa.a.tye,$b.a.application,Object(C.a)(this,this.tlj,"handlePowerPointInsertHyperlink"));this.ia.ra(aa.a.clearFormatting,$b.a.application,Object(C.a)(this,this.gij,"handleClearFormatting"),4)}Fe(){this.Ga.Bc(Xd.a.QM).bindAction(A.KeyInputManager.La(x.a.wO,2),aa.a.clearFormatting)}Whj(){var a=this.sa.Pa.kb;return a&&(a=a.Wa)&&(a.contextId===
Db.a.Ff||a.contextId===Db.a.textRange)?32:this.kCh(!0)?32:8}tlj(a,b,c,f,l){return(a=this.sa.Pa.kb)&&this.sa.oEj()?8:!a||this.sa.RRa()&&!IE.u4b(a)?8:this.ia.Ma(aa.a.insertHyperlink,c,l)}gij(a,b,c){if(!this.kCh(!1))return 16;a=this.sa.Pa.kb;if(!a)return 8;2===c&&this.Zza(a);return 32}Zza(a){za.a.J(593892321,820,50,"TextOperationsActor: Clear Formatting Triggered");var b=this.sa.he();let c;if((c=this.Eaj(b))&&c.length){if(1===c.length){b=a.Wa;if(!b){za.a.J(594614167,820,50,"TextOperationsActor: ClearCharacterFormatting - Could not create GraphNodeContext");
return}if(b.contextId===Db.a.Ff){this.C7h(b,c[0]);return}if(b.contextId===Db.a.textRange||b.contextId===Db.a.paragraph){this.E7h(a,c);return}}this.D7h(c)}else b.length?this.ZDc(b)?za.a.J(593892317,820,50,"ClearFormatting on table(s)"):za.a.J(593892315,820,50,"ClearFormatting attempted on non table and non text formattable shape"):za.a.J(593892319,820,50,"ClearFormatting triggered when nothing selected")}Eaj(a){a=this.Fa.eZ(a,!1);const b=[];let c=!0;for(const f of a)f.Xf&&(c=!1,1!==a.length&&this.q5k(f,
a)?b.push.apply(b,this.Tah(f,a,!1)):b.push.apply(b,this.Tah(f,a,!0)));return c?a:b}q5k(a,b){for(const c of b)if(c&&!c.Xf&&(b=c.ys(),!b||a!==b))return!1;return!0}Tah(a,b,c=!1){const f=[];for(const l of b)if(l!==a)f.push(l);else if(c){const w=this.Fa.eZ(this.sa.iO(b),!1);f.push.apply(f,w)}return f}D7h(a){this.fv.S4a(b=>{this.xHe(b,0,this.waj(b))},a)}E7h(a,b){const c=a.Wa,f=this.V9f(c,b[0]);if(c.contextId===Db.a.paragraph||-1!==f){var l=this.udj(a);this.fv.S4a(w=>{this.xHe(w,f,l)},b)}}C7h(a,b){const c=
this.CTa.W_b(a);if(c){var f=c.Wa,l=this.V9f(a,b)+f.Qa;this.fv.S4a(w=>{this.xHe(w,l,f.Lb-f.Qa)},[b])}}xHe(a,b,c){a.ke(zb.a.clearFormatting,!0);a.ke(zb.a.cPe,b);a.ke(zb.a.bPe,c)}V9f(a,b){let c=0,f=!1;if(!this.Zh.Pd(a.node))return-1;const l=a.node;this.Fa.RI(b,w=>{w===l?f=!0:f||(c+=this.Zh.textLength(w)+1)});return f?a.contextId===Db.a.paragraph||a.contextId===Db.a.Ff?c:c+a.Qa:-1}udj(a){let b=0;for(let c=0;c<a.length;c++){const f=a.ga(c);f.contextId===Db.a.textRange?b+=f.Lb-f.Qa:f.contextId===Db.a.paragraph?
b+=this.Zh.textLength(f.node)+1:f.contextId===Db.a.endOfParagraph&&b++}return b}waj(a){let b=0;if(a.FA)return 1;this.Fa.RI(a,c=>{b+=this.Zh.textLength(c)+1});return b}ZDc(a){for(const b of a)if(b.rd)return!0;return!1}kCh(a){const b=this.sa.he();if(!b||1>b.length)return!1;const c=this.sa.Mo();if(c&&!a&&1===b.length)return!1;a=this.Fa.eZ(b);return 1>a.length&&!c||this.Df.OB(a)||this.Df.OB([c])?!1:!0}static u4b(a){if(1===a.length)return!0;if(2===a.length){const b=a.Wa;a=a.ga(1);return!(!Cb.SelectionEditor.Oj(b)||
!Cb.SelectionEditor.Bl(a)||b.node!==a.node)}return!1}}Object(e.a)(IE,"TextOperationsActor",null,[234]);class JE{GQd(a,b,c){return 1===c?32:JE.SCi(b.node)}static SCi(a){const b=new mb.GraphIterator;b.set(a);b.uv();if(lg.b(b))return 2;a=new Oe.GraphTransaction(7);a.Ry(b);b.Hi();a.dispose();return 32}}Object(e.a)(JE,"DeleteOutlineLevelContentStrategy",null,[]);class gl{constructor(){this.LIh=new JE}wb(a){const b=Object(C.a)(this.VFc,this.VFc.HQd,"deleteView"),c=Object(C.a)(this,this.GQd,"deleteOutlineLevelContent"),
f=Object(C.a)(this.CUf,this.CUf.TCi,"deleteParagraphContent");a.ya(D.a.backspace,Db.a.Ff,f);a.ya(D.a.backspace,Db.a.textRange,f);a.ya(D.a.backspace,Db.a.endOfParagraph,Le.ActionManager.Ju);a.ya(D.a.backspace,Db.a.outline,c);a.ya(D.a.backspace,Db.a.view,b);a.$d(D.a.backspace,1124);a.ya(D.a.IAa,Db.a.Ff,Le.ActionManager.Ju);a.ya(D.a.IAa,Db.a.textRange,f);a.ya(D.a.IAa,Db.a.endOfParagraph,Le.ActionManager.Ju);a.ya(D.a.IAa,Db.a.outline,c);a.ya(D.a.IAa,Db.a.view,b);a.ra(D.a.vpb,Db.a.view,b,1124);a.ya(D.a.dK,
Db.a.Ff,f);a.ya(D.a.dK,Db.a.textRange,f);a.ya(D.a.dK,Db.a.endOfParagraph,Le.ActionManager.Ju);a.ya(D.a.dK,Db.a.outline,c);a.ya(D.a.dK,Db.a.view,b);a.$d(D.a.dK,1124);a.ra(D.a.yWb,Db.a.view,b,1124);a.ra(D.a.HAa,Db.a.view,gl.HAa,1028);a.ya(D.a.kOa,Db.a.view,Object(C.a)(this.VFc,this.VFc.kOa,"deleteFromInputEvent"));a.ya(D.a.kOa,Db.a.textRange,f);a.$d(D.a.kOa,1028)}GQd(a,b,c,f,l){return this.LIh.GQd(a,b,c,f,l)}static get Gl(){return ry.PageNavigator.instance}static get Lh(){return gl.xi||(gl.xi=lb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get OI(){return gl.wH||
(gl.wH=lb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}static get RCi(){return gl.k_a||(gl.k_a=lb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"))}static get $A(){return gl.ix||(gl.ix=lb.a.instance.resolve("Box4.IOutlineEditor"))}static get pe(){return gl.$c||(gl.$c=lb.a.instance.qb("Box4.IFeatureHelper"))}static HAa(a,b,c,f,l){f=b.view;if(!f.Eb||!f.Eb.Pa.kb||Cb.SelectionEditor.Ew(f.Eb.Pa.kb))return 8;if(1===c)return 32;c=f.Eb.Pa;const w=c.kb;var F=w.Wa;let S=!1;var fa=
null,xa=!1;if(c.uG)if(lg.a(F))S=!0;else{if(F.contextId===Db.a.outline&&1===c.length){for(a=mb.GraphIterator.nb(F.node);a.Ii();)a.Hi();gl.$A.zY(a,!0);lc.OutlineElementNavigator.ti(a);a=fd.SelectionFactory.Lg(a.currentNode,0);f.Eb.setSelection(a);return 32}var Za=F.node;fa=null;if(St.c(F)){var pb=Za.pc(f.Na);pb&&(pb=pb.SAl)&&0<=pb.width&&0<=pb.height&&(fa=new Hw.a(fe.a.yf(pb.x,0),fe.a.yf(pb.y,1)));fa||(fa=lq.b(Za))}else fa=lq.b(F.node);F=mb.GraphIterator.nb(F.node);F.uv();gl.Gl.JHa(F);Za=gl.OI.cWb(F);
lq.c(Za,fa.x,fa.y);gl.$A.zY(F,!0);fa=fd.SelectionFactory.oj(Za,!0)}else if(1===c.length){xa=c.last;F=dd.a.QNa(xa);if(gl.pe&&gl.pe.isFeatureEnabled(33)&&xi.ContextSetEditor.instance.QLe(F).returnValue)return 2;xa=xa.We;xa=!lg.a(xa)&&!c.nl&&(Cb.SelectionEditor.Bl(xa)||db.ParagraphReader.Tl(xa)||Cb.SelectionEditor.BV(xa))}xa&&(xa=Cb.SelectionEditor.xl(w,!1,!1,void 0,gl.RCi.eKe(null,1)),f.Eb.setSelection(xa),u.AFrameworkApplication.Va.li(b,D.a.WA,2,!1,null,l),fa=f.Eb.Pa.kb,f.Eb.setSelection(w));l||(l=
new H.DictionaryPropertySet);l.setValue(Kd.a.Upb,!0);u.AFrameworkApplication.Va.li(b,D.a.dK,2,!0,null,l);if(fa&&fa.Wa.isValid)return f.Eb.setSelection(fa),32;c.uG&&(S||po.instance.Lvb(a,b.HD,f));Cb.SelectionEditor.Ew(f.Eb.Pa.kb)||u.AFrameworkApplication.Va.li(b,D.a.WA,2,!1,null,l);return 32}}gl.wH=null;gl.xi=null;gl.k_a=null;gl.ix=null;gl.$c=null;Object(e.a)(gl,"ADeleteActor",null,[]);class Sk{get Vi(){return Rf.a.instance}TCi(a,b,c,f,l){if(1===c)return 32;f=a===D.a.backspace||a===D.a.kOa;if(Sk.Eq()&&
Sk.Eq().instance&&Sk.Eq().instance.EV(b))return 4;c=b.node;var w=b.Qa;b=b.Lb;const F=db.ParagraphReader.text(c),S=F.length;let fa=!1;if(w===b){if(f&&!w||!f&&w===S)return 2;f?(I.a.instance.ga(14)&&({cp:w,returnValue:fa}=this.Vi.kbk(c,w)),fa||(w--,Ja.a.Hw(F,w)&&w--),a=D.a.Rza):(I.a.instance.ga(14)&&({cp:b,returnValue:fa}=this.Vi.jbk(c,b)),fa||(b++,Ja.a.Hw(F,b)&&b++),a=D.a.jOa)}w=w===b?Fc.a.Wj(c,w):Fc.a.createTextRange(c,w,b);f=new Oe.GraphTransaction(15);f.fd=a;f.hd(c);c=Object(Ca.a)(Gs,l)&&l.uZb;if(Sk.Mf.Zf&&
Sk.Mf.fy&&!c){c=Sk.Mf.Dnb();try{let xa;if(({type:xa}=null.Aeg()).returnValue){const Za=Object(ua.a)(10,l);if(Za&&Za.ta(Fs.a.wrg,!1)||1===xa)Sk.Mf.$2g=xa}l=0;for(let Za=null.length-1;0<=Za;--Za){let pb;const Mb=({$wg:pb}=null.getContext(Za)).returnValue;pb?(Sk.hyperlinkEditor.wBb(Mb,null),l+=0,Sk.e5.$Nd=b+l):this.DUf(Mb)}}finally{c&&c.dispose()}}else this.DUf(w);f.dispose();return 32}static get Mf(){return Sk.Yc||(Sk.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get e5(){return Sk.Go||
(Sk.Go=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get xmc(){return Sk.PC||(Sk.PC=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get hyperlinkEditor(){return Sk.Tm||(Sk.Tm=lb.a.instance.resolve("Box4.IHyperlinkEditor"))}static Eq(){return Sk.jm||(Sk.jm=lb.a.instance.Oa("Box4.IExternalSelectionManager"))}}Sk.Yc=null;Sk.Go=null;Sk.PC=null;Sk.Tm=null;Sk.jm=null;Object(e.a)(Sk,"ADeleteParagraphContentStrategy",null,[]);class Gv extends Sk{constructor(){super()}DUf(a){Gv.characterPropertiesEditor.replaceTextRange(a,
"")}static get characterPropertiesEditor(){return Gv.Sfh||(Gv.Sfh=lb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}}Gv.Sfh=null;Object(e.a)(Gv,"DeleteParagraphContentStrategy",Sk,[]);var UQ=d(466);class FN{constructor(a,b,c,f){this.CTe=a;this.XI=c;this.od=f;this.actionId=b}}Object(e.a)(FN,"DeleteActionData",null,[]);class Te{get imi(){return Te.DXe||(Te.DXe=lb.a.instance.resolve("Box4.Clipboard.IClipboardOperationCutStrategy"))}Qkl(a){return!Cb.SelectionEditor.Oj(a)}P$i(a,b,c){if(!a)return null;
if(!c)return a;b=Cb.SelectionEditor.hPa(a,!1,!b,!0,!0,!0);return fd.SelectionFactory.SM(a,b.Wa,!1)}HQd(a,b,c,f,l){if(1===c)return 32;var w=!1;a===D.a.yWb&&(a=D.a.dK,w=!0);a===D.a.vpb&&(a=D.a.backspace,w=!0);a===D.a.IAa&&(b=new gC.a(gb.App.Fb.Fd.Xm));var F=b;if(!F.view.Jh)return 2;var S=F.view.Eb;ee.GrippersManager.instance.setVisibility(!1);F=a===D.a.dK;S=0<S.Pa.length?S.Pa.ga(0):null;w=this.P$i(S,F,w);return this.LUf(a,b,c,f,l,w,F)}LUf(a,b,c,f,l,w,F){const S=b.view,fa=S.Eb;var xa=l,Za=l;a===D.a.IAa&&
(Za=xa=null,w=new nb.Selection(l,!0));if(!w)return 32;const pb=new FN(b,a,f,Za),Mb=this.h6k(xa,F,fa);xa=!1;if(({mRa:xa}=this.wnh(a,Mb,fa)).returnValue)return a=xa?D.a.GAa:D.a.deleteRow,u.AFrameworkApplication.Va.li(b,a,c,!1,f,l);let hc;F?Me.a.mark(hc=5009):Me.a.mark(hc=5011);c=new Oe.GraphTransaction(15);c.fd=a;c.hd(S.ug);xa=null;let kc=({lVk:xa}=this.UYi(a,l,fa,w)).returnValue;Za=null;({yhd:Za}=xi.ContextSetEditor.instance.QLe(kc)).returnValue&&(kc=Za);if(!kc)return c.dispose(),32;this.Kvh(kc);const Ec=
this.BVi(w,F);let Hc=null;F?Hc=new Wq(w):Ec&&(Hc=new Wq(Ec));Za=!1;if(Cb.SelectionEditor.Mg(kc)){if(a===D.a.kOa)return 2;const Dc=Bh.nMc(S.ug,Mb);Te.QR.sF(()=>{this.KCi(b,f,l,kc,F,Hc,w,Dc,fa,Mb,pb,Ec)},"DeleteViewStrategy:DeleteAtInsertionPointContext")}else Te.Mf.Zf&&Te.Mf.fy?(this.Pkl(a,S.ug,kc,F,w,fa,Mb,pb,Hc),Za=!0):Za=this.j3g(a,S.ug,kc,fa,Mb,pb,Hc,xa);Te.NQi(fa);this.keh(kc);c.dispose();Me.a.mark(hc+1);return a===D.a.IAa?Za?32:8:32}kOa(a,b,c,f,l){return b.view.Jh?this.LUf(a,b,c,f,null,l,!1):
2}j3g(a,b,c,f,l,w,F,S){b=Bh.nMc(b,l);this.Qkl(c)&&b.ena(c);a=Te.Uc.zp(a);a.properties.$("CountOfParagraphsDeleted",Te.k4.YNd(c).toString());c=Te.lFi(Te.l6k,Object(C.a)(this,this.k6k,"shouldDispatchNoSpecialize"),c,f,l,b,w,F,S);a.end();return c}Pkl(a,b,c,f,l,w,F,S,fa){var xa=0,Za=null;const pb=xi.ContextSetEditor.instance.lA(c),Mb=pb[pb.length-1];if(Mb.contextId===Db.a.paragraph||Mb.contextId===Db.a.endOfParagraph){var hc=mb.GraphIterator.nb(Mb.node);hc.af();lc.OutlineElementNavigator.Ke(hc);lc.OutlineElementNavigator.KI(hc,
!0,!1)&&(Za=lc.OutlineElementNavigator.ti(hc))&&(xa=Te.k4.textLength(Za))}else xa=Te.k4.textLength(Mb.node)-Mb.Lb;if((hc=Object(ua.a)(10,S.od))&&hc.ta(Fs.a.wrg,!1))this.i3g(a,b,c,w,F,S,fa,!1);else{hc=Te.Mf.Dnb();try{this.i3g(a,b,c,w,F,S,fa,!0)}finally{hc&&hc.dispose()}}if(f){if(c.Cw){a=pb.length-1;do l=pb[a],a--;while(!l.node.isConnected&&0<=a)}else l=c;if(!Te.k4.Pd(l.node))return;switch(Mb.contextId){case Db.a.paragraph:case Db.a.endOfParagraph:xa=Za&&Za.isConnected?0:xa;break;case Db.a.Ff:case Db.a.textRange:break;
default:xa=0}xa=fd.SelectionFactory.Lg(l.node,Te.k4.textLength(l.node)-xa);l.q2a===xa.Wa.Qa&&(xa.Wa.MR=l.MR)}else{xa=l.Wa.node;if(!Te.k4.Pd(xa))return;Za=l.Wa.contextId===Db.a.paragraph?0:l.Wa.contextId===Db.a.endOfParagraph?Te.k4.textLength(xa):l.Wa.Qa;xa=fd.SelectionFactory.Lg(xa,Za)}dd.a.instance.setSelection(xa)}i3g(a,b,c,f,l,w,F,S){this.TTi(f,c);!({type:fa}=null.Aeg()).returnValue||S&&1!==fa||(Te.Mf.$2g=fa);for(c=null.length-1;0<=c;--c){var fa=({$wg:S}=null.getContext(c)).returnValue;S?Te.hyperlinkEditor.wBb(fa,
2):this.j3g(a,b,fa,f,l,w,F,null)}}TTi(a,b){if(Object(Ca.a)(UQ.a,b))for(a=ii.Wqa(a.Pa,!0),b=0;b<a.length&&a.getContext(b).contextId!==Db.a.table;b++);}UYi(a,b,c,f){a===D.a.IAa?(c=Ra.a.VNa(b),a=mm.SelectionReferenceFactory.instance.bqa()):(a=null,c=1===c.Pa.length?dd.a.QNa(f):c.Dj);return{returnValue:c,lVk:a}}fhi(a){return!a.Ok||a.contextId!==Db.a.paragraph||!Te.k4.Pd(a.node)||Te.Mf.Zf&&Te.Mf.fy||I.a.instance.ga(14)&&Te.Vi.JSc(a)?!1:!0}Kvh(a){if(a.Cw)for(let b=0;b<a.length;b++)this.Kvh(a.getContext(b));
else this.fhi(a)&&(a.node.ZBc=!0)}keh(a){if(a.Cw)for(let b=0;b<a.length;b++)this.keh(a.getContext(b));else a.Ok&&(a=a.node)&&Te.k4.Pd(a)&&(a.ZBc=!1)}KCi(a,b,c,f,l,w,F,S,fa,xa,Za,pb){const Mb=new mb.GraphIterator,hc=f.node;Mb.set(hc);Mb.af();Cb.SelectionEditor.PB(Mb.currentNode,f,l)?this.OCi(a,b,c,f,l,w,F,S,fa,Za,pb,Mb,hc):Te.PCi(f,l,w,F,S,fa,xa,Za)}kOc(a,b,c,f){return!a&&yc.ListReader.$j(b)?(f=Te.hma(b,c),{returnValue:!0,response:f}):{returnValue:!1,response:f}}Gjj(a,b,c,f,l,w){return I.a.instance.ga(65)&&
!a&&0<Md.OutlineElementReader.Qrb(b)?(w=u.AFrameworkApplication.Va.li(c,D.a.Oah,2,!1,f,l),{returnValue:!0,response:w}):{returnValue:!1,response:w}}Vnj(a,b,c,f,l,w){return I.a.instance.ga(54)&&!a&&0<Md.OutlineElementReader.c6a(b)?(w=u.AFrameworkApplication.Va.li(c,D.a.kLk,2,!1,f,l),{returnValue:!0,response:w}):{returnValue:!1,response:w}}Alj(a,b,c,f,l,w){return I.a.instance.ga(80)&&!a&&Te.Qu.kob(b)?(w=u.AFrameworkApplication.Va.li(c,D.a.Qy,2,!1,f,l),{returnValue:!0,response:w}):{returnValue:!1,response:w}}jhj(a,
b,c,f,l,w,F,S,fa,xa,Za){const pb=new zn.a;pb.Pc(b);if(lc.OutlineElementNavigator.mGa(pb,!1,!a,!1)){Za=!0;xa=32;const Mb=new mb.GraphIterator;Mb.Pc(pb);lc.OutlineElementNavigator.ti(pb);w&&f&&Cb.SelectionEditor.BV(f.Wa)?(c.ena(l),Te.Lh.SKk(b.currentNode)):pb.currentNode.AV?(I.a.instance.ga(68)&&c.ena(l),lc.OutlineElementNavigator.Ke(pb),pb.Hi()):I.a.instance.ga(66)&&a&&w?Te.Vi.Dug(S)&&!({twa:Za}=this.b6g(a,S,pb.currentNode,f,Za)).returnValue&&(c.ena(l),Te.dr.hma(b),b.Hi()):Cd.TableReader.Jp(pb)?(c.ena(l),
this.KUf&&({response:xa,returnValue:Za}=this.KUf.Ozl(a,Mb,b,pb,F,fa,xa))):Te.k4.Pd(pb.currentNode)&&(({twa:Za}=this.b6g(a,S,pb.currentNode,f,Za)).returnValue||this.EUf&&this.EUf.LCi(a,c,l,b,S,pb));return{returnValue:!0,response:xa,twa:Za}}return{returnValue:!1,response:xa,twa:Za}}b6g(a,b,c,f,l){return Te.Mf.Zf&&Te.Mf.fy&&(a=(a?b:c).Ra.last,b=u.AFrameworkApplication.userName,!a.fo||a.fo.authorName!==b)?(f&&(dd.a.instance.setSelection(f),l=!1),{returnValue:!0,twa:l}):{returnValue:!1,twa:l}}xnj(a,b,
c,f,l,w,F,S){return I.a.instance.ga(67)&&Md.OutlineElementReader.rsg(b,a)?(Ce.isInTableCell(b)&&(Fd.returnToContainingCell(b),Ce.isEmpty(b)&&c.ena(f),{h7k:a,returnValue:S}=Te.Sak(b,F,a,l,w),a||(S=2)),{returnValue:!0,response:S}):{returnValue:!1,response:S}}$jj(a,b,c,f,l,w,F,S){Md.OutlineElementReader.rsg(b,a)||({response:F,twa:S}=Te.$Fi(c,f,a,w,l,F,S));return{returnValue:!1,response:F,twa:S}}OCi(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){let hc=!1,kc=2;const Ec=Te.k4.isEmpty(pb),Hc=pb.currentNode;lc.OutlineElementNavigator.Ke(pb);
({response:kc}=this.kOc(l,pb,xa,kc)).returnValue||({response:kc}=this.Gjj(l,pb,a,b,c,kc)).returnValue||({response:kc}=this.Vnj(l,pb,a,b,c,kc)).returnValue||({response:kc}=this.Alj(l,pb,a,b,c,kc)).returnValue||({response:kc,twa:hc}=this.jhj(l,pb,S,Za,f,Ec,Hc,Mb,fa,kc,hc)).returnValue||({response:kc}=this.xnj(l,pb,S,f,fa,xa,Hc,kc)).returnValue||({response:kc,twa:hc}=this.$jj(l,pb,b,c,S,F,kc,hc));Te.STg(S,32===kc);hc&&Te.yT(fa,w)}h6k(a,b,c){return a&&a.Sa(Kd.a.Upb)?this.imi.Tmh()||a.getValue(Kd.a.Upb)?
!a.ta(Kd.a.Upb,!1):this.T7f(!1,c):this.T7f(b,c)}wnh(){return{returnValue:!1,mRa:!1}}static get characterPropertiesEditor(){return Te.Vg||(Te.Vg=lb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Sf(){return Te.Pg||(Te.Pg=lb.a.instance.resolve("Box4.List.IListReader"))}static get k4(){return Te.Tq||(Te.Tq=lb.a.instance.resolve("Box4.IParagraphReader"))}static get hyperlinkEditor(){return Te.Tm||(Te.Tm=lb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get dr(){return Te.Eo||(Te.Eo=
lb.a.instance.resolve("Box4.List.IListEditor"))}static get Lh(){return Te.Gff||(Te.Gff=lb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get eH(){return ul.a.instance}static get Qu(){return Xu.a.hsb}static get Mf(){return Te.Yc||(Te.Yc=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get e5(){return Te.Go||(Te.Go=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get xmc(){return Te.PC||(Te.PC=lb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get Uc(){return cd.a.instance}static get Vi(){return Rf.a.instance}static get ut(){return Te.HC||
(Te.HC=lb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get QR(){return ce.a.instance}static NQi(a){if(1===a.Pa.length&&(a=a.Pa.ga(0),Cb.SelectionEditor.Ew(a))){var b=a.Wa;a=b.node;b=b.Qa;var c=Te.k4.text(a);b<c.length&&0<b&&" "===c.charAt(b-1)&&" "===c.charAt(b)&&Te.characterPropertiesEditor.replaceTextRange(Fc.a.createTextRange(a,b-1,b),"\u00a0")}}static C$h(a,b){if(!b.hyperlink.pub){const c=new Oe.GraphTransaction(15);try{c.hd(a.node),Te.ut.jO(a,b)}finally{c&&c.dispose()}}}static hma(a,
b){a=Te.Sf.rx(a).DSc?D.a.UQ:D.a.TQ;return u.AFrameworkApplication.Va.li(b.CTe,a,2,!1,b.XI,b.od)}static $Fi(a,b,c,f,l,w,F){if(c=Cb.SelectionEditor.hPa(f,!1,!c,!1,!1,!0)){f=fd.SelectionFactory.SM(f,c.Wa);w=32;for(c=0;c<f.length;++c){l.ena(f.ga(c));const S=u.AFrameworkApplication.Va.li(f.ga(c),D.a.dK,2,!0,a,b);2!==S&&(w=S)}32===w&&(F=!0)}return{response:w,twa:F}}static lFi(a,b,c,f,l,w,F,S,fa){let xa=!1;a(c)?(xa=Te.vRd(c,!0,f,l,w,F))&&Te.qJa(S,f,fa):b(c)?(xa=Te.vRd(c,!1,f,l,w,F))&&Te.qJa(S,f,fa):(w.normalize(),
Te.qJa(S,f,fa));return xa}static qJa(a,b,c){c&&c.yT()||Te.yT(b,a)}static vRd(a,b,c,f,l,w){f||Vi.OutlineReader.Via(a)||(c=Te.uol(c))&&l.k3k(c);a=32===u.AFrameworkApplication.Va.li(a,w.actionId,2,b,w.XI,w.od);Te.STg(l,a);return a}static STg(a,b){b?a.normalize():a.cancel()}static yT(a,b){b&&(b=b.restore())&&a.setSelection(b)}static PCi(a,b,c,f,l,w,F,S){let fa;!b&&({T1b:fa}=Te.ut.p8a(a)).returnValue?(c=new Wq(f),Te.C$h(a,fa),l.normalize(),Te.yT(w,c)):Te.vRd(a,!1,w,F,l,S)&&(b&&Te.Mf.Zf&&Te.Mf.fy?(b=Te.e5.$Nd)?
(w.setSelection(fd.SelectionFactory.Lg(a.node,b)),Te.e5.$Nd=null):Te.yT(w,c):Te.yT(w,c))}static Sak(a,b,c,f,l){let w,F=2;w=!0;if(Ce.isEmpty(a)){const S=Fd.getContainingTable(a),fa=Cd.TableReader.Zj(S),xa=Cd.TableReader.ui(S);1===fa&&1===xa?(F=u.AFrameworkApplication.Va.li(Fc.a.create(S),D.a.J3a,2,!1,l.XI,l.od),f.setSelection(fd.SelectionFactory.Lg(b,0)),w=!1):1===fa?F=u.AFrameworkApplication.Va.li(l.CTe,D.a.GAa,2,!1,l.XI,l.od):(b=Ce.isEmptyIncludingTheRestOfTheRow(a),Ce.isFirstCellInRow(a)&&b?F=u.AFrameworkApplication.Va.li(l.CTe,
D.a.deleteRow,2,!1,l.XI,l.od):!c&&b&&(F=32,a=Cb.SelectionEditor.Pqa(f.Pa.kb,!1,!1,!1,!0),f.setSelection(a),w=!1))}return{returnValue:F,h7k:w}}static l6k(a){return a.Cw||Vi.OutlineReader.Via(a)||Te.k4.Tl(a)}static uol(a){return(a=ii.Wqa(a.Pa,!0))&&1===a.length&&(a=a.getContext(0).node,Cd.TableReader.M8a(a))?a:null}}Te.Pg=null;Te.Vg=null;Te.Gff=null;Te.Tq=null;Te.Tm=null;Te.Eo=null;Te.Yc=null;Te.Go=null;Te.PC=null;Te.DXe=null;Te.HC=null;Object(e.a)(Te,"ADeleteViewStrategy",null,[]);class lu{constructor(a,
b){this.Ib=a;this.Zh=b}LCi(a,b,c,f,l,w){l=this.Ib.Jc(l);a&&!this.Zh.isEmpty(l)?(lc.OutlineElementNavigator.Ke(w),b.Mvh(w.currentNode),lu.Lh.merge(f,w,!1,!1)):(lc.OutlineElementNavigator.Ke(w),b.ena(c),lu.Lh.merge(w,f,!1,!1))}static get Lh(){return lu.xi||(lu.xi=lb.a.instance.resolve("Box4.IOutlineElementEditor"))}}lu.xi=null;Object(e.a)(lu,"DeleteParagraphNodeStrategy",null,[471]);class GN extends Te{constructor(a,b,c,f){super();this.sYj=new lu(c,f);this.la=a;this.VKg=b;this.Ib=c}get KUf(){throw Error.notImplemented();
}get EUf(){return this.sYj}BVi(a,b){return Cb.SelectionEditor.hPa(a,!0,!b,!1,!1,!0)}k6k(a){return Cb.SelectionEditor.Oj(a)}T7f(a,b){if(!this.la.W$d||!this.la.mvb||!this.la.X$d||a)return!1;a=this.Rcj(b);return 1===(a&1)&&2!==(a&2)}Rcj(a){var b=a.Pa;if(!b.length)return 0;a=Object(ua.a)(5,b.ga(0).Wa.node);if(!a||!a.Nr())return 0;a=(a=(a=a.nK())?a.peg():null)?a.getContainingTable():null;if(!a)return 0;const c=[];for(var f=0;f<b.length;++f){var l=b.ga(f);if(l){var w=ii.wLc(l,!0),F=ii.wLc(l,!1);if(w&&F){if(Cb.SelectionEditor.iu(w)&&
!Cb.SelectionEditor.fub(w)||!db.ParagraphReader.r8d(w.node)||w!==F&&Cb.SelectionEditor.iu(F)&&!Cb.SelectionEditor.fub(F)||!db.ParagraphReader.$Fj(F.node))return 0;if(l=Object(ua.a)(Ra.a,xi.ContextSetEditor.instance.BZb(Ra.a.VNa(l.toArray()),16,!1)))for(w=0;w<l.length;++w)F=Object(ua.a)(Pl.TableCellNode,l.getContext(w).node),a.hp()&&F.isControllingCell?this.Ryj(F,c):F.isGhostCell||Array.add(c,F)}}}if(!c.length)return 0;b=a.oX;f=a.v6;w=l=0;F=Array(b);const S=Array(f);for(var fa=0;fa<b;++fa)F[fa]=0;
for(fa=0;fa<f;++fa)S[fa]=0;for(fa=0;fa<c.length;++fa){const xa=c[fa].peg();++F[xa.rowIndex]===f&&++l;++S[xa.pi]===b&&++w}if(0<l&&0<w){if(l===b&&w===f)return 3}else if(l||w){if(0<l){if(!a.hp())for(a=0;a<f;++a)if(S[a]!==l)return 0;return 1}if(0<w){if(!a.hp())for(a=0;a<b;++a)if(F[a]!==w)return 0;return 1}}return 0}Ryj(a,b){Ce.foreachMergedCells(Object(ua.a)(fg.a,a),c=>{Array.add(b,c)})}kOc(a,b,c,f){if(!a&&yc.ListReader.$j(b)){var l=this.Ib.MPa();l.Pc(b);if((l=Object(ua.a)(4,l.Og(10)))&&l.fg){if(this.VKg.kob(b))this.VKg.Fdb(b,
-1,0),f=32;else if(b.RE(1)){if(b.xf(1),({response:f}=super.kOc(a,b,c,f)).returnValue)return{returnValue:!1,response:f}}else f=32;return{returnValue:!0,response:f}}return super.kOc(a,b,c,f)}return{returnValue:!1,response:f}}wnh(a,b,c){if(!(b&&a===D.a.backspace&&c.Pa&&c.Pa.length&&c.Pa.nl))return{returnValue:!1,mRa:!1};b=c.Mo();if(!b||!b.hp())return{returnValue:!1,mRa:!1};a=b.oX;b=b.v6;let f=a,l=0,w=b,F=0;c=xi.ContextSetEditor.instance.lA(c.Dj);for(let xa=0;xa<c.length;xa++){if(!c[xa].Ok)return a=!1,
{returnValue:!1,mRa:a};var S=Object(ua.a)(5,c[xa].node);if(!S||!S.Nr())return a=!1,{returnValue:!1,mRa:a};var fa=(S=S.nK())?S.ly():null;if(!fa)return a=!1,{returnValue:!1,mRa:a};S=fa.rowIndex;const Za=fa.pi,pb=fa.rowSpan;fa=fa.colSpan;f=Math.min(f,S);l=Math.max(l,S+pb-1);w=Math.min(w,Za);F=Math.max(F,Za+fa-1)}return l-f+1!==a&&F-w+1!==b?{returnValue:!1,mRa:!1}:{returnValue:!0,mRa:l-f+1===a?!0:!1}}}Object(e.a)(GN,"DeleteViewStrategy",Te,[]);class HN extends gl{constructor(a,b,c,f){super();this.tYj=
new GN(a,b,c,f);this.rYj=new Gv}get VFc(){return this.tYj}get CUf(){return this.rYj}}Object(e.a)(HN,"Box4DeleteActor",gl,[]);class IN{constructor(a,b,c,f,l){this.ia=a;this.qYj=new HN(b,c,f,l);oa.InteractiveViewManager.instance.editingView.TWb=!0}wb(){this.qYj.wb(this.ia)}Fe(){var a=D.a.backspace;const b=v.FocusManager.instance().Bc(E.AppFrame.hV);b.bindAction(A.KeyInputManager.La(x.a.fH,0),a);b.bindAction(A.KeyInputManager.La(x.a.fH,4),D.a.backspace);b.bindAction(A.KeyInputManager.La(x.a.fH,4|A.KeyInputManager.He),
G.a.ze);b.bindAction(A.KeyInputManager.La(x.a.fH,A.KeyInputManager.He),D.a.vpb);b.bindAction(A.KeyInputManager.La(x.a.ona,0),D.a.dK);b.bindAction(A.KeyInputManager.La(x.a.ona,A.KeyInputManager.He),D.a.yWb);r.a.ak&&(b.bindAction(A.KeyInputManager.La(x.a.fH,3),D.a.backspace),b.bindAction(A.KeyInputManager.La(x.a.fH,7),D.a.backspace),b.bindAction(A.KeyInputManager.La(x.a.fH,5),D.a.backspace),b.bindAction(A.KeyInputManager.La(x.a.fH,1),D.a.vpb))}}Object(e.a)(IN,"DeleteActor",null,[234]);class JN{constructor(a){this.uXj=
a}wb(){this.uXj.wb()}Fe(){}}Object(e.a)(JN,"EnterActor",null,[234]);class Yp{constructor(a,b,c){this.wu=a;this.wRb=b;this.jm=c}get ln(){return this.wRb.value}WKi(a,b,c,f,l){var w;if(!({Gf:c,selected:w,vE:fa}=this.Anh(b,c,!1)).returnValue)return fa;Me.a.mark(5013);var F=Yp.Ml.lA(w);for(var S=0;S<F.length;++S){if(!F[S].isValid)continue;let xa=F[S].iterator;xa.uv();if(Vi.OutlineReader.xt(xa))return this.ZZf(c,xa);if(lg.b(xa))return po.instance.Lvb(a,w,c),this.ln.Mv(),Me.a.mark(5014),32}F=this.E0i(w);
if(w.Cw||Cb.SelectionEditor.Oj(w)||db.ParagraphReader.Tl(w)&&!Cb.SelectionEditor.BV(w)){if(Yp.pe&&Yp.pe.isFeatureEnabled(33)&&xi.ContextSetEditor.instance.QLe(w).returnValue)return 8;var fa=this.$Zf(b,c,a,f,l,F)}else if(Cb.SelectionEditor.Bl(w))fa=this.YZf(b,c,a,f,l,F);else if(Cb.SelectionEditor.Mg(w)){fa=new mb.GraphIterator;fa.set(w.node);fa.oc(10);if(this.Tbk()&&(S=fb.HyperlinkReader.HB(w,!1),0<S.length)){if(!S[0].hyperlink)return Z.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",
S[0].Qa,S[0].Lb),8;gb.App.oZb(S[0].hyperlink.url);return 32}Ce.isInTableCell(fa)&&!I.a.instance.ga(77)&&(Fd.returnToContainingCell(fa),I.a.instance.ga(30)&&Ce.isLastCellInTable(fa)&&!Vi.OutlineReader.HOc(fa)&&Vi.OutlineReader.PB(fa,w,!0)&&(vg.OutlineNavigator.q9(fa),yc.ListReader.$j(fa)||(F=D.a.LCa),Fd.returnToCell(fa)),Ce.isFirstCellInRow(fa)&&(S=new mb.GraphIterator,S.Pc(fa),Fd.returnToContainingRow(S),I.a.instance.ga(30)&&kk.j(S)&&kk.e(S)&&1<Cd.TableReader.Zj(Fd.getContainingTable(S))?F=D.a.deleteRow:
Vi.OutlineReader.PB(fa,w,!1)&&(kk.g(S)&&0>=w.MR?(F=D.a.w2b,Fd.returnToContainingTable(fa),lc.OutlineElementNavigator.Ke(fa),l||(l=new H.DictionaryPropertySet),l.ke(Kd.a.targetObject,fa.currentNode.id)):I.a.instance.ga(30)&&(F=D.a.G7a))));fa=this.b_f(b,c,a,f,l,F)}else Cb.SelectionEditor.BV(w)&&(fa=u.AFrameworkApplication.Va.li(b,D.a.WA,2,!1,f,l));Me.a.mark(5014);return fa}Anh(a,b,c){let f,l;l=f=null;if(1===b)return{returnValue:!1,Gf:f,selected:l,vE:32};if(!a.view.Jh)return{returnValue:!1,Gf:f,selected:l,
vE:2};f=a.view;l=f.Eb.Dj;return!l||I.a.instance.ga(14)&&!Yp.Vi.Trg(l,c)?{returnValue:!1,Gf:f,selected:l,vE:2}:this.jm&&this.jm.instance&&this.jm.instance.EV(l)?{returnValue:!1,Gf:f,selected:l,vE:4}:{returnValue:!0,Gf:f,selected:l,vE:2}}K5k(a,b,c,f,l){let w,F;if(!({Gf:c,selected:w,vE:F}=this.Anh(b,c,!0)).returnValue)return F;const S=Yp.Ml.lA(w);for(let fa=0;fa<S.length;++fa){if(!S[fa].isValid)continue;const xa=S[fa].iterator;xa.uv();if(Vi.OutlineReader.xt(xa))return this.ZZf(c,xa)}w.Cw||Cb.SelectionEditor.Oj(w)?
F=this.$Zf(b,c,a,f,l,D.a.u2b):Cb.SelectionEditor.Bl(w)?F=this.YZf(b,c,a,f,l,D.a.u2b):Cb.SelectionEditor.Mg(w)?F=this.b_f(b,c,a,f,l,D.a.u2b):Cb.SelectionEditor.BV(w)&&(F=u.AFrameworkApplication.Va.li(b,D.a.WA,2,!1,f,l));return F}ZZf(a,b){a.Eb.setSelection(fd.SelectionFactory.oj(b.currentNode,!1));return 32}$Zf(a,b,c,f,l,w){const F=new Oe.GraphTransaction(15);F.fd=c;F.hd(b.ug);b=new H.DictionaryPropertySet;b.setValue(Kd.a.Upb,!0);b=u.AFrameworkApplication.Va.li(a,D.a.dK,2,!0,f,b);32===b&&(b=u.AFrameworkApplication.Va.li(a,
w,2,!1,f,l));F.dispose();return b}YZf(a,b,c,f,l,w){const F=new Oe.GraphTransaction(15);F.fd=c;F.hd(b.ug);b.Eb.setSelection(Cb.SelectionEditor.xl(b.Eb.Pa.ga(0),!1,!1));a=u.AFrameworkApplication.Va.li(a,w,2,!1,f,l);F.dispose();return a}b_f(a,b,c,f,l,w){const F=new Oe.GraphTransaction(15,c);F.fd=c;F.hd(b.ug);a=u.AFrameworkApplication.Va.li(a,w,2,!1,f,l);F.dispose();return a}static get Ml(){return xi.ContextSetEditor.instance}static get Vi(){return Rf.a.instance}static get pe(){return Yp.$c||(Yp.$c=lb.a.instance.qb("Box4.IFeatureHelper"))}}
Yp.$c=null;Object(e.a)(Yp,"AEnterViewStrategy",null,[439]);class Zs extends Yp{constructor(a,b,c){super(a,b,c)}E0i(a){let b=D.a.WA;if(a&&(a=Yp.Ml.lA(a))&&0<a.length){const c=new mb.GraphIterator;c.set(a[0].node);c.oc(10);(a=c.lZa())&&a.Sa(zb.a.zj)&&(a=a.getValue(zb.a.zj),0===a||2===a)&&(b=D.a.u2b)}return b}Tbk(){return Zs.PT?!1:!0}static get PT(){null==Zs.AH&&(Zs.AH=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Zs.AH}}Zs.AH=null;Object(e.a)(Zs,
"EnterViewStrategy",Yp,[]);class KE{constructor(a){this.KZj=a}Afd(a,b){this.KZj.rX(a,b)}}Object(e.a)(KE,"PPTFontNameFormattingStrategy",null,[425]);class KN{Tmh(){return!1}}Object(e.a)(KN,"PptClipboardOperationCutStrategy",null,[332]);class LN{constructor(a,b){this.eL=a;this.sa=b}kIj(a){return 10===a.ri||16===a.ri||60===a.ri}ehi(a){if(this.eL.r8a(a)&&this.eL.jub(a))return!1;let b=a=null;this.sa.Pa.kb&&(b=this.sa.Pa.kb.Wa,a=this.sa.Pa.kb.We);return this.xae(b)&&this.xae(a)}xae(a){if(a){if(a.contextId===
Db.a.paragraph)return!0;if(a.contextId===Db.a.endOfParagraph&&(a=a.node))return Ja.a.Xa(a.characterData)}return!1}X6k(a,b){return this.eKe(a,b)}eKe(a,b){let c=null;this.sa.Pa.kb&&(c=this.sa.Pa.kb.Wa);return this.xae(c)?!!a&&this.eL.jub(a)||1===b:!1}}Object(e.a)(LN,"PptDeleteOutlineElementNodeStrategy",null,[330]);class MN{constructor(a,b,c){this.oq=a;this.lF=b;this.ob=c}w_f(a){if(this.ob.Pa&&this.ob.Pa.nl){const f=this.oq.B6f(this.ob.Pa).returnValue;if(!f.YOa()&&a.Cw){a=new Ra.a;var b=this.ob.jy();
for(const l of b)if(b=Object(ua.a)(Pl.TableCellNode,l)){var c=mb.GraphIterator.nb(b);if(c.af()){const w=kk.c(c);c=this.lF.KKc(Object(ua.a)(123,c.currentNode));f.XMi(w,c)&&a.tga(dd.a.QNa(fd.SelectionFactory.$k(b)))}}}}return a}}Object(e.a)(MN,"PptDeleteTableSegmentStrategy",null,[333]);class NN{Gsh(){return!1}kug(a){return!!a&&!a.Pl.equals(Fa.a.nil)}}Object(e.a)(NN,"PptEopFormattingStrategy",null,[328]);class ON{constructor(a,b,c){this.u_c=!1;this.Fa=a;this.FN=b;this.sa=c}Hxh(a,b){a&&b&&(b.beforeSpacing&&
(a.setValue(zb.a.gca,b.beforeSpacing.value),a.setValue(zb.a.lja,b.beforeSpacing.Of)),b.afterSpacing&&(a.setValue(zb.a.fca,b.afterSpacing.value),a.setValue(zb.a.kja,b.afterSpacing.Of)),b.lineSpacing&&(a.setValue(zb.a.Iw,b.lineSpacing.value),a.setValue(zb.a.TV,b.lineSpacing.Of)));return!0}Qmh(){return!1}Dnh(){return!1}Nmh(){return!this.u_c}xnh(a,b){return a===Db.a.paragraph||a===Db.a.endOfParagraph||b}Omh(a,b,c){this.sa.Pa&&this.sa.Pa.kb&&(c=!this.sa.Pa.kb.Paa);return a!==Db.a.textRange&&(b===Db.a.paragraph||
c)}ZCf(a,b,c){this.u_c=!1;if(a.Nr()&&this.sa.Pa.kb){var f=this.sa.Pa.kb.Wa;this.sa.Pa&&this.sa.Pa.nl&&this.sa.Pa.ga(0)&&(f=this.sa.Pa.ga(0).Wa);if(f=Ab.a.xs(db.ParagraphReader.Pd(f.node)?f:fd.SelectionFactory.$k(a).Wa))if(f=f.cache)!c.Sa(zb.a.latinFont)&&f.Sa(zb.a.latinFont)&&c.setValue(zb.a.latinFont,f.VM),!c.Sa(ob.a.fontColor)&&f.w2&&c.setValue(ob.a.fontColor,f.fontColor),!c.Sa(ob.a.fontSize)&&f.Era&&c.setValue(ob.a.fontSize,f.fontSize),!c.Sa(ob.a.bold)&&f.BQa&&c.setValue(ob.a.bold,f.isBold)}if(b){if(f=
a.wP(this.FN)){b.AS||a.ta(zb.a.u7d,!1)||f.ta(zb.a.u7d,!1)||(this.u_c=!0);const l=b.spacing;l&&(!l.beforeSpacing||l.beforeSpacing.value||f.Sa(zb.a.gca)||(l.beforeSpacing=null),!l.afterSpacing||l.afterSpacing.value||f.Sa(zb.a.fca)||(l.afterSpacing=null),l.lineSpacing&&2===l.lineSpacing.Of&&1===l.lineSpacing.value&&!f.Sa(zb.a.Iw)&&(l.lineSpacing=null))}this.u_c||(b.AS||(b.AS=hk.a.bV(16,0)),b.AS.v4f=!0)}if((f=a.ycg())&&!f.r9&&(c.Sa(ob.a.fontSize)&&(f=this.Fa.GBa(this.Fa.$m(a)),c.setValue(ob.a.fontSize,
c.getValue(ob.a.fontSize)*f)),b&&b.spacing&&b.spacing.lineSpacing&&2===b.spacing.lineSpacing.Of)){let l;(l=b.spacing.lineSpacing).value=l.value-this.Fa.Drb(this.Fa.$m(a))}c.ta(ob.a.As,!1)&&c.setValue(ob.a.As,!1);c.ta(ob.a.sZ,!1)&&c.setValue(ob.a.sZ,!1)}}Object(e.a)(ON,"PptFormatPainterStrategy",null,[331]);var LE=d(421);class fA{constructor(a,b,c,f,l,w,F){this.ia=a;this.Ga=f;this.sa=b;this.CD=c;this.lu=l;this.QA=w;this.tUa=!F.zg;this.Pke=F.dvg}wb(){this.ia.ra(G.a.vvh,de.a.frame,Object(C.a)(this,this.iwk,
"pptToggleRibbonUXHandler"),128);this.ia.ya(G.a.mdh,de.a.frame,Le.ActionManager.Dg);this.ia.ya(G.a.ldh,de.a.frame,Le.ActionManager.Dg)}Fe(){}iwk(a,b){if(b.contextId!==de.a.frame)return 2;this.sa.Rh();this.Ga.Bd();this.lu.show(!0,a);this.Pke?(za.a.J(33859651,340,50,"User is switching to the Classic Ribbon from Single Line Ribbon"),u.AFrameworkApplication.Va.processAction(G.a.mdh,2)):(za.a.J(33859653,340,50,"User is switching to the Single Line Ribbon from Classic Ribbon"),u.AFrameworkApplication.Va.processAction(G.a.ldh,
2));u.AFrameworkApplication.tu&&u.AFrameworkApplication.tu.Q6();this.QA.I7&&2===this.QA.aJ?fA.ygh(this.ia,this.Pke,LE.a.y$c):this.CD.d2(!1,this.tUa,()=>{fA.ygh(this.ia,this.Pke,LE.a.y$c)},null);return 32}static ygh(a,b,c){Di.a.LL(c,(!b).toString(),Di.a.qL);a.processAction(aa.a.refresh,2)}}Object(e.a)(fA,"ToggleRibbonUXActor",null,[234]);class PN extends Sys.EventArgs{constructor(a,b,c){super();this.actionId=a;this.BRe=b;this.S8a=c}}Object(e.a)(PN,"UndoRedoEventArgs",Sys.EventArgs,[]);class QN{constructor(a,
b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc){this.ia=a;this.Df=b;this.sa=c;this.Ga=f;this.gv=l;this.M0j=w;this.W3j=F;this.bMg=S;this.zD=fa;this.Ebb=xa;this.rI=Za;this.k_j=pb;this.Ha=Mb;this.Ue=hc}wb(){this.ia.ra(aa.a.Adb,$b.a.application,Object(C.a)(this,this.Ahg,"handleUndoRedo"),4);this.ia.ra(aa.a.zdb,$b.a.application,Object(C.a)(this,this.Ahg,"handleUndoRedo"),4)}Fe(){const a=this.Ga.Bc(Xd.a.kj);a.eBc(A.KeyInputManager.La(x.a.PJb,A.KeyInputManager.He),aa.a.Adb,()=>!0);a.bindAction(A.KeyInputManager.La(x.a.lnd,
A.KeyInputManager.He),aa.a.zdb)}Ahg(a,b,c,f,l){b=!0;a===aa.a.zdb&&(b=!1);if(this.Df.gd(this.bMg)||!this.T5k(b,l))return 16;if(!this.U5k())return this.gv.vma(),16;if(1===c)return 32;if(c=!this.gv.tCj(b))this.sa.fj(),this.WQk();f=this.gv.$Kc(b);(l=this.rI.x4(f))&&Kc.a.ik("UndoRedoActionName",l);this.Ebb.m6c(!c);this.Ue.iEk(new PN(a,f,b));(f=this.gv.aYd(b))&&f.P4!==Fa.a.nil&&Kc.a.ik("UndoRedoRevision",Kc.a.u6a(f.P4.toString()).toString());this.k_j.m6c(f,l,b);if(b?!this.gv.undo():!this.gv.redo())return Z.ULS.sendTraceTag(19403009,
801,10,"User perform {0} failed!!",a===aa.a.undo?"undo":"redo"),8;c&&this.Df.xw(this.bMg,a);return 32}T5k(a,b){a&&!this.gv.vV&&b&&Z.ULS.sendTraceTag(21594565,801,50,"User pressed ctrl+z, but no undo entry left. Is in box4? {0}",this.gv.j8a());return(a?this.gv.vV:this.gv.oia)&&!(this.Ga.ye&&this.Ga.ye.name===Xd.a.fHd)&&this.V5k()}U5k(){return this.M0j||!this.mFj()}mFj(){return!this.W3j.zBa&&!!this.zD.instance&&this.zD.instance.iJj()}V5k(){return!this.nFj()}nFj(){const a=this.sa.Dq();return a?a.qy:
!1}WQk(){const a=this.Ga.ye;!a||a.name!==Xd.a.sg&&a.name!==Xd.a.Pua||this.Ga.Bd()}}Object(e.a)(QN,"UndoRedoActor",null,[234]);class RN{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd,He,Pe,Df,ig,Tg,Ig,Ff,nh,Jg,$h,Li,Aj,Zi){this.rEa=this.Ita=this.V1c=null;this.Ayb=0;this.oGg=this.Qje=!1;this.CD=w;this.ia=a;this.Cwb=b;this.Ga=c;this.ph=f;this.sa=l;this.Df=F;this.Qd=S;this.Wb=fa;this.ua=xa;this.Ub=Za;this.ebc=pb;this.kc=Mb;this.la=hc;this.lu=kc;this.Za=Ec;this.QA=Hc;this.Je=Dc;this.GUa=
Td;this.dLg=we;this.Xu=Pd;this.Bb=He;this.Dz=Pe;this.t_c=Df;this.MHg=hc.Ssg;this.Xc=ig;this.L9a=Tg;this.so=Ig;this.Cc=Ff;this.Nb=nh;this.Pb=Jg;this.SN=$h;this.Rb=Li;this.SG=Aj;this.Sv=Zi;this.pji()}wb(){this.ia.ra(aa.a.gad,$b.a.application,Object(C.a)(this,this.gad,"queryEdit"),96);this.ia.ra(aa.a.cbd,$b.a.application,Object(C.a)(this,this.cbd,"querySorterView"),96);this.ia.ra(aa.a.JDb,$b.a.application,Object(C.a)(this,this.JDb,"querySlideInformation"),96);this.ia.ya(aa.a.P9g,$b.a.application,Object(C.a)(this,
this.jgl,"switchToReadingMode"));this.ia.ya(aa.a.Xkc,$b.a.application,Object(C.a)(this,this.uel,"startSlideShowFromBegnning"));this.ia.ya(aa.a.sfc,$b.a.application,Object(C.a)(this,this.sfc,"present"));this.ia.ya(aa.a.mDb,$b.a.application,Object(C.a)(this,this.mDb,"presentDropDown"));this.ia.ya(aa.a.K9c,$b.a.application,Object(C.a)(this,this.K9c,"playFromBeginningTopBar"));this.ia.ya(aa.a.mYa,$b.a.application,Object(C.a)(this,this.mYa,"startSlideShowFromCurrentSlide"));this.ia.ya(aa.a.Yqb,$b.a.application,
Object(C.a)(this,this.Yqb,"forceClose"));this.ia.ya(aa.a.cma,$b.a.application,Object(C.a)(this,this.cma,"rehearsePresentation"));this.ia.ya(aa.a.ecd,$b.a.application,Object(C.a)(this,this.ecd,"rehearsePresentationTopBar"));this.la.pptEditorRehearsalSpeechClientEnabled&&(this.ia.ya(aa.a.wHc,$b.a.application,Object(C.a)(this,this.wHc,"enableSubtitlesKeyboardShortcut")),this.ia.ya(aa.a.vHc,$b.a.application,Object(C.a)(this,this.vHc,"enableLivePresenterKeyboardShortcut")));this.LZh();this.ia.ya(aa.a.Tfb,
$b.a.application,Object(C.a)(this,this.Tfb,"showEditTriPaneView"));this.kc.ka("PPTSorterViewEnabled")&&(this.Qje=this.kc.ka("FeedbackPaneExperienceIsEnabled")&&this.kc.ka("HelpTabIsEnabled"),this.ia.ya(aa.a.XUb,$b.a.application,Object(C.a)(this,this.XUb,"closeEditTriPaneView")));this.la.$Rc&&(ba.a.pa(361),this.GUa.ruj(u.AFrameworkApplication.buildVersion,this.Za.qk,u.AFrameworkApplication.userSessionId,this.Cc))}Fe(){if(this.kc.ka("SlideShowByShortcutEnabled")){const a=this.Ga.Bc(y.AFrame.kj);y.AFrame.Uj(a,
A.KeyInputManager.La(x.a.coc,A.KeyInputManager.He|4),aa.a.mYa);y.AFrame.Uj(a,A.KeyInputManager.La(x.a.coc,A.KeyInputManager.He),aa.a.Xkc)}}LZh(){this.ia.ya(aa.a.tfc,$b.a.application,Object(C.a)(this,this.tfc,"presentLive"));this.ia.ya(aa.a.H$c,$b.a.application,Object(C.a)(this,this.H$c,"presentLiveTopBar"));this.ia.ya(aa.a.ydb,$b.a.application,Object(C.a)(this,this.ydb,"presentLiveSetAccessControlAnyone"));this.ia.ya(aa.a.G$c,$b.a.application,Object(C.a)(this,this.G$c,"presentLiveSetAccessControlOrganization"));
this.ia.ra(aa.a.mgc,$b.a.application,Object(C.a)(this,this.mgc,"queryPresentLiveAccessControlAnyone"),96);this.ia.ra(aa.a.ngc,$b.a.application,Object(C.a)(this,this.ngc,"queryPresentLiveAccessControlOrganization"),96);lb.a.instance.Oa("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(a=>{a.h2("L_PublicLivePresentations",!0).then(b=>{b||(za.a.J(594899416,822,15,"Public Live Presentations is disabled by publiclivepresentations policy"),this.ia.gO(aa.a.ydb,Db.a.application,Object(C.a)(this,
this.ydb,"presentLiveSetAccessControlAnyone")),gb.App.Fb.bZa(aa.a.ydb,Object(C.a)(new yp,(new yp).FBa,"getCommandById")));return null},b=>{za.a.J(594899414,822,10,"Could not get publiclivepresentations policy {0}",b);return null})})}JDb(a,b,c,f,l){a=(a=this.ua.Ca)?a.Ge+1:0;a=(b=this.Ub.wj())?String.format(ResourceStrings.l_SlideMenuButtonLabel,a,b):ResourceStrings.l_Slide;l[Bq.a.Value]=a;l[tm.a.labelText]=a;return 32}gad(a,b,c,f,l){this.Pb&&0!==this.Pb.Aw?l.Yf(!1):l.Yf(!0);return 32}cbd(a,b,c,f,l){(a=
Object(ua.a)(Kh.a,l))&&(1!==this.Pb.Aw?a.Yf(!1):a.Yf(!0));return 32}Tfb(a,b,c){try{if(1===c)return 32;2===c&&0!==this.Pb.Aw&&(za.a.J(50656671,822,50,"ViewSwitchingActor: ShowEditTriPaneView."),this.Pb.Aw=0,this.Rb&&(this.Rb.slidePane.kn(),this.Rb.thumbnailPane.kn(),this.Rb.notesPane.kn(),this.la.zWa&&this.SG&&this.SG.setVisibility(!0)),this.ia.processAction(aa.a.$Eb,2),this.ia.processAction(aa.a.kDc,2),this.SN.C4("PptEditingStatusBar.Notes",!0),this.SN.C4("PptEditingStatusBar.ZoomScale",!0),this.SN.C4("PptEditingStatusBar.FitToWindow",
!0),this.Qje?this.SN.C4("PptEditingStatusBar.GiveFeedbackPane",!0):this.SN.C4("PptEditingStatusBar.GiveFeedback",!0),this.Xc.ND(new Xp.a(2)),this.Xc.ND(new Xp.a(1)),this.ph.SJ(Xd.a.ZD),this.ph.SJ(Xd.a.Pua),this.ph.SJ(Xd.a.sg),this.ph.SJ(Xd.a.QM))}catch(f){za.a.J(50656673,822,10,"ViewSwitchingActor - Expcetion in ShowEditTriPaneView: {0}.",f)}return 32}XUb(a,b,c){try{if(1===c)return 32;2===c&&(this.Rb&&(this.Rb.slidePane.Pu(),this.Rb.thumbnailPane.Pu(),this.Rb.notesPane.Pu(),this.la.zWa&&this.SG&&
this.SG.setVisibility(!1)),this.SN.C4("PptEditingStatusBar.Notes",!1),this.SN.C4("PptEditingStatusBar.ZoomScale",!1),this.SN.C4("PptEditingStatusBar.FitToWindow",!1),this.Qje?this.SN.C4("PptEditingStatusBar.GiveFeedbackPane",!1):this.SN.C4("PptEditingStatusBar.GiveFeedback",!1),this.Xc.ND(new Xp.a(2)),this.Xc.ND(new Xp.a(1)),this.ph.ap(Xd.a.ZD),this.ph.ap(Xd.a.Pua),this.ph.ap(Xd.a.sg),this.ph.ap(Xd.a.QM),this.sa.Rh())}catch(f){za.a.J(50656675,822,10,"ViewSwitchingActor - Exception in CloseEditTriPaneView: {0}.",
f)}return 32}jgl(a,b,c){if(this.Df.gd(this.Wb.Bf))return 16;if(1===c)return this.ua.Ca?32:16;b=(new Date).getTime();let f=Jf.a.aj(window.document.URL,dg.a.c2g,dg.a.readingView,!0);if(!this.ua.Ca)throw Error.argumentNull("ActiveSlide is null");c=this.ua.Ca.Cb;f=Jf.a.aj(f,dg.a.eec,c?c.sid.toString():"",!0);f=this.Cwb.instance&&this.Cwb.instance.isVisible?Jf.a.aj(f,dg.a.b2g,"1",!0):Jf.a.removeParameter(f,dg.a.b2g,!0);this.oji();f=Jf.a.aj(f,u.AFrameworkApplication.$4c,b.toString(),!0);this.sa.Rh();this.Ga.Bd();
this.lu.show(!0,a);this.CD.d2(!1,!0,()=>{this.urh(f)},()=>{za.a.J(18985243,818,10,"SwitchingToReadingMode: ForceSave triggered failed.");this.urh(f);return!0});return 32}urh(a){this.ebc.openWindow(1,a,!1)||this.lu.hide()}sfc(a,b,c){return this.mgb(a,c,null)}mDb(a,b,c){return this.mgb(a,c,null)}K9c(a,b,c){return this.mgb(a,c,null)}uel(a,b,c){return this.mgb(a,c,null)}mYa(a,b,c){return this.mgb(a,c,this.ua.Ca?this.ua.Ca.Cb:null)}mgb(a,b,c,f=!1,l=!1){if(!this.la.$Rc)return this.$dl(a,b,c);if(this.Df.gd(this.Wb.Bf)||
!this.Ub.wj()||this.la.preventDuplicateSlideShowLaunches&&this.GUa.y4b()||this.la.allowDisablingSlideShowButtonDueToRehydration&&this.GUa.W3d)return 16;1!==b&&(this.la.Irg&&!qd.a("DummyChangeGateForTest")&&za.a.J(593880152,830,100,"StartSlideShow::DummyChangeGateForTest is disabled"),this.Sv.hasDeferredContent()&&za.a.J(524820961,830,100,"StartSlideShow attemped with deferred content"),this.tel(c,f,l));return 32}tel(a,b,c){this.Ayb=(new Date).getTime();this.sa.Rh();this.Ga.vf(Xd.a.VC);this.Xc.g9g();
za.a.J(21881282,830,50,"ViewSwitchActor.StartSlideShowFrom Should HideSlideShowButton: {0}",this.GUa.W3d);const f=a?a.sid:-1;a=(a=a?Object(ua.a)(131,this.Ub.dCa(a.sid)):null)?a.Ge+1:-1;let l=!1;this.so.instance?l=this.so.instance.XY?!0:!1:za.a.J(38311329,818,15,"StartSlideShowFrom: m_podSeamlessFailoverManager is null.");this.GUa.gHb(f,a,b,this.kc.Ia(ba.a.pa(361)),this.Za.qk,this.Za.podSessionId,this.kc.Ia(ba.a.pa(387)),u.AFrameworkApplication.userSessionId,this.la.hJj,this.Ayb,l,this.Za,c);this.GUa.xY(Object(C.a)(this,
this.R6c,"onExitSlideshowHandler"));this.QA.obl()}ecd(a,b,c,f){return this.cma(a,b,c,f,{entryPoint:4})}cma(a,b,c,f,l){switch(c){case 2:if(!this.ua.Ca)throw Error.argumentNull("ActiveSlide is null");this.la.pptEditorRehearsalSpeechClientEnabled&&(b=0,l&&(b=l&&"entryPoint"in l?l.entryPoint:1),this.ia.Ma(aa.a.Vkc,2,b),this.Cc&&(this.Cc.iBa=!1),this.Nb&&this.Nb.instance&&(this.Nb.instance.iBa=!1));return this.GUa.y4b()?(this.Cc&&(this.Cc.Ih=!1),32):this.mgb(a,c,this.ua.Ca.Cb,!0);case 1:if(0<this.Ub.wj())if(this.la.pptEditorRehearsalSpeechClientEnabled){if(32===
this.ia.processAction(aa.a.rIa,1)&&32===this.ia.processAction(aa.a.Vkc,1))return 32;break}else return this.ia.processAction(aa.a.rIa,1);else break;default:za.a.J(41793153,822,10,"RehearsePresentation: Unimplemented action behavior")}return 8}wHc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Cc)return this.Cc.iBa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:za.a.J(51454214,822,10,"EnableSubtitlesKeyboardShortcut: Unimplemented action behavior")}return 8}vHc(a,
b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Nb&&this.Nb.instance)return this.Nb.instance.iBa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:za.a.J(592226443,822,10,"EnableLivePresenterKeyboardShortcut: Unimplemented action behavior")}return 8}H$c(a,b,c,f,l){return this.tfc(a,b,c,f,l)}tfc(a,b,c){if(this.oGg){try{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0))}catch(f){za.a.J(574448150,833,10,
"ViewSwitchingActor::PresentLive unhandled exception: {0}",f)}return 8}if(1===c)return this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&this.Nb.instance.a5a?0<this.Ub.wj()?32:8:8;this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&(this.Nb.instance.hBa=!0);if(!this.ua.Ca)throw Error.argumentNull("ActiveSlide is null");return this.mgb(a,c,this.ua.Ca.Cb,!1,!0)}ydb(a,b,c){if(1===c)return this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&this.Nb.instance.a5a?32:8;this.Nb.instance.Cq&&0!==this.Nb.instance.accessControl?
this.Nb.instance.showEndSessionDialog(()=>{this.Nb.instance.aYb(5);this.Nb.instance.accessControl=0;this.Xc.ND(new Xp.a(1))},()=>{}):(this.Nb.instance.accessControl=0,this.Xc.ND(new Xp.a(1)));return 32}G$c(a,b,c){if(1===c)return this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&this.Nb.instance.a5a&&this.Nb.instance.L0f?32:8;this.Nb.instance.Cq&&1!==this.Nb.instance.accessControl?this.Nb.instance.showEndSessionDialog(()=>{this.Nb.instance.aYb(5);this.Nb.instance.accessControl=1;this.Xc.ND(new Xp.a(1))},
()=>{}):(this.Nb.instance.accessControl=1,this.Xc.ND(new Xp.a(1)));return 32}mgc(a,b,c,f,l){try{const w=Object(ua.a)(Kh.a,l);w&&this.Nb.instance&&w.Yf(0===this.Nb.instance.accessControl)}catch(w){za.a.J(50452242,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlAnyone unhandled exception: {0}",w)}return 32}ngc(a,b,c,f,l){try{const w=Object(ua.a)(Kh.a,l);w&&this.Nb.instance&&w.Yf(1===this.Nb.instance.accessControl)}catch(w){za.a.J(50452244,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlOrganization unhandled exception: {0}",
w)}return 32}$dl(a,b,c){if(this.Df.gd(this.Wb.Bf))return 16;if(1===b)return this.Ub.wj()?32:16;this.Ayb=(new Date).getTime();this.sa.Rh();this.Ga.vf(Xd.a.VC);this.Xc.g9g();this.lu.show(!0,a);this.CD.d2(!1,!0,()=>{this.xgh(c,this.Ayb)},()=>{za.a.J(18985245,818,10,"StartSlideShowFrom: ForceSave triggered failed.");this.xgh(c,this.Ayb);return!0});return 32}R6c(a,b){a=((new Date).getTime()-this.Ayb).toString();za.a.J(22578058,830,50,"ViewSwitchingActor.OnExitSlideshowHandler: Exit slideshow. Duration: {0}. HasDeferredContentInFile: {1}, HasDeferredContentOnSlide: {2}",
a,this.Sv.hasDeferredContent(),this.Sv.k3d(b.slideId.toString()));this.Sv.hasDeferredContent()||this.Sv.k3d(b.slideId.toString())?this.Sv.opa("DeferredExitSlideshowDuration",a):this.Sv.opa("ExitSlideshowDuration",a);this.GUa.R_(Object(C.a)(this,this.R6c,"onExitSlideshowHandler"));(this.Ita=b)&&!this.Ita.CAj&&!this.Ita.uEj&&0<this.Ita.slideId&&0<=this.Ita.slideIndex&&this.Ibk(this.Ita.slideId,this.Ita.slideIndex);this.Ga.Bd();this.MHg?(this.rEa=Kc.a.Nm("ExitSlideshow"),this.Df.blockContent(this.Wb.Bf,
"ExitSlideshow"),this.dLg.yk(Object(C.a)(this,this.QYg,"onPageManifestNodePropertyChanged")),this.rEa.Ya("UnlockPodsSessionStartTime",Kc.a.Ve(new Date)),this.unlockPodsSession(c=>{this.rEa&&(this.rEa.Ya("UnlockPodsSessionWithMerge",c.toString()),this.rEa.Ya("UnlockPodsSessionEndTime",Kc.a.Ve(new Date)));c?this.Xu.pSi():this.VEe()})):this.VEe()}VEe(a=null){a&&(this.V1c=null);this.Ita&&(this.MHg&&(this.dLg.Pm(Object(C.a)(this,this.QYg,"onPageManifestNodePropertyChanged")),this.Df.mJ(this.Wb.Bf),this.rEa&&
(this.rEa.Ya("InboundPresentationEndTime",Kc.a.Ve(new Date)),this.rEa.finish(),this.rEa=null)),this.Ita=null,this.QA.BSk())}unlockPodsSession(a){const b=xg.a.create().toString();za.a.J(23667222,830,50,"ViewSwitchingActor.UnlockPodsSession: Unlock Pods session, correlation={0}",b);const c=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked=false",u.AFrameworkApplication.fa.appSettings[ba.a.pa(361)],this.Za.podSessionId),f={WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=
u.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;f["X-WacCluster"]=this.Za.qk;this.lih(c,f,0,a)}lih(a,b,c,f){this.Dz.Jj(a,2,null,b,!1,2,l=>{this.rpl(l,c,f)},l=>{this.Fyh(l,a,b,c,f)},null,void 0,void 0,void 0,void 0,tx.a("2"))}rpl(a,b,c){if(b)za.a.J(41445527,830,50,"ViewSwitchingActor.UnlockPodsSession: Succeed with retry: {0}",b);else{b=!1;try{a.data.je&&0<a.data.je.length&&(b=JSON.parse(a.data.je).FMerged)}catch(f){za.a.J(23667224,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed to deserialize unlock Pods session response: {0}",
a.toString())}c(b)}}Fyh(a,b,c,f,l){f||l(!1);3>f?this.lih(b,c,f+1,l):za.a.J(23667226,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed with status code: {0}, retry count: {1}",this.t_c.Vha(a),f)}QYg(a,b){this.V1c||b.property!==zb.a.i2b||(this.V1c=new Se.a(2,1,0,Object(C.a)(this,this.VEe,"resumeEditor"),90,"65"),this.Bb.Hb(this.V1c))}xgh(a,b){this.lu.hide();let c=!0,f=!1,l=this.Qd.slideShowUrl;l||(l=Jf.a.aj(window.document.URL,dg.a.c2g,dg.a.slideShowView,!0),f=!0);l=Jf.a.removeParameter(l,dg.a.bqk);
l=a?Jf.a.aj(l,dg.a.eec,a.sid.toString(),!0):Jf.a.removeParameter(l,dg.a.eec);0<b&&(l=Jf.a.aj(l,u.AFrameworkApplication.$4c,b.toString(),!0));a=String.format("menubar=false,fullscreen=yes,scrollbars=yes,resizable=yes,left=0,top=0,width={0},height={1}",window.screen.width,window.screen.height);b=null;try{b=this.ebc.pwe(4,l,"SlideShowWindow",a,f,!1)}catch(w){za.a.J(8956055,818,10,"StartSlideShowFrom: Exception throw trying to open the window. {0}",w),c=!1}b||(za.a.J(8956057,818,10,"StartSlideshowFrom:: failed to open slide show window"),
c=!1);Kc.a.ik("Window Opened",c.toString());Kc.a.Bkd()}Yqb(a,b,c){if(2!==c)return this.ia.processAction(G.a.close,c);a=this.ia.processAction(G.a.close,2);32!==a&&(za.a.J(8956059,801,50,"Close action failed to execute. Response: {0}",a),window.location="about:blank");return 32}Ibk(a,b){za.a.J(22684434,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideIndex={0}",b);(a=this.Ub.dCa(a))?this.Je.rda(a.Ge):(za.a.J(22684436,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideId does not exist.  Navigate to slide index {0}.",
b),a=this.Ub.wj()-1,b=b>a?a:b,0>b||this.Je.rda(b))}oji(){this.L9a.instance&&this.L9a.instance.nRa&&(this.L9a.instance.sFc.GB?this.L9a.instance.endCommentSession(this.L9a.instance.sFc.GB.draftId,7):this.L9a.instance.endCommentSession("",7),this.L9a.instance.YAf())}pji(){this.la.powerPointLiveBroadcastEnabled&&lb.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(a=>{a.isFeatureEnabled("PowerPointLivePresentations",!1).then(b=>{b||(za.a.J(591184925,822,15," User doesn't have license for PPTLive, Hiding Present Live button"),
this.oGg=!0);return null})})}}Object(e.a)(RN,"ViewSwitchingActor",null,[234]);class SN{constructor(a,b){this.eDg=null;this.Za=a;this.cVa=b;this.THf();this.Za.lCf(Object(C.a)(this,this.d8c,"onSessionInfoChanged"))}THf(){const a=new Sys.StringBuilder;a.append(String.format("?{0}",this.Za.presentationId.string));a.append(String.format("&{0}={1}",dg.a.sYk,this.Za.dqb));let b;b=ba.a.pa(368)in u.AFrameworkApplication.fa.appSettings?void 0===this.Za.sessionInfo||null===this.Za.sessionInfo?"undefined":this.Za.sessionInfo:
this.Za.sessionInfo;a.append(String.format("&{0}={1}",dg.a.Mda,b));this.Za.qk&&a.append(String.format("&{0}={1}",dg.a.d2g,this.Za.qk));this.Za.podSessionId&&a.append(String.format("&{0}={1}",dg.a.C9,this.Za.podSessionId));a.append(String.format("&{0}=",dg.a.aqk));this.eDg=a.toString()}d8c(){this.THf()}resolve(a,b){return b&&b.length?b.startsWith("./"+a)?b:this.cVa+a+this.eDg+b:null}dispose(){this.Za.DNk(Object(C.a)(this,this.d8c,"onSessionInfoChanged"))}}Object(e.a)(SN,"ResourceViewElementResolver",
null,[361,109]);var VQ=d(1002),WQ=d(929);class TN{constructor(a,b){this.ZVc=this.Y2=0;this.TIg=null;this.UIg=-1;this.VIg=null;this.Tsa=a;this.zc=b}get Q7d(){return 0<this.ZVc}get hyg(){return this.TIg}ifk(a){this.ZVc++;this.zc.srh(a.CcpId,a.CcpCorrelation)}get Sae(){return this.VIg}set Sae(a){this.VIg=a}lVg(a,b){if(!a){const c=this.cfj(b);c>this.UIg&&(this.UIg=c,this.TIg=b.CcpId)}0<this.ZVc?this.ZVc--:za.a.J(20760084,307,15,"ClipServiceManager - bad state");this.zc.XYf(b.CcpId,a,0)}qOd(a,b,c=!1,f=
!1){a=Object.assign(new WQ.a,{OY:32,Dp:xg.a.create().toString(),version:this.Y2++,location:this.Tsa.ccpInfo,eE:this.Tsa.qk||zp.a.BCh,dataType:a,objectCount:b,YCa:c,WCa:f,Py:xg.a.create().toString()});za.a.J(24945860,307,50,"CreateClipServiceObject: A ClipServiceObject was just created for Ccpid: {0}.",a);return a}cfj(a){let b=null;a:{var c=a.PackageAccessKey;let l;l=null;if(c)try{const w=md.a(c);if(w&&"I"in w&&"V"in w){l=new Ws(w.I,parseInt(w.V));var f={returnValue:!0,Py:l};break a}}catch(w){}f={returnValue:!1,
Py:l}}if(({Py:b}=f).returnValue&&b)return b.version;za.a.J(21066257,307,15,"Fail to parse packageAccessKeyString for ccpid: {0}",a.CcpId);return-1}}Object(e.a)(TN,"ClipServiceManager",null,[349]);class UN{constructor(a,b,c,f,l,w,F,S,fa){this.gh=a;this.Y7b=c;this.wac=f;this.Jde=l;this.ju=w;this.zc=F;this.f_=S;this.ia=fa;this.fl=b;this.rca=this.gh.contentWindow.document.body;this.ju.addHandler(this.rca,ra.a.cut,Object(C.a)(this,this.$Vg,"onBrowserCut"));this.ju.addHandler(this.rca,ra.a.copy,Object(C.a)(this,
this.ZVg,"onBrowserCopy"))}get Mc(){return this.Y7b.Mc}dispose(){this.gh&&this.gh.contentWindow&&(this.ju.removeHandler(this.rca,ra.a.cut,Object(C.a)(this,this.$Vg,"onBrowserCut")),this.ju.removeHandler(this.rca,ra.a.copy,Object(C.a)(this,this.ZVg,"onBrowserCopy")));this.gh=null}$Vg(){if(fl.dA&&!fl.dA.ZTd){var a=this.zc.oO(1,0,"OnBrowserCut");this.vqa(Object.assign(new Xs(!0,!0),{Tb:a}))}}ZVg(){if(fl.dA&&!fl.dA.ZTd){var a=this.zc.oO(0,0,"OnBrowserCopy");this.vqa(Object.assign(new Xs(!0),{Tb:a}))}}uP(a){if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",
!1)&&(u.AFrameworkApplication.DQ||u.AFrameworkApplication.AL)&&!u.AFrameworkApplication.K4a)return!1;for(let b=0;b<this.fl.length;b++)if(this.fl[b].uP(a))return!0;return!1}vqa(a){if(this.ia.JV)this.f_?(this.f_.show(5,-1),this.zc.Eg(!1,a.Tb,26)):za.a.J(545047123,826,10,"m_offlineModalCallout is null");else if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&(u.AFrameworkApplication.DQ||u.AFrameworkApplication.AL)&&!u.AFrameworkApplication.K4a)this.zc.Eg(!1,
a.Tb,32);else{var b=0,c=!1;for(var f=0;f<this.fl.length;f++)if(this.fl[f].uP(a)){c=!0;this.fl[f].vqa(a)||(b=21);break}switch(a.dataType){case 2:f=2;break;case 1:f=19;break;default:f=0}this.zc.dB(f,a.Tb);if(c){if(a.frg&&(this.Jde.Oeb(this.gh),!a.tNi)){if(!this.wac){this.zc.Eg(!1,a.Tb,1);return}this.wac.copy(this.gh)||0!==b||(b=22)}this.zc.Eg(0===b,a.Tb,b)}else this.zc.Eg(!1,a.Tb,20)}}}Object(e.a)(UN,"CutCopyManager",null,[344,109]);var XQ=d(882);class VN{constructor(a,b,c){this.IW=a;this.IW.yk(Object(C.a)(this,
this.Ah,"onPropertyChanged"));this.lL=b;this.lL.yk(Object(C.a)(this,this.Ah,"onPropertyChanged"));this.lq=c}Ah(a,b){this.lq.yq&&0<this.lq.yq.length&&(this.lq.yq=Ma.a.tna(this.lq.yq,c=>!(Fa.a.dP(c.id,b.node.id)||Object(Ca.a)(Av.a,c))));this.lq.yq&&!this.lq.yq.length&&(this.lq.yq=null)}}Object(e.a)(VN,"GraphNodeChangeListener",null,[]);class WN{constructor(a,b){this.S6b=null;a&&b&&new VN(a,b,this)}get yq(){return this.S6b}set yq(a){const b=this.S6b&&0<this.S6b.length?this.S6b[0]:null,c=a?a[0]:null,
f=!!b&&!!c&&b.id.equals(c.id)&&b.zDf;this.S6b=a;c&&(c.zDf=f,c.mNf=f&&b?b.mNf:XQ.a.create().toString())}}Object(e.a)(WN,"InternalClipboard",null,[343]);class XN{constructor(a,b,c,f,l,w,F,S,fa,xa){this.hCg=a;this.ij=b;this.Uca=c;this.nFa=f;this.C8=l;this.Fa=w;this.pke=F;this.gIg=S;this.$0j=fa;this.b_c=xa}CHe(a,b,c){this.hCg.CHe(a,b,c);b=new jM.a;this.pke&&c||(b.setValue(ob.a.bold,!1),b.setValue(ob.a.underline,!1),b.setValue(ob.a.kw,od.Font.fU),b.setValue(ob.a.strikethrough,!1),b.setValue(ob.a.italic,
!1),b.setValue(ob.a.As,!1),b.setValue(ob.a.sZ,!1));this.ij.NIe(a,b)}QHe(a,b,c){const f=b.cache;if(this.b_c){var l=this.h_i(b);Ja.a.Xa(l)||c?f.propertySet.Sa(ob.a.font)&&(f.ta(zb.a.tRc,!1)||c)&&this.ij.rX(a,f.VM):this.ij.rX(a,l);f.Era&&this.ij.rr(a,f.fontSize)}else this.hCg.QHe(a,b,c);(!this.gIg||this.pke&&c)&&f.w2&&(this.ij.gm(a,ob.a.fontColor,f.fontColor),this.gIg&&(l=oi.SchemeColor.create(null,f.fontColor),this.ij.gm(a,zb.a.schemeColor,l.toString())));this.pke&&c&&(this.ij.cJ(a,f.isBold),this.ij.setItalic(a,
f.isItalic),this.ij.uX(a,f.YE),this.ij.ffb(a,f.pZ),this.ij.e0(a,f.mD),this.ij.Lma(a,f.kw),this.ij.BXa(a,f.As),this.ij.kfb(a,f.sZ),this.ij.G4(a,f.ZE),this.ij.wX(a,f.isSuperscript),this.ij.yXa(a,f.zn));this.ij.BXa(a,!1);this.O1k(a,b)}vZd(a){return this.Uca.XPa(a)}qV(a){return this.Uca.qV(a)}hQa(a){return this.nFa.hQa(a)}d7(a){return this.C8.d7(a)}O1k(a,b){b=b.rz;if(null!==b&&b.Sa(zb.a.nHa)){b=b.getValue(zb.a.nHa);var c=a.rz;null===c?this.ij.gm(a,zb.a.nHa,b):c.setValue(zb.a.nHa,b)}}Qnh(a){return this.$0j&&
a&&(a=a.paragraph)&&(a=this.Fa.$m(a))&&a.fg?!0:!1}h_i(a){if(!this.b_c||!a)return null;let b="";var c=a.paragraph;if(!c)return null;var f=this.Fa.$m(c);if(!f)return null;a=f.ta(Sb.a.BZ,[]);c=c.ta(Sb.a.listLevel,qg.a.zCa);a&&0<=c&&c<a.length&&(f=f.Eh)&&(a=f.te(a[c]))&&(a.Sa(zb.a.qQd)?b=a.getValue(zb.a.qQd):a.Sa(zb.a.nQd)?b=a.getValue(zb.a.nQd):a.Sa(zb.a.kQd)?b=a.getValue(zb.a.kQd):a.Sa(zb.a.uQd)&&(b=a.getValue(zb.a.uQd)));return b}}Object(e.a)(XN,"PPTFormattingStewardBridge",null,[318]);class YN{constructor(a,
b,c,f){this.Ib=a;this.zac=b;this.uc=c;this.Rz=f}}Object(e.a)(YN,"PPTFormattingStewardHelper",null,[327]);class ZN{constructor(a,b,c,f,l){this.x3j=[Sb.a.Hl,Sb.a.Jn];this.la=a;this.qwb=b;this.IFg=c;this.FN=f;this.Ib=l;this.a_c=a.xug;this.sta=a.pptCopyPasteListMarkerEnabled;this.M8b=a.pptCopyPasteMarginAndIndentationEnabled}QQe(a){return this.qwb.YHj(a)}I2d(a,b){return this.qwb.gLi(a,b)}Jma(a,b,c,f=null,l=null){if(this.IFg.o9c)if(this.qwb.Krg(c))a.setValue(Kd.a.Vrg,!0);else if(this.qwb.Pk(c)){if(this.M8b&&
a&&b){var w=this.Ib.Jc(a);w.oc(11);w.Og(11);c=yc.ListReader.$j(w);const F=this.FN.m_i(a,w);w=this.FN.i_i(a,w);c&&(f||(za.a.J(41219841,826,50,"Default marginLeft for internal"),b[Sb.a.Hl.id.toString()]=F),l||(za.a.J(41219843,826,50,"Default textIndent for internal"),b[Sb.a.Jn.id.toString()]=w));f&&za.a.J(41018240,826,50,"Customized marginLeft");l&&za.a.J(41018242,826,50,"Customized textIndent")}this.IFg.Jma(a,b)}if(this.la.iSc&&!db.ParagraphReader.FV(a))for(const F of this.x3j)void 0===a.Uh(F)&&a.ke(F,
0)}OFb(a,b,c){if(this.a_c){var f=b.propertySet.Sa(ob.a.fm)?b.propertySet.getValue(ob.a.fm).length:1;if(a=this.FN.wP(a,b.propertySet.ta(Sb.a.listLevel,0)))if(this.sta&&(0<c.Pnb||c.vNa&&0<c.vNa.length)){f="";b.b7a&&!b.mig&&(f=c.font);let l=null;c.vNa&&0<c.vNa.length&&(l=c.vNa,1===c.vNa.length&&za.a.J(41219847,826,50,"Customized bullet."));let w=-1;0<c.Pnb&&(w=c.Pnb,za.a.J(41219849,826,50,"Customized number list."));this.FN.nEc(a,b.propertySet);l&&b.propertySet.setValue(ob.a.fm,l);Ja.a.Xa(f)||b.propertySet.setValue(ob.a.font,
f);0<w&&b.propertySet.setValue(zb.a.autonumberBulletType,w)}else a.ta(ob.a.fm,[]).length===f&&this.FN.nEc(a,b.propertySet)}}VRc(a){return this.qwb.VRc(a)}get OSc(){return this.qwb.OSc}c0(a,b){2===b.Of?(a.setValue(zb.a.TV,2),a.setValue(zb.a.Iw,b.value)):za.a.J(36779851,826,50,"the un-support text spacing unit")}fIa(a,b){b.beforeSpacing.value&&(a.setValue(zb.a.gca,b.beforeSpacing.value),a.setValue(zb.a.lja,4));b.afterSpacing.value&&(a.setValue(zb.a.fca,b.afterSpacing.value),a.setValue(zb.a.kja,4))}Ykh(a,
b){const c=(new Yu.a(b.Of,b.value)).aM;1===b.specialIndentType?a.setValue(Sb.a.Jn,c):2===b.specialIndentType?a.setValue(Sb.a.Jn,-c):0===b.specialIndentType&&a.setValue(Sb.a.Jn,0)}Pjh(a,b){b=(new Yu.a(b.Of,b.value)).aM;a.setValue(Sb.a.Hl,b)}get Tnh(){return!0}}Object(e.a)(ZN,"PPTPasteStewardBridge",null,[325]);class $N extends Wu{constructor(a,b){super(a,b)}dKc(){return["PasteSlide"]}}Object(e.a)($N,"PasteSlideReactFloatie",Wu,[]);class aO{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,
Td,we,Pd,He,Pe){this.Mhg=!1;this.pQ=[];this.H$b=[];this.Zce=[];this.xfe=0;this.qc=c;this.sa=f;this.Gbb=l;this.Fbb=w;this.Zka=F;this.jd=S;this.Tme=Td;this.zd=a;this.h7j=b;this.Dk=Za;this.l4j=fa;this.uN=xa;this.Wb=pb;this.Ga=Mb;this.mr=hc;this.f_j=kc;this.YZj=Ec;this.Zb=Hc;this.WMg=Dc;this.kc=we;this.p4j=Pd;this.nLg=He;this.gh=Pe;this.M9a=lb.a.instance.qb("Common.IReactContextualUILauncher");this.exb=lb.a.instance.qb("Common.IExternalUICommandDefinitionMapping")}w9(a){2===a.behavior&&(a=a.actionId,
a!==aa.a.r3a&&a!==aa.a.uNa&&a!==aa.a.oGa&&a!==aa.a.pla&&a!==aa.a.Lpa&&a!==aa.a.YR&&a!==aa.a.insertPicture&&a!==aa.a.oGa&&a!==aa.a.x5a&&a!==aa.a.jWd&&a!==aa.a.HJc&&a!==aa.a.insertPicture&&a!==aa.a.iWd&&a!==aa.a.U3g&&a!==aa.a.q9c||this.NM(new na(!0)))}u9(){}O_h(){this.Tme&&!this.Mhg&&(this.sa.VJ(Object(C.a)(this,this.IGa,"onSelectionChange")),this.h7j.Cd(7).ZF(Object(C.a)(this,this.YA,"onChildTopologyChanged")),this.zd.LMa(Object(C.a)(this,this.A9,"onThumbnailDrawCompleted")),ad.a.addHandler(this.Zka.cX,
"scroll",Object(C.a)(this,this.hXa,"scrollHandler")),ad.a.addHandler(this.gh.contentWindow.document.body,ra.a.Rf,Object(C.a)(this,this.onKeyDown,"onKeyDown")),this.jd.pb(ra.a.click,this.Zka.cX,Object(C.a)(this,this.ZC,"clickHandler")),u.AFrameworkApplication.Ba.Aga(Object(C.a)(this,this.dea,"resizeHandler")),this.l4j.H2a(Object(C.a)(this,this.C_,"onSlidePresenceChanged")),this.Dk.oCf(Object(C.a)(this,this.Qve,"onSlidesIdReturned")),this.f_j.Mzc(Object(C.a)(this,this.Z7c,"onRevisionProcessedOnServerHandler")),
this.YZj.j2h(Object(C.a)(this,this.sfk,"onBlockingHandler")),this.p4j.hCf(Object(C.a)(this,this.Cjk,"onOnlyKeyPressed")),this.Mhg=!0)}Cjk(){if(eN.a.instance.keyCode===x.a.Rea){const c=document.getElementById("PasteSlideControl");if(c){var a=id.a.ei(c),b=this.WMg.za.style.height;a.y+a.height+61+2<parseInt(b.substr(0,b.length-2))+Ez.a.DRe?za.a.J(520710039,826,10,"recoveryUIElement rendering to wrong place"):(a=c.getAttribute(re.a.nnb)||"",re.a.Bpa===a&&c.click())}else za.a.J(523899735,826,10,"recoveryUIElement is null")}}onKeyDown(a){a.keyCode===
x.a.B0&&this.NM(new na(!0))}sfk(a,b){1===b.block?this.NM(null):2===b.block&&this.NM(new na(!0))}Z7c(a,b){b&&(a=b.L9)&&a.ActionInformation.ActionId!==""+aa.a.t9c&&a.ActionInformation.ActionId!==""+aa.a.jec&&a.ActionInformation.ActionId!==""+aa.a.s9c&&this.mr.FUc&&this.mr.FUc<parseInt(a.ActionInformation.ActionTime)&&this.NM(new na(!0))}C_(a,b){this.s2f(b.slideId.sid,this.pQ)&&(this.NM(new na(!0)),this.mr.Rfb=!1)}s2f(a,b){for(const c of b)if(c.sid===a)return!0;return!1}Qve(a,b){if(b&&b.zVa){if(this.Zce.length>=
b.zVa.length&&!this.M9a.kub&&(this.setSelection(b.zVa),this.pQ.length===b.zVa.length)){this.showFloatie({},new fm(1,u.AFrameworkApplication.isRtl));let c;(c=this.sa).z2a.apply(c,this.pQ)}this.mr.TGa.length||(this.mr.TGa=b.zVa,Array.clear(this.pQ),Array.clear(this.H$b))}}IGa(a,b){if(this.mr.Rfb){for(a=0;a<b.KD.length;a++)if(Object(ua.a)(4,b.KD[a].context.node)){this.NM(new na(!0));return}!this.Ga.ye||this.Ga.ye.name!==Ai.a.VU&&this.Ga.ye.name!==Ai.a.SIf&&this.Ga.ye.name!==Ai.a.PIf&&this.Ga.ye.name!==
Xd.a.RD&&this.Ga.ye.name!==Xd.a.tK&&this.Ga.ye.name!==Xd.a.$Y||this.NM(new na(!0))}}dea(){this.M9a.kub&&this.NM(new na(!1))}hXa(){this.R9g()}ZC(){this.R9g();return!0}R9g(){if(this.mr.Rfb){const a=new fm(1,u.AFrameworkApplication.isRtl);this.showFloatie(null,a)}}A9(a,b){a=this.mr.TGa;this.Zce.push(b.Ud);if(!this.M9a.kub&&this.mr.Rfb&&a&&a.length>=this.H$b.length&&b.succeeded)for(var c of a)if((b=this.qc.Bk(new Rd.a(c)))&&!this.s2f(b.sid,this.H$b)&&(this.H$b.push(b),this.xfe++,b=a.length,this.xfe===
b)){this.sa.$Wb();this.setSelection(a);var f=void 0;(f=this.sa).z2a.apply(f,this.pQ);if(c=this.r1i())this.Wb.Ca=c;this.xfe=0;c=!0;for(f=0;f<b;f++)(a=this.pQ[f].yg(this.Gbb))&&a.lDb&&a.lDb.$ha()&&0<a.lDb.$ha().length&&(c=!1);c&&this.showFloatie({},new fm(1,u.AFrameworkApplication.isRtl));break}}r1i(){let a=this.pQ.length;if(!a&&(this.setSelection(this.mr.TGa),a=this.pQ.length,!a))return za.a.J(36995209,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;let b=this.pQ[0];for(let c=1;c<a;c++)b.slideIndex>
this.pQ[c].slideIndex&&(b=this.pQ[c]);return b}setSelection(a){if(a&&a.length){Array.clear(this.pQ);for(const b of a)(a=this.qc.Bk(new Rd.a(b)))?this.pQ.push(a):za.a.J(37365080,826,50,"Cannot find the slide")}}N3i(){let a=this.pQ.length;if(!a&&(this.setSelection(this.mr.TGa),a=this.pQ.length,!a))return za.a.J(37335243,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;za.a.J(37365083,826,50,String.format("Pasted slides count is: {0} ",a));let b=this.pQ[0];for(let c=1;c<a;c++)b.slideIndex<
this.pQ[c].slideIndex&&(b=this.pQ[c]);return b}showFloatie(a,b){b.location=this.yLc();if(b.location){const c=this.Zb.gd(this.qc.un);if(!c||c&&a)za.a.J(37335245,826,50,"ShowFloatie number"),this.kc.ka("ReactSlidePasteFloatieEnabled")&&(new $N(this.M9a,this.exb)).Foh(b.location,b.Ru),Array.clear(this.Zce)}}NM(a){this.M9a.kub&&(this.M9a.NM(),a&&(this.mr.Rfb=!a.M1f,a.M1f&&this.mr.hdb&&(a=this.mr.hdb.aA,null!=a&&za.a.J(36995211,826,50,String.format("last user selcted keepSource:{0}",a.toString()))),this.mr.Rfb||
(this.mr.FUc=0)))}koi(a){if(!this.mr.BWb)return!0;a=a.NL;if(a.length!==this.mr.BWb.length)return!0;let b=0;for(let c=0;c<a.length;c++)if(a[c]&&!a[c].equals(this.mr.BWb[c])||!a[c]&&this.mr.BWb[c])if(b++,b>this.H$b.length)return!0;return!1}YA(a,b){this.M9a.kub&&(a=Object(ua.a)(408,b.node))&&this.koi(a)&&this.NM(null)}yLc(){var a=this.N3i();if(!a)return za.a.J(36995213,826,50,null),null;a=a.yg(this.Gbb);if(!a)return za.a.J(36995215,826,50,null),null;a=id.a.ei(a.YHb);const b=a.x+a.width-86;let c=a.y+
a.height+61+2;const f=this.Fbb.za.style.height;var l=this.WMg.za.style.height;l=parseInt(l.substr(0,l.length-2))+Ez.a.DRe;if(c>parseInt(f.substr(0,f.length-2))+l)c=c-a.height/2-2;else if(c<l)return this.NM(new na(!1)),null;this.mr.position=new Sys.UI.Point(b,c);return this.mr.position}}Object(e.a)(aO,"PasteFloatieHelper",null,[326,146]);class ME{constructor(){this.Rfb=!1;this.FUc=0;this.hdb=null;this.dxe=0;this.Aab=[];this.position=this.BWb=null}get TGa(){return this.Aab}set TGa(a){a?this.Aab=a:Array.clear(this.Aab)}}
Object(e.a)(ME,"PasteFromFloatieArgs",null,[]);var YQ=d(1001);class bO{R2b(a){a=a.Vaa;return a===Xd.a.sg||a===Xd.a.ZD}}Object(e.a)(bO,"PasteHandlerUtil",null,[347]);class cO{constructor(a,b,c,f,l,w){this.LS=0;this.ia=a;this.r3=b;this.pFa=c;this.Kw=f;this.Gje=l;this.i0j=w}uP(a){if(!this.pFa.R2b(this.r3.value))return!1;if(this.Kw.wAj(a)){a=Array.isArray(a.yV)?a.yV:null;if(this.soj(a)&&!this.Roj(a))return!1;this.LS=1}else if(this.Gje&&(this.Kw.uAj(a)||this.Kw.tAj(a))){a=this.Kw.S7d(a.Wt);if(!this.i0j&&
a)return Z.ULS.sendTraceTag(36558551,307,50,"Cross-dc shape pasting is not allowed since its BRS is off."),this.LS=0,!1;this.LS=2}else this.LS=0;return 0!==this.LS}paste(a){1===this.LS?this.ia.Ma(aa.a.p9c,2,a):2===this.LS&&this.ia.Ma(aa.a.F2g,2,a)}soj(a){for(const b of a)if(!b.isConnected)return!0;return!1}Roj(a){for(const b of a)if(a=b.shapeNode,!a.sk&&!a.rd)return!0;return!1}}Object(e.a)(cO,"ShapePasteHandler",null,[422]);class dO{constructor(a,b,c,f){this.LS=0;this.ia=a;this.Kw=b;this.r8b=c;this.Q5j=
f}uP(a){this.Kw.zqg(a)?this.LS=1:this.r8b&&this.Kw.vAj(a)?this.LS=2:this.LS=this.Kw.yAj(a)?3:0;return 0!==this.LS}paste(a){a.aA=null!=a.aA?a.aA:!this.Q5j;qd.a("UseClipServiceForDestinationThemePaste")&&1===this.LS&&!a.aA&&a.Wt&&(this.LS=2);1===this.LS?this.ia.Ma(aa.a.q9c,2,a):2===this.LS?(a.Wt?za.a.J(51175496,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams keepsource value {0}",a.aA):za.a.J(51175498,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams is null"),this.ia.Ma(aa.a.s9c,
2,a)):3===this.LS&&this.ia.Ma(aa.a.H2g,2,a)}}Object(e.a)(dO,"SlidePasteHandler",null,[422]);class NE{constructor(a,b,c,f){this.NDg=[Ne.a.Xjg,Ne.a.OHb,Ne.a.Vth,Ne.a.ajd];this.ia=a;this.Ga=b;this.pFa=c;this.Kw=f}uP(a){if(!this.pFa.R2b(this.Ga)||NE.rIj(a)||this.Kw.GNj(a))return!1;a.uP=!this.sri(a.Om);return a.uP}sri(a){for(let b=0;b<this.NDg.length;++b)if(0<a.getElementsByTagName(this.NDg[b]).length)return!0;return!1}paste(a){za.a.J(17310408,826,50,"TextPasteHandler: Execute command to paste text as new shape.");
this.ia.Ma(aa.a.hxe,2,a)}static rIj(a){if(!a||!a.Om)return za.a.J(17310404,826,15,"TextPasteHandler: User attempted to paste null content."),!0;a=Ea.b(a.Om);return a&&a.length?!1:(za.a.J(17310406,826,15,"TextPasteHandler: User attempted to paste empty content."),!0)}}Object(e.a)(NE,"TextPasteHandler",null,[422]);var ZQ=d(861),$Q=d(930),aR=d(433),gA=d(662);class eO{constructor(a,b){this.sva=a;this.pastedContent=b}}Object(e.a)(eO,"PasteContext",null,[]);class fO{constructor(a){this.ple=0;this.lAb=null;
this.x6j=a;this.xbb=this.x6j.KAb("UserAction","TimingLogger");this.reset()}start(){this.reset();this.xbb.start()}nSb(a){if(a&&0<a.length){this.lAb||(this.lAb={});const b=this.xbb.vq;this.lAb[a]=b-this.ple;this.ple=b}}flush(a=null){let b="";a&&0<a.length&&(b=a+":");if(this.lAb){a=this.lAb;for(let c in a)b+=String.format(" {0}={1}ms,",c,a[c])}0<b.length&&za.a.J(20570128,826,50,b);this.reset()}reset(){this.ple=0;this.lAb=null}}Object(e.a)(fO,"TimingLogger",null,[]);class Zp{constructor(){this.objectCount=
0;this.data=this.ccpid=null;this.contentType=this.dataSize=this.errorInCopying=0;this.packageSize=this.packageKey=this.isDataCompressed=null;this.skipUndo=!1;this.selectionSlide=null}static Oxi(a){if(!a)return null;a=a.getData(Zp.lei);return Zp.clg(Zp.M9g(a))}static Pxi(a){return a?Zp.clg(Zp.M9g(a.pptSlide)):null}static clg(a){if(!a||0===a.contentType)return za.a.J(541405764,826,15,"InitPicklingClipboardObject mimetype not supported"),null;a.dataSize=a.data?a.data.length/Zp.gei:Number.MAX_VALUE;a.skipUndo=
!1;za.a.J(540932290,826,50,"InitPicklingClipboardObject successful ccpid: {0}, datasize: {1}, objectCount: {2}, errorCode: {3}",a.ccpid,a.dataSize,a.objectCount,a.errorInCopying);return a}static MNj(a){return!!a&&0<a.objectCount&&!!a.ccpid&&(!!a.data||!a.data&&!!a.errorInCopying)&&null!=a.isDataCompressed}static M9g(a){try{let b=null;if(!a)return null;b=JSON.parse(a);if(Zp.MNj(b))return b.contentType=1,b.errorInCopying=void 0===b.errorInCopying||null===b.errorInCopying?0:b.errorInCopying,b}catch(b){za.a.J(541405765,
826,15,"ReadPicklingData exception occured in parsing")}return null}}Zp.gei=1048576;Zp.lei="ppt/slides";Object(e.a)(Zp,"PicklingClipboardObject",null,[]);var bR=d(663);class hh{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td,we,Pd){this.yke=!1;this.VLg=0;this.yUa=null;this.bac=!1;this.nle=null;this.rke=!1;this.r3=a;this.gh=b;this.lq=c;this.C9a=l;this.la=f;this.fl=w;this.ju=F;this.rca=this.gh.contentWindow.document.body;this.ju.addHandler(this.rca,ra.a.paste,Object(C.a)(this,this.bWg,
"onBrowserPaste"));this.Wd=S;this.oo=fa;this.i8b=Mb;this.ala=new fO(xa);this.wja=pb;this.X9b=null;this.A1j=f.zMj;this.rIg=this.oo.lN(7);this.Kw=Za;this.IS=hc;this.eW=kc;this.Fa=Hc;this.uc=Ec;this.zc=Dc;this.f_=Td;this.ia=we;this.$le=f.pptEditingImageMaxSizeInBytes;this.VJg=Math.floor(f.pptEditingImageMaxSizeInBytes*hh.QGf);this.lHg=f.Dqg;this.r8b=f.B7d;this.a0j=f.tBj;this.UNg=f.BJj&&this.oo.IV;this.Oke=this.k_c=!1;this.Gje=f.A7d;this.zHg=f.Mrg&&this.oo.Xn;this.N5j=f.s2i&&this.oo.ag;this.CWj=f.pptCopyPasteRotateImageOnSafariFixIsEnabled&&
this.oo.psa;this.u0j=this.la.VDj;this.cQ=Pd}dispose(){this.gh&&this.ju.removeHandler(this.rca,ra.a.paste,Object(C.a)(this,this.bWg,"onBrowserPaste"));this.ala=this.gh=null}nrk(a){a===this.nle.Tb&&this.ia.Ma(aa.a.iec,2,this.nle)}bWg(a){const b=this.zc.oO(2,0,"OnBrowserPaste");this.ala.start();this.k_c=this.rke=!1;if(fl.dA&&!fl.dA.ZTd){!this.oo.nD||this.oo.Gj||this.CWj?Ne.a.SCc(this.gh):this.C9a.Oeb(this.gh);var c=this.eW.tba(a);c=this.Kw.PSc()?Zp.Oxi(c):null;var f=new sE;f.SRd=a;f.v5g=b;null!=this.yUa&&
(this.zc.ai(hh.$If,"menu",b),this.zc.ai(hh.YIf,this.yUa?hh.pei:hh.nei,b));this.bac&&(this.zc.ai(hh.$If,"menu",b),this.zc.ai(hh.YIf,hh.oei,b));!this.bac&&c&&this.u2g(c,null,b,aa.a.r9c,f)?this.yUa=null:(this.t2g(a,b),this.yUa=null,this.bac=!1)}}t2g(a,b){const c=this.eW.tba(a),f=this.eW.p0f(c);this.zc.MIe(f,b);if(!this.Gml(a,b)){var l=Object.assign(new Mm.a(!0),{Tb:b,aA:this.yUa});this.N5j&&(za.a.J(557159435,826,50,"OnBrowserPaste::Getting html data from Clipboard"),a=this.eW.HLc(c),b=this.eW.YVa(a),
a?(this.YLf(b)&&(this.lq.yq[0].E3a=b.firstChild.className,l.yV=null),l.Om=b):za.a.J(557159436,826,15,"OnBrowserPaste::htmlString is empty"));this.nle=l;Kc.a.W9(()=>{this.xte(void 0,l)},0,this.la.VHj?0:2)}}Tii(a){let b=!1;fl.dA.x3a(c=>{za.a.J(524895386,826,50,"CheckAndEnablePasteAsOptions: isAccessible : {0}",c);null!=c&&c&&(b=this.$ii(a))});return b}$ii(a){const b=Date.now();let c=!1;fl.dA.tba(this.gh,a,f=>{za.a.J(525091166,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, time taken : "+
(Date.now()-b));if(f){if(!a)f.html&&f.html.length<=hh.dfi?-1!==f.html.indexOf(hh.xfi)&&(c=!0):f.pptSlide&&f.pptSlide.length&&(c=!0);else if(f.img||f.isImageAvailable)c=!0;c&&(f=[],a?(f.push(appChrome.actions.updateControlEnabledDisabledState(hh.rfi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(hh.qfi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(hh.pfi,!1))):(f.push(appChrome.actions.updateControlEnabledDisabledState(hh.Hei,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(hh.zfi,
!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(hh.Jei,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(hh.Bfi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(hh.Iei,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(hh.Afi,!1))),appChrome.api.dispatch(f));za.a.J(525091169,826,50,"CheckClipboardDataAndEnablePasteAsOptions: isCopiedDataCompatible={0}, time taken : {1}",c,Date.now()-b)}else za.a.J(525091167,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, clipboardObject is null")});
return c}u2g(a,b,c,f,l){b||(b=Object.assign(new Mm.a(!0),{Tb:c,aA:this.yUa}));b.yL=a;this.zc.ai(hh.objectCount,a.objectCount.toString(),c);this.zc.ai(hh.isDataCompressed,null==a.isDataCompressed?!1:a.isDataCompressed.toString(),c);this.zc.ai(hh.sfi,(b.yL.packageSize?null==b.yL.packageSize?0:b.yL.packageSize/hh.QGf:b.yL.dataSize).toString(),b.Tb);return 0!==b.yL.errorInCopying?(za.a.J(541647952,826,15,"PastePicklingData invalid package ccpid: {0}, objectCount: {1}, error: {2}",b.yL.ccpid,b.yL.objectCount,
b.yL.errorInCopying),this.Doh(b.yL.errorInCopying,f,l,b),!0):this.Kw.wIj(b.yL.dataSize)?this.xRd(b):(za.a.J(541647953,826,15,"PastePicklingData package size exceeds limit ccpid: {0}, size: {1}, objectCount: {2}",b.yL.ccpid,b.yL.dataSize,b.yL.objectCount),this.Doh(1,f,l,b),!0)}Doh(a,b,c,f){switch(a){case 1:this.zc.Eg(!1,f.Tb,27);this.cQ.wwa(ResourceStrings.l_PasteAsImageErrorCalloutTitle,ResourceStrings.l_PasteAsImageErrorCalloutMessage,!0,ResourceStrings.l_PasteAsImageButtonTitle,!0,CommonUIStrings.l_DialogCancel,
b,0,c,null,!1,hh.ZIf);break;default:this.zc.Eg(!1,f.Tb,28),this.cQ.wwa(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,hh.ZIf)}}r9c(a,b){za.a.J(540932291,826,50,"PasteSlideAsImage called");const c=this.zc.oO(2,0,"PasteSlideAsImage");this.zc.ai("PasteSlideAsImage",b,c);this.ala.start();this.k_c=this.rke=!1;this.t2g(a,c)}Yji(a){a=a.split("+");const b=this.uc.Sg(this.lq.yq[0].Ud).Cb;return b.cid.toString()===a[0]&&b.sid.toString()===
a[1]}Gml(a,b){let c=!1,f=this.bac;const l=a.rawEvent;var w=this.eW.CXd(l,this.gh.contentWindow);if(w){let F=null;({b2b:F,yUg:w}=this.eW.Gkd(w,this.la.clipboardDataImageBlobNumberLimitaton,this.lHg?50*hh.AEh:this.VJg));this.ala.nSb("GetBlob");0<w&&(za.a.J(426098956,826,50,"Blob is too large"),l.clipboardData=null,this.nhd(b),c=!0);F&&1===F.length&&(Kc.a.W9(()=>{this.Kgi(F,b,f)},0),this.UNg&&a.preventDefault(),c=!0)}else this.A1j&&this.rIg&&(this.X9b=this.wja.jnl(a.rawEvent));c&&this.zc.dB(5,b);return c}Kgi(a,
b,c){if(c||a&&(this.eW.emd(this.rca)||this.UNg)){const f=a[0],l=Kc.a.Db;Kc.a.ik(lh.a.Eai,f.size.toString());this.lHg&&f.size>=this.VJg?(this.Oke&&za.a.J(20772160,826,50,"Ctrl-v pressed while shrinking image"),this.i8b.pzg(f,w=>{Kc.a.EE(l,()=>{w&&this.Tal(w,f.size,b)||(this.k_c=!0,this.xte(b));this.Oke=!1})}),this.Oke=!0):(new ZQ.a).Swh(a,w=>{Kc.a.EE(l,()=>{this.O2i(w,b)})})}else this.xte(b)}O2i(a,b){this.ala.nSb("GetDataUrl");this.Pnl(a,b)||(za.a.J(8958218,826,15,"Paste image data uri failed"),this.paste(Object.assign(new Mm.a(!0),
{Tb:b}),null,!1))}xte(a="",b=null){this.paste(b||Object.assign(new Mm.a(!0),{Tb:a}),null,!1)}xrk(a,b){if(fl.dA){za.a.J(540615322,826,50,"PasteManager::PastePicklingData called ccpCorrId: {0}",a.Tb);var c=Date.now();fl.dA.tba(this.gh,a.b5a,f=>{a.b5a&&(f.html=null,f.pptSlide=null,f.text=null);this.fTj(f,c);if(f=Zp.Pxi(f)){var l=new tE;l.pastedContent=b;l.sva=a;this.u2g(f,a,a.Tb,aa.a.G2g,l)}else this.paste(a,b,!0)})}}fTj(a,b){if(a){var c=a.img?a.img.length:0,f=a.html?a.html.length:0,l=a.text?a.text.length:
0;a=a.pptSlide?a.pptSlide.length:0;za.a.J(526960131,826,50,"LogClipboardObjectLength:: timeTaken: {0}, imgLength: {1}, htmlLength: {2}, textLength: {3}, pptSlideLength: {4}",Date.now()-b,c,f,l,a)}else za.a.J(526960130,826,50,"clipboardObject is null")}paste(a,b,c){if(this.ia.JV)this.f_.show(5,-1),this.zc.Eg(!1,a.Tb,26);else if(a.w0f)this.J2d(a,b);else if(fl.dA){var f=this.oo.sS&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix");this.la.bRc&&!f||this.zHg?(a.yL=null,this.Kw.PSc()&&!c?this.xrk(a,
b):(za.a.J(557126289,826,50,"Paste::m_isEdgeContextMenuPasteFixEnabled {0} or IsChromeClipboardAccessEnabled: {1} is enabled",this.zHg,this.la.bRc),this.zFe(a,b))):(this.la.v8a&&(this.yUa=a.aA,this.la.FRa&&(this.bac=a.b5a)),this.Kw.PSc()&&fl.dA.$ll(this.gh,a.Tb)?(this.zc.ai(hh.Grk,"true",a.Tb),this.zc.Eg(!0,a.Tb)):(this.yUa=null,({content:b}=fl.dA.paste(this.gh,this.r3.value,a.Tb,!1)).returnValue?this.J2d(a,b):(fl.dA.iba(!1),b=fl.dA.yx,null==b?(a=new Tb.a(null,Object(C.a)(this,this.LNi,"fWaitForAsyncAPIResult"),
Object.assign(new yE,{od:a.Tb})),a.vl("ClipboardPreProcessForAsyncAPI"),a.run()):null!=b&&b&&this.zFe(a,null))))}else this.zc.Eg(!1,a.Tb,1)}LNi(a,b){a=fl.dA.yx;if(null==a)return!0;b=b.od.toString();a?this.zFe(Object.assign(new Mm.a(!1),{Tb:b}),null):this.zc.Eg(!1,b,29);return!1}zFe(a,b){this.VLg=Date.now();this.yke=!1;fl.dA.prepareForPaste(a.b5a,c=>{this.zc.ai("isPasteFromAsyncApi",c.toString(),a.Tb);this.yke=!0});b=new eO(a,b);(new Tb.a(null,Object(C.a)(this,this.prepareForPaste,"prepareForPaste"),
b)).run()}fxe(a,b){return a&&0<a.length?(a=Object.assign(new Mm.a(!0),{Tb:b,C4d:a,wIc:!0}),this.xRd(a),!0):!1}prepareForPaste(a,b){a=!0;let c=!1;if(this.yke){let f;({content:f}=fl.dA.paste(this.gh,this.r3.value,b.sva.Tb,b.sva.b5a)).returnValue&&f?this.J2d(b.sva,f):c=!0;a=!1}else Date.now()-this.VLg>this.la.gMf&&(za.a.J(8958220,826,50,null),a=!1,c=!0,fl.dA.reset());c&&this.zc.Eg(!1,b.sva.Tb,29);return a}get J6k(){return this.oo.rj&&this.la.$Aj}J2d(a,b){if(!a.Om)if(za.a.J(557183492,826,50,"HandlePasteContent::pasteParams.PastedHtml is empty"),
!b||a.Hug&&this.J6k)if(this.l7k()){b=Ne.a.FB();b.src=this.X9b;this.X9b=null;var c=Ne.a.De();c.appendChild(b);a.Om=c}else this.YLf(this.rca)&&(za.a.J(557183494,826,50,"HandlePasteContent::CheckWhetherFixClipboardId is true"),this.lq.yq[0].E3a=this.rca.firstChild.className,a.yV=null),za.a.J(557183495,826,50,"HandlePasteContent::Using m_body for PastedHTML."),a.Om=this.rca;else za.a.J(557183493,826,50,"HandlePasteContent::Paste not from IFrame Clipboard or !ShouldGetPastedContentFromClipboardTargetDOM"),
c=Ne.a.De(),qd.a("PasteManagerOacr73010Fix")?$Q.a.Gfd(c,b,"PasteManager"):c.innerHTML=b,a.Om=c;this.OJd(a);b=this.Kw.oDj(a.Om.firstChild);c=this.Kw.rDj(a.Om.firstChild);if(b||c)za.a.J(557670873,826,50,"HandlePasteContent:pasteParams.PastedHtml is empty clipboard {0} / empty placeholder {1}",b,c),this.zc.Eg(!0,a.Tb);else if(this.MQi(a.Om),b=a.Om.innerHTML.startsWith("<img"),c=a.Om.innerHTML.length,a.w0f&&b&&(this.ala.nSb("ConvertDataUrlToDOMNode"),this.ala.flush(String.format("Browser={0}, Length={1}, IsFromBlob={2}",
this.oo.ey,c,this.rke))),!c&&this.k_c)this.nhd(a.Tb);else{var f=0,l=!1;({kMd:f,aUd:l}=this.Eml(a));1===f?(za.a.J(556312347,843,15,"Failed to attach clipServiceObject due to deferred content, IsSlidePaste: {0}",l),this.zc.Eg(!1,a.Tb,25)):!a.yV&&!a.Wt&&c>this.$le?(qd.a("PasteManagerOacr73010Fix")?(this.gh.contentWindow.document.body.innerText="",a.Om.innerText=""):(this.gh.contentWindow.document.body.innerHTML=null,a.Om.innerHTML=null),b?(za.a.J(20570124,826,50,"Image too large"),this.nhd(a.Tb)):(za.a.J(19222922,
826,50,String.format("Paste content size is {0} which is too big.",c)),this.zc.Eg(!1,a.Tb,7))):(a.Wt?(za.a.J(51175454,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams keepsource value {0}",a.aA),this.zc.ai(zp.a.Dp,a.Wt.Dp,a.Tb)):za.a.J(51175456,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams ClipServiceObject is null"),this.xRd(a))}}OJd(a){a?a.Om?a.Om.firstChild?a.Om.firstChild.getAttribute||za.a.J(557159438,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild.getAttribute is null"):
za.a.J(558438472,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild is null"):za.a.J(558438471,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml is null"):za.a.J(558438470,826,50,"BuildDiagnosticInfo:pasteParams is null")}YLf(a){if(!(this.a0j&&a.firstChild&&a.firstChild.tagName&&"A"===a.firstChild.tagName.toUpperCase()&&a.firstChild.getAttribute(zp.a.type)&&a.firstChild.getAttribute(zp.a.Gfb)&&this.lq.yq))return!1;const b=a.firstChild.className;return a.firstChild.getAttribute(zp.a.sessionId).toString()===
this.lq.yq[0].sessionId&&b.startsWith("CID")&&b!==this.lq.yq[0].E3a&&(Object(Ca.a)(gA.a,this.lq.yq[0])&&"shape"===a.firstChild.getAttribute(zp.a.type).toString()&&this.Wji(a.firstChild.getAttribute(zp.a.Gfb).toString())||Object(Ca.a)(Av.a,this.lq.yq[0])&&"slide"===a.firstChild.getAttribute(zp.a.type).toString()&&this.Yji(a.firstChild.getAttribute(zp.a.slideId).toString()))}Wji(a){a=a.split(",");let b=0;if(a.length!==this.lq.yq.length)return!1;for(const c of a)for(const f of this.lq.yq)if(c===this.Fa.ysb(f.shapeNode).toString()){b++;
break}return b===a.length}xRd(a){let b=!1;for(let c=0;c<this.fl.length;c++)if(this.fl[c].uP(a)){b=!0;this.fl[c].paste(a);break}b||this.zc.Eg(!1,a.Tb,19);return b}Tal(a,b,c){if(a){const f=new bR.a("ShrinkImage",!0);a=this.i8b.Dph(a,b,this.$le);f.stop();if(a)return this.ala.nSb("LoadAndShrinkImage"),this.ala.flush(String.format("Browser={0}, Length={1}",this.oo.ey,a.length)),Kc.a.ik(lh.a.Bsj,f.Z9.toFixed(0)),Kc.a.ik(lh.a.Asj,f.$Gc.toFixed(0)),Kc.a.ik(lh.a.Csj,a.length.toString()),this.fxe(a,c)}return!1}MQi(a){this.u0j&&
a&&(a=a.ownerDocument)&&(a=a.getElementById(zp.a.tkg))&&a.parentNode&&a.parentNode.removeChild(a)}Eml(a){let b,c;b=0;c=!1;if(a&&a.Om&&a.Om.firstChild&&a.Om.firstChild.getAttribute){var f=a.Om.firstChild;const l=f.getAttribute(zp.a.Dp),w=this.lq.yq;if(w&&0<w.length&&w[0]&&Sys.UI.DomElement.containsCssClass(f,w[0].E3a)){let F=!1;(this.r8b&&Object(Ca.a)(Av.a,w[0])||this.Gje&&Object(Ca.a)(gA.a,w[0]))&&this.JFj(w)&&(this.xBj(l)?F=!0:(a.v0g=!1,za.a.J(21066266,826,50,"Cannot use ClipService due to copy failure: ccpCorrId: {0}.",
a.Tb)),za.a.J(38904008,826,50,"The copied graph nodes has been deleted, try to fall back to clip service; ccpCorrId: {0}, useClipService: {1}.",a.Tb,F));if(F)za.a.J(558438473,826,50,"TryAttachClipboardObjects: Using clip service for ccpCorrId: {0} for in-session COPY/PASTE but actually use clip service to fulfill the request.",a.Tb),this.lq.yq=null;else if(za.a.J(558438474,826,50,"TryAttachClipboardObjects: Using internal objects for in-session COPY/PASTE for ccpCorrId: {0}.",a.Tb),a.yV=w,!qd.a("UseClipServiceForDestinationThemePaste"))return{returnValue:!0,
kMd:b,aUd:c}}else za.a.J(38904010,826,50,"it is not an internal paste, use ClipService instead; ccpId: {0}, ccpCorrId: {1} .",l,a.Tb);f=this.Kw.AMi(f,a.Tb);b=f.JNa;c=1===f.dataType;if(this.Kw.xNj(f)&&void 0!==f&&null!==f&&32===f.OY)return a.Wt=f,za.a.J(51175489,826,50,"This is IsValidClipServiceObject and copy action has succeeded, clipServiceObject.DataType {0}, pasteParams keepsource value {1} ",f.dataType,a.aA),{returnValue:!0,kMd:b,aUd:c};za.a.J(38904012,826,10,"Failed to use clip service, ClipServiceObject: [{0}].",
f?f.toString():"(null)")}za.a.J(557183497,826,50,"TryAttachClipboardObjects::Failed to attach ClipboardObjects.");return{returnValue:!1,kMd:b,aUd:c}}Pnl(a,b){let c=!1;if(this.wja.owg(a))if(a.length>=this.$le)this.nhd(b),c=!0;else{if(a=this.wja.Uml(a))this.ala.nSb("ExtractDataUri"),this.ala.flush(String.format("Browser={0}, Length={1}, IsFromBlob=true",this.oo.ey,a.length));c=this.fxe(a,b)}return c}JFj(a){for(const b of a)if(b.fug)return!0;return!1}xBj(a){if(this.IS.Q7d)return za.a.J(21066268,826,
50,"Cannot predict copy result due to incompletion"),!1;za.a.J(38904014,826,50,"ccpId: {0}, LastCopyFailureCcpId: {1}.",a,this.IS.hyg);return!!a&&a!==this.IS.hyg}nhd(a){this.zc.Eg(!1,a,18);this.Wd.YH(60,null)}l7k(){let a=!1;if(this.X9b&&0<this.X9b.length&&this.rIg){const b=this.rca.getElementsByTagName(Ne.a.Lba);if(b){for(let c=0;c<b.length;c++){const f=b[c];if(f.src&&f.src.toLowerCase().startsWith("webkit-fake-url:")){a=!0;break}}za.a.J(20763922,826,50,"Get image url in Safari "+(a?"Succeeded":"Failed"))}}return a}}
hh.AEh=1048576;hh.QGf=.75;hh.dfi=5E3;hh.Grk="PasteViaTriggeringEvent";hh.objectCount="ObjectCount";hh.isDataCompressed="IsDataCompressed";hh.sfi="PastedObjectDataSize";hh.YIf="ActionName";hh.$If="CcpMethod";hh.pei="PasteKeepingSourceFormatting";hh.nei="PasteKeepingDestinationTheme";hh.oei="PasteAsImage";hh.xfi='data-clipservice-type="slide"';hh.Hei="ContextMenu.PasteKeepingDestinationTheme";hh.zfi="ContextMenu.PasteKeepingSourceFormatting";hh.Jei="PasteKeepingDestinationTheme";hh.Bfi="PasteKeepingSourceFormatting";
hh.Iei="PasteKeepingDestinationThemeMLR";hh.Afi="PasteKeepingSourceFormattingMLR";hh.ZIf=20;hh.rfi="PasteAsImageSLR";hh.qfi="PasteAsImageMLR";hh.pfi="ContextMenu.PasteAsImage";Object(e.a)(hh,"PasteManager",null,[345,109]);class gO{constructor(a,b,c){this.uDg=a;this.Ha=b;this.Uv=c}yel(a,b,c,f,l){this.uDg.a$(this.Ha.vki,a,b,c,this.Ha.wki,this.Ha.xki,this.Ha.yki,f,l)}Ihi(a){this.uDg.Hhi(a)}}Object(e.a)(gO,"PastedDataUploader",null,[341]);class OE{constructor(){}static create(a){const b=new OE;b.Wvg=
Rq.b(a,c=>c.isEditable);return b}}Object(e.a)(OE,"ShapeCopyPasteParams",null,[]);class hO{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec,Hc,Dc,Td){this.sa=a;this.gh=b;this.r3=c;this.lq=l;this.Y7b=f;this.wja=w;this.Kw=F;this.IS=S;this.ia=fa;this.p_j=xa;this.q_j=Za;this.oHg=pb;this.tHg=Mb;this.b0j=hc;this.KZc=kc;this.jbb=Ec;this.Fa=Hc;this.zc=Dc;this.Sv=Td}uP(a){const b=this.sa.mg();let c=!1;b&&0<b.length&&this.r3.value.Vaa===Xd.a.sg&&(a.dataType=2,c=a.$ra?this.PMi(b):!this.sa.gRa());return c}PMi(a){let b=
!0;for(const c of a){if(c.HTc&&!c.isLocal)return!0;c.FA||(b=!1)}return b}vqa(a){u.AFrameworkApplication.Pj("Microsoft.Office.Server.Powerpoint.Web.IPPTEditorPasteShapesWithEmbeddedClipServiceSettings");const b=this.sa.mg();if(!b||!b.length)return this.lq.yq=null,!1;var c;let f=({contentType:c}=this.wja.BKd(b)).returnValue;this.zc.dB(c,a.Tb);a.$ra?({Efb:f,returnValue:c}=this.bGi(b,a.Tb,f),f="Cut:"+f):({Efb:f,returnValue:c}=this.ZFi(b,a.Tb,f),f="Copy:"+f);this.Sv.j3d(b,"DoCutCopy")&&(za.a.J(525960395,
826,50,"ShapeCutCopyHandler: DoCutCopy HasDeferredContentOnShape: True"),a.$ra?this.Sv.opa("ShapeCutCopyHandlerHasDeferredContentIsCut","true"):this.Sv.opa("ShapeCutCopyHandlerHasDeferredContentIsCopy","true"));za.a.J(23614726,307,50,f);return c}bGi(a,b,c){let f=!0,l=[];for(const w of a)w.HTc&&l.push(w),w.FA||(f=!1);l=f?a:l;b=({Efb:c}=this.gDh(l,l,!0,!0,c,b,f)).returnValue;this.jQf(l);this.tHg&&this.nQf(a);return{returnValue:32===this.ia.Ma(aa.a.rTf,2,b),Efb:c}}ZFi(a,b,c){if(this.oHg&&this.gCj(this.qaj(),
a))return{returnValue:!0,Efb:c};const f=[];for(const l of a)l.HTc&&f.push(l);b=({Efb:c}=this.gDh(a,f,this.oHg,!1,c,b)).returnValue;b.Wt&&this.ia.Ma(aa.a.lQf,2,b);this.jQf(a);this.tHg&&this.nQf(a);return{returnValue:32===this.ia.processAction(aa.a.kQf,2),Efb:c}}gCj(a,b){if(!this.IS.Q7d||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!a[c].id||!a[c].id.equals(b[c].id))return!1;return!0}v8k(a){if(!a.length)return!0;let b=0,c=0;for(let f=0;f<a.length;f++){const l=a[f];if(l.isLocal)return!0;
!l.sk||l.get_isSVGBlipFilled()||l.isGif||b++;l.rd&&c++}return this.b0j?c===a.length:b+c===a.length}g3i(a){const b=[];for(const c of a)c&&(a=new gA.a(c),a.sessionId=this.jbb,b.push(a));return b}qaj(){const a=[];if(this.lq.yq&&this.lq.yq.length)for(const b of this.lq.yq){const c=Object(ua.a)(gA.a,b);if(c&&c.shapeNode)a.push(c.shapeNode);else return[]}return a}gDh(a,b,c,f,l,w,F=!1){let S=new Kx(null,w,null);this.lq.yq=this.g3i(a);!c||this.v8k(b)?(c&&(za.a.J(23614724,307,50,"Clip service shapes cut/copy is throttled"),
this.zc.ai(eu.a.jNf,"true",w)),this.Kw.Rmd(this.gh,this.lq.yq,null,this.jbb,this.Ccg(a),null,w)):(this.wja.Dqh(b),c=this.IS.qOd(2,b.length,f,F),c.pcc=OE.create(b),this.KZc&&this.Sv.j3d(a,f?"ShapeCutCopyHandler_DoCut":"ShapeCutCopyHandler_DoCopy")&&(c.JNa=1,c.OY=8),this.zc.ai(eu.a.Dp,c.Dp,w),l+=String.format(", CcpId={0}",c.Dp),this.Kw.Rmd(this.gh,this.lq.yq,c,this.jbb,this.Ccg(a),null,w),S=new Kx(c,w,b));return{returnValue:S,Efb:l}}Ccg(a){const b=[];for(const c of a)Array.add(b,this.Fa.ysb(c));return b}jQf(a){for(const b of a)if(b&&
b.sk&&(a=ng.c(b,this.Y7b.Mc.Na))&&!a.kl){a=a.aNa;if(!a)continue;a=a.getAttribute(Gk.a.GPc);if(!a)continue;const c=Ne.a.FB();c.src=a.toString();b.get_shapeRotation()||this.wja.e0k(c,b.Bx,b.qD);c.className+=this.lq.yq[0].E3a;this.gh.contentWindow.document.body.appendChild(c)}}nQf(a){(a=this.q_j.tUi(a,b=>!!b&&b.rd))&&0<a.length&&(a=this.p_j.uUi(a))&&this.gh.contentWindow.document.body.appendChild(a)}}Object(e.a)(hO,"ShapeCutCopyHandler",null,[419]);class Xr{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb){this.gh=
b;this.r3=c;this.lq=f;this.ua=l;this.ia=w;this.Kw=F;this.IS=S;this.d0j=fa;this.KZc=xa;this.sa=a;this.jbb=Za;this.zc=pb;this.Sv=Mb}uP(a){var b=this.r3.value.Vaa;if(b=!!this.ua.Ca&&!!b&&b===Ai.a.zB||b===Xd.a.sg&&!this.sa.he().length)a.dataType=1;return b}vqa(a){this.zc.dB(19,a.Tb);return this.mBi(a)}get Eb(){return this.sa}mBi(a){var b=this.Eb.rf();if(!b||!b.length)return this.lq.yq=null,Z.ULS.sendTraceTag(38904018,826,10,"Tried to copy slides but no slides were selected."),!1;var c=Xr.n7f(b,!0);if(!c.length)return a=
this.Tcg(b).join(","),Z.ULS.sendTraceTag(34481180,826,10,"Tried to copy slides but all of them were disconnected: '{0}'.",a),!1;b.length!==c.length&&(b=Xr.n7f(b,!1),b=this.Tcg(b).join(","),Z.ULS.sendTraceTag(34481181,826,15,"Tried to copy slides but some of them were disconnected: '{0}', ignore them and continue",b));var f=Xr.getSlides(this.lq),l=Xr.twi(this.jbb,c);this.lq.yq=Xr.Sjl(l);b=(b=c[0])?b.Cb:null;const w=this.Sv.roj(c);this.d0j?this.AKe(f,l)?(za.a.J(34481184,307,50,"Clip service slide copy is throttled for ccopCorrId: {0}",
a.Tb),this.zc.ai(eu.a.jNf,"true",a.Tb)):(f=this.IS.qOd(1,c.length,a.$ra),c=new Tz(f,a.Tb,c),this.zc.ai(eu.a.Dp,f.Dp,a.Tb),l=8,w?this.KZc&&(f.JNa=1,f.OY=8):a.$ra||(l=this.ia.Ma(aa.a.mQf,2,c),f.OY=l),this.Kw.Rmd(this.gh,this.lq.yq,f,this.jbb,null,b,a.Tb),!w&&a.$ra&&(l=this.ia.Ma(aa.a.sTf,2,c)),za.a.J(556861640,307,32!==l?10:50,"Clip service slide isCut: {0} status: {1} for ccpid: {2}",a.$ra,f.OY,f.Dp),a.$ra?this.Sv.opa("DeferredSlideCutStatus",f.OY.toString()):this.Sv.opa("DeferredSlideCopyStatus",
f.OY.toString())):(this.Kw.Rmd(this.gh,this.lq.yq,null,this.jbb,null,b,a.Tb),za.a.J(576745568,307,15,"Clip service has been disabled. CcpCorId: {0}",a.Tb));return!0}Tcg(a){return Cg.c(a,b=>b?b.Cb.toString():null)}AKe(a,b){if(!b||!b.length||Xr.C8h(b))return!0;if(this.IS.Q7d){if(!a||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!Xr.T8h(a[c],b[c]))return!1;return!0}return!1}static n7f(a,b){const c=new Ua.a;for(const f of a)f.isConnected===b&&c.add(f);return c.toArray()}static getSlides(a){const b=
[];if(!a||!a.yq||!a.yq.length)return b;for(let c=0;c<a.yq.length;c++)b.push(Object(ua.a)(Av.a,a.yq[c]));return b}static T8h(a,b){return!a&&!b||!!a&&!a.Ud&&!!b&&!b.Ud||!!a&&!!a.Ud&&!!b&&!!b.Ud&&(!a.Ud.id&&!b.Ud.id||!!a.Ud.id&&!!b.Ud.id&&a.Ud.id.equals(b.Ud.id))}static C8h(a){for(let b=0;b<a.length;b++)if(a[b]&&a[b].Ud&&!Rd.a.DA(a[b].Ud.Cb))return!1;return!0}static Sjl(a){const b=[];for(const c of a)b.push(c);return b}static twi(a,b){const c=[];for(const f of b)c.push(Object.assign(new Av.a(f),{sessionId:a}));
return c}}Object(e.a)(Xr,"SlideCopyHandler",null,[419]);class iO{constructor(a,b,c,f,l){this.Tja=this.Lhe=!1;this.$Qb=null;this.C9a=a;this.G6j=b;this.$6b=c;this.zc=f;this.la=l}get TL(){this.$Qb||(this.$Qb=this.G6j.create());return this.$Qb}get ZTd(){return this.Tja}iba(a){this.TL.iba(a)}x3a(a){this.TL.x3a(a)}get y4(){return this.TL.y4}get yx(){return this.TL.yx}prepareForPaste(a,b){this.Tja=!0;this.TL.prepareForPaste(b,a,this.$6b.dAa.contentWindow.document)}tba(a,b,c){this.Tja=!0;this.TL.tba(a,b,
c);this.Tja=!1}reset(){this.Tja=!1}$ll(a,b){if(!this.RIa(a,b))return!1;try{const c=a.contentWindow.document;let f=c.body;ya.a.Vt(f);this.TL.Q4a(c,f);return!0}catch(c){za.a.J(540587153,826,10,"TriggerPasteRequest: We failed to generate the system clipboard event, even though we thought we had access!")}return!1}paste(a,b,c){let f;f="";b.vf(Xd.a.sg);if(!this.RIa(a,c)&&(null==this.yx||null!=this.yx&&!this.yx))return{returnValue:!1,content:f};b=a.contentWindow.document;let l=b.body;this.Tja=!0;ya.a.Vt(l);
let w=!1;try{this.C9a.Oeb(a),l=this.TL.Q4a(b,l),f=l.innerHTML,w=!0}catch(F){this.a1b(c)}this.Tja=!1;return{returnValue:w,content:f}}copy(a){a.contentWindow.focus();this.Tja=!0;let b;try{this.TL.aIc(a.contentWindow.document),b=!0}catch(c){b=!1}this.Tja=!1;return b?!0:!1}RIa(a,b){if(this.Lhe)return!0;this.Tja=!0;let c=!1;try{c=this.TL.RIa(a.contentWindow.document.body,()=>{ya.a.Vt(a.contentWindow.document.body)},()=>{this.C9a.Oeb(a)})}catch(f){}this.Tja=!1;c?this.Lhe=!0:r.a.rj||null==this.yx||this.yx||
this.a1b(b);return c}a1b(a){this.Lhe=!1;sq.instance.mpb(null,null);this.zc.Eg(!1,a,29)}}Object(e.a)(iO,"SystemClipboard",null,[342]);class jO{constructor(a,b,c,f,l,w,F,S){this.hke=!0;this.EFg=!1;l.pptOfflineModeEnabled&&a.wzc(Object(C.a)(this,this.TBb,"onNetworkHealthStateChanged"));this.Hs=b;this.ia=c;this.f_=f;this.la=l;this.SN=w;this.VK=F;this.ua=S;this.UF=0;this.M$a=!1;this.MWc=0;this.oJg=new Date}get status(){return this.UF}TBb(a,b){this.hke=b.xSc;this.EFg||this.Ajh(this.hke,"NetworkHealthStateChanged")}Z3f(a){this.EFg=
!a;this.hke&&this.Ajh(a,"PodSeamlessFailoverManager")}Ajh(a,b){a&&this.M$a&&(this.f_.kkc=!1,this.UF=1,this.SN.YG());const c=!a,f=this.MWc+1;Im.a.instance.Hb(new Se.a(2,1,c?this.la.switchToOfflineDelayInMs:this.la.switchToOnlineDelayInMs,()=>{this.nfb(c,f)},90,"107"));this.MWc++;Z.ULS.sendTraceTag(41272025,813,50,Ik.c({["Current state"]:this.M$a.toString(),["Received signal"]:a.toString(),["Change id"]:f.toString(),["State change source"]:b}))}nfb(a,b){this.MWc===b&&this.M$a!==a&&(this.f_.kkc=a,a&&
3!==this.ia.mode||((this.M$a=a)?(this.UF=2,this.SN.YG(),this.VK.DV(this.ua.presentation)&&this.f_.show(0,-1)):(this.UF=0,this.f_.dismiss(),this.SN.YG()),this.Hs.nfb(a),Z.ULS.sendTraceTag(41272026,813,50,"PPTO switches to {0}. The change id is {1} and the last state switching time is {2}",a?"Offline":"Online",this.MWc,Kc.a.Ve(this.oJg)),this.oJg=new Date))}}Object(e.a)(jO,"PPTOfflineManager",null,[363]);class kO{Ckc(a,b,c){rE.a(a,b,c)}}Object(e.a)(kO,"WarningDialogProxy",null,[338]);var cR=d(276);
class Sx extends Th.a{constructor(a,b,c,f,l,w,F,S,fa){super();this.hYc=!1;this.z6b=null;this.bab=0;this.T_c=this.W8b=this.Q_c=this.O_c=this.g2c=this.X_c=this.IXc=this.S3c=this.WTa=this.Ble=this.Sle=this.o_=this.q3=null;this.Uka=a;this.n9b=b;this.xI=c;this.q2j=f;this.vWj=l;this.kZj=fa;this.Ga=w;this.WNg=S;this.qc=F}dispose(){this.Ble=this.Sle=this.o_=this.q3=null;super.dispose()}Aoh(a){this.Vyh();this.qj(a,Object(C.a)(this,this.XIi,"endDialogHandler"),{["MasterId"]:0,["LayoutId"]:0})}Ahh(a){if(a)for(let b=
0;b<this.WTa.length;b++){const c=document.getElementById(this.WTa[b]);if(parseInt(c.getAttribute("LayoutId"))===a){this.cFb(c);break}}}Vw(){super.Vw();Ne.a.De().appendChild(this.vwi());const a=document.getElementById(this.ki("WACDialogPanel"));a&&a.removeAttribute(re.a.zpa)}AF(){super.AF();var a=document.getElementById(this.ki("WACDialogPanel"));a.style.width=Ne.a.Nc(532);a=parseInt($g.a.Nu(a).top);this.q3.style.height=Ne.a.Nc(Math.min(Math.max(0,Xh.a.Nla-a-100),398));this.Wf=this.q3.parentNode.innerHTML}q6(){super.q6();
this.Sle=document.getElementById("MasterId");this.Ble=document.getElementById("LayoutId");this.W8b=Object(C.a)(this,this.X8a,"keyPressHandler");u.AFrameworkApplication.Ba.EF.Zbd(ra.a.Rf,window.document,this.W8b,null);this.O_c=Object(C.a)(this,this.WPj,"layoutClickHandler");this.Q_c=Object(C.a)(this,this.XPj,"layoutDoubleClickHandler");this.T_c=Object(C.a)(this,this.ZPj,"layoutOnFocus");for(let a=0;a<this.WTa.length;a++){const b=document.getElementById(this.WTa[a]);this.Rm.pb(ra.a.click,b,this.O_c);
this.Rm.pb(ra.a.doubleClick,b,this.Q_c);ad.a.addHandler(b.firstChild,"focus",this.T_c)}}pqa(){super.pqa();this.W8b&&u.AFrameworkApplication.Ba.EF.HRe(ra.a.Rf,window.document,this.W8b);this.W8b=null;for(let a=0;a<this.WTa.length;a++){const b=document.getElementById(this.WTa[a]);this.Rm.zb(ra.a.click,b,this.O_c);this.Rm.zb(ra.a.doubleClick,b,this.Q_c);ad.a.removeHandler(b.firstChild,"focus",this.T_c)}this.T_c=this.Q_c=this.O_c=null}vwi(){if(this.q3)return this.q3;this.q3=Ne.a.De();this.q3.id="LayoutPickerDiv";
this.q3.className="LayoutPicker";this.bab=0;this.WTa=[];var a=this.n9b.length;if(!a||1===a&&!this.n9b[0].InContent)return za.a.J(546137666,822,10,"Legacy LayoutDialog:: Master not loaded."),this.q3;var b=0;let c=!1;for(var f=0;f<a;f++)this.n9b[f].Id===this.q2j&&(b=f,c=!0);c&&this.aAf(this.n9b[b],1!==a);for(f=0;f<a;f++)c&&f===b||this.aAf(this.n9b[f],1!==a);a=Ne.a.sRf();a.id="MasterId";a.type="hidden";b=Ne.a.sRf();b.id="LayoutId";b.type="hidden";this.q3.appendChild(a);this.q3.appendChild(b);return this.q3}aAf(a,
b){a.InContent&&this.xI.Kb(a.Id)&&(b&&this.q3.appendChild(this.Owi(a)),this.q3.appendChild(this.Kui(a)))}Owi(a){const b=Ne.a.De();b.className="MasterSlideTitleBar";b.innerText=a.Name;return b}Kui(a){const b=a.Id;a=a.ContentMasters;if(!this.xI.Kb(b))return null;const c=this.xI.ga(b),f=Ne.a.De();f.className="LayoutTableContainer";var l=Ne.a.ASf();const w=Ne.a.Ezi();let F=null;f.appendChild(l);l.appendChild(w);l=this.Uka.width;let S=this.Uka.height,fa;l||(l=1);S||(S=1);fa=S/l*145;let xa=0;const Za=a.length;
for(var pb=0;pb<Za;pb++)!this.WNg&&this.qc.W7a(a[pb])||xa++;pb=1;for(let Hc=0;Hc<Za;Hc++){var Mb=a[Hc];if(!this.WNg&&this.qc.W7a(Mb))continue;1===pb%3&&(F=Ne.a.lPd(),w.appendChild(F));var hc=Mb.Id.toString();const Dc=Mb.Name,Td=Ne.a.eFc();Td.id="Layout"+this.bab;Td.setAttribute("LayoutIndex",this.bab);Td.setAttribute("MasterId",b);Td.setAttribute("LayoutId",hc);Td.setAttribute(re.a.ff,re.a.eP);Array.add(this.WTa,Td.id);var kc=null;if(hc=!!c.LayoutIcons&&c.LayoutIcons.length>Hc&&!!c.LayoutIcons[Hc].Icon){kc=
-1;for(var Ec=0;Ec<c.LayoutIcons.length;Ec++)if(c.LayoutIcons[Ec].LayoutId===Mb.Id){kc=Ec;break}-1===kc&&(kc=Hc);kc=c.LayoutIcons[kc].Icon;Ec=new cR.a(kc.Clip.Bounds.Left,kc.Clip.Bounds.Top,145,fa);Mb=Ne.a.FB();Mb.src=lb.a.instance.resolve("PPTe.IResourceViewElementResolver").resolve(dg.a.cqb,kc.ImgId);Mb.title=Dc;Mb.style.clip=this.WGk(Ec);Mb.style.left=Ne.a.Nc(-Ec.tZa);Mb.style.overflow=Fe.a.Qs;Mb.style.position=Fe.a.Mwa;Mb.style.top=Ne.a.Nc(-Ec.uZa);Mb.style.zIndex="0";l<S&&(Mb.style.height=Ne.a.Nc(fa));
Mb.setAttribute(re.a.ff,re.a.VMa);kc=document.createElement("span");kc.style.width=Ne.a.Nc(145);kc.style.height=Ne.a.Nc(fa);kc.setAttribute("Unselectable","on");kc.style.zIndex="0";kc.style.overflow=Fe.a.Qs;kc.style.display=Fe.a.rfl;kc.style.position=Fe.a.dlc;kc.appendChild(Mb);kc.setAttribute(re.a.XJ,re.a.yB)}Mb=Ne.a.De();Mb.id="title_Layout"+this.bab;Mb.className="LayoutTitle LayoutTitleHighContrast";Mb.innerText=Dc;Ec=Ne.a.Raa();Ec.setAttribute("tabindex","0");Ec.setAttribute("onclick","return false;");
Ec.setAttribute("unselectable","on");Ec.setAttribute(re.a.ht,Dc);Ec.setAttribute(re.a.ff,re.a.VMa);Ec.setAttribute(re.a.xId,pb);Ec.setAttribute(re.a.yId,xa);hc&&Ec.appendChild(kc);Ec.appendChild(Mb);F.appendChild(Td);Td.appendChild(Ec);this.bab++;pb++}Za%3&&(this.bab+=3-Za%3);return f}WGk(a){let b;b="rect( "+(Ne.a.Nc(a.uZa)+", ");b+=Ne.a.Nc(a.WEh)+", ";b+=Ne.a.Nc(a.XEh)+", ";return b+=Ne.a.Nc(a.tZa)+")"}XIi(a,b){this.hYc&&(Kc.a.Hob(this.z6b),this.hYc=!1,this.z6b=null);1===a&&this.vWj(b.MasterId,b.LayoutId)}ZPj(a){a=
a.target.parentNode;this.o_&&a.id===this.o_.id||this.cFb(a)}X8a(a){a=a.nc;var b=this.O5i(a);if(b===x.a.OJb)return!0;if(b===x.a.Xp)return(a=this.Ga.Mk())&&"WACDialogCancelButton"!==a.gj.QY.id?(this.ioa(1),this.hide(),!0):!1;a.preventDefault();if(!this.o_)return a=document.getElementById("Layout0"),this.cFb(a),!0;a=parseInt(this.o_.getAttribute("LayoutIndex"));b=this.Q3i(b);for(let c=0;c<b.length;c++){const f=document.getElementById("Layout"+(a+b[c]));if(f){this.cFb(f);break}}return!0}O5i(a){let b=
x.a.OJb;switch(a.keyCode){case x.a.C0:b=x.a.C0;break;case x.a.A0:b=x.a.A0;break;case x.a.WQ:b=x.a.WQ;break;case x.a.vO:b=x.a.vO;break;case x.a.Xp:b=x.a.Xp}this.kZj&&(b===x.a.vO?b=x.a.WQ:b===x.a.WQ&&(b=x.a.vO));return b}Q3i(a){let b=[0];switch(a){case x.a.C0:if(!this.S3c)for(this.S3c=Array(3),a=0;3>a;a++)this.S3c[a]=-3-a;b=this.S3c;break;case x.a.WQ:if(!this.X_c)for(this.X_c=Array(3),a=0;3>a;a++)this.X_c[a]=-1-a;b=this.X_c;break;case x.a.vO:if(!this.g2c)for(this.g2c=Array(3),a=0;3>a;a++)this.g2c[a]=
a+1;b=this.g2c;break;case x.a.A0:if(!this.IXc)for(this.IXc=Array(3),a=0;3>a;a++)this.IXc[a]=3-a;b=this.IXc}return b}WPj(a){this.cFb(a.AB);return!0}XPj(a){a=a.AB;a!==this.o_&&this.cFb(a);this.ioa(1);this.hide();return!0}cFb(a){this.Vyh();this.o_=a;const b=this.Ga.Mk();b?b.gj.aE(a.firstChild):za.a.J(8959683,807,10,"LayoutDialog::SelectElement cannot find current FocusRegion");Sys.UI.DomElement.addCssClass(this.o_,"Selected");this.$ql();this.hYc=!0;this.z6b||(this.z6b=Kc.a.W9(Object(C.a)(this,this.vWk,
"selectElement_Finish"),0))}vWk(){this.o_&&this.TVk(this.o_);this.hYc=!1;this.z6b=null}Vyh(){this.o_&&(Sys.UI.DomElement.removeCssClass(this.o_,"Selected"),this.o_=null)}TVk(a){const b=document.getElementById("LayoutPickerDiv");if(b){var c=b.scrollTop,f=b.offsetHeight,l=Ne.a.SUg(b,a)._y,w=a.offsetHeight;l<c?3>a.getAttribute("LayoutIndex")?b.scrollTop=0:b.scrollTop=l:(a=f+c,l=w+l,l>a&&(b.scrollTop=c+(l-a)))}}$ql(){this.Sle.value=this.o_.getAttribute("MasterId");this.Ble.value=this.o_.getAttribute("LayoutId")}}
Object(e.a)(Sx,"LayoutPicker",Th.a,[]);class lO extends Sx{constructor(a,b,c,f,l,w,F,S,fa){super(a,b,c,f,l,w,F,S,fa)}dispose(){super.dispose()}phd(a){this.Aoh(ResourceStrings.l_NewSlideTitle);this.Ahh(a)}Vw(){this.Pe(1,ResourceStrings.l_AddSlide);super.Vw()}}Object(e.a)(lO,"AddSlideDialog",Sx,[429]);class mO extends Sx{constructor(a,b,c,f,l,w,F,S,fa){super(a,b,c,f,l,w,F,S,fa)}dispose(){super.dispose()}phd(a){this.Aoh(ResourceStrings.L_SlideLayoutDialog);this.Ahh(a)}Vw(){this.Pe(1,ResourceStrings.L_ChangeLayout);
super.Vw()}}Object(e.a)(mO,"ChangeLayoutDialog",Sx,[429]);class nO{constructor(a,b){this.Ga=a;this.qc=b}sOd(a,b,c,f,l,w,F,S){switch(a){case 1:return new lO(b,c,f,l,w,this.Ga,this.qc,F,S);case 0:return new mO(b,c,f,l,w,this.Ga,this.qc,F,S);default:return null}}}Object(e.a)(nO,"DialogFactory",null,[416]);class oO{constructor(a,b,c,f,l){this.Xka=null;this.ia=a;this.kL=b;this.hv=c;this.xN=f;this.qp=l;this.kL.l6(Object(C.a)(this,this.idc,"onShapeDisconneted"));this.hv.FCf(Object(C.a)(this,this.ndc,"onSlideBackgroundClicked"));
this.hv.Z3h(Object(C.a)(this,this.b_g,"onShapeViewElementBackgroundClicked"))}u3g(a){if(!a)throw Error.argumentNull("template");this.Xka=a;za.a.J(18368227,822,50,"FormatPainter::PickupFormat Template shape {0}",a.get_shapeId());this.xN.uZ=!0}I7h(a){if(!a)throw Error.argumentNull("target");let b=!1;!this.Xka||a.id.equals(this.Xka.id)?b=!0:a.get_isSVGBlipFilled()&&(this.Xka.xx||!this.Xka.osa&&!this.Xka.get_isSVGBlipFilled())&&(b=!0);b?this.nNa():(za.a.J(18368260,822,50,"FormatPainter::ApplyFormat Template shape {0} Target shape {1}",
this.Xka.get_shapeId(),a.get_shapeId()),this.ia.Ma(aa.a.mWd,2,new eA(this.Xka,a)))}nNa(){this.isActive&&(za.a.J(18368262,822,50,"FormatPainter::CancelFormat"),this.Xka=null,this.xN.uZ=!1)}dispose(){this.kL.xHa(Object(C.a)(this,this.idc,"onShapeDisconneted"));this.hv.och(Object(C.a)(this,this.ndc,"onSlideBackgroundClicked"));this.hv.bOk(Object(C.a)(this,this.b_g,"onShapeViewElementBackgroundClicked"))}idc(a,b){b.node===this.Xka&&this.nNa()}ndc(){const a=this.isActive;this.nNa();this.qp&&a&&this.ia.processAction(D.a.Mha,
2)}b_g(a,b){this.isActive&&this.I7h(b.$w.shapeNode)}get isActive(){return this.xN.uZ}get pil(){return this.Xka}}Object(e.a)(oO,"FormatPainter",null,[360,109]);var dR=d(1105),hA;(function(a){a[a.unsaved=0]="unsaved";a[a.rightClickThumbnailPanel=1]="rightClickThumbnailPanel";a[a.rightClickCanvas=2]="rightClickCanvas";a[a.clickObjectOnCanvas=3]="clickObjectOnCanvas";a[a.tokenRefresh=4]="tokenRefresh";a[a.clipServiceCopy=5]="clipServiceCopy"})(hA||(hA={}));Object(e.b)("OfflineModalCalloutTrigger",hA);
class pO{constructor(a){this.Yn=null;this.kkc=!1;this.Rb=a;a=document.createElementNS(Gk.a.ONe,"polyline");a.setAttribute(Gk.a.J3g,"1,1 15,14 30,1");a.setAttribute(Gk.a.jid,"rgb(234,234,234)");a.setAttribute(Gk.a.dNe,"2");a.setAttribute(Gk.a.MUd,"white");a.setAttribute(Gk.a.cNe,"bevel");this.Cde=new Un.a;this.Cde.Bh(32,16);this.Cde.za.appendChild(a);this.v6b=document.createElement("p");this.v6b.innerText=CommonUIStrings.l_ModalCalloutContentWhenDisconnected;this.v6b.style.width="258px";this.v6b.style.color=
"black";this.v6b.style.fontSize="14px"}dismiss(){this.Yn&&(this.Yn.dismiss(),this.Yn=null)}show(a,b){Z.ULS.sendTraceTag(41695193,813,50,"OfflineModalCallout.Show is triggered by {0}",hA[a]);if(this.kkc){if(this.Yn){if(this.Yn.yK)return;this.Yn.dispose()}let c=null;c=document.querySelector("[data-unique-id='GetOfflineStatus']");qd.a("OfflineModalCalloutCrashFix")&&!c?Z.ULS.sendTraceTag(543270787,813,10,"[Offline Modal Callout] Call out not shown as top element is null"):(a=id.a.ei(c),this.Yn=dR.a.LOd(a,
c,this.Rb.$hd,2),this.Yn.DY=4,0<b&&(this.Yn.rPe=b),this.Yn.Zq=!0,this.Yn.content=this.v6b,this.Yn.sMd=()=>{Z.ULS.sendTraceTag(41695194,813,50,"The user clicks the button to close the callout.");this.Yn&&(this.Yn.dispose(),this.Yn=null)},this.Yn.g8c=()=>{if(this.Yn&&this.Yn.content){this.Yn.content.parentNode.style.width="258px";this.Yn.NI.style.borderColor="rgb(234,234,234)";for(var f=this.Yn.Bnb;f.firstChild;)f.removeChild(f.firstChild);f.appendChild(this.Cde.za);this.Yn.EIe()}else Z.ULS.sendTraceTag(591001817,
813,50,"callout content is empty in OnShowCallback")},this.Yn.show(),Z.ULS.sendTraceTag(41695195,813,50,"Display the callout control"))}}}Object(e.a)(pO,"OfflineModalCallout",null,[362]);var qO=d(297),iA=d(204);class rO{constructor(a,b,c){this.ji=this.yN=this.Ab=null;this.Sb=!0;this.xa=a;this.o$a=b;this.yme=a.Gqb?a.kca:null;this.JEa=c}dispose(){this.JEa&&this.yN&&($removeHandler(this.yN.za,"error",Object(C.a)(this,this.SXg,"onImageLoadError")),this.yN.dispose(),this.yN=null);this.Ab&&this.Ab.aq();
this.yN=this.ji=this.Ab=null;this.yme&&(this.o$a.revokeObjectURL(this.yme),this.yme=null)}Vm(a){this.Ab=new QD.a;this.Ab.Fma(Ei.a.pNe);a.appendChild(this.Ab.viewport);this.yN=new qO.a;this.yN.Uk(0);this.Ab.appendChild(this.yN);this.yN.ew(this.xa.kca);$addHandler(this.yN.za,"error",Object(C.a)(this,this.SXg,"onImageLoadError"));a=this.xa.Vq;const b=qi.a.mvh(a);this.yN.setPosition(a.fc,a.ic);this.yN.Bh(b.width,b.height);this.yN.Sd(!0);this.ji=new qn.a;this.ji.Uk(1);this.ji.setVisibility(!1);this.ji.za.setAttribute("class",
"ShapeMoveHandle");this.ji.Sd(!0);this.ji.Mt(a.points);this.ji.vX("cursor: move");this.Ab.appendChild(this.ji);this.Ab.xm()}SXg(){za.a.J(34182307,826,15,"Locally rendered a broken image, IsPastingPicture={0}",this.xa.w8a)}setPosition(a,b){this.Ab.setPosition(a,b)}SD(){}Ej(a){this.Ab.Ej(a)}Nq(a){this.Ab.yF(a,iA.a.Faa)}ov(a){this.Ab.yF(a,iA.a.aUb)}setZIndex(a){this.Ab.tC(a)}mz(){}TE(){return null}MD(){return[]}draw(){}wF(){}eq(){return this.Sb?this.Ab.eq():null}get visible(){return this.Sb}set visible(a){this.Sb=
a;this.Ab.Sd(this.Sb)}get qq(){return this.ji}get oe(){return this.Ab}IP(a){return a.Hc===this.qq.za}Rx(){}setSelection(){}}Object(e.a)(rO,"LocalImageView",null,[428,283,284,109]);class sO{constructor(a,b){this.o$a=a;this.C_j=b}create(a){return new rO(a,this.o$a,this.C_j)}}Object(e.a)(sO,"Factory",null,[355]);class tO{constructor(a){this.Sb=!0;this.LSa=this.wTa=this.Ab=null;this.Rd=a}dispose(){this.Ab&&this.Ab.aq();this.wTa=this.LSa=this.Ab=null;this.Sb=!1}Vm(a){this.Ab=new QD.a;this.Ab.Fma(Ei.a.pNe);
a.appendChild(this.Ab.viewport);this.LSa=new qn.a;this.Ab.appendChild(this.LSa);this.LSa.xF(Gk.a.none);a=this.Rd.shapeNode.Vq;this.LSa.pv(nf.a.f0);this.LSa.sr(nf.a.VD);this.LSa.Kma("2,2");this.LSa.Mt(a.points);this.wTa=new qO.a;this.wTa.Uk(0);this.Ab.appendChild(this.wTa);this.wTa.ew(qp.a.bK(nf.a.Xla));a=qi.a.mvh(a);const b=nf.a.vDb,c=nf.a.P$c;this.wTa.setPosition(a.width/2-b/2,a.height/2-c/2);this.wTa.Bh(b,c);this.wTa.Sd(!0);this.Ab.xm()}setPosition(a,b){this.Ab.setPosition(a,b)}SD(){}Ej(){}Nq(a){this.Ab.yF(a,
iA.a.Faa)}ov(a){this.Ab.yF(a,iA.a.aUb)}setZIndex(a){this.Ab.tC(a)}mz(){}TE(){return null}MD(){return[]}draw(){}wF(){}eq(){return this.Sb?this.Ab.eq():null}get visible(){return this.Sb}set visible(a){this.Sb=a;this.Ab.Sd(this.Sb)}get oe(){return this.Ab}IP(){return!1}Rx(){}setSelection(){}}Object(e.a)(tO,"ShapeProgressIndicatorView",null,[420,283,284,109]);class uO{create(a){return new tO(a)}}Object(e.a)(uO,"Factory",null,[356]);var Yr=d(321);class PE{constructor(){this.py=null;this.Npa=this.CM=this.Opa=
0;this.startTime=this.O$c=this.hy=this.FL=this.zA=this.HYb=null}gcc(){return this.CM<this.py.OP?Object.assign(new PE,{py:this.py,Opa:this.CM,CM:this.CM+Math.min(this.Npa,this.py.OP-this.CM),Npa:this.Npa,HYb:this.HYb,zA:this.zA,FL:this.FL,hy:this.hy,O$c:this.O$c}):null}}Object(e.a)(PE,"ChunkUploadingContext",null,[]);class fr{constructor(a,b=null){this.$wb=a;this.Ad=b}get error(){return this.$wb}get telemetry(){return this.Ad}}Object(e.a)(fr,"ServiceRequestFailedEventArgs",null,[]);class Hv{constructor(a,
b,c,f){this.ng=this.i9=this.LW=null;this.dle=b;this.$de=c;this.Iab=f;this.Bb=a}get zDa(){return!!this.LW}a$(a,b,c,f,l,w,F,S=null,fa=null){this.zDa?F(new fr(Object.assign(new Yr.a,{Code:59}))):(fa&&fa.register(Object(C.a)(this,this.abort,"abort")),0<l&&(this.i9=Object.assign(new Se.a(2,1,l,Object(C.a)(this,this.yQ,"onTimeout"),90,"85"),{customData:F}),this.Bb.Hb(this.i9)),(this.LW=Object.assign(new PE,{py:a,HYb:c,Opa:0,CM:0,Npa:b,zA:f,FL:w,hy:F,O$c:S,startTime:new Date}).gcc())?this.iJb(this.LW):F(new fr(Object.assign(new Yr.a,
{Code:92}))))}iJb(a){this.dle();if(this.$de()||!this.zDa)this.reset();else{this.hWa();var b=a.py,c=a.zA,f=a.Opa,l=a.CM,w=a.Npa,F=!f&&l===b.OP,S=new FormData;S.append("Type","2");S.append("FileName",a.py.fileName);c&&S.append("ImageToken",c);S.append("Content-Range","bytes "+f+"-"+(l-1)+"/"+b.OP);za.a.J(34420808,818,50,"ChunkedPictureUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, chunkSize:{2}, fileSize:{3}",f,l,w,b.OP);this.ng.onreadystatechange=()=>{this.ng&&4===this.ng.readyState&&
this.gue(a,this.ng.status)};b=F?a.HYb:a.HYb.slice(f,l);S.append("chunk",b);this.ng.send(S)}}gue(a,b){let c=Object.assign(new Yr.a,{Code:94});if(200===b){this.Iab.Ymc(this.ng.getResponseHeader(Hv.VKd));b=a.O$c;let f=null;try{f=Sys.Serialization.JavaScriptSerializer.deserialize(this.ng.responseText)}catch(l){za.a.J(34420810,818,10,"ChunkedPictureUploader::UploadChunk - failed to deserialize response {0}",l)}if(f&&!f.Error&&f.Result){const l=f.Result;a.zA=l.ItemId;const w=a.gcc();a.Opa===l.XOffset&&
l.ItemId?w?(b&&b.okk(100*a.CM/a.py.OP,!1),c=null,this.iJb(w)):(b&&b.okk(100,!0),c=null,za.a.J(34420812,818,50,"ChunkedPictureUploader::UploadChunk - upload completed, duration:{0}",+new Date-+a.startTime),this.reset(),a.FL(new Qj.a(f.Result))):c.Code=152}else f&&f.Error&&(c=f.Error)}else za.a.J(34869445,818,10,"ChunkedPictureUploader::UploadChunk - upload failed, status:{0}, imageToken:{1}",b,a.zA||"");c&&(this.reset(),a.hy(new fr(c)))}hWa(){this.ng=new XMLHttpRequest;this.ng.open("POST",this.Iab.F0b(),
!0);u.AFrameworkApplication.accessToken&&(this.ng.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),this.ng.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.raa.toString()));u.AFrameworkApplication.canary&&this.ng.setRequestHeader(Hv.vhi,u.AFrameworkApplication.canary)}yQ(a){za.a.J(34420816,818,15,"ChunkedPictureUploader::OnTimeout - upload timeout");this.i9=null;this.abort();(a=a.customData)&&a(new fr(Object.assign(new Yr.a,{Code:299})))}abort(){if(this.zDa){za.a.J(34420818,
818,15,"ChunkedPictureUploader::Aborting upload");const a=this.ng;this.reset();a&&a.abort()}}reset(){this.i9&&(this.Bb.ah(this.i9),this.i9=null);this.LW=this.ng=null}}Hv.vhi="X-Key";Hv.VKd="X-NewKey";Object(e.a)(Hv,"ChunkedPictureUploader",null,[337]);class vO{constructor(a,b,c,f){this.Bb=a;this.uZj=b;this.i8b=c;this.Zle=f.pptEditingImageMaxSizeInBytes;this.aKg=Math.floor(.75*this.Zle);this.v2j=52428800;this.xIg=f.Dqg&&f.t7d;this.kHg=f.t7d;this.v0j=f.WDj;this.fIg=f.Yug}get qbc(){return this.xIg?this.v2j:
this.aKg}get gkc(){return this.kHg}get Pgd(){return this.v0j}FVb(a,b){if(b)if(a&&1===a.length){const c=a[0];c.size<this.aKg?this.convertToBase64AndCallback(a,b):this.xIg?this.shrinkToBase64AndCallback(c,b):b(null)}else b(null)}convertToBase64AndCallback(a,b){const c=this.uZj.create();this.kHg?c.knl(a,f=>{let l=f&&0<f.length?f[0]:null;l&&l.length>=this.Zle&&(l=null);this.fIg?b(l):this.Bb.Hb(new Se.a(2,1,0,()=>{b(l)},90,"83"))}):c.Swh(a,b)}shrinkToBase64AndCallback(a,b){this.i8b.pzg(a,c=>{const f=this.i8b.Dph(c,
a.size,this.Zle);this.fIg?b(f):this.Bb.Hb(new Se.a(2,1,0,()=>{b(f)},90,"84"))})}}Object(e.a)(vO,"PPTProcessImageStrategy",null,[389]);var eR=d(1084);class jA{static get Wf(){return Th.a.tA(jA.Ym,ResourceStrings.l_ImageUploadMessage,ResourceStrings.l_NoImageSpecifiedErrorMessage)}}jA.Ym="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block2'> <input type='file' id='fileInput' name='fileInput' class='WACDialogInputFile'/> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(e.a)(jA,"InsertImageDialogHtml",null,[]);class wO extends Th.a{constructor(a){super();this.Zg=null;this.Gr=[];this.Mz=a;this.SCd=!1;this.o8b=u.AFrameworkApplication.fa.ka("InsertLocalPictureMultiSelectionEnabled")}t$k(a){this.Wf=jA.Wf;this.Pe(1,ResourceStrings.L_Insert);this.showDialog(ResourceStrings.L_InsertPicture,Object(C.a)(this,this.nxj,"insertImageDialogHandler"));if(this.Zg=document.getElementById("fileInput"))this.Zg.setAttribute("accept","image/*"),this.o8b&&a&&this.Zg.setAttribute("multiple",
"multiple");a=[];this.Zg&&(ad.a.addHandler(this.Zg,ra.a.Rf,Object(C.a)(this,this.onKeyDown,"onKeyDown")),a.push(this.Zg));var b=this.urb(1);b&&a.push(b);(b=this.urb(0))&&a.push(b);this.Gr=a;this.rSe()}validate(){const a=this.Mz.rmd(this.Zg.value);if(0!==a){const b=document.getElementById("errorText");b.innerText=this.Mz.L0i(a);b.style.display="inline-block";return!1}return!0}dispose(){this.Zg&&ad.a.removeHandler(this.Zg,ra.a.Rf,Object(C.a)(this,this.onKeyDown,"onKeyDown"));super.dispose()}nxj(a){1===
a&&this.Mz.bkk(this.Zg);this.Zg=null}rSe(){if(0<this.Gr.length){const a=new eR.a(this.Gr),b=v.FocusManager.instance().Mk();b&&(this.Gr[0].focus(),b.gj=a,b.CS=!0)}}onKeyDown(a){4!==v.FocusManager.instance().tze(a)&&a.preventDefault()}}Object(e.a)(wO,"InsertImageDialog",Th.a,[]);class QE{constructor(){this.CPc=this.file=this.fileName=null;this.W0f=!1;this.DBb=null;this.OP=this.imageHeight=this.imageWidth=0;this.XTd=!1}}Object(e.a)(QE,"ImageType",null,[]);class xO{constructor(a,b,c,f,l,w,F,S,fa,xa){this.jJb=
0;this.bTa=this.c$b=this.DJg=this.Lfb=!1;this.TK=[];this.ATa="image/*";this.ia=a;this.oFa=b?b.za:null;this.h9=null;this.Wd=c;this.Nab=f;this.sAb=l;this.c1c=S.pptEditingUploadedImageMaxSizeInBytes;this.o$a=w;this.DXj=F;this.ene=S.pptEditingUploadLargeImageMaxSizeInBytes;this.I3j=S.pptEditingUploadLargeImageChunkSizeInBytes;this.J3j=1E3*S.pptEditingUploadLargeImageTimeoutInSeconds;if(this.Obb=S.Jsk)this.ATa=this.Obb.join(",");this.o8b=S.txj;this.Iab=fa;this.Ee=xa;this.KDg=S.NEi}get mVc(){return this.DJg}set mVc(a){this.DJg=
a;this.c$b=0<this.ene&&this.o$a.tHj&&a}get Isk(){return this.c$b}bkk(a){this.Vzf(a);this.oFa&&this.sAb.pWb(this.oFa,a,Object(C.a)(this,this.fwe,"onUploadFrameInitialized"),Object(C.a)(this,this.G_d,"getPictureUploadEndPoint"),this.ATa,!1,!1)}yKf(){return!(void 0===window.self.FormData||null===window.self.FormData)}y6g(a){if(this.oFa){if(this.KDg){if(this.yKf()){this.sAb.pWb(this.oFa,null,Object(C.a)(this,this.fwe,"onUploadFrameInitialized"),Object(C.a)(this,this.G_d,"getPictureUploadEndPoint"),this.ATa,
a&&this.o8b,!0);this.bTa=!1;return}za.a.J(558445203,822,10,"Browser does not support directly opening file dialog. Falling back to the old method")}r.a.rj||r.a.E8a||r.a.N7a&&72>r.a.DUb?(this.sAb.pWb(this.oFa,null,Object(C.a)(this,this.fwe,"onUploadFrameInitialized"),Object(C.a)(this,this.G_d,"getPictureUploadEndPoint"),this.ATa,!1,!1),this.bTa=!1):((new wO(this)).t$k(a),this.bTa=!0)}else za.a.J(18643099,822,15,"PictureUploader initialize failed.")}eHi(a){this.$ld&&(Array.addRange(this.TK,a),this.pBh())}get $ld(){return 1>
this.TK.length}pBh(){if(!this.$ld){const a=new QE,b=this.TK[0];b?(a.fileName=this.lIc(b.name),a.XTd=!0,this.K9g(a)):(za.a.J(40993185,822,15,"PictureUploader.UploadNextImage File is null. Count of files: {0}.",this.TK.length.toString()),Array.clear(this.TK))}}G_d(){return this.Iab.F0b()}fwe(a){this.h9=a;if(!this.bTa){if(this.KDg&&this.yKf()){a.qXb(Object(C.a)(this,this.pjk,"onMultipleFileChosen"));return}if(r.a.nD){a.qXb(Object(C.a)(this,this.Vlk,"onSingleFileChosen"));return}a=a.qXb(null);if(!a)return;
this.TK.push(a.files[0])}this.VGd()}Vzf(a){if(a)if(this.o8b)for(const b of a.files)this.TK.push(b);else this.TK.push(a.files[0])}pjk(a){this.Vzf(a);this.VGd()}pGi(a){a=this.rmd(a.fileName);return 0!==a?(this.h9&&this.h9.RFc(),2!==a&&3!==a||this.Ns(90,a),!1):!0}MYb(a){let b=!0;this.mVc&&a.CPc&&!this.Vvl(a)&&(this.h9&&(this.h9.svb=!1),b=!1);!a.DBb||!this.Lfb&&b||(this.o$a.revokeObjectURL(a.DBb),a.DBb=null);if(b){switch(this.jJb){case 0:this.ia.Ma(aa.a.VIc,2,a);break;case 1:this.ia.Ma(aa.a.HJc,2,a)}this.pBh()}else Array.clear(this.TK)}lIc(a){if(a){let b=
-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);return a.substr(b+1)}return null}Vvl(a){if(a.OP>this.c1c){if(this.c$b&&a.OP<this.ene)return za.a.J(34420823,822,50,"Upload large image: {0}",a.OP),a.XTd=!0;za.a.J(20828424,822,50,"Image size is: {0} MB, bigger than {1} MB ",a.OP/1024/1024,this.c1c/1024/1024);this.Ns(87,4);return!1}return!0}BMi(a){if(!a)return null;const b=a.lastIndexOf(".");return-1===b?null:a.substr(b+1)}Xhd(a,b,c,f=null){if(a.XTd||this.o8b&&1<this.TK.length){const l=
this.h9,w=this.TK[0];Array.remove(this.TK,w);const F=Kc.a.Db;F&&F.Ya("FChuckedPictureUpload","True");this.DXj().a$(a,this.I3j,w,f,this.J3j,S=>{l&&(l.svb=!1,l.dispose());b(S)},S=>{l&&(l.svb=!1,l.dispose());Array.clear(this.TK);c(S)})}else this.h9&&(a=this.U7i(f),this.h9.vsh(b,c,a)),Array.clear(this.TK)}U7i(a){const b=new Bc.a;b.$("PresentationId",this.Ee.presentationId.string);b.$(dg.a.Mda,this.Ee.sessionInfo);b.$("Canary",u.AFrameworkApplication.canary);b.$("access_token",u.AFrameworkApplication.accessToken);
b.$("Type",this.jJb.toString());a&&b.$("ImageToken",a);return b}Vlk(a){a&&(Array.add(this.TK,a.files[0]),this.VGd())}VGd(){if(this.$ld||!this.TK[0])Array.clear(this.TK);else{var a=new QE;a.fileName=this.lIc(this.TK[0].name);this.h9.svb=!0;this.K9g(a)}}K9g(a){this.pGi(a)?this.mVc?this.iFk(a):this.MYb(a):Array.clear(this.TK)}rmd(a,b=!1){if(a&&a.length){if(1===this.jJb&&this.$Lj(a))return za.a.J(39154959,822,50,"Try to set background picture using svg file but not supported."),3;if(this.Hig(a))return 0;
this.BMi(a)?za.a.J(20471823,822,50,"Insert local picture with invalid extension forCopyPaste: {0}",b):za.a.J(20471825,822,50,"Insert local picture with empty extension, forCopyPaste: {0}",b);return 1===this.jJb?3:2}return 1}$Lj(a){return!!a&&0<a.length&&Ja.a.vg(a).endsWith(".svg")}L0i(a){switch(a){case 1:return ResourceStrings.l_NoImageSpecifiedErrorMessage;case 2:return this.vwg()?ResourceStrings.l_InvalidImageErrorWithSvgSupportedMessage:ResourceStrings.l_InvalidImageErrorMessage;case 3:return ResourceStrings.l_InvalidImageErrorMessage;
default:return""}}vwg(){return this.Hig(".svg")}Hig(a){a=Ja.a.vg(a);for(let b=0;b<this.Obb.length;++b)if(this.Obb[b]&&0<this.Obb[b].length&&a.endsWith(this.Obb[b].trim().toLowerCase()))return!0;return!1}Ns(a,b){if(87===a){const c=this.c$b?this.ene:this.c1c;this.Wd.YH(a,f=>{f.$C=1;f.Z4a=[(c/1024/1024).toString()];return!1})}else{const c=this.K0i(b);this.Wd.YH(a,f=>{f.$C=1;f.message=c;return!1})}}K0i(a){return 2===a&&this.vwg()?String.format(ResourceStrings.imageFileNotListedInPptPictureUploadSupportedExtensions,
this.Obb.join(", ")):ResourceStrings.invalidImageFileError}iFk(a){let b=this.TK[0];if(b){a.OP=b.size;a.file=b;if(b.size>this.c1c&&this.c$b)try{b=b.slice(0,6),a.W0f=!0}catch(c){za.a.J(34420828,822,50,"File.slice throw exception"),this.Lfb=!0,this.MYb(a)}this.Nab.hFk(b,c=>{this.BWi(c,a)})}}BWi(a,b){try{let c=a.target.result;b.CPc=c;b.W0f&&(c=this.o$a.createObjectURL(b.file),b.DBb=c);let f=new Image;f.onload=()=>{b.imageWidth=f.width;b.imageHeight=f.height;this.Ozj(b.CPc)&&(this.Lfb=!0,za.a.J(22880261,
822,50,"Fallback for gif"));f.onload=f.onerror=null;f.src="";f=null;this.MYb(b)};f.onerror=()=>{za.a.J(20828428,822,50,"Read image failed");this.Lfb=!0;this.MYb(b)};f.src=c}catch(c){za.a.J(20828430,822,50,"GetBase64Image throw exception"),this.Lfb=!0,this.MYb(b)}}Ozj(a){return 0<a.indexOf("base64,R0lGODlh")||0<a.indexOf("base64,R0lGODdh")}}Object(e.a)(xO,"PictureUploader",null,[336]);class yO{constructor(a){this.Ee=a}F0b(){let a="pptPictureUpload.ashx";if(gb.App.webServiceBase)a=gb.App.webServiceBase+
a;else if(r.a.ag||r.a.zsa)a=Jf.a.yBa(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.fQa(),this.Ee.presentationId.string,u.AFrameworkApplication.PZb());this.Ee.podSessionId&&(a+=String.format("&{0}={1}",dg.a.C9,this.Ee.podSessionId));this.Ee.qk&&(a+=String.format("&waccluster={0}",this.Ee.qk));return a}Ymc(a){if(a){var b=a.split(",");if(4===b.length){const c=b[0].trim()+","+b[1].trim();b=b[2].trim()+","+b[3].trim();a=c===b?c:a}u.AFrameworkApplication.canary=a;u.AFrameworkApplication.E5b&&
za.a.J(37818512,818,50,"PictureUploaderHelper::UpdateCanary - New canary in response: {0}",a)}}}Object(e.a)(yO,"PictureUploaderHelper",null,[335]);class kA{constructor(a,b,c,f,l,w,F,S,fa,xa){this.svb=!1;this.RS=null;this.aka=!1;this.ng=this.yW=this.fUa=this.N7b=this.Vac=this.Zg=this.Nw=this.iie=null;this.nf=a;this.J_j=f;this.Ee=c;this.Nja=l;this.Tje=w;b&&(this.Zg=b.cloneNode(!0));this.WZj=F;this.ATa=S;this.R2j=fa;(this.a$a=xa)?this.BZf():this.Sti()}Sti(){this.RS=document.createElement("iframe");this.RS.style.visibility=
Ei.a.hidden;this.RS.id=kA.Lfi;this.RS.className="ObjectInDialog";this.nf.appendChild(this.RS);this.Vac=Object(C.a)(this,this.j0g,"onUploadFrameLoad");ad.a.addHandler(this.RS,"load",this.Vac);r.a.nD&&this.j0g(null)}qXb(a){u.AFrameworkApplication.Ba.wdb();if(!this.Zg)return null;this.a$a?ad.a.addHandler(this.Zg,"change",()=>{this.IOi(a)}):r.a.nD&&(this.iie=a,this.N7b=Object(C.a)(this,this.JIc,"fileInputChange"),ad.a.addHandler(this.Zg,"change",this.N7b));try{this.Zg.click()}catch(b){const c=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
b.message,b.stack);za.a.J(19505501,818,10,c);return null}return this.Zg}IOi(a){a&&a(this.Zg)}JIc(){this.iie&&this.iie(this.Zg)}vsh(a,b,c){a||za.a.J(590210183,818,10,"UploadFrame::SubmitForm - The responseHandler value is null.");b||za.a.J(590210181,818,10,"UploadFrame::SubmitForm - The errorHandler value is null.");this.fUa=a;this.yW=b;if(c.Kb("ImageToken")||c.Kb("AudioToken"))a=this.Nw.action,a+=String.format("&{0}={1}",dg.a.Spk,1),this.Ee.podSessionId&&(a+=String.format("&{0}={1}","NoAuth","1")),
this.Nw.action=a;for(let f of c.keys)this.qZh(f,c.ga(f));this.a$a?this.xfl():this.Nw.submit()}xfl(){try{za.a.J(558445200,818,50,"SubmitFormWithRequest is preparing to send an upload request");const a=new (Type.parse("FormData"))(this.Nw);this.EXk(a)}catch(a){za.a.J(558445201,818,10,"SubmitFormWithRequest failed to send the request with exception "+a.message),this.nnc("SubmitFormWithRequest failed to send the request with exception "+a.message),this.RFc()}}EXk(a){if(a){const b=this.Nw.action;this.ng=
new XMLHttpRequest;this.ng.open("POST",b);this.ng.onreadystatechange=Object(C.a)(this,this.bnk,"onUploadResponseReceived");this.ng.send(a)}}bnk(){4===this.ng.readyState&&(this.ng.status===Pp.a.Xy?this.nnc(this.ng.responseText):(za.a.J(558445202,818,10,"Upload request failed with status: {0} [isResponseNull: {1}]",this.ng.status,this.ng.responseText?!1:!0),this.nnc("Upload request failed")),this.RFc())}dispose(){this.Nja(this);this.a$a&&this.nf?this.nf.removeChild(this.Nw):this.nf&&this.RS&&(this.nf.contains(this.RS)&&
this.nf.removeChild(this.RS),this.Vac&&ad.a.removeHandler(this.RS,"load",this.Vac),this.Vac=null);this.N7b&&(ad.a.removeHandler(this.Zg,"change",this.N7b),this.N7b=null);this.RS=this.Zg=this.Nw=this.nf=null}qZh(a,b){const c=this.pwi();c.type="hidden";c.id=a;c.name=a;c.value=b;this.Nw.appendChild(c)}pwi(){return this.a$a?document.createElement("input"):this.RS.contentWindow.document.createElement("input")}j0g(a){try{if(!this.RS.contentWindow.document.body)return}catch(b){za.a.J(8958480,818,10,"UploadFrame::OnUploadFrameLoaded - Javascript exception thrown while accessing the document body: {0}",
b.toString());this.nnc("0;Javascript exception thrown accessing the document body.");this.dispose();return}this.aka?this.fUa?(this.nnc(this.xej(this.RS.contentWindow.document.body)),this.RFc()):za.a.J(35984990,818,10,"UploadFrame::OnUploadFrameLoaded - Triggered by {0}",a?"load event":"explicit call"):this.BZf()}BZf(){if(!this.aka){const a=this.WZj();this.a$a?(this.Nw=document.createElement("form"),this.nf.appendChild(this.Nw)):(this.Nw=this.RS.contentWindow.document.createElement("form"),this.RS.contentWindow.document.body.appendChild(this.Nw));
this.zvi();this.Nw.id="formId";this.Nw.method="post";this.Nw.encoding="multipart/form-data";this.Nw.action=a;this.Nw.appendChild(this.Zg);this.aka=!0;this.J_j(this)}}zvi(){this.Zg||(this.a$a?(this.Zg=document.createElement("input"),this.Zg.style.opacity="0",this.R2j&&(this.Zg.multiple="multiple")):this.Zg=this.RS.contentWindow.document.createElement("input"),this.Zg.type="file",this.Zg.accept=this.ATa,this.Zg.id="fileInputId",this.Zg.name="fileInputId")}delayedDispose(){this.dispose()}RFc(){const a=
new Se.a(2,1,0,Object(C.a)(this,this.delayedDispose,"delayedDispose"),90,"82");u.AFrameworkApplication.ve.Hb(a)}nnc(a){let b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a)}catch(c){za.a.J(8958484,818,10,"UploadFrame::UploadResponseReceived - Exception when deserializing response. Response: {0}",a)}b&&!b.Error?this.fUa?this.fUa(new Qj.a(b.Result)):za.a.J(8958482,818,10,"UploadFrame::SubmitInsertPictureForm - The m_onFinished value is null."):(a=b&&b.Error?b.Error:Object.assign(new Yr.a,
{Code:94}),this.yW?this.yW(new fr(a)):za.a.J(8958486,818,10,"UploadFrame::SubmitForm - The m_onError value is null."))}m6k(){return this.aka&&!this.svb}xej(a){let b=null;this.Tje?(this.wLk(a,c=>3!==c.nodeType||!!c.nodeValue&&!c.nodeValue.trim().length),a.firstChild&&3===a.firstChild.nodeType&&(b=a.firstChild.nodeValue)):b=r.a.rj?a.innerText:a.innerHTML;return b||"No response got from server"}wLk(a,b){for(;a.firstChild&&b(a.firstChild);)a.removeChild(a.firstChild)}}kA.Lfi="ppt_uploadframe";Object(e.a)(kA,
"UploadFrame",null,[412,413,414]);class zO{constructor(a,b){this.pxb=[];this.Ee=a;this.Tje=b}pWb(a,b,c,f,l,w,F){if(0<this.pxb.length)for(let S=this.pxb.length-1;0<=S;S--)this.pxb[S].m6k()&&this.pxb[S].dispose();a=new kA(a,b,this.Ee,c,Object(C.a)(this,this.HFi,"disposeHandler"),this.Tje,f,l,w,F);Array.add(this.pxb,a)}HFi(a){Array.remove(this.pxb,a)}}Object(e.a)(zO,"UploadFrameFactory",null,[334]);class AO extends tq{constructor(a,b,c,f,l){super(a,b);this.uc=c;this.sa=f;this.u8b=l}Ms(a){var b="";if(this.u8b){const c=
oi.SchemeColor.parse(a);c&&(c.color&&!c.Dra&&(b=Object(ua.a)(131,this.uc.Sg(this.sa.Pa.kb.Wa.node)),(b=c.resolve(b?b.Ye:null))?c.hP=Ul.g(b.aXa):za.a.J(38061255,826,15,"PptInsertionPointFormatting: SetFontColor: Couldn't resolve font color: {0}",Ul.c(a))),b=c.toString());za.a.J(41267233,826,50,"PptInsertionPointFormatting: SetFontColor: set SchemeColor to: {0}",Ul.c(b));this.Ik.setValue(zb.a.schemeColor,b);c&&c.Dra&&(a=Ul.i(c.hP))}Ja.a.Xa(a)||super.Ms(a)}}Object(e.a)(AO,"PptInsertionPointFormatting",
tq,[]);class RE{constructor(){this.Npa=this.CM=this.Opa=0;this.packageKey=this.Vy=this.mna=null;this.xdd=this.MAb=this.Iga=0;this.startTime=this.hy=this.FL=null}gcc(){return this.CM<this.mna.length?Object.assign(new RE,{Opa:this.CM,CM:this.CM+Math.min(this.Npa,this.mna.length-this.CM),Npa:this.Npa,mna:this.mna,Vy:this.Vy,packageKey:this.packageKey,FL:this.FL,hy:this.hy,Iga:0,MAb:this.MAb,xdd:this.xdd,startTime:new Date}):null}}Object(e.a)(RE,"ChunkContext",null,[]);class BO{constructor(a,b,c,f,l){this.ng=
this.i9=this.LW=null;this.dle=b;this.$de=c;this.Bb=a;this.Ee=f;this.Uv=l}get zDa(){return!!this.LW}a$(a,b,c,f,l,w,F,S,fa){this.zDa?(za.a.J(527496896,818,15,"ChunkedDataUploader::StartUpload - already uploading with uploadId: {0}, not starting new upload for uploadId: {1}",this.LW.Vy,f),fa&&fa(new fr(Object.assign(new Yr.a,{Code:59})))):(0<l&&(this.i9=Object.assign(new Se.a(2,1,l,Object(C.a)(this,this.yQ,"onTimeout"),90,"85"),{customData:fa}),this.Bb.Hb(this.i9)),(this.LW=Object.assign(new RE,{Opa:0,
CM:0,Npa:a,mna:b,packageKey:c,Vy:f,FL:S,hy:fa,Iga:0,MAb:w,xdd:F,startTime:new Date}).gcc())?this.iJb(this.LW):(za.a.J(527235213,818,10,"ChunkedDataUploader::StartUpload - m_uploadingContext is null for uploadId: {0}",f),fa&&fa(new fr(Object.assign(new Yr.a,{Code:437})))))}Hhi(a){this.zDa&&(za.a.J(527235214,818,50,"ChunkedDataUploader::CancelUpload - cancelling upload for uploadId: {0}",this.LW.Vy),this.LW.Vy===a&&this.abort())}iJb(a){this.dle();if(this.$de()||!this.zDa)za.a.J(527496897,818,15,"ChunkedDataUploader::UploadChunk - session expired or not uploading for uploadId: {0}",
a.Vy),this.reset();else{var b=this.hWa(a);this.ng.onreadystatechange=()=>{this.ng&&4===this.ng.readyState&&this.gue(a,this.ng.status)};this.ng.send(b)}}gue(a,b){let c=Object.assign(new Yr.a,{Code:94});if(200===b){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(this.ng.responseText)}catch(f){za.a.J(527496898,818,10,"ChunkedDataUploader::OnChunkUploadComplete - failed to deserialize response {0}, uploadId: {1}",f,a.Vy)}if(b&&!b.Error&&b.Result){const f=a.gcc();f?(this.Uv.shb(100*a.CM/
a.mna.length),this.iJb(f)):(za.a.J(527496899,818,50,"ChunkedDataUploader::OnChunkUploadComplete - upload completed, duration:{0}, uploadId: {1}",+new Date-+a.startTime,a.Vy),this.Uv.shb(100),this.reset(),a.FL&&a.FL(new Qj.a(b.Result)))}b&&(c=b.Error)}else za.a.J(527496900,818,10,"ChunkedDataUploader::OnChunkUploadComplete - upload failed, status:{0}, uploadId:{1}",b,a.Vy);c&&(a.Iga<a.MAb?(za.a.J(527496901,818,15,"ChunkedDataUploader::OnChunkUploadComplete - Retrying a chunk to upload again - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",
a.Opa,a.CM,a.Vy),window.setTimeout(()=>{a.Iga++;this.iJb(a)},a.xdd)):(za.a.J(527496902,818,10,"ChunkedDataUploader::OnChunkUploadComplete - Retry count exceeded - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",a.Opa,a.CM,a.Vy),this.reset(),a.hy&&a.hy(new fr(c))))}hWa(a){this.ng=new XMLHttpRequest;this.ng.open("POST",this.F0b(),!0);u.AFrameworkApplication.accessToken&&(this.ng.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),this.ng.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.raa.toString()));
const b=a.packageKey,c=a.Opa,f=a.CM,l=!c&&f===a.mna.length,w=new FormData;w.append("FileName",a.Vy);b&&w.append("PackageKey",b);w.append("Content-Range","bytes "+c+"-"+(f-1)+"/"+a.mna.length);za.a.J(527496903,818,50,"ChunkedDataUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, uploadLength: {2}, uploadId:{3}",c,f,a.mna.length,a.Vy);a=l?a.mna:a.mna.slice(c,f);w.append("ChunkData",a);return w}F0b(){let a="PastedDataUpload.ashx";if(gb.App.webServiceBase)a=gb.App.webServiceBase+a;else if(r.a.ag||
r.a.zsa)a=Jf.a.yBa(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.fQa(),this.Ee.presentationId.string,u.AFrameworkApplication.PZb());this.Ee.podSessionId&&(a+=String.format("&{0}={1}",dg.a.C9,this.Ee.podSessionId));this.Ee.qk&&(a+=String.format("&waccluster={0}",this.Ee.qk));return a}yQ(a){za.a.J(527496904,818,15,"ChunkedDataUploader::OnTimeout - upload timeout for uploadId: {0}",this.LW.Vy);this.i9=null;this.abort();(a=a.customData)&&a(new fr(Object.assign(new Yr.a,{Code:299})))}abort(){if(this.zDa){za.a.J(527496905,
818,15,"ChunkedDataUploader::Aborting upload for uploadId: {0}",this.LW.Vy);const a=this.ng;this.reset();a&&a.abort()}}reset(){this.i9&&(this.Bb.ah(this.i9),this.i9=null);this.LW=this.ng=null}}Object(e.a)(BO,"ChunkedDataUploader",null,[340]);class CO{constructor(){this.eZj=new sc.a(Object(C.a)(this,this.SAj,"isBrowerSupportObjectUrl"))}get tHj(){return this.eZj.value}SAj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}createObjectURL(a){return URL.createObjectURL(a)}revokeObjectURL(a){URL.revokeObjectURL(a)}get URL(){return window.URL||
window.webkitURL}}Object(e.a)(CO,"PPTFileApiHelper",null,[358]);class DO{XAj(){return window.FileReader?!0:!1}hFk(a,b){const c=new FileReader;c.onload=b;c.readAsDataURL(a)}readAsArrayBuffer(a,b){const c=new FileReader;c.onload=b;c.readAsArrayBuffer(a)}lIc(a){var b=null;if(a){b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);b=a.substr(b+1)}return b}}Object(e.a)(DO,"PPTFileReaderHelper",null,[353]);var fR=d(932);class EO{constructor(){this.uEg=this.o2c=this.pje=this.qje=
this.dpe=this.NG=this.Mja=this.K=null}get name(){return"PowerPointWebEditor.Actor"}Yb(a){this.K=a;const b=a.resolve("PowerPointWebEditor.IApplicationContext");a.resolve("PowerPointWebEditor.IApplicationSettings").VEj?a.register(318,"Box4.Actors.IFormattingStewardBridge").ma().na(()=>new XN(new pE(a.resolve("Box4.IFormattingEditor")),a.resolve("Box4.IFormattingEditor"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPPTParagraphReader"),a.resolve("Box4.IParagraphIndentationReader"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").Iub,a.resolve("PowerPointWebEditor.IApplicationSettings").Zug,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteTextWithHighlight,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled)):a.register(318,"Box4.Actors.IFormattingStewardBridge").ma().na(()=>new pE(a.resolve("Box4.IFormattingEditor")));a.register(319,"PowerPointWebEditor.IGraphTransactionHelper").ma().na(()=>
new IM(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.Oa("PowerPointWeb.Comments.ICommentFrame")));a.register(320,"PowerPointWebEditor.IInsertOnlineVideoDialogHelper").ma().na(()=>new VM(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager")));a.register(321,"Box4.IInsertionPointFormatting").ma().na(()=>new AO(a.qb("Box4.IFontSlotProvider"),
a.resolve("Box4.Actors.IFontNameFormattingStrategy"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").YSc));a.register(322,"Box4.IClipboardCommands").ma().na(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").remapShapeEditCommandEnabled?new mE(u.AFrameworkApplication.Va,aa.a.m4g,aa.a.oye,aa.a.d$c,aa.a.u4g):new mE(u.AFrameworkApplication.Va,D.a.HTb,D.a.jBc,D.a.Ipa,D.a.m9c));a.register(323,
"HtmlImport.IHtmlNormalizerSettings").ma().na(()=>new nC(!1,a.resolve("Common.IAppSettingsManager").ka("SplitHyperlinkFixWithEnterIsEnabled")));a.register(324,"HtmlImport.IHtmlTranslatorSettings").ma().na(()=>{const c=a.resolve("PowerPointWebEditor.IApplicationSettings");return new bC(c.vug&&a.resolve("Common.IAppSettingsManager").ka("ListMarkerIsEnabled"),void 0,void 0,void 0,!0,c.trk,!1,c.pptCopyPasteTextWithHighlight,!1,c.pptCopyPasteFontFamilyEnabled,void 0,c.pptCopyPasteMarginAndIndentationEnabled,
a.resolve("Common.IAppSettingsManager").ka("CopyAndPasteTextFromWordWin32FixIsEnabled"),c.pptCopyPasteFontFamilyEnabled,a.resolve("Common.IAppSettingsManager").ka("SupportCloudFontInExternalPasteIsEnabled"),void 0,void 0,f=>f.mRc&&c.G9d,()=>c.S9d)});a.register(325,"Box4.Actors.IBox4PasteStewardBridge").ma().na(()=>new ZN(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.Actors.IBox4PasteStewardUtils"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.resolve("PowerPointWebEditor.IPptListEditor"),
a.resolve("Box4.Graph.IGraphIteratorFactory")));a.register(lE.a,"Common.PressOnlyKeyEvent").ma().na(()=>lE.a.instance());a.register(ME,"PowerPointWebEditor.PasteFromFloatieArgs").ma().na(()=>new ME);a.register(326,"PowerPointWebEditor.IPasteFloatieHelper").ma().na(()=>new aO(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("Box4.Graph.IGraphInstance"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Na,
a.resolve("PowerPointWebEditor.IThumbnailPane"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("Common.IClickInputManager"),a.resolve("PowerpointPresence.IPresenceEventSource"),a.resolve("PowerPointWebEditor.IDialogManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),
a.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IRibbonPane"),a.resolve("PowerPointWebEditor.IApplicationSettings").fvg,a.resolve("Common.IAppSettingsManager"),a.resolve("Common.PressOnlyKeyEvent"),a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IDesignModeManager").dAa));a.register(nE,"Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy").as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ma().na(()=>
new nE);a.register(273,"Box4.IContextSetEditor").ma().na(()=>xi.ContextSetEditor.instance);a.register(327,"PowerPointWebEditor.IPPTFormattingStewardHelper").ma().na(()=>new YN(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader")));a.register(Zs,"PowerPointWebEditor.EnterViewStrategy").as("Box4.Actors.IEnterViewStrategy").ma().na(()=>new Zs(a.qb("Box4.IAutoCorrectScheduler"),
a.qe("Box4.IUndoManager"),a.Oa("Box4.IExternalSelectionManager")));a.register(KE,"PowerPointWebEditor.PPTFontNameFormattingStrategy").as("Box4.Actors.IFontNameFormattingStrategy").ma().na(()=>new KE(a.resolve("PowerPointWebEditor.IFormattingHelper")));a.register(328,"Box4.Actors.IEopFormattingStrategy").ma().na(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").f9a?Object(ua.a)(328,new NN):Object(ua.a)(328,new iM));a.register(329,"Box4.ISelectAllHandlers").ma().na(()=>new Wr($u.PageReader.instance,
a.qe("Box4.IUndoManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),!1,!0));a.register(330,"Box4.Actors.IDeleteOutlineElementNodeStrategy").ma().na(()=>new LN(a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.ISelectionManager")));a.register(331,"Box4.IFormatPainterStrategy").ma().na(()=>new ON(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptListEditor"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(332,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().na(()=>
new KN);a.register(333,"Box4.Actors.IDeleteTableSegmentStrategy").ma().na(()=>new MN(a.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(334,"PowerPointWebEditor.IUploadFrameFactory").ma().na(()=>new zO(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").XDj));a.register(335,"PowerPointWebEditor.IPictureUploaderHelper").ma().na(()=>
new yO(a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(336,"PowerPointWebEditor.IPictureUploader").ma().na(()=>new xO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ISlidePane"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IUploadFrameFactory"),a.resolve("PowerPointWebEditor.IFileApiHelper"),()=>a.resolve("PowerPointWebEditor.IChunkedPictureUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.IPictureUploaderHelper"),a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(337,"PowerPointWebEditor.IChunkedPictureUploader").na(()=>new Hv(a.resolve("Common.ITaskManager"),()=>{Kc.a.xvb()},Object(C.a)(on.a.instance,on.a.instance.Aob,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper")));a.register(338,"PowerPointWebEditor.IWarningDialog").ma().na(()=>new kO);a.register(339,"PowerPointWebEditor.ICalloutNotificationAdapter").ma().na(()=>
new VQ.a(a.resolve("Common.App.CalloutNotification.ICalloutNotification"),a.resolve("PowerPointWebEditor.IRibbonPane").za));a.register(340,"PowerPointWebEditor.IDataUploader").na(()=>new BO(a.resolve("Common.ITaskManager"),()=>{Kc.a.xvb()},Object(C.a)(on.a.instance,on.a.instance.Aob,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(341,"PowerPointWebEditor.IPastedDataUploader").ma().na(()=>
new gO(a.resolve("PowerPointWebEditor.IDataUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(342,"PowerPointWebEditor.ISystemClipboard").ma().na(()=>new iO(a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory"),a.resolve("PowerPointWebEditor.IDesignModeManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IApplicationSettings")));
a.register(343,"PowerPointWebEditor.IInternalClipboard").ma().na(()=>new WN(a.resolve("PowerPointWebEditor.IApplicationSettings").xsg?a.resolve("Box4.Graph.IGraphInstance").Cd(10):null,a.resolve("PowerPointWebEditor.IApplicationSettings").xsg?a.resolve("Box4.Graph.IGraphInstance").Cd(8):null));a.register(344,"PowerPointWebEditor.ICutCopyManager").ma().na(()=>new UN(a.resolve("PowerPointWebEditor.IDesignModeManager").dAa,[new hO(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").dAa,
a.qe("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportProcessor"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").zBj,
a.resolve("PowerPointWebEditor.IApplicationSettings").nCj,a.resolve("PowerPointWebEditor.IApplicationSettings").yBj,a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager")),new Xr(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").dAa,
a.qe("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").ABj,a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IClipboardTelemetry"),
a.resolve("PowerPointWebEditor.IDeferredContentManager"))],a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended")));a.register(345,"PowerPointWebEditor.IPasteManager").ma().na(()=>new hh(a.qe("PowerPointWebEditor.IFocusManager"),
a.resolve("PowerPointWebEditor.IDesignModeManager").dAa,a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPoint.IBrowserHelperManager"),[new cO(a.resolve("Common.IActionManagerExtended"),a.qe("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").A7d,a.resolve("PowerPointWebEditor.IApplicationSettings").$ug),
new dO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").B7d,a.resolve("PowerPointWebEditor.IApplicationSettings").iKe),new YQ.a(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IWarningDialog"),a.resolve("Common.IBrowserUtils"),
a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IApplicationSettings").nIj,a.resolve("PowerPointWebEditor.IApplicationSettings").QJj,a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IPictureUploader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")),new Lx(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil")),new Vz(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),u.AFrameworkApplication.XP),new NE(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"))],a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Common.IBrowserUtils"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));
a.register(346,"PowerPointWebEditor.ICopyPasteUtility").ma().na(()=>new Aq.a(a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IPresentationReader")));
a.register(347,"PowerPointWebEditor.IPasteHandlerUtil").ma().na(()=>new bO);a.register(348,"PowerPointWebEditor.IClipboardHelper").ma().na(()=>new qE.ClipboardHelper(a.resolve("PowerPointWebEditor.IInternalClipboard"),b.aQa().qk||zp.a.BCh,a.resolve("Common.IAppSettingsManager").Ia("RedisCacheServiceEnabledDatacenters"),a.resolve("Common.IAppSettingsManager").Gc("ClipServiceItemExpireTimeInMinutes",60),a.resolve("Common.IAppSettingsManager").ka("PptEditingSlideCopyAsImageUrlEnabled"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));
a.register(349,"PowerPointWebEditor.IClipServiceManager").ma().na(()=>new TN(b.aQa(),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(350,"Box4.TableEditors.ITableStylePreviewGenerator").ma().na(()=>new Cq(a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),a.resolve("PowerPointWebEditor.DataModel.IHierarchyHelper"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),Mz.CSf,c=>new PD(c,a.resolve("PowerPointWebEditor.ITableStyleResolver")),
c=>new ND(c),a.resolve("PowerPointWebEditor.IApplicationSettings").F9));a.register(351,"Box4.TableEditors.ITableStyleRibbonControls").ma().na(()=>new DN(a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),a.resolve("Box4.TableEditors.ITableStylePreviewGenerator")));a.register(352,"Common.App.ImageProcessor.IImageProcessor").ma().na(()=>new hM(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));
a.register(353,"PowerPointWebEditor.IPPTFileReaderHelper").ma().na(()=>new DO);a.register(354,"Box4.Actors.IFormattingViewOperationFinishedStageProcessor").ma().na(()=>new Yz(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IPageView"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(355,"PowerPointWebEditor.ILocalImageViewFactory").ma().na(()=>new sO(a.resolve("PowerPointWebEditor.IFileApiHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").nub));a.register(356,
"PowerPointWebEditor.IShapeProgressIndicatorViewFactory").ma().na(()=>new uO);a.register(357,"PPTe.IColorPickerBuilderFactory").ma().na(()=>new LQ.a);a.register(358,"PowerPointWebEditor.IFileApiHelper").ma().na(()=>new CO);a.register(359,"PowerPointWebEditor.IInsertImageHelper").ma().na(()=>new TM(a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(oE,"Box4.Actors.FormatPainter").as("Box4.IFormatPainter").ma().na(()=>new oE(a.resolve("Box4.Styles.IStyleEditor"),
a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.ICharacterPropertiesEditor"),Rf.a.instance,a.qb("Box4.IFeatureHelper"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TextFormattingHelper")));a.register(360,"PowerPointWebEditor.IFormatPainter").ma().na(()=>
new oO(a.resolve("Common.IActionManagerExtended"),a.resolve("Box4.Graph.IGraphInstance").Cd(10),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(361,"PPTe.IResourceViewElementResolver").ma().na(()=>new SN(b.aQa(),gb.App.webServiceBase));a.register(362,"PowerPointWebEditor.IOfflineModalCallout").ma().na(()=>new pO(a.resolve("Box4.IAppFrame")));
a.register(363,"PowerPointWebEditor.IPPTOfflineManager").ma().na(()=>new jO(a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));
a.register(364,"PowerPointWebEditor.IClipboardTelemetry").ma().na(()=>new eu.a(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("Box4.Graph.IGraphInstance").Cd(8),a.resolve("Box4.Graph.IGraphInstance").Cd(10),a.resolve("Box4.Graph.IGraphInstance").Cd(12),a.resolve("Box4.Graph.IGraphInstance").Cd(60),a.resolve("Box4.Graph.IGraphInstance").Cd(7),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")))}init(){const a=this.K;var b=a.resolve("Common.AFrameworkApplication");const c=b.GR;var f=b.Uq;const l=c.kd;var w=a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),F=f.kdb;const S=a.resolve("Common.IActionManagerExtended"),fa=a.resolve("PowerPointWebEditor.IFrameContext"),xa=a.resolve("PowerPointWebEditor.IFocusManager"),Za=
a.resolve("PowerPointWebEditor.IFormatPainter"),pb=a.resolve("PowerPointWebEditor.CoauthManager"),Mb=a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),hc=lb.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),kc=lb.a.instance.resolve("PowerPointWebEditor.IDialogManager"),Ec=lb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Hc=lb.a.instance.resolve("Box4.ISelectionManager"),Dc=lb.a.instance.Oa("Box4.IExternalSelectionManager"),Td=lb.a.instance.resolve("PowerPoint.IPathManager");
var we=lb.a.instance.resolve("PowerPointWebEditor.IInternalClipboard");const Pd=f.Fd,He=lb.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager");b=lb.a.instance.resolve("PowerPointWebEditor.ISaveBlockingUI");const Pe=lb.a.instance.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Df=lb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),ig=lb.a.instance.resolve("PowerPointWebEditor.INotesView"),Tg=lb.a.instance.resolve("Box4.IFormatPainter"),Ig=a.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),
Ff=a.resolve("Common.Transaction.ITransactionFactory"),nh=a.resolve("PowerPointWebEditor.IPresentationReader"),Jg=a.resolve("PowerPointWebEditor.IShapeReader"),$h=a.resolve("PowerPointWebEditor.Graph.ITableReader"),Li=a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),Aj=a.resolve("PowerPointWebEditor.Graph.ITableRowReader");var Zi=a.resolve("PowerPointWebEditor.ITableEditor");const Ui=lb.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),Bi=lb.a.instance.resolve("PowerPointWebEditor.IGraphTransactionHelper"),
Dk=a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),kj=a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),rk=a.resolve("PowerPointWebEditor.Graph.IGraphNodeContextHelper"),ml=lb.a.instance.resolve("Box4.List.IListReader"),nl=a.resolve("Box4.Graph.IGraphIteratorFactory"),Bl=a.resolve("PPTe.IColorPickerBuilderFactory"),bk=a.resolve("PowerPointWebEditor.View.IPPTPageView");this.Mja=lb.a.instance.resolve("PowerPointWebEditor.ICutCopyManager");this.NG=lb.a.instance.resolve("PowerPointWebEditor.IPasteManager");
const Bj=lb.a.instance.resolve("PowerPointWebEditor.IPresentationResourcesManager"),ck=lb.a.instance.resolve("PPTe.IResourceViewElementResolver");lb.a.instance.resolve("PowerPointWebEditor.ILocalImageViewFactory");lb.a.instance.resolve("PowerPointWebEditor.IShapeProgressIndicatorViewFactory");const al=lb.a.instance.resolve("PowerPointWebEditor.IGraphHotColdManager"),Cj=lb.a.instance.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),oh=a.resolve("Common.Utils.IHighContrastDetector"),bl=
lb.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),Ol=a.resolve("PowerPointWebEditor.IRibbonUser"),qm=a.resolve("Box4.CloudFontService"),sk=a.resolve("Box4.CustomFontService");this.dpe=new gj(S,hc,xa,fa.LCID,Ec,Ff,Bi,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),nh,new nO(lb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),lb.a.instance.resolve("PowerPointWebEditor.IPresentationReader")),Bj,l,ck);this.qje=new Ej(Bi,S,xa,Ec,hc,bk,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),
a.resolve("Box4.Graph.IGraphInstance").Cd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),He,Ui,Cj,a.resolve("PowerPointWebEditor.IApplicationSettings").CFj,a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),a.Oa("PowerPointWebEditor.IInsertShapeOverlayViewElement"),
a.resolve("PowerPointWebEditor.IApplicationSettings").Etb,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IApplicationSettings").l6d,a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Box4.Graph.IGraphInstance").Cd(10));this.pje=new $z(Bi,S,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),hc,bk,a.resolve("Box4.Graph.IGraphInstance").Cd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,
He,Ui,Cj,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInkDryStore"));we=new yM(S,xa,a.resolve("PowerPointWebEditor.IPptSelectionManager"),Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ff,a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),we,hc,this.Mja,this.NG,a.resolve("PowerPointWebEditor.IDesignModeManager").dAa,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),
nh,Ui,bk,a.resolve("PowerPointWebEditor.IWarningDialog"),(gi,Tf,wd,oe,rf,Vd,yg,hi,vi)=>new aN(gi,Tf,wd,oe,rf,Vd,yg,hi,vi),Cj,a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPointWebEditor.IInsertImageHelper"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"));const Ek=new bi(S,xa,Ff,F,Za,
hc,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IBox4ColorHelper"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),a.resolve("PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor"),a.resolve("PowerPointWebEditor.IJSanityHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),Tg,Ig,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),oh,a.resolve("PowerPointWebEditor.Graph.ITableReader"),
a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("Box4.IPageView").Na),ai=new $M(S,hc,fa,Ff,Ec,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"));F=new KM(S,Ff,Ec,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
a.resolve("PowerPointWebEditor.IPPTUnitConversion"),fa,a.resolve("PowerPointWebEditor.IApplicationSettings"));w=[new pM(S,l,w,Ec,Ff,hc),we,new Mx(S,l,u.AFrameworkApplication.fa.ka("UseToastForDeferredBlobsEnabled"),a.resolve("PowerPointWebEditor.IClipServiceManager"),xa,hc,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ff,Dk,Pd,a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),bk,Cj,a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.ICcpEventNotifier"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),al,a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPasteFloatieHelper"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),this.NG,a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),
a.resolve("PowerPointWebEditor.IPastedDataUploader"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new BM(S,lb.a.instance.resolve("PowerPointWebEditor.IDesignModeManager"),kc,a.qe("PowerPointWebEditor.IContextMenuUser"),Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),xa,a.resolve("PowerPointWebEditor.IOfflineModalCallout"),l.pptContextMenuOnSelectionFixIsEnabled),new CM(S,
Ec,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.View.IAccCheckPane"),l.powerPointGraphicToolTabIsEnabled,l.N4g,l.gDb),new IN(S,l,Xu.a.hsb,nl,a.resolve("Box4.IParagraphReader")),new JN(cu.instance),this.qje,this.pje,F,new Ox(S,hc,xa,fa.notesPane,ig,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),fa,a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),f,lb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView")),
new ZM(S,a.resolve("PowerPointWebEditor.IPPTOfflineManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser")),ai,new gN(S,fa,Ol,xa,a.resolve("PowerPointWebEditor.ICUIManager"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("Common.IRibbonExternal"),a.resolve("Common.IAppSettingsManager").ka("AltForKeytipEnabled")),new jN(S,hc,xa,kc,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
Za,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IAriaManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),l.vz,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IShapeReader"),l.podsNewThumbnailVisibleRangeFetchExperience,a.resolve("PowerPointWebEditor.IVideoManagerStore"),l.gP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),l.p3a),Ek,new nN(S,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
hc,Ff,xa,Bj,ck,Ec,Jg,a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointGraphicToolTabIsEnabled,a.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),new Bv(Bi,S,xa,hc,a.resolve("PowerPointWebEditor.IFontUtilsManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IFormattingEditor"),Jg,!!qm&&qm.isEnabled,!!sk&&sk.isEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,
a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),new oN(Bi,S,xa,hc,Ec,Jg,a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("Box4.Graph.IGraphIteratorFactory"),Ff,l.T9d,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("Box4.List.IListReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),this.dpe,new pN(S,hc,Ff,Bi,xa,Ec,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
nh,l,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")),new rN(S,kc,xa,hc,Bi,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),nh,Pe,(gi,Tf)=>new fR.a(gi,Tf),a.resolve("PowerPointWebEditor.IPptSelectionManager"),l.vz,l.U9d),new uN(S,hc,Ec,Ff,xa,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),He,nh,Ui,bk,Cj,a.resolve("PowerPointWebEditor.IShapeReader")),
new wN(()=>Df,new xN(Hc,Xu.a.hsb,a.resolve("Box4.IContextSetEditor")),Dc,l),new EN(S,hc,l,xa,Ec,Df,a.Oa("PowerPointWebEditor.IAppForOfficeManager"),a.qe("PowerPointWebEditor.IAppforOfficeClassFactory"),bk,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),
a.resolve("PowerPointWebEditor.ISlidelessPane"),a.Oa("PowerPointWebEditor.ITextLayoutManager"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.Oa("PowerPointWebEditor.IAudioManagerStore")),new fA(S,Ec,kj,xa,b,Mb,lb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings")),new RN(S,a.Oa("PowerPointWebEditor.ICommentsPane"),xa,a.resolve("Common.IF6Manager"),Ec,kj,hc,Td,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),nh,a.resolve("PowerPointWebEditor.IWindowUtils"),
u.AFrameworkApplication.fa,l,b,c.aQa(),Mb,Pe,lb.a.instance.resolve("PowerPointWebEditor.ISlideshowManager"),lb.a.instance.resolve("Box4.Graph.IGraphInstance").Cd(7),lb.a.instance.resolve("PowerPointWebEditor.IInboundHelper"),lb.a.instance.resolve("Common.ITaskManager"),u.AFrameworkApplication.Be,lb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager"),lb.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Oa("PowerPointWeb.Comments.ICommentFrame"),a.Oa("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
bl,lb.a.instance.Oa("PowerPointLive.ILivePresenter"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IStatusBarUser"),f,a.resolve("PowerPointWebEditor.ITaskPaneManager"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))];Zi=new ku(S,nl,hc,xa,ml,Jg,$h,Aj,Li,Ui,Zi,l,Ff,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ec,Cj,a.resolve("PowerPointWebEditor.ITableSelectionAdapter"),a.resolve("PowerPointWebEditor.ITableMergeSplitEditor"),a.resolve("PowerPointWebEditor.ICellIteratorFactory"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableMetrics"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptIsInsertMultiRowColumnEnabled,Ol,a.resolve("Box4.Styles.ITableStyleReader"));w.push(new hu(S,Ec,xa,ml,a.resolve("Box4.ILineSpacingHelper"),Ff,rk,nl,gb.App.VIa.GEc(12),gb.App.VIa.GEc(10),Jg,a.resolve("Box4.IContextSetEditor"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),
l.T9d,l.isPromoteDemoteOnParagraphEnabled,Bl,l.YSc,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,a.resolve("PowerPointWebEditor.ITableEditor"),Tg,f,Pd,a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Box4.IInsertionPointFormatting"),Ig,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IApplicationSettings").Eeb));w.push(Zi);
f=new IE(S,xa,Jg,Bi,hc,Ec,a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IParagraphReader"));w.push(f);l.uPk&&w.push(new dN(S,xa,a.resolve("PowerPointWebEditor.IPresentationReader")));l.nwk&&w.push(new zM(S,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),l));(l.MHb||l.Hgb)&&w.push(new Fv(S,l,Ff,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ec,$h,a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView")));l.IXh&&w.push(new nM(Ec,
u.AFrameworkApplication.fa,l,Object(C.a)(Fz.App.p2a,Fz.App.p2a.b4f,"forceUpdateRibbonControls")));for(const gi of w)gi.wb(),gi.Fe();lb.a.instance.Oa("PowerPointWebEditor.ISorterViewActorMain").execute(gi=>{gi.wb()});a.resolve("PowerPointWebEditor.IPPTProcessImageStrategy").vai(new vO(a.resolve("Common.ITaskManager"),a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IApplicationSettings")));const tg=this;u.AFrameworkApplication.fa.gf(()=>
{const gi=Qy.a(a),Tf=[new QN(S,hc,Ec,xa,Df,l.QGj,pb,Pd.Bf,a.Oa("PowerpointPresence.IPresenceManager"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.IActionNameResolver"),a.resolve("PowerPointWebEditor.IGroupUngroupUndoRedoActionController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"))],wd=u.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");l.cja&&wd&&Tf.push(new Rx(S,a.resolve("PowerPointWebEditor.IPresentationReader"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),bl));tg.o2c=new hN(S,Bi,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").Cd(7),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"));Tf.push(tg.o2c);Tf.push(new lN(S,Ec,bk,a.resolve("PowerPointWebEditor.IApplicationSettings").kia));Tf.push(new kN(gi,Ec,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),S,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),xa,a.resolve("PowerPointWebEditor.View.ISelectionPane"),
Ek,ai,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),fa,Jg,a.resolve("Box4.IPageView").Na,a.resolve("Common.Transaction.ITransactionFactory")));Tf.push(new EM(gi,Ec,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),S,xa,a.resolve("PowerPointWebEditor.View.IFormatShapePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),Jg,l.CSi,l.h5k,l.kia,a.resolve("PowerPointWebEditor.IImageViewManager")));Tf.push(new GM(Ec,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),S,xa,a.resolve("PowerPointWebEditor.View.IFormatTablePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("Common.IDynamicScriptLoaderProvider").gx,$h,Aj,Li));l.wug?Tf.push(new RM(gi,Ec,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),S,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),xa,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),Ff,l.Fye)):Tf.push(new OM(gi,Ec,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),S,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),xa,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),Ff,l.Fye));Tf.push(new AM(gi,S,xa,Pd));l.powerPointSmartLookupIsEnabled&&Tf.push(new SM(Bi,S,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),hc));l.kwk&&Tf.push(new sM(a.resolve("Common.IDynamicScriptLoaderProvider").gx,S,a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext")));Tf.push(new qM(S,Ec,xa,Ff,a.Oa("PowerPointWebEditor.IAudioManagerStore"),
l.gP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));Tf.push(new mM(S,Ec,Ff,Pd,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),l.kXh,l.Swl));l.qwk&&Tf.push(new YM(a.resolve("Common.IDynamicScriptLoaderProvider").gx,
l.owk,l.pwk,S,hc,xa,Jg,Ui,Ff,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ec,Cj,a.resolve("PowerPointWebEditor.IRibbonChangeManager")));l.pptoCaptionDiscoverabilityPaneEnabled&&Tf.push(new yv(a.resolve("Common.IDynamicScriptLoaderProvider").gx,S,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.ISubtitleContext"),
a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),a.resolve("PowerPointWebEditor.ISlideshowFrame"),l.lwk));tg.uEg=new DM(S,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ff,a.resolve("Box4.Graph.IGraphInstance").Cd(82));Tf.push(tg.uEg);for(const oe of Tf)oe.wb(),oe.Fe();bl.AYb=wd});(new cN(c.lK(),c.aZd(),b,kj,Ec,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IActionNameResolver"))).wb();
u.AFrameworkApplication.Ba&&u.AFrameworkApplication.Ba.jb.A$d&&GQ()}dispose(){this.Mja.dispose();this.NG.dispose();this.dpe.dispose();this.qje.dispose();this.pje.dispose();this.o2c&&this.o2c.dispose();const a=this.K.Oa("PowerPointWebEditor.IDesignerManager").instance;a&&a.dispose()}}Object(e.a)(EO,"ActorPackage",null,[2,3]);class FO{constructor(a,b,c,f,l,w,F,S,fa,xa){this.OG=!1;this.Wb=a;this.ua=b;this.yh=c;this.FG=f;this.Ub=l;this.Xu=w;this.Bb=F;this.Eta=S;this.dOg=fa;this.Oc=xa;this.zne=[0,1,2,
3];this.L3=new Ie.a;for(const Za of this.zne)this.L3.$(Za,[]);this.L3.$(4,[]);this.yh.xM(Object(C.a)(this,this.hC,"onActiveSlideChanged"));this.Eta.yk(Object(C.a)(this,this.q7c,"onMainMastersLoaded"));this.dOg.zga(Object(C.a)(this,this.Pve,"onSlideLoaded"));this.dOg.yk(Object(C.a)(this,this.Jla,"onSlidePropertyChanged"));this.Oc.wB(Object(C.a)(this,this.tL,"onSessionClosed"));this.Oc.G2a(Object(C.a)(this,this.Fda,"onSessionRehydrating"));this.Oc.xB(Object(C.a)(this,this.eo,"onSessionRehydrated"));
this.ULg=new xx(Object(C.a)(this,this.Jwk,"prefetchSlideMasterNode"),250,15E3,8E3,500,"slide master node",this.Bb,3);this.TLg=new xx(Object(C.a)(this,this.Iwk,"prefetchSlideMasterImage"),250,6E4,8E3,500,"slide master image",this.Bb,3);this.hC(null,null)}hC(){this.XSd()}XSd(){const a=this.ua.Ca;a&&8===a.type&&a.Sa(zb.a.vj)&&a.Sa(zb.a.Tn)&&this.Wnl(a.vj,a.Tn)}Jwk(){if(!this.OG){var a=this.L3.ga(0),b=this.L3.ga(1);if(0<a.length){const c=a.length-1,f=a[c];this.vLj(f.first,f.second)&&(Array.removeAt(a,
c),Array.add(b,f),this.ULg.ojd(),this.Xu.Hwk(f.first,f.second))}}}Iwk(){if(!this.OG){this.skd(1,2,c=>!!this.Ub.Sqb(c.first,c.second));var a=this.L3.ga(2);if(0<a.length){const c=a[0];var b=this.Ub.Sqb(c.first,c.second);b&&this.oKe(b)?(b=b.qtb(new $q.a(b.Up,b.Gk)),this.TLg.ojd(),Array.removeAt(a,0),Array.add(this.L3.ga(3),c),this.FG.Oqb(b,!0,()=>{this.skd(3,4,f=>!this.oKe(this.Ub.Sqb(f.first,f.second)));this.TLg.ljd()})):(Array.removeAt(a,0),Array.add(this.L3.ga(4),c))}this.skd(3,4,c=>!this.oKe(this.Ub.Sqb(c.first,
c.second)))}}PMf(){for(const a of this.zne)Array.clear(this.L3.ga(a));Array.clear(this.L3.ga(4))}Pve(a,b){(a=Object(ua.a)(132,b.node))&&a.NB&&this.Ecc(a)}Jla(a,b){a=b.property;b.node&&a===zb.a.Tn&&b.node===this.ua.Ca&&this.XSd()}Ecc(a){if(this.sLj(a)&&a){const b=a.vj,c=a.Tn;b&&c&&(this.skd(1,2,f=>f.first===b&&f.second===c),this.ULg.ljd())}}q7c(a,b){a=b.property;if(a===zb.a.GAb||a===zb.a.kX)this.PMf(),this.XSd()}tL(){this.OG=!0}Fda(){this.PMf()}eo(){this.OG=!1}Wnl(a,b){this.tLj(a,b)||this.uLj(a,b)||
Array.add(this.L3.ga(0),new Nw.a(a,b))}uLj(a,b){for(const c of this.zne)for(const f of this.L3.ga(c))if(f.first===a&&f.second===b)return!0;return!1}tLj(a,b){for(const c of this.L3.ga(4))if(c.first===a&&c.second===b)return!0;return!1}skd(a,b,c){a=this.L3.ga(a);b=this.L3.ga(b);for(let f=a.length-1;0<=f;--f)if(c(a[f])){const l=a[f];Array.removeAt(a,f);Array.add(b,l)}}oKe(a){if(!a)return!1;a=a.qtb(new $q.a(a.Up,a.Gk));if(null===a)return!1;for(const b of a)if({data:a}=this.FG.DPc.udd(b),!a)return!0;return!1}sLj(a){const b=
this.Wb.Bf.ta(zb.a.Zph,null);if(!b)return!1;for(let c=0;c<b.length;++c)if(b[c].equals(a.id))return!0;return!1}vLj(a,b){var c=this.Ub.QH();if(!c)return!1;for(let f=0;f<c.length;++f)if(c[f].Id===a){a=c[f].ContentMasters;if(!a)break;for(c=0;c<a.length;++c)if(a[c].Id===b)return!0;break}return!1}}Object(e.a)(FO,"SlideMasterPrefetchManager",null,[197]);var gR=d(936);class GO{constructor(a,b,c,f,l,w,F){this.Sb=!1;this.X7=null;if(!b)throw Error.argumentNull("appFrame");if(!f)throw Error.argumentNull("viewElementEventSource");
if(!w)throw Error.argumentNull("taskManager");if(!l)throw Error.argumentNull("viewElementEventHandlers");this.Bb=w;this.ir=a;this.Rb=b;this.At=c;this.Kx=f;this.zd=l;this.pHg=F;this.O4j=new Se.a(0,1,0,Object(C.a)(this,this.KOk,"renderCommentShimmerHandler"),90,"115")}get isVisible(){return this.Sb}oal(){if(!this.Sb&&this.ir&&this.ir.za){this.X7=this.gci();this.pHg||this.ir.za.appendChild(this.X7);this.ir.setVisibility(!0);this.pHg&&this.zd.$Bf(Object(C.a)(this,this.z6c,"onCommentContainersChanged"));
var a=new gR.a(!0);this.Kx.u8g(a);this.Rb.zBb(1);this.Sb=!0}}z6c(){this.Rb.Ezc(Object(C.a)(this,this.Bch,"renderCommentShimmerOnSlideResize"));this.zd.YMk(Object(C.a)(this,this.z6c,"onCommentContainersChanged"))}Bch(){this.Bb.Hb(this.O4j);this.Rb.Ccd(Object(C.a)(this,this.Bch,"renderCommentShimmerOnSlideResize"))}KOk(){!this.X7||this.A0f()?za.a.J(522724993,805,10,"Either CommentShimmerView is null or the Element is already added to DOM"):this.ir.za.appendChild(this.X7)}jqj(){if(this.Sb&&this.ir&&
this.ir.za&&this.A0f()){this.ir.za.removeChild(this.X7);this.X7=null;this.Sb=!1;var a={};a.commentShimmerHideTime=(new Date).getTime();za.a.J(523352018,809,50,va.a.toJSON(a))}}ONi(){this.Sb&&this.ir&&this.ir.za&&(this.X7.className+=" CommentShimmerFadeAwayStyles",window.setTimeout(Object(C.a)(this,this.jqj,"hideShimmerUX"),600))}gci(){const a=document.createElement("div");a.className="CommentShimmerFrameStyles";for(let b=0;2>b;b++)a.appendChild(this.hci());return a}hci(){const a=document.createElement("div");
a.className=this.At?"CommentShimmerContainerRtlStyles":"CommentShimmerContainerStyles";a.id="CommentShimmerContainer";const b=document.createElement("div");b.className="CommentShimmerPersonaStyles";const c=document.createElement("div");c.className="CommentShimmerHeaderStyles";const f=document.createElement("div");f.className="CommentShimmerBodyDiv1Styles";const l=document.createElement("div");l.className="CommentShimmerBodyDiv2Styles";const w=document.createElement("div");w.className="CommentShimmerActionStyles";
a.appendChild(b);a.appendChild(c);a.appendChild(f);a.appendChild(l);a.appendChild(w);return a}A0f(){return!!document.getElementById("CommentShimmerContainer")}}Object(e.a)(GO,"CommentShimmerView",null,[198]);class SE{constructor(a,b){this.Rb=a;this.Bua=b;this.Bua.uCf(Object(C.a)(this,this.Ogh,"scaleOnUIChanged"))}dispose(){this.Bua.fch(Object(C.a)(this,this.Ogh,"scaleOnUIChanged"))}w9(){}u9(a){2===a.behavior&&(a=a.actionId,a!==aa.a.Ula&&a!==aa.a.Tla&&a!==aa.a.Sla&&a!==aa.a.Ola||this.updateCommandUI())}Ogh(){this.updateCommandUI()}updateCommandUI(){this.Rb.updateCommandUI()}}
Object(e.a)(SE,"UpdateCommandUIActionListener",null,[146,109]);class TE{constructor(){this.correlationId=this.sessionId=this.Mzd=null;this.actionId=0;this.od=null}get Hf(){return this.Mzd?this.Mzd:""}set Hf(a){this.Mzd=a}}Object(e.a)(TE,"AssistanceSearchVariableUrlParameterSet",null,[]);class gr{constructor(){this.LO=!1;this.KO=!0;this.Qsf=this.gKb=null}get isInitialized(){return this.LO}initialize(a,b){const c=!!a&&!!b;c&&(this.gKb=a,this.Qsf=b);this.LO=c;u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)||lb.a.instance.Oa("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(f=>{f.h2("Enabled").then(l=>{this.KO=l;return null},()=>null)})}wb(a){a||(a=u.AFrameworkApplication.Va);u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.KO=u.AFrameworkApplication.WD,lb.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFeatureEnabled("mso_sendASmile",
!0).then(c=>{this.KO=u.AFrameworkApplication.WD&&c;(c=u.AFrameworkApplication.Ba)&&c.updateCommandUI();return null},()=>null)}));a.ya(G.a.ved,de.a.frame,Object(C.a)(this,this.mal,"showSearchResults"))}mal(a,b,c,f,l){if(1===c)return u.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.KO=!1),l&&"SourceControlId"in l&&(l=l.SourceControlId,("GiveFeedback"===l||"btnFeedback"===l||"btnFeedbackPane"===l||"PptEditingStatusBar.GiveFeedbackPane"===l||"GiveFeedbackPane"===l)&&!this.KO)?8:
mz.SessionStatusManager.instance.nia?8:32;Z.ULS.sendTraceTag(4761738,1302,50,"");Me.a.mark(4771);if(this.isInitialized){a=l.CommandValueId;b=l.SourceControlId;l=Object.assign(new TE,{actionId:G.a.ved,od:l});if(void 0!==a&&null!==a)l=gr.zej(a);else if(void 0!==b&&null!==b)switch(b){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":l.actionId=G.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":l.actionId=
G.a.cPf;break;case "btnShowTraining":case "Training":l.actionId=G.a.Ovh;break;case "btnWhatsNew":case "WhatsNew":l.actionId=G.a.MCh}this.gKb.t9k(this.Qsf,l);Me.a.mark(4772);return 32}Me.a.mark(4772);return 8}dispose(){this.gKb&&(this.gKb.dispose(),this.gKb=null)}static get instance(){gr.Ka||(gr.Ka=new gr);return gr.Ka}static zej(a){const b=new TE,c=a.indexOf("|");b.sessionId=a.substring(0,c);const f=a.indexOf("|",c+1);b.correlationId=a.substring(c+1,f);b.Hf=a.substr(f+1);return b}}gr.Ka=null;Object(e.a)(gr,
"AssistanceActor",null,[109]);class UE{constructor(){this.LVe=this.mb=this.kib=null;this.Jyd=!1}t9k(a,b){if(b.actionId!==G.a.giveFeedback||u.AFrameworkApplication.WD)if(this.Jyd&&!u.AFrameworkApplication.MAa)this.kib||(this.kib=this.LVe()),this.kib.kn(a,b);else if(b.actionId===G.a.giveFeedback)this.e9k();else{a=a.DNc(b);b=null;try{Ja.a.C7(a)&&(b=id.a.Qm(a,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(c){throw Z.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+c.message),c;}b?Z.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",a):Z.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",a,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else Z.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.kib&&(this.kib.dispose(),this.kib=null)}Plh(a,b,c){c&&ol.b(a)?this.Jyd=!1:(this.LVe=a,this.Jyd=c);this.mb=b}e9k(){u.AFrameworkApplication.Va.processAction(G.a.giveFeedback,2)}static createInstance(a,b,c=null){const f=new UE;null==c?f.Plh(a,b,u.AFrameworkApplication.aGf||b.ka("HelpTabIsEnabled")):f.Plh(a,b,c);return f}}Object(e.a)(UE,"AssistanceDisplayManager",null,[410,109]);
class Iv{constructor(a,b,c,f,l){this.RF=a;this.lPh=b;this.Ftc=c;this.XFh=f;this.mOh=l}get lcid(){return this.RF}get namespace(){return this.lPh}get hGa(){return this.Ftc}get z8h(){return this.XFh}get locale(){return this.mOh}static hej(a){const b=a.indexOf(".");return 0<=b&&b<a.length&&(a=parseInt(a.substring(0,b)),!isNaN(a))?a:Iv.v9h}static createInstance(a){return new Iv(u.AFrameworkApplication.lcid,a,Iv.hej(u.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
qa.a.re(u.AFrameworkApplication.lcid).name)}}Iv.v9h=16;Object(e.a)(Iv,"AssistanceSearchUrlParameterSet",null,[]);class VE{constructor(a,b){a=new Wm.QueryStringBuilder(a);a.nj("clid",b.lcid.toString());a.nj("p1",b.namespace);a.nj("ver",b.hGa.toString());a.nj("apps",b.z8h);a.nj("lc",b.locale);this._url=a.toString()}DNc(a){const b=new Wm.QueryStringBuilder(this._url);b.nj("src","TellMe");b.nj("query",a.Hf);b.nj("sessionid",a.sessionId);b.nj("correlationid",a.correlationId);return b.toString()}static createInstance(a){return new VE(u.AFrameworkApplication.bGf,
a)}}Object(e.a)(VE,"AssistanceSearchUrlProvider",null,[409]);class WE{Yb(){}init(){u.AFrameworkApplication.rnb&&!u.AFrameworkApplication.CHb&&gr.instance.wb(u.AFrameworkApplication.Va)}dispose(){gr.instance.dispose()}ilg(a){gr.instance.initialize(UE.createInstance(a,u.AFrameworkApplication.fa),VE.createInstance(Iv.createInstance("PPWAEndUser")))}}Object(e.a)(WE,"AssistancePackage",null,[2,3]);var hR=d(982);class HO{constructor(a,b,c,f,l){this.ia=a;this.Zd=b;this.hYj=c;this.gYj=f;this.gie=l}kn(a,b){if(b&&
this.ia){a={};switch(b.actionId){case G.a.cPf:a.query="contactsupport";b=ResourceStrings.L_ContactSupport;break;case G.a.giveFeedback:if(!u.AFrameworkApplication.fa.ka("FeedbackPaneExperienceIsEnabled")){u.AFrameworkApplication.Va.processAction(G.a.giveFeedback,2);return}a.feedback=this.Zqi(b);a.query="givefeedback";b=ResourceStrings.L_GiveFeedback;break;case G.a.Ovh:a.query="showtraining";b=ResourceStrings.L_Training;break;case G.a.MCh:a.query="whatsnew";b=ResourceStrings.L_WhatsNew;break;default:a.query=
b.Hf,b=ResourceStrings.L_Help}const c={};c.ZT=b;c.assetId="FA000000012";c.bO=a;this.ia.Ma(aa.a.pIa,2,c)}}Pu(){const a=this.Uag();a&&this.ia&&this.ia.Ma(aa.a.fDc,2,a)}dispose(){}Uag(){if(this.Zd.instance){const a=this.Zd.instance.YY("FA000000012");if(a)return a.instanceId}return null}Zqi(a){this.gie?this.gie.ONb?this.cLf():this.gYj.$Rd(Object(C.a)(this,this.gOi,"feedbackDownloaded")):za.a.J(42300481,1302,15,"feedbackFormManager is undefined");a=a.od?a.od:{};u.AFrameworkApplication.fa.zAf(a);a=this.hYj.getContext(a);
var b={};"telemetryGroup"in a&&(b=a.telemetryGroup);b.processSessionId=a.sessionId;b.officeBuild=a.build;a.telemetryGroup=b;if(void 0===a.feedbackType||null===a.feedbackType)a.feedbackType=-1;a.userVoiceEnabled=!1;u.AFrameworkApplication.fa.ka("FeedbackPaneUserVoiceIsEnabled")&&"userVoice"in a&&(b=a.userVoice,"url"in b&&(a.userVoiceLink=b.url,a.userVoiceEnabled=!0,za.a.J(42300483,1302,15,"feedback pane user voice is enable")));u.AFrameworkApplication.fa.ka("FeedbackPaneScreenshotIsEnabled")&&("disableIncludeScreenshot"in
a||(a.disableIncludeScreenshot=!1),"screenshot"in a||(a.screenshot=!0));u.AFrameworkApplication.fa.ka("FeedbackPaneScreenshotPreviewIsEnabled")&&(a.disableScreenshotPreview=!1);u.AFrameworkApplication.fa.ka("FeedbackPaneScreenshotSelectedDefaultIsEnabled")&&(a.includeScreenshotSelectedDefault=!0);return a}cLf(){if(hR.a.NUg())za.a.J(42300485,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(Object(C.a)(this,this.j4g,"postScreenshotData"));return}catch(a){za.a.J(593881115,
1302,15,"Failed to use createScreenshot. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(Object(C.a)(this,this.j4g,"postScreenshotData"))}catch(a){za.a.J(593881113,1302,15,"Failed to use html2canvas. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}}}gOi(a){a&&(this.gie.Nxg(a),this.cLf())}j4g(a){a=a.toDataURL("image/jpeg");const b=this.Uag(),c={};c.screenshot=a;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(b,"onScreenshot",
c,null)}}Object(e.a)(HO,"AgaveAssistancePane",null,[383,109]);class IO extends WE{constructor(){super();this.s1e=this.FYe=this.GYe=this.Ea=null;this.Load=this.load}get name(){return"PowerPointEditor.Assistance"}Yb(a){this.Ea=a}load(){this.init()}init(){super.init();!u.AFrameworkApplication.rnb&&u.AFrameworkApplication.CHb?za.a.J(8958166,1302,50,"Not initializing the PowerPoint Assistance package because the feature is disabled."):(za.a.J(8958168,1302,50,"Initializing the PowerPoint Assistance package (the feature is enabled)."),
u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(this.GYe=this.Ea.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.FYe=this.Ea.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),this.s1e=this.Ea.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.ilg(()=>new HO(this.Ea.resolve("Common.IActionManagerExtended"),this.Ea.Oa("PowerPointWebEditor.IAppForOfficeManager"),this.GYe,this.FYe,this.s1e))):this.ilg(null))}}Object(e.a)(IO,"PowerPointAssistancePackage",
WE,[314]);class XE{qQi(a,b,c){return a?this.xPi(b,c):this.rQi(b,c)}m2f(a,b,c){return a?this.ZPi(b,c):this.RPi(b,c)}PPi(a){var b=a.uf?a.hg.We:a.hg.Wa;const c=new mb.GraphIterator;a.Tp?c.Pc(a.Tp):c.set(b.node);c.oc(14);a=new mb.GraphIterator;a.Pc(c);a.oc(14);b=Ce.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!Ce.isLastCellInRow(a)){do if((f=Fd.moveToNextColumn(a))&&Ce.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Ce.isLastCellInRow(a))}if(!l&&!Ce.isLastCellInColumn(c)){do if((f=
Fd.moveToNextRow(c))&&Ce.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Ce.isLastCellInColumn(c))}return l?f:null}XPi(a){var b=a.uf?a.hg.We:a.hg.Wa;const c=new mb.GraphIterator;a.Tp?c.Pc(a.Tp):c.set(b.node);c.oc(14);a=new mb.GraphIterator;a.Pc(c);a.oc(14);b=Ce.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!Ce.isFirstCellInRow(a)){do if((f=Fd.moveToPreviousColumn(a))&&Ce.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Ce.isFirstCellInRow(a))}if(!l&&!Ce.isFirstCellInColumn(c)){do if((f=
Fd.moveToPreviousRow(c))&&Ce.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Ce.isFirstCellInColumn(c))}return l?f:null}aJc(a,b){var c=a.uf?a.hg.We:a.hg.Wa;const f=new mb.GraphIterator;a.Tp?f.Pc(a.Tp):f.set(c.node);f.oc(14);a=Ce.findControllingCellFromNode(c.node);c=null;if(b){do{if(Ce.isFirstCellInColumn(f))break;c=Fd.moveToPreviousRow(f)}while(c&&Ce.findControllingCellFromNode(c)===a)}else{do{if(Ce.isLastCellInColumn(f))break;c=Fd.moveToNextRow(f)}while(c&&Ce.findControllingCellFromNode(c)===
a)}return c}l2f(a,b){if(!kk.l(a))return null;a=mb.GraphIterator.nb(a.currentNode);a.oc(14);let c;const f=Cd.TableReader.gu(a.origin);do c=b?Fd.moveToPreviousRow(a):Fd.moveToNextRow(a);while(f&&c&&kk.h(a));return c}uVa(a,b,c,f,l){let w=null;lc.OutlineElementNavigator.Ke(a);const F=Md.OutlineElementReader.isRtl(a.currentNode);if(c)if(Fd.returnToCell(a),b=Ce.isLastCellInRow(a),c=Ce.isFirstCellInRow(a),l||!F&&c||F&&f&&b)Fd.returnToContainingRow(a),(f=this.l2f(a,!0))?w=fd.SelectionFactory.oj(f,!b):l&&
(lc.OutlineElementNavigator.Ke(a),l=new zn.a,l.Pc(a),(a=lc.OutlineElementNavigator.Jua(l,!1,!1))&&(w=fd.SelectionFactory.oj(a,!1)));else{do F?Fd.moveToNextColumn(a):Fd.moveToPreviousColumn(a);while(Ce.isGhostCell(a)&&!Ce.isFirstCellInColumn(a));Ce.isGhostCell(a)||(w=fd.SelectionFactory.oj(a.currentNode,!F))}else Md.OutlineElementReader.PB(a,b,F)||Cb.SelectionEditor.Mg(b)||Fd.returnToCell(a),w=fd.SelectionFactory.oj(a.currentNode,!F);return w}tVa(a,b,c,f,l){let w=null;lc.OutlineElementNavigator.Ke(a);
const F=Md.OutlineElementReader.isRtl(a.currentNode);if(c)if(Fd.returnToCell(a),c=Ce.isLastCellInRow(a),b=Ce.isFirstCellInRow(a),l||!F&&f&&c||F&&!f&&b)Fd.returnToContainingRow(a),(f=this.l2f(a,!1))?w=fd.SelectionFactory.oj(f,b):(lc.OutlineElementNavigator.Ke(a),f=new zn.a,f.Pc(a),(a=lc.OutlineElementNavigator.KI(f,!1,!1))&&(w=fd.SelectionFactory.oj(a,!0)));else{do F?Fd.moveToPreviousColumn(a):Fd.moveToNextColumn(a);while(Ce.isGhostCell(a)&&!Ce.isLastCellInRow(a));Ce.isGhostCell(a)||(w=fd.SelectionFactory.oj(a.currentNode,
F))}else Md.OutlineElementReader.PB(a,b,!F)||Cb.SelectionEditor.Mg(b)||Fd.returnToCell(a),w=fd.SelectionFactory.oj(a.currentNode,F);return w}}Object(e.a)(XE,"ATableCellSelectionStrategy",null,[560]);class YE extends XE{constructor(){super()}RPi(a,b){var c=a.kb;let f=null;if(a.nl){let l=null;if(b){if(c.Tp=a.yha,a=Object(ua.a)(Pl.TableCellNode,this.PPi(c)))a.isGhostCell&&(l=a,a=a.ly()),f=c.bG.isValid&&c.bG.node&&a===c.bG.node?fd.SelectionFactory.oj(c.bG.node,!c.uf):fd.SelectionFactory.Zt(Vq.TableNodeContext.create(Object(ua.a)(fg.a,
a)),c.uf)}else if(c=a.ga(Math.max(0,Math.min(a.nha,a.Twa))),c=Object(ua.a)(Pl.TableCellNode,c.hg.We.node),c.isControllingCell&&(c=c.nZd(2)),a=c.bZ(),b=c.SKc().pGa,!a&&b&&(c=b.N2f),a=c)a.isGhostCell&&(l=a,a=a.ly()),f=Cb.SelectionEditor.xl(fd.SelectionFactory.$k(Object(ua.a)(fg.a,a)),!0,!1);f&&l&&(f.Tp=mb.GraphIterator.nb(l))}return f}ZPi(a,b){let c=a.kb,f=null;a.nl&&(b?(c.Tp=a.yha,a=Object(ua.a)(Pl.TableCellNode,this.XPi(c)),b=null,a&&(a.isGhostCell&&(b=a,a=a.ly()),(f=c.bG&&c.bG.isValid&&a===Object(ua.a)(123,
c.bG.node)?fd.SelectionFactory.oj(c.bG.node,!c.uf):fd.SelectionFactory.Zt(Vq.TableNodeContext.create(Object(ua.a)(fg.a,a)),c.uf))&&b&&(f.Tp=mb.GraphIterator.nb(Object(ua.a)(fg.a,b))))):(a.nha>a.Twa?(c=a.V4,c.Tp=c.uf?a.jYa:null):c.Tp=c.uf?null:a.yha,f=Cb.SelectionEditor.xl(fd.SelectionFactory.$k(c.hg.Wa.node),!0,!1),f.Tp=c.Tp));return f}rQi(a,b){let c=a.kb;var f=null;if(a.nl){const l=a.nha>a.Twa;let w=null;if(b){if(c.Tp=a.yha,a=Object(ua.a)(Pl.TableCellNode,this.aJc(c,!0)))a.isGhostCell&&(w=a,a=a.ly()),
f=l&&c.bG&&c.bG.isValid&&a===c.bG.node?fd.SelectionFactory.oj(c.bG.node,!c.uf):fd.SelectionFactory.Zt(Vq.TableNodeContext.create(Object(ua.a)(fg.a,a)),c.uf)}else l?(c=a.V4,c.uf&&(c=c.Uqb(),c.Tp=a.jYa)):c.uf?c=c.Uqb():c.Tp=a.yha,f=Object(ua.a)(Pl.TableCellNode,this.aJc(c,!0)),f?f.isGhostCell&&(w=f,f=f.ly()):(f=Object(ua.a)(Pl.TableCellNode,c.hg.Wa.node),w=c.Tp?Object(ua.a)(Pl.TableCellNode,c.Tp.currentNode):null),f=fd.SelectionFactory.oj(Object(ua.a)(fg.a,f),!0);f&&w&&(f.Tp=mb.GraphIterator.nb(Object(ua.a)(fg.a,
w)))}return f}xPi(a,b){let c=a.kb;var f=null;if(a.nl){const l=a.nha<a.Twa;let w=null;if(b){if(c.Tp=a.yha,a=Object(ua.a)(Pl.TableCellNode,this.aJc(c,!1)))a.isGhostCell&&(w=a,a=a.ly()),f=l&&c.bG&&c.bG.isValid&&a===Object(ua.a)(123,c.bG.node)?fd.SelectionFactory.oj(c.bG.node,!c.uf):fd.SelectionFactory.Zt(Vq.TableNodeContext.create(Object(ua.a)(fg.a,a)),c.uf)}else l?(c=a.V4,c.uf&&(c=c.Uqb(),c.Tp=a.jYa)):c.uf?c=c.Uqb():c.Tp=a.yha,f=Object(ua.a)(Pl.TableCellNode,this.aJc(c,!1)),f?f&&f.isGhostCell&&(w=f,
f=f.ly()):(f=Object(ua.a)(Pl.TableCellNode,c.hg.Wa.node),w=c.Tp?Object(ua.a)(Pl.TableCellNode,c.Tp.currentNode):null),f=fd.SelectionFactory.oj(Object(ua.a)(fg.a,f),!0);f&&w&&(f.Tp=mb.GraphIterator.nb(Object(ua.a)(fg.a,w)))}return f}}Object(e.a)(YE,"TableCellSelectionStrategy",XE,[]);class JO extends Yy{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec){super(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc);this.TSh=l;this.ZLh=c;this.qpc=Ec}JVb(a,b){var c=Object(ua.a)(Yo,b);c&&c.mWa&&this.sji(this.ZLh.gPe)&&
(c=c.mWa.ta(pm.a.Tb,""),this.qpc.mbc(c),this.qpc.dB(6,c));return super.JVb(a,b)}sji(a){const b=new mC;for(b.enqueue(a);0<b.count;){a=b.dequeue();if(14===a.type)return!0;a=mb.GraphIterator.nb(a);let c=a.Ii();for(;c;)b.enqueue(c),c=a.fp()}return!1}TFc(a,b){var c=Object(ua.a)(Yo,b);if(c&&c.mWa){c=c.mWa.ta(pm.a.Tb,"");const f=Object(ua.a)(5,this.TSh.Pa.kb.We.node);f&&(f.Tb=c)}return super.TFc(a,b)}}Object(e.a)(JO,"PPTClipboardOperationCutCopy",Yy,[]);class KO{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,
hc,kc,Ec){this.Da=a;this.ld=b;this.Dr=c;this.oY=w;this.Rc=l;this.xi=f;this.Tq=F;this.ef=S;this.Ufa=fa;this.EJ=xa;this.Vfa=Za;this.alb=pb;this.s1a=Mb;this.mb=hc;this.jk=kc;this.qpc=Ec}create(){return new JO(this.Da,this.ld,this.Dr,this.xi,this.Rc,this.oY,this.Tq,this.ef,this.Ufa,this.EJ,this.Vfa,this.alb,this.s1a,this.mb,this.jk,this.qpc)}}Object(e.a)(KO,"Factory",null,[312]);class LO{constructor(){}get G9c(){return!1}Gnb(){}get qRg(){return!1}set qRg(a){}get o$j(){return!1}Cla(){}OVa(){}get xUg(){return-1}get hGc(){return null}}
Object(e.a)(LO,"NoImageSteward",null,[407]);class ZE{constructor(a){this.P8b=a}create(a,b){return this.P8b||1!==a?new LO(b):null}}Object(e.a)(ZE,"PPTImageStewardFactory",null,[386]);class Dq extends Rr{constructor(a,b,c,f,l,w,F){super(a,b,c);this.ia=f;this.Kw=l;this.zc=F;this.U0j=w.ork;this.r8b=w.B7d;this.c0j=w.A7d;this.P8b=w.Iub;this.V0j=w.RIj}W8d(a,b,c){const f=Dq.v6f(c);a=(!I.a.instance.ga(82)||this.WHj(a,b,f))&&super.W8d(a,b,c);3===c.KNa?this.zc.ew(2,f):2===c.KNa&&this.zc.ew(3,f);a&&(this.zc.mbc(f),
this.pzh(b,f));return a}WJe(a,b,c){const f=Dq.v6f(c);a.setAttribute(eu.a.jLf,f);let l=!1;const w=Dq.UHj(a);if(w)za.a.J(17310354,826,50,null),l=!0;else if(this.V0j&&1===a.getElementsByTagName("Table").length&&!b.iterator.oc(60))this.zc.dB(6,f),l=!0;else{const F=Ea.b(a);F&&F.length||!Dq.j_b(a)||(za.a.J(17310356,826,50,null),l=!0)}l&&!Dq.$fh&&(u.AFrameworkApplication.oN("Microsoft.Office.Server.Powerpoint.Web.IPasteContentFromPandoraSettings"),Dq.$fh=!0);if(!this.U0j)return!0;l&&(this.P8b&&this.Iug(c)?
za.a.J(36779848,826,50,"Paste text only action."):(za.a.J(17310358,826,50,null),this.MLi(a.cloneNode(!0),w)));if(a=!l&&super.WJe(a,b,c))this.zc.mbc(f),this.zc.dB(1,f),this.pzh(b,f);return a}MLi(a,b){b&&a.firstChild&&a.firstChild.className&&(a.className=a.firstChild.className,(this.r8b||this.c0j)&&this.Kw.kmi(a.firstChild,a));Kc.a.W9(()=>{this.ia.Ma(aa.a.s2g,2,a)},100)}WHj(a,b,c){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ComplexTableCellPasteWithFormattingIsEnabled")){a=Dq.Vcj(a);
if(1!==a.count)return!1;this.zc.dB(6,c);a=a.ga(0);return!u.AFrameworkApplication.fa.ka("ComplexTableCellPasteFromComplexTableIsEnabled")&&this.moj(a)?!1:Dq.oIj(b)}c=Object(ua.a)(5,b.iterator.currentNode);let f=null;c&&(f=(c=c.nK())?c.getContainingTable():null);return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PPTInternalPasteTableInTableIsEnabled")&&b.Ok&&b.node.Sa(zb.a.cellId)&&1===a.getElementsByTagName("Table").length&&!!f&&!f.hp()}moj(a){a=a.getElementsByTagName("Table");if(1===
a.length){a=a[0].getElementsByTagName("td");for(let c=0;c<a.length;c++){var b=a[c];if(!b)continue;const f=b.attributes.getNamedItem("rowspan");if(!f||!f.specified||"1"!==f.value)return!0;b=b.attributes.getNamedItem("colspan");if(!b||!b.specified||"1"!==b.value)return!0}}return!1}pzh(a,b){if(Object(ua.a)(5,a.node)&&a.iterator)if(a.iterator.oc(10)){if(a=Object(ua.a)(4,a.iterator.lw(10)))a.Tb=b}else a.iterator.oc(60)&&(a=Object(ua.a)(385,a.iterator.lw(60)))&&(a.Tb=b)}static Vcj(a){a=a.getElementsByTagName("Table");
if(1===a.length){var b;return b=new Ua.a,b.add(a[0]),b}b=new Ua.a;if(2===a.length){for(let c=0;c<a.length;c++){if(0<a[c].getElementsByTagName("Table").length){if(0<=a[c].className.indexOf("Selected_Table"))continue;b.clear();break}b.add(a[c])}1<b.count&&b.clear()}return b}static oIj(a){return a.Ok&&a.node.Sa(zb.a.cellId)&&a.iterator.oc(14)?!0:!1}static j_b(a){a=a.getElementsByTagName(Ne.a.Lba);if(!a.length)return null;a=a[0];return a.src?a:null}static UHj(a){return!!a.firstChild&&!!a.firstChild.className&&
aR.a.Ppg(a.firstChild.className)}static v6f(a){let b="";a&&a.mWa&&(b=a.mWa.ta(pm.a.Tb,""));return b}}Dq.$fh=!1;Object(e.a)(Dq,"PPTPasteCoordinator",Rr,[]);class MO{constructor(){}Gnb(){}get Yaa(){return!1}$W(){}XW(){}ZW(){}YW(){}WW(){}VW(){}}Object(e.a)(MO,"TextOnlyTableSteward",null,[405,406]);class $E{constructor(a){this.P8b=a}create(a,b){return this.P8b||1!==a?new MO(b):null}}Object(e.a)($E,"PPTTableStewardFactory",null,[384]);class aF{constructor(a,b,c){this.QZj=a;this.T1j=b;this.la=c}BCe(){this.QZj.execute(a=>
{this.la.J9d&&a.LCe(this.T1j.value)})}}Object(e.a)(aF,"AccessibilityActor",null,[]);class mu{get key(){return"LIST"}get w6(){return Box4Intl.Box4Strings.l_ListContentTitle}IQe(a){let b;b=null;const c=mu.Sf.rx(a);if(!c)return{returnValue:!1,$ob:b};a=this.h4i(a,c);b=Object.assign(new Uy,{F_:this.key,contentId:a.listId,kP:a});return{returnValue:!0,$ob:b}}WKc(a,b){a=a.kP;const c=this.m3i(a.AS),f=new z.a;b?(b=b.kP,b.level!==a.level?(f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
a.level)),f.add(c)):b.id.equals(a.id)&&b.AS.listType===a.AS.listType||f.add(c)):(f.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c));return f.toArray().join(" ")}m3i(a){let b="";const c=a.listStyle;if(0===a.listType)b=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,a.SV);else if(1===a.listType)switch(c){case 1:b=this.yIf;break;case 2:b=this.Udi;break;case 3:b=this.Vdi;break;default:b=
this.yIf}return b}static get Sf(){return mu.Pg||(mu.Pg=lb.a.instance.resolve("Box4.List.IListReader"))}}mu.Pg=null;Object(e.a)(mu,"ListDetailsProvider",null,[402,403]);class NO{constructor(){this.AS=this.listId=this.id=null;this.level=0}}Object(e.a)(NO,"ListItemInfo",null,[]);class bF extends mu{constructor(a){super();this.JG=a}get yIf(){return ResourceStrings.l_BulletStyle1}get Udi(){return ResourceStrings.l_BulletStyle1}get Vdi(){return ResourceStrings.l_BulletStyle1}h4i(a,b){const c=this.JG.yba(a),
f=this.JG.f4i(a);return Object.assign(new NO,{id:a.currentNode.id,listId:new Fa.a(xg.a.nil,f),AS:b,level:c+1})}}Object(e.a)(bF,"ListDetailsProvider",mu,[]);class OO{constructor(){this.sI=this.K=null}dispose(){}Yb(a){this.K=a;this.sI=this.K.resolve("Common.AFrameworkApplication");a.register(ZE,"PowerPointWebEditor.PPTImageStewardFactory").as("Box4.Actors.IBox4ImageStewardFactory").ma().na(()=>new ZE(a.resolve("PowerPointWebEditor.IApplicationSettings").Iub));a.register($E,"PowerPointWebEditor.PPTTableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().na(()=>
new $E(a.resolve("PowerPointWebEditor.IApplicationSettings").Iub));a.register(Rr,"Box4.Actors.PasteCoordinator").ma().na(()=>new Dq(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));
a.register(312,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().na(()=>new KO(u.AFrameworkApplication.Va,cd.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),dd.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),ni.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),
a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(bF,"PowerPointWebEditor.ListDetailsProvider").na(()=>new bF(a.resolve("PowerPointWebEditor.IPptListCore")));a.register(aF,"PowerPointWebEditor.AccessibilityActor").ma().na(()=>new aF(a.Oa("Box4.Accessibility.IAccessibilityContextManager"),a.qe("PowerPointWebEditor.ListDetailsProvider"),this.sI.GR.kd));a.register(YE,"PowerPointWebEditor.TableCellSelectionStrategy").as("Box4.ITableCellSelectionStrategy").ma().na(()=>
new YE)}init(){const a=gb.App.WC.PR;Hx.fvj(this.sI.Uq,this.K.resolve("Common.IReactContextualUILauncher"),a,this.K.resolve("Common.IExternalUICommandDefinitionMapping"));this.K.resolve("PowerPointWebEditor.AccessibilityActor").BCe()}get name(){return"PowerPointWebEditor.Box4DelayedLoadedPackage"}}Object(e.a)(OO,"Box4DelayedLoadedPackage",null,[2,3]);class PO{constructor(a,b,c,f,l,w,F,S){this.Q9a=this.Xsa=null;this.WVc=0;this.SVc=new Ie.a(0);this.f$a=this.Lfe=this.t7b=null;this.TVc=!1;this.pEg=[ra.a.contextMenu,
ra.a.ixa,ra.a.UL,ra.a.mouseDown,ra.a.pointerDown,ra.a.hNa,ra.a.qcb,ra.a.paste];this.BPg=[ra.a.Rf,ra.a.ol,ra.a.zx,ra.a.click,ra.a.doubleClick,ra.a.CQ,ra.a.IJd,ra.a.OW,ra.a.r5c];this.rI=a;this.Oce=c||[];this.KWj=f||[];this.OXj=l||[];this.TNg=w;this.Oc=b;this.Oc.b1h(Object(C.a)(this,this.zVg,"onAppClosing"));this.Oc.wB(Object(C.a)(this,this.ZA,"onSessionEnd"));this.O3j=F;S&&(oc.EventHandlerManager.instance.GCe(this.pEg,Object(C.a)(this,this.jfk,"onBeforeEventActionContextCreated")),oc.EventHandlerManager.instance.dah(this.pEg,
Object(C.a)(this,this.yek,"onAfterEventActionContextCreated")),oc.EventHandlerManager.instance.GCe(this.BPg,Object(C.a)(this,this.kfk,"onBeforeEventTriggered")),oc.EventHandlerManager.instance.dah(this.BPg,Object(C.a)(this,this.zek,"onAfterEventTriggered")));this.ike=!1}w9(a){if(2===a.behavior){var b=a.actionId;if(this.Oma(b)){var c=this.getCommandName(b);za.a.J(18956760,817,50,"ActionContextListener::OnBeforeAction "+this.Ijg(a,c,"",!1)+"; Current Event: "+(this.f$a||"")+"; Current ActionContext: "+
(Kc.a.Db?Kc.a.Db.toString():""));if(!this.WVc)if(this.TVc=!0,this.c6k(a)){this.Xsa=Kc.a.Tkd(c);this.ike=!0;a=a.telemetryData;c=this.t7b;let f=this.Lfe;null===c&&a&&a[lh.a.gBa]&&(c=a[lh.a.gBa],f=Kc.a.DIb(c));null!==f&&(this.Xsa.Ya(lh.a.o2a,f.toFixed(2)),null!==c&&this.Xsa.Ya(lh.a.gBa,c.toFixed(2)));a&&va.a.forEach(a,(l,w)=>{this.Xsa.mxa(l,(null===w||void 0===w?void 0:w.toString())||"")},null);c=!1;Array.contains(Jl.MWk,b)?c=!0:this.Xsa.ur=!0;c=c||this.Nj(b,a);this.Xsa.Nj=c}else this.Xsa=Kc.a.Db}this.WVc++}}u9(a){if(2===
a.behavior){var b=a.actionId;if(this.Oma(b)){var c=Kc.a.Db;const f=c?c.jJ(lh.a.uzf).toString():"";za.a.J(18956762,817,50,"ActionContextListener::OnAfterAction "+this.Ijg(a,this.getCommandName(b),f,!0)+";Result:"+a.response.toString()+";Current Event:"+(this.f$a||"")+";Current ActionContext:"+(c?c.toString():"")+";RevisionId: "+(c?c.jJ(lh.a.mX).toString():""))}this.r8k(b)&&(c=this.SVc.rMc(b,0),this.SVc.add(b,c+1));this.WVc--;0<this.WVc||!Kc.a.Db||!this.Xsa||(Kc.a.ik(lh.a.xXh,a.response.toString()),
Kc.a.Db!==this.Xsa||this.Q9a||this.tVg(),this.Xsa=null)}}tVg(){const a=Kc.a.Db;if(a){var b=new Date;a.Nj&&!a.CGb&&null===a.uE&&(a.uE=b);a.mxa(lh.a.rXh,(+b-+a.wE).toString());a.ur?0<a.jJ(lh.a.mX).length&&Kc.a.Zda(a):Kc.a.Bkd();this.ike&&(Kc.a.Db=null,this.ike=!1)}}Oma(a){if(!this.TNg)return!1;if(Array.contains(this.Oce,a))return!0;a=u.AFrameworkApplication.Va.eS(a);return!!a&&!(a.flags[32]||a.flags[64])}Nj(a,b){return Array.contains(this.KWj,a)?b&&lh.a.Fyc in b?b[lh.a.Fyc]:!0:!1}r8k(a){return this.TNg&&
Array.contains(this.OXj,a)}c6k(a){return this.O3j?!Kc.a.Db:!Kc.a.Db&&a.Ui}Ijg(a,b,c,f){if(null===a)return"null";b="ActionName="+b+", IsTableShapeSelected="+c+", ActionId="+a.actionId+", BeginMode="+a.bBc+", InvocationMethod="+a.pS+", CommandLocation="+a.$p+", CommandTabName="+a.Spa;return f?"Response="+a.response+", "+b:b}getCommandName(a){const b=this.rI?this.rI.x4(a):null;return b?b:a.toString()}zVg(){if(!(1>this.SVc.count)){var a={};this.SVc.forEach((b,c)=>{b=this.getCommandName(b);a[b]=c;return!0});
za.a.J(512491875,817,15,"ActionContextListener::OnAppClosed {0}",md.c(a));this.Oc.kMk(Object(C.a)(this,this.zVg,"onAppClosing"))}}ZA(){Kc.a.Hki()}jfk(a){this.f$a=a.type;this.Q9a=Kc.a.Tkd(this.f$a);this.Q9a.Nj=!0;this.TVc=!1;a=Kc.a.Ekd(a);null!==a&&Kc.a.zml(a)&&this.Q9a.Ya(lh.a.gBa,a.toFixed(2))}yek(){this.Q9a&&Kc.a.Db===this.Q9a&&this.TVc&&this.tVg();Kc.a.Db=null;this.TVc=!1;this.Q9a=this.f$a=null}kfk(a){this.f$a=a.type;this.t7b=Kc.a.Ekd(a);null!==this.t7b&&(this.Lfe=Kc.a.DIb(this.t7b))}zek(){this.f$a=
this.Lfe=this.t7b=null}}Object(e.a)(PO,"ActionContextListener",null,[146]);var iR=d(360),jR=d(365);class cF{constructor(){this.K=null;this.PDg=[];this.Dk=null;this.Kta="";this.zW=[new OO,new EO];this.t8=!!window.performance&&!!window.performance.now}get name(){return"PowerPointWebEditor.EditingPackage"}Yb(a){this.Kta=String.format("EditingPackage ConfigureStart:{0}",(new Date).getTime());og.a.instance.jc("EditingPackageConfigureStart",Date.now());this.K=a;this.wb();for(const b of this.zW)b.Yb(a);
this.K.resolve("PowerPointWebEditor.IApplicationSettings").Rsg&&this.K.register(197,"PowerPointWebEditor.ISlideMasterPrefetchManager").ma().na(()=>new FO(this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),
this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(7),this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler")));this.K.register(SE,"PowerPointWebEditor.UpdateCommandUIActionListener").ma().na(()=>new SE(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers")))}Pij(a,b,c){return 1===c?32:2===c?(this.Avj(),za.a.J(51430619,822,50,"Draw tab was clicked."),this.K.resolve("Common.IActionManagerExtended").processAction(aa.a.Clg,
2),32):8}Xuj(){const a=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");a.Mq();this.K.resolve("Box4.IGeneralCuiUser");a.updateCommandUI()}vlg(a){const b=this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader");b.MSf=!0;b.Osh=a;b.vzg()}hRj(a,b){za.a.J(592754193,835,50,"Init GC2 started");const c=new Date,f=this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.IGraphicalContentComponentsDependencyLoader");f.KRj().continueWith(l=>{var w=new Date;za.a.J(594073474,813,50,
"gc2 dependency loader loadJS starts: {0}, ends: {1}, durationMS: {2}",Kc.a.Ve(c),Kc.a.Ve(w),+w-+c);if(6===l.status){l=BJ.a({});const F=(w=HJ())&&l&&(b||a);za.a.J(592754198,835,50,"{0}",{["message"]:"InitializeGraphicalContentComponents",["gc2ShapeBuilderImageRenderingEnabled"]:a,["gc2PreloadShadersEnabled"]:b,["isBrowserShapeBuilderCompatible"]:l,["browserSupportsWebGL"]:w,["shouldUseShapeBuilder"]:F});l=F?document.createElement("canvas"):null;f.tvj(l,this.K.resolve("Gc2.IGlyphStore"))}}).continueWith(l=>
{6!==l.status&&za.a.J(575447240,835,10,"Exception: {0}",l.Ti)})}Dwj(){this.K.resolve("PowerPointWebEditor.Video.IVideoDependencyLoader").zzg()}Avj(){this.K.resolve("PowerPointWebEditor.Ink.IInkDependencyLoader").Svb().continueWith(()=>{this.K.resolve("PowerPointWebEditor.WetInkView")})}wb(){this.K.resolve("Common.IActionManagerExtended").ya(aa.a.rdh,de.a.frame,Object(C.a)(this,this.Pij,"handleDrawTabClicked"))}init(){const a=!this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation;
this.Kta=String.format("{0}, InitStart:{1}, OpenEarlyNotBack:{2}",this.Kta,(new Date).getTime(),a);og.a.instance.jc("EditingPackageInitStart",Date.now());a?(this.Dk=this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.Dk.rCf(Object(C.a)(this,this.Wkg,"initEditingPackage"))):this.Xkg()}Wkg(){this.Dk.bch(Object(C.a)(this,this.Wkg,"initEditingPackage"));this.Xkg()}Xkg(){const a=this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener");this.Kta=String.format("{0}, IsBootComplete:{1}, OnBootCompleteTime:{2}",
this.Kta,a.Dia,(new Date).getTime());this.K.resolve("PowerPointWebEditor.IApplicationSettings");a.PCa(()=>{this.Jtj(a)});a.Kpg(()=>{this.Oqi()})}Jtj(a){this.Kta=String.format("{0}, InitStartInternal:{1}",this.Kta,(new Date).getTime());og.a.instance.jc("EditingPackageInitStartInternal",Date.now());var b=this.K.resolve("Common.AFrameworkApplication");const c=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),f=new IO;f.Yb(this.K);f.load(b);for(const w of this.zW)w.init();c.pptSkipFidelityImageFetchDuringBootIfRemoveFidelityEnabled&&
(lb.a.instance.resolve("PowerPointWebEditor.IImageViewManager").kgb(),c.gDa&&b.Uq.jjg());this.Xuj();this.K.resolve("Common.IActionManagerExtended").bma(new PO(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),Jl.Jzg,Jl.BSj,c.Eni,c.dIj,c.podsEnableAyncActionContext,c.actionContextEnableEventCallbacks));if(c.SAb){let w=null;(b=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ca)?(b=ng.e(b,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Na))?
w=b.Naa:za.a.J(524120897,809,10,"slideViewElement is null."):za.a.J(524120898,809,15,"activeSlide is null. SlideCount: "+this.K.resolve("PowerPointWebEditor.IPresentationReader").wj());this.K.register(198,"PowerPointWebEditor.ICommentShimmerView").ma().na(()=>new GO(w,this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),u.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("Common.ITaskManager"),c.Yni))}this.K.resolve("Common.IActionManagerExtended").bma(this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener"));a.Ura||(Xi.a.instance.XBe((new Date).getTime()),c.podsRibbonEarlyRendererExposureControl&&c.SAb&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(()=>{PowerPointWebEditor.MinimalBoot.SetRealRibbon("OnContentEditable")}),iR.a.PFk(),this.K.resolve("PowerPointWebEditor.ISessionState").L_("AppInteractive"),
this.t8&&og.a.instance.jc("ContentEditablePerfMark",window.performance.now()),this.K.resolve("PowerPointWebEditor.IPPTRumTracker").Qua("canvas","slide"),c.podTransmitMetricsBeaconOnBoot&&(Fz.App.pFb(null,Qh.a.contentEditable),this.bTj()),Oc.a.get_instance().bJ(4),a.Ura=!0);c.SAb&&((a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ca)?(a=a.KE(),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader").Fhg(a)&&(this.K.resolve("PowerPointWebEditor.ICommentShimmerView").oal(),za.a.J(523016026,
809,50,"CommentLandingSlide: true"))):za.a.J(524834383,809,10,"activeSlide is null"));og.a.instance.jc(jR.a.OTd,(new Date).getTime());c.Vmc?this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Bha("pptedit.extcommon",null,()=>d.e(6).then(d.bind(null,1202))):(a=wx.a.create("pptedit.extcommon",null,()=>d.e(6).then(d.bind(null,1202))),Oi.a.nt(a));this.Dwj();(a=this.K.resolve("Common.Utils.IHighContrastDetector"))&&a.isInHighContrastMode&&za.a.J(539861442,809,50,"HighContrastMode enabled");
!c.o7d||a&&a.isInHighContrastMode?c.I5d&&c.o7d&&this.vlg(!1):this.vlg(!0);c.dOc&&(this.PDg.push(this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.Gc2WebSocketFrontDoorResponseHandler")),this.hRj(c.YJc,c.LTi));u.AFrameworkApplication.tu||(u.AFrameworkApplication.tu=za.a.$Vb());c.Rsg&&this.K.resolve("PowerPointWebEditor.ISlideMasterPrefetchManager");const l=this.K.qb("Common.IFrameTimingMeter");l&&(za.a.J(39706647,809,50,"Frame timing meter start:{0}",window.performance.now()),l.start(this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterReportingIntervalInSeconds),
this.K.resolve("Common.ITaskManager").Hb(new Se.a(3,1,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterRunningTimeInMiliseconds,()=>{l.stop()},90,"93")));this.Kta=String.format("{0}, InitDone:{1}",this.Kta,(new Date).getTime());og.a.instance.jc("EditingPackageInitDone",Date.now());za.a.J(38876322,809,50,this.Kta)}Oqi(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");za.a.J(39370892,809,50,"Connect RTC by default: BrowserToServerRtc:{0}",a.podsTriggerServerRtcConnectionFromBrowserIsEnabled);
const b=Date.now(),c=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter");c.lAh("{"+u.AFrameworkApplication.userSessionId+"}");const f=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").k0i();f&&(c.Zmc(0<f.length?2:1),c.Fzh(f),this.K.resolve("PowerpointPresence.IPresencePerfLogger").ATj(Date.now(),f.length));this.K.resolve("PowerPointWebEditor.PresenceLoader").KZf();this.K.resolve("PowerPointWebEditor.CoauthNotificationManager");this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").zlg();
za.a.J(41239946,828,50,"PresenceCallback took {0}ms",Date.now()-b);a.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&u.AFrameworkApplication.fa.gf(Object(C.a)(this.K.resolve("PowerPointWebEditor.CoauthNotificationManager"),this.K.resolve("PowerPointWebEditor.CoauthNotificationManager").wrh,"startServerRtcConnection"))}bTj(){if(og.a.instance.e7a)za.a.J(39383647,813,15,"LogBootMetrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};for(var b of[Qh.a.tBa,
Qh.a.q4f,Qh.a.s4f,Qh.a.OJc,Qh.a.r4f,Qh.a.$mb,Qh.a.lAc,Qh.a.bba,Qh.a.lP,Qh.a.contentEditable,Qh.a.wnc,"UserClickTime","DocPageNavigationStart","DocPageFetchStart","DocPageResponseStart","DocPageResponseEnd","BootJsStartTime","BootJsEndTime",Qh.a.jdd,"BootSegments","BootOperations","EditingPackageInitStartInternal","FirstExtJsExecTime","PageViewValidationStart","PageViewValidationDuration","AllViewsValidationDuration","ViewValidationYieldTime","ViewValidationYieldCount","ThumbnailNavigationPaneViewValidationStart",
"ThumbnailNavigationPaneViewValidationDuration","TMYielded","MicrosoftAjaxLoadStartTime","HermesIntlLoadStartTime","EditCoreJsExecStartTime","EditCoreJsLoadStartTime","EditCoreJsLoadEndTime","EditingPackageConfigureStart","EditingPackageInitStart","EditExtSliceTaskRegTime",Qh.a.$Yb,Qh.a.aZb,"MBootFirstImgReqStart","MBootFirstImgReqEnd","MBootFirstImgDrawEnd","MBootRetryCount","MBootCacheHit","NPLT","SplashScreenShown","LogoScreenHideTime","SplashScreenHideSource","SplashScreenTextShownTime","OpenEarlyRequestServerReceived",
"OpenEarlyRequestServerEnd","OpenEarlyImagesRequestStartTime","OpenEarlyImagesRequestEndTime","OpenEarlyImagesRequestImagesCount","OpenEarlyClientRequestSentTime","OpenEarlyClientResponseReceivedTime","TimeDiffToOpenEarly","OpenEarlyCacheDisposed","DocModelManagerLoadAsyncStart","DocModelManagerLoadDocModelEnd","DocModelManagerGetObjectsStart","DocModelManagerGetObjectsEnd","DocModelManagerOnDocModelChanged","DocModelManagerGetHeadersEnd","FluidNewContainerStart","FluidNewContainerAfterCreateDocModel",
"FluidNewContainerBeforeAttach","FluidNewContainerAfterAttach","FluidNewContainerEnd","ParseOpenEarlyServerResponseStart","ParseOpenEarlyServerResponseEnd","AppBootCompleted","FirstDrawStarted","EditingPackageRegisterTime","PackageConfigurerAndInitiatorStartTime","CalculateVisibleThumbRangeWaitTime","CalculateVisibleThumbRangeStartTime"])og.a.instance.qn(b)&&(a[b]=og.a.instance.Rg(b));u.AFrameworkApplication.fa.Ia("PodSID")&&(a.PodSessionID=u.AFrameworkApplication.fa.Ia("PodSID"));(b=window.self.RealRibbonDisplayTime)&&
(a.RealRibbonDisplayTime=b);(b=window.self.RealRibbonDisplaySource)&&(a.RealRibbonDisplaySource=b);(b=window.self.ThumbnailShimmerHideTime)?a.ThumbnailShimmerHideTime=b:og.a.instance.qn("ThumbnailShimmerHideTime")&&(a.ThumbnailShimmerHideTime=og.a.instance.Rg("ThumbnailShimmerHideTime"));(b=window.self.EUPLImageScaleRatio)&&(a.EUPLImageScaleRatio=b);za.a.J(39184516,809,50,"Perf metrics: "+va.a.toJSON(a));b=this.K.resolve("PowerPointWebEditor.IApplicationSettings");b.xGj&&this.TUj(a,b)}}TUj(a,b){if(a[Qh.a.lP])if(a[Qh.a.contentEditable])if(a.UserClickTime||
a.DocPageFetchStart){if(a[Qh.a.contentEditable]-a[Qh.a.lP]>b.x$h){var c=new Map;c.set("ContentEditable",a[Qh.a.contentEditable].toString());c.set("ContentViewable",a[Qh.a.lP].toString());Mf.Health.instance.recordQosError("InteractiveOpenSlowError",["InteractiveOpenSlow"],!1,!0,!1,!1,Object.assign(new pk.a,{extendedProperties:c}))}c=b.kLi;b=a.UserClickTime?a.UserClickTime:a.DocPageFetchStart;a[Qh.a.lP]-b>c&&(c=new Map,c.set("TimingOrigin",b.toString()),c.set("ContentViewable",a[Qh.a.lP].toString()),
Mf.Health.instance.recordQosError("PerceivedOpenSlowError",["PerceivedOpenSlow"],!1,!0,!1,!1,Object.assign(new pk.a,{extendedProperties:c})))}else za.a.J(594928086,809,15,"Both UserClickTime and DocPageFetchStart are null");else za.a.J(594928088,809,15,"ContentEditable is null");else za.a.J(594928090,809,15,"ContentViewable is null")}dispose(){for(const a of this.zW)a.dispose();for(const a of this.PDg)a.dispose();this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener").dispose()}static main(){const a=
(new Date).getTime();za.a.J(38876352,809,50,"EditingPackage::Register time:{0}",a);og.a.instance.jc("EditingPackageRegisterTime",a);m.a.instance.Ec(new cF)}}Object(e.a)(cF,"EditingPackage",null,[2,3]);var kR=d(567);class dF{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc,kc,Ec){this.jka=this.v8=!1;this.jL={};this.g3=this.vI=null;this.hva=()=>{this.v8&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");
if(!f)throw Error.argumentNull("viewPanelContainer");if(!l)throw Error.argumentNull("selectionManager");if(!w)throw Error.argumentNull("shapeReader");if(!F)throw Error.argumentNull("pageView");if(!S)throw Error.argumentNull("actionManager");if(!fa)throw Error.argumentNull("slideDimensionsHelper");if(!xa)throw Error.argumentNull("presentationReader");if(!Za)throw Error.argumentNull("transactionFactory");if(!pb)throw Error.argumentNull("pptPageView");if(!Mb)throw Error.argumentNull("applicationSettings");
if(!hc)throw Error.argumentNull("viewElementEventHandlers");if(!kc)throw Error.argumentNull("viewCoreEventHandlers");this.Rb=a;this.Kc=b;this.we=c;this.cGa=f;this.sa=l;this.Fa=w;this.Pb=F;this.ia=S;this.At=Ec;this.Qz=fa;this.qc=xa;this.Jb=Za;this.qne=pb;this.poe=Mb.Dfh;this.roe=Mb.Cfh;this.zd=hc;this.JI=kc}get cbc(){return document.getElementById(E.AppFrame.vCh)}dispose(){this.v8=!1;this.Rb.Kbh(Object(C.a)(this,this.renderRuler,"renderRuler"));ad.a.removeHandler(this.cbc,ra.a.scroll,Object(C.a)(this,
this.thb,"updateRulerLocation"));this.zd.FDe(Object(C.a)(this,this.Acc,"onCloseTextEditView"));this.zd.Gcd(Object(C.a)(this,this.Zcc,"onOpenTextEditView"));this.JI.tcd(this.hva);this.vI&&this.g3?(ya.a.uHa(this.vI,"ShowWACHorizontalRulerContainer"),ya.a.KH(this.vI,"HideWACHorizontalRulerContainer"),lj.UISurfaces.PMc().then(a=>{a.dispose(this.g3);return null}),this.vI.removeChild(this.g3),this.cGa.removeChild(this.vI),this.g3=this.vI=null):za.a.J(521414489,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=
window.performance.now();if(this.vI&&this.g3){ya.a.uHa(this.vI,"HideWACHorizontalRulerContainer");ya.a.KH(this.vI,"ShowWACHorizontalRulerContainer");var b=this.Kc.Mc;if(b&&b.Ud){var c=b.Ud;c=new $q.a(c.Up,c.Gk);({width:b}=this.Qz.c0b(c,b.Naa?b.Naa.za.style.visibility===Ei.a.visible:!1));c=this.we.ei(this.Kc.Mc.qC).width;1===this.qne.Aw||0>=b||0>=c?za.a.J(522769889,824,50,"Ruler should not be rendered"):(this.jL.rulerCanvasProps=this.stk(fe.a.Qda(b,0)),c=Object(C.a)(this,this.mik,"onIndentChange"),
this.jL.onIndentChange=c,this.jL.indents=this.jL.rulerCanvasProps.textEditableArea?this.$tk():null,this.jL.rtl=this.jka?!this.At:this.At,this.jL.inverted=this.jka?!this.At:this.At,this.g3.style.width=this.we.Nc(b),this.thb(null),lj.UISurfaces.PMc().then(f=>{f.renderRuler(this.g3,this.jL);return null}),b=window.performance.now(),za.a.J(523351434,824,15,"HorizontalRenderRulerDuration:{0}",(b-a).toString()))}else za.a.J(520954716,824,50,"Unable to get slideViewElement")}else za.a.J(521414488,824,50,
"Ruler container div / Ruler div null")}stk(a){const b={},c=ke.a.kv(this.qc.un.getValue(zb.a.slideWidth));var f=a/2;let l=0,w=fe.a.kJ(a,0);b.zeroScale=fe.a.kJ(f,0);this.jka=!1;b.textEditableArea=!1;if(this.sa.w7()&&!this.sa.RRa()){f=this.sa.dZ();var F=f.pc(this.Pb.Na),S=F.rotation;S>this.poe&&S<this.roe&&(this.jka=!0);const fa=F.htmlElement.querySelector(".ShapeViewContent"),xa=this.Fa.ZLc(f,this.Pb.Ed);S=0;f.xh&&(S=f.ys().pc(this.Pb.Na).htmlElement.offsetLeft);S+=F.htmlElement.offsetLeft+fa.parentNode.offsetLeft+
(xa?xa.e:0);F=S+fa.offsetWidth;f=(this.jka?!this.At:this.At)?F:S;S>=l&&S<=w&&F>=l&&F<=w&&(l=S,w=F,b.zeroScale=f,b.textEditableArea=!0)}S=ke.a.Ora(c)/a;a=S*fe.a.Qda(w-l,0);S*=fe.a.Qda(l,0);b.leftMargin=l;b.rightMargin=w;b.precision=.0625;b.scale=c;b.rulerType="Horizontal";b.rightBoundary=ke.a.kJa(a);b.leftBoundary=ke.a.kJa(S);return b}Zcc(){this.v8&&this.renderRuler()}Acc(){this.v8&&this.renderRuler()}$tk(){var a={};if(32!==this.ia.Ma(D.a.GDb,2,a))return za.a.J(523368160,824,10,"Unable to read paragraph indentation for Ruler"),
null;const b={type:"FirstLineIndent"},c={type:"HangingIndent"},f={type:"LeftIndent"};a=a.AA;if(!a)return za.a.J(523352025,824,10,"indentInfo is null"),null;b.value=1===a.specialIndentType?ke.a.kJa(a.cHb+a.cN):2===a.specialIndentType?ke.a.kJa(a.cN-a.cHb):ke.a.kJa(a.cN);c.value=ke.a.kJa(a.cN);f.value=ke.a.kJa(a.cN);return[b,c,f]}mik(a,b){const c=new kR.a;c.Of=1;c.value=ke.a.Ora(b);this.htj(a,c)}htj(a,b){var c=this.sa.dZ();if(a&&b&&c){var f=window.performance.now(),l=this.Jb.ie(15);l.lc(c);c=8;switch(a){case "FirstLineIndent":c=
this.ia.Ma(aa.a.aGb,2,b);l.fd=aa.a.aGb;break;case "HangingIndent":c=this.ia.Ma(aa.a.cGb,2,b);l.fd=aa.a.cGb;break;case "LeftIndent":c=this.ia.Ma(aa.a.tia,2,b);l.fd=aa.a.tia;break;default:za.a.J(523368162,824,10,"IndentChangeHandler called with invalid type")}l.dispose();b=window.performance.now();za.a.J(523330269,824,15,"Indent type:{0} indentChangeDuration: {1}",a,(b-f).toString());32!==c&&za.a.J(523368163,824,10,"Indent operation: {0} failed",c)}else za.a.J(523368161,824,10,"IndentChangeHandler called with invalid params")}VI(){this.PFd();
this.v8=!0;this.Rb.ZBf(Object(C.a)(this,this.renderRuler,"renderRuler"));ad.a.addHandler(this.cbc,ra.a.scroll,Object(C.a)(this,this.thb,"updateRulerLocation"));this.zd.Ozc(Object(C.a)(this,this.Acc,"onCloseTextEditView"));this.zd.DSb(Object(C.a)(this,this.Zcc,"onOpenTextEditView"));this.JI.tzc(this.hva)}thb(){if(this.v8){var a=this.Kc.Mc;a&&a.qC&&window.requestAnimationFrame(()=>{const b=id.a.U5a(a.qC),c=id.a.U5a(this.cGa);this.g3.style.marginLeft=this.we.Nc(b.x-c.x+1)})}else za.a.J(522844361,824,
10,"UpdateRulerLocation called with cookie value false")}RJi(){if(this.vI)return this.vI;this.vI=document.createElement("div");this.vI.id="WACHorizontalRulerContainer";this.vI.className="WACHorizontalRulerContainer";this.vI.setAttribute(re.a.ht,"ruler");this.vI.setAttribute(re.a.ff,re.a.Nza);Sys.UI.DomElement.addCssClass(this.vI,"HideWACHorizontalRulerContainer");return this.vI}SJi(){if(this.g3)return this.g3;this.g3=document.createElement("div");this.g3.className="WACHorizontalRuler";this.g3.id=
"WACHorizontalRuler";return this.g3}PFd(){this.vI=this.RJi();this.vI.appendChild(this.SJi());this.cGa.insertBefore(this.vI,this.cGa.firstChild)}}Object(e.a)(dF,"HorizontalRuler",null,[233]);class eF{constructor(a,b,c,f,l){this.DCj=!0;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeAppFrame");if(!c)throw Error.argumentNull("rulerFactory");if(!f)throw Error.argumentNull("horizontalRuler");if(!l)throw Error.argumentNull("verticalRuler");this.ia=a;this.Rb=b;this.fNg=
c;this.hZc=f;this.X3c=l}wb(){this.ia.ra(aa.a.eLe,Db.a.application,Object(C.a)(this,this.eLe,"showHideRuler"),4);this.ia.ra(aa.a.OAe,Db.a.application,Object(C.a)(this,this.OAe,"queryRulerToggle"),96)}guj(){this.kTc()&&(za.a.J(523351431,824,15,"Ruler init is called"),this.fNg.ulg())}eLe(a,b,c){return this.kTc()?this.iqj(c):this.lal(c)}KAh(){this.Rb.GF({ShowHideRuler:"ToggleButtonModel"})}lal(a){if(1===a)return 32;za.a.J(523351432,824,15,"ShowRuler called");this.fNg.ulg();this.Lkh(!0);this.Rb.Mq();this.KAh();
return 32}iqj(a){if(1===a)return 32;za.a.J(523351433,824,15,"HideRuler called");this.NFi();this.Lkh(!1);this.Rb.Mq();this.KAh();return 32}NFi(){this.kTc()&&(this.hZc.dispose(),this.X3c.dispose(),this.Rb.Mq())}OAe(a,b,c,f,l){if(1===c)return 32;l&&(l[Uh.a.On]=this.kTc());return 32}kTc(){return Di.a.ABa(LE.a.J4g,this.DCj)}Lkh(a){Di.a.LL(u.AFrameworkApplication.fa.Ia("IsRulerOnCookieName"),a.toString(),Di.a.qL)}}Object(e.a)(eF,"RulerActor",null,[]);class QO{constructor(a,b,c){if(!a)throw Error.argumentNull("horizontalRuler");
if(!b)throw Error.argumentNull("verticalRuler");if(!c)throw Error.argumentNull("appFrame");this.hZc=a;this.X3c=b;this.Rb=c}ulg(){this.hZc.VI();this.X3c.VI();this.Rb.Mq();this.hZc.renderRuler();this.X3c.renderRuler()}}Object(e.a)(QO,"RulerFactory",null,[193]);class Eq{constructor(a,b,c,f,l,w,F,S,fa,xa,Za,pb,Mb,hc){this.gKd="HideWACVerticalRulerContainer";this.CJf="ShowWACVerticalRulerContainer";this.jka=this.v8=!1;this.T3=this.HI=null;this.hva=()=>{this.v8&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");
if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");if(!l)throw Error.argumentNull("selectionManager");if(!w)throw Error.argumentNull("shapeReader");if(!F)throw Error.argumentNull("pageView");if(!S)throw Error.argumentNull("slideDimensionsHelper");if(!fa)throw Error.argumentNull("presentationReader");if(!xa)throw Error.argumentNull("pptPageView");if(!Za)throw Error.argumentNull("applicationSettings");if(!pb)throw Error.argumentNull("viewElementEventHandlers");
if(!Mb)throw Error.argumentNull("viewCoreEventHandlers");this.Rb=a;this.Kc=b;this.we=c;this.cGa=f;this.sa=l;this.Fa=w;this.Pb=F;this.qc=fa;this.At=hc;this.Qz=S;this.qne=xa;this.poe=Za.Dfh;this.roe=Za.Cfh;this.zd=pb;this.JI=Mb}get cbc(){return document.getElementById(E.AppFrame.vCh)}dispose(){this.v8=!1;ad.a.removeHandler(this.cbc,ra.a.scroll,Object(C.a)(this,this.thb,"updateRulerLocation"));this.Rb.Kbh(Object(C.a)(this,this.renderRuler,"renderRuler"));this.zd.FDe(Object(C.a)(this,this.Acc,"onCloseTextEditView"));
this.zd.Gcd(Object(C.a)(this,this.Zcc,"onOpenTextEditView"));this.JI.tcd(this.hva);this.HI&&this.T3?(ya.a.uHa(this.HI,this.CJf),ya.a.KH(this.HI,this.gKd),lj.UISurfaces.PMc().then(a=>{a.dispose(this.T3);return null}),this.HI.removeChild(this.T3),this.cGa.removeChild(this.HI),this.T3=this.HI=null):za.a.J(521414487,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.HI&&this.T3){ya.a.uHa(this.HI,this.gKd);ya.a.KH(this.HI,this.CJf);var b=this.Kc.Mc;if(b&&
b.Ud){var c=b.Ud;c=new $q.a(c.Up,c.Gk);({height:b}=this.Qz.c0b(c,b.Naa?b.Naa.za.style.visibility===Ei.a.visible:!1));c=this.we.ei(this.Kc.Mc.qC).height;if(1===this.qne.Aw||0>=b||0>=c)za.a.J(522769888,824,50,"Ruler should not be rendered");else{var f={};f.rulerCanvasProps=this.buk(fe.a.Qda(b,1));f.rtl=this.jka?!this.At:this.At;f.inverted=this.jka?!this.At:this.At;this.T3.style.height=this.we.Nc(b);this.thb(null);lj.UISurfaces.PMc().then(l=>{l.renderRuler(this.T3,f);return null});b=window.performance.now();
za.a.J(523351430,824,15,"VerticalRenderRulerDuration:{0}",(b-a).toString())}}else za.a.J(520954715,824,50,"Unable to get slideViewElement")}else za.a.J(521414486,824,50,"Ruler container div / Ruler div null")}buk(a){const b={},c=ke.a.kv(this.qc.un.getValue(zb.a.slideHeight));var f=a/2;let l=0;a=fe.a.kJ(a,0);b.zeroScale=fe.a.kJ(f,0);this.jka=!1;b.textEditableArea=!1;if(this.sa.w7()&&!this.sa.RRa()){f=this.sa.dZ();var w=f.pc(this.Pb.Na);const S=w.htmlElement.querySelector(".ShapeViewContent");var F=
w.rotation;F>this.poe&&F<this.roe&&(this.jka=!0);F=0;f.xh&&(F=f.ys().pc(this.Pb.Na).htmlElement.offsetTop);F+=w.htmlElement.offsetTop+S.parentNode.offsetTop+S.offsetTop;w=F+S.offsetHeight;f=(this.jka?!this.At:this.At)?w:F;F>=l&&F<=a&&w>=l&&w<=a&&(l=F,a=w,b.zeroScale=f,b.textEditableArea=!0)}b.precision=.0625;b.topMargin=l;b.bottomMargin=a;b.rulerType="Vertical";b.scale=c;return b}VI(){this.PFd();this.v8=!0;ad.a.addHandler(this.cbc,ra.a.scroll,Object(C.a)(this,this.thb,"updateRulerLocation"));this.Rb.ZBf(Object(C.a)(this,
this.renderRuler,"renderRuler"));this.zd.Ozc(Object(C.a)(this,this.Acc,"onCloseTextEditView"));this.zd.DSb(Object(C.a)(this,this.Zcc,"onOpenTextEditView"));this.JI.tzc(this.hva)}thb(){if(this.v8){var a=this.Kc.Mc;a&&a.qC&&window.requestAnimationFrame(()=>{const b=id.a.U5a(a.qC),c=id.a.U5a(this.cGa);this.T3.style.marginTop=this.we.Nc(b.y-c.y+1)})}else za.a.J(522844360,824,10,"UpdateRulerLocation called with cookie value false")}Zcc(){this.v8&&this.renderRuler()}Acc(){this.v8&&this.renderRuler()}PFd(){this.HI=
this.OKi();this.HI.appendChild(this.PKi());this.cGa.insertBefore(this.HI,this.cGa.firstChild)}OKi(){if(this.HI)return this.HI;this.HI=document.createElement("div");this.HI.id=Eq.Ofi;this.HI.className=Eq.Nfi;this.HI.setAttribute(re.a.ht,"ruler");this.HI.setAttribute(re.a.ff,re.a.Nza);Sys.UI.DomElement.addCssClass(this.HI,this.gKd);return this.HI}PKi(){if(this.T3)return this.T3;this.T3=document.createElement("div");this.T3.className=Eq.Mfi;this.T3.id=Eq.Pfi;return this.T3}}Eq.Ofi="WACVerticalRulerContainer";
Eq.Nfi="WACVerticalRulerContainer";Eq.Pfi="WACVerticalRuler";Eq.Mfi="WACVerticalRuler";Object(e.a)(Eq,"VerticalRuler",null,[233]);class fF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Ruler"}Yb(a){this.K=a}init(){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Eeb){var a=this.K.resolve("PowerPointWebEditor.AppFrame");this.K.register(dF,"PowerPointWebEditor.Ruler.HorizontalRuler").ma().na(()=>new dF(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),
a?a.Knc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),u.AFrameworkApplication.isRtl));this.K.register(Eq,"PowerPointWebEditor.Ruler.VerticalRuler").ma().na(()=>new Eq(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.Knc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),u.AFrameworkApplication.isRtl));this.K.register(193,"PowerPointWebEditor.Ruler.IRulerFactory").ma().na(()=>new QO(this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler"),
a));this.K.register(eF,"PowerPointWebEditor.Ruler.RulerActor").ma().na(()=>new eF(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Ruler.IRulerFactory"),this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler")));this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").wb();Oc.a.get_instance().Ak(8,()=>{this.Xte()})}}Xte(){this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").guj()}dispose(){}static main(){m.a.instance.Ec(new fF)}}
Object(e.a)(fF,"PPTWebEditorRulerPackage",null,[2,3]);class lA{static get kzl(){return lA.lzl}}lA.lzl="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>";Object(e.a)(lA,"ZoomDialogHtml",null,[]);class Tx extends Th.a{constructor(a,b,c,f,l=!1){super(!1,!1,l);this.RRb=this.QRb=this.Ea=this.soc=null;this.fzl=
"ZoomDialogBoxGroup";this.yMa=a;this.vyc=b;this.ezf=c;this.Kd=f;this.Wf=this.oci();this.vd=1;this.kg="ZoomDialog"}get tBe(){return"ListRadioBox"}get Rgc(){return"radiobox"}get n8g(){return"WACZoomDialogRadioRow"}get sBe(){return"WACZoomDialogRadioRow-highlight"}get Wn(){return this.Kd}get h6(){return this.soc}Cph(a,b){if(this.RJ)this.Sal(a,b);else{const c={};for(let f=0;f<this.yMa.length;f++)c[this.Rgc+f]=this.vyc[f]===b?!0:!1;this.qj(a,Object(C.a)(this,this.hzl,"zoomDialogHandler"),c);this.VBe();
this.DCe()}}Sal(a,b){var c=Array(this.yMa.length);let f="";for(let l=0;l<this.yMa.length;l++){const w=l.toString();c[l]={["key"]:w,["text"]:this.yMa[l]};b===this.vyc[l]&&(f=w)}b={};b.dialogChoiceGroupProps={["id"]:this.fzl,["defaultSelectedKey"]:f,["options"]:c};c={["id"]:"OptionsDialog",["bodyControls"]:b};this.qj(a,Object(C.a)(this,this.mzl,"zoomDialogReactHandler"),c)}yWk(){this.soc=document.getElementsByName(this.tBe)[0];this.tJc(this.h6)}q6(){this.Ea||(this.Ea=document.getElementById("WACDialogText"));
this.Ea&&(this.QRb||(this.QRb=Object(C.a)(this,this.gzl,"zoomDialogClickHandler"),this.Rm.pb(ra.a.click,this.Ea,this.QRb)),this.RRb||(this.RRb=Object(C.a)(this,this.izl,"zoomDialogKeyDownHandler"),this.Kg.pb(ra.a.Rf,this.Ea,this.RRb)));super.q6();this.sc&&this.Kg.pb(ra.a.ol,this.sc,Object(C.a)(this,this.MM,"dialogDefaultEnterKeyHandler"))}VBe(){this.Wn.Mk().scope.Wo(v.FocusManager.instance().Roa);this.Wn.Mk().scope.Wo(v.FocusManager.instance().Soa);this.Wn.Mk().scope.bindAction(v.FocusManager.instance().Roa,
G.a.Tnc);this.Wn.Mk().scope.bindAction(v.FocusManager.instance().Soa,G.a.Snc)}DCe(){const a=document.getElementsByName(this.tBe);for(let b=0;b<a.length;b++){const c=a[b];ad.a.addHandler(c,ra.a.focus,Object(C.a)(this,this.hbd,"radioButtonFocusHandler"));c.checked&&(this.soc=c)}}hzl(a,b){if(1===a)for(a=0;a<this.yMa.length;a++)if(b[this.Rgc+a]){this.ezf(this.vyc[a]);break}}hbd(a){this.tJc(a.target)}gzl(a){a=a.Hc;if(!a||!a.parentNode||"label"!==a.tagName.toLowerCase()&&!a.className.startsWith(this.n8g))return!1;
a=this.R9f(a);a=document.getElementById(this.Rgc+a);this.tJc(a);return!0}mzl(a,b){1===a&&(a=Number.parseInvariant(b.selectedOption.toString()),this.ezf(this.vyc[a]))}izl(a){a=a.nc.keyCode;if(a!==Sys.UI.Key.down&&a!==Sys.UI.Key.right&&a!==Sys.UI.Key.up&&a!==Sys.UI.Key.left)return!1;let b=this.R9f(this.h6);const c=this.yMa.length-1;if(a===Sys.UI.Key.down||a===Sys.UI.Key.right)b=b<c?b+1:0;else if(a===Sys.UI.Key.up||a===Sys.UI.Key.left)b=0<b?b-1:c;a=document.getElementById(this.Rgc+b);this.tJc(a);return!0}MM(a){return a.eventName===
ra.a.ol&&a.nc.keyCode===Sys.UI.Key.enter?(super.MM(a),!0):!1}tJc(a){a&&(a.checked=!0,this.Wn.ye&&this.Wn.ye.name===this.kK||this.Wn.vf(this.kK),this.Wn.Mk().gj.aE(a),a.focus(),this.h6&&Sys.UI.DomElement.removeCssClass(this.h6.parentNode,this.sBe),Sys.UI.DomElement.addCssClass(a.parentNode,this.sBe),this.soc=a)}R9f(a){return Number.parseInvariant(Ja.a.substr(a.id,a.id.length-1,1))}AF(){super.AF();const a=document.getElementById(this.ki("WACDialogPanel"));a.style.minWidth=String.format("{0}px",200);
a.style.width=String.format("{0}px",200)}oci(){let a="";for(let b=0;b<this.yMa.length;b++)a+=Th.a.tA(Tx.jzl,b.toString(),this.yMa[b],this.tBe);return a}dispose(){this.Ea&&(this.Rm&&this.QRb&&this.Rm.zb(ra.a.click,this.Ea,this.QRb),this.Kg&&this.RRb&&this.Kg.zb(ra.a.Rf,this.Ea,this.RRb));this.Rm&&this.sc&&this.Kg.zb(ra.a.ol,this.sc,Object(C.a)(this,this.MM,"dialogDefaultEnterKeyHandler"));super.dispose()}}Tx.jzl=lA.kzl;Object(e.a)(Tx,"ZoomDialog",Th.a,[272]);class gF{constructor(){this.wf=null}create(a,
b,c,f){return this.wf=new Tx(a,b,c,f)}}Object(e.a)(gF,"ZoomDialogFactory",null,[258]);class hF{constructor(){this.Ea=null}get name(){return"Common.App.Zoom"}init(){}dispose(){}Yb(a){this.Ea=a;this.Ea.register(gF,"Common.App.Zoom.ZoomDialogFactory").as("Common.App.Zoom.IZoomDialogFactory").na(()=>new gF).ma()}static main(){m.a.instance.Ec(new hF)}}Object(e.a)(hF,"ZoomPackage",null,[2,3]);class RO{constructor(a,b,c,f,l,w,F,S){this.p8j=[ResourceStrings.L_ZoomDialogFit,"400%","200%","150%","100%","66%",
"50%","33%"];this.l4c="fittowindow 4 2 1.5 1 0.66 0.5 0.33".split(" ");this.wf=null;this.ia=a;this.Ga=b;this.qc=l;this.Xi=c;this.Rb=f;this.nm=w;this.K1j=F;this.PBg=S}wb(){this.ia.ra(aa.a.l8g,$b.a.application,Object(C.a)(this,this.mBk,"queryZoom"),96);this.ia.ya(aa.a.hok,$b.a.application,Object(C.a)(this,this.Xnj,"handleZoomConfig"));this.ia.ya(aa.a.eUe,$b.a.application,Object(C.a)(this,this.Ynj,"handleZoomToFit"));this.ia.ya(G.a.Tnc,de.a.frame,Object(C.a)(this,this.vDh,"zoomDialogTabFocusHandler"));
this.ia.ya(G.a.Snc,de.a.frame,Object(C.a)(this,this.vDh,"zoomDialogTabFocusHandler"));u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&(this.ia.ya(G.a.MWb,de.a.frame,Object(C.a)(this,this.MWb,"decreaseZoom")),this.ia.ya(G.a.j2b,de.a.frame,Object(C.a)(this,this.j2b,"increaseZoom")),this.ia.ya(G.a.ozl,de.a.frame,Object(C.a)(this,this.rnk,"onZoomToPercentage")),this.ia.ra(G.a.nBk,de.a.frame,Object(C.a)(this,this.skk,"onQueryZoomPercentage"),96),qd.a("ZoomShortCutsEnabled")&&(this.ia.ya(D.a.RSf,
de.a.frame,Le.ActionManager.Dg),this.ia.ya(D.a.QSf,de.a.frame,Le.ActionManager.Dg)))}Fe(){if(u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&qd.a("ZoomShortCutsEnabled")){const a=this.Ga.Bc(Xd.a.kj);a.bindAction(A.KeyInputManager.La(x.a.lmd,A.KeyInputManager.He),G.a.j2b);a.bindAction(A.KeyInputManager.La(x.a.omd,A.KeyInputManager.He),G.a.j2b);a.bindAction(A.KeyInputManager.La(x.a.mmd,A.KeyInputManager.He),G.a.MWb);a.bindAction(A.KeyInputManager.La(x.a.Bnc,A.KeyInputManager.He),G.a.MWb);this.PBg&&
ia.a.instance.pb(ra.a.WAb,this.PBg,Object(C.a)(this,this.T5h,"adjustZoomOnMouseWheel"))}}T5h(a){return a?a.LY?(0<a.NCh?this.sJa(this.KTg):0>a.NCh&&this.sJa(this.LTg),!0):!1:!1}get TPd(){return Math.round(100*this.Xi.DT)}get LTg(){return Math.floor(this.TPd/10)/10+.1}get KTg(){return Math.ceil(this.TPd/10)/10-.1}mBk(a,b,c,f,l){if(!l)return 8;l[fE.a.LabelText]=Math.round(100*this.Xi.DT)+"%";this.nm&&(this.nm.Rua(this.nm.nYa,this.nm.wDh),this.nm.Qua(this.nm.nYa,this.nm.wDh));return 32}Xnj(a,b,c,f,l){if(1===
c)return this.qc.wj()?32:8;if(!l)return 8;this.wf=new Tx(this.p8j,this.l4c,Object(C.a)(this,this.Vmd,"zoomSettingAction"),v.FocusManager.instance(),this.K1j);this.wf.Cph(CommonUIStrings.l_ZoomDialogTitle,this.Xi.Lia?this.l4c[0]:this.Xi.DT.toString());return 32}Vmd(a){if(a!==this.l4c[0]){const b=parseFloat(a);if(isNaN(b)){za.a.J(8956061,827,10,"Invalid Zoom Value: {0}",a);return}this.Xi.Lia=!1;this.Xi.DT=b;this.Xi.Ihb=2}else this.Xi.Lia=!0;this.Rb.Mq();za.a.J(8956063,827,50,"Succeeded to Zoom: {0}",
a)}Ynj(a,b,c,f,l){if(1===c)return this.qc.wj()?32:8;if(!l)return 8;this.Vmd(this.l4c[0]);return 32}vDh(a){if(!this.wf)return 8;var b=this.wf.Wn.Mk().gj.QY;if(b===this.wf.wv&&a===G.a.Tnc||b===this.wf.AC&&a===G.a.Snc)this.wf.h6||this.wf.yWk(),this.wf.Wn.Mk().gj.aE(this.wf.h6);else if(b.id.startsWith(this.wf.Rgc)||b.className.startsWith(this.wf.n8g))b=null,a===G.a.Tnc?b=this.wf.AC:a===G.a.Snc&&(b=this.wf.wv),this.wf.Wn.Mk().gj.aE(b),Sys.UI.DomElement.removeCssClass(this.wf.h6.parentNode,this.wf.sBe);
else if(a===G.a.Tnc)this.wf.Wn.Mk().ZAb();else if(a===G.a.Snc)this.wf.Wn.Mk().XAb();else return 16;return 32}j2b(a,b,c){if(1===c)return 32;this.sJa(this.LTg);za.a.J(541893711,827,50,"Increase Zoom triggered via ZoomIn");return 32}MWb(a,b,c){if(1===c)return 32;this.sJa(this.KTg);za.a.J(541893712,827,50,"Decrease Zoom triggered via ZoomOut");return 32}rnk(a,b,c,f,l){if(1===c)return 32;a=l.value/100;this.sJa(a);za.a.J(541893713,827,50,"Zoom changed via zoom slider: {0}",a);f&&(f.qP=Math.floor(100*a));
return 32}skk(a,b,c,f,l){l.MinValue=10;l.MaxValue=400;l.value=this.TPd;return 32}sJa(a){.1>a?a=.1:4<a&&(a=4);this.Xi.Lia=!1;this.Xi.DT=a;this.Xi.Ihb=2;this.Rb.Mq()}}Object(e.a)(RO,"ZoomActor",null,[234]);class iF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Zoom"}Yb(a){this.K=a}init(){var a=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),b=a.G9g;const c=this.K.resolve("PowerPointWebEditor.AppFrame"),f=this.K.resolve("Common.IActionManagerExtended"),l=this.K.resolve("PowerPointWebEditor.IFocusManager");
a=a.yic;b=new RO(f,l,this.K.resolve("PowerPointWebEditor.IZoomContext"),c,this.K.resolve("PowerPointWebEditor.IPresentationReader"),a?this.K.resolve("PowerPointWebEditor.IPPTRumTracker"):null,b,c.wHd);b.wb();b.Fe()}dispose(){}static main(){m.a.instance.Ec(new iF)}}Object(e.a)(iF,"PPTWebEditorZoomPackage",null,[2,3]);Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4Im");Type.registerNamespace("B4LE");Type.registerNamespace("B4OLE");
Type.registerNamespace("B4Proofing");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TM");Type.registerNamespace("B4TaE");Type.registerNamespace("B4TaVE");Type.registerNamespace("B4UI");Type.registerNamespace("B4UndoRedo");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.ContentEditable");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");
Type.registerNamespace("Box4.ParagraphRenderElements");Type.registerNamespace("Box4.Shortcuts");Type.registerNamespace("Box4.WordPrediction");Type.registerNamespace("Box4.WordPrediction.Telemetry");Type.registerNamespace("ColorPickerManager");Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Aria");
Type.registerNamespace("PowerPointWebEditor.Assistance");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.AutoFit");Type.registerNamespace("PowerPointWebEditor.CoreExt");Type.registerNamespace("PowerPointWebEditor.DragDrop");Type.registerNamespace("PowerPointWebEditor.DynamicScriptLoader");Type.registerNamespace("PowerPointWebEditor.ErrorHandling");Type.registerNamespace("PowerPointWebEditor.EventTiming");Type.registerNamespace("PowerPointWebEditor.Fonts");
Type.registerNamespace("PowerPointWebEditor.GraphEditor");Type.registerNamespace("PowerPointWebEditor.GraphMerge");Type.registerNamespace("PowerPointWebEditor.HtmlExport");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.ModernFontPicker");Type.registerNamespace("PowerPointWebEditor.Notes");Type.registerNamespace("PowerPointWebEditor.Paragraph");Type.registerNamespace("PowerPointWebEditor.PodsPops");Type.registerNamespace("PowerPointWebEditor.PowerPointFeedback");
Type.registerNamespace("PowerPointWebEditor.PresenterView");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.Proofing.CloudAL");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.Ribbon");Type.registerNamespace("PowerPointWebEditor.Ruler");Type.registerNamespace("PowerPointWebEditor.ShapeEdit");Type.registerNamespace("PowerPointWebEditor.ShapeManipulation");Type.registerNamespace("PowerPointWebEditor.SlideShow");
Type.registerNamespace("PowerPointWebEditor.SmartArt");Type.registerNamespace("PowerPointWebEditor.SmartGuide");Type.registerNamespace("PowerPointWebEditor.Storage");Type.registerNamespace("PowerPointWebEditor.Table");Type.registerNamespace("PowerPointWebEditor.TableStyleEditor");Type.registerNamespace("PowerPointWebEditor.Telemetry");Type.registerNamespace("PowerPointWebEditor.TextEditing");Type.registerNamespace("PowerPointWebEditor.TextFormatting");Type.registerNamespace("PowerPointWebEditor.UI");
Type.registerNamespace("PowerPointWebEditor.UndoRedo");Type.registerNamespace("PowerPointWebEditor.UnifiedApp");Type.registerNamespace("PowerPointWebEditor.ViewEventHandler");Type.registerNamespace("PowerPointWebEditor.WebSocketFrontDoor");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("TableCellMargin");Type.registerNamespace("PowerPointWebEditor.Zoom");window.g_hermesExtJS=Date.now();M.main();ea.main();xf.main();xb.main();ek.main();ln.main();m.a.instance.Ec(new Lj);Wa.main();
qo.main();Bn.main();Tn.main();cp.main();Zn.main();ao.main();Dp.main();fp.main();ui.main();ir.main();zo.main();Type.registerNamespace("Common.App.AccountSwitching");Ao.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("CommonUI");Type.registerNamespace("Common.App.HostNotification");Np.main();Type.registerNamespace("Common");qu.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");su.main();Type.registerNamespace("Common.App.ImageProcessor");
Type.registerNamespace("Common.App.NewAndOpen.Core");m.a.instance.Ec(new Qv);Type.registerNamespace("Common");Type.registerNamespace("Common.App.People");Sv.main();Eu.main();pt.main();Type.registerNamespace("Common.App.People");xr.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");window.MSOJS=hq;mi.main();Type.registerNamespace("Common");m.a.instance.Ec(new sn);Type.registerNamespace("CAUI");Ar.main();Type.registerNamespace("Common.App.SaveStatus");m.a.instance.Ec(new kF);
Type.registerNamespace("Fdbk");Type.registerNamespace("Common.App.CustomerFeedback");d(1094).CustomerFeedbackPackage.main();Type.registerNamespace("Common.App.Zoom");hF.main();window.PPTUserInitiatedSurveysDictionary_FromAppPackage={PPTIdeasSurvey:{campaignId:"00832D36-A8AF-4883-B8C2-7FD77D1E3829",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your slides?",
ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"},PPTRehearsePresentationSurvey:{campaignId:"2c3d6424-b363-4328-8dec-a07edda7a808",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall, how do you feel while using Presenter Coach?",
ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Presenter Coach"},TellMeSurvey:{campaignId:"e55e81b0-5645-4111-b08e-18d7cdaf2bef",commentQuestion:"Please tell us more. Why did you choose that answer?",isZeroBased:!1,promptQuestion:"We have two questions for you.",promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"How satisfied are you with using Microsoft Search in PowerPoint?",
ratingValuesAscending:["Very dissatisfied","Dissatisfied ","Neutral","Satisfied","Very satisfied"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We'd love your feedback on Microsoft Search in PowerPoint"}};sA.main();Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.React");tA.main();BA.main();DA.main();EA.main();FA.main();GA.main();LA.main();MA.main();UA.main();window.PowerPointEditingJewelRibbonData=
{name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"PptJewel",DefaultSelection:"PptJewel.Open",TextDirection:"STR@L_TextDirection",LabelText:"STR@L_JewelText",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptJewel.PrimaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.PrimaryMenu.Controls"},children:[{name:"Button",
attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@prt2@CloseFileMenuPowerPoint_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Info",LabelText:"STR@L_Info",Command:"0x2F9A3D80",Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Info.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"MenuFileName",Title:"STR@L_Info",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblBreadcrumbDocName",
QueryCommand:"0xE55B9734",LabelText:""}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Info.OpenInClient",LabelText:"STR@L_OpenInPowerPoint",Description:"STR@L_OpenInPowerPointDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInPowerPointKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.VersionHistory",LabelText:"STR@L_FileHistory",
Description:"STR@L_FileHistoryDescription",Image48by48:"IMGMAP@prt2@History_48x48x32",Command:"0x1BD57F1B",Keytip:"STR@l_FileVersionKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.FileVersion",LabelText:"STR@L_FileVersion",Description:"STR@L_FileVersionDescription",Image48by48:"IMGMAP@prt2@Versions_48x48x32",Command:"0xFF30AFCC",Keytip:"STR@l_FileVersionKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.New",LabelText:"STR@L_New",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",
AllowDefaultContent:"true",PopulateQueryCommand:"0x7BA0BBA5",Keytip:"STR@l_NewKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelNew"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingNew",DisplayMode:"MenuLoading",Title:"STR@L_New"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblNewButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Open",LabelText:"STR@L_Open",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",
PopulateQueryCommand:"0xA6D756C7",Keytip:"STR@l_OpenKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelOpen"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingMru",DisplayMode:"MenuLoading",Title:"STR@L_Open"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblMruButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Rename",LabelText:"STR@L_RenameButtonTitle",Command:"0x2F9A3D80",Keytip:"STR@l_RenameButtonTitleKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Rename.Menu"},
children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_RenameButtonTitle"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Rename.RenameDialog",LabelText:"STR@L_RenameButtonTitle",Description:"STR@L_RenameButtonDescription",Image48by48:"IMGMAP@prt2@RenameColumn_48x48x32",Command:"0x8E08F41F",Keytip:"STR@l_RenameButtonTitleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.SaveACopy",LabelText:"STR@L_SaveACopy",Command:"0x2F9A3D80",Keytip:"STR@l_SaveAsKeytip"},
children:[{name:"Menu",attrs:{Id:"PptJewel.SaveACopy.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_SaveACopy"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveACopy",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveAsButtonDescription",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0x72B6A68C",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveAsToHost",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",
Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xB8A8271F",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveToSharePoint",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xBAA2DFAC",Keytip:"STR@l_SaveAsKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"SaveAsInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuSaveButton"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"PptJewel.SaveACopy.WheresTheSaveButton",LabelText:"STR@L_WheresTheSaveButton",Description:"STR@L_WheresTheSaveButtonDescription"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Print",LabelText:"STR@L_Print",Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Print.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Print.PrintToPdf",
LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@prt2@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintFullSlide",LabelText:"STR@L_PrintFullSlide",Description:"STR@L_PrintFullSlideDescription",Image48by48:"IMGMAP@prt2@HandoutsLandscapeSlides_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintNotes",LabelText:"STR@L_PrintNotes",Description:"STR@L_PrintNotesDescription",
Image48by48:"IMGMAP@prt2@HandoutsPortraitNotesLandscapePaper_48x48x32",Command:"0x108EE012",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintHandouts",LabelText:"STR@L_PrintHandouts",Description:"STR@L_PrintHandoutsDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitOnPortrait3_48x48x32",Command:"0x866D929F",Keytip:"STR@l_PrintToPdfKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Share",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},
children:[{name:"Menu",attrs:{Id:"PptJewel.Share.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Share.ShareWithPeople",LabelText:"STR@L_ShareWithPeople",Description:"STR@L_ShareWithPeopleDescription",Image48by48:"IMGMAP@prt2@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.Embed",LabelText:"STR@L_Embed",Description:"STR@L_EmbedDescription",
Image48by48:"IMGMAP@prt2@EmbedDocument15_48x48x32",Command:"0x3A7B8B90",Keytip:"STR@l_EmbedKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.ReplyWithChanges",LabelText:"STR@L_ReplyWithChanges",Description:"STR@L_ReplyWithChangesDescription",Image48by48:"IMGMAP@prt2@SendAsLink_48x48x32",Command:"0x4759B1F9",Keytip:"STR@l_ReplyWithChangesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.DownloadAs",LabelText:"STR@L_DownloadAs",Command:"0x2F9A3D80",Keytip:"STR@l_DownloadAsKeytip"},children:[{name:"Menu",
attrs:{Id:"PptJewel.DownloadAs.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DownloadAs"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopy",LabelText:"STR@L_DownloadCopy",Description:"STR@L_DownloadCopyDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointPptx_48x48x32",Command:"0xD3EF8F78",Keytip:"STR@l_DownloadCopyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsPdf",LabelText:"STR@L_DownloadAsPdf",
Description:"STR@L_DownloadCopyAsPdfDescription",Image48by48:"IMGMAP@prt2@PDF_file_48x48x32",Command:"0x91656D12",Keytip:"STR@l_DownloadAsPDFKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsOdp",LabelText:"STR@L_DownloadAsOdp",Description:"STR@L_DownloadCopyAsOdpDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointOdp_48x48x32",Command:"0x4A7CCC65",Keytip:"STR@l_DownloadAsOdpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadAsImages",LabelText:"STR@L_DownloadAsImages",
Description:"STR@L_DownloadAsImagesDescription",Image48by48:"IMGMAP@prt2@Downloadasimage_48x48x32",Command:"0x47057070",Keytip:"STR@l_DownloadAsImagesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.About",LabelText:"STR@L_AboutOffice",Command:"0x2F9A3D80",Keytip:"STR@l_AboutOfficeKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.About.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_AboutOffice"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"PptJewel.About.TryOffice",LabelText:"STR@L_TryOffice",Description:"STR@L_TryOfficeDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x69B75DF3",Keytip:"STR@l_TryOfficeKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.TryMacOffice",LabelText:"STR@L_TryMacOffice",Description:"STR@L_TryMacOfficeDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0xE8879142",Keytip:"STR@l_TryMacOfficeKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.TermsOfUse",LabelText:"STR@L_TermsOfUse",
Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.Privacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.TrustCenter",LabelText:"STR@L_TrustCenter",Description:"STR@L_TrustCenterDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",
Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.ThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.About.DiagnosticsSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.About.Diagnostics",
LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.SessionId",LabelText:"STR@L_DiagnosticsSessionId",QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.Build",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Help",LabelText:"STR@L_Help",
Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Help.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Help.Help",LabelText:"STR@L_Help",Description:"STR@L_HelpDescription",Image48by48:"IMGMAP@prt2@OfficeAssistant_48x48x32",Command:"0x56B04A51",Keytip:"STR@l_HelpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.GiveFeedback",LabelText:"STR@L_GiveFeedback",
Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@prt2@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.ReportAbuse",LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@prt2@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.SecondaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.SecondaryMenu.Controls"},
children:[{name:"Button",attrs:{Id:"PptJewel.Close",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]}]};BB.main();Type.registerNamespace("Common.App.Insights");m.a.instance.Ec(new SG);Type.registerNamespace("Common.App.Activities");FB.main();Type.registerNamespace("Common.App.ActivityAggregator");KB.main();Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Tq;Type.registerNamespace("Common.App.Assistance");
Type.registerNamespace("Common.App.BrowserInfoLogger");LB.main();Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("CADWLTR");MB.main();Type.registerNamespace("Common.App.EventsCacheManager");NB.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.FloatPane");QB.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");TB.main();wC.main();AC.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("CNT");CC.main();Type.registerNamespace("Common.App.VisibilityManagement");EC.main();Type.registerNamespace("Common.ModernFontPicker");FC.main();GC.main();LC.main();RC.main();UC.main();bD.main();dD.main();jD.main();Az.main();ED.main();GD.main();ID.main();WD.main();XD.main();YD.main();ZD.main();aE.main();jE.main();kE.main();cF.main();fF.main();iF.main()},124:function(J,
V,d){d.d(V,"a",function(){return h});d.d(V,"b",function(){return e});const h=m=>null===m||"undefined"===typeof m||!m.length,e=m=>null===m||"undefined"===typeof m},157:function(J,V,d){d.d(V,"a",function(){return e});d.d(V,"b",function(){return m});var h=d(40);const e=(r,v,A)=>{r=h.a.Nm(r);r.Ya("CommandId",v.toString());try{return A()}finally{r.finish(!0)}},m=(r,v,A,x)=>e(r+v,A,x)},227:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.$zc="AfterValidate";h.autoCorrect="AutoCorrect";
h.V$h="BeforeValidate";h.kBi="CutAction";h.SHi="EditingElementContainerDisconnectingFromView";h.endEditing="EndEditing";h.xQi="FinishingSelectionValidation";h.Gsj="ImeTypingEnd";h.Isj="ImeTypingStart";h.izj="IpMode";h.zx="KeyPress";h.Rf="KeyDown";h.Sck="NotFinishingSelectionValidation";h.Zok="OvertypeEnd";h.apk="OvertypeStart";h.dpk="PaddingChanged";h.P1g="ParagraphContentUpdated";h.jrk="PasteAction";h.S0k="SetMode";h.typingProcess="TypingProcess";h.gmi="ClipboardModeBegin";h.hmi="ClipboardModeEnd";
Object(J.a)(h,"EditEventKeys",null,[])},242:function(J,V,d){d.d(V,"a",function(){return m});var h=d(25),e=d(13);const m=r=>h.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk:Object(e.a)(r.resolve("Common.IDynamicScriptLoaderProvider").gx,r.resolve("Common.IDynamicScriptLoaderProvider").gx.loadScript,"loadScript")},246:function(J,V,d){d.r(V);J=d(0);var h=d(374),e=d(57),m=d(25),r=d(45),v=d(570),A=d(1162),x=d(17);d(1154);var y=d(970),u=d(27),H=d(75),G=d(123),E=d(31),
I=d(39),Q=d(34),D=d(74),Y=d(51),M=d(71),N=d(56),W=d(87);d(406);var K=d(49),ca=d(408);class P{constructor(C,oa,Z,pa,ya){this.Myd=C;this.uVh=Z;this.tVh=oa;this.wKh=pa;this.HPh=ya}VUk(C,oa){oa.WUk(C,this.Myd,this.tVh,this.uVh,this.wKh,this.HPh)}}Object(J.a)(P,"MathPropertyObject",null,[]);var ea=d(30),da=d(121);d.d(V,"Box4PasteSteward",function(){return ia});class ia extends y.a{constructor(C,oa,Z,pa,ya,Ja,Ka,ma=null,ra=null){super(C,Ka,ma,ra);this.Qn=this.c1=null;this.Xna=!1;this.P_a=null;this.Ljb=
-1;this.G0a=0;this.ZCd=new x.a;da.a(4223754,307,N.OutlineElementReader.Tg(C));this.T_a=oa;this.T_a.Gnb(this);this.sE=Z;this.sE.Gnb(this);this.Ktd=pa;this.Eo=ya;this.wOh=Ja;this.Yyd=D.ListReader.$j(this.vb);ia.Pvj();ia.Dvj();ia.twj()}get s7(){return this.c1||(this.c1=e.a.instance.qb("Box4.IInternalLinkManager"))}get $Na(){return this.Qn}get S3a(){return this.Yyd&&!this.sE.Yaa}get g4a(){return 0<this.G0a}get Qu(){return this.Ktd}get dr(){return this.Eo}get GVc(){return this.wOh}get jbi(){return!!m.AFrameworkApplication.fa&&
m.AFrameworkApplication.fa.ka("Box4EnsurePasteFormatOnTextIsEnabled")}reset(){super.reset();this.Qn=this.gYd(!1)}vHd(C){da.a(4223762,307,N.OutlineElementReader.Tg(this.vb)||M.OutlineReader.xt(this.vb));this.$Ab(!1);var oa=new ea.GraphIterator;oa.Pc(this.vb);C=y.a.Lh.Uaa(this.vb,this.QPa(C));this.BAc(oa,!1);da.a(4223763,307,C===this.vb.currentNode);da.a(4223764,307,E.ParagraphReader.Pd(C));-1!==this.Qn.pD&&ia.paragraphEditor.KL(C,this.Qn.pD);if(ia.paragraphEditor.Qu&&!this.UX.Tnh){if(this.Qn.textIndent){let ya;
({Of:pa,returnValue:ya}=ia.e9c(this.Qn.textIndent));var Z=!1;if(ya||!D.ListReader.Y4a){0>ya&&(Z=!0,ya*=-1);var pa=ia.NNd(ya,pa);Z||ia.paragraphEditor.Qu.ifb(C,pa)}}!this.Qn.marginLeft||ia.JK.dTc||D.ListReader.$j(oa)||({Of:oa,returnValue:Z}=ia.e9c(this.Qn.marginLeft),oa=ia.NNd(Z,oa),ia.paragraphEditor.Qu.Ffd(C,1,oa))}(ia.Mf.Zf&&ia.Mf.fy||Q.a.instance.ga(45)&&u.App.WC.oIb)&&C.setValue(I.a.L3b,!0);this.Qn.lineSpacing&&ia.paragraphEditor.c0(C,this.Qn.lineSpacing);this.Qn.paragraph=C;this.Xna=!0}BAc(C,
oa){da.a(8128518,307,!oa);this.xL&&!Q.a.instance.ga(76)&&(0<this.xL&&this.Qu.cGc(C,this.xL),0>this.xL&&this.Qu.Fdb(C,this.xL,0));Q.a.instance.ga(29)&&(this.vb.Pc(C),Y.OutlineElementNavigator.ti(this.vb));!this.S3a||2===u.App.mode&&this.GVc.Hfc?C&&this.dr.ZHe(C,this.g4a):this.dr.tkh(C);this.xL=0}mkd(C){this.ZCd.add(C)}$Ld(){this.xL=0}D_(C,oa=null){da.a(4223772,307,E.ParagraphReader.Pk(this.vb));const Z=this.vb.currentNode;this.Qn.BQe(Z);if(!this.UX.QQe(oa)){m.AFrameworkApplication.Pj("Microsoft.Office.Web.Common.Flighting.IBox4EnsurePasteFormatOnTextSettings");
var pa=Z.Ra.last,ya=K.a.PNa(Z),Ja=!1;this.Xna&&(pa.formatting=this.Qn.A5a.Vd(pa),Q.a.instance.ga(57)&&Z.vu(),this.Xna=!1,Ja=!0);C=this.UX.I2d(C,oa);this.UX.Jma(this.vb.currentNode,this.Qn.Lda,oa);this.characterPropertiesEditor.replaceTextRange(ya,C);this.jbi&&Ja&&(C=Z.qqb(ya.Qa),C.formatting=this.Qn.A5a.Vd(C));Q.a.instance.ga(2)}}Dla(C){this.UX.OSc&&this.UX.VRc(C)?(this.Uz(),this.Vz(C)):(da.a(4223773,307,E.ParagraphReader.Pk(this.vb)),C=K.a.PNa(this.vb.currentNode),this.characterPropertiesEditor.eQc(C,
oa=>new ca.a(oa,ca.a.MFc),H.AParagraphNode.VY))}SVa(){}Cla(C){this.T_a.Cla(C)}Bla(C){this.Qn=C;this.Xna=!0}Vua(C){da.a(4223774,307,E.ParagraphReader.Pk(this.vb));da.a(4223775,307,!this.P_a);da.a(4223776,307,0>this.Ljb);this.P_a=C;this.Ljb=E.ParagraphReader.textLength(this.vb.currentNode)}Uua(){da.a(4223777,307,E.ParagraphReader.Pk(this.vb));da.a(4223778,307,!!this.P_a);da.a(4223779,307,0<=this.Ljb);let C=K.a.createTextRange(this.vb.currentNode,this.Ljb,E.ParagraphReader.textLength(this.vb.currentNode)),
oa="",Z="";this.s7&&({uah:oa,dTi:Z}=this.s7.Bwh(G.HyperlinkReader.bCa(this.P_a),!0)).returnValue&&(this.P_a=oa,Z&&(this.characterPropertiesEditor.replaceTextRange(C,Z),C=K.a.createTextRange(this.vb.currentNode,this.Ljb,E.ParagraphReader.textLength(this.vb.currentNode))));ia.hyperlinkEditor.iha(C,this.P_a,!1);this.Xna=!0;this.P_a=null;this.Ljb=-1}Vz(C){this.vHd(C);this.Qn.zkd(this.vb.currentNode);C&&"P"===C.qT.P1b&&ia.paragraphEditor.fIa(this.vb.currentNode,this.Qn.W8c);this.UX.Jma(this.vb.currentNode,
this.Qn.Lda,C,this.Qn.marginLeft,this.Qn.textIndent)}Uz(){da.a(4223808,307,E.ParagraphReader.Pk(this.vb));ia.hyperlinkEditor.VJi(this.vb.currentNode);Y.OutlineElementNavigator.Ke(this.vb)}NVa(){}MVa(){}$ua(){}HGa(){}Gla(){da.a(4223809,307,N.OutlineElementReader.Tg(this.vb)||M.OutlineReader.xt(this.vb));let C=!1;this.g4a||(C=this.S3a||!0);C||(this.xL+=1);this.G0a++}Ela(){this.G0a--;let C=!1;this.g4a||(C=this.S3a||!0);C||--this.xL}Zua(C){da.a(4223810,307,N.OutlineElementReader.Tg(this.vb)||M.OutlineReader.xt(this.vb));
da.a(4223811,307,0!==C.listStyleType);this.dr.OFb(this.RQj(C))}Fla(){da.a(4223813,307,N.OutlineElementReader.Tg(this.vb));m.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(ia.JK.dTc&&D.ListReader.$j(this.vb)){const C=E.ParagraphReader.Rrb(this.vb.currentNode),oa=this.GVc.C$f(this.vb);this.dr.Ifd(oa,C,null)}}OVa(C){this.T_a.OVa(C)}$W(C){this.sE.$W(C)}XW(){this.sE.XW()}ZW(C){this.sE.ZW(C)}YW(){this.sE.YW()}WW(C){this.sE.WW(C)}VW(){this.sE.VW()}static get paragraphEditor(){return ia.tw||
(ia.tw=e.a.instance.resolve("Box4.IParagraphEditor"))}static get hyperlinkEditor(){return ia.Tm||(ia.Tm=e.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Mf(){return ia.Yc||(ia.Yc=e.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get vHb(){return ia.Evf}static get JK(){return ia.FJ||(ia.FJ=e.a.instance.qb("Box4.List.ListSettings"))}static Pvj(){const C=Q.a.instance.ga(61);ia.OGa[1]=C?W.StyleReader.Jmd:W.StyleReader.lHb;ia.OGa[2]=C?W.StyleReader.Kmd:W.StyleReader.mHb;
ia.OGa[3]=C?W.StyleReader.Lmd:W.StyleReader.nHb;ia.OGa[4]=C?W.StyleReader.Mmd:W.StyleReader.oHb;ia.OGa[5]=C?W.StyleReader.Nmd:W.StyleReader.pHb;ia.OGa[6]=C?W.StyleReader.Omd:W.StyleReader.qHb;ia.OGa[7]=C?null:W.StyleReader.alc}static Dvj(){ia.ica.unspecified=0;ia.ica.defaultUnordered=1;ia.ica.defaultOrdered=1;ia.ica.none=0;ia.ica.disc=1;ia.ica.circle=2;ia.ica.square=3;ia.ica.decimal=1;ia.ica.lowerAlpha=2;ia.ica.lowerRoman=3;ia.ica.upperAlpha=4;ia.ica.upperRoman=5}static twj(){ia.Evf=W.StyleReader.Csb()}static U3a(C){return r.a.substring(C,
4,6)+r.a.substring(C,2,4)+r.a.substring(C,0,2)}static e9c(C){let oa,Z;oa=0;const pa=C.length;Z=parseFloat(r.a.substring(C,0,pa-2));C=r.a.substr(C,pa-2,2);switch(C){case "in":oa=3;break;case "px":oa=7;break;case "cm":oa=1;break;case "pt":oa=5;break;default:h.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",C),Z=0}return{returnValue:Z,Of:oa}}static NNd(C,oa){let Z=0;switch(oa){case 3:Z=v.a.Ora(C);break;case 7:Z=A.a.Qda(C,0);
break;case 1:Z=v.a.iLd(C);break;case 5:Z=v.a.Ora(v.a.S9c(C));break;default:h.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",C,oa)}return Z}}ia.tw=null;ia.Tm=null;ia.Yc=null;ia.OGa=Array(8);ia.ica={};ia.Evf=null;ia.FJ=null;Object(J.a)(ia,"Box4PasteSteward",y.a,[])},259:function(J,V,d){d.d(V,"a",function(){return r});J=d(0);var h=d(374),e=d(25),m=d(33);class r{static L6(){if(0>r.sAc){r.sAc=0;try{const v=e.AFrameworkApplication.fa.Ia("OAuthManagerServiceSettings");
void 0!==v&&null!==v&&""!==v&&(r.appSettings=m.b(v),r.sAc=r.appSettings._Version);h.ULS.sendTraceTag(572298006,3E3,100,"AppSettings: {0}",v)}catch(v){h.ULS.sendTraceTag(572298007,3E3,15,"AppSettings failed to load: {0}",v.message)}}}static GHc(){if(0>r.y4a){e.AFrameworkApplication.fa.Uba&&(r.y4a=0);try{const v=e.AFrameworkApplication.fa.Ia("OAuthManagerDocumentSettings");void 0!==v&&null!==v&&""!==v&&(r.xXb=m.b(v),r.y4a=r.xXb._Version);h.ULS.sendTraceTag(572298008,3E3,100,"DocSettings: {0}",v)}catch(v){h.ULS.sendTraceTag(572298009,
3E3,15,"DocSettings failed to load: {0}",v.message)}}}static get clientVersion(){return 7}static get appVersion(){r.L6();return r.sAc}static get xGi(){r.GHc();return r.y4a}static get nHd(){r.L6();return r.appSettings.AppMapping}static get authority(){r.L6();return r.appSettings.Authority}static get enableConsoleLogging(){r.L6();return r.appSettings.EnableConsoleLogging}static get xti(){r.L6();return 7<=r.appVersion?r.appSettings.CorePFTData:{["IsEnabled"]:!0,["Application"]:"e03a13ee-9730-4cae-8525-47559c8cf18a",
["Endpoint"]:""}}static get l7a(){r.L6();if(4<=r.appVersion){if(!r.f4e&&r.appSettings.HostPageSupportsAuth&&(e.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||e.AFrameworkApplication.fa.ka("IsO365CommercialHost")))try{const v=e.AFrameworkApplication.Rla.toLowerCase(),A=r.appSettings.GetAuthTokenFromParentOriginList;if(void 0!==A&&null!==A)for(const x of A)if((new RegExp("^"+x+"/?$")).test(v)){r.e4e=!0;break}}catch(v){h.ULS.sendTraceTag(570729249,3E3,15,"Failed to validate origin: {0}",v.message)}r.f4e=
!0;return r.e4e}return e.AFrameworkApplication.fa.ka("UiHostSupportsAuthToken")}static get isEnabled(){r.L6();return r.appSettings.IsEnabled}static get Iak(){r.L6();return r.appSettings.MockTokenForAutomation}static get Zze(){r.L6();return r.appSettings.PromiseTimeoutInMs}static get z5k(){r.L6();return r.appSettings.SharedAuthFilePath}static get A5k(){r.L6();return r.appSettings.SharedAuthOrigin}static get huh(){r.L6();return r.appSettings.TeamsSDXEnabledSSOList}static get qxl(){r.L6();return r.appSettings.WacFrameTeamsElectronSSO}static get Rdk(){r.GHc();
return 3<=r.y4a?r.xXb.OAuthLoginHint:null}static get xce(){r.GHc();return 4<=r.y4a?r.xXb.LokiAlternateAuthToken:null}static get FVc(){r.GHc();return 4<=r.y4a?r.xXb.LokiAlternateAuthTokenTTL:-1}}r.sAc=-1;r.appSettings=null;r.y4a=-1;r.xXb=null;r.e4e=!1;r.f4e=!1;Object(J.a)(r,"OAuthManagerSettings",null,[])},262:function(J,V,d){d.r(V);J=d(0);d(374);var h=d(899);d(900);var e=d(25),m=d(96),r=d(57),v=d(35);class A{}Object(J.a)(A,"RibbonUpsellButtonCreator",null,[]);class x extends Sys.EventArgs{constructor(ca){super();
this.Txl=ca}}Object(J.a)(x,"TopRowCreatedEventArgs",Sys.EventArgs,[]);d(375);var y=d(349);d(169);var u=d(133);d(72);var H=d(217),G=d(159),E=d(66);class I{constructor(ca,P){this.cluster=ca;this.mFc=P}}Object(J.a)(I,"ImageInfo",null,[]);class Q{constructor(ca,P,ea,da,ia,C,oa,Z,pa,ya,Ja,Ka,ma,ra,Da=null,va=null){this.id=ca;this.yyc=P;this.Cyc=ea;this.Byc=da;this.Ayc=ia;this.zyc=C;this.Eyc=oa;this.YEd=Z;this.UGb=new I(pa,ya);this.Ahd=new I(Ja,Ka);this.t5c=new I(ma,ra);Da&&va&&new I(Da,va)}}Object(J.a)(Q,
"PeoplesWellBaseSettings",null,[]);class D{constructor(){this.AHf=null}}Object(J.a)(D,"BreadcrumbControls",null,[]);class Y{constructor(ca){this.id=ca}}new Y("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32");Object(J.a)(Y,"ChatButtonSettings",null,[]);class M{constructor(){this.id=this.image=this.label=this.command=null}}Object(J.a)(M,"SkypeButtonInfo",null,[]);class N{constructor(){this.lTe=this.gvh=this.DJd=null}}Object(J.a)(N,"TopRowControls",null,
[]);var W=d(197);d(45);d.d(V,"CuiHelper",function(){return K});class K{constructor(ca,P,ea=null,da,ia=null){this.Cfa=ca;this.$Lh=W.a.hak(P,ia);this.$Lh.push(CommonUIStrings);h.b();K.Da=void 0===ea||null===ea?e.AFrameworkApplication.Va:ea}static get Gpj(){return K.$na||(K.$na=r.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static D7i(ca,P,ea){return new Q(K.txe,v.a.Smi,v.a.BMd,v.a.Vmi,v.a.Umi,v.a.Tmi,v.a.Wmi,v.a.H3a,ca,"per_SingleCollabUserGlyph_16x16x32",P,"per_SingleCollabUserGlyph_32x32x32",
ea,"per_MoreUsersGlyph_16x16x32",null,null)}static QFi(ca){ca.DJd&&(K.PFi(ca.DJd),ca.DJd=null);ca.gvh&&(K.OFi(),ca.gvh=null);ca.lTe&&(K.RFi(ca.lTe),ca.lTe=null);K.Gpj.OCk();let P;({B1b:P}=y.a.AIb(!1)).returnValue&&m.a.$za(P)}static n2b(){e.AFrameworkApplication.Va.processAction(v.a.n2b,2)}static OFi(){e.AFrameworkApplication.VGc&&G.EventHandlerManager.instance.kld(e.AFrameworkApplication.VGc)}static addButton(ca,P,ea,da,ia,C,oa,Z){P=u.a(ca,P,ea,da,null,null,null,C,null,null,void 0,void 0,ia);(ca=
Z.hostControl(ca,P,C))&&oa.appendChild(ca);return ca}static AEc(ca,P,ea){let da;da=document.createElement("span");da.className="BreadcrumbItem";da.id=P;da.innerText=ea;da.setAttribute("dir","auto");ca.appendChild(da);return da}static PFi(ca){ca.AHf&&G.EventHandlerManager.instance.xpl(ca.AHf)}static RFi(ca){H.a.instance.Oyh(E.a.click,ca,K.Rlk,!0)}static Rlk(){e.AFrameworkApplication.iTe?(e.AFrameworkApplication.Ba.Dkc(e.AFrameworkApplication.Ba.jb.Ncg()),e.AFrameworkApplication.iTe=!1):window.top.location=
e.AFrameworkApplication.signInUrl;return!0}static TTc(){return!!e.AFrameworkApplication.Ba&&e.AFrameworkApplication.Ba.jb.TTc}}K.$na=null;K.s5k="ShareServerWhite_20x20x32";K.UTd="ExternalHeaderFullTopBars";K.Lpj="HeaderTopBars";K.EJd="BreadcrumbBrand";K.FJd="BreadcrumbFolder";K.GJd="BreadcrumbTitle";K.J3f="FolderSeparator";K.MOe="sbTellMe";K.VLe="TellMe-SearchBox";K.C0g="btnOpenInClient";K.DJe="btnFileSharing";K.rbl="BasicChat";K.Wcd="btnReplyWithChanges";K.s1f="jbtnGiveFeedback";K.txe="PeoplesWellControl";
K.QXf="EditableBreadcrumbItem";K.Da=null;K.DRe=50;K.Epj=null;Object(J.a)(K,"CuiHelper",null,[666])},298:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.alt="Alt";h.iconColor="IconColor";h.ntb="Image16by16Class";h.Xrj="Image30by30Class";h.wCa="Image32by32Class";h.B4d="Image48by48Class";h.labelText="LabelText";h.jPj="LabelTextUserGeneratedPlaceholderReplacements";h.visible="Visible";h.OT="SourceControlId";h.customTooltip="CustomTooltip";h.Icon="Icon";h.IconSet="IconSet";h.z$g="ReduxActions";
Object(J.a)(h,"SharedControlCommandProperties",null,[])},300:function(J,V,d){J=d(0);var h=d(57),e=d(375),m=d(582),r=d(127),v=d(374),A=d(96),x=d(641),y=d(388),u=d(45),H=d(194),G=d(55),E=d(1069),I=d(25),Q=d(162);class D{constructor(ma,ra){this.cp=ma;this.distance=ra}}Object(J.a)(D,"CpDistanceResult",null,[]);class Y{constructor(){this.qCa=0;this.Ds=null;this.Apb=this.Bpb=this.bOa=this.AAa=0;this.Nlc=this.HDa=this.xIa=null;this.Fvb=this.mba=this.C4c=0;this.OTe=this.eRd=!1;this.DWb=this.qBa=this.kha=
this.P1=this.xfc=0;this.xDh=this.Z2f=this.Nkc=this.$Gb=!1;this.result=null;this.TVb=this.aOd=this.W3a=this.z6=this.Qaa=0;this.Kia=this.vEc=!1;this.lO=null}}Object(J.a)(Y,"CpFromPointState",null,[]);class M{constructor(ma,ra,Da,va,Fa,ka,qa,Ua=null,Ya=0,Va=null){this.qAa=this.cp=this.Qa=0;this.SVb=-1;this.deltaX=this.wQf=Number.MAX_VALUE;this.DVa=0;this.lSa=-Number.MAX_VALUE;this.jSa=-Number.MAX_VALUE;this.nUd=this.sYb=this.Fnb=this.que=!1;this.element=ma;this.point=Da;this.e9a=va;this.yCe=Fa;this.xCe=
ka;this.fpg=qa;this.Tga=Ua;this.l3a=Ya;this.originalText=ra;this.KGa=this.originalText.length;this.Lb=this.KGa-1;this.B3b=4===this.e9a||3===this.e9a;this.lO=Va}}Object(J.a)(M,"CpFromPointElementState",null,[]);var N=d(41);class W{constructor(ma,ra,Da){this.CpBegin=ma;this.CpEnd=ra;this.IsEop=Da}}Object(J.a)(W,"CpFromPointResult",null,[]);class K{constructor(ma,ra,Da){this.LineBounds=ma;this.ClientRects=ra;this.IsRangeMultipleLines=Da}}Object(J.a)(K,"LineCoordinateResult",null,[]);class ca{constructor(ma,
ra,Da,va,Fa,ka){this.tib={};this.mNb=!0;this.iyg=this.suc=this.Swc=this.Flb=this.F1a=null;this.ld=ma;this.hY=ra;this.Ysc=Da?Da.ka("TextFidelityLayoutFixesEnabled"):!1;this.FMh=Da?Da.ka("HyperlinkFirstCharacterSelectionFixIsEnabled"):!1;this.qMh=Da?Da.ka("CharacterBeforeEOPSelectionFixIsEnabled"):!1;(this.nLa=va)||v.ULS.sendTraceTag(21051272,324,10,"_measureBoundsUsingSpansStrategy is null");this.TO=Fa;this.sVh=ka}Qba(){this.mNb=!1}X3a(ma,ra,Da,va=null){this.iyg=[];var Fa=ma.Y4;if(!ma.textLength)return this.Zij(ma,
ra,Da,va);va=Object.assign(new Y,{xIa:Array(Fa.length),HDa:Array(Fa.length),Nlc:Array(Fa.length),eRd:!0,Ds:Fa,lO:va});for(var ka=0;ka<=Fa.length;ka++){va.AAa=0;va.bOa=0;va.Bpb=0;va.Apb=0;va.qCa=0;va.$Gb=!1;va.Nkc=!1;if(ka<Fa.length){if(!this.MPi(ma,va,ka))continue}else{va.Fvb=ka-1;break}if(this.nQi(ra,va,ka))break}if(va.OTe&&va.xfc<ra.y&&ra.y<va.P1)return this.bWk(ma,ra,Da,va);va.result=null;va.Qaa=-1;va.z6=va.qBa;va.W3a=Number.MAX_VALUE;va.aOd=0;va.TVb=0;va.vEc=!1;va.Kia=!1;for(Fa=va.mba;Fa<=va.Fvb;Fa++)if(ka=
this.lQi(ma,ra,Da,Fa,va))return ka;return this.Mhj(ma,ra,Da,va)}Zij(ma,ra,Da,va){const Fa=ma.isRtl;if(!Da)return new W(0,0,!1);ma=this.gNa(ma,va);return!Fa&&ra.x>ma.x+ma.width/2||Fa&&ra.x<ma.x+ma.width/2?new W(-1,-1,!0):new W(0,0,!0)}MPi(ma,ra,Da){if(this.Pji(ra.Ds[Da].htmlElement)||ra.Ds[Da].Xtb)return!1;var va=this.BJd(ra.Ds[Da],ra.lO);ra.xIa[Da]=va;var Fa=va.y;let ka=va.y+va.height;ra.Ds[Da].Srg||ra.Ds[Da].Kia||ra.Ds[Da].E2&&!ra.Ds[Da].uRa?({hTf:Fa,gTf:ka}=this.YCf(ra.Ds[Da].htmlElement,Fa,ka),
ra.AAa=ra.Bpb=Fa,ra.bOa=ra.Apb=ka,ra.HDa[Da]=ka-Fa,ra.Nlc[Da]=ra.HDa[Da]):(this.K8k(ma,Da)?(va=this.it(ma,ra.DWb,void 0,void 0,void 0,ra.lO),Fa=this.n_b(ra.Ds[Da].htmlElement),ma=1<Fa?this.it(ma,ra.DWb+Fa-1,void 0,void 0,void 0,ra.lO):va,ra.AAa=Fa=va.y,ra.bOa=va.y+va.height,ra.Bpb=ma.y,ra.Apb=ma.y+ma.height,ra.HDa[Da]=va.height,ra.Nlc[Da]=va.height):(ma=this.sVh.ldj(ra.Ds[Da].htmlElement),ra.qCa=this.nLa.vbj(ra.Ds[Da].htmlElement,ma),{hTf:Fa,gTf:ka}=this.YCf(ra.Ds[Da].htmlElement,Fa,ka),ra.xDh=1<
Math.abs(va.width-this.u2i(ra.Ds[Da].htmlElement))||1<Math.abs(va.height-this.t2i(ra.Ds[Da].htmlElement)),ra.xDh&&this.hY.instance&&(ma=Math.round(ma*this.hY.instance.Q1),ra.qCa=Math.round(ra.qCa*this.hY.instance.Q1)),ra.AAa=Fa-ra.qCa,ra.bOa=Fa+ma+ra.qCa,ra.Bpb=ka-ma-ra.qCa,ra.Apb=ka+ra.qCa,ra.HDa[Da]=ma+2*ra.qCa,ra.Nlc[Da]=ma),ra.C4c=Math.max(ra.C4c,ra.HDa[Da]));ra.Z2f||(ra.P1=ra.AAa,ra.kha=ra.bOa,ra.Z2f=!0);ra.Nkc=ra.Bpb>(ra.AAa+ra.bOa)/2;Da=ca.Zqa(ra.C4c);this.Ysc&&(Da=this.RGd(ra,Da));ra.$Gb=
this.PAj(ra.P1,ra.kha,Fa,Da);return!0}PAj(ma,ra,Da,va){return ma===ra?Da>ra:Da>=ra-va}RGd(ma,ra){return ra=this.nLa.RGd(!!ma.lO&&ma.lO.Wub,ma.AAa,ma.bOa,ra)}nQi(ma,ra,Da){if(ra.$Gb||ra.Nkc){ra.$Gb?ra.Fvb=Da-1:(ra.P1=Math.min(ra.P1,ra.AAa),ra.kha=Math.max(ra.kha,ra.bOa),ra.Fvb=Da);Array.add(this.iyg,ra.kha);if(ma.y<=ra.kha)return!0;ra.xfc=ra.kha;ra.P1=ra.Bpb;ra.kha=ra.Apb;ra.mba=Da;ra.qBa=ra.DWb;ra.eRd=ra.$Gb;ra.OTe=ra.Nkc;ra.C4c=ra.Ds[Da].Kia||ra.Ds[Da].E2&&!ra.Ds[Da].uRa?0:ra.HDa[Da]}else ra.P1=
Math.min(ra.P1,ra.AAa),ra.kha=Math.max(ra.kha,ra.Apb);ma.y>ra.xfc&&ma.y<ra.P1&&!ra.Ds[ra.mba].Kia&&!ra.Ds[ra.mba].E2&&ra.P1-ra.xfc<ra.Nlc[ra.mba]/2&&(ra.P1=ma.y);ra.DWb+=this.aBi(ra.Ds[Da]);return!1}bWk(ma,ra,Da,va){if(va.Ds[va.mba].E2)return Da?new W(va.qBa,va.qBa,!1):new W(va.qBa,va.qBa+1,!1);if(Da=this.vQf(va.Ds[va.mba].htmlElement,va.xIa[va.mba],ra,va.eRd?4:3,va.xfc,va.P1,va.HDa[va.mba],ma.isRtl,ma.Tga,va.qBa,va.lO))return Da=va.qBa+Da.cp,Da=this.UCf(ma,ra,Da,va.mba,va.qBa,void 0,void 0,va.lO),
new W(Da,Da,!1);this.ld.Vb(x.a.uck,{["Reason"]:m.a.h1f});return null}lQi(ma,ra,Da,va,Fa){if(Fa.Ds[va].Xtb)return null;const ka=Fa.Ds[va].E2,qa=Fa.Ds[va].Kia;let Ua=!1;if(ka){if(Fa.xIa[va].y>=Fa.P1&&(Fa.Ds[va].uRa||Fa.Ds[va].GSc)){var Ya=Fa.xIa[va];const Va=Ya.x+Ya.width/2,ua=Math.abs(ra.x-Va);if(ua<Fa.W3a||!Ya.width&&ua===Fa.W3a)Fa.vEc=!0,Fa.W3a=ua,Fa.Kia=!1,Fa.Qaa=!Da||!ma.isRtl&&ra.x<Va||ma.isRtl&&ra.x>Va?Fa.z6:Fa.z6+1}if(!Fa.Ds[va].uRa&&!Fa.Ds[va].GSc){Ya=Fa.xIa[va];if(!Da&&ra.x>Ya.x&&ra.x<Ya.x+
Ya.width&&!Fa.Ds[va].eFj)return new W(Fa.z6,Fa.z6+1,!1);Fa.result=ra.x<Ya.x+Ya.width/2?new D(ma.isRtl?1:0,Math.max(Ya.x-ra.x,0)):new D(ma.isRtl?0:1,Math.max(ra.x-Ya.x-Ya.width,0))}}else qa?(ma=this.gNa(ma,Fa.lO),Ua=1>ma.width,Fa.result=new D(-1,y.a.FGc(ra,ma))):Fa.result=this.vQf(Fa.Ds[va].htmlElement,Fa.xIa[va],ra,va===Fa.mba&&Fa.OTe?1:va===Fa.Fvb&&!Fa.$Gb&&Fa.Nkc?0:2,Fa.P1,Fa.kha,Fa.HDa[va],ma.isRtl,ma.Tga,Fa.z6,Fa.lO);Fa.result&&(Fa.result.distance<Fa.W3a||Ua&&Fa.result.distance<=Fa.W3a+1)&&(Fa.Qaa=
Fa.result.cp+Fa.z6,Fa.Kia=qa,Fa.W3a=Fa.result.distance,Fa.aOd=Fa.z6,Fa.TVb=va,Fa.vEc=ka);Fa.z6=ka?Fa.z6+1:Fa.z6+this.n_b(Fa.Ds[va].htmlElement);return null}Mhj(ma,ra,Da,va){if(-1===va.Qaa)return this.ld.Vb(x.a.oyj,{["Reason"]:m.a.c1f}),null;const Fa=ma.textLength;if(va.Kia){if(Da)return Da=va.xIa[va.xIa.length-1],!ma.isRtl&&ra.x<Da.x+Da.width/2||ma.isRtl&&ra.x>Da.x+Da.width/2?new W(Fa,Fa,!1):new W(-1,-1,!0);va.Qaa=Fa}va.Qaa>Fa&&(va.Qaa=Fa);!va.vEc&&va.Qaa<Fa&&(va.Qaa=this.UCf(ma,ra,va.Qaa,va.TVb,
va.aOd,va.TVb===va.mba,va.TVb===va.Fvb,va.lO));return new W(va.Qaa,va.Qaa,!1)}UCf(ma,ra,Da,va,Fa,ka=!1,qa=!1,Ua=null){const Ya=ma.isRtl,Va=ma.characterData,ua=ma.textLength;Da=u.a.Hw(Va,Da)?Da-1:Da;const Ca=u.a.YEj(Va,Da)?Da+2:Da+1,Ea=this.it(ma,Da,void 0,void 0,void 0,Ua);ra=ra.x>Ea.x+Ea.width/2;if(Da-Fa===this.n_b(ma.Y4[va].htmlElement)&&ma.Y4.length>va+1&&ma.Y4[va+1].E2)return Da;if(ma.Y4[va].XBj)return++Da;if(ma.Y4[va].WBj)return Da;let wb=null,Oa=!1;0<Da&&(wb=this.it(ma,u.a.Hw(Va,Da-1)?Da-2:
Da-1,void 0,void 0,void 0,Ua),0<Da-Fa?Oa=wb.y+wb.height/2>Ea.y:ka||ma.Y4[va-1].E2||(Oa=!0));ka=null;let ab=!1;if(this.qMh?Ca<=ua:Ca<ua)ka=this.it(ma,Ca,void 0,void 0,void 0,Ua),Ca-Fa<this.n_b(ma.Y4[va].htmlElement)?ab=ka.y+ka.height/2<Ea.y+Ea.height:qa||ma.Y4[va+1].uRa||ma.Y4[va+1].GSc||(ab=!0);Oa&&ab?wb.x<=Ea.x&&ka.x>=Ea.x?ra&&(Da=Ca):wb.x>=Ea.x&&ka.x<=Ea.x?ra||(Da=Ca):wb.x<ka.x?ra||(Da=Ca):ka.x<wb.x&&ra&&(Da=Ca):Oa||(ab?ka.x>=Ea.x&&ra?Da=Ca:ka.x<=Ea.x&&!ra&&(Da=Ca):!u.a.vy(Va.charCodeAt(Da))&&(!Ya&&
ra||Ya&&!ra)&&(Da=Ca));return Da}r2i(ma){return A.a.Ou(ma)}t2i(ma){return ma.offsetHeight}u2i(ma){return ma.offsetWidth}Pji(ma){return!ma.parentNode}n_b(ma){return A.a.V5a(ma)}K8k(ma,ra){ra=ma.Y4[ra];if(ra.E2)return!1;ma=ma.htmlElement;Sys.UI.DomElement.containsCssClass(ma,"Paragraph")||(ma=ma.firstChild);return""!==ma.style.lineHeight&&ma.style.lineHeight!==ra.htmlElement.style.lineHeight}aBi(ma){return ma.E2?1:A.a.V5a(ma.htmlElement)}YCf(ma,ra,Da){Da=new Sys.UI.Bounds(0,ra,0,Da-ra);this.n5h(ma,
[Da]);ra=Da.y;Da=Da.y+Da.height;return{hTf:ra,gTf:Da}}n5h(ma,ra){if(ma=H.a.Nu(ma)){var Da=ma.borderTopWidth,va=Da.indexOf("px");if(-1<va)for(Da=parseInt(Da.substr(0,va)),va=0;va<ra.length;va++)ra[va].y+=Da,ra[va].height-=Da;ma=ma.borderBottomWidth;Da=ma.indexOf("px");if(-1<Da)for(ma=parseInt(ma.substr(0,Da)),Da=0;Da<ra.length;Da++)ra[Da].height-=ma}}vQf(ma,ra,Da,va,Fa,ka,qa,Ua,Ya,Va,ua=null){if(this.QDj(ma))return this.ld.Vb(x.a.CQi,{["Reason"]:m.a.g1f}),new D(0,y.a.FGc(Da,ra));if(this.PDj(ma))return this.ld.Vb(x.a.fJc,
{["Reason"]:m.a.fJc}),null;ma=this.Tui(ma,Da,va,Fa,ka,qa,Ya,Va,ua);if(1>=ma.KGa)return new D(0,y.a.FGc(ma.point,ra));this.rSk(ma);do{if(ma.Qa>ma.Lb)return this.JEb(),this.ld.Vb(x.a.tck,{["Reason"]:m.a.MTg}),null;this.qbk(ma)}while(!ma.que);for(ma.qAa=!Ua&&ma.DVa<ma.point.x||Ua&&ma.DVa>ma.point.x?ma.Lb:ma.Qa;!ma.Fnb&&!this.pai(ma););if(ma.nUd)for(ma.cp=ma.Qa;ma.cp<=ma.Lb&&!this.JQj(ma);ma.cp++);return this.Jki(ma)}Tui(ma,ra,Da,va,Fa,ka,qa,Ua,Ya=null){return new M(ma,this.r2i(ma),ra,Da,va,Fa,ka,qa,
Ua,Ya)}QDj(ma){return!ma.firstChild}PDj(ma){return 3!==ma.firstChild.nodeType}rSk(ma){let ra;if(0===ma.e9a){ma.lSa=ma.yCe;ma.jSa=ma.xCe;for(var Da=40;Da<ma.KGa;Da+=40)if(ra=this.fNa(ma.element,ma.originalText,Da,ma.Tga,ma.l3a,void 0,void 0,ma.lO),ra.height&&ra.y+ra.height/2>ma.jSa){ma.Lb=Da;break}}else if(1===ma.e9a)for(ma.Lb=ma.KGa-1,ma.lSa=ma.yCe,ma.jSa=ma.xCe,Da=ma.KGa-40;0<=Da;Da-=40){if(ra=this.fNa(ma.element,ma.originalText,Da,ma.Tga,ma.l3a,void 0,void 0,ma.lO),ra.height&&ra.y+ra.height/2<ma.lSa){ma.Qa=
Da;break}}else if(2===ma.e9a)ma.Lb=ma.KGa-1,ma.lSa=ma.yCe,ma.jSa=ma.xCe;else if(3===ma.e9a||4===ma.e9a)for(Da=0;Da<ma.KGa+40;Da+=40){const va=Da<ma.KGa?Da:ma.KGa-1;ra=this.fNa(ma.element,ma.originalText,va,ma.Tga,ma.l3a,void 0,void 0,ma.lO);if(ra.height&&(ra.y+ra.height<ma.point.y&&(ma.Qa=va),ra.y>ma.point.y)){ma.Lb=va;break}}}qbk(ma){const ra=Math.floor((ma.Qa+ma.Lb)/2);ma.cp=ra;let Da=this.fNa(ma.element,ma.originalText,ma.cp,ma.Tga,ma.l3a,void 0,void 0,ma.lO);for(;ma.cp<ma.Lb&&!Da.height;)ma.cp++,
Da=this.fNa(ma.element,ma.originalText,ma.cp,ma.Tga,ma.l3a,void 0,void 0,ma.lO);ma.cp!==ma.Lb||Da.height?!ma.B3b&&Da.y+Da.height/2<ma.lSa||ma.B3b&&Da.y+ma.fpg<ma.point.y?ma.Qa=ma.cp+1:!ma.B3b&&Da.y+Da.height/2>ma.jSa||ma.B3b&&Da.y>ma.point.y?ma.Lb=ma.cp-1:Da.x<=ma.point.x&&Da.x+Da.width>=ma.point.x?(ma.Fnb=!0,ma.sYb=!0,ma.que=!0):(ma.que=!0,ma.DVa=Da.x+Da.width/2,ma.SVb=ma.cp,ma.deltaX=Math.abs(ma.DVa-ma.point.x),ma.B3b&&(ma.lSa=Da.y,ma.jSa=Da.y+ma.fpg)):ma.Lb=ra-1}pai(ma){var ra=Math.abs(ma.qAa-
ma.cp);if(ra<ma.wQf)ma.wQf=ra;else return ma.Fnb=!0,ma.nUd=!0;ra=Math.floor((ma.cp+ma.qAa)/2);ra===ma.cp&&(ra=ma.qAa);var Da=this.fNa(ma.element,ma.originalText,ra,ma.Tga,ma.l3a,void 0,void 0,ma.lO);if(0<Da.height&&Da.y+Da.height/2<=ma.lSa||Da.y+Da.height/2>=ma.jSa)ma.qAa=ma.cp<ma.qAa?ra-1:ra+1;else if(Da.x<=ma.point.x&&Da.x+Da.width>=ma.point.x)ma.cp=ra,ma.sYb=!0,ma.Fnb=!0;else{Da=Da.x+Da.width/2;const va=Math.abs(ma.DVa-Da),Fa=Math.abs(ma.DVa-ma.point.x),ka=Math.abs(Da-ma.point.x);ka<ma.deltaX&&
(ma.SVb=ra,ma.deltaX=ka);va+ka===Fa?(ma.cp=ra,ma.DVa=Da):Fa+ka===va?(ma.qAa=ma.cp<ma.qAa?ma.cp+1:ma.cp-1,ma.cp=ra,ma.DVa=Da):va+Fa===ka&&(ma.Fnb=!0,ma.nUd=!0)}ma.qAa===ma.cp&&(ma.Fnb=!0);return!1}JQj(ma){var ra=this.fNa(ma.element,ma.originalText,ma.cp,ma.Tga,ma.l3a,void 0,void 0,ma.lO);if(0<ra.height&&ra.y+ra.height/2<=ma.lSa||ra.y+ra.height/2>=ma.jSa)return!1;if(ra.x<=ma.point.x&&ra.x+ra.width>=ma.point.x)return ma.sYb=!0;ra=Math.abs(ra.x+ra.width/2-ma.point.x);ra<ma.deltaX&&(ma.SVb=ma.cp,ma.deltaX=
ra);return!1}Jki(ma){if(!ma.sYb&&-1===ma.SVb)return this.JEb(),this.ld.Vb(x.a.vck,{["Reason"]:m.a.d1f}),null;ma.sYb?ma.deltaX=0:ma.cp=ma.SVb;u.a.Hw(ma.originalText,ma.cp)&&ma.cp--;this.JEb();return new D(ma.cp,ma.deltaX)}it(ma,ra,Da=!1,va=!1,Fa=!1,ka=null){let qa;ma||v.ULS.sendTraceTag(6870734,315,50,"paragraphElement is null");let Ua=({i:Ea,Ds:qa,z6:Fa,Ybk:ra}=this.cdg(ma,ra,Fa)).returnValue,Ya="";Ya=ma.Tga;ma=A.a.Ou(Ua.htmlElement);let Va=ma.length,ua,Ca=!1;if(!Va)if(ua=Sys.UI.DomElement.getBounds(Ua.htmlElement),
Ca=!0,!ua.height&&Ea<qa.length-1)Ea++,Ua=qa[Ea],ma=Q.b(Ua.htmlElement),Va=ma.length;else if(!Ua.htmlElement.firstChild||Ua.Srg)return this.TO.Jea(ua,ka,()=>Ua.htmlElement.offsetWidth/Ua.htmlElement.offsetHeight);var Ea=!1;!Ca&&ra>=Va&&(ra=Va-1,Ea=!0);if(ua=Ua.E2||!Ua.htmlElement.firstChild||Ua.arg?this.BJd(Ua,ka):this.fNa(Ua.htmlElement,ma,ra,Ya,Fa,Da,va,ka))Ca?ua.width=1:Ea&&(ua.x+=ua.width,ua.width=1);this.JEb();return ua}eCa(ma,ra,Da=!1,va=!0){return this.cdg(ma,ra,Da,va).returnValue}o4b(ma,ra){return ra.y>
ma.y+ma.height-ca.Zqa(ma.height)}cdg(ma,ra,Da=!1,va=!0){let Fa,ka,qa=ma;Fa=ma.Y4;for(ma=ka=0;ma<Fa.length;ma++){if(Fa[ma].Xtb)continue;let Ua;if(Fa[ma].E2){if(!ra){Da||this.eGj(Fa,ma)?qa=Fa[ma]:(qa=Fa[ma-1],ra=Ua=A.a.V5a(qa.htmlElement),ka-=Ua);break}ra--;ka++;continue}Ua=A.a.V5a(Fa[ma].htmlElement);let Ya=!1;if(this.FMh){const Va=Fa[ma].htmlElement,ua=Va.nextSibling;ua&&(Ya=Sys.UI.DomElement.containsCssClass(Va,"EmptyTextRun")&&Sys.UI.DomElement.containsCssClass(ua,"Hyperlink"))}if(ra<Ua||!ra&&va&&
!Ya||ma>=Fa.length-1){qa=Fa[ma];break}else ra-=Ua,ka+=Ua}return{returnValue:qa,i:ma,Ds:Fa,z6:ka,Ybk:ra}}eGj(ma,ra){if(!ra)return!0;const Da=this.Knb(ma[ra-1].htmlElement);ma=this.Knb(ma[ra].htmlElement);return this.o4b(Da,ma)}fNa(ma,ra,Da,va,Fa,ka=!1,qa=!1,Ua=null){let Ya=Da+1;Da||ra.length?u.a.Hw(ra,Da)?Da--:u.a.Hw(ra,Ya)&&Ya++:Ya=0;if(""!==va)if(va=Fa+Da+"-"+va,this.mNb){if(Fa=this.tib[va],void 0!==Fa&&null!==Fa)return va=this.TO.Jea(Fa,Ua,()=>this.TO.H6f(ma,Da)),va=this.nLa.SGd(Ua,ma,va)}else this.tib=
{},this.mNb=!0;Fa=this.pnc(ma,Da,Ya);ka=ka&&(G.a.rj||G.a.Xn);if(!Fa&&!qa||ka)ra=this.B$j(ma,ra,Da,Ya),Fa||(Fa=ra),ka&&Fa&&(Fa.y=ra.y,Fa.height=ra.height);""!==va&&Fa&&(this.tib[va]=new Sys.UI.Bounds(Fa.x,Fa.y,Fa.width,Fa.height));va=this.TO.Jea(Fa,Ua,()=>this.TO.H6f(ma,Da));return va=this.nLa.SGd(Ua,ma,va)}pnc(ma,ra,Da){let va=null;if(this.n_b(ma)<Da)return null;G.a.XT&&(va=this.A$j(ma,ra,Da));!va&&G.a.rj&&(va=this.C$j(ma,ra,Da));return va}sHf(ma,ra=null){return this.Knb(ma.htmlElement.firstChild,
ra)}BJd(ma,ra=null){return ma.uRa?this.sHf(ma,ra):this.Knb(ma.htmlElement,ra)}Knb(ma,ra=null){var Da=Sys.UI.DomElement.getBounds(ma);Da=this.TO.Jea(Da,ra,()=>ma.offsetWidth/ma.offsetHeight);return Da=this.nLa.SGd(ra,ma,Da)}FY(ma,ra,Da,va,Fa,ka){return ma!==ra.characterData.length||Da?this.ibi(ma,ra,Da,va,Fa,ka):this.hbi(ra)}hbi(ma){const ra=this.gNa(ma);return this.K8f(ra,!ma.isRtl)}ibi(ma,ra,Da,va,Fa,ka){var qa=ra.textLength;if(G.a.uS&&Da&&0<ma&&ma<qa){var Ua=this.eCa(ra,ma-1,!0),Ya=this.eCa(ra,
ma,!0);Ua===Ya&&(Da=!1)}var Va=Da?ma-1:ma;u.a.Hw(ra.characterData,Va)&&--Va;var ua=!0;Ya=this.eCa(ra,Va,!0,!1);if(Ya.E2)if(Ya.uRa){if(Da)return this.FY(ma,ra,!1,va,!1,ka);Ua=this.sHf(Ya)}else if(Ya.GSc){if(Da)return this.FY(ma,ra,!1,va,!1,ka);if(ma)return this.FY(ma,ra,!0,va,!1,ka);Ua=this.BJd(Ya)}else Ua=this.Knb(Ya.htmlElement),Ya.vFj&&(ua=!1);else{Ya=Va;do{Ua=this.it(ra,Ya,Fa,ka);if(!Ua)return null;Ya+=1}while(!Ua.height&&Ya<=qa)}Ya=qa=ra.isRtl;if(ua){ua=this.Vzc(ra,Va,-1,Fa,ka);Fa=this.Vzc(ra,
Va,1,Fa,ka);ka=new Sys.UI.Point(Ua.x+Ua.width/2,Ua.y+Ua.height/2);Va=Ua.y;var Ca=Ua.y+Ua.height;Va=!ua||ua.y+ua.height<=Va;Ca=!Fa||Fa.y>=Ca;let Ea=!1;Va||Ca?Va||u.a.vy(ra.characterData.charCodeAt(ma))?Ca||(Fa.x>=ka.x?Ya=!1:Fa.x<=ka.x&&(Ya=!0),Ea=Ya!==qa):(ua.x<=ka.x?Ya=!1:ua.x>=ka.x&&(Ya=!0),Ea=Ya!==qa):ua.x<=ka.x&&ka.x<=Fa.x?Ya=!1:Fa.x<=ka.x&&ka.x<=ua.x?Ya=!0:ua.x<Fa.x?(Ya=!0,Ea=Da?ka.x<ua.x:ua.x<ka.x):Fa.x<ua.x&&(Ya=!1,Ea=Da?ua.x<ka.x:ka.x<ua.x);if(Ea&&G.a.nD){if(Da&&!va)return this.FY(ma,ra,!1,
!1);ma||(Ua=this.N_i(ra,qa))}}return this.K8f(Ua,Ya===Da)}Vzc(ma,ra,Da,va,Fa){if(0>Da&&0>=ra||0<Da&&ra>=ma.characterData.length-1)return null;const ka=ra+Da;return u.a.Hw(ma.characterData,ka)?this.Vzc(ma,ka,Da,va,Fa):this.eCa(ma,ra,!0,!1).uRa?null:(ra=this.it(ma,ka,va,Fa))?ra.height&&ra.width?ra:this.Vzc(ma,ka,Da,va,Fa):null}N_i(ma,ra){let Da=null;for(var va=0;va<ma.Y4.length;va++){const Fa=ma.Y4[va];if(!Fa.Xtb){Da=Fa.htmlElement;break}}for(va=Da.childNodes[0];va&&1===va.nodeType;)Da=va,va=Da.childNodes[0];
va=A.a.Ou(Da);A.a.Zw(Da,(ra?"\u202e":"\u202d")+va);this.Qba();ma=this.it(ma,0);A.a.Zw(Da,va);this.Qba();return ma}K8f(ma,ra){return new Sys.UI.Bounds(ra?ma.x:ma.x+ma.width,ma.y,0,ma.height)}gNa(ma,ra=null){return this.Knb(ma.c_f.htmlElement,ra)}A$j(ma,ra,Da){this.JEb();try{const va=ma.firstChild,Fa=va.ownerDocument.createRange();Fa.setStart(va,ra);Fa.setEnd(va,Da);const ka=this.y6i(Fa,(qa,Ua)=>(0<qa||ra===Da)&&0<Ua);if(!ka||!ka.length)return null;this.TCf(va,ka[0]);Fa.detach();return ka[0]}catch(va){return null}}y6i(ma,
ra){this.JEb();try{let Da;Da=ma.getClientRects();ma=[];for(let va=0;va<Da.length;va++){const Fa=Da[va];if(Fa){const ka=Math.floor(Fa.width/1),qa=Math.floor(Fa.height/1);if(ra(ka,qa)){const Ua=new Sys.UI.Bounds(Math.floor(Fa.left/1),Math.floor(Fa.top/1),ka,qa);Array.add(ma,Ua)}}}return ma}catch(Da){return null}}C$j(ma,ra,Da){if(!G.a.BHb)return null;let va=null;try{va=ma.ownerDocument.body.createTextRange(),va.moveToElementText(ma)}catch(Fa){return null}if(va.collapse&&va.move&&va.moveEnd)va.collapse(),
va.move("character",ra),va.moveEnd("character",Da-ra);else return null;ra=new Sys.UI.Bounds(va.boundingLeft,va.boundingTop,va.boundingWidth,va.boundingHeight);if(!(ra.x||ra.y||ra.width||ra.height))return null;this.TCf(ma,ra);ma=window.screen.deviceXDPI/window.screen.logicalXDPI;1!==ma&&(ra.x=Math.round(ra.x/ma),ra.y=Math.round(ra.y/ma),ra.width=Math.round(ra.width/ma),ra.height=Math.round(ra.height/ma));return ra}B$j(ma,ra,Da,va){this.F1a&&this.F1a.ownerDocument===ma.ownerDocument||(this.F1a=ma.ownerDocument.createElement("SPAN"),
this.Flb=ma.ownerDocument.createElement("SPAN"),this.Swc=ma.ownerDocument.createElement("SPAN"));ma.firstChild!==this.F1a&&(this.suc=new E.a(ma),A.a.Vt(ma),this.nLa&&this.nLa.lli(this.F1a,this.Flb,this.Swc),ma.appendChild(this.F1a),ma.appendChild(this.Flb),ma.appendChild(this.Swc));A.a.Zw(this.F1a,u.a.substring(ra,0,Da));A.a.Zw(this.Flb,u.a.substring(ra,Da,va));A.a.Zw(this.Swc,u.a.substring(ra,va,ra.length));I.AFrameworkApplication.fa.ka("ChromiumSpanIssueFixIsEnabled")&&G.a.Gj&&G.a.rBj&&" "===u.a.substring(ra,
Da,va)&&Sys.UI.DomElement.addCssClass(this.Flb,"WhiteSpaceSpanElement");return Sys.UI.DomElement.getBounds(this.Flb)}TCf(ma,ra){this.i5h(ma,[ra])}i5h(ma,ra){try{if(void 0!==ma.ownerDocument.parentWindow){var Da=ma.ownerDocument.parentWindow.frameElement;if(Da&&("0"===Da.frameBorder||"no"===Da.frameBorder))for(ma=0;ma<ra.length;ma++)ra[ma].x+=2,ra[ma].y+=2}}catch(va){}}JEb(){this.suc&&this.suc.restore();this.suc=null}Lnb(ma,ra){if(""!==ra){let Da;if(this.mNb){if(Da=this.tib["VE-"+ra])return ma=new Sys.UI.Bounds(Da.x,
Da.y,Da.width,Da.height)}else this.tib={},this.mNb=!0;Da=Sys.UI.DomElement.getBounds(ma);this.tib["VE-"+ra]=Da;return ma=new Sys.UI.Bounds(Da.x,Da.y,Da.width,Da.height)}return Sys.UI.DomElement.getBounds(ma)}static get instance(){return ca.Ka||(ca.Ka=new ca(e.a.instance,h.a.instance.Oa("Common.IZoomManager"),I.AFrameworkApplication.fa,h.a.instance.resolve("Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy"),h.a.instance.resolve("Box4.IRotatingCoordinateConverter"),h.a.instance.resolve("Box4.TextMetricsApi.ITextMetricsHelper")))}static Zqa(ma){return N.SelectionEditor.Zqa(ma)}}
ca.Ka=null;Object(J.a)(ca,"TextMetrics",null,[]);var P=d(97);class ea{get uRa(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.q5b)}get E2(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.AM)}get GSc(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.fpk)}get vFj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.Owj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.Nwj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.Lwj)}get Srg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
P.a.ESd)}get arg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.wPf)}}Object(J.a)(ea,"ATextMetricsElement",null,[281]);var da=d(31),ia=d(148);class C extends ea{constructor(ma){super();this.IO=ma}get htmlElement(){return this.IO}get Kia(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.RM)}get Xtb(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ia.a.QU)}get eFj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.kzj)}get XBj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
P.a.Gai)||Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.Qwj)}get WBj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.Fai)||Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.Pwj)}}Object(J.a)(C,"TextMetricsLeafElement",ea,[300,281]);var oa=d(51),Z=d(56);class pa extends ea{constructor(ma){super();this.Lkb=ma;this.Ei=this.Lkb.gb;this.eRb=Array(ma.Es.length);for(ma=0;ma<this.Lkb.Es.length;ma++){const ra=new C(this.Lkb.Es[ma]);this.eRb[ma]=ra}}get Y4(){return this.eRb}get paragraphId(){return this.Ei.id.toString()}get htmlElement(){return this.Lkb.htmlElement}get Tga(){return this.Lkb.Qc.Jh?
this.Lkb.gb.id.toString():""}get textLength(){return da.ParagraphReader.textLength(this.Ei)}get isRtl(){return Z.OutlineElementReader.Vl(oa.OutlineElementNavigator.uA(this.Ei))}get Ir(){return da.ParagraphReader.Pd(this.Ei)&&!this.Ei.AV}get characterData(){return this.Ei.characterData}get c_f(){return this.eRb.length?this.eRb[this.eRb.length-1]:null}static a4a(ma){return new pa(ma)}}Object(J.a)(pa,"TextMetricsParagraphElement",ea,[280,281]);var ya=d(49),Ja=d(32);d.d(V,"a",function(){return Ka});class Ka{static get RVb(){return Ka.fA||
(Ka.fA=h.a.instance.qb("Box4.CharacterPointConverter"))}static get Uc(){return e.a.instance}static it(ma,ra,Da=!1,va=!1,Fa=!1,ka=null){ma=pa.a4a(ma);return ca.instance.it(ma,ra,Da,va,Fa,ka)}static pnc(ma,ra,Da){return ca.instance.pnc(ma,ra,Da)}static Lnb(ma,ra){return ca.instance.Lnb(ma,ra)}static FY(ma,ra,Da,va,Fa=!1,ka=!1){ra=pa.a4a(ra);return ca.instance.FY(ma,ra,Da,va,Fa,ka)}static gNa(ma,ra=null){ma=pa.a4a(ma);return ca.instance.gNa(ma,ra)}static Qba(){ca.instance.Qba()}static X3a(ma,ra,Da,va=
null){let Fa=null,ka=null;try{const qa=pa.a4a(ma);let Ua=null;Fa=Ka.Uc.zp(Ja.a.wXi);(Ua=ca.instance.X3a(qa,ra,Da,va))&&(ka=Ka.RVb?Ka.RVb.Kzl(Ua,ma.gb):ya.a.MNa(Ua.CpBegin,Ua.CpEnd,Ua.IsEop,ma.gb))}catch(qa){Ka.Uc.Vb(r.a.Uyl,{["Reason"]:m.a.sLi,["ExceptionMessage"]:qa.message,["ExceptionCallstack"]:qa.stack}),ka=null}Fa&&Fa.end();return ka}static eCa(ma,ra,Da=!1,va=!0){ma=pa.a4a(ma);return ca.instance.eCa(ma,ra,Da,va).htmlElement}static o4b(ma,ra){return ca.instance.o4b(ma,ra)}}Ka.fA=null;Object(J.a)(Ka,
"TextMetricsAdapter",null,[])},306:function(J,V,d){J=d(0);var h=d(374),e=d(25),m=d(1181);const r=(A,x)=>{const y={};let u=null;switch(A){case 0:u="HtmlProcessor";var H=x.a;null!=H&&(y.SessionID=H);var G=x.b.toString();null!=G&&(y.Elements=G);var E=x.c.toString();null!=E&&(y.PrunedElements=E);var I=x.d.toString();null!=I&&(y.TransparentElements=I);var Q=x.e.toString();null!=Q&&(y.VoidElements=Q);var D=x.f.toString();null!=D&&(y.UnknownElements=D);break;case 1:u="WordConverter";var Y=x.a;null!=Y&&(y.SessionID=
Y);var M=x.b.toString();null!=M&&(y.BulletsConverted=M);var N=x.c.toString();null!=N&&(y.NumberedConverted=N);break;case 2:u="FormattingSteward";var W=x.a;null!=W&&(y.SourceApp=W);var K=x.b;null!=K&&(y.Browser=K);var ca=x.c;null!=ca&&(y.OperationId=ca);var P=x.d.toString();null!=P&&(y.Lang=P);var ea=x.e.toString();null!=ea&&(y.TextDir=ea);var da=x.f.toString();null!=da&&(y.Bold=da);var ia=x.g.toString();null!=ia&&(y.Math=ia);var C=x.h.toString();null!=C&&(y.Italics=C);var oa=x.i.toString();null!=
oa&&(y.Underline=oa);var Z=x.j.toString();null!=Z&&(y.Strikethrough=Z);var pa=x.k.toString();null!=pa&&(y.Subscript=pa);var ya=x.l.toString();null!=ya&&(y.Superscript=ya);var Ja=x.m.toString();null!=Ja&&(y.Fontsize=Ja);var Ka=x.n.toString();null!=Ka&&(y.Fontface=Ka);var ma=x.o.toString();null!=ma&&(y.GrowFontsize=ma);var ra=x.p.toString();null!=ra&&(y.ShrinkFontsize=ra);var Da=x.q.toString();null!=Da&&(y.FontColor=Da);var va=x.r.toString();null!=va&&(y.FontHighlight=va);var Fa=x.s.toString();null!=
Fa&&(y.ParagraphStyle=Fa);var ka=x.t.toString();null!=ka&&(y.TextAlign=ka);var qa=x.u.toString();null!=qa&&(y.TextIndent=qa);var Ua=x.v.toString();null!=Ua&&(y.MarginLeft=Ua);var Ya=x.w.toString();null!=Ya&&(y.ParagraphSpaceBefore=Ya);var Va=x.x.toString();null!=Va&&(y.ParagraphSpaceAfter=Va);var ua=x.y.toString();null!=ua&&(y.LineSpace=ua);var Ca=x.z.toString();null!=Ca&&(y.CellShadingColor=Ca);break;case 3:u="SemanticEvents";var Ea=x.a;null!=Ea&&(y.SessionID=Ea);var wb=x.b.toString();null!=wb&&
(y.Text=wb);var Oa=x.c.toString();null!=Oa&&(y.LineBreak=Oa);var ab=x.d.toString();null!=ab&&(y.Image=ab);var fb=x.e.toString();null!=fb&&(y.File=fb);var db=x.f.toString();null!=db&&(y.FormattingChange=db);var gc=x.g.toString();null!=gc&&(y.Anchor=gc);var ob=x.h.toString();null!=ob&&(y.Paragraph=ob);var Sb=x.i.toString();null!=Sb&&(y.Math=Sb);var Jb=x.j.toString();null!=Jb&&(y.List=Jb);var Ab=x.k.toString();null!=Ab&&(y.ListItem=Ab);var lc=x.l.toString();null!=lc&&(y.RenderAugmentation=lc);var Mc=
x.m.toString();null!=Mc&&(y.Span=Mc);break;case 4:u="SemanticTableEvents";var Jc=x.a;null!=Jc&&(y.SessionID=Jc);var rb=x.b.toString();null!=rb&&(y.Tables=rb);var cc=x.c.toString();null!=cc&&(y.TableRow=cc);var jb=x.d.toString();null!=jb&&(y.TableCell=jb);var Xb=x.e.toString();null!=Xb&&(y.TablePart=Xb);break;case 5:u="HtmlEvents";var yb=x.a;null!=yb&&(y.OperationId=yb);var mb=x.b;null!=mb&&(y.SourceApp=mb);var Ub=x.c;null!=Ub&&(y.Browser=Ub);var ec=null==x.d?null:x.d.toString();null!=ec&&(y.Text=
ec);var nc=null==x.e?null:x.e.toString();null!=nc&&(y.A=nc);var Lb=null==x.f?null:x.f.toString();null!=Lb&&(y.Abbr=Lb);var Zc=null==x.g?null:x.g.toString();null!=Zc&&(y.Acronym=Zc);var Pb=null==x.h?null:x.h.toString();null!=Pb&&(y.Address=Pb);var eb=null==x.i?null:x.i.toString();null!=eb&&(y.Applet=eb);var $a=null==x.j?null:x.j.toString();null!=$a&&(y.Area=$a);var vb=null==x.k?null:x.k.toString();null!=vb&&(y.B=vb);var bc=null==x.l?null:x.l.toString();null!=bc&&(y.Base=bc);var Cc=null==x.m?null:x.m.toString();
null!=Cc&&(y.Basefont=Cc);var Gc=null==x.n?null:x.n.toString();null!=Gc&&(y.Bdo=Gc);var sd=null==x.o?null:x.o.toString();null!=sd&&(y.Big=sd);var Sd=null==x.p?null:x.p.toString();null!=Sd&&(y.Blockquote=Sd);var ie=null==x.q?null:x.q.toString();null!=ie&&(y.Body=ie);var De=null==x.r?null:x.r.toString();null!=De&&(y.Br=De);var yd=null==x.s?null:x.s.toString();null!=yd&&(y.Button=yd);var ib=null==x.t?null:x.t.toString();null!=ib&&(y.Caption=ib);var dc=null==x.u?null:x.u.toString();null!=dc&&(y.Center=
dc);var Bc=null==x.v?null:x.v.toString();null!=Bc&&(y.Cite=Bc);var Ob=null==x.w?null:x.w.toString();null!=Ob&&(y.Code=Ob);var yc=null==x.x?null:x.x.toString();null!=yc&&(y.Col=yc);var fc=null==x.y?null:x.y.toString();null!=fc&&(y.Colgroup=fc);var Nb=null==x.z?null:x.z.toString();null!=Nb&&(y.Dd=Nb);var lb=null==x.ba?null:x.ba.toString();null!=lb&&(y.Del=lb);var Qc=null==x.bb?null:x.bb.toString();null!=Qc&&(y.Dfn=Qc);var Rc=null==x.bc?null:x.bc.toString();null!=Rc&&(y.Dir=Rc);var ld=null==x.bd?null:
x.bd.toString();null!=ld&&(y.Div=ld);var Dd=null==x.be?null:x.be.toString();null!=Dd&&(y.Dl=Dd);var gd=null==x.bf?null:x.bf.toString();null!=gd&&(y.Dt=gd);var be=null==x.bg?null:x.bg.toString();null!=be&&(y.Em=be);var od=null==x.bh?null:x.bh.toString();null!=od&&(y.Fieldset=od);var $d=null==x.bi?null:x.bi.toString();null!=$d&&(y.Font=$d);var xf=null==x.bj?null:x.bj.toString();null!=xf&&(y.Form=xf);var Na=null==x.bk?null:x.bk.toString();null!=Na&&(y.Frame=Na);var xb=null==x.bl?null:x.bl.toString();
null!=xb&&(y.Frameset=xb);var sc=null==x.bm?null:x.bm.toString();null!=sc&&(y.H=sc);var cd=null==x.bn?null:x.bn.toString();null!=cd&&(y.Head=cd);var Ta=null==x.bo?null:x.bo.toString();null!=Ta&&(y.Hr=Ta);var Hb=null==x.bp?null:x.bp.toString();null!=Hb&&(y.Html=Hb);var oc=null==x.bq?null:x.bq.toString();null!=oc&&(y.I=oc);var Oc=null==x.br?null:x.br.toString();null!=Oc&&(y.Iframe=Oc);var Yc=null==x.bs?null:x.bs.toString();null!=Yc&&(y.Img=Yc);var Qd=null==x.bt?null:x.bt.toString();null!=Qd&&(y.Input=
Qd);var ce=null==x.bu?null:x.bu.toString();null!=ce&&(y.Ins=ce);var id=null==x.bv?null:x.bv.toString();null!=id&&(y.Isindex=id);var gb=null==x.bw?null:x.bw.toString();null!=gb&&(y.Kbd=gb);var pc=null==x.bx?null:x.bx.toString();null!=pc&&(y.Label=pc);var zc=null==x.by?null:x.by.toString();null!=zc&&(y.Legend=zc);var Ic=null==x.bz?null:x.bz.toString();null!=Ic&&(y.Li=Ic);var Fc=null==x.ca?null:x.ca.toString();null!=Fc&&(y.Link=Fc);var rd=null==x.cb?null:x.cb.toString();null!=rd&&(y.Map=rd);var Yd=null==
x.cc?null:x.cc.toString();null!=Yd&&(y.Math=Yd);var me=null==x.cd?null:x.cd.toString();null!=me&&(y.Menu=me);var Db=null==x.ce?null:x.ce.toString();null!=Db&&(y.Meta=Db);var af=null==x.cf?null:x.cf.toString();null!=af&&(y.Noframes=af);var bg=null==x.cg?null:x.cg.toString();null!=bg&&(y.Noscript=bg);var Qe=null==x.ch?null:x.ch.toString();null!=Qe&&(y.Object=Qe);var Af=null==x.ci?null:x.ci.toString();null!=Af&&(y.Ol=Af);var tf=null==x.cj?null:x.cj.toString();null!=tf&&(y.Optgroup=tf);var uf=null==x.ck?
null:x.ck.toString();null!=uf&&(y.Option=uf);var kg=null==x.cl?null:x.cl.toString();null!=kg&&(y.P=kg);var Lg=null==x.cm?null:x.cm.toString();null!=Lg&&(y.Param=Lg);var $g=null==x.cn?null:x.cn.toString();null!=$g&&(y.Pre=$g);var yf=null==x.co?null:x.co.toString();null!=yf&&(y.Q=yf);var Kf=null==x.cp?null:x.cp.toString();null!=Kf&&(y.S=Kf);var dd=null==x.cq?null:x.cq.toString();null!=dd&&(y.Samp=dd);var lg=null==x.cr?null:x.cr.toString();null!=lg&&(y.Script=lg);var Wh=null==x.cs?null:x.cs.toString();
null!=Wh&&(y.Select=Wh);var Gd=null==x.ct?null:x.ct.toString();null!=Gd&&(y.Small=Gd);var Se=null==x.cu?null:x.cu.toString();null!=Se&&(y.Span=Se);var hj=null==x.cv?null:x.cv.toString();null!=hj&&(y.Strike=hj);var cg=null==x.cw?null:x.cw.toString();null!=cg&&(y.Strong=cg);var ed=null==x.cx?null:x.cx.toString();null!=ed&&(y.Style=ed);var Xg=null==x.cy?null:x.cy.toString();null!=Xg&&(y.Sub=Xg);var Dh=null==x.cz?null:x.cz.toString();null!=Dh&&(y.Sup=Dh);var Qf=null==x.da?null:x.da.toString();null!=Qf&&
(y.Tables=Qf);var Yb=null==x.db?null:x.db.toString();null!=Yb&&(y.Tbody=Yb);var li=null==x.dc?null:x.dc.toString();null!=li&&(y.Td=li);var re=null==x.dd?null:x.dd.toString();null!=re&&(y.Textarea=re);var lf=null==x.de?null:x.de.toString();null!=lf&&(y.Tfoot=lf);var Id=null==x.df?null:x.df.toString();null!=Id&&(y.Th=Id);var We=null==x.dg?null:x.dg.toString();null!=We&&(y.Thead=We);var Wc=null==x.dh?null:x.dh.toString();null!=Wc&&(y.Title=Wc);var Xc=null==x.di?null:x.di.toString();null!=Xc&&(y.Tr=Xc);
var Ld=null==x.dj?null:x.dj.toString();null!=Ld&&(y.Tt=Ld);var Xf=null==x.dk?null:x.dk.toString();null!=Xf&&(y.U=Xf);var Le=null==x.dl?null:x.dl.toString();null!=Le&&(y.Ul=Le);var md=null==x.dm?null:x.dm.toString();null!=md&&(y.Var=md);var oj=null==x.dn?null:x.dn.toString();null!=oj&&(y.Unknown=oj);break;case 6:u="List";var Ie=x.a;null!=Ie&&(y.SessionID=Ie);var qh=x.b.toString();null!=qh&&(y.MaxListLevel=qh)}y.Table=u;return Sys.Serialization.JavaScriptSerializer.serialize(y)};d.d(V,"a",function(){return v});
class v{static get F7(){null==v.h0a&&(v.h0a=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("UsageEditorLoggingIsDisabled"));return v.h0a}static get Jtg(){null==v.Mud&&(v.Mud=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("WordUsageEditorLoggingIsEnabled"));return v.Mud}static ZP(A){h.ULS.sendTraceTag(5822145,307,50,A)}static F9f(A){const x={};x.a=A;x.b=0;x.c=0;x.d=0;x.e=0;x.f=0;return x}static iUj(A){v.F7||v.ZP(r(0,A))}static Q1d(A){const x={};x.a=A;x.b=0;x.c=0;return x}static gWj(A){v.F7||
v.ZP(r(1,A))}static E9f(A,x){const y={};y.c=m.a[A];y.a=x;return y}static hUj(A,x){v.Jtg&&A&&(A.b=x,v.ZP(r(5,A)))}static tcg(A){const x={};x.a=A;x.b=0;x.c=0;x.d=0;x.e=0;x.f=0;x.g=0;x.h=0;x.i=0;x.j=0;x.k=0;x.l=0;x.m=0;return x}static tVj(A){v.F7||v.ZP(r(3,A))}static ucg(A){const x={};x.a=A;x.b=0;x.c=0;x.d=0;x.e=0;return x}static uVj(A){v.F7||v.ZP(r(4,A))}static RYd(A,x){const y={};y.b=m.a[A];y.c=x;y.d=0;y.e=0;y.f=0;y.g=0;y.h=0;y.i=0;y.j=0;y.k=0;y.l=0;y.m=0;y.n=0;y.o=0;y.p=0;y.q=0;y.r=0;y.s=0;y.t=0;
y.w=0;y.x=0;y.y=0;y.z=0;y.u=0;y.v=0;return y}static XTj(A,x){v.Jtg&&A&&(A.a=x,v.ZP(r(2,A)))}static v4i(A){const x={};x.a=A;x.b=-1;return x}static BUj(A){!v.F7&&A&&0<=A.b&&v.ZP(r(6,A))}}v.h0a=null;v.Mud=null;Object(J.a)(v,"UsageEditor",null,[])},318:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.w$=1E5;Object(J.a)(h,"ViewConstants",null,[])},319:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ge=this.Tf=this.ae=this.Lf=0}fNi(e){return e.ge<this.Tf&&
this.ge<e.Tf&&e.ae<this.Lf&&this.ae<e.Lf}Dqb(e){return e.ge>=this.ge&&e.Tf<=this.Tf&&e.ae>=this.ae&&e.Lf<=this.Lf}XMi(e,m){return e>=this.V2f&&e<=this.Zae&&m>=this.O2f&&m<=this.Rae}YOa(){return 0>=this.dO||0>=this.xQ}equals(e){return e.ge===this.ge&&e.Tf===this.Tf&&e.ae===this.ae&&e.Lf===this.Lf}clone(){return Object.assign(new h,{ge:this.ge,Tf:this.Tf,ae:this.ae,Lf:this.Lf})}toString(){return String.format("CellRange, rowFirst:{0}, rowLim:{1}, colFirst:{2}, colLim:{3}",this.ge,this.Tf,this.ae,this.Lf)}get dO(){return this.Tf-
this.ge}get xQ(){return this.Lf-this.ae}get Zae(){return this.Tf-1}get Rae(){return this.Lf-1}get V2f(){return this.ge}get O2f(){return this.ae}}Object(J.a)(h,"CellRange",null,[])},320:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.OY="data-copystatus";h.JNa="data-copyfailedreason";h.Dp="data-clipservice-ccpid";h.version="data-clipservice-version";h.location="data-clipservice-location";h.eE="data-clipservice-dc";h.type="data-clipservice-type";h.pte="data-clipservice-param";h.count=
"data-clipservice-count";h.YCa="data-clipservice-cut";h.WCa="data-clipservice-isEmptyPlaceholder";h.client="data-clipservice-client";h.cmi="data-clipboardasbytes-url";h.BCh="wacserver";h.sessionId="data-SessionId";h.Gfb="data-ShapeIds";h.slideId="data-SlideId";h.timeStamp="data-TimeStamp";h.Jsj="data-willexpire";h.tkg="ClipboardAsImage";h.Py="data-pkey";Object(J.a)(h,"ClipServiceConstants",null,[])},321:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Code=0;this.Message=
this.ExtraErrorParam=null;this.RecommendedActions=0;this.Title=null;this.Type=0}}Object(J.a)(h,"ServiceError",null,[])},334:function(J,V,d){J=d(0);var h=d(374),e=d(267),m=d(648),r=d(27),v=d(513);class A{}Object(J.a)(A,"ProofingFeedbackLoopRequestObject",null,[]);var x=d(514),y=d(32),u=d(512);d.d(V,"a",function(){return H});class H extends m.a{constructor(G,E,I,Q,D=null){super(E);this.F$=G;this.cNh=I;this.lRh=Q;this.B4e=!1;this.mb=D;this.errorType=1===(this.F$.CritiqueActions&1)?0:1}get proofingType(){return v.b(this.F$)}get traceId(){return this.F$.TraceId}get typeId(){return this.F$.TypeId}get IM(){return this.F$}get suggestions(){const G=
[];if(this.F$.Suggestions)for(const E of this.F$.Suggestions)G.push(E.Text);return G}get metadata(){const G=[];if(this.F$.Metadata&&0<this.F$.Metadata.length)for(const E of this.F$.Metadata)E.Name&&E.Value&&G.push(E);return G}eJa(G,E=0){this.Xpf.track(()=>Object.assign(new x.a,{E:2,T:this.proofingType,A:G,I:E,G:this.typeId}));if(this.cNh){var I=e.a.re(this.lcid);let Q="";I?Q=I.name:h.ULS.sendTraceTag(36316369,375,50,"Lcid results in null CultureInfo: [LCID: {0}]",this.lcid);I=null;h.ULS.sendTraceTag(39416218,
375,50,"Sending proofing context with feedback loop API");I=Object.assign(new A,{AppId:u.a[r.App.mode]+"_online",TraceId:this.traceId,LanguageId:Q,CritiqueTypeId:this.typeId,EventId:this.b9j(G),FlaggedText:this.token,SuggestionText:this.tcj(G),PreContextBegin:this.G9,PostContextEnd:this.$Ga,OriginalText:this.originalText,Suggestions:this.suggestions,CritiquePriority:this.F$.Priority,Metadata:this.F$.Metadata});14!==I.EventId&&this.lRh.kXk(I)}}b9j(G){switch(G){case y.a.Mra:return 0;case y.a.x4d:return 1;
case y.a.lOa:return 3;case y.a.Vwa:return 4;case y.a.Wwa:return 5;case y.a.Xwa:return 6;case y.a.rXb:return 13;default:return 14}}tcj(G){switch(G){case y.a.Vwa:return this.suggestions[0];case y.a.Wwa:return this.suggestions[1];case y.a.Xwa:return this.suggestions[2];case y.a.MIa:return this.suggestions[3];case y.a.NIa:return this.suggestions[4];default:return""}}get vCa(){return this.B4e}set vCa(G){this.B4e=G}}Object(J.a)(H,"EditorServiceErrorDetails",m.a,[266,267])},366:function(J,V,d){d.d(V,"a",
function(){return h});J=d(0);class h{}h.POf="CU";h.Eoi="CS";h.Boi="CE";h.Jae="KP";h.Gil="TI";h.uUj="L";Object(J.a)(h,"CharacterBlockTrackerKeys",null,[])},367:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(33);class e{constructor(m,r){this.Flight=this.BaseDocQuerySignature=null;this.BaseDocQuerySignature=m;this.Flight=r}serialize(){return h.c([this.Lk(),this])}}Object(J.a)(e,"ACommonHandlerRequest",null,[])},373:function(J,V,d){J=d(0);var h=d(55),e=d(25),m=d(45),r=d(114),v=d(1181),
A=d(13),x=d(1154),y;(function(da){da[da.none=0]="none";da[da.noSystemClipboardAccess=1]="noSystemClipboardAccess";da[da.cutCopyDisallowed=2]="cutCopyDisallowed";da[da.pasteDisallowed=3]="pasteDisallowed";da[da.invalidPasteContext=4]="invalidPasteContext";da[da.invalidCcpOperation=5]="invalidCcpOperation";da[da.multiSlideCcpDisallowed=6]="multiSlideCcpDisallowed";da[da.pastedHtmlLengthExceeded=7]="pastedHtmlLengthExceeded";da[da.tooManyShapesAfterPaste=8]="tooManyShapesAfterPaste";da[da.noShapesPasted=
9]="noShapesPasted";da[da.invalidImagePasteArgs=10]="invalidImagePasteArgs";da[da.invalidClipboardData=11]="invalidClipboardData";da[da.invalidCopiedShapes=12]="invalidCopiedShapes";da[da.invalidCopiedSlides=13]="invalidCopiedSlides";da[da.invalidHtmlContent=14]="invalidHtmlContent";da[da.textEditFailed=15]="textEditFailed";da[da.clipServiceDataInvalid=16]="clipServiceDataInvalid";da[da.crossDCPasteDisallowed=17]="crossDCPasteDisallowed";da[da.imageTooLarge=18]="imageTooLarge";da[da.noAvailablePasteHandler=
19]="noAvailablePasteHandler";da[da.noAvailableCutCopyHandler=20]="noAvailableCutCopyHandler";da[da.cutCopyHandlerFailed=21]="cutCopyHandlerFailed";da[da.systemClipboardCopyFailed=22]="systemClipboardCopyFailed";da[da.copyObjectEmpty=23]="copyObjectEmpty";da[da.tableInvalid=24]="tableInvalid";da[da.copyObjectHasDeferredContent=25]="copyObjectHasDeferredContent";da[da.userOffline=26]="userOffline";da[da.picklingPasteFailedDueToMaxSizeLimit=27]="picklingPasteFailedDueToMaxSizeLimit";da[da.picklingInvalidCopyData=
28]="picklingInvalidCopyData";da[da.systemClipboardAccessFailure=29]="systemClipboardAccessFailure";da[da.chunkUploaderFailure=30]="chunkUploaderFailure";da[da.pasteCancelledByUser=31]="pasteCancelledByUser";da[da.cutCopyIRMRestricted=32]="cutCopyIRMRestricted"})(y||(y={}));Object(J.b)("CcpFailure",y);var u=d(912),H=d(110),G=d(26),E=d(320),I;(function(da){da[da.none=0]="none";da[da.text=1]="text";da[da.shape=2]="shape";da[da.textbox=3]="textbox";da[da.normalShape=4]="normalShape";da[da.image=5]="image";
da[da.table=6]="table";da[da.chart=7]="chart";da[da.video=8]="video";da[da.list=9]="list";da[da.ink=10]="ink";da[da.addin=11]="addin";da[da.smartArt=12]="smartArt";da[da.group=13]="group";da[da.placeholder=14]="placeholder";da[da.line=15]="line";da[da.activeX=16]="activeX";da[da.oleObject=17]="oleObject";da[da.media=18]="media";da[da.slide=19]="slide";da[da.mixed=20]="mixed"})(I||(I={}));Object(J.b)("ClipboardContentType",I);var Q;(function(da){da[da.keyboard=0]="keyboard";da[da.menu=1]="menu";da[da.floatie=
2]="floatie";da[da.ribbon=3]="ribbon"})(Q||(Q={}));Object(J.b)("ClipboardMethod",Q);var D;(function(da){da[da.copy=0]="copy";da[da.cut=1]="cut";da[da.paste=2]="paste"})(D||(D={}));Object(J.b)("ClipboardOperation",D);var Y;(function(da){da[da.other=0]="other";da[da.pptOnline=1]="pptOnline";da[da.pptOnlineSameSession=2]="pptOnlineSameSession";da[da.pptOnlineCrossSession=3]="pptOnlineCrossSession";da[da.wordOnline=4]="wordOnline";da[da.xlOnline=5]="xlOnline";da[da.oneNoteOnline=6]="oneNoteOnline";da[da.pptWin32=
7]="pptWin32";da[da.wordWin32=8]="wordWin32";da[da.xlWin32=9]="xlWin32";da[da.oneNoteWin32=10]="oneNoteWin32";da[da.googleDocs=11]="googleDocs";da[da.pptDesktop=12]="pptDesktop";da[da.pptDesktopWithDataUpload=13]="pptDesktopWithDataUpload"})(Y||(Y={}));Object(J.b)("ClipboardSource",Y);class M{constructor(){this.data={};this.wHf=!1;this.ogb=null}}Object(J.a)(M,"TelemetryEntry",null,[]);var N=d(1001),W=d(432),K=d(40),ca=d(28),P=d(67);d.d(V,"a",function(){return ea});class ea{constructor(da,ia,C,oa,
Z,pa,ya,Ja,Ka,ma,ra,Da){this.iCg=h.a.ey;this.XMg=this.rGg=this.vXc="";this.rQ=da;this.eW=ia;this.ev=new P.a;this.e9=new P.a;oa.Mzc(Object(A.a)(this,this.Hve,"onRevisionProcessedOnServer"));Z.qpa(Object(A.a)(this,this.cll,"trackSlideCcpRevision"));pa.qpa(Object(A.a)(this,this.bll,"trackShapeCcpRevision"));ya.qpa(Object(A.a)(this,this.Ykl,"trackParagraphCcpRevision"));Ja.qpa(Object(A.a)(this,this.Xkl,"trackNotesCcpRevision"));Ka&&Ka.qpa(Object(A.a)(this,this.Zkl,"trackPresentationCcpRevision"));this.cQ=
ra;this.ia=ma;this.hBg=C.Fhd;this.Uv=Da;if(da=e.AFrameworkApplication.Zc)this.rGg=Object(x.a)(String,da.Host)||"",this.XMg=Object(x.a)(String,da.Ring)||"",this.vXc=Object(x.a)(String,da.WACDatacenter)||""}qvb(da){return this.ev.Kb(da)}dB(da,ia){m.a.Xa(ia)||(this.qvb(ia)?ea.contentType in this.ev.ga(ia).data&&!this.ZBj(ia,da)||this.MU(ea.contentType,I[da],ia):G.a.J(50393377,826,15,"attempted to update clipboard telemetry before tracking started "+ia))}C6a(da,ia){if(!this.ev.Kb(da))return null;let C=
null;if(this.ev.ga(da)&&!(ia in this.ev.ga(da).data))switch(ia){case ea.contentType:C="none";break;case ea.source:C="other"}return C?C:this.ev.ga(da).data[ia].toString()}r7f(da){return this.C6a(da,ea.contentType)}S6f(da){return this.C6a(da,ea.source)}PXi(da){return this.C6a(da,ea.operation)}j4b(da){return"xlOnline"===this.S6f(da)&&"chart"===this.r7f(da)}ETc(da){return"slide"===this.r7f(da)&&"paste"===this.PXi(da)}uqk(da){const ia=I;for(let oa in ia){var C=ia[oa];if(oa.toLowerCase()===da.toLowerCase())return C}return 0}vqk(da){const ia=
Y;for(let oa in ia){var C=ia[oa];if(oa.toLowerCase()===da.toLowerCase())return C}return 0}ZBj(da,ia){da=this.uqk(this.ev.ga(da).data[ea.contentType].toString());return ia>da}ew(da,ia){m.a.Xa(ia)||(this.qvb(ia)?ea.source in this.ev.ga(ia).data&&!this.DLj(ia,da)||this.MU(ea.source,Y[da],ia):G.a.J(50393379,826,15,"attempted to update clipboard telemetry before tracking started "+ia))}DLj(da,ia){da=this.vqk(this.ev.ga(da).data[ea.source].toString());return ia>da}ai(da,ia,C){m.a.Xa(C)||this.MU(da,ia,C)}oO(da,
ia,C){const oa=K.a.Db&&!m.a.Xa(K.a.Db.actionName)?K.a.Db.actionName:C,Z=r.a.create().toString();this.ev.$(Z,Object.assign(new M,{ogb:this.rQ.wi("UserAction","ClipboardTelemetry")}));this.MU(ea.kLf,Z,Z);this.MU(ea.actionName,oa,Z);this.MU("ActualActionName",C,Z);this.MU("CcpOperation",D[da],Z);this.MU("CcpMethod",Q[ia],Z);this.MU("CcpBrowser",this.iCg,Z);this.MU("CcpHost",this.rGg,Z);this.MU("CcpDatacenter",this.vXc,Z);this.MU("CcpRing",this.XMg,Z);G.a.J(51179864,826,50,"start telemetry tracking. browser: {0}; CcpCorrelation: {1}; method: {2}; operation: {3}; actionName: {4}",
this.iCg,Z,Q[ia],D[da],oa);return Z}Eg(da,ia,C=0){if(m.a.Xa(ia))G.a.J(51478666,826,15,"attempted to end telemetry tracking for empty correlation");else if(m.a.Xa(ia)||!this.qvb(ia))G.a.J(51478669,826,15,"attempted to end telemetry tracking for invalid correlation id: {0}",ia);else{var oa=this.ev.ga(ia);this.MU("CcpTotalMs",oa.ogb.vq.toString(),ia);this.MU(ea.lLf,da.toString(),ia);0!==C&&(this.MU("CcpFailureReason",y[C],ia),this.j4b(ia)?16===C?this.cQ.wwa(ResourceStrings.l_CopyErrorCalloutTitle,ResourceStrings.l_CopyErrorCalloutMessage,
!1,null,!1,null,0,0,null,null,!0,ea.hob):(da=Object.assign(new W.a(!0),{Tb:ia}),this.cQ.wwa(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,ca.a.hQf,ca.a.UNd,null,da,!0,ea.hob)):25===C&&(G.a.J(523298057,826,15,"Attempted to paste deferred content/slide on another deck with correlation: {0}",ia),this.cQ.wwa(ResourceStrings.l_DeferredContentPasteDialogTitle,
ResourceStrings.l_DeferredContentPasteDialogMessage,!1,null,!1,null,0,0,null,null,!1,ea.hob)));G.a.J(50733397,826,50,H.c(oa.data));this.j4b(ia)||this.ETc(ia)||this.ev.remove(ia)}}s3k(da,ia){m.a.Xa(ia)||(this.ew(0,ia),this.ilh(da,ia,0))}ilh(da,ia,C){if(da){if(C>=N.a.xBc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",N.a.xBc));if(1===da.nodeType){for(var oa=da.firstChild;oa;)this.ilh(oa,ia,C+1),oa=oa.nextSibling;this.MIe(da,ia)}}}MIe(da,ia){const {ClipboardHelper:C}=d(696);
if(!m.a.Xa(ia))if(!this.qvb(ia))G.a.J(50393415,826,15,"attempted to update clipboard telemetry before tracking started "+ia);else if(da)if("head"===da.tagName.toLowerCase()){var oa=this.eW.q0f(da);m.a.Xa(oa)||this.a3k(oa,ia)}else{oa=0;var Z=da.getAttribute(E.a.sessionId);Z?oa=C.Ivg(Z.toString())?2:3:da.getAttribute(u.a.vTf)?oa=5:da.getAttribute(u.a.wTf)||da.getAttribute(u.a.ATf)?oa=1:da.id&&da.id.startsWith&&da.id.startsWith(u.a.zfg)&&(oa=11);if(da.className&&da.className.split)for(const pa of da.className.split(" "))if(pa.startsWith(h.a.GTb)&&
pa.length===h.a.GTb.length+1&&(da=parseInt(m.a.substring(pa,pa.length-1,pa.length)),isNaN(da)||this.MU("CcpSourceBrowser",v.a[da],ia)),0===oa)if(pa.startsWith(u.a.t4g))oa=1;else if(pa.startsWith(u.a.q0g))oa=6;else if(pa.startsWith(u.a.XCh))oa=4;else if(pa===u.a.eTg||pa===u.a.fTg)oa=8,this.dB(9,ia);0!==oa&&this.ew(oa,ia)}}a3k(da,ia){switch(da){case "PowerPoint.Slide":this.ew(7,ia);break;case "Word.Document":this.ew(8,ia);break;case "Excel.Sheet":this.ew(9,ia);break;case "OneNote.File":this.ew(10,ia)}}MU(da,
ia,C){this.ev.Kb(C)&&(this.ev.ga(C).data[da]=ia)}Hve(da,ia){ia.L9&&!m.a.Xa(ia.L9.Id)&&this.e9.Kb(ia.L9.Id)&&this.XYf(ia.L9.Id,!ia.L9.Error,ia.L9.Error?ia.L9.Error.Code:0)}cll(da,ia){this.wmc(C=>{let oa=null;if(C=Object(x.a)(132,C.node))oa=C.Tb,C.Tb=null;return oa},ia)}bll(da,ia){this.wmc(C=>{let oa=null;if(C=Object(x.a)(4,C.node))oa=C.Tb,C.Tb=null;return oa},ia)}Ykl(da,ia){this.wmc(C=>{let oa=null;if(C=Object(x.a)(5,C.node))oa=C.Tb,C.Tb=null;return oa},ia)}Xkl(da,ia){this.wmc(C=>{let oa=null;if(C=
Object(x.a)(385,C.node))oa=C.Tb,C.Tb=null;return oa},ia)}Zkl(da,ia){this.wmc(C=>{let oa=null;if(C=Object(x.a)(408,C.node))oa=C.Tb,C.Tb=null;return oa},ia)}wmc(da,ia){ia.revisionId&&ia.node&&(da=da(ia),m.a.Xa(da)||this.srh(ia.revisionId.toString(),da))}srh(da,ia){m.a.Xa(da)||m.a.Xa(ia)||this.e9.$(da,ia)}XYf(da,ia,C){if(!m.a.Xa(da)&&this.e9.Kb(da)){this.hBg&&"pptDesktopWithDataUpload"===this.S6f(this.e9.ga(da))&&this.Uv.WYf();var oa={};oa[ea.kLf]=this.e9.ga(da);oa[ea.lLf]=ia;oa[ea.emi]=C;this.j4b(this.e9.ga(da))?
(oa[ea.source]="xlOnline",oa[ea.contentType]="chart",0!==C&&(ia=Object.assign(new W.a(!0),{Tb:this.e9.ga(da)}),this.cQ.wwa(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,ca.a.hQf,ca.a.UNd,null,ia,!0,ea.hob))):433===C?(this.ETc(this.e9.ga(da))&&this.ia.processAction(ca.a.LM,2),this.cQ.wwa(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteLargeDataErrorCalloutMessage,
!1,null,!1,null,0,0,null,null,!0,ea.hob)):434===C&&(this.ETc(this.e9.ga(da))&&(this.hBg?this.ia.processAction(ca.a.DQd,2):this.ia.processAction(ca.a.LM,2)),this.cQ.wwa(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,ea.hob));G.a.J(50733400,826,50,H.c(oa));(this.j4b(this.e9.ga(da))||this.ETc(this.e9.ga(da)))&&this.ev.remove(this.e9.ga(da));this.e9.remove(da)}}QAj(da){return!m.a.Xa(da)&&this.ev.Kb(da)?this.ev.ga(da).wHf:!1}mbc(da){m.a.Xa(da)||
(this.qvb(da)?this.ev.ga(da).wHf=!0:G.a.J(595206346,826,15,"attempted to update clipboard telemetry before tracking started "+da))}}ea.source="CcpSource";ea.contentType="CcpContentType";ea.operation="CcpOperation";ea.lLf="CcpSuccess";ea.actionName="ActionName";ea.hob=20;ea.kLf="CcpCorrelation";ea.gti="CcpCopyIframeContent";ea.jNf="ClipServiceThrottled";ea.jLf="data-corr-id";ea.Dp="CcpId";ea.emi="ClipServiceFailureReason";Object(J.a)(ea,"ClipboardTelemetry",null,[364])},379:function(J,V,d){var h=d(289),
e=d(771),m=d(1183),r=d(45),v=d(220),A=d(25);J=d(0);class x{constructor(){this.g=this.b=0;this.hex=null;this.r=0}}Object(J.a)(x,"RecentColor",null,[]);var y=d(237),u=d(256),H=d(224),G=d(261),E=d(1003),I=d(527),Q=d(26);d.d(V,"f",function(){return D});d.d(V,"e",function(){return Y});d.d(V,"d",function(){return M});d.d(V,"c",function(){return N});d.d(V,"g",function(){return W});d.d(V,"b",function(){return K});d.d(V,"a",function(){return ca});d.d(V,"h",function(){return P});const D=(da,ia,C,oa,Z,pa,ya)=>
Y(da,ia,C,oa,Z,pa,ya,!1),Y=(da,ia,C,oa,Z,pa,ya,Ja)=>{ia=Object.assign(new h.a,{Id:ia,ControlsId:C,Title:ResourceStrings.L_ThemeFontColor,ControlList:[]});oa=Object.assign(new e.a,{Id:oa,ExternalId:Z,McuExternalId:String.format("{0}MCU",Z),McuLayout:!0,Command:pa,Width:10});if(da)if(Z=[],1===ya||2===ya){Ja=(new E.a).jYi(da);({themeColors:da,Muh:ya}=ea(Ja,da));for(var Ka=0;6>Ka;Ka++)for(var ma=0;ma<da.length;ma++){pa=Z;C=pa.push;var ra=void 0,Da=void 0;ra=Ja;var va=da[ma][Ka];Da=da[ma][0];var Fa=ya[ma],
ka=Ka,qa=ma;va=r.a.Dv(va.r,2)+r.a.Dv(va.g,2)+r.a.Dv(va.b,2);({uDc:ra,lIb:Da}=ra.IXd(Da,va,Fa,ka,qa));va=Object.assign(new m.a,{Color:"#"+ra,DisplayColor:"#"+va,Alt:Da});C.call(pa,va)}}else for(Ja=(new E.a).$6f(da,Ja),{themeColors:da,Muh:ya}=ea(Ja,da),Ka=0;6>Ka;Ka++)for(ma=0;ma<da.length;ma++)pa=Z,C=pa.push,ra=Ja,va=da[ma][Ka],Da=da[ma][0],Fa=ya[ma],ka=Ka,qa=ma,va=r.a.Dv(va.r,2)+r.a.Dv(va.g,2)+r.a.Dv(va.b,2),{uDc:Da,lIb:ra}=ra.IXd(Da,va,Fa,ka,qa),{TSk:Da,HVk:ra,lIb:va}={TSk:va,HVk:Da,lIb:ra},va=Object.assign(new m.a,
{Color:ra,DisplayColor:"#"+Da,Alt:va}),C.call(pa,va);else Z=null;oa.Colors=Z;Array.add(ia.ControlList,oa);return ia},M=(da,ia,C,oa,Z,pa)=>{da=Object.assign(new h.a,{Id:da,ControlsId:ia,Title:ResourceStrings.L_StandardFontColor,ControlList:[]});C=Object.assign(new e.a,{Id:C,ExternalId:oa,Command:Z,Width:10,Colors:[]});pa?(C.Colors.push(Object.assign(new m.a,{Color:"0000C0",Alt:r.a.le(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),C.Colors.push(Object.assign(new m.a,{Color:"0000FF",Alt:r.a.le(ResourceStrings.L_FontColorRed),
DisplayColor:"#FF0000"})),C.Colors.push(Object.assign(new m.a,{Color:"00C0FF",Alt:r.a.le(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),C.Colors.push(Object.assign(new m.a,{Color:"00FFFF",Alt:r.a.le(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),C.Colors.push(Object.assign(new m.a,{Color:"50D092",Alt:r.a.le(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),C.Colors.push(Object.assign(new m.a,{Color:"50B000",Alt:r.a.le(ResourceStrings.L_FontColorDarkGreen),
DisplayColor:"#00B050"})),C.Colors.push(Object.assign(new m.a,{Color:"F0B000",Alt:r.a.le(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),C.Colors.push(Object.assign(new m.a,{Color:"C07000",Alt:r.a.le(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),C.Colors.push(Object.assign(new m.a,{Color:"602000",Alt:r.a.le(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),C.Colors.push(Object.assign(new m.a,{Color:"A03070",Alt:r.a.le(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"}))):
(C.Colors.push(Object.assign(new m.a,{Color:"#C00000",Alt:r.a.le(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),C.Colors.push(Object.assign(new m.a,{Color:"#FF0000",Alt:r.a.le(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),C.Colors.push(Object.assign(new m.a,{Color:"#FFC000",Alt:r.a.le(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),C.Colors.push(Object.assign(new m.a,{Color:"#FFFF00",Alt:r.a.le(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),C.Colors.push(Object.assign(new m.a,
{Color:"#92D050",Alt:r.a.le(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),C.Colors.push(Object.assign(new m.a,{Color:"#00B050",Alt:r.a.le(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),C.Colors.push(Object.assign(new m.a,{Color:"#00B0F0",Alt:r.a.le(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),C.Colors.push(Object.assign(new m.a,{Color:"#0070C0",Alt:r.a.le(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),C.Colors.push(Object.assign(new m.a,
{Color:"#002060",Alt:r.a.le(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),C.Colors.push(Object.assign(new m.a,{Color:"#7030A0",Alt:r.a.le(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"})));Array.add(da.ControlList,C);return da},N=(da,ia,C,oa,Z,pa,ya)=>{ia=Object.assign(new h.a,{Id:ia,ControlsId:C,Title:ResourceStrings.L_RecentColors,ControlList:[]});oa=Object.assign(new e.a,{Id:oa,ExternalId:Z,Command:pa,Width:10,Colors:[]});if(ya)for(ya=0;da&&ya<da.length&&da[ya];ya++)Z=
da[ya],oa.Colors.push(Object.assign(new m.a,{Color:Z.hex,Alt:r.a.le(Z.hex),DisplayColor:Z.hex}));else for(ya=0;da&&ya<da.length&&da[ya];ya++)Z=da[ya],oa.Colors.push(Object.assign(new m.a,{Color:"#"+Z.hex,Alt:r.a.le("#"+Z.hex),DisplayColor:"#"+Z.hex}));Array.add(ia.ControlList,oa);return ia},W=(da,ia)=>{if(!ia)return da;var C=new x;C.hex=ia;const oa=[];let Z=0;oa[Z++]=C;for(C=0;da&&C<da.length&&10>C&&10>Z&&da[C];C++)da[C].hex!==ia&&(oa[Z++]=da[C]);return oa},K=(da,ia,C,oa,Z,pa,ya,Ja)=>{da=Object.assign(new h.a,
{Id:da,ControlsId:ia,DisplayMode:"Menu16",ControlList:[]});C=Object.assign(new v.a,{Command:C,LabelText:oa,Image16by16:A.AFrameworkApplication.Rl,Image16by16Class:ya,Id:Z,ExternalId:pa,KeyTip:Ja});Array.add(da.ControlList,C);return da},ca=(da,ia,C,oa,Z,pa,ya,Ja)=>{da=Object.assign(new h.a,{Id:da,ControlsId:ia,DisplayMode:"Menu16",ControlList:[]});C=Object.assign(new v.a,{Command:C,LabelText:oa,Image16by16:A.AFrameworkApplication.Rl,Image16by16Class:ya,Id:Z,ExternalId:pa,KeyTip:Ja});Array.add(da.ControlList,
C);return da},P=(da,ia,C)=>{for(let ra=0;ra<da.MenuSectionList.length;ra++){var oa=da.MenuSectionList[ra],Z=oa.ControlList;if(Z&&0<Z.length&&(Z=Z[0]))if(ia)if(oa.Id===I.a.themeColors&&C){var pa=H.i(ia.xC)||"";oa=C;var ya=Z.Colors,Ja="#";if(ya&&ya.length)if(r.a.Xa(pa))Q.a.J(523531867,820,10,"selectedFontColor should not be empty in FindSelectedThemeColor");else for(var Ka=0;Ka<ya.length;Ka++){var ma=ya[Ka].Color;if(!r.a.Xa(ma)&&(ma=(ma=u.a.parse(ya[Ka].Color))?ma.kmc():G.SchemeColor.parse(ya[Ka].Color),
oa&&ma&&ma.qCe(oa)&&ma.Dra&&(ma=H.i(ma.hP),ma.toLowerCase()===pa.toLowerCase()))){Ja=ya[Ka].Color;break}}oa=Ja;Z.SelectedColorId=oa}else{ya=H.i(H.g(ia.xC))||"";oa=Z.Colors;pa="#";if(oa&&oa.length)if(r.a.Xa(ya))Q.a.J(523531868,820,10,"selectedFontColor should not be empty in FindSelectedStandardColor");else for(Ja=0;Ja<oa.length;Ja++)if(Ka=oa[Ja].DisplayColor,!r.a.Xa(Ka)&&Ka.replace("#","").toLowerCase()===ya.toLowerCase()){pa=oa[Ja].Color;break}oa=pa;Z.SelectedColorId=oa}else Z.SelectedColorId="#"}},
ea=(da,ia)=>{let C;C=Array(10);C[0]=da.mK(y.Color.Mi(ia.PresetSchemeColorMapping.Background1));C[1]=da.mK(y.Color.Mi(ia.PresetSchemeColorMapping.Text1));C[2]=da.mK(y.Color.Mi(ia.PresetSchemeColorMapping.Background2));C[3]=da.mK(y.Color.Mi(ia.PresetSchemeColorMapping.Text2));C[4]=da.mK(y.Color.Mi(ia.PresetSchemeColorMapping.Accent1));C[5]=da.mK(y.Color.Mi(ia.PresetSchemeColorMapping.Accent2));C[6]=da.mK(y.Color.Mi(ia.PresetSchemeColorMapping.Accent3));C[7]=da.mK(y.Color.Mi(ia.PresetSchemeColorMapping.Accent4));
C[8]=da.mK(y.Color.Mi(ia.PresetSchemeColorMapping.Accent5));C[9]=da.mK(y.Color.Mi(ia.PresetSchemeColorMapping.Accent6));da=Array(10);da[0]=ResourceStrings.l_ThemeLabel1;da[1]=ResourceStrings.l_ThemeLabel2;da[2]=ResourceStrings.l_ThemeLabel3;da[3]=ResourceStrings.l_ThemeLabel4;da[4]=ResourceStrings.l_ThemeLabel5;da[5]=ResourceStrings.l_ThemeLabel6;da[6]=ResourceStrings.l_ThemeLabel7;da[7]=ResourceStrings.l_ThemeLabel8;da[8]=ResourceStrings.l_ThemeLabel9;da[9]=ResourceStrings.l_ThemeLabel10;return{themeColors:C,
Muh:da}}},425:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.body=this.contextId=this.revId=this.source=this.id=null}}Object(J.a)(h,"Item",null,[])},426:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.open="open";h.refresh="refresh";h.QFe="saveAs";h.translate="translate";h.modeSwitch="modeSwitch";h.cxi="createNew";h.convert="convert";Object(J.a)(h,"ReasonList",null,[])},427:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.func=
this.outputSchema=this.inputSchema=this.name=null}}Object(J.a)(h,"Lambda",null,[647])},428:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.Hkc="SlideTextTile";h.CJe="ShapeTextTile";Object(J.a)(h,"AugmentationSchemas",null,[])},429:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d(25);class h{static wb(){}static J_(e,m,r,v,A){return 1===r?32:h.Vzk(e,A)?32:8}static oG(e,m,r,v,A){return 1===r?32:h.pdk(e,A)?32:8}static pdk(e,m){const r=h.bIh[e.toString()];if(void 0===r||null===
r)return!1;r(e,m);return!0}static Vzk(e,m){const r=h.dIh[e.toString()];if(void 0===r||null===r)return!1;r(e,m);return!0}}h.bIh={};h.dIh={};Object(J.a)(h,"DialogCuiControlActor",null,[])},430:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.description=this.title=this.kP=this.F_=null}}Object(J.a)(h,"CpContentDetails",null,[423])},431:function(J,V,d){d.d(V,"a",function(){return e});d.d(V,"b",function(){return r});var h=d(8);d(1019);const e=A=>m(A),m=A=>new Promise((x,
y)=>{A.continueWith(u=>{u.Sl?y(u.Ti.message):u.yn?y(h.a.CEc()):x(null)})}),r=A=>v(A),v=A=>new Promise((x,y)=>{A.continueWith(()=>{A.Sl?y(A.Ti.message):A.yn?y(h.a.CEc()):x(A.result)})})},432:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.Om=null;this.uP=!1;this.Hug=!0;this.Wt=this.yV=null;this.wIc=!1;this.C4d=null;this.v0g=!0;this.aA=this.yL=this.Tb=null;this.b5a=!1;this.w0f=e}}Object(J.a)(h,"PasteParams",null,[])},433:function(J,V,d){d.d(V,"a",function(){return e});
J=d(0);var h=d(114);class e{constructor(){this.zDf=!1;this.sessionId=this.mNf=null;this.E3a=e.KUi()}static KUi(){return"CID"+h.a.create().toString()}static Ppg(m){return m&&m.length?m.startsWith("CID")&&h.a.isValid(m.substring(3,m.length))?!0:!1:!1}}Object(J.a)(e,"InternalClipboardObject",null,[])},434:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(433);class h extends d.a{constructor(e){super();this.Ud=e}get fug(){return!this.Ud||!this.Ud.isConnected}get id(){return this.Ud.id}get isConnected(){return this.Ud.isConnected}}
Object(J.a)(h,"InternalClipboardSlide",d.a,[])},435:function(J,V,d){d.d(V,"a",function(){return e});var h=d(102);const e=(m,r,v)=>{const A=new h.StandardDialog;A.vd=0;A.nO(m,r,v);return A}},449:function(J,V,d){J=d(0);var h=d(374),e=d(13),m=d(25),r=d(177),v=d(72),A=d(66),x=d(178),y=d(104),u=d(168);d(76);class H{constructor(){this.secondActionButtonProps=this.firstActionButtonProps=this.messageTitle=this.message=null;this.isMultiline=!1;this.messageBarType=0;this.closeable=!1;this.messageBarIconProps=
this.linkProps=this.dismissButtonAriaLabel=this.onDismiss=null}}Object(J.a)(H,"MessageBarProps",null,[]);class G{constructor(W,K){this.onExecute=this.label=this.type=null;this.label=W;this.type="AppButtonProps";this.onExecute=K}}Object(J.a)(G,"AppButtonProps",null,[]);var E=d(150),I=d(763),Q=d(132),D=d(213),Y=d(114),M=d(35);d.d(V,"a",function(){return N});class N{constructor(W,K,ca){this._message=this.oB=null;this.Qud=this.Fib=!1;this.Fod=0;this.Bfa="";this.oR=0;this.KF=this.$Q=this.Ina=this.I5=this.u0a=
this.rKb=this.qKb=this.pKb=this.oKb=this.sM=this.q5=this.Xoa=this.NKa=null;this.xib=this.wib=!1;this.wWe=this.Xod="";this.Vod=!1;this.xWe=this.apd="";this.Zod=!1;this.$od=this.Wod=null;this.fOb=!1;this.Ybf=this.pkb="";this.t0a=null;this.pNb=this.C5e=!1;this.kAa=this.G1=this.Kba=this.IO=this.businessBar=null;this.errorCode=0;this.DDf=this.visible=!1;this.title=W;this.message=K;this.L2b=ca;this.id=0;this.image=1;this.p9d=!0;this.PGf=5}get htmlElement(){return this.IO}get p9d(){return this.Qud}set p9d(W){this.Qud=
W}get PGf(){return this.Fod}set PGf(W){this.Fod=W}get title(){return this.oB}set title(W){this.oB!==W&&(this.oB=W,this.Xoa&&(this.Xoa.innerText=this.oB))}get message(){return this._message}set message(W){this._message!==W&&(this._message=W,this.q5&&(this.q5.innerText=this._message))}get image(){return this.oR}set image(W){this.oR=W;4!==this.oR&&(this.Kba="")}get xCa(){return this.Bfa}set xCa(W){this.Bfa=W}get closeable(){return this.Fib}set closeable(W){this.Fib!==W&&(this.Fib=W,this.Ina&&(this.Ina.style.display=
this.Fib?"table-cell":"none"))}get Vgc(){return m.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled")}get Uvl(){return m.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")}addButton(W,K,ca,P=!1){this.Xod=W;this.Wod=K;this.wib=!0;this.wWe=ca;this.Vod=P}QFd(W,K){this.apd=W;this.$od=K;this.xib=!0;this.xWe="";this.Zod=!1}KAf(W,K){this.pkb=W;this.t0a=K;this.fOb=!0}eyi(){var W=D.a.ABa(m.AFrameworkApplication.fa.Ia("VNextStyleOptOutCookieName"),!1);W=this.Uvl&&!W;this.IO=document.createElement("div");
this.htmlElement.className=String.format("{0} {1} {2}",N.vWe,N.HRh,W?N.DWh:"");this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.kAa&&null!==this.kAa&&(this.htmlElement.id=this.kAa);W=()=>{E.UISurfaces.e5i().then(K=>{this.businessBar.$9d||(K.initializeMessageBarInStore(),this.businessBar.$9d=!0);const ca=Object.assign(new H,{message:this._message,messageTitle:this.oB,isMultiline:this.Qud,messageBarType:this.Fod});if(this.Fib){ca.closeable=!0;var P=this._message+". "+CommonUIStrings.l_DialogClose;
this.oB&&(P=this.oB+". "+P);ca.dismissButtonAriaLabel=P;ca.onDismiss=()=>{this.vMd(this)}}4===this.oR&&(ca.messageBarIconProps={["iconName"]:this.Kba});this.fOb&&(ca.linkProps={["type"]:"AppLinkProps",["text"]:this.pkb,["handler"]:{["href"]:this.Ybf,["target"]:"_blank"}},this.t0a&&(P=Object(e.a)(this,this.$ik,"onMessageBarLinkClicked"),ca.linkProps.handler=P));this.wib&&(ca.firstActionButtonProps=new G(this.Xod,()=>{this.Ydi(this)}));this.xib&&(ca.secondActionButtonProps=new G(this.apd,()=>{this.$di(this)}));
K.createNewMessageBarWithCallback?K.createNewMessageBarWithCallback(this.htmlElement,ca,()=>{m.AFrameworkApplication.Ba.Mq()}):K.createNewMessageBar(this.htmlElement,ca);return null}).catch(()=>{h.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API");return null})};r.a.get_instance().isCompleted(7)?W():r.a.get_instance().Ak(7,W);this.L2b&&(m.AFrameworkApplication.Ba.Ux.pb(A.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),m.AFrameworkApplication.Ba.EF.wT(A.a.ol,
this.htmlElement,Object(e.a)(this,this.Vte,"onBodyKeyUp"),this),this.C5e&&!this.pNb&&(m.AFrameworkApplication.Ba.e$.pb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.pNb=!0));return this.htmlElement}createElement(){m.AFrameworkApplication.oN("Microsoft.Office.Web.SessionSettings.IWacWordReactBusinessBarSettings");if(this.Vgc)return this.eyi();this.IO=document.createElement("div");this.htmlElement.className=N.vWe;this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.kAa&&
null!==this.kAa&&(this.htmlElement.id=this.kAa);this.NKa=null;if(0!==this.oR){this.NKa=document.createElement("span");this.NKa.className="WACBusinessBarIcon";this.htmlElement.appendChild(this.NKa);var W=null;let K=null;switch(this.oR){case 2:W=N.JJh;K=CommonUIStrings.l_DialogError;break;case 1:W=N.OWh;K=CommonUIStrings.l_DialogWarning;break;case 3:W=N.PLh;K=CommonUIStrings.l_DialogInfo;break;case 4:W=this.Kba,K=this.Bfa}this.NKa.title=K;this.NKa.setAttribute(Q.a.ff,Q.a.OFf);this.NKa.appendChild(v.createClusteredImage(24,
24,W,N.FLh,!0,""))}W=Y.a.create().toString();this.sM=document.createElement("div");this.sM.id="BBTitleAndBody"+W;this.sM.className=N.UGh;this.sM.tabIndex=0;this.oB&&(this.Xoa=document.createElement("p"),this.Xoa.innerText=this.oB,this.Xoa.className=N.VGh+" UIFontBold",this.Xoa.id="BBTitle"+W,this.Xoa.setAttribute("UNSELECTABLE","on"),this.sM.setAttribute(Q.a.o6,this.Xoa.id),this.sM.appendChild(this.Xoa));this.q5=document.createElement("p");this.q5.className=N.PGh;this.q5.innerText=this._message;this.q5.id=
"BBBody"+W;this.q5.setAttribute("UNSELECTABLE","on");this.q5.style.width="100%";this.sM.setAttribute(Q.a.zpa,this.q5.id);this.wib&&this.$zf(this.q5,this.wWe);this.xib&&this.$zf(this.q5,this.xWe);this.sM.appendChild(this.q5);W=document.createElement("div");W.setAttribute(Q.a.ff,Q.a.JAc);W.appendChild(this.sM);this.htmlElement.appendChild(W);this.wib&&(this.pKb=document.createElement("span"),this.oKb=document.createElement("button"),this.OQf(this.pKb,this.oKb,this.Xod,Object(e.a)(this,this.HIf,"buttonOneClickHandler")));
this.xib&&(this.rKb=document.createElement("span"),this.qKb=document.createElement("button"),this.OQf(this.rKb,this.qKb,this.apd,Object(e.a)(this,this.IIf,"buttonTwoClickHandler")));this.fOb&&(this.u0a=document.createElement("span"),this.u0a.className=N.TGh,this.I5=document.createElement("a"),this.I5.className=I.a.SGh,this.I5.innerText=this.pkb,this.t0a?(this.I5.tabIndex=0,m.AFrameworkApplication.Ba.Ux.wT(A.a.click,this.I5,Object(e.a)(this,this.Vyg,"linkClickHandler"),this),m.AFrameworkApplication.Ba.EF.wT(A.a.ol,
this.I5,Object(e.a)(this,this.kYg,"onLinkKeyUp"),this)):(this.I5.href=this.Ybf,this.I5.target="_blank"),this.u0a.appendChild(this.I5),this.htmlElement.appendChild(this.u0a));m.AFrameworkApplication.Ba.Ux.pb(A.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick"));m.AFrameworkApplication.Ba.EF.wT(A.a.ol,this.sM,Object(e.a)(this,this.Vte,"onBodyKeyUp"),this);this.C5e&&!this.pNb&&(m.AFrameworkApplication.Ba.e$.pb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.pNb=!0);
this.Fib&&(this.Ina=document.createElement("span"),this.Ina.className=N.xHh,this.$Q=document.createElement("a"),this.$Q.className=N.yHh,this.$Q.tabIndex=0,this.$Q.title=CommonUIStrings.l_DialogClose,this.$Q.setAttribute(Q.a.ff,Q.a.St),this.KF=v.createClusteredImage(16,16,N.zHh,"",!0,""),this.$Q.appendChild(this.KF),this.Ina.style.display="table-cell",this.Ina.appendChild(this.$Q),this.htmlElement.appendChild(this.Ina),m.AFrameworkApplication.Ba.Ux.wT(A.a.click,this.$Q,Object(e.a)(this,this.kWg,"onCloseClick"),
this),m.AFrameworkApplication.Ba.EF.wT(A.a.ol,this.$Q,Object(e.a)(this,this.lWg,"onCloseKeyUp"),this));return this.htmlElement}K9k(){this.sM&&this.sM.setAttribute(Q.a.XJ,Q.a.Bpa)}$zf(W,K){if(K&&""!==K){var ca=document.createElement("span");ca.className=N.LSh;ca.innerText=K;W.appendChild(ca)}}OQf(W,K,ca,P){W.className=N.RGh;K.setAttribute("type","button");K.className=N.QGh;K.innerText=ca;W.appendChild(K);this.htmlElement.appendChild(W);m.AFrameworkApplication.Ba.Ux.wT(A.a.click,K,P,this)}teh(){this.Vgc||
(this.sM.style.whiteSpace="nowrap",this.closeable?this.Ina.style.width="auto":this.fOb?this.u0a.style.width="auto":this.xib?this.rKb.style.width="auto":this.wib?this.pKb.style.width="auto":this.sM.style.width="auto",this.htmlElement.clientWidth>this.businessBar.htmlElement.clientWidth?this.sM.style.whiteSpace="normal":this.closeable?this.Ina.style.width="100%":this.fOb?this.u0a.style.width="100%":this.xib?this.rKb.style.width="100%":this.wib?this.pKb.style.width="100%":this.sM.style.width="100%")}vRe(W,
K){if(u.a.EBb()){var ca={};ca.WacSessionId=m.AFrameworkApplication.userSessionId;ca.ActionName="BusinessBar"+W;ca.InputMethod=K;h.ULS.sendTraceTag(35489761,207,50,JSON.stringify(ca))}}VV(W,K,ca,P){this.vRe(W,ca);u.a.$Ra()&&y.c(K,!0,y.e,P,10)}HIf(W){this.Wod(W.wC);this.VV("ButtonOne",M.a.BIf,"Mouse",2);this.Vod&&(this.VV("Close",M.a.Unb,"Mouse_ButtonOne",2),this.close(W));return!0}Ydi(W){this.Wod(W);this.VV("ButtonOne",M.a.BIf,"Mouse",2);this.Vod&&(this.VV("Close",M.a.Unb,"Mouse_ButtonOne",2),this.vMd(W))}IIf(W){this.$od(W.wC);
this.VV("ButtonTwo",M.a.CIf,"Mouse",2);this.Zod&&(this.VV("Close",M.a.Unb,"Mouse_ButtonTwo",2),this.close(W));return!0}$di(W){this.$od(W);this.VV("ButtonTwo",M.a.CIf,"Mouse",2);this.Zod&&(this.VV("Close",M.a.Unb,"Mouse_ButtonTwo",2),this.vMd(W))}Vyg(W){this.t0a(W.wC);this.VV("Link",M.a.FIf,"Mouse",2);return!0}$ik(){this.t0a(null)}kYg(W){return W.nc.keyCode!==x.a.Xp||W.nc.altKey?!1:(this.t0a(W.wC),this.VV("Link",M.a.FIf,"Keyboard",1),!0)}Vte(W){return W.nc.keyCode===x.a.Xp&&!W.nc.altKey&&this.L2b?
(this.L2b(W.wC,W),this.VV("Invoke",M.a.EIf,"Keyboard",1),!0):!1}dispose(){this.htmlElement&&(m.AFrameworkApplication.Ba.Ux.zb(A.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),this.pNb&&m.AFrameworkApplication.Ba.e$.zb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick")));this.$Q&&(m.AFrameworkApplication.Ba.Ux.zb(A.a.click,this.$Q,Object(e.a)(this,this.kWg,"onCloseClick")),m.AFrameworkApplication.Ba.EF.zb(A.a.ol,this.$Q,Object(e.a)(this,this.lWg,"onCloseKeyUp")));this.oKb&&
m.AFrameworkApplication.Ba.Ux.zb(A.a.click,this.oKb,Object(e.a)(this,this.HIf,"buttonOneClickHandler"));this.qKb&&m.AFrameworkApplication.Ba.Ux.zb(A.a.click,this.qKb,Object(e.a)(this,this.IIf,"buttonTwoClickHandler"));this.I5&&this.t0a&&(m.AFrameworkApplication.Ba.Ux.zb(A.a.click,this.I5,Object(e.a)(this,this.Vyg,"linkClickHandler")),m.AFrameworkApplication.Ba.EF.zb(A.a.ol,this.I5,Object(e.a)(this,this.kYg,"onLinkKeyUp")));this.sM&&m.AFrameworkApplication.Ba.EF.zb(A.a.ol,this.sM,Object(e.a)(this,
this.Vte,"onBodyKeyUp"));this.businessBar=this.$Q=this.Ina=this.KF=this.u0a=this.I5=this.rKb=this.qKb=this.pKb=this.oKb=this.sM=this.q5=this.IO=this.Xoa=this.NKa=this.Bfa=null}onClick(W){this.VV("Invoke",M.a.EIf,"Mouse",2);return!!this.L2b&&this.L2b(this,W)}kWg(W){this.VV("Close",M.a.Unb,"Mouse",2);this.close(W);return!0}lWg(W){return W.nc.keyCode!==x.a.Xp||W.nc.altKey?!1:(this.VV("Close",M.a.Unb,"Keyboard",1),this.close(W),!0)}close(W){const K=W.wC;this.businessBar.removeEntry(K);this.Dpg(K,W.Qf)}Dpg(W,
K){if(W.G1){const ca=m.AFrameworkApplication.Va;ca.$p=10;ca.pS=K;W.G1(W);ca.$p=0;ca.pS=0}}vMd(W){W&&this.businessBar&&(this.businessBar.removeEntry(W),this.Dpg(W,0))}}N.vWe="WACBusinessBarEntry";N.VGh="WACBusinessBarTitle";N.PGh="WACBusinessBarBody";N.UGh="WACBusinessBarTitleBodyHolder";N.RGh="WACBusinessBarButtonHolder";N.QGh="WACBusinessBarButton";N.TGh="WACBusinessBarLinkHolder";N.yHh="WACBusinessBarClose";N.xHh="WACBusinessBarCloseHolder";N.zHh="BusinessBarClose_16x16x32";N.FLh="WACBusinessBarImage";
N.LSh="WACScreenReaderOnly";N.JJh="CancelRequest_24x24x32";N.OWh="Risks_24x24x32";N.PLh="Info_24x24x32";N.HRh="ReactBusinessBarEntry";N.DWh="VNextBusinessBarEntry";Object(J.a)(N,"BusinessBarEntry",null,[444,109])},455:function(J,V,d){J=d(0);var h=d(45),e=d(197),m=d(1162),r=d(1154),v=d(61);class A{constructor(){this.shapeType=this.jre=this.yRg=this.UUg=this.TUg=0;this.Gq=this.Jp=this.hq=this.sk=!1;this.WAc=null}}Object(J.a)(A,"ShapeProperties",null,[]);var x=d(26),y=d(40),u=d(108),H=d(209);d.d(V,"a",
function(){return G});class G{constructor(E,I,Q,D,Y,M,N,W,K){this.fv=E;this.rm=I;this.Fa=N;this.T5j=M.m8k;this.z4j=this.cyi();this.Rp=Q;this.VK=D;this.Le=Y.Na;this.uW=M.ssa;this.E1j=M.lxa;this.zc=W;this.Ub=K}E2g(E,I,Q,D,Y,M=null){if(I){var N=this.Fa.Z5a(Q);N&&(Array.remove(Q,N),Array.add(Q,this.Fa.Lr(N)));this.Dqh(Q);var W=Q.length;N=Array(W);D=this.lag(I,D);for(var K=0;K<W;K++){var ca=Q[K],P=this.f6i(ca,D);N[K]=Object.assign(new A,{TUg:P.x,UUg:P.y,yRg:ca.Bx,jre:ca.qD,shapeType:ca.shapeType,sk:ca.sk,
hq:ca.hq||2===ca.mediaType||1===ca.mediaType,Jp:ca.rd,Gq:ca.Gq,WAc:""});N[K].sk&&(P=Object(r.a)(133,ca.pc(this.Le)),N[K].WAc=P?P.sMe:"",x.a.J(25778199,826,50,"PendingImage: {0}, State: {1}, HasImageId: {2}",ca.r3d,this.VK.DV(ca),0<N[K].WAc.length))}K=I.Cb;ca=I.Mu();P=[];D=!0;var ea=E.vj===I.vj,da=E.Tn===I.Tn,ia=!1;E!==I&&(ea?(ia=E.h7a||I.h7a,da||(ia=E.$6a||I.$6a||ia),D=!ia):D=!1,D&&this.uW&&(E.Up!==I.Up||E.Gk!==I.Gk)&&(D=!1));for(var C=0;C<W;C++)this.l8k(Q[C])||(P.push(Q[C]),D&&(D=this.r6k(Q[C],da)));
Q=P;x.a.J(24131164,826,50,"{0}",{["LocalRenderEnabled"]:D,["SameSlide"]:E===I,["SameMaster"]:ea,["SameLayout"]:da,["ThemeOverrides"]:ia});W=[];C=ia=da=ea=P=!1;for(let oa=0;oa<Q.length;oa++){const Z=N[oa];let pa=this.rm.pvi(K.cid,K.sid,Z.TUg,Z.UUg,Z.yRg,1>Z.jre?1:Z.jre,ca+Q[oa].get_zIndex(),E.id,Q[oa],Z.shapeType,Z.sk,Z.WAc,D);h.a.Xa(M)||(pa.Tb=M);W.push(pa);P=P||Z.sk;ea=ea||Z.hq;da=da||Z.Jp;ia=ia||Z.Gq;C=C||this.E1j&&G.GIj(pa)}Y=G.aeh(P,ea,da,ia,C,Y);if(0<W.length&&(E=D?Q:null,this.fv.X1(W,I,Y,E),
D&&y.a.Db)){if(E){I="";for(const oa of E)I+=this.Fa.O_b(oa)+",";y.a.Db.Ya(u.a.bti,I);y.a.Db.Ya(u.a.Z4k,E.length.toString())}y.a.Db.Nj=!0;y.a.Db.CGb=!0}}}tAi(E,I,Q,D,Y,M){var N=this.lag(E,Q);Q=[];const W=I.pcc,K=!!W&&!e.a.Xa(W.Wvg);M=this.e6i(M,N);for(N=0;N<I.objectCount;N++){const ca=this.rm.Aui(E.cid,E.sid,M.x,M.y,Y);ca.isEditable=K&&W.Wvg[N];Q.push(ca)}0<Q.length&&this.fv.X1(Q,E,D)}e6i(E,I){const Q=I*G.t6;I*=G.t6;let D=new v.a(Q,I);E&&(D=this.Ub.rra(E.clientWidth,E.clientHeight))&&(D.x+=Q,D.y+=
I);return D}l8k(E){return E.FA&&this.T5j||!E.hrg}r6k(E,I){return E.r3d||this.VK.DV(E)||E.ll&&E.hasText&&!I&&10!==E.zj&&12!==E.zj||E.ar?!1:!0}Dqh(E){E.sort((I,Q)=>I.get_zIndex()-Q.get_zIndex())}tJj(E){return E?this.z4j.contains(E):!1}lag(E,I){if(!E)return 0;if(!I)return G.Kei;let Q,D;return I.$(Q=E.Cb,(D=I.ga(Q))+1),D}f6i(E,I){var Q=this.Rp.presentation;if(!Q)throw Error.argumentNull("Presentation is null");let D=E.My,Y=E.Ny;E=Q.dbj(Q.LB(E.slideId));Q=Math.round(G.t6/E)*E;E=m.a.yf(Q,0);for(Q=m.a.yf(Q,
1);0<I;)D+=E,Y+=Q,I--;return new v.a(D,Y)}jnl(E){try{if(E&&E.clipboardData){const I=E.clipboardData.types;for(let Q=0;Q<I.length;Q++){const D=E.clipboardData.getData(I[Q]);if(this.dBj(D))return D}}}catch(I){}return null}dBj(E){return!!E&&0<E.length&&this.sNj(E)}sNj(E){E=E.trim().toLowerCase();return E.startsWith("http:")||E.startsWith("https:")}e0k(E,I,Q){E&&(E.setAttribute(G.hJf,I.toString()),E.setAttribute(G.gJf,Q.toString()),E.setAttribute(G.iJf,"true"))}cyi(){const E=new H.a;E.add("param");E.add("map");
E.add("area");E.add("script");E.add("noscript");E.add("col");E.add("colgroup");E.add("caption");E.add("head");E.add("title");E.add("link");E.add("meta");E.add("style");E.add("base");E.add("input");E.add("textarea");E.add("select");E.add("option");E.add("optgroup");E.add("button");E.add("hr");return E}N2i(E){return this.pxh(E,G.hJf)}F2i(E){return this.pxh(E,G.gJf)}iFj(E){return E?"true"===E.getAttribute(G.iJf):!1}Uml(E){if(this.owg(E)){const I=E.indexOf('"')+1,Q=E.lastIndexOf('"');if(1<I&&Q>I&&(E=
E.slice(I,Q),E.startsWith(G.Pei)))return E}return null}owg(E){return!!E&&E.length>G.ofi&&E.startsWith(G.Qei)}pxh(E,I){let Q=0;this.iFj(E)&&(Q=parseFloat(E.getAttribute(I)));return isNaN(Q)?0:Q}AKd(E){return this.BKd(E).returnValue}BKd(E){let I;I=2;let Q=0,D=0,Y=0,M=0,N=0,W=0,K=0,ca=0,P=0,ea=0,da=0,ia=0,C=0,oa=0,Z=0,pa=0,ya=0;for(const Ja of E)Ja.rd?(I=2===I?6:20,Q++):Ja.fg?(I=2===I?12:20,D++):Ja.Gq?(I=2===I?7:20,Y++):Ja.Xf?(I=2===I?13:20,M++):22===Ja.W0b?(I=2===I?10:20,N++):Ja.sk?(I=2===I?5:20,W++):
Ja.xx?(I=2===I?3:20,K++):Ja.bja?(I=2===I?14:20,Ja.FA&&P++,ca++):Ja.ll?(I=2===I?14:20,Ja.FA&&da++,ea++):Ja.ty?(I=2===I?15:20,ia++):Ja.nZ?(I=2===I?16:20,C++):Ja.hq?(I=2===I?18:20,oa++):Ja.ar?(I=2===I?11:20,Z++):Ja.Zba?(I=2===I?17:20,pa++):(I=2===I?4:20,ya++);return{returnValue:String.format("numTotalShapes={0}, numTables={1}, numSmartArt={2}, numCharts={3}, numGroups={4}, numInk={5}, numPictures={6}, numTextbox={7}, numTitlePlaceholder={8}, numEmptyTitlePlaceholder={9}, numNonTitlePlaceholder={10}, numEmptyNonTitlePlaceholder={11}, numLine={12}, numActiveX={13}, numMedia={14}, numAppForOffice={15}, numOleObject={16}, numNormalShape={17}",
E.length,Q,D,Y,M,N,W,K,ca,P,ea,da,ia,C,oa,Z,pa,ya),contentType:I}}static HWk(E){for(const I of E)if(!I.hrg||I.isLocal)return!1;return!0}static GIj(E){return E&&4===E.HR?(!E.fill||!!E.fill.noFillField)&&(!E.lineStyle||!!E.lineStyle.noFillField):!1}static aeh(E,I,Q,D,Y,M){return E||I||Q||D||Y?M:0}}G.iJf="data-from-ppt-online";G.hJf="data-image-width-mu";G.gJf="data-image-height-mu";G.Pei="data:image/";G.Qei="<img src=";G.ofi=14;G.Kei=1;G.t6=15;Object(J.a)(G,"CopyPasteUtility",null,[346])},456:function(J,
V,d){J=d(0);var h=d(511),e=d(128);class m extends h.a{constructor(){super();this.nextId=this.prevId=null;this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.jl()})}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static jl(){return["AugLoop_Core_Operation"]}}Object(J.a)(m,"OperationWithSiblingContext",h.a,[]);d.d(V,"a",function(){return r});class r extends m{constructor(){super();this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.jl()})}static getTypeName(){return"AugLoop_Core_AddOperation"}static jl(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}}Object(J.a)(r,"AddOperation",m,[])},509:function(J,V,d){d.d(V,"a",function(){return r});J=d(0);var h=d(63),e=d(510),m=d(885);class r{dVb(v,A){if(1===v.nodeType&&A){var x=this.mV(A);v=this.w2f(v,x);this.yni(x,v,A)}}w2f(v,A){const {CombineHelper:x}=d(1106),y=[];let u=null;for(let G=0;G<v.childNodes.length;G++){var H=v.childNodes[G];3===H.nodeType?(u||(u=new x(v,G,A)),u.s0h(G)):(u&&(u.end(y,G-1),u=null),H=this.w2f(H,A),Array.addRange(y,H))}u&&u.end(y,v.childNodes.length-1);
return y}yni(v,A,x){v=v.clone();let y=!1;for(let u=A.length-1;0<=u;u--){const H=A[u].xni();y=v.merge(H)||y}y&&this.setSelection(v,x)}setSelection(v,A){A=h.a.JBa(A);A.setStart(v.start.element,v.start.offset);A.setEnd(v.end.element,v.end.offset)}mV(v){return(v=h.a.JBa(v))?Object.assign(new m.a,{start:Object.assign(new e.a,{element:v.startContainer,offset:v.startOffset}),end:Object.assign(new e.a,{element:v.endContainer,offset:v.endOffset})}):new m.a}}r.unused=-1;Object(J.a)(r,"TextNodeCombiner",null,
[1388])},510:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.element=null;this.offset=0}clone(){return Object.assign(new h,{element:this.element,offset:this.offset})}merge(e){if(!e.element||this.element===e.element&&this.offset===e.offset)return!1;this.element=e.element;this.offset=e.offset;return!0}}Object(J.a)(h,"SelectionSide",null,[])},511:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(254);var h=d(128);class e extends V.a{constructor(){super();this.items=
this.parentRevId=this.parentPath=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.jl()})}static getTypeName(){return"AugLoop_Core_Operation"}static jl(){return[]}}Object(J.a)(e,"Operation",V.a,[])},512:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.none=0]="none";e[e.oneNote=1]="oneNote";e[e.word=2]="word";e[e.wordViewer=3]="wordViewer";e[e.powerPoint=4]="powerPoint"})(h||(h={}));Object(J.b)("AppMode",h)},513:function(J,V,d){d.d(V,"a",function(){return e});
d.d(V,"b",function(){return m});d.d(V,"c",function(){return r});const h=v=>{switch(v){case 1:return 5;case 2:return 4;case 3:return 3;case 5:return 2;case 4:return 1;default:return 0}},e=v=>h(r(v.Priority,v.Tag)),m=v=>r(v.Priority,v.Tag),r=(v,A)=>{switch(v){case 0:return 1;case 1:return 2;case 2:return A&1?5:3;case 3:return 4;default:return 0}}},514:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.C=this.T=this.E=0;this.F=null;this.I=this.A=0;this.G=null}}Object(J.a)(h,
"ProofingTraceMetrics",null,[])},515:function(J,V,d){d.d(V,"a",function(){return m});d.d(V,"b",function(){return r});d.d(V,"c",function(){return v});var h=d(25),e=d(516);const m=()=>{const A=h.AFrameworkApplication.Ba.jb.vm;return(3===A||1===A||2===A||4===A)&&h.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled")},r=(A,x,y,u=!1)=>{x=1===x;1===A&&(x=2===h.AFrameworkApplication.Ba.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",e.a[A],x?"Editor":"Viewer",u?"Dime":"Unknown",y?y:"dimedefault")},
v=A=>{switch(A){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},516:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.excel=1]="excel";e[e.powerPoint=2]="powerPoint";e[e.word=3]="word";e[e.oneNote=4]="oneNote";e[e.visio=5]="visio"})(h||(h={}));Object(J.b)("OfficeAppType",h)},517:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);
class h{constructor(){this.slideId=null;this.k5g=this.Gkc=0}}Object(J.a)(h,"SlidePresenceInfo",null,[])},518:function(J,V,d){d.d(V,"a",function(){return r});J=d(0);var h=d(374),e=d(1019),m=d(33);class r{execute(v,A,x=null){h.ULS.sendTraceTag(572846934,380,50,"reqType:{0}",v.Lk());const y=new e.a,u=this.O6(v,A,x);u.continueWith(()=>{if(u.Sl)y.FF(u.Ti);else if(u.yn)y.s0();else{const H=u.result;if(H&&!H.succeeded&&H.Qi&&H.Qi.data&&5===u.result.Qi.data.status){const G=this.O6(v,A,x);G.continueWith(()=>
{G.Sl?y.FF(G.Ti):G.yn?y.s0():y.VL(G.result)})}else y.VL(H)}});return y.task}O6(v,A,x){x=this.V$i(x);return A(x,{"Content-Type":"application/json; charset=utf-8"},v.serialize())}V$i(v){return v?String.format("{0}/{1}",v,"people.ashx"):"people.ashx"}static q4a(v){if(!v)return h.ULS.sendTraceTag(572846935,380,10,"ResponseBodyTask from PeopleHandler is null"),null;try{return m.a(v)}catch(A){h.ULS.sendTraceTag(572846936,380,10,"Could not parse the response. Message: {0}",A.message)}return null}}Object(J.a)(r,
"CommonHandlerRequestManager",null,[])},519:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(374);class e{equals(m,r){if(!m||!r)return!m&&!r;if(m.UserId!==r.UserId){if(!e.YWf(m.Provider)||!e.YWf(r.Provider))return!1;const A=m.UserId.startsWith(e.cSb);var v=r.UserId.startsWith(e.cSb);if(A&&v){if(m.Provider!==r.Provider)return h.ULS.sendTraceTag(593368202,327,10,"Provider mismatch when both IDs are in AD format. Providers: {0} , {1}",m.Provider,r.Provider),!1;v=e.n0f(m.UserId);r=e.n0f(r.UserId);
return!!v&&v===r}m=m.Email&&""!==m.Email?m.Email:A?e.$4a(m.UserId):m.UserId;r=r.Email&&""!==r.Email?r.Email:v?e.$4a(r.UserId):r.UserId;return!!m&&m===r}return m.Provider!==r.Provider?!1:m.Provider&&""!==m.Provider||m.UserId&&""!==m.UserId?!0:m.DisplayName===r.DisplayName}o2(){return 0}static YWf(m){return"O365"===m||"AD"===m}static $4a(m){if(!m.startsWith(e.cSb))return null;m=m.substr(e.cSb.length);const r=m.lastIndexOf("::");return-1===r?null:m.substr(0,r)}static n0f(m){if(!m.startsWith(e.cSb))return null;
var r=m.lastIndexOf("::");if(-1===r)return null;r+=2;return r>=m.length?null:m.substr(r)}}e.cSb="S::";Object(J.a)(e,"CommentTaskPersonIdentityComparer",null,[139])},520:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.MessageId=e;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(J.a)(h,"CrossDocumentMessage",null,[])},521:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.additionalDataFields=this.otelEvent=null}}Object(J.a)(h,
"OtelTelemetryEvent",null,[])},522:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.previewControlIds=this.legacyControlId=this.populationProps=this.menuItemId=this.commandRevertId=this.commandPreviewId=this.queryCommandId=this.commandId=this.externalUxCommand=null;this.externalUxCommand=e;this.commandId=m}}Object(J.a)(h,"CommandMetadata",null,[])},523:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(298);class h{}h.CommandValueId="CommandValueId";h.Description=
"Description";h.Image16by16Class=d.a.ntb;h.Image30by30Class=d.a.Xrj;h.Image32by32Class=d.a.wCa;h.Image48by48Class=d.a.B4d;h.On="On";h.LabelText=d.a.labelText;h.Visible=d.a.visible;h.SourceControlId="SourceControlId";h.DisplayMode="DisplayMode";h.Alt=d.a.alt;Object(J.a)(h,"ToggleButtonCommandProperties",null,[])},524:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.Ru="InputMethod";h.qea="ShouldCanvasTakeFocus";h.gyh="UILocation";Object(J.a)(h,"ReactRibbonConstants",null,[])},525:function(J,
V,d){d.d(V,"a",function(){return h});J=d(0);class h{static get instance(){const {NewCustomEventFactory:e}=d(1080),{IECustomEventFactory:m}=d(1081);h.Ka||(h.Ka="function"===typeof window.CustomEvent?new e:new m);return h.Ka}}h.Ka=null;Object(J.a)(h,"CustomEventFactory",null,[])},526:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Igb=this.Jba=this.IX=null;this.QSc=this.hkc=!1;this.gxe=0;this.Tb=null;this.reset()}reset(){this.Jba=[];this.IX=null;this.Igb=[];this.QSc=
this.hkc=!1;this.gxe=0;this.Tb=null}}Object(J.a)(h,"HtmlPasteContext",null,[])},527:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.themeColors="Theme Colors";Object(J.a)(h,"ReactColorConstants",null,[])},538:function(J,V,d){J=d(0);var h=d(374),e=d(337),m=d(57),r=d(66),v=d(178),A=d(91),x=d(25);d(13);var y=d(33),u=d(48),H=d(99);class G{constructor(){this.vdb=this.o4=null;this.zvh=0}}Object(J.a)(G,"CandidateManager",null,[]);var E=d(644),I=d(642),Q=d(643);class D{constructor(){this.keyCode=
0;this.jyl=this.iyl=null}}Object(J.a)(D,"PredictionKeptState",null,[]);class Y{constructor(){this.values={}}Hkg(Fa,ka,qa){Fa=this.kdg(Fa);Fa[ka]=ka in Fa?Fa[ka]+qa:qa}add(Fa,ka,qa){this.kdg(Fa)[ka]=qa}ga(Fa){return this.values[Fa]}$(Fa,ka){return this.values[Fa]=ka}jPf(Fa){return Fa in this.values?!0:!1}kdg(Fa){let ka;Fa in this.values?ka=this.values[Fa]:(ka={},this.values[Fa]=ka);return ka}}Object(J.a)(Y,"PredictionState",null,[]);class M{constructor(){this.WordPredIsEnabled=!0;this.PredictionSeenCount=
0;this.PredictionAccepted=!1}}Object(J.a)(M,"TypeAheadRoamingSettings",null,[]);var N=d(197),W=d(1154),K=d(17),ca=d(889),P=d(645);d(891);var ea=d(890);class da{constructor(Fa){this.Koc=null;this.BC=Fa;Fa=m.a.instance.resolve("Common.IDynamicScriptLoaderProvider").gx;const ka=m.a.instance.resolve("Common.ISharedDependencyLoader");this.initialize(Fa,ka)}initialize(Fa,ka){const qa=new P.a;return Fa?ka?this.Koc?this.Koc:x.AFrameworkApplication.Ba.jb.dsg?this.Koc=new Promise((Ua,Ya)=>{const Va=x.AFrameworkApplication.Rj("al",
2);ka.Tvb(Va).continueWith(ua=>{ua.Sl?(this.pYg(),Ya(ua.Ti.message)):(this.klg(qa),Ua({}))})}):this.Koc=Fa.loadScript("al").then(()=>{this.klg(qa)}).catch(Ua=>{this.pYg();return Promise.reject(Ua)}):Promise.reject("SharedDependencyLoader is null"):Promise.reject("DynamicScriptLoader is null")}klg(Fa){da.QR.sF(()=>{h.ULS.sendTraceTag(595091613,3010,50,"AugLoop TextPrediction Load success");const ka=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();let qa=x.AFrameworkApplication.fa.Ia("OfficeApplicationName")||
"";qa=qa.replace("Web","");Fa.appName=Fa.appName||qa;Fa.serviceUrl=Fa.serviceUrl||x.AFrameworkApplication.fa.Ia("AugLoopCloudALServiceUrl");Fa.appVersion=Fa.appVersion||x.AFrameworkApplication.fa.Ia("BuildVersion")||"";Fa.releaseAudienceGroup=Fa.releaseAudienceGroup||(x.AFrameworkApplication.Zc?Object(W.a)(String,x.AFrameworkApplication.Zc.AudienceGroup)||"":"");Fa.sessionId=Fa.sessionId||x.AFrameworkApplication.fa.Ia("SessionId")||"";Fa.uiLanguage=Fa.uiLanguage||x.AFrameworkApplication.uiCulture;
Fa.flights=this.qWi();Fa.initSession=Fa.initSession||!0;ka.initialize(Fa);ka.activateAnnotation(Object.assign(new ca.a,{annotationType:ea.a.getTypeName(),handler:this.BC}))},"WordPredictionAL:Initialize")}pYg(){h.ULS.sendTraceTag(595091612,3010,50,"AugLoop TextPrediction Load Fail")}qWi(){var Fa=x.AFrameworkApplication.fa.Ia("FlightId"),ka=x.AFrameworkApplication.fa.JB("AugLoopFlightKeywordList");Fa=this.bPi(Fa,ka);ka="";0<Fa.length&&(ka=N.a.join(Fa,";"),h.ULS.sendTraceTag.apply(null,[595091610,3010,
50,"FlightCount: [{0}], flightIds: [{1}]",Fa.length].concat(Fa)));return ka}bPi(Fa,ka){const qa=new K.a;if(Fa&&""!==Fa&&ka&&0<ka.length){for(let Ua=0;Ua<ka.length;Ua++)ka[Ua]=ka[Ua].toLowerCase();Fa=Fa.toLowerCase().split(";");for(const Ua of Fa)N.a.any(ka,Ya=>-1<Ua.indexOf(Ya))&&qa.add(Ua)}return qa.toArray()}static get QR(){return e.a.instance}}Object(J.a)(da,"WordPredictionAugLoopHandler",null,[1264]);var ia=d(141),C=d(179),oa=d(139);class Z{constructor(Fa,ka,qa,Ua){this.JWb=null;this.zRg=Fa;this.pYk=
qa;this.Jhi=Ua;this.cYk=ka;this.FFc=Array(Fa);this.eeh();this.peh()}ctj(Fa,ka,qa){Fa>this.zRg-1||this.Gkg(this.FFc[Fa],ka,qa)}v7a(Fa,ka){this.Gkg(this.JWb,Fa,ka)}sFd(Fa,ka){this.JWb[Fa]=ka}flush(){Z.QR.sF(()=>{for(let Fa=0;Fa<this.FFc.length;Fa++){const ka=this.oVi(Fa);ka&&(ka.dataFields.push(Object.assign(new oa.a,{name:I.a.xO,int64:Fa})),ia.a.sendActivityEvent(ka))}this.eeh()},"WPT:F")}MRi(){Z.QR.sF(()=>{const Fa=this.nVi();Fa&&ia.a.sendActivityEvent(Fa);this.peh()},"WPT:FSD")}HRi(Fa){Z.QR.sF(()=>
{const ka=this.mVi(Fa);ka&&ia.a.sendActivityEvent(ka)},"WPT:FCD")}nVi(){const Fa=this.b_d(this.pYk);for(var ka=0;ka<Q.a.uPa.length;ka++)this.tFd(Q.a.uPa[ka],this.JWb,Fa.dataFields);for(ka=0;ka<Q.a.IZb.length;ka++)this.qSb(Q.a.IZb[ka],this.JWb,Fa.dataFields);return Fa.dataFields.length?Fa:null}oVi(Fa){const ka=this.b_d(this.cYk);for(let qa=0;qa<I.a.uPa.length;qa++)this.tFd(I.a.uPa[qa],this.FFc[Fa],ka.dataFields);return ka.dataFields.length?ka:null}mVi(Fa){const ka=this.b_d(this.Jhi);for(var qa=0;qa<
E.a.uPa.length;qa++)this.tFd(E.a.uPa[qa],Fa,ka.dataFields);for(qa=0;qa<E.a.IZb.length;qa++)this.qSb(E.a.IZb[qa],Fa,ka.dataFields);return ka.dataFields.length?ka:null}Gkg(Fa,ka,qa){Fa[ka]=ka in Fa?Fa[ka]+qa:qa}b_d(Fa){const ka=new C.a;ka.name=Fa;ka.dataFields=[];return ka}tFd(Fa,ka,qa){Fa in ka&&Array.add(qa,Object.assign(new oa.a,{name:Fa,int64:ka[Fa]}))}qSb(Fa,ka,qa){Fa in ka&&Array.add(qa,Object.assign(new oa.a,{name:Fa,string:ka[Fa]}))}eeh(){for(let Fa=0;Fa<this.zRg;Fa++)this.FFc[Fa]={}}peh(){this.JWb=
{}}static get QR(){return e.a.instance}}Object(J.a)(Z,"WordPredictionTelemetryHandler",null,[1263]);var pa=d(62),ya=d(31),Ja=d(371),Ka=d(300),ma=d(93);d(227);var ra=d(49),Da=d(32);d(456);d(425);d(1005);d.d(V,"a",function(){return va});class va{static get QR(){return e.a.instance}static get YC(){va.fpc||(va.fpc=new G);return va.fpc}static set YC(Fa){va.fpc=Fa}static get ZSc(){return va.Xyf}static set ZSc(Fa){va.Xyf=Fa}static get YCh(){va.GEd||(va.GEd=va.Wxi());return va.GEd}static get settings(){va.Cwc||
(va.Cwc=Object.assign(new M,{WordPredIsEnabled:!0,PredictionSeenCount:0,PredictionAccepted:!1}));return va.Cwc}static set settings(Fa){va.Cwc=Fa}static get gWa(){va.rzd||(va.rzd=new Y);return va.rzd}static get gil(){return va.pCi}static get W4(){va.IEd||(va.IEd=new Z(va.gil,"Office.Word.Online.WordPredictionTelemetryData","Office.Word.Online.WordPredictionTelemetryDataPerSession","Office.Word.Online.WordPredictionTelemetryDataPerCandidate"));return va.IEd}static get cBi(){return va.l2a?va.l2a.instance?
va.l2a.instance.Q1:1:(va.l2a=m.a.instance.Oa("Common.IZoomManager"),va.l2a&&va.l2a.instance?va.l2a.instance.Q1:1)}static get characterPropertiesEditor(){va.vpd||(va.vpd=m.a.instance.resolve("Box4.ICharacterPropertiesEditor"));return va.vpd}static get S$c(){va.Dzd||m.a.instance.Oa("Box4.Proofing.IProofingSentenceSeparator").execute(Fa=>{Fa&&(va.Dzd=Fa)});return va.Dzd}static get kyl(){va.HEd||(va.HEd=m.a.instance.resolve("Box4.WordPrediction.IWordPredictionSettingsInfo"));return va.HEd}static jVk(){window.setTimeout(()=>
{const Fa={};Fa.WordPredIsEnabled=va.settings.WordPredIsEnabled;Fa.PredictionSeenCount=va.settings.PredictionSeenCount;Fa.PredictionAccepted=va.settings.PredictionAccepted;va.kyl.hBl(y.c(Fa))},va.NTf)}static E2d(Fa,ka){if(!Fa||!ka||Fa.eventName!==r.a.bNa)return!1;const qa=Fa.nc.keyCode;if(va.Hqg(ka)){va.yIk();ka=ka.node;if((qa===v.a.vO||qa===v.a.tq)&&va.HRa)return A.a.Wm(Fa.nc),va.Jxj(ka),va.Vsl(qa),h.ULS.sendTraceTag(578307398,820,50,"Prediction Text Accepted"),!0;if(qa===v.a.wO)va.ZSc&&(va.ZSc=
!1);else if(qa===v.a.B0&&va.HRa)va.ZSc=!0,h.ULS.sendTraceTag(578307397,820,50,"Prediction Text Rejected"),va.QQa();else if(qa===v.a.PJb&&Fa.nc.ctrlKey&&va.qzd)return h.ULS.sendTraceTag(578307396,820,50,"Prediction Undid"),va.neh(),!1}if(qa===v.a.sJb&&Fa.nc.shiftKey||qa===v.a.Rea&&Fa.nc.ctrlKey||qa===v.a.mZa&&Fa.nc.altKey)return!1;ka=va.YC.o4;const Ua=qa===v.a.OX||qa===v.a.k5||qa===v.a.Sea||qa===v.a.q$;if(Ua||Ua&&(Fa.nc.ctrlKey||Fa.nc.shiftKey)||qa!==v.a.Rea&&Fa.nc.ctrlKey||qa!==v.a.mZa&&Fa.nc.altKey||
qa===v.a.fH||va.HRa&&ka&&0<ka.i7.length&&!ka.i7.toLowerCase().startsWith(String.fromCharCode(qa).toLowerCase()))va.QQa(),va.YC.o4=null,h.ULS.sendTraceTag(578307395,820,50,"Prediction hidden due to user typing a character that did not match prediction");va.neh();return!1}static Gmj(){5>va.settings.PredictionSeenCount&&(va.settings.PredictionSeenCount+=1)}static QQa(){Ja.a.QQa();va.HRa=!1}static Jxj(Fa){va.QR.sF(()=>{var ka=document.getElementById("inlinePredictedWord");if(ka){var qa=ka.innerText;if(qa&&
0<qa.length&&(Fa=Fa?Fa:va.b7i())){var Ua=new u.GraphTransaction(7);Ua.hd(Fa);var Ya=Fa.Ra.last,Va=ra.a.PNa(Fa),ua=ma.a.xs(Va);Ya.formatting=ua.Vd(Ya);va.characterPropertiesEditor.replaceTextRange(Va,qa,!0,!0,Da.a.typing);Ua.dispose();qa=H.InteractiveViewManager.instance.Jd;Ua=Fa.yg(qa.Na);Ua=Ka.a.it(Ua,ya.ParagraphReader.textLength(Fa));Ya=new Sys.UI.Point(Ua.x,Ua.y);Ya.y+=Ua.height;qa.f5(Ya,null,null,qa,!1);va.HRa=!1;ka.innerText="";(ka=document.getElementById("inlinePlaceholderTab"))&&va.whg()&&
(ka.className="hidePanel")}}},"WPT:IIG")}static T0k(Fa){va.Btf=Fa;va.W4.sFd(Q.a.modelId,Fa.modelId);va.W4.sFd(Q.a.modelVersion,Fa.modelVersion);va.W4.sFd(Q.a.configId,Fa.configId)}static u5i(){return va.Btf}static JHd(Fa,ka){const qa=va.YCh;var Ua=document.getElementById("inlinePredictedWord");Ua&&(Ua.innerText=ka,(ka=document.getElementById("WACViewPanel_EditingElement_WrappingDiv").getElementsByClassName("TextRun"))&&0<ka.length&&(ka=ka[ka.length-1],Ua.style.fontSize=ka.style.fontSize,Ua.style.fontFamily=
ka.style.fontFamily,Ua.style.color=ka.style.color,Ua.style.whiteSpace="pre",Ua=Ua.parentNode,Fa="suggestion: "+Fa,ka=document.getElementById("inlinePlaceholderTab"),ka.className="hidePanel",ka&&va.whg()&&(ka.className="inlinePlaceholderTab",Fa+=". Tab to accept"),Ua.parentNode.setAttribute("aria-label",Fa)),qa&&(qa.className="textareaCaretTracker"),va.E1k()&&(va.HRa=!0,h.ULS.sendTraceTag(578307393,820,50,"Ghost Text Visible")))}static Hqg(Fa){Fa||(Fa=va.QYi());if(Fa){const ka=Fa.node;try{return ya.ParagraphReader.textLength(ka)<=
Fa.Qa}catch(qa){}}return!1}static ZSj(Fa){Fa=va.gWa.ga(Fa);Fa=Fa[Q.a.kHd]-Fa[Q.a.Ekc];300<Fa?(va.W4.v7a(Q.a.uUf,Fa),va.W4.v7a(Q.a.tUf,1)):(va.W4.v7a(Q.a.vGf,Fa),va.W4.v7a(Q.a.IDf,1))}static EVd(Fa){va.ysg("TextPredictionTelemetryIsEnabled")&&va.W4.HRi(Fa)}static Vzg(Fa,ka){Fa=va.gWa.ga(Fa);const qa=Fa[Q.a.Ekc];ka?va.W4.v7a(Q.a.Jph,Fa[Q.a.JDf]-qa):va.W4.v7a(Q.a.Iph,Fa[Q.a.HDf]-qa)}static F5b(Fa){va.W4.v7a(Fa,1)}static Bsa(Fa,ka,qa){va.W4.ctj(Fa,ka,qa)}static hdd(){va.YC.o4=null;va.YC.vdb=null}static Dwk(){va.ghb("TextPredictionsSeen",
"TextPredictionsSeenIsEnabled");va.Gmj();va.fzj()}static ghb(Fa,ka){va.ysg(ka)&&window.setTimeout(()=>{const qa=m.a.instance.Oa("Common.ISystemInitiatedFeedback");qa&&qa.execute(Ua=>{Ua.logActivity(Fa,ka)})},va.NTf)}static ysg(Fa){return!!x.AFrameworkApplication.fa&&x.AFrameworkApplication.fa.ka(Fa)}static Wxi(){var Fa=document.body;const ka=document.createElement("div");if(Fa){Fa.appendChild(ka);ka.setAttribute("id","textareaCaretTracker");ka.className="hidePanel";ka.setAttribute("role","alert");
Fa=document.createElement("button");const qa=document.createElement("span");Fa.setAttribute("disabled",!0);Fa.setAttribute("aria-disabled",!0);Fa.setAttribute("aria-hidden",!0);qa.setAttribute("aria-disabled",!0);qa.setAttribute("aria-hidden",!0);qa.setAttribute("id","inlinePredictedWord");qa.className="inlinePredictedWord";Fa.className="inlinePredictedWordButton";Fa.appendChild(qa);ka.appendChild(Fa);ka.appendChild(va.Dzi());(Fa=document.getElementById("WACViewPanel"))&&$addHandler(Fa,"scroll",va.Okj)}return ka}static E1k(){const Fa=
va.YCh;var ka=document.getElementById("WACViewPanel_EditingElement_WrappingDiv");ka=(ka=ka?ka.getElementsByClassName("EOP")[0]:null)?ka.getBoundingClientRect():null;return Fa&&ka?(Fa.style.cssText="transform: scale("+va.cBi+"); transform-origin: 0% 0%",Fa.style.top=ka.top+"px",Fa.style.left=ka.left+"px",!0):!1}static whg(){return!va.settings.PredictionAccepted}static fzj(){5!==va.settings.PredictionSeenCount||va.settings.PredictionAccepted||(va.ghb("PredictionNotAccepted","PredictionNotAcceptedIsEnabled"),
va.jVk())}static Dzi(){const Fa=document.createElement("button");Fa.setAttribute("aria-hidden",!0);Fa.className="hidePanel";Fa.id="inlinePlaceholderTab";Fa.disabled=!0;Fa.innerText="Tab";return Fa}static Okj(){va.QQa()}static b7i(){const Fa=pa.a.instance.Pa.kb;return Fa&&Fa.We?Fa.We.node:null}static yIk(){va.cDd||(va.cDd=window.setTimeout(va.njj,6E4*va.oCi))}static njj(){va.W4.flush();va.W4.MRi();va.cDd=0}static m$f(Fa){return Fa&&0<Fa.length&&(Fa=Fa.split(" "),0<Fa.length)?Fa[Fa.length-1].length:
-1}static Vsl(Fa){const ka=va.YC.o4,qa=va.YC.vdb;ka&&(va.qzd=Object.assign(new D,{keyCode:Fa,iyl:ka,jyl:qa}))}static QYi(){const Fa=pa.a.instance.Pa.kb;return Fa&&Fa.We?Fa.We:null}static neh(){va.qzd=null}}va.pCi=30;va.oCi=5;va.NTf=5E3;va.GEd=null;va.Dzd=null;va.vpd=null;va.l2a=null;va.Xyf=!1;va.cDd=0;va.IEd=null;va.rzd=null;va.qzd=null;va.HEd=null;va.Cwc=null;va.Btf=null;va.fpc=null;va.HRa=!1;Object(J.a)(va,"WordPredictionHandler",null,[])},641:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);
class h{}h.tck="NoCharacterPositionOnLine";h.vck="NoCharacterPositionOnSpan";h.uck="NoCharacterPositionOnMultilineSpan";h.uXb="DoNothingResult";h.Fha="FailedProcessingStep";h.d5a="FailedResult";h.fJc="FirstChildNotText";h.CQi="FirstChildNull";h.oyj="InvalidCharacterPositionResult";h.qh="NoExecute";h.yo="NoApply";h.v0="UnexpectedState";Object(J.a)(h,"ActivityEventName",null,[])},642:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.xO="WordIndex";h.Qch="RenderedCandidateCount";h.VTg=
"NotRenderedCandidateCount";h.XKf="CandidateListCount";h.VSf="CumulativeIndexOfSeen";h.MAi="CumulativeIndexOfRejected";h.LAi="CumulativeIndexOfKept";h.USf="CumulativeIndexOfCorrect";h.KAi="CumulativeIndexOfAcceptedCandidate";h.qhh="SeenCount";h.nKk="RejectedCount";h.QOj="KeptCount";h.Zxh="TypedThroughCount";h.NAi="CumulativeScoreOfKept";h.OAi="CumulativeScoreOfRejected";h.XSf="CumulativeScoreOfTypeThrough";h.Rch="RenderedCharSum";h.POj="KeptCharSum";h.OOj="KeptCandidateTokenSum";h.bpl="UndoOfKeptCount";
h.epl="UndoneKeptCharCount";h.$xh="TypedThroughLastMatchingCharCount";h.language="Language";h.uPa=[h.Qch,h.VTg,h.XKf,h.VSf,h.MAi,h.LAi,h.USf,h.KAi,h.qhh,h.nKk,h.QOj,h.Zxh,h.NAi,h.OAi,h.XSf,h.Rch,h.POj,h.OOj,h.bpl,h.epl,h.$xh,h.language];Object(J.a)(h,"DataFieldsPerSentence",null,[])},643:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.modelId="ModelId";h.configId="ConfigId";h.modelVersion="ModelVersion";h.Bwk="PredictionAcceptedByTab";h.Awk="PredictionAcceptedByRightArrow";h.vGf=
"AugLoopResponseTime";h.Jph="SignalRenderedTime";h.Iph="SignalNotRenderedTime";h.uUf="DelayedResponseTime";h.Xal="SignalGeneratedCount";h.IDf="AnnotationReceivedCount";h.V4g="PredictionRenderedCount";h.U4g="PredictionNotRenderedCount";h.DSd="EmptyPredictionResponseCount";h.Tph="SkippedPredictionResponseCount";h.tUf="DelayedResponseCount";h.Fck="NonEnglishSkipCount";h.Ekc="SignalGenerationTime";h.kHd="AnnotationReceivedTime";h.JDf="AnnotationRenderedTime";h.HDf="AnnotationNotRenderedTime";h.uPa=[h.Awk,
h.Bwk,h.vGf,h.Jph,h.Iph,h.uUf,h.Xal,h.IDf,h.V4g,h.U4g,h.DSd,h.Tph,h.tUf,h.Fck];h.IZb=[h.modelId,h.configId,h.modelVersion];Object(J.a)(h,"DataFieldsPerSession",null,[])},644:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.language="Language";h.wLd="CharIndex";h.BCc="CharIndexRendered";h.Zxg="KeptCharCount";h.modelId="ModelId";h.T4g="PredictionLength";h.W4g="PredictionTokenCount";h.score="Score";h.status="Status";h.rRe="TypedThroughCharCount";h.xO="WordIndex";h.modelVersion="ModelVersion";
h.dvh="TimeTakenAugloop";h.Pjd="TimeToRender";h.configId="ConfigId";h.uPa=[h.wLd,h.BCc,h.Zxg,h.T4g,h.W4g,h.score,h.status,h.rRe,h.xO,h.dvh,h.Pjd];h.IZb=[h.language,h.modelId,h.configId,h.modelVersion];Object(J.a)(h,"DataFieldsPerCandidate",null,[])},645:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.powerpoint=this.downloadPolymerBaseUrl=this.inferenceServiceVersion=this.downloadBaseUrl=this.sessionCreationOptions=this.disabledServiceGroups=this.privateMode=this.flights=
this.excelServer=this.initSession=this.sessionId=this.releaseFork=this.releaseChannel=this.releaseAudienceGroup=this.uiLanguage=this.appVersion=this.appName=this.serviceUrl=null}}Object(J.a)(h,"InitializeParameters",null,[])},646:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.FEa=!0;this.yWc=this.f2c=this.H3c=this.W_c=null;this.vja=e}copy(){return new h(this.vja.copy())}move(e,m){this.FEa=!0;this.vja.move(e,m)}setOffsets(e){this.FEa=!0;this.vja.setOffsets(e)}$f(){return this.vja.$f()}get fc(){this.nld();
return this.W_c}get ic(){this.nld();return this.H3c}get $b(){this.nld();return this.f2c}get Xb(){this.nld();return this.yWc}nld(){if(this.FEa){var e=this.vja.points;this.W_c=this.f2c=e[0].x;this.H3c=this.yWc=e[0].y;for(const m of e)this.W_c=Math.min(this.W_c,m.x),this.H3c=Math.min(this.H3c,m.y),this.f2c=Math.max(this.f2c,m.x),this.yWc=Math.max(this.yWc,m.y);this.FEa=!1}}}Object(J.a)(h,"Boundary",null,[])},647:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.aJ=e}}Object(J.a)(h,"SessionEndedEventArgs",Sys.EventArgs,[])},648:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(57);class e{constructor(m){this.Bzg=this.errorType=0;this.originalText=this.token=null;this.$Ga=this.G9=this.lcid=0;this.GCh=!1;this.Xpf=m}O8d(){const m=this.token?this.token:null;return 0!==this.errorType&&e.Rrj.contains(m,this.lcid)}static get Rrj(){return e.MKa||(e.MKa=h.a.instance.resolve("Box4.Proofing.IIgnoreAllKeywords"))}}e.MKa=null;Object(J.a)(e,"ProofingErrorDetails",
null,[267])},649:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.Load=0]="Load";e[e.Edit=1]="Edit"})(h||(h={}));Object(J.b)("UserAction",h)},650:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);V=d(107);class h extends V.a{constructor(){super();this.Input=null;this.Lcid=0;this.UserActionType=this.PostContextText=this.PreContextText=null;this.ApplicationMode=0}Lk(){return 4}static mTi(e,m){const r=new h;h.aye(r,e,m);r.UserActionType=e.paragraphNode.wNb?"Edit":"Load";
return r}static aye(e,m,r){e.Lcid=m.range.lcid;e.Input=m.Lla.substring(m.range.begin,m.range.end);e.ApplicationMode=r;0<=m.range.G9&&(e.PreContextText=m.Lla.substring(m.range.G9,m.range.begin));0<=m.range.$Ga&&(e.PostContextText=m.Lla.substring(m.range.end,m.range.$Ga))}static S$i(e,m,r,v,A,x,y,u){const {SpellingRequestObjectUpdatedV2:H}=d(1070),{SpellingRequestObjectUpdated:G}=d(1071);return u?H.wWd(m,r):e?G.wWd(m,r,v,A,x,y):h.mTi(m,r)}}Object(J.a)(h,"SpellingRequestObject",V.a,[])},651:function(J,
V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(79);class e{static Amb(m,r,v="GenericCommentsTask"){v=new h.a(2,1,0,()=>{r()},92,v);m.Hb(v)}static Yt(m){return Error.create("SDXHostAPI Error : "+m,{["SDXHostAPIErrorCode"]:m})}}Object(J.a)(e,"OfficeSharedCommentsUtils",null,[])},652:function(J,V,d){d.d(V,"a",function(){return r});J=d(0);var h=d(374);V=d(710);var e=d(995),m=d(897);class r extends V.a{constructor(v,A,x=null){super(v,A,x||e.a.instance,r.Uuj)}static Uuj(){m.a.sendTraceTag=r.XXk;m.a.debugAssertTag=
r.xBi}static XXk(v,A,x,...y){h.ULS.sendTraceTag.apply(null,[v,204,r.rAi(A),x].concat(y))}static xBi(){}static rAi(v){switch(v){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}r.eze="wdPreviousSession";r.eTf="wdUserSession";Object(J.a)(r,"CommonCrossDocumentMessenger",V.a,[])},653:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(374),e=d(25);class m{static E1d(r,v){let A=null;if(r&&0<r.length&&v&&0<v.length){const x=window[v];
x?x&&r in x?A=x[r]:h.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+r+" from dictionary "+v):h.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+v)}return A}static y8d(){const r=e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLatestVersionIsEnabled",!1);r?h.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "):h.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version");return r}}Object(J.a)(m,
"CommonUtils",null,[])},654:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.type=null;this.type=e}}Object(J.a)(h,"CustomContentProps",null,[])},655:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(298);class h{}h.LabelText=d.a.labelText;h.LabelTextUserGeneratedPlaceholderReplacements=d.a.jPj;h.Visible=d.a.visible;h.ImageIsVisible="ImageIsVisible";h.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible";h.Image16by16Class=d.a.ntb;h.Image32by32Class=
d.a.wCa;h.Image48by48Class=d.a.B4d;h.ImageBackColor="ImageBackColor";h.On="On";h.SourceControlId="SourceControlId";Object(J.a)(h,"FlyoutAnchorCommandProperties",null,[])},656:function(J,V,d){d.d(V,"a",function(){return x});J=d(0);var h=d(262),e=d(25),m=d(349),r=d(194),v=d(96),A=d(63);class x{static gXa(y){let u,H;({Akl:u,Bkl:H}=x.vPi());x.oVk(u,H,y)}static vPi(){({B1b:u}=m.a.AIb(!e.AFrameworkApplication.LP));var y=$get(h.CuiHelper.Lpj);if(u)var u=document.getElementById(h.CuiHelper.UTd);else u=y.childNodes[0],
y=y.childNodes[1];return{Akl:u,Bkl:y}}static oVk(y,u,H){if(y&&u&&0<u.clientHeight){const G=-1!==u.parentNode.parentNode.className.indexOf("cui-ribbon");x.Ngh(y,u,H,G)}}static Ngh(y,u,H,G){let E=null,I=null,Q=null,D=null,Y=null,M=null,N=null,W=null,K=null,ca=null,P=null,ea=null,da=null,ia=null,C=null,oa=null,Z=null,pa=null,ya=null,Ja=null;({qYf:E,pYf:I,rYf:Q,H4a:D,I4a:Y,EOa:M,aS:N,Ku:W,FOa:K,tP:ca,GOa:P,sYf:Ja}=x.Z1f(y,E,I,Q,D,Y,M,N,W,K,ca,P,Ja));({SXb:ea,fG:da,oYf:ia,mYf:C,J4a:oa,iqb:Z,jqb:pa,nYf:ya}=
x.y2f(u,ea,da,ia,C,oa,Z,pa,ya));y=[E,I,Q,D,Y,M,N,W,K,ca,P,ia,C,oa,Z,pa,ya,Ja];for(var Ka of y)x.H9k(Ka);Ka=[E,I,Q,Y,N,W,ca,P,C,Z,pa,ya];for(const ma of Ka)x.ORe(ma);x.meh(I);x.zjh(da,0);x.rKi(E,I,Q,D,Y,M,N,W,K,ca,P,ea,da,ia,C,oa,Z,pa,ya,Ja,G,H);x.l5h(M,N)}static rVk(y,u){x.Ngh(y,null,u,!1)}static l5h(y,u){y&&u&&(y.style.marginTop=(u.offsetHeight-y.offsetHeight)/2+"px")}static Z1f(y,u,H,G,E,I,Q,D,Y,M,N,W,K){for(let ca=0;y&&ca<y.childNodes.length;ca++){const P=y.childNodes[ca],ea=v.a.Rha(P),da=!!P.id;
-1!==ea.indexOf("cui-QATRowLeft")?u=P:-1!==ea.indexOf("cui-QATRowCenter")?H=P:-1!==ea.indexOf("cui-QATRowRight")?G=P:-1!==ea.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?E=P:P.id===h.CuiHelper.EJd?I=P:P.id===h.CuiHelper.J3f?Q=P:P.id===h.CuiHelper.FJd?D=P:P.id===h.CuiHelper.GJd?Y=P:da&&x.hDj(P)?M=P:-1!==ea.indexOf("UsernameNameContainer")?N=P:-1!==ea.indexOf("UsernameNameItem")?W=P:-1!==ea.indexOf("FreemiumUpsellButton")&&(K=P);({qYf:u,pYf:H,rYf:G,H4a:E,I4a:I,EOa:Q,aS:D,Ku:Y,FOa:M,tP:N,GOa:W,sYf:K}=
x.Z1f(P,u,H,G,E,I,Q,D,Y,M,N,W,K))}return{qYf:u,pYf:H,rYf:G,H4a:E,I4a:I,EOa:Q,aS:D,Ku:Y,FOa:M,tP:N,GOa:W,sYf:K}}static y2f(y,u,H,G,E,I,Q,D,Y){for(let M=0;y&&M<y.childNodes.length;M++){const N=y.childNodes[M],W=v.a.Rha(N),K=!!N.id;-1!==W.indexOf("cui-jewel-container")?u=N:-1!==W.indexOf("cui-tts")?H=N:-1!==W.indexOf("cui-TabRowInline")?E=N:-1!==W.indexOf("cui-TabRowRight")?Y=N:-1!==W.indexOf("cui-separator")?G=N:K&&N.id.startsWith(h.CuiHelper.C0g)&&!I?I=N:K&&N.id.startsWith(h.CuiHelper.s1f)?Q=N:K&&
N.id.startsWith(h.CuiHelper.txe)&&(D=N);({SXb:u,fG:H,oYf:G,mYf:E,J4a:I,iqb:Q,jqb:D,nYf:Y}=x.y2f(N,u,H,G,E,I,Q,D,Y))}return{SXb:u,fG:H,oYf:G,mYf:E,J4a:I,iqb:Q,jqb:D,nYf:Y}}static nVk(y,u,H,G,E,I,Q,D,Y){x.EQ(y,u,Y)&&(x.TOc(u),x.EQ(y,u,Y)&&x.TOc(u));x.EQ(u,G,Y)&&(x.uK(H),x.uK(E),x.EQ(u,G,Y)&&(x.TOc(u),x.EQ(u,G,Y)&&(x.TOc(u),x.EQ(u,G,Y)&&x.uK(G))));x.EQ(G,D,Y)&&(x.uK(H),x.uK(E));y=[I,Q,D];x.Xig(G,D,y,Y);x.Xig(u,D,y,Y)}static Xig(y,u,H,G){let E=0;for(;E<H.length&&x.EQ(y,u,G);)x.uK(H[E]),E++}static j$i(y){if(!y)return 0;
if(void 0===y._scaleStep||null===y._scaleStep){let u=0;-1!==y.className.indexOf("cui-tts-scale1")?u=1:-1!==y.className.indexOf("cui-tts-scale2")&&(u=2);y._scaleStep=u}return parseInt(y._scaleStep)}static TOc(y){let u=x.j$i(y);2>u&&x.zjh(y,++u)}static zjh(y,u){y&&(y.className=x.XSk[u],y._scaleStep=u)}static EQ(y,u,H){return y&&u?A.a.Myg(A.a.ei(y),A.a.ei(u),H):!1}static pCb(y,u,H){let G=0;y&&u&&(G=A.a.pbe(A.a.ei(y),A.a.ei(u),H));return G}static INd(y){for(let u=0;y&&u<y.childNodes.length;u++)if(-1!==
y.childNodes[u].className.indexOf("cui-cg"))return!0;return!1}static GYd(y){let u=null;for(let H=y.childNodes.length-1;y&&0<=H;H--){const G=y.childNodes[H];if(-1===G.className.indexOf("cui-cg"))break;u=G}return u}static yIb(y,u,H){if(y&&!x.zn(y)){var G=r.a.Nu(y);G=v.a.wL(G.paddingLeft)+v.a.wL(G.paddingRight);H=y.offsetWidth-H-G;let E=0;for(;u&&u!==y;)(G=r.a.Nu(u))&&(E+=v.a.wL(G.paddingLeft)+v.a.wL(G.paddingRight)),u=u.parentNode;H=Math.max(H,75+E);y.style.width=H+"px"}}static oQk(y,u,H){if(y&&u){let G=
0,E=0;({left:G,top:E}=A.a.u8f(u,G,E));x.ebk(y,H?G-y.offsetWidth:G+u.offsetWidth)}}static rKi(y,u,H,G,E,I,Q,D,Y,M,N,W,K,ca,P,ea,da,ia,C,oa,Z,pa){Z&&x.nVk(W,K,ca,P,ea,da,ia,C,pa);x.INd(K)?x.wVk(K,y,u,H,G,E,I,Q,D,Y,M,N,oa,pa):x.vVk(y,u,H,G,E,I,Q,D,Y,M,N,oa,pa)}static vVk(y,u,H,G,E,I,Q,D,Y,M,N,W,K){const ca=!!E,P=!!Q,ea=!!D;let da=0;if((P||ea)&&0<(da=x.pCb(y,u,K))){let ia=P;ea&&(!P||D.offsetWidth>Q.offsetWidth)&&(ia=!1);x.yIb(ia?Q:D,ia?Q:D,ia?da:2*da);P&&ea&&0<(da=x.pCb(y,u,K))&&x.yIb(ia?Q:D,ia?Q:D,ia?
da:2*da)}if(P&&x.EQ(Q,u,K)||ca&&x.EQ(E,u,K))x.uK(G),x.uK(E),x.uK(I),x.uK(Q),ea&&(x.ORe(u),x.ORe(D));x.yah(u,H,D,Y,M,N,W,K);ea&&x.aLf(D,y,H,K)}static wVk(y,u,H,G,E,I,Q,D,Y,M,N,W,K,ca){const P=!!D,ea=!!Y,da=!!M,ia=!!K,C=x.GYd(y);0<(u=x.pCb(u,C,ca))&&(P&&x.yIb(D,D,u),!P||x.EQ(D,C,ca))&&(x.uK(E),x.uK(I),x.uK(Q),x.uK(D));x.EQ(y,H,ca)&&x.oQk(H,y,ca);x.yah(H,G,Y,M,N,W,K,ca);0<(u=x.pCb(y,G,ca))&&(x.yIb(N,W,u),ia&&x.EQ(y,G,ca)&&x.uK(K),da&&x.EQ(y,G,ca)&&x.uK(M));ea&&!x.zn(H)&&x.aLf(Y,y,G,ca)}static yah(y,
u,H,G,E,I,Q,D){const Y=!!H,M=!!G,N=!!E,W=!!Q;let K=0;if((Y||N)&&0<(K=x.pCb(y,u,D))){const ca=!!y&&"absolute"!==y.style.position;let P=Y;N&&(!Y||E.offsetWidth>H.offsetWidth)&&(P=!1);x.yIb(P?H:E,P?H:I,P&&ca?2*K:K);Y&&N?(0<(K=x.pCb(y,E,D))&&(P=!P,x.yIb(P?H:E,P?H:I,P&&ca?2*K:K)),x.EQ(y,E,D)&&x.uK(y)):Y&&x.EQ(y,u,D)&&x.uK(y)}W&&x.EQ(y,u,D)&&x.uK(Q);M&&x.EQ(y,u,D)&&x.uK(G)}static zn(y){if(!y)return!0;y=y._isHidden;return!(void 0===y||null===y||"0"===y)}static uK(y){y&&!x.zn(y)&&(y.style.display="none",
y._isHidden="1")}static H9k(y){y&&x.zn(y)&&(y.style.display="",y._isHidden="0")}static ORe(y){y&&(y.style.width="auto",y.style.maxWidth="none")}static ebk(y,u){y&&(y.style.position="absolute",y.style.left=u+"px")}static meh(y){y&&(y.style.position="static",y.style.left="auto")}static aLf(y,u,H,G){if(y&&y.parentNode&&y.parentNode.parentNode){var E=x.nsk(y);"auto"!==y.parentNode.style.width&&(y.style.width=y.parentNode.offsetWidth-E+"px");var I=G?H:u;u=G?u:H;H=A.a.ei(y.parentNode.parentNode);I=I?A.a.ei(I):
new Sys.UI.Bounds(H.x,0,0,0);u=u?A.a.U5a(u):new Sys.UI.Point(H.x+H.width,0);"absolute"===y.parentNode.style.position?E=u.x-(I.x+I.width)-E-1:(H=A.a.ei(y.nextSibling?y.parentNode:y),H=H.x+H.width/2,E=2*Math.min(H-(I.x+I.width),u.x-H)-E-1);y.style.maxWidth=E+"px"}}static nsk(y){var u=r.a.Nu(y);u=u?v.a.wL(u.paddingLeft)+v.a.wL(u.paddingRight):0;var H=r.a.Nu(y.parentNode);H=H?v.a.wL(H.paddingLeft)+v.a.wL(H.paddingRight):0;let G=0;for(;y.nextSibling;)y=y.nextSibling,G+=y.offsetWidth;return u+H+G}static hDj(y){return!!y.id&&
(y.id.startsWith(h.CuiHelper.DJe)||y.id.startsWith(h.CuiHelper.Wcd))}}x.XSk=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(J.a)(x,"RibbonTabScalingActor",null,[])},657:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(374),e=d(13),m=d(25),r=d(141),v=d(57),A=d(179),x=d(139);class y{constructor(){this.cMa=null;this.luf=!1}eRe(){try{this.cMa||(this.cMa=v.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"),this.luf=!!m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.EnableOAuthMgrForService",
!1))}catch(u){h.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+u)}}F4i(){this.eRe();return this.cMa?this.cMa.getToken("Search",m.AFrameworkApplication.yce,!1):null}vdg(){if("Dev Box"===m.AFrameworkApplication.fa.Ia("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(u=>{window.setTimeout(()=>{u(window.TellMeSubstrateTokenOverride)},750)});this.eRe();return this.cMa?this.cMa.getToken("Search",
m.AFrameworkApplication.uNe,!0):null}bdj(){this.eRe();return this.cMa?this.cMa.getToken("Search",this.Zcj(),this.luf):null}Zcj(){return m.AFrameworkApplication.fa.Ia("TellMeServiceAuthEndpointForSearch")}G4i(){return Object(e.a)(this,this.F4i,"getLokiTokenPromise")}kcj(){return Object(e.a)(this,this.vdg,"getSubstrateTokenPromise")}zGb(){return!!m.AFrameworkApplication.Ba&&m.AFrameworkApplication.Ba.jb.zGb}Ndj(){const u={};this.zGb()&&(u.Loki=this.G4i(),u.Substrate=this.kcj());return u}L5b(u){r.a.SHa(Object.assign(new A.a,
{name:"Events",dataFields:[Object.assign(new x.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new x.a,{name:"Status",bool:u})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}eSj(){return m.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.L5b(!1);return!1}).then(()=>{this.L5b(!0);return!0}):new Promise((u,H)=>{const G=v.a.instance.resolve("Common.IDynamicScriptLoaderProvider").gx;G?G.loadScript("tellme-strings").then(()=>
{this.L5b(!0);u(!0)}).catch(()=>{this.L5b(!1);H(!1)}):(this.L5b(!1),H(!1))})}static BKj(){return!!m.AFrameworkApplication.Ba&&(m.AFrameworkApplication.Ba.jb.K4b||m.AFrameworkApplication.Ba.jb.evb)}static oTc(){return!!m.AFrameworkApplication.Ba&&m.AFrameworkApplication.Ba.jb.evb}}Object(J.a)(y,"ReactSharedHeaderSearchUtils",null,[])},658:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(374),e=d(45),m=d(911),r=d(27),v=d(41),A=d(75),x=d(31);class y{constructor(u=2E3){this.mLa=u}uCj(){const u=
y.mV();return this.CNj(u)}CNj(u){return 0<this.VMc(u).mentionLength}getSelectedText(){const u=y.mV();return this.VMc(u)}VMc(u){return this.G$i(u)}G$i(u){var H=null;u&&u.Paa&&v.SelectionEditor.Mg(u.Wa)&&v.SelectionEditor.bvb(u.Wa)&&(h.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),H=v.SelectionEditor.TOa(u.Wa,!1));H&&(u=H);if(!u)return Object.assign(new m.a,{neighborhood:"",mentionStart:0,mentionLength:0});const G=new Sys.StringBuilder;let E=H=0;const I=[],
Q=u.length;for(let Y=0;Y<Q;Y++){const M=u.ga(Y);if(!x.ParagraphReader.Pd(M.node)||Array.contains(I,M.node.nJa))continue;I.push(M.node.nJa);let N=x.ParagraphReader.text(M.node),W=0;var D=x.ParagraphReader.ora(M.node,!0,!0,!0);let K=x.ParagraphReader.ora(M.node,!1,!0,!0),ca=0;for(;N.length<this.mLa&&(D||K);){if(!(ca%2)&&D){const P=x.ParagraphReader.text(D);N=P+" "+N;W+=P.length+1;D=x.ParagraphReader.ora(D,!0,!0,!0)}1===ca%2&&K&&(N=N+" "+x.ParagraphReader.text(K),K=x.ParagraphReader.ora(K,!1,!0,!0));
ca++}D=Y===Q-1;Y||-1===M.Qa||(H=M.Qa);E+=D&&-1!==M.Lb?M.Lb:N.length;G.append(N);H+=W;E+=W;D||(G.append(" "),E++)}for(u=A.AParagraphNode.qcd(G.toString()," ");H<E&&e.a.vy(u.charCodeAt(H));)H++;for(;E>H&&e.a.vy(u.charCodeAt(E-1));)E--;return this.J5h(u,H,E)}J5h(u,H,G){if(u.length>this.mLa){var E=G-H;if(E>this.mLa)u=u.substr(H,this.mLa),G=this.mLa,H=0;else{E=Math.max(H-Math.floor((this.mLa-E)/2),0);let I;I=Math.min(E+this.mLa,u.length);E=Math.max(I-this.mLa,0);H-=E;G-=E;u=u.substring(E,I)}}return Object.assign(new m.a,
{neighborhood:u,mentionStart:H,mentionLength:G-H})}static mV(){var u=r.App.Fb.Fd.Xm;if(!u)return h.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;u=u.Eb;return u&&u.Pa&&u.Pa.length?u.Pa.kb:(h.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(J.a)(y,"Box4InsightsSelection",null,[264,265])},659:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.style=this.formatting=null;this.languageId=0}}Object(J.a)(h,"NewOutlineElementInfo",
null,[])},660:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.R5c="Listening";h.yBb="Warning";h.AVa="Error";Object(J.a)(h,"VoiceNotificationResourceStrings",null,[])},661:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.CoachButton="coachButton";h.MicButton="micButton";h.PrevButton="prevButton";h.NextButton="nextButton";h.GridButton="gridButton";h.InkButton="inkButton";h.SubtitlesButton="subButton";h.LiveButton="liveButton";h.MoreButton="moreButton";h.ExitButton=
"exitButton";Object(J.a)(h,"SlideshowToolbarButtonIDs",null,[])},662:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(433);class h extends d.a{constructor(e){super();this.shapeNode=e}get fug(){return!this.shapeNode||!this.shapeNode.isConnected}get id(){return this.shapeNode.id}get isConnected(){return this.shapeNode.isConnected}}Object(J.a)(h,"InternalClipboardShape",d.a,[])},663:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(40);class e{constructor(m,r){this.vbb=!1;this.lrd=
this.ivf=-1;this.rw=m;r&&this.start()}start(){this.vbb=!0;this.lrd=-1;const m=h.a.KX();m&&(this.ivf=m)}stop(){this.vbb=!1;const m=h.a.KX();m&&0<this.Z9&&m>=this.Z9&&(this.lrd=m-this.Z9)}get operation(){return this.rw}get $Gc(){return this.lrd}get Z9(){return this.ivf}}Object(J.a)(e,"PPTStopwatch",null,[])},664:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.S5j=e}get kkc(){return this.S5j}}Object(J.a)(h,"ShowHideNotesData",null,[])},665:function(J,V,d){d.d(V,"a",
function(){return e});d.d(V,"b",function(){return m});var h=d(45);const e=r=>{r=btoa(r);r=r.replace(RegExp("\\+","g"),"-");r=r.replace(RegExp("\\/","g"),"_");return r=r.replace(RegExp("\\=+$","g"),"")},m=r=>{if(h.a.Xa(r))return null;const v=RegExp("%([0-9A-F]{2})","g");r=encodeURIComponent(r);let A="",x=0,y;for(;y=v.exec(r);){const u=v.lastIndex-3;u>x&&(A+=r.substring(x,u));A+=h.a.fromCharCode(parseInt(String("0x"+y[1])));x=v.lastIndex}x<r.length&&(A+=r.substring(x,r.length));return btoa(A)}},684:function(J,
V,d){d.r(V);J=d(0);var h=d(78),e=d(45),m=d(91),r=d(66),v=d(25),A=d(1153),x=d(13),y=d(17),u=d(86),H=d(333),G=d(26),E=d(42);class I{constructor(Oa){this.ApiType=0;this.ApiType=Oa}}Object(J.a)(I,"SlideshowApiMessage",null,[]);class Q extends I{constructor(){super(14);this.TopValue="0%";this.HeightValue="100%"}}Object(J.a)(Q,"DockSlideshowViewMessage",I,[]);class D extends I{constructor(){super(6);this.AnimStep=this.SlideIndex=0}}Object(J.a)(D,"GoToSlideApiMessage",I,[]);class Y extends I{constructor(){super(16);
this.SlideIndex=0;this.TimeLineMappings=null}}Object(J.a)(Y,"GoToSlideWithTimeLinesApiMessage",I,[]);class M extends I{constructor(){super(19);this.Color=this.Item=null}}Object(J.a)(M,"InkManagerMessage",I,[]);class N{constructor(Oa){this.hF=Oa.origin;this.qOg=Oa.source;this.ata=Oa.data}}Object(J.a)(N,"MessageEvent",null,[]);var W=d(922),K=d(917),ca=d(914),P=d(915);class ea extends Sys.EventArgs{constructor(Oa){super();this.B4b=Oa.IsStartTranscription;this.tv=Oa.SubtitlesPosition}}Object(J.a)(ea,
"OnLiveSubtitlesDockedViewEventArgs",Sys.EventArgs,[]);class da extends Sys.EventArgs{constructor(Oa){super();this.Yw=Oa.SessionTelemetry}}Object(J.a)(da,"OnLogEndOfTranscriptionSessionEventArgs",Sys.EventArgs,[]);var ia=d(919),C=d(918),oa=d(923);class Z extends Sys.EventArgs{constructor(Oa,ab){super();this.Wzj=Oa;this.category=ab.Category;this.code=ab.Code;this.message=ab.Message;this.iy=ab.ExtraInfo;this.correlationId=ab.CorrelationId;this.sessionId=ab.SessionId}}Object(J.a)(Z,"OnSlideshowErrorEventArgs",
Sys.EventArgs,[]);var pa=d(916);class ya extends Sys.EventArgs{constructor(Oa){super();this.isFinal=Oa.IsFinal;this.Qvh=Oa.Transcripts}}Object(J.a)(ya,"OnSubtitleUpdatedEventArgs",Sys.EventArgs,[]);var Ja=d(920),Ka=d(921);class ma extends Sys.EventArgs{constructor(Oa){super();this.errorName=Oa.ErrorName;this.vetoName=Oa.VetoName;this.isIntentional=Oa.IsIntentional;this.isInternal=Oa.IsInternal;this.alertOnPillar=Oa.AlertOnPillar;this.isSessionEndingError=Oa.IsSessionEndingError;this.durationMs=Oa.DurationMs}}
Object(J.a)(ma,"RecordQosErrorEventArgs",Sys.EventArgs,[]);class ra extends I{constructor(){super(11);this.StartSlideShowTime=0}}Object(J.a)(ra,"RecordStartedSlideShowTimestampApiMessage",I,[]);class Da extends I{constructor(){super(7);this.WacCluster=this.PodSessionId=null}}Object(J.a)(Da,"RefreshPodSessionApiMessage",I,[]);class va extends I{constructor(){super(21);this.IsMute=!1}}Object(J.a)(va,"SetMicrophoneStateMessage",I,[]);class Fa extends I{constructor(){super(12);this.OsfLocalStorageData=
null}}Object(J.a)(Fa,"SetOsfLocalStorageApiMessage",I,[]);class ka{constructor(){this.B4b=this.Dtg=!1;this.tv=null}}Object(J.a)(ka,"SlideShowViewDockingState",null,[]);var qa=d(968);class Ua extends I{constructor(){super(0);this.SlideIndex=this.SlideId=0;this.WacCluster=this.Endpoint=this.PodSessionId=this.WacUserSessionId=this.UserId=null;this.FPrerenderSS=!1;this.PrerenderCid=null;this.SlideShowClickTime=0;this.EndSlideShowText=null;this.FSupportSVGInWebGL="0";this.HostSupportsSessionRefreshEnabled=
!1;this.RenderShapeBuilder="0";this.CustomTransitionResourceUrl=this.DisabledTransitionsList=this.VetoAppSettingsStr=this.FileHost=null;this.StreamVideoUseThinEmbed=!1;this.DisabledChangeGates=null;this.AllowExternalMarketplace=this.AreThirdPartyAddInsAllowed=!1}}Object(J.a)(Ua,"StartSlideShowApiMessage",I,[]);class Ya extends I{constructor(){super(13);this.IsToggleOn=!1;this.PragueSessionInfo=""}}Object(J.a)(Ya,"ToggleTranscriberLiveBroadcastModeMessage",I,[]);class Va extends I{constructor(){super(18);
this.HideUI=!1}}Object(J.a)(Va,"ToggleTranscriberUIVisibilityMessage",I,[]);class ua extends I{constructor(){super(8);this.SubtitlesResourceStr=this.SubtitlesContextStr=this.SubtitlesAppSettingsStr=null;this.MicrophoneDeviceId=this.LiveBroadcastContextStr=this.RehearsalContextStr=""}}Object(J.a)(ua,"TranscribeApiMessage",I,[]);var Ca=d(73),Ea=d(52);d.d(V,"SlideshowFrame",function(){return wb});class wb{constructor(Oa,ab,fb,db,gc,ob,Sb,Jb){this.Ua=this.YTa=this.XTa=this.lta=null;this.va=new h.a;this.oEa=
null;this.xpe=this.tOg=!1;this.nf=ab;this.la=fb;this.Cc=db;this.Nb=gc;this.wG=ob;this.gk=Sb;this.Aca=Jb;this.S1j=new A.a(Object(x.a)(Oa,Oa.Mbi,"browserSupportsRenderingSVGInWebGL"))}init(Oa,ab,fb){if(!this.Ua){this.lta=document.getElementById("HiddenFocusTrapAnchor");this.Ua=document.createElement("iframe");this.Ua.id="SlideShowHostFrame";this.Ua.className="SlideShowHostFrame";this.Ua.style.display=Ca.a.og;this.Ua.setAttribute("allow","microphone; autoplay");this.oEa=new ka;fb=this.la.isHermesSlideShowPreloadEnabled?
String.format("EndSlideShowText={0}&UserSessionId={1}&WacCluster={2}",e.a.Me(ResourceStrings.l_EndOfSlideShowMessage),e.a.Me(fb),e.a.Me(ab)):"";fb+=String.format(fb?"&HostSupportsSessionRefreshEnabled={0}":"HostSupportsSessionRefreshEnabled={0}",e.a.Me(this.la.hostSupportsSessionRefreshEnabled.toString()));fb+=String.format(fb?"&InkingEnabled={0}":"InkingEnabled={0}",e.a.Me(this.la.isInkingInSlideShowEnabled.toString()));fb+=String.format(fb?"&VideoThruTransparentCanvas={0}":"VideoThruTransparentCanvas={0}",
e.a.Me(this.la.WNj.toString()));fb+=String.format(fb?"&IsFlipgridVideoEnabled={0}":"IsFlipgridVideoEnabled={0}",e.a.Me(this.la.c8a.toString()));fb+=String.format(fb?"&IsTEDVideoEnabled={0}":"IsTEDVideoEnabled={0}",e.a.Me(this.la.kvb.toString()));fb+=String.format(fb?"&IsAllowExternalMarketplace={0}":"IsAllowExternalMarketplace={0}",e.a.Me(this.la.cqg.toString()));fb+=String.format(fb?"&IsNewSlideShowToolbarEnabled={0}":"IsNewSlideShowToolbarEnabled={0}",e.a.Me(this.la.M3b.toString()));fb+=String.format("&ImageCachingEnabled={0}",
e.a.Me(this.la.Obl.toString()));fb+=String.format("&PodSlideshowEnableTabLoopFix={0}",e.a.Me(this.la.Xsk.toString()));fb+=String.format("&PodsLoadSlideShowFrameFromCdn={0}",e.a.Me(this.la.podsLoadSlideShowFrameFromCdn.toString()));fb+=String.format("&PodsBase={0}",e.a.Me(this.la.podsWebServiceBase));var db=this.la.Rda;this.la.NRa&&(db=new H.a(db),db.vnc=this.la.NRa,db.Njc=this.la.Wlh,db.Mjc=this.la.Vlh,db=db.toString());var gc=this.la.podsLoadSlideShowFrameFromCdn&&!e.a.Xa(this.la.podsBaseSlideShowFramePath);
this.Ua.src=gc?this.la.podsBaseSlideShowFramePath:"./SlideShowFrame.html";this.Ua.src=String.format(this.Ua.src+"?Version={0}&WacCluster={1}&BootJS={2}&{3}={4}",Oa,e.a.Me(ab),e.a.Me(this.la.pptEditorSlideShowWrsEndpoint),u.a.fec,db);G.a.J(40388358,830,50,String.format("LoadFromCdn {0}, IsTranscriberEnabled {1}",gc,this.la.cja));if(this.la.cja||this.la.O4b)this.Ua.src=String.format(this.Ua.src+"&TranscriberJS={0}&ClientAudioMessageJS={1}&SpeechResultMessageJS={2}&TranscriberURI={3}",e.a.Me(this.la.pptEditorTranscriberJsUri),
e.a.Me(this.la.pptEditorTransciberClientAudioMessageJsUri),e.a.Me(this.la.pptEditorTransciberSpeechResultMessageJsUri),e.a.Me(this.la.pptEditorSpeechHandlerBaseUri)),this.Ua.src=String.format(this.Ua.src+"&SpeechResponseMessageJS={0}",e.a.Me(this.la.pptEditorTranscriberSpeechResponseMessageJsUri)),e.a.vg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js")&&(this.Ua.src=String.format(this.Ua.src+"&QualityStatusMessageJS={0}",e.a.Me(this.la.pptEditorTranscriberQualityStatusMessageJsUri))),
this.la.O4b&&e.a.vg(this.la.pptEditorTranscriberRehearsalResultMessageJsUri).endsWith("rehearsalresultmessage.js")&&(this.Ua.src=String.format(this.Ua.src+"&RehearsalResultMessageJS={0}",e.a.Me(this.la.pptEditorTranscriberRehearsalResultMessageJsUri))),this.la.pptEditorTranscriberLiveAgentEnabled&&e.a.vg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js")&&(this.Ua.src=String.format(this.Ua.src+"&AgentCommandMessageJS={0}",e.a.Me(this.la.pptEditorTranscriberAgentCommandMessageJsUri)));
this.la.powerPointLiveBroadcastEnabled&&(this.Ua.src+="&wdLiveBroadcast=true");this.Ua.src=String.format(this.Ua.src+"#{0}",fb);E.a("PresenterCoachTabFix")&&this.lta?this.nf.insertBefore(this.Ua,this.lta):this.nf.appendChild(this.Ua);m.a.addHandler(window,r.a.message,Object(x.a)(this,this.dmk,"onSlideshowMessage"));this.Cc.Eqb&&this.la.u$c&&this.$Rj();E.a("PresenterCoachTabFix")&&(this.XTa=document.getElementById("legacySlideshowBeginningFocusTrap"),this.YTa=document.getElementById("legacySlideshowEndFocusTrap"),
this.XTa||this.YTa||(this.XTa=document.createElement("div"),this.XTa.id="legacySlideshowBeginningFocusTrap",this.XTa.className="FocusTrap",this.XTa.tabIndex=0,m.a.addHandler(this.XTa,r.a.focus,Object(x.a)(this,this.odc,"onSlideShowContainerDivFocusHandler")),this.YTa=document.createElement("div"),this.YTa.id="legacySlideshowEndFocusTrap",this.YTa.className="FocusTrap",this.YTa.tabIndex=0,m.a.addHandler(this.YTa,r.a.focus,Object(x.a)(this,this.odc,"onSlideShowContainerDivFocusHandler")),this.nf.insertBefore(this.XTa,
this.nf.firstChild),this.nf.insertBefore(this.YTa,this.lta.nextSibling)))}}c5a(){return this.la.u$c&&this.xpe}jmk(){G.a.J(590881761,830,50,"SlideShowFrame::OnSpeechClientScriptLoaded Speech client script has been loaded successfully");this.tOg=!0;return null}$Rj(){const Oa=new y.a;Oa.add(this.Aca.loadScript("PPTSpeechClient"));Promise.all(Oa.toArray()).then(()=>this.jmk()).catch(ab=>{G.a.J(590881759,830,10,"SlideShowFrame::LoadSpeechClientResources Failed to load the resources for SlideShowCore: {0}",
ab)})}gHb(Oa,ab,fb,db,gc,ob,Sb,Jb,Ab){this.oEa=new ka;Sb&&G.a.J(23417092,830,50,String.format("Will trigger slideshow bundle rendering, correlation = {0}",Jb));this.rF(Object.assign(new Ua,{WacCluster:fb,PodSessionId:db,UserId:gc,WacUserSessionId:ob,SlideId:Oa,SlideIndex:ab,FPrerenderSS:Sb,PrerenderCid:Jb,SlideShowClickTime:Ab,EndSlideShowText:ResourceStrings.l_EndOfSlideShowMessage,FSupportSVGInWebGL:this.S1j.value?"1":"0",RenderShapeBuilder:this.la.NRa?"1":"0",FileHost:v.AFrameworkApplication.fa.Ia("FileHost"),
VetoAppSettingsStr:this.gfj(),DisabledTransitionsList:this.la.gJa,CustomTransitionResourceUrl:this.la.pTf,StreamVideoUseThinEmbed:v.AFrameworkApplication.fa.ka("StreamVideoUseThinEmbed"),DisabledChangeGates:v.AFrameworkApplication.fa.Ia("PPTDisabledChangeGates"),AreThirdPartyAddInsAllowed:v.AFrameworkApplication.ypa,AllowExternalMarketplace:v.AFrameworkApplication.fa.ka(Ea.a.pa(51))}))}prev(){this.rF(new I(2))}next(){this.rF(new I(1))}transcribe(Oa,ab,fb,db,gc,ob,Sb){var Jb=!!this.Nb&&!!this.Nb.instance&&
(this.Nb.instance.$Oa||this.Nb.instance.Cq);(this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&this.Nb.instance.hBa||Jb)&&!this.Nb.instance.Iqb()?G.a.J(591663306,830,50,"LivePresenter prevented transcriber from starting"):this.c5a()?(qa.a.instance.transcribe(Oa,ab,fb,db,gc,ob,Sb),this.PGc(this.Cc.Ih&&5!==gc,this.Cc.tv)):(Jb={},Jb.TranslationLanguages=this.la.powerPointLiveBroadcastEnabled?this.la.liveBroadcastTranslationLanguagesOverride:"",Jb.BroadcastSubtitlesFromSpeechFrontDoorForLive=this.la.powerPointLiveBroadcastEnabled?
!0:!1,this.rF(Object.assign(new ua,{SubtitlesAppSettingsStr:this.mcj(Oa,fb,ab,db,gc,ob),SubtitlesContextStr:this.Cc.Dfl,SubtitlesResourceStr:this.ncj(),RehearsalContextStr:Sb?Sb.fKk:"",LiveBroadcastContextStr:JSON.stringify(Jb),MicrophoneDeviceId:this.wG.microphoneDeviceId})))}setMicrophoneState(Oa){this.c5a()?qa.a.instance.setMicrophoneState(Oa):(this.rF(Object.assign(new va,{IsMute:Oa})),this.Nb&&this.Nb.instance&&(Oa?this.Nb.instance.Vjh():this.Nb.instance.Wjh()))}HYa(Oa,ab=""){this.oEa.Dtg=Oa;
G.a.J(41682758,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");this.c5a()?(qa.a.instance.uvh(Oa,ab),this.PGc(this.Cc.Ih,this.Cc.tv)):this.rF(Object.assign(new Ya,{IsToggleOn:Oa,PragueSessionInfo:ab}));this.KWg()}toggleTranscriberUIVisibility(Oa){G.a.J(50595609,830,50,"Toggling Transcriber UI visibilitye ... On: {showUI}");this.c5a()?(Oa=Oa?Oa?!1:!0:!qa.a.instance.isVisible(),qa.a.instance.setVisibility(Oa),qa.a.instance.Wzc(),this.PGc(this.Cc.Ih,this.Cc.tv)):this.rF(Object.assign(new Va,
{HideUI:Oa}))}PGc(Oa,ab){this.oEa.B4b=Oa;this.oEa.tv=ab;this.KWg()}setOsfLocalStorage(){const Oa={};let ab=!1;try{const fb=RegExp("^osfCacheVersion|_?_OSF_.+$");for(let db=0;db<localStorage.length;++db){const gc=localStorage.key(db);if(fb.test(gc)){const ob=localStorage.getItem(gc);Oa[gc]=ob;ab=!0}}}catch(fb){G.a.J(41250837,830,50,"SlideShowFrame::Exception while retrieving OSF Local Storage data: {0}",fb.toString())}ab&&this.rF(Object.assign(new Fa,{OsfLocalStorageData:Oa}))}show(){G.a.J(39203547,
830,50,"SlideShowFrame::Show Making frame visible.");if(this.Ua){this.Ua.style.display=Ca.a.wl;var Oa=(new Date).getTime();G.a.J(39683469,830,50,"SlideShowFrame::Show Sending startedSlideShowTimestamp: {0} to SlideShowFrame.html",Oa);this.rF(Object.assign(new ra,{StartSlideShowTime:Oa}))}else G.a.J(593368097,830,15,"SlideShowFrame::Show Making frame visible, but m_frame is null.")}aja(){return this.Ua&&this.Ua.style.display!==Ca.a.og?!0:!1}ivb(){return!1}Zgb(Oa){this.Ua.style.display=Oa?Ca.a.wl:Ca.a.og;
this.c5a()&&qa.a.instance.setVisibility(Oa&&this.Cc.Ih)}irb(){G.a.J(51200071,830,50,"SlideShowFrame: Exiting with post message");this.rF(new I(3))}exit(){this.Ua.style.display===Ca.a.og?this.va.raiseEvent("OnExit",new K.a({SlideId:0,IsBeforeReady:!0})):(G.a.J(39203549,830,50,"SlideShowFrame: Making frame invisible"),this.Ua.style.display=Ca.a.og,this.rF(new I(3)));this.c5a()&&qa.a.instance.WMe()}restoreFocus(){this.Ua.style.display===Ca.a.og||this.f8d()||(this.Ua.focus(),this.rF(new I(4)))}pausePresentation(){this.rF(new I(15))}omc(){this.va.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}getCurrentPosition(){this.rF(new I(5))}getCurrentPositionWithTimeLines(){this.rF(new I(17))}getCurrentSlideDimensions(){this.rF(new I(20))}Cra(Oa){this.rF(Object.assign(new D,{SlideIndex:Oa,AnimStep:0}))}Jec(Oa){this.rF(Object.assign(new M,{Item:Oa.item,Color:Oa.color}))}bjc(Oa){this.va.raiseEvent("OnSpecialKey",new pa.a({["Key"]:Oa.keyCode,["ShiftKey"]:Oa.shiftKey}))}Sed(){this.rF(new I(22))}VNc(Oa,ab){this.rF(Object.assign(new Y,{SlideIndex:Oa,TimeLineMappings:ab}))}refreshPodSession(Oa,
ab){this.rF(Object.assign(new Da,{PodSessionId:Oa,WacCluster:ab}))}setVisibility(Oa){this.Ua.style.visibility=Oa?Ca.a.Ty:Ca.a.Qs}L4(Oa){this.rF(new I(Oa?9:10));this.c5a()&&qa.a.instance.L4(Oa)}Fmb(Oa){this.va.addHandler("OnSlideshowReady",Oa)}Fhc(Oa){this.va.removeHandler("OnSlideshowReady",Oa)}xSb(Oa){this.va.addHandler("OnBrowserEvent",Oa)}xcd(Oa){this.va.removeHandler("OnBrowserEvent",Oa)}Azc(Oa){this.va.addHandler("OnFullscreenClick",Oa)}tDe(Oa){this.va.removeHandler("OnFullscreenClick",Oa)}ySb(Oa){this.va.addHandler("OnSlideshowContextMenu",
Oa)}ycd(Oa){this.va.removeHandler("OnSlideshowContextMenu",Oa)}BSb(Oa){this.va.addHandler("OnPodSessionExpired",Oa)}Bcd(Oa){this.va.removeHandler("OnPodSessionExpired",Oa)}rpa(Oa){this.va.addHandler("OnPositionChangeEventId",Oa)}JWa(Oa){this.va.removeHandler("OnPositionChangeEventId",Oa)}xY(Oa){this.va.addHandler("OnExit",Oa)}R_(Oa){this.va.removeHandler("OnExit",Oa)}zzc(Oa){this.va.addHandler("OnSlideshowError",Oa)}sDe(Oa){this.va.removeHandler("OnSlideshowError",Oa)}C2a(Oa){this.va.addHandler("OnGetCurrentPosition",
Oa)}GWa(Oa){this.va.removeHandler("OnGetCurrentPosition",Oa)}Emb(Oa){this.va.addHandler("OnGetCurrentSlideDimensions",Oa)}Ehc(Oa){this.va.removeHandler("OnGetCurrentSlideDimensions",Oa)}Gmb(Oa){this.va.addHandler("OnSpecialKey",Oa)}Ghc(Oa){this.va.removeHandler("OnSpecialKey",Oa)}Jzc(Oa){this.va.addHandler("OnVisibilityChangeEventId",Oa)}Ecd(Oa){this.va.removeHandler("OnVisibilityChangeEventId",Oa)}Czc(Oa){this.va.addHandler("OnLogEndOfTranscriptionSession",Oa)}wDe(Oa){this.va.removeHandler("OnLogEndOfTranscriptionSession",
Oa)}Bzc(Oa){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",Oa)}vDe(Oa){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",Oa)}zSb(Oa){this.va.addHandler("OnEnterEndOfShowEventId",Oa)}zcd(Oa){this.va.removeHandler("OnEnterEndOfShowEventId",Oa)}ASb(Oa){this.va.addHandler("OnLeaveEndOfShowEventId",Oa)}Acd(Oa){this.va.removeHandler("OnLeaveEndOfShowEventId",Oa)}Fzc(Oa){this.va.addHandler("OnSubtitleUpdatedEventId",Oa)}yDe(Oa){this.va.removeHandler("OnSubtitleUpdatedEventId",Oa)}Hzc(Oa){this.va.addHandler("OnTranscriberStartedEventId",
Oa)}ADe(Oa){this.va.removeHandler("OnTranscriberStartedEventId",Oa)}Lzc(Oa){this.va.addHandler("RecordQosErrorEventId",Oa)}CDe(Oa){this.va.removeHandler("RecordQosErrorEventId",Oa)}dmk(Oa){Oa=new N(Oa.rawEvent);if(this.NNj(Oa)){var ab=this.CSk(Oa.ata),fb=ab.EventType;28===fb&&G.a.J(23098057,830,50,"SlideshowFrame.OnSlideshowMessage: Receive message event: {0}",Oa.ata);switch(fb){case 23:this.R6c(ab);break;case 18:this.Ccb(ab);break;case 6:this.kkk();break;case 11:this.t_g(!1,ab);break;case 13:this.t_g(!0,
ab);break;case 2:this.Bda(ab);break;case 7:this.Xua(ab);break;case 12:this.gva(ab);break;case 24:this.cmk(ab);break;case 26:this.UVa(ab);break;case 27:this.O7c(ab);break;case 29:this.p7c(ab);break;case 5:this.Q7c(ab);break;case 30:this.pmk(ab);break;case 32:this.y8c(ab);break;case 31:this.o7c(ab);break;case 19:this.N6c(ab);break;case 20:this.l7c(ab);break;case 33:this.chc(ab)}}}NNj(Oa){try{if(Oa.qOg!==this.Ua.contentWindow)return G.a.J(23098059,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Invalid message source or origin: {0}",
Oa.qOg.location.href),!1}catch(ab){return G.a.J(23098061,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Exception at checking event source/origin: {0}",ab.toString()),!1}return!0}CSk(Oa){try{return Sys.Serialization.JavaScriptSerializer.deserialize(Oa)}catch(ab){let fb=ab.toString();E.a("DisableLogPostMsgData")&&(Oa="<redacted>");E.a("DisableLogPostMsgEx")&&(fb="<redacted>");G.a.J(23098063,830,15,"SlideshowFrame.RetrieveMsgEventData: Exception at deserializing event data: {0}.  Exception: {1}",
Oa,fb)}return{}}kkk(){if(this.la.u$c&&this.tOg&&!this.xpe)try{const Oa=(new Date).getTime();qa.a.instance.init(this.la,this.Ua.contentDocument.body,this.Cc,this,this.gk,this.Nb,this.wG);this.xpe=!0;G.a.J(590881743,833,50,"SlideshowFrame.OnPresentationOpenedHandler: SpeechClient initialized successfully! TimeUsed: {0} ms",(new Date).getTime()-Oa)}catch(Oa){G.a.J(590881741,830,10,"SlideshowFrame.OnPresentationOpenedHandler: Exception thrown: {0}.",Oa.toString())}G.a.J(23098065,830,50,"SlideshowFrame.OnPresentationOpenedHandler");
this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)}Ccb(Oa){this.va.raiseEvent("OnBrowserEvent",new W.a(Oa))}R6c(Oa){G.a.J(23098071,830,50,"SlideshowFrame.OnExitSlideshowHandler");G.a.J(39203585,830,50,"SlideShowFrame: Making frame invisible");this.Ua.style.display=Ca.a.og;this.va.raiseEvent("OnExit",new K.a(Oa))}Bda(Oa){G.a.J(24133974,830,50,"SlideshowFrame.OnGetCurrentPositionHandler");this.va.raiseEvent("OnGetCurrentPosition",new ca.a(Oa))}Xua(Oa){G.a.J(51263240,830,50,"SlideshowFrame.OnGetCurrentSlideDimensionsHandler");
this.va.raiseEvent("OnGetCurrentSlideDimensions",new P.a(Oa))}t_g(Oa,ab){this.va.raiseEvent("OnSlideshowError",new Z(Oa,ab))}gva(Oa){Oa=new pa.a(Oa);G.a.J(24133976,830,50,"SlideshowFrame.OnSpecialKeyHandler: Key={0}",Oa.key);this.va.raiseEvent("OnSpecialKey",Oa)}cmk(Oa){G.a.J(24133978,830,50,"SlideshowFrame.OnSlideshowContextMenuHandler");this.va.raiseEvent("OnSlideshowContextMenu",new oa.a(Oa))}UVa(Oa){G.a.J(38412576,830,50,"SlideshowFrame.OnVisibilityChangeHandler");this.va.raiseEvent("OnVisibilityChangeEventId",
new Ka.a(Oa))}O7c(Oa){G.a.J(39174979,830,50,"SlideshowFrame.OnPodSessionExpiredHandler");this.va.raiseEvent("OnPodSessionExpired",new ia.a(Oa))}p7c(Oa){G.a.J(40388112,830,50,"SlideshowFrame.OnLogEndOfTranscriptionSessionHandler");this.va.raiseEvent("OnLogEndOfTranscriptionSession",new da(Oa));this.Cc.Kqb=!1}Q7c(Oa){G.a.J(41166537,830,50,"SlideshowFrame.OnPositionChangedHandler");this.va.raiseEvent("OnPositionChangeEventId",new C.a(Oa))}pmk(Oa){G.a.J(41682786,830,50,"SlideshowFrame.OnSubtitleUpdatedHandler");
this.va.raiseEvent("OnSubtitleUpdatedEventId",new ya(Oa))}y8c(Oa){G.a.J(50706496,830,50,"SlideshowFrame.OnTranscriberStartedHandler");this.va.raiseEvent("OnTranscriberStartedEventId",new Ja.a(Oa));this.Cc.Kqb=!0}odc(){this.restoreFocus()}o7c(Oa){G.a.J(41714752,830,50,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler");try{const ab=new ea(Oa);this.PGc(ab.B4b,ab.tv);this.va.raiseEvent("OnLiveSubtitlesDockedViewEventId",ab)}catch(ab){G.a.J(41714754,830,15,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler threw exception: {0}.",
ab.toString())}}N6c(){G.a.J(41763867,830,50,"SlideshowFrame.OnEnterEndOfShowHandler");this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty)}l7c(){G.a.J(41763869,830,50,"SlideshowFrame.OnLeaveEndOfShowHandler");this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty)}chc(Oa){G.a.J(593798929,830,50,"SlideshowFrame.RecordQosErrorHandler");this.va.raiseEvent("RecordQosErrorEventId",new ma(Oa))}rF(Oa){this.Ua&&this.Ua.contentWindow&&this.Ua.contentWindow.postMessage(Sys.Serialization.JavaScriptSerializer.serialize(Oa),
"*")}KWg(){var Oa=0,ab=100;this.oEa.B4b&&("BelowSlide"===this.oEa.tv?(Oa=0,ab=85):"AboveSlide"===this.oEa.tv&&(Oa=15,ab=85));Oa=Oa.toString()+"%";ab=ab.toString()+"%";this.oEa.Dtg&&(Oa=String.format("calc({0} + {1})",Oa,"26px"),ab=String.format("calc({0} - {1})",ab,"26px"));this.rF(Object.assign(new Q,{TopValue:Oa,HeightValue:ab}))}gfj(){const Oa={};Oa.AnimTranstionMinDurationMs=v.AFrameworkApplication.fa.Gc("PodSlideShowVetoAnimTranstionMinDurationMs",1E3);Oa.AnimTranstionWorstFrameIndex=v.AFrameworkApplication.fa.Gc("PodSlideShowVetoAnimTranstionWorstFrameIndex",
3);Oa.AnimTranstionMaxFrameDurationMs=v.AFrameworkApplication.fa.Gc("PodSlideShowVetoAnimTranstionMaxFrameDurationMs",300);Oa.AnimTranstionMinFPS=v.AFrameworkApplication.fa.Gc("PodSlideShowVetoAnimTranstionMinFPS",24);Oa.NavDurationMs=v.AFrameworkApplication.fa.Gc("PodSlideShowVetoNavDurationMs",1250);Oa.SlideShowEUPLThresholdInMs=v.AFrameworkApplication.fa.Gc("SlideShowEUPLThresholdInMs",6E3);Oa.SlideShowNavigationThresholdInMs=v.AFrameworkApplication.fa.Gc("SlideShowNavigationThresholdInMs",1250);
return JSON.stringify(Oa)}mcj(Oa,ab,fb,db,gc,ob){const Sb=this.la.Evk&&e.a.vg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js"),Jb={};Jb.WacUserSessionId=Oa;Jb.WacUserDatacenterCluster=ab;Jb.PodSessionId=fb;Jb.DocId=db;Jb.EntryPoint=gc;Jb.StartTime=ob;Jb.PodsWebServiceBase=this.la.podsWebServiceBase;Jb.TranscriberLoggingIntervalInMS=this.la.hll;Jb.TranscribeRealTimeFactorLowerThreshold=this.la.dll;Jb.TranscribeRealTimeFactorUpperThreshold=this.la.ell;Jb.IsTranscriberLogEachTranscriptMessage=
this.la.VMj;Jb.IsTranscriberContentLoggingEnabled=this.la.SMj;Jb.FUseEndpointInWebapp=this.la.YMj;Jb.CustomEndpointRequestTimeoutInMs=this.la.pptEditorTransriberCustomEndpointRequestTimeoutInMs;Jb.RTLLanguages=this.la.pptEditorTranscribeRTLTranslationLanguages;Jb.HeartbeatInterval=5E3;Jb.RoundtripLatencyThreshold=1E6;Jb.AudioSendingCountIntervalMS=this.la.pptEditorTranscribeAudioSendingCountIntervalMS;Jb.FragmentLatencyWarnThreshold=1E6;Jb.FragmentLatencyErrorThreshold=1E6;Jb.MessageType=this.la.pptEditorTransciberMessageType;
Jb.MaxAllowedFragmentLatencyMS=this.la.$sk;Jb.DynamicBufferEnabled=this.la.TMj;Jb.DefaultBufferSize=this.la.gll;Jb.MaxAllowedFinalFragmentLatencyMS=this.la.Zsk;Jb.FSupportSpeechResponseMessage=Sb;Jb.IsLiveAgent=this.la.pptEditorTranscriberLiveAgentEnabled&&Sb&&e.a.vg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js");Jb.ShouldCreateCustomEndpointWithSession=this.la.pptEditorTranscriberCustomEndpointWithSession;Jb.TranscriberShowListeningDetectionTextInMS=this.la.Dvk;
Jb.PodTranscriberAudioContextSampleRate=this.la.Ysk;Jb.RehearsalGrammarIsEnabled=this.la.Bye;Jb.PodRehearsalMonotoneEnabled=this.la.Uxe;return JSON.stringify(Jb)}ncj(){const Oa={};Oa.Detection_AudioQualityIssue=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Oa.Detection_HighBackgroundNoise=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;Oa.Detection_HighJitter=ResourceStrings.L_SubtitleDetection_HighJitter;Oa.Detection_HighLatency=ResourceStrings.L_SubtitleDetection_HighLatency;Oa.Detection_Listening=
ResourceStrings.L_SubtitleDetection_Listening;Oa.Detection_MicReady=ResourceStrings.L_SubtitleDetection_MicReady;Oa.Detection_NetworkQualityIssue=ResourceStrings.L_SubtitleDetection_NetworkQualityIssue;Oa.Detection_NoMicrophone=ResourceStrings.L_SubtitleDetection_NoMicrophone;Oa.Detection_SoundReminder=ResourceStrings.L_SubtitleDetection_SoundReminder;Oa.Detection_SpeakingTooLoud=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Oa.Detection_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;
Oa.DetectionText_AudioQualityIssue=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;Oa.DetectionText_HighBackgroundNoise=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;Oa.DetectionText_HighJitter=ResourceStrings.L_SubtitleDetectionText_HighJitter;Oa.DetectionText_HighLatency=ResourceStrings.L_SubtitleDetectionText_HighLatency;Oa.DetectionText_NetworkQualityIssue=ResourceStrings.L_SubtitleDetectionText_NetworkQualityIssue;Oa.DetectionText_SpeakingTooLoud=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;
Oa.DetectionText_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetectionText_SpeakingTooQuiet;Oa.Accessibility_Content=ResourceStrings.L_SubtitleAccessibilityContent;Oa.Accessibility_Window=ResourceStrings.L_SubtitleAccessibilityWindow;Oa.InitialMessage=ResourceStrings.L_SubtitleInitMessage;Oa.GenericErrorMessage=ResourceStrings.L_SubtitleGenericErrorMessage;Oa.RetryErrorMessage=ResourceStrings.L_SubtitleRetryErrorMessage;Oa.ErrorAudioDevice=ResourceStrings.L_SubtitleAudioDeviceErrorMessage;Oa.GenericRetryErrorMessage=
ResourceStrings.L_SpeechGenericRetryErrorMessage;Oa.GenericNetworkErrorMessage=ResourceStrings.L_SpeechGenericNetworkErrorMessage;return JSON.stringify(Oa)}f8d(){return!!this.Nb&&!!this.Nb.instance&&this.Nb.instance.G0f}}Object(J.a)(wb,"SlideshowFrame",null,[525])},686:function(J,V,d){d.r(V);J=d(0);var h=d(374),e=d(176),m=d(907),r=d(1054),v=d(25),A=d(1053),x=d(13),y=d(1153),u=d(1154),H=d(27),G=d(460);class E extends G.a{constructor(Ka,ma,ra,Da,va,Fa){super();this.init(Ka);this.vl("DummyClipboardOperation");
this.ACa(v.AFrameworkApplication.Va,ma,Da,va,Fa);this.yu=ra;this.Zo=8;this.sX()}run(){this.RKa=!0;this.efb(this.yu);this.Wla();this.Zo=32}}Object(J.a)(E,"DummyClipboardOperation",G.a,[]);var I=d(96),Q=d(127),D=d(116),Y=d(58);class M{constructor(Ka,ma,ra){h.ULS.shipAssertTag(6305502,307,!!Ka);this.properties=Ka;this.ld=ma;this.Noa=ra}get Uc(){return this.ld}$ag(){return this.properties.ta(Y.a.sT,"")}$4g(){return!0}Qwh(){let Ka,ma=!1;Ka=null;const ra=this.$ag();if(this.Noa||""!==ra)try{({A4a:Ka,returnValue:ma}=
this.ZQe(ra))}catch(Da){h.ULS.shipAssertTag(4203138,307,!1),this.Uc.Vb(Q.a.Fha,{["Reason"]:D.a.HHf}),I.a.$za(Ka)}else h.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Uc.Vb(Q.a.v0,{["Reason"]:D.a.KTd});return{returnValue:ma,bEc:Ka}}}Object(J.a)(M,"AStringInputImportStrategy",null,[773]);class N extends M{constructor(Ka,ma,ra,Da,va){super(Ka,ma,va);this.jk=ra;this.IBd=Da}ZQe(Ka){const {ClipboardActor:ma}=d(686);let ra;if(this.Noa&&!Ka)return h.ULS.sendTraceTag(541172643,307,10,"No htmlDomContent and htmlClipboardDataContent"),
{returnValue:!1,A4a:null};ra=null;if(this.Noa)return ra=this.jk.YVa(Ka),{returnValue:!0,A4a:ra};if(this.IBd){const Da=this.properties.ta(Y.a.kxe,"");Da&&(ra=this.jk.YVa(Da))}ra||(h.ULS.sendTraceTag(520931392,307,15,"HtmlStringImportStrategy:: use of innerHtml because domContainer is null"),ra=ma.C2g,ra.innerHTML=Ka);return{returnValue:!0,A4a:ra}}}Object(J.a)(N,"HtmlStringImportStrategy",M,[]);var W=d(45);class K extends M{constructor(Ka,ma,ra){super(Ka,ma,ra)}ZQe(Ka){let ma;if(this.Noa&&!Ka)return h.ULS.sendTraceTag(541172642,
307,10,"No htmlDomContent"),{returnValue:!1,A4a:null};ma=document.createElement("div");Ka=Ka.split(RegExp("\r\n|\r|\n"));for(var ra=0;ra<Ka.length-1;ra++){const Da=document.createElement("p");Da.innerText=this.vbe(Ka[ra]);ma.appendChild(Da)}ra=document.createElement("span");ra.innerText=W.a.LSd(Ka[Ka.length-1]);ma.appendChild(ra);return{returnValue:!0,A4a:ma}}vbe(Ka){return W.a.LSd(Ka.length?Ka:" ")}}Object(J.a)(K,"MultiLineTextImportStrategy",M,[]);class ca extends K{constructor(Ka,ma,ra){super(Ka,
ma,ra)}$ag(){return this.properties.ta(Y.a.jdb,"")}vbe(Ka){Ka=super.vbe(Ka);return Ka.length&&" "!==Ka?Ka:"\u00a0"}}Object(J.a)(ca,"MultiLinePlainTextImportStrategy",K,[]);class P extends M{constructor(Ka,ma,ra){super(Ka,ma,ra)}ZQe(Ka){var {ClipboardActor:ma}=d(686);if(this.Noa&&!Ka)return h.ULS.sendTraceTag(541172641,307,10,"No htmlDomContent"),{returnValue:!1,A4a:null};ma=ma.C2g;ma.innerText=Ka;return{returnValue:!0,A4a:ma}}}Object(J.a)(P,"PlainTextImportStrategy",M,[]);var ea=d(375);class da{constructor(Ka){this.eg=
this.V9d=!1;this.oY=Ka}$4g(){this.V9d||(this.V9d=!0,this.eg=!1,this.oY.prepareForPaste(()=>{this.eg=!0}));return this.eg}Qwh(){let Ka;this.V9d=!1;Ka=this.oY.paste();return Ka?Ka.hasChildNodes()?{returnValue:!0,bEc:Ka}:(h.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),da.Uc.Vb(Q.a.v0,{["Reason"]:D.a.KTd}),{returnValue:!1,bEc:Ka}):(h.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),da.Uc.Vb(Q.a.d5a,{["Reason"]:D.a.aOe}),{returnValue:!1,bEc:Ka})}static get Uc(){return ea.a.instance}}
Object(J.a)(da,"SystemClipboardImportStrategy",null,[773]);var ia=d(62),C=d(34),oa=d(49),Z=d(38),pa=d(32),ya=d(255);d.d(V,"ClipboardActor",function(){return Ja});class Ja{constructor(Ka,ma,ra,Da,va,Fa,ka,qa){this.zWe=null;this.YNb=0;this.vHh=Ka;this.oY=ma;this.ld=ra;this.jk=Da;this.Rc=va;this.Da=Fa;this.ls=ka;this.S$e=!!qa&&qa.ka("SupportImageDragDropExternalIsEnabled");this.WBd=!!qa&&qa.ka("ShowKeepSourceFormattingOnPasteFloatieIsEnabled");this.kM=new ya.a;this.kM.$(pa.a.paste,257);this.kM.$(pa.a.uva,
8449);this.kM.$(pa.a.Ipa,1);this.kM.$(pa.a.kpg,513);this.kM.$(pa.a.reformatPastedContent,4097);this.kM.$(pa.a.Pbd,12289);this.kM.$(pa.a.m9c,7);this.kM.$(pa.a.l9c,1);this.kM.$(pa.a.w2g,8193);this.kM.$(pa.a.copy,272);this.kM.$(pa.a.jBc,16);this.kM.$(pa.a.cut,304);this.kM.$(pa.a.HTb,48);this.kM.$(pa.a.k5c,64);this.kM.$(pa.a.l5c,64);this.kM.$(pa.a.showPlaceholderGlossary,65536);this.S$e&&this.kM.$(pa.a.mXf,1)}get lNf(){return this.vHh.value}get dA(){return this.oY}wb(){this.Da.ra(pa.a.wAk,Z.a.application,
Object(x.a)(this,this.wad,"queryPasteOptions"),97);this.Da.ra(pa.a.yAk,Z.a.application,Object(x.a)(this,this.wad,"queryPasteOptions"),97);this.WBd?this.Da.ra(pa.a.o7g,Z.a.application,Object(x.a)(this,this.MAe,"queryReformatPasteOptions"),97):this.Da.ra(pa.a.p7g,Z.a.application,Object(x.a)(this,this.MAe,"queryReformatPasteOptions"),97);this.Da.ra(pa.a.q7g,Z.a.application,Object(x.a)(this,this.MAe,"queryReformatPasteOptions"),97);this.Da.KU(pa.a.HTb,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"),
1028);this.Da.KU(pa.a.cut,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"),1028);this.Da.vza(pa.a.jBc,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"));this.Da.vza(pa.a.copy,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"));this.S$e&&this.Da.KU(pa.a.mXf,Z.a.view,Object(x.a)(this,this.nHi,"dropBrowserContent"),1028);this.Da.KU(pa.a.Ipa,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"),1028);this.Da.KU(pa.a.paste,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"),1028);this.Da.KU(pa.a.uva,
Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"),1028);this.Da.KU(pa.a.w2g,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"),1028);this.Da.KU(pa.a.l9c,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"),1028);this.Da.KU(pa.a.m9c,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"),1028);this.Da.KU(pa.a.reformatPastedContent,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"),1028);this.Da.KU(pa.a.Pbd,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"),1028);this.Da.ya(pa.a.cdd,Z.a.view,
e.ActionManager.Dg);this.Da.ya(pa.a.Qrk,Z.a.view,e.ActionManager.Dg);this.Da.ya(pa.a.O2g,Z.a.view,e.ActionManager.Dg);this.Da.ya(pa.a.P2g,Z.a.view,e.ActionManager.Dg);this.Da.ya(pa.a.Q2g,Z.a.view,e.ActionManager.Dg);this.Da.ya(pa.a.N2g,Z.a.view,e.ActionManager.Dg);this.Da.vza(pa.a.k5c,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"));this.Da.vza(pa.a.l5c,Z.a.view,Object(x.a)(this,this.l5c,"moveSelectedContentWithinCurrentParagraph"));this.Da.vza(pa.a.kpg,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"));
this.Da.vza(pa.a.showPlaceholderGlossary,Z.a.view,Object(x.a)(this,this.ZU,"clipboardAction"));this.Da.ya(pa.a.SSf,Z.a.view,e.ActionManager.Dg);this.Da.ya(pa.a.qTf,Z.a.view,e.ActionManager.Dg)}wad(Ka,ma,ra,Da,va){if(1===ra)return 32;va[m.a.On]=!1;return 32}nHi(Ka,ma,ra,Da,va,Fa){h.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var ka=Fa.DataTransfer;Fa=ka.getData("text/html");ka=ka.getData("text/plain");let qa=!1;const Ua=new r.DictionaryPropertySet;0<Fa.length?(h.ULS.sendTraceTag(42530336,
307,50,"Drag and drop browser content with HTML"),Ua.setValue(Y.a.sT,Fa),qa=!0):0<ka.length&&(h.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Ua.setValue(Y.a.jdb,ka),qa=!0);if(qa){const Ya=this.kM.ga(ma);return this.lNf.create(Ka,ma,Ya,new y.a(()=>this.mVf(Ya,Ua)),ra,Da,va,Ua)}return null}MAe(Ka,ma,ra,Da,va){if(ma=Object(u.a)(Object,va))v.AFrameworkApplication.Pj("Microsoft.Office.Web.SessionSettings.IWacWordShowKeepSourceFormattingOnPasteFloatieSettings"),!this.WBd&&
Ka===pa.a.p7g||this.WBd&&Ka===pa.a.o7g?(Ka=this.YNb!==pa.a.reformatPastedContent&&this.YNb!==pa.a.Pbd,ma[m.a.On]=this.YNb===pa.a.reformatPastedContent||Ka):Ka===pa.a.q7g&&(ma[m.a.On]=this.YNb===pa.a.Pbd);return 32}ZU(Ka,ma,ra,Da,va,Fa){if(v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)){if((v.AFrameworkApplication.DQ||v.AFrameworkApplication.AL)&&!v.AFrameworkApplication.K4a||C.a.instance.ga(83))return new E(Ka,ma,ra,Da,va,Fa)}else if(v.AFrameworkApplication.DQ||
C.a.instance.ga(83))return new E(Ka,ma,ra,Da,va,Fa);const ka=this.kM.ga(ma);1!==Da&&ka&1&&(this.YNb=ma);1!==Da&&Fa&&ka&1&&(this.zWe=Fa);1!==Da&&!Fa&&ka&4096&&(Fa=this.zWe);return this.lNf.create(Ka,ma,ka,new y.a(()=>this.mVf(ka,Fa)),ra,Da,va,Fa)}l5c(Ka,ma,ra,Da,va,Fa){Fa=oa.a.Wj(ia.a.instance.Pa.kb.Wa.node,Fa);return this.ZU(Ka,ma,ra,Da,va,Fa)}mVf(Ka,ma){return Ka&256?new da(this.dA):Ka&2?Ka&4096?new N(ma,this.ld,this.jk,H.App.instance.u3b,H.App.instance.xGb):new P(ma,this.ld,H.App.instance.xGb):
ma.Sa(Y.a.jdb)?new ca(ma,this.ld,H.App.instance.xGb):new N(ma,this.ld,this.jk,H.App.instance.u3b,H.App.instance.xGb)}static get C2g(){return A.a.w6a("Box4PasteScratchPad")}}Object(J.a)(Ja,"ClipboardActor",null,[])},693:function(J,V,d){J=d(0);var h=d(17),e=d(13),m=d(384),r=d(385);class v{constructor(G,E,I,Q=0,D=0,Y=null){this.commandId=G;this.controlId=E;this.timeStamp=I;this.commandSurface=m.a[Q];this.Ru=r.a[D];this.contentType=Y}}Object(J.a)(v,"CommandActionInfo",null,[]);class A{constructor(){this.lFh=
RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}RNj(G){return!this.lFh.exec(G)}}Object(J.a)(A,"EventsCacheLoggingUtils",null,[]);var x=d(25),y=d(1077),u=d(736);d.d(V,"a",function(){return H});class H{constructor(){this.Dcf=null;this.Swd=20;this.crc=this.Hib=this.ZKb=null}init(){this.Dcf=new A;this.ZKb=new h.a;this.Hib=new h.a;this.crc=new h.a;this.Swd=x.AFrameworkApplication.fa.Gc("MaxCommandClickedEventQueueSize",20);y.a.n2h(Object(e.a)(this,this.Bni,
"commandClickEventRaised"));u.a.instance.TBf(Object(e.a)(this,this.FFk,"recordActionEvent"))}vQe(G){G.count>this.Swd&&G.removeAt(this.Swd)}Bni(G,E){this.ZKb.insert(0,new v(E.commandId,E.controlId,E.time,E.commandSurface,E.Ru,E.contentType));this.vQe(this.ZKb)}FFk(G,E){this.Hib.insert(0,new v(E.actionName,"",E.timeStamp,E.commandSurface,E.Ru,E.contentType));this.vQe(this.Hib);this.Dcf.RNj(E.actionName)&&(this.crc.insert(0,new v(E.actionName,"",E.timeStamp,E.commandSurface,E.Ru,E.contentType)),this.vQe(this.crc))}static get instance(){return H.Ka||
(H.Ka=new H)}}H.Ka=null;Object(J.a)(H,"CommandClickEventsCache",null,[])},696:function(J,V,d){d.r(V);J=d(0);var h=d(701),e=d(25),m=d(45),r=d(55),v=d(114),A=d(1155),x=d(1156),y=d(22),u=d(320);const H=(P,ea)=>{if(P){P=P.trim().toLowerCase();if("true"===P)return!0;if("false"===P)return!1}return ea};var G=d(712),E=d(26),I=d(929),Q;(function(P){P[P.none=0]="none";P[P.internal=1]="internal";P[P.clipService=2]="clipService"})(Q||(Q={}));Object(J.b)("ClipboardIframeContent",Q);var D=d(373),Y=d(662),M=d(434),
N=d(42),W=d(47),K=d(52);d.d(V,"ClipboardHelper",function(){return ca});class ca{constructor(P,ea,da,ia,C,oa){this.FXj=[u.a.OY,u.a.Dp,u.a.location,u.a.eE,u.a.type,u.a.pte,u.a.count,u.a.YCa,u.a.WCa,u.a.Gfb,u.a.slideId,u.a.sessionId,u.a.timeStamp,u.a.Py];this.Pne=new h.a;this.dne=new A.a(x.a.rt());this.lq=P;this.oDg=ea;this.zc=oa;if(da&&0<da.length){P=da.split(";");for(const Z of P)P=this.oag(Z),0<P.length&&this.Pne.add(P)}this.GXj=ia;this.v1j=C;if(this.PSc()){ia=e.AFrameworkApplication.fa.Ia("PicklingAPIMaxPackageSizeInMB").split(";");
for(const Z of ia)ia=Z.split(":"),2===ia.length&&0<ia[0].length&&0<ia[1].length&&this.dne.add(ia[0],parseInt(ia[1]))}}Rmd(P,ea,da,ia,C,oa,Z){if(P.contentWindow&&P.contentWindow.document&&P.contentWindow.document.body){W.a.SCc(P);const Ja=W.a.Raa();if(N.a("ClipboardHelperOacr73010Fix")){var pa=document.createTextNode(W.a.Ose);Ja.appendChild(pa)}else Ja.innerHTML=W.a.kcc;pa=null;let Ka=0;if(!ea)E.a.J(557670874,826,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: internalClipboardObjects is empty for ccpCorrId: {0}",
Z),Sys.UI.DomElement.addCssClass(Ja,W.a.BSd);else if(ea.length&&ea[0]&&ea[0].E3a&&(Sys.UI.DomElement.addCssClass(Ja,this.lq.yq[0].E3a),Ka=1,da)){m.a.Xa(da.eE)&&E.a.J(558475200,307,10,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: DC was empty for the given ccpid: {0}",da.Dp);Ka=2;ea=G.a(da.dataType);Ja.setAttribute(u.a.OY,da.OY);Ja.setAttribute(u.a.JNa,da.JNa);Ja.setAttribute(u.a.Dp,da.Dp);Ja.setAttribute(u.a.version,da.version);Ja.setAttribute(u.a.location,da.location);Ja.setAttribute(u.a.eE,
da.eE);Ja.setAttribute(u.a.type,ea);Ja.setAttribute(u.a.count,da.objectCount.toString());Ja.setAttribute(u.a.YCa,da.YCa);Ja.setAttribute(u.a.WCa,da.WCa);Ja.setAttribute(u.a.Py,da.Py);var ya=(new Date).toUTCString();E.a.J(36749659,307,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: A {0} cut/copy:{1} was performed at UTC Time: {2}",ea,da.YCa,ya);Ja.setAttribute(u.a.timeStamp,ya);if(1===da.dataType||2===da.dataType)ya=e.AFrameworkApplication.fa.Ia(K.a.pa(361)),ea=String.format("{0}GetClipboardBytes.ashx",
ya)+"?Id="+m.a.Me(da.Dp)+"&DC="+m.a.Me(da.eE)+"&pkey="+m.a.Me(da.Py)+"&wdwaccluster="+m.a.Me(da.eE)+"&DataType="+ea,Ja.setAttribute(u.a.cmi,ea);da.pcc&&Ja.setAttribute(u.a.pte,this.hYk(da.pcc));1===da.dataType&&this.v1j&&(pa=W.a.FB(),pa.id=u.a.tkg,pa.setAttribute(u.a.Jsj,"true"),ea=e.AFrameworkApplication.fa.Ia(K.a.pa(361)),da=String.format("{0}GetClipboardImage.ashx",ea)+"?Id="+m.a.Me(da.Dp)+"&DC="+m.a.Me(da.eE)+"&pkey="+m.a.Me(da.Py)+"&wdwaccluster="+m.a.Me(da.eE),pa.src=da)}Ja.setAttribute(u.a.sessionId,
ia);Ja.setAttribute(u.a.Gfb,C?C.join(","):"");oa?Ja.setAttribute(u.a.slideId,oa.cid.toString()+"+"+oa.sid.toString()):Ja.setAttribute(u.a.slideId,"");P.contentWindow.document.body.appendChild(Ja);pa&&P.contentWindow.document.body.appendChild(pa);this.zc.ai(D.a.gti,Q[Ka],Z)}}wIj(P){var ea="";r.a.Gj?ea="Chromium":r.a.ag?ea="Firefox":r.a.n4b&&(ea="Safari");ea=this.dne.Kb(ea)?this.dne.ga(ea):0;(ea=Math.ceil(P)<=ea)||E.a.J(541893088,307,15,"Package size exceeds for pickling paste browser:{0}, size:{1}",
r.a.ey,P);return ea}oDj(P){return P&&Sys.UI.DomElement.containsCssClass(P,W.a.BSd)?!0:!1}rDj(P){return!!P&&!!P.getAttribute&&H(P.getAttribute(u.a.WCa),!1)}GNj(P){return!!P&&!!P.Om&&!!P.Om.firstChild&&!!P.Om.firstChild.className&&this.HNj(P.Om.firstChild.className)}HNj(P){return!!P&&P.startsWith("CID")&&v.a.isValid(P.substring(3,P.length))}xNj(P){return!!P&&!!P.Dp&&!!P.eE&&0!==P.dataType&&0<P.objectCount&&!!P.Py}m7k(P){if(!this.Hzj(P))return E.a.J(37535944,307,50,"DC '{0}' is not allowed",P.eE),!1;
if(P.Fqa&&"TimeStamp"in P.Fqa){var ea=new Date(Date.parse(P.Fqa.TimeStamp));P=60*this.GXj-5;ea=ca.RJf(ea);if(ea>=P)return E.a.J(37535946,307,50,"The data copied expired: expireTime: '{0}', elapsedTime: '{1}'.",P,ea),!1}return!0}oag(P){return P?P.trim().toUpperCase():""}Hzj(P){return!this.S7d(P)||this.Pne.contains(this.oag(P.eE))||this.Pne.contains("ALL")}yqg(P){return!!P&&!!P.yV&&!!P.yV.length&&!!P.yV[0]}zqg(P){return this.yqg(P)&&Object(y.a)(M.a,P.yV[0])}wAj(P){return this.yqg(P)&&Object(y.a)(Y.a,
P.yV[0])}p7d(P){return!!P&&!!P.Wt&&this.m7k(P.Wt)}vAj(P){return this.p7d(P)&&1===P.Wt.dataType}uAj(P){return this.p7d(P)&&2===P.Wt.dataType}tAj(P){return this.p7d(P)&&3===P.Wt.dataType}xAj(P){return!!P&&!!P.yL}yAj(P){return this.xAj(P)&&1===P.yL.contentType}PSc(){return!(r.a.Fw||r.a.n4b)&&e.AFrameworkApplication.fa.ka("PicklingAPISlidePasteEnabled")}kmi(P,ea){if(P&&ea&&P.getAttribute)for(const da of this.FXj){const ia=P.getAttribute(da);ia&&ea.setAttribute(da,ia)}}S7d(P){if(P.eE!==this.oDg)return E.a.J(21287185,
307,50,String.format("IsCrossDCPaste: It's a cross-dc paste '{0}': from '{1}' to '{2}', {3}.",G.a(P.dataType),P.eE,this.oDg,P.Dp)),!0;E.a.J(24945826,307,50,String.format("IsCrossDCPaste: It's a paste '{0}' in '{1}', {2}.",G.a(P.dataType),P.eE,P.Dp));return!1}AMi(P,ea){var da=P.getAttribute(u.a.Dp),ia=parseInt(P.getAttribute(u.a.version)),C=P.getAttribute(u.a.Py),oa=parseInt(P.getAttribute(u.a.OY)),Z=parseInt(P.getAttribute(u.a.JNa)),pa=P.getAttribute(u.a.type);pa=pa?G.b(pa):2;var ya=Object,Ja=ya.assign,
Ka=new I.a;oa=isNaN(oa)?32:oa;Z=isNaN(Z)?0:Z;ia=isNaN(ia)?0:ia;var ma=P.getAttribute(u.a.location),ra=P.getAttribute(u.a.eE),Da=P.getAttribute(u.a.count);Da=parseInt(Da);da=Ja.call(ya,Ka,{OY:oa,JNa:Z,Dp:da,version:ia,location:ma,eE:ra,dataType:pa,objectCount:isNaN(Da)?-1:Da,YCa:H(P.getAttribute(u.a.YCa),!1),WCa:H(P.getAttribute(u.a.WCa),!1),Py:C});C=ca.HMi(P);pa=ca.LMi(P);da.Fqa={["SessionId"]:C,["TimeStamp"]:pa?pa.toUTCString():""};ea=ca.OJd(da,pa,this.zc,ea);E.a.J(24945856,307,50,"ExtractClipboardObjectFromClipboard: {0}",
ea);if(P=P.getAttribute(u.a.pte))da.pcc=this.pDi(P);return da}hYk(P){return JSON.stringify(P)}pDi(P){try{return JSON.parse(P)}catch(ea){return E.a.J(21590115,826,15,"{0} when parse json string: {1}",ea.toString(),P),null}}static Qqg(P){return P&&P.Fqa&&"SessionId"in P.Fqa?ca.Ivg(P.Fqa.SessionId.toString()):!1}static Ivg(P){return m.a.Xa(P)||m.a.Xa(e.AFrameworkApplication.userSessionId)?!1:e.AFrameworkApplication.userSessionId.toLowerCase()===P.toLowerCase()}static OJd(P,ea,da,ia){const C=G.a(P.dataType);
P=String.format("A {0} ClipServiceObject was just created: '{1}'",C,P);ea&&(ea=ca.RJf(ea),P+=String.format(", time elapsed between COPY and PASTE: {0} seconds.",ea),da.ai("CopyPasteElapsedSec",ea.toString(),ia));return P}static HMi(P){P=P.getAttribute(u.a.sessionId);return void 0===P||null===P?"":P}static LMi(P){P=P.getAttribute(u.a.timeStamp);return void 0===P||null===P?null:new Date(Date.parse(P))}static RJf(P){var ea=new Date;if(!P)throw Error.argumentNull("fromTime");if(!ea)throw Error.argumentNull("toTime");
return(ea.getTime()-P.getTime())/1E3}}Object(J.a)(ca,"ClipboardHelper",null,[348])},710:function(J,V,d){J=d(0);var h=d(13),e=d(25),m=d(82),r=d(55),v=d(114);class A{constructor(E,I){this.message=E;this.Ri=I}}Object(J.a)(A,"CrossDocumentEventArgs",null,[]);var x=d(520),y=d(170),u=d(561),H=d(897);d.d(V,"a",function(){return G});class G{constructor(E,I,Q,D){this._name="";this.JJa={};this.ndf=null;this.LPb=[];this.xMb=[];this.yMb=[];this.XOb=[];this.Yvf=E;this.Xvf=I;this.N5={};this.K$={};this.GOb=Q;G._id++;
D&&D();this.NF=this.enable()}get OIa(){return this.Xvf}get $th(){return this.Yvf}enable(){if(!u.a())return H.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.jyj();H.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.NF}jyj(){H.a.debugAssertTag(5018253,!!this.GOb,null);this.ndf=Object(h.a)(this,this.lak,"messageListener");this.GOb.H9h(this.ndf)}disable(){this.NF=!1;this.LPb=[];this.xMb=[];this.yMb=[];this.XOb=[];this.Yvf=null;this.Xvf="";this.GOb.LDi();this.N5=
{};this.K$={}}dispose(){this.disable()}k9d(E){return!!this.LPb&&Array.contains(this.LPb,E)||this.Rtg(E)}Rtg(E){return!!this.xMb&&Array.contains(this.xMb,E)}Qt(E){H.a.debugAssertTag(5018259,!!this.LPb,null);Array.add(this.LPb,E);H.a.sendTraceTag(5018260,2,"Allow receiving : {0}",E)}Kzf(E){H.a.debugAssertTag(5018261,!!this.xMb,null);Array.add(this.xMb,E);H.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",E)}EGj(E){return!!this.yMb&&Array.contains(this.yMb,E)}Lzf(E){H.a.debugAssertTag(5018263,!!this.yMb,
null);Array.add(this.yMb,E);H.a.sendTraceTag(5018264,2,"Allow free sending: {0}",E)}R3b(E){E=m.a.hS(E);return!!E&&!!this.XOb&&Array.contains(this.XOb,E)}Myc(E){H.a.debugAssertTag(5018265,!!this.XOb,null);if(E===G.SSb)return H.a.debugAssertTag(5018266,!1,null),!1;const I=m.a.hS(E);if(!I)return H.a.sendTraceTag(5018267,4,"Get origin fail:{0}",E),!1;Array.add(this.XOb,I);H.a.sendTraceTag(5018268,2,"Add origin:{0}",I);return!0}send(E,I=null){let Q=this.OIa;if(I){I=m.a.hS(I);if(!I)return!1;Q=I}return this.Veb(E,
this.$th,Q)}sendMessage(E,I,Q=""){Q=Q&&""!==Q?Q:v.a.create().toString();return this.send(this.Dwe(E,I,Q,e.AFrameworkApplication.userSessionId))}postMessage(E){const I=v.a.create().toString();if(!e.AFrameworkApplication.fa.ka("RetryablePostMessagingIsEnabled")||!E.shouldRetry)return this.send(this.Dwe(E.messageId,E.values,I,E.userSessionId));if(!this.N5[E.wyc]){this.Qt(E.wyc);const Q=Object(h.a)(this,this.ackMessageHandler,"ackMessageHandler");this.cB(E.wyc,Q)}this.JJa[I]="";return this.h4g(E,I,1)}h4g(E,
I,Q){if(""!==I&&I in this.JJa&&"ACK_RECEIVED"===this.JJa[I])return delete this.JJa[I],!0;if(Q>E.Gua)return H.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',E.wyc,I),delete this.JJa[I],!1;H.a.sendTraceTag(40716251,1<Q?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',E.Gua-Q,E.messageId,I);Q++;window.setTimeout(()=>{this.h4g(E,I,Q)},E.nXh);E.values[y.a.mXh]=!0;return this.send(this.Dwe(E.messageId,E.values,I,E.userSessionId))}ackMessageHandler(E){E=
E.CorrelationId;""!==E&&E in this.JJa&&(H.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.JJa[E],E),this.JJa[E]="ACK_RECEIVED")}Dwe(E,I,Q,D){E=new x.a(E);E.CorrelationId=Q;I&&(E.Values=I);E.Values.wdUserSession=D;return E}Veb(E,I,Q){H.a.debugAssertTag(5018269,!!E,null);if(!this.NF)return!1;H.a.debugAssertTag(5018270,!!I,null);H.a.debugAssertTag(5018271,!!Q,null);if(!I||!Q)return H.a.debugAssertTag(5018272,!1,null),!1;if(Q===G.SSb&&!this.EGj(E.MessageId))return H.a.sendTraceTag(5018273,
1,"Got unregistered message {0}",{["id"]:E.MessageId}),!1;E.SendTime=(new Date).getTime();let D="";try{D=Sys.Serialization.JavaScriptSerializer.serialize(E)}catch(Y){return H.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:Y.message}),!1}I=G.sendMessage(I,D,Q);H.a.sendTraceTag(5018275,2,"Send {0}. {1}",I?"succeeded":"failed",{["id"]:E.MessageId,["origin"]:Q});return I}cB(E,I){H.a.debugAssertTag(5018304,!!I,null);H.a.debugAssertTag(5018305,!!this.N5&&!!this.K$,null);this.NF&&(this.k9d(E)?
this.N5[E]!==I&&(H.a.debugAssertTag(5018307,!this.N5[E]&&!this.K$[E],null),this.N5[E]=I,delete this.K$[E]):H.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:E}))}EWa(E,I){H.a.debugAssertTag(40420062,!!I,null);H.a.debugAssertTag(40420063,!!this.K$&&!!this.N5,null);this.NF&&(this.k9d(E)?this.K$[E]!==I&&(H.a.debugAssertTag(40420065,!this.N5[E]&&!this.K$[E],null),this.K$[E]=I,delete this.N5[E]):H.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:E}))}ypl(E){this.NF&&(this.N5[E]&&
delete this.N5[E],this.K$[E]&&delete this.K$[E])}lak(E){const I=this.f5i(E);if(!I)return!1;if(this.N5[I.MessageId])return this.GOb.KQc(this.N5[I.MessageId],I),!0;if(this.K$[I.MessageId]){let Q=this.K$[I.MessageId];E=new A(I,E);this.GOb.Syj(Q,E);return!0}return!1}f5i(E){const I=new Date;this.fVj(E);if(!E.origin||!E.source||void 0===E.data||null===E.data)return H.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const Q=this.FOj(E.data);if(!Q)return null;if(!this.R3b(E.origin)){if(!this.Rtg(Q.MessageId))return H.a.sendTraceTag(5018309,
1,"{0}",{["id"]:Q.MessageId}),null;if(!r.a.n8a&&E.source!==this.$th)return H.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}H.a.debugAssertTag(5018311,!!Q.Values,null);Q.Values.m_Source=E.source;Q.Values.m_Origin=E.origin;Q.Values.m_ReceivedTime=I.getTime();return Q}FOj(E){if(!E)return null;let I=null;try{I=Sys.Serialization.JavaScriptSerializer.deserialize(E,!0)}catch(Y){return 2>G.dZe&&(H.a.sendTraceTag(5018312,2,"Deser failed"),G.dZe++),null}if(!I)return H.a.debugAssertTag(5018313,
!1,null),null;for(E=0;E<G.lFc.length;E++)if(!I[G.lFc[E]])return"MessageId"!==G.lFc[E]&&H.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",G.lFc[E]),null;if(I.Values)try{I.Values}catch(Y){return H.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",Y.message),null}else H.a.sendTraceTag(41502556,2,"No values in message");E=I.MessageId;if(!this.k9d(E))return H.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:E}),null;const Q=I.SendTime,D=(new Date).getTime()-Q;if(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendTimeCheckRemovalIsEnabled",
!1)){if(0>Q)return H.a.sendTraceTag(520435660,2,"{0}",{["t"]:Q,["id"]:E}),null;if(6E4<D)return H.a.sendTraceTag(520435659,2,"{0}",{["t"]:Q,["delta"]:D,["id"]:E}),null;-300>D&&H.a.sendTraceTag(520435658,2,"{0}",{["t"]:Q,["delta"]:D,["id"]:E})}else{if(0>Q||-100>D)return H.a.sendTraceTag(5018316,2,"{0}",{["t"]:Q,["delta"]:D,["id"]:E}),null;if(6E4<D)return H.a.sendTraceTag(5018317,2,"{0}",{["t"]:Q}),null}E=new x.a;E.MessageId=I.MessageId;E.SendTime=I.SendTime;E.CorrelationId=I.CorrelationId;I.Values&&
(E.Values=I.Values);H.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",E.MessageId,E.SendTime,E.CorrelationId);return E}fVj(E){H.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:E.origin,["data"]:E.data,["source"]:E.source}))}static sendMessage(E,I,Q){if(!u.a())return H.a.debugAssertTag(5018319,!1,null),!1;try{return E.postMessage(I,Q),!0}catch(D){H.a.sendTraceTag(5018320,4,"{0}",{["exception"]:D.message})}return!1}}G.lFc=["MessageId",
"SendTime"];G.SSb="*";G._id=0;G.dZe=0;Object(J.a)(G,"CrossDocumentMessenger",null,[109,671])},712:function(J,V,d){J=d(0);class h{}h.slideType="slide";h.shapeType="shape";h.zob="chart";Object(J.a)(h,"ClipserviceDataConstants",null,[]);d.d(V,"b",function(){return e});d.d(V,"a",function(){return m});const e=r=>r===h.slideType?1:r===h.shapeType?2:r===h.zob?3:0,m=r=>1===r?h.slideType:2===r?h.shapeType:""},713:function(J,V,d){J=d(0);var h=d(17),e=d(45),m=d(824),r=d(237),v=d(256),A=d(224),x=d(487);class y{constructor(H,
G){this.aXa=H;this.description=G}}Object(J.a)(y,"ColorEntry",null,[]);d.d(V,"a",function(){return u});class u{constructor(H){this.qee={};this.ype=null;this.em=H}get Kdl(){if(!this.ype){const H=new Sys.StringBuilder;for(let G of this.standardColors)H.append(String.format(u.mKd,this.lvh(G.aXa),this.yPe(G.aXa),G.description));this.ype=H.toString()}return this.ype}get standardColors(){let H;return H=new h.a,H.add(new y(12582912,ResourceStrings.L_FontColorDarkRed)),H.add(new y(16711680,ResourceStrings.L_FontColorRed)),
H.add(new y(16760832,ResourceStrings.L_FontColorOrange)),H.add(new y(16776960,ResourceStrings.L_FontColorYellow)),H.add(new y(9621584,ResourceStrings.L_FontColorLightGreen)),H.add(new y(45136,ResourceStrings.L_FontColorDarkGreen)),H.add(new y(45296,ResourceStrings.L_FontColorLightBlue)),H.add(new y(28864,ResourceStrings.L_FontColorBlue)),H.add(new y(8288,ResourceStrings.L_FontColorDarkBlue)),H.add(new y(7352480,ResourceStrings.L_FontColorPurple)),H}lvh(H){return String.format("#{0}",A.i(H))}yPe(H){return A.i(H)}kmc(H){return Object.assign(new v.a,
{ThemeColor:H.ThemeColor,ColorLuminance:H.ColorLuminance,FTintColor:H.FTintColor}).toString()}S1d(H,G,E){const I=new Sys.StringBuilder;I.append(this.MJd("ThemeColors",ResourceStrings.L_ThemeFontColor,!0,H));this.v0h(I);I.append(this.LJd());I.append(this.MJd("StandardColors",ResourceStrings.L_StandardFontColor,!1,H));I.append(this.Kdl);I.append(this.LJd());G&&0<G.length&&(I.append(this.MJd("RecentColors",ResourceStrings.L_RecentColors,!1,E)),I.append(this.S8i(G)),I.append(this.LJd()));return I.toString()}S8i(H){const G=
new Sys.StringBuilder;for(let E=0;E<H.length;E++){const I=H[E];G.append(String.format(u.mKd,"#"+I.hex,I.hex,"#"+I.hex))}return G.toString()}MJd(H,G,E,I){return String.format(u.Aei,H,G,"ColorPicker",E?'McuLayout = "true" ':"",I)}LJd(){return u.zei}v0h(H){const G=Array(10);G[0]=this.mK(r.Color.Mi(this.em.PresetSchemeColorMapping.Background1));G[1]=this.mK(r.Color.Mi(this.em.PresetSchemeColorMapping.Text1));G[2]=this.mK(r.Color.Mi(this.em.PresetSchemeColorMapping.Background2));G[3]=this.mK(r.Color.Mi(this.em.PresetSchemeColorMapping.Text2));
G[4]=this.mK(r.Color.Mi(this.em.PresetSchemeColorMapping.Accent1));G[5]=this.mK(r.Color.Mi(this.em.PresetSchemeColorMapping.Accent2));G[6]=this.mK(r.Color.Mi(this.em.PresetSchemeColorMapping.Accent3));G[7]=this.mK(r.Color.Mi(this.em.PresetSchemeColorMapping.Accent4));G[8]=this.mK(r.Color.Mi(this.em.PresetSchemeColorMapping.Accent5));G[9]=this.mK(r.Color.Mi(this.em.PresetSchemeColorMapping.Accent6));const E=Array(10);E[0]=ResourceStrings.l_ThemeLabel1;E[1]=ResourceStrings.l_ThemeLabel2;E[2]=ResourceStrings.l_ThemeLabel3;
E[3]=ResourceStrings.l_ThemeLabel4;E[4]=ResourceStrings.l_ThemeLabel5;E[5]=ResourceStrings.l_ThemeLabel6;E[6]=ResourceStrings.l_ThemeLabel7;E[7]=ResourceStrings.l_ThemeLabel8;E[8]=ResourceStrings.l_ThemeLabel9;E[9]=ResourceStrings.l_ThemeLabel10;for(let I=0;5>=I;I++)for(let Q=0;Q<G.length;Q++)H.append(this.HUi(G[Q][I],G[Q][0],E[Q],I,Q))}mK(H){const G=e.a.Dv(H.r,2)+e.a.Dv(H.g,2)+e.a.Dv(H.b,2);if(this.qee[G])return this.qee[G];const E=x.a.oPa(H),I=[];Array.add(I,H);if(H.cUd())for(var Q=0;Q<m.a.OCh.length;++Q)H=
x.a.zZb(E),H.darken(m.a.OCh[Q]/100),Array.add(I,H.ura());else if(H.gNi())for(Q=0;Q<m.a.fHf.length;++Q)H=x.a.zZb(E),H.lighten(m.a.fHf[Q]/100),Array.add(I,H.ura());else if(E.lum<u.kei)for(Q=0;Q<m.a.UAg.length;++Q)H=x.a.zZb(E),H.lighten(m.a.UAg[Q]/100),Array.add(I,H.ura());else if(E.lum>u.jei)for(Q=0;Q<m.a.TAg.length;++Q)H=x.a.zZb(E),H.darken(m.a.TAg[Q]/100),Array.add(I,H.ura());else for(Q=0;Q<m.a.wDc.length+m.a.UNf.length;++Q)H=x.a.zZb(E),Q<m.a.wDc.length?H.lighten(m.a.wDc[Q]/100):H.darken(m.a.UNf[Q-
m.a.wDc.length]/100),Array.add(I,H.ura());return this.qee[G]=I}HUi(H,G,E,I,Q){H=this.yPe(H.aXa);({uDc:G,lIb:E}=this.IXd(G,H,E,I,Q));return String.format(u.mKd,G,H,E)}IXd(H,G,E,I,Q){var D;var Y=D=null;if(0>I)return{uDc:D,lIb:Y};G=Object.assign(new v.a,{RGBColor:G,ThemeColor:Q,ColorLuminance:0,FTintColor:!1});I?(Q=x.a.oPa(H),Y=I-1,Q.lum?1===Q.lum?(I=!1,Y=[242,217,191,166,127][Y]):.8<Q.lum?(I=!1,Y=[229,191,127,64,25][Y]):.2>Q.lum?(I=!0,Y=[25,64,127,191,229][Y]):(Q=[51,102,153],D=[191,127],Y=(I=Y<Q.length)?
Q[Y]:D[Y-Q.length]):(I=!0,Y=[127,166,191,217,242][Y]),Y=255-Y,Y=Math.round(100*Y/255),G.ColorLuminance=100-Y,G.FTintColor=I,Y=String.format(I?ResourceStrings.l_ColorPickerTooltipTint:ResourceStrings.l_ColorPickerTooltipShade,H.toString(),E,Y)):Y=String.format(ResourceStrings.l_ColorPickerTooltipBase,H.toString(),E);D=this.kmc(G);return{uDc:D,lIb:Y}}}u.Aei='<MenuSection Id="{0}" Title="{1}"><Controls Id="Color.Menu.Controls"><ColorPicker Id="{2}" {3}Width="10" Command="{4}"><Colors>';u.zei="</Colors></ColorPicker></Controls></MenuSection>";
u.mKd='<Color Color="{0}" DisplayColor="#{1}" Alt="{2}" />';u.kei=.2;u.jei=.8;Object(J.a)(u,"ColorPickerBuilder",null,[])},884:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.Lse="TraceIdNoBar";h.YUc="TraceIdLeftBar";h.Kdd="TraceIdRightBar";h.hBc="TraceIdBothBar";Object(J.a)(h,"ConsistencyCheckTraceIdType",null,[])},885:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(510);class e{constructor(){this.start=new h.a;this.end=new h.a}clone(){return Object.assign(new e,
{start:this.start.clone(),end:this.end.clone()})}merge(m){let r=!1;m.start&&(r=this.start.merge(m.start));m.end&&(r=this.end.merge(m.end)||r);return r}}Object(J.a)(e,"TextNodeSelection",null,[])},886:function(J,V,d){d.d(V,"a",function(){return 19})},887:function(J,V,d){d.r(V);d.d(V,"WordPredictionAugLoopResponseManager",function(){return u});J=d(0);V=d(17);var h=d(337),e=d(888),m=d(644),r=d(642),v=d(643),A=d(538),x=d(62),y=d(31);class u{g1b(H){u.QR.sF(()=>{this.p6k(H)||(this.bQe(H),this.cul(),this.dFf(!0))},
"WPT:PR")}dFf(H=!1){const G=A.a.YC.o4,E=A.a.YC.vdb;if(G){var I=x.a.instance.Pa.kb;if(I&&I.We&&A.a.Hqg(I.We)){I=I.We.node;var Q=y.ParagraphReader.text(I);Q=Q.substring(G.Wed,Q.length);I=this.VYd(I,G,Q);"string"===typeof I?I.length?(G.i7=I,G.SGb+=1,A.a.JHd(G.text,I),H&&(this.ftl(),G.Rwe=Q,this.etl(G))):E&&0===E[m.a.status]?(this.mAh(),A.a.hdd()):this.vul():(this.mAh(),A.a.hdd())}}}etl(H){u.nnd.count>=u.MOh&&u.nnd.removeAt(0);u.nnd.add(this.jmi(H))}jmi(H){return Object.assign(new e.a,{id:H.id,Bwa:H.Bwa,
Uw:H.Uw,Wed:H.Wed,text:H.text,i7:H.i7,wUb:H.wUb,s3a:H.s3a,score:H.score,MPe:H.MPe,LPe:H.LPe,xO:H.xO,SGb:H.SGb,Rwe:H.Rwe})}p6k(H){if(H&&H.parentPath&&7===H.parentPath.length){const G=H.parentPath[6];A.a.gWa.add(G,v.a.kHd,(new Date).getTime());A.a.ZSj(G)}else return A.a.F5b(v.a.DSd),!0;return A.a.HRa?(H=this.veg(H),H=this.a5g(H[0]),H[m.a.status]=5,A.a.EVd(H),A.a.F5b(v.a.Tph),!0):!1}bQe(H){(H=this.veg(H))&&H.length?(A.a.YC.o4=H[0],A.a.YC.zvh=H.length,A.a.YC.vdb=this.a5g(H[0])):(A.a.hdd(),A.a.F5b(v.a.DSd))}veg(H){if(!H||
!H.items||!H.parentPath||7!==H.parentPath.length)return null;var G=H.items[0];let E;try{E=G.body}catch(M){return null}G=H.parentPath[2];const I=parseInt(H.parentPath[3]),Q=parseInt(H.parentPath[4]),D=H.parentPath[5];H=H.parentPath[6];if(!E.predictions.length)return null;A.a.T0k(E.modelInfo);const Y=Array(E.predictions.length);for(let M=0;M<E.predictions.length;M++){const N=E.predictions[M];if(N.text){const W=N.characterRange,K=N.tokenRange;Y[M]=Object.assign(new e.a,{id:D,Bwa:H,Uw:G,Wed:I,text:N.text,
i7:N.text.substr(W.start),wUb:W.start,s3a:W.length,score:N.score,MPe:K.start,LPe:K.length,xO:Q,SGb:0})}}return Y}a5g(H){const G={};G[m.a.language]="en-US";const E=A.a.u5i();G[m.a.modelId]=E.modelId;G[m.a.modelVersion]=E.modelVersion;G[m.a.configId]=E.configId;G[m.a.wLd]=H.s3a;G[m.a.BCc]=H.s3a;G[m.a.Zxg]=H.i7.length;G[m.a.T4g]=H.text.length;G[m.a.W4g]=H.text.split(" ").length;G[m.a.score]=H.score;G[m.a.status]=0;G[m.a.rRe]=H.i7.length;G[m.a.xO]=H.xO;H=A.a.gWa.ga(H.Bwa);G[m.a.dvh]=H[v.a.kHd]-H[v.a.Ekc];
G[m.a.Pjd]=0;return G}cul(){const H=A.a.YC.o4;H&&(A.a.Bsa(H.xO,r.a.XKf,A.a.YC.zvh),A.a.Bsa(H.xO,r.a.USf,H.s3a))}ftl(){const H=A.a.YC.o4,G=A.a.YC.vdb;if(H&&1===H.SGb){const E=(new Date).getTime();A.a.gWa.Hkg(H.Bwa,v.a.JDf,E);A.a.Vzg(H.Bwa,!0);A.a.F5b(v.a.V4g);const I=A.a.gWa.ga(H.Bwa)[v.a.Ekc];G[m.a.Pjd]=E-I;G[m.a.status]=1;G[m.a.BCc]=H.text.length-H.i7.length;A.a.Bsa(H.xO,r.a.qhh,1);A.a.Bsa(H.xO,r.a.Qch,1);A.a.Bsa(H.xO,r.a.Rch,H.i7.length);A.a.Bsa(H.xO,r.a.VSf,H.text.length-H.i7.length);A.a.Dwk()}}vul(){const H=
A.a.YC.o4,G=A.a.YC.vdb;H&&(G[m.a.status]=3,G[m.a.BCc]=0,G[m.a.rRe]=H.text.length-G[m.a.wLd],A.a.EVd(G),A.a.Bsa(H.xO,r.a.Zxh,1),A.a.Bsa(H.xO,r.a.XSf,H.score),A.a.Bsa(H.xO,r.a.$xh,H.text.length-H.s3a),A.a.hdd())}mAh(){const H=A.a.YC.o4,G=A.a.YC.vdb;if(H){if(0===G[m.a.status]){const E=(new Date).getTime();A.a.gWa.Hkg(H.Bwa,v.a.HDf,E);A.a.Vzg(H.Bwa,!1);A.a.F5b(v.a.U4g);const I=A.a.gWa.ga(H.Bwa)[v.a.Ekc];G[m.a.Pjd]=E-I;A.a.Bsa(H.xO,r.a.VTg,1);G[m.a.status]=6}A.a.EVd(G)}}VYd(H,G,E){let I=null;G.Uw===H.id.toString()&&
E&&G.wUb<E.length&&(H=E.substring(0,G.wUb)+G.text,H=H.replace(RegExp("\\u00a0","g")," "),E=E.replace(RegExp("\\u00a0","g")," "),0<H.length&&0<E.length&&(H.indexOf(E)||(I=H.substring(E.length,H.length))));return I}static get QR(){return h.a.instance}}u.MOh=4;u.nnd=new V.a;Object(J.a)(u,"WordPredictionAugLoopResponseManager",null,[])},888:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Uw=this.Bwa=this.id=null;this.xO=this.Wed=0;this.i7=this.text=null;this.SGb=this.LPe=
this.MPe=this.score=this.s3a=this.wUb=0;this.Rwe=null}}Object(J.a)(h,"Candidate",null,[])},889:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.stateUpdateHandler=this.handler=this.config=this.annotationType=null}}Object(J.a)(h,"ActivateAnnotationParameters",null,[])},890:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(596);var h=d(128);class e extends V.a{constructor(){super();this.tokenRange=this.predictions=this.modelInfo=this.characterRange=null;this.H_=
Object.assign(new h.a,{T_:e.getTypeName(),B_:e.jl()})}static getTypeName(){return"AugLoop_Text_TextPredictionAnnotation"}static jl(){return["AugLoop_Core_Annotation"]}}Object(J.a)(e,"TextPredictionAnnotation",V.a,[])},891:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.operation=null}}Object(J.a)(h,"SubmitOperationParameters",null,[])},892:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(254);var h=d(128);class e extends V.a{constructor(){super();this.timestamp=
this.targetObject=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.jl()})}static getTypeName(){return"AugLoop_Signals_Signal"}static jl(){return[]}}Object(J.a)(e,"Signal",V.a,[])},893:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m,r){super();this.actionId=e;this.xub=m;this.revisionId=r}}Object(J.a)(h,"UndoRedoMarkedUndoEventArgs",Sys.EventArgs,[])},894:function(J,V,d){d.d(V,"c",function(){return v});d.d(V,"b",function(){return A});d.d(V,
"a",function(){return x});var h=d(17),e=d(374),m=d(25),r=d(33);const v=y=>{if(!y)return null;let u;try{u=r.b(y)}catch(H){u=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",H)}return u},A=(y,u)=>{let H=[];if(y.breadcrumbs&&0<y.breadcrumbs.length)H=y.breadcrumbs;else{const G=y.service_info;G&&G.friendly_service_name&&Array.add(H,G.friendly_service_name);y.display_path&&Array.addRange(H,y.display_path)}return H.join(u?" \u00ab ":" \u200f\u00bb ")},
x=(y,u=!1)=>{if(!y)return[];if(!y.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!y.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];y=y.documents.items;const H=new h.a;for(let E=0;E<y.length;E++){const I=y[E];var G=I.web_url;if(!G){e.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!I.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}G=String.format("{0}?web=1",I.url)}const Q={};Q.DocumentUrl=G;Q.MruId=
I.mru_id;{G=I;let D=G.title;D?(G.extension&&(D=String.format("{0}.{1}",D,G.extension)),G=D):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),G="")}Q.FileName=G;Q.IsPinned=I.is_pinned;Q.Path=A(I,m.AFrameworkApplication.isRtl);u&&(Q.App=I.app,Q.TimeStamp=I.time_stamp);H.add(Q)}return H.toArray()}},895:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(374),e=d(981),m=d(1154),r=d(13),v=d(17),A=d(36),x=d(42);class y{constructor(u,H,G,E,I,Q,D,Y,M){this.BQ=new e.a;this.$Lg=u;this.Ub=
H;this.LK=I;this.Fa=G;this.Zd=Q;this.e6b=D;this.fk=E;this.Zh=Y;this.la=M;this.duj()}get Ce(){return this.Zd.instance}get zE(){return this.e6b.value}duj(){this.BQ.$(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.BQ.$(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.BQ.$(2,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.BQ.$(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.BQ.$(8,[ResourceStrings.l_PhTypeObject,
ResourceStrings.l_ClickToAddText]);this.BQ.$(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.BQ.$(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.BQ.$(11,[ResourceStrings.l_PhTypeClipArt,ResourceStrings.l_InsertContent]);this.BQ.$(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);this.BQ.$(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);this.BQ.$(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);
this.BQ.$(6,[ResourceStrings.l_PhTypeFooter,ResourceStrings.l_ClickToAddFooter]);this.BQ.$(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber])}Acg(u,H){u&&(this.zra(u,H),u.osa?H.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.H_d(u,null,H));return null}saj(u){if(!this.$Lg.instance||!u)return null;u=this.$Lg.instance.Fcg(u);if(!u||!u.length)return null;const H=u.length;return 1===H?String.format(ResourceStrings.l_ShapePresenceForOneUser,u[0].userName):
2===H?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,u[0].userName,u[1].userName):3===H?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,u[0].userName,u[1].userName,u[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,H)}r1d(u){let H="";u&&u.GV&&u.image.title&&0<u.image.title.length&&(H=u.image.title);u&&(H=String.format(ResourceStrings.l_ThumbnailInfoNew,u.slideIndex+1,this.Ub.wj(),H),u=this.Gdj(u),0<u.length&&(H+=u));return H}Gdj(u){const H=new Sys.StringBuilder;
u.isSelected&&H.append(ResourceStrings.L_SlideIsSelected);u.zn&&H.append(ResourceStrings.l_SlideIsHidden);const G=Object(m.a)(132,u.Ud);if(G){var E=G.TPa();E&&!this.fk.t9d(E)&&H.append(ResourceStrings.l_SlideHasNotes);(E=G.KE())&&this.LK.instance&&this.LK.instance.Rhg(E)&&(E=this.LK.instance.NXd(E),H.append(1===E?ResourceStrings.l_SlideHasOneComment:String.format(ResourceStrings.l_SlideHasCommentsWithCount,E)))}u.v2&&H.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(u.lDb&&(u=u.lDb.$ha())&&
0<u.length)if(1===u.length)H.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,u[0].userName));else{E="";for(const I of u)E+=I.userName+",";H.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,E))}G&&G.Bs&&H.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);return H.toString()}n6a(u,H){return String.format(ResourceStrings.l_MultipleSlidesSelected,u,H)}A_i(u,H){return String.format(ResourceStrings.l_DesignerSuggestionSelected,u+1,H)}Taj(){return ResourceStrings.l_SlidePanel}L5i(){return ResourceStrings.l_MultipleShapes}gJk(u){u&&
(this.la.p3a&&u.s4(Object(r.a)(this,this.iXi,"getCameoAccMessage")),u.s4(Object(r.a)(this,this.Ecj,"getTableAccMessage")),u.s4(Object(r.a)(this,this.C2i,"getImageAccMessage")),u.s4(Object(r.a)(this,this.V4i,"getMediaAccMessage")),u.s4(Object(r.a)(this,this.xXi,"getChartAccMessage")),this.Ogd?(u.s4(Object(r.a)(this,this.Xcg,"getSmartArtAccMessage")),u.s4(Object(r.a)(this,this.H_d,"getPlaceHolderAccMessage"))):(u.s4(Object(r.a)(this,this.H_d,"getPlaceHolderAccMessage")),u.s4(Object(r.a)(this,this.Xcg,
"getSmartArtAccMessage"))),u.s4(Object(r.a)(this,this.wdj,"getTextboxAccMessage")),u.s4(Object(r.a)(this,this.gaj,"getShapeGroupAccMessage")),u.s4(Object(r.a)(this,this.daj,"getShapeAccMessage")),u.s4(Object(r.a)(this,this.vVi,"getAddinAccMessage")),u.s4(Object(r.a)(this,this.aVi,"get3DAccMessage")))}H_d(u,H,G,E=null){if(u&&G&&u.ll&&(this.uNc(u,G),H=u.get_altTitle(),this.BQ.Kb(u.zj))){E&&E(String.format("{0} {1}",this.BQ.ga(u.zj)[0],ResourceStrings.l_Placeholder));if(u.vS||!G.count){G=this.BQ.ga(u.zj)[0];
E="";if(!this.Ogd||u.vS)E=this.BQ.ga(u.zj)[1];return String.format(u.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,G,H,E,u.get_alt())}u=String.format(u.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,this.BQ.ga(u.zj)[0],H,u.get_alt());G.insert(0,document.createTextNode(u))}return null}wdj(u,H,G,E=null){if(u&&G&&u.xx)if(this.uNc(u,G),E&&E(ResourceStrings.L_TextBox),0<G.count)u=String.format(u.get_alt()?
ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,u.get_altTitle(),u.get_alt()),G.insert(0,document.createTextNode(u));else return String.format(u.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,u.get_altTitle(),u.get_alt());return null}Xcg(u,H,G,E=null){if(u&&G&&u.fg)if(this.uNc(u,G),E&&E(ResourceStrings.L_SmartArt),0<G.count)u=String.format(u.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,
this.Zcg(u)||"",u.get_altTitle(),u.get_alt()),G.insert(0,document.createTextNode(u));else return String.format(u.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.Zcg(u)||"",u.get_altTitle(),u.get_alt());return null}zra(u,H){u&&H&&this.Fa.RI(u,G=>{G.Sa(A.a.Vp)&&this.j$f(G,H)})}uNc(u,H){if(u&&H){const G=this.Ogd?new v.a:H;let E=!1;this.Fa.RI(u,I=>{const Q=this.Zh.FV(I),D=this.Zh.cdb(I);Q&&G.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,
D)));E=this.j$f(I,G)||E});this.Ogd&&E&&H.addRange(G);H.count||(u=u.POe)&&H.add(document.createTextNode(u))}}get Ogd(){return x.a("AriaMessageHelper.FixAccMessageForEmptyList")}j$f(u,H){let G;const E=u.ta(A.a.Rlc,null),I=u.ta(A.a.Vp,"");if(I&&H){if(E){let Q=0,D=null,Y;for(let M=0;M<E.length+1;M++)Y=this.Fa.VLc(u,M),D&&D!==Y&&(G=document.createElement("span"),G.setAttribute("lang",D),G.innerText=I.substring(Q,E[M-1]),Q=E[M-1],H.add(G)),D=Y;G=document.createElement("span");D&&G.setAttribute("lang",D);
G.innerText=I.substring(Q,I.length)}else G=document.createElement("span"),(u=this.Fa.VLc(u,0))&&G.setAttribute("lang",u),G.innerText=I;H.add(G)}return!!I&&0<I.length}Ecj(u,H,G,E=null){return u&&u.rd?(E&&E(ResourceStrings.L_Table),String.format(u.get_alt()?ResourceStrings.l_AccMessageTableAlt:ResourceStrings.l_AccMessageTable,u.get_altTitle(),u.get_alt())):null}C2i(u,H,G,E=null){return u&&u.sk?(E&&E(ResourceStrings.l_Image),String.format(u.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,
u.get_altTitle(),u.get_alt())):null}iXi(u,H,G,E=null){if(!u||!u.eDa)return null;E&&E(ResourceStrings.l_Cameo);return u.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,u.get_altTitle(),u.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):String.format(ResourceStrings.l_AccMessageCameo,u.get_altTitle(),ResourceStrings.l_CameoLearnMoreMessage)}V4i(u,H,G,E=null){if(u){if(0===u.mediaType)return null;if(1===u.mediaType)return E&&E(ResourceStrings.l_Audio),this.la.gP?String.format(ResourceStrings.l_AccMessageCanvasAudio,
u.shapeName):String.format(u.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,u.get_altTitle(),u.get_alt());if(2===u.mediaType)return E&&E(ResourceStrings.l_Video),String.format(u.get_alt()?ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,u.get_altTitle(),u.get_alt())}return null}xXi(u,H,G,E=null){return u&&u.Gq?(E&&E(ResourceStrings.l_Chart),String.format(u.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.yXi(u)||
"",u.get_altTitle(),u.get_alt())):null}gaj(u,H,G,E=null){return u&&u.Xf?(E&&E(ResourceStrings.L_GroupObjects),x.a("GroupShapeAltTitleFixEnabled")?String.format(u.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,u.my().length,u.get_alt()):String.format(u.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,u.get_altTitle(),u.get_alt())):null}daj(u,H,G,E=null){if(u&&G&&u.osa&&!u.xx)if(this.uNc(u,G),H=this.Fa.Hcg(u),u.UCa&&
(H=ResourceStrings.l_DecorativeLabel),E&&E(H||ResourceStrings.l_TextShape),0<G.count)u=String.format(u.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,H||ResourceStrings.l_TextShape,u.get_altTitle(),u.get_alt()),G.insert(0,document.createTextNode(u));else return String.format(u.get_alt()?ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,H||ResourceStrings.l_TextShape,u.get_altTitle(),u.get_alt());return null}vVi(u,H,G,
E=null){return u&&u.ar&&this.Ce&&this.zE?(u=this.zE.M1(u),u=this.Ce.qrb(u.id),E&&E(u?u.Ega:null),u?u.Ega:null):null}aVi(u,H,G,E=null){return u&&u.t7?(E&&E(ResourceStrings.l_3DModel),String.format(u.get_alt()?ResourceStrings.l_AccMessage3DAlt:ResourceStrings.l_AccMessage3D,u.get_altTitle(),u.get_alt())):null}Zcg(u){return u.smartArtInfo?y.t0d(u.smartArtInfo.SmartArtLayout,1,177,"L_SAType"):(h.ULS.sendTraceTag(588375196,815,10,"SmartArt {0}#{1} has no SmartArtInfo",u.slideId?u.slideId.toString():"",
u.get_shapeId()),null)}yXi(u){return y.t0d(u.zob,0,102,"L_ChartType")}taj(u,H){return(u=this.Fa.NMc(u))&&H?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,H,u):null}static vdj(u){return y.t0d(u,1,177,"L_SAType")}static t0d(u,H,G,E){return u>=H&&u<=G&&(u=ResourceStrings[E+u])?u:null}}Object(J.a)(y,"AriaMessageHelper",null,[567])},896:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m=null,r=null,v=null,A=!1,x=null){this.DisplayName=this.ClientId=this.Provider=
this.UserId=null;this.IsAnonymous=!1;this.Email=null;this.UserId=e;this.Provider=m;this.DisplayName=r;this.Email=v;this.IsAnonymous=A;this.ClientId=x}}Object(J.a)(h,"Person",null,[])},897:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{static YXk(){}static yBi(){}}h.sendTraceTag=h.YXk;h.debugAssertTag=h.yBi;Object(J.a)(h,"BULS",null,[])},898:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(973),e=d(25),m=d(163),r=d(57);class v{constructor(A,x,y,u,H,G){this.aaa=A;this.baa=
x;this.ttd=y;this.AO=u;this.sqc=H;this.iib=G}get Koh(){return!this.baa&&!this.ttd}get MUg(){return 2===this.iib?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get h_f(){return CommonUIStrings.l_OICErrorMessageNoOffice}get Kjg(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get NQa(){return CommonUIStrings.l_OICErrorHelpLink}get Pig(){return"OICFailure"}get icon(){return 3}get szf(){return 2===this.iib?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:
CommonUIStrings.l_OICErrorC2RInstallButton}get oOa(){return CommonUIStrings.l_DefaultDialogTitle}NEk(A){this.XUg(A)}uQj(A){this.XUg(A)}XUg(A){let x=10;1===A?(r.a.instance.resolve("Common.IOfficeTrialExperience").ibe(this.iib),x=3):2===A&&((!this.ttd||this.ttd(this.AO))&&this.baa&&h.a.instance.qxi(this.baa,this.aaa,this.AO),x=5);(0===A||1===A)&&this.aaa&&this.aaa(this.AO);e.AFrameworkApplication.MWa(m.a.G0g,this.sqc,x);this.dispose()}dispose(){this.AO=this.baa=this.aaa=null}}Object(J.a)(v,"AOICErrorDialogWithTrial",
null,[109])},899:function(J,V,d){d.d(V,"b",function(){return r});d.d(V,"f",function(){return v});d.d(V,"e",function(){return x});d.d(V,"d",function(){return y});d.d(V,"c",function(){return u});d.d(V,"a",function(){return H});var h=d(25);d(699);var e=d(1074),m=d(515);d(465);const r=()=>h.AFrameworkApplication.isEmbedded,v=()=>{const G=h.AFrameworkApplication.Ba.jb.kN;return!r()&&!h.AFrameworkApplication.hideHeader&&m.a()&&(G||1===h.AFrameworkApplication.bTi)},A=()=>h.AFrameworkApplication.Nnh&&!r()&&
!h.AFrameworkApplication.hideHeader,x=()=>A()&&"officecomhwa"!==(h.AFrameworkApplication.fa.Ia(h.AFrameworkApplication.lJ)||"").toLowerCase()&&!h.AFrameworkApplication.Tig,y=()=>!h.AFrameworkApplication.P3d&&A(),u=()=>!r()&&!h.AFrameworkApplication.hideHeader&&h.AFrameworkApplication.fa.ka("BasicChatIsEnabled"),H=()=>{if(h.AFrameworkApplication.kjg)return null;var G=!!h.AFrameworkApplication.Ba&&h.AFrameworkApplication.Ba.jb.kN;if((h.AFrameworkApplication.f$d&&h.AFrameworkApplication.LWa||h.AFrameworkApplication.snc)&&
G)return Object.assign(new e.a,{command:"1197060601",label:CommonUIStrings.l_ReplyWithChanges,id:d(262).CuiHelper.Wcd});if(h.AFrameworkApplication.workflowEnabled){G="";switch(h.AFrameworkApplication.Rnc){case "Assign":G=CommonUIStrings.l_Assign;break;case "Submit":G=CommonUIStrings.l_Submit}if(""!==G)return Object.assign(new e.a,{command:"2988588587",label:G,id:"btnWorkflow"})}return null}},900:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"RibbonPeripheralSection",
null,[])},901:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.isForAlertableKpi=this.extendedProperties=null}}Object(J.a)(h,"IKpiUsageOptionalProperties",null,[])},902:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.kpiName=null;this.kpiType=0;this.blockFutureEmissionDurationInMs=this.optionalProperties=null}}Object(J.a)(h,"KpiUsageParams",null,[])},903:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.vetoPillar=
this.crewAlias=this.featureName=this.topLevelKpiName=null}}Object(J.a)(h,"FeatureUsageAndHealthConfig",null,[])},904:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=null}}
Object(J.a)(h,"CalloutParameters",null,[])},905:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"ICalloutProps",null,[])},906:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.IsFreeForm="IsFreeForm";h.Value="Value";h.Key="Key";h.FontStyle="FontStyle";Object(J.a)(h,"ComboBoxCommandProperties",null,[])},907:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.Alt="Alt";h.CommandValueId="CommandValueId";h.InnerHTML="InnerHTML";h.On="On";h.IsRtl=
"IsRtl";h.GalleryButtonProps="GalleryButtonProps";h.Text="Text";h.HighlightOn="HighlightOn";Object(J.a)(h,"GalleryButtonCommandProperties",null,[])},908:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"PersonaInfo",null,[])},909:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"PersonaIdentifiers",null,[])},910:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.Sm=e}MWd(e){const m=[];if(e)for(let A in e){var r=
A,v=e[A];const x=this.Sm.tYd(r);if(x)for(let y of x)m.push(appChrome.actions.updateControlHiddenState(y,v));else if(r=this.Sm.a2i(r))for(const y of r)if(y.externalUxCommandIds)for(const u of y.externalUxCommandIds)m.push(appChrome.actions.updateControlHiddenState(u,v));else m.push(appChrome.actions.updateGroupHiddenState(y.externalUxGroupId,v))}return m}lVi(e){const m=[];if(e)for(let r in e){if(!e[r])continue;const v=r;v&&m.push(appChrome.actions.deactivateRibbonTab(v))}return m}}Object(J.a)(h,"ReactRibbonTrimmingHelper",
null,[])},911:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(J.a)(h,"InsightsParameters",null,[])},912:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.vTf="data-ccp-timestamp";h.wTf="data-clipservice-ccpid";h.ATf="data-shapeids";h.zfg="docs-internal-guid-";h.q0g="SCXO";h.t4g="SCXP";h.XCh="SCXW";h.eTg="MsoListParagraphCxSpFirst";h.fTg="MsoListParagraphCxSpLast";Object(J.a)(h,"HtmlContentMetadataConstants",
null,[])},913:function(J,V,d){d.d(V,"a",function(){return u});J=d(0);var h=d(374),e=d(267),m=d(25),r=d(169),v=d(55),A=d(45),x=d(259),y=d(52);class u{static mdg(H){const G={};G.appSettings=u.IQf();G.singleSignOnSettings=u.Ocg();G.appVersion="16";G.appUILocale=e.a.re(m.AFrameworkApplication.lcid).crb;G.dataLocale=e.a.re(m.AFrameworkApplication.lcid).crb;G.osfOmexBaseUrl=m.AFrameworkApplication.fa.Ia(y.a.pa(50));G.firstPartyManifestCDNUrl=m.AFrameworkApplication.fa.Ia(y.a.pa(565));G.sdxCdnUrl=m.AFrameworkApplication.fa.Ia(y.a.pa(649));
G.sdxDmsUrl=m.AFrameworkApplication.fa.Ia(y.a.pa(650));G.sdxAssetsToPrefetchMapping=m.AFrameworkApplication.fa.Ia(y.a.pa(974));G.docUrl=H?H.documentUrl:"";G.pageBaseUrl=r.a.pO;G.lcid=m.AFrameworkApplication.lcid.toString();G.allowExternalMarketplace=m.AFrameworkApplication.fa.ka(y.a.pa(51));G.localizedScriptsUrl=r.a.pO+m.AFrameworkApplication.fa.Ia(y.a.pa(52));H=H?H.fkg:"";G.localizedImagesUrl=r.a.pO+H;G.localizedStylesUrl=r.a.pO+H;G.localizedResourcesUrl=r.a.eXh(H);G.enableAddinCommands=m.AFrameworkApplication.fa.ka(y.a.pa(203));
G.enableMyApps=m.AFrameworkApplication.fa.ka(y.a.pa(186));G.enableMyOrg=m.AFrameworkApplication.fa.ka(y.a.pa(187));G.enableUploadFileDevCatalog=m.AFrameworkApplication.fa.ka(y.a.pa(203))&&!m.AFrameworkApplication.fa.ka(y.a.pa(847));G.enableDevCatalog=m.AFrameworkApplication.fa.ka(y.a.pa(221));G.devCatalogUrl=m.AFrameworkApplication.fa.Ia(y.a.pa(220));G.enablePrivateCatalog=m.AFrameworkApplication.fa.ka(y.a.pa(305));G.showSignOutFromPrivateCatalogMessage=m.AFrameworkApplication.fa.ka(y.a.pa(307));
G.enableBlackForestRedirect=m.AFrameworkApplication.fa.ka(y.a.pa(348));G.enableSingleSignOnForAddin=m.AFrameworkApplication.fa.ka(y.a.pa(342))&&m.AFrameworkApplication.cAj;G.enableTaskpaneUpgradeToAppCommand=m.AFrameworkApplication.fa.ka(y.a.pa(381));G.hideAppsExtensionUrl=m.AFrameworkApplication.hideAppsExtensionUrl;G.enableAnonymousUseLegacyCatalogService=m.AFrameworkApplication.fa.ka(y.a.pa(549));G.enableInsertDialogAccessibilityFix=m.AFrameworkApplication.fa.ka(y.a.pa(584));G.enableFirstPartySDXErrorMessages=
m.AFrameworkApplication.fa.ka(y.a.pa(677));G.disableAppsForOfficeThirdParty=m.AFrameworkApplication.fa.ka(y.a.pa(569));G.wacSessionId=m.AFrameworkApplication.userSessionId;G.disableLogging=!m.AFrameworkApplication.fa.ka("AriaLoggingIsEnabled");G.loggableUserId=m.AFrameworkApplication.fa.Ia("LoggableUserId");G.sessionStartInfoJson=m.AFrameworkApplication.fa.Ia("SessionStartInfoJson");G.wopiHostOriginFromPostMessage=m.AFrameworkApplication.wopiHostOriginFromPostMessage;G.wopiHostOriginFromWacPropBag=
m.AFrameworkApplication.fa.Ia("PostMessageOrigin");G.wacIsEmbedded=m.AFrameworkApplication.fa.ka("IsEmbedded");G.accessibilityAllowFocusAddinTaskpane=m.AFrameworkApplication.fa.ka(y.a.pa(1055));G.disableMicrophonePermission=v.a.lN(1)&&m.AFrameworkApplication.fa.ka("TranscriberSafariEnabled")&&m.AFrameworkApplication.fa.ka("RehearsalSafariEnabled");G.isHostFrameTrustCheckEnabledForAddIns=m.AFrameworkApplication.fa.ka(y.a.pa(1100));G.isHostFrameTrusted=m.AFrameworkApplication.isHostFrameTrusted;G.hostAllowedSdxEmbedding=
m.AFrameworkApplication.fa.ka("HostAllowedSdxEmbedding");G.hostAllowedOfficeStore=m.AFrameworkApplication.fa.ka("HostAllowedOfficeStore");G.hostInstallAddIns=m.AFrameworkApplication.fa.Ia("HostInstallAddIns");G.hostInstallAddInsIsEnabled=m.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled");G.approvedAddIns=m.AFrameworkApplication.fa.Ia("ApprovedAddIns");G.isUpnCheckEnabled=m.AFrameworkApplication.fa.ka(y.a.pa(1132));G.wacUpn=m.AFrameworkApplication.fa.Ia("UserPrincipalName");G.isReactRibbonEnabled=
!0;G.enableSetFocusOnTaskpaneOnUserAction=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);G.enableMyOrg&&G.docUrl&&(H=G.docUrl.split("/"),G.spBaseUrl=2<H.length?H[0]+"//"+H[2]:null,G.spBaseUrl||h.ULS.sendTraceTag(539850053,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",G.docUrl)));G.userNameHashCode=A.a.BM(m.AFrameworkApplication.userName);G.envCode=m.AFrameworkApplication.fa.Gc(y.a.pa(312),0).toString();
return G}static IQf(){const H={};H.AddinRibbonIdAllowUnknown=m.AFrameworkApplication.fa.ka("AddinRibbonIdAllowUnknown");H.AddinRibbonNativeGroupControlIsEnabled=!0;H.AddinRibbonTabAutoFocusIsEnabled=!0;H.AddinRibbonTabPositionIsEnabled=!0;H.AgaveAddinUploadEnabled=m.AFrameworkApplication.fa.ka("AgaveAddinUploadEnabled");H.DevConsoleEnabled=m.AFrameworkApplication.fa.ka("AddinDevConsoleLog");H.ManifestParserDevConsoleEnabled=!0;H.flightingTreatmentVariables=m.AFrameworkApplication.fa.dZb;return H}static Ocg(){try{const H=
{};v.a.yDa&&x.a.l7a&&(H.UiHostSupportsAuthTokenAddinList=u.hJc);H.UiHostSupportsAuthToken=x.a.l7a;return H}catch(H){h.ULS.sendTraceTag(539850054,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",H.message)}return null}}u.hJc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");Object(J.a)(u,"AppForOfficeHelper",null,[])},914:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);
class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.imc=e.TimeLineMappings}}Object(J.a)(h,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[])},915:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideHeight=e.SlideHeight;this.slideWidth=e.SlideWidth;this.Yph=e.SlideLeftBound;this.Vph=e.SlideBottomBound}}Object(J.a)(h,"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[])},916:function(J,
V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.key=e.Key;this.shiftKey=e.ShiftKey}}Object(J.a)(h,"OnSpecialKeyEventArgs",Sys.EventArgs,[])},917:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.CAj=e.IsBeforeReady;this.uEj=e.IsFromEndOfSlideshow;this.summary=e.Summary}}Object(J.a)(h,"OnExitSlideshowEventArgs",Sys.EventArgs,[])},918:function(J,
V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.imc=e.TimeLineMappings}}Object(J.a)(h,"OnPositionChangedEventArgs",Sys.EventArgs,[])},919:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.code=e.Code;this.reason=e.Reason;this.podSessionId=e.PodSessionId}}Object(J.a)(h,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[])},920:function(J,
V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(1154);class e extends Sys.EventArgs{constructor(m){super();this.Pvh=null;this.Pvh="string"===typeof m?Object(h.a)(String,m):m.TranscriberSessionId}}Object(J.a)(e,"OnTranscriberStartedEventArgs",Sys.EventArgs,[])},921:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.isVisible=e.IsVisible}}Object(J.a)(h,"OnVisibilityChangeEventArgs",Sys.EventArgs,[])},922:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(J.a)(h,"OnBrowserEventArgs",Sys.EventArgs,[])},923:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(J.a)(h,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[])},924:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.BTg=
e}}Object(J.a)(h,"CoauthorStatusChangedEventArgs",Sys.EventArgs,[])},925:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m,r){this.YUa={};this.tLg=e;this.zke=m;this.w8b=r}iCa(e,m,r,v){m=h.ZTf;if(this.zke)if(this.w8b){const A=e.UserId?e.UserId.toLowerCase():null;r=r?r.toLowerCase():null;m=A&&A in this.YUa?this.YUa[A]:r&&r in this.YUa?this.YUa[r]:this.tLg.iCa(e,v);!A||A in this.YUa||(this.YUa[A]=m);!r||r in this.YUa||(this.YUa[r]=m)}else m=this.tLg.iCa(e,v);return m}}h.ZTf=
"#C0C0C0";Object(J.a)(h,"PresenceColorProvider",null,[503])},926:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.aJ=e}}Object(J.a)(h,"BeforeSessionEndEventArgs",Sys.EventArgs,[])},927:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(1104),e=d(25),m=d(33),r=d(82);class v{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}sFb(){return m.c([this.Lk(),this])}execute(A,x,y){let u="RoamingAppsHandler.ashx";h.a.instance.kFe&&
0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(u=r.a.aj(u,"wdEnableRoaming","1"));e.AFrameworkApplication.Be.Jj(u,2,this.sFb(),{"Content-Type":"application/json; charset=utf-8"},!1,this.osb(),A,x,y,void 0,void 0,void 0,void 0,"6")}}Object(J.a)(v,"ARoamingAppsRequest",null,[])},928:function(J,V,d){d.d(V,"a",function(){return 2});d.d(V,"c",function(){return h});d.d(V,"b",function(){return e});const h=(m,r,v=2)=>{let A;if(0>r||r>m[m.length-1])throw Error.argumentOutOfRange("y");A=!0;let x=
0,y;const u=m.length-1;for(y=0;y<u;y++){const H=x;x=m[y+1];if(r<x){x-r<v&&y<u-1?y++:r-H>=v&&(A=!1);break}}return{returnValue:y<u?y:-1,y9d:A}},e=(m,r,v=2)=>{let A;if(0>r||r>m[m.length-1])throw Error.argumentOutOfRange("x");A=!0;let x=0,y;const u=m.length-1;for(y=0;y<u;y++){const H=x;x=m[y+1];if(r<x){x-r<v&&y<u-1?y++:r-H>=v&&(A=!1);break}}return{returnValue:y<u?y:-1,y9d:A}}},929:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.JNa=this.OY=0;this.skipUndo=!1;this.Dp=
this.selectionSlide=null;this.version=0;this.eE=this.location=null;this.dataType=0;this.pcc=null;this.objectCount=0;this.WCa=this.YCa=!1;this.Py=this.Fqa=this.nodes=null}toString(){const e=JSON.stringify(this.Fqa);return String.format("CcpId:{0}, version:{1}, DC:{2}, DataType:{3}, ObjectCount:{4}, Cut?:{5}, IsEPH?:{6}, ExtraData:[{7}], CopyStatus: {8}.",this.Dp,this.version,this.eE,this.dataType,this.objectCount,this.YCa,this.WCa,e,this.OY)}}Object(J.a)(h,"ClipServiceObject",null,[])},930:function(J,
V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(374),e=d(96);class m{static Gfd(r,v,A){if(r&&A&&(e.a.$za(r),v&&""!==v))try{const x=m.gJh.parseFromString(v,"text/html");if(x&&x.body){const y=x.body.childNodes;for(v=0;v<y.length;v+=1)r.appendChild(y[v].cloneNode(!0))}}catch(x){h.ULS.sendTraceTag(523106530,324,10,"In class: {0}, unable to parse HTML, {1}",A,x.message)}}}m.gJh=new DOMParser;Object(J.a)(m,"DOMParserHelper",null,[])},931:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=
d(13),e=d(72),m=d(66),r=d(132);class v extends Sys.UI.Control{constructor(A,x,y,u){super(document.createElement("div"));this.v5=this.t5=this.KF=this.a_a=this.lR=this.TJa=this.CLa=null;this.JMb=this.EKa=!1;this.content=this.oB=null;this.t$=0;this.TGf=null;this.DY=0;this.g8c=null;this.Wvf=A;this.Mkb=x;this.NO=y;this.sMd=u;this.mi=x.ownerDocument;this.y1b=this.Zq=this.rNb=!1}get NI(){this.CLa||(this.CLa=this.mi.createElement("div"),this.CLa.id=this.ki("WACCalloutOuter"),this.CLa.className="WACCalloutOuter",
this.CLa.setAttribute(r.a.ff,r.a.uId),this.CLa.style.width=this.t$+"px");return this.CLa}get Bnb(){if(!this.TJa){this.TJa=this.mi.createElement("div");this.TJa.id=this.ki("WACCalloutBeakContainer");this.TJa.className="WACCalloutBeakContainer";var A="CalloutBeakTopFilled_32x16x32";if(5===this.DY||6===this.DY||4===this.DY)A="CalloutBeakBottomFilled_32x16x32";A=e.createClusteredImage(32,16,A,"WACCalloutBeak",!0,"");this.TJa.appendChild(A)}return this.TJa}set Bnb(A){this.TJa=A}get yK(){return this.rNb}get title(){return this.oB}set title(A){this.oB!==
A&&(this.oB=A,this.t5&&(this.t5.innerText=this.oB))}get Zq(){return this.EKa}set Zq(A){this.EKa!==A&&(this.EKa=A,this.lR&&(this.lR.contains(this.KF)&&!this.EKa?this.lR.removeChild(this.KF):!this.lR.contains(this.KF)&&this.EKa&&this.Wzf()))}get y1b(){return this.JMb}set y1b(A){this.JMb!==A&&(this.JMb=A,this.lR&&(this.lR.contains(this.t5)&&!this.JMb?this.lR.removeChild(this.t5):!this.lR.contains(this.t5)&&this.JMb&&this.vBf()))}show(){this.rNb||(this.nvi(),this.F9h(),this.Mkb.appendChild(this.NI),this.NI.style.display=
"Block",this.EIe(),this.rNb=!0,this.g8c&&this.g8c())}dismiss(){this.rNb&&(this.JDi(),this.Mkb.removeChild(this.NI),this.rNb=!1,this.sMd&&this.sMd())}dispose(){this.dismiss();this.t5=this.KF=this.a_a=this.TJa=this.lR=this.CLa=null;Sys.Component.prototype.dispose.call(this)}ki(A){return this.get_element().id+A}nvi(){this.lR=this.mi.createElement("div");this.lR.id=this.ki("WACCalloutHeader");this.lR.className="WACCalloutHeader";this.Zq&&this.Wzf();this.y1b&&this.vBf();this.a_a=this.mi.createElement("div");
this.a_a.id=this.ki("WACCalloutContent");this.a_a.className="WACCalloutContent";this.a_a.style.width=190<this.t$?this.t$-26+"px":"164px";this.a_a.appendChild(this.content);this.NI.appendChild(this.Bnb);this.NI.appendChild(this.lR);this.NI.appendChild(this.a_a)}Wzf(){this.KF=this.mi.createElement("a");this.KF.className="WACCalloutCloseAnchor";this.KF.id=this.ki("WACCalloutCloseAnchor");this.KF.href="#";this.lR.appendChild(this.KF);const A=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",
!0,CommonUIStrings.l_DialogClose);this.KF.appendChild(A)}vBf(){this.t5=this.mi.createElement("div");this.t5.className="WACCalloutTitle UIFontBold";this.t5.style.width=190<this.t$?this.t$-30+"px":"160px";this.t5.id=this.ki("WACCalloutTitle");this.t5.innerText=this.title;this.lR.contains(this.KF)?this.lR.insertBefore(this.t5,this.KF):this.lR.appendChild(this.t5)}EIe(){var A=this.Wvf;let x;if(1===this.DY){var y=this.TGf.y+16;x=-16}else 2===this.DY||3===this.DY||0===this.DY?(y=A.y+A.height+15,x=-15):
(y=A.y-this.NI.clientHeight-15-2,x=this.NI.clientHeight-1);this.NI.style.top=y+"px";this.Bnb.style.top=x+"px";1===this.DY?(A=this.TGf.x-16,this.NI.style.left="50%",this.NI.style.marginLeft=-this.t$/2+"px",y=Sys.UI.DomElement.getBounds(this.NI),this.Bnb.style.left=A-y.x+"px"):(y=A.x+this.Wvf.width/2,2===this.DY||5===this.DY?(A=20,y-=36):0===this.DY||4===this.DY?(A=this.t$/2-16,y-=this.t$/2):(A=this.t$-20-32,y=y-this.t$+36),this.NI.style.left=y+"px",this.Bnb.style.left=A+"px")}F9h(){this.Zq&&!this.v5&&
(this.v5=Object(h.a)(this,this.G1,"closeHandler"),this.NO.pb(m.a.click,this.KF,this.v5,null))}JDi(){this.Zq&&this.v5&&(this.NO.zb(m.a.click,this.KF,this.v5),this.v5=null)}G1(){this.dismiss();return!0}}Object(J.a)(v,"Callout",Sys.UI.Control,[472])},932:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(870);class h extends d.a{constructor(e,m){super(m);this.gKg=e;this.W$a=0}P0f(){const e=(new Date).getTime(),m=e-this.W$a;if(0<this.W$a&&0>=this.gKg-m)return this.W$a=0,this.aLd(),!0;this.W$a=
e;this.aLd();this.setTimeout(this.gKg);return!1}}Object(J.a)(h,"FunctionDelayer",d.a,[])},933:function(J,V,d){d.d(V,"b",function(){return e});d.d(V,"a",function(){return m});d.d(V,"c",function(){return r});var h=d(45);d(388);d(27);d(58);const e=(v,A)=>{const x=[];if(v.length!==A.length)return x;for(let y=0;y<v.length;y++){const u={};u.key=A[y];u.text=v[y];u.type="AppComboBoxItem";x[y]=u}return x},m=(v,A,x,y,u)=>({["unitType"]:v,["unitPlaceholder"]:h.a.Sxe(A),["minValue"]:x,["maxValue"]:y,["step"]:u}),
r=v=>"1.00"===v?1:"1.50"===v?1.5:"2.00"===v?2:0},934:function(J,V,d){d.d(V,"a",function(){return x});J=d(0);var h=d(25),e=d(180),m=d(91),r=d(13);V=d(17);var v=d(26),A=d(68);class x{constructor(y,u,H,G,E,I,Q,D){this.bGa=this.Zg=this.Nw=null;this.qKf=!0;this.ATa=y;this.S7j=u;this.TZj=H;this.zYc=G;this.Wca=E;this.Zb=I;this.Wd=Q;this.Te=D}openDialog(){this.Ivi();h.AFrameworkApplication.Ba.wdb();try{this.Zg.click()}catch(y){const u=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
y.message,y.stack);v.a.J(579204998,818,10,u);throw y;}}submit(){this.bGa=this.TZj();this.bGa.n6c&&this.bGa.n6c(this.Wca,this.Zb,this.Wd,this.Te);const y=new FormData;for(var u of this.bGa.OGd)y.append(u.key,u.value);u=this.Zg.files[0];y.append("fileInputId",u,u.name);const H=new XMLHttpRequest;H.onreadystatechange=()=>{this.C8c(H)};H.open("POST",this.bGa.kye);H.send(y)}C8c(y){if(4===y.readyState){const u=y.status;if(!u||u>=e.a.Xy&&u<e.a.H$h){if(this.bGa.onSuccess)this.bGa.onSuccess(y.responseText,
this.Wca,this.Zb,this.Wd,this.Te,this.Zg)}else this.bGa.Tz&&this.bGa.Tz(y.responseText,this.Wca,this.Zb,this.Wd,this.Te);this.dispose()}}dispose(){this.Nw&&(m.a.removeHandler(this.Zg,"change",Object(r.a)(this,this.JIc,"fileInputChange")),document.body.removeChild(this.Nw),this.Zg=this.Nw=null,x.XSe.remove(this))}Ivi(){this.Nw||(this.Nw=document.createElement("form"),this.Nw.id="uploadFormId",this.Nw.style.visibility=A.a.hidden,this.Nw.method="post",this.Nw.encoding="multipart/form-data",this.Nw.action=
"",this.Zg=document.createElement("input"),this.Zg.style.visibility=A.a.hidden,this.Zg.type="file",this.Zg.id="uploadFileInputId",this.Zg.name="uploadFileInputId",this.Zg.accept=this.ATa,this.Nw.appendChild(this.Zg),document.body.appendChild(this.Nw),m.a.addHandler(this.Zg,"change",Object(r.a)(this,this.JIc,"fileInputChange")))}JIc(){this.Zg.value&&this.Zg.value.length?(this.qKf=!1,this.S7j(this.Zg,this.Wd,this.Te,this.zYc).then(()=>{this.submit()}).catch(()=>{this.dispose()})):this.dispose()}static MLe(y,
u,H,G,E,I,Q,D){for(let Y of x.XSe)Y.qKf&&Y.dispose();y=new x(y,u,H,G,E,I,Q,D);x.XSe.add(y);y.openDialog()}}x.XSe=new V.a;Object(J.a)(x,"UploadFileDialog",null,[])},935:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Tz=this.onSuccess=this.n6c=this.OGd=this.kye=null}}Object(J.a)(h,"UploadFileDialogData",null,[])},936:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.y0f=e}}Object(J.a)(h,"CommentContainersChangedEventArgs",
Sys.EventArgs,[])},968:function(J,V,d){J=d(0);var h=d(284),e=d(25),m=d(45),r=d(13),v=d(22),A=d(1154),x=d(33),y=d(26);class u{}u.speechMode="Subtitles";u.iTf=[u.speechMode];u.sourceLanguage=null;u.targetLanguages=null;u.speechFDBase=null;u.podSessionId=null;u.CCh=null;u.docId=null;u.webServiceBase=null;u.userSessionId=e.AFrameworkApplication.userSessionId;Object(J.a)(u,"PPTSpeechClientConfig",null,[]);var H=d(78);class G{constructor(){this.va=new H.a}onFinalRecognitionText(da){this.va.raiseEvent("OnFinalRecognitionText",
da)}onPartialRecognitionText(da){this.va.raiseEvent("OnPartialRecognitionText",da)}onError(da){this.va.raiseEvent("OnError",da)}onSpeechRecognitionStarted(da){this.va.raiseEvent("OnSpeechRecognitionStarted",da)}onEventUpdate(da){this.va.raiseEvent("OnEventUpdate",da)}z1h(da){this.va.addHandler("OnFinalRecognitionText",da)}yMk(da){this.va.removeHandler("OnFinalRecognitionText",da)}y3h(da){this.va.addHandler("OnPartialRecognitionText",da)}ONk(da){this.va.removeHandler("OnPartialRecognitionText",da)}t1h(da){this.va.addHandler("OnError",
da)}tMk(da){this.va.removeHandler("OnError",da)}u4h(da){this.va.addHandler("OnSpeechRecognitionStarted",da)}rOk(da){this.va.removeHandler("OnSpeechRecognitionStarted",da)}v1h(da){this.va.addHandler("OnEventUpdate",da)}vMk(da){this.va.removeHandler("OnEventUpdate",da)}}Object(J.a)(G,"PPTSpeechClientObserverController",null,[]);var E=d(374),I=d(387);class Q{constructor(){this.accessToken=null}}Object(J.a)(Q,"IAuthenticationProvider",null,[]);class D{constructor(){this.docId=this.podsSessionId=this.webServiceBase=
this.userDataCenterClusterId=null}}Object(J.a)(D,"IDocumentDownloadConfig",null,[]);class Y{constructor(){this.documentDownloadConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(J.a)(Y,"ISpeechConfig",null,[]);class M{constructor(da){this.N3=da}onFinalText(){}onFragmentText(){}onFinalRecognitionText(da,
ia){this.N3.onFinalRecognitionText(da,ia)}onPartialRecognitionText(da,ia){this.N3.onPartialRecognitionText(da,ia)}onError(da){if("ErrorNone"!==da)switch(da){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.N3.onError("AccessDenied");break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.N3.onError("FailedToConnect");break;
case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.N3.onError("Timeout");break;case "ErrorInitialSilenceTimeout":this.N3.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.N3.onError("UnknownError");break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.N3.onError("MicrophoneError");
break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.N3.onError("NotAllowedError");break;case "ErrorAudioNotFoundError":this.N3.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.N3.onError("NotReadableError");break;default:this.N3.onError("CustomError-"+da)}}onSpeechRecognitionStarted(da){E.ULS.sendTraceTag(594355729,830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",da);this.N3.onSpeechRecognitionStarted(da)}onEventUpdate(da){this.N3.onEventUpdate(da)}}
Object(J.a)(M,"PPTSpeechClientObserver",null,[914]);class N{constructor(da){this.W8=null;this.SFa=0;this.microphoneDeviceId="";this.u6j=new M(da)}FLj(){return 2===this.SFa}nwj(){const da=this.rOd(),ia=Object.assign(new Q,{accessToken:""});this.W8&&0!==this.SFa&&(this.W8.stopSpeechRecognition(),this.SFa=0);this.W8=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(da,this.u6j,ia,null,new I.a);return this.W8?!0:(E.ULS.sendTraceTag(594355727,830,10,"Speech client was not successfully created"),
!1)}yrh(){this.W8&&(0===this.SFa?(this.W8.startSpeechRecognition(),this.SFa=2):1===this.SFa&&(this.W8.resumeSpeechRecognition(),this.SFa=2))}Vel(){this.W8&&(this.W8.stopSpeechRecognition(),this.SFa=0)}Wrk(){this.W8&&(this.W8.pauseSpeechRecognition(),this.SFa=1)}setCustomSetting(da,ia){this.W8&&this.W8.setCustomSetting(da,ia)}rOd(){return Object.assign(new Y,{speechMode:u.speechMode,sourceLanguage:u.sourceLanguage,targetLanguages:u.targetLanguages,speechFDBase:u.speechFDBase,captureAudioPauseResumeRecordingState:!0,
clientApp:0,documentDownloadConfig:Object.assign(new D,{docId:u.docId,podsSessionId:u.podSessionId,userDataCenterClusterId:u.CCh,webServiceBase:u.webServiceBase}),userSessionId:u.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(J.a)(N,"PPTSpeechClientProxy",null,[]);var W;(function(da){da[da.none=0]="none";da[da.singleLineRibbon=1]="singleLineRibbon";da[da.multipleLineRibbon=2]="multipleLineRibbon";da[da.slideShowToolbar=3]="slideShowToolbar";da[da.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";
da[da.liveBroadcast=5]="liveBroadcast"})(W||(W={}));Object(J.b)("TranscriptionEntryPoint",W);var K=d(660),ca=d(73),P=d(52);d.d(V,"a",function(){return ea});class ea{constructor(){this.nf=this.Y8=this.aC=this.zbb=this.Wr=this.Ua=this.la=this.Nb=this.Cc=null;this.Xxb=!1;this.gk=null;this.Hbb=this.Lac=0;this.XHg=!1;this.WFa=this.VFa="";this.sYc=!1;this.Gpe="";this.Vee=0;this.vxb=this.a9=this.vAb="";this.wG=null;this.qua={};this.zka=new G;this.I8=new N(this.zka);ea.rwj()}init(da,ia,C,oa,Z,pa,ya){y.a.J(594335502,
830,50,"SlideshowSubtitles.Init");this.nf=ia;this.la=da;this.Cc=C;this.Ua=oa;this.gk=Z;this.Nb=pa;this.wG=ya;this.Wr=document.createElement("div");this.Wr.id="SubtitleContainer";this.Wr.className="SubtitleContainer";this.Wr.style.display=ca.a.og;this.Wr.style.visibility=ca.a.Qs;this.zbb=document.createElement("div");this.zbb.id="SubtitleResultDiv";this.zbb.className="SubtitleResultDiv";this.Cc.$Mi&&(this.zbb.style.direction="rtl");this.aC=document.createElement("span");this.aC.id="SubtitleResultSpan";
this.aC.className="SubtitleResultSpan";this.aC.setAttribute("aria-hidden","true");this.Y8=document.createElement("span");this.Y8.id="SubtitleAccessibilitySpan";this.Y8.className="SubtitleAccessibilitySpan";this.Y8.innerText="";this.Y8.setAttribute("lang",this.Cc.kxa);this.Y8.setAttribute("aria-live","assertive");this.Y8.setAttribute("aria-label",ResourceStrings.L_SubtitleAccessibilityWindow);this.Y8.setAttribute("aria-atomic","true");this.zbb.appendChild(this.aC);this.zbb.appendChild(this.Y8);this.Wr.appendChild(this.zbb);
this.nf.appendChild(this.Wr);h.a.instance.pb(this.aC,()=>!1);e.AFrameworkApplication.fa.Uba?this.Fl():e.AFrameworkApplication.fa.gf(Object(r.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){this.vAb=this.getUserId();this.a9=e.AFrameworkApplication.fa.Ia("TenantId");this.vxb=this.la.hostAuthType||e.AFrameworkApplication.fa.Ia("HostAuthType")||"Unknown"}getUserId(){let da=e.AFrameworkApplication.fa.Ia("PptEditingUserId");m.a.Xa(da)&&(da=e.AFrameworkApplication.fa.Ia("LoggableUserId"),y.a.J(593375619,
822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",m.a.Xa(da)));return da}$Lk(){this.Wr.style.display=ca.a.og;this.Wr.style.visibility=ca.a.Qs}transcribe(da,ia,C,oa,Z,pa){this.I8a()&&(this.gk.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,K.a.R5c),this.Lac=window.setTimeout(Object(r.a)(this,this.X3d,"hideSoundReminderNotification"),3E3));this.Gsl(ia,C,oa,this.Cc);this.I8&&(this.I8.microphoneDeviceId=this.wG.microphoneDeviceId);this.Cc.Ih&&this.I8.nwj()?
(this.qua.StartTime=pa,this.qua.LastError="ErrorNone",this.qua.EntryPoint=W[Z],this.zka.z1h(Object(r.a)(this,this.sXg,"onFinalRecognitionTextHandler")),this.zka.y3h(Object(r.a)(this,this.XYg,"onPartialRecognitionTextHandler")),this.zka.t1h(Object(r.a)(this,this.B_g,"onSpeechProxyErrorHandler")),this.zka.v1h(Object(r.a)(this,this.C_g,"onSpeechProxyEventUpdateHandler")),this.zka.u4h(Object(r.a)(this,this.D_g,"onSpeechRecognitionStartedHandler")),this.I8.yrh(),this.I8.setCustomSetting("clientMetadata",
JSON.stringify(this.P7f())),this.aC.innerText="["+ResourceStrings.L_SubtitleInitMessage+"]",this.aC.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==Z),this.Wzc(),this.Ua.Emb(Object(r.a)(this,this.Xua,"onGetCurrentSlideDimensionsHandler")),this.Ua.rpa(Object(r.a)(this,this.h8c,"onSlideChangedHandler"))):this.WMe()}P7f(da=""){const ia=x.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),C={};C.userID=this.vAb;C.tenantId=this.a9;C.identityProvider=this.vxb;C.audienceChannel=
"";C.audienceGroup=ia.Ring||"Unknown";C.buildVersion=e.AFrameworkApplication.buildVersion||"Unknown";C.locale=this.la.XGa||"Unknown";C.wacHost=ia.Host||"Unknown";C.wacDatacenter=ia.WACDatacenter||"Unknown";C.livePragueSessionInfo=da;return C}WMe(){this.Wr.style.display=ca.a.og;this.Wr.style.visibility=ca.a.Qs;this.I8.Vel();this.zka.yMk(Object(r.a)(this,this.sXg,"onFinalRecognitionTextHandler"));this.zka.ONk(Object(r.a)(this,this.XYg,"onPartialRecognitionTextHandler"));this.zka.tMk(Object(r.a)(this,
this.B_g,"onSpeechProxyErrorHandler"));this.zka.vMk(Object(r.a)(this,this.C_g,"onSpeechProxyEventUpdateHandler"));this.zka.rOk(Object(r.a)(this,this.D_g,"onSpeechRecognitionStartedHandler"));this.Ua.Ehc(Object(r.a)(this,this.Xua,"onGetCurrentSlideDimensionsHandler"));this.Ua.JWa(Object(r.a)(this,this.h8c,"onSlideChangedHandler"));this.I8a()&&this.gk.instance.hide();this.qua.EndTime=Date.now();y.a.J(594114587,817,15,JSON.stringify(this.qua,ea.Yol));this.qua={};this.Cc.Kqb=!1}Wzc(){let da=3;this.qua.LastPosition=
this.Cc.tv;"AboveSlide"===this.Cc.tv&&this.Wr.style.visibility===ca.a.Ty?(this.Wr.style.display=ca.a.Lwa,this.Wr.style.backgroundColor="black",this.Wr.style.bottom="auto"):"BelowSlide"===this.Cc.tv&&this.Wr.style.visibility===ca.a.Ty?(this.Wr.style.display=ca.a.Lwa,this.Wr.style.backgroundColor="black",this.Wr.style.bottom="3%",da=-1):"TopOverlay"===this.Cc.tv?(this.Wr.style.display=ca.a.Lwa,this.Wr.style.backgroundColor="transparent",this.Wr.style.bottom="auto",da=5):"BottomOverlay"===this.Cc.tv&&
(this.Wr.style.display=ca.a.Lwa,this.Wr.style.backgroundColor="transparent",this.Wr.style.bottom="5%",da=-1);this.Xxb&&document.getElementById("LiveURLBarLayerHost")?this.Wr.style.top=-1<da?String.format("calc({0}% + {1})",da.toString(),"26px"):"auto":(this.Wr.style.top=-1<da?da.toString()+"%":"auto",this.gDf())}isVisible(){return this.Wr.style.visibility===ca.a.Ty}uvh(da,ia=""){u.iTf=da?["Live","Subtitles"]:["Subtitles"];this.Xxb=da;this.setVisibility(this.Wr.style.visibility===ca.a.Ty);this.Wzc();
this.I8.setCustomSetting("clientMetadata",JSON.stringify(this.P7f(ia)));this.I8.setCustomSetting("slideIndex",this.Vee);this.I8.setCustomSetting("currentSpeechModes",JSON.stringify(u.iTf))}L4(da){this.Wr.style.cursor=da?"default":"none"}gDf(){this.aC.style.fontSize=Math.floor(this.Wr.clientHeight/2/1.5).toString()+"px";this.Gpe=Math.floor(this.Wr.clientHeight/12-2)+"px";this.aC.style.display="inline"}setVisibility(da){null===da&&(da=this.Wr.style.visibility===ca.a.Qs);this.Wr.style.visibility=da?
ca.a.Ty:ca.a.Qs}Xua(){this.gDf()}h8c(da,ia){this.Vee=ia.slideIndex;this.I8.FLj()&&this.Xxb&&(this.I8.setCustomSetting("currentSlideIndex",this.Vee),y.a.J(593085766,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}setMicrophoneState(da){da?(this.I8.Wrk(),this.bic(),this.sYc=!0,this.Nb&&this.Nb.instance&&this.Nb.instance.Vjh()):(this.I8.yrh(),this.Nb&&this.Nb.instance&&this.Nb.instance.Wjh())}X3d(){this.I8a()&&(window.clearTimeout(this.Lac),this.gk.instance.hide())}Gsl(da,
ia,C,oa){u.sourceLanguage=oa.Uma;u.targetLanguages=oa.ehb;u.podSessionId=da;u.CCh=ia;u.docId=C;u.webServiceBase=this.la.podsWebServiceBase;u.speechFDBase=e.AFrameworkApplication.fa.Ia(P.a.pa(715));da=!!this.Nb&&!!this.Nb.instance&&(this.Nb.instance.$Oa||this.Nb.instance.Cq);u.speechMode=this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&this.Nb.instance.hBa||da?"Live":"Subtitles"}zWf(da,ia){this.XHg||(this.aC.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.Hbb),this.aC.innerText=this.eej(da,
ia),this.aC.scrollTop=this.aC.scrollHeight,this.Hbb=window.setTimeout(Object(r.a)(this,this.bic,"resetSubtitlesToEmpty"),1E4),ia&&(this.Y8.innerText=da,this.Y8.focus()),this.aC.style.padding=m.a.Xa(da)?"0px":this.Gpe)}Iu(da){this.XHg||(this.aC.style.color="rgba( 255, 255, 0, 1 )",m.a.Xa(da)&&(da=ResourceStrings.L_SubtitleGenericErrorMessage),window.clearTimeout(this.Hbb),this.aC.innerText="["+da+"]",this.aC.scrollTop=this.aC.scrollHeight,this.Hbb=window.setTimeout(Object(r.a)(this,this.bic,"resetSubtitlesToEmpty"),
1E4),this.aC.style.padding=this.Gpe,this.Y8.innerText="",this.Y8.focus())}jnj(da){if(null!==da)switch(da){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.Iu(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.qua.LastError="MicrophoneError";break;case "FailedToConnect":this.Iu(ResourceStrings.L_SubtitleRetryErrorMessage);this.qua.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.Iu(ResourceStrings.L_SubtitleGenericErrorMessage);
this.qua.LastError="FailedToCreateSpeechSession";break;default:y.a.J(594145290,830,15,"HandleSpeechProxyError {0}",da)}}sXg(da,ia){this.Wr.style.visibility!==ca.a.Qs&&this.zWf(ia[this.Cc.ehb],!0)}XYg(da,ia){this.Wr.style.visibility!==ca.a.Qs&&this.zWf(ia[this.Cc.ehb],!1)}B_g(da,ia){y.a.J(594335498,830,10,"OnSpeechProxyErrorHandler {0}",ia);(da=ia.toString())&&(-1<da.indexOf("NotAllowedError")||-1<da.indexOf("NotFoundError")||-1<da.indexOf("NotReadableError")||-1<da.indexOf("MicrophoneError"))&&this.I8a()&&
this.gk.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,K.a.AVa);this.jnj(da)}D_g(da,ia){({SlideShowCoreFrame:da}=d(985));const {SlideshowFrame:C}=d(684);y.a.J(594335496,830,50,"OnSpeechRecognitionStartedHandler {0}",ia.toString());Object(v.a)(da,this.Ua)?Object(A.a)(da,this.Ua).y8c(ia.toString()):Object(v.a)(C,this.Ua)&&this.la.u$c&&Object(A.a)(C,this.Ua).y8c(ia.toString());this.bic();this.I8a()&&this.gk.instance.hide()}C_g(da,ia){if(this.I8a())switch(da=ia.eventName,da){case "MediaEvent":"AudioDeviceConnected"===
ia.mediaStatus&&this.gk.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,K.a.R5c);break;case "ConnectionRetry":this.gk.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,K.a.AVa);this.Iu(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const C=ia.shortCode;da=ia.longCode;const oa=ia.shortString,Z=ia.longString;switch(ia.severity){case 0:this.gk.instance.hide();break;case 1:(ia=0<C?ea.iX[C]:oa)&&this.gk.instance.show(ia,K.a.yBb);break;case 2:(ia=
0<C?ea.iX[C]:oa)&&this.gk.instance.show(ia,K.a.AVa),ia=null===da?Z:ea.iX[da],m.a.Xa(ia)||(window.clearTimeout(this.Hbb),this.Iu(ia),this.Hbb=window.setTimeout(Object(r.a)(this,this.bic,"resetSubtitlesToEmpty"),3E4))}break;default:y.a.J(594335494,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",da)}}I8a(){return this.la.pptEditorVoiceUXEnabled&&!!this.gk&&!!this.gk.instance}bic(){this.aC.style.color="rgba( 255, 255, 255, 1 )";this.aC.innerText="";this.aC.scrollTop=this.aC.scrollHeight;this.WFa=this.VFa=
"";this.sYc=!1;this.Hbb=0;this.aC.style.padding="0px"}eej(da,ia){this.sYc?this.t7h(da):this.vPk(da);this.sYc=ia;return m.a.Xa(this.VFa)||m.a.Xa(this.WFa)?m.a.Xa(this.VFa)?this.WFa:this.VFa:this.VFa+"\n"+this.WFa}t7h(da){this.VFa=m.a.Xa(this.WFa)?this.VFa:this.WFa;this.WFa=da}vPk(da){m.a.Xa(this.VFa)||m.a.Xa(this.WFa)?this.VFa=da:this.WFa=da}static get instance(){return ea.np}static rwj(){ea.iX[1]=ResourceStrings.L_SubtitleDetection_Listening;ea.iX[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;
ea.iX[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;ea.iX[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;ea.iX[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static Yol(da,ia){return"undefined"===typeof ia?null:ia}}ea.iX=Array(20);ea.np=new ea;Object(J.a)(ea,"SlideshowSubtitles",null,[864])},970:function(J,V,d){J=d(0);var h=d(25),e=d(55),m=d(57),r=d(267),v=d(306);class A{constructor(Va,ua=null){this.wPh=Va;this.yR=ua||v.a.RYd(e.a.e3a,"")}get mu(){return this.wPh}get Gb(){return this.yR}WHe(Va){this.Gb.d++;
return this.mu.WHe(Va)}hGb(Va){this.Gb.e++;return this.mu.hGb(Va)}cJ(Va){this.Gb.f++;return this.mu.cJ(Va)}zXa(Va){this.Gb.h++;return this.mu.zXa(Va)}e0(Va){this.Gb.i++;return this.mu.e0(Va)}uX(Va){this.Gb.j++;return this.mu.uX(Va)}G4(Va){this.Gb.k++;return this.mu.G4(Va)}wX(Va){this.Gb.l++;return this.mu.wX(Va)}Bfd(Va){this.Gb.m++;return this.mu.Bfd(Va)}ZHa(Va,ua=!1){this.Gb.n++;return this.mu.ZHa(Va,ua)}o2d(){this.Gb.o++;return this.mu.o2d()}RLe(){this.Gb.p++;return this.mu.RLe()}zFb(Va){this.Gb.m++;
return this.mu.zFb(Va)}Ms(Va){this.Gb.q++;return this.mu.Ms(Va)}Hma(Va){this.Gb.r++;return this.mu.Hma(Va)}QFb(Va){this.Gb.g++;return this.mu.QFb(Va)}hgd(Va){return this.mu.hgd(Va)}EXa(Va){this.Gb.s++;return this.mu.EXa(Va)}Pfd(Va){this.Gb.s++;return this.mu.Pfd(Va)}nea(Va){this.Gb.s++;return this.mu.nea(Va)}DXa(Va){this.Gb.s++;return this.mu.DXa(Va)}zfb(Va){this.Gb.t++;return this.mu.zfb(Va)}igd(Va){this.Gb.u++;return this.mu.igd(Va)}ojc(Va){this.Gb.v++;return this.mu.ojc(Va)}Jma(Va){return this.mu.Jma(Va)}nfd(Va){this.Gb.z++;
return this.mu.nfd(Va)}CEe(){return this.mu.CEe()}fIa(Va,ua){this.Gb.w++;this.Gb.x++;return this.mu.fIa(Va,ua)}c0(Va){this.Gb.y++;return this.mu.c0(Va)}clearFormatting(){return this.mu.clearFormatting()}clone(){return new A(this.mu.clone(),this.Gb)}}Object(J.a)(A,"FormattingStewardUsageCollector",null,[701]);class x extends A{constructor(Va,ua=null){super(Va,ua)}get d4(){return this.mu}get pD(){return this.d4.pD}set pD(Va){this.d4.pD=Va}get textIndent(){return this.d4.textIndent}get marginLeft(){return this.d4.marginLeft}get W8c(){return this.d4.W8c}get lineSpacing(){return this.d4.lineSpacing}get wea(){return this.d4.wea}get ZUc(){return this.d4.ZUc}get Lda(){return this.d4.Lda}get paragraph(){return this.d4.paragraph}set paragraph(Va){this.d4.paragraph=
Va}get A5a(){return this.d4.A5a}zkd(Va){return this.d4.zkd(Va)}BQe(Va){return this.d4.BQe(Va)}clone(){const Va=this.mu.clone();return new x(Va,this.Gb)}}Object(J.a)(x,"FormattingStewardUsageCollector",A,[700,701]);var y=d(31),u=d(74),H=d(189),G=d(659),E=d(51),I=d(144),Q=d(71),D=d(56),Y=d(336),M=d(1054),N=d(327),W=d(45),K=d(1162),ca=d(1157),P=d(1156),ea=d(109),da=d(36),ia=d(80),C=d(39),oa=d(34),Z=d(87),pa=d(301);class ya{}ya.yellow="FFFF00";ya.lime="00FF00";ya.aqua="00FFFF";ya.fuchsia="FF00FF";ya.blue=
"0000FF";ya.red="FF0000";ya.navy="000080";ya.teal="008080";ya.green="008000";ya.purple="800080";ya.maroon="800000";ya.olive="808000";ya.gray="808080";ya.ccl="C0C0C0";ya.black="000000";Object(J.a)(ya,"FontHighlightColorEnum",null,[]);var Ja=d(329),Ka=d(49),ma=d(862),ra=d(358),Da=d(121);class va{constructor(Va,ua,Ca,Ea,wb,Oa,ab,fb,db=null,gc=!1){this.xv=this.Quc=null;this.kPb=0;this.iXe=this.jPb=null;this.g1=0;this.FLa=this.kxc=this.ttc=this.Twc=this.s0a=this.Xfa=this.Gtc=this.wxc=null;this.YTf=.25*
ea.Font.IH;this.paragraph=Va;this.If=ua;this.PJ=Ca;this.HO=Ea;this.ufa=wb;this.vU=Oa;this.dY=ab;this.C_a=fb;db?(Da.a(4223818,307,!!db.xv),this.xv=db.xv.eDc(this.paragraph),this.kPb=db.kPb,this.jPb=db.jPb,db.Xfa&&(this.Xfa=new ma.a,this.Xfa.afterSpacing.value=db.Xfa.afterSpacing.value,this.Xfa.beforeSpacing.value=db.Xfa.beforeSpacing.value),db.s0a&&(this.s0a=db.s0a.clone()),this.g1=db.g1,this.kxc=db.kxc.clone(),this.wxc=db.wxc,this.Gtc=db.Gtc,this.Twc=db.Twc,this.ttc=db.ttc,db.Lda&&(this.FLa=db.Lda)):
(this.xv=new pa.a(this.paragraph,0),this.xv.formatting=new Ja.a(this.xv,Y.a.nil),ua=Ka.a.PNa(Va),ua=this.HO.xs(ua),this.XZk(ua),va.N8k(Va)?(this.ufa.QHe(this.xv.formatting,ua,gc),this.g1=Va.Sa(da.a.pl)?Va.getValue(da.a.pl):0):this.g1=-1,this.kPb=0,this.jPb=null,this.Xfa=this.o_i(),this.C_a&&(this.Xfa=this.ufa.qV(Va),this.s0a=this.ufa.vZd(Va),this.Twc=this.ufa.hQa(Va),this.ttc=this.ufa.d7(Va)),this.kxc=new M.DictionaryPropertySet,this.ufa.CHe(this.xv.formatting,Va,gc))}get paragraph(){return this.Quc}set paragraph(Va){Da.a(4223816,
307,!!Va&&y.ParagraphReader.Pd(Va));this.Quc=Va}get A5a(){return this.xv.formatting}get Ydc(){return this.kPb}get S1g(){return this.jPb}get C1(){return this.iXe}get pD(){return this.g1}set pD(Va){Da.a(4223817,307,1===Va||2===Va||3===Va||oa.a.instance.ga(54)&&6===Va);this.g1=Va}get textIndent(){return this.wxc}get marginLeft(){return this.Gtc}get W8c(){return this.Xfa}get lineSpacing(){return this.s0a}get wea(){return this.Twc}get ZUc(){return this.ttc}get Lda(){return this.FLa}XZk(Va){const ua=this.HO.language(Va);
ua&&this.If.mjc(this.xv.formatting,ua,0,Va.cache.DRa,!1)}o_i(){if(oa.a.instance.ga(54))return null;const Va=new ma.a;Va.afterSpacing.value=this.YTf;Va.beforeSpacing.value=this.YTf;return Va}WHe(Va){(Va=r.a.re(Va))&&this.If.AXa(this.xv.formatting,Va.LCID);return!0}hGb(){return!1}cJ(Va){this.If.cJ(this.xv.formatting,Va);return!0}zXa(Va){this.If.setItalic(this.xv.formatting,Va);return!0}e0(Va){this.If.e0(this.xv.formatting,Va);return!0}uX(Va){this.If.uX(this.xv.formatting,Va);return!0}G4(Va){this.If.G4(this.xv.formatting,
Va);return!0}wX(Va){this.If.wX(this.xv.formatting,Va);return!0}Bfd(Va){if(0>=Va)return!1;this.If.rr(this.xv.formatting,Va);return!0}ZHa(Va,ua){if(!Va||""===Va)return!1;if(({fontInfo:Ca}=N.FontUtils.rol(Va)).returnValue)return this.If.rX(this.xv.formatting,Ca.fontName),!0;var Ca=!1;const Ea=N.FontUtils.oF(Va);ua&&this.F4b(Ea,this.vU)&&(this.vU.createFontUrl(Va),Ca=!0);this.F4b(Ea,this.dY)&&(Ca=!0);Ca&&this.If.rX(this.xv.formatting,Ea);return Ca}F4b(Va,ua){return!!ua&&ua.isEnabled&&ua.F4b(Va)}o2d(){this.If.gOc(this.xv.formatting);
return!0}RLe(){this.If.xhd(this.xv.formatting);return!0}zFb(Va){if(0>=Va)return!1;this.If.zFb(this.xv.formatting,Va);return!0}Ms(Va){var {Box4PasteSteward:ua}=d(246);if(!this.If.Kvg(Va)){if(null===Va||""===Va)return!1;Va=ua.U3a(Va)}ua=null;this.Lda&&this.Lda.hasOwnProperty(C.a.listLevel.id.toString())&&(ua=this.Lda[C.a.listLevel.id.toString()]);this.If.Ms(this.xv.formatting,Va,ua);return!0}Hma(Va){const {Box4PasteSteward:ua}=d(246);if(!Va||""===Va||oa.a.instance.ga(49)&&!va.igj().contains(Va)||this.ufa.Qnh(this.xv.formatting))return!1;
this.If.Hma(this.xv.formatting,ua.U3a(Va));return!0}QFb(Va){this.If.QFb(this.xv.formatting,Va);return!0}hgd(Va){let ua=0;switch(W.a.vg(Va)){case "small-caps":ua=1;break;case "uppercase":ua=2}this.If.gm(this.xv.formatting,ia.a.capitalization,ua);return!0}nfd(Va){const {Box4PasteSteward:ua}=d(246);if(!Va||""===Va)return!1;this.kxc.setValue(da.a.oCc,parseInt(ua.U3a(Va),16));return!0}DXa(Va){return 0>=Va?!1:this.Pfd(Z.StyleReader.bcj(Va))}EXa(Va){this.clearFormatting();this.kPb=Va;return!0}Pfd(Va){const {Box4PasteSteward:ua}=
d(246);return Va&&0<Va.length&&ua.vHb&&ua.vHb.mG(Va)?(this.jPb=Va,!0):!1}nea(Va){const {Box4PasteSteward:ua}=d(246);return Va&&0<Va.length&&ua.vHb&&ua.vHb.mG(Va)?(this.iXe=Va,!0):!1}BQe(Va){if(this.C1){Va=d(246).Box4PasteSteward.vHb||Z.StyleReader.rK(Va);if(!Va)return Da.a(41968715,307,!1),!1;(Va=Va.mG(this.C1))&&this.If.nea(this.xv.formatting,Va);return!0}return!1}fIa(Va,ua){if(oa.a.instance.ga(54))return!1;Da.a(5297416,307,0<=Va&&0<=ua);0<=Va&&(this.Xfa.beforeSpacing.value=Va);0<=ua&&(this.Xfa.afterSpacing.value=
ua);return 0<=Va||0<=ua}c0(Va){if(!oa.a.instance.ga(54)||!Va)return!1;const ua=parseFloat(W.a.substring(Va,0,W.a.vg(Va).indexOf("px")));if(!isNaN(ua))return this.s0a=new ra.a(3,K.a.Qda(ua,1)),!0;Va=parseFloat(W.a.substring(Va,0,W.a.vg(Va).indexOf("%")));return isNaN(Va)?!1:(this.s0a=new ra.a(2,Va/100),!0)}zfb(Va){let ua=0;if(!Va||""===Va)return!1;switch(Va){case "left":ua=1;break;case "center":ua=2;break;case "right":ua=3;break;case "justify":oa.a.instance.ga(54)&&(ua=6)}if(0===ua)return!1;this.pD=
ua;return!0}igd(Va){this.wxc=Va;return!0}ojc(Va){this.Gtc=Va;return!0}Jma(Va){this.FLa=JSON.parse(Va);return this.Lda?!0:!1}clearFormatting(){this.xv.formatting=new Ja.a(this.xv,Y.a.nil);return!0}CEe(){this.g1=0;return!0}zkd(Va){var {Box4PasteSteward:ua}=d(246);if(!oa.a.instance.ga(71))return!1;if(0<this.Ydc&&ua.OGa[this.Ydc]){Da.a(4223819,307,1<=this.Ydc);Da.a(4223820,307,7>=this.Ydc);ua=Z.StyleReader.rK(Va);if(!ua)return Da.a(4223821,307,!1),!1;ua=ua.mG(d(246).Box4PasteSteward.OGa[this.Ydc]);this.PJ.V9(ua,
Va,!1);return!0}if(this.S1g){ua=d(246).Box4PasteSteward.vHb||Z.StyleReader.rK(Va);if(!ua)return Da.a(41968716,307,!1),!1;this.PJ.V9(ua.mG(this.S1g),Va,!1);return!0}return!1}clone(){return new va(this.paragraph,this.If,this.PJ,this.HO,this.ufa,this.vU,this.dY,this.C_a,this)}static igj(){va.ZO||(va.ZO=new ca.a(P.a.rt()),va.ZO.add(ya.yellow),va.ZO.add(ya.lime),va.ZO.add(ya.aqua),va.ZO.add(ya.fuchsia),va.ZO.add(ya.blue),va.ZO.add(ya.red),va.ZO.add(ya.navy),va.ZO.add(ya.teal),va.ZO.add(ya.green),va.ZO.add(ya.purple),
va.ZO.add(ya.maroon),va.ZO.add(ya.olive),va.ZO.add(ya.gray),va.ZO.add(ya.ccl),va.ZO.add(ya.black));return va.ZO}static N8k(Va){if(!oa.a.instance.ga(71))return!0;Va=Z.StyleReader.BP(Z.StyleReader.iD(Va));return Va===Z.StyleReader.ZCh||Va===Z.StyleReader.AJa||Va===Z.StyleReader.bDh||Va===Z.StyleReader.Yma}}va.ZO=null;Object(J.a)(va,"FormattingSteward",null,[700,701]);class Fa{QQe(){return!1}I2d(Va){return Va}Jma(){}OFb(){}VRc(){return!1}get OSc(){return!1}c0(){}fIa(){}Ykh(){}Pjh(){}get Tnh(){return!1}}
Object(J.a)(Fa,"NoOpPasteStewardBridge",null,[325]);var ka=d(17);class qa{constructor(Va,ua){this.Zck=Va;this.$ck=ua||"Normal"}}Object(J.a)(qa,"NoteTagInfoBox4",null,[]);const Ua=Va=>{const ua=new ka.a;for(let Ca of Va)Va=new qa(Ca.Zck,Ca.$ck),ua.add(Va);return ua};d.d(V,"a",function(){return Ya});class Ya{constructor(Va,ua,Ca=null,Ea=null){this.dY=this.vU=null;this.URi=h.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.hgf=0;this.vb=Va;this.RF=ua;this.UX=Ea||new Fa;this.yR=
Ca||v.a.RYd(e.a.e3a,"")}get Gb(){return this.yR}get characterPropertiesEditor(){return Ya.Vg||(Ya.Vg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get fontService(){return this.vU||(this.vU=m.a.instance.qb("Box4.IFontService"))}get CAa(){return this.dY||(this.dY=m.a.instance.qb("Box4.CustomFontService"))}reset(){}get PWb(){return this.gYd(!1)}gYd(Va){Da.a(4223770,307,D.OutlineElementReader.Tg(this.vb));const ua=E.OutlineElementNavigator.ti(this.vb);E.OutlineElementNavigator.Ke(this.vb);
Da.a(4223771,307,!!ua&&y.ParagraphReader.Pd(ua));Va=new va(ua,Ya.fh,Ya.qO,Ya.KSi,Ya.LSi,this.fontService,this.CAa,this.URi,void 0,Va);return new x(Va,this.Gb)}D_(){}Dla(){}SVa(){}Cla(){}Bla(){}Vua(){}Uua(){}Vz(){}Uz(){}NVa(){}MVa(){}$ua(){}HGa(){}Gla(){}Ela(){}Zua(){}Fla(){}OVa(){}$Ab(Va){D.OutlineElementReader.Tg(this.vb)?(Ya.Lh.y2b(this.vb,!0),E.OutlineElementNavigator.KI(this.vb,!1,!1)):Q.OutlineReader.xt(this.vb)?I.OutlineNavigator.q9(this.vb)?Va?(this.vb.Hi(),Ya.$A.zY(this.vb,!1)):Ya.Lh.uhc(this.vb):
Ya.$A.zY(this.vb,!1):Da.a(8128524,307,!1,"Unexpected node type {0} encountered",this.vb.ri)}QPa(Va){let ua=null;if(Va&&Va.qT&&Va.cultureName)try{ua=Object.assign(new G.a,{languageId:r.a.re(Va.cultureName).LCID})}catch(Ca){Da.a(8128526,307,!1,"Setting up culture {0} encountered {1}",Va.cultureName,Ca)}ua||null==this.RF||(ua=Object.assign(new G.a,{languageId:this.RF}));return ua}get xL(){return this.hgf}set xL(Va){this.hgf=Va}BAc(){}mkd(){}$Ld(){}get S3a(){return!1}get g4a(){return!1}RQj(Va){let ua=
1;if(Va.Atg){var Ca=0;switch(Va.listStyleType){case 1:ua=0;break;case 7:ua=1;break;case 8:ua=2;break;case 9:ua=3;break;case 10:ua=4;break;case 11:ua=5}}else switch(Ca=1,Va.listStyleType){case 1:ua=0;break;case 3:ua=1;break;case 4:ua=2;break;case 5:ua=3}let Ea;Ca=(Ea=u.ListReader.Y4a)?H.a.bV(Ca,ua,Ua(Va.j4),Va.listId,Va.listLevel,Va.levelText,Va.font):H.a.bV(Ca,ua,Ua(Va.j4));Va.Atg&&!Va.rAj&&(Ca.Zz=Ea&&0<Va.listId&&0<=Va.listLevel&&!Va.ICb?Va.hel:Va.VAi);this.UX.OFb(this.vb,Ca,Va);return Ca}$W(){}XW(){}ZW(){}YW(){}WW(){}VW(){}static get Lh(){return Ya.xi||
(Ya.xi=m.a.instance.resolve("Box4.IOutlineElementEditor"))}static get $A(){return Ya.ix||(Ya.ix=m.a.instance.resolve("Box4.IOutlineEditor"))}static get fh(){return Ya.If||(Ya.If=m.a.instance.resolve("Box4.IFormattingEditor"))}static get qO(){return Ya.PJ||(Ya.PJ=m.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get KSi(){return Ya.HO||(Ya.HO=m.a.instance.resolve("Box4.IFormattingReader"))}static get LSi(){return Ya.ufa||(Ya.ufa=m.a.instance.resolve("Box4.Actors.IFormattingStewardBridge"))}}
Ya.xi=null;Ya.ix=null;Ya.Vg=null;Ya.If=null;Ya.PJ=null;Ya.HO=null;Ya.ufa=null;Object(J.a)(Ya,"Box4PasteStewardBase",null,[678,679,406])},972:function(J,V,d){d.r(V);J=d(0);var h=d(701),e=d(988),m=d(976),r=d(197),v=d(13),A=d(36),x=d(71),y=d(30),u=d(37),H=d(26),G=d(40);class E{constructor(P,ea){this.ge=P;this.Tf=ea}}Object(J.a)(E,"RowSpan",null,[]);class I{constructor(P){this.Jy=P;this.RFa=[]}UFd(P,ea){Array.add(this.RFa,new E(P,ea))}tTk(P){for(let ea=0;ea<this.RFa.length;ea++){const da=this.RFa[ea];
P<=da.ge&&da.ge++;P<=da.Tf&&da.Tf++}}get x(){return this.Jy}get tfh(){return this.RFa}static Hae(P,ea){return P.Jy===ea}static ZMd(P,ea){P=P.Jy-ea.Jy;return 0<P?1:0>P?-1:0}}Object(J.a)(I,"ColSplit",null,[]);const Q=(P,ea,da)=>{let ia;ia=-1;for(let C=0;C<P.length;++C)if(da(P.ga(C),ea))return ia=C,{returnValue:!0,ltb:ia};return{returnValue:!1,ltb:ia}};class D{constructor(P,ea){this.ae=P;this.Lf=ea}}Object(J.a)(D,"ColSpan",null,[]);class Y{constructor(P){this.Ky=P;this.RFa=[]}UFd(P,ea){Array.add(this.RFa,
new D(P,ea))}Xmi(P){for(let ea=0;ea<this.RFa.length;ea++){const da=this.RFa[ea];P<=da.ae&&da.ae++;P<=da.Lf&&da.Lf++}}get PNf(){return this.RFa}get y(){return this.Ky}static Hae(P,ea){return P.Ky===ea}static ZMd(P,ea){P=P.Ky-ea.Ky;return 0<P?1:0>P?-1:0}}Object(J.a)(Y,"RowSplit",null,[]);var M=d(928),N=d(27);class W{constructor(P,ea,da,ia,C,oa,Z,pa,ya,Ja,Ka,ma,ra,Da,va){this.sRa=!1;this.Ti=this.lCc=this.yOg=this.c3c=null;this.Xxh=P;this.Vc=ea;this.Wqh=da;this.eYa=ia;this.Cmd=C;this.tableNode=oa;this.Ed=
Z;this.FX=pa;this.QPa=ya;this.uTk=Ja;this.Ymi=Ka;this.Vdd=ma;this.pDc=ra;this.rows=Da;this.cols=va;this.fYa=0;this.D4b=!1}a3a(P){this.c3c=new Date;this.yOg=P}L4a(){this.c3c>N.App.Bm&&this.Vc&&this.Vc.Ya(this.yOg,(+new Date-+this.c3c).toString());this.c3c=N.App.Bm}finish(){const {TableMergeSplitEditor:P}=d(972);this.Vc&&(this.Ti&&(this.D4b=!1,this.Vc.Ya(P.rLi,this.Ti.message)),this.Vc.Ya("SplitCellsSucceeded",this.D4b.toString()),this.Vc.finish(),this.Vc=null);if(this.Ti)throw this.Ti;this.Wqh&&this.Wqh(this.D4b,
this.eYa)}}Object(J.a)(W,"SplitCellsArguments",null,[]);var K=d(319);d.d(V,"TableMergeSplitEditor",function(){return ca});class ca{constructor(P,ea,da,ia,C,oa,Z,pa,ya,Ja,Ka,ma,ra,Da,va){this.Ib=P;this.VN=ea;this.Rz=da;this.Q3=ia;this.l3c=C;this.WK=oa;this.i1c=Z;this.zac=pa;this.oq=ya;this.uca=Ja;this.M9b=Ka;this.Fk=ma;this.Jb=ra;this.sa=Da;this.t2c=va}merge(P,ea,da){const ia=P.hf(ea.ge,ea.ae),C=this.Ib.Jc(ia);let oa=C.xA(1);const Z=[u.a.rowId,u.a.cellId];oa&&C.yc();let pa=!0;for(let Ja=ea.ge;Ja<ea.Tf;++Ja){let Ka=
P.hf(Ja,ea.ae);for(let ma=ea.ae+(Ja===ea.ge?1:0);ma<ea.Lf;++ma)if(ma!==ea.ae&&(Ka=P.hf(Ja,ma)),!Ka||!Ka.isGhostCell){Ka.Kn(u.a.rowSpan,u.a.colSpan);Ka.isGhostCell=!0;var ya=y.GraphIterator.nb(Ka);x.OutlineReader.isEmpty(ya)?this.Gah(ya):(pa&&x.OutlineReader.isEmpty(C)&&(pa=!1,oa=null,this.Gah(C)),this.WK.mSi(Ka,ra=>{this.WK.px(C.currentNode,ra,Z);return!0},ra=>11===ra.type||22===ra.type||12===ra.type),ya=this.Ib.WYd(ya),ya.yb(1),this.WK.cbk(C,oa,ya.role,ya.role,ya),ya.Jsb(1),oa=ya.currentNode)}}this.Q3.Kql(da,
ia,ea);ia.rowSpan=ea.dO;ia.colSpan=ea.xQ;P.setValue(u.a.complexTable,!0);this.i1c.kDe(P);P.Pba(511);this.Rz.E2b(P);return ia}ldl(P,ea,da,ia,C,oa,Z,pa,ya){if(1>=da&&1>=ia)ya&&ya(!0,ea);else{var Ja=new Date,Ka=G.a.Nm("SplitCells",1);Ka.Nj=!0;var ma=new h.a,ra=new e.a,Da=new e.a,va=this.uca.eBa(P,C,ea);ea=this.oq.hIc(C,ea);var Fa=oa.ccg();for(oa=oa.W6f();va.moveNext();){ma.add(va.SZb().id.toString());const Ya=va.Cz;for(var ka=1;ka<da;ka++){var qa=Fa[Ya.ge];qa+=(Fa[Ya.Tf]-qa)*ka/da;var Ua=void 0;({ltb:Ua}=
Q(ra,qa,Y.Hae)).returnValue||(Ua=ra.length,ra.add(new Y(qa)));ra.ga(Ua).UFd(Ya.ae,Ya.Lf)}for(ka=1;ka<ia;ka++)qa=oa[Ya.ae],qa+=(oa[Ya.Lf]-qa)*ka/ia,({ltb:Ua}=Q(Da,qa,I.Hae)).returnValue||(Ua=Da.length,Da.add(new I(qa))),Da.ga(Ua).UFd(Ya.ge,Ya.Tf)}ra=ra.toArray();Da=Da.toArray();ra.sort((Ya,Va)=>Y.ZMd(Va,Ya));Da.sort((Ya,Va)=>I.ZMd(Va,Ya));Ka.Ya("Prep",(+new Date-+Ja).toString());Ja=this.Jb.ie(15);Ja.lc(P);P=new W(Ja,Ka,ya,ea,ma,P,Z,C,pa,Fa,oa,ra,Da,da,ia);P=new m.a(null,Object(v.a)(this,this.udl,"splitRowSeams"),
P);P.Ui=!1;P.vl("SplitTableCells");P.run()}}udl(P,ea){try{for(ea.a3a("SplitRowSeams");ea.fYa<ea.Vdd.length;){const da=({sRa:ea.sRa}=this.Zti(ea.tableNode,ea.Ed,ea.FX,ea.QPa,ea.uTk,ea.Vdd[ea.fYa])).returnValue;ea.fYa++;if(ea.sRa){let ia;(ia=ea.eYa).Tf=ia.Tf+1;for(let C=0;C<ea.pDc.length;C++)ea.pDc[C].tTk(da)}if(P.cna)return!0}ea.L4a();ea.fYa=0;P.Wg(Object(v.a)(this,this.qdl,"splitColSeams"))}catch(da){ea.Ti=da,P.Wg(Object(v.a)(this,this.Kgb,"tearDownSplit"))}return!0}qdl(P,ea){try{for(ea.a3a("SplitColSeams");ea.fYa<
ea.pDc.length;){const da=({sRa:ea.sRa}=this.Yti(ea.tableNode,ea.Ed,ea.FX,ea.QPa,ea.Ymi,ea.pDc[ea.fYa])).returnValue;ea.fYa++;if(ea.sRa){let ia;(ia=ea.eYa).Lf=ia.Lf+1;for(let C=0;C<ea.Vdd.length;++C)ea.Vdd[C].Xmi(da)}if(P.cna)return!0}ea.L4a();ea.fYa=0;P.Wg(Object(v.a)(this,this.ZIb,"updateIsComplexTableProperty"))}catch(da){ea.Ti=da,P.Wg(Object(v.a)(this,this.Kgb,"tearDownSplit"))}return!0}ZIb(P,ea){try{ea.a3a("UpdateComplex"),this.i1c.URe(this.Ib.Jc(ea.tableNode)),ea.L4a(),ea.lCc=this.uca.eBa(ea.tableNode,
ea.FX,ea.eYa),P.Wg(Object(v.a)(this,this.XQi,"fixSplitCells"))}catch(da){ea.Ti=da,P.Wg(Object(v.a)(this,this.Kgb,"tearDownSplit"))}return!0}XQi(P,ea){try{for(ea.a3a("FixInsideBorders");ea.lCc.moveNext();)if(ea.Cmd.contains(ea.lCc.SZb().id.toString())&&this.WQi(ea.tableNode,ea.FX,ea.lCc,ea.rows,ea.cols),P.cna)return!0;ea.L4a();P.Wg(Object(v.a)(this,this.oKi,"ensureMinRowHeightColumnWidth"))}catch(da){ea.Ti=da,P.Wg(Object(v.a)(this,this.Kgb,"tearDownSplit"))}return!0}oKi(P,ea){try{ea.a3a("EnsureMinHeightWidth"),
1<ea.rows&&this.pKi(ea.tableNode,ea.eYa),1<ea.cols&&this.nKi(ea.tableNode,ea.eYa),ea.L4a(),P.Wg(Object(v.a)(this,this.setSelection,"setSelection"))}catch(da){ea.Ti=da,P.Wg(Object(v.a)(this,this.Kgb,"tearDownSplit"))}return!0}setSelection(P,ea){try{ea.a3a("SetSelection");ea.D4b=!ea.eYa.YOa();if(ea.D4b){const da=this.t2c.Fzi(ea.tableNode,ea.FX,ea.eYa);da&&this.sa.UD(da)}ea.L4a();ea.a3a("Render");P.Ui||ea.Xxh.ckh(P);ea.Xxh.dispose();P.Wg(Object(v.a)(this,this.Kgb,"tearDownSplit"))}catch(da){ea.Ti=da,
P.Wg(Object(v.a)(this,this.Kgb,"tearDownSplit"))}return!0}Kgb(P,ea){ea.L4a();ea.finish();return!1}Zti(P,ea,da,ia,C,oa){var Z;let pa=({y9d:Z}=M.c(C,oa.y)).returnValue;if(Z=!Z){pa++;var ya=C[pa-1],Ja=C[pa],Ka=this.Ib.Jc(P);this.Vbc(Ka,pa-1);var ma=Ka.currentNode;Ka=this.i1c.V5d(Ka);ya=oa.y-ya;ma.setValue(u.a.Nt,ea.yf(ya,1));ya=Ja-oa.y;Ka.setValue(u.a.Nt,ea.yf(ya,1));Array.insert(C,pa,oa.y);da.cRa(3)}for(ea=0;ea<oa.PNf.length;++ea){C=oa.PNf[ea];Ja=[];for(ma=C.ae;ma<=C.Lf;++ma)({jja:ya}=this.l3c.Kwh(P,
da,ma,pa)),Ja[Ja.length]=ya;ma=new K.a;ma.ae=C.ae;ma.Lf=C.Lf;ma.ge=pa-1;ma.Tf=pa+1;for(ma=this.uca.eBa(P,da,ma);ma.moveNext();)ya=ma.Cz,Ka=ma.SZb(),this.dQf(pa,ya.ae,Ka),this.ljh(pa,ya.ae,Ka,ia);for(ma=C.ae;ma<C.Lf;++ma){ya=P.hf(pa-1,ma);Ka=P.hf(pa,ma);var ra=this.oq.MH(da,pa-1,ma);ra.ae===ma&&(ya=P.hf(ra.ge,ra.ae),ra=pa-ra.ge,Ka.rowSpan=ya.rowSpan-ra,ya.rowSpan=ra,Ka.colSpan=ya.colSpan);Ka.isGhostCell=ya.isGhostCell}da.cRa(1);this.Q3.yVd(P,da,pa,C.ae,C.Lf,!0);for(let Da=C.ae,va=0;Da<=C.Lf;++Da,++va)Ja[va]&&
this.Q3.YIe(P,da,Da,pa,pa+1,Ja[va])}return{returnValue:pa,sRa:Z}}Yti(P,ea,da,ia,C,oa){var Z;let pa=({y9d:Z}=M.b(C,oa.x)).returnValue;if(Z=!Z){pa++;var ya=C[pa-1],Ja=C[pa],Ka=this.Ib.Jc(P);this.VN.KSg(Ka);Ka.Hp(pa-1,1);this.i1c.U5d(Ka);if(Ka=P.ta(A.a.ru,null))Ka=r.a.clone(Ka),Ka[pa-1]=ea.yf(oa.x-ya,0),Ka[pa]=ea.yf(Ja-oa.x,0),P.setValue(A.a.ru,Ka);Array.insert(C,pa,oa.x);da.cRa(3)}for(ea=0;ea<oa.tfh.length;++ea){C=oa.tfh[ea];ya=[];for(Ja=C.ge;Ja<=C.Tf;++Ja)({jja:Ka}=this.l3c.Gwh(P,da,Ja,pa)),ya[ya.length]=
Ka;Ja=new K.a;Ja.ge=C.ge;Ja.Tf=C.Tf;Ja.ae=pa-1;Ja.Lf=pa+1;for(Ja=this.uca.eBa(P,da,Ja);Ja.moveNext();){Ka=Ja.Cz;var ma=Ja.SZb();this.dQf(Ka.ge,pa,ma);this.ljh(Ka.ge,pa,ma,ia)}for(Ja=C.ge;Ja<C.Tf;++Ja){Ka=P.hf(Ja,pa-1);ma=P.hf(Ja,pa);var ra=this.oq.MH(da,Ja,pa-1);ra.ge===Ja&&(Ka=P.hf(ra.ge,ra.ae),ra=pa-ra.ae,ma.colSpan=Ka.colSpan-ra,Ka.colSpan=ra,ma.rowSpan=Ka.rowSpan);ma.isGhostCell=Ka.isGhostCell}da.cRa(1);this.Q3.zVd(P,da,pa,C.ge,C.Tf,!0);for(let Da=C.ge,va=0;Da<=C.Tf;++Da,++va)ya[va]&&this.Q3.THe(P,
da,Da,pa,pa+1,ya[va])}return{returnValue:pa,sRa:Z}}WQi(P,ea,da,ia,C){var oa=this.uca.eBa(P,ea,da.yD);oa.moveTo(da.ON,da.KK);da=oa.Cz;for(let Z=1;Z<ia;++Z)oa.mbk(),da.Tf=oa.Cz.Tf,da.Lf=oa.Cz.Lf;for(ia=1;ia<C;++ia)oa.moveNext(),da.Tf=oa.Cz.Tf,da.Lf=oa.Cz.Lf;for(C=this.uca.eBa(P,ea,da);C.moveNext();){oa=C.Cz;let Z;oa.Tf<da.Tf&&({jja:Z}=this.l3c.Gwh(P,ea,da.Tf,oa.ae)).returnValue&&this.Q3.THe(P,ea,oa.Tf,oa.ae,oa.Lf,Z);oa.Lf<da.Lf&&({jja:Z}=this.l3c.Kwh(P,ea,da.Lf,oa.ge)).returnValue&&this.Q3.YIe(P,ea,
oa.Lf,oa.ge,oa.Tf,Z)}}pKi(P,ea){P=this.Ib.Jc(P);this.Vbc(P,ea.ge);for(let da=ea.ge;da<ea.Tf;++da){const ia=P.currentNode.ta(u.a.Nt,0);ia&&ia<this.Fk.SBc(P.currentNode)&&P.currentNode.setValue(u.a.Nt,0);P.xf(1)}}nKi(P,ea){let da=P.ta(A.a.ru,null),ia=!1;if(da){da=r.a.clone(da);for(let C=ea.ae;C<ea.Lf;++C){const oa=this.Fk.bob(P,C);da[C]&&da[C]<oa&&(da[C]=oa,ia=!0)}}ia&&P.setValue(A.a.ru,da)}dQf(P,ea,da){const ia=da.getContainingTable();ia||H.a.J(592483613,822,10,"Not able to access TableNode from Table Cell Node");
ia.hf(P,ea).cellShading=da.cellShading}ljh(P,ea,da,ia){const C=da.getContainingTable();C||H.a.J(592483611,822,10,"Not able to access TableNode from Table Cell Node");P=y.GraphIterator.nb(C.hf(P,ea));this.M9b.zY(P,!0,ia(da))}Vbc(P,ea){for(this.VN.KSg(P);0<ea--;)this.VN.sbk(P)}Gah(P){P=this.Ib.WYd(P);let ea=P.yb(1);for(;ea;)ea=P.pOa(1)}}ca.rLi="Exception";Object(J.a)(ca,"TableMergeSplitEditor",null,[477])},973:function(J,V,d){J=d(0);var h=d(13),e=d(374),m=d(25),r=d(163),v=d(192),A=d(57);class x{constructor(M,
N,W,K){this.Pwd=null;this.sqc=K;this.aaa=M;this.baa=N;this.AO=W;this.auf=this.wQg.j7k;M=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.yOh=M[0];this.xOh=M[1]}get wQg(){return this.Pwd||(this.Pwd=A.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get NQa(){return CommonUIStrings.l_OICErrorHelpLink}get ekc(){return this.auf}get yQg(){return this.yOh}get xQg(){return this.xOh}get vQg(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.auf?
3:2}get oYb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get YDc(){return!!this.baa}get pYb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get oOa(){return CommonUIStrings.l_DefaultDialogTitle}QBe(M){this.ucc(M)}rbe(M){this.ucc(M)}ucc(M){let N=10;this.baa&&1===M&&(this.baa(this.AO),N=1);this.aaa&&this.aaa(this.AO);this.zo(N)}Acb(){v.Redirect.showHelp("OICFailure");this.zo(2)}ste(){this.wQg.Fyg();this.zo(4)}zo(M){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.sqc,M);m.AFrameworkApplication.MWa(r.a.E0g,this.sqc,M)}dispose(){this.AO=this.aaa=this.baa=null}}Object(J.a)(x,"AOICErrorDialog",null,[109]);var y=d(91),u=d(102);class H extends x{constructor(M,N,W,K){super(M,N,W,K);this.jLa=this.ez=null;M=document.createElement("span");M.id="errorMessageText";M.innerText=this.errorMessage;M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));this.ez=document.createElement("a");this.ez.href="#";this.ez.innerText=this.NQa;M.appendChild(this.ez);
y.a.addHandler(this.ez,"click",Object(h.a)(this,this.Acb,"oicErrorHelpLinkHandler"));N=new u.StandardDialog;N.kg=this.id;this.ekc?(W=document.createElement("span"),K=document.createElement("span"),W.innerText=this.yQg,K.innerText=this.xQg,this.jLa=document.createElement("a"),this.jLa.href="#",this.jLa.innerText=this.vQg,M.appendChild(document.createElement("br")),M.appendChild(W),M.appendChild(this.jLa),M.appendChild(K),y.a.addHandler(this.jLa,"click",Object(h.a)(this,this.ste,"oicErrorMacOfferLinkHandler"))):
this.YDc&&(M.appendChild(document.createElement("br")),M.appendChild(document.createElement("br")),W=document.createElement("span"),W.innerText=this.oYb,M.appendChild(W));this.YDc?(N.vd=1,N.Pe(1,this.pYb)):N.vd=0;N.Tw(this.oOa,null,this.icon,Object(h.a)(this,this.rbe,"legacyOICErrorDialogHandler"),M);N.D4("errorMessageText")}dispose(){this.ez&&(y.a.removeHandler(this.ez,"click",Object(h.a)(this,this.Acb,"oicErrorHelpLinkHandler")),this.ez=null);this.jLa&&(y.a.removeHandler(this.jLa,"click",Object(h.a)(this,
this.ste,"oicErrorMacOfferLinkHandler")),this.jLa=null);super.dispose()}}Object(J.a)(H,"OICErrorDialog",x,[]);class G{constructor(M,N,W){this.aaa=N;this.baa=M;this.AO=W}get id(){return"OICErrorDialogWithDownload"}get i_f(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get NQa(){return CommonUIStrings.l_OICErrorHelpLink}get oYb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get pYb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get oOa(){return CommonUIStrings.l_DefaultDialogTitle}QBe(M){this.ucc(M)}rbe(M){this.ucc(M)}ucc(M){let N=
10;1===M&&(this.baa(this.AO),N=1);this.aaa&&this.aaa(this.AO);this.zo(N)}Acb(){v.Redirect.showHelp("OICFailure");this.zo(2)}zo(M){m.AFrameworkApplication.MWa(r.a.F0g,3,M)}dispose(){this.AO=this.baa=this.aaa=null}}Object(J.a)(G,"AOICErrorDialogWithDownload",null,[109]);class E extends G{constructor(M,N,W){super(M,N,W);this.ez=null;M=document.createElement("span");M.id="errorMessageText";M.innerText=this.i_f;M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));this.ez=
document.createElement("a");this.ez.href="#";this.ez.innerText=this.NQa;M.appendChild(this.ez);y.a.addHandler(this.ez,"click",Object(h.a)(this,this.Acb,"oicErrorHelpLinkHandler"));M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));N=document.createElement("span");N.innerText=this.oYb;M.appendChild(N);N=new u.StandardDialog;N.kg=this.id;N.vd=1;N.Pe(1,this.pYb);N.Tw(this.oOa,null,this.icon,Object(h.a)(this,this.rbe,"legacyOICErrorDialogHandler"),M);N.D4("errorMessageText")}dispose(){this.ez&&
(y.a.removeHandler(this.ez,"click",Object(h.a)(this,this.Acb,"oicErrorHelpLinkHandler")),this.ez=null);super.dispose()}}Object(J.a)(E,"OICErrorDialogWithDownload",G,[]);var I=d(83);class Q extends x{constructor(M,N,W,K){super(M,N,W,K);N={["errorMessage"]:this.errorMessage};N.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.NQa,["onExecute"]:ca=>{this.Acb(ca)}};this.ekc?(N.macOfficePreLinkText=this.yQg,N.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.vQg,
["onExecute"]:ca=>{this.ste(ca)}},N.macOfficePostText=this.xQg):this.YDc&&(N.errorFileDownloadOffer=this.oYb);M=new I.a(!1,!1,!0);this.YDc?(M.vd=1,M.Pe(1,this.pYb)):M.vd=0;M.kg=this.id;N={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:N};M.qj(this.oOa,Object(h.a)(this,this.QBe,"reactOICErrorDialogHandler"),N)}}Object(J.a)(Q,"ReactOICErrorDialog",x,[]);class D extends G{constructor(M,N,W){super(M,N,W);N={["errorMessage"]:this.i_f,["errorFileDownloadOffer"]:this.oYb};N.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.NQa,["onExecute"]:K=>{this.Acb(K)}};M=new I.a(!1,!1,!0);M.vd=1;M.Pe(1,this.pYb);M.kg=this.id;N={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:N};M.qj(this.oOa,Object(h.a)(this,this.QBe,"reactOICErrorDialogHandler"),N)}}Object(J.a)(D,"ReactOICErrorDialogWithDownload",G,[]);d.d(V,"a",function(){return Y});class Y{constructor(){this.doa=!!m.AFrameworkApplication.Ba&&m.AFrameworkApplication.Ba.jb.QB}pxi(M,N,W){this.doa?new Q(M,N,null,W):new H(M,N,null,W)}qxi(M,
N,W){this.doa?new D(M,N,W):new E(M,N,W)}rxi(M,N,W,K,ca){const {ReactOICErrorDialogWithTrial:P}=d(1072),{OICErrorDialogWithTrial:ea}=d(1073);this.doa?new P(M,N,W,null,K,ca):new ea(M,N,W,null,K,ca)}static get instance(){return Y.Ka||(Y.Ka=new Y)}}Y.Ka=null;Object(J.a)(Y,"OICErrorDialogFactory",null,[716])},977:function(J,V,d){J=d(0);var h=d(374),e=d(95),m=d(63),r=d(88);class v{constructor(){this.hasImpliedUsage=this.additionalValues=this.isInternal=this.isIntentional=null}}Object(J.a)(v,"IKpiFailureOptionalProperties",
null,[]);class A{constructor(){this.hasImpliedUsage=this.additionalValues=null}}Object(J.a)(A,"IKpiSuccessOptionalProperties",null,[]);var x=d(901);class y{constructor(){this.blockFutureEmissionDurationInMs=this.optionalVeto=this.optionalProperties=this.errorName=this.kpiName=null}}Object(J.a)(y,"KpiFailureParams",null,[]);class u{constructor(){this.blockFutureEmissionDurationInMs=this.optionalProperties=this.kpiName=null}}Object(J.a)(u,"KpiSuccessParams",null,[]);var H=d(902);d.d(V,"a",function(){return G});
class G{static getInstance(E){try{return healthSmall.HealthFactoryGlobal.getExtendedHealthInstance(e.Health.instance,E)}catch(I){return h.ULS.oFb(521457890,383,10,I,"Failed to initialize extendedHealth"),null}}static nGk(E,I){const Q=G.getInstance(E);Q&&Q.logKpiUsage(G.C3i());const D=m.a.pj();try{const Y=I();Y.then(M=>{const N=G.B3i(m.a.pj()-D);Q&&Q.logKpiSuccess(N);return M}).catch(M=>{M=G.h$f(M?M.toString():"UnknownError",m.a.pj()-D);Q&&Q.logKpiFailure(M)});return Y}catch(Y){throw E=G.h$f(Y.message,
m.a.pj()-D),Q&&Q.logKpiFailure(E),Y;}}static C3i(){const E=Object.assign(new x.a,{extendedProperties:G.rYd()});return Object.assign(new H.a,{kpiName:"InitFloodgate",kpiType:0,optionalProperties:E,blockFutureEmissionDurationInMs:3E5})}static B3i(E=null){E=Object.assign(new A,{additionalValues:Object.assign(new r.a,{extendedProperties:G.rYd(),durationMs:E})});return Object.assign(new u,{kpiName:"InitFloodgate",optionalProperties:E,blockFutureEmissionDurationInMs:3E5})}static h$f(E,I=null){I=Object.assign(new v,
{additionalValues:Object.assign(new r.a,{extendedProperties:G.rYd(),durationMs:I})});return Object.assign(new y,{kpiName:"InitFloodgate",errorName:E,optionalProperties:I,blockFutureEmissionDurationInMs:3E5})}static rYd(){const E=new Map;E.has("SkipAria")||E.set("SkipAria","True");return E}}Object(J.a)(G,"ExtendedHealth",null,[])},982:function(J,V,d){J=d(0);var h=d(374),e=d(1154),m=d(1155),r=d(1156),v=d(120),A=d(25),x=d(977),y=d(196),u=d(268),H=d(94),G=d(248),E=d(303),I=d(33),Q=d(55),D=d(45);class Y{constructor(){this.cvFlights=
this.uiHost=this.productName=null;this.isCVSurveyEnabled=!1}}Object(J.a)(Y,"CustomerVoiceSurveyParams",null,[]);var M=d(141),N=d(521);class W{sendTelemetryEvent(P){const ea=new N.a;ea.otelEvent=P;M.a.sendOtelEvent(ea)}}Object(J.a)(W,"OtelTelemetrySink",null,[690]);var K=d(903);d.d(V,"a",function(){return ca});class ca{static init(P,ea,da,ia,C){C.onDismiss=P;C.onError=ea;P=null;OfficeBrowserFeedback.initOptions?("screenshot"in C&&(OfficeBrowserFeedback.initOptions.screenshot=C.screenshot),"showEmailAddress"in
C&&(OfficeBrowserFeedback.initOptions.showEmailAddress=C.showEmailAddress),"feedbackForumUrl"in C&&(OfficeBrowserFeedback.initOptions.feedbackForumUrl=C.feedbackForumUrl),P=C):OfficeBrowserFeedback.initOptions=C;OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=ca.VRf());OfficeBrowserFeedback.multiFeedback(P).then(()=>{h.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")}).catch(oa=>h.ULS.sendTraceTag(36300303,356,10,"BFCOCV Error:"+
oa.toString()))}static s5d(P,ea,da,ia){h.ULS.sendTraceTag(36546398,356,50,"BFCOCV.Entered InitSIFeedback");if(ca.Qjb===ca.initialized)return Promise.resolve(1);if(ca.Qjb===ca.xlg)return ca.ylg||(ca.ylg=!0,h.ULS.sendTraceTag(36546399,356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(ca.Qjb!==ca.error){ca.Qjb=ca.xlg;h.ULS.sendTraceTag(36546400,356,50,"BFCOCV.InitSIFeedback:past init check");if(ca.huj(P,ea,da,ia))return ca.Ntj();ca.Qjb=ca.error;Promise.reject(ca.IUg)}return Promise.reject(0)}static Ntj(){try{return x.a.nGk(ca.A3i(),
()=>OfficeBrowserFeedback.floodgate.initialize().then(()=>ca.GMe())).catch(P=>{h.ULS.sendTraceTag(36546402,356,10,"BFCOCV Floodgate initialize error:"+P.toString())})}catch(P){return h.ULS.sendTraceTag(590975881,356,15,"BFCOCV Floodgate initialize error:"+P.toString()),Promise.reject(ca.Xdk)}}static A3i(){return Object.assign(new K.a,{featureName:"Floodgate",crewAlias:"floodgatecrew",vetoPillar:"OfficeBrowserFeedback"})}static GMe(){return OfficeBrowserFeedback.floodgate.start().then(()=>{ca.ARi()}).catch(P=>
{h.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+P.toString())})}static ARi(){ca.Qjb=ca.initialized;h.ULS.sendTraceTag(36546403,356,50,"BFCOCV.Started floodgate");try{const P=A.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateTestActivity","");for(const ea of P.split("|"))ea&&ca.logActivity(ea,null)}catch(P){h.ULS.sendTraceTag(539015366,356,50,"Error triggering test activity")}}static wsa(){let P=!1;const ea=A.AFrameworkApplication.fa;ea&&(P=
"teams"===(ea.Ia(A.AFrameworkApplication.lJ)||"").toLowerCase());return Q.a.yDa||P}static NUg(){return"undefined"==typeof OfficeBrowserFeedback}static huj(P,ea,da,ia){let C=!0;try{if(ca.NUg())return h.ULS.sendTraceTag(39900617,356,15,ca.IUg),!1;OfficeBrowserFeedback.initOptions||(da.onDismiss=ia,da.onError=ea,da=ca.f7h(da),OfficeBrowserFeedback.initOptions=da);OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=ca.VRf());ea={};ia={};ia.onSurveyActivated=
ca.tmk;ia.onTeachingCampaignRender=da.onTeachingCampaignRender;ea.onSurveyActivatedCallback=ia;ea.onDismiss=P;ea.autoDismiss=da.FloodgateUIAutoDismissTimeEnum;ea.telemetryGroup=da.telemetryGroup;ea.uIStringGetter=da.uIStringGetter;ea.authTokenCallback=da.authTokenCallback;ea.augLoopCallback=da.augLoopCallback;ea.campaignFlights="";ea.governanceServiceEnabled=da.governanceServiceEnabled;ea.governanceServiceConfig=da.governanceServiceConfig;ea.personalizerEnabled=da.personalizerEnabled;ea.messagingServiceSettings=
da.messagingServiceSettings;ea.isPriorityEnabled=da.isPriorityEnabled;A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&("surveyEnabled"in da&&(ea.surveyEnabled=da.surveyEnabled),"showEmailAddress"in da&&(ea.showEmailAddress=da.showEmailAddress));ea.isEudbUxEnabled=!1;A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EUDBUXIsEnabled",!1)&&(ea.isEudbUxEnabled=!0);const Z=ca.JZi(da),pa=ca.X8f(Z);let ya=ca.c_i(da);
for(let Ja in pa){P=Ja;var oa=pa[Ja];-1!==P.toLowerCase().indexOf("flight")?ea.campaignFlights+=oa+";":ya=ya+P+"="+oa+"&"}h.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+ea.campaignFlights+" campaignQueryParameters: "+ya);ea.campaignQueryParameters=ya;ea.customerVoiceSurveyParams=ca.VZi(da.Application.toString(),ca.wsa()?ca.Whl:"");OfficeBrowserFeedback.floodgate.initOptions=ea}catch(Z){C=!1,h.ULS.sendTraceTag(39900618,356,15,Z.toString())}return C}static f7h(P){try{const ea=P.applicationGroup?
P.applicationGroup:{},da=ea.appData,ia=da?I.a(I.a('"'+da+'"')):{};ia.fgUIAutoDismiss=P.FloodgateUIAutoDismissTimeEnum;ea.appData=I.c(ia);P.applicationGroup=ea}catch(ea){h.ULS.sendTraceTag(588842831,356,10,"Failed to parse applicationGroup.appData",ea.toString())}return P}static JZi(P){P=Array.isArray(P.Flights)?P.Flights:null;P||(P=(P=A.AFrameworkApplication.fa.Ia("FlightId"))?P.toString().split(";"):null);if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateTreatmentVariableFlighting",
!0)){const ea=A.AFrameworkApplication.fa.dZb;if(ea)for(let da in ea){const ia={key:da,value:ea[da]};-1!==(ia&&ia.key?ia.key.toLowerCase():"").indexOf("floodgateflight")&&"unset"!==(ia&&ia.value?ia.value.toString().toLowerCase():"")&&P.push(ia.key)}}return P}static X8f(P){const ea={SelfTriggerActivity:""};if(!P||!P.length)return ea;try{for(let C=0;C<P.length;C++){let oa=P[C]?P[C].toLowerCase():"";if(-1===oa.indexOf("floodgateflight"))continue;const Z=oa.lastIndexOf(".");-1!==Z&&(oa=oa.substring(Z+
1,oa.length));if(-1!==("AppFlights"in ea?ea.AppFlights:"").indexOf(oa))continue;ea.AppFlights="AppFlights"in ea?ea.AppFlights+(";"+oa):oa;const pa=D.a.replaceAll(oa,"-",""),ya=A.AFrameworkApplication.fa.Ia(pa);if(ya)try{const Ja=I.a(ya);Ja&&Ja.SelfTriggerActivity||(ea.SelfTriggerActivity+=";"+pa);if(Ja)for(let Ka in Ja){var da=Ka,ia=Ja[Ka];da in ea?ea[da]!==ia&&(ea[da]=ea[da]+";"+ia):ea[da]=ia}}catch(Ja){h.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+pa+" json data",Ja.toString())}else ea.SelfTriggerActivity+=
";"+pa}}catch(C){h.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",C.toString())}return ea}static c_i(P){let ea="";const da={["OFC_Audience"]:"AudienceGroup",["Datacenter"]:"WACDatacenter",["TenantId"]:"TenantId"};for(let oa in da){var ia=oa,C=da[oa];let Z=P[Object(e.a)(String,C)];Z||(Z=A.AFrameworkApplication.fa.Ia(Object(e.a)(String,C)));Z&&(ea+=ia+"="+encodeURIComponent(Z)+"&")}return ea}static VZk(P){ca.WPd=P}static tmk(P,ea,da){if(P)try{const C=
ea?ea.getCampaignId():"",oa=ea?ea.getLauncherType():"",Z=da?da.contextInfo:null;var ia=ea?ea.getSurveyInfo():null;const pa=ia?ia.getPreferredLaunchType():null,ya=ia?ia.getMetadata():null,Ja=ya?ya.getContentMetadata():null,Ka=Ja?Ja.customSurveyName:null,ma=Ja?Ja.telemetryEventName:null;ca.cBj(C)?h.ULS.sendTraceTag(539015367,356,50,"BFCOCV.onSurveyActivated campaign disabled -"+C):(ia={},ia.campaignId=C,ia.surveyName=Ka,ia.launcherType=oa,ia.contextInfoLength=Z?Z.length.toString():"-1",ia.preferredLaunchType=
pa,ia.telemetryEventName=ma,h.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated -  "+JSON.stringify(ia)),oa&&"coachingux"===oa.toLowerCase()&&pa&&"default"!==pa.toLowerCase()&&ca.vhg(Ja,ea,da)?h.ULS.sendTraceTag(555071513,356,50,"BFCOCV.onSurveyActivated. Custom survey activation successful - "+JSON.stringify(ia)):(P.launch(da),ca.Qlh()))}catch(C){h.ULS.sendTraceTag(555071514,356,10,"BFCOCV.onSurveyActivated. Error handling activation callback - "+(C?C.toString():""))}else h.ULS.sendTraceTag(36706400,
356,10,"BFCOCV.onSurveyActivated given a null launcher")}static ynj(P){P=P?P.surfaceContext:null;if(!P||!P.surveyForm)return h.ULS.sendTraceTag(555071516,356,10,"Missing activation arguments"),!1;try{const ea=P.surveyForm.getSurveyInfo(),da=ea?ea.getMetadata():null,ia=da?da.getContentMetadata():null;return ca.vhg(ia,P.surveyForm,P.surveyParams)}catch(ea){h.ULS.sendTraceTag(555071517,356,10,"BFCOCV.HandleActivationCallback Error - "+(ea?ea.toString():""))}return!1}static vhg(P,ea,da){if(!P||!P.customSurveyName||
!ea)return h.ULS.sendTraceTag(555071518,356,10,"Survey arguments not provided "+(P?P.customSurveyName:null)),!1;const ia=ea.getCampaignId();if(P.telemetryEventName){var C={["action"]:"Opened",["id"]:ia,["success"]:"true",["triggerType"]:"custom",["customSurveyName"]:P.customSurveyName,["telemetryEventName"]:P.telemetryEventName};ca.WPd?ca.WPd(P.telemetryEventName,C):(A.AFrameworkApplication.Pj(P.telemetryEventName),A.AFrameworkApplication.tVc(P.telemetryEventName),h.ULS.sendTraceTag(512505554,356,
50,"BFCOCV.onSurveyActivated survey activated -"+JSON.stringify(C)))}C=ca.xzf.Kb(P.customSurveyName)?ca.xzf.ga(P.customSurveyName):null;if(!C)return h.ULS.sendTraceTag(555071519,356,50,"Activation callback not found - "+P.customSurveyName+", "+ia),!1;(P=C(ea,da))&&P.then(oa=>{h.ULS.sendTraceTag(555071520,356,50,"Activation callback result - "+JSON.stringify(oa))}).catch(oa=>{h.ULS.sendTraceTag(555071521,356,50,"Error in activation callback handling: "+(oa?oa.toString():""))});return!0}static cBj(P){try{return-1!==
A.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase().indexOf((P||"").toLowerCase())}catch(ea){h.ULS.sendTraceTag(539015368,356,10,"Error checking if campaign is disabled - "+P)}return!1}static logActivity(P,ea=null){if(ca.GLd(P,"LogActivity")){var da=ca.JYd();da&&(h.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+P),da.logActivity(P,1,ea))}}static RGb(P){P?(h.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),
OfficeBrowserFeedback.floodgate.showCustomSurvey(P),ca.Qlh()):h.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")}static Qlh(){ca.lpa(ca.q3f)}static lvj(P,ea,da){var ia=[3,2,5,1];const C=H.FocusManager.instance(),oa=C.Bc(P);oa.parent=v.AFrame.kj;oa.HK=!0;u.a.instance.q1(P,!0);ea&&oa.vaa(ea);if(da){G.a.instance.i6(P,da,!1,!0);E.a.instance.i6(P,da,!1,!0);P=new y.DOMFocusListing(()=>da);for(ea=0;ea<ia.length;++ea)P.ho(ia[ea]);C.Sga(()=>da,oa,P).CS=!0}}static lpa(P){const ea=document.getElementById(P);
ea?ca.lvj(P,ca.uhk,ea):h.ULS.sendTraceTag(36706402,356,15,"BFCOCV.Could not find container "+P)}static uhk(P,ea){h.ULS.sendTraceTag(37107265,356,100,"BFCOCV.OnFocusAction. PrevScopeName "+(P?P.name:"")+" NextScopeName "+(ea?ea.name:""));ea&&(P=H.FocusManager.instance().AP(ea.name))&&P.g5c()}static D5b(P){if(ca.GLd(P,"LogActivityStart")){var ea=ca.JYd();ea&&(h.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+P),ea.logActivityStartTime(P))}}static Gzg(P){if(ca.GLd(P,"LogActivityEnd")){var ea=
ca.JYd();ea&&(h.ULS.sendTraceTag(37856262,356,50,"BFCOCV.Calling OCV's logActivityStopTime "+P),ea.logActivityStopTime(P,new Date))}}static BRi(){OfficeBrowserFeedback.floodgate.start()}static CRi(){OfficeBrowserFeedback.floodgate.stop()}static GLd(P,ea){P||h.ULS.sendTraceTag(36546433,356,10,"BFCOCV.Error. null 'name' in method "+ea);return!!P}static JYd(){let P=null;const ea=OfficeBrowserFeedback.floodgate.getEngine();ea?(P=ea.getActivityListener())||h.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null"):
ca.sUg||(ca.sUg=!0,h.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null"));return P}static VRf(){return new W}static VZi(P,ea){return Object.assign(new Y,{productName:P,uiHost:ea,cvFlights:"",isCVSurveyEnabled:!0})}}ca.q3f="obf-ToastContainer";ca.notInitialized=0;ca.xlg=1;ca.initialized=2;ca.error=-1;ca.Qjb=ca.notInitialized;ca.sUg=!1;ca.ylg=!1;ca.IUg="OFB still undefined";ca.Xdk="OFB Floodgate is undefined or does not contain initialize function";ca.Whl="Teams";ca.xzf=new m.a(r.a.rt());
ca.WPd=null;Object(J.a)(ca,"BrowserFeedbackControlOCV",null,[])},985:function(J,V,d){d.r(V);J=d(0);var h=d(387),e=d(78),m=d(91),r=d(66),v=d(284),A=d(1185),x=d(25),y=d(45),u=d(55),H=d(141),G=d(95),E=d(13),I=d(26),Q=d(42),D=d(85),Y=d(913);class M{constructor(){this.DocID=this.CustomFontCatalogUrl=this.DownloadUrl=null}}Object(J.a)(M,"IDocSource",null,[]);var N=d(922),W=d(917),K=d(914),ca=d(915),P=d(919),ea=d(918),da=d(923),ia=d(916),C=d(920),oa=d(921),Z=d(57);class pa{createAuthProviderAsync(ra){Z.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").w3a();
return new Promise(Da=>{Z.a.instance.Oa("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(va=>{va=va.kui(ra);Da(va)})})}}Object(J.a)(pa,"SlideShowAppForOfficeAuthFactory",null,[]);var ya=d(968),Ja=d(73),Ka=d(431);d.d(V,"SlideShowCoreFrame",function(){return ma});class ma{constructor(ra,Da,va,Fa,ka,qa,Ua,Ya,Va,ua,Ca,Ea){this.p_=this.$l=this.v1c=this.d1c=this.dPg=null;this.Mca=new h.a;this.va=new e.a;this.ope=this.dHg=this.iac=this.kW=this.T8=this.S8=this.lta=this.K=this.LN=this.sD=this.AAb=null;
this.nOg=!0;this.t$a=this.vOg=0;this.Xxb=!1;this.nf=ra;this.la=Da;this.Cc=va;this.NUa=Ua;this.Aca=Fa;this.gk=ka;this.Nb=qa;this.wG=Va;this.Or=Ya;this.Nbb=Ca;this.Qd=Ea;try{const wb=this.p_=JSON.parse(this.la.Ia("Settings"));wb.slideshowcore||(wb.slideshowcore={});wb.slideshowcore&&wb.slideshowcore.forceSvg&&"true"===wb.slideshowcore.forceSvg.toString().toLowerCase()?this.Nbb=!0:this.Nbb&&(wb.slideshowcore.forceSvg="True")}catch(wb){I.a.J(576020620,830,15,"Exception in parsing settings:{0}",wb),this.p_=
{}}}preloadShaders(){const ra={};ra.settings=this.p_;ra.logger=this.Mca;ra.disabledChangeGates=this.la.Ia("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(ra);SlideShowCore.SlideShowCore.preloadShaders()}init(ra,Da,va,Fa){this.AAb=va;this.LN=Fa;if(!this.sD){this.lta=document.getElementById("HiddenFocusTrapAnchor");this.sD=document.createElement("div");this.sD.id="SlideShowBackground";this.sD.className="SlideShowBackground";this.sD.style.visibility=Ja.a.Qs;this.sD.tabIndex=
-1;this.K=document.createElement("div");this.K.id="SlideShowContainer";this.K.className="SlideShowContainer";this.K.tabIndex=-1;this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";m.a.addHandler(this.sD,r.a.Hua,Object(E.a)(this,this.mjk,"onMouseMoveHandler"));v.a.instance.pb(this.sD,Object(E.a)(this,this.Dcb,"onContextMenuHandler"));this.sD.appendChild(this.K);Q.a("PresenterCoachTabFix")&&this.lta?this.nf.insertBefore(this.sD,this.lta):this.nf.appendChild(this.sD);
ra=this.la.Ia("pptSlideShowCoreCssUrl");va=document.createElement("link");va.setAttribute("rel","stylesheet");va.setAttribute("type","text/css");va.setAttribute("href",ra);this.K.appendChild(va);ya.a.instance.init(this.la,this.sD,this.Cc,this,this.gk,this.Nb,this.wG);ra=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.LN);va=new A.a(x.AFrameworkApplication.Be);var ka=Date.now();Ka.b(va.ajc(ra)).then(qa=>{I.a.J(594384270,830,15,"SlideShowCoreFrame::Init: GetSnappedDownloadLink elapse:{0}",
Date.now()-ka);try{var Ua=JSON.parse(qa);if(this.kW=Ua.downloadUrl){qa={};qa.timeout=this.la.Gc("PptModernSlideShowGetItemsTimeoutMs",3E4);qa.throwHttpErrors=!0;qa.enableServerSpecificErrorCode=Q.a("SSCore.EnableServerSpecificErrorCode");var Ya=void 0!==this.la.Qla&&null!==this.la.Qla?y.a.nV(this.la.Qla).toLowerCase():"",Va=Object.assign(new M,{DownloadUrl:this.kW,DocID:x.AFrameworkApplication.$g,CustomFontCatalogUrl:this.la.Ia("CustomFontCatalogURL")});try{const Ca=this.p_;Ca.podsproxy&&(Ua={},Ua.settings=
Ca,window.PodsProxy.setupGlobals_PodsProxy(Ua))}catch(Ca){I.a.J(528605710,830,15,"Exception in passing settings to podsproxy:{0}",Ca)}this.d1c=new PodsProxy.PodsProxy(this.la.j6a?this.la.ULc:this.la.podsWebServiceBase,Va,Ya,this.Mca,this.fbg(Da),qa);Ya={};Ya.settings=this.p_;Ya.retryCount=this.la.Gc("GetItemsRetryCount",3);Ya.retryOnCategories=this.la.Ia("GetItemsRetryCategories").split(";");Va={};Va.Slide=ResourceStrings.l_Slide;Va.AnimNum=ResourceStrings.l_AccSsAnimNum;Va.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;
Va.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;Va.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;Va.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;Ya.localizedStrings=Va;this.v1c=new SlideShowCore.DefaultResourceProviders(this.d1c,this.Mca,Ya);Ya={};Ya.initTime=ma.E_b();Ya.uiHost="Unified App";Ya.serverUrl=y.a.Me(this.la.podsWebServiceBase);Ya.userSessionId=this.AAb;Ya.jsScriptsBasePath=this.la.Ia("StaticContentHost")+"pptscripts/ssapp/";Ya.fileHost=this.la.Ia("FileHost");
Ya.isRtl=x.AFrameworkApplication.isRtl;Ya.applicationLcid=x.AFrameworkApplication.lcid;Ya.applicationLocaleName=x.AFrameworkApplication.uiCulture;Ya.areThirdPartyAddInsAllowed=x.AFrameworkApplication.ypa;Ya.theWsaClient=x.AFrameworkApplication.Yi;Ya.appForOfficeContextActivationParameters=Y.a.mdg(this.Qd);this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.ModernSlideShowAddInSSO",!1)&&(Ya.appForOfficeAuthFactory=new pa);Va={};Va.settings=this.p_;Va.transitionResourceCDNPath=this.la.pTf;
Va.transitionDisabledList=this.la.gJa;Va.clickTargetEnabled=!0;Va.mediaEnabled=!0;Va.gifEnabled=!0;Va.convertGifToVideo=!0;Va.crossSlideAudioEnabled=!0;Va.editAudioEnabled=this.la.ka("PPTOAudioPlaybackOptionsEnabled");Va.flipgridVideoEnabled=this.la.ka("PptModernSlideShowFlipgridVideoEnabled");Va.useNewYoutubePlayer=!0;Va.useNewVimeoPlayer=!0;Va.useOnlineVideoPlayer=!0;Va.tedVideoEnabled=this.la.ka("PptModernSlideShowTEDVideoEnabled");Va.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;Va.enableSVGAsWebGLTexture=
!u.a.ag&&this.la.ka("SlideShowShapeBuilderSVGEnabled");Va.maxSvgTextureSize=this.la.Gc("ShapeBuilderMaxSvgTextureSize",2048);Va.enableSlideSizeAdjust=this.la.ka("EnableSlideSizeAdjust");Va.slideSizeMax={["x"]:this.la.Gc("SlideShowMaxWidth",1504),["y"]:this.la.Gc("SlideShowMaxHeight",849)};Va.slideSizeMin={["x"]:this.la.Gc("SlideShowMinWidth",348),["y"]:this.la.Gc("SlideShowMinHeight",261)};Va.slideSizeDefault={["x"]:this.la.Gc("SlideShowDefaultWidth",1504),["y"]:this.la.Gc("SlideShowDefaultHeight",
849)};Va.streamVideoUseThinEmbed=this.la.ka("StreamVideoUseThinEmbed");Va.slideMetadataEnabled=this.la.ka("PptModernSlideShowSlideMetadataEnabled");Va.disabledChangeGates=this.la.Ia("PPTDisabledChangeGates");Va.combineBootRequest=!0;Va.localVideoTelemetryEnabled=this.la.ka("IsGFXVideoLocalTelemetryEnabled");Va.imageSettings={["imageAppendOption"]:"all"};const ua={["slideShowCoreSettings"]:Va,["appSettings"]:Ya};this.$l=new SlideShowCore.SlideShowCore(this.K,this.v1c,this.Mca,ua);new SlideShowCore.PrefetchAddon(this.$l,
this.Mca,{["forwardPrefechCount"]:this.la.Gc("PptModernSlideShowForwardPrefetchCount",10),["backwardPrefechCount"]:this.la.Gc("PptModernSlideShowBackwardPrefetchCount",5),["forwardPrerenderCount"]:this.la.Gc("PptModernSlideShowForwardPrerenderCount",2),["backwardPrerenderCount"]:this.la.Gc("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.$l,this.Mca);this.vOg=Date.now();this.ope=this.$l.init();this.ope.then(()=>{this.nOg=!1;this.dHg=new SlideShowCore.InputsAddon(this.$l,
this.K,x.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.$l,ua,this.Mca);new SlideShowCore.TransitionLoggerAddon(this.$l,ua,this.Mca);new SlideShowCore.PerfCheckerAddon(this.$l,ua,this.Mca);this.dPg=H.a.getInstance();this.iac=new SlideShowCore.SlideShowInkAddon(this.$l,this.Mca,this.K,()=>this.Aca.loadScript("slideshowink"),{["telemetryLogger"]:this.dPg});this.dHg.events.on("keydown",Ca=>{this.FGa(Ca)})});this.$l.events.on("slideLocationChanged",Object(E.a)(this,this.Q7c,
"onPositionChangedHandler"));this.$l.events.on("animationStateChanged",Object(E.a)(this,this.Q7c,"onPositionChangedHandler"));this.$l.events.on("slideDimensionsChanged",Object(E.a)(this,this.getCurrentSlideDimensions,"getCurrentSlideDimensions"));this.$l.events.on("exitFromEndOfShow",()=>{this.Q6c(!0)});this.$l.events.on("blankSlideStateChanged",Ca=>{this.rfk(Ca)});this.$l.events.on("slideshowError",Ca=>{this.P6c(Ca)})}else I.a.J(594583837,830,15,"GetSnappedDownloadLink returned a bad response: {0}",
Ua),this.NUa("BadDownloadUrlResponse")}catch(ua){I.a.J(594583835,830,15,"Failed to retreive document download URL: {0}",ua),this.NUa("BadDownloadUrlResponse")}return null}).catch(qa=>{I.a.J(594583833,830,15,"Failed to retreive document download URL: {0}",qa);this.NUa("BadDownloadUrlResponse")});this.S8=document.getElementById("slideshowBeginningFocusTrap");this.T8=document.getElementById("slideshowEndFocusTrap");this.S8||this.T8||(this.S8=document.createElement("div"),this.S8.id="slideshowBeginningFocusTrap",
this.S8.className="FocusTrap",this.S8.tabIndex=0,m.a.addHandler(this.S8,r.a.focus,Object(E.a)(this,this.odc,"onSlideShowContainerDivFocusHandler")),this.T8=document.createElement("div"),this.T8.id="slideshowEndFocusTrap",this.T8.className="FocusTrap",this.T8.tabIndex=0,m.a.addHandler(this.T8,r.a.focus,Object(E.a)(this,this.odc,"onSlideShowContainerDivFocusHandler")),Q.a("PresenterCoachTabFix")&&this.lta?(this.nf.insertBefore(this.S8,this.nf.firstChild),this.nf.insertBefore(this.T8,this.lta.nextSibling)):
(ra=document.getElementById("slideshow-toolbar"),this.nf.insertBefore(this.S8,this.sD),this.nf.insertBefore(this.T8,ra)))}}gHb(ra,Da,va,Fa,ka,qa,Ua,Ya,Va){this.$l&&!y.a.Xa(this.kW)?(va={},va.startFromTime=Va-window.performance.timing.navigationStart,va.SSCoreFrameStartTime=ma.E_b(),ya.a.instance.$Lk(),this.K.style.top="0",this.S8&&this.T8&&(this.S8.tabIndex=0,this.T8.tabIndex=0),ra={["slideId"]:{["sid"]:ra,["cid"]:0}},ra.slideIndex=Da-1,this.Or.o3b&&!this.Or.B7?this.rji(ra,va):this.I2f(ra,va)):(I.a.J(594583831,
830,15,"Failed to get download Url - Switching to Legacy SlideShow"),this.NUa("FailedToGetDownloadUrl"))}prev(){this.$l&&this.$l.prevStep("0_anim").then(()=>{})}next(){this.$l&&this.$l.nextStep("0_anim",3).then(()=>{})}show(){this.Zgb(!0)}aja(){return this.sD&&this.sD.style.visibility===Ja.a.Ty?!0:!1}ivb(){return!0}Zgb(ra){ya.a.instance.setVisibility(ra&&this.Cc.Ih);ra?(this.sD.style.visibility=Ja.a.Ty,$addHandler(window,"visibilitychange",Object(E.a)(this,this.UVa,"onVisibilityChangeHandler"))):
(this.sD.style.visibility=Ja.a.Qs,$removeHandler(window,"visibilitychange",Object(E.a)(this,this.UVa,"onVisibilityChangeHandler")))}exit(){this.Q6c(!1)}irb(){this.Q6c(!1)}transcribe(ra,Da,va,Fa,ka,qa,Ua){const Ya=!!this.Nb&&!!this.Nb.instance&&(this.Nb.instance.$Oa||this.Nb.instance.Cq);(this.Nb&&this.Nb.instance&&this.Nb.instance.Wq&&this.Nb.instance.hBa||Ya)&&!this.Nb.instance.Iqb()?I.a.J(591663328,830,50,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):(ya.a.instance.transcribe(ra,
Da,va,Fa,ka,qa,Ua),this.Cc.Ih&&this.$l.recordSessionStats({["metadata"]:"subtitles"}),this.KRd())}I2f(ra,Da){this.$l.clearNavigationState();const va={navigationType:"init"};va.startFromTime=Da.startFromTime;Da.waitedForInit=this.nOg;Da.startInitTime=this.vOg;Da.beforeInitPromise=ma.E_b();this.ope.then(()=>{Da.afterInitPromise=ma.E_b();va.bootMetrics=Da;if(0>ra.slideIndex)this.$l.gotoFirstSlide(!0,va).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",
new Sys.EventArgs)});else{const Fa={};Fa.actionContext=va;Fa.fSkipTransition=!0;this.$l.gotoSlide(ra,Fa).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)})}})}rji(ra,Da){const va=this.la.Gc("PptModernSlideShowCheckFullscreenCounter",10);let Fa=va;this.t$a=window.setInterval(()=>{Fa--;I.a.J(593086673,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",Fa);if(this.Or.B7||0>=Fa){window.clearInterval(this.t$a);
this.t$a=0;const ka=20*(va-Fa);Da.checkFullscreenMs=ka;I.a.J(593086671,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms.",ka);this.I2f(ra,Da)}},20)}KRd(){let ra=0,Da=100;this.Cc.Ih&&ya.a.instance.isVisible()&&("AboveSlide"===this.Cc.tv?(ra=15,Da=85):"BelowSlide"===this.Cc.tv&&(Da=85));const va=document.getElementById("LiveURLBarLayerHost");this.Xxb&&va?(this.K.style.top=String.format("calc({0}% + {1})",ra.toString(),"26px"),this.K.style.height=String.format("calc({0}% - {1})",
Da.toString(),"26px")):(this.K.style.top=ra.toString()+"%",this.K.style.height=Da.toString()+"%")}setMicrophoneState(ra){ya.a.instance.setMicrophoneState(ra)}HYa(ra,Da=""){this.Xxb=ra;ya.a.instance.uvh(ra,Da);this.KRd()}toggleTranscriberUIVisibility(ra){ya.a.instance.setVisibility(ra);ya.a.instance.Wzc();this.KRd()}omc(){this.va.raiseEvent("OnFullscreenClick",new Sys.EventArgs)}restoreFocus(){this.sD.style.visibility===Ja.a.Qs||this.f8d()||this.K.focus()}pausePresentation(){}getCurrentPosition(){if(this.$l){const ra=
this.$l.getSlideLocation();ra?this.va.raiseEvent("OnGetCurrentPosition",new K.a({["SlideId"]:ra.slideId.sid,["SlideIndex"]:ra.slideIndex})):I.a.J(592454490,830,15,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}getCurrentPositionWithTimeLines(){if(this.$l){const ra=this.$l.getSlideLocation();if(ra){const Da=this.$l.getAnimationState(!0),va=Da.timelineStates,Fa=[];for(let ka=0;ka<va.length;ka+=1)Fa.push({["TimeLineId"]:va[ka].timelineId,["Step"]:va[ka].step,["LastClickTime"]:va[ka].lastClickTime,
["StartTimeOffset"]:Da.startTimeOffset});this.va.raiseEvent("OnGetCurrentPosition",new K.a({["SlideId"]:ra.slideId.sid,["SlideIndex"]:ra.slideIndex,["TimeLineMappings"]:Fa}))}else I.a.J(592454488,830,15,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}getCurrentSlideDimensions(){if(this.$l&&this.sD.style.visibility!==Ja.a.Qs){const ra=document.getElementById(this.Nbb?"svg-canvas":"webgl-canvas");ra&&this.va.raiseEvent("OnGetCurrentSlideDimensions",new ca.a({["SlideHeight"]:ra.offsetHeight,
["SlideWidth"]:ra.offsetWidth,["SlideLeftBound"]:ra.offsetLeft,["SlideBottomBound"]:ra.offsetTop+ra.offsetHeight}))}}Cra(ra){this.$l&&this.$l.gotoSlide({["slideIndex"]:ra},{actionContext:{navigationType:"goto"},fSkipTransition:!1}).then(()=>{})}VNc(ra,Da){if(this.$l){const va={},Fa=[];let ka=0;for(let qa=0;qa<Da.length;qa+=1){const Ua={};Ua.timelineId=Da[qa].TimeLineId;Ua.step=Da[qa].Step;Ua.lastClickTime=Da[qa].LastClickTime;ka=Da[qa].StartTimeOffset;Fa.push(Ua)}va.timelineStates=Fa;va.startTimeOffset=
ka;Da={actionContext:{navigationType:"goto"}};Da.animationState=va;Da.fSkipTransition=!1;this.$l.gotoSlide({["slideIndex"]:ra},Da).then(()=>{})}}refreshPodSession(ra,Da){I.a.J(593827100,830,50,"RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",this.LN,ra);this.LN=ra;ra=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.LN);const va=new A.a(x.AFrameworkApplication.Be),Fa=Date.now();let ka=this,qa=this;Ka.b(va.ajc(ra)).then(Ua=>
{const Ya=Date.now();I.a.J(594384270,830,15,"SlideShowCoreFrame::Init: GetSnappedDownloadLink elapse:{0}",Ya-Fa);try{const Ca=JSON.parse(Ua);ka.kW=Ca.downloadUrl;if(ka.kW){Ua={};Ua.timeout=this.la.Gc("PptModernSlideShowGetItemsTimeoutMs",3E4);Ua.throwHttpErrors=!1;Ua.enableServerSpecificErrorCode=Q.a("SSCore.EnableServerSpecificErrorCode");var Va=void 0!==ka.la.Qla&&null!==ka.la.Qla?y.a.nV(ka.la.Qla).toLowerCase():"",ua;const Ea=(ua=new M,ua.DownloadUrl=ka.kW,ua.DocID=x.AFrameworkApplication.$g,ua);
try{const wb=ka.p_;wb.podsproxy&&(ua={},ua.settings=wb,window.PodsProxy.setupGlobals_PodsProxy(ua))}catch(wb){I.a.J(528605711,830,15,"Exception in passing settings to podsproxy:{0}",wb)}ka.d1c=new PodsProxy.PodsProxy(ka.la.j6a?ka.la.ULc:ka.la.podsWebServiceBase,Ea,Va,ka.Mca,ka.fbg(Da),Ua);Va={};Va.settings=ka.p_;Va.retryCount=this.la.Gc("GetItemsRetryCount",3);Va.retryOnCategories=this.la.Ia("GetItemsRetryCategories").split(";");ka.v1c=new SlideShowCore.DefaultResourceProviders(ka.d1c,ka.Mca,Va);
ka.$l.updateResourceProviders(ka.v1c).then(()=>{I.a.J(593827098,830,50,"Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",Fa,Ya,Date.now(),ka.aja())})}else{I.a.J(593827096,830,15,"GetSnappedDownloadLink returned a bad response: {0}",Ca);if(ka.aja()){let Ea=D.a.Fh(413);x.AFrameworkApplication.zo(Ea);G.Health.instance.recordQosError(D.a.y6(Ea),["SlideShowACE"],!1,!0,!0,!0,null);ka.$l&&ka.$l.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"});
ka.exit()}ka.NUa("FailedAfterRehydration_BadDownloadUrlResponse")}}catch(Ca){I.a.J(593827094,830,15,"Failed to retreive document download URL: {0}",Ca),ka.aja()&&(Va=D.a.Fh(413),x.AFrameworkApplication.zo(Va),G.Health.instance.recordQosError(D.a.y6(Va),["SlideShowACE"],!1,!0,!0,!0,null),ka.$l&&ka.$l.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),ka.exit()),ka.NUa("FailedAfterRehydration_DownloadUrlException")}return null}).catch(Ua=>{I.a.J(593827092,830,15,"Failed to retreive document download URL: {0}",
Ua);qa.aja()&&qa.exit();qa.NUa("FailedAfterRehydration_NoDownloadUrl")})}setVisibility(ra){this.Zgb(ra)}L4(ra){this.sD.style.cursor=ra?"default":"none";ya.a.instance.L4(ra)}setOsfLocalStorage(){}Jec(ra){if(this.iac)this.iac.onInkManagerActivity(ra)}FGa(ra){this.bjc(ra)}bjc(ra){this.va.raiseEvent("OnSpecialKey",new ia.a({["Key"]:ra.keyCode,["ShiftKey"]:ra.shiftKey}))}Sed(){}odc(){this.sD&&this.restoreFocus()}fbg(ra){const Da=new Map;Da.set("X-UserSessionId",this.AAb);Da.set("X-WacNoAuth","1");Da.set("X-WacCluster",
ra);Da.set("Client","Unified App");this.la.n3i&&Da.set("UseDocCache","True");return Da}Q6c(ra=!1){this.t$a&&(I.a.J(593086665,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",this.t$a),window.clearInterval(this.t$a),this.t$a=0);this.iac&&this.iac.resetInkCanvas();this.S8&&this.T8&&(this.S8.tabIndex=-1,this.T8.tabIndex=-1);if(this.$l){const Da=this.$l.getSlideLocation();this.$l.endSession(ma.E_b());Da?this.va.raiseEvent("OnExit",new W.a({["SlideId"]:Da.slideId.sid,
["IsBeforeReady"]:!1,["SlideIndex"]:Da.slideIndex,["IsFromEndOfSlideshow"]:ra})):I.a.J(592213581,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null")}this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";this.Zgb(!1);ya.a.instance.WMe()}Q7c(){if(this.$l&&this.sD.style.visibility!==Ja.a.Qs){const ra=this.$l.getSlideLocation();if(ra){const Da=this.$l.getAnimationState(!0),va=Da.timelineStates,Fa=[];for(let ka=0;ka<va.length;ka+=1)Fa.push({["TimeLineId"]:va[ka].timelineId,
["Step"]:va[ka].step,["LastClickTime"]:va[ka].lastClickTime,["StartTimeOffset"]:Da.startTimeOffset});this.va.raiseEvent("OnPositionChangeEventId",new ea.a({["SlideId"]:ra.slideId.sid,["SlideIndex"]:ra.slideIndex,["TimeLineMappings"]:Fa}))}else I.a.J(592213579,830,50,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}rfk(ra){if(this.$l&&this.sD.style.visibility!==Ja.a.Qs)switch(ra){case "Hidden":this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty);break;case "EndOfShow":this.va.raiseEvent("OnEnterEndOfShowEventId",
Sys.EventArgs.Empty);break;default:I.a.J(594134796,830,50,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",ra)}}P6c(ra){if(this.$l){I.a.J(593828035,830,15,"SlideshowCoreFrame.OnErrorHandler {0}",ra);let Da;ra.startsWith("Server")&&(ra="GetItemsRequestFailed");switch(ra){case "GetItemsFailedDownloadFile":I.a.J(593789251,830,50,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",this.LN);this.va.raiseEvent("OnPodSessionExpired",new P.a({["Code"]:5341407,["Reason"]:"Failed To Download File",
["PodSessionId"]:this.LN}));return;case "LoadFailed":Da=407;break;case "GetItemsFailedInvalidResponse":Da=408;break;case "GetItemsRequestFailed":Da=409;break;case "GetItemsTimeout":Da=411;break;case "EnsureSlideFailed":Da=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":Da=414;break;default:Da=359}0!==Da&&(this.aja()?(ra=D.a.Fh(Da),x.AFrameworkApplication.zo(ra),G.Health.instance.recordQosError(D.a.y6(ra),["SlideShowACE"],!1,!0,!0,!0,null),this.$l.recordSessionStats({["errorName"]:D.a.y6(ra)}),
this.Q6c(!1)):I.a.J(593609988,830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",ra),this.NUa("SlideShowError"))}}y8c(ra){I.a.J(594134794,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.$l&&this.sD.style.visibility!==Ja.a.Qs&&this.va.raiseEvent("OnTranscriberStartedEventId",new C.a({["TranscriberSessionId"]:ra}));this.Cc.Kqb=!0}chc(){I.a.J(593798990,830,50,"SlideshowCoreFrame.RecordQosErrorHandler")}UVa(){I.a.J(594383514,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");
window.document.hidden&&this.va.raiseEvent("OnVisibilityChangeEventId",new oa.a(!1))}f8d(){return!!this.Nb&&!!this.Nb.instance&&this.Nb.instance.G0f}Fmb(ra){this.va.addHandler("OnSlideshowReady",ra)}Fhc(ra){this.va.removeHandler("OnSlideshowReady",ra)}xSb(ra){this.va.addHandler("OnBrowserEvent",ra)}xcd(ra){this.va.removeHandler("OnBrowserEvent",ra)}Azc(ra){this.va.addHandler("OnFullscreenClick",ra)}tDe(ra){this.va.removeHandler("OnFullscreenClick",ra)}ySb(ra){this.va.addHandler("OnSlideshowContextMenu",
ra)}ycd(ra){this.va.removeHandler("OnSlideshowContextMenu",ra)}xY(ra){this.va.addHandler("OnExit",ra)}R_(ra){this.va.removeHandler("OnExit",ra)}zzc(ra){this.va.addHandler("OnSlideshowError",ra)}sDe(ra){this.va.removeHandler("OnSlideshowError",ra)}Emb(ra){this.va.addHandler("OnGetCurrentSlideDimensions",ra)}Ehc(ra){this.va.removeHandler("OnGetCurrentSlideDimensions",ra)}C2a(ra){this.va.addHandler("OnGetCurrentPosition",ra)}GWa(ra){this.va.removeHandler("OnGetCurrentPosition",ra)}Gmb(ra){this.va.addHandler("OnSpecialKey",
ra)}Ghc(ra){this.va.removeHandler("OnSpecialKey",ra)}Jzc(ra){this.va.addHandler("OnVisibilityChangeEventId",ra)}Ecd(ra){this.va.removeHandler("OnVisibilityChangeEventId",ra)}BSb(ra){this.va.addHandler("OnPodSessionExpired",ra)}Bcd(ra){this.va.removeHandler("OnPodSessionExpired",ra)}Czc(ra){this.va.addHandler("OnLogEndOfTranscriptionSession",ra)}wDe(ra){this.va.removeHandler("OnLogEndOfTranscriptionSession",ra)}rpa(ra){this.va.addHandler("OnPositionChangeEventId",ra)}JWa(ra){this.va.removeHandler("OnPositionChangeEventId",
ra)}Bzc(ra){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",ra)}vDe(ra){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",ra)}zSb(ra){this.va.addHandler("OnEnterEndOfShowEventId",ra)}zcd(ra){this.va.removeHandler("OnEnterEndOfShowEventId",ra)}ASb(ra){this.va.addHandler("OnLeaveEndOfShowEventId",ra)}Acd(ra){this.va.removeHandler("OnLeaveEndOfShowEventId",ra)}Fzc(ra){this.va.addHandler("OnSubtitleUpdatedEventId",ra)}yDe(ra){this.va.removeHandler("OnSubtitleUpdatedEventId",ra)}Hzc(ra){this.va.addHandler("OnTranscriberStartedEventId",
ra)}ADe(ra){this.va.removeHandler("OnTranscriberStartedEventId",ra)}Lzc(ra){this.va.addHandler("RecordQosErrorEventId",ra)}CDe(ra){this.va.addHandler("RecordQosErrorEventId",ra)}mjk(ra){this.va.raiseEvent("OnBrowserEvent",new N.a({["ClientX"]:ra.clientX,["ClientY"]:ra.clientY}))}Dcb(ra){this.va.raiseEvent("OnSlideshowContextMenu",new da.a({["ClientX"]:ra.clientPoint.x,["ClientY"]:ra.clientPoint.y}));return!0}I8a(){return this.la.pptEditorVoiceUXEnabled&&!!this.gk&&!!this.gk.instance}static E_b(){return Math.round(window.performance.now())}}
Object(J.a)(ma,"SlideShowCoreFrame",null,[525])},986:function(J,V,d){J=d(0);var h=d(390),e=d(654);class m extends e.a{constructor(H,G=null,E=null){super("DeferredContentType");this.title=this.isDeferred=this.messageText=null;this.title=G;this.messageText=H;this.isDeferred=E}}Object(J.a)(m,"DeferredContentProps",e.a,[]);var r=d(26),v=d(904),A=d(905);const x=(H,G)=>Object.assign(new v.a,{target:".EditingRibbonPanel",content:H,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new A.a,
{directionalHint:6,gapSpace:4,isBeakVisible:!1,preventDismissOnScroll:!0,onDismiss:G,preventDismissOnResize:!0})});var y=d(46);d.d(V,"a",function(){return u});class u{constructor(){this.JS=new m(ResourceStrings.l_DeferredContentDownloadACopyWaitToastMessage,ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle,!0)}qFi(H,G,E,I){I=Object.assign(new h.a,{onShow:()=>{E.SJ(y.a.Jfb)}});G=H.callout(G);return I=H.addNotification(G,I)}MKk(H,G){H.removeNotification(G);r.a.J(523871964,843,10,"DownloadACopy Toast can not be removed!");
return G}Gxi(H){return x(this.JS,()=>{H.ap(y.a.Jfb)})}}Object(J.a)(u,"DownloadACopyDeferred",null,[618])},995:function(J,V,d){J=d(0);var h=d(13),e=d(1153),m=d(25),r=d(66),v=d(79);class A{constructor(y,u,H,G=null){this.origin=y;this.data=u;this.source=H;this.nc=G}}Object(J.a)(A,"MessageEventArgs",null,[]);d.d(V,"a",function(){return x});class x{constructor(y,u){this.DEd=null;this.TWh=y;this.Md=u;this.Ttc=null}get Sgb(){return this.TWh.value}get taskManager(){return this.Md.value}H9h(y){this.Ttc=y;
this.DEd=Object(h.a)(this,this.zuk,"postMessageEventHandler");this.Sgb.addHandler(r.a.message,this.DEd,null)}LDi(){this.Ttc=null;this.Sgb.removeHandler(r.a.message,this.DEd)}KQc(y,u){const H=new v.a(0,1,1,()=>{y(u)},7);this.taskManager.Hb(H)}Syj(y,u){const H=new v.a(0,1,1,()=>{y(u)},7);this.taskManager.Hb(H)}zuk(y){return this.Ttc?this.Ttc(new A(y.origin,y.data,y.source,y.nc)):!1}static get instance(){return x.I5a()}static I5a(){return new x(new e.a(()=>m.AFrameworkApplication.Sgb),new e.a(()=>m.AFrameworkApplication.ve))}}
Object(J.a)(x,"MessageEventHandler",null,[673])},998:function(J,V,d){J=d(0);var h=d(374),e=d(105),m=d(267),r=d(13),v=d(1154),A=d(33);class x{constructor(){this.Value=this.Id=this.LanguageId=null}}Object(J.a)(x,"CritiqueTypeOption",null,[]);var y=d(2);d.d(V,"a",function(){return u});class u{constructor(H,G,E){this.zBd={};this.Vk=null;this.Zrf=H;this.BSh=G;this.CSh=E;this.x0a=y.Task.ot({})}init(){this.x0a=this.Zrf.F1d(this.BSh,["ProofingSettingLanguageList","ProofingSettings"]).CWRCo(Object(r.a)(this,
this.Tik,"onLoadSettingsTaskFinished"),8)}qll(H){const G={};if(!(H&&"ProofingSettingLanguageList"in H))return G;const E=Array.isArray(A.a(H.ProofingSettingLanguageList))?A.a(H.ProofingSettingLanguageList):null;for(const I of E)"ProofingSettings"+I in H&&(G[I]=Object(v.a)(Object,A.a(H["ProofingSettings"+I])));return G}rll(H){const G={},E=[];for(let D in H){var I=D,Q=H[D];Q&&(E.push(I),G["ProofingSettings"+I]=A.c(Q))}G.ProofingSettingLanguageList=A.c(E);return G}saveSettings(H){this.x0a=y.Task.ot(H);
this.Vk=null;try{const G=this.rll(H);this.Zrf.tlh(this.CSh,G).continueWith(Object(r.a)(this,this.$kk,"onSaveSettingsTaskFinished"),8)}catch(G){h.ULS.sendTraceTag(35401881,375,10,"Save settings failed with exception {0}",G.toString())}}UXd(){if(!this.Vk){if(6!==this.x0a.status)return[];try{var H=this.x0a.result;let Q;if(e.a.isEmpty(this.zBd))Q=H;else if(e.a.isEmpty(H))Q=this.zBd;else{Q={};var G=this.zBd;for(let D in G)Q[D]=e.a.Ljc(G[D]);Q=u.merge(Q,H)}this.Vk=[];for(let D in Q){var E=Q[D];const Y=
m.a.re(parseInt(D));if(!Y)continue;const M=Y.name;G=E;for(let N in G){H=N;var I=G[N];const W=Object.assign(new x,{LanguageId:M,Id:H,Value:I.toString()});this.Vk.push(W)}}}catch(Q){h.ULS.sendTraceTag(36542301,375,10,"GetCritiqueTypeOptions failed with exception: {0}",Q.toString())}}return this.Vk}QEi(H,G){const E=this.x0a.result;if(E)try{let I=E[H];I||(I={});I[G]=!1;E[H]=I;this.saveSettings(E)}catch(I){h.ULS.sendTraceTag(36750082,375,10,"DisableCritique failed with exception: {0}",I.toString())}}Tik(H){if(H.Sl)return h.ULS.sendTraceTag(34964619,
375,10,"Load setting failed with exception {0}",H.Ti),null;if(6===H.status)try{return this.qll(H.result)}catch(G){h.ULS.sendTraceTag(34964620,375,10,"Parse settings with exception {0}",G.toString())}return null}$kk(H){H.Sl&&h.ULS.sendTraceTag(34964621,375,10,"Save setting failed with exception {0}",H.Ti)}static merge(H,G){H=H||{};if(G)for(let Q in G){var E=Q,I=G[Q];H[E]=H[E]||{};for(let D in I)H[E][D]=I[D]}return H}}Object(J.a)(u,"CritiqueTypeSettings",null,[805])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.ext.js.map