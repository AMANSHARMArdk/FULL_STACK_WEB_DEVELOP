'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1096:function(J,V,d){J=d(0);var h=d(374),e=d(13),m=d(228),r=d(229);class v{static bYd(Z,pa,ya){return v.cYd(Z,pa,ya,!0)}static cYd(Z,pa,ya,Ja){const Ka=document.createElementNS(v.Hhb,"svg");Ka.setAttribute("viewBox",String.format(v.aQd,v.Jnc,v.Inc));Ka.appendChild(v.Z0d(Z,pa,ya,Ja));return Ka}static Z0d(Z,pa,ya,Ja){const Ka=v.Jnc/Z,ma=pa/2*Ka,ra=v.Inc/2;let Da=0;Ja&&(Da=(Z-3*pa-4*ya)*Ka/2);Z=document.createElementNS(v.Hhb,
"g");Sys.UI.DomElement.addCssClass(Z,v.$Pd);for(Ja=1;3>=Ja;Ja++)Z.appendChild(v.zXd(Ja,ma,Da+(Ja*(pa+ya)-pa/2)*Ka,ra));return Z}static zXd(Z,pa,ya,Ja){const Ka=document.createElementNS(v.Hhb,"circle");Sys.UI.DomElement.addCssClass(Ka,String.format("{0}-{1}",v.PLd,Z));Ka.setAttribute("cx",String.format("{0}",ya));Ka.setAttribute("cy",String.format("{0}",Ja));Ka.setAttribute("r",String.format("{0}",pa));return Ka}}v.Hhb="http://www.w3.org/2000/svg";v.$Pd="prDancingDots";v.PLd="prAnimateCircle";v.aQd=
"0 0 {0} {1}";v.Inc=40;v.Jnc=120;Object(J.a)(v,"ModernPresenceTooltipDancingDots",null,[]);var A=d(25),x=d(169),y=d(72),u=d(66),H=d(132),G=d(194),E=d(96),I=d(45),Q=d(2);class D extends m.a{constructor(Z,pa){super(Z);this.DRb=this.hR=this.VZa=this.mM=this.hM=this.Fo=this.mn=null;this.xH=pa.get(8,!1);this.fR=pa.get(6,0);this.kEd=pa.get(15,!1);this.Ic=pa;this.$Lb=0;this.element=Z;this.element.className=D.q5a;this.ks=document.createElement("span");this.element.appendChild(this.ks);this.qrd=v.bYd(pa.get(6,
0),4,2);this.VI(pa);this._state=5}NU(Z){this.addHandler(r.a.No,Z)}P_(Z){this.removeHandler(r.a.No,Z)}get user(){return this.DRb}get state(){return this._state}dispose(){this.element&&(this.mn.zb(u.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.mn.zb(u.a.doubleClick,this.element,Object(e.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")),this.Fo.zb(u.a.pointerDown,this.element,Object(e.a)(this,this.ava,"onPointerDown")),this.Fo.zb(u.a.pointerOut,this.element,Object(e.a)(this,
this.Oy,"onPointerOut")),this.Fo.zb(u.a.pointerOver,this.element,Object(e.a)(this,this.iC,"onPointerOver")),this.hM.zb(this.element,Object(e.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}VI(Z){this.mn=Z.get(10);this.mn.pb(u.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.mn.pb(u.a.doubleClick,this.element,Object(e.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior"));this.Fo=Z.get(9);this.Fo.pb(u.a.pointerOver,this.element,Object(e.a)(this,
this.iC,"onPointerOver"));this.Fo.pb(u.a.pointerOut,this.element,Object(e.a)(this,this.Oy,"onPointerOut"));this.Fo.pb(u.a.pointerDown,this.element,Object(e.a)(this,this.ava,"onPointerDown"));this.hM=Z.get(13);this.hM.pb(this.element,Object(e.a)(this,this.ax,"stopPropagationAndPreventDefaultBehavior"))}hide(Z=null,pa=0,ya=0){this.kEd&&Z?this.gLe(Z,pa,ya):(3===this.state&&this.yhc(),this.visible=!1,this._state=5)}gLe(Z,pa,ya=0){this.show(Z,pa,15,4,void 0,ya)}qkc(Z,pa,ya,Ja=!1,Ka=!1,ma=!1,ra=0){this.show(Z,
pa,ya+20,Ja?2:Ka?1:0,ma,ra)}PKe(Z,pa,ya,Ja=!1,Ka=0){this.show(Z,pa,ya+20,3,Ja,Ka)}show(Z,pa,ya,Ja=3,Ka=!1,ma=0){!Z||Ja===this.state&&this.y3d(pa,ya)||(this.nFd(Ja,Ka,ma),this.kz(Z,Ja,ma),this._state=Ja,4===ma||0===ma&&!this.xH?this.element.style.left=pa+"px":this.element.style.right=pa+"px",this.element.style.top=ya+"px",this.visible=!0)}kz(Z,pa,ya){this.DRb=Z;E.a.Vt(this.ks);G.a.XMf(this.ks);this.ks.id="fly_"+Z.clientId;this.ks.style.backgroundColor=Z.color;4!==pa?(this.ks.style.height=this.fR+"px",
this.ks.style.lineHeight=this.fR+"px",G.a.vX(this.ks,"border-radius",this.fR+"px")):4===ya||0===ya&&!this.xH?this.ks.style.left="0px":this.ks.style.right="0px";2!==pa&&(4===pa?E.a.Zw(this.ks,""):1===pa?this.ks.appendChild(this.qrd):(this.ks.setAttribute("dir","auto"),ya=I.a.lZd(Z.userName,!1),(!Z.isAnonymous||A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&ya||0!==pa?(Z=Z.userName,0===pa&&(Z=ya,G.a.vX(this.ks,"text-align","center")),
E.a.Zw(this.ks,Z)):(this.mM||(this.mM=this.hOd()),this.ks.appendChild(this.mM),G.a.vX(this.ks,"text-align","start"))))}onClick(Z){if(0===this.state)return this.raiseEvent(r.a.No,new r.a(1,Z)),!0;3===this.state&&h.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}Oy(Z){3===this.state&&this.raiseEvent(r.a.No,new r.a(3,Z));return!1}iC(Z){3!==Z.Qf&&this.raiseEvent(r.a.No,new r.a(2,Z));return!1}ava(Z){if(3!==Z.Qf)return!0;this.raiseEvent(r.a.No,new r.a(4,Z));return!1}hOd(){const Z=
document.createElement("img");Z.src=x.a.bK("doughperson_white_glyph.svg");Z.setAttribute("Unselectable","on");H.a.mO(Z,H.a.ff,H.a.eP);return y.createClusteredImageFromClusterWithImageClass(this.fR,this.fR,null,null,D.KVd,"",!1,"",this.element.ownerDocument,Z)}nFd(Z,pa=!1,ya=0){if(!this.Hia(this.state)||!this.Hia(Z))switch(Sys.UI.DomElement.removeCssClass(this.element,this.VZa),this.state){case 4:3===Z?this.vM(D.r5a,D.mZb):this.Hia(Z)&&this.vM(D.p5a,D.mZb);break;case 3:4===Z?this.vM(D.t5a,D.lZb):this.Hia(Z)&&
(pa&&this.yhc(),this.vM(D.p5a,D.lZb,pa?D.JVd:""));break;case 0:case 1:case 2:4===Z?this.vM(D.t5a,D.s5a):3===Z&&(pa&&this.zFd(),this.vM(D.r5a,D.s5a,pa?D.nZb:"",3===ya?D.MVd:D.LVd));break;default:4===Z?this.vM(D.t5a):3===Z?this.vM(D.r5a):this.Hia(Z)&&this.vM(D.p5a)}}vM(...Z){this.VZa=Z.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.VZa)}zFd(){this.$Lb=window.setTimeout(()=>{this.element&&(this.hR=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.hR),this.element.style.zIndex=
"2",this.hR.style.zIndex="1")},300)}yhc(){window.clearTimeout(this.$Lb);this.hR&&(Sys.UI.DomElement.removeCssClass(this.hR,D.s5a+" "+D.nZb),Sys.UI.DomElement.addCssClass(this.hR,D.IVd),Q.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.hR.parentNode&&this.element.parentNode.removeChild(this.hR)}),G.a.lEb(this.element,"z-index"))}Hia(Z){return 0===Z||1===Z||2===Z}y3d(Z,pa){const ya=G.a.WG(this.element.style.top);return G.a.WG(this.element.style.left)===Z&&ya===pa}qeb(Z){3===
Z&&G.a.iP(this.element,"left")?(Z=G.a.WG(this.element.style.left),G.a.lEb(this.element,"left"),this.element.style.right=-1*Z+"px"):4===Z&&G.a.iP(this.element,"right")&&(Z=G.a.WG(this.element.style.right),G.a.lEb(this.element,"right"),this.element.style.left=-1*Z+"px")}}D.q5a="prModernFlyout UIFont";D.t5a="flyoutIdle";D.r5a="flyoutExpanded";D.p5a="flyoutCollapsed";D.mZb="flyoutFromIdle";D.lZb="flyoutFromExpanded";D.s5a="flyoutFromCollapsed";D.nZb="flyoutStacked";D.JVd="flyoutFromStacked";D.IVd="flyoutFadeOut";
D.KVd="cui-img-cont-float cui-img-20by20";D.LVd="flyoutLtrDir";D.MVd="flyoutRtlDir";Object(J.a)(D,"ModernPresenceTooltipFlyoutControl",m.a,[]);class Y{constructor(Z,pa,ya=2,Ja=4){this.offsetTop=Z;this.offsetLeft=pa;this.Fnc=ya;this.I1b=Ja}}Object(J.a)(Y,"FlyoutsPositioningInfo",null,[]);var M=d(63);class N{constructor(Z=!1,pa=!1){this.Oi=Z;this.B_a=pa}tZd(Z,pa,ya,Ja,Ka,ma,ra){const Da=ra.y,va=ra.height;var Fa=this.rXd(ma);const ka=Fa+pa;Ka=Z*ya+(Z-1)*Ka;ya=null;1===Z||this.MKd(Fa,Ka,Da,va)?Z=new Y(0,
0,2):(Z=this.wVd(ka,Ka,Da,va),Z.offsetTop-=Fa);this.B_a?ya=new Y(0,0,void 0,this.Oi?4:3):(ma=this.qXd(ma,ra),Fa=Math.max(0,ra.x),ra=ra.width,pa=ma+pa,this.NKd(ma,Ja,Fa,ra)?ya=new Y(0,0,void 0,this.Oi?3:4):this.OKd(pa,Ja,Fa)&&(ya=new Y(0,0,void 0,this.Oi?4:3)),ya||(ya=this.vVd(ma,pa,Fa,ra)));return new Y(Z.offsetTop,ya.offsetLeft,Z.Fnc,ya.I1b)}rXd(Z){return M.a.uKc(Z)}qXd(Z,pa){return this.Oi?pa.width-M.a.d6f(Z):M.a.tKc(Z)}MKd(Z,pa,ya,Ja){return Z+pa<=ya+Ja}wVd(Z,pa,ya,Ja){let Ka=1,ma=Math.max(ya,
Z-pa);pa>Z-ya&&(Ka=2,ma=pa<Ja?Ja-pa:ya);return new Y(ma,0,Ka)}NKd(Z,pa,ya,Ja){return Z+pa<=ya+Ja}OKd(Z,pa,ya){return pa<=Z-ya}vVd(Z,pa,ya,Ja){Ja-pa>=Z-ya?Z=4:(pa=Z,Z=3);return new Y(0,pa,void 0,Z)}}Object(J.a)(N,"ModernPresenceTooltipPositioner",null,[]);class W{constructor(Z,pa,ya,Ja,Ka,ma,ra){this.yv=Z;this._parent=pa;this.LKb=ya;this.Opd=Ja;this.vtd=Ka;this.e6=ma;this.xH=ra;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(Z,
pa){if(3!==Z)if(5!==Z&&this.yv&&this.yv.length){if(4===Z){var ya=this.vtd;var Ja=(this.e6-ya)/2;this.element.style.height=this.e6+"px";this.element.style.width=this.e6+"px";Z=G.a.WG(this.yv[0].element.style.top);pa=G.a.WG(this.xH?this.yv[0].element.style.right:this.yv[0].element.style.left)}else ya=this.LKb,Ja=(this.e6-ya)/2,this.element.style.height=this.e6+"px",this.element.style.width=this.GXd()+2*Ja+"px",Z=G.a.WG(this.yv[this.yv.length-1].element.style.top),pa=this.CKd(this.yv[this.yv.length-
1].element,ya,pa);G.a.vX(this.element,"border-radius",this.e6+"px");this.element.style.top=Z-Ja-ya+"px";this.xH?this.element.style.right=pa-Ja+"px":this.element.style.left=pa-Ja+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}CKd(Z,pa,ya){return this.xH&&!ya?G.a.WG(Z.style.right):this.xH||ya?this.xH&&ya?-G.a.WG(Z.style.left)-pa:-G.a.WG(Z.style.right)-pa:G.a.WG(Z.style.left)}GXd(){return this.yv&&
this.yv.length?this.LKb+Math.min(this.yv.length-1,2)*this.Opd:0}}Object(J.a)(W,"ModernPresenceTooltipTarget",null,[]);var K=d(76),ca=d(115),P=d(197);class ea extends m.a{constructor(Z,pa,ya){super(Z);this.Y5=this.qH=this.cNb=this.gY=!1;this.Af=[];this.lya={};this.Ic=ya;this.Oi=ya.get(8,!1);this.OMb=ya.get(15,!1);this.yqd=ya.get(12,0);this.LR=ya.get(6,0);this.E1a=pa;this.FRb=ya.get(16);this.B_a=ya.get(17,!1);this.xtd=ya.get(19,!1);this.szd=ya.get(20,!1);this.rya=0;this.lzd=new N(this.Oi,this.B_a);
this.Yea=this.e_b();this.W0a=!1;this.eM=[];this.Afa=[];this.element.id=ea.E5a();this.element.className=m.a.rpb("prControl",this.Oi);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Oi;this.dfb(pa);this.lE=this.createElement("div");this.lE.className="prFlyoutContainer";this.element.appendChild(this.lE);this.yv=[];this.nR=new W(this.us,this.element,this.LR,4,6,32,this.Oi);this.Fo=ya.get(9);this.Fo.pb(u.a.pointerDown,this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"));this.Fo.pb(u.a.pointerOver,
this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"));this.Fo.pb(u.a.pointerOut,this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"))}get xdb(){return P.a.clone(this.Af)}get us(){return this.yv}get defaultZIndex(){return this.yqd}get UM(){return this.us?this.us.length:0}get dU(){return 0<this.UM?this.us[0].state:5}get a8a(){return 3===this.dU&&!this.gY}NU(Z){this.addHandler(r.a.No,Z)}P_(Z){this.removeHandler(r.a.No,Z)}dispose(){if(this.a8a)this.W0a=!0;else{if(this.us)for(const Z of this.us)Z.P_(Object(e.a)(this,
this.pF,"onInteractivityChanged")),ca.a.Xw(Z);this.yv=null;this.Fo.zb(u.a.pointerDown,this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"));this.Fo.zb(u.a.pointerOver,this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"));this.Fo.zb(u.a.pointerOut,this.nR.element,Object(e.a)(this,this.y9,"onHitTarget"));super.dispose()}}tea(){this.KY();this.visible=!0}Vfb(){this.visible=!0;this.xYb();this.gY=!0}vwa(){this.Vfb()}hide(){this.zhc();this.aN();this.nR.update(this.dU,this.Y5)}kz(Z){const pa=this.dU,
ya=this.gY;Z.clientId||(Z.clientId=(ea.Ffa++).toString());if(Z.clientId in this.lya){var Ja=this.cS(Z.clientId);if(0<=Ja){Ja=this.Af[Ja];if(Ja.color===Z.color&&Ja.userName===Z.userName)return;this.BL(Z.clientId)}}this.hide();Ja=new D(this.createElement("div"),this.Ic);Ja.NU(Object(e.a)(this,this.pF,"onInteractivityChanged"));this.lE.insertBefore(Ja.element,this.lE.firstChild);this.lya[Z.clientId]=Ja;Array.add(this.Af,Z);Array.add(this.us,Ja);this.knc(pa,ya);this.visible=!0}BL(Z){if(this.a8a)Array.add(this.Afa,
Z);else{var pa=this.dU,ya=this.gY;this.hide();this.kma(Z);this.knc(pa,ya)}}ocb(Z){const pa=this.cS(Z);if(!(0>=pa)){var ya=this.Af[pa];Z=this.lya[Z];Array.removeAt(this.Af,pa);Array.insert(this.Af,0,ya);Array.removeAt(this.us,pa);Array.insert(this.us,0,Z);this.lE.removeChild(Z.element);this.lE.appendChild(Z.element);this.KY()}}knc(Z,pa){0>=this.Af.length?this.hide():3===Z&&pa?this.Vfb():this.tea()}Afb(Z,pa){pa?this.gFd(Z):this.shc(Z)}qYb(Z){if(this.a8a&&this.xtd)return!1;Z=ea.r6a(Z);if(this.lE!==Z&&
E.a.asa(this.lE,Z))return!0;for(const pa of this.us)if(E.a.asa(pa.element,Z))return!0;return!1}position(Z,pa){this.element.style.top=pa+"px";this.element.style.left=Z+"px"}KY(Z=!1){if(!Z||this.qH){this.cNb&&this.vjc(!0);var pa=Math.min(3,this.UM)-1;Z=0;var ya=1,Ja=0;this.Y5&&(Z=this.Yea,ya=-1,Ja=-this.LR);for(let Ka=this.UM-1;Ka>pa;Ka--)this.us[Ka].qkc(this.Af[Ka],-4*pa*ya+Ja,0,!0,!1,!0,Z);for(;0<=pa;pa--)this.us[pa].qkc(this.Af[pa],-4*pa*ya+Ja,0,0<pa,Array.contains(this.eM,this.Af[pa].clientId),
pa!==this.rya,Z);this.rya=0;this.nR.update(0,this.Y5);this.zIndex=this.defaultZIndex;this.gY=!1;this.zhc(0);this.W0a&&this.dispose()}}xYb(){this.cNb&&this.vjc(!1);this.zIndex=this.defaultZIndex+1;let Z,pa,ya;({offsetX:pa,offsetY:Z,H1b:ya}=this.YHe());for(let Ja=0;Ja<this.UM;Ja++)this.us[Ja].PKe(this.Af[Ja],pa,Z+(this.LR+2)*Ja,Ja!==this.rya,ya)}aN(){let Z=0,pa=0;this.Y5&&(Z=this.Yea,pa=-6);for(let ya=0;ya<this.UM;ya++)this.us[ya].hide(this.Af[ya],pa,Z);this.zIndex=this.defaultZIndex;this.visible=this.gY=
!1;this.W0a&&this.dispose()}I3a(Z=0){Z?(this.qH=!0,Q.Task.delay(Z).continueWith(()=>{this.OMb?this.Z3d():this.KY(!0);this.qH=!1})):this.OMb?this.hide():this.KY()}Z3d(){this.qH&&this.hide()}pJd(){if(A.AFrameworkApplication.Ba&&A.AFrameworkApplication.Ba.jb.J7&&K.c()){const Z=appChrome.selectors.getShyState();return Z.isActive&&0!==Z.state}return!1}pF(Z,pa){Z=this.dU;this.pJd()||2!==pa.type&&(4!==pa.type||3===Z)?4===pa.type&&3===Z?(this.qH&&(this.qH=!1),this.I3a()):3!==pa.type||3!==Z||this.gY||(1<this.UM?
(this.qH=!0,Q.Task.delay(250).continueWith(()=>{this.KY(!0);this.qH=!1})):this.I3a()):(this.qH&&(this.qH=!1),3!==Z&&(this.xYb(),3===pa.Ri.Qf&&this.I3a(2E3)));this.raiseEvent(r.a.No,pa)}y9(Z){3===Z.Qf?this.pF(this,new r.a(4,Z)):Z.eventName===u.a.pointerOver?this.pF(this,new r.a(2,Z)):Z.eventName===u.a.pointerOut&&this.pF(this,new r.a(3,Z));return!1}dfb(Z){this.element.style.width=Z+"px";this.element.style.height=this.LR+"px"}kma(Z){this.shc(Z);Z=this.cS(Z);if(!(0>Z)){var pa=this.Af[Z];Array.removeAt(this.Af,
Z);delete this.lya[pa.clientId];pa=this.us[Z];this.lE.removeChild(pa.element);this.Ic.get(18,!1)&&pa.P_(Object(e.a)(this,this.pF,"onInteractivityChanged"));Array.removeAt(this.us,Z);pa.dispose()}}zhc(Z=5){if(this.Afa.length){this.visible&&this.aN();for(let pa=0;pa<this.Afa.length;pa++)this.kma(this.Afa[pa]);Array.clear(this.Afa);0>=this.Af.length||5===Z?this.hide():0===Z&&this.tea()}}cS(Z){for(let pa=0;pa<this.Af.length;pa++)if(this.Af[pa].clientId===Z)return pa;return-1}gFd(Z){if(-1===this.cS(Z))h.ULS.sendTraceTag(41706451,
302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.eM,Z)){if(this.Af[0].clientId===Z)return;Array.remove(this.eM,Z)}Array.add(this.eM,Z);this.ocb(Z);1!==this.dU&&this.KY()}}shc(Z){-1===this.cS(Z)?h.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.eM,Z)&&(Array.remove(this.eM,Z),this.Af[0].clientId===Z&&0<this.eM.length&&this.ocb(this.eM[this.eM.length-1]),this.Af[0].clientId===Z&&1===this.dU&&
this.KY())}vjc(Z){Z?Sys.UI.DomElement.addCssClass(this.lE,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.lE,"prBackgroundSelection")}YHe(){let Z,pa;pa=Z=0;var ya=this.Yea;if(this.FRb){const Ja=this.FRb(this);if(!Ja)return{offsetX:Z,offsetY:pa,H1b:ya};const Ka=4===this.dU;ya=this.lzd.tZd(this.UM,Ka?6:this.LR,this.LR,150,2,this.element,Ja);pa=ya.offsetTop;this.rya=this.kZd(ya.Fnc,ya.offsetTop);ya=ya.I1b;ya!==this.Yea&&(this.qeb(ya),this.element.dir=3===ya?"rtl":"ltr",this.Yea=ya);ya!==
this.e_b()?(Z=this.szd?-2:Ka?-6:-this.LR,this.Y5=!0):this.Y5=!1}return{offsetX:Z,offsetY:pa,H1b:ya}}kZd(Z,pa){if(1===Z)return this.UM-1;Z=Math.abs(pa);return 0<Z?Z/(this.LR+2):0}qeb(Z){for(let pa=0;pa<this.UM;pa++)this.us[pa].qeb(Z)}e_b(){return this.Oi?3:4}static E5a(){return String.format("{0}-{1}","presencetooltip",ea.Ffa++)}static r6a(Z){return Z.nc.rawEvent.relatedTarget}}ea.Ffa=0;Object(J.a)(ea,"ModernPresenceTooltipControl",m.a,[396,109]);var da=d(217),ia=d(284),C=d(264);d.d(V,"a",function(){return oa});
class oa{constructor(Z){this.Ic=Z;this.Ic.UC(10,da.a.instance);this.Ic.UC(9,C.a.instance);this.Ic.UC(6,20);this.Ic.UC(13,ia.a.instance);this.Ic.UC(17,!1)}KEc(Z,pa){this.Ic.UC(15,!1);return new ea(Z,pa,this.Ic)}lpb(Z){this.Ic.UC(15,!1);return new ea(Z,20,this.Ic)}}Object(J.a)(oa,"ModernPresenceTooltipFactory",null,[395])},1202:function(J,V,d){d.r(V);J=d(0);var h=d(332),e=d(69),m=d(365),r=d(1154),v=d(72);class A{constructor(Ya){this.Qd=Ya}zOd(Ya,Va,ua,Ca,Ea,wb){const Oa=this.Qd.rk(ua+".png");ua=v.getImageClassWithCluster(ua,
Ca);return v.createClusteredImageFromClusterWithImageClass(Ya,Va,ua,Oa,32===Ya&&32===Va?"cui-img-cont-float cui-img-32by32":"cui-img-cont-float cui-img-16by16","",!1,Ea,null,wb)}}Object(J.a)(A,"ShapeGlyphImageFactory",null,[262]);var x=d(25),y=d(436),u=d(68);class H{constructor(Ya,Va){this.FYc=this.QZ=null;this.$ee=this.BJg=0;this.we=Ya;this.Kc=Va}dispose(){this.clear();this.QZ.parentNode.removeChild(this.QZ)}add(Ya,Va){this.KHe(!1);Ya=this.JZh(Ya,Va);this.dEj()||this.xLj(Ya)?this.JHe(-1*(Math.ceil(Ya.offsetWidth)+
2)):this.JHe(this.$ee);this.KHe(!0)}clear(){this.we.Vt(this.FYc);this.KHe(!1);this.JHe(0)}Rga(Ya,Va,ua){this.BJg=ua;this.$ee=Va;this.QZ=this.we.De();this.QZ.className="prFlyout UISmallFont";Ya.appendChild(this.QZ);this.FYc=this.we.oWb();this.QZ.appendChild(this.FYc)}JZh(Ya,Va){const ua=this.we.yRf();ua.style.backgroundColor=Ya;ua.style.lineHeight=this.we.Nc(this.BJg);this.we.Zw(ua,Va);this.FYc.appendChild(ua);return ua}xLj(Ya){Ya=this.we.ei(Ya);const Va=this.we.ei(this.Kc.Mc.qC);return Ya.x+Ya.width+
this.$ee>Va.x+Va.width}dEj(){return 0>this.we.Zm(this.QZ.style.left)}KHe(Ya){this.QZ.style.visibility=Ya?u.a.visible:u.a.hidden}JHe(Ya){this.QZ.style.left=this.we.Nc(Ya)}}Object(J.a)(H,"ShapePawnFlyout",null,[308]);var G=d(674),E=d(996),I=d(1096),Q=d(13),D=d(318),Y=d(26),M=d(47),N=d(111),W=d(52);class K{constructor(Ya,Va,ua,Ca,Ea){this.XTb=1;this.o$b=[];this.P9a=null;this.Q6b=this.gzb=!1;this.sUa=this.$h=this.Ft=null;(this.Gx=x.AFrameworkApplication.fa.ka(W.a.bHa))?(this.$h=Ya,this.sUa=Ea,this.Xxi()):
this.Kq=Object(r.a)(y.a,Ca.fPd(Ya,Va,ua,Object(Q.a)(this,this.iC,"onPointerOver"),Object(Q.a)(this,this.Oy,"onPointerOut"),Ea))}$ha(){if(this.Gx)return this.d8i();const Ya=Array.clone(this.Uda);if(this.eV){let Va=!1;for(const ua of this.Uda)if(ua.clientId===this.eV.clientId){Va=!0;break}Va||Array.add(Ya,this.eV)}return Ya}dispose(){this.Gx?this.EFi():(this.o$b=this.P9a=null,this.Kq.dispose())}kz(Ya){if(this.Gx)this.L0h(Ya);else if(Ya){for(const Va of this.Uda)if(Va.clientId===Ya.clientId)return;Array.add(this.Uda,
Ya);this.refresh()}}BL(Ya){if(this.Gx)this.cMk(Ya);else if(Ya)for(const Va of this.Uda)if(Va.clientId===Ya.clientId){Array.remove(this.Uda,Va);this.refresh();break}}clear(){this.Gx?this.$ki():(this.o$b=[],this.Kq.clear())}get eV(){return this.P9a}set eV(Ya){this.P9a!==Ya&&(this.P9a=Ya,this.P9a||(this.Q6b=!1),this.Gx||this.refresh())}OKe(){this.Gx||(this.eV?(this.Q6b=!0,this.XDb()):Y.a.J(22675491,828,10,"ShapePresencePawn.ShowEditorFlyout: Trying to show editing flyout when current editor is null"))}vLe(){this.Gx?
this.X$k():(this.gzb=!0,this.P9a&&(this.Q6b=!0),this.XDb())}R3d(){this.Gx?this.gqj():(this.gzb=!1,this.XDb())}setZIndex(Ya){this.Gx?this.p4k(Ya):this.Kq.setZIndex(Ya)}get Nda(){return this.eV?this.eV.color:this.Uda&&this.Uda.length?this.Uda[this.Uda.length-1].color:N.a.none}COc(){return!!this.P9a||0<this.o$b.length}get Uda(){return this.Gx?this.Ft.xdb:this.o$b}Ypj(){this.Kq.KEb();this.Kq.Iob()}Oy(){this.COc()&&(this.gzb=!1,this.XDb());return!0}iC(){this.COc()&&(this.gzb=!0,this.XDb());return!0}Lrl(){this.COc()?
this.Kq.Cfd(1<this.o$b.length?"MoreUsersGlyph_16x16x32":"SingleCollabUserGlyph_16x16x32",this.Nda):this.Kq.Ppa()}refresh(){this.Lrl();this.XDb()}XDb(){this.Ypj();if(this.gzb)if(this.eV){this.Kq.v2a(this.eV.color,String.format(ResourceStrings.l_TypingHint,this.eV.userName));for(const Ya of this.Uda)this.eV.clientId!==Ya.clientId&&this.Kq.v2a(Ya.color,Ya.userName)}else for(const Ya of this.Uda)this.Kq.v2a(Ya.color,Ya.userName);else this.Q6b&&(this.eV?this.Kq.v2a(this.eV.color,String.format(ResourceStrings.l_TypingHint,
this.eV.userName)):Y.a.J(42472531,828,10,"ShapePresencePawn.RefreshFlyout: Trying to show editing flyout when current editor is null"));(this.gzb||this.Q6b)&&this.Kq.ubc()}Afb(Ya,Va){this.Ft&&this.Ft.Afb(Ya,Va)}EFi(){this.Ft&&this.Ft.dispose()}Zye(){return M.a.ei(document.body)}L0h(Ya){Ya?this.Ft?(Y.a.J(42472535,814,50,"ShapePresencePawn:AddUser at PresencePawn for ClientId { presenceUser.ClientId}",Ya.clientId),this.Ft.kz(Ya)):Y.a.J(42472533,814,10,"ShapePresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {presenceUser.ClientId}"):
Y.a.J(50340754,814,10,"ShapePresencePawn:AddUser - user is null, skipping AddUser")}cMk(Ya){Ya?this.Ft?(Y.a.J(42472539,814,50,"ShapePresencePawn:RemoveUser at PresencePawn for ClientId { presenceUser.ClientId}",Ya.clientId),this.Ft.BL(Ya.clientId)):Y.a.J(42472537,814,15,"ShapePresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser {presenceUser.ClientId}"):Y.a.J(50340758,814,15,"ShapePresencePawn:RemoveUser - user is null, skipping RemoveUser")}$ki(){if(this.Ft){Y.a.J(42472543,814,
50,"ShapePresencePawn:Clear at PresencePawn ");var Ya=this.$ha();if(Ya)for(const Va of Ya)this.BL(Va);else Y.a.J(42472545,814,50,"ShapePresencePawn:Clear - Pawn has no users")}else Y.a.J(42472541,814,15,"ShapePresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}d8i(){return this.Ft?this.Ft.xdb:null}X$k(){this.Ft&&(this.Ft.tea(),this.Ft.vwa())}gqj(){this.Ft&&this.Ft.tea()}p4k(Ya){this.$h.style.zIndex=String(Ya)}Rdj(Ya){const Va=new E.a;Va.add(0,v.getImageClassWithCluster(x.AFrameworkApplication.bN,
"MoreUsersGlyph_16x16x32"));Va.add(5,x.AFrameworkApplication.Rl);Va.add(1,v.getImageClassWithCluster(x.AFrameworkApplication.bN,"DoughboyWhiteGlyph_20x20x32"));Va.add(4,x.AFrameworkApplication.Rl);Va.add(6,20);Va.add(8,x.AFrameworkApplication.isRtl);Va.add(12,Ya);Va.add(11,!1);Va.add(16,Object(Q.a)(this,this.Zye,"presenceViewportBoundsCallback"));return new I.a(Va)}Xxi(){this.Ft=this.Rdj(this.P$f()).lpb(this.$h);Sys.UI.DomElement.addCssClass(this.Ft.element,"ShapePawnContainer")}Oli(){const Ya=this.$ha();
if(Ya)for(const Va of Ya)this.Afb(Va.clientId,!1)}P$f(){return this.XTb+D.a.w$+D.a.w$}ubc(){this.sUa.za.style.zIndex=String(this.P$f())}}Object(J.a)(K,"ShapePresencePawn",null,[302,303,109,260]);var ca=d(670);class P{constructor(Ya,Va,ua,Ca,Ea){this.So=Ya;this.jd=Va;this.we=ua;this.JFa=Ca;this.Kc=Ea;this.$Z=x.AFrameworkApplication.fa.ka(W.a.pa(1166))}Oyi(Ya,Va,ua,Ca){this.$Z?this.we.addCssClass(Ya,"ShapeModernCatchupPawnContainer"):this.we.addCssClass(Ya,"ShapePawnContainer");return new ca.a(Ya,Va,
"pegal",this,ua,Ca)}Myi(Ya,Va,ua){this.we.addCssClass(Ya,"ShapePawnContainer");return new K(Ya,Va,"per",this,ua)}fPd(Ya,Va,ua,Ca,Ea,wb){return new y.a(Ya,Va,ua,Ca,Ea,null,this,this.JFa,this.we,this.So,this.jd,wb)}pSf(){return new H(this.we,this.Kc)}qSf(){return new G.a(this.we)}}Object(J.a)(P,"ShapePawnFactory",null,[261]);var ea=d(55),da=d(570),ia=d(131),C=d(165),oa=d(61),Z=d(60),pa=d(628),ya=d(140),Ja=d(173),Ka=d(191),ma=d(184);class ra{constructor(Ya,Va,ua,Ca,Ea,wb=16){this.mHg=!1;this.Mm=null;
this.$Z=!1;this.hbc=this.Ky=this.Jy=0;this.ud=1;this.G7b=!1;this.Sb=this.n6b=!0;this.HG=!1;this.WS=!0;this.Ofe=!1;this.SS=wb;this.KFa=new ya.a;this.HZ=new Ka.a;this.Jw=new Ja.a;this.eF=new Ja.a;this.EG=new Ja.a;this.w3=new ya.a;this.DD=new ma.a;this.av=new ma.a;this.ob=Ya;this.Kq=Va?Va(this.w3.za,this.SS,Ea):null;this.xa=ua;this.Nja=Ca}dispose(){this.Nja();this.KFa&&(this.KFa.za.parentNode&&this.KFa.aq(),this.HZ&&this.HZ.viewport&&this.HZ.viewport.aq(),this.Jw&&this.Jw.aq(),this.eF&&this.eF.aq(),
this.EG&&this.eF.aq());this.Kq&&this.Kq.dispose();this.w3=this.EG=this.eF=this.Jw=this.HZ=this.KFa=null;this.Sb=!1}get bmh(){return this.Kq}get shape(){return this.xa}get M7a(){return this.mHg}set M7a(Ya){this.SS=Ya?20:16;this.mHg=Ya}get Stg(){return this.$Z}set Stg(Ya){this.SS=16;this.$Z=Ya}Vm(Ya){this.KFa.appendChild(this.HZ.viewport);this.KFa.appendChild(this.w3);this.Jw.xF(N.a.none);this.$Z?this.Jw.sr(Z.a.vJe):this.Jw.sr(Z.a.yJe);this.eF.xF(N.a.none);this.eF.sr(pa.a.FDc);this.EG.xF(N.a.none);
this.EG.sr(pa.a.MMd);this.HZ.appendChild(this.EG);this.HZ.appendChild(this.eF);this.HZ.appendChild(this.Jw);this.setVisibility();this.vXf();Ya.appendChild(this.KFa)}SD(){}eq(){return this.HZ.eq()}Ytb(){return!1}Rx(){}setVisibility(){const Ya=this.Sb&&(!this.HG||!this.WS);this.w3.Sd(Ya);this.Jw.Sd(Ya);this.eF.Sd(Ya);this.EG.Sd(Ya);this.KFa.Sd(this.Sb)}mz(){}TE(){return null}MD(){return[]}vXf(){this.Mm=this.xa.Vq.copy();this.Jw.sr(this.Ofe?pa.a.xOf:this.$Z?Z.a.vJe:Z.a.yJe);this.eF.sr(pa.a.FDc);this.EG.sr(pa.a.MMd);
this.Ss();this.setVisibility()}draw(){this.visible=!0;this.vXf()}get visible(){return this.Sb}set visible(Ya){this.Sb!==Ya&&(this.Sb=Ya,this.setVisibility(),this.Ss())}get Jnb(){return this.n6b}set Jnb(Ya){this.n6b=Ya;this.Jw.Sd(this.Sb&&this.n6b);this.eF.Sd(this.Sb&&this.n6b);this.EG.Sd(this.Sb&&this.n6b)}setPosition(Ya,Va){this.Jy=Ya;this.Ky=Va;this.Ss()}Ej(Ya){this.ud=Ya;this.Ss()}Nq(Ya){this.DD=Ya;this.Ss()}ov(Ya){this.av=Ya;this.Ss()}setZIndex(Ya){this.hbc=Ya;this.KFa.tC(this.hbc);this.HZ.tC(this.hbc);
this.w3.tC(this.hbc);this.Kq&&this.Kq.setZIndex(this.hbc)}wF(Ya,Va){this.HG=Ya;this.WS=Va;this.setVisibility()}PIb(Ya=null){this.Kq&&this.Jw.pv(Ya||this.Kq.Nda);this.Jw&&(this.Jw.Kma(""),this.Jw.xF(N.a.none),this.$Z?this.Jw.sr(Z.a.vJe):this.Jw.sr(Z.a.yJe),this.Jw.vX(""))}Xki(){this.Jw&&this.eF&&this.EG&&(this.Ofe=!1,this.Jw.vX(""),this.eF.vX(""),this.Jw.pv(N.a.none),this.Jw.lwa(0),this.eF.pv(N.a.none),this.eF.lwa(0),this.EG.pv(N.a.none),this.EG.lwa(0))}QRe(Ya,Va=!1){if(this.Jw&&this.eF&&this.EG){this.Ofe=
!0;var ua=0===Ya;this.Jw.sr(pa.a.xOf);this.eF.sr(2===Ya?pa.a.Tni:pa.a.FDc);this.EG.sr(pa.a.MMd);this.Jw.pv(ua?N.a.none:pa.a.Rni);this.eF.pv(ua?N.a.none:pa.a.Nni);switch(Ya){case 2:this.EG.pv(pa.a.Qni);break;case 1:this.EG.pv(pa.a.Oni);break;default:this.EG.pv(pa.a.Pni)}1===Ya?this.$0f():Va?this.$0f():(this.Jw.lwa(1),this.eF.lwa(1),this.EG.lwa(1))}}$0f(){this.a1f(0)}a1f(Ya){this.Jw&&this.eF&&this.EG&&!(1<Ya)&&(Ya+=.05,this.Jw.lwa(Ya),this.eF.lwa(Ya),this.EG.lwa(Ya),window.setTimeout(()=>{this.a1f(Ya)},
10))}Ss(){if(this.Mm){var Ya=this.Mm.copy();this.DD.Fm(Ya);this.av.Fm(Ya);Ya.move(this.Jy,this.Ky);Ya.scale(this.ud,this.ud);this.Cql(Ya);this.Psl(Ya)}}Cql(Ya){if(this.Jw&&this.eF&&this.EG&&Ya){var Va=this.SJf(pa.a.Sni,Ya),ua=this.SJf(pa.a.FDc,Va);this.EG.Mt(ua.points);this.HZ.xm();this.EG.Sd(this.Sb&&(!this.HG||!this.WS));this.eF.Mt(Va.points);this.HZ.xm();this.eF.Sd(this.Sb&&(!this.HG||!this.WS));this.Jw.Mt(Ya.points);this.HZ.xm();this.Jw.Sd(this.Sb&&(!this.HG||!this.WS));ea.a.o8a&&this.xa&&this.xa.rd&&
this.ob.gqg()&&this.HZ.viewport.Bh(this.HZ.viewport.width,0)}}Mbc(){if(this.M7a){var Ya=this.w3.x,Va=this.w3.y;this.ob.PV(this.xa)&&!this.G7b&&(this.w3.setPosition(Ya,Va-18),this.G7b=!0)}}fse(){if(this.M7a){var Ya=this.w3.x,Va=this.w3.y;this.G7b&&!this.ob.PV(this.xa)&&(this.w3.setPosition(Ya,Va+18),this.G7b=!1)}}SJf(Ya,Va){var ua=Va.Yj(C.a.JD),Ca=Va.Yj(C.a.nu);ua=da.a.uT(oa.a.WJ(Ca,ua));new oa.a(0,0);let Ea;new oa.a(0,0);let wb;new oa.a(0,0);new oa.a(0,0);Va.rotate(-ua);const Oa=Va.points;Ca=new oa.a(Oa[0]._x+
Ya,Oa[0]._y+Ya);Ea=new oa.a(Oa[1]._x-Ya,Oa[1]._y+Ya);wb=new oa.a(Oa[2]._x-Ya,Oa[2]._y-Ya);Ya=new oa.a(Oa[3]._x+Ya,Oa[3]._y-Ya);Ya=new ia.a(Ca,Ea,wb,Ya);Ya.rotate(ua);Va.rotate(ua);return Ya}Psl(Ya){if(Ya){var Va=Ya.Yj(C.a.JD),ua=Ya.Yj(C.a.nu),Ca=da.a.uT(oa.a.WJ(ua,Va));Va=Ya.Yj(C.a.JD);ua=Ya.Yj(C.a.nu);90<=Ca&&(Va=Ya.Yj(C.a.nu),ua=Ya.Yj(C.a.bH));180<=Ca&&(Va=Ya.Yj(C.a.bH),ua=Ya.Yj(C.a.YD));270<=Ca&&(Va=Ya.Yj(C.a.YD),ua=Ya.Yj(C.a.JD));Ca=oa.a.WJ(ua,Va);var Ea=this.B7i(Ca);Ya=Math.cos(Ca)*Ea;Ca=Math.sin(Ca)*
Ea;Ea=this.M7a?this.SS/2-1:this.$Z?this.SS/2:this.SS;this.$Z?this.w3.setPosition(ua.x-Ea,ua.y-Ea):this.w3.setPosition(Va.x-Ya,Va.y-Ca-Ea);this.w3.Sd(this.Sb&&(!this.HG||!this.WS));this.M7a&&(this.G7b=!1,this.Mbc())}}B7i(Ya){return(this.M7a?10:15)-da.a.uT(Ya)/6}}Object(J.a)(ra,"ShapePawnView",null,[301]);class Da{gPd(Ya,Va,ua,Ca,Ea){return new ra(Ya,Va,ua,Ca,Ea,16)}}Object(J.a)(Da,"ShapePawnViewFactory",null,[263]);class va extends Sys.EventArgs{constructor(Ya){super();this.shape=Ya}}Object(J.a)(va,
"ShapeViewElementPresenceStateChangedEventArgs",Sys.EventArgs,[]);class Fa{constructor(Ya,Va){this.Ag=Ya;this.xa=this.Ag.shape;this.xa.Iv=!1;this.sCg=new va(this.xa);this.to=Object(r.a)(K,this.Ag.bmh);this.ZPg=Va;(this.zEg=x.AFrameworkApplication.fa.ka(W.a.bHa))&&this.Ag&&(this.Ag.M7a=!0)}Vm(Ya){this.Ag.Vm(Ya)}SD(Ya){this.Ag.SD(Ya)}eq(){return this.Ag.eq()}IP(Ya){return this.Ag.Ytb(Ya)}Rx(Ya){this.Ag.Rx(Ya)}Mbc(){this.Ag.Mbc()}fse(){this.Ag.fse()}dispose(){this.Ag.dispose()}mz(){this.Ag.mz()}TE(Ya){return this.Ag.TE(Ya)}MD(Ya){return this.Ag.MD(Ya)}draw(Ya,
Va){this.Ag.draw(Ya,Va)}get visible(){return this.Ag.visible}set visible(Ya){this.Ag.visible=Ya}setPosition(Ya,Va){this.Ag.setPosition(Ya,Va)}Ej(Ya){this.Ag.Ej(Ya)}Nq(Ya){this.Ag.Nq(Ya)}ov(Ya){this.Ag.ov(Ya)}setZIndex(Ya){this.Ag.setZIndex(Ya)}wF(Ya,Va){this.Ag.wF(Ya,Va)}setSelection(){}yza(Ya){Ya&&(this.vTb(),this.to.kz(Ya),this.Ag.PIb(),this.Ag.setVisibility(),Y.a.J(22675524,814,50,"ShapePresenceView::AddPresence; Added User: {0}; Pawn and Border Color: {1}; shape: {2}",Ya.clientId,this.to.Nda,
this.xa?this.xa.er:"null_moniker"))}geb(Ya){if(Ya&&this.to){this.to.BL(Ya);this.Ag.PIb();var Va=this.to.$ha();Va&&Va.length?Y.a.J(22675528,814,50,"ShapePresenceView::RemovePresence - Remove user from shape presence view; User: {0}, Current Pawn and Border color: {1}; shape: {2}",Ya.clientId,this.to.Nda,this.xa?this.xa.er:""):Y.a.J(22675526,814,50,"ShapePresenceView::RemovePresence - Removed last user, removed pawn and border, User: {0}, shape: {1}",Ya.clientId,this.xa?this.xa.er:"null_moniker");this.Ag.setVisibility();
this.Smb()}}QMf(){this.to.clear();this.Ag.PIb();this.Smb()}OKe(){this.to.OKe()}$8k(){this.to.vLe()}gZ(){this.to.R3d()}Old(Ya){Ya&&this.vTb();this.to&&(this.to.eV=Ya);this.Ag.PIb();this.zEg&&this.to&&(this.to.eV?this.to.Afb(Ya.clientId,!0):this.to.Oli());Ya||this.Smb()}get lDb(){return this.to}get v3d(){return this.to.COc()}get Jnb(){return this.Ag.Jnb}set Jnb(Ya){this.Ag.Jnb=Ya}vTb(){this.xa.Iv||this.v3d||(this.xa.Iv=!0,this.ZPg.c9g(this.sCg))}Smb(){this.xa.Iv&&!this.v3d&&(this.xa.Iv=!1,this.ZPg.c9g(this.sCg))}}
Object(J.a)(Fa,"ShapePresenceView",null,[282,283,284,109]);var ka=d(277);class qa{get name(){return"PowerPointWebEditor.ShapePresence"}Yb(Ya){Ya.register(259,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>").ma().na(()=>new ka.a((Va,ua)=>{let Ca=null;const Ea=Object(r.a)(133,Va.pc(Ya.resolve("Box4.IPageView").Na));Ea&&!Ea.kl&&(Va=Ya.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").gPd(Ya.resolve("PowerPointWebEditor.IPptSelectionManager"),
(wb,Oa,ab)=>Object(r.a)(260,Ya.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").Myi(wb,Oa,ab)),Va,ua,Ea.IT),Ca=new Fa(Va,Ya.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier")),Ca.Vm(Ea.IT),Ea.Bza(Ca,1),Ca.visible=Ea.KP||Ea.Bn);return Ca}));Ya.register(261,"PowerPointWebEditor.ShapePresence.IShapePawnFactory").ma().na(()=>new P(Ya.resolve("Common.IPointerInputManager"),Ya.resolve("Common.IClickInputManager"),Ya.resolve("PowerPoint.IBrowserHelperManager"),Ya.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),
Ya.resolve("PowerPointWebEditor.IActiveSlideViewManager")));Ya.register(262,"PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory").ma().na(()=>new A(Ya.resolve("PowerPoint.IPathManager")));Ya.register(263,"PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").ma().na(()=>new Da)}init(){}dispose(){}static main(){e.a.instance.Ec(new qa)}}Object(J.a)(qa,"PPTWebEditorShapePresencePackage",null,[2,3]);class Ua{constructor(){this.K=null;this.zW=[new qa]}get name(){return"PowerPointWebEditor.ExtCommonPackage"}Yb(Ya){this.K=
Ya;for(const Va of this.zW)Va.Yb(Ya)}init(){for(const Ya of this.zW)Ya.init();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").gsg=!0;h.a.instance.jc(m.a.NTd,(new Date).getTime())}dispose(){}static main(){h.a.instance.jc(m.a.PTd,(new Date).getTime());e.a.instance.Ec(new Ua)}}Object(J.a)(Ua,"PptExtCommonPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.ShapePresence");Type.registerNamespace("Common.App.CollabControls");Ua.main();
qa.main()},228:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(78);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=
String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}ax(){return!0}static rpb(e,m){return e+(m?"Rtl":"")}}Object(J.a)(h,"BasePresenceControl",d.a,[109,394])},229:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m){super();this.type=e;this.Ri=m}}h.No="InteractivityChanged";Object(J.a)(h,"InteractivityChangedEventArgs",
Sys.EventArgs,[])},277:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(981);class e{constructor(m){this.Rk=new h.a;this.aVa=m}yP(m){const r=m.id;let v=null;this.Rk.Kb(r)?v=this.Rk.ga(r):(this.aVa&&(v=this.aVa(m,()=>{this.whc(r)})),v&&this.Rk.$(r,v));return v}QE(m){m=m.id;return this.Rk.Kb(m)?this.Rk.ga(m):null}whc(m){this.Rk.remove(m)}}Object(J.a)(e,"ShapeComponentViewManager",null,[259])},436:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(66),e=d(13),m=d(318),r=d(111);
class v{constructor(A,x,y,u,H,G,E,I,Q,D,Y,M){this.XTb=1;this.SS=x;this.$h=A;this.iee=y;this.we=Q;this.So=D;this.jd=Y;this.JFa=I;this.jFa=H;this.kFa=u;this.HN=G;this.we.addCssClass(this.$h,"prControl");this.$h.style.width=this.we.Nc(x);this.kr=E.qSf();this.xEa=E.pSf();this.kr.Rga(A);this.xEa.Rga(A,x,x);this.sUa=M;this.r4()}dispose(){this.Smc();this.clear();this.kr.dispose();this.xEa.dispose();this.we.removeCssClass(this.$h,"prControl")}get Nda(){return r.a.none}clear(){this.Ppa();this.Iob();this.KEb()}setZIndex(A){this.$h.style.zIndex=
String(A)}ubc(){this.sUa.za.style.zIndex=String(this.XTb+m.a.w$)}KEb(){this.sUa.za.style.zIndex="0"}Cfd(A,x,y=null){A=this.JFa.zOd(this.SS,this.SS,this.iee,A,"",y);this.kr.aIa(A,x)}v2a(A,x){this.xEa.add(A,x)}Iob(){this.xEa.clear()}Ppa(){this.kr.clear()}onClick(){return!0}r4(){this.kFa&&this.So.pb(h.a.pointerOver,this.$h,this.kFa);this.jFa&&this.So.pb(h.a.pointerOut,this.$h,this.jFa);this.HN?this.jd.pb(h.a.click,this.$h,this.HN):this.jd.pb(h.a.click,this.$h,Object(e.a)(this,this.onClick,"onClick"));
this.jd.pb(h.a.doubleClick,this.$h,Object(e.a)(this,this.onClick,"onClick"))}Smc(){this.kFa&&this.So.zb(h.a.pointerOver,this.$h,this.kFa);this.jFa&&this.So.zb(h.a.pointerOut,this.$h,this.jFa);this.HN?this.jd.zb(h.a.click,this.$h,this.HN):this.jd.zb(h.a.click,this.$h,Object(e.a)(this,this.onClick,"onClick"));this.jd.zb(h.a.doubleClick,this.$h,Object(e.a)(this,this.onClick,"onClick"))}}Object(J.a)(v,"ShapePawn",null,[260])},670:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(1154),e=
d(13),m=d(104),r=d(35),v=d(26),A=d(436),x=d(111);class y{constructor(u,H,G,E,I,Q){this.V0a=this.nEa=null;this.Kq=Object(h.a)(A.a,E.fPd(u,H,G,Object(e.a)(this,this.iC,"onPointerOver"),Object(e.a)(this,this.Oy,"onPointerOut"),I));this.rFa=0;this.Oc=Q;this.Oc.wB(Object(e.a)(this,this.ZA,"onSessionEnd"));this.clear()}dispose(){this.Kq.dispose();this.nEa=null}get Nda(){return this.V0a}setZIndex(u){this.Kq.setZIndex(u)}fBf(u,H,G){this.V0a=u;this.nEa=H;this.Kq.Cfd("UnreadNotification_16x16x32",this.Nda,
G)}clear(){this.Kq.clear();this.V0a=x.a.none}ywa(){this.gZ();this.Kq.v2a(this.Nda,this.mXb);this.Kq.ubc()}gZ(){this.Kq.Iob();this.Kq.KEb()}ZA(){v.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.rFa);0<this.rFa&&m.c(r.a.eLd)}get mXb(){return this.nEa?this.nEa():""}iC(){this.ywa();v.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.rFa+=1;return!0}Oy(){this.gZ();return!0}}Object(J.a)(y,"ShapeRevisionTrackingPawn",null,[260])},674:function(J,V,d){d.d(V,"a",
function(){return e});J=d(0);var h=d(68);class e{constructor(m){this.j8=this.Vja=null;this.we=m}dispose(){this.clear();this.Vja.parentNode.removeChild(this.Vja)}Rga(m){this.Vja=this.WVb(m,"prContainerHr");this.j8=this.WVb(this.Vja,"prGlyph")}clear(){this.gma()}aIa(m,r){m&&(this.gma(),this.j8.appendChild(m),this.j8.style.backgroundColor=r,this.Vja.style.visibility=h.a.visible)}WVb(m,r){const v=this.we.De();this.we.addCssClass(v,r);m.appendChild(v);return v}gma(){this.j8.firstChild&&this.j8.removeChild(this.j8.firstChild)}}
Object(J.a)(e,"ShapePawnGlyph",null,[])},996:function(J,V,d){J=d(0);var h;(function(m){m[m.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";m[m.peopleImageClassName=1]="peopleImageClassName";m[m.peopleImageClusterPath=4]="peopleImageClusterPath";m[m.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";m[m.imageDimension=6]="imageDimension";m[m.rtl=8]="rtl";m[m.pointerInputManager=9]="pointerInputManager";m[m.clickInputManager=10]="clickInputManager";m[m.vertical=
11]="vertical";m[m.zIndex=12]="zIndex";m[m.contextMenuInputManager=13]="contextMenuInputManager";m[m.imageDomElement=14]="imageDomElement";m[m.useIdleTooltip=15]="useIdleTooltip";m[m.viewportBoundsCallback=16]="viewportBoundsCallback";m[m.flipHorizontalDirection=17]="flipHorizontalDirection";m[m.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";m[m.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";m[m.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||(h={}));Object(J.b)("PresenceTooltipSettingKeys",
h);d.d(V,"a",function(){return e});class e{constructor(){this.Yx={}}get(m,r=null){m=h[m];return"number"===typeof r?(r=this.Yx[m])?Number.parseInvariant(r.toString()):0:this.Yx[m]}add(m,r){this.Yx[h[m]]=r}UC(m,r){h[m]in this.Yx||(this.Yx[h[m]]=r)}remove(m){delete this.Yx[h[m]]}}Object(J.a)(e,"PresenceTooltipSettings",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.extcommon.js.map