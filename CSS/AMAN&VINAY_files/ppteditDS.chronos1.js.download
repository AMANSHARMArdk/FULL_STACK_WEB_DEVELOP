'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1004:function(J,V,d){J=d(0);var h=d(17),e=d(146),m=d(657),r=d(369),v=d(260),A=d(441),x=d(158),y=d(175),u=d(174),H=d(119),G=d(103);class E{constructor(da){this.ub=da;this.axc=this.W0d()}lG(){return"Add-ins"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:3}oD(da,ia){da=new u.a(da);ia.resultsUpdated(da)}qQa(da,ia,C){const oa=new y.a(26);oa.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;C&&this.yal(da.Hf,
ia,oa)}yal(da,ia,C){const oa=[];let Z;Z=this.ub.Azj?this.ub.hJ&&this.ub.UMa?G.a.wPa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,da)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,da):this.ub.Bzj?this.ub.hJ&&this.ub.UMa?G.a.wPa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,da)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,da):this.ub.hJ&&this.ub.UMa?G.a.wPa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,
da)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,da);this.ub.lia?(H.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",Z)),H.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",da))):(oa.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",Z)),oa.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",da)),appChrome.api.dispatch(oa));C.Bv(new x.a("LaunchAddinDialogFromTellMe",
27));ia.ns(C)}W0d(){const da=[];this.ub.SQc&&Array.add(da,"Addin");return da}}Object(J.a)(E,"AddinStoreResultsProvider",null,[982]);var I=d(944),Q=d(322),D=d(370),Y=d(945),M=d(974),N=d(946),W=d(440),K=d(25),ca=d(33),P=d(114);d.d(V,"a",function(){return ea});class ea{constructor(da,ia,C){this.FQb=this.Iwc=this.Jwc=this.Hwc=!1;this.tH=null;this.eR=-1;this.Z1a=this.WQb=null;this.dRb="";this.p0a=0;this.ub=da;const oa=G.a.Yia();this.rKa=ia||[];this.Di=K.AFrameworkApplication.Be;this.fuf=da.lwe;this.Kwc=
da.kwe;this.PBd=oa&&this.Ofb();this.QBd=oa&&this.Pfb();this.NTh=oa&&this.Qfb();this.SBd=this.GGb();this.huf=this.FGb();da.vNe&&G.a.bKe(da)&&(this.WQb=new M.a(da),this.Hwc=da.Glc,this.Jwc=da.Hlc,this.Iwc=da.WRa,this.FQb=this.Hwc&&this.vx("File")||this.Jwc&&this.vx("People")||this.Iwc&&this.vx("Notes"));this.Gwc=this.T7k();this.Mwc=da.Bdc;this.RBd=this.g8k();this.euf=this.S7k();this.Hxa=this.adj();this.MVe=new I.a(da);this.GLh=new Y.a(da);this.mVh=new N.a(da);this.DFh=new E(da);this.YPb=C;this.jBd=
new m.a;this.Mwc&&(this.MVe=new I.a(da))}vx(da){return Array.contains(this.rKa,da)?!0:!1}lG(){return"TellMeService"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:this.vx("Command")||this.vx("Recommended")?2:3}Ycj(da){let ia="";if(!da&&this.vx("Command")&&this.ub.q9d){ia+="CommandSearch_DLIS,";var C=this.ub.ruh;0<C.length&&(ia+=C+",")}da&&this.vx("Recommended")&&this.Kwc&&(C=this.ub.suh,0<C.length&&(ia+=C+","));!da&&this.vx("Help")&&(da=this.ub.quh,0<da.length&&(ia+=da+","));0<ia.length&&(ia=ia.substr(0,
ia.length-1));return ia}oD(da,ia,C,oa=e.a.tellMe,Z=null){const pa=new u.a(da);C=G.a.eN(da);if(this.FQb&&(!this.p0a||window.performance.now()-this.p0a>=G.a.gkd)){var ya=this.jBd.bdj();if(ya)this.p0a=window.performance.now(),ya.then(ra=>{this.dRb=ra},ra=>{H.TellMeActor.instance.Ld.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+ra)});else if(H.TellMeActor.instance.Ld)H.TellMeActor.instance.Ld.onError("TellMeServiceProvider:IssueQuery","undefined token promise")}var Ja=
this.FQb&&!!this.dRb;ya=Ja||C&&this.vx("Recommended")&&this.Kwc;Ja=Ja||!C&&(this.fuf&&this.vx("Command")||this.PBd&&this.vx("Answer")||this.QBd&&this.vx("Definition")||this.huf&&this.vx("Image")||this.Mwc&&this.vx("Help")||this.SBd&&this.vx("WolframAnswer")||this.RBd&&this.vx("Template")||this.euf&&this.vx("Addin"));if(ya||Ja)if(this.Z1a=oa,oa={"Content-Type":"application/json",Accept:"application/json"},oa["X-Office-Version"]=K.AFrameworkApplication.buildVersion,oa["X-Office-Application"]=K.AFrameworkApplication.fa.Ia("Application"),
oa["X-Office-Platform"]="WAC",oa["X-TellMe-SqmUserId"]=K.AFrameworkApplication.fa.Ia("LoggableUserId")||"",oa["X-TellMe-SessionId"]=H.TellMeActor.instance.rNc(),this.dRb&&(oa.Authorization="Bearer "+this.dRb),ya=this.Ycj(C),0<ya.length&&(oa["X-TellMe-Flights"]=ya),ya=[],!C&&this.vx("Answer")&&this.PBd&&(Z?Array.contains(Z,9):1)&&Array.add(ya,"Answer"),!C&&this.vx("Command")&&this.fuf&&!Q.CommandResultsUtility.F7d(da.Hf)&&(Z?Array.contains(Z,17):1)&&Array.add(ya,"Command"),!C&&this.vx("Definition")&&
this.QBd&&(Z?Array.contains(Z,10):1)&&Array.add(ya,"Definition"),!C&&this.vx("Help")&&this.Mwc&&(Z?Array.contains(Z,8):1)&&Array.add(ya,"Help"),!C&&this.vx("WolframAnswer")&&this.SBd&&(Z?Array.contains(Z,12):1)&&Array.add(ya,"WolframAnswer"),C&&this.vx("Recommended")&&this.Kwc&&!H.TellMeActor.instance.unc&&(Z?Array.contains(Z,18):1)&&Array.add(ya,"Recommended"),!C&&this.vx("Image")&&this.huf&&(Z?Array.contains(Z,19):1)&&Array.add(ya,"Image"),this.dRb&&this.FQb&&(Z?Array.contains(Z,14)||Array.contains(Z,
15)||Array.contains(Z,20):1)&&(this.WQb.w4(),this.Hwc&&this.vx("File")&&Array.add(ya,"File"),this.Jwc&&this.vx("People")&&Array.add(ya,"People"),this.Iwc&&this.vx("Notes")&&Array.add(ya,"Notes")),!C&&this.vx("Template")&&this.RBd&&(Z?Array.contains(Z,23):1)&&Array.add(ya,"Template"),!C&&this.vx("Addin")&&this.euf&&(Z?Array.contains(Z,24):1)&&Array.add(ya,"Addin"),ya.length){oa["X-TellMe-SuggestionTypes"]=ya.join(",");oa["X-TellMe-Culture"]=K.AFrameworkApplication.uiCulture;oa["X-TellMe-ProcessSessionId"]=
K.AFrameworkApplication.userSessionId;var Ka=this.tH=P.a.create().toString();oa["Client-Request-Id"]=Ka;var ma=window.performance.now();this.Yga();this.eR=window.setTimeout(()=>{if(Ka===this.tH){this.tH="";this.eR=-1;ia.resultsUpdated(pa);const ra={};ra[r.a.provider]=this.lG();ra[r.a.Gdb]=da.pWa;H.TellMeActor.instance.Ld.MI(v.a.timedOut,this.YPb,ra)}},this.YPb);this.Di.Jj(this.Hxa,2,this.$cj(da.Hf),oa,!1,0,ra=>{this.Rcb(ra,da,ia,Ka,ma,Z)},ra=>{this.Gcb(ra,da,ia,Ka,ma)},null,null,!1,4E3,6E3)}else H.TellMeActor.instance.Ld.onError("IssueQuery",
"Empty Online Provider List: No online calls by provider"),ia.resultsUpdated(pa);else ia.resultsUpdated(pa)}Yga(){-1!==this.eR&&(window.clearTimeout(this.eR),this.eR=-1)}Rcb(da,ia,C,oa,Z,pa){const ya=new u.a(ia);if(oa===this.tH){this.Yga();H.TellMeActor.instance.Ld.g4(ia.Hf.length,this.rKa.join(","),da.data.tf.toString(),Math.round(window.performance.now()-Z),W.a.tellMe,!0,A.a.Jra);oa=da.data.je;da=null;try{da=ca.b(oa)}catch(va){H.TellMeActor.instance.Ld.onError("OnSuccessCallBack","Exception occured while deserializing response:"+
va);return}oa=G.a.eN(ia);if("Groups"in da&&da.Groups){var Ja=da.Groups;for(var Ka of Ja)if("GroupType"in Ka&&"Suggestions"in Ka&&Ka.Suggestions)if("Commands"===Ka.GroupType&&(pa?Array.contains(pa,17):1)||"Recommended"===Ka.GroupType&&(pa?Array.contains(pa,18):1)){var ma=(Ja="Recommended"===Ka.GroupType)?"DLIS":"NaiveBayes";"Source"in Ka&&Ka.Source&&(ma=Ka.Source);var ra=Ka.Suggestions;new h.a;var Da=[];for(const va of ra)this.yNj(va)&&(ra=va.Type,("Command"===ra||Ja&&"Recommended"===ra)&&Da.push(new D.a(va.CommandId,
va.Score)));Q.CommandResultsUtility.sVc(Da,!ia.Hf.trim().length,Ka.GroupType,ma);ma=H.TellMeActor.instance.qR;ra=[];for(const va of Da)Ja&&ma&&ma.pNd(va.commandId)||ra.push(va);Da=Q.CommandResultsUtility.MMc(ia,ra,this.ub,null,null,null,Ja?18:17,0);0<Da.results.length&&(this.Z1a!==e.a.contextMenu&&(Da.displayName=Ja?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ya.ns(Da))}else if("Answer"===Ka.GroupType){ra=Ka.Suggestions;Ja=null;Da=2147483647;ma="";for(const va of ra)if(this.vNj(va))if(ma=
va.Type,ra=this.osb(ma),"Answer"===ma&&this.PBd){Ja=this.fSf(ma,va,ia.Hf);break}else ra&&ra<Da&&(Da=ra,Ja=this.fSf(ma,va,ia.Hf));Da=G.a.wSk(ia.Hf,ma);Ja&&(pa?Array.contains(pa,Ja.type):1)&&(ma=[],this.Gwc?this.ub.lia?(H.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ja.value,Ja.QI)),H.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ja.value,Ja.description)),H.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ja.value,
Da))):(ma.push(appChrome.actions.setControlLabel(Ja.value,Ja.QI)),ma.push(appChrome.actions.updateCompoundButtonDescription(Ja.value,Ja.description)),ma.push(appChrome.actions.setCompoundButtonCommandValueId(Ja.value,Da)),appChrome.api.dispatch(ma)):this.ub.lia?(H.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ja.value,Ja.QI+" - "+Ja.description)),H.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ja.value,Da))):(ma.push(appChrome.actions.setControlLabel(Ja.value,
Ja.QI+" - "+Ja.description)),ma.push(appChrome.actions.setButtonCommandValueId(Ja.value,Da)),appChrome.api.dispatch(ma)),Da=this.Xyi(Ja.type),Da.Bv(Ja),ya.ns(Da))}else"Help"===Ka.GroupType&&Ka.Suggestions.length&&(pa?Array.contains(pa,8):1)?this.Mwc&&(Ja=this.MVe.qQa(ia,Ka.Suggestions))&&0<Ja.results.length&&ya.ns(Ja):"Template"===Ka.GroupType&&(pa?Array.contains(pa,23):1)?(Ja=Ka.Suggestions)&&0<Ja.length&&this.mVh.qQa(ia,ya,Ja):"Addin"===Ka.GroupType&&(pa?Array.contains(pa,24):1)?(Ja=Ka.Suggestions)&&
0<Ja.length&&this.DFh.qQa(ia,ya,Ja):"Substrate"===Ka.GroupType&&this.FQb&&"Type"in Ka&&("File"===Ka.Type&&this.Hwc&&(pa?Array.contains(pa,15):1)?(Ja=this.WQb.J8f(Ka.Suggestions,oa,this.Z1a))&&0<Ja.results.length&&ya.ns(Ja):"People"===Ka.Type&&this.Jwc&&(pa?Array.contains(pa,14):1)?(Ja=this.WQb.abg(Ka.Suggestions,oa,this.Z1a))&&0<Ja.results.length&&ya.ns(Ja):"Notes"===Ka.Type&&this.Iwc&&(pa?Array.contains(pa,14):1)&&(Ja=this.WQb.uag(Ka.Suggestions,oa,ia))&&0<Ja.results.length&&ya.ns(Ja));else H.TellMeActor.instance.Ld.onError("OnSuccessCallBack",
"GroupType"in Ka?"Invalid group suggestions found for "+Ka.GroupType:"Invalid group found")}if(da.Intents){Ka=da.Intents;for(const va of Ka)this.mae(va)&&("Image"===va.GroupType&&va.ConfidenceScore>va.ConfidenceThreshold&&(pa?Array.contains(pa,19):1)?this.GLh.qQa(ia,ya,0,va):"Commands"===va.GroupType&&va.ConfidenceScore<va.ConfidenceThreshold&&(pa?Array.contains(pa,17):1)&&(Ka=new y.a(17),ya.ns(Ka)))}C.resultsUpdated(ya);H.TellMeActor.instance.Ld.g4(ia.Hf.length,this.rKa.join(","),"",Math.round(window.performance.now()-
Z),"",!0,A.a.provider)}}Gcb(da,ia,C,oa,Z){const pa=new u.a(ia);oa===this.tH&&(this.Yga(),H.TellMeActor.instance.Ld.g4(ia.Hf.length,this.rKa.join(","),da.data.tf.toString(),Math.round(window.performance.now()-Z),W.a.tellMe,!1,A.a.Jra));C.resultsUpdated(pa)}osb(da){switch(da){case "Entity":return this.NTh?3:0;case "Definition":return this.QBd?5:0;case "WolframAnswer":return this.SBd?2:0;default:return 0}}fSf(da,ia,C){switch(da){case "Answer":return new x.a(this.Gwc?"AnswerForSearch":"AnswerForSearchSingleLine",
0,""===ia.Title?C:ia.Title,ia.Description,0);case "Entity":return new x.a(this.Gwc?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ia.Title?C:ia.Title,ia.Description,0);case "Definition":return new x.a(this.Gwc?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ia.Title?C:ia.Title,ia.Description,0);case "WolframAnswer":return new x.a("WolframForSearch",3,""===ia.Title?C:ia.Title,ia.Description,0);default:return null}}Xyi(da){switch(da){case 0:return new y.a(9,CommonUIStrings.l_TellMeAnswersTitle);
case 2:return new y.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new y.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new y.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new y.a(19,this.ub.BGb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}vNj(da){return"Type"in da&&!!da.Type&&""!==da.Type&&"Description"in da&&!!da.Description&&""!==da.Description}yNj(da){return"Type"in da&&!!da.Type&&""!==da.Type&&"CommandId"in da&&
!!da.CommandId&&""!==da.CommandId&&"Score"in da&&!!da.Score}mae(da){if("GroupType"in da&&da.GroupType&&"ConfidenceScore"in da&&"ConfidenceThreshold"in da)return!0;H.TellMeActor.instance.Ld.onError("IsValidIntentGroup","Invalid intents found");return!1}$cj(da){const ia=G.a.mwg(da),C={};C.Query=da;ia&&this.Kwc&&(C.CommandClickedEvents=H.TellMeActor.instance.Ppd,C.CommandActionEvents=H.TellMeActor.instance.RXe,C.TellMeCommandClickMruEvents=H.TellMeActor.instance.Idf,C.ContentType=H.TellMeActor.instance.vFc);
this.RBd&&(da={},da.Application=this.ub.application,C.TemplateInfo=da);return ca.c(C)}Ofb(){return!!this.ub&&this.ub.Ofb||!!K.AFrameworkApplication.Ba&&K.AFrameworkApplication.Ba.jb.Ofb}Pfb(){return!!this.ub&&this.ub.Pfb||!!K.AFrameworkApplication.Ba&&K.AFrameworkApplication.Ba.jb.Pfb}Qfb(){return!!this.ub&&this.ub.Qfb||!!K.AFrameworkApplication.Ba&&K.AFrameworkApplication.Ba.jb.Qfb}GGb(){return!!this.ub&&this.ub.GGb||!!K.AFrameworkApplication.Ba&&K.AFrameworkApplication.Ba.jb.GGb}FGb(){return!!this.ub&&
(this.ub.FGb||this.ub.hJ)}T7k(){return!!this.ub&&!this.ub.VRa}g8k(){return!!this.ub&&this.ub.L4b}S7k(){return!!this.ub&&this.ub.Czj&&this.ub.zzj}Mwg(){return!!K.AFrameworkApplication.fa&&K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}Nwg(){return!!K.AFrameworkApplication.fa&&K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}adj(){if(!K.AFrameworkApplication.fa)return"";
if(this.Nwg())return K.AFrameworkApplication.fa.Ia("TellMeServiceProdEndpointForSearch");if(this.Mwg())return K.AFrameworkApplication.fa.Ia("TellMeServiceEdogEndpointForSearch");if(G.a.Y7d())return K.AFrameworkApplication.fa.Ia("TellMeServiceIntEndpointForSearch");let da=K.AFrameworkApplication.fa.Ia("TellMeServiceSearchEndpoint");da&&""!==da||(da=K.AFrameworkApplication.puh);return da}static DSf(da,ia){if(ia)return new ea(da,["Command","Recommended"],da.V0i);ia=G.a.Yia()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin".split(" "):
"Help WolframAnswer File People Notes Template Addin".split(" ");return new ea(da,ia,da.Wcg)}}Object(J.a)(ea,"TellMeServiceProvider",null,[982])},103:function(J,V,d){J=d(0);var h=d(15);class e{constructor(){this.userId=this.email=this.displayName=null}}Object(J.a)(e,"InsertMentionParameters",null,[]);class m{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(J.a)(m,"InsightsParameters",null,[]);var r=d(940),v=d(941),A=d(942),x=d(943),y=d(25),u=d(439),H=d(438),G=d(33),
E=d(55),I=d(45),Q=d(124);d.d(V,"a",function(){return D});class D{static get $xj(){return"Insights_16x16x32"}static get JPi(){return"Find_16x16x32"}static get e2g(){return"-Parameterized"}static get WLe(){return"Parameterized"}static get Pkd(){return"bTryQuery"}static get aRe(){return"TellMeSuggestion_"}static get sxh(){return"bTryQueryAlternate"}static get DOe(){return"MenuTellMe"}static get csk(){const Y={},M=[];Array.add(M,{Term:{PeopleType:"Person"}});Y.And=M;return Y}static oAi(Y){return Y+D.e2g}static getParameter(Y){let M=
"",N="";if(Y)for(let W=0;W<Y.y1f;++W)"Type"===Y.xYd(W)?M=Y.getValue(W):"Value"===Y.xYd(W)&&(N=Y.getValue(W));return new h.a(M,N)}static cPd(Y){Y=Object.assign(new m,{neighborhood:Y,mentionStart:0,mentionLength:Y.length});return G.c(Y)}static mSf(Y,M,N){Y=Object.assign(new e,{displayName:Y,email:M,userId:N});return G.c(Y)}static UNa(Y,M,N=null){Y=Object.assign(new H.a,{neighborhood:Y,mentionStart:0,mentionLength:Y?Y.length:0});M=Object.assign(new u.a,{selection:Y,userIntent:null,entryPoint:M,launchData:N});
return G.c(M)}static wSk(Y,M){return D.UNa(Y,D.xSk(M))}static xSk(Y){switch(Y){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static Psg(){return!!y.AFrameworkApplication.fa&&y.AFrameworkApplication.fa.ka("IsGoLocalEnvironment")}static J8a(){const Y=y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ia("SovereignEnvironmentName"):null;return!!Y&&0<Y.length}static isEnterpriseUser(){const Y=
y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ia("HostAuthType"):null;return!!Y&&"aad"===Y.toLowerCase()||"external"===Y&&D.Y7d()}static cKe(Y){return Y.kil&&!D.J8a()}static Nvg(){const Y=y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ia("UiHostIntegrationType"):"";return!!y.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===Y&&y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static bKe(Y){return Y.$wa&&Y.COi&&(Y.Hlc||
Y.Glc||Y.WRa)&&!D.Nvg()&&D.isEnterpriseUser()&&!D.J8a()}static Yia(){return y.AFrameworkApplication.fa?y.AFrameworkApplication.Ewa||y.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane"):y.AFrameworkApplication.Ewa}static eN(Y){return!Y||D.mwg(Y.Hf)}static mwg(Y){return!Y||!Y.trim().length}static xQe(Y){if(!Y)return 0;const M=Math.pow(10,5);return Math.round(Y*M)/M}static Xjl(){var Y=new Date;return Y?new Date(Y.getUTCFullYear(),Y.getUTCMonth(),Y.getUTCDate(),Y.getUTCHours(),Y.getUTCMinutes(),
Y.getUTCSeconds(),Y.getUTCMilliseconds()):null}static v1d(Y){return(D.Xjl().getTime()-(new Date(Y)).getTime())/1E3}static Jwg(Y){const {InsightsMenuItemFactory:M}=d(939);switch(Y){case r.a.J3d:case v.a.W2f:case M.Xog:case A.a.PTg:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "LaunchAddinDialogFromTellMe":return!0}return Y.startsWith(D.Pkd)||
Y.startsWith(D.aRe)||Y.startsWith(D.sxh)||Y.startsWith("PeopleSuggestion")||Y.startsWith("FileSuggestion")||Y.startsWith("FindInDocumentSuggestion")||Y.startsWith("NotesSuggestion")||Y.startsWith("OnenoteNotesSuggestion")||Y.startsWith("SmartLookupFromTellMe")||Y.startsWith("GetHelpFromTellMe")||Y.startsWith("GetHelpWithDescriptionFromTellMe")||Y.startsWith("AddinSuggestion")||Y.startsWith("OfficeScripts")?!0:!1}static QYd(Y,M){const N=[];Array.add(N,new x.a(400,Y));Array.add(N,new x.a(200,M));Y=
{};Y.parts=N;return JSON.stringify(Y)}static wPa(Y){const M=Y.indexOf("<b0>"),N=Y.lastIndexOf("</b0>"),W=[];Array.add(W,new x.a(400,Y.substring(0,M)));Array.add(W,new x.a(600,Y.substring(M+4,N)));Array.add(W,new x.a(400,Y.substring(N+5,Y.length)));Y={};Y.parts=W;return JSON.stringify(Y)}static geg(Y){const M=D.v1d(Y);return 60>M?CommonUIStrings.l_TimeSince_SecsAgo:3600>M?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(M/60).toString()):86400>M?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(M/3600).toString()):172800>M?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(Y)).localeFormat("MMMM dd, yyyy"))}static qYi(Y){const M=Array(Y.length);for(let N=0;N<Y.length;N++)M[N]=Y[N].commandId;return M}static Y7d(){if("Dev Box"===y.AFrameworkApplication.fa.Ia("StatusBarEnvironmentNameToUse"))return!0;let Y=y.AFrameworkApplication.fa.Ia("UserPrincipalName");Y=Q.b(Y)?"":I.a.vg(Y);const M=y.AFrameworkApplication.fa.Fu("TellMeIntEnabledForFeatureCrew")?
y.AFrameworkApplication.fa.JB("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(M,Y)&&"inner"===y.AFrameworkApplication.fa.Ia("Microsoft365Ring")}static y2i(Y){switch(Y.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static Fw(){return E.a.uS&&!E.a.Gj}}D.gkd=9E5;Object(J.a)(D,"TellMeUtils",null,[])},1087:function(J,V,d){d.r(V);d.d(V,"SurfaceStringTokenStringGenerator",function(){return e});J=d(0);var h=d(535);class e extends h.a{constructor(m){super(m);this.Ja=
m}apply(m,r,v,A,x,y,u){null==y&&(y=m.neg(x,r));u=h.a.BBf(m,y,this.Ja.score,v,A,u);return{rmc:y,UTb:u}}}e.VTb=0;Object(J.a)(e,"SurfaceStringTokenStringGenerator",h.a,[])},1088:function(J,V,d){d.r(V);d.d(V,"QueryTokenStringGenerator",function(){return m});J=d(0);var h=d(535),e=d(77);class m extends h.a{constructor(r){super(r);this.Ja=r}apply(r,v,A,x,y,u,H){v=this.Ja.query.load(v,null);y=0;let G=null;this.Ja.query.zT===e.Annotations.Kea?v&&(G=this.Ja.name):((G=this.Ja.name)&&(G+="_"),G+=this.Ja.annotations.D0(this.Ja.query.zT,
v));null!=G&&(y=h.a.BBf(r,G,this.Ja.score,A,x,y));return{rmc:u,UTb:H+y}}}m.VTb=1;Object(J.a)(m,"QueryTokenStringGenerator",h.a,[])},1089:function(J,V,d){d.r(V);d.d(V,"FuzzyMatchTokenStringGenerator",function(){return e});J=d(0);var h=d(535);class e extends h.a{constructor(m){super(m);this.Ja=m}apply(m,r,v,A,x,y,u){null==y&&(y=m.neg(x,r));m=this.Ja.k_f.pWj(y);if(this.Ja.u0g)for(var H of m)if(!H.eG&&H.jJc)return{rmc:y,UTb:u};H=0;for(const G of m)if(G.eG&&!({ZJd:H}=this.xFf(G,!0,v,A,H)).returnValue)return{rmc:y,
UTb:u};if(this.Ja.Ekg)for(const G of m)if(!({ZJd:H}=this.xFf(G,!1,v,A,H)).returnValue)break;return{rmc:y,UTb:u}}xFf(m,r,v,A,x){let y;r?(r=0,y=m.jJc?1:0):(r=m.jJc?1:0,y=m.count-r);for(let u=0;u<y;++u)if(h.a.CBf(m.iPa+r+u,this.Ja.score,v,A),++x,0<this.Ja.nre&&x>=this.Ja.nre)return{returnValue:!1,ZJd:x};return{returnValue:!0,ZJd:x}}}e.VTb=2;Object(J.a)(e,"FuzzyMatchTokenStringGenerator",h.a,[])},1097:function(J,V,d){d.r(V);J=d(0);var h=d(299),e=d(17),m=d(15),r=d(1154),v=d(175);class A{constructor(D,
Y,M,N=0){this.Sfg=D;this.groupType=Y;this.n2d=N;this.iic=M}}Object(J.a)(A,"SortingGroup",null,[]);class x{constructor(D,Y,M,N){this.order=D;this.R6a=Y;this.$gj=M;this.groupType=N}}Object(J.a)(x,"SortingProp",null,[]);var y=d(119),u=d(146),H=d(103),G=d(124);class E{constructor(D,Y){this.NMg={};this.MMg={};this.iMg=this.sQg=1;this.oIf(D,Y)}Dcl(D,Y,M){var N=H.a.eN(M)?this.NMg:this.MMg;M=new e.a;for(var W of Y)Y=Object(r.a)(x,N[h.a[W.groupType].toLowerCase()]),G.b(Y)||M.add(new m.a(Y,W));M.Sc((ca,P)=>
ca.key.order<P.key.order?-1:1);Array.clear(D);W=y.TellMeActor.instance.XO;for(Y=0;Y<M.count;){N=M.ga(Y).key.R6a;var K=M.ga(Y).value;const ca=new v.a(M.ga(Y).key.groupType);G.b(W)||W.Location===u.a.contextMenu||(ca.displayName=M.ga(Y).key.$gj);for(const P of K.results)ca.Bv(P);for(K=++Y;K<M.count&&M.ga(K).key.R6a===N;)this.NFd(ca,M.ga(K).value),K=++Y;D.push(ca)}}Ktl(D,Y){this.iMg=this.sQg=1;this.oIf(D,Y)}oIf(D,Y){this.Eqh(D);for(var M=0;M<D.length;M++){let N=D[M];for(const W of N.iic)this.oZh(W,M,
N.Sfg,N.groupType)}this.Eqh(Y);for(D=0;D<Y.length;D++){M=Y[D];for(const N of M.iic)this.nZh(N,D,M.Sfg,M.groupType)}}Eqh(D){D.sort((Y,M)=>Object(r.a)(A,Y).n2d>Object(r.a)(A,M).n2d?-1:1)}oZh(D,Y,M,N){this.NMg[h.a[D].toLowerCase()]=new x(this.sQg++,Y,M,N)}nZh(D,Y,M,N){this.MMg[h.a[D].toLowerCase()]=new x(this.iMg++,Y,M,N)}NFd(D,Y){for(let M=0;M<Y.results.length;M++)D.Bv(Y.results[M])}}Object(J.a)(E,"BaseGroupingSorter",null,[]);class I{constructor(){this.i4c=[new A(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,
4,[4,2]),new A(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new A(CommonUIStrings.l_TellMeSuggestionsProviderTitle,30,[15,14,19,3]),new A("",13,[13]),new A("",22,[22])];this.x1c=[new A(CommonUIStrings.l_TellMeCommandProviderTitle,28,[17,0,1,8,25]),new A(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,29,[2,19,23,26]),new A(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,30,[15,14,20,9,12,10,11,24]),new A("",13,[13]),new A("",22,[22])];this.$Fg=new E(this.i4c,this.x1c)}Lkc(D,
Y,M,N=null,W=null){let K=!1;if(N){for(const ca of H.a.eN(M)?this.i4c:this.x1c)this.wEk(ca,N);K=!0}if(W){for(const ca of H.a.eN(M)?this.i4c:this.x1c)this.Ltl(Y,ca,W);K=!0}K&&this.$Fg.Ktl(this.i4c,this.x1c);this.$Fg.Dcl(D,Y,M)}wEk(D,Y){const M=new e.a;for(var N of D.iic){const W=Y[h.a[N].toLowerCase()];M.add(new m.a(G.b(W)?Number.MAX_VALUE:W,N))}if(M.count){M.Sc((W,K)=>W.key<K.key?-1:1);Y=Array(M.count);for(N=0;N<M.count;N++)Y[N]=M.ga(N).value;D.iic=Y}}Ltl(D,Y,M){let N=0;for(const W of Y.iic)if(h.a[W].toLowerCase()in
M&&M[h.a[W].toLowerCase()])for(const K of D)if(K.groupType===W){N+=M[h.a[W].toLowerCase()];break}Y.n2d=N}}Object(J.a)(I,"SimplifiedGroupingSorter",null,[]);d.d(V,"GroupsPlacementInfo",function(){return Q});class Q{constructor(D){this.LMg={};this.JMg={};this.KMg={};this.OMg={};this.woe={};this.eNg=this.z7j=this.U5j=this.s6j=1;this.$Ng=null;this.Dx=D;this.Cdi();this.Xtk();this.ydi();this.Eci();D.hJ&&(this.$Ng=new I)}tB(D){this.LMg[h.a[D].toLowerCase()]=this.s6j++}xE(D,Y){this.JMg[h.a[D].toLowerCase()]=
Y}mpa(D){this.KMg[h.a[D].toLowerCase()]=this.U5j++}BR(D){this.OMg[h.a[D].toLowerCase()]=this.z7j++}$x(D){this.woe[h.a[D].toLowerCase()]=this.eNg++}Cdi(){const D=!!this.Dx&&this.Dx.VRa,Y=!!this.Dx&&this.Dx.Bdc,M=!!this.Dx&&this.Dx.WRa,N=!!this.Dx&&this.Dx.bae&&!H.a.J8a(),W=!!this.Dx&&this.Dx.L4b,K=!!this.Dx&&this.Dx.SQc,ca=!!this.Dx&&this.Dx.v9d;this.tB(4);this.tB(18);this.tB(16);this.tB(7);this.tB(17);this.tB(0);this.tB(1);ca&&this.tB(25);W&&this.tB(23);D||this.tB(2);D&&!Y||this.tB(8);this.tB(15);
M&&this.tB(20);this.tB(14);this.tB(9);this.tB(12);this.tB(10);this.tB(11);D&&this.tB(2);D&&!Y&&this.tB(8);this.tB(19);K&&this.tB(24);this.tB(21);this.tB(13);N&&this.tB(22)}Xtk(){this.xE(21,1);this.xE(4,3);this.xE(18,3);this.xE(16,3);this.xE(7,3);this.xE(17,5);this.xE(0,5);this.xE(1,1);this.xE(25,2);this.xE(2,1);this.xE(8,2);this.xE(15,3);this.xE(14,2);this.xE(24,3);this.xE(9,1);this.xE(12,1);this.xE(10,1);this.xE(11,1);this.xE(19,1);this.xE(23,1);this.xE(13,1);this.xE(20,2);this.xE(22,1)}ydi(){this.mpa(4);
this.mpa(0);this.mpa(17);this.mpa(7);this.mpa(16);this.mpa(18);this.mpa(15);this.mpa(20);this.mpa(8);this.mpa(14)}Eci(){this.BR(14);this.BR(10);this.BR(12);this.BR(9);this.BR(11);this.BR(20);this.BR(15);this.BR(8);this.BR(2);this.BR(1);this.BR(24);this.BR(7);this.BR(18);this.BR(16);this.BR(17);this.BR(0);this.BR(4)}mRk(){this.woe={};this.eNg=1}Y9i(D,Y,M){this.mRk();const N=!!this.Dx&&this.Dx.VRa,W=!!this.Dx&&this.Dx.Bdc,K=!!this.Dx&&this.Dx.WRa,ca=!!this.Dx&&this.Dx.bae&&!H.a.J8a(),P=!!this.Dx&&this.Dx.L4b,
ea=!!this.Dx&&this.Dx.SQc,da=!!this.Dx&&this.Dx.v9d;D=D&&W;this.$x(4);this.$x(18);this.$x(16);this.$x(7);this.$x(17);this.$x(0);this.$x(1);da&&this.$x(25);P&&this.$x(23);N&&!W||!D||this.$x(8);Y&&this.$x(15);N||this.$x(2);ea&&this.$x(24);M&&this.$x(14);N&&!W||D||this.$x(8);Y||this.$x(15);K&&this.$x(20);M||this.$x(14);this.$x(9);this.$x(12);this.$x(10);this.$x(11);N&&this.$x(2);N&&!W&&this.$x(8);this.$x(19);this.$x(21);this.$x(13);ca&&this.$x(22);return this.woe}hG(){return this.Dx}}Object(J.a)(Q,"GroupsPlacementInfo",
null,[])},1100:function(J,V,d){d.r(V);J=d(0);var h=d(693),e=d(441),m=d(299),r=d(1004),v=d(440);class A{constructor(Q="",D="",Y="",M=-99999,N=-1,W=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=Q?Q:"";this.Description=D?D:"";this.Type=Y?Y:"";this.Score=M;this.Age=N;this.Count=W}}Object(J.a)(A,"Suggestion",null,[]);class x{constructor(Q,D){this.GroupType=this.Suggestions=null;this.Suggestions=Q;this.GroupType=D}}Object(J.a)(x,"SuggestionGroup",null,[]);class y{}
y.help="help";y.answer="answer";y.commands="commands";y.nYk="servicecommands";y.tuh="template";Object(J.a)(y,"SuggestionGroupType",null,[]);var u=d(119),H=d(103),G=d(25),E=d(33);d.d(V,"InteractionLogger",function(){return I});class I{constructor(Q,D,Y){this.mrd=0;this.dDd=this.cOb=null;this.Pi=Q;this.cCd=this.cqd=this.Itd=!1;this.fIh=D;this.Di=G.AFrameworkApplication.Be;this.ub=Y;this.cqc=this.Oyd=0}get Zla(){return this.Pi.Zla}Wfd(Q){this.Pi.Wfd(Q)}sAg(){if(this.cOb){var Q=0;for(const D of this.cOb)this.Pi.lVj(D,
Q++);this.cOb=null}}beginQuery(Q,D,Y){this.Pi.bVj(Q,D,Y)}XXg(Q,D){this.Pi.X$h(Q,D);this.Itd=!0;this.cCd=!1}WXg(){this.Itd=!1;this.cqd||(this.sAg(),this.Pi.SYf(this.mrd))}cVj(Q,D){this.Pi.dVj(Q,D)}Zfk(Q,D,Y,M,N){for(const W of this.fIh)if(Q.startsWith(W)){this.cCd=!0;break}this.Pi.jTj(Q,D,Y,M,N)}kgk(Q){this.cqd=!1;this.mrd=Q;this.Itd||this.cCd||(this.sAg(),this.Pi.SYf(this.mrd,!1))}jgk(Q,D){this.Pi.nTj(Q,D);this.cqd=!0}CWd(Q,D){if(!Q.count)return"";let Y="";const M=Date.now();for(let N of Q)Q=(M-N.timeStamp)/
1E3,Q=H.a.xQe(Q),0<Y.length&&(Y+=";"),Y+=D?N.commandId:N.controlId,Y+=":",Y+=Q.toString();return Y}Pcc(){var Q=this.CWd(h.a.instance.ZKb,!1);0<Q.length&&this.Pi.hTj(Q);Q=this.CWd(h.a.instance.Hib,!0);0<Q.length&&this.Pi.ISj(Q);Q=this.CWd(h.a.instance.crc,!0);0<Q.length&&this.Pi.PTj(Q);Q=u.TellMeActor.instance.Jdf;0<Q.length&&this.Pi.aVj(E.c(Q))}wVj(Q){this.Pi.XSj(Q)}g4(Q,D,Y,M,N,W,K,ca=null){this.Pi.yUj(Q,D,Y,M,N,W,K,ca)}lce(Q,D,Y,M){this.Pi.lce(Q,D,Y,M)}MI(Q,D,Y=null){this.Pi.LDa(Q,D,Y)}onError(Q,
D,Y=null){this.Pi.J5b(Q,D,Y)}y0k(Q){this.cOb=Q}qcj(Q){const D=[];if(!Q)return D;for(let Y=0;Y<Q.length;Y++){const M=m.a[Q[Y].groupType].toLowerCase(),N=[],W=Q[Y].results;if(W){for(let K=0;K<W.length;K++)"findindocument"===M?Array.add(N,new A("","",M,W[K].score,W[K].aAc,W[K].count)):Array.add(N,new A(W[K].label,W[K].description,M,W[K].score,W[K].aAc,W[K].count));"answer"===M||"definition"===M||"wolframanswer"===M||"entity"===M?Array.add(D,new x(N,y.answer)):"classifier"===M||"appsforoffice"===M?Array.add(D,
new x(N,y.commands)):"serviceclassifier"===M?Array.add(D,new x(N,y.nYk)):"assistance"===M?Array.add(D,new x(N,y.help)):("document"===M||"people"===M||"findindocument"===M||"notes"===M||"image"===M||"template"===M)&&Array.add(D,new x(N,M))}}return D}V0d(Q,D){const Y={};Y.Query=D;Y.SuggestionGroups=E.c(this.qcj(Q));return E.c(Y)}Qdg(Q){const D={"Content-Type":"application/json",Accept:"application/json"};D["X-Office-Version"]=G.AFrameworkApplication.buildVersion;D["X-Office-Application"]=G.AFrameworkApplication.fa.Ia("Application");
D["X-Office-Platform"]="WAC";D["X-TellMe-SqmUserId"]=G.AFrameworkApplication.fa.Ia("LoggableUserId")||"";D["X-TellMe-SessionId"]=this.Pi.Zla.r7;D["X-TellMe-SuggestionTypes"]="Ranker";D["X-TellMe-Culture"]=G.AFrameworkApplication.uiCulture;D["X-TellMe-ProcessSessionId"]=G.AFrameworkApplication.userSessionId;D["X-TellMe-Flights"]=Q;D["X-TellMe-PartialQueryIndex"]=this.Oyd;return D}Rcb(Q,D,Y){this.g4(D.length,"RankerLogging",Q.data.tf.toString(),Math.round(window.performance.now()-Y),v.a.ouh,!0,e.a.Jra)}Gcb(Q,
D,Y){this.g4(D.length,"RankerLogging",Q.data.tf.toString(),Math.round(window.performance.now()-Y),v.a.ouh,!1,e.a.Jra)}Rdg(){this.dDd||(this.dDd=new r.a(this.ub,null,6E3));return this.dDd.Hxa}oce(Q){const D=this.V0d(this.cOb,Q),Y=this.Qdg("RankerLogging"),M=window.performance.now();this.Di.Jj(this.Rdg(),2,D,Y,!1,0,N=>{this.Rcb(N,Q,M)},N=>{this.Gcb(N,Q,M)},null,null,!1,4E3,6E3);this.Oyd++}cRk(){this.Oyd=0}BHe(Q){this.cqc=Q}}Object(J.a)(I,"InteractionLogger",null,[])},119:function(J,V,d){d.r(V);J=d(0);
var h=d(13),e=d(22),m=d(1154),r=d(693),v=d(262);class A{constructor($a,vb,bc,Cc,Gc,sd){this.groupType=$a;this.resultType=vb;this.sNe=bc;this.R6a=Cc;this.ARd=Gc;this.resultIndex=sd}}Object(J.a)(A,"ClickLoggingInfo",null,[]);const x=$a=>{const vb=[];for(;$a;)Array.add(vb,"{ContextId:"+$a.contextId+", IsGraphNodeContext:"+$a.Ok+"}"),$a=$a.HD;vb.reverse();return"{"+vb.join(", ")+"}"};class y{constructor(){this.r7=this.sessionId=null}}Object(J.a)(y,"CorrelationRecord",null,[1217]);var u=d(260);class H{constructor($a,
vb){this.Id=null;this.TimeStamp=0;this.Id=$a;this.TimeStamp=vb}}Object(J.a)(H,"MRUControl",null,[]);var G;(function($a){$a[$a.Answer=0]="Answer";$a[$a.Definition=1]="Definition";$a[$a.Entity=2]="Entity";$a[$a.WolframAnswer=3]="WolframAnswer";$a[$a.Assistance=4]="Assistance";$a[$a.Command=5]="Command";$a[$a.Document=6]="Document";$a[$a.TryQuery=7]="TryQuery";$a[$a.FindInDocument=8]="FindInDocument";$a[$a.HelpAction=9]="HelpAction";$a[$a.Insights=10]="Insights";$a[$a.People=11]="People";$a[$a.Image=
12]="Image";$a[$a.FirstRunResult=13]="FirstRunResult";$a[$a.NoCommandsFoundResult=14]="NoCommandsFoundResult";$a[$a.TestResult=15]="TestResult";$a[$a.AppsForOffice_Installed=16]="AppsForOffice_Installed";$a[$a.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";$a[$a.AppsForOffice_Query=18]="AppsForOffice_Query";$a[$a.Notes_Onenote=19]="Notes_Onenote";$a[$a.Notes_Samsung=20]="Notes_Samsung";$a[$a.Notes_Sticky=21]="Notes_Sticky";$a[$a.Learning=22]="Learning";$a[$a.Feedback=23]="Feedback";
$a[$a.Template=24]="Template";$a[$a.Addin=25]="Addin";$a[$a.OfficeScript=26]="OfficeScript";$a[$a.AddinStoreEntry=27]="AddinStoreEntry";$a[$a.Unknown=28]="Unknown"})(G||(G={}));Object(J.b)("ResultType",G);var E=d(675),I=d(103),Q=d(25),D=d(418);class Y{constructor($a,vb){this.OOh=10;this.zU=[];this.Ofa=[];this.b8e=this.a8e=!1;this.JOb=this.IOb="";this.Mtc=vb;this.ub=$a;this.B$e=$a.mo}d_b(){!this.a8e&&this.B$e&&this.ub&&E.a.Ltg()&&(this.IOb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.ub.application,
this.zU=this.p6f(),this.a8e=!0);return this.zU}A8i(){!this.b8e&&this.B$e&&this.ub&&E.a.Ltg()&&(this.JOb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.ub.application,this.Ofa=this.p6f(!0),this.b8e=!0);return this.Ofa}yMj($a){return $a.startsWith("TellMeUpsell")||"OpenInClientUpsell"===$a||"TryOfficeUpsell"===$a}O7d($a){return this.Xzj($a)||this.yMj($a)||I.a.Jwg($a)?!1:!0}EYh($a){$a=$a.ControlId;this.O7d($a)&&($a=this.lDe($a),this.HLk($a),this.P8j(),Array.insert(this.zU,0,new H($a,Date.now())),this.IOb.length&&
($a=JSON.stringify(this.zU),D.a.instance.setItem(this.IOb,$a)))}TC($a){this.O8j();Array.insert(this.Ofa,0,new H(G[$a],Date.now()));this.JOb.length&&($a=JSON.stringify(this.Ofa),D.a.instance.setItem(this.JOb,$a))}p6f($a=!1){if(!this.zU.length){var vb=$a?D.a.instance.getItem(this.JOb):D.a.instance.getItem(this.IOb);if(!vb||""===vb)return $a?this.Ofa:this.zU;let bc=null;try{bc=JSON.parse(vb)}catch(Cc){this.bli($a),bc=null}if(!bc||!bc.length||10<bc.length)return $a?this.Ofa:this.zU;vb=0;for(const Cc of bc)if($a||
this.ub.ZTc(Cc.Id)&&this.O7d(Cc.Id))if($a?Array.insert(this.Ofa,vb++,Cc):Array.insert(this.zU,vb++,Cc),vb===this.Mtc)break}return $a?this.Ofa:this.zU}pNd($a){$a=this.lDe($a);for(const vb of this.zU)if(vb.Id===$a)return!0;return!1}bli($a=!1){D.a.instance.setItem($a?this.JOb:this.IOb,"")}jCj($a){$a=this.lDe($a.ControlId);return this.O7d($a)?this.pNd($a):!1}HLk($a){if(0<this.zU.length){let vb=0;for(const bc of this.zU){if(bc.Id===$a){Array.removeAt(this.zU,vb);break}vb++}}}lDe($a){return"Excel"===this.ub.application&&
$a.startsWith("m_excelWebRenderer_ewaCtl_")?$a.substr(26,$a.length):$a}P8j(){this.zU.length===this.Mtc&&Array.removeAt(this.zU,this.zU.length-1)}O8j(){this.Ofa.length===this.OOh&&Array.removeAt(this.Ofa,this.Ofa.length-1)}Xzj($a){$a=$a.split("|");let vb="";if(6<=$a.length)vb=$a[0];else if(3<=$a.length){if("3"===$a[0])return!0;vb=$a[1]}return vb.startsWith("WA")}static createInstance($a){let vb=3;Q.AFrameworkApplication.fa&&(vb=Q.AFrameworkApplication.fa.Gc("TellMeMaxRecommendedResultsToReturn",3));
return new Y($a,vb)}}Object(J.a)(Y,"MruControlsManager",null,[1218]);class M{constructor($a){this.T0a=$a}cK($a,vb){let bc;return $a.QI&&(bc=this.T0a[$a.value])?bc.cK($a,vb):(bc=this.b7f($a.value))?bc.cK(bc.Zak,vb):null}l7i($a,vb){if($a=this.T0a[$a])for(const bc of vb)if(vb=I.a.getParameter(bc),vb.key===$a.hqk)return vb.value;return null}odk($a){($a=this.b7f($a))&&$a.mdk()}b7f($a){const vb=$a.indexOf(I.a.e2g);return 0<vb?this.T0a[$a.substring(0,vb)]:null}}Object(J.a)(M,"ParameterizedCommandManager",
null,[1216]);var N=d(299);class W{constructor($a,vb){this.Hf=$a;this.pWa=vb}}Object(J.a)(W,"TellMeQuery",null,[]);var K=d(676);class ca{constructor($a,vb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=$a;this.TimeElapsedSinceClick=vb}}Object(J.a)(ca,"CommandClickedEvent",null,[]);var P=d(124);class ea{constructor($a,vb){this.UPh=$a;this.eaa=vb}resultsUpdated($a){this.UPh(P.b($a.query)?"":$a.query.Hf,$a.vk,$a.attributes,this.eaa,$a.Mub)}}Object(J.a)(ea,"ResultsUpdatedCallback",null,[985]);var da=
d(17);class ia{constructor($a,vb){this.menuModel=$a;this.Jeh=vb}}Object(J.a)(ia,"GeneratedMenuModel",null,[]);class C{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(J.a)(C,"MenuModel",null,[]);class oa{constructor($a,vb,bc){this.ub=$a;this.T0a=vb;this.d2a=bc}QUi($a,vb,bc){const {TellMeActor:Cc}=d(119);let Gc=0;const sd=new C,Sd=[];let ie="";sd.sections=[];let De=new da.a;const yd=!!this.ub&&this.ub.VRa;var ib=!!this.ub&&this.ub.AGb||
Q.AFrameworkApplication.Ba.jb.AGb;for(const Bc of $a){$a=0;yd||(De=new da.a);const Ob=new da.a;let yc=Bc.displayName;for(const fc of Bc.results){if(0<=fc.value.indexOf(I.a.WLe)){if(fc.QI){var dc=this.T0a[fc.value];if(dc&&fc.value.endsWith(I.a.WLe)){if("FindParameterized"!==fc.value&&!ib){const Nb=[];Nb.push(appChrome.actions.setControlLabel(fc.value,dc.D3i(fc)));Nb.push(appChrome.actions.setButtonCommandValueId(fc.value,dc.tYi(fc)));appChrome.api.dispatch(Nb)}dc=fc.value.replace(I.a.WLe,"");De.remove(dc)?
$a--:Ob.add(dc);De.add(fc.value);$a++}}}else switch(fc.type){case 5:Ob.contains(fc.value)||(De.add(fc.value),$a++);break;case 7:De.add(fc.QI);$a++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 6:case 19:case 20:case 21:case 25:case 27:case 26:De.add(fc.value),$a++}13===Bc.groupType&&(yc=I.a.Yia()?0<vb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,vb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,
vb));21===Bc.groupType&&(yc=CommonUIStrings.l_LearningUILiveText)}Gc+=$a;""!==yc&&0<$a&&(ie+=" , "+$a.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+yc+" , ");0<De.count&&!yd&&($a=appChrome.api.menuSection(De.toArray(),Bc.displayName,null,N.a[Bc.groupType]),Sd.push($a))}ib=null;0<Gc&&(ib=0<vb.length?1!==Gc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,Gc,vb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,vb):1!==Gc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,
Gc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,yd?(vb=appChrome.api.menuSection(De.toArray(),"",null,null),Sd.push(vb)):ib+=ie);bc&&(this.ub.lia?Cc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(ib)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(ib)));sd.sections=Sd;return new ia(sd,Gc,[])}static get CSd(){return oa.m0e||(oa.m0e=new ia(Object.assign(new C,{sections:[]}),0,[]))}}oa.m0e=null;Object(J.a)(oa,"TellMeMenuDefintionGenerator",
null,[]);var Z;(function($a){$a[$a.TellMeControlActivated=0]="TellMeControlActivated";$a[$a.TellMeQueryExecuted=1]="TellMeQueryExecuted";$a[$a.TellMeResultsRendered=2]="TellMeResultsRendered";$a[$a.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(Z||(Z={}));Object(J.b)("PerformanceMarker",Z);var pa;(function($a){$a[$a.TellMeTimeToRender=0]="TellMeTimeToRender";$a[$a.TellMeSessionLength=1]="TellMeSessionLength";$a[$a.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(pa||(pa={}));Object(J.b)("PerformanceMeasure",
pa);class ya{mark($a){window.performance.mark(Z[$a])}measure($a,vb,bc){const {TellMeActor:Cc}=d(119);try{window.performance.measure(pa[$a],Z[vb],Z[bc])}catch(Gc){Cc.instance.Ld.onError("TellMePerformance:Measure","error measuring "+pa[$a])}}dce($a,vb,bc){const {TellMeActor:Cc}=d(119);Cc.instance.Ld.lce(vb,bc,$a,this.U4i($a))}UCc($a){for(const vb of $a)window.performance.clearMarks(Z[vb])}clearMeasures($a){for(const vb of $a)window.performance.clearMeasures(pa[vb])}U4i($a){let vb=0;($a=this.JVi($a))&&
0<$a.length&&(vb=$a[$a.length-1].duration);return vb}JVi($a){return window.performance.getEntriesByName(pa[$a],"measure")}}Object(J.a)(ya,"TellMePerformance",null,[]);var Ja=d(441),Ka=d(440),ma=d(33);class ra{constructor($a){this.kVh=$a}Sve($a,vb,bc){const {TellMeActor:Cc}=d(119);Cc.instance.Ld.g4(vb,Ka.a.FDb,$a.data.tf.toString(),Math.round(window.performance.now()-bc),Ka.a.FDb,!0,Ja.a.Jra);$a=ma.b($a.data.je);vb=-1;$a.Index&&(vb=$a.Index);Cc.instance.Ld.cVj(vb,this.kVh)}Icc($a,vb,bc){const {TellMeActor:Cc}=
d(119);Cc.instance.Ld.g4(vb,Ka.a.FDb,$a.data.tf.toString(),Math.round(window.performance.now()-bc),Ka.a.FDb,!1,Ja.a.Jra)}D8i($a){if($a&&""!==$a.trim()){const bc=window.performance.now(),Cc=Q.AFrameworkApplication.muh;var vb={};vb.Text=$a;vb.IsFileHash="false";vb=ma.c(vb);Q.AFrameworkApplication.Be.Jj(Cc,2,vb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,Gc=>{this.Sve(Gc,$a.length,bc)},Gc=>{this.Icc(Gc,$a.length,bc)},null,null,!1,4E3,6E3)}}}Object(J.a)(ra,"TellMeQueryIndexCallback",
null,[]);var Da=d(146);class va{constructor($a,vb,bc){this.xml=$a;this.Jeh=vb;this.BFi=bc}}Object(J.a)(va,"GeneratedMenuXml",null,[]);var Fa=d(940),ka=d(45);class qa{constructor($a,vb){this.Npc=$a||{};this.Cya=vb}get teb(){return 5}cK($a,vb=null){return this.Cya.cK($a,vb)||this.dci($a.value)}dci($a){return qa.cci($a,this.Npc[$a]||null)}static cci($a,vb=null){$a=String.format('<ClonedControl Id="{0}" ',$a);for(let Gc in vb){var bc=Gc,Cc=vb[Gc];Cc=Cc?ka.a.le(Cc.toString()):"";$a+=String.format('{0}="{1}" ',
bc,Cc)}return $a+"/>"}}Object(J.a)(qa,"CommandMenuItemFactory",null,[981]);var Ua=d(133);class Ya{constructor(){this.hKh=CommonUIStrings.l_FindInDocumentText}get teb(){return 8}cK($a){var vb=$a.QI;$a=ka.a.le($a.value);const bc=ka.a.le(vb);vb=ka.a.le(String.format(this.hKh,vb));return this.jUi($a,bc,vb)}jUi($a,vb,bc){return Ua.a($a,"1540292897",bc,I.a.JPi,null,vb,bc,null,null)}}Object(J.a)(Ya,"FindInDocumentMenuItemFactory",null,[981]);var Va=d(941),ua=d(939),Ca=d(942);class Ea{get teb(){return 7}cK($a){const vb=
Object(m.a)(K.a,$a);return this.WUi(ka.a.le($a.value),vb.id)}WUi($a,vb){return Ua.a(vb,"1404166600",$a,null,null,$a,$a,null,null)}}Object(J.a)(Ea,"TryQueryMenuItemFactory",null,[981]);class wb{constructor($a){this.Tna=[];this.ub=$a}T0i($a){for(const vb of this.Tna)if(vb.teb===$a)return vb;return null}FWa($a){this.Tna.push($a)}fIk($a){this.FWa(new qa(this.ub.ksi,$a));this.FWa(new Ca.a(this.ub.Ack));this.FWa(new Fa.a(this.ub.$Vk,this.ub.ZVk,this.ub.wil,this.ub.Opj,this.ub.T6k));this.FWa(new ua.InsightsMenuItemFactory);
this.FWa(new Ya);this.FWa(new Va.a);this.FWa(new Ea)}}Object(J.a)(wb,"MenuItemFactoryRegistry",null,[]);var Oa=d(158);class ab{constructor($a,vb){this.ub=$a;this.idf=new wb(this.ub);this.idf.fIk(vb)}RUi($a,vb){let bc=0;const Cc=[],Gc=[];for(const Sd of $a){$a=I.a.DOe;var sd=[];for(const ie of Sd.results){const De=this.idf.T0i(ie.type).cK(ie,vb);$a=I.a.DOe;sd.push(De);if(13===ie.type||14===ie.type)$a="Menu32";17===ie.type&&($a="MenuTellMeExtended");ie.groupType=Sd.groupType;Gc.push(Object(m.a)(Oa.a,
ie))}bc=bc?bc:sd.length;sd=Ua.c("TellMeDropdownControls",sd);$a=Ua.e("TellMeDropdownMenuSection",sd,$a,Sd.displayName);Cc.push($a)}vb=Ua.f(Cc,"LookupDropdownMenu");return new va(vb,bc,Gc)}static get pHc(){return ab.n0e||(ab.n0e=new va(Ua.f([],"LookupDropdownMenu"),0,[]))}}ab.n0e=null;Object(J.a)(ab,"TellMeXmlGenerator",null,[]);class fb{}fb.vbk="MRU";fb.test="Test";Object(J.a)(fb,"ActionType",null,[]);var db=d(369),gc;(function($a){$a[$a.Service=0]="Service";$a[$a.Local=1]="Local";$a[$a.MRU=2]="MRU";
$a[$a.TestResult=3]="TestResult";$a[$a.Unknown=4]="Unknown"})(gc||(gc={}));Object(J.b)("SubResultType",gc);var ob=d(105);class Sb{constructor($a,vb,bc,Cc,Gc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=$a;this.IsEnabled=vb;this.ResultType=G[bc];this.SubResultType=gc[Cc];this.OptionalData=Gc?ob.a.toJSON(Gc):null}}Object(J.a)(Sb,"ResultInfo",null,[]);var Jb=d(168),Ab=d(141),lc=d(179);class Mc{constructor($a,vb=null){this.v5e="TellMeWAC.";
this.yQh=$a;this.NVh=vb}Ema($a,vb,bc){vb=Jb.a.bD(vb);$a=Jb.a.rPd($a,this.yQh,this.NVh,bc,vb);Ab.a.Ema($a,this.v5e)}SHa($a,vb,bc=0){vb=Jb.a.bD(vb);Ab.a.SHa(Object.assign(new lc.a,{name:$a,dataFields:vb,durationMs:bc}),this.v5e)}}Object(J.a)(Mc,"TellMeOtelLogger",null,[1003]);var Jc=d(114);class rb{constructor($a,vb,bc,Cc,Gc,sd,Sd){this.AU=this.mY=this.XXe=null;this.Ana=$a;this.fqd=vb;this.Boa=bc;this.TKa=Cc;this.oya=Gc;this.uNh=sd;this.AU=Sd?Sd:new Mc(this.TKa?v.CuiHelper.VLe:v.CuiHelper.MOe)}get mo(){return this.TKa}get Zla(){return this.Boa}Wfd($a){this.XXe=
$a;switch($a){case Da.a.contextMenu:this.mY=Da.a.contextMenu;break;default:this.mY=Da.a.tellMe}}X$h($a,vb){this.Boa.r7||(this.Boa.r7=Jc.a.create().toString(),this.Nzg($a,!0,vb))}SYf($a,vb=!0){this.Boa.r7&&this.DTj($a,vb);this.TKa&&appChrome.api.updateTellMeCorrelationId("");this.Boa.r7=null}Nzg($a,vb,bc){const {TellMeActor:Cc}=d(119),Gc=this.cV(u.a.Jtb);Gc[db.a.culture]=this.fqd;Gc[db.a.appName]=this.Ana;Gc[db.a.context]=$a;Gc[db.a.oTc]=this.oya;Gc[db.a.uMj]=this.uNh;Gc[db.a.cLj]=bc;Gc[db.a.zFj]=
vb;Gc[db.a.contentType]=Cc.instance.vFc;this.AU.Ema(u.a.Jtb,Gc,this.XXe);this.TKa&&appChrome.api.updateTellMeCorrelationId(this.Boa.r7)}DTj($a,vb){const bc=this.cV(u.a.cpg);bc[db.a.yHi]=$a;bc[db.a.yFj]=vb;this.AU.SHa(u.a.cpg,bc)}bVj($a,vb,bc){let Cc=0;!bc&&0<$a.length&&(Cc=$a.trim().split(" ").length);const Gc=this.cV(u.a.query);Gc[db.a.query]="!";Gc[db.a.Gdb]=vb;Gc[db.a.g7g]=$a.length;Gc[db.a.Axg]=bc;Gc[db.a.Gyl]=Cc;this.AU.Ema(u.a.query,Gc,this.mY)}yUj($a,vb,bc,Cc,Gc,sd,Sd,ie=null){const De=this.cV(u.a.latency);
De[db.a.culture]=this.fqd;De[db.a.g7g]=$a;De[db.a.byh]=vb;De[db.a.statusCode]=bc;De[db.a.mYk]=Gc;De[db.a.isSuccess]=sd;De[db.a.yPj]=Sd;ie&&(De[db.a.pkl]=ie);this.AU.SHa(u.a.latency,De,Cc)}lce($a,vb,bc,Cc){const Gc=this.cV(u.a.performance);Gc[db.a.culture]=this.fqd;Gc[db.a.$$h]=Z[$a];Gc[db.a.aJi]=Z[vb];Gc[db.a.msk]=pa[bc];this.AU.SHa(u.a.performance,Gc,Cc)}lVj($a,vb){var {TellMeActor:bc}=d(119);const {CommandResultsUtility:Cc}=d(322);if($a.results.length){var Gc=this.cV(u.a.Sch);Gc[db.a.R6a]=vb.toString();
Gc[db.a.groupType]=N.a[$a.groupType];16===$a.groupType&&(Gc[db.a.GKj]=bc.instance.unc);vb=[];bc=[];var sd=[];for(const Sd of $a.results)Gc[db.a.resultType]||(Gc[db.a.resultType]=G[Sd.type]),$a={},25===Sd.type&&($a.AssetId=Sd.NGd),bc.push(Cc.Z2b(Sd.value)),vb.push(Sd.value),sd.push(new Sb(Sd.value,Cc.Z2b(Sd.value),Sd.type,Sd.subType,$a));0<vb.length&&(Gc[db.a.zSk]="{"+vb.join(", ")+"}",Gc[db.a.FIi]="{"+bc.join(", ")+"}",Gc[db.a.uSk]=ma.c(sd));this.AU.Ema(u.a.Sch,Gc,this.mY)}}kVi($a,vb){if(4===$a)return fb.vbk;
switch(vb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return G[vb]}jTj($a,vb,bc,Cc,Gc){const sd=this.cV(u.a.click);sd[db.a.byh]=$a;sd[db.a.jqk]=vb;sd[db.a.commandId]=bc;sd[db.a.Mob]=Cc;sd[db.a.actionType]=this.kVi(Gc.groupType,Gc.resultType);sd[db.a.resultType]=G[Gc.resultType];sd[db.a.sNe]=gc[Gc.sNe];sd[db.a.groupType]=N.a[Gc.groupType];sd[db.a.R6a]=Gc.R6a.toString();sd[db.a.ARd]=Gc.ARd.toString();sd[db.a.resultIndex]=
Gc.resultIndex.toString();this.AU.Ema(u.a.click,sd,this.mY)}nTj($a,vb){this.Boa.r7||(this.Boa.r7=Jc.a.create().toString(),this.Nzg("",!1,vb));vb=this.cV(u.a.JPf);vb[db.a.Gdb]=$a;this.AU.SHa(u.a.JPf,vb)}Xzg($a,vb,bc){if($a){if(bc)for(let Cc in bc)$a[Cc]=bc[Cc];this.AU.SHa(u.a.events,$a,vb)}}LDa($a,vb,bc=null){const Cc=this.cV(u.a.events);Cc[db.a.event]=$a;this.Xzg(Cc,Math.round(vb),bc)}J5b($a,vb,bc=null){const Cc=this.cV(u.a.events);Cc[db.a.event]=u.a.error;Cc[db.a.module]=$a;Cc[db.a.errorMessage]=
vb;Cc[db.a.message]=vb;this.Xzg(Cc,Math.round(window.performance.now()),bc)}hTj($a){const vb=this.cV(u.a.YNf);vb[db.a.value]=$a;vb[db.a.Fbd]=this.TKa;this.AU.Ema(u.a.YNf,vb,this.mY)}ISj($a){const vb=this.cV(u.a.tzf);vb[db.a.value]=$a;vb[db.a.Fbd]=this.TKa;this.AU.Ema(u.a.tzf,vb,this.mY)}PTj($a){const vb=this.cV(u.a.L1f);vb[db.a.value]=$a;vb[db.a.Fbd]=this.TKa;this.AU.Ema(u.a.L1f,vb,this.mY)}aVj($a){const vb=this.cV(u.a.J6g);vb[db.a.value]=$a;vb[db.a.Fbd]=this.TKa;this.AU.Ema(u.a.J6g,vb,this.mY)}XSj($a){const vb=
this.cV(u.a.tih);vb[db.a.value]=$a;this.AU.Ema(u.a.tih,vb,this.mY)}dVj($a,vb){const bc=this.cV(u.a.Y6g);bc[db.a.FDb]=$a;vb&&(bc[db.a.r7]=vb);this.AU.SHa(u.a.Y6g,bc)}cV($a){return{["SessionID"]:this.Boa.sessionId,["CorrelationID"]:this.Boa.r7,["Time"]:(new Date).getTime(),["Event"]:$a,["Scenario"]:this.mY}}}Object(J.a)(rb,"UsageLogger",null,[984]);var cc=d(94);class jb{}jb.Callback="action";Object(J.a)(jb,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var Xb=d(524),yb=d(79),mb=d(132),Ub=d(481),
ec=d(231),nc=d(55),Lb=d(267),Zc=d(70),Pb=d(35);d.d(V,"TellMeActor",function(){return eb});class eb{constructor(){this.Cya=this.qR=this.Kd=this.mb=this.l5=this.IF=this.Md=this.Da=this.Ld=this.MC=this.bxd=this.bzf=this.faa=this.ub=null;this.hkb=!1;this.Ppd=[];this.RXe=[];this.Idf=[];this.Jdf=[];this.u$e=!1;this.Iib=this.d2a=null;this.CNb=this.oya=!1;this.Ytc=!0;this.XO=this.Wrc=this.q3e=this.mxd=this.Adf=null;this.J0=[];this.hKa=this.bjb=this.ofa=null;this.Rjb=!1;this.gxd=0;this.zib=null;this.eaa=-1;
this.jdf=0;this.JNb=!1;this.rKa=null;this.Wxf=!1;this.qM=null}get vFc(){return this.l5?this.l5.contentType:eb.unknown}get actions(){return this.J0}set actions($a){this.J0=$a}rNc(){return this.Ld?this.Ld.Zla.r7:null}hG(){return this.ub}get Nak(){return this.Ytc}get Axl(){return this.Adf}performance(){return this.MC}get unc(){return this.Wxf}set unc($a){this.Wxf=$a}GF($a){const vb=window.performance.now();this.d2a&&!P.b($a)&&(this.d2a($a),this.Ld.MI(u.a.GF,window.performance.now()-vb))}initialize($a,
vb=null,bc=null,Cc=null,Gc=null,sd=null,Sd=null,ie=null,De=null,yd=null,ib=null){const {InteractionLogger:dc}=d(1100),{GroupsPlacementInfo:Bc}=d(1097),{AggregatorResultsProvider:Ob}=d(966);this.ub=$a;this.oya=!!Q.AFrameworkApplication.Ba&&Q.AFrameworkApplication.Ba.jb.evb;this.Ld=Cc;if(!Cc){Cc=new y;Cc.sessionId=Q.AFrameworkApplication.userSessionId;const yc=Lb.a.re(Q.AFrameworkApplication.lcid)||Lb.a.J2b;this.Ld=new dc(new rb(this.ub.application,yc.name,Cc,this.ub.mo,this.oya,$a.$wa,null),this.ub.lsi,
this.ub)}this.Cya=new M(this.ub.parameterData);this.bzf=bc||new ab(this.ub,this.Cya);this.d2a=Sd;this.bxd=this.bxd||new oa(this.ub,this.ub.parameterData,Sd);this.Kd=cc.FocusManager.instance();this.qR=Y.createInstance(this.ub);this.q3e=new Bc($a);this.Da=Gc||Q.AFrameworkApplication.Va;this.Md=sd||Q.AFrameworkApplication.ve;this.IF=De;this.faa=vb;this.qM=ib;this.MC=new ya;De?De.execute(yc=>{yc.isFeatureEnabled(eb.jil,!0).then(fc=>{const {AggregatorResultsProvider:Nb}=d(966);this.JNb=fc;this.faa=this.faa||
Nb.createInstance(this.qR,this.ub,this.Cya,this.JNb);return null})}):(this.JNb=!0,this.faa=this.faa||Ob.createInstance(this.qR,this.ub,this.Cya,this.JNb));this.mb=ie;this.ofa=ab.pHc;this.Adf=new Promise(yc=>{this.mxd=yc});yd&&yd.execute(yc=>{this.l5=yc});this.ub.mo&&I.a.Nvg()&&($a=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.ub.application),appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText($a,$a)))}wb(){this.q0h()}q0h(){this.Da.ra(Pb.a.tellMe,Zc.a.frame,Object(h.a)(this,
this.tellMe,"tellMe"),96);this.Da.ra(Pb.a.COe,Zc.a.frame,Object(h.a)(this,this.FJf,"cacheAsyncMenuRefreshFunction"),96);this.Da.ra(Pb.a.GOe,Zc.a.frame,Object(h.a)(this,this.iAg,"logItemExecuted"),96);this.Da.ra(Pb.a.JOe,Zc.a.frame,Object(h.a)(this,this.Szg,"logControlDeactivation"),96);this.Da.ra(Pb.a.IOe,Zc.a.frame,Object(h.a)(this,this.eAg,"logInputFocus"),96);this.Da.ra(Pb.a.FOe,Zc.a.frame,Object(h.a)(this,this.Jtb,"interactionBegin"),96);this.Da.ra(Pb.a.LOe,Zc.a.frame,Object(h.a)(this,this.Jtb,
"interactionBegin"),96);this.Da.ra(Pb.a.HOe,Zc.a.frame,Object(h.a)(this,this.dAg,"logInputBlur"),96);this.Da.ra(Pb.a.KOe,Zc.a.frame,Object(h.a)(this,this.Rzg,"logControlActivated"),96);this.Da.ra(Pb.a.qjd,Zc.a.frame,Object(h.a)(this,this.F3f,"focusSearchBox"),96);this.Da.ra(Pb.a.BOe,Zc.a.frame,Object(h.a)(this,this.bPf,"constructLiveNotificationForMenu"),96);this.Da.ra(Pb.a.NOe,Zc.a.frame,Object(h.a)(this,this.v6d,"insertTryQuery"),96);this.Da.ra(Pb.a.obe,Zc.a.frame,Object(h.a)(this,this.v6d,"insertTryQuery"),
96);this.Da.ra(Pb.a.FUd,Zc.a.frame,Object(h.a)(this,this.jva,"openOrInsertUrl"),96);this.Da.ra(Pb.a.GUd,Zc.a.frame,Object(h.a)(this,this.jva,"openOrInsertUrl"),96);this.Da.ra(Pb.a.HUd,Zc.a.frame,Object(h.a)(this,this.jva,"openOrInsertUrl"),96);this.Da.ra(Pb.a.IUd,Zc.a.frame,Object(h.a)(this,this.jva,"openOrInsertUrl"),96);this.Da.ra(Pb.a.JUd,Zc.a.frame,Object(h.a)(this,this.jva,"openOrInsertUrl"),96);this.Da.ra(Pb.a.hwe,Zc.a.frame,Object(h.a)(this,this.jva,"openOrInsertUrl"),96);this.Da.ra(Pb.a.iwe,
Zc.a.frame,Object(h.a)(this,this.jva,"openOrInsertUrl"),96);this.Da.ra(Pb.a.jwe,Zc.a.frame,Object(h.a)(this,this.jva,"openOrInsertUrl"),96);this.Da.ra(Pb.a.qxe,Zc.a.frame,Object(h.a)(this,this.v2b,"insertMention"),96);this.Da.ra(Pb.a.rxe,Zc.a.frame,Object(h.a)(this,this.v2b,"insertMention"),96);this.Da.ra(Pb.a.sxe,Zc.a.frame,Object(h.a)(this,this.v2b,"insertMention"),96);this.Da.ra(Pb.a.EOe,Zc.a.frame,Object(h.a)(this,this.A0g,"openFeedback"),96);this.Da.ra(Pb.a.OOe,Zc.a.frame,Object(h.a)(this,this.jva,
"openOrInsertUrl"),96);this.Da.ra(Pb.a.JGd,Zc.a.frame,Object(h.a)(this,this.Jvb,"launchAddin"),96);this.Da.ra(Pb.a.KGd,Zc.a.frame,Object(h.a)(this,this.Jvb,"launchAddin"),96);this.Da.ra(Pb.a.LGd,Zc.a.frame,Object(h.a)(this,this.Jvb,"launchAddin"),96);this.Da.ra(Pb.a.Yfb,Zc.a.frame,Object(h.a)(this,this.Yfb,"showTellMeCoachmark"),96);this.Da.ra(Pb.a.gbe,Zc.a.frame,Object(h.a)(this,this.yyg,"launchAddinStore"),96)}EHk($a){this.Ytc=!1;const vb=window.performance.now();$a.R7.isCompleted?(this.Ytc=!0,
this.mxd(!0)):$a.yM(()=>{this.Ytc=!0;this.mxd(!0);this.Ld.MI(u.a.aDi,window.performance.now()-vb)});this.kIk($a)}kIk($a){ec.a.Xbd(Object(h.a)(this,this.oFi,"dispatcher"));ec.a.dYb([new Ub.a(Pb.a.tellMe,Zc.a.frame,96),new Ub.a(Pb.a.COe,Zc.a.frame,96),new Ub.a(Pb.a.GOe,Zc.a.frame,96),new Ub.a(Pb.a.JOe,Zc.a.frame,96),new Ub.a(Pb.a.IOe,Zc.a.frame,96),new Ub.a(Pb.a.FOe,Zc.a.frame,96),new Ub.a(Pb.a.LOe,Zc.a.frame,96),new Ub.a(Pb.a.HOe,Zc.a.frame,96),new Ub.a(Pb.a.KOe,Zc.a.frame,96),new Ub.a(Pb.a.qjd,Zc.a.frame,
96),new Ub.a(Pb.a.BOe,Zc.a.frame,96),new Ub.a(Pb.a.NOe,Zc.a.frame,96),new Ub.a(Pb.a.obe,Zc.a.frame,96),new Ub.a(Pb.a.FUd,Zc.a.frame,96),new Ub.a(Pb.a.GUd,Zc.a.frame,96),new Ub.a(Pb.a.HUd,Zc.a.frame,96),new Ub.a(Pb.a.IUd,Zc.a.frame,96),new Ub.a(Pb.a.JUd,Zc.a.frame,96),new Ub.a(Pb.a.hwe,Zc.a.frame,96),new Ub.a(Pb.a.iwe,Zc.a.frame,96),new Ub.a(Pb.a.jwe,Zc.a.frame,96),new Ub.a(Pb.a.qxe,Zc.a.frame,96),new Ub.a(Pb.a.rxe,Zc.a.frame,96),new Ub.a(Pb.a.sxe,Zc.a.frame,96),new Ub.a(Pb.a.EOe,Zc.a.frame,96),new Ub.a(Pb.a.OOe,
Zc.a.frame,96),new Ub.a(Pb.a.JGd,Zc.a.frame,96),new Ub.a(Pb.a.KGd,Zc.a.frame,96),new Ub.a(Pb.a.LGd,Zc.a.frame,96),new Ub.a(Pb.a.Yfb,Zc.a.frame,96),new Ub.a(Pb.a.gbe,Zc.a.frame,96)],$a)}oFi($a,vb,bc,Cc,Gc){if(vb.contextId===Zc.a.frame)switch($a){case Pb.a.tellMe:return this.tellMe($a,vb,bc,Cc,Gc);case Pb.a.COe:return this.FJf($a,vb,bc,Cc,Gc);case Pb.a.GOe:return this.iAg($a,vb,bc,Cc,Gc);case Pb.a.JOe:return this.Szg($a,vb,bc,Cc,Gc);case Pb.a.IOe:return this.eAg($a,vb,bc,Cc,Gc);case Pb.a.FOe:return this.Jtb($a,
vb,bc,Cc,Gc);case Pb.a.LOe:return this.restoreFocus($a,vb,bc,Cc,Gc);case Pb.a.HOe:return this.dAg($a,vb,bc,Cc,Gc);case Pb.a.KOe:return this.Rzg($a,vb,bc,Cc,Gc);case Pb.a.qjd:return this.F3f($a,vb,bc,Cc,Gc);case Pb.a.BOe:return this.bPf($a,vb,bc,Cc,Gc);case Pb.a.NOe:case Pb.a.obe:return this.v6d($a,vb,bc,Cc,Gc);case Pb.a.FUd:case Pb.a.GUd:case Pb.a.HUd:case Pb.a.IUd:case Pb.a.JUd:case Pb.a.hwe:case Pb.a.iwe:case Pb.a.jwe:case Pb.a.OOe:return this.jva($a,vb,bc,Cc,Gc);case Pb.a.qxe:case Pb.a.rxe:case Pb.a.sxe:return this.v2b($a,
vb,bc,Cc,Gc);case Pb.a.EOe:return this.A0g($a,vb,bc,Cc,Gc);case Pb.a.JGd:case Pb.a.KGd:case Pb.a.LGd:return this.Jvb($a,vb,bc,Cc,Gc);case Pb.a.Yfb:return this.Yfb($a,vb,bc,Cc,Gc);case Pb.a.gbe:return this.yyg($a,vb,bc,Cc,Gc)}return 2}F3f($a,vb,bc){if(1===bc)return 32;this.dlh();$a=!1;(this.ub.$wa||this.oya)&&(vb=document.getElementById("SearchButton"))&&vb.click();if(!this.ub.$wa&&this.oya)for(vb=document.getElementsByClassName("ms-suiteux-search-box"),bc=0;bc<vb.length;bc++){const Cc=vb[bc].querySelector("input[type=search]");
Cc&&($a=cc.FocusManager.xr(Cc))}else $a=cc.FocusManager.xr($get(this.ub.mo?v.CuiHelper.VLe:v.CuiHelper.MOe));this.CNb=!0;return $a?32:8}v6d($a,vb,bc,Cc,Gc){if(1===bc)return 32;if(P.b(Gc))return this.Ld.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.dlh();$a=Gc.CommandValueId;vb=this.ub.mo?v.CuiHelper.VLe:v.CuiHelper.MOe;this.ub.mo&&!P.b(Gc[Xb.a.qea])&&(Gc[Xb.a.qea]=!1);if($a){if(this.ub.mo)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText($a)),this.rKa=
[19],32;if(Gc=$get(vb))Gc.value=$a}return cc.FocusManager.xr($get(vb))?32:8}dlh(){this.Kd.hX(this.ub.$wa||this.oya?this.ub.SOc:this.ub.LHa,!1)}fVi($a,vb){switch($a){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,vb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,vb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,vb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
vb)}return vb}bPf($a,vb,bc,Cc,Gc){if(1===bc)return 32;if(P.b(Gc))return this.Ld.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;$a=this.ofa?this.ofa.Jeh:0;Gc.Value=1!==$a?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,$a):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.ofa)for(const sd of this.ofa.BFi)Gc=Object(e.a)(K.a,sd)?sd.id:ka.a.replaceAll(sd.value,'"',""),(Gc=$get(Gc+"-"+I.a.DOe))&&mb.a.mO(Gc,mb.a.ht,ka.a.le(this.fVi(sd.groupType,
Gc.innerText)));return 32}FJf($a,vb,bc,Cc,Gc){if(1===bc)return 32;if(P.b(Gc))return this.Ld.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.zib=new yb.a(2,1,0,()=>{Gc[jb.Callback]()},97);this.ofa&&this.Md.Hb(this.zib);return 32}iAg($a,vb,bc,Cc,Gc){if(1===bc)return 32;if(P.b(Gc))return this.Ld.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;Gc.CloseAllMenus&&($a=void 0===Gc.ParentControlId||null===Gc.ParentControlId?"<NA>":Gc.ParentControlId,vb=
this.Iib?this.Iib[Gc.ControlId]:null,!vb&&this.Iib&&"<NA>"!==$a&&(vb=this.Iib[$a]),vb||(vb=this.hkb&&this.qR.jCj(Gc),vb=this.VDi(vb,Gc.ControlId),vb=new A(vb,28,4,-1,-1,-1),this.Ld.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+Gc.ControlId+" determined group:"+N.a[vb.groupType])),this.Ld.Zfk(Gc.ControlId,$a,Gc.CommandId,Gc.CloseAllMenus,vb),this.Cya.odk(Gc.ControlId),Gc.Location!==Da.a.contextMenu&&(this.qR.EYh(Gc),this.qR.TC(vb.resultType),this.ub.Ugd&&this.faa.OZh(Gc.CommandId)));
return 32}Szg($a,vb,bc,Cc,Gc){if(1===bc)return 32;E.a.vMj()&&(new ra(this.rNc())).D8i(this.bjb);$a=this.bjb;vb=this.eaa;bc=this.Ld.cqc;if(P.b(Gc))return this.Ld.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;Gc=Gc.UILocation;$a&&0<$a.length&&this.JNb&&I.a.cKe(this.ub)&&this.ub.MTc&&19!==Gc&&vb>bc&&!this.ub.hJ&&(this.Ld.oce($a),this.Ld.BHe(vb));this.Ld.cRk();this.ub.hmd&&19!==Gc&&(this.MC.mark(3),this.MC.measure(1,0,3),this.MC.measure(2,2,3),this.MC.dce(0,1,2),this.MC.dce(2,
2,3),this.MC.dce(1,0,3),this.MC.UCc([0,1,2,3]),this.MC.clearMeasures([0,2,1]));this.Ld.kgk(window.performance.now()-this.gxd);this.ub.mo&&(this.hKa=null,this.Ld.WXg());this.CNb=this.Rjb=!1;this.bjb="";return 32}eAg($a,vb,bc){if(1===bc)return 32;this.Ld.XXg(x(vb),this.CNb);return 32}dAg($a,vb,bc){if(1===bc)return 32;this.Ld.WXg();this.Rjb=!1;return 32}Rzg($a,vb,bc,Cc,Gc){if(1===bc)return 32;this.XO=null;Gc&&(this.XO=Gc);this.ub.hmd&&(P.b(this.XO)||this.XO.Location!==Da.a.contextMenu)&&this.MC.mark(0);
this.Ld.Wfd(P.b(this.XO)||P.b(this.XO.Location)?Da.a.unknown:this.XO.Location);this.Ld.jgk(this.jdf,this.CNb);this.Rjb||this.Pcc();return 32}eRf($a,vb){const bc=[],Cc=Date.now();for(let Gc of $a)$a=(Cc-Gc.timeStamp)/1E3,$a=I.a.xQe($a),Array.add(bc,new ca(vb?Gc.commandId:Gc.controlId,$a));return bc}DRf($a=!1){var vb=$a?this.qR.A8i():this.qR.d_b();$a=[];const bc=Date.now();for(const Cc of vb)vb=(bc-Cc.TimeStamp)/1E3,vb=I.a.xQe(vb),Array.add($a,new ca(Cc.Id,vb));return $a}Pcc(){if(!this.Rjb){this.hkb=
this.Rjb=!0;""!==this.ub.jhh&&Q.AFrameworkApplication.Pj(this.ub.jhh);if(!this.u$e){this.u$e=!0;const $a={};$a.IsMLREnabled=this.ub.OGj;$a.IsReactRibbonEnabled=this.ub.mo;$a.IsSharedHeaderEnabled=!!Q.AFrameworkApplication.Ba&&Q.AFrameworkApplication.Ba.jb.kN;$a.IsSearchUxEnabled=this.oya;$a.IsTellMeInHeaderEnabled=this.ub.$wa;$a.IsGoLocalEnv=I.a.Psg();$a.IsSovereignEnvironment=I.a.J8a();$a.IsTellMeServiceResultsEnabled=I.a.cKe(this.ub);$a.IsSubstrateProviderEnabled=I.a.bKe(this.ub);$a.ShouldFetchTokens=
!!Q.AFrameworkApplication.Ba&&Q.AFrameworkApplication.Ba.jb.zGb;$a.IsSerpletEnabled=I.a.Yia();$a.FirstOnClickTimeInMS=Math.round(window.performance.now());$a.IsHeaderHidden=Q.AFrameworkApplication.hideHeader||Q.AFrameworkApplication.LP;$a.IsSearchInHeaderHidden=Q.AFrameworkApplication.ePc;void 0!==window.performance.timing&&null!==window.performance.timing&&($a.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));$a.IsFindWithMatchesEnabled=this.ub.a2f;$a.HelpShowsTopSearchResult=
this.ub.bkc;$a.HelpShowsNumberOfMatches=this.ub.akc;Q.AFrameworkApplication.fa&&($a.UiHost=Q.AFrameworkApplication.fa.Ia("UiHostIntegrationType"));this.Ld.wVj(JSON.stringify($a))}this.Ppd=this.eRf(r.a.instance.ZKb,!1);this.RXe=this.eRf(r.a.instance.Hib,!0);this.Idf=this.DRf();this.Jdf=this.DRf(!0);this.Ld.Pcc()}}Jtb($a,vb,bc,Cc,Gc){if(1===bc)return 32;if(P.b(Gc))return this.Ld.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(nc.a.IV)return 32;this.gxd=window.performance.now();
this.Pcc();$a=new ea(Object(h.a)(this,this.Eda,"onRequestCompleted"),0);this.eaa++;this.Ld.beginQuery("",this.eaa,this.hkb);this.ofa=ab.pHc;this.hKa=oa.CSd;if(this.faa)eb.instance.actions=[],this.faa.oD(new W("",this.eaa),$a,this.ub.mo);else this.Ld.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.zib&&this.Md.Hb(this.zib);return 32}restoreFocus($a,vb,bc){if(1===bc)return 32;this.Kd.n4(this.ub.$wa||this.oya?this.ub.SOc:this.ub.LHa,!1);return 32}tellMe($a,vb,bc,
Cc,Gc){if(1===bc)return 32;if(P.b(Gc))return this.Ld.onError("TellMeActor:TellMe","actiondata comes null"),16;this.XO=Gc;this.Ld.Wfd(P.b(this.XO.Location)?Da.a.unknown:this.XO.Location);$a=this.XO.Value;this.ub.mo||$a&&""!==$a.trim()?(!this.hKa&&this.ub.mo&&(this.Ld.XXg(x(vb),this.CNb),this.Pcc()),this.TLi($a,this.XO.Location),this.XO.PopulationXML=this.ofa.xml):this.hkb?this.XO.PopulationXML=this.ofa.xml:(this.XO.PopulationXML=ab.pHc.xml,this.hKa=oa.CSd,this.bjb="");return 32}TLi($a,vb){this.gxd=
window.performance.now();this.ub.hmd&&vb!==Da.a.contextMenu&&this.MC.mark(1);this.ub.mo&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText($a));$a&&0<$a.trim().length&&(this.hkb=!1);this.ub.MKi();vb=P.b(vb)?Da.a.tellMe:vb;if($a!==this.bjb||this.ub.mo){this.eaa++;this.Ld.beginQuery($a,this.eaa,this.hkb);const bc=new W($a,this.eaa),Cc=new ea(Object(h.a)(this,this.Eda,"onRequestCompleted"),this.eaa);this.ofa=ab.pHc;this.hKa=oa.CSd;if(this.faa)eb.instance.actions=[],this.faa.oD(bc,Cc,this.ub.mo,
vb,this.rKa),this.rKa=null;else this.Ld.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.jdf=this.eaa;this.bjb=$a}}fsl($a){if(this.ub.mo){var vb=appChrome.selectors.getActiveControlStates();if(vb=Object(m.a)(Object,vb[$a.value])){$a.label=vb.label;let bc=null;"description"in vb&&(bc=vb.description);bc&&Object.getType(bc)===String?$a.description=bc:"secondaryText"in vb?$a.description=vb.secondaryText:"fullDescriptionLabel"in vb&&($a.description=vb.fullDescriptionLabel)}}}xtk($a){this.Iib=
{};let vb=0,bc=0;for(const Cc of $a){$a=0;for(const Gc of Cc.results)this.Iib[Gc.value]=new A(Gc.groupType,Gc.type,Gc.subType,vb,$a,bc),$a++,bc++,Gc.label||5!==Gc.type||this.fsl(Gc);0<$a&&vb++}}lCb($a,vb,bc,Cc,Gc){if(1===bc)return 32;if(P.b(Gc))return this.Ld.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;($a=Gc.CommandValueId)&&window.open($a,"_blank");return 32}v2b($a,vb,bc,Cc,Gc){if(1===bc)return 32;if(P.b(Gc))return this.Ld.onError("TellMeActor:InsertMention","actiondata comes null"),
16;$a=Gc.UILocation;let sd;Gc=Gc.CommandValueId;try{sd=ma.a(Gc)}catch(Sd){return this.Ld.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return P.b(sd)?(this.Ld.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):P.b(this.Wrc)?(this.Ld.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==$a?(this.Ld.onError("TellMeActor:InsertMention","location "+$a+" is unexpected"),16):this.Wrc.v2b(sd.displayName,sd.email,sd.userId)?
32:(this.Ld.onError("TellMeActor:InsertMention","mention is not inserted"),16)}jva($a,vb,bc,Cc,Gc){return 1===bc?32:P.b(Gc)?(this.Ld.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Gc.UILocation?this.Vxj(bc,Gc):this.lCb($a,vb,bc,Cc,Gc)}A0g($a,vb,bc,Cc,Gc){if(1===bc)return 32;if(P.b(Gc))return this.Ld.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.qM&&this.qM.execute(sd=>{sd.RGb("TellMeSurvey",null)});return 32}Vxj($a,vb){if(1===$a)return 32;if(P.b(vb))return this.Ld.onError("TellMeActor:InsertUrl",
"actiondata comes null"),16;if(P.b(this.Wrc))return this.Ld.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;$a=vb.CommandValueId;return P.b($a)?(this.Ld.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.Wrc.insertHtmlText($a)?32:(this.Ld.onError("TellMeActor:InsertUrl","url is not inserted"),16)}Eda($a,vb,bc,Cc,Gc){bc=window.performance.now();this.xtk(vb);this.Ld.y0k(vb);this.ub.mo?(this.hKa=this.bxd.QUi(vb,$a,Gc),this.ub.lia?(this.J0.push(appChrome.actions.updateTellMeSearchResults(this.hKa.menuModel,
$a,Gc)),appChrome.api.dispatch(this.J0)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.hKa.menuModel,$a,Gc)),this.ub.hmd&&this.Rjb&&(P.b(this.XO)||this.XO.Location!==Da.a.contextMenu)&&(this.MC.mark(2),this.MC.measure(0,1,2))):this.ofa=this.bzf.RUi(vb,this.Ld.Zla);this.zib&&this.Md.Hb(this.zib);Gc={};Gc.GroupsCount=vb.length;Gc.QueryID=Cc;Gc.QueryLength=$a.length;this.Ld.MI(u.a.pyi,window.performance.now()-bc,Gc)}VDi($a,vb){return vb.startsWith(this.ub.mo?I.a.aRe:I.a.Pkd)?
5:$a?4:"bSearchHelp"===vb||vb.startsWith("GetHelpFromTellMe")?8:"bInsights"===vb||vb.startsWith("SmartLookupFromTellMe")?13:vb===this.ub.$1f?2:0}TC($a,vb){this.faa&&this.faa.TC($a,vb)}yyg($a,vb,bc,Cc,Gc){return this.Da.Ma(Pb.a.CPj,2,Gc)}Jvb($a,vb,bc,Cc,Gc){({AddinResultsProvider:$a}=d(695));Gc=Gc.CommandValueId;if(P.a(Gc))return this.Ld.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!$a.K2a[Gc])return this.Ld.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Gc+" doesn't not exist in entitlements"),
16;$a=d(695).AddinResultsProvider.K2a[Gc];vb={};vb.solutionId=$a.id;vb.version=$a.appVersion;vb.storeType=$a.storeType;vb.storeId=$a.storeId;vb.assetId=$a.assetId;vb.assetStoreId=$a.assetStoreId;vb.displayName=$a.displayName;vb.targetType=$a.targetType;vb.height=$a.height;vb.width=$a.width;$a=this.Da.Ma(Pb.a.uxj,2,vb);if(32!==$a)this.Ld.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+$a+". AssetId: "+Gc);return $a}Yfb(){if(!P.b(this.qM))for(let $a of r.a.instance.Hib){if("ShowContextMenuWithFloatie"===
$a.commandId)return this.qM.execute(vb=>{vb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if($a.commandId&&-1===$a.commandId.indexOf("Tab"))break}return 8}static get instance(){return eb.Ka||(eb.Ka=new eb)}}eb.Ka=null;eb.jil="mso_tellMeService";eb.unknown="Unknown";Object(J.a)(eb,"TellMeActor",null,[])},1196:function(J,V,d){d.r(V);var h=d(0),e=d(25),m=d(69),r=d(374),v=d(907),A=d(94),x=d(57),y=d(1153),u=d(13),H=d(1188),G=d(91),E=d(66),I=d(178),Q=d(930),D=d(83);class Y{static get Wf(){return D.a.tA(Y.Ym,
Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Y.Ym="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";Object(h.a)(Y,"InsertSymbolsDialogHtml",null,[]);var M=d(32),N=d(211);class W extends H.a{constructor(Ia,tb,Qb){super();
this.obf=this.Qoa=this.lMa=null;this.Qtd=0;this.Da=Ia;this.Kd=tb;this.eza=Qb;this.Pe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Pe(0,CommonUIStrings.l_DialogClose);this.mR=!1;this.Wf=Y.Wf;this.kg="InsertSymbolsDialog"}dispose(){0<W.KDd&&r.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.Qtd,W.KDd);W.VZe++;r.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",W.VZe);this.Da=this.eza=null;super.dispose()}MT(){this.qj(Box4Intl.Box4Strings.L_SymbolSingle,
Object(u.a)(this,this.Sxj,"insertSymbolsDialogHandler"),null);this.Qtd=0;W.$Ze++;r.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",W.$Ze);const Ia=this.$0d("symbol_d_"+W.$Nb);Ia&&Ia.focus()}hide(){var Ia=document.getElementById("symbolsContainer");if(Ia&&(Ia=Ia.getElementsByTagName("a")))for(let tb=0;tb<Ia.length;tb++)G.a.removeHandler(Ia[tb],E.a.focus,Object(u.a)(this,this.dth,"symbolFocusHandler"));super.hide()}Sxj(Ia){1===Ia?(this.$ue("symbol_d_"+W.$Nb),this.Kd.hX(this.kK,
!0),this.Kd.Mk().gj.aE(this.AC),this.AC.focus()):this.hide()}get Hvb(){return W.Jbf}set Hvb(Ia){W.Jbf=Ia}get Dvb(){return W.wbf}set Dvb(Ia){W.wbf=Ia}Yua(){super.Yua();var Ia=document.getElementById("symbolsContainer");if(Ia&&(Q.a.Gfd(Ia,this.eza.Cci(),"InsertSymbolsDialog"),Ia=Ia.getElementsByTagName("a")))for(let tb=0;tb<Ia.length;tb++)G.a.addHandler(Ia[tb],E.a.focus,Object(u.a)(this,this.dth,"symbolFocusHandler"))}q6(){const Ia=document.getElementById("symbolsContainer");Ia&&(this.lMa||(this.lMa=
Object(u.a)(this,this.mgl,"symbolClickHandler"),this.Rm.pb(E.a.click,Ia,this.lMa),this.Rm.pb(E.a.doubleClick,Ia,this.lMa)),this.Qoa||(this.Qoa=Object(u.a)(this,this.ogl,"symbolKeyHandler"),this.Kg.pb(E.a.Rf,Ia,this.Qoa),this.Kg.pb(E.a.zx,Ia,this.Qoa),this.Kg.pb(E.a.ol,Ia,this.Qoa)));super.q6()}pqa(){const Ia=document.getElementById("symbolsContainer");Ia&&(this.lMa&&(this.Rm.zb(E.a.click,Ia,this.lMa),this.Rm.zb(E.a.doubleClick,Ia,this.lMa),this.lMa=null),this.Qoa&&(this.Kg.zb(E.a.Rf,Ia,this.Qoa),
this.Kg.zb(E.a.zx,Ia,this.Qoa),this.Kg.zb(E.a.ol,Ia,this.Qoa),this.Qoa=null));super.pqa()}mlk(Ia){this.elh("symbol_d_"+W.$Nb,!1);W.$Nb=parseInt(Ia.substr(Ia.lastIndexOf("_")+1));this.elh(Ia,!0);if(Ia=document.getElementById("SymbolNameValueLabel")){const tb=this.lNc(W.$Nb);Ia.innerText=tb.altText}}lNc(Ia){const tb=this.eza.nlc.Mid.value,Qb=N.a(tb);return tb[Qb[Ia]]}dth(Ia){if(Ia.target!==this.obf){const tb=this.Kd.Mk();tb&&tb.gj&&(tb.gj.aE(Ia.target),this.obf=Ia.target)}this.mlk(Ia.target.id)}mgl(Ia){const tb=
Ia.Hc;if("a"!==tb.tagName.toLowerCase())return!1;Ia.eventName===E.a.doubleClick&&this.$ue(tb.id);this.Kd.hX(this.kK,!0);this.Kd.Mk().gj.aE(tb);tb.focus();return!0}ogl(Ia){var tb=Ia.Hc;if("a"!==tb.tagName.toLowerCase())return!1;const Qb=parseInt(tb.id.substr(tb.id.lastIndexOf("_")+1));if(Ia.nc.ctrlKey||Ia.nc.altKey||Ia.nc.keyCode>=I.a.KJb&&Ia.nc.keyCode<=I.a.GJa)return!1;if(Ia.eventName===E.a.Rf){Ia=Ia.nc.keyCode;let qc=-1;Ia===Sys.UI.Key.enter?(this.$ue(tb.id),this.Kd.hX(this.kK,!0),this.Kd.Mk().gj.aE(tb),
tb.focus()):Ia===Sys.UI.Key.up?qc=Qb-15:Ia===Sys.UI.Key.down?qc=Qb+15:Ia===Sys.UI.Key.left?qc=e.AFrameworkApplication.isRtl?Qb+1:Qb-1:Ia===Sys.UI.Key.right&&(qc=e.AFrameworkApplication.isRtl?Qb-1:Qb+1);0<=qc&&(tb=this.$0d("symbol_d_"+qc))&&tb.focus()}return!0}$ue(Ia){this.Qtd++;W.KDd++;Ia=parseInt(Ia.substr(Ia.lastIndexOf("_")+1));const tb=this.lNc(Ia),Qb={};Qb.SourceControlId="symbol_"+Ia+"_"+tb.Lid;this.Da.Ma(M.a.$Qa,2,Qb);r.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",
Ia)}$0d(Ia){const tb=document.getElementById("symbolsContainer");return tb?tb.querySelector("#"+Ia):null}elh(Ia,tb){(Ia=this.$0d(Ia))&&(tb?Ia.setAttribute("selected","true"):Ia.removeAttribute("selected"))}}W.$Nb=0;W.Jbf=null;W.wbf=null;W.$Ze=0;W.VZe=0;W.KDd=0;Object(h.a)(W,"InsertSymbolsDialog",H.a,[]);var K=d(41),ca=d(50),P=d(38),ea=d(181),da=d(121);class ia{constructor(Ia,tb,Qb,qc,Lc,Jd,le,je){this.Da=Ia;this.EJ=tb;this.GUh=new y.a(Object(u.a)(this,this.Acj,"getSymbolsDropDownMenuProps"));this.HUh=
new y.a(Object(u.a)(this,this.a1d,"getSymbolsDropDownXml"));this.OCd=qc.nlc.Mid;this.kk=Qb;this.eza=qc;this.KC=Lc;this.zO=Jd;this.Rc=le;this.jm=je}Acj(){return this.eza.odi()}a1d(){return this.eza.build()}wb(){this.Da.ra(M.a.lad,P.a.application,Object(u.a)(this,this.lad,"queryInsertSymbols"),96);this.Da.ya(M.a.TCb,P.a.view,Object(u.a)(this,this.TCb,"populateSymbolsDropDown"));this.Da.ya(M.a.SNe,P.a.view,Object(u.a)(this,this.eth,"symbolsDropDownOpenHandler"));this.Da.ya(M.a.cBe,P.a.view,Object(u.a)(this,
this.N7g,"querySymbolPositionHandler"));this.Da.ya(M.a.$Qa,P.a.view,Object(u.a)(this,this.MCa,"insertSymbolViewHandler"));this.Da.ya(M.a.TCb,P.a.Ff,Object(u.a)(this,this.TCb,"populateSymbolsDropDown"));this.Da.ya(M.a.SNe,P.a.Ff,Object(u.a)(this,this.eth,"symbolsDropDownOpenHandler"));this.Da.ya(M.a.cBe,P.a.Ff,Object(u.a)(this,this.N7g,"querySymbolPositionHandler"));this.Da.ya(M.a.$Qa,P.a.Ff,Object(u.a)(this,this.Rxj,"insertSymbolHandler"));this.Da.$d(M.a.TCb,1124);this.Da.$d(M.a.SNe,1036);this.Da.$d(M.a.cBe,
1124);this.Da.$d(M.a.$Qa,1036);e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&(this.Da.ya(M.a.Z5d,P.a.view,Object(u.a)(this,this.$oh,"showInsertMoreSymbolsDialogHandler")),this.Da.ya(M.a.Z5d,P.a.Ff,Object(u.a)(this,this.$oh,"showInsertMoreSymbolsDialogHandler")),this.Da.$d(M.a.Z5d,1124))}N7g(Ia,tb,Qb,qc,Lc){if(1===Qb)return 32;Ia=this.eza.o2g(Lc);Ia=String.format(this.eza.ngl,Ia.character);Lc[v.a.InnerHTML]=Ia;Lc[v.a.On]=!1;return 32}MCa(Ia,tb,Qb,qc,Lc){if(({Gf:Ia,
selected:Qb,MCa:je}=this.HTf(tb,Qb)).returnValue)return je;var Jd=K.SelectionEditor.Mg(Qb);let le=!0;Qb=8;var je=this.kk.ie(15);je.hd(Ia.ug);Jd||(Qb=this.Da.li(tb,M.a.HAa,2,!0,qc,null),tb=32===Qb,r.ULS.shipAssertTag(6407387,348,tb,"DeleteForReplace did not succeed. Response is {0}",Qb),le=tb);le&&(tb=Ia.Eb.Dj,Jd=K.SelectionEditor.Mg(tb),r.ULS.shipAssertTag(6407388,348,Jd,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",tb.contextId),Qb=8,Jd&&(Qb=this.Da.li(tb,M.a.$Qa,
2,!1,qc,Lc),r.ULS.shipAssertTag(6407389,348,32===Qb,"Insertion at IP context did not succeed. Response is {0}",Qb),32===Qb&&A.FocusManager.instance().vf(Ia.NH)));je.dispose();return Qb}HTf(Ia,tb){let Qb,qc;Qb=null;Ia.view.Jh&&(Qb=Ia.view);qc=null;return Qb&&Qb.Eb?(qc=Qb.Eb.Dj)?this.zO.ga(14)&&this.KC.R3a(qc)?{returnValue:!0,Gf:Qb,selected:qc,MCa:8}:Qb.Eb.Pa.uG||this.jm&&this.jm.instance&&this.jm.instance.EV(qc)||K.SelectionEditor.ZQc(Ia.HD)?{returnValue:!0,Gf:Qb,selected:qc,MCa:2}:1===tb?{returnValue:!0,
Gf:Qb,selected:qc,MCa:32}:{returnValue:!1,Gf:Qb,selected:qc,MCa:32}:{returnValue:!0,Gf:Qb,selected:qc,MCa:2}:(da.c(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Ia.toString()),{returnValue:!0,Gf:Qb,selected:qc,MCa:8})}Rxj(Ia,tb,Qb,qc,Lc){if(1===Qb)return 32;if(K.SelectionEditor.ZQc(tb))return 2;Ia=this.eza.o2g(Lc);qc.qP=Ia.index;qc=this.EJ.Jc(tb.node);Qb=qc.oc(11);r.ULS.shipAssertTag(6379466,324,Qb,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
ea.a[tb.node.type]);Qb=this.kk.ie(15);Qb.Ry(qc);ia.characterPropertiesEditor.replaceTextRange(tb,Ia.character,!0,!1);tb=ca.SelectionFactory.Lg(qc.currentNode,tb.Qa+1);this.Rc.setSelection(tb);Qb.dispose();return 32}TCb(Ia,tb,Qb,qc,Lc){if(1===Qb)return 32;e.AFrameworkApplication.Ba&&e.AFrameworkApplication.Ba.jb.Ip?Lc.MenuItems=this.GUh.value:Lc.PopulationXML=this.HUh.value;return 32}eth(Ia,tb,Qb){({MCa:Ia}=this.HTf(tb,Qb));return Ia}$oh(Ia,tb,Qb){2===Qb&&(new W(this.Da,A.FocusManager.instance(),x.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).MT();
return 32}lad(){return 32}static get characterPropertiesEditor(){return ia.Vg||(ia.Vg=x.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Ia){ia.Vg=Ia}}ia.Vg=null;Object(h.a)(ia,"SymbolsActor",null,[863]);class C{constructor(Ia,tb){this.Lid=Ia;this.altText=tb}}Object(h.a)(C,"Symbol",null,[]);class oa{constructor(){this.NCd=null;this.OCd=new y.a(oa.kPd)}get Mid(){return this.OCd}u3i(Ia){this.NCd||(this.NCd=N.a(this.OCd.value));return Array.indexOf(this.NCd,
Ia)}static kPd(){const Ia={};Ia["\u2022"]=new C("\u2022",Box4Intl.Box4Strings.L_Bullet);Ia["\u20ac"]=new C("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Ia["\u00a3"]=new C("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Ia["\u00a5"]=new C("\u00a5",Box4Intl.Box4Strings.L_YenSign);Ia["\u00a9"]=new C("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Ia["\u00ae"]=new C("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Ia["\u2122"]=new C("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Ia["\u00b1"]=new C("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);
Ia["\u2260"]=new C("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Ia["\u2264"]=new C("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Ia["\u2265"]=new C("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Ia["\u00f7"]=new C("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Ia["\u00d7"]=new C("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Ia["\u221e"]=new C("\u221e",Box4Intl.Box4Strings.L_Infinity);Ia["\u00b5"]=new C("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Ia["\u03b1"]=new C("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);
Ia["\u03b2"]=new C("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Ia["\u03c0"]=new C("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Ia["\u03a9"]=new C("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Ia["\u03a3"]=new C("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Ia["\u00b0"]=new C("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Ia["\u0394"]=new C("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Ia["\u263a"]=new C("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Ia["\u2665"]=new C("\u2665",
Box4Intl.Box4Strings.L_BlackHeartSuit);Ia["\u20b9"]=new C("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Ia["\u00bf"]=new C("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Ia["\u00a1"]=new C("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Ia["\u2014"]=new C("\u2014",Box4Intl.Box4Strings.L_EmDash);Ia["\u2026"]=new C("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Ia["\u00c0"]=new C("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Ia["\u00c1"]=new C("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);
Ia["\u00c2"]=new C("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Ia["\u00c3"]=new C("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Ia["\u00c4"]=new C("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Ia["\u00c5"]=new C("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Ia["\u00c6"]=new C("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Ia["\u00c7"]=new C("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Ia["\u00c8"]=
new C("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Ia["\u00c9"]=new C("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Ia["\u00ca"]=new C("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Ia["\u00cb"]=new C("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Ia["\u00cc"]=new C("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Ia["\u00cd"]=new C("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Ia["\u00ce"]=new C("\u00ce",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Ia["\u00cf"]=new C("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Ia["\u00d1"]=new C("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Ia["\u00d2"]=new C("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Ia["\u00d3"]=new C("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Ia["\u00d4"]=new C("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Ia["\u00d5"]=new C("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);
Ia["\u00d6"]=new C("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Ia["\u00d9"]=new C("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Ia["\u00da"]=new C("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Ia["\u00db"]=new C("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Ia["\u00dc"]=new C("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Ia["\u00df"]=new C("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Ia["\u00e0"]=
new C("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Ia["\u00e1"]=new C("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Ia["\u00e2"]=new C("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Ia["\u00e3"]=new C("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Ia["\u00e4"]=new C("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Ia["\u00e5"]=new C("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Ia["\u00e6"]=new C("\u00e6",
Box4Intl.Box4Strings.L_LatinSmallLetterAe);Ia["\u00e7"]=new C("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Ia["\u00e8"]=new C("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);Ia["\u00e9"]=new C("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Ia["\u00ea"]=new C("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Ia["\u00eb"]=new C("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Ia["\u00ec"]=new C("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);
Ia["\u00ed"]=new C("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Ia["\u00ee"]=new C("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Ia["\u00ef"]=new C("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Ia["\u00f1"]=new C("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Ia["\u00f2"]=new C("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Ia["\u00f3"]=new C("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Ia["\u00f4"]=new C("\u00f4",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Ia["\u00f5"]=new C("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Ia["\u00f6"]=new C("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Ia["\u00f9"]=new C("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Ia["\u00fa"]=new C("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Ia["\u00fb"]=new C("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Ia["\u00fc"]=new C("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);
Ia["\u00ff"]=new C("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Ia["\u011e"]=new C("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Ia["\u011f"]=new C("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Ia["\u0130"]=new C("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Ia["\u0131"]=new C("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Ia["\u0152"]=new C("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Ia["\u0153"]=new C("\u0153",
Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Ia["\u015e"]=new C("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Ia["\u015f"]=new C("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Ia["\u0178"]=new C("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Ia}}Object(h.a)(oa,"SymbolsLoader",null,[857]);var Z=d(45),pa=d(340),ya=d(289),Ja=d(220),Ka=d(770),ma=d(1184),ra=d(133),Da=d(72);class va{constructor(Ia){this.IUh=Ia}get nlc(){return this.IUh}get ngl(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}o2g(Ia){Ia=
Ia.SourceControlId.split("_");const tb={};2===Ia.length?(tb.character=Ia[1],tb.index=this.nlc.u3i(tb.character)):(tb.character=Ia[2],tb.index=parseInt(Ia[1]));return tb}odi(){return this.Bdg()}build(){return this.a1d()}Cci(){const Ia=new Sys.StringBuilder;Ia.append('<table class="moreSymbolsTable">');const tb=this.nlc.Mid.value,Qb=N.a(tb);let qc=0;for(;qc<Qb.length;){qc%15||Ia.append('<tr role="presentation">');const Lc=tb[Qb[qc]];Ia.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+qc,Z.a.RQa(Lc.Lid),Z.a.RQa(Lc.altText)));qc++;qc%15&&qc!==Qb.length||Ia.append("</tr>")}Ia.append("</table>");return Ia.toString()}a1d(){const Ia=this.Bdg();return ra.l(Ia)}Bdg(){const Ia=Object.assign(new pa.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(Ia.MenuSectionList,this.j0h());e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&Array.add(Ia.MenuSectionList,this.TZh());return Ia}TZh(){const Ia=Object.assign(new ya.a,{Id:"msMoreSymbols",
Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),tb=Object.assign(new Ja.a,{Id:"btnMoreSymbols",Command:"3574218963",LabelText:Z.a.le(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Z.a.le(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:e.AFrameworkApplication.Rl,Image16by16Class:Da.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(Ia.ControlList,tb);return Ia}j0h(){const Ia=Object.assign(new ya.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,
ControlList:[]}),tb=Object.assign(new Ka.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Qb=this.nlc.Mid.value,qc=N.a(Qb),Lc=Math.min(25,qc.length);for(let le=0;le<Lc;le++){var Jd=Qb[qc[le]];Jd=Object.assign(new ma.a,{Id:String.format("{0}{1}_{2}","symbol_",le,Jd.Lid),Character:Jd.Lid,Command:"3966968829",QueryCommand:"816646517",Alt:Z.a.le(Jd.altText)});tb.GalleryItems.push(Jd)}Array.add(Ia.ControlList,
tb);return Ia}}Object(h.a)(va,"SymbolsUiBuilder",null,[858]);var Fa=d(62),ka=d(122),qa=d(34),Ua=d(504),Ya=d(291);class Va{constructor(){this.Ea=null}get name(){return"Box4.Symbols"}init(){e.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled")&&this.Ea.resolve("Box4.Symbols.ISymbolsActor").wb()}dispose(){}Yb(Ia){this.Ea=Ia;this.Ea.register(oa,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ma();this.Ea.register(va,"Box4.Symbols.SymbolsUiBuilder").as("Box4.Symbols.ISymbolsUIBuilder").ma().na(()=>
new va(this.Ea.resolve("Box4.Symbols.ISymbolsLoader")));this.Ea.register(ia,"Box4.Symbols.SymbolsActor").as("Box4.Symbols.ISymbolsActor").ma().na(()=>new ia(e.AFrameworkApplication.Va,new Ua.a,new Ya.a,this.Ea.resolve("Box4.Symbols.ISymbolsUIBuilder"),ka.a.instance,qa.a.instance,Fa.a.instance,this.Ea.Oa("Box4.IExternalSelectionManager")))}static main(){m.a.instance.Ec(new Va)}}Object(h.a)(Va,"Box4SymbolsPackage",null,[2,3]);var ua=d(1019),Ca=d(33),Ea=d(82),wb=d(437);class Oa{constructor(Ia,tb){this.GBd=
this.FBd=null;this.vlb=new ua.a;this.Di=Ia;this.qaa=tb.appSettings[Oa.Hxl]||""}get I5k(){return this.vlb.task}get Laa(){return this.Di.value}zQk(){const Ia={};Ia[Oa.coj]=e.AFrameworkApplication.$g;Ia["Content-Type"]="application/json; charset=utf-8";r.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const tb=Ea.a.aj(this.qaa+Oa.J5k,Oa.Zdk,e.AFrameworkApplication.Ba.jb.vm.toString());this.Laa.Jj(tb,1,"",Ia,!0,2,Object(u.a)(this,this.Sve,"onSuccessCallback"),
Object(u.a)(this,this.Icc,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}MUj(Ia){try{const tb={};tb.FlightName=Ia.FlightName;tb.SessionID=Ia.SessionID;r.ULS.sendTraceTag(594883776,215,50,Ca.c(tb))}catch(tb){r.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}Sve(Ia){if((Ia=Ia.data.je)&&Ia.length)try{const tb=Ca.a(Ia);this.FBd=tb.NavBarDataJson;r.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.FBd?({Ev:this.GBd}=Ca.d(tb.NavBarDataJson)).returnValue?
(this.MUj(this.GBd),this.vlb.Ig(this.GBd)):(r.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:wb.a.Emc(this.FBd)}),this.vlb.Y_()):(r.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.vlb.Y_())}catch(tb){r.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.vlb.Y_()}else r.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}Icc(){this.vlb.Y_();r.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return Oa.Ka||
(Oa.Ka=Oa.I5a())}static I5a(){return new Oa(new y.a(()=>e.AFrameworkApplication.Be),e.AFrameworkApplication.fa,e.AFrameworkApplication.Ba.jb.vm)}}Oa.coj="X-qs";Oa.Zdk="at";Oa.J5k="O365ShellServiceProxy.ashx";Oa.Ka=null;Oa.Hxl="ShellWebServiceBase";Object(h.a)(Oa,"O365ShellActor",null,[952]);class ab{constructor(){this.Ea=null}get name(){return"Common.App.O365Shell"}Yb(Ia){this.Ea=Ia;this.Ea.register(Oa,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ma().na(()=>new Oa(new y.a(()=>
e.AFrameworkApplication.Be),e.AFrameworkApplication.fa,e.AFrameworkApplication.Ba.jb.vm))}init(){e.AFrameworkApplication.fa.gf(Object(u.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){e.AFrameworkApplication.gmd&&e.AFrameworkApplication.Ba.jb.kN&&this.Ea.resolve("Common.App.O365Shell.O365ShellActor").zQk()}dispose(){}static main(){m.a.instance.Ec(new ab)}}Object(h.a)(ab,"PackageManager",null,[2,3]);var fb=d(78),db=d(281);class gc{constructor(Ia){this.Ta=new fb.a;this.hH=Ia}Gzc(Ia){this.Ta.addHandler(gc.dxa,
Ia)}zDe(Ia){this.Ta.removeHandler(gc.dxa,Ia)}MKe(){this.Ta.raiseEvent(gc.vFb)}LKe(){this.Ta.raiseEvent(gc.wFb)}}gc.vFb="SE";gc.wFb="SEP";gc.dxa="SER";gc.NPe="TRP";Object(h.a)(gc,"NullSessionExpirationManager",null,[877,878]);var ob=d(163);class Sb{constructor(){this.yQb=this.eMa=!1;const Ia=e.AFrameworkApplication.Kl;0>=Ia||(this.Kl=Ia,r.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Kl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.Eaa}),
db.a.instance.AGd(Object(u.a)(this,this.cCb,"onSessionExpiredDetected")),db.a.instance.yGd(Object(u.a)(this,this.c8c,"onSessionExpiringDetected")))}cCb(){db.a.instance.jch(Object(u.a)(this,this.cCb,"onSessionExpiredDetected"));r.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.U2d()}c8c(){db.a.instance.ZNk(Object(u.a)(this,this.c8c,"onSessionExpiringDetected"));this.yQb||this.eMa||(r.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.yQb=!0,
this.zLe())}U2d(){this.eMa||(e.AFrameworkApplication.zo(ob.a.sessionAccessTokenExpired),this.eMa=!0,this.uhd())}}Object(h.a)(Sb,"ASessionExpirationManager",null,[]);var Jb=d(285),Ab=d(35);class lc{constructor(Ia,tb,Qb,qc){this.ePe="";this.noc=Ia;this.Ctf=Qb;this.ztf=qc;this.R6e=tb;Ia=(new Date(this.noc)).format(e.AFrameworkApplication.Kmh);this.ePe=this.R6e?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,Ia)}tFb(Ia){1===Ia?this.Ctf&&this.Ctf(this.R6e):
0===Ia&&e.AFrameworkApplication.Va.Ma(Ab.a.close,2,Jb.g)}dispose(){this.ztf&&this.ztf()}}lc.id="SessionExpirationDialog";Object(h.a)(lc,"SessionExpirationDialogSharedProperties",null,[]);class Mc{}Mc.Wf="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(h.a)(Mc,"SessionExpirationDialogHtml",null,[]);class Jc extends D.a{constructor(Ia,tb,Qb,qc){super(tb);const Lc={};this.Zya=new lc(Ia,tb,Qb,
qc);this.kg=lc.id;e.AFrameworkApplication.sKf?(this.vd=1,this.Pe(0,CommonUIStrings.l_DialogClose)):(this.vd=0,this.Zq=!1);tb||1===e.AFrameworkApplication.Ba.mode?this.Pe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Pe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Wf=Mc.Wf;Lc.WACSessionExpirationText=this.Zya.ePe;this.qj(CommonUIStrings.l_DefaultDialogTitle,Object(u.a)(this,this.tFb,"sessionExpirationDialogHandler"),Lc);this.D4(this.ki("WACSessionExpirationText"))}tFb(Ia){this.Zya.tFb(Ia)}xRc(){return this.QV}k7a(){this.hide()}dispose(){super.dispose();
this.Zya&&this.Zya.dispose()}}Object(h.a)(Jc,"LegacySessionExpirationDialog",D.a,[1004]);var rb=d(102);class cc extends rb.StandardDialog{constructor(Ia,tb,Qb,qc){super(tb);this.Zya=new lc(Ia,tb,Qb,qc);this.kg=lc.id;e.AFrameworkApplication.sKf?(this.vd=1,this.Pe(0,CommonUIStrings.l_DialogClose)):(this.vd=0,this.Zq=!1);tb||1===e.AFrameworkApplication.Ba.mode?this.Pe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Pe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Tw(CommonUIStrings.l_DefaultDialogTitle,
this.Zya.ePe,0,Object(u.a)(this,this.tFb,"sessionExpirationDialogHandler"))}tFb(Ia){this.Zya.tFb(Ia)}xRc(){return this.QV}k7a(){this.hide()}dispose(){super.dispose();this.Zya&&this.Zya.dispose()}}Object(h.a)(cc,"SessionExpirationDialog",rb.StandardDialog,[1004]);const jb=(Ia,tb,Qb,qc)=>e.AFrameworkApplication.Ba&&e.AFrameworkApplication.Ba.jb.QB&&e.AFrameworkApplication.fa.ka("ReactStandardSessionExpirationDialogIsEnabled")?new cc(Ia,tb,Qb,qc):new Jc(Ia,tb,Qb,qc);var Xb=d(244);class yb extends Sb{constructor(Ia){super();
this.xlb=this.ylb=!0;this.VO=null;this.Ta=new fb.a;this.hH=Ia}Gzc(Ia){this.Ta.addHandler(yb.dxa,Ia)}zDe(Ia){this.Ta.removeHandler(yb.dxa,Ia)}MKe(Ia){this.ylb=Ia}LKe(Ia){this.xlb=Ia}zLe(){if(!this.VO&&!Xb.a.zw){if(this.xlb){const Ia=Object(u.a)(this,this.Spb,"disposeCallback");this.VO=jb(this.Kl,!1,Object(u.a)(this,this.uFb,"sessionExpirationHandler"),Ia)}this.Ta.raiseEvent(yb.wFb)}}uhd(){this.VO&&(this.VO.xRc()&&this.VO.k7a(),this.VO=null);if(this.ylb){const Ia=Object(u.a)(this,this.Spb,"disposeCallback");
this.VO=jb(this.Kl,!0,Object(u.a)(this,this.uFb,"sessionExpirationHandler"),Ia)}this.Ta.raiseEvent(yb.vFb)}Spb(){this.VO=null}uFb(){this.hH.refreshDocument(null)}}yb.vFb="SE";yb.wFb="SEP";yb.dxa="SER";yb.NPe="TRP";Object(h.a)(yb,"SessionExpirationManager",Sb,[877,878]);var mb=d(17);class Ub{}Ub.dXh="Aborting";Ub.Kyc="ActivityDuration";Ub.error="Error";Ub.fLi="Errors";Ub.failed="Failed";Ub.eJc="FirstActivity";Ub.initialized="Initialized";Ub.ePj="KickedOut";Ub.mPj="LastActivity";Ub.JSk="RetryOverride";
Ub.bdd="RequestGroups";Ub.SWa="Requests";Ub.mdd="Responses";Ub.Zed="SessionDuration";Ub.status="Status";Ub.success="Success";Ub.Efl="Successful";Ub.tokens="Tokens";Ub.Yxe="PollingDuration";Object(h.a)(Ub,"SessionExpirationStrings",null,[]);var ec=d(79);class nc{constructor(Ia){this.Xx={};this.m5={};this.LLa={};this.gAg=15;this.M$e=!1;this.bTh=new Date;this.gtc=new Date;this.Md=Ia;this.f6=new ec.a(2,2,6E4*this.gAg,Object(u.a)(this,this.iDh,"writeMeasures"),135,"SL",!1);this.Md.Hb(this.f6);this.Fvj()}iDh(){r.ULS.sendTraceTag(41964821,
217,50,r.ULS.Eae({["Aggregate"]:this.m5,["Current"]:this.Xx}))}Fvj(){this.m5[Ub.bdd]=0;this.m5[Ub.SWa]=0;this.m5[Ub.mdd]=0;this.m5[Ub.status]=Ub.initialized;this.m5[Ub.eJc]=new Date;this.m5[Ub.Zed]=0;this.m5[Ub.Kyc]=0;this.m5[Ub.Zed]=0;this.Xx[Ub.Zed]=0;this.m5[Ub.Kyc]=0;this.Xx[Ub.Kyc]=0}get ltk(){this.LLa[Ub.Yxe]=+new Date-+this.LLa[Ub.eJc];return this.LLa}W4d(Ia,tb){var Qb=Ia[tb];Qb=Qb?Qb:0;Qb++;Ia[tb]=Qb;this.XHe(Ia)}XHe(Ia){const tb=new Date;Ia[Ub.Kyc]=+tb-+this.gtc;this.gtc=tb;Ia[Ub.Zed]=+this.gtc-
+this.bTh;Ia[Ub.mPj]=this.gtc}jwa(Ia,tb){this.Xx[Ia]=tb;this.XHe(this.Xx)}cjh(Ia,tb){this.Xx[Ia]=tb;this.XHe(this.Xx)}utb(Ia){this.W4d(this.Xx,Ia);this.W4d(this.m5,Ia);this.W4d(this.LLa,Ia)}flush(){this.M$e||(this.m5[Ub.status]=this.Xx[Ub.status],this.iDh(this.f6),this.Md.v4(this.f6,6E4*this.gAg))}ZQk(){const Ia=this.Xx[Ub.status];Ia&&(this.m5[Ub.status]=Ia);this.Xx={}}gRk(){this.LLa={};this.LLa[Ub.Yxe]=0;this.LLa[Ub.eJc]=new Date}stop(){r.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.M$e=!0;this.Md.ah(this.f6)}}Object(h.a)(nc,"SessionLogger",null,[873]);class Lb{constructor(Ia,tb){this.Ixc=Ia;this.tKa=tb}get tokens(){return this.Ixc}get errors(){return this.tKa}}Object(h.a)(Lb,"TokenRefreshArgs",null,[915]);var Zc=d(95),Pb=d(193),eb=d(137);class $a extends Sys.EventArgs{constructor(Ia,tb,Qb,qc,Lc,Jd,le){super();this.LLa=Ia;this.bdd=qc;this.failed=Lc;this.SWa=Jd;this.mdd=le}}Object(h.a)($a,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var vb=d(88);class bc{constructor(Ia,
tb=null,Qb=null){this.yQb=this.eMa=!1;this.xlb=this.ylb=!0;this.Ta=new fb.a;this.AQb=this.htc=this.Ivc=!1;this.kzd=null;this.yif=10;this.Lsc=!1;this.EDd=Ia;this.zvd=e.AFrameworkApplication.iOj;this.Md=eb.a.instance;r.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:e.AFrameworkApplication.Kl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.Eaa});this.Pi=tb||new nc(eb.a.instance);this.iga=Qb;db.a.instance.AGd(Object(u.a)(this,
this.aXh,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));db.a.instance.yGd(Object(u.a)(this,this.fzf,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Pb.SessionStatusManager.instance.e3h(Object(u.a)(this,this.fzf,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Pb.SessionStatusManager.instance.D3h(Object(u.a)(this,this.Ewk,"preemptiveTokenRefresh"));this.vbf=new Date;e.AFrameworkApplication.hOj&&(db.a.instance.$Kd=Object(u.a)(this,this.fHk,"refreshAccessTokenWhenSessionExpired"));
e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.yif=e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1))}Gzc(Ia){this.Ta.addHandler(bc.dxa,Ia)}zDe(Ia){this.Ta.removeHandler(bc.dxa,Ia)}fHk(){this.AOc(!1);return!db.a.instance.vDa(e.AFrameworkApplication.Kl)}aXh(Ia,
tb){db.a.instance.yTc?this.cCb(Ia,tb):this.zvd?(this.htc=!1,this.AOc(!1)):(this.eMa||r.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.cCb(Ia,tb))}fzf(Ia,tb){db.a.instance.x$d?this.c8c(Ia,tb):this.AOc(!0)}AOc(Ia){if(!this.Ivc&&!this.htc)if(this.iga&&this.iga.q8a)this.AQb=!0,this.Pi.jwa(Ub.status,Ub.ePj),this.Pi.flush(),this.Pi.stop();else if(r.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",Ia,this.AQb),this.AQb)this.uhd();
else{this.Pi.flush();this.Pi.ZQk();this.Pi.utb(Ub.bdd);this.Ivc=!0;this.Lsc||(this.Pi.gRk(),this.Lsc=!0,this.Uti());const tb=this.EDd.zHk(Ia);tb.continueWith(()=>{if(this.EDd.fzk(tb))this.Pi.utb(Ub.Efl),this.Pi.jwa(Ub.status,Ub.success),this.xlb=!1,this.zvd&&(this.ylb=!1),this.htc=!1,this.vbf=new Date,this.Rel(),this.Ta.raiseEvent(bc.dxa,new Lb(tb.result.tokens,null));else{const Qb=tb.result.errors;this.Pi.utb(Ub.failed);this.Pi.jwa(Ub.status,Ub.failed);Ia||(this.AQb=this.EDd.SSc(Qb));this.AQb&&(this.Pi.jwa(Ub.dXh,
JSON.stringify(Qb)),r.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.htc=!0;this.Ta.raiseEvent(bc.dxa,new Lb(null,Qb))}this.Pi.flush();this.Ivc=!1})}}cCb(){this.zvd||db.a.instance.jch(Object(u.a)(this,this.cCb,"onSessionExpiredDetected"));r.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.U2d(db.a.instance.yTc)}c8c(){this.yQb||this.eMa||(r.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.yQb=!0,this.zLe(db.a.instance.x$d))}U2d(Ia){if(!this.eMa){var tb=
Ia?ob.a.rYk:ob.a.sessionAccessTokenExpired;const Qb=Object.assign(new vb.a,{extendedProperties:new Map});Qb.extendedProperties.set("ErrorCode",String.format("{0}",tb));e.AFrameworkApplication.zo(tb,void 0,["SessionExpired"],Qb);Ia||(Ia=new Date,tb=new Date(e.AFrameworkApplication.Eaa),r.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",tb,Ia,+Ia-+tb),864E5>+Ia-+tb&&Zc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],
!0,!0,!1,!0,Qb),2592E5>+Ia-+tb&&Zc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,Qb));this.eMa=!0;this.uhd()}}Rel(){this.Lsc&&(this.Md.ah(this.kzd),this.Lsc=!1)}Uti(){this.kzd=new ec.a(2,2,1E3*this.yif,Object(u.a)(this,this.rkl,"tokenRefreshPolling"),135);this.Md.Hb(this.kzd)}rkl(){const Ia=this.Pi.ltk;r.ULS.sendTraceTag(555255521,217,50,"{0}",Ca.c(Ia));this.Ta.raiseEvent(bc.NPe,new $a(Ia,Ia[Ub.Yxe],Ia[Ub.eJc],Ia[Ub.bdd],Ia[Ub.failed],
Ia[Ub.SWa],Ia[Ub.mdd]))}Ewk(){3E5<+new Date-+this.vbf?(r.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.AOc(!1)):r.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}bc.vFb="SE";bc.wFb="SEP";bc.dxa="SER";bc.NPe="TRP";Object(h.a)(bc,"ASessionExpirationManagerWithRefresh",null,[]);class Cc extends bc{constructor(Ia,tb,Qb=null,qc=null){super(tb,Qb,qc);this.VO=null;this.hH=Ia}MKe(Ia){this.ylb=Ia}LKe(Ia){this.xlb=
Ia}zLe(Ia){if(!this.VO&&!Xb.a.zw){if(Ia){var tb=Object(u.a)(this,this.Spb,"disposeCallback");this.VO=jb(e.AFrameworkApplication.YEb,!1,Object(u.a)(this,this.uFb,"sessionExpirationHandler"),tb)}else if(this.xlb){if(this.Ivc)return;tb=Object(u.a)(this,this.Spb,"disposeCallback");this.VO=jb(e.AFrameworkApplication.Kl,!1,Object(u.a)(this,this.uFb,"sessionExpirationHandler"),tb)}r.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",bc.wFb,Ia);this.Ta.raiseEvent(bc.wFb)}}uhd(){this.VO&&
(this.VO.xRc()&&this.VO.k7a(),this.VO=null);if(this.ylb){this.Pi.stop();if(this.iga&&this.iga.q8a)return;const Ia=Object(u.a)(this,this.Spb,"disposeCallback");this.VO=jb(e.AFrameworkApplication.Kl,!0,Object(u.a)(this,this.uFb,"sessionExpirationHandler"),Ia)}r.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",bc.vFb);this.Ta.raiseEvent(bc.vFb)}Spb(){this.VO=null}uFb(){this.hH.refreshDocument(null)}}Object(h.a)(Cc,"SessionExpirationManagerWithRefresh",bc,[877,878]);class Gc{constructor(Ia,tb,Qb=
null,qc=null){this.Nxf=!1;this.Ka=null;this.vrc=Ia;this.kLa=tb;this.Pi=Qb||new nc(eb.a.instance);this.iga=qc}create(){this.Nxf=e.AFrameworkApplication.wz;if(!this.Nxf)return new yb(this.vrc);e.AFrameworkApplication.Pj("WOPITokenRefreshIsEnabled");r.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.Ka)switch(e.AFrameworkApplication.Uxl){case 1:r.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this.Ka=new gc(this.vrc);break;
case 2:r.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this.Ka=new Cc(this.vrc,this.kLa,this.Pi,this.iga);break;default:r.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this.Ka=new yb(this.vrc)}r.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.Ka).getName());return this.Ka}}Object(h.a)(Gc,"SessionExpirationManagerFactory",null,[876]);class sd{}Object(h.a)(sd,"Error",
null,[]);class Sd{}Object(h.a)(Sd,"NamedResult",null,[]);class ie extends Sd{}Object(h.a)(ie,"ErrorInfo",Sd,[]);var De=d(114),yd=d(170),ib=d(125),dc=d(692);class Bc{constructor(Ia,tb,Qb,qc=null,Lc=!1,Jd=null,le=!1){this.k1a=0;this.nMa=this.Am=null;this.Ixc=new mb.a;this.tKa=new mb.a;this.nB=null;this.yvd=!1;this.Md=Ia;this.Hif=tb;this.Hif.execute(je=>{je.cB(ib.a.l4d,Object(u.a)(this,this.fik,"onHostResponseReceived"))});this.Doa=Qb;this.Swf=new dc.a("WebServiceCall","TokenRefresh");this.Pi=qc||new nc(Ia);
this.XSh=Lc;this.Moa=Jd?Jd:Pb.SessionStatusManager.instance;this.w0e=le}fik(Ia){if(Ia.MessageId!==ib.a.l4d)da.c(39408099,306,15,"Unexpected message.");else{var tb=new mb.a,Qb=new mb.a;this.Pi.utb(Ub.mdd);var qc=Ia.Values[yd.a.wih];if(!qc||0>=qc.length)da.c(40122317,306,15,"Found no tokens in the dictionary"),qc=Ia.Values;da.c(40122318,306,100,"The Tokens array contains {0} tokens",qc.length);this.Pi.jwa("Correlation",Ia.CorrelationId);var Lc="";for(let je=0;je<qc.length;je++){this.Pi.cjh(Ub.tokens,
qc.length);var Jd=qc[je],le=Jd;if(!le||!le.Name)continue;this.Pi.utb(le.Name);const Gf=Jd;if(Gf&&Gf.Value)da.c(39408128,306,100,"Received token with name: {0}",Gf.Name),tb.add(Gf),this.Ixc.add(Gf),this.Pi.jwa(Ub.status,Ub.success),this.w0e&&this.Moa&&this.Moa.tRk();else if(Jd=this.p$i(Jd),da.c(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",le.Name,JSON.stringify(Jd),this.nMa),Qb.add(Jd),this.tKa.add(Jd),Lc=JSON.stringify(Jd),this.Pi.jwa(Ub.error,JSON.stringify(Jd)),
this.Pi.jwa(Ub.status,Ub.failed),this.w0e)for(const Wf of Jd.Errors)le=this.I0i(Wf),this.Moa&&this.Moa.E0h(le)}0<Qb.count&&""!==Lc?(qc=Object.assign(new vb.a,{extendedProperties:new Map}),qc.extendedProperties.set("Errors",Lc),Zc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,qc)):Zc.Health.instance.recordKpiSuccess("WACTokenRefresh",null);da.c(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",tb.count,Qb.count,Ia.CorrelationId,
this.nMa);0<Qb.count&&!this.SSc(Qb)?(Ia=this.Doa.u9i(Qb),Ia!==this.Doa.cFe&&(this.Pi.cjh(Ub.JSk,Ia),this.Md.v4(this.Am,Ia))):(this.Pi.flush(),this.Am&&(da.c(39408131,306,100,"Deleting task {0} from task manager",this.Am.name),this.Md.ah(this.Am)),this.nB&&!this.nB.task.isCompleted&&this.nB.Ig(new Lb(tb,Qb)))}}p$i(Ia){if(!Ia)return null;const tb=Object.assign(new ie,{Name:Ia.Name,Errors:[]});for(const Qb of Ia.Errors)Ia=new sd,Ia.Id=Qb.Id,Ia.Details=this.o$i(Qb.Details),tb.Errors.push(Ia);return tb}o$i(Ia){if(!Ia)return"";
const tb=Ia.toString().toLowerCase();return 0<tb.indexOf("<!doctype")?this.O_d("Seems to contain HTML - Contains <!DOCTYPE"):0<tb.indexOf("<html")?this.O_d("Seems to contain HTML - Contains <html>"):500<tb.length?this.O_d(String.format("Error details content too long: Length: {0}",tb.length)):Ia}O_d(Ia){return String.format("{0} - Reason: [{1}]","### REDACTED ###",Ia)}requestTokensOnce(){this.Tdh()}Tdh(){e.AFrameworkApplication.M5b("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");
this.k1a>=this.Doa.u$j?(da.c(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.nMa),this.svi(this.nB)):(Zc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.cXk())}cXk(){const Ia={};Ia[yd.a.wih]=this.Doa.tokens;const tb=De.a.create().toString();da.c(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.Doa.tokens),this.k1a+1,tb,this.nMa);this.Hif.execute(Qb=>{Qb.sendMessage(ib.a.rHd,Ia,tb)});this.k1a++;
this.Pi.utb(Ub.SWa)}svi(Ia){const tb=new mb.a;for(let Qb=0;Qb<this.Doa.tokens.length;Qb++){const qc=Object.assign(new ie,{Name:this.Doa.tokens[Qb],Errors:[Object.assign(new sd,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});tb.add(qc);this.tKa.add(qc)}this.Md.ah(this.Am);this.Pi.jwa(Ub.fLi,JSON.stringify(this.tKa));this.Pi.jwa(Ub.status,Ub.failed);Ia&&!Ia.task.isCompleted&&Ia.Ig(new Lb(new mb.a,this.tKa))}zHk(Ia){this.Swf.start();
this.yvd=Ia;this.nMa=De.a.create().toString();da.c(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.nMa,this.yvd);this.k1a=0;this.tKa.clear();this.Ixc.clear();this.nB=new ua.a;this.Am=new ec.a(this.Doa.priority,2,this.Doa.cFe,Object(u.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,ib.a.rHd,!0);this.XSh&&this.Tdh();this.Md.Hb(this.Am);return this.nB.task}fzk(Ia){this.Swf.stop();const tb=this.xoj(Ia.result.errors);r.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!tb,this.nMa,this.yvd,this.k1a,this.tKa.count,0<Ia.result.errors.count?Ia.result.errors.ga(0).Name:"",0<Ia.result.errors.count&&0<Ia.result.errors.ga(0).Errors.length?Ia.result.errors.ga(0).Errors[0].Id:"",0<Ia.result.errors.count&&0<Ia.result.errors.ga(0).Errors.length?Ia.result.errors.ga(0).Errors[0].Details:"");return tb?!1:this.ezk(Ia.result.tokens)}SSc(Ia){return this.Doa.SSc(Ia)}ezk(Ia){for(let tb=0;tb<Ia.count;tb++){const Qb=Ia.ga(tb);if(Qb.Name===yd.a.accessToken){const qc=(new Date).getTime();
Qb.Expiry>e.AFrameworkApplication.Kl?(r.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Qb.Expiry,["NowGetTime"]:qc,["BootTime"]:e.AFrameworkApplication.Eaa},"PreviousAccessTokenTtl",e.AFrameworkApplication.Kl),e.AFrameworkApplication.accessToken=Qb.Value,e.AFrameworkApplication.Kl=Math.floor(Qb.Expiry),e.AFrameworkApplication.UTe=qc,e.AFrameworkApplication.raa=Math.floor(Qb.Expiry)):r.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
{["AccessTokenTtl"]:Qb.Expiry,["NowGetTime"]:qc,["BootTime"]:e.AFrameworkApplication.Eaa},"PreviousAccessTokenTtl",e.AFrameworkApplication.Kl)}}return!0}xoj(Ia){let tb=!1;for(let Qb=0;Qb<Ia.count;Qb++){tb=!0;const qc=Ia.ga(Qb);r.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",qc.Name,JSON.stringify(qc.Errors),this.nMa)}return tb}I0i(Ia){let tb=ob.a.sessionAccessTokenExpired;Ia=parseInt(Ia.Id);if(isNaN(Ia))tb=ob.a.Yxl;else{switch(Ia){case 401:tb=ob.a.ayl;
break;case 403:tb=ob.a.Wxl;break;case 500:tb=ob.a.Xxl;break;case 503:tb=ob.a.$xl}tb===ob.a.sessionAccessTokenExpired&&(tb=500<Ia?ob.a.Zxl:ob.a.Vxl)}return tb}}Object(h.a)(Bc,"TokenRefreshManager",null,[875]);class Ob{constructor(){this.cFe=e.AFrameworkApplication.dyl;this.u$j=e.AFrameworkApplication.byl;this.tokens=e.AFrameworkApplication.hgj();this.priority=e.AFrameworkApplication.eyl;this.Jrf=this.d2k();this.EEd=e.AFrameworkApplication.ggj()}SSc(Ia){Ia=JSON.stringify(Ia);if(this.EEd&&0<this.EEd.length)for(const tb of this.EEd)if(0<
tb.length&&0<=Ia.indexOf(tb))return!0;return!1}u9i(Ia){try{if(Ia)for(let tb of Ia)if(tb.Errors)for(const Qb of tb.Errors)if(Qb.Id in this.Jrf)return Number.parseInvariant(this.Jrf[Qb.Id].toString())}catch(tb){r.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",tb.toString())}return this.cFe}d2k(){const Ia={};try{if(!e.AFrameworkApplication.PNc()||0>=e.AFrameworkApplication.PNc().length||""===e.AFrameworkApplication.PNc()[0])return Ia;for(const tb of e.AFrameworkApplication.PNc())0<
tb.length&&(Ia[tb]=e.AFrameworkApplication.cyl)}catch(tb){r.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",tb.toString())}return Ia}}Object(h.a)(Ob,"TokenRefreshPolicy",null,[874]);class yc{constructor(){this.Ea=null}get name(){return"Common.App.SessionExpiration"}init(){e.AFrameworkApplication.fa.gf(()=>{this.BCa()})}BCa(){this.Ea.resolve("Common.ISessionExpirationManagerFactory");this.Ea.resolve("Common.ISessionExpirationManager");this.Ea.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}Yb(Ia){this.Ea=
Ia;Ia.register(873,"Common.App.SessionExpiration.ISessionLogger").ma().na(()=>new nc(eb.a.instance));Ia.register(874,"Common.App.SessionExpiration.ITokenRefreshPolicy").ma().na(()=>new Ob);Ia.register(875,"Common.App.SessionExpiration.ITokenRefreshManager").ma().na(()=>new Bc(eb.a.instance,e.AFrameworkApplication.tV(),Ia.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),Ia.resolve("Common.App.SessionExpiration.ISessionLogger"),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSendTokenRequestWithoutTasks"),
Ia.qb("Common.ISessionStatus"),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1)));Ia.register(876,"Common.ISessionExpirationManagerFactory").ma().na(()=>new Gc(e.AFrameworkApplication.Ba,Ia.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),Ia.resolve("Common.App.SessionExpiration.ISessionLogger"),Ia.qb("Common.ISessionStatus")));Ia.register(877,"Common.ISessionExpirationManagerWithDialog").ma().na(()=>Ia.resolve("Common.ISessionExpirationManagerFactory").create());
Ia.register(878,"Common.ISessionExpirationManager").ma().na(()=>Ia.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){m.a.instance.Ec(new yc)}}Object(h.a)(yc,"SessionExpirationPackage",null,[2,3]);var fc=d(1159),Nb=d(231),lb=d(55),Qc=d(1154),Rc=d(429),ld=d(37),Dd=d(157),gd=d(120),be=d(132),od=d(60),$d=d(26),xf=d(42),Na=d(28);class xb extends Xb.a{constructor(Ia,tb){super();this.lda=null;this.lXj=!1;this.eYj="";this.zKg=this.AKg=this.kCg=this.lCg=null;this.vd=3;this.Pe(1,ResourceStrings.L_SetSlideOrientationMaximize);
this.Pe(2,ResourceStrings.L_SetSlideOrientationEnsure);this.ia=Ia;this.pLg=tb.rk(od.a.X2g)}dispose(){this.lda=null;super.dispose()}showDialog(Ia){this.qj(Ia);this.lCg=document.getElementById("btnMaximize");this.AKg=Object(u.a)(this,this.ilk,"onScaleUpButton");G.a.addHandler(this.lCg,"click",this.AKg);this.kCg=document.getElementById("btnEnsure");this.zKg=Object(u.a)(this,this.hlk,"onScaleDownButton");G.a.addHandler(this.kCg,"click",this.zKg)}qj(Ia){this.ioa=Object(u.a)(this,this.P2k,"setSlideOrientationRatio");
this.iwa(Ia);this.Yy.style.width="420px";this.show()}hide(){this.sc&&(e.AFrameworkApplication.Ba.iw.ap(gd.AFrame.v_),super.hide())}ilk(Ia){this.ia.processAction(Na.a.zjc,2);Ia.preventDefault();this.mR&&this.hide()}hlk(Ia){this.ia.processAction(Na.a.yjc,2);Ia.preventDefault();this.mR&&this.hide()}P2k(Ia){1===Ia?this.ia.processAction(Na.a.zjc,2):2===Ia?this.ia.processAction(Na.a.yjc,2):$d.a.J(25277209,822,50,"Cancle the slide orientation change.");this.mR&&this.hide()}iwa(){this.Vw();this.AF()}Vw(){super.Vw();
Sys.UI.DomElement.addCssClass(this.sc,this.eYj);var Ia=$get("WACDialogTitleText");Ia.innerText=ResourceStrings.l_SetSlideScaleTitle;Ia.setAttribute("title",ResourceStrings.l_SetSlideScaleTitle);Ia=document.createElement("div");Ia.id=this.ki("WACDialogHtmlPanel");Ia.className="WACDialogHtmlPanel";this.Yy.appendChild(Ia);this.lda=document.createElement("div");this.lda.id=this.ki("WACDialogText");Ia.appendChild(this.lda);Ia=document.createElement("div");Ia.id=this.ki("Scalediv");Ia.className="WACDialogRow";
this.lda.appendChild(Ia);var tb=document.createElement("label");tb.id=this.ki("Scalelabel");tb.innerText=ResourceStrings.L_SetSlideOrientationInformation;Ia.appendChild(tb);Ia=document.createElement("div");Ia.id=this.ki("ScaleMode");Ia.setAttribute("style","margin-left: 20px;");Ia.className="WACDialogRow";this.lda.appendChild(Ia);tb=xb.nRf(od.a.Y2g+"_MaximizeFit_170x130x32",this.pLg,ResourceStrings.L_SetSlideOrientationMaximize);tb.id=this.ki("btnMaximize");var Qb=document.createElement("td");Qb.className=
String.format("clip{0}x{1}","170","130");Qb.setAttribute("style","border: #ccc 1px solid");Qb.appendChild(tb);tb=xb.nRf(od.a.Y2g+"_Ensurefit_170x130x32",this.pLg,ResourceStrings.L_SetSlideOrientationEnsure);tb.id=this.ki("btnEnsure");var qc=document.createElement("td");qc.className=String.format("clip{0}x{1}","170","130");qc.setAttribute("style","border: #ccc 1px solid");qc.appendChild(tb);var Lc=document.createElement("td");Lc.setAttribute("style","width: 30px;");tb=document.createElement("tr");
tb.appendChild(Qb);tb.appendChild(Lc);tb.appendChild(qc);Qb=document.createElement("td");Qb.setAttribute("align","center");qc=document.createElement("label");qc.id=this.ki("Maxlabel");qc.className="UIFontBold";qc.innerText=ResourceStrings.L_SetSlideOrientationMaximize;Qb.appendChild(qc);qc=document.createElement("td");qc.setAttribute("align","center");Lc=document.createElement("label");Lc.id=this.ki("Ensurelabel");Lc.className="UIFontBold";Lc.innerText=ResourceStrings.L_SetSlideOrientationEnsure;
qc.appendChild(Lc);const Jd=document.createElement("td");Jd.setAttribute("style","width: 30px;");Lc=document.createElement("tr");Lc.appendChild(Qb);Lc.appendChild(Jd);Lc.appendChild(qc);Qb=document.createElement("table");Qb.appendChild(tb);Qb.appendChild(Lc);Ia.appendChild(Qb)}AF(){this.Bhd(Xb.a.Iec+(Xb.a.Nla-xb.Bei)/2-12,Xb.a.Hec+(Xb.a.Ida-xb.Gei)/2-12)}Bhd(Ia,tb){this.sc.style.top=(0>Ia?0:Ia)+"px";xf.a("DeprecateIE.SetSlideOrientation")?this.sc.style.left=(0>tb?0:tb)+"px":lb.a.n8a&&e.AFrameworkApplication.isRtl?
this.sc.style.right=(0>tb?0:tb)+"px":this.sc.style.left=(0>tb?0:tb)+"px";this.lXj||(this.sc.style.width=String.format("{0}em",this.width));this.sc.style.display="Block"}static nRf(Ia,tb,Qb){const qc=document.createElement("img");qc.className=Ia;qc.setAttribute("Unselectable","on");qc.setAttribute(be.a.ff,be.a.eP);qc.src=tb;Qb&&(qc.alt=Qb,qc.title=Qb);return qc}}xb.Gei=350;xb.Bei=200;Object(h.a)(xb,"SetSlideOrientationDialog",Xb.a,[]);var sc=d(53),cd=d(113),Ta=d(241),Hb=d(76);class oc extends D.a{constructor(Ia,
tb){super(!1,!1,!0);this.LPf=this.R1=null;if(!Ia)throw Error.argumentNull("actionManager");if(!tb)throw Error.argumentNull("presentationReader");this.ia=Ia;this.qc=tb}CCa(){this.R1=Object(u.a)(this,this.Q2k,"setSlideSizeAndLayoutDialogResultHandler");this.LPf=this.dUi(this.getCurrentSlideDimensions());this.qj(ResourceStrings.L_SetSlideSize,this.R1,this.LPf)}Q2k(Ia,tb){1===Ia&&this.ia.Ma(Na.a.Xkh,2,tb);this.dispose()}getCurrentSlideDimensions(){const Ia=this.qc.Gv(),tb={};tb.height=Ia.height;tb.width=
Ia.width;tb.slideType=this.qc.jbj();return tb}dUi(Ia){return{["id"]:"SlideSizeAndLayoutDialog",["bodyControls"]:Ia,["numberFormatInfo"]:Hb.e().numberFormatInfo}}}Object(h.a)(oc,"SlideSizeAndLayoutDialog",D.a,[]);class Oc{constructor(Ia,tb,Qb,qc,Lc,Jd,le,je,Gf){this.QFa=this.Rka=this.hT=0;this.slideSizeType="O_screen4x3 O_letterPaper O_A4paper O_35mm O_overhead O_banner O_custom O_ledgerPaper O_A3Paper O_B4ISOPaper O_B5ISOPaper O_B4JISPaper O_B5JISPaper O_HagakiCard O_screen16x9 O_screen16x10 O_Widescreen".split(" ");
this.Xph=[4320,4320,4320,4320,4320,576,4896,5754,6048,5115,3387,5184,3456,1872,3240,3600,4320];this.jqh=[5760,5760,6240,6480,5760,4608,6336,7672,8064,6820,4516,6912,4608,2880,5760,5760,7680];this.ia=Ia;this.Ga=tb;this.Df=Qb;this.Jb=qc;this.Wb=Lc;this.ua=Jd;this.sa=je;this.qc=le;this.Qd=Gf}wb(){this.ia.ra(Na.a.$Ae,sc.a.application,Object(u.a)(this,this.YAe,"querySlideSize"),96);this.ia.ra(Na.a.ZAe,sc.a.application,Object(u.a)(this,this.YAe,"querySlideSize"),96);this.ia.ra(Na.a.F7g,sc.a.application,
Object(u.a)(this,this.YAe,"querySlideSize"),96);this.ia.ya(Na.a.S2k,sc.a.application,Rc.a.oG);this.ia.ra(Na.a.KAk,sc.a.application,Rc.a.J_,96);this.ia.ra(Na.a.egd,sc.a.application,Object(u.a)(this,this.Tmj,"handleSetSlideSize"),4);this.ia.ra(Na.a.GIe,sc.a.application,Object(u.a)(this,this.Vmj,"handleSetSlideSize4x3"),4);this.ia.ra(Na.a.FIe,sc.a.application,Object(u.a)(this,this.Umj,"handleSetSlideSize16x9"),4);this.ia.ra(Na.a.N0g,sc.a.application,Object(u.a)(this,this.QPj,"launchSlideSizeAndLayoutDialogHandler"),
4);this.ia.ra(Na.a.$nk,sc.a.application,Object(u.a)(this,this.Hyg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.ra(Na.a.aok,sc.a.application,Object(u.a)(this,this.Hyg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.ra(Na.a.zjc,sc.a.application,Object(u.a)(this,this.Wkh,"setSlideOrientationHandler"),4);this.ia.ra(Na.a.yjc,sc.a.application,Object(u.a)(this,this.Wkh,"setSlideOrientationHandler"),4);this.ia.ra(Na.a.Xkh,sc.a.application,Object(u.a)(this,this.R2k,"setSlideSizeAndLayoutHandler"),
4);this.ia.ya(Na.a.T2k,sc.a.application,Rc.a.oG);this.ia.ya(Na.a.setSlideHeight,sc.a.application,Rc.a.oG);this.ia.ra(Na.a.MAk,sc.a.application,Rc.a.J_,96);this.ia.ra(Na.a.LAk,sc.a.application,Rc.a.J_,96);this.ia.ya(Na.a.fdl,sc.a.application,Rc.a.oG);this.ia.ya(Na.a.edl,sc.a.application,Rc.a.oG)}Fe(){}YAe(Ia,tb,Qb,qc,Lc){$d.a.J(34936782,822,50,"Click slide size drop down.");if(tb.contextId!==sc.a.application)return 2;if(tb=Object(Qc.a)(cd.a,Lc))Ia=Oc.vCj(this.qc.Gv(),Ia),tb.Yf(Ia);return 32}QPj(Ia,
tb,Qb){tb=this.ua.Ca;return!tb||this.Df.gd(tb)||!xf.a("DeprecateIE.CustomizeSlideSizeActor")&&lb.a.Fw?8:1===Qb?32:Dd.a("CustomizeSlideSizeActor::LaunchSetSlideSizeAndLayoutDialogHandler ",Ia,()=>{(new oc(this.ia,this.qc)).CCa();$d.a.J(557158615,822,50,"Open set slide size and layout dialog.");return 32})}Hyg(Ia,tb,Qb,qc,Lc){Ia=this.ua.Ca;if(!Ia||this.Df.gd(Ia))return 16;if(1===Qb)return 32;if("slideType"in Lc&&"slideWidth"in Lc&&"slideHeight"in Lc)if(this.QFa=6,"o_custom"===Lc.slideType.toString().toLowerCase())this.hT=
6*Math.round(Lc.slideWidth),this.Rka=6*Math.round(Lc.slideHeight);else{Qb=0;for(const Jd of this.slideSizeType){if(Lc.slideType.toString().toLowerCase()===Jd.toLowerCase()){this.QFa=Qb;break}Qb++}"landscape"===Lc.orientation.toString()?(this.Rka=this.Xph[Qb],this.hT=this.jqh[Qb]):(this.hT=this.Xph[Qb],this.Rka=this.jqh[Qb])}(new xb(this.ia,this.Qd)).showDialog(ResourceStrings.l_SetSlideScaleTitle);$d.a.J(34936786,822,50,"Open set slide scale type dialog.");return 32}Tmj(Ia,tb,Qb){Ia=this.ua.Ca;return!Ia||
this.Df.gd(Ia)?8:this.ia.processAction(Na.a.Vpb,Qb)}Vmj(Ia,tb,Qb){$d.a.J(34936788,822,50,"click set slide size 4:3.");tb=this.ua.Ca;if(!tb||this.Df.gd(tb))return 16;if(1===Qb||960===this.qc.Gv().width)return 32;this.hT=5760;this.Rka=4320;this.QFa=0;return this.ZFb(this.hT,this.Rka,Ia,this.QFa,"EnsureFit")}Umj(Ia,tb,Qb){$d.a.J(34936792,822,50,"click set slide size 16:9.");tb=this.ua.Ca;if(!tb||this.Df.gd(tb))return 16;if(1===Qb)return 32;Qb=this.qc.Gv();if(1280===Qb.width)return 32;this.hT=7680;this.Rka=
4320;this.QFa=16;return 960===Qb.width&&720===Qb.height?this.ZFb(this.hT,this.Rka,Ia,this.QFa,""):this.ZFb(this.hT,this.Rka,Ia,this.QFa,"EnsureFit")}R2k(Ia,tb,Qb,qc,Lc){tb=this.ua.Ca;return!tb||this.Df.gd(tb)?8:1===Qb?32:this.ZFb(Lc.width,Lc.height,Ia,Lc.slideType,Lc.slideScaleType)}Wkh(Ia,tb,Qb){tb=this.ua.Ca;return!tb||this.Df.gd(tb)?16:1===Qb?32:this.Rka&&this.hT?Ia===Na.a.zjc?this.ZFb(this.hT,this.Rka,Ia,this.QFa,"Maximize"):Ia===Na.a.yjc?this.ZFb(this.hT,this.Rka,Ia,this.QFa,"EnsureFit"):32:
($d.a.J(34936796,822,10,"CustomizeSlideSizeActor::SetSlideOrientationHandler fail to get slide width/height."),8)}ZFb(Ia,tb,Qb,qc,Lc){const Jd=this.ua.Ca;let le=!1;if(Jd){var je=Jd.km();if(je&&0<je.length)for(const Gf of je)if(Gf.UCa){le=!0;break}}je=this.Jb.xd(15,void 0,()=>{this.Ga.Bd();this.sa.Rh()});try{je.hd(Jd),je.fd=Qb,je.iy[Ta.a.Rsb]=le,Jd.setValue(ld.a.slideWidth,Ia),Jd.setValue(ld.a.slideHeight,tb),Jd.setValue(ld.a.slideScaleType,Lc),Jd.setValue(ld.a.slideSizeType,qc)}finally{je&&je.dispose()}$d.a.J(34936798,
822,50,"Set slide width: {0}, height: {1}, scale type: {2}.",Ia,tb,Lc);this.Df.DTb(this.Wb.Bf,Jd,Qb);return 32}static vCj(Ia,tb){Ia=Ia.width/Ia.height;switch(tb){case Na.a.$Ae:return.01>Math.abs(Ia-1.33);case Na.a.ZAe:return.01>Math.abs(Ia-1.77);default:return!1}}}Object(h.a)(Oc,"CustomizeSlideSizeActor",null,[234]);class Yc{}Yc.leh=0;Yc.eRk=22711;Object(h.a)(Yc,"ImageConstants",null,[]);var Qd=d(238),ce=d(321),id=d(435),gb=d(40),pc=d(108),zc=d(239),Ic=d(107);class Fc extends Ic.a{constructor(){super();
this.ImageToken=null;this.ErrorCode=0}Lk(){return 78}}Object(h.a)(Fc,"NotifyImageUploadFailureRequest",Ic.a,[]);class rd{constructor(Ia,tb,Qb,qc,Lc,Jd,le,je,Gf,Wf,fh,zh,Qg,Rg,wi,Ng,Fj,Hh,gg,Og,vg){this.OFa=this.QSa=this.BI=null;this.tAb=!1;this.ia=Ia;this.ob=Qb;this.Zb=tb;this.ua=Lc;this.Jb=Jd;this.Ga=qc;this.Mz=le;this.jF=je;this.rm=Gf;this.Dle=Wf;this.Ix=fh;this.Wd=zh;this.Pb=Qg;this.Nab=Rg;this.J8b=wi;this.BTa=Ng;this.Yh=Fj;this.gl=Hh;this.Ha=gg;this.ql=Og;this.Xc=vg;this.US=gg.gDb;this.$_j=gg.Eii;
this.E0j=gg.Oxj}wb(){this.ia.ra(Na.a.insertPicture,P.a.application,Object(u.a)(this,this.Cgg,"handleInsertPicture"),4);this.ia.ra(Na.a.VIc,P.a.view,Object(u.a)(this,this.Onj,"handleUploadPictureAll"),4);this.ia.ra(Na.a.Bii,P.a.application,Object(u.a)(this,this.Zhj,"handleChangePicture"),4);this.ia.ra(Na.a.GEe,P.a.application,Object(u.a)(this,this.rmj,"handleResetPicture"),4);this.ia.ra(Na.a.dRk,P.a.application,Object(u.a)(this,this.smj,"handleResetPictureAndSize"),4);this.ia.ra(Na.a.fRk,P.a.application,
Object(u.a)(this,this.tmj,"handleResetPictureSplitButton"),4);this.ia.ra(Na.a.sNa,P.a.application,Object(u.a)(this,this.$hj,"handleChangePictureStyle"),4);this.ia.ra(Na.a.bSd,P.a.application,Object(u.a)(this,this.Cgg,"handleInsertPicture"),4);this.ia.ra(Na.a.lXf,P.a.application,Object(u.a)(this,this.Oij,"handleDragAndInsertImage"),4)}Fe(){}Cgg(Ia,tb,Qb){this.Ha.Irg&&!xf.a("DummyChangeGateForTest")&&$d.a.J(593880198,830,100,"HandleInsertPicture::DummyChangeGateForTest is disabled");this.$_j&&$d.a.J(521412807,
822,50,"HandleInsertPicture::m_isChangePictureMenuOrderingEnabled is Enabled");this.E0j&&$d.a.J(521412806,822,50,"HandleInsertPicture::m_isInsertStockImageInMLRFlightEnabled is Enabled");tb=this.ua.Ca;tb=this.Ha.VSc&&!!tb&&!this.Zb.gd(tb);tb=(this.J8b=this.Nab.XAj()&&this.J8b)?tb&&!!this.Mz&&this.Mz.$ld:this.jF.nsg&&tb;if(!tb)return 16;if(1===Qb)return 32;this.tAb=!0;this.OFa=this.ua.Ca;this.Akc(Ia!==Na.a.bSd,!0);return 32}Onj(Ia,tb,Qb,qc,Lc){var Jd=this.ua?this.ua.Ca:null;if(!Jd||!Jd.isConnected)return 16;
if(!this.gl.kI(Jd,1))return this.gl.fJ(Jd),16;$d.a.J(539083457,822,50,"Start picture upload");tb=rd.aMj(Lc);(qc=gb.a.Db)&&qc.Ya(pc.a.Xxj,tb?"1":"0");this.Xc.pEk();let le=!1;if(this.tAb&&this.J8b&&!this.Mz.Lfb&&this.qGj(tb)){if(Jd=Jd.g2(this.ob.he())){if(15!==Jd.zj){const je=Jd.BT;je.BottomLeft.X!==je.TopLeft.X&&(le=!0)}qc&&qc.Ya(pc.a.oTk,le?"1":"0")}Jd&&(15===Jd.zj||le)?(qc&&qc.Ya(pc.a.GYb,le?"PlaceHolder Rotated":"Picture Type PlaceHolder"),Ia=this.Chg(Ia,Qb,Lc)):Ia=this.Pnj(Ia,Qb,Lc)}else this.Mz.Lfb=
!1,Ia=this.Chg(Ia,Qb,Lc);tb&&32===Ia&&$d.a.J(38617729,822,50,"Upload a svg file successfully.");return Ia}qGj(Ia){return Ia?this.Ha.powerPointInsertSVGFileLocalRenderingEnabled:!0}Oij(Ia,tb,Qb,qc,Lc){if(!this.Mz.Isk)return $d.a.J(37818451,822,15,"PictureActor::HandleDragAndInsertImage - PictureUploadLargeImageEnabled is false"),16;if(!Lc)return 16;Ia=[];tb=0;Qb=!1;for(const Jd of Lc)if(tb++,"string"===typeof Jd.type)if(Lc=Z.a.vg(Jd.type),$d.a.J(37848269,822,50,"PictureActor::HandleDragAndInsertImage - No.{0} file  Size In Bytes:{1}; Tpye:{2} ",
tb,Jd.size,Lc),0<=Lc.indexOf("image")&&0===this.Mz.rmd(Jd.name))if(Ia.length<this.Ha.powerPointDragInsertMultipleImageQuantityLimit)Array.add(Ia,Jd);else{this.ql.OM(19);break}else Qb||(this.ql.OM(18),Qb=!0);if(1>Ia.length)return $d.a.J(37818453,822,15,"PictureActor::HandleDragAndInsertImage - unlegal image format"),16;this.Mz.eHi(Ia);return 32}Chg(Ia,tb,Qb){if(!(this.ua&&this.ua.Ca&&this.Mz))return 16;if(1===tb)return 32;this.jF.wva=new Date;this.tAb&&this.ob.fj();this.Ga.Bd();this.Zb.blockContent(this.ua.presentation,
Ia);const qc=gb.a.Db;this.Mz.Xhd(Qb,Lc=>{gb.a.iK(qc,()=>{$d.a.J(539083458,822,50,"Picture upload successful");this.N2d(Qb,Lc,Ia);this.a4f()})},Lc=>{$d.a.J(539083459,822,10,"Upload picture failed");this.V6a(Lc.error);this.a4f()});return 32}Pnj(Ia,tb,Qb){if(!(this.ua&&this.ua.Ca&&this.Mz))return 16;if(1===tb)return 32;const qc=String.format("{0}{1}","client",De.a.create().toString());$d.a.J(20836808,822,50,"Client generated imageToken:{0}, imageSize:{1}",qc,Qb.OP);this.jF.hai(qc);const Lc=gb.a.Db;Lc&&
(tb="InsertPicture",this.tAb||(tb="ChangePicture"),Lc.actionName=tb,Lc.Nj=!0);const Jd=new Date;gb.a.ik("PictureUploadStart",gb.a.Ve(Jd));gb.a.ik("ImageSize",Qb.OP.toString());gb.a.ik("ImageToken",qc);const le=this.ua.Ca.sid;this.ia.Ma(Na.a.g6d,2,le);this.Mz.Xhd(Qb,je=>{gb.a.iK(Lc,()=>{$d.a.J(539084955,822,50,"Upload picture completed");gb.a.ik("PictureUploadDurationMS",(+new Date-+Jd).toString());this.Hsk(qc,je);this.ia.Ma(Na.a.rQc,2,le)})},je=>{this.jF.cZf(qc);var Gf=Object.assign(new Fc,{ImageToken:qc,
ErrorCode:je.error.Code});Lc&&Lc.Ya("UploadPictureErrorCode",Qd.a[Gf.ErrorCode]);Gf=new zc.a(Gf,null,()=>rd.xjk());this.Yh.Hb(Gf);$d.a.J(21066320,822,10,"Upload picture failed, ImageToken:{0}, ErrorCode:{1}, Error Message:{2}",qc,Qd.a[je.error.Code],je.error.Message);this.ia.Ma(Na.a.rQc,2,le)},qc);this.insertPicture(qc,Ia,Qb);return 32}Zhj(Ia,tb,Qb){Ia=this.US?this.Y5a():this.Srb();if(!(this.US?this.Lug(Ia):this.Mug(Ia)&&this.Ha.VSc&&this.jF.nsg&&!this.Zb.gd(Ia)))return 16;if(1===Qb)return 32;this.tAb=
!1;this.Akc(!0,!1);return 32}rmj(Ia,tb,Qb){return this.sNa(tb,Qb,Yc.leh,Ia)}smj(Ia,tb,Qb){return this.sNa(tb,Qb,Yc.eRk,Ia)}tmj(Ia,tb,Qb,qc,Lc){return this.sNa(tb,1,Lc,Ia)}$hj(Ia,tb,Qb,qc,Lc){return this.sNa(tb,Qb,Lc,Ia)}sNa(Ia,tb,Qb,qc){const Lc=this.ob.he();if(!(Lc&&0<Lc.length))return 8;Ia=[];for(const le of Lc){if(this.kHj(le)||this.Zb.gd(le))return 8;(this.US?this.Lug(le):this.Mug(le))&&Ia.push(le)}if(0>=Ia.length)return 8;if(1===tb)return 32;$d.a.J(539502403,822,15,"PictureStyle change started. PictureStyleId: '{0}'",
Qb);tb=gb.a.Db?gb.a.Db.actionName:null;for(var Jd of Ia)this.OOa(Jd);Jd=this.Jb.xd(15,void 0,()=>{this.ob.fj();this.Ga.Bd()});try{Jd.lc(Ia[0]);Jd.fd=qc;for(const le of Ia)le.ndb=Qb}finally{Jd&&Jd.dispose()}if(qc=gb.a.Db)tb&&(qc.actionName=tb),qc.Ya("PictureStyleId",Qb.toString()),gb.a.Zda(qc);return 32}N2d(Ia,tb,Qb){this.jF.vva=new Date;const qc=tb.result;if(Ia){if(this.tAb?(tb="InsertPicture",this.Dxj(qc,Ia,Qb)):(tb="ChangePicture",xf.a("ChangePictureOnMultiSelectionEnabled")?this.rLd(qc,Ia,Qb):
this.Cii(qc,Ia,Qb)),Ia=gb.a.Db)Ia.actionName=tb,Ia.Ya("PictureUploadStart",gb.a.Ve(this.jF.wva)),Ia.Ya("PictureUploadDurationMS",(+this.jF.vva-+this.jF.wva).toString())}else Ia=Object.assign(new ce.a,{Code:94}),this.V6a(Ia)}Hsk(Ia,tb){this.jF.cZf(Ia);tb.result||$d.a.J(21066322,822,50,"Upload picture completed with null response")}Dxj(Ia,tb,Qb){const qc=this.ua.Ca;if(qc&&qc.isConnected){this.QSa=qc.g2(this.ob.he());var Lc=this.Jb.xd(15,void 0,void 0,()=>{this.ob.selectShape(this.BI,!0);this.Ga.Bd()});
try{Lc.lc(qc),Lc.fd=Qb,Lc.iy[Ta.a.YAa]=Ta.a.u4f,this.BI=this.rm.rvi(qc.Cb),this.QSa&&(this.BI.Haa=this.QSa.id),this.BI.PFb(Ia.ItemId,this.Ha.qRa?null:tb.fileName,tb.fileName),qc.uB(this.BI)}finally{Lc&&Lc.dispose()}this.Zb.Hpa(this.ua.Ca,this.BI,this.Pb.Na,"InsertPictureAfterUpload");this.Ix.oI=this.BI}}rLd(Ia,tb,Qb){const qc=this.ob.he();if(qc){for(var Lc of qc)this.OOa(Lc);Lc=this.Jb.xd(15);try{Lc.fd=Qb;Lc.lc(qc[0]);for(const Jd of qc)Jd.Haa=Jd.id,this.Ha.qRa?(Jd.PFb(Ia.ItemId,null,tb.fileName),
Jd.set_alt("")):Jd.PFb(Ia.ItemId,tb.fileName,tb.fileName)}finally{Lc&&Lc.dispose()}for(const Jd of qc)this.Zb.Hpa(this.ua.Ca,Jd,this.Pb.Na,"ChangePictureAfterUpload")}}Cii(Ia,tb,Qb){const qc=this.US?this.Y5a():this.Srb();if(qc){this.OOa(qc);var Lc=this.Jb.xd(15);try{Lc.fd=Qb,Lc.lc(qc),qc.Haa=qc.id,this.Ha.qRa?(qc.PFb(Ia.ItemId,null,tb.fileName),qc.set_alt("")):qc.PFb(Ia.ItemId,tb.fileName,tb.fileName)}finally{Lc&&Lc.dispose()}this.Zb.Hpa(this.ua.Ca,qc,this.Pb.Na,"changePictureAfterUploadSingleImage")}}V6a(Ia){this.jF.vva=
new Date;$d.a.J(21010250,822,50,"Upload picture failed");this.Wd.YH(Ia.Code,tb=>{tb.$C=1;tb.Z4a=Ia.ExtraErrorParam;return!1})}a4f(){this.Zb.mJ(this.ua.presentation)}Akc(Ia,tb){this.Dle?id.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.Mz&&(this.Mz.mVc=this.J8b,this.Mz.jJb=0,Ia&&this.Mz.y6g(tb))}Srb(){const Ia=this.ob.he();for(const tb of Ia)if(tb&&tb.sk)return tb;return null}Y5a(){const Ia=this.ob.he();return Ia&&Ia.length?this.jId(Ia)?Ia[0]:this.Srb():null}jId(Ia){if(!Ia||
!Ia.length)return!1;let tb=Ia[0].sk,Qb=1===Ia[0].mediaType;for(const qc of Ia)tb=tb&&qc.sk,Qb=Qb&&1===qc.mediaType;return tb||Qb}Nk(Ia){return Ia?Object(Qc.a)(133,Ia.pc(this.Pb.Na)):null}OOa(Ia){Ia&&Ia.qy&&(Ia=this.Nk(Ia))&&Ia.Z_(!1)}Mug(Ia){return this.ua&&this.ua.Ca&&Ia&&Ia.sk?!0:!1}Lug(Ia){return this.ua&&this.ua.Ca&&Ia&&(Ia.sk||1===Ia.mediaType)?!0:!1}kHj(Ia){return this.ua&&this.ua.Ca&&Ia&&Ia.hq?!0:!1}insertPicture(Ia,tb,Qb){var qc=this.ua.Ca;const Lc=Object(Qc.a)(316,qc.pc(this.Pb.Na)),Jd=this.OFa.Cb;
if(qc&&qc.isConnected&&Lc&&this.OFa&&this.OFa.isConnected){qc=this.OFa.Mu();this.QSa=this.OFa.g2(this.ob.he());var le,je;({vUd:je,uC:le}=this.BTa.hNd(this.QSa,Qb.imageWidth,Qb.imageHeight));var Gf=this.Jb.xd(15,void 0,()=>{this.ob.gy();this.ob.Rh();this.Ga.Bd()},()=>{this.Ix.oI=this.BI;this.ob.selectShape(this.BI,!0)});try{Gf.lc(this.OFa);Gf.fd=tb;this.BI=this.rm.eqa(!0,Jd.cid,Jd.sid,0,le.x,le.y,je.width,je.height,qc+1,!1);const Wf=this.BTa.zJd(this.Pb.Ed,je,le,Lc.wV);this.BI.BT=Wf;this.QSa&&(this.BI.Haa=
this.QSa.id,this.OFa.xT([this.QSa]));this.BI.PFb(Ia,this.Ha.qRa?null:Qb.fileName,Qb.fileName);this.BI.isResizable=!0;this.BI.K3b=!0;this.BI.DK=!0;this.BI.qGa=!0;this.BI.sk=!0;this.BI.Gqb=!!Qb.DBb;this.BI.kca=Qb.DBb||Qb.CPc;this.OFa.uB(this.BI)}finally{Gf&&Gf.dispose()}gb.a.jRe()}}static aMj(Ia){return!!Ia&&!!Ia.fileName&&Ia.fileName.toLowerCase().indexOf(".svg")===Ia.fileName.length-4}static xjk(){$d.a.J(22120035,822,50,"NotifyImageUploadFailureRequest failed");return!0}}Object(h.a)(rd,"PictureActor",
null,[234]);var Yd=d(110),me=d(207),Db=d(703),af=d(883),bg=d(85);class Qe extends Sys.EventArgs{constructor(Ia,tb){super();this.IIj=Ia;this.RTc=tb}}Object(h.a)(Qe,"TokenRefreshEventArgs",Sys.EventArgs,[]);class Af{constructor(Ia,tb,Qb,qc,Lc,Jd,le){this.nAb=0;this.Oc=Ia;this.Ioe=tb;this.Gt=Qb;this.ia=qc;this.so=Lc;this.Bb=Jd;this.Ha=le;this.Ioe&&this.Ioe.Gzc(Object(u.a)(this,this.b0g,"onTokenRefreshed"))}yLd(Ia){!this.Ha.podTokenRefreshImprovementEnabled&&this.Bb.Fra&&this.Bb.XWa();const tb=db.a.instance.vDa(e.AFrameworkApplication.Kl),
Qb=db.a.instance.wTc(e.AFrameworkApplication.Kl,e.AFrameworkApplication.qga);$d.a.J(41562886,801,tb||Qb?15:50,"SessionRehydrationController::CheckAccessTokenExpiry - IsExpired:{0}, IsExpiring:{1}, Trigger:{2}, Improvement:{3}, RetryCount:{4}",tb,Qb,Ia,this.Ha.podTokenRefreshImprovementEnabled,this.nAb);db.a.instance.Aob();this.Ha.podTokenRefreshImprovementEnabled&&this.Bb.Fra&&this.Bb.XWa()}b0g(Ia,tb){$d.a.J(41562888,809,50,"PPTTokenRefreshManager::OnTokenRefreshed");try{const Qb=Object(Qc.a)(Lb,
tb)||new Lb(null,null),qc=Qb.tokens,Lc=Qb.errors;Ia="";if(void 0===Lc||null===Lc||0>=Lc.count)for(tb=0;tb<qc.count;tb++)if(qc.ga(tb).Name===yd.a.vYk){const le=qc.ga(tb)?qc.ga(tb):null;Ia=le&&le.Value&&0<le.Value.length?le.Value:"";break}const Jd=db.a.instance.vDa(e.AFrameworkApplication.Kl);$d.a.J(540366599,809,50,"PPTTokenRefreshManager::OnTokenRefreshed fTokenExpired:{0} m_applicationSettings.PPTOTokenRefreshRetryEnabled:{1} m_tokenRefreshRetryCount:{2} m_applicationSettings.PPTOTokenRefreshRetryLimit:{3}",
Jd,this.Ha.Kye,this.nAb,this.Ha.R4g);if(0<Ia.length&&Jd&&this.Ha.Kye&&this.nAb<this.Ha.R4g)$d.a.J(51205124,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refreshed successfully but is expired. NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}, RetryEnabled:{4}, CurrentRetryCount:{5}",(new Date).getTime(),new Date,e.AFrameworkApplication.Kl,new Date(e.AFrameworkApplication.Kl),this.Ha.Kye,this.nAb),this.nAb++,this.yLd(2);else if(0<Ia.length&&!Jd){$d.a.J(41562890,809,Jd?
15:50,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed successfully, NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}",(new Date).getTime(),new Date,e.AFrameworkApplication.Kl,new Date(e.AFrameworkApplication.Kl));me.App.CYd=e.AFrameworkApplication.Opb=Z.a.Me(Ia);const le=this.Gt.ufc.presentationId.$Me+"&access_token="+encodeURIComponent(e.AFrameworkApplication.accessToken)+"&access_token_ttl="+encodeURIComponent(e.AFrameworkApplication.Kl.toString());this.Gt.ufc=
new af.a(new Db.a(le));this.Oc.w9g(new Qe(this.so?this.so.XY:!1,!0))}else{if(xf.a("CleanPIIFromC49mm")&&Lc)for(let le of Lc)if(le.Errors)for(const je of le.Errors)"403"===je.Id&&je.Details&&je.Details.startsWith("<")&&(je.Details=null);$d.a.J(41562892,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed, errors: {0}, RetryCount:{1}",Lc?Yd.c(Lc):"There is no error in Refreshed Token, but GetFileUrl is empty",this.nAb);Lc&&0<=Yd.c(Lc).indexOf("The caller is not authenticated")?
(e.AFrameworkApplication.zo(bg.a.Fh(383)),Zc.Health.instance.recordQosError("WopiTokenRefreshFailedOnHostUnauth",["SessionExpired"],!1,!0,!1,!0,null)):(e.AFrameworkApplication.zo(bg.a.Fh(380)),Zc.Health.instance.recordQosError("WopiTokenRefreshFailed",["SessionExpired"],!1,!0,!0,!0,null));e.AFrameworkApplication.tu&&e.AFrameworkApplication.tu.Q6();this.Oc.w9g(new Qe(this.so?this.so.XY:!1,!1));this.ia.Ma(Na.a.refresh,2,{refreshtrigger:"PPTTokenRefreshManager::OnTokenRefreshed"})}}catch(Qb){$d.a.J(41562894,
809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed and throw exception, exception: {0}",Yd.c(Qb))}}dispose(){this.Ioe.zDe(Object(u.a)(this,this.b0g,"onTokenRefreshed"))}}Object(h.a)(Af,"PPTTokenRefreshManager",null,[855]);var tf=d(86),uf=d(637);class kg{constructor(Ia,tb,Qb,qc,Lc,Jd){this.QW=this.Bxl=this.dEe=null;this.DYb=this.KUd=!1;this.E3c=0;this.Whb=gb.a.Nm("SeamlessFailover");1!==tb&&2!==tb||gb.a.xvb();this.Bj=new Date;gb.a.Ivb=this.startTime;this.gQh=Qb;this.SNa=
0;this.URh=tb;this.UJh=qc;this.fvc=Lc;this.Rll=Jd;this.HNi=!1;this.resultCode=0;this.j1e=!0;if(Ia=e.AFrameworkApplication.Zc)this.Vc.Ya("Host",Object(Qc.a)(String,Ia.Host)),this.Vc.Ya("Ring",Object(Qc.a)(String,Ia.Ring))}olh(Ia,tb){this.E3c=window.setTimeout(Ia,tb)}Tel(){this.j1e=!1}dispose(){gb.a.k5b=new Date;0<=this.E3c&&(window.clearTimeout(this.E3c),this.E3c=-1)}get ENi(){return this.j1e}get Vc(){return this.Whb}get startTime(){return this.Bj}get pok(){return this.gQh}get Kva(){return this.URh}get VMi(){return this.UJh}get podsCleaningRequestPattern(){return this.fvc}}
Object(h.a)(kg,"SeamlessFailoverState",null,[109]);var Lg=d(880),$g;(function(Ia){Ia[Ia.unknown=0]="unknown";Ia[Ia.mouse=1]="mouse";Ia[Ia.keyboard=2]="keyboard";Ia[Ia.podsPopsUnavailable=4]="podsPopsUnavailable"})($g||($g={}));Object(h.b)("RehydrationTrigger",$g);var yf=d(647),Kf=d(938),dd=d(52);class lg{constructor(Ia,tb,Qb,qc,Lc,Jd,le,je,Gf,Wf,fh,zh,Qg,Rg,wi,Ng,Fj,Hh,gg,Og,vg,Sg,wh){this.Ae=this.xee=null;this.Oqe=this.f4c=-1;this.pNg=0;this.Kab=Ia;this.la=tb;this.Wb=Qb;this.ia=qc;this.Bb=Lc;this.YB=
Jd;this.Ee=le;this.Xe=Gf;this.Ey=Wf;this.Wd=fh;this.Zl=zh;this.Vh=Qg;this.hc=Rg;this.NN=wi;this.Dz=Hh;this.Joe=new Date;this.Xu=Ng;this.FG=Fj;this.ua=gg;this.kc=Og;this.B9b=vg;this.cL=Sg;wh.execute(ci=>{this.xee=ci});this.wYc=[];this.t5j=this.kc.Gc("SeamlessFailoverMaxRetryAttempts",0);this.s5j=this.kc.ka("SeamlessFailoverIncludePopsInfoInFinalLog");this.u5j=this.kc.ka("SeamlessRehydrationAbortOnAbortedOnExitAppQosEnabled");$d.a.J(594027746,809,50,"PodSeamlessFailoverManager::PodSeamlessFailoverManager()")}get XY(){return!!this.Ae&&
this.Ae.ENi}get i1f(){return this.pNg}REd(Ia){if(this.XY){e.AFrameworkApplication.wz&&(this.Vh.Jhc(Object(u.a)(this,this.Hda,"onWopiTokenRefreshed")),this.GUb());var tb=0;if(this.la.C3b)this.Ae.Vc.fB("Result","abortedOnIrmProtectedFile"),tb=365;else if(this.Ae.Vc.fB("Result",Ia),"abortedOnExitApp"!==Ia||this.u5j)tb=4===this.Ae.Kva?356:357;this.Neb(!1,tb,!this.Ae.DYb&&"abortedOnRefreshDoc"!==Ia)}}lQe(Ia,tb,Qb){if(this.XY)$d.a.J(36517642,801,15,"PodSeamlessFailoverManager::TriggerFailover skipped");
else{e.AFrameworkApplication.tu||(e.AFrameworkApplication.tu=$d.a.$Vb());this.Wd.disabled=!1;this.Wd.qia=!1;this.Ae=new kg(Ia,tb,this.Ee.podSessionId,this.la.podsCleanPendingTasksAndRequestsWhenFailover,this.la.podsCleaningRequestPattern,Qb);this.la.wopiTokenRefreshLongerTimeoutIsEnable||this.Ae.olh(Object(u.a)(this,this.gXg,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs);this.Ae.Vc.Ya("PopsAvailable",this.Xe.Yz.toString());this.Ae.Vc.Ya("OrderlyShutdown",Ia.toString());this.Ae.Vc.Ya("Trigger",
$g[tb]);this.Ae.Vc.Ya("TriggerErrorCode",Qd.a[Qb]);this.Ae.Vc.Ya("OldPodsId",this.Ae.pok);this.Ae.Vc.Ya("OldPopsId",this.Ee.uk);$d.a.J(51651745,809,50,"PodSeamlessFailoverManager::TriggerFailover:ActionID:{0}; ActionDetails:{1}",this.Ae.Vc.actionId,this.Ae.Vc.dIb());if(1===tb||2===tb)e.AFrameworkApplication.Xg=!1,this.ua.presentation&&this.ua.presentation.JEe();this.Vh.Qzc(Object(u.a)(this,this.Hda,"onWopiTokenRefreshed"));e.AFrameworkApplication.wz&&db.a.instance.Aob()?($d.a.J(39326797,809,15,"FileUrlExpired on TriggerFailover, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",
(new Date).getTime(),new Date,e.AFrameworkApplication.Kl,new Date(e.AFrameworkApplication.Kl)),this.GUb(),this.f4c=window.setTimeout(Object(u.a)(this,this.nnk,"onWopiTokenRefreshTimeout"),this.la.wopiTokenRefreshTimeoutDuringRehydrationInMs),this.la.B3g&&this.B9b.Z3f(!1)):(this.Vh.Jhc(Object(u.a)(this,this.Hda,"onWopiTokenRefreshed")),this.dwh(tb))}}KNi(Ia){if(Array.contains(this.la.podTriggerFailoverOnServerErrorsCandidates,bg.a.Fh(Ia).toString())){if(!this.wYc.length)return!0;const tb=new Date;
let Qb=0;for(let qc=this.wYc.length-1;0<=qc;qc--){const Lc=this.wYc[qc];if(+tb-+Lc.startTime>this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)break;Lc.Rll===Ia&&Qb++}if(Qb<this.la.podTriggerFailoverOnServerErrorsMaxTry)return!0;$d.a.J(41763585,809,10,"PodSeamlessFailoverManager::FTriggerFailoverForServerError - Failover for Error[{0}] has been triggered for {1} times within {2}ms. Skip.",Ia,Qb,this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)}return!1}dwh(Ia){e.AFrameworkApplication.wz&&
(this.Vh.Jhc(Object(u.a)(this,this.Hda,"onWopiTokenRefreshed")),this.GUb());if(++this.pNg>this.t5j)this.u2d("SeamlessFailoverMaxRetryCountReached",392);else if(this.la.wopiTokenRefreshLongerTimeoutIsEnable&&this.Ae.olh(Object(u.a)(this,this.gXg,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs),+new Date-+this.Joe>=36E5*this.la.powerPointPodRecoveryStorageAgeThreshold)this.u2d("RecoveryStreamExpired",358);else{if(this.Ae.KUd&&(this.Ae.Vc.fB("Trigger",$g[Ia]+"_GetFileUrlExpired"),
this.AAj())){this.u2d("GetFileUrlExpired_NoAzureBackup",364);return}this.Ae.VMi&&this.Eki();this.Vh.Abd(new yf.a(4===Ia?5:2));this.Vh.tDk();this.la.podsClosePopSessionBeforeSeamlessFailoverEnabled&&4===Ia&&($d.a.J(38084740,801,15,"PodSeamlessFailoverManager::TriggerFailover - Close PopSesion: {0}",this.Ee.uk),this.NN.fob(()=>{},()=>{}));this.Zl.isPaused||this.Zl.pause();this.Ae.Vc.Dm("CreatePodsWithRetryST",new Date);this.Ae.Vc.Dm("SessionStartTime",this.Joe);this.rah()}}u2d(Ia,tb){this.Bb.Fra&&this.Bb.XWa();
this.Ae.Vc.fB("Result",Ia);this.Neb(!1,tb)}nnk(){this.Vh.Jhc(Object(u.a)(this,this.Hda,"onWopiTokenRefreshed"));this.GUb();$d.a.J(39376348,809,50,"WopiTokenRefreshed timeout during TriggerFailover");this.Ae.Vc.Ya("WopiTokenRefreshed","TO");e.AFrameworkApplication.zo(bg.a.Fh(382));Zc.Health.instance.recordQosError("WopiTokenRefreshTimeoutOnRehydration",["SessionExpired"],!1,!0,!0,!0,null);e.AFrameworkApplication.tu&&e.AFrameworkApplication.tu.Q6();this.Ae.DYb=!0;this.ia.Ma(Na.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::OnWopiTokenRefreshTimeout"})}Hda(Ia,
tb){Ia=tb.RTc;this.Vh.Jhc(Object(u.a)(this,this.Hda,"onWopiTokenRefreshed"));this.GUb();this.la.B3g&&this.B9b.Z3f(!0);tb=0<e.AFrameworkApplication.Kl&&(new Date).getTime()>=e.AFrameworkApplication.Kl-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs;$d.a.J(39376350,809,50,"WopiTokenRefreshed during TriggerFailover, IsTokenRefreshedSuccessfully: {0}, NowTicket: {1}, NowDateTime:{2}, AccessTtl:{3}, AccessTtlDateTime: {4}",Ia,(new Date).getTime(),new Date,e.AFrameworkApplication.Kl,new Date(e.AFrameworkApplication.Kl));
this.Ae.Vc.Ya("WopiTokenRefreshed","True");this.Ae.Vc.Ya("WopiTokenRefreshedSuccessfully",Ia.toString());this.Ae.KUd=tb;Ia?this.dwh(this.Ae.Kva):this.Ae.DYb=!0}GUb(){-1!==this.Oqe&&(window.clearTimeout(this.Oqe),this.Oqe=-1);-1!==this.f4c&&(window.clearTimeout(this.f4c),this.f4c=-1)}AAj(){const Ia=Z.a.vg(this.kc.Ia(dd.a.pa(152))||""),tb=!e.AFrameworkApplication.Qg.IsRealEdit&&1!==this.Ae.Kva&&2!==this.Ae.Kva;return".pptx"!==Ia&&".ppsx"!==Ia||tb}Eki(){try{let Ia=0,tb=0;const Qb={},qc={};this.Dz.cXh(Lc=>
{if(-1<Lc.request.get_url().search(new RegExp(this.Ae.podsCleaningRequestPattern,"i")))return this.Lvh(Qb,this.Tbg(Lc.request.get_url())),Ia++,!0;this.Lvh(qc,this.Tbg(Lc.request.get_url()));tb++;return!1});$d.a.J(38098781,801,15,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests - abort {0} requests: {1}, remain {2} request: {3}",Ia,Qb,tb,qc)}catch(Ia){$d.a.J(38098785,801,10,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests failed. {0}",Ia)}}Tbg(Ia){let tb=Ia;const Qb=Ia.indexOf("?");
0<Qb&&(tb=Ia.substr(0,Qb));Ia=tb.lastIndexOf("/");0<Ia&&(tb=tb.substr(Ia+1));return tb}Lvh(Ia,tb){Ia[tb]=tb in Ia?Ia[tb]+1:1}gXg(){this.XY&&(this.Ae.Vc.fB("Result","Timeout"),this.Ae.Vc.Ya("TimeoutDuration",(+new Date-+this.Ae.startTime).toString()),this.Neb(!1,4===this.Ae.Kva?354:355))}Neb(Ia,tb=0,Qb=!0){if(this.XY){this.Ey.ieb(Object(u.a)(this,this.Cda,"onPodSessionRefreshed"));this.Wb.Gi.contentReplicator.Chc(Object(u.a)(this,this.rVg,"onAfterReplication"));var qc=+new Date-+this.Joe>=6E4*this.la.pptEditorFileGetUrlExpireTimeInMinutes;
e.AFrameworkApplication.wz&&(qc=0<e.AFrameworkApplication.Kl&&(new Date).getTime()>=e.AFrameworkApplication.Kl-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs)&&$d.a.J(39326802,809,15,"FileUrlExpired on SeamlessFailoverEnd, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,e.AFrameworkApplication.Kl,new Date(e.AFrameworkApplication.Kl));Ia&&qc&&this.Ae.Vc.Ya("SkipPopsReason","FileUrlExpired");this.hc.BAg();var Lc=this.Ae.Kva;this.Ae.Vc.Ya("IsInEditingMode",
this.hc.An.toString());this.Ae.Vc.Ya("IsPreviousModeEditing",this.hc.bTc.toString());this.Ae.Vc.Ya("IsLastKnownModeEditing",this.hc.b9d.toString());this.Ae.Vc.Ya("PopSessionEverInitialized",this.Xe.zec.toString());this.Ae.Vc.Ya("ResultErrorCode",Qd.a[tb]);this.Ae.Vc.Ya("RefreshPage",Qb.toString());this.Ae.Vc.Ya("FRehydrationInitiatedPageRefresh",this.Ae.DYb.toString());this.Ae.HNi=Ia;this.Ae.resultCode=tb;this.Ae.Tel();this.wYc.push(this.Ae);this.s5j||this.qJc();Ia?(this.Vh.Y8g(new Kf.a(Lc)),this.lwh(qc,
Lc)):(this.qJc(),0!==tb&&(Ia=bg.a.Fh(tb),e.AFrameworkApplication.zo(Ia),Zc.Health.instance.recordQosError(bg.a.y6(Ia),["UnexpectedAppRefresh"],399===tb,!1,!0,Qb,null)),Qb?(e.AFrameworkApplication.tu&&e.AFrameworkApplication.tu.Q6(),this.ia.Ma(Na.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::SeamlessFailoverEnd"})):(this.Vh.Y8g(new Kf.a(Lc)),this.lwh(qc,Lc)))}}EYb(){return this.Ae&&this.Ae.Vc?!0:!1}qJc(){this.EYb()&&($d.a.J(593842569,801,15,"Action Telemetry: {0}",this.Ae.Vc.dIb()),this.Ae.Vc.finish(!0),
this.Ae.dispose(),this.Ae=null)}lwh(Ia,tb){!this.hc.AK||Ia||2!==tb&&1!==tb&&4!==tb?(this.EYb()&&this.Ae.Vc.Ya("PopsRehydrationAttempted","false"),$d.a.J(41769048,809,15,"TriggerRehydrateHostSession is skipped isFileUrlExpired:{0}, rehydrationTriger:{1}",Ia,tb),this.YRf(null)):(this.EYb()&&this.Ae.Vc.Ya("PopsRehydrationAttempted","true"),this.NN.$da(4===tb?6:7,Object(u.a)(this,this.Txi,"createPopSessionSucceededCallback"),Object(u.a)(this,this.YRf,"createPopSessionFailedCallback")))}Txi(){this.EYb()&&
(this.c3f(),this.Ae.Vc.Ya("POPSessionCreated","true"),this.qJc())}YRf(){if(!this.EYb())return!1;this.c3f();this.Ae.Vc.Ya("POPSessionCreated","false");this.qJc();return!1}c3f(){this.Ae.Vc.fB("IsInEditingMode",this.hc.An.toString());this.Ae.Vc.fB("IsPreviousModeEditing",this.hc.bTc.toString());this.Ae.Vc.fB("PopSessionEverInitialized",this.Xe.zec.toString())}Tll(Ia){$d.a.J(594028050,801,50,"PodSeamlessfailoverManager TriggerFontsInstallationCallback started with UserHasValidLicenseForEnterpriseFonts:{0}, PPTOEnterpriseFontsEnabled:{1}",
this.kc.ka("UserHasValidLicenseForEnterpriseFonts"),this.kc.ka("PPTOEnterpriseFontsEnabled"));this.kc.ka("UserHasValidLicenseForEnterpriseFonts")&&this.kc.ka("PPTOEnterpriseFontsEnabled")&&Lg.a(Ia)}rah(){this.Ae.QW=uf.a();this.Bb.Fra||this.Bb.stop();let Ia=this.la.restoreRCInCreatePodSessionRequest&&this.ua.Lj?this.ua.Lj.toString():"";Ia=Z.a.replaceAll(Ia,"#","%23");this.Kab.createPodSession(this.Ae.QW,"SeamlessFailover_"+this.Ae.Kva,this.Ae.SNa,+new Date-+this.Ae.startTime,Object(u.a)(this,this.Sxi,
"createPodSessionSucceededCallback"),Object(u.a)(this,this.Rxi,"createPodSessionFailedCallback"),this.YB,this.Ee.podSessionId,Ia);this.Kab.Rsl(this.Ae.QW,Object(u.a)(this,this.Tll,"triggerFontsInstallationCallback"));this.Bb.XWa()}Sxi(Ia){if(this.XY){gb.a.Mjd=[];this.Ae.Vc.Ya("NewPodsId",this.Ae.QW);this.Ee.podSessionId=this.Ae.QW;this.Ae.Vc.Ya("CreatePodsWithRetryResult","true");this.Ae.Vc.Ya("CreatePodsRetryCount",this.Ae.SNa.toString());this.Ae.Vc.Ya("CreatePodsDuration",(+new Date-+this.Ae.startTime).toString());
this.Zl.isPaused&&this.Zl.UYa();try{this.Zl.LKf()}catch(tb){$d.a.J(38942595,801,15,"PodSeamlessfailoverManager CancelBlockedOperation failed. {0}",tb)}if(this.la.restoreRCInCreatePodSessionRequest&&Ia&&tf.a.dec in Ia&&!Z.a.Xa(Ia[tf.a.dec])){const tb=Boolean.parse(Ia[tf.a.dec]);this.Ae.Vc.Ya("RCRestoredWhenCreatePodSession",Ia[tf.a.dec]);tb?(this.Ae.Vc.fB("Result","Success"),this.Neb(!0)):(this.xee&&this.xee.Vki(),this.Ae.Vc.Ya("DocRefreshTriggered","true"),Ia={failedMachineId:null,isPlanedShutdown:!1,
fromSeamlessFailoverManager:!0},Ia.podSessionId=this.Ee.podSessionId,this.Ae.DYb=!0,this.ia.Ma(Na.a.WDb,2,Ia))}else this.gwh()}}gwh(){this.Wb.Gi.contentReplicator.xzc(Object(u.a)(this,this.rVg,"onAfterReplication"));this.Xll()}Xll(){const Ia=()=>{this.Ae.dEe=new Date;this.Ae.Vc.Dm("InboundStartTime",this.Ae.dEe);this.Wb.Gi.contentReplicator.JE(null,null,null)};$d.a.J(38140034,801,50,"PodSeamlessFailoverManager::TriggerInbound - ForceInboundSlide:{0}; ActiveSlide.Sid:{1}; PodSessionID:{2};",!0,this.ua.Ca?
this.ua.Ca.sid:0,this.Ae.QW);4===this.Ae.Kva&&this.la.podsSeamlessFailoverForceInboundSlideEnabled&&this.ua.Ca?(this.FG.DPc&&this.FG.DPc.Apg(this.ua.Ca.Cb),this.Ae.Vc.Dm("ForceInboundSlideStartTime",new Date),this.Xu.cWd(this.ua.Ca,(tb,Qb)=>{$d.a.J(38140036,801,50,"PodSeamlessFailoverManager::TriggerInbound after ForceInboundSlide - SlideId:{0}; SlideStale:{1};",tb,Qb);this.XY&&(this.Ae.Vc.Dm("ForceInboundSlideEndTime",new Date),Ia())},!0,!1)):Ia()}Rxi(Ia){if(!this.XY)return!0;const tb=+new Date-
+this.Ae.startTime;if(399===Ia)return $d.a.J(38289932,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, unsupported client - PodSessionID:{0}; Time:{1};",this.Ee.podSessionId,tb),this.Wd.YH(Ia,null),this.Neb(!1,Ia,!1),!0;if(this.Ae.KUd&&230===Ia)return $d.a.J(51516549,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, file url expired - PodSessionID:{0}; Time:{1};",this.Ee.podSessionId,tb),this.aZf("CreatePodSessionFailed_GetFileUrlFailed",
Ia),!0;if(this.Ae.SNa<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryCount&&tb<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryDurationInMs){let Qb;(Qb=this.Ae).SNa=Qb.SNa+1;$d.a.J(36517644,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, continue retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",this.Ee.podSessionId,this.Ae.SNa,tb,Ia);this.rah();return!0}$d.a.J(36517646,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, stopped retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",
this.Ee.podSessionId,this.Ae.SNa,tb,Ia);this.aZf("CreatePodSessionFailed",Ia);return!0}aZf(Ia,tb){this.Ae.Vc.Ya("CreatePodsWithRetryResult","false");this.Ae.Vc.Ya("CreatePodsRetryCount",this.Ae.SNa.toString());this.Ae.Vc.Dm("CreatePodsWithRetryET",new Date);this.Ae.Vc.fB("Result",Ia);this.Ae.Vc.Ya("CreatePodsDuration",(+new Date-+this.Ae.startTime).toString());this.Neb(!1,tb)}rVg(Ia,tb){this.XY&&(tb.lug?$d.a.J(527516498,801,50,"PodSeamlessFailoverManager::OnAfterReplication() - Current replication is outbound, replication result: {0}",
tb.I8c):(this.Ae.Vc.fB("InboundDuration",(+new Date-+this.Ae.dEe).toString()),this.Ae.Vc.fB("Result","Success"),this.Neb(!0)))}Cda(Ia,tb){this.XY&&(this.Ae.Vc.Ya("WaitPodsRefreshedDuration",(+new Date-+this.Ae.Bxl).toString()),this.Ae.Vc.Ya("NewPodsId",tb.QW),this.Ey.ieb(Object(u.a)(this,this.Cda,"onPodSessionRefreshed")),this.Zl.isPaused&&this.Zl.UYa(),this.gwh())}}Object(h.a)(lg,"PodSeamlessFailoverManager",null,[854]);class Wh{constructor(Ia,tb,Qb){this.Tsa=Ia;this.Ha=tb;this.Za=Qb}vY(){}kSb(){}r2a(Ia){Ia&&
(Array.add(Ia,tf.a.Wwe),Array.add(Ia,tf.a.C9),Array.add(Ia,tf.a.FCb),Array.add(Ia,tf.a.Wpk),Array.add(Ia,tf.a.dec))}Dba(Ia,tb){tb?((tb=Ia[tf.a.FCb])&&tb.toLowerCase()!==(this.Za.D9?this.Za.D9.toLowerCase():"")&&($d.a.J(40235543,821,15,"HandleResponseHeaders: PodInstance was updated. Id:{0};",tb),this.Za.D9=tb),this.Tsa?(Ia=Ia[tf.a.Wwe])?(this.Tsa.ccpInfo=Ia,$d.a.J(34928533,826,50,"HandleResponseHeaders: CCPInfo was updated, length: {0}",Ia.length)):$d.a.J(34928535,826,15,"HandleResponseHeaders: CCPInfo couldn't be found in response headers."):
$d.a.J(34928531,826,15,"HandleResponseHeaders: ccpInfoOwner is null so skip the response headers.")):$d.a.J(34928529,826,15,"HandleResponseHeaders: abort since argument 'responseHeaders' is null.")}}Object(h.a)(Wh,"RehydrationHeaderHandler",null,[872]);class Gd{constructor(Ia,tb,Qb,qc,Lc,Jd,le,je,Gf){this.JN=null;this.tYc=!1;this.nf=Ia;this.Oc=tb;this.V8b=Qb;this.jd=qc;this.we=Lc;this.CNg=je;this.Ha=Jd;this.so=le;this.G3c=Gf}init(){this.Oc&&(this.Oc.zGd(Object(u.a)(this,this.sessionExpired,"sessionExpired")),
this.Oc.G2a(Object(u.a)(this,this.Ekk,"onRehydrateSession")))}sessionExpired(){this.Uoh(!0);r.ULS.sendTraceTag(594616334,821,50,"Pausing health heartbeat");Zc.Health.instance.stopAllHealthTimers()}sah(Ia){this.Uoh(!1);const tb=e.AFrameworkApplication.wz||!xf.a("Rehyrdation.StopRefreshIfWopiRefreshDisable");r.ULS.sendTraceTag(544789148,821,100,"Should refresh token: {0}",tb);tb&&this.G3c&&this.G3c.yLd(0);this.Ha.podsSeamlessFailoverEnabled&&this.so.lQe(!1,Ia,223)}Ekk(){r.ULS.sendTraceTag(594616333,
821,50,"Resuming health heartbeat");Zc.Health.instance.resumeAllHealthTimers()}Uoh(Ia){this.tYc!==Ia&&this.nf&&(Ia?(this.JN||(this.JN=this.we.De(),this.JN.id="sessiontimeoutoverlay",this.JN.className="SessionTimeoutOverlay",this.JN.tabIndex=-1,this.L9h(this.JN),this.nf.appendChild(this.JN)),this.tYc=!0,this.CNg(this.JN)):(this.gVf(this.JN),this.JN&&this.JN.parentNode&&this.JN.parentNode.removeChild(this.JN),this.JN=null,this.tYc=!1))}L9h(Ia){Ia&&(this.jd.pb(E.a.click,Ia,Object(u.a)(this,this.S6a,
"handleClickEvent")),this.jd.pb(E.a.doubleClick,Ia,Object(u.a)(this,this.S6a,"handleClickEvent")),this.V8b.pb(E.a.Rf,Ia,Object(u.a)(this,this.Egg,"handleKeyEvent")),$addHandler(window,"visibilitychange",Object(u.a)(this,this.onVisibilityChange,"onVisibilityChange")))}gVf(Ia){Ia&&(this.jd.zb(E.a.click,Ia,Object(u.a)(this,this.S6a,"handleClickEvent")),this.jd.zb(E.a.doubleClick,Ia,Object(u.a)(this,this.S6a,"handleClickEvent")),this.V8b.zb(E.a.Rf,Ia,Object(u.a)(this,this.Egg,"handleKeyEvent")),$removeHandler(window,
"visibilitychange",Object(u.a)(this,this.onVisibilityChange,"onVisibilityChange")))}S6a(){this.sah(1);return!0}Egg(Ia){if(Ia.nc.ctrlKey||Ia.nc.altKey||Ia.nc.shiftKey||Ia.nc.keyCode>=I.a.KJb&&Ia.nc.keyCode<=I.a.GJa)return!1;this.sah(2);return!0}onVisibilityChange(){e.AFrameworkApplication.wz&&!window.document.hidden&&this.G3c&&this.G3c.yLd(1)}dispose(){this.Oc.ich(Object(u.a)(this,this.sessionExpired,"sessionExpired"));this.JN&&(this.gVf(this.JN),this.JN.parentNode&&this.JN.parentNode.removeChild(this.JN));
this.V8b=this.jd=null;this.tYc=!1;this.CNg=null}}Object(h.a)(Gd,"SessionRehydrationController",null,[]);class Se{constructor(){this.Ea=null}Yb(Ia){this.Ea=Ia||x.a.instance}dispose(){}}Object(h.a)(Se,"TellMePackage",null,[2,3]);var hj=d(119),cg=d(27),ed=d(15),Xg=d(103),Dh=d(910);class Qf{constructor(Ia=null,tb=null,Qb=null,qc,Lc=null){this.Xnd=null;this.hVe=!1;this.F1e=this.iib=null;this.STh=this.Utf=this.YFh=this.G1e=!1;this.Npc=null;this.hGh=null==tb?e.AFrameworkApplication.rnb:tb;this.WLh=null==
Qb?e.AFrameworkApplication.NCa:Qb;this.mUh=null==Lc?e.AFrameworkApplication.Ewa:Lc;this.kLh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeHelpOnHelpIsEnabled");this.pVh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled");this.F4k(!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIgnoreQueryForHelp"));this.gVh=!!e.AFrameworkApplication.Ba&&e.AFrameworkApplication.Ba.jb.K4b;this.hVh=!Xg.a.Fw()&&!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("TellMePeopleSuggestionIsEnabled");this.fVh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeFileSuggestionIsEnabled");this.$Jh=!!e.AFrameworkApplication.Ba&&e.AFrameworkApplication.Ba.jb.zGb;this.iVh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.DTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("HelpShowsTopSearchResult");this.$Ph=this.bkc||this.akc;this.YPh=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("OnlineCommandSuggestionsIsEnabled");this.ZPh=this.q9d;this.oNh=!!e.AFrameworkApplication.fa&&this.$wa&&e.AFrameworkApplication.fa.ka("StyledHeaderInLabelIsEnabled");this.IKh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.QKh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",
1400):1400;this.FKh=e.AFrameworkApplication.fa?parseFloat(e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.lNh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.CUh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl",
"https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.TKh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.ETh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.aUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.OTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("ShowFindInDocumentInZeroTermSearchBox")||this.hJ;this.wNh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeTemplateProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.UMh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",
!1);this.iNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIsRuleBasedSortingEnabled")&&"en-US"===e.AFrameworkApplication.uiCulture;this.tNh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeFeedbackProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.HNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeZeroTermContextualCommandSuggestionsEnabled");this.$Fh=
this.$wa&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.gLh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.fUh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==e.AFrameworkApplication.fa.Ia("Application"));
this.HGh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.sWh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1)||e.AFrameworkApplication.fa.ka("TellMePerformanceMarkerEnabled"));this.dMh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",
!1);this.hMh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.jNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",!1);this.OSh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SearchAddinByKeywords",!1);this.AFh=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchKeywordsContainDescription",!1);this.PKh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.vNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeNotesSuggestionIsEnabled")||this.Lwg;this.fMh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",
!1);this.gMh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.eMh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.jVh=this.wMj&&(this.kwe||this.lwe||this.Bdc||this.$wa&&Xg.a.Yia()&&!!e.AFrameworkApplication.fa&&(this.FGb||this.Ofb||this.Pfb||this.Qfb||this.GGb||e.AFrameworkApplication.fa.ka("ShowAnswerSearchResults")||
e.AFrameworkApplication.fa.ka("ShowDefinitionSearchResults")||e.AFrameworkApplication.fa.ka("ShowEntitySearchResults")||e.AFrameworkApplication.fa.ka("ShowWolframSearchResults")));this.BFh=!!e.AFrameworkApplication.fa&&!e.AFrameworkApplication.fa.ka("AppsForOfficeThirdPartyIsDisabled")&&e.AFrameworkApplication.fa.ka("AppsForOfficeAllowExternalMarketplace")&&e.AFrameworkApplication.ypa;this.CFh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("AppsForOfficePrivateCatalogIsEnabled");this.Yuj(Ia||
{});this.hBd="2918242107";this.gBd="1454393937";this.T0a={};this.sMa=[];this.lsi=[Xg.a.Pkd]}get application(){return this.iib}get rnb(){return this.hGh}get $Vk(){return this.hBd}get ZVk(){return this.gBd}get $1f(){return this.F1e}get KPi(){return this.G1e}get NCa(){return this.WLh}get Ewa(){return this.mUh}get Q2a(){return this.YFh}get Opj(){return this.kLh}get wil(){return this.pVh}get wMj(){return!0}get kil(){return this.jVh}get T6k(){return this.Utf}F4k(Ia){this.Utf=Ia}get $wa(){return this.gVh}get Hlc(){return this.hVh}get Glc(){return this.fVh}get COi(){return this.$Jh}get iil(){return this.iVh}get uQe(){return!1}get Bdc(){return this.$Ph}get kwe(){return this.YPh}get lwe(){return this.ZPh}get VRa(){return!1}get MTc(){return!1}get Q$d(){return this.oNh}get CKe(){return this.STh}get FGb(){return!1}get a8k(){return!1}get nQj(){return""}get E8i(){return 4}get F8i(){return 5}get W$i(){return""}get V0i(){return this.IKh}get Wcg(){return this.QKh}get Y$i(){return 1E3}get X$i(){return 1E-6}get Cfl(){return this.CUh}get vNe(){return!1}get Bfl(){return!1}get iKj(){return this.iNh}get vTc(){return!1}get w$d(){return!1}get JGj(){return!1}get IGj(){return!1}get Lwg(){return!1}get Owg(){return!1}get a2f(){return!1}get AGb(){return!1}get Ofb(){return!1}get Pfb(){return!1}get Qfb(){return!1}get GGb(){return!1}get bkc(){return this.DTh}get BGb(){return this.ETh}get akc(){return!1}get SXd(){return null}get r$d(){return!1}get Ugd(){return this.OTh}get yag(){return 0}get IXi(){return this.FKh}get wdg(){return this.TKh}get CLj(){return this.lNh}get eag(){return-3.9}get hJ(){return this.aUh}get L4b(){return this.wNh}get v9d(){return this.UMh}get bae(){return this.tNh}get UMa(){return this.$Fh}get tOj(){return this.HNh}get lia(){return this.gLh}get Qph(){return this.fUh}get obi(){return this.HGh}get hmd(){return this.sWh}get SQc(){return this.dMh}get Czj(){return this.hMh}get AKj(){return this.jNh}get ghh(){return this.OSh}get a5h(){return this.AFh}get Yq(){return this.PKh}get WRa(){return this.vNh}get Azj(){return this.fMh}get Bzj(){return this.gMh}get zzj(){return this.eMh}get b5h(){return this.BFh}get c5h(){return this.CFh}get Ip(){return!!e.AFrameworkApplication.Ba&&
e.AFrameworkApplication.Ba.jb.mo}get mo(){return!!e.AFrameworkApplication.Ba&&e.AFrameworkApplication.Ba.jb.mo}get OGj(){return!!e.AFrameworkApplication.Ba&&e.AFrameworkApplication.Ba.jb.Pma}get Ack(){return Da.getImageClass("OfficeAssistant_32x32x32")}f1i(){return Promise.reject("GetFindMatchCount method is not overridden")}ZTc(Ia){return Array.contains(appChrome.selectors.getVisibleControlIds(),Ia)}N7d(){return!1}get m9d(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeModelRankerEnabled")}get quh(){return e.AFrameworkApplication.fa?
e.AFrameworkApplication.fa.Ia("TellMeServiceHelpClassifierModelName"):""}get q9d(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeMultiLingualCommandModelEnabled")}get SOc(){return"NoOpHeaderUi"}get ksi(){return this.Npc}get parameterData(){return this.T0a}get Ynl(){return this.sMa}MKi(){if(this.Xnd&&!this.hVe&&(this.hVe=!0,this.ngd(this.Xnd),this.mo)){var Ia=x.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Ia=(new Dh.a(Ia)).MWd(this.Xnd.i$);appChrome.api.dispatch(Ia)}}get jhh(){return""}ngd(){}$Di(Ia){const tb=
[];for(let Qb=0;Qb<Ia.length;++Qb)Ia[Qb].J8k?tb.push(new ed.a(Ia[Qb].alternate,Xg.a.sxh+Qb.toString())):tb.push(new ed.a(Ia[Qb].standard,Xg.a.Pkd+Qb.toString()));return tb}Yuj(Ia){const tb={};for(let Qb in Ia){const qc=Qb,Lc=Ia[Qb];for(let Jd in Lc){const le=Jd,je=Lc[Jd];(tb[le]||(tb[le]={}))[qc]=je}}this.Npc=tb}get suh(){return""}get ruh(){return""}get fph(){return!1}}Object(h.a)(Qf,"TellMeApplicationData",null,[947]);class Yb{constructor(Ia,tb=null,Qb=!1){this.standard=Ia;this.alternate=tb;this.J8k=
Qb}}Object(h.a)(Yb,"TryQuerySet",null,[]);class li{constructor(){this.Fdf=this.Gdf=null}get Zak(){return this.Fdf}cK(Ia){this.Gdf=Ia;return this.Swi(Ia)}mdk(){this.Fdf=this.Gdf}D3i(Ia){return 8===Ia.type?String.format(CommonUIStrings.l_FindInDocumentText,Ia.QI):Ia.QI}tYi(Ia){return Ia.QI}}Object(h.a)(li,"ParameterizedCommand",null,[]);class re extends li{constructor(Ia){super();this.iLj=Ia}get commandId(){return this.iLj?"FindParameterized":"EditingFind"}get hqk(){return"Find"}Swi(Ia){if(!Ia)return null;
const tb=Z.a.le(String.format(ResourceStrings.l_ParamFindInDocTitle,Ia.QI));return ra.a(Xg.a.oAi(Ia.value),"1540292897",tb,"Find_16x16x32",null,Z.a.le(Ia.QI),tb,null,null)}}Object(h.a)(re,"FindParameterizedCommand",li,[]);var lf=d(112);class Id extends Qf{constructor(){super(window.TellMeControlMetadataOverrides);this.iib="PowerPoint";if(e.AFrameworkApplication.fa.ka("TellMeTryQueriesIsEnabled")){var Ia=[new Yb(ResourceStrings.l_TellMeTryQuery01,"",!1),new Yb(ResourceStrings.l_TellMeTryQuery02,"",
!1),new Yb(ResourceStrings.l_TellMeTryQuery03,"",!1),new Yb(ResourceStrings.l_TellMeTryQuery04,"",!1),new Yb(ResourceStrings.l_TellMeTryQuery05,"",!1)];this.sMa=this.$Di(Ia)}e.AFrameworkApplication.fa.ka("TellMeFindInDocumentIsEnabled")&&(Ia=new re(Id.hLj()),this.parameterData[Ia.commandId]=Ia,this.G1e=!0,this.F1e=Ia.commandId)}get LHa(){return lf.a.SIf}ngd(Ia){if(Ia){Ia=Ia.i$;var tb=e.AFrameworkApplication.fa;Ia["PptTellMe.Animation"]=!tb.ka("TellMeAnimationsTransitionsIsEnabled")||tb.ka(dd.a.pa(241));
Ia["PptTellMe.Transition"]=!tb.ka("TellMeAnimationsTransitionsIsEnabled");Ia["PptTellMe.SelectAll"]=!tb.ka("TellMeSelectAllResultIsEnabled");Ia["PptTellMe.AnimationNew"]=!tb.ka(dd.a.pa(241))||!tb.ka("TellMeAnimationsTransitionsIsEnabled");Ia["PptTellMe.Designer"]=!tb.ka(dd.a.pa(248));tb=tb.ka("TellMeDesktopUpSellIsEnabled");var Qb=e.AFrameworkApplication.xMj;Ia["PptTellMe.WordArtUpSellButton"]=!tb||Qb;Ia["PptTellMe.SpellCheckDictUpSellButton"]=!tb||Qb;Ia["PptTellMe.InsertAudioUpSellButton"]=!tb||
Qb;Ia["PptTellMe.InsertChartUpSellButton"]=!tb||Qb;Ia["PptTellMe.WordArtUpSellButtonEnterprise"]=!tb||!Qb;Ia["PptTellMe.SpellCheckDictUpSellButtonEnterprise"]=!tb||!Qb;Ia["PptTellMe.InsertAudioUpSellButtonEnterprise"]=!tb||!Qb;Ia["PptTellMe.InsertChartUpSellButtonEnterprise"]=!tb||!Qb}}get Lwg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeNotesSuggestionIsEnabled",!1)}get Owg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get yag(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.NumberOfNotesSuggestionsToShow",2)}get suh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermModelName","")}get ruh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMultiLanguageModelName","")}get vNe(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeServiceAADAuthIsEnabled",
!1)}get quh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeHelpClassifierModelName","")}get FGb(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowImageSearchResults",!1)}get q9d(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMLCModelIsEnabled",!1)}get fph(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowMoreFileResults",
!1)}get MTc(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeEnableRankerLogging",!1)}get SXd(){const Ia={};e.AFrameworkApplication.fa.ka("PPTOModernFontPickerIsEnabled")?Ia.FontName="FontPicker":Ia.FontPicker="FontName";e.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")?(Ia.NewSlide="NewSlideSplit",Ia.ChangeLayout="ChangeLayoutFlyout"):(Ia.NewSlideSplit="NewSlide",Ia.ChangeLayoutFlyout="ChangeLayout");return Ia}get eag(){var Ia=e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.NBClassifierScoreThreshold",
"-3.9");Ia=parseFloat(Ia);return isNaN(Ia)?-3.9:Ia}get vTc(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.IsSerpletClassifierEnabled",!1)}static hLj(){return!!e.AFrameworkApplication.Ba&&e.AFrameworkApplication.Ba.jb.Ip}}Object(h.a)(Id,"PowerPointTellMeApplicationData",Qf,[]);class We extends Se{constructor(){super()}get name(){return"PowerPointEditor.TellMe"}load(){this.init()}init(){if(e.AFrameworkApplication.luh){var Ia=cg.App.Fb.jb.C0d(Ab.a.tellMe);
Ia.CRc?We.M3g():Ia.yM(Object(u.a)(this,this.MVk,"scriptResource_LoadFinished"));var tb=new Id;hj.TellMeActor.instance.initialize(tb,null,null,null,null,null,Object(u.a)(cg.App.Fb,cg.App.Fb.b4f,"forceUpdateRibbonControls"),e.AFrameworkApplication.fa,this.Ea.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),null,this.Ea.Oa("Common.ISystemInitiatedFeedback"));hj.TellMeActor.instance.EHk(Ia)}}MVk(){We.M3g()}static M3g(){cg.App.Fb.updateCommandUI()}}Object(h.a)(We,"PowerPointTellMePackage",
Se,[]);var Wc=d(208);class Xc{constructor(){this.hh=this.C3=this.K=null}get name(){return"PowerPointWebEditor.Chronos1"}Yb(Ia){this.K=Ia;this.C3=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.hh=this.C3.YBa(4,this.name);this.K.register(Wh,"PowerPointWebEditor.RehydrationHeaderHandler").ma().na(()=>new Wh(this.K.resolve("PowerPointWebEditor.ICCPInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(Gd,
"PowerPointWebEditor.SessionRehydrationController").ma().na(()=>new Gd(this.K.resolve("Box4.IAppFrame").iG(),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IKeyInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),tb=>{A.FocusManager.xr(tb)},e.AFrameworkApplication.wz?this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"):
null));this.K.register(854,"PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager").ma().na(()=>new lg(this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IActionManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.RehydrationHeaderHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IPopWebService"),
this.K.resolve("PowerPointWebEditor.IPopSessionState"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),
e.AFrameworkApplication.Be,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPPTOfflineManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.Oa("PowerPointWebEditor.ICommentSessionManager")));e.AFrameworkApplication.wz&&this.K.register(855,"PowerPointWebEditor.IPPTTokenRefreshManager").ma().na(()=>new Af(this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("Common.ISessionExpirationManagerWithDialog"),
this.K.resolve("PowerPointWebEditor.PresentationContext"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){let Ia=this.hh.Ut("resolvechronos1");const tb=this.K.resolve("Common.AFrameworkApplication"),Qb=this.K.resolve("PowerPointWebEditor.IApplicationContext").kd;var qc=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const Lc=
this.K.resolve("Common.IActionManagerExtended"),Jd=this.K.resolve("PowerPointWebEditor.IFocusManager"),le=this.K.resolve("Common.Transaction.ITransactionFactory"),je=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Gf=this.K.resolve("PowerPointWebEditor.IShapeEditor"),Wf=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),fh=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),zh=this.K.resolve("PowerPointWebEditor.PictureContext");this.K.resolve("PowerPoint.IPathManager");
this.K.resolve("PowerPointWebEditor.IPresentationReader");const Qg=this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Rg=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),wi=this.K.resolve("PowerPointWebEditor.IPictureUploader");this.hh.au(Ia);Ia=this.hh.Ut("regactorschronos1");qc=[new rd(Lc,Wf,je,Jd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),le,wi,zh,Gf,e.AFrameworkApplication.XP,Rg,this.K.resolve("PowerPointWebEditor.IErrorHandler"),qc,this.K.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),
Qb.UEj,this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),Qg,fh,Qb,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))];for(var Ng of qc)Ng.wb(),Ng.Fe();this.Juj();this.hh.au(Ia);Ia=this.hh.Ut("tellme");Ng=new We;Ng.Yb(this.K);Ng.load(tb);this.hh.au(Ia);Qb.pptEditorTimeoutDialogRemovalIsEnabled&&Qb.zg&&(Ia=this.hh.Ut("initrehydrationcontroller"),this.K.resolve("PowerPointWebEditor.SessionRehydrationController").init(),this.hh.au(Ia));
Qb.podsSeamlessFailoverEnabled&&this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager");e.AFrameworkApplication.wz&&(Ia=this.hh.Ut("posttokenrefresh"),this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"),this.hh.au(Ia));this.nRj(Qb)}Juj(){this.K.resolve("PowerPointWebEditor.IApplicationContext");const Ia=this.K.resolve("Common.IActionManagerExtended"),tb=this.K.resolve("PowerPointWebEditor.IFocusManager"),Qb=this.K.resolve("Common.AFrameworkApplication").Uq.Fd,qc=this.K.resolve("Common.Transaction.ITransactionFactory"),
Lc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Jd=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),le=this.K.resolve("PowerPoint.IPathManager"),je=this.K.resolve("PowerPointWebEditor.IPresentationReader"),Gf=this.K.resolve("Common.IDynamicScriptLoaderProvider").gx;Gf.loadScript("powerpoint-editor-intl").then(()=>{$d.a.J(556299922,801,50,"Editor script is loaded successfully");Gf.loadScript("powerpoint-ribbon-intl").then(()=>{$d.a.J(556299923,801,
50,"Ribbon script is loaded successfully");const Wf=[];Wf.push(new Oc(Ia,tb,Jd,qc,Qb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),je,Lc,le));for(const fh of Wf)fh.wb(),fh.Fe()}).catch(()=>{$d.a.J(556299924,801,10,"Failed to load Ribbon script")})}).catch(()=>{$d.a.J(556299925,801,10,"Failed to load Editor script")})}nRj(Ia){$d.a.J(40122138,809,50,"Start to download chronos2 js file");if(Ia.Umc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Bha("pptedit.chronos2",
()=>{const tb=this.K.resolve("PowerPointWebEditor.ISessionState");tb&&tb.L_("Chronos2DownloadFinished")},()=>d.e(8).then(d.bind(null,1190)));else{Ia=fc.a.create("pptedit.chronos2",null,()=>d.e(8).then(d.bind(null,1190)));const tb=this.K.resolve("PowerPointWebEditor.ISessionState");Ia.yM(()=>{tb&&tb.L_("Chronos2DownloadFinished")});Nb.a.nt(Ia)}}dispose(){const Ia=this.K.resolve("PowerPointWebEditor.IApplicationSettings");Ia.pptEditorTimeoutDialogRemovalIsEnabled&&Ia.zg&&this.K.resolve("PowerPointWebEditor.SessionRehydrationController").dispose();
e.AFrameworkApplication.wz&&Ia.zg&&this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager").dispose()}static main(){e.AFrameworkApplication.Xg&&lb.a.ag?$d.a.J(40122140,809,15,"Firefox attempts to load chronos1 package when App is disposing"):m.a.instance.Ec(Wc.a(new Xc,4))}}Object(h.a)(Xc,"Chronos1Package",null,[2,3]);var Ld=d(634),Xf=d(150),Le=d(570),md=d(61),oj=d(46);class Ie{constructor(Ia,tb,Qb,qc,Lc,Jd){this.type="FormatPictureTaskPaneProps";this.top=this.left=this.height=this.width=this.numberFormatInfo=
null;this.disabled=!1;this.onChange=null;this.emptyValueFields=0;const le=Object(Qc.a)(Object,Hb.e().numberFormatInfo);if(!le)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=le;this.width=Ia;this.height=tb;this.top=qc;this.left=Qb;this.disabled=Lc;this.emptyValueFields=Jd}}Object(h.a)(Ie,"FormatPictureTaskPaneProps",null,[]);class qh{constructor(Ia,tb,Qb,qc,Lc,Jd,le,je,Gf,Wf,fh,zh){this.b$a=!0;this.xPg=this.AJg=this.WZ=this.u_=0;this.N$b=this.Sb=this.qEg=!1;zh.loadScript("powerpoint-editor-intl").then(()=>
{this.N$b=!0}).catch(Qg=>{$d.a.J(536987661,801,10,"Failed to load powerpoint-editor-intl "+Qg.toString())});this.ob=Ia;this.Rb=tb;this.ia=Qb;this.Ga=qc;this.yh=Lc;this.ua=Jd;this.Pb=le;this.Qj=je;this.Z7=Gf;this.Zb=Wf;this.Xc=fh;this.yh.IMa(Object(u.a)(this,this.u6c,"onChangeRenderFormatPicturePane"));this.Rb.aP(Object(u.a)(this,this.Mx,"onAppFrameModeSwitched"));this.Xc.E2a(Object(u.a)(this,this.u6c,"onChangeRenderFormatPicturePane"))}dispose(){this.yh.heb(Object(u.a)(this,this.u6c,"onChangeRenderFormatPicturePane"));
this.Rb.Q_(Object(u.a)(this,this.Mx,"onAppFrameModeSwitched"));this.Xc.rEb(Object(u.a)(this,this.u6c,"onChangeRenderFormatPicturePane"))}Fe(){}wb(){this.ia.ra(Na.a.bbd,sc.a.application,Object(u.a)(this,this.bbd,"queryShowHideReactPictureCropPane"),96);this.ia.ra(Na.a.cLe,sc.a.application,Object(u.a)(this,this.cLe,"showHideReactPictureCropPane"),4);this.ia.ra(Na.a.bJb,sc.a.application,Object(u.a)(this,this.bJb,"updatePictureCropPane"),4)}bbd(Ia,tb,Qb,qc,Lc){(Ia=Object(Qc.a)(cd.a,Lc))&&Ia.Yf(this.Sb);
return 32}cLe(Ia,tb,Qb){if(!this.N$b)return 8;if(1===Qb)return 32;tb=this.ua.presentation;return this.ua.Ca&&tb&&!this.Zb.gd(tb)?Dd.b("ShowHideReactPictureCropPane:",this.Sb.toString(),Ia,()=>{(this.Sb=!this.Sb)?this.kn():this.Pu();return 32}):16}bJb(Ia,tb,Qb){if(!this.Sb)return 8;2===Qb&&this.kn(!0);return 32}kn(Ia=!1){var tb=this.TMc();tb=this.OE(tb);const Qb=Object.assign(new Ld.a,{title:ResourceStrings.L_FormatPicture,hideHeader:!1,width:320,location:2,contentProps:tb,onOpen:()=>{},onClose:()=>
{this.Sb=!1},isModernPane:!0});Xf.UISurfaces.du().then(qc=>{Ia?qc.updateTaskPane(oj.a.cWa,Qb):qc.showTaskPane(oj.a.cWa,Qb);return null}).catch(qc=>{$d.a.J(538821909,822,10,"Failed to show picture crop pane. Exception: "+qc.toString())})}Pu(){Xf.UISurfaces.du().then(Ia=>{Ia.hideTaskPane(oj.a.cWa,2);return null}).catch(Ia=>{$d.a.J(538821910,822,10,"Failed to hide picture crop pane. Exception: "+Ia.toString())})}OE(Ia){if(Ia){const tb=Ia.VXd(),Qb=this.Pb.Ed;this.WZ=Le.a.kv(Qb.yf(this.Qj.IQ(md.a.Nl(tb.ga(0),
tb.ga(3)),Ia.zoom),1));this.u_=Le.a.kv(Qb.yf(this.Qj.IQ(md.a.Nl(tb.ga(0),tb.ga(1)),Ia.zoom),0));this.AJg=Le.a.kv(Qb.yf(this.Qj.IQ(tb.ga(0).x,Ia.zoom),0));this.xPg=Le.a.kv(Qb.yf(this.Qj.IQ(tb.ga(0).y,Ia.zoom),1));this.b$a=!1;this.qEg=!0}else this.b$a=!0;Ia=new Ie(this.u_,this.WZ,this.AJg,this.xPg,this.b$a,this.qEg?0:15);Ia.onChange=Object(u.a)(this,this.cva,"onPropertyChange");return Ia}TMc(){const Ia=this.ob.Dq();return Ia&&Ia.qy&&Ia.isConnected?this.Z7.QE(Ia):null}cva(Ia,tb){const Qb={};Qb.Number=
Ia;switch(tb){case 0:this.ia.Ma(Na.a.FSe,2,Qb);break;case 1:this.ia.Ma(Na.a.CSe,2,Qb);break;case 2:this.ia.Ma(Na.a.DSe,2,Qb);break;case 3:this.ia.Ma(Na.a.ESe,2,Qb)}this.kn(!0)}u6c(){this.Sb&&this.kn(!0)}Mx(Ia){1===Ia.mode&&this.Sb&&(this.Sb=!1,this.Pu(),this.Ga.Kj(oj.a.cWa,this.Sb))}}Object(h.a)(qh,"FormatPicturePaneActor",null,[]);var Od=d(22),ef=d(834);class dh{constructor(Ia,tb,Qb,qc,Lc,Jd,le,je,Gf,Wf,fh,zh,Qg,Rg,wi,Ng,Fj,Hh){this.Jxb=!1;if(!wi)throw Error.argumentNull("shapeReader");if(Ng&&!Fj)throw Error.argumentNull("shapeSVGDependencyLoader");
if(!Hh)throw Error.argumentNull("businessBarController");this.ia=Ia;this.sa=tb;this.Jb=Qb;this.Yh=qc;this.Zb=Lc;this.tke=Jd;this.vHg=le;this.oo=je;this.Pb=Gf;this.ua=Wf;this.Qj=fh;this.Z7=zh;this.VK=Qg;this.ZZ=Rg;this.Fa=wi;this.xka=Ng;this.Nzb=Fj;this.ql=Hh}wb(){this.ia.ra(Na.a.sAi,P.a.application,Object(u.a)(this,this.f1b,"handlePictureCropEvent"),4);this.vHg?(this.ia.ra(Na.a.KSf,P.a.application,Object(u.a)(this,this.egg,"handleCropSplitButton"),4),this.ia.ra(Na.a.LSf,P.a.application,Object(u.a)(this,
this.egg,"handleCropSplitButton"),4)):(this.ia.ra(Na.a.KSf,P.a.application,Object(u.a)(this,this.f1b,"handlePictureCropEvent"),4),this.ia.ra(Na.a.LSf,P.a.application,Object(u.a)(this,this.f1b,"handlePictureCropEvent"),4));this.ia.ra(Na.a.r7g,P.a.application,Object(u.a)(this,this.nAk,"queryIsActive"),101);this.ia.ra(Na.a.Zic,P.a.application,Object(u.a)(this,this.Qmj,"handleSendCropInfo"),4);this.ia.ra(Na.a.Dsk,P.a.application,Object(u.a)(this,this.O2d,"handlePictureCropToShapeEvent"),4);this.ia.ra(Na.a.Csk,
P.a.application,Object(u.a)(this,this.O2d,"handlePictureCropToShapeEvent"),4);this.ia.ra(Na.a.Rfc,P.a.application,Object(u.a)(this,this.yad,"queryPictureCropBounding"),100);this.ia.ra(Na.a.Tfc,P.a.application,Object(u.a)(this,this.yad,"queryPictureCropBounding"),100);this.ia.ra(Na.a.Sfc,P.a.application,Object(u.a)(this,this.yad,"queryPictureCropBounding"),100);this.ia.ra(Na.a.zad,P.a.application,Object(u.a)(this,this.yad,"queryPictureCropBounding"),100);this.ia.ra(Na.a.CSe,P.a.application,Object(u.a)(this,
this.Kld,"updatePictureCropBounding"),4);this.ia.ra(Na.a.FSe,P.a.application,Object(u.a)(this,this.Kld,"updatePictureCropBounding"),4);this.ia.ra(Na.a.DSe,P.a.application,Object(u.a)(this,this.Kld,"updatePictureCropBounding"),4);this.ia.ra(Na.a.ESe,P.a.application,Object(u.a)(this,this.Kld,"updatePictureCropBounding"),4)}egg(Ia,tb,Qb,qc,Lc){return 1===Qb?32===this.O2d(Ia,tb,Qb,qc,Lc)||32===this.f1b(Ia,tb,Qb,qc,Lc)?32:8:this.f1b(Ia,tb,Qb,qc,Lc)}Qmj(Ia,tb,Qb,qc,Lc){if(!Lc)return $d.a.J(8955532,824,
50,"Send Crop Info called with no cropping info"),8;tb=Lc.pictCropperInfo;Lc=Lc.shapeNode;if(!Lc||!Lc.pictureCropInfo)return $d.a.J(8955533,824,10,"Send Crop Info called with invalid ShapeMoniker"),8;if(1===Qb)return 32;if(Qb=gb.a.Db)Qb.actionName="EndCropPicture",Qb.Nj=!1,Qb.ur=!0;Qb=this.Jb.xd(15);try{Qb.lc(Lc),Qb.fd=Ia,Lc.oec=tb}finally{Qb&&Qb.dispose()}return 32}O2d(Ia,tb,Qb,qc,Lc){if(!this.vHg||this.Zb.gd(this.sa.ny()))return 8;tb=this.sa.mg();if(!tb||!tb.length)return 8;const Jd=[];for(var le of tb)le&&
Jd.push(le);if(!Jd.length)return 8;for(const Wf of Jd)if(Wf.isLocal||this.VK.DV(Wf)||!this.xIj(Wf))return 8;if(1===Qb)return 32;$d.a.J(545367128,824,15,"HandlePictureCropToShapeEvent:: Crop to Shape operation started");const je=Lc?Lc.SourceControlId:"";le=0;Qb=je.split("_");if(3===Qb.length)le=Number.parseInvariant(Qb[2]);else return $d.a.J(554751043,824,10,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with unknown shapeName: '{0}'",je),16;Qb=window.performance.now();Lc=new ef.a;
Lc.TargetShapeTypeAsInt=le;le=this.Jb.xd(15,void 0,()=>{for(const Wf of Jd)if(Wf.qy){const fh=this.Nk(Wf);fh&&fh.Z_(!1)}$d.a.J(542196880,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with shapeName: '{0}'",je)});try{le.lc(Jd[0]);le.fd=Ia;for(var Gf of Jd)Gf.pec=Lc}finally{le&&le.dispose()}Ia=window.performance.now();if(Gf=gb.a.Db)Gf.actionName="PictureCropToShape",Gf.Ya("PictureCropShapeType",Lc.TargetShapeTypeAsInt.toString()),Gf.Ya("PictureCropToShapeDuration",(Ia-Qb).toString()),
gb.a.Zda(Gf);$d.a.J(545367129,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation completed for shapeType : '{0}'",Lc.TargetShapeTypeAsInt);return 32}f1b(Ia,tb,Qb){if(!this.tke||this.Zb.gd(this.sa.ny()))return 16;if(this.xka&&!this.Nzb.ttg)return $d.a.J(539112145,824,10,"HandlePictureCropEvent:: Crop operation failed m_shapeSVGDependencyLoader is not loaded"),8;tb=this.sa.he();const qc=this.sa.IYd(tb);if(1!==tb.length)return xf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Qb&&this.uWf(),
8;if(!qc)return 8;if(this.Fa.my(qc).length)return xf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Qb&&this.uWf(),8;if(!this.O9d(qc))return 8;if(1===Qb)return 32;if(qc.isLocal||this.VK.DV(qc))return 16;if(qc.qy){Ia=this.Nk(qc);if(!Ia)return 8;Ia.Z_(!1);qc.pictureCropInfo=null;cg.App.Fb.updateCommandUI();this.ia.processAction(Na.a.bJb,2);return 32}this.sa.fj();const Lc=this.ua.Ca;this.Zb.blockContent(Lc,Ia);const Jd=gb.a.Db;Jd&&(Jd.actionName="BeginCropPicture",Jd.Nj=!1,Jd.ur=!0);this.Yh.dbg(qc.get_sid(),
qc.get_cid(),qc.get_shapeId(),le=>{gb.a.EE(Jd,()=>{this.Mhk(qc,Lc,le)})},()=>this.Lhk(qc,Lc),!0);return 32}nAk(Ia,tb,Qb,qc,Lc){if(!Object(Od.a)(cd.a,Lc))return 8;Ia=this.sa.Dq();Lc.Yf(Ia?Ia.qy:!1);return 32}TMc(){const Ia=this.sa.Dq();return Ia&&Ia.qy&&Ia.isConnected?this.Z7.QE(Ia):null}Nk(Ia){return Ia?Object(Qc.a)(133,Ia.pc(this.Pb.Na)):null}uWf(){this.ql.OM(26)}yad(Ia,tb,Qb,qc,Lc){if(!this.tke||!Lc)return 16;tb=this.TMc();if(!tb)return 16;Qb=tb.VXd();qc=this.Pb.Ed;Ia=Ia===Na.a.Rfc?qc.yf(this.Qj.IQ(md.a.Nl(Qb.ga(0),
Qb.ga(3)),tb.zoom),1):Ia===Na.a.Tfc?qc.yf(this.Qj.IQ(md.a.Nl(Qb.ga(0),Qb.ga(1)),tb.zoom),0):Ia===Na.a.Sfc?qc.yf(this.Qj.IQ(Qb.ga(0).x,tb.zoom),0):qc.yf(this.Qj.IQ(Qb.ga(0).y,tb.zoom),1);Lc=Lc.queryResult;null!==Lc&&(Lc.xea=parseFloat(Le.a.kv(Ia).toFixed(2)).toString());return 32}Kld(Ia,tb,Qb,qc,Lc){if(!this.tke||this.xka&&!this.Nzb.ttg)return 16;tb=this.TMc();if(1===Qb)return tb?32:16;if(!tb||!Lc)return 16;if(2===Qb){Qb=!1;qc=tb.VXd().copy();Lc=Le.a.xV(Lc.Number);const Jd=md.a.Nl(qc.ga(0),qc.ga(1)),
le=md.a.Nl(qc.ga(0),qc.ga(3)),je=this.Pb.Ed;Ia===Na.a.CSe?(Lc=this.Qj.OL(je.Ie(Lc,1),tb.zoom),Ia=Lc-le,qc.ga(2).pL(0,Ia),qc.ga(3).pL(0,Ia)):Ia===Na.a.FSe?(Lc=this.Qj.OL(je.Ie(Lc,0),tb.zoom),Ia=Lc-Jd,qc.ga(1).pL(Ia,0),qc.ga(2).pL(Ia,0)):Ia===Na.a.DSe?(Qb=!0,Lc=this.Qj.OL(je.Ie(Lc,0),tb.zoom),Ia=Lc-qc.ga(0).x,qc.move(Ia,0)):Ia===Na.a.ESe&&(Qb=!0,Lc=this.Qj.OL(je.Ie(Lc,1),tb.zoom),Ia=Lc-qc.ga(0).y,qc.move(0,Ia));tb.brl(qc,Qb)}return 32}xIj(Ia){let tb=[];Ia.Xf?tb=this.Fa.my(Ia):Ia.xh&&(tb=this.Fa.my(Ia.ys()));
if(tb.length){for(const Qb of tb)if(!this.O9d(Qb))return!1;return!0}return this.O9d(Ia)}O9d(Ia){const tb=this.oo.ENe&&!Ia.isGif&&(Ia.sk||1===Ia.mediaType)&&!Ia.get_isSVGBlipFilled();return this.ZZ?tb&&!Ia.sBb:tb}Lhk(Ia,tb){this.Zb.mJ(tb);if(!this.isActive||!Ia.isConnected)return!0;this.isActive=!1;Ia.pictureCropInfo=null;$d.a.J(19519503,824,10,"Error: Failed to perform command of Get picture crop info.");return!1}Mhk(Ia,tb,Qb){this.Zb.mJ(tb);if(Ia.isConnected)if(tb=gb.a.Db,gb.a.EE(tb,()=>{this.ia.processAction(Na.a.L3a,
2)}),this.VK.DV(Ia))$d.a.J(22131014,822,50,"Crop is cancelled due to shape manipulation");else{var qc=Ia.yg(this.Pb.Na);if(qc){var Lc=new Date;Ia.pictureCropInfo=JSON.parse(Qb.PictureCropInfoStr);this.Z7.yP(Ia).Sdl();Ia=new Date;tb&&(tb.Dm("ParseCropInfoStart",Lc),tb.Dm("ParseCropInfoEnd",Ia),gb.a.Zda(tb));qc.$D();this.ia.processAction(Na.a.bJb,2)}}}get isActive(){return this.Jxb}set isActive(Ia){this.Jxb=Ia}}Object(h.a)(dh,"PictureCropActor",null,[]);var ad=d(1162),Fg=d(190),Cd=d(184),zg=d(222),
Eh=d(131),eh=d(165),Gg=d(318),vh=d(833),ze=d(612),sg=d(47),zd=d(68),Hd=d(707),Fh=d(111),Gh=d(205),ih=d(173),ah=d(865),Fi=d(317),Wi=d(204),Mg=d(191),ee=d(206),Lf=d(305);class Vf{constructor(Ia,tb,Qb,qc,Lc,Jd,le,je,Gf,Wf,fh,zh,Qg,Rg){this.Sb=!0;this.El=!1;this.an=[];this.h3=this.JA=this.fW=this.TG=this.yI=this.Ab=null;this.$B=Array(8);this.nta=this.Mm=this.Zu=null;this.iT=this.ud=1;this.gpe=new md.a(0,0);this.en=new Fg.a;this.n_=new Cd.a;this.pac=new md.a(0,0);this.wbb=0;this.av=new Cd.a;this.Ata=new md.a(0,
0);this.pka=new md.a(0,0);this.Nac=this.HTa=!1;this.Z8b=new md.a(0,0);this.b9=this.z8=null;this.ZDg=new fb.a;this.dv=null;if(!qc)throw Error.argumentNull("clickInputManager");if(!Ia)throw Error.argumentNull("shapeNode");if(fh&&!zh)throw Error.argumentNull("transformFactory");if(fh&&!Qg)throw Error.argumentNull("presReader");this.xa=Ia;this.Fa=tb;this.uc=Qb;this.jd=qc;this.ia=Lc;this.cC=Jd;this.Ue=le;this.Nja=je;this.x5j=Gf;this.Hab=Wf;this.xka=fh;this.hn=zh;this.Ub=Qg;this.AZj=Rg}Vm(Ia){this.Ab=new Mg.a;
this.Ab.Uk(1);this.Ab.Sd(!1);this.Ab.Fma(zd.a.pfl);Ia.appendChild(this.Ab.viewport);this.yI=new Hd.a(!1,this.xka);this.Ab.appendChild(this.yI);this.TG=new Hd.a(!1,this.xka);this.Ab.appendChild(this.TG);this.TG.Uk(1);this.fW=new ih.a;this.fW.pv(od.a.f0);this.fW.sr(od.a.VD);this.fW.xF(Fh.a.none);this.fW.Uk(1);this.Ab.appendChild(this.fW);this.h3=new ih.a;this.h3.Uk(1);this.h3.Tk(zd.a.Kwa);this.h3.Fma("ShapeMoveHandle");this.h3.xF(Fh.a.none);this.Ab.appendChild(this.h3);this.JA=new Gh.a;this.iWb(this.JA);
this.Ab.appendChild(this.JA);this.Ab.viewport.za.setAttribute("class",zd.a.tec);this.Ab.Sd(!1);this.jd.pb(E.a.click,this.h3.za,Object(u.a)(this,this.I5c,"noOpHandler"));this.jd.pb(E.a.click,this.fW.za,Object(u.a)(this,this.I5c,"noOpHandler"))}iWb(Ia){for(let qc=0;8>qc;++qc){var tb="cropHandle"+qc;const Lc=new Gh.a;Lc.za.id=tb;if(lb.a.FIa){var Qb=new Fi.a;Qb.za.id=tb;Qb.setVisibility(!1);Qb.setPosition(-10,-10);Qb.Bh(20,20);Lc.appendChild(Qb)}Qb=new eh.a(qc);tb=Qb.a3b()?this.Rui(Qb,tb):this.Uyi(Qb,
tb);Lc.appendChild(tb);Lc.Uk(1);this.$B[qc]=Lc;Ia.appendChild(Lc)}}w4d(Ia){for(let tb=0;8>tb;++tb)if(this.$B[tb].za.id===Ia.id)return new eh.a(tb);return null}UJj(Ia){return Ia.id.startsWith("cropHandle")}dispose(){this.Nja();this.El=!0;this.Sb=!1;this.Ab&&this.Ab.aq();this.Ab=null;this.h3&&this.jd.zb(E.a.click,this.h3.za,Object(u.a)(this,this.I5c,"noOpHandler"));this.h3=null;this.fW&&this.jd.zb(E.a.click,this.fW.za,Object(u.a)(this,this.I5c,"noOpHandler"));this.JA=this.fW=null;this.$B&&Array.clear(this.$B);
this.z8=this.b9=this.$B=null;this.Z8b=new md.a(0,0)}Jgd(Ia,tb,Qb,qc){const Lc=this.z0d(),Jd=Ia-Lc.x+this.pka.x+Qb,le=tb-Lc.y+this.pka.y+qc;return isNaN(Jd)||isNaN(le)?($d.a.J(21288994,822,15,"PictureCropShapeView::ShiftPositionRelativeToShape - x:{0}, nodeTopLeft.X:{1}, m_maskViewPositionDiff.X:{2}, distX:{3}, y:{4}, nodeTopLeft.Y:{5}, m_maskViewPositionDiff.Y:{6}, distY:{7}, m_zoom:{8}",Ia,Lc.x,this.pka.x,Qb,tb,Lc.y,this.pka.y,qc,this.ud),new md.a(0,0)):new md.a(Jd,le)}setPosition(Ia,tb){this.HTa&&
this.xa.pictureCropInfo&&(this.Ata=Ia=new md.a(Ia/this.ud,tb/this.ud),this.Hab?(this.z8&&this.yI&&(tb=this.Jgd(this.z8.Position.X,this.z8.Position.Y,Ia.x,Ia.y),this.yI.setPosition(tb.x,tb.y)),this.b9&&this.TG&&this.TG.image&&(Ia=this.Jgd(this.b9.Position.X,this.b9.Position.Y,Ia.x,Ia.y),this.TG.image.setPosition(Ia.x,Ia.y))):((tb=this.xa.pictureCropInfo.MaskViewElem)&&this.yI&&(tb=this.Jgd(tb.Position.X,tb.Position.Y,Ia.x,Ia.y),this.yI.setPosition(tb.x,tb.y)),(tb=this.xa.pictureCropInfo.TextureViewElem)&&
this.TG&&this.TG.image&&(Ia=this.Jgd(tb.Position.X,tb.Position.Y,Ia.x,Ia.y),this.TG.image.setPosition(Ia.x,Ia.y))),this.Ab.xm())}ycl(Ia,tb){const Qb=new md.a(this.Fa.wA(this.xa,this.cC).x/this.ud,this.Fa.wA(this.xa,this.cC).y/this.ud),qc=new md.a(this.pka.x+this.Ata.x,this.pka.y+this.Ata.y);if(this.Hab)this.z8&&this.yI&&this.yI.setPosition(this.z8.Position.X-Qb.x+qc.x+Ia/this.ud,this.z8.Position.Y-Qb.y+qc.y+tb/this.ud),this.b9&&this.TG&&this.TG.image.setPosition(this.b9.Position.X-Qb.x+qc.x+Ia/this.ud,
this.b9.Position.Y-Qb.y+qc.y+tb/this.ud);else{var Lc=this.xa.pictureCropInfo.MaskViewElem;Lc&&this.yI.setPosition(Lc.Position.X-Qb.x+qc.x+Ia/this.ud,Lc.Position.Y-Qb.y+qc.y+tb/this.ud);(Lc=this.xa.pictureCropInfo.TextureViewElem)&&this.TG.image.setPosition(Lc.Position.X-Qb.x+qc.x+Ia/this.ud,Lc.Position.Y-Qb.y+qc.y+tb/this.ud)}this.Ab.xm()}zcl(Ia,tb){tb.Ej(1/this.iT);this.Clh(Ia,Fg.a.add(this.BVa,tb))}resize(Ia,tb){tb.Ej(1/this.iT);this.Clh(Ia,tb)}Clh(Ia,tb){Ia=this.RJd(Ia,tb);this.Nq(Ia);this.setOffsets(tb)}z0d(){const Ia=
this.Fa.wA(this.xa,this.cC);return new md.a(Ia.x/this.ud,Ia.y/this.ud)}XAh(){this.xa.qy&&(this.iT=this.uc.Sg(this.xa).Up/this.gpe.x)}Sdl(){const Ia=this.uc.Sg(this.xa);this.gpe.update(Ia.Up,Ia.Gk)}Ej(Ia){this.ud=Ia;this.Ab.Ej(this.ud);Ia=new Cd.a;Ia.waa(1/this.ud,1/this.ud);this.JA.yF(Ia,Wi.a.Faa);this.AZj?this.fX(!1):this.fX(!0)}get zoom(){return this.ud/this.iT}VXd(){this.XAh();this.Zu||(this.Zu=this.xa.Vq);var Ia=md.a.Nl(this.Zu.ga(0),this.Zu.ga(1));const tb=md.a.Nl(this.Zu.ga(0),this.Zu.ga(3)),
Qb=this.Zu.$f(),qc=new Eh.a(new md.a(0,0),new md.a(Ia,0),new md.a(Ia,tb),new md.a(0,tb));qc.move(Qb.x-Ia/2,Qb.y-tb/2);Ia=this.z0d();qc.move(Ia.x,Ia.y);qc.scale(this.iT,this.iT);return qc}brl(Ia,tb){Ia=Ia.copy();Ia.scale(1/this.iT,1/this.iT);var Qb=this.z0d();Ia.move(-1*Qb.x,-1*Qb.y);Qb=Ia.$f();const qc=new Cd.a;tb?qc.k6(this.xa.get_shapeRotation(),Qb):qc.k6(this.xa.get_shapeRotation(),this.Zu.ga(0));qc.Fm(Ia);tb||Ia.move(this.Zu.ga(0).x-Ia.ga(0).x,this.Zu.ga(0).y-Ia.ga(0).y);this.Zu=Ia;this.fW.Mt(this.Zu.points);
tb=this.TG.clipPath;xf.a("SVGCreationOnChangesFromFormatPane")&&this.xka&&tb?(tb.SUb=this.bFc(Ia),this.rzc(Ia.ga(0))):tb&&tb.C3a&&tb.C3a.GSe(this.Zu.points);this.Nac=!0;this.fX(!0);this.Ab.xm()}setZIndex(Ia){this.Ab.tC(Ia+2*Gg.a.w$)}setOffsets(Ia){this.Zu||(this.Zu=this.xa.Vq);this.D5h(Ia);this.en=Ia;var tb=this.JA.xwb;Ia=new md.a(tb[0].x/this.ud,tb[0].y/this.ud);var Qb=new md.a(tb[2].x/this.ud,tb[2].y/this.ud);const qc=new md.a(tb[4].x/this.ud,tb[4].y/this.ud);tb=new md.a(tb[6].x/this.ud,tb[6].y/
this.ud);Ia=new Eh.a(Ia,Qb,qc,tb);this.fW.Mt(this.Zu.points);Qb=this.TG.clipPath;this.xka&&Qb?(this.rzc(md.a.WT(Ia.points[this.wbb],this.pac)),Qb.SUb=this.bFc(Ia)):Qb&&Qb.C3a&&Qb.C3a.GSe(Ia.points);this.Ab.xm()}D5h(Ia){var tb=this.Zu,Qb=md.a.Nl(tb.ga(0),tb.ga(1));tb=md.a.Nl(tb.ga(0),tb.ga(3));Ia.bottom-Ia.top<-1*tb&&(tb+=Ia.bottom-Ia.top,Ia.top+=tb,Ia.bottom-=tb);Ia.right-Ia.left<-1*Qb&&(Qb+=Ia.right-Ia.left,Ia.left+=Qb,Ia.right-=Qb)}Nq(Ia){this.n_=Ia;this.fW.yF(Ia,Wi.a.Faa);this.fX(!0)}ov(){}mz(){Array.clear(this.an)}TE(Ia){return this.UJj(Ia)?
this.w4d(Ia):null}MD(Ia){const tb=[];var Qb=this.xa.pictureCropInfo;if(this.xa.qy){const qc=this.uc.Sg(this.xa);if(Qb.MaskViewElem){let Lc=Lf.a.$Ec(6,qc.Up,qc.Gk);Array.add(tb,Lc)}Qb.TextureViewElem&&(Qb=Lf.a.$Ec(7,qc.Up,qc.Gk),Array.add(tb,Qb));Array.add(this.an,Ia)}else this.Sb=!1,this.Ab.Sd(!1);return tb}SD(){}xul(){this.Z8b.x!==this.yI.x&&this.Z8b.y!==this.yI.y&&($d.a.J(545121880,822,50,"PictureCropShapeView::UpdateViewElementPositionForRedraw - Updating maskViewElements and PictureViewElements "),
this.z8.Position.X=this.yI.x+this.Fa.wA(this.xa,this.cC).x/this.ud,this.z8.Position.Y=this.yI.y+this.Fa.wA(this.xa,this.cC).y/this.ud,this.b9.Position.X=this.TG.image.x+this.Fa.wA(this.xa,this.cC).x/this.ud,this.b9.Position.Y=this.TG.image.y+this.Fa.wA(this.xa,this.cC).y/this.ud,this.pka.update(0,0))}OTb(Ia,tb){const Qb=this.hn.gFc();this.xa.get_isVerticallyFlipped()&&(Qb.waa(1,-1),Qb.vB(0,2*tb._y));this.xa.get_isHorizontallyFlipped()&&(Qb.waa(-1,1),Qb.vB(2*tb._x,0));Qb.k6(Ia,tb);return Qb}jdg(){return this.xa.get_isVerticallyFlipped()&&
this.xa.get_isHorizontallyFlipped()?2:this.xa.get_isVerticallyFlipped()?3:this.xa.get_isHorizontallyFlipped()?1:0}rzc(Ia){const tb=new Cd.a;tb.vB(Ia._x,Ia._y);this.TG.clipPath.yF(tb,Wi.a.Faa)}bFc(Ia){$d.a.J(539112088,809,15,"PictureCropShapeView:: createSVG operation started");var tb=this.xa.get_shapeRotation();this.hn.cqa(-tb,Ia.$f()).Fm(Ia);this.dv||(this.dv=svgShape.FactoryGlobal.createShape());this.dv.setSVGRoot(this.Ab.za,!1);this.xa.HR?this.dv.setShapeType(this.xa.HR):(this.dv.setShapeType(4),
$d.a.J(539760099,809,50,"ShapeNode ArtShapeType is null"));this.dv.setOffsets(this.xa.get_xPersisted()+ad.a.eX(Ia.ga(0).x/this.iT,0),this.xa.get_yPersisted()+ad.a.eX(Ia.ga(0).y/this.iT,1));this.dv.setExtents(ad.a.eX(Ia.ga(1).x-Ia.ga(0).x,0),ad.a.eX(Ia.ga(2).y-Ia.ga(1).y,1));var Qb=svgShape.FactoryGlobal.getConvertor().getPath(this.dv,!1,this.iT,this.iT);if(!Qb||!Qb.length)throw $d.a.J(539325768,822,15,"PictureCropShapeView::CreateSVG -No response received from getPath"),Error.invalidOperation(" Invalid response for svgpath element");
Ia=Array(Qb.length);tb=0;for(const qc of Qb)Qb=new ih.a,Qb.$_(qc),Qb.za.setAttribute(Fh.a.qIb,this.av.Ygb()),Ia[tb++]=Qb;$d.a.J(539112089,809,15,"PictureCropShapeView:: createSVG operation ended");return Ia}draw(Ia,tb){if(Array.contains(this.an,Ia)){Array.remove(this.an,Ia);if(this.xa.pictureCropInfo&&!this.HTa){if(this.xa.pictureCropInfo.MaskViewElem){Ia=this.xa.pictureCropInfo.MaskViewElem;var Qb=Ia.Clip,qc=this.uc.Sg(this.xa);qc=Lf.a.$Ec(6,qc.Up,qc.Gk);if(qc=tb[qc.toString()])this.yI.b0k(qc.Base64Data,
Ia.Id.toString(),Qb.Bounds.Left,Qb.Bounds.Top,Qb.TotalWidth,Qb.TotalHeight,Qb.Bounds.Right-Qb.Bounds.Left,Qb.Bounds.Bottom-Qb.Bounds.Top),this.yI.Sd(!0),this.yI.setPosition(Ia.Position.X-this.Fa.wA(this.xa,this.cC).x/this.ud,Ia.Position.Y-this.Fa.wA(this.xa,this.cC).y/this.ud);this.z8=Ia;this.Z8b=new md.a(this.yI.x,this.yI.y)}this.xa.pictureCropInfo.TextureViewElem?(Ia=this.uc.Sg(this.xa),qc=Lf.a.$Ec(7,Ia.Up,Ia.Gk),Ia=this.xa.pictureCropInfo.TextureViewElem,Qb=Ia.Clip,(tb=tb[qc.toString()])?this.xka?
(this.wbb=this.jdg(),this.pac=this.Mm.points[this.wbb].copy(),this.rzc(md.a.WT(this.xa.Vq.points[this.wbb],this.pac)),this.av=this.OTb(this.xa.get_shapeRotation(),this.xa.Vq.$f()),this.TG.c0k(tb.Base64Data,Ia.Id.toString(),Ia.Position.X-this.Fa.wA(this.xa,this.cC).x/this.ud,Ia.Position.Y-this.Fa.wA(this.xa,this.cC).y/this.ud,Qb.TotalWidth,Qb.TotalHeight,this.Mm.copy().points,this.bFc(this.Mm.copy()))):this.TG.a0k(tb.Base64Data,Ia.Id.toString(),Ia.Position.X-this.Fa.wA(this.xa,this.cC).x/this.ud,Ia.Position.Y-
this.Fa.wA(this.xa,this.cC).y/this.ud,Qb.TotalWidth,Qb.TotalHeight,this.xa.Vq.points):$d.a.J(542781465,822,50,"PictureCropShapeView::Draw - No Crop Texture Image Downloaded"),this.b9=Ia):$d.a.J(19519558,822,50,"PictureCropShapeView::Draw - Unable to set image and bounds to polygon as TextureViewElem is null");this.Zu&&md.a.Nl(this.Zu.ga(0),this.Zu.ga(2))||(this.Zu=this.xa.Vq);this.nta=this.xa.Xcb;this.h3.Mt(this.nta.points);this.fW.Mt(this.Zu.points);this.HTa=!0;this.fX(!0);this.visible=this.Sb}else this.Hab&&
this.z8&&this.b9&&(this.xul(),this.yI.setPosition(this.z8.Position.X-this.Fa.wA(this.xa,this.cC).x/this.ud,this.z8.Position.Y-this.Fa.wA(this.xa,this.cC).y/this.ud),this.TG.image.setPosition(this.b9.Position.X-this.Fa.wA(this.xa,this.cC).x/this.ud,this.b9.Position.Y-this.Fa.wA(this.xa,this.cC).y/this.ud),this.xka?(this.wbb=this.jdg(),this.pac=this.Mm.points[this.wbb].copy(),this.rzc(md.a.WT(this.xa.Vq.points[this.wbb],this.pac)),this.av=this.OTb(this.xa.get_shapeRotation(),this.xa.Vq.$f()),this.TG.clipPath.SUb=
this.bFc(this.xa.Vq)):this.TG.clipPath.C3a=new ah.a(this.xa.Vq.points,0),this.Z8b=new md.a(this.yI.x,this.yI.y),this.Zu=this.xa.Vq,this.nta=this.xa.Xcb,this.h3.Mt(this.nta.points),this.fW.Mt(this.Zu.points),this.fX(!0),$d.a.J(545121881,822,50,"PictureCropShapeView::Draw - Redrawed crop views "));this.Ab.xm();this.Ab.Sd(this.Sb)}}Mql(){if(this.Zu){var Ia=this.JA.xwb;const tb=new md.a(Ia[0].x/this.ud,Ia[0].y/this.ud),Qb=new md.a(Ia[2].x/this.ud,Ia[2].y/this.ud),qc=new md.a(Ia[4].x/this.ud,Ia[4].y/this.ud);
Ia=new md.a(Ia[6].x/this.ud,Ia[6].y/this.ud);this.Zu=new Eh.a(tb,Qb,qc,Ia)}else this.Zu=this.xa.Vq;this.Mm=this.Zu.copy();this.nta||(this.nta=this.xa.Xcb);this.nta.move(this.Ata.x,this.Ata.y);this.h3.Mt(this.nta.points);this.pka.pL(this.Ata.x,this.Ata.y);this.Ata.update(0,0);this.Ue.ND(new ee.a(1))}SXi(){var Ia=this.JA.xwb;const tb=new md.a(Ia[0].x,Ia[0].y),Qb=new md.a(Ia[2].x,Ia[2].y),qc=new md.a(Ia[4].x,Ia[4].y);Ia=new md.a(Ia[6].x,Ia[6].y);return new Eh.a(tb,Qb,qc,Ia)}KZi(){var Ia=this.xa.Xcb.copy().points,
tb=new md.a(Ia[0].x*this.ud,Ia[0].y*this.ud);const Qb=new md.a(Ia[1].x*this.ud,Ia[1].y*this.ud),qc=new md.a(Ia[2].x*this.ud,Ia[2].y*this.ud);Ia=new md.a(Ia[3].x*this.ud,Ia[3].y*this.ud);tb=new Eh.a(tb,Qb,qc,Ia);tb.scale(1/this.iT,1/this.iT);tb.move((this.pka.x+this.Ata.x)*this.ud,(this.pka.y+this.Ata.y)*this.ud);return tb}wF(Ia){this.HTa&&(this.JA.Sd(!Ia),Ia?(this.XAh(),this.Nac=!0):(this.Mql(),this.ia.processAction(Na.a.bJb,2),this.Hab&&(Ia={["pictCropperInfo"]:this.VHf(),["shapeNode"]:this.xa},
this.ia.Ma(Na.a.Zic,2,Ia))))}eq(){return this.Ab.eq()}fX(Ia){if(this.HTa){var tb=this.Zu.copy();Ia&&this.n_.Fm(tb);Ia=new Cd.a;Ia.xmb(this.xa.get_shapeRotation());var Qb=2*Math.ceil((this.xa.get_shapeRotation()-45)/90)%8;for(let qc=0;8>qc;++qc){const Lc=this.$B[qc];Lc.Tk(sg.a.oP(zg.a.box4Image(Vf.Dic[Qb]),zd.a.cA));this.$Ha(Lc,tb.Yj(new eh.a(qc)));Lc.yF(Ia,Wi.a.aUb);Qb=(Qb+1)%8}}}$Ha(Ia,tb){Ia.x===tb.x*this.ud&&Ia.y===tb.y*this.ud||Ia.setPosition(tb.x*this.ud,tb.y*this.ud)}get visible(){return this.Sb}set visible(Ia){this.Sb=
Ia;!Ia&&this.HTa&&(this.VLi(),this.HTa=!1);this.Ab.Sd(this.Sb)}VLi(){if(this.HTa){if(this.Nac){const Ia={["pictCropperInfo"]:this.VHf(),["shapeNode"]:this.xa};this.ia.Ma(Na.a.Zic,2,Ia)}this.D1()}}VHf(){let Ia,tb,Qb,qc;const Lc=this.dgi();({left:Ia,top:tb,right:Qb,bottom:qc}=this.Loi());return Object.assign(new vh.a,{Left:Ia,Top:tb,Right:Qb,Bottom:qc,X:Lc.x,Y:Lc.y})}Loi(){let Ia,tb,Qb,qc;({left:Ia,top:tb,right:Qb,bottom:qc}=this.RDi());({left:Ia,top:tb,right:Qb,bottom:qc}=this.Csi(Ia,tb,Qb,qc));({left:Ia,
top:tb,right:Qb,bottom:qc}=Vf.fwl(Ia,tb,Qb,qc));return{left:Ia,top:tb,right:Qb,bottom:qc}}RDi(){let Ia,tb,Qb;var qc=this.nta.points;const Lc=this.Zu.points;Ia=ze.a(qc[3],qc[0],Lc[3],Lc[0]);tb=ze.a(qc[0],qc[1],Lc[0],Lc[1]);Qb=ze.a(qc[1],qc[2],Lc[1],Lc[2]);qc=ze.a(qc[2],qc[3],Lc[2],Lc[3]);return{left:Ia,top:tb,right:Qb,bottom:qc}}Csi(Ia,tb,Qb,qc){var Lc=this.nta.points;const Jd=md.a.Nl(Lc[0],Lc[1]);Lc=md.a.Nl(Lc[1],Lc[2]);Ia=Math.floor(Ia/Jd*1E6)/1E6;tb=Math.floor(tb/Lc*1E6)/1E6;Qb=Math.floor(Qb/Jd*
1E6)/1E6;qc=Math.floor(qc/Lc*1E6)/1E6;return{left:Ia,top:tb,right:Qb,bottom:qc}}dgi(){var Ia=this.Zu.copy(),tb=new Cd.a,Qb=Ia.$f();tb.k6(-1*this.xa.get_shapeRotation(),Qb);tb.Fm(Ia);Qb=this.Fa.wA(this.xa,this.cC);this.x5j?(tb=this.cC.yf(Ia.fc*this.ud+Qb.x,0),Ia=this.cC.yf(Ia.ic*this.ud+Qb.y,1),Ia=new md.a(tb,Ia)):Ia=new md.a(Ia.fc+Qb.x/this.ud,Ia.ic+Qb.y/this.ud);return md.a.scale(Ia,this.iT,this.iT)}I5c(){return!0}D1(){this.fW.yF(new Cd.a,Wi.a.Faa);this.h3.setPosition(0,0);this.en=new Fg.a;this.Mm=
this.Zu=this.n_=this.xa.pictureCropInfo=null;this.pka.update(0,0);this.Nac=!1;this.gpe.update(0,0);this.iT=1}RJd(Ia,tb){const Qb=new Cd.a;this.Mm||(this.Mm=Ia);Ia=this.Mm.$f();const qc=md.a.Nl(this.Mm.ga(0),this.Mm.ga(1)),Lc=md.a.Nl(this.Mm.ga(0),this.Mm.ga(3)),Jd=qc?1+(tb.right-tb.left)/qc:1,le=Lc?1+(tb.bottom-tb.top)/Lc:1,je=Ia.copy();je.pL(-1*qc/2,-1*Lc/2);Qb.k6(-1*this.xa.get_shapeRotation(),Ia);Qb.vB(-1*je.x,-1*je.y);Qb.waa(Jd,le);Qb.vB(tb.left+je.x,tb.top+je.y);Qb.k6(this.xa.get_shapeRotation(),
Ia);return Qb}Rui(Ia,tb){var Qb=[new md.a(0,0),new md.a(20,0),new md.a(20,5),new md.a(5,5),new md.a(5,20),new md.a(0,20)];Qb=new ah.a(Qb,0);Qb.za.id=tb;Qb.xF("black");Qb.pv("white");Qb.sr(1);Ia.equals(eh.a.JD)?Qb.gIa(90):Ia.equals(eh.a.nu)?Qb.gIa(0):Ia.equals(eh.a.YD)?Qb.gIa(180):Ia.equals(eh.a.bH)&&Qb.gIa(-90);return Qb}Uyi(Ia,tb){const Qb=new Fi.a;Qb.za.id=tb;Qb.xF("black");Qb.pv("white");Qb.sr(1);Qb.Bh(20,5);Ia.equals(eh.a.north)?Qb.setPosition(-10,0):Ia.equals(eh.a.south)?Qb.setPosition(-10,-5):
Ia.equals(eh.a.east)?(Qb.setPosition(-5,-10),Qb.Bh(5,20)):Ia.equals(eh.a.west)&&(Qb.setPosition(0,-10),Qb.Bh(5,20));return Qb}get BVa(){return this.en}get oe(){return this.Ab.viewport}X_d(Ia){return!this.xa.qy&&8>Ia.index?this.$B[Ia.index].za:null}IP(){return!1}Rx(Ia){Ia&&(this.Nac=!1)}setSelection(){}static fwl(Ia,tb,Qb,qc){.999999<Ia+Qb&&($d.a.J(19960162,822,15,"Invalid crop region inset values: left({0}), right({1})",Ia,Qb),Qb=(999999-1E6*Ia)/1E6);.999999<tb+qc&&($d.a.J(19960192,822,15,"Invalid crop region inset values: top({0}), bottom({1})",
tb,qc),qc=(999999-1E6*tb)/1E6);return{left:Ia,top:tb,right:Qb,bottom:qc}}}Vf.Dic=[zd.a.ish,zd.a.gsh,zd.a.hsh,zd.a.fsh,zd.a.ksh,zd.a.jsh,zd.a.lsh,zd.a.msh];Object(h.a)(Vf,"PictureCropShapeView",null,[871,283,284,109]);var fd=d(646);class Ee{constructor(Ia,tb,Qb){this.Fa=Ia;this.cC=tb;this.Z7=Qb}setPosition(Ia,tb,Qb){this.Z7.QE(Ia.shapeNode).ycl(tb,Qb)}setOffsets(Ia,tb){this.Z7.QE(Ia.shapeNode).zcl(Ia.MRe.copy(),tb)}RH(Ia,tb){const Qb=new Cd.a,qc=this.Z7.QE(Ia.shapeNode);tb=tb?qc.SXi().copy():qc.KZi().copy();
Ia=this.Fa.wA(Ia.shapeNode,this.cC);Qb.vB(Ia.x,Ia.y);Qb.Fm(tb);return new fd.a(tb)}zF(Ia){return Ia.shapeNode.qy}}Object(h.a)(Ee,"ShapeCropMoveResizeHandler",null,[870]);class Yf{constructor(Ia,tb,Qb){this.Z7=Ia;this.Hab=tb;this.G3j=Qb}Z_(Ia,tb,Qb){if((Ia=this.Z7.QE(Ia))&&Ia.visible!==Qb){for(const qc of tb)this.G3j&&(tb=Object(Qc.a)(867,qc))&&tb.setSelected(!Qb),qc!==Ia&&(qc.visible=!Qb);Ia.visible=Qb}}ahd(){return!1}pld(Ia,tb,Qb){this.Z7.QE(Ia).resize(Qb,tb)}bhd(){return!1}qld(Ia,tb,Qb,qc){qc&&
this.Z7.QE(Ia).setPosition(tb,Qb)}dUc(){return!this.Hab}O5a(Ia,tb){return this.Hab?tb:[this.Z7.QE(Ia)]}zF(Ia){return Ia.qy}}Object(h.a)(Yf,"ShapeViewCropUpdateStrategyHandler",null,[868,869]);var ij=d(277);class Md{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PictureCrop"}Yb(Ia){this.K=Ia;this.K.register(259,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>").ma().na(()=>new ij.a((tb,Qb)=>{let qc=null;const Lc=Object(Qc.a)(133,
tb.pc(this.K.resolve("Box4.IPageView").Na));Lc&&!Lc.kl&&(qc=new Vf(tb,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IPageView").Ed,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),Qb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingSetPictureCropInfoCommandUsingMU,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Nxe,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").E9c,this.K.resolve("PowerPointWebEditor.ITransformFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").AVd),qc.Vm(Lc.za),qc.setZIndex(3),qc.visible=!1,Lc.GX(qc.oe.za,!0),Lc.Bza(qc,3));return qc}));this.K.register(dh,"PowerPointWebEditor.PictureCropActor").ma().na(()=>new dh(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").yIj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Mxe,this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").kia,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").E9c,this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),this.K.resolve("PowerPointWebEditor.IBusinessBarController")));this.K.register(qh,
"PowerPointWebEditor.FormatPicturePaneActor").ma().na(()=>new qh(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IDynamicScriptLoaderProvider").gx))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.ICompositeShapeViewUpdateStrategy").addHandler(new Yf(this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").Nxe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").F9c));this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new Ee(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView").Ed,this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>")));this.K.resolve("PowerPointWebEditor.PictureCropActor").wb();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").wb();
this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").Fe()}dispose(){}static main(){m.a.instance.Ec(Wc.a(new Md,0))}}Object(h.a)(Md,"PPTWebEditorPictureCropPackage",null,[2,3]);var pj=d(36),qj=d(240);class jj{constructor(Ia,tb,Qb,qc,Lc){this.yz=[pj.a.fm,pj.a.font,ld.a.autonumberBulletType];this.Ib=Ia;this.um=tb;this.Zh=Qb;this.i$b=qc;this.FN=Lc}format(Ia){if(Ia&&Ia.ovb){Ia=this.Ib.Jc(Ia);for(var tb=this.um.A6(Ia,Ia.currentNode);tb.moveNext();){var Qb=tb.currentNode;if(Qb&&this.Zh.Pd(Qb)){const qc=
this.FN.wP(Ia,this.Zh.cdb(Qb));(Qb=this.i$b.aMc(Qb))&&qj.d(qc,Qb,this.yz)}}}}}Object(h.a)(jj,"BeautifyListFormatter",null,[842]);class Ag{constructor(Ia,tb,Qb,qc,Lc){this.ia=Ia;this.ua=Qb;this.Jb=tb;this.Fa=qc;this.rXj=Lc}initialize(){this.wb()}wb(){this.ia.ra(Na.a.dId,P.a.application,Object(u.a)(this,this.dId,"applyTextFormatterSuggestion"),4)}dId(Ia,tb,Qb){if(1===Qb)return 32;Ia=this.ua.Ca;if(!Ia)return 16;tb=Ia.km();if(!tb||!tb.length)return 16;tb=this.Fa.eZ(tb);if(!tb.length)return 16;Qb=this.Jb.xd(15);
Qb.lc(Ia);for(const qc of tb)this.rXj.format(qc);Qb.dispose();return 32}}Object(h.a)(Ag,"TextFormatterActor",null,[]);class mf{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatter"}Yb(Ia){this.K=Ia;Ia.register(842,"PowerPointWebEditor.IBeautifyListFormatter").ma().na(()=>new jj(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),
this.K.resolve("PowerPointWebEditor.IPptListEditor")));Ia.register(Ag,"PowerPointWebEditor.TextFormatter.TextFormatterActor").ma().na(()=>new Ag(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IBeautifyListFormatter")))}init(){const Ia=this.K.resolve("Common.IAppSettingsManager");Ia.gf(()=>
{Ia.ka(dd.a.pa(818))&&this.K.resolve("PowerPointWebEditor.TextFormatter.TextFormatterActor").initialize()})}dispose(){}static main(){m.a.instance.Ec(Wc.a(new mf,0))}}Object(h.a)(mf,"PPTWebEditorTextFormatterPackage",null,[2,3]);Type.registerNamespace("Box4.Symbols");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PictureCrop");Type.registerNamespace("PowerPointWebEditor.TellMe");Type.registerNamespace("PowerPointWebEditor.TextFormatter");Va.main();Type.registerNamespace("Common.App.O365Shell");
ab.main();Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");yc.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Xc.main();window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Animation",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",
attrs:{Id:"PptTellMe.Animation.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Animation.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Animation.Gallery",ElementDimensions:"Size64by48",Width:"3"},children:[{name:"GalleryButton",attrs:{Id:"Existing",Command:"0x11CFD1C3",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}},{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFadeIn",Alt:"STR@L_AnimationFadeIn"}},{name:"GalleryButton",
attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.AnimationNew",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"AnimationGallery"},children:[{name:"MenuSection",attrs:{Id:"AnimationGalleryNone"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery1",ElementDimensions:"Size64by48",Width:"5"},
children:[{name:"GalleryButton",attrs:{Id:"ExistingInMenu",Command:"0x4B65244F",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEntrance",Id:"AnimationGalleryEntrance"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery2",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}},{name:"GalleryButton",attrs:{Id:"Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},
{name:"GalleryButton",attrs:{Id:"RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"GrowAndTurn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowAndTurn",Alt:"STR@L_AnimationGrowAndTurn"}},{name:"GalleryButton",attrs:{Id:"Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},
{name:"GalleryButton",attrs:{Id:"Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Expand",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationExpand",Alt:"STR@L_AnimationExpand"}},{name:"GalleryButton",attrs:{Id:"PeekIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekIn",Alt:"STR@L_AnimationPeekIn"}},{name:"GalleryButton",attrs:{Id:"RiseUp",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRiseUp",Alt:"STR@L_AnimationRiseUp"}},{name:"GalleryButton",
attrs:{Id:"Stretch",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretch",Alt:"STR@L_AnimationStretch"}},{name:"GalleryButton",attrs:{Id:"Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEmphasis",Id:"AnimationGalleryEmphasis"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery3",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Emphasis_Spin",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSpin",Alt:"STR@L_AnimationSpin"}},{name:"GalleryButton",attrs:{Id:"Emphasis_GrowShrink",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowShrink",Alt:"STR@L_AnimationGrowShrink"}},{name:"GalleryButton",attrs:{Id:"Emphasis_Transparency",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationTransparency",Alt:"STR@L_AnimationTransparency"}},{name:"GalleryButton",attrs:{Id:"Emphasis_LineColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationLineColor",Alt:"STR@L_AnimationLineColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FillColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationFillColor",Alt:"STR@L_AnimationFillColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FontColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFontColor",Alt:"STR@L_AnimationFontColor"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationExit",Id:"AnimationGalleryExit"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery4",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Exit_Disappear",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationDisappear",Alt:"STR@L_AnimationDisappear"}},{name:"GalleryButton",attrs:{Id:"Exit_Fade",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"Exit_FlyOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyOut",
Alt:"STR@L_AnimationFlyOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Exit_Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"Exit_RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"Exit_Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},
{name:"GalleryButton",attrs:{Id:"Exit_Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Exit_Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Exit_Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Exit_PeekOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekOut",Alt:"STR@L_AnimationPeekOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Stretchy",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretchy",Alt:"STR@L_AnimationStretchy"}},
{name:"GalleryButton",attrs:{Id:"Exit_Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Transition",Command:"0x78ACF6A1",LabelText:"STR@L_TransitionTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Transition.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Transition.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Transition.Gallery",
ElementDimensions:"Size64by48",Width:"2"},children:[{name:"GalleryButton",attrs:{Id:"TransitionExisting",Command:"0xDFACB0EC",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingTransitionButtonDescription"}},{name:"GalleryButton",attrs:{Id:"TransitionNone",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionNone",Alt:"STR@L_TransitionNone"}},{name:"GalleryButton",attrs:{Id:"TransitionFade",Command:"0x78ACF6A1",
QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionFade",Alt:"STR@L_TransitionFade"}},{name:"GalleryButton",attrs:{Id:"TransitionPush",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionPush",Alt:"STR@L_TransitionPush"}}]}]}]}]},{name:"Button",attrs:{Id:"PptTellMe.Designer",Command:"0x9531543E",LabelText:"STR@L_ShowHideDesignerPane"}},{name:"Button",attrs:{Id:"PptTellMe.Ideas",Command:"0x76FF601A",
Image16by16:"IMGMAP@per@LightningIdeasHandraiseState_16x16x32",LabelText:"STR@L_IdeasButtonHomeRibbon"}},{name:"Button",attrs:{Id:"PptTellMe.SelectAll",Command:"0x148D0534",Image16by16:"IMGMAP@per@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.GroupShapesUpSellButton",LabelText:"STR@L_GroupShapesUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTGroupShapes",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButton",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",
LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTWordArt",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",
Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButton",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",
Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButton",LabelText:"STR@L_InsertAudioUpSell",
Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",
DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertAudio",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButton",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",
DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertChart",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButtonEnterprise",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButtonEnterprise",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButtonEnterprise",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButtonEnterprise",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]}]};Md.main();mf.main();Type.registerNamespace("NLRT")},136:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(215);class e{constructor(m,r){this.UKa=!1;const {Annotations:v}=d(77);if(!m)throw Error.argumentNull("annotations");
if(!m.qae(r))throw Error.argument("memberTypeID","Invalid type ID");if(v.gB(r))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.hr=m;this.VOh=r;this.mB=[]}get Zmb(){return this.hr}get isReadOnly(){return this.UKa}get oT(){return this.VOh}get items(){return this.mB}D0(){const {Annotations:m}=d(77);let r="[";for(let v=0,A=this.items.length;v<A;++v){0<v&&(r+=", ");const x=this.hr.D0(this.oT,this.items[v]);this.oT===m.LX?(r+='"',r+=h.a.xTd(x),r+='"'):r+=x}return r+"]"}isEqual(m){const {Annotations:r}=
d(77);if(this===m)return!0;if(!m||m.Zmb!==this.hr||m.oT!==this.oT||m.items.length!==this.items.length)return!1;for(let v=0;v<this.items.length;++v)if(!r.oZa(this.oT,this.items[v],m.items[v]))return!1;return!0}clone(){const m=new e(this.hr,this.oT);Array.addRange(m.items,this.items);return m}$J(){return this.isReadOnly?this.clone():this}Rbe(){const {Annotations:m}=d(77);if(!this.isReadOnly){this.UKa=!0;for(const r of this.items)m.j9a(r)}}toString(){return this.D0()}}Object(J.a)(e,"ListValue",null,
[1119,1118])},146:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.tellMe="TellMe";h.contextMenu="ContextMenu";h.unknown="Unknown";Object(J.a)(h,"TellMeScenario",null,[])},158:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m,r=null,v=null,A=4,x=-99999,y=0){this.NGd="";this.aAc=-1;this.value=e;this.type=m;this.subType=A;this.label=this.QI=r;this.groupType=27;this.description=v;this.score=x;this.count=y}}Object(J.a)(h,"ResultBinding",null,[])},174:function(J,
V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.attributes=null;this.query=e;this.vk=[]}ns(e){this.vk.push(e)}jbh(e){const m=[];for(const r of this.vk)r.groupType!==e&&m.push(r);this.vk.length!==m.length&&(this.vk=m)}get Mub(){return!1}}Object(J.a)(h,"SimpleResultsUpdatedEventArgs",null,[948])},175:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e=27,m=""){this.rSh=[];this.groupType=e;this.displayName=m}get results(){return this.rSh}Bv(e){e.groupType=
this.groupType;Array.add(this.results,e)}eDe(e=1){if(this.results.length>=e)for(let m=0;m<e;m++)Array.removeAt(this.results,this.results.length-1)}}Object(J.a)(h,"SimpleResultGroup",null,[949])},215:function(J,V,d){J=d(0);class h{constructor(m,r){this.WMa=m;this.value=r}}Object(J.a)(h,"AttrValuePair",null,[]);d.d(V,"a",function(){return e});class e{constructor(m){this.UKa=!1;if(!m)throw Error.argumentNull("annotations");this.hr=m;this.sN=[]}get Zmb(){return this.hr}get isReadOnly(){return this.UKa}get e3d(){return 0<
this.sN.length}wm(m){if(!this.hr.tvb(m))throw Error.argument("attributeID","Invalid attribute ID");for(const r of this.sN)if(m===r.WMa)return m=r.value,{returnValue:!0,value:m};return{returnValue:!1,value:null}}Lt(m,r){var {Annotations:v}=d(77);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.hr.tvb(m))throw Error.argument("attributeID","Invalid attribute ID");if(!this.hr.tub(this.hr.getAttributeType(m),r))throw Error.argument("value",
"Value is not of the correct type for the specified attribute");v.j9a(r);for(v=0;v<this.sN.length;++v){const A=this.sN[v];if(m===A.WMa){A.value=r;return}}Array.add(this.sN,new h(m,r))}kcd(m){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.hr.tvb(m))throw Error.argument("attributeID","Invalid attribute ID");for(let r=0;r<this.sN.length;++r)if(m===this.sN[r].WMa){Array.removeAt(this.sN,r);break}}zJc(m){if(!m)throw Error.argumentNull("action");
for(const r of this.sN)m(r.WMa,r.value)}clone(){const m=new e(this.hr);m.nAa(this);return m}nAa(m){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!m)throw Error.argumentNull("other");if(m.Zmb!==this.hr)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.sN);m.zJc((r,v)=>{this.Lt(r,v)})}D0(){const {Annotations:m}=d(77);let r="[",v=!0;for(const A of this.sN){v?v=!1:r+=", ";r+=this.hr.O5f(A.WMa);r+="=";const x=this.hr.getAttributeType(A.WMa),
y=this.hr.D0(x,A.value);x===m.LX?(r+='"',r+=e.xTd(y),r+='"'):r+=y}return r+"]"}isEqual(m){const {Annotations:r}=d(77);if(!m)throw Error.argumentNull("other");if(this===m)return!0;if(!m||this.hr!==m.Zmb||this.e3d!==m.e3d)return!1;let v=0,A=null,x=!1;m.zJc((y,u)=>{++v;if(!x){var H=-1;for(let G=0,E=this.sN.length;G<E;++G)if(this.sN[G].WMa===y){H=G;break}0>H?x=!0:(A||(A=Array(this.sN.length)),A[H]=u)}});if(this.sN.length!==v||x)return!1;for(let y=0,u=this.sN.length;y<u;++y)if(!r.oZa(this.hr.getAttributeType(this.sN[y].WMa),
this.sN[y].value,A[y]))return!1;return!0}$J(){return this.isReadOnly?this.clone():this}Rbe(){const {Annotations:m}=d(77);if(!this.isReadOnly){this.UKa=!0;for(const r of this.sN)m.j9a(r.value)}}toString(){return this.D0()}static xTd(m){return m.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(J.a)(e,"FeatureBundle",null,[1117,1118])},260:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.click="Click";h.Jtb="InteractionBegin";h.cpg="InteractionEnd";
h.JPf="ControlActivated";h.query="Query";h.Y6g="QueryIndexRecorded";h.YNf="Clicks";h.tzf="ActionEvents";h.L1f="FilteredActionEvents";h.tih="SessionContext";h.latency="Latency";h.performance="Performance";h.Sch="RenderedResults";h.events="Events";h.pyi="CreateResultsMenu";h.GF="UpdateRibbonControls";h.ySk="ResultsAggregation";h.oD="IssueQuery";h.Hni="CommandSuggestions";h.error="Error";h.Hbe="LoadModelData";h.aDi="DepsResolveTime";h.Oak="ModelDataWaitTime";h.timedOut="TimedOut";h.$4h="AddinQueryCommandReady";
h.xVi="GetAddinEntitlements";h.J6g="ProviderMRUEvents";Object(J.a)(h,"EventNames",null,[])},278:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Qne=null;this.Dy=this.zpe=0}RJc(e,m,r){if(!e)throw Error.argumentNull("referenceList");if(0>m||m>e.length)throw Error.argumentOutOfRange("startIndex");if(0>r||r>e.length)throw Error.argumentOutOfRange("length");if(m+r>e.length)throw Error.argument("Invalid start-length range");this.Qne=e;this.zpe=m;this.Dy=r}pPa(e,m,r){this.RJc(e.Qne,
e.zpe+m,r)}ga(e){if(0>e||e>=this.Dy)throw Error.argumentOutOfRange("index");return this.Qne[this.zpe+e]}get count(){return this.Dy}static ZOd(e){const m=new h;m.RJc(e,0,e.length);return m}}Object(J.a)(h,"ReadOnlyList",null,[1138])},299:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";e[e.RecentlyUsed=4]="RecentlyUsed";
e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=20]="Notes";e[e.Learning=21]="Learning";
e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.Addin=24]="Addin";e[e.OfficeScript=25]="OfficeScript";e[e.AddinStoreEntry=26]="AddinStoreEntry";e[e.None=27]="None";e[e.MergedActions=28]="MergedActions";e[e.MergedScopedSearches=29]="MergedScopedSearches";e[e.MergedSuggestedSearches=30]="MergedSuggestedSearches"})(h||(h={}));Object(J.b)("ResultGroupType",h)},322:function(J,V,d){d.r(V);d.d(V,"CommandResultsUtility",function(){return u});J=d(0);var h=d(369),e=d(260),m=d(370),r=d(158),v=d(175),
A=d(119),x=d(103),y=d(25);class u{static SIb(H,G){if(G&&G.mo){const E={};for(const I of H)G.ZTc(I)&&(E[I]=appChrome.selectors.getModelType(I));A.TellMeActor.instance.GF(E)}}static yil(H){return H.startsWith("btnTellMeOfficeAddIn")}static Z2b(H){const G=A.TellMeActor.instance.hG();return!!G&&G.mo&&!appChrome.selectors.isControlDisabled(H)}static sVc(H,G,E,I){if(A.TellMeActor.instance.Ld&&H){const Q=[];for(const D of H)Q.push(String.format('{{"Id":"{0}","Score":{1}}}',D.commandId,D.score));H={};H[h.a.suggestions]=
"[{"+Q.join(",")+"}]";H[h.a.Axg]=G;H[h.a.groupType]=E;H[h.a.provider]=I;A.TellMeActor.instance.Ld.MI(e.a.Hni,window.performance.now(),H)}}static iZi(H,G){const E=[],I=[];for(const Q of G){G=Q.commandId;let D=Q;Q.commandId in H&&(G=H[Q.commandId],D=new m.a(G,Q.score));Array.contains(I,G)||(E.push(D),I.push(G))}return E}static MMc(H,G,E,I,Q,D,Y,M){E.SXd&&(G=u.iZi(E.SXd,G));var N=x.a.qYi(G);u.SIb(N,E);var W=[],K=[];N=[];const ca=new v.a(Y);Y=16===Y||18===Y||7===Y||4===Y?y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Gc("TellMeMaxRecommendedResultsToReturn",
3):3:0===Y||17===Y?5:0;for(const P of G)if(!u.hCj(P.commandId)){G=u.yil(P.commandId);if(E.ZTc(P.commandId)&&!G){if(x.a.Jwg(P.commandId))continue;G=null;Q&&D&&(G=Q.l7i(P.commandId,D));u.Z2b(P.commandId)?Array.add(W,new r.a(P.commandId,5,G,null,M,P.score)):Array.add(K,new r.a(P.commandId,5,G,null,M,P.score))}else E.Q2a&&G&&I&&Array.add(N,P.commandId.substr(21));if(W.length+N.length>=Y)break}E=0;for(Q=0;Q<W.length&&E<Y;Q++,E++)ca.Bv(W[Q]);for(W=0;W<K.length&&E<Y;W++,E++)ca.Bv(K[W]);for(K=0;K<N.length&&
E<Y;K++,E++)I.LBl(H,N[K],ca);return ca}static hCj(H){u.lHf||(y.AFrameworkApplication.fa&&y.AFrameworkApplication.fa.Fu("TellMeControlPredictionBlockList")&&y.AFrameworkApplication.fa.JB("TellMeControlPredictionBlockList").forEach(G=>{Array.add(u.kHf,G.toLowerCase())}),u.lHf=!0);return Array.contains(u.kHf,H.toLowerCase())}static F7d(H){return 2<H.length&&";"===H.charAt(0)&&";"===H.charAt(H.length-1)&&!!y.AFrameworkApplication.fa&&(y.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled")||y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static d7f(H){const G=new v.a(0);var E=H.split(";");H=A.TellMeActor.instance.hG();for(const I of E)if(0<I.length){E=I.split(":");const Q=2===E.length?E[0]:I;if(!H.ZTc(Q))break;if(1===E.length)E=new r.a(Q,5,null,null,1),G.Bv(E);else if(2===E.length)E=new r.a(Q,5,E[1],null,1),G.Bv(E);else break}return G}static sZh(H,G,E){if(!(G&&G.results&&H&&H.results&&H.results.length))return{returnValue:!1,CFd:H,WFd:G};const I=[];for(var Q of G.results)Array.add(I,Q.value);Q=0;const D=0<G.results.length?G.results[0].score:
0;for(const Y of H.results)if(Y.score>E&&!Array.contains(I,Y.value)&&u.Z2b(Y.value)&&(0<D&&(Y.score=D),Array.insert(G.results,Q,Y),Q++),2===Q)break;return 0<Q?(E=G.results.length-5,0<E&&G.eDe(E),{returnValue:!0,CFd:H,WFd:G}):{returnValue:!1,CFd:H,WFd:G}}}u.lHf=!1;u.kHf=[];Object(J.a)(u,"CommandResultsUtility",null,[])},369:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.appName="AppName";h.Mob="CloseAllMenus";h.commandId="CommandId";h.context="Context";h.culture="Culture";h.message=
"Message";h.errorMessage="ErrorMessage";h.event="Event";h.r7="CorrelationID";h.jqk="ParentUiElement";h.query="Input";h.Gdb="QueryID";h.g7g="QueryLength";h.FDb="QueryIndex";h.zSk="ResultsList";h.suggestions="Suggestions";h.scenario="Scenario";h.sessionId="SessionID";h.source="Source";h.timeStamp="Time";h.byh="UiElement";h.Fbd="ReactUx";h.value="Val";h.statusCode="StatusCode";h.mYk="Service";h.isSuccess="IsSuccess";h.pkl="TokenAcquired";h.yPj="LatencyType";h.groupName="GroupName";h.R6a="GroupIndex";
h.groupType="GroupType";h.uSk="ResultInfoList";h.resultType="ResultType";h.sNe="SubResultType";h.yFj="IsInputBlur";h.zFj="IsInputFocus";h.cLj="IsShortCutUsed";h.actionType="ActionType";h.count="Count";h.yHi="DwellTime";h.Axg="IsZeroTerm";h.Gyl="WordsCount";h.oTc="IsSearchUxEnabled";h.uMj="IsTellMeInHeaderEnabled";h.module="Module";h.resultIndex="ResultIndex";h.ARd="DisplayIndex";h.FIi="EnableList";h.provider="Provider";h.contentType="ContentType";h.GKj="IsSelectionBased";h.$$h="BeginPerformanceMarker";
h.aJi="EndPerformanceMarker";h.msk="PerformanceMeasure";Object(J.a)(h,"Columns",null,[])},370:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.commandId=e;this.score=m}}Object(J.a)(h,"CommandSuggestion",null,[])},437:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{static Emc(e){if(!e)return"{NULL}";const m=e.length;return 600>=m?e:e.substring(0,400)+"[...]"+e.substring(m-195,m)}}Object(J.a)(h,"LogUtils",null,[])},438:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{}Object(J.a)(h,"SmartLookupSelection",null,[])},439:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(25);class e{constructor(){this.currentDocumentPath=h.AFrameworkApplication.fa.Ia("EditDocInClientUrl")}}Object(J.a)(e,"SmartLookupApplicationInterface",null,[])},440:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.tellMe="TellMe";h.loki="Loki";h.substrate="Substrate";h.FDb="QueryIndex";h.nuh="TellMeRanker";h.ouh="TellMeRankerLogging";Object(J.a)(h,"Services",
null,[])},441:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.Jra="HttpRequest";h.provider="Provider";Object(J.a)(h,"LatencyTypes",null,[])},442:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.data=this.landingTab=null}}Object(J.a)(h,"LaunchData",null,[])},535:function(J,V,d){J=d(0);class h{constructor(){this.qmc=this.p2b=null;this.nre=this.score=this.pbc=0}Ywe(E,I,Q){this.score=E.ga(I);++I;this.p2b=E.ga(I)?Q.b7(E.ga(I)):null;++I;this.qmc=E.ga(I)?
Q.b7(E.ga(I)):null;++I;this.pbc=E.ga(I);++I;this.nre=E.ga(I);++I;return I}}Object(J.a)(h,"TokenStringGeneratorInit",null,[]);class e{constructor(E,I,Q,D,Y){this.iPa=E;this.count=I;this.jJc=Q;this.eG=D;this.depth=Y}}Object(J.a)(e,"ErrorTolerantTrieMatch",null,[]);var m=d(688),r=d(948);class v{constructor(E=null,I=0,Q=0,D=0){this.LVh=E||new r.a;this.nba=I;this.eG=Q;this.depth=D}get eU(){return this.LVh}getKey(){return this.eU.zs.toString()+":"+this.nba.toString()}}Object(J.a)(v,"TrieBookmark",null,
[]);class A{constructor(E,I){this.zua=E;this.Vle=I}pWj(E){if(null==E)throw Error.argumentNull("prefix");let I={};var Q=I[""]=new v;this.wPc(Q,I);for(Q=0;Q<E.length;++Q){const D=E.charCodeAt(Q),Y={};for(let M in I)this.U5h(D,I[M],Y);I=Y}return this.xll(I)}wPc(E,I){if(!(E.eG>=this.Vle)&&(E=new v(m.a.nMd(E.eU),E.nba,E.eG+1,E.depth),E.eU.Wy&m.a.DJa&&(E.nba+=1),this.zua.fhb(E.eU))){E.depth+=1;let Q=!0;for(;Q;)A.Jld(E,I),this.wPc(E,I),E.nba+=this.zua.Hrb(E.eU,!0)+(E.eU.Wy&m.a.DJa?1:0),Q=this.zua.zmc(E.eU)}}U5h(E,
I,Q){I.eG+1<=this.Vle&&(I.eG+=1,A.Jld(I,Q),--I.eG);I.eU.Wy&m.a.DJa&&(I.nba+=1);if(this.zua.fhb(I.eU)){I.depth+=1;let D=!0;for(;D;)I.eU.Fhb===E?(A.Jld(I,Q),this.wPc(I,Q)):I.eG+1<=this.Vle&&(I.eG+=1,A.Jld(I,Q),this.wPc(I,Q),--I.eG),I.nba+=this.zua.Hrb(I.eU,!0)+(I.eU.Wy&m.a.DJa?1:0),D=this.zua.zmc(I.eU)}}xll(E){const I=[];for(var Q in E){const D=E[Q];if(!D.eU.zs)continue;const Y=!!(D.eU.Wy&m.a.DJa),M=this.zua.Hrb(D.eU,!1)+(Y?1:0);Array.add(I,new e(D.nba,M,Y,D.eG,D.depth))}I.sort((D,Y)=>{let M=D.iPa-
Y.iPa;return M||(M=-(D.count-Y.count))?M:M=D.depth-Y.depth});if(2>I.length)return I;E=[];for(Q=0;Q<I.length;)Q+=A.Vvh(Q,I,E);return E}static Jld(E,I){const Q=E.getKey();Q in I?(I=I[Q],I.eG=Math.min(I.eG,E.eG)):I[Q]=new v(m.a.nMd(E.eU),E.nba,E.eG,E.depth)}static Vvh(E,I,Q){const D=I[E];let Y=D.iPa;const M=Y+D.count;let N=1,W=D.jJc;for(;E+N<I.length&&I[E+N].iPa<M;){const K=I[E+N];K.iPa>Y&&(Array.add(Q,new e(Y,K.iPa-Y,W,D.eG,D.depth)),W=!1);N+=A.Vvh(E+N,I,Q);Y=K.iPa+K.count}Y<M&&Array.add(Q,new e(Y,
M-Y,W,D.eG,D.depth));return N}}Object(J.a)(A,"ErrorTolerantTrieLookupEngine",null,[1215]);class x extends h{constructor(E,I,Q){super();this.Ekg=this.u0g=!1;this.k_f=null;if(E){var D=0;try{D=this.Ywe(E,D,I);this.u0g=1===E.ga(D);++D;this.Ekg=1===E.ga(D);++D;const Y=E.ga(D);this.k_f=this.yqk(Q,Y)}catch(Y){throw Error.argument("initData");}}}yqk(E,I){return new A(E,I)}}Object(J.a)(x,"FuzzyMatchTokenStringGeneratorInit",h,[]);class y extends h{constructor(E,I){super();this.query=this.name=null;if(E){this.annotations=
I.annotations;var Q=0;try{Q=this.Ywe(E,Q,I),this.name=I.pa(E.ga(Q)),++Q,this.query=I.eD(E.ga(Q))}catch(D){throw Error.argument("initData");}}}}Object(J.a)(y,"QueryTokenStringGeneratorInit",h,[]);class u extends h{constructor(E,I){super();if(E)try{this.Ywe(E,0,I)}catch(Q){throw Error.argument("initData");}}}Object(J.a)(u,"SurfaceStringTokenStringGeneratorInit",h,[]);var H=d(278);d.d(V,"a",function(){return G});class G{constructor(E){this.yde=E}get p2b(){return this.yde.p2b}get qmc(){return this.yde.qmc}get pbc(){return this.yde.pbc}static create(E,
I,Q){const {SurfaceStringTokenStringGenerator:D}=d(1087),{QueryTokenStringGenerator:Y}=d(1088),{FuzzyMatchTokenStringGenerator:M}=d(1089);let N=0;try{if(E.ga(N)!==G.h3a)throw Error.argument("initData","Input does not represent a token string generator");++N;const W=E.ga(N);++N;const K=new H.a;K.pPa(E,N,E.count-N);switch(W){case D.VTb:return new D(new u(K,I));case Y.VTb:return new Y(new y(K,I));case M.VTb:return new M(new x(K,I,Q));default:throw Error.argument("initData");}}catch(W){throw Error.argument("initData");
}}static BBf(E,I,Q,D,Y,M){E=E.wkl.getId(I,null);if(0>E)return++M,M;G.CBf(E,Q,D,Y);return M}static CBf(E,I,Q,D){Array.add(D.ZMe,E);Array.add(D.Xrh,I);++D.jIb[Q]}}G.h3a=1099767983;Object(J.a)(G,"TokenStringGenerator",null,[1170])},675:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(103);d=d(25);class e{static vMj(){return!h.a.Psg()&&!h.a.J8a()&&e.isFeatureEnabled(0)}static hwg(){return e.isFeatureEnabled(1)}static Ltg(){return e.isFeatureEnabled(2)}static isFeatureEnabled(m){return!!(e.YJh&
1<<m)}}e.YJh=d.AFrameworkApplication.fa?d.AFrameworkApplication.fa.Gc("TellMeFeatureConfigValue",0):0;Object(J.a)(e,"TellMeFeatureAvailability",null,[])},676:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(158);class h extends d.a{constructor(e,m,r,v,A=null){super(e,m,A,null,r);this.id=v}}Object(J.a)(h,"TryQueryResultBinding",d.a,[])},677:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.Ja=e}get tGa(){return this.Ja.tGa}get Tfl(){return 4!==this.Ja.style}get Wfl(){return!0}get trie(){return this.Ja.trie}getId(e,
m){if(!this.Tfl)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ja.style){case 0:return this.z2i(e,m);default:throw Error.notImplemented();}}pa(e){if(!this.Wfl)throw Error.invalidOperation("String lookup not supported on this string table");if(0>e||e>=this.tGa)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ja.style){case 0:return this.Rbj(e);case 4:return this.Qbj(e);default:throw Error.notImplemented();}}z2i(e,m){e=this.Ja.trie.PAg(e,
0,e.length,m);if(!e.succeeded)return-1;if(0>e.tIb||e.tIb>=this.Ja.tGa)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ja.Amc?this.Ja.Ugc.Kt(this.Ja.Amc+4*e.tIb,4):e.tIb}Rbj(e){if(this.Ja.Amc){let m=0;for(;m<this.Ja.tGa&&this.Ja.Ugc.Kt(this.Ja.Amc+4*m,4)!==e;++m);if(m>=this.Ja.tGa)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ja.trie.odg(m)}return this.Ja.trie.odg(e)}Qbj(e){const m=this.Ja.Ugc.Kt(this.Ja.Vrh+4*e,4);e=
this.Ja.Ugc.Kt(this.Ja.Wrh+4*e,4);if(0>e||0>m)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const r=Array(m);for(let v=0;v<m;++v)r[v]=({grj:e}=this.jFk(e)).returnValue;return String.fromCharCode.apply(null,r)}jFk(e){let m=0;for(let r=0;3>r;++r){const v=this.Ja.Ugc.ga(this.Ja.yLf+e)^182;++e;m|=(v&127)<<7*r;if(!(v&128))break}return{returnValue:m,grj:e}}}Object(J.a)(h,"StringTable",null,[1137])},678:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(688);
class e{constructor(m){this.trie=null;this.yLf=this.Vrh=this.Wrh=this.Amc=0;if(m){this.Ugc=m;var r=0;if(m.Kt(r,4)!==e.h3a)throw Error.argument("bytes","Input does not represent a string table");r+=4;this.tGa=m.Kt(r,4);r+=4;this.style=m.Kt(r,4);r+=4;switch(this.style){case 0:const v=1===m.Kt(r,4);r+=4;v||(this.Amc=r,r+=4*this.tGa);m.Kt(r,4);this.trie=this.$qk(m,r+4);break;case 4:this.Wrh=r;this.Vrh=r+=4*this.tGa;r+=4*this.tGa;m.Kt(r,4);this.yLf=r+4;break;default:throw Error.argument("bytes");}}}$qk(m,
r){return new h.a(m,r)}}e.h3a=1025118440;Object(J.a)(e,"StringTableInit",null,[])},688:function(J,V,d){J=d(0);class h{constructor(x){this.ITg=x;this.succeeded=!1;this.tIb=x?x.tIb:0;this.sMj=!1;this.length=this.Jhl=0}}Object(J.a)(h,"TrieResult",null,[]);class e{constructor(x,y,u){this.$n=new h(null);this.p2j=x;this.e8b=y;this.fEg=y+u-1}get result(){return this.$n}iag(){let x;return this.e8b<=this.fEg?(x=this.p2j.charAt(this.e8b),++this.e8b,{returnValue:!0,ch:x}):{returnValue:!1,ch:"\x00"}}NCe(x,y,
u){x&&(this.$n.sMj=!0,this.$n.Jhl=y);this.$n.length=this.e8b;this.$n.succeeded=!0;this.$n.tIb=u;this.e8b!==this.fEg+1&&(this.$n=new h(this.$n))}}Object(J.a)(e,"LookUpStringVisitor",null,[1171]);var m=d(948);class r{constructor(){this.iLf=this.MIf=this.OIf=this.LIf=this.NIf=this.YJd=this.XJd=this.$Jd=this.WJd=0}}Object(J.a)(r,"TRIESTATS",null,[]);class v{constructor(){this.symbol=this.mcc=0}}Object(J.a)(v,"TrieSymbol",null,[]);d.d(V,"a",function(){return A});class A{constructor(x,y){this.jT=null;this.kZc=
this.DGg=this.BGg=this.FGg=this.xGg=this.EGg=this.CGg=this.GGg=this.yGg=0;this.RB=x;if(x.Kt(y,4)!==A.h3a)throw Error.argument("Input does not represent a trie");y+=4;this.EEg=1===x.Kt(y,4);y+=4;this.cZj=1===x.Kt(y,4);y+=4;this.NYj=x.Kt(y,4);y+=4;if(x.Kt(y,4)){x=y+4;this.jT=this.lFk(x);this.yGg=y=x+A.xei;this.GGg=y+=A.ABc*(this.jT.WJd+(this.jT.WJd%2?1:0));this.CGg=y+=A.ABc*(this.jT.$Jd+(this.jT.$Jd%2?1:0));this.EGg=y+=A.ABc*(this.jT.XJd+(this.jT.XJd%2?1:0));this.xGg=y+=A.ABc*(this.jT.YJd+(this.jT.YJd%
2?1:0));this.FGg=y+=A.dKd*this.jT.LIf;this.BGg=y+=A.eKd*this.jT.OIf;this.DGg=y+=A.eKd*this.jT.MIf;y+=A.eKd*this.jT.NIf;if(y!==x+this.jT.iLf)throw Error.argument("Corrupted trie binary");this.kZc=y}else this.jT=null}PAg(x,y,u,H){x=new e(x,y,u);this.zCh(x,H);return x.result}odg(x){if(this.EEg)if(x)--x;else return"";if(!this.jT)throw Error.argument("Invalid trieID");const y=new m.a;y.Wy=0;this.fhb(y);const u=[];for(;;){if(y.Wy&A.DJa)if(x)--x;else return Array.add(u,y.Fhb),String.fromCharCode.apply(null,
u);const H=!!(y.Wy&A.cnd),G=this.Hrb(y,!0);if(H||x<G){if(Array.add(u,y.Fhb),!this.fhb(y))throw Error.argument("Invalid trieID");}else if(x-=G,!this.zmc(y))throw Error.argument("Invalid trieID");}}zCh(x,y){let u=0;this.EEg&&(x.NCe(this.cZj,this.NYj,0),++u);if(this.jT){var H=new m.a;H.Wy=0;if(this.fhb(H))for(;;){var G=void 0;if(!({ch:G}=x.iag()).returnValue)break;y&&(G=y(G));G=G.toString().charCodeAt(0);let E=!1;for(;!E;){const I=!!(H.Wy&A.DJa);if(H.Fhb===G){if(E=!0,I&&x.NCe(!!(H.Wy&A.tUe),H.ijd,u),
!this.fhb(H))return}else if(u+=this.Hrb(H,!0),!this.zmc(H))return;I&&++u}}}}fhb(x){if(!x.Wy)return this.eQe(x),!0;if(!(x.Wy&A.bnd))return!1;x.Lra=0;x.zs=x.SQa;this.eQe(x);return!0}zmc(x){if(x.Wy&A.cnd)return!1;this.eQe(x);return!0}Hrb(x,y){return x.Wy&A.sUe?x.wBc:x.Wy&A.bnd?!y&&x.Wy&A.cnd?this.oZi(x):1:0}oZi(x){x=A.nMd(x);if(!this.fhb(x))return 0;let y=0;do x.Wy&A.DJa&&++y,y+=this.Hrb(x,!1);while(this.zmc(x));return y}eQe(x){x.Wy||(x.Lra=0,x.zs=this.kZc);var y=this.JFc(this.yGg,x.zs),u=y.symbol;x.zs+=
y.mcc;y=this.RB.Kt(this.xGg+A.dKd*u,A.dKd);x.Fhb=y&65535;x.Wy=y>>16;x.Wy&A.sUe&&(x.wBc=this.BBi(x));x.Wy&A.tUe&&(y=this.JFc(this.GGg,x.zs),u=y.symbol,x.zs+=y.mcc,x.ijd=this.RB.Kt(this.FGg+4*u,4));x.Wy&A.DEh?(x.SQa=this.kZc+((this.RB.ga(x.zs)<<8|this.RB.ga(x.zs+1))<<8|this.RB.ga(x.zs+2)),x.zs+=3):x.Wy&A.EEh?(x.SQa=x.zs,x.Lra=x.SQa):x.Wy&A.FEh?(y=this.JFc(this.CGg,x.zs),u=y.symbol,x.zs+=y.mcc,x.SQa=this.kZc+this.RB.Kt(this.BGg+4*u,4)):x.Wy&A.bnd&&(y=this.JFc(this.EGg,x.zs),u=y.symbol,x.zs+=y.mcc,x.Lra||
(x.Lra=x.zs),x.Lra+=this.RB.Kt(this.DGg+4*u,4),x.SQa=x.Lra)}JFc(x,y){const u=new v;let H=0;for(;;){H+=this.RB.ga(y);++y;++u.mcc;const G=this.RB.Kt(x,2);if(H<G)break;u.symbol+=G;H-=G;x+=2;H<<=8}u.symbol+=H;return u}BBi(x){let y=this.RB.ga(x.zs);192<=y?(y=(y&63)<<15|(this.RB.ga(x.zs+1)&127)<<8,y|=this.RB.ga(x.zs+2),x.zs+=3):128<=y?(y=(y&127)<<8|this.RB.ga(x.zs+1),x.zs+=2):x.zs+=1;return y}lFk(x){const y=new r;y.WJd=this.RB.Kt(x+12,2);y.$Jd=this.RB.Kt(x+14,2);y.XJd=this.RB.Kt(x+16,2);y.YJd=this.RB.Kt(x+
18,2);y.NIf=this.RB.Kt(x+24,4);y.LIf=this.RB.Kt(x+28,4);y.OIf=this.RB.Kt(x+32,4);y.MIf=this.RB.Kt(x+36,4);y.iLf=this.RB.Kt(x+40,4);return y}static nMd(x){const y=new m.a;y.Fhb=x.Fhb;y.Wy=x.Wy;y.wBc=x.wBc;y.zs=x.zs;y.SQa=x.SQa;y.Lra=x.Lra;y.ijd=x.ijd;return y}}A.h3a=1654263084;A.xei=48;A.ABc=2;A.eKd=4;A.dKd=4;A.DJa=1;A.cnd=2;A.sUe=4;A.tUe=8;A.bnd=16;A.EEh=64;A.FEh=128;A.DEh=256;Object(J.a)(A,"Trie",null,[1157])},695:function(J,V,d){d.r(V);J=d(0);d(146);var h=d(260),e=d(119),m=d(25),r=d(79),v=d(35);
class A{constructor(){this.qCd=0}pAe(I,Q){this.qCd=window.performance.now();this.pZa(()=>{const D=window.performance.now(),Y={};Q.b5h&&(Y.callback=M=>{I(M,OSF.StoreTypeEnum.MarketPlace,D)},m.AFrameworkApplication.Va.Ma(v.a.oWa,2,Y));Q.c5h&&(Y.callback=M=>{I(M,OSF.StoreTypeEnum.PrivateCatalog,D)},m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?Y.storeType=10:Y.storeType=OSF.StoreTypeEnum.PrivateCatalog,m.AFrameworkApplication.Va.Ma(v.a.oWa,
2,Y))},0,()=>{if(e.TellMeActor.instance.Ld)e.TellMeActor.instance.Ld.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.qCd)+" ms")})}pZa(I,Q=0,D=null){2!==m.AFrameworkApplication.Va.processAction(v.a.oWa,1)?(e.TellMeActor.instance.Ld&&e.TellMeActor.instance.Ld.MI(h.a.$4h,window.performance.now()-this.qCd),I()):20>Q?m.AFrameworkApplication.ve.Hb(new r.a(2,1,500,()=>{this.pZa(I,Q+1,D)})):D&&D()}static get instance(){A.Ka||(A.Ka=
new A);return A.Ka}}A.Ka=null;Object(J.a)(A,"AddinEntitlementsQuery",null,[]);class x{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.Lae=this.storeType=this.storeId=this.Jzk=this.iconUrl=null}}Object(J.a)(x,"AddinInfo",null,[]);var y=d(158),u=d(175),H=d(174),G=d(103);d.d(V,"AddinResultsProvider",function(){return E});class E{constructor(I){this.ub=I;this.Ihk=(Q,D,Y)=>{if(Q){const M=Q.errorCode;
if(e.TellMeActor.instance.Ld){const N={};N.StoreType=D;N.ErrorCode=M;N.AddinCount=Q.value?Q.value.length:0;e.TellMeActor.instance.Ld.MI(h.a.xVi,window.performance.now()-Y,N)}if(0===M&&Q.value){E.K2a=E.K2a||{};Q=Q.value;for(const N of Q)Q=new x,Q.displayName=N[0],Q.id=N[1],Q.description=N[2],Q.targetType=N[3],Q.appVersion=4<N.length?N[4]:"",Q.assetId=5<N.length?N[5]:"",Q.assetStoreId=6<N.length?N[6]:"",Q.width=7<N.length?N[7]:0,Q.height=8<N.length?N[8]:0,Q.iconUrl=9<N.length?N[9]:"",Q.Jzk=10<N.length?
N[10]:"",Q.storeId=11<N.length?N[11]:"",Q.storeType=12<N.length?N[12]:"",this.ub.ghh&&(Q.Lae=this.w3i(Q)),E.K2a[Q.id]=Q,0<Q.iconUrl.length&&appChrome.addInApi.registerAddinIcon("AddinIcon_"+Q.id,Q.iconUrl)}}};A.instance.pAe(this.Ihk,this.ub)}lG(){return"Add-ins"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:2}oD(I,Q,D,Y,M=null){D=new H.a(I);M&&!Array.contains(M,24)||G.a.eN(I)||(M=new u.a(24),M.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.e3i(I.Hf,M),D.ns(M));Q.resultsUpdated(D)}e3i(I,
Q){if((I=this.XVk(I))&&0<I.length){let D=0;I.forEach(Y=>{if(!(3<++D)){var M="AddinSuggestion"+D,N={};N["default"]=0<Y.iconUrl.length?"AddinIcon_"+Y.id:"AppForOfficeLogo_20";var W=[];W.push(appChrome.actions.setControlLabel(M,Y.displayName));W.push(appChrome.actions.setControlIconSet(M,N));W.push(appChrome.actions.setCompoundButtonCommandValueId(M,Y.id));W.push(appChrome.actions.updateCompoundButtonDescription(M,Y.description));appChrome.api.dispatch(W);M=new y.a(M,25,void 0,void 0,1);M.NGd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Y.id,
Y.storeType,Y.assetId,null,null,Y.storeId);Q.Bv(M)}})}}XVk(I){if(!E.K2a)return null;const Q=[],D=E.K2a;for(let M in D){var Y=D[M];Y&&(this.ub.ghh?E.N9j(I,Y)&&Array.add(Q,Y):0<=Y.displayName.toLowerCase().indexOf(I.toLowerCase())?Array.add(Q,Y):this.ub.AKj&&0<=Y.description.toLowerCase().indexOf(I.toLowerCase())&&Array.add(Q,Y))}return Q}w3i(I){const Q=E.Yqh(I.displayName);this.ub.a5h&&Array.addRange(Q,E.Yqh(I.description));return Q}static N9j(I,Q){if(!Q.Lae)return!1;for(const D of I.split(" ")){I=
!1;for(const Y of Q.Lae)if(Y.toLowerCase().startsWith(D.toLowerCase())){I=!0;break}if(!I)return!1}return!0}static Yqh(I){const Q=[];for(const D of I.split(" ")){I=0;for(let Y=0;Y<D.length;Y++){const M=D.charAt(Y);M.toString().toUpperCase()===M.toString()&&Y>I&&(Array.add(Q,D.substring(I,Y)),I=Y)}Array.add(Q,D.substring(I,D.length));I&&Array.add(Q,D.substring(0,D.length))}return Q}}E.K2a=null;Object(J.a)(E,"AddinResultsProvider",null,[982])},77:function(J,V,d){d.r(V);J=d(0);var h=d(22),e=d(215),m=
d(136),r=d(677),v=d(678);class A{constructor(y,u){this.UKa=!1;this.b3=null;if(!y)throw Error.argumentNull("annotations");if(!y.uvb(u))throw Error.argument("structTypeID","Invalid struct type ID");this.hr=y;this.uwb=this.hr.vag(u);this.AUh=u}get Zmb(){return this.hr}get isReadOnly(){return this.UKa}get Jwa(){return this.AUh}JPa(y){if(0>y||y>=this.uwb)throw Error.argument("iField","Invalid field index");return this.b3&&null!=this.b3[y]?this.b3[y]:this.hr.pdg(this.Jwa,y)}IHe(y,u){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");
if(0>y||y>=this.uwb)throw Error.argument("iField","Invalid field index");if(!this.hr.tub(this.hr.z6a(this.Jwa,y),u))throw Error.argument("value","Value is not of the correct type for the specified field");(this.b3||(this.b3=Array(this.uwb)))[y]=u}D0(){const {Annotations:y}=d(77);let u="[";if(this.b3){let H=!0;for(let G=0;G<this.uwb;++G){if(null==this.b3[G])continue;const E=this.hr.z6a(this.Jwa,G);if(y.oZa(E,this.b3[G],this.hr.pdg(this.Jwa,G)))continue;H?H=!1:u+=", ";u+=this.hr.qdg(this.Jwa,G);u+=
"=";const I=this.hr.D0(E,this.b3[G]);E===y.LX?(u+='"',u+=e.a.xTd(I),u+='"'):u+=I}}return u+"]"}isEqual(y){const {Annotations:u}=d(77);if(this===y)return!0;if(!y||this.hr!==y.Zmb||this.Jwa!==y.Jwa)return!1;for(let H=0;H<this.uwb;++H)if(!u.oZa(this.hr.z6a(this.Jwa,H),this.JPa(H),y.JPa(H)))return!1;return!0}clone(){const y=new A(this.hr,this.Jwa);this.b3&&(y.b3=Array.clone(this.b3));return y}$J(){return this.isReadOnly?this.clone():this}Rbe(){const {Annotations:y}=d(77);if(!this.isReadOnly&&(this.UKa=
!0,this.b3))for(let u=0;u<this.uwb;++u){const H=this.b3[u];null!=H&&y.j9a(H)}}toString(){return this.D0()}}Object(J.a)(A,"StructValue",null,[1120,1118]);d.d(V,"Annotations",function(){return x});class x{constructor(y,u){if(!y)throw Error.argumentNull("initData");if(!u)throw Error.argumentNull("objectFetcher");this.DYj=u.OGi;let H=0;var G=u.yPa(y.ga(H));++H;this.Dpe=new r.a(new v.a(G));this.GJh=y.ga(H);++H;this.jEg=Array(this.SHc);this.s7b=Array(this.SHc);this.fTa=Array(this.SHc);for(G=0;G<this.SHc;++G){this.jEg[G]=
u.pa(y.ga(H));++H;this.s7b[G]=y.ga(H);++H;var E=y.ga(H);++H;this.fTa[G]=Array(E);for(var I=0;I<E;++I)this.fTa[G][I]=u.pa(y.ga(H)),++H}this.zUh=y.ga(H);++H;this.AOg=Array(this.Ykc);this.e3c=Array(this.Ykc);this.f3c=Array(this.Ykc);this.d3c=Array(this.Ykc);for(G=0;G<this.Ykc;++G)for(this.AOg[G]=u.pa(y.ga(H)),++H,E=y.ga(H),++H,this.e3c[G]=Array(E),this.f3c[G]=Array(E),this.d3c[G]=Array(E),I=0;I<E;++I)this.e3c[G][I]=u.pa(y.ga(H)),++H,this.f3c[G][I]=y.ga(H),++H,this.d3c[G][I]=({z2:H}=this.mqa(this.f3c[G][I],
y,H,null,null,null)).returnValue,x.j9a(this.d3c[G][I]);this.kGh=y.ga(H);++H;this.ode=Array(this.vnb);this.pde=Array(this.vnb);this.nde=Array(this.vnb);for(G=0;G<this.vnb;++G)this.ode[G]=u.pa(y.ga(H)),++H,this.pde[G]=y.ga(H),++H,this.nde[G]=({z2:H}=this.mqa(this.pde[G],y,H,null,null,null)).returnValue,x.j9a(this.nde[G])}JZb(y){for(let u=0;u<this.vnb;++u)if(this.ode[u]===y)return u;return-1}O5f(y){if(!this.tvb(y))throw Error.argument("attrID","Invalid attribute ID");return this.ode[y]}getAttributeType(y){if(!this.tvb(y))throw Error.argument("attrID",
"Invalid attribute ID");return this.pde[y]}z6a(y,u){if(!this.uvb(y))throw Error.argument("structTypeID","Invalid struct type ID");y=this.f3c[x.Zkc(y)];if(0>u||u>=y.length)throw Error.argument("iField","Invalid field index");return y[u]}D0(y,u){if(!this.qae(y))throw Error.argument("typeID","Invalid type ID");if(!this.tub(y,u))throw Error.argument("value","Value is not of the correct type");switch(y){case x.LX:return u;case x.Kea:return u?"True":"False";case x.gna:case x.k$:return u.toString();case x.WL:return u.D0();
default:if(!x.gB(y)&&x.Omc(y)){y=x.sTd(y);const E=this.fTa[y].length;switch(this.s7b[y]){case 0:return this.fTa[y][u];case 1:if(u){var H="";for(var G=1;G<E;++G)u&1<<G-1&&(0<H.length&&(H+=" & "),H+=this.fTa[y][G]);return H}return this.fTa[y][0];case 2:H="";for(G=0;G<E;++G)u&1<<G&&(0<H.length&&(H+=" & "),H+=this.fTa[y][G]);return H;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.s7b[y]);}}else return u.D0()}}qae(y){switch(y){case x.LX:case x.Kea:case x.gna:case x.k$:case x.WL:return!0;
default:return x.gB(y)?this.qae(x.TBa(y)):x.Omc(y)?this.ANj(y):this.uvb(y)}}ANj(y){y=x.sTd(y);return 0<=y&&y<this.jEg.length}uvb(y){y=x.Zkc(y);return 0<=y&&y<this.AOg.length}tvb(y){return 0<=y&&y<this.vnb}tub(y,u){if(null==u)return!1;switch(y){case x.LX:return"string"===typeof u;case x.Kea:return"boolean"===typeof u;case x.gna:return"number"===typeof u;case x.k$:return"number"===typeof u;case x.WL:return Object(h.a)(1117,u);default:if(x.gB(y))return Object(h.a)(1119,u)&&u.oT===x.TBa(y);if(x.Omc(y)){if("number"!==
typeof u)return!1;y=x.sTd(y);const H=this.fTa[y].length;switch(this.s7b[y]){case 0:return 0<=u&&u<H;case 1:return!(u&-1<<H-1);case 2:return!!u&&!(u&-1<<H);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.s7b[y]);}}else return Object(h.a)(1120,u)&&u.Jwa===y}}get vnb(){return this.kGh}get SHc(){return this.GJh}get Ykc(){return this.zUh}pWi(y){if(!this.tvb(y))throw Error.argument("attrID","Invalid attribute ID");return this.nde[y]}vag(y){if(!this.uvb(y))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.e3c[x.Zkc(y)].length}qdg(y,u){if(!this.uvb(y))throw Error.argument("structTypeID","Invalid struct type ID");return this.e3c[x.Zkc(y)][u]}pdg(y,u){if(!this.uvb(y))throw Error.argument("structTypeID","Invalid struct type ID");y=this.d3c[x.Zkc(y)];if(0>u||u>=y.length)throw Error.argument("iField","Invalid field index");return y[u]}mqa(y,u,H,G,E,I){if(!u)throw Error.argumentNull("initData");if(x.gB(y)){var Q=u.ga(H);++H;y=x.TBa(y);var D=new m.a(this,y);for(var Y=
0;Y<Q;++Y)Array.add(D.items,({z2:H}=this.mqa(y,u,H,G,E,I)).returnValue);return{returnValue:D,z2:H}}switch(y){case x.LX:return{returnValue:(G||this.Dpe).pa(u.ga(H++)),z2:H};case x.Kea:return{returnValue:1===u.ga(H++),z2:H};case x.gna:return{returnValue:u.ga(H++),z2:H};case x.k$:return{returnValue:(E||this.DYj)[u.ga(H++)],z2:H};case x.WL:y=u.ga(H++);Q=new e.a(this);for(D=0;D<y;++D)Y=u.ga(H),++H,I&&(Y=I[Y]),Q.Lt(Y,({z2:H}=this.mqa(this.getAttributeType(Y),u,H,G,E,I)).returnValue);return{returnValue:Q,
z2:H};default:if(x.Omc(y))return{returnValue:u.ga(H++),z2:H};if(x.Yxh(y)){Q=u.ga(H++);D=new A(this,y);for(Y=0;Y<Q;++Y){const M=u.ga(H);++H;D.IHe(M,({z2:H}=this.mqa(this.z6a(y,M),u,H,G,E,I)).returnValue)}return{returnValue:D,z2:H}}throw Error.argument("typeID","Invalid type ID");}}static Omc(y){return 16<=(y&16383)&&16384!==(y&16384)&&32768!==(y&32768)}static Yxh(y){return 16<=(y&16383)&&16384===(y&16384)&&32768!==(y&32768)}static gB(y){return 32768===(y&32768)}static u4i(y){if(x.gB(y))throw Error.argument("nonListTypeID",
"Non-list type ID required");return y|32768}static TBa(y){if(!x.gB(y))throw Error.argument("listTypeID","List type ID required");return y&-32769}static oZa(y,u,H){switch(y){case x.LX:case x.Kea:case x.gna:case x.k$:return u===H;case x.WL:return u.isEqual(H);default:return x.gB(y)?u.isEqual(H):x.Omc(y)?u===H:u.isEqual(H)}}static j9a(y){Object(h.a)(1118,y)&&y.Rbe()}static $J(y){return Object(h.a)(1118,y)?y.$J():y}static sTd(y){return y-16}static Zkc(y){return(y&-16385)-16}}x.LX=1;x.Kea=2;x.gna=3;x.k$=
5;x.WL=9;Object(J.a)(x,"Annotations",null,[1121])},938:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.Kva=e}}Object(J.a)(h,"SessionRehydratedEventArgs",Sys.EventArgs,[])},939:function(J,V,d){d.r(V);d.d(V,"InsightsMenuItemFactory",function(){return r});J=d(0);var h=d(103),e=d(133),m=d(45);class r{constructor(v=null){this.VLh=v||CommonUIStrings.l_InsightsButtonText}get teb(){return 10}cK(v){var A=v.QI;v=h.a.Yia()?h.a.UNa(A,1):h.a.cPd(A);
A=String.format(this.VLh,A);return this.zUi(v,A)}zUi(v,A){return e.a(r.Xog,h.a.Yia()?"1914896509":"3317204163",m.a.le(A),h.a.$xj,null,m.a.le(v),m.a.le(A),null,null)}}r.Xog="bInsights";Object(J.a)(r,"InsightsMenuItemFactory",null,[981])},940:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(133),e=d(45);class m{constructor(r,v,A,x,y){this.hBd=r;this.gBd=v;this.oVh=A;this.jLh=x;this.A4e=y}get teb(){return 4}cK(r,v=null){v=v.sessionId+"|"+v.r7+"|"+r.QI;if(this.A4e||this.jLh){let A=this.A4e||
e.a.vC(CommonUIStrings.l_HelpTooltip)===e.a.vC(r.QI.trim());if(this.oVh&&2<r.QI.length){const x=r.QI;";"===x.charAt(0)&&";"===x.charAt(x.length-1)&&x.substring(1,x.length-1)===m.J3d&&(A=!0)}r=A?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,r.QI);return this.e5f(v,e.a.le(r),A)}return this.e5f(v,e.a.le(String.format(CommonUIStrings.l_TextWithQuotation,r.QI)),!1)}e5f(r,v,A){return h.a(m.J3d,A?this.gBd:this.hBd,v,"OfficeAssistant_16x16x32","A0",e.a.le(r),
v,null,null)}}m.J3d="bSearchHelp";Object(J.a)(m,"AssistanceMenuItemFactory",null,[981])},941:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(25),e=d(133),m=d(72),r=d(45);class v{get teb(){return 13}cK(){return v.vci()}static vci(){return e.b(v.W2f,"798637440",r.a.le(CommonUIStrings.l_LookupFirstRunExperienceTitle),h.AFrameworkApplication.Rl,m.getImageClass("Info_32x32x32"),null,null,r.a.le(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,r.a.le(CommonUIStrings.l_LookupFirstRunExperienceDescription),
null,null)}}v.W2f="bTellMeFirstRun";Object(J.a)(v,"FirstRunMenuItemFactory",null,[981])},942:function(J,V,d){d.d(V,"a",function(){return r});J=d(0);var h=d(25),e=d(133),m=d(45);class r{constructor(v=null,A=null){this.mef=v;this.yPh=A||CommonUIStrings.l_LookupNoResultsDescription}get teb(){return 14}cK(v){v=String.format(this.yPh,v.QI);return this.adi(v)}adi(v){return e.b(r.PTg,"798637440",m.a.le(CommonUIStrings.l_LookupNoResultsTitle),this.mef?h.AFrameworkApplication.Rl:null,this.mef,null,null,m.a.le(CommonUIStrings.l_LookupNoResultsTitle),
"Menu32",null,null,m.a.le(v),null,null)}}r.PTg="lookupNoResults";Object(J.a)(r,"NoCommandsFoundMenuItemFactory",null,[981])},943:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=m}}Object(J.a)(h,"LabelFormatted",null,[])},944:function(J,V,d){d.d(V,"a",function(){return A});J=d(0);d(146);var h=d(158),e=d(175),m=d(174),r=d(103),v=d(45);class A{constructor(x){this.ub=x}lG(){return"Assistance"}zP(){return 0===
this.ub.Yq?0:1===this.ub.Yq?1:this.ub.Bdc?3:2}oD(x,y,u=!1,H,G=null){H=new m.a(x);if((!G||Array.contains(G,8))&&!r.a.eN(x)){G=new e.a(8);if(u){u=v.a.vC(CommonUIStrings.l_HelpTooltip)===v.a.vC(x.Hf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,x.Hf);const E=[];this.ub.VRa&&(this.ub.CKe||E.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),u=this.nag(x.Hf));const I="||"+x.Hf;E.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",
u));E.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",I));appChrome.api.dispatch(E);x=new h.a("GetHelpFromTellMe",4,x.Hf,null,1)}else x=new h.a("bSearchHelp",4,x.Hf,null,1);G.Bv(x);G.displayName=CommonUIStrings.l_HelpButtonTitle;H.ns(G)}y.resultsUpdated(H)}qQa(x,y=null){const u=new e.a(8),H=v.a.vC(CommonUIStrings.l_HelpTooltip)===v.a.vC(x.Hf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,x.Hf);for(let E=0;E<y.length&&2>E;E++){var G=
void 0;G=[];let I="GetHelpWithDescriptionFromTellMe"+(E+1).toString(),Q=4;if(this.ub.akc)G.push(appChrome.actions.setControlLabel(I,H)),G.push(appChrome.actions.setCompoundButtonCommandValueId(I,x.Hf)),G.push(appChrome.actions.updateCompoundButtonDescription(I,this.Ydj(y.length)));else if(this.ub.bkc){let D=this.qeg(y[E]);I="GetHelpFromTellMe"+(E+1).toString();this.ub.VRa&&(D=this.nag(D));Q=9;G.push(appChrome.actions.setControlLabel(I,D));G.push(appChrome.actions.setButtonCommandValueId(I,this.Wdj(y[E])))}appChrome.api.dispatch(G);
G=new h.a(I,Q,null,null,0);G.label=this.qeg(y[E]);G.description=this.Vdj(y[E]);u.Bv(G);if(this.ub.bkc)break}u.displayName=CommonUIStrings.l_HelpButtonTitle;return u}Ydj(x){return 1===x?String.format(CommonUIStrings.l_SearchResultText,x):String.format(CommonUIStrings.l_SearchResultsText,x)}nag(x){return this.ub.Q$d?r.a.QYd(x,CommonUIStrings.l_HelpScopedButtonText):x+CommonUIStrings.l_HelpScopedButtonText}qeg(x){return x.name?x.name:""}Vdj(x){return x.description?x.description:""}Wdj(x){return x.id?
"AssetID="+x.id:""}}Object(J.a)(A,"AssistanceResultsProvider",null,[982])},945:function(J,V,d){d.d(V,"a",function(){return x});J=d(0);d(146);var h=d(158),e=d(175),m=d(174),r=d(119),v=d(103),A=d(442);class x{constructor(y){this.ub=y}lG(){return"Image"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:3===this.ub.Yq?3:2}oD(y,u,H,G,E=null){H=new m.a(y);(!E||Array.contains(E,19))&&v.a.eN(y)&&this.ub.hJ&&this.qQa(y,H,1);u.resultsUpdated(H)}qQa(y,u,H,G=null){var E=[];let I;r.TellMeActor.instance.hG()&&r.TellMeActor.instance.hG().VRa?
(I=this.ub.Q$d?v.a.QYd(y.Hf,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):y.Hf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.ub.CKe||E.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):I=this.ub.hJ?v.a.eN(y)?this.ub.UMa?v.a.wPa(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.ub.UMa?v.a.wPa(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
y.Hf)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,y.Hf):this.ub.BGb?CommonUIStrings.l_TellMeImageSuggestionButtonText:y.Hf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.ub.lia?(r.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",I)),E=v.a.UNa(y.Hf,9,Object.assign(new A.a,{landingTab:"Image"})),r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",E))):(E.push(appChrome.actions.setControlLabel("ImageForSearch",
I)),y=v.a.UNa(y.Hf,9,Object.assign(new A.a,{landingTab:"Image"})),E.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",y)),appChrome.api.dispatch(E));H=new h.a("ImageForSearch",12,null,null,H);G&&(H.score=G.ConfidenceScore);G=new e.a(19,this.ub.BGb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);G.Bv(H);u.ns(G)}}Object(J.a)(x,"ImageResultsProvider",null,[982])},946:function(J,V,d){d.d(V,"a",function(){return A});J=d(0);d(146);var h=d(158),e=d(175),m=d(174),r=
d(103),v=d(25);class A{constructor(x){this.ub=x}lG(){return"Template"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:3}oD(x,y){x=new m.a(x);y.resultsUpdated(x)}qQa(x,y,u){var H=[];let G;G=this.ub.hJ?this.ub.UMa?r.a.wPa(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,x.Hf)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,x.Hf):String.format(CommonUIStrings.l_TellMeTemplateButtonText,x.Hf);H.push(appChrome.actions.setControlLabel("TemplateForSearch",G));H.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(v.AFrameworkApplication.fa.Ia("TellMeTemplateProviderURL"),v.AFrameworkApplication.uiCulture,x.Hf)));appChrome.api.dispatch(H);x=new e.a(23);x.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;H=new h.a("TemplateForSearch",24,null,null,0);H.label=u[0].Title?u[0].Title:"";H.description=u[0].Description?u[0].Description:"";x.Bv(H);y.ns(x)}}Object(J.a)(A,"TemplateResultsProvider",null,[982])},947:function(J,V,d){d.d(V,"a",function(){return u});J=d(0);d(146);var h=d(322),e=d(158),
m=d(175),r=d(174),v=d(676),A=d(119),x=d(103),y=d(45);class u{constructor(H,G,E,I){this.qR=H;this.sMa=G;this.oxf=I;this.mKh=E;this.ub=A.TellMeActor.instance.hG()}lG(){return"EmptyQuery"}zP(){return 1===this.ub.Yq?1:0}oD(H,G,E=!1,I,Q=null){I=new r.a(H);if((!Q||Array.contains(Q,5)||Array.contains(Q,6)||Array.contains(Q,4))&&x.a.eN(H)){this.qR.d_b().length||!this.mKh||this.oxf||(H=new m.a(6),Q=new e.a(null,13,void 0,void 0,1),H.Bv(Q),I.ns(H));H=new m.a(4);if(0<this.qR.d_b().length){H.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;
Q=this.qR.d_b();var D=[];for(var Y of Q)D.push(Y.Id);h.CommandResultsUtility.SIb(D,this.ub);for(var M of Q)h.CommandResultsUtility.Z2b(M.Id)&&H.Bv(new e.a(M.Id,5,null,null,2));I.ns(H)}if(this.oxf&&0<this.sMa.length&&this.qR.d_b().length<u.rRg){Y=new m.a(5);Y.displayName=CommonUIStrings.l_TellMeTryQueryTitle;M=u.rRg-H.results.length;H=[];for(Q=0;Q<this.sMa.length&&Q<M;++Q){if(E){D=x.a.aRe+(Q+1);const N=this.sMa[Q].key,W=y.a.replaceAll(N,'"',"");H.push(appChrome.actions.setControlLabel(D,N));H.push(appChrome.actions.setButtonCommandValueId(D,
W));D=new v.a(N,7,0,W,D)}else D=new v.a(this.sMa[Q].key,7,0,this.sMa[Q].value);Y.Bv(D)}0<H.length&&appChrome.api.dispatch(H);I.ns(Y)}}G.resultsUpdated(I)}}u.rRg=5;Object(J.a)(u,"EmptyQueryResultsProvider",null,[982])},948:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ijd=this.Lra=this.SQa=this.zs=this.wBc=this.Wy=this.Fhb=0}}Object(J.a)(h,"TRIESCAN",null,[])},966:function(J,V,d){d.r(V);var h=d(0),e=d(146),m=d(369),r=d(260),v=d(695);class A{constructor(wa,Ma){this.dod=
wa;this.Nh=Ma}resultsUpdated(wa){this.dod.b2k(this.Nh,wa)}}Object(h.a)(A,"AggregatorResultsProviderCallback",null,[985]);var x=d(175),y=d(174);class u{constructor(wa){this.z$=null;this.ub=wa;this.ub.Q2a&&(this.z$=null)}lG(){return"AppsForOffice"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:2}oD(wa,Ma,hb,ub,na=null){hb=new y.a(wa);if(!na||Array.contains(na,1))na=new x.a(1),this.z$.tzl(na,wa.Hf),hb.ns(na);Ma.resultsUpdated(hb)}}Object(h.a)(u,"AppsForOfficeRecommendationResultsProvider",null,[982]);
var H=d(944),G=d(77),E=d(215),I=d(22);class Q{constructor(wa,Ma){this.Ja=wa;this.$Yj=Ma}isMatch(wa,Ma){if(!Object(I.a)(1117,wa))throw Error.argument("objToTest","Expected feature bundle");let hb;return({value:hb}=wa.wm(this.Ja.Baa)).returnValue?this.Ja.yTe.isMatch(hb,Ma):this.$Yj}}Object(h.a)(Q,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1139]);class D{constructor(wa,Ma){this.Ja=wa;this.Wge=Ma}isMatch(wa){if(!Object(I.a)(1117,wa))throw Error.argument("objToTest","Expected feature bundle");
return!!(this.Wge^wa.wm(this.Ja.Baa).returnValue)}}Object(h.a)(D,"AnnotatedWithAnnotationFilter",null,[1139]);class Y{constructor(wa){this.Ja=wa}isMatch(wa,Ma){if(!Object(I.a)(1120,wa))throw Error.argument("objToTest","Expected struct value");return this.Ja.yTe.isMatch(wa.JPa(this.Ja.Mqa),Ma)}}Object(h.a)(Y,"FieldValueMatchesStructFilter",null,[1139]);class M{constructor(wa,Ma){wa&&(this.Mqa=wa.ga(0),this.yTe=Ma.b7(wa.ga(1)))}}Object(h.a)(M,"FieldValueMatchesStructFilterInit",null,[]);class N{constructor(wa){this.Wge=
wa}isMatch(wa){if(!Object(I.a)(1117,wa))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Wge^wa.e3d)}}Object(h.a)(N,"HasAnnotationsAnnotationFilter",null,[1139]);class W{constructor(wa,Ma){this.Ja=wa;this.rp=Ma}isMatch(wa,Ma){if(!Object(I.a)(1119,wa))throw Error.argument("objToTest","Expected list value");switch(this.rp){case 0:for(const hb of wa.items)if(this.Ja.filter.isMatch(hb,Ma))return!0;return!1;case 1:for(const hb of wa.items)if(!this.Ja.filter.isMatch(hb,Ma))return!1;
return!0;default:throw Error.notImplemented();}}}Object(h.a)(W,"ItemTestListFilter",null,[1139]);class K{constructor(wa){this.Ja=wa}isMatch(wa,Ma){if(!Object(I.a)(1119,wa))throw Error.argument("objToTest","Expected list value");return this.Ja.filter.isMatch(wa.items.length,Ma)}}Object(h.a)(K,"LengthMatchesListFilter",null,[1139]);class ca{constructor(wa,Ma){this.Ja=wa;this.rp=Ma}isMatch(wa,Ma,hb=null){let ub=0===this.rp;for(const na of this.Ja.aMf)if((ub=na.isMatch(wa,Ma,hb))?1===this.rp:0===this.rp)return ub;
2===this.rp&&(ub=!ub);return ub}}Object(h.a)(ca,"NonterminalFilter",null,[1139]);class P{constructor(wa,Ma){if(wa){var hb=wa.ga(0);this.aMf=Array(hb);for(let ub=0;ub<hb;++ub)this.aMf[ub]=Ma.b7(wa.ga(1+ub))}}}Object(h.a)(P,"NonterminalFilterInit",null,[]);class ea{constructor(wa,Ma){this.Ja=wa;this.rp=Ma}isMatch(wa,Ma){if("number"!==typeof wa)throw Error.argument("objToTest","Expected number value");let hb=this.Ja.number;if(this.Ja.query){Ma=this.Ja.query.Qo(null,Ma);if("number"!==typeof Ma)throw Error.invalidOperation("Query did not return number");
hb+=Ma}switch(this.rp){case 0:return wa===hb;case 1:return wa<hb;case 2:return wa<=hb;case 3:return wa>hb;case 4:return wa>=hb;default:throw Error.notImplemented();}}}Object(h.a)(ea,"NumberFilter",null,[1139]);class da{constructor(wa,Ma){wa&&(this.number=wa.ga(0),this.query=wa.ga(1)?Ma.eD(wa.ga(1)):null)}}Object(h.a)(da,"NumberFilterInit",null,[]);class ia{constructor(wa,Ma,hb){this.rLc=this.W0i;this.hFa=wa;this.lFg=Ma;this.jFg=hb}jLd(wa){this.lFg=wa}W0i(wa){if(!wa)throw Error.argument("name","Invalid named feature bundle reference");
const Ma=wa.substr(1);return 1===wa.charCodeAt(0)&&Ma===this.hFa?this.lFg:this.jFg?this.jFg.rLc(wa):null}}Object(h.a)(ia,"SimpleNamedFeatureBundleResolver",null,[1166]);class C{constructor(wa){this.Ja=wa}isMatch(wa,Ma){if(!Object(I.a)(1117,wa))throw Error.argument("objToTest","Expected feature bundle");wa=this.Ja.query.Qo(null,new ia(this.Ja.umd,wa,Ma));if("boolean"!==typeof wa)throw Error.invalidOperation("Query did not return bool");return wa}}Object(h.a)(C,"PredicateAnnotationFilter",null,[1139]);
class oa{constructor(wa,Ma){wa&&(this.umd=Ma.pa(wa.ga(0)),this.query=Ma.eD(wa.ga(1)))}}Object(h.a)(oa,"PredicateAnnotationFilterInit",null,[]);class Z{constructor(wa){this.Ja=wa}isMatch(wa,Ma){if("boolean"!==typeof wa)throw Error.argument("objToTest","Expected bool value");Ma=this.Ja.query.Qo(null,Ma);if("boolean"!==typeof Ma)throw Error.invalidOperation("Query did not return bool");return wa===Ma}}Object(h.a)(Z,"QueryBooleanFilter",null,[1139]);class pa{constructor(wa,Ma){this.Ja=wa;this.rp=Ma}isMatch(wa,
Ma){if("number"!==typeof wa)throw Error.argument("objToTest","Expected integer");Ma=this.Ja.query.Qo(null,Ma);if("number"!==typeof Ma)throw Error.invalidOperation("Query did not return an enum value");switch(this.rp){case 0:return wa===Ma;case 1:return 0!==(wa&Ma);case 2:return wa===(wa&Ma);case 3:return Ma===(wa&Ma);default:throw Error.notImplemented();}}}Object(h.a)(pa,"QueryEnumFilter",null,[1139]);class ya{constructor(wa,Ma){wa&&(this.wSc=1===wa.ga(0),this.query=Ma.eD(wa.ga(1)))}}Object(h.a)(ya,
"QueryEnumFilterInit",null,[]);class Ja{constructor(wa,Ma){this.Ja=wa;this.rp=Ma}isMatch(wa,Ma){if(!Object(I.a)(1119,wa))throw Error.argument("objToTest","Expected list value");Ma=this.Ja.query.Qo(null,Ma);if(!Object(I.a)(1119,Ma))throw Error.invalidOperation("Query did not return list value");if(wa.oT!==Ma.oT)return!1;switch(this.rp){case 0:return G.Annotations.oZa(G.Annotations.u4i(wa.oT),wa,Ma);case 1:for(const hb of wa.items)for(const ub of Ma.items)if(G.Annotations.oZa(wa.oT,hb,ub))return!0;
return!1;case 2:for(const hb of wa.items)for(const ub of Ma.items)if(!G.Annotations.oZa(wa.oT,hb,ub))return!1;return!0;case 3:for(const hb of Ma.items)for(const ub of wa.items)if(!G.Annotations.oZa(wa.oT,hb,ub))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(Ja,"QueryListFilter",null,[1139]);class Ka{constructor(wa,Ma){this.Ja=wa;this.rp=Ma}isMatch(wa,Ma){if("string"!==typeof wa)throw Error.argument("objToTest","Expected string");Ma=this.Ja.query.Qo(null,Ma);if("string"!==typeof Ma)throw Error.invalidOperation("Query did not return string");
this.Ja.w7d&&(wa=wa.toUpperCase(),Ma=Ma.toUpperCase());switch(this.rp){case 0:return wa===Ma;case 1:return 0<=wa.indexOf(Ma);case 2:return wa.startsWith(Ma);case 3:return wa.endsWith(Ma);case 4:return 0<=Ma.indexOf(wa);case 5:return Ma.startsWith(wa);case 6:return Ma.endsWith(wa);default:throw Error.notImplemented();}}}Object(h.a)(Ka,"QueryStringFilter",null,[1139]);class ma{constructor(wa,Ma){wa&&(this.query=Ma.eD(wa.ga(0)),this.w7d=1===wa.ga(1))}}Object(h.a)(ma,"QueryStringFilterInit",null,[]);
class ra{constructor(wa){this.Ja=wa}isMatch(wa,Ma){if(!Object(I.a)(1120,wa))throw Error.argument("objToTest","Expected struct value");Ma=this.Ja.query.Qo(null,Ma);if(!Object(I.a)(1120,Ma))throw Error.invalidOperation("Query did not return struct value");return wa.isEqual(wa)}}Object(h.a)(ra,"QueryStructFilter",null,[1139]);class Da{constructor(wa){this.Ja=wa}isMatch(wa,Ma){wa=this.Ja.query.Qo(null,Ma);if("boolean"!==typeof wa)throw Error.invalidOperation("Query did not return bool");return wa}}Object(h.a)(Da,
"QueryWhereConstraintFilter",null,[1139]);class va{constructor(wa){this.Ja=wa}isMatch(wa){if("string"!==typeof wa)throw Error.argument("objToTest","Expected string");return this.Ja.regex.test(wa)}}Object(h.a)(va,"RegexStringFilter",null,[1139]);class Fa{constructor(wa,Ma){wa&&(this.regex=Ma.Kbg(wa.ga(0)))}}Object(h.a)(Fa,"RegexStringFilterInit",null,[]);class ka{constructor(wa,Ma){wa&&(this.filter=Ma.b7(wa.ga(0)))}}Object(h.a)(ka,"SingleFilterFilterInit",null,[]);class qa{constructor(wa,Ma){wa&&(this.query=
Ma.eD(wa.ga(0)))}}Object(h.a)(qa,"SingleQueryFilterInit",null,[]);class Ua{constructor(wa){this.Ja=wa}isMatch(wa){if("boolean"!==typeof wa)throw Error.argument("objToTest","Expected bool value");return wa===this.Ja.value}}Object(h.a)(Ua,"StoredValueBooleanFilter",null,[1139]);class Ya{constructor(wa){wa&&(this.value=1===wa.ga(0))}}Object(h.a)(Ya,"StoredValueBooleanFilterInit",null,[]);class Va{constructor(wa,Ma){this.Ja=wa;this.rp=Ma}isMatch(wa){if("number"!==typeof wa)throw Error.argument("objToTest",
"Expected integer");switch(this.rp){case 0:return this.Ja.wSc?this.Ja.value?!!(wa&this.Ja.value):!wa:wa===this.Ja.value;case 1:return this.Ja.wSc?(wa&this.Ja.value)===this.Ja.value:32>wa&&(1<<wa&this.Ja.value)===this.Ja.value;case 2:return this.Ja.wSc?!!(wa&this.Ja.value):32>wa&&!!(1<<wa&this.Ja.value);default:throw Error.notImplemented();}}}Object(h.a)(Va,"StoredValueEnumFilter",null,[1139]);class ua{constructor(wa){wa&&(this.wSc=1===wa.ga(0),this.value=wa.ga(1))}}Object(h.a)(ua,"StoredValueEnumFilterInit",
null,[]);class Ca{constructor(){this.iqk=null;this.aKd=this.o7a=0}}Object(h.a)(Ca,"WHEREConstraintData",null,[]);class Ea{constructor(wa){this.Ja=wa}isMatch(wa,Ma){if(!Object(I.a)(Ca,wa))throw Error.argument("objToTest","Expected WHERE constraint data");let hb=-1,ub=-1;const na=wa.iqk;switch(this.Ja.cLd){case 4:hb=na.bZb;ub=na.tMe;break;case 5:hb=wa.o7a;ub=na.bZb-wa.o7a;break;case 6:hb=na.bZb+na.tMe;ub=wa.o7a+wa.aKd-hb;break;case 1:case 2:case 3:let Pa=!1;for(let cb=na.Ezl;cb;cb=cb.next)if(this.Ja.nvl===
cb.name){Pa=!0;1===this.Ja.cLd?(hb=cb.bZb,ub=cb.tMe):2===this.Ja.cLd?(hb=wa.o7a,ub=cb.bZb-wa.o7a):(hb=cb.bZb+cb.tMe,ub=wa.o7a+wa.aKd-hb);break}if(!Pa)return!1;break;case 7:hb=wa.o7a;ub=wa.aKd;break;default:throw Error.notImplemented();}return null!==this.Ja.ydl.aAl(na.CBl,hb,ub,hb,!0,2,Ma)}}Object(h.a)(Ea,"SubSreWhereConstraintFilter",null,[1139]);class wb{constructor(wa,Ma){if(wa){var hb=Ma.pa(wa.ga(0));this.cLd=hb.charCodeAt(0);this.nvl=hb.substr(1);this.ydl=Ma.$9i(wa.ga(1))}}}Object(h.a)(wb,"SubSreWhereConstraintFilterInit",
null,[]);class Oa{constructor(wa){this.Ja=wa}isMatch(wa,Ma,hb=null){if(!Object(I.a)(1117,wa))throw Error.argument("objToTest","Expected feature bundle");if(null==hb)throw Error.argumentNull("parentTextForSpan");if(this.Ja.LDf&&!this.Ja.LDf.isMatch(wa,Ma))return!1;if(this.Ja.ROe){let ub;if(({value:ub}=wa.wm(this.Ja.Rcl)).returnValue){if(!this.Ja.ROe.isMatch(ub,Ma))return!1}else{let na,Pa;if(!({value:na}=wa.wm(this.Ja.Lqh)).returnValue||!({value:Pa}=wa.wm(this.Ja.Kqh)).returnValue||0>na||0>Pa||na+Pa>
hb.length||!this.Ja.ROe.isMatch(hb.substr(na,Pa),Ma))return!1}}if(this.Ja.nrh){let ub;if(!({value:ub}=wa.wm(this.Ja.Lqh)).returnValue||!this.Ja.nrh.isMatch(ub,Ma))return!1}if(this.Ja.Oyg){let ub;if(!({value:ub}=wa.wm(this.Ja.Kqh)).returnValue||!this.Ja.Oyg.isMatch(ub,Ma))return!1}return!0}}Object(h.a)(Oa,"TextSpanFilter",null,[1139]);class ab{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,this.Lqh=wa.ga(0),this.Kqh=wa.ga(1),this.Rcl=wa.ga(2),this.ROe=wa.ga(3)?Ma.b7(wa.ga(3)):null,this.LDf=
wa.ga(4)?Ma.b7(wa.ga(4)):null,this.nrh=wa.ga(5)?Ma.b7(wa.ga(5)):null,this.Oyg=wa.ga(6)?Ma.b7(wa.ga(6)):null)}}Object(h.a)(ab,"TextSpanFilterInit",null,[]);class fb{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,this.Baa=wa.ga(0),this.yTe=wa.ga(1)?Ma.b7(wa.ga(1)):null)}}Object(h.a)(fb,"ValueFilterAnnotationFilterInit",null,[]);var db=d(278);class gc{b7(wa,Ma){const hb=wa.ga(0),ub=new db.a;ub.pPa(wa,1,wa.count-1);switch(hb){case 1:return new ca(new P(ub,Ma),0);case 2:return new ca(new P(ub,
Ma),1);case 3:return new ca(new P(ub,Ma),2);case 101:return new va(new Fa(ub,Ma));case 103:return new Ka(new ma(ub,Ma),0);case 104:return new Ka(new ma(ub,Ma),1);case 105:return new Ka(new ma(ub,Ma),2);case 106:return new Ka(new ma(ub,Ma),3);case 107:return new Ka(new ma(ub,Ma),4);case 108:return new Ka(new ma(ub,Ma),5);case 109:return new Ka(new ma(ub,Ma),6);case 201:return new Ua(new Ya(ub));case 202:return new Z(new qa(ub,Ma));case 301:return new ea(new da(ub,Ma),0);case 302:return new ea(new da(ub,
Ma),1);case 303:return new ea(new da(ub,Ma),2);case 304:return new ea(new da(ub,Ma),3);case 305:return new ea(new da(ub,Ma),4);case 401:return new Va(new ua(ub),0);case 402:return new Va(new ua(ub),1);case 403:return new Va(new ua(ub),2);case 404:return new pa(new ya(ub,Ma),0);case 405:return new pa(new ya(ub,Ma),1);case 406:return new pa(new ya(ub,Ma),2);case 407:return new pa(new ya(ub,Ma),3);case 501:return new Y(new M(ub,Ma));case 502:return new ra(new qa(ub,Ma));case 601:return new W(new ka(ub,
Ma),0);case 602:return new W(new ka(ub,Ma),1);case 603:return new K(new ka(ub,Ma));case 604:return new Ja(new qa(ub,Ma),0);case 605:return new Ja(new qa(ub,Ma),1);case 606:return new Ja(new qa(ub,Ma),2);case 607:return new Ja(new qa(ub,Ma),3);case 701:return new N(!1);case 702:return new N(!0);case 703:return new D(new fb(ub,Ma),!1);case 704:return new D(new fb(ub,Ma),!0);case 705:return new Q(new fb(ub,Ma),!1);case 706:return new Q(new fb(ub,Ma),!0);case 707:return new C(new oa(ub,Ma));case 901:return new Oa(new ab(ub,
Ma));case 1002:return new Da(new qa(ub,Ma));case 1001:return new Ea(new wb(ub,Ma));default:throw Error.argument("initData");}}}Object(h.a)(gc,"FilterFactory",null,[1116]);var ob=d(136);class Sb{constructor(wa){this.Ja=wa}get ux(){return this.Ja.ux}get zT(){return this.Ja.zT}get Bid(){return this.Ja.Bid}get kRc(){return this.Ja.kRc}load(wa,Ma){return this.Qo(wa,wa?new ia("root",wa,Ma):Ma)}store(wa,Ma,hb){this.jHb(wa,Ma,wa?new ia("root",wa,hb):hb,null)}Qo(wa,Ma){if(!this.kRc&&!this.Ja.annotations.tub(this.ux,
wa))throw Error.argument("input","Input value not of expected type");let hb=this.Ja.$2f;for(;hb;)wa=hb.load(wa,Ma),hb=hb.next;return wa}jHb(wa,Ma,hb,ub){if(!this.Bid)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.kRc&&!this.Ja.annotations.tub(this.ux,wa))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ja.annotations.tub(this.zT,Ma))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ja.$2f.store(wa,Ma,hb,ub)}static NNf(wa,
Ma,hb,ub){if(hb===ub)return Ma;if(G.Annotations.gB(hb)&&G.Annotations.gB(ub)){hb=G.Annotations.TBa(hb);ub=G.Annotations.TBa(ub);const na=new ob.a(wa,ub);for(const Pa of Ma.items)Array.add(na.items,Sb.NNf(wa,Pa,hb,ub));return na}if(hb===G.Annotations.gna){if(ub===G.Annotations.k$)return Ma;if(ub===G.Annotations.LX)return Ma.toString()}else if(hb===G.Annotations.k$){if(ub===G.Annotations.gna)return Math.floor(Ma);if(ub===G.Annotations.LX)return Ma.toString()}else if(hb===G.Annotations.LX){if(ub===G.Annotations.gna)return parseInt(Ma);
if(ub===G.Annotations.k$)return parseFloat(Ma)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(h.a)(Sb,"AnnotationQuery",null,[1143]);class Jb{constructor(){this.zT=this.ux=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}XBa(wa){if(this.next)return{returnValue:this.next,Xma:wa};if(wa){const Ma=wa.HPf;wa=wa.x5g;return{returnValue:Ma,Xma:wa}}return{returnValue:null,Xma:wa}}}Object(h.a)(Jb,"AnnotationQueryStep",null,[1178]);class Ab extends Jb{constructor(wa){super();
this.Ja=wa}load(wa,Ma){Ma=this.Ja.query.Qo(wa,Ma);if(G.Annotations.gB(this.ux)){var hb=G.Annotations.TBa(this.ux);let na=new ob.a(this.Ja.annotations,hb);if(G.Annotations.gB(this.Ja.query.zT)){if(wa.items.length!==Ma.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let Pa=0,cb=wa.items.length;Pa<cb;++Pa)Array.add(na.items,this.UBc(wa.items[Pa],Ma.items[Pa],hb===G.Annotations.k$))}else for(var ub of wa.items)Array.add(na.items,this.UBc(ub,Ma,hb===
G.Annotations.k$));return na}if(G.Annotations.gB(this.Ja.query.zT)){ub=new ob.a(this.Ja.annotations,this.ux);for(hb of Ma.items)Array.add(ub.items,this.UBc(wa,hb,this.ux===G.Annotations.k$));return ub}return this.UBc(wa,Ma,this.ux===G.Annotations.k$)}UBc(wa,Ma,hb){wa=this.cob(wa,Ma);return hb?wa:Math.floor(wa)}}Object(h.a)(Ab,"NumericAnnotationQueryStep",Jb,[]);class lc extends Ab{constructor(wa){super(wa)}cob(wa,Ma){return wa+Ma}}Object(h.a)(lc,"AddAnnotationQueryStep",Ab,[]);class Mc extends Jb{constructor(wa){super();
this.Ja=wa}load(wa,Ma){if(this.ux===G.Annotations.Kea&&this.Ja.query.zT===G.Annotations.Kea){let na;if(({result:na}=this.FKf(wa)).returnValue)return na}if(G.Annotations.gB(this.ux)){var hb=new ob.a(this.Ja.annotations,G.Annotations.Kea);Ma=this.Ja.query.Qo(wa,Ma);if(G.Annotations.gB(this.Ja.query.zT)){if(wa.items.length!==Ma.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let na=0,Pa=wa.items.length;na<Pa;++na)Array.add(hb.items,this.rVb(Ma.items[na],
wa.items[na]))}else for(var ub of wa.items)Array.add(hb.items,this.rVb(Ma,ub));return hb}ub=this.Ja.query.Qo(wa,Ma);if(G.Annotations.gB(this.Ja.query.zT)){Ma=new ob.a(this.Ja.annotations,G.Annotations.Kea);for(hb of ub.items)Array.add(Ma.items,this.rVb(hb,wa));return Ma}return this.rVb(ub,wa)}}Object(h.a)(Mc,"BinaryBooleanAnnotationQueryStep",Jb,[]);class Jc extends Mc{constructor(wa){super(wa)}FKf(wa){return{returnValue:!wa,result:!1}}rVb(wa,Ma){return wa&&Ma}}Object(h.a)(Jc,"AndAnnotationQueryStep",
Mc,[]);class rb{constructor(wa){wa&&(this.annotations=wa)}}Object(h.a)(rb,"AnnotationsOnlyQueryStepInit",null,[]);class cc extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){Ma=this.Ja.query.Qo(wa,Ma);wa=wa.clone();G.Annotations.gB(this.Ja.query.zT)?Array.addRange(wa.items,Ma.items):Array.add(wa.items,Ma);return wa}}Object(h.a)(cc,"AppendAnnotationQueryStep",Jb,[]);class jb extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){if(this.ux===G.Annotations.WL)return this.vYb(wa,Ma);const hb=
new ob.a(this.Ja.annotations,G.Annotations.WL);for(const ub of wa.items)Array.add(hb.items,this.vYb(ub,Ma));return hb}vYb(wa,Ma){const hb=new E.a(this.Ja.annotations);hb.nAa(wa);wa=new E.a(this.Ja.annotations);this.Ja.script.O6(null,new ia("Input",hb,new ia("Output",wa,Ma)));return wa}}Object(h.a)(jb,"ApplyAnnotationQueryStep",Jb,[]);class Xb extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){if(this.ux===G.Annotations.WL)return Ma=this.vYb(wa,Ma),Ma.wm(this.Ja.KDf).returnValue||new ob.a(this.Ja.annotations,
G.Annotations.WL),Ma;const hb=new ob.a(this.Ja.annotations,G.Annotations.WL);for(const ub of wa.items)if(wa=this.vYb(ub,Ma),({value:wa}=wa.wm(this.Ja.KDf)).returnValue)for(const na of wa.items)Array.add(hb.items,na);return hb}vYb(wa,Ma){const hb=new E.a(this.Ja.annotations);hb.nAa(wa);wa=new E.a(this.Ja.annotations);this.Ja.script.O6(null,new ia("Input",hb,new ia("Output",wa,Ma)));return wa}}Object(h.a)(Xb,"ApplyExpandAnnotationQueryStep",Jb,[]);class yb{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,
this.script=Ma.J5a(wa.ga(0)),this.KDf=wa.ga(1))}}Object(h.a)(yb,"ApplyExpandQueryStepInit",null,[]);class mb{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,this.script=Ma.J5a(wa.ga(0)))}}Object(h.a)(mb,"ApplyQueryStepInit",null,[]);class Ub extends Jb{constructor(wa){super();this.Ja=wa}load(wa){if(this.ux===G.Annotations.WL)return this.lVc(wa);const Ma=new ob.a(this.Ja.annotations,this.Ja.annotations.getAttributeType(this.Ja.Baa));for(const hb of wa.items)Array.add(Ma.items,this.lVc(hb));
return Ma}store(wa,Ma,hb,ub){if(this.ux===G.Annotations.WL){var na=Ma,Pa=({Xma:ub}=this.XBa(ub)).returnValue;Pa&&(na=Pa.store(G.Annotations.$J(this.lVc(wa)),Ma,hb,ub));wa.Lt(this.Ja.Baa,na)}else{var cb=Ma;if(na=({Xma:ub}=this.XBa(ub)).returnValue){cb=new ob.a(this.Ja.annotations,this.Ja.annotations.getAttributeType(this.Ja.Baa));for(Pa of wa.items)Array.add(cb.items,this.lVc(Pa));cb=na.store(cb,Ma,hb,ub)}Ma=cb;if(Ma.items.length!==wa.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");
for(let R=0,ta=wa.items.length;R<ta;++R)hb=wa.items[R],hb.isReadOnly&&(hb=hb.clone(),wa.items[R]=hb),hb.Lt(this.Ja.Baa,Ma.items[R])}return wa}lVc(wa){({value:wa}=wa.wm(this.Ja.Baa)).returnValue||(wa=this.Ja.annotations.pWi(this.Ja.Baa));return wa}}Object(h.a)(Ub,"AttrAnnotationQueryStep",Jb,[]);class ec{constructor(wa,Ma){wa&&(this.annotations=Ma,this.Baa=wa.ga(0))}}Object(h.a)(ec,"AttrQueryStepInit",null,[]);class nc extends Jb{constructor(wa){super();this.Ja=wa}load(wa){const Ma=new E.a(this.Ja.annotations);
Ma.nAa(wa);return this.Ja.module.execute(Ma)}}Object(h.a)(nc,"CallModuleAnnotationQueryStep",Jb,[]);class Lb{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,this.module=Ma.ZZd(wa.ga(0)))}}Object(h.a)(Lb,"CallModuleQueryStepInit",null,[]);class Zc extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){if(G.Annotations.gB(this.ux)){var hb=this.Ja.query.Qo(wa,Ma);Ma=new ob.a(this.Ja.annotations,G.Annotations.LX);let Pa="string"===typeof hb;for(var ub of wa.items)if(Pa)Array.add(Ma.items,ub+
hb);else for(var na of hb.items)Array.add(Ma.items,ub+na);return Ma}ub=this.Ja.query.Qo(wa,Ma);if("string"===typeof ub)return wa+ub;na=new ob.a(this.Ja.annotations,G.Annotations.LX);for(hb of ub.items)Array.add(na.items,wa+hb);return na}}Object(h.a)(Zc,"ConcatAnnotationQueryStep",Jb,[]);class Pb extends Jb{constructor(wa){super();this.Ja=wa}load(wa){return Sb.NNf(this.Ja.annotations,wa,this.ux,this.zT)}}Object(h.a)(Pb,"ConvertAnnotationQueryStep",Jb,[]);class eb extends Jb{constructor(){super()}load(wa){return wa.items.length}}
Object(h.a)(eb,"CountAnnotationQueryStep",Jb,[]);class $a extends Ab{constructor(wa){super(wa)}cob(wa,Ma){return wa/Ma}}Object(h.a)($a,"DivideAnnotationQueryStep",Ab,[]);class vb extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){Ma=new ia(this.Ja.umd,null,Ma);for(const hb of wa.items)if(Ma.jLd(hb),this.Ja.query.Qo(hb,Ma))return!0;return!1}}Object(h.a)(vb,"ExistsAnnotationQueryStep",Jb,[]);class bc extends Ab{constructor(wa){super(wa)}cob(wa,Ma){return Math.pow(wa,Ma)}}Object(h.a)(bc,"ExpAnnotationQueryStep",
Ab,[]);class Cc{constructor(wa,Ma){wa&&(this.Kqa=Ma.pa(wa.ga(0)))}}Object(h.a)(Cc,"FeatureBundleNameQueryStepInit",null,[]);class Gc extends Jb{constructor(wa){super();this.Ja=wa}load(wa){if(G.Annotations.gB(this.ux)){const Ma=new ob.a(this.Ja.annotations,this.Ja.annotations.z6a(G.Annotations.TBa(this.ux),this.Ja.Mqa));for(const hb of wa.items)Array.add(Ma.items,hb.JPa(this.Ja.Mqa));return Ma}return wa.JPa(this.Ja.Mqa)}store(wa,Ma,hb,ub){if(G.Annotations.gB(this.ux)){var na=Ma,Pa=({Xma:ub}=this.XBa(ub)).returnValue;
if(Pa){na=new ob.a(this.Ja.annotations,this.Ja.annotations.z6a(G.Annotations.TBa(this.ux),this.Ja.Mqa));for(var cb of wa.items)Array.add(na.items,cb.JPa(this.Ja.Mqa));na=Pa.store(na,Ma,hb,ub)}Ma=na;if(Ma.items.length!==wa.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let R=0,ta=wa.items.length;R<ta;++R)hb=wa.items[R],hb.isReadOnly&&(hb=hb.clone(),wa.items[R]=hb),hb.IHe(this.Ja.Mqa,Ma.items[R])}else Pa=Ma,(cb=({Xma:ub}=this.XBa(ub)).returnValue)&&
(Pa=cb.store(G.Annotations.$J(wa.JPa(this.Ja.Mqa)),Ma,hb,ub)),wa.IHe(this.Ja.Mqa,Pa);return wa}}Object(h.a)(Gc,"FieldAnnotationQueryStep",Jb,[]);class sd{constructor(wa,Ma){wa&&(this.annotations=Ma,this.Mqa=wa.ga(0))}}Object(h.a)(sd,"FieldQueryStepInit",null,[]);class Sd extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){for(const hb of wa.items)if(this.Ja.filter.isMatch(hb,Ma))return hb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(wa,Ma,hb,ub){let na=
Ma,Pa=-1;for(let R=0,ta=wa.items.length;R<ta;R++)if(this.Ja.filter.isMatch(wa.items[R],hb)){Pa=R;break}if(0>Pa)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const cb=({Xma:ub}=this.XBa(ub)).returnValue;cb&&(na=cb.store(G.Annotations.$J(wa.items[Pa]),Ma,hb,ub));wa.items[Pa]=na;return wa}}Object(h.a)(Sd,"FirstItemMatchingAnnotationQueryStep",Jb,[]);class ie extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){Ma=new ia(this.Ja.umd,null,Ma);for(const hb of wa.items)if(Ma.jLd(hb),
!this.Ja.query.Qo(hb,Ma))return!1;return!0}}Object(h.a)(ie,"ForAllAnnotationQueryStep",Jb,[]);class De extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){wa=Ma?Ma.rLc(this.Ja.Kqa):null;if(!wa)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ja.Kqa+'"');return wa}store(wa,Ma,hb,ub){wa=hb?hb.rLc(this.Ja.Kqa):null;if(!wa)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ja.Kqa+'"');let na=Ma;const Pa=({Xma:ub}=this.XBa(ub)).returnValue;Pa&&(na=Pa.store(wa,
Ma,hb,ub));wa!==na&&wa.nAa(na);return wa}}Object(h.a)(De,"GetAnnotationQueryStep",Jb,[]);class yd{constructor(wa,Ma){this.aIh=wa;this.bRh=Ma}get HPf(){return this.aIh}get x5g(){return this.bRh}}Object(h.a)(yd,"AnnotationQueryStoreContinuation",null,[1197]);class ib extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){return this.Ja.tjd.Qo(wa,Ma)?this.Ja.vwh.Qo(wa,Ma):this.Ja.DIc?this.Ja.DIc.Qo(wa,Ma):wa}store(wa,Ma,hb,ub){var na=this.Ja.tjd.Qo(wa,hb);this.next&&(ub=new yd(this.next,ub));if(na)return this.Ja.vwh.jHb(wa,
Ma,hb,ub);if(this.Ja.DIc)return this.Ja.DIc.jHb(wa,Ma,hb,ub);na=Ma;let Pa=null;ub&&(Pa=ub.HPf,ub=ub.x5g);Pa&&(na=Pa.store(G.Annotations.$J(wa),Ma,hb,ub));return na}}Object(h.a)(ib,"IfAnnotationQueryStep",Jb,[]);class dc{constructor(wa,Ma){wa&&(this.tjd=Ma.eD(wa.ga(0)),this.vwh=Ma.eD(wa.ga(1)),this.DIc=wa.ga(2)?Ma.eD(wa.ga(2)):null)}}Object(h.a)(dc,"IfQueryStepInit",null,[]);class Bc{constructor(wa,Ma){wa&&(this.ktj=Ma.eD(wa.ga(0)),this.Cxg=Ma.eD(wa.ga(1)))}}Object(h.a)(Bc,"IndexAndItemQueryStepInit",
null,[]);class Ob extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){const hb=this.Ja.ktj.Qo(wa,Ma);Ma=this.Ja.Cxg.Qo(wa,Ma);wa=wa.clone();if(0>hb||hb>wa.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(G.Annotations.gB(this.Ja.Cxg.zT))for(let ub=0;ub<Ma.items.length;++ub)Array.insert(wa.items,hb+ub,Ma.items[ub]);else Array.insert(wa.items,hb,Ma);return wa}}Object(h.a)(Ob,"InsertAtAnnotationQueryStep",Jb,[]);class yc extends Jb{constructor(wa){super();
this.Ja=wa}load(wa,Ma){return!(!Ma||!Ma.rLc(this.Ja.Kqa))}}Object(h.a)(yc,"IsDefinedAnnotationQueryStep",Jb,[]);class fc extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){Ma=this.Xrb(wa,Ma);return wa.items[Ma]}store(wa,Ma,hb,ub){const na=this.Xrb(wa,hb);let Pa=Ma;const cb=({Xma:ub}=this.XBa(ub)).returnValue;cb&&(Pa=cb.store(G.Annotations.$J(wa.items[na]),Ma,hb,ub));wa.items[na]=Pa;return wa}Xrb(wa,Ma){Ma=this.Ja.query.Qo(wa,Ma);if(0>Ma||Ma>=wa.items.length)throw Error.invalidOperation("Index out of range in Item store step");
return Ma}}Object(h.a)(fc,"ItemAnnotationQueryStep",Jb,[]);class Nb extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){const hb=new ob.a(this.Ja.annotations,G.Annotations.TBa(this.ux));for(const ub of wa.items)this.Ja.filter.isMatch(ub,Ma)&&Array.add(hb.items,ub);return hb}}Object(h.a)(Nb,"ItemsMatchingAnnotationQueryStep",Jb,[]);class lb extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){Ma=this.Xrb(wa,Ma);return wa.items[wa.items.length-Ma-1]}store(wa,Ma,hb,ub){const na=this.Xrb(wa,
hb);let Pa=Ma;const cb=({Xma:ub}=this.XBa(ub)).returnValue;cb&&(Pa=cb.store(G.Annotations.$J(wa.items[wa.items.length-na-1]),Ma,hb,ub));wa.items[wa.items.length-na-1]=Pa;return wa}Xrb(wa,Ma){Ma=this.Ja.query?this.Ja.query.Qo(wa,Ma):0;if(0>Ma||Ma>=wa.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Ma}}Object(h.a)(lb,"LastItemAnnotationQueryStep",Jb,[]);class Qc extends Jb{constructor(wa){super();this.Ja=wa}load(wa){if(G.Annotations.gB(this.ux)){const Ma=
new ob.a(this.Ja.annotations,G.Annotations.gna);for(const hb of wa.items)Array.add(Ma.items,hb.length);return Ma}return wa.length}}Object(h.a)(Qc,"LengthAnnotationQueryStep",Jb,[]);class Rc extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){if(G.Annotations.gB(this.ux)){const hb=new ob.a(this.Ja.annotations,G.Annotations.Kea);for(const ub of wa.items)Array.add(hb.items,this.Ja.filter.isMatch(ub,Ma));return hb}return this.Ja.filter.isMatch(wa,Ma)}}Object(h.a)(Rc,"MatchesAnnotationQueryStep",
Jb,[]);class ld extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){return this.Ja.filter.isMatch(wa,Ma)}}Object(h.a)(ld,"MatchesAsListAnnotationQueryStep",Jb,[]);class Dd extends Ab{constructor(wa){super(wa)}cob(wa,Ma){return wa%Ma}}Object(h.a)(Dd,"ModuloAnnotationQueryStep",Ab,[]);class gd extends Ab{constructor(wa){super(wa)}cob(wa,Ma){return wa*Ma}}Object(h.a)(gd,"MultiplyAnnotationQueryStep",Ab,[]);class be extends Jb{constructor(wa){super();this.Ja=wa}load(wa){if(G.Annotations.gB(this.ux)){const Ma=
new ob.a(this.Ja.annotations,G.Annotations.Kea);for(const hb of wa.items)Array.add(Ma.items,!hb);return Ma}return!wa}}Object(h.a)(be,"NotAnnotationQueryStep",Jb,[]);class od extends Mc{constructor(wa){super(wa)}FKf(wa){return{returnValue:wa,result:!0}}rVb(wa,Ma){return wa||Ma}}Object(h.a)(od,"OrAnnotationQueryStep",Mc,[]);class $d extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){const hb=this.Ja.LMe.Qo(wa,Ma);wa=this.Ja.QVb.Qo(wa,Ma);Ma=new ob.a(this.Ja.annotations,G.Annotations.gna);for(let ub=
0;ub<wa;++ub)Array.add(Ma.items,hb+ub);return Ma}}Object(h.a)($d,"RangeAnnotationQueryStep",Jb,[]);class xf{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,this.filter=Ma.b7(wa.ga(0)))}}Object(h.a)(xf,"SingleFilterQueryStepInit",null,[]);class Na{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,this.query=wa.ga(0)?Ma.eD(wa.ga(0)):null)}}Object(h.a)(Na,"SingleOptionalQueryQueryStepInit",null,[]);class xb{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,this.query=Ma.eD(wa.ga(0)))}}
Object(h.a)(xb,"SingleQueryQueryStepInit",null,[]);class sc{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,this.LMe=Ma.eD(wa.ga(0)),this.QVb=wa.ga(1)?Ma.eD(wa.ga(1)):null)}}Object(h.a)(sc,"StartAndCountOrLengthQueryStepInit",null,[]);class cd extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){let hb;({AIa:Ma,length:hb}=this.iNc(wa,Ma));const ub=new ob.a(this.Ja.annotations,wa.oT);for(let na=0;na<hb;++na)Array.add(ub.items,wa.items[Ma+na]);return ub}store(wa,Ma,hb,ub){let na,Pa;({AIa:na,
length:Pa}=this.iNc(wa,hb));var cb=Ma;const R=({Xma:ub}=this.XBa(ub)).returnValue;if(R){cb=new ob.a(this.Ja.annotations,wa.oT);for(let ta=0;ta<Pa;++ta)Array.add(cb.items,wa.items[na+ta]);cb=R.store(cb,Ma,hb,ub)}Ma=cb;for(hb=0;hb<Pa;++hb)Array.removeAt(wa.items,na);for(let ta=0,Ra=Ma.items.length;ta<Ra;++ta)Array.insert(wa.items,na+ta,Ma.items[ta]);return wa}iNc(wa,Ma){let hb;hb=this.Ja.LMe.Qo(wa,Ma);if(0>hb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Ma=this.Ja.QVb?
this.Ja.QVb.Qo(wa,Ma):wa.items.length-hb;if(0>Ma||hb+Ma>wa.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{AIa:hb,length:Ma}}}Object(h.a)(cd,"SublistAnnotationQueryStep",Jb,[]);class Ta extends Jb{constructor(wa){super();this.Ja=wa}load(wa,Ma){if(G.Annotations.gB(this.ux)){const hb=new ob.a(this.Ja.annotations,G.Annotations.LX);for(let ub=0,na=wa.items.length;ub<na;++ub)Array.add(hb.items,this.getSubstring(wa.items[ub],Ma));return hb}return this.getSubstring(wa,
Ma)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}getSubstring(wa,Ma){let hb;({AIa:Ma,length:hb}=this.iNc(wa,Ma));return wa.substr(Ma,hb)}iNc(wa,Ma){let hb;hb=this.Ja.LMe.Qo(wa,Ma);if(0>hb)throw Error.invalidOperation("Invalid start index in Substring() query step");Ma=this.Ja.QVb?this.Ja.QVb.Qo(wa,Ma):wa.length-hb;if(0>Ma||hb+Ma>wa.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{AIa:hb,length:Ma}}}
Object(h.a)(Ta,"SubstringAnnotationQueryStep",Jb,[]);class Hb extends Ab{constructor(wa){super(wa)}cob(wa,Ma){return wa-Ma}}Object(h.a)(Hb,"SubtractAnnotationQueryStep",Ab,[]);class oc extends Jb{constructor(wa){super();this.Ja=wa}load(wa){const Ma=new ob.a(this.Ja.annotations,G.Annotations.LX);for(let hb=0;hb<wa.length;++hb)Array.add(Ma.items,wa.charAt(hb).toString());return Ma}}Object(h.a)(oc,"ToCharListAnnotationQueryStep",Jb,[]);class Oc extends Jb{constructor(wa){super();this.Ja=wa}load(wa){const Ma=
new ob.a(this.Ja.annotations,this.ux);Array.add(Ma.items,wa);return Ma}}Object(h.a)(Oc,"ToListAnnotationQueryStep",Jb,[]);class Yc extends Jb{constructor(wa){super();this.Ja=wa}load(){return this.Ja.value}}Object(h.a)(Yc,"ValueAnnotationQueryStep",Jb,[]);class Qd{constructor(wa,Ma){if(wa){var hb=wa.ga(0),ub=1;this.value=({z2:ub}=Ma.mqa(hb,wa,ub,null,null,null)).returnValue;G.Annotations.j9a(this.value)}}}Object(h.a)(Qd,"ValueQueryStepInit",null,[]);class ce{constructor(wa,Ma){wa&&(this.umd=Ma.pa(wa.ga(0)),
this.query=Ma.eD(wa.ga(1)))}}Object(h.a)(ce,"VarNameAndQueryQueryStepInit",null,[]);class id{constructor(wa,Ma){this.Q1e=null;if(wa){this.annotations=Ma.annotations;var hb=0;this.ux=wa.ga(hb);++hb;this.zT=wa.ga(hb);++hb;this.Bid=1===wa.ga(hb);++hb;this.kRc=1===wa.ga(hb);++hb;var ub=wa.ga(hb);++hb;if(ub){var na=hb,Pa=hb+ub,cb=hb+2*ub;hb+=3*ub;var R=wa.count-hb,ta=null;for(let nb=0;nb<ub;++nb){var Ra=hb+wa.ga(cb+nb);const Cb=(nb===ub-1?R:wa.ga(cb+nb+1))-wa.ga(cb+nb),mc=new db.a;mc.pPa(wa,Ra,Cb);Ra=
id.W5i(wa.ga(Pa+nb),mc,Ma);Ra.ux=wa.ga(na+nb);Ra.zT=nb===ub-1?this.zT:wa.ga(na+nb+1);ta?ta.next=Ra:this.Q1e=Ra;ta=Ra}}}}get $2f(){return this.Q1e}static W5i(wa,Ma,hb){switch(wa){case 1:return new De(new Cc(Ma,hb));case 2:return new yc(new Cc(Ma,hb));case 3:return new Ub(new ec(Ma,hb.annotations));case 4:return new Gc(new sd(Ma,hb.annotations));case 5:return new ib(new dc(Ma,hb));case 6:return new Rc(new xf(Ma,hb));case 43:return new ld(new xf(Ma,hb));case 45:return new jb(new mb(Ma,hb));case 49:return new Xb(new yb(Ma,
hb));case 46:return new Yc(new Qd(Ma,hb.annotations));case 51:return new nc(new Lb(Ma,hb));case 52:return new $d(new sc(Ma,hb));case 53:return new Pb(new rb(hb.annotations));case 13:return new fc(new xb(Ma,hb));case 14:return new lb(new Na(Ma,hb));case 15:return new eb;case 18:return new Sd(new xf(Ma,hb));case 16:return new ie(new ce(Ma,hb));case 17:return new vb(new ce(Ma,hb));case 22:return new Ob(new Bc(Ma,hb));case 24:return new cc(new xb(Ma,hb));case 26:return new cd(new sc(Ma,hb));case 27:return new Nb(new xf(Ma,
hb));case 30:return new Oc(new rb(hb.annotations));case 31:return new Ta(new sc(Ma,hb));case 32:return new Zc(new xb(Ma,hb));case 47:return new Qc(new rb(hb.annotations));case 48:return new oc(new rb(hb.annotations));case 34:return new lc(new xb(Ma,hb));case 35:return new Hb(new xb(Ma,hb));case 36:return new gd(new xb(Ma,hb));case 37:return new $a(new xb(Ma,hb));case 38:return new Dd(new xb(Ma,hb));case 39:return new bc(new xb(Ma,hb));case 40:return new Jc(new xb(Ma,hb));case 41:return new od(new xb(Ma,
hb));case 42:return new be(new rb(hb.annotations));default:throw Error.argument("currStepInitData");}}}Object(h.a)(id,"AnnotationQueryInit",null,[]);class gb{constructor(wa){this.Ja=wa}execute(wa,Ma){this.O6(wa,wa?new ia("root",wa,Ma):Ma)}O6(wa,Ma){for(const hb of this.Ja.commands)Ma=hb.execute(wa,Ma)}}Object(h.a)(gb,"AnnotationScript",null,[1142]);class pc{constructor(wa){this.Ja=wa}execute(wa,Ma){const hb=this.Ja.Twj.Qo(wa,Ma),ub=this.Ja.Qok.Qo(wa,Ma);this.Ja.script.O6(wa,new ia("Input",hb,new ia("Output",
ub,Ma)));return Ma}}Object(h.a)(pc,"ApplyAnnotationScriptCommand",null,[1179]);class zc{constructor(wa,Ma){wa&&(this.Twj=Ma.eD(wa.ga(0)),this.Qok=Ma.eD(wa.ga(1)),this.script=Ma.J5a(wa.ga(2)))}}Object(h.a)(zc,"ApplyScriptCommandInit",null,[]);class Ic{constructor(wa){this.Ja=wa}execute(wa,Ma){const hb=this.Ja.DFe.Qo(wa,Ma);this.Ja.HVc.jHb(wa,hb,Ma,null);return Ma}}Object(h.a)(Ic,"AssignAnnotationScriptCommand",null,[1179]);class Fc{constructor(wa){this.Ja=wa}execute(wa,Ma){const hb=this.Ja.HVc.Qo(wa,
Ma);wa=this.Ja.DFe.Qo(wa,Ma);hb!==wa&&hb.nAa(wa);return Ma}}Object(h.a)(Fc,"CopyAnnotationScriptCommand",null,[1179]);class rd{constructor(wa){this.Ja=wa}execute(wa,Ma){let hb=this.Ja.Cbe.Qo(wa,Ma);if(this.Ja.Cbe.Bid){hb=G.Annotations.$J(hb);var ub=new ia(this.Ja.Kqa,null,Ma);for(let Pa=0,cb=hb.items.length;Pa<cb;++Pa){var na=this.B_f(wa,hb.items[Pa],ub);if(0>this.Ja.pdd)hb.items[Pa]=na;else if(({value:na}=na.wm(this.Ja.pdd)).returnValue)hb.items[Pa]=na;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");
}this.Ja.Cbe.jHb(wa,hb,Ma,null)}else{ub=new ia(this.Ja.Kqa,null,Ma);for(let Pa=0,cb=hb.items.length;Pa<cb;++Pa)this.B_f(wa,hb.items[Pa],ub)}return Ma}B_f(wa,Ma,hb){let ub;0>this.Ja.pdd?ub=G.Annotations.$J(Ma):(ub=new E.a(this.Ja.annotations),ub.Lt(this.Ja.pdd,Ma));hb.jLd(ub);this.Ja.Oai.O6(wa,hb);return ub}}Object(h.a)(rd,"EnumerateAnnotationScriptCommand",null,[1179]);class Yd{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,this.Kqa=Ma.pa(wa.ga(0)),this.Cbe=Ma.eD(wa.ga(1)),this.Oai=Ma.J5a(wa.ga(2)),
this.pdd=wa.ga(3))}}Object(h.a)(Yd,"EnumerateScriptCommandInit",null,[]);class me{constructor(wa){this.Ja=wa}execute(wa,Ma){this.Ja.tjd.Qo(wa,Ma)?this.Ja.yml.O6(wa,Ma):this.Ja.m1f&&this.Ja.m1f.O6(wa,Ma);return Ma}}Object(h.a)(me,"IfAnnotationScriptCommand",null,[1179]);class Db{constructor(wa,Ma){wa&&(this.tjd=Ma.eD(wa.ga(0)),this.yml=Ma.J5a(wa.ga(1)),this.m1f=wa.ga(2)?Ma.J5a(wa.ga(2)):null)}}Object(h.a)(Db,"IfScriptCommandInit",null,[]);class af{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,
this.HVc=Ma.eD(wa.ga(0)),this.DFe=Ma.eD(wa.ga(1)))}}Object(h.a)(af,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class bg{constructor(wa){this.Ja=wa}execute(wa,Ma){const hb=this.Ja.DFe.Qo(this.Ja.HVc.Qo(wa,Ma),Ma);this.Ja.HVc.jHb(wa,hb,Ma,null);return Ma}}Object(h.a)(bg,"ModifyAnnotationScriptCommand",null,[1179]);class Qe{constructor(wa){this.Ja=wa}execute(wa,Ma){const hb=new E.a(this.Ja.annotations);this.Ja.query&&hb.nAa(this.Ja.query.Qo(wa,Ma));return Ma=new ia(this.Ja.Kqa,hb,Ma)}}Object(h.a)(Qe,
"NewAnnotationScriptCommand",null,[1179]);class Af{constructor(wa,Ma){wa&&(this.annotations=Ma.annotations,this.Kqa=Ma.pa(wa.ga(0)),this.query=wa.ga(1)?Ma.eD(wa.ga(1)):null)}}Object(h.a)(Af,"NewScriptCommandInit",null,[]);class tf{constructor(wa){this.Ja=wa}execute(wa,Ma){wa=this.Ja.query.Qo(wa,Ma);if(this.Ja.query.zT===G.Annotations.WL)wa.kcd(this.Ja.Baa);else for(const hb of wa.items)hb.kcd(this.Ja.Baa);return Ma}}Object(h.a)(tf,"RemoveAnnotationScriptCommand",null,[1179]);class uf{constructor(wa,
Ma){wa&&(this.annotations=Ma.annotations,this.query=Ma.eD(wa.ga(0)),this.Baa=wa.ga(1))}}Object(h.a)(uf,"RemoveScriptCommandInit",null,[]);class kg{constructor(wa,Ma){if(wa){var hb=0,ub=wa.ga(hb);++hb;if(ub){var na=hb,Pa=hb+ub;hb+=2*ub;var cb=wa.count-hb;this.commands=Array(ub);for(let R=0;R<ub;++R){const ta=hb+wa.ga(Pa+R),Ra=(R===ub-1?cb:wa.ga(Pa+R+1))-wa.ga(Pa+R),nb=new db.a;nb.pPa(wa,ta,Ra);this.commands[R]=kg.S5i(wa.ga(na+R),nb,Ma)}}}}static S5i(wa,Ma,hb){switch(wa){case 1:return new Ic(new af(Ma,
hb));case 2:return new bg(new af(Ma,hb));case 3:return new tf(new uf(Ma,hb));case 6:return new Qe(new Af(Ma,hb));case 7:return new rd(new Yd(Ma,hb));case 8:return new me(new Db(Ma,hb));case 9:return new Fc(new af(Ma,hb));case 10:return new pc(new zc(Ma,hb));default:throw Error.argument("initData");}}}Object(h.a)(kg,"AnnotationScriptInit",null,[]);var Lg=d(688);class $g{constructor(wa){this.iH=wa;this.iM=0}jX(){const wa=this.iH.Kt(this.iM,4);this.iM+=4;return wa}get mTb(){return this.iH}get offset(){return this.iM}set offset(wa){this.iM=
wa}}Object(h.a)($g,"ByteArrayReader",null,[]);class yf{constructor(){this.RB=null;this.zGg=this.Dy=0}ga(wa){if(0>wa||wa>=this.Dy)throw Error.argumentOutOfRange("index");return this.RB.Kt(this.zGg+4*wa,4)}get count(){return this.Dy}static Kvi(wa,Ma,hb){const ub=new yf;ub.RB=wa;ub.zGg=Ma;ub.Dy=hb;return ub}}Object(h.a)(yf,"ReadOnlyListOverByteArray",null,[1138]);class Kf{constructor(wa,Ma){this.bFg=this.LEg=!1;this.hr=this.zua=this.$ce=this.mFg=null;try{this.hr=Ma.annotations;const hb=Ma.yPa(wa.ga(0)),
ub=new $g(hb);if(-914743053!==ub.jX())throw Error.argument("Input does not represent a flat lexicon");this.LEg=1===ub.jX();this.bFg=1===ub.jX();const na=ub.jX();ub.offset+=na;const Pa=ub.jX();this.$ce=Kf.nqk(ub,Pa,this.hr);const cb=ub.jX();this.mFg=Kf.zqk(ub,cb);const R=ub.jX();this.zua=new Lg.a(ub.mTb,ub.offset);ub.offset+=R}catch(hb){throw Error.argument("initData");}}get trie(){return this.zua}mXi(wa){return"i"===wa&&this.bFg?"\u0130":wa.toUpperCase()}w7d(){return this.LEg}WVi(wa){let Ma;Ma=new ob.a(this.hr,
G.Annotations.WL);if(1!==wa)if(0===wa)wa=new E.a(this.hr),Array.add(Ma.items,wa);else if(wa&1073741824){wa=this.mFg[wa&-1073741825];for(let ub=0;ub<wa.length;++ub){var hb=wa[ub];hb=0===hb?new E.a(this.hr):this.$ce[hb-2];Array.add(Ma.items,hb)}}else Array.add(Ma.items,this.$ce[wa-2]);return{returnValue:!0,zQj:Ma}}static nqk(wa,Ma,hb){if(Ma%4)throw Error.argument("reader");const ub=yf.Kvi(wa.mTb,wa.offset,Ma/4);wa.offset+=Ma;wa=[];for(Ma=0;Ma<ub.count;){const na=({z2:Ma}=hb.mqa(G.Annotations.WL,ub,
Ma,null,null,null)).returnValue;Array.add(wa,na)}return wa}static zqk(wa,Ma){Ma=wa.offset+Ma;const hb=[];for(;wa.offset<Ma;){const ub=wa.jX(),na=Array(ub);for(let Pa=0;Pa<ub;++Pa){const cb=wa.jX();na[Pa]=cb}Array.add(hb,na)}return hb}}Object(h.a)(Kf,"RawFlatLexicon",null,[1141]);var dd=d(677),lg=d(678);class Wh{constructor(wa){if(null==wa)throw Error.argumentNull("base64String");const Ma=wa.length;if(Ma%4)throw Error.argument("base64String's length must be a multiple of 4");this.Dy=.75*Ma;this.ata=
Array(Math.ceil(this.Dy/4));wa.endsWith("==")?this.Dy-=2:wa.endsWith("=")&&--this.Dy;let hb=0;for(let ub=0;ub<Ma;ub+=4){const na=Wh.fed[wa.charCodeAt(ub)-43]<<18|Wh.fed[wa.charCodeAt(ub+1)-43]<<12|Wh.fed[wa.charCodeAt(ub+2)-43]<<6|Wh.fed[wa.charCodeAt(ub+3)-43];let Pa=na>>16&255;this.ata[Math.floor(hb/4)]|=Pa<<hb%4*8;++hb;Pa=na>>8&255;this.ata[Math.floor(hb/4)]|=Pa<<hb%4*8;++hb;Pa=na&255;this.ata[Math.floor(hb/4)]|=Pa<<hb%4*8;++hb}}get length(){return this.Dy}ga(wa){if(0>wa||wa>=this.Dy)throw Error.argumentOutOfRange("i");
return this.k6f(wa)}Kt(wa,Ma){if(0>wa||0>Ma||wa+Ma>this.Dy)throw Error.argument("Bad range");let hb=0;for(let ub=0;ub<Ma;++ub)hb|=this.k6f(wa+ub)<<8*ub;return hb}nFk(wa,Ma){let hb=0,ub=0,na=Math.floor(wa/8);for(wa%=8;ub<Ma;){const Pa=8-wa>Ma-ub?Ma-ub:8-wa,cb=this.ga(na);hb|=(cb>>wa&~(255<<Pa))<<ub;ub+=Pa;++na;wa=0}return hb}k6f(wa){return this.ata[Math.floor(wa/4)]>>wa%4*8&255}}Wh.fed=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,
22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(h.a)(Wh,"ByteArray",null,[]);class Gd{constructor(wa,Ma,hb){this.Qw=wa;this.wZj=Ma;this.P2j=hb;this.bHg=Array(wa.b?wa.b.length:0);this.Dpe=new dd.a(new lg.a(this.yPa(this.Qw.s)));this.oW=Array(wa.t.length);this.PFh=new G.Annotations(this.vPa(0),this)}get annotations(){return this.PFh}get OGi(){return this.Qw.d}y5i(){if(!(""in this.Qw.m))throw Error.argument("name","Unrecognized module");return this.ZZd(this.Qw.m[""])}yPa(wa){if(0>
wa||!this.Qw.b||wa>=this.Qw.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.bHg[wa]||(this.bHg[wa]=new Wh(this.Qw.b[wa]))}pa(wa){if(1>wa||wa>=this.Qw.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.Qw.t[wa])throw Error.argument("blobID","Requested blob is not a string");if(null==this.oW[wa]){const Ma=this.vPa(wa).ga(0);this.oW[wa]=this.Dpe.pa(Ma)}return this.oW[wa]}Kbg(wa){if(1>wa||wa>=this.Qw.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.Qw.t[wa])throw Error.argument("blobID",
"Requested blob is not a Regex");if(!this.oW[wa]){var Ma=this.vPa(wa);const hb=this.pa(Ma.ga(0));Ma=1===Ma.ga(1);this.oW[wa]=new RegExp(hb,Ma?"i":"")}return this.oW[wa]}$9i(wa){if(1>wa||wa>=this.Qw.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.Qw.t[wa])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}ZZd(wa){if(1>wa||wa>=this.Qw.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.Qw.t[wa])throw Error.argument("blobID","Requested blob is not an NL module");
return this.oW[wa]||(this.oW[wa]=this.P2j.N5i(this.vPa(wa),this))}eD(wa){if(1>wa||wa>=this.Qw.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.Qw.t[wa])throw Error.argument("blobID","Requested blob is not an annotation query");return this.oW[wa]||(this.oW[wa]=new Sb(new id(this.vPa(wa),this)))}J5a(wa){if(1>wa||wa>=this.Qw.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.Qw.t[wa])throw Error.argument("blobID","Requested blob is not an annotation script");return this.oW[wa]||
(this.oW[wa]=new gb(new kg(this.vPa(wa),this)))}b7(wa){if(1>wa||wa>=this.Qw.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.Qw.t[wa])throw Error.argument("blobID","Requested blob is not a filter");return this.oW[wa]||(this.oW[wa]=this.wZj.b7(this.vPa(wa),this))}K8i(wa){if(1>wa||wa>=this.Qw.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.Qw.t[wa])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.oW[wa]||(this.oW[wa]=new Kf(this.vPa(wa),
this))}vPa(wa){const Ma=this.Qw.n[wa];wa=(wa<this.Qw.t.length-1?this.Qw.n[wa+1]:this.Qw.n.length)-Ma;if(0>Ma||0>wa||Ma+wa>this.Qw.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Ma+","+wa+")");const hb=new db.a;hb.RJc(this.Qw.n,Ma,wa);return hb}}Object(h.a)(Gd,"ObjectFetcher",null,[1115]);class Se{constructor(wa,Ma,hb){if(!wa)throw Error.argumentNull("prediction");if(!Ma)throw Error.argumentNull("fieldNames");if(!hb)throw Error.argumentNull("values");if(Ma.length!==
hb.length)throw Error.argument("values","fieldNames and values do not have same length");this.SQh=wa;this.n$a=Ma;this.Qbb=hb}get prediction(){return this.SQh}get y1f(){return this.n$a.length}xYd(wa){return 0<=wa&&wa<this.n$a.length?this.n$a[wa]:null}getValue(wa){return 0<=wa&&wa<this.Qbb.length?this.Qbb[wa]:null}}Object(h.a)(Se,"PredictionData",null,[]);class hj{constructor(wa,Ma){if(!wa)throw Error.argumentNull("predictions");if(!Ma)throw Error.argumentNull("tokenAttributes");this.f4j=wa;this.s7j=
Ma}J_d(){return this.f4j}y5f(){return this.s7j}}Object(h.a)(hj,"PredictionDataWithTokenAttributes",null,[]);class cg{constructor(wa,Ma){this.prediction=null;this.score=0;this.prediction=wa;this.score=Ma}}Object(h.a)(cg,"PredictionWithScore",null,[]);class ed{constructor(wa,Ma){if(!wa)throw Error.argumentNull("predictions");if(!Ma)throw Error.argumentNull("attributes");this.TQh=wa;this.mGh=Ma}J_d(){return this.TQh}y5f(){return this.mGh}}Object(h.a)(ed,"PredictionsWithTokenAttributes",null,[]);class Xg{constructor(wa,
Ma,hb){if(!wa)throw Error.argumentNull("attributeName");if(!Ma)throw Error.argumentNull("fieldNames");if(!hb)throw Error.argumentNull("values");if(Ma.length!==hb.length)throw Error.argument("values","fieldNames and values do not have same length");this.lGh=wa;this.n$a=Ma;this.Qbb=hb}get attributeName(){return this.lGh}get y1f(){return this.n$a.length}xYd(wa){return 0<=wa&&wa<this.n$a.length?this.n$a[wa]:null}getValue(wa){return 0<=wa&&wa<this.Qbb.length?this.Qbb[wa]:null}}Object(h.a)(Xg,"TokenAttributes",
null,[]);var Dh=d(13),Qf=d(21);class Yb{constructor(wa,Ma,hb,ub,na){this.Ync=0;this.fUe=null;this.Znc=this.HJb=0;this.Zmd=this.Khb=this.v$=this.IJb=null;this.gUe=0;this.I0a=this.Xx=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.nJ=wa;this.zDh=this.EDh=Ma;this.yDh=this.BDh=hb;this.Unc=this.ADh=ub;this.Vnc=this.CDh=na}Wmd(){this.Znc=0;return this.GJb}GJb(){if(!(this.Znc<this.Unc))return this.Xnc;this.IJb=this.zDh.items[this.Znc+
this.yDh];this.v$=new E.a(this.nJ.Ja.annotations);1!==this.Unc&&this.nJ.Ja.X2b||this.v$.nAa(this.IJb);if(0<=this.nJ.Ja.s5c){({value:this.Khb}=this.v$.wm(this.nJ.Ja.s5c)).returnValue?this.Khb=this.Khb.$J():this.Khb=new ob.a(this.nJ.Ja.annotations,G.Annotations.WL);this.Zmd=this.Vnc.items;this.gUe=this.Zmd.length;for(this.Ync=0;this.Ync<this.gUe;++this.Ync)this.fUe=this.Zmd[this.Ync],Array.add(this.Khb.items,this.fUe);this.v$.Lt(this.nJ.Ja.s5c,this.Khb)}else 0<=this.nJ.Ja.XLe?this.v$.Lt(this.nJ.Ja.XLe,
this.Vnc.items[0]):0<=this.nJ.Ja.xJd?this.v$.Lt(this.nJ.Ja.xJd,!0):this.nJ.Ja.tug?this.Vnc.items[0].zJc((wa,Ma)=>this.v$.Lt(wa,Ma)):(this.v$.nAa(this.Vnc.items[0]),1!==this.Unc&&this.nJ.Ja.X2b||(({value:this.HJb}=this.IJb.wm(this.nJ.Ja.IR)).returnValue&&this.v$.Lt(this.nJ.Ja.IR,this.HJb),({value:this.HJb}=this.IJb.wm(this.nJ.Ja.RU)).returnValue&&this.v$.Lt(this.nJ.Ja.RU,this.HJb),this.IJb.wm(this.nJ.Ja.XMa).returnValue&&this.v$.Lt(this.nJ.Ja.XMa,this.HJb)));this.Xx=this.v$;this._state=2;return this.Ymd}Xnc(){this._state=
3}Xmd(){this.Znc++;return this.GJb}Ymd(){return 1<this.Unc&&this.nJ.Ja.X2b?this.Xnc:this.Xmd}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Yb(this.nJ,this.EDh,this.BDh,this.ADh,this.CDh)).getEnumerator()}[Symbol.iterator](){return Object(Qf.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.I0a=this.Wmd());for(;1===this._state;)this.I0a=this.I0a();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");
}get_current(){return this.Xx}}Object(h.a)(Yb,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[109,142,145]);class li{constructor(wa,Ma,hb){this.f8b=this.AGg=0;this.Gwb=null;this.Npe=this.Lde=this.twb=this.jXc=this.Oee=0;this.gYc=!1;this.hme=wa;this.cqe=Ma;this.B3j=hb}iag(){null===this.Gwb&&({Guh:this.Gwb,Mjg:this.Oee,length:this.jXc,cNi:wa}=this.hme.oeg(this.cqe.items[this.f8b],this.B3j),this.gYc=wa||this.gYc);if(this.twb<
this.jXc){var wa=this.Gwb.charAt(this.Oee+this.twb);++this.twb;return{returnValue:!0,ch:wa}}if(this.f8b===this.cqe.items.length-1)return{returnValue:!1,ch:"\x00"};++this.f8b;this.twb=0;this.Gwb=null;return{returnValue:!0,ch:" "}}NCe(wa,Ma){this.twb===this.jXc&&this.Gwb&&(this.Npe=Ma,this.Lde=this.f8b-this.AGg+1)}qRk(wa){if(0>wa||wa>=this.cqe.items.length)throw Error.argumentOutOfRange("iToken");this.f8b=this.AGg=wa;this.Gwb=null;this.Lde=this.twb=this.jXc=this.Oee=0;this.Npe=-1;this.gYc=!1}K4i(){return{cei:this.Lde,
WOj:this.Npe,OMi:this.gYc}}}Object(h.a)(li,"TriePrefixVisitor",null,[1171]);class re{constructor(wa){this.Ja=wa}execute(wa){if(!({value:hb}=wa.wm(this.Ja.Epa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Ma;({value:Ma}=wa.wm(this.Ja.Oza)).returnValue||(Ma=null);var hb=this.DVi(hb,Ma);wa=G.Annotations.$J(wa);wa.Lt(this.Ja.Epa,hb);return wa}DVi(wa,Ma){let hb=null;const ub=this.Ja.flatLexicon.trie,na=new li(this,wa,Ma);let Pa=null;this.Ja.flatLexicon.w7d()&&
(Pa=Object(Dh.a)(this.Ja.flatLexicon,this.Ja.flatLexicon.mXi,"getCaseInsensitiveForm"));let cb=0,R;var ta;let Ra;for(;cb<wa.items.length;){const nb=wa.items[cb];na.qRk(cb);ub.zCh(na,Pa);({cei:R,WOj:ta,OMi:Ra}=na.K4i());if(0<R){({zQj:ta}=this.Ja.flatLexicon.WVi(ta));for(let Cb of this.hxi(wa,cb,R,ta)){1<R&&this.Ja.X2b&&this.Nxi(wa,Ma,cb,nb,R,Ra,Cb);if(!hb)for(hb=new ob.a(this.Ja.annotations,G.Annotations.WL),ta=0;ta<cb;++ta)Array.add(hb.items,wa.items[ta]);Array.add(hb.items,Cb)}cb+=R}else hb&&Array.add(hb.items,
nb),++cb}return hb||wa}Nxi(wa,Ma,hb,ub,na,Pa,cb){if(Pa)Pa=!0;else if(this.Ja.aug){Pa=!1;var R=-1;for(var ta=0;ta<na;ta++){var Ra=wa.items[hb+ta];let Sc;var nb=void 0;if(!({value:Sc}=Ra.wm(this.Ja.IR)).returnValue||!({value:nb}=Ra.wm(this.Ja.RU)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<ta){if(Sc>R+1){Pa=!0;break}if(0>R||null===Ma||R>=Ma.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");
if(" "!==Ma.charAt(R)){Pa=!0;break}}R=Sc+nb}}else Pa=!1;if(Pa){nb=new Sys.StringBuilder;for(Pa=0;Pa<na;++Pa)({Guh:R,Mjg:ta,length:Ra}=this.oeg(wa.items[hb+Pa],Ma)),0<Pa&&nb.append(" "),nb.append(R.substr(ta,Ra));cb.Lt(this.Ja.XMa,nb.toString())}wa=wa.items[hb+na-1];let Cb,mc;({value:ub}=ub.wm(this.Ja.IR)).returnValue&&({value:Cb}=wa.wm(this.Ja.IR)).returnValue&&({value:mc}=wa.wm(this.Ja.RU)).returnValue?(cb.Lt(this.Ja.IR,ub),cb.Lt(this.Ja.RU,Cb+mc-ub)):(cb.kcd(this.Ja.IR),cb.kcd(this.Ja.RU))}hxi(wa,
Ma,hb,ub){return new Yb(this,wa,Ma,hb,ub)}oeg(wa,Ma){let hb,ub;if(({value:hb}=wa.wm(this.Ja.XMa)).returnValue)ub=!0,Ma=0,wa=hb.length;else{ub=!1;if(null===Ma)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");hb=Ma;if(!({value:Ma}=wa.wm(this.Ja.IR)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation","token");if(!({value:wa}=wa.wm(this.Ja.RU)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");
if(0>Ma||0>wa||Ma+wa>hb.length)throw Error.argument("Token start/length values out of range","token");}return{Guh:hb,Mjg:Ma,length:wa,cNi:ub}}}Object(h.a)(re,"FlatLexiconNLModule",null,[1152]);class lf{constructor(wa,Ma){this.xJd=this.s5c=this.XLe=this.XMa=this.RU=this.IR=this.Oza=this.Epa=0;this.tug=this.aug=this.X2b=!1;this.flatLexicon=null;this.annotations=Ma.annotations;let hb=0;try{this.Epa=wa.ga(hb),++hb,this.Oza=wa.ga(hb),++hb,this.IR=wa.ga(hb),++hb,this.RU=wa.ga(hb),++hb,this.XMa=wa.ga(hb),
++hb,this.XLe=wa.ga(hb),++hb,this.s5c=wa.ga(hb),++hb,this.xJd=wa.ga(hb),++hb,this.X2b=1===wa.ga(hb),++hb,this.aug=1===wa.ga(hb),++hb,this.tug=1===wa.ga(hb),++hb,this.flatLexicon=Ma.K8i(wa.ga(hb))}catch(ub){throw Error.argument("initData");}}}Object(h.a)(lf,"FlatLexiconNLModuleInit",null,[]);class Id{constructor(){this.W1b=0;this.OUd=null;this.Kic=0}}Object(h.a)(Id,"FeatureGenStackRec",null,[]);class We{constructor(wa){this.KPe=Array(wa);this.jIb=Array(wa);this.ZMe=[];this.Xrh=[]}}Object(h.a)(We,"TokenStringLattice",
null,[]);const Wc=(wa,Ma,hb)=>{for(let ub=0;ub<wa.length;ub++)hb=Ma(hb,wa[ub]);return hb},Xc=(wa,Ma)=>{const hb=Array(wa.length);for(let ub=0;ub<wa.length;ub++)hb[ub]=Ma(wa[ub]);return hb},Ld=(wa,Ma)=>{Ma=Array(Math.min(Ma,wa.length));for(let hb=0;hb<Ma.length;hb++)Ma[hb]=wa[hb];return Ma},Xf=(wa,Ma)=>{const hb=[];for(const ub of wa)Ma(ub)&&Array.add(hb,ub);return hb};class Le{constructor(wa,Ma){this.key=wa;this.value=Ma}}Object(h.a)(Le,"KeyValuePair",null,[]);const md=(wa,Ma)=>({returnValue:Ma in
wa,value:wa[Ma]}),oj=wa=>{const Ma=[];for(let hb in wa){const ub=new Le(hb,wa[hb]);Array.add(Ma,ub)}return Ma};class Ie{constructor(wa){this.neg=this.Pdj;this.Ja=wa;this.h0c=this.Xle=this.Yle=0;for(const Ma of this.Ja.FIc)this.Yle=Math.max(this.Yle,Ma.Nye),this.Xle=Math.max(this.Xle,Ma.mye),this.h0c=Math.max(this.h0c,Ma.XGb.length)}get lPi(){return this.Ja.hkd.trie}execute(wa){if(!wa)throw Error.argumentNull("input");let Ma,hb;({tokens:Ma,zPj:hb}=this.Qdj(wa));let ub=null,na=null,Pa={};if(this.Ja.n3b){Ma=
G.Annotations.$J(Ma);for(var cb=0;cb<Ma.items.length;++cb)Ma.items[cb]=G.Annotations.$J(Ma.items[cb])}else({r1f:na,returnValue:ub}=this.Jag(wa,Pa));cb=Array(this.h0c);const R=Array(this.h0c);for(var ta=0;ta<R.length;++ta)R[ta]=new Id;for(ta=-this.Yle;ta<Ma.items.length+this.Xle;++ta){let Ra=null;this.Ja.n3b&&(Ra=Ma.items[ta],Pa={},{r1f:na,returnValue:ub}=this.Jag(Ra,Pa));for(const nb of this.Ja.FIc){if(0>ta&&-ta>nb.Nye||ta>=Ma.items.length&&ta-Ma.items.length+1>nb.mye)continue;let Cb=!0;for(let mc=
0;mc<nb.XGb.length;++mc){const Sc=ta+nb.XGb[mc];cb[mc]=Sc;if(0>Sc?0>this.Ja.Oye:Sc>=Ma.items.length?0>this.Ja.nye:!hb.jIb[Sc]){Cb=!1;break}}Cb&&({PAi:ub,QAi:na}=this.eyj(nb,hb,ub,na,Pa,R,cb))}this.Ja.n3b&&(Ra.Lt(this.Ja.ZCa?this.Ja.unb:this.Ja.snb,ub),this.Ja.ZCa&&Ra.Lt(this.Ja.tnb,na))}wa=G.Annotations.$J(wa);this.Ja.n3b?wa.Lt(this.Ja.Epa,Ma):(wa.Lt(this.Ja.ZCa?this.Ja.unb:this.Ja.snb,ub),this.Ja.ZCa&&wa.Lt(this.Ja.tnb,na));return wa}Qdj(wa){let Ma,hb;if(!wa||!({value:Ma}=wa.wm(this.Ja.Epa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let ub;({value:ub}=wa.wm(this.Ja.Oza)).returnValue||(ub="");hb=new We(Ma.items.length);const na=Xf(this.Ja.OPe,Pa=>!Pa.p2b||Pa.p2b.isMatch(wa,null));for(let Pa=0;Pa<Ma.items.length;++Pa){const cb=Ma.items[Pa];let R=null;hb.KPe[Pa]=hb.ZMe.length;let ta=hb.jIb[Pa]=0;for(const Ra of na)0<Ra.pbc&&hb.jIb[Pa]+ta>=Ra.pbc||Ra.qmc&&!Ra.qmc.isMatch(cb,null)||({rmc:R,UTb:ta}=Ra.apply(this,cb,Pa,hb,ub,R,ta))}return{tokens:Ma,zPj:hb}}eyj(wa,Ma,hb,ub,na,Pa,cb){let R=0;Pa[0].W1b=-1;for(Pa[0].OUd=wa.ifh;;){var ta=
cb[R],Ra=0>ta||ta>=Ma.jIb.length?1:Ma.jIb[ta];let mc=!1;for(;Pa[R].W1b<Ra-1;){++Pa[R].W1b;var nb=void 0,Cb=void 0;0>ta?(nb=this.Ja.Oye,Cb=1):ta>=Ma.KPe.length?(nb=this.Ja.nye,Cb=1):(Cb=Ma.KPe[ta]+Pa[R].W1b,nb=Ma.ZMe[Cb],Cb=Ma.Xrh[Cb]);Pa[R].Kic=Cb*(R?Pa[R-1].Kic:wa.score);if(({value:nb}=md(Pa[R].OUd,nb.toString())).returnValue){R===wa.XGb.length-1?(ta=nb,Pa[R].Kic&&(({value:Ra}=md(na,ta.toString())).returnValue||(Ra=-1),0>Ra&&(hb=G.Annotations.$J(hb),Array.add(hb.items,ta)),this.Ja.ZCa&&(ub=G.Annotations.$J(ub),
0>Ra?Array.add(ub.items,Pa[R].Kic):ub.items[Ra]+=Pa[R].Kic),0>Ra&&(this.Ja.hxg||this.Ja.ZCa)&&(na[ta.toString()]=hb.items.length-1))):(++R,Pa[R].W1b=-1,Pa[R].OUd=nb);mc=!0;break}}if(!mc&&(--R,0>R))break}return{PAi:hb,QAi:ub}}Jag(wa,Ma){let hb;if(({value:hb}=wa.wm(this.Ja.ZCa?this.Ja.unb:this.Ja.snb)).returnValue)for(let ub=0;ub<hb.items.length;++ub)Ma[hb.items[ub].toString()]=ub;else hb=new ob.a(this.Ja.annotations,G.Annotations.gna);if(this.Ja.ZCa){if(({value:Ma}=wa.wm(this.Ja.tnb)).returnValue||
(Ma=new ob.a(this.Ja.annotations,G.Annotations.k$)),Ma.items.length!==hb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ja.annotations.D0(G.Annotations.WL,wa));}else Ma=null;return{returnValue:hb,r1f:Ma}}get wkl(){return this.Ja.hkd}Pdj(wa,Ma){var hb;if(({value:hb}=Ma.wm(this.Ja.XMa)).returnValue)wa=hb;else{if(!({value:hb}=Ma.wm(this.Ja.IR)).returnValue)throw Error.argument("Token is missing Span.StartIndex");
if(!({value:Ma}=Ma.wm(this.Ja.RU)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>hb||0>Ma||hb+Ma>wa.length)throw Error.argument("Token indices are out of range");wa=wa.substr(hb,Ma)}return wa}}Object(h.a)(Ie,"NGramNLModule",null,[1152,1153]);class qh{constructor(wa){this.XGb=null;this.score=this.mye=this.Nye=0;this.ifh=null;if(wa){var Ma=0;try{if(wa.ga(Ma)!==qh.h3a)throw Error.argument("initData","Input does not represent a feature template");++Ma;const hb=wa.ga(Ma);++Ma;this.XGb=
Array(hb);for(let ub=0;ub<hb;++ub)this.XGb[ub]=wa.ga(Ma),++Ma;this.Nye=wa.ga(Ma);++Ma;this.mye=wa.ga(Ma);++Ma;this.score=wa.ga(Ma);++Ma;this.ifh=({Jjg:Ma}=qh.I9g(wa,Ma)).returnValue}catch(hb){throw Error.argument("initData");}}}static I9g(wa,Ma){const hb=wa.ga(Ma);++Ma;const ub={};for(let na=0;na<hb;++na){const Pa=wa.ga(Ma);++Ma;wa.ga(Ma)?ub[Pa.toString()]=({Jjg:Ma}=qh.I9g(wa,Ma)).returnValue:(++Ma,ub[Pa.toString()]=wa.ga(Ma),++Ma)}return{returnValue:ub,Jjg:Ma}}}qh.h3a=240803228;Object(h.a)(qh,"FeatureTemplate",
null,[1175]);var Od=d(535);class ef{constructor(wa,Ma){this.ZCa=this.hxg=this.n3b=!1;this.XMa=this.RU=this.IR=this.Epa=this.Oza=this.tnb=this.unb=this.snb=0;this.hkd=null;this.nye=this.Oye=0;this.FIc=this.OPe=null;if(wa){this.annotations=Ma.annotations;var hb=0;try{this.n3b=1===wa.ga(hb);++hb;this.hxg=1===wa.ga(hb);++hb;this.ZCa=1===wa.ga(hb);++hb;this.snb=wa.ga(hb);++hb;this.unb=wa.ga(hb);++hb;this.tnb=wa.ga(hb);++hb;this.Oza=wa.ga(hb);++hb;this.Epa=wa.ga(hb);++hb;this.IR=wa.ga(hb);++hb;this.RU=
wa.ga(hb);++hb;this.XMa=wa.ga(hb);++hb;this.hkd=this.Vqk(Ma.yPa(wa.ga(hb)));++hb;this.Oye=wa.ga(hb);++hb;this.nye=wa.ga(hb);++hb;const ub=wa.ga(hb);++hb;this.OPe=Array(ub);for(let Pa=0;Pa<ub;++Pa){const cb=wa.ga(hb);++hb;const R=this.hkd.trie,ta=new db.a;ta.pPa(wa,hb,cb);this.OPe[Pa]=this.Zqk(ta,Ma,R);hb+=cb}const na=wa.ga(hb);++hb;this.FIc=Array(na);for(Ma=0;Ma<na;++Ma){const Pa=wa.ga(hb);++hb;const cb=new db.a;cb.pPa(wa,hb,Pa);this.FIc[Ma]=this.Aqk(cb);hb+=Pa}}catch(ub){throw Error.argument("initData");
}}}Vqk(wa){return new dd.a(new lg.a(wa))}Zqk(wa,Ma,hb){return Od.a.create(wa,Ma,hb)}Aqk(wa){return new qh(wa)}}Object(h.a)(ef,"NGramNLModuleInit",null,[]);class dh{constructor(wa){this.Ja=wa}execute(wa){if(!wa)throw Error.argumentNull("input");wa=wa.clone();this.Ja.script.execute(wa,null);return wa}}Object(h.a)(dh,"ScriptNLModule",null,[1152]);class ad{constructor(wa,Ma){wa&&(this.script=Ma.J5a(wa.ga(0)))}}Object(h.a)(ad,"ScriptNLModuleInit",null,[]);const Fg=wa=>{wa=Xc(wa,Ma=>Ma*Ma);return Math.sqrt(Wc(wa,
(Ma,hb)=>Ma+hb,0))},Cd=wa=>Wc(wa,(Ma,hb)=>Ma>hb?Ma:hb,wa[0]);class zg{constructor(wa){this.Ja=wa}execute(wa){if(!wa)throw Error.argumentNull("input");var Ma=[],hb=[];this.oni(wa,Ma,hb);this.g5h(Ma,hb);const ub={};for(let Pa=0;Pa<Ma.length;++Pa){var na=Ma[Pa];const cb=this.Ja.hpg.ga(na);na=this.Ja.ipg.ga(na);for(let R=0;R<na;++R){const ta=this.Ja.zki.ga(this.Ja.jMf.ga(cb+R)),Ra=this.Ja.kMf.ga(cb+R);let nb;({value:nb}=md(ub,ta)).returnValue||(nb=0);ub[ta]=nb+hb[Pa]*Ra}}hb=oj(ub);hb.sort((Pa,cb)=>{var R=
Pa.value,ta=cb.value;(R=-(R>ta?1:R<ta?-1:0))||(R=Pa.key.localeCompare(cb.key));return R});Ma=new ob.a(this.Ja.annotations,G.Annotations.WL);for(const Pa of Ld(hb,this.Ja.X9j))hb=new E.a(this.Ja.annotations),hb.Lt(this.Ja.Q9h,Pa.key),hb.Lt(this.Ja.S9h,Pa.value),Array.add(Ma.items,hb);wa.Lt(this.Ja.R9h,Ma);return wa}oni(wa,Ma,hb){if(({value:wa}=wa.wm(this.Ja.P9h)).returnValue){let ub;if(({value:ub}=wa.wm(this.Ja.unb)).returnValue){let na;if(!({value:na}=wa.wm(this.Ja.tnb)).returnValue||ub.items.length!==
na.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.tDc(ub,na,Ma,hb)}if(({value:ub}=wa.wm(this.Ja.U9h)).returnValue){let na;if(!({value:na}=wa.wm(this.Ja.V9h)).returnValue||ub.items.length!==na.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.tDc(ub,na,Ma,hb)}({value:ub}=wa.wm(this.Ja.snb)).returnValue&&this.tDc(ub,null,Ma,hb);({value:ub}=wa.wm(this.Ja.T9h)).returnValue&&
this.tDc(ub,null,Ma,hb)}}tDc(wa,Ma,hb,ub){for(let Pa=0;Pa<wa.items.length;++Pa){var na=void 0;wa.oT===G.Annotations.LX?({value:na}=md(this.Ja.EXf,wa.items[Pa])).returnValue||(na=-1):(na=wa.items[Pa],na=na>=this.Ja.Dre&&na<=this.Ja.q$j?this.Ja.Pse?this.Ja.Pse.ga(na-this.Ja.Dre)-1:na-this.Ja.Dre:-1);if(0<=na){let cb;cb=Ma?Ma.items[Pa]:1;0<cb&&(Array.add(hb,na),Array.add(ub,cb))}}}g5h(wa,Ma){if(wa.length){switch(this.Ja.eAk){case 0:break;case 1:for(var hb=0;hb<Ma.length;++hb)Ma[hb]=1+Math.log(Ma[hb]);
break;case 2:hb=Cd(Ma);for(let ub=0;ub<Ma.length;++ub)Ma[ub]=.5+Ma[ub]/hb*.5;break;case 3:for(hb=0;hb<Ma.length;++hb)Ma[hb]=1;break;default:throw Error.notImplemented();}if(this.Ja.EQc)for(hb=0;hb<Ma.length;++hb)Ma[hb]*=this.Ja.EQc.ga(wa[hb]);wa=Fg(Ma);for(hb=0;hb<Ma.length;++hb)Ma[hb]/=wa}}}Object(h.a)(zg,"TfIdfRankerNLModule",null,[1152]);class Eh{constructor(wa,Ma=0){if(!wa)throw Error.argumentNull("byteArray");this.zI=Ma;if(604662927!==wa.Kt(this.zI+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");
this.Hk=wa.Kt(this.zI+4,4);this.eCg=wa.Kt(this.zI+8,4);this.yXj=wa}ga(wa){if(0>wa||wa>=this.count)throw Error.argumentOutOfRange("index");return this.yXj.nFk(8*this.zI+96+wa*this.eCg,this.eCg)}get count(){return this.Hk}}Object(h.a)(Eh,"CompactIntArray",null,[1138]);const eh=(wa,Ma)=>{Ma=Array(Ma);for(let Pa=0;Pa<Ma.length;Pa++){var hb=Pa,ub=wa.jX(),na=1===(ub>>31&1)?-1:1;const cb=ub&8388607;ub=ub>>23&255;256===ub+1?na=cb?Number.NaN:1===na?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:ub?(ub-=
127,na=na*Gg(cb,1)*Math.pow(2,ub)):na=na*Gg(cb,0)*Math.pow(2,-126);Ma[hb]=na}return Ma},Gg=(wa,Ma)=>{let hb=0;for(let ub=0;23>ub;ub++)hb+=(wa>>22-ub&1)/Math.pow(2,ub+1);return Ma+hb};class vh{constructor(wa,Ma){this.Pse=null;this.wUg=0;this.ipg=this.hpg=this.EQc=null;this.vUg=0;this.kMf=this.jMf=null;this.annotations=Ma.annotations;let hb=0;this.T9h=wa.ga(hb);++hb;this.snb=wa.ga(hb);++hb;this.U9h=wa.ga(hb);++hb;this.V9h=wa.ga(hb);++hb;this.unb=wa.ga(hb);++hb;this.tnb=wa.ga(hb);++hb;this.P9h=wa.ga(hb);
++hb;this.R9h=wa.ga(hb);++hb;this.Q9h=wa.ga(hb);++hb;this.S9h=wa.ga(hb);++hb;var ub=wa.ga(hb);++hb;var na=Array(ub);for(var Pa=0;Pa<ub;++Pa)na[Pa]=Ma.pa(wa.ga(hb)),++hb;this.zki=db.a.ZOd(na);this.X9j=wa.ga(hb);++hb;this.eAk=wa.ga(hb);++hb;ub=wa.ga(hb);++hb;this.EXf={};for(na=0;na<ub;++na){Pa=Ma.pa(wa.ga(hb));++hb;const cb=wa.ga(hb);++hb;this.EXf[Pa]=cb}this.Dre=wa.ga(hb);++hb;this.q$j=wa.ga(hb);++hb;ub=wa.ga(hb);++hb;0<ub&&(ub=Ma.yPa(wa.ga(hb)),++hb,this.Pse=this.d9c(new $g(ub)));++hb;wa=Ma.yPa(wa.ga(hb));
this.Lqk(wa)}d9c(wa){return new Eh(wa.mTb,wa.offset)}Lqk(wa){try{const Ma=new $g(wa);this.wUg=Ma.jX();1===Ma.jX()?this.EQc=db.a.ZOd(eh(Ma,this.wUg)):this.EQc=null;const hb=Ma.jX();this.hpg=this.d9c(Ma);Ma.offset+=hb;const ub=Ma.jX();this.ipg=this.d9c(Ma);Ma.offset+=ub;this.vUg=Ma.jX();const na=Ma.jX();this.jMf=this.d9c(Ma);Ma.offset+=na;this.kMf=db.a.ZOd(eh(Ma,this.vUg))}catch(Ma){throw Error.argument("byteReader");}}}Object(h.a)(vh,"TfIdfRankerNLModuleInit",null,[]);class ze{constructor(wa,Ma,hb,
ub){this.Xwe=wa;this.M2f=hb;this.tokens=ub;this.E6=Ma;this.rFb=-1;this.Ved=0}}Object(h.a)(ze,"TokenizerData",null,[]);class sg{constructor(wa){this.Ja=wa}execute(wa){if(!wa)throw Error.argumentNull("input");if(!({value:ub}=wa.wm(this.Ja.Oza)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Ma;({value:Ma}=wa.wm(this.Ja.IR)).returnValue||(Ma=0);let hb;({value:hb}=wa.wm(this.Ja.RU)).returnValue||(hb=ub.length-Ma);if(0>Ma||Ma>ub.length)throw Error.argument("input",
"Start index out of range");if(0>hb||hb>ub.length)throw Error.argument("input","Length out of range");if(Ma+hb>ub.length)throw Error.argument("input","Bad start-length range");var ub=new ze(ub,Ma,Ma+hb,new ob.a(this.Ja.annotations,G.Annotations.WL));this.xkl(ub);wa=wa.isReadOnly?wa.clone():wa;wa.Lt(this.Ja.Epa,ub.tokens);return wa}xkl(wa){for(;wa.E6<wa.M2f;){if(this.Ja.m2d){var Ma=this.Ja.m2d.PAg(wa.Xwe,wa.E6,wa.M2f-wa.E6,null);!Ma.succeeded&&Ma.ITg&&(Ma=Ma.ITg);if(Ma.succeeded){this.DYg(wa,Ma.length,
this.Ja.Qfg);wa.E6+=Ma.length;continue}}Ma=wa.Xwe.substr(wa.E6);let hb=-1,ub=-1,na=-1;for(let Pa=0;Pa<this.Ja.Ydd.length;++Pa){const cb=this.Ja.Ydd[Pa].exec(Ma);cb&&0<cb[1].length&&(0>hb||cb[0].length>ub)&&(hb=Pa,ub=cb[0].length,na=cb[1].length)}0<=hb?(this.DYg(wa,na,this.Ja.uFe[hb]),wa.E6+=na):wa.E6+=1}}DYg(wa,Ma,hb){if(this.Ja.Rvg)hb!==sg.Hfi&&(0>wa.rFb&&(wa.rFb=wa.E6),wa.Ved=wa.E6+Ma-wa.rFb,hb===sg.Gfi&&(0<=wa.rFb&&0<wa.Ved&&(Ma=new E.a(this.Ja.annotations),Ma.Lt(this.Ja.IR,wa.rFb),Ma.Lt(this.Ja.RU,
wa.Ved),Ma.Lt(this.Ja.HId,sg.Ifi),Ma.Lt(this.Ja.Oza,wa.Xwe),Array.add(wa.tokens.items,Ma)),wa.rFb=-1,wa.Ved=0));else{let ub=new E.a(this.Ja.annotations);ub.Lt(this.Ja.IR,wa.E6);ub.Lt(this.Ja.RU,Ma);ub.Lt(this.Ja.HId,hb);Array.add(wa.tokens.items,ub)}}}sg.Hfi="GAP";sg.Gfi="EOS_CHUNK";sg.Ifi="SENTENCE";Object(h.a)(sg,"TokenizerNLModule",null,[1152]);class zd{constructor(wa,Ma){this.RU=this.IR=this.HId=this.Epa=this.Oza=0;this.Rvg=!1;this.uFe=this.Ydd=this.Qfg=this.m2d=null;if(wa){this.annotations=Ma.annotations;
var hb=0;try{this.Oza=wa.ga(hb);++hb;this.Epa=wa.ga(hb);++hb;this.HId=wa.ga(hb);++hb;this.IR=wa.ga(hb);++hb;this.RU=wa.ga(hb);++hb;this.Rvg=1===wa.ga(hb);++hb;var ub=wa.ga(hb);++hb;0<ub&&(this.m2d=Ma.ZZd(ub).lPi);this.Qfg=wa.ga(hb)?Ma.pa(wa.ga(hb)):"";++hb;const na=wa.ga(hb);++hb;this.Ydd=Array(na);this.uFe=Array(na);for(ub=0;ub<na;++ub)this.Ydd[ub]=new RegExp(Ma.pa(wa.ga(hb))),++hb,this.uFe[ub]=Ma.pa(wa.ga(hb)),++hb}catch(na){throw Error.argument("initData");}}}}Object(h.a)(zd,"TokenizerNLModuleInit",
null,[]);class Hd{constructor(wa){this.Ja=wa}execute(wa){if(!wa)throw Error.argumentNull("input");let Ma;if(!({value:Ma}=wa.wm(this.Ja.pGf)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const hb of this.Ja.DMe)Ma=hb.apply(Ma);wa=G.Annotations.$J(wa);wa.Lt(this.Ja.qGf,Ma);return wa}static gId(wa,Ma){const hb=new Sys.StringBuilder;for(let ub=0;ub<wa.length;++ub)hb.append(Ma(wa.substr(ub,1)));return hb.toString()}}Object(h.a)(Hd,"TransliteratorNLModule",
null,[1152]);class Fh{constructor(wa){wa&&(this.style=wa.ga(0))}apply(wa){return Hd.gId(wa,Ma=>Fh.sii(Ma,this.style))}static sii(wa,Ma){switch(Ma){case 0:return wa.toLowerCase();case 1:return"I"===wa?"\u0131":wa.toLowerCase();case 2:return wa.toUpperCase();case 3:return"i"===wa?"\u0130":wa.toUpperCase();default:throw Error.invalidOperation();}}}Fh.j3a=0;Object(h.a)(Fh,"ChangeCaseTransliterationStage",null,[1169]);class Gh{apply(wa){return Hd.gId(wa,Gh.nll)}static nll(wa){const Ma=wa.charCodeAt(0);
return 65281<=Ma&&65374>=Ma?String.fromCharCode(Ma-65248):wa}}Gh.j3a=4;Object(h.a)(Gh,"LatinFullWidthToHalfWidthTransliterationStage",null,[1169]);class ih{constructor(wa,Ma){wa&&(this.regex=Ma.Kbg(wa.ga(0)),this.DPk=Ma.pa(wa.ga(1)))}apply(wa){return wa.replace(this.regex,this.DPk)}}ih.j3a=1;Object(h.a)(ih,"RegexReplaceTransliterationStage",null,[1169]);class ah{constructor(wa,Ma){if(wa){var hb=wa.ga(0),ub=Ma.pa(wa.ga(1)),na=new Eh(Ma.yPa(wa.ga(2)));wa=0>wa.ga(3)?null:new Eh(Ma.yPa(wa.ga(3)));this.tNe=
{};for(Ma=0;Ma<hb;++Ma)this.tNe[ub.charAt(Ma).toString()]=ub.substr(na.ga(Ma),wa?wa.ga(Ma):1)}}apply(wa){return Hd.gId(wa,Ma=>Ma in this.tNe?this.tNe[Ma]:Ma)}}ah.j3a=2;Object(h.a)(ah,"SingleCharSubstitutionsTransliterationStage",null,[1169]);class Fi{constructor(wa,Ma){this.qGf=this.pGf=0;this.DMe=null;if(wa){this.annotations=Ma.annotations;var hb=0;try{this.pGf=wa.ga(hb);++hb;this.qGf=wa.ga(hb);++hb;const ub=wa.ga(hb);++hb;this.DMe=Array(ub);for(let na=0;na<ub;++na){const Pa=wa.ga(hb);++hb;const cb=
wa.ga(hb);++hb;const R=new db.a;R.pPa(wa,hb,cb);hb+=cb;this.DMe[na]=this.Uqk(Pa,R,Ma)}}catch(ub){throw Error.argument("initData");}}}Uqk(wa,Ma,hb){switch(wa){case Fh.j3a:return new Fh(Ma);case ih.j3a:return new ih(Ma,hb);case ah.j3a:return new ah(Ma,hb);case Gh.j3a:return new Gh;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(h.a)(Fi,"TransliteratorNLModuleInit",null,[]);class Wi{N5i(wa,Ma){const hb=wa.ga(0),ub=new db.a;ub.pPa(wa,1,wa.count-
1);switch(hb){case 0:return new dh(new ad(ub,Ma));case 2:return new sg(new zd(ub,Ma));case 3:return new Ie(new ef(ub,Ma));case 5:return new re(new lf(ub,Ma));case 9:return new Hd(new Fi(ub,Ma));case 10:return new zg(new vh(ub,Ma));default:throw Error.notImplemented();}}}Object(h.a)(Wi,"NLModuleFactory",null,[1114]);class Mg{constructor(wa){this.Cfi=";";if(!wa)throw Error.argumentNull("resource");this.u3=new Gd(wa,new gc,new Wi);this.hme=this.u3.y5i();this.UBg=this.u3.annotations.JZb("Text.Text");
this.SBg=this.u3.annotations.JZb("Classification.Predictions");this.qde=this.u3.annotations.JZb("Classification.PredictionString");this.TBg=this.u3.annotations.JZb("Classification.Probability");this.hXj=this.u3.annotations.JZb("NLMod.Tokens");if(0>this.UBg||0>this.SBg||0>this.qde||0>this.TBg)throw Error.argument("resourceObj","Resource does not represent a ranker");}IWi(){const wa=[];this.FTd(void 0,this.a6f(wa),null);return wa}KWi(wa,Ma){const hb=[],ub=[];this.FTd(wa,this.a6f(hb),(na,Pa)=>{const cb=
this.u3.annotations.O5f(na),R=[],ta=[];Ma&&Ma.length&&-1===Array.indexOf(Ma,cb)||(na=this.u3.annotations.getAttributeType(na),this.$3g(na,Pa,R,ta),Pa=new Xg(cb,R,ta),Array.add(ub,Pa))});return new ed(hb,ub)}JWi(wa){const Ma=[];this.FTd(wa,hb=>{let ub;if(({value:ub}=hb.wm(this.qde)).returnValue){let na;({value:na}=hb.wm(this.TBg)).returnValue&&Array.add(Ma,new cg(ub,na))}},null);return Ma}FTd(wa,Ma,hb){var ub=new E.a(this.u3.annotations);ub.Lt(this.UBg,wa);wa=this.hme.execute(ub);if(({value:ub}=wa.wm(this.SBg)).returnValue)for(const na of ub.items)Ma(na);
if(hb&&({value:Ma}=wa.wm(this.hXj)).returnValue)for(const na of Ma.items)na.zJc(hb)}$3g(wa,Ma,hb,ub){if(G.Annotations.gB(wa))for(var na of Ma.items)this.$3g(Ma.oT,na,hb,ub);else if(G.Annotations.Yxh(wa)){na=this.u3.annotations.vag(wa);for(let Pa=0;Pa<na;Pa++)Array.add(hb,this.u3.annotations.qdg(wa,Pa)),Array.add(ub,this.u3.annotations.D0(this.u3.annotations.z6a(wa,Pa),Ma.JPa(Pa)))}else Array.add(hb,"VALUE"),Array.add(ub,this.u3.annotations.D0(wa,Ma))}a6f(wa){return Ma=>{let hb;({value:hb}=Ma.wm(this.qde)).returnValue&&
Array.add(wa,this.$7i(hb))}}$7i(wa){const Ma=wa.indexOf(this.Cfi);return 0>Ma?wa:wa.substring(0,Ma)}}Object(h.a)(Mg,"Ranker",null,[]);var ee=d(322),Lf=d(370),Vf=d(158),fd=d(119),Ee=d(103),Yf=d(25);class ij{constructor(wa,Ma){this.Cbf="";this.Qzd=null;this.Rzd=!1;this.z$=null;this.oGh=["TellMe.TellMeParamCollection"];this.ub=wa;this.Cya=Ma;this.ub.Q2a&&(this.z$=null)}get Dad(){if(!this.Qzd&&!this.Rzd){let wa=null;try{wa=window.TellMeModel}catch(Ma){if(fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("QueryRanker",
"TellMeModel not found. Exception: "+Ma)}if(wa){try{this.Qzd=new Mg(wa)}catch(Ma){if(fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Ma)}this.Rzd=!0}else if(fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("QueryRanker","Classifier model not found")}return this.Qzd}lG(){return"Command"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:2}oD(wa,Ma,hb=!1,ub=e.a.tellMe,na=null){const Pa=new y.a(wa);if((!na||
Array.contains(na,0))&&!Ee.a.eN(wa)){if(!this.Dad&&this.Rzd){if(fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.ub.Q2a&&this.z$&&this.z$.initialize();if(ee.CommandResultsUtility.F7d(wa.Hf)&&(na=ee.CommandResultsUtility.d7f(wa.Hf),0<na.results.length)){na.displayName="Classifier Debug";Pa.ns(na);Ma.resultsUpdated(Pa);return}na=wa?this.Cbf=wa.Hf:
this.Cbf;if(Yf.AFrameworkApplication.fa.ka("TellMeParameterizedQueriesEnabled")){na=this.b8i(na);var cb=this.MKc(na.J_d());na=na.y5f()}else na=this.a8i(na),cb=this.sYi(na),na=[];ee.CommandResultsUtility.sVc(cb,!1,"Classifier","TFIDF");cb=ee.CommandResultsUtility.MMc(wa,cb,this.ub,this.z$,this.Cya,na,0,1);0<cb.results.length&&ub!==e.a.contextMenu&&(cb.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);hb||cb.results.length||this.ub.NCa||this.ub.Ewa||(wa=new Vf.a("lookupNoResults",14,wa.Hf,null,
1),cb.Bv(wa));0<cb.results.length&&Pa.ns(cb);Pa.attributes=na}Ma.resultsUpdated(Pa)}J_d(){let wa=[];try{wa=this.Dad.IWi()}catch(Ma){if(fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("GetPredictions","Exception: "+Ma)}return wa}a8i(wa){let Ma=[];try{Ma=this.Dad.JWi(wa)}catch(hb){if(fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("GetPredictionsWithScore","Exception: "+hb)}return Ma}b8i(wa){try{return this.Dad.KWi(wa,this.oGh)}catch(Ma){if(fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("GetPredictionsWithTokenAttributes",
"Exception: "+Ma)}return new ed([],[])}MKc(wa){const Ma=[];if(wa)for(const hb of wa)Ma.push(new Lf.a(hb,-99999));return Ma}sYi(wa){const Ma=[];if(wa)for(const hb of wa)Ma.push(new Lf.a(hb.prediction,hb.score));return Ma}}Object(h.a)(ij,"CommandResultsProvider",null,[982]);var Md=d(947);class pj{constructor(wa){this.ub=wa}lG(){return"Feedback"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:2}oD(wa,Ma,hb,ub,na=null){wa=new y.a(wa);if(!na||Array.contains(na,21))na=[],na.push(appChrome.actions.setControlLabel("TellMeFeedback",
CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(na),na=new x.a(22),na.displayName="",na.Bv(new Vf.a("TellMeFeedback",23,null,null,1)),wa.ns(na);Ma.resultsUpdated(wa)}}Object(h.a)(pj,"FeedbackResultsProvider",null,[982]);class qj{constructor(wa,Ma,hb,ub){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=wa;this.CommandId=Ma;this.CommandValueId=hb;this.InputText=ub}}Object(h.a)(qj,"FindInDocumentProp",null,[]);var jj=d(442),Ag=d(45);class mf{constructor(wa){this.Vwd=
2;this.F0a=[];this.sLa=[];this.ub=wa;mf.Iha=wa.$1f;mf.e2f="FindInDocumentSuggestion";mf.l3g="FindInDocumentSuggestion3";this.PNh=Object.assign(new jj.a,{landingTab:"Indoc",data:null});this.kTh=this.ub.AGb||!!Yf.AFrameworkApplication.Ba&&Yf.AFrameworkApplication.Ba.jb.AGb}lG(){return"FindInDocument"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:3===this.ub.Yq?this.ub.Qph?2:3:2}oD(wa,Ma,hb=!1,ub,na=null){const Pa=new y.a(wa);if(na&&!Array.contains(na,2))Ma.resultsUpdated(Pa);else if(Array.clear(this.F0a),
Ee.a.eN(wa)){if(hb&&this.Mnh()){hb=new x.a(2);hb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;na=1;ub="";if(0<this.sLa.length&&!this.ub.BGb)for(var cb of this.sLa)if(""!==cb.Label.toLowerCase()){if(na>=this.Vwd)break;this.GAh(hb,cb.Label,cb.CommandValueId,mf.e2f+na,cb.InputText);na++}cb="";this.ub.hJ?(Pa.ns(hb),hb=new x.a(3),cb=this.ub.UMa?Ee.a.wPa(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):cb=CommonUIStrings.l_TellMeOpenFindPaneText;
ub=this.c7f("");this.GAh(hb,cb,ub,mf.l3g,"");Pa.ns(hb)}Ma.resultsUpdated(Pa)}else cb="",hb&&(hb=this.c7f(wa.Hf),ub=[],this.ub.VRa?(this.ub.CKe&&ub.push(appChrome.actions.setControlIconSet(mf.Iha,{"default":"FindInDocument_20"})),cb=this.ub.Q$d?Ee.a.QYd(wa.Hf,CommonUIStrings.l_FindInDocumentScopedButtonText):wa.Hf+CommonUIStrings.l_FindInDocumentScopedButtonText):this.ub.hJ?(cb=this.ub.UMa?Ee.a.wPa(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,wa.Hf)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,
wa.Hf),ub.push(appChrome.actions.setControlIconSet(mf.Iha,{"default":"FindInDocument_20"}))):cb=this.ub.BGb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,wa.Hf),this.ub.lia?(fd.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(mf.Iha,cb)),fd.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(mf.Iha,hb))):(ub.push(appChrome.actions.setControlLabel(mf.Iha,cb)),ub.push(appChrome.actions.setButtonCommandValueId(mf.Iha,
hb)),appChrome.api.dispatch(ub)),this.Yjh(cb,mf.Iha,hb,wa.Hf)),this.ub.Qph?(cb=new Vf.a(mf.Iha,8,wa.Hf),hb=new x.a(2),hb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,hb.Bv(cb),Pa.ns(hb),Ma.resultsUpdated(Pa)):this.ub.f1i().then(R=>{const ta=new Vf.a(mf.Iha,8,wa.Hf,null,1);ta.count=R;R=new x.a(2);R.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;R.Bv(ta);Pa.ns(R);Ma.resultsUpdated(Pa)},R=>{fd.TellMeActor.instance.Ld.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+
R);R=new Vf.a(mf.Iha,8,wa.Hf,null,1);const ta=new x.a(2);ta.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ta.Bv(R);Pa.ns(ta);Ma.resultsUpdated(Pa)})}Mnh(){return!!this.ub&&this.ub.Ugd}GAh(wa,Ma,hb,ub,na=null){const Pa=[];Ma&&Pa.push(appChrome.actions.setControlLabel(ub,Ma));this.ub.hJ&&Pa.push(appChrome.actions.setControlIconSet(ub,{"default":"FindInDocument_20"}));Pa.push(appChrome.actions.setButtonCommandValueId(ub,hb));appChrome.api.dispatch(Pa);this.Yjh(Ma,ub,hb,"");wa.Bv(new Vf.a(ub,
8,na,null,1,-99999))}c7f(wa){return this.kTh?Ee.a.UNa(wa,15,this.PNh):Ag.a.le(wa)}Yjh(wa,Ma,hb,ub){this.Mnh()&&this.F0a.length<this.Vwd&&(wa=new qj(wa,Ma,hb,ub),Array.add(this.F0a,wa))}L0k(wa){for(let Ma=0;Ma<this.F0a.length;Ma++)if(this.F0a[Ma].CommandId===wa){const hb=this.F0a[Ma].Label;let ub=!1;if(0<this.sLa.length){let na=0;for(const Pa of this.sLa){if(Pa.Label===hb){Array.removeAt(this.sLa,na);ub=!0;break}na++}}!ub&&this.sLa.length>=this.Vwd-1&&Array.removeAt(this.sLa,1);Array.insert(this.sLa,
0,this.F0a[Ma])}}}mf.Iha=null;mf.e2f=null;mf.l3g=null;Object(h.a)(mf,"FindInDocumentResultsProvider",null,[982]);var Ia=d(945);class tb{constructor(wa){this.ub=wa}lG(){return"Insights"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:2}oD(wa,Ma,hb=!1,ub,na=null){ub=new y.a(wa);if(!na||Array.contains(na,13))if(this.$7k()||!Ee.a.eN(wa)){na=new x.a(13);var Pa=""===wa.Hf.trim(),cb=Pa?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",R=new Vf.a(cb,10,wa.Hf,null,1);hb&&(hb=null,Ee.a.Yia()?Pa?Pa=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:
(Pa=this.ub.BGb?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,wa.Hf),hb=Ee.a.UNa(wa.Hf,1)):(Pa=String.format(CommonUIStrings.l_InsightsButtonText,wa.Hf),hb=Ee.a.cPd(wa.Hf)),this.ub.lia?(fd.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(cb,Pa)),hb&&fd.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",hb))):(wa=[],wa.push(appChrome.actions.setControlLabel(cb,
Pa)),hb&&wa.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",hb)),appChrome.api.dispatch(wa)),R.label=Pa);na.Bv(R);ub.ns(na)}Ma.resultsUpdated(ub)}$7k(){return Ee.a.Yia()&&this.ub.iil}}Object(h.a)(tb,"InsightsResultsProvider",null,[982]);var Qb=d(943);class qc{constructor(wa){this.ub=wa}lG(){return"Learning"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:2}oD(wa,Ma,hb,ub,na=null){hb=new y.a(wa);na&&!Array.contains(na,21)||!Ee.a.eN(wa)||(na=[],ub=this.ub.nQj,na.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",
ub)),ub=qc.G1i(ub),na.push(appChrome.actions.setControlLabel("LearningForSearch",ub)),appChrome.api.dispatch(na),wa=new Vf.a("LearningForSearch",22,wa.Hf,null,1),na=new x.a(21),na.Bv(wa),hb.ns(na));Ma.resultsUpdated(hb)}static G1i(wa){const Ma=[];Array.add(Ma,new Qb.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Ma,new Qb.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Ma,new Qb.a(600,wa));Array.add(Ma,new Qb.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));
wa={};wa.parts=Ma;return JSON.stringify(wa)}}Object(h.a)(qc,"LearningProvider",null,[982]);var Lc=d(1024);class Jd{constructor(wa,Ma){this.ikb=this.gmb=this.MLa=this.Xtc=null;this.zv=!1;this.ykb=wa;this.xIh=Ma;wa&&this.r0f(wa)}Jkd(){this.ykb.Jkd()&&this.r0f(this.ykb)}vcj(wa){let Ma=[];var hb=[];wa=Jd.Lck(wa);var ub="";Array.clear(hb);for(let na=0;na<wa.length;na++){const Pa=wa.charAt(na);-1!==" ".indexOf(Pa)?(ub.length&&Array.add(hb,ub),ub=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(Pa)?
(ub.length&&Array.add(hb,ub),ub=Pa,Array.add(hb,ub),ub=""):ub+=Pa}ub.length&&Array.add(hb,ub);for(wa=0;wa<hb.length;wa++)ub=this.rYi(hb[wa]),ub=this.Jsi(ub),Ma=Jd.O$j(Ma,ub);return Ma=this.v_h(Ma)}n9d(){this.zv||this.Jkd();return this.zv}IFc(wa){return this.Xtc[wa.toString()]}v_h(wa){for(let Ma=0;Ma<wa.length;Ma++){const hb=this.MLa[Ma];if(wa[Ma].commandId!==this.IFc(hb[0]))throw Error.create("Incorrect Tcid orders with Priors data");let ub;(ub=wa[Ma]).score=ub.score+hb[1]}return wa}Jsi(wa){const Ma=
[];for(var hb=0;hb<this.MLa.length;hb++)Ma.push(new Lf.a(this.IFc(this.MLa[hb][0]),-5));hb=new Lc.a;for(var ub=0;ub<wa.length;ub++)hb.add(this.IFc(wa[ub][0]));for(ub=0;ub<Ma.length;ub++){const Pa=Ma[ub];for(let cb=0;cb<wa.length;cb++){var na=wa[cb];const R=this.IFc(na[0]);na=na[1];if(R===Pa.commandId){Pa.score=na;hb.remove(R);break}}if(!hb.count)break}return Ma}rYi(wa){const Ma=1>wa.length;for(let cb=0;2>=cb;cb++){const R=this.ikb;for(let ta in R){var hb=R[ta],ub=wa,na=ta;const Ra=na.length+1,nb=
Array((ub.length+1)*Ra);for(var Pa=0;Pa<=ub.length;Pa++)nb[Pa*Ra]=Pa;for(Pa=0;Pa<=na.length;Pa++)nb[Pa]=Pa;for(Pa=0;Pa<na.length;Pa++)for(let Cb=0;Cb<ub.length;Cb++)nb[(Cb+1)*Ra+(Pa+1)]=ub.charAt(Cb)===na.charAt(Pa)?nb[Cb*Ra+Pa]:Math.min(Math.min(nb[Cb*Ra+(Pa+1)]+1,nb[(Cb+1)*Ra+Pa]+1),nb[Cb*Ra+Pa]+1);ub=nb[ub.length*Ra+na.length];if((!ub||!Ma)&&ub<=cb)return hb}}return this.gmb}r0f(wa){this.Xtc=wa.YZd();this.MLa=wa.m8i();this.gmb=wa.rej();this.ikb=wa.z3i();if(this.zv=!!this.Xtc&&!!this.MLa&&!!this.ikb&&
!!this.gmb)this.zv=0<this.MLa.length&&Jd.j7d(this.MLa);this.zv&&(this.zv=0<this.gmb.length&&Jd.j7d(this.gmb));this.zv&&(this.ikb=Jd.Tej(this.ikb));this.zv||(this.ikb=this.gmb=this.MLa=this.Xtc=null)}Xdj(wa){wa=this.vcj(wa);return this.ZOi(wa,this.xIh)}ZOi(wa,Ma){let hb=[];for(let ub=0;ub<wa.length;ub++)wa[ub].score>=Ma&&hb.push(wa[ub]);hb.sort((ub,na)=>ub.score<na.score?1:ub.score>na.score?-1:0);0<hb.length-10&&(hb=hb.slice(0,10));return hb}static O$j(wa,Ma){if(!wa.length)return Ma;if(wa.length!==
Ma.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let hb=0;hb<wa.length;hb++){if(wa[hb].commandId!==Ma[hb].commandId)throw Error.create("Incorrect CommandId");let ub;(ub=wa[hb]).score=ub.score+Ma[hb].score}return wa}static Lck(wa){return Ag.a.vg(wa)}static j7d(wa){for(let Ma=0;Ma<wa.length;Ma++)if(2!==wa[Ma].length)return!1;return!0}static Tej(wa){const Ma={};for(let na in wa){var hb=na,ub=wa[na];const Pa=ub;Pa.length&&Jd.j7d(Pa)&&(Ma[hb]=
ub)}return Ma}}Object(h.a)(Jd,"NaiveBayesClassifierModel",null,[]);class le{constructor(wa,Ma){this.z$=null;this.ub=wa;this.HOb=new Jd(Ma,wa.eag);this.ub.Q2a&&(this.z$=null)}lG(){return"NBCommand"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:2}oD(wa,Ma,hb=!1,ub=e.a.tellMe,na=null){const Pa=new y.a(wa);if((!na||Array.contains(na,0))&&!Ee.a.eN(wa)){if(ee.CommandResultsUtility.F7d(wa.Hf)&&(na=ee.CommandResultsUtility.d7f(wa.Hf),0<na.results.length)){na.displayName="Classifier Debug";Pa.ns(na);Ma.resultsUpdated(Pa);
return}if(!this.HOb.n9d()){if(fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.ub.Q2a&&this.z$&&this.z$.initialize();na=this.HOb.Xdj(wa.Hf);ee.CommandResultsUtility.sVc(na,!1,"Classifier","NaiveBayesian");na=ee.CommandResultsUtility.MMc(wa,na,this.ub,this.z$,null,null,0,1);0<na.results.length&&ub!==e.a.contextMenu&&(na.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);
hb||na.results.length||this.ub.NCa||this.ub.Ewa||(wa=new Vf.a("lookupNoResults",14,wa.Hf,null,1),na.Bv(wa));0<na.results.length&&Pa.ns(na)}Ma.resultsUpdated(Pa)}}Object(h.a)(le,"NaiveBayesCommandProvider",null,[982]);class je{constructor(){this.D0a=null;this.zv=!1;this.Jkd()}Jkd(){this.zv||(this.D0a=window.NBCRM)&&4===this.D0a.length&&(this.zv=!0);return this.zv}m8i(){return this.zv?this.D0a[1]:null}rej(){return this.zv?this.D0a[2]:null}z3i(){return this.zv?this.D0a[3][0]:null}YZd(){return this.zv?
this.D0a[0][0]:null}}Object(h.a)(je,"NaiveBayesModelAdapter",null,[1006]);var Gf=d(247);class Wf{constructor(wa){this.ub=wa}lG(){return"OfficeScript"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:2}oD(wa,Ma){const hb=new y.a(wa);if(!Ee.a.eN(wa)){wa=Gf.d(wa.Hf);var ub=new x.a(25);ub.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;ub=this.cBf(wa,Wf.kpl,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,ub);ub=this.cBf(wa,Wf.cTi,"OfficeScriptsFreezeSelection",
"samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,ub);hb.ns(ub)}Ma.resultsUpdated(hb)}cBf(wa,Ma,hb,ub,na,Pa){const cb=[];for(const R of Ma)if(Gf.a(wa,R)){this.ub.lia?(fd.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(hb,na)),fd.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(hb,ub))):(cb.push(appChrome.actions.setControlLabel(hb,na)),cb.push(appChrome.actions.setButtonCommandValueId(hb,ub)),appChrome.api.dispatch(cb));Pa.Bv(new Vf.a(hb,26,null,
null,1));break}return Pa}}Wf.kpl="unhide row rows col cols column columns".split(" ");Wf.cTi=["freeze","selection","pane","panes"];Object(h.a)(Wf,"OfficeScriptsSamplesProvider",null,[982]);var fh=d(17),zh=d(15),Qg=d(441),Rg=d(299),wi=d(440),Ng=d(33),Fj=d(114),Hh=d(124);class gg{constructor(wa){this.tH=null;this.eR=-1;this.ore=14;this.pre=12;this.attributes=this.aEd=this.query=null;this.Mub=!1;this.ilb=[];this.Di=Yf.AFrameworkApplication.Be;Yf.AFrameworkApplication.fa&&(this.ore=Yf.AFrameworkApplication.fa.Gc("TellMeMaxTermedResults",
this.ore),this.pre=Yf.AFrameworkApplication.fa.Gc("TellMeMaxZeroTermResults",this.pre));this.YK=wa}get vk(){return this.ilb}get jld(){return this.aEd}ns(wa){let Ma=!1;for(let hb=0;hb<this.vk.length;hb++)if(27!==this.vk[hb].groupType&&this.vk[hb].groupType===wa.groupType){this.NFd(this.vk[hb],wa);Ma=!0;break}Ma||this.vk.push(wa)}NFd(wa,Ma){for(let hb=0;hb<Ma.results.length;hb++)wa.Bv(Ma.results[hb])}jbh(wa){const Ma=[];for(const hb of this.vk)hb.groupType!==wa&&Ma.push(hb);this.vk.length!==Ma.length&&
(this.ilb=Ma)}CLk(wa){let Ma=null,hb=null,ub=null;for(let na=0;na<wa.length;na++){const Pa=wa[na];if(Pa&&Pa.vk&&Pa.vk.length)for(const cb of Pa.vk)if(17===cb.groupType||18===cb.groupType)Ma=cb;else if(0===cb.groupType||16===cb.groupType)hb=cb,ub=Pa}Ma&&hb&&0<hb.results.length&&(17===Ma.groupType&&({CFd:hb,WFd:Ma}=ee.CommandResultsUtility.sZh(hb,Ma,this.YK.hG()?this.YK.hG().IXi:-.6)),ub.jbh(hb.groupType))}Acl(){new fh.a;this.Lkc(this.YK.LMg)}C4b(wa,Ma){return this.query.Hf.length>this.YK.hG().E8i&&
this.gJj(wa,Ma)||this.query.Hf.length>this.YK.hG().F8i&&this.LLj(wa,Ma)?!0:!1}LLj(wa,Ma){return wa&&wa.length&&Ma&&Ma.length?-1===Ma.toLowerCase().indexOf(wa.toLowerCase())?!1:!0:!1}gJj(wa,Ma){return wa&&wa.length&&Ma&&Ma.length?Ma.toLowerCase().startsWith(wa.toLowerCase()):!1}kPi(wa){const Ma=[];for(const hb of this.YK.hG().hJ?this.jld:this.vk)wa.contains(hb.groupType)||Ma.push(hb);this.YK.hG().hJ?this.aEd=Ma:this.ilb=Ma}itl(wa,Ma){const hb=[];for(const ub of this.vk){const na=ub;if(13!==na.groupType){const Pa=
wa[Rg.a[na.groupType].toLowerCase()];let cb="False";Pa<Ma&&(cb="True");na.displayName=na.displayName+" ("+cb+": "+Pa+")"}hb.push(na)}this.ilb=hb}Lkc(wa,Ma=!1,hb=null){if(this.YK.hG().hJ){if(!Ma)for(this.aEd=Array(this.vk.length),Ma=0;Ma<this.vk.length;Ma++)this.jld[Ma]=this.vk[Ma];this.YK.$Ng.Lkc(this.vk,this.jld,this.query,wa,hb)}else{for(hb=new fh.a;this.vk.length;){Ma=this.vk.pop();const ub=Rg.a[Ma.groupType].toLowerCase(),na=wa[ub];if(Hh.b(na))throw Error.create("GroupId "+ub+" missed from group SortingOrder");
hb.add(new zh.a(na,Ma))}hb.Sc((ub,na)=>ub.key<na.key?-1:1);for(wa=0;wa<hb.count;wa++)Ma=hb.ga(wa).value,this.vk.push(Ma)}}Bcl(){var wa=!1;let Ma=!1,hb=!1;for(let na=0;na<this.vk.length;na++){var ub=this.vk[na];const Pa=ub.groupType;if(8===Pa||15===Pa||14===Pa){ub=ub.results;for(let cb=0;cb<ub.length;cb++){if(8===Pa&&this.C4b(this.query.Hf,ub[cb].label)){wa=!0;break}if(15===Pa&&this.C4b(this.query.Hf,ub[cb].label)){Ma=!0;break}if(14===Pa){if(this.C4b(this.query.Hf,ub[cb].label)||this.C4b(this.query.Hf,
ub[cb].description)){hb=!0;break}const R=ub[cb].label.split(" ");for(const ta of R)if(this.C4b(this.query.Hf,ta)){hb=!0;break}}}}}wa=this.YK.Y9i(wa,Ma,hb);this.Lkc(wa)}Rcb(wa,Ma,hb,ub,na,Pa){if(na===this.tH){var cb=wa.data.je;na=null;try{na=Ng.b(cb)}catch(Ad){fd.TellMeActor.instance.Ld.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Ad);return}if("RankerResults"in na&&na.RankerResults){this.Yga();var R=na.RankerResults,ta=new fh.a,Ra=new fh.a;cb=0;for(var nb of R){R=
nb.ProviderId;var Cb=nb.Score;cb+=Cb;ta.add(new zh.a(R,Cb))}ta.Sc((ve,Ae)=>ve.value>Ae.value?-1:1);Cb=Pa?Pa.X$i:1E-6;nb={};R={};let Ad=0;for(var mc=0;mc<ta.count;mc++){let ve=parseInt(ta.ga(mc).key),Ae=ta.ga(mc).value/cb;1===ve&&(R.answer=Ad++,R.entity=Ad++,R.definition=Ad++,R.wolframanswer=Ad++,Ae<Cb&&(Ra.add(9),Ra.add(11),Ra.add(10),Ra.add(12)),nb.answer=Ae,nb.entity=Ae,nb.definition=Ae,nb.wolframanswer=Ae);2===ve&&(R.assistance=Ad++,Ae<Cb&&Ra.add(8),nb.assistance=Ae);3===ve&&(R.classifier=Ad++,
R.serviceclassifier=Ad++,Ae<Cb&&(Ra.add(0),Ra.add(17)),nb.classifier=Ae,nb.serviceclassifier=Ae);4===ve&&(R.people=Ad++,Ae<Cb&&Ra.add(14),nb.people=Ae);5===ve&&(R.document=Ad++,Ae<Cb&&Ra.add(15),nb.document=Ae);6===ve&&(R.findindocument=Ad++,Ae<Cb&&Ra.add(2),nb.findindocument=Ae);7===ve&&(R.notes=Ad++,Ae<Cb&&Ra.add(20),nb.notes=Ae);8===ve&&(R.image=Ad++,Ae<Cb&&Ra.add(19),nb.image=Ae)}ta=new fh.a;ta.add("classifier");ta.add("serviceclassifier");ta.add("appsforoffice");ta.add("addin");ta.add("findindocument");
ta.add("assistance");ta.add("document");ta.add("people");ta.add("answer");ta.add("wolframanswer");ta.add("definition");ta.add("entity");ta.add("image");ta.add("template");ta.add("officescript");for(mc=0;mc<ta.count;mc++)ta.ga(mc)in R||(R[ta.ga(mc)]=Ad++);R.learning=Ad++;R.insights=Ad++;R.feedback=Ad++;Pa&&Pa.IGj&&this.itl(nb,Cb);Pa&&Pa.JGj&&this.kPi(Ra);Ra={};for(var Sc in nb)Ra[Sc]=nb[Sc]*cb;this.Lkc(R,!0,Ra)}if(Pa.vTc&&"Intents"in na&&na.Intents){Sc=na.Intents;for(var jd of Sc)if(this.mae(jd)&&
"Serplet"===jd.GroupType&&jd.ConfidenceScore>jd.ConfidenceThreshold){Sc=!1;na=0;if(Pa.w$d){cb=new Vf.a("",28);for(Ra=0;Ra<this.vk.length;Ra++)if((ta=this.vk[Ra].results)&&0<ta.length){na=Ra;cb=ta[0];break}2===cb.groupType&&(Sc=!0)}cb=new x.a(13);Sc&&Pa.w$d&&(cb=new x.a(13,CommonUIStrings.l_TellMeWebTitle));Ra=new Vf.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Hf,null,0);ta=[];nb=null;nb=Ee.a.Yia()?Ee.a.UNa(this.query.Hf,1):Ee.a.cPd(this.query.Hf);ta.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",
nb));nb=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Hf);ta.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",nb));appChrome.api.dispatch(ta);cb.Bv(Ra);Ra=[];if(Sc&&Pa.w$d)for(Ra.push(this.vk[na]),Ra.push(cb),Sc=na+1;Sc<this.vk.length;Sc++)(na=this.vk[Sc].results)&&0<na.length&&Ra.push(this.vk[Sc]);else for(Ra.push(cb),Sc=0;Sc<this.vk.length;Sc++)(na=this.vk[Sc].results)&&0<na.length&&Ra.push(this.vk[Sc]);this.ilb=Ra}}if(Pa.L4b&&!Pa.hJ){jd=Sc=
-1;for(na=0;na<this.vk.length;na++)switch(this.vk[na].groupType){case 23:Sc=na;break;case 0:case 17:case 2:-1===jd&&(jd=na)}if(-1!==Sc){jd=-1===jd?0:Sc>jd?jd+1:jd;Sc=this.vk[Sc];na=Array(this.vk.length);cb=0;for(Ra=0;Ra<na.length;Ra++)Ra===jd?na[Ra]=Sc:(23===this.vk[cb].groupType&&cb++,na[Ra]=this.vk[cb],cb++);this.ilb=na}}ub.resultsUpdated(this);ub=fd.TellMeActor.instance.Ld;ub.g4(Ma.length,"RankerInference",wa.data.tf.toString(),Math.round(window.performance.now()-hb),wi.a.nuh,!0,Qg.a.Jra);this.Mub&&
ub&&(wa=this.query.pWa,Ma=ub.cqc,Pa.MTc&&wa>Ma&&!Pa.hJ&&(ub.oce(this.query.Hf),ub.BHe(wa)))}}mae(wa){if("GroupType"in wa&&wa.GroupType&&"ConfidenceScore"in wa&&"ConfidenceThreshold"in wa)return!0;fd.TellMeActor.instance.Ld.onError("IsValidIntentGroup","Invalid intents found");return!1}Gcb(wa,Ma,hb,ub,na){ub===this.tH&&(this.Yga(),fd.TellMeActor.instance.Ld.g4(Ma.length,"RankerInference",wa.data.tf.toString(),Math.round(window.performance.now()-hb),wi.a.nuh,!1,Qg.a.Jra));na.resultsUpdated(this)}Yga(){-1!==
this.eR&&(window.clearTimeout(this.eR),this.eR=-1)}Ccl(wa){let Ma;Ma=this.YK.hG().hJ?fd.TellMeActor.instance.Ld.V0d(this.jld,this.query.Hf):fd.TellMeActor.instance.Ld.V0d(this.vk,this.query.Hf);var hb=this.YK.hG().W$i;""!==hb&&(hb="_"+hb);let ub="";this.YK.hG().m9d&&(ub="RankerInference"+hb+",");this.YK.hG().vTc&&(ub+="SerpletClassifier");","===ub.charAt(ub.length-1)&&(ub=ub.substring(0,ub.length-1));hb=fd.TellMeActor.instance.Ld.Qdg(ub);const na=this.tH=Fj.a.create().toString();hb["Client-Request-Id"]=
na;const Pa=window.performance.now(),cb=this.YK.hG()?this.YK.hG().Y$i:600;this.Yga();this.eR=window.setTimeout(()=>{if(na===this.tH){this.tH="";this.eR=-1;wa.resultsUpdated(this);const R={};R[m.a.provider]="Ranker";R[m.a.Gdb]=this.query.pWa;fd.TellMeActor.instance.Ld.MI(r.a.timedOut,cb,R)}},cb);this.Di.Jj(fd.TellMeActor.instance.Ld.Rdg(),2,Ma,hb,!1,0,R=>{this.Rcb(R,this.query.Hf,Pa,wa,na,this.YK.hG())},R=>{this.Gcb(R,this.query.Hf,Pa,na,wa)},null,null,!1,4E3,6E3)}nml(){var wa=0,Ma=new fh.a,hb=this.YK.JMg,
ub=this.YK.KMg;for(var na=0;na<this.vk.length;na++){var Pa=this.vk[na],cb=Rg.a[Pa.groupType].toLowerCase(),R=hb[cb];wa+=Pa.results.length;Pa.results.length>R&&(cb=ub[cb],Hh.b(cb)||Ma.add(new zh.a(cb,Pa)))}ub=!this.query||""===this.query.Hf.trim();na=wa-(ub?this.pre:this.ore);if(!(0>=na)){ub=window.performance.now();wa=wa.toString()+" total,"+na.toString()+" to remove.";if(0<Ma.count)for(Ma.Sc((ta,Ra)=>ta.key>Ra.key?-1:1),Pa=0;Pa<Ma.count&&0<na;Pa++){cb=Ma.ga(Pa).value;R=Rg.a[cb.groupType].toLowerCase();
let ta=cb.results.length-hb[R];ta>na&&(ta=na);0<ta&&(cb.eDe(ta),wa+=R+": "+ta.toString()+" results removed.",na-=ta)}if(0<na){wa+=na.toString()+" results left after trimming.";Ma=new fh.a;hb=this.YK.OMg;for(Pa=0;Pa<this.vk.length;Pa++)cb=this.vk[Pa],R=hb[Rg.a[cb.groupType].toLowerCase()],Hh.b(R)||Ma.add(new zh.a(R,cb));Ma.Sc((ta,Ra)=>ta.key<Ra.key?-1:1);for(hb=0;0<na;)Pa=Ma.ga(hb++).value,na>=Pa.results.length?(Array.remove(this.vk,Pa),wa+=Rg.a[Pa.groupType]+": "+Pa.results.length.toString()+" results force removed.",
na-=Pa.results.length):(Pa.eDe(na),wa+=Rg.a[Pa.groupType]+": "+na.toString()+" results force removed.",na=0)}fd.TellMeActor.instance.Ld&&(Ma={},Ma[m.a.message]=wa,fd.TellMeActor.instance.Ld.MI("ShowOptimal",window.performance.now()-ub,Ma))}}}Object(h.a)(gg,"CombineResultsUpdatedEventArgs",null,[948]);var Og=d(675);class vg{constructor(wa,Ma,hb,ub=!1,na=""){this.Zyd=this.vAd=!1;this.BC=wa;this.j1a=[];this.bqf=Ma.length;this.ub=fd.TellMeActor.instance.hG();this.Xsc=ub;this.Z1a=na;this.Plb={};for(wa=
0;wa<Ma.length;++wa)this.Plb[wa.toString()]=hb?0:Ma[wa].zP()}b2k(wa,Ma){Ma&&Ma.query&&Ma.query.pWa<fd.TellMeActor.instance.eaa||(this.j1a[wa]=Ma,this.Zyd?this.vAd=!0:(!this.ub||3!==this.ub.Yq||3!==this.Plb[wa.toString()]||this.OVf())&&this.KQc())}Trk(){this.Zyd=!0}upl(){this.Zyd=!1;this.vAd&&(this.vAd=!1,this.KQc())}OVf(){if(this.j1a.length<this.bqf)return!1;for(let wa=0;wa<this.bqf;++wa)if(!this.j1a[wa])return!1;return!0}KQc(){var wa=this.OVf();const Ma=window.performance.now(),hb=new gg(fd.TellMeActor.instance.q3e);
hb.CLk(this.j1a);for(var ub=0;ub<this.j1a.length;++ub){var na=this.j1a[ub];if(na&&na.vk&&na.vk.length&&(hb.query=na.query,na.attributes&&0<na.attributes.length&&(hb.attributes=na.attributes),na&&na.vk&&(wa||this.$ji(ub,this.j1a))))for(const Pa of na.vk)hb.ns(Pa)}hb.vk&&hb.vk.length&&(hb.Mub=wa,this.ub&&this.ub.uQe&&hb.nml(),Og.a.hwg()&&(this.ub&&this.ub.iKj&&hb.query.Hf&&0<hb.query.Hf.length?hb.Bcl():hb.Acl()),Og.a.hwg()&&this.ub&&(this.ub.m9d||this.ub.vTc)&&this.Xsc&&hb.query.Hf&&0<hb.query.Hf.length&&
hb.Mub&&this.Z1a!==e.a.contextMenu?(3===this.ub.Yq&&wa||this.BC.resultsUpdated(hb),hb.Ccl(this.BC)):this.BC.resultsUpdated(hb),wa=fd.TellMeActor.instance.Ld,hb.Mub&&wa&&(ub=hb.query.pWa,na=wa.cqc,hb.query.Hf&&0<hb.query.Hf.length&&this.Xsc&&this.ub.MTc&&this.Z1a!==e.a.contextMenu&&ub>na&&!this.ub.m9d&&!this.ub.hJ&&(wa.oce(hb.query.Hf),wa.BHe(ub)),wa.MI(r.a.ySk,window.performance.now()-Ma)))}$ji(wa,Ma){if(!(this.Plb&&wa.toString()in this.Plb)||Ma.length<=wa||!Ma[wa])return!1;if(!Ma[wa].vk.length)return!0;
const hb=this.Plb[wa.toString()];if(0===hb)return!0;const ub=this.Plb;for(let Pa in ub){var na=ub[Pa];const cb=Number.parseInvariant(Pa);if(cb!==wa&&na===hb&&!(Ma.length>cb&&Ma[cb]))return!1}return!0}}Object(h.a)(vg,"ResultsAggregator",null,[]);var Sg=d(974);class wh{constructor(){this.$Hb=this.aIb=this.ZHb=this.logCount=this.logRank=this.invertedRank=0}XYh(wa,Ma){switch(wa){case 1:this.invertedRank=Ma;break;case 3:this.logRank=Ma;break;case 2:this.logCount=Ma;break;case 5:this.ZHb=Ma;break;case 4:this.aIb=
Ma;break;case 6:this.$Hb=Ma}}}Object(h.a)(wh,"CommandFeatures",null,[]);class ci{constructor(wa){this.r1e=0;this.ePh=wa;this.CHh={}}get modelId(){return this.ePh}get featureIntercept(){return this.r1e}get $Ub(){return this.CHh}cYh(wa,Ma,hb){0===Ma?this.r1e=hb:(this.$Ub[wa]||(this.$Ub[wa]=new wh),this.$Ub[wa].XYh(Ma,hb))}}Object(h.a)(ci,"CoefficientsModel",null,[]);const Rh=(wa,Ma)=>Math.pow(10,-Ma/(60*Math.LN10/Math.LN2*wa));class se{constructor(wa,Ma){this.Hk=1;this.Xqc=new wh;this.features.logCount=
1+Math.log(this.count)/Math.LN2;this.features.invertedRank=wa?1/wa:0;this.features.logRank=2/Math.pow(2,wa);this.features.ZHb=Rh(10,Ma);this.features.aIb=Rh(2,Ma);this.features.$Hb=Rh(1,Ma)}get count(){return this.Hk}get features(){return this.Xqc}btj(){this.Hk=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}btl(wa){const Ma=2/Math.pow(2,wa);this.features.invertedRank=Math.max(this.features.invertedRank,wa?1/wa:0);this.features.logRank=Math.max(this.features.logRank,Ma)}nul(wa){const Ma=
Rh(10,wa),hb=Rh(2,wa);wa=Rh(1,wa);this.features.ZHb=Math.max(this.features.ZHb,Ma);this.features.aIb=Math.max(this.features.aIb,hb);this.features.$Hb=Math.max(this.features.$Hb,wa)}}Object(h.a)(se,"CommandModel",null,[]);class bf{constructor(wa){this.KKb=null;if(!wa&&fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("PredictionEngine","IModelAdapter can't be null");this.ykb=wa;this.Wtc=this.Hbe()}Hbe(){const wa=this.ykb.t5i(),Ma=this.ykb.YZd();if(void 0===wa||null===wa||void 0===Ma||null===
Ma)return!1;try{window.performance.now();this.KKb={};for(let hb=0;hb<wa.length;hb++){const ub=wa[hb],na=Ma[ub[0].toString()].trim(),Pa=ub[1],cb=0!==Pa?Ma[ub[2].toString()].trim():"",R=ub[3];na in this.KKb||(this.KKb[na]=new ci(na));this.KKb[na].cYh(cb,Pa,R)}}catch(hb){if(fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("LoadModelData","Error Loading Suggestions Model: "+hb);return!1}return!0}yUi(){const wa=this.ykb.Z2i(),Ma={};if(!wa)return Ma;let hb=1;for(let ub=0;ub<wa.length;ub++){const na=
wa[ub];na.Id in Ma?(Ma[na.Id].btj(),Ma[na.Id].btl(hb),Ma[na.Id].nul(na.TimeElapsedSinceClick)):Ma[na.Id]=new se(hb,na.TimeElapsedSinceClick);hb++}return Ma}n9d(){this.Wtc||(this.Wtc=this.Hbe());return this.Wtc}Y7i(){let wa=[];if(!this.Wtc){if(fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("GetPredictedCommands","IModelAdapter returned no data");return wa}const Ma=this.yUi(),hb=this.KKb;for(let na in hb){const Pa=hb[na],cb=Pa.modelId;let R=0;for(let ta in Ma){var ub=ta;const Ra=Ma[ta].features;
(ub=ub in Pa.$Ub?Pa.$Ub[ub]:null)&&(R+=Ra.invertedRank*ub.invertedRank+Ra.logRank*ub.logRank+Ra.logCount*ub.logCount+Ra.ZHb*ub.ZHb+Ra.aIb*ub.aIb+Ra.$Hb*ub.$Hb)}R+=Pa.featureIntercept;wa.push(new Lf.a(cb,R))}wa.sort((na,Pa)=>na.score<Pa.score?1:na.score>Pa.score?-1:0);0<wa.length-10&&(wa=wa.slice(0,10));return wa}}Object(h.a)(bf,"PredictionEngine",null,[]);class Sh{constructor(){this.htf={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}MKc(wa,Ma){return Ma&&"word"===Ma.application.toLowerCase()&&
wa in this.htf?this.htf[wa]:[]}}Object(h.a)(Sh,"SuggestionResultsUtility",null,[]);class $c{constructor(wa,Ma,hb){this.ub=Ma;this.HOb=new bf(wa);this.qR=hb;this.Bvf=new Sh}lG(){return"Suggestion"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:2}oD(wa,Ma,hb,ub=e.a.tellMe,na=null){hb=new y.a(wa);fd.TellMeActor.instance.unc=!1;if((!na||Array.contains(na,16))&&Ee.a.eN(wa)){if(!this.HOb.n9d()){if(fd.TellMeActor.instance.Ld)fd.TellMeActor.instance.Ld.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.r$d()&&0<this.Bvf.MKc(fd.TellMeActor.instance.vFc,this.ub).length){const cb=this.Bvf.MKc(fd.TellMeActor.instance.vFc,this.ub);na=[];for(var Pa of cb)this.ub.Ugd&&"Find"===Pa||na.push(new Lf.a(Pa,0));fd.TellMeActor.instance.unc=!0}else na=this.HOb.Y7i();ee.CommandResultsUtility.sVc(na,!0,"Recommended","LRE");Pa=[];for(const cb of na)this.qR&&this.qR.pNd(cb.commandId)||Pa.push(cb);wa=ee.CommandResultsUtility.MMc(wa,
Pa,this.ub,null,null,null,16,1);0<wa.results.length&&ub!==e.a.contextMenu&&(wa.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<wa.results.length&&hb.ns(wa)}Ma.resultsUpdated(hb)}r$d(){return!!this.ub&&(this.ub.r$d||this.ub.tOj)}}Object(h.a)($c,"SuggestionResultsProvider",null,[982]);class Gi{Z2i(){return fd.TellMeActor.instance.Ppd}t5i(){return window.TellMeSuggestionModel}YZd(){return window.CoefficientModelIdMap}}Object(h.a)(Gi,"SuggestionsModelAdapter",null,[1005]);var Hk=d(1004),Gj=d(946);
d.d(V,"AggregatorResultsProvider",function(){return Hj});class Hj{constructor(wa=!1){this.Wkb={};this.Wkb[e.a.tellMe]=[];this.Wkb[e.a.contextMenu]=[];this.Xsc=wa}Bxg(wa,Ma,hb,ub,na=null){let Pa;var cb=!1;switch(ub){case e.a.contextMenu:Pa=this.Wkb[e.a.contextMenu];cb=!0;break;default:Pa=this.Wkb[e.a.tellMe]}Ma=new vg(Ma,Pa,cb,this.Xsc,ub);Ma.Trk();for(let R=0;R<Pa.length;++R){const ta=window.performance.now(),Ra=new A(Ma,R);(cb=fd.TellMeActor.instance.hG())&&cb.obi?window.setTimeout(()=>{Pa[R].oD(wa,
Ra,hb,ub,na);if(fd.TellMeActor.instance.Ld){const nb={};nb[m.a.provider]=Pa[R].lG();nb[m.a.Gdb]=wa.pWa;fd.TellMeActor.instance.Ld.MI(r.a.oD,window.performance.now()-ta,nb)}},0):(Pa[R].oD(wa,Ra,hb,ub,na),fd.TellMeActor.instance.Ld&&(cb={},cb[m.a.provider]=Pa[R].lG(),cb[m.a.Gdb]=wa.pWa,fd.TellMeActor.instance.Ld.MI(r.a.oD,window.performance.now()-ta,cb)))}Ma.upl()}lG(){return"Aggregator"}zP(){return 0}oD(wa,Ma,hb=!1,ub=e.a.tellMe,na=null){if(fd.TellMeActor.instance.Nak)this.Bxg(wa,Ma,hb,ub,na);else{const Pa=
window.performance.now();fd.TellMeActor.instance.Axl.then(()=>{fd.TellMeActor.instance.Ld&&fd.TellMeActor.instance.Ld.MI(r.a.Oak,window.performance.now()-Pa);this.Bxg(wa,Ma,hb,ub,na);return!0})}}TC(wa,Ma){this.Wkb[Ma].push(wa)}OZh(wa){switch(wa){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Ma=this.Wkb[e.a.tellMe];for(const hb of Ma)if("FindInDocument"===hb.lG()){hb.L0k(wa);break}}}static createInstance(wa,Ma,hb,ub){const na=ub&&Ee.a.cKe(Ma);var Pa=
na&&Ma.kwe;const cb=Ma.bae&&!Ee.a.J8a(),R=Ma.v9d,ta=new Hj(na);if(Ma.a8k){var Ra=new qc(Ma);ta.TC(Ra,e.a.tellMe)}Ra=Ma.mo?Yf.AFrameworkApplication.fa.ka("TellMeIsSuggestionsForSimplifiedUxEnabled"):Yf.AFrameworkApplication.fa.ka("TellMeSuggestionsIsEnabled");const nb=!Ra&&Yf.AFrameworkApplication.fa.ka("TellMeFirstRunExperienceIsEnabled");ta.TC(new Md.a(wa,Ma.Ynl,nb,!1),e.a.tellMe);Ra&&ta.TC(new $c(new Gi,Ma,wa),e.a.tellMe);wa=Yf.AFrameworkApplication.Ba.jb.Kwg?new le(Ma,new je):new ij(Ma,hb);ta.TC(wa,
e.a.contextMenu);(na&&Ma.lwe||Pa)&&ta.TC(Hk.a.DSf(Ma,!0),e.a.tellMe);ta.TC(wa,e.a.tellMe);!Ma.KPi||"Word"===Ma.application&&Ma.a2f||ta.TC(new mf(Ma),e.a.tellMe);Ma.Q2a&&(Pa=new u(Ma),ta.TC(Pa,e.a.tellMe),ta.TC(Pa,e.a.contextMenu));!Ma.rnb||Ma.bkc||Ma.akc||ta.TC(new H.a(Ma),e.a.tellMe);ub&&(Ma.NCa||Ee.a.Yia())&&(Pa=new tb(Ma),ta.TC(Pa,e.a.tellMe),ta.TC(Pa,e.a.contextMenu));na&&ta.TC(Hk.a.DSf(Ma,!1),e.a.tellMe);ub&&!Ma.vNe&&Ee.a.bKe(Ma)&&(ta.TC(new Sg.a(Ma),e.a.tellMe),Ma.Bfl&&ta.TC(new Sg.a(Ma),e.a.contextMenu));
cb&&ta.TC(new pj(Ma),e.a.tellMe);(Ma.FGb||Ma.hJ)&&ta.TC(new Ia.a(Ma),e.a.tellMe);Ma.L4b&&ta.TC(new Gj.a(Ma),e.a.tellMe);ub&&Ma.SQc&&ta.TC(new v.AddinResultsProvider(Ma),e.a.tellMe);R&&"Excel"===Ma.application&&ta.TC(new Wf(Ma),e.a.tellMe);return ta}}Object(h.a)(Hj,"AggregatorResultsProvider",null,[982])},974:function(J,V,d){J=d(0);var h=d(146),e=d(657),m=d(369),r=d(260),v=d(441);class A{constructor(ia,C){this.DimensionValue=this.DimensionName=null;this.DimensionName=ia;this.DimensionValue=C}}Object(J.a)(A,
"Dimension",null,[]);class x{constructor(ia,C,oa,Z,pa){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=ia;this.Query=C;this.From=oa;this.Size=Z;pa&&(this.Filter=pa)}}Object(J.a)(x,"EntityRequest",null,[]);class y{constructor(ia){this.QueryString=null;this.QueryString=ia}}Object(J.a)(y,"Query",null,[]);var u=d(158);class H{constructor(ia,C){this.Dimensions=this.Name=null;this.Name=ia;this.Dimensions=C}}Object(J.a)(H,"Scenario",null,[]);var G=d(175),E=d(174);class I{constructor(ia,
C,oa,Z){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=ia;this.TimeZone=C;this.Cvid=oa;this.Scenario=Z}}Object(J.a)(I,"SubstrateBody",null,[]);var Q=d(440),D=d(119),Y=d(103),M=d(25),N=d(909),W=d(908),K=d(442),ca=d(33),P=d(45),ea=d(114);d.d(V,"a",function(){return da});class da{constructor(ia){this.VOb=this.YLa=this.huc=this.hMb=this.uPb=0;this.pef=this.pgf=this.tH=null;this.p0a=0;this.eR=-1;this.XQb="";this.Di=M.AFrameworkApplication.Be;this.ub=ia;this.axc=this.W0d();
this.jBd=new e.a;this.Ycf=this.ub.uQe?3:2;this.kwf=this.ub.uQe&&this.ub.fph?5:3;this.czf=this.ub.Ugd?2:3;this.dzf=1;this.Ktc=this.ub.yag;this.Uuf=this.ub.CLj;this.YPb=ia.Wcg;M.AFrameworkApplication.fa&&(this.pgf=M.AFrameworkApplication.fa.Ia("AppCatalogUrl")+M.AFrameworkApplication.fa.Ia("SearchPersonaPhotoBaseUrl"))}lG(){return"Substrate"}zP(){return 0===this.ub.Yq?0:1===this.ub.Yq?1:3}oD(ia,C,oa,Z=h.a.tellMe,pa=null){const ya=new E.a(ia);if(!pa||Array.contains(pa,14)||Array.contains(pa,15)||Array.contains(pa,
20))if(!this.p0a||window.performance.now()-this.p0a>=Y.a.gkd)if(oa=this.jBd.vdg())this.p0a=window.performance.now(),oa.then(Ja=>{Ja&&""!==Ja?(this.XQb=Ja,""!==this.tH&&this.udg(ia,Z,this.XQb,C,pa)):(D.TellMeActor.instance.Ld.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),C.resultsUpdated(ya))},Ja=>{D.TellMeActor.instance.Ld.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Ja);C.resultsUpdated(ya)});else{if(D.TellMeActor.instance.Ld)D.TellMeActor.instance.Ld.onError("SubstrateResultsProvider:IssueQuery",
"undefined token promise");C.resultsUpdated(ya)}else this.XQb&&""!==this.XQb?this.udg(ia,Z,this.XQb,C,pa):(C.resultsUpdated(ya),D.TellMeActor.instance.Ld.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else C.resultsUpdated(ya)}w4(){this.YLa=this.VOb=this.huc=this.hMb=this.uPb=0}udg(ia,C,oa,Z,pa){this.w4();const ya=new E.a(ia),Ja=this.tH=ea.a.create().toString();this.Yga();this.eR=window.setTimeout(()=>{if(Ja===this.tH){this.tH="";this.eR=-1;Z.resultsUpdated(ya);const ra=
{};ra[m.a.provider]=this.lG();ra[m.a.Gdb]=ia.pWa;D.TellMeActor.instance.Ld.MI(r.a.timedOut,this.YPb,ra)}},this.YPb);const Ka={"Content-Type":"application/json",Accept:"application/json"};Ka.Authorization="Bearer "+oa;Ka["X-Office-Version"]=M.AFrameworkApplication.buildVersion;Ka["X-Office-Application"]=M.AFrameworkApplication.fa.Ia("Application");Ka["X-Office-Platform"]="WAC";Ka["X-TellMe-SessionId"]=D.TellMeActor.instance.rNc();Ka["X-TellMe-Culture"]=M.AFrameworkApplication.uiCulture;Ka["X-TellMe-ProcessSessionId"]=
M.AFrameworkApplication.userSessionId;Ka["Client-Request-Id"]=Ja;const ma=window.performance.now();this.Di.Jj(this.icj(),2,this.jcj(ia.Hf,this.ub.application,D.TellMeActor.instance.rNc(),Y.a.eN(ia)),Ka,!1,0,ra=>{this.Rcb(ra,ia,Z,Ja,ma,C,pa)},ra=>{this.Gcb(ra,ia,Z,Ja,ma)},null,null,!1,4E3,6E3)}Yga(){-1!==this.eR&&(window.clearTimeout(this.eR),this.eR=-1)}Rcb(ia,C,oa,Z,pa,ya,Ja){D.TellMeActor.instance.Ld.g4(C.Hf.length,this.axc.join(","),ia.data.tf.toString(),Math.round(window.performance.now()-pa),
Q.a.substrate,!0,v.a.Jra);const Ka=Y.a.eN(C),ma=new E.a(C);if(Z===this.tH){this.Yga();ia=ca.b(ia.data.je);if(ia.Groups){ia=ia.Groups;for(const ra of ia)"People"===ra.Type&&this.ub.Hlc&&(Ja?Array.contains(Ja,14):1)?(ia=this.abg(ra.Suggestions,Ka,ya),0<ia.results.length&&ma.ns(ia)):"File"===ra.Type&&this.ub.Glc&&(Ja?Array.contains(Ja,15):1)?(ia=this.J8f(ra.Suggestions,Ka,ya),0<ia.results.length&&ma.ns(ia)):"Notes"===ra.Type&&this.ub.WRa&&ya!==h.a.contextMenu&&(Ja?Array.contains(Ja,20):1)&&(ia=this.uag(ra.Suggestions,
Ka,C),0<ia.results.length&&ma.ns(ia))}oa.resultsUpdated(ma);D.TellMeActor.instance.Ld.g4(C.Hf.length,this.axc.join(","),"",Math.round(window.performance.now()-pa),"",!0,v.a.provider)}else oa.resultsUpdated(ma)}uag(ia,C,oa){const Z=new G.a(20);Z.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const pa of ia)this.KNj(pa)&&(ia=pa.NotesType,ia=P.a.vg(ia),ia=this.s6i(ia,pa.LastModifiedTime,pa.BodyPreview,pa.Subject,C,oa,pa))&&(ia.groupType=20,Z.Bv(ia));return Z}abg(ia,C,oa){const Z=new G.a(14);
Z.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const ya of ia)if(this.LNj(ya)){var pa=ya.Id.split("@")[0];ia=ya.EmailAddresses[0];let Ja=ya.Type;if(void 0===Ja||null===Ja)Ja="User";if(pa=this.C7i(Ja,ya.DisplayName,ya.JobTitle,ia,pa,oa,C))pa.description=ia,ia=ya.JobTitle,"Department"in ya&&"CompanyName"in ya&&(ia+="@"+ya.Department+"@"+ya.CompanyName),pa.NGd=ia,Z.Bv(pa)}return Z}J8f(ia,C,oa){const Z=new G.a(15);Z.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ja of ia)if(this.BNj(Ja)){var pa=
Ja.FileName;ia=Ja.FileExtension;const Ka=pa.length>ia.length?pa.substr(0,pa.length-ia.length-1):Ja.Title;var ya=void 0;ia=0;"DateCreated"in Ja?(ia=Y.a.v1d(Ja.DateCreated),ya=Y.a.geg(Ja.DateCreated),ya=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ja.Author,ya)):ya=Ja.Author;const ma=Ja.AccessUrl+"?web=1",ra=P.a.O1b(ma);pa=String.format('<a href="{0}">{1}</a>',ra,P.a.RQa(pa));if(oa!==h.a.contextMenu||P.a.C7(ma))if(pa=this.$0i(Ka,oa===h.a.contextMenu?pa:ma,ya,Ja.FileExtension,Ja.Text,C))pa.description=
Ja.Author,pa.aAc=ia,Z.Bv(pa)}return Z}Gcb(ia,C,oa,Z,pa){Z===this.tH&&(this.Yga(),D.TellMeActor.instance.Ld.g4(C.Hf.length,this.axc.join(","),ia.data.tf.toString(),Math.round(window.performance.now()-pa),Q.a.substrate,!1,v.a.Jra));ia=new E.a(C);oa.resultsUpdated(ia)}C7i(ia,C,oa,Z,pa,ya,Ja){Ja=Ja?this.dzf:this.Ycf;if(!window.LPC&&!Y.a.Y7d()||this.uPb===Ja)return null;this.uPb+=1;Ja="PeopleSuggestion"+this.uPb.toString();var Ka=this.pgf+"?size=1&accountName="+Z;ia=Object.assign(new N.a,{PersonaType:ia,
Smtp:Z,ProfilePictureUrl:Ka,AadObjectId:pa});const ma=Object.assign(new W.a,{identifiers:ia,displayName:C});ia=ya===h.a.contextMenu;this.ub.lia?(D.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Ja,ma,C,oa)),ya===h.a.contextMenu&&(oa=Y.a.mSf(C,Z,pa),D.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ja,oa))),D.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ja,ia))):(Ka=[],Ka.push(appChrome.actions.setPersonaButtonCoauthor(Ja,
ma,C,oa)),ya===h.a.contextMenu&&(oa=Y.a.mSf(C,Z,pa),Ka.push(appChrome.actions.setButtonCommandValueId(Ja,oa))),Ka.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ja,ia)),appChrome.api.dispatch(Ka));return new u.a(Ja,11,C,Z,0)}s6i(ia,C,oa,Z,pa,ya,Ja){if(pa&&!this.ub.Owg||this.huc===this.Ktc||this.VOb===this.Ktc||this.YLa===this.Ktc)return null;var Ka=null;this.huc+=1;pa="";const ma=[],ra={};Ja.type="Notes";this.pef=Object.assign(new K.a,{landingTab:"Notes",data:Ja});ya=Y.a.UNa(ya.Hf,
33,this.pef);if("onenotepagepreviews"===ia){if(!("ClickthroughUrl"in Ja&&Ja.ClickthroughUrl)||""===Ja.ClickthroughUrl)return null;this.VOb+=1;pa="OnenoteNotesSuggestion"+this.VOb.toString();ra["default"]="SaveAsonetoc2_20";Ka=Ja.ClickthroughUrl;ma.push(appChrome.actions.setControlIconSet(pa,ra));ma.push(appChrome.actions.setCompoundButtonCommandValueId(pa,Ka));Ka=new u.a(pa,19,null,null,0)}else if("stickynote"===ia){if(!this.Uuf)return null;this.YLa+=1;pa="NotesSuggestion"+this.YLa.toString();ra["default"]=
"ShowAllNotes_20";ma.push(appChrome.actions.setControlIconSet(pa,ra));ma.push(appChrome.actions.setCompoundButtonCommandValueId(pa,ya));Ka=new u.a(pa,21,null,null,0)}else if("samsung"===ia){if(!this.Uuf)return null;this.YLa+=1;pa="NotesSuggestion"+this.YLa.toString();ra["default"]="CategoryCollapsed_20";ma.push(appChrome.actions.setControlIconSet(pa,ra));ma.push(appChrome.actions.setCompoundButtonCommandValueId(pa,ya));Ka=new u.a(pa,20,null,null,0)}""!==pa&&(ia=Y.a.geg(C),ia=String.format(CommonUIStrings.l_LastModifiedString,
ia),Ka.label=Z,Ka.aAc=Y.a.v1d(C),ma.push(appChrome.actions.setControlLabel(pa,Z)),ma.push(appChrome.actions.updateCompoundButtonDescription(pa,ia)),ma.push(appChrome.actions.setControlCustomTooltip(pa,oa)),appChrome.api.dispatch(ma));return Ka}$0i(ia,C,oa,Z,pa,ya){if(this.hMb===(ya?this.czf:this.kwf))return null;this.hMb+=1;ya="FileSuggestion"+this.hMb.toString();const Ja=[],Ka={};Ka["default"]=Y.a.y2i(Z);this.ub.lia?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ya,ia)),D.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(ya,
Ka)),D.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ya,oa)),D.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ya,C)),D.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(ya,pa))):(Ja.push(appChrome.actions.setControlLabel(ya,ia)),Ja.push(appChrome.actions.setControlIconSet(ya,Ka)),Ja.push(appChrome.actions.updateCompoundButtonDescription(ya,oa)),Ja.push(appChrome.actions.setCompoundButtonCommandValueId(ya,
C)),Ja.push(appChrome.actions.setControlCustomTooltip(ya,pa)),appChrome.api.dispatch(Ja));return new u.a(ya,6,ia,oa,0)}W0d(){const ia=[];this.ub.Hlc&&Array.add(ia,"People");this.ub.Glc&&Array.add(ia,"File");this.ub.WRa&&Array.add(ia,"Notes");return ia}jcj(ia,C,oa,Z){var pa=new y(ia);ia=new x("File",pa,0,Z?this.czf:this.kwf,null);Z=new x("People",pa,0,Z?this.dzf:this.Ycf,Y.a.csk);pa=new x("Notes",pa,0,this.Ktc,null);C=new A("app",C.toLowerCase());var ya=[];Array.add(ya,C);C=new H("tellmesearch",ya);
ya=[];this.ub.Glc&&Array.add(ya,ia);this.ub.Hlc&&Array.add(ya,Z);this.ub.WRa&&Array.add(ya,pa);oa=new I(ya,"UTC",oa,C);return ca.c(oa)}icj(){let ia=this.ub.Cfl;this.ub.WRa&&(ia+="?&setflight=NotesFrom3S");""!==this.ub.wdg&&(ia=ia+"&"+this.ub.wdg);return ia}LNj(ia){return"DisplayName"in ia&&"Id"in ia&&"EmailAddresses"in ia&&!!ia.Id&&!!ia.EmailAddresses}BNj(ia){return"FileExtension"in ia&&!!ia.FileExtension&&"FileName"in ia&&!!ia.FileName&&""!==ia.FileName&&"AccessUrl"in ia&&!!ia.AccessUrl&&""!==ia.AccessUrl}KNj(ia){return"Id"in
ia&&!!ia.Id&&"NotesType"in ia&&!!ia.NotesType&&"Subject"in ia&&!!ia.Subject&&""!==ia.Subject}}Object(J.a)(da,"SubstrateResultsProvider",null,[982])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.chronos1.js.map