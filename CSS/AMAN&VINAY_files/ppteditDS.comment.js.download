'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1195:function(J,V,d){d.r(V);var h=d(0),e=d(25),m=d(374),r=d(17),v=d(22);class A{}A.beginDraftingAsync="OSC:BDA";A.JRi="OSC:FEQ";A.selectComment="OSC:SC";Object(h.a)(A,"CommentTaskNames",null,[]);class x{constructor(R){this.zEa=R;this.XYj=[]}get handler(){return this.zEa}get M6(){return this.XYj}}Object(h.a)(x,"RegisteredListener",null,[]);class y{constructor(R,ta){this.type=0;this.payload=null;this.type=R;this.payload=
ta}}Object(h.a)(y,"OfficeSharedCommentsEvent",null,[1480]);class u{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(h.a)(u,"ViewContainerEvent",null,[1480]);var H=d(651);class G{constructor(R){this.tie=!1;this.wW=new r.a;this.Bb=R}MIk(R){R=new x(R);this.wW.add(R)}Myh(R){for(let ta=0;ta<this.wW.count;++ta)if(this.wW.ga(ta).handler===R){this.wW.removeAt(ta);break}}Bma(R=!1){const ta=()=>{if(e.AFrameworkApplication.Xg)m.ULS.sendTraceTag(40420181,201,
50,"Skipped processing comment pane events since app is shutting down.");else for(let Cb=0;Cb<this.wW.count;++Cb){const mc=this.wW.ga(Cb);for(;0<mc.M6.length;){var Ra=Array.dequeue(mc.M6);if(Object(v.a)(u,Ra)){var nb=mc.handler;nb(Ra)}else Object(v.a)(y,Ra)&&(nb=mc.handler,nb(Ra.type,Ra.payload))}}};R?ta():this.tie||(this.tie=!0,H.a.Amb(this.Bb,()=>{ta();this.tie=!1},A.JRi))}}Object(h.a)(G,"GenericEventHost",null,[]);class E extends G{constructor(R){super(R)}bKk(R){this.MIk(R)}Upl(R){this.Myh(R)}vlh(R){R=
this.Jui(R);for(let ta=0;ta<this.wW.count;++ta)Array.enqueue(this.wW.ga(ta).M6,R);this.Bma(!0)}Jui(R){const ta=new u;ta.eventType=3;ta.viewContainerVisibilityState=R;return ta}TRi(){const R=this.gAi();for(let ta=0;ta<this.wW.count;++ta)Array.enqueue(this.wW.ga(ta).M6,R);this.Bma(!0)}gAi(){const R=new u;R.eventType=2;return R}}Object(h.a)(E,"ViewContainerEventHost",G,[1465]);class I{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=
this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(h.a)(I,"BasicEventPayload",null,[1528]);class Q{constructor(R){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=R}}Object(h.a)(Q,"CommentContextDetails",null,[]);class D{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(h.a)(D,"ContextChangeWithSelectedThreadIndex",null,[1528]);class Y{constructor(){this.tasks=this.comments=null}}Object(h.a)(Y,"LoadCommentsNoVirtualization",null,[1528]);class M extends G{constructor(R){super(R);this.ySh=0}eJk(R,ta,Ra,nb,Cb,mc,Sc=0){R=new x(R);mc&&Array.enqueue(R.M6,this.rui(mc,this.ySh));mc=ta?ta.length:0;Array.enqueue(R.M6,this.QQf(mc,
Ra,nb,Sc,null));mc&&Array.enqueue(R.M6,this.CRf(ta,Cb));this.wW.add(R);this.Bma()}Qyh(R){this.Myh(R)}TGe(R,ta,Ra,nb=0,Cb=null){this.YQa(this.QQf(R,ta,Ra,nb,Cb));this.Bma()}gXk(R,ta,Ra,nb,Cb=null){this.YQa(this.Nui(R,ta,Ra,nb,Cb));this.Bma()}Xhh(R,ta,Ra){this.YQa(this.Qui(R,ta,Ra));this.Bma()}YGe(R,ta){this.YQa(this.CRf(R,ta));this.Bma()}selectComment(R){this.YQa(this.kSf(R,6));this.Bma()}highlightComment(R){this.YQa(this.kSf(R,7));this.Bma()}aZa(R,ta){this.YQa(this.ixi(R,ta));this.Bma()}juk(R,ta){this.YQa(this.nzi(R,
ta));this.Bma()}rui(R,ta=0){const Ra=new I;Ra.modelCapabilityFlags=R;Ra.richTextCapabilityFlags=ta;return new y(12,Ra)}QQf(R,ta,Ra,nb,Cb=null){const mc=new I;mc.numberOfComments=R;mc.numberOfThreads=ta;mc.contextDetails=Object.assign(new Q(Ra),{nextPopulatedContextDetails:nb});mc.contextDrafts=Cb;mc.rehydrationDrafts=null;return new y(0,mc)}Nui(R,ta,Ra,nb,Cb=null){const mc=new D;mc.numberOfComments=R;mc.numberOfThreads=ta;mc.selectedThreadIndex=Ra;mc.contextDetails=Object.assign(new Q(nb),{nextPopulatedContextDetails:0});
mc.contextDrafts=Cb;mc.rehydrationDrafts=null;return new y(0,mc)}Qui(R,ta,Ra){const nb=new I;nb.comments=R;nb.numberOfThreads=ta;nb.tasks=Ra;return new y(2,nb)}CRf(R,ta){const Ra=new Y;Ra.comments=R;Ra.tasks=ta;return new y(1,Ra)}kSf(R,ta){const Ra=new I;Ra.commentId="";R&&(Ra.commentId=R);return new y(ta,Ra)}ixi(R,ta){const Ra=new I;Ra.changes=[];Ra.contextDetails=Object.assign(new Q(ta),{nextPopulatedContextDetails:R});return new y(10,Ra)}nzi(R,ta){const Ra=new I;Ra.commentId=R;Ra.smartReplies=
ta;return new y(15,Ra)}YQa(R){for(let ta=0;ta<this.wW.count;++ta)Array.enqueue(this.wW.ga(ta).M6,R)}}Object(h.a)(M,"OfficeSharedCommentsEventHost",G,[1518]);var N=d(1153);class W{constructor(){this.Gtf=this.Cvf=!1;this.IVh=[]}get rIb(){return this.IVh}get tgb(){return this.Cvf}set tgb(R){this.Cvf=R;for(const ta of this.rIb)ta.tgb=R}get lfb(){return this.Gtf}set lfb(R){this.Gtf=R;for(const ta of this.rIb)ta.lfb=R}fJa(R){for(const ta of this.rIb)R=ta.fJa(R);return R}}Object(h.a)(W,"AggregateCommentTaskPersonTransformer",
null,[1547]);var K=d(114);class ca{constructor(R,ta,Ra,nb,Cb=!1){this.priority=this.completion=-1;this.type=R;this.user=ta;this.time=Ra;this.recordId=nb;this.isLossy=Cb}}Object(h.a)(ca,"HistoryRecord",null,[]);class P{constructor(R,ta){this.SNh=new N.a(()=>ta.fJa(R.value))}ZZi(){return new Date}rAa(R,ta,Ra){if(0===R)throw m.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");
const nb=K.a.create().toString();Ra=new ca(R,this.SNh.value,Ra,nb,!1);Ra.commentId=ta;m.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",R);return Ra}}Object(h.a)(P,"HistoryRecordFactory",null,[1548]);class ea{constructor(){this.endDate=this.startDate=null}}Object(h.a)(ea,"CommentTaskSchedule",null,[]);class da{constructor(R,ta,Ra,nb,Cb,mc){this.isLossy=R;this.title=ta;this.assignees=Ra;this.schedule=nb;this.completion=Cb;this.priority=mc}}Object(h.a)(da,"CommentTaskState",
null,[]);class ia{constructor(){this.commentId=null}}Object(h.a)(ia,"HistoryItem",null,[]);class C{constructor(R,ta,Ra,nb,Cb,mc,Sc){this.iud=!1;if(1!==ta.type)throw Error.argument("createRecord");this.oLb=Ra;this.lLb=nb;this.mLb=Cb;this.jef=1;this.Xrc=R;this.jPh=mc;this._state=new da(!1,this.oLb,Sc,new ea,this.mLb,this.lLb);this._history=[];this.NRf(ta)}tpb(R,ta){if(1!==R.type)throw Error.argument("createRecordTemplate");const Ra=C.Bcj(R,this.jef);this.jef++;return Object.assign(new ca(ta,R.user,
R.time,Ra),{commentId:R.commentId})}get kyg(){return this.history[this.history.length-1]}get Vhg(){return this.state.completion===this.mLb}get Uhg(){return this.state.priority===this.lLb}get Whg(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get Xhg(){return this.state.title===this.oLb}NRf(R){R=Object.assign(new ia,{commentId:R.commentId,records:[R]});this.history.push(R)}N5f(R){let ta=
-1;for(let Ra=0;Ra<this.state.assignees.length;Ra++)if(this.Xrc.equals(this.state.assignees[Ra],R)){ta=Ra;break}return ta}O5k(R){const ta=this.kyg,Ra=ta.records[ta.records.length-1];return this.Xrc.equals(Ra.user,R.user)&&ta.commentId===R.commentId&&Ra.time.getTime()===R.time.getTime()?!0:!1}zul(R){switch(R.type){case 2:-1===this.N5f(R.assignee)&&this.state.assignees.push(R.assignee);break;case 3:const ta=this.N5f(R.assignee);0<=ta&&this.state.assignees.splice(ta,1);break;case 4:Array.clear(this.state.assignees);
break;case 5:this.state.schedule=R.schedule;break;case 6:this.state.completion=R.completion;break;case 9:this.state.title=R.title;break;case 10:this.state.priority=R.priority;break;case 0:this.state.isLossy=!0;break;case 1:m.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.iud=!0;break;case 8:this.iud=!1;break;case -1:m.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}R.isLossy&&(this.state.isLossy=
!0);this.O5k(R)?this.kyg.records.push(R):this.NRf(R)}get isDeleted(){return this.iud}get state(){return this._state}get history(){return this._history}n2i(R){if(!R)return this.history;const ta=Array.clone(this.history),Ra=ta[0],nb=Ra.records.shift();if(!this.jPh){var Cb=this.tpb(nb,4);Ra.records.unshift(Cb)}!R.Vhg&&this.Vhg&&(Cb=this.tpb(nb,6),Cb.completion=this.mLb,Ra.records.unshift(Cb));!R.Uhg&&this.Uhg&&(Cb=this.tpb(nb,10),Cb.priority=this.lLb,Ra.records.unshift(Cb));!R.Whg&&this.Whg&&(Cb=this.tpb(nb,
5),Cb.schedule=new ea,Ra.records.unshift(Cb));!R.Xhg&&this.Xhg&&(Cb=this.tpb(nb,9),Cb.title=this.oLb,Ra.records.unshift(Cb));R.isDeleted&&(R=this.tpb(nb,8),Ra.records.unshift(R));return ta}static Bcj(R,ta){return"Synthesized-"+R.recordId+"-"+ta}}Object(h.a)(C,"CommentTaskStateBuilder",null,[]);var oa=d(701);class Z{constructor(R,ta,Ra,nb){this.id=R;this.commentId=ta;this.currentState=Ra;this.history=nb}}Object(h.a)(Z,"CommentTaskItem",null,[]);class pa{constructor(R,ta="",Ra="",nb=""){this.IsCurrentUser=
!1;this.UserId=R;this.Provider=ta;this.DisplayName=Ra;this.Email=nb}}Object(h.a)(pa,"CommentTaskPerson",null,[1541]);const ya=R=>{const ta=new pa(R.UserId,R.Provider,R.DisplayName,R.Email);ta.IsCurrentUser=R.IsCurrentUser;return ta};var Ja=d(981);d(283);class Ka{constructor(R){this.extensions=R}}Object(h.a)(Ka,"ExtensionList",null,[]);class ma{static clone(R){R=ma.rmi(R.extensions);return new Ka(R)}static qNf(R){return R?ma.clone(R):null}static isEmpty(R){return!R.extensions||!R.extensions.count}static Xa(R){return!R||
ma.isEmpty(R)}static rmi(R){if(!R)return null;const ta=new Ja.a;R.forEach((Ra,nb)=>{ta.add(Ra,nb);return!0});return ta}}Object(h.a)(ma,"ExtensionListExtensions",null,[]);class ra{static clone(R){var ta=ya(R.user);ta=new ca(R.type,ta,R.time,R.recordId,R.isLossy);ta.commentId=R.commentId;ta.anchorExtensionList=ma.qNf(R.anchorExtensionList);ta.recordExtensionList=ma.qNf(R.recordExtensionList);R.assignee&&(ta.assignee=ya(R.assignee));if(R.schedule){var Ra=R.schedule;const nb=new ea;nb.startDate=Ra.startDate;
nb.endDate=Ra.endDate;ta.schedule=nb}ta.completion=R.completion;ta.title=R.title;ta.priority=R.priority;ta.undoId=R.undoId;return ta}}Object(h.a)(ra,"HistoryRecordExtensions",null,[]);class Da{constructor(R,ta,Ra,nb,Cb,mc,Sc,jd=!1){this.Xrc=R;this.cvc=ta;this.Coa=Ra;this.XHh=nb;this.oLb=Cb;this.lLb=mc;this.mLb=Sc;this.Jsc=jd}Lzi(R,ta,Ra,nb=null){if(!R)throw m.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!ta)throw m.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),
Error.argumentNull("parentCommentId");if(!Ra||!Ra.length)throw m.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Ra[0].type)throw m.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var Cb=[],mc=null,Sc=this.gzk(Ra);for(var jd of Ra)if(!Sc.contains(jd.recordId))if(Ra=this.weg(jd.commentId,nb),Ra=this.VUi(jd,Ra),1===Ra.type){let ve=[];this.Jsc&&mc&&mc.state&&(ve=
mc.state.assignees);mc=new C(this.Xrc,Ra,this.oLb,this.lLb,this.mLb,this.Jsc,ve);Cb.push(mc)}else if(mc)mc.zul(Ra);else throw m.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");Sc=null;jd=[];if(mc){mc.isDeleted||(Sc=mc.state);mc=null;for(var Ad of Cb)Cb=Ad.n2i(mc),Array.addRange(jd,Cb),mc=Ad}Ad=this.weg(ta,
nb);Sc&&(Sc.completion=this.Ioi(ta,nb,Sc.completion));return new Z(R,Ad,Sc,jd)}rUi(R,ta,Ra,nb=null){if(!ta)throw m.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Ra&&!R)throw m.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const Cb=[],mc=this.Coa.ZZi();if(Ra){var Sc=this.Coa.rAa(1,R,mc);Cb.push(Sc)}Sc=null;if(ta.assigneeUpdate){if(!ta.assigneeUpdate.assigneesToAdd||!ta.assigneeUpdate.assigneesToRemove)throw m.ULS.sendTraceTag(536999254,
327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var jd=0;jd<ta.assigneeUpdate.assigneesToAdd.length;jd++){var Ad=this.ORf(2,ta.assigneeUpdate.assigneesToAdd[jd],R,mc);Ad&&Cb.push(Ad)}for(jd=0;jd<ta.assigneeUpdate.assigneesToRemove.length;jd++)(Ad=this.ORf(3,ta.assigneeUpdate.assigneesToRemove[jd],R,mc))&&Cb.push(Ad)}else ta.assignee&&(Ra||(Sc=this.Coa.rAa(4,R,mc),Cb.push(Sc)),jd=this.Coa.rAa(2,R,mc),Sc=this.cvc.fJa(ta.assignee),jd.assignee=Sc,Cb.push(jd));
ta.title?(nb=this.Coa.rAa(9,R,mc),nb.title=ta.title,Cb.push(nb)):Ra&&nb&&(jd=this.Coa.rAa(9,R,mc),jd.title=this.XHh.kej(nb,Sc),Cb.push(jd));if(ta.schedule){if(ta.schedule.startDate>ta.schedule.endDate)throw m.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");nb=this.Coa.rAa(5,R,mc);nb.schedule=ta.schedule;Cb.push(nb)}if(void 0!==ta.completion&&null!==ta.completion){nb=ta.completion;if(0>nb||100<nb)throw m.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),
Error.argumentOutOfRange("completion");Ra||m.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",nb);Ra=this.Coa.rAa(6,R,mc);Ra.completion=nb;Cb.push(Ra)}if(void 0!==ta.priority&&null!==ta.priority){ta=ta.priority;if(0>ta||10<ta)throw m.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");R=this.Coa.rAa(10,R,mc);R.priority=ta;Cb.push(R)}return Cb}ORf(R,ta,Ra,nb){if(2!==R&&3!==R)return m.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),
null;R=this.Coa.rAa(R,Ra,nb);R.assignee=this.cvc.fJa(ta);return R}gzk(R){const ta=new oa.a,Ra=new oa.a;for(let nb=R.length-1;0<=nb;nb--){const Cb=R[nb],mc=Ra.contains(Cb.recordId);mc||-1!==Cb.type||(Ra.contains(Cb.undoId)?m.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):Ra.add(Cb.undoId));if(mc||-1===Cb.type)ta.contains(Cb.recordId)?m.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):
ta.add(Cb.recordId)}return ta}VUi(R,ta){const Ra=ra.clone(R);Ra.commentId=ta;Ra.user=this.cvc.fJa(R.user);Ra.assignee=this.cvc.fJa(R.assignee);return Ra}Ioi(R,ta,Ra){let nb=Ra;R&&ta&&(({value:ta}=ta.Nf(R)).returnValue?(nb=ta.ResolveState?100:100===Ra?0:Ra,nb!==Ra&&m.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",R)):m.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",R));
return nb}weg(R,ta){let Ra=R;R&&ta&&(({value:ta}=ta.Nf(R)).returnValue?Ra=ta.CommentId:(m.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",R),Ra=R));return Ra}}Object(h.a)(Da,"CommentTaskTranslatorImpl",null,[926]);class va{constructor(){this.n_a={};this.n_a.ops=[]}Fxj(R){const ta=this.n_a.ops;if(ta.length){var Ra=ta.length-1;const nb=ta[Ra];if(!nb.attributes){nb.insert+=R;ta[Ra]=nb;this.n_a.ops=ta;return}}Ra={};Ra.insert=R;Array.add(ta,
Ra)}Wwj(R,ta,Ra){var nb={};nb.fullName=ta.fullName;nb.email=ta.email;nb.resolveState=ta.resolveState;ta={};ta.atmention=nb;R=this.QOd(R,ta);Ra&&(nb={},nb.contentId=Ra.contentId,Ra={},Ra.atmention=nb,R.optional=Ra);Array.add(this.n_a.ops,R)}insertImage(R,ta){R=this.QOd(R,{});const Ra={};Ra.base64=ta.base64;ta={};ta.image=Ra;R.optional=ta;Array.add(this.n_a.ops,R)}insertHyperLink(R,ta){const Ra={};Ra.link=ta.link;this.g2k(Ra,ta);Array.add(this.n_a.ops,this.QOd(R,Ra))}y_i(){return Sys.Serialization.JavaScriptSerializer.serialize(this.n_a)}QOd(R,
ta){const Ra={};Ra.insert=R;Ra.attributes=ta;return Ra}g2k(R,ta){this.$eb(ta.weight>=va.uak,R,"weight",ta.weight);this.$eb(ta.italic,R,"italic",!0);this.$eb(ta.underline,R,"underline",!0);this.$eb(ta.strikethrough,R,"strikethrough",!0);this.$eb(!!ta.highlight,R,"highlight",ta.highlight);this.$eb(!!ta.color,R,"color",ta.color);this.$eb(!!ta.paragraph,R,"paragraph",ta.paragraph)}$eb(R,ta,Ra,nb){R&&(ta[Ra]=nb)}static X7f(R){return Sys.Serialization.JavaScriptSerializer.deserialize(R,!0)}}va.uak=700;
Object(h.a)(va,"DeltaFormatCreator",null,[1512]);var Fa=d(519),ka=d(1102);class qa{constructor(){this.ellipsis=CommonUIStrings.l_Ellipsis}kej(R,ta){if(!R)throw m.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var Ra=va.X7f(R)}catch(Ad){throw m.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var nb=R=0,Cb=0;const mc=RegExp("\\s+","g"),Sc=new Sys.StringBuilder;
for(var jd of Ra.ops)jd.attributes&&jd.attributes.atmention&&jd.attributes.atmention.email&&ta&&(Ra=jd.attributes.atmention.email,0<Ra.length&&(Ra===ta.UserId||Ra===ta.Email||Ra===Fa.a.$4a(ta.UserId))&&(nb=R,Cb=nb+jd.insert.length)),Ra=jd.insert.replace(mc," "),R+=Ra.length,Sc.append(Ra);!Cb&&ta&&m.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",ta.Provider);ta=Sc.toString().trimEnd();R=ta.length;255<R?(jd=(255-(Cb-nb))/2,0>nb-jd?(R=ka.a.instance.iXd(ta,255-this.ellipsis.length),
Cb=ta.substring(0,R)+this.ellipsis,R="Trimmed End"):Cb+jd>R?(nb=ka.a.instance.ALc(ta,R-255+this.ellipsis.length),Cb=this.ellipsis+ta.substring(nb,R),R="Trimmed Start"):(nb=ka.a.instance.ALc(ta,nb-jd+this.ellipsis.length),R=ka.a.instance.iXd(ta,Cb+jd-this.ellipsis.length),Cb=this.ellipsis+ta.substring(nb,R)+this.ellipsis,R="Trimmed Both")):(R="No Trim",Cb=ta);m.ULS.sendTraceTag(592998804,327,50,R);return Cb}}Object(h.a)(qa,"ContentExtractor",null,[]);class Ua{constructor(R,ta){this.BLh=R;this.TNh=
ta;this.lfb=this.tgb=!1}fJa(R){if(!R)return null;if(void 0===R.UserId||null===R.UserId)throw m.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(R.IsCurrentUser||!this.BLh.equals(this.TNh.value,R))return R;R=ya(R);R.IsCurrentUser=!0;return R}}Object(h.a)(Ua,"EnsureIsCurrentUserSetTransformer",null,[1547]);class Ya{constructor(){this.lfb=this.tgb=!1}fJa(R){if(!R)return null;if(void 0===R.UserId||null===R.UserId)return R;if(!R.Email||""===R.Email){let ta;
if(ta=Fa.a.$4a(R.UserId))return R=ya(R),R.Email=ta,R}return R}}Object(h.a)(Ya,"RestoreEmailTransformer",null,[1547]);class Va{constructor(){this.lfb=this.tgb=!1}fJa(R){if(!R)return null;if(void 0!==R.UserId&&null!==R.UserId)return R;switch(this.tgb?this.lfb?2:1:0){case 0:if(void 0===R.UserId||null===R.UserId)throw m.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");R=ya(R);break;case 1:if(void 0===R.Id||null===R.Id)throw m.ULS.sendTraceTag(593368214,327,
10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===R.Email||null===R.Email)throw m.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var ta=Va.p2g(R.Id,R.Email,null);if(!ta||""===ta)throw m.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var Ra=e.AFrameworkApplication.fa.Ia("HostAuthType")||"";if("aad"!==Ra.toLowerCase()||ta.startsWith("S::")){if("msa"===Ra.toLowerCase())throw m.ULS.sendTraceTag(593368210,
327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");m.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Ra)}else throw m.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");R=new pa(ta,"AD",R.DisplayName,R.Email);break;case 2:if(void 0===R.UserPrincipalName||null===R.UserPrincipalName)throw m.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");
if(void 0!==R.SuggestionSubtype&&null!==R.SuggestionSubtype)if("OrganizationUser"===R.SuggestionSubtype)ta="AD";else throw m.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",R.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw m.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Ra=Va.p2g(R.Id,R.UserPrincipalName,R.AadObjectId);if(!Ra||""===Ra)throw m.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),
Error.argument("UserId");if("AD"===ta&&!Ra.startsWith("S::"))throw m.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");R=new pa(Ra,ta,R.Name,R.UserPrincipalName);break;default:throw m.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return R}static p2g(R,ta,Ra){if(!ta||""===ta)return m.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),R;if(Ra&&""!==Ra)return"S::"+ta+"::"+Ra;if(!R||""===R)return m.ULS.sendTraceTag(593368217,
327,50,"Missing ID"),R;if(R.startsWith("S::"))return R;if(-1!==R.indexOf("@")){Ra=R.split("@");if(K.a.isValid(Ra[0]))return"S::"+ta+"::"+Ra[0];m.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return R}}Object(h.a)(Va,"UserIdCanonicalizationTransformer",null,[1547]);class ua{constructor(R,ta,Ra=!1,nb=!1){this.DJh=R;this.UWe=ta;this.lOh=Ra;this.Jsc=nb}Hui(){const R=new Fa.a;var ta=new N.a(ua.OZi);const Ra=new W;this.UWe&&(Ra.rIb.push(new Va),Ra.rIb.push(new Ya));this.DJh&&
Ra.rIb.push(new Ua(R,ta));Ra.tgb=this.UWe;Ra.lfb=this.lOh;ta=new P(ta,Ra);const nb=new qa;return new Da(R,Ra,ta,nb,ua.sCi,ua.eCi,ua.fCi,this.Jsc)}static OZi(){const R=new pa(e.AFrameworkApplication.fa.Ia("PresenceUserId")||"",e.AFrameworkApplication.fa.Ia("PresenceProvider")||"",e.AFrameworkApplication.userName||"");R.IsCurrentUser=!0;return R}}ua.sCi="";ua.eCi=5;ua.fCi=0;Object(h.a)(ua,"CommentTaskTranslatorFactory",null,[1540]);class Ca{constructor(){this.EBd=this.$Ue=!1;this.Blb=this.Rq=this.U4e=
this.kcf=this.oyf=this.jgf=this.$vf=this.ZXe=this.gx=this.zQb=null}initialize(R,ta,Ra,nb=null,Cb=null,mc=null,Sc=null,jd=null,Ad=null,ve=null){this.gx=R;this.ZXe=ta;this.$vf=Ra;this.jgf=nb;this.oyf=Cb;this.kcf=mc;this.U4e=Sc;this.Rq=jd;this.$Ue=!0;this.Blb=Ad;this.zQb=ve}B2b(R=null,ta=null){if(!this.$Ue)return m.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((Ra,nb)=>{nb(H.a.Yt(-2130915313))});if(this.EBd)return m.ULS.sendTraceTag(41424204,
201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.zQb||(e.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?this.zQb=appResourceLoader.loadChunk("sharedComments"):this.zQb=this.gx.loadScript("sharedComments"));return this.zQb.then(()=>{R&&R();this.EBd||(this.Blb&&this.Blb.execute(Ra=>{Ra.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),ta&&ta(),sharedComments.instantiate(this.ZXe,
this.$vf,this.jgf,this.oyf,this.kcf,this.U4e,this.Rq));this.EBd=!0})}}Object(h.a)(Ca,"CommentActivationManager",null,[1542]);var Ea=d(13);class wb{constructor(){this.actionBehavior=this.actionType=0}}Object(h.a)(wb,"CommentUIActionPayload",null,[]);var Oa=d(255);class ab{constructor(R,ta){this.Da=R;this.yZa=ta;this.Dnd=new Oa.a;for(let Ra of this.yZa)this.Dnd.$(Ra.value.canvasActionId,Ra.key),R=Ra.value,R.delayActionsUntilRegistration||this.ya(R)}ya(R){R.withFlags?this.Da.ra(R.canvasActionId,R.canvasContextId,
Object(Ea.a)(this,this.XRb,"actionHandler"),97):this.Da.ya(R.canvasActionId,R.canvasContextId,Object(Ea.a)(this,this.XRb,"actionHandler"))}Iva(R,ta){this.yZa.Kb(R)&&(this.yZa.ga(R).delayActionsUntilRegistration&&this.ya(this.yZa.ga(R)),this.yZa.ga(R).registeredCallback=ta)}XRb(R,ta,Ra,nb,Cb){if(this.Dnd.Kb(R)){var mc=this.Dnd.ga(R);if(!this.yZa.Kb(mc))return 8;const Sc=this.yZa.ga(mc);if(Sc.preCallback){const jd=Sc.preCallback(R,ta,Ra,nb,Cb);if(2!==jd)return jd}if(!Sc.registeredCallback)return 1===
Ra?8:2;mc=Object.assign(new wb,{actionType:mc});1===Ra&&(mc.actionBehavior=1);mc=Sc.registeredCallback(mc);return Sc.postCallback?Sc.postCallback(mc,R,ta,Ra,nb,Cb):mc?32:8}return 2}}Object(h.a)(ab,"OfficeSharedCommentsActionHost",null,[1523]);var fb=d(332),db=d(35),gc=d(176);class ob{}Object(h.a)(ob,"CommentActivityData",null,[]);var Sb=d(141),Jb=d(70);class Ab{constructor(R,ta,Ra,nb,Cb,mc,Sc,jd,Ad,ve=null,Ae=null){this.Hzf={["CancelCommentCreateThreadAction"]:db.a.rmh,["CommitComment"]:db.a.smh,
["CommitDraftAction"]:db.a.tmh,["CommitDraftCreateAction"]:db.a.FJe,["CommitDraftEditAction"]:db.a.HJe,["CommitDraftReplyAction"]:db.a.EJe,["CreateReplyAction"]:db.a.EJe,["CreateReplyWithMentions"]:db.a.umh,["CreateReplyWithTaskAssigned"]:db.a.vmh,["CreateThreadAction"]:db.a.FJe,["CreateThreadWithMentions"]:db.a.wmh,["CreateThreadWithTaskAssigned"]:db.a.xmh,["DeletePostAction"]:db.a.ymh,["DeleteThreadAction"]:db.a.zmh,["DeleteThreadWithTask"]:db.a.Amh,["DiscardDraftAsync"]:db.a.Bmh,["PresentLinkToCommentAction"]:db.a.Cmh,
["ResolveThreadAction"]:db.a.Gmh,["ResolveThreadWithTask"]:db.a.Hmh,["ReopenThreadAction"]:db.a.Dmh,["ReopenThreadWithTask"]:db.a.Emh,["RequestInitCommentSession"]:db.a.Fmh,["SelectCommentAction"]:db.a.Imh,["UpdateCommentBodyAction"]:db.a.HJe};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=R;this.appVersion=ta;this.releaseAudience=Ra;this.releaseChannel=nb;this.sessionId=
Cb;this.ring=mc;this.dataCenter=Sc;this.disableUpload=jd;this.sovereignEnvironmentName=Ae;this.Da=Ad;this.lgf=ve;this.xwj()}xwj(){this.Da.ya(db.a.rmh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.smh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.tmh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.EJe,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.umh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.vmh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.FJe,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.wmh,
Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.xmh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.ymh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.zmh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.Amh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.Bmh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.Cmh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.Gmh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.Hmh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.Dmh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.Emh,
Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.Fmh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.Imh,Jb.a.frame,gc.ActionManager.Dg);this.Da.ya(db.a.HJe,Jb.a.frame,gc.ActionManager.Dg)}sendULSTrace(R,ta,Ra,nb){m.ULS.sendTraceTag(R,ta,Ra,nb)}recordActivity(R){this.Hzf[R]&&this.Da.processAction(this.Hzf[R],2)}sendOtelEvent(R){Sb.a.sendOtelEvent(R)}recordPerfData(R,ta){this.lgf&&(R=Object.assign(new ob,{durationMs:ta,name:R}),this.lgf.Zla(R))}}Object(h.a)(Ab,"OfficeSharedCommentsTelemetry",null,[]);
var lc=d(267);class Mc{constructor(R,ta,Ra,nb){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=R;this.appLocale=ta;this.uiCulture=Ra;this.dataCulture=nb}}Object(h.a)(Mc,"LocalizationDetails",null,[]);var Jc=d(286),rb=d(66),cc=d(91);class jb{constructor(R,ta){this.JWh=R;this.Y0e=ta}getViewContainer(){return this.JWh}registerForViewContainerEvents(R){this.Y0e.bKk(R)}unregisterForViewContainerEvents(R){this.Y0e.Upl(R)}}Object(h.a)(jb,"ViewContainerProvider",
null,[1464]);var Xb=d(69),yb=d(1154),mb=d(33),Ub=d(27),ec=d(245),nc=d(207),Lb=d(26),Zc=d(242),Pb=d(623);class eb{static W9f(R){return R===eb.create?0:R===eb.reply?1:R===eb.edit?2:R===eb.metadata?3:null}}eb.create="CREATE";eb.reply="REPLY";eb.edit="EDIT";eb.metadata="METADATA";Object(h.a)(eb,"CommentSessionType",null,[]);class $a{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(h.a)($a,"InitCommentSessionResult",
null,[]);class vb extends $a{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(h.a)(vb,"BeginDraftingHostResult",$a,[]);class bc{constructor(R,ta="",Ra="",nb="",Cb=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=R;this.Provider=ta;this.DisplayName=Ra;this.Email=nb;this.IsCurrentUser=Cb}}Object(h.a)(bc,"OfficeSharedCommentUser",null,[]);var Cc=d(45),Gc=d(57),sd=d(247),Sd=d(42);class ie{constructor(R,ta,Ra){this.rp=R;this.GYj=ta;
this.QXj=Ra;this.tEg=null;this.sIg=!1}get ENa(){return this.rp}get GB(){return this.GYj}get commentId(){return this.QXj}get P6(){return this.tEg}set P6(R){this.tEg=R}get pTc(){return this.sIg}set pTc(R){this.sIg=R}}Object(h.a)(ie,"ActiveCommentSession",null,[]);var De=d(665);class yd{static get l$j(){return 50}static ZVi(R){return yd.yYi(R)}static I7i(R){if(""===R)return"";let ta=0,Ra="";try{const nb=va.X7f(R);for(const Cb of nb.ops)if(yd.Vra(Cb))ta||(Ra+=yd.n1i(Cb.attributes.atmention.fullName)),
ta+=1;else{const mc=Cb.insert?Cb.insert:"";" "!==mc&&0<mc.length&&(ta=0,Ra+=mc)}}catch(nb){m.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return Ra}static yYi(R){R=yd.I7i(R);return 0<R.length&&R.split(" ").length<=yd.l$j?R:null}static n1i(R){let ta="";R&&(R=R.split(" "),0<R.length&&(ta=R[0]));return ta}static Vra(R){return!!R.attributes&&!!R.attributes.atmention}}Object(h.a)(yd,"BaseCommentSmartReplyHelpers",null,[]);
class ib{constructor(R){this.yee=R}awl(R,ta,Ra,nb){-1===Ra||ta||(ta=nb[Ra],Ra=ta.author?ta.author.IsCurrentUser:!1,ta&&ta.commentBody&&!Ra&&(ta=yd.ZVi(ta.commentBody))&&this.yee.invoke(R,ta))}}Object(h.a)(ib,"CommentSmartReplyHelpers",null,[]);var dc=d(52);class Bc{constructor(R,ta,Ra,nb,Cb,mc,Sc,jd,Ad,ve,Ae,Ue,mg,ki,di,lk,Rf){this.A0c=!1;this.Ua=R;this.$Ta=ta;this.Mfe=Ra;this.JWj=nb;this.Bb=Cb;this.kc=mc;this.K3c=Sc;this.WXj=jd;this.Jta=Ad;this.$Cg=ve;this.yee=Ae;this.aZj=Ue;this.gta=mg;this.R3j=
ki;this.PXj=di;this.ia=lk;this.Ha=Rf}beginDraftingAsync(R){if(!R)return new Promise((Ra,nb)=>{nb(H.a.Yt(-2130915327))});const ta=eb.W9f(R.sessionType);return void 0===ta||null===ta?new Promise((Ra,nb)=>{nb(H.a.Yt(-2130915317))}):2===ta&&R.commentId===Bc.mBb?new Promise((Ra,nb)=>{nb(H.a.Yt(-2130915324))}):new Promise((Ra,nb)=>{H.a.Amb(this.Bb,()=>{var Cb=this.Ua.j_d(),mc=null;let Sc=-1;Lb.a.J(593588952,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",ta);try{switch(ta){case 0:if(this.R3j)try{Sc=
this.Ua.Q9f(!0)}catch(Ae){Lb.a.J(51192584,801,10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",Ae),Sc=Cb.length}else Sc=Cb.length;mc=new ie(ta,R,"");this.A0c=!0;break;case 1:if(!R.threadId||!R.threadId.length)throw H.a.Yt(-2130915324);Sc=Bc.S2i(Cb,R.threadId);if(-1===Sc)throw H.a.Yt(-2130915323);if(this.kc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var jd=R.threadId;(new ib(this.yee)).awl(jd,Bc.loj(Cb,jd),Bc.iZd(Cb,jd),Cb)}mc=new ie(ta,R,R.threadId);
break;case 2:if(!R.commentId||!R.commentId.length)throw H.a.Yt(-2130915324);Sc=Bc.iZd(Cb,R.commentId);if(-1===Sc)throw H.a.Yt(-2130915323);mc=new ie(ta,R,R.commentId);break;case 3:Sc=Bc.iZd(Cb,R.threadId);mc=new ie(ta,R,R.threadId);break;default:throw H.a.Yt(-2130915322);}if(!mc)throw H.a.Yt(-2130915322);var Ad=this.Ua.Dtj(mc);if(Ad)throw Ad;}catch(Ae){nb(Ae);return}Cb=new vb;mc=this.kc.Ia("UserName");Ad=this.kc.Ia(dc.a.pa(387));jd=this.kc.Ia(dc.a.pa(388));const ve=Sd.a("PPTPlumbEmailThroughCG")?
Fa.a.$4a(Ad||""):"";Ad=new bc(Ad,jd,mc,ve,!0);Cb.author=Ad;Cb.insertIndex=Sc;Cb.authorName=mc;Cb.authorIdentity=new String;Ra(Cb)})})}commit(R,ta,Ra){if(!this.Ua.sFc)throw Lb.a.J(594358352,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.Ua.Xni),H.a.Yt(-2130915320);var nb=this.Ua.sFc.GB;if(!nb)throw Lb.a.J(594358350,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),H.a.Yt(-2130915320);const Cb=eb.W9f(nb.sessionType);if(void 0===
Cb||null===Cb)throw H.a.Yt(-2130915317);if(R!==nb.draftId)throw H.a.Yt(-2130915327);const mc=this.gta?sd.e(K.a.create().toString()):"";this.Ua.ZVf();switch(Cb){case 0:return Lb.a.J(593830418,805,50,"CommentAPI::Commit - Create Comment {0}",mc),nb={},this.Ua.sPk(mc),nb.commentId=mc,this.A0c=!1,this.Ua.CTg=mc,Bc.pwh(Ra),Bc.owh(),this.createComment(ta,nb,Ra);case 1:return Lb.a.J(593830416,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",nb.threadId,mc),R={},R.parentId=nb.threadId,R.commentId=mc,Bc.pwh(Ra),
Bc.owh(),this.createComment(ta,R,Ra);case 2:return Lb.a.J(593830414,805,50,"CommentAPI::Commit - Edit comment {0}",nb.commentId),Ra={},Ra.commentBody=ta,this.Sql(nb.commentId,Ra),R;case 3:return Lb.a.J(593830412,805,50,"CommentAPI::Commit - Update Metadata {0}",nb.threadId),this.Tql(nb.threadId,Ra),nb.threadId;default:throw H.a.Yt(-2130915322);}}endCommentSession(R){Lb.a.J(593371615,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",R);this.Ua.endCommentSession(R,this.A0c?9:1);this.A0c=!1}createComment(R,
ta,Ra){const nb=this.K3c.wkd(R,new Date);let Cb="";this.gta&&(Cb=Cc.a.Xa(ta.commentId)?K.a.create().toString():ta.commentId);let mc=null;void 0!==Ra&&null!==Ra&&(mc=this.K3c.Cll(Cb,Ra.Task,R));R=this.Ua.Ged;if(Ra=ta.parentId?null:this.Ua.fdj())R=this.Ua.LWk;this.$Ta.AYh(Cb,nb.plainText,ta.parentId,R,this.Ua.anchorNode,nb.xTg,mc,Ra);return Cc.a.Xa(Cb)?Bc.mBb:Cb}deleteComment(R){if(R===Bc.mBb)throw H.a.Yt(-2130915327);Lb.a.J(593830410,805,50,"CommentAPI::DeleteComment - {0}",R);this.$Ta.deleteComment(R)}selectComment(R){R!==
Bc.mBb&&this.Ua.jea(R,0,!1)}highlightComment(R){R!==Bc.mBb&&this.Ua.CXh(R)}szh(R,ta,Ra){const nb=Array.clone(this.Ua.j_d());var Cb=null;for(var mc of nb)if(mc.commentId===R){Cb=mc;break}if(!Cb)throw Lb.a.J(41497052,805,10,"Comment ID not found, UI and model in a mismatched state."),H.a.Yt(-2130915323);(mc=e.AFrameworkApplication.userName)&&0<mc.length&&mc!==Cb.author.DisplayName&&Lb.a.J(40990366,805,50,"Author of comment being edited is not the current user (isAnonymous={0})",e.AFrameworkApplication.yhb||
e.AFrameworkApplication.XP);mc=new Date;Cb=this.K3c.wkd(Cb.commentBody,null).plainText;ta=this.K3c.wkd(ta.commentBody,mc);this.$Ta.EHi(ta.plainText,R,ta.xTg);Ra||Cb!==ta.plainText||this.Mfe.Xhh(nb,this.Ua.CUg,Array.clone(this.Ua.Bag()))}Sql(R,ta){if(R===Bc.mBb)throw H.a.Yt(-2130915327);ta.commentBody&&(this.kc.ka(dc.a.pa(896))?this.szh(R,ta,!0):H.a.Amb(this.Bb,()=>{this.szh(R,ta,!1)}))}Tql(R,ta){if(void 0===ta.Resolve||null===ta.Resolve)throw H.a.Yt(-2130915327);const Ra=ta.Resolve.isResolved;let nb=
Ra?100:0;void 0!==ta.Task&&null!==ta.Task&&(nb=ta.Task.completion);this.$Ta.tzh(R,Ra?1:0,nb);Ra&&this.Ua.GZk()}setThreadResolvedState(R,ta){this.$Ta.tzh(R,ta?1:0,ta?100:0);ta&&this.Ua.eVf(R)}selectFirstThreadInNextCommentContext(){this.Ua.wWk()}selectLastThreadInPreviousCommentContext(){this.Ua.zWk()}presentLinkToComment(R){if(R=this.$Ta.Yaj(R)){R=JSON.stringify({["sId"]:R.sid,["cId"]:R.cid});var ta={};ta.nav=De.a(R);ta.mode="copy";Lb.a.J(557396323,805,50,"PresentLinkToComment: nav:{0}",R);this.ia.Ma(db.a.gPa,
2,ta)}else Lb.a.J(557396322,805,50,"PresentLinkToComment failed")}registerForCommentEvents(R){this.PXj.s5i().then(ta=>{this.Mfe.eJk(R,this.Ua.j_d(),this.Ua.CUg,this.Ua.isReadOnly,this.Ua.Bag(),ta,this.WXj.GUc)})}unregisterForCommentEvents(R){this.Mfe.Qyh(R)}registerForAction(R,ta){this.JWj.Iva(R,ta);this.Ua.tHk()}unregisterForAction(){}loadThreads(){Lb.a.J(40490383,805,10,"LoadThreads is not supported on WAC")}checkAtMentionCapability(){return new Promise(R=>{e.AFrameworkApplication.fa.gf(()=>{this.Jta?
this.Jta.atMentionsEnabledAsync().then(ta=>{R(ta);return null}):R(!1)})})}resolveSupported(){return this.aZj}static S2i(R,ta){let Ra=!1;for(let nb=0;nb<R.length;nb++){if(Ra&&R[nb].commentId!==ta&&R[nb].parentId!==ta)return nb;R[nb].commentId===ta&&(Ra=!0)}return Ra?R.length:-1}static loj(R,ta){let Ra=!1;for(let nb=0;nb<R.length;nb++)if(R[nb].commentId===ta&&(Ra=!0),Ra&&R[nb].parentId===ta)return!0;return!1}static iZd(R,ta){for(let Ra=0;Ra<R.length;Ra++)if(R[Ra].commentId===ta)return Ra;return-1}static owh(){if(Sd.a("CommentsFpsIsEnabled"))try{const R=
Gc.a.instance.Oa("Common.ISystemInitiatedFeedback");R&&R.execute(ta=>{ta.logActivity("PPTWebCommitNewCommentActivity","CommentsFpsIsEnabledBRS")})}catch(R){Lb.a.J(562698251,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",R)}}static pwh(R){if(Sd.a("CommentsTasksFpsIsEnabled")&&R&&R.Task)try{const ta=Gc.a.instance.Oa("Common.ISystemInitiatedFeedback");ta&&ta.execute(Ra=>{Ra.logActivity("PPTWebCommitTaskActivity","CommentsTasksFpsIsEnabledBRS")})}catch(ta){Lb.a.J(560214749,
805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",ta)}}}Bc.mBb="temp-id";Object(h.a)(Bc,"CommentAPI",null,[1235,1236]);var Ob=d(197),yc=d(336),fc=d(669);class Nb{constructor(R,ta,Ra){this.Xdc=R;this.commentId=ta;this.state=Ra}}Object(h.a)(Nb,"CommentTextAnchorToHighlight",null,[]);var lb=d(55),Qc=d(75),Rc=d(31),ld=d(92),Dd=d(93),gd=d(49);class be{constructor(){this.yrd=this.pCd=this.GLa=null;this.Thg=!1;this.wjd=this.xjd=this.endPos=this.startPos=0}get paragraphs(){return this.GLa}get QT(){return this.pCd}set QT(R){this.pCd=
R;this.GLa=[];this.GLa.push(this.pCd)}get V1(){return this.yrd}set V1(R){this.yrd=R;this.GLa&&this.A4b&&this.GLa.push(this.yrd)}BNi(){for(const R of this.GLa){const ta=Object(yb.a)(5,R);if(ta&&-1!==ta.X5a().indexOf("\ufffc"))return!0}return!1}Qwg(R){const ta=(this.wjd&4294967295)>>>0;R.TextBodyLength!==this.xjd||ta===R.TextBodyHash||be.hgh.contains(this.wjd)||(be.hgh.add(this.wjd),Lb.a.J(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",
this.BNi()));return R.TextBodyLength===this.xjd}get x9g(){let R=0;if(this.isValid)if(this.A4b){R+=Rc.ParagraphReader.textLength(this.QT)-this.startPos;R+=this.endPos;for(let ta=1;ta<this.paragraphs.length-1;ta++){const Ra=this.paragraphs[ta];Ra&&(R+=Rc.ParagraphReader.textLength(Ra)+1)}}else R=this.endPos-this.startPos;return R}get TIa(){if(!this.isValid)return ld.a.auto;var R=gd.a.Wj(this.QT,this.startPos+1);if(!R)return ld.a.auto;R=Dd.a.xs(R);return R?(R=R.cache)&&R.w2?R.fontColor:ld.a.auto:ld.a.auto}get isValid(){return!!this.QT&&
!!this.V1&&!!this.paragraphs}get A4b(){return!this.QT.equals(this.V1)}i_h(R){this.GLa&&R&&this.GLa.push(R)}Fyj(){if(this.isValid&&(this.QT.Su(16,!0),this.A4b))for(let R=1;R<this.paragraphs.length;R++){const ta=this.paragraphs[R];ta&&ta.Su(16,!0)}}dCj(R,ta){if(!this.isValid)return!1;const Ra=Object(yb.a)(Qc.AParagraphNode,R.node),nb=Object(yb.a)(Qc.AParagraphNode,ta.node);return!(Ra&&nb&&Array.contains(this.paragraphs,Ra)&&Array.contains(this.paragraphs,nb))||Ra.equals(this.QT)&&(0>R.Qa||R.Qa<this.startPos)||
nb.equals(this.V1)&&(0>ta.Lb||ta.Lb>this.endPos)?!1:!0}n8f(R){let ta=3;R&&(!this.A4b&&this.QT.equals(R)?ta=2:this.QT.equals(R)?ta=0:this.V1.equals(R)&&(ta=1));return ta}}be.hgh=new oa.a;Object(h.a)(be,"TextAnchorParagraphInfo",null,[]);class od{static Jqb(R,ta){return R||ta?R&&ta?R.commentId===ta.commentId:!1:!0}static oIc(R){return!!R.Children&&0<R.Children.length}static c7i(R,ta){R=R.X5a()+"\r";for(let Ra=0;Ra<R.length;Ra++){let nb=R.charCodeAt(Ra);160===nb&&(nb=32);ta=(ta<<5>>>0)+ta+nb}return ta}static TM(R){return!!R&&
!!R.textAnchoringInfo&&R.textAnchoringInfo.EndPos>R.textAnchoringInfo.StartPos&&0<R.textAnchoringInfo.TextBodyLength}static v0b(R,ta){if(!od.TM(R))return null;if(!ta||1>ta.hD().length)return Lb.a.J(574179520,805,ta?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!ta),null;let Ra=null,nb=null,Cb=null;R.textAnchoringInfo.AnchoringShape&&(R.textAnchoringInfo.AnchoringShape.TableCell?(Ra=K.a.ig(R.textAnchoringInfo.AnchoringShape.TableCell.RowId),
nb=K.a.ig(R.textAnchoringInfo.AnchoringShape.TableCell.ColId)):R.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&(Cb=R.textAnchoringInfo.AnchoringShape.SmartArtNodeId,Cb.startsWith("{")||(Cb="{"+Cb),Cb.endsWith("}")||(Cb+="}")));let mc=R.textAnchoringInfo.StartPos;R=R.textAnchoringInfo.EndPos;let Sc=0,jd=0;const Ad=new be;ta=ta.hD();for(let Ae=0;Ae<ta.length;Ae++){const Ue=ta[Ae],mg=Rc.ParagraphReader.textLength(Object(yb.a)(Qc.AParagraphNode,Ue));if(Ra&&nb){var ve=Ue.nK();if(!ve||!Ra.equals(ve.rowId)||
!nb.equals(ve.cellId))continue}else if(Cb&&(!Ue.get_smartArtModelId()||Cb!==Ue.get_smartArtModelId()))continue;if(!Ad.isValid&&(mg>mc||Ad.QT)){if(!Ad.QT&&(Ad.QT=Object(yb.a)(Qc.AParagraphNode,Ue),Ad.startPos=mc,!Ad.QT))return null;ve=Ae===ta.length-1||!!Cb&&od.aHj(Cb,ta[Ae+1])||!!Ra&&!!nb&&od.$Gj(Ra,nb,ta[Ae+1]);ve=mg<R&&0<mg&&ve;if((mg>=R||ve)&&!Ad.V1){if(ve&&(R=mg),Ad.V1=Object(yb.a)(Qc.AParagraphNode,Ue),Ad.endPos=R,!Ad.V1)return null}else Ue.equals(Ad.QT)||Ad.i_h(Object(yb.a)(Qc.AParagraphNode,
Ue))}Sc+=mg+1;jd=od.c7i(Ue,jd);Ad.QT||(mc-=mg+1);R-=mg+1}Ad.xjd=Sc;Ad.wjd=jd;return Ad}static aHj(R,ta){return ta.get_smartArtModelId()&&ta.get_smartArtModelId()===R?!1:!0}static $Gj(R,ta,Ra){return(Ra=Ra.nK())&&R.equals(Ra.rowId)&&ta.equals(Ra.cellId)?!1:!0}static edj(R,ta,Ra,nb){Ra=nb=-1;if(!R)return Lb.a.J(554574735,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),{returnValue:null,zIa:Ra,aBa:nb};let Cb=Object(yb.a)(5,ta.Wa.node);const mc=Object(yb.a)(5,ta.We.node);
if(!Cb||!mc)return Lb.a.J(554574736,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",!Cb,!mc),{returnValue:null,zIa:Ra,aBa:nb};const Sc=ta.Wa.q2a,jd=ta.We.bSb;var Ad=Rc.ParagraphReader.textLength(ta.Wa.node);ta=Rc.ParagraphReader.textLength(ta.We.node);if(0>Sc||0>=jd||Sc===jd&&Cb===mc||Sc>Ad||jd>ta)return Lb.a.J(554574737,805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",
Sc,jd,Ad,ta),{returnValue:null,zIa:Ra,aBa:nb};R=R.hD();if(!R)return Lb.a.J(554574738,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),{returnValue:null,zIa:Ra,aBa:nb};Ad=0;for(const ve of R){if(mc.get_smartArtModelId()){if(ve.get_smartArtModelId()!==mc.get_smartArtModelId())continue;Cb.get_smartArtModelId()!==mc.get_smartArtModelId()&&(Cb=ve)}if(mc.Nr()){if(ve.nK()!==mc.nK())continue;Cb.nK()!==mc.nK()&&(Cb=ve)}Cb===ve&&(Ra=Sc+Ad);mc===ve&&
(nb=jd+Ad);if(0<=Ra&&0<=nb)return{returnValue:Cb,zIa:Ra,aBa:nb};Ad+=ve.X5a().length+1}0<=Ra&&-1===nb&&(Cb.get_smartArtModelId()||Cb.Nr())&&(nb=Ad-1);return{returnValue:Cb,zIa:Ra,aBa:nb}}static get lBc(){return lb.a.ag||lb.a.tRa}static get uIc(){return!lb.a.Ji}}Object(h.a)(od,"CommentUtilities",null,[]);class $d extends Sys.EventArgs{constructor(R){super();this.d5k=R}}Object(h.a)($d,"CommentsVisibilityOnSmartArtChangeEventArgs",Sys.EventArgs,[]);class xf{constructor(R,ta,Ra,nb,Cb,mc,Sc,jd,Ad,ve,Ae){this.MNg=
[];this.v4c=null;this.Ngd=!1;if(!ve)throw Error.argumentNull("appSettingsManager");if(!Ae)throw Error.argumentNull("viewElementEventNotifier");this.Kc=ta;this.$oe=this.gac=!1;this.ZWc=R;this.y5j=Ra;this.YSa=this.ZSa=null;this.el=nb;this.sa=Cb;this.ISa=mc;this.aEa=Sc;this.Gca=jd;this.RXj=Ad;this.kc=ve;this.V3=Ae;this.Gca.ECe(this.RXj)}get ps(){return this.kc.ka("CommentTextAnchoringUIEnabled")}get KM(){return this.ZSa&&this.ZSa.isConnected?this.ZSa:null}get bqh(){return this.gac}wjc(R,ta,Ra=!1,nb=
!1){const Cb=this.y5j.yP(R);if(Cb)switch(ta){case 0:Cb.display(this.ps&&Ra,nb);this.ZSa=R;break;case 1:Cb.activate();this.YSa=R;break;case 2:Cb.dismiss();this.ZSa=null;break;case 3:this.ps&&this.KM&&this.KM===R&&this.e4a&&this.tIc(this.e4a,R)?Cb.display(od.TM(this.e4a),nb):Cb.dismiss();this.YSa=null;break;case 4:Cb.tFi(this.ps&&Ra),this.ZSa=R}}dgd(R){if(this.Kc&&this.Kc.Mc)switch(R){case 0:this.Kc.Mc.highlight();this.gac=!0;break;case 2:this.Kc.Mc.Ayh();this.gac=!1;break;case 1:this.Kc.Mc.highlight();
this.$oe=!0;break;case 3:this.Kc.Mc.Ayh(),this.$oe=!1}}dGc(){this.ZWc&&(this.gac?this.dgd(2):this.KM&&this.wjc(this.KM,2),this.Npb(null))}tIc(R,ta){if(!this.ps||!od.TM(R))return!0;R=this.el.sz();return Ob.a.any(R,Ra=>!od.TM(Ra)&&Ra.anchorShape===ta.get_shapeId())}wGe(R,ta,Ra,nb=!1,Cb=!1){if(this.ZWc&&R&&(!nb||xf.Ypb(this.el.sz(),R))){nb=this.U6(R);if(this.ps||this.KM!==nb||!nb){var mc=(!this.ps||this.KM!==nb)&&!!this.KM;mc&&this.sa.I6(this.KM);this.dGc();if(nb){const Sc=this.ps&&od.TM(R);this.YSa===
nb?this.tIc(R,nb)?this.wjc(nb,4,Sc,this.ps&&Sc&&mc):this.ZSa=nb:this.tIc(R,nb)?this.wjc(nb,0,Sc,Ra&&(!this.ps||mc)):this.ZSa=nb;ta=!!ta&&ta===R.commentId;(Sc||ta)&&Cb||this.eXk(nb,String.format(ResourceStrings.L_CommentAnchoringShapeSelection,R.authorName,R.dt.toDateString(),R.dt.toLocaleTimeString()))}else this.dgd(0),this.Kc&&this.Kc.Mc&&this.Kc.Mc.Ud&&this.Med(String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,(this.Kc.Mc.Ud.Ge+1).toString(),this.Kc.Mc.Ud.title));!Cb&&mc&&this.sa.selectShape(this.KM,
!0,!1)}this.Npb(null)}}BXh(R){if(this.ZWc){var ta=this.U6(R);if(ta){if(this.ps||this.KM!==ta)(this.ps?!od.TM(R):this.tIc(R,ta))?this.wjc(ta,1):this.YSa=ta}else this.dgd(1);this.Npb(R)}}GFc(){this.YSa&&(this.ps||this.YSa!==this.KM)&&this.wjc(this.YSa,3);this.$oe&&!this.gac&&this.dgd(3);this.Npb(null)}U6(R){if(!R)return null;try{return this.aEa.kKc(R)}catch(ta){return Lb.a.J(572663241,805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",ta),null}}Npb(R){const ta=[];var Ra=
this.YSa;R&&!Ra&&(Ra=this.KM);const nb=this.KM?this.KM:this.sa.Dq();nb||R&&Ra||this.nwh(ta);let Cb=null;const mc=[];var Sc=!1;if(od.TM(R)&&Ra&&0<Ra.hD().length&&(!this.e4a||R.commentId!==this.e4a.commentId)){var jd=od.v0b(R,Ra);jd&&jd.isValid&&(Sc=yc.a.ig("{"+R.commentId+"}{1}"),ta.push(new Nb(jd,Sc,1)),Sc=!0,Ra=this.aEa.Nk(Ra))&&(mc.push(Ra),(Ra=Ra.shapeNode)&&Ra.fg&&(Cb=Ra))}if(this.Ngd||nb&&0<nb.hD().length)if(this.sa.wra(),Ra=this.el.sz())for(var Ad of Ra){if(!od.TM(Ad)||!this.Ngd&&Ad.anchorShape!==
nb.get_shapeId()||Sc&&Ad.commentId===R.commentId)continue;jd=this.Ngd?this.U6(Ad):nb;if(!jd)continue;let ve=od.v0b(Ad,jd);if(!ve||!ve.isValid)continue;let Ae=5;(Ra=!!this.e4a&&Ad.commentId===this.e4a.commentId)&&(Ae=0);const Ue=yc.a.ig("{"+Ad.commentId+"}{1}");ta.push(new Nb(ve,Ue,Ae));if(jd=this.aEa.Nk(jd))mc.push(jd),jd=jd.shapeNode,!Cb&&jd&&Ra&&jd.fg&&(Cb=jd)}for(const ve of this.MNg)!ve||Array.contains(mc,ve)||ve.shapeNode&&ve.shapeNode.fg||(ve.o8d=!1,ve.jp||!ve.Bn||ve.wx||ve.EHb());R=null;for(const ve of mc)(Ad=
ve.shapeNode)&&Ad.fg?(R||(R=Ad),Cb||nb!==Ad||(Cb=Ad)):(ve.o8d=!0,ve.Bn||(Lb.a.J(554264394,805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),ve.Kid()));Cb||this.sa.FK()||!R||(Cb=R);this.MNg=mc;this.V3.QBk(new $d(Cb));this.nwh(ta)}nwh(R){R=Object.assign(new fc.a,{action:0,type:0,Iba:R,Cdb:this.Gca.a9a?this.Gca.a9a.Iba:null});this.Gca.tfd(R)}Med(R){this.ISa.Yda(R)}eXk(R,ta){this.ISa.O9g(R,ta)}yHe(R){this.ZWc=R}get e4a(){return this.v4c&&this.v4c.kFb?
this.v4c.kFb.comment:null}static Ypb(R,ta){if(R)for(const Ra of R)if(ta.commentId===Ra.commentId)return!0;return!1}}Object(h.a)(xf,"CommentAnchoringHighlightsHelper",null,[]);var Na=d(40);class xb{constructor(R,ta,Ra,nb,Cb,mc,Sc){this.qc=R;this.ua=ta;this.BYc=Ra;this.tN=nb;this.G5j=Cb;this.Rb=mc;this.Bb=Sc;this.ibf=0}aZa(R,ta){if(R||1!==this.GUc)if(2>this.qc.wj())this.HXh?this.gIe(5):this.gIe(1);else{const Ra=Na.a.Nm("UpdateNextPopulatedContextDetails",2);this.BYc.$Ud((nb,Cb,mc)=>{this.mhk(nb,Cb,
mc,Ra,ta)},Ra)}}get GUc(){return this.ibf}mhk(R,ta,Ra,nb,Cb){let mc=1;if(this.ua.Ca){const Sc=this.ua.Ca.Ge;let jd=!1,Ad=!1,ve=!1;ta&&R&&(R=R.Ge,R<Sc?jd=!0:R===Sc?Ad=!0:(ve=!0,Ra||(jd=!0)));0<=Cb&&(Cb<Sc?jd=!0:Cb===Sc?Ad=!0:ve=!0);ve?mc=jd||Ad?3:2:jd?mc=4:Ad&&(mc=5)}this.gIe(mc);nb.finish();H.a.Amb(this.Bb,()=>{this.Rb.updateCommandUI()})}gIe(R){this.ibf=R;this.G5j.aZa(R,1===this.Rb.mode)}get HXh(){return!!this.ua.Ca&&this.tN.IGi(this.ua.Ca)}}Object(h.a)(xb,"CommentContextDetailsUpdateHelper",null,
[928]);var sc=d(37);class cd{HZk(R){if(null===R)throw Error.argumentNull("comment");R.setValue(sc.a.commentId,"")}DZk(R,ta){if(null===R)throw Error.argumentNull("comment");R.setValue(sc.a.gMd,ta)}FZk(R){if(null===R)throw Error.argumentNull("comment");if(R=Object(yb.a)(1231,R))R.Rob=ResourceStrings.anonymousCommentAuthor}njc(R){if(null===R)throw Error.argumentNull("comment");R.setValue(sc.a.iVb,!0)}Zih(R,ta,Ra,nb){if(null===R)throw Error.argumentNull("comment");if(R=Object(yb.a)(1231,R))R.authorName=
ta,R.RAc=Ra,R.JId=nb}IZk(R,ta){if(null===R)throw Error.argumentNull("comment");R.setValue(sc.a.jVb,ta)}}Object(h.a)(cd,"CommentEditor",null,[1232]);var Ta=d(30),Hb=d(81),oc=d(61);class Oc{constructor(){this.anchorShape=0;this.providerId=this.pos=this.dt=this.commentId=this.Children=this.authorName=null;this.status=0;this.userId=this.textAnchoringInfo=this.text=this.taskInfo=null}}Object(h.a)(Oc,"Comment",null,[]);var Yc=d(294),Qd=d(873),ce=d(447),id=d(28);class gb{constructor(R,ta,Ra,nb,Cb,mc,Sc,
jd,Ad,ve,Ae,Ue,mg,ki){this.mca=null;this.ywb=nb;this.Jb=Cb;this.ua=mc;this.LK=Sc;this.Dja=jd;this.kc=Ad;this.Ib=ve;this.sa=Ae;this.tD=Ue;this.Yee=mg;this.uc=ki;this.rQ=R;this.$Cg=Ra;this.yEg=0===ta;this.$yh();this.Ybe()}dispose(){}get userName(){return this.kc.appSettings.UserName}get userId(){return this.kc.appSettings[dc.a.pa(387)]}get providerId(){return this.kc.appSettings[dc.a.pa(388)]}get O8a(){return this.kc.ka(dc.a.O8a)}get Htg(){return Sd.a("Comments.LogTasksTelemetry")}get kBa(){return this.kc.ka("SlideResizePerfImprovementEnabled")}addComment(R,
ta,Ra){this.Xzf("",R,ta,Ra,null,null,null,null)}AYh(R,ta,Ra,nb,Cb,mc,Sc,jd){this.Xzf(R,ta,Ra,nb,Cb,mc,Sc,jd)}Xzf(R,ta,Ra,nb,Cb,mc,Sc,jd){const Ad=this.rQ.wi("UserAction","AddComment");e.AFrameworkApplication.fa.Uba?this.Zzf(R,ta,Ra,nb,Cb,mc,Sc,jd,Ad):this.kc.gf(()=>{this.Zzf(R,ta,Ra,nb,Cb,mc,Sc,jd,Ad)})}Zzf(R,ta,Ra,nb,Cb,mc,Sc,jd,Ad){this.$Cg.bWb().then(ve=>{gb.Xfh&&(Lb.a.J(523845844,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",this.yEg,ve),this.tD.qTj(ve),gb.Xfh=
!1);this.zYh(R,ta,Ra,nb,Cb,mc,Sc,jd);Ad&&Ad.stop();return ve}).catch(ve=>{Lb.a.J(523845845,805,10,JSON.stringify(ve));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}zYh(R,ta,Ra,nb,Cb,mc,Sc,jd){if(this.$2b()){var Ad=!1,ve=0,Ae=0;nb&&(Ad=!0,ve=nb.x,Ae=nb.y);nb=this.Jb.ie(15);try{var Ue=this.mca;nb.lc(Ue);const mg=Ta.GraphIterator.nb(Ue),ki=Object(yb.a)(Hb.a,this.ywb.createInstance(1074135127));this.Dja.njc(ki);this.Dja.HZk(ki);this.Dja.DZk(ki,R);Ue=null;const di=
Object(yb.a)(1231,ki);if(di){if(di.Tob=Ad)di.Tpa=Object.assign(new Qd.a,{X:ve,Y:Ae});di.evh=this.Yee.Ldj();di.NAc=mc;if(Ue=Object(yb.a)(4,Cb))di.CDc=Ue.get_shapeId();Ra&&(di.qva=Ra);Sc&&(di.taskInfo=Sc);jd&&(di.textAnchoringInfo=jd);di.iAa=ta}let lk=this.userId;Cb=!lk;const Rf=!this.providerId,Kd=!this.userName;(Cb||Rf)&&Lb.a.J(523845847,805,Cb&&!Rf?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",Cb,Rf,Kd);Sd.a("Comments.UseNameInPlaceOfUserId")&&Cb&&!Rf&&(lk=Kd?ResourceStrings.anonymousCommentAuthor:
this.userName);this.Dja.Zih(ki,this.userName,lk,this.providerId);Kd&&this.Dja.FZk(ki);mg.hl(ki,1);Lb.a.J(523845848,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",R,!!Sc,!!jd,!!Ue)}finally{nb&&nb.dispose()}this.KSj(R,Ra,ta,jd,Sc)}else Lb.a.J(523845846,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable")}KSj(R,ta,Ra,nb,Cb){this.Htg?ta?(ta=this.RBa(ta))?(ta=this.fra(ta))?
this.tD.LSj(R,Ra.length-1,!!nb,ta.taskInfo,Cb):Lb.a.J(524100422,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):Lb.a.J(524100421,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):this.tD.MSj(R,Ra.length-1,!!nb,!!Cb):this.tD.Vbe(R,Ra.length-1,!!nb,!!Cb)}deleteComment(R){this.tD.AVj();if(this.$2b()){var ta=this.Jb.xd(15);try{ta.lc(this.mca),this.BQd(R,this.mca),ta.fd=id.a.deleteComment}finally{ta&&ta.dispose()}}else Lb.a.J(523845849,
805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")}BQd(R,ta){Sd.a("IsDeselectShapeOnDeleteCommentEnabled")&&this.sa.w7()&&(Lb.a.J(538714369,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),this.sa.Rh());const Ra=this.vYi(R,ta);if(Ra&&0<Ra.count){this.Dja.njc(ta);for(let nb of Ra)ta=Ta.GraphIterator.nb(nb),ta.oc(39),ta.Hi();Lb.a.J(523845850,805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",R)}else Lb.a.J(523845851,
805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",R);this.tD.LGk()}o4a(){const R=Date.now();this.tD.tTj();const ta=this.sz();if(ta){var Ra=this.Jb.xd(15);try{Ra.lc(this.ua.Ca);for(const nb of ta)this.BQd(nb.commentId,this.mca);Ra.fd=id.a.o4a}finally{Ra&&Ra.dispose()}Lb.a.J(523845853,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-R)}else Lb.a.J(523845852,805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide")}UWb(R){const ta=
Date.now();R?this.tD.uTj():this.tD.sTj();const Ra=this.ua.presentation;if(Ra){var nb=Ra.slides;if(nb){var Cb=this.Jb.xd(15);try{Cb.lc(Ra);for(const mc of nb){const Sc=Object(yb.a)(132,mc);if(!Sc||!Sc.KE()){Lb.a.J(523845854,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",Sc);continue}const jd=Ta.GraphIterator.nb(Sc).yb(16);for(const Ad of this.gra(Sc.KE()))(R?1===Ad.status:1)&&this.BQd(Ad.commentId,jd)}Cb.fd=R?id.a.WWb:id.a.VWb}finally{Cb&&Cb.dispose()}Lb.a.J(523845855,
805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-ta,R)}}}editComment(R,ta){this.IXf(R,ta,null)}EHi(R,ta,Ra){this.IXf(R,ta,Ra)}IXf(R,ta,Ra){if(this.$2b()){var nb=this.RBa(ta);if(nb){const Cb=this.Jb.ie(15);try{Cb.lc(nb);this.Dja.njc(nb);const mc=Object(yb.a)(1231,nb);mc&&(mc.iAa=R,mc.NAc=Ra)}finally{Cb&&Cb.dispose()}Lb.a.J(523845857,805,50,"CommentManager::EditCommentInternal - Edited comment {0}",ta)}else Lb.a.J(523845858,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",
ta);this.tD.yTj()}else Lb.a.J(523845856,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable")}YAb(R,ta){if(this.$2b()){var Ra=this.RBa(R);if(Ra){if(null===ta)throw Error.argumentNull("pos");const nb=this.Jb.ie(15);try{nb.lc(Ra),this.Dja.njc(Ra),Object(yb.a)(1231,Ra).Tpa=Object.assign(new Qd.a,{X:ta.x,Y:ta.y})}finally{nb&&nb.dispose()}Lb.a.J(523845888,805,50,"CommentManager::MoveComment - Moved comment {0}",R)}else Lb.a.J(523845889,805,10,"CommentManager::MoveComment - Failed to find comment node {0}",
R);this.tD.JUj(R)}else Lb.a.J(523845859,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")}tzh(R,ta,Ra){if(this.$2b()){var nb=this.RBa(R);if(nb){const Cb=this.Jb.ie(15);try{Cb.lc(nb),this.Dja.njc(nb),this.Dja.IZk(nb,ta),Object(yb.a)(1231,nb).Jgb=Ra,this.O8a&&this.Dja.Zih(nb,this.userName,this.userId,this.providerId)}finally{Cb&&Cb.dispose()}if(this.Htg){Ra=this.fra(nb);if(!Ra){Lb.a.J(524100423,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");return}1===
ta?this.tD.iVj(!!Ra.taskInfo):0===ta&&this.tD.$Vj(!!Ra.taskInfo)}else 1===ta&&this.tD.jVj();Lb.a.J(523845891,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",R,ta)}else Lb.a.J(523845892,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",R)}else Lb.a.J(523845890,805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}sz(){return this.gra(this.mca)}gra(R){const ta=[];if(!R||39!==R.type)return ta;R=Ta.GraphIterator.nb(R);
for(var Ra=R.Ii();Ra;){if(40===Ra.type){const nb=Object(yb.a)(1231,Ra).qva;Ra=this.fra(Ra);if(nb)for(const Cb of ta)Cb.commentId===nb&&(Cb.Children||(Cb.Children=[]),Cb.Children.push(Ra));else ta.push(Ra)}Ra=R.fp()}return ta}$yh(){const R=this.ua.Ca;this.mca=R?Ta.GraphIterator.nb(R).yb(16):null}S1i(){if(!this.mca)return!1;const R=Ta.GraphIterator.nb(this.mca);if(this.LK.f7f(this.mca))return!0;let ta=R.Ii();for(;ta;){if(this.LK.f7f(ta))return!0;ta=R.fp()}return!1}APi(R,ta){return this.V1f(R,ta,!1)}LPi(R,
ta){return this.V1f(R,ta,!0)}V1f(R,ta,Ra){if(!R)return null;if(R=R.KE()){R=this.Ib.Jc(R);let nb=Ra?R.P0b():R.Ii();for(;nb;){if(!(this.LK.jTc(nb)||ta&&0!==this.LK.MXd(nb)))return this.fra(nb);nb=Ra?R.pCa():R.fp()}}return null}IGi(R){return R?(R=R.KE())?!!this.Ib.Jc(R).Ii():!1:!1}NXd(R){if(!R)return 0;var ta=R.KE();R=0;if(ta){ta=this.Ib.Jc(ta);let Ra=ta.Ii();for(;Ra;)this.LK.jTc(Ra)||R++,Ra=ta.fp()}return R}$2b(){return!!this.mca&&this.mca.isConnected}vYi(R,ta){ta=Ta.GraphIterator.nb(ta);var Ra=ta.Ii();
const nb=new r.a;for(;Ra;){const Cb=this.LK.LXd(Ra),mc=Object(yb.a)(1231,Ra).qva;R!==Cb&&R!==mc||nb.add(Ra);Ra=ta.fp()}return nb}RBa(R){const ta=Ta.GraphIterator.nb(this.mca);let Ra=ta.Ii();for(;Ra;){const nb=this.LK.LXd(Ra);if(R===nb)return Ra;Ra=ta.fp()}return null}b0d(R){R=this.RBa(R);if(!R)return null;const ta=Object(yb.a)(1231,R).qva;return Cc.a.Xa(ta)?R:this.RBa(ta)}fra(R){if(R){const ta=this.LK.LXd(R),Ra=new Oc,nb=Object(yb.a)(1231,R);if(nb){Ra.dt=nb.kFc;Ra.anchorShape=nb.CDc;const Cb=nb.Tpa;
Ra.pos=Object.assign(new Yc.a,{X:Cb.X,Y:Cb.Y});Ra.text=nb.iAa;Ra.authorName=nb.authorName;Ra.userId=nb.RAc;Ra.providerId=nb.JId}Ra.status=this.LK.MXd(R);Ra.commentId=ta;Ra.taskInfo=Object(yb.a)(1231,nb).taskInfo;Ra.textAnchoringInfo=Object(yb.a)(1231,nb).textAnchoringInfo;return Ra}return null}P5a(R){if(!R)return[];const ta=this.gra(R.KE());if(!ta||this.kBa&&!ta.length){if(!ta)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");return ta}ta.sort((Ra,nb)=>{var Cb=
this.uc.w0d(R,Ra.anchorShape);Cb=Cb?Cb.uC:new oc.a(0,0);var mc=this.uc.w0d(R,nb.anchorShape);mc=mc?mc.uC:new oc.a(0,0);Cb.y+=Ra.pos.Y;mc.y+=nb.pos.Y;Cb.x+=Ra.pos.X;mc.x+=nb.pos.X;let Sc=Cb.y-mc.y;Sc||(Sc=Cb.x-mc.x)||(Sc=+Ra.dt-+nb.dt);return Sc});return ta}Yaj(R){var ta=this.ua.presentation;if(!ta)return null;ta=ta.slides;if(!ta)return null;for(const Ra of ta)if(ta=Object(yb.a)(ce.a,Ra))for(const nb of this.gra(ta.KE())){if(R===nb.commentId)return Ra;if(nb.Children)for(const Cb of nb.Children)if(R===
Cb.commentId)return Ra}return null}Ybe(){let R=0,ta=0;var Ra=this.ua.presentation;if(Ra){var nb=Ra.slides;if(nb){Ra=new r.a;for(const Cb of nb)if((nb=Object(yb.a)(ce.a,Cb))&&nb.KE())for(const mc of this.gra(nb.KE()))od.TM(mc)?ta+=1:mc.textAnchoringInfo&&Ra.add(mc.commentId),R+=1;this.tD.Ybe(R,ta,Ra)}}}}gb.Xfh=!0;Object(h.a)(gb,"CommentManager",null,[1233,1234,109]);var pc=d(131);class zc{constructor(R,ta,Ra,nb){this.tN=R;this.Kc=ta;this.Pb=Ra;this.wc=nb}haj(R){if(null===R)throw Error.argumentNull("comment");
if(R=this.kKc(R))if(R=this.Nk(R))return R.za.za;return null}XVi(R){if(null===R)throw Error.argumentNull("comment");if(R=this.kKc(R)){if(R.rd){var ta=this.wc.ZM(R);if(!ta)return Lb.a.J(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",R.get_shapeId()),null;ta=ta.pc(this.Pb.Na);return ta&&ta.htmlElement?pc.a.qba(new Sys.UI.Bounds(ta.htmlElement.clientLeft,ta.htmlElement.clientTop,ta.htmlElement.clientWidth,ta.htmlElement.clientHeight)):(Lb.a.J(595133521,805,
10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",R.get_shapeId()),null)}if(R=this.Nk(R))return R=R.za.za,pc.a.qba(new Sys.UI.Bounds(R.clientLeft,R.clientTop,R.clientWidth,R.clientHeight))}return null}kKc(R){if(null===R)throw Error.argumentNull("comment");if(!R.anchorShape)return null;R=this.tN.b0d(R.commentId);R=this.tN.fra(R);if(!R)return null;const ta=this.Kc.Mc?this.Kc.Mc.Ud:null;return ta?ta.KB(R.anchorShape):(Lb.a.J(557090388,805,50,"ActiveSlide is null"),null)}YVi(R){if(null===
R)throw Error.argumentNull("comment");if(!R.anchorShape)return 0;if(R=this.kKc(R))if(R=this.Nk(R))return R.rotation;return 0}Nk(R){if(null===R)throw Error.argumentNull("shapeNode");return Object(yb.a)(133,R.pc(this.Pb.Na))}}Object(h.a)(zc,"CommentMarkerAnchorHelper",null,[922]);var Ic=d(570),Fc=d(118);class rd{constructor(R,ta,Ra){this.d8=R;this.Kc=ta;this.wee=Ra}HGi(R){const ta=Object(yb.a)(1231,this.wee.RBa(R.commentId));if(!ta)throw m.ULS.sendTraceTag(595203538,805,10,"There is no graph node for comment {0}",
R.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");return!!ta.Tpa}l9i(R,ta){if(!R)throw Error.argumentNull("commentMarkerViewElement");if(!ta)throw Error.argumentNull("comment");if(!this.wee.RBa(ta.commentId))return m.ULS.sendTraceTag(595141910,805,10,"GetRenderingPosition: There is no graph node for comment {0}",ta.commentId),new oc.a(0,Number.MIN_VALUE);const Ra=R.Vq;R=R.c9c;if(!this.HGi(ta)||!ta.pos.X&&!ta.pos.Y){if(Ra)return ta=new oc.a(Ra.$b-Ra.fc-rd.ged.width-rd.Tfh.width,rd.Tfh.height),
rd.khg(ta,Ra,R),ta;if(this.Kc.Mc&&this.Kc.Mc.qC)return new oc.a(this.Kc.Mc.qC.clientWidth-rd.ged.width,0);m.ULS.sendTraceTag(595203537,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");return new oc.a(0,0)}ta=new oc.a(this.d8.Ie(ta.pos.X,0),this.d8.Ie(ta.pos.Y,1));ta=new oc.a(ta._x-rd.eXa._x,ta._y-rd.eXa._y);Ra&&(ta._x=Math.max(0,ta._x),ta._y=Math.max(0,ta._y),ta._x=Math.min(ta._x,Ra.$b-Ra.fc-rd.ged.width),ta._y=Math.min(ta._y,
Ra.Xb-Ra.ic-rd.ged.height),rd.khg(ta,Ra,R));return ta}Uql(R,ta){var Ra=new oc.a(R.element.offsetLeft,R.element.offsetTop);Ra=new oc.a(Ra._x+rd.eXa._x,Ra._y+rd.eXa._y);const nb=R.Vq;nb&&R.c9c%360&&rd.gFf(Ra,0-R.c9c,nb.$f());ta.pos.X=this.d8.yf(Ra._x,0);ta.pos.Y=this.d8.yf(Ra._y,1);this.wee.YAb(ta.commentId,new oc.a(ta.pos.X,ta.pos.Y))}static khg(R,ta,Ra){if(ta&&Ra%360){var nb=new oc.a(R._x+rd.eXa._x,R._y+rd.eXa._y);rd.gFf(nb,Ra,ta.$f());R.update(nb._x-rd.eXa._x,nb._y-rd.eXa._y)}}static gFf(R,ta,Ra){R.pL(0-
Ra._x,0-Ra._y);ta=Ic.a.wQd(ta);R.update(R._x*Math.cos(ta)-R._y*Math.sin(ta)+Ra._x,R._x*Math.sin(ta)+R._y*Math.cos(ta)+Ra._y)}}rd.ged=new Fc.a(20,20);rd.Tfh=new Fc.a(4,4);rd.eXa=new oc.a(4,20);Object(h.a)(rd,"CommentMarkerPositionHelper",null,[923]);var Yd=d(132),me=d(72),Db=d(47);class af{constructor(R,ta){this.UFa=this.lFa=this.Ime=null;this.E6b=R;this.pq=ta}Tu(){return!0}pu(R){if(!R)return!1;this.UFa=this.E6b.element.style;this.Ime=new oc.a(R.clientPoint.x,R.clientPoint.y);this.lFa=new oc.a(parseInt(this.UFa.left),
parseInt(this.UFa.top));this.Xv(R);return!0}Xv(R){if(!R)return!1;R=this.bag(new oc.a(R.clientPoint.x,R.clientPoint.y),this.Ime);this.UFa.left=Db.a.Nc(this.lFa._x+R._x);this.UFa.top=Db.a.Nc(this.lFa._y+R._y);return!0}In(R){if(R){R=this.bag(new oc.a(R.clientPoint.x,R.clientPoint.y),this.Ime);var ta=this.lFa._x+R._x,Ra=this.lFa._y+R._y,nb=this.E6b.Vq;nb&&(ta=Math.max(nb.fc,ta),ta=Math.min(nb.$b-this.E6b.element.clientWidth,ta),Ra=Math.max(nb.ic,Ra),Ra=Math.min(nb.Xb-this.E6b.element.clientHeight,Ra),
R._x=ta-this.lFa._x,R._y=Ra-this.lFa._y);this.UFa.left=Db.a.Nc(ta);this.UFa.top=Db.a.Nc(Ra);this.E6b.DSg(R)}}Jt(){this.UFa.left=Db.a.Nc(this.lFa._x);this.UFa.top=Db.a.Nc(this.lFa._y)}bag(R,ta){R=oc.a.WT(R,ta);return new oc.a(this.pq.jn(R.x),this.pq.jn(R.y))}}Object(h.a)(af,"CommentMarkerDragAdapter",null,[223]);class bg{constructor(R,ta,Ra,nb,Cb,mc,Sc,jd){this.f8=null;this.gTa=this.hTa=!1;if(!ta)throw Error.argumentNull("parentElement");this.fxb=jd;this.W7=R;this.Sp=Ra;this.Rja=nb;this.SB=Cb;this.qYc=
Sc;this.Xl=document.createElement("div");this.Xl.className=od.oIc(R)?this.SB.$Qg:this.SB.ZQg;this.Xl.title=ResourceStrings.L_CommentMarkerTooltip;this.Xl.style.display=this.qYc||this.fxb?"none":"block";this.Xl.setAttribute("data-pptcommentid",String.format("{0}",R.commentId));this.Hz=document.createElement("img");this.Hz.alt=ResourceStrings.L_CommentMarkerTooltip;this.Hz.src=Ra.frame.rk(Ra.frame.NR+".png");this.Hz.setAttribute(Yd.a.ff,Yd.a.St);this.Xl.appendChild(this.Hz);this.WYa();this.frame.jd.pb(rb.a.click,
this.Xl,Object(Ea.a)(this,this.ZC,"clickHandler"));od.uIc&&(cc.a.addHandler(this.Xl,rb.a.Is,Object(Ea.a)(this,this.Iua,"mouseOverHandler")),cc.a.addHandler(this.Xl,rb.a.Wv,Object(Ea.a)(this,this.Jbc,"mouseOutHandler")));od.lBc&&cc.a.addHandler(this.Hz,rb.a.mouseDown,Object(Ea.a)(this,this.wfc,"preventNativeDragMouseDownHandler"));ta.appendChild(this.Xl);mc||this.uOd()}dispose(){this.Hz&&(od.lBc&&cc.a.removeHandler(this.Hz,rb.a.mouseDown,Object(Ea.a)(this,this.wfc,"preventNativeDragMouseDownHandler")),
this.frame.jd.zb(rb.a.click,this.Xl,Object(Ea.a)(this,this.ZC,"clickHandler")),this.Hz.parentNode&&this.Hz.parentNode.removeChild(this.Hz),this.Hz=null);this.Xl&&(od.uIc&&(cc.a.removeHandler(this.Xl,rb.a.Is,Object(Ea.a)(this,this.Iua,"mouseOverHandler")),cc.a.removeHandler(this.Xl,rb.a.Wv,Object(Ea.a)(this,this.Jbc,"mouseOutHandler"))),this.Rja&&(this.Rja.XKd(),this.Rja.cE(this.Xl,this.f8)),this.Xl.parentNode&&this.Xl.parentNode.removeChild(this.Xl));this.Sp=this.W7=null}get comment(){return this.W7}get element(){return this.Xl}get frame(){return this.Sp.frame}uOd(){this.Rja&&
(this.f8=new af(this,Gc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Rja.TI(this.Xl,this.f8))}updatePosition(R){this.Xl.style.left=Db.a.Nc(R._x-(this.Sp.isRightToLeft?this.SB.gre:0));this.Xl.style.top=Db.a.Nc(R._y)}DSg(R){this.Sp.YAb(this.W7,R)}select(R){this.hTa=R;this.WYa()}activate(R){this.gTa=R;this.WYa()}Loh(){}setVisibility(R){this.Xl.style.display=R&&!this.fxb?"block":"none"}WYa(){this.fxb||(this.Hz.className=od.oIc(this.W7)?this.hTa?me.getImageClassWithCluster(this.frame.NR,
this.SB.cRg):this.gTa?me.getImageClassWithCluster(this.frame.NR,this.SB.aRg):me.getImageClassWithCluster(this.frame.NR,this.SB.bRg):this.hTa?me.getImageClassWithCluster(this.frame.NR,this.SB.YQg):this.gTa?me.getImageClassWithCluster(this.frame.NR,this.SB.fre):me.getImageClassWithCluster(this.frame.NR,this.SB.nbc))}get Vq(){return null}get c9c(){return 0}ZC(R){if(R.Sz!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.W7,null,!1,!0,R.Qf,1,!1);R=R.nc;R.preventDefault();R.stopPropagation();
return!0}Iua(){this.frame.nmb(this.W7,1)}Jbc(){this.frame.nmb(null,1)}wfc(R){R.preventDefault()}}Object(h.a)(bg,"LegacyCommentMarkerViewElement",null,[1250]);var Qe=d(96),Af=d(628);class tf{constructor(R,ta,Ra,nb,Cb,mc,Sc,jd,Ad){this.f8=null;this.PEg=this.gTa=this.hTa=!1;if(!ta)throw Error.argumentNull("parentElement");this.W7=R;this.Sp=Ra;this.Rja=nb;this.SB=Cb;this.aEa=mc;this.XWc=Sc;this.qYc=Ad;this.Xl=document.createElement("div");this.Xl.className=od.oIc(R)?this.SB.$Qg:this.SB.ZQg;Sys.UI.DomElement.addCssClass(this.Xl,
"CommentMarker");this.Xl.title=ResourceStrings.L_CommentMarkerTooltip;this.Xl.style.display="none";this.Xl.setAttribute("data-pptcommentid",String.format("{0}",R.commentId));this.Hz=document.createElement("img");this.Hz.alt=ResourceStrings.L_CommentMarkerTooltip;this.Hz.src=Ra.frame.rk(Ra.frame.NR+".png");this.Hz.setAttribute(Yd.a.ff,Yd.a.St);this.Xl.appendChild(this.Hz);this.WYa();this.frame.jd.pb(rb.a.click,this.Xl,Object(Ea.a)(this,this.ZC,"clickHandler"));od.uIc&&(cc.a.addHandler(this.Xl,rb.a.Is,
Object(Ea.a)(this,this.Iua,"mouseOverHandler")),cc.a.addHandler(this.Xl,rb.a.Wv,Object(Ea.a)(this,this.Jbc,"mouseOutHandler")));od.lBc&&cc.a.addHandler(this.Hz,rb.a.mouseDown,Object(Ea.a)(this,this.wfc,"preventNativeDragMouseDownHandler"));ta.appendChild(this.Xl);jd||this.uOd()}dispose(){this.Hz&&(od.lBc&&cc.a.removeHandler(this.Hz,rb.a.mouseDown,Object(Ea.a)(this,this.wfc,"preventNativeDragMouseDownHandler")),this.frame.jd.zb(rb.a.click,this.Xl,Object(Ea.a)(this,this.ZC,"clickHandler")),this.Hz.parentNode&&
this.Hz.parentNode.removeChild(this.Hz),this.Hz=null);this.Xl&&(od.uIc&&(cc.a.removeHandler(this.Xl,rb.a.Is,Object(Ea.a)(this,this.Iua,"mouseOverHandler")),cc.a.removeHandler(this.Xl,rb.a.Wv,Object(Ea.a)(this,this.Jbc,"mouseOutHandler"))),this.Rja&&(this.Rja.XKd(),this.Rja.cE(this.Xl,this.f8)),this.Xl.parentNode&&this.Xl.parentNode.removeChild(this.Xl));this.Sp=this.W7=null}get comment(){return this.W7}get element(){return this.Xl}get frame(){return this.Sp.frame}uOd(){this.Rja&&(this.f8=new af(this,
Gc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Rja.TI(this.Xl,this.f8))}updatePosition(){const R=this.XWc.l9i(this,this.comment);this.Xl.style.left=R._x+"px";this.Xl.style.top=R._y+"px"}DSg(){this.XWc.Uql(this,this.comment)}select(R){this.hTa=R;this.WYa();this.onVisibilityChange()}activate(R){this.gTa=R;this.WYa();this.onVisibilityChange()}Loh(R){this.PEg=R;this.WYa();this.onVisibilityChange()}setVisibility(R){this.qYc=!R;this.onVisibilityChange()}onVisibilityChange(){!this.qYc&&
(this.hTa||this.gTa||this.PEg)?(this.updatePosition(this.frame.mAa(this.comment.pos.X,this.comment.pos.Y)),this.Xl.style.display="block",Qe.a.KH(this.Xl,Af.a.IDc)):(this.Xl.style.display="none",Qe.a.uHa(this.Xl,Af.a.IDc))}get Vq(){return this.aEa.XVi(this.W7)}get c9c(){return this.aEa.YVi(this.W7)}WYa(){this.Hz.className=od.oIc(this.W7)?this.hTa?me.getImageClassWithCluster(this.frame.NR,this.SB.cRg):this.gTa?me.getImageClassWithCluster(this.frame.NR,this.SB.aRg):me.getImageClassWithCluster(this.frame.NR,
this.SB.bRg):this.hTa?me.getImageClassWithCluster(this.frame.NR,this.SB.YQg):this.gTa?me.getImageClassWithCluster(this.frame.NR,this.SB.fre):me.getImageClassWithCluster(this.frame.NR,this.SB.nbc)}ZC(R){if(R.Sz!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.W7,null,!1,!0,R.Qf,1,!1);R=R.nc;R.preventDefault();R.stopPropagation();return!0}Iua(){this.Hz.className=me.getImageClassWithCluster(this.frame.NR,this.SB.fre)}Jbc(){this.Hz.className=me.getImageClassWithCluster(this.frame.NR,
this.SB.nbc)}wfc(R){R.preventDefault()}}Object(h.a)(tf,"ModernCommentMarkerViewElement",null,[1250]);class uf{constructor(R,ta,Ra,nb,Cb,mc){this.aEa=R;this.XWc=ta;this.SB=Ra;this.F7b=Cb;this.fxb=mc;nb.bWb().then(Sc=>{Sc||this.WIe(!1)})}dispose(){this.SB=null}create(R,ta,Ra,nb,Cb,mc){if(this.F7b){const Sc=this.aEa.haj(R);return new tf(R,Sc||ta,Ra,nb,this.SB,this.aEa,this.XWc,Cb,mc)}return new bg(R,ta,Ra,nb,this.SB,Cb,mc,this.fxb)}WIe(R){this.fxb=this.F7b=R;this.SB.WIe(R)}}Object(h.a)(uf,"CommentMarkerViewElementFactory",
null,[924,109]);var kg=d(78);class Lg extends kg.a{constructor(){super()}w4h(R){this.addHandler(Lg.Drh,R)}hUg(){this.raiseEvent(Lg.Drh)}}Lg.Drh="S";Object(h.a)(Lg,"ATransactionCompletedProcessor",kg.a,[1251]);var $g=d(36);class yf extends Lg{constructor(R,ta,Ra){super();this.E7j=R;this.RYc=ta;this.jta=Ra}get index(){return 0}run(){this.E7j()}zOf(R,ta){ta.property!==sc.a.Tpa&&ta.property!==sc.a.iAa&&ta.property!==sc.a.commentId&&ta.property!==sc.a.iVb&&ta.property!==sc.a.jVb&&ta.property!==sc.a.Llc&&
ta.property!==sc.a.Klc||this.hUg()}jOf(R,ta){ta.property!==$g.a.rA&&ta.property!==sc.a.iVb||this.hUg()}rqj(){this.RYc.Cd(39).yk(Object(Ea.a)(this,this.jOf,"commentContentPropertyChanged"));this.RYc.Cd(40).yk(Object(Ea.a)(this,this.zOf,"commentPropertyChanged"));this.jta.gZk(this)}Rol(){this.RYc.Cd(40).Pm(Object(Ea.a)(this,this.zOf,"commentPropertyChanged"));this.RYc.Cd(39).Pm(Object(Ea.a)(this,this.jOf,"commentContentPropertyChanged"))}}Object(h.a)(yf,"CommentPropertyTracker",Lg,[]);var Kf=d(892),
dd=d(128);class lg extends Kf.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new dd.a,{T_:lg.getTypeName(),B_:lg.jl()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static jl(){return["AugLoop_Signals_Signal"]}}Object(h.a)(lg,"CommentSmartReplySignal",Kf.a,[]);var Wh=d(596);class Gd extends Wh.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new dd.a,
{T_:Gd.getTypeName(),B_:Gd.jl()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static jl(){return["AugLoop_Core_Annotation"]}}Object(h.a)(Gd,"SmartReply",Wh.a,[]);var Se=d(456),hj=d(425);class cg{constructor(R,ta){this.HHh=R;this.QVe=ta}initialize(){this.QVe.execute(R=>{const ta=Gd.getTypeName();R.mmb(ta);R.jhc(ta,Object(Ea.a)(this,this.mQa,"handleAnnotationEvent"))})}invoke(R,ta){const Ra=Object.assign(new Se.a,{parentPath:["Signal",lg.getTypeName()],items:[Object.assign(new hj.a,{body:Object.assign(new lg,
{commentId:R,comment:ta})})]});this.QVe.execute(nb=>{nb.submitOperation(Ra)})}mQa(R){if(R){var ta=new r.a;if(R&&R.CommentId&&R.ResultSets&&0<R.ResultSets.length&&R.ResultSets[0].Documents&&0<R.ResultSets[0].Documents.length){for(const Ra of R.ResultSets[0].Documents)ta.add(Ra.Caption);0<ta.count&&this.HHh.juk(R.CommentId,ta.toArray())}else Lb.a.J(557593412,327,10,"Invalid response from SmartReplies request")}else Lb.a.J(557593411,327,50,"Smart reply invocation returned null annotations.")}}Object(h.a)(cg,
"CommentSmartReplyProvider",null,[]);var ed=d(307),Xg=d(282),Dh=d(279),Qf=d(97),Yb=d(179),li=d(139),re=d(64),lf=d(365);class Id{constructor(R,ta,Ra,nb,Cb){this.zee=this.gfe=this.Ffe=this.fWc=0;this.cDg=new r.a;this.Upe=this.kDg=this.Bee=this.F$b=this.jme=0;this.One=new r.a;this.Vce=this.Uce=this.Wce=this.Tce=0;this.ABg=new r.a;this.y2c=new r.a;this.efe=this.cfe=this.dfe=this.ffe=this.tje=this.sje=this.uje=this.vje=0;this.iWc=this.rie=this.$Wc=Ub.App.Bm;this.UTa=null;this.Ppe=this.Qpe=this.w3c=this.R3c=
this.Q1c=this.Sce=0;if(!R)throw Error.argumentNull("coreEventHandler");if(!ta)throw Error.argumentNull("appSettingsManager");this.Oc=R;this.kc=ta;this.ua=Ra;this.LK=nb;this.uee=Cb;this.Oc.xB(Object(Ea.a)(this,this.eo,"onSessionRehydrated"));this.Oc.wB(Object(Ea.a)(this,this.ZA,"onSessionEnd"))}get RMd(){return this.kc.ka("CommentTextAnchoringCreateNewEnabled")}get Uhl(){return this.kc.ka("TasksForCommentsEnabled")}Vbe(R,ta,Ra,nb){this.fWc+=1;this.zee+=ta;Ra&&(this.Tce+=1,this.One.add(R));nb&&(this.Sce+=
1)}MSj(R,ta,Ra,nb){this.w3c=nb?this.w3c+1:this.w3c;this.Vbe(R,ta,Ra,nb)}LSj(R,ta,Ra,nb,Cb){(Cb=!!Cb)&&nb?this.Qpe+=1:Cb&&(this.Ppe+=1);this.Vbe(R,ta,Ra,Cb)}MVj(){this.Wce+=1}JVj(){this.Uce+=1}KVj(){this.Vce+=1}LVj(R,ta,Ra,nb){this.qtg(R.commentId)||(Ra&&!this.AMj(ta,Ra.hD(),nb)?this.DAg(R,Ra,!0):this.DAg(R,Ra,!1))}LGk(){this.gfe+=1}AVj(){this.ffe+=1}tTj(){this.dfe+=1}sTj(){this.cfe+=1}uTj(){this.efe+=1}yTj(){this.Ffe+=1}JUj(R){this.cDg.contains(R)||(this.jme+=1,this.cDg.add(R))}iVj(R){this.Q1c=R?
this.Q1c+1:this.Q1c;this.F$b+=1}$Vj(R){this.R3c=R?this.R3c+1:this.R3c}jVj(){this.F$b+=1}Ybe(R,ta,Ra){this.Bee=R;this.Upe=ta;this.ABg=Ra;this.oAg()}qTj(R){this.kDg=R?1:2}Wfk(R){this.$Wc===Ub.App.Bm&&(this.$Wc=new Date,this.LDa("OnCollabCornerCommentsEnabled",this.$Wc,R),this.SGe("CollabCornerCommentsEnabled",this.$Wc))}qhk(R){this.rie===Ub.App.Bm&&(this.rie=new Date,this.LDa("OnFloatingCommentsRendered",this.rie,R))}Vek(R){this.iWc===Ub.App.Bm&&(this.iWc=new Date,this.LDa("OnAllFloatingContainersVisible",
this.iWc,R),this.SGe("AllFloatingContainersVisible",this.iWc))}tgk(R){const ta=new Date;this.LDa("OnDeepLinkedCommentSelected",ta,R);this.SGe("DeepLinkedCommentSelected",ta)}qtg(R){return this.ABg.contains(R)||this.y2c.contains(R)}AMj(R,ta,Ra){let nb=0;for(const mc of ta)if(ta=Object(yb.a)(735,mc.pc(Ra))){ta=ta.htmlElement.getElementsByClassName(Qf.a.wWb);for(let Sc=0;Sc<ta.length;Sc++){var Cb=ta[Sc];const jd=ed.a.te(Cb,Qf.a.PMd);jd&&(nb+=Ob.a.contains(jd,R)?1:0);(Cb=ed.a.te(Cb,Qf.a.LMd))&&(nb+=Ob.a.contains(Cb,
R)?1:0);if(2===nb)return!0}}return!1}DAg(R,ta,Ra){if(R&&R.textAnchoringInfo&&!this.qtg(R.commentId))if(R.textAnchoringInfo.EndPos<=R.textAnchoringInfo.StartPos){if(ta){if(Ra){this.tje+=1;this.y2c.add(R.commentId);return}this.uje+=1}else this.vje+=1;this.y2c.add(R.commentId)}else 0>=R.textAnchoringInfo.TextBodyLength&&(this.One.contains(R.commentId)?this.One.remove(R.commentId):(this.sje+=1,this.y2c.add(R.commentId)))}LDa(R,ta,Ra){const nb={};nb.Event=R;nb.Time=ta.getTime();nb.SlideId=Ra.toString();
nb.LandingSlide=this.E3i();nb.SessionDimensions=this.n0d();nb.PerfMetrics=this.jWi();nb.CommentPerfMetrics=this.xYi();nb.CommentFileType=this.uee;nb.CommentDeepLinkedOpen=!!this.kc.Ia("CurrentCommentId");nb.StandaloneCommentJsEnabled=!0;nb.LoadSharedCommentsEarly=!0;nb.FetchFullAppSettingsOnBoot=this.kc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FetchFullAppSettingsOnBoot",!1);nb.PrefetchCommentCloudPolicy=this.kc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PrefetchCommentCloudPolicy",
!1);Lb.a.J(523845836,805,15,mb.c(nb))}oAg(){Lb.a.J(523845837,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",this.Bee,this.uee);Lb.a.J(523845838,805,15,"Text Anchor(s) - OnOpen:{0}",this.Upe);Lb.a.J(523845839,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",this.RMd,this.Uhl)}log(){Lb.a.J(523845840,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",this.fWc,
this.Ffe,this.gfe,this.zee/this.fWc,this.jme,this.F$b,this.Bee,this.uee,this.kDg);Lb.a.J(523845841,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",this.Upe,this.Tce,this.Wce,this.Uce,this.Vce,this.uje,this.sje,this.vje,this.tje);Lb.a.J(523845842,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.ffe,this.dfe,this.cfe,this.efe);
this.HVj()}HVj(){Lb.a.J(523845843,845,15,"Task(s) - Added:{0}",this.Sce);const R={};R.ResolvedTasksCount=this.Q1c;R.UnresolvedTasksCount=this.R3c;R.TasksCreatedNewThreadCount=this.w3c;R.TasksReassignedInReplyCount=this.Qpe;R.TasksCreatedInReplyCount=this.Ppe;Lb.a.J(524100420,845,15,mb.c(R))}eo(){this.oAg()}ZA(){this.log()}E3i(){if(this.UTa)return this.UTa;this.UTa={};var R=parseInt(this.kc.Ia("CurrentSlideId"));R=R!==re.a.empty.sid?re.a.XD(R,0):this.ua.presentation.Asb(0);if(!R)return this.UTa;this.UTa.SlideId=
R.toString();if(R=this.ua.presentation.E0d(R.sid))R=Object(yb.a)(132,R).KE(),this.UTa.HasComments=this.LK.Rhg(R),this.UTa.HasActiveComments=this.LK.Fhg(R);return this.UTa}n0d(){const R={};R.Ring=e.AFrameworkApplication.Zc.Ring;R.Host=e.AFrameworkApplication.Zc.Host;R.UiHost=e.AFrameworkApplication.Zc.UiHost;R.SessionOrigin=e.AFrameworkApplication.Zc.SessionOrigin;R.ApplicationMode=e.AFrameworkApplication.Zc.ApplicationMode;R.Browser=e.AFrameworkApplication.Zc.Browser;R.Os=e.AFrameworkApplication.Zc.Os;
return R}jWi(){const R={};R[Xg.a.qJb]=fb.a.instance.Rg(Xg.a.qJb);R.DocPageNavigationStart=fb.a.instance.Rg("DocPageNavigationStart");R[Xg.a.xZb]=fb.a.instance.Rg(Xg.a.xZb);R[lf.a.vEe]=fb.a.instance.Rg(lf.a.vEe);R[lf.a.uEe]=fb.a.instance.Rg(lf.a.uEe);R[lf.a.tEe]=fb.a.instance.Rg(lf.a.tEe);R[lf.a.OTd]=fb.a.instance.Rg(lf.a.OTd);R[lf.a.PTd]=fb.a.instance.Rg(lf.a.PTd);R[lf.a.NTd]=fb.a.instance.Rg(lf.a.NTd);R[lf.a.OLd]=fb.a.instance.Rg(lf.a.OLd);R[Xg.a.Bmd]=0<Dh.a.instance.r$g();return R}xYi(){const R=
{};R[Pb.a.OMd]=fb.a.instance.Rg(Pb.a.OMd);R[Pb.a.TMd]=fb.a.instance.Rg(Pb.a.TMd);R[Pb.a.l2b]=fb.a.instance.Rg(Pb.a.l2b);R[Pb.a.q5d]=fb.a.instance.Rg(Pb.a.q5d);R[Pb.a.GJe]=fb.a.instance.Rg(Pb.a.GJe);R[Pb.a.B2b]=fb.a.instance.Rg(Pb.a.B2b);R[Pb.a.r5d]=fb.a.instance.Rg(Pb.a.r5d);R[Pb.a.Fbe]=fb.a.instance.Rg(Pb.a.Fbe);R[Pb.a.BVd]=fb.a.instance.Rg(Pb.a.BVd);R[Pb.a.CVd]=fb.a.instance.Rg(Pb.a.CVd);R[Pb.a.Fgd]=fb.a.instance.Rg(Pb.a.Fgd);R[Pb.a.NOd]=fb.a.instance.Rg(Pb.a.NOd);R[Pb.a.MOd]=fb.a.instance.Rg(Pb.a.MOd);
return R}$$i(){const R=fb.a.instance.Rg("DocPageNavigationStart");if(!fb.a.instance.Rg(Xg.a.qJb))return R;const ta=fb.a.instance.Rg(Xg.a.qJb);return 6E4>R-ta?ta:R}SGe(R,ta){const Ra=[];Array.add(Ra,Object.assign(new li.a,{name:"EventName",string:R}));Sb.a.sendActivityEvent(Object.assign(new Yb.a,{name:"CommentsBootEvents",durationMs:ta.getTime()-this.$$i(),dataFields:Ra}))}}Object(h.a)(Id,"CommentTelemetryManager",null,[1230]);var We=d(666),Wc=d(667),Xc=d(668);class Ld extends We.a{constructor(R,
ta){super();this.g0j=R;this.vi=ta;this.Uie=[new Wc.a(Qf.a.mOf,null),new Wc.a(Qf.a.nOf,null),new Wc.a(Qf.a.oOf,null),new Wc.a(Qf.a.rOf,null),new Wc.a(Qf.a.vOf,null),new Wc.a(Qf.a.wOf,null),new Wc.a(Qf.a.uOf,null),new Wc.a(Qf.a.pOf,null),new Wc.a(Qf.a.qOf,null),new Wc.a(Qf.a.sOf,null),new Wc.a(Qf.a.tOf,null)]}get isInHighContrastMode(){return!!this.vi&&this.vi.isInHighContrastMode}get etb(){return this.g0j}get b4d(){return this.Uie}adc(R,ta){var Ra=this.hZ.jha;if(Ra&&0===Ra.type&&(Ra=this.hZ.jha.Iba,
Ra=Object(v.a)(Array,Ra)?Ra:null)){var nb=null,Cb=null,mc=new Ja.a;for(const Sc of Ra)Sc.Xdc.isValid&&Array.contains(Sc.Xdc.paragraphs,R)&&(0===Sc.state?nb=Sc.commentId:1===Sc.state&&(Cb=Sc.commentId),mc.$(Sc.commentId,Sc.Xdc));this.N7h(ta.querySelectorAll("*"),mc,R,nb,Cb)}}G2b(R,ta){R=Object(v.a)(Array,R)?Array.isArray(R)?R:null:null;if(!R||0<R.length&&!Object(yb.a)(Nb,R[0]))return ta;for(const Ra of R)if(Ra.Xdc.isValid)for(const nb of Ra.Xdc.paragraphs)nb&&(Xc.b(nb),ta.add(nb));return ta}xNi(R,
ta){R=R.TIa;const Ra=ta?Ld.iYj:Ld.jYj;ta=ld.a.X6f(R,ta?Ld.X1j:Ld.Y1j);R=ld.a.X6f(R,Ra);return ta<R}N7h(R,ta,Ra,nb,Cb){const mc=new oa.a,Sc=new oa.a;for(let ve=0;ve<R.length;ve++){const Ae=R[ve];this.jcd(Ae);if(!Ae.parentNode)continue;var jd=ed.a.te(Ae,Qf.a.PMd),Ad=ed.a.te(Ae,Qf.a.LMd);const Ue=[!1,!1,!1];if(jd)for(const mg of jd)if(ta.Kb(mg)){jd=ta.ga(mg).n8f(Ra);if(ta.ga(mg).Thg||(2===jd||0===jd)&&!this.isInHighContrastMode&&this.xNi(ta.ga(mg),mg===Cb))ta.ga(mg).Thg=!0,mc.add(mg);Sc.add(mg);this.rVf(ta,
Ra,mg,nb,Cb,Ue,!0)}if(Ad)for(const mg of Ad)Sc.contains(mg)&&(Sc.remove(mg),mc.remove(mg),this.rVf(ta,Ra,mg,nb,Cb,Ue,!1));if(0!==Xc.a(Ae)){Ad=(jd=0<mc.count)&&!!Cb&&mc.contains(Cb);const mg=!!nb&&Sc.contains(nb),ki=!!Cb&&Sc.contains(Cb);0<Sc.count&&!this.isInHighContrastMode&&0<=Ae.parentNode.className.indexOf(Qf.a.UIa)&&(Qe.a.KH(Ae.parentNode,Qf.a.mOf),ki?Qe.a.KH(Ae.parentNode,Ad?Qf.a.qOf:Qf.a.pOf):mg?(Qe.a.KH(Ae.parentNode,Qf.a.nOf),jd=Ae.parentNode.className.match(new RegExp("\\b"+Qf.a.njg+"\\b")),
(!jd||1>jd.length)&&Qe.a.KH(Ae.parentNode,Qf.a.oOf)):Qe.a.KH(Ae.parentNode,jd?Qf.a.wOf:Qf.a.vOf));Ue[1]?Qe.a.KH(Ae,Ad?Qf.a.tOf:Qf.a.sOf):Ue[0]?Qe.a.KH(Ae,Qf.a.rOf):Ue[2]&&Qe.a.KH(Ae,Qf.a.uOf)}}}rVf(R,ta,Ra,nb,Cb,mc,Sc){R=R.ga(Ra).n8f(ta);if(2===R||(Sc?0===R:1===R))nb&&nb.equals(Ra)&&(mc[0]=!0),Cb&&Cb.equals(Ra)&&(mc[1]=!0),mc[2]=!0}}Ld.Y1j="#F5E7F6";Ld.jYj="#503355";Ld.X1j="#F2E1F4";Ld.iYj="#4C3050";Object(h.a)(Ld,"CommentTextAnchorHighlightActor",We.a,[]);class Xf{constructor(R){let ta;this.HOh=
20;ta=R?R="SharedCommentBubble":R="SharedCommentBubbleSelected";this.COh=this.mPa("SharedCommentBubble");this.BOh=this.mPa("SharedCommentBubbleHover");this.Qcf=this.mPa(R);this.GOh=this.mPa("SharedCommentBubble");this.FOh=this.mPa("SharedCommentBubbleHover");this.Rcf=this.mPa(ta);this.DOh="ModernCommentMarkerElementSingle cui-img-cont-float";this.EOh="ModernCommentMarkerElementWithReplies cui-img-cont-float"}get ZQg(){return this.DOh}get $Qg(){return this.EOh}get gre(){return this.HOh}get nbc(){return this.COh}get fre(){return this.BOh}get YQg(){return this.Qcf}get bRg(){return this.GOh}get aRg(){return this.FOh}get cRg(){return this.Rcf}WIe(R){const ta=
R?this.nbc:"SharedCommentBubbleSelected";R=R?this.nbc:ta;this.Qcf=this.mPa(ta);this.Rcf=this.mPa(R)}mPa(R){return String.format("{0}_{1}x{2}x32",R,this.gre,this.gre)}}Object(h.a)(Xf,"CommentViewHelper",null,[]);class Le{constructor(R,ta,Ra,nb,Cb,mc){this.Oc=R;this.ua=ta;this.Bb=Ra;this.XLg=nb;this.Ua=mc;this.XLg.ZF(Object(Ea.a)(this,this.j8c,"onSlideOrderChanged"));this.Oc.l1h(Object(Ea.a)(this,this.qWg,"onCommentsChanged"))}dispose(){this.Oc.pMk(Object(Ea.a)(this,this.qWg,"onCommentsChanged"));this.XLg.kO(Object(Ea.a)(this,
this.j8c,"onSlideOrderChanged"))}qWg(){const R=this.ua.Ca;H.a.Amb(this.Bb,()=>{this.Buk(R)})}j8c(R,ta){if(2===ta.GY){const Ra=this.ua.Ca;H.a.Amb(this.Bb,()=>{this.i4g(Ra)})}}i4g(R){this.ua.Ca===R&&R&&this.Ua.aZa(!0)}Buk(R){this.i4g(R)}}Object(h.a)(Le,"CommentsChangeListener",null,[109]);var md=d(150),oj=d(276),Ie=d(178);class qh{static sAa(R,ta,Ra,nb,Cb,mc,Sc){const jd=Db.a.FB();jd.alt=mc;jd.className=me.getImageClassWithCluster(ta,Cb);jd.setAttribute(Yd.a.ff,Yd.a.St);jd.src=R.rk(ta+".png");jd.setAttribute("Unselectable",
"on");R=Db.a.tn();R.className=Ra+" cui-img-cont-float";R.setAttribute(Yd.a.ff,Yd.a.St);R.appendChild(jd);Ra=Db.a.tn();Ra.className=nb;Ra.setAttribute("Unselectable","on");Ra.setAttribute(Yd.a.ff,Yd.a.St);Ra.appendChild(R);nb=Db.a.Raa();nb.className=qh.QTk+" cui-ctl";nb.title=mc;nb.setAttribute(Yd.a.ff,Yd.a.St);nb.setAttribute(Yd.a.ht,mc);nb.appendChild(Ra);Sc&&(mc=Db.a.tn(),mc.className="cui-ctl-mediumlabel",mc.setAttribute("Unselectable","on"),mc.setAttribute(Yd.a.ff,Yd.a.St),mc.innerText=Sc,nb.appendChild(mc));
return nb}static tAa(R,ta){return qh.sAa(R,R.NR,"cui-img-16by16","cui-ctl-iconContainer",ta,CommonUIStrings.l_DialogClose,null)}}qh.OTk="CommentPaneLTR";qh.PTk="CommentPaneRTL";qh.QTk="CommentPaneWithBorderButton";qh.dUk=300;Object(h.a)(qh,"CommentPaneHelper",null,[]);var Od=d(46);class ef{constructor(R,ta,Ra,nb,Cb){this.d8b=this.EFa=null;new oj.a(0,0,0,0);this.FTa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.dDg=null;this.tnh=!1;this.IG=Cb;
this.uI=R;this.Rb=ta;this.IG||(this.EFa=document.createElement("div"),this.EFa.className="CommentPanel",this.EFa.style.position="absolute");this.Sb=!1;this.uW=Ra;this.XOg=nb}dispose(){}layout(R,ta){if(this.FTa)return R;if(null===R)throw Error.argumentNull("availableArea");const Ra=ta?R.CF(this.width):R.DF(this.width);this.isVisible&&(ta?Ra.CF(1):Ra.DF(1));this.IG||Db.a.b0(this.EFa,Ra);return R}o4d(R){this.d8b=R}JZk(R){this.dDg=R}Uo(R,ta){this.Sb=R;this.FTa?this.IG?this.ML(this.Sb):this.XOg.ML(this,
this.Sb,ResourceStrings.L_Comments,Od.a.Ep):(this.Rb.zBb(this.uW&&ta?1:2),this.uI.updateCommandUI())}ML(R){md.UISurfaces.du().then(ta=>{R?ta.showTaskPane(Od.a.Ep,this.dDg):ta.hideTaskPane(Od.a.Ep,2);return null}).catch(ta=>{Lb.a.J(572339907,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",ta.toString(),R.toString())})}KGe(){md.UISurfaces.du().then(R=>{R.setSelectedTaskPane(Od.a.Ep);return null}).catch(R=>{Lb.a.J(572339909,833,10,"CommentsPane::SelectPane exception: {0}",R.toString())})}sWk(){try{this.IG?
this.KGe():this.XOg.KGe(Od.a.Ep)}catch(R){Lb.a.J(592591050,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",R)}}zBb(R){this.Rb.zBb(this.uW&&R?1:2)}get isVisible(){return this.Sb}get za(){return this.EFa}get order(){return 18}get width(){return this.isVisible?qh.dUk+1:0}}Object(h.a)(ef,"CommentsPane",null,[929,454,109,959]);class dh{constructor(){this.RWa=this.AIa=0;this.Vc=this.sXa=this.Zga=null}}Object(h.a)(dh,"FindCommentContext",null,[]);var ad;(function(R){R[R.findNextComment=
0]="findNextComment";R[R.findPreviousComment=1]="findPreviousComment";R[R.findNextActiveComment=2]="findNextActiveComment";R[R.findPreviousActiveComment=3]="findPreviousActiveComment"})(ad||(ad={}));Object(h.b)("FindCommentRequestType",ad);class Fg{constructor(R,ta,Ra,nb,Cb,mc){this.qc=R;this.ua=ta;this.lie=Ra;this.tN=nb;this.HHg=Cb;this.Qb=new dh;this.NZj=mc}get hAa(){return this.NZj.value}dispose(){this.lie.dispose();this.Qb=this.lie=null}ZUd(R,ta,Ra){this.VUd(0,!1,R,ta,Ra)}fVd(R,ta,Ra){this.VUd(1,
!1,R,ta,Ra)}$Ud(R,ta){this.VUd(0,!0,R,ta,!1)}VUd(R,ta,Ra,nb,Cb){var mc=this.ua.presentation;if(!mc)throw Error.argumentNull("Presentation is null");nb||(nb=Na.a.Nm("FindComment",0),nb.Ya("FindCommentRequestType",ad[R]));nb.Ya(Fg.hKd,"true");if(this.HHg&&this.ua.Ca){if(!this.ua.Ca)throw Error.argumentNull("ActiveSlide is null");const Sc=this.ua.Ca.Ge;mc=mc.slides||[];this.Qb.Zga=Ra;this.Qb.RWa=Fg.e1i(R,Cb);this.Qb.Vc=nb;ta?this.WUd(mc[Sc>=mc.length-1?0:Sc+1]):1===R?this.j2f(mc,Sc-1,Cb):this.g2f(mc,
Sc+1,Cb)}else nb.Ya(Fg.Tei,this.HHg.toString()),Ra(null,null,!1,!1)}g2f(R,ta,Ra){this.Qb.sXa=null;this.Qb.AIa=ta;for(let nb=ta;nb<R.length;nb++)if(R[nb]&&this.ewg(R[nb])){const Cb=this.j1i(R[nb],Ra);if(Cb){this.Qb.Zga(R[nb],Cb,!1,!1);return}}else{this.WUd(R[nb]);return}0<ta?this.OPi(Ra):this.notFound()}j2f(R,ta,Ra){this.Qb.sXa=null;this.Qb.AIa=ta;for(let nb=ta;-1<nb;nb--)if(R[nb]&&this.ewg(R[nb])){const Cb=this.K3i(R[nb],Ra);if(Cb){this.Qb.Zga(R[nb],Cb,!1,!1);return}}else{this.WUd(R[nb]);return}ta<
R.length-1?this.WPi(Ra):this.notFound()}WUd(R){this.Qb.Vc.Dm(Fg.yfi,new Date);R&&this.lie.find(R.Cb,this.Qb.RWa,Object(Ea.a)(this,this.tlk,"onServerFindSucceeded"),Object(Ea.a)(this,this.slk,"onServerFindFailed"))}tlk(R){this.Qb.Vc.fB(Fg.hKd,"false");this.Qb.Vc.Dm(Fg.BJf,new Date);this.Qb.Vc.Ya(Fg.jJf,"true");R?(this.Qb.sXa=R,-1===this.d0b(this.Qb.sXa.TargetSlideId)?this.notFound():this.Qb.Zga(this.Wjl(this.Qb.sXa.TargetSlideId),this.Qb.sXa.TargetComment,this.Qb.sXa.IsFirstComment,this.Qb.sXa.IsLastComment)):
this.notFound()}slk(){this.Qb.Vc.fB(Fg.hKd,"false");this.Qb.Vc.Dm(Fg.BJf,new Date);this.Qb.Vc.Ya(Fg.jJf,"false");Lb.a.J(25011742,805,50,"OnServerFindFailed");this.notFound()}OPi(R){var ta=this.ua.presentation;if(!ta)throw Error.argumentNull("Presentation is null");ta=ta.slides||[];Ob.a.Xa(ta)?this.notFound():this.g2f(ta,0,R)}WPi(R){var ta=this.ua.presentation;if(!ta)throw Error.argumentNull("Presentation is null");ta=ta.slides||[];Ob.a.Xa(ta)?this.notFound():this.j2f(ta,ta.length-1,R)}j1i(R,ta){R=
this.qc.Bk(R.Cb);if(this.hAa){const Ra=(R=this.tN.P5a(R))?R.length:0;for(let nb=0;nb<Ra;nb++){const Cb=R[nb];if(Fg.mxg(Cb,ta))return Cb}return null}return this.tN.APi(R,ta)}K3i(R,ta){R=this.qc.Bk(R.Cb);if(this.hAa){var Ra=(R=this.tN.P5a(R))?R.length:0;for(--Ra;0<=Ra;Ra--){const nb=R[Ra];if(Fg.mxg(nb,ta))return nb}return null}return this.tN.LPi(R,ta)}ewg(R){return R.NB}d0b(R){var ta=this.ua.presentation;if(!ta)throw Error.argumentNull("Presentation is null");if(R){ta=ta.slides||[];R=new re.a(R);for(let Ra=
0;Ra<ta.length;Ra++)if(ta[Ra]&&re.a.GOf(ta[Ra].Cb,R))return Ra}return-1}Wjl(R){return R?this.qc.bia(new re.a(R)):null}notFound(){this.Qb.Zga&&this.Qb.Zga(null,null,!1,!1)}static e1i(R,ta){if(ta)switch(R){case 0:return 2;case 1:return 3}return R}static mxg(R,ta){return!ta||0===R.status}}Fg.hKd="IsCompletedSearchInClient";Fg.yfi="ServerSearchStartTime";Fg.BJf="ServerSearchEndTime";Fg.jJf="IsServerSearchSucceeded";Fg.Tei="IsBRSOn";Object(h.a)(Fg,"FindCommentLogic",null,[927,109]);var Cd=d(79);class zg{constructor(){this.type=
0;this.Zga=this.Vc=null;this.bFd=!1}}Object(h.a)(zg,"Entry",null,[]);class Eh{constructor(R,ta){this.eYc=null;this.np=R;this.Bb=ta;this.Eka=[];this.cme=0}dispose(){this.np.dispose();this.Eka=this.np=null;Lb.a.J(25985481,805,50,"MaxQueuedEntryNum: {0}",this.cme)}ZUd(R,ta,Ra){this.enqueue(1,R,ta,Ra)}fVd(R,ta,Ra){this.enqueue(0,R,ta,Ra)}$Ud(R,ta){this.enqueue(2,R,ta,!1)}enqueue(R,ta,Ra,nb){Ra.Ya("AlreadyQueuedEntryCount",this.Eka.length.toString());R=Object.assign(new zg,{type:R,Zga:(Cb,mc,Sc,jd)=>{ta(Cb,
mc,Sc,jd);this.eYc=null;this.V2g()},Vc:Ra,bFd:nb});Array.enqueue(this.Eka,R);this.cme=Math.max(this.cme,this.Eka.length);this.V2g()}V2g(){0<this.Eka.length&&!this.eYc&&(this.eYc=new Cd.a(2,1,0,Object(Ea.a)(this,this.Jyk,"processOneEntry"),90,"49"),this.Bb.Hb(this.eYc))}Jyk(){const R=Array.dequeue(this.Eka);1===R.type?this.np.ZUd(R.Zga,R.Vc,R.bFd):0===R.type?this.np.fVd(R.Zga,R.Vc,R.bFd):this.np.$Ud(R.Zga,R.Vc)}}Object(h.a)(Eh,"FindCommentLogicDecorator",null,[927,109]);var eh=d(376),Gg=d(107);class vh extends Gg.a{constructor(R,
ta){super();this.StartSlideId=null;this.RequestType=0;this.FFindModernComments=!1;if(null===R)throw Error.argumentNull("slideId");this.RequestType=ta;this.StartSlideId=R.toString();this.FFindModernComments=!0}Lk(){return 88}}Object(h.a)(vh,"FindCommentRequest",Gg.a,[]);class ze extends eh.a{constructor(R){super();this.JUa=null;this.CMg=0;this.XFa=this.tEa=null;this.enabled=2;this.Hyb=0;this.El=!1;this.Zl=R;this.Zl.register(this)}dispose(){this.El||(1===this._state&&this.Zl.unregister(this),this.El=
!0,this.Hyb=0)}find(R,ta,Ra,nb){0<this.Hyb&&null!==Ra&&(Lb.a.J(523249091,805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",this.Hyb),Ra(null));this.JUa=R;this.CMg=ta;this.JE(Ra,nb,null)}mia(){return 0<this.Hyb&&!this.El}JP(){return!1}DQa(){return this.xvg||this.mia()}zEb(){if(1===this._state)this.Nd.$G=new vh(this.JUa,this.CMg),this.Nd.status=1,this._state=3;else if(3===this._state&&this.xvg)if(Lb.a.J(523249092,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",
this.Nd.$cd,this.Nd.wt,this.Nd.Eu),2===this.Nd.statusCode&&this.Nd.pr&&1===this.Nd.pr.length){const R=this.Nd.pr[0];0!==R.StatusCode?this.UG(R):this.A_(R)}else this.UG()}JE(R,ta){this.Hyb++;this.XFa=R;this.tEa=ta;this.Zl.P9()}forceOutbound(){}UG(R=null){Lb.a.J(523249094,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",this.Nd.oy,this.Nd.statusCode,R?R.StatusCode:-1);this.UXg(R,!1)}A_(R){this.UXg(R,!0)}get xvg(){return!!this.Nd&&
2===this.Nd.status}UXg(R,ta){this.Hyb--;this._state=1;if(ta){ta=null;try{ta=Sys.Serialization.JavaScriptSerializer.deserialize(R.FindCommentResult)}catch(Ra){Lb.a.J(523249095,805,10,"Cannot parse find comment result: {0}",Ra)}this.XFa(ta)}else this.tEa(null,-1)}}Object(h.a)(ze,"FindCommentReplicator",eh.a,[109]);class sg{constructor(){this.Rq=null;this.Ioc=this.zpf=this.NVe=this.sxc=this.uyf=this.hef=this.zrf=!1}Gaj(){this.Rq||(m.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),
this.Tkh());return this.Rq}s5i(){return new Promise((R,ta)=>{this.Ioc?R(this.W$f()):this.Mih().then(()=>{R(this.W$f())}).catch(Ra=>{ta(Ra)})})}W$f(){this.Ioc||m.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let R;R=33;this.NVe&&(R|=2);this.zrf&&(R|=8);this.uyf&&(R|=16);this.hef&&(R|=4);this.sxc&&(R|=64);this.zpf&&(R|=128);return R}}Object(h.a)(sg,"OfficeSharedCommentsAppCapabilities",null,
[1522]);class zd extends sg{constructor(R,ta,Ra,nb,Cb,mc){super();this.kc=R;this.Ha=ta;this.sLg=Ra;this.M2j=mc;this.j3k(nb,Cb);this.Tkh();this.Mih()}j3k(R,ta){this.sxc=this.kc.ka("TasksForCommentsEnabled")&&!R;this.uyf=!1;this.zrf=ta;this.zpf=this.hef=!0}Tkh(){this.Rq={};const R=this.sxc&&e.AFrameworkApplication.fa.ka(dc.a.J4b);this.Rq.CommentsFluentUI="true";this.Rq.CommentsFluentUIV2="true";this.Rq.CommentTasks=this.sxc.toString();Sd.a("DeprecateIE.SharedCommentAppCapabilities")?this.Rq.DisabledChangeGates=
this.kc.Ia("DisabledChangeGatesInSharedComments"):this.Rq.DisabledChangeGates=lb.a.rj?"WebThemeIntegrationHighContrastFixes,":""+this.kc.Ia("DisabledChangeGatesInSharedComments");this.Rq.DiscreteHostedComments="true";this.Rq.NewCommentButton="true";this.Rq.PersonaColor="true";this.Rq.LivePersonaPicker="true";this.Rq.AtMentionFloodgateSurvey=e.AFrameworkApplication.fa.ka("AtMentionUserFloodGateCampaignIsEnabled").toString();this.Rq.CommentTasksFromReply=R.toString();this.Rq.LogDraftCommentIdPair=this.M2j.toString();
this.Rq.HyperlinksInComments="true";this.Rq.SmartReplies=this.kc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1).toString();this.Rq.NewModelState="true";this.Rq.TaskPaneWithNewInfrastructure=this.Ha.UMd.toString();this.Rq.NewSelectionInteractions="true";this.Rq.ExtendedDrafting="true";this.Rq.LinkToComment="true";this.Rq.PersonaIconImageForWeb="true";this.Rq.NoDiscardOnFocusLoss="true";this.Rq.WebThemeIntegration="true";this.Rq.TaskHistoryRecordIDs=this.kc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1).toString()}Mih(){return new Promise((R,ta)=>{this.sLg?this.sLg.atMentionsEnabledAsync().then(Ra=>{this.NVe=Ra;this.Ioc=!0;R(this.Ioc)}):(m.ULS.sendTraceTag(528307426,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),ta(H.a.Yt(-2130915320)))})}}Object(h.a)(zd,"PPTSharedCommentAppCapabilities",sg,[]);class Hd{constructor(R){this.Ag=R}display(R,ta){this.Ag.QRe(R?0:2,ta);this.Ag.setVisibility()}dismiss(){this.Ag.Xki();
this.Ag.setVisibility()}activate(){this.Ag.QRe(1);this.Ag.setVisibility()}tFi(R){this.Ag.QRe(R?0:2)}Vm(R){this.Ag.Vm(R)}SD(R){this.Ag.SD(R)}eq(){return this.Ag.eq()}IP(R){return this.Ag.Ytb(R)}Rx(R){this.Ag.Rx(R)}dispose(){this.Ag.dispose()}mz(){this.Ag.mz()}TE(R){return this.Ag.TE(R)}MD(R){return this.Ag.MD(R)}draw(R,ta){this.Ag.draw(R,ta)}get visible(){return this.Ag.visible}set visible(R){this.Ag.visible=R}setPosition(R,ta){this.Ag.setPosition(R,ta)}Ej(R){this.Ag.Ej(R)}Nq(R){this.Ag.Nq(R)}ov(R){this.Ag.ov(R)}setZIndex(R){this.Ag.setZIndex(R)}wF(R,
ta){this.Ag.wF(R,ta)}setSelection(){}}Object(h.a)(Hd,"ShapeCommentsAnchoredSelectionView",null,[962,283,284,109]);class Fh{constructor(R,ta){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=R;this.canvasContextId=ta}}Object(h.a)(Fh,"CommentUIAction",null,[]);var Gh=d(63),ih=d(634),ah=d(120),Fi=d(187),Wi=d(1078),Mg=d(523);class ee{constructor(){this.draftId=null;this.insertIndex=
0;this.anchorHintText=null}}Object(h.a)(ee,"CurrentContextDraft",null,[]);class Lf{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}Object(h.a)(Lf,"IContentAnchorPosition",null,[]);class Vf{constructor(){this.y=this.x=this.height=this.width=0}}Object(h.a)(Vf,"IViewportInfo",null,[]);class fd{constructor(){this.allContainersVisibleCallback=this.positionsUpdatedScrollHeightCallback=this.positionsUpdatedCallback=this.paneOpenedCallback=
this.paneClosedCallback=null}}Object(h.a)(fd,"FloatingContainerManagerCreationParams",null,[]);var Ee=d(138),Yf=d(50),ij=d(801),Md=d(405),pj=d(371),qj=d(876),jj;(function(R){R[R.line=0]="line";R[R.lineInv=1]="lineInv";R[R.triangle=2]="triangle";R[R.rtTriangle=3]="rtTriangle";R[R.rect=4]="rect";R[R.diamond=5]="diamond";R[R.parallelogram=6]="parallelogram";R[R.trapezoid=7]="trapezoid";R[R.nonIsoscelesTrapezoid=8]="nonIsoscelesTrapezoid";R[R.pentagon=9]="pentagon";R[R.hexagon=10]="hexagon";R[R.heptagon=
11]="heptagon";R[R.octagon=12]="octagon";R[R.decagon=13]="decagon";R[R.dodecagon=14]="dodecagon";R[R.star4=15]="star4";R[R.star5=16]="star5";R[R.star6=17]="star6";R[R.star7=18]="star7";R[R.star8=19]="star8";R[R.star10=20]="star10";R[R.star12=21]="star12";R[R.star16=22]="star16";R[R.star24=23]="star24";R[R.star32=24]="star32";R[R.roundRect=25]="roundRect";R[R.round1Rect=26]="round1Rect";R[R.round2SameRect=27]="round2SameRect";R[R.round2DiagRect=28]="round2DiagRect";R[R.snipRoundRect=29]="snipRoundRect";
R[R.snip1Rect=30]="snip1Rect";R[R.snip2SameRect=31]="snip2SameRect";R[R.snip2DiagRect=32]="snip2DiagRect";R[R.plaque=33]="plaque";R[R.ellipse=34]="ellipse";R[R.teardrop=35]="teardrop";R[R.homePlate=36]="homePlate";R[R.chevron=37]="chevron";R[R.pieWedge=38]="pieWedge";R[R.pie=39]="pie";R[R.blockArc=40]="blockArc";R[R.donut=41]="donut";R[R.noSmoking=42]="noSmoking";R[R.rightArrow=43]="rightArrow";R[R.leftArrow=44]="leftArrow";R[R.upArrow=45]="upArrow";R[R.downArrow=46]="downArrow";R[R.stripedRightArrow=
47]="stripedRightArrow";R[R.notchedRightArrow=48]="notchedRightArrow";R[R.bentUpArrow=49]="bentUpArrow";R[R.leftRightArrow=50]="leftRightArrow";R[R.upDownArrow=51]="upDownArrow";R[R.leftUpArrow=52]="leftUpArrow";R[R.leftRightUpArrow=53]="leftRightUpArrow";R[R.quadArrow=54]="quadArrow";R[R.leftArrowCallout=55]="leftArrowCallout";R[R.rightArrowCallout=56]="rightArrowCallout";R[R.upArrowCallout=57]="upArrowCallout";R[R.downArrowCallout=58]="downArrowCallout";R[R.leftRightArrowCallout=59]="leftRightArrowCallout";
R[R.upDownArrowCallout=60]="upDownArrowCallout";R[R.quadArrowCallout=61]="quadArrowCallout";R[R.bentArrow=62]="bentArrow";R[R.uturnArrow=63]="uturnArrow";R[R.circularArrow=64]="circularArrow";R[R.leftCircularArrow=65]="leftCircularArrow";R[R.leftRightCircularArrow=66]="leftRightCircularArrow";R[R.curvedRightArrow=67]="curvedRightArrow";R[R.curvedLeftArrow=68]="curvedLeftArrow";R[R.curvedUpArrow=69]="curvedUpArrow";R[R.curvedDownArrow=70]="curvedDownArrow";R[R.swooshArrow=71]="swooshArrow";R[R.cube=
72]="cube";R[R.can=73]="can";R[R.lightningBolt=74]="lightningBolt";R[R.heart=75]="heart";R[R.sun=76]="sun";R[R.moon=77]="moon";R[R.smileyFace=78]="smileyFace";R[R.irregularSeal1=79]="irregularSeal1";R[R.irregularSeal2=80]="irregularSeal2";R[R.foldedCorner=81]="foldedCorner";R[R.bevel=82]="bevel";R[R.frame=83]="frame";R[R.halfFrame=84]="halfFrame";R[R.corner=85]="corner";R[R.diagStripe=86]="diagStripe";R[R.chord=87]="chord";R[R.arc=88]="arc";R[R.leftBracket=89]="leftBracket";R[R.rightBracket=90]="rightBracket";
R[R.leftBrace=91]="leftBrace";R[R.rightBrace=92]="rightBrace";R[R.bracketPair=93]="bracketPair";R[R.bracePair=94]="bracePair";R[R.straightConnector1=95]="straightConnector1";R[R.bentConnector2=96]="bentConnector2";R[R.bentConnector3=97]="bentConnector3";R[R.bentConnector4=98]="bentConnector4";R[R.bentConnector5=99]="bentConnector5";R[R.curvedConnector2=100]="curvedConnector2";R[R.curvedConnector3=101]="curvedConnector3";R[R.curvedConnector4=102]="curvedConnector4";R[R.curvedConnector5=103]="curvedConnector5";
R[R.callout1=104]="callout1";R[R.callout2=105]="callout2";R[R.callout3=106]="callout3";R[R.accentCallout1=107]="accentCallout1";R[R.accentCallout2=108]="accentCallout2";R[R.accentCallout3=109]="accentCallout3";R[R.borderCallout1=110]="borderCallout1";R[R.borderCallout2=111]="borderCallout2";R[R.borderCallout3=112]="borderCallout3";R[R.accentBorderCallout1=113]="accentBorderCallout1";R[R.accentBorderCallout2=114]="accentBorderCallout2";R[R.accentBorderCallout3=115]="accentBorderCallout3";R[R.wedgeRectCallout=
116]="wedgeRectCallout";R[R.wedgeRoundRectCallout=117]="wedgeRoundRectCallout";R[R.wedgeEllipseCallout=118]="wedgeEllipseCallout";R[R.cloudCallout=119]="cloudCallout";R[R.cloud=120]="cloud";R[R.ribbon=121]="ribbon";R[R.ribbon2=122]="ribbon2";R[R.ellipseRibbon=123]="ellipseRibbon";R[R.ellipseRibbon2=124]="ellipseRibbon2";R[R.leftRightRibbon=125]="leftRightRibbon";R[R.verticalScroll=126]="verticalScroll";R[R.horizontalScroll=127]="horizontalScroll";R[R.wave=128]="wave";R[R.doubleWave=129]="doubleWave";
R[R.plus=130]="plus";R[R.flowChartProcess=131]="flowChartProcess";R[R.flowChartDecision=132]="flowChartDecision";R[R.flowChartInputOutput=133]="flowChartInputOutput";R[R.flowChartPredefinedProcess=134]="flowChartPredefinedProcess";R[R.flowChartInternalStorage=135]="flowChartInternalStorage";R[R.flowChartDocument=136]="flowChartDocument";R[R.flowChartMultidocument=137]="flowChartMultidocument";R[R.flowChartTerminator=138]="flowChartTerminator";R[R.flowChartPreparation=139]="flowChartPreparation";R[R.flowChartManualInput=
140]="flowChartManualInput";R[R.flowChartManualOperation=141]="flowChartManualOperation";R[R.flowChartConnector=142]="flowChartConnector";R[R.flowChartPunchedCard=143]="flowChartPunchedCard";R[R.flowChartPunchedTape=144]="flowChartPunchedTape";R[R.flowChartSummingJunction=145]="flowChartSummingJunction";R[R.flowChartOr=146]="flowChartOr";R[R.flowChartCollate=147]="flowChartCollate";R[R.flowChartSort=148]="flowChartSort";R[R.flowChartExtract=149]="flowChartExtract";R[R.flowChartMerge=150]="flowChartMerge";
R[R.flowChartOfflineStorage=151]="flowChartOfflineStorage";R[R.flowChartOnlineStorage=152]="flowChartOnlineStorage";R[R.flowChartMagneticTape=153]="flowChartMagneticTape";R[R.flowChartMagneticDisk=154]="flowChartMagneticDisk";R[R.flowChartMagneticDrum=155]="flowChartMagneticDrum";R[R.flowChartDisplay=156]="flowChartDisplay";R[R.flowChartDelay=157]="flowChartDelay";R[R.flowChartAlternateProcess=158]="flowChartAlternateProcess";R[R.flowChartOffpageConnector=159]="flowChartOffpageConnector";R[R.actionButtonBlank=
160]="actionButtonBlank";R[R.actionButtonHome=161]="actionButtonHome";R[R.actionButtonHelp=162]="actionButtonHelp";R[R.actionButtonInformation=163]="actionButtonInformation";R[R.actionButtonForwardNext=164]="actionButtonForwardNext";R[R.actionButtonBackPrevious=165]="actionButtonBackPrevious";R[R.actionButtonEnd=166]="actionButtonEnd";R[R.actionButtonBeginning=167]="actionButtonBeginning";R[R.actionButtonReturn=168]="actionButtonReturn";R[R.actionButtonDocument=169]="actionButtonDocument";R[R.actionButtonSound=
170]="actionButtonSound";R[R.actionButtonMovie=171]="actionButtonMovie";R[R.gear6=172]="gear6";R[R.gear9=173]="gear9";R[R.funnel=174]="funnel";R[R.mathPlus=175]="mathPlus";R[R.mathMinus=176]="mathMinus";R[R.mathMultiply=177]="mathMultiply";R[R.mathDivide=178]="mathDivide";R[R.mathEqual=179]="mathEqual";R[R.mathNotEqual=180]="mathNotEqual";R[R.cornerTabs=181]="cornerTabs";R[R.squareTabs=182]="squareTabs";R[R.plaqueTabs=183]="plaqueTabs";R[R.chartX=184]="chartX";R[R.chartStar=185]="chartStar";R[R.chartPlus=
186]="chartPlus"})(jj||(jj={}));Object(h.b)("ST_ShapeType",jj);var Ag=d(152);class mf{constructor(){this.RowId=this.ColId=null}}Object(h.a)(mf,"TableCellInfo",null,[]);var Ia=d(875),tb=d(53),Qb=d(183),qc=d(112),Lc=d(167),Jd=d(1075),le=d(904),je=d(905),Gf=d(390),Wf=d(102);class fh{constructor(R,ta){this.Xta=this.Mwb=null;this.DIg=!1;this.Moe=R;this.ph=ta}get ILj(){return this.DIg}eEb(R,ta){ta&&R.removeNotification(ta);return ta}QKk(R){this.Mwb=this.eEb(R,this.Mwb);this.eEb(R,this.Xta);this.Xta=this.Mwb=
null}jal(R,ta,Ra){R?this.Moe.Yl.isVisible&&1===R.EL.length&&ta.Ca&&re.a.Sma(R.m5a.Cb,ta.Ca.Cb)||md.UISurfaces.pV().then(nb=>{this.Xta=this.eEb(nb,this.Xta);this.Xta=null;var Cb=Object.assign(new Jd.a,{label:R.pDb,onExecute:()=>{R.primaryButtonAction(this.Moe,ta);ta.Ca.Ge!==R.m5a.Ge&&Ra.rda(R.m5a.Ge);this.eEb(nb,this.Xta);this.Xta=null}}),mc=Object.assign(new Jd.a,{label:R.wed,onExecute:()=>{this.DIg=!0;this.eEb(nb,this.Xta);this.Xta=null}});mc=Object.assign(new le.a,{target:".EditingRibbonPanel",
title:R.title,content:R.content,primaryButtonProps:Cb,secondaryButtonProps:mc,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new je.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,onDismiss:()=>{this.ph.ap(Od.a.Jfb)},preventDismissOnScroll:!0,preventDismissOnResize:!0})});Cb=Object.assign(new Gf.a,{onShow:()=>{this.ph.SJ(Od.a.Jfb)}});mc=nb.callout(mc);this.Xta=nb.addNotification(mc,Cb)}):Lb.a.J(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}woh(R,
ta){const Ra=new Wf.StandardDialog;Ra.vd=4;Ra.Tw(ResourceStrings.l_DeleteAllCommentsConfirmationTitle,ta?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,nb=>{1===nb?(R.UWb(ta),this.Moe.gUd(ta)?this.xoh():this.voh(ta?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:ResourceStrings.l_DeleteAllCommentsInPresentationCallout),Lb.a.J(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",
ta)):Lb.a.J(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",ta)})}xoh(){const R=new Wf.StandardDialog;R.vd=0;R.Tw(ResourceStrings.l_DeleteAllCommentsErrorTitle,ResourceStrings.l_DeleteAllCommentsError,1,null)}voh(R){const ta=()=>{this.ph.SJ(Od.a.Jfb)},Ra=()=>{this.ph.ap(Od.a.Jfb)};md.UISurfaces.pV().then(nb=>{this.eEb(nb,this.Mwb);this.Mwb=null;var Cb=Object.assign(new le.a,{target:".EditingRibbonPanel",title:ResourceStrings.l_DeleteAllCommentsCalloutTitle,
content:R,showCloseIcon:!0,useTeachingStyles:!1,calloutProps:Object.assign(new je.a,{directionalHint:6,isBeakVisible:!1,onDismiss:Ra,preventDismissOnScroll:!0,preventDismissOnResize:!0})});const mc=Object.assign(new Gf.a,{onShow:ta});Cb=nb.callout(Cb);this.Mwb=nb.addNotification(Cb,mc)})}}Object(h.a)(fh,"CommentCalloutDialogManager",null,[]);var zh=d(932);class Qg{constructor(R){this.$Ta=R;this.Eka=[];this.bfe=new zh.a(1E3,Object(Ea.a)(this,this.perform,"perform"))}yuk(R){Array.contains(this.Eka,
R)||Array.add(this.Eka,R);this.bfe.perform()}perform(){const R=this.Eka;this.Eka=[];for(let ta=0;ta<R.length;ta++){const Ra=R[ta];this.$Ta.YAb(Ra.commentId,new oc.a(Ra.pos.X,Ra.pos.Y))}}}Object(h.a)(Qg,"CommentKeyboardMoveController",null,[]);class Rg{constructor(R,ta,Ra,nb,Cb){this.ODa=this.$ta=null;this.Oca=[];if(!R)throw Error.argumentNull("parentElement");if(!ta)throw Error.argumentNull("frame");this.xyb=Ra;this.$h=R;this.Ua=ta;this.WEg=nb;this.fFg=Cb}dispose(){this.SCe();this.Ua=this.$h=null}SCe(){this.ODa=
this.$ta=null;if(this.Oca&&0<this.Oca.length){for(const R of this.Oca)R&&R.dispose();Array.clear(this.Oca)}}WY(R){if(!this.kBa)return!0;if(!R||!R.length)return!1;R=Lc.e(R,ta=>0===ta.status);return!!R&&0<R.length}Sbd(R){this.SCe();if(R&&this.$h){var ta=this.Ua.isReadOnly?null:this.Ua.yt;for(const Ra of R)this.Oca.push(this.xyb.create(Ra,this.$h,this,ta,this.Ua.isReadOnly,this.ps&&od.TM(Ra)||!this.fFg));this.WY(R)&&this.vSe()}}selectComment(R,ta){if(!(!R&&!this.$ta||this.$ta&&od.Jqb(R,this.$ta.comment))&&
(this.$ta&&this.$ta.select(!1),this.$ta=null,R))for(const Ra of this.Oca){if(od.Jqb(Ra.comment,R)){this.$ta=Ra;Ra.select(!0);break}if(ta&&Ra.comment.Children)for(const nb of Ra.comment.Children)if(od.Jqb(nb,R)){this.$ta=Ra;Ra.select(!0);return}}}nmb(R,ta){if(!(!R&&!this.ODa||this.ODa&&od.Jqb(R,this.ODa.comment))&&(this.ODa&&this.ODa.activate(!1),this.ODa=null,R))for(const Ra of this.Oca){if(od.Jqb(Ra.comment,R)){this.ODa=Ra;Ra.activate(!0);break}if(ta&&Ra.comment.Children)for(const nb of Ra.comment.Children)if(od.Jqb(nb,
R)){this.ODa=Ra;Ra.activate(!0);return}}}Moh(R){for(const ta of this.Oca)ta.Loh(R)}vSe(){for(const R of this.Oca)R.updatePosition(this.Ua.mAa(R.comment.pos.X,R.comment.pos.Y))}YAb(R,ta){ta=this.Ua.cQf(ta._x,ta._y);R.pos.X+=ta._x;R.pos.Y+=ta._y;ta=new oc.a(R.pos.X,R.pos.Y);this.Ua.selectComment(R,null,!0,!1,0,1,!1);this.Ua.manager.YAb(R.commentId,ta)}usl(R){for(const ta of this.Oca)if(ta.comment===R){ta.updatePosition(this.Ua.mAa(ta.comment.pos.X,ta.comment.pos.Y));break}}vsl(R){for(const ta of R)for(const Ra of this.Oca)Ra.comment.commentId===
ta.commentId&&Ra.updatePosition(this.Ua.mAa(Ra.comment.pos.X,Ra.comment.pos.Y))}setVisibility(R){this.fFg=R;for(const ta of this.Oca)ta.setVisibility(!(this.ps&&od.TM(ta.comment))&&R)}get frame(){return this.Ua}get isRightToLeft(){return this.WEg}set isRightToLeft(R){this.WEg=R}get parentElement(){return this.$h}set parentElement(R){this.$h=R}get kFb(){return this.$ta}get ps(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("CommentTextAnchoringUIEnabled")}get kBa(){return!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("SlideResizePerfImprovementEnabled")}}Object(h.a)(Rg,"CommentMarkerView",null,[]);class wi{constructor(){this.comment=this.slide=null;this.direction=0;this.vGe=null}}Object(h.a)(wi,"CommentSelectContext",null,[]);var Ng;(function(R){R[R.previous=0]="previous";R[R.next=1]="next"})(Ng||(Ng={}));Object(h.b)("CommentSelectDirection",Ng);class Fj{constructor(R,ta){if(!R||1>R.length)throw Error.argument("ISlideNode[] slides");if(!ta)throw Error.argumentNull("ICommentGraphManager graphManager");
this.n6j=R;this.el=ta;this.foe=[];this.init()}get TGa(){return this.n6j}get EL(){return this.foe}get m5a(){return this.EL[this.EL.length-1]}get pDb(){return 1<this.EL.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton}get wed(){return ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton}get title(){return ResourceStrings.L_CommentReviewResolvedCalloutTitle}get content(){return this.Jbl()}init(){for(const R of this.TGa)for(const ta of this.el.gra(R.KE()))if(1===
ta.status){this.foe.push(R);break}if(1>this.foe.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");}Jbl(){switch(this.EL.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,this.EL[1].Ge+1,this.EL[0].Ge+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,this.EL[2].Ge+1,this.EL[1].Ge+1,this.EL[0].Ge+1);case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,
this.EL[3].Ge+1,this.EL[2].Ge+1,this.EL[1].Ge+1);default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,this.EL[this.EL.length-1].Ge+1,this.EL[this.EL.length-2].Ge+1,this.EL[this.EL.length-3].Ge+1,this.EL.length-3)}}s1i(){for(const R of this.el.P5a(this.m5a))if(1===R.status)return R;return null}primaryButtonAction(R,ta){if(!ta.presentation||!ta.presentation.slides)return Lb.a.J(571269902,805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",
ta.presentation?"Presentation.Slides":"Presentation"),null;const Ra=this.s1i();if(!Ra)return null;R.Yl.isVisible||R.dhd();if(ta.Ca&&re.a.Sma(ta.Ca.Cb,this.m5a.Cb))R.jea(Ra.commentId,1,!0);else for(const nb of ta.presentation.slides)if(re.a.Sma(nb.Cb,this.m5a.Cb))return Object.assign(new wi,{slide:this.m5a,comment:Ra,direction:1,vGe:Na.a.Nm("SelectResolvedCommentCrossSlide",1)});return null}}Object(h.a)(Fj,"ResolvedCommentsCalloutParams",null,[]);class Hh{constructor(){this.type="SharedCommentsTaskPaneProps";
this.focusCallback=null}}Object(h.a)(Hh,"SharedCommentsTaskPaneProps",null,[]);var gg=d(936),Og=d(424),vg=d(161);class Sg{constructor(R,ta,Ra,nb,Cb,mc,Sc,jd,Ad,ve,Ae,Ue,mg,ki,di,lk,Rf,Kd,Ql,Uj,fm,Ij,Nm,jf,Hf,rj,Om,gm,sj,Rl,Dl,Pm,hl,Tk,de,Nf,vm,Uk,El,Jj,Kj,Hi,xi,ni,pg,ul,Rn,ek,ln,Fl,fk,Oi,xh,mn,rh){this.Eoe=this.Km=null;this.k$a=!0;this.ro=this.Oge=this.I7b=this.xge=this.m$a=!1;this.nab=0;this.p2c=this.Azb=!1;this.bEa=this.C1c=this.Wh=this.GSa=this.nbb=this.O8=this.CBg=null;this.ZEg=this.JTa=!1;this.jr=
null;this.Soe=this.jge=!1;this.HMg=null;this.bJf=[Od.a.oC,Od.a.Ep,Od.a.K1,Od.a.Mni];this.Ohb=2147483647;this.Zvb=0;this.nJg=-1;this.aDg=0;this.v9b=null;this.r1c=this.ree=!1;if(!Nf)throw Error.argumentNull("appSettingsManager");if(!Ij)throw Error.argumentNull("commentEventHost");if(!ta)throw Error.argumentNull("commentTelemetryManager");this.IG=fk;this.ia=Ra;this.Rb=nb;this.Yl=Cb;this.yt=mc;this.jd=Sc;this.Ga=jd;this.ph=Ad;this.Qd=ve;this.sa=Ae;this.Kc=mg;this.Kx=ki;this.hv=di;this.el=R;this.tD=ta;
this.M1j=new Qg(R);this.DW=lk;this.ua=Rf;this.x3c=Kd.Cd(40);this.eLg=Sd.a("PreventCommentDraftDeletionOnPageContentChange")?Kd.Cd(7):Kd.Cd(8);this.Syb=Ue;this.Nca=mg.Mc?mg.Mc.NMd:null;this.ika=Hf;this.Bb=Uj;this.KZ=Ij;this.Sbb=Nm;this.eKg=fm;this.k2c=jf;this.see=rj;this.BYc=Om;this.Je=Rl;this.R0c=gm;this.Hn=sj;this.gXc=Dl;this.gv=Pm;this.xyb=hl;this.rQ=Tk;this.En=de;this.kc=Nf;this.Pr=Uk;this.CEg=El;this.U2=new r.a;this.Wd=Jj;this.Za=Kj;this.kbb=xi;this.gta=Hi;this.Xc=ni;this.Fa=Rn;this.p5j=ek;this.cW=
ln;this.M7b=Fl;this.Ha=xh;this.nm=mn;this.X7=rh;this.F7b=ul;this.TEa=!1;this.ia.bma(this);this.K9a=new fh(this,this.ph);if(!vm)throw Error.argumentNull("InteractiveViewManagerFuture");this.eHg=vm;this.NWj=this.Oti();this.IG&&this.Yl.JZk(this.Y6i());this.Ib=Oi;pg.bWb().then(aj=>{aj||this.yHe(!1)})}get mIc(){return this.CEg}get jUd(){return this.kc.ka(dc.a.pa(195))}get I0f(){return this.gta}get OWb(){return this.kc.Ia("CurrentCommentId")}get gQd(){return this.kc.Ia("CurrentSlideId")}get kVb(){return this.kc.ka("PptReactTabbedTaskPanesM2IsEnabled")}get dwk(){return this.kc.ka("PPTSafeLinksIsEnabledForModernComments")}get ps(){return this.kc.ka("CommentTextAnchoringUIEnabled")}get Zni(){return this.kc.ka("CommentTextAnchoringReadWriteEnabled")}get RMd(){return this.kc.ka("CommentTextAnchoringCreateNewEnabled")}get Owe(){return!!e.AFrameworkApplication.Ba&&
!!e.AFrameworkApplication.Ba.jb&&e.AFrameworkApplication.Ba.jb.nvb}get vYf(){return this.kc.ka("EnableDeleteAllComments")}get kBa(){return this.kc.ka("SlideResizePerfImprovementEnabled")}get mqb(){return this.kc.ka("EnableCompactingDHCs")}get x0f(){return Sd.a("CanvasToCommentFocusFix")}initialize(){this.ro=1===this.Rb.mode;this.IG||(this.ika?Sys.UI.DomElement.addCssClass(this.Syb,qh.PTk):Sys.UI.DomElement.addCssClass(this.Syb,qh.OTk));const R=this.Ga.Bc(Od.a.Ep);R.HK=!0;R.hZa=!0;R.vaa(Ra=>{const nb=
!Sd.a("FixAltF12KeboardingInCommentPane")||!Ra||Ra.name!==Od.a.rO;this.Jcc(!0,!Ra||Ra.name!==Od.a.oC&&nb,!0)});R.wza((Ra,nb)=>{Ra=(nb.name===Od.a.fO||nb.name===Od.a.hea)&&Ra.name===Od.a.Ep;this.Jcc(!1,!1,nb.name===Od.a.Ep||nb.name===Od.a.sg||nb.name===Od.a.oC||nb.name===Od.a.K1||this.kVb&&nb.name===Od.a.rO||Ra)});const ta=this.Ga.Bc(Od.a.oC);ta.vaa((Ra,nb)=>{this.ukk(Ra,nb)});ta.wza(()=>{this.tkk()});this.IG||this.jd.bEb(rb.a.click,this.Syb,Object(Ea.a)(this,this.LBb,"onCommentPaneParentDivClick"),
null,R.hZa);this.wb();this.Kx.mGd(Object(Ea.a)(this,this.BGa,"onBeforeSlideSwitched"));this.Kx.DR(Object(Ea.a)(this,this.TRe,"updateCommentsWhenNavigateSlide"));this.hv.HMa(Object(Ea.a)(this,this.Ezf,"activeSlideDOMDisplayed"));this.Hn.v3h(Object(Ea.a)(this,this.TYg,"onPageViewZoomChanged"));this.Pr.BCf(Object(Ea.a)(this,this.onShapeSelected,"onShapeSelected"));this.Pr.X3h(Object(Ea.a)(this,this.OZg,"onShapeDeselected"));this.Kx.DSb(Object(Ea.a)(this,this.ZZg,"onShapeTextSelected"));this.Kx.FCf(Object(Ea.a)(this,
this.ndc,"onSlideBackgroundClicked"));this.F7b&&(this.Kx.ESb(Object(Ea.a)(this,this.Zlk,"onSlideSizeUpdated")),this.Kx.d4h(Object(Ea.a)(this,this.XZg,"onShapeRotatedOrBoundsUpdated")),this.Kx.$3h(Object(Ea.a)(this,this.XZg,"onShapeRotatedOrBoundsUpdated")));this.x3c.yk(Object(Ea.a)(this,this.S_g,"onTextAnchorPropertyChanged"));this.eLg.ZF(Object(Ea.a)(this,this.YA,"onChildTopologyChanged"));this.x3c.Cza(Object(Ea.a)(this,this.UVg,"onBeforeTextAnchorDisconnect"));this.kbb.yk(Object(Ea.a)(this,this.kdc,
"onShapePropertyChange"));this.kbb.s3h(Object(Ea.a)(this,this.SZg,"onShapeInvalidation"));this.Xc.w1h(Object(Ea.a)(this,this.cXg,"onF6FocusDocument"));this.gXc.zGd(Object(Ea.a)(this,this.b8c,"onSessionExpired"));this.gXc.wB(Object(Ea.a)(this,this.Pcb,"onSessionEnded"));this.Kc.Mc&&this.Kc.Mc.NMd&&(this.BGa(this,null),this.TRe(this,null));this.Rb.aP(Object(Ea.a)(this,this.BVg,"onAppModeSwitched"));this.Rb.D2a(Object(Ea.a)(this,this.UW,"onSetOffline"));this.hv.CSb(Object(Ea.a)(this,this.f8c,"onShapeViewElementAddedOrRemoved"));
this.hv.DCf(Object(Ea.a)(this,this.f8c,"onShapeViewElementAddedOrRemoved"));this.sa.VJ(Object(Ea.a)(this,this.VG,"onSelectionChanged"))}f8c(R,ta){this.Km&&(R=ta.$w)&&R.shapeNode&&this.WKj(R.shapeNode.slideId)&&this.Km.Sbd(this.el.sz())}WKj(R){return!!this.ua&&!!this.ua.Lj&&this.ua.Lj.equals(R)}yHe(R){this.gta=this.CEg=R;this.En.yHe(R)}Zlk(){this.Km&&this.Km.vSe()}XZg(R,ta){if(this.Km){const Ra=ta.$w.shapeNode;if(Ra){if((R=this.el.sz())&&R.length){ta=[];for(const nb of R)nb.anchorShape===Ra.get_shapeId()&&
ta.push(nb);this.Km.vsl(ta)}}else Lb.a.J(527501376,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")}}Vrl(){try{if(this.kVb&&this.Yl){const R=Object(yb.a)(959,this.Yl);R&&(R.tnh=!!this.Wh)}}catch(R){Lb.a.J(527501377,805,10,"TabbedTaskPane - Exception while updating if draft comment is closed for tabbed flow",R)}}C0f(){return this.Wh&&this.Wh.P6&&this.ua.Ca?!re.a.Sma(this.Wh.P6,this.ua.Ca.Cb):!1}Cqb(){return this.Wh&&this.ua.Ca?!this.Wh.P6||re.a.Sma(this.Wh.P6,this.ua.Ca.Cb):
!1}Ech(){if(this.jr&&this.jr.isIntegratedExtensionEnabled()){const R=this.el.sz(),ta=!this.kBa||!this.TEa;R&&0<R.length&&(this.JQ(!0,!0,ta),this.Mcd());this.Cqb()&&this.Dch(this.Wh)}}Rjk(){if(this.jr){this.Vrl();this.Ech();const R=this.hFb;R&&0!==R.status&&this.oJa(1)}}Sjk(){this.bXb();const R=!this.kBa||!(this.WY()&&this.TEa);this.JQ(!1,!1,R)}ekk(R){this.Zvb!==R&&(this.Zvb=R,this.Kc&&this.Kc.Mc&&this.Kc.Mc.pAh(2,!1,this.Zvb))}Ykg(){const R=Object.assign(new fd,{paneClosedCallback:Object(Ea.a)(this,
this.Rjk,"onPaneClosedCallback"),paneOpenedCallback:Object(Ea.a)(this,this.Sjk,"onPaneOpenedCallback"),positionsUpdatedScrollHeightCallback:Object(Ea.a)(this,this.ekk,"onPositionUpdatedScrollHeightCallback")});this.Ha.xic&&(R.allContainersVisibleCallback=Object(Ea.a)(this,this.Uek,"onAllContainersVisible"));this.jr=floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(R)}ewj(){this.dwk&&this.p5j.execute(R=>{const ta=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();
ta?ta.registerSafelinksNavigator(Object(Ea.a)(R,R.Mkd,"tryNavigate")):Lb.a.J(527501378,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}Mtj(){this.Ykg();this.JQ(!0,!1,!0);this.jge=!0;const R=this.ZZb();cc.a.Ybd(R,[rb.a.contextMenu]);if(this.jr){this.jr.setDhcContainerPanel(R,this.ika);var ta=Object.assign(new Vf,{width:parseFloat(R.style.width),height:this.Ohb,x:0,y:0});this.jr.updateViewport(ta);this.jr.setCompactContainers(this.mqb)}this.Mcd();
this.tD.qhk(this.ua.Lj);ta=this.Ga.Bc(Od.a.K1);ta.HK=!0;ta.hZa=!0;ta.vaa(Ra=>{this.Jcc(!0,!Ra||Ra.name!==Od.a.oC,!0)});ta.wza((Ra,nb)=>{Ra=(nb.name===Od.a.fO||nb.name===Od.a.hea)&&Ra.name===Od.a.K1;this.Jcc(!1,!1,nb.name===Od.a.Ep||nb.name===Od.a.sg||nb.name===Od.a.oC||nb.name===Od.a.K1||this.kVb&&nb.name===Od.a.rO||Ra)});this.Ga.WPc(Od.a.K1,Od.a.kj,R);this.$$g();this.ia.ya(id.a.zwa,Jb.a.frame,Object(Ea.a)(this,this.zwa,"showHideComments"))}Mcd(){const R=this.el.sz();this.Ach(R)}$$g(){if(this.jr){const R=
this.ZZb();if(R){const ta=this.Ga.Bc(Od.a.K1);this.jd.bEb(rb.a.click,R,Object(Ea.a)(this,this.LBb,"onCommentPaneParentDivClick"),null,ta.hZa)}}}Pyh(){if(this.jr){const R=this.ZZb();R&&this.jd.zb(rb.a.click,R,Object(Ea.a)(this,this.LBb,"onCommentPaneParentDivClick"))}}ZZb(){const R=this.Kc&&this.Kc.Mc?this.Kc.Mc.Naa:null;return R?R.za:null}Ach(R){if(this.Kc.Mc&&this.jge){if(!this.jr)try{this.Ykg(),Lb.a.J(527501379,801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",
!!this.jr)}catch(nb){Lb.a.J(527501380,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",nb);return}var ta=Date.now();if((R=this.fVf(R))&&R.length){var Ra=this.ZZb();Ra.setAttribute(Yd.a.ff,"group");if(Ra){this.U2=this.MYi(R);Lb.a.J(527501381,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",this.U2.count);if(!this.U2.count&&!this.nRa){this.JQ(!1,!1,!0);Lb.a.J(527501382,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",
Date.now()-ta);return}this.jr.setDhcContainerPanel(Ra,this.ika);this.jr.attachContainers(this.U2.toArray());this.JQ(!0,!1,!0)}Lb.a.J(527501383,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",Date.now()-ta)}}}fVf(R){if(!R||!R.length)return R;const ta=new r.a;for(const Ra of R)0!==Ra.status?this.eVf(Ra.commentId):ta.add(Ra);return ta.toArray()}vtl(){this.ree=!1;if(!this.En.bqh&&!this.En.KM&&this.Kc.Mc){var R=this.el.P5a(this.Kc.Mc.Ud);for(const ta of R)if(0===ta.status){this.selectComment(ta,
null,!0,!0,0,0,!1);break}}}$aj(){if(!this.Kc||!this.Kc.Mc||!this.Kc.Mc.Ud)return this.Ohb;var R=this.Kc.Mc.Ud;if(isNaN(R.Gk))return this.Ohb;R=R.Gk;return 0>R?this.Ohb:R}C5f(R){var ta=this.En.U6(R);R=R.pos.Y;ta&&(R+=ta.uC.y,ta.xh&&(ta=this.Fa.ys(ta),R+=ta&&ta.uC?ta.uC.y:0));return this.mAa(0,R).y}YRe(){if(this.jr){const R=this.$aj();R!==this.nJg&&(this.nJg=R,this.jr.setSlideHeight(R))}}Dch(R){if(R&&0===R.ENa){var ta=0;if(this.mqb)ta=-this.Ohb,this.YRe();else{const Ra=this.sa.Dq();Ra&&(ta=this.mAa(0,
Ra.uC.y).y)}ta=Object.assign(new Lf,{contentId:R.GB.draftId,containerContentType:0,anchorTop:ta,anchorLeft:0});this.JQ(!0,!0,!0);this.jr.setDhcContainerPanel(this.ZZb(),this.ika);this.jr.updateDrafting(ta,!0);this.jr.selectContainer(R.GB.draftId,!0)}}sPk(R){if(this.U2){var ta=0,Ra="";if(this.mqb){var nb=this.sa.Dq();nb&&(ta=this.mAa(0,nb.uC.y).y);if(nb=this.el.sz())for(const Cb of nb)Cc.a.Xa(Cb.commentId)||this.C5f(Cb)!==ta||(Ra=Cb.commentId)}ta=Object.assign(new Lf,{contentId:R,containerContentType:0,
anchorTop:ta,anchorLeft:0});this.mqb?this.jr.updateDraftingAndPosition(ta,!1,Ra):this.jr.updateDrafting(ta,!1);this.jr.selectContainer(R,!0)}}eVf(R){if(this.jr&&this.U2){for(let ta of this.U2)Sg.eRg(ta,R)&&(this.jr.detachContainers([ta]),this.U2.remove(ta));this.WY()||this.nRa||this.JQ(!1,!1,!0)}}GZk(){this.ree=!0}EHc(){this.kVb&&this.Yl&&this.Yl.isVisible&&this.Yl.sWk()}ZMi(){var R=this.ua.presentation;if(!R)return!1;R=R.slides;if(!R)return!1;for(const ta of R)if(R=Object(yb.a)(ce.a,ta))for(const Ra of this.el.gra(R.KE()))if(od.TM(Ra))return!0;
return!1}F0d(R){var ta=this.ua.presentation;if(!ta)return null;ta=ta.slides;if(!ta)return null;for(const Ra of ta)if(ta=Object(yb.a)(ce.a,Ra),re.a.Sma(ta.Cb,R))return ta;return null}QMi(){return this.RMd||this.Zni&&this.ZMi()}Fdg(){const R=this.sa.Pa.kb,ta=this.sa.Pa.V4;if(!R||!ta)return null;var Ra=Object(yb.a)(5,R.Wa.node),nb=Object(yb.a)(5,ta.Wa.node);if(!Ra||!nb)return null;Ra=Object(yb.a)(Qb.TableCellNode,Ra.nK());nb=Object(yb.a)(Qb.TableCellNode,nb.nK());return Ra&&nb?Ra.rowIndex>nb.rowIndex?
R:ta:null}fdj(){if(!this.QMi()||!this.sa.w7())return null;Lb.a.J(527501384,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");var R=0,ta=0;if(this.sa.Pa.nl){var Ra=this.Fdg();if(!Ra)return Lb.a.J(527501385,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null;var nb=Ra}else nb=this.sa.Pa.kb;if(!nb)return Lb.a.J(527501386,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),
null;const Cb=({zIa:R,aBa:ta}=od.edj(this.sa.dZ(),nb,R,ta)).returnValue;if(!Cb||0>R||0>ta||0>=ta-R)return Lb.a.J(527501387,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",!Cb,ta,R),null;Ra=new Ia.a;Ra.StartPos=R;Ra.EndPos=ta;if(this.sa.RRa()&&Cb.get_smartArtModelId()){Lb.a.J(527501388,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");Ra.AnchoringShape=new qj.a;
R=K.a.ig(Cb.get_smartArtModelId()).toString();if(!R||!K.a.isValid(R))return Lb.a.J(527501389,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!R),null;Ra.AnchoringShape.SmartArtNodeId=R;this.tD.JVj()}else if(Cb.Nr()){Lb.a.J(527501390,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");ta=Object(yb.a)(Qb.TableCellNode,Cb.nK());if(!ta)return Lb.a.J(527501391,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),
null;R=ta.rowId.toString();ta=ta.cellId.toString();if(!(R&&ta&&K.a.isValid(R)&&K.a.isValid(ta)))return Lb.a.J(527501392,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",!R,!ta),null;Ra.AnchoringShape=new qj.a;Ra.AnchoringShape.TableCell=new mf;Ra.AnchoringShape.TableCell.RowId=R;Ra.AnchoringShape.TableCell.ColId=ta;this.tD.KVj()}R=Object(yb.a)(5,nb.Wa.node);nb=Object(yb.a)(5,nb.We.node);R!==nb&&this.tD.MVj();Lb.a.J(527501393,805,
50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");return Ra}IDi(R){if(this.jr&&R){for(const ta of this.U2.toArray()){let Ra=!1;for(const nb of R)if(Sg.eRg(ta,nb.commentId)){Ra=!0;break}Ra||(this.jr.detachContainers([ta]),this.U2.remove(ta),Lb.a.J(527501394,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",ta.contentId))}this.WY()||this.nRa||this.JQ(!1,!1,!0)}}bXb(){if(this.jr){for(const R of this.U2.toArray())this.jr.detachContainers([R]);this.U2.clear()}this.WY()||
this.nRa||(this.kBa&&!this.TEa?this.JQ(!1,!1,!1):this.JQ(!1,!1,!0))}oMe(R){if(!R)return null;R.sort((ta,Ra)=>{var nb=this.En.U6(ta);nb=nb?nb.uC:new oc.a(0,0);var Cb=this.En.U6(Ra);Cb=Cb?Cb.uC:new oc.a(0,0);nb.y+=ta.pos.Y;Cb.y+=Ra.pos.Y;nb.x+=ta.pos.X;Cb.x+=Ra.pos.X;let mc=nb.y-Cb.y;mc||(mc=nb.x-Cb.x)||(mc=+ta.dt-+Ra.dt);return mc});return R}MYi(R){const ta=new r.a;if(R){this.mqb&&this.YRe();for(const Ra of R)Cc.a.Xa(Ra.commentId)||(R=this.C5f(Ra),R=Object.assign(new Lf,{contentId:Ra.commentId,containerContentType:0,
anchorTop:R,anchorLeft:0}),ta.add(R))}return ta}UW(R){this.bYg(R)}Eah(R,ta){for(let Ra=0;Ra<R.Ra.length;Ra++){const nb=R.Ra.ga(Ra);if(!nb.wg)continue;const Cb=[];for(let mc=0;mc<nb.wg.length;mc++){const Sc=nb.wg.ga(mc);Sc.GH.equals(ta)&&Cb.push(Sc)}if(!(1>Cb.length))try{R.Zma=!0;for(const mc of Cb)nb.wg.remove(mc)}catch(mc){Lb.a.J(527501395,805,10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",mc.toString())}finally{R.Zma=!1}}}Yzf(R,ta,Ra){R.wg||
(R.wg=new Md.a(R));const nb=R.wg.xe.paragraph;ta=new ij.a(R.wg.xe,null,ta,Ra);R.wg.add(ta);nb.vu()}EEc(R){return yc.a.ig("{"+R+"}{1}")}hSb(R,ta,Ra,nb){let Cb=null;for(let mc=0;mc<R.Ra.length;mc++){let Sc=R.Ra.ga(mc);if(Sc.cp>=Ra){try{R.Zma=!0;if(Sc.cp>Ra||!Sc.formatting)this.cW.yea(R,mc,Ra,Cb),Sc=R.Ra.ga(mc);this.Yzf(Sc,ta,nb)}catch(jd){Lb.a.J(527501396,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",jd.toString())}finally{R.Zma=!1}return}Sc.formatting&&
(Cb=Sc.formatting)}if(Rc.ParagraphReader.textLength(R)>=Ra)try{R.Zma=!0;this.cW.yea(R,R.Ra.length,Ra,Cb);const mc=R.Ra.ga(R.Ra.length-1);this.Yzf(mc,ta,nb)}catch(mc){Lb.a.J(527501397,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",mc.toString())}finally{R.Zma=!1}}JXb(){if(this.ps){var R=this.el.sz();if(R){var ta=Date.now(),Ra=!1,nb=new Ja.a;for(var Cb of R){var mc=od.v0b(Cb,this.En.U6(Cb));nb.$(Cb.commentId,mc)}for(var Sc of R)if(Sc.textAnchoringInfo&&
(Cb=this.En.U6(Sc))&&(mc=nb.ga(Sc.commentId),!mc||!mc.isValid||mc.Qwg(Sc.textAnchoringInfo)))for(var jd of Cb.hD())this.Eah(Object(yb.a)(Qc.AParagraphNode,jd),this.EEc(Sc.commentId));for(const Ad of R)if((R=nb.ga(Ad.commentId))&&R.isValid&&R.Qwg(Ad.textAnchoringInfo)&&(this.Yl.isVisible||0===Ad.status)){Ra=this.EEc(Ad.commentId);this.hSb(R.QT,Ra,R.startPos,!0);if(R.A4b)for(Sc=1;Sc<R.paragraphs.length;Sc++){if(jd=R.paragraphs[Sc])this.hSb(jd,Ra,0,!0),R.V1.equals(jd)?this.hSb(R.V1,Ra,R.endPos,!1):this.hSb(jd,
Ra,Rc.ParagraphReader.textLength(jd),!1)}else this.hSb(R.V1,Ra,R.endPos,!1);R.Fyj();Ra=!0}Ra&&Lb.a.J(527501398,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",Date.now()-ta)}}}S_g(R,ta){R=this.el.fra(ta.node);if(this.ps&&R&&(ta.property===sc.a.Llc||ta.property===sc.a.Klc||ta.property===sc.a.ujd||ta.property===sc.a.vjd)){const Ra=od.TM(R);Ra&&this.JXb();!R.textAnchoringInfo||Ra||ta.property!==sc.a.vjd&&ta.property!==sc.a.ujd||this.tD.LVj(R,this.EEc(R.commentId),this.En.U6(R),
this.Kc.Mc.Na)}}QYf(){this.Wh&&this.O8&&(this.KZ.TGe(this.O8.length,this.nab,this.ro,this.see.GUc),this.KZ.YGe(Array.clone(this.O8),Array.clone(this.nbb)),this.GLf(2))}zLj(R,ta){ta=this.Ib.Jc(ta);for(var Ra=ta.yb(2);Ra;Ra=ta.xf(2))if((Ra=Object(yb.a)(131,Ra))&&re.a.Sma(Ra.Cb,R))return!0;return!1}YA(R,ta){ta&&(R=Object(yb.a)(408,ta.node),ta=ta.GY,R&&2===ta&&((ta=this.DW.Bf)&&ta.slides&&0>=ta.slides.length&&this.Yl.isVisible&&this.ihc(!1,!1),this.Wh&&(ta=this.Wh.P6,!ta&&this.ua.Ca&&(ta=this.ua.Ca.Cb),
this.zLj(ta,R)||this.QYf())))}UVg(R,ta){R=this.el.fra(ta.node);if(this.ps&&R&&od.TM(R)&&(ta=this.En.U6(R)))for(const Ra of ta.hD())this.Eah(Object(yb.a)(Qc.AParagraphNode,Ra),this.EEc(R.commentId))}SZg(R,ta){R=Object(yb.a)(4,ta.node);this.ps&&R&&0<R.hD().length&&(ta.spg&192||ta.spg&4)&&this.JXb()}kdc(R,ta){R=ta.property;ta=ta.node;if(R===$g.a.My||R===$g.a.Ny)if(R=this.el.sz()){for(const Ra of R)Ra.pos.Y=ta.uC.y,Ra.pos.X=ta.uC.x;this.Mcd()}}b8c(){Lb.a.J(527501399,805,this.W6a?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",
this.W6a)}Pcb(R,ta){Lb.a.J(527501400,805,this.W6a?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",Og.a[ta.aJ],this.W6a)}dispose(){this.Km&&(this.Km.dispose(),this.Km=null);this.xyb&&(this.xyb.dispose(),this.xyb=null);this.Kx.Jbh(Object(Ea.a)(this,this.BGa,"onBeforeSlideSwitched"));this.Kx.lma(Object(Ea.a)(this,this.TRe,"updateCommentsWhenNavigateSlide"));this.Kx.oEb(Object(Ea.a)(this,this.Ezf,"activeSlideDOMDisplayed"));this.Hn.NNk(Object(Ea.a)(this,this.TYg,
"onPageViewZoomChanged"));this.Pr.lch(Object(Ea.a)(this,this.onShapeSelected,"onShapeSelected"));this.Pr.$Nk(Object(Ea.a)(this,this.OZg,"onShapeDeselected"));this.Kx.Gcd(Object(Ea.a)(this,this.ZZg,"onShapeTextSelected"));this.Kx.och(Object(Ea.a)(this,this.ndc,"onSlideBackgroundClicked"));this.kbb.Pm(Object(Ea.a)(this,this.kdc,"onShapePropertyChange"));this.kbb.KNk(Object(Ea.a)(this,this.SZg,"onShapeInvalidation"));this.Xc.wMk(Object(Ea.a)(this,this.cXg,"onF6FocusDocument"));this.x3c.Pm(Object(Ea.a)(this,
this.S_g,"onTextAnchorPropertyChanged"));this.eLg.kO(Object(Ea.a)(this,this.YA,"onChildTopologyChanged"));this.x3c.wHa(Object(Ea.a)(this,this.UVg,"onBeforeTextAnchorDisconnect"));this.Rb.Q_(Object(Ea.a)(this,this.BVg,"onAppModeSwitched"));this.gXc.ich(Object(Ea.a)(this,this.b8c,"onSessionExpired"));this.gXc.aea(Object(Ea.a)(this,this.Pcb,"onSessionEnded"));this.Rb.qEb(Object(Ea.a)(this,this.UW,"onSetOffline"));this.IG||this.jd.zb(rb.a.click,this.Syb,Object(Ea.a)(this,this.LBb,"onCommentPaneParentDivClick"));
this.Pyh();this.Nca=this.Syb=null;this.hv.Fcd(Object(Ea.a)(this,this.f8c,"onShapeViewElementAddedOrRemoved"));this.hv.eOk(Object(Ea.a)(this,this.f8c,"onShapeViewElementAddedOrRemoved"));this.sa.yHa(Object(Ea.a)(this,this.VG,"onSelectionChanged"))}get isReadOnly(){return this.ro}get nRa(){return!!this.Wh}get hasFocus(){return this.xge}Oti(){const R=new vg.a;var ta=new Fh(id.a.ytb,tb.a.application);ta.preCallback=Object(Ea.a)(this,this.LCc,"claimFocus");ta.postCallback=Object(Ea.a)(this,this.YVf,"disableOnEmptyDeckAndReadOnly");
R.$(0,ta);ta=new Fh(id.a.deleteComment,tb.a.application);ta.preCallback=Object(Ea.a)(this,this.LCc,"claimFocus");ta.postCallback=Object(Ea.a)(this,this.YVf,"disableOnEmptyDeckAndReadOnly");R.$(3,ta);ta=new Fh(id.a.w5g,tb.a.application);ta.preCallback=Object(Ea.a)(this,this.LCc,"claimFocus");ta.postCallback=Object(Ea.a)(this,this.b4g,"postCommentAction");R.$(2,ta);ta=new Fh(id.a.DTg,tb.a.application);ta.preCallback=Object(Ea.a)(this,this.LCc,"claimFocus");ta.postCallback=Object(Ea.a)(this,this.b4g,
"postCommentAction");R.$(1,ta);ta=new Fh(db.a.mmc,tb.a.application);ta.preCallback=Object(Ea.a)(this,this.f$k,"showHideActionPreCallback");ta.postCallback=Object(Ea.a)(this,this.e$k,"showHideActionPostCallback");ta.delayActionsUntilRegistration=this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Sd.a("DelayCommentsShowHideAction");R.$(6,ta);return R}f$k(R,ta,Ra,nb,Cb){if(1===Ra)return!this.ua.Ca||this.V7a?8:2;Lb.a.J(36983504,805,50,"New Comment Pane opened.");this.Yl.zBb(!!Cb&&
Cb.AutoShowHide);return 2}e$k(R,ta,Ra,nb,Cb,mc){if(1===nb)return R&&this.tD.Wfk(this.ua.Lj),R?32:8;this.bDf(this.Yl.isVisible,!!mc&&mc.AutoShowHide);return R?32:8}LCc(R,ta,Ra,nb,Cb){if(1===Ra&&this.sa.gRa())return 8;1!==Ra&&((this.I7b=!!Cb&&Cb.ShouldCanvasTakeFocus)||this.Aqa(),this.sa.gy(),this.Oge=!0);return 2}b4g(R,ta,Ra,nb){if(1===nb&&(this.JTa||!this.O8))return 8;this.I7b=!1;return R?32:8}YVf(R,ta,Ra,nb){return(1!==nb||!this.ro&&this.O8)&&this.Kc.Mc?R?32:8:8}mAa(R,ta){return new oc.a(this.R0c.Ie(R,
0),this.R0c.Ie(ta,1))}cQf(R,ta){return new oc.a(this.R0c.yf(R,0),this.R0c.yf(ta,1))}Crb(R){R=this.el.RBa(R);return this.el.fra(R)}jea(R,ta,Ra){!this.C0f()||R!==this.Wh.GB.draftId&&R!==this.Wh.commentId?this.Cqb()&&R===this.Wh.GB.draftId?(this.KZ.selectComment(R),this.jr&&this.jr.selectContainer(R,!0),this.x0f&&!this.hasFocus&&1!==ta&&this.Aqa()):this.selectComment(this.Crb(R),null,!0,!0,0,ta,Ra):(R=this.F0d(this.Wh.P6),R)?1!==ta&&(this.Wh.pTc=!0,this.Je.rda(R.Ge)):(Lb.a.J(527501401,805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),
this.endCommentSession(this.Wh.GB.draftId,0))}selectComment(R,ta,Ra,nb,Cb,mc,Sc){this.sa.gy();ta=this.hFb?this.hFb.commentId:null;Sc||this.EHc();0!==mc?R?this.KZ.selectComment(R.commentId):this.KZ.selectComment(null):0===mc&&(mc=this.En.U6(R))&&mc.HR&&this.En.Med(jj[mc.HR]);this.Km&&this.Km.selectComment(R,!0);!this.Yl.isVisible&&this.jr&&R&&R!==this.GSa&&(mc=this.el.b0d(R.commentId))&&(mc=this.el.fra(mc),this.jr.selectContainer(mc.commentId,!this.I7b&&!Sc&&!this.Oge),this.Oge=!1,this.Kc&&this.Kc.Mc&&
this.Kc.Mc.Ild(5,!1,this.Zvb));Sc||this.I7b||this.Aqa();!this.En||!this.Yl.isVisible&&this.Yl.isVisible||(this.En.wGe(R,ta,!0,!1,Sc),od.TM(R)&&!Sc&&this.JXb());this.Rb.updateCommandUI()}get hFb(){return this.Km&&this.Km.kFb?this.Km.kFb.comment:null}wWk(){if(!this.JTa){const R=Na.a.Nm("SelectNextCommentCrossSlide",1),ta=!this.Yl.isVisible;this.JTa=!0;this.BYc.ZUd((Ra,nb)=>{this.tXg(Ra,nb,1,R)},R,ta)}}zWk(){if(!this.JTa){const R=Na.a.Nm("SelectPreviousCommentCrossSlide",1),ta=!this.Yl.isVisible;this.JTa=
!0;this.BYc.fVd((Ra,nb)=>{this.tXg(Ra,nb,0,R)},R,ta)}}tXg(R,ta,Ra,nb){nb.Dm("FindCommentEndTime",new Date);this.Bb.Hb(new Cd.a(2,1,100,()=>{this.JTa&&(this.JTa=!1,this.g7k(R,ta,Ra)?this.jea(this.Wh.commentId||this.Wh.GB.draftId,0,!1):ta&&R&&this.Kc.Mc.Ud?R.Cb.equals(this.Kc.Mc.Ud.Cb)?(this.selectComment(ta,null,!0,!0,2,1,!1),nb.Ya("CircularSelectCommentInSingleSlide",Ng[Ra]),nb.finish()):(this.bEa=Object.assign(new wi,{slide:R,comment:ta,direction:Ra,vGe:nb}),this.Je.rda(R.Ge)):(this.Rb.updateCommandUI(),
nb.Ya("NoCommentFound",Ng[Ra]),nb.finish()))},90,"47"))}U9f(){let R=-1;if(!this.Wh)return R;if(this.Wh.P6){const ta=this.F0d(this.Wh.P6);ta&&(R=ta.Ge)}else this.Kc.Mc&&this.Kc.Mc.Ud&&(R=this.Kc.Mc.Ud.Ge);return R}g7k(R,ta,Ra){if(!this.Wh||this.Wh.GB.sessionType!==eb.create)return!1;const nb=this.U9f();if(0>nb)return!1;if(!ta||!R)return!0;ta=this.Kc.Mc.Ud.Ge;if(1===Ra)return Ra=nb<=ta&&ta<R.Ge,ta=R.Ge<=ta&&ta<nb,nb<=R.Ge&&!Ra||ta;Ra=nb>=ta&&ta>R.Ge;ta=R.Ge>=ta&&ta>nb;return nb>R.Ge&&!Ra||ta}oJa(R){0!==
R&&this.KZ.selectComment(null);this.Km&&this.Km.selectComment(null,!1);if(this.jr&&(this.jr.deselectContainer(),this.Kc&&this.Kc.Mc)){let ta=5;const Ra=this.sa.Dq();Ra&&Ra.fg&&(ta=2);this.Kc.Mc.Ild(ta,!1,this.Zvb)}this.En&&0!==R&&(this.En.dGc(),this.En.GFc());this.Rb.updateCommandUI()}CXh(R){this.nmb(this.Crb(R),0)}nmb(R,ta){this.GSa!==R&&(this.En&&(R?this.En.BXh(R):this.En.GFc()),this.GSa=R,0!==ta&&(this.GSa?this.KZ.highlightComment(this.GSa.commentId):this.KZ.highlightComment(null)),this.Km&&this.Km.nmb(this.GSa,
!0))}uWk(){if(this.OWb){var R=this.Crb(this.OWb),ta=this.Kc.Mc.Ud.sid,Ra=ta===parseInt(this.gQd);R?(1!==R.status&&2!==R.status||this.dhd(),this.selectComment(R,null,!0,!0,0,1,!1),this.tD.tgk(this.ua.Lj),Lb.a.J(527501403,804,15,"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",this.OWb,this.gQd)):(Ra&&this.Wd.Mr(Object.assign(new Ag.a,{Code:389,Source:4}),this.Za.podSessionId),Lb.a.J(527501402,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",
this.OWb,this.gQd,parseInt(ta)))}}get manager(){return this.el}get NR(){return"per"}get dRg(){return this.Nca}set dRg(R){this.Nca=R;this.Km&&(this.Km.parentElement=R)}get CTg(){return this.v9b}set CTg(R){this.v9b=R}Sbd(R){this.ghc(R,void 0,!0)}RW(R,ta){ta=!Sd.a("FixAltF12KeboardingInCommentPane")||ta;this.Jcc(R,ta,!0)}wCe(){!this.IG&&this.Yl&&(this.Syb.style.display=this.Yl.isVisible?"flex":"none");this.Km&&(this.Km.setVisibility(this.k$a),this.Km.Moh(this.m$a),this.En.Npb(this.GSa))}ihc(R,ta){this.Gxh(R,
ta);this.wCe();this.bDf(R,ta)}TYg(){this.Km&&!this.F7b&&this.Km.vSe();this.Mcd();this.mqb&&this.YRe()}d5g(){this.JTa=!1;this.iZf();this.Km&&this.Km.SCe();this.Azb=!1;this.Pyh()}iZf(){this.el.$yh()}BGa(){this.TEa=this.WY()||this.Cqb();this.En&&this.TEa&&(this.En.dGc(),this.En.GFc());this.jUd&&(this.d5g(),this.KGf())}H7k(){return this.Wh&&this.Wh.P6&&this.ua.Ca?this.Wh.pTc&&re.a.Sma(this.Wh.P6,this.ua.Ca.Cb):!1}TRe(){this.jUd||this.d5g();this.ua.Ca||this.BGa(this,null);this.iZf();this.Kc.Mc&&(this.dRg=
this.Kc.Mc.NMd);const R=this.Kc&&this.Kc.Mc?this.el.P5a(this.Kc.Mc.Ud):this.el.sz(),ta=this.T2i(R),Ra=this.WY()||this.Cqb();!this.Ha.xic||this.r1c||Ra||(this.nm.t9(this.nm.bLd,this.nm.QMd),this.r1c=!0);this.Yl.isVisible||(Ra?(this.bXb(),this.Ech()):this.WY()?(this.bXb(),this.JQ(!0,!1,!0)):this.kBa&&!this.TEa?this.JQ(!1,!1,!1):this.JQ(!1,!1,!0),this.$$g());this.ghc(R,e.AFrameworkApplication.isRtl,!1,ta);this.H7k()?(this.jea(this.Wh.commentId||this.Wh.GB.draftId,0,!1),this.Wh.pTc=!1):-1<ta&&this.jea(R[ta].commentId,
0,!1);this.bEa&&(this.bEa.vGe.finish(),this.bEa=null);this.aZa(!1);-1!==ta&&this.Km&&(this.Km.nmb(null,!1),this.Km.selectComment(R[ta],!1));this.jUd||this.KGf()}Ezf(){if(this.Soe){try{this.K9a.jal(this.HMg,this.ua,this.Je)}catch(R){Lb.a.J(527501404,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",R)}this.Soe=!1}}aZa(R){const ta=this.U9f();this.see.aZa(R,ta)}mrl(R){this.Wh&&!this.Wh.P6&&(this.Wh.P6=R)}onShapeSelected(R,ta){this.mIc&&(R=ta.shapeNode,
this.AJe(R),this.ps&&R&&0<R.hD().length&&this.JXb())}ZZg(R,ta){this.mIc&&(this.AJe(ta.$w.shapeNode),this.ps&&this.JXb())}VG(R,ta){this.x0f&&this.W6a&&this.oJa(1);if(this.ps&&ta&&ta.Sk&&this.sa.w7()&&(R=this.el.sz())){ta=!1;for(var Ra of R)if(od.TM(Ra)){ta=!0;break}ta&&((Ra=this.sa.dZ())?this.AJe(Ra):Lb.a.J(527501405,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}}AJe(R){R.get_shapeId()&&(this.En&&R!==this.En.KM&&this.oJa(1),this.vhh(R.get_shapeId(),
!0))}vhh(R,ta){var Ra=this.el.sz();if(Ra){var nb=null,Cb=null,mc=0,Sc=null;for(const jd of Ra)if((this.Yl.isVisible||0===jd.status)&&jd.anchorShape===R)if(this.ps&&this.sa.w7()&&od.TM(jd)){Ra=this.sa.Pa.kb.Wa;const Ad=this.sa.Pa.kb.We,ve=od.v0b(jd,this.En.U6(jd));ve&&ve.isValid?(this.hFb&&this.hFb.commentId===jd.commentId||ve.xjd===jd.textAnchoringInfo.TextBodyLength)&&ve.dCj(Ra,Ad)&&(Cb?(Ra=ve.x9g,Ra<mc&&(Cb=jd,mc=Ra)):(Cb=jd,mc=ve.x9g)):(nb=jd,Lb.a.J(527501406,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null."))}else if(!Cb&&
!Sc)if(this.ps)od.TM(jd)||(Sc=jd);else{Sc=jd;break}Cb?this.jea(Cb.commentId,1,ta):Sc?this.jea(Sc.commentId,1,ta):this.ps&&this.sa.w7()&&!nb?this.En&&this.oJa(1):nb&&this.jea(nb.commentId,1,ta)}}OZg(){if(this.mIc){var R=this.$Xd();this.En.Med(String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,R.toString()));this.oJa(1)}}$Xd(){const R=this.el.sz();let ta=[];R&&(ta=Lc.e(R,Ra=>0===Ra.status));return ta.length}ndc(){this.mIc&&this.oJa(1)}cXg(R,ta){ta.qBb===Od.a.sg&&this.En.Med(ResourceStrings.l_SlidePanel+
", "+String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,this.$Xd().toString()));ta.vfc===Od.a.sg&&this.oJa(1)}T2i(R){let ta=-1;if(this.bEa&&this.Kc.Mc)if(this.bEa.slide!==this.Kc.Mc.Ud)Lb.a.J(527501407,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");else if(R&&0<R.length){if(this.Yl.isVisible)ta=1===this.bEa.direction?0:R.length-1;else if(1===this.bEa.direction)for(var Ra=0;Ra<R.length;Ra++){if(0===R[Ra].status){ta=Ra;break}}else for(Ra=
R.length-1;0<=Ra;Ra--)if(0===R[Ra].status){ta=Ra;break}0<=ta&&ta<R.length&&(R=R[ta],Ra=this.bEa.comment,Ra.dt===R.dt&&Ra.commentId===R.commentId&&Ra.authorName===R.authorName||Lb.a.J(527501408,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide"))}return ta}pWg(){this.el.S1i()?this.Wh&&(0===this.Wh.ENa||1===this.Wh.ENa?(this.I0f&&this.ghc(this.el.sz(),e.AFrameworkApplication.isRtl,!0),0===this.Wh.ENa&&(this.p2c=!0)):this.Wh&&2===this.Wh.ENa&&this.I0f&&this.ghc(this.el.sz(),
e.AFrameworkApplication.isRtl,!0)):this.ghc(this.el.sz(),e.AFrameworkApplication.isRtl,!0)}get Ged(){const R=this.sa.Dq();if(R){const ta=R.uC;this.Eoe=new oc.a(e.AFrameworkApplication.isRtl?ta.x:ta.x+R.Bx,ta.y)}else this.Eoe=null;return this.Eoe}get LWk(){if(!this.sa.w7())return null;var R=Object(yb.a)(5,this.sa.Pa.kb.We.node);if(!R)return null;const ta=Object(yb.a)(735,R.pc(this.Kc.Mc.Na));if(!ta)return null;var Ra=null,nb=ta.htmlElement.getElementsByClassName("Selected");if(0<nb.length)Ra=nb[nb.length-
1];else if(this.sa.Pa.nl){if(nb=this.Fdg())if(nb=Object(yb.a)(5,nb.We.node))if(nb!==R){if(R=Object(yb.a)(735,nb.pc(this.Kc.Mc.Na)))Ra=R.htmlElement}else Ra=ta.htmlElement}else return null;R=this.sa.Dq();if(!R||!Ra)return null;R=Object(yb.a)(133,R.pc(this.Kc.Mc.Na));if(!R)return null;Ra=Gh.a.ei(Ra);R=Gh.a.ei(R.qq);if(0>=Ra.width+Ra.height&&0>=R.width+R.height)return null;R=oc.a.WT(new oc.a(Ra.x,Ra.y),new oc.a(R.x,R.y));return this.cQf(R.x+Ra.width-5,R.y+10)}get anchorNode(){const R=this.sa.Dq();return this.CBg=
R?R:this.Kc.Mc.Ud}Gxh(R,ta){this.Yl&&(ta||this.$ih(),this.Sbb.vlh(R?3:1),this.JQ(!R,!1,!0),this.Yl.Uo(!this.V7a&&R,ta),this.Yl.isVisible&&(this.k$a=!0))}JQ(R,ta,Ra){const nb=this.WY();Ra&&(!nb&&!this.TEa||nb&&this.TEa)&&Lb.a.J(527501409,805,50,"Slide Resize and render was called for Navigation between slides without comments or both slides with comments but it was unnecessary.");!this.WY()&&!this.nRa&&R&&!ta||this.Yl.isVisible&&R&&!ta||this.WY()&&this.X7&&this.X7.isVisible&&!R&&!ta||!this.Kc.Mc||
!(ta=this.Kc.Mc.Naa)||(ta.setVisibility(R),R=new gg.a(R),this.Kx.u8g(R),Ra?this.Rb.zBb(1):Lb.a.J(527501410,805,50,"Slide Resize and render was redundant. Navigation was between both slides without comments or both slides with comments"),this.Kc.Mc.Ild(5,!1,this.Zvb))}pol(R){this.Yl&&(this.k$a=!this.V7a&&R,this.k$a||(this.Sbb.vlh(1),this.Yl.Uo(!1,!1),this.Ga.Kj(Od.a.Ep,!1)))}Y6i(){const R=new Hh;this.Owe&&(R.focusCallback=Object(Ea.a)(this,this.sJc,"focusFirstPaneElement"));return Object.assign(new ih.a,
{title:ResourceStrings.L_Comments,hideHeader:!1,width:parseInt(this.Owe?300:320),contentProps:R,location:2,onOpen:ta=>{cc.a.Ybd(ta,[rb.a.contextMenu]);const Ra=this.Ga.Bc(Od.a.Ep);this.jd.bEb(rb.a.click,ta,Object(Ea.a)(this,this.LBb,"onCommentPaneParentDivClick"),null,Ra.hZa)},onClose:ta=>{this.ihc(!1,!1);this.jd.zb(rb.a.click,ta,Object(Ea.a)(this,this.LBb,"onCommentPaneParentDivClick"))},isModernPane:!0})}KGf(){if(!this.ZEg){var R=this.el.sz();R=!!R&&0<R.length;Lb.a.J(527501411,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",
R);R?this.WY()&&this.JQ(!0,!1,!0):(this.bXb(),this.kBa&&!this.TEa?this.JQ(!1,!1,!1):this.JQ(!1,!1,!0))}}dhd(){this.Yl.isVisible||this.ia.processAction(id.a.zwa,2);this.EHc()}Upj(){this.Yl.isVisible&&this.ia.processAction(id.a.zwa,2)}rk(R){return this.Qd.rk(R)}get V7a(){const R=this.DW.Bf;return R?R.Z6a:!0}YAf(){this.C1c||(this.C1c=new Cd.a(0,1,0,Object(Ea.a)(this,this.kHk,"refreshCommentsTask"),90,"48"),this.Bb.Hb(this.C1c))}BVg(R){this.bYg(1===R.mode)}bYg(R){this.ro=R;this.YAf();Sd.a("PreventCommentPaneCloseOnReadOnlyChanged")?
this.QYf():this.Yl.isVisible&&this.ro&&this.Upj()}j_d(){return this.O8?this.O8:[]}Bag(){return this.nbb?this.nbb:[]}get CUg(){return this.nab}get sFc(){return this.Wh}Q9f(R){const ta=this.Kc&&this.Kc.Mc?this.el.P5a(this.Kc.Mc.Ud):this.oMe(this.el.sz());if(!ta||!ta.length)return 0;let Ra=null;this.Ged&&(Ra=this.mAa(this.Ged.x,this.Ged.y));let nb=-1,Cb=0;for(let Ad=0;Ad<ta.length;Ad++){var mc=this.En.U6(ta[Ad]);if(!Ra&&mc)break;if(mc&&Ra){var Sc=mc.uC.x,jd=mc.uC.y;Sc+=ta[Ad].pos.X;jd+=ta[Ad].pos.Y;
mc.xh&&(mc=this.Fa.ys(mc),Sc+=mc&&mc.uC?mc.uC.x:0,jd+=mc&&mc.uC?mc.uC.y:0);jd=this.mAa(Sc,jd);Sc=jd.y;jd=jd.x;if(Ra.y<Sc)break;if(Ra.y>Sc||Ra.y===Sc&&Ra.x>=jd)nb=Ad,ta[Ad].Children&&R&&(Cb+=ta[Ad].Children.length)}else mc||(nb=Ad,ta[Ad].Children&&R&&(Cb+=ta[Ad].Children.length))}return nb+Cb+1}Dtj(R){if(!this.jge)throw Lb.a.J(527501440,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),H.a.Yt(-2130915320);if(this.Wh)return Lb.a.J(527501441,805,
15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),H.a.Yt(-2130915319);if(null===R)throw Error.argumentNull("session");if(!R.commentId.length&&0!==R.ENa)return H.a.Yt(-2130915327);this.Wh=R;this.aZa(!0);0===R.ENa&&(this.oJa(0),this.Yl.isVisible||this.Dch(R));if(this.Yl.isVisible||!this.Yl.isVisible)this.Aqa(),this.LIi();let ta="";R.GB&&(ta=R.GB.draftId);Lb.a.J(527501442,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",ta);return null}endCommentSession(R,
ta){if(this.Wh){if(this.Wh.GB&&this.Wh.GB.draftId!==R)throw Lb.a.J(527501443,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",R,this.Wh.GB.draftId),H.a.Yt(-2130915327);this.aDg=ta}9!==ta||this.Yl.isVisible||this.Ga.pC(Od.a.sg);this.Wh=null;this.Rb.updateCommandUI();if(this.jr&&!this.Yl.isVisible){const Ra=[Object.assign(new Lf,{contentId:R,containerContentType:0,anchorTop:0,anchorLeft:0})];this.jr.detachContainers(Ra);this.WY()||this.JQ(!1,!1,
!0)}this.k2c.Dvg&&this.ZVf();Lb.a.J(527501444,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",R,ta)}get Xni(){return this.aDg}E4(){this.Aqa()}nVf(R){if(this.Ha.ka("CommentCopyPasteEnabled")&&!this.K9a.ILj)for(const ta of R)for(const Ra of this.el.gra(ta.KE()))if(1===Ra.status){this.HMg=new Fj(R,this.el);this.Soe=!0;return}}wb(){this.ps&&1!==this.M7b.Oaa&&(this.ia.ya(id.a.jhd,tb.a.application,Object(Ea.a)(this,this.zwa,"showHideComments")),this.ia.ra(id.a.A7g,tb.a.application,
Object(Ea.a)(this,this.iHa,"queryShowHideComments"),97));this.vYf&&(this.ia.ya(id.a.o4a,tb.a.application,Object(Ea.a)(this,this.UWb,"deleteAllComments")),this.ia.ya(id.a.VWb,tb.a.application,Object(Ea.a)(this,this.UWb,"deleteAllComments")),this.ia.ya(id.a.WWb,tb.a.application,Object(Ea.a)(this,this.UWb,"deleteAllComments")));this.ia.ya(id.a.khd,tb.a.application,Object(Ea.a)(this,this.zwa,"showHideComments"));this.ia.ra(db.a.k8g,Jb.a.frame,Object(Ea.a)(this,this.iHa,"queryShowHideComments"),97);this.ia.ra(id.a.iHa,
tb.a.application,Object(Ea.a)(this,this.iHa,"queryShowHideComments"),97);this.ia.ra(id.a.C7g,tb.a.application,Object(Ea.a)(this,this.iHa,"queryShowHideComments"),97);this.ia.ra(id.a.D7g,tb.a.application,Object(Ea.a)(this,this.iHa,"queryShowHideComments"),97);this.ia.ya(id.a.Wre,tb.a.application,Object(Ea.a)(this,this.U5c,"nudgeCommentMarker"));this.ia.ya(id.a.Xre,tb.a.application,Object(Ea.a)(this,this.U5c,"nudgeCommentMarker"));this.ia.ya(id.a.Yre,tb.a.application,Object(Ea.a)(this,this.U5c,"nudgeCommentMarker"));
this.ia.ya(id.a.Zre,tb.a.application,Object(Ea.a)(this,this.U5c,"nudgeCommentMarker"));this.ia.ya(id.a.fIb,tb.a.application,Object(Ea.a)(this,this.fIb,"toggleCommentAnchoringFocus"));this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)&&(this.ia.ya(db.a.Ypb,tb.a.application,Object(Ea.a)(this,this.Ypb,"doesCommentExist")),this.ia.ya(db.a.fVb,tb.a.application,Object(Ea.a)(this,this.fVb,"commentActivitySelected")));this.Fe()}Fe(){var R=this.Ga.Bc(ah.AFrame.kj),ta=this.Ga.Bc(Od.a.oC);
const Ra=this.Ga.Bc(Od.a.NT);R.bindAction(Fi.KeyInputManager.La(Ie.a.GJa,1),id.a.fIb);ta.bindAction(Fi.KeyInputManager.La(Ie.a.GJa,1),id.a.fIb);Ra.bindAction(Fi.KeyInputManager.La(Ie.a.GJa,1),id.a.fIb);R=this.Ga.Bc(Od.a.Ep);ta=[R,this.Ga.Bc(qc.a.zB),this.Ga.Bc(qc.a.VU),this.Ga.Bc(Od.a.sg),this.Ga.Bc(Od.a.QM)];for(const nb of ta)nb.bindAction(Fi.KeyInputManager.La(Ie.a.Xea,Fi.KeyInputManager.He|(lb.a.ak?4:1)),id.a.ytb);R.bindAction(Fi.KeyInputManager.La(Ie.a.Bxa,1),id.a.ytb)}ghc(R,ta,Ra,nb=-1){this.ika=
ta;!this.Km&&this.Nca&&(this.Km=new Rg(this.Nca,this,this.xyb,this.ika,this.k$a),this.En.v4c=this.Km);if(R){Sg.kTj(R);ta=null;this.ps&&this.sa.w7()&&(ta=this.sa.Pa);var Cb=0<R.length?R[R.length-1]:null;if(this.Km){var mc=this.Km.kFb?this.Km.kFb.comment:null;const Sc=mc?mc.commentId:null;this.Km.isRightToLeft=this.ika;this.Km.Sbd(R);this.En&&(this.WY()||this.Cqb())&&(this.En.dGc(),this.En.GFc());this.Km.selectComment(null,!1);if(this.Wh)mc=this.Crb(this.Wh.commentId),this.En&&this.En.wGe(mc,Sc,!1),
this.Km.selectComment(mc,!0);else if(Ra&&mc){const jd=this.Crb(mc.commentId);this.En&&(this.Yl.isVisible||!jd||1!==jd.status&&2!==jd.status)&&(this.Km.selectComment(mc,!1),this.En.wGe(mc,Sc,!1,!0))}else this.p2c&&Cb&&(this.jea(Cb.commentId,1,!1),this.Km.selectComment(Cb,!1));this.Km.Moh(this.m$a);this.m$a&&this.En.Npb(this.GSa)}this.nab=R.length;R=this.oMe(R);this.O8=this.eKg.wll(R,this.ro);this.nbb=this.eKg.vll(R);Ra?(this.aZa(!0),this.KZ.Xhh(Array.clone(this.O8),this.nab,Array.clone(this.nbb)),
this.p2c&&Cb&&this.KZ.selectComment(Cb.commentId)):(Ra=[],this.Cqb()&&(Ra=this.Q9f(!1),Ra=[Object.assign(new ee,{draftId:this.Wh.GB.draftId,insertIndex:0>nb?0:Ra})]),0>nb?this.KZ.TGe(this.O8.length,this.nab,this.ro,this.see.GUc,Ra):this.KZ.gXk(this.O8.length,this.nab,nb,this.ro,Ra),this.KZ.YGe(Array.clone(this.O8),Array.clone(this.nbb)));if(this.v9b){if(nb=this.Crb(this.v9b))this.selectComment(nb,null,!0,!0,0,1,!1),this.v9b=null}else ta&&this.sa.UD(ta);R=this.fVf(R);this.U2&&R&&this.U2.count>R.length&&
this.IDi(R);this.Ach(R);this.ree&&this.vtl();this.p2c=!1}else this.KZ.TGe(0,0,this.ro,1),this.KZ.YGe([],[]),this.nab=0,this.Km&&(this.Km.isRightToLeft=this.ika,this.Km.Sbd(null)),this.nbb=this.O8=null,this.Gxh(!1,!1),this.bXb()}Aqa(){this.kVb&&this.EHc();this.hasFocus?this.Wh&&this.k2c.Dvg&&!this.C0f()&&this.Ga.pC(Od.a.oC):this.Ga.pC(this.Yl.isVisible?Od.a.Ep:Od.a.K1)}kHk(){this.C1c=null;this.pWg()}LBb(){this.Aqa();this.sa.gy();return!1}GLf(R){if(this.Wh){if(!this.Wh.GB)throw Lb.a.J(527501446,805,
10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",R),H.a.Yt(-2130915320);this.endCommentSession(this.Wh.GB.draftId,R)}else Lb.a.J(527501447,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",R),this.endCommentSession("",R)}LIi(){this.Azb=this.Ga.ye.name===(this.Yl.isVisible?Od.a.Ep:Od.a.K1);this.k2c.XCf(!0)}ZVf(){this.k2c.XCf(!1);this.Azb&&(this.Ga.pC(this.Yl.isVisible?Od.a.Ep:Od.a.K1),this.Azb=
!1)}ukk(R,ta){if(R&&R.name!==Od.a.Ep&&R.name!==Od.a.K1&&ta.name===Od.a.oC)if(this.Yl.isVisible)this.sJc();else if(this.Wh){R="";switch(this.Wh.ENa){case 0:R=this.Wh.GB?this.Wh.GB.draftId:"";break;case 1:case 2:if(ta=this.el.b0d(this.Wh.commentId))R=this.el.fra(ta).commentId}this.jr.selectContainer(R,!0)}this.Azb=!0}tkk(){this.Azb=!1}sJc(){this.Yl.isVisible&&this.Sbb.TRi()}Jcc(R,ta,Ra){this.xge=R;this.Rb.updateCommandUI();(Sd.a("FixAltF12KeboardingInCommentPane")||!this.IG)&&this.xge&&ta&&this.sJc();
R||Ra||this.oJa(1)}gUd(R){var ta=this.ua.presentation;if(!ta)return!1;ta=ta.slides;if(!ta)return!1;for(const Ra of ta)if(ta=Object(yb.a)(ce.a,Ra))if(ta=this.el.gra(ta.KE()),R)for(const nb of ta){if(1===nb.status)return!0}else{if(ta&&0<ta.length)return!0}else Lb.a.J(527501449,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found");return!1}JCi(){this.el.o4a();const R=this.el.sz();R&&R.length?this.K9a.xoh():this.K9a.voh(ResourceStrings.l_DeleteAllCommentsOnSlideCallout)}U5c(R,ta,
Ra){if(1===Ra)return 32;if(null!==this.Khh){ta=this.Khh;switch(R){case id.a.Wre:ta.pos.Y+=20;break;case id.a.Xre:ta.pos.X-=20;break;case id.a.Yre:ta.pos.X+=20;break;case id.a.Zre:ta.pos.Y-=20}this.Km.usl(ta);this.M1j.yuk(ta)}return 32}UWb(R,ta,Ra){return!this.vYf||this.ro||this.Wh&&this.Wh.GB?8:1===Ra?this.v_i(R):this.HCi(R)}v_i(R){switch(R){case id.a.o4a:return this.el.sz()&&this.el.sz().length?32:8;case id.a.VWb:return this.gUd(!1)?32:8;case id.a.WWb:return 1!==this.M7b.Oaa&&this.gUd(!0)?32:8;default:return Lb.a.J(527501451,
805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",R),2}}HCi(R){switch(R){case id.a.o4a:this.JCi();break;case id.a.VWb:this.K9a.woh(this.el,!1);break;case id.a.WWb:this.K9a.woh(this.el,!0);break;default:return Lb.a.J(527501452,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",R),2}return 32}zwa(R,ta,Ra,nb,Cb){if(1===Ra)return!this.ua.Ca||this.V7a?8:32;ta=!this.Yl.isVisible;Ra=this.rQ.wi("UserAction",String.format("ShowHideComments: {0}",
ta?"ShowPane":"HidePane"));Lb.a.J(36983504,805,50,"New Comment Pane opened.");R===id.a.khd?(this.pol(!this.k$a),this.wCe()):this.ps&&R===id.a.jhd?(this.m$a=!this.m$a,this.En.Ngd=this.m$a,this.wCe()):this.ihc(ta,!!Cb&&Cb.AutoShowHide);Ra&&Ra.stop();return 32}xJi(){this.Yl.isVisible&&this.jea(this.Wh.GB.draftId,1,!1)}fIb(){var R=this.Ga.ye.name;if(this.Wh&&this.Wh.GB)return R===Od.a.sg?(this.Aqa(),Sd.a("FixAltF12KeboardingInCommentPane")||Sd.a("SelectCommentDuringAlt12ActiveDraftEnable")&&this.xJi()):
this.Ga.vf(Od.a.sg),32;if(this.En.bqh||this.En.KM){if(R===Od.a.sg||this.ps&&R===Od.a.NT){var ta=this.En.KM;this.Yl.isVisible||(R=0,ta&&(R=ta.get_shapeId()),this.vhh(R,!1));this.Aqa();return 32}if(Ob.a.contains(this.bJf,R)){ta=this.hFb;if(this.ps&&ta&&od.TM(ta)){if(R=od.v0b(ta,this.En.KM),R.isValid){const Ra=[];for(let Cb=0;Cb<R.paragraphs.length;Cb++){const mc=R.paragraphs[Cb];mc&&Ra.push(Yf.SelectionFactory.PY(mc,R.QT.equals(mc)?R.startPos:0,R.V1.equals(mc)?R.endPos:Rc.ParagraphReader.textLength(mc)))}const nb=
new Ee.SelectionCollection(Ra,0);ta.textAnchoringInfo.AnchoringShape&&ta.textAnchoringInfo.AnchoringShape.SmartArtNodeId?(this.Ga.vf(Od.a.NT),this.eHg.execute(Cb=>{(Cb=Object(yb.a)(516,Cb.Jd))&&this.eHg.instance.ulh(Object(yb.a)(pj.a,Cb),nb)})):(this.Ga.vf(Od.a.sg),this.sa.UD(nb))}}else this.Ga.vf(Od.a.sg);return 32}}else{if(Ob.a.contains(this.bJf,R))this.Ga.vf(Od.a.sg);else{R=null;R=this.Kc&&this.Kc.Mc?this.el.P5a(this.Kc.Mc.Ud):this.oMe(this.el.sz());if(!Ob.a.Xa(R))for(ta of R)if(this.Yl.isVisible||
0===ta.status){this.jea(ta.commentId,1,!1);break}this.Aqa()}return 32}return 8}bDf(R,ta){R&&!ta?this.IG&&this.Owe?this.EHc():(this.Ga.Kj(Od.a.Ep,!0),this.Aqa(),this.sJc()):ta?R&&this.Ga.o7(Od.a.Ep,Od.a.kj,this.Yl,!1):0<this.$Xd()||this.Wh&&this.Wh.GB?this.Ga.Kj(Od.a.K1,!0):this.Ga.Kj(Od.a.Ep,!1);ta||this.$ih()}Uek(){this.Ha.xic&&!this.r1c&&(this.nm.Rua(this.nm.bLd,this.nm.QMd),this.nm.Qua(this.nm.bLd,this.nm.QMd),this.r1c=!0,this.tD.Vek(this.ua.Lj));this.X7&&this.X7.ONi()}$ih(){const R=this.el.sz();
R&&0<R.length&&(this.ZEg=!0)}WY(){var R=this.el.sz();if(!R||!R.length)return!1;R=Lc.e(R,ta=>0===ta.status);return!!R&&0<R.length}iHa(R,ta,Ra,nb,Cb){R===id.a.iHa?Cb[Wi.a.On]=this.Yl.isVisible:R===id.a.C7g||R===db.a.k8g?Cb[Mg.a.On]=this.Yl.isVisible:R===id.a.D7g?Cb[Mg.a.On]=this.k$a:this.ps&&R===id.a.A7g&&(Cb[Mg.a.On]=this.m$a);return!this.ua.Ca||this.V7a?16:32}Ypb(R,ta,Ra,nb,Cb){return 2!==Ra?32:(R=this.s0f(Cb))&&this.findComment(R)?32:8}fVb(R,ta,Ra,nb,Cb){return 2!==Ra?32:(R=this.s0f(Cb))&&this.Lbk(R)?
32:8}s0f(R){if(!R)return null;R=R.NavigationId;if(!R)return null;try{return JSON.parse(R)}catch(ta){return Lb.a.J(523352019,805,10,"ExtractNavParams - Exception while parsing navigation id",ta),null}}Lbk(R){if(R.sId!==this.Kc.Mc.Ud.sid){var ta=re.a.XD(R.sId,R.cId);ta=this.F0d(ta);if(!ta)return!1;this.Je.rda(ta.Ge)}ta=this.findComment(R);if(!ta)return!1;1!==ta.status&&2!==ta.status||this.dhd();this.jea(R.commentId,1,!1);return!0}findComment(R){var ta=this.ua.presentation;if(!ta)return null;ta=ta.slides;
if(!ta)return null;for(const Ra of ta)if((ta=Object(yb.a)(ce.a,Ra))&&ta.sid===R.sId){ta=this.el.gra(ta.KE());for(const nb of ta){if(nb.commentId===R.commentId)return nb;if(nb.Children&&nb.Children.length)for(const Cb of nb.Children)if(Cb.commentId===R.commentId)return Cb}}return null}isCollapsed(){return!1}get Khh(){return null}clearSelection(){}tHk(){this.Rb.updateCommandUI()}get W6a(){return!!this.Wh}Vki(){this.Wh&&this.GLf(8)}w9(R){2===R.behavior&&R.actionId===id.a.Adb&&(R=this.gv.$Kc(!0),R!==
id.a.q9c&&R!==id.a.YR&&R!==id.a.o4a&&R!==id.a.VWb&&R!==id.a.WWb||md.UISurfaces.pV().then(ta=>{this.K9a.QKk(ta)}))}u9(){}static eRg(R,ta){return R.contentId===ta}static kTj(R){let ta="";if(R){for(const Ra of R)if(ta+=Ra.commentId+";",Ra.Children)for(const nb of Ra.Children)ta+=nb.commentId+";";Lb.a.J(527501445,805,15,"LogCommentIds() - {0}",ta)}}}Object(h.a)(Sg,"SharedCommentFrame",null,[960,109,961,146]);class wh{constructor(R,ta,Ra,nb,Cb,mc,Sc=null){this.date=this.author=this.commentBody=this.parentId=
this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=R;this.parentId=ta;this.commentBody=Ra;this.author=nb;this.date=Cb;this.commentFlags=mc;this.usersByReactionType=Sc}}Object(h.a)(wh,"OfficeSharedCommentModel",null,[]);class ci{constructor(R,ta){this.CommentId=R;this.ResolveState=ta}}Object(h.a)(ci,"CommentProperties",null,[]);class Rh{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(h.a)(Rh,"AtMentionAttributes",null,[]);class se{constructor(){this.contentId=
""}}Object(h.a)(se,"AtMentionOptionalAttributes",null,[]);class bf{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(h.a)(bf,"DeltaAttributes",null,[]);var Sh;(function(R){R[R.Undo=-1]="Undo";R[R.Unknown=0]="Unknown";R[R.Create=1]="Create";R[R.Assign=2]="Assign";R[R.Unassign=3]="Unassign";R[R.UnassignAll=4]="UnassignAll";R[R.Schedule=5]="Schedule";R[R.Progress=
6]="Progress";R[R.Delete=7]="Delete";R[R.Restore=8]="Restore";R[R.SetTitle=9]="SetTitle";R[R.Priority=10]="Priority"})(Sh||(Sh={}));Object(h.b)("HistoryRecordType",Sh);class $c{constructor(){this.Id=this.FullName=this.Email=this.DispName=null}}Object(h.a)($c,"CommentAtMention",null,[]);var Gi=d(874);class Hk{constructor(){this.UserId=this.ProviderId=this.FullName=this.Email=this.DisplayName=null}}Object(h.a)(Hk,"UserInfo",null,[]);class Gj{constructor(R,ta){this.plainText=R;this.xTg=ta}}Object(h.a)(Gj,
"TextTranslationResult",null,[]);var Hj=d(67);class wa{constructor(R,ta,Ra){this.URk="[";this.A9h=RegExp("\\<\\@(.*?)\\>|\\[\\@(.*?)\\]");this.NQj=RegExp("(?:https?:\\/\\/|www\\.)[^\\s]+","gi");this.B9h=RegExp("(\\<\\@.*?\\>|\\[\\@.*?\\]|(?:https?:\\/\\/|www\\.)[^\\s]+)","gi");this.LAg=!1;this.kc=R;this.Noe=ta;this.Wke=Ra}get userId(){return this.kc.appSettings[dc.a.pa(387)]}get providerId(){return this.kc.appSettings[dc.a.pa(388)]}Faj(R,ta){let Ra=0;if(1===R.status||2===R.status)Ra|=8;ta&&(Ra|=1);
this.B7k(R)&&(Ra|=16);return Ra}isCurrentUser(R){return Cc.a.Xa(R.userId)?!1:"Author"===R.userId||this.userId===R.userId&&this.providerId===R.providerId?!0:!1}B7k(R){return""===R.userId||"Author"===R.userId||!this.Awl(R.userId)||this.userId===R.userId&&this.providerId===R.providerId?!1:!0}Awl(R){return 3===R.split("::").length}Uvh(R,ta,Ra){if(null===R)throw Error.argumentNull("comment");const nb=this.yll(R.text);var Cb=R.authorName;const mc=Sd.a("PPTPlumbEmailThroughCG")?Fa.a.$4a(R.userId||""):"",
Sc=R.dt;Ra=this.Faj(R,Ra);Cb=new bc(R.userId,R.providerId,Cb,mc,this.isCurrentUser(R));return new wh(R.commentId,ta,nb,Cb,Sc,Ra)}wll(R,ta){if(null===R)throw Error.argumentNull("comments");const Ra=new r.a;for(const nb of R)if(Ra.add(this.Uvh(nb,"",ta)),nb.Children&&0<nb.Children.length)for(const Cb of nb.Children)Ra.add(this.Uvh(Cb,nb.commentId,ta));return Ra.toArray()}Dll(R,ta,Ra,nb){const Cb=Object.assign(new Gi.a,{Asignees:[]});R=this.Noe.rUi(R,ta,!ta.taskId,Ra);for(const mc of R)2===mc.type?mc.assignee?
(R=Object.assign(new Hk,{DisplayName:mc.assignee.DisplayName,FullName:mc.assignee.DisplayName,UserId:mc.assignee.UserId,ProviderId:mc.assignee.Provider,Email:mc.assignee.Email}),Cb.Asignees.push(R)):Lb.a.J(512372813,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null."):9===mc.type&&(Cb.Title=mc.title);if(!Cb.Asignees)return Lb.a.J(512372812,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),null;Cb.Title||(Lb.a.J(512372811,
845,15,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),Cb.Title=nb);return Cb}Bll(R,ta){const Ra=new Gi.a;if(R.assignee){const nb=new Hk,Cb=R.assignee;nb.DisplayName=Cb.Name;nb.FullName=Cb.Name;nb.UserId=Cb.UserPrincipalName;nb.ProviderId="O365";nb.Email=Cb.UserPrincipalName;Ra.Asignees=[nb]}Ra.Title=R.title?R.title:ta;return Ra}Cll(R,ta,Ra){if(!ta)return null;try{const nb=this.wkd(Ra,new Date).plainText,Cb=this.Wke?this.Dll(R,ta,Ra,nb):this.Bll(ta,nb);if(!Cb)return null;
Cb.CompletionPercentage=ta.completion?ta.completion:0;return Cb}catch(nb){Lb.a.J(512372810,845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",nb)}return null}vll(R){if(null===R)throw Error.argumentNull("comments");const ta=new r.a;for(const Ra of R)Ra.taskInfo&&Ra.taskInfo.Asignees&&0<Ra.taskInfo.Asignees.length&&(R=this.ull(Ra))&&ta.add(R);return ta.toArray()}ull(R){if(this.Wke&&this.Noe&&0<R.taskInfo.TaskHistoryRecords.length)try{var ta=wa.Asi(R.taskInfo.TaskHistoryRecords),
Ra=new Hj.a;Ra.add(R.commentId,new ci(R.commentId,100===R.taskInfo.CompletionPercentage));var nb=this.Noe.Lzi(R.commentId,R.commentId,ta,Ra);wa.aji(R,nb,this.Wke);return nb}catch(Cb){return Lb.a.J(512372809,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",Cb.message),null}else return ta=new ea,ta.startDate=R.taskInfo.StartDate,ta.endDate=R.taskInfo.DueDate,Ra=new pa(R.taskInfo.Asignees[0].UserId),Ra.DisplayName=R.taskInfo.Asignees[0].DisplayName,Ra.Provider=R.taskInfo.Asignees[0].ProviderId,
Ra.Email=R.taskInfo.Asignees[0].Email,nb=Array(1),nb[0]=Ra,ta=new da(!1,R.taskInfo.Title,nb,ta,R.taskInfo.CompletionPercentage,0),new Z(R.commentId,R.commentId,ta,[])}yll(R){if(null===R)throw Error.argumentNull("nativeText");const ta=new va;R=R.split(this.B9h);for(const nb of R){var Ra=this.A9h.exec(nb);Ra&&3===Ra.length?(R=new Rh,Ra[0].substring(0,1)===this.URk?(R.fullName=Ra[2],R.resolveState=1):(R.fullName=Ra[1],R.resolveState=0),R.email="UnknownEmail",Ra=new se,Ra.contentId="Pre-existing Mention",
ta.Wwj("@"+R.fullName,R,Ra),this.LAg||(this.LAg=!0,Lb.a.J(512372808,845,15,"Rendering mention when AtMentions are disabled."))):(R=this.NQj.exec(nb))&&1===R.length?(R=R[0],ta.insertHyperLink(R,Object.assign(new bf,{link:R}))):ta.Fxj(nb)}return ta.y_i()}wkd(R,ta){var Ra=Sys.Serialization.JavaScriptSerializer.deserialize(R);R=[];ta||(ta=new Date);const nb=new Sys.StringBuilder;for(const Cb of Ra.ops)if(Cb.attributes){if(Cb.attributes.atmention){const mc=1<Cb.insert.length?Cb.insert.substring(1,Cb.insert.length):
"";if(Cb.optional&&Cb.optional.atmention)Ra=wa.a$f(mc,1===Cb.attributes.atmention.resolveState);else{Ra=wa.a$f(mc,1===Cb.attributes.atmention.resolveState);const Sc=wa.U5i(ta,1===Cb.attributes.atmention.resolveState);Array.add(R,Object.assign(new $c,{FullName:Cb.attributes.atmention.fullName,DispName:mc,Id:Sc,Email:Cb.attributes.atmention.email}));ta=new Date(ta.getTime()+1)}}else Cb.attributes.link||Lb.a.J(512372807,845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),Ra=
Cb.insert;nb.append(Ra)}else nb.append(Cb.insert);return new Gj(nb.toString(),R)}static Ysi(R){switch(R){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}static Wsi(R){var ta=null;R.User&&(ta=new pa(R.User.UserId,R.User.ProviderId,R.User.DisplayName));ta=new ca(wa.Ysi(R.HistoryRecordType),ta,R.DtTime,R.RecordId);ta.commentId=R.CommentId;R.Assignee&&(ta.assignee=new pa(R.Assignee.UserId,
R.Assignee.ProviderId,R.Assignee.DisplayName));R.StartDate&&R.DueDate?(ta.schedule=new ea,ta.schedule.startDate=R.StartDate?R.StartDate:null,ta.schedule.endDate=R.DueDate?R.DueDate:null):R.StartDate&&!R.DueDate?Lb.a.J(512372806,845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):!R.StartDate&&R.DueDate&&Lb.a.J(512372805,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");var Ra=R.Priority;0<Ra?ta.priority=Ra:Lb.a.J(512372804,
845,10,"Priority is negative");Ra=R.CompletionPercentage;0<=Ra?ta.completion=Ra:Lb.a.J(512372803,845,10,"Percent complete is negative");ta.title=R.Title;ta.undoId=R.UndoId;return ta}static Asi(R){const ta=R.length,Ra=Array(ta);for(let nb=0;nb<ta;++nb)Ra[nb]=wa.Wsi(R[nb]);return Ra}static aji(R,ta,Ra){const nb=ta.currentState,Cb=R.taskInfo;let mc=!1;const Sc=Sd.a("SetTaskFromTaskStateInsteadOfHistory");Cb.StartDate.toString()!==nb.schedule.startDate.toString()&&(Sc&&(nb.schedule.startDate=Cb.StartDate),
mc=!0,Lb.a.J(512372802,845,10,"Start Date does not match."));Cb.DueDate.toString()!==nb.schedule.endDate.toString()&&(Sc&&(nb.schedule.endDate=Cb.DueDate),mc=!0,Lb.a.J(512372801,845,10,"End Date does not match."));Cb.CompletionPercentage!==nb.completion&&(Sc&&(nb.completion=Cb.CompletionPercentage),mc=!0,Lb.a.J(512372800,845,10,"Completion percentage does not match."));Cb.Title!==nb.title&&(Sc&&(nb.title=Cb.Title),mc=!0,Lb.a.J(512372771,845,10,"Title does not match."));Cb.Asignees[0].UserId!==nb.assignees[0].UserId&&
(Sc&&(nb.assignees[0].UserId=Cb.Asignees[0].UserId),mc=!0,Lb.a.J(512372770,845,10,"Assigned to user id does not match."));Cb.Asignees[0].DisplayName!==nb.assignees[0].DisplayName&&(Sc&&(nb.assignees[0].DisplayName=Cb.Asignees[0].DisplayName),mc=!0,Lb.a.J(512372769,845,10,"Assigned to display name does not match."));Cb.Asignees[0].ProviderId!==nb.assignees[0].Provider&&(Sc&&(nb.assignees[0].Provider=Cb.Asignees[0].ProviderId),mc=!0,Lb.a.J(512372768,845,10,"Assigned to provider id does not match."));
Cb.Asignees[0].Email!==nb.assignees[0].Email&&(Sc&&(nb.assignees[0].Email=Cb.Asignees[0].Email),Ra||(mc=!0,Lb.a.J(512372767,845,10,"Assigned to email does not match.")));mc&&Ra&&wa.GVj(R,ta)}static GVj(R,ta){const Ra=new r.a;for(const nb of ta.history)for(const Cb of nb.records)Ra.add(Sh[Cb.type]);Ra.toArray().join(" ");if(Ra.count!==R.taskInfo.TaskHistoryRecords.length){ta=new r.a;for(const nb of R.taskInfo.TaskHistoryRecords)ta.add(Sh[nb.HistoryRecordType]);ta.toArray().join(" ");Lb.a.J(512372766,
845,10,"LogTaskHistoryDetailsForMismatch")}}static U5i(R,ta){R=R._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);return ta?R+"_Z":R}static a$f(R,ta){return ta?"[@"+R+"]":"<@"+R+">"}}Object(h.a)(wa,"SharedCommentModelTranslator",null,[958]);class Ma{constructor(R,ta,Ra){this.FTa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled")&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesF6LoopFixesIsEnabled");this.p$e=!1;this.Ga=
R;this.ph=ta;this.Cwb=Ra}XCf(R){R?(this.FTa&&this.Cwb&&this.Cwb.isVisible||this.ph.SJ(Od.a.oC),this.ph.ap(Od.a.Ep),this.Ga.pC(Od.a.oC)):(this.ph.ap(Od.a.oC),this.Cwb.isVisible&&!this.FTa&&this.ph.SJ(Od.a.Ep));this.p$e=R}get Dvg(){return this.p$e}}Object(h.a)(Ma,"SharedCommentsRTEFocusActionHelper",null,[925]);class hb{constructor(R,ta,Ra,nb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=R;this.body=ta;this.confirmButton=Ra;this.cancelButton=nb}}Object(h.a)(hb,"ViewContainerModalDialogStrings",
null,[]);class ub{constructor(R,ta,Ra){this.containerType="full-pane";this.identifier=null;this.Ua=R;this.Ga=ta;this.identifier=Ra}closeView(){this.Ua.ihc(!1,!1)}openView(){this.Ua.ihc(!0,!1)}invokeModalConfirmationDialog(R,ta,Ra){const nb=new Wf.StandardDialog;Ra&&Ra.title&&Ra.body&&Ra.confirmButton&&Ra.cancelButton||(Lb.a.J(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),Ra=new hb("","","",""));nb.vd=1;nb.Pe(1,Ra.confirmButton);nb.Pe(0,Ra.cancelButton);nb.u4a=this.Ga.ye.name;
nb.lcc=!0;nb.Tw(Ra.title,Ra.body,1,Cb=>{1===Cb?(R(),nb.u4a=null):ta()})}}Object(h.a)(ub,"ViewContainerAPI",null,[956,957]);class na extends Sys.EventArgs{constructor(){super()}}Object(h.a)(na,"CommentsPackageLoadedEventArgs",Sys.EventArgs,[]);var Pa=d(277);class cb{constructor(){this.FJg=this.$Og=this.Sbb=this.XPg=this.Jta=this.WWc=this.EFa=this.YWc=this.eQ=this.K=null;this.i$a=this.gta=this.gxb=!1;this.rQ=this.Aee=null;this.gLg="6F1926CF-E872-4C4C-9393-3956FCFEB98A";this.tN=null;this.FTa=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.IG=!1}Yb(R){this.K=R;this.IG=this.K.resolve("PowerPointWebEditor.IApplicationSettings").UMd;this.rQ=this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");this.Sbb=new E(e.AFrameworkApplication.ve,"CommentPane");R.register(cd,"PowerPointWebEditor.CommentEditor").as("PowerPointWebEditor.ICommentEditor").ma().na(()=>new cd);const ta=this.K.resolve("PowerPointWebEditor.IFileInfo").Oaa,Ra=2===ta||3===ta;this.gxb=Ra;
this.i$a=1===ta;R.register(Id,"PowerPointWebEditor.CommentTelemetryManager").as("PowerPointWeb.Comments.ICommentTelemetryManager").ma().na(()=>new Id(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),ta));R.register(gb,"PowerPointWebEditor.CommentManager").as("PowerPointWeb.Comments.ICommentGraphManager").ma().na(()=>new gb(this.rQ,
ta,this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),this.K.resolve("PowerPointWebEditor.IClassFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),this.K.resolve("PowerPointWebEditor.ICommentEditor"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("PowerPointWebEditor.ISlideReader")));const nb=this.gxb||!this.i$a;this.tN=this.K.resolve("PowerPointWeb.Comments.ICommentGraphManager");nb&&R.register(259,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>").ma().na(()=>new Pa.a((Ae,Ue)=>{let mg=null;const ki=Object(yb.a)(133,Ae.pc(R.resolve("Box4.IPageView").Na));
ki&&!ki.kl&&(Ae=R.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").gPd(R.resolve("PowerPointWebEditor.IPptSelectionManager"),null,Ae,Ue,ki.IT),mg=new Hd(Ae),mg.Vm(ki.IT),ki.Bza(mg,5),mg.visible=ki.KP||ki.Bn);return mg}));this.K.register(922,"PowerPointWeb.Comments.ICommentMarkerAnchorHelper").ma().na(()=>new zc(this.tN,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),R.resolve("PowerPointWebEditor.Graph.ITableReader")));
this.K.register(923,"PowerPointWeb.Comments.ICommentMarkerPositionHelper").ma().na(()=>new rd(this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ed,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.tN));const Cb=this.gxb||!this.i$a;this.K.register(924,"PowerPointWeb.Comments.ICommentMarkerViewElementFactory").ma().na(()=>new uf(this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerPositionHelper"),new Xf(Cb),
this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Cb,Cb));const mc=this.K.resolve("Common.IAppSettingsManager").ka("CommentTextAnchoringUIEnabled")&&!this.i$a;this.K.register(Ld,"PowerPointWebEditor.CommentTextAnchorHighlightActor").ma().na(()=>new Ld(mc,this.K.resolve("Common.Utils.IHighContrastDetector")));const Sc=new xf(nb,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),nb?this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>"):
null,this.tN,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAriaManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.CommentTextAnchorHighlightActor"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"));R.register(925,"PowerPointWebEditor.IRTEFocusActionHelper").ma().na(()=>
new Ma(R.resolve("Common.IFocusManager"),R.resolve("Common.IF6Manager"),R.resolve("PowerPointWebEditor.ICommentsPane")));this.K.register(M,"Common.Comments.OfficeSharedCommentsEventHost").as("Common.Comments.IOfficeSharedCommentsEventHost").ma().na(()=>new M(this.K.resolve("Common.ITaskManager")));const jd=this.K.resolve("Common.IAppSettingsManager").ka(dc.a.O8a);jd&&this.K.register(926,"Common.Comments.ICommentTaskTranslator").ma().na(()=>(new ua(!0,jd,!0)).Hui());this.K.register(wa,"PowerPointWebEditor.SharedCommentModelTranslator").as("PowerPointWeb.Comments.ISharedCommentModelTranslator").ma().na(()=>
new wa(this.K.resolve("Common.IAppSettingsManager"),jd?this.K.resolve("Common.Comments.ICommentTaskTranslator"):null,jd));this.K.register(Ca,"Common.Comments.CommentActivationManager").as("Common.Comments.ICommentActivationManager").ma().na(()=>new Ca);this.gta=this.K.resolve("Common.IAppSettingsManager").ka(dc.a.pa(896))&&(Ra||!this.i$a);const Ad=this.K.resolve("PowerPointWebEditor.IApplicationSettings").xic;this.K.register(Sg,"PowerPointWebEditor.SharedCommentFrame").as("PowerPointWeb.Comments.ICommentFrame").as("PowerPointWebEditor.ICommentSessionManager").ma().na(()=>
new Sg(this.tN,this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.ICommentsPane"),this.K.resolve("Common.DragInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.ICommentsPane").za,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Sbb,this.K.resolve("PowerPointWebEditor.IRTEFocusActionHelper"),e.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ed,this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerViewElementFactory"),this.rQ,Sc,this.K.resolve("Common.IAppSettingsManager"),this.K.Oa("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),nb,R.resolve("PowerPointWebEditor.IErrorHandler"),R.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.gta,R.resolve("Box4.Graph.IGraphInstance").Cd(10),
R.resolve("PowerPointWebEditor.View.IViewEventSource"),R.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Cb,R.resolve("PowerPointWebEditor.IShapeReader"),R.Oa("Common.App.SafeLinks.ISafeLinksManager"),R.resolve("Box4.ICharacterPropertiesEditor"),R.resolve("PowerPointWebEditor.IFileInfo"),this.IG,R.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Ad?this.K.resolve("PowerPointWebEditor.IPPTRumTracker"):null,this.K.resolve("PowerPointWebEditor.IApplicationSettings").SAb?
this.K.resolve("PowerPointWebEditor.ICommentShimmerView"):null));this.K.register(ab,"Common.Comments.OfficeSharedCommentsActionHost").as("Common.Comments.IOfficeSharedCommentsActionHost").ma().na(()=>new ab(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").NWj));this.K.register(ub,"PowerPointWebEditor.ViewContainerAPI").as("PowerPointWeb.Comments.IPptViewContainerAPI").ma().na(()=>new ub(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.gLg));const ve=new Fg(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new ze(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler")),this.tN,this.K.resolve("Common.IAppSettingsManager").ka(dc.a.pa(459)),this.K.qe("PowerPointWeb.Comments.ICommentFrame"));this.K.register(927,"PowerPointWebEditor.IFindCommentLogic").ma().na(()=>new Eh(ve,this.K.resolve("Common.ITaskManager")));this.K.register(Le,"PowerPointWebEditor.CommentsChangeListener").ma().na(()=>
new Le(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(7),this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame")));this.K.register(928,"PowerPointWebEditor.ICommentContextDetailsUpdateHelper").ma().na(()=>new xb(this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.tN,this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.ITaskManager")));this.K.register(yf,"PowerPointWebEditor.CommentPropertyTracker").ma().na(()=>new yf(Object(Ea.a)(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").pWg,
"onCommentPropertiesUpdated"),Ub.App.tO.$T,ec.GraphTransactionManager.instance));this.K.register(929,"PowerPointWebEditor.ICommentsPane").ma().na(()=>new ef(this.K.resolve("PowerPointWebEditor.IFrameContext"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").ssa,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.IG));this.K.register(cg,"PowerPointWebEditor.CommentSmartReplyProvider").ma().na(()=>new cg(this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){fb.a.instance.jc(Pb.a.TMd,(new Date).getTime());const R=this.rQ.wi("UserAction","InitCommentsPackage"),ta={};this.IG||(this.EFa=this.K.resolve("PowerPointWebEditor.ICommentsPane").za);this.eQ=this.K.resolve("PowerPointWeb.Comments.ICommentFrame");this.eQ.initialize();var Ra=R.vq;ta.CommentFrameInitMS=Ra;this.K.resolve("PowerPointWebEditor.ICommentSessionManager");this.YWc=this.K.resolve("PowerPointWebEditor.CommentPropertyTracker");
this.YWc.rqj();const nb=R.vq;ta.CommentPropertyTrackerInitMS=nb-Ra;this.Aee=this.K.resolve("PowerPointWebEditor.CommentsChangeListener");this.XPg=this.K.resolve("PowerPointWeb.Comments.IPptViewContainerAPI");var Cb=mb.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Ra=Cb.Ring||"Unknown";Cb=Cb.WACDatacenter||"Unknown";const mc=this.K.resolve("PowerPointWebEditor.IApplicationSettings").dAj;var Sc=e.AFrameworkApplication.fa.Ia("LokiComplianceEnvironment");Sc=Sc&&""!==Sc?Sc:
e.AFrameworkApplication.fa.Ia("SovereignEnvironmentName");this.$Og=new Ab("PowerPoint",e.AFrameworkApplication.buildVersion,null,null,e.AFrameworkApplication.userSessionId,Ra,Cb,!mc,this.K.resolve("Common.IActionManagerExtended"),null,Sc);Ra=lc.a.re(e.AFrameworkApplication.lcid);this.FJg=new Mc(e.AFrameworkApplication.isRtl,Ra?Ra.name:Sys.CultureInfo.CurrentCulture.name,e.AFrameworkApplication.uiCulture,e.AFrameworkApplication.dataCulture);this.IG||(this.EFa.id=this.gLg);this.l2b();e.AFrameworkApplication.fa.gf(Object(Ea.a)(this,
this.Fl,"onFullAppSettingsReady"));(Ra=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"))&&Ra.PBk(new na);Ra=R.vq;ta.CommentReactPaneInitMS=Ra-nb;this.Etj();ta.CommentPaneInitMS=R.vq-Ra;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)&&this.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider").initialize();R.stop();Lb.a.J(538280202,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",
ta,this.K.resolve("Common.IAppSettingsManager").ka(dc.a.pa(896)))}Etj(){const R=this.K.resolve("PowerPointWebEditor.ICommentsPane"),ta=this.K.resolve("PowerPointWebEditor.IPaneManager");this.IG||(!this.FTa||this.FTa&&!document.getElementsByClassName("CommentPanel").length)&&ta.wM(R);ta.Kvb(2);this.K.resolve("PowerPointWebEditor.IFocusManager").o7(Od.a.Ep,Od.a.kj,R,!R.isVisible)}l2b(){fb.a.instance.jc(Pb.a.l2b,(new Date).getTime());const R=this;this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy").bWb().then(ta=>
{fb.a.instance.jc(Pb.a.q5d,(new Date).getTime());Jc.a.su(R.K.Oa("Common.App.People.IExternalPeopleAPI")).continueWith(Ra=>{R.Jta=Ra.result;R.Jta||Lb.a.J(538280203,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");R.K.resolve("PowerPointWebEditor.IApplicationSettings").zg&&(Ra=R.K.resolve("Common.IAppSettingsManager").Ia(dc.a.pa(368)),R.Jta.Yok(Ra+"p"));Ra=[rb.a.contextMenu];R.IG||cc.a.Ybd(R.EFa,Ra);const nb=ta&&(R.gxb||!R.i$a),Cb=R.K.resolve("Common.IAppSettingsManager").ka(dc.a.UCb);
R.K.register(zd,"PowerPointWebEditor.PPTSharedCommentAppCapabilities").as("Common.Comments.IOfficeSharedCommentsAppCapabilities").ma().na(()=>new zd(R.K.resolve("Common.IAppSettingsManager"),R.K.resolve("PowerPointWebEditor.IApplicationSettings"),R.Jta,R.i$a,nb,R.gta));R.K.register(Bc,"PowerPointWebEditor.CommentAPI").as("PowerPointWebEditor.IPptOfficeSharedCommentAPI").ma().na(()=>new Bc(R.K.resolve("PowerPointWeb.Comments.ICommentFrame"),R.tN,R.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
R.K.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),R.K.resolve("Common.ITaskManager"),R.K.resolve("Common.IAppSettingsManager"),R.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),R.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),R.Jta,R.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),R.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider"),nb,R.gta,Cb,R.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),R.K.resolve("Common.IActionManagerExtended"),
R.K.resolve("PowerPointWebEditor.IApplicationSettings")));R.WWc=R.K.resolve("PowerPointWebEditor.IPptOfficeSharedCommentAPI")},11).continueWith(()=>{R.WWc&&R.WWc.checkAtMentionCapability().then(Ra=>{Ra&&((Ra=R.K.Oa("Common.ISystemInitiatedFeedback"))?Ra.execute(nb=>{nb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}):Lb.a.J(538280204,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});R.Ctj()})})}Ctj(){fb.a.instance.jc(Pb.a.GJe,
(new Date).getTime());const R=this.K.resolve("Common.IDynamicScriptLoaderProvider").gx,ta=this.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),Ra=this.K.resolve("Common.Comments.ICommentActivationManager");fb.a.instance.jc("CommentActivationManagerInitStart",(new Date).getTime());Ra.initialize(R,this.WWc,this.$Og,this.Jta,new jb(this.XPg,this.Sbb),this.FJg,null,ta.Gaj());fb.a.instance.jc(Pb.a.B2b,(new Date).getTime());Ra.B2b().then(()=>{fb.a.instance.jc(Pb.a.r5d,(new Date).getTime());
this.eQ.ewj();fb.a.instance.jc(Pb.a.Fbe,(new Date).getTime());Zc.a(this.K)("floatingContainerManager").then(()=>{fb.a.instance.jc(Pb.a.BVd,(new Date).getTime());this.eQ.Mtj();fb.a.instance.jc(Pb.a.CVd,(new Date).getTime());if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").I8h){const nb=this.tN.sz();nb&&0<nb.length?(this.eQ.uWk(),fb.a.instance.jc(Pb.a.Fgd,(new Date).getTime()),nc.App.pFb(null,Pb.a.Fgd)):Lb.a.J(538280205,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}}).catch(nb=>
{Lb.a.J(538280206,801,10,"Failed to load the resources for the floating container UI + "+nb.toString())})})}Fl(){this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").updateCommandUI()}dispose(){this.YWc&&this.YWc.Rol();this.eQ&&this.eQ.dispose();this.Aee&&this.Aee.dispose();this.Jta=null}get name(){return"PowerPointWebEditor.CommentsPackage"}static main(){fb.a.instance.jc(Pb.a.OMd,(new Date).getTime());Xb.a.instance.Ec(new cb)}}Object(h.a)(cb,"CommentsPackage",null,[2,3]);Type.registerNamespace("Common.App.SharedComments");
Type.registerNamespace("FloatingContainer");Type.registerNamespace("FloatingContainerManager");Type.registerNamespace("PowerPointWeb.Comments");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("RichContentEditAPI");cb.main()},277:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(981);class e{constructor(m){this.Rk=new h.a;this.aVa=m}yP(m){const r=m.id;let v=null;this.Rk.Kb(r)?v=this.Rk.ga(r):(this.aVa&&(v=this.aVa(m,()=>{this.whc(r)})),v&&this.Rk.$(r,v));return v}QE(m){m=
m.id;return this.Rk.Kb(m)?this.Rk.ga(m):null}whc(m){this.Rk.remove(m)}}Object(J.a)(e,"ShapeComponentViewManager",null,[259])},666:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(17),e=d(96),m=d(27),r=d(48);d(97);class v{constructor(){this.hZ=null}get etb(){return!1}fwh(A,x){let y=new h.a;const u=new r.GraphTransaction(3);try{u.hd(m.App.Fb.Fd.Xm.ug),this.T4b(x)&&(y=this.G2b(x,y)),x!==A&&this.T4b(A)&&(y=this.G2b(A,y))}finally{u&&u.dispose()}return y.toArray()}T4b(A){return!!A}jcd(A){let x=
!1;for(const y of this.b4d)x||!Sys.UI.DomElement.containsCssClass(A,y.className)&&!Sys.UI.DomElement.containsCssClass(A,y.X0b)||(x=!0),e.a.uHa(A,y.className),e.a.uHa(A,y.X0b)}}Object(J.a)(v,"AHighlightActor",null,[1252])},667:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.className=e;this.X0b=m}}Object(J.a)(h,"HighlightCssClassPair",null,[])},668:function(J,V,d){d.d(V,"b",function(){return r});d.d(V,"a",function(){return v});var h=d(96);d(27);var e=d(48);d(31);
d(89);var m=d(97);const r=A=>{const x=new e.GraphTransaction(3);try{x.hd(A),A.Su(32,!0)}finally{x&&x.dispose()}},v=A=>{if(A){A=h.a.Rha(A);if(-1===A.indexOf(m.a.C6)&&-1!==A.indexOf(m.a.AM)&&-1===A.indexOf(m.a.xWb))return 2;if(-1===A.indexOf(m.a.C6)&&(-1!==A.indexOf(m.a.wWb)||-1!==A.indexOf(m.a.RM)||-1!==A.indexOf(m.a.xWb)||-1!==A.indexOf(m.a.GDc)||-1!==A.indexOf(m.a.qFc)||-1!==A.indexOf(m.a.oFc)||-1!==A.indexOf(m.a.nFc)||-1!==A.indexOf(m.a.EPd)||-1!==A.indexOf(m.a.zPd)||-1!==A.indexOf(m.a.BPd)||-1!==
A.indexOf(m.a.pFc)||-1!==A.indexOf(m.a.yPd)))return 1;if(-1!==A.indexOf("WACImageContainer"))return 3}return 0}},669:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.type=this.action=0;this.Cdb=this.Iba=null}}Object(J.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.comment.js.map