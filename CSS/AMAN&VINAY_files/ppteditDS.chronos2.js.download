'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1093:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static sWi(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";
default:return"external"}}}Object(J.a)(h,"WopiAuthContext",null,[1027])},1190:function(J,V,d){d.r(V);var h=d(0),e=d(69),m=d(374),r=d(13),v=d(25),A=d(193),x=d(141),y;(function(n){n[n.error=0]="error";n[n.warning=1]="warning";n[n.tip=2]="tip";n[n.intelligentService=3]="intelligentService"})(y||(y={}));Object(h.b)("AccessibilityRuleCategory",y);var u=d(57),H=d(70),G=d(35),E=d(139),I=d(195),Q=d(121);class D{constructor(n,O,ha=null){this.vnd=null;this.P7e=this.o6e=!1;this.tza=n;this.ooc=O;this.Da=ha;this.Ho.ya(G.a.smi,
H.a.frame,Object(r.a)(this,this.aK,"closePane"))}get Ho(){return this.Da||(this.Da=v.AFrameworkApplication.Va)}set Ho(n){this.Da=n}AJi(){this.o6e||(this.tza.initialize(this),this.ooc.initialize(this),this.o6e=!0)}due(){Q.c(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.ooc.ETk()}kn(n,O,ha){if(1===ha)return A.SessionStatusManager.instance.nia?8:32;this.tza.isVisible||this.AJi();this.Q$k();return 32}aK(n,O,ha){1!==ha&&this.tza.Pu();return 32}Fve(){this.tza.Roh(!0)}DRd(n){if(n){if(n.AccessibilityRules&&
Object.keys(n.AccessibilityRules).length){const ha=n.AccessibilityRules;for(let Aa in ha){var O=Aa;const La=ha[Aa].RuleId+"";O!==La&&Q.c(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",O,La)}this.vnd=ha}else!this.vnd&&n.Results&&0<n.Results.length?(Q.c(18993251,200,15,"No accessibility rule definitions available"),n.IsSuccess=!1):n.AccessibilityRules=this.vnd;n.IsSuccess||Q.c(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.tLk(n);this.qVj(n);this.tza.DRd(n)}}tLk(n){const O=
n.AccessibilityRules;if(n=n.Results)for(let ha=n.length-1;0<=ha;ha--){const Aa=n[ha];let La="";const Bb=Aa.RuleId;Aa.ContentName||(La+="Result does not have content name. ");Bb in O||(La+=String.format("No accessibility check rule exists for ID {0}.",Bb));0<La.length&&(Q.c(36214999,200,15,"Omitting invalid accessibility check result: "+La),Array.removeAt(n,ha))}}m$i(){return v.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):
u.a.instance.resolve("Common.IDynamicScriptLoaderProvider").gx.loadScript("accessibility-checker-pane-strings")}Q$k(){this.P7e?this.tza.kn():this.m$i().then(()=>{this.P7e=!0;this.tza.kn()}).catch(n=>m.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",n))}qVj(n){var O={};const ha={};var Aa=n.Results,La=[];Array.add(La,Object.assign(new E.a,{name:"FinalViolationCount",int64:0}));Array.add(La,Object.assign(new E.a,{name:"FinalErrorCount",string:"0"}));
Array.add(La,Object.assign(new E.a,{name:"FinalWarningCount",string:"0"}));Array.add(La,Object.assign(new E.a,{name:"FinalTipCount",string:"0"}));Array.add(La,Object.assign(new E.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Aa){for(const uc of Aa)if(n.AccessibilityRules){var Bb=n.AccessibilityRules[uc.RuleId];if(Bb){if(O[y[Bb.Category]]){let Vc=O[y[Bb.Category]];O[y[Bb.Category]]=++Vc}else O[y[Bb.Category]]=1;ha[uc.RuleId]?(Bb=ha[uc.RuleId],ha[uc.RuleId]=++Bb):ha[uc.RuleId]=1}}La[0].int64=
Aa.length;for(var Wb in O)switch(n=O[Wb],Aa=Wb,Aa="Final"+Aa.charAt(0).toUpperCase()+Aa.substring(1,Aa.length)+"Count",Aa){case "FinalErrorCount":La[1].string=n.toString();break;case "FinalWarningCount":La[2].string=n.toString();break;case "FinalTipCount":La[3].string=n.toString();break;case "FinalIntelligentServiceCount":La[4].string=n.toString()}}x.a.sendTelemetryEvent(Object.assign(new I.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:La}));for(let uc in ha)O=
uc,La=ha[uc],Wb=[],Array.add(Wb,Object.assign(new E.a,{name:"RuleID",string:O})),Array.add(Wb,Object.assign(new E.a,{name:"FinalViolationCount",string:La.toString()})),x.a.sendTelemetryEvent(Object.assign(new I.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Wb}))}dispose(){this.tza&&this.tza.dispose();this.ooc&&this.ooc.dispose()}}Object(h.a)(D,"AAccessibilityCheckManager",null,[185,109]);var Y=d(79),M=d(1154),N=d(64),W=d(354),K=d(26);class ca extends D{constructor(n,
O,ha,Aa,La,Bb,Wb,uc,Vc){super(n,O);this.Sab=this.A3=null;this.Ga=ha;this.Bb=Aa;this.Hn=La;this.DW=Bb;this.ua=Wb;this.sa=uc;this.Ub=Vc;this.bpe=!1}C_k(n){if(!n)return K.a.J(19227927,334,15,"Cannot navigate since violation data is null"),!1;if(n.sldIdField){var O=new N.a(Object.assign(new W.a,{Sid:n.sldIdField.sidField,Cid:n.sldIdField.cidField}));O=this.Ub.bia(O);if(!O)return!1;let ha=null;if(n.spIdFieldSpecified&&(ha=O.KB(n.spIdField),!ha&&this.bpe))return!1;this.BWk(O,ha)}else K.a.J(19227929,334,
15,"There is no slide id info in violation data");return!0}due(){this.bpe=!1;super.due()}Fve(){this.bpe=!0;super.Fve()}BWk(n,O){if(n){const ha=this.ua.Ca!==n?!0:!1;O&&(this.Sab=O,ha?this.Hn.DR(Object(r.a)(this,this.Tua,"onActiveSlideDomChanged")):this.Ehh());ha&&(this.DW.Ca=n);this.sa.gy();this.Ga.Bd()}}Tua(){this.Hn.lma(Object(r.a)(this,this.Tua,"onActiveSlideDomChanged"));this.A3||(this.A3=new Y.a(2,1,0,Object(r.a)(this,this.bdc,"onPostActiveSlideDomChangedTask"),90,"20"),this.Bb.Hb(this.A3))}bdc(){this.A3=
null;this.Ehh()}Bd(){this.DW.UJ.Po||this.Ga.Bd()}Ehh(){if(this.Sab){const n=Object(M.a)(133,this.Sab.yg(this.DW.UJ.Na));n?n.kl?K.a.J(19227931,334,50,"Shape view element of node {0} has been disposed",this.Sab.id):n.jp?n.tkc():this.sa.selectShape(this.Sab,!0):K.a.J(19227933,334,50,"Try select node {0} but cannot find its shape view element",this.Sab.id);this.Bd();this.Sab=null}}}Object(h.a)(ca,"PptAccCheckManager",D,[]);class P{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=
!1;this.Results=null}static deserialize(n){n=Sys.Serialization.JavaScriptSerializer.deserialize(n);const O=n.AccessibilityRules,ha={};if(O)for(let Aa=0;Aa<O.length;++Aa){const La=O[Aa];ha[La.Key]=La.Value}n.AccessibilityRules=ha;return n}}Object(h.a)(P,"AccessibilityCheckResultCollection",null,[]);class ea{}Object(h.a)(ea,"AccessibilityCheckResult",null,[]);class da{}Object(h.a)(da,"AccessibilityCheckRule",null,[]);class ia{constructor(n){this.IJa=null;this.M2e=n}get fileId(){return this.M2e?this.M2e():
null}initialize(n){this.IJa=n}gWg(n){this.IJa.DRd(n)}}Object(h.a)(ia,"AAccessibilityCheckService",null,[1335,109]);var C=d(17),oa=d(107);class Z extends oa.a{constructor(){super()}Lk(){return 56}}Object(h.a)(Z,"AccCheckRequest",oa.a,[]);var pa=d(239);class ya extends ia{constructor(n,O){super(null);this.Yh=n;this.kUa=O}ETk(){const n=new pa.a(new Z,Object(r.a)(this,this.kek,"onAccCheckSucceed"),Object(r.a)(this,this.jek,"onAccCheckFailed"));this.Yh.Hb(n)}dispose(){}get mzj(){return 0<this.kUa.URb.length}kek(n){if(n&&
n.ACResult&&(n=this.Qbi(n.ACResult))){this.gWg(n);K.a.J(19227935,334,50,"Acc-check succeeded");return}this.GQg("Succeeded but response is invalid")}jek(n){this.GQg(n.toString());return!0}GQg(n){K.a.J(19227937,334,50,String.format("Acc-check failed: {0}",n));n=new P;n.IsSuccess=!1;this.gWg(n)}Qbi(n){if(n){var O=null;try{O=JSON.parse(n)}catch(ha){return K.a.J(19227939,334,10,"Cannot parse acc-check result json: {0}",ha.toString()),null}if(O){n=new P;n.IsSuccess=!0;n.IsPartialResult=O.isPartialResultField;
n.AccessibilityRules={};if(O.violatedRulesField){const ha=new C.a;for(const Aa of O.violatedRulesField)if(O=this.Sbi(Aa)){n.AccessibilityRules[O.RuleId]=O;for(const La of Aa.violationsField){const Bb=new ea;Bb.RuleId=O.RuleId;Bb.ContentName=La.labelField;Bb.ContentId=La;ha.add(Bb)}}n.Results=ha.toArray()}return n}}return null}Sbi(n){if(!n)return null;if(n.ruleIdField>=this.kUa.URb.length)return K.a.J(19227971,334,10,"Rule id {0} is bigger than total rule info list count {1}",n.ruleIdField,this.kUa.URb.length),
null;const O=new da;O.RuleId=n.ruleIdField.toString();O.RuleName=this.kUa.URb[n.ruleIdField].ruleTextField;switch(this.kUa.URb[n.ruleIdField].ruleTypeField){case 0:O.Category=0;break;case 1:O.Category=1;break;case 2:O.Category=2;break;case 3:O.Category=3}return O}}Object(h.a)(ya,"PptAccCheckService",ia,[1334,1335,109]);class Ja{get Qri(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get Rri(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get Sri(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get yok(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get sCb(){return CommonUIStrings.l_AccCheckerPaneTitle}get frk(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(h.a)(Ja,"AccessibilityCheckStringsProvider",null,[1445]);class Ka{constructor(){this.Bfh=this.contentId=null}}Object(h.a)(Ka,"ResultIds",null,[]);var ma=d(66),ra=d(178);class Da{constructor(n,O){this._element=null;this.mn=O;this.Kg=n}get element(){this._element||(this._element=this.tOd(),this.Ox());return this._element}Bfb(n){this._element=n}dispose(){this.element&&(this.ina(),this.Bfb(null))}Ox(){this.mn&&this.Kg?(this.mn.pb(ma.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),
this.Kg.pb(ma.a.Rf,this.element,Object(r.a)(this,this.eYg,"onKeyPress"))):m.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}ina(){this.mn&&this.Kg&&(this.mn.zb(ma.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),this.Kg.zb(ma.a.Rf,this.element,Object(r.a)(this,this.eYg,"onKeyPress")))}onClick(){this.$Xg();return!0}eYg(n){return this.XFj(n.nc.keyCode)?(this.$Xg(),!0):!1}XFj(n){return n===
ra.a.tJb||n===ra.a.Xp}}Object(h.a)(Da,"AInteractivePaneElement",null,[1452,109]);const va=(n,O,ha)=>{n=document.createElement(n);O&&(n.id=O);ha&&(n.className=ha);n.setAttribute("Unselectable","on");return n};var Fa=d(72),ka=d(132),qa=d(96);class Ua extends Da{constructor(n,O,ha){super(n,O);this.RPh=ha}hide(){this.element.removeAttribute(ka.a.ff);ka.a.mO(this.element,ka.a.XJ,ka.a.yB);this.element.style.display="none"}show(){ka.a.mO(this.element,ka.a.XJ,ka.a.Bpa);ka.a.mO(this.element,ka.a.ff,ka.a.JAc);
this.element.style.display="block"}tOd(){const n=va("div",this.dUg,"AccCheckerNotification");ka.a.mO(n,ka.a.rId,ka.a.yB);ka.a.mO(n,ka.a.o6,this.Wse);n.tabIndex=0;const O=va("span",this.cUg,"AccCheckerNotificationIcon");var ha=Fa.createClusteredImage(16,16,"Info_16x16x32","",!0,"");O.appendChild(ha);ha=va("span",this.Wse,"AccCheckerNotificationText");qa.a.Zw(ha,this.eUg);n.appendChild(O);n.appendChild(ha);return n}$Xg(){this.RPh()}}Object(h.a)(Ua,"APopupNotification",Da,[1492,1452,109]);class Ya extends Ua{constructor(n,
O,ha,Aa){super(n,O,ha);this.jaa=Aa}get dUg(){return"AccCheckerOutOfSyncNotificationId"}get cUg(){return"AccCheckerOutOfSyncNotificationIconId"}get Wse(){return"AccCheckerOutOfSyncNotificationTextId"}get eUg(){return this.jaa.yok}}Object(h.a)(Ya,"OutOfSyncNotification",Ua,[]);class Va extends Ua{constructor(n,O,ha,Aa){super(n,O,ha);this.jaa=Aa}get dUg(){return"AccCheckerPartialResultNotificationId"}get cUg(){return"AccCheckerPartialResultNotificationIconId"}get Wse(){return"AccCheckerPartialResultNotificationTextId"}get eUg(){return this.jaa.frk}}
Object(h.a)(Va,"PartialResultNotification",Ua,[]);var ua=d(120),Ca=d(102);class Ea{constructor(n,O,ha,Aa=null,La=null,Bb=null,Wb=null){this.Grf=this.b6=this.Kg=this.IJa=null;this.W8a=Aa;this.mn=n;this.Kd=O;this.C5=ha;this.jaa=Wb||new Ja;this.Byd=La||new Ya(this.W8a,this.mn,Object(r.a)(this,this.LEi,"dimissOutOfSyncNotification"),this.jaa);this.Qyd=Bb||new Va(this.W8a,this.mn,Object(r.a)(this,this.MEi,"dimissPartialResultNotification"),this.jaa)}show(){}hide(){}get W8a(){return this.Kg||(this.Kg=v.AFrameworkApplication.Ba.EF)}set W8a(n){this.Kg=
n}TQf(){}Pu(){}dispose(){}Jyh(){}ufd(){}Wyj(n){var O=this.Grf[n];n=O.contentId;if((O=O.Bfh+"")&&O.length){const ha=[];Array.add(ha,Object.assign(new E.a,{name:"RuleID",string:O}));x.a.sendTelemetryEvent(Object.assign(new I.a,{name:String.format("{0}.{1}",Ea.AOe,"ViolationSelected"),dataFields:ha}))}this.Mbk(n)}Mbk(n){n&&this.IJa.C_k(n)||(this.Kd.hX(ua.AFrame.sY,!1),this.v9k())}LEi(){this.Roh(!1);this.ufd()}MEi(){this.Toh(!1);this.ufd()}v9k(){const n=Object.assign(new Ca.StandardDialog(!0),{Zq:v.AFrameworkApplication.Sba,
vd:1,YXa:!1});n.hwa(1);n.Pe(1,this.jaa.Qri);n.Pe(0,CommonUIStrings.l_DialogCancel);n.nO(this.jaa.Sri,this.jaa.Rri,O=>{1===O&&this.S6d()})}vdi(n){let O=null;if(n.Results&&0<n.Results.length){O={};let ha=0;for(const Aa of n.Results)Aa.ResultId=Ea.gXh+ ++ha,n=new Ka,n.contentId=Aa.ContentId,n.Bfh=Aa.RuleId,O[Aa.ResultId]=n}return O}zVj(){x.a.addNamespaceMapping(Ea.AOe,Ea.hil);x.a.sendTelemetryEvent(Object.assign(new I.a,{name:String.format("{0}.{1}",Ea.AOe,"ShowTaskpane")}))}}Ea.gXh="AccCheckResult";
Ea.AOe="Office.UX.AccChecker";Ea.hil="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(h.a)(Ea,"BaseAccessibilityCheckPane",null,[1273,109]);class wb{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(h.a)(wb,"AccCheckerTaskPaneProps",null,
[]);var Oa=d(1113),ab=d(279);class fb{constructor(){this.dpc=new C.a}qHa(n){this.dpc.add(n)}N1k(n){for(let O of this.dpc)O(n)}}Object(h.a)(fb,"ReactTaskPaneManager",null,[1454]);var db=d(634),gc=d(150);class ob extends Ea{constructor(n,O,ha,Aa,La=null,Bb=null,Wb,uc=null,Vc=null){super(O,ha,Aa,Bb,void 0,void 0,uc);this.RUe=null;this.lqf=this.Pyd=this.Kuc=this.kwc=this.Wvc=!1;this.gEd=null;this.aDd=!!v.AFrameworkApplication.Ba&&!!v.AFrameworkApplication.Ba.jb&&v.AFrameworkApplication.Ba.jb.nvb;this.kMb=
this.wna=null;this.KMb=0;this.Krc=null;this.sod=La;Vc&&(this.wna=Vc.uXh,this.kMb=Vc.HQi,this.KMb=Vc.Ppj);this.zoa=new fb}get isVisible(){return this.lqf}nGb(n){this.lqf=n}DRd(n){n&&(this.RUe=n,n.IsSuccess&&(this.Grf=this.vdi(n),n.IsPartialResult&&this.Toh(!0)),this.Wvc=!0,this.kwc=!1,this.dnc())}Roh(n){this.isVisible&&n!==this.Kuc&&(this.Kuc=n,this.dnc())}Toh(n){this.Pyd=n;this.dnc()}kn(){this.kwc||gc.UISurfaces.du().then(n=>{ab.a.instance.r1(ob.xZa+":PaneOpen:Start");n.showTaskPane(ob.xZa,this.gqa());
this.S6d();return null});this.isVisible?gc.UISurfaces.du().then(n=>{n.setSelectedTaskPane(ob.xZa);return null}):this.zVj()}dnc(){gc.UISurfaces.du().then(n=>{n.updateTaskPane(ob.xZa,this.gqa());return null})}gqa(){var n=new wb;this.zoa.N1k(n);n=Object.assign(new db.a,{title:this.jaa.sCb,hideHeader:!1,width:320,location:2,contentProps:n,onOpen:()=>{this.F_k();this.nGb(!0);v.AFrameworkApplication.Ba.updateCommandUI()},onClose:()=>{this.zfd();this.nGb(!1);this.kwc=this.Wvc=!1;this.dnc();v.AFrameworkApplication.Ba.updateCommandUI()},
isModernPane:!0});this.aDd&&(n.enableResize=!0,n.minResizeWidth=268,n.maxResizeWidth=920);return n}initialize(n){const O=this.Kd.Bc(ob.xZa);O.parent=ua.AFrame.kj;O.HK=!0;this.IJa=n;this.JXh()}dispose(){this.Jyh();this.Byd&&(this.Byd.dispose(),this.Byd=null);this.Qyd&&(this.Qyd.dispose(),this.Qyd=null);super.dispose()}JXh(){this.zoa.qHa(this.onRecheckExecute());this.zoa.qHa(this.eVi());this.zoa.qHa(this.t9i());this.zoa.qHa(this.onInvokeNavigateExecute());this.zoa.qHa(this.k2i());this.zoa.qHa(this.T6i());
this.zoa.qHa(this.v7i());this.zoa.qHa(this.updateLastScanTime());this.zoa.qHa(this.showHelpPane())}onRecheckExecute(){return n=>{n.onRecheckExecute=()=>{this.S6d()}}}eVi(){return n=>{n.accessibilityCheckResultCollection=this.RUe}}t9i(){return n=>{n.resultsReady=this.Wvc}}onInvokeNavigateExecute(){return n=>{n.onInvokeNavigateExecute=O=>{this.Wyj(O)}}}k2i(){return n=>{n.helpLink=this.tMi}}T6i(){return n=>{n.outOfSync=this.Kuc}}v7i(){return n=>{n.partialResult=this.Pyd}}updateLastScanTime(){return n=>
{n.updateLastScanTime=O=>{this.gEd=O}}}showHelpPane(){return n=>{n.showHelpPane=()=>{v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?v.AFrameworkApplication.MAa||this.BFf()?this.Krc?this.Krc():this.wna.value&&this.kMb&&this.KMb&&this.wna.value.Ma(this.KMb,2,this.kMb):this.Bph():this.BFf()?this.Krc?this.Krc():this.wna.value&&this.kMb&&this.KMb&&this.wna.value.Ma(this.KMb,2,this.kMb):this.Bph()}}}BFf(){return!this.sod||
!this.sod.value}Bph(){const n=this.sod.value;if(n){var O={};O.query=ob.BRh+ob.ctd;O=Object.assign(new Oa.a,{bO:O});n.pIa(ob.btd,O)}}S6d(){this.Pyd=this.Kuc=this.Wvc=!1;this.gEd&&this.gEd();this.dnc();this.kwc=!0;this.IJa.due()}F_k(){this.Kd.vf(ob.xZa)}zfd(){this.aae()&&this.Kd.vf(this.Kd.H6)}aae(){return!!this.Kd.ye&&this.Kd.ye.name===ob.xZa}}ob.xZa="AccessibilityCheckerPane";ob.ctd="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";ob.btd="FA000000012";ob.BRh="AssetID=";Object(h.a)(ob,"ReactAccessibilityCheckPane",
Ea,[]);class Sb{constructor(n,O,ha){this.uXh=n;this.HQi=O;this.Ppj=ha}}Object(h.a)(Sb,"HelpPaneProperties",null,[]);var Jb=d(104),Ab=d(28);class lc extends ob{constructor(n,O,ha,Aa,La,Bb,Wb,uc){super(null,O,ha,Aa,void 0,null,void 0,void 0,new Sb(Wb,lc.q1i(),Ab.a.pIa));this.g$b=n;this.GWj=La;this.SG=Bb;this.xJg=Wb;this.BD=uc}get isVisible(){return!!this.g$b&&this.g$b.isVisible}nGb(n){this.g$b&&(this.g$b.isVisible=n)}get tMi(){return this.GWj}kn(){this.nGb(!0);this.SG.ML(this.g$b,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,
ua.AFrame.sY);super.kn();if(this.xJg){var n=this.xJg.value;if(n){n.processAction(Ab.a.ozf,1);n=!1;try{this.BD.selectRibbonTabById("AccessibleAuthoring"),n=!0}catch(O){K.a.J(544736533,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",O.toString())}Jb.a("AccessibleAuthoringTab",n)}else K.a.J(544286875,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else K.a.J(544265629,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")}Y6c(){}onBeforeLoadContent(){}onAfterLoadContent(){this.IJa&&
this.IJa.Fve()}onAfterFirstSaveContent(){}static q1i(){const n={};n.ZT=ResourceStrings.L_Help;n.assetId="FA000000012";n.bO={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};return n}}Object(h.a)(lc,"PptReactAccCheckControl",ob,[377]);class Mc{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Accessibility"}Yb(n){this.K=n;this.K.register(ya,"PowerPointWebEditor.Accessibility.PptAccCheckService").as("PowerPointWebEditor.Accessibility.IPptAccCheckService").as("Common.App.AccessibilityChecker.IAccessibilityCheckService").ma().na(()=>
new ya(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(1273,"Common.App.AccessibilityChecker.IAccessibilityCheckPane").ma().na(()=>new lc(this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointAccCheckHelpUrl,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),
this.K.qe("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.register(185,"Common.App.AccessibilityChecker.IAccessibilityCheckManager").ma().na(()=>new ca(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEnableAccCheck&&(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService").dispose(),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane").dispose(),
this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager").dispose())}static main(){e.a.instance.Ec(new Mc)}}Object(h.a)(Mc,"PptAccessibilityPackage",null,[2,3]);var Jc=d(177),rb=d(1159),cc=d(231),jb=d(187),Xb=d(523),yb=d(53),mb=d(112);class Ub{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc){this.ia=n;this.la=O;this.HWj=ha;this.IWj=Aa;this.p9a=La;this.BD=Wb;this.kUa=Bb;this.Ga=uc;this.qc=Vc;this.kUa.Y1h(Object(r.a)(this,this.A$g,"refreshAccCheckButtonStatus"))}wb(){this.la.powerPointEnableAccCheck&&
(this.ia.ra(Ab.a.k4g,yb.a.application,Object(r.a)(this,this.Rii,"checkAccessibility"),4),this.ia.ra(Ab.a.zAk,yb.a.application,Object(r.a)(this,this.Tzk,"queryCheckAccessibility"),97))}Fe(){this.la.powerPointEnableAccCheck&&this.Ga.Bc(mb.a.RIf).bindAction(jb.KeyInputManager.La(ra.a.eoc,jb.KeyInputManager.He|1),Ab.a.k4g)}Rii(n,O,ha,Aa,La){return 1===ha?this.qc.wj()?this.IWj.mzj?32:8:8:this.HWj.kn(n,O,ha,Aa,La)}Tzk(n,O,ha,Aa,La){La[Xb.a.On]=this.p9a.isVisible;return 32}dispose(){this.kUa.MMk(Object(r.a)(this,
this.A$g,"refreshAccCheckButtonStatus"))}A$g(){this.BD.YG()}}Object(h.a)(Ub,"AccCheckActor",null,[234,109]);class ec{constructor(){this.T5b=this.K=null}get name(){return"PowerPointWebEditor.LazyActors"}Yb(n){this.K=n}init(){this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Mtb(()=>{this.wtb()})}wtb(){const n=this.K.resolve("Common.AFrameworkApplication").GR.kd,O=this.K.resolve("Common.IActionManagerExtended");n.powerPointEnableAccCheck&&(this.T5b=new Ub(O,n,this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager"),
this.K.resolve("PowerPointWebEditor.Accessibility.IPptAccCheckService"),this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")),this.T5b.wb(),this.T5b.Fe());n.Gbe&&Jc.a.get_instance().Ak(7,Object(r.a)(this,this.Gbe,"loadInternalSlice"))}Gbe(){const n=rb.a.create("pptedit.internal",
null,()=>d.e(17).then(d.bind(null,1205)));cc.a.nt(n)}dispose(){this.T5b&&this.T5b.dispose()}static main(){e.a.instance.Ec(new ec)}}Object(h.a)(ec,"PptLazyActorsPackage",null,[2,3]);var nc=d(208),Lb=d(570),Zc=d(1162),Pb=d(184),eb=d(165),$a=d(61),vb=d(47),bc=d(68),Cc=d(140),Gc=d(615);class sd extends Gc.a{constructor(){super();this.fe=this.createElement(bc.a.dPe)}w3k(n){this.za.textContent=n}appendChild(n){if(!n.za||!this.za)throw Error.argumentNull();this.za.appendChild(n.za)}}Object(h.a)(sd,"HTMLText",
Gc.a,[]);var Sd=d(317),ie=d(203);class De{constructor(n,O,ha,Aa,La,Bb,Wb,uc){this.ud=1;this.toe=null;this.n_=new Pb.a;this.av=new Pb.a;this.Mm=null;this.ro=!1;this.EXc=null;this.NGg="";this.jEa=this.P8=!1;this.ibb=this.$Sa=this.V9a=this.iEa=this.Pwb=this.yca=null;this.URa=!1;this.xa=n;this.Bb=O;this.Qd=ha;this.la=Aa;this.ia=La;this.jd=Bb;this.ob=Wb;this.cC=uc}q$k(n){this.yca&&this.ibb&&(this.P8=!0,this.ibb.appendChild(this.yca.za),this.ob.VJ(Object(r.a)(this,this.IGa,"onSelectionChange")),this.EXc=
new Y.a(3,1,this.la.Zoh,Object(r.a)(this,this.dismissImageDescriptionBarTask,"dismissImageDescriptionBarTask"),90,"19"),this.Xzh(n))}Xrl(n){this.xa===n&&this.P8&&this.Xzh(this.xa.get_alt())}Vm(n){this.ibb=n.za;this.evi()}SD(n){if(this.P8&&!this.ro)switch(n){case 1:n=this.Qd.rk("formatpainterobject.cur");this.iEa.Tk(vb.a.oP(n,bc.a.$kc));break;case 0:this.iEa.Tk(bc.a.$kc)}}eq(){return null}IP(){return!1}Rx(n){this.ro=n}dispose(){this.yGc();this.yca&&(this.$Sa=this.V9a=this.Pwb=this.iEa=this.yca=null)}mz(){}TE(){return null}MD(){return[]}draw(){this.P8&&
this.$Re(!0)}get visible(){return this.jEa}set visible(n){this.P8&&(this.jEa!==n&&(this.jEa=n,this.yca.setVisibility(this.jEa)),this.jEa||this.yGc())}setPosition(){}Ej(n){this.ud=n;this.P8&&(this.a$c(),this.Wzh())}Nq(n){this.n_=n;this.P8&&this.a$c()}ov(n){this.av=n;this.P8&&this.a$c()}setZIndex(n){this.P8&&this.yca.tC(n)}wF(n,O){this.P8&&(this.$Re(!n&&O||!O),n||this.Bb.v4(this.EXc,this.la.Zoh))}setSelection(){}evi(){this.yca=new Cc.a;this.iEa=new Sd.a;this.iEa.Fma("ImageDescriptionBarBackground");
this.jd.pb(ma.a.click,this.iEa.za,Object(r.a)(this,this.jik,"onImageDescriptonBarClickHandler"));this.Pwb=new ie.a;this.Pwb.appendChild(this.iEa);this.V9a=new sd;this.V9a.gt("ImageDescriptionBarText");this.Wzh();this.$Sa=new Cc.a;this.$Sa.gt("ImageDescriptionBarTextWrappingDiv");this.$Sa.appendChild(this.V9a);this.yca.appendChild(this.Pwb);this.yca.appendChild(this.$Sa)}Xzh(n){const O=n.indexOf("\n");this.NGg=-1===O?n:n.substring(0,O);this.V9a.w3k(ResourceStrings.L_ShapeAltText+": "+this.NGg);this.$Re(!0)}$Re(n){this.Mm=
this.xa.Vq;this.jEa=n;this.a$c();this.yca.setVisibility(this.jEa);this.URa||(this.URa=!0,this.Bb.Hb(this.EXc))}Wzh(){this.V9a.za.style.fontSize=this.cC.fha(29)}jik(){this.ia.processAction(Ab.a.fAc,2);return!0}IGa(){this.yGc()}dismissImageDescriptionBarTask(){this.yGc()}yGc(){this.P8&&(this.jEa=this.P8=!1,this.ob.yHa(Object(r.a)(this,this.IGa,"onSelectionChange")),this.URa&&(this.Bb.ah(this.EXc),this.URa=!1),this.ibb&&this.ibb.contains(this.yca.za)&&this.ibb.removeChild(this.yca.za))}a$c(){if(this.P8&&
this.Mm){var n=this.Mm.copy();this.n_.Fm(n);this.av.Fm(n);this.toe=Lb.a.uT($a.a.WJ(n.ga(0),n.ga(1)));var O=n.Yj(new eb.a(6)),ha=n.Yj(new eb.a(4));n=n.Yj(new eb.a(2));n=$a.a.Nl(ha,n)*this.ud;ha=$a.a.Nl(O,ha)*this.ud;if(60>ha||80>n)this.jEa=!1;else{n=this.ibb.children[0].style;this.Pwb.setPosition(this.FIb(n.left),this.FIb(n.top));this.Pwb.Bh(this.FIb(n.width),this.FIb(n.height));var Aa=this.cC.Ie(Zc.a.yf(40,1),1);this.$Sa.setPosition(O.x*this.ud,O.y*this.ud-Aa);this.$Sa.Bh(ha,Aa);this.$Sa.za.style.transform=
this.hOa(this.toe);this.V9a.Bh(ha-9,Aa-6);var La=new Pb.a;La.k6(this.toe,new $a.a(0,Aa));La.vB(O.x*this.ud-this.FIb(n.left),O.y*this.ud-this.FIb(n.top)-Aa);this.iEa.yF(La,1);this.iEa.Bh(ha,Aa)}}}FIb(n){n=parseFloat(n);return isNaN(n)?0:n}hOa(n){return"rotate("+n.toString()+"deg)"}}Object(h.a)(De,"ImageDescriptionBarView",null,[1336,283,284,109]);var yd=d(981),ib=d(45),dc=d(37);class Bc{constructor(n,O,ha,Aa){this.shapeNode=n;this.CIc=O;this.uIj=ha;this.imageDescription=Aa}}Object(h.a)(Bc,"ImageDescriptionCache",
null,[]);var Ob=d(212);class yc{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd){this.n8=new yd.a;this.Pb=n;this.Yh=O;this.Hn=Wb;this.O9a=ha;this.ob=Aa;this.TZ=Bb;this.A_j=La;this.Ow=uc;this.Jb=Vc;this.Zb=bd;this.fje=xd}initialize(){this.Ow.yk(Object(r.a)(this,this.Ah,"onPropertyChanged"));this.Hn.nCf(Object(r.a)(this,this.eCb,"onShapeImageFirstDraw"));this.Hn.N2h(Object(r.a)(this,this.tYg,"onLocalImageViewDismissed"));this.O9a.I2h(Object(r.a)(this,this.QXg,"onImageDescriptionReady"))}dispose(){this.Ow.Pm(Object(r.a)(this,
this.Ah,"onPropertyChanged"));this.Hn.xDe(Object(r.a)(this,this.eCb,"onShapeImageFirstDraw"));this.Hn.oNk(Object(r.a)(this,this.tYg,"onLocalImageViewDismissed"));this.O9a.lNk(Object(r.a)(this,this.QXg,"onImageDescriptionReady"))}Ah(n,O){(n=O.node)&&n.sk&&(O=O.property,O===dc.a.alt?((O=Object(M.a)(133,n.pc(this.Pb.Na)))&&O.KP&&n.get_alt()&&this.fje.yP(n).Xrl(n),this.A_j.qql(n),n.get_alt()&&this.mhd(n,n.get_alt())):O===dc.a.zA?n.zA&&(O=Object(M.a)(133,n.pc(this.Pb.Na)))&&O.KP&&(this.fje.yP(n).visible=
!1):O===dc.a.mh&&n.mh!==Ob.a.nS&&(O=Object(M.a)(133,n.pc(this.Pb.Na)))&&O.KP&&!n.kca&&this.n8.ga(n.id)&&this.n8.ga(n.id).CIc&&(this.mrb(n,O),this.n8.remove(n.id)))}QXg(n,O){if(n=O.aOc){var ha=O.confidence,Aa=O.imageDescription,La=O.BEj;O=O.CIc;var Bb=this.TZ.Aba(n),Wb=Bb?Object(M.a)(133,Bb.pc(this.Pb.Na)):null;O?Wb&&Wb.KP&&!Bb.isLocal&&!Bb.zA?this.mrb(Bb,Wb):this.n8.add(n,new Bc(Bb,!0,!0,Aa)):!Aa||!La&&60>ha?K.a.J(33609505,815,15,"isGenerateSuggestion: {0}, confidence: {1}",La,ha):(Aa=this.xoi(ha,
Aa),La?this.rHe(Bb,Aa,!1):(K.a.J(34194368,815,50,"Image description ready for show and save"),Wb&&Wb.KP?(K.a.J(34194370,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",n.toString(),(new Date).getTime()),this.mhd(Bb,Aa),Bb.isLocal?this.n8.add(n,new Bc(Bb,!1,!1,Aa)):(K.a.J(34194372,815,50,"Save image description immediately"),this.rHe(Bb,Aa,!0))):this.n8.add(n,new Bc(Bb,!1,!0,Aa))))}else K.a.J(33609503,815,15,"Graph node id is null")}eCb(n,O){n=O.aOc;K.a.J(34194374,815,50,
"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",n?n.toString():"",(new Date).getTime());this.n8.Kb(n)?this.d6g(n):(n=this.TZ.Aba(n))&&n.get_alt()&&this.mhd(n,n.get_alt())}xoi(n,O){O+=String.fromCharCode(10,10);return O=80<=n?O+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:60<=n?O+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=n?O+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=n?O+ResourceStrings.L_ImageDescriptionWithLowConfidence:O+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence}tYg(n,
O){(n=O.Kcl)&&this.n8.Kb(n.id)&&this.d6g(n.id)}d6g(n){const O=this.n8.ga(n).shapeNode;if(O){var ha=this.n8.ga(n).CIc,Aa=this.n8.ga(n).uIj,La=this.n8.ga(n).imageDescription;ha?(ha=Object(M.a)(133,O.pc(this.Pb.Na)))&&this.mrb(O,ha):(Aa&&this.mhd(O,La),O.isLocal?K.a.J(33609539,815,15,"Try to save alt text for local picture"):this.rHe(O,La,!0));this.n8.remove(n)}else K.a.J(37029889,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}mrb(n,O){this.Yh.generateImageDescription(n.id,O.sMe,
n.get_isSVGBlipFilled(),!1)}rHe(n,O,ha){if(!ha||!n.get_alt()){var Aa=this.Jb.ie(ha?7:15);Aa.lc(n);n.$Xa=ha;n.set_alt(ib.a.RQa(O));Aa.dispose();ha&&this.Yh.forceOutbound()}}mhd(n,O){if(n.sk){this.Zb.gd(n)&&K.a.J(34079445,815,50,"Graph node or parents blocked");var ha=this.ob.he();ha&&this.ob.PV(n)?(K.a.J(33609545,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",n.id.toString(),(new Date).getTime()),this.fje.yP(n).q$k(O)):K.a.J(33609543,815,50,"Is selected shapes empty: {0}",
!ha)}else K.a.J(33609541,815,50,"ShapeNode.IsPicture: {0}",n.sk)}}Object(h.a)(yc,"ImageDescriptionManager",null,[109]);var fc=d(94),Nb=d(372),lb=d(60),Qc=d(73),Rc=d(46);class ld{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe){this.xa=null;this.KS=0;this.hje=new yd.a(0);this.nE=!!v.AFrameworkApplication.Ba&&!!v.AFrameworkApplication.Ba.jb&&v.AFrameworkApplication.Ba.jb.NV;this.ph=n;this.Rb=O;this.Qd=ha;this.Ga=bd;this.Yh=Aa;this.jd=La;this.ob=Bb;this.uD=Wb;this.XZ=uc;this.Jb=Vc;this.O9a=xd;this.SG=
xe;this.xb=document.createElement("div");this.xb.className=lb.a.gkg;this.xb.id=lb.a.gkg;this.xb.style.position=Qc.a.Mwa;this.xb.setAttribute(ka.a.ff,ka.a.Nza);this.xb.setAttribute(ka.a.o6,"ImageDescriptionPaneLabel");this.jd.pb(ma.a.click,this.xb,Object(r.a)(this,this.hfh,"rootElementClickHandler"));this.XZ.addHandler(this.xb,ma.a.Rf,Object(r.a)(this,this.Qra,"inputKeyPressHandler"));this.Sb=!1;this.AEa=vb.a.De();this.AEa.className="ImageDescriptionPaneLayoutRoot";this.Zn=this.tAa("per","ClosePaneGlyph_16x16x32");
Sys.UI.DomElement.addCssClass(this.Zn,"ImageDescriptionPaneCloseButton");this.Zn.setAttribute(ka.a.ff,ka.a.St);this.AEa.appendChild(this.Zn);this.jd.pb(ma.a.click,this.Zn,Object(r.a)(this,this.Nob,"closeButtonClickHandler"));this.XZ.addHandler(this.Zn,ma.a.focus,Object(r.a)(this,this.OBb,"onElementFocused"));this.h8b=vb.a.De();this.h8b.id="ImageDescriptionPaneLabel";this.h8b.className="PaneLabel";this.h8b.innerText=ResourceStrings.L_ShapeAltText;this.AEa.appendChild(this.h8b);this.nZc=vb.a.De();this.nZc.innerText=
ResourceStrings.l_ImageDescriptionPaneLabel;this.nZc.className="ImageDescriptionLabel";this.AEa.appendChild(this.nZc);this.mZc=vb.a.De();this.mZc.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.mZc.className="ImageDescriptionHint";this.AEa.appendChild(this.mZc);this.gje=vb.a.De();this.$V=document.createElement("textarea");this.$V.className="AltTextTextArea";this.$V.setAttribute(ka.a.ht,ResourceStrings.L_ShapeAltText);this.$V.tabIndex=0;this.gje.appendChild(this.$V);this.AEa.appendChild(this.gje);
this.jd.pb(ma.a.click,this.$V,Object(r.a)(this,this.ADf,"altTextboxClickHandler"));this.XZ.addHandler(this.$V,ma.a.Rf,Object(r.a)(this,this.BDf,"altTextboxTypingHandler"));this.XZ.addHandler(this.$V,ma.a.focus,Object(r.a)(this,this.OBb,"onElementFocused"));n=vb.a.tn();n.className="GenerateDescriptionButtonText";n.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltip;n.setAttribute("Unselectable","on");this.RZ=vb.a.Raa();this.RZ.className="ImageDescriptionPaneButton cui-ctl";this.RZ.setAttribute(ka.a.ff,
ka.a.St);this.RZ.tabIndex=0;this.RZ.appendChild(n);this.AEa.appendChild(this.RZ);this.jd.pb(ma.a.click,this.RZ,Object(r.a)(this,this.X4f,"generateDescriptionClickHandler"));this.XZ.addHandler(this.RZ,ma.a.focus,Object(r.a)(this,this.OBb,"onElementFocused"));this.uD.o7(Rc.a.Nra,Rc.a.kj,this.xb,()=>{this.RW(!0)},()=>{this.RW(!1)},!0);this.uD.o7(Rc.a.fHd,Rc.a.kj,this.$V,()=>{this.zXg(!0)},()=>{this.zXg(!1)},!0);this.O9a.k3h(Object(r.a)(this,this.d_g,"onShowHideAltTextPane"))}Nuj(){this.Sii()&&(this.$V.value=
this.xa.get_alt(),this.xb.appendChild(this.AEa),this.RZ.style.display=this.xa.isLocal?Qc.a.og:Qc.a.wl,this.Sb=!0,this.xb.style.display=Qc.a.wl,this.nE?(this.Pyc(this.xb),this.SG.ML(this,this.Sb,ResourceStrings.L_ShapeAltText,Rc.a.Nra)):this.Rb.Mq(),this.ob.VJ(Object(r.a)(this,this.IGa,"onSelectionChange")),K.a.J(25454222,815,50,"ImageDescriptionPane::InitializeAndShow"))}dispose(){this.MCc();this.O9a.FNk(Object(r.a)(this,this.d_g,"onShowHideAltTextPane"));this.jd.zb(ma.a.click,this.xb,Object(r.a)(this,
this.hfh,"rootElementClickHandler"));this.XZ.removeHandler(this.xb,ma.a.Rf,Object(r.a)(this,this.Qra,"inputKeyPressHandler"));this.jd.zb(ma.a.click,this.Zn,Object(r.a)(this,this.Nob,"closeButtonClickHandler"));this.XZ.removeHandler(this.Zn,ma.a.focus,Object(r.a)(this,this.OBb,"onElementFocused"));this.jd.zb(ma.a.click,this.$V,Object(r.a)(this,this.ADf,"altTextboxClickHandler"));this.XZ.removeHandler(this.$V,ma.a.Rf,Object(r.a)(this,this.BDf,"altTextboxTypingHandler"));this.XZ.removeHandler(this.$V,
ma.a.focus,Object(r.a)(this,this.OBb,"onElementFocused"));this.jd.zb(ma.a.click,this.RZ,Object(r.a)(this,this.X4f,"generateDescriptionClickHandler"));this.XZ.removeHandler(this.RZ,ma.a.focus,Object(r.a)(this,this.OBb,"onElementFocused"));this.RZ=this.$V=this.gje=this.mZc=this.nZc=this.h8b=null;K.a.J(25454224,815,50,"ImageDescriptionPane::Dispose")}qql(n){this.xa&&n===this.xa&&this.Sb&&(this.hje.Kb(n.id.toString())&&this.xa.mh!==this.hje.ga(n.id.toString())&&K.a.J(33609549,815,50,"ImageDescriptionPane::UpdateAltTextbox - Image version have been changed after generate description"),
2!==this.KS&&(this.$V.value=this.xa.get_alt()))}layout(n,O){const ha=O?n.CF(this.width):n.DF(this.width);this.Sb&&(O?(Sys.UI.DomElement.addCssClass(this.xb,lb.a.ikg),ha.CF(lb.a.D4d)):(Sys.UI.DomElement.addCssClass(this.xb,lb.a.hkg),ha.DF(lb.a.D4d)));vb.a.b0(this.xb,ha);return n}get isVisible(){return this.Sb}get za(){return this.xb}get order(){return 10}RW(n){this.Sb&&(n?0===this.KS&&this.Lwh():this.KS=0)}zXg(n){this.Sb&&(n||this.Ejh(),this.Rb.updateCommandUI())}BDf(n){n.keyCode===ra.a.I0&&n.ctrlKey?
this.IFb():(2!==this.KS&&this.mjh(),this.KS=2)}Qra(n){this.Sb&&(n.keyCode===ra.a.Xp||n.keyCode===ra.a.wO?1===this.KS?this.aK():3===this.KS?this.mrb():2===this.KS&&(this.RZ.style.display=Qc.a.wl):2===this.KS&&(this.RZ.style.display=Qc.a.wl))}Lwh(){fc.FocusManager.xr(this.Zn)?(this.IFb(),this.KS=1):K.a.J(33609551,815,50,"Fail to set focus on close button")}IFb(){this.Ga.pC(Rc.a.Nra)}mjh(){this.Ga.pC(Rc.a.fHd)}Sii(){const n=this.ob.he();if(!n||1<n.length||!n[0].sk)return K.a.J(25798606,815,50,"ImageDescriptionPane::CheckAndCacheShapeNode - shape node is null: {0}",
!n),!1;this.xa=n[0];return!0}Nob(){this.aK();return!0}aK(){this.Sb&&(this.MCc(),this.Ga.Kj(Rc.a.Nra,!1),K.a.J(25454226,815,50,"ImageDescriptionPane::CloseButtonClickHandler - Image Description pane close button clicked."))}hfh(){this.Sb&&(this.IFb(),this.KS=0);return!0}ADf(){this.mjh();this.KS=2;return!0}X4f(){this.IFb();this.mrb();return!0}mrb(){this.KS=3;this.RZ.style.display=Qc.a.og;this.Lwh();const n=this.xa?Object(M.a)(133,this.xa.pc(0)):null;n?(this.hje.add(this.xa.id.toString(),this.xa.mh),
this.Yh.generateImageDescription(this.xa.id,n.sMe,this.xa.get_isSVGBlipFilled(),!0)):K.a.J(25798609,815,15,"ImageDescriptionPane::GenerateDescriptionClickHandler - Is shape node null {0}",!this.xa)}d_g(){this.Sb?this.MCc():(this.Nuj(),this.KS=0);this.Ga.Kj(Rc.a.Nra,this.Sb);K.a.J(25454228,815,50,"ImageDescrptionPane::ShowOrHidePane {0}",!this.Sb)}IGa(){this.MCc();this.ph.ap(Rc.a.Nra)}OBb(n){this.Sb&&(n.target===this.Zn?this.KS=1:n.target===this.$V?this.KS=2:n.target===this.RZ&&(this.KS=3))}MCc(){this.Sb&&
(this.ob.yHa(Object(r.a)(this,this.IGa,"onSelectionChange")),this.Ejh(),this.Sb=!1,this.xb.removeChild(this.AEa),this.xb.style.display=Qc.a.og,this.nE?(this.Pyc(this.xb),this.SG.ML(this,this.Sb,ResourceStrings.L_ShapeAltText,Rc.a.Nra)):this.Rb.Mq(),K.a.J(25454230,815,50,"ImageDescriptionPane::CleanUpAndHide"))}Pyc(n){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(n,lb.a.ikg):Sys.UI.DomElement.addCssClass(n,lb.a.hkg)}Ejh(){const n=this.$V.value;if(n!==this.xa.get_alt()){var O=this.Jb.ie(15);
O.lc(this.xa);this.xa.$Xa=!1;this.xa.set_alt(n);O.dispose()}}tAa(n,O){return this.sAa(n,"cui-img-16by16","cui-ctl-iconContainer",O,CommonUIStrings.l_DialogClose,null)}sAa(n,O,ha,Aa,La,Bb){const Wb=vb.a.FB();Wb.alt=La;Wb.className=Fa.getImageClassWithCluster(n,Aa);Wb.src=this.Qd.rk(n+".png");Wb.setAttribute("Unselectable","on");n=vb.a.tn();n.className=O+" cui-img-cont-float";n.appendChild(Wb);O=vb.a.tn();O.className=ha;O.setAttribute("Unselectable","on");O.appendChild(n);ha=vb.a.Raa();ha.className=
"ImageDescriptionPaneNoBorderButton cui-ctl";ha.title=La;ha.setAttribute(ka.a.ff,ka.a.St);ha.tabIndex=0;ha.appendChild(O);Bb&&(La=vb.a.tn(),La.className="cui-ctl-mediumlabel",La.setAttribute("Unselectable","on"),La.innerText=Bb,ha.appendChild(La));return ha}get width(){return this.Sb?lb.a.ksj+lb.a.D4d+Nb.a.iXa:0}}Object(h.a)(ld,"ImageDescriptionPane",null,[1271,454,109]);var Dd=d(277);class gd{constructor(){this.K=null;this.nE=!!v.AFrameworkApplication.Ba&&!!v.AFrameworkApplication.Ba.jb&&v.AFrameworkApplication.Ba.jb.NV}get name(){return"PowerPointWebEditor.ImageDescription"}Yb(n){this.K=
n;this.K.register(259,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>").ma().na(()=>new Dd.a(O=>{let ha=null;const Aa=Object(M.a)(133,O.pc(n.resolve("Box4.IPageView").Na));Aa&&!Aa.kl&&(ha=new De(O,this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.IPageView").Ed),ha.Vm(Aa.IT),Aa.Bza(ha,4));return ha}));this.K.register(1271,"PowerPointWebEditor.IImageDescriptionPane").ma().na(()=>new ld(this.K.resolve("Common.IF6Manager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),
this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(yc,"PowerPointWebEditor.ImageDescriptionManager").ma().na(()=>new yc(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IImageDescriptionPane"),this.K.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").qRa&&
(this.nE||this.K.resolve("PowerPointWebEditor.IPaneManager").wM(this.K.resolve("PowerPointWebEditor.IImageDescriptionPane")),this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").initialize())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").qRa&&this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").dispose()}static main(){e.a.instance.Ec(nc.a(new gd,0))}}Object(h.a)(gd,"PPTWebEditorImageDescriptionPackage",null,[2,3]);var be=d(83);class od extends be.a{constructor(n){super(!1,
!1,!0);this.poc=n}start(){const n={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.poc.p4d}};this.qj("",Object(r.a)(this,this.tSk,"resultHandler"),n)}tSk(n,O){1===n&&(this.poc.p4d=O.tooltipPersistenceEnabled)}}Object(h.a)(od,"AccessibilitySettingsDialog",be.a,[]);class $d{constructor(n,O){this.Da=n;this.poc=O}wb(){this.Da.ya(G.a.V8k,H.a.frame,Object(r.a)(this,this.W8k,"showAccessibilitySettingsDialogHandler"))}W8k(){(new od(this.poc)).start();return 32}}Object(h.a)($d,
"AccessibilitySettingsDialogActor",null,[1372]);var xf=d(1019);const Na=n=>{const O=new xf.a;v.AFrameworkApplication.Be.Jj(xb(n),1,null,null,!0,2,ha=>{200===ha.data.tf?O.Ig("true"===ha.data.je.toLowerCase()):O.Ig(!1)},()=>{O.Ig(!1)},null,void 0,void 0,void 0,void 0,"7");return O.task},xb=n=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",v.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",n,v.AFrameworkApplication.$g);var sc=d(76);class cd{constructor(){this.Kjb=
null}get p4d(){return!!this.Kjb}set p4d(n){n!==this.Kjb&&(this.Kjb=n,sc.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(n),this.zvg()&&v.AFrameworkApplication.Be.Jj(xb("saveHoverableRibbonTooltipIsEnabled"),2,n.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}FRj(){const n=new xf.a;if(this.Kjb)n.Ig(this.Kjb);else if(this.zvg()){const O=Na("getHoverableRibbonTooltipIsEnabled");O.continueWith(()=>{this.Kjb=O.result;sc.a("setHoverableTooltipsPreference")&&
appChrome.api.setHoverableTooltipsPreference(O.result);n.Ig(O.result)},8)}else n.Ig(!1)}zvg(){const n=v.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled"),O=v.AFrameworkApplication.fa.ka("IsAnonymousUser");return n&&!O}}Object(h.a)(cd,"AccessibilitySettingsInfo",null,[1371]);class Ta{constructor(){this.Ea=null}get name(){return"Common.App.AccessibilitySettings"}Yb(n){this.Ea=n;this.Ea.register(cd,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").na(()=>
new cd).ma();this.Ea.register($d,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").na(()=>new $d(v.AFrameworkApplication.Va,this.Ea.qb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ma()}init(){const n=this.Ea.qb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),O=this.Ea.qb("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");n&&O?(O.wb(),n.FRj()):Q.c(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){e.a.instance.Ec(new Ta)}}Object(h.a)(Ta,"AccessibilitySettingsPackage",null,[2,3]);var Hb=d(91),oc=d(244),Oc=d(1084),Yc=d(82),Qd=d(692);class ce extends Ca.StandardDialog{constructor(n,O,ha,Aa=null){super();this.j1=this.Fr=this.wKa=null;this.Gr=[];this.Xuc=O;this.NO=n;this.lLh=ha;this.wwc=Aa;this.Klb=new Qd.a("LoadResource","LoadPrintablePdf")}uha(){this.vd=
5;this.width=40;const n=document.createElement("span");n.id=this.ki("DirectPrintHeaderContent");const O=document.createElement("span");O.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(O,"DirectPrintHeader");this.j1=document.createElement("iframe");this.j1.name="pdfObjectFrame";this.j1.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.j1.onload=Object(r.a)(this,this.Mxk,"printablePdfLoaded");if(this.wwc&&0<this.wwc.count){var ha=Yc.a.y_d(this.Xuc,this.wwc);const Aa=
Yc.a.cDe(this.Xuc,this.wwc);this.Fr=document.createElement("form");this.Fr.id="printPreviewPostForm";this.Fr.method="POST";this.Fr.target=this.j1.name;this.Fr.action=Aa;for(let La of ha)ha=document.createElement("input"),ha.type="hidden",ha.name=La.key,ha.value=La.value,this.Fr.appendChild(ha)}else this.j1.setAttribute("src",this.Xuc);Sys.UI.DomElement.addCssClass(this.j1,oc.a.Jef);this.lLh?(Sys.UI.DomElement.addCssClass(this.j1,"DirectPrintPdfObjectHidden"),O.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,
ka.a.mO(this.j1,ka.a.XJ,ka.a.yB)):(Sys.UI.DomElement.addCssClass(this.j1,"DirectPrintPdfObject"),this.Gr.push(this.j1));n.appendChild(O);n.appendChild(document.createElement("br"));n.appendChild(this.j1);this.Fr&&n.appendChild(this.Fr);n.appendChild(document.createElement("br"));n.appendChild(this.Yqi(this.Fr?"#":this.Xuc));this.Klb.start();this.NAb(CommonUIStrings.l_AppTitle,null,null,null,null,n);this.D4(this.ki("DirectPrintHeaderContent"));this.Fr&&this.Fr.submit();this.Evi();m.ULS.sendTraceTag(4771852,
328,50,"Direct Print Dialog launched.")}Yqi(n){const O=document.createElement("span");var ha=document.createElement("span");ha.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;O.appendChild(ha);v.AFrameworkApplication.fa&&(2===v.AFrameworkApplication.Ba.jb.vm&&v.AFrameworkApplication.fa.ka("PPTDisableDirectPrintDialogDownloadPDFLink")||1===v.AFrameworkApplication.Ba.jb.vm&&v.AFrameworkApplication.fa.ka("XLODisableDirectPrintDialogOpenPDFLink"))?(n=document.createElement("span"),2===
v.AFrameworkApplication.Ba.jb.vm?n.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===v.AFrameworkApplication.Ba.jb.vm&&(n.innerText=CommonUIStrings.l_InternalError_Directive,m.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.wKa=n,O.appendChild(document.createElement("br")),O.appendChild(n)):(ha=document.createElement("a"),ha.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,ha.href=n,ha.target="_blank",ha.id="PrintPDFLink",ha.className=
"AllowBrowserClick",this.wKa=ha,O.appendChild(document.createElement("br")),O.appendChild(ha),this.Fr&&Hb.a.addHandler(ha,"click",Object(r.a)(this,this.omk,"onSubmit")),this.NO.pb(ma.a.click,this.wKa,Object(r.a)(this,this.iXf,"downloadPDFLinkClicked"),null));this.Gr.push(this.wKa);return O}omk(n){this.Fr&&(this.Fr.target="_blank",this.Fr.submit());n.preventDefault()}Evi(){if(0<this.Gr.length){const n=new Oc.a(this.Gr),O=fc.FocusManager.instance().Mk();O&&(this.wKa.focus(),O.gj=n,O.CS=!0)}}iXf(){m.ULS.sendTraceTag(4585050,
328,50,"Download PDF from Direct Print dialog clicked.");return!1}l9a(){m.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}Mxk(){m.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Klb&&this.Klb.stop()}dispose(){this.wKa&&(this.NO.zb(ma.a.click,this.wKa,Object(r.a)(this,this.iXf,"downloadPDFLinkClicked")),this.wKa=null);qa.a.hO(this.j1);this.j1=null;super.dispose()}}Object(h.a)(ce,"DirectPrintDialog",Ca.StandardDialog,[1416]);class id{constructor(n){this.NO=
n}M_i(n,O){return new ce(this.NO,n,O,null)}}Object(h.a)(id,"DirectPrintDialogFactory",null,[1397]);var gb=d(1153),pc=d(63);class zc{constructor(n,O){this._url=n;this.aQh=O}LWf(){this.aQh?pc.a.downloadFile(this._url):pc.a.Qm(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(h.a)(zc,"OpenUrlInTabDialogDownloadBehavior",null,[1070,109]);var Ic=d(55);class Fc extends Ca.StandardDialog{constructor(n,O=!0,ha=!1,Aa=null,La=null,Bb=!1){super();this.Ajb=this.zjb=
this.Fr=this.U$=null;var Wb=this.wPe?this.wPe:CommonUIStrings.l_DefaultDialogTitle;Fc.btb=Bb;this.grd=Aa||new zc(n,!0);const uc=[],Vc=[];Fc.y0&&(this.Uzc&&this.Uzc.forEach(xe=>{Array.add(uc,xe)}),this.RCf&&this.RCf.forEach(xe=>{Array.add(Vc,xe)}));O?ha?(this.vd=4,this.Pe(1,this.buttonText),this.Pe(2,CommonUIStrings.l_DialogClose)):(this.vd=6,this.Pe(0,CommonUIStrings.l_DialogClose)):this.vd=5;Bb=document.createElement("span");this.vWb&&(Bb.className=this.vWb);Aa=document.createElement("a");Aa.innerText=
this.Mvb;Aa.href=n;Aa.target="_blank";Aa.id=this.r5b;Aa.className=ua.AFrame.vDf;var bd=!Ic.a.sS&&!!La&&0<La.count;if(bd){const xe=Yc.a.y_d(n,La);La=Yc.a.cDe(n,La);Aa.href="#";Aa.target="_self";this.Fr=document.createElement("form");this.Fr.id="printPreviewPostForm1";this.Fr.method="post";this.Fr.target="_blank";this.Fr.action=La;for(var xd of xe)La=document.createElement("input"),La.type="hidden",La.name=xd.key,La.value=xd.value,this.Fr.appendChild(La)}else this.Fr=null;this.Fr||Fc.btb?Fc.btb||Array.add(Vc,
{["type"]:"AppLinkProps",["id"]:this.r5b,["text"]:this.Mvb,["onExecute"]:()=>{this.B9g()}}):Array.add(Vc,{["type"]:"AppLinkProps",["id"]:this.r5b,["text"]:this.Mvb,["handler"]:{["href"]:bd?"#":n,["target"]:bd?"_self":"_blank"}});this.fla&&Array.add(uc,this.fla);ha?(n=document.createElement("span"),n.innerText=this.fla.replace("{0}",""),Bb.appendChild(n)):this.SRg?(n=document.createElement("span"),n.id=this.ki("message"),xd=document.createElement("span"),La=document.createElement("span"),bd=this.fla.split("{0}"),
xd.innerText=bd[0],La.innerText=bd[1],n.appendChild(xd),n.appendChild(Aa),n.appendChild(La),Bb.appendChild(n)):(n=document.createElement("span"),n.innerText=this.fla,Bb.appendChild(n),Bb.appendChild(document.createElement("br")),Bb.appendChild(document.createElement("br")),Bb.appendChild(Aa),Fc.btb||Array.add(uc,"{0}"));this.Fr&&Bb.appendChild(this.Fr);Fc.y0&&(this.hSa&&(this.o5b?this.kAf(this.hSa,this.o5b):(Array.add(uc,"{0}"),Array.add(Vc,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.hSa,
["onExecute"]:()=>{this.WUc()}}))),this.Lyc(uc,Vc));this.NAb(Wb,null,this.t4d,null,Object(r.a)(this,this.R1,"dialogHandler"),Fc.y0?null:Bb);this.D4(this.ki("message"));!Fc.y0&&this.o5b&&this.hSa&&(Wb=document.createElement("div"),Wb.className="WACDialogLearnMoreLinkContainer",this.U$=document.createElement("a"),this.U$.innerText=this.hSa,this.U$.href=this.o5b,this.U$.target="_blank",this.U$.id=this.ki("LearnMoreLinkId"),this.U$.className=ua.AFrame.vDf,Wb.appendChild(this.U$),O?this.sc.insertBefore(Wb,
this.sc.lastChild):this.sc.appendChild(Wb),this.D4(String.format("{0} {1}",this.ki("message"),this.ki("LearnMoreLinkId"))));this.ALb=Aa;ha?this.KQ(this.AC):this.KQ(this.ALb);this.G5b();v.AFrameworkApplication.Ba.RQ.pb(ma.a.click,this.ALb,Object(r.a)(this,this.hXf,"downloadLinkClicked"),null);this.U$&&v.AFrameworkApplication.Ba.RQ.pb(ma.a.click,this.U$,Object(r.a)(this,this.WUc,"learnMoreLinkClicked"),null);this.D_e=!1}get t4d(){return null}get wPe(){return null}get fla(){return null}get o5b(){return null}get hSa(){return null}get SRg(){return!1}get buttonText(){return CommonUIStrings.l_Open}get vWb(){return null}get Uzc(){return null}get RCf(){return null}q6(){this.Fr&&
(this.zjb||(this.zjb=Object(r.a)(this,this.oek,"onActionButtonClicked"),this.Rm.pb(ma.a.click,this.AC,this.zjb)),this.Ajb||(this.Ajb=Object(r.a)(this,this.pek,"onActionButtonKeyUp"),this.Kg.pb(ma.a.ol,this.AC,this.Ajb)));super.q6()}oek(n){this.C_f(n);return!0}pek(n){return this.uUc(n,Object(r.a)(this,this.C_f,"executeDismissActionButtonFromArgs"))}C_f(n){this.Fr&&this.Fr.submit();this.O4a(n.Hc)}l9a(){}hXf(){this.I5b();this.Fr?this.Fr.submit():this.grd.LWf();return!0}WUc(){return!1}dispose(){this.grd.dispose();
this.ALb&&(v.AFrameworkApplication.Ba.RQ.zb(ma.a.click,this.ALb,Object(r.a)(this,this.hXf,"downloadLinkClicked")),this.ALb=null);this.U$&&(v.AFrameworkApplication.Ba.RQ.zb(ma.a.click,this.U$,Object(r.a)(this,this.WUc,"learnMoreLinkClicked")),this.U$=null);this.Rm&&this.zjb&&(this.Rm.zb(ma.a.click,this.AC,this.zjb),this.zjb=null);this.Kg&&this.Ajb&&(this.Kg.zb(ma.a.ol,this.AC,this.Ajb),this.Ajb=null);super.dispose()}B9g(){this.Fr&&(document.body.appendChild(this.Fr),this.Fr.submit(),document.body.removeChild(this.Fr))}R1(n){1===
n&&(this.l9a(),this.Fr?Fc.y0&&this.B9g():this.grd.LWf());this.dispose()}static get y0(){return v.AFrameworkApplication.Ba.jb.QB&&v.AFrameworkApplication.Ba.jb.mvg}static get btb(){return Fc.V3e}static set btb(n){Fc.V3e=n}}Fc.V3e=!1;Object(h.a)(Fc,"ADialogWithLinkToResource",Ca.StandardDialog,[]);class rd extends Fc{constructor(n,O,ha=null,Aa=!0,La=!1){super(n,!0,!(rd.kZa&&Aa),new zc(n,O),ha,La);rd.kZa=rd.kZa&&Aa;if(rd.kZa){O=document.createElement("iframe");Aa=null;La=this.mEi;O.name="pdfObjectFrame";
O.id="pdfObjectIFrame";if(ha&&0<ha.count){const Bb=Yc.a.y_d(n,ha);n=Yc.a.cDe(n,ha);Aa=document.createElement("form");Aa.id="printPreviewPostForm";Aa.method="POST";Aa.target=O.name;Aa.action=n;for(let Wb of Bb)n=document.createElement("input"),n.type="hidden",n.name=Wb.key,n.value=Wb.value,Aa.appendChild(n)}else O.src=n;La.appendChild(O);Aa&&(La.appendChild(Aa),Aa.submit());Sys.UI.DomElement.addCssClass(O,"DirectPrintPdfObjectHidden");ka.a.mO(O,ka.a.XJ,ka.a.yB)}}get t4d(){return"Print_32x32x32"}get wPe(){return rd.kZa?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get fla(){return rd.kZa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get Uzc(){const n=[];Array.add(n,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Fc.btb){let O=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==v.AFrameworkApplication.Ba.jb.nTf&&(O=v.AFrameworkApplication.Ba.jb.nTf);Array.add(n,O)}return rd.kZa?n:null}get Mvb(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get r5b(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get vWb(){return v.AFrameworkApplication.qqa?
"UIFontDialogTextLarge":null}G5b(){m.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}I5b(){v.AFrameworkApplication.Yi.w7a(9540,1);m.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}l9a(){m.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get kZa(){return!!v.AFrameworkApplication.Ba&&v.AFrameworkApplication.Ba.jb.QB&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Ic.a.sS||Ic.a.rj||Ic.a.ag||Ic.a.n4b)&&!v.AFrameworkApplication.Q4b&&
v.AFrameworkApplication.fa.ka("ShouldHostDefaultToNativeBrowserPrintExperience")}static set kZa(n){}}Object(h.a)(rd,"PrintDialogWithLinkToPdf",Fc,[]);class Yd{constructor(n){this.isEnabled=Boolean.parse(n.DirectPrintIsEnabled||"false");this.lJj=Boolean.parse(n.DirectPrintProbeIsEnabled||"false");this.KFj=Boolean.parse(n.DirectPrintEnabledForInternetExplorer||"false");this.ugb=(n.DirectPrintSupportedMimeTypes||"").split(Yd.gRd);this.tYa=(n.DirectPrintSupportedPlugins||"").split(Yd.gRd);this.Lsj=(n.DirectPrintImmersivePreviewPlugins||
"").split(Yd.gRd);this.Nrg=Boolean.parse(n.DirectPrintEnabledForEdge||"false");this.vBj=Boolean.parse(n.ChromePrintLayoutFixIsEnabled||"false");this.tki=parseInt(n.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Bre=14;this.URg=14394;if(n=n.DirectPrintMinimalSupportedEdgeVersion){const O=n.split(".");2===O.length?(this.Bre=parseInt(O[0]),this.URg=parseInt(O[1])):m.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",n)}else m.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}Yd.gRd=",";Object(h.a)(Yd,"DirectPrintBrsSettings",null,[]);class me{constructor(n,O){this.yNe=n;this.tYa=O}}Object(h.a)(me,"DirectPrintProbeResults",null,[]);var Db=d(197),af=d(105);class bg{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd){this.fyc=null;this.VIh=n;this.LOb=O;this.Cxd=ha;this.yMh=Aa;this.pNh=La;this.APb=new gb.a(Object(r.a)(this,this.n8i,"getProbeResults"));this.Lqd=Bb;this.Rbf=Vc;this.uCd=Wb;this.qNh=
uc;this.DNh=bd}get eK(){return this.VIh}start(){}Zxk(){this.eK.lJj&&this.$Uj()}YAk(){const n=Array(this.eK.ugb.length);if(void 0!==this.LOb&&null!==this.LOb)for(let O=0;O<this.eK.ugb.length;O++)n[O]=this.eK.ugb[O]in this.LOb&&this.yMh(this.LOb[this.eK.ugb[O]]);return n}ZAk(){const n=Array(this.eK.tYa.length),O=!(void 0===this.Cxd||null===this.Cxd);for(let ha=0;ha<this.eK.tYa.length;ha++){const Aa=this.eK.tYa[ha];n[ha]=O&&Aa in this.Cxd?!0:this.pNh(Aa)}return n}ycj(){const n=this.YAk(),O=Array(n.length);
for(let ha=0;ha<n.length;ha++)O[ha]=n[ha]?this.EMi(this.LOb[this.eK.ugb[ha]]):null;return O}EMi(n){if(void 0===n||null===n)return null;n=n.enabledPlugin;return void 0===n||null===n?null:n.name}$Uj(){m.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.APb.value.yNe,this.APb.value.tYa)}n8i(){var n=this.ycj();const O=this.ZAk(),ha={},Aa={};for(let La=0;La<this.eK.ugb.length;La++)ha[this.eK.ugb[La]]=n[La];for(n=0;n<this.eK.tYa.length;n++)Aa[this.eK.tYa[n]]=O[n];return new me(ha,Aa)}M8k(){return this.DNh||
!this.eK.isEnabled||v.AFrameworkApplication.Q4b?!1:this.Pfl()}ioh(){if(null!=this.fyc)return this.fyc;const n=bg.Lrg(this.eK);return this.fyc=this.eK.Nrg&&n||this.sBj()}sBj(){return Ic.a.Gj&&this.eK.vBj&&Ic.a.DUb>=this.eK.tki?!0:!1}Pfl(){if(!this.qNh(this.eK))return!1;var n=af.a.J1d(this.APb.value.yNe);for(const O of n)if(void 0!==O&&null!==O)return!0;n=af.a.J1d(this.APb.value.tYa);for(const O of n)if(O)return!0;return!1}Coj(){const n=af.a.J1d(this.APb.value.yNe);for(const O of n)if(Db.a.contains(this.eK.Lsj,
O))return!0;return!1}kph(n){v.AFrameworkApplication.Ba&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")?this.Rbf(n,null):this.M8k()?this.rFi(n,this.Coj()&&!0):this.Rbf(n,null)}rFi(n,O){const ha=this.uCd.wi("UserAction","OpenDirectPrintDialog");this.Lqd.M_i(n,O).uha();ha.stop()}static QLj(n){try{return new ActiveXObject(n),!0}catch(O){m.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",n)}return!1}static vDj(n){return void 0===n||null===
n?!1:!(void 0===n.enabledPlugin||null===n.enabledPlugin)}static create(n){const O=new Yd(v.AFrameworkApplication.fa.appSettings);let ha=null;try{ha=window.navigator.mimeTypes}catch(bd){m.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let Aa=null;try{Aa=window.navigator.plugins}catch(bd){m.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const La=bg.vDj,Bb=bg.QLj;n=n.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const Wb=v.AFrameworkApplication.Ba.aU,
uc=bg.RLj,Vc=!!v.AFrameworkApplication.Ba&&v.AFrameworkApplication.Ba.jb.QB&&!v.AFrameworkApplication.fa.ka("PrintDialogFallbackLinkEnabled");return new bg(O,ha,Aa,La,Bb,n,Wb,uc,(bd,xd)=>new rd(bd,!1,xd,!0,Vc),v.AFrameworkApplication.isEmbedded)}static RLj(n){return Ic.a.Gj||Ic.a.rj&&n.KFj||n.Nrg&&bg.Lrg(n)?!0:!1}static Lrg(n){var O=Ic.a.xOa;if(O){var ha=O.split(".");if(2===ha.length)return O=parseInt(ha[0]),ha=parseInt(ha[1]),O>n.Bre||O===n.Bre&&ha>=n.URg}return!1}}Object(h.a)(bg,"DirectPrintManager",
null,[1368]);class Qe{constructor(){this.j_e=this.Ea=null}get name(){return"Common.App.DirectPrint"}Yb(n){this.Ea=n;n.register(id,"Common.App.DirectPrint.DirectPrintDialogFactory").ma().na(()=>new id(v.AFrameworkApplication.Ba.RQ));n.register(1368,"Common.App.DirectPrint.IDirectPrintManager").ma().na(()=>bg.create(this.Ea))}init(){this.j_e=this.Ea.resolve("Common.App.DirectPrint.IDirectPrintManager");this.j_e.start()}dispose(){}}Object(h.a)(Qe,"PackageManager",null,[2,3]);var Af=d(1085),tf=d(298);
class uf{constructor(n,O){this.SLb=null;this.Da=n;this.mb=O}wb(){(this.SLb=this.mb.Ia("StatusBarEnvironmentNameToUse"))&&""!==this.SLb&&this.Da.ra(G.a.V6g,H.a.frame,Object(r.a)(this,this.zrl,"updateEnvironmentName"),96)}zrl(n,O,ha,Aa,La){if(1===ha)return 32;La[Af.a.Value]=this.SLb;La[tf.a.labelText]=this.SLb;La[Af.a.Visible]=!0;return 32}}Object(h.a)(uf,"DisplayEnvironmentName",null,[]);class kg{constructor(){this.Ea=null}get name(){return"Common.App.DisplayEnvironmentName"}Yb(n){this.Ea=n;this.Ea.register(uf,
"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ma().na(()=>new uf(v.AFrameworkApplication.Va,v.AFrameworkApplication.fa))}init(){this.Ea.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").wb()}dispose(){}static main(){e.a.instance.Ec(new kg)}}Object(h.a)(kg,"DisplayEnvironmentNamePackage",null,[2,3]);var Lg=d(169),$g=d(540);class yf extends $g.a{constructor(n){super(n)}get PVb(){return!1}createElement(){const n=document.createElement("link");n.setAttribute("rel","stylesheet");
n.setAttribute("type","text/css");n.setAttribute("href",this.Ls);return n}OEc(){return null}rhc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.HL.Ls)}}Object(h.a)(yf,"CssResource",$g.a,[]);var Kf=d(280),dd=d(2);class lg{constructor(){this.jvc=this.hrc=null}CRj(){this.hrc||(m.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.hrc=dd.Task.WAA(lg.LRj(),lg.sRj()),this.hrc.continueWith(n=>{m.ULS.sendTraceTag(21030599,324,10,"{0}",ib.a.qYd(n.Ti))},
5));return this.hrc}DRj(){if(!this.jvc)try{m.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.jvc=dd.Task.WAA(lg.USd(Kf.a.create(v.AFrameworkApplication.fa.Ia("DimeUrl"),null,null))),this.jvc.continueWith(n=>{m.ULS.sendTraceTag(39978391,324,10,"{0}",ib.a.qYd(n.Ti))},5)}catch(n){m.ULS.sendTraceTag(594874951,324,10,"{0}",ib.a.qYd(n))}return this.jvc}static LRj(){var n=lg.DNc("inproductmessaging.js");n=Kf.a.create(n,null,null);return lg.USd(n)}static sRj(){var n=
lg.DNc("inproductmessaging.css");n=new yf(n);return lg.USd(n)}static DNc(n){return Lg.a.lVb(String.format("ipm/{0}",n))}static USd(n){cc.a.nt(n);return n.R7}}Object(h.a)(lg,"DependencyDownloader",null,[1376]);class Wh{}Wh.Tok="inProductMessagingOverlayDiv";Wh.Qsk="PlayButtonImage";Wh.EPk="ReplayButtonImage";Object(h.a)(Wh,"Constants",null,[]);class Gd{constructor(){this.ouf=this.Ddf=this.XVe=!0;this.FPk=this.Rsk=null;this.Fbk=!1;this.locale=null;this.hyh={}}get autoPlay(){return this.XVe}set autoPlay(n){this.XVe=
n}get pSg(){return this.Ddf}set pSg(n){this.Ddf=n}get bph(){return this.ouf}set bph(n){(this.ouf=n)&&this.y1k()}y1k(){this.DBf(Wh.Qsk,this.Rsk);this.DBf(Wh.EPk,this.FPk)}DBf(n,O){O&&(this.hyh[n]=O)}}Object(h.a)(Gd,"FirstRunExperienceUISettings",null,[1374]);class Se{constructor(){this.completed=this.wKk=!1}}Object(h.a)(Se,"FirstRunExperienceViewData",null,[1377]);var hj=d(176);class cg{constructor(n,O,ha){this.Da=n;this.Mh=O;this.bsc=ha}wb(){this.Da.ra(G.a.LQi,H.a.frame,Object(r.a)(this,this.KQi,
"firstRunExperienceHandler"),64);this.Da.ya(G.a.Y2f,H.a.frame,Object(r.a)(this,this.Ssj,"inProductMessagingTabHandler"));this.Da.ya(G.a.X2f,H.a.frame,Object(r.a)(this,this.Rsj,"inProductMessagingShiftTabHandler"));this.Da.ya(G.a.JEi,H.a.frame,Object(r.a)(this,this.KEi,"dimeLaunchHandler"));this.Da.ya(G.a.edh,H.a.frame,hj.ActionManager.Dg);this.Da.ya(G.a.XPk,H.a.frame,hj.ActionManager.Dg);this.Da.ya(G.a.YPk,H.a.frame,hj.ActionManager.Dg);this.Mh&&this.Mh.updateCommandUI()}KQi(n,O,ha,Aa,La){2===ha&&
this.bsc.JPj(La);return 32}KEi(n,O,ha,Aa,La){2===ha&&this.bsc.IPj(La);return 32}Ssj(n,O,ha){return 2===ha?this.bsc.ase():32}Rsj(n,O,ha){return 2===ha?this.bsc.Ure():32}}Object(h.a)(cg,"InProductMessagingActor",null,[]);class ed{constructor(){this.tah=this.x4=this.buh=this.TUc=this.instance=null}}Object(h.a)(ed,"DimeExperienceUISettings",null,[]);var Xg=d(515);class Dh{constructor(n,O,ha,Aa,La){this.PJc=!1;this.gXb=null;this.Da=n;this.$1a=O;this.Svc=ha;this.n5=Aa;this.afa=La}svj(n){sc.b("getHeaderApi")?
n.isFeatureEnabled("MsoPremiumBadge",!0).then(O=>{const ha=n.isFreemiumUpsellEnabled();ha&&(appChrome.getHeaderApi().then(Aa=>{Aa.updatePremiumStatus(O,ha);return null}),n.Xdb("MsoPremiumBadge",Aa=>{appChrome.getHeaderApi().then(La=>{La.updatePremiumStatus(Aa.isEnabled,ha);return null})}));return null}):m.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}JPj(n){this.Svc.CRj().continueWith(()=>{this.$1a.Mal(n)})}IPj(n){let O="gopremium",ha=null,Aa=()=>{};n?(n.experience&&""!==Object(M.a)(String,
n.experience)&&(O=Object(M.a)(String,n.experience)),n.onTaskComplete&&(Aa=n.onTaskComplete),n.campaignId&&""!==Object(M.a)(String,n.campaignId)&&(ha=Object(M.a)(String,n.campaignId))):m.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.Ayg(O,Aa,ha)}Ayg(n,O,ha=null){if(this.PJc&&this.gXb){const Aa={};Aa.experience=n||"gopremium";Aa.campaignId=ha||Xg.b(this.n5,this.afa,Object(M.a)(String,Aa.experience),!0);this.Da.processAction(G.a.edh,2);m.ULS.sendTraceTag(51675403,
324,50,"Launching Freemium Upsell dialog: "+Aa.experience);try{const La=Object.assign(new ed,{instance:this.gXb,TUc:Aa,buh:O||(()=>{}),x4:Bb=>{m.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+Bb.status)},tah:()=>{m.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.PJc=!1;this.gXb=null}});this.$1a.b$k(La)}catch(La){m.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+La.message),this.PJc=!1,this.gXb=null,this.Da.Ma(G.a.QJc,2,{["experience"]:Aa.experience})}}else m.ULS.sendTraceTag(39978392,
324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Da.Ma(G.a.QJc,2,{["experience"]:n})}ERj(){this.Svc.DRj().continueWith(()=>{try{var n=ib.a.vg(v.AFrameworkApplication.uiCulture);const Aa=Xg.c(this.n5);if(Aa){var O={};O.partnerId=Aa;O.language=n;O.sessionId=v.AFrameworkApplication.userSessionId;O.authHint=v.AFrameworkApplication.fa.Ia("UserPrincipalName");var ha=v.AFrameworkApplication.fa.Ia("Puid")||"";""!==ha&&(n={},n.puid=ha,O.userInfo=n);this.gXb=new Dime(O);this.PJc=!0;m.ULS.sendTraceTag(592721856,
324,50,"Dime initialized")}else m.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Aa){m.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Aa.message)}},3)}ase(){return this.$1a.ase()}Ure(){return this.$1a.Ure()}}Object(h.a)(Dh,"InProductMessagingUIManager",null,[1375]);class Qf{constructor(){this.Ywf=0;this.okb=Array(5);this.okb[0]=10;this.okb[1]=15;this.okb[2]=50;this.okb[3]=100;this.okb[4]=200}Init(n){this.Ywf=n}SendTrace(n,O){m.ULS.sendTraceTag(34182235,this.Ywf,
this.okb[n],"{0}",O)}}Object(h.a)(Qf,"DefaultNetworkingManager",null,[1396]);var Yb=d(196);class li{constructor(n){this.Kd=n}Mal(n){n&&(InProductMessaging.Networking.NetworkingMgr=new Qf,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(n.bph,n.pSg,n.autoPlay,n.Fbk,n.locale,Object(r.a)(this,this.Qgk,"onDismissFirstRunExperience"),n.hyh),this.E4(Wh.Tok,!0))}b$k(n){if(n&&n.instance&&n.TUc){let O=document.getElementById("wacDimeContainer");O||(O=document.createElement("div"),
O.id="wacDimeContainer",document.body.appendChild(O));v.AFrameworkApplication.fa.ka("DimeFocusManagerIsEnabled")&&this.E4("wacDimeContainer",!1);n.TUc.parentElementId="wacDimeContainer";n.instance.launch(n.TUc,n.buh).then(ha=>{this.fma();document.body.removeChild(O);n.x4(ha)}).catch(ha=>{this.fma();document.body.removeChild(O);n.tah(ha)})}else throw Error.argument("DimeExperienceUISettings");}E4(n,O){if(this.Kd&&n&&(n=document.getElementById(n),this.ivj(n),n=this.Kd.AP("InProductMessagingFocusId"))){const ha=
this.Kd.ye;ha&&"InProductMessagingFocusId"===ha.name||this.Kd.hX("InProductMessagingFocusId",!1);O&&this.VBe(n.scope)}}ivj(n){var O=this.Kd.Bc("InProductMessagingFocusId");O.parent=ua.AFrame.VC;const ha=new Yb.DOMFocusListing(()=>n);ha.aeb=!1;ha.ho(3);ha.ho(2);ha.ho(4);O=this.Kd.Sga(()=>n,O,ha);O.beb();O.CS=!0;O.GNa=!0}VBe(n){n.Wo(fc.FocusManager.instance().Roa);n.Wo(fc.FocusManager.instance().Soa);n.bindAction(fc.FocusManager.instance().Roa,G.a.Y2f);n.bindAction(fc.FocusManager.instance().Soa,G.a.X2f)}fma(){this.Kd&&
(this.Kd.n4("InProductMessagingFocusId"),this.Kd.kEb("InProductMessagingFocusId"))}Qgk(n,O){this.fma();n=Object.assign(new Se,{completed:n,wKk:O});v.AFrameworkApplication.Va.Ma(G.a.JQi,2,n)}ase(){const n=document.activeElement,O=this.Kd.Mk();return n&&O&&O.gj&&n===O.gj.Cvb?(O.gj.aE(n),O.ZAb()?32:8):4}Ure(){const n=document.activeElement,O=this.Kd.Mk();return n&&O&&O.gj&&n===O.gj.Jha?(O.gj.aE(n),O.XAb()?32:8):4}}Object(h.a)(li,"InProductMessagingUIWrapper",null,[1373]);class re{constructor(){this.Ea=
null}get name(){return"Common.App.InProductMessaging"}Yb(n){n.register(lg,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").ma().na(()=>new lg);n.register(li,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").ma().na(()=>new li(fc.FocusManager.instance()));n.register(Dh,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").ma().na(()=>new Dh(v.AFrameworkApplication.Va,
n.resolve("Common.IInProductMessagingUIWrapper"),n.resolve("Common.App.InProductMessaging.IDependencyDownloader"),v.AFrameworkApplication.Ba.jb.vm,v.AFrameworkApplication.Ba.jb.vGa));n.register(cg,"Common.App.InProductMessaging.InProductMessagingActor").ma().na(()=>new cg(v.AFrameworkApplication.Va,v.AFrameworkApplication.Ba,n.resolve("Common.IInProductMessagingUIManager")));n.register(Gd,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").ma().na(()=>
new Gd);n.register(Se,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").ma().na(()=>new Se);this.Ea=n}init(){this.Ea.resolve("Common.App.InProductMessaging.InProductMessagingActor").wb();v.AFrameworkApplication.fa.gf(()=>{v.AFrameworkApplication.Ba.jb.kN&&Jc.a.get_instance().Ak(15,()=>{this.Ea.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>{this.Ea.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").svj(n)})});
v.AFrameworkApplication.fa.ka("FreemiumUpsellShowDialogIsEnabled")&&Xg.a()&&!Ic.a.Fw&&1!==v.AFrameworkApplication.Ba.jb.vm&&this.Ea.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>{n.isFeatureEnabled("MsoPremiumBadge",!0).then(O=>{!O&&n.isFreemiumUpsellEnabled()&&this.Ea.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").ERj();return null})})})}dispose(){}static main(){e.a.instance.Ec(new re)}}Object(h.a)(re,"InProductMessagingPackage",null,[2,3]);
var lf=d(378),Id=d(552);class We{static SIi(n){return We.sIf("New",n)}static TIi(n){return We.sIf("Open",n)}static bIf(n,O){return We.f3a("LoadingMenuSection",We.ySj,n,We.MTb("lblLoading",O))}static NTb(n,O,ha=null,Aa=null){return We.f3a("MessageMenuSection",We.TSg,O,We.MTb("lblMessage",n,ha,Aa))}static Zci(n){return We.bIf(n,CommonUIStrings.l_VoicedLoadingText)}static $ci(n,O){return We.NTb(CommonUIStrings.l_NewCreationLocationMessage,n.labelText,O.AQ,O.BIa)}static Yci(n,O){return We.NTb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,
O.BIa,"\n\n"),n.labelText)}static dIf(n){return We.NTb(CommonUIStrings.l_NewGenericErrorMessage,n.labelText)}static Wci(n,O,ha){return We.f3a("menuNewBlank",We.Dpj,ha?n.labelText:null,We.ITb(n.Kig,n.Lig,n.Mig,null,n.wCa,n.a2b,O,"blank"))}static Idi(){return We.MTb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static pIf(){return We.MTb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static Jdi(n,O){return We.f3a("menuNewTemplates",n,null,O)}static Uci(n,O){return We.f3a("menuNewMoreTemplates",
We.T3f,null,We.ITb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,n,O))}static Zbi(n,O,ha){let Aa="";ha&&O&&(Aa=We.f3a("BrowseMoreMenuSection",We.T3f,null,We.ITb("btnBrowseMore",O,O,null,null,null,n||"1959943459",ha)));return Aa}static MTb(n,O,ha=null,Aa=null){let La=Aa;O&&0<O.length&&(La=We.wTg.VGa(O).trimEnd(),La=0<=La.indexOf("{0}")?String.format(La,Aa):String.format("{0} {1}",La,Aa));ha=ha&&Aa?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',
ib.a.le(ha),ib.a.le(Aa),ib.a.le(La)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',ib.a.le(n||""),We.wTg.VGa(ib.a.le(O||"")),ha)}static ITb(n,O,ha,Aa,La,Bb,Wb,uc){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',ib.a.le(n||""),ib.a.le(O||
""),ib.a.le(ha||""),Aa||"32by32",ib.a.le(La||""),ib.a.le(Bb||""),Wb,ib.a.le(uc||""))}static sIf(n,O){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',n,O)}static f3a(n,O,ha,Aa){ha=ha?String.format('Title="{0}"',ib.a.le(ha)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
ib.a.le(n||""),ib.a.le(O||""),ha,Aa)}}We.TSg="MenuMru";We.ySj="MenuLoading";We.Dpj="MenuHeader";We.T3f="MenuFooter";We.wTg=Id.a.yw("\n","&#10;");Object(h.a)(We,"NewAndOpenXmlUtilities",null,[]);var Wc=d(95);class Xc{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(h.a)(Xc,"HostInformation",null,[]);var Ld=d(170),Xf=d(125),Le=d(426),md=d(516);class oj{constructor(n,O,ha,Aa,La,Bb){this.fDd=this.Nn=this.Zoc=null;this.Nwc=this.XBd=!1;this.kdf=0;this.JBd=this.$ud=!1;
this.Pfa=n;this.gMb=O;this.wfa=new gb.a(()=>new lf.a(ha.value,Object(r.a)(this,this.WBa,"getMoreInfoEventReceived")));this.fPh=Aa;this.tLa=La;this.PTh=Bb;this.DQb=this.Xgd;2===this.PW.Kua&&(this.JBd=!0)}get u1(){switch(this.PW.Kua){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}wb(){const n=this.PW.lBb;n.ya(G.a.newDocument,H.a.frame,Object(r.a)(this,this.newDocument,"newDocument"));n.ra(G.a.eye,H.a.frame,Object(r.a)(this,this.eye,"populateNewMenu"),
96)}newDocument(n,O,ha,Aa,La){return 1===ha?32:2===ha&&La&&La.MenuItemId&&La.SourceControlId?this.$3a(La.MenuItemId,La.SourceControlId):8}$3a(n,O){var ha=this.z5c.OOd;if(null===ha)return 8;var Aa=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(v.AFrameworkApplication.R8a&&Aa){m.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const La={};La[Ld.a.tuh]=n;La[Ld.a.u1]=this.u1;La[Ld.a.lcid]=v.AFrameworkApplication.lcid.toString();
La[Ld.a.reason]=Le.a.cxi;v.AFrameworkApplication.tV().execute(Bb=>{Bb.sendMessage(Xf.a.$3a,La)})}else Aa=(new Date).getTime(),O=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",ha,ib.a.Me(this.Lua),ib.a.Me(n),ib.a.Me(this.u1),ib.a.Me(v.AFrameworkApplication.lcid.toString()),ib.a.Me(Aa.toString()),ib.a.Me(O),ib.a.Me(v.AFrameworkApplication.canary),v.AFrameworkApplication.$g),(ha=v.AFrameworkApplication.fa.Ia("ScenarioId"))&&
""!==ha&&(O+="&wdscenarioid="+ib.a.Me(ha)),O+="&"+v.AFrameworkApplication.fQa(),v.AFrameworkApplication.xRa&&(O+="&"+v.AFrameworkApplication.dMc()),(ha=this.Nn?this.Nn.AQ:null)&&(O+="&DestinationUrl="+ib.a.Me(ha)),pc.a.Qm(O,"_blank",void 0,"CreateNewDocument");2===this.PW.Kua&&m.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:md.a[this.PW.Kua],["Template"]:n});return 32}RVj(n){let O=Number.MAX_VALUE,ha=Number.MIN_VALUE;const Aa=window.performance;if(Aa&&"undefined"!==
typeof Aa.getEntriesByName){for(let Bb=0;Bb<n.length;Bb++){var La=Aa.getEntriesByName(n[Bb]);La&&0<La.length&&(La=La[0],O=Math.min(parseInt(String(La.fetchStart)),O),ha=Math.max(parseInt(String(La.responseEnd)),ha))}ha>O&&m.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:ha-O,["MinFetchStart"]:O,["MaxResponseEnd"]:ha})}}eye(n,O,ha,Aa,La){if(1===ha)return this.JBd&&(v.AFrameworkApplication.oN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.JBd=!1),32;2!==ha||this.$ud||(this.kdf=(new Date).getTime(),m.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Xgd,["CachedNewMenuXmlExists"]:!!this.Zoc,["ShouldCallGetMoreInfo"]:this.PW.EIa}));return this.Wtk(La)}Wtk(n){n&&(this.Zoc?n.PopulationXML=this.Zoc:(this.PW.EIa&&!this.Nn&&this.hck.zba("Opened New menu",!0),n.PopulationXML=this.ZUi(this.getTemplateListJson())));return 32}pvg(){return!this.PW.EIa||!!this.Nn&&3===this.Nn.state&&!!this.Nn.BIa&&
!!this.Nn.AQ}EJj(){return v.AFrameworkApplication.Ba&&v.AFrameworkApplication.Ba.jb.qDa?!0:this.pvg()}getTemplateListJson(){if(!this.Xgd||!this.EJj())return null;if(this.DQb&&!this.Nwc){var n="9";const O=v.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in O&&(n=O.NumberOfTemplatesInBackstage);let ha=this.u1;"TemplateCollectionId"in O&&(ha=O.TemplateCollectionId);n=String.format(this.PW.tda+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",ib.a.Me(v.AFrameworkApplication.lcid.toString()),
ib.a.Me(ha),n);Boolean.parse(O.AppendOriginQueryParam||"false")&&(n+="&org=backstage");n+="&"+v.AFrameworkApplication.fQa();v.AFrameworkApplication.xRa&&(n+="&"+v.AFrameworkApplication.dMc());this.PW.dcc.Jj(n,1,null,null,!1,2,Aa=>{this.PW.Dsa("CreateNewActor.GetTemplateListJson",Aa.data);this.oil(Aa.data.je)},Aa=>{this.PW.Dsa("CreateNewActor.GetTemplateListJson",Aa.data);this.mil()},null,void 0,void 0,void 0,void 0,"5");this.DQb=!1}return this.fDd}oil(n){this.fDd=n;this.DQb=!1;this.hhc();if(v.AFrameworkApplication.Ba&&
v.AFrameworkApplication.Ba.jb.qDa&&sc.c()){n=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const O=v.AFrameworkApplication.R8a;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.fDd,!0,n&&O))}}mil(){this.Nwc=this.DQb=!0;this.hhc();v.AFrameworkApplication.Ba&&v.AFrameworkApplication.Ba.jb.qDa&&sc.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));Wc.Health.instance.recordQosError("TemplateServiceReturnedFailure",
["TemplateServiceFailed"],!1,!0,!0,!1,null)}Jdj(n){var O=0;for(var ha=0;ha<n.length;ha++)if("ST"===n[ha].ImageType){O=ha;break}const Aa=n.length?n[O]:null;n=Aa?Aa.Url||"":"";var La;let Bb=ha=O=!1;if(Aa&&(La=Aa.AspectRatio))La=parseFloat(La),1>La?O=!0:1.5<La?ha=!0:1===La&&(Bb=!0);else switch(m.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:n}),this.PW.Kua){case 3:O=!0;break;case 2:ha=!0;break;case 5:Bb=!0}return{returnValue:n,OP:O?"95by123":ha?"123by69":Bb?"100by100":
"123by95"}}ZUi(n){const O=({Kgd:n}=this.Xci(n,this.z5c,this.z5c.STb||"1056925771")).returnValue;n&&(this.Zoc=O,m.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:(new Date).getTime()-this.kdf}));return O}WBa(n,O){m.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Nn||3!==n.state?2===n.state&&(m.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.XBd=!0,this.hhc()):(this.Nn=n,O||
this.hhc(),v.AFrameworkApplication.Ba&&v.AFrameworkApplication.Ba.jb.qDa&&sc.c()&&sc.d("setFileMenuHostInformation")&&(n=Object.assign(new Xc,{hostUrl:this.Nn.AQ,hostName:this.Nn.BIa,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,folderName:v.AFrameworkApplication.breadcrumbFolderName}),m.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(n))))}Xci(n,O,ha){let Aa;Aa=!1;const La=this.pvg();let Bb="";this.PW.EIa&&
(this.XBd?(Bb=We.dIf(O),this.XBd=!1,m.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Nn?La?Bb=We.$ci(O,this.Nn):this.Nn.fyj?(Aa=!0,this.DQb=!1,Bb=We.Yci(O,this.Nn),m.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Aa=!0,Bb=We.dIf(O),m.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Nn.AQ,
["StorageServiceDisplayNameIsSet"]:!!this.Nn.BIa})):(Bb=We.Zci(O.labelText),m.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));La&&(Bb+=We.Wci(O,ha,!Bb)+({Kgd:Aa}=this.Hdi(n,ha)).returnValue);return{returnValue:We.SIi(Bb),Kgd:Aa}}Hdi(n,O){let ha;ha=!1;if(!this.Xgd)return ha=!0,m.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Kgd:ha};let Aa="",La="",Bb="MenuTemplate";if(this.Nwc)Aa=We.pIf(),this.Nwc=!1,m.ULS.sendTraceTag(5849610,
202,10,"Rendering File>New with template error message");else if(n){try{const Wb=Sys.Serialization.JavaScriptSerializer.deserialize(n,!0);Aa=this.Gdi(Wb,O);m.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");v.AFrameworkApplication.yTg&&"OneDrive"===this.Lua&&(La=We.Uci(this.ick,v.AFrameworkApplication.yTg))}catch(Wb){m.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:n}),Aa=We.pIf()}ha=!0}else Bb="MenuLoading",
Aa=We.Idi(),m.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:We.Jdi(Bb,Aa)+La,Kgd:ha}}Gdi(n,O){let ha="";const Aa=[];for(let Bb=0;Bb<n.length;Bb++){var La=n[Bb];let Wb="";if(La){const uc=La.Title,Vc=La.AssetId;La=La.Thumbnails;Vc&&uc&&La&&({OP:La,returnValue:Wb}=this.Jdj(La),ha+=We.ITb("jbtnNewTemplate"+Bb,uc,null,La,null,Wb,O,Vc))}Aa[Bb]=Wb}n=new Y.a(4,1,5E3,()=>{this.RVj(Aa)},106);this.PW.x5c.Hb(n);return ha}hhc(){this.$ud=!0;this.PW.tTg.x0(this.z5c.kZb);
this.$ud=!1}get PW(){return this.Pfa.value}get z5c(){return this.gMb.value}get hck(){return this.wfa.value}get ick(){return this.fPh.value}get Lua(){return this.tLa.value}get Xgd(){return this.PTh.value}}Object(h.a)(oj,"CreateNewActor",null,[]);class Ie{constructor(){this._initialized=!1;this.BCd={}}pa(n){this.SZf();return this.get(n)}contains(n){this.SZf();return n.toString()in this.BCd}SZf(){this._initialized||(this.f0h(),this._initialized=!0)}zmb(n,O){this.BCd[n.toString()]=O}get(n){return this.BCd[n.toString()]}}
Object(h.a)(Ie,"AIntlHelper",null,[]);class qh extends Ie{constructor(){super()}f0h(){this.zmb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.zmb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.zmb(2,CommonUIStrings.l_Open);this.zmb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.zmb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.zmb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return qh.Ka||(qh.Ka=new qh)}static Wnk(n){return qh.instance.pa(n)}}qh.Ka=null;Object(h.a)(qh,"MruActorIntlHelper",
Ie,[]);var Od;(function(n){n[n.success=0]="success";n[n.failure=1]="failure";n[n.spinner=2]="spinner";n[n.none=3]="none"})(Od||(Od={}));Object(h.b)("DisplayState",Od);var ef=d(33);class dh{constructor(n,O,ha,Aa,La,Bb,Wb,uc){this.dpd=null;this.wEd=!0;this.Yoc="";this.EVh=0;this.nkb=null;this.Xvd=3;this.mb=uc;this.Pfa=n;this.jaa=O;this.cKh=ha;this.JGh=Aa;this.IGh=La;this.wfa=new gb.a(()=>new lf.a(Bb.value,null));this.MKh=new gb.a(()=>new lf.a(Wb.value,Object(r.a)(this,this.xbk,"mruEventResultReceived")));
this.mb.ka("WacInTabOpenMRUIsEnabledForUiHost");this.mb.ka("UiHostSupportsDocRebootFeatures")}xbk(n,O){this.nkb=n;O||this.H$g()}FJk(){this.qF.lBb.ra(G.a.dye,H.a.frame,Object(r.a)(this,this.dye,"populateMruMenu"),96)}dye(n,O,ha,Aa,La){return 1!==ha&&La?this.Vtk(La):32}Vtk(n){this.uJi();this.tJi();n.PopulationXML=We.TIi(this.Yoc+this.dpd);return 32}uJi(){var n=3;let O=!1;if(this.Yoc&&this.EVh===this.nkb.Jjl)m.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",
{["CacheRefresh"]:"Not Dirty"}),n=this.Xvd;else{m.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var ha=this.qF.LE();this.nkb=this.wbk.zba("File Open opened",!0);this.Yoc&&2!==this.Xvd&&3!==this.nkb.state?O=!0:(n=this.Q$i(this.nkb),v.AFrameworkApplication.Ba&&v.AFrameworkApplication.Ba.jb.qDa&&sc.c()&&n&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(n,!0)),this.Yoc=({Zbk:n}=this.$Ui(this.nkb)).returnValue);ha=this.qF.LE()-
ha;m.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:ha})}2!==n&&(ha={["DisplayState"]:Od[n]},1!==n&&(ha.IsStale=O),m.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",ha));this.Xvd=n}Q$i(n){let O;try{O=ef.c(n.pse)}catch(ha){O=null,m.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",ha)}return O}tJi(){this.wEd?(m.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),
this.dpd=({Cxl:this.wEd}=this.C8j()).returnValue):m.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");m.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.wEd,["NotDisplayingLink"]:!this.dpd})}$Ui(n){let O;1===n.state||0===n.state?(m.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),n=2,O=We.bIf(this.hCa(2),this.hCa(5))):3===n.state&&n.pse?(O=this.Vci(n.pse),n=0):(m.ULS.sendTraceTag(5849634,
202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),O=We.NTb(this.hCa(1),this.hCa(2)),n=1);return{returnValue:O,Zbk:n}}Vci(n){let O;const ha=this.xbc.STb||"2155708348";if(n.length){O=We.MTb("lblRecentDocuments",this.hCa(3));let Aa=0;for(let La=0;La<n.length;La++){const Bb=n[La];"FileName"in Bb&&"DocumentUrl"in Bb&&"Path"in Bb&&(O+=We.ITb("MruButton"+La,Bb.FileName.toString(),Bb.Path.toString(),null,this.xbc.wCa,this.xbc.a2b,ha,Bb.DocumentUrl.toString()),Bb.IsPinned&&Aa++)}O=We.f3a("RecentDocumentsMenuSection",
We.TSg,this.hCa(2),O);m.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:n.length,["NumPinnedDocuments"]:Aa})}else O=We.NTb(this.hCa(0),this.hCa(2)),m.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return O}C8j(){let n;n=!0;let O=this.sbi;var ha=this.rbi;if(O&&ha||!this.qF.EIa)n=!1;else{const Aa=this.hMc.zba("File Open",!1);3===Aa.state&&(O=Aa.AQ,ha=Aa.BIa,n=!1)}ha=ha?String.format(this.hCa(4),ha):null;return{returnValue:We.Zbi(this.xbc.STb,
ha,O),Cxl:n}}H$g(){this.qF.tTg.x0(this.xbc.kZb)}get qF(){return this.Pfa.value}get hCa(){return this.jaa.value}get xbc(){return this.cKh.value}get sbi(){return this.JGh.value}get rbi(){return this.IGh.value}get hMc(){return this.wfa.value}get wbk(){return this.MKh.value}}Object(h.a)(dh,"MruRenderer",null,[]);var ad=d(180),Fg=d(437);class Cd{constructor(n,O,ha,Aa,La,Bb,Wb){this.Nn=null;this.Rsf=!1;this.zKa=this.FWe=0;this.qPh=n;this.Bkb=O;this.duc=ha;this.gMb=Aa;this.tLa=La;this.Pfa=Bb;this.wfa=new gb.a(()=>
new lf.a(Wb.value,Object(r.a)(this,this.WBa,"getMoreInfoEventReceived")))}$3a(){!this.Nn&&this.Dse.EIa?this.hMc.zba("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}WBa(n){if(!this.Nn&&3===n.state)this.Nn=n;else if(2===n.state){this.Rsf?m.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.hMc.zba("NewDocumentFromStream",!0),this.Rsf=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.FWe=(new Date).getTime();var n=this.JOi.OOd;
if(null===n)this.Bkb(null);else{var O=this.duc.menuItemId,ha=this.duc.OT,Aa=this.duc.ffl,La=this.duc.QOi;this.zKa="streamBase64"===Aa?La.length/1024:0;m.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.u1,this.zKa);var Bb=(new Date).getTime();n=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",n,ib.a.Me(this.Lua),ib.a.Me(O),ib.a.Me(this.u1),ib.a.Me(v.AFrameworkApplication.lcid.toString()),ib.a.Me(Bb.toString()),
ib.a.Me(ha),ib.a.Me(v.AFrameworkApplication.canary),v.AFrameworkApplication.$g,ib.a.Me(Aa));n+="&"+v.AFrameworkApplication.fQa();v.AFrameworkApplication.xRa&&(n+="&"+v.AFrameworkApplication.dMc());(O=this.Nn?this.Nn.AQ:null)&&(n+="&DestinationUrl="+ib.a.Me(O));this.Dse.dcc.Jj(n,2,La,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(r.a)(this,this.bck,"newDocumentFromStreamSuccessHandler"),Object(r.a)(this,this.ack,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,
"31")}}bck(n){if(n&&n.data&&n.data.je){var O;({Ev:O}=ef.d(n.data.je)).returnValue?(n=O,n.StatusCode!==ad.a.Xy&&n.StatusCode!==ad.a.sWb?(m.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.u1,this.zKa,n.StatusCode),this.Bkb(null)):n.NewDocumentUrl&&""!==n.NewDocumentUrl?(m.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.u1,this.zKa,(new Date).getTime()-this.FWe),this.qPh(n.NewDocumentUrl)):
(m.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.u1,this.zKa),this.Bkb(null))):(m.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.u1,this.zKa,{["ResponseData"]:Fg.a.Emc(n.data.je)}),this.Bkb(null))}else m.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.u1,this.zKa),this.Bkb(null)}ack(n){n&&n.data&&m.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.u1,this.zKa,n.data.status);this.Bkb(null)}get u1(){switch(this.Dse.Kua){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get JOi(){return this.gMb.value}get Lua(){return this.tLa.value}get Dse(){return this.Pfa.value}get hMc(){return this.wfa.value}}Object(h.a)(Cd,
"NewDocumentFromStreamOperation",null,[]);class zg{constructor(n,O,ha,Aa){this.gMb=n;this.tLa=O;this.Pfa=ha;this.LKh=Aa}create(n,O,ha){return new Cd(n,O,ha,this.gMb,this.tLa,this.Pfa,this.LKh)}}Object(h.a)(zg,"NewDocumentFromStreamOperationFactory",null,[1023]);var Eh=d(286);class eh{get name(){return"Common.App.NewAndOpen.UX"}Yb(n){n.register(zg,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ma().na(()=>new zg(new gb.a(()=>
v.AFrameworkApplication.Ba.jb.yYd()),new gb.a(()=>v.AFrameworkApplication.Lua),new gb.a(()=>n.qb("Common.INewAndOpenCommonHelpers")),new gb.a(()=>n.qb("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){v.AFrameworkApplication.fa.gf(()=>{this.BCa()})}BCa(){const n=Eh.a.su(u.a.instance.Oa("Common.INewAndOpenCommonHelpers")),O=Eh.a.su(u.a.instance.Oa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));v.AFrameworkApplication.Lua&&dd.Task.WAA.call(null,n,O).continueWith(()=>{const ha=new oj(new gb.a(()=>
n.result),new gb.a(()=>v.AFrameworkApplication.Ba.jb.yYd()),new gb.a(()=>O.result),new gb.a(()=>v.AFrameworkApplication.Ba.jb.zYd().STb||"1959943459"),new gb.a(()=>v.AFrameworkApplication.Lua),new gb.a(()=>v.AFrameworkApplication.YGj));ha.wb();ha.hhc()});if(v.AFrameworkApplication.RBe){const ha=Eh.a.su(u.a.instance.Oa("Common.IEventEmitter<Common.IMruResult>"));dd.Task.WAA.call(null,n,O,ha).continueWith(()=>{const Aa=new dh(new gb.a(()=>n.result),new gb.a(()=>qh.Wnk),new gb.a(()=>v.AFrameworkApplication.Ba.jb.zYd()),
new gb.a(()=>v.AFrameworkApplication.Vnk),new gb.a(()=>v.AFrameworkApplication.Unk),new gb.a(()=>O.result),new gb.a(()=>ha.result),v.AFrameworkApplication.fa);Aa.FJk();Aa.H$g()})}}dispose(){}}Object(h.a)(eh,"UXPackageManager",null,[2,3,109]);class Gg extends Ca.StandardDialog{constructor(){super();this.vd=0;this.Pe(1,CommonUIStrings.l_DialogClose)}Iu(n){this.Sx(n,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}QAa(n){this.Sx(n,CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(h.a)(Gg,"ErrorDialog",Ca.StandardDialog,[1002]);class vh{F5f(){m.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const n=new xf.a;n.Ig("api.onedrive.com");return n.task}}Object(h.a)(vh,"OneDriveConsumerEndpointHelper",null,[977]);var ze=d(163);class sg{constructor(n,O,ha,Aa){this.O0a=this.Ala=null;this.BBd=this.DBd=!1;this.Hkb=null;this.mb=n;this.Eoc=O;this.r0a=ha;this.gA=Aa}get ODf(){return this.Eoc}get fa(){return this.mb}gsb(){this.Hkb||
(this.Hkb=this.jCb?Kf.a.create(this.jCb,null,null,null,!1):null);return this.Hkb}setup(n){this.O0a=n;this.DBd||this.BBd?this.DBd&&this.O0a&&this.O0a(!0):(n=this.gsb())?(this.BBd=!0,n.R7.continueWith(O=>{this.zjk(O)}),cc.a.nt(n)):(m.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.O0a(!1))}eve(n){m.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",n.Ti?n.Ti.toString():"No error detail.")}zjk(n){this.BBd=!1;
if(n.Sl)this.eve(n),this.O0a(!1);else try{this.DBd=!0,m.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.w5d(),m.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.O0a(!0)}catch(O){m.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",O.toString()),this.O0a(!1)}}Ukc(n){this.Ala=n;this.r0a?m.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(m.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(r.a)(this,this.Bte,"onApiReady")))}Bte(n){n?this.UUc():this.Ns()}Ns(){this.gA().Iu(ze.a.tnk)}onSuccess(n){m.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.Ala&&this.Ala(!0,n)}dispose(){this.Hkb&&this.Hkb.dispose()}}Object(h.a)(sg,"AOneDriveFilePickerApiManager",null,[1024,109]);class zd extends sg{constructor(n,O,ha,Aa,La,Bb){super(O,ha,Aa,Bb);this.Vk=null;this.iaa=n;this.UTh=La}get jCb(){return this.fa.Ia("OneDriveApiUrl")}start(n,O){this.Vk=
n;this.Ukc(O)}w5d(){WL.init(1===this.ODf||2===this.ODf?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}Ukc(n){this.Ala=n;!this.r0a&&this.iaa.k7d?(m.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(r.a)(this,this.Bte,"onApiReady"))):(m.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.UTh())}UUc(){try{m.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Vk).then(Object(r.a)(this,this.onSuccess,"onSuccess"),Object(r.a)(this,this.Tz,"onFailure"))}catch(n){m.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",n,n.stack),this.Ns()}}Tz(n){if(n&&n.error){if("user_canceled"===n.error.code){m.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}m.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",n.error.code,n.error.message)}else m.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.Ala&&this.Ala(!1,n);this.Ns()}}Object(h.a)(zd,"OneDriveFilePickerApiManagerV5",sg,[]);class Hd extends sg{constructor(n,O,ha,Aa,La){super(n,O,ha,Aa);this.Nrc=this.iff=null;this.CJh=La;this.options={};this.options.clientId=this.fa.Ia("OneDriveApiV7ClientId");this.options.cancel=Object(r.a)(this,this.akd,"toggleHostDivVisibility")}get jCb(){return this.fa.Ia("OneDriveApiV72Url")}start(n,O){this.Nrc=O;const ha=this.CJh.F5f();ha.continueWith(()=>{m.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.iff=ha.result;this.Ukc((Aa,La)=>{this.akd();n(Aa,La)})},3);ha.continueWith(()=>{m.ULS.sendTraceTag(24134242,352,15,ha.Ti.message);this.akd()},5)}w5d(){this.options.success=n=>{const O={};O.data=n;this.onSuccess(O)};this.options.error=n=>{const O={};O.error=n;this.Tz(O)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.iff;this.options.advanced.iframeParentDiv=this.Nrc}UUc(){try{m.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.akd(),OneDrive.open(this.options)}catch(n){m.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",n.message),this.Ns()}}Tz(n){this.Ala&&this.Ala(!1,n);this.Ns()}akd(){this.Nrc.style.visibility="hidden"===this.Nrc.style.visibility?"":"hidden"}}Object(h.a)(Hd,"OneDriveFilePickerApiManagerV7",sg,[]);class Fh extends sg{constructor(n,O,ha,Aa){super(n,O,ha,Aa);this.WFh=n;this.options={};this.options.advanced={};this.options.action=
"query";this.options.clientId=this.fa.Ia("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get jCb(){return this.fa.Ia("OneDriveApiV72Url")}start(n,O,ha,Aa){this.options.advanced.iframeParentDiv=ha;this.options.advanced.endpointHint=Aa;this.options.cancel=O;this.WFh.ka("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent=
{});this.Ukc(n)}Ukc(n){this.Ala=n;this.r0a?m.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(m.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(r.a)(this,this.Bte,"onApiReady")))}w5d(){this.options.success=n=>{const O={};O.data=n;this.onSuccess(O)};this.options.error=n=>{const O={};O.error=n;this.Tz(O)}}UUc(){try{m.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(n){m.ULS.sendTraceTag(23881880,
216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",n.message,n.stack),this.Ns()}}eve(n){m.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",n.Ti?n.Ti.toString():"No error detail.");cc.a.TLk(this.jCb);this.Hkb=null}Ns(){this.gA().QAa(ze.a.LUk)}Tz(n){this.Ala&&this.Ala(!1,n)}}Object(h.a)(Fh,"OneDriveFilePickerApiManagerV72",sg,[]);class Gh{constructor(n){this.olsSessionId=this.value=this.key=null;this.olsSessionId=n}}Object(h.a)(Gh,"IExtraData",null,
[]);class ih extends Fh{constructor(n,O,ha,Aa){super(n,O,ha,Aa);this.options.advanced.filter=n.Ia("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=v.AFrameworkApplication.$Df;n.ka("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=n.Ia("OneDriveApiV72CommandMode")||"none");n.ka("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new Gh(v.AFrameworkApplication.userSessionId))}get jCb(){return this.fa.Ia("OneDriveApiV72Url")}UUc(){try{m.ULS.sendTraceTag(26071182,
352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",v.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(n){m.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",n.message,n.stack),this.Ns()}}}Object(h.a)(ih,"OneDriveFilePickerApiOpenManagerV72",
Fh,[]);class ah{constructor(n){this.nB=null;this.Di=n;this.yAd=3}F5f(){this.nB=new xf.a;m.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.UGe();return this.nB.task}UGe(n=null){const O=String.format("GetMoreInfoHandler.ashx?{0}",v.AFrameworkApplication.d4a);this.Di.wY(O,1,null,n,["PersonalFileStorageUrl","X-NewKey"],2,Object(r.a)(this,this.C5i,"getMoreInfoSucceeded"),Object(r.a)(this,this.A5i,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,
"21")}A5i(n){if(n.data.tf===ad.a.qfc&&"X-NewKey"in n.data.lj){m.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const O={};O["X-Key"]=n.data.lj["X-NewKey"];this.UGe(O)}else 0<this.yAd?(m.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.yAd),this.yAd--,this.UGe()):(m.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.nB.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}C5i(n){"PersonalFileStorageUrl"in n.data.lj&&""!==n.data.lj.PersonalFileStorageUrl?(m.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.nB.Ig(n.data.lj.PersonalFileStorageUrl)):(m.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.nB.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}
Object(h.a)(ah,"OneDriveForBusinessEndpointHelper",null,[977]);var Fi=d(339);class Wi{constructor(){this.Ea=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Yb(n){this.Ea=n;this.Ea.register(zd,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ma().na(()=>new zd(Fi.a.instance,v.AFrameworkApplication.fa,v.AFrameworkApplication.QOa,v.AFrameworkApplication.XP,v.AFrameworkApplication.oph,()=>
new Gg));v.AFrameworkApplication.gvb?this.Ea.register(977,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().na(()=>new vh):this.Ea.register(977,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().na(()=>new ah(v.AFrameworkApplication.Be));this.Ea.register(Hd,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ma().na(()=>new Hd(v.AFrameworkApplication.fa,v.AFrameworkApplication.QOa,v.AFrameworkApplication.XP,()=>new Gg,this.Ea.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));
this.Ea.register(Fh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ma().na(()=>new Fh(v.AFrameworkApplication.fa,v.AFrameworkApplication.QOa,v.AFrameworkApplication.XP,()=>new Gg));this.Ea.register(ih,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ma().na(()=>new ih(v.AFrameworkApplication.fa,v.AFrameworkApplication.QOa,v.AFrameworkApplication.XP,()=>new Gg))}static main(){e.a.instance.Ec(new Wi)}}Object(h.a)(Wi,"PackageManager",null,[2,3]);var Mg=d(168),
ee=d(179);class Lf{constructor(n){this.t6b=this.jne=this.Lab=this.B_c=0;this.Ple=this.qLg=null;n?(this.Bb=n,this.LWb=Date.now,this.Kxi(),this.tJk()):m.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}w1k(){this.qLg="Office.PowerPoint.Online.Data.Activity.PenInputMinutes"}tJk(){window.document.body.addEventListener("pointerenter",Object(r.a)(this,this.ckk,"onPointerEnter"));window.document.body.addEventListener("pointerleave",Object(r.a)(this,this.dkk,
"onPointerLeave"))}ckk(n){"pen"!==n.pointerType||this.Lab||(this.Lab=Math.floor(this.LWb()/1E3),this.Lab<=this.B_c&&(this.Lab=this.B_c),this.jne=0)}dkk(n){"pen"===n.pointerType&&(n=Math.ceil(this.LWb()/1E3),this.Lab&&n>this.B_c&&(this.jne=n,this.t6b+=this.jne-this.Lab),this.B_c=n,this.Lab=0)}Kxi(){this.Ple=new Y.a(4,2,6E4,Object(r.a)(this,this.WUj,"logPenUsage"));this.Bb.Hb(this.Ple)}WUj(){0<this.t6b&&this.zXk(this.t6b);this.t6b=0}zXk(n){const O=new ee.a;O.name=this.qLg;const ha=[];(n=Mg.a.a7("PenInputSec",
n.toString(),3))&&Array.add(ha,n);O.dataFields=ha;x.a.sendActivityEvent(O)}dispose(){this.Bb.ah(this.Ple)}}Object(h.a)(Lf,"PenMinutesManager",null,[972]);class Vf{constructor(){this.$yd=this.Ea=null}get name(){return"Common.App.PenMinutesManager"}Yb(n){this.Ea=n;const O=v.AFrameworkApplication.ve;this.Ea.register(972,"Common.App.PenMinutesManager.IPenMinutesManager").ma().na(()=>new Lf(O))}init(){this.$yd=this.Ea.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.$yd&&this.$yd.dispose()}static main(){e.a.instance.Ec(new Vf)}}
Object(h.a)(Vf,"PenMinutesManagerPackage",null,[2,3]);class fd extends Ca.StandardDialog{constructor(n,O){super();this.Jkb=!1;this.CJ=null;this.Da=n;this.YLb=O;this.YXa=!1}Iu(n,O,ha){this.CJ=O;this.Jkb=ha;m.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",n,ha);n=this.CLd(n);0===n?(this.vd=6,this.Pe(0,CommonUIStrings.l_DialogClose)):(this.vd=0,this.Pe(1,CommonUIStrings.l_DialogClose));0===n&&m.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Sx(ze.a.KUk,
this.H_i(n),this.G_i(n,O),Object(r.a)(this,this.bFe,"retryDialogHandler"),!0)}bFe(n){1===n?(m.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.CJ?this.Da.Ma(G.a.UEb,2,[this.CJ,this.Jkb]):this.Da.processAction(G.a.UEb,2)):m.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}CLd(n){return 0>n||6<n?(m.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",n),0):n}G_i(n,O){n=this.CLd(n);return this.YLb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,
CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,O),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][n]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,O),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][n]}H_i(n){n=
this.CLd(n);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][n]}}Object(h.a)(fd,"ErrorRetryDialog",Ca.StandardDialog,[1220]);class Ee{constructor(n,O){this.mb=n;this.Da=O;this.YLb=this.mb.ka("SaveToHostWithExtraCharsInFileName")}create(){return new fd(this.Da,this.YLb)}}Object(h.a)(Ee,"ErrorRetryDialogFactory",
null,[1182]);class Yf extends be.a{constructor(n,O,ha,Aa,La,Bb,Wb=null){super();this.rU=null;this.Da=O;this.B$=Aa;this.nza=Bb;this.mb=n;this.gA=La;this.Mh=ha;this.YLb=this.mb.ka("SaveToHostWithExtraCharsInFileName");this.Vk=Wb;this.Pe(1,CommonUIStrings.l_SaveButtonLabel)}get Ba(){return this.Mh}$Vf(n,O){this.rC(1,!!n&&n!==O);this.rU=document.getElementById(Yf.D1f);Hb.a.addHandler(this.rU,"change",Object(r.a)(this,this.S6c,"onFileNameChange"));Hb.a.addHandler(this.rU,"input",Object(r.a)(this,this.S6c,
"onFileNameChange"));this.rU.focus()}C1f(n){return this.YLb?(new RegExp("["+this.m_f('\\/:*?"<>|')+"]")).test(n):(new RegExp("["+this.m_f('\\/:*?"<>|#{}%~&')+"]")).test(n)}m_f(n){return n.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}w2d(){const n=ib.a.jG(v.AFrameworkApplication.$t.nx);this.rC(1,!!this.rU&&""!==this.rU.value&&this.rU.value!==n)}S6c(){this.rU&&window.setTimeout(()=>{this.w2d()},0)}KIc(n,O){if(1!==n)m.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");
else{n=O[Yf.D1f];O=Yf.k1g in O?O[Yf.k1g]:!1;m.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",ib.a.v$g(n),O);const ha=ib.a.nV(v.AFrameworkApplication.fileName);(n=n?n.trim():null)&&""!==n&&""!==ha||1===this.Ba.state?this.C1f(n)?this.gA.create().Iu(1,n,O):this.nza.a$(n+ha,O,this.Vk):this.gA.create().Iu(2,n,O)}}dispose(){this.rU&&(Hb.a.removeHandler(this.rU,"change",Object(r.a)(this,this.S6c,"onFileNameChange")),Hb.a.removeHandler(this.rU,
"input",Object(r.a)(this,this.S6c,"onFileNameChange")),this.rU=null);super.dispose()}}Yf.D1f="txtFileName";Yf.k1g="chkOverwrite";Object(h.a)(Yf,"FileNameDialogBase",be.a,[]);class ij{static get Wf(){return be.a.tA(ij.Ym,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}ij.Ym="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(h.a)(ij,"FileNameDialogHtml",null,[]);class Md extends Yf{constructor(n,O,ha,Aa,La,Bb){super(n,O,ha,Aa,La,Bb);this.Wf=ij.Wf;this.kg="FileNameDialog-SaveAsToHost"}uha(n,O){const ha=ib.a.jG(v.AFrameworkApplication.$t.nx);O={["txtFileName"]:n||ha,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:O};this.qj(CommonUIStrings.L_SaveAs,Object(r.a)(this,this.KIc,"fileNameDialogHandler"),O);this.$Vf(n,ha)}}Object(h.a)(Md,"FileNameDialog",Yf,[1219]);class pj{constructor(n,O,ha,Aa,La,
Bb){this.Da=O;this.mb=n;this.B$=Aa;this.nza=Bb;this.gA=La;this.Mh=ha}create(){return new Md(this.mb,this.Da,this.Mh,this.B$,this.gA,this.nza)}}Object(h.a)(pj,"FileNameDialogFactory",null,[1181]);class qj{constructor(n,O,ha){this.nza=ha;this.Yrd=O;this.mb=n}wb(){2===v.AFrameworkApplication.Ba.jb.vm?v.AFrameworkApplication.Va.ra(G.a.UEb,H.a.frame,Object(r.a)(this,this.sgh,"saveAsToHostActionDispatcher"),4):v.AFrameworkApplication.Va.ya(G.a.UEb,H.a.frame,Object(r.a)(this,this.sgh,"saveAsToHostActionDispatcher"))}sgh(n,
O,ha,Aa,La){return O.contextId!==H.a.frame||n!==G.a.UEb?2:this.mb.ka("SaveAsToHostBrsIsEnabled")?1===ha?A.SessionStatusManager.instance.nia||v.AFrameworkApplication.SP?8:32:2===ha?(m.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),n=this.Yrd.create(),La&&Object.getType(La)===Array&&2===La.length?n.uha(La[0],!!La[1]):n.uha(null,!1),32):8:8}}Object(h.a)(qj,"SaveAsToHostActor",null,[]);class jj{constructor(n,O,ha,Aa,La,Bb,Wb,uc){this.pn=null;this.Jkb=this.Y0=
!1;this.mza=this.Vk=this.CJ=null;this.mb=O;this.qaa=this.mb.appSettings.SaveAsToHostWebServiceBase;this.R5e=Aa;this.woa=La;this.Di=ha;this.gA=Bb;this.Sh=uc;this.Mh=Wb;this.Da=n;this.gya=O.Ia("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Bkc(){1!==this.Mh.state&&(this.pn=this.woa(),this.pn.message=CommonUIStrings.l_CommentProgressTooltip,this.pn.vd=5,this.pn.Zq=!1,this.pn.Rma(CommonUIStrings.l_DefaultDialogTitle,null,null))}AX(n=0){1!==this.Mh.state&&this.gA.create().Iu(n,ib.a.jG(this.CJ),
this.Jkb)}Wdb(){const n=this.mb.appSettings.BreadcrumbFolderUrl;m.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");pc.a.Qm(n,pc.a.u$(3),void 0,"UploadToHostManager.RedirectToFolder")}Vdb(n){let O=!1,ha=!1;this.mb&&(O=this.mb.ka("SaveACopyIsEnabledForUiHost"),ha=this.mb.ka("UiHostSupportsDocRebootFeatures"));m.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",n,O,ha);if(O&&ha){m.ULS.sendTraceTag(51245197,216,
50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Aa={};Aa[Ld.a.SDb]="1";Aa[Ld.a.documentUrl]=n;Aa[Ld.a.reason]=Le.a.QFe;v.AFrameworkApplication.tV().execute(La=>{La.sendMessage(Xf.a.TAa,Aa)})}else O&&!ha&&v.AFrameworkApplication.isa?pc.a.Qm(n,pc.a.u$(4),void 0,"UploadToHostManager.RedirectToEditUrl"):pc.a.Qm(n,pc.a.u$(3),void 0,"UploadToHostManager.RedirectToEditUrl")}a$(n,O,ha=null){m.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.R5e&&!this.R5e()&&
this.Di&&(this.Sh&&(this.mza=this.Sh.wi("DialogShown","SaveAsToHostUploadTime")),this.Bkc(),this.Jkb=O,this.CJ=n,(this.Vk=ha)&&"true"===this.Vk.SkipSaveToHost?this.ZHc():this.Y1())}Y1(){32!==this.Da.processAction(G.a.fXa,1)?(m.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.ZHc()):this.Da.Ma(G.a.fXa,2,[()=>{m.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.ZHc()},(n,O)=>{m.ULS.sendTraceTag(18989380,
219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.AX(O)}])}ank(n){this.v4a();this.Y0=!1;if(n&&n.data&&n.data.je)if(({Ev:O}=ef.d(n.data.je)).returnValue)if(n=O,n.StatusCode!==ad.a.Xy&&n.StatusCode!==ad.a.sWb){m.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var O={};O.FailureReason=n.StatusCode.toString();O.ExtraInfo=n.ExtraInfo;this.Pva(O);this.AX(parseInt(n.ExtraInfo))}else{m.ULS.sendTraceTag(8194050,216,50,
"UploadToHost execute success.");this.lEe();try{n.NewDocumentUrl&&""!==n.NewDocumentUrl?this.Vdb(n.NewDocumentUrl):this.Wdb()}catch(ha){m.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",ha.toString())}this.mec()}else m.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Fg.a.Emc(n.data.je)}),this.Pva({["FailureReason"]:"Failed to deserialize response"}),this.AX();else m.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Pva({["FailureReason"]:"null response"}),this.AX()}$mk(n){5!==n.data.status&&12!==n.data.status||this.Y0?(m.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:n.data.status,["HttpStatus"]:n.data.tf}),this.Pva({["FailureReason"]:n.data.tf.toString()}),this.v4a(),this.AX(),this.mec()):(m.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.Y0=!0,this.Vk&&"true"===this.Vk.SkipSaveToHost?this.ZHc():this.Y1())}v4a(){this.pn&&
(this.pn.close(),this.pn=null)}mec(){this.mza&&(this.mza.stop(),this.mza=null)}lEe(){this.Vk&&"VersionHistory"===this.Vk.SaveEntryPoint&&this.Da.processAction(G.a.Zcd,2)}Pva(n){this.Vk&&"VersionHistory"===this.Vk.SaveEntryPoint&&this.Da.Ma(G.a.mEe,2,n)}ZHc(){let n=this.qaa+this.gya;n=Yc.a.aj(n,"qs",ib.a.Me(v.AFrameworkApplication.$g));n=Yc.a.aj(n,"n",ib.a.Me((new Date).getTime().toString()));n=Yc.a.aj(n,"ov",ib.a.Me(this.Jkb.toString()));n=Yc.a.aj(n,"fn",ib.a.Me(this.CJ));this.Vk&&this.Vk.FileDownloadUrl&&
(n=Yc.a.aj(n,"furl",ib.a.Me(this.Vk.FileDownloadUrl)));this.Di.Jj(n,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(r.a)(this,this.ank,"onUploadFinished"),Object(r.a)(this,this.$mk,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(h.a)(jj,"UploadToHostManager",null,[1180]);var Ag=d(543);class mf{constructor(){this.Ea=null}get name(){return"Common.App.SaveAsToHost"}init(){v.AFrameworkApplication.fa.gf(Object(r.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){v.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&
this.Ea.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").wb()}Yb(n){this.Ea=n;this.Ea.register(Ee,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").na(()=>new Ee(v.AFrameworkApplication.fa,v.AFrameworkApplication.Va)).ma();this.Ea.register(jj,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").na(()=>new jj(v.AFrameworkApplication.Va,v.AFrameworkApplication.fa,v.AFrameworkApplication.Be,()=>v.AFrameworkApplication.Xg,
()=>(new Ag.a).create(),n.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),v.AFrameworkApplication.Ba,v.AFrameworkApplication.Ba.aU)).ma();this.Ea.register(pj,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").na(()=>new pj(v.AFrameworkApplication.fa,v.AFrameworkApplication.Va,v.AFrameworkApplication.Ba,v.AFrameworkApplication.Ba.jb,n.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),n.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma();
this.Ea.register(qj,"Common.App.SaveAsToHost.SaveAsToHostActor").na(()=>new qj(v.AFrameworkApplication.fa,n.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),n.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma()}dispose(){}static main(){e.a.instance.Ec(new mf)}}Object(h.a)(mf,"SaveAsToHostPackage",null,[2,3]);class Ia extends Ca.StandardDialog{constructor(){super();this.vd=0;this.Pe(1,CommonUIStrings.l_DialogClose)}Iu(n,O){this.vWf(n,O,ze.a.MUk)}vWf(n,O,ha){m.ULS.sendTraceTag(25180161,
216,10,"Show upload error dialog with error code {0}.",ha);this.Sx(ha,n,O,null)}QAa(n,O){m.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Sx(ze.a.OUk,n,O,null,!0)}}Object(h.a)(Ia,"ErrorDialog",Ca.StandardDialog,[1189]);class tb{static get Wf(){return be.a.tA(tb.Ym,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}tb.Ym="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(h.a)(tb,"FileNameDialogHtml",null,[]);class Qb extends Yf{constructor(n,O,ha,Aa,La,Bb,Wb,uc){super(n,O,ha,Aa,La,Bb,uc);this.JKa=this.bBd=this.yH=null;this.Zdi=CommonUIStrings.l_SaveToAnotherFolder;this.Wf=tb.Wf;this.kg="FileNameDialog-SaveToSharePoint";this.kQb=Wb;this.cQh=uc}uha(n){const O=ib.a.jG(v.AFrameworkApplication.$t.nx),ha=v.AFrameworkApplication.breadcrumbFolderName,Aa=v.AFrameworkApplication.breadcrumbBrandName,La={["txtFileName"]:n||O};let Bb=CommonUIStrings.L_SaveAs;2===v.AFrameworkApplication.Ba.jb.vm&&
(Bb=CommonUIStrings.L_SaveACopy);this.qj(Bb,Object(r.a)(this,this.KIc,"fileNameDialogHandler"),La);this.$Vf(n,O);this.$Qd.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost")||(this.yH=document.getElementById("anotherFolder"),n=document.getElementById("folderLocation"),this.bBd=ka.a.cEf(n,this.yH,"anotherFolderDescribedBy",""),this.yH.className="WACButton WACDialogButtonNormal",
n=!1,ha&&ha.length?(this.Rzf(this.yH,this.bBd,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Aa,ha)),n=this.WXh(Aa,ha)):this.Rzf(this.yH,this.bBd,CommonUIStrings.l_CurrentOnlineFolder),this.uZh(this.yH),this.YXh(this.yH),n?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.yH,"SaveToAnotherLocationTwo"),m.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.yH,"SaveToAnotherLocationOne"),
Hb.a.addHandler(this.yH,ma.a.click,Object(r.a)(this,this.Jve,"onSaveToAnotherLocationClick")),Hb.a.addHandler(this.yH,ma.a.Rf,Object(r.a)(this,this.FZg,"onSaveToAnotherLocationKeyDown")))}WXh(n,O){let ha;ha=!1;const Aa=document.getElementById("currentLocation");Aa.innerText="";const La=this.fag(Aa,n),Bb=this.fag(Aa,O);let Wb=255,uc=255;255<La+Bb&&(Wb=Math.max(238,408-La),uc=Math.max(170,408-Bb),ha=!0);this.V_h(Aa,n,uc,O,Wb);return ha}fag(n,O){const ha=document.createElement("div");ha.innerText=O;
ha.style.visibility="hidden";n.appendChild(ha);O=ha.clientWidth;n.removeChild(ha);return O}V_h(n,O,ha,Aa,La){O&&(this.Qzf(n,O,ha),this.K_h(n));Aa&&this.Qzf(n,Aa,La)}Qzf(n,O,ha){const Aa=document.createElement("div");Aa.innerText=O;Aa.title=O;Aa.className="SaveToAnotherFolderBreadcrumb";Aa.style.maxWidth=ha.toString()+"px";n.appendChild(Aa)}K_h(n){const O=document.createElement("span");O.id="FolderSeparator";const ha=document.createElementNS("http://www.w3.org/2000/svg","svg");ha.setAttribute("class",
"SeparatorCaret");const Aa=document.createElementNS("http://www.w3.org/2000/svg","polygon");Aa.setAttribute("points","1 4 1 11 5 7.5");ha.appendChild(Aa);O.appendChild(ha);n.appendChild(O)}Rzf(n,O,ha){ha=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,ha);O&&(O.innerText=ha);n.tabIndex=0;n.setAttribute(ka.a.ff,ka.a.St)}YXh(n){const O=document.createElement("span");O.id="anotherFolderText";O.innerText=this.Zdi;O.className="AnotherFolderTextSpan";n.appendChild(O)}uZh(n){const O=
document.createElement("span");O.className="cui-img-cont-float cui-img-16by16 ";this.JKa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.JKa.setAttribute("class","FolderIconSVG");const ha=document.createElementNS("http://www.w3.org/2000/svg","path");ha.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.JKa.appendChild(ha);O.appendChild(this.JKa);n.appendChild(O)}FZg(n){!n||n.keyCode!==
ra.a.Xp&&n.keyCode!==ra.a.tJb||this.Jve(n)}Jve(){if(this.rU){const n=ib.a.nV(v.AFrameworkApplication.fileName);let O=this.rU.value;this.hide();O&&""!==O&&""!==n||1===this.Ba.state?(""!==n&&(O+=n),this.C1f(O)?this.gA.create().Iu(1,O,!1):this.kQb.start(O,this.cQh)):this.gA.create().Iu(2,O,!1)}}Hii(n){this.yH&&this.JKa&&(n?(this.yH.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.yH,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.JKa,"DisabledFolderIconSVG")):(this.yH.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.yH,
"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.JKa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.yH,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.JKa,"DisabledFolderIconSVG"))))}w2d(){super.w2d();this.Hii(!!this.rU&&""!==this.rU.value)}dispose(){this.yH&&(Hb.a.removeHandler(this.yH,ma.a.click,Object(r.a)(this,this.Jve,"onSaveToAnotherLocationClick")),Hb.a.removeHandler(this.yH,ma.a.Rf,Object(r.a)(this,this.FZg,"onSaveToAnotherLocationKeyDown")),this.yH=
null);super.dispose()}}Object(h.a)(Qb,"FileNameDialog",Yf,[1222]);var qc=d(1155),Lc=d(1156),Jd=d(894),le=d(214);class je{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(h.a)(je,"SaveAsDialogInput",null,[]);class Gf{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(h.a)(Gf,"SaveLocation",null,[]);var Wf=d(88);class fh{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc){this.owd=null;this.CJ="";this.kQb=n;this.gA=
O;this.Vk=Vc;this.nza=ha;this.Mh=La;this.iE=Aa;this.e2a=Wb;this.ulb=uc;Bb&&(this.owd=new gb.a(()=>new lf.a(Bb.value,null)))}MZi(){const n=new qc.a(Lc.a.rt());n.$("type","currentHost");return Object.assign(new Gf,{folderName:this.iE.breadcrumbFolderName,friendlyPath:this.iE.breadcrumbBrandName,properties:n})}bLj(n){return!!n&&"ClassicMru"===n.type&&!!n.service_info&&!!n.service_info.service_id&&-1!==n.service_info.service_id.indexOf("SHAREPOINT")}Jaj(){if(!this.owd||!this.e2a)return null;var n=this.owd.value.zba("SaveAsToSharePointDialog",
!1);if(!n||3!==n.state||!n.USg)return null;n=n.USg;const O=new C.a;let ha=0,Aa=0;for(var La=0;La<n.length;La++){var Bb=n[La];if(!this.bLj(Bb))continue;ha++;if(!Bb.sharepoint_info)continue;const Wb=Bb.url,uc=Bb.sharepoint_info.site_url,Vc=Bb.title;Bb=Jd.b(Bb,v.AFrameworkApplication.isRtl);if(!(Wb&&uc&&Vc&&Bb))continue;Aa++;const bd=new qc.a(Lc.a.rt());bd.$("type","SharePoint");bd.$("siteUrl",uc);bd.$("folderUrl",Wb);Aa++;O.add(Object.assign(new Gf,{folderName:Vc,friendlyPath:Bb,properties:bd}))}La=
new Map;La.set("NumPlaces",n.length.toString());La.set("NumSharepointPlaces",ha.toString());La.set("placesWithMetadata",Aa.toString());Wc.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",La);0<ha&&(Aa?.5>1*Aa/ha&&Wc.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Wc.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return O}F_i(){const n=new C.a;n.add(this.MZi());const O=
this.Jaj();O&&n.addRange(O);return Object.assign(new je,{enableMoreLocations:!v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.CJ,extension:ib.a.nV(this.iE.nx),saveLocations:n.toArray(),scenario:"SaveToSharePoint"})}cLc(){const n=Object(r.a)(this,this.F_i,"getDialogInput"),O={};O.inputPropsCallback=n;return O}uha(n){this.CJ=n;this.CJ||(this.CJ=String.format(CommonUIStrings.l_SaveACopy_Filename,ib.a.jG(this.iE.nx)));n={["id"]:"SaveAsDialog",["bodyControls"]:this.cLc()};
let O=CommonUIStrings.L_SaveAs;2===this.Mh.jb.vm&&(O=CommonUIStrings.L_SaveACopy);const ha=new be.a(!1,!1,!0);ha.vd=1;ha.kg="SaveAsDialog";ha.Pe(1,CommonUIStrings.l_SaveButtonLabel);ha.qj(O,Object(r.a)(this,this.IUk,"saveAsDialogHandler"),n)}G$k(n,O){n&&""!==n&&""!==O||1===this.Mh.state?this.aLj()?this.XRj(n,O):(""!==O&&(n+=O),this.kQb.start(n,this.Vk)):(m.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.gA.create().Iu(2,n,!1))}XRj(n,O){Wc.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);const ha=this.ulb.xOd(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.ulb.AYd(ha).then(Aa=>{if(Aa&&0<Aa.length){const La=Aa[0][Ld.a.xsk];Aa=Aa[0][Ld.a.Lxe];if(""!==La&&""!==Aa)this.e2a.a$(Aa,n+O,La,this.Vk),Wc.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.gA.create().Iu(0,n,!1);const Bb=le.a.oz();Bb&&(Bb.set("SiteUrlAvailable",""===La?"false":"true"),Bb.set("FolderUrlAvailable",""===Aa?"false":
"true"));Wc.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Wf.a,{extendedProperties:Bb}))}}else this.gA.create().Iu(0,n,!1),Wc.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Aa=>{"Canceled"===Aa?((Aa=le.a.oz())&&Aa.set("IsCanceled","true"),Wc.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Wf.a,{extendedProperties:Aa}))):Wc.Health.instance.recordKpiFailure("SaveACopySFP",
Aa,!1,!1,null)})}aLj(){return this.ulb?this.ulb.z$d():(m.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}IUk(n,O){if(O&&1===n){n=O.fileName;var ha=ib.a.nV(this.iE.nx);O.moreLocationsSelected&&this.G$k(n,ha);if(O.locationCallback){var Aa=O.locationCallback();Aa?Aa.properties&&"currentHost"===Aa.properties.ga("type")?this.nza.a$(n+ha,!1,this.Vk):Aa.properties&&"SharePoint"===Aa.properties.ga("type")?(O=Aa.properties.ga("siteUrl"),Aa=Aa.properties.ga("folderUrl"),this.e2a.a$(Aa,
n+ha,O,this.Vk)):m.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):m.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else m.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(h.a)(fh,"ReactSaveAsDialog",null,[1222]);class zh{constructor(n,O,ha,Aa,La,Bb,Wb,uc=null,Vc=null,bd=null){this.Da=O;this.mb=n;this.B$=Aa;this.nza=Bb;this.gA=La;this.Mh=ha;this.Lsf=Wb;this.WNh=uc;this.e2a=Vc;this.ulb=bd}create(n){return this.Mh&&this.Mh.jb.QB?new fh(this.Lsf,
this.gA,this.nza,v.AFrameworkApplication.$t,this.Mh,this.WNh,this.e2a,this.ulb,n):new Qb(this.mb,this.Da,this.Mh,this.B$,this.gA,this.nza,this.Lsf,n)}}Object(h.a)(zh,"FileNameDialogFactory",null,[1188]);class Qg{constructor(n,O,ha,Aa){this.Nn=this.Sfa=null;this.A_a=n;this.Mh=ha;this.MQh=Aa;this.wfa=new gb.a(()=>new lf.a(O.value,Object(r.a)(this,this.WBa,"getMoreInfoEventReceived")))}get kCb(){this.Sfa||(this.wfa.value.zba("Save As",!0),this.Nn&&this.Nn.AQ&&this.Nn.AQ.length&&(this.Sfa=this.k_d(this.Nn.AQ)));
return this.Sfa}start(n){if(!this.kCb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.Sfa=v.AFrameworkApplication.breadcrumbFolderUrl;else return m.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Nn),!1;const O=this.MQh();O.tLe();const ha=O.D_d();if(!ha)return m.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),
!1;this.A_a.start((Aa,La)=>{O.hide();n(Aa,La)},()=>{this.aue(O)},ha,this.Sfa);return!0}aue(n){n.hide();m.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}k_d(n){n=n.toLowerCase();n.endsWith("/")||(n+="/");const O=n.indexOf("/documents/");return-1!==O?n.substring(0,O+1)+"_layouts/15/onedrive.aspx":""}WBa(n){this.Nn||3!==n.state||(this.Nn=n)}}Object(h.a)(Qg,"OneDriveFilePickerHelper",null,[1187]);class Rg extends be.a{constructor(){super()}tLe(){this.hqc="FilePickerDialog";
this.Wf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.kg="PickerDialog-MsoSp";this.showDialog("",null)}D_d(){return document.getElementById("FilePickerDiv")}AF(){}Yla(){}}Object(h.a)(Rg,"PickerDialog",be.a,[1185]);var wi=d(481);class Ng{constructor(n,O,ha,Aa,La,Bb,Wb){this.mb=n;this.Yrd=ha;this.Da=O;this.kQb=Aa;this.A_a=La;this.qyd=Bb;this.aHh=Wb}wb(){const n=this.A_a.gsb();n?Ic.a.Fw||this.mb.ka("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Da.ra(G.a.Jeb,H.a.frame,Object(r.a)(this,
this.Lgh,"saveToSharePointActionDispatcher"),64):(n.R7.continueWith(O=>{O.Sl&&this.A_a.eve(O)}),this.VBc()):m.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}VBc(){cc.a.Xbd(Object(r.a)(this,this.Lgh,"saveToSharePointActionDispatcher"));cc.a.dYb([new wi.a(G.a.Jeb,H.a.frame,0)],this.A_a.gsb())}get rvb(){return this.mb.ka("SaveToAnotherFolderBrsIsEnabled")}get JKf(){return this.mb.ka("UserCanWriteRelative")}Lgh(n,O,ha,Aa,La){return O.contextId!==H.a.frame||
n!==G.a.Jeb?2:this.rvb&&(this.qyd.kCb||this.JKf)?1===ha?A.SessionStatusManager.instance.nia||v.AFrameworkApplication.SP?8:this.aHh()?32:8:2===ha?(m.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(La&&La.SaveEntryPoint&&"VersionHistory"===La.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.JKf?(m.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.Yrd.create(La).uha(null)):(m.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),
this.kQb.start(null,La)),32):8:8}}Object(h.a)(Ng,"SaveToSharePointActor",null,[]);class Fj{constructor(n,O,ha,Aa){this.Vk=this.cef=null;this.e2a=n;this.gA=O;this.qyd=ha;this.Mh=Aa}start(n,O){m.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.cef=n;this.Vk=O;this.qyd.start((ha,Aa)=>{this.sDb(ha,Aa)})||this.uLe()}sDb(n,O){if(n)this.onSuccess(O);else this.Tz(O)}uLe(){1!==this.Mh.state&&this.gA().QAa(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(n){m.ULS.sendTraceTag(23881886,
216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(n&&n.data&&n.data.value&&n.data.value.length&&n.data.value[0].sharePoint){const O=n.data.value[0].sharePoint.url;n=n.data.value[0].sharePoint.listUrl;let ha=null;if(O&&(ha=n?this.Qaj(n):this.Paj(O))){this.e2a.a$(O,this.cef,ha,this.Vk);return}m.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!O,!ha)}m.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");
this.uLe()}Paj(n){n.endsWith("/")||(n+="/");let O=0;for(let ha=0;ha<n.length;ha++)if("/"===n.charAt(ha)&&5===++O)return n.substr(0,ha);return null}Qaj(n){n.endsWith("/")&&(n=n.substring(0,n.length-1));const O=n.lastIndexOf("/");return-1!==O?n.substring(0,O):null}Tz(n){m.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");n&&n.error?m.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",n.error.errorCode,n.error.message):m.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.uLe()}}Object(h.a)(Fj,"SaveToSharePointManager",null,[1186]);class Hh{constructor(n,O,ha,Aa,La,Bb,Wb,uc){this.qaa=n;this.CJ=O;this.vjb=Aa;this.Lzd=Bb;this.Wna=ha;this.eUh=La;this.gya=Wb;this.Vk=uc}execute(n,O){if(!v.AFrameworkApplication.Xg&&v.AFrameworkApplication.Be){var ha=this.qaa+this.gya;ha=Yc.a.aj(ha,"fu",ib.a.Me(this.Wna));ha=Yc.a.aj(ha,"su",ib.a.Me(this.eUh));ha=Yc.a.aj(ha,"fn",ib.a.Me(this.CJ));ha=Yc.a.aj(ha,"n",ib.a.Me((new Date).getTime().toString()));
this.Vk&&this.Vk.FileDownloadUrl&&(ha=Yc.a.aj(ha,"furl",ib.a.Me(this.Vk.FileDownloadUrl)));ha=ha+"&"+this.Lzd;this.vjb&&this.vjb.length?ha=Yc.a.aj(ha,"fnn",ib.a.Me(this.vjb)):m.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");m.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");v.AFrameworkApplication.Be.Jj(ha,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,n,O,null,void 0,void 0,void 0,void 0,"9")}}}Object(h.a)(Hh,"SharePointSaveAsCaller",
null,[1221]);class gg{constructor(n){this.cpa=n.appSettings.SaveAsToHostWebServiceBase;this.CJ=n.appSettings.FileName;this.gya=n.Ia("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(n,O,ha,Aa){return new Hh(this.cpa,this.CJ,n,O,ha,v.AFrameworkApplication.$g,this.gya,Aa)}}Object(h.a)(gg,"SharePointUploadCallerFactory",null,[1184]);var Og=d(490);class vg{constructor(n,O,ha,Aa,La){this.pn=this.xKb=null;this.hod=!1;this.YAd=this.Wna=null;this.iEd=O;this.woa=ha;this.gA=Aa;this.Mh=La;this.Da=
n}a$(n,O,ha,Aa){this.hod=!1;m.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Bkc();this.Wna=n;Aa&&Aa.SaveEntryPoint&&(this.YAd=Aa.SaveEntryPoint);this.xKb=this.iEd.create(n,O,ha,Aa);Aa&&"true"===Aa.SkipSaveToHost?this.Y1():this.vSi()}vSi(){const n=()=>{m.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.Y1()};32!==this.Da.Ma(G.a.fXa,2,[()=>{m.ULS.sendTraceTag(23881922,
216,50,"Call the force save file change successfully.");this.Y1()},n])&&n()}Y1(){m.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.xKb.execute(Object(r.a)(this,this.elk,"onSaveToSharePointUploadFinished"),Object(r.a)(this,this.dlk,"onSaveToSharePointUploadFailed"))}elk(n){if(n&&n.data&&n.data.je){var O;if(({Ev:O}=ef.d(n.data.je)).returnValue)if(O.StatusCode!==ad.a.Xy&&O.StatusCode!==ad.a.sWb)m.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
n.data.status,O.StatusCode),O.StatusCode!==ad.a.Idh&&this.QWf(n.data.status)||(this.Pva(O.StatusCode.toString()),this.M9k(O.StatusCode));else{m.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.lEe();try{O.NewDocumentUrl?this.Vdb(O.NewDocumentUrl):this.Wdb()}catch(ha){m.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",ha.toString())}}else m.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Fg.a.Emc(n.data.je)}),
this.KGc()||(this.Pva("Failed to deserialize response"),this.zkc())}else m.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.KGc()||(this.Pva("Unknown"),this.zkc())}dlk(n){n&&n.data?this.QWf(n.data.status)||(m.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Pva(Og.a[n.data.status]),this.zkc()):(m.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.KGc()||(this.Pva("Unknown"),this.zkc()))}KGc(){if(!this.hod)return m.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.hod=!0,this.Y1(),!0;m.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}QWf(n){m.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",n);return this.KGc()}Wdb(){m.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");pc.a.Qm(this.Wna,pc.a.u$(3),void 0,"UploadToSharePointManager.RedirectToFolder")}Vdb(n){let O=!1,ha=!1;v.AFrameworkApplication.fa&&(O=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),
ha=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));m.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",n,O);if(O&&ha){m.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Aa={};Aa[Ld.a.SDb]="1";Aa[Ld.a.documentUrl]=n;Aa[Ld.a.reason]=Le.a.QFe;v.AFrameworkApplication.tV().execute(La=>{La.sendMessage(Xf.a.TAa,Aa)})}else pc.a.Qm(n,pc.a.u$(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Bkc(){this.Mh&&
1===this.Mh.state||(this.pn=this.woa(),this.pn.message=CommonUIStrings.l_CommentProgressTooltip,this.pn.vd=5,this.pn.Zq=!1,this.pn.Rma(CommonUIStrings.l_DefaultDialogTitle,null,null))}v4a(){this.pn&&(this.pn.close(),this.pn=null)}zkc(){this.Ns(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}K$k(){this.Ns(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}T9k(){const n=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);
this.Ns(CommonUIStrings.l_SaveAsFileTooLargeTitle,n,ze.a.JUk)}Ns(n,O,ha=ze.a.NUk){m.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",n,O);this.v4a();1!==this.Mh.state&&this.gA().vWf(n,O,ha)}M9k(n){m.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",n);switch(n){case ad.a.oyh:this.K$k();break;case ad.a.Idh:this.T9k();break;default:this.zkc()}}lEe(){"VersionHistory"===this.YAd&&this.Da.processAction(G.a.Zcd,2)}Pva(n){"VersionHistory"===this.YAd&&this.Da.Ma(G.a.mEe,
2,{["FailureReason"]:n})}}Object(h.a)(vg,"UploadToSharePointManager",null,[1183]);class Sg{constructor(){this.Dwc=this.vxd=this.pxd=this.Ea=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Yb(n){this.Ea=n;this.pxd=Eh.a.su(n.Oa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.vxd=Eh.a.su(n.Oa("Common.IEventEmitter<Common.IMruResult>"));this.Dwc=Eh.a.su(n.Oa("Common.App.SharedFilePicker.ISharedFilePicker"));dd.Task.WAA.call(null,this.pxd,this.vxd,this.Dwc).continueWith(()=>
{this.HHk()})}HHk(){this.Ea.register(gg,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").na(()=>new gg(v.AFrameworkApplication.fa)).ma();this.Ea.register(vg,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").na(()=>new vg(v.AFrameworkApplication.Va,this.Ea.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Ag.a).create(),()=>new Ia,
v.AFrameworkApplication.Ba)).ma();this.Ea.register(Fj,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").na(()=>new Fj(this.Ea.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Ia,this.Ea.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),v.AFrameworkApplication.Ba)).ma();this.Ea.register(Qg,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").na(()=>
new Qg(this.Ea.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new gb.a(()=>this.pxd.result),v.AFrameworkApplication.Ba,()=>new Rg)).ma();this.Ea.register(zh,"Common.App.SaveToSharePoint.FileNameDialogFactory").na(()=>new zh(v.AFrameworkApplication.fa,v.AFrameworkApplication.Va,v.AFrameworkApplication.Ba,v.AFrameworkApplication.Ba.jb,this.Ea.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Ea.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Ea.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new gb.a(()=>this.vxd.result),this.Ea.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Dwc?this.Dwc.result:null)).ma();this.Ea.register(Ng,"Common.App.SaveToSharePoint.SaveToSharePointActor").na(()=>new Ng(v.AFrameworkApplication.fa,v.AFrameworkApplication.Va,this.Ea.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Ea.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Ea.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.Ea.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>v.AFrameworkApplication.Ba.eCc)).ma();v.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&this.Ea.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").wb()}static main(){e.a.instance.Ec(new Sg)}}Object(h.a)(Sg,"PackageManager",null,[2,3]);class wh extends Ca.StandardDialog{constructor(){super();this.vd=0;this.Pe(1,CommonUIStrings.l_DialogClose)}Iu(n){this.Sx(n,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(h.a)(wh,"ErrorDialog",Ca.StandardDialog,[1195]);class ci{}ci.default=0;Object(h.a)(ci,"SaveToCloudErrorCodes",null,[]);class Rh{constructor(n,O,ha,Aa,La,Bb){this.Vk=null;this.XTh=n;this.iaa=O;this.ARb=ha;this.mb=Aa;this.Eoc=La;this.gA=Bb}start(n){this.Vk=n;if("SharePointOnlineConsumer"===this.mb.Ia("FileSource")){const O=u.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(O){O.start(null,n);return}}this.iaa.k7d?(m.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),
this.Mgi()):(m.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.ral())}ral(){this.XTh.create().uha()}Ns(){this.gA().Iu(ci.default)}Mgi(){try{m.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let n={["client_id"]:this.mb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.Eoc||2===this.Eoc)n={["client_id"]:this.mb.appSettings.UploadToSkyDriveClientId};WL.init(n);m.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(r.a)(this,this.onSuccess,"onSuccess"),Object(r.a)(this,this.Tz,"onFailure"))}catch(n){m.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",n,n.stack),this.Ns()}}onSuccess(n){m.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");n&&n.data&&n.data.folders&&this.ARb.a$(n.data.folders[0].id,n.data.folders[0].urls.viewInBrowser,null,this.Vk)}Tz(n){if(n&&
n.error){if("user_canceled"===n.error.code){m.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}m.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",n.error.code,n.error.message)}else m.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.Ns()}}Object(h.a)(Rh,"SaveToCloudManager",null,[1194]);class se{constructor(n,O,ha,Aa){this.Vvc=null;this.JSh=n;this.mb=ha;this.kff=O;this.fcf=new xf.a;this.Sh=
Aa}rvb(){return this.mb.ka("SaveToCloudStorageUIIsEnabled")}q5f(){return G.a.ZFe}VBc(){cc.a.Xbd(Object(r.a)(this,this.Igh,"saveToCloudActionDispatcher"));cc.a.dYb([new wi.a(G.a.ZFe,H.a.frame,0)],this.kff.gsb())}wb(){const n=this.kff.gsb();n?(n.yM(()=>{this.fcf.Ig(!0)}),this.VBc()):m.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}e$g(){m.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}Igh(n,O,ha,Aa,La){return O.contextId!==
H.a.frame||n!==this.q5f()?2:this.rvb()?1===ha?A.SessionStatusManager.instance.nia||v.AFrameworkApplication.SP?8:32:2===ha?(this.e$g(),La&&La.FileDownloadUrl&&m.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Sh&&(this.Vvc=this.Sh.wi("DialogShown","SaveToOneDriveReponseTime")),this.fcf.task.continueWith(()=>{this.Vvc&&(this.Vvc.stop(),this.Vvc=null);this.JSh.start(La)}),32):8:8}}Object(h.a)(se,"SaveToCloudStorageActor",null,[1193]);var bf=d(218);class Sh extends Ca.StandardDialog{constructor(n,
O,ha){super();this.Da=n;this.iaa=O;this.B$=ha;this.mR=!1;this.vd=1;this.hwa(1);this.Pe(1,CommonUIStrings.l_SignIn);this.Pe(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}uha(){this.iaa.KBf(Object(r.a)(this,this.f_g,"onSignIn"));this.Tw(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(r.a)(this,this.Swj,"inputHandler"))}Swj(n){0===n?(m.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.D9c()}Wii(){let n="2";if(this.B$)switch(this.B$.vm){case 3:n=
"0";break;case 2:n="3";break;case 1:n="1"}return n}hide(){this.iaa.nMk(Object(r.a)(this,this.f_g,"onSignIn"));super.hide()}D9c(){const n=new bf.QueryStringBuilder("Signin.aspx");n.nj("prompt","1");n.nj("cbcxt",this.Wii());v.AFrameworkApplication.BMa(n);pc.a.Qm(n.toString(),"LoginWindow",void 0,"SignInDialog")}f_g(){this.QV&&this.hide();m.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Da.processAction(G.a.ZFe,2)}}Object(h.a)(Sh,"SignInDialog",
Ca.StandardDialog,[1224]);class $c{constructor(n,O,ha){this.Da=n;this.iaa=O;this.B$=ha}create(){return new Sh(this.Da,this.iaa,this.B$)}}Object(h.a)($c,"SignInDialogFactory",null,[1191]);class Gi{constructor(n,O,ha,Aa,La,Bb,Wb){this.qaa=n;this.CJ=O;this.vjb=ha;this.lrc=Aa;this.Lzd=La;this.gya=Bb;this.Vk=Wb}execute(n,O){if(!v.AFrameworkApplication.Xg&&v.AFrameworkApplication.Be){var ha=this.qaa+this.gya;ha=Yc.a.aj(ha,"fo",ib.a.Me(this.lrc));ha=Yc.a.aj(ha,"fn",ib.a.Me(this.CJ));ha=Yc.a.aj(ha,"qs",ib.a.Me(this.Lzd));
ha=Yc.a.aj(ha,"n",ib.a.Me((new Date).getTime().toString()));this.Vk&&this.Vk.FileDownloadUrl&&(ha=Yc.a.aj(ha,"furl",ib.a.Me(this.Vk.FileDownloadUrl)));this.vjb&&(ha=Yc.a.aj(ha,"fnn",ib.a.Me(this.vjb)));v.AFrameworkApplication.Be.Jj(ha,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,n,O,null)}}}Object(h.a)(Gi,"SkyDriveUploadCaller",null,[1225]);class Hk{constructor(n){this.mb=n;this.cpa=n.appSettings.SkyDriveUploadWebServiceBase;this.CJ=n.appSettings.FileName;this.gya=n.Ia("SkyDriveUploadHandler")||
"skydriveuploadhandler.ashx"}create(n,O,ha){return new Gi(this.cpa,this.CJ,O,n,v.AFrameworkApplication.$g,this.gya,ha)}}Object(h.a)(Hk,"SkydriveUploadCallerFactory",null,[1192]);class Gj{constructor(n,O,ha,Aa,La){this.Wna=this.pn=this.xKb=null;this.Y0=!1;this.Vk=this.mza=null;this.iEd=n;this.woa=O;this.gA=ha;this.Mh=Aa;this.Sh=La}Bkc(){this.Mh&&1===this.Mh.state||(this.pn=this.woa(),this.pn.message=CommonUIStrings.l_CommentProgressTooltip,this.pn.vd=5,this.pn.Zq=!1,this.pn.Rma(CommonUIStrings.l_DefaultDialogTitle,
null,null))}v4a(){this.pn&&(this.pn.close(),this.pn=null)}AX(){1!==v.AFrameworkApplication.Ba.state&&this.gA().Iu(ci.default)}Wdb(){m.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");pc.a.Qm(this.Wna,pc.a.u$(3),void 0,"UploadToCloudManager.RedirectToFolder")}Vdb(n){let O=!1,ha=!1;v.AFrameworkApplication.fa&&(O=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),ha=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));m.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
n,O);if(O&&ha){m.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Aa={};Aa[Ld.a.SDb]="1";Aa[Ld.a.documentUrl]=n;v.AFrameworkApplication.tV().execute(La=>{La.sendMessage(Xf.a.TAa,Aa)})}else pc.a.Qm(n,pc.a.u$(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}a$(n,O,ha=null,Aa=null){m.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Sh&&(this.mza=this.Sh.wi("DialogShown","SaveToOneDriveUploadTime"));this.Bkc();this.Wna=
O;this.xKb=this.iEd.create(n,ha,Aa);this.Vk=Aa;this.Y1()}Y1(){m.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.xKb.execute(Object(r.a)(this,this.blk,"onSaveToCloudUploadFinished"),Object(r.a)(this,this.alk,"onSaveToCloudUploadFailed"))}blk(n){this.v4a();this.Y0=!1;if(n&&n.data&&n.data.je){var O;if(({Ev:O}=ef.d(n.data.je)).returnValue)if(n=O,n.StatusCode!==ad.a.Xy&&n.StatusCode!==ad.a.sWb)m.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),
this.AX();else{m.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{n.NewDocumentUrl&&""!==n.NewDocumentUrl?this.Vdb(n.NewDocumentUrl):this.Wdb()}catch(ha){m.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",ha.toString())}this.mec()}else m.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Fg.a.Emc(n.data.je)}),this.AX()}else m.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.AX()}alk(n){5!==
n.data.status&&12!==n.data.status||this.Y0?(m.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",n.data.status),this.v4a(),this.AX(),this.mec()):(m.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.Y0=!0,this.Y1())}mec(){this.mza&&(this.mza.stop(),this.mza=null)}}Object(h.a)(Gj,"UploadToCloudManager",null,[1190]);class Hj{constructor(){this.Ea=null}get name(){return"Common.App.SaveToCloudStorage"}init(){v.AFrameworkApplication.fa.ka("SaveToCloudStorageUIIsEnabled")&&
this.Ea.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").wb()}dispose(){}Yb(n){this.Ea=n;this.Ea.register($c,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").na(()=>new $c(v.AFrameworkApplication.Va,Fi.a.instance,v.AFrameworkApplication.Ba.jb)).ma();this.Ea.register(Hk,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").na(()=>new Hk(v.AFrameworkApplication.fa)).ma();
this.Ea.register(se,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").na(()=>new se(n.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),n.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Ba.aU)).ma();this.Ea.register(Gj,"Common.App.SaveToCloudStorage.UploadToCloudManager").na(()=>new Gj(n.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Ag.a).create(),()=>new wh,v.AFrameworkApplication.Ba,
v.AFrameworkApplication.Ba.aU)).ma();this.Ea.register(Rh,"Common.App.SaveToCloudStorage.SaveToCloudManager").na(()=>new Rh(n.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Fi.a.instance,n.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.QOa,()=>new wh)).ma()}static main(){e.a.instance.Ec(new Hj)}}Object(h.a)(Hj,"PackageManager",null,[2,3]);class wa{static get Wf(){return be.a.tA(wa.Ym,CommonUIStrings.l_SaveACopyFileName)}}
wa.Ym="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(h.a)(wa,"FileNameDialogHtml",null,[]);class Ma extends be.a{constructor(n,O,ha,Aa){super();this.lrc=this.Wna=null;this.Da=n;this.B$=O;this.ARb=ha;this.Pe(1,
CommonUIStrings.l_SaveButtonLabel);this.Wf=wa.Wf;this.kg="FileNameDialog-SaveACopy";this.Vk=Aa}uha(n,O,ha){this.lrc=n;this.Wna=ha;n={["txtFileName"]:ib.a.jG(v.AFrameworkApplication.$t.nx),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,O)};this.qj(CommonUIStrings.l_SaveToOneDrive,Object(r.a)(this,this.KIc,"fileNameDialogHandler"),n);m.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}KIc(n,O){1!==n?
m.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(n=O.txtFileName.trim(),m.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),O=ib.a.nV(v.AFrameworkApplication.fileName),n&&""!==n&&""!==O&&(n+=O),this.ARb.a$(this.lrc,this.Wna,n,this.Vk))}}Object(h.a)(Ma,"FileNameDialog",be.a,[1229]);class hb{constructor(n,O,ha){this.Da=n;this.B$=O;this.ARb=ha}create(n){return new Ma(this.Da,this.B$,this.ARb,n)}}Object(h.a)(hb,"FileNameDialogFactory",
null,[1196]);class ub extends Ca.StandardDialog{constructor(n){super();this.vd=1;this.Pe(1,CommonUIStrings.l_RetryButtonLabel);this.Pe(0,CommonUIStrings.l_DialogClose);this.Da=n}Iu(n){m.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",n);this.Sx(n,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(r.a)(this,this.bFe,"retryDialogHandler"))}bFe(n){1===n?(m.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Da.processAction(G.a.Hic,2)):
m.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(h.a)(ub,"RetryDialog",Ca.StandardDialog,[1195]);class na extends se{constructor(n,O,ha,Aa){super(n,O,ha,Aa);this.WPh=O}rvb(){return this.mb.ka("SaveACopyBrsIsEnabled")}q5f(){return G.a.Hic}VBc(){cc.a.Xbd(Object(r.a)(this,this.Igh,"saveToCloudActionDispatcher"));cc.a.dYb([new wi.a(G.a.Hic,H.a.frame,0)],this.WPh.gsb())}e$g(){m.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(h.a)(na,
"SaveACopyActor",se,[]);class Pa extends Rh{constructor(n,O,ha,Aa,La,Bb,Wb){super(O,ha,Aa,La,Bb,Wb);this.bKh=n}onSuccess(n){n&&n.data&&n.data.folders?(m.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.bKh.create(this.Vk).uha(n.data.folders[0].id,n.data.folders[0].name,n.data.folders[0].urls.viewInBrowser)):(m.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.Ns())}Tz(n){n&&n.error&&"user_canceled"===n.error.code&&m.ULS.sendTraceTag(7205457,
216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.Tz(n)}Ns(){m.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.Ns()}}Object(h.a)(Pa,"SaveACopyManager",Rh,[]);class cb extends Gj{constructor(n,O,ha,Aa,La,Bb){super(O,ha,Aa,La,Bb);this.Da=n}n$d(){return!!this.Vk&&!!this.Vk.SaveEntryPoint&&"VersionHistory"===this.Vk.SaveEntryPoint.toString()}AX(){m.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.n$d()&&this.Da.Ma(G.a.mEe,2,{["FailureReason"]:"Unknown"});
super.AX()}Wdb(){m.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.n$d()&&this.Da.processAction(G.a.Zcd,2);super.Wdb()}Vdb(n){m.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",n);this.n$d()&&this.Da.processAction(G.a.Zcd,2);super.Vdb(n)}Y1(){this.Vk&&"true"===this.Vk.SkipSaveToHost?super.Y1():32!==this.Da.processAction(G.a.fXa,1)?(m.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),
super.Y1()):this.Da.Ma(G.a.fXa,2,[()=>{m.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Gj.prototype.Y1.call(this)},()=>{m.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.AX()}])}}Object(h.a)(cb,"SaveACopyUploadToCloudManager",Gj,[]);class R{constructor(){this.Ea=null}get name(){return"Common.App.SaveACopy"}init(){v.AFrameworkApplication.fa.gf(Object(r.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){v.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")&&
this.Ea.resolve("Common.App.SaveACopy.SaveACopyActor").wb()}dispose(){}Yb(n){this.Ea=n;this.Ea.register(cb,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").na(()=>new cb(v.AFrameworkApplication.Va,n.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Ag.a).create(),()=>new ub(v.AFrameworkApplication.Va),v.AFrameworkApplication.Ba,v.AFrameworkApplication.Ba.aU)).ma();this.Ea.register(hb,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").na(()=>
new hb(v.AFrameworkApplication.Va,v.AFrameworkApplication.Ba.jb,n.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ma();this.Ea.register(na,"Common.App.SaveACopy.SaveACopyActor").na(()=>new na(n.resolve("Common.App.SaveACopy.SaveACopyManager"),n.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Ba.aU)).ma();this.Ea.register(Pa,"Common.App.SaveACopy.SaveACopyManager").na(()=>new Pa(n.resolve("Common.App.SaveACopy.FileNameDialogFactory"),
n.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Fi.a.instance,n.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.QOa,()=>new ub(v.AFrameworkApplication.Va))).ma()}static main(){e.a.instance.Ec(new R)}}Object(h.a)(R,"PackageManager",null,[2,3]);var ta=d(418);class Ra{constructor(n){this.ZIg=null;m.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.b$b=v.AFrameworkApplication.fa.Ia("PhoneLinkServiceEndpoint");
(this.dL=n)||m.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.b$b&&this.b$b.length||m.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}xOi(n){n&&(this.b$b="https://dcg-df.microsoft.com/",m.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.wOi()}wOi(){m.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.ZIg)m.ULS.sendTraceTag(527574722,
306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.ZIg=new Date;var n=new Date;this.dL.p0("BayBridge",this.b$b).then(O=>{const ha=+new Date-+n;O.IsSuccess?(m.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",ha),this.qOi(O.Token,this.dWi())):m.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
ha,O.ErrorCode,O.ErrorMessage)}).catch(O=>{m.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",O,+new Date-+n)})}}qOi(n,O){const ha={};ha.Authorization="Bearer "+n;ha["Authorization-Type"]="AAD";ha.Accept="application/json";ha["DCG-SessionId"]=v.AFrameworkApplication.userSessionId;v.AFrameworkApplication.Be.Jj(O,1,null,ha,!1,2,Object(r.a)(this,this.Mbj,"getStatusSucceeded"),Object(r.a)(this,this.Kbj,"getStatusFailed"),null,void 0,void 0,
void 0,void 0,"39");Jb.a("FetchAccountLinkedStatus")}dXi(){const n=ta.a.instance.getItem("AccountLinkedStatusCache");return n&&n.length?"true"===n.toLowerCase()?!0:!1:!1}dWi(){return this.b$b+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}Kbj(){m.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}Mbj(n){m.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");n=ef.a(n.data.je).state+"";ta.a.instance.setItem("AccountLinkedStatusCache",
n)}}Object(h.a)(Ra,"PhoneLinkManager",null,[971]);class nb{constructor(){this.Ea=null}get name(){return"Common.App.PhoneLink"}Yb(n){this.Ea=n;this.Ea.register(971,"Common.App.PhoneLink.IPhoneLinkManager").ma().na(()=>new Ra(this.Ea.resolve("Common.App.OAuth.IOAuthManager")))}init(){v.AFrameworkApplication.fa.gf(()=>{this.BCa()})}BCa(){this.Ea.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){e.a.instance.Ec(new nb)}}Object(h.a)(nb,"PhoneLinkPackage",null,[2,3]);var Cb;(function(n){n[n.myFiles=
0]="myFiles";n[n.recent=1]="recent";n[n.currentFolder=2]="currentFolder";n[n.yourPhone=3]="yourPhone"})(Cb||(Cb={}));Object(h.b)("SharedFilePickerLandingLocation",Cb);class mc{constructor(n){this.m7a=this.wDb=null;this._initialized=!1;this.k4d=n}gTd(n){this._initialized||(n.Qt(Xf.a.S9g),n.cB(Xf.a.S9g,Object(r.a)(this,this.zkk,"onReceivedPickerResponse")),this._initialized=!0)}AYd(n){return this.m7a=new Promise((O,ha)=>{const Aa={};Aa[Ld.a.wsk]=n;this.wDb=(La,Bb)=>{""===Bb?(m.ULS.sendTraceTag(572548163,
306,50,"Resolving Promise with Picker Data"),O(La)):("Canceled"===Bb?m.ULS.sendTraceTag(572548164,306,50,Bb):m.ULS.sendTraceTag(556901065,306,10,Bb),ha(Bb))};this.k4d.execute(La=>{this.gTd(La);La.sendMessage(Xf.a.bok,Aa)})})}zkk(n){this.wDb(n.Values[Ld.a.GWk],void 0===n.Values[Ld.a.Exe]||null===n.Values[Ld.a.Exe]?"":n.Values[Ld.a.Exe])}z$d(){return v.AFrameworkApplication.fa.ka("UiHostCommonFilePicker")}xOd(n,O,ha,Aa,La,Bb,Wb,uc,Vc=null){const bd={};bd[Ld.a.rWk]=n;bd[Ld.a.titleText]=O;bd[Ld.a.w6h]=
ha;bd[Ld.a.x6h]=Aa;bd[Ld.a.y6h]=La;bd[Ld.a.pFi]=!0;bd[Ld.a.ROi]=Bb;bd[Ld.a.zsk]=Wb;bd[Ld.a.ysk]=Cb[uc];sc.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(bd[Ld.a.Ask]="Dark");Vc&&(null!=Vc.Xmb&&(bd[Ld.a.Xmb]=Vc.Xmb),null!=Vc.ttb&&(bd[Ld.a.ttb]=Vc.ttb));return bd}}Object(h.a)(mc,"SharedFilePickerManager",null,[993]);class Sc{constructor(){this.Ea=null}get name(){return"Common.App.SharedFilePicker"}Yb(n){this.Ea=n;n.register(mc,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ma().na(()=>
new mc(n.Oa("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa.gf(()=>{this.BCa()})}BCa(){this.Ea.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){e.a.instance.Ec(new Sc)}}Object(h.a)(Sc,"SharedFilePickerPackage",null,[2,3]);class jd{constructor(n,O=3E4){this.qkl=9E5;this.ukl=1E4;this.xCg=this.Iyb=null;this.Nde=0;this.LWb=Date.now;this.wNc=n;this.gkd=O;this.lKc()}leg(n=!0){const O=this.LWb();if(O<this.Nde+this.qkl)return O>this.Nde+this.ukl&&this.lKc(),
this.xCg;n&&this.lKc();return null}getToken(n=!0){return(n=this.leg(n))?Promise.resolve(n):this.lKc()}lKc(){return this.Iyb=this.Iyb||new Promise(n=>{this.wNc().then(O=>{this.Iyb=null;""!==O&&O&&(this.xCg=O,this.Nde=this.LWb(),n(O));n(null)}).catch(()=>{this.Iyb=null;n(null)});window.setTimeout(()=>{this.Iyb=null;n(null)},this.gkd)})}}Object(h.a)(jd,"OAuthCacheManager",null,[]);var Ad=d(114),ve=d(67);class Ae{static $Wd(n){return""!==n&&n?Ae.Y6h[n.toLowerCase()]:""}static Odj(n,O){const ha=Date.now();
var Aa=Ae.TDc();const La=v.AFrameworkApplication.fa.Ia("UserPrincipalName"),Bb=Ae.$Wd(n);m.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+n);if(""===La||!La)return m.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===Bb||!Bb)return m.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+n),Promise.resolve("");const Wb=Ad.a.create().toString();Aa=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none",
"https://login.microsoftonline.com",Bb,encodeURIComponent(O),encodeURIComponent(La),encodeURIComponent(Aa),Wb);const uc=document.createElement("iframe");uc.style.display="none";uc.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");uc.src=Aa;document.body.appendChild(uc);return new Promise(Vc=>{Ae.Vak(uc.contentWindow).then(bd=>{document.body.removeChild(uc);const xd=new ve.a,xe=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let wf;for(;wf=xe.exec(bd);)3!==wf.length&&(m.ULS.sendTraceTag(593862983,
1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",wf.length),Vc("")),xd.$(wf[1],wf[2]);xd.Kb("access_token")?(m.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",O,n,Date.now()-ha),Vc(xd.ga("access_token"))):(m.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",O,n,(Date.now()-ha).toString()),Vc(""))}).catch(bd=>{try{document.body.removeChild(uc)}catch(xd){}m.ULS.sendTraceTag(593862980,
1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",O,n,JSON.stringify(bd),(Date.now()-ha).toString());Vc("")})})}static TDc(){const n=window.location.protocol,O=window.location.host;var ha=v.AFrameworkApplication.fa.Ia("OAuthManagerHostPathOverride");if(void 0===ha||null===ha){ha=window.location.pathname;const Aa=ha.lastIndexOf("/");ha=0<=Aa?ha.substring(0,Aa+1):""}return n+"//"+O+ha+"WacOAuth.html"}static Vak(n){return new Promise((O,ha)=>{let Aa=0,La=0;La=window.setInterval(()=>
{if(200<Aa++)window.clearInterval(La),ha("Exceeded 10000ms timeout after 200 polls");else{var Bb=null,Wb=null;try{if(!n||n.closed){window.clearInterval(La);ha("Window or Frame is closed before completion");return}Bb=n.location.href;Wb=n.location.hash}catch(uc){}Bb&&"about:blank"!==Bb&&Wb&&""!==Wb&&(window.clearInterval(La),O(Wb))}},50)})}}Ae.Y6h={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(h.a)(Ae,"OAuthHelper",null,[]);class Ue{constructor(n,
O){this.token=n;this.source=O}}Object(h.a)(Ue,"TokenResult",null,[]);class mg{constructor(){this.dL=null;this.L0e={};this.iIb=new qc.a(Lc.a.rt())}getToken(n,O,ha=!1){if(this.iIb.Kb(O))return this.iIb.ga(O).getToken();const Aa=new jd(()=>ha?this.meg(n,O):this.wNc(n,O));this.iIb.$(O,Aa);return Aa.getToken()}Mdj(n,O,ha=!1){if(this.iIb.Kb(O))return this.iIb.ga(O).leg();const Aa=new jd(()=>ha?this.meg(n,O):this.wNc(n,O));this.iIb.$(O,Aa);return null}wNc(n,O){const ha=Date.now();return Ae.Odj(n,O).then(Aa=>
new Ue(Aa,"SSOStack")).then(Aa=>new Promise(La=>{Aa.token&&""!==Aa.token?(m.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",n,Aa.source,Date.now()-ha),this.qXa("GetTokenInternal",!0,Date.now()-ha,n,"","",O),La(Aa.token)):(m.ULS.sendTraceTag(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",n,Date.now()-ha),this.qXa("GetTokenInternal",!1,Date.now()-ha,n,"GetTokenSilent Failed","SSO Token provider failed!",O),La(""))}))}meg(n,O){if(!this.dL)try{this.dL=
u.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ha){m.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+ha)}return this.dL?new Promise(ha=>{const Aa=Date.now();this.dL.p0(n,O).then(La=>{const Bb=La.Token;!La.IsSuccess||this.MMj(Bb)?(this.qXa("GetTokenInternalImplicitJS",!1,Date.now()-Aa,n,La.ErrorCode,La.ErrorMessage,O),ha(null)):(this.qXa("GetTokenInternalImplicitJS",!0,Date.now()-Aa,n,La.ErrorCode,La.ErrorMessage,O),ha(Bb))}).catch(La=>{La=La?ef.c(La):"";this.qXa("GetTokenInternalImplicitJS",
!1,Date.now()-Aa,n,"Caught Exception",La,O);ha(null)})}):new Promise(ha=>{this.qXa("GetTokenInternalImplicitJS",!1,0,n,"Null OAuthManager","OAuthManager not set");ha(null)})}qXa(n,O,ha,Aa,La="",Bb="",Wb=""){var uc="Search"===Aa;const Vc=[];n=Mg.a.a7(uc?"Event":"EventName",n,2);Aa=Mg.a.a7("AppName",Aa,2);Array.add(Vc,n);Array.add(Vc,Aa);uc&&(Aa=Mg.a.a7("LatencyType","FetchToken",2),Array.add(Vc,Aa));La&&""!==La&&(La=Mg.a.a7("ErrorCode",La,2),Array.add(Vc,La));Bb&&""!==Bb&&(Bb=Mg.a.a7("ErrorMessage",
Bb,2),Array.add(Vc,Bb));Wb&&""!==Wb&&(Bb=!(Wb in this.L0e),this.L0e[Wb]=Bb,Bb=Mg.a.a7("WarmUpCall",Bb.toString(),1),Array.add(Vc,Bb),Wb=Mg.a.a7("Service",this.ZMc(Wb),2),Array.add(Vc,Wb));uc=uc?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";O=Object.assign(new ee.a,{name:uc,samplingPolicy:2,dataFields:Vc,succeeded:O,durationMs:ha});x.a.sendActivityEvent(O)}ZMc(n){return n===v.AFrameworkApplication.yce?"Loki":n===v.AFrameworkApplication.uNe?"Substrate":v.AFrameworkApplication.fa&&
n===v.AFrameworkApplication.fa.Ia("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}MMj(n){return!n||!n.length}}Object(h.a)(mg,"SearchOAuthManager",null,[969]);class ki{constructor(){this.Ea=null}get name(){return"Common.App.SearchOAuthManager"}Yb(n){this.Ea=n;this.Ea.register(969,"Common.App.SearchCommon.ISearchOAuthManager").ma().na(()=>new mg)}init(){}dispose(){}static main(){e.a.instance.Ec(new ki)}}Object(h.a)(ki,"SearchOAuthPackage",null,[2,3]);var di;(function(n){n[n.generalException=
0]="generalException";n[n.invalidArgument=1]="invalidArgument";n[n.notAllowed=2]="notAllowed";n[n.apiNotAvailable=3]="apiNotAvailable";n[n.unresolvedPendingRequest=4]="unresolvedPendingRequest";n[n.timeout=5]="timeout";n[n.adalTimeout=6]="adalTimeout";n[n.userNotSignedIn=7]="userNotSignedIn";n[n.userAborted=8]="userAborted";n[n.silentSignInFailed=9]="silentSignInFailed";n[n.invalidResourceUrl=10]="invalidResourceUrl";n[n.invalidGrant=11]="invalidGrant";n[n.connectionLost=12]="connectionLost";n[n.clientError=
13]="clientError";n[n.serverError=14]="serverError"})(di||(di={}));Object(h.b)("ErrorCodes",di);class lk{}Object(h.a)(lk,"HostApplicationType",null,[]);class Rf{constructor(n,O){this.requestCallback=this.requestParameters=null;this.requestParameters=n;this.requestCallback=O}}Object(h.a)(Rf,"OutstandingRequest",null,[]);class Kd{}Kd.Eck="AADSTS50058";Kd.invalidResourceUrl="AADSTS50001";Kd.yck="AADSTS65001";Kd.Qck="AADSTS70011";Kd.userAborted="13002";Kd.uuk="Popup Window is null";Kd.tuk="Popup Window closed";
Kd.adalTimeout="Token renewal operation failed due to timeout";Kd.vkl="tokenRevoked";Object(h.a)(Kd,"WopiHostErrorType",null,[]);var Ql=d(259),Uj=d(336),fm=d(1093);class Ij{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(h.a)(Ij,"WopiIdentityInfo",null,[1013]);class Nm{constructor(n,O,ha){this.expiration=this.authority=this.accessToken=null;this.accessToken=n;this.authority=O;this.expiration=ha}}Object(h.a)(Nm,"WopiIdentityToken",
null,[1012]);class jf{constructor(n){this._initialized=!1;this.oCb={};this.did={};this.b$=v.AFrameworkApplication.Ba.aU;this.k4d=n}gTd(n){this._initialized||(n.Qt(Xf.a.a4g),n.cB(Xf.a.a4g,Object(r.a)(this,this.xkk,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(n,O,ha=null){this.bWj(n,O);return new Promise((Aa,La)=>{if(this.d7d(O))if(O in this.oCb)La("unresolvedPendingRequest");else{var Bb=window.setTimeout(()=>{m.ULS.sendTraceTag(37856032,344,10,ef.c({["error"]:"Request timeout.",["callerId"]:O}));
La("timeout")},12E4);this.LWd(n,O,ha,(Wb,uc)=>{window.clearTimeout(Bb);Wb?Aa(Wb):(m.ULS.sendTraceTag(37856033,369,15,ef.c({["error"]:di[uc]})),La(uc))})}else m.ULS.sendTraceTag(37856034,344,10,ef.c({["error"]:"Caller is not allowed."})),La("notAllowed")})}getPrimaryIdentityInfo(n){return new Promise((O,ha)=>{this.d7d(n)?this.k8i((Aa,La)=>{Aa?O(Aa):(m.ULS.sendTraceTag(37856064,369,10,ef.c({["error"]:La.toString()})),ha(La))}):(m.ULS.sendTraceTag(37856065,344,10,ef.c({["error"]:"Caller is not allowed."})),
ha("notAllowed"))})}getAuthContext(n){return new Promise((O,ha)=>{const Aa=this.getAuthContextSync(n);Aa?O(Aa):ha("notAllowed")})}getAuthContextSync(n){if(this.d7d(n)){const O=new fm.a;O.upn=v.AFrameworkApplication.fa.Ia("UserPrincipalName");O.userId=v.AFrameworkApplication.fa.Ia("LoggableUserId");O.authority=v.AFrameworkApplication.fa.Ia("HostAuthAuthority");O.tenantId=v.AFrameworkApplication.fa.Ia("TenantId");O.isAnonymous=v.AFrameworkApplication.fa.ka("IsAnonymousUser");O.supportsAuthToken=this.Mqj(n);
n=v.AFrameworkApplication.fa.Ia("HostAuthType");O.authorityType="aad"===n.toLowerCase()?2:"msa"===n.toLowerCase()?1:0;return O}m.ULS.sendTraceTag(40751647,344,10,ef.c({["error"]:"Caller is not allowed."}));return null}Mqj(n){const O=Ql.a.l7a;return Ic.a.yDa?O&&Ql.a.huh?Array.contains(Ql.a.huh,n.toLowerCase()):!1:O}LWd(n,O,ha,Aa){var La=[];Array.add(La,Object.assign(new E.a,{name:"CallerId",string:O}));Array.add(La,Object.assign(new E.a,{name:Ld.a.AMe,string:n.correlationId}));x.a.sendTelemetryEvent(Object.assign(new I.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:La}));La=Uj.a.create().toString();const Bb="getAccessToken_"+La,Wb=this.b$.wi("ComponentAttach",Bb);this.did[Bb]=Wb;const uc={};uc[Ld.a.BMe]=La;uc[Ld.a.Fdl]=n.resource;uc[Ld.a.Gdl]=n.scope;uc[Ld.a.arh]=v.AFrameworkApplication.fa.Ia("HostAuthType");uc[Ld.a.Jdl]=v.AFrameworkApplication.fa.Ia("UserPrincipalName");uc[Ld.a.Hdl]=n.silentLogin;uc[Ld.a.Cdl]=n.options;uc[Ld.a.AMe]=n.correlationId;uc[Ld.a.Ddl]=O;ha&&(uc[Ld.a.addinName]=
ha.AddinName,uc[Ld.a.Bdl]=ha.AddinTrustId);this.k4d.execute(Vc=>{this.gTd(Vc);Vc.sendMessage(Xf.a.getAuthToken,uc)});this.oCb[La]=new Rf(n,Aa)}k8i(n){const O=v.AFrameworkApplication.fa.Ia("UserName"),ha=v.AFrameworkApplication.fa.Ia("UserPrincipalName"),Aa=v.AFrameworkApplication.fa.Ia("LoggableUserIdSpace"),La=new Ij;La.email=ha;La.displayName=O;switch(Aa){case "OrgIdPuid":La.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":La.authority="MicrosoftAccount";break;default:La.authority=
Aa}n(La,null)}xkk(n){let O=null;try{let Aa=n.Values[Ld.a.BMe];const La=n.Values[Ld.a.Adl],Bb=n.Values[Ld.a.arh],Wb=n.Values[Ld.a.Idl];let uc=null,Vc=null;const bd=this.oCb[Aa];if("undefined"!==typeof bd&&bd){var ha=[];Array.add(ha,Object.assign(new E.a,{name:Ld.a.AMe,string:bd.requestParameters.correlationId}));x.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:ha}));O=bd.requestCallback;delete this.oCb[Aa];"undefined"!==
typeof La&&La&&La.length?Vc=new Nm(La,Bb,Wb):uc=di[this.d9j(n)];ha="getAccessToken_"+Aa;ha in this.did&&(this.did[ha].stop(),delete this.did[ha]);O(Vc,uc)}else m.ULS.sendTraceTag(37856066,344,10,ef.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Aa}))}catch(Aa){n=n.Values[Ld.a.BMe],n in this.oCb&&delete this.oCb[n],this.rVc(),m.ULS.sendTraceTag(37856067,344,10,ef.c({["error"]:Aa.message,["stack"]:Aa.stack})),O&&O(null,"generalException")}}d7d(n){var O=v.AFrameworkApplication.fgj();
n=n.toLowerCase();for(const ha of O)if(n===ha.toLowerCase())return!0;O=Ql.a.nHd;for(let ha in O)if(n===O[ha].toLowerCase())return!0;return!1}d9j(n){n=n.Values[Ld.a.Edl];this.rVc();m.ULS.sendTraceTag(39068821,344,15,ef.c({["error"]:n}));return n?-1<n.indexOf(Kd.Eck)?9:-1<n.indexOf(Kd.uuk)||-1<n.indexOf(Kd.tuk)?12:-1<n.indexOf(Kd.invalidResourceUrl)?10:-1<n.indexOf(Kd.userAborted)?8:-1<n.indexOf(Kd.Qck)||-1<n.indexOf(Kd.yck)||n===Kd.vkl?11:-1<n.indexOf(Kd.adalTimeout)?6:0:13}bWj(n,O){n=this.eHk(n.resource);
m.ULS.sendTraceTag(39921882,344,50,ef.c({["callerId"]:O,["resource"]:n}))}rVc(){m.ULS.sendTraceTag(39068822,344,50,ef.c({["userAgent"]:window.navigator.userAgent}))}eHk(n){return(n?n:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(h.a)(jf,"WopiIdentityManager",null,[992]);class Hf{constructor(){this.Ea=null}get name(){return"Common.App.WopiIdentity"}Yb(n){this.Ea=n;n.register(jf,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ma().na(()=>
new jf(n.Oa("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.gf(Object(r.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){try{this.Ea.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(n){m.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+n)}}dispose(){}static main(){e.a.instance.Ec(new Hf)}}Object(h.a)(Hf,"WopiIdentityPackage",null,[2,3]);var rj=d(652);class Om extends rj.a{constructor(n,O){super(n,Yc.a.hS(O))}Jva(n,
O){this.isEnabled()&&this.Myc(this.OIa)&&(this.Qt(n),this.cB(n,O))}}Object(h.a)(Om,"InsertMediaCrossDocumentMessenger",rj.a,[1249,671,109]);class gm{getInstance(n,O){return new Om(n,O)}}Object(h.a)(gm,"InsertMediaCrossDocumentMessengerFactory",null,[1228]);class sj{constructor(n,O,ha){this.correlationId=null;this.Y3=0;this.insertPictureTelemetryEndpoint=null;this.aRd=0;this.rLh=n;this.xRb=[];this.pLh=O;this.Dvf=ha.split(";")}NGb(n,O){Array.clear(this.xRb);n=this.rLh.value;n.ypl(O.ftb);n.Myc(this.pLh);
n.Qt(O.ftb);n.cB(O.ftb,ha=>{this.Yue(ha,O)});m.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");n.sendMessage(O.NSf,{["FileExtensionFilterList"]:this.Dvf})}I0h(n){Array.contains(this.xRb,n)||Array.add(this.xRb,n)}Yue(n,O){m.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");n=O.j2g(n);const ha=[];for(let Aa=0;Aa<n.length;Aa++){const La=n[Aa];O.ORc(La,this.Dvf)?Array.add(ha,La):this.I0h(O.Wbg(La))}ha&&
ha.length?O.Rra(ha):m.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.xRb.length&&(O=this.xRb.join(", "),m.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",O),this.Pal(O))}Pal(n){const O=new Ca.StandardDialog;O.vd=0;O.nO(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,n),null)}dispose(){}}Object(h.a)(sj,"InsertMediaFromHostManager",
null,[994,109]);class Rl{constructor(n){this.ULh=n}getInstance(){return this.ULh}}Object(h.a)(Rl,"InsertMediaFromHostManagerFactory",null,[1226,1227]);class Dl{constructor(){this.bMb=document.createElement("iframe");this.bMb.src="about:blank";this.bMb.style.visibility="hidden";this.bMb.style.position="absolute";this.bMb.style.zIndex="-100"}get g5a(){return this.bMb}}Object(h.a)(Dl,"InsertMediaFromHostOneDriveHostFrame",null,[1223]);class Pm extends rj.a{constructor(n,O){super(n,"*"===O?O:Yc.a.hS(O));
this.Lzf(Xf.a.insertImage);this.Lzf(Xf.a.X5d)}reportDocumentLoadedTime(){}}Object(h.a)(Pm,"InsertMediaFromOneDriveCrossDocumentMessenger",rj.a,[672,671,109]);var hl=d(267),Tk=d(528);class de{nAc(n){switch(n){case 1:n=8;break;case 4:n=3;break;case 2:n=0;break;default:n=0}return n}Mci(n,O){return String.format(O,this.nAc(n))}Lci(n,O,ha,Aa,La,Bb,Wb){n=this.nAc(n);const uc=hl.a.re(v.AFrameworkApplication.lcid).name,Vc=v.AFrameworkApplication.buildVersion;v.AFrameworkApplication.M5b("ShIns226;ShIns226cf");
return String.format(O,v.AFrameworkApplication.lcid,uc,Vc,La,n,Bb,ha,Aa,Wb)}Oci(n,O){n=this.nAc(n);const ha=v.AFrameworkApplication.buildVersion,Aa=0<ha.indexOf(".")?ha.substring(0,ha.indexOf(".")):"16";return String.format(O,v.AFrameworkApplication.lcid,v.AFrameworkApplication.lcid,v.AFrameworkApplication.lcid,n,Aa,ha,"Video",0,0)}Nci(n,O,ha,Aa,La){const Bb=hl.a.re(v.AFrameworkApplication.lcid).name;n=String.format(O,v.AFrameworkApplication.lcid,Bb,v.AFrameworkApplication.buildVersion,ha,this.nAc(n),
Aa);La&&(n+="&flipgrid=1");return n}l2g(n){if(!n||!n.Values)return null;n=n.Values;if(!n)return null;let O="";"sourceProvider"in n&&(O=n.sourceProvider||"");return Object.assign(new Tk.a,{Action:n.action||"",Caption:n.caption||"",ContentType:n.contentType||"",Type:n.extension||"",PageUrl:n.pageUrl||"",OriginalUrl:n.sourceUrl||"",ContentProvider:O,ThumbnailUrl:n.thumbnailUrl||"",LicenseUrl:n.licenseUrl||"",LicenseDisplayName:n.licenseDisplayName||"",Height:n.height||0,Width:n.width||0,SvgContent:n.svgContent||
"",Description:n.description||""})}Oqk(n){const O=[];if(!n||!n.Values||!n.Values.Items)return O;n=n.Values.Items;for(let Aa=0;Aa<n.length;Aa++){var ha=n[Aa];ha&&(ha=Object.assign(new Tk.a,{Type:ha.Extension||"",OriginalUrl:ha.SourceUrl||"",Caption:ha.caption,Description:ha.description||"",Height:ha.Height||0,Width:ha.Width||0}),Array.add(O,ha))}return O}ORc(n,O){if(!n)return!1;for(let ha=0;ha<O.length;ha++)if(0<=n.toLowerCase().indexOf(O[ha]))return!0;return!1}Ywk(n){let O="";if(n)for(let ha=0;ha<
n.length;ha++){const Aa=n[ha];Aa&&(O+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',Aa.OriginalUrl,Aa.Width,Aa.Height))}return O}hfj(n){return(n=de.RTk.exec(n))&&2<n.length?n[2].trim():""}}de.RTk=RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im");Object(h.a)(de,"InsertMediaHelper",null,[980]);var Nf=d(32);class vm{constructor(n){this.hNb=Nf.a.insertHyperlink;this.Da=n}get BA(){return this.hNb}set BA(n){this.hNb=n}Rra(n){try{m.ULS.sendTraceTag(21612191,352,50,
"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",n.length);for(let O=0;O<n.length;O++)this.Da.Ma(this.BA,2,n[O]);m.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",n.length)}catch(O){m.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",O.toString())}}}Object(h.a)(vm,"InsertOneDriveFileHandler",null,[979]);class Uk extends vm{constructor(n){super(n)}get NSf(){return Xf.a.X5d}get ftb(){return Xf.a.ixj}j2g(n){return n&&
n.Values&&"Items"in n.Values?n.Values.Items:null}Wbg(){Q.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}ORc(){return!0}j6g(n,O,ha){n=ha(n);n.length&&(ha={},ha.Items=n,O.sendMessage(this.ftb,ha))}k2g(n){const O=[];for(let ha=0;ha<n.data.value.length;ha++){const Aa=n.data.value[ha];if(Aa){const La={};La.DisplayText=Aa.name;La.Url=Aa.urls.download;La.sourceUrl=Aa.urls.download;La.caption=Aa.name;Array.add(O,La)}}return O}}
Object(h.a)(Uk,"InsertOneDriveFileHelper",vm,[978,979]);class El extends be.a{constructor(){super()}tLe(){this.hqc="FilePickerDialog";this.Wf="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this.kg="PickerDialog-Livebooks";this.showDialog("",null)}D_d(){return document.getElementById("OpenFilePickerDiv")}AF(){}Yla(){}}Object(h.a)(El,"PickerDialog",be.a,[1E3]);class Jj{constructor(n,O,ha){this.Nn=this.Sfa=null;this.A_a=n;this.nzd=ha;this.wfa=new gb.a(()=>new lf.a(O.value,Object(r.a)(this,
this.WBa,"getMoreInfoEventReceived")))}get kCb(){this.Sfa||(this.wfa.value.zba("InsertFromOneDrive",!0),this.Nn&&this.Nn.AQ&&this.Nn.AQ.length&&(this.Sfa=this.k_d(this.Nn.AQ)));return this.Sfa}k_d(n){n=n.toLowerCase();n.endsWith("/")||(n+="/");const O=n.indexOf("/documents/");return-1!==O?n.substring(0,O+1)+"_layouts/15/onedrive.aspx":""}WBa(n){this.Nn||3!==n.state||(this.Nn=n)}start(n){if(!this.kCb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.Sfa=
v.AFrameworkApplication.breadcrumbFolderUrl;else{m.ULS.sendTraceTag(26071185,352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Nn);return}const O=new El;O.tLe();const ha=O.D_d();ha?this.A_a.start((Aa,La)=>{O.hide();this.sDb(Aa,La,n)},()=>{this.aue(O)},ha,this.Sfa):m.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")}aue(n){n.hide();m.ULS.sendTraceTag(26071187,352,50,
"User cancelled to insert picture from onedrive.")}sDb(n,O,ha){m.ULS.sendTraceTag(26071188,352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",n);n&&O&&O.data&&O.data.value&&0<O.data.value.length?(n=this.nzd.getInstance(window.frames[0].parent,window.document.URL),ha.j6g(O,n,Object(r.a)(ha,ha.k2g,"parseOneDriveV7Response"))):m.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}}Object(h.a)(Jj,
"OneDriveFilePickerHelperV7",null,[975,976]);class Kj{constructor(n,O,ha,Aa){this.ia=O;this.la=n;this.s8=this.la.Sra;this.pca=ha;this.qBg=Aa}get ER(){return this.qBg?this.qBg.instance:null}wb(){this.ia.ra(G.a.RUc,yb.a.application,Object(r.a)(this,this.hJa,"triggerCommandforAddinCommands"),4);this.ia.ra(G.a.w2a,yb.a.application,Object(r.a)(this,this.hJa,"triggerCommandforAddinCommands"),4);this.ia.ra(G.a.oCe,yb.a.application,Object(r.a)(this,this.hJa,"triggerCommandforAddinCommands"),4);this.ia.ra(G.a.Ifc,
yb.a.application,Object(r.a)(this,this.Ifc,"queryAddInCommandsLoadStatus"),96);this.ia.ya(G.a.noh,yb.a.application,Object(r.a)(this,this.hJa,"triggerCommandforAddinCommands"));this.ia.ra(G.a.MEb,yb.a.application,Object(r.a)(this,this.hJa,"triggerCommandforAddinCommands"),64);this.ia.ya(G.a.ykc,yb.a.application,Object(r.a)(this,this.hJa,"triggerCommandforAddinCommands"));this.ia.ra(G.a.G1b,yb.a.application,Object(r.a)(this,this.hJa,"triggerCommandforAddinCommands"),64);this.ia.ya(G.a.HGb,yb.a.application,
Object(r.a)(this,this.hJa,"triggerCommandforAddinCommands"));this.ia.ya(G.a.uYb,yb.a.application,Object(r.a)(this,this.hJa,"triggerCommandforAddinCommands"))}Fe(){}hJa(n,O,ha,Aa,La){if(!this.s8)return 16;if(1===ha)return O=n===G.a.w2a&&(!this.ER||!this.ER.ghj(La)),n=n===G.a.w2a&&!!this.ER&&this.ER.i6k(La),O||n?8:32;if(this.ER)switch(n){case G.a.RUc:this.ER.SUc(La);break;case G.a.w2a:this.ER.$0b(La);break;case G.a.Ifc:this.ER.Q6g(La);break;case G.a.noh:this.ER.Z8k();break;case G.a.MEb:this.ER.MEb(La);
break;case G.a.oCe:this.ER.gHk();break;case G.a.ykc:this.ER.ykc(La);break;case G.a.G1b:this.ER.G1b(La);break;case G.a.HGb:this.ER.HGb(La);break;case G.a.uYb:this.ER.uYb(La)}else this.pca.w3a(),this.pca.Qyc(n,La);return 32}Ifc(n,O,ha,Aa,La){if(!this.s8)return 16;this.ER&&this.ER.Q6g(La);return 32}}Object(h.a)(Kj,"AddinCommandsActor",null,[234]);class Hi{}Hi.taskPaneWidth="TaskPaneWidth";Hi.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";Hi.ZT="TaskPaneTitle";Hi.bO="NonPersistedSettings";
Hi.onTaskPaneClose="OnTaskPaneClose";Hi.dva="OnRenderedCallback";Object(h.a)(Hi,"PropertyNames",null,[]);var xi=d(958),ni=d(230);class pg{}pg.TTd="extId";pg.aV="ComponentId";pg.twe="OptionalProps";Object(h.a)(pg,"ActionPropertyNames",null,[]);var ul=d(39),Rn=d(81);class ek{constructor(){this.idField=null;this.stateField=0}}Object(h.a)(ek,"CT_OsfBackgroundAppData",null,[]);class ln{constructor(){this.currentStoreTypeField=this.bkgdDataField=this.assetStoreIdField=this.assetIdField=this.appVersionField=
null;this.heightField=0;this.heightFieldSpecified=!1;this.idField=null;this.isAddinCommandsField=!1;this.storeIdField=null;this.widthField=this.targetTypeField=0;this.widthFieldSpecified=!1}}Object(h.a)(ln,"CT_OsfInsertionInfo",null,[]);var Fl=d(957),fk=d(959),Oi=d(323),xh=d(42);class mn{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe){this.FAc=0;this.Hhg=!1;this.la=n;this.s8=this.la.pptEditInsertAppsForOfficeEnabled;this.W_j=this.la.Sra;this.fv=O;this.ia=ha;this.Wb=Aa;this.ua=La;this.U_c=Wb;this.Jb=
Bb;this.pca=uc;this.Zd=Vc;this.Ib=bd;this.Df=xd;this.gl=xe}get KFf(){return this.s8&&v.AFrameworkApplication.ypa}wb(){this.ia.ra(Ab.a.Nlg,yb.a.application,Object(r.a)(this,this.Njj,"handleInsertAppForOffice"),516);this.ia.ra(Ab.a.dQc,yb.a.application,Object(r.a)(this,this.Ojj,"handleInsertAppForOfficeUpload"),4);this.ia.ya(Ab.a.$Oc,yb.a.application,Object(r.a)(this,this.xjj,"handleHideAppForOfficeTaskPane"));this.ia.ra(Ab.a.jeb,yb.a.application,Object(r.a)(this,this.nmj,"handleRenderAppForOfficeTaskPane"),
4);this.ia.ra(Ab.a.oWa,yb.a.application,Object(r.a)(this,this.oWa,"queryEntitledAppsForOffice"),96);this.ia.ya(Ab.a.pIa,yb.a.application,Object(r.a)(this,this.thg,"handleShowFirstPartyTaskPane"));this.ia.ya(Ab.a.fDc,yb.a.application,Object(r.a)(this,this.hij,"handleCloseAppsForOfficeTaskPane"));this.ia.ya(G.a.O9k,yb.a.application,Object(r.a)(this,this.Xmj,"handleShowExtensionTaskPane"));this.ia.ya(G.a.Cmi,yb.a.application,Object(r.a)(this,this.iij,"handleCloseExtensionTaskPane"));this.ia.ya(G.a.fSk,
yb.a.application,Object(r.a)(this,this.xmj,"handleRestartExtensionTaskPane"));this.ia.ya(Ab.a.kzh,yb.a.application,Object(r.a)(this,this.Knj,"handleUpdateBackgroundAppData"))}Fe(){}get Ce(){return this.Zd.instance}Xmj(n,O,ha,Aa,La){if(2!==ha)return 32;const Bb=La[pg.TTd];La=La[pg.twe];const Wb={};Wb.ZT=La.optionalProperties[Hi.ZT];Wb.assetId=Bb.getId();Wb.dva=La.optionalProperties[Hi.dva];Wb.bO=La.sVf;Wb.tnc=!0;return this.thg(n,O,ha,Aa,Wb)}iij(n,O,ha,Aa,La){if(2!==ha)return 32;n=La[pg.TTd];La=La[pg.twe];
O={};O.ZT=La.optionalProperties[Hi.ZT];O.assetId=n.getId();O.sourceLocationOverrideResourceId=La.optionalProperties[Hi.sourceLocationOverrideResourceId];O.dva=La.optionalProperties[Hi.dva];O.bO=La.sVf;O.tnc=!0;La=this.Ce.DZb(O);return(La=this.Ce.YY(La))&&this.Ce.oMd(La.instanceId)?32:8}xmj(n,O,ha,Aa,La){if(2!==ha)return 32;n=La[pg.TTd];O=La[pg.twe];La={};La.ZT=O.optionalProperties[Hi.ZT];La.assetId=n.getId();La.sourceLocationOverrideResourceId=O.optionalProperties[Hi.sourceLocationOverrideResourceId];
La.dva=O.optionalProperties[Hi.dva];La.bO=O.sVf;La.tnc=!0;n=this.Ce.DZb(La);return(n=this.Ce.YY(n))?(this.Ce.F$g(n.instanceId,La),32):8}Njj(n,O,ha,Aa,La){O=this.ua.Ca;Aa=this.Wb.Bf;if(!(this.s8&&O&&Aa)||this.Df.gd(O))return 8;if(!this.KFf)return m.ULS.sendTraceTag(571860047,802,50,"Web add-in insert blocked by doc IRM"),8;if(1===ha)return 32;this.Ce?this.Ce.launchInsertDialog():(this.pca.w3a(),this.pca.Qyc(n,La));return 32}Ojj(n,O,ha,Aa,La){if(!this.KFf)return m.ULS.sendTraceTag(571860048,802,50,
"Web add-in insert blocked by doc IRM"),16;if(!La)return 8;if(0===La.targetType)return this.zxj(La,n);if(1===La.targetType){if(this.Df.gd(this.Wb.Bf))return 16;this.W_j?La.isAddinCommands?xh.a("AddinCommandsActionTypeUndefinedCheck")?void 0===La.addinCommandsActionType||null===La.addinCommandsActionType||0===La.addinCommandsActionType?this.uIb(La):1===La.addinCommandsActionType?this.qQc(La):m.ULS.sendTraceTag(524118089,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+La.addinCommandsActionType.toString()):
0===La.addinCommandsActionType?this.uIb(La):1===La.addinCommandsActionType&&this.qQc(La):(n={},n.marketplaceId=La.solutionId,n.marketplaceVersion=La.version,n.storeType=La.storeType,n.storeId=La.storeId,n.targetData=La,this.Ce.Ko.isAddinCommandsAsync(n,(Bb,Wb,uc)=>{Wb?this.uIb(uc.targetData):this.qQc(uc.targetData);Bb||(Bb=uc.targetData,m.ULS.sendTraceTag(542994527,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Bb.solutionId,Bb.storeType,Bb.assetId,
null,null,Bb.storeId),Bb.storeType))})):this.qQc(La);Fl.a.add(La.solutionId,La.targetType,La.storeId,La.storeType,La.version);return 32}return 8}xjj(n,O,ha,Aa,La){if(!this.s8)return 16;if(!La)return 8;if(1===ha)return 32;n=Object(M.a)(String,La);if(!n||!n.length)return 8;if((O=this.Ce.hVd(n))&&O.taskpane){if(this.Ce.csa(n))return this.Ce.yFb(n,!1),32;if(O.Um&&OSF.OsfControl.isFirstPartyStoreString(O.Um.storeType))return this.Ce.ERd(n),this.Ce.hCk(n),32;O=O.taskpane.ownerAddinSolutionId;if(this.Ce.yzj(n)||
O)this.Ce.ERd(n);else if(O=this.Ce.oKc(),ha=this.Ib.Jc(O),n=this.Ce.v2f(n)){ha.Ck(Object(M.a)(Rn.a,n));n=this.Jb.xd(4,void 0,void 0,void 0,!0);try{n.lc(O),ha.Hi()}finally{n&&n.dispose()}}}return 32}nmj(n,O,ha,Aa,La){if(!this.s8)return 16;if(!La)return 8;if(1===ha)return 32;O=Object(M.a)(String,La);if(!O||!O.length)return 8;this.Ce?this.Ce.jeb(O):this.pca.Qyc(n,La);return 32}thg(n,O,ha,Aa,La){if(!this.s8)return 16;if(!La)return 8;if(1===ha)return 32;if(this.Ce){if(!La||!La.assetId||!v.AFrameworkApplication.o$d(La.assetId))return 8;
La.bO||(La.bO={});La.bO.ShowFeedback=v.AFrameworkApplication.WD;!this.Hhg&&this.FAc&&(this.Hhg=!0,n=window.performance.now()-this.FAc,m.ULS.sendTraceTag(41760289,220,50,"Apps for office load time {0}",n));n=this.Ce.DZb(La);if(n=this.Ce.YY(n))return this.Ce.F$g(n.instanceId,La),32;this.Ce.QOk(La)}else this.FAc||(this.FAc=window.performance.now()),this.pca.w3a(),this.pca.Qyc(n,La);return 32}Knj(n,O,ha,Aa,La){if(1===ha)return this.s8?32:8;if(!this.s8)return 16;if(!(La&&La.Cv&&-1!==La.Cv.state&&La.Cv.Xva&&
this.Ce))return 8;n=this.Ce.oBa(La.Um.id);if(!n)return 8;O=this.Jb.xd(4,void 0,void 0,void 0,!0);try{O.lc(n),n.setValue(dc.a.znb,La.Cv.state),n.setValue(dc.a.W2a,La.Cv.Xva),n.setValue(ul.a.VSb,La.Um.storeType)}finally{O&&O.dispose()}return 32}hij(n,O,ha,Aa,La){return this.s8?La?1===ha?32:this.Ce&&La&&La.length?this.Ce.oMd(La)?32:8:8:8:16}oWa(n,O,ha,Aa,La){if(2===ha){n=La.callback;if(!n)return 16;this.bAk(n)}return 32}bAk(n){const O=new xi.a;O.callbackFunc=n;O.storeType=OSF.StoreTypeEnum.MarketPlace;
O.fromInsertDialog=!1;O.refresh="true"===ta.a.instance.getItem(ni.a.MCf);this.Ce.Ko.queryEntitlementDetails(O)}uIb(n){const O=new C.a;O.add(n);n={};n[ni.a.Szc]=O;n[ni.a.yaa]=3;this.ia.Ma(G.a.RUc,2,n)}zxj(n,O){const ha=this.ua.Ca;if(!ha||this.Df.gd(ha))return 16;if(!this.gl.kI(ha,1))return this.gl.fJ(ha),16;try{return this.Ylg(n,ha,ha.Cb,O)}catch(Aa){return 8}}Ylg(n,O,ha,Aa){ha=O.vxi(n.width,n.height,O.Mu()+1);fk.a.UAf(ha,n,this.Ce);this.fv.X1([Object(M.a)(4,ha)],O,Aa);Fl.a.add(n.solutionId,n.targetType,
n.storeId,n.storeType,n.version);return 32}qQc(n){if(!this.Ce.YY(n.solutionId)){var O=this.Ce.oBa(n.solutionId),ha=this.Ce.oKc();if(O){ha=new Oi.a(O);if(!ha.visibility){let Aa=this.Jb.xd(4,void 0,void 0,void 0,!0);try{Aa.lc(O),O.setValue(ul.a.WSb,!0),O.setValue(ul.a.VSb,n.storeType)}finally{Aa&&Aa.dispose()}}this.Ce.jeb(ha.id)}else{O=fk.a.cui(this.U_c.value,n,this.Ce);n=this.Jb.xd(4,void 0,void 0,void 0,!0);try{n.lc(ha),fk.a.ZXh(ha,O)}finally{n&&n.dispose()}}}}}Object(h.a)(mn,"AppForOfficeActor",
null,[234]);var rh=d(86),aj=d(167),za=d(40),uk=d(986);class Lj{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze,Ah,Bk,Oe,sh,Ck,Hm,nm,yo,eo,Mp,bm,zo){this.i7b=null;this.OBg=!1;this.uTa=null;this.UEg=xh.a("PartialDoc.SkipCutCopyCallout");if(!zo)throw Error.argumentNull("calloutNotificationAdapter");this.ia=n;this.Df=O;this.Ga=ha;this.sa=Aa;this.Et=La;this.CD=Bb;this.kNg=Wb;this.o_j=uc;this.q4j=Vc;this.fXc=bd;this.Rb=xd;this.sGg=sh.sjg;this.lu=xe;this.qc=Hm;this.yWj=sh.powerPointEditorDownloadACopyUiIsEnabled;
this.T3j=wf;this.JXc=Ze;this.Za=Oe;this.tUa=!sh.zg;this.hMg=nm;this.RNg=eo;this.KIg=Mp;this.Sv=bm;this.LDg=!sh.printingEnabled||Ck.ka("DisablePrint");this.MDg=Ah;this.ql=Bk;this.FYj=Ck.Ia("DownloadPdfFromPodsUrl");this.m_printUrl=Ck.Ia("PrintPdfFromPodsUrl");this.EYj=Ck.Ia("DownloadOdpFromPodsUrl");this.WDg=Ck.Ia("DownloadImagesFromPodsUrl");this.N4j=Ck.ka("UseToastForDeferredBlobsEnabled");this.rfe=Ck.ka("UseToastForDeferredBlobsEnabled");this.H5j=sh.pptAppendFileNameToQueryUrlForDocumentOperationsActor;
n=(v.AFrameworkApplication.fileName||"").toLowerCase();sh.zg&&sh.PCj?(this.OBg=!0,this.i7b=Ck.Ia("DownloadACopyPodsUrl")):!sh.zg&&sh.NJj&&(n.endsWith(".pptx")||n.endsWith(".ppsx"))?this.i7b=this.E8j():this.i7b=v.AFrameworkApplication.uOa;this.Wie=yo;this.T0j=sh.C9d;this.sua=u.a.instance.Oa("Common.ISystemInitiatedFeedback");this.f0j=Ck.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1);this.cQ=zo}wb(){const n=!!this.MDg&&!this.hMg();K.a.J(25297680,801,50,"Limited printing access: {0}, Message shown: {1}",
this.LDg,n);this.LDg?n&&this.ql.o$k(this.MDg):(this.ia.ya(Ab.a.print,yb.a.application,Object(r.a)(this,this.xlj,"handlePrint")),this.ia.ya(Ab.a.downloadACopy,yb.a.application,Object(r.a)(this,this.downloadACopy,"downloadACopy")),this.ia.ya(Ab.a.XRd,yb.a.application,Object(r.a)(this,this.XRd,"downloadACopyAsPdf")),this.ia.ya(Ab.a.WRd,yb.a.application,Object(r.a)(this,this.WRd,"downloadACopyAsOdp")),this.ia.ya(Ab.a.YRd,yb.a.application,Object(r.a)(this,this.YRd,"downloadAsImages")),this.ia.ya(Ab.a.YFe,
yb.a.application,Object(r.a)(this,this.YFe,"saveSlidesAsImages")),this.ia.ya(Ab.a.xye,yb.a.application,Object(r.a)(this,this.swk,"pptoSaveACopy")),this.ia.ya(Ab.a.pvk,yb.a.application,Object(r.a)(this,this.twk,"pptoSaveAsToHost")),this.ia.ya(Ab.a.qvk,yb.a.application,Object(r.a)(this,this.uwk,"pptoSaveToSharePoint")),this.ia.ya(Ab.a.Lxk,yb.a.application,Object(r.a)(this,this.zlj,"handlePrintNotes")),this.ia.ya(Ab.a.Kxk,yb.a.application,Object(r.a)(this,this.ylj,"handlePrintHandouts")));this.ia.ya(G.a.fXa,
yb.a.application,Object(r.a)(this,this.fXa,"saveFileChange"));this.kNg&&this.ia.ra(Ab.a.Gad,yb.a.application,Object(r.a)(this,this.Gad,"querySaveStatus"),96);this.Wie.execute(Object(r.a)(this,this.Mcc,"onHostPostmessengerCreated"))}Fe(){const n=this.Ga.Bc(mb.a.eei);n.bindAction(jb.KeyInputManager.La(ra.a.Shb,jb.KeyInputManager.He),Ab.a.print);n.bindAction(jb.KeyInputManager.La(ra.a.FJa,jb.KeyInputManager.He),G.a.ze);n.bindAction(jb.KeyInputManager.La(ra.a.knd,jb.KeyInputManager.He),G.a.ze);n.bindAction(jb.KeyInputManager.La(ra.a.I0,
jb.KeyInputManager.He),G.a.ze);n.bindAction(jb.KeyInputManager.La(ra.a.I0,jb.KeyInputManager.He|4),G.a.ze)}twk(n,O,ha){return this.RFe(ha,G.a.UEb,"SaveAsToHost")}swk(n,O,ha){return this.RFe(ha,G.a.Hic,"SaveACopy")}uwk(n,O,ha){return this.RFe(ha,G.a.Jeb,"SaveToSharePoint")}RFe(n,O,ha){return 1===n?v.AFrameworkApplication.AL||v.AFrameworkApplication.SP?8:this.ia.processAction(O,1):this.Sv.hasDeferredContent()&&(K.a.J(556892300,843,15,"{0} is triggered while document has deferred content",ha),!this.N4j)?
(this.Sv.KKe(ha,null,null),8):this.Za.Wba?(K.a.J(50370185,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",O),this.ia.Ma(Ab.a.WEb,2,O)):this.ia.processAction(O,2)}downloadACopy(n,O,ha,Aa,La){if(this.Df.gd(this.Et))return 16;if(1===ha)return!this.qc.wj()||v.AFrameworkApplication.SP?8:Lj.F0f()?32:this.Dob();if(this.Sv.hasDeferredContent())return K.a.J(556892301,843,15,"DownloadACopy is triggered while document has deferred content"),this.UEg&&this.cQ.pRd(),this.Sv.KKe("DownloadACopy",
new uk.a,()=>{this.kQe(La)}),this.Sv.opa("DownloadACopyRequestedTime",za.a.Ve(new Date)),8;this.sa.Rh();this.Ga.Bd();K.a.J(19743434,801,50,"PPT save and download a copy");this.Za.Wba?this.kQe(La):(this.lu.show(!0,n),this.CD.d2(!1,this.tUa,()=>{this.kQe(La)},Object(r.a)(this,this.Yva,"saveFailureCallback")));return 32}kQe(n){this.lu.hide();let O;O=Lj.F0f()?v.AFrameworkApplication.uOa:this.OBg?this.cnb(this.i7b):this.i7b;n&&n.FileDownloadUrl&&(O=n.FileDownloadUrl.toString());this.xTj();this.KIg&&!this.KIg()&&
this.RNg&&this.RNg("3555692408")?this.uTa.sendMessage(Xf.a.download,{}):this.yWj?(this.T3j.W$k(O),this.Sv.opa("DownloadModalTime",za.a.Ve(new Date))):this.Rb.aO(!0,O,!0)}xTj(){this.f0j&&this.sua&&this.sua.execute(n=>{n.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})}Gad(n,O,ha,Aa,La){n="";this.kNg&&(n=this.o_j.DV(this.Et)?String.format(ResourceStrings.L_SavingStatus):this.sGg?String.format(CommonUIStrings.l_SavedToStatus,this.sGg):String.format(ResourceStrings.L_SavedStatus));
La[Af.a.Value]=n;return 32}xlj(n,O,ha){return this.fze(ha,0,n)}zlj(n,O,ha){return this.fze(ha,8,n)}ylj(n,O,ha){return this.fze(ha,4,n)}fze(n,O,ha){if(this.Df.gd(this.Et))return 16;if(1===n)return!this.qc.wj()||v.AFrameworkApplication.SP?8:this.Dob();if(this.hMg())return K.a.J(24934547,328,50,"Printing not allowed for IRM protected documents"),16;K.a.J(18983065,328,50,"PPT Editor print. PublishOption: {0}",O);this.sa.Rh();this.Ga.Bd();this.Za.Wba?this.wgh(O):(this.lu.show(!0,ha),this.CD.d2(!1,this.tUa,
()=>{this.wgh(O)},Object(r.a)(this,this.Yva,"saveFailureCallback")));return 32}wgh(n){this.lu.hide();this.q4j.print(this.Za.presentationId.string,this.cnb(this.m_printUrl),n)}XRd(n,O,ha){if(this.Df.gd(this.Et))return 16;if(1===ha)return!this.qc.wj()||v.AFrameworkApplication.SP?8:this.Dob();this.JXc.kXf=new Date;this.sa.Rh();this.Ga.Bd();this.Za.Wba?this.tgh():(this.lu.show(!0,n),this.CD.d2(!1,this.tUa,()=>{this.tgh()},Object(r.a)(this,this.Yva,"saveFailureCallback")));return 32}tgh(){this.lu.hide();
this.JXc.Agh=new Date;this.fXc.convert(this.Za.presentationId.string,1,this.cnb(this.FYj))}YRd(n,O,ha){if(this.Df.gd(this.Et))return 16;if(1===ha)return!this.qc.wj()||v.AFrameworkApplication.SP?8:this.Dob();this.sa.Rh();this.Ga.Bd();this.Za.Wba?this.ugh():(this.lu.show(!0,n),this.CD.d2(!1,this.tUa,()=>{this.ugh()},Object(r.a)(this,this.Yva,"saveFailureCallback")));return 32}YFe(n,O,ha){if(this.Df.gd(this.Et))return 16;if(1===ha)return!this.qc.wj()||v.AFrameworkApplication.SP?8:this.Dob();this.sa.Rh();
this.Ga.Bd();this.Za.Wba?this.jXf():(this.lu.show(!0,n),this.CD.d2(!1,this.tUa,()=>{this.jXf()},Object(r.a)(this,this.Yva,"saveFailureCallback")));return 32}ugh(){this.lu.hide();this.fXc.convert(this.Za.presentationId.string,2,this.cnb(this.WDg))}jXf(){this.lu.hide();var n=this.cnb(this.WDg),O=this.sa.rf();0<O.length&&(O=aj.c(O,ha=>ha.sid.toString()).join(","),n=new bf.QueryStringBuilder(n),n.nj(rh.a.Ebl,O),this.fXc.convert(this.Za.presentationId.string,2,n.toString()))}WRd(n,O,ha){if(this.Df.gd(this.Et))return 16;
if(1===ha)return!this.qc.wj()||v.AFrameworkApplication.SP?8:this.Dob();if(this.Sv.hasDeferredContent())return this.UEg&&this.cQ.pRd(),K.a.J(556892302,843,15,"DownloadACopyAsOdp is triggered while document has deferred content"),this.Sv.KKe("DownloadACopyAsOdp",new uk.a,()=>{this.SFe()}),8;this.sa.Rh();this.Ga.Bd();this.Za.Wba?this.SFe():(this.lu.show(!0,n),this.CD.d2(!1,this.tUa,()=>{this.SFe()},Object(r.a)(this,this.Yva,"saveFailureCallback")));return 32}Yva(){this.lu.hide();return!1}SFe(){this.lu.hide();
this.fXc.convert(this.Za.presentationId.string,0,this.cnb(this.EYj))}fXa(n,O,ha,Aa,La){if(this.Df.gd(this.Et))return 16;if(1===ha)return 32;this.sa.Rh();this.Ga.Bd();this.CD.d2(!1,!0,Bb=>{if(La&&1<=La.length)La[0](Bb)},Bb=>La&&2<=La.length?(La[1](Bb,Bb.ServerError.Code),!0):!1);return 32}E8j(){const n=new bf.QueryStringBuilder(Yc.a.yBa("DownloadACopyHandler.ashx"));n.nj(rh.a.$8c,this.Za.presentationId.string);n.nj(rh.a.Mda,this.Za.sessionInfo);n.nj("fn",v.AFrameworkApplication.fileName);v.AFrameworkApplication.BMa(n);
return n.toString()}cnb(n){if(n){const O=new bf.QueryStringBuilder(n);this.Za&&this.Za.podSessionId&&0>n.indexOf(this.Za.podSessionId)&&(O.Uyc(rh.a.C9+"="+this.Za.podSessionId),K.a.J(35235403,801,50,"Append PodSessionId in url: {0}",this.Za.podSessionId));this.H5j&&v.AFrameworkApplication.$t.nx&&0<v.AFrameworkApplication.$t.nx.length&&(O.nj(rh.a.Y1g,v.AFrameworkApplication.$t.nx),K.a.J(37246871,801,50,"Appended FileName in url"));this.T0j&&(O.nj(rh.a.Tpk,"true"),K.a.J(595133152,801,50,"Appended IsPasswordProtectedFile param"));
v.AFrameworkApplication.BMa(O);return O.toString()}return null}Mcc(n){this.uTa=n}Dob(){return v.AFrameworkApplication.AL?8:32}static F0f(){const n=v.AFrameworkApplication.AL,O=!ib.a.Xa(v.AFrameworkApplication.uOa),ha=v.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring"),Aa=v.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled");K.a.J(590209869,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",n,O,ha,Aa);return n&&
O&&ha&&Aa}}Object(h.a)(Lj,"DocumentOperationsActor",null,[234]);class hm{}hm.Wf="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(h.a)(hm,"EmbedDialogHtml",null,[]);class Mf{constructor(n,O,ha,Aa){this.swe=n;this.A2=O;this.V0g=ha;this.value=Aa}}Object(h.a)(Mf,"OptionInfo",null,[]);class im{constructor(n,O,ha){this.mGe=n;this.otb=O;this.A2=ha}}Object(h.a)(im,"SectionInfo",
null,[]);var $b=d(284);class Cf extends be.a{constructor(n,O=!1){super(!1,!1,O);this.i0e=476;this.Hqc=288;this.RIh=798;this.aRh=476;this.ZQh=288;this.a9c={};this.kXa=[];this.EO=this.Iya=this.vyd=this.uqc=this.Guc=this.Pkb=null;this.LLb=v.AFrameworkApplication.gtb;this.kvc=n;this.tyd=Object(r.a)(this,this.iok,"optionClickHandler");this.uyd=Object(r.a)(this,this.jok,"optionKeyHandler");this.vod=Object(r.a)(this,this.l9h,"arrowClickHandler");this.jib=Object(r.a)(this,this.m9h,"arrowKeyHandler");this.vxc=
Object(r.a)(this,this.Ail,"textAreaOnFocusHandler");this.dNh=O;this.Wf=hm.Wf;this.vd=0;this.kg="EmbedDialog"}get Ijb(){return this.Hqc}set Ijb(n){this.Hqc=n}nph(n){const O={["id"]:this.kg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Yc.a.aj(this.kvc,"wdPreview","1"),["initialEmbedUrl"]:this.LLb,
["getEmbedCode"]:Cf.x8f,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const ha of Object.keys(n))O[ha]=n[ha];this.vd=1;this.Pe(1,CommonUIStrings.l_CopyAction);this.Pe(0,CommonUIStrings.l_Close);this.qj(CommonUIStrings.l_Embed,null,O)}IGb(){if(this.dNh)this.nph({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.Pkb=document.getElementById("embedpreviewpane");this.Guc=document.getElementById("embedoptionpane");this.Pkb.style.width=String.format("{0}px",this.aRh);this.Iya=document.createElement("iframe");
this.Iya.className=Cf.YQh;this.Iya.frameBorder="0";this.Iya.style.height=String.format("{0}px",this.ZQh);this.Iya.tabIndex=-1;this.Pkb.appendChild(this.cFc(CommonUIStrings.l_Preview,this.Iya,Cf.Epf,Cf.$Qh,Cf.Epf,!0));this.EO=document.createElement("textarea");this.EO.className=Cf.xJh;Sys.UI.DomElement.addCssClass(this.EO,$b.a.Iza);this.EO.id=Cf.yJh;Ic.a.Ji||(this.EO.readOnly=!0);this.EO.rows=4;this.EO.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.EO.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;
this.EO.setAttribute(ka.a.o6,String.format("{0} {1}",Cf.h0e,Cf.g0e));this.Pkb.appendChild(this.cFc(CommonUIStrings.l_EmbedCode,this.EO,Cf.h0e));Hb.a.addHandler(this.EO,"focus",this.vxc);var n=document.createElement("span");n.className=Cf.uKh;n.innerText=CommonUIStrings.l_CopyText;n.id=Cf.g0e;this.Pkb.appendChild(n);this.uqc=document.createElement("div");this.uqc.className=Cf.UIh;this.Guc.appendChild(this.cFc(CommonUIStrings.l_Dimensions,this.uqc));this.vyd=document.createElement("div");this.Guc.appendChild(this.Cui(Cf.dQh,
this.vyd));this.vd=0;this.Pe(1,CommonUIStrings.l_Close);this.Hzh();this.CAh();Ic.a.Ji||this.EO.focus()}}dispose(){if(this.a9c){var n=this.a9c;for(let O in n){const ha=n[O];this.Rm.zb(ma.a.click,ha.swe,this.tyd);this.Kg.zb(ma.a.Rf,ha.swe,this.uyd);this.Kg.zb(ma.a.ol,ha.swe,this.uyd)}this.uyd=this.tyd=this.a9c=null}if(this.kXa){for(n=0;n<this.kXa.length;++n)this.Rm.zb(ma.a.click,this.kXa[n].otb,this.vod),this.Kg.zb(ma.a.Rf,this.kXa[n].otb,this.jib),this.Kg.zb(ma.a.zx,this.kXa[n].otb,this.jib),this.Kg.zb(ma.a.ol,
this.kXa[n].otb,this.jib);this.Kg=this.vod=this.kXa=null}this.vxc&&this.EO&&(Hb.a.removeHandler(this.EO,"focus",this.vxc),this.vxc=null);this.EO=this.Iya=this.vyd=this.uqc=this.Guc=this.Pkb=null;super.dispose()}Yla(){super.Yla();this.sc.style.width=String.format("{0}px",this.RIh);this.oUb()}Izh(n,O){const ha=Yc.a.aj(this.LLb,n,O);return this.LLb!==ha?(this.LLb=ha,this.kvc=Yc.a.aj(this.kvc,n,O),!0):!1}Hzh(){this.EO&&(this.EO.innerText=Cf.x8f(this.LLb,this.i0e,this.Hqc))}CAh(){this.Iya&&this.Iya.contentWindow.location.replace(Yc.a.aj(this.kvc,
"wdPreview","1"))}wrl(n,O){this.Izh(n,O)&&(this.Hzh(),this.CAh())}cFc(n,O,ha=null,Aa=null,La=null,Bb=!1){const Wb=document.createElement("div");Wb.className=Cf.QSh;Aa&&(Wb.id=Aa);La&&Wb.setAttribute(ka.a.o6,La);Bb&&(Wb.tabIndex=0);Aa=document.createElement("span");Aa.className=Cf.RSh;Aa.innerText=n;ha&&(Aa.id=ha);Wb.appendChild(Aa);Wb.appendChild(O);return Wb}Cui(n,O){const ha=this.cFc(CommonUIStrings.l_Interaction,O),Aa=this.mi.createElement("div");Aa.className=Cf.cGh;Aa.id=Cf.eGh+n;Aa.setAttribute(ka.a.ff,
ka.a.St);Aa.tabIndex=0;ha.insertBefore(Aa,O);n=Fa.createClusteredImage(16,16,Cf.dGh,Cf.fGh,!0,"");Aa.appendChild(n);n=n.childNodes[0];n.className=Fa.getImageClass(Cf.K_e);n.title=CommonUIStrings.l_Expand;Aa.title=CommonUIStrings.l_Expand;O.style.visibility="hidden";O=new im(O,Aa,n);Array.add(this.kXa,O);this.Rm.wT(ma.a.click,Aa,this.vod,O);this.Kg.wT(ma.a.Rf,Aa,this.jib,O);this.Kg.wT(ma.a.zx,Aa,this.jib,O);this.Kg.wT(ma.a.ol,Aa,this.jib,O);return ha}l9h(n){this.qLf(n);return!0}m9h(n){return this.uUc(n,
Object(r.a)(this,this.qLf,"changeArrowState"))}qLf(n){n=n.wC;"visible"===n.mGe.style.visibility?(n.mGe.style.visibility="hidden",n.A2.className=Fa.getImageClass(Cf.K_e),n.A2.title=CommonUIStrings.l_Expand,n.otb.title=CommonUIStrings.l_Expand):(n.mGe.style.visibility="visible",n.A2.className=Fa.getImageClass(Cf.lWh),n.A2.title=CommonUIStrings.l_Collapse,n.otb.title=CommonUIStrings.l_Collapse)}iok(n){this.U0g(n);return!0}jok(n){return this.uUc(n,Object(r.a)(this,this.U0g,"optionHandler"))}U0g(n){const O=
this.a9c[n.wC.toString()];O.value?(O.value=0,O.A2.className=Fa.getImageClass(Cf.XVh),O.V0g.setAttribute(ka.a.MFf,ka.a.Bpa)):(O.value=1,O.A2.className=Fa.getImageClass(Cf.jHh),O.V0g.setAttribute(ka.a.MFf,ka.a.yB));this.wrl(n.wC.toString(),O.value.toString())}Ail(){this.EO.select()}static x8f(n,O,ha){if(!Cf.Ixd){const Aa=String.format('<a target="_blank" href="{0}">{1}</a>',ib.a.O1b("https://office.com"),CommonUIStrings.l_Office),La=String.format('<a target="_blank" href="{0}">{1}</a>',ib.a.O1b("https://office.com/webapps"),
CommonUIStrings.l_WebAppName);Cf.Ixd=String.format(CommonUIStrings.l_NoFrames,Aa,La)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',ib.a.O1b(n),O,ha,Cf.Ixd)}}Cf.Ixd=null;Cf.jHh="CheckboxChecked_16x16x32";Cf.XVh="CheckboxUnchecked_16x16x32";Cf.lWh="OutlookSearchChevronUp_16x16x32";Cf.K_e="OutlookSearchChevronDown_16x16x32";Cf.dGh="UpArrowServer";Cf.QSh="EmbedSectionHeader";Cf.RSh="EmbedSectionName UIFontBold";Cf.uKh="EmbedCodeFooter";Cf.YQh="EmbedPreviewFrame";
Cf.xJh="EmbedCodeTextArea";Cf.UIh="EmbedDimensionSection";Cf.fGh="EmbedArrowIcon";Cf.cGh="WACGlyph EmbedArrowHolder";Cf.yJh="EmbedCode";Cf.h0e="EmbedCodeHeader";Cf.Epf="Preview";Cf.$Qh="PreviewHeader";Cf.dQh="Options";Cf.eGh="Arrow";Cf.g0e="EmbedCodeFooter";Object(h.a)(Cf,"EmbedDialog",be.a,[]);class Kc extends Cf{constructor(n,O){super(n,!0);O&&O&&!isNaN(O)||K.a.J(539762772,820,10,"Invalid aspectRatio in ReactEmbedDialog");this.Izh(rh.a.Kpk,O.toString())}IGb(){const n=[];n.push({["id"]:"wdEaaCheck",
["checkboxInitialValue"]:!1,["checkboxLabel"]:ResourceStrings.l_AutoAdvanceLabel,["urlTransformFunctionOnChange"]:Kc.gFk});this.nph({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.i0e,["defaultHeight"]:this.Hqc,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:ResourceStrings.l_EmbedSlideWidth,["heightLabel"]:ResourceStrings.l_EmbedSlideHeight},["interactionOptions"]:n})}static gFk(n,O,ha){return"wdEaaCheck"===O?Yc.a.aj(n,O,ha?"1":"0"):n}}Object(h.a)(Kc,"ReactEmbedDialog",Cf,
[]);class kf{constructor(n,O,ha,Aa,La,Bb){this.RDa=null;this.wge=!1;this.uTa=null;this.Rb=n;this.Aie=O;this.q7b=ha;this.Wie=Aa;this.Za=La;this.Ha=Bb}IGb(n,O,ha){(n=(n=v.AFrameworkApplication.DQ)||this.Za.Wba)||this.wge||(n=!this.xwh());return 1===ha?n?2:32:this.J9k()}J9k(){if(!this.wge)return 8;if(v.AFrameworkApplication.gtb&&this.q7b)this.Boh();else{const n=v.AFrameworkApplication.cTe?this.uTa.sendMessage(Xf.a.HOi,null)?32:8:2;return 32!==n?this.Rb.aO(!0,v.AFrameworkApplication.AUd):n}return 32}I9k(n){n.Values.HostEmbeddedViewUrl&&
(this.q7b=v.AFrameworkApplication.gtb=n.Values.HostEmbeddedViewUrl.toString(),this.Boh())}xwh(){return!1}RYh(n,O){this.RDa=O;this.wge=!!this.Rb&&!!this.Aie&&!(void 0===this.q7b||null===this.q7b)&&!!n&&!!O}Boh(){(new Kc(this.q7b,this.RDa)).IGb()}}Object(h.a)(kf,"EmbedManager",null,[]);class Gl{constructor(n,O,ha){this.RDa=null;this.JZj={};for(O=0;O<n.length;O++)this.JZj[n[O].Format.toString()]=O;this.RDa=ha&&!isNaN(ha)&&isFinite(ha)?ha:0}}Object(h.a)(Gl,"FormatPicker",null,[]);class Mj extends kf{constructor(n,
O,ha,Aa,La,Bb,Wb,uc){super(n,O,ha,Bb,Wb,uc);this.ia=Aa;this.Ub=La}wb(){this.ia.ya(Ab.a.IGb,yb.a.application,Object(r.a)(this,this.IGb,"showEmbedDialog"));this.Wie.execute(Object(r.a)(this,this.Mcc,"onHostPostmessengerCreated"))}Fe(){}xwh(){var n=this.Ub.Gv();if(!this.Aie||!n.height)return!1;n=n.width/n.height;const O=new Gl(this.Aie,!1,n);this.RYh(O,n);return!0}Mcc(n){this.uTa=n;v.AFrameworkApplication.isEmbedded||v.AFrameworkApplication.gtb||!this.uTa||(this.uTa.Qt(Xf.a.rKf),this.uTa.cB(Xf.a.rKf,
Object(r.a)(this,this.I9k,"showEmbedDialogPostMessage")))}}Object(h.a)(Mj,"EmbedActor",kf,[234]);var Zf=d(27),Hg=d(38),jm=d(321);class aa{static DCc(n){return new Promise((O,ha)=>{if(n&&n.size){var Aa=document.createElement("video"),La=URL.createObjectURL(n);Aa.setAttribute("src",La);Hb.a.addHandler(Aa,"loadedmetadata",()=>{URL.revokeObjectURL(La);const Bb=Aa.videoHeight,Wb=Aa.videoWidth;0<Aa.duration&&!Bb&&!Wb?O(!0):(K.a.J(579205003,822,10,"Invalid audio File"),O(!1))});Hb.a.addHandler(Aa,"error",
()=>{URL.revokeObjectURL(La);K.a.J(579205001,822,10,"Invalid audio File");ha(ResourceStrings.L_InvalidAudioFileError)})}else K.a.J(579205005,822,10,"Empty audio File"),O(!1)})}static $Bh(n){n=ib.a.vg(n);for(let O=0;O<aa.xAb.length;++O)if(aa.xAb[O]&&0<aa.xAb[O].length&&n.endsWith(aa.xAb[O]))return!0;return!1}static W5a(n){return n&&n.value?n.files[0].size.toString():"Invalid number of files"}static OBa(n){if(!n||!n.value)return"Input file name is null";const O=n.value.lastIndexOf(".");return-1===O?
"":n.value.substring(O+1,O+5)}}aa.rGf=16;aa.xAb=[".mp3",".wav",".m4a",".aac",".oga"];Object(h.a)(aa,"AudioValidationHelper",null,[]);class bj{static get Wf(){return be.a.tA(bj.Ym,ResourceStrings.L_AudioUploadMessage,ResourceStrings.L_NoAudioSpecifiedErrorMessage)}}bj.Ym="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block2'> <input type='file' id='fileInput' name='fileInput' class='WACDialogInputFile'/> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(h.a)(bj,"InsertAudioDialogHtml",null,[]);class tj extends be.a{constructor(n,O,ha){super();this.Zg=null;this.Gr=[];this.SCd=!1;this.E3j=n;this.Nab=O;this.Te=ha}iLe(){this.Wf=bj.Wf;this.Pe(1,ResourceStrings.L_Insert);this.showDialog(ResourceStrings.L_InsertAudioDialogTitle,Object(r.a)(this,this.Plg,"insertAudioDialogHandler"));(this.Zg=document.getElementById("fileInput"))&&this.Zg.setAttribute("accept","audio/*");const n=[];this.Zg&&(Hb.a.addHandler(this.Zg,ma.a.Rf,Object(r.a)(this,this.onKeyDown,
"onKeyDown")),n.push(this.Zg));var O=this.urb(1);O&&n.push(O);(O=this.urb(0))&&n.push(O);this.Gr=n;this.rSe()}dispose(){this.Zg&&Hb.a.removeHandler(this.Zg,ma.a.Rf,Object(r.a)(this,this.onKeyDown,"onKeyDown"));super.dispose()}Plg(n){1===n&&this.E3j(this.Zg);this.Zg=null}validate(){K.a.J(576582923,822,50,"Audio File details: Number of audio files: {0}, audio file extension: {1}, audio file size: {2}",this.Zg&&this.Zg.value?this.Zg.files.length:0,aa.OBa(this.Zg),aa.W5a(this.Zg));this.Te&&this.Te.Ya("AudioFileValidationStarts",
String.format("Number of audio files: {0}, audio file extension: {1}, audio file size: {2}",this.Zg&&this.Zg.value?this.Zg.files.length:0,aa.OBa(this.Zg),aa.W5a(this.Zg)));if(!this.Zg||!this.Zg.value||!this.Zg.value.length)return this.hjc(ResourceStrings.L_NoAudioSpecifiedErrorMessage),!1;if(!aa.$Bh(this.Zg.value))return this.hjc(ResourceStrings.L_InvalidAudioFileExtensionError),!1;if(!this.cwl())return this.hjc(String.format(ResourceStrings.L_InvalidAudioFileSizeError,"16")),!1;aa.DCc(this.Zg.files[0]).then(n=>
{n?(this.Te&&this.Te.Ya("AudioFileValidationPassedOnUI","true"),this.hide(),this.Plg(1,null)):this.hjc(ResourceStrings.L_InvalidAudioFileError)},n=>{K.a.J(587871448,822,10,"Invalid audio File");this.hjc(n)});return!1}hjc(n){const O=document.getElementById("errorText");O.innerText=n;O.style.display="inline-block";this.Te&&(this.Te.finish(),this.Te=null)}cwl(){return this.Zg.files[0].size<=1048576*aa.rGf}rSe(){if(0<this.Gr.length){const n=new Oc.a(this.Gr),O=fc.FocusManager.instance().Mk();O&&(this.Gr[0].focus(),
O.gj=n,O.CS=!0)}}onKeyDown(n){4!==fc.FocusManager.instance().tze(n)&&n.preventDefault()}}Object(h.a)(tj,"InsertAudioDialog",be.a,[]);var Vj=d(1006),Xh=d(934),hf=d(935);class gk{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze,Ah){this.bTa=!1;this.oWc=this.nwb=null;this.ia=n;this.sAb=O;this.oFa=ha?ha.za:null;this.h9=null;this.Nab=Aa;this.ua=La;this.Zb=Bb;this.ob=Wb;this.Ix=uc;this.Jb=Vc;this.rm=bd;this.Wb=xd;this.Wd=xe;this.qca=null;this.Ga=wf;this.Et=La.presentation;this.Ee=Ze;this.M_j=Ah;this.Te=
null}wb(){this.ia.ra(Ab.a.iLe,Hg.a.application,Object(r.a)(this,this.Nnj,"handleUploadAudioDialog"),4);this.ia.ra(Ab.a.Olg,Hg.a.view,Object(r.a)(this,this.Mnj,"handleUploadAudio"),4)}Fe(){}Nnj(n,O,ha){O=this.ua.Ca;if(!O||this.Zb.gd(O))return 16;if(1===ha)return 32;if(this.oFa){this.Te=za.a.Nm("Audio::Insert");try{return this.M_j?Xh.a.MLe("audio/*",Vj.b,()=>Vj.a(n,Object(r.a)(this,this.Ywj,"insertAudioSuccessAfterUploadUsingMediaUpload"),"audio",this.Ee),"audio",this.ua.presentation,this.Zb,this.Wd,
this.Te):Xh.a.MLe("audio/*",Object(r.a)(this,this.jwl,"validateFileInput"),()=>this.Z0i(n),"audio",this.ua.presentation,this.Zb,this.Wd,this.Te),this.Te&&this.Te.Ya("AudioDialogInitialized","true"),32}catch(Aa){K.a.J(579205014,818,10,"Error while rendering new audio selection dialog. Falling back to the old dialog")}Ic.a.rj||Ic.a.E8a||Ic.a.N7a&&72>Ic.a.DUb?(this.sAb.pWb(this.oFa,null,Object(r.a)(this,this.i0g,"onUploadAudioFrameInitialized"),Object(r.a)(this,this.aXd,"getAudioUploadEndpoint"),"audio/*",
!1,!1),this.bTa=!1):(K.a.J(558445141,818,15,"Rendering audio file picker dialog using InsertAudioDialog"),(new tj(Object(r.a)(this,this.akk,"onPickAudio"),this.Nab,this.Te)).iLe(),this.bTa=!0);this.Te&&this.Te.Ya("AudioDialogInitialized","true");return 32}K.a.J(590210202,822,15,"Insert Audio initialization failed.");return 8}Z0i(n){const O=String.format("{0}{1}","client",Ad.a.create().toString());return Object.assign(new hf.a,{OGd:this.pbg(O),kye:this.aXd(),n6c:()=>{this.qfk()},onSuccess:()=>{this.Qlg(n,
O)},Tz:ha=>{this.Xwj(ha)}})}jwl(n){return new Promise((O,ha)=>{K.a.J(576582924,822,50,"Audio File details: Number of audio files: {0}, audio file extension: {1}, audio file size: {2}",n&&n.value?n.files.length:0,aa.OBa(n),aa.W5a(n));this.Te&&this.Te.Ya("AudioFileValidationStarts",String.format("Number of audio files: {0}, audio file extension: {1}, audio file size: {2}",n&&n.value?n.files.length:0,aa.OBa(n),aa.W5a(n)));if(n&&n.value&&n.value.length)if(aa.$Bh(n.value)){var Aa=n.files[0];Aa.size>1048576*
aa.rGf?(K.a.J(577807694,822,10,"Audio::Insert:Invalid audio file size:{0}",Aa.size),this.showErrorMessage(416,["16"]),ha(416)):aa.DCc(Aa).then(La=>{La?(this.oWc=Aa.name,this.Te&&this.Te.Ya("AudioFileValidationPassedOnUI","true"),O(!0)):(this.showErrorMessage(417,null),ha(417))},()=>{K.a.J(579205008,822,10,"Invalid audio File");this.showErrorMessage(417,null);ha(417)})}else K.a.J(577807696,822,10,"Audio::Insert:Invalid audio file type:{0}",aa.OBa(n)),this.showErrorMessage(427,null),ha(427);else this.showErrorMessage(418,
null),ha(418)})}showErrorMessage(n,O){this.Te&&(this.Te.finish(),this.Te=null);this.Wd.YH(n,ha=>{ha.$C=1;ha.Z4a=O;return!1})}akk(n){n&&(this.nwb=n.files[0],this.sAb.pWb(this.oFa,n,Object(r.a)(this,this.i0g,"onUploadAudioFrameInitialized"),Object(r.a)(this,this.aXd,"getAudioUploadEndpoint"),"audio/*",!1,!1))}aXd(){let n="AudioUpload.ashx";if(Zf.App.webServiceBase)n=Zf.App.webServiceBase+n;else if(Ic.a.ag||Ic.a.zsa)n=Yc.a.yBa(n);n+=String.format("?{0}&{1}&{2}",v.AFrameworkApplication.fQa(),this.Ee.presentationId.string,
v.AFrameworkApplication.PZb());this.Ee.podSessionId&&(n+=String.format("&{0}={1}",rh.a.C9,this.Ee.podSessionId));this.Ee.qk&&(n+=String.format("&waccluster={0}",this.Ee.qk));return n}i0g(n){this.h9=n;if(!this.bTa){if(Ic.a.nD){n.qXb(Object(r.a)(this,this.cfk,"onAudioFileChosen"));return}n=n.qXb(null);if(!n)return;this.nwb=n.files[0]}this.nBh()}cfk(n){n&&(this.nwb=n.files[0],this.nBh())}nBh(){this.nwb&&(this.oWc=this.Nab.lIc(this.nwb.name),this.h9.svb=!0,this.ia.Ma(Ab.a.Olg,2,this.oWc))}Mnj(n,O,ha){O=
this.ua.Ca;if(!O||this.Zb.gd(O))return 16;if(1===ha)return 32;this.ob.fj();this.Ga.Bd();const Aa=String.format("{0}{1}","client",Ad.a.create().toString());ha=this.pbg(Aa);this.h9.vsh(()=>{this.Qlg(n,Aa)},La=>{this.showErrorMessage(La.error.Code,null)},ha);this.nwb=null;return 32}pbg(n){const O=new ve.a;O.$("PresentationId",this.Ee.presentationId.string);O.$(rh.a.Mda,this.Ee.sessionInfo);O.$("Canary",v.AFrameworkApplication.canary);O.$("access_token",v.AFrameworkApplication.accessToken);O.$("AudioToken",
n);return O}Qlg(n,O){this.Zb.fN(this.ua.presentation)&&K.a.J(577807691,822,15,"Audio::InsertAudioSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+this.ua.presentation.bha);this.Zb.mJ(this.ua.presentation);this.Te&&this.Te.Ya("AudioUploadToRC","true");const ha=this.ua.Ca,Aa=ha.Mu();var La=this.Et.slideWidth,Bb=this.Et.slideHeight;const Wb=Zc.a.yf(32,0),uc=Zc.a.yf(32,1);La=La/2-Zc.a.yf(16,0);Bb=Bb/2-Zc.a.yf(16,1);if(ha&&ha.isConnected){var Vc=this.Jb.xd(15,void 0,
void 0,()=>{this.Ix.oI=this.qca;this.ob.selectShape(this.qca,!0);this.Ga.Bd()});try{Vc.lc(ha),Vc.fd=n,this.Te&&this.Te.Ya("CreatingAudioShape","true"),this.qca=this.rm.b4a(!1,ha.Cb.cid,ha.Cb.sid,0,10,La,Bb,Wb,uc,Aa+1),this.qca.xnb=O,this.qca.wnb=this.oWc,ha.uB(this.qca)}finally{Vc&&Vc.dispose()}this.Te&&(this.Te.Ya("AudioShapeSuccessfullyCreated","true"),this.Te.finish(),this.Te=null)}}Ywj(n,O,ha,Aa,La,Bb){Aa.fN(ha)&&K.a.J(520737031,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+ha.bha);Aa.mJ(ha);La&&La.Ya("AudioUploadToRC","true");ha=this.ua.Ca;Aa=ha.Mu();var Wb=this.Et.slideWidth,uc=this.Et.slideHeight;const Vc=Zc.a.yf(32,0),bd=Zc.a.yf(32,1);Wb=Wb/2-Zc.a.yf(16,0);uc=uc/2-Zc.a.yf(16,1);if(ha&&ha.isConnected){var xd=this.Jb.xd(15,void 0,void 0,()=>{this.Ix.oI=this.qca;this.ob.selectShape(this.qca,!0);this.Ga.Bd()});try{xd.lc(ha);xd.fd=n;La&&La.Ya("CreatingAudioShape","true");this.qca=this.rm.b4a(!1,ha.Cb.cid,ha.Cb.sid,0,10,Wb,uc,Vc,bd,Aa+1);const xe=Bb.files[0].name;
this.qca.xnb=O;this.qca.wnb=xe;ha.uB(this.qca)}finally{xd&&xd.dispose()}La&&(La.Ya("AudioShapeSuccessfullyCreated","true"),La.finish(),La=null)}}qfk(){this.Zb.blockContent(this.ua.presentation,"Insert Audio")}Xwj(n){this.Zb.fN(this.ua.presentation)&&K.a.J(577807688,822,15,"Audio::InsertAudioFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+this.ua.presentation.bha);this.Zb.mJ(this.ua.presentation);let O=null;try{const ha=Sys.Serialization.JavaScriptSerializer.deserialize(n);
O=ha?ha.Error:null}catch(ha){K.a.J(579205012,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",n)}O||(O=Object.assign(new jm.a,{Code:421}));this.Te&&(this.Te.finish(),this.Te=null);K.a.J(579205010,822,10,"Upload audio failed");this.showErrorMessage(O.Code,null)}}Object(h.a)(gk,"InsertAudioActor",null,[234]);class Ii{constructor(){this.ttb=this.Xmb=null}}Object(h.a)(Ii,"CreatePickerCustomizationDictionaryOptions",null,[1539]);var nn=d(162);class Ji{}Ji.Wf="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(h.a)(Ji,"InsertMediaDialogHtml",null,[]);class Sl{}Sl.Wf="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(h.a)(Sl,"InsertMediaM365DialogHtml",null,[]);var wm=d(455);class Xi{static get Wf(){return be.a.tA(Xi.Ym,ResourceStrings.l_InsertOnlineVideoDescription,ResourceStrings.l_InsertOnlineVideoPrivacy,ResourceStrings.L_LearnMore,
"http://go.microsoft.com/fwlink/?linkid=2010177")}}Xi.Ym="<div class='VideoUrl' id='videourl'> <label id='labelVideoUrl' class='WACDialogLabel' for='url' >{0}</label> </div> <div class='VideoUrl' id='videourl'> <input type='text' id='url' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='VideoOutput' id='videooutput'> <label id='privacyandtos' class='WACDialogLabel' >{1}</label> </div> <div class='LearnMore' id='learnmore'> <a id='learnmore' class='LearnMore' href={3} target='newtab' >{2}</a> </div> <div class='VideoOutput' id='videooutput'> <label id='labelmessage' class='WACDialogLabel' >message</label> </div>";
Object(h.a)(Xi,"InsertOnlineVideoDialogHtml",null,[]);class Xe extends be.a{constructor(n){super();this.rC(1,!0);this.Pe(1,ResourceStrings.L_Insert);this.Wf=Xi.Wf;this.q8=n;this.mR=!1}MT(){this.width=50;this.qj(ResourceStrings.L_OnlineVideo,Object(r.a)(this,this.yxj,"insertOnlineVideoDialogHandler"),{["url"]:""});document.getElementById("labelmessage").innerText="";document.getElementById("labelmessage").setAttribute(ka.a.wId,ka.a.c9h);const n=document.getElementById("url");this.rC(1,!!n&&0<n.value.length);
Hb.a.addHandler(n,ma.a.input,Object(r.a)(this,this.I7c,"onPatternChanged"));Hb.a.addHandler(n,ma.a.change,Object(r.a)(this,this.I7c,"onPatternChanged"));this.KQ(n)}hide(){const n=document.getElementById("url");n&&(Hb.a.removeHandler(n,ma.a.input,Object(r.a)(this,this.I7c,"onPatternChanged")),Hb.a.removeHandler(n,ma.a.change,Object(r.a)(this,this.I7c,"onPatternChanged")));super.hide()}yxj(n,O){if(1===n){if(O){var ha=za.a.Nm("InsertOnlineVideo",1);ha.ur=!0;n=O.url.trim();(n=this.q8.MMi(n))?this.q8.txg(n)&&
this.q8.VNj(n)?(K.a.J(38836098,352,50,"[Insert Online Video] Creating Hubble request for {0}",this.q8.m8f(n)),this.q8.requestVideoData(n,Aa=>{za.a.EE(ha,()=>{this.CX(Aa)})},Object(r.a)(this,this.PNi,"failCallback"))):(K.a.J(38322694,352,10,"[Insert Online Video] Dialog url doesn't match, given url: "+this.q8.m8f(n)),this.fail(null,ResourceStrings.l_InsertOnlineVideoUnsupportedProvider)):(K.a.J(38836096,352,10,"[Insert Online Video] Dialog url is null!"),this.fail(null,ResourceStrings.l_InsertOnlineVideoIframeError))}}else this.hide()}CX(n){this.hide();
this.q8.Wog(n)}PNi(n){this.fail(n,ResourceStrings.l_CannotInsertOnlineVideo)}fail(n,O){if(document.getElementById("labelmessage")){var ha=+new Date-+this.q8.startTime;document.getElementById("labelVideoUrl").removeAttribute("for");document.getElementById("labelmessage").innerText=O;document.getElementById("labelmessage").setAttribute("for","url");document.getElementById("url").focus();n&&K.a.J(38322698,352,10,"InsertOnlineVideoDialog:Fail {0}",JSON.stringify({["TimeMs"]:ha,["ResponseCode"]:n.data.tf}))}else K.a.J(38885533,
352,15,"[Insert Online Video] Request failed after the dialog dissapeared!")}I7c(){za.a.xvb();const n=document.getElementById("url");this.rC(1,!!n&&0<n.value.length)}}Object(h.a)(Xe,"InsertOnlineVideoDialog",be.a,[1168]);class Qm{static get Wf(){return be.a.tA(Qm.Ym,ResourceStrings.l_CameoLearnMoreMessage,ResourceStrings.L_LearnMore,"https://aka.ms/pptocameoblog")}}Qm.Ym="<div class='CameoExperimentTextDiv' id='cameoexperimenttextdiv'> <label id='cameoexperimenttext' class='WACDialogLabel' >{0}</label> </div> <div class='cameoexperimentlearnmorediv' id='CameoExperimentLearnMoreDiv'> <a id='cameoexperimentlearnmore' class='CameoExperimentLearnMore' href={2} target='newtab' >{1}</a> </div>";
Object(h.a)(Qm,"InsertCameoDialogHtml",null,[]);class Rm extends be.a{constructor(){super();this.rC(1,!0);this.Wf=Qm.Wf;this.vd=0}MT(){this.width=50;this.qj(ResourceStrings.l_Cameo);const n=document.getElementById("cameoexperimentlearnmore");n&&(n.onclick=()=>K.a.J(520119896,352,50,"InsertCameoDialog::showAndFocus : Click on learn more of insert cameo"))}}Object(h.a)(Rm,"InsertCameoDialog",be.a,[1167]);var qd=d(1054),il=d(58);class Sm{constructor(n,O,ha){this.hNb=Nf.a.Ipa;this.sJ=null;this.Da=n;this.iNb=
O;this.hza=ha}get Ho(){return this.Da}get p6(){return this.sJ||(this.sJ=u.a.instance.resolve("Common.Utils.IAriaNotifier"))}get BA(){return this.hNb}set BA(n){this.hNb=n}Rra(n){try{m.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",n.length);const O=this.iNb.Ywk(n);let ha=2;if(O&&0<O.length){const Aa=new qd.DictionaryPropertySet;Aa.setValue(il.a.sT,O);Aa.setValue(il.a.fSc,!0);if(this.hza){const La=this.hza.KMe();La.vAc("insertOnlineImage");Aa.setValue(il.a.zNa,
La)}v.AFrameworkApplication.fa.ka("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.p6.sendNotification(Box4Intl.Box4Strings.l_ImageUploading,!0);ha=this.Da.Ma(this.BA,2,Aa)}m.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",n.length,32===ha,""===O)}catch(O){m.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",O.toString())}}}Object(h.a)(Sm,
"InsertOnlineImageHandler",null,[979]);class Vk extends Sm{constructor(n,O,ha=null){super(n,O,ha)}get NSf(){return Xf.a.insertImage}get ftb(){return Xf.a.oxj}j2g(n){return this.iNb.Oqk(n)}Wbg(n){return n.Type}ORc(n,O){return this.iNb.ORc(n.Type,O)}k2g(n){const O=[];if(n&&n.data&&n.data.value&&0<n.data.value.length)for(let Aa=0;Aa<n.data.value.length;Aa++)if(n.data.value[Aa]&&n.data.value[Aa].urls&&n.data.value[Aa].urls.download){var ha=n.data.value[Aa];ha=Object.assign(new Tk.a,{OriginalUrl:ha.urls.download,
Type:ha.extension||"",Caption:ha.name,ContentType:"",Height:ha.driveItem||ha.driveItem.image?ha.driveItem.image.height:0,Width:ha.driveItem||ha.driveItem.image?ha.driveItem.image.width:0});Array.add(O,ha)}O.length||m.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");return O}j6g(n,O,ha){ha=ha(n);if(ha.length){n=[];for(let Aa=0;Aa<ha.length;Aa++){const La=ha[Aa],Bb={};Bb.Extension=La.Type;Bb.SourceUrl=La.OriginalUrl;Bb.SourceUrl=
La.OriginalUrl;Bb.Width=La.Width;Bb.Height=La.Height;Array.add(n,Bb)}ha={};ha.Items=n;O.sendMessage(this.ftb,ha)}}}Object(h.a)(Vk,"InsertOnlineImageHelperBox4",Sm,[978,979]);class L extends Vk{constructor(n,O,ha){super(n,O);this.xqe=ha.insertOnlineVideoUrlPatterns;this.BA=Ab.a.d6d}Rra(n){if(n&&0<n.length){var O=Yc.a.NE(n[0].OriginalUrl);O=this.U$d(O)?O:"unsupported";K.a.J(512517837,352,50,"InsertMediaCallback: Insert online video called for {0}",O);this.Ho.Ma(this.BA,2,n[0])}}U$d(n){if(!n)return!1;
n=n.trim();for(const O of this.xqe)if((new RegExp(O)).test(n))return!0;return!1}}Object(h.a)(L,"InsertOnlineVideoHelper",Vk,[]);class ba{static get Wf(){return be.a.tA(ba.Ym,ResourceStrings.l_InsertSocialMediaDialogMsg)}}ba.Ym="<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>";Object(h.a)(ba,"InsertSocailMediaDialogHtml",null,[]);var Sa=
d(85),sb=d(241);class Tb extends Sys.EventArgs{constructor(n,O,ha,Aa){super();this.slideId=n;this.BX=ha;this.shapeId=O;this.uCa=Aa}}Object(h.a)(Tb,"IconChangedEventArgs",Sys.EventArgs,[]);var Tc=d(258);class Vb{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze,Ah,Bk,Oe,sh,Ck,Hm,nm,yo,eo,Mp,bm,zo,yh,jk,Ao){this.s_c=this.MRc=!1;this.Cle=null;this.la=n;this.ia=O;this.Zb=ha;this.sa=Aa;this.Ga=La;this.ua=Bb;this.Jb=Wb;this.tZc=uc;this.O_j=Vc;this.sZc=bd;this.j3=xd;this.v9a=xe;this.dka=wf;this.PSa=Ze;
this.Ub=Ah;this.rm=Bk;this.Fa=Oe;this.Pb=sh;this.Ix=Ck;this.gl=Hm;this.qab=nm;this.BTa=bm;this.cle=zo;this.Xc=yh;this.US=n.gDb;this.kc=Ao;this.qab&&(this.qab.g5a.removeAttribute("style"),this.qab.g5a.style.display="none");this.Cme=yo;this.P_j=eo;this.q8=Mp;this.T2=jk;this.v9a.execute(Lq=>{Lq.isFeatureEnabled("MsoPremiumStockImages",!1).catch(qf=>K.a.J(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",qf)).then(qf=>{this.s_c=qf;
this.s_c||(this.Cle=Lq.Xdb("MsoPremiumStockImages",()=>{this.s_c=!0;K.a.J(512517962,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));return null})})}wb(){this.DZh();this.ia.ra(Ab.a.mQc,Hg.a.application,Object(r.a)(this,this.Iul,"uploadIcon"),4);xh.a("ChangePictureOnMultiSelectionEnabled")?this.ia.ra(Ab.a.tCc,Hg.a.application,Object(r.a)(this,this.Lii,"changeToIcon"),4):this.ia.ra(Ab.a.tCc,Hg.a.application,Object(r.a)(this,this.Mii,"changeToIcon"),4);this.ia.ra(Ab.a.F7a,Hg.a.application,
Object(r.a)(this,this.Zld,"uploadOnlinePicture"),4);xh.a("ChangePictureOnMultiSelectionEnabled")?this.ia.ra(Ab.a.tUb,Hg.a.application,Object(r.a)(this,this.yCc,"changeToOnlinePicture"),4):this.ia.ra(Ab.a.tUb,Hg.a.application,Object(r.a)(this,this.zCc,"changeToOnlinePicture"),4);this.ia.ra(Ab.a.c6d,Hg.a.application,Object(r.a)(this,this.Zld,"uploadOnlinePicture"),4);xh.a("ChangePictureOnMultiSelectionEnabled")?this.ia.ra(Ab.a.oLd,Hg.a.application,Object(r.a)(this,this.yCc,"changeToOnlinePicture"),
4):this.ia.ra(Ab.a.oLd,Hg.a.application,Object(r.a)(this,this.zCc,"changeToOnlinePicture"),4);this.ia.ra(Ab.a.oQc,Hg.a.application,Object(r.a)(this,this.Zld,"uploadOnlinePicture"),4);xh.a("ChangePictureOnMultiSelectionEnabled")?this.ia.ra(Ab.a.vCc,Hg.a.application,Object(r.a)(this,this.yCc,"changeToOnlinePicture"),4):this.ia.ra(Ab.a.vCc,Hg.a.application,Object(r.a)(this,this.zCc,"changeToOnlinePicture"),4);this.CZh();this.ia.ra(Ab.a.Xlg,Hg.a.application,Object(r.a)(this,this.Zld,"uploadOnlinePicture"),
4);xh.a("ChangePictureOnMultiSelectionEnabled")?this.ia.ra(Ab.a.nLd,Hg.a.application,Object(r.a)(this,this.yCc,"changeToOnlinePicture"),4):this.ia.ra(Ab.a.nLd,Hg.a.application,Object(r.a)(this,this.zCc,"changeToOnlinePicture"),4);this.EZh();this.BZh();this.ia.ra(Ab.a.d6d,Hg.a.application,Object(r.a)(this,this.Lul,"uploadOnlineVideo"),4);this.ia.ra(Ab.a.$5d,Hg.a.application,Object(r.a)(this,this.Kul,"uploadOnlineHubbleVideo"),4);this.ia.ra(Ab.a.f7g,yb.a.application,Object(r.a)(this,this.yrl,"updateEntryPoints"),
96)}DZh(){this.ia.ra(Ab.a.Y5d,Hg.a.application,Object(r.a)(this,this.Xfb,"showInsertMediaDialogFromM365"),4);this.ia.ra(Ab.a.sUb,Hg.a.application,Object(r.a)(this,this.Xfb,"showInsertMediaDialogFromM365"),4);this.ia.ra(Ab.a.insertOnlinePicture,Hg.a.application,Object(r.a)(this,this.jLe,"showInsertPictureDialog"),4);this.ia.ra(Ab.a.pLd,Hg.a.application,Object(r.a)(this,this.jLe,"showInsertPictureDialog"),4);xh.a("InsertSocialMediaVideoIcon")&&this.ia.ra(Ab.a.Nxj,Hg.a.application,Object(r.a)(this,this.u$k,
"showInsertSocialMediaDialog"),4);this.ia.ra(Ab.a.nQc,Hg.a.application,Object(r.a)(this,this.Xfb,"showInsertMediaDialogFromM365"),4);this.ia.ra(Ab.a.uCc,Hg.a.application,Object(r.a)(this,this.Xfb,"showInsertMediaDialogFromM365"),4);this.ia.ra(Ab.a.b6d,Hg.a.application,Object(r.a)(this,this.Xfb,"showInsertMediaDialogFromM365"),4);this.ia.ra(Ab.a.pQc,Hg.a.application,Object(r.a)(this,this.kLe,"showInsertPictureFromHostDialog"),4);this.ia.ra(Ab.a.qLd,Hg.a.application,Object(r.a)(this,this.kLe,"showInsertPictureFromHostDialog"),
4);this.la.ocpsIsEnabled&&(this.ia.ceb("ppt_insertOnlinePictures",Ab.a.insertOnlinePicture,Hg.a.application,Object(r.a)(this,this.jLe,"showInsertPictureDialog"),n=>{Zf.App.Fb.bZa(n,Object(r.a)(this.T2,this.T2.FBa,"getCommandById"))}),this.ia.ceb("ppt_insertOnlinePictures",Ab.a.nQc,Hg.a.application,Object(r.a)(this,this.Xfb,"showInsertMediaDialogFromM365"),n=>{Zf.App.Fb.bZa(n,Object(r.a)(this.T2,this.T2.FBa,"getCommandById"))}),this.ia.ceb("ppt_insertOnlinePictures",Ab.a.b6d,Hg.a.application,Object(r.a)(this,
this.Xfb,"showInsertMediaDialogFromM365"),n=>{Zf.App.Fb.bZa(n,Object(r.a)(this.T2,this.T2.FBa,"getCommandById"))}),this.ia.ceb("ppt_insertOnlinePictures",Ab.a.pQc,Hg.a.application,Object(r.a)(this,this.kLe,"showInsertPictureFromHostDialog"),n=>{Zf.App.Fb.bZa(n,Object(r.a)(this.T2,this.T2.FBa,"getCommandById"))}))}CZh(){this.la.sQc&&this.kc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)&&(this.ia.ra(Ab.a.h6d,Hg.a.application,Object(r.a)(this,this.ohd,"showInsertPictureFromMobileDeviceDialog"),
4),this.ia.ra(Ab.a.sLd,Hg.a.application,Object(r.a)(this,this.ohd,"showInsertPictureFromMobileDeviceDialog"),4),this.la.ocpsIsEnabled&&(this.ia.ceb("mso_insertMobileDevicePictures",Ab.a.h6d,Hg.a.application,Object(r.a)(this,this.ohd,"showInsertPictureFromMobileDeviceDialog"),n=>{Zf.App.Fb.bZa(n,Object(r.a)(this.T2,this.T2.FBa,"getCommandById"))}),this.ia.ceb("mso_insertMobileDevicePictures",Ab.a.sLd,Hg.a.application,Object(r.a)(this,this.ohd,"showInsertPictureFromMobileDeviceDialog"),n=>{Zf.App.Fb.bZa(n,
Object(r.a)(this.T2,this.T2.FBa,"getCommandById"))})))}EZh(){this.ia.ra(Ab.a.KCa,Hg.a.application,Object(r.a)(this,this.aph,"showInsertVideoDialog"),4);this.la.ocpsIsEnabled&&this.ia.ceb("ppt_insertOnlineVideos",Ab.a.KCa,Hg.a.application,Object(r.a)(this,this.aph,"showInsertVideoDialog"),n=>{Zf.App.Fb.bZa(n,Object(r.a)(this.T2,this.T2.FBa,"getCommandById"))})}BZh(){Tc.a(this.kc.appSettings,"InsertCameoExperimentEnabled",!1)&&this.ia.ra(Ab.a.sxj,Hg.a.application,this.s$k.bind(this),4)}$wk(){v.AFrameworkApplication.A3b()&&
v.AFrameworkApplication.hoh()&&(v.AFrameworkApplication.Ba.get_element().appendChild(this.qab.g5a),Hb.a.addHandler(this.qab.g5a.contentWindow,"message",Object(r.a)(this,this.iph,"showOneDriveFilePickerDialog")),this.MRc=!0)}iph(n){if(n.rawEvent&&(n=n.rawEvent.data))try{K.a.J(512517961,352,50,"User select images.");const O=Sys.Serialization.JavaScriptSerializer.deserialize(n,!0),ha=O.MessageId?O.MessageId.toString():null;O&&ha&&(ha===Xf.a.insertImage||ha===Xf.a.X5d)&&this.Cme.start(ha===Xf.a.insertImage?
this.dka:this.P_j)}catch(O){K.a.J(512517960,352,10,"malformatted postmessage here.")}}Fe(){}yrl(){return 32}jLe(n,O,ha){if(!this.H4(this.ua.Ca,n,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===ha)return 32;K.a.J(512517959,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{const Aa=Ad.a.create(),La=ib.a.BM(this.la.pptEditingUserId).toString(),Bb=n===Ab.a.insertOnlinePicture&&this.la.Gvk?1:0;let Wb=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,
hl.a.re(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,Aa.toString(),3,La,Bb);0<this.la.insertPictureServiceEndpoint.search(RegExp("insertmedia.bing.office.net","gi"))&&(Wb=this.j3.Mci(Zf.App.mode,this.la.pptInsertOnlineContentImagesEnabled?this.la.insertOnlineContentImagesEndpoint:this.la.insertPictureServiceEndpoint));this.v9a.execute(uc=>{uc=this.tZc.getInstance(Wb,this.sZc,this.j3,uc,Ji.Wf);uc.insertPictureTelemetryEndpoint=this.la.insertPictureTelemetryEndpoint;uc.correlationId=
Aa;uc.Y3=1;switch(n){case Ab.a.pLd:this.PSa.BA=Ab.a.tUb;break;default:this.dka.BA=Ab.a.F7a}uc.NGb(CommonUIStrings.L_PictureInsertTitle,n===Ab.a.insertOnlinePicture?this.dka:this.PSa);K.a.J(512517958,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});return 32}catch(Aa){return K.a.J(512517957,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",Aa.toString()),Vb.Ns(Sa.a.FZb,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),
8}}u$k(n,O,ha){if(1===ha)return 32;n=new be.a(void 0,void 0,!1);n.vd=5;n.Wf=ba.Wf;n.qj(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{["id"]:"SocialMediaExperimentDialog"});K.a.J(512517956,352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32}Xfb(n,O,ha){if(!this.H4(this.ua.Ca,n,this.la.E7a))return 8;if(1===ha)return 32;let Aa,La;switch(n){case Ab.a.nQc:case Ab.a.b6d:Aa=this.la.xxj;La=1;this.dka.BA=Ab.a.c6d;break;case Ab.a.Y5d:Aa=this.la.a6d;La=1;this.dka.BA=Ab.a.mQc;
break;case Ab.a.sUb:Aa=this.la.zii;La=0;this.PSa.BA=Ab.a.tCc;break;case Ab.a.uCc:Aa=this.la.Aii;La=0;this.PSa.BA=Ab.a.oLd;break;default:return K.a.J(512517955,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",n.toString()),16}if(!Aa||!Aa.length)return 16;K.a.J(512517954,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");try{const Bb=Ad.a.create(),Wb=ib.a.BM(this.la.pptEditingUserId).toString();this.v9a.execute(uc=>{var Vc=this.la.wxj&&uc.isFreemiumUpsellEnabled();
Vc=this.s_c?1:Vc?0:-1;var bd=this.kc.ka("InsertOnlineM365ExperimentEnabled")?1:0;bd=this.j3.Lci(Zf.App.mode,Aa,Vc,La,Bb.toString(),Wb,bd);uc=this.tZc.getInstance(bd,this.sZc,this.j3,uc,Sl.Wf);uc.correlationId=Bb;uc.Y3=2;uc.aRd=Vc;uc.NGb(CommonUIStrings.L_PictureInsertTitle,n===Ab.a.sUb||n===Ab.a.uCc?this.PSa:this.dka);K.a.J(512517953,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});return 32}catch(Bb){return K.a.J(512517952,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",
Bb.toString()),Vb.Ns(Sa.a.FZb,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}kLe(n,O,ha){if(!this.H4(this.ua.Ca,n,v.AFrameworkApplication.A3b()&&(Vb.cig?!!this.Cme.kCb&&9<this.Cme.kCb.length:!0)))return 8;if(1===ha)return 32;K.a.J(512517923,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{O=!0;let Aa=0;if(this.kc.ka("InsertMediaSharedFilePickerEnabled")){const Bb=u.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");
if(Bb.z$d()){O=!1;const Wb=this.la.Zlg;ha=!1;this.la.sQc&&(ha=this.gVi());const uc=Object.assign(new Ii,{Xmb:ha,ttb:!0}),Vc=Bb.xOd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,!0,Wb,"InsertPicture",0,uc);Bb.AYd(Vc).then(bd=>{if(bd&&0<bd.length){const xd=[];for(let xe=0;xe<bd.length;xe++){const wf=bd[xe][Ld.a.Lxe],Ze={};Ze.Extension=bd[xe][Ld.a.t3g];Ze.OriginalUrl=Ld.a.Gxe in bd[xe]?bd[xe][Ld.a.Gxe]:wf;Ze.Type=Ld.a.Hxe in bd[xe]?bd[xe][Ld.a.Hxe]:"";Ze.Caption=
Ld.a.Kxe in bd[xe]?bd[xe][Ld.a.Kxe]:"";Ze.Description=Ld.a.Fxe in bd[xe]?bd[xe][Ld.a.Fxe]:"";Ze.Width=Ld.a.Jxe in bd[xe]?bd[xe][Ld.a.Jxe]:0;Ze.Height=Ld.a.Ixe in bd[xe]?bd[xe][Ld.a.Ixe]:0;Array.add(xd,Ze)}this.dka.BA=Ab.a.oQc;this.dka.Rra(xd);K.a.J(512517922,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}Aa=32}).catch(bd=>{K.a.J(512517921,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",bd.toString());Vb.Ns(Sa.a.FZb,
ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture);Aa=8})}}if(!O)return Aa;Vb.cig=!0;this.MRc||this.$wk();const La=this.O_j.getInstance();La.Y3=4;switch(n){case Ab.a.qLd:this.PSa.BA=Ab.a.vCc;break;default:this.dka.BA=Ab.a.oQc}La.NGb(CommonUIStrings.L_PictureInsertTitle,n===Ab.a.pQc?this.dka:this.PSa);K.a.J(512517920,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");return 32}catch(Aa){return K.a.J(512517919,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",
Aa.toString()),Vb.Ns(Sa.a.FZb,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}gVi(){return u.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").dXi()}ohd(n,O,ha){if(!this.H4(this.ua.Ca,n,this.la.sQc&&this.kc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)))return 8;if(1===ha)return 32;u.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").xOi(this.kc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",
!1));try{let Aa=0;const La=u.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(La.z$d()){const Bb=n===Ab.a.h6d,Wb=this.la.Zlg,uc=Object.assign(new Ii,{Xmb:!0,ttb:!0}),Vc=La.xOd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,Bb,Wb,"InsertPictureFromMobile",3,uc);La.AYd(Vc).then(bd=>{if(bd&&0<bd.length){const xd=[];let xe=!1;const wf=this.kc.Ia("PhoneLinkServiceEndpoint");for(let Ze=0;Ze<bd.length;Ze++){const Ah=bd[Ze][Ld.a.Lxe],Bk=bd[Ze],Oe=
{};Oe.Extension=bd[Ze][Ld.a.t3g];Oe.OriginalUrl=this.QDb(Bk,Ld.a.Gxe,Ah);Oe.Type=this.QDb(Bk,Ld.a.Hxe,"");Oe.Caption=this.QDb(Bk,Ld.a.Kxe,"");Oe.Description=this.QDb(Bk,Ld.a.Fxe,"");Oe.Width=this.QDb(Bk,Ld.a.Jxe,0);Oe.Height=this.QDb(Bk,Ld.a.Ixe,0);Array.add(xd,Oe);xe||(xe=-1!==Oe.OriginalUrl.indexOf(wf))}bd=Bb?this.dka:this.PSa;bd.BA=xe?Bb?Ab.a.Xlg:Ab.a.nLd:Bb?Ab.a.oQc:Ab.a.vCc;bd.Rra(xd);K.a.J(512517918,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}Aa=
32}).catch(bd=>{K.a.J(512517917,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",bd.toString());Aa=8})}return Aa}catch(Aa){return K.a.J(512517916,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Aa.toString()),8}}QDb(n,O,ha){return O in n?n[O]:ha}Zld(n,O,ha,Aa,La){O=this.ua.Ca;if(!O)return K.a.J(512517915,352,50,"Active Slide is null"),8;if(!this.H4(O,n,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===ha)return 32;if(!this.gl.kI(O,
1))return this.gl.fJ(O),16;try{const Bb=O.g2(this.sa.he());if(Bb&&this.Zb.gd(Bb))return 16;const Wb=this.y6a(O,Bb);let uc=null;const Vc=this.Jb.xd(15,void 0,()=>{this.sa.gy();this.sa.Rh();this.Ga.Bd()},()=>{this.sa.selectShape(Wb,!0);uc&&this.sa.selectShape(uc,!1)});try{Vc.lc(O);Vc.fd=Ab.a.insertOnlinePicture;Vc.iy[sb.a.YAa]=sb.a.online;ha=null;n={["actionId"]:n};if(this.la.pptInsertOnlinePictureAttributionIsEnabled)if(La.LicenseUrl&&La.LicenseDisplayName){const bd=Vb.Tye(La);ha=nn.c(bd);if(this.la.pptImageAttributionSelectionImprove){const xd=
O.Cb;uc=this.rm.eqa(!0,xd.cid,xd.sid,0,0,0,lb.a.p9,lb.a.o9,O.Mu()+1,!1)}}else n["result.LicenseDisplayName"]=La.LicenseDisplayName,n["result.LicenseUrl"]=ib.a.BM(La.LicenseUrl);else n.IsEnabled=this.la.pptInsertOnlinePictureAttributionIsEnabled;K.a.J(512517914,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",n);Wb.RFb(La.OriginalUrl,La.LicenseUrl?null:La.Caption,ha,La.PageUrl);Bb&&O.xT([Bb]);O.uB(Wb);uc&&(O.uB(uc),Wb.U2a=uc.id,uc.p7a=!0)}finally{Vc&&Vc.dispose()}this.Ix.oI=Wb;return 32}catch(Bb){return K.a.J(512517913,
352,10,"InsertMediaActor::UploadOnlinePicture : Pic = [{0}], Exception = [{1}].",La.OriginalUrl,Bb.toString()),8}}zCc(n,O,ha,Aa,La){O=this.ua.Ca;if(!O)return K.a.J(512517912,352,50,"Active Slide is null"),8;if(!this.H4(O,n,this.la.aHa))return 8;if(1===ha)return 32;K.a.J(512517910,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Start changing.");if(!La)return 16;try{const Bb=this.Y5a()||this.xLc();if(!Bb||this.Zb.gd(Bb))return 16;let Wb=null;const uc=this.Jb.xd(15,void 0,void 0,()=>{this.sa.selectShape(Bb,
!0);Wb&&this.sa.selectShape(Wb,!1);K.a.J(512517908,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Finish changing.")});try{uc.lc(O);uc.fd=Ab.a.tUb;uc.iy[sb.a.YAa]=sb.a.online;n=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&La.LicenseUrl&&La.LicenseDisplayName){const Vc=Vb.Tye(La);n=nn.c(Vc);if(this.la.pptImageAttributionSelectionImprove){const bd=O.Cb;Wb=this.rm.eqa(!0,bd.cid,bd.sid,0,0,0,lb.a.p9,lb.a.o9,O.Mu()+1,!1);K.a.J(512517907,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Adding license info to attributionShapeNode.")}}Bb.RFb(La.OriginalUrl,
La.LicenseUrl?null:La.Caption,n,La.PageUrl);Bb.set_isSVGBlipFilled(!1);Wb&&(O.uB(Wb),Bb.U2a=Wb.id,Wb.p7a=!0)}finally{uc&&uc.dispose()}this.Ix.oI=Bb;return 32}catch(Bb){return K.a.J(512517905,352,10,"InsertMediaActor::changeToOnlinePictureSingleImage : Pic = [{0}], Exception = [{1}].",La.OriginalUrl,Bb.toString()),8}}yCc(n,O,ha,Aa,La){O=this.ua.Ca;if(!O)return K.a.J(512517911,352,50,"Active Slide is null"),8;if(!this.H4(O,n,this.la.aHa))return 8;if(1===ha)return 32;K.a.J(512517909,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");
if(!La)return 16;try{const Bb=this.sa.he();for(const uc of Bb)if(!uc||this.Zb.gd(uc))return 16;n=null;const Wb=this.Jb.xd(15,void 0,void 0);try{Wb.lc(O);Wb.fd=Ab.a.tUb;Wb.iy[sb.a.YAa]=sb.a.online;ha=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&La.LicenseUrl&&La.LicenseDisplayName){const Vc=Vb.Tye(La);ha=nn.c(Vc);if(this.la.pptImageAttributionSelectionImprove){const bd=O.Cb;n=this.rm.eqa(!0,bd.cid,bd.sid,0,0,0,lb.a.p9,lb.a.o9,O.Mu()+1,!1);K.a.J(512517906,352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}const uc=
La.LicenseUrl?null:La.Caption;for(const Vc of Bb)Vc.RFb(La.OriginalUrl,uc,ha,La.PageUrl),Vc.set_isSVGBlipFilled(!1),n&&(O.uB(n),Vc.U2a=n.id,n.p7a=!0)}finally{Wb&&Wb.dispose()}this.Ix.oI=Bb[0];return 32}catch(Bb){return K.a.J(512517904,352,10,"InsertMediaActor::ChangeToOnlinePicture : Pic = [{0}], Exception = [{1}].",La.OriginalUrl,Bb.toString()),8}}Iul(n,O,ha,Aa,La){O=this.ua.Ca;if(!O)return K.a.J(512517903,352,50,"Active Slide is null"),8;if(!this.H4(O,n,this.la.E7a))return 8;if(1===ha)return 32;
K.a.J(512517902,352,50,"InsertMediaActor::UploadIcon : Start inserting.");if(!La||!La.length)return 16;if(!this.gl.kI(O,La.length))return this.gl.fJ(O),16;try{let Bb=null;ha=null;if(!({Osk:ha,Esk:Bb}=this.H7i(La,O)).returnValue)return 16;const Wb=this.Jb.xd(15,void 0,()=>{this.sa.gy();this.sa.Rh();this.Ga.Bd()},()=>{this.sa.mXa(Bb,!0)});try{for(Wb.lc(O),Wb.fd=n,Wb.iy[sb.a.YAa]=sb.a.icon,ha&&O.xT(ha),n=0;n<Bb.length;n++)O.uB(Bb[n])}finally{Wb&&Wb.dispose()}this.Ix.oI=Bb[Bb.length-1];return 32}catch(Bb){return K.a.J(512517901,
352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",La.length,Bb.toString()),8}}H7i(n,O){let ha,Aa;ha=Array(n.length);Aa=Array(n.length);var La=O.gXd(this.sa.he());if(La&&0<La.length){var Bb=0;for(const Wb of La)if(Wb&&!this.Zb.gd(Wb)&&Bb<n.length&&(ha[Bb]=Wb,Bb++,Bb===n.length))break}La=!0;for(Bb=0;Bb<ha.length;Bb++)this.la.svgIconLocalEditingIsEnabled&&n[Bb].SvgContent&&0<n[Bb].SvgContent.length&&(!ha[Bb]||ha[Bb]&&15!==ha[Bb].zj)?Aa[Bb]=this.F7i(O,ha[Bb],n[Bb],Bb):(Aa[Bb]=
this.Dcg(O,ha[Bb],n[Bb],!0,Bb),La=!1),La&&za.a.uO(!0,!0),Aa[Bb].RFb(n[Bb].OriginalUrl,n[Bb].Caption,null,null);return{returnValue:!0,Osk:ha,Esk:Aa}}F7i(n,O,ha,Aa){if(!n)return null;var La=n.Cb,Bb=n.Mu();let Wb;const uc=Object(M.a)(316,n.pc(this.Pb.Na));({vUd:Wb,uC:n}=this.BTa.hNd(O,ha.Width,ha.Height));Aa=O?0:Aa*wm.a.t6;La=this.rm.eqa(!0,La.cid,La.sid,0,n.x+Aa,n.y+Aa,Wb.width,Wb.height,Bb+1,!1);Bb=this.BTa.zJd(this.Pb.Ed,Wb,n,uc.wV);La.BT=Bb;La.isResizable=!0;La.K3b=!0;La.DK=!0;La.qGa=!0;La.set_isSVGBlipFilled(!0);
ha=this.cle.BUk(ha.SvgContent);La.kca=ha?String.format("data:image/svg+xml;charset=utf8,{0}",encodeURIComponent(ha)):"";O&&(La.Haa=O.id);return La}Lii(n,O,ha,Aa,La){O=this.ua.Ca;if(!O)return K.a.J(512517900,352,50,"Active Slide is null"),8;if(!this.H4(O,n,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===ha)return 32;K.a.J(512517898,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!La||!La.length)return 16;try{const Bb=this.sa.he(),Wb=La[0].Caption;for(const Vc of Bb){if(!Vc||
this.Zb.gd(Vc))return 16;const bd=this.Fa.Lr(Vc);Wb&&bd&&this.Xc.A8g(new Tb(O.Cb,Vc.get_shapeId(),Vc.get_smartArtModelId(),Wb))}const uc=this.Jb.xd(15,void 0,void 0,()=>{for(const Vc of Bb){const bd=this.Fa.Lr(Vc);bd&&(this.Xc.jbd(),this.sa.selectShape(bd,!0),this.Xc.ibd())}K.a.J(512517896,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")});try{uc.lc(Bb[0]);uc.fd=n;uc.iy[sb.a.YAa]=sb.a.icon;for(const Vc of Bb)Vc.set_isSVGBlipFilled(!0),Vc.RFb(La[0].OriginalUrl,Wb,null,null)}finally{uc&&
uc.dispose()}for(const Vc of Bb)this.Zb.Hpa(O,Vc,this.Pb.Na,n);return 32}catch(Bb){return K.a.J(512517894,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",La.length,Bb.toString()),8}}Mii(n,O,ha,Aa,La){O=this.ua.Ca;if(!O)return K.a.J(512517899,352,50,"Active Slide is null"),8;if(!this.H4(O,n,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===ha)return 32;K.a.J(512517897,352,50,"InsertMediaActor::changeToIconSingleIcon : Start changing.");if(!La||!La.length)return 16;
try{const Bb=this.xLc()||this.Y5a();if(!Bb||this.Zb.gd(Bb))return 16;const Wb=La[0].Caption,uc=this.Fa.Lr(Bb);Wb&&uc&&this.Xc.A8g(new Tb(O.Cb,Bb.get_shapeId(),Bb.get_smartArtModelId(),Wb));const Vc=this.Jb.xd(15,void 0,void 0,()=>{uc&&(this.Xc.jbd(),this.sa.selectShape(uc,!0),this.Xc.ibd());K.a.J(512517895,352,50,"InsertMediaActor::changeToIconSingleIcon : Finish changing.")});try{Vc.lc(Bb),Vc.fd=n,Vc.iy[sb.a.YAa]=sb.a.icon,Bb.set_isSVGBlipFilled(!0),Bb.RFb(La[0].OriginalUrl,Wb,null,null)}finally{Vc&&
Vc.dispose()}(ha=uc||Bb)&&this.Zb.Hpa(O,ha,this.Pb.Na,n);return 32}catch(Bb){return K.a.J(512517893,352,10,"InsertMediaActor::changeToIconSingleIcon : icon count = [{0}], Exception = [{1}].",La.length,Bb.toString()),8}}xLc(){let n=null;const O=this.sa.he();for(const ha of O)if(ha&&ha.get_isSVGBlipFilled())if(n)break;else n=ha;return n}Y5a(){if(this.US){const n=this.sa.he();return n&&n.length?this.jId(n)?n[0]:this.Srb():null}return this.Srb()}jId(n){if(!n||!n.length)return!1;let O=n[0].sk,ha=1===n[0].mediaType;
for(const Aa of n)O=O&&Aa.sk,ha=ha&&1===Aa.mediaType;return O||ha}Srb(){const n=this.sa.he();for(const O of n)if(O&&O.sk)return O;return null}aph(n,O,ha){if(!this.H4(this.ua.Ca,n,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===ha)return 32;try{if(this.la.insertVideoOnlineFromHubbleEnabled){K.a.J(512517890,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");const La=Ad.a.create(),Bb=ib.a.BM(this.la.pptEditingUserId).toString();this.v9a.execute(Wb=>{Wb=this.tZc.getInstance(this.j3.Nci(Zf.App.mode,
this.la.Wxj,La.toString(),Bb,this.la.c8a),this.sZc,this.j3,Wb,Sl.Wf);Wb.correlationId=La;Wb.Y3=5;const uc=new L(this.ia,this.j3,this.la);uc.BA=Ab.a.$5d;Wb.NGb(CommonUIStrings.L_VideoInsertTitle,uc)})}else this.la.insertVideoOnlineFromUrlEnabled?(K.a.J(512517889,352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new Xe(this.q8)).MT()):(K.a.J(512517888,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),this.v9a.execute(La=>{this.tZc.getInstance(this.j3.Oci(Zf.App.mode,
this.la.insertVideoServiceEndpoint),this.sZc,this.j3,La,Ji.Wf).NGb(CommonUIStrings.L_VideoInsertTitle,new L(this.ia,this.j3,this.la))}));const Aa=this.kc.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");xh.a("LogInsertOnlineVideoCustomToolTip")&&"InsertOnlineVideo"!==Aa&&K.a.J(512517859,352,15,"InsertOnlineVideo::ToolTipMessage : "+Aa);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.kc.dZb){const La=this.kc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",
!1)?"Visible":"NotVisible";K.a.J(512517858,352,15,"InsertOnlineVideo::SocialMediaIconIs"+La)}K.a.J(512517857,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(Aa){return K.a.J(512517856,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",Aa.toString()),Vb.Ns(Sa.a.FZb,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlineVideo),8}}s$k(n,O,ha){if(!this.H4(this.ua.Ca,n,!0))return 8;if(1===ha)return 32;try{return K.a.J(512517855,
352,50,"InsertMediaActor::ShowInsertCameoDialog : Insert cameo, creating dialog"),(new Rm).MT(),32}catch(Aa){return K.a.J(512517854,352,10,"InsertMediaActor::ShowInsertCameoDialog : Exception = [{0}]",Aa.toString()),8}}Lul(n,O,ha,Aa,La){O=this.ua.Ca;if(!O)return K.a.J(512517853,352,50,"Active Slide is null"),8;if(!this.H4(O,n,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===ha)return 32;if(!this.gl.kI(O,1))return this.gl.fJ(O),16;try{const Bb=O.g2(this.sa.he());if(Bb&&this.Zb.gd(Bb))return 16;
const Wb=this.y6a(O,Bb),uc=this.j3.hfj(La.OriginalUrl);Wb.kIe(uc,La.ThumbnailUrl,La.Caption,La.Description,0<La.Width?La.Width:0,0<La.Height?La.Height:0);const Vc=this.Jb.xd(15,void 0,()=>{this.sa.gy();this.sa.Rh();this.Ga.Bd()},()=>{this.sa.selectShape(Wb,!0)});try{Vc.lc(O),Vc.fd=n,Bb&&O.xT([Bb]),O.uB(Wb)}finally{Vc&&Vc.dispose()}K.a.J(512517852,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video [{0}] is done.",La.OriginalUrl);this.Ix.oI=Wb;return 32}catch(Bb){return K.a.J(512517851,
352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",Bb.toString()),8}}Kul(n,O,ha,Aa,La){O=this.ua.Ca;if(!O)return K.a.J(512517850,352,50,"Active Slide is null"),8;if(!this.H4(O,n,this.la.insertVideoOnlineFromHubbleEnabled))return 8;if(1===ha)return 32;K.a.J(512517849,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");if(!this.gl.kI(O,1))return this.gl.fJ(O),16;try{const Bb=O.g2(this.sa.he());if(Bb&&this.Zb.gd(Bb))return 16;const Wb=this.y6a(O,Bb);Wb.kIe(La.PageUrl,
La.ThumbnailUrl,La.Caption,La.Description,0<La.Width?La.Width:0,0<La.Height?La.Height:0);const uc=this.Jb.xd(15,void 0,()=>{this.sa.gy();this.sa.Rh();this.Ga.Bd()},()=>{this.sa.selectShape(Wb,!0)});try{uc.lc(O),uc.fd=n,Bb&&O.xT([Bb]),O.uB(Wb)}finally{uc&&uc.dispose()}K.a.J(512517848,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video [{0}] is done.",La.OriginalUrl);this.Ix.oI=Wb;return 32}catch(Bb){return K.a.J(512517847,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",
Bb.toString()),8}}H4(n,O,ha){n=!!n&&ha&&!this.Zb.gd(n);switch(O){case Ab.a.sUb:return n&&(!!this.Y5a()||!!this.xLc());case Ab.a.pLd:case Ab.a.qLd:case Ab.a.sLd:case Ab.a.uCc:return n&&this.Tji();default:return n}}Tji(){const n=this.Y5a()||this.xLc();return n?this.Fa.Lr(n)?!1:!0:!1}y6a(n,O){return this.Dcg(n,O,null,!1,0)}Dcg(n,O,ha,Aa,La){if(!n)return null;var Bb=n.Cb;n=n.Mu();let Wb;Aa?{width:ha,height:Wb}=Vb.zcj(O,ha):(ha=lb.a.p9,Wb=lb.a.o9);let uc;uc=O?O.fsb(ha,Wb):this.Ub.rra(ha,Wb);La=O?0:La*
wm.a.t6;Bb=this.rm.eqa(!0,Bb.cid,Bb.sid,0,uc.x+La,uc.y+La,ha,Wb,n+1,!0);Bb.set_isSVGBlipFilled(Aa);O&&(Bb.Haa=O.id);return Bb}dispose(){this.v9a.instance&&this.Cle&&this.v9a.instance.fEb("MsoPremiumStockImages",this.Cle);this.MRc&&this.qab.g5a.contentWindow&&(Hb.a.removeHandler(this.qab.g5a.contentWindow,"message",Object(r.a)(this,this.iph,"showOneDriveFilePickerDialog")),this.MRc=!1)}static xdi(){const n=CommonUIStrings.l_AttributionText.split(/[{}]+/);return aj.e(n,O=>!!O)}static Jci(n,O){const ha=
document.createElement("body");var Aa="";let La="",Bb=CommonUIStrings.L_CCYYSA;void 0!==O&&null!==O&&(void 0!==O.PageUrl&&null!==O.PageUrl&&(Aa=O.PageUrl),void 0!==O.LicenseDisplayName&&null!==O.LicenseDisplayName&&0<O.LicenseDisplayName.length&&(Bb=O.LicenseDisplayName),void 0!==O.LicenseUrl&&null!==O.LicenseUrl&&(La=O.LicenseUrl));for(const Wb of n){switch(Wb){case "L_ThePhoto":n=Vb.$Hf(CommonUIStrings.l_ThePhoto,Aa);break;case "L_CCYYSA":n=Vb.$Hf(Bb,La);break;case "L_PhotoAuthor":n=Vb.qIf(CommonUIStrings.l_PhotoAuthor);
break;default:n=Vb.qIf(Wb)}n&&ha.appendChild(n)}Aa=document.createElement("html");Aa.appendChild(ha);return Aa}static qIf(n){const O=document.createElement("span");O.innerText=n;return O}static $Hf(n,O){const ha=document.createElement("A");ha.setAttribute("href",O);ha.setAttribute("target","_blank");ha.setAttribute("rel","noreferrer");O=document.createElement("span");O.innerText=n;ha.appendChild(O);return ha}static Tye(n){const O=Vb.xdi();return Vb.Jci(O,n)}static Ns(){}static zcj(n,O){let ha;n&&
15===n.zj?(ha=Zc.a.Ie(n.RTe,0,!1),n=Zc.a.Ie(n.I3d,0,!1)):O&&0<O.Width&&0<O.Height?(ha=O.Width,n=O.Height):(ha=Zc.a.Ie(2,0,!1),n=Zc.a.Ie(2,0,!1));return{width:ha,height:n}}}Vb.cig=!1;Object(h.a)(Vb,"InsertMediaActor",null,[234]);var Ed=d(681);class ae{}ae.Ajl=864E5;ae.V4h=3;ae.iek=144E5;Object(h.a)(ae,"AddinConstantsNum",null,[]);var Rd;(function(n){n[n.notSupported=-1]="notSupported";n[n.OMEX=0]="OMEX";n[n.spCatalog=1]="spCatalog";n[n.spApp=2]="spApp";n[n.fileSystem=3]="fileSystem";n[n.exchange=4]=
"exchange";n[n.oneDrive=5]="oneDrive";n[n.registry=6]="registry";n[n.inMemory=7]="inMemory";n[n.uploadFileDevCatalog=8]="uploadFileDevCatalog";n[n.hardCodedPreinstall=9]="hardCodedPreinstall";n[n.privateCatalog=10]="privateCatalog";n[n.wopiCatalog=16]="wopiCatalog"})(Rd||(Rd={}));Object(h.b)("AddinProviderType",Rd);var pe=d(529);class ff{constructor(n,O,ha){this.Ltd=2;this.m2b=n;this.wWh=O;this.hw=ha}get y7a(){return this.Ltd}get kvl(){return this.wWh}YEe(n){if(v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("AgaveSupportsLiveIdSpoofing"))this.m2b(n,
this.y7a,{["ak0"]:(new Date).getTime()});else if(pe.a.D7k(n)){var O=String.format(v.AFrameworkApplication.Ba.jb.tda+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",v.AFrameworkApplication.Ba.jb.vm,this.kvl,v.AFrameworkApplication.$g);const ha=v.AFrameworkApplication.Be;let Aa=null;this.hw&&(Aa=this.hw.wi("ComponentAttach",Rd[n]+Ed.a[this.y7a]));ha.Jj(O,1,null,null,!0,4,La=>{this.hnk(n,La.data.je);Aa&&Aa.stop()},La=>{m.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",
La.data.tf);Aa&&Aa.stop()},null)}else pe.a.Ghg(n)&&(O=pe.a.u5f(n),this.m2b(n,this.y7a,{["ak0"]:O}))}hnk(n,O){if(O&&""!==O&&(O=Sys.Net.XMLDOM(O))){pe.a.GIb(ni.a.OCf,((new Date).getTime()+ae.iek).toString(),n);let ha=O.getElementsByTagName("update");ha&&ha.length||(ha=O.getElementsByTagName("o:update"));ha&&0<ha.length&&(O=Date.parse(ha[0].firstChild.nodeValue),(pe.a.u5f(n)<O||pe.a.Ghg(n))&&this.m2b(n,this.y7a,{["ak0"]:O}))}}}Object(h.a)(ff,"AddinCommandsAnonymousAPIInitializer",null,[1087]);class eg{constructor(n,
O,ha){this.Ltd=ha;this.m2b=n;this.Sh=O}get y7a(){return this.Ltd}YEe(n){let O=null;this.Sh&&(O=this.Sh.wi("ComponentAttach",Rd[n]+Ed.a[this.y7a]));(null==this.qKe(n)?0:this.qKe(n))&&this.m2b(n,this.y7a,{["ak0"]:(new Date).getTime()-ae.V4h*ae.Ajl});O&&O.stop()}}Object(h.a)(eg,"AddinCommandsInitializerBase",null,[1087]);class kh extends eg{constructor(n,O){super(n,O,5)}qKe(){return!0}}Object(h.a)(kh,"AddinCommandsInitializer",eg,[]);class Wa extends eg{constructor(n,O){super(n,O,1)}qKe(n){try{const O=
ni.a.W8f()+n;return Boolean.parse(this.cXi(O)||"false")}catch(O){m.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",O.toString())}return null}cXi(n){const O=localStorage;return void 0!==O&&null!==O?O.getItem(n):null}}Object(h.a)(Wa,"AddinCommandsLocalCacheInitializer",eg,[]);class qb{constructor(n){this.hw=n}get appUILocale(){return hl.a.re(v.AFrameworkApplication.lcid).name}Muj(){const n=this.eXd();if(n)if(v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("OcpsIsEnabled"))u.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(O=>
{O.isFeatureEnabled("ConnectedServices",!0).then(ha=>{for(let Aa of n){if(!ha&&0===Aa.key)continue;const La=this.$4f(Aa.value);La&&La.YEe(Aa.key)}return null})});else for(let O of n){const ha=this.$4f(O.value);ha&&ha.YEe(O.key)}}ZEe(n,O,ha){ha&&ha[ni.a.Omb]&&(ha[ni.a.Fza]=n,ha[ni.a.yaa]=O,this.iyk(G.a.MEb,ha),pe.a.GIb(ni.a.Omb,ha[ni.a.Omb].toString(),n))}$4f(n){let O=null;switch(n){case 1:O=new Wa(Object(r.a)(this,this.ZEe,"retrieveAddinFlagCompleted"),this.hw);break;case 2:O=new ff(Object(r.a)(this,
this.ZEe,"retrieveAddinFlagCompleted"),this.appUILocale,this.hw);break;case 5:O=new kh(Object(r.a)(this,this.ZEe,"retrieveAddinFlagCompleted"),this.hw)}return O}}Object(h.a)(qb,"AddinCommandsInitializerHost",null,[]);var dg=d(1086),zb=d(52),km=d(161);class Nj extends qb{constructor(n,O){super(n.ndg());this.Kp=n;this.kc=O;dg.a.K1b=dg.a.y4g}znl(){this.Muj()}eXd(){const n=new km.a;this.kc.ka(zb.a.pa(51))&&(n.$(0,2),n.$(16,5));this.kc.ka(zb.a.pa(187))&&n.$(1,1);this.Kp.kd.Sra&&n.$(8,1);this.kc.ka(zb.a.pa(305))&&
n.$(10,5);return n}iyk(n,O){this.Kp.lK().Ma(n,2,O)}}Object(h.a)(Nj,"AddinCommandsInitService",qb,[998]);class Wj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AddinCommands"}Yb(n){this.K=n;u.a.instance.register(Nj,"PowerPointWebEditor.AddinCommandsInitService").as("PowerPointWebEditor.IAddinCommandsInitService").na(()=>new Nj(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("Common.IAppSettingsManager"))).ma()}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Wpg&&
this.K.resolve("Common.IAppSettingsManager").gf(()=>{u.a.instance.resolve("PowerPointWebEditor.IAddinCommandsInitService").znl()})}dispose(){}}Object(h.a)(Wj,"AddInCommandsInitPackage",null,[2,3]);class Oj extends rd{constructor(n,O=null){super(n,!0,O,!1)}get t4d(){return null}get fla(){return v.AFrameworkApplication.qqa?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get Mvb(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get Uzc(){return null}}
Object(h.a)(Oj,"DownloadAsPdfDialog",rd,[]);class Tl extends Oj{constructor(n){super(n)}get fla(){return v.AFrameworkApplication.qqa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}G5b(){K.a.J(25544926,801,50,"Images download dialog displayed")}I5b(){K.a.J(25544928,801,50,"Images download dialog link clicked")}l9a(){K.a.J(25544930,801,50,"Images download dialog button clicked")}}Object(h.a)(Tl,"DownloadACopyAsImagesDialog",Oj,[]);var qo=d(192);class lm extends Fc{constructor(n){super(n,
void 0,v.AFrameworkApplication.qqa)}get fla(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady}get Mvb(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion}get r5b(){return"DownloadOdpLink"}get buttonText(){return ResourceStrings.L_Download}get vWb(){return v.AFrameworkApplication.qqa?"UIFontDialogTextLarge":null}G5b(){K.a.J(8958087,801,50,"ODP download dialog displayed")}I5b(){K.a.J(8958089,801,50,"ODP download dialog link clicked")}l9a(){K.a.J(19505496,801,50,"ODP download dialog button clicked")}WUc(){qo.Redirect.showHelp("PPTODF");
return!0}get o5b(){return v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("EnableReactDialogs")&&xh.a("ReactDialogsODPDialogFix")?null:"#"}get hSa(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText}get SRg(){return!v.AFrameworkApplication.qqa}}Object(h.a)(lm,"DownloadACopyAsOdpDialog",Fc,[]);class Jo extends Oj{constructor(n){super(n)}get fla(){return v.AFrameworkApplication.qqa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}G5b(){K.a.J(21050910,
801,50,"PDF download dialog displayed")}I5b(){K.a.J(21050912,801,50,"PDF download dialog link clicked")}l9a(){K.a.J(21050914,801,50,"PDF download dialog button clicked")}}Object(h.a)(Jo,"DownloadACopyAsPdfDialog",Oj,[]);var vl=d(1110),An=d(377);class uj extends An.a{constructor(n,O,ha){super();this.EW=null;this.sXc=0;this.Wd=this.wKg=null;this.t4j=n;this.VYj=O;this.uWj=ha;this.KVa=Object(r.a)(this,this.g4,"onRequestComplete");this.onError=Object(r.a)(this,this.Lkk,"onRequestError")}get sdc(){return this.wKg}set sdc(n){this.wKg=
n}get hy(){return this.Wd}set hy(n){this.Wd=n}start(){this.PGb()}PGb(){1!==v.AFrameworkApplication.Ba.state&&(this.EW=new vl.a,this.EW.Zq=!1,this.EW.vd=5,this.EW.message=this.t4j,this.EW.Rma(ResourceStrings.l_GenericDialogTitle,null,null),this.sXc=0)}lS(){this.EW&&(this.EW.close(),this.EW=null)}g4(n){this.lS();n.aPa?this.sdc(n):this.AX()}Lkk(n){n.WMi&&this.sXc<uj.nUk?(this.sXc+=1,n.start()):this.AX()}AX(){this.lS();if(1!==v.AFrameworkApplication.Ba.state){const n=new Ca.StandardDialog;n.vd=0;n.Sx(this.uWj,
ResourceStrings.l_GenericDialogTitle,this.VYj,this.hy)}}}uj.nUk=3;Object(h.a)(uj,"UIBlockingTask",An.a,[]);var cf=d(275);class Tm extends uj{constructor(n){super(ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,Sa.a.Vdk);this.NA=n}start(){super.start();cf.a.Vsi(this.NA,Object(r.a)(this,this.Fba,"handleWebserviceResponse"),Object(r.a)(this,this.Eba,"handleWebserviceError"))}}Object(h.a)(Tm,"ConvertToOdpTask",uj,[]);class $o extends uj{constructor(n){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.l_ConvertingToPdfErrorString,Sa.a.Zrk);this.NA=n}start(){super.start();cf.a.Xsi(this.NA,Object(r.a)(this,this.Fba,"handleWebserviceResponse"),Object(r.a)(this,this.Eba,"handleWebserviceError"))}}Object(h.a)($o,"ConvertToPdfTask",uj,[]);class vf{constructor(n,O,ha){this.JXc=n;this.ee=O;this.Xfe=ha}get $pb(){return this.JXc.value}convert(n,O,ha){let Aa=null;0===O?this.Xfe?new lm(ha):(Aa=new Tm(n),Aa.sdc=Object(r.a)(this,this.mgk,"onConvertOdpRequestSucceeded"),Aa.start()):1===O?this.ee.kd.Nsg&&
this.Xfe?new Jo(ha):za.a.iK(za.a.Db,()=>{Aa=new $o(n);Aa.sdc=Object(r.a)(this,this.ngk,"onConvertPdfRequestSucceeded");Aa.start()}):2===O?this.ee.kd.bvg&&this.Xfe&&new Tl(ha):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",O))}mgk(n){n=n.result;1!==v.AFrameworkApplication.Ba.state&&(n=Yc.a.yBa(n.PrintUrl),new lm(n))}ngk(n){n=n.result;1!==v.AFrameworkApplication.Ba.state&&(n=Yc.a.yBa(n.PrintUrl),this.$pb.PPf=new Date,new Jo(n),this.$pb.vVf=new Date,K.a.J(21050908,801,
50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.$pb.kXf.toString(),this.$pb.Agh.toString(),this.$pb.PPf.toString(),this.$pb.vVf.toString()))}}Object(h.a)(vf,"Converter",null,[1043]);class Ve{constructor(){this.kXf=this.Agh=this.PPf=this.vVf=Zf.App.Bm}}Object(h.a)(Ve,"DownloadACopyAsPdfContext",null,[]);class pf extends uj{constructor(n,O){super(ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,
Sa.a.Nxk);this.NA=n;this.M7j=O}start(){super.start();cf.a.print(this.NA,this.M7j,Object(r.a)(this,this.Fba,"handleWebserviceResponse"),Object(r.a)(this,this.Eba,"handleWebserviceError"))}}Object(h.a)(pf,"PrintTask",uj,[]);class fe{constructor(n,O,ha){if(!n)throw Error.argumentNull("directPrintManager");this.e7b=n;this.ee=O;this.iZj=ha}nkk(n){this.e7b.Zxk();n=n.result;1!==v.AFrameworkApplication.Ba.state&&(n=Yc.a.yBa(n.PrintUrl),this.e7b.kph(n))}print(n,O,ha){this.ee.kd.Nsg&&this.iZj?(n=new bf.QueryStringBuilder(O),
n.nj(rh.a.cqk,this.e7b.ioh().toString()),n.nj(rh.a.Zpk,ha.toString()),this.e7b.kph(n.toString())):(ha=new pf(n,this.e7b.ioh()),ha.sdc=Object(r.a)(this,this.nkk,"onPrintRequestSucceeded"),ha.start())}}Object(h.a)(fe,"Printer",null,[1001]);class te{get name(){return"PowerPointWebEditor.PrintPackage"}Yb(){u.a.instance.register(fe,"PowerPointWebEditor.Printer").as("PowerPointWeb.IPrinter").ma().na(()=>new fe(u.a.instance.qb("Common.App.DirectPrint.IDirectPrintManager"),u.a.instance.qb("PowerPointWebEditor.IApplicationContext"),
u.a.instance.qb("PowerPointWebEditor.IApplicationSettings").zg));u.a.instance.register(vf,"PowerPointWeb.Converter").as("PowerPointWeb.IConverter").ma().na(()=>new vf(u.a.instance.qe("PowerPointWebEditor.DownloadACopyAsPdfContext"),u.a.instance.qb("PowerPointWebEditor.IApplicationContext"),u.a.instance.qb("PowerPointWebEditor.IApplicationSettings").zg));u.a.instance.register(Ve,"PowerPointWebEditor.DownloadACopyAsPdfContext").ma().na(()=>new Ve)}init(){}dispose(){}}Object(h.a)(te,"PrintPackage",null,
[2,3]);class ne{constructor(n,O){this.actionId=n;this.od=O}}Object(h.a)(ne,"CommandActionData",null,[]);class Pj{constructor(n,O,ha,Aa,La){this.EPg=[];this.yug=!1;this.ede=null;this.VWc=new C.a;this.ia=n;this.wne=O;this.Izf=!1;this.Ib=ha;this.sI=Aa;this.K3=La;this.I0c=null}get ald(){return this.EPg}get OUg(){this.I0c||(this.I0c=v.AFrameworkApplication.Rj("officeExtensionMerge.js",5));return this.I0c}set OUg(n){this.I0c=n}get S6h(){if(!this.ede){const n=[this.K3.gWb(this.OUg)];this.ede=rb.a.create("pptedit.appforoffice",
n,()=>d.e(9).then(d.bind(null,1193)))}return this.ede}N_h(n){this.ald.push(n)}w3a(){this.yug||(cc.a.nt(this.S6h),this.yug=!0)}cml(){for(const n of this.ald)n.Sfb();this.EPg=[]}dml(){var n=this.Ib.Jc(this.wne.Bf).yb(18);n=this.Ib.Jc(n);var O=n.yb(19);if(O){do O=n.Gp,O=O.getValue(dc.a.yY),this.ia.Ma(Ab.a.jeb,2,O);while(n.xf(19))}}Qyc(n,O){this.VWc.add(new ne(n,O))}lij(){if(0<this.VWc.count){for(let n of this.VWc)this.ia.Ma(n.actionId,2,n.od);this.VWc.clear()}}d3d(){const n=!!this.ald&&0<this.ald.length;
let O=!1;if(this.wne.Bf&&!n){const ha=this.Ib.Jc(this.wne.Bf).yb(18);ha&&0<this.Ib.Jc(ha).X6(19)&&(O=!0)}return n||O}}Object(h.a)(Pj,"AppForOfficeManagerFactory",null,[974]);class hk extends Vk{constructor(n,O,ha){super(n,O);this.la=ha;this.BA=Ab.a.wob}Rra(n){if(n&&n.length){var O=Ab.a.uz(this.BA),ha=this.kBj(n[0]);try{K.a.J(512517845,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",O,ha?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload");
if(32!==(ha?this.Ho.Ma(Ab.a.tCc,2,n):this.Ho.Ma(this.BA,2,n[0])))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",ha?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));K.a.J(512517844,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",O,ha?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(Aa){K.a.J(512517843,352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",
O,Aa.toString())}}}kBj(n){(n=!!n&&!!n.OriginalUrl&&0<n.OriginalUrl.length&&this.la.pptSmartArtSubNodeIconChangeEnabled&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=n.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&n.OriginalUrl.toLowerCase().indexOf(".svg")===n.OriginalUrl.length-4)||K.a.J(512517842,352,50,"isChangeSvg = false");return n}}Object(h.a)(hk,"ChangeOnlineImageHelper",Vk,[]);class xm extends Vk{constructor(n,
O,ha){super(n,O);this.la=ha;this.BA=Ab.a.F7a}Rra(n){if(n&&n.length){var O=Ab.a.uz(this.BA),ha=new Map;ha.set("InsertMediaCommand",O);Wc.Health.instance.recordKpiUsageForAlertableKpi("InsertOnlineImage",null,ha);try{const La=[],Bb=[];for(let uc=0;uc<n.length;uc++){const Vc=n[uc];this.jtg(Vc)?Array.add(La,Vc):Array.add(Bb,Vc)}K.a.J(512517841,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",Bb.length,La.length,O);let Wb=this.BA;Wb===Ab.a.mQc&&(Wb=Ab.a.c6d);for(n=0;n<Bb.length;n++){var Aa=
this.Ho.Ma(Wb,2,Bb[n]);if(32!==Aa)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",Bb.toString(),O));}if(this.jtg(La[0])&&(Aa=this.Ho.Ma(Ab.a.mQc,2,La),32!==Aa))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",La.toString()));K.a.J(512517840,352,50,"InsertMediaCallback: Insert {0} pictures {1} svg images success, command: {2}.",Bb.length,La.length,O)}catch(La){K.a.J(512517839,352,10,"InsertMediaActor::{0}: Exception = [{1}].",
this.BA.toString(),La.toString()),ha.set("Exception",La.toString()),Wc.Health.instance.recordKpiFailure("InsertOnlineImage","InsertMediaException",!1,!0,Object.assign(new Wf.a,{extendedProperties:ha}))}}}jtg(n){(n=!!n&&!!n.OriginalUrl&&0<n.OriginalUrl.length&&this.la.E7a&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=n.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&n.OriginalUrl.toLowerCase().indexOf(".svg")===
n.OriginalUrl.length-4)||K.a.J(512517838,352,50,"isInsertSvg = false");return n}}Object(h.a)(xm,"InsertOnlineImageHelper",Vk,[]);var Pi=d(701);class Ce{constructor(n,O){this.J$a=!1;this.$$a=new Date(0);this.Z$a=new Date(0);this.yoe=n;this.Bb=O}Tfg(){this.J$a=!0}NHa(){this.J$a?K.a.J(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.$$a>this.Z$a?K.a.J(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+
this.$$a+". Last scan at "+this.Z$a+"."):(this.$$a=new Date,this.Bb.Hb(new Y.a(3,1,0,Object(r.a)(this,this.yFe,"runJob"),90,"112")))}yFe(){this.Z$a=new Date;this.J$a?K.a.J(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.yoe()&&this.NHa()}}Object(h.a)(Ce,"PrefetchScheduler",null,[]);class Wk{constructor(n,O,ha){this.GWc=null;this.JFg=O;this.$Bg=ha;this.hwb=n}EYk(n){this.hwb!==n&&(this.hwb=n,this.GWc=null)}fbj(){this.GWc||(this.GWc=
this.ygi());return this.GWc}ygi(){const n=[];Array.add(n,this.hwb);for(let O=1;O<=this.JFg||O<=this.$Bg;O++)O<=this.JFg&&Array.add(n,this.hwb+O),O<=this.$Bg&&0<=this.hwb-O&&Array.add(n,this.hwb-O);return n}}Object(h.a)(Wk,"SlideWindow",null,[]);class vk{constructor(n,O,ha,Aa,La,Bb,Wb,uc){this.vbb=!1;this.uc=La;this.Rp=Aa;this.pua=uc;this.t9a=new Pi.a;this.Oz=new Ce(Object(r.a)(this,this.gRe,"tryScan"),Bb);this.mQg=new Wk(Aa&&Aa.Ca?Aa.Ca.slideIndex:0,Wb?Wb.hfl:10,Wb?Wb.gfl:5);this.nJe(n,O,ha)}start(){this.vbb?
K.a.J(593884825,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):(K.a.J(593773075,813,100,"StreamVideoPrefetchOrchestrator Starting."),this.vbb=!0,this.Oz.NHa())}nJe(n,O,ha){n&&n.xM(Object(r.a)(this,this.K6c,"onEditSlideChanged"));O&&O.zga(Object(r.a)(this,this.G7c,"onPageContentLoaded"));ha&&ha.rpa(Object(r.a)(this,this.emk,"onSlideshowSlideChanged"))}G7c(n,O){this.vbb&&(n=Object(M.a)(132,O.node))&&n.NB&&(this.t9a.remove(n.Cb),this.Oz.NHa())}K6c(n,
O){O&&O.nla&&this.hC(O.nla.slideIndex)}emk(n,O){O&&this.hC(O.slideIndex)}hC(n){this.mQg.EYk(n);this.vbb&&this.Oz.NHa()}gRe(){const n=this.K0d();0<n.length&&this.bGe(n[0]);return 1<n.length}K0d(){const n=[];var O=this.Rp.presentation;if(!O)throw Error.argumentNull("Presentation is null");O=O.slides||[];for(const ha of this.mQg.fbj()){const Aa=O[ha];this.Hnh(Aa)&&Array.add(n,Aa)}return n}Hnh(n){return!!n&&n.NB&&!n.zK&&!this.t9a.contains(n.Cb)}bGe(n){this.t9a.add(n.Cb);n=this.Pbj(n);0<n.length&&(K.a.J(593773072,
813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",n.length),this.pua?this.pua.xwk(n):K.a.J(593773070,813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null."))}Pbj(n){if(!this.uc)return K.a.J(593884821,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),this.Oz.Tfg(),[];const O=[];if(!n)return O;n=Object(M.a)(132,n);if(!n)return O;for(const ha of n.km())(n=
ha.pna)&&this.pua&&this.pua.K8a(n)&&Array.add(O,n);return O}static dJj(n){return!!n&&n.lwg&&!Ic.a.Ji&&!Ic.a.$Ca&&!Ic.a.dI&&!Ic.a.yae}}Object(h.a)(vk,"StreamVideoPrefetchOrchestrator",null,[]);class nf{static addAppPLTEventToLog(n){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(n)}catch(O){}}static setIsPageLoadForFirstTime(n){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(n)}catch(O){}}}Object(h.a)(nf,"VersionHistoryLogConnector",null,[]);
class qg{constructor(n,O,ha,Aa){this.MW=null;this.beh=this.ResetAppVersionController;this.bC=n;this.vi=O;this.Ha=ha;this.qc=Aa;this.RUa={}}OnVersionHistorySelected(n,O){try{K.a.J(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");const ha=document.getElementById("VersionHistoryViewerSpinner");ha&&(ha.style.display="none");if(this.MW)this.MW.onVersionSelected(n,O,this.RUa)}catch(ha){K.a.J(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",
ha)}}ResetAppVersionController(n){try{if(this.MW)nf.setIsPageLoadForFirstTime(!1),this.MW.switchParentViewContainer(n);else{nf.setIsPageLoadForFirstTime(!0);const O=new PowerPointVersionHistory.AppBootSettings;O.RenderServiceBase="";O.IsRtl=!1;const ha=new PowerPointVersionHistory.AppCallbackBag;ha.animationDecoratorCallback=Object(r.a)(this.bC,this.bC.gOd,"createAnimationOrTransitionStar");ha.notesIconDecoratorCallback=Object(r.a)(this,this.CreateNotesIcon,"CreateNotesIcon");O.IsHighContrast=!1;
this.vi&&(O.IsHighContrast=this.vi.isInHighContrastMode);O.IsHighContrast&&(O.ClientColorSettings=this.vi.highContrastColors.foregroundTextColor+"_"+this.vi.highContrastColors.backgroundColor+"_"+this.vi.highContrastColors.linkColor);if(this.qc){const Aa=this.qc.cQa();O.DefaultSlideWidth=Aa.width;O.DefaultSlideHeight=Aa.height}O.UserSessionId=v.AFrameworkApplication.userSessionId;O.VersionViewerCssUrl=this.Ha.versionHistoryViewerCssUrl;O.ProgressImageResourceUrl=Lg.a.bK(lb.a.Xla);this.MW=new PowerPointVersionHistory.AppVersionController(O,
n,ha)}}catch(O){K.a.J(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",O)}}CreateNotesIcon(){return Fa.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,"Notes")}}Object(h.a)(qg,"PPTVersionHistorySelectionHandler",null,[973]);class ro extends Fc{constructor(n){super(n,void 0,v.AFrameworkApplication.qqa)}get fla(){return CommonUIStrings.l_DownLoadACopyDialogMessage}get Mvb(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get r5b(){return"PowerPointDownloadCopyLink"}get buttonText(){return CommonUIStrings.l_Download}get vWb(){return v.AFrameworkApplication.qqa?
"UIFontDialogTextLarge":null}G5b(){K.a.J(19743688,801,50,"Download a copy dialog displayed")}I5b(){K.a.J(19743690,801,50,"Download a copy dialog clicked")}l9a(){K.a.J(19743692,801,50,"Download a copy dialog button clicked")}}Object(h.a)(ro,"PowerPointDownloadACopyDialog",Fc,[]);class Xk{W$k(n){new ro(n)}}Object(h.a)(Xk,"PowerPointDownloadACopyDialogFactory",null,[941]);var Um;(function(n){n[n.unknown=0]="unknown";n[n.bing=1]="bing";n[n.M365=2]="M365";n[n.icons=3]="icons";n[n.oneDrive=4]="oneDrive";
n[n.hubbleVideos=5]="hubbleVideos"})(Um||(Um={}));Object(h.b)("InsertMediaProviders",Um);var Xj;(function(n){n[n.OK=0]="OK";n[n.cancel=1]="cancel";n[n.error=2]="error";n[n.open=3]="open"})(Xj||(Xj={}));Object(h.b)("HubbleAction",Xj);var ap=d(521);class ym extends be.a{constructor(n,O,ha,Aa,La){super();this.nM=null;this.Sqc=!1;this.g8b=this.swd=this.qW=null;this.iKd="KeepFocusDiv";this.jKd="KeepFocusStartDiv";this.correlationId=null;this.Y3=0;this.insertPictureTelemetryEndpoint=null;this.aRd=0;if(!n)throw Error.argumentNull("insertMediaSeviceEndpoint",
"insertMediaSeviceEndpoint cannot be null.");this.$4e=n;this.d_e="";this.iNb=ha;this.K0=Aa;this.Xya=[];this.nzd=O;this.Wf=La||Ji.Wf;this.kg="InsertMediaDialog";this.f3d=!1;this.vd=5}get Wn(){return fc.FocusManager.instance()}NGb(n,O){this.d_e=n;this.Sqc=!1;this.showDialog(this.d_e,null);this.qW=this.dLc(this.ki("insertmediaframe"));if(!this.qW)throw this.O4a(this.oBc),Error.invalidOperation("Couldn't get InsertMediaIframe.");(n=document.getElementById(this.ki("WACDialogPanel")))&&n.setAttribute(ka.a.ff,
ka.a.uId);n=document.createElement("div");n.setAttribute("Id",this.jKd);n.setAttribute("tabindex","0");n.setAttribute("position","absolute");n.setAttribute("width","-1000px");n.setAttribute("top","-1000px");this.qW.parentNode.insertBefore(n,this.qW.parentNode.firstChild);n=document.createElement("div");n.setAttribute("Id",this.iKd);n.setAttribute("tabindex","0");this.qW.parentNode.appendChild(n);n.setAttribute("position","absolute");n.setAttribute("width","-1000px");n.setAttribute("top","10000px");
$addHandler(this.$Qd,"keydown",Object(r.a)(this,this.xz,"keyDownHandler"));this.qW.setAttribute("src",this.$4e);this.qW.setAttribute("width","100%");this.qW.setAttribute("height","100%");this.qW.setAttribute("frameborder","0");v.AFrameworkApplication.fa.ka("ShowInsertMediaIframeWhenIframeIsReady")&&(Ic.a.ag||Ic.a.n4b)?(this.qW.style.visibility="hidden",this.g8b=Object(r.a)(this,this.rik,"onInsertMediaIframeLoaded"),Hb.a.addHandler(this.qW,"load",this.g8b)):this.qW.style.visibility="visible";this.dLc(this.ki("WACDialogTitleText")).style.display=
"none";if(2===this.Y3||5===this.Y3)this.dLc(this.ki("WACDialogTitlePanel")).style.display="none",this.dLc(this.ki("WACDialogBodyPanel")).style.padding="0";fc.FocusManager.instance().Mk().scope.HK=!0;this.nM=this.nzd.getInstance(this.qW.contentWindow,this.$4e);this.nM.Jva(Xf.a.FAf,ha=>{this.sek(ha,Object(r.a)(O,O.Rra,"insertMediaCallback"))});this.nM.Jva(Xf.a.insert,ha=>{this.Yue(ha,Object(r.a)(O,O.Rra,"insertMediaCallback"))});this.nM.Jva(Xf.a.f_h,ha=>{this.Djk(ha)});this.nM.Jva(Xf.a.SZi,Object(r.a)(this,
this.Dhk,"onGetCustomHeaders"));this.nM.Jva(Xf.a.Z$i,Object(r.a)(this,this.Ohk,"onGetSessionId"));this.nM.Jva(Xf.a.bXi,Object(r.a)(this,this.Bhk,"onGetCID"));this.nM.Jva(Xf.a.Ahi,Object(r.a)(this,this.zfk,"onCancelDialog"));2===this.Y3&&0===this.aRd&&(this.nM.Jva(Xf.a.MPj,Object(r.a)(this,this.Lik,"onLaunchM365Upsell")),this.swd=this.K0.Xdb("MsoPremiumStockImages",ha=>{m.ULS.sendTraceTag(541172692,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");this.nM.sendMessage(Xf.a.Hul,{["LicenseTier"]:ha.toString()})}));
this.cjc(3)}rik(){this.qW&&(this.qW.style.visibility="visible",window.setTimeout(()=>{if(this.mi){const n=this.mi.getElementById("insertmediaframe");n&&n.focus()}},0))}xz(n){n.keyCode===Sys.UI.Key.tab&&(n.target.id!==this.iKd||n.shiftKey?n.target.id===this.jKd&&n.shiftKey&&(n.preventDefault(),this.mi.getElementById(this.iKd).focus()):(n.preventDefault(),this.mi.getElementById(this.jKd).focus()))}dispose(){this.K0&&this.swd&&this.K0.fEb("MsoPremiumStockImages",this.swd);this.nM&&(this.nM.dispose(),
this.nM=null);this.g8b&&(Hb.a.removeHandler(this.qW,"load",this.g8b),this.g8b=null);super.dispose()}sek(n,O){m.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(n=this.iNb.l2g(n))50<this.Xya.length?m.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this.Xya,n),this.Sqc&&(O(this.Xya),this.Sqc=!1))}zfk(){m.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.O4a(this.oBc);this.cjc(1)}cjc(n){var O=RegExp("hubble","gi");if(this.insertPictureTelemetryEndpoint&&
0<this.insertPictureTelemetryEndpoint.search(O)&&this.correlationId){O=v.AFrameworkApplication.Zc;var ha={};ha.InsertedFiles=this.Xya.length;ha.DialogResult=Xj[n];ha.DialogMode=this.W4i();ha.CorrelationId="{"+this.correlationId.toString()+"}";ha.Platform="Wac";ha.Provider=Um[this.Y3]||"Unknown";ha.AudienceGroup=O&&"AudienceGroup"in O?O.AudienceGroup.toString():"Unknown";ha.Ring=O&&"Ring"in O?O.Ring.toString():"Unknown";ha.AppId=Zf.App.mode;ha.Build=v.AFrameworkApplication.buildVersion;ha.Locale=hl.a.re(v.AFrameworkApplication.lcid).name;
this.hWa().send(JSON.stringify(ha))}if(2===this.Y3||5===this.Y3){const Aa=v.AFrameworkApplication.fa.Ia("InsertMediaDialogAriaTenantNameSpace");Aa&&""!==Aa&&(O=[],ha="InsertUnknownContent",2===this.Y3?(Array.add(O,Object.assign(new E.a,{name:"DialogMode",string:"M365Content"})),Array.add(O,Object.assign(new E.a,{name:"Provider",string:"M365Content"})),ha="InsertM365Content"):5===this.Y3&&(Array.add(O,Object.assign(new E.a,{name:"DialogMode",string:"HubbleVideo"})),Array.add(O,Object.assign(new E.a,
{name:"Provider",string:"HubbleVideo"})),ha="InsertHubbleVideo"),Array.add(O,Object.assign(new E.a,{name:"InsertedFiles",int64:this.Xya.length})),Array.add(O,Object.assign(new E.a,{name:"DialogResult",string:Xj[n]})),Array.add(O,Object.assign(new E.a,{name:"CorrelationId",string:this.correlationId.toString()})),x.a.sendTelemetryEvent(Object.assign(new I.a,{name:String.format("{0}.{1}",Aa,ha),dataFields:O})))}}W4i(){return 3===this.Y3?"Icons":"Images"}dLc(n){const O=document.getElementById(n);if(!O)throw Error.invalidOperation(String.format("Couldn't get {0}.",
n));return O}hWa(){const n=new XMLHttpRequest;n.open("POST",this.insertPictureTelemetryEndpoint,!0);n.setRequestHeader("Content-Type","");return n}Yue(n,O){m.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.O4a(this.oBc);O?this.Xya&&0<this.Xya.length?(O(this.Xya),this.cjc(0)):(m.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.Sqc=!0,O(this.Xya),this.cjc(2)):this.cjc(2)}Dhk(){this.nM&&(m.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.nM.sendMessage(Xf.a.UZk,
{["CustomHeaders"]:""}))}Ohk(){this.nM&&(m.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.nM.sendMessage(Xf.a.D2k,{["SessionId"]:v.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}Bhk(){this.nM&&(m.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.nM.sendMessage(Xf.a.pZk,{["CID"]:""}))}Djk(n){n&&n.Values&&(n=n.Values,delete n.m_Origin,delete n.m_Source,delete n.m_ReceivedTime,m.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+
n.eventName||!1),x.a.sendOtelEvent(Object.assign(new ap.a,{otelEvent:n})))}Lik(){this.K0&&(m.ULS.sendTraceTag(541172693,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.K0.launchUpsellExperience("stockimages"))}}Object(h.a)(ym,"InsertMediaDialog",be.a,[994,109]);class If{getInstance(n,O,ha,Aa,La){return new ym(n,O,ha,Aa,La)}}Object(h.a)(If,"PptInsertMediaDialogFactory",null,[970]);var Ul=d(109);class oi{constructor(n){this.s$a=n;this.nJe(this.s$a.Dk,this.s$a.bLg)}nJe(n,
O){n&&n.xM(Object(r.a)(this,this.K6c,"onEditSlideChanged"));O&&O.zga(Object(r.a)(this,this.G7c,"onPageContentLoaded"))}ALk(n,O){n&&n.H9(Object(r.a)(this,this.K6c,"onEditSlideChanged"));O&&O.HWa(Object(r.a)(this,this.G7c,"onPageContentLoaded"))}G7c(n,O){(n=Object(M.a)(132,O.node))&&n.NB&&(this.s$a.t9a.remove(n.Cb),this.s$a.Oz.NHa())}K6c(n,O){O&&O.nla&&(this.s$a.$sa=O.nla,this.s$a.Oz.NHa(),this.s$a.Pce=new Date)}}Object(h.a)(oi,"SlideEventListener",null,[]);class hg{constructor(n,O,ha){this.WOg="";
this.J$a=!1;this.$$a=new Date(0);this.Z$a=new Date(0);this.yoe=n;this.Bb=O;ha&&(this.WOg=ha)}Tfg(){this.J$a=!0}NHa(){this.J$a?K.a.J(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.$$a>this.Z$a?K.a.J(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.$$a+". Last scan at "+this.Z$a+"."):(this.$$a=new Date,this.Bb.Hb(new Y.a(3,
1,0,Object(r.a)(this,this.yFe,"runJob"),90,this.WOg)))}yFe(){this.Z$a=new Date;this.J$a?K.a.J(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.yoe()&&this.NHa()}}Object(h.a)(hg,"BackgroundJobScheduler",null,[]);class jl{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd){this.R2c=null;this.Pce=new Date;this.$sa=null;this.tFg={};this.oPg={};this.HPg={};this.wEg={};if(!ha)throw Error.argumentNull("graphTopologyManager");if(!Aa)throw Error.argumentNull("fontUtilsManager");
this.Rp=ha;this.Ay=Aa;this.Dk=n;this.bLg=O;this.Poe=uc;this.aac=Vc;this.Qoe=bd;this.K2c=xd;this.t9a=new Pi.a;this.Oz=new hg(Object(r.a)(this,this.gRe,"tryScan"),La,"");0<Bb&&window.setInterval(Object(r.a)(this,this.kAg,"logMissingFonts"),Bb);this.o2j=Wb;n=ha.Ca?ha.Ca.slideIndex:0;if(O=this.Rp.presentation)O=O.slides||[],n<O.length&&(this.$sa=O[n],this.Pce=new Date)}dispose(){this.stop();this.kAg()}start(){this.stop();this.R2c=new oi(this);this.Oz.NHa()}stop(){this.R2c&&this.R2c.ALk(this.Dk,this.bLg);
this.R2c=null}K0d(){const n=[];this.$sa&&n.push(this.$sa);return n}Hnh(n){return!!n&&n.NB&&!n.zK&&!this.t9a.contains(n.Cb)}gRe(){const n=this.K0d();0<n.length&&(this.bGe(n[0]),this.t9a.add(n[0].Cb));return 1<n.length}Zbe(n,O,ha,Aa){const La=[];for(const Bb of Object.keys(n))n[Bb]||this.wEg[Bb]||(La.push(Bb),this.wEg[Bb]=!0);n=La.length;0<n&&(K.a.J(ha,820,15,"{0}",n),O&&K.a.J(Aa,820,15,"{0}",La.join(",")))}bGe(n){const O=n.xra();if(O&&(this.Poe||this.Qoe||this.aac||xh.a("ShouldLogMissingThirdPartyFontCount"))){var ha=
{},Aa={},La={};n.U2f.split(",").forEach(bd=>{bd&&(bd=this.Ay.oF(bd),ha[bd]=!1)});n.Tuh.split(",").forEach(bd=>{bd&&(bd=this.Ay.oF(bd),Aa[bd]=!1)});n.Cyh.split(",").forEach(bd=>{bd&&(bd=this.Ay.oF(bd),La[bd]=!1)});n=[];var Bb=[],Wb=[];for(let bd=0;bd<O.length;bd++){var uc=O[bd];uc=Array.isArray(uc.hD())?uc.hD():null;for(const xd of uc)for(uc=0;xd.Ra&&uc<xd.Ra.length;){var Vc=xd.Ra.ga(uc);Vc=Vc.formatting?this.Ay.oF(Ul.Font.PBa(Vc.formatting.cache.VM.trim().toLowerCase())):"";ib.a.Xa(Vc)||(Vc in ha&&
!ha[Vc]?(n.push(Vc),ha[Vc]=!0):Vc in Aa&&!Aa[Vc]?(Bb.push(Vc),Aa[Vc]=!0):Vc in ha||Vc in Aa||La[Vc]||(Wb.push(Vc),La[Vc]=!0));uc++}}this.Poe&&(jl.F5d(this.tFg,n,this.Ay),this.Zbe(ha,!0,555886295,555886296));if(this.aac||xh.a("ShouldLogMissingThirdPartyFontCount"))jl.F5d(this.oPg,Bb,this.Ay),this.Zbe(Aa,this.aac||this.K2c,555886297,555886298);this.Qoe&&(jl.F5d(this.HPg,Wb,this.Ay),this.Zbe(La,this.K2c,555886299,555886300))}}kAg(){+new Date-+this.Pce<this.o2j||(this.Poe&&jl.ice(this.tFg,this.Ay,591003669,
!0,"MissingFirstPartyFonts"),(this.aac||xh.a("ShouldLogMissingThirdPartyFontCount"))&&jl.ice(this.oPg,this.Ay,591003667,this.aac||this.K2c,"MissingThirdPartyFonts"),this.Qoe&&jl.ice(this.HPg,this.Ay,587337796,this.K2c,"MissingNonLoggableFonts"))}static F5d(n,O,ha){O.forEach(Aa=>{xh.a("ShouldNormalizeFontNamesBeforeLogging")&&(Aa=ha.oF(Aa));if(void 0===n[Aa]||null===n[Aa])n[Aa]=!1})}static p5i(n,O){if(!n)throw Error.argumentNull("fonts");const ha=[];for(const Aa of Object.keys(n))n[Aa]||(O.A7(Aa)||
O.A7('"'+Aa+'"')||ha.push(Aa),n[Aa]=!0);return ha}static ice(n,O,ha,Aa,La){O=jl.p5i(n,O);n=O.length;0<n&&(O=O.join(","),Aa&&587337796===ha?K.a.J(ha,820,15,"{0}",O):K.a.J(ha,820,15,"{0}",Aa?O:n.toString()),ha=new Map,Aa&&ha.set("Fonts",O),ha.set("FontsCount",n.toString()),Wc.Health.instance.recordQosError(La,["MissingFont"],!1,!1,!0,!1,Object.assign(new Wf.a,{extendedProperties:ha})))}}Object(h.a)(jl,"FontLogger",null,[109]);class wg{constructor(){this.K3=this.hh=this.C3=this.K=null;this.qKg=[];this.Z6b=
[new te];this.zW=[]}get name(){return"PowerPointWebEditor.Chronos2"}Yb(n){this.K=n;this.C3=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.hh=this.C3.YBa(5,this.name);this.K3=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");for(let La=0;La<this.Z6b.length;++La)Array.add(this.zW,nc.a(this.Z6b[La],5));for(const La of this.zW)La.Yb(n);const O=this.K.resolve("PowerPointWebEditor.IApplicationContext"),ha=v.AFrameworkApplication.fa.ka("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),
Aa=Eh.a.su(this.K.Oa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.K.register(Pj,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").na(()=>new Pj(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"))).ma();this.K.register(qg,"PowerPointWebEditor.PPTVersionHistorySelectionHandler").as("Common.IVersionHistorySelectionHandler").ma().na(()=>
new qg(this.K.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(Jj,"Box4.Media.OneDriveFilePickerHelperV7").as("Box4.Media.IImageFilePickerHelper").ma().na(()=>new Jj(n.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72"),new gb.a(()=>Aa.result),n.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory")));
this.K.register(Uk,"Box4.Media.InsertOneDriveFileHelper").ma().na(()=>new Uk(v.AFrameworkApplication.Va));this.K.register(de,"Box4.Media.InsertMediaHelper").as("Box4.Media.IInsertMediaHelper").ma().na(()=>new de);this.K.register(xm,"PowerPointWebEditor.InsertOnlineImageHelper").ma().na(()=>new xm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(hk,"PowerPointWebEditor.ChangeOnlineImageHelper").ma().na(()=>
new hk(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(Rl,"Box4.Media.InsertMediaFromHostManagerFactory").as("Box4.Media.IInsertMediaFromHostManagerFactory").ma().na(()=>new Rl(new sj(new gb.a(()=>{if(v.AFrameworkApplication.hoh()){var La=this.K.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").g5a;La=new Pm(La.contentWindow,"*")}else La=O.p2i();return La}),ha?Yc.a.hS(window.document.URL):
Yc.a.hS(v.AFrameworkApplication.Rla),v.AFrameworkApplication.fa.appSettings.ImageFetcherSupportedExtensions)));this.K.register(gm,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ma();this.K.register(Dl,"Box4.Media.InsertMediaFromHostOneDriveHostFrame").as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ma().na(()=>new Dl);this.K.register(If,"PowerPointWebEditor.PptInsertMediaDialogFactory").as("PowerPointWebEditor.IPptInsertMediaDialogFactory").ma();
this.K.register(941,"PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory").ma().na(()=>new Xk);this.K.register(vk,"PowerPointWebEditor.StreamVideoPrefetchOrchestrator").ma().na(()=>new vk(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Video.IStreamPreFetchService")))}init(){let n=this.hh.Ut("resolvechronos2");const O=this.K.resolve("Common.AFrameworkApplication"),ha=this.K.resolve("PowerPointWebEditor.IApplicationContext"),Aa=ha.kd,La=O.Uq,Bb=this.K.resolve("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory"),Wb=this.K.resolve("Common.IActionManagerExtended"),uc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");
var Vc=this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper");const bd=this.K.resolve("PowerPointWebEditor.IFocusManager"),xd=La.Fd,xe=this.K.resolve("Common.Transaction.ITransactionFactory"),wf=this.K.resolve("PowerPointWebEditor.IShapeEditor"),Ze=this.K.qe("PowerPointWebEditor.IClassFactory"),Ah=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Bk=this.K.resolve("Box4.Graph.IGraphIteratorFactory"),Oe=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
sh=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Ck=this.K.resolve("PowerPointWebEditor.IPresentationReader"),Hm=La.kdb,nm=this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),yo=this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),eo=this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),Mp=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),bm=this.K.resolve("PowerPointWebEditor.IShapeReader"),zo=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");
this.hh.au(n);n=this.hh.Ut("regactorschronos2");Vc=[new Kj(Aa,Wb,uc,this.K.Oa("PowerPointWebEditor.IAddinCommandsManager")),new mn(Aa,Vc,Wb,xd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),xe,Ze,uc,this.K.Oa("PowerPointWebEditor.IAppForOfficeManager"),Bk,Oe,sh),new Vb(Aa,Wb,Oe,Ah,bd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),xe,this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.K.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),
this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("PowerPointWebEditor.InsertOnlineImageHelper"),this.K.resolve("PowerPointWebEditor.ChangeOnlineImageHelper"),Ck,wf,bm,zo,Mp,sh,this.K.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),this.K.resolve("Box4.Media.IImageFilePickerHelper"),this.K.resolve("Box4.Media.InsertOneDriveFileHelper"),
this.K.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),this.K.resolve("PowerPointWebEditor.IJSanityHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("Common.IAppSettingsManager")),new gk(Wb,this.K.resolve("PowerPointWebEditor.IUploadFrameFactory"),this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Oe,Ah,Mp,this.K.resolve("Common.Transaction.ITransactionFactory"),wf,xd,this.K.resolve("PowerPointWebEditor.IErrorHandler"),bd,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),Aa.Zwj)];for(const yh of Vc)yh.wb(),yh.Fe();uc.Izf=!0;this.hh.au(n);v.AFrameworkApplication.fa.gf(()=>{n=this.hh.Ut("regfullactorschronos2");const yh=[new Lj(Wb,Oe,bd,Ah,this.K.resolve("PowerPointWebEditor.IPPTWorkspace").Bf,nm,ha.aQa().uKj,yo,this.K.resolve("PowerPointWeb.IPrinter"),
this.K.resolve("PowerPointWeb.IConverter"),this.K.resolve("Box4.IAppFrame"),eo,Bb,this.K.resolve("PowerPointWebEditor.DownloadACopyAsPdfContext"),O.irmPolicyDescription,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),()=>v.AFrameworkApplication.DQ,ha.aZd(),jk=>v.AFrameworkApplication.Ba.jb.VJe(jk),
()=>v.AFrameworkApplication.Q4b,this.K.resolve("PowerPointWebEditor.IDeferredContentManager"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new Mj(La,Aa.BSi,Hm.embedPreviewUrl,Wb,Ck,ha.aZd(),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))];for(const jk of yh)jk.wb(),jk.Fe();this.hh.au(n)});K.a.J(512360593,809,50,"Chronos2Package::Init");for(const yh of this.zW)this.hh.Ut(yh.name),yh.init(),this.hh.au(yh.name);
n=this.hh.Ut("al");this.Tuj();this.hh.au(n);v.AFrameworkApplication.fa.gf(()=>{if(Aa.powerPointIdeasIsEnabled){n=this.hh.Ut("idea");var yh=this.yvj();this.xvj(yh);this.hh.au(n)}Aa.powerPointSmartLookupIsEnabled&&(n=this.hh.Ut("smartLookup"),this.mwj(),this.hh.au(n));v.AFrameworkApplication.sae()&&(n=this.hh.Ut("versionhistory"),this.Cwj(),this.hh.au(n));vk.dJj(Aa)&&Jc.a.get_instance().Ak(7,()=>{this.K.resolve("PowerPointWebEditor.StreamVideoPrefetchOrchestrator").start()});const jk=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
if(jk&&(jk.mnh||jk.lnh||jk.nnh)){const Ao=!ib.a.Xa(v.AFrameworkApplication.fa.Ia("TenantId"))&&Array.contains(jk.til,v.AFrameworkApplication.fa.Ia("TenantId"));this.K.register(jl,"PowerPointWebEditor.Text.FontLogger").ma().na(()=>new jl(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager"),this.K.resolve("Common.ITaskManager"),
jk.Cak,jk.Bak,jk.mnh,jk.lnh&&v.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),jk.nnh,jk.GIi&&Ao));yh=this.K.resolve("PowerPointWebEditor.Text.FontLogger");this.qKg.push(yh);yh.start()}});v.AFrameworkApplication.MAa||(n=this.hh.Ut("appforoffice"),this.Quj(),this.hh.au(n));Aa.fqh&&this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").Jbe()}dispose(){for(const n of this.zW)n.dispose();for(const n of this.qKg)try{n&&n.dispose()}catch(O){K.a.J(512360592,306,10,"Exception disposing a disposable. {0} {1}",
O.message,O.stack)}}Tuj(){K.a.J(512360591,809,50,"Start to download augloop.hermes.js file and its dependency files");try{const n=rb.a.create("pptedit.augloop",null,()=>d.e(10).then(d.bind(null,1194)));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled){const O=this.K.resolve("Common.ISharedDependencyLoader"),ha=v.AFrameworkApplication.Rj("augloop-runtime-shim-ie",2);O.Tvb(ha).continueWith(()=>{cc.a.nt(n)})}else cc.a.nt(n)}catch(n){K.a.J(512360590,306,
10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",n.message,n.stack)}}yvj(){K.a.J(512360588,809,50,"Start to download infrared.hermes.js file");var n=[this.K3.gWb(v.AFrameworkApplication.Rj("ir-plugin-ski.min.js",5))];n=rb.a.create("pptedit.infrared",n,()=>d.e(13).then(d.bind(null,1200)));cc.a.nt(n);return n}xvj(n){K.a.J(512360587,809,50,"Start to download ideas.hermes.js file");n=this.K3.aPd(v.AFrameworkApplication.Rj("microsoft.ideas.runtime.js",5),[n],!1);
n=rb.a.create("pptedit.ideas",[n],()=>d.e(15).then(d.bind(null,1203)));cc.a.nt(n)}mwj(){K.a.J(512360586,809,50,"Start to download smartlookup.hermes.js file");const n=rb.a.create("pptedit.smartlookup",null,()=>d.e(12).then(d.bind(null,1197)));cc.a.nt(n)}Cwj(){const n=this.K3.gWb(v.AFrameworkApplication.zea+"pptVersionHistory.js");try{cc.a.nt(n)}catch(O){K.a.J(512360585,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",O.toString())}}Quj(){const n=
this.K.resolve("PowerPointWebEditor.IApplicationSettings");u.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").d3d()?wg.j5d():n.zg?v.AFrameworkApplication.fa.gf(wg.Tkg):Jc.a.get_instance().Ak(8,()=>{wg.Tkg()})}static main(){v.AFrameworkApplication.Xg&&Ic.a.ag?K.a.J(512360584,809,15,"Firefox attempts to load chronos2 package when App is disposing"):e.a.instance.Ec(nc.a(new wg,5))}static j5d(){u.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").w3a();e.a.instance.Ec(new Wj)}static Tkg(){let n=
!1;try{window.self.requestIdleCallback(wg.j5d)}catch(O){n=!0}n&&window.setTimeout(wg.j5d,0)}}Object(h.a)(wg,"Chronos2Package",null,[2,3]);var Ef=d(242),mk;(function(n){n[n.unsupported=0]="unsupported";n[n.designer=1]="designer";n[n.blank=2]="blank"})(mk||(mk={}));Object(h.b)("AgendaSlideThemeType",mk);var Fe=d(110);class pi{constructor(){this.AgendaSlideSid=this.AgendaSlideCid=0;this.CorrelationId=null}}Object(h.a)(pi,"AgendaApplyInfo",null,[]);class Sn{constructor(){this.DeckSuggestionId=this.CorrelationId=
this.AgendaSessionId=null;this.FIsBlankOption=!1}}Object(h.a)(Sn,"AgendaThemeApplyInfo",null,[]);class zm{constructor(n,O){this.bUd=!1;this.bze=[];this.DTf=n;this.hNi=O}}Object(h.a)(zm,"DeckOptionInformation",null,[]);class gh{constructor(){this.CPg=this.DPg=0;this.xDg=[]}get ykd(){return this.DPg}set ykd(n){this.DPg=n}get xkd(){return this.CPg}set xkd(n){this.CPg=n}get k4a(){return this.xDg}set k4a(n){this.xDg=n}Q3g(n,O,ha){const Aa=new C.a;if(n)for(let La=0;La<ha-1&&La<n.length;La++)Aa.add(new zm(n[La],
!1));ib.a.Xa(O)||Aa.add(new zm(O,!0));this.k4a=Aa.toArray()}}Object(h.a)(gh,"AgendaDeckSessionInformation",null,[]);class Am{constructor(){this.$5b=this.a6b=this.wBg=0;this.Coe=this.hWc=this.xme=this.P0c=null}NYk(n){n&&(this.wBg=n.body.slideIndex)}k1k(n){n.body&&n.body.outlineRequestContent&&(this.P0c=JSON.stringify(n.body.outlineRequestContent))}JYk(n){n.body&&(this.$5b=n.body.slideCId)}MYk(n){n.body&&(this.a6b=n.body.slideSId)}KYk(n){this.hWc=n.id}Ezj(n){return n===this.hWc?(this.hWc=this.P0c=null,
!0):!1}uNj(){return!ib.a.Xa(this.P0c)&&!ib.a.Xa(this.hWc)}$0k(n){n.body&&n.body.outlineRequestContent&&n.body.outlineRequestContent.Slides&&(this.xme=n.body.outlineRequestContent.Slides.length)}LYk(n){this.Coe=n.body.score}}Object(h.a)(Am,"AgendaDetection",null,[]);class Ki{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd){this.Jsa=this.HA=null;this.nWc=0;this.EZ=null;this.Izb="";this.mYc=!1;this.rja=0;this.S7=new C.a;this.hHg=!1;this.Yh=n;this.Ub=O;this.ua=ha;this.Zb=Aa;this.Ha=La;this.kq=Bb;this.ia=Wb;
this.Je=uc;this.ob=Vc;this.Pv=bd;this.Qab=xd;this.Pv.Ugk(this.Ha)}Wvh(){this.nlh();this.Vti();this.Hqb()?(this.EZ=new gh,this.EZ.ykd=this.oK(),this.Hll()):1!==this.rja||this.Ha.tHc?2===this.rja&&this.Ha.sHc&&(this.EZ=new gh,this.EZ.ykd=this.oK(),this.mml()):this.lml()}Vti(){this.Jsa=Ad.a.create().toString();this.Pv.SPk(this.Jsa);this.Pv.tek()}gQe(n,O){if(this.HA){if(!this.HA.a6b||!this.HA.$5b){var ha=this.Ub.UH(this.HA.wBg);this.HA.a6b=ha.Cb.sid;this.HA.$5b=ha.Cb.cid}ha=this.Ub.UH(0);this.Yh.generateAgendaSuggestion(ha.Cb.cid,
ha.Cb.sid,this.Jsa,this.HA.P0c,this.qUi(),n,O)}else O(null)}lml(){this.gQe(Object(r.a)(this,this.Gjk,"onPODSTriggerAgendaConversionSuccessV1"),Object(r.a)(this,this.NYg,"onPODSTriggerAgendaConversionFailureV1"));this.Zb.blockContent(this.ua.presentation,"ApplyAgenda",!0)}mml(){for(let n of this.S7)n&&n.Mll();this.gQe(Object(r.a)(this,this.Hjk,"onPODSTriggerAgendaConversionSuccessV2"),Object(r.a)(this,this.Fjk,"onPODSTriggerAgendaConversionFailureV2"))}Hll(){this.gQe(Object(r.a)(this,this.Ijk,"onPODSTriggerAgendaConversionSuccessV3"),
Object(r.a)(this,this.OYg,"onPODSTriggerAgendaConversionFailureV3"));this.Zb.blockContent(this.ua.presentation,"ApplyAgenda",!0)}Mcb(n,O){if(O.property===dc.a.dWa&&this.nWc){n=Object(M.a)(408,O.node);if(n.dWa===Ki.HDh)for(let ha of this.S7)ha&&ha.Rek();else if(n.dWa===Ki.IDh){for(let ha of this.S7)ha&&ha.yVg();this.mYc=!0}this.Qab.Pm(Object(r.a)(this,this.Mcb,"onPresentationPropertyChange"));this.nWc=0}}qUi(){const n={};this.Ha.sHc&&2===this.rja&&(n.shouldGenerateThemes="true",n.themeCount="3");this.Hqb()&&
(n.shouldNotConvertToGVMLBytes="true",n.shouldInsertBlankSlides="true");return Fe.c(n)}gUi(n){const O={};O.SlideCount=this.wj().toString();O.isBlankThemeRequest=(this.EZ.k4a[n].hNi&&!this.Hqb()).toString();O.isRequestForDeckDesignerForNonBlankSlides=this.Hqb();return Fe.c(O)}Hqb(){return this.Ha.tHc&&(1===this.rja||0===this.rja)}Gll(){this.ob.Rh();const n=this.ua.presentation;if(n){const O=this.kq.ie(15);try{O.lc(n),O.fd=Ab.a.bTb,n.Tmb=Object.assign(new pi,{CorrelationId:this.Jsa,AgendaSlideSid:this.HA.a6b,
AgendaSlideCid:this.HA.$5b})}finally{O&&O.dispose()}this.Zb.xw(n,Ab.a.bTb);this.Zb.mJ(n)}else this.e6c()}Xvh(n){this.ob.Rh();this.Pv.q8h(this.eYd(n));const O=this.ua.presentation;if(O){const ha=this.kq.ie(15);try{ha.lc(O),ha.fd=Ab.a.bTb,O.dWa=Ki.GDh,this.nWc=this.oK(),this.Qab.yk(Object(r.a)(this,this.Mcb,"onPresentationPropertyChange")),O.Umb=Object.assign(new Sn,{DeckSuggestionId:this.eYd(n),AgendaSessionId:this.Jsa,CorrelationId:Ad.a.create().toString()})}finally{ha&&ha.dispose()}this.Zb.xw(O,
Ab.a.bTb);this.Zb.mJ(O)}else this.e6c()}e6c(){for(let n of this.S7)n&&n.Qek();this.Zb.mJ(this.ua.presentation)}Gjk(){this.Gll();this.mYc=!0;for(let n of this.S7)n&&n.yVg()}Hjk(n){this.EZ.xkd=this.oK();const O=this.S8f(),ha=new C.a;if(n.Images)for(const Aa of n.Images)ha.add("data:image/jpg;base64, "+Aa);ha.add(O);ib.a.Xa(n.BlankSuggestionId)&&(n.BlankSuggestionId=Ad.a.create().toString());this.EZ.Q3g(n.DeckSuggestionId,n.BlankSuggestionId,Ki.lUe);for(let Aa of this.S7)Aa&&Aa.Tek(ha.toArray());this.jQe(0)}Ijk(){this.EZ.xkd=
this.oK();this.EZ.Q3g(null,Ad.a.create().toString(),Ki.lUe);this.jQe(0)}jQe(n){this.Hqb()?this.bwh(n,Object(r.a)(this,this.Kjk,"onPODSTriggerAgendaDeckSuggestionSuccessForNonBlankTheme"),Object(r.a)(this,this.OYg,"onPODSTriggerAgendaConversionFailureV3")):this.bwh(n,Object(r.a)(this,this.Jjk,"onPODSTriggerAgendaDeckSuggestionSuccess"),Object(r.a)(this,this.PYg,"onPODSTriggerAgendaDeckSuggestionFailure"))}bwh(n,O,ha){if(this.EZ.xkd<this.EZ.ykd)this.Wvh();else if(this.Pv.Kmk(n),this.Izb=this.eYd(n),
this.GNi(this.EZ.k4a[n])){var Aa=Ad.a.create().toString();this.Yh.generateAgendaDeckSuggestion(this.HA.$5b,this.HA.a6b,Aa,this.Jsa,this.Izb,this.gUi(n),O,ha);K.a.J(572524035,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",Aa,this.Izb)}else this.gUg(this.EZ.k4a[n].bze,this.Izb),this.Pv.uVg(n,!0)}Jjk(n){if(n.Images&&n.Images.length){var O=new C.a;for(var ha of n.Images)O.add("data:image/jpg;base64, "+ha);this.gUg(O.toArray(),n.DeckSuggestionId);
if(ha=({themeIndex:n}=this.O7f(n.DeckSuggestionId)).returnValue)ha.bze=O.toArray(),ha.bUd=!0;this.Pv.uVg(n,!1)}else this.PYg(n)}Kjk(n){n.Images&&n.Images.length?this.Xvh(0):this.e6c()}gUg(n,O){for(let ha of this.S7)ha&&O===this.Izb&&ha.Mek(n)}PYg(n){try{let O;const ha=({themeIndex:O}=this.O7f(n.DeckSuggestionId)).returnValue;ha&&(ha.bUd=!1,ha.bze=[]);this.Pv.Lek(O);if(this.Izb!==n.DeckSuggestionId)return!0}catch(O){K.a.J(571483968,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+O.message)}for(let O of this.S7)O&&
O.xVg();return!0}NYg(){this.e6c();return!0}OYg(n){return this.NYg(n)}Fjk(){const n=this.S8f(),O=new C.a;O.add(n);for(let ha of this.S7)ha&&(ha.Sek(O.toArray()),ha.xVg());return!0}S8f(){const n=this.Ub.UH(0);return this.Je.h7(n.Cb).image.src}mQa(n,O){try{this.HA||(this.HA=new Am);let ha=!1;O?this.HA.Ezj(n.id)&&(this.Kjh(!1,this.rja),ha=!0):(this.HA.NYk(n),this.HA.k1k(n),this.HA.JYk(n),this.HA.MYk(n),this.HA.KYk(n),this.HA.LYk(n),this.nlh(),this.HA.uNj()&&(this.Kjh(!0,this.rja),this.HA.$0k(n)));if(!(0>=
this.S7.count))for(let Aa of this.S7)try{Aa&&(ha?window.setTimeout(()=>{Aa.fUg()},100):Aa.fUg())}catch(La){K.a.J(577865432,813,10,"Exception message: "+La.message)}}catch(ha){K.a.J(578331549,813,10,"Exception message: "+ha.message)}}JHk(n){n&&this.S7.add(n)}wpl(n){this.S7.remove(n)}Kjh(n,O){this.hHg=this.Ha.tHc?n:n&&0!==O}d$f(){return this.hHg&&!this.mYc}cwe(n){this.mYc=!n}wj(){return this.ua.presentation.uea+this.HA.xme}nlh(){this.rja=this.Adj();this.Pv.cQk(mk[this.rja]);this.NPk()}NPk(){this.Hqb()?
this.Pv.gEe("V3"):1!==this.rja||this.Ha.tHc?2===this.rja&&this.Ha.sHc&&this.Pv.gEe("V2"):this.Pv.gEe("V1")}Adj(){try{const n=this.Ub.QH();if(n&&0<n.length)for(const O of n)if(O){const ha=O.ThemeFamilyId;if(this.Ha.sHc&&ha.toLowerCase()===Ki.TDh.toLowerCase())return 2;if(0<=Array.indexOf(this.Ha.f6h,ha))return 1}return 0}catch(n){return K.a.J(577640031,813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+n.message),0}}eYd(n){return this.EZ.k4a[n].DTf}O7f(n){let O;O=0;for(const ha of this.EZ.k4a){if(ha.DTf===
n)return{returnValue:ha,themeIndex:O};O++}K.a.J(561541730,813,10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+n);return{returnValue:null,themeIndex:O}}GNi(n){return n?!n.bUd:(K.a.J(561541731,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),!1)}dispose(){this.Qab.Pm(Object(r.a)(this,this.Mcb,"onPresentationPropertyChange"));this.nWc=0}oK(){return(new Date).getTime()}}Ki.lUe=4;Ki.TDh="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F";
Ki.IDh=1;Ki.HDh=2;Ki.GDh=0;Object(h.a)(Ki,"AgendaConverterManager",null,[109]);class vj{constructor(n,O,ha){this.Pv=n;this.Xc=O;this.qN=ha;this.Ox()}Ox(){this.Xc.Izc(Object(r.a)(this,this.Kla,"onUndoRedo"))}dispose(){this.Xc.Dcd(Object(r.a)(this,this.Kla,"onUndoRedo"))}m1b(n,O){n===Ab.a.bTb&&(this.Pv.cwe(O),this.qN.cwe(O))}Kla(n,O){this.m1b(O.BRe,O.S8a)}}Object(h.a)(vj,"AgendaConverterUndoRedoController",null,[943]);var Hl=d(78);class Bn{constructor(){this.isEntryState=!1;this.pptAppFrameDomElement=
null;this.maxTryAgainCount=0}}Object(h.a)(Bn,"IAgendaSettings",null,[]);class xg{constructor(n,O,ha,Aa,La){this.eJf="HighConfidenceAgendaDetected";this.wy=null;this.va=new Hl.a;this.gWc=null;this.M3c=0;this.la=ha;this.Hs=O;this.Ga=La;this.wy||(O=new Bn,O.isEntryState=!0,O.pptAppFrameDomElement=this.Hs.iG(),O.maxTryAgainCount=this.la.rDf,this.wy=agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(O));this.Afl();this.qN=n;this.la&&this.la.rHc&&this.qN.JHk(this);this.Pv=Aa;this.s9a=
!1}fUg(){this.qN&&(this.qN.d$f()?(this.Pv.MPk(this.qN.HA.Coe),this.poh(this.gWc),1===this.qN.HA.Coe&&this.va.raiseEvent(this.eJf,null)):this.L3d())}Mll(){this.wy&&(this.Pv.Nek(),this.wy.showAgendaToPptDialog(this.qN.wj()),this.Ga.WPc(Rc.a.qDf,Rc.a.kj,document.getElementById("AgendaToPptDialogHostElement")),this.Ga.Kj(Rc.a.qDf,!0),this.s9a=!0)}yVg(){this.L3d();this.Pv.Pek();window.setTimeout(()=>{this.Ull()},8E3)}Tek(n){this.wph(n);this.Pv.vVg(!0)}Sek(n){this.wph(n);this.Pv.vVg(!1)}Mek(n){this.Y$k(n)}Qek(){this.M3c>=
this.la.rDf?this.wy.showAgendaToPptDismissCard():(this.M3c+=1,this.wy.showAgendaToPptFailureCard());this.Pv.vYg()}xVg(){this.wy&&this.s9a&&this.wy.showSlidePreviewError()}Rek(){this.wy.showMergeSlidesError();this.Pv.vYg()}poh(n){this.la.rHc&&(this.pHe(n),this.wy&&this.gWc&&this.qN&&this.qN.d$f()&&(this.wy.showAgendaCard(this.gWc,this.qN.HA.xme),this.Pv.Kek()))}L3d(){K.a.J(538469316,829,100,"AgendaConverterView::HideAgendaEntryCard");this.wy&&!this.s9a&&(this.wy.hideAgendaCard(),this.pHe(null))}wph(n){this.wy&&
this.s9a&&this.wy.populateThemesInAgendaDialog(n)}Y$k(n){this.wy&&this.s9a&&this.wy.populatePreviewSlidesInAgendaDialog(n)}pHe(n){this.gWc=n}Ull(){if(this.la.Guk)try{const n=u.a.instance.Oa("Common.ISystemInitiatedFeedback");n&&(K.a.J(562422277,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),n.execute(O=>{O.logActivity("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled")}))}catch(n){K.a.J(562422278,813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",
n)}}Afl(){this.wy.on(xg.JDh,()=>{this.a6h()});this.wy.on(xg.MDh,()=>{this.d6h()});this.wy.on(xg.KDh,()=>{this.b6h()});this.wy.on(xg.LDh,()=>{this.c6h()});this.wy.on(xg.QDh,n=>{this.$5h(n)});this.wy.on(xg.NDh,n=>{this.pDf(n,!1)});this.wy.on(xg.ODh,()=>{this.e6h()});this.wy.on(xg.PDh,n=>{this.pDf(n,!0)})}a6h(){this.trh()}d6h(){this.Pv.Mmk();this.trh()}b6h(){this.oDf();this.Pv.dWg()}c6h(){this.oDf();this.Pv.Pgk()}oDf(){this.cleanup();this.qN.wpl(this)}trh(){this.qN.Wvh()}$5h(n){this.qN.jQe(n)}pDf(n,
O){this.Pv.Oek(n,O);this.s9a=!1;this.wy.hideAgendaToPptDialog();this.qN.Xvh(n)}e6h(){this.s9a=!1;this.wy.hideAgendaToPptDialog();this.Pv.dWg()}cleanup(){this.pHe(null);this.M3c=0;this.wy.cleanup()}F2h(n){this.va.addHandler(this.eJf,n)}}xg.JDh="AgendaCardAddSlides";xg.MDh="AgendaCardTryAgain";xg.KDh="AgendaCardCancel";xg.LDh="AgendaCardDismiss";xg.QDh="AgendaToPptDialogThemeSuggestionSelected";xg.NDh="AgendaToPptDialogApply";xg.ODh="AgendaToPptDialogCancel";xg.PDh="AgendaToPptDialogMergeTryAgain";
Object(h.a)(xg,"AgendaConverterView",null,[944,968]);var Vm=d(663);class Yi{constructor(){this.a$b={}}Thd(n){this.a$b[n]=new Vm.a(n,!0)}hHb(n){if(n in this.a$b){var O=this.a$b[n];O.stop();O=O.$Gc;delete this.a$b[n];return O}return-1}qwe(n){return n in this.a$b}}Object(h.a)(Yi,"AgendaPerfLogger",null,[]);class wl{constructor(){this.aSc=this.$pg=this.bqg=this.aqg=!1}sVj(){this.aSc&&!this.aqg&&(this.aqg=!0,Jb.b(wl.sei))}VVj(){this.aSc&&!this.bqg&&(this.bqg=!0,Jb.b(wl.tei))}tUj(){this.aSc&&!this.$pg&&
(this.$pg=!0,Jb.b(wl.rei))}static vTj(n){n&&n.rS&&Jb.b(wl.qei)}}wl.sei="WAC_Exp_AgendaToPPTHighConfidenceSeen";wl.tei="WAC_Exp_AgendaToPPTHighConfidenceTried";wl.rei="WAC_Exp_AgendaToPPTHighConfidenceKept";wl.qei="WAC_Exp_AgendaToPPTIsCreateNew";Object(h.a)(wl,"ExperimentationMetrics",null,[]);class yi{constructor(){this.tfe=this.Ree=this.Yce=this.Jsa=null;this.Ege=!1;this.rEg=this.vBg=this.ZOg=this.Ha=null;this.Rpe="";this.Hge=!1;this.Xce=""}reset(){this.ZOg={};this.vBg=new Yi;this.rEg=new wl;this.Rpe=
"";this.Hge=!1;this.Xce="";this.tfe=this.Ree=this.Yce=this.Jsa=null;this.Ege=!1}get telemetryData(){return this.ZOg}get jIc(){return this.rEg}get m6(){return this.vBg}get kd(){return this.Ha}set kd(n){this.Ha=n}get pjd(){return this.Rpe}set pjd(n){this.Rpe=n}get ZOa(){return this.Hge}set ZOa(n){this.Hge=n}get bP(){return this.Xce}set bP(n){this.Xce=n}get OU(){return this.Jsa}set OU(n){this.Jsa=n}get $F(){return this.Yce}set $F(n){this.Yce=n}get TR(){return this.Ree}set TR(n){this.Ree=n}get documentOpenType(){return this.tfe}set documentOpenType(n){this.tfe=
n}get O2b(){return this.Ege}set O2b(n){this.Ege=n}}Object(h.a)(yi,"AgendaMetricsState",null,[]);var Vl=d(749);class wj{constructor(n,O){if(!n)throw Error.argumentNull("AgendaThemetype is null");if(!O)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.bta=new Vl.a;this.bta.vga(Object.assign(new E.a,{name:"AgendaThemeType",string:n}));this.bta.vga(Object.assign(new E.a,{name:"AgendaFlowVersion",string:O}))}B4(n){ib.a.Xa(n)||this.bta.vga(Object.assign(new E.a,{name:"AgendaSessionId",string:n}));
return this}dfd(n){this.bta.vga(Object.assign(new E.a,{name:"AgendaThemeIndexSelected",int64:n}));return this}Yeb(n){ib.a.Xa(n)||this.bta.vga(Object.assign(new E.a,{name:"AgendaCardState",string:n}));return this}UHa(n){ib.a.Xa(n)||this.bta.vga(Object.assign(new E.a,{name:"AgendaDialogState",string:n}));return this}uXa(n){ib.a.Xa(n)||this.bta.vga(Object.assign(new E.a,{name:"AgendaButtonClickedType",string:n}));return this}Yfd(n){ib.a.Xa(n)||this.bta.vga(Object.assign(new E.a,{name:"AgendaSeenTriedKept",
string:n}));return this}a0(n){ib.a.Xa(n)||this.bta.vga(Object.assign(new E.a,{name:"DocumentOpenType",string:n}));return this}build(){return this.bta.dataFields}}Object(h.a)(wj,"AgendaToPptActivityDataPointBuilder",null,[]);class Qi{constructor(){this.Tc=null;this.LUa=new Vm.a("AgendaToPpt",!1);this.oJe()}oJe(){this.Tc=new yi;this.Tc.reset();this.Tc.telemetryData.Flights="";v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",
!1)&&(this.Tc.telemetryData.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");this.Tc.telemetryData.InitialUserThemeType=this.Tc.bP}Ugk(n){n&&(this.Tc.kd=n,this.Tc.documentOpenType=Qi.Y_i(n),wl.vTj(this.Tc.kd),this.Tc.telemetryData.IsDocumentOpenTypeCreateNew=this.Tc.kd.rS.toString())}wVg(n,O){if(this.Tc.m6.qwe("AgendaToPptDialogThemeApply")&&"V2"===this.Tc.$F){var ha=this.Tc.m6.hHb("AgendaToPptDialogThemeApply");this.Tc.telemetryData.TotalTimeTakenToMerge=ha.toString();Jb.a(Qi.XU,n,ha,O)}else this.Tc.m6.qwe("OnAddSlidesClicked")?
(ha=this.Tc.m6.hHb("OnAddSlidesClicked"),this.Tc.telemetryData.TotalTimeTakenToMerge=ha.toString(),Jb.a(Qi.XU,n,ha,O)):this.Tc.m6.qwe("OnTryAgainClicked")&&(ha=this.Tc.m6.hHb("OnTryAgainClicked"),this.Tc.telemetryData.TotalTimeTakenToMerge=ha.toString(),Jb.a(Qi.XU,n,ha,O));this.Tc.O2b=!1}Kek(){this.Tc.O2b=!1;if(!("Seen"in this.Tc.telemetryData)){this.$L("OnAgendaCardShown");this.LUa.start();this.Tc.telemetryData.Seen="true";K.a.J(576746627,813,50,"AgendaCard shown");const n=(new wj(this.Tc.bP,this.Tc.$F)).Yeb("AgendaCardShown").Yfd("Seen").a0(this.Tc.documentOpenType).build();
Jb.a(Qi.XU,!0,0,n);this.Tc.jIc.sVj()}}tek(){this.Tc.O2b?this.XVj():this.NSj()}NSj(){this.$L("OnAddSlidesClicked");this.LUa.stop();this.Tc.telemetryData.Tried="true";this.Tc.m6.Thd("OnAddSlidesClicked");K.a.J(576746628,813,50,"AgendaCard tried in MS:{0}",this.LUa.$Gc);const n=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).Yeb("AgendaCardShown").uXa("AddSlides").Yfd("Tried").a0(this.Tc.documentOpenType).build();Jb.a(Qi.XU,!0,this.LUa.$Gc,n);this.Tc.jIc.VVj()}Pek(){this.$L("OnAgendaToPPTApply");this.Tc.ZOa=
!0;this.Tc.telemetryData.Kept="true";this.Tc.telemetryData.Event="AgendaCompleted";const n=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).Yeb("AgendaCompleted").a0(this.Tc.documentOpenType).build();this.wVg(!0,n);K.a.J(572842050,813,50,"AgendaToPPT Completed successfully")}Mmk(){this.Tc.O2b=!0;this.$L("OnTryAgainClicked");this.Tc.telemetryData.Tried="true";this.Tc.telemetryData.Event="AgendaTryAgain";this.Tc.m6.Thd("OnTryAgainClicked");K.a.J(556561858,813,50,"AgendaCard retry attempt")}XVj(){const n=
(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).Yeb("AgendaMergeError").uXa("TryAgain").Yfd("Tried").a0(this.Tc.documentOpenType).build();Jb.a(Qi.XU,!0,0,n)}Nek(){this.$L("OnAgendaDialogShown");this.Tc.TR="Loading";K.a.J(556602440,813,50,"AgendaDialog shown");const n=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).UHa(this.Tc.TR).a0(this.Tc.documentOpenType).build();Jb.a(Qi.XU,!0,0,n)}vVg(n){this.$L("OnAgendaThemePaneLoadedSuccess");this.Tc.TR=n?"ThemeSuggestions":"ThemeSuggestionsFailure";n=this.Tc.m6.hHb("OnAddSlidesClicked");
this.Tc.telemetryData.ThemePaneLoadingTime=n.toString();const O=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).UHa(this.Tc.TR).a0(this.Tc.documentOpenType).build();Jb.a(Qi.XU,!0,n,O)}q8h(n){this.$L("ThemeDeckSuggestionId");this.Tc.telemetryData.SelectedDeckSuggestionId=n}Kmk(n){"V2"===this.Tc.$F&&(this.$L("OnTriggerDifferentThemeWorkflow"),this.Tc.TR="ThemeSuggestions",this.Tc.m6.Thd("TriggerDeckLevelDesigner_"+n),n=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).UHa(this.Tc.TR).dfd(n).uXa("ThemeSelected").a0(this.Tc.documentOpenType).build(),
Jb.a(Qi.XU,!0,0,n))}uVg(n,O){this.$L("OnAgendaDeckPreviewLoaded");this.Tc.TR=O?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";O=this.Tc.m6.hHb("TriggerDeckLevelDesigner_"+n);this.Tc.telemetryData["DeckPreviewLoadTime_"+n]=O.toString();n=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).UHa(this.Tc.TR).dfd(n).a0(this.Tc.documentOpenType).build();Jb.a(Qi.XU,!0,O,n)}Lek(n){const O=this.Tc.m6.hHb("TriggerDeckLevelDesigner_"+n);this.$L("OnAgendaDeckPreviewError");this.Tc.TR="AgendaDeckPreviewError";
let ha="";"DeckPreviewFailure"in this.Tc.telemetryData&&(ha=this.Tc.telemetryData.DeckPreviewFailure.toString());this.Tc.telemetryData.DeckPreviewFailure=ha+n.toString()+";";n=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).UHa(this.Tc.TR).dfd(n).a0(this.Tc.documentOpenType).build();Jb.a(Qi.XU,!1,O,n)}Oek(n,O){this.$L("OnAgendaDialogThemeApply");this.Tc.TR=O?"AgendaDeckMergeError":this.Tc.TR;this.Tc.m6.Thd("AgendaToPptDialogThemeApply");n=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).dfd(n).UHa(this.Tc.TR).uXa(O?
"TryAgain":"Apply").a0(this.Tc.documentOpenType).build();Jb.a(Qi.XU,!0,0,n)}dWg(){this.$L("OnCancelClicked");this.Tc.ZOa=!0;this.Tc.telemetryData.Kept="false";this.Tc.telemetryData.Event="AgendaCancelled";K.a.J(572842051,813,50,"AgendaToPPT clicked Cancel button");const n=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).uXa("Cancel").a0(this.Tc.documentOpenType);"V2"===this.Tc.$F?n.UHa(this.Tc.TR):n.Yeb("AgendaMergeError");Jb.a(Qi.XU,!0,0,n.build())}Pgk(){this.$L("OnDismissClicked");this.Tc.ZOa=!0;
this.Tc.telemetryData.Kept="false";this.Tc.telemetryData.Event="AgendaDismissed";K.a.J(556607430,813,50,"AgendaToPPT clicked Dismiss button");const n=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).uXa("Dismiss").a0(this.Tc.documentOpenType);"V2"===this.Tc.$F?n.UHa(this.Tc.TR):n.Yeb("AgendaMergeError");Jb.a(Qi.XU,!0,0,n.build())}vYg(){this.$L("OnMergingErrorInAgenda");this.Tc.ZOa=!0;this.Tc.telemetryData.Kept="false";this.Tc.telemetryData.Event="AgendaError";const n=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).a0(this.Tc.documentOpenType);
"V2"===this.Tc.$F?(this.Tc.TR="AgendaMergeError",n.UHa("AgendaMergeError")):n.Yeb("AgendaMergeError");this.wVg(!1,n.build())}cwe(n){let O=!1;this.$L("OnUndoRedoClicked");let ha=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).a0(this.Tc.documentOpenType);if("Kept"in this.Tc.telemetryData){this.Tc.telemetryData.Kept=(!n).toString();const Aa=n?"UndoClicked":"RedoClicked";this.Tc.telemetryData.Event=Aa;ha=ha.uXa(Aa)}else O=!0,ha.uXa("UndoRedoPostAgendaKept");Jb.a(Qi.XU,!0,0,ha.build());K.a.J(576746629,
813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!n).toString(),O.toString())}SPk(n){this.$L("ReportCorrelationID");this.Tc.telemetryData.CorrelationId=n;this.Tc.OU=n}cQk(n){this.$L("ReportInitialUserThemeType");this.Tc.telemetryData.InitialUserThemeType=n;this.Tc.bP=n}gEe(n){this.$L("ReportAgendaToPptFlowVersion");this.Tc.telemetryData.AgendaToPptFlowVersion=n;this.Tc.$F=n}MPk(n){this.$L("ReportAgendaScore");this.Tc.telemetryData.AgendaScore=n.toString();1===n&&this.aQk()}aQk(){this.$L("ReportHighConfidenceAgendaDetected");
this.Tc.telemetryData.HighConfidenceAgendaDetected="true";this.Tc.jIc.aSc=!0}dispose(){K.a.J(576746630,813,50,"AgendaToPPTMetrics: {0}",Fe.c(this.Tc.telemetryData))}jQk(){if(!this.Tc.telemetryData||!af.a.count(this.Tc.telemetryData))return"";const n=Fe.c(this.Tc.telemetryData);if(this.Tc.pjd===n)return"";this.Tc.pjd=n;if("Kept"in this.Tc.telemetryData){const O=(new wj(this.Tc.bP,this.Tc.$F)).B4(this.Tc.OU).Yfd("Kept").a0(this.Tc.documentOpenType).build(),ha=Boolean.parse(this.Tc.telemetryData.Kept.toString());
Jb.a(Qi.XU,ha,0,O);ha&&this.Tc.jIc.tUj()}this.Tc.ZOa&&(this.oJe(),this.Tc.ZOa=!1);K.a.J(572663111,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",this.Tc.pjd,this.Tc.ZOa.toString());return n}$L(n){this.Tc.telemetryData||(K.a.J(574665996,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",n),this.oJe())}static Y_i(n){return n.rS?"NewDocument":n.cSa?"ViewOnlyDocument":"EditDocument"}}Qi.XU="AgendaToPptEvents";Object(h.a)(Qi,"AgendaMetrics",null,[942]);class Il{constructor(){this.Ha=
this.K=null;this.mMg=!0;this.uBg="AugLoop_AgendaDetection_AgendaDetectionAnnotation";this.qN=null}get name(){return"PowerPointWebEditor.AgendaConverter"}Yb(n){this.K=n;this.K.register(942,"PowerPointWebEditor.IAgendaMetrics").ma().na(()=>new Qi);this.K.register(Ki,"PowerPointWebEditor.AgendaConverter.AgendaConverterManager").ma().na(()=>new Ki(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(7)));this.K.register(943,
"PowerPointWebEditor.IAgendaConverterUndoRedoController").ma().na(()=>new vj(this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager")));this.K.resolve("PowerPointWebEditor.IAgendaConverterUndoRedoController");const O=Ef.a(this.K);xh.a("AgendaToPPT.DisableLocalizedStrings")?O("agendaConverter").then(()=>{this.K.register(944,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().na(()=>
new xg(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{}):O("powerpoint-agenda-to-ppt-strings").then(()=>{O("agendaConverter").then(()=>{this.K.register(944,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().na(()=>
new xg(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{})}).catch(()=>{})}init(){this.K.resolve("Common.IAppSettingsManager").gf(Object(r.a)(this,this.IHk,"registerAgendaDetectionEventHandler"))}dispose(){}IHk(){this.Ha=
this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.qN=this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager");const n=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Ha.xIi&&this.mMg&&2===n.mode&&(this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(O=>{O.mmb(this.uBg);O.KHk(this.uBg,Object(r.a)(this.qN,this.qN.mQa,"handleAnnotationEvent"))}),this.mMg=!1)}static main(){e.a.instance.Ec(new Il)}}Object(h.a)(Il,"AgendaConverterPackage",
null,[2,3]);var on=d(665);class Wm{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd){this.V5b=0;this.ia=n;this.Rb=O;this.la=ha;this.Ga=Aa;this.Qd=La;this.sa=Bb;this.Zl=Wb;this.CD=uc;this.lu=Vc;this.Kp=bd;this.tua=xd}wb(){this.KXh();this.la.lxk&&this.K0f()&&this.tua.continueWith(()=>{this.tua.result.logActivity("HasPresentInTeamsSeen","PresentToTeamsTeachingUIEnabled")})}KXh(){this.ia.ra(Ab.a.nDb,yb.a.application,Object(r.a)(this,this.nDb,"presentToTeams"),4);this.ia.ra(Ab.a.g5g,yb.a.application,Object(r.a)(this,
this.nDb,"presentToTeams"),4);this.ia.ra(Ab.a.$ye,yb.a.application,Object(r.a)(this,this.nDb,"presentToTeams"),4)}vgh(){this.lu.hide();this.oVd()}oVd(){let n;za.a.Bkd();n=this.cok();this.showDialog();return n}cok(){this.Kp.a4b=!0;const n=Ad.a.create().toString(),O=this.Qd.documentUrl;try{const Aa={};Aa.pptSharingUrl=on.b(O);const La=encodeURIComponent(ef.c(Aa));let Bb=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}","1",n,La);if(!ib.a.Xa(null)){const Wb=Yc.a.NE(null);Bb=Bb+
"&fqdn="+Wb;const uc=encodeURIComponent(ef.c({joinUrl:null}));Bb=Bb+"&meetingContext="+uc}var ha=Bb;m.ULS.sendTraceTag(556541766,838,50,"actionId: {0}, deepLinkId: {1}",this.V5b,n);window.open(ha,"_top")}catch(Aa){return m.ULS.sendTraceTag(523084876,838,15,"PresentToTeamsActor: failed with error: {0}",Aa),!1}return!0}showDialog(){const n=new Ca.StandardDialog;n.vd=4;n.Pe(1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);n.Pe(2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);n.Tw(ResourceStrings.l_PresentingFileInTeamsTitle,
ResourceStrings.l_PresentingFileInTeamsMessage,0,Object(r.a)(this,this.Ffc,"protocolLaunchingDialogResultHandler"))}Ffc(n){1===n||0===n?(m.ULS.sendTraceTag(523084877,838,50,"PresentToTeamsActor - restarting PPT session"),this.YWa()):2===n&&(m.ULS.sendTraceTag(523084878,838,50,"PresentToTeamsActor - retry present to teams"),this.ia.processAction(Ab.a.$ye,2))}YWa(){this.ia.Ma(Ab.a.refresh,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"})}K0f(){return!!this.Qd.documentUrl}nDb(n,O,ha){if(!this.K0f())return m.ULS.sendTraceTag(523084879,
838,10,"PresentToTeamsActor: Document not supported"),8;if(1===ha)return 32;this.V5b=n;if(this.Zl.isPaused)return this.Ga.Bd(),this.oVd()?32:8;this.sa.Rh();this.Ga.Bd();if(n===Ab.a.$ye||1===this.Rb.mode)return this.oVd()?32:8;this.CD.d2(!0,!0,()=>{this.vgh()},()=>{m.ULS.sendTraceTag(523084880,838,15,"PresentToTeamsActor: ForceSave failed");this.vgh();return!0});this.lu.show(!1,this.V5b);return 32}w9(){}u9(){}}Object(h.a)(Wm,"PresentToTeamsActor",null,[146]);class Ik{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PresentToTeams"}Yb(n){this.K=
n}init(){v.AFrameworkApplication.fa.gf(()=>{(new Wm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),
this.K.resolve("PowerPointWebEditor.IApplicationContext"),Eh.a.su(u.a.instance.Oa("Common.ISystemInitiatedFeedback")))).wb()})}dispose(){}static main(){e.a.instance.Ec(new Ik)}}Object(h.a)(Ik,"PPTWebEditorPresentToTeamsPackage",null,[2,3]);var Cn=d(714),Qj=d(22);class Yj{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.CorrelationId=null;this.SuggestionSid=this.SuggestionCid=0}}Object(h.a)(Yj,"DesignerSuggestionApplyInfo",null,[]);var Yk=d(325),Fq=d(517),Jk=d(113);class Tn{constructor(){this.AAc=
null}}Object(h.a)(Tn,"IdeasSlideSuggestionWrapper",null,[]);var bp=d(108);class qi{constructor(){this.trigger=null;this.cid=this.sid=0;this.MP=null;this.timestamp=new Date;this.correlationId=Ad.a.create().toString()}}Object(h.a)(qi,"DesignerRequestData",null,[]);var ge=d(194);class ri{}Object(h.a)(ri,"SlideSuggestionData",null,[]);class ic{}ic.Gak="mivTitle";ic.Fak="mivSubtitle";ic.Z4c="mivContainer";ic.Eak="mivButtonsContainer";ic.jSg="mivButton";ic.Dak="mivButtonImage";ic.PAb="mivOverlayContainer";
ic.Gre="mivIcon";ic.QAb="mivTerm";ic.lSg="mivFrame";ic.Hak="mivView";ic.mSg="mivIdx";ic.Ire="mivKeepFocusStart";ic.Hre="mivKeepFocusEnd";ic.cYf="Editor";ic.xSd="EditorContainer";ic.jIi="EditorTitle";ic.fIi="EditorSubtitleContainer";ic.eYf="EditorSubtitle";ic.VHi="EditorBucketContainer";ic.G4a="EditorPrev";ic.OXb="EditorPrevDisabled";ic.hqb="EditorPrevEnabled";ic.wSd="EditorBucketCurrent";ic.WHi="EditorBucketTotalCount";ic.UXf="EditorBucketTotal";ic.fqb="EditorNext";ic.gqb="EditorNextEnabled";ic.NXb=
"EditorNextDisabled";ic.YHi="EditorDescription";ic.aIi="EditorIgnoreContainer";ic.MXb="EditorIgnore";ic.dIi="EditorSeeMoreContainer";ic.QXb="EditorSeeMoreLabel";ic.VXf="EditorCardContent";ic.hYf="EditorSuggestionsContainer";ic.DOa="EditorSuggestionContainer";ic.hHc="EditorSuggestionArrow";ic.gIi="EditorSuggestionCheck";ic.gYf="EditorSuggestionText";ic.fYf="EditorSuggestionInstances";ic.bIi="EditorNoMoreContainer";ic.hIi="EditorSvgCheck";ic.kIi="EditorWhiteCheck";ic.$Hi="EditorGreenFill";ic.ZHi="EditorGreenBorder";
ic.cIi="EditorNoMoreLabel";Object(h.a)(ic,"IdeasCss",null,[]);class ng{}ng.Z1b="IdeasPane";ng.COa="editorSuggestionIdx";ng.aK="ClosePane";ng.zrj="IdeasPaneOpen";ng.rbc=6;ng.a$j=3;ng.PTf="Architecture Backgrounds Cities Nature People Technology".split(" ");Object(h.a)(ng,"IdeasPaneConstants",null,[]);class vd{}vd.tmc="ToolbarButton";vd.kIb="ToolbarButtonHome";vd.insertPicture="InsertPicture";vd.fMe="SlideNavigationDesignMode";vd.xeb="Retrigger";vd.refresh="Refresh";vd.typing="Typing";vd.OUf="DesignElementsDeleted";
vd.uLd="ChangeSlideSize";vd.knb="ApplyTheme";vd.aMe="SlideChangeLayout";vd.oGa="NewSlide";vd.kLd="ChangeIconInSmartArt";vd.wob="ChangeIcon";vd.insertTable="InsertTable";vd.tva="PasteTable";vd.fQc="InsertChart";vd.KHd="ApplyReplaceObject";vd.moreIdeas="MoreIdeas";vd.newDocument="NewDocument";vd.PQd="DesignTab";vd.makeItVisual="MakeItVisual";vd.RGa="PasteText";vd.ONd="ConvertedToPPT";vd.XGd="AgendaToPPT";Object(h.a)(vd,"DesignerTrigger",null,[]);var Xm=d(173);class qe{constructor(n,O,ha,Aa,La,Bb,Wb){this.l8b=
null;this.ua=n;this.qc=O;this.la=ha;this.Ob=Aa;this.T1c=(n=this.la.useWideSuggestionThumbs)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";this.U1c=n?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.Bb=La;this.Qd=Bb;this.iwb=Wb}Wqk(n){const O=[];try{if(!n||!n.SlideSuggestions)return K.a.J(39338643,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse"),O;for(let ha=0;ha<n.SlideSuggestions.length;ha++){if(!n.SlideSuggestions[ha])continue;
const Aa=n.SlideSuggestions[ha].Base64Img;let La=null;try{La=Object.assign(new ri,{suggestionIndex:n.SlideSuggestions[ha].Index.toString(),suggestionCid:n.SlideSuggestions[ha].SlideId.Cid.toString(),suggestionSid:n.SlideSuggestions[ha].SlideId.Sid.toString(),imageData:Aa.startsWith("data:image")?Aa:"data:image/png;base64,"+Aa,label:String.format(ResourceStrings.l_DesignerSuggestionItem,ha+1)})}catch(Bb){K.a.J(594071828,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),
La=null}La||(La=Object.assign(new ri,{suggestionIndex:n.SlideSuggestions[ha].Index.toString(),suggestionSid:n.SlideSuggestions[ha].SlideSid.toString(),imageData:Aa.startsWith("data:image")?Aa:"data:image/png;base64,"+Aa,label:String.format(ResourceStrings.l_DesignerSuggestionItem,ha+1)}));Array.add(O,La)}}catch(ha){K.a.J(39338645,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",ha)}return O}B_i(n,O,ha){if(!n)throw Error.argumentNull("suggestionsContainer");
return n.querySelector("#"+O+" ."+qe.kNa+'[correlationId="'+ha+'"]')}C1d(){return this.la.FDi?this.la.EDi:this.la.DDi}LPc(n){if(!this.la.designerIncrementalRenderEnabled)return!1;let O=!0;switch(n){case vd.moreIdeas:O=!1;break;case vd.newDocument:O=!1}return O}RDe(n){K.a.J(592536837,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",this.Ob.correlationId,n.l5a);if(n.Lpb&&n.iIc&&n.Bea){var O=this.Z6d(),ha=n.Bea.parentNode.parentNode.id;if(n.NLe&&this.la.nOa&&n.l5a)switch(n.Lpb.DocumentUpsellStatus){case 0:this.e0h(n.Bea);
break;case 1:this.yZh(n.Bea);break;case 2:this.gZh(n.Bea)}n.l5a&&this.la.rHc&&this.wch(n.Bea);var Aa;if(Aa=n.l5a?this.fvi(n.iIc,n.Oh,n.Bea,O,n.fmd):this.B_i(n.Bea,ha,n.Oh))try{const Bb=this.Ob.pNa,Wb=!Db.a.Xa(Bb)&&ha===ng.Z1b,uc=this.Fdi(n.Lpb,Wb,Bb);if(n.l5a){this.Ob.qPe=new Date;n.fmd&&this.Zdl(n.bMi);for(var La=0;La<Aa.childNodes.length;La++){let Vc=Aa.childNodes[La];n.fmd&&this.c8k(uc,La)?qe.r$k(O,La,Vc):this.NDe(Wb?Bb[La].Type:0,n.Bea,Vc,ha,n.iIc,uc[La.toString()],La,n.NLe,n.Lpb.DocumentUpsellStatus)}this.la.sha&&
n.Lpb.HasPaginationInfo&&this.gph(n.Bea,n.Oh)}else if(n.fmd){K.a.J(592306778,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",this.Ob.correlationId,af.a.count(uc));for(La of Object.keys(uc)){const Vc=parseInt(La);let bd=n.Bea.querySelector("#"+ha+" ["+qe.Vza+'="'+Vc+'"]');uc[La]&&bd&&Sys.UI.DomElement.containsCssClass(bd.firstChild,"IncSuggestionPlaceholder")&&this.NDe(Wb?Bb[Vc].Type:0,n.Bea,bd,ha,n.iIc,uc[La],Vc,n.NLe,n.Lpb.DocumentUpsellStatus)}}}catch(Bb){K.a.J(41695001,
829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",this.Ob.correlationId,Bb)}}}YOk(n,O,ha,Aa){try{if(!(n&&n.SlideSuggestions&&n.SlideSuggestions.length&&O))return!1;this.cPc(O);const La=O.querySelector("."+qe.kNa);if(!La)return!1;const Bb=La.childNodes.length,Wb=La.childNodes.length+n.SlideSuggestions.length,uc=this.Z6d(),Vc=O.parentNode.parentNode.id;for(let bd=0;bd<n.SlideSuggestions.length;++bd){const xd=this.YQf(Bb+bd,Wb,uc);this.NDe(0,O,xd,Vc,Wb,n.SlideSuggestions[bd],
Bb+bd,Aa,n.DocumentUpsellStatus);La.appendChild(xd)}n.HasPaginationInfo&&this.gph(O,ha);return!0}catch(La){return K.a.J(593794385,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",La),!1}}Fdi(n,O,ha){const Aa={};if(O)for(const La of ha)switch(La.Type){case 0:O=La;ha=null;for(const Bb of n.SlideSuggestions)if(Bb.Index===O.IndexInDesigner){ha=Bb;break}Aa[La.Index.toString()]=ha;break;default:Aa[La.Index.toString()]=La}else for(const La of n.SlideSuggestions)Aa[La.Index.toString()]=La;
return Aa}c8k(n,O){O=O.toString();return!(O in n)||!n[O]}e0h(n){const O=vb.a.De();O.className="DesignerFreeTrialCardContainer";const ha=vb.a.De();ha.className="DesignerFreeTrialCardTitle";ha.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;const Aa=vb.a.De();Aa.className="DesignerFreeTrialCardContent";Aa.innerText=String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,this.C1d());const La=vb.a.De();La.className="DesignerStartFreeTrialButtonsContainer";const Bb=vb.a.De();
Bb.className=qe.Ynb;Bb.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;Bb.tabIndex=0;Bb.setAttribute(ka.a.ht,Bb.innerText);Bb.setAttribute(ka.a.ff,ka.a.St);const Wb=vb.a.De();Wb.className=qe.CBc;const uc=document.createElement("i");uc.className=qe.IBc;uc.style.lineHeight="20px";uc.setAttribute("Unselectable","on");const Vc=vb.a.De();Vc.className="DesignerStartTrialGoPremiumButtonText";Vc.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Vc.setAttribute("Unselectable","on");
Wb.setAttribute(ka.a.ht,Vc.innerText);Wb.setAttribute(ka.a.ff,ka.a.St);Wb.tabIndex=0;Wb.appendChild(uc);Wb.appendChild(Vc);La.appendChild(Bb);La.appendChild(Wb);O.appendChild(ha);O.appendChild(Aa);O.appendChild(La);O.setAttribute(ka.a.ht,String.format("{0}. {1}",ha.innerText,Aa.innerText));O.setAttribute(ka.a.ff,ka.a.Nza);n.appendChild(O)}oRf(){const n=vb.a.De();n.className="DesignerInFreeTrialView";const O=document.createElement("i");O.className=v.AFrameworkApplication.isRtl?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":
"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";const ha=vb.a.De();ha.className=qe.ZTb;ha.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;ha.tabIndex=0;const Aa=vb.a.De();Aa.className=v.AFrameworkApplication.isRtl?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";Aa.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;ha.setAttribute(ka.a.ff,ka.a.vId);ha.setAttribute(ka.a.nnb,ka.a.Bpa);ha.setAttribute(ka.a.ht,ha.innerText);n.appendChild(O);n.appendChild(ha);n.appendChild(Aa);
n.setAttribute(ka.a.ht,ha.innerText+" "+Aa.innerText);n.setAttribute(ka.a.ff,ka.a.Nza);return n}sll(){const n=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(n)for(let O=0;O<n.length;O++){const ha=n[O];if(ha.parentNode){const Aa=this.oRf();ha.parentNode.replaceChild(Aa,ha)}}this.Wyh()}yZh(n){const O=this.oRf();n.appendChild(O)}gZh(n){const O=vb.a.De();O.className="DesignerFreeTrialCardContainer";const ha=vb.a.De();ha.className="DesignerFreeTrialCardTitle";ha.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle;
const Aa=vb.a.De();Aa.className="DesignerFreeTrialCardContent";Aa.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent;const La=vb.a.De();La.className=qe.YTb;const Bb=document.createElement("i");Bb.className=qe.IBc;Bb.style.lineHeight="20px";const Wb=vb.a.De();Wb.className="DesignerTrialExhaustedGoPremiumButtonText";Wb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;La.setAttribute(ka.a.ht,Wb.innerText);La.setAttribute(ka.a.ff,ka.a.St);La.tabIndex=0;La.appendChild(Bb);La.appendChild(Wb);
O.appendChild(ha);O.appendChild(Aa);O.appendChild(La);O.setAttribute(ka.a.ht,String.format("{0}. {1}",ha.innerText,Aa.innerText));O.setAttribute(ka.a.ff,ka.a.Nza);n.appendChild(O)}gph(n,O){const ha=vb.a.De();ha.className=qe.lKd;ha.setAttribute(qe.Xnb,O);ha.tabIndex=0;O=new ie.a;O.Bh(16,16);O.pwa("0,0,2048,2048");const Aa=new Xm.a;Aa.$_("M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");
O.appendChild(Aa);O=O.za;O.setAttribute("class","DesignerMoreIdeasButtonIcon");ha.appendChild(O);O=vb.a.De();O.className="DesignerMoreIdeasButtonLabel";O.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;ha.appendChild(O);ha.setAttribute(ka.a.ht,O.innerText);ha.setAttribute(ka.a.ff,ka.a.St);n.appendChild(ha)}C$k(n){if(n){var O=vb.a.FB();O.className="DesignerMoreIdeasLoading";O.src=Lg.a.bK(lb.a.Xla);n.appendChild(O)}}cPc(n){if(n){var O=n.querySelector("."+qe.lKd);O&&n.removeChild(O);(O=n.querySelector(".DesignerMoreIdeasLoading"))&&
n.removeChild(O)}}fvi(n,O,ha,Aa,La){const Bb=vb.a.De();Bb.className=qe.kNa;Bb.setAttribute(qe.Xnb,O);Bb.setAttribute(ka.a.ht,ResourceStrings.l_DesignerSuggestions);Bb.setAttribute(ka.a.ff,ka.a.lTb);La&&(this.Ob.lUb=this.lXi());for(O=0;O<n;++O)Bb.appendChild(this.YQf(O,n,Aa));ha.appendChild(Bb);return Bb}YQf(n,O,ha){const Aa=vb.a.De();Aa.className=ha?this.T1c+"4x3":this.T1c;Aa.setAttribute(qe.Vza,n);Aa.tabIndex=0;Aa.setAttribute(ka.a.ht,String.format(ResourceStrings.l_DesignerSuggestionItem,n+1));
Aa.setAttribute(ka.a.ff,ka.a.VMa);Aa.setAttribute(ka.a.xId,n+1);Aa.setAttribute(ka.a.yId,O);return Aa}NDe(n,O,ha,Aa,La,Bb,Wb,uc,Vc){let bd=null;this.la.designerIncrementalRenderEnabled&&(O&&(bd=O.querySelector("#"+Aa+' [IncSuggestionPlaceholder="'+Wb+'"]')),bd&&Sys.UI.DomElement.addCssClass(bd,"ShimmerPaused"),this.oUj(Wb,La));O=!1;switch(n){case 0:this.g3k(ha,Bb,Wb);O=(n=uc&&this.la.nOa)&&1!==Vc;La=Aa=Vc=!1;if(Bb&&Bb.Categories)for(const xd of Bb.Categories)2===xd?Vc=uc&&!n:1===xd?Aa=!0:3===xd?La=
!0:4===xd&&this.g5d(ha,"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,Wb);(Vc||O)&&this.Z3k(ha);Aa?this.g5d(ha,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,Wb):La&&(this.g5d(ha,"commoncontrolanimationsuggestioniconnoborder.svg",ResourceStrings.l_DesignerAnimationSuggestionItem,Wb),ha.setAttribute(qe.fKd,qe.fKd),ha.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));break;case 1:this.WOk(ha,
Bb);break;case 2:this.NOk(ha);break;case 3:case 4:this.hPk(ha,Bb)}bd&&bd.parentNode.removeChild(bd);Bb=vb.a.De();Bb.className=qe.LBc;O&&(Bb.style.visibility=bc.a.visible,ha.removeAttribute("tabindex"),ha.setAttribute(ka.a.XJ,ka.a.yB));ha.appendChild(Bb)}WOk(n,O){if(O){n.className=ic.Z4c;n.setAttribute(ka.a.ht,ResourceStrings.L_MakeItVisualCardTitle);var ha=vb.a.tn();ha.className=ic.Gak;ha.innerText=ResourceStrings.L_MakeItVisualCardTitle;var Aa=vb.a.tn();Aa.className=ic.Fak;Aa.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;
var La=vb.a.De();La.className=ic.Eak;La.setAttribute(ka.a.ff,ka.a.lTb);var Bb=0,Wb=new Pi.a,uc=Math.min(ng.rbc,O.SearchTerms.length);for(let Vc=0;Vc<uc;Vc++)Bb=this.ERf(O.SearchTerms[Vc].Term,La,Wb,Vc,Bb);for(O=uc;O<ng.rbc;O++)for(const Vc of ng.PTf)if(!Wb.contains(Vc)){Bb=this.ERf(Vc,La,Wb,O,Bb);break}n.appendChild(ha);n.appendChild(Aa);n.appendChild(La);this.Ob.s4c=!0}}ERf(n,O,ha,Aa,La){const Bb=vb.a.De();Bb.className=ic.jSg;Bb.setAttribute(ka.a.ff,ka.a.VMa);const Wb=ic.QAb+"."+Aa,uc=vb.a.FB();
uc.className=ic.Dak;uc.src=({ltb:La}=this.O4i(n,ha,La)).returnValue;uc.setAttribute(ka.a.o6,Wb);ha=vb.a.De();ha.className=ic.PAb;ha.tabIndex=0;ha.setAttribute(ic.mSg,Aa);ha.setAttribute(ka.a.ff,ka.a.St);Aa=document.createElement("i");Aa.className=ic.Gre;Aa.innerText="\ue721";Aa.setAttribute(ka.a.ff,ka.a.eP);const Vc=vb.a.tn();Vc.className=ic.QAb;Vc.innerText=n;Vc.id=Wb;Bb.appendChild(uc);Bb.appendChild(ha);ha.appendChild(Aa);ha.appendChild(Vc);O.appendChild(Bb);return La}O4i(n,O,ha){for(const Aa of ng.PTf)if(Aa.toLowerCase()===
n.toLowerCase())return O.add(Aa),{returnValue:this.Qd.rk(n+".png"),ltb:ha};return{returnValue:this.Qd.rk("stock"+ha++ +".png"),ltb:ha}}f3k(n,O){if(n){var ha=document.createElement("video");ha.className="SuggestedVideoBackgroundContainer";ha.setAttribute("Src",O);ha.setAttributeNode(document.createAttribute("muted"));ge.a.IJj()||(ha.setAttributeNode(document.createAttribute("autoplay")),ha.setAttributeNode(document.createAttribute("loop")),ha.addEventListener("canplay",()=>{ha.muted="true";ha.play()}));
n.appendChild(ha)}}g5d(n,O,ha,Aa){if(n){var La=vb.a.FB();La.src=this.Qd.rk(O);La.className="SuggestedMediaIcon";O=vb.a.tn();O.className="SuggestedMediaContainer";O.appendChild(La);n.setAttribute(ka.a.ht,String.format(ha,Aa+1));O.setAttribute("aria-hidden",ka.a.yB);O.setAttribute("Unselectable","on");n.appendChild(O)}}Z3k(n){if(n)if(this.la.nOa)Sys.UI.DomElement.addCssClass(n,bc.a.tec);else{n.setAttribute(qe.FBc,qe.FBc);var O=n.getAttribute(ka.a.ht);O&&n.setAttribute(ka.a.ht,String.format("{0}. {1}",
O.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem));ka.a.mO(n,ka.a.nnb,ka.a.Bpa);O=vb.a.De();O.className=qe.KBc;var ha=document.createElement("i");ha.className=qe.IBc;O.appendChild(ha);n.appendChild(O)}}Wyh(){const n=document.getElementsByClassName(qe.$Tb);if(n)for(let O=0;O<n.length;O++){Sys.UI.DomElement.removeCssClass(n[O].parentNode,bc.a.tec);n[O].parentNode.tabIndex=0;n[O].parentNode.removeAttribute(ka.a.XJ);const ha=qa.a.rba(n[O].parentNode,qe.LBc);!ha||ha.getAttribute(qe.rKd)&&ha.getAttribute(qe.rKd).toString()===
qe.vJf||(ha.style.visibility=bc.a.hidden)}}Ypl(){if(this.la.nOa){var n=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(n)for(var O=0;O<n.length;O++)n[O].parentNode.removeChild(n[O]);if(n=document.getElementsByClassName("DesignerInFreeTrialView"))for(O=0;O<n.length;O++)n[O].parentNode.removeChild(n[O]);this.Wyh()}else if(n=document.getElementsByClassName(qe.KBc))for(O=0;O<n.length;O++){n[O].style.display="none";const Aa=n[O].parentNode;Aa.removeAttribute(qe.FBc);Aa.removeAttribute(ka.a.nnb);
var ha=Aa.getAttribute(ka.a.ht);ha&&(ha=ha.toString(),ha=ha.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,""),Aa.setAttribute(ka.a.ht,ha))}}g3k(n,O,ha){if(n&&O)try{let Aa=!1;try{n.setAttribute(qe.$nb,O.SlideId.Sid),n.setAttribute(qe.qKd,O.SlideId.Cid),Aa=!0}catch(Bb){K.a.J(594071824,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),Aa=!1}Aa||n.setAttribute(qe.$nb,O.SlideSid);const La=vb.a.FB();La.className=qe.$Tb;La.src=O.Base64Img;this.Ob.oqa.contains(O.Index)||
this.Ob.oqa.add(O.Index);this.la.fGc&&!ib.a.Xa(O.DesignerMediaURL)&&O.Categories&&Db.a.contains(O.Categories,1)&&this.f3k(n,O.DesignerMediaURL);n.appendChild(La);K.a.J(42342620,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",ha,this.Ob.correlationId)}catch(Aa){n.parentNode.removeChild(n),K.a.J(41695003,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",ha,this.Ob.correlationId,
Aa)}}NOk(n){if(Db.a.Xa(this.Ob.iV)||!this.Ob.Uqi())n.style.display=bc.a.none;else{n.className=ic.xSd;var O=vb.a.tn();O.className=ic.jIi;O.innerText=ResourceStrings.L_ConsistencyCardTitle;var ha=vb.a.De();ha.className=ic.fIi;var Aa=vb.a.tn();Aa.className=Aa.id=ic.eYf;Aa.innerText=Aa.title=this.Ob.iV[0].critiques[0].explanationLabel;var La=vb.a.De();La.className=ic.VHi;var Bb=vb.a.tn();Bb.innerText="<";Bb.tabIndex=0;Sys.UI.DomElement.addCssClass(Bb,ic.G4a);Sys.UI.DomElement.addCssClass(Bb,ic.OXb);Bb.id=
ic.G4a;var Wb=vb.a.tn();Wb.innerText="1";Wb.id=ic.wSd;this.Ob.JM=0;var uc=vb.a.tn();uc.innerText="/";var Vc=vb.a.tn();Vc.className=ic.WHi;Vc.id=ic.UXf;Vc.innerText=this.Ob.iV.length.toString();var bd=vb.a.tn();bd.innerText=">";bd.tabIndex=0;bd.className=bd.id=ic.fqb;0<this.Ob.iV.length-1?Sys.UI.DomElement.addCssClass(bd,ic.gqb):Sys.UI.DomElement.addCssClass(bd,ic.NXb);La.appendChild(Bb);La.appendChild(Wb);La.appendChild(uc);La.appendChild(Vc);La.appendChild(bd);ha.appendChild(Aa);ha.appendChild(La);
Aa=vb.a.tn();Aa.className=ic.YHi;Aa.innerText=ResourceStrings.L_ConsistencyCardDescription;La=qe.aRf();this.chg(La,0);Bb=vb.a.De();Bb.className=ic.aIi;Wb=vb.a.De();Wb.className=ic.MXb;Wb.innerText=ResourceStrings.L_ConsistencyCardIgnore;Wb.title=ResourceStrings.L_ConsistencyCardIgnoreTitle;Wb.tabIndex=0;Bb.appendChild(Wb);Wb=vb.a.De();Wb.className=ic.dIi;uc=vb.a.tn();uc.className=ic.QXb;uc.innerText=ResourceStrings.L_ConsistencyCardSeeMore;uc.tabIndex=0;Wb.appendChild(uc);uc=vb.a.De();uc.id=ic.VXf;
uc.appendChild(ha);uc.appendChild(Aa);uc.appendChild(La);uc.appendChild(Bb);n.appendChild(O);n.appendChild(uc);n.appendChild(Wb);this.Ob.gHc=!0}}hPk(n,O){if(O){n.className=qe.EJf;n.setAttribute(ka.a.ht,O.TitleText);n.setAttribute(qe.Vza,O.Index);var ha=this.Hfl(O.ExecutionActionName);if(ha){var Aa=vb.a.FB();Aa.src=this.Qd.rk("pegal.png");Aa.className=ha;var La=vb.a.tn();La.className="cui-img-container cui-img-24by24";La.appendChild(Aa);n.appendChild(La)}Aa=vb.a.tn();Aa.className="DesignerSuggestedActionTitle";
Aa.innerText=O.TitleText;La=vb.a.tn();La.className="DesignerSuggestedActionSubtitle";La.innerText=O.DescriptionText;O=vb.a.De();O.className=ha?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";O.appendChild(Aa);O.appendChild(La);n.appendChild(O)}}wch(n){try{if(this.iwb&&this.iwb.instance){const O=vb.a.De();O.id="AgendaCardContainer";O.className="AgendaCardContainer";n.appendChild(O);this.iwb.instance.poh(O)}}catch(O){K.a.J(577807425,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",
this.Ob.correlationId,O)}}Iki(){try{this.iwb&&this.iwb.instance&&this.iwb.instance.L3d()}catch(n){K.a.J(577807395,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Ob.correlationId,n)}}Hfl(n){switch(n){case "PowerPointConvertImageToTable":return"pegal_ImageToTable_24x24x32";default:return null}}chg(n,O){O=this.Ob.iV[O].critiques[0].suggestions;const ha=Math.min(ng.a$j,O.length);for(let Aa=0;Aa<ha;Aa++)this.omj(n,O[Aa].description,O[Aa].numberOfInstances,
Aa)}omj(n,O,ha,Aa){const La=vb.a.De();La.className=ic.DOa;La.tabIndex=0;La.setAttribute(ng.COa,Aa);const Bb=vb.a.tn();Bb.className=ic.hHc;Bb.innerText="\u2192";Bb.setAttribute(ng.COa,Aa);const Wb=vb.a.tn();Wb.className=ic.gYf;Wb.innerText=O;Wb.setAttribute(ng.COa,Aa);O=vb.a.tn();O.className=ic.fYf;O.innerText=String.format("[{0}]",ha);O.setAttribute(ng.COa,Aa);La.appendChild(Bb);La.appendChild(Wb);La.appendChild(O);n.appendChild(La)}Zdl(n){this.bid();this.l8b=new Y.a(2,1,this.la.designerIncrementalRenderTimeoutInMs,
()=>{this.nUj(n)},void 0,"IncrementalRenderTimeoutTask");this.Bb.Hb(this.l8b)}bid(){this.l8b&&(this.Bb.ah(this.l8b),this.l8b=null)}nUj(n){this.bid();for(let O=0;O<n;O++)this.Ob.oqa.contains(O)||this.Ob.KPc.add(O)}oUj(n,O){if(!this.Ob.oNa.contains(n)&&(this.Ob.oNa.add(n),n=this.Ob.oNa.count,n===O&&(this.Ob.KSb=new Date,this.bid()),!this.Ob.zJb&&n>=this.Ob.lUb)){for(O=0;O<this.Ob.lUb;O++)if(!this.Ob.oNa.contains(O))return;this.Ob.zJb=new Date}}lXi(){const n=document.getElementById("WACDocumentPanel");
if(n){const O=this.la.useWideSuggestionThumbs,ha=this.Z6d();return Math.floor((n.offsetHeight-87)/(O||ha?135:101))}return 1}Z6d(){const n=this.Gv();return.01>=Math.abs(n.width/n.height-1.33)}pMf(n,O){this.USe(this.rrb(n,O),O,!1)}Kih(n,O){this.USe(n,O,!0)}Zol(n){if(n&&(n=n.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var O=-1!==n.className.indexOf("4x3");this.USe(n,O,!1)}}USe(n,
O,ha){n&&(ha?(n.className=O?this.U1c+"4x3":this.U1c,ka.a.mO(n,ka.a.R2a,ka.a.yB)):(n.className=O?this.T1c+"4x3":this.T1c,ka.a.mO(n,ka.a.R2a,ka.a.Bpa)))}Gv(){return this.qc.Gv()}rrb(n,O){return n.querySelector("."+(O?this.U1c+"4x3":this.U1c))}get Ca(){return Object(M.a)(132,this.ua.Ca)}dhh(n,O){if(n){if(n=n.querySelector("["+qe.Vza+'="'+O+'"]'))O=pc.a.ei(n),n.contains(pc.a.EPa(new Sys.UI.Point(O.x,O.y)))&&n.contains(pc.a.EPa(new Sys.UI.Point(O.x+O.width-1,O.y)))?n.contains(pc.a.EPa(new Sys.UI.Point(O.x,
O.y+O.height-1)))&&n.contains(pc.a.EPa(new Sys.UI.Point(O.x+O.width-1,O.y+O.height-1)))||n.scrollIntoView(!1):n.scrollIntoView(!xh.a("Designer.ScrollIntoViewFix"))}else K.a.J(36845459,829,15,"Designer view has been removed from DesignerViewContainer")}static NQd(n){let O=null;try{O=ef.a(n)}catch(ha){K.a.J(39338641,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return O}static rqk(n){const O=n.CardData;let ha=null;try{if(ha=ef.a(O),!n.SlideSuggestions&&
ha)for(ha=aj.e(ha,Aa=>0!==Aa.Type),n=0;n<ha.length;n++)ha[n].Index=n}catch(Aa){K.a.J(41969486,829,10,"parsing cards failed with exception: {0}",Aa)}return ha}static r$k(n,O,ha){ha.style.backgroundColor="white";const Aa=vb.a.De();Aa.className=n?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";Aa.setAttribute("IncSuggestionPlaceholder",O);(Ic.a.Gj||Ic.a.ag)&&Sys.UI.DomElement.addCssClass(Aa,"Shimmer");ha.appendChild(Aa)}static aRf(){const n=vb.a.De();n.className=
n.id=ic.hYf;return n}}qe.kNa="DesignerSuggestionList";qe.Xnb="correlationId";qe.Vza="suggestionIndex";qe.$nb="slideId";qe.qKd="slideCid";qe.FBc="isShownAsPremiumContent";qe.fKd="containsAnimation";qe.vJf="Refreshing";qe.rKd="SourceTrigger";qe.$Tb="SuggestionImg";qe.IBc="ms-Icon ms-Icon--Diamond";qe.KBc="ShadowedTriangleContainer";qe.LBc="DesignerSuggestionListDisabled";qe.lKd="DesignerMoreIdeasButton";qe.EJf="DesignerSuggestedActionResult";qe.ZTb="DesignerInFreeTrialViewGoPremiumText";qe.YTb="DesignerFreeTrialCardGoPremiumButton";
qe.Ynb="DesignerStartFreeTrialButton";qe.CBc="DesignerStartFreeTrialGoPremiumButton";Object(h.a)(qe,"DesignerViewHelper",null,[932]);class xl{constructor(){this.cid=this.sid=0;this.mPc=this.MP=this.trigger=null}}Object(h.a)(xl,"PendingRequest",null,[]);class Zk{constructor(){this.doe=!1;this.oyb=null}get vvg(){return this.doe}get syg(){return this.oyb}static get inProgress(){const n=new Zk;n.doe=!0;n.oyb=new Date;return n}static get ready(){const n=new Zk;n.doe=!1;n.oyb=null;return n}}Object(h.a)(Zk,
"RequestState",null,[]);var gf=d(324),wk=d(424);class Zj{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze,Ah,Bk,Oe,sh,Ck,Hm,nm,yo,eo,Mp,bm,zo,yh,jk,Ao,Lq){this.hL=null;this.eGa=this.LFg=0;this.LIg=!1;this.wSa=this.Ibb=null;this.GDg=!1;this.qo=Wb;this.Hq=uc;this.Iq=Vc;this.zy=bd;this.Ob=xd;this.ia=n;this.eW=O;this.ob=La;this.Ga=Bb;this.ua=xe;this.yh=wf;this.Xc=Ze;this.zG=Ah;this.la=Bk;this.Zb=ha;this.Jb=Aa;this.Yh=Oe;this.Aka=sh;this.Jka=Zk.ready;this.k8=Ck;this.Pb=Hm;this.Oc=nm;this.Bb=yo;this.oAb=
eo;this.o7b=zo;this.qc=yh;this.dL=jk;this.Pv=Ao;this.tBg=Lq;this.KFg=Object(r.a)(this,this.kjj,"handleFirstRunExperienceEvent");bm&&bm.isFeatureEnabled("PowerPointEnterpriseDesigner",!1).then(qf=>{this.LIg=qf;return null});this.ia.bma(this)}wb(){this.la.uRc&&(this.ia.ra(Ab.a.Poh,yb.a.application,Object(r.a)(this,this.Ooh,"showHideIdeas"),4),this.ia.ra(Ab.a.XKe,yb.a.application,Object(r.a)(this,this.Ooh,"showHideIdeas"),4),xh.a("Designer.QueryNewPane")&&this.ia.ra(Ab.a.TAe,yb.a.application,Object(r.a)(this,
this.HAk,"queryShowHideDesignerPane"),96),this.ia.ra(Ab.a.HIc,yb.a.application,Object(r.a)(this,this.VKe,"showHideDesigner"),4),this.ia.ra(Ab.a.Kza,yb.a.application,Object(r.a)(this,this.Kza,"applyDesignerSuggestion"),4),this.ia.ra(Ab.a.gnb,yb.a.application,Object(r.a)(this,this.Kza,"applyDesignerSuggestion"),4),this.ia.ya(Ab.a.yVa,yb.a.application,Object(r.a)(this,this.wVa,"navigateDesignerSuggestion")),this.ia.ya(Ab.a.gBb,yb.a.application,Object(r.a)(this,this.wVa,"navigateDesignerSuggestion")),
this.ia.ya(Ab.a.hBb,yb.a.application,Object(r.a)(this,this.wVa,"navigateDesignerSuggestion")),this.ia.ya(Ab.a.xVa,yb.a.application,Object(r.a)(this,this.wVa,"navigateDesignerSuggestion")),this.ia.ya(Ab.a.dBb,yb.a.application,Object(r.a)(this,this.wVa,"navigateDesignerSuggestion")),this.ia.ya(Ab.a.eBb,yb.a.application,Object(r.a)(this,this.wVa,"navigateDesignerSuggestion")),this.ia.ya(Ab.a.fBb,yb.a.application,Object(r.a)(this,this.wVa,"navigateDesignerSuggestion")),this.ia.ya(Ab.a.rcb,yb.a.application,
Object(r.a)(this,this.wVa,"navigateDesignerSuggestion")),this.ia.ra(Ab.a.qma,yb.a.application,Object(r.a)(this,this.qma,"reportSuggestionSessionInfo"),64),this.ia.ya(Ab.a.$Uf,yb.a.application,Object(r.a)(this,this.Zll,"triggerOnUndoRedo")),this.ia.ya(Ab.a.g6d,yb.a.application,Object(r.a)(this,this.Agg,"handleImageUploadForDesigner")),this.ia.ya(Ab.a.rQc,yb.a.application,Object(r.a)(this,this.Agg,"handleImageUploadForDesigner")),this.Aka.H2a(Object(r.a)(this,this.C_,"onSlidePresenceChanged")),this.yh.xM(Object(r.a)(this,
this.ADi,"designerTargetSlideChangedHandler")),this.la.designerIncrementalRenderEnabled&&this.Xc.Y2h(Object(r.a)(this,this.Jkk,"onRenderSuggestions")),this.la.sha&&this.Xc.p1h(Object(r.a)(this,this.kjk,"onMoreIdesClicked")),this.la.SUf&&this.Xc.Imb(Object(r.a)(this,this.fva,"onRibbonTabSwitched")),this.la.vz&&this.yh.Jmb(Object(r.a)(this,this.yDi,"designerSlidesSelectionChangedHandler")),this.la.designerSendAppliedSuggestionHistoryEnabled&&this.k8.wSb(Object(r.a)(this,this.zda,"onBlockingStateChanged")),
this.yh.OBf(Object(r.a)(this,this.V6c,"onForceOutboundGraphTransactionDisposed")),this.oAb.vSb(Object(r.a)(this,this.Icb,"onMarkedUndo")),this.la.TQd&&this.Oc.F2a(Object(r.a)(this,this.Qcb,"onSessionEnding")),this.Oc.xB(Object(r.a)(this,this.eo,"onSessionRehydrated")),this.o7b&&this.o7b.execute(n=>{n.dCf(Object(r.a)(this,this.Eue,"onEditorCritiques"))}),this.tBg&&this.tBg.execute(n=>{n.F2h(Object(r.a)(this,this.eik,"onHighConfidenceAgendaDetected"))}),this.la.tDi?(this.LFg=window.setTimeout(Object(r.a)(this,
this.pRe,"tryTriggerNewDocDesignerRequest"),this.la.sDi),window.addEventListener("FREDecisionEvent",this.KFg,!0)):this.pRe(),!ib.a.Xa(this.la.vye)&&this.BDi(this.la.vye)&&(this.rij(),this.Vll(this.la.vye)))}kjj(n){window.removeEventListener("FREDecisionEvent",this.KFg,!0);window.clearTimeout(this.LFg);(n=n.detail)&&n.show&&n.show||this.pRe()}Fe(){const n=this.Ga.Bc(Rc.a.J6);n.bindAction(jb.KeyInputManager.La(ra.a.C0,0),Ab.a.yVa);n.bindAction(jb.KeyInputManager.La(ra.a.iB,0),Ab.a.yVa);n.bindAction(jb.KeyInputManager.La(ra.a.dE,
0),Ab.a.gBb);n.bindAction(jb.KeyInputManager.La(ra.a.tq,4),Ab.a.hBb);n.bindAction(jb.KeyInputManager.La(ra.a.A0,0),Ab.a.xVa);n.bindAction(jb.KeyInputManager.La(ra.a.hB,0),Ab.a.xVa);n.bindAction(jb.KeyInputManager.La(ra.a.mw,0),Ab.a.dBb);n.bindAction(jb.KeyInputManager.La(ra.a.tq,0),Ab.a.eBb);n.bindAction(jb.KeyInputManager.La(ra.a.WQ,0),Ab.a.fBb);n.bindAction(jb.KeyInputManager.La(ra.a.vO,0),Ab.a.rcb)}VKe(n,O,ha,Aa,La){return this.ML(this.Hq,Rc.a.J6,ha,n,La)}Ooh(n,O,ha,Aa,La){return La||!this.qo.isVisible?
this.ML(this.Hq,Rc.a.ktb,ha,n,La):0}ML(n,O,ha,Aa,La){var Bb=this.ua.presentation;Bb=!!this.ua.Ca&&!!Bb&&!this.Zb.gd(Bb);if(this.la.vz){const Wb=this.ob.rf();Bb=!!Wb&&1===Wb.length&&Bb}if(!Bb)return 16;if(!this.zy.isEnabled())return 8;if(1===ha)return 32;La||this.Ga.Kj(O,n.vp.isVisible);Aa===Ab.a.HIc?this.Ob.correlationId&&!this.Ob.jvb(this.Ob.correlationId)||this.Cba(vd.kIb):n.vp.isVisible?n.vp.Uo(!1,gf.a.tHb):(this.Cba(Aa===Ab.a.XKe?vd.kIb:vd.tmc),n.vp.Uo(!0,gf.a.none));return 32}HAk(n,O,ha,Aa,La){if(!Object(Qj.a)(Jk.a,
La)||!this.Hq||!this.Hq.vp)return 8;La.Yf(this.Hq.vp.isVisible);return 32}Kza(n,O,ha,Aa,La){O=this.ua.presentation;if(!this.ua.Ca||!O||this.Zb.gd(O))return 16;Aa=null;let Bb=!0;Object(Qj.a)(Yj,La)?Aa=La:Object(Qj.a)(Tn,La)&&(Aa=La.AAc,Bb=!1);if(!this.zy.isEnabled()||!Aa)return 8;if(this.zy.rpk())return K.a.J(24514636,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",Aa.CorrelationId,n),8;if(1===ha)return 32;if(!this.ob.hu()){if(1===this.ob.he().length&&
this.ob.he()[0].qy)return this.ob.Rh(),K.a.J(36845449,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",Aa.CorrelationId,n),8;this.ob.Rh()}if(!this.la.sha&&this.Ob.AY.sid===Aa.SuggestionSid)return K.a.J(38580375,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",Aa.CorrelationId,Aa.SuggestionSid),2;ha=this.Jb.ie(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&
(this.Ob.SMa=new Date),ha.lc(O),ha.fd=n,O.KAa=Aa,this.Ob.AY=N.a.XD(Aa.SuggestionSid,Aa.SuggestionCid),this.Ob.xS=!0,K.a.J(22590804,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Aa.CorrelationId,n,Aa.SuggestionSid)}finally{ha&&ha.dispose()}this.la.designerBlockApplyUntilDraw?this.Zb.Hpa(O,this.ua.Ca,this.Pb.Na,n):this.Zb.xw(O,n);this.qo.isVisible&&this.Ga.vf(Rc.a.ktb);Bb&&this.Ob.dre();return 32}wVa(n,O,ha){O=this.ua.presentation;if(!this.ua.Ca||
!O||this.Zb.gd(O))return 16;if(!this.zy.isEnabled())return 8;if(1===ha)return 32;this.zy.mnj(n);return 32}qma(n,O,ha,Aa,La){if(this.zy.Hq.vp.isVisible)return 0;this.qFb(La.ISc,La.hRk);return 32}qFb(n,O){const ha=this.Ob.correlationId;if(ib.a.Xa(ha))K.a.J(593236959,829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",O);else if(this.Ob.jvb(ha))K.a.J(593236993,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",
ha,O);else{var Aa={};Aa.CachedTrigger=this.Ob.uKd;Aa.SuggestionSlideId=this.Ob.AY.sid.toString();Aa.SuggestionSlideCreationId=this.Ob.AY.cid.toString();Aa.AppliedSuggestion=this.Ob.xS;Aa.DisplaySuggestionsTimeoutInMs=this.la.SQd;Aa.SuggestionsTimeout=this.Ob.SRa;Aa.ClientAbort=this.Ob.$tb||this.zy.opk();Aa.DesignerPaneClosed=n;Aa.ResetReason=O;Aa.HoverPreviewDesignerTriggered=this.Ob.Usg;Aa.DesignerFixPaneOpenHint=this.la.UUf;Aa.DesignerSendTraceRequestOnSessionEnded=this.la.TQd;this.la.SUf&&(Aa.DesignerDesignTabTriggerEnabled=
!0);this.Hq.Hqa()&&(this.la.nOa?(Aa[sb.a.sBh]=this.Iq.C1d(),Aa[sb.a.tBh]=!0,this.Ob.OMe&&(Aa.StartUpsellFreeTrial=!0)):Aa[sb.a.vPf]=!0);n=!!O&&0<=O.indexOf(vd.moreIdeas);this.la.sha&&(Aa.TermCorrelationId=Zj.n1d(),n||(Aa.TermAction=this.cdj()));var La=ef.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),Bb={};Bb.ClientOS=La.Os;Bb.Browser=La.Browser||"";Bb.BrowserVersion=La.BrowserVersion||"";Bb.BrowserMajorVersion=La.BrowserMajorVersion||"";Bb.BrowserMinorVersion=La.BrowserMinorVersion||
"";this.Ob.jlc&&this.Ob.Cea&&this.Ob.Cea>this.Ob.jlc&&(Bb.SuggestionsE2ETimeMs=+this.Ob.Cea-+this.Ob.jlc);this.la.designerIncrementalRenderEnabled&&(this.Iq.bid(),this.TMe(),Aa[sb.a.Jkg]=!0,Bb.VisibleSuggestionsCount=this.Ob.lUb,0<this.Ob.KPc.count&&(Bb.IncrementalRenderTimeoutIndexes=this.Ob.KPc.toArray().join(",")),0<this.Ob.pda.count&&(Bb.MissingDesignerCardIndexes=this.Ob.pda.toArray().join(",")),0<this.Ob.oNa.count&&(Bb.CardIndexes=this.Ob.oNa.toArray().join(",")),0<this.Ob.oqa.count&&(Bb.DesignerCardIndexes=
this.Ob.oqa.toArray().join(",")),this.Ob.nP&&(this.Ob.Fbc&&this.Ob.Fbc>this.Ob.nP&&(Bb.MissingDesignerCardsReceivedTime=+this.Ob.Fbc-+this.Ob.nP),this.Ob.KSb&&this.Ob.KSb>this.Ob.nP&&(Bb.AllIncRenderReceivedTime=+this.Ob.KSb-+this.Ob.nP),this.Ob.zJb&&this.Ob.zJb>this.Ob.nP&&(Bb.VisibleIncRenderReceivedTime=+this.Ob.zJb-+this.Ob.nP)));this.xZh(Bb);try{if(this.Pv.instance){const Wb=this.Pv.instance.jQk();ib.a.Xa(Wb)||(Aa.AgendaMetrics=Wb)}}catch(Wb){K.a.J(574665995,813,10,"exception while populating AgendaMetrics",
Wb)}Aa.BrowserData=Bb;this.Ob.nP&&this.Ob.Cea&&this.Ob.Cea>this.Ob.nP&&(Aa.TimeToDisplaySuggestionsInMs=+this.Ob.Cea-+this.Ob.nP);this.Ob.qPe&&this.Ob.gmc&&(Aa.TimeSuggestionsRendered=this.Ob.qPe.toUTCString());this.Ob.gmc&&(Aa.TimeDesignerPaneClosed=this.Ob.gmc.toUTCString());this.Ob.gTb&&0<this.Ob.gTb.count&&(Aa.AppliedSuggestionHis=this.Ob.gTb.toArray().join(" "));this.Yh.qma(ha,Fe.c(Aa),O===gf.a.$ed);this.Trl(ha,O);this.Ob.cAf(ha,this.la.sha&&n);K.a.J(22590806,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",
O,ha)}}xZh(n){n.IdeasMivShown=this.Ob.s4c;n.IdeasMivDrillIn=this.Ob.Xqe;n.IdeasEditorShown=this.Ob.gHc;n.IdeasEditorKept=this.Ob.fHc;n.IdeasEditorDrillIn=this.Ob.WXf;n.AnyCardShown=this.Ob.gHc||this.Ob.s4c||0<this.Ob.oNa.count;n.AnyCardKept=this.Ob.fHc||this.Ob.xS}Trl(n,O){this.zy.sGa(n,O===gf.a.tHb||O===gf.a.zid||O===gf.a.noSuggestion||O===gf.a.dWf?Yk.a.rGa:Yk.a.pending)}Jkk(n,O){O.xsh.addRange(this.Ob.oqa);this.BLf(O.xsh,O.a0f,O.slideId,O.trigger,O.correlationId);O.l5a&&(this.wSa||this.Ob.pda.count||
this.Pdl(O.trigger,O.a0f))}kjk(n,O){this.Cba(vd.moreIdeas,null,O.HUc)}fva(n,O){!O.ola||"PptRibbon.Design"!==O.ola&&"Design"!==O.ola||2!==O.Ru&&3!==O.Ru&&4!==O.Ru||this.zy.Hq.vp.isVisible||32!==this.ia.processAction(Ab.a.$Ke,1)||this.Cba(vd.PQd)}Pdl(n,O){this.TMe();const ha=this.ua.Ca.Cb,Aa=this.Ob.correlationId;this.wSa=new Y.a(2,1,this.la.retryMissingDesignerCardsCountdownInMs,()=>{this.Ob.jvb(Aa)||this.BLf(this.Ob.oqa,O,ha,n,Aa,O)},void 0,"CheckAndFetchMissingDesignerCardsTask");this.Bb.Hb(this.wSa)}BLf(n,
O,ha,Aa,La,Bb=-1){if(this.Ob.oqa.count===O)this.TMe();else if(n&&n.count&&!(0<this.Ob.pda.count)){if(-1===Bb)for(let Wb of n)Wb>Bb&&(Bb=Wb);this.qji(n,O,Bb)&&this.Wml(ha,Aa,La)}}qji(n,O,ha){for(let Aa=0;Aa<O&&(n.contains(Aa)||this.Ob.pda.contains(Aa)||this.Ob.pda.add(Aa),Aa!==ha||this.Ob.pda.count);Aa++);return 0<this.Ob.pda.count}Wml(n,O,ha){const Aa={};Aa.MissingDesignerCardIndexes=this.Ob.pda.toArray().join(",");this.wSa=new Y.a(0,1,0,()=>{this.Yh.Oha(n.cid,n.sid,ha,Zj.n1d(),O,null,Fe.c(Aa),()=>
{K.a.J(42259678,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",Aa.MissingDesignerCardIndexes,ha)},La=>{K.a.J(42259680,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",Aa.MissingDesignerCardIndexes,La.HttpStatusCode);return!0})},void 0,"FetchMissingDesignerCardsTask");this.Bb.Hb(this.wSa)}TMe(){this.wSa&&
(this.Bb.ah(this.wSa),this.wSa=null)}C_(n,O){(n=this.ua.Ca)&&O.slideId.equals(n.Cb)&&(this.zy.Hhd(O.iqh,O.l5g),this.zy.Hq.vp.isVisible&&!this.zy.isEnabled()&&(K.a.J(22680479,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",O.iqh,O.l5g,this.Ob.correlationId),this.qo.Uo(!1,gf.a.Nmi)),this.qo.isVisible&&(this.zy.isEnabled()||this.zy.sGa(this.Ob.correlationId,Yk.a.rGa)))}ADi(n,
O){O.nla?(n=Object.assign(new Fq.a,{slideId:O.nla.Cb}),this.ia.Ma(Ab.a.uWa,2,n),this.zy.Hhd(n.Gkc,n.k5g),this.qo.isVisible&&(K.a.J(22853506,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Ob.correlationId),this.zy.isEnabled()&&!O.nla.zK?this.Cba(vd.fMe):O.nla.zK&&this.la.designerNewSlideEnabled||(this.qo.Uo(!1,gf.a.slideNavigation),this.zy.sGa(this.Ob.correlationId,Yk.a.rGa)))):K.a.J(24463122,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",
this.Ob.correlationId)}k1b(n){this.la.designerRequestThrottlingEnabled&&(this.Jka=Zk.ready,this.hL&&(this.qo.isVisible?(K.a.J(39413843,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.hL.trigger,this.hL.sid),n()):this.hL=null))}Scb(n,O){this.k1b(O);K.a.J(36966411,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",n.HttpStatusCode);return!0}yDi(){if(this.zy.Hq.vp.isVisible){const n=this.ob.rf();n&&1<
n.length&&(K.a.J(25968672,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),this.qo.isVisible&&this.qo.Uo(!1,gf.a.Abk))}}zda(n,O){n=this.Ob.SMa;const ha=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";n&&Object(M.a)(String,O.actionName)===ha&&(this.Ob.gTb.add(String.format("{0}:{1}:{2}",this.Ob.AY,+n-+this.Ob.Cea,+new Date-+n)),this.Ob.SMa=null)}Qcb(n,O){this.zy.Hq.vp.isVisible&&(K.a.J(592540182,
829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.Ob.correlationId,wk.a[O.aJ]),1!==O.aJ&&3!==O.aJ||this.qFb(!0,gf.a.$ed))}eo(){K.a.J(40379151,829,50,"DesignerActor::OnSessionRehydrated");const n={};n[sb.a.AIc]=!0;this.Cba(vd.refresh,n)}V6c(n,O){O&&this.s2d(O.actionId,O.transaction.iy)}Icb(n,O){if(O.xub&&this.zy.dxg(O.actionId)){n={};if(O.revisionId){const ha=za.a.vra(bp.a.mX,za.a.u6a(O.revisionId.toString()).toString());ha&&1===ha.length&&(n[sb.a.wE]=ha[0].wE)}this.s2d(O.actionId,
n)}}Agg(n,O,ha,Aa,La){switch(n){case Ab.a.g6d:return this.Ob.C9j(La),32;case Ab.a.rQc:return this.Ob.ZLk(La),32;default:return 2}}Z8j(n,O,ha){if(n!==vd.insertPicture&&n!==vd.tva&&n!==vd.fQc)return null;const Aa=ha?ha[sb.a.s1b]:!1,La=ha?ha[sb.a.JOc]:!1,Bb=ha?ha[sb.a.t1b]:!1,Wb=ha?ha[sb.a.IOc]:!1;let uc=null;switch(O){case Ab.a.QGa:case Ab.a.n9c:uc=Aa?sb.a.Jrk:La?sb.a.Irk:Bb?sb.a.Krk:Wb?sb.a.Hrk:null;break;case Ab.a.p9c:uc=Aa?sb.a.Nrk:La?sb.a.Mrk:Bb?sb.a.Ork:Wb?sb.a.Lrk:null;break;case Ab.a.VIc:uc=
sb.a.u4f;break;case Ab.a.insertOnlinePicture:case Ab.a.KCa:uc=sb.a.online;break;case Ab.a.Ulg:uc=sb.a.icon}uc||K.a.J(41182167,829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",n,O,this.Ob.correlationId);delete ha[sb.a.s1b];delete ha[sb.a.JOc];delete ha[sb.a.t1b];delete ha[sb.a.IOc];return uc}$8j(n,O){switch(n){case Ab.a.VIc:case Ab.a.insertOnlinePicture:case Ab.a.KCa:case Ab.a.iec:case Ab.a.Ulg:return vd.insertPicture;
case Ab.a.p9c:case Ab.a.QGa:case Ab.a.n9c:case Ab.a.d$c:return O&&O[sb.a.s1b]||O&&O[sb.a.JOc]&&this.la.Lll?vd.insertPicture:O&&O[sb.a.t1b]?vd.tva:O&&O[sb.a.IOc]&&this.la.awh?vd.fQc:this.la.lxa?vd.RGa:"";case Ab.a.r3a:case Ab.a.uNa:case Ab.a.knb:return vd.knb;case Ab.a.Lpa:return vd.aMe;case Ab.a.yjc:case Ab.a.zjc:case Ab.a.FIe:case Ab.a.GIe:case Ab.a.egd:return O&&sb.a.Rsb in O&&O[sb.a.Rsb]?vd.uLd:vd.refresh;case Ab.a.OMf:case Ab.a.B3a:return O&&sb.a.Rsb in O&&O[sb.a.Rsb]?vd.OUf:vd.refresh;case Ab.a.lGa:case Ab.a.reb:case Ab.a.Zic:case Nf.a.VQa:case Ab.a.bringForward:case Ab.a.bringToFront:case Ab.a.sendToBack:case Ab.a.sendBackward:return vd.xeb;
case Nf.a.LId:case Nf.a.OId:case Nf.a.rTb:case Nf.a.NId:case Nf.a.PId:case Nf.a.QId:case Nf.a.tTb:case Nf.a.RId:case Nf.a.SId:case Nf.a.TId:case Nf.a.UId:case Nf.a.WId:case Nf.a.YId:case Nf.a.backspace:case Nf.a.Rza:case Nf.a.dK:case Nf.a.jOa:case Nf.a.enter:case Nf.a.WA:case Nf.a.typing:return vd.typing;case Ab.a.tva:return vd.tva;case Ab.a.h$c:return vd.insertTable;case Ab.a.pla:case Ab.a.B5c:case Ab.a.nBb:case Ab.a.YR:return vd.oGa;case Ab.a.RMa:return vd.KHd;case Ab.a.uLf:return vd.kLd;case Ab.a.wob:return vd.wob;
default:return vd.refresh}}Zll(){const n={};n[sb.a.undoRedo]=!0;this.Cba(vd.refresh,n);return 32}s2d(n,O){if(!this.pzj(n)){var ha=Bb=>{const Wb={};Wb[sb.a.timestamp]=Bb.timestamp;Wb[sb.a.correlationId]=Bb.correlationId;Wb[sb.a.trigger]=Bb.trigger;Wb[sb.a.sid]=Bb.sid;Wb[sb.a.cid]=Bb.cid;Wb[sb.a.MP]=Bb.MP;Bb=this.Jb.xd(4);try{Bb.lc(this.ua.presentation),Bb.fd=Ab.a.VUf,this.ua.presentation.Kpb=Fe.c(Wb)}finally{Bb&&Bb.dispose()}},Aa=this.$8j(n,O),La=this.Z8j(Aa,n,O);ib.a.Xa(La)||(O||(O={}),O[sb.a.YAa]=
La);this.zy.dxg(n)&&this.qo.isVisible?(this.Ibb&&this.Bb.ah(this.Ibb),this.zy.sGa(this.Ob.correlationId,Yk.a.pending),this.Ofd(vd.typing),this.Ibb=new Y.a(2,1,this.la.designerTypeRefreshThrottleTimeoutMs,()=>{this.qo.isVisible&&K.a.J(42320064,829,50,"Potential candidate for typing refresh request for designer pane");this.q8k(this.ua.Ca)||this.bIc(ha,Aa,O)},void 0,"DesignerTypingRefreshTask"),this.Bb.Hb(this.Ibb)):this.bIc(ha,Aa,O)}}Cba(n,O=null,ha=null){this.bIc(Aa=>{if(this.la.designerRequestThrottlingEnabled){if(this.Jka.vvg&&
+new Date-+this.Jka.syg<this.la.designerRequestThrottleIntervalMs){this.hL=new xl;this.hL.sid=Aa.sid;this.hL.cid=Aa.cid;this.hL.trigger=Aa.trigger;this.hL.mPc=Aa.MP;K.a.J(40379153,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",n,Aa.sid);return}this.Jka=Zk.inProgress;this.hL=null}const La=()=>{this.Cba(this.hL.trigger,this.hL.mPc,ha)};this.Yh.Oha(Aa.cid,Aa.sid,Aa.correlationId,Zj.n1d(),Aa.trigger,ha,Fe.c(Aa.MP),Bb=>{Bb&&Bb.Status===sb.a.Udh?
this.ydd(()=>{this.Cba(Aa.trigger,Aa.MP,ha)}):this.eGa=0;this.eGa||this.k1b(La)},Bb=>this.Scb(Bb,La))},n,O)}ydd(n){this.eGa<this.la.designerMaxRetryOnWait?this.Bb.Hb(new Y.a(2,1,1E3,()=>{K.a.J(40379155,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Ob.correlationId);this.Jka=Zk.ready;this.eGa++;n()},void 0,"RetryRequestOnWait")):K.a.J(40379157,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Ob.correlationId)}m2i(n,
O=null){O=O||{};this.la.gGc&&n===vd.newDocument&&(O[sb.a.BIi]="true");this.la.zDi&&(O[sb.a.Nfl]=this.LIg);this.Hq.Hqa()&&(this.la.nOa?(O[sb.a.sBh]=this.Iq.C1d(),O[sb.a.tBh]=!0):O[sb.a.vPf]=!0);this.Iq.LPc(n)&&(O[sb.a.Jkg]=!0);this.zy.IBj()&&(O[sb.a.xMd]=this.zy.xMd());O.NewPaneEnabled=!0;var ha=!Db.a.Xa(this.Ob.iV);(O.RequestForEditorCardsForNewIdeasPane=ha)&&(O.NumEditorCritiques=this.Iti());ha={};ha.SupportsImageToTableSuggestedAction=32===this.ia.processAction(Ab.a.qye,1);O.PPTOEnabledSuggestedActions=
Fe.c(ha);this.la.lxa&&n===vd.RGa&&(O[sb.a.idb]=this.la.idb,O[sb.a.jxe]=this.la.jxe,O[sb.a.ixe]=this.la.ixe);return O}Iti(){let n=0;for(const O of this.Ob.iV)for(const ha of O.critiques)n+=ha.suggestions.length;return n}pzj(n){if(void 0===n||null===n)return!0;switch(n){case Ab.a.Kza:case Ab.a.gnb:case Ab.a.xVa:case Ab.a.dBb:case Ab.a.eBb:case Ab.a.yVa:case Ab.a.gBb:case Ab.a.hBb:case Ab.a.fBb:case Ab.a.rcb:case Ab.a.VUf:return!0;case Ab.a.lGa:case Ab.a.reb:case Ab.a.Zic:case Nf.a.VQa:case Ab.a.bringForward:case Ab.a.bringToFront:case Ab.a.sendToBack:case Ab.a.sendBackward:return!this.Ob.xS;
default:return!1}}nyi(n,O=null){const ha=this.ua.Ca;return ha?Object.assign(new qi,{trigger:n,sid:ha.sid,cid:ha.cid,MP:this.m2i(n,O)}):null}RJj(n){return this.SJj(n)}SJj(n){if(!n||!n.sid||!this.Urg(n.trigger)&&!this.qo.isVisible)return!1;switch(n.trigger){case vd.oGa:case vd.tmc:case vd.kIb:case vd.insertPicture:case vd.knb:case vd.PQd:case vd.ONd:case vd.tva:case vd.fMe:case vd.aMe:case vd.insertTable:return!0;case vd.fQc:return this.la.awh;case vd.typing:return this.la.ZUf&&this.qo.isVisible;case vd.xeb:return this.la.designerRetriggerEnabled&&
this.Ob.xS;case vd.uLd:case vd.OUf:return this.la.designerDesignElementsRemovedEnabled;case vd.RGa:return this.la.lxa;case vd.KHd:case vd.kLd:case vd.wob:return this.la.triggerDesignerAfterApplyReplaceObject;case vd.refresh:return this.KJj(n.MP);case vd.moreIdeas:return this.la.sha;case vd.newDocument:return this.la.gGc&&this.la.rS;case vd.XGd:return this.la.iQe;default:return K.a.J(594399636,829,15,"invalid trigger: {0}",n.trigger),!1}}KJj(n){return sb.a.AIc in n&&n[sb.a.AIc]||sb.a.undoRedo in n&&
n[sb.a.undoRedo]||this.la.wDi&&this.zy.Hq.vp.isVisible?!0:!1}Urg(n){switch(n){case vd.tmc:case vd.kIb:case vd.insertPicture:case vd.fQc:case vd.aMe:case vd.uLd:case vd.knb:case vd.tva:case vd.newDocument:case vd.KHd:case vd.PQd:case vd.ONd:return!0;case vd.XGd:return this.la.iQe;case vd.RGa:return this.la.lxa;default:return!1}}ozj(n){if(!(this.la.designerSendActionDuration&&sb.a.wE in n.MP&&n.MP[sb.a.wE]))return!1;switch(n.trigger){case vd.tmc:case vd.kIb:case vd.fMe:case vd.newDocument:return!1;
case vd.refresh:return!(sb.a.AIc in n.MP)||!(sb.a.undoRedo in n.MP);default:return!0}}Ofd(n){const O=n===vd.typing?4:n===vd.moreIdeas?7:1;(this.zy.Hq.vp.isVisible||this.Urg(n))&&this.Hq.MXa(O)}GTd(n,O,ha=null){this.Ibb&&(this.Bb.ah(this.Ibb),this.Ibb=null);const Aa=this.nyi(O,ha);this.RJj(Aa)?this.Ob.yLj(this.ua.Ca.sid)?(this.Ofd(Aa.trigger),this.ydd(()=>{this.bIc(n,O,ha)})):(K.a.J(40379161,829,50,"trigger: {0}; sid: {1}; correlationId: {2}",Aa.trigger,Aa.sid,Aa.correlationId),this.Ob.correlationId&&
!this.Ob.jvb(this.Ob.correlationId)&&this.qFb(this.zy.Hq.vp.isVisible,Aa.trigger),this.Ob.jlc=new Date,this.Ob.correlationId=Aa.correlationId,this.Ob.uKd=Aa.trigger,this.Ob.nP=this.ozj(Aa)?Aa.MP[sb.a.wE]:new Date,n(Aa),this.Ofd(Aa.trigger),this.zy.sGa(Aa.correlationId,Yk.a.pending)):(K.a.J(40379163,829,50,"Designer call not currently allowed for trigger {0}",O),this.qo.Uo(!1,gf.a.dWf))}bIc(n,O,ha=null){if(this.la.designerAuthEnabled&&this.dL){this.Ofd(O);ha||(ha={});var Aa=new Date;this.dL.p0(this.la.pptDesignerImplicitAuthAppName,
this.la.designerResourceUri).then(La=>{const Bb=+new Date-+Aa;La.IsSuccess?(ha[sb.a.rOi]=Bb,ha[sb.a.oYk]=La.Token):(ha[sb.a.v1f]=Bb,K.a.J(42324814,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+La.ErrorCode+": "+La.ErrorMessage));this.GTd(n,O,ha)}).catch(La=>{K.a.J(42295842,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",La);ha[sb.a.v1f]=+new Date-+Aa;this.GTd(n,O,ha)})}else this.GTd(n,O,ha)}pRe(){if(this.la.gGc&&
this.la.rS)if(this.qc){var n=this.ua.presentation;if(!n)throw Error.argumentNull("Presentation is null");var O=this.qc.QH();if(!O||0>=O.length)K.a.J(592494817,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");else{var ha="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===O[0].ThemeFamilyId.toLowerCase();ha&&1!==O.length?K.a.J(588908107,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):this.la.hQe||ha?!n.slides||0>=
n.slides.length?K.a.J(592494819,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):ha&&1!==n.slides.length?K.a.J(588908103,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):(n=null,this.la.QXk&&this.la.rjd&&0<this.la.rjd.length&&(n={},n.TemplateId=this.la.rjd),K.a.J(41705686,829,50,"Triggering NewDocument designer request"),this.Cba(vd.newDocument,n)):K.a.J(592494815,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else K.a.J(592494849,
829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");else K.a.J(42766598,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",this.la.gGc,this.la.rS)}Eue(n,O){this.Ob.trl(O.PXb)}q8k(n){return!n||!this.qo.isVisible}cdj(){const n=document.querySelector("."+qe.kNa);return n&&(this.Iq.rrb(n,!1)||this.Iq.rrb(n,!0))?"Kept":"NotKept"}Z9f(n){const O=new C.a;if(n&&n.children)for(let ha=0;ha<n.children.length;ha++){const Aa=
n.children[ha].innerText;Aa&&0<Aa.length&&O.add(n.children[ha].innerText)}return O.toArray()}A7i(n){if(!n)return null;var O=n.ta(il.a.jdb,null);if(O)return O.replace("\r","\n").replace("\n\n","\n").split("\n");if(O=n.ta(il.a.sT,null))if(O=this.eW.YVa(O))return this.Z9f(O);if(O=n.ta(il.a.kxe,null))if(n=this.eW.YVa(O))return this.Z9f(n);return null}w9(){}u9(n){if(this.la.lxa&&n.actionId===Ab.a.d$c&&32===n.response){var O=this.ob.he();if(O&&1===O.length&&O[0].id&&(O=this.A7i(Object(M.a)(10,n.od)))&&
!(0>=O.length)){var ha={};ha[sb.a.Prk]=O;this.s2d(n.actionId,ha)}}}BDi(n){switch(n){case sb.a.dDh:return this.la.zIi;default:return!1}}rij(){this.qo.Uo(!0,gf.a.none);this.Cba(vd.ONd);this.Hq.MXa(3)}Vll(n){switch(n){case sb.a.dDh:this.Wll()}}Wll(){if(this.la.Muk)try{const n=u.a.instance.Oa("Common.ISystemInitiatedFeedback");n&&(K.a.J(579109450,829,50,"Floodgate survey for word to presentation triggered"),n.execute(O=>{O.logActivity("ConvertWordToPresentationActivity","PowerPointDesignerWordToPptSurveyEnabled")}))}catch(n){K.a.J(579109448,
829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",n)}}eik(){this.la.iQe&&(this.qo.isVisible||this.GDg||(this.qo.Uo(!0,gf.a.none),this.Cba(vd.XGd),this.Hq.MXa(3),K.a.J(559822157,829,50,"Auto opening designer pane for high confidence agenda")),this.GDg=!0)}static n1d(){const n=document.querySelector("."+qe.kNa);return n&&n.getAttribute(qe.Xnb)?n.getAttribute(qe.Xnb).toString():null}}Object(h.a)(Zj,"DesignerActor",null,[146]);var Ym=d(531),pn=d(682);class qn{constructor(n){this.bucketId=
n;this.critiques=[]}}Object(h.a)(qn,"BucketedEditorData",null,[]);class Un{constructor(n){this.uKd=this.correlationId=this.USa=this.mCg=null;this.$tb=this.SRa=this.xS=!1;this.gmc=this.qPe=null;this.Usg=!1;this.pNa=this.suggestions=this.zJb=this.KSb=this.nP=this.SMa=this.Fbc=this.Cea=this.jlc=null;this.JM=0;this.OMe=this.Xqe=this.s4c=this.WXf=this.fHc=this.gHc=!1;this.fee=[];this.npe=[];this.b7b=n;this.AY=N.a.empty;this.gTb=new C.a;this.oNa=new C.a;this.oqa=new C.a;this.KPc=new C.a;this.pda=new C.a;
this.lUb=1}s9j(){this.rXa(0,0)}r9j(){this.rXa(1,0)}dre(){this.rXa(2,4)}rXa(n,O){this.b7b&&this.b7b.execute(ha=>{const Aa=Object.assign(new pn.a,{cardId:Ym.a.gqh,actionType:n,actionEngagement:O});ha.S5c(Aa)})}cAf(n,O){this.jvb(n)||(Array.add(this.fee,n),K.a.J(22853508,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",n,this.fee.length));this.FEe(!O)}jvb(n){return Array.contains(this.fee,n)}C9j(n){Array.add(this.npe,n)}ZLk(n){Array.remove(this.npe,
n)}yLj(n){return Array.contains(this.npe,n)}get kNd(){return this.USa}Uqi(){if(this.USa)return!0;try{const n=u.a.instance.qb("PowerPointWebEditor.Proofing.IConsistencyCheckActor");if(n)return this.USa=n,!0}catch(n){K.a.J(42001674,829,15,"error resolving consistencyCheckActor. ex: {0}",n)}return!1}trl(n){if(n){var O=[],ha=new yd.a;for(const Aa of n.critiques){n=Aa.bucketId;let La=ha.ga(n);La||(La=new qn(n),ha.$(n,La),O.push(La));La.critiques.push(Aa)}this.mCg=O}}get iV(){return this.mCg}FEe(n){this.correlationId=
"";this.AY=N.a.empty;this.uKd="";this.$tb=this.SRa=this.xS=!1;this.gmc=null;this.Usg=!1;this.SMa=this.Fbc=this.Cea=this.jlc=null;this.gTb.clear();this.zJb=this.KSb=this.nP=null;this.lUb=1;this.oNa.clear();this.oqa.clear();this.KPc.clear();this.pda.clear();this.JM=0;this.OMe=this.gHc=this.fHc=this.s4c=this.Xqe=!1;n&&(this.suggestions=this.pNa=null)}}Object(h.a)(Un,"DesignerContext",null,[935]);class rn{constructor(){this.CardData=null;this.DocumentUpsellStatus=0;this.HasPaginationInfo=!1;this.SlideSuggestions=
null}}Object(h.a)(rn,"DesignerSuggestions",null,[]);var Ri;(function(n){n[n.init=0]="init";n[n.loading=1]="loading";n[n.noSuggestion=2]="noSuggestion";n[n.showSuggestion=3]="showSuggestion";n[n.refreshing=4]="refreshing";n[n.sameSlideCoauthNoSuggestion=5]="sameSlideCoauthNoSuggestion";n[n.makeItVisualDrillIn=6]="makeItVisualDrillIn";n[n.loadingMoreIdeas=7]="loadingMoreIdeas";n[n.moreIdeas=8]="moreIdeas";n[n.noSuggestionRibbon=9]="noSuggestionRibbon"})(Ri||(Ri={}));Object(h.b)("DesignerViewState",
Ri);class cp{constructor(){this.suggestions=[]}}Object(h.a)(cp,"SlideSuggestionNotificationData",null,[]);var Jl=d(272),Je=d(453);class Zm{constructor(n,O,ha){this.Xjb=this.Ap=!1;n&&(this.HSa=n,this.HSa.isFeatureEnabled("PowerPointDesigner",!1).then(Aa=>{(this.Ap=Aa)?K.a.J(591942685,829,50,"DesignerStateManager:: Designer is enabled"):(this.Xjb=this.HSa.isFreemiumUpsellEnabled(),this.isFreemiumUpsellEnabled?ha?K.a.J(591942691,829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):
K.a.J(591942689,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):K.a.J(591942687,829,50,"DesignerStateManager:: Upsell experience is disbaled"));return null}),this.K4j=this.HSa.Xdb("PowerPointDesigner",Object(r.a)(this,this.Mqb,"featureStateChangeCallback")),this.m3j=O)}Hqa(){return!this.isEnabled&&this.isFreemiumUpsellEnabled}dispose(){this.HSa&&(this.HSa.fEb("PowerPointDesigner",this.K4j),this.HSa=null)}get isEnabled(){return this.Ap}get isFreemiumUpsellEnabled(){return this.Xjb}launchUpsellExperience(n){this.HSa&&
this.HSa.launchUpsellExperience(n)}Mqb(n){n&&"PowerPointDesigner"===n.featureName&&(!this.isEnabled&&n.isEnabled&&this.m3j(),this.Ap=n.isEnabled)}}Object(h.a)(Zm,"DesignerStateManager",null,[]);class Ap{constructor(n,O,ha){this.B6j=n;this.TA=O;this.f6j=ha}toString(){return"SuggestionIndex:"+this.B6j+" SlideId:"+this.TA+" CreationId:"+this.f6j}}Object(h.a)(Ap,"LoggableSourceContext",null,[]);var to=d(1105),Vn=d(931),zi=d(530);class Ll{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze){this.s8b=!1;
this.Eqe=0;this.Zn=this.Qwb=null;this.va=new Hl.a;this.nE=!!v.AFrameworkApplication.Ba&&!!v.AFrameworkApplication.Ba.jb&&v.AFrameworkApplication.Ba.jb.NV;this.eNh=!!v.AFrameworkApplication.Ba&&!!v.AFrameworkApplication.Ba.jb&&v.AFrameworkApplication.Ba.jb.NV&&v.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesFocusV2IsEnabled");this.Rb=n;this.Qd=O;this.jd=ha;this.ju=Aa;this.ia=La;this.Ob=Bb;this.uD=Wb;this.Oc=uc;this.Ey=Vc;this.hc=bd;this.Ga=xd;this.la=xe;this.Xu=wf;this.wI=ng.Z1b;this.v3j=ResourceStrings.L_Designer;
this.SG=Ze;this.xb=document.createElement("div");this.xb.className=lb.a.uDi;this.xb.id=ng.Z1b;this.xb.style.position=Qc.a.Mwa;this.xb.setAttribute(ka.a.ff,ka.a.Nza);this.xb.setAttribute(ka.a.o6,lb.a.RQd);this.Sb=!1;this.aTa=vb.a.De();this.aTa.className="DesignerPaneLayoutRoot";this.xb.appendChild(this.aTa);n=v.AFrameworkApplication.fa.Ia("PPTFabricIconDiamondCssUrl");O=document.createElement("link");O.setAttribute("rel","stylesheet");O.setAttribute("type","text/css");O.setAttribute("href",n);this.xb.appendChild(O);
this.Rb.D2a(Object(r.a)(this,this.UW,"onSetOffline"))}dispose(){this.D1();this.xb.removeChild(this.aTa);this.Rb.qEb(Object(r.a)(this,this.UW,"onSetOffline"));K.a.J(22590850,829,50,"DesignerPane::Dispose")}initialize(){this.Zn=Ll.tAa(this.Qd);Sys.UI.DomElement.addCssClass(this.Zn,"DesignerPaneCloseButton");this.Zn.setAttribute(ka.a.ff,ka.a.St);this.aTa.appendChild(this.Zn);this.jd.pb(ma.a.click,this.Zn,Object(r.a)(this,this.fAa,"closePaneButtonClickHandler"));this.ju.addHandler(this.Zn,ma.a.Rf,Object(r.a)(this,
this.Qra,"inputKeyPressHandler"));this.Qwb=vb.a.De();this.Qwb.id=lb.a.RQd;this.Qwb.className=lb.a.RQd;this.Qwb.innerText=this.v3j;this.aTa.appendChild(this.Qwb);this.uD.o7(this.Y8f(),Rc.a.kj,this.xb,n=>{this.eNh&&n===this.Ga.Bc(Rc.a.rO)&&this.Zn?this.$z(!0):this.RW(!0)},()=>{this.RW(!1)});this.Oc.Bga(Object(r.a)(this,this.Wz,"onUnifiedAppStateChanged"));this.Oc.xB(Object(r.a)(this,this.z9,"onPodSessionRehydrated"));this.Ey.Hmb(Object(r.a)(this,this.z9,"onPodSessionRehydrated"));K.a.J(22590852,829,
50,"DesignerPane::Initialize")}Y8f(){return Rc.a.J6}D1(){this.jd&&0<this.aTa.childNodes.length&&(this.jd.zb(ma.a.click,this.Zn,Object(r.a)(this,this.fAa,"closePaneButtonClickHandler")),this.ju.removeHandler(this.Zn,ma.a.Rf,Object(r.a)(this,this.Qra,"inputKeyPressHandler")),this.aTa.removeChild(this.Qwb),this.aTa.removeChild(this.Zn));this.Oc.tEb(Object(r.a)(this,this.Wz,"onUnifiedAppStateChanged"));this.Oc.cea(Object(r.a)(this,this.z9,"onPodSessionRehydrated"));this.Ey.ieb(Object(r.a)(this,this.z9,
"onPodSessionRehydrated"));this.Ga.ye&&this.Ga.ye.name===Rc.a.J6&&this.Ga.Kj(Rc.a.J6,!1)}Wz(n,O){O.X7a&&!this.hc.An&&this.isVisible&&(K.a.J(24760967,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",this.Ob.correlationId),this.Uo(!1,gf.a.tHb))}UW(n){n&&this.isVisible&&this.Uo(!1,gf.a.tHb)}z9(){K.a.J(37861251,801,50,"Designer Pane is closed because session is rehydrated.");this.Uo(!1,gf.a.yYk)}layout(n,O){const ha=O?n.CF(this.width):
n.DF(this.width);this.isVisible&&(O?(Sys.UI.DomElement.addCssClass(this.xb,lb.a.YUf),ha.CF(lb.a.QQd)):(Sys.UI.DomElement.addCssClass(this.xb,lb.a.XUf),ha.DF(lb.a.QQd)));vb.a.b0(this.xb,ha);return n}Uo(n,O){if(this.Sb!==n){this.Sb=n;var ha=this.la.UUf||this.id!==ng.Z1b?sb.a.qpk:ng.zrj;n?(O={},O[ha]=!0,this.Xu.Nid(Fe.c(O)),this.initialize(),this.xb.style.display=Qc.a.Lwa,this.Ob.s9j(),K.a.J(22590854,829,50,"DesignerPane::SetIsVisible - Set to visible")):(n={},n[ha]=!1,this.Xu.Nid(Fe.c(n)),this.D1(),
this.xb.style.display=Qc.a.og,this.gbl(O)||(this.Ob.gmc=new Date,1===this.Eqe&&(this.Ob.$tb=!0),this.ia.Ma(Ab.a.qma,2,new zi.a(!0,O))),this.Ob.r9j(),K.a.J(22590856,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.nE?(this.Pyc(this.xb),ha=ResourceStrings.L_Designer,this.SG.ML(this,this.Sb,this.id===ng.Z1b?ha:ResourceStrings.L_ShowHideDesignerPane,this.Y8f())):this.Rb.Mq()}}Pyc(n){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(n,lb.a.YUf):Sys.UI.DomElement.addCssClass(n,
lb.a.XUf)}gbl(n){return n===gf.a.wNf||this.isVisible&&n===gf.a.tHb}RW(n){n?this.va.raiseEvent("OnDesignerPaneFocusOn"):this.va.raiseEvent("OnDesignerPaneFocusBlur")}eCf(n){this.va.addHandler("OnDesignerPaneFocusOn",n)}Qbh(n){this.va.removeHandler("OnDesignerPaneFocusOn",n)}fCf(n){this.va.addHandler("OnDesignerPaneFocusBlur",n)}Rbh(n){this.va.removeHandler("OnDesignerPaneFocusBlur",n)}Qra(n){!this.isVisible||n.keyCode!==ra.a.Xp&&n.keyCode!==ra.a.wO||this.Uo(!1,gf.a.typing)}fAa(){this.isVisible&&(K.a.J(22853525,
829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Ob.correlationId),this.Uo(!1,gf.a.tHb));return!0}$z(n){(this.s8b=n)&&this.Zn.focus()}get s$(){return this.Eqe}set s$(n){this.Eqe=n}mfb(n){this.setFocus("#"+this.id+" ."+ic.jSg+":nth-child("+n+") > ."+ic.PAb)}h_k(){this.setFocus("#"+ic.G4a)}g_k(){this.setFocus("#"+ic.fqb)}vfd(n){this.setFocus("."+ic.DOa+"["+ng.COa+'="'+n+'"')}e_k(){this.setFocus("."+ic.MXb)}f_k(){this.setFocus("."+ic.QXb)}setFocus(n){(n=
document.querySelector(n))&&fc.FocusManager.xr(n)}get isVisible(){return this.Sb}get jRa(){return this.s8b}get za(){return this.xb}get order(){return 7}get id(){return this.wI}get width(){let n=0;this.isVisible&&(n=lb.a.vDi,n+=lb.a.QQd+Nb.a.iXa);return n}static tAa(n){return Ll.sAa(n,"per","cui-img-16by16","cui-ctl-iconContainer","ClosePaneGlyph_16x16x32",CommonUIStrings.l_DialogClose,null)}static sAa(n,O,ha,Aa,La,Bb,Wb){const uc=vb.a.FB();uc.alt=Bb;uc.className=Fa.getImageClassWithCluster(O,La);
uc.src=n.rk(O+".png");uc.setAttribute("Unselectable","on");n=vb.a.tn();n.className=ha+" cui-img-cont-float";n.appendChild(uc);ha=vb.a.tn();ha.className=Aa;ha.setAttribute("Unselectable","on");ha.appendChild(n);Aa=vb.a.Raa();Aa.className="cui-ctl DesignerPaneButton";Aa.title=Bb;Aa.setAttribute(ka.a.ff,ka.a.St);Aa.tabIndex=0;Aa.appendChild(ha);Wb&&(Bb=vb.a.tn(),Bb.className="cui-ctl-mediumlabel",Bb.setAttribute("Unselectable","on"),Bb.innerText=Wb,Aa.appendChild(Bb));return Aa}}Object(h.a)(Ll,"DesignerPane",
null,[931,454,109]);class Wl{constructor(n,O,ha,Aa,La,Bb){this.F3c=this.w6b=this.Eyb=this.Yn=null;this.Mje=this.q3b=!1;this.wpe=null;this.la=O;this.ia=n;this.n3j=Bb;this.jd=Aa;this.ju=La;this.lEg=jb.KeyInputManager.La(ra.a.rJb,0);this.ia.ya(Ab.a.rBh,H.a.frame,Object(r.a)(this,this.wmi,"closeCallout"));this.HS=vb.a.De();this.HS.className="GoPremiumCalloutContainer";this.H9a=Ll.tAa(ha);Sys.UI.DomElement.addCssClass(this.H9a,"GoPremiumCalloutClose");this.H9a.setAttribute(ka.a.ff,ka.a.St);this.HS.appendChild(this.H9a);
n=document.createElement("i");n.className=qe.IBc;n.setAttribute(ka.a.ff,ka.a.eP);n.setAttribute("Unselectable","on");n.setAttribute(ka.a.XJ,ka.a.yB);this.HS.appendChild(n);this.yua=vb.a.De();this.yua.className="GoPremiumTitle";this.HS.appendChild(this.yua);this.JS=vb.a.De();this.JS.className="GoPremiumSubtitle";this.HS.appendChild(this.JS);this.Wja=vb.a.De();this.Wja.className="GoPremiumButton";n=vb.a.tn();n.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;n.setAttribute("Unselectable","on");
n.setAttribute(ka.a.XJ,ka.a.yB);this.Wja.appendChild(n);this.Wja.tabIndex=0;this.Wja.setAttribute(ka.a.ht,n.innerText);this.Wja.setAttribute(ka.a.ff,ka.a.St);this.HS.appendChild(this.Wja);this.Ox()}show(n,O,ha,Aa,La,Bb){this.yK&&this.dismiss();this.Eyb=Aa;this.w6b=O;this.F3c=La;this.wpe=Bb;this.Eyb&&Sys.UI.DomElement.addCssClass(this.Eyb,this.F3c);ha?(this.yua.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.JS.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):(this.yua.innerText=
ResourceStrings.l_DesignerUpsellCalloutTitle,this.JS.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);O.setAttribute(ka.a.nnb,ka.a.yB);this.la.CYf?this.Yn=new Vn.a(n,document.body,v.AFrameworkApplication.Ba.RQ,null):(this.Yn=to.a.LOd(n,document.body,document.body,2,Object(r.a)(this,this.dismiss,"dismiss")),this.Yn.rPe=120);this.Yn.t$=310;this.HS.setAttribute(ka.a.ht,String.format("{0}. {1}",this.yua.innerText,this.JS.innerText));this.HS.setAttribute(ka.a.ff,ka.a.Nza);this.ju&&this.ju.addHandler(this.HS,
ma.a.Rf,Object(r.a)(this,this.Qra,"inputKeyPressHandler"));this.Yn.content=this.HS;this.lpa();O=new Sys.UI.Bounds(0,0,qa.a.JNc(),qa.a.INc());this.Yn.DY=this.uXd(O,n,240,ha);this.Yn.Zq=!1;this.Yn.g8c=()=>{this.HS.parentNode&&Sys.UI.DomElement.addCssClass(this.HS.parentNode,"GoPremiumCalloutContentContainer");this.Yn.NI&&(Sys.UI.DomElement.addCssClass(this.Yn.NI,"GoPremiumCalloutOuter"),this.Yn.NI.removeAttribute(ka.a.ff),this.la.CYf||(this.Yn.NI.style.zIndex=String(v.AFrameworkApplication.Ba.omb)));
this.Yn.EIe();this.KQ(this.Wja);this.q3b=!0};this.Yn.show()}lpa(){if(fc.FocusManager.ZL()){var n=fc.FocusManager.instance(),O=n.Bc("callout/modal");O.parent=Rc.a.kj;n.BFd("callout/modal",Rc.a.kj,this.HS);n.hX("callout/modal",!1);O.bindAction(this.lEg,Ab.a.rBh);O=new Yb.DOMFocusListing(()=>this.HS);O.aeb=!0;O.ho(2);n=n.Sga(()=>this.HS,n.Bc("callout/modal"),O);n.beb();n.CS=!0;n.GNa=!0}}feb(){if(fc.FocusManager.ZL()&&!v.AFrameworkApplication.Xg){const O=fc.FocusManager.instance();var n=O.Bc("callout/modal");
n&&n.Wo(this.lEg);O.n4("callout/modal");(n=O.AP("callout/modal"))&&n.gj.aE(null);O.kEb("callout/modal")}}KQ(n){fc.FocusManager.ZL()?fc.FocusManager.instance().AP("callout/modal").gj.w5a(n):n.focus()}get yK(){return!!this.Yn&&this.Yn.yK}pnj(){this.yK&&(this.q3b?this.H9a.focus():this.Wja.focus(),this.q3b=!this.q3b)}oWf(){this.dismiss();return!0}wmi(){this.dismiss();return 32}dismiss(){if(!this.Mje){this.Mje=!0;try{this.feb(),this.w6b&&(this.w6b.setAttribute(ka.a.nnb,ka.a.Bpa),fc.FocusManager.xr(this.w6b),
this.w6b=null),this.Eyb&&(Sys.UI.DomElement.removeCssClass(this.Eyb,this.F3c),this.Eyb=null),this.wpe=this.F3c=null,this.q3b=!1,this.Yn&&(this.Yn.dismiss(),this.Yn.dispose(),this.Yn=null),this.ju&&this.ju.removeHandler(this.HS,ma.a.Rf,Object(r.a)(this,this.Qra,"inputKeyPressHandler"))}finally{this.Mje=!1}}}dispose(){this.dismiss();this.ina();this.HS=this.H9a=this.Wja=null}Qra(n){if(n.keyCode===ra.a.Xp||n.keyCode===ra.a.wO){n.preventDefault();n=document.activeElement;try{n?n.click():K.a.J(590967751,
829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(O){K.a.J(590967749,829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",O)}}}IXg(){this.n3j(this.wpe);return!0}Ox(){this.jd?(this.jd.pb(ma.a.click,this.H9a,Object(r.a)(this,this.oWf,"dismissAndReturn")),this.jd.pb(ma.a.click,this.Wja,Object(r.a)(this,this.IXg,"onGoPremiumClicked"))):K.a.J(594031904,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")}ina(){this.jd&&
(this.jd.zb(ma.a.click,this.H9a,Object(r.a)(this,this.oWf,"dismissAndReturn")),this.jd.zb(ma.a.click,this.Wja,Object(r.a)(this,this.IXg,"onGoPremiumClicked")))}uXd(n,O,ha,Aa){if(Aa)return 0;Aa=6;O.y-n.y<ha&&(Aa=3);return Aa}}Object(h.a)(Wl,"PremiumContentCallout",null,[]);class Bg{constructor(n,O,ha,Aa,La,Bb,Wb,uc){this.Lpb=n;this.bMi=O;this.iIc=ha;this.Oh=Aa;this.Bea=La;this.l5a=Bb;this.NLe=Wb;this.fmd=uc}}Object(h.a)(Bg,"RenderSuggestionsArgs",null,[1256]);class Ko extends Sys.EventArgs{constructor(n){super();
this.card=n}}Object(h.a)(Ko,"ClickSuggestedActionEventArgs",Sys.EventArgs,[]);class xk extends Sys.EventArgs{constructor(n){super();this.HUc=n}}Object(h.a)(xk,"DesignerClickMoreIdesEventArgs",Sys.EventArgs,[]);class Kk extends Sys.EventArgs{constructor(n,O){super();this.KWk=n;this.Kfl=O}}Object(h.a)(Kk,"DesignerClickSuggestionEventArgs",Sys.EventArgs,[]);class yl extends Jl.a{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze){super(new Je.a,n,Bb);this.W9a=this.X9a=this.NK=this.MZ=this.a7b=this.jW=
null;this.RFg=this.TFg=0;this.aka=!1;this.ePg=this.cFa=this.czb=null;this.qo=ha;this.Iq=Aa;this.Ob=La;this.Ga=Wb;this.jd=uc;this.Qd=O;this.So=Vc;this.ju=bd;this.ia=xd;this.Ue=xe;this.la=wf;this.IBh=this.la.useWideSuggestionThumbs;this.mQ=new gb.a(()=>new Wl(this.ia,this.la,O,uc,bd,Object(r.a)(this,this.mfg,"goPremiumExperience")));this.IDg=new Zm(Ze,Object(r.a)(this,this.nek,"onAccountUpgrade"),wf.nOa);this.j3=new de;this.Q_j=Object.assign(new xm(xd,this.j3,this.la),{BA:Ab.a.F7a})}dispose(){this.aka&&
this.qMf();this.czb&&(this.czb.dispose(),this.czb=null);this.mQ.j7a&&this.mQ.value.dispose();super.dispose();K.a.J(22590858,829,50,"DesignerView::Dispose")}aQc(){this.jW=vb.a.De();this.jW.className="DesignerViewContainer";this.container.appendChild(this.jW);this.aka=!0;K.a.J(22590860,829,50,"DesignerView::InitializeView")}qMf(){this.la.rHc&&this.Iq.Iki();if(this.jW.children&&0<this.jW.children.length)for(const n=0;n<this.jW.children.length;)this.jW.removeChild(this.jW.children[n]);this.qo.s$=0;this.qo.Qbh(Object(r.a)(this,
this.onFocus,"onFocus"));this.qo.Rbh(Object(r.a)(this,this.yXg,"onFocusBlur"));this.mQ.j7a&&this.mQ.value.dismiss();K.a.J(22590862,829,50,"DesignerView::CleanUpView")}MXa(n){K.a.J(592536862,829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",this.Ob.correlationId,Ri[n]);this.DM();4!==n&&7!==n&&8!==n&&(this.qMf(),this.jW.id=this.Ob.correlationId);this.qo.s$=n;switch(this.qo.s$){case 1:this.Rtj();this.G3k();break;case 7:this.F3k();break;case 2:this.Ytj();break;case 9:this.Xtj();break;
case 5:this.iuj();break;case 3:this.ouj();break;case 6:this.Stj();break;case 4:if(n=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(let O=0;O<n.length;O++)n[O].style.visibility=bc.a.visible,n[O].setAttribute(qe.rKd,qe.vJf)}this.qo.eCf(Object(r.a)(this,this.onFocus,"onFocus"));this.qo.fCf(Object(r.a)(this,this.yXg,"onFocusBlur"))}Hqa(){return this.la.aVf&&this.IDg.Hqa()}mfg(n){this.la.aVf&&(K.a.J(592970129,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",n?n.toString():
""),this.mQ.j7a&&this.mQ.value.dismiss(),this.IDg.launchUpsellExperience(this.la.nOa?"designertrial":"designer"))}startFreeTrial(){this.mQ.j7a&&this.mQ.value.dismiss();this.Iq.sll();this.Ob.OMe=!0;this.fw(0,!0);K.a.J(592761816,829,50,"DesignerView::StartFreeTrial Free Trial started")}nek(){K.a.J(592970127,829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");this.mQ.j7a&&this.mQ.value.dismiss();this.Iq.Ypl()}Rtj(){this.a7b=vb.a.De();this.a7b.className="DesignerLoadingView";const n=vb.a.FB();
n.className=v.AFrameworkApplication.isRtl?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";n.src=Lg.a.bK(lb.a.Xla);const O=vb.a.De();O.className=v.AFrameworkApplication.isRtl?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";O.innerText=ResourceStrings.L_DesignerLoading;this.a7b.appendChild(n);K.a.J(38340425,829,50,"DesignerView::spinner shows up");this.a7b.appendChild(O);this.jW.appendChild(this.a7b);K.a.J(22590866,829,50,"DesignerView::InitLoadingState")}Ztj(){const n=vb.a.De();
n.className="DesignerNoSuggestionNewButton";n.tabIndex=0;n.innerText=ResourceStrings.L_DesignerLearnMoreShort;n.setAttribute("Unselectable","on");n.setAttribute(ka.a.ht,n.innerText);n.setAttribute(ka.a.ff,ka.a.St);n.setAttribute("href",lb.a.WUf);this.jd.pb(ma.a.click,n,Object(r.a)(this,this.eNf,"clickSuggestionLinkHandler"));this.MZ.appendChild(n)}Wtj(){const n=vb.a.Raa();n.className="DesignerNoSuggestionView-Link";n.setAttribute("href",lb.a.WUf);n.setAttribute("target","_blank");n.innerText=ResourceStrings.L_DesignerLearnMore;
n.tabIndex=0;n.setAttribute(ka.a.ff,ka.a.vId);this.MZ.appendChild(n);this.jd.pb(ma.a.click,n,Object(r.a)(this,this.eNf,"clickSuggestionLinkHandler"))}Ytj(){this.qo.isVisible&&(this.m5d(!1),this.X9a.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,this.W9a.innerText=ResourceStrings.L_DesignerNoSuggestionContent,K.a.J(22590868,829,50,"DesignerView::InitNoSuggestionState"))}Xtj(){this.qo.isVisible&&(this.m5d(!0),this.X9a.innerText=ResourceStrings.L_DesignerNoIdeasHeader,this.W9a.innerText=ResourceStrings.L_DesignerNoIdeas,
K.a.J(588851201,829,50,"DesignerView::InitNoSuggestionState"))}iuj(){this.qo.isVisible&&(this.m5d(!1),this.X9a.innerText=ResourceStrings.L_DesignerCoauthorHeader,this.W9a.innerText=ResourceStrings.L_DesignerCoauthorContent,K.a.J(41725981,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"))}m5d(n){this.MZ=vb.a.De();this.MZ.className=v.AFrameworkApplication.isRtl?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";this.X9a=vb.a.De();this.W9a=vb.a.De();this.Iq.wch(this.jW);if(n){this.X9a.className=
"DesignerNoSuggestionNew-Header";this.W9a.className="DesignerNoSuggestionNew-Content";const O=vb.a.FB();O.src=this.Qd.rk("DesignerNoIdeas.svg");O.className="DesignerNoIdeasIllustration";this.MZ.appendChild(O)}else this.X9a.className="DesignerNoSuggestionView-Header",this.W9a.className="DesignerNoSuggestionView-Content";this.MZ.appendChild(this.X9a);this.MZ.appendChild(this.W9a);n?this.Ztj():this.Wtj();this.jW.appendChild(this.MZ);this.ju.addHandler(this.MZ,ma.a.Rf,Object(r.a)(this,this.Qra,"inputKeyPressHandler"))}ouj(){this.qo.isVisible||
this.qo.Uo(!0,gf.a.none);this.NK=vb.a.De();const n=this.IBh?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",O=this.IBh?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";this.NK.className=v.AFrameworkApplication.isRtl?O:n;this.jW.appendChild(this.NK);this.la.ZUf||(this.Ga.Kj(Rc.a.J6,!0),this.Ga.Bd());this.jd.pb(ma.a.click,this.NK,Object(r.a)(this,this.Xli,"clickSuggestionHandler"));this.ju.addHandler(this.NK,ma.a.Rf,Object(r.a)(this,this.cQc,"inputKeyApplyHandler"));this.So.pb(ma.a.pointerOver,
this.NK,Object(r.a)(this,this.iC,"onPointerOver"));this.So.pb(ma.a.pointerOut,this.NK,Object(r.a)(this,this.Oy,"onPointerOut"));K.a.J(22590870,829,50,"DesignerView::InitShowSuggestionState")}D$i(){return this.n0b(this.NK.querySelector("#"+this.vp.id+" .DesignerSuggestionResultSelected"))}q2i(){return this.n0b(this.NK.querySelector("#"+this.vp.id+" ["+qe.$nb+"]:hover"))}n0b(n){let O;return({suggestionIndex:O}=this.xdg(n)).returnValue?parseInt(O):-1}xdg(n){let O,ha,Aa;Aa=ha=O="";if(n){const La=n.getAttribute(qe.Vza),
Bb=n.getAttribute(qe.$nb);if(!La||!Bb)return K.a.J(41694980,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",this.Ob.correlationId),{returnValue:!1,suggestionIndex:O,slideId:ha,dMe:Aa};O=La.toString();ha=Bb.toString();(n=n.getAttribute(qe.qKd))?Aa=n.toString():K.a.J(594071841,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",this.Ob.correlationId);return{returnValue:!0,
suggestionIndex:O,slideId:ha,dMe:Aa}}return{returnValue:!1,suggestionIndex:O,slideId:ha,dMe:Aa}}o0b(){return this.NK.querySelectorAll("#"+this.vp.id+" ["+qe.Vza+"]").length}eNf(n){return this.qo.isVisible&&n&&n.AB?this.xfg(n.AB.className):!1}dia(){const n=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",O=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return this.container.querySelector("."+(v.AFrameworkApplication.isRtl?
O:n))}Wli(n){n=n.getAttribute(qe.Vza).toString();n=this.Ob.pNa[parseInt(n)];if(!n||3!==n.Type&&4!==n.Type)return!1;this.Ue.KBk(new Ko(n));return!0}WIc(n,O){for(;n&&n.className!==O;)n=n.parentNode;return n}Xli(n){if(!this.qo.isVisible||n.Sz!==Sys.UI.MouseButton.leftButton||!this.Iq.Ca||!n.Hc)return!1;var O=n.Hc;try{if(O.className){if(O.className===ic.PAb||O.className===ic.QAb||O.className===ic.Gre||O.className===ic.Z4c)return this.Vli(O);if(O.className.startsWith(ic.cYf))return this.Uli(O)}else K.a.J(591151563,
829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(xd){return K.a.J(591151561,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",O.className,xd.message),!1}if(n=this.WIc(O,qe.EJf))return this.Wli(n);if(this.Hqa()){if(O.className===qe.Ynb)return this.startFreeTrial(),!0;if(O.className===qe.ZTb)return n=pc.a.ei(O),this.mQ.value.show(n,O,!0,O,"DesignerInFreeTrialViewGoPremiumTextSelected",null),!0;(n=this.WIc(O,qe.YTb))||(n=this.WIc(O,qe.CBc));if(n)return this.mfg(null),
!0}if(this.la.sha&&(n=this.WIc(O,qe.lKd))){this.Iq.cPc(this.dia());if(!n.getAttribute(qe.Xnb))return!1;this.Iq.C$k(this.dia());n=new xk(n.getAttribute(qe.Xnb).toString());this.Ue.WBk(n);return!0}if(Sys.UI.DomElement.containsCssClass(O,"ms-Icon--Diamond")){if(O=O.parentNode,!O)return!1}else if(!(Sys.UI.DomElement.containsCssClass(O,qe.KBc)||Sys.UI.DomElement.containsCssClass(O,qe.$Tb)||Sys.UI.DomElement.containsCssClass(O,qe.LBc)||(O=O.firstChild,O)))return!1;n=O.parentNode;var ha=document.querySelector("#"+
this.vp.id+" ."+qe.kNa);if(!({suggestionIndex:uc,slideId:Vc,dMe:bd}=this.xdg(n)).returnValue)return!1;var Aa=parseInt(uc),La=parseInt(Vc);const Bb=parseInt(bd)||0;let Wb=this.Ob.AY.sid===La;this.la.sha&&(Wb=this.Iq.rrb(ha,!1)===n||this.Iq.rrb(ha,!0)===n);if(Wb)return K.a.J(25203038,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),this.Ue.v8g(new Kk(Aa,this.o0b())),!1;if(n&&n.getAttribute(qe.FBc)){O=null;ha=n.childNodes;for(Aa=0;Aa<ha.length;Aa++)if(La=ha[Aa],Sys.UI.DomElement.containsCssClass(La,
qe.KBc)){O=La;break}ha=new Ap(uc,Vc,bd);O=pc.a.ei(O||n);this.mQ.value.show(O,n,!1,null,null,ha);return!1}if(Sys.UI.DomElement.containsCssClass(O,qe.LBc))return!1;var uc=this.g$i(O,La,Bb);var Vc=Object.assign(new Yj,{SuggestionCid:Bb,SuggestionSid:La,CorrelationId:ha.getAttribute("correlationId").toString(),ActiveSlideCid:this.Iq.Ca.cid,ActiveSlideSid:this.Iq.Ca.sid});var bd=O;bd=.01>=Math.abs(bd.width/bd.height-1.33);this.Iq.rrb(ha,bd)?(this.Iq.pMf(ha,bd),uc&&uc.parentNode&&uc.parentNode.parentNode&&
this.Iq.pMf(uc.parentNode.parentNode,bd),this.ia.Ma(Ab.a.gnb,2,Vc),K.a.J(22590872,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):(this.ia.Ma(Ab.a.Kza,2,Vc),K.a.J(22590874,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));this.la.rDi&&n&&n.getAttribute(qe.fKd)&&u.a.instance.Oa("Common.ISystemInitiatedFeedback").execute(xd=>{try{xd.logActivity("DesignerAnimationSuggestion",null)}catch(xe){K.a.J(573346252,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",
xe)}});this.Iq.Kih(O.parentNode,bd);uc&&this.Iq.Kih(uc.parentNode,bd);this.Iq.dhh(this.jW,Aa);this.Ue.v8g(new Kk(Aa,this.o0b()));return!0}g$i(n,O,ha){var Aa="["+qe.$nb+'="'+O+'"] > .'+qe.$Tb;ha&&(Aa=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',qe.$nb,O,qe.qKd,ha,qe.$Tb));O=document.querySelectorAll(Aa);if(!O)return null;for(ha=0;ha<O.length;ha++)if(Aa=O[ha],Aa!==n)return Aa;return null}Qra(n){this.qo.isVisible&&(n.keyCode!==ra.a.Xp&&n.keyCode!==ra.a.wO||this.xfg(n.target.className))}cQc(n){!this.qo.isVisible||
n.keyCode!==ra.a.Xp&&n.keyCode!==ra.a.wO||(n.preventDefault(),(n=document.activeElement)&&n.click())}fw(n,O){if(!(0>n)){var ha=this.NK.querySelector("["+qe.Vza+'="'+n+'"]');ha?O&&(fc.FocusManager.xr(ha),this.Iq.dhh(this.jW,n)):K.a.J(22590880,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",n)}}Deg(){return this.Hqa()?this.NK.querySelector("."+qe.ZTb)?2:this.NK.querySelector("."+qe.Ynb)?1:this.NK.querySelector("."+qe.YTb)?3:0:0}kwg(){return!!this.NK.querySelector("."+qe.Ynb+
":focus")}Bjc(n){const O=this.NK.querySelector("."+qe.Ynb);O?n?fc.FocusManager.xr(O):O.blur():K.a.J(592524129,829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}xhg(){this.jxg()&&this.mQ.value.pnj()}jxg(){return this.mQ.j7a&&this.mQ.value.yK}nNj(n){return n?!!n&&(n.className===qe.Ynb||n.className===qe.CBc||n.className===qe.ZTb||n.className===qe.YTb):!1}Ima(n,O){let ha=null;1===O?ha=this.NK.querySelector("."+qe.CBc):2===O?ha=this.NK.querySelector("."+qe.ZTb):3===O&&
(ha=this.NK.querySelector("."+qe.YTb));ha?n?fc.FocusManager.xr(ha):ha.blur():K.a.J(592524127,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",O)}h3k(n,O){(O=9===O?this.MZ.querySelector(".DesignerNoSuggestionNewButton"):this.MZ.querySelector(".DesignerNoSuggestionView-Link"))?n?O.focus():O.blur():K.a.J(588851159,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}NLj(n){return!(9===n?!this.MZ.querySelector(".DesignerNoSuggestionNewButton:focus"):
!this.MZ.querySelector(".DesignerNoSuggestionView-Link:focus"))}xfg(n){try{const O=this.MZ.querySelector("."+n);if(!O)return!1;const ha=O.getAttribute("href").toString();if(!ha)return!1;pc.a.openWindow(4,ha);return!0}catch(O){return K.a.J(41711770,829,10,"DesignerView:GoToSuggestionLink exception: {0}",O),!1}}yXg(){this.qo.isVisible&&this.mQ.j7a&&this.mQ.value.yK&&this.mQ.value.dismiss()}onFocus(){if(this.qo.isVisible)if(2===this.qo.s$)fc.FocusManager.xr(this.MZ.lastChild);else if(3===this.qo.s$){var n=
this.Deg();if(1===n)this.Bjc(!0);else if(3===n)this.Ima(!0,n);else{n=this.D$i();var O=this.q2i();-1===n?this.fw(-1===O?0:O,!0):this.fw(n,!0)}}}iC(n){return this.qo.isVisible&&n.Hc?this.bYf(n.clientPoint):!1}Oy(n){return this.qo.isVisible&&n.Hc?this.bYf(n.clientPoint):!1}tjj(n){this.DM();this.MXa(2);K.a.J(22590912,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",n);this.qo.isVisible&&(this.Ob.SRa=!0,this.ia.Ma(Ab.a.qma,2,new zi.a(!1,gf.a.zid)))}G3k(){const n=this.Ob.correlationId;
this.TFg=window.setTimeout(()=>{this.tjj(n)},this.la.SQd)}sjj(n){this.DM();this.Iq.cPc(this.dia());K.a.J(593494240,829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",n)}F3k(){const n=this.Ob.correlationId;this.RFg=window.setTimeout(()=>{this.sjj(n)},this.la.SQd)}DM(){window.clearTimeout(this.TFg);window.clearTimeout(this.RFg)}get vp(){return this.qo}Stj(){this.NK.style.display=bc.a.none;this.Ob.Xqe=!0;this.cFa=vb.a.De();this.cFa.className=ic.Hak;const n=this.xRf(ic.Ire),O=document.createElement("iframe");
O.className=O.id=ic.lSg;const ha=this.xRf(ic.Hre);this.cFa.appendChild(n);this.cFa.appendChild(O);this.cFa.appendChild(ha);this.jW.appendChild(this.cFa);const Aa=this.Ga.Bc(Rc.a.xPc);Aa.parent=ua.AFrame.VC;this.jd.Tyc(Rc.a.xPc,O);Aa.xaa(()=>{O.focus();const La=Object.assign(new Yb.DOMFocusListing(()=>this.cFa),{aeb:!0});La.ho(3);La.ho(2);La.ho(4);La.ho(1);La.ho(6);La.ho(5);fc.FocusManager.instance().QJd(this.cFa,Aa,La);const Bb=fc.FocusManager.instance().AP(Rc.a.xPc);Bb.beb();Bb.CS=!0;Bb.GNa=!0;Aa.Wo(fc.FocusManager.instance().Roa);
Aa.Wo(fc.FocusManager.instance().Soa);La.aE(O)});this.Ga.vf(Rc.a.xPc);this.ju.addHandler(this.cFa,ma.a.Rf,Object(r.a)(this,this.xz,"keyDownHandler"))}xRf(n){const O=document.createElement("div");O.setAttribute("Id",n);O.setAttribute("tabindex",0);O.setAttribute("position","absolute");O.setAttribute("width","-1000px");O.setAttribute("top","-1000px");return O}xz(n){n.keyCode===Sys.UI.Key.tab&&(n.target.id!==ic.Hre||n.shiftKey?n.target.id===ic.Ire&&n.shiftKey&&this.Zjh(n,ic.Hre):this.Zjh(n,ic.Ire))}Zjh(n,
O){n.preventDefault();n.stopPropagation();(n=document.getElementById(O))&&n.focus()}Vli(n){switch(n.className){case ic.Z4c:return this.vp.mfb(1),!0;case ic.PAb:n=n.querySelector("."+ic.QAb).innerText;break;case ic.QAb:n=n.innerText;break;case ic.Gre:n=n.parentNode.querySelector("."+ic.QAb).innerText;break;default:return!1}return this.XOk(n)}XOk(n){this.la.sha&&(this.ePg=this.dia().querySelector("."+qe.kNa).getAttribute("correlationId").toString());this.MXa(6);var O=ib.a.BM(this.la.pptEditingUserId).toString();
O=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,hl.a.re(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,Ad.a.create().toString(),3,O,0);O=O.replace(RegExp("&amp;","g"),"&").replace(RegExp("&p=3"),"&p=6")+"&q="+n;n=document.getElementById(ic.lSg);n.setAttribute("src",O);n.style.visibility=bc.a.visible;this.czb=(new gm).getInstance(n.contentWindow,O);this.czb.Jva(Xf.a.FAf,ha=>{if(ha=this.j3.l2g(ha)){const Aa=[];Array.add(Aa,ha);this.ia.processAction(Ab.a.lhd,
2);this.vp.Uo(!1,gf.a.wNf);this.Q_j.Rra(Aa)}});this.czb.Jva(ng.aK,()=>{this.MXa(3);const ha=new Bg(this.Ob.suggestions,this.Ob.suggestions?this.Ob.suggestions.SlideSuggestions.length:0,this.Ob.pNa.length,this.la.sha?this.ePg:this.Ob.correlationId,this.dia(),!0,this.Hqa(),this.Iq.LPc(vd.makeItVisual));this.Iq.RDe(ha)});return!0}Uli(n){return Sys.UI.DomElement.containsCssClass(n,ic.hqb)||Sys.UI.DomElement.containsCssClass(n,ic.gqb)?this.Xij(n):Sys.UI.DomElement.containsCssClass(n,ic.DOa)||Sys.UI.DomElement.containsCssClass(n,
ic.hHc)||Sys.UI.DomElement.containsCssClass(n,ic.gYf)||Sys.UI.DomElement.containsCssClass(n,ic.fYf)?this.Yij(n):Sys.UI.DomElement.containsCssClass(n,ic.MXb)?this.Djj():Sys.UI.DomElement.containsCssClass(n,ic.QXb)?this.Jkj():!1}Jkj(){this.ia.processAction(Ab.a.sye,2);this.vp.Uo(!1,gf.a.Dnk);return this.Ob.WXf=!0}bYf(n){const O=this.Ob.kNd;if(!O||Db.a.Xa(this.Ob.iV))return!1;n=pc.a.EPa(n);this.dDj(n)?O.kPc(this.D7f()):O.kPc([]);return!0}dDj(n){for(;n&&n.className!==ic.xSd;)n=n.parentNode;return!!n&&
n.className===ic.xSd}Djj(){const n=this.Ob.kNd;if(!n)return!1;n.ignoreCritiques(this.D7f(),4);this.Ob.iV.splice(this.Ob.JM,1);if(this.Ob.JM===this.Ob.iV.length){let O;(O=this.Ob).JM=O.JM-1}this.pHk();return!0}D7f(){const n=[];for(const O of this.Ob.iV[this.Ob.JM].critiques)n.push(O.critiqueId);return n}Xij(n){if(Sys.UI.DomElement.containsCssClass(n,ic.hqb)){let O;(O=this.Ob).JM=O.JM-1;this.Ob.JM||(Sys.UI.DomElement.removeCssClass(n,ic.hqb),Sys.UI.DomElement.addCssClass(n,ic.OXb));n=document.getElementById(ic.fqb);
Sys.UI.DomElement.removeCssClass(n,ic.NXb);Sys.UI.DomElement.addCssClass(n,ic.gqb)}else{let O;(O=this.Ob).JM=O.JM+1;this.Ob.JM===this.Ob.iV.length-1&&(Sys.UI.DomElement.removeCssClass(n,ic.gqb),Sys.UI.DomElement.addCssClass(n,ic.NXb));n=document.getElementById(ic.G4a);Sys.UI.DomElement.removeCssClass(n,ic.OXb);Sys.UI.DomElement.addCssClass(n,ic.hqb)}document.getElementById(ic.wSd).innerText=(this.Ob.JM+1).toString();this.Ezh(this.Ob.JM);return!0}Ezh(n){var O=this.Ob.iV[n].critiques[0].explanationLabel;
document.getElementById(ic.eYf).innerText=O;O=document.getElementById(ic.hYf);const ha=qe.aRf();O.parentNode.replaceChild(ha,O);this.Iq.chg(ha,n)}Yij(n){const O=this.Ob.kNd;if(Db.a.Xa(this.Ob.iV)||!O)return!1;n=n.getAttribute(ng.COa);var ha=document.querySelector("."+ic.hHc+"["+ng.COa+'="'+n+'"]');ha&&(ha.innerText="\u2713",Sys.UI.DomElement.removeCssClass(ha,ic.hHc),Sys.UI.DomElement.addCssClass(ha,ic.gIi));ha=new yd.a(0);for(const Aa of this.Ob.iV[this.Ob.JM].critiques)ha.add(Aa.critiqueId,n);O.Yth(ha);
return this.Ob.fHc=!0}pHk(){var n=document.getElementById(ic.UXf);let O=parseInt(n.innerText);O--;if(0>=O)this.J$k(document.getElementById(ic.VXf));else{n.innerText=O.toString();this.Ezh(this.Ob.JM);n=this.Ob.JM===this.Ob.iV.length-1;const ha=document.getElementById(ic.fqb);1<O&&!n?(Sys.UI.DomElement.addCssClass(ha,ic.gqb),Sys.UI.DomElement.removeCssClass(ha,ic.NXb)):(Sys.UI.DomElement.addCssClass(ha,ic.NXb),Sys.UI.DomElement.removeCssClass(ha,ic.gqb));n&&(document.getElementById(ic.wSd).innerText=
O.toString());n=document.getElementById(ic.G4a);1<O&&this.Ob.JM?(Sys.UI.DomElement.addCssClass(n,ic.hqb),Sys.UI.DomElement.removeCssClass(n,ic.OXb)):(Sys.UI.DomElement.addCssClass(n,ic.OXb),Sys.UI.DomElement.removeCssClass(n,ic.hqb))}}J$k(n){const O=vb.a.De();O.className=ic.bIi;const ha=new ie.a;ha.Bh(40,40);ha.pwa("0,0,2048,2048");ha.gt(ic.hIi);var Aa=new Xm.a;Aa.$_("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
const La=new Xm.a;La.$_("M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");La.za.setAttribute("class",ic.kIi);const Bb=
new Xm.a;Bb.$_("M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
Bb.za.setAttribute("class",ic.$Hi);const Wb=new Xm.a;Wb.$_("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
Wb.za.setAttribute("class",ic.ZHi);ha.appendChild(Aa);ha.appendChild(La);ha.appendChild(Bb);ha.appendChild(Wb);Aa=vb.a.tn();Aa.innerText=ResourceStrings.l_ConsistencyCardNoMore;Aa.className=ic.cIi;O.appendChild(ha.za);O.appendChild(Aa);n.parentNode.replaceChild(O,n)}}yl.XHi=[ic.G4a,ic.fqb,ic.DOa,ic.MXb,ic.QXb];Object(h.a)(yl,"DesignerView",Jl.a,[930,177,169,109]);var Wn=d(206);class zl extends Sys.EventArgs{constructor(n,O){super();this.slideId=n.slideId;this.xsh=n.hlc;this.a0f=n.h$;this.l5a=O;this.trigger=
n.trigger;this.correlationId=n.correlationId}}Object(h.a)(zl,"RenderSuggestionsEventArgs",Sys.EventArgs,[]);class xj{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe){this.MGg=new Pi.a;this.Hq=n;this.Iq=O;this.Ob=ha;this.la=Aa;this.ia=La;this.ua=Bb;this.Jb=Wb;this.Xc=uc;this.Ga=Vc;this.C6b=this.mee=0;this.xTa=bd;this.gXj=xd;this.tua=xe;this.Ox()}Ox(){this.Xc.t2h(Object(r.a)(this,this.I_g,"onSuggestionsUpdated"));this.Xc.s2h(Object(r.a)(this,this.oWg,"onCoauthModifiedSameSlide"));this.gXj.execute(n=>
{n.Q_h(Object(r.a)(this,this.Qlk,"onShowMoreSuggestions"),()=>{this.FFb(this.Hq,3)})});this.la.designerIncrementalRenderEnabled&&this.Xc.r3h(Object(r.a)(this,this.k0g,"onUserBeginUploadPicture"));this.Xc.Izc(Object(r.a)(this,this.Kla,"onUndoRedo"))}dispose(){this.Xc.aNk(Object(r.a)(this,this.I_g,"onSuggestionsUpdated"));this.Xc.$Mk(Object(r.a)(this,this.oWg,"onCoauthModifiedSameSlide"));this.la.designerIncrementalRenderEnabled&&this.Xc.JNk(Object(r.a)(this,this.k0g,"onUserBeginUploadPicture"));this.Xc.Dcd(Object(r.a)(this,
this.Kla,"onUndoRedo"))}JXk(n){this.ia.Ma(Ab.a.qma,2,new zi.a(!1,n))}FFb(n,O){n?n.MXa(O):K.a.J(592536911,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",this.Ob.correlationId,O)}mnj(n){const O=this.bEi(n);if(O){var ha=O.vp;K.a.J(22590808,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",n,Ri[ha.s$]);switch(ha.s$){case 3:this.Kbk(n,O);break;case 2:case 9:this.Jbk(n,O,ha.s$)}}}bEi(n){switch(n){case Ab.a.xVa:case Ab.a.dBb:case Ab.a.eBb:case Ab.a.yVa:case Ab.a.gBb:case Ab.a.hBb:case Ab.a.fBb:case Ab.a.rcb:n=
this.Hq;break;default:return null}return n}Kbk(n,O){if(O&&O.vp){var ha=document.activeElement;if(ha){var Aa=ha.getAttribute(qe.Vza),La=O.nNj(ha),Bb=Sys.UI.DomElement.containsCssClass(ha,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(ha,"IdeasText"),Wb=this.kSg(ha)||this.XXf(ha),uc=O.jxg();if(Aa||Bb||Wb||La||uc)if(Aa=Aa?parseInt(Aa.toString()):-1,La=O.o0b()-1,!(1>La))switch(Bb=O.vp,Wb=O.Deg(),n){case Ab.a.xVa:if(uc||1===Wb||3===Wb)break;Bb.$z(!1);Aa<La&&(O.fw(Aa,!1),O.fw(Aa+1,!0));
break;case Ab.a.dBb:if(uc||1===Wb||3===Wb)break;Bb.$z(!1);Aa!==La&&(O.fw(Aa,!1),O.fw(La,!0));break;case Ab.a.eBb:if(uc){O.xhg();break}this.Bkj(O,Aa,La,Wb);break;case Ab.a.yVa:if(uc||1===Wb||3===Wb)break;Bb.$z(!1);0<Aa&&(O.fw(Aa,!1),O.fw(Aa-1,!0));break;case Ab.a.gBb:if(uc||1===Wb||3===Wb)break;Bb.$z(!1);Aa&&(O.fw(Aa,!1),O.fw(0,!0));break;case Ab.a.hBb:if(uc){O.xhg();break}this.Ckj(O,Aa,La,Wb);break;case Ab.a.fBb:case Ab.a.rcb:uc||1===Wb||3===Wb||(n=n===Ab.a.rcb,O=O.vp,this.kSg(ha)?this.Ekj(n,O):this.XXf(ha)&&
this.Dkj(n,O))}}}}Bkj(n,O,ha,Aa){const La=n.vp;if(-1===O){switch(Aa){case 1:La.jRa?(La.$z(!1),n.Bjc(!0)):n.kwg()?(n.Bjc(!1),n.Ima(!0,Aa)):(n.Ima(!1,Aa),La.$z(!0));return;case 2:La.jRa?(La.$z(!1),n.fw(0,!0)):(n.Ima(!1,Aa),La.$z(!0));return;case 3:O=La.jRa;La.$z(!O);n.Ima(O,Aa);return}La.$z(!1);n.fw(0,!0)}else O===ha?(n.fw(O,!1),2===Aa?n.Ima(!0,Aa):La.$z(!0)):(n.fw(O,!1),n.fw(O+1,!0))}Ckj(n,O,ha,Aa){const La=n.vp;if(0<O)n.fw(O,!1),n.fw(O-1,!0);else if(-1===O){switch(Aa){case 1:La.jRa?(La.$z(!1),n.Ima(!0,
Aa)):n.kwg()?(n.Bjc(!1),La.$z(!0)):(n.Ima(!1,Aa),n.Bjc(!0));return;case 2:La.jRa?(La.$z(!1),n.Ima(!0,Aa)):(n.Ima(!1,Aa),n.fw(ha,!0));return;case 3:O=La.jRa;La.$z(!O);n.Ima(O,Aa);return}La.jRa&&(La.$z(!1),n.fw(ha,!0))}else n.fw(0,!1),La.$z(!0)}Jbk(n,O,ha){if(O){var Aa=O.vp;if(n===Ab.a.eBb||n===Ab.a.hBb||n===Ab.a.yVa||n===Ab.a.xVa)n=O.NLj(ha),Aa.$z(n),O.h3k(!n,ha)}}kSg(n){return Sys.UI.DomElement.containsCssClass(n,ic.Z4c)||Sys.UI.DomElement.containsCssClass(n,ic.PAb)}XXf(n){return n.className.startsWith(ic.cYf)}Ekj(n,
O){var ha=document.activeElement;ha&&(Sys.UI.DomElement.containsCssClass(ha,ic.PAb)?(ha=parseInt(ha.getAttribute(ic.mSg).toString())+1,n?ha!==ng.rbc?O.mfb(ha+1):O.mfb(1):1!==ha?O.mfb(ha-1):O.mfb(ng.rbc)):n?O.mfb(1):O.mfb(ng.rbc))}Dkj(n,O){var ha=document.activeElement;if(ha){for(var Aa=yl.XHi,La=0;!Sys.UI.DomElement.containsCssClass(ha,Aa[La]);)if(La++,La===Aa.length){La=-1;break}var Bb=document.querySelectorAll("."+ic.DOa).length;Aa[La]!==ic.DOa?n?La!==Aa.length-1&&-1!==La?Aa[La+1]!==ic.DOa?this.Nsb(Aa[La+
1],O):O.vfd(0):this.Nsb(Aa[0],O):La&&-1!==La?Aa[La-1]!==ic.DOa?this.Nsb(Aa[La-1],O):O.vfd(Bb-1):this.Nsb(Aa[Aa.length-1],O):(ha=parseInt(ha.getAttribute(ng.COa).toString()),n?ha!==Bb-1?O.vfd(ha+1):this.Nsb(Aa[La+1],O):ha?O.vfd(ha-1):this.Nsb(Aa[La-1],O))}}Nsb(n,O){switch(n){case ic.G4a:O.h_k();break;case ic.fqb:O.g_k();break;case ic.MXb:O.e_k();break;case ic.QXb:O.f_k()}}m1b(n,O){if(this.la.uRc&&this.Hq.vp.isVisible){if(O&&(n===Ab.a.Kza||n===Ab.a.gnb)){this.Ob.AY=N.a.empty;O=this.ua.presentation;
const ha=this.Jb.xd(7,void 0,void 0,void 0,!0);try{ha.lc(O),this.la.CDi&&(ha.fd=n),O.removeProperty(dc.a.KAa)}finally{ha&&ha.dispose()}}this.Iq.Zol(this.Hq.dia());this.la.xDi&&n!==Ab.a.Kza&&n!==Ab.a.gnb&&this.ia.processAction(Ab.a.$Uf,2)}}Kla(n,O){this.m1b(O.BRe,O.S8a)}GBj(n){return this.Ob.jvb(n)}dxg(n){switch(n){case Nf.a.LId:case Nf.a.OId:case Nf.a.rTb:case Nf.a.NId:case Nf.a.PId:case Nf.a.QId:case Nf.a.tTb:case Nf.a.RId:case Nf.a.SId:case Nf.a.TId:case Nf.a.UId:case Nf.a.WId:case Nf.a.YId:case Nf.a.backspace:case Nf.a.Rza:case Nf.a.dK:case Nf.a.jOa:case Nf.a.enter:case Nf.a.WA:case Nf.a.typing:return!0;
default:return!1}}isEnabled(){return this.la.uRc}IBj(){return 0<this.C6b}xMd(){return this.C6b}oWg(n,O){n=O.slideId;K.a.J(23089489,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",n.sid);if((O=this.ua.Ca)&&O.Cb.equals(n)){O="unopened";this.Hq.vp.isVisible&&(this.Hq.vp.isVisible&&this.FFb(this.Hq,5),O="set to SameSlideCoauthNoSuggestion UI");let ha="unopened";this.Hq.vp.isVisible&&(this.sGa(this.Ob.correlationId,Yk.a.rGa),ha="closed");"unopened"===O&&"unopened"===
ha||K.a.J(23089491,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",O,ha,n.sid,n.cid,this.Ob.correlationId,this.mee,this.C6b)}}I_g(n,O){K.a.J(22647391,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.la.uRc,this.mee,
this.C6b,O.correlationId,O.trigger);if(this.isEnabled()){if(n=this.ua.Ca)if(O.slideId.equals(n.Cb))if(this.GBj(O.correlationId))K.a.J(22618318,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",O.correlationId);else if(this.vvl(O.correlationId))K.a.J(41694935,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",O.correlationId);
else{this.Ob.correlationId!==O.correlationId&&(this.Ob.cAf(O.correlationId,this.la.sha&&O.trigger===vd.moreIdeas),K.a.J(42021664,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Ob.correlationId,O.correlationId));if(this.Ob.correlationId===O.correlationId&&this.Hq.vp.isVisible&&3===this.Hq.vp.s$)if(this.la.designerIncrementalRenderEnabled&&Db.a.any(O.hlc.toArray(),ha=>0<=this.Ob.pda.indexOf(ha)))this.Ob.Fbc=
new Date,K.a.J(42342610,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",O.correlationId,O.hlc.toString(),this.Ob.pda.toString());else if(n=O.AIa,!this.la.designerIncrementalRenderEnabled||this.Ob.oqa.contains(n)){K.a.J(22618320,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",O.correlationId,n.toString());
return}n=qe.NQd(O.SAa);this.SUk(n,O);this.onj(O);this.nnj(this.Hq,O,n,O.h$,Db.a.Xa(this.Ob.pNa)?O.h$:this.Ob.pNa.length)}else K.a.J(22618322,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",O.correlationId)}else K.a.J(22618316,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",O.correlationId)}SUk(n,O){if(n&&O.trigger!==vd.moreIdeas){this.Ob.suggestions||(this.Ob.suggestions=Object.assign(new rn,
{CardData:n.CardData,SlideSuggestions:Array(O.X4d?O.h$:O.sYa)}));if(!Db.a.Xa(n.SlideSuggestions))for(const ha of n.SlideSuggestions)this.Ob.suggestions.SlideSuggestions[ha.Index]=ha;this.Ob.pNa||(this.Ob.pNa=qe.rqk(n))}}nnj(n,O,ha,Aa,La){K.a.J(592536898,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",O.correlationId,O.trigger,O.h$,Aa);if(O.trigger===vd.moreIdeas)this.Ob.Cea||(this.Ob.Cea=new Date),Aa=n.o0b(),this.Iq.YOk(ha,n.dia(),O.correlationId,
n.Hqa())||(this.Iq.cPc(n.dia()),Aa=n.o0b()-1),n.fw(Aa,!0),this.FFb(n,8);else if(!Aa)!this.la.designerNewNoIdeasUxEnabled||O.trigger!==vd.tmc&&O.trigger!==vd.kIb?this.FFb(n,2):this.FFb(n,9),this.Hq.vp.isVisible?this.sGa(this.Ob.correlationId,Yk.a.rGa):this.JXk(gf.a.noSuggestion);else if(this.W7k(O.trigger,n.vp)){var Bb=!0;if(this.la.designerIncrementalRenderEnabled){Bb=null;var Wb=n.dia();Wb&&(Bb=Wb.querySelector("#"+n.vp.id+" ."+qe.kNa+'[correlationId="'+O.correlationId+'"]'));Bb=!Bb;K.a.J(592306817,
829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",O.correlationId,O.trigger,Bb);Wb=new zl(O,Bb);this.Xc.hDk(Wb)}if(Bb){this.FFb(n,3);this.Ob.Cea||(this.Ob.Cea=new Date);try{this.la.Avk&&this.tua.execute(uc=>{uc.logActivity("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(uc){K.a.J(42050709,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",uc)}}n=new Bg(ha,Aa,La,O.correlationId,n.dia(),
Bb,n.Hqa(),this.Iq.LPc(O.trigger));this.Iq.RDe(n)}}onj(n){n.X4d?(Db.a.Xa(this.Ob.suggestions.SlideSuggestions)||this.Ob.suggestions.SlideSuggestions.length===n.h$)&&this.sGa(n.correlationId,Yk.a.success,this.Ob.suggestions,n.trigger):this.sGa(n.correlationId,Yk.a.success,this.Ob.suggestions,n.trigger)}W7k(n,O){return O.isVisible||n!==vd.oGa&&n!==vd.kLd&&n!==vd.wob}Hhd(n,O){this.C6b=n;this.mee=O;this.Xc.ND(new Wn.a(1))}k0g(){this.Hq.vp.isVisible&&3===this.Hq.vp.s$&&(this.MGg.add(this.Ob.correlationId),
this.Hq.MXa(1))}vvl(n){return this.MGg.contains(n)}sGa(n,O,ha=null,Aa=""){K.a.J(593236889,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",n,O,Aa);this.xTa.execute(La=>{const Bb=this.Tsi(n,ha);ib.a.Xa(Aa)||(Bb.trigger=Aa);La.notifySlideSuggestion(O,Bb)})}Tsi(n,O){const ha=new cp;ha.correlationId=n;if(!O)return K.a.J(39977434,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",n),ha;ha.suggestions=
this.Iq.Wqk(O);return ha}Qlk(n){n=new Bg(this.Ob.suggestions,n.suggestions.length,n.suggestions.length,n.correlationId,this.Hq.dia(),!0,this.Hq.Hqa(),this.Iq.LPc(n.trigger));this.Iq.RDe(n);this.Ga.Kj(Rc.a.J6,!0)}rpk(){return 4===this.Hq.vp.s$}opk(){return 1===this.Hq.vp.s$}}Object(h.a)(xj,"DesignerManager",null,[933,109]);class $k{constructor(n,O){this.Rab=this.Np=null;this.m6j=O;this.we=n;this.Sq=!1}get wh(){return this.Sq}setup(){this.wh||(this.Rab=vb.a.De(),this.Rab.setAttribute("Unselectable",
"on"),this.Rab.style.position=bc.a.absolute,this.we.addCssClass(this.Rab,"designerPreviewImageContainer"),this.Np=new Cc.a,this.Sq=!0)}dispose(){this.wh&&(this.dismiss(),this.Np&&this.Np.za.parentNode&&(this.Np.aq(),this.we.removeCssClass(this.Np.za,"designerPreviewImageContainer")))}dismiss(){this.wh?(this.gma(),this.Np.setVisibility(!1)):K.a.J(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")}aIa(n){if(this.wh){this.Rab&&(this.Rab.appendChild(this.Np.za),this.we.addCssClass(this.Np.za,
"designerPreviewImageContainer"),this.Np.setVisibility(!1));var O=this.m6j.Mc;if(n=this.Zpa(n))this.gma(),O.Dhd.appendChild(this.Rab),this.Np.za.appendChild(n),this.Np.setVisibility(!0);this.Np.Bh(O.qC.clientWidth,O.qC.clientHeight)}else K.a.J(38099037,829,15,"DesignerPreviewImageView::SetImage - called before setup")}Zpa(n){if(!ib.a.Xa(n)){const O=vb.a.FB();O.setAttribute("Unselectable","on");O.src=n;O.style.height="100%";O.style.width="100%";return O}return null}gma(){this.Np.za.firstChild&&this.Np.za.removeChild(this.Np.za.firstChild)}}
Object(h.a)($k,"DesignerPreviewImageView",null,[934]);var yj=d(153);class En{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe){this.hL=null;this.eGa=0;this.ia=n;this.Jb=O;this.ob=ha;this.ua=Aa;this.Pb=La;this.la=Bb;this.Yh=Wb;this.hj=uc;this.Zb=Vc;this.k8=bd;this.Bb=xd;this.Wd=xe;this.Jka=Zk.ready}wb(){this.ia.ra(Ab.a.fixIt,yb.a.application,Object(r.a)(this,this.ljj,"handleFixIt"),4);this.ia.ra(Ab.a.W6g,yb.a.application,Object(r.a)(this,this.Elj,"handleQueryFixIt"),96);this.ia.ra(Ab.a.hnb,yb.a.application,
Object(r.a)(this,this.hnb,"applyFixItSuggestion"),4);this.ia.ra(Ab.a.NWa,yb.a.application,Object(r.a)(this,this.NWa,"reportFixItSessionInfo"),64);this.k8.wSb(Object(r.a)(this,this.zda,"onBlockingStateChanged"))}dispose(){this.k8.wcd(Object(r.a)(this,this.zda,"onBlockingStateChanged"))}ljj(n,O,ha){O=this.ob.he();if(2>O.length)return 8;if(1===ha)return 32;ha=this.ua.presentation;this.la.designerBlockApplyUntilDraw?this.Zb.Hpa(ha,this.ua.Ca,this.Pb.Na,n):this.Zb.xw(ha,n);this.hj.jRc=!0;const Aa=[];O.forEach(La=>
{Array.add(Aa,La.get_shapeId())});n={};n.SelectedShapeIds=Aa.join(",");this.hj.Gfb=Aa;this.y2d(n);this.hj.Vgb=window.setTimeout(()=>{this.mjj(this.hj.correlationId)},this.la.e3f);return 32}mjj(n){this.hj.SRa=!0;K.a.J(573961115,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",n);this.ia.Ma(Ab.a.NWa,2,gf.a.zid);this.Wd.tqa(Sa.a.Fh(170),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}y2d(n=null,O=null){this.GLi(ha=>{if(this.la.designerRequestThrottlingEnabled){if(this.Jka.vvg&&
+new Date-+this.Jka.syg<this.la.designerRequestThrottleIntervalMs){this.hL=new xl;this.hL.sid=ha.sid;this.hL.cid=ha.cid;this.hL.mPc=ha.MP;return}this.Jka=Zk.inProgress;this.hL=null}const Aa=()=>{this.y2d(this.hL.mPc,O)};this.Yh.Oha(ha.cid,ha.sid,ha.correlationId,null,sb.a.fixIt,O,Fe.c(ha.MP),La=>{La&&La.Status===sb.a.Udh?this.ydd(()=>{this.y2d(ha.MP,O)}):this.eGa=0;this.eGa||this.k1b(Aa)},La=>this.Scb(La,Aa))},n)}ydd(n){this.eGa<this.la.designerMaxRetryOnWait?this.Bb.Hb(new Y.a(2,1,1E3,()=>{K.a.J(578937822,
829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.hj.correlationId);this.Jka=Zk.ready;this.eGa++;n()},void 0,"RetryRequestOnWait")):K.a.J(578937820,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.hj.correlationId)}hnb(n,O,ha,Aa,La){O=this.ua.presentation;if(!this.ua.Ca||!O)return 16;Aa=null;Object(Qj.a)(Yj,La)&&(Aa=La);if(!Aa)return 8;if(1===ha)return 32;ha=this.Jb.ie(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&
(this.hj.SMa=new Date),ha.lc(O),ha.fd=n,O.KAa=Aa,this.hj.AY=N.a.XD(Aa.SuggestionSid,Aa.SuggestionCid),this.hj.xS=!0,K.a.J(578937818,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Aa.CorrelationId,n,Aa.SuggestionSid)}finally{ha&&ha.dispose()}return 32}GLi(n,O=null){const ha=this.ua.Ca;ha&&ha.sid&&(O=Object.assign(new qi,{sid:ha.sid,cid:ha.cid,MP:O||{}}),K.a.J(578937816,829,50,"FixIt; sid: {0}; correlationId: {1}",O.sid,O.correlationId),this.hj.correlationId&&
this.qFb(gf.a.xeb),this.hj.rYa=new Date,this.hj.correlationId=O.correlationId,this.hj.nP=new Date,n(O))}k1b(n){this.la.designerRequestThrottlingEnabled&&(this.Jka=Zk.ready,this.hL&&n())}Scb(n,O){this.k1b(O);K.a.J(578937814,829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",n.HttpStatusCode);return!0}Elj(n,O,ha,Aa,La){this.Ill();if(!Object(Qj.a)(Jk.a,La))return 8;if(1<this.ob.Hed()){let Bb;(Bb=this.hj).Wnb=Bb.Wnb+1;return 32}return 8}NWa(n,O,ha,Aa,
La){if(La===gf.a.noSuggestion||La===gf.a.zid)this.la.designerBlockApplyUntilDraw?this.Zb.Tmc(yj.e(this.ua.Ca,this.Pb.Na)):this.Zb.mJ(this.ua.presentation);this.qFb(La);return 32}zda(n,O){if(this.hj.jRc){n=this.Zb.gd(this.ua.presentation);const ha=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";n||Object(M.a)(String,O.actionName)!==ha||(window.clearTimeout(this.hj.Vgb),this.hj.SRa||(this.hj.qYa=new Date),this.hj.SMa=null,this.hj.jRc=!1)}}qFb(n){const O=this.hj.correlationId;
if(ib.a.Xa(O))K.a.J(578937812,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",n);else{var ha={};this.hj.AY&&(ha.SuggestionSlideId=this.hj.AY.sid.toString(),ha.SuggestionSlideCreationId=this.hj.AY.cid.toString());ha.AppliedSuggestion=this.hj.xS;ha.DisplaySuggestionsTimeoutInMs=this.la.e3f;ha.SuggestionsTimeout=this.hj.SRa;ha.ClientAbort=this.hj.$tb;ha.ResetReason=n;ha.DesignerSendTraceRequestOnSessionEnded=this.la.TQd;var Aa=ef.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
La={};La.ClientOS=Aa.Os;La.Browser=Aa.Browser||"";La.BrowserVersion=Aa.BrowserVersion||"";La.BrowserMajorVersion=Aa.BrowserMajorVersion||"";La.BrowserMinorVersion=Aa.BrowserMinorVersion||"";this.hj.rYa&&this.hj.uHb&&this.hj.uHb>this.hj.rYa&&(La.SuggestionsE2ETimeMs=+this.hj.uHb-+this.hj.rYa);this.hj.rYa&&this.hj.qYa&&this.hj.qYa>this.hj.rYa&&(La.SuggestionAppliedE2ETimeMs=+this.hj.qYa-+this.hj.rYa);ha.BrowserData=La;this.hj.nP&&this.hj.qYa&&this.hj.qYa>this.hj.nP&&(ha.TimeToDisplaySuggestionsInMs=
+this.hj.qYa-+this.hj.nP);this.hj.pPe&&(ha.TimeSuggestionsRendered=this.hj.pPe.toUTCString());this.Yh.qma(O,Fe.c(ha),n===gf.a.$ed);this.hj.FEe();K.a.J(578937810,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",n,O)}}Ill(){try{const n=u.a.instance.Oa("Common.ISystemInitiatedFeedback");n&&n.execute(O=>{O.logActivity("AutoFixInViewportActivity",null)})}catch(n){K.a.J(573649484,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",
n)}}w9(){}u9(){}}Object(h.a)(En,"FixItActor",null,[146]);class Al{constructor(){this.Wnb=0;this.correlationId=this.Gfb=null;this.Vgb=0;this.$tb=this.jRc=this.xS=this.SRa=!1;this.suggestion=this.nP=this.qYa=this.SMa=this.uHb=this.rYa=this.pPe=null;this.AY=N.a.empty}FEe(){this.Wnb=0;this.correlationId=this.Gfb=null;this.AY=N.a.empty;this.Vgb=0;this.$tb=this.jRc=this.xS=this.SRa=!1;this.nP=this.qYa=this.SMa=this.uHb=this.rYa=this.pPe=null}}Object(h.a)(Al,"FixItContext",null,[938]);var Cg=d(926),Xn=d(938),
Bp=d(831),Fn=d(893);class Gn{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd){this.ia=n;this.ua=O;this.Jb=ha;this.Xc=Aa;this.hj=La;this.yh=Bb;this.oAb=Wb;this.rI=uc;this.Oc=Vc;this.Wd=bd;this.Ox()}Ox(){this.oAb.vSb(Object(r.a)(this,this.MI,"onEvent"));this.yh.xM(Object(r.a)(this,this.MI,"onEvent"));this.Oc.F2a(Object(r.a)(this,this.MI,"onEvent"));this.Oc.xB(Object(r.a)(this,this.MI,"onEvent"));this.Xc.D2h(Object(r.a)(this,this.H_g,"onSuggestionReceived"));this.Xc.Izc(Object(r.a)(this,this.Kla,"onUndoRedo"))}dispose(){this.Xc.iNk(Object(r.a)(this,
this.H_g,"onSuggestionReceived"));this.Xc.Dcd(Object(r.a)(this,this.Kla,"onUndoRedo"))}H_g(n,O){if(n=this.ua.Ca)if(O.slideId.equals(n.Cb))if(this.hj.correlationId!==O.correlationId)K.a.J(578937806,829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.hj.correlationId,O.correlationId);else if(n=Gn.NQd(O.SAa),n.SlideSuggestion)this.hj.uHb||(this.hj.uHb=new Date),O=Object.assign(new Yj,{SuggestionCid:n.SlideSuggestion.SlideId.Cid,
SuggestionSid:n.SlideSuggestion.SlideId.Sid,CorrelationId:O.correlationId,ActiveSlideCid:Object(M.a)(132,this.ua.Ca).cid,ActiveSlideSid:Object(M.a)(132,this.ua.Ca).sid}),this.ia.Ma(Ab.a.hnb,2,O);else switch(this.ia.Ma(Ab.a.NWa,2,gf.a.noSuggestion),n.ResponseDescription){case "Invalid request":this.Wd.tqa(Sa.a.Fh(122),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest);break;case "No suggestion":this.Wd.tqa(Sa.a.Fh(132),0,ResourceStrings.errorTitle_PowerpointEditingStandard,
ResourceStrings.errorMessage_FixItNoSuggestion);break;default:this.Wd.tqa(Sa.a.Fh(134),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}else K.a.J(578937808,829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",O.correlationId)}HP(n){this.hj.correlationId&&n!==Ab.a.hnb&&this.ia.Ma(Ab.a.NWa,2,gf.a.CJb+this.rI.x4(n))}m1b(n,O,ha){if(this.hj.correlationId&&ha&&O===Ab.a.hnb){this.hj.AY=
N.a.empty;ha=this.ua.presentation;const Aa=this.Jb.xd(7,void 0,void 0,void 0,!0);try{Aa.lc(ha),Aa.fd=O,ha.removeProperty(dc.a.KAa)}finally{Aa&&Aa.dispose()}this.ia.Ma(Ab.a.NWa,2,gf.a.CJb+this.rI.x4(n))}}Kla(n,O){this.m1b(O.actionId,O.BRe,O.S8a)}MI(n,O){n=!1;let ha="";if(Object(Qj.a)(Cg.a,O)){K.a.J(578937802,829,50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",this.hj.correlationId,wk.a[Object(M.a)(Cg.a,O).aJ]);if(1===Object(M.a)(Cg.a,O).aJ||3===Object(M.a)(Cg.a,O).aJ)n=!0;ha=gf.a.$ed}else Object(Qj.a)(Xn.a,
O)?(K.a.J(578937800,829,50,"FixItManager::OnSessionRehydrated"),n=!0,ha=gf.a.jKk):Object(Qj.a)(Bp.a,O)?(n=!0,ha=gf.a.slideNavigation):Object(Qj.a)(Fn.a,O)&&Object(M.a)(Fn.a,O).xub&&this.HP(Object(M.a)(Fn.a,O).actionId);n&&this.hj.correlationId&&this.ia.Ma(Ab.a.NWa,2,ha);this.rVj()}rVj(){0<this.hj.Wnb&&(K.a.J(574166159,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",this.hj.Wnb),this.hj.Wnb=0)}static NQd(n){let O=null;try{O=ef.a(n)}catch(ha){K.a.J(578937804,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}return O}}
Object(h.a)(Gn,"FixItManager",null,[937,109]);var kl=d(988),ik=d(15),yk;(function(n){n[n.seen=0]="seen";n[n.keep=1]="keep";n[n.drillIn=2]="drillIn"})(yk||(yk={}));Object(h.b)("IdeasCardAction",yk);var Yn;(function(n){n[n.designer=0]="designer";n[n.makeItVisual=1]="makeItVisual";n[n.editor=2]="editor";n[n.UNKNOWN=3]="UNKNOWN"})(Yn||(Yn={}));Object(h.b)("IdeasCardType",Yn);class Lo{constructor(n,O){this.Rsa=null;this.R9b=!1;this.ia=n;this.la=O;this.ia.ya(Ab.a.ideasPaneOpened,yb.a.application,Object(r.a)(this,
this.Cjj,"handleIdeasPaneOpen"));this.ia.ya(Ab.a.v4d,yb.a.application,Object(r.a)(this,this.Bjj,"handleIdeasPaneClose"));this.ia.ya(Ab.a.Ojg,yb.a.application,Object(r.a)(this,this.ygg,"handleIdeasKeep"));this.ia.ya(Ab.a.Pjg,yb.a.application,Object(r.a)(this,this.C2d,"handleIdeasSee"));this.ia.ya(Ab.a.Ujg,yb.a.application,Object(r.a)(this,this.C2d,"handleIdeasSee"));this.ia.ya(Ab.a.Vjg,yb.a.application,Object(r.a)(this,this.B2d,"handleIdeasDrillIn"));this.ia.ya(Ab.a.Sjg,yb.a.application,Object(r.a)(this,
this.ygg,"handleIdeasKeep"));this.ia.ya(Ab.a.Tjg,yb.a.application,Object(r.a)(this,this.C2d,"handleIdeasSee"));this.ia.ya(Ab.a.Qjg,yb.a.application,Object(r.a)(this,this.B2d,"handleIdeasDrillIn"));this.ia.ya(Ab.a.Rjg,yb.a.application,Object(r.a)(this,this.B2d,"handleIdeasDrillIn"))}Cjj(){if(!this.la.pptIdeasContextEnabled)return 2;this.R9b=!0;this.bCj()||this.fel(Ad.a.create());return 32}Bjj(){if(!this.la.pptIdeasContextEnabled)return 2;this.R9b=!1;return 32}ygg(n){if(!this.la.pptIdeasContextEnabled)return 2;
this.Wkl(this.ZQd(n));return 32}C2d(n){if(!this.la.pptIdeasContextEnabled)return 2;this.lkd(this.ZQd(n));return 32}B2d(n){if(!this.la.pptIdeasContextEnabled)return 2;this.Ukl(this.ZQd(n));return 32}ZQd(n){switch(n){case Ab.a.Ojg:case Ab.a.Pjg:case Ab.a.Qjg:n=0;break;case Ab.a.Ujg:case Ab.a.Vjg:n=1;break;case Ab.a.Sjg:case Ab.a.Tjg:case Ab.a.Rjg:n=2;break;default:n=3}return n}fel(){this.la.pptIdeasContextEnabled&&(this.Rsa=new kl.a)}lkd(n){this.la.pptIdeasContextEnabled&&this.R9b&&3!==n&&this.Rsa&&
!this.Rsa.any(O=>O.key===n)&&this.Rsa.add(new ik.a(n,0))}Wkl(n){this.R9b&&3!==n&&this.Rsa&&this.Rsa.add(new ik.a(n,1))}Ukl(n){this.R9b&&3!==n&&this.Rsa&&this.Rsa.add(new ik.a(n,2))}bCj(){return!!this.Rsa&&0<this.Rsa.length}}Object(h.a)(Lo,"IdeasContext",null,[936]);class Hn{constructor(){this.Ny=this.My=null;this.qD=this.Bx=0}}Object(h.a)(Hn,"ImageLocationInfo",null,[]);var tn=d(427);class Cp{}Object(h.a)(Cp,"ImageToTableRequest",null,[]);class lh{}lh.rkg="ImageToTableTile";lh.pkg="ImageToTable.Request";
lh.qkg="ImageToTable.Response";Object(h.a)(lh,"ImateToTableAugmentationSchemaNames",null,[]);class un{constructor(){this.j_=this.GZ=null}get HF(){return"ImageToTableALWorkflow"}get proto(){return""}get Cnb(){this.GZ||(this.GZ=Object.assign(new tn.a,{name:"LambdaBefore_ImageToTableAL",inputSchema:lh.rkg,outputSchema:lh.pkg,func:Object(r.a)(this,this.Z8a,"lambdaBeforeFunc")}));return this.GZ}get Rmb(){return null}get dEb(){this.j_||(this.j_=Object.assign(new tn.a,{name:"LambdaRemote_ImageToTableAL",
inputSchema:lh.pkg,outputSchema:lh.qkg,func:null}));return this.j_}Z8a(n,O,ha){n=Object.assign(new Cp,{image:n.image});ha(n)}}Object(h.a)(un,"ImageToTableALWorkflow",null,[613]);class Zn{constructor(){this.html=this.processId=this.errorDescription=null;this.errorCode=this.shapeId=this.slideId=0}}Object(h.a)(Zn,"ImageToTableALv2ResponseWrapper",null,[]);class rc{constructor(){this.sessionId=null;this.shapeId=this.slideSid=0;this.image=this.B5b=null}}Object(h.a)(rc,"ImageToTableTile",null,[]);class cj{constructor(n,
O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd){this.ia=n;this.ob=O;this.Zb=ha;this.Dk=Aa;this.Gz=La;this.Yh=Bb;this.Ub=Wb;this.rm=uc;this.sde=Vc;this.Zja=bd;this.la=xd}initialize(){this.ia.ya(Ab.a.qye,yb.a.application,Object(r.a)(this,this.dgg,"handleConvertImageToTable"));this.ia.ya(Ab.a.wye,yb.a.application,Object(r.a)(this,this.dhg,"handleReplaceImageWithHtmlTable"));this.Dk.xM(Object(r.a)(this,this.hC,"onActiveSlideChanged"));this.sde.execute(n=>{const O=new un;n.registerSimpleRemoteWorkflow(O.HF,O.Cnb,O.dEb,
O.Rmb);n.addEventHandler(lh.qkg,Object(r.a)(this,this.Fjj,"handleImageToTableALResults"));n.mmb("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");n.jhc("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",Object(r.a)(this,this.mQa,"handleAnnotationEvent"))})}dispose(){this.ia.gO(Ab.a.qye,yb.a.application,Object(r.a)(this,this.dgg,"handleConvertImageToTable"));this.ia.gO(Ab.a.wye,yb.a.application,Object(r.a)(this,this.dhg,"handleReplaceImageWithHtmlTable"));this.Dk.H9(Object(r.a)(this,this.hC,"onActiveSlideChanged"))}hC(){this.Zja.close()}dgg(n,
O,ha){if(!this.la.pptSuggestedActionImageToTableEnabled)return 16;if(1===ha)return 32;n=this.ob.he();if(1!==n.length)return 8;const Aa=this.Zja.Enk();if(!Aa)return K.a.J(593867352,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),8;const La=n[0];this.la.P4g&&(this.Zja.QZk(Aa,La.slideSid,La.get_shapeId(),cj.KOd(La)),this.Zja.wWg(Aa));this.sde.execute(Bb=>{Bb.Jul(La.slideCid,La.slideSid,La.get_shapeId(),Wb=>{this.zgg(Aa,La,Wb)},()=>{this.zgg(Aa,La,null);return!0})});
return 32}mQa(n){if(n&&"errorDescription"in n&&"parentPath"in n&&"errorCode"in n){var O=new Zn,ha=n.errorDescription.split(";");O.errorDescription=ha[0].split(":")[1];O.processId=ha[1].split(":")[1];O.errorCode=n.errorCode;K.a.J(593867350,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",O.processId,O.errorCode,O.errorDescription);ha=n.parentPath[1].split("|");O.slideId=Number.parseInvariant(ha[0]);O.shapeId=Number.parseInvariant(ha[2]);O.html=n.html;
this.Zja.OZk(O);this.Zja.vWg()}}zgg(n,O,ha){if(ha&&ha.ImgData)if(this.la.P4g)this.Zja.PZk(n,ha.ImgData),this.Zja.vWg();else{const Aa=cj.KOd(O),La=Object.assign(new rc,{sessionId:n,slideSid:O.slideSid,shapeId:O.get_shapeId(),B5b:Aa,image:ha.ImgData});this.sde.execute(Bb=>{Bb.submit(lh.rkg,La)});this.Zja.wWg(n)}else this.Zja.lik(n)}Fjj(n,O,ha,Aa){K.a.J(576047055,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",Aa.processId,Aa.errorCode,Aa.errorDescription);
this.Zja.lgk(O,Aa)}dhg(n,O,ha,Aa,La){n=this.Ub.dCa(La.slideSid);if(!n)return 8;ha=(O=n.jS(La.shapeId))?cj.KOd(O):La.B5b;if(!ha)return 8;K.a.J(592303583,829,50,"Replacing image with html table. Shape id: {0}",O.get_shapeId());La=this.rm.UOd(!1,n.cid,n.sid,!1,ha.My,ha.Ny,ha.Bx,ha.qD,n.Mu()+1,La.Mth,"");this.Gz.X1([La],n,0,null,O);this.Zb.xw(n,"ImageToTable");return 32}static KOd(n){return Object.assign(new Hn,{My:n.My,Ny:n.Ny,Bx:n.Bx,qD:n.qD})}}Object(h.a)(cj,"ImageToTableActor",null,[]);class Mo{constructor(n){this.shapeId=
this.slideId=0;this.H4d=null;this.aUe=0;this.F3d=!1;this.Fdc=null;this.ISc=!1;this.HPc=this.K4d=this.jVg=this.J0g=null;this.sessionId=n}}Object(h.a)(Mo,"ImageToTableConversionContext",null,[]);class zk{constructor(){this.shapeId=this.slideSid=0;this.Mth=this.B5b=null}}Object(h.a)(zk,"ReplaceImageWithHtmlTableData",null,[]);class Ak{constructor(n,O,ha,Aa){this.ia=n;this.Zd=O;this.Ha=ha;this.eme=Aa;this.o8=null}initialize(){this.Zd.execute(n=>{n.pGd(Object(r.a)(this,this.wXg,"onFirstPartyAddInHidden"))});
this.eme.kGd(Object(r.a)(this,this.Fgg,"handleMessage"))}dispose(){this.Zd.execute(n=>{n.hNk(Object(r.a)(this,this.wXg,"onFirstPartyAddInHidden"))});this.eme.Fbh(Object(r.a)(this,this.Fgg,"handleMessage"))}Enk(){this.close();const n=new Mo(Ad.a.create().toString());n.J0g=new Promise(ha=>{n.jVg=()=>{ha(n.sessionId)}});const O={};O.ZT=ResourceStrings.L_DataFromPicturePaneTitle;O.assetId="FA000000050";O.dva=()=>{this.qve(n)};O.bO={["SessionID"]:n.sessionId};O.tnc=!0;O.sourceLocationOverrideResourceId=
this.Ha.pptImageToTableSourceLocationId;return 32===this.ia.Ma(Ab.a.pIa,2,O)?(this.o8=n,this.o8.sessionId):this.o8=null}close(){this.tMd(this.o8)}qve(n){K.a.J(593867348,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",n.sessionId);const O=this.Zd.instance.YY("FA000000050");if(O&&O.settings&&"SessionID"in O.settings){var ha;({Ev:ha}=ef.d(O.settings.SessionID)).returnValue&&(n.sessionId===ha?(n.Fdc=O.instanceId,K.a.J(593867346,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",
O.instanceId)):K.a.J(593867344,375,50,"[ImageToTablePane] Failed to find the taskpane"))}}tMd(n){n&&n.Fdc&&(n.ISc=!0,this.ia.Ma(Ab.a.fDc,2,n.Fdc))}QZk(n,O,ha,Aa){if(n=this.Grb(n))n.slideId=O,n.shapeId=ha,n.H4d=Aa}OZk(n){const O=this.o8;O&&O.slideId===n.slideId&&O.shapeId===n.shapeId&&(this.o8.HPc=n)}PZk(n,O){if(n=this.Grb(n))n.K4d=O}wWg(n){const O=this.Grb(n);O&&(O.aUe=window.setTimeout(()=>{this.qij(O)},this.Ha.pptImageToTableALWorkflowTimeoutMs))}lgk(n,O){if(n&&O){var ha=this.Grb(n.sessionId);if(ha&&
!ha.F3d)if(ha.slideId=n.slideSid,ha.shapeId=n.shapeId,ha.H4d=n.B5b,window.clearTimeout(ha.aUe),0===O.errorCode){const Aa={};Aa.tableHtml=O.html;Aa.imageData=n.image;this.sendMessage(ha.sessionId,Aa)}else this.Ped(n.sessionId,"Failed to convert image to table")}}vWg(){const n=this.o8;if(n&&!n.F3d&&n.HPc&&n.K4d)if(window.clearTimeout(n.aUe),0===n.HPc.errorCode){const O={};O.tableHtml=n.HPc.html;O.imageData=n.K4d;this.sendMessage(n.sessionId,O)}else this.Ped(n.sessionId,"Failed to convert image to table")}lik(n){this.Ped(n,
"Failed to render the image shape")}qij(n){n.F3d=!0;this.Ped(n.sessionId,"Failed to convert image to table using AL")}Fgg(n,O){O=O.message;(n=this.Grb(O.session_id))&&!n.ISc&&("ACK"===O.cmd_type?(K.a.J(593867342,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",O.cmd_type),n.jVg()):"cancel"===O.cmd_type?(K.a.J(593867340,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",O.cmd_type),this.tMd(n)):"insert_html"===O.cmd_type?(K.a.J(593867338,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",
O.cmd_type),O=Object.assign(new zk,{slideSid:n.slideId,shapeId:n.shapeId,B5b:n.H4d,Mth:O.parameters}),this.tMd(n),this.ia.Ma(Ab.a.wye,2,O)):K.a.J(593867336,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",O.cmd_type))}Ped(n,O){this.sendMessage(n,{["errorMessage"]:O})}sendMessage(n,O){const ha=this.Grb(n);ha&&ha.sessionId===n&&ha.J0g.then(()=>{this.eme.sendMessage(ha.Fdc,O)})}Grb(n){return n&&this.o8&&this.o8.sessionId===n?this.o8:null}wXg(n,O){O&&this.o8&&
O.instanceId===this.o8.Fdc&&(this.o8=null)}}Object(h.a)(Ak,"ImageToTablePane",null,[940]);class ye extends Sys.EventArgs{constructor(n){super();this.message=n}}Object(h.a)(ye,"ImageToTablePaneMessageReceivedArgs",Sys.EventArgs,[]);class $n{constructor(n){this.va=new Hl.a;this.Ha=n}kGd(n){this.va.addHandler("ImageToDocPaneMessageReceived",n)}Fbh(n){this.va.removeHandler("ImageToDocPaneMessageReceived",n)}initialize(){try{window.addEventListener?window.addEventListener("message",Object(r.a)(this,this.Dbc,
"messageReceivedHandler"),!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",Object(r.a)(this,this.Dbc,"messageReceivedHandler")):K.a.J(593867334,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(n){K.a.J(593867332,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",n.message,n.stack)}}sendMessage(n,O){const ha={["imageToTablePaneWildcard"]:"."};
for(const Aa of Object.keys(O))ha[Aa]=O[Aa];OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(n,"onCustomMessage",ha,Aa=>{Aa&&K.a.J(593867330,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",Aa)})}Dbc(n){if(n&&this.R3b(n.origin)){var O;({Ev:O}=ef.d(n.data)).returnValue&&O&&(n=Object(M.a)(Object,O),"."===n.imageToTablePaneWildcard&&this.va.raiseEvent("ImageToDocPaneMessageReceived",new ye(n)))}}R3b(n){return n&&n.length&&"null"!==n?n===this.Ha.pptImageToTableAllowedOrigin:
!1}}Object(h.a)($n,"ImageToTablePaneMessenger",null,[939]);var No=d(1049);class ao{constructor(){this.Scenario=0;this.ShapeIds=null;this.SlideSid=this.SlideCid=0}}Object(h.a)(ao,"ImageTransformInfo",null,[]);class Xl{constructor(n,O,ha,Aa){this.ia=n;this.ob=O;this.ua=ha;this.Xc=Aa}initialize(){this.Xc.k1h(Object(r.a)(this,this.G_g,"onSuggestedActionClick"))}dispose(){this.Xc.oMk(Object(r.a)(this,this.G_g,"onSuggestedActionClick"))}G_g(n,O){if((n=O.card)&&this.ua.Ca){var ha=this.ua.Ca.km(),Aa=[];O=
[];for(var La of ha)for(const Bb of n.Selects)if(Bb.Id===La.get_shapeId()){Array.add(Aa,La);Array.add(O,La.get_shapeId());break}this.ob.gy();this.ob.Rh();this.ob.mXa(Aa,!0);if(4===n.Type){if(La=this.ua.presentation)La.ptb=Object.assign(new ao,{Scenario:n.Scenario,SlideSid:this.ua.Ca.sid,SlideCid:this.ua.Ca.cid,ShapeIds:O})}else this.ia.processAction(No.a.RBc(n.ExecutionActionName),2)}}}Object(h.a)(Xl,"SuggestedActionsHandler",null,[]);class In{constructor(){this.K=null;this.tW=!1;this.nE=!!v.AFrameworkApplication.Ba&&
!!v.AFrameworkApplication.Ba.jb&&v.AFrameworkApplication.Ba.jb.NV}get name(){return"PowerPointWebEditor.Designer"}Yb(n){this.K=n;this.K.register(930,"PowerPointWebEditor.IDesignerView").ma().na(()=>new yl(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Box4.IViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IPointerInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(931,"PowerPointWebEditor.IDesignerPane").ma().na(()=>new Ll(this.K.resolve("Box4.IAppFrame"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(932,"PowerPointWebEditor.IDesignerViewHelper").ma().na(()=>new qe(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.Oa("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")));this.K.register(933,"PowerPointWebEditor.IDesignerManager").ma().na(()=>new xj(this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.Oa("PowerPointWebEditor.IDesignerServiceProvider"),this.K.Oa("PowerPointWebEditor.IApplyDesignerSuggestions"),this.K.Oa("Common.ISystemInitiatedFeedback")));this.K.register(934,"PowerPointWebEditor.Designer.IDesignerPreviewImageView").ma().na(()=>new $k(this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager")));
this.K.register(935,"PowerPointWebEditor.IDesignerContext").ma().na(()=>new Un(this.K.Oa("PowerPointWebEditor.IDesignerServiceProvider")));this.K.register(936,"PowerPointWebEditor.Infrared.IIdeasContext").ma().na(()=>new Lo(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(937,"PowerPointWebEditor.IFixItManager").ma().na(()=>new Gn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler")));this.K.register(938,
"PowerPointWebEditor.IFixItContext").ma().na(()=>new Al);(this.tW=this.K.resolve("PowerPointWebEditor.IApplicationContext").kd.zg)&&this.K.register(Cn.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>new Cn.a(v.AFrameworkApplication.Be,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("Common.IAppSettingsManager")));this.K.register(cj,"PowerPointWebEditor.Designer.ImageToTableActor").ma().na(()=>new cj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeEditor"),this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(939,"PowerPointWebEditor.Designer.IImageToTablePaneMessenger").ma().na(()=>new $n(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(940,"PowerPointWebEditor.Designer.IImageToTablePane").ma().na(()=>
new Ak(this.K.resolve("Common.IActionManagerExtended"),this.K.Oa("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger")));this.K.register(Xl,"PowerPointWebEditor.Designer.SuggestedActionsHandler").ma().na(()=>new Xl(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource")))}init(){const n=this.K.resolve("Common.IAppSettingsManager");n.gf(()=>{if(n.ka(zb.a.pa(248))){this.tW&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");var O=this.K.resolve("PowerPointWebEditor.IDesignerView"),ha=u.a.instance.resolve("PowerPointWebEditor.IDesignerPane").za;O.Sza(ha);O.aQc();this.nE||this.K.resolve("PowerPointWebEditor.IPaneManager").wM(this.K.resolve("PowerPointWebEditor.IDesignerPane"));O=null;if(n.ka(zb.a.pa(1034))&&
(O=this.K.resolve("Common.App.OAuth.IOAuthManager"))){ha=n.Ia(zb.a.pa(1043));const Aa=n.Ia(zb.a.pa(1035)),La=new Date;O.p0(ha,Aa).then(Bb=>{const Wb=+new Date-+La;Bb.IsSuccess?K.a.J(51475615,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+Wb):(K.a.J(42324822,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+Bb.ErrorCode+": "+Bb.ErrorMessage),K.a.J(51475618,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+
Wb))}).catch(Bb=>{K.a.J(51475648,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+(+new Date-+La));K.a.J(42324824,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",Bb)})}O=new Zj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IClipboardDataHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerManager"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),
this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.Oa("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),O,this.K.Oa("PowerPointWebEditor.IAgendaMetrics"),this.K.Oa("PowerPointWebEditor.AgendaConverter.IAgendaConverterView"));O.wb();O.Fe();(new En(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),
this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"))).wb();this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").setup();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger").initialize();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").initialize();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").initialize();
this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").initialize();this.K.resolve("PowerPointWebEditor.IFixItManager")}else K.a.J(37041294,829,50,"Designer setting is disabled")})}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").dispose();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").dispose();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").dispose();
this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").dispose();this.K.resolve("PowerPointWebEditor.IFixItManager").dispose()}static main(){e.a.instance.Ec(nc.a(new In,0))}}Object(h.a)(In,"PPTWebEditorDesignerPackage",null,[2,3]);class mm{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PenMinutes"}Yb(n){this.K=n}init(){const n=this.K.qb("Common.App.PenMinutesManager.IPenMinutesManager");n&&n.w1k()}dispose(){}static main(){e.a.instance.Ec(new mm)}}Object(h.a)(mm,"PPTWebEditorPenMinutesPackage",
null,[2,3]);var z=d(895);class T{}Object(h.a)(T,"TextToSmartArtSuggestionData",null,[]);class ja{constructor(){this.suggestions=[]}}Object(h.a)(ja,"TextToSmartArtSuggestionNotificationData",null,[]);class Ba{}Ba.xJe="ShapePresence";Ba.slideNavigation="SlideNavigation";Ba.CJb="WebActionId:";Ba.HT="SelectionChanged";Ba.Rjc="ShapePositionChanged";Ba.xeb="Retrigger";Ba.Nse="NoSuggestions";Ba.sWj="LowSuggestions";Ba.A5c="NewSession";Ba.Pbl="SlideShowStarted";Ba.serverError="ServerError";Ba.iNf="ClientSuggestionTimeOut";
Object(h.a)(Ba,"ReplaceObjectResetReason",null,[]);class Ga{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze,Ah,Bk,Oe,sh,Ck){this.PTa=this.jje=this.w$a=!1;this.sa=n;this.Ga=O;this.ua=ha;this.Zb=Aa;this.k8=La;this.yh=Bb;this.ia=Wb;this.Gy=uc;this.yFa=Vc;this.Hy=bd;this.oAb=xe;this.Aka=wf;this.L1c=Ze;this.Xc=Ah;this.rI=Bk;this.Bb=Oe;this.Rb=sh;this.Ht=xd;this.xTa=Ck;this.Sq=!1}get wh(){return this.Sq}setup(){this.wh||(this.Ox(),this.jje=2===this.Rb.mode,this.Sq=!0)}Ox(){this.sa.VJ(Object(r.a)(this,
this.VG,"onSelectionChanged"));this.oAb.vSb(Object(r.a)(this,this.ere,"markedUndo"));this.yh.xM(Object(r.a)(this,this.hC,"onActiveSlideChanged"));this.Aka.H2a(Object(r.a)(this,this.C_,"onSlidePresenceChanged"));this.Xc.Z2h(Object(r.a)(this,this.Dve,"onReplaceObjectResponse"));this.yFa.$2h(Object(r.a)(this,this.Eve,"onReplaceObjectViewDragEnd"));this.k8.wSb(Object(r.a)(this,this.Fte,"onApplyReplaceObjectBlockingStateChanged"));this.yh.oGd(Object(r.a)(this,this.anc,"updateEditState"));this.Rb.aP(Object(r.a)(this,
this.Mx,"onAppFrameModeSwitched"));this.Xc.XBf(Object(r.a)(this,this.GVg,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval"));this.Xc.WBf(Object(r.a)(this,this.FVg,"onApplyReplaceObjectSuggestionAfterSelectionRemoval"));this.Xc.Izc(Object(r.a)(this,this.Kla,"onUndoRedo"))}dispose(){this.wh&&(this.sa.yHa(Object(r.a)(this,this.VG,"onSelectionChanged")),this.oAb.pDe(Object(r.a)(this,this.ere,"markedUndo")),this.yh.H9(Object(r.a)(this,this.hC,"onActiveSlideChanged")),this.Aka.GDe(Object(r.a)(this,
this.C_,"onSlidePresenceChanged")),this.Xc.xNk(Object(r.a)(this,this.Dve,"onReplaceObjectResponse")),this.yFa.yNk(Object(r.a)(this,this.Eve,"onReplaceObjectViewDragEnd")),this.k8.wcd(Object(r.a)(this,this.Fte,"onApplyReplaceObjectBlockingStateChanged")),this.Rb.Q_(Object(r.a)(this,this.Mx,"onAppFrameModeSwitched")),this.yh.rDe(Object(r.a)(this,this.anc,"updateEditState")),this.Xc.Ibh(Object(r.a)(this,this.GVg,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval")),this.Xc.Hbh(Object(r.a)(this,this.FVg,
"onApplyReplaceObjectSuggestionAfterSelectionRemoval")),this.Xc.Dcd(Object(r.a)(this,this.Kla,"onUndoRedo")),this.Sq=!1)}SXa(n){return this.g8d()?this.L1c.Dnc(n):!1}selectShape(n){n&&this.sa.selectShape(n,!1)}eSc(n){switch(n){case Ab.a.RMa:case Ab.a.gse:case Ab.a.Nbc:case Ab.a.Obc:case Ab.a.Pbc:case Ab.a.Qbc:case Ab.a.lGa:return!0;default:return!1}}g8d(){return this.w$a&&this.jje}n2g(n,O){const ha=[];if(ib.a.Xa(n))return ha;n=n.split(";");if(n.length<O)return K.a.J(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",
O,n.length),ha;for(let Aa=0;Aa<O;++Aa){const La=n[Aa].split(":");if(3!==La.length)throw O=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",Aa,n[Aa]),K.a.J(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",O),Error.create(O);const Bb=z.a.vdj(Number.parseInvariant(La[1]));Array.add(ha,Object.assign(new T,{index:La[0],labelText:ib.a.Xa(Bb)?ResourceStrings.L_SmartArt:Bb,imageData:this.MLc(La[2])}))}return ha}GVg(){this.PTa=!0}FVg(){this.PTa=!1}Kla(n,
O){this.HP(O.actionId)}MLc(n){return ib.a.Xa(n)?null:"data:image/png;base64,"+n}Mx(n){K.a.J(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",n.mode);this.jje=2===n.mode}anc(){this.w$a||K.a.J(36544856,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");this.w$a=!0}ABb(n,O,ha,Aa){this.xTa.execute(La=>{const Bb=Object.assign(new ja,{correlationId:n,shapeId:O,suggestions:ha});La.notifyTextToSmartArtSuggestion(Aa,Bb)})}ehg(n,O,ha){if(O.lD)if(O.M7&&
0!==n.AHa)K.a.J(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",n.AHa);else{if(0===n.AHa){if(0>=n.dca){K.a.J(38115482,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",n.correlationId);this.closeSession(O,Ba.Nse);return}if(n.dca<ha.replaceObjectMinRequiredSuggestions){K.a.J(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",n.correlationId);this.closeSession(O,
Ba.sWj);return}O.M7=!1;O.suggestions=this.n2g(n.SAa,n.dca);O.DX=n.dca;K.a.J(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",O.DX,n.correlationId)}else if(1===n.AHa){if(ib.a.Xa(n.SAa)){K.a.J(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",n.correlationId);return}O.suggestions=this.n2g(n.SAa,n.dca);O.bIb=new Date;ha.powerPointIdeasIsEnabled&&this.ABb(n.correlationId,O.shapeId,O.suggestions,Yk.a.success)}else 2===n.AHa&&
(O.vae=!1,O.shapeId=n.shapeId,this.ABb(O.correlationId,n.shapeId,O.suggestions,Yk.a.success));ha=O.shape;O.slide&&O.slide.isConnected&&ha&&ha.isConnected&&this.Ht.F8a(ha)&&this.g8d()&&(1===n.AHa?this.Hy.P$g(O.correlationId):this.Hy.vhd(ha))}else K.a.J(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",n.correlationId)}}Object(h.a)(Ga,"BaseReplaceObjectManager",null,[921,955]);class Fb{}Fb.none="";Fb.Rjc="ShapePositionChanged";Object(h.a)(Fb,"ReplaceObjectRetriggerReason",
null,[]);class Rb{}Rb.selectShape="SelectShape";Rb.xeb="Retrigger";Rb.f$h="AugLoopRetrigger";Rb.e$h="AugLoopDefault";Object(h.a)(Rb,"ReplaceObjectTrigger",null,[]);var tc=d(502);class Ac extends Ga{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze,Ah,Bk,Oe,sh,Ck,Hm,nm,yo,eo){super(uc,ha,Aa,La,Bb,Wb,Vc,bd,xd,xe,wf,Ah,Bk,Oe,sh,Hm,nm,yo,eo);this.GS=n;this.WBg=O;this.S4j=Ze;this.la=Ck;this.xMg=this.la.replaceObjectGrayFloatieInTyping}Ox(){this.la.replaceObjectUseClientAL?this.WBg.execute(n=>{n.addEventHandler("ShapeTextConvertable",
Object(r.a)(this,this.p6g,"processShapeTextConvertibleClientAL"))}):this.GS.execute(n=>{n.addEventHandler("ShapeTextConvertable",Object(r.a)(this,this.Lze,"processShapeTextConvertible"))});this.Xc.q4h(Object(r.a)(this,this.k8c,"onSlideShowStarted"));super.Ox()}dispose(){this.wh&&(this.la.replaceObjectUseClientAL?this.WBg.execute(n=>{n.removeEventHandler("ShapeTextConvertable",Object(r.a)(this,this.p6g,"processShapeTextConvertibleClientAL"))}):this.GS.execute(n=>{n.removeEventHandler("ShapeTextConvertable",
Object(r.a)(this,this.Lze,"processShapeTextConvertible"))}),this.Xc.nOk(Object(r.a)(this,this.k8c,"onSlideShowStarted")));super.dispose()}Lze(n,O){if(n&&O){try{var ha=ef.a(n);var Aa=ef.a(O)}catch(Bb){K.a.J(26080646,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");return}if(ha&&!isNaN(ha.sid)&&!isNaN(ha.cid)&&!isNaN(ha.shapeId)&&this.ua.Ca&&(n=new Date(ha.c),K.a.J(34181982,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",
ha.sid,ha.cid,ha.shapeId,ha.t,ha.c?(new Date).getTime()-ha.c:-1),(O=this.ua.Ca.jS(ha.shapeId))&&(Db.a.contains(this.ocg(),O.get_shapeId())||"activeSlideChanged"===ha.t)))if(Aa&&!Aa.isTextConvertible)this.Hy.jma(O,!0);else{var La=this.Gy.P_b(O.get_shapeId());if(La&&La.kba&&(La=new tc.a(O,La.Iea),this.ia.Ma(Ab.a.Idb,2,La),!La.bsa))return;this.SXa(O)&&this.Oha(this.ua.Ca,O,Aa&&Aa.smartArtInfo?Aa.smartArtInfo.length:0,ha.t||Rb.e$h,Fb.none,n)}}}p6g(n,O,ha,Aa){O&&Aa&&Aa.ContextId&&Aa.Payload&&this.Lze(Aa.ContextId,
Aa.Payload)}k8c(){this.pMd(Ba.Pbl)}VG(n,O){if(!this.wh)K.a.J(26042393,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.PTa&&(O.KD.length||!this.Ga.ye||this.Ga.ye.name!==Rc.a.sg)){n=this.ocg();for(let ha of this.Gy)ha.lD&&!Array.contains(n,ha.shapeId)&&this.closeSession(ha,Ba.HT);this.xMg&&!Array.contains(n,this.Hy.Ksb)&&this.Hy.iLk()}}Eve(n,O){this.wh?(n=this.Gy.P_b(O.shape.get_shapeId()))&&n.lD&&(O=n.shape,this.closeSession(n,Ba.Rjc),this.SXa(O)&&
this.Oha(this.ua.Ca,O,0,Rb.f$h,Fb.Rjc)):K.a.J(26042395,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}ere(n,O){O.xub&&this.HP(O.actionId)}hC(){this.pMd(Ba.slideNavigation)}C_(n,O){if(O.u7&&O.shapes)for(const ha of O.shapes)(n=this.Gy.P_b(ha))&&n.lD&&this.closeSession(n,Ba.xJe)}Dve(n,O){(n=this.Gy.s6a(O.correlationId))?this.ehg(O,n,this.la):K.a.J(26042397,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",
O.correlationId)}Fte(){if(this.wh)for(let n of this.Gy)n.P7a&&0===n.k0&&!this.Zb.gd(this.ua.presentation)&&(n.P7a=!1,this.Hy.jma(n.shape,!0))}SXa(n){const O=this.Gy.Dzf;return 1<=O?(K.a.J(34223842,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",O),!1):super.SXa(n)}Oha(n,O,ha,Aa,La,Bb=null){try{let Wb=this.Gy.P_b(O.get_shapeId());Wb&&this.closeSession(Wb,Ba.A5c);Wb=this.Gy.YEc(n,O.get_shapeId(),Aa,La,this.la);Wb.emc=Bb;Wb.kba="richEditTextUnicodeChanged"===
Aa;this.Hy.$mc(Wb.correlationId);const uc=this.S4j.$hh(Wb);K.a.J(34144971,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",Wb.correlationId,Wb.slide.sid,Wb.slide.cid,Wb.shapeId,uc);K.a.J(34097054,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",Wb.correlationId,ha,Math.min(ha,
this.la.replaceObjectSuggestionMaxCount),Aa);ha&&this.la.replaceObjectShowFloatieOnShapeTextConvertibleResponse&&(ha=Math.min(ha,this.la.replaceObjectSuggestionMaxCount),Wb.suggestions=this.AUi(ha),Wb.DX=ha,Wb.M7=!1,this.Hy.vhd(O));0===uc&&this.la.powerPointIdeasIsEnabled&&this.ABb(Wb.correlationId,Wb.shapeId,[],Yk.a.pending)}catch(Wb){K.a.J(34152522,829,10,"GenerateSuggestion failed!! {0} ",Wb.message)}}AUi(n){const O=Array(n);for(let ha=0;ha<n;ha++)Array.add(O,Object.assign(new T,{index:ha.toString(),
labelText:ResourceStrings.l_Loading,imageData:null}));return O}HP(n){this.wh?this.eSc(n)||this.pMd(Ba.CJb+this.rI.x4(n)):K.a.J(26042447,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")}P6k(n){if(!this.xMg)return!1;const O=this.sa.he();return n.kba&&Array.contains(O,n.shape)}closeSession(n,O){0===n.k0&&(O===Ba.Nse?this.Hy.jma(n.shape,!0):n.kba&&this.Hy.jma(n.shape,!0,O!==Ba.A5c,this.P6k(n)),this.Gy.HQc(n,O),this.la.powerPointIdeasIsEnabled&&this.ABb(n.correlationId,
n.shapeId,n.suggestions,Yk.a.rGa))}pMd(n){for(let O of this.Gy)this.closeSession(O,n)}ocg(){const n=this.sa.he(),O=[];n&&n.forEach(ha=>{Array.add(O,ha.get_shapeId())});return O}}Object(h.a)(Ac,"AugmentationLoopReplaceObjectManager",Ga,[]);class kd{constructor(n,O){this.disabled=!1;this.$Ig=Zf.App.Bm;this.la=n;this.Bb=O}ijh(n){this.disabled=!0;this.$Ig=new Date;const O=new Y.a(2,1,this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds,()=>{this.disabled&&+new Date-+this.$Ig>=this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds&&
n()});this.Bb.Hb(O)}V_k(n){const O=new Y.a(2,1,550,()=>{n()});this.Bb.Hb(O)}static Qul(n,O){return 7<=n&&8>=n&&1!==O}}Object(h.a)(kd,"FlyoutAnchorTimer",null,[]);var nd=d(355);class Bd{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze,Ah){this.Qr=null;this.PTa=!1;this.Xc=O;this.sa=n;this.Gy=ha;this.ua=Aa;this.Fa=La;this.la=Bb;this.Hy=Wb;this.Yh=uc;this.Ht=Vc;this.Aka=bd;this.k8=xd;this.pTa=xe;this.Tac=wf;this.rI=Ze;this.hc=Ah}Ox(){this.Xc.H2h(Object(r.a)(this,this.OXg,"onIconSuggestionNotification"));
this.sa.VJ(Object(r.a)(this,this.VG,"onSelectionChanged"));this.Xc.XBf(Object(r.a)(this,this.EVg,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Xc.WBf(Object(r.a)(this,this.DVg,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Xc.G2h(Object(r.a)(this,this.NXg,"onIconChanged"));this.Aka.H2a(Object(r.a)(this,this.C_,"onSlidePresenceChanged"));this.k8.wSb(Object(r.a)(this,this.zda,"onBlockingStateChanged"));this.Tac.vSb(Object(r.a)(this,this.Icb,"onMarkedUndo"))}xRe(){this.Xc.kNk(Object(r.a)(this,
this.OXg,"onIconSuggestionNotification"));this.sa.yHa(Object(r.a)(this,this.VG,"onSelectionChanged"));this.Xc.Ibh(Object(r.a)(this,this.EVg,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Xc.Hbh(Object(r.a)(this,this.DVg,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Xc.jNk(Object(r.a)(this,this.NXg,"onIconChanged"));this.Aka.GDe(Object(r.a)(this,this.C_,"onSlidePresenceChanged"));this.k8.wcd(Object(r.a)(this,this.zda,"onBlockingStateChanged"));this.Tac.pDe(Object(r.a)(this,
this.Icb,"onMarkedUndo"))}dispose(){this.xRe()}setup(){this.Ox()}EVg(){this.PTa=!0}DVg(){this.PTa=!1}NXg(n,O){O&&this.Qr&&this.Qr.Mic&&this.Qr.slide.sid===O.slideId.sid&&this.Qr.slide.cid===O.slideId.cid&&this.Qr.shapeId===O.shapeId&&this.Qr.O4===O.BX&&(this.Qr.oGe=O.uCa)}C_(n,O){if(O.u7&&O.shapes&&this.Qr)for(const ha of O.shapes)this.Qr.shapeId===ha&&this.$U(Ba.xJe)}Icb(n,O){O.xub&&!this.eSc(O.actionId)&&this.$U(Ba.CJb+this.rI.x4(O.actionId))}eSc(n){switch(n){case Ab.a.RMa:case Ab.a.gse:case Ab.a.Nbc:case Ab.a.Obc:case Ab.a.Pbc:case Ab.a.Qbc:case Ab.a.lGa:return!0;
default:return!1}}zda(){if(this.Qr){const n=this.Qr.shape,O=this.Fa.Lr(n);n&&O&&!this.pTa.gd(O)&&(this.Qr.P7a=!1,this.Hy.jma(n,!0),this.Qr.cmc=new Date,this.Qr.$U(Ba.HT))}}VG(){if(!this.PTa){var n=this.Fa.Z5a(this.sa.he());if(n){if(this.Qr&&this.Qr.lD){if(nd.a.Qjc(n.xX,this.Qr.xX))return;this.$U(Ba.HT)}this.SXa(n)&&this.Oha(this.ua.Ca,n,Rb.selectShape)}else this.Qr&&this.Qr.lD&&this.$U(Ba.HT)}}Oha(n,O,ha){this.Qr=this.Gy.RNa(n,O.get_shapeId(),ha,"",this.la,O.get_smartArtModelId());this.Qr.M7=!0;this.Hy.$mc(this.Qr.correlationId);
K.a.J(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.Qr.correlationId,this.Qr.slide.sid,this.Qr.slide.cid,this.Qr.shapeId,this.Qr.O4);const Aa=O.get_smartArtModelId()?this.Fa.Lr(O):O;Aa?this.Yh.xUi(n.cid,n.sid,Aa.get_shapeId(),this.Ht.bNc(Aa),this.Ht.aNc(Aa),O.get_smartArtModelId(),this.Qr.correlationId,ha,Object(r.a)(this,this.iik,"onIconSuggestionResponseSuccess"),Object(r.a)(this,this.Scb,"onTaskFailure")):
K.a.J(38279305,829,15,"Parent ShapeNode of a {0} is null",O.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")}iik(n){if(n&&n.SuggestionResult){var O=n.CorrelationId,ha=this.Gy.s6a(O);if(ha)if(ha.lD){O=null;try{O=Sys.Serialization.JavaScriptSerializer.deserialize(n.SuggestionResult)}catch(Aa){K.a.J(38625546,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",Aa)}if(O){ha.suggestions=this.Jqk(O);ha.bIb=new Date;if(ha.M7){if(this.Pqg(ha)){K.a.J(39184097,829,
15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",ha.RUb,this.la.pptIconChunkingSuggestionTimeoutMs);this.$U(Ba.iNf);return}K.a.J(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");ha.DX=ha.suggestions?ha.suggestions.length:0;ha.M7=!1;this.Hy.vhd(ha.shape)}this.Hy.P$g(ha.correlationId)}else this.$U(Ba.serverError),K.a.J(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else K.a.J(38279315,
829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Qr?this.Qr.correlationId:"",O);else K.a.J(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",O)}else this.$U(Ba.serverError),K.a.J(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")}Scb(n){this.$U(Ba.serverError);
K.a.J(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",n.HttpStatusCode);return!0}SXa(n){return this.hc.An?n.get_smartArtModelId()&&n.get_isSVGBlipFilled()?(n=this.Fa.Lr(n),!!n&&!n.Iv):!1:!1}$U(n){this.Qr&&(this.Hy.jma(this.Qr.shape,!0),this.Gy.HQc(this.Qr,n),this.Qr=null)}MLc(n){return ib.a.Xa(n)?null:n.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+encodeURIComponent(n):"data:image/png;base64,"+n}Jqk(n){const O=[];if(!n||
!n.length)return O;for(let ha=0;ha<n.length;++ha){const Aa=Object.assign(new T,{index:n[ha].Index.toString(),labelText:n[ha].Label,imageData:this.MLc(n[ha].Render),renderData:this.MLc(n[ha].Replace)});Array.add(O,Aa)}return O}iwi(n,O){const ha=[];if(ib.a.Xa(n)||!O)return ha;for(var Aa=0;Aa<O;++Aa){var La=Object.assign(new T,{index:Aa.toString(),labelText:"",imageData:null,renderData:null});Array.add(ha,La)}n=n.split(";");if(n.length-1!==O)return K.a.J(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",
ha.length,O),ha;for(Aa=0;Aa<O;++Aa)La=n[Aa].indexOf(":"),0>La?K.a.J(38279321,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):ha[Aa].labelText=n[Aa].substr(La+1);return ha}Iqk(n){let O,ha,Aa,La;O="";Aa=ha=0;La=null;if(ib.a.Xa(n))return K.a.J(38279323,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),{returnValue:!1,correlationId:O,dca:ha,Xse:Aa,suggestions:La};const Bb=n.split("|");if(4!==Bb.length)return K.a.J(38279325,
829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+n.length),{returnValue:!1,correlationId:O,dca:ha,Xse:Aa,suggestions:La};O=Bb[0];ha=parseInt(Bb[1]);Aa=Number.parseInvariant(Bb[2]);La=this.iwi(Bb[3],ha);return{returnValue:!0,correlationId:O,dca:ha,Xse:Aa,suggestions:La}}OXg(n,O){let ha,Aa;if(({correlationId:n,dca:O,Xse:ha,suggestions:Aa}=this.Iqk(O.SAa)).returnValue){var La=this.Gy.s6a(n);if(La)if(La.lD&&La.M7){var Bb=La.shape;0===ha&&(0>=
O?(K.a.J(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",n),this.$U(Ba.Nse)):this.Pqg(La)?(K.a.J(39184137,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",La.RUb,this.la.pptIconChunkingSuggestionTimeoutMs),this.$U(Ba.iNf)):(La.M7=!1,La.DX=O,La.suggestions=Aa,K.a.J(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",
La.correlationId,La.DX),this.Hy.vhd(Bb)))}else K.a.J(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Qr?this.Qr.correlationId:"",n,La.lD,La.M7);else K.a.J(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",n)}else K.a.J(38279327,829,50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}Pqg(n){const O=
new Date,ha=n.Iea,Aa=this.la.pptIconChunkingSuggestionTimeoutMs;return O&&ha&&0<Aa&&+O-+ha>Aa?(n.RUb=+O-+ha,!0):!1}}Object(h.a)(Bd,"ReplaceIconManager",null,[]);var Zd=d(683),df=d(964);class Ke extends Sys.EventArgs{constructor(n){super();this.xX=n}}Object(h.a)(Ke,"OnBeforeReplaceObjectSuggestionApplyEventArgs",Sys.EventArgs,[]);class zf{constructor(){this.shape=null;this.action=0}}Object(h.a)(zf,"ShowHideReplaceObjectGalleryData",null,[]);class Sf{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf){this.Sq=
this.w$a=!1;this.ia=O;this.Ga=ha;this.ua=La;this.yh=Aa;this.Zb=Bb;this.zFa=Wb;this.Hy=xd;this.Pb=xe;this.Fa=wf;this.sa=n;this.Xc=uc;this.Gy=Vc;this.Jb=bd}get wh(){return this.Sq}setup(){this.wh||(this.Ox(),this.wb(),this.Fe(),this.Sq=!0)}dispose(){this.wh&&(this.xRe(),this.Sq=!1)}Ox(){this.yh.oGd(Object(r.a)(this,this.anc,"updateEditState"))}xRe(){this.yh.rDe(Object(r.a)(this,this.anc,"updateEditState"))}wb(){this.ia.ra(Ab.a.RMa,yb.a.application,Object(r.a)(this,this.RMa,"applyReplaceObjectSuggestion"),
4);this.ia.ra(Ab.a.WXa,yb.a.application,Object(r.a)(this,this.WXa,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(Ab.a.LGb,yb.a.application,Object(r.a)(this,this.WXa,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(Ab.a.Zbc,yb.a.application,Object(r.a)(this,this.lTg,"navigateReplaceObjectSuggestion"),4);this.ia.ra(Ab.a.Ybc,yb.a.application,Object(r.a)(this,this.lTg,"navigateReplaceObjectSuggestion"),4)}Fe(){const n=this.Ga.Bc(Rc.a.QM),O=this.Ga.Bc(Rc.a.sg),ha=this.Ga.Bc(Rc.a.wEb);
n.bindAction(jb.KeyInputManager.La(ra.a.Xp,2),Ab.a.LGb);O.bindAction(jb.KeyInputManager.La(ra.a.Xp,2),Ab.a.LGb);ha.bindAction(jb.KeyInputManager.La(ra.a.Xp,2),Ab.a.LGb);ha.bindAction(jb.KeyInputManager.La(ra.a.B0,0),Ab.a.LGb);ha.bindAction(jb.KeyInputManager.La(ra.a.q$,0),Ab.a.Zbc);ha.bindAction(jb.KeyInputManager.La(ra.a.Sea,0),Ab.a.Ybc)}anc(){this.w$a||K.a.J(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.w$a=!0}RMa(n,O,ha,Aa,La){if(!this.wh)return K.a.J(33698392,
829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),16;O=this.ua.presentation;if(!this.ua.Ca||!O||this.Zb.gd(O))return 16;if(1===ha)return 32;ha=!0;Aa=null;Object(Qj.a)(Zd.a,La)?Aa=La:Object(Qj.a)(df.a,La)&&(Aa=La.AAc,ha=!1);La=new nd.a(N.a.XD(Aa.ActiveSlideSid,Aa.ActiveSlideCid),Aa.ShapeId,Aa.SmartArtSubNodeId);const Bb=new Ke(La);this.zFa.ICk(Bb);const Wb=this.Gy.t6a(La);if(Wb&&Wb.shapeId===Aa.ShapeId){let uc=null;1===Wb.k0&&(uc=this.Fa.Lr(Wb.shape));La=this.Jb.xd(15,
void 0,()=>{1===Wb.k0||this.sa.hu()||(this.Xc.jbd(),this.sa.Rh(),this.Xc.ibd())},()=>{uc&&(this.Xc.jbd(),this.sa.selectShape(uc,!0),this.Xc.ibd())});try{La.lc(O),La.fd=Aa.SmartArtSubNodeId?Ab.a.uLf:n,O.yEb=Aa,Wb.wAc=Aa.SuggestionSid,Wb.AHd=Aa.Label,Wb.xS=!0,Wb.dmc=new Date,K.a.J(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Aa.CorrelationId,n,Aa.SuggestionSid)}finally{La&&La.dispose()}Wb.vae=!0;Wb.P7a=!0;ha&&Wb.dre();0===
Wb.k0?this.Zb.xw(O,n):uc?this.Zb.Hpa(O,uc,this.Pb.Na,n):K.a.J(38854750,808,15,"Invalid smartArtShape")}else K.a.J(33863682,808,15,"Couldn't find active replaceObjectContext");return 32}WXa(n,O,ha,Aa,La){if(!this.wh)return K.a.J(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;O=this.ua.presentation;if(!this.ua.Ca||!O||this.Zb.gd(O))return 16;if(1===ha)return 32;ha=null;O=0;if(n===Ab.a.WXa){n=Object(M.a)(zf,La);if(!n)return 16;ha=n.shape;O=n.action}else if(n===
Ab.a.LGb){n=this.sa.he();if(1!==n.length)return 32;ha=n[0]}if(!ha)return K.a.J(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;n=this.Gy.t6a(ha.xX);if(!n||!this.w$a&&n&&0===n.k0)return 2;if(n&&n.lD&&n.shapeId===ha.get_shapeId())switch(this.sa.fj(),this.Ga.Bd(),O){case 0:this.Hy.ikl(n.correlationId);break;case 1:this.Hy.UA.isVisible||this.Hy.KLe(n.correlationId);break;case 2:this.Hy.Y3d(ha)}return 32}lTg(n,O,ha){if(!this.wh)return K.a.J(33698396,829,15,
"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;O=this.ua.presentation;return this.ua.Ca&&O&&!this.Zb.gd(O)?1===ha?32:this.Hy.UA.isVisible?n===Ab.a.Zbc?(this.Hy.Zbc(),32):n===Ab.a.Ybc?(this.Hy.Ybc(),32):16:16:16}}Object(h.a)(Sf,"ReplaceObjectActor",null,[]);class Lh{constructor(n,O){this.Tca=n;this.pWc=O}initialize(){this.Tca.execute(n=>{n.registerSimpleRemoteWorkflow(this.pWc.HF,this.pWc.Cnb,this.pWc.dEb,this.pWc.Rmb)})}}Object(h.a)(Lh,"ReplaceObjectAugLoopRuntimeManager",
null,[]);var Mh=d(1053),si;(function(n){n[n.textToSmartArt=0]="textToSmartArt";n[n.iconChunking=1]="iconChunking"})(si||(si={}));Object(h.b)("ReplaceObjectType",si);class Yh{constructor(n,O){this.aza=this.vR=this.la=null;this.shapeId=0;this.O4=null;this.k0=0;this.kba=!1;this.wAc=0;this.AHd=null;this.H8d=this.w8d=this.P7a=this.xS=!1;this.cmc=this.dmc=this.oPe=this.bIb=this.hmc=this.$Ia=this.emc=this.Iea=null;this.Vqb=this.ilc=0;this.zAd=this.Y1a=this.Kna=null;this.M7=!1;this.suggestions=null;this.RUb=
this.DX=0;this.vae=!1;this.Keb=null;this.Mic=!1;this.oGe=null;this.mvd=!1;this.jzb=[];this.Yh=n;this.b7b=O;this.reset()}RNa(n,O,ha,Aa,La,Bb){this.lD&&this.$U(Ba.A5c);if(!n)throw Error.argumentNull("slide");const Wb=n.xsb(new nd.a(n?n.Cb:null,O,Bb));if(!Wb)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",O));this.vR=n;this.aza=Wb;this.shapeId=O;this.O4=Bb;this.Kna=Ad.a.create().toString();this.mvd=!0;this.Y1a=ha;this.zAd=Aa;this.la=La;this.Iea=new Date;
this.k0=this.ucj();return this.correlationId}YEc(n,O,ha,Aa,La){return this.RNa(n,O,ha,Aa,La,null)}ucj(){const n=this.shape;return this.la.iconChunkingEnabled&&n&&this.O4&&n.get_isSVGBlipFilled()?1:0}$U(n){if(this.lD&&!this.kJj(this.correlationId)){const O={};O.SuggestionCount=this.DX;O.ClientSuggestionTimeoutInMs=this.RUb;O.IsApplied=this.xS;O.AppliedSuggestionId=this.xS?this.wAc.toString():"";O.AppliedSuggestionLabel=this.xS?this.AHd:"";O.IsFloatieShown=this.w8d;O.IsGalleryShown=this.H8d;O.Trigger=
this.trigger;O.RetriggerReason=this.GSk;O.ResetReason=n;O.IconId=this.la.replaceObjectIconType;O.SlideCID=this.slide.cid;O.SlideSID=this.slide.sid;O.ShapeID=this.shapeId;O.AnimId=this.la.replaceObjectAnimId;O.AnimEnabled=this.la.xEb;O.GalleryHoverEnabled=this.la.replaceObjectGalleryHoverEnabled;O.ReplaceSuggestionType=si[this.k0];O.SeeMoreButtonClicked=this.Mic;O.SeeMoreIconName=this.Mic?this.oGe:"";this.Iea&&(O.SessionLiveTimeInMs=+new Date-+this.Iea);this.O4&&(O.SmartArtSubNodeId=this.O4);this.$Ia&&
this.bIb&&this.bIb>this.$Ia&&(O.SuggestionsReadyInMs=+this.bIb-+this.$Ia);0<this.ilc&&(O.SuggestionsDisplayedForMs=this.ilc);0<this.Vqb&&(O.FloatieDisplayedForMs=this.Vqb);this.$Ia&&this.Iea&&this.$Ia>this.Iea&&(O.FloatieReadyInMs=+this.$Ia-+this.Iea);this.Iea&&this.emc&&this.Iea>this.emc&&(O.TriggeredByAugLoopInMs=+this.Iea-+this.emc);this.dmc&&this.cmc&&this.cmc>this.dmc&&(O.SuggestionAppliedInMs=+this.cmc-+this.dmc);if(0<this.suggestions.length){n=[];for(let ha=0;ha<this.suggestions.length;ha++)Array.add(n,
this.suggestions[ha].labelText);O.SuggestionLabels=Fe.c(n)}1!==this.k0||ib.a.Xa(this.Keb)||(n=Mh.a.w6a(this.Keb))&&n.hasChildNodes()&&(Mh.a.cYb(),Mh.a.qKk(this.Keb));this.Yh.hQk(this.correlationId,Fe.c(O),void 0,Object(r.a)(this,this.Icc,"onFailureCallback"));this.o9j(this.correlationId)}this.reset()}reset(){this.mvd=!1;this.vR=null;this.vae=this.H8d=this.w8d=this.P7a=this.xS=this.kba=!1;this.zAd=this.Y1a=this.Kna="";this.suggestions=[];this.wAc=0;this.AHd="";this.M7=!1;this.RUb=this.DX=0;this.cmc=
this.dmc=this.oPe=this.bIb=this.hmc=this.$Ia=this.emc=this.Iea=null;this.k0=this.Vqb=this.ilc=0;this.Keb="";this.aza=null;this.Mic=!1;this.oGe=""}kJj(n){return this.jzb?Array.contains(this.jzb,n):!1}o9j(n){this.jzb&&!Array.contains(this.jzb,n)&&(Array.add(this.jzb,n),K.a.J(25012102,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",n,this.jzb.length))}Icc(n){K.a.J(37586196,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",
n.HttpStatusCode);return!0}dre(){this.PQg(2,4)}t9j(){this.PQg(3,3)}PQg(n,O){this.b7b&&this.b7b.execute(ha=>{const Aa=Object.assign(new pn.a,{cardId:Ym.a.pqh,actionType:n,actionEngagement:O});ha.S5c(Aa)})}get slide(){return this.vR}get shape(){return this.aza}get correlationId(){return this.Kna}get trigger(){return this.Y1a}get GSk(){return this.zAd}get lD(){return this.mvd}get appSettings(){return this.la}get xX(){return new nd.a(this.slide?this.slide.Cb:null,this.shapeId,this.O4)}}Object(h.a)(Yh,
"ReplaceObjectContext",null,[1270]);class Xd{constructor(){this.va=new Hl.a}ICk(n){this.va.raiseEvent("ReplaceObjectBSA",n)}i2h(n){this.va.addHandler("ReplaceObjectBSA",n)}UMk(n){this.va.removeHandler("ReplaceObjectBSA",n)}S8g(n){this.va.raiseEvent("ReplaceObjectSPOver",n)}O3h(n){this.va.addHandler("ReplaceObjectSPOver",n)}VNk(n){this.va.removeHandler("ReplaceObjectSPOver",n)}R8g(n){this.va.raiseEvent("ReplaceObjectSPOut",n)}N3h(n){this.va.addHandler("ReplaceObjectSPOut",n)}UNk(n){this.va.removeHandler("ReplaceObjectSPOut",
n)}MCk(n){this.va.raiseEvent("ReplaceObjectViewDE",n)}$2h(n){this.va.addHandler("ReplaceObjectViewDE",n)}yNk(n){this.va.removeHandler("ReplaceObjectViewDE",n)}}Object(h.a)(Xd,"ReplaceObjectEventSource",null,[1267,1268,1269]);class Cm extends Ga{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze,Ah,Bk,Oe,sh,Ck,Hm,nm){super(Bb,n,O,ha,Aa,La,Wb,uc,Vc,bd,xd,wf,Ze,Ah,Bk,sh,Ck,Hm,nm);this.ii=uc.R8f();this.Yh=xe;this.la=Oe}VG(n,O){if(!this.wh)K.a.J(25306451,829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");
else if(!this.PTa&&O.KD.length)if(n=this.sa.he(),1!==n.length)this.ii.lD&&this.closeSession(this.ii,Ba.HT);else{n=n[0];if(this.ii.lD){if(this.ii.shapeId===n.get_shapeId())return;this.closeSession(this.ii,Ba.HT)}this.SXa(n)&&this.Oha(this.ua.Ca,n,Rb.selectShape,"")}}Eve(n,O){this.wh?this.ii.lD&&this.ii.shape===O.shape&&(n=this.ii.shape,this.closeSession(this.ii,Ba.Rjc),this.SXa(n)&&this.Oha(this.ua.Ca,n,Rb.xeb,Fb.Rjc)):K.a.J(25306453,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}ere(n,
O){O.xub&&this.HP(O.actionId)}hC(){this.ii.lD&&this.closeSession(this.ii,Ba.slideNavigation)}C_(n,O){this.ii.lD&&O.u7&&O.shapes&&Array.contains(O.shapes,this.ii.shapeId)&&this.closeSession(this.ii,Ba.xJe)}Dve(n,O){O.correlationId!==this.ii.correlationId?K.a.J(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.ii.correlationId,O.correlationId):this.ehg(O,this.ii,this.la)}Fte(){this.wh&&this.ii.P7a&&0===this.ii.k0&&!this.Zb.gd(this.ua.presentation)&&
(this.ii.P7a=!1,this.Hy.jma(this.ii.shape,!0))}Oha(n,O,ha,Aa=""){try{const La=this.ii.YEc(n,O.get_shapeId(),ha,Aa,this.la);this.ii.M7=!0;this.Hy.$mc(this.ii.correlationId);this.Yh.d5f(n.cid,n.sid,O.get_shapeId(),La,ha,this.Ht.bNc(O),this.Ht.aNc(O),void 0,Object(r.a)(this,this.Scb,"onTaskFailure"));this.la.powerPointIdeasIsEnabled&&this.ABb(La,this.ii.shapeId,this.ii.suggestions,Yk.a.pending)}catch(La){K.a.J(34152532,829,15,"GenerateSuggestion failed!! {0} ",La.message)}}Scb(n){K.a.J(36966422,829,
15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",n.HttpStatusCode);return!0}HP(n){this.wh?this.ii.lD&&!this.eSc(n)&&this.closeSession(this.ii,Ba.CJb+this.rI.x4(n)):K.a.J(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")}closeSession(n,O){n.kba&&this.Hy.jma(n.shape,!0);n.$U(O);this.la.powerPointIdeasIsEnabled&&this.ABb(n.correlationId,n.shapeId,n.suggestions,Yk.a.rGa)}}Object(h.a)(Cm,"ReplaceObjectManager",Ga,[]);var Dm=
d(21);class $m{constructor(n){this.zN=-1;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.lde=Array.clone(n)}get_current(){if(-1===this.zN||this.zN>=this.lde.length)throw Error.invalidOperation();return this.lde[this.zN]}moveNext(){this.zN++;return this.zN<this.lde.length}reset(){this.zN=-1}}Object(h.a)($m,"ArrayEnumerator",null,[145]);class Em{constructor(n){this.xFa=[];this.$$ge=this.getEnumerator;this.Q4j=n}getEnumerator(){return new $m(this.xFa)}[Symbol.iterator](){return Object(Dm.a)(this.getEnumerator())}HQc(n,
O){n&&(n.$U(O),Array.remove(this.xFa,n))}s6a(n){for(const O of this.xFa)if(O.correlationId===n)return O;return null}t6a(n){for(const O of this.xFa)if(nd.a.Qjc(n,O.xX))return O;return null}Qbg(n,O){for(const ha of this.xFa)if(ha.shapeId===n&&(!O&&!ha.O4||O&&O===ha.O4))return ha;return null}P_b(n){return this.Qbg(n,null)}R8f(){return 0<this.xFa.length?this.xFa[0]:null}RNa(n,O,ha,Aa,La,Bb){let Wb=this.t6a(new nd.a(n.Cb,O,Bb));Wb&&this.HQc(Wb,Ba.A5c);Wb=this.Q4j(n,O,ha,Aa,La,Bb);Array.add(this.xFa,Wb);
return Wb}YEc(n,O,ha,Aa,La){return this.RNa(n,O,ha,Aa,La,null)}get Dzf(){let n=0;this.xFa.forEach(O=>{O.lD&&n++});return n}}Object(h.a)(Em,"ReplaceObjectMultipleContextManager",null,[920,142]);class zj{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd){this.ua=n;this.yMg=O;this.T4j=ha;this.Ht=Bb;this.yFa=La;this.Gy=Aa;this.UA=Wb;this.Ga=uc;this.Le=Vc;this.Fa=bd;this.Sq=!1;this.Drc=-1}get wh(){return this.Sq}get Ksb(){return this.Drc}setup(){this.wh||(this.yFa.i2h(Object(r.a)(this,this.SVg,"onBeforeReplaceObjectSuggestionApply")),
this.yFa.O3h(Object(r.a)(this,this.xZg,"onReplaceObjectSuggestionPointerOver")),this.yFa.N3h(Object(r.a)(this,this.wZg,"onReplaceObjectSuggestionPointerOut")),this.Sq=!0)}dispose(){this.wh&&(this.yFa.UMk(Object(r.a)(this,this.SVg,"onBeforeReplaceObjectSuggestionApply")),this.yFa.VNk(Object(r.a)(this,this.xZg,"onReplaceObjectSuggestionPointerOver")),this.yFa.UNk(Object(r.a)(this,this.wZg,"onReplaceObjectSuggestionPointerOut")),this.Sq=!1)}SVg(n,O){if(!this.ua.Ca)throw Error.argumentNull("ActiveSlide is null");
(n=this.ua.Ca.xsb(O.xX))&&this.jma(n,!1)}xZg(n,O){this.ua.Ca&&(n=new nd.a(this.ua.Ca.Cb,O.shapeId,O.BX),(n=this.ua.Ca.xsb(n))&&this.JLe(n,O.okg))}wZg(n,O){this.ua.Ca&&(n=new nd.a(this.ua.Ca.Cb,O.shapeId,O.BX),(n=this.ua.Ca.xsb(n))&&this.F1b(n))}JLe(n,O){let ha=n;n.get_smartArtModelId()&&(ha=this.Fa.Lr(n));if(n=this.ydg(ha))this.Voh(ha,!1),n.JLe(O)}F1b(n){let O=n;n.get_smartArtModelId()&&(O=this.Fa.Lr(n));if(n=this.ydg(O))this.Voh(O,!0),n.F1b()}ydg(n){return n&&!n.get_smartArtModelId()&&Object(M.a)(133,
n.pc(this.Le))?this.T4j.yP(n):null}yKi(n){return n&&Object(M.a)(133,n.pc(this.Le))?this.yMg.yP(n):null}V_d(n){return n&&Object(M.a)(133,n.pc(this.Le))?this.yMg.QE(n):null}vhd(n){if(!this.wh)K.a.J(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(n){var O=this.yKi(n);if(O){const ha=this.Gy.t6a(n.xX);!ha||ha.kba&&this.Ksb!==ha.shapeId||(ha.kba?this.Ksb===ha.shapeId&&(O.uHc(),this.Drc=-1):(this.jma(n,!0,!(this.UA.KWa&&this.UA.isVisible&&nd.a.Qjc(n.xX,
this.UA.KWa.xX))),O.display()),ha.kba=!0)}}}iLk(){if(-1!==this.Ksb&&this.ua.Ca){var n=this.ua.Ca.jS(this.Ksb);n&&this.jma(n,!0)}}jma(n,O,ha=!0,Aa=!1){this.wh?n&&(O&&this.F1b(n),ha&&this.Y3d(n),O=this.V_d(n))&&(Aa?(O.tGc(),this.Drc=n.get_shapeId()):(this.Ksb===n.get_shapeId()&&(this.Drc=-1),O.visible&&O.dismiss(),(Aa=this.Gy.t6a(n.xX))&&n.get_shapeId()===Aa.shapeId&&(Aa.kba=!1))):K.a.J(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}$mc(n){this.UA.$mc(n)}ikl(n){if(this.wh)if(this.UA.isVisible){const O=
this.Gy.s6a(n);O&&O.lD&&O.correlationId===n&&this.F1b(O.shape);this.Y3d(O.shape)}else this.KLe(n);else K.a.J(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup")}Y3d(n){this.UA.isVisible&&this.UA.KWa&&nd.a.Qjc(this.UA.KWa.xX,n.xX)&&(this.UA.dismiss(),(n=this.V_d(this.UA.KWa.shape))&&n.root&&(n.root.style.zIndex="0"),this.Ga.Kj(Rc.a.wEb,!1))}KLe(n){const O=this.Gy.s6a(n);if(O&&O.correlationId===n&&O.lD){var ha=this.V_d(O.shape);if(ha){var Aa=ha.root;Aa?this.UA.isVisible&&
this.UA.KWa&&!nd.a.Qjc(this.UA.KWa.xX,O.xX)||(Aa=this.Ht.getBounds(Aa),this.UA.show(n,Aa.x,Aa.y),ha.root.style.zIndex=String(v.AFrameworkApplication.Ba.omb),this.Ga.Kj(Rc.a.wEb,!0),O.H8d=!0):K.a.J(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else K.a.J(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}P$g(n){this.wh?this.UA.isVisible&&this.KLe(n):K.a.J(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}Zbc(){if(this.wh){var n=
this.UA.LYd();n&&(-1===n?this.UA.fw(0,!0):(this.UA.fw(n,!1),this.UA.fw(n-1,!0)))}else K.a.J(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup")}Ybc(){if(this.wh){var n=this.UA.LYd();n+1!==this.UA.pcj()&&(-1===n?this.UA.fw(0,!0):(this.UA.fw(n,!1),this.UA.fw(n+1,!0)))}else K.a.J(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup")}Voh(n,O){n&&(n=Object(M.a)(133,n.pc(this.Le)))&&((n=n.za)?n.Sd(O):K.a.J(25306516,
829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}}Object(h.a)(zj,"ReplaceObjectPresenter",null,[955]);class Fm{constructor(){this.shapeId=this.slideCid=this.slideSid=0;this.KCb=null;this.pxe=0}}Object(h.a)(Fm,"TaskItem",null,[]);class t{constructor(n,O,ha){this.ebb=[];this.Yh=n;this.Ht=O;this.CCg=ha}dQi(n,O,ha){for(let Aa=0;Aa<this.ebb.length;Aa++)if(this.ebb[Aa].slideSid===n&&this.ebb[Aa].slideCid===O&&this.ebb[Aa].shapeId===ha)return this.ebb[Aa];return null}$hh(n){var O=this.dQi(n.slide.sid,
n.slide.cid,n.shapeId);if(O)return O.KCb=n,O.pxe++,1;const ha=Object.assign(new Fm,{slideSid:n.slide.sid,slideCid:n.slide.cid,shapeId:n.shapeId,pxe:0,KCb:null});Array.add(this.ebb,ha);n.M7=!0;O=n.correlationId;const Aa=n.slide,La=n.shape;this.Yh.d5f(Aa.cid,Aa.sid,La.get_shapeId(),O,n.trigger,this.CCg?this.Ht.bNc(La):this.Ht.a0b(La),this.CCg?this.Ht.aNc(La):this.Ht.$_b(La),()=>{this.R_g(ha)},Bb=>{this.R_g(ha);K.a.J(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",
Bb.HttpStatusCode);return!0});return 0}R_g(n){Array.remove(this.ebb,n);n.KCb&&n.KCb.lD&&(K.a.J(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",n.KCb.correlationId,n.pxe-1),this.$hh(n.KCb))}}Object(h.a)(t,"ReplaceObjectRequestManager",null,[919]);class X{constructor(n){this.Rje=!0;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.np=n}get_current(){return this.np}moveNext(){return this.Rje?(this.Rje=!1,!0):!1}reset(){this.Rje=
!0}}Object(h.a)(X,"SingleEnumerator",null,[145]);class sa{constructor(n){this.$$ge=this.getEnumerator;this.ii=n}getEnumerator(){return new X(this.ii)}[Symbol.iterator](){return Object(Dm.a)(this.getEnumerator())}HQc(n,O){n&&n===this.ii&&n.$U(O)}s6a(){return this.ii}t6a(){return this.ii}P_b(){return this.ii}Qbg(){return this.ii}R8f(){return this.ii}RNa(n,O,ha,Aa,La,Bb){this.ii.RNa(n,O,ha,Aa,La,Bb);return this.ii}YEc(n,O,ha,Aa,La){return this.RNa(n,O,ha,Aa,La,null)}get Dzf(){return this.ii.lD?1:0}}
Object(h.a)(sa,"ReplaceObjectSingleContextManager",null,[920,142]);var Qa=d(131);class kb{constructor(n,O,ha,Aa,La){this.Xca=null;this.Pzb=this.qfe=!1;this.Dka=null;this.visible=!1;this.dv=n;this.FS=O;this.Nja=ha;this.Ht=La;this.A$b=Aa;this.Sq=!1}get wh(){return this.Sq}setup(){this.wh||(this.Dka=new Cc.a,this.Xca=this.A$b.kyi(this.Dka.za),this.FS&&!this.FS.kl&&this.FS.IT&&(this.FS.IT.appendChild(this.Dka),this.Sd(!1),this.Pzb=!0,this.FS.Bza(this,3),this.visible=this.FS.KP||this.FS.Bn),this.Sq=!0)}Vm(){K.a.J(25306526,
829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")}SD(){}eq(){if(!this.wh)return K.a.J(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.qfe||!this.Xca.wh||!this.Xca.$M)return null;const n=vb.a.Zm(this.Xca.$M.za.style.left),O=vb.a.Zm(this.Xca.$M.za.style.top),ha=vb.a.Zm(this.Xca.$M.za.style.width),Aa=vb.a.Zm(this.Xca.$M.za.style.height);return new Qa.a(new $a.a(n,O),new $a.a(n+ha,O),new $a.a(n+ha,O+
Aa),new $a.a(n,O+Aa))}IP(){return!1}Rx(){}mz(){}setPosition(){}Ej(){this.Pzb=!0;this.Ss()}Nq(){this.Pzb=!0;this.Ss()}ov(){this.Pzb=!0;this.Ss()}setZIndex(n){this.Dka&&this.Dka.tC(n)}wF(){}TE(){return null}MD(){return[]}draw(){}dispose(){this.Nja();this.wh&&(this.Xca.dispose(),this.Dka.za.parentNode&&this.Dka.aq(),this.Dka=null,this.Sq=!1)}JLe(n){this.wh?(this.ljc(n),this.Ss()):K.a.J(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")}F1b(){this.wh?this.Ppa():
K.a.J(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")}ljc(n){this.wh?(this.Xca.aIa(n),this.Sd(!0)):K.a.J(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")}Ppa(){this.wh?(this.Xca.dismiss(),this.Sd(!1)):K.a.J(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")}setSelection(){}Ss(){if(this.qfe&&this.Pzb){var n=this.Ht.a0b(this.dv),O=this.Ht.$_b(this.dv);this.Bh(n,O);this.Dka&&(n=
this.Ht.F9i(this.dv),ge.a.setRotation(this.Dka.za,n));this.Pzb=!1}}Sd(n){this.qfe=n;this.Dka.Sd(n)}Bh(n,O){this.Xca&&this.Xca.Bh(n,O)}}Object(h.a)(kb,"ReplaceObjectSuggestionPreviewView",null,[1265,1266,283,284,109,955]);var Ib=d(264),Zb=d(217),Kb=d(248),Gb=d(963),jc=d(962);class vc extends Sys.EventArgs{constructor(n){super();this.shape=n}}Object(h.a)(vc,"ReplaceObjectViewDragEndEventArgs",Sys.EventArgs,[]);class Nc{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd){this.ZNg=!1;this.K8=this.mTa=null;this.ia=
La;this.we=Bb;this.zd=Wb;this.Gy=uc;this.zFa=Vc;this.A$b=Aa;this.Nja=ha;this.dv=n;this.FS=O;this.HG=!1;this.la=bd;this.Zne=xd;this.Sq=this.visible=!1}get wh(){return this.Sq}Irb(){return this.Gy.t6a(this.dv.xX)}setup(){if(!this.wh){var n=this.Irb();n=n?n.k0:0;this.ZNg=1===n;this.K8=new Cc.a;this.mTa=this.A$b.Cvi(this.K8,Nc.EBc,Object(r.a)(this,this.shk,"onFlyoutAnchorClick"),Object(r.a)(this,this.thk,"onFlyoutAnchorHover"),n);this.FS&&!this.FS.kl&&this.FS.IT&&(this.Vm(this.FS.IT),this.FS.Bza(this,
3));this.Sq=!0}}uHc(){this.wh?this.mTa&&this.mTa.uHc():K.a.J(38397254,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")}tGc(){this.wh?this.mTa&&this.mTa.tGc():K.a.J(34358810,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")}display(){if(!this.wh)K.a.J(25306629,829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.visible){this.Ss();this.mTa.show();this.visible=!0;this.gJb();var n=this.Irb();if(n){n.w8d=!0;const O=new Date;n.$Ia||(n.$Ia=
O);n.hmc=O;K.a.J(36500810,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",n.trigger,n.correlationId)}}}get root(){return this.wh?this.K8.za:(K.a.J(25306631,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)}dismiss(){if(this.wh){this.mTa.dismiss();this.visible=!1;var n=this.Irb();n&&(n.kba=!1,n.hmc&&(n.Vqb+=+new Date-+n.hmc,K.a.J(26026273,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",
n.Vqb,n.hmc,n.trigger,n.correlationId)))}else K.a.J(25306633,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")}Vm(){this.visible=!1;this.we.addCssClass(this.K8.za,"replaceObjectBody");document.body.appendChild(this.K8.za);this.zd.ESb(Object(r.a)(this,this.onResize,"onResize"));this.Ss()}SD(){}eq(){return null}IP(){return!1}Rx(){}mz(){}setPosition(){}Ej(){}Nq(){}ov(){}setZIndex(){}wF(n){if(this.wh){if(n)this.visible=!1,this.gJb();else if(this.HG){const O=new vc(this.dv);this.zFa.MCk(O)}this.HG=
n}else K.a.J(25306637,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")}TE(){return null}MD(){return[]}draw(){this.wh?this.Ss():K.a.J(25306639,829,15,"ShapeReplaceObjectView::Draw - called before setup")}setSelection(){}dispose(){this.Nja();this.wh&&(this.zd.qch(Object(r.a)(this,this.onResize,"onResize")),this.K8&&(this.K8.za.parentNode&&this.K8.aq(),this.we.removeCssClass(this.K8.za,"replaceObjectBody")),this.dismiss(),this.mTa.dispose(),this.K8=null,this.Sq=!1)}gJb(){this.K8.za.style.visibility=
this.visible?bc.a.visible:bc.a.hidden;const n=this.Irb();n&&(n.kba=this.visible)}Ss(){let n=null;var O=this.FS.IT;O&&(n=this.we.ei(O.za));n?(O=n.x-(Nc.EBc+10),this.ZNg&&this.FS&&this.FS.Gd&&(O=this.FS.Gd.Ed.Ie(this.dv.Bx,0),O=n.x+O+10),ge.a.xIe(this.K8.za,1),this.K8.setPosition(1*O,n.y),this.tql(1*O,n.y)):K.a.J(38557190,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")}tql(n,O){if(this.Zne.isVisible){var ha=this.Irb(),Aa=this.Zne.KWa;Aa&&ha&&Aa.correlationId===ha.correlationId&&
this.Zne.updatePosition(n,O)}}shk(n){if(n.Sz!==Sys.UI.MouseButton.leftButton)return!1;this.ia.Ma(Ab.a.WXa,2,Object.assign(new zf,{shape:this.dv,action:0}));return!0}thk(){if(!this.la.replaceObjectGalleryHoverEnabled)return!1;const n=this.Irb();if(n&&1===n.k0)return!1;this.ia.Ma(Ab.a.WXa,2,Object.assign(new zf,{shape:this.dv,action:1}));return!0}onResize(n,O){this.visible&&(n=null,O&&O.BF&&(n=O.BF.Ud),n&&n.Cb.equals(this.dv.slideId)&&this.Ss())}}Nc.EBc=32;Object(h.a)(Nc,"ShapeReplaceObjectView",null,
[953,954,283,284,109,955]);var ud=d(633);class Ud{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe){this.lUa=this.Ica=this.nUa=this.P3=this.ao=null;this.h3c=0;this.xie=-1;this.Zp=this.ii=null;this.we=n;this.jd=ha;this.So=O;this.ua=Aa;this.ia=La;this.uD=Vc;this.zFa=Bb;this.Gy=Wb;this.XZ=uc;this.Ga=bd;this.la=xd;this.I5j=!xe.Gj;this.Sq=this.fkb=!1}get wh(){return this.Sq}get isVisible(){return this.fkb}get KWa(){return this.ii}setup(){this.wh||(this.ao=vb.a.De(),this.ao.setAttribute("Unselectable","on"),
this.ao.style.position=bc.a.absolute,this.we.addCssClass(this.ao,"replaceObjectContainer"),this.KEe(null),document.body.appendChild(this.ao),this.r4(),this.uD.o7(Rc.a.wEb,Rc.a.kj,this.ao,()=>{},()=>{},!0),this.Sq=!0)}dispose(){this.wh&&(this.dismiss(),this.Smc(),this.ao&&this.ao.parentNode&&this.ao.parentNode.removeChild(this.ao),this.Sq=!1)}dismiss(){this.wh?(v.AFrameworkApplication.Ba.LOa(!0),this.setVisibility(!1),this.RAb.style.display=bc.a.none,this.RAb.style.zIndex="-1",this.lUa=this.Ica=null,
this.KEe(null)):K.a.J(25306570,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")}show(n,O,ha){if(!this.wh)K.a.J(25306572,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");else if(!ib.a.Xa(n)){var Aa=this.Gy.s6a(n);Aa&&Aa.correlationId===n&&Aa.lD&&!Aa.M7&&(this.ii=Aa,this.luk(n,this.ii.suggestions),this.h3c=this.ii.DX,this.ieh(),v.AFrameworkApplication.Ba.dNa(!0),this.RAb.style.zIndex=String(v.AFrameworkApplication.Ba.hpa),this.ao.style.zIndex=String(v.AFrameworkApplication.Ba.omb),
this.RAb.style.visibility=bc.a.hidden,this.RAb.style.display=bc.a.block,this.RAb.style.visibility=bc.a.visible,this.Nia()?this.we.addCssClass(this.ao,"replaceIconObjectContainer"):this.we.removeCssClass(this.ao,"replaceIconObjectContainer"),this.updatePosition(O,ha),this.setVisibility(!0))}}updatePosition(n,O){let ha,Aa;this.setPosition(0,0);if(this.Nia()){ha=n+Nc.EBc+7;Aa=O;const La=ud.a(0,0);ha+this.ao.offsetWidth>La.width&&(ha=n+Nc.EBc-this.ao.offsetWidth,Aa=O-7-this.ao.offsetHeight)}else ha=n,
Aa=O-7-this.ao.offsetHeight;this.setPosition(ha,Aa)}pcj(){return this.wh?this.h3c:(K.a.J(25306574,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),0)}LYd(){return this.wh?this.isVisible?this.ao?this.ao.querySelector(".replaceObjectSuggestionsList")?this.xie:(K.a.J(25306580,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(K.a.J(25306578,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),
-1):-1:(K.a.J(25306576,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}fw(n,O){if(!this.wh)K.a.J(25306582,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>n)&&this.isVisible)if(this.ao)if(n>=this.h3c)K.a.J(25306586,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.h3c,n);else{var ha=this.ao.querySelector(".replaceObjectSuggestionsList");
ha?(ha=ha.children)?(ha=ha[n])?O?(this.xie=n,fc.FocusManager.xr(ha)&&this.jph(ha.firstChild)):(this.ieh(),fc.FocusManager.Fml(ha)&&this.hjg(ha.firstChild)):K.a.J(25306592,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):K.a.J(25306590,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):K.a.J(25306588,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else K.a.J(25306584,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")}$mc(n){this.nUa&&(this.nUa.className="ReplaceObjectCorrelation "+n)}luk(n,O){this.KEe(n);if(n=this.Azi(n,O))O=this.zzi(),this.ao.appendChild(O),this.ao.appendChild(n),this.Nia()&&(n=this.yzi(),this.ao.appendChild(n))}KEe(n){this.ao&&(this.P3&&(this.jd.zb(ma.a.click,this.P3,Object(r.a)(this,this.jYg,"onLinkClick")),this.P3=null),this.we.Vt(this.ao),this.nUa=vb.a.De(),this.nUa.setAttribute("Unselectable",
"on"),this.nUa.className=ib.a.Xa(n)?"ReplaceObjectCorrelation":"ReplaceObjectCorrelation "+n,this.nUa.style.position=bc.a.absolute,this.nUa.style.display=bc.a.none,this.ao.appendChild(this.nUa),this.ao.style.zIndex="-1")}zzi(){const n=vb.a.tn();n.setAttribute("Unselectable","on");this.Nia()?(n.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,this.we.addCssClass(n,"replaceIconObjectContainerTitle")):(n.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,this.we.removeCssClass(n,
"replaceIconObjectContainerTitle"));this.we.addCssClass(n,"UIFont replaceObjectContainerTitle");return n}Azi(n,O){if(ib.a.Xa(n))return K.a.J(25012107,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),null;if(!O||!O.length)return K.a.J(25012109,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),null;const ha=vb.a.oWb();ha.id=n;ha.setAttribute("Unselectable","on");ha.setAttribute(ka.a.ff,ka.a.g9h);
this.we.addCssClass(ha,"replaceObjectSuggestionsList");this.Ica||(this.Ica=new ve.a);this.lUa||(this.lUa=new ve.a);for(var Aa of O)ib.a.Xa(Aa.imageData)||this.Ica.$(Aa.index,Aa.imageData),this.Nia()&&!ib.a.Xa(Aa.renderData)&&this.lUa.$(Aa.index,Aa.renderData),n=this.rci(Aa.index,Aa.labelText),ha.appendChild(n);if(this.I5j&&0<this.lUa.count&&this.Nia()&&(ib.a.Xa(this.ii.Keb)&&(this.ii.Keb=Uj.a.create().toString()),(Aa=Mh.a.w6a(this.ii.Keb))&&!Aa.hasChildNodes())){Aa.style.position=bc.a.absolute;Aa.style.left=
"0px";Aa.style.top="0px";for(let La of this.lUa.values)n=vb.a.FB(),n.src=La,n.style.display=bc.a.block,n.style.position=bc.a.absolute,Aa.appendChild(n);Mh.a.yTb()}return ha}yzi(){this.P3=vb.a.tn();this.P3.setAttribute("Unselectable","on");this.P3.setAttribute("tabindex","-1");this.P3.setAttribute(ka.a.ff,ka.a.vId);this.we.addCssClass(this.P3,"UIFont replaceObjectContainerLink");this.Nia()&&this.la.pptSmartArtSubNodeIconChangeEnabled&&this.la.E7a&&(this.P3.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,
this.jd.pb(ma.a.click,this.P3,Object(r.a)(this,this.jYg,"onLinkClick")));const n=vb.a.De();n.appendChild(this.P3);return n}r4(){this.ao&&(this.jd.pb(ma.a.click,this.ao,Object(r.a)(this,this.onClick,"onClick")),this.XZ.addHandler(this.ao,ma.a.Rf,Object(r.a)(this,this.cQc,"inputKeyApplyHandler")),this.So.pb(ma.a.pointerOver,this.ao,Object(r.a)(this,this.iC,"onPointerOver")),this.So.pb(ma.a.pointerOut,this.ao,Object(r.a)(this,this.Oy,"onPointerOut")))}Smc(){this.ao&&(this.jd.zb(ma.a.click,this.ao,Object(r.a)(this,
this.onClick,"onClick")),this.XZ.removeHandler(this.ao,ma.a.Rf,Object(r.a)(this,this.cQc,"inputKeyApplyHandler")),this.So.zb(ma.a.pointerOver,this.ao,Object(r.a)(this,this.iC,"onPointerOver")),this.So.zb(ma.a.pointerOut,this.ao,Object(r.a)(this,this.Oy,"onPointerOut")))}iC(n){n=this.U0d(n.Hc);this.jph(n);return!0}Oy(n){n=this.U0d(n.Hc);this.hjg(n);return!0}cQc(n){if(this.isVisible&&!n.ctrlKey&&!n.altKey&&(!n.shiftKey||n.keyCode===ra.a.tq&&this.Nia()))if(n.keyCode===ra.a.Xp||n.keyCode===ra.a.wO)n.preventDefault(),
(n=this.ao.querySelector(":focus"))&&n.firstChild.click();else if(n.keyCode===ra.a.tq&&this.Nia()){const O=this.ao.querySelector(":focus");O&&this.P3&&(O===this.P3?(n.preventDefault(),n.stopPropagation(),this.fw(0,!0)):O.parentNode&&O.parentNode.className&&0<=O.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(n.preventDefault(),n.stopPropagation(),this.fw(this.LYd(),!1),fc.FocusManager.xr(this.P3)))}}onClick(n){if(n.Sz!==Sys.UI.MouseButton.leftButton)return!1;var O=this.U0d(n.Hc);if(!this.T$d(O)||
!this.MLj(O))return!0;n=this.mZi(O);const ha=this.n0b(O);O=this.scj(O);ib.a.Xa(n)||ib.a.Xa(ha)||(n=Object.assign(new Zd.a,{SuggestionSid:parseInt(ha),ShapeId:this.ii.shapeId,CorrelationId:n,ActiveSlideCid:this.ua.Ca.cid,ActiveSlideSid:this.ua.Ca.sid,Label:O,SmartArtSubNodeId:this.ii.O4?this.ii.O4:null,ReplaceObjectType:this.ii.k0}),this.ia.Ma(Ab.a.RMa,2,n));return!0}jYg(){this.ii&&(this.ii.Mic=!0);this.t2d();this.ia.processAction(Ab.a.sUb,2);return!0}jph(n){n&&this.T$d(n)&&(n=this.n0b(n),ib.a.Xa(n)||
(n=this.Nia()?this.lUa.Kb(n)?this.lUa.ga(n):"":this.Ica.Kb(n)?this.Ica.ga(n):"",ib.a.Xa(n)||(n=new jc.a(this.ii.shapeId,n,this.ii.O4),this.zFa.S8g(n))))}hjg(n){n&&this.T$d(n)&&(n=new Gb.a(this.ii.shapeId,this.ii.O4),this.zFa.R8g(n))}U0d(n){if(!n)throw Error.argumentNull("sourceElement");return"a"===n.nodeName.toLowerCase()?n:n.parentNode}mZi(n){return n?n.parentNode.parentNode.id:null}n0b(n){if(!n)return null;n=n.id.split("_");return 2!==n.length?null:n[1]}scj(n){return n?n.title:null}T$d(n){return!!n&&
!ib.a.Xa(n.className)&&-1!==n.className.indexOf("ObjectSuggestionContainer")}MLj(n){return!!n&&!ib.a.Xa(n.className)&&-1===n.className.indexOf("ReplaceObjectSuggestionLoading")}rci(n,O){const ha=this.Ica.Kb(n);var Aa=ha?this.Ica.ga(n):Lg.a.bK(lb.a.Xla);ha||K.a.J(38340484,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");const La=vb.a.FB();La.setAttribute("Unselectable","on");La.src=Aa;La.title=O;La.setAttribute(ka.a.ff,ka.a.eP);this.we.addCssClass(La,"replaceObjectSuggestionThumbnail");
Aa=vb.a.Raa();Aa.id="ROS_"+n;Aa.setAttribute("Unselectable","on");Aa.title=O;Aa.setAttribute(ka.a.ff,"none");let Bb=this.Nia()?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";this.ii.xS&&this.ii.wAc.toString()===n&&(Bb+="Selected");this.we.addCssClass(Aa,Bb);ha||this.we.addCssClass(Aa,"ReplaceObjectSuggestionLoading");Aa.appendChild(La);n=this.we.yRf();n.setAttribute("Unselectable","on");n.setAttribute("tabindex","-1");n.setAttribute(ka.a.ff,ka.a.eP);n.setAttribute(ka.a.ht,
O);n.appendChild(Aa);return n}setPosition(n,O){this.wh?(0>n&&(n=0),0>O&&(O=0),this.ao.style.left=this.we.Nc(n),this.ao.style.top=this.we.Nc(O)):K.a.J(25306626,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")}setVisibility(n){if(this.ao){if(this.ii)if(n)this.ii.oPe=new Date,this.ii.t9j();else{let O;(O=this.ii).ilc=O.ilc+(+new Date-+this.ii.oPe)}this.ao.style.visibility=n?bc.a.visible:bc.a.hidden;this.fkb=n;this.Ga.Kj(Rc.a.wEb,n)}}ieh(){this.xie=-1}Nia(){return!!this.ii&&
1===this.ii.k0}get RAb(){this.Zp&&"undefined"!==typeof this.Zp||(this.Zp=this.we.De(),this.Zp.setAttribute("id","ModalDiv"),this.we.addCssClass(this.Zp,"cui-modalDiv"),this.Zp.setAttribute("Unselectable","on"),document.body.appendChild(this.Zp),Ib.a.instance.pb(ma.a.pointerDown,this.Zp,Object(r.a)(this,this.u7c,"onModalPointerDown")),Ib.a.instance.pb(ma.a.CQ,this.Zp,Object(r.a)(this,this.v7c,"onModalPointerUp")),Ib.a.instance.pb(ma.a.uec,this.Zp,Object(r.a)(this,this.ijk,"onModalPointerMove")),Ib.a.instance.pb(ma.a.pointerOut,
this.Zp,Object(r.a)(this,this.jjk,"onModalPointerOut")),Zb.a.instance.pb(ma.a.click,this.Zp,Object(r.a)(this,this.hjk,"onModalClick")),Kb.a.instance.pb(ma.a.WAb,this.Zp,Object(r.a)(this,this.kve,"onModalMouseWheel")));return this.Zp}u7c(){return!0}v7c(){return this.t2d()}ijk(){return!0}jjk(){return!0}hjk(){return this.t2d()}kve(){return!0}t2d(){if(!this.ii||!this.ii.slide)return!0;const n=this.ii.shape;if(!n)return!0;this.ia.Ma(Ab.a.WXa,2,Object.assign(new zf,{action:2,shape:n}));return!0}}Object(h.a)(Ud,
"ReplaceObjectSuggestionsGalleryView",null,[917,955]);class Ge{constructor(n,O,ha,Aa){this.U4j=n;this.Ht=O;this.ua=ha;this.la=Aa}$Vi(n){if(!this.ua.Ca)return!1;n=this.ua.Ca.jS(n);return this.Dnc(n)}Dnc(n){return!(n&&n.get_shapeId()&&n.hasText&&this.Ht.F8a(n))||n.get_shapeRotation()||n.Iv||n.bja||n.xx||!this.U4j.validate(n)?!1:!0}QNj(n){return!Array.contains(this.la.replaceObjectDisabledTriggers,n)}}Object(h.a)(Ge,"ReplaceObjectValidationHelper",null,[]);class ch{constructor(n,O,ha,Aa,La,Bb,Wb,uc,
Vc){this.kr=this.QZ=null;this.Sq=!1;this.BW=n;this.jd=O;this.So=ha;this.HN=Aa;this.Qca=La;this.Qd=Wb;this.la=Bb;this.u9a=Vc}get wh(){return this.Sq}tGc(){this.la.xEb?this.kr.setAttribute("Src",this.Qd.rk("BLUEBOLT_Deactivated.gif")):this.kr.style.opacity=".3";this.u9a.ijh(Object(r.a)(this,this.dismiss,"dismiss"))}uHc(){this.la.xEb?this.kr.setAttribute("Src",this.Qd.rk("BLUEBOLT_Reactivated.gif")):this.kr.style.opacity="initial";this.u9a.disabled=!1}show(){this.la.xEb?this.kr.setAttribute("Src",this.Qd.rk("BLUEBOLT_Entrance.gif")):
this.kr.setAttribute("Src",this.Qd.rk("LightningIdeasOOUI_blue_32x.png"))}dismiss(){this.la.xEb?(this.kr.setAttribute("Src",this.Qd.rk("BLUEBOLT_Exit.gif")),this.u9a.V_k(()=>{this.BW.za.style.visibility=bc.a.hidden})):(this.kr.setAttribute("Src",""),this.BW.za.style.visibility=bc.a.hidden)}setup(){this.wh||(this.BW?(this.QZ=new Cc.a,this.QZ.za.style.visibility=bc.a.inherit,this.QZ.za.style.position=bc.a.absolute,this.kr=vb.a.FB(),this.kr.setAttribute("Unselectable","on"),this.kr.setAttribute(ka.a.ff,
ka.a.eP),this.kr.className="gifFloatie",this.QZ.za.appendChild(this.kr),this.BW.appendChild(this.QZ),this.r4()):K.a.J(38072903,829,15,"parentElement is null"),this.Sq=!0)}MXg(n){let O;switch(this.la.replaceObjectIconType){case 7:O="BLUEBOLT_Hover_on.gif";break;case 8:O="BLUEBOLT_HoverWhite_On.gif";break;default:O="BLUEBOLT_Hover_on.gif"}this.kr.setAttribute("Src",this.Qd.rk(O));return this.Qca(n)}onBlur(){let n;switch(this.la.replaceObjectIconType){case 7:n="BLUEBOLT_Hover_off.gif";break;case 8:n=
"BLUEBOLT_HoverWhite_Off.gif";break;default:n="BLUEBOLT_Hover_off.gif"}this.kr.setAttribute("Src",this.Qd.rk(n));return!0}r4(){this.HN&&this.jd.pb(ma.a.click,this.kr,this.HN);this.Qca&&(this.So.pb(ma.a.pointerOver,this.kr,Object(r.a)(this,this.MXg,"onHover")),this.So.pb(ma.a.pointerOut,this.kr,Object(r.a)(this,this.onBlur,"onBlur")))}FRe(){this.HN&&this.jd.zb(ma.a.click,this.kr,this.HN);this.Qca&&(this.So.zb(ma.a.pointerOver,this.kr,Object(r.a)(this,this.MXg,"onHover")),this.So.zb(ma.a.pointerOut,
this.kr,Object(r.a)(this,this.onBlur,"onBlur")))}dispose(){this.dismiss();this.FRe();this.Sq=!1}}Object(h.a)(ch,"GifFlyoutAnchor",null,[987,955]);class Nh{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze){this.kr=this.Vu=null;this.BW=n;this.SS=O;this.y_j=ha;this.D_j=Aa;this.IGg=xe.replaceObjectIconType;this.DBg=xe.replaceObjectAnimId;this.EBg=xe.xEb;this.JFa=Bb;this.A$b=La;this.jd=Wb;this.So=uc;this.HN=Vc;this.Qca=bd;this.we=xd;this.C6j=wf;this.u9a=Ze;this.Sq=!1}get mXb(){return 1===this.C6j?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:
this.u9a.disabled?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip}get wh(){return this.Sq}setup(){this.wh||(this.Vu=new Cc.a,this.kr=this.A$b.jyi(),this.Vu.za.style.visibility=bc.a.inherit,this.Rga(),this.Sq=!0)}tGc(){this.u9a.ijh(Object(r.a)(this,this.dismiss,"dismiss"));this.Ppa();this.ljc();this.Vu.rri()||this.Vu.gt("replaceObjectGrayedFlyoutAnchor")}show(){this.wh?this.ljc(this.EBg):K.a.J(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")}uHc(){this.u9a.disabled=
!1;this.Ppa();this.ljc();this.Vu.deb("replaceObjectGrayedFlyoutAnchor")}ljc(n=!1){this.wh?this.kr.aIa(this.Q1i(n),""):K.a.J(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")}Q1i(n){const O=this.JFa.zOd(this.SS,this.SS,this.y_j,this.D_j,this.mXb,null);this.we.addCssClass(this.Vu.za,"replaceObjectFlyoutAnchorBase");this.we.addCssClass(this.Vu.za,"replaceObjectFlyoutAnchor"+this.IGg);n&&(this.we.addCssClass(this.Vu.za,"replaceObjectFlyoutAnchorAnimBase"),this.we.addCssClass(this.Vu.za,
"replaceObjectFlyoutAnchorAnim"+this.DBg));return O}Ppa(){this.wh?(this.kr.clear(),this.we.removeCssClass(this.Vu.za,"replaceObjectFlyoutAnchorBase"),this.we.removeCssClass(this.Vu.za,"replaceObjectFlyoutAnchor"+this.IGg),this.EBg&&(this.we.removeCssClass(this.Vu.za,"replaceObjectFlyoutAnchorAnimBase"),this.we.removeCssClass(this.Vu.za,"replaceObjectFlyoutAnchorAnim"+this.DBg))):K.a.J(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")}dispose(){this.wh&&(this.FRe(),this.Vu&&
this.Vu.za.parentNode&&this.Vu.aq(),this.dismiss(),this.kr.dispose(),this.Vu=null,this.Sq=!1)}dismiss(){this.wh?(this.Ppa(),this.BW.za.style.visibility=bc.a.hidden):K.a.J(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")}Rga(){this.BW?(this.Vu.za.style.width=this.we.Nc(this.SS),this.Vu.za.style.height=this.we.Nc(this.SS),this.Vu.za.setAttribute(ka.a.ff,ka.a.St),this.BW.appendChild(this.Vu),this.kr.Rga(this.Vu.za),this.r4()):K.a.J(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")}Fcb(){return!0}r4(){this.HN&&
this.jd.pb(ma.a.click,this.Vu.za,this.HN);this.jd.pb(ma.a.doubleClick,this.Vu.za,Object(r.a)(this,this.Fcb,"onDoubleClick"));this.Qca&&(this.So.pb(ma.a.pointerOver,this.Vu.za,this.Qca),this.So.pb(ma.a.pointerOver,this.Vu.za.firstChild,this.Qca),this.So.pb(ma.a.pointerOver,this.Vu.za.firstChild.firstChild,this.Qca))}FRe(){this.HN&&this.jd.zb(ma.a.click,this.Vu.za,this.HN);this.jd.zb(ma.a.doubleClick,this.Vu.za,Object(r.a)(this,this.Fcb,"onDoubleClick"));this.Qca&&(this.So.zb(ma.a.pointerOver,this.Vu.za,
this.Qca),this.So.zb(ma.a.pointerOver,this.Vu.za.firstChild,this.Qca),this.So.zb(ma.a.pointerOver,this.Vu.za.firstChild.firstChild,this.Qca))}}Object(h.a)(Nh,"ReplaceObjectFlyoutAnchor",null,[987,955]);class ti{constructor(n,O){this.$y=null;this.$h=n;this.we=O;this.Sq=!1}get wh(){return this.Sq}get $M(){return this.$y}setup(){this.wh||(this.$y=new Cc.a,this.Rga(),this.Sq=!0)}Rga(){this.$h?(this.$h.appendChild(this.$M.za),this.we.addCssClass(this.$M.za,"replaceObjectPreviewContainer"),this.$M.setVisibility(!1)):
K.a.J(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")}aIa(n){if(this.wh){if(n=this.Zpa(n))this.gma(),this.$M.za.appendChild(n),this.$M.setVisibility(!0)}else K.a.J(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")}Bh(n,O){this.wh?this.$M.Bh(n,O):K.a.J(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")}dispose(){this.wh&&(this.dismiss(),this.$M&&this.$M.za.parentNode&&(this.$M.aq(),this.we.removeCssClass(this.$M.za,
"replaceObjectPreviewContainer")),this.$y=null)}dismiss(){this.wh?(this.gma(),this.$M.setVisibility(!1)):K.a.J(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")}Zpa(n){if(!ib.a.Xa(n)){const O=vb.a.FB();O.setAttribute("Unselectable","on");O.src=n;O.style.height="100%";O.style.width="100%";return O}return null}gma(){this.$M.za.firstChild&&this.$M.za.removeChild(this.$M.za.firstChild)}}Object(h.a)(ti,"ReplaceObjectPreviewImageView",null,[955]);var Oh=d(674);class Pf{constructor(n,
O,ha,Aa,La,Bb,Wb){this.jd=n;this.So=O;this.we=ha;this.JFa=Aa;this.la=La;this.Qd=Bb;this.BFg=Wb}Cvi(n,O,ha,Aa,La){n=kd.Qul(this.la.replaceObjectIconType,La)?new ch(n,this.jd,this.So,ha,Aa,this.la,this.Qd,this.we,this.BFg):new Nh(n,O,"per","PowerPointDesigner_32x32x32",this,this.JFa,this.jd,this.So,ha,Aa,this.we,this.la,La,this.BFg);n.setup();return n}kyi(n){n=new ti(n,this.we);n.setup();return n}jyi(){return new Oh.a(this.we)}}Object(h.a)(Pf,"ReplaceObjectViewFactory",null,[]);class ei{constructor(n,
O,ha){this.we=n;this.ua=ha;this.lOg=O}bNc(n){if(!n)throw Error.argumentNull("shape");var O=n.BT;n=this.gpb(O.TopLeft);O=this.gpb(O.TopRight);return $a.a.Nl(n,O)}aNc(n){if(!n)throw Error.argumentNull("shape");var O=n.BT;n=this.gpb(O.TopRight);O=this.gpb(O.BottomRight);return $a.a.Nl(n,O)}a0b(n){return this.bNc(n)*this.Veg()}$_b(n){return this.aNc(n)*this.Veg()}F9i(n){if(!n)throw Error.argumentNull("shape");var O=n.BT;n=this.gpb(O.TopLeft);O=this.gpb(O.TopRight);return Lb.a.uT($a.a.WJ(n,O))}r5f(){return this.getBounds(this.lOg.Mc.qC)}getBounds(n){return this.we.ei(n)}Veg(){const n=
this.lOg.Mc;return n?n.wV:1}gpb(n){return new $a.a(n.X,n.Y)}F8a(n){return n?!!this.ua.Ca&&this.ua.Ca.Cb.equals(n.slideId):!1}}Object(h.a)(ei,"ReplaceObjectViewHelper",null,[]);var Rj=d(428);class ok{constructor(n,O,ha){this.j_=this.GZ=null;this.GS=n;this.R4j=O;this.L1c=ha}get HF(){return"ReplaceObjectWacALWorkflow"}get proto(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'}get Cnb(){this.GZ||
(this.GZ=Object.assign(new tn.a,{name:"LambdaBefore_ReplaceObjectWacAL",inputSchema:Rj.a.CJe,outputSchema:Rj.a.CJe,func:Object(r.a)(this,this.Z8a,"lambdaBeforeFunc")}));return this.GZ}get Rmb(){return null}get dEb(){this.j_||(this.j_=Object.assign(new tn.a,{name:"LambdaRemote_ReplaceObjectWacAL",inputSchema:Rj.a.CJe,outputSchema:"ShapeTextConvertable",func:Object(r.a)(this,this.Oae,"lambdaRemoteFunc")}));return this.j_}Z8a(n,O,ha){if(n&&this.R4j.g8d())if(n){try{var Aa=ef.a(n.ContextId)}catch(La){K.a.J(37041409,
375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.HF);ha(null);return}this.L1c.QNj(Aa.t)?this.L1c.$Vi(Aa.shapeId)?ha(n):(K.a.J(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.HF),ha(null)):(K.a.J(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.HF),ha(null))}else ha(null),K.a.J(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.HF);else K.a.J(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.HF),ha(null)}Oae(n,O,ha){n?
n?this.GS.execute(Aa=>{Aa.Xhc(n.Topic,n.Data,n.ContextId,La=>{this.EHa(La)},La=>{this.CHa(La)},ha)}):ha(null):ha(null)}EHa(n){if(!v.AFrameworkApplication.Xg&&n&&n.data){var O=n.data.state;if(O){try{var ha=ef.a(n.data.je)}catch(Aa){O(null);K.a.J(36804442,375,10,"Try parse aug response failed:{0}",Aa.message);return}O(ha)}}}CHa(n){!v.AFrameworkApplication.Xg&&n&&n.data&&(n=n.data.state)&&n(null)}}Object(h.a)(ok,"ReplaceObjectWacALWorkflow",null,[613]);class Si{constructor(){this.Kse=null}Dnc(n){return this.validate(n)?
this.Kse?this.Kse.Dnc(n):!0:!1}X0k(n){this.Kse=n}}Object(h.a)(Si,"ReplaceObjectWall",null,[]);class Yl extends Si{constructor(){super();this.Ht=null}zcg(n){const O=this.Ht.a0b(n);n=this.Ht.$_b(n);var ha=O*n;const Aa=this.Ht.r5f().width,La=this.Ht.r5f().height;ha=ha/(Aa*La)*100;K.a.J(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",O,n,Aa,La,ha);return ha}}Object(h.a)(Yl,"AreaRatioWall",Si,[]);class Dp extends Yl{constructor(n,
O){super();this.x2j=n;this.Ht=O}validate(n){return this.zcg(n)<=this.x2j}}Object(h.a)(Dp,"MaxAreaRatio",Yl,[]);class vn extends Si{constructor(n,O){super();this.u2j=n;this.Ht=O}validate(n){return this.Ht.$_b(n)<=this.u2j}}Object(h.a)(vn,"MaxShapeHeight",Si,[]);class ep extends Si{constructor(n,O){super();this.z2j=n;this.Ht=O}validate(n){return this.Ht.a0b(n)<=this.z2j}}Object(h.a)(ep,"MaxShapeWidth",Si,[]);class Ep extends Yl{constructor(n,O){super();this.I2j=n;this.Ht=O}validate(n){return this.zcg(n)>=
this.I2j}}Object(h.a)(Ep,"MinAreaRatio",Yl,[]);var fp=d(36);class Ph extends Si{constructor(n,O){super();this.H2j=n;this.Fa=O}validate(n){return this.Z6i(n,this.Fa)>=this.H2j}Z6i(n,O){if(!n)return 0;let ha=0;O.RI(n,Aa=>{Aa.Sa(fp.a.Vp)&&(Aa=Aa.getValue(fp.a.Vp))&&0<Aa.length&&ha++});return ha}}Object(h.a)(Ph,"MinParagraphCount",Si,[]);class gp extends Si{constructor(n,O){super();this.F2j=n;this.Ht=O}validate(n){return this.Ht.$_b(n)>=this.F2j}}Object(h.a)(gp,"MinShapeHeight",Si,[]);class wn extends Si{constructor(n,
O){super();this.L2j=n;this.Ht=O}validate(n){return this.Ht.a0b(n)>=this.L2j}}Object(h.a)(wn,"MinShapeWidth",Si,[]);class Jn{constructor(n,O,ha){this.oda=null;this.la=n;this.Fa=O;this.yAb=ha;this.init(this.la.replaceObjectClientWalls)}validate(n){return this.oda?this.oda.Dnc(n):!0}init(n){n=this.kAi(n);this.Odi(n)}kAi(n){const O={};if(ib.a.Xa(n))return O;n=n.split(";");for(const ha of n)ib.a.Xa(ha)||(n=ha.split(":"),2===n.length?O[n[0]]=n[1]:K.a.J(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",
ha));return O}Odi(n){const O=[];"MinParagraphCount"in n&&Array.add(O,new Ph(Tc.d(n,"MinParagraphCount",0),this.Fa));"MinShapeHeight"in n&&Array.add(O,new gp(Tc.b(n,"MinShapeHeight",0),this.yAb));"MaxShapeHeight"in n&&Array.add(O,new vn(Tc.b(n,"MaxShapeHeight",Number.MAX_VALUE),this.yAb));"MinShapeWidth"in n&&Array.add(O,new wn(Tc.b(n,"MinShapeWidth",0),this.yAb));"MaxShapeWidth"in n&&Array.add(O,new ep(Tc.b(n,"MaxShapeWidth",Number.MAX_VALUE),this.yAb));"MinShapeAreaRatio"in n&&Array.add(O,new Ep(Tc.b(n,
"MinShapeAreaRatio",0),this.yAb));"MaxShapeAreaRatio"in n&&Array.add(O,new Dp(Tc.b(n,"MaxShapeAreaRatio",Number.MAX_VALUE),this.yAb));for(n=0;n<O.length-1;n++)O[n].X0k(O[n+1]);0<O.length&&(this.oda=O[0])}}Object(h.a)(Jn,"ReplaceObjectWalls",null,[918]);class Oo{constructor(){this.K=null;this.tW=this.Yje=this.Gke=!1}get name(){return"PowerPointWebEditor.ReplaceObject"}Yb(n){this.K=n;(this.tW=this.K.resolve("PowerPointWebEditor.IApplicationContext").kd.zg)&&this.K.register(Cn.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>
new Cn.a(v.AFrameworkApplication.Be,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));n.register(Xd,"PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers").ma().na(()=>
new Xd);n.register(ei,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper").ma().na(()=>new ei(n.resolve("PowerPoint.IBrowserHelperManager"),n.resolve("PowerPointWebEditor.IActiveSlideViewManager"),n.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));n.register(917,"PowerPointWebEditor.IReplaceObjectGalleryView").ma().na(()=>new Ud(n.resolve("PowerPoint.IBrowserHelperManager"),n.resolve("Common.IPointerInputManager"),n.resolve("Common.IClickInputManager"),n.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
n.resolve("Common.IActionManagerExtended"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),n.resolve("PowerPointWebEditor.IInputHandlerManager"),n.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),n.resolve("PowerPointWebEditor.IFocusManager"),n.resolve("PowerPointWebEditor.IApplicationSettings"),n.resolve("Common.IBrowserUtils")));n.register(918,"PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls").ma().na(()=>
new Jn(n.resolve("PowerPointWebEditor.IApplicationSettings"),n.resolve("PowerPointWebEditor.IShapeReader"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")));n.register(Ge,"PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper").ma().na(()=>new Ge(n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),n.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),n.resolve("PowerPointWebEditor.IApplicationSettings")));
n.register(919,"PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager").ma().na(()=>new t(n.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),n.resolve("PowerPointWebEditor.IApplicationSettings").keepCalculateZoomInNativeConsistentWithClientFixIsEnabled));n.register(920,"PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager").ma().na(()=>n.resolve("Common.IAppSettingsManager").ka(zb.a.pa(473))?new Em((O,
ha,Aa,La,Bb,Wb)=>{const uc=new Yh(n.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),n.Oa("PowerPointWebEditor.IDesignerServiceProvider"));uc.RNa(O,ha,Aa,La,Bb,Wb);return uc}):new sa(new Yh(n.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),n.Oa("PowerPointWebEditor.IDesignerServiceProvider"))));n.register(921,"PowerPointWebEditor.IReplaceObjectManager").ma().na(()=>n.resolve("Common.IAppSettingsManager").ka(zb.a.pa(473))?new Ac(n.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),
n.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),n.resolve("PowerPointWebEditor.IFocusManager"),n.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),n.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),n.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),n.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),n.resolve("PowerPointWebEditor.IPptSelectionManager"),n.resolve("Common.IActionManagerExtended"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),
n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager"),n.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),n.resolve("PowerpointPresence.IPresenceEventHandlers"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),n.resolve("PowerPointWebEditor.View.IViewEventSource"),
n.resolve("PowerPointWebEditor.IApplicationSettings"),n.resolve("PowerPointWebEditor.IActionNameResolver"),n.resolve("Common.ITaskManager"),n.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),n.Oa("PowerPointWebEditor.IDesignerServiceProvider")):new Cm(n.resolve("PowerPointWebEditor.IFocusManager"),n.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),n.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),n.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),
n.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),n.resolve("PowerPointWebEditor.IPptSelectionManager"),n.resolve("Common.IActionManagerExtended"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),n.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
n.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),n.resolve("PowerpointPresence.IPresenceEventHandlers"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),n.resolve("PowerPointWebEditor.View.IViewEventSource"),n.resolve("PowerPointWebEditor.IApplicationSettings"),n.resolve("PowerPointWebEditor.IActionNameResolver"),n.resolve("Common.ITaskManager"),n.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),n.Oa("PowerPointWebEditor.IDesignerServiceProvider")));n.register(zj,
"PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").ma().na(()=>new zj(n.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),n.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>"),n.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),
n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),n.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),n.resolve("PowerPointWebEditor.IFocusManager"),n.resolve("Box4.IPageView").Na,n.resolve("PowerPointWebEditor.IShapeReader")));n.register(kd,"PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer").ma().na(()=>new kd(n.resolve("PowerPointWebEditor.IApplicationSettings"),n.resolve("Common.ITaskManager")));n.register(Pf,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory").ma().na(()=>
new Pf(n.resolve("Common.IClickInputManager"),n.resolve("Common.IPointerInputManager"),n.resolve("PowerPoint.IBrowserHelperManager"),n.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),n.resolve("PowerPointWebEditor.IApplicationSettings"),n.resolve("PowerPoint.IPathManager"),n.resolve("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer")));n.register(259,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>").ma().na(()=>new Dd.a((O,
ha)=>{let Aa=null;const La=Object(M.a)(133,O.pc(n.resolve("Box4.IPageView").Na));La&&!La.kl&&La.IT&&(Aa=new Nc(O,La,ha,n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),n.resolve("Common.IActionManagerExtended"),n.resolve("PowerPoint.IBrowserHelperManager"),n.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),
n.resolve("PowerPointWebEditor.IApplicationSettings"),n.resolve("PowerPointWebEditor.IReplaceObjectGalleryView")),Aa.setup());return Aa}));n.register(259,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>").ma().na(()=>new Dd.a((O,ha)=>{let Aa=null;const La=Object(M.a)(133,O.pc(n.resolve("Box4.IPageView").Na));La&&!La.kl&&La.IT&&(Aa=new kb(O,La,ha,n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")),
Aa.setup());return Aa}));n.register(ok,"PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>new ok(this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager"),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper")));n.register(Lh,"PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").ma().na(()=>
new Lh(this.K.Oa("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow")));n.register(Sf,"PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").ma().na(()=>new Sf(n.resolve("PowerPointWebEditor.IPptSelectionManager"),n.resolve("Common.IActionManagerExtended"),n.resolve("PowerPointWebEditor.IFocusManager"),n.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),n.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
n.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),n.resolve("PowerPointWebEditor.View.IViewEventSource"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),n.resolve("Common.Transaction.ITransactionFactory"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),n.resolve("PowerPointWebEditor.View.IPPTPageView"),n.resolve("PowerPointWebEditor.IShapeReader")));
n.register(Bd,"PowerPointWebEditor.ReplaceObject.ReplaceIconManager").ma().na(()=>new Bd(n.resolve("PowerPointWebEditor.IPptSelectionManager"),n.resolve("PowerPointWebEditor.View.IViewEventSource"),n.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),n.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),n.resolve("PowerPointWebEditor.IShapeReader"),n.resolve("PowerPointWebEditor.IApplicationSettings"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),
n.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),n.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),n.resolve("PowerpointPresence.IPresenceEventHandlers"),n.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),n.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingStatusChecker"),n.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),n.resolve("PowerPointWebEditor.IActionNameResolver"),n.resolve("PowerPointWebEditor.Core.IUnifiedAppState")))}init(){this.tW&&
this.K.resolve("PowerPointWebEditor.PodsInfoSender");const n=this.K.resolve("Common.IAppSettingsManager");n.gf(()=>{const O=new Date;n.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?K.a.J(592232657,324,50,"PPTO TestEcsFeature Client Flight Enabled."):K.a.J(592232655,324,50,"PPTO TestEcsFeature Client Flight Disabled.");if(this.Gke=n.ka(zb.a.pa(463)))n.ka(zb.a.pa(499))&&this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").initialize(),
this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").setup();if(this.Yje=n.ka(zb.a.pa(676)))this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").setup();K.a.J(40158946,829,50,"ReplaceObject::Callback duration:{0}",+new Date-+O)})}dispose(){this.Gke&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose());this.Yje&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").dispose())}static main(){e.a.instance.Ec(nc.a(new Oo,0))}}Object(h.a)(Oo,"PPTWebEditorReplaceObjectPackage",null,[2,3]);var Fp=d(268),Po=d(387),Ml=d(1033);class vo{constructor(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=
this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(h.a)(vo,"AppSettings",null,[]);class fi{constructor(){this.perfTelemetryInfos=
this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}}Object(h.a)(fi,"ControllerFactoryParameters",null,[]);var Zr=d(712),hp=d(320);class ui{}ui.none="None";ui.vhFailedToLoadVersionList="VHFailedToLoadVersionList";ui.vhFailedToGetDownloadToken="VHFailedToGetDownloadToken";ui.vhFailedToParseVersionList="VHFailedToParseVersionList";ui.vhFetchFailed="VHFetchFailed";ui.vhVersioningNotEnabled="VHVersioningNotEnabled";ui.vhFileNotFound="VHFileNotFound";ui.vhVersionTooOld=
"VHVersionTooOld";ui.Owl="VHFailedToRenderThumbnails";ui.Nwl="VHFailedToRenderSlide";ui.Mwl="VHFailedToRenderNotes";ui.Kwl="VHFailedToRenderDiff";ui.Pwl="VHFailedToShowAnimaitonIcon";ui.Qwl="VHFailedToShowHiddenEffect";ui.Lwl="VHFailedToRenderInitPresInfo";Object(h.a)(ui,"ErrorName",null,[]);class Jf{constructor(){this.LFa=new yd.a;this.LFa.add(0,ui.none);this.LFa.add(100,ui.vhFailedToLoadVersionList);this.LFa.add(101,ui.vhFailedToGetDownloadToken);this.LFa.add(102,ui.vhFailedToParseVersionList);
this.LFa.add(103,ui.vhFetchFailed);this.LFa.add(104,ui.vhVersioningNotEnabled);this.LFa.add(105,ui.vhFileNotFound);this.LFa.add(106,ui.vhVersionTooOld);this.dGa=new yd.a;this.dGa.add(0,ui.none);this.dGa.add(100,ui.Owl);this.dGa.add(101,ui.Nwl);this.dGa.add(102,ui.Mwl);this.dGa.add(103,ui.Kwl);this.dGa.add(104,ui.Pwl);this.dGa.add(105,ui.Qwl);this.dGa.add(106,ui.Lwl)}get E5k(){return this.LFa}get bxl(){return this.dGa}static Pcg(){Jf.OFe||(Jf.OFe=new Jf);return Jf.OFe}}Jf.WIf="ErrorCode";Jf.OFe=null;
Object(h.a)(Jf,"VersionHistoryTelmetryHelper",null,[]);class Zl{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze,Ah,Bk,Oe){this.$ac=this.zD=this.PFg=this.b1c=this.pwb=this.Y2=this.qqe=this.MW=this.BG=null;this.Zsa=-1;this.Wwb=null;if(!Oe)throw Error.argumentNull("clientRequestManager");this.ia=n;this.bC=O;this.vi=ha;this.Ha=Aa;this.qc=La;this.RUa={};this.Ga=Bb;this.ph=Wb;this.Kzb={};this.hc=Vc;this.W3c={};this.Y3j=uc;this.H8=bd;this.Za=xd;this.Qee=[];xe&&(this.PFg=xe,this.PFg.execute(sh=>{this.zD=
sh}));this.IS=wf;this.gh=Ze;this.Jde=Ah;this.wac=Bk;this.Dz=Oe}wb(){this.ia.ya(G.a.yph,H.a.frame,Object(r.a)(this,this.Qal,"showVersionHistoryDialogAction"));this.Ha.pptEnablePreviousVersionsOptionForOneDriveConsumer||this.ia.ya(Ab.a.v4g,H.a.frame,Object(r.a)(this,this.Hye,"pptoShowFileVersion"));this.ia.ya(Ab.a.Dwl,H.a.frame,Object(r.a)(this,this.Qnj,"handleVersionHistoryCopySlides"))}Qal(n,O,ha){if(1===ha)return n=!1,this.Za.Wba&&(n=!0),n?2:32;2===ha&&(v.AFrameworkApplication.oN("Microsoft.Office.Server.Powerpoint.Web.IDocsPptPPTVersionHistorySaveACopyOverFlowMenuSettings"),
v.AFrameworkApplication.oN("Microsoft.Office.Server.Powerpoint.Web.IDocsPptVersionHistoryDeleteVersions"),this.$ac=Ad.a.create().toString(),m.ULS.sendTraceTag(512508634,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.$ac),Jb.c(Ab.a.fok,!0),this.RUa.VersionHistoryLaunchSessionId=this.$ac,this.Kzb.VersionHistoryLaunchSessionId=this.$ac,this.RUa.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.b1c=[],this.BG||(this.BG=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new fi,
{ulsLogger:new Po.a,serviceBase:this.Ha.getSetting("VersionHistoryWebServiceBase"),latestStreamServiceBase:this.Ha.ka("PPTVHPodsBootEnabled")?this.Ha.getSetting("PODSLatestServiceBase")+"&PodSID="+this.Ha.getSetting("PodSID"):"",docId:v.AFrameworkApplication.$g,appSettings:Object.assign(new vo,{appName:100,wdEnableDownloadTokens:!0,retryCount:this.Ha.getSetting("PodVHRetryCount"),wdEnableSaveACopy:this.hc.An,wdEnableRestore:this.hc.An,userSessionId:v.AFrameworkApplication.userSessionId,wacCluster:this.Ha.Ia("WacCluster"),
uiLocale:this.Ha.XGa?this.Ha.XGa:"en-us",isRtl:v.AFrameworkApplication.isRtl,disabledChangeGates:this.Ha.Ia("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.Ha.ka("PPTVersionHistorySaveACopyOverFlowMenuIsEnabled"),wdEnableDeleteVersions:this.Ha.ka("PPTVersionHistoryDeleteVersionsIsEnabled")}),perfTelemetryInfos:this.b1c}))),this.BG&&this.BG.setDisableSaveACopy(v.AFrameworkApplication.AL),this.Ral());return 32}Hye(n,O,ha){return 1===ha&&this.Za.Wba?2:this.ia.processAction(G.a.QKe,ha)}Qnj(n,
O,ha){if(1===ha)return 32;this.MW.onCopySlides();return 32}Ral(){var n;if(!document.getElementById("VersionHistoryOverlay")){this.LIk();this.HIk();this.IIk();this.CIk();this.AIk();this.GIk();this.FIk();this.DIk();const O=document.createElement("div");O.id="VersionHistoryOverlay";O.style.width="100%";O.style.zIndex="998";O.style.display="block";O.style.position="absolute";O.style.top="0px";if(this.Ha.ka("RegionComposerIsEnabled")){const ha=(null===(n=document.getElementById("HeaderRegion"))||void 0===
n?void 0:n.offsetHeight)||0;O.style.top=ha+"px";O.style.bottom="0px";O.style.height=`calc(100vh - ${ha}px)`}else O.style.height="calc(100% + "+ua.AFrame.Zhd+"px)";document.getElementById("WACInnerFrame").appendChild(O);this.qqe=this.BG.createVersionHistoryDialog(O);this.Dfb()}document.getElementById("VersionHistoryOverlay").style.display="block";this.BG.getTipVersion&&this.Ha.ka("PPTVHPodsBootEnabled")&&this.BG.getTipVersion();this.BG.getVersions("");this.FXh()}FXh(){try{this.Wwb=this.Y3j.GZi();for(let n=
0;n<this.Wwb.length;n++)this.ph.ap(this.Wwb[n]);this.ph.SJ(Rc.a.Enc)}catch(n){m.ULS.sendTraceTag(512508633,822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",n)}}wBi(){try{if(this.Wwb)for(let n=0;n<this.Wwb.length;n++)this.ph.SJ(this.Wwb[n]);else m.ULS.sendTraceTag(512508632,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");this.ph.ap(Rc.a.Enc)}catch(n){m.ULS.sendTraceTag(512508631,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",
n)}}LIk(){this.BG.getFullAppErrorEvent().addListener(n=>{try{const O=Jf.Pcg().E5k.ga(n);this.Kzb[Jf.WIf]=O;m.ULS.sendTraceTag(512508630,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",O,this.$ac)}catch(O){m.ULS.sendTraceTag(512508629,822,10,"Exception in FullAppErrorEvent call back: {0}.",O)}})}HIk(){this.BG.getVersionsReadyEvent().addListener(n=>{this.beh(n.containerDiv);this.N0h(n.versions);this.Ga.hX("VersionHistoryOverlay",!0);try{this.Y2&&this.Y2.DownloadUrl.length&&this.MW&&
(this.jDh(),this.elg(),this.MW.onVersionSelected(this.Y2,this.pwb,this.RUa),this.NMf())}catch(O){m.ULS.sendTraceTag(512508628,822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",O)}})}N0h(n){const O=this.MW.getAppDataStore();for(const ha of n)O.AddVersionInfoToStore(ha)}IIk(){this.BG.getVersionSelectedEvent().addListener(n=>{this.Y2=n.currentVersion;this.pwb=n.baseVersion;if(this.MW&&this.Y2.DownloadUrl.length)try{this.jDh(),this.elg(),this.MW.onVersionSelected(n.currentVersion,
n.baseVersion,this.RUa),this.$Jk(),this.NMf()}catch(O){m.ULS.sendTraceTag(512508627,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",O)}})}$Jk(){const n=this.H0b(2);n&&(Hb.a.addHandler(n,ma.a.Rf,Object(r.a)(this,this.xz,"keyDownHandler")),$b.a.instance.pb(n,Object(r.a)(this,this.CB,"contextMenuHandler")))}Spl(){const n=this.H0b(2);n&&(Hb.a.removeHandler(n,ma.a.Rf,Object(r.a)(this,this.xz,"keyDownHandler")),$b.a.instance.zb(n,Object(r.a)(this,this.CB,"contextMenuHandler")))}xz(n){try{if(n.shiftKey&&
n.keyCode===ra.a.vna||n.keyCode===ra.a.vJa){const O=Ml.a.create(ma.a.contextMenu,n,1);this.CB(O)}}catch(O){m.ULS.sendTraceTag(512508626,822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",O)}}CB(n){if(1===n.Qf){const O=this.H0b(2);O&&(n.clientPoint.x=pc.a.tKc(O)+lb.a.Xpa,n.clientPoint.y=pc.a.uKc(O)+lb.a.Xpa)}return 32===this.ia.Ma(Ab.a.GPf,2,n)}CIk(){this.BG.getDownloadTokenReadyEvent().addListener(n=>{try{if(m.ULS.sendTraceTag(512508625,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),
this.pwb)if(n&&n.updatedVersions&&2<=n.updatedVersions.length){let O=null,ha=null;const Aa=Zl.Q_b(this.Y2),La=Zl.Q_b(this.pwb);for(const Bb of n.updatedVersions){const Wb=Zl.Q_b(Bb);Aa===Wb?O=Bb:La===Wb&&(ha=Bb);if(O&&ha)break}O&&ha?(this.Y2=O,this.pwb=ha,this.MW.diff(this.Y2,this.pwb)):m.ULS.sendTraceTag(512508623,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Aa,La)}else m.ULS.sendTraceTag(512508622,
822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");else m.ULS.sendTraceTag(512508624,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(O){m.ULS.sendTraceTag(512508621,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",O)}})}GIk(){this.BG.getSaveACopySelectedEvent().addListener(n=>{m.ULS.sendTraceTag(512508620,
822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",n);this.Ha.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&Zl.Gdk();let O=v.AFrameworkApplication.gvb;this.Ha.ka("VHSaveACopyForOdcOnSpoEnabled")&&(O=32===this.ia.processAction(Ab.a.xye,1));n=O?this.ia.Ma(Ab.a.xye,2,{["FileDownloadUrl"]:n}):this.ia.Ma(G.a.Jeb,2,{["FileDownloadUrl"]:n});32!==n?(Jb.c(Ab.a.gNf,!1),m.ULS.sendTraceTag(512508619,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",n)):Jb.c(Ab.a.gNf,
!0)})}mwh(n,O){try{(new Promise((ha,Aa)=>{this.BG.setRestoreInProgress();this.H8.iDc(this.Za.uk,this.Za.podSessionId,this.Za.presentationId.string,this.Ha.getSetting(zb.a.pa(361)),this.Za.D9,!1,!0,()=>{ha(!0)},La=>{Aa("ClosePopWacSessionSync:: "+La.error.message)})})).then(()=>{(new Promise((ha,Aa)=>{this.H8.ndd(this.Za.presentationId.string,n,()=>{ha(!0)},La=>{Aa("RestoreFileVersion:: "+La.error.message)})})).then(()=>{const ha=Date.now()-O;m.ULS.sendTraceTag(512508618,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",
ha);this.Kzb.RestoreSucceededTime=ha;this.ia.processAction(Ab.a.refresh,2);Jb.c(Ab.a.bDc,!0)}).catch(ha=>{const Aa=Date.now()-O;this.BG.setRestoreFailedAtServer(()=>{this.ia.processAction(Ab.a.refresh,2)});m.ULS.sendTraceTag(512508617,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",ha,Aa);this.Kzb.RestoreFailedTime=Aa;Jb.c(Ab.a.bDc,!1)})})}catch(ha){m.ULS.sendTraceTag(512508616,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",ha.message),Jb.c(Ab.a.bDc,
!1)}}FIk(){this.BG.getRestoreVersionSelectedEvent().addListener(n=>{m.ULS.sendTraceTag(512508615,832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",n);const O=Date.now();this.zD?(this.Qee=this.zD.HZb(),0<this.Qee.length?(m.ULS.sendTraceTag(512508614,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",this.Qee.length),Jb.c(Ab.a.bDc,!1),this.BG.setCoauthRestoreError(),this.Ha.ka("PPTVersionHistoryRestoreSurveyEnabled")&&Zl.TPj()):this.mwh(n,O)):(m.ULS.sendTraceTag(512508613,
832,10,"VersionHistoryPaneActor: presence manager is null"),this.mwh(n,O))})}DIk(){this.BG.getDownloadVersionSelectedEvent().addListener(n=>{m.ULS.sendTraceTag(512508612,832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");n=new bf.QueryStringBuilder(n);n.nj(rh.a.Y1g,v.AFrameworkApplication.fileName);n=this.ia.Ma(G.a.downloadACopy,2,{["FileDownloadUrl"]:n.toString()});32!==n?(Jb.c(Ab.a.fNf,!1),m.ULS.sendTraceTag(512508611,832,10,"Download version failed with result: {0}",
n)):Jb.c(Ab.a.fNf,!0)})}jDh(){for(const n of this.b1c){const O=n.TelemetryEventKey?n.TelemetryEventKey:n.telemetryEventKey?n.telemetryEventKey:"",ha=n.TelemetryEventData?n.TelemetryEventData:n.telemetryEventData?n.telemetryEventData:"";ib.a.Xa(O)||ib.a.Xa(ha)||(this.RUa[O]=ha)}}NMf(){this.b1c=[];this.RUa={}}AIk(){this.BG.getCloseSelectedEvent().addListener(()=>{this.Ha.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&Zl.SPj();this.zNf()})}zNf(){this.wBi();this.Ga.n4("VersionHistoryOverlay");document.getElementById("VersionHistoryOverlay").style.display=
"none";this.Ha.NGf&&(this.Y2=null);m.ULS.sendTraceTag(512508610,822,50,ef.c(this.Kzb))}beh(n){try{if(this.MW)nf.setIsPageLoadForFirstTime(!1),this.MW.switchParentViewContainer(n);else{nf.setIsPageLoadForFirstTime(!0);const O=new PowerPointVersionHistory.AppBootSettings;O.RenderServiceBase="";O.IsRtl=v.AFrameworkApplication.isRtl;const ha=new PowerPointVersionHistory.AppCallbackBag;ha.animationDecoratorCallback=Object(r.a)(this.bC,this.bC.gOd,"createAnimationOrTransitionStar");ha.notesIconDecoratorCallback=
Object(r.a)(this,this.kxi,"createNotesIcon");ha.addToF6LoopCallback=Object(r.a)(this,this.w0h,"addToF6Loop");ha.copySlideCallback=Object(r.a)(this,this.copySlideCallback,"copySlideCallback");ha.reportViewerErrorCallback=Aa=>{this.Kzb[Jf.WIf]=Jf.Pcg().bxl.ga(Aa);106!==Aa&&103!==Aa||this.BG.setViewerError(!0);m.ULS.sendTraceTag(512508609,822,50,"Versions viewer error: {0}",Aa);0!==Aa&&(v.AFrameworkApplication.zo(Sa.a.Fh(406)),Wc.Health.instance.recordQosError("VersionHistoryFailed",["VersionHistoryACE"],
!1,!1,!0,!1,null));return!0};O.IsHighContrast=!1;this.vi&&(O.IsHighContrast=this.vi.isInHighContrastMode);O.IsHighContrast&&(O.ClientColorSettings=this.vi.highContrastColors.foregroundTextColor+"_"+this.vi.highContrastColors.backgroundColor+"_"+this.vi.highContrastColors.linkColor);if(this.qc){const Aa=this.qc.cQa();O.DefaultSlideWidth=Aa.width;O.DefaultSlideHeight=Aa.height}O.UserSessionId=v.AFrameworkApplication.userSessionId;O.VersionViewerCssUrl=this.Ha.versionHistoryViewerCssUrl;O.ProgressImageResourceUrl=
Lg.a.bK(lb.a.Xla);O.ThumbnailShareOptimizationEnabled=this.Ha.pptvhThumbnailShareOptimizationEnabled;O.SlidePrefetchSettings=Object.assign(new PowerPointVersionHistory.SlidePrefetchSettings,{SlidePrefetchEnabled:this.Ha.ka("PPTVHSlidePrefetchEnabled"),SlidePrefetchAhead:this.Ha.getSetting("PPTVHSlidePrefetchAhead"),SlidePrefetchBehind:this.Ha.getSetting("PPTVHSlidePrefetchBehind"),SlidePrefetchChunkSize:this.Ha.getSetting("PPTVHSlidePrefetchChunkSize"),SlidePrefetchDelay:this.Ha.getSetting("PPTVHSlidePrefetchDelay")});
O.FileExtension=void 0!==this.Ha.Qla&&null!==this.Ha.Qla?ib.a.nV(this.Ha.Qla).toLowerCase():"";O.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;O.NotesButtonLabel=ResourceStrings.L_Notes;O.SynchronizerTimeout=this.Ha.getSetting("PptVersionHistorySynchronizerTimeout");O.IsRtl=v.AFrameworkApplication.isRtl;O.IsCopySlidesEnabled=!0;O.SlidePaneLabel=ResourceStrings.L_SlidePaneLabelVH;O.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;O.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;
O.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;O.Lcid=v.AFrameworkApplication.lcid;O.EnableOverflowXOnSlideAndNotePane=this.Ha.ka("PodVHEnableOverflowXOnSlideAndNotePane");O.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;O.IsModernCatchUpUxEnable=this.Ha.ka(zb.a.pa(1166));O.IsRevisionTrackingFlyoutEnabled=xh.a("EnableRevisionTrackingFlyoutForVH");O.RevisionTrackingFlyoutContent=ResourceStrings.l_SlideIsChanged;this.MW=new PowerPointVersionHistory.AppVersionController(O,n,ha)}}catch(O){this.BG.setViewerError(!0),
m.ULS.sendTraceTag(512508608,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",O)}}kxi(){return Fa.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,ResourceStrings.L_Notes)}Dfb(){const n=this.Ga.Bc("VersionHistoryOverlay");n.parent=ua.AFrame.kj;n.HK=!0;n.REe=!0;n.vaa(O=>{O&&"dialog/modal"===O.name?this.BG.setSaveACopyCanceled():O&&O.name===ua.AFrame.fO||(this.Zsa=-1,this.ixh(!0))});this.ph.q1("VersionHistoryOverlay");this.ph.Mfd(Rc.a.Enc,
O=>{this.ixh(O)});this.ph.pjc(Rc.a.Enc,()=>{2===this.Zsa&&Sys.UI.DomElement.addCssClass(this.H0b(2),"PPTVHViewerElementSelected");3===this.Zsa&&Sys.UI.DomElement.addCssClass(this.H0b(3),"PPTVHViewerElementSelected")})}ixh(n){try{const O=this.HNc();(this.Zsa=this.Z5i(n))?1===this.Zsa?this.qqe.then(ha=>{ha.enterHeaderFocusTrapZone();return null}):O&&fc.FocusManager.xr(document.getElementById(O[this.Zsa])):this.qqe.then(ha=>{ha.enterFocusTrapZone();return null})}catch(O){m.ULS.sendTraceTag(512508579,
822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",O)}}Z5i(n){const O=this.HNc();let ha=this.Zsa;do if(n?O&&(ha=(ha+1)%O.length):O&&(ha=0<ha?ha-1:O.length-1),!ha||1===ha||O&&"none"!==document.getElementById(O[ha]).style.display)return ha;while(ha!==this.Zsa);return 0}elg(){const n=Zl.Q_b(this.Y2);this.W3c[n]||(this.W3c[n]=["VersionListPane","vhHeader"],this.Zsa=-1)}HNc(){if(!this.Y2)return this.Ha.NGf?["VersionListPane","vhHeader"]:null;const n=Zl.Q_b(this.Y2);return this.W3c[n]?
this.W3c[n]:null}H0b(n){const O=this.HNc();return O&&O.length>n?document.getElementById(O[n]):null}w0h(n){try{const O=this.HNc();O&&O.push(n)}catch(O){m.ULS.sendTraceTag(512508578,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",O)}return!0}copySlideCallback(n){const O=Ad.a.create().toString();m.ULS.sendTraceTag(512508577,832,50,"Execute CopySlideCallback - correlationid : {0}",O);const ha=this.IS.qOd(1,n.SlideIds.length),Aa={};Aa.WacSessionId=v.AFrameworkApplication.userSessionId;
Aa.CallerCorrelationId=O;var La={};La.Source=n.Source;La.SlideIds=n.SlideIds;La.CcpId=ha.Dp;La.PackageAccessKey=ha.Py;n=JSON.stringify(La);La=String.format("{0}{1}",this.Ha.podsWebServiceBase,"vhcopyslide.ashx");const Bb=Date.now();try{if(this.Dz.Jj(La,2,n,Aa,!1,0,Wb=>{Zl.Jwl(Wb,Bb,O)},Wb=>{Zl.Iwl(Wb,Bb,O)},null,null),this.gh.contentWindow&&this.gh.contentWindow.document&&this.gh.contentWindow.document.body){vb.a.SCc(this.gh);const Wb=vb.a.Raa();Wb.innerText=vb.a.kcc;Wb.setAttribute(hp.a.Dp,ha.Dp);
Wb.setAttribute(hp.a.eE,ha.eE);Wb.setAttribute(hp.a.count,ha.objectCount.toString());const uc=Zr.a(ha.dataType);Wb.setAttribute(hp.a.type,uc);Wb.setAttribute(hp.a.location,ha.location);Wb.setAttribute(hp.a.Py,ha.Py);this.gh.contentWindow.document.body.appendChild(Wb);this.Jde.Oeb(this.gh);this.wac.copy(this.gh)}else m.ULS.sendTraceTag(512508576,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(Wb){m.ULS.sendTraceTag(512508575,832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",
Wb)}return!0}dispose(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&this.zNf();this.Spl()}static Q_b(n){return n.RevisionID?n.RevisionID:n.revisionID?n.revisionID:""}static Jwl(n,O,ha){const Aa=Date.now();try{JSON.parse(n.data.je).IsCopied?m.ULS.sendTraceTag(512508574,832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",Aa-O,ha):m.ULS.sendTraceTag(512508573,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",
Aa-O,ha)}catch(La){m.ULS.sendTraceTag(512508572,832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",La,ha)}}static Iwl(n,O,ha){const Aa=Date.now();m.ULS.sendTraceTag(512508571,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",Aa-O,n.data?n.data.tf:-1,ha)}static SPj(){const n=u.a.instance.qb("Common.ISystemInitiatedFeedback");n?(n.logActivity("VersionHistoryExited",null),n.logActivity("VersionHistoryCheckExited",
null)):m.ULS.sendTraceTag(512508570,822,50,"ISystemInitiatedFeedback was null")}static Gdk(){const n=u.a.instance.qb("Common.ISystemInitiatedFeedback");n?n.logActivity("VersionHistoryExited",null):m.ULS.sendTraceTag(512508569,822,10,"ISystemInitiatedFeedback was null")}static TPj(){const n=u.a.instance.qb("Common.ISystemInitiatedFeedback");n?n.logActivity("VersionHistoryRestoreCoauthFailed",null):m.ULS.sendTraceTag(512508568,822,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}}
Object(h.a)(Zl,"VersionHistoryPaneActor",null,[986,109]);class pk{constructor(){this.Puc=this.Ea=null}get name(){return"PowerPointWebEditor.VersionHistory"}Yb(n){this.Ea=n}init(){v.AFrameworkApplication.fa.gf(Object(r.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){v.AFrameworkApplication.sae()?this.Ea.resolve("PowerPointWebEditor.IApplicationSettings").C9d?m.ULS.sendTraceTag(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected"):
(m.ULS.sendTraceTag(39711108,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),Jc.a.get_instance().Ak(7,()=>{Ef.a(this.Ea)("versionHistory").catch(n=>m.ULS.sendTraceTag(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",n)).then(()=>this.enk()).catch(n=>m.ULS.sendTraceTag(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",n))})):m.ULS.sendTraceTag(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}enk(){this.VVb();
return null}VVb(){this.Ea.register(Zl,"PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor").na(()=>new Zl(v.AFrameworkApplication.Va,this.Ea.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.Ea.resolve("Common.Utils.IHighContrastDetector"),this.Ea.resolve("PowerPointWebEditor.IApplicationSettings"),this.Ea.resolve("PowerPointWebEditor.IPresentationReader"),fc.FocusManager.instance(),Fp.a.instance,this.Ea.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.Ea.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Ea.resolve("PowerPointWebEditor.IPopWebService"),this.Ea.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Ea.Oa("PowerpointPresence.IPresenceManager"),this.Ea.resolve("PowerPointWebEditor.IClipServiceManager"),this.Ea.resolve("PowerPointWebEditor.IDesignModeManager").dAa,this.Ea.resolve("PowerPoint.IBrowserHelperManager"),this.Ea.resolve("PowerPointWebEditor.ISystemClipboard"),v.AFrameworkApplication.Be)).ma();this.Puc=this.Ea.resolve("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor");
this.Puc.wb()}dispose(){this.Puc&&this.Puc.dispose()}}Object(h.a)(pk,"PPTWebEditorVersionHistoryPackageManager",null,[2,3]);var $r=d(449),Gp=d(213),hr;(function(n){n[n.anyone=0]="anyone";n[n.organization=1]="organization"})(hr||(hr={}));Object(h.b)("AccessControlEnum",hr);var $p=d(368);class bo{constructor(){this.token=this.timeStamp=null}}Object(h.a)(bo,"CachedAccessToken",null,[]);class as{constructor(n){this.Mde={};this.YYj=n}Ufi(n,O){if(!ib.a.Xa(n)&&!ib.a.Xa(O)){const ha=new bo;ha.token=O;ha.timeStamp=
new Date;this.Mde[n]=ha}}q6f(n){return n in this.Mde&&(n=Object(M.a)(bo,this.Mde[n]),+new Date-+n.timeStamp<6E4*this.YYj)?n.token:null}}Object(h.a)(as,"AccessTokenCache",null,[]);class Lk{constructor(){this.reject=this.resolve=this.frame=this.Tda=this.oTe=this.resource=this.appId=this.authority=this.id=null;this.Vgb=0;this.oEe=null;this.yec=0;this.qxh=!1}}Object(h.a)(Lk,"DirectAuthRequest",null,[]);class bs{constructor(n){this.Z9b={};this.la=n;this.mAb=new as(this.la.Wuk);window.addEventListener("message",
Object(r.a)(this,this.sQk,"requestCompletionMessageHandler"),!1)}x9f(n){const O={},ha=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Aa;for(;Aa=ha.exec(n);)O[Object(M.a)(String,Aa[1])]=Object(M.a)(String,Aa[2]);return O}sQk(n){if("data"in n){var O;({Ev:O}=ef.d(n.data)).returnValue&&O&&"DirectAuthRequestID"in O&&this.Lsb(O)}}Lsb(n){try{const Aa=n.DirectAuthRequestID;if(Aa in this.Z9b){var O=null,ha=Object(M.a)(Lk,this.Z9b[Aa]);if(ha&&ha.id===Aa){K.a.J(594405506,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",
Aa,"Timeouted"in n,"FromPolling"in n);window.clearTimeout(ha.Vgb);delete this.Z9b[Aa];window.clearTimeout(ha.yec);const La=new $p.a;La.IsSuccess=!1;La.ErrorCode="";La.ErrorMessage="";La.Token="";"Timeouted"in n?(K.a.J(592238722,833,10,"DirectAuth: Request timed out with host: "+window.location.host),La.ErrorCode="Timeout",La.ErrorMessage="No response received in time for the authentcation request",ha.resolve(La)):"PopupWindowClosed"in n&&ha.Tda?(La.ErrorCode="User_aborted",La.ErrorMessage="User aborted log in by closing the popup window",
ha.resolve(La)):(ha.frame?O=this.x9f(ha.frame.contentWindow.location.hash):ha.Tda&&!ha.Tda.closed&&(O=this.x9f(ha.Tda.location.hash)),"access_token"in O?(La.IsSuccess=!0,La.Token=Object(M.a)(String,O.access_token),this.mAb&&this.mAb.Ufi(ha.oEe,La.Token),ha.resolve(La)):(La.ErrorCode="error"in O?Object(M.a)(String,O.error):"unknown",0<=Array.indexOf(this.la.Yuk,La.ErrorCode)&&ha.qxh&&ha.frame&&!ha.Tda?this.ruk(ha.authority,ha.appId,ha.resource,ha.oTe,this.la.Zuk).then(Bb=>{ha.resolve(Bb)}).catch(Bb=>
{ha.reject(Bb)}):(La.ErrorMessage="error_description"in O?Object(M.a)(String,O.error_description):"unknown",ha.resolve(La))));ha.frame?document.body.removeChild(ha.frame):ha.Tda&&!ha.Tda.closed&&ha.Tda.close()}else K.a.J(594068425,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",Aa)}else K.a.J(594405508,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(n))}catch(Aa){K.a.J(594375829,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+
Aa.message)}}TDc(n){const O=window.location.protocol,ha=window.location.host;K.a.J(594113502,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",O,ha,"ffc-powerpoint.officeapps.live.com"===ha||"ppc-powerpoint.officeapps.live.com"===ha);if(void 0===n||null===n){n=window.location.pathname;const Aa=n.lastIndexOf("/");n=0<=Aa?n.substring(0,Aa+1):""}return O+"//"+ha+n+"WacDirectAuth.html"}gnl(n,O,ha,Aa,La,Bb=!1){return this.$al(n,O,ha,Aa,La,Bb)}ruk(n,O,ha,Aa,La){if(ib.a.Xa(n))throw Error.argumentNull("authority");
if(ib.a.Xa(O))throw Error.argumentNull("appId");if(ib.a.Xa(ha))throw Error.argumentNull("resource");if(ib.a.Xa(Aa))throw Error.argumentNull("userUPN");const Bb=!ib.a.Xa(Aa)&&Aa.indexOf("@")<Aa.indexOf("."),Wb=this.TDc("/p/"),uc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",n,O,encodeURIComponent(ha),encodeURIComponent(Wb));if(this.mAb){const xd=this.mAb.q6f(uc);if(!ib.a.Xa(xd))return K.a.J(593782154,
833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(xe=>{const wf=new $p.a;wf.IsSuccess=!0;wf.ErrorCode="";wf.ErrorMessage="";wf.Token=xd;xe(wf)})}const Vc=Ad.a.create().toString(),bd=String.format("{0}&state={1}",uc,Vc);return new Promise((xd,xe)=>{const wf=new Lk;wf.authority=n;wf.appId=O;wf.resource=ha;wf.oTe=Aa;wf.resolve=xd;wf.reject=xe;wf.id=Vc;wf.oEe=uc;wf.Tda=window.open("",Vc,"width=400, height=600");wf.Tda?(this.Z9b[Vc]=wf,wf.Tda.location.replace(bd),K.a.J(593782152,833,
50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",Vc,Bb),this.hrh(wf,1E3*La).then(()=>{const Ze={};Ze.DirectAuthRequestID=Vc;Ze.FromPolling=!0;this.Lsb(Ze)}).catch(Ze=>{"WindowClosed"===Object(M.a)(String,Ze)&&(Ze={},Ze.DirectAuthRequestID=Vc,Ze.PopupWindowClosed=!0,K.a.J(593782150,833,10,"DirectAuth: Popup window closed for request with ID of: "+Vc),this.Lsb(Ze))}),wf.Vgb=window.setTimeout(()=>{const Ze={};Ze.DirectAuthRequestID=Vc;Ze.Timeouted=!0;K.a.J(593782148,833,
10,"DirectAuth: Popup request timedout with ID of: "+Vc);this.Lsb(Ze)},1E3*La)):(K.a.J(593364752,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",Vc),xe=new $p.a,xe.IsSuccess=!1,xe.ErrorCode="fail_to_open_popup",xe.ErrorMessage="Failed to create popup window!",xe.Token="",xd(xe))})}$al(n,O,ha,Aa,La,Bb){if(ib.a.Xa(n))throw Error.argumentNull("authority");if(ib.a.Xa(O))throw Error.argumentNull("appId");if(ib.a.Xa(ha))throw Error.argumentNull("resource");if(ib.a.Xa(Aa))throw Error.argumentNull("userUPN");
const Wb=!ib.a.Xa(Aa)&&Aa.indexOf("@")<Aa.indexOf(".");var uc=this.TDc("/p/");const Vc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",n,O,encodeURIComponent(ha),encodeURIComponent(uc));if(this.mAb){const xe=this.mAb.q6f(Vc);if(!ib.a.Xa(xe))return K.a.J(594134859,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(wf=>{const Ze=new $p.a;Ze.IsSuccess=!0;Ze.ErrorCode="";
Ze.ErrorMessage="";Ze.Token=xe;wf(Ze)})}const bd=Ad.a.create().toString();uc=Wb?String.format("{0}&login_hint={1}&state={2}",Vc,encodeURIComponent(Aa),bd):String.format("{0}&state={1}",Vc,bd);const xd=document.createElement("iframe");xd.style.display="none";xd.src=uc;return new Promise((xe,wf)=>{const Ze=new Lk;Ze.authority=n;Ze.appId=O;Ze.resource=ha;Ze.oTe=Aa;Ze.frame=xd;Ze.resolve=xe;Ze.reject=wf;Ze.id=bd;Ze.oEe=Vc;Ze.qxh=Bb;document.body.appendChild(xd);K.a.J(594405504,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",
bd,Wb);this.hrh(Ze,1E3*La).then(()=>{const Ah={};Ah.DirectAuthRequestID=bd;Ah.FromPolling=!0;this.Lsb(Ah)});Ze.Vgb=window.setTimeout(()=>{const Ah={};Ah.DirectAuthRequestID=bd;Ah.Timeouted=!0;K.a.J(594405464,833,10,"DirectAuth: Silent request timedout with ID of: "+bd);this.Lsb(Ah)},1E3*La);this.Z9b[bd]=Ze})}hrh(n,O){return new Promise((ha,Aa)=>{const La=O/50;let Bb=0;n.yec=window.setInterval(()=>{try{Bb++>La&&(window.clearInterval(n.yec),K.a.J(594068418,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",
O,La),Aa(""));const Wb=n.frame?n.frame.contentWindow:n.Tda;if(!Wb||Wb.closed)window.clearInterval(n.yec),K.a.J(594068416,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),Aa("WindowClosed");let uc=null,Vc=null;try{uc=Wb.location.href,Vc=Wb.location.hash}catch(bd){}uc&&"about:blank"!==uc?ib.a.Xa(Vc)||(window.clearInterval(n.yec),ha(Vc)):K.a.J(594068386,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===uc)}catch(Wb){K.a.J(594068384,
833,15,"DirectAuth: WindowHashPoller: threw exception {0}",Wb.message)}},50)})}}Object(h.a)(bs,"DirectAuthHelper",null,[]);class ir{constructor(){this.welcomeScreenErrorImageUrl=this.welcomeScreenBackgroundImageUrl=this.hostElement=null;this.urlBarHeightInPercentage=this.baseZIndex=0;this.reactionsBarLayerHostId=this.dialogLayerHostId=this.urlBarLayerHostId=this.calloutContainerId=this.welcomeScreenLayerHostId=null;this.isPowerpointLiveReactionEnabled=this.showTryAgainButton=!1;this.resourceCDNPath=
this.onboardingScreenHostId=null;this.enableNewLiveWelcomeScreen=this.enablePrefetchLiveResource=!1;this.podsUrl=this.userSessionId=null}}Object(h.a)(ir,"ILiveActorSettings",null,[]);class Qo{constructor(){this.react=null;this.reactionCount=0;this.reactionImagePath=null;this.numberOfAnimationFrames=0}}Object(h.a)(Qo,"ILiveReaction",null,[]);class Ro{constructor(){this.isPaused=this.isPrivate=!1;this.participantsCount=0;this.sessionURLPromise=null;this.sessionCurrentState=0}}Object(h.a)(Ro,"ILiveSessionState",
null,[]);class jr{constructor(){this.sessionQRCode=this.participantUrl=null}}Object(h.a)(jr,"ILiveSessionURL",null,[]);class kr{constructor(){this.FLg=this.ELg=null}}Object(h.a)(kr,"PollObjectInfo",null,[]);var Hp;(function(n){n[n.none=0]="none";n[n.singleLineRibbon=1]="singleLineRibbon";n[n.multipleLineRibbon=2]="multipleLineRibbon";n[n.slideShowToolbar=3]="slideShowToolbar";n[n.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";n[n.welcomeScreenTryAgain=5]="welcomeScreenTryAgain"})(Hp||(Hp=
{}));Object(h.b)("LiveEntryPoint",Hp);var Ip;(function(n){n[n.none=0]="none";n[n.callout=1]="callout";n[n.businessBar=2]="businessBar";n[n.pausedSessionTimeout=3]="pausedSessionTimeout";n[n.slideshowContextMenu=4]="slideshowContextMenu";n[n.accessControlChange=5]="accessControlChange";n[n.welcomeScreenTryAgain=6]="welcomeScreenTryAgain"})(Ip||(Ip={}));Object(h.b)("LiveExitPoint",Ip);var Kn=d(660);class ll{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze){this.va=new Hl.a;this.sEa=this.jxb=this.oYc=
this.Fhe=this.REg=!1;this.J7b=this.rhe=this.rYc=!0;this.r$b=this.Wzb=!1;this.pp=this.jj=this.nca=this.Dn=null;this.DSa=0;this.tyb=-1;this.tzb=30;this.l9b=-1;this.Ad=this.Gka=this.IZ=null;this.zNg=this.kQg=this.A2c=this.w2c=0;this.i6b=this.Fsa=this.xSa=null;this.tle=this.S9a=0;this.dgb=null;this.Tpe=new Set;this.Spe=new Map;this.D_c=null;this.w9b=1;this.k9b=this.QDg=this.LN=this.cVa=this.Aqe=this.ofe=null;this.Qd=Aa;this.la=n;this.$Eg=!1;this.Ua=ha;this.qc=Bb;this.Rp=Wb;this.Oc=uc;this.Ey=Vc;this.Za=
bd;this.Cc=xd;this.gk=xe;this.eUa=wf;this.Ga=Ze;if(this.Hs=O)this.nca=O.iG();this.dL=La;this.DSa=this.L0f?1:0;this.la.powerPointLiveBroadcastEnabled&&(this.ofe=new bs(this.la));this.Oc.xB(Object(r.a)(this,this.z9,"onPodSessionRehydrated"));this.Ey.uGd(Object(r.a)(this,this.YBb,"onPodSessionUnavailable"));this.XOa()&&this.gk.execute(Ah=>{Ah.show(ResourceStrings.L_LivePresentations_Disconnected,Kn.a.yBb);Ah.hide()});K.a.J(51459524,833,50,"LivePresenter: Host auth type is: "+this.la.hostAuthType)}get Wq(){return this.la.powerPointLiveBroadcastEnabled&&
this.rYc}get a5a(){return this.Fhe}set a5a(n){(this.Fhe=n)&&this.va.raiseEvent("OnLiveResourcesLoaded",Sys.EventArgs.Empty)}get Cq(){return!!this.pp}get lba(){return this.$Eg}set lba(n){this.$Eg=n}get hBa(){return this.REg}set hBa(n){this.REg=n}get $Oa(){return!!this.pp&&this.pp.isPaused}get E0f(){return this.oYc}get iBa(){return this.J7b}set iBa(n){this.J7b=n}get TMi(){return this.a5a&&this.Wq&&!!this.Dn}get accessControl(){return this.DSa}set accessControl(n){this.DSa=n}get L0f(){return"true"===
this.Hbg("wdDisablePrivateSession")?!1:"aad"===this.la.hostAuthType}get G0f(){return this.Wq&&this.Cq&&this.jj?this.jj.isWelcomeScreenVisible():!1}Iqb(){return this.la.isMicButtonInSlideShowToolbarEnabled&&this.la.v$c&&this.Cc.zYb?this.Cc.Kqb?this.r$b=!0:this.Cc.Y0f||this.r$b:!0}k8c(n,O,ha,Aa,La,Bb,Wb,uc,Vc){if(this.Wq){this.Ua.zSb(Object(r.a)(this,this.n_g,"onSlideShowEnterEndOfShow"));this.Ua.ASb(Object(r.a)(this,this.o_g,"onSlideShowLeaveEndOfShow"));this.Ua.Emb(Object(r.a)(this,this.Xua,"onGetCurrentSlideDimensionsHandler"));
this.jxb=!1;this.sEa=!0;try{this.la.i$c&&this.SUi();const bd=this.HZd(La,Aa);if(this.Dn)(this.hBa||this.$Oa)&&this.Dn.FetchDocumentDownloadURL(bd);else{K.a.J(42869313,833,50,"Creating Broadcast monitor ...");const xd=new PowerPointLive.PPTBroadcastMonitorSettings;xd.isBlueChicken=this.la.isBlueChicken;xd.fileDownloadUrl=bd;xd.rendezvousSvcBaseUri=this.la.podLiveBroadcastRendezvousServiceBaseUri;xd.broadcastSubtitlesFromSpeechFrontDoor=!0;xd.pragueInitTimeoutInMS=this.la.avk;xd.preferredSubtitleLanguage=
this.Cc.GNc();xd.useStateService=this.la.jvk;xd.numMaxAttempts=this.la.dvk;xd.delayInSecsToCloseBroadcasterOnPause=this.la.Vuk;xd.batchedRequestsEnabled=this.la.Suk;xd.sharedSessionSettings={};xd.websocketAliveTimeAfterLoseFocusInMs=this.la.kvk;xd.pingTimeoutInMs=this.la.bvk;xd.pongTimeoutInMs=this.la.cvk;xd.enableTransientSessionHandling=this.la.Kvk;xd.maxStateServiceRoundtripRaw=v.AFrameworkApplication.fa.Gc("PPTLiveMaxStateServiceRoundtripRaw",300);xd.sharedSessionSettings.MaxStateServiceRoundtripRaw=
xd.maxStateServiceRoundtripRaw;xd.documentSnapshotRequestUrlGenerator=this.la.Hvk?()=>this.HZd(this.Za.podSessionId,this.Za.qk):null;this.la.s4g&&(xd.sharedSessionSettings.IsAutomation=!0);this.Dn=new PowerPointLive.PPTBroadcastMonitor(xd);this.Dn.RegisterParticipantsCountChangeEventListener(xe=>{this.Ad.telemetryData.maxParticipantCount=Math.max(this.Ad.telemetryData.maxParticipantCount,xe);this.jj&&this.jj.setParticipantCount(xe);this.va.raiseEvent("ParticipantsCountChanged",Sys.EventArgs.Empty)});
this.Dn.RegisterNewReactionEventListener(Object(r.a)(this,this.jck,"newReactionHandler"));this.Dn.RegisterConnectionStateEventListener(Object(r.a)(this,this.Tqi,"connectionStateHandler"))}this.Dn.SetCurrentPosition(n,O-1,null);this.S9a=n;this.hBa&&!this.pp&&Vc?(this.Skc(v.AFrameworkApplication.Ba&&v.AFrameworkApplication.Ba.jb.Ip?1:2,Wb,ha,La,uc),this.nni(n),this.Fsa=new Set):this.IZ&&this.ctb();this.Fsa&&this.Fsa.add(n)}catch(bd){K.a.J(42869315,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",
bd.toString())}}}gml(){window.setTimeout(()=>{const n=this.S9a===this.tle;this.Wq&&this.Cq&&n&&this.pp&&!this.pp.isPaused&&(K.a.J(592486672,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),this.Ukd(0),this.vIb(0))},6E4*this.la.fvk)}Ylk(){this.Wq&&(this.Ua.zcd(Object(r.a)(this,this.n_g,"onSlideShowEnterEndOfShow")),this.Ua.Acd(Object(r.a)(this,this.o_g,"onSlideShowLeaveEndOfShow")),this.Ua.Ehc(Object(r.a)(this,this.Xua,"onGetCurrentSlideDimensionsHandler")),this.sEa=
this.jxb=!1,this.Cq&&this.jj&&(this.jj.hideAll(),this.y$d()||(this.Urk(),this.A$k()),this.XOa()&&this.gk.instance.hide()))}ael(n,O,ha,Aa,La,Bb){try{const Wb=new PowerPointLive.RendezvousSessionConfig;Wb.userSessionId=n;Wb.webServiceBase=O;Wb.podSessionId=ha;Wb.docId=Aa;Wb.sessionId=La;Wb.accessControl=1===this.DSa?"organization":"anyone";Wb.authTokenFunc=Bb;Wb.locale=v.AFrameworkApplication.uiCulture;Wb.presentationName=ib.a.jG(v.AFrameworkApplication.fileName);Wb.slideHeight=this.qc.Gv().height;
Wb.slideWidth=this.qc.Gv().width;Wb.correlationId=this.Ad.telemetryData.correlationId;Wb.showQRCodeAfterFetchingDocDownloadUrl=this.la.Rvk;Wb.presenterTenantId=!this.la.isBlueChicken&&this.la.E4g?v.AFrameworkApplication.fa.Ia("TenantId"):null;Wb.fileSource=v.AFrameworkApplication.fa.Ia("FileHost");this.la.hvk||(Wb.fileName=v.AFrameworkApplication.fileName,Wb.bootstrapperUrl=this.la.pptEditorSlideShowWrsEndpoint);const uc=this.Dn.StartLiveBroadcasting(Wb,this.Ad,!this.la.Dye);this.Evj();if(uc){this.pp=
new Ro;this.pp.isPrivate=1===this.DSa;this.pp.isPaused=!1;this.pp.participantsCount=0;this.pp.sessionCurrentState=0;const Vc=uc.then(bd=>{const xd=new jr;xd.participantUrl=bd.sessionInfo.shortParticipantUrl;xd.sessionQRCode=bd.sessionInfo.sessionQRCode;this.pp.sessionCurrentState=1;return xd});this.pp.sessionURLPromise=Vc;this.la.w$c?this.k9b.then(()=>{this.jj.actOnSessionRequested(this.pp)}):this.jj.actOnSessionRequested(this.pp);this.Ua.Fmb(Object(r.a)(this,this.p_g,"onSlideShowReady"));this.Ua.Hzc(Object(r.a)(this,
this.onTranscriberStarted,"onTranscriberStarted"));this.Ua.BSb(Object(r.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));uc.then(bd=>{this.Ad.telemetryData.pragueDocId=bd.sessionInfo.pragueDocId;this.Ad.telemetryData.sessionCreationWebServiceCallTimeInMS=this.oK()-this.A2c;this.Ad.telemetryData.startAttemptCount=bd.numAttempt;K.a.J(50452483,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",this.Ad.telemetryData.sessionId,this.Ad.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());
this.la.Dye?(this.jjc(),this.Dn.InitializeStateService().then(()=>{this.Rlh(bd);this.DZ("StartLiveBroadcasting")}).catch(xd=>{this.Ad.telemetryData.sessionEndedBeforePragueInitialized||this.Ad.telemetryData.sessionId!==La||(K.a.J(594330467,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",this.Ad.telemetryData.sessionId,xd?xd.toString():""),this.Ad.telemetryData.SetErrorCode(2,xd?xd.toString():""),this.DZ("StartLiveBroadcasting"),this.whd())})):this.Rlh(bd);
this.la.Jvk&&$addHandler(window,"visibilitychange",Object(r.a)(this,this.Qjk,"onPageVisibilityChangedHandler"));this.DZ("StartLiveBroadcasting")}).catch(bd=>{K.a.J(42869319,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",this.Ad.telemetryData.sessionId,bd.toString());this.Ad.telemetryData.SetErrorCode(4,bd.toString());this.DZ("StartLiveBroadcasting");this.whd()})}else this.whd(),this.Ad.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),K.a.J(42869321,
833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(Wb){this.whd(),this.Ad.telemetryData.SetErrorCode(4,Wb.toString()),K.a.J(42869323,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",this.Ad.telemetryData.sessionId,Wb.toString())}finally{this.DZ("StartLiveBroadcasting")}}Rlh(n){const O=this.Cc.UXi(this.Cc.Uma);O?this.Dn.SetDefaultSubtitlesLanguage(O):K.a.J(595140894,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",
this.Ad.telemetryData.sessionId);this.Ua.HYa(!0,this.Dn.GetPragueSessionInfoJSONString());this.Ua.rpa(Object(r.a)(this,this.pdc,"onSlideShowPositionChanged"));this.Ua.Fzc(Object(r.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.la.Dye&&!this.jj.isWelcomeScreenVisible()||this.jjc();this.va.raiseEvent("OnLiveSessionStarted",n.sessionInfo);this.Iqb()||!this.Cc.zYb||this.Cc.Y0f||this.r$b||!this.XOa()||(this.Wzb=!0,this.gk.instance.show(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",
hl.a.re(v.AFrameworkApplication.uiCulture).displayName),Kn.a.yBb));this.i6b=this.Dn.CreateSurvey(n.authToken,null,null,null);this.i6b.then(ha=>{if(ha){const Aa={};Aa.surveyeeName=v.AFrameworkApplication.userName;Aa.surveyId=ha.surveyId;Aa.surveyResponseUrl=ha.surveyResponseUrl;this.Dn.SetAudienceFeedbackInfo(JSON.stringify(Aa))}});this.la.i$c&&(this.Spe.clear(),this.Tpe.forEach(ha=>{try{const Aa=ha.ELg;this.Dn.CreateSurvey(n.authToken,null,Aa,ha.FLg).then(La=>{La?this.Spe.set(Aa,La.surveyId):K.a.J(556613722,
833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",this.Ad.telemetryData.sessionId)}).catch(La=>{K.a.J(556613723,833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",this.Ad.telemetryData.sessionId,La.toString());this.Ad.telemetryData.SetErrorCode(13,n.toString())})}catch(Aa){K.a.J(556613724,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",this.Ad.telemetryData.sessionId,Aa.toString())}}));
this.eUa.init()?this.eUa.lGd(Object(r.a)(this,this.Xcc,"onNetworkConnectivityChanged")):K.a.J(594416981,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",this.Ad.telemetryData.sessionId)}Hbg(n){n=new RegExp(String.format("[\\?&]{0}=([^&#]*)",n));return(n=window.location.search.match(n))&&2===n.length?n[1]:""}Skc(n,O,ha,Aa,La){this.Aqe=O;this.cVa=ha;this.LN=Aa;this.QDg=La;this.A2c=this.oK();this.w2c=this.oK();var Bb=this.Hbg("wdSetLiveSessionId");Bb="rdvSession_"+(Bb.length?
Bb:Ad.a.create().toString());this.Ad=new PowerPointLive.LiveSessionTelemetry;this.Ad.telemetryData.sessionId=Bb;this.Ad.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Ad.telemetryData.accessControl=hr[this.DSa];this.Ad.telemetryData.sessionEntryPoint=Hp[n];this.Ad.telemetryData.isSubtitleStartedByLive=this.lba;this.Ad.telemetryData.isAutomation=this.la.s4g;this.Ad.telemetryData.correlationId=Ad.a.create().toString();this.DZ("StartLiveBroadcasting");try{this.Wq&&
this.Dn&&this.hYb()&&!this.pp?(this.NRj(),this.Ua.C2a(Object(r.a)(this,this.EXg,"onGetCurrentSlideShowPosition")),this.Ua.getCurrentPosition(),this.$Td()&&this.jj&&this.k9b&&this.k9b.then(()=>{this.jj.showOnboardingScreen();this.PTe=!0}),this.ael(O,ha,Aa,La,Bb,()=>this.KZb("StartLiveBroadcasting",this.Ad.telemetryData.sessionId))):(this.Ad.telemetryData.SetErrorCode(4,"Live actor or broadcast monitor is null while trying to start live session!"),K.a.J(50648476,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")),
n="",Object(Qj.a)(841,this.Ua)&&(n=Object(M.a)(841,this.Ua).GYb),this.Ad.telemetryData.isMordernSlideShow=!!this.Ua&&this.Ua.ivb()&&""===n}catch(Wb){this.Ad.telemetryData.SetErrorCode(4,Wb.toString()),K.a.J(593842909,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",this.Ad.telemetryData.sessionId,Wb.toString())}finally{this.DZ("StartLiveBroadcasting")}}Urk(){if(this.Wq&&this.Cq&&this.Dn&&this.hYb()&&!this.pp.isPaused){this.Ukd(2);this.vIb(2);try{this.Ad.telemetryData.sessionPauseCount+=
1,this.Ad.telemetryData.sessionActiveDurationInMS+=this.oK()-this.w2c,K.a.J(42869327,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.Ad.telemetryData.sessionId),this.jj.actOnSessionPaused(),this.pp.isPaused=!0,this.zNg=this.oK(),this.Dn.PauseLiveBroadcasting(()=>this.KZb("PauseLiveBroadcasting",this.Ad.telemetryData.sessionId)),this.va.raiseEvent("OnLiveSessionPaused",Sys.EventArgs.Empty),this.iel(),this.Ua.HYa(!1)}catch(n){this.Ad.telemetryData.SetErrorCode(5,n.toString()),K.a.J(50452490,
833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",this.Ad.telemetryData.sessionId,n.toString())}finally{this.DZ("PauseLiveBroadcasting")}}}Keh(){if(this.Wq&&this.Cq&&this.Dn&&this.hYb()&&this.pp.isPaused)try{this.w2c=this.oK(),this.Ad.telemetryData.sessionResumeCount+=1,K.a.J(50452492,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",this.Ad.telemetryData.sessionId),this.oeh(),this.jj.actOnSessionResumed(),this.Dn.ResumeLiveBroadcasting(()=>this.KZb("ResumeLiveBroadcasting",
this.Ad.telemetryData.sessionId)),this.pp.isPaused=!1,this.va.raiseEvent("OnLiveSessionResumed",Sys.EventArgs.Empty),this.UMe(),this.Ua.HYa(!0,this.Dn.GetPragueSessionInfoJSONString())}catch(n){this.Ad.telemetryData.SetErrorCode(6,n.toString()),K.a.J(50452494,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",this.Ad.telemetryData.sessionId,n.toString())}finally{this.DZ("ResumeLiveBroadcasting")}}aYb(n){if(this.Wq&&this.Cq&&this.Dn&&this.hYb()){this.vIb(3);try{this.Qll(n,
()=>{this.Ad.telemetryData.sessionExitPoint=Ip[n];this.pp.isPaused||(this.Ad.telemetryData.sessionActiveDurationInMS+=this.oK()-this.w2c);this.IZ&&this.ctb();this.UMe();this.XOa()&&this.gk.instance.hide();K.a.J(42869329,833,50,"SessionId: {0}, Message: End live broadcasting ...",this.Ad.telemetryData.sessionId);this.jj.actOnSessionEnded();this.Ua.Fhc(Object(r.a)(this,this.p_g,"onSlideShowReady"));this.Ua.JWa(Object(r.a)(this,this.pdc,"onSlideShowPositionChanged"));this.Ua.yDe(Object(r.a)(this,this.onSubtitleUpdated,
"onSubtitleUpdated"));this.Ua.ADe(Object(r.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));this.eUa.Gbh(Object(r.a)(this,this.Xcc,"onNetworkConnectivityChanged"));this.Ua.Bcd(Object(r.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));this.sEa&&this.Ua.HYa(!1);this.i6b=this.pp=null;this.va.raiseEvent("OnLiveSessionEnded",Sys.EventArgs.Empty);this.la.v$c&&this.Cc.zYb&&(this.r$b=this.Wzb=!1);if(3!==n){const O=this.Dn.EndLiveBroadcasting(()=>this.KZb("EndLiveBroadcasting",this.Ad.telemetryData.sessionId));
O?O.then(()=>{this.DZ("EndLiveBroadcasting");K.a.J(42869331,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",this.Ad.telemetryData.sessionId)}).catch(ha=>{this.Ad.telemetryData.SetErrorCode(7,ha.toString());this.DZ("EndLiveBroadcasting");K.a.J(50452498,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",this.Ad.telemetryData.sessionId,ha.toString())}):(this.Ad.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),
K.a.J(42869333,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else this.Dn.CleanUpBroadcastBeforeEnd(),K.a.J(594061319,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");this.DZ("EndLiveBroadcasting")})}catch(O){this.Ad.telemetryData.SetErrorCode(7),K.a.J(42869335,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",this.Ad.telemetryData.sessionId,O.toString())}finally{3!==n&&this.ghb(),this.DZ("EndLiveBroadcasting")}}}Vjh(){this.Wq&&
this.Dn&&this.Dn.SetPresenterState("muted")}Wjh(){this.Wq&&this.Dn&&this.Dn.SetPresenterState("unmuted")}showCallout(n){this.Wq&&this.jj&&(this.oYc=!0,this.jj.showCallout(n))}showWelcomeScreen(){this.Wq&&this.jj&&(this.jj.showWelcomeScreen(),this.cIe())}showEndSessionDialog(n,O){this.Wq&&this.Cq&&this.jj&&this.jj.showEndSessionDialogWithCallbacks(n,O)}whd(){this.jj.isWelcomeScreenVisible()||this.pp.isPaused||this.showWelcomeScreen();this.pp=null;this.jj.onSessionRequestError()}hYb(){if(this.Wq&&!this.jj&&
this.nca){const n=new ir;n.hostElement=this.nca;n.baseZIndex=50005;n.welcomeScreenBackgroundImageUrl=this.Qd.rk("LiveWelcomeScreenBackground.png");n.welcomeScreenErrorImageUrl=this.Qd.rk("LiveWelcomeScreenError.png");n.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";n.calloutContainerId="LiveCalloutContainer";n.urlBarLayerHostId="LiveURLBarLayerHost";n.dialogLayerHostId="LiveDialogLayerHost";n.reactionsBarLayerHostId="LiveReactionBarLayerHost";n.showTryAgainButton=!0;n.isPowerpointLiveReactionEnabled=
!xh.a("PPTLive.ReactionToggleInLiveCallout");n.onboardingScreenHostId="LiveOnboardingScreenLayerHost";n.resourceCDNPath=this.la.sdb;n.enablePrefetchLiveResource=this.la.w$c;n.enableNewLiveWelcomeScreen=this.la.w$c;n.userSessionId=this.Aqe;n.podsUrl=this.cVa;this.jj=liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(n);this.jj.on("OnWelcomeScreenOpenedAction",()=>{this.XHa("LiveWelcomeScreenLayerHost");this.cIe();this.kQg=Date.now();this.Ad.telemetryData.welcomeShownCount+=1});this.jj.on("OnWelcomeScreenClosedAction",
()=>{this.jxb&&this.jj.hideURLBar();this.IMf();this.Ua.restoreFocus();this.Ad.telemetryData.welcomeScreenDurations.push(Date.now()-this.kQg);this.Ad.telemetryData.welcomeScreenFirstTimeDuration=this.Ad.telemetryData.welcomeScreenDurations[0];this.DZ("OnWelcomeScreenClosedAction");this.Dn.SetWelcomeScreenState(!1);this.la.i$c&&this.jwh();this.Wzb&&this.XOa()&&window.setTimeout(()=>{this.gk.instance.hide();this.Wzb=!1},5E3)});this.jj.on("ResumeSessionAction",()=>{this.Keh();this.jxb||this.jj.showURLBar()});
this.jj.on("EndSessionAction",()=>{this.aYb(this.sEa?1:2);this.Ua.restoreFocus()});this.jj.on("OnCalloutOpenedAction",()=>{this.oYc=!0;this.va.raiseEvent("OnCalloutOpened",Sys.EventArgs.Empty);this.Ad.telemetryData.calloutShownCount+=1});this.jj.on("OnCalloutClosedAction",()=>{this.oYc=!1;this.va.raiseEvent("OnCalloutDismissed",Sys.EventArgs.Empty);this.Ua.restoreFocus()});this.jj.on("OnEndSessionDialogOpenedAction",()=>{this.D_k()});this.jj.on("OnEndSessionDialogClosedAction",()=>{this.jSk()});this.jj.on("OnCalloutMenuDefinitionChangedAction",
()=>{this.va.raiseEvent("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty)});this.jj.on("OnTryAgainAction",()=>{K.a.J(594587674,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",this.Ad.telemetryData.sessionId);this.Skc(5,this.Aqe,this.cVa,this.LN,this.QDg)});this.jj.on("PresenterDisabledReactions",()=>{this.rhe=!1});this.jj.on("PresenterEnabledReactions",()=>{this.rhe=!0});this.jj.on("OnOnboardingScreenOpenedAction",()=>{this.XHa("LiveOnboardingScreenLayerHost");this.cIe()});this.jj.on("OnOnboardingScreenClosedAction",
()=>{this.jjc()})}return!!this.jj}jjc(){this.jj&&(this.$Td()&&this.jj.isOnboardingScreenVisible()?this.XHa("LiveOnboardingScreenLayerHost"):this.jj.isWelcomeScreenVisible()?this.XHa("LiveWelcomeScreenLayerHost"):(-1!==this.l9b&&this.IMf(),this.Ua.restoreFocus()))}fEj(){const n=document.getElementById("LiveWelcomeScreenLayerHost"),O=document.getElementById("LiveOnboardingScreenLayerHost");let ha=!1;n&&(ha=n.contains(document.activeElement));return document.activeElement===O||document.activeElement===
n||ha}cIe(){this.jj&&-1===this.l9b&&(this.l9b=window.setInterval(()=>{this.fEj()||this.jjc()},500))}IMf(){window.clearInterval(this.l9b);this.l9b=-1}XHa(n){this.nca&&this.jj&&window.setTimeout(()=>{fc.FocusManager.xr(this.nca.ownerDocument.getElementById(n))},50)}D_k(){this.sEa?this.XHa("LiveDialogLayerHost"):(this.Ga.WPc(Rc.a.Cye,Rc.a.kj,document.getElementById("LiveDialogLayerHost")),this.Ga.Kj(Rc.a.Cye,!0))}jSk(){this.sEa?this.Ua.restoreFocus():this.Ga.Kj(Rc.a.Cye,!1)}Ggg(){this.la.v$c&&this.Cc.zYb&&
(this.XOa()&&this.Wzb&&(this.gk.instance.hide(),this.Wzb=!1),this.r$b=!0)}NRj(){try{this.k9b||!this.$Td()&&!this.la.w$c||(this.k9b=Ef.a(u.a.instance)("liveActorLazy"))}catch(n){K.a.J(592541262,833,10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.Ad.telemetryData.sessionId,n.toString())}}p_g(){this.Wq&&this.Dn&&(this.$Oa?(window.setTimeout(()=>{this.va.raiseEvent("OnRelaunchPausedSession",Sys.EventArgs.Empty)},500),this.Keh()):this.pp&&this.jj&&this.jj.isWelcomeScreenVisible()&&
this.jjc())}pdc(n,O){this.Wq&&this.Dn&&(this.Dn.SetCurrentPosition(O.slideId,O.slideIndex,O.imc),this.S9a!==O.slideId&&this.oeh(),this.S9a=O.slideId,this.Fsa&&(this.xSa&&10>this.w9b&&10*this.Fsa.size>=this.w9b*this.xSa.size&&(this.vIb(4),this.w9b+=1),this.Fsa.add(O.slideId)),this.la.i$c&&this.jwh(),n=!!this.xSa&&this.xSa.size>=this.la.evk,this.S9a===this.tle&&n&&this.gml())}n_g(){this.jxb=!0;this.Wq&&this.Cq&&this.jj&&(this.jj.hideURLBar(),this.Ukd(1),this.vIb(1))}o_g(){this.jxb=!1;this.Wq&&this.Cq&&
this.jj&&this.jj.showURLBar()}onSubtitleUpdated(n,O){this.Wq&&this.Cq&&this.Dn&&(O.isFinal?this.Dn.UpdateFinalSubtitles(O.Qvh):this.Dn.UpdatePartialSubtitles(O.Qvh))}onTranscriberStarted(n,O){this.Ad.telemetryData.transcriberSessionIds+=O.Pvh+",";this.Wq&&this.Cq&&this.Ua.HYa(!0,this.Dn.GetPragueSessionInfoJSONString())}iel(){K.a.J(590403657,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",this.Ad.telemetryData.sessionId);-1!==this.tyb&&window.clearInterval(this.tyb);this.tzb=30;this.tyb=
window.setInterval(Object(r.a)(this,this.Yrk,"pausedSessionAutoExpireTimerCallBack"),6E4)}UMe(){-1!==this.tyb&&(K.a.J(590403655,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",this.Ad.telemetryData.sessionId),window.clearInterval(this.tyb),this.tyb=-1)}Yrk(){--this.tzb;0>=this.tzb?(K.a.J(590403653,833,50,"SessionId: {0}, Ending long paused session.",this.Ad.telemetryData.sessionId),this.ctb(),this.aYb(3)):this.IZ&&(this.IZ.message=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,
this.tzb.toString()))}A$k(){if(!this.IZ&&this.Hs&&!v.AFrameworkApplication.Xg&&0!==this.pp.sessionCurrentState){var n=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.tzb.toString());n=new $r.a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,n,null);n.closeable=!0;n.G1=Object(r.a)(this,this.ufk,"onBusinessBarClosed");n.image=3;n.addButton(ResourceStrings.l_LiveBusinessBarButton_ResumeSession,Object(r.a)(this,this.wfk,"onBusinessBarResumeSessionButtonClicked"),"");n.QFd(ResourceStrings.l_LiveBusinessBarButton_EndSession,
Object(r.a)(this,this.vfk,"onBusinessBarEndSessionButtonClicked"));this.Hs.businessBar.ai(n,!1);this.Hs.Mq();this.IZ=n}}y$d(){var n=6E4*this.la.Ovk;n=0<n?this.oK()-this.A2c>=n:!1;K.a.J(590917785,833,50,"LivePresenter::IsSessionStale {0}",n);return n}ctb(){try{this.Hs&&this.IZ?(this.UMe(),this.Hs.businessBar.removeEntry(this.IZ),this.Hs.Mq(),K.a.J(590917783,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",!this.IZ.businessBar),this.IZ=null):K.a.J(590403649,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",
!!this.Hs,!!this.IZ)}catch(n){K.a.J(590403619,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",n.toString())}}ufk(n){n===this.IZ&&(this.IZ=null)}wfk(n){n===this.IZ&&this.jj&&(this.ctb(),this.y$d()||v.AFrameworkApplication.Va.processAction(Ab.a.mYa,2))}vfk(n){n===this.IZ&&this.jj&&(this.y$d()?this.ctb():this.jj.showEndSessionDialog())}Qjk(){const n=this.oK(),O=window.document.hidden;K.a.J(590917781,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",O?
"hidden":"visible",n);O||this.$Oa&&18E5<=n-this.zNg&&this.ctb()}bXd(n,O,ha){return!this.la.powerPointLiveBroadcastEnabled||0===this.DSa&&this.la.isBlueChicken?new Promise(Aa=>{Aa(null)}):!ha&&!this.dL||ha&&!this.ofe?(K.a.J(50452300,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",n,O,ha),new Promise((Aa,La)=>{La("AuthHelperNotSet")})):new Promise((Aa,La)=>{let Bb=this.la.hostAuthType,Wb="";if("aad"===Bb||this.la.isBlueChicken)Wb=this.la.pptLiveResourceUri;
else if("msa"===Bb)Wb=this.la.Nvk;else{K.a.J(51512226,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",n,O);La("HostAuthTypeInvalid");return}const uc="true"===v.AFrameworkApplication.fa.Ia("IsAnonymousUser").toLowerCase();let Vc=v.AFrameworkApplication.fa.Ia(v.AFrameworkApplication.lJ);ib.a.Xa(Vc)&&(Vc="Unset");const bd=new Date;let xd=null;xd=ha?this.ofe.gnl(this.la.Uuk,this.la.Tuk,Wb,v.AFrameworkApplication.fa.Ia("UserPrincipalName"),this.la.gvk,this.la.Xuk&&
"StartLiveBroadcasting"===n&&!this.la.E4g):this.dL.p0(this.la.pptLiveImplicitAuthAppName,Wb);xd.then(xe=>{this.Zzg(O,n,Bb,ha,uc,Vc,xe.IsSuccess,+new Date-+bd,xe.ErrorCode,xe.ErrorMessage);xe.IsSuccess?Aa(xe.Token):La(xe.ErrorCode)}).catch(xe=>{this.Zzg(O,n,Bb,ha,uc,Vc,!1,+new Date-+bd,"exception",xe.toString());La("exception")})})}KZb(n,O){if(!this.la.powerPointLiveBroadcastEnabled||0===this.DSa&&this.la.isBlueChicken)return new Promise(Aa=>{Aa(null)});if("msa"===this.la.hostAuthType)return this.bXd(n,
O,!1);const ha=this;return new Promise((Aa,La)=>{ha.bXd(n,O,!0).then(Bb=>{Aa(Bb)}).catch(()=>{ha.bXd(n,O,!1).then(Bb=>{K.a.J(592213320,833,50,"LivePresenter::GetToken - WebAuth retry succeeded.");Aa(Bb)}).catch(Bb=>{La(Bb)})})})}oK(){return(new Date).getTime()}Zzg(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd){const xd={};xd.SessionId=n;xd.Action=O;xd.HostAuthType=ha;xd.UseDirectAuth=Aa;xd.IsAnonymousUser=La;xd.UiHost=Bb;xd.IsSuccess=Wb;xd.Latency=uc;xd.ErrorCode=Vc;xd.ErrorMessage=bd;K.a.J(51197915,833,50,JSON.stringify(xd))}DZ(n){this.Ad.telemetryData.action=
n;this.Ad.telemetryData.sessionDurationInMS=this.oK()-this.A2c;this.Ad.telemetryData.hostAuthType=this.la.hostAuthType;this.Ad.SetStateServiceMetrics();this.Ad.telemetryData.errorCode.length&&(!this.Ad.telemetryData.errorMessage.length||0>Array.indexOf(this.la.$uk,this.Ad.telemetryData.errorMessage))&&(this.Ad.telemetryData.hasUnexpectedError=!0);n=this.la.podLiveBroadcastRendezvousServiceBaseUri.toLowerCase();-1!==n.indexOf("pptservicescast.officeapps.live.com")?this.Ad.telemetryData.rendezvousServiceEnvironment=
"prod":-1!==n.indexOf("pptservicescast.edog.officeapps.live.com")?this.Ad.telemetryData.rendezvousServiceEnvironment="edog":-1!==n.indexOf("pptservicescast.officeapps.live-int.com")?this.Ad.telemetryData.rendezvousServiceEnvironment="int":this.Ad.telemetryData.rendezvousServiceEnvironment="dev";K.a.J(50706442,833,this.Ad.telemetryData.hasUnexpectedError?15:50,JSON.stringify(this.Ad.telemetryData))}nni(n){if(this.qc)try{var O=this.Rp.presentation;if(!O)throw Error.argumentNull("Presentation is null");
const ha=O.slides||[];this.tle=ha[ha.length-1].sid;let Aa=O=!1;this.xSa=new Set;for(const La of ha)O||La.sid!==n||(O=!0,Aa=La.zn),!O||La.zn&&!Aa||this.xSa.add(La.sid),Aa&&!La.zn&&(Aa=!1)}catch(ha){this.Ad.telemetryData.SetErrorCode(16,ha.toString()),K.a.J(50860050,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",this.Ad.telemetryData.sessionId,ha.toString())}}Ukd(n){return new Promise(O=>{if(this.Wq&&this.Dn&&this.pp&&this.i6b)try{this.i6b.then(ha=>
{let Aa=!1;switch(n){case 2:if(!this.Fsa||!this.xSa||10*this.Fsa.size<8*this.xSa.size){O(!0);return}break;case 3:Aa=!0}const La={triggeredSurveyType:"Survey.AudienceFeedback"};La.isMandatory=Aa;La.triggerEventId=Ad.a.create().toString();La.surveyeeName=v.AFrameworkApplication.userName;ha?(La.surveyId=ha.surveyId,La.surveyResponseUrl=ha.surveyResponseUrl):K.a.J(51168984,833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",this.Ad.telemetryData.sessionId);this.Dn.TriggerSurvey(JSON.stringify(La));
K.a.J(50860052,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",this.Ad.telemetryData.sessionId,n);O(!0)}).catch(ha=>{K.a.J(51168987,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",this.Ad.telemetryData.sessionId,ha.toString());this.Ad.telemetryData.SetErrorCode(13,ha.toString());O(!1)})}catch(ha){this.Ad.telemetryData.SetErrorCode(17,ha.toString()),K.a.J(50860054,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",
this.Ad.telemetryData.sessionId,ha.toString()),O(!1)}else O(!0)})}EXg(n,O){this.Ua&&this.Dn&&O&&(this.Ua.GWa(Object(r.a)(this,this.EXg,"onGetCurrentSlideShowPosition")),this.Dn.SetCurrentPosition(O.slideId,O.slideIndex,O.imc))}Xua(n,O){this.jj&&this.jj.actOnCurrentSlideDimensionChange(O.slideHeight,O.Vph,O.slideWidth,O.Yph)}getCalloutMenuDefinition(){return this.hYb()?this.jj.getCalloutMenuDefinition():null}Evj(){const n=String.format("{0}{1}",this.la.sdb,"reactions/heart/default/240_anim_f/heart.png"),
O=String.format("{0}{1}",this.la.sdb,"reactions/yes/default/240_anim_f/yes.png"),ha=String.format("{0}{1}",this.la.sdb,"reactions/clap/default/240_anim_f/clap.png"),Aa=String.format("{0}{1}",this.la.sdb,"reactions/laugh/default/240_anim_f/laugh.png"),La=String.format("{0}{1}",this.la.sdb,"reactions/surprised/default/240_anim_f/surprised.png"),Bb=String.format("{0}{1}",this.la.sdb,"reactions/wonder/default/240_anim_f/wonder.png");this.Gka=[Object.assign(new Qo,{react:"yes",reactionCount:0,reactionImagePath:O,
numberOfAnimationFrames:40}),Object.assign(new Qo,{react:"heart",reactionCount:0,reactionImagePath:n,numberOfAnimationFrames:16}),Object.assign(new Qo,{react:"clap",reactionCount:0,reactionImagePath:ha,numberOfAnimationFrames:40}),Object.assign(new Qo,{react:"laugh",reactionCount:0,reactionImagePath:Aa,numberOfAnimationFrames:77}),Object.assign(new Qo,{react:"surprised",reactionCount:0,reactionImagePath:La,numberOfAnimationFrames:68}),Object.assign(new Qo,{react:"wonder",reactionCount:0,reactionImagePath:Bb,
numberOfAnimationFrames:70})];this.dgb=new Map;this.w9b=1;this.D_c=null}oeh(){if(this.Gka){for(const n of this.Gka)n.reactionCount=0;this.jj&&this.jj.resetReactions()}}jck(n){if(this.dgb){var O=this.dgb.has(n.slideId)?this.dgb.get(n.slideId)+1:1;this.dgb.set(n.slideId,O)}if(this.Gka&&!this.$Oa&&this.rhe){for(const ha of this.Gka)if(ha.react===n.react){ha.reactionCount+=1;break}if(this.jj){n=Array(this.Gka.length);for(O=0;O<this.Gka.length;O++)n[O]=Object.assign(new Qo,{react:this.Gka[O].react,reactionCount:this.Gka[O].reactionCount,
reactionImagePath:this.Gka[O].reactionImagePath,numberOfAnimationFrames:this.Gka[O].numberOfAnimationFrames});this.jj.setReactions(n)}}}vIb(n){return new Promise(O=>{if(this.Wq&&this.Dn&&this.pp)try{if(1>this.dgb.size)K.a.J(595121249,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",this.Ad.telemetryData.sessionId,n),O(!0);else if(2===n&&(!this.Fsa||1>this.Fsa.size))K.a.J(595121247,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",
this.Ad.telemetryData.sessionId,n),O(!0);else{var ha=null,Aa=0;this.dgb.forEach((Bb,Wb)=>{Bb>Aa&&(ha=Wb.toString(),Aa=Bb)});if(this.D_c&&ha===this.D_c)K.a.J(592515078,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",this.Ad.telemetryData.sessionId,n),O(!0);else{var La=this.Dn.TriggerSaveThumbnails(()=>this.KZb("SaveThumbnails",this.Ad.telemetryData.sessionId),ha);La?La.then(()=>{this.D_c=ha;K.a.J(595121245,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",
this.Ad.telemetryData.sessionId,n);O(!0)}).catch(Bb=>{K.a.J(595121243,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",this.Ad.telemetryData.sessionId,Bb.toString(),n);O(!1)}):(this.Ad.telemetryData.SetErrorCode(15,"Triggering save thumbnails failed to created Promise object!"),K.a.J(595121241,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),O(!1))}}}catch(Bb){this.Ad.telemetryData.SetErrorCode(15,
Bb.toString()),K.a.J(595121239,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",this.Ad.telemetryData.sessionId,Bb.toString()),O(!1)}else O(!0)})}XOa(){return this.la.pptEditorVoiceUXEnabled&&this.gk&&this.gk.instance?!0:!1}Tqi(n){if(this.XOa())switch(n){case 0:this.sEa&&this.gk.instance.show(ResourceStrings.L_LivePresentations_Disconnected,Kn.a.AVa);this.Ad.telemetryData.SetErrorCode(3);this.DZ("DisconnectdToPrague");break;case 1:this.gk.instance.hide();break;
case 2:this.sEa&&this.gk.instance.show(ResourceStrings.L_LivePresentations_Connecting,Kn.a.yBb);break;default:K.a.J(594416918,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Ad.telemetryData.sessionId)}else K.a.J(594416920,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",this.Ad.telemetryData.sessionId)}Xcc(n,O){this.XOa()?O.isConnected?this.gk.instance.hide():this.sEa&&this.gk.instance.show(ResourceStrings.L_LivePresentations_InternetDisconnected,
Kn.a.yBb):K.a.J(594416916,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Ad.telemetryData.sessionId)}HZd(n,O){n=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.la.podsWebServiceBase,n,O);this.la.ivk&&(n+="&shareable=true");return n}Qll(n,O){try{const ha=new C.a;if(1===n||2===n||4===n)ha.add(this.Ukd(3)),ha.add(this.vIb(3));ha.count?Promise.all(ha.toArray()).then(()=>O()).catch(()=>O()):O()}catch(ha){K.a.J(594367971,
833,10,"failed to create end session task promises, error : {0}",ha),O()}}get PTe(){const n=Gp.a.get("PPTLivePresentationOnboarded");return n?"true"===n.toLowerCase():!1}set PTe(n){Gp.a.LL("PPTLivePresentationOnboarded",n.toString(),Gp.a.qL)||K.a.J(593373381,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",n.toString())}$Td(){return this.la.Pvk&&!this.PTe}z9(){try{if(K.a.J(592310413,833,15,"Pods session rehydrated!"),this.rYc=!0,this.Wq&&this.Cq&&this.Dn){K.a.J(51423366,833,15,
"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Ad.telemetryData.sessionId,this.Za.qk);const n=this.HZd(this.Za.podSessionId,this.Za.qk);this.Dn.OnPodSessionUpdated(n)}}catch(n){K.a.J(51496722,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",n.toString())}}YBb(){this.rYc=!1}onPodSessionExpired(){this.rYc=!1}ghb(){if(this.la.Qvk)try{const n=u.a.instance.Oa("Common.ISystemInitiatedFeedback");n&&(K.a.J(594409295,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),
n.execute(O=>{O.logActivity("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(n){K.a.J(594409293,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",n)}}kbg(n){const O=document.createElement("a");O.setAttribute("href",n);return(n=O.search.match(RegExp("[\\?&]Id=([^&#]*)")))&&2===n.length?n[1]:""}SUi(){var n=this.qc.tbj();let O=1;this.Tpe.clear();for(const ha of n){n=ha.km();for(const Aa of n)if(!ib.a.Xa(Aa.ycb)){n=
this.kbg(Aa.ycb);const La=new kr;La.ELg=n;La.FLg=O.toString();this.Tpe.add(La);O+=1}}}jwh(){var n=this.qc.dCa(this.S9a).km();for(const O of n)ib.a.Xa(O.ycb)||(n=this.kbg(O.ycb),n=this.Spe.get(n),ib.a.Xa(n)||this.Dn.SetCurrentPollInfoState(n,this.S9a))}a3h(n){this.va.addHandler("OnLiveResourcesLoaded",n)}zNk(n){this.va.removeHandler("OnLiveResourcesLoaded",n)}mCf(n){this.va.addHandler("OnLiveSessionStarted",n)}Wbh(n){this.va.removeHandler("OnLiveSessionStarted",n)}kCf(n){this.va.addHandler("OnLiveSessionEnded",
n)}Vbh(n){this.va.removeHandler("OnLiveSessionEnded",n)}k2h(n){this.va.addHandler("OnCalloutDismissed",n)}VMk(n){this.va.removeHandler("OnCalloutDismissed",n)}iCf(n){this.va.addHandler("OnRelaunchPausedSession",n)}Tbh(n){this.va.removeHandler("OnRelaunchPausedSession",n)}l2h(n){this.va.addHandler("CalloutMenuDefinitionChanged",n)}WMk(n){this.va.removeHandler("CalloutMenuDefinitionChanged",n)}}Object(h.a)(ll,"LivePresenter",null,[913]);class wo{constructor(){this.K=null;this.aLg=0}get name(){return"PowerPointWebEditor.Live"}Yb(n){this.K=
n;const O=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(913,"PowerPointLive.ILivePresenter").ma().na(()=>new ll(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),O,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.App.OAuth.IOAuthManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),u.a.instance.Oa("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("PowerPointWebEditor.Core.INetworkConnectivityProvider"),this.K.resolve("PowerPointWebEditor.IFocusManager")))}ORj(){try{this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled?(this.aLg=Date.now(),K.a.J(42869339,
833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),Jc.a.get_instance().Ak(7,()=>{const n=this.K.resolve("Common.IDynamicScriptLoaderProvider").gx,O=Ef.a(this.K),ha=new C.a;ha.add(n.loadScript("PPTLiveBroadcast"));ha.add(n.loadScript("BroadcastMonitor"));ha.add(O("liveActor"));v.AFrameworkApplication.Ba.jb.Ip||ha.add(O("uiFabricLazy"));Promise.all(ha.toArray()).then(()=>this.Oik()).catch(Aa=>K.a.J(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",Aa))})):
K.a.J(42869337,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(n){K.a.J(42869343,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",n)}}Fl(){try{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ivk){const n=ib.a.nV((v.AFrameworkApplication.fileName||"").toLowerCase());if(".ppt"===n||".pps"===n){K.a.J(592238732,
833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");return}".pptx"!==n&&K.a.J(592238730,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+n)}this.K.resolve("PowerPointWebEditor.IApplicationSettings").Lvk&&this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(4)?K.a.J(592328917,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").Mvk&&
(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32)||this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32768))?K.a.J(592189026,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").D4g&&"msa"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType?K.a.J(591685859,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users."):this.K.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>
{n.isFeatureEnabled("PowerPointLivePresentations",!1).then(O=>{O?this.ORj():(K.a.J(592472007,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}else K.a.J(592472009,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(n){K.a.J(592472005,833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",n)}}Oik(){K.a.J(50860060,833,
50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-this.aLg);this.K.resolve("PowerPointLive.ILivePresenter").a5a=!0;this.K.resolve("PowerPointWebEditor.IApplicationSettings").D4g||"msa"!==this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}init(){v.AFrameworkApplication.fa.gf(Object(r.a)(this,this.Fl,"onFullAppSettingsReady"))}dispose(){}static main(){e.a.instance.Ec(new wo)}}
Object(h.a)(wo,"PPTWebEditorLivePackage",null,[2,3]);var Gq=d(706);class ip{}Object(h.a)(ip,"LokiTokenResult",null,[]);class an{constructor(n){this.puc=n}E4i(){const n=this.D4i();return n?an.u9d?new Promise((O,ha)=>{this.puc.continueWith(()=>{this.puc.yn||this.puc.Sl?ha(Error.create("Error downloading auth library")):this.puc.result.p0("Loki",n).then(Aa=>{Aa=v.AFrameworkApplication.fa.ka("ForceLokiFallbackToACLPTokenIsEnabled")?this.H4i():Aa.IsSuccess&&Aa.Token?Object.assign(new ip,{isSuccess:!0,
token:Aa.Token,errorMessage:null}):Object.assign(new ip,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Aa)});O(Aa);return Aa})})}):Promise.resolve(Object.assign(new ip,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new ip,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Gq.a.R5f())}))}H4i(){const n=v.AFrameworkApplication.fa.Ia("LokiUserDataSignature")||
"";return Object.assign(new ip,{isSuccess:!0,token:n,errorMessage:null})}D4i(){let n=null;const O=Gq.a.rKc();2===O?n=v.AFrameworkApplication.fa.Ia("LokiAADAppId"):1===O&&(n=v.AFrameworkApplication.fa.Ia("LokiMSAAppId"));return n}static get u9d(){return v.AFrameworkApplication.fa.ka("IsO365CommercialHost")||v.AFrameworkApplication.fa.ka("IsO365ConsumerHost")}}Object(h.a)(an,"LokiTokenManager",null,[983]);class lr{get name(){return"Common.App.LivePersonaUtils"}init(){u.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Yb(n){n.register(an,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ma().na(()=>new an(Eh.a.su(n.Oa("Common.App.OAuth.IOAuthManager"))))}static main(){e.a.instance.Ec(new lr)}}Object(h.a)(lr,"LivePersonaUtilsPackage",null,[2,3]);var qk=d(257);class bn{constructor(){this.displayName=this.critique=null;this.optOut=!1;this.category=null}}Object(h.a)(bn,"RehearsalCritique",null,[]);class Be{static Guj(){Be.iX[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Be.iX[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
Be.iX[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Be.iX[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;Be.kVf=ResourceStrings.L_SubtitleDetection_MicReady;Be.lVf=ResourceStrings.L_SubtitleDetection_SoundReminder;Be.f_f=ResourceStrings.L_SubtitleDetection_NoMicrophone;Be.l_f=ResourceStrings.l_NoCamera;Be.n5f=ResourceStrings.L_SpeechGenericRetryErrorMessage}}Be.nJf=20;Be.kah=50002;Be.iX=Array(Be.nJf);Be.kVf=null;Be.lVf=null;Be.f_f=null;Be.l_f=null;Be.n5f=null;Be.NUd="fillerWords";
Be.rok="originality";Be.Hyl="wordsPerMinute";Be.aYk="sensitivePhrases";Be.Dti="correctedSensitivePhrases";Be.wuk="positivity";Be.f2d="grammar";Be.Lre="monotone";Be.aAe="pronunciation";Be.xPd="crutchWords";Be.yCh="visionFace";Be.jxl="visionGaze";Be.ixl="visionGazeGood";Be.lxl="visionOcclusion";Be.kxl="visionOcclusionGood";Be.fxl="visionDistanceGood";Be.gxl="visionDistanceTooClose";Be.hxl="visionDistanceTooFar";Be.idg="GetStartedButton";Be.eRj="ListeningButtonPlayPauseButton";Be.fRj="ListeningElement";
Be.nri="ContainerElement";Be.Xrk="PausedElement";Be.kdk="NotificationButtonElement";Be.Pxl="WelcomeCheckboxElement";Be.mah="RehearsalFeedbackSettingPane";Be.Aye="PPTCoachRehearsalFREShown";Object(h.a)(Be,"RehearsalResourceString",null,[]);const $l=(n,O)=>ib.a.Xa(O)?(m.ULS.sendTraceTag(587872E3,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1):n?O.toLowerCase()in n:!0,Hq=(n,O)=>{let ha=null;try{if(!n||ib.a.Xa(O))return m.ULS.sendTraceTag(587871971,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),
null;const La=ib.a.Xa(n.ccd)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(n.ccd,!0);ha={};for(let Bb in La){n=Bb;var Aa=La[Bb];if(Aa){const Wb=af.a.LTb(Aa.split(","));Wb&&O.toLowerCase()in Wb&&(ha[n.toLowerCase()]=!0)}}}catch(La){K.a.J(590136391,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",La.toString()),ha=null}return ha},Jp=(n,O)=>{if(ib.a.Xa(O)||ib.a.Xa(n.D3g))return null;try{var ha=Sys.Serialization.JavaScriptSerializer.deserialize(n.D3g,
!0);if(ib.a.Xa(O)){m.ULS.sendTraceTag(587871968,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty.");var Aa=null}else Aa=O.split("-")[0].toLowerCase();return ha[Aa]}catch(La){return K.a.J(587872025,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",La.toString()),null}},Iq=n=>{if(n&&3<n.length){let O="";"ws"===n.substring(0,2)?O="http"+n.substring(2,n.length):"wss"===n.substring(0,3)&&(O="https"+n.substring(3,
n.length));return O}return n},ak=n=>{if(ib.a.Xa(n))return m.ULS.sendTraceTag(559548251,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",n),"en-US";switch(n.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return n}};class So{constructor(){this.userCritiques=null}}Object(h.a)(So,"RehearseRoamingSettings",null,[]);class cs{constructor(){this.critiquesDisabledByDefault=
this.critiquesDisabled=null}}Object(h.a)(cs,"UserCritiqueSettings",null,[]);class ds{constructor(n,O,ha,Aa){this.va=new Hl.a;this.AI=this.O6b=this.cT=null;this.RK=!1;this.JCg=null;this.Sta=this.Tta=0;this.Dz=n;this.la=O;this.SEa=ha;this.ia=Aa}Jwj(){try{this.Mbg(()=>{this.va.raiseEvent("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs)})}catch(n){K.a.J(557602759,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",n.toString())}}iTc(){return 2===this.Tta&&2===this.Sta}oRe(){try{0!==
this.Tta&&3!==this.Tta||this.Mbg(Object(r.a)(this,this.EBe,"raiseRehearsalGetCritiquesEvent")),0!==this.Sta&&3!==this.Sta||this.w0i()}catch(n){K.a.J(559548259,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",n.toString())}}xZi(){if(!this.O6b)return K.a.J(559548288,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(this.AI)for(let n of this.O6b)this.AI.contains(n.critique.toLowerCase())?n.optOut=!0:n.optOut=!1}catch(n){K.a.J(557602760,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",
n.toString())}return this.O6b.toArray()}Fsl(n,O){this.tAh(n,O);"vision"===n.toLowerCase()&&(this.RK=!O,n={},n.triggerPoint=Be.mah,this.ia.Ma(Ab.a.pmc,2,n))}Fag(n=!1){let O="";if(this.AI&&0<this.AI.count)if(xh.a("RehearsalFilterOptOutCritiqueEnabled")&&n){a:{var ha=this.la;n=this.la.Hva;var Aa=null;try{if(!ha||ib.a.Xa(n)){m.ULS.sendTraceTag(554837597,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");var La=null;break a}var Bb=
ib.a.Xa(ha.ccd)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(ha.ccd,!0);Aa={};for(let uc in Bb){La=uc;var Wb=Bb[uc];if(Wb){const Vc=af.a.LTb(Wb.split(","));Aa[La.toLowerCase()]=Vc&&n.toLowerCase()in Vc?!0:!1}}}catch(uc){K.a.J(554837598,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",uc.toString()),Aa=null}La=Aa}if(Wb=La)for(let uc of this.AI)if(Bb="vision"===uc?Be.yCh.toLowerCase():uc.toLowerCase(),Bb in Wb?Wb[Bb]:1)O=ib.a.Xa(O)?
uc.toLowerCase():O+","+uc.toLowerCase()}else for(Aa of this.AI)O=ib.a.Xa(O)?Aa.toLowerCase():O+","+Aa.toLowerCase();return O}led(){if(2!==this.Tta)K.a.J(557602761,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(this.vKj()){K.a.J(559548291,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var n=new So;n.userCritiques=Object.assign(new cs,{critiquesDisabled:this.Fag(),critiquesDisabledByDefault:this.cT.userCritiques.critiquesDisabledByDefault});
var O=ef.c(n),ha=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",v.AFrameworkApplication.$g),Aa={};Aa["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Dz.Jj(ha,2,O,Aa,!1,2,La=>{this.glk(La,n)},Object(r.a)(this,this.flk,"onSaveUserCritiquesFailed"),null,void 0,void 0,void 0,void 0,qk.a("17"))}else K.a.J(559548290,822,50,"SaveRehearseUserCritiques(), skipping save operation")}get kUd(){return this.RK}set kUd(n){this.RK=
n;this.tAh("vision",!this.RK);this.iTc()&&this.va.raiseEvent("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty)}U2h(n){this.va.addHandler("OnRehearsalOptOutSettingsRequestFinished",n)}uNk(n){this.va.removeHandler("OnRehearsalOptOutSettingsRequestFinished",n)}T2h(n){this.va.addHandler("OnRehearsalGetCritiquesSucceeded",n)}tNk(n){this.va.removeHandler("OnRehearsalGetCritiquesSucceeded",n)}S2h(n){this.va.addHandler("OnRehearsalGetCritiquesFailed",n)}sNk(n){this.va.removeHandler("OnRehearsalGetCritiquesFailed",
n)}V2h(n){this.va.addHandler("OnRehearsalSettingsUpdatedExternally",n)}vNk(n){this.va.removeHandler("OnRehearsalSettingsUpdatedExternally",n)}tAh(n,O){this.AI&&(n=n.toLowerCase(),O&&!this.AI.contains(n)?this.AI.add(n):!O&&this.AI.contains(n)&&this.AI.remove(n),xh.a("RehearsalRoamingSettingAutoSaveEnabled")&&this.led())}vKj(){let n=!1;try{var O=ib.a.Xa(this.cT.userCritiques.critiquesDisabled);if(!this.AI||!this.AI.count&&O)return!1;if(O&&0<this.AI.count||!O&&!this.AI.count)return!0;const ha=new Set(this.cT.userCritiques.critiquesDisabled.split(","));
if(this.AI.count!==ha.size)return!0;for(O=0;O<this.AI.count;O++)if(!ha.has(this.AI.ga(O).toLowerCase())){n=!0;break}}catch(ha){K.a.J(557602762,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",ha.toString())}return n}glk(n,O){this.cT=O;K.a.J(559548292,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+n.data.Eu-+n.data.JH,+n.data.wt-+n.data.JH)}flk(n){const O=this.SEa.Vha(n);K.a.J(559548293,822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",
O,n.data.state)}Mbg(n){const O=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",v.AFrameworkApplication.$g),ha={};ha["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Dz.Jj(O,1,null,ha,!1,2,Aa=>{this.Vhk(Aa,n)},Aa=>{this.Uhk(Aa,n)},null,void 0,void 0,void 0,void 0,qk.a("16"));this.Tta=1}Vhk(n,O){let ha=0;try{n.data.je&&0<n.data.je.trim().length&&(ha=n.data.je.length,
this.cT=JSON.parse(n.data.je));this.cT&&this.cT.userCritiques||(this.cT=new So,this.cT.userCritiques=new cs);ib.a.Xa(this.cT.userCritiques.critiquesDisabledByDefault)&&(this.cT.userCritiques.critiquesDisabledByDefault="vision",ib.a.Xa(this.cT.userCritiques.critiquesDisabled)?this.cT.userCritiques.critiquesDisabled="vision":this.cT.userCritiques.critiquesDisabled+=",vision");this.AI=new C.a;if(!ib.a.Xa(this.cT.userCritiques.critiquesDisabled)){const Aa=this.cT.userCritiques.critiquesDisabled.split(",");
for(const La of Aa)this.AI.add(La.toLowerCase())}this.RK=!this.AI.contains("vision");this.Tta=2}catch(Aa){this.Tta=3,K.a.J(559548294,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",Aa.toString())}O&&O();n=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",ha,JSON.stringify(n.data.JH),JSON.stringify(n.data.wt),JSON.stringify(n.data.Eu));K.a.J(559548295,822,50,n)}Uhk(n,O){this.Tta=3;O&&O();n=this.SEa.Vha(n);K.a.J(559548296,
822,50,"OnGetUserCritiquesFailed: Web service failed with {0}",n)}w0i(){try{const O=this.eOi();if(ib.a.Xa(O))K.a.J(559548297,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request");else{var n=new XMLHttpRequest;n.open("GET",O,!0);n.onreadystatechange=()=>{if(4===n.readyState){if(200===n.status){K.a.J(559548298,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");const ha=ef.b(n.responseText);if(ha){this.O6b=new C.a;for(const Aa of ha.critiquesData)this.O6b.add(Object.assign(new bn,
{category:Aa.category,displayName:Aa.displayName,optOut:!1,critique:Aa.critique.toLowerCase()}));this.JCg=ha.categoriesData;this.Sta=2}else this.Sta=3}else this.Sta=3;this.EBe()}};n.send("");this.Sta=1}}catch(O){this.Sta=3,this.EBe(),K.a.J(559548299,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",O.toString())}}eOi(){const n=ef.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).Ring||"Unknown",O=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");
return O&&O.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",O,n,ak(this.la.Hva)):null}EBe(){0!==this.Tta&&1!==this.Tta&&0!==this.Sta&&1!==this.Sta&&(this.iTc()?this.va.raiseEvent("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs):this.va.raiseEvent("OnRehearsalGetCritiquesFailed",new Sys.EventArgs))}}Object(h.a)(ds,"RehearsalFeedbackSettings",null,[910]);class Kp{constructor(){this.type="RehearsalCritiqueWithGroupProps";this.retryToFetchCritiqueSettings=
this.locale=this.updateCritiqueState=this.categoriesData=this.groupItems=null;this.isExternalUpdated=this.showErrorMessage=this.showLoadingMessage=!1}}Object(h.a)(Kp,"RehearsalCritiqueWithGroupProps",null,[]);class co{constructor(n,O,ha,Aa,La){this.LEa=this.Sb=!1;n.loadScript("powerpoint-presenter-coach-strings").then(()=>{this.LEa=!0;K.a.J(559548252,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(Bb=>{K.a.J(559548253,822,10,"Failed to load powerpoint-presenter-coach-strings "+
Bb.toString())});this.ia=O;this.la=La;this.uD=ha;this.Hx=Aa;this.ia.bma(this)}wb(){this.ia.ya(Ab.a.thd,yb.a.application,Object(r.a)(this,this.thd,"showRehearsalFeedbackSettingsPane"));this.ia.ya(Ab.a.dLe,yb.a.application,Object(r.a)(this,this.dLe,"showHideRehearsalFeedbackSettingsPane"));this.ia.ra(Ab.a.UAe,yb.a.application,Object(r.a)(this,this.UAe,"queryShowHideRehearsalFeedbackSettingsPane"),96)}Fe(){}w9(){}u9(){}thd(n,O,ha){if(O.contextId!==yb.a.application||!this.LEa)return 2;if(1===ha)return 32;
this.Sb?gc.UISurfaces.du().then(Aa=>{Aa.setSelectedTaskPane(Rc.a.Zdb);this.$z(!0);return null}).catch(Aa=>{K.a.J(554447887,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",Aa.toString())}):(this.Sb=!0,this.gah(),(n=!this.Hx.iTc())&&this.Hx.oRe(),n=this.OE(n,!1),this.rkc(n),K.a.J(555832795,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane"));return 32}dLe(n,O,ha){if(O.contextId!==yb.a.application||!this.LEa)return 2;if(1===ha)return 32;
(this.Sb=!this.Sb)?(this.gah(),(n=!this.Hx.iTc())&&this.Hx.oRe(),n=this.OE(n,!1),this.rkc(n),K.a.J(559548254,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(this.Dmi(),K.a.J(559548255,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32}UAe(n,O,ha,Aa,La){if(!Object(Qj.a)(Jk.a,La))return 8;La.Yf(this.Sb);return 32}rkc(n,O=!1){const ha=Object.assign(new db.a,{title:ResourceStrings.L_RehearseFeedbackSettings,hideHeader:!1,
width:320,location:2,contentProps:n,onOpen:()=>{},onClose:()=>{this.Sb=!1;this.bDi();this.Hx.led()},onHide:()=>{this.Hx.led()},isModernPane:!0});n=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");this.uD.o7(Rc.a.Zdb,Rc.a.kj,n,()=>{this.$z(!0)},()=>{this.$z(!1)});gc.UISurfaces.du().then(Aa=>{O?this.Sb&&Aa.updateTaskPane(Rc.a.Zdb,ha):Aa.showTaskPane(Rc.a.Zdb,ha);return null}).catch(Aa=>{K.a.J(559548256,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",
Aa.toString())})}Dmi(){gc.UISurfaces.du().then(n=>{n.hideTaskPane(Rc.a.Zdb,2);return null}).catch(n=>{K.a.J(559548257,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",n.toString())})}OE(n,O){return Object.assign(new Kp,{groupItems:n||O?null:this.Hx.xZi(),categoriesData:this.Hx.JCg,locale:this.la.Hva,updateCritiqueState:(ha,Aa)=>{this.Hx.Fsl(ha,Aa)},retryToFetchCritiqueSettings:()=>{this.Hx.oRe()},showLoadingMessage:n,showErrorMessage:O})}$z(n){const O=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");
n&&O&&O.focus()}gah(){this.Hx.T2h(Object(r.a)(this,this.qZg,"onRehearsalGetCritiquesSucceeded"));this.Hx.S2h(Object(r.a)(this,this.pZg,"onRehearsalGetCritiquesFailed"));this.Hx.V2h(Object(r.a)(this,this.sZg,"onRehearsalSettingsUpdatedExternally"))}bDi(){this.Hx.tNk(Object(r.a)(this,this.qZg,"onRehearsalGetCritiquesSucceeded"));this.Hx.sNk(Object(r.a)(this,this.pZg,"onRehearsalGetCritiquesFailed"));this.Hx.vNk(Object(r.a)(this,this.sZg,"onRehearsalSettingsUpdatedExternally"))}qZg(){const n=this.OE(!1,
!1);this.rkc(n,!0)}pZg(){const n=this.OE(!1,!0);this.rkc(n,!0)}sZg(){const n=this.OE(!1,!1);n.isExternalUpdated=!0;this.rkc(n,!0)}}Object(h.a)(co,"RehearsalFeedbackSettingsPane",null,[146]);var Jq;(function(n){n[n.none=0]="none";n[n.ribbon=1]="ribbon";n[n.slideShowToolbar=2]="slideShowToolbar";n[n.summaryPage=3]="summaryPage";n[n.ribbonTopBar=4]="ribbonTopBar";n[n.deepLink=5]="deepLink"})(Jq||(Jq={}));Object(h.b)("RehearsalEntryPoint",Jq);class Gm{constructor(){this.imagesBaseFilePath=this.slideState=
this.rootContainer=null;this.zIndex=0;this.fUseCountdownWelcomeScreen=this.fShowRealtimeFeedbackEnabledCheckbox=this.fEnableVision=!1;this.speechFDBase=null;this.fUseNewRealtimeCheckbox=this.fUseNewRealtimePanel=this.fDontShowTooltips=!1}}Object(h.a)(Gm,"ICoachActorConfig",null,[]);class aq{constructor(){this.rootContainer=this.imagesBaseFilePath=null;this.zIndex=0}}Object(h.a)(aq,"ICoachFREActorConfig",null,[]);class Kq{constructor(){this.customSettings=this.requestedRehearsalOptOutFeatures=this.requestedCoachFeatures=
this.documentDownloadConfig=this.userSessionId=this.disabledCoachRealtimeFeatures=this.logger=null;this.fEnableVision=!1;this.supportedRehearsalTemplates=this.sourceLanguage=this.entryPoint=this.wacDatacenter=this.wacHost=this.locale=this.buildVersion=this.audienceGroup=this.audienceChannel=this.identityProvider=this.tenantId=this.userId=this.speechFDBase=this.webcamConfig=null;this.fEnableServiceSideAggregationForCoach=!1;this.httpTimeoutForCoachSummaryData=0;this.enableTimeStampedCritiqueTelemetry=
this.fSendClientMetaDataOnSessionStart=!1;this.audioInputDeviceCount=0}}Object(h.a)(Kq,"ICoachSessionConfig",null,[]);class mr{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(h.a)(mr,"IDocumentDownloadConfig",null,[]);class Lp{constructor(){this.totalSlideCount=this.currentSlideIndex=0}}Object(h.a)(Lp,"ISlideState",null,[]);class xo{constructor(){this.workingCanvas=this.videoView=null;this.requestedVideoHeight=this.requestedVideoWidth=this.webcamFrameWidth=
this.numFramesPerSecond=0}}Object(h.a)(xo,"IWebcamConfig",null,[]);var nr=d(661);class am{constructor(n,O,ha,Aa,La,Bb,Wb,uc,Vc,bd,xd,xe,wf,Ze){this.iTa=!1;this.Rv=this.lee=this.gW=this.nca=null;this.z$b=0;this.cMg=-1;this.Lac=0;this.g4c=this.Z3c=null;this.uhe=this.khe=!1;this.Rne=this.Hka=0;this.RK=!1;this.va=new Hl.a;this.MUa=null;this.dFg=this.Cqe=this.rde=!1;this.Tne=null;this.j6b=this.VCg=0;this.YNg=this.xEg=!1;this.FEg=v.AFrameworkApplication.fa.ka("FirstRehearsalExperienceEnabled");this.JYj=
ha;O&&(this.nca=O.iG());this.Ua=Aa;this.ia=n;this.qc=La;this.ua=Bb;this.Za=Wb;this.la=uc;this.gk=Vc;this.Eca=bd;this.y$b=xd;this.Hx=xe;this.wG=wf;this.BD=Ze;this.CYb()&&this.Hx.U2h(Object(r.a)(this,this.rZg,"onRehearsalOptOutSettingsRequestFinished"))}wb(){this.ia.ya(Ab.a.Vkc,yb.a.application,Object(r.a)(this,this.Vkc,"startRehearsalManager"));this.ia.ya(Ab.a.pmc,yb.a.application,Object(r.a)(this,this.pmc,"toggleRehearsalVisionEnabled"));this.ia.ya(Ab.a.dcd,yb.a.application,Object(r.a)(this,this.dcd,
"rehearsePresentationDropDown"));this.ia.ra(Ab.a.ogc,yb.a.application,Object(r.a)(this,this.ogc,"queryRehearsalVisionEnabled"),96)}ogc(n,O,ha,Aa,La){if(!La||!Object(Qj.a)(Jk.a,La))return K.a.J(590381532,822,10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;La.Yf(this.RK);return 32}dcd(n,O,ha){switch(ha){case 1:if(this.iTa&&this.kae())return this.ia.processAction(Ab.a.cma,1);break;default:K.a.J(575021444,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8}pmc(n,
O,ha,Aa,La){switch(ha){case 2:return this.RK=!this.RK,v.AFrameworkApplication.Ba&&v.AFrameworkApplication.Ba.jb.Ip&&Zf.App.Fb.GF({ToggleRehearsalVisionEnabled:"CheckboxModel"}),this.CYb()&&La&&La.triggerPoint!==Be.mah&&(this.Hx.kUd=this.RK),32;case 1:if(this.iTa&&this.kae())return 32;break;default:K.a.J(590381530,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8}Vkc(n,O,ha,Aa,La){switch(ha){case 2:return this.mel(La),32;case 1:if(this.iTa&&this.kae())return 32;break;default:K.a.J(51454232,
822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8}z5b(){try{this.VCg=Date.now();const n=this.JYj.gx;n.loadScript("powerpoint-presenter-coach-strings").then(()=>{const O=new C.a;O.add(n.loadScript("CoachActorPackage"));O.add(n.loadScript("CoachPackage"));Promise.all(O.toArray()).then(()=>{this.Sfk();return null}).catch(ha=>{K.a.J(590947672,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",ha);return null})})}catch(n){K.a.J(590947670,822,10,"RehearsalManager: Exception in LoadResources : {0}.",
n)}}m2h(n){this.va.addHandler("OnCoachResourcesLoaded",n)}XMk(n){this.va.removeHandler("OnCoachResourcesLoaded",n)}Sfk(){const n=v.AFrameworkApplication.fa.Ia("CoachPackageCssUrl"),O=document.createElement("link");O.setAttribute("rel","stylesheet");O.setAttribute("type","text/css");O.setAttribute("href",n);$addHandler(O,"load",()=>{this.iTa=!0;xh.a("PollToRefreshCoachEntryPointOnRibbon")&&this.BD&&this.BD.YG();this.va.raiseEvent("OnCoachResourcesLoaded",new Sys.EventArgs);K.a.J(555798674,822,50,"RehearsalManager: Coach package loading time: {0}ms",
Date.now()-this.VCg)});document.body.appendChild(O)}QJk(){this.Ua.Fmb(Object(r.a)(this,this.v_g,"onSlideshowReady"));this.Ua.rpa(Object(r.a)(this,this.pdc,"onSlideShowPositionChanged"));this.Ua.xY(Object(r.a)(this,this.Gda,"onSlideshowExitHandler"));this.Ua.Gmb(Object(r.a)(this,this.gva,"onSpecialKeyHandler"))}cDi(){this.Ua.Fhc(Object(r.a)(this,this.v_g,"onSlideshowReady"));this.Ua.JWa(Object(r.a)(this,this.pdc,"onSlideShowPositionChanged"));this.Ua.R_(Object(r.a)(this,this.Gda,"onSlideshowExitHandler"));
this.Ua.Ghc(Object(r.a)(this,this.gva,"onSpecialKeyHandler"))}gva(n,O){O.key===ra.a.MJb&&this.NHe()}NHe(){if(0===this.Hka){var n=this.Rv.getCoachElement(Be.idg);n&&this.XHa(n)}else 2===this.Hka?(n=this.Rv.getCoachElement(Be.Xrk))&&this.XHa(n):1===this.Hka&&(n=this.Rv.getCoachElement(Be.fRj))&&this.XHa(n)}XHa(n){this.nca&&this.Rv&&window.setTimeout(()=>{fc.FocusManager.xr(n)},50)}xz(n){try{const La=this.Rv.getCoachElement(Be.idg),Bb=this.Rv.getCoachElement(Be.eRj),Wb=this.Rv.getCoachElement(Be.Pxl),
uc=this.Rv.getCoachElement(Be.kdk);if(n.keyCode===ra.a.tq){if(!xh.a("PresenterCoachTabFix")){var O=!Wb&&!!La&&n.target===La||!!Wb&&n.target===Wb,ha=!!La&&!!Bb&&Bb.contains(n.target),Aa=!!uc&&n.target===uc;(O||ha||Aa)&&this.Ua.restoreFocus()}}else n.keyCode===ra.a.WQ||n.keyCode===ra.a.C0?(this.Ua.prev(),this.NHe()):n.keyCode===ra.a.vO||n.keyCode===ra.a.A0?(this.Ua.next(),this.NHe()):n.keyCode===ra.a.Xp||n.keyCode===ra.a.tJb||n.shiftKey||this.Ua.restoreFocus()}catch(La){K.a.J(594403598,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",
La)}}bJk(){const n=this.Rv.getCoachElement(Be.nri);if(xh.a("PresenterCoachTabFix")){var O=document.getElementById("HiddenFocusTrapAnchor");this.nca.insertBefore(n,O)}else O=document.getElementById("slideshowEndFocusTrap"),this.nca.insertBefore(n,O);n&&Hb.a.addHandler(n,ma.a.Rf,Object(r.a)(this,this.xz,"keyDownHandler"))}mel(n){if(!this.ua.Ca)throw Error.argumentNull("ActiveSlide is null");Be.Guj();this.QJk();this.CYb()&&(this.Hx.led(),this.Hx.uNk(Object(r.a)(this,this.rZg,"onRehearsalOptOutSettingsRequestFinished")));
const O=new Lp;this.MUa=Hq(this.la,this.la.Hva);this.RK&&!this.la.pptRehearsalVisionEnabled&&K.a.J(590381524,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.RK=this.RK&&this.la.pptRehearsalVisionEnabled;var ha=new Po.a,Aa=Object(M.a)(131,this.qc.dCa(this.ua.Ca.Cb.sid));O.currentSlideIndex=Aa?Aa.Ge:0;O.totalSlideCount=this.qc.wj();Aa=this.YXi(O);this.Rv=(new CoachActorPackage.CoachActorFactory).createCoachActorManager(Aa,ha);this.RK&&(this.Z3c=this.Rv.getRehearsalVideoElement(),
this.g4c=this.Rv.getRehearsalVideoCanvas());this.Rne=n;n=this.EXd(O,this.Z3c,this.g4c);this.gW=(new CoachPackage.CoachSessionFactory).createCoachManager(n);n=this.ZXi();this.lee=(new CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(n,ha);xh.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.wG.enumerateDevices(Object(r.a)(this,this.Hcc,"onEnumerateDevicesSuccess"),Object(r.a)(this,this.JVa,"onDevicesFailure"),Object(r.a)(this,this.TVa,"onUnsupported"));this.SHk();this.THk();
this.z$b=0;this.uhe=!1;this.bJk();2===this.Rne&&(ha=localStorage.getItem(Be.Aye),this.FEg&&!ha?this.krh():this.EMe())}EMe(){this.Hka=0;this.Eca.execute(n=>{n.rC(nr.a.SubtitlesButton,!1);n.rC(nr.a.LiveButton,!1);n.rC(nr.a.CoachButton,!1);n.rC(nr.a.MicButton,!1)});this.gW.startSession(!0)}krh(){this.lee.showCoachFREUI(n=>{localStorage.setItem(Be.Aye,"true");this.YNg=n;this.EMe()})}Hcc(n){this.j6b=0;if(n.length)for(var O of n)"audioinput"===O.kind&&(this.j6b+=1);else this.j6b=0;this.xEg=!0;n=new Lp;
O=Object(M.a)(131,this.qc.dCa(this.ua.Ca.Cb.sid));n.currentSlideIndex=O?O.Ge:0;n.totalSlideCount=this.qc.wj();n=this.EXd(n,this.Z3c,this.g4c);this.gW.updateSessionConfiguration(n)}JVa(n){K.a.J(555779546,822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",n.toString())}TVa(){K.a.J(555779547,822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",Ic.a.ey)}v_g(){const n=localStorage.getItem(Be.Aye);this.FEg&&!n?this.krh():this.EMe()}pdc(n,
O){n=new Lp;n.currentSlideIndex=O.slideIndex;n.totalSlideCount=this.qc.wj();O=this.EXd(n,this.Z3c,this.g4c);this.gW.updateSessionConfiguration(O);this.Rv.updateCoachSlideComponent(n)}getTraceRequestMetadata(n,O){const ha={};if(n)for(let Aa in n)ha[Aa]=n[Aa];if(O)for(let Aa in O)ha[Aa]=O[Aa];n=ef.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());ha.AudienceGroup=n.Ring||"Unknown";ha.BuildVersion=v.AFrameworkApplication.buildVersion||"Unknown";ha.ClientType="web";ha.IdentityProvider=
this.la.hostAuthType||v.AFrameworkApplication.fa.Ia("HostAuthType")||"Unknown";ha.Locale=this.la.XGa||"Unknown";ha.SpeechMode="rehearsal";ha.TenantId=v.AFrameworkApplication.fa.Ia("TenantId");ha.UserId=this.getUserId();ha.WacDatacenter=n.WACDatacenter||"Unknown";ha.WacHost=n.Host||"Unknown";ha.SourceLanguage=this.la.GNf||ak(this.la.Hva);return ha}getUserId(){let n=v.AFrameworkApplication.fa.Ia("PptEditingUserId");ib.a.Xa(n)&&(n=v.AFrameworkApplication.fa.Ia("LoggableUserId"),m.ULS.sendTraceTag(587563427,
822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",ib.a.Xa(n)));return n}xXk(){if(this.la.Vsk){var n=this.gW.getTraceRequestMetadata(),O=this.Rv.getTraceRequestMetadata(),ha=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");if(ha&&ha.length){var Aa=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",ha);ha=new XMLHttpRequest;ha.open("POST",Aa,!0);Aa=Ad.a.create().toString();ha.setRequestHeader("X-Correlation",Aa);try{m.ULS.sendTraceTag(587563425,
822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",Aa);const La=this.getTraceRequestMetadata(n,O);ha.send(ef.c(La))}catch(La){m.ULS.sendTraceTag(587563424,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",Aa)}}else m.ULS.sendTraceTag(587563426,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}}Gda(){this.cDi();this.Hka=3;this.gW.stopSession();this.lee.hideCoachFREAndWelcomeUI();this.Rv.hideCoachUI();this.Cqe=this.rde=!1;try{this.gW.getSessionSummary(n=>
{n.timeSpentInSeconds=this.z$b;this.ia.processAction(Ab.a.wHc,2);this.ia.processAction(Ab.a.vHc,2);window.clearInterval(this.cMg);this.uhe&&this.y$b.instance.rIa(n,this.RK,this.MUa,this.Tne,()=>{this.xXk()})})}catch(n){m.ULS.sendTraceTag(576247201,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",n)}}n9i(){let n=",visionFace";this.la.Zvk&&(n+=","+Be.jxl+","+Be.ixl);this.la.$vk&&(n+=","+Be.lxl+","+Be.kxl);this.la.Yvk&&(n+=","+Be.fxl+","+Be.gxl+","+Be.hxl);return Be.Hyl+($l(this.MUa,
Be.NUd)?","+Be.NUd:"")+","+Be.aYk+","+Be.Dti+","+Be.rok+","+Be.wuk+(this.la.Bye&&$l(this.MUa,Be.f2d)?","+Be.f2d:"")+(this.la.Uxe&&$l(this.MUa,Be.Lre)?","+Be.Lre:"")+(this.la.pptRehearsalVisionEnabled&&$l(this.MUa,Be.yCh)?n:"")+(this.la.pptRehearsalPronunciationEnabled&&$l(this.MUa,Be.aAe)?","+Be.aAe:"")+(this.la.pptRehearsalCrutchWordsEnabled&&$l(this.MUa,Be.xPd)?","+Be.xPd:"")}EXd(n,O,ha){const Aa=new Kq;Aa.disabledCoachRealtimeFeatures="";Aa.userSessionId=v.AFrameworkApplication.userSessionId;var La=
new mr;La.docId=v.AFrameworkApplication.$g;La.podsSessionId=this.Za.podSessionId;La.userDataCenterClusterId=this.Za.qk;La.webServiceBase=this.la.podsWebServiceBase;Aa.documentDownloadConfig=La;La=new Po.a;Aa.logger=La;La={};La.currentSlideIndex=n.currentSlideIndex.toString();Aa.customSettings=La;Aa.fEnableServiceSideAggregationForCoach=this.la.A$c;Aa.httpTimeoutForCoachSummaryData=this.la.mwk;Aa.fSendClientMetaDataOnSessionStart=this.la.PIi;Aa.speechFDBase=this.la.pptEditorSpeechHandlerBaseUri;Aa.requestedCoachFeatures=
this.n9i();this.CYb()&&(this.Tne=this.Hx.Fag(!0),Aa.requestedRehearsalOptOutFeatures=this.Tne);xh.a("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(Aa.enableTimeStampedCritiqueTelemetry=!0);Aa.entryPoint=Jq[this.Rne];Aa.fEnableVision=this.RK;Aa.fEnableVision&&O&&ha&&(Aa.webcamConfig=Object.assign(new xo,{videoView:O,workingCanvas:ha,numFramesPerSecond:this.la.pptRehearsalVisionFramesPerSecond,webcamFrameWidth:this.la.bwk}));Aa.supportedRehearsalTemplates=this.Rv.getSupportedRehearsalTemplates();
xh.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.xEg&&(Aa.audioInputDeviceCount=this.j6b);n=ef.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Aa.userId=this.getUserId();Aa.tenantId=v.AFrameworkApplication.fa.Ia("TenantId");Aa.identityProvider=this.la.hostAuthType||v.AFrameworkApplication.fa.Ia("HostAuthType")||"Unknown";Aa.audienceChannel="";Aa.audienceGroup=n.Ring||"Unknown";Aa.buildVersion=v.AFrameworkApplication.buildVersion||"Unknown";Aa.locale=this.la.XGa||
"Unknown";Aa.wacHost=n.Host||"Unknown";Aa.wacDatacenter=n.WACDatacenter||"Unknown";Aa.sourceLanguage=this.la.GNf||ak(this.la.Hva);K.a.J(591537798,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",this.la.XGa,this.la.Hva);return Aa}ZXi(){const n=new aq;n.rootContainer=this.nca;n.zIndex=Be.kah;n.imagesBaseFilePath=v.AFrameworkApplication.fa.Ia("CoachImagesBaseFilePath");return n}YXi(n){const O=new Gm;O.rootContainer=this.nca;O.slideState=n;O.imagesBaseFilePath=
v.AFrameworkApplication.fa.Ia("CoachImagesBaseFilePath");O.zIndex=Be.kah;O.fEnableVision=this.RK;O.fShowRealtimeFeedbackEnabledCheckbox=this.la.Usk;O.fUseNewRealtimePanel=this.la.bcd;O.fUseCountdownWelcomeScreen=v.AFrameworkApplication.fa.ka("PptCoachEnableCountdownWelcomeUI");O.speechFDBase=Iq(this.la.pptEditorSpeechHandlerBaseUri);O.fDontShowTooltips=Ic.a.ag;O.fUseNewRealtimeCheckbox=xh.a("UseNewRealtimeCheckbox");return O}Wsl(){2!==this.Hka&&(this.z$b+=1,this.Rv&&this.Rv.updateTimer(this.z$b))}SHk(){this.Rv.on("CoachSessionStarted",
()=>{this.Hka=1;this.cMg=window.setInterval(Object(r.a)(this,this.Wsl,"updatePresentationTimer"),1E3);this.gW.enableVoiceStreaming();this.wal();this.uhe=!0});this.Rv.on("CoachSessionPaused",()=>{this.Hka=2;this.gW.pauseSession();this.Eha()&&this.gk.instance.hide()});this.Rv.on("CoachSessionResumed",()=>{this.Hka=1;this.gW.resumeSession()})}THk(){this.gW.on("SpeechRecognitionStarted",()=>{this.khe&&this.Eha()&&(this.gk.instance.hide(),this.khe=!1)});this.gW.on("PPTCoachRealtimeNotification",n=>{this.kij(n)});
this.gW.on("QualityStatusChanged",n=>{this.Blj(n)});this.gW.on("MediaStatusChanged",n=>{this.kkj(n)});this.gW.on("Error",n=>{this.handleError(n)});this.gW.on("ConnectionRetry",()=>{this.rjj()})}rjj(){this.khe=!0;this.Eha()&&this.gk.instance.show(Be.n5f,Kn.a.AVa)}kij(n){this.Rv.updateCoachRealtimeNotification(n)}handleError(n){n=Object(M.a)(String,n);this.Hka=4;n?n.startsWith("ErrorAudio")?(this.Rv&&this.Rv.showCoachDisabledUI(0),this.Eha()&&this.gk.instance.show(Be.f_f,Kn.a.AVa)):n.startsWith("ErrorVideo")?
(this.Rv&&this.Rv.showCoachDisabledUI(1),this.Eha()&&this.gk.instance.show(Be.l_f,Kn.a.AVa)):K.a.J(589169224,822,10,"RehearsalManager::handleError unhandled errorInfo"):K.a.J(589169226,822,10,"RehearsalManager::handleError errorInfo null")}drh(){this.Rv&&(this.RK&&this.Rv.enableCoachVideoUI(),this.Rv.showCoachRealtimeUI(this.YNg));this.Eha()&&this.gk.instance.show(Be.kVf,Kn.a.R5c)}kkj(n){"AudioDeviceConnected"===n.mediaStatus?(this.rde=!0,this.RK&&!this.Cqe||this.drh()):"VideoSetupCompleted"===n.mediaStatus&&
(this.Cqe=!0,this.rde&&(this.Rv&&this.Rv.enableCoachVideoUI(),this.drh()))}Blj(n){if(this.la.pptEditorVoiceUXEnabled){var O=n.severity,ha=n.shortCode;if(0<ha&&ha<Be.nJf&&Be.iX[ha])switch(O){case 0:this.Eha()&&this.gk.instance.hide();break;case 1:(n=0<ha?Be.iX[ha]:n.shortString)&&this.Eha()&&this.gk.instance.show(n,Kn.a.yBb);break;case 2:(n=0<ha?Be.iX[ha]:n.shortString)&&this.Eha()&&this.gk.instance.show(n,Kn.a.AVa)}else K.a.J(595198425,822,10,"onQualityStatusChanged: Invalid short code")}}Eha(){return this.la.pptEditorVoiceUXEnabled&&
this.gk&&this.gk.instance&&2!==this.Hka?!0:!1}wal(){this.Eha()&&(this.gk.instance.show(Be.lVf,Kn.a.R5c),this.Lac=window.setTimeout(Object(r.a)(this,this.X3d,"hideSoundReminderNotification"),3E3))}X3d(){this.Eha()&&(window.clearTimeout(this.Lac),this.gk.instance.hide())}CYb(){return this.la.hDb&&!!this.Hx}kae(){return this.CYb()?this.dFg:!0}rZg(){this.dFg=!0;this.RK=this.Hx.kUd;xh.a("PollToRefreshCoachEntryPointOnRibbon")&&this.BD&&this.BD.YG()}}Object(h.a)(am,"RehearsalManager",null,[911]);class $s{constructor(n,
O,ha){this.xo=n;this.ia=O;this.la=ha}rIa(n,O,ha,Aa,La){try{const uc=document.createElement("div");uc.id="SummaryPageOverlay";uc.style.width="100%";uc.style.height="100%";uc.style.zIndex="999";uc.style.display="flex";uc.style.flexDirection="column";uc.style.justifyContent="center";uc.style.position="absolute";var Bb=document.getElementById("SummaryPageOverlay");Bb&&document.body.removeChild(Bb);document.body.insertBefore(uc,document.body.firstChild);const Vc=uc.parentNode;Hb.a.addHandler(Vc,ma.a.Rf,
Object(r.a)(this,this.WYg,"onParentNodeKeyDownHandler"));var Wb=n.thumbIndices;if(Wb){Bb={};let wf=0;const Ze=this.ibj(Wb);for(let Ah=0;Ah<Wb.length;Ah++)Bb[Wb[Ah].toString()]=Ze[Ah],Ze[Ah]||wf++;K.a.J(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",Wb.length,wf);n.slideImageSrcs=Bb}else n.slideImageSrcs={},K.a.J(594068941,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");
const bd=v.AFrameworkApplication.WD;bd||K.a.J(557424734,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");ha||(ha=Hq(this.la,this.la.Hva));Wb={};const xd=ef.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).WACSessionID;Wb.fFeedbackCardEnabled=this.la.Wsk&&bd;Wb.fShowFeedbackButton=bd;Wb.fMonotoneEnabled=this.la.Uxe&&$l(ha,Be.Lre);Wb.fGrammarEnabled=this.la.Bye&&$l(ha,Be.f2d);Wb.fFillersCardEnabled=$l(ha,Be.NUd);Wb.locale=this.la.Hva;Wb.fPronunciationCardEnabled=
this.la.pptRehearsalPronunciationEnabled&&$l(ha,Be.aAe);Wb.fCrutchWordCardEnabled=this.la.pptRehearsalCrutchWordsEnabled&&$l(ha,Be.xPd);Wb.fVisionEnabled=O&&this.la.awk&&this.la.pptRehearsalVisionEnabled;const xe=Jp(this.la,this.la.Hva);ib.a.Xa(xe)||(Wb.fPacingGaugeRange=xe);ib.a.Xa(xd)||(Wb.clientSessionId=xd);this.la.hDb&&(Wb.rehearsalOptOutFeatures=Aa);(new rehearsalSummaryPage.RehearsalSummaryPageController(uc,n,()=>{K.a.J(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");
La&&La();this.ia&&(uc.parentNode.removeChild(uc),this.ia.Ma(Ab.a.cma,2,{entryPoint:3}))},()=>{La&&La();Hb.a.removeHandler(Vc,ma.a.Rf,Object(r.a)(this,this.WYg,"onParentNodeKeyDownHandler"))},this.la.podsWebServiceBase,decodeURIComponent(this.la.sec),()=>{this.S9k()},Wb,Iq(this.la.pptEditorSpeechHandlerBaseUri),"Web",()=>{this.q9k()})).renderSummaryPage()}catch(uc){K.a.J(51144075,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",uc.toString())}}WYg(n){"MainApp"===
n.target.id&&(n.preventDefault(),n.stopPropagation())}q9k(){K.a.J(556012420,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");this.ia&&this.la.hDb&&this.ia.Ma(Ab.a.thd,2,null)}S9k(){K.a.J(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");this.ia&&(this.la.ovk?this.ia.Ma(Ab.a.pah,2,null):this.ia.Ma(G.a.giveFeedback,2,!1))}ibj(n){const O=Array(n.length);if(!this.xo)return O;const ha=this.xo.kS(),Aa=this.xo.E6a();
for(let La=0;La<n.length;La++){const Bb=Aa[ha[n[La]].sid.toString()];Bb&&Bb.thumbnailImage.length&&(O[La]=Bb.thumbnailImage)}return O}}Object(h.a)($s,"RehearsalSummaryPageHelper",null,[]);class bq{constructor(n,O,ha,Aa,La){this.iTa=!1;this.va=new Hl.a;this.ia=n;this.fZc=new $s(O,this.ia,Aa);this.Jle=ha;this.O2c=La}wb(){this.ia.ya(Ab.a.rIa,yb.a.application,Object(r.a)(this,this.zal,"showSummaryPage"));this.ia.ya(Ab.a.pah,yb.a.application,Object(r.a)(this,this.Z9k,"showFloodgateSurvey"))}rIa(n,O,ha,
Aa,La){this.fZc.rIa(n,O,ha,Aa,La)}zal(n,O,ha,Aa,La){switch(ha){case 2:return this.fZc.rIa(La,!1,null,null,null),32;case 1:if(this.iTa)return 32;break;default:K.a.J(41793168,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8}Z9k(n,O,ha){switch(ha){case 2:return this.O2c.execute(Aa=>{Aa.RGb("PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),32;case 1:if(this.iTa)return 32;break;default:K.a.J(42825479,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8}z5b(){const n=
Date.now();this.Jle("rehearsalSummaryPage").then(()=>{const O=v.AFrameworkApplication.fa.Ia("RehearsalSummaryPageCssUrl"),ha=document.createElement("link");ha.setAttribute("rel","stylesheet");ha.setAttribute("type","text/css");ha.setAttribute("href",O);$addHandler(ha,"load",()=>{this.iTa=!0;this.va.raiseEvent("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs);K.a.J(555798673,817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-n)});document.body.appendChild(ha);return null})}W2h(n){this.va.addHandler("OnRehearsalSummaryResourcesLoaded",
n)}wNk(n){this.va.removeHandler("OnRehearsalSummaryResourcesLoaded",n)}}Object(h.a)(bq,"RehearsalSummaryPageActor",null,[909]);class nu{constructor(n,O,ha,Aa,La){this.rvg=this.Sqg=!1;this.ia=n;this.Ha=O;this.Sne=ha;this.y$b=Aa;this.tua=La;this.Sne.execute(Bb=>{Bb.m2h(Object(r.a)(this,this.nWg,"onCoachResourcesLoaded"))});this.y$b.execute(Bb=>{Bb.W2h(Object(r.a)(this,this.tZg,"onRehearsalSummaryResourcesLoaded"))})}dispose(){this.Sne.instance&&this.Sne.instance.XMk(Object(r.a)(this,this.nWg,"onCoachResourcesLoaded"));
this.y$b.instance&&this.y$b.instance.wNk(Object(r.a)(this,this.tZg,"onRehearsalSummaryResourcesLoaded"))}nWg(){this.Sqg=!0;this.kwh()}tZg(){this.rvg=!0;this.kwh()}kwh(){this.Sqg&&this.rvg&&Jc.a.get_instance().Ak(10,null).continueWith(()=>{if(this.Ha.Vnh&&this.Ha.Xvk){const n=document.getElementById("rehearsal-loading-dialog-modal");n?(n.style.display="none",K.a.J(560468302,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):K.a.J(560468303,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===
this.ia.processAction(Ab.a.cma,1))if(this.Ha.Vnh)this.ia.Ma(Ab.a.cma,2,{entryPoint:5});else if(!this.Ha.rS&&this.Ha.I4g&&this.Ha.zvk)try{this.tua.continueWith(()=>{this.tua.result.logActivity("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled")}),K.a.J(590120386,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(n){K.a.J(590120384,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",n)}})}}Object(h.a)(nu,
"RehearsalTrigger",null,[912]);class Me{constructor(){this.K=this.Hx=null}get name(){return"PowerPointWebEditor.Rehearsal"}oqi(){this.K.register(909,"PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").ma().na(()=>new bq(v.AFrameworkApplication.Va,this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),Ef.a(this.K),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Oa("Common.ISystemInitiatedFeedback")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").wb()}Yb(n){this.K=
n;this.K.Oa("PowerPointWebEditor.IThumbnailDataStoreManager").execute(()=>{this.oqi()});if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled){this.K.register(910,"PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings").ma().na(()=>new ds(v.AFrameworkApplication.Be,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.IActionManagerExtended")));this.Hx=this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");
const O=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(911,"PowerPointWebEditor.Rehearsal.IRehearsalManager").ma().na(()=>new am(v.AFrameworkApplication.Va,O,this.K.resolve("Common.IDynamicScriptLoaderProvider"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
u.a.instance.Oa("PowerPointWebEditor.ISlideShowVoiceNotification"),u.a.instance.Oa("PowerPointWebEditor.ISlideshowToolbar"),u.a.instance.Oa("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),this.Hx,this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").wb();this.K.register(912,"PowerPointWebEditor.Rehearsal.IRehearsalTrigger").ma().na(()=>new nu(v.AFrameworkApplication.Va,
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),u.a.instance.Oa("PowerPointWebEditor.Rehearsal.IRehearsalManager"),u.a.instance.Oa("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),Eh.a.su(u.a.instance.Oa("Common.ISystemInitiatedFeedback"))));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalTrigger")}}init(){v.AFrameworkApplication.fa.gf(Object(r.a)(this,this.Fl,"onFullAppSettingsReady"))}Fl(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").O4b&&Jc.a.get_instance().Ak(7,
()=>{this.K.Oa("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").execute(()=>{this.initialize()})})}initialize(){this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").z5b();this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled&&this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").z5b();if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").hDb){this.K.resolve("Common.AFrameworkApplication");const n=new co(this.K.resolve("Common.IDynamicScriptLoaderProvider").gx,
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.Hx,this.K.resolve("PowerPointWebEditor.IApplicationSettings"));n.wb();n.Fe();this.Hx.Jwj()}}dispose(){}static main(){e.a.instance.Ec(new Me)}}Object(h.a)(Me,"PPTWebEditorRehearsalPackage",null,[2,3]);Type.registerNamespace("Box4.Media");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointVersionHistory");
Type.registerNamespace("PowerPointWeb");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Accessibility");Type.registerNamespace("PowerPointWebEditor.AgendaConverter");Type.registerNamespace("PowerPointWebEditor.Designer");Type.registerNamespace("PowerPointWebEditor.ImageDescription");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.Live");Type.registerNamespace("PowerPointWebEditor.PenMinutes");Type.registerNamespace("PowerPointWebEditor.PresentToTeams");
Type.registerNamespace("PowerPointWebEditor.Rehearsal");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");Type.registerNamespace("PowerPointWebEditor.Text");Type.registerNamespace("PowerPointWebEditor.VersionHistory");Type.registerNamespace("Common.App.AccessibilityChecker");Mc.main();ec.main();gd.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AccessibilitySettings");
Ta.main();Type.registerNamespace("Common.App.DirectPrint");e.a.instance.Ec(new Qe);Type.registerNamespace("Common.App.DisplayEnvironmentName");kg.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.InProductMessaging");re.main();Type.registerNamespace("Common.App.NewAndOpen.UX");e.a.instance.Ec(new eh);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Wi.main();Type.registerNamespace("Common.App.PenMinutesManager");Vf.main();Type.registerNamespace("Common.App.SaveAsToHost");
mf.main();Type.registerNamespace("Common.App.SaveToSharePoint");Sg.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Hj.main();Type.registerNamespace("Common.App.SaveACopy");R.main();Type.registerNamespace("Common.App.PhoneLink");nb.main();Type.registerNamespace("Common.App.SharedFilePicker");Sc.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SearchOAuthManager");ki.main();Type.registerNamespace("Common.App.WopiIdentity");Hf.main();Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.SmartLookup");wg.main();Il.main();Ik.main();In.main();mm.main();Oo.main();e.a.instance.Ec(nc.a(new pk,0));wo.main();Type.registerNamespace("Common.App.LivePersonaUtils");lr.main();Me.main()},323:function(J,V,d){d.d(V,"a",function(){return H});J=d(0);var h=d(1154),e=d(39),m=d(474),r=d(166),v=d(37),A=d(64),x=d(26),y=d(960),u=d(961);class H{constructor(G){this.LG=G}get node(){return this.LG}get propertySet(){return this.LG}get ay(){if(1074135132===this.LG.Oe)return 0;
if(1074135137===this.LG.Oe)return 1;x.a.J(18354962,802,10,"Invalid AppType {0}",m.a[this.LG.Oe]);return-1}get id(){return 0===this.ay?this.propertySet.ta(v.a.yY,null)+this.shapeId.toString()+this.slideId.toString():this.propertySet.ta(v.a.yY,null)}get TWf(){return this.propertySet.ta(e.a.tHd,null)}get visibility(){return this.propertySet.ta(e.a.WSb,!1)}get width(){return this.propertySet.ta(e.a.b7h,320)}get row(){return this.propertySet.ta(e.a.a7h,0)}get Zpg(){return this.propertySet.ta(r.a.isForUILessAction,
!1)}get Gva(){return this.propertySet.ta(e.a.anb,null)}get version(){return this.propertySet.ta(e.a.rAc,null)}get store(){return this.propertySet.ta(e.a.qAc,null)}get storeType(){return this.propertySet.getValue(v.a.USb)}get ownerAddinSolutionId(){return this.propertySet.ta(v.a.m1g,null)}get sharedRuntimeId(){return this.propertySet.ta(r.a.sharedRuntimeId,null)}get settings(){const G={};y.a(this.node,(E,I)=>{u.b(I,G)});return G}get slideId(){if(0===this.ay){const G=this.LG.getValue(v.a.sid),E=this.LG.getValue(v.a.cid);
return A.a.XD(G,E)}return null}get shapeId(){const G=Object(h.a)(4,this.LG);return 0===this.ay&&G?G.get_shapeId():0}get ownerAddinStoreType(){return this.propertySet.ta(v.a.ownerAddinStoreType,null)}get znb(){return this.propertySet.ta(v.a.znb,-1)}get W2a(){return this.propertySet.ta(v.a.W2a,null)}}Object(J.a)(H,"AppReader",null,[999])},324:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.none=null;h.Nmi="CoAuth";h.v4d="IdeasPaneClosed";h.Abk="MultiSlidesSelected";h.xeb="Retrigger";
h.$ed="SessionEnded";h.yYk="SessionRehydrated";h.slideNavigation="SlideNavigation";h.tHb="SuggestionPaneClosed";h.zid="SuggestionsLoadingTimeout";h.noSuggestion="NoSuggestion";h.typing="Typing";h.CJb="WebActionId:";h.jKk="Rehydrated";h.dWf="DisallowedRequest";h.wNf="CloseSecondPane";h.Dnk="OpenEditorPane";Object(J.a)(h,"DesignerResetReason",null,[])},325:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.invalid="Invalid";h.success="Success";h.error="Error";h.pending="Pending";h.rGa=
"NoResult";Object(J.a)(h,"ProviderResultStatus",null,[])},378:function(J,V,d){J=d(0);class h{static Y5i(){return h._nextEventReceiverId++}}h._nextEventReceiverId=0;Object(J.a)(h,"EventReceiverIdCounter",null,[]);d.d(V,"a",function(){return e});class e{constructor(m,r){this.KJh=m;this._id=h.Y5i();this.nSh=r}get id(){return this._id}notify(m,r){this.nSh(m,r)}zba(m,r){return this.KJh.gAk(m,r?this:null)}}Object(J.a)(e,"EventReceiver",null,[1045])},528:function(J,V,d){d.d(V,"a",function(){return h});J=
d(0);class h{}Object(J.a)(h,"OnlineMediaSearchResult",null,[])},529:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(374),e=d(230);class m{static D7k(r){return parseInt(m.FQe(e.a.OCf,r)||"-1")<=(new Date).getTime()}static u5f(r){return parseInt(m.FQe(e.a.Omb,r)||"-1")}static Ghg(r){return Boolean.parse(m.FQe(e.a.GSb,r)||"false")}static FQe(r,v){let A=null;try{const x=m.bMc();if(void 0!==x&&x){const y=e.a.t5f(r)+v;A=x.getItem(y)}else h.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(x){h.ULS.sendTraceTag(42074646,
220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",r,v)}return A}static GIb(r,v,A){try{const x=m.bMc();if(void 0!==x&&x){const y=e.a.t5f(r)+A;x.setItem(y,v)}else h.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(x){h.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",r,A)}}static bMc(){if(!m.A1b)return null;let r=null;try{r=localStorage}catch(v){m.A1b=!1,r=null}return r}}m.A1b=
!0;Object(J.a)(m,"AddinUtil",null,[])},530:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.u3j=e;this.$4j=m}get ISc(){return this.u3j}get hRk(){return this.$4j}}Object(J.a)(h,"ReportSuggestionSessionActionData",null,[])},531:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.dYf="Provider.UCI.Editor";h.YXf="EntityGroup.UCI.Editor";h.hqh="Provider.Designer.Slide";h.gqh="EntityGroup.Designer.Slide.Suggestion";h.qqh="Provider.Designer.TextToSmartArt";
h.pqh="EntityGroup.Designer.TextToSmartArt.Suggestion";Object(J.a)(h,"InfraredConstant",null,[])},674:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(68);class e{constructor(m){this.j8=this.Vja=null;this.we=m}dispose(){this.clear();this.Vja.parentNode.removeChild(this.Vja)}Rga(m){this.Vja=this.WVb(m,"prContainerHr");this.j8=this.WVb(this.Vja,"prGlyph")}clear(){this.gma()}aIa(m,r){m&&(this.gma(),this.j8.appendChild(m),this.j8.style.backgroundColor=r,this.Vja.style.visibility=h.a.visible)}WVb(m,
r){const v=this.we.De();this.we.addCssClass(v,r);m.appendChild(v);return v}gma(){this.j8.firstChild&&this.j8.removeChild(this.j8.firstChild)}}Object(J.a)(e,"ShapePawnGlyph",null,[])},681:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=1]="launchByLocalCacheInitializer";e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";e[e.launchByInsertion=3]="launchByInsertion";e[e.launchByRefresh=
4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=6]="launchByDynamicCall"})(h||(h={}));Object(J.b)("AddinCommandsLaunchOperationType",h)},682:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"ProviderActionInfo",null,[])},683:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.Label=this.CorrelationId=null;this.ShapeId=this.ReplaceObjectType=
0;this.SmartArtSubNodeId=null;this.SuggestionSid=0}}Object(J.a)(h,"ReplaceObjectSuggestionApplyInfo",null,[])},957:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{static add(e,m,r,v,A){h.QBg[h.i5f(e,m,r,v,A)]=!0}static contains(e,m,r,v,A){return h.i5f(e,m,r,v,A)in h.QBg}static i5f(e,m,r,v,A){return String.format("{0}|{1}|{2}|{3}|{4}",e.toLowerCase(),m,r.toLowerCase(),v.toLowerCase(),A.toLowerCase())}}h.QBg={};Object(J.a)(h,"AppsInsertedStorage",null,[])},958:function(J,V,d){d.d(V,"a",
function(){return h});J=d(0);class h{}Object(J.a)(h,"AppsForOfficeEntitlementQueryInfo",null,[])},959:function(J,V,d){d.d(V,"a",function(){return H});J=d(0);var h=d(105),e=d(1154),m=d(36),r=d(39),v=d(30),A=d(81),x=d(240),y=d(37),u=d(960);class H{static cui(G,E,I){G=Object(e.a)(A.a,G.createInstance(1074135137));H.UAf(G,E,I);return G}static ZXh(G,E){v.GraphIterator.nb(G).hl(E,19)}static UAf(G,E,I){G.setValue(r.a.mAc,0===E.targetType);G.setValue(r.a.anb,E.solutionId);G.setValue(r.a.rAc,E.version);G.setValue(r.a.VSb,
E.storeType);G.setValue(r.a.qAc,E.storeId);G.setValue(y.a.USb,I.hEc(E.storeType));E.assetId&&G.setValue(y.a.lHd,E.assetId);G.setValue(y.a.mHd,E.assetStoreId);void 0===E.isAddinCommands?G.setValue(y.a.isAddinCommands,!1):G.setValue(y.a.isAddinCommands,E.isAddinCommands);E.sharedRuntimeId&&-1!==E.backgroundState&&(G.setValue(y.a.znb,E.backgroundState),G.setValue(y.a.W2a,E.sharedRuntimeId));0===E.targetType&&(G.setValue(y.a.ar,!0),I=E.height?E.height:200,G.setValue(m.a.Bx,E.width?E.width:200),G.setValue(m.a.qD,
I))}static fzh(G,E,I){const Q=h.a.Ljc(I);u.b(E,Y=>{Y=Y.getValue(r.a.oAc);return!!Y&&!(Y in Q)});u.a(E,(Y,M)=>{const N=M.getValue(r.a.oAc);N&&N in Q&&(H.dql(M,Q[N],Y),delete Q[N])});const D=v.GraphIterator.nb(E);h.a.forEach(Q,(Y,M)=>{D.hl(H.dui(G,Y,M),21)},null)}static dui(G,E,I){G=Object(e.a)(A.a,G.createInstance(1074135139));G.setValue(r.a.oAc,E);G.setValue(r.a.pAc,I);return G}static dql(G,E,I){G.setValue(r.a.pAc,E);I.ta(r.a.mAc,!0)?x.d(I,G,H.eUk):x.d(I,G,H.xUk)}}H.eUk=[y.a.sid,y.a.cid,y.a.shapeId];
H.xUk=[r.a.anb];Object(J.a)(H,"AppEditor",null,[])},960:function(J,V,d){d.d(V,"a",function(){return m});d.d(V,"b",function(){return r});var h=d(30),e=d(961);const m=(v,A)=>{const x=new h.GraphIterator;x.set(v);let y=x.yb(21);for(;y;)e.a(y)&&A(v,y),y=x.xf(21)},r=(v,A)=>{const x=new h.GraphIterator;x.set(v);let y=x.yb(21);for(;y&&y!==v;)y=e.a(y)&&A(y)?x.pOa(21):x.xj(21)}},961:function(J,V,d){d.d(V,"b",function(){return e});d.d(V,"a",function(){return m});var h=d(39);const e=(r,v)=>{const A=r.getValue(h.a.oAc);
r=r.getValue(h.a.pAc);v[A]=r},m=r=>1074135139===r.Oe},962:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m,r=null){super();this.shapeId=e;this.okg=m;this.BX=r}}Object(J.a)(h,"ReplaceObjectSuggestionPointerOverEventArgs",Sys.EventArgs,[])},963:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m=null){super();this.shapeId=e;this.BX=m}}Object(J.a)(h,"ReplaceObjectSuggestionPointerOutEventArgs",Sys.EventArgs,
[])},964:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.AAc=null}}Object(J.a)(h,"IdeasSmartArtSuggestionWrapper",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16448741/wdjs/ppteditDS.chronos2.js.map